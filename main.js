(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[179],{383:(E,ae,X)=>{"use strict";X.r(ae),X.d(ae,{default:()=>p});var a=X(5861),y=X(3604),w=X.n(y);class p extends(w()){dynamicImportI18n(M,v){return(0,a.Z)(function*(){return(yield X(6507)(`./${M}.${v}.json`)).default})()}dynamicImport(M){return(0,a.Z)(function*(){yield X(85)(`./${M}`)})()}}},9567:(E,ae,X)=>{"use strict";function a(n){return"function"==typeof n}function y(n){const e=n(i=>{Error.call(i),i.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const w=y(n=>function(e){n(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function p(n,t){if(n){const e=n.indexOf(t);0<=e&&n.splice(e,1)}}class d{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const s of e)s.remove(this);else e.remove(this);const{initialTeardown:i}=this;if(a(i))try{i()}catch(s){t=s instanceof w?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{D(s)}catch(o){t=null!=t?t:[],o instanceof w?t=[...t,...o.errors]:t.push(o)}}if(t)throw new w(t)}}add(t){var e;if(t&&t!==this)if(this.closed)D(t);else{if(t instanceof d){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(t)}}_hasParent(t){const{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){const{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&p(e,t)}remove(t){const{_finalizers:e}=this;e&&p(e,t),t instanceof d&&t._removeParent(this)}}d.EMPTY=(()=>{const n=new d;return n.closed=!0,n})();const M=d.EMPTY;function v(n){return n instanceof d||n&&"closed"in n&&a(n.remove)&&a(n.add)&&a(n.unsubscribe)}function D(n){a(n)?n():n.unsubscribe()}const $={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},F={setTimeout(n,t,...e){const{delegate:i}=F;return(null==i?void 0:i.setTimeout)?i.setTimeout(n,t,...e):setTimeout(n,t,...e)},clearTimeout(n){const{delegate:t}=F;return((null==t?void 0:t.clearTimeout)||clearTimeout)(n)},delegate:void 0};function oe(n){F.setTimeout(()=>{const{onUnhandledError:t}=$;if(!t)throw n;t(n)})}function G(){}const L=se("C",void 0,void 0);function se(n,t,e){return{kind:n,value:t,error:e}}let ue=null;function ee(n){if($.useDeprecatedSynchronousErrorHandling){const t=!ue;if(t&&(ue={errorThrown:!1,error:null}),n(),t){const{errorThrown:e,error:i}=ue;if(ue=null,e)throw i}}else n()}class ne extends d{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,v(t)&&t.add(this)):this.destination=b}static create(t,e,i){return new A(t,e,i)}next(t){this.isStopped?g(function H(n){return se("N",n,void 0)}(t),this):this._next(t)}error(t){this.isStopped?g(function V(n){return se("E",void 0,n)}(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?g(L,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const k=Function.prototype.bind;function q(n,t){return k.call(n,t)}class z{constructor(t){this.partialObserver=t}next(t){const{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(i){N(i)}}error(t){const{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(i){N(i)}else N(t)}complete(){const{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){N(e)}}}class A extends ne{constructor(t,e,i){let r;if(super(),a(t)||!t)r={next:null!=t?t:void 0,error:null!=e?e:void 0,complete:null!=i?i:void 0};else{let s;this&&$.useDeprecatedNextContext?(s=Object.create(t),s.unsubscribe=()=>this.unsubscribe(),r={next:t.next&&q(t.next,s),error:t.error&&q(t.error,s),complete:t.complete&&q(t.complete,s)}):r=t}this.destination=new z(r)}}function N(n){$.useDeprecatedSynchronousErrorHandling?function Y(n){$.useDeprecatedSynchronousErrorHandling&&ue&&(ue.errorThrown=!0,ue.error=n)}(n):oe(n)}function g(n,t){const{onStoppedNotification:e}=$;e&&F.setTimeout(()=>e(n,t))}const b={closed:!0,next:G,error:function P(n){throw n},complete:G},C="function"==typeof Symbol&&Symbol.observable||"@@observable";function h(n){return n}function u(...n){return l(n)}function l(n){return 0===n.length?h:1===n.length?n[0]:function(e){return n.reduce((i,r)=>r(i),e)}}let f=(()=>{class n{constructor(e){e&&(this._subscribe=e)}lift(e){const i=new n;return i.source=this,i.operator=e,i}subscribe(e,i,r){const s=function S(n){return n&&n instanceof ne||function x(n){return n&&a(n.next)&&a(n.error)&&a(n.complete)}(n)&&v(n)}(e)?e:new A(e,i,r);return ee(()=>{const{operator:o,source:c}=this;s.add(o?o.call(s,c):c?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(e){try{return this._subscribe(e)}catch(i){e.error(i)}}forEach(e,i){return new(i=_(i))((r,s)=>{const o=new A({next:c=>{try{e(c)}catch(m){s(m),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(e){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(e)}[C](){return this}pipe(...e){return l(e)(this)}toPromise(e){return new(e=_(e))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return n.create=t=>new n(t),n})();function _(n){var t;return null!==(t=null!=n?n:$.Promise)&&void 0!==t?t:Promise}const Q=y(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let le=(()=>{class n extends f{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const i=new Ce(this,this);return i.operator=e,i}_throwIfClosed(){if(this.closed)throw new Q}next(e){ee(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(e)}})}error(e){ee(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:i}=this;for(;i.length;)i.shift().error(e)}})}complete(){ee(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:i,isStopped:r,observers:s}=this;return i||r?M:(this.currentObservers=null,s.push(e),new d(()=>{this.currentObservers=null,p(s,e)}))}_checkFinalizedStatuses(e){const{hasError:i,thrownError:r,isStopped:s}=this;i?e.error(r):s&&e.complete()}asObservable(){const e=new f;return e.source=this,e}}return n.create=(t,e)=>new Ce(t,e),n})();class Ce extends le{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===i||i.call(e,t)}error(t){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===i||i.call(e,t)}complete(){var t,e;null===(e=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===e||e.call(t)}_subscribe(t){var e,i;return null!==(i=null===(e=this.source)||void 0===e?void 0:e.subscribe(t))&&void 0!==i?i:M}}function T(n){return a(null==n?void 0:n.lift)}function O(n){return t=>{if(T(t))return t.lift(function(e){try{return n(e,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function re(n,t,e,i,r){return new j(n,t,e,i,r)}class j extends ne{constructor(t,e,i,r,s,o){super(t),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=e?function(c){try{e(c)}catch(m){t.error(m)}}:super._next,this._error=r?function(c){try{r(c)}catch(m){t.error(m)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(c){t.error(c)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function ve(n,t){return O((e,i)=>{let r=0;e.subscribe(re(i,s=>{i.next(n.call(t,s,r++))}))})}var de=function(n,t){return(de=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])})(n,t)};function Ee(n,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function e(){this.constructor=n}de(n,t),n.prototype=null===t?Object.create(t):(e.prototype=t.prototype,new e)}var ce=function(){return ce=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var s in e=arguments[i])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t},ce.apply(this,arguments)};function B(n,t,e,i){var o,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,e):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(n,t,e,i);else for(var c=n.length-1;c>=0;c--)(o=n[c])&&(s=(r<3?o(s):r>3?o(t,e,s):o(t,e))||s);return r>3&&s&&Object.defineProperty(t,e,s),s}function nt(n){return this instanceof nt?(this.v=n,this):new nt(n)}function Nt(n,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=e.apply(n,t||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(pe){i[pe]&&(r[pe]=function(ye){return new Promise(function(we,Me){s.push([pe,ye,we,Me])>1||c(pe,ye)})})}function c(pe,ye){try{!function m(pe){pe.value instanceof nt?Promise.resolve(pe.value.v).then(I,Z):fe(s[0][2],pe)}(i[pe](ye))}catch(we){fe(s[0][3],we)}}function I(pe){c("next",pe)}function Z(pe){c("throw",pe)}function fe(pe,ye){pe(ye),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Ot(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=n[Symbol.asyncIterator];return t?t.call(n):(n=function Ie(n){var t="function"==typeof Symbol&&Symbol.iterator,e=t&&n[t],i=0;if(e)return e.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(s){e[s]=n[s]&&function(o){return new Promise(function(c,m){!function r(s,o,c,m){Promise.resolve(m).then(function(I){s({value:I,done:c})},o)}(c,m,(o=n[s](o)).done,o.value)})}}}const sl=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function ec(n){return a(null==n?void 0:n.then)}function ol(n){return a(n[C])}function ss(n){return Symbol.asyncIterator&&a(null==n?void 0:n[Symbol.asyncIterator])}function Go(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Iu=function $g(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Su(n){return a(null==n?void 0:n[Iu])}function tc(n){return Nt(this,arguments,function*(){const e=n.getReader();try{for(;;){const{value:i,done:r}=yield nt(e.read());if(r)return yield nt(void 0);yield yield nt(i)}}finally{e.releaseLock()}})}function _f(n){return a(null==n?void 0:n.getReader)}function pr(n){if(n instanceof f)return n;if(null!=n){if(ol(n))return function vg(n){return new f(t=>{const e=n[C]();if(a(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(sl(n))return function $f(n){return new f(t=>{for(let e=0;e<n.length&&!t.closed;e++)t.next(n[e]);t.complete()})}(n);if(ec(n))return function bg(n){return new f(t=>{n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,oe)})}(n);if(ss(n))return vf(n);if(Su(n))return function yg(n){return new f(t=>{for(const e of n)if(t.next(e),t.closed)return;t.complete()})}(n);if(_f(n))return function nc(n){return vf(tc(n))}(n)}throw Go(n)}function vf(n){return new f(t=>{(function Cg(n,t){var e,i,r,s;return function W(n,t,e,i){return new(e||(e=Promise))(function(s,o){function c(Z){try{I(i.next(Z))}catch(fe){o(fe)}}function m(Z){try{I(i.throw(Z))}catch(fe){o(fe)}}function I(Z){Z.done?s(Z.value):function r(s){return s instanceof e?s:new e(function(o){o(s)})}(Z.value).then(c,m)}I((i=i.apply(n,t||[])).next())})}(this,void 0,void 0,function*(){try{for(e=Ot(n);!(i=yield e.next()).done;)if(t.next(i.value),t.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=e.return)&&(yield s.call(e))}finally{if(r)throw r.error}}t.complete()})})(n,t).catch(e=>t.error(e))})}function Ks(n,t,e,i=0,r=!1){const s=t.schedule(function(){e(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function qo(n,t,e=1/0){return a(t)?qo((i,r)=>ve((s,o)=>t(i,s,r,o))(pr(n(i,r))),e):("number"==typeof t&&(e=t),O((i,r)=>function bf(n,t,e,i,r,s,o,c){const m=[];let I=0,Z=0,fe=!1;const pe=()=>{fe&&!m.length&&!I&&t.complete()},ye=Me=>I<i?we(Me):m.push(Me),we=Me=>{s&&t.next(Me),I++;let Oe=!1;pr(e(Me,Z++)).subscribe(re(t,Be=>{null==r||r(Be),s?ye(Be):t.next(Be)},()=>{Oe=!0},void 0,()=>{if(Oe)try{for(I--;m.length&&I<i;){const Be=m.shift();o?Ks(t,o,()=>we(Be)):we(Be)}pe()}catch(Be){t.error(Be)}}))};return n.subscribe(re(t,ye,()=>{fe=!0,pe()})),()=>{null==c||c()}}(i,r,n,e)))}function yf(n=1/0){return qo(h,n)}const ic=new f(n=>n.complete());function Mu(n){return n&&a(n.schedule)}function rc(n){return n[n.length-1]}function al(n){return a(rc(n))?n.pop():void 0}function Wo(n){return Mu(rc(n))?n.pop():void 0}function ha(n,t=0){return O((e,i)=>{e.subscribe(re(i,r=>Ks(i,n,()=>i.next(r),t),()=>Ks(i,n,()=>i.complete(),t),r=>Ks(i,n,()=>i.error(r),t)))})}function pa(n,t=0){return O((e,i)=>{i.add(n.schedule(()=>e.subscribe(i),t))})}function ll(n,t){if(!n)throw new Error("Iterable cannot be null");return new f(e=>{Ks(e,t,()=>{const i=n[Symbol.asyncIterator]();Ks(e,t,()=>{i.next().then(r=>{r.done?e.complete():e.next(r.value)})},0,!0)})})}function Dr(n,t){return t?function ga(n,t){if(null!=n){if(ol(n))return function sc(n,t){return pr(n).pipe(pa(t),ha(t))}(n,t);if(sl(n))return function xg(n,t){return new f(e=>{let i=0;return t.schedule(function(){i===n.length?e.complete():(e.next(n[i++]),e.closed||this.schedule())})})}(n,t);if(ec(n))return function ku(n,t){return pr(n).pipe(pa(t),ha(t))}(n,t);if(ss(n))return ll(n,t);if(Su(n))return function wg(n,t){return new f(e=>{let i;return Ks(e,t,()=>{i=n[Iu](),Ks(e,t,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void e.error(o)}s?e.complete():e.next(r)},0,!0)}),()=>a(null==i?void 0:i.return)&&i.return()})}(n,t);if(_f(n))return function Gr(n,t){return ll(tc(n),t)}(n,t)}throw Go(n)}(n,t):pr(n)}function qr(...n){const t=Wo(n),e=function Ko(n,t){return"number"==typeof rc(n)?n.pop():t}(n,1/0),i=n;return i.length?1===i.length?pr(i[0]):yf(e)(Dr(i,t)):ic}function Wr(n,t,...e){if(!0===t)return void n();if(!1===t)return;const i=new A({next:()=>{i.unsubscribe(),n()}});return t(...e).subscribe(i)}function Sn(n){for(let t in n)if(n[t]===Sn)return t;throw Error("Could not find renamed property on target object.")}function oc(n,t){for(const e in t)t.hasOwnProperty(e)&&!n.hasOwnProperty(e)&&(n[e]=t[e])}function Un(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Un).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const t=n.toString();if(null==t)return""+t;const e=t.indexOf("\n");return-1===e?t:t.substring(0,e)}function ma(n,t){return null==n||""===n?null===t?"":t:null==t||""===t?n:n+" "+t}const os=Sn({__forward_ref__:Sn});function qn(n){return n.__forward_ref__=qn,n.toString=function(){return Un(this())},n}function ln(n){return ac(n)?n():n}function ac(n){return"function"==typeof n&&n.hasOwnProperty(os)&&n.__forward_ref__===qn}class Mt extends Error{constructor(t,e){super(function _a(n,t){return`NG0${Math.abs(n)}${t?": "+t:""}`}(t,e)),this.code=t}}function qt(n){return"string"==typeof n?n:null==n?"":String(n)}function ji(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():qt(n)}function lc(n,t){const e=t?` in ${t}`:"";throw new Mt(-201,`No provider for ${ji(n)} found${e}`)}function as(n,t){null==n&&function ri(n,t,e,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${e} ${i} ${t} <=Actual]`))}(t,n,null,"!=")}function tn(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function ls(n){return{providers:n.providers||[],imports:n.imports||[]}}function Tg(n){return I1(n,Tf)||I1(n,M1)}function I1(n,t){return n.hasOwnProperty(t)?n[t]:null}function S1(n){return n&&(n.hasOwnProperty(Ig)||n.hasOwnProperty(xS))?n[Ig]:null}const Tf=Sn({\u0275prov:Sn}),Ig=Sn({\u0275inj:Sn}),M1=Sn({ngInjectableDef:Sn}),xS=Sn({ngInjectorDef:Sn});var hn=(()=>((hn=hn||{})[hn.Default=0]="Default",hn[hn.Host=1]="Host",hn[hn.Self=2]="Self",hn[hn.SkipSelf=4]="SkipSelf",hn[hn.Optional=8]="Optional",hn))();let Sg;function $a(n){const t=Sg;return Sg=n,t}function k1(n,t,e){const i=Tg(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:e&hn.Optional?null:void 0!==t?t:void lc(Un(n),"Injector")}function va(n){return{toString:n}.toString()}var Ys=(()=>((Ys=Ys||{})[Ys.OnPush=0]="OnPush",Ys[Ys.Default=1]="Default",Ys))(),Zs=(()=>{return(n=Zs||(Zs={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",Zs;var n})();const ES="undefined"!=typeof globalThis&&globalThis,TS="undefined"!=typeof window&&window,IS="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Jn=ES||"undefined"!=typeof global&&global||TS||IS,cc={},si=[],If=Sn({\u0275cmp:Sn}),Mg=Sn({\u0275dir:Sn}),kg=Sn({\u0275pipe:Sn}),D1=Sn({\u0275mod:Sn}),Yo=Sn({\u0275fac:Sn}),Du=Sn({__NG_ELEMENT_ID__:Sn});let SS=0;function Zt(n){return va(()=>{const e={},i={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===Ys.OnPush,directiveDefs:null,pipeDefs:null,selectors:n.selectors||si,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||Zs.Emulated,id:"c",styles:n.styles||si,_:null,setInput:null,schemas:n.schemas||null,tView:null},r=n.directives,s=n.features,o=n.pipes;return i.id+=SS++,i.inputs=F1(n.inputs,e),i.outputs=F1(n.outputs),s&&s.forEach(c=>c(i)),i.directiveDefs=r?()=>("function"==typeof r?r():r).map(A1):null,i.pipeDefs=o?()=>("function"==typeof o?o():o).map(P1):null,i})}function Dg(n,t,e){const i=n.\u0275cmp;i.directiveDefs=()=>t.map(A1),i.pipeDefs=()=>e.map(P1)}function A1(n){return _r(n)||function ba(n){return n[Mg]||null}(n)}function P1(n){return function ul(n){return n[kg]||null}(n)}const N1={};function ws(n){return va(()=>{const t={type:n.type,bootstrap:n.bootstrap||si,declarations:n.declarations||si,imports:n.imports||si,exports:n.exports||si,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null};return null!=n.id&&(N1[n.id]=n.type),t})}function F1(n,t){if(null==n)return cc;const e={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),e[r]=i,t&&(t[r]=s)}return e}const Xt=Zt;function mr(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,onDestroy:n.type.prototype.ngOnDestroy||null}}function _r(n){return n[If]||null}function Es(n,t){const e=n[D1]||null;if(!e&&!0===t)throw new Error(`Type ${Un(n)} does not have '\u0275mod' property.`);return e}function _o(n){return Array.isArray(n)&&"object"==typeof n[1]}function Qs(n){return Array.isArray(n)&&!0===n[1]}function Ng(n){return 0!=(8&n.flags)}function Df(n){return 2==(2&n.flags)}function Af(n){return 1==(1&n.flags)}function Js(n){return null!==n.template}function PS(n){return 0!=(512&n[2])}function pl(n,t){return n.hasOwnProperty(Yo)?n[Yo]:null}class OS{constructor(t,e,i){this.previousValue=t,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}}function eo(){return R1}function R1(n){return n.type.prototype.ngOnChanges&&(n.setInput=BS),RS}function RS(){const n=L1(this),t=null==n?void 0:n.current;if(t){const e=n.previous;if(e===cc)n.previous=t;else for(let i in t)e[i]=t[i];n.current=null,this.ngOnChanges(t)}}function BS(n,t,e,i){const r=L1(n)||function LS(n,t){return n[B1]=t}(n,{previous:cc,current:null}),s=r.current||(r.current={}),o=r.previous,c=this.declaredInputs[e],m=o[c];s[c]=new OS(m&&m.currentValue,t,o===cc),n[i]=t}eo.ngInherit=!0;const B1="__ngSimpleChanges__";function L1(n){return n[B1]||null}let Lg;function zg(){return void 0!==Lg?Lg:"undefined"!=typeof document?document:void 0}function Ti(n){return!!n.listen}const z1={createRenderer:(n,t)=>zg()};function Fi(n){for(;Array.isArray(n);)n=n[0];return n}function Pf(n,t){return Fi(t[n])}function Ss(n,t){return Fi(t[n.index])}function jg(n,t){return n.data[t]}function pc(n,t){return n[t]}function us(n,t){const e=t[n];return _o(e)?e:e[0]}function j1(n){return 4==(4&n[2])}function Hg(n){return 128==(128&n[2])}function ya(n,t){return null==t?null:n[t]}function H1(n){n[18]=0}function Ug(n,t){n[5]+=t;let e=n,i=n[3];for(;null!==i&&(1===t&&1===e[5]||-1===t&&0===e[5]);)i[5]+=t,e=i,i=i[3]}const un={lFrame:X1(null),bindingsEnabled:!0};function V1(){return un.bindingsEnabled}function gt(){return un.lFrame.lView}function Bn(){return un.lFrame.tView}function De(n){return un.lFrame.contextLView=n,n[8]}function Vi(){let n=G1();for(;null!==n&&64===n.type;)n=n.parent;return n}function G1(){return un.lFrame.currentTNode}function $o(n,t){const e=un.lFrame;e.currentTNode=n,e.isParent=t}function Vg(){return un.lFrame.isParent}function Gg(){un.lFrame.isParent=!1}function Pr(){const n=un.lFrame;let t=n.bindingRootIndex;return-1===t&&(t=n.bindingRootIndex=n.tView.bindingStartIndex),t}function gc(){return un.lFrame.bindingIndex++}function Xo(n){const t=un.lFrame,e=t.bindingIndex;return t.bindingIndex=t.bindingIndex+n,e}function nM(n,t){const e=un.lFrame;e.bindingIndex=e.bindingRootIndex=n,qg(t)}function qg(n){un.lFrame.currentDirectiveIndex=n}function K1(){return un.lFrame.currentQueryIndex}function Kg(n){un.lFrame.currentQueryIndex=n}function rM(n){const t=n[1];return 2===t.type?t.declTNode:1===t.type?n[6]:null}function Y1(n,t,e){if(e&hn.SkipSelf){let r=t,s=n;for(;!(r=r.parent,null!==r||e&hn.Host||(r=rM(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;t=r,n=s}const i=un.lFrame=Z1();return i.currentTNode=t,i.lView=n,!0}function Ff(n){const t=Z1(),e=n[1];un.lFrame=t,t.currentTNode=e.firstChild,t.lView=n,t.tView=e,t.contextLView=n,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function Z1(){const n=un.lFrame,t=null===n?null:n.child;return null===t?X1(n):t}function X1(n){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=t),t}function Q1(){const n=un.lFrame;return un.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const J1=Q1;function Of(){const n=Q1();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Nr(){return un.lFrame.selectedIndex}function Ca(n){un.lFrame.selectedIndex=n}function Ii(){const n=un.lFrame;return jg(n.tView,n.selectedIndex)}function Rf(n,t){for(let e=t.directiveStart,i=t.directiveEnd;e<i;e++){const s=n.data[e].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:c,ngAfterViewInit:m,ngAfterViewChecked:I,ngOnDestroy:Z}=s;o&&(n.contentHooks||(n.contentHooks=[])).push(-e,o),c&&((n.contentHooks||(n.contentHooks=[])).push(e,c),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(e,c)),m&&(n.viewHooks||(n.viewHooks=[])).push(-e,m),I&&((n.viewHooks||(n.viewHooks=[])).push(e,I),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(e,I)),null!=Z&&(n.destroyHooks||(n.destroyHooks=[])).push(e,Z)}}function Bf(n,t,e){ev(n,t,3,e)}function Lf(n,t,e,i){(3&n[2])===e&&ev(n,t,e,i)}function Yg(n,t){let e=n[2];(3&e)===t&&(e&=2047,e+=1,n[2]=e)}function ev(n,t,e,i){const s=null!=i?i:-1,o=t.length-1;let c=0;for(let m=void 0!==i?65535&n[18]:0;m<o;m++)if("number"==typeof t[m+1]){if(c=t[m],null!=i&&c>=i)break}else t[m]<0&&(n[18]+=65536),(c<s||-1==s)&&(hM(n,e,t,m),n[18]=(4294901760&n[18])+m+2),m++}function hM(n,t,e,i){const r=e[i]<0,s=e[i+1],c=n[r?-e[i]:e[i]];if(r){if(n[2]>>11<n[18]>>16&&(3&n[2])===t){n[2]+=2048;try{s.call(c)}finally{}}}else try{s.call(c)}finally{}}class Ou{constructor(t,e,i){this.factory=t,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=i}}function zf(n,t,e){const i=Ti(n);let r=0;for(;r<e.length;){const s=e[r];if("number"==typeof s){if(0!==s)break;r++;const o=e[r++],c=e[r++],m=e[r++];i?n.setAttribute(t,c,m,o):t.setAttributeNS(o,c,m)}else{const o=s,c=e[++r];Xg(o)?i&&n.setProperty(t,o,c):i?n.setAttribute(t,o,c):t.setAttribute(o,c),r++}}return r}function tv(n){return 3===n||4===n||6===n}function Xg(n){return 64===n.charCodeAt(0)}function jf(n,t){if(null!==t&&0!==t.length)if(null===n||0===n.length)n=t.slice();else{let e=-1;for(let i=0;i<t.length;i++){const r=t[i];"number"==typeof r?e=r:0===e||nv(n,e,r,null,-1===e||2===e?t[++i]:null)}}return n}function nv(n,t,e,i,r){let s=0,o=n.length;if(-1===t)o=-1;else for(;s<n.length;){const c=n[s++];if("number"==typeof c){if(c===t){o=-1;break}if(c>t){o=s-1;break}}}for(;s<n.length;){const c=n[s];if("number"==typeof c)break;if(c===e){if(null===i)return void(null!==r&&(n[s+1]=r));if(i===n[s+1])return void(n[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(n.splice(o,0,t),s=o+1),n.splice(s++,0,e),null!==i&&n.splice(s++,0,i),null!==r&&n.splice(s++,0,r)}function iv(n){return-1!==n}function mc(n){return 32767&n}function _c(n,t){let e=function $M(n){return n>>16}(n),i=t;for(;e>0;)i=i[15],e--;return i}let Qg=!0;function Hf(n){const t=Qg;return Qg=n,t}let vM=0;function Bu(n,t){const e=em(n,t);if(-1!==e)return e;const i=t[1];i.firstCreatePass&&(n.injectorIndex=t.length,Jg(i.data,n),Jg(t,null),Jg(i.blueprint,null));const r=Uf(n,t),s=n.injectorIndex;if(iv(r)){const o=mc(r),c=_c(r,t),m=c[1].data;for(let I=0;I<8;I++)t[s+I]=c[o+I]|m[o+I]}return t[s+8]=r,s}function Jg(n,t){n.push(0,0,0,0,0,0,0,0,t)}function em(n,t){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===t[n.injectorIndex+8]?-1:n.injectorIndex}function Uf(n,t){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let e=0,i=null,r=t;for(;null!==r;){const s=r[1],o=s.type;if(i=2===o?s.declTNode:1===o?r[6]:null,null===i)return-1;if(e++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|e<<16}return-1}function Vf(n,t,e){!function bM(n,t,e){let i;"string"==typeof e?i=e.charCodeAt(0)||0:e.hasOwnProperty(Du)&&(i=e[Du]),null==i&&(i=e[Du]=vM++);const r=255&i;t.data[n+(r>>5)]|=1<<r}(n,t,e)}function ov(n,t,e){if(e&hn.Optional)return n;lc(t,"NodeInjector")}function av(n,t,e,i){if(e&hn.Optional&&void 0===i&&(i=null),0==(e&(hn.Self|hn.Host))){const r=n[9],s=$a(void 0);try{return r?r.get(t,i,e&hn.Optional):k1(t,i,e&hn.Optional)}finally{$a(s)}}return ov(i,t,e)}function lv(n,t,e,i=hn.Default,r){if(null!==n){const s=function wM(n){if("string"==typeof n)return n.charCodeAt(0)||0;const t=n.hasOwnProperty(Du)?n[Du]:void 0;return"number"==typeof t?t>=0?255&t:CM:t}(e);if("function"==typeof s){if(!Y1(t,n,i))return i&hn.Host?ov(r,e,i):av(t,e,i,r);try{const o=s(i);if(null!=o||i&hn.Optional)return o;lc(e)}finally{J1()}}else if("number"==typeof s){let o=null,c=em(n,t),m=-1,I=i&hn.Host?t[16][6]:null;for((-1===c||i&hn.SkipSelf)&&(m=-1===c?Uf(n,t):t[c+8],-1!==m&&dv(i,!1)?(o=t[1],c=mc(m),t=_c(m,t)):c=-1);-1!==c;){const Z=t[1];if(uv(s,c,Z.data)){const fe=xM(c,t,e,o,i,I);if(fe!==cv)return fe}m=t[c+8],-1!==m&&dv(i,t[1].data[c+8]===I)&&uv(s,c,t)?(o=Z,c=mc(m),t=_c(m,t)):c=-1}}}return av(t,e,i,r)}const cv={};function CM(){return new $c(Vi(),gt())}function xM(n,t,e,i,r,s){const o=t[1],c=o.data[n+8],Z=Gf(c,o,e,null==i?Df(c)&&Qg:i!=o&&0!=(3&c.type),r&hn.Host&&s===c);return null!==Z?Lu(t,o,Z,c):cv}function Gf(n,t,e,i,r){const s=n.providerIndexes,o=t.data,c=1048575&s,m=n.directiveStart,Z=s>>20,pe=r?c+Z:n.directiveEnd;for(let ye=i?c:c+Z;ye<pe;ye++){const we=o[ye];if(ye<m&&e===we||ye>=m&&we.type===e)return ye}if(r){const ye=o[m];if(ye&&Js(ye)&&ye.type===e)return m}return null}function Lu(n,t,e,i){let r=n[e];const s=t.data;if(function pM(n){return n instanceof Ou}(r)){const o=r;o.resolving&&function wf(n,t){const e=t?`. Dependency path: ${t.join(" > ")} > ${n}`:"";throw new Mt(-200,`Circular dependency in DI detected for ${n}${e}`)}(ji(s[e]));const c=Hf(o.canSeeViewProviders);o.resolving=!0;const m=o.injectImpl?$a(o.injectImpl):null;Y1(n,i,hn.Default);try{r=n[e]=o.factory(void 0,s,n,i),t.firstCreatePass&&e>=i.directiveStart&&function fM(n,t,e){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=t.type.prototype;if(i){const o=R1(t);(e.preOrderHooks||(e.preOrderHooks=[])).push(n,o),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,o)}r&&(e.preOrderHooks||(e.preOrderHooks=[])).push(0-n,r),s&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n,s),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n,s))}(e,s[e],t)}finally{null!==m&&$a(m),Hf(c),o.resolving=!1,J1()}}return r}function uv(n,t,e){return!!(e[t+(n>>5)]&1<<n)}function dv(n,t){return!(n&hn.Self||n&hn.Host&&t)}class $c{constructor(t,e){this._tNode=t,this._lView=e}get(t,e,i){return lv(this._tNode,this._lView,t,i,e)}}function vr(n){return va(()=>{const t=n.prototype.constructor,e=t[Yo]||tm(t),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const s=r[Yo]||tm(r);if(s&&s!==e)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function tm(n){return ac(n)?()=>{const t=tm(ln(n));return t&&t()}:pl(n)}const bc="__parameters__";function Cc(n,t,e){return va(()=>{const i=function im(n){return function(...e){if(n){const i=n(...e);for(const r in i)this[r]=i[r]}}}(t);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return c.annotation=o,c;function c(m,I,Z){const fe=m.hasOwnProperty(bc)?m[bc]:Object.defineProperty(m,bc,{value:[]})[bc];for(;fe.length<=Z;)fe.push(null);return(fe[Z]=fe[Z]||[]).push(o),m}}return e&&(r.prototype=Object.create(e.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}class Dn{constructor(t,e){this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=tn({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return`InjectionToken ${this._desc}`}}function Ms(n,t){void 0===t&&(t=n);for(let e=0;e<n.length;e++){let i=n[e];Array.isArray(i)?(t===n&&(t=n.slice(0,e)),Ms(i,t)):t!==n&&t.push(i)}return t}function vo(n,t){n.forEach(e=>Array.isArray(e)?vo(e,t):t(e))}function hv(n,t,e){t>=n.length?n.push(e):n.splice(t,0,e)}function qf(n,t){return t>=n.length-1?n.pop():n.splice(t,1)[0]}function Hu(n,t){const e=[];for(let i=0;i<n;i++)e.push(t);return e}function ds(n,t,e){let i=xc(n,t);return i>=0?n[1|i]=e:(i=~i,function SM(n,t,e,i){let r=n.length;if(r==t)n.push(e,i);else if(1===r)n.push(i,n[0]),n[0]=e;else{for(r--,n.push(n[r-1],n[r]);r>t;)n[r]=n[r-2],r--;n[t]=e,n[t+1]=i}}(n,i,t,e)),i}function sm(n,t){const e=xc(n,t);if(e>=0)return n[1|e]}function xc(n,t){return function mv(n,t,e){let i=0,r=n.length>>e;for(;r!==i;){const s=i+(r-i>>1),o=n[s<<e];if(t===o)return s<<e;o>t?r=s:i=s+1}return~(r<<e)}(n,t,1)}const Uu={},am="__NG_DI_FLAG__",Kf="ngTempTokenPath",FM=/\n/gm,$v="__source",RM=Sn({provide:String,useValue:Sn});let Vu;function vv(n){const t=Vu;return Vu=n,t}function BM(n,t=hn.Default){if(void 0===Vu)throw new Mt(203,"");return null===Vu?k1(n,void 0,t):Vu.get(n,t&hn.Optional?null:void 0,t)}function rn(n,t=hn.Default){return(function wS(){return Sg}()||BM)(ln(n),t)}const LM=rn;function lm(n){const t=[];for(let e=0;e<n.length;e++){const i=ln(n[e]);if(Array.isArray(i)){if(0===i.length)throw new Mt(900,"");let r,s=hn.Default;for(let o=0;o<i.length;o++){const c=i[o],m=zM(c);"number"==typeof m?-1===m?r=c.token:s|=m:r=c}t.push(rn(r,s))}else t.push(rn(i))}return t}function Gu(n,t){return n[am]=t,n.prototype[am]=t,n}function zM(n){return n[am]}const Yf=Gu(Cc("Optional"),8),Zf=Gu(Cc("SkipSelf"),4);let Qf,Jf;function Ec(n){var t;return(null===(t=function dm(){if(void 0===Qf&&(Qf=null,Jn.trustedTypes))try{Qf=Jn.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch(n){}return Qf}())||void 0===t?void 0:t.createHTML(n))||n}function Ev(n){var t;return(null===(t=function fm(){if(void 0===Jf&&(Jf=null,Jn.trustedTypes))try{Jf=Jn.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch(n){}return Jf}())||void 0===t?void 0:t.createHTML(n))||n}class gl{constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class JM extends gl{getTypeName(){return"HTML"}}class ek extends gl{getTypeName(){return"Style"}}class tk extends gl{getTypeName(){return"Script"}}class nk extends gl{getTypeName(){return"URL"}}class ik extends gl{getTypeName(){return"ResourceURL"}}function fs(n){return n instanceof gl?n.changingThisBreaksApplicationSecurity:n}function bo(n,t){const e=Sv(n);if(null!=e&&e!==t){if("ResourceURL"===e&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${e} (see https://g.co/ng/security#xss)`)}return e===t}function Sv(n){return n instanceof gl&&n.getTypeName()||null}class ck{constructor(t){this.inertDocumentHelper=t}getInertBodyElement(t){t="<body><remove></remove>"+t;try{const e=(new window.DOMParser).parseFromString(Ec(t),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(t):(e.removeChild(e.firstChild),e)}catch(e){return null}}}class uk{constructor(t){if(this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e);const i=this.inertDocument.createElement("body");e.appendChild(i)}}getInertBodyElement(t){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=Ec(t),e;const i=this.inertDocument.createElement("body");return i.innerHTML=Ec(t),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(i),i}stripCustomNsAttrs(t){const e=t.attributes;for(let r=e.length-1;0<r;r--){const o=e.item(r).name;("xmlns:ns1"===o||0===o.indexOf("ns1:"))&&t.removeAttribute(o)}let i=t.firstChild;for(;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}const fk=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,hk=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Wu(n){return(n=String(n)).match(fk)||n.match(hk)?n:"unsafe:"+n}function kv(n){return(n=String(n)).split(",").map(t=>Wu(t.trim())).join(", ")}function yo(n){const t={};for(const e of n.split(","))t[e]=!0;return t}function Ku(...n){const t={};for(const e of n)for(const i in e)e.hasOwnProperty(i)&&(t[i]=!0);return t}const Dv=yo("area,br,col,hr,img,wbr"),Av=yo("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Pv=yo("rp,rt"),hm=Ku(Dv,Ku(Av,yo("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Ku(Pv,yo("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Ku(Pv,Av)),pm=yo("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),gm=yo("srcset"),Nv=Ku(pm,gm,yo("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),yo("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),pk=yo("script,style,template");class gk{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(t){let e=t.firstChild,i=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?i=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,i&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let r=this.checkClobberedElement(e,e.nextSibling);if(r){e=r;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(t){const e=t.nodeName.toLowerCase();if(!hm.hasOwnProperty(e))return this.sanitizedSomething=!0,!pk.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const i=t.attributes;for(let r=0;r<i.length;r++){const s=i.item(r),o=s.name,c=o.toLowerCase();if(!Nv.hasOwnProperty(c)){this.sanitizedSomething=!0;continue}let m=s.value;pm[c]&&(m=Wu(m)),gm[c]&&(m=kv(m)),this.buf.push(" ",o,'="',Fv(m),'"')}return this.buf.push(">"),!0}endElement(t){const e=t.nodeName.toLowerCase();hm.hasOwnProperty(e)&&!Dv.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(t){this.buf.push(Fv(t))}checkClobberedElement(t,e){if(e&&(t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`);return e}}const mk=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,_k=/([^\#-~ |!])/g;function Fv(n){return n.replace(/&/g,"&amp;").replace(mk,function(t){return"&#"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536)+";"}).replace(_k,function(t){return"&#"+t.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let eh;function Ov(n,t){let e=null;try{eh=eh||function Mv(n){const t=new uk(n);return function dk(){try{return!!(new window.DOMParser).parseFromString(Ec(""),"text/html")}catch(n){return!1}}()?new ck(t):t}(n);let i=t?String(t):"";e=eh.getInertBodyElement(i);let r=5,s=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=s,s=e.innerHTML,e=eh.getInertBodyElement(i)}while(i!==s);return Ec((new gk).sanitizeChildren(mm(e)||e))}finally{if(e){const i=mm(e)||e;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function mm(n){return"content"in n&&function $k(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var ci=(()=>((ci=ci||{})[ci.NONE=0]="NONE",ci[ci.HTML=1]="HTML",ci[ci.STYLE=2]="STYLE",ci[ci.SCRIPT=3]="SCRIPT",ci[ci.URL=4]="URL",ci[ci.RESOURCE_URL=5]="RESOURCE_URL",ci))();function qi(n){const t=Yu();return t?Ev(t.sanitize(ci.HTML,n)||""):bo(n,"HTML")?Ev(fs(n)):Ov(zg(),qt(n))}function Jt(n){const t=Yu();return t?t.sanitize(ci.URL,n)||"":bo(n,"URL")?fs(n):Wu(qt(n))}function Yu(){const n=gt();return n&&n[12]}const Lv="__ngContext__";function br(n,t){n[Lv]=t}function $m(n){const t=function Zu(n){return n[Lv]||null}(n);return t?Array.isArray(t)?t:t.lView:null}function bm(n){return n.ngOriginalError}function Nk(n,...t){n.error(...t)}class Xu{constructor(){this._console=console}handleError(t){const e=this._findOriginalError(t),i=function Pk(n){return n&&n.ngErrorLogger||Nk}(t);i(this._console,"ERROR",t),e&&i(this._console,"ORIGINAL ERROR",e)}_findOriginalError(t){let e=t&&bm(t);for(;e&&bm(e);)e=bm(e);return e||null}}const Vk=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Jn))();function th(n){return n.ownerDocument}function Co(n){return n instanceof Function?n():n}var hs=(()=>((hs=hs||{})[hs.Important=1]="Important",hs[hs.DashCase=2]="DashCase",hs))();function Cm(n,t){return undefined(n,t)}function Qu(n){const t=n[3];return Qs(t)?t[3]:t}function xm(n){return Kv(n[13])}function wm(n){return Kv(n[4])}function Kv(n){for(;null!==n&&!Qs(n);)n=n[4];return n}function Ic(n,t,e,i,r){if(null!=i){let s,o=!1;Qs(i)?s=i:_o(i)&&(o=!0,i=i[0]);const c=Fi(i);0===n&&null!==e?null==r?eb(t,e,c):ml(t,e,c,r||null,!0):1===n&&null!==e?ml(t,e,c,r||null,!0):2===n?function ab(n,t,e){const i=nh(n,t);i&&function iD(n,t,e,i){Ti(n)?n.removeChild(t,e,i):t.removeChild(e)}(n,i,t,e)}(t,c,o):3===n&&t.destroyNode(c),null!=s&&function oD(n,t,e,i,r){const s=e[7];s!==Fi(e)&&Ic(t,n,i,s,r);for(let c=10;c<e.length;c++){const m=e[c];Ju(m[1],m,n,t,i,s)}}(t,n,s,e,r)}}function Tm(n,t,e){if(Ti(n))return n.createElement(t,e);{const i=null!==e?function US(n){const t=n.toLowerCase();return"svg"===t?"http://www.w3.org/2000/svg":"math"===t?"http://www.w3.org/1998/MathML/":null}(e):null;return null===i?n.createElement(t):n.createElementNS(i,t)}}function Zv(n,t){const e=n[9],i=e.indexOf(t),r=t[3];1024&t[2]&&(t[2]&=-1025,Ug(r,-1)),e.splice(i,1)}function Im(n,t){if(n.length<=10)return;const e=10+t,i=n[e];if(i){const r=i[17];null!==r&&r!==n&&Zv(r,i),t>0&&(n[e-1][4]=i[4]);const s=qf(n,10+t);!function Yk(n,t){Ju(n,t,t[11],2,null,null),t[0]=null,t[6]=null}(i[1],i);const o=s[19];null!==o&&o.detachView(s[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function Xv(n,t){if(!(256&t[2])){const e=t[11];Ti(e)&&e.destroyNode&&Ju(n,t,e,3,null,null),function Qk(n){let t=n[13];if(!t)return Sm(n[1],n);for(;t;){let e=null;if(_o(t))e=t[13];else{const i=t[10];i&&(e=i)}if(!e){for(;t&&!t[4]&&t!==n;)_o(t)&&Sm(t[1],t),t=t[3];null===t&&(t=n),_o(t)&&Sm(t[1],t),e=t&&t[4]}t=e}}(t)}}function Sm(n,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function nD(n,t){let e;if(null!=n&&null!=(e=n.destroyHooks))for(let i=0;i<e.length;i+=2){const r=t[e[i]];if(!(r instanceof Ou)){const s=e[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const c=r[s[o]],m=s[o+1];try{m.call(c)}finally{}}else try{s.call(r)}finally{}}}}(n,t),function tD(n,t){const e=n.cleanup,i=t[7];let r=-1;if(null!==e)for(let s=0;s<e.length-1;s+=2)if("string"==typeof e[s]){const o=e[s+1],c="function"==typeof o?o(t):Fi(t[o]),m=i[r=e[s+2]],I=e[s+3];"boolean"==typeof I?c.removeEventListener(e[s],m,I):I>=0?i[r=I]():i[r=-I].unsubscribe(),s+=2}else{const o=i[r=e[s+1]];e[s].call(o)}if(null!==i){for(let s=r+1;s<i.length;s++)i[s]();t[7]=null}}(n,t),1===t[1].type&&Ti(t[11])&&t[11].destroy();const e=t[17];if(null!==e&&Qs(t[3])){e!==t[3]&&Zv(e,t);const i=t[19];null!==i&&i.detachView(n)}}}function Qv(n,t,e){return function Jv(n,t,e){let i=t;for(;null!==i&&40&i.type;)i=(t=i).parent;if(null===i)return e[0];if(2&i.flags){const r=n.data[i.directiveStart].encapsulation;if(r===Zs.None||r===Zs.Emulated)return null}return Ss(i,e)}(n,t.parent,e)}function ml(n,t,e,i,r){Ti(n)?n.insertBefore(t,e,i,r):t.insertBefore(e,i,r)}function eb(n,t,e){Ti(n)?n.appendChild(t,e):t.appendChild(e)}function tb(n,t,e,i,r){null!==i?ml(n,t,e,i,r):eb(n,t,e)}function nh(n,t){return Ti(n)?n.parentNode(t):t.parentNode}function nb(n,t,e){return rb(n,t,e)}let rb=function ib(n,t,e){return 40&n.type?Ss(n,e):null};function ih(n,t,e,i){const r=Qv(n,i,t),s=t[11],c=nb(i.parent||t[6],i,t);if(null!=r)if(Array.isArray(e))for(let m=0;m<e.length;m++)tb(s,r,e[m],c,!1);else tb(s,r,e,c,!1)}function rh(n,t){if(null!==t){const e=t.type;if(3&e)return Ss(t,n);if(4&e)return km(-1,n[t.index]);if(8&e){const i=t.child;if(null!==i)return rh(n,i);{const r=n[t.index];return Qs(r)?km(-1,r):Fi(r)}}if(32&e)return Cm(t,n)()||Fi(n[t.index]);{const i=ob(n,t);return null!==i?Array.isArray(i)?i[0]:rh(Qu(n[16]),i):rh(n,t.next)}}return null}function ob(n,t){return null!==t?n[16][6].projection[t.projection]:null}function km(n,t){const e=10+n+1;if(e<t.length){const i=t[e],r=i[1].firstChild;if(null!==r)return rh(i,r)}return t[7]}function Dm(n,t,e,i,r,s,o){for(;null!=e;){const c=i[e.index],m=e.type;if(o&&0===t&&(c&&br(Fi(c),i),e.flags|=4),64!=(64&e.flags))if(8&m)Dm(n,t,e.child,i,r,s,!1),Ic(t,n,r,c,s);else if(32&m){const I=Cm(e,i);let Z;for(;Z=I();)Ic(t,n,r,Z,s);Ic(t,n,r,c,s)}else 16&m?lb(n,t,i,e,r,s):Ic(t,n,r,c,s);e=o?e.projectionNext:e.next}}function Ju(n,t,e,i,r,s){Dm(e,i,n.firstChild,t,r,s,!1)}function lb(n,t,e,i,r,s){const o=e[16],m=o[6].projection[i.projection];if(Array.isArray(m))for(let I=0;I<m.length;I++)Ic(t,n,r,m[I],s);else Dm(n,t,m,o[3],r,s,!0)}function cb(n,t,e){Ti(n)?n.setAttribute(t,"style",e):t.style.cssText=e}function Am(n,t,e){Ti(n)?""===e?n.removeAttribute(t,"class"):n.setAttribute(t,"class",e):t.className=e}function ub(n,t,e){let i=n.length;for(;;){const r=n.indexOf(t,e);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const s=t.length;if(r+s===i||n.charCodeAt(r+s)<=32)return r}e=r+1}}const db="ng-template";function lD(n,t,e){let i=0;for(;i<n.length;){let r=n[i++];if(e&&"class"===r){if(r=n[i],-1!==ub(r.toLowerCase(),t,0))return!0}else if(1===r){for(;i<n.length&&"string"==typeof(r=n[i++]);)if(r.toLowerCase()===t)return!0;return!1}}return!1}function fb(n){return 4===n.type&&n.value!==db}function cD(n,t,e){return t===(4!==n.type||e?n.value:db)}function uD(n,t,e){let i=4;const r=n.attrs||[],s=function hD(n){for(let t=0;t<n.length;t++)if(tv(n[t]))return t;return n.length}(r);let o=!1;for(let c=0;c<t.length;c++){const m=t[c];if("number"!=typeof m){if(!o)if(4&i){if(i=2|1&i,""!==m&&!cD(n,m,e)||""===m&&1===t.length){if(to(i))return!1;o=!0}}else{const I=8&i?m:t[++c];if(8&i&&null!==n.attrs){if(!lD(n.attrs,I,e)){if(to(i))return!1;o=!0}continue}const fe=dD(8&i?"class":m,r,fb(n),e);if(-1===fe){if(to(i))return!1;o=!0;continue}if(""!==I){let pe;pe=fe>s?"":r[fe+1].toLowerCase();const ye=8&i?pe:null;if(ye&&-1!==ub(ye,I,0)||2&i&&I!==pe){if(to(i))return!1;o=!0}}}}else{if(!o&&!to(i)&&!to(m))return!1;if(o&&to(m))continue;o=!1,i=m|1&i}}return to(i)||o}function to(n){return 0==(1&n)}function dD(n,t,e,i){if(null===t)return-1;let r=0;if(i||!e){let s=!1;for(;r<t.length;){const o=t[r];if(o===n)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let c=t[++r];for(;"string"==typeof c;)c=t[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function pD(n,t){let e=n.indexOf(4);if(e>-1)for(e++;e<n.length;){const i=n[e];if("number"==typeof i)return-1;if(i===t)return e;e++}return-1}(t,n)}function hb(n,t,e=!1){for(let i=0;i<t.length;i++)if(uD(n,t[i],e))return!0;return!1}function gD(n,t){e:for(let e=0;e<t.length;e++){const i=t[e];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function pb(n,t){return n?":not("+t.trim()+")":t}function mD(n){let t=n[0],e=1,i=2,r="",s=!1;for(;e<n.length;){let o=n[e];if("string"==typeof o)if(2&i){const c=n[++e];r+="["+o+(c.length>0?'="'+c+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!to(o)&&(t+=pb(s,r),r=""),i=o,s=s||!to(i);e++}return""!==r&&(t+=pb(s,r)),t}const dn={};function U(n){gb(Bn(),gt(),Nr()+n,!1)}function gb(n,t,e,i){if(!i)if(3==(3&t[2])){const s=n.preOrderCheckHooks;null!==s&&Bf(t,s,e)}else{const s=n.preOrderHooks;null!==s&&Lf(t,s,0,e)}Ca(e)}function sh(n,t){return n<<17|t<<2}function no(n){return n>>17&32767}function Pm(n){return 2|n}function Qo(n){return(131068&n)>>2}function Nm(n,t){return-131069&n|t<<2}function Fm(n){return 1|n}function Tb(n,t){const e=n.contentQueries;if(null!==e)for(let i=0;i<e.length;i+=2){const r=e[i],s=e[i+1];if(-1!==s){const o=n.data[s];Kg(r),o.contentQueries(2,t[s],s)}}}function ed(n,t,e,i,r,s,o,c,m,I){const Z=t.blueprint.slice();return Z[0]=r,Z[2]=140|i,H1(Z),Z[3]=Z[15]=n,Z[8]=e,Z[10]=o||n&&n[10],Z[11]=c||n&&n[11],Z[12]=m||n&&n[12]||null,Z[9]=I||n&&n[9]||null,Z[6]=s,Z[16]=2==t.type?n[16]:Z,Z}function Sc(n,t,e,i,r){let s=n.data[t];if(null===s)s=function Vm(n,t,e,i,r){const s=G1(),o=Vg(),m=n.data[t]=function ND(n,t,e,i,r,s){return{type:e,index:i,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,e,t,i,r);return null===n.firstChild&&(n.firstChild=m),null!==s&&(o?null==s.child&&null!==m.parent&&(s.child=m):null===s.next&&(s.next=m)),m}(n,t,e,i,r),function tM(){return un.lFrame.inI18n}()&&(s.flags|=64);else if(64&s.type){s.type=e,s.value=i,s.attrs=r;const o=function Fu(){const n=un.lFrame,t=n.currentTNode;return n.isParent?t:t.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return $o(s,!0),s}function Mc(n,t,e,i){if(0===e)return-1;const r=t.length;for(let s=0;s<e;s++)t.push(i),n.blueprint.push(i),n.data.push(null);return r}function td(n,t,e){Ff(t);try{const i=n.viewQuery;null!==i&&Jm(1,i,e);const r=n.template;null!==r&&Ib(n,t,r,1,e),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&Tb(n,t),n.staticViewQueries&&Jm(2,n.viewQuery,e);const s=n.components;null!==s&&function DD(n,t){for(let e=0;e<t.length;e++)QD(n,t[e])}(t,s)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{t[2]&=-5,Of()}}function kc(n,t,e,i){const r=t[2];if(256!=(256&r)){Ff(t);try{H1(t),function q1(n){return un.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==e&&Ib(n,t,e,2,i);const o=3==(3&r);if(o){const I=n.preOrderCheckHooks;null!==I&&Bf(t,I,null)}else{const I=n.preOrderHooks;null!==I&&Lf(t,I,0,null),Yg(t,0)}if(function ZD(n){for(let t=xm(n);null!==t;t=wm(t)){if(!t[2])continue;const e=t[9];for(let i=0;i<e.length;i++){const r=e[i],s=r[3];0==(1024&r[2])&&Ug(s,1),r[2]|=1024}}}(t),function YD(n){for(let t=xm(n);null!==t;t=wm(t))for(let e=10;e<t.length;e++){const i=t[e],r=i[1];Hg(i)&&kc(r,i,r.template,i[8])}}(t),null!==n.contentQueries&&Tb(n,t),o){const I=n.contentCheckHooks;null!==I&&Bf(t,I)}else{const I=n.contentHooks;null!==I&&Lf(t,I,1),Yg(t,1)}!function MD(n,t){const e=n.hostBindingOpCodes;if(null!==e)try{for(let i=0;i<e.length;i++){const r=e[i];if(r<0)Ca(~r);else{const s=r,o=e[++i],c=e[++i];nM(o,s),c(2,t[s])}}}finally{Ca(-1)}}(n,t);const c=n.components;null!==c&&function kD(n,t){for(let e=0;e<t.length;e++)XD(n,t[e])}(t,c);const m=n.viewQuery;if(null!==m&&Jm(2,m,i),o){const I=n.viewCheckHooks;null!==I&&Bf(t,I)}else{const I=n.viewHooks;null!==I&&Lf(t,I,2),Yg(t,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),t[2]&=-73,1024&t[2]&&(t[2]&=-1025,Ug(t[3],-1))}finally{Of()}}}function AD(n,t,e,i){const r=t[10],o=j1(t);try{!o&&r.begin&&r.begin(),o&&td(n,t,i),kc(n,t,e,i)}finally{!o&&r.end&&r.end()}}function Ib(n,t,e,i,r){const s=Nr(),o=2&i;try{Ca(-1),o&&t.length>20&&gb(n,t,20,!1),e(i,r)}finally{Ca(s)}}function Sb(n,t,e){if(Ng(t)){const r=t.directiveEnd;for(let s=t.directiveStart;s<r;s++){const o=n.data[s];o.contentQueries&&o.contentQueries(1,e[s],s)}}}function Gm(n,t,e){!V1()||(function jD(n,t,e,i){const r=e.directiveStart,s=e.directiveEnd;n.firstCreatePass||Bu(e,t),br(i,t);const o=e.initialInputs;for(let c=r;c<s;c++){const m=n.data[c],I=Js(m);I&&qD(t,e,m);const Z=Lu(t,n,c,e);br(Z,t),null!==o&&WD(0,c-r,Z,m,0,o),I&&(us(e.index,t)[8]=Z)}}(n,t,e,Ss(e,t)),128==(128&e.flags)&&function HD(n,t,e){const i=e.directiveStart,r=e.directiveEnd,o=e.index,c=function iM(){return un.lFrame.currentDirectiveIndex}();try{Ca(o);for(let m=i;m<r;m++){const I=n.data[m],Z=t[m];qg(m),(null!==I.hostBindings||0!==I.hostVars||null!==I.hostAttrs)&&Ob(I,Z)}}finally{Ca(-1),qg(c)}}(n,t,e))}function qm(n,t,e=Ss){const i=t.localNames;if(null!==i){let r=t.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],c=-1===o?e(t,n):n[o];n[r++]=c}}}function Mb(n){const t=n.tView;return null===t||t.incompleteFirstPass?n.tView=lh(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):t}function lh(n,t,e,i,r,s,o,c,m,I){const Z=20+i,fe=Z+r,pe=function PD(n,t){const e=[];for(let i=0;i<t;i++)e.push(i<n?null:dn);return e}(Z,fe),ye="function"==typeof I?I():I;return pe[1]={type:n,blueprint:pe,template:e,queries:null,viewQuery:c,declTNode:t,data:pe.slice().fill(null,Z),bindingStartIndex:Z,expandoStartIndex:fe,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:m,consts:ye,incompleteFirstPass:!1}}function Ab(n,t,e,i){const r=Hb(t);null===e?r.push(i):(r.push(e),n.firstCreatePass&&Ub(n).push(i,r.length-1))}function Pb(n,t,e){for(let i in n)if(n.hasOwnProperty(i)){const r=n[i];(e=null===e?{}:e).hasOwnProperty(i)?e[i].push(t,r):e[i]=[t,r]}return e}function ps(n,t,e,i,r,s,o,c){const m=Ss(t,e);let Z,I=t.inputs;!c&&null!=I&&(Z=I[i])?(qb(n,e,Z,i,r),Df(t)&&function RD(n,t){const e=us(t,n);16&e[2]||(e[2]|=64)}(e,t.index)):3&t.type&&(i=function OD(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=o?o(r,t.value||"",i):r,Ti(s)?s.setProperty(m,i,r):Xg(i)||(m.setProperty?m.setProperty(i,r):m[i]=r))}function Wm(n,t,e,i){let r=!1;if(V1()){const s=function UD(n,t,e){const i=n.directiveRegistry;let r=null;if(i)for(let s=0;s<i.length;s++){const o=i[s];hb(e,o.selectors,!1)&&(r||(r=[]),Vf(Bu(e,t),n,o.type),Js(o)?(Rb(n,e),r.unshift(o)):r.push(o))}return r}(n,t,e),o=null===i?null:{"":-1};if(null!==s){r=!0,Bb(e,n.data.length,s.length);for(let Z=0;Z<s.length;Z++){const fe=s[Z];fe.providersResolver&&fe.providersResolver(fe)}let c=!1,m=!1,I=Mc(n,t,s.length,null);for(let Z=0;Z<s.length;Z++){const fe=s[Z];e.mergedAttrs=jf(e.mergedAttrs,fe.hostAttrs),Lb(n,e,t,I,fe),GD(I,fe,o),null!==fe.contentQueries&&(e.flags|=8),(null!==fe.hostBindings||null!==fe.hostAttrs||0!==fe.hostVars)&&(e.flags|=128);const pe=fe.type.prototype;!c&&(pe.ngOnChanges||pe.ngOnInit||pe.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e.index),c=!0),!m&&(pe.ngOnChanges||pe.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e.index),m=!0),I++}!function FD(n,t){const i=t.directiveEnd,r=n.data,s=t.attrs,o=[];let c=null,m=null;for(let I=t.directiveStart;I<i;I++){const Z=r[I],fe=Z.inputs,pe=null===s||fb(t)?null:KD(fe,s);o.push(pe),c=Pb(fe,I,c),m=Pb(Z.outputs,I,m)}null!==c&&(c.hasOwnProperty("class")&&(t.flags|=16),c.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=o,t.inputs=c,t.outputs=m}(n,e)}o&&function VD(n,t,e){if(t){const i=n.localNames=[];for(let r=0;r<t.length;r+=2){const s=e[t[r+1]];if(null==s)throw new Mt(-301,!1);i.push(t[r],s)}}}(e,i,o)}return e.mergedAttrs=jf(e.mergedAttrs,e.attrs),r}function Fb(n,t,e,i,r,s){const o=s.hostBindings;if(o){let c=n.hostBindingOpCodes;null===c&&(c=n.hostBindingOpCodes=[]);const m=~t.index;(function zD(n){let t=n.length;for(;t>0;){const e=n[--t];if("number"==typeof e&&e<0)return e}return 0})(c)!=m&&c.push(m),c.push(i,r,o)}}function Ob(n,t){null!==n.hostBindings&&n.hostBindings(1,t)}function Rb(n,t){t.flags|=2,(n.components||(n.components=[])).push(t.index)}function GD(n,t,e){if(e){if(t.exportAs)for(let i=0;i<t.exportAs.length;i++)e[t.exportAs[i]]=n;Js(t)&&(e[""]=n)}}function Bb(n,t,e){n.flags|=1,n.directiveStart=t,n.directiveEnd=t+e,n.providerIndexes=t}function Lb(n,t,e,i,r){n.data[i]=r;const s=r.factory||(r.factory=pl(r.type)),o=new Ou(s,Js(r),null);n.blueprint[i]=o,e[i]=o,Fb(n,t,0,i,Mc(n,e,r.hostVars,dn),r)}function qD(n,t,e){const i=Ss(t,n),r=Mb(e),s=n[10],o=ch(n,ed(n,r,null,e.onPush?64:16,i,t,s,s.createRenderer(i,e),null,null));n[t.index]=o}function xo(n,t,e,i,r,s){const o=Ss(n,t);!function Km(n,t,e,i,r,s,o){if(null==s)Ti(n)?n.removeAttribute(t,r,e):t.removeAttribute(r);else{const c=null==o?qt(s):o(s,i||"",r);Ti(n)?n.setAttribute(t,r,c,e):e?t.setAttributeNS(e,r,c):t.setAttribute(r,c)}}(t[11],o,s,n.value,e,i,r)}function WD(n,t,e,i,r,s){const o=s[t];if(null!==o){const c=i.setInput;for(let m=0;m<o.length;){const I=o[m++],Z=o[m++],fe=o[m++];null!==c?i.setInput(e,fe,I,Z):e[Z]=fe}}}function KD(n,t){let e=null,i=0;for(;i<t.length;){const r=t[i];if(0!==r)if(5!==r){if("number"==typeof r)break;n.hasOwnProperty(r)&&(null===e&&(e=[]),e.push(r,n[r],t[i+1])),i+=2}else i+=2;else i+=4}return e}function zb(n,t,e,i){return new Array(n,!0,!1,t,null,0,i,e,null,null)}function XD(n,t){const e=us(t,n);if(Hg(e)){const i=e[1];80&e[2]?kc(i,e,i.template,e[8]):e[5]>0&&Ym(e)}}function Ym(n){for(let i=xm(n);null!==i;i=wm(i))for(let r=10;r<i.length;r++){const s=i[r];if(1024&s[2]){const o=s[1];kc(o,s,o.template,s[8])}else s[5]>0&&Ym(s)}const e=n[1].components;if(null!==e)for(let i=0;i<e.length;i++){const r=us(e[i],n);Hg(r)&&r[5]>0&&Ym(r)}}function QD(n,t){const e=us(t,n),i=e[1];(function JD(n,t){for(let e=t.length;e<n.blueprint.length;e++)t.push(n.blueprint[e])})(i,e),td(i,e,e[8])}function ch(n,t){return n[13]?n[14][4]=t:n[13]=t,n[14]=t,t}function Zm(n){for(;n;){n[2]|=64;const t=Qu(n);if(PS(n)&&!t)return n;n=t}return null}function jb(n){!function Xm(n){for(let t=0;t<n.components.length;t++){const e=n.components[t],i=$m(e),r=i[1];AD(r,i,r.template,e)}}(n[8])}function Jm(n,t,e){Kg(0),t(n,e)}const tA=(()=>Promise.resolve(null))();function Hb(n){return n[7]||(n[7]=[])}function Ub(n){return n.cleanup||(n.cleanup=[])}function Gb(n,t){const e=n[9],i=e?e.get(Xu,null):null;i&&i.handleError(t)}function qb(n,t,e,i,r){for(let s=0;s<e.length;){const o=e[s++],c=e[s++],m=t[o],I=n.data[o];null!==I.setInput?I.setInput(m,r,i,c):m[c]=r}}function Jo(n,t,e){const i=Pf(t,n);!function Yv(n,t,e){Ti(n)?n.setValue(t,e):t.textContent=e}(n[11],i,e)}function uh(n,t,e){let i=e?n.styles:null,r=e?n.classes:null,s=0;if(null!==t)for(let o=0;o<t.length;o++){const c=t[o];"number"==typeof c?s=c:1==s?r=ma(r,c):2==s&&(i=ma(i,c+": "+t[++o]+";"))}e?n.styles=i:n.stylesWithoutHost=i,e?n.classes=r:n.classesWithoutHost=r}const e_=new Dn("INJECTOR",-1);class Wb{get(t,e=Uu){if(e===Uu){const i=new Error(`NullInjectorError: No provider for ${Un(t)}!`);throw i.name="NullInjectorError",i}return e}}const t_=new Dn("Set Injector scope."),nd={},rA={};let n_;function Kb(){return void 0===n_&&(n_=new Wb),n_}function Yb(n,t=null,e=null,i){const r=Zb(n,t,e,i);return r._resolveInjectorDefTypes(),r}function Zb(n,t=null,e=null,i){return new sA(n,e,t||Kb(),i)}class sA{constructor(t,e,i,r=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];e&&vo(e,c=>this.processProvider(c,t,e)),vo([t],c=>this.processInjectorType(c,[],s)),this.records.set(e_,Dc(void 0,this));const o=this.records.get(t_);this.scope=null!=o?o.value:null,this.source=r||("object"==typeof t?null:Un(t))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(t=>t.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(t,e=Uu,i=hn.Default){this.assertNotDestroyed();const r=vv(this),s=$a(void 0);try{if(!(i&hn.SkipSelf)){let c=this.records.get(t);if(void 0===c){const m=function hA(n){return"function"==typeof n||"object"==typeof n&&n instanceof Dn}(t)&&Tg(t);c=m&&this.injectableDefInScope(m)?Dc(i_(t),nd):null,this.records.set(t,c)}if(null!=c)return this.hydrate(t,c)}return(i&hn.Self?Kb():this.parent).get(t,e=i&hn.Optional&&e===Uu?null:e)}catch(o){if("NullInjectorError"===o.name){if((o[Kf]=o[Kf]||[]).unshift(Un(t)),r)throw o;return function jM(n,t,e,i){const r=n[Kf];throw t[$v]&&r.unshift(t[$v]),n.message=function HM(n,t,e,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.substr(2):n;let r=Un(t);if(Array.isArray(t))r=t.map(Un).join(" -> ");else if("object"==typeof t){let s=[];for(let o in t)if(t.hasOwnProperty(o)){let c=t[o];s.push(o+":"+("string"==typeof c?JSON.stringify(c):Un(c)))}r=`{${s.join(", ")}}`}return`${e}${i?"("+i+")":""}[${r}]: ${n.replace(FM,"\n  ")}`}("\n"+n.message,r,e,i),n.ngTokenPath=r,n[Kf]=null,n}(o,t,"R3InjectorError",this.source)}throw o}finally{$a(s),vv(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(t=>this.get(t))}toString(){const t=[];return this.records.forEach((i,r)=>t.push(Un(r))),`R3Injector[${t.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Mt(205,!1)}processInjectorType(t,e,i){if(!(t=ln(t)))return!1;let r=S1(t);const s=null==r&&t.ngModule||void 0,o=void 0===s?t:s,c=-1!==i.indexOf(o);if(void 0!==s&&(r=S1(s)),null==r)return!1;if(null!=r.imports&&!c){let Z;i.push(o);try{vo(r.imports,fe=>{this.processInjectorType(fe,e,i)&&(void 0===Z&&(Z=[]),Z.push(fe))})}finally{}if(void 0!==Z)for(let fe=0;fe<Z.length;fe++){const{ngModule:pe,providers:ye}=Z[fe];vo(ye,we=>this.processProvider(we,pe,ye||si))}}this.injectorDefTypes.add(o);const m=pl(o)||(()=>new o);this.records.set(o,Dc(m,nd));const I=r.providers;if(null!=I&&!c){const Z=t;vo(I,fe=>this.processProvider(fe,Z,I))}return void 0!==s&&void 0!==t.providers}processProvider(t,e,i){let r=Ac(t=ln(t))?t:ln(t&&t.provide);const s=function aA(n,t,e){return Qb(n)?Dc(void 0,n.useValue):Dc(Xb(n),nd)}(t);if(Ac(t)||!0!==t.multi)this.records.get(r);else{let o=this.records.get(r);o||(o=Dc(void 0,nd,!0),o.factory=()=>lm(o.multi),this.records.set(r,o)),r=t,o.multi.push(t)}this.records.set(r,s)}hydrate(t,e){return e.value===nd&&(e.value=rA,e.value=e.factory()),"object"==typeof e.value&&e.value&&function fA(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(e.value)&&this.onDestroy.add(e.value),e.value}injectableDefInScope(t){if(!t.providedIn)return!1;const e=ln(t.providedIn);return"string"==typeof e?"any"===e||e===this.scope:this.injectorDefTypes.has(e)}}function i_(n){const t=Tg(n),e=null!==t?t.factory:pl(n);if(null!==e)return e;if(n instanceof Dn)throw new Mt(204,!1);if(n instanceof Function)return function oA(n){const t=n.length;if(t>0)throw Hu(t,"?"),new Mt(204,!1);const e=function yS(n){const t=n&&(n[Tf]||n[M1]);if(t){const e=function CS(n){if(n.hasOwnProperty("name"))return n.name;const t=(""+n).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${e}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${e}" class.`),t}return null}(n);return null!==e?()=>e.factory(n):()=>new n}(n);throw new Mt(204,!1)}function Xb(n,t,e){let i;if(Ac(n)){const r=ln(n);return pl(r)||i_(r)}if(Qb(n))i=()=>ln(n.useValue);else if(function cA(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...lm(n.deps||[]));else if(function lA(n){return!(!n||!n.useExisting)}(n))i=()=>rn(ln(n.useExisting));else{const r=ln(n&&(n.useClass||n.provide));if(!function dA(n){return!!n.deps}(n))return pl(r)||i_(r);i=()=>new r(...lm(n.deps))}return i}function Dc(n,t,e=!1){return{factory:n,value:t,multi:e?[]:void 0}}function Qb(n){return null!==n&&"object"==typeof n&&RM in n}function Ac(n){return"function"==typeof n}let Yr=(()=>{class n{static create(e,i){var r;if(Array.isArray(e))return Yb({name:""},i,e,"");{const s=null!==(r=e.name)&&void 0!==r?r:"";return Yb({name:s},e.parent,e.providers,s)}}}return n.THROW_IF_NOT_FOUND=Uu,n.NULL=new Wb,n.\u0275prov=tn({token:n,providedIn:"any",factory:()=>rn(e_)}),n.__NG_ELEMENT_ID__=-1,n})();function yA(n,t){Rf($m(n)[1],Vi())}function Yn(n){let t=function uy(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),e=!0;const i=[n];for(;t;){let r;if(Js(n))r=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Mt(903,"");r=t.\u0275dir}if(r){if(e){i.push(r);const o=n;o.inputs=o_(n.inputs),o.declaredInputs=o_(n.declaredInputs),o.outputs=o_(n.outputs);const c=r.hostBindings;c&&EA(n,c);const m=r.viewQuery,I=r.contentQueries;if(m&&xA(n,m),I&&wA(n,I),oc(n.inputs,r.inputs),oc(n.declaredInputs,r.declaredInputs),oc(n.outputs,r.outputs),Js(r)&&r.data.animation){const Z=n.data;Z.animation=(Z.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const c=s[o];c&&c.ngInherit&&c(n),c===Yn&&(e=!1)}}t=Object.getPrototypeOf(t)}!function CA(n){let t=0,e=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=t+=r.hostVars,r.hostAttrs=jf(r.hostAttrs,e=jf(e,r.hostAttrs))}}(i)}function o_(n){return n===cc?{}:n===si?[]:n}function xA(n,t){const e=n.viewQuery;n.viewQuery=e?(i,r)=>{t(i,r),e(i,r)}:t}function wA(n,t){const e=n.contentQueries;n.contentQueries=e?(i,r,s)=>{t(i,r,s),e(i,r,s)}:t}function EA(n,t){const e=n.hostBindings;n.hostBindings=e?(i,r)=>{t(i,r),e(i,r)}:t}let dh=null;function Pc(){if(!dh){const n=Jn.Symbol;if(n&&n.iterator)dh=n.iterator;else{const t=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<t.length;++e){const i=t[e];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(dh=i)}}}return dh}function id(n){return!!a_(n)&&(Array.isArray(n)||!(n instanceof Map)&&Pc()in n)}function a_(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function wo(n,t,e){return n[t]=e}function rd(n,t){return n[t]}function yr(n,t,e){return!Object.is(n[t],e)&&(n[t]=e,!0)}function _l(n,t,e,i){const r=yr(n,t,e);return yr(n,t+1,i)||r}function fh(n,t,e,i,r){const s=_l(n,t,e,i);return yr(n,t+2,r)||s}function ks(n,t,e,i,r,s){const o=_l(n,t,e,i);return _l(n,t+2,r,s)||o}function Rt(n,t,e,i){const r=gt();return yr(r,gc(),t)&&(Bn(),xo(Ii(),r,n,t,e,i)),Rt}function Fc(n,t,e,i){return yr(n,gc(),e)?t+qt(e)+i:dn}function Oc(n,t,e,i,r,s){const c=_l(n,function Zo(){return un.lFrame.bindingIndex}(),e,r);return Xo(2),c?t+qt(e)+i+qt(r)+s:dn}function l_(n,t,e,i,r,s){const o=gt(),c=Fc(o,t,e,i);return c!==dn&&xo(Ii(),o,n,c,r,s),l_}function xe(n,t,e,i,r,s,o,c){const m=gt(),I=Bn(),Z=n+20,fe=I.firstCreatePass?function AA(n,t,e,i,r,s,o,c,m){const I=t.consts,Z=Sc(t,n,4,o||null,ya(I,c));Wm(t,e,Z,ya(I,m)),Rf(t,Z);const fe=Z.tViews=lh(2,Z,i,r,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,I);return null!==t.queries&&(t.queries.template(t,Z),fe.queries=t.queries.embeddedTView(Z)),Z}(Z,I,m,t,e,i,r,s,o):I.data[Z];$o(fe,!1);const pe=m[11].createComment("");ih(I,m,pe,fe),br(pe,m),ch(m,m[Z]=zb(pe,m,pe,fe)),Af(fe)&&Gm(I,m,fe),null!=o&&qm(m,fe,c)}function Wt(n){return pc(function eM(){return un.lFrame.contextLView}(),20+n)}function Le(n,t=hn.Default){const e=gt();return null===e?rn(n,t):lv(Vi(),e,ln(n),t)}function te(n,t,e){const i=gt();return yr(i,gc(),t)&&ps(Bn(),Ii(),i,n,t,i[11],e,!1),te}function h_(n,t,e,i,r){const o=r?"class":"style";qb(n,e,t.inputs[o],o,i)}function K(n,t,e,i){const r=gt(),s=Bn(),o=20+n,c=r[11],m=r[o]=Tm(c,t,function dM(){return un.lFrame.currentNamespace}()),I=s.firstCreatePass?function eP(n,t,e,i,r,s,o){const c=t.consts,I=Sc(t,n,2,r,ya(c,s));return Wm(t,e,I,ya(c,o)),null!==I.attrs&&uh(I,I.attrs,!1),null!==I.mergedAttrs&&uh(I,I.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,I),I}(o,s,r,0,t,e,i):s.data[o];$o(I,!0);const Z=I.mergedAttrs;null!==Z&&zf(c,m,Z);const fe=I.classes;null!==fe&&Am(c,m,fe);const pe=I.styles;return null!==pe&&cb(c,m,pe),64!=(64&I.flags)&&ih(s,r,m,I),0===function YS(){return un.lFrame.elementDepthCount}()&&br(m,r),function ZS(){un.lFrame.elementDepthCount++}(),Af(I)&&(Gm(s,r,I),Sb(s,I,r)),null!==i&&qm(r,I),K}function J(){let n=Vi();Vg()?Gg():(n=n.parent,$o(n,!1));const t=n;!function XS(){un.lFrame.elementDepthCount--}();const e=Bn();return e.firstCreatePass&&(Rf(e,n),Ng(n)&&e.queries.elementEnd(n)),null!=t.classesWithoutHost&&function mM(n){return 0!=(16&n.flags)}(t)&&h_(e,t,gt(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function _M(n){return 0!=(32&n.flags)}(t)&&h_(e,t,gt(),t.stylesWithoutHost,!1),J}function it(n,t,e,i){return K(n,t,e,i),J(),it}function Ve(n,t,e){const i=gt(),r=Bn(),s=n+20,o=r.firstCreatePass?function tP(n,t,e,i,r){const s=t.consts,o=ya(s,i),c=Sc(t,n,8,"ng-container",o);return null!==o&&uh(c,o,!0),Wm(t,e,c,ya(s,r)),null!==t.queries&&t.queries.elementStart(t,c),c}(s,r,i,t,e):r.data[s];$o(o,!0);const c=i[s]=i[11].createComment("");return ih(r,i,c,o),br(c,i),Af(o)&&(Gm(r,i,o),Sb(r,o,i)),null!=e&&qm(i,o),Ve}function Ge(){let n=Vi();const t=Bn();return Vg()?Gg():(n=n.parent,$o(n,!1)),t.firstCreatePass&&(Rf(t,n),Ng(n)&&t.queries.elementEnd(n)),Ge}function pn(n,t,e){return Ve(n,t,e),Ge(),pn}function Xe(){return gt()}function ph(n){return!!n&&"function"==typeof n.then}const ky=function My(n){return!!n&&"function"==typeof n.subscribe};function Te(n,t,e,i){const r=gt(),s=Bn(),o=Vi();return function Ay(n,t,e,i,r,s,o,c){const m=Af(i),Z=n.firstCreatePass&&Ub(n),fe=t[8],pe=Hb(t);let ye=!0;if(3&i.type||c){const Oe=Ss(i,t),Be=c?c(Oe):Oe,ke=pe.length,ze=c?je=>c(Fi(je[i.index])):i.index;if(Ti(e)){let je=null;if(!c&&m&&(je=function nP(n,t,e,i){const r=n.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===e&&r[s+1]===i){const c=t[7],m=r[s+2];return c.length>m?c[m]:null}"string"==typeof o&&(s+=2)}return null}(n,t,r,i.index)),null!==je)(je.__ngLastListenerFn__||je).__ngNextListenerFn__=s,je.__ngLastListenerFn__=s,ye=!1;else{s=p_(i,t,fe,s,!1);const st=e.listen(Be,r,s);pe.push(s,st),Z&&Z.push(r,ze,ke,ke+1)}}else s=p_(i,t,fe,s,!0),Be.addEventListener(r,s,o),pe.push(s),Z&&Z.push(r,ze,ke,o)}else s=p_(i,t,fe,s,!1);const we=i.outputs;let Me;if(ye&&null!==we&&(Me=we[r])){const Oe=Me.length;if(Oe)for(let Be=0;Be<Oe;Be+=2){const ot=t[Me[Be]][Me[Be+1]].subscribe(s),tt=pe.length;pe.push(s,ot),Z&&Z.push(r,i.index,tt,-(tt+1))}}}(s,r,r[11],o,n,t,!!e,i),Te}function Py(n,t,e,i){try{return!1!==e(i)}catch(r){return Gb(n,r),!1}}function p_(n,t,e,i,r){return function s(o){if(o===Function)return i;const c=2&n.flags?us(n.index,t):t;0==(32&t[2])&&Zm(c);let m=Py(t,0,i,o),I=s.__ngNextListenerFn__;for(;I;)m=Py(t,0,I,o)&&m,I=I.__ngNextListenerFn__;return r&&!1===m&&(o.preventDefault(),o.returnValue=!1),m}}function ge(n=1){return function sM(n){return(un.lFrame.contextLView=function oM(n,t){for(;n>0;)t=t[15],n--;return t}(n,un.lFrame.contextLView))[8]}(n)}function iP(n,t){let e=null;const i=function fD(n){const t=n.attrs;if(null!=t){const e=t.indexOf(5);if(0==(1&e))return t[e+1]}return null}(n);for(let r=0;r<t.length;r++){const s=t[r];if("*"!==s){if(null===i?hb(n,s,!0):gD(i,s))return r}else e=r}return e}function g_(n){const t=gt()[16][6];if(!t.projection){const i=t.projection=Hu(n?n.length:1,null),r=i.slice();let s=t.child;for(;null!==s;){const o=n?iP(s,n):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s),s=s.next}}}function m_(n,t=0,e){const i=gt(),r=Bn(),s=Sc(r,20+n,16,null,e||null);null===s.projection&&(s.projection=t),Gg(),64!=(64&s.flags)&&function sD(n,t,e){lb(t[11],0,t,e,Qv(n,e,t),nb(e.parent||t[6],e,t))}(r,i,s)}function ct(n,t,e){return Wi(n,"",t,"",e),ct}function Wi(n,t,e,i,r){const s=gt(),o=Fc(s,t,e,i);return o!==dn&&ps(Bn(),Ii(),s,n,o,s[11],r,!1),Wi}function Hy(n,t,e,i,r){const s=n[e+1],o=null===t;let c=i?no(s):Qo(s),m=!1;for(;0!==c&&(!1===m||o);){const Z=n[c+1];oP(n[c],t)&&(m=!0,n[c+1]=i?Fm(Z):Pm(Z)),c=i?no(Z):Qo(Z)}m&&(n[e+1]=i?Pm(s):Fm(s))}function oP(n,t){return null===n||null==t||(Array.isArray(n)?n[1]:n)===t||!(!Array.isArray(n)||"string"!=typeof t)&&xc(n,t)>=0}const Ki={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Uy(n){return n.substring(Ki.key,Ki.keyEnd)}function aP(n){return n.substring(Ki.value,Ki.valueEnd)}function Vy(n,t){const e=Ki.textEnd;return e===t?-1:(t=Ki.keyEnd=function uP(n,t,e){for(;t<e&&n.charCodeAt(t)>32;)t++;return t}(n,Ki.key=t,e),Vc(n,t,e))}function Gy(n,t){const e=Ki.textEnd;let i=Ki.key=Vc(n,t,e);return e===i?-1:(i=Ki.keyEnd=function dP(n,t,e){let i;for(;t<e&&(45===(i=n.charCodeAt(t))||95===i||(-33&i)>=65&&(-33&i)<=90||i>=48&&i<=57);)t++;return t}(n,i,e),i=Wy(n,i,e),i=Ki.value=Vc(n,i,e),i=Ki.valueEnd=function fP(n,t,e){let i=-1,r=-1,s=-1,o=t,c=o;for(;o<e;){const m=n.charCodeAt(o++);if(59===m)return c;34===m||39===m?c=o=Ky(n,m,o,e):t===o-4&&85===s&&82===r&&76===i&&40===m?c=o=Ky(n,41,o,e):m>32&&(c=o),s=r,r=i,i=-33&m}return c}(n,i,e),Wy(n,i,e))}function qy(n){Ki.key=0,Ki.keyEnd=0,Ki.value=0,Ki.valueEnd=0,Ki.textEnd=n.length}function Vc(n,t,e){for(;t<e&&n.charCodeAt(t)<=32;)t++;return t}function Wy(n,t,e,i){return(t=Vc(n,t,e))<e&&t++,t}function Ky(n,t,e,i){let r=-1,s=e;for(;s<i;){const o=n.charCodeAt(s++);if(o==t&&92!==r)return s;r=92==o&&92===r?0:o}throw new Error}function Ke(n,t,e){return ro(n,t,e,!1),Ke}function gh(n,t){return ro(n,t,null,!0),gh}function ur(n){so(Xy,hP,n,!1)}function hP(n,t){for(let e=function cP(n){return qy(n),Gy(n,Vc(n,0,Ki.textEnd))}(t);e>=0;e=Gy(t,e))Xy(n,Uy(t),aP(t))}function sd(n){so(ds,Eo,n,!0)}function Eo(n,t){for(let e=function lP(n){return qy(n),Vy(n,Vc(n,0,Ki.textEnd))}(t);e>=0;e=Vy(t,e))ds(n,Uy(t),!0)}function ro(n,t,e,i){const r=gt(),s=Bn(),o=Xo(2);s.firstUpdatePass&&Zy(s,n,o,i),t!==dn&&yr(r,o,t)&&Qy(s,s.data[Nr()],r,r[11],n,r[o+1]=function bP(n,t){return null==n||("string"==typeof t?n+=t:"object"==typeof n&&(n=Un(fs(n)))),n}(t,e),i,o)}function so(n,t,e,i){const r=Bn(),s=Xo(2);r.firstUpdatePass&&Zy(r,null,s,i);const o=gt();if(e!==dn&&yr(o,s,e)){const c=r.data[Nr()];if(eC(c,i)&&!Yy(r,s)){let m=i?c.classesWithoutHost:c.stylesWithoutHost;null!==m&&(e=ma(m,e||"")),h_(r,c,o,e,i)}else!function vP(n,t,e,i,r,s,o,c){r===dn&&(r=si);let m=0,I=0,Z=0<r.length?r[0]:null,fe=0<s.length?s[0]:null;for(;null!==Z||null!==fe;){const pe=m<r.length?r[m+1]:void 0,ye=I<s.length?s[I+1]:void 0;let Me,we=null;Z===fe?(m+=2,I+=2,pe!==ye&&(we=fe,Me=ye)):null===fe||null!==Z&&Z<fe?(m+=2,we=Z):(I+=2,we=fe,Me=ye),null!==we&&Qy(n,t,e,i,we,Me,o,c),Z=m<r.length?r[m]:null,fe=I<s.length?s[I]:null}}(r,c,o,o[11],o[s+1],o[s+1]=function $P(n,t,e){if(null==e||""===e)return si;const i=[],r=fs(e);if(Array.isArray(r))for(let s=0;s<r.length;s++)n(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&n(i,s,r[s]);else"string"==typeof r&&t(i,r);return i}(n,t,e),i,s)}}function Yy(n,t){return t>=n.expandoStartIndex}function Zy(n,t,e,i){const r=n.data;if(null===r[e+1]){const s=r[Nr()],o=Yy(n,e);eC(s,i)&&null===t&&!o&&(t=!1),t=function pP(n,t,e,i){const r=function Wg(n){const t=un.lFrame.currentDirectiveIndex;return-1===t?null:n[t]}(n);let s=i?t.residualClasses:t.residualStyles;if(null===r)0===(i?t.classBindings:t.styleBindings)&&(e=od(e=__(null,n,t,e,i),t.attrs,i),s=null);else{const o=t.directiveStylingLast;if(-1===o||n[o]!==r)if(e=__(r,n,t,e,i),null===s){let m=function gP(n,t,e){const i=e?t.classBindings:t.styleBindings;if(0!==Qo(i))return n[no(i)]}(n,t,i);void 0!==m&&Array.isArray(m)&&(m=__(null,n,t,m[1],i),m=od(m,t.attrs,i),function mP(n,t,e,i){n[no(e?t.classBindings:t.styleBindings)]=i}(n,t,i,m))}else s=function _P(n,t,e){let i;const r=t.directiveEnd;for(let s=1+t.directiveStylingLast;s<r;s++)i=od(i,n[s].hostAttrs,e);return od(i,t.attrs,e)}(n,t,i)}return void 0!==s&&(i?t.residualClasses=s:t.residualStyles=s),e}(r,s,t,i),function rP(n,t,e,i,r,s){let o=s?t.classBindings:t.styleBindings,c=no(o),m=Qo(o);n[i]=e;let Z,I=!1;if(Array.isArray(e)){const fe=e;Z=fe[1],(null===Z||xc(fe,Z)>0)&&(I=!0)}else Z=e;if(r)if(0!==m){const pe=no(n[c+1]);n[i+1]=sh(pe,c),0!==pe&&(n[pe+1]=Nm(n[pe+1],i)),n[c+1]=function vD(n,t){return 131071&n|t<<17}(n[c+1],i)}else n[i+1]=sh(c,0),0!==c&&(n[c+1]=Nm(n[c+1],i)),c=i;else n[i+1]=sh(m,0),0===c?c=i:n[m+1]=Nm(n[m+1],i),m=i;I&&(n[i+1]=Pm(n[i+1])),Hy(n,Z,i,!0),Hy(n,Z,i,!1),function sP(n,t,e,i,r){const s=r?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof t&&xc(s,t)>=0&&(e[i+1]=Fm(e[i+1]))}(t,Z,n,i,s),o=sh(c,m),s?t.classBindings=o:t.styleBindings=o}(r,s,t,e,o,i)}}function __(n,t,e,i,r){let s=null;const o=e.directiveEnd;let c=e.directiveStylingLast;for(-1===c?c=e.directiveStart:c++;c<o&&(s=t[c],i=od(i,s.hostAttrs,r),s!==n);)c++;return null!==n&&(e.directiveStylingLast=c),i}function od(n,t,e){const i=e?1:2;let r=-1;if(null!==t)for(let s=0;s<t.length;s++){const o=t[s];"number"==typeof o?r=o:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),ds(n,o,!!e||t[++s]))}return void 0===n?null:n}function Xy(n,t,e){ds(n,t,fs(e))}function Qy(n,t,e,i,r,s,o,c){if(!(3&t.type))return;const m=n.data,I=m[c+1];mh(function $b(n){return 1==(1&n)}(I)?Jy(m,t,e,r,Qo(I),o):void 0)||(mh(s)||function _b(n){return 2==(2&n)}(I)&&(s=Jy(m,null,e,r,c,o)),function aD(n,t,e,i,r){const s=Ti(n);if(t)r?s?n.addClass(e,i):e.classList.add(i):s?n.removeClass(e,i):e.classList.remove(i);else{let o=-1===i.indexOf("-")?void 0:hs.DashCase;if(null==r)s?n.removeStyle(e,i,o):e.style.removeProperty(i);else{const c="string"==typeof r&&r.endsWith("!important");c&&(r=r.slice(0,-10),o|=hs.Important),s?n.setStyle(e,i,r,o):e.style.setProperty(i,r,c?"important":"")}}}(i,o,Pf(Nr(),e),r,s))}function Jy(n,t,e,i,r,s){const o=null===t;let c;for(;r>0;){const m=n[r],I=Array.isArray(m),Z=I?m[1]:m,fe=null===Z;let pe=e[r+1];pe===dn&&(pe=fe?si:void 0);let ye=fe?sm(pe,i):Z===i?pe:void 0;if(I&&!mh(ye)&&(ye=sm(m,i)),mh(ye)&&(c=ye,o))return c;const we=n[r+1];r=o?no(we):Qo(we)}if(null!==t){let m=s?t.residualClasses:t.residualStyles;null!=m&&(c=sm(m,i))}return c}function mh(n){return void 0!==n}function eC(n,t){return 0!=(n.flags&(t?16:32))}function be(n,t=""){const e=gt(),i=Bn(),r=n+20,s=i.firstCreatePass?Sc(i,r,1,t,null):i.data[r],o=e[r]=function Em(n,t){return Ti(n)?n.createText(t):n.createTextNode(t)}(e[11],t);ih(i,e,o,s),$o(s,!1)}function qe(n){return An("",n,""),qe}function An(n,t,e){const i=gt(),r=Fc(i,n,t,e);return r!==dn&&Jo(i,Nr(),r),An}function Ta(n,t,e,i,r){const s=gt(),o=Oc(s,n,t,e,i,r);return o!==dn&&Jo(s,Nr(),o),Ta}const $l=void 0;var zP=["en",[["a","p"],["AM","PM"],$l],[["AM","PM"],$l,$l],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],$l,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],$l,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",$l,"{1} 'at' {0}",$l],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function LP(n){const e=Math.floor(Math.abs(n)),i=n.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===i?1:5}];let Gc={};function Or(n){const t=function jP(n){return n.toLowerCase().replace(/_/g,"-")}(n);let e=bC(t);if(e)return e;const i=t.split("-")[0];if(e=bC(i),e)return e;if("en"===i)return zP;throw new Error(`Missing locale data for the locale "${n}".`)}function bC(n){return n in Gc||(Gc[n]=Jn.ng&&Jn.ng.common&&Jn.ng.common.locales&&Jn.ng.common.locales[n]),Gc[n]}var St=(()=>((St=St||{})[St.LocaleId=0]="LocaleId",St[St.DayPeriodsFormat=1]="DayPeriodsFormat",St[St.DayPeriodsStandalone=2]="DayPeriodsStandalone",St[St.DaysFormat=3]="DaysFormat",St[St.DaysStandalone=4]="DaysStandalone",St[St.MonthsFormat=5]="MonthsFormat",St[St.MonthsStandalone=6]="MonthsStandalone",St[St.Eras=7]="Eras",St[St.FirstDayOfWeek=8]="FirstDayOfWeek",St[St.WeekendRange=9]="WeekendRange",St[St.DateFormat=10]="DateFormat",St[St.TimeFormat=11]="TimeFormat",St[St.DateTimeFormat=12]="DateTimeFormat",St[St.NumberSymbols=13]="NumberSymbols",St[St.NumberFormats=14]="NumberFormats",St[St.CurrencyCode=15]="CurrencyCode",St[St.CurrencySymbol=16]="CurrencySymbol",St[St.CurrencyName=17]="CurrencyName",St[St.Currencies=18]="Currencies",St[St.Directionality=19]="Directionality",St[St.PluralCase=20]="PluralCase",St[St.ExtraData=21]="ExtraData",St))();const _h="en-US";let yC=_h;function b_(n,t,e,i,r){if(n=ln(n),Array.isArray(n))for(let s=0;s<n.length;s++)b_(n[s],t,e,i,r);else{const s=Bn(),o=gt();let c=Ac(n)?n:ln(n.provide),m=Xb(n);const I=Vi(),Z=1048575&I.providerIndexes,fe=I.directiveStart,pe=I.providerIndexes>>20;if(Ac(n)||!n.multi){const ye=new Ou(m,r,Le),we=C_(c,t,r?Z:Z+pe,fe);-1===we?(Vf(Bu(I,o),s,c),y_(s,n,t.length),t.push(c),I.directiveStart++,I.directiveEnd++,r&&(I.providerIndexes+=1048576),e.push(ye),o.push(ye)):(e[we]=ye,o[we]=ye)}else{const ye=C_(c,t,Z+pe,fe),we=C_(c,t,Z,Z+pe),Me=ye>=0&&e[ye],Oe=we>=0&&e[we];if(r&&!Oe||!r&&!Me){Vf(Bu(I,o),s,c);const Be=function L4(n,t,e,i,r){const s=new Ou(n,e,Le);return s.multi=[],s.index=t,s.componentProviders=0,GC(s,r,i&&!e),s}(r?B4:R4,e.length,r,i,m);!r&&Oe&&(e[we].providerFactory=Be),y_(s,n,t.length,0),t.push(c),I.directiveStart++,I.directiveEnd++,r&&(I.providerIndexes+=1048576),e.push(Be),o.push(Be)}else y_(s,n,ye>-1?ye:we,GC(e[r?we:ye],m,!r&&i));!r&&i&&Oe&&e[we].componentProviders++}}}function y_(n,t,e,i){const r=Ac(t),s=function uA(n){return!!n.useClass}(t);if(r||s){const m=(s?ln(t.useClass):t).prototype.ngOnDestroy;if(m){const I=n.destroyHooks||(n.destroyHooks=[]);if(!r&&t.multi){const Z=I.indexOf(e);-1===Z?I.push(e,[i,m]):I[Z+1].push(i,m)}else I.push(e,m)}}}function GC(n,t,e){return e&&n.componentProviders++,n.multi.push(t)-1}function C_(n,t,e,i){for(let r=e;r<i;r++)if(t[r]===n)return r;return-1}function R4(n,t,e,i){return x_(this.multi,[])}function B4(n,t,e,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,c=Lu(e,e[1],this.providerFactory.index,i);s=c.slice(0,o),x_(r,s);for(let m=o;m<c.length;m++)s.push(c[m])}else s=[],x_(r,s);return s}function x_(n,t){for(let e=0;e<n.length;e++)t.push((0,n[e])());return t}function ui(n,t=[]){return e=>{e.providersResolver=(i,r)=>function O4(n,t,e){const i=Bn();if(i.firstCreatePass){const r=Js(n);b_(e,i.data,i.blueprint,r,!0),b_(t,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,t)}}class qC{}class H4{resolveComponentFactory(t){throw function j4(n){const t=Error(`No component factory found for ${Un(n)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=n,t}(t)}}let Ch=(()=>{class n{}return n.NULL=new H4,n})();function U4(){return Wc(Vi(),gt())}function Wc(n,t){return new _i(Ss(n,t))}let _i=(()=>{class n{constructor(e){this.nativeElement=e}}return n.__NG_ELEMENT_ID__=U4,n})();function V4(n){return n instanceof _i?n.nativeElement:n}class dd{}let vl=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function q4(){const n=gt(),e=us(Vi().index,n);return function G4(n){return n[11]}(_o(e)?e:n)}(),n})(),W4=(()=>{class n{}return n.\u0275prov=tn({token:n,providedIn:"root",factory:()=>null}),n})();class xh{constructor(t){this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}}const K4=new xh("13.3.11"),w_={};function wh(n,t,e,i,r=!1){for(;null!==e;){const s=t[e.index];if(null!==s&&i.push(Fi(s)),Qs(s))for(let c=10;c<s.length;c++){const m=s[c],I=m[1].firstChild;null!==I&&wh(m[1],m,I,i)}const o=e.type;if(8&o)wh(n,t,e.child,i);else if(32&o){const c=Cm(e,t);let m;for(;m=c();)i.push(m)}else if(16&o){const c=ob(t,e);if(Array.isArray(c))i.push(...c);else{const m=Qu(t[16]);wh(m[1],m,c,i,!0)}}e=r?e.projectionNext:e.next}return i}class fd{constructor(t,e){this._lView=t,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const t=this._lView,e=t[1];return wh(e,t,e.firstChild,[])}get context(){return this._lView[8]}set context(t){this._lView[8]=t}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[3];if(Qs(t)){const e=t[8],i=e?e.indexOf(this):-1;i>-1&&(Im(t,i),qf(e,i))}this._attachedToViewContainer=!1}Xv(this._lView[1],this._lView)}onDestroy(t){Ab(this._lView[1],this._lView,null,t)}markForCheck(){Zm(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){!function Qm(n,t,e){const i=t[10];i.begin&&i.begin();try{kc(n,t,n.template,e)}catch(r){throw Gb(t,r),r}finally{i.end&&i.end()}}(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Mt(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Xk(n,t){Ju(n,t,t[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new Mt(902,"");this._appRef=t}}class Y4 extends fd{constructor(t){super(t),this._view=t}detectChanges(){jb(this._view)}checkNoChanges(){}get context(){return null}}class KC extends Ch{constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const e=_r(t);return new E_(e,this.ngModule)}}function YC(n){const t=[];for(let e in n)n.hasOwnProperty(e)&&t.push({propName:n[e],templateName:e});return t}class E_ extends qC{constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=function _D(n){return n.map(mD).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors?t.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return YC(this.componentDef.inputs)}get outputs(){return YC(this.componentDef.outputs)}create(t,e,i,r){const s=(r=r||this.ngModule)?function X4(n,t){return{get:(e,i,r)=>{const s=n.get(e,w_,r);return s!==w_||i===w_?s:t.get(e,i,r)}}}(t,r.injector):t,o=s.get(dd,z1),c=s.get(W4,null),m=o.createRenderer(null,this.componentDef),I=this.componentDef.selectors[0][0]||"div",Z=i?function Db(n,t,e){if(Ti(n))return n.selectRootElement(t,e===Zs.ShadowDom);let i="string"==typeof t?n.querySelector(t):t;return i.textContent="",i}(m,i,this.componentDef.encapsulation):Tm(o.createRenderer(null,this.componentDef),I,function Z4(n){const t=n.toLowerCase();return"svg"===t?"svg":"math"===t?"math":null}(I)),fe=this.componentDef.onPush?576:528,pe=function cy(n,t){return{components:[],scheduler:n||Vk,clean:tA,playerHandler:t||null,flags:0}}(),ye=lh(0,null,null,1,0,null,null,null,null,null),we=ed(null,ye,pe,fe,null,null,o,m,c,s);let Me,Oe;Ff(we);try{const Be=function ay(n,t,e,i,r,s){const o=e[1];e[20]=n;const m=Sc(o,20,2,"#host",null),I=m.mergedAttrs=t.hostAttrs;null!==I&&(uh(m,I,!0),null!==n&&(zf(r,n,I),null!==m.classes&&Am(r,n,m.classes),null!==m.styles&&cb(r,n,m.styles)));const Z=i.createRenderer(n,t),fe=ed(e,Mb(t),null,t.onPush?64:16,e[20],m,i,Z,s||null,null);return o.firstCreatePass&&(Vf(Bu(m,e),o,t.type),Rb(o,m),Bb(m,e.length,1)),ch(e,fe),e[20]=fe}(Z,this.componentDef,we,o,m);if(Z)if(i)zf(m,Z,["ng-version",K4.full]);else{const{attrs:ke,classes:ze}=function $D(n){const t=[],e=[];let i=1,r=2;for(;i<n.length;){let s=n[i];if("string"==typeof s)2===r?""!==s&&t.push(s,n[++i]):8===r&&e.push(s);else{if(!to(r))break;r=s}i++}return{attrs:t,classes:e}}(this.componentDef.selectors[0]);ke&&zf(m,Z,ke),ze&&ze.length>0&&Am(m,Z,ze.join(" "))}if(Oe=jg(ye,20),void 0!==e){const ke=Oe.projection=[];for(let ze=0;ze<this.ngContentSelectors.length;ze++){const je=e[ze];ke.push(null!=je?Array.from(je):null)}}Me=function ly(n,t,e,i,r){const s=e[1],o=function LD(n,t,e){const i=Vi();n.firstCreatePass&&(e.providersResolver&&e.providersResolver(e),Lb(n,i,t,Mc(n,t,1,null),e));const r=Lu(t,n,i.directiveStart,i);br(r,t);const s=Ss(i,t);return s&&br(s,t),r}(s,e,t);if(i.components.push(o),n[8]=o,r&&r.forEach(m=>m(o,t)),t.contentQueries){const m=Vi();t.contentQueries(1,o,m.directiveStart)}const c=Vi();return!s.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(Ca(c.index),Fb(e[1],c,0,c.directiveStart,c.directiveEnd,t),Ob(t,o)),o}(Be,this.componentDef,we,pe,[yA]),td(ye,we,null)}finally{Of()}return new J4(this.componentType,Me,Wc(Oe,we),we,Oe)}}class J4 extends class z4{}{constructor(t,e,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=e,this.hostView=this.changeDetectorRef=new Y4(r),this.componentType=t}get injector(){return new $c(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}class Kc{}const Yc=new Map;class QC extends Kc{constructor(t,e){super(),this._parent=e,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new KC(this);const i=Es(t);this._bootstrapComponents=Co(i.bootstrap),this._r3Injector=Zb(t,e,[{provide:Kc,useValue:this},{provide:Ch,useValue:this.componentFactoryResolver}],Un(t)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(t)}get(t,e=Yr.THROW_IF_NOT_FOUND,i=hn.Default){return t===Yr||t===Kc||t===e_?this:this._r3Injector.get(t,e,i)}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class T_ extends class t5{}{constructor(t){super(),this.moduleType=t,null!==Es(t)&&function n5(n){const t=new Set;!function e(i){const r=Es(i,!0),s=r.id;null!==s&&(function ZC(n,t,e){if(t&&t!==e)throw new Error(`Duplicate module registered for ${n} - ${Un(t)} vs ${Un(t.name)}`)}(s,Yc.get(s),i),Yc.set(s,i));const o=Co(r.imports);for(const c of o)t.has(c)||(t.add(c),e(c))}(n)}(t)}create(t){return new QC(this.moduleType,t)}}function ea(n,t,e){const i=Pr()+n,r=gt();return r[i]===dn?wo(r,i,e?t.call(e):t()):rd(r,i)}function ut(n,t,e,i){return function JC(n,t,e,i,r,s){const o=t+e;return yr(n,o,r)?wo(n,o+1,s?i.call(s,r):i(r)):hd(n,o+1)}(gt(),Pr(),n,t,e,i)}function Kt(n,t,e,i,r){return e2(gt(),Pr(),n,t,e,i,r)}function Zr(n,t,e,i,r,s){return function t2(n,t,e,i,r,s,o,c){const m=t+e;return fh(n,m,r,s,o)?wo(n,m+3,c?i.call(c,r,s,o):i(r,s,o)):hd(n,m+3)}(gt(),Pr(),n,t,e,i,r,s)}function oo(n,t,e,i,r,s,o){return function n2(n,t,e,i,r,s,o,c,m){const I=t+e;return ks(n,I,r,s,o,c)?wo(n,I+4,m?i.call(m,r,s,o,c):i(r,s,o,c)):hd(n,I+4)}(gt(),Pr(),n,t,e,i,r,s,o)}function I_(n,t,e,i,r,s,o,c,m){const I=Pr()+n,Z=gt(),fe=ks(Z,I,e,i,r,s);return _l(Z,I+4,o,c)||fe?wo(Z,I+6,m?t.call(m,e,i,r,s,o,c):t(e,i,r,s,o,c)):rd(Z,I+6)}function Zc(n,t,e,i,r,s,o,c,m,I){const Z=Pr()+n,fe=gt();let pe=ks(fe,Z,e,i,r,s);return fh(fe,Z+4,o,c,m)||pe?wo(fe,Z+7,I?t.call(I,e,i,r,s,o,c,m):t(e,i,r,s,o,c,m)):rd(fe,Z+7)}function ao(n,t,e,i,r,s,o,c,m,I,Z){const fe=Pr()+n,pe=gt(),ye=ks(pe,fe,e,i,r,s);return ks(pe,fe+4,o,c,m,I)||ye?wo(pe,fe+8,Z?t.call(Z,e,i,r,s,o,c,m,I):t(e,i,r,s,o,c,m,I)):rd(pe,fe+8)}function hd(n,t){const e=n[t];return e===dn?void 0:e}function e2(n,t,e,i,r,s,o){const c=t+e;return _l(n,c,r,s)?wo(n,c+2,o?i.call(o,r,s):i(r,s)):hd(n,c+2)}function Ct(n,t){const e=Bn();let i;const r=n+20;e.firstCreatePass?(i=function s5(n,t){if(t)for(let e=t.length-1;e>=0;e--){const i=t[e];if(n===i.name)return i}}(t,e.pipeRegistry),e.data[r]=i,i.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(r,i.onDestroy)):i=e.data[r];const s=i.factory||(i.factory=pl(i.type)),o=$a(Le);try{const c=Hf(!1),m=s();return Hf(c),function PA(n,t,e,i){e>=n.data.length&&(n.data[e]=null,n.blueprint[e]=null),t[e]=i}(e,gt(),r,m),m}finally{$a(o)}}function xt(n,t,e,i){const r=n+20,s=gt(),o=pc(s,r);return function pd(n,t){return n[1].data[t].pure}(s,r)?e2(s,Pr(),t,o.transform,e,i,o):o.transform(e,i)}function S_(n){return t=>{setTimeout(n,void 0,t)}}const Cn=class u5 extends le{constructor(t=!1){super(),this.__isAsync=t}emit(t){super.next(t)}subscribe(t,e,i){var r,s,o;let c=t,m=e||(()=>null),I=i;if(t&&"object"==typeof t){const fe=t;c=null===(r=fe.next)||void 0===r?void 0:r.bind(fe),m=null===(s=fe.error)||void 0===s?void 0:s.bind(fe),I=null===(o=fe.complete)||void 0===o?void 0:o.bind(fe)}this.__isAsync&&(m=S_(m),c&&(c=S_(c)),I&&(I=S_(I)));const Z=super.subscribe({next:c,error:m,complete:I});return t instanceof d&&t.add(Z),Z}};function d5(){return this._results[Pc()]()}class M_{constructor(t=!1){this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=Pc(),i=M_.prototype;i[e]||(i[e]=d5)}get changes(){return this._changes||(this._changes=new Cn)}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){const i=this;i.dirty=!1;const r=Ms(t);(this._changesDetected=!function TM(n,t,e){if(n.length!==t.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],s=t[i];if(e&&(r=e(r),s=e(s)),s!==r)return!1}return!0}(i._results,r,e))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let ta=(()=>{class n{}return n.__NG_ELEMENT_ID__=p5,n})();const f5=ta,h5=class extends f5{constructor(t,e,i){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=i}createEmbeddedView(t){const e=this._declarationTContainer.tViews,i=ed(this._declarationLView,e,t,16,null,e.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(i[19]=s.createEmbeddedView(e)),td(e,i,t),new fd(i)}};function p5(){return Eh(Vi(),gt())}function Eh(n,t){return 4&n.type?new h5(t,n,Wc(n,t)):null}let Rr=(()=>{class n{}return n.__NG_ELEMENT_ID__=g5,n})();function g5(){return o2(Vi(),gt())}const m5=Rr,r2=class extends m5{constructor(t,e,i){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=i}get element(){return Wc(this._hostTNode,this._hostLView)}get injector(){return new $c(this._hostTNode,this._hostLView)}get parentInjector(){const t=Uf(this._hostTNode,this._hostLView);if(iv(t)){const e=_c(t,this._hostLView),i=mc(t);return new $c(e[1].data[i+8],e)}return new $c(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const e=s2(this._lContainer);return null!==e&&e[t]||null}get length(){return this._lContainer.length-10}createEmbeddedView(t,e,i){const r=t.createEmbeddedView(e||{});return this.insert(r,i),r}createComponent(t,e,i,r,s){const o=t&&!function ju(n){return"function"==typeof n}(t);let c;if(o)c=e;else{const fe=e||{};c=fe.index,i=fe.injector,r=fe.projectableNodes,s=fe.ngModuleRef}const m=o?t:new E_(_r(t)),I=i||this.parentInjector;if(!s&&null==m.ngModule){const pe=(o?I:this.parentInjector).get(Kc,null);pe&&(s=pe)}const Z=m.create(I,r,void 0,s);return this.insert(Z.hostView,c),Z}insert(t,e){const i=t._lView,r=i[1];if(function KS(n){return Qs(n[3])}(i)){const Z=this.indexOf(t);if(-1!==Z)this.detach(Z);else{const fe=i[3],pe=new r2(fe,fe[6],fe[3]);pe.detach(pe.indexOf(t))}}const s=this._adjustIndex(e),o=this._lContainer;!function Jk(n,t,e,i){const r=10+i,s=e.length;i>0&&(e[r-1][4]=t),i<s-10?(t[4]=e[r],hv(e,10+i,t)):(e.push(t),t[4]=null),t[3]=e;const o=t[17];null!==o&&e!==o&&function eD(n,t){const e=n[9];t[16]!==t[3][3][16]&&(n[2]=!0),null===e?n[9]=[t]:e.push(t)}(o,t);const c=t[19];null!==c&&c.insertView(n),t[2]|=128}(r,i,o,s);const c=km(s,o),m=i[11],I=nh(m,o[7]);return null!==I&&function Zk(n,t,e,i,r,s){i[0]=r,i[6]=t,Ju(n,i,e,1,r,s)}(r,o[6],m,i,I,c),t.attachToViewContainerRef(),hv(k_(o),s,t),t}move(t,e){return this.insert(t,e)}indexOf(t){const e=s2(this._lContainer);return null!==e?e.indexOf(t):-1}remove(t){const e=this._adjustIndex(t,-1),i=Im(this._lContainer,e);i&&(qf(k_(this._lContainer),e),Xv(i[1],i))}detach(t){const e=this._adjustIndex(t,-1),i=Im(this._lContainer,e);return i&&null!=qf(k_(this._lContainer),e)?new fd(i):null}_adjustIndex(t,e=0){return null==t?this.length+e:t}};function s2(n){return n[8]}function k_(n){return n[8]||(n[8]=[])}function o2(n,t){let e;const i=t[n.index];if(Qs(i))e=i;else{let r;if(8&n.type)r=Fi(i);else{const s=t[11];r=s.createComment("");const o=Ss(n,t);ml(s,nh(s,o),r,function rD(n,t){return Ti(n)?n.nextSibling(t):t.nextSibling}(s,o),!1)}t[n.index]=e=zb(i,t,r,n),ch(t,e)}return new r2(e,n,t)}class D_{constructor(t){this.queryList=t,this.matches=null}clone(){return new D_(this.queryList)}setDirty(){this.queryList.setDirty()}}class A_{constructor(t=[]){this.queries=t}createEmbeddedView(t){const e=t.queries;if(null!==e){const i=null!==t.contentQueries?t.contentQueries[0]:e.length,r=[];for(let s=0;s<i;s++){const o=e.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new A_(r)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)null!==d2(t,e).matches&&this.queries[e].setDirty()}}class a2{constructor(t,e,i=null){this.predicate=t,this.flags=e,this.read=i}}class P_{constructor(t=[]){this.queries=t}elementStart(t,e){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let i=0;i<this.length;i++){const r=null!==e?e.length:0,s=this.getByIndex(i).embeddedTView(t,r);s&&(s.indexInDeclarationView=i,null!==e?e.push(s):e=[s])}return null!==e?new P_(e):null}template(t,e){for(let i=0;i<this.queries.length;i++)this.queries[i].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class N_{constructor(t,e=-1){this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new N_(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let i=t.parent;for(;null!==i&&8&i.type&&i.index!==e;)i=i.parent;return e===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(t,e){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(t,e,v5(e,s)),this.matchTNodeWithReadOption(t,e,Gf(e,t,s,!1,!1))}else i===ta?4&e.type&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,Gf(e,t,i,!1,!1))}matchTNodeWithReadOption(t,e,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===_i||r===Rr||r===ta&&4&e.type)this.addMatch(e.index,-2);else{const s=Gf(e,t,r,!1,!1);null!==s&&this.addMatch(e.index,s)}else this.addMatch(e.index,i)}}addMatch(t,e){null===this.matches?this.matches=[t,e]:this.matches.push(t,e)}}function v5(n,t){const e=n.localNames;if(null!==e)for(let i=0;i<e.length;i+=2)if(e[i]===t)return e[i+1];return null}function y5(n,t,e,i){return-1===e?function b5(n,t){return 11&n.type?Wc(n,t):4&n.type?Eh(n,t):null}(t,n):-2===e?function C5(n,t,e){return e===_i?Wc(t,n):e===ta?Eh(t,n):e===Rr?o2(t,n):void 0}(n,t,i):Lu(n,n[1],e,t)}function l2(n,t,e,i){const r=t[19].queries[i];if(null===r.matches){const s=n.data,o=e.matches,c=[];for(let m=0;m<o.length;m+=2){const I=o[m];c.push(I<0?null:y5(t,s[I],o[m+1],e.metadata.read))}r.matches=c}return r.matches}function F_(n,t,e,i){const r=n.queries.getByIndex(e),s=r.matches;if(null!==s){const o=l2(n,t,r,e);for(let c=0;c<s.length;c+=2){const m=s[c];if(m>0)i.push(o[c/2]);else{const I=s[c+1],Z=t[-m];for(let fe=10;fe<Z.length;fe++){const pe=Z[fe];pe[17]===pe[3]&&F_(pe[1],pe,I,i)}if(null!==Z[9]){const fe=Z[9];for(let pe=0;pe<fe.length;pe++){const ye=fe[pe];F_(ye[1],ye,I,i)}}}}}return i}function sn(n){const t=gt(),e=Bn(),i=K1();Kg(i+1);const r=d2(e,i);if(n.dirty&&j1(t)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const s=r.crossesNgTemplate?F_(e,t,i,[]):l2(e,t,r,i);n.reset(s,V4),n.notifyOnChanges()}return!0}return!1}function on(n,t,e){const i=Bn();i.firstCreatePass&&(function u2(n,t,e){null===n.queries&&(n.queries=new P_),n.queries.track(new N_(t,e))}(i,new a2(n,t,e),-1),2==(2&t)&&(i.staticViewQueries=!0)),function c2(n,t,e){const i=new M_(4==(4&e));Ab(n,t,i,i.destroy),null===t[19]&&(t[19]=new A_),t[19].queries.push(new D_(i))}(i,gt(),t)}function an(){return function w5(n,t){return n[19].queries[t].queryList}(gt(),K1())}function d2(n,t){return n.queries.getByIndex(t)}function Ln(n,t){return Eh(n,t)}function Sh(...n){}const j_=new Dn("Application Initializer");let H_=(()=>{class n{constructor(e){this.appInits=e,this.resolve=Sh,this.reject=Sh,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const e=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(ph(s))e.push(s);else if(ky(s)){const o=new Promise((c,m)=>{s.subscribe({complete:c,error:m})});e.push(o)}}Promise.all(e).then(()=>{i()}).catch(r=>{this.reject(r)}),0===e.length&&i(),this.initialized=!0}}return n.\u0275fac=function(e){return new(e||n)(rn(j_,8))},n.\u0275prov=tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const md=new Dn("AppId",{providedIn:"root",factory:function S2(){return`${U_()}${U_()}${U_()}`}});function U_(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const M2=new Dn("Platform Initializer"),_d=new Dn("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),H5=new Dn("appBootstrapListener"),Ia=new Dn("LocaleId",{providedIn:"root",factory:()=>LM(Ia,hn.Optional|hn.SkipSelf)||function U5(){return"undefined"!=typeof $localize&&$localize.locale||_h}()}),W5=(()=>Promise.resolve(0))();function V_(n){"undefined"==typeof Zone?W5.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class vn{constructor({enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Cn(!1),this.onMicrotaskEmpty=new Cn(!1),this.onStable=new Cn(!1),this.onError=new Cn(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&e,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function K5(){let n=Jn.requestAnimationFrame,t=Jn.cancelAnimationFrame;if("undefined"!=typeof Zone&&n&&t){const e=n[Zone.__symbol__("OriginalDelegate")];e&&(n=e);const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function X5(n){const t=()=>{!function Z5(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Jn,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,q_(n),n.isCheckStableRunning=!0,G_(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),q_(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,i,r,s,o,c)=>{try{return k2(n),e.invokeTask(r,s,o,c)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&t(),D2(n)}},onInvoke:(e,i,r,s,o,c,m)=>{try{return k2(n),e.invoke(r,s,o,c,m)}finally{n.shouldCoalesceRunChangeDetection&&t(),D2(n)}},onHasTask:(e,i,r,s)=>{e.hasTask(r,s),i===r&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,q_(n),G_(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(e,i,r,s)=>(e.handleError(r,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!vn.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(vn.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(t,e,i){return this._inner.run(t,e,i)}runTask(t,e,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,t,Y5,Sh,Sh);try{return s.runTask(o,e,i)}finally{s.cancelTask(o)}}runGuarded(t,e,i){return this._inner.runGuarded(t,e,i)}runOutsideAngular(t){return this._outer.run(t)}}const Y5={};function G_(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function q_(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function k2(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function D2(n){n._nesting--,G_(n)}class Q5{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Cn,this.onMicrotaskEmpty=new Cn,this.onStable=new Cn,this.onError=new Cn}run(t,e,i){return t.apply(e,i)}runGuarded(t,e,i){return t.apply(e,i)}runOutsideAngular(t){return t()}runTask(t,e,i,r){return t.apply(e,i)}}let W_=(()=>{class n{constructor(e){this._ngZone=e,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{vn.assertNotInAngularZone(),V_(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())V_(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(e)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),e(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:e,timeoutId:s,updateCb:r})}whenStable(e,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(e,i,r){return[]}}return n.\u0275fac=function(e){return new(e||n)(rn(vn))},n.\u0275prov=tn({token:n,factory:n.\u0275fac}),n})(),J5=(()=>{class n{constructor(){this._applications=new Map,K_.addToWindow(this)}registerApplication(e,i){this._applications.set(e,i)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,i=!0){return K_.findTestabilityInTree(this,e,i)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=tn({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();class eN{addToWindow(t){}findTestabilityInTree(t,e,i){return null}}let K_=new eN,bl=null;const A2=new Dn("AllowMultipleToken"),P2=new Dn("PlatformOnDestroy");function N2(n,t,e=[]){const i=`Platform: ${t}`,r=new Dn(i);return(s=[])=>{let o=Y_();if(!o||o.injector.get(A2,!1)){const c=[...e,...s,{provide:r,useValue:!0}];n?n(c):function rN(n){if(bl&&!bl.get(A2,!1))throw new Mt(400,"");bl=n;const t=n.get(F2),e=n.get(M2,null);e&&e.forEach(i=>i())}(function oN(n=[],t){return Yr.create({name:t,providers:[{provide:t_,useValue:"platform"},{provide:P2,useValue:()=>bl=null},...n]})}(c,i))}return function sN(n){const t=Y_();if(!t)throw new Mt(401,"");return t}()}}function Y_(){var n;return null!==(n=null==bl?void 0:bl.get(F2))&&void 0!==n?n:null}let F2=(()=>{class n{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,i){const c=function aN(n,t){let e;return e="noop"===n?new Q5:("zone.js"===n?void 0:n)||new vn({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)}),e}(i?i.ngZone:void 0,{ngZoneEventCoalescing:i&&i.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:i&&i.ngZoneRunCoalescing||!1}),m=[{provide:vn,useValue:c}];return c.run(()=>{const I=Yr.create({providers:m,parent:this.injector,name:e.moduleType.name}),Z=e.create(I),fe=Z.injector.get(Xu,null);if(!fe)throw new Mt(402,"");return c.runOutsideAngular(()=>{const pe=c.onError.subscribe({next:ye=>{fe.handleError(ye)}});Z.onDestroy(()=>{X_(this._modules,Z),pe.unsubscribe()})}),function lN(n,t,e){try{const i=e();return ph(i)?i.catch(r=>{throw t.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw t.runOutsideAngular(()=>n.handleError(i)),i}}(fe,c,()=>{const pe=Z.injector.get(H_);return pe.runInitializers(),pe.donePromise.then(()=>(function GP(n){as(n,"Expected localeId to be defined"),"string"==typeof n&&(yC=n.toLowerCase().replace(/_/g,"-"))}(Z.injector.get(Ia,_h)||_h),this._moduleDoBootstrap(Z),Z))})})}bootstrapModule(e,i=[]){const r=O2({},i);return function nN(n,t,e){const i=new T_(e);return Promise.resolve(i)}(0,0,e).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(e){const i=e.injector.get(Z_);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!e.instance.ngDoBootstrap)throw new Mt(403,"");e.instance.ngDoBootstrap(i)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Mt(404,"");this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const e=this._injector.get(P2,null);null==e||e(),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(e){return new(e||n)(rn(Yr))},n.\u0275prov=tn({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function O2(n,t){return Array.isArray(t)?t.reduce(O2,n):Object.assign(Object.assign({},n),t)}let Z_=(()=>{class n{constructor(e,i,r,s){this._zone=e,this._injector=i,this._exceptionHandler=r,this._initStatus=s,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const o=new f(m=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{m.next(this._stable),m.complete()})}),c=new f(m=>{let I;this._zone.runOutsideAngular(()=>{I=this._zone.onStable.subscribe(()=>{vn.assertNotInAngularZone(),V_(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,m.next(!0))})})});const Z=this._zone.onUnstable.subscribe(()=>{vn.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{m.next(!1)}))});return()=>{I.unsubscribe(),Z.unsubscribe()}});this.isStable=qr(o,c.pipe(function cl(n={}){const{connector:t=(()=>new le),resetOnError:e=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return s=>{let o,c,m,I=0,Z=!1,fe=!1;const pe=()=>{null==c||c.unsubscribe(),c=void 0},ye=()=>{pe(),o=m=void 0,Z=fe=!1},we=()=>{const Me=o;ye(),null==Me||Me.unsubscribe()};return O((Me,Oe)=>{I++,!fe&&!Z&&pe();const Be=m=null!=m?m:t();Oe.add(()=>{I--,0===I&&!fe&&!Z&&(c=Wr(we,r))}),Be.subscribe(Oe),!o&&I>0&&(o=new A({next:ke=>Be.next(ke),error:ke=>{fe=!0,pe(),c=Wr(ye,e,ke),Be.error(ke)},complete:()=>{Z=!0,pe(),c=Wr(ye,i),Be.complete()}}),pr(Me).subscribe(o))})(s)}}()))}bootstrap(e,i){if(!this._initStatus.done)throw new Mt(405,"");let r;r=e instanceof qC?e:this._injector.get(Ch).resolveComponentFactory(e),this.componentTypes.push(r.componentType);const s=function iN(n){return n.isBoundToModule}(r)?void 0:this._injector.get(Kc),c=r.create(Yr.NULL,[],i||r.selector,s),m=c.location.nativeElement,I=c.injector.get(W_,null),Z=I&&c.injector.get(J5);return I&&Z&&Z.registerApplication(m,I),c.onDestroy(()=>{this.detachView(c.hostView),X_(this.components,c),Z&&Z.unregisterApplication(m)}),this._loadComponent(c),c}tick(){if(this._runningTick)throw new Mt(101,"");try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const i=e;this._views.push(i),i.attachToAppRef(this)}detachView(e){const i=e;X_(this._views,i),i.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(H5,[]).concat(this._bootstrapListeners).forEach(r=>r(e))}ngOnDestroy(){this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return n.\u0275fac=function(e){return new(e||n)(rn(vn),rn(Yr),rn(Xu),rn(H_))},n.\u0275prov=tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function X_(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}let B2=!0,Di=(()=>{class n{}return n.__NG_ELEMENT_ID__=dN,n})();function dN(n){return function fN(n,t,e){if(Df(n)&&!e){const i=us(n.index,t);return new fd(i,i)}return 47&n.type?new fd(t[16],t):null}(Vi(),gt(),16==(16&n))}class U2{constructor(){}supports(t){return id(t)}create(t){return new $N(t)}}const _N=(n,t)=>t;class $N{constructor(t){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||_N}forEachItem(t){let e;for(e=this._itHead;null!==e;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,i=this._removalsHead,r=0,s=null;for(;e||i;){const o=!i||e&&e.currentIndex<G2(i,r,s)?e:i,c=G2(o,r,s),m=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(e=e._next,null==o.previousIndex)r++;else{s||(s=[]);const I=c-r,Z=m-r;if(I!=Z){for(let pe=0;pe<I;pe++){const ye=pe<s.length?s[pe]:s[pe]=0,we=ye+pe;Z<=we&&we<I&&(s[pe]=ye+1)}s[o.previousIndex]=Z-I}}c!==m&&t(o,c,m)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)t(e)}diff(t){if(null==t&&(t=[]),!id(t))throw new Mt(900,"");return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let r,s,o,e=this._itHead,i=!1;if(Array.isArray(t)){this.length=t.length;for(let c=0;c<this.length;c++)s=t[c],o=this._trackByFn(c,s),null!==e&&Object.is(e.trackById,o)?(i&&(e=this._verifyReinsertion(e,s,o,c)),Object.is(e.item,s)||this._addIdentityChange(e,s)):(e=this._mismatch(e,s,o,c),i=!0),e=e._next}else r=0,function DA(n,t){if(Array.isArray(n))for(let e=0;e<n.length;e++)t(n[e]);else{const e=n[Pc()]();let i;for(;!(i=e.next()).done;)t(i.value)}}(t,c=>{o=this._trackByFn(r,c),null!==e&&Object.is(e.trackById,o)?(i&&(e=this._verifyReinsertion(e,c,o,r)),Object.is(e.item,c)||this._addIdentityChange(e,c)):(e=this._mismatch(e,c,o,r),i=!0),e=e._next,r++}),this.length=r;return this._truncate(e),this.collection=t,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;null!==t;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;null!==t;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,i,r){let s;return null===t?s=this._itTail:(s=t._prev,this._remove(t)),null!==(t=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,s,r)):null!==(t=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,s,r)):t=this._addAfter(new vN(e,i),s,r),t}_verifyReinsertion(t,e,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?t=this._reinsertAfter(s,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;null!==t;){const e=t._next;this._addToRemovals(this._unlink(t)),t=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(t);const r=t._prevRemoved,s=t._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(t,e,i),this._addToMoves(t,i),t}_moveAfter(t,e,i){return this._unlink(t),this._insertAfter(t,e,i),this._addToMoves(t,i),t}_addAfter(t,e,i){return this._insertAfter(t,e,i),this._additionsTail=null===this._additionsTail?this._additionsHead=t:this._additionsTail._nextAdded=t,t}_insertAfter(t,e,i){const r=null===e?this._itHead:e._next;return t._next=r,t._prev=e,null===r?this._itTail=t:r._prev=t,null===e?this._itHead=t:e._next=t,null===this._linkedRecords&&(this._linkedRecords=new V2),this._linkedRecords.put(t),t.currentIndex=i,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){null!==this._linkedRecords&&this._linkedRecords.remove(t);const e=t._prev,i=t._next;return null===e?this._itHead=i:e._next=i,null===i?this._itTail=e:i._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=t:this._movesTail._nextMoved=t),t}_addToRemovals(t){return null===this._unlinkedRecords&&(this._unlinkedRecords=new V2),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=t:this._identityChangesTail._nextIdentityChange=t,t}}class vN{constructor(t,e){this.item=t,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class bN{constructor(){this._head=null,this._tail=null}add(t){null===this._head?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===e||e<=i.currentIndex)&&Object.is(i.trackById,t))return i;return null}remove(t){const e=t._prevDup,i=t._nextDup;return null===e?this._head=i:e._nextDup=i,null===i?this._tail=e:i._prevDup=e,null===this._head}}class V2{constructor(){this.map=new Map}put(t){const e=t.trackById;let i=this.map.get(e);i||(i=new bN,this.map.set(e,i)),i.add(t)}get(t,e){const r=this.map.get(t);return r?r.get(t,e):null}remove(t){const e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function G2(n,t,e){const i=n.previousIndex;if(null===i)return i;let r=0;return e&&i<e.length&&(r=e[i]),i+t+r}class q2{constructor(){}supports(t){return t instanceof Map||a_(t)}create(){return new yN}}class yN{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let e;for(e=this._mapHead;null!==e;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)t(e)}diff(t){if(t){if(!(t instanceof Map||a_(t)))throw new Mt(900,"")}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(i,r)=>{if(e&&e.key===r)this._maybeAddToChanges(e,i),this._appendAfter=e,e=e._next;else{const s=this._getOrCreateRecordForKey(r,i);e=this._insertBeforeOrAppend(e,s)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let i=e;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){const i=t._prev;return e._next=t,e._prev=i,t._prev=e,i&&(i._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){const r=this._records.get(t);this._maybeAddToChanges(r,e);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new CN(t);return this._records.set(t,i),i.currentValue=e,this._addToAdditions(i),i}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(i=>e(t[i],i))}}class CN{constructor(t){this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function W2(){return new Dh([new U2])}let Dh=(()=>{class n{constructor(e){this.factories=e}static create(e,i){if(null!=i){const r=i.factories.slice();e=e.concat(r)}return new n(e)}static extend(e){return{provide:n,useFactory:i=>n.create(e,i||W2()),deps:[[n,new Zf,new Yf]]}}find(e){const i=this.factories.find(r=>r.supports(e));if(null!=i)return i;throw new Mt(901,"")}}return n.\u0275prov=tn({token:n,providedIn:"root",factory:W2}),n})();function K2(){return new $d([new q2])}let $d=(()=>{class n{constructor(e){this.factories=e}static create(e,i){if(i){const r=i.factories.slice();e=e.concat(r)}return new n(e)}static extend(e){return{provide:n,useFactory:i=>n.create(e,i||K2()),deps:[[n,new Zf,new Yf]]}}find(e){const i=this.factories.find(s=>s.supports(e));if(i)return i;throw new Mt(901,"")}}return n.\u0275prov=tn({token:n,providedIn:"root",factory:K2}),n})();const EN=N2(null,"core",[]);let TN=(()=>{class n{constructor(e){}}return n.\u0275fac=function(e){return new(e||n)(rn(Z_))},n.\u0275mod=ws({type:n}),n.\u0275inj=ls({}),n})(),Ah=null;function Cl(){return Ah}const Xr=new Dn("DocumentToken");var Ai=(()=>((Ai=Ai||{})[Ai.Format=0]="Format",Ai[Ai.Standalone=1]="Standalone",Ai))(),Mn=(()=>((Mn=Mn||{})[Mn.Narrow=0]="Narrow",Mn[Mn.Abbreviated=1]="Abbreviated",Mn[Mn.Wide=2]="Wide",Mn[Mn.Short=3]="Short",Mn))(),xi=(()=>((xi=xi||{})[xi.Short=0]="Short",xi[xi.Medium=1]="Medium",xi[xi.Long=2]="Long",xi[xi.Full=3]="Full",xi))(),Yt=(()=>((Yt=Yt||{})[Yt.Decimal=0]="Decimal",Yt[Yt.Group=1]="Group",Yt[Yt.List=2]="List",Yt[Yt.PercentSign=3]="PercentSign",Yt[Yt.PlusSign=4]="PlusSign",Yt[Yt.MinusSign=5]="MinusSign",Yt[Yt.Exponential=6]="Exponential",Yt[Yt.SuperscriptingExponent=7]="SuperscriptingExponent",Yt[Yt.PerMille=8]="PerMille",Yt[Yt.Infinity=9]="Infinity",Yt[Yt.NaN=10]="NaN",Yt[Yt.TimeSeparator=11]="TimeSeparator",Yt[Yt.CurrencyDecimal=12]="CurrencyDecimal",Yt[Yt.CurrencyGroup=13]="CurrencyGroup",Yt))();function Ph(n,t){return As(Or(n)[St.DateFormat],t)}function Nh(n,t){return As(Or(n)[St.TimeFormat],t)}function Fh(n,t){return As(Or(n)[St.DateTimeFormat],t)}function Ds(n,t){const e=Or(n),i=e[St.NumberSymbols][t];if(void 0===i){if(t===Yt.CurrencyDecimal)return e[St.NumberSymbols][Yt.Decimal];if(t===Yt.CurrencyGroup)return e[St.NumberSymbols][Yt.Group]}return i}function Q2(n){if(!n[St.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[St.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function As(n,t){for(let e=t;e>-1;e--)if(void 0!==n[e])return n[e];throw new Error("Locale data API: locale data undefined")}function i$(n){const[t,e]=n.split(":");return{hours:+t,minutes:+e}}const GN=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,vd={},qN=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Yi=(()=>((Yi=Yi||{})[Yi.Short=0]="Short",Yi[Yi.ShortGMT=1]="ShortGMT",Yi[Yi.Long=2]="Long",Yi[Yi.Extended=3]="Extended",Yi))(),Qt=(()=>((Qt=Qt||{})[Qt.FullYear=0]="FullYear",Qt[Qt.Month=1]="Month",Qt[Qt.Date=2]="Date",Qt[Qt.Hours=3]="Hours",Qt[Qt.Minutes=4]="Minutes",Qt[Qt.Seconds=5]="Seconds",Qt[Qt.FractionalSeconds=6]="FractionalSeconds",Qt[Qt.Day=7]="Day",Qt))(),bn=(()=>((bn=bn||{})[bn.DayPeriods=0]="DayPeriods",bn[bn.Days=1]="Days",bn[bn.Months=2]="Months",bn[bn.Eras=3]="Eras",bn))();function bd(n,t,e,i){let r=function tF(n){if(tx(n))return n;if("number"==typeof n&&!isNaN(n))return new Date(n);if("string"==typeof n){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){const[r,s=1,o=1]=n.split("-").map(c=>+c);return Oh(r,s-1,o)}const e=parseFloat(n);if(!isNaN(n-e))return new Date(e);let i;if(i=n.match(GN))return function nF(n){const t=new Date(0);let e=0,i=0;const r=n[8]?t.setUTCFullYear:t.setFullYear,s=n[8]?t.setUTCHours:t.setHours;n[9]&&(e=Number(n[9]+n[10]),i=Number(n[9]+n[11])),r.call(t,Number(n[1]),Number(n[2])-1,Number(n[3]));const o=Number(n[4]||0)-e,c=Number(n[5]||0)-i,m=Number(n[6]||0),I=Math.floor(1e3*parseFloat("0."+(n[7]||0)));return s.call(t,o,c,m,I),t}(i)}const t=new Date(n);if(!tx(t))throw new Error(`Unable to convert "${n}" into a date`);return t}(n);t=na(e,t)||t;let c,o=[];for(;t;){if(c=qN.exec(t),!c){o.push(t);break}{o=o.concat(c.slice(1));const Z=o.pop();if(!Z)break;t=Z}}let m=r.getTimezoneOffset();i&&(m=ex(i,m),r=function eF(n,t,e){const i=e?-1:1,r=n.getTimezoneOffset();return function JN(n,t){return(n=new Date(n.getTime())).setMinutes(n.getMinutes()+t),n}(n,i*(ex(t,r)-r))}(r,i,!0));let I="";return o.forEach(Z=>{const fe=function QN(n){if(s$[n])return s$[n];let t;switch(n){case"G":case"GG":case"GGG":t=di(bn.Eras,Mn.Abbreviated);break;case"GGGG":t=di(bn.Eras,Mn.Wide);break;case"GGGGG":t=di(bn.Eras,Mn.Narrow);break;case"y":t=Ri(Qt.FullYear,1,0,!1,!0);break;case"yy":t=Ri(Qt.FullYear,2,0,!0,!0);break;case"yyy":t=Ri(Qt.FullYear,3,0,!1,!0);break;case"yyyy":t=Ri(Qt.FullYear,4,0,!1,!0);break;case"Y":t=zh(1);break;case"YY":t=zh(2,!0);break;case"YYY":t=zh(3);break;case"YYYY":t=zh(4);break;case"M":case"L":t=Ri(Qt.Month,1,1);break;case"MM":case"LL":t=Ri(Qt.Month,2,1);break;case"MMM":t=di(bn.Months,Mn.Abbreviated);break;case"MMMM":t=di(bn.Months,Mn.Wide);break;case"MMMMM":t=di(bn.Months,Mn.Narrow);break;case"LLL":t=di(bn.Months,Mn.Abbreviated,Ai.Standalone);break;case"LLLL":t=di(bn.Months,Mn.Wide,Ai.Standalone);break;case"LLLLL":t=di(bn.Months,Mn.Narrow,Ai.Standalone);break;case"w":t=r$(1);break;case"ww":t=r$(2);break;case"W":t=r$(1,!0);break;case"d":t=Ri(Qt.Date,1);break;case"dd":t=Ri(Qt.Date,2);break;case"c":case"cc":t=Ri(Qt.Day,1);break;case"ccc":t=di(bn.Days,Mn.Abbreviated,Ai.Standalone);break;case"cccc":t=di(bn.Days,Mn.Wide,Ai.Standalone);break;case"ccccc":t=di(bn.Days,Mn.Narrow,Ai.Standalone);break;case"cccccc":t=di(bn.Days,Mn.Short,Ai.Standalone);break;case"E":case"EE":case"EEE":t=di(bn.Days,Mn.Abbreviated);break;case"EEEE":t=di(bn.Days,Mn.Wide);break;case"EEEEE":t=di(bn.Days,Mn.Narrow);break;case"EEEEEE":t=di(bn.Days,Mn.Short);break;case"a":case"aa":case"aaa":t=di(bn.DayPeriods,Mn.Abbreviated);break;case"aaaa":t=di(bn.DayPeriods,Mn.Wide);break;case"aaaaa":t=di(bn.DayPeriods,Mn.Narrow);break;case"b":case"bb":case"bbb":t=di(bn.DayPeriods,Mn.Abbreviated,Ai.Standalone,!0);break;case"bbbb":t=di(bn.DayPeriods,Mn.Wide,Ai.Standalone,!0);break;case"bbbbb":t=di(bn.DayPeriods,Mn.Narrow,Ai.Standalone,!0);break;case"B":case"BB":case"BBB":t=di(bn.DayPeriods,Mn.Abbreviated,Ai.Format,!0);break;case"BBBB":t=di(bn.DayPeriods,Mn.Wide,Ai.Format,!0);break;case"BBBBB":t=di(bn.DayPeriods,Mn.Narrow,Ai.Format,!0);break;case"h":t=Ri(Qt.Hours,1,-12);break;case"hh":t=Ri(Qt.Hours,2,-12);break;case"H":t=Ri(Qt.Hours,1);break;case"HH":t=Ri(Qt.Hours,2);break;case"m":t=Ri(Qt.Minutes,1);break;case"mm":t=Ri(Qt.Minutes,2);break;case"s":t=Ri(Qt.Seconds,1);break;case"ss":t=Ri(Qt.Seconds,2);break;case"S":t=Ri(Qt.FractionalSeconds,1);break;case"SS":t=Ri(Qt.FractionalSeconds,2);break;case"SSS":t=Ri(Qt.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=Bh(Yi.Short);break;case"ZZZZZ":t=Bh(Yi.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=Bh(Yi.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=Bh(Yi.Long);break;default:return null}return s$[n]=t,t}(Z);I+=fe?fe(r,e,m):"''"===Z?"'":Z.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),I}function Oh(n,t,e){const i=new Date(0);return i.setFullYear(n,t,e),i.setHours(0,0,0),i}function na(n,t){const e=function PN(n){return Or(n)[St.LocaleId]}(n);if(vd[e]=vd[e]||{},vd[e][t])return vd[e][t];let i="";switch(t){case"shortDate":i=Ph(n,xi.Short);break;case"mediumDate":i=Ph(n,xi.Medium);break;case"longDate":i=Ph(n,xi.Long);break;case"fullDate":i=Ph(n,xi.Full);break;case"shortTime":i=Nh(n,xi.Short);break;case"mediumTime":i=Nh(n,xi.Medium);break;case"longTime":i=Nh(n,xi.Long);break;case"fullTime":i=Nh(n,xi.Full);break;case"short":const r=na(n,"shortTime"),s=na(n,"shortDate");i=Rh(Fh(n,xi.Short),[r,s]);break;case"medium":const o=na(n,"mediumTime"),c=na(n,"mediumDate");i=Rh(Fh(n,xi.Medium),[o,c]);break;case"long":const m=na(n,"longTime"),I=na(n,"longDate");i=Rh(Fh(n,xi.Long),[m,I]);break;case"full":const Z=na(n,"fullTime"),fe=na(n,"fullDate");i=Rh(Fh(n,xi.Full),[Z,fe])}return i&&(vd[e][t]=i),i}function Rh(n,t){return t&&(n=n.replace(/\{([^}]+)}/g,function(e,i){return null!=t&&i in t?t[i]:e})),n}function lo(n,t,e="-",i,r){let s="";(n<0||r&&n<=0)&&(r?n=1-n:(n=-n,s=e));let o=String(n);for(;o.length<t;)o="0"+o;return i&&(o=o.substr(o.length-t)),s+o}function Ri(n,t,e=0,i=!1,r=!1){return function(s,o){let c=function KN(n,t){switch(n){case Qt.FullYear:return t.getFullYear();case Qt.Month:return t.getMonth();case Qt.Date:return t.getDate();case Qt.Hours:return t.getHours();case Qt.Minutes:return t.getMinutes();case Qt.Seconds:return t.getSeconds();case Qt.FractionalSeconds:return t.getMilliseconds();case Qt.Day:return t.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}(n,s);if((e>0||c>-e)&&(c+=e),n===Qt.Hours)0===c&&-12===e&&(c=12);else if(n===Qt.FractionalSeconds)return function WN(n,t){return lo(n,3).substr(0,t)}(c,t);const m=Ds(o,Yt.MinusSign);return lo(c,t,m,i,r)}}function di(n,t,e=Ai.Format,i=!1){return function(r,s){return function YN(n,t,e,i,r,s){switch(e){case bn.Months:return function ON(n,t,e){const i=Or(n),s=As([i[St.MonthsFormat],i[St.MonthsStandalone]],t);return As(s,e)}(t,r,i)[n.getMonth()];case bn.Days:return function FN(n,t,e){const i=Or(n),s=As([i[St.DaysFormat],i[St.DaysStandalone]],t);return As(s,e)}(t,r,i)[n.getDay()];case bn.DayPeriods:const o=n.getHours(),c=n.getMinutes();if(s){const I=function zN(n){const t=Or(n);return Q2(t),(t[St.ExtraData][2]||[]).map(i=>"string"==typeof i?i$(i):[i$(i[0]),i$(i[1])])}(t),Z=function jN(n,t,e){const i=Or(n);Q2(i);const s=As([i[St.ExtraData][0],i[St.ExtraData][1]],t)||[];return As(s,e)||[]}(t,r,i),fe=I.findIndex(pe=>{if(Array.isArray(pe)){const[ye,we]=pe,Me=o>=ye.hours&&c>=ye.minutes,Oe=o<we.hours||o===we.hours&&c<we.minutes;if(ye.hours<we.hours){if(Me&&Oe)return!0}else if(Me||Oe)return!0}else if(pe.hours===o&&pe.minutes===c)return!0;return!1});if(-1!==fe)return Z[fe]}return function NN(n,t,e){const i=Or(n),s=As([i[St.DayPeriodsFormat],i[St.DayPeriodsStandalone]],t);return As(s,e)}(t,r,i)[o<12?0:1];case bn.Eras:return function RN(n,t){return As(Or(n)[St.Eras],t)}(t,i)[n.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(r,s,n,t,e,i)}}function Bh(n){return function(t,e,i){const r=-1*i,s=Ds(e,Yt.MinusSign),o=r>0?Math.floor(r/60):Math.ceil(r/60);switch(n){case Yi.Short:return(r>=0?"+":"")+lo(o,2,s)+lo(Math.abs(r%60),2,s);case Yi.ShortGMT:return"GMT"+(r>=0?"+":"")+lo(o,1,s);case Yi.Long:return"GMT"+(r>=0?"+":"")+lo(o,2,s)+":"+lo(Math.abs(r%60),2,s);case Yi.Extended:return 0===i?"Z":(r>=0?"+":"")+lo(o,2,s)+":"+lo(Math.abs(r%60),2,s);default:throw new Error(`Unknown zone width "${n}"`)}}}function J2(n){return Oh(n.getFullYear(),n.getMonth(),n.getDate()+(4-n.getDay()))}function r$(n,t=!1){return function(e,i){let r;if(t){const s=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,o=e.getDate();r=1+Math.floor((o+s)/7)}else{const s=J2(e),o=function XN(n){const t=Oh(n,0,1).getDay();return Oh(n,0,1+(t<=4?4:11)-t)}(s.getFullYear()),c=s.getTime()-o.getTime();r=1+Math.round(c/6048e5)}return lo(r,n,Ds(i,Yt.MinusSign))}}function zh(n,t=!1){return function(e,i){return lo(J2(e).getFullYear(),n,Ds(i,Yt.MinusSign),t)}}const s$={};function ex(n,t){n=n.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(e)?t:e}function tx(n){return n instanceof Date&&!isNaN(n.valueOf())}let Wn=(()=>{class n{constructor(e,i,r,s){this._iterableDiffers=e,this._keyValueDiffers=i,this._ngEl=r,this._renderer=s,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(id(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(i=>this._toggleClass(i.key,i.currentValue)),e.forEachChangedItem(i=>this._toggleClass(i.key,i.currentValue)),e.forEachRemovedItem(i=>{i.previousValue&&this._toggleClass(i.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(i=>{if("string"!=typeof i.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${Un(i.item)}`);this._toggleClass(i.item,!0)}),e.forEachRemovedItem(i=>this._toggleClass(i.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(i=>this._toggleClass(i,!0)):Object.keys(e).forEach(i=>this._toggleClass(i,!!e[i])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(i=>this._toggleClass(i,!1)):Object.keys(e).forEach(i=>this._toggleClass(i,!1)))}_toggleClass(e,i){(e=e.trim())&&e.split(/\s+/g).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return n.\u0275fac=function(e){return new(e||n)(Le(Dh),Le($d),Le(_i),Le(vl))},n.\u0275dir=Xt({type:n,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),n})();class mF{constructor(t,e,i,r){this.$implicit=t,this.ngForOf=e,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let ei=(()=>{class n{constructor(e,i,r){this._viewContainer=e,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const i=this._viewContainer;e.forEachOperation((r,s,o)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new mF(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)i.remove(null===s?void 0:s);else if(null!==s){const c=i.get(s);i.move(c,o),sx(c,r)}});for(let r=0,s=i.length;r<s;r++){const c=i.get(r).context;c.index=r,c.count=s,c.ngForOf=this._ngForOf}e.forEachIdentityChange(r=>{sx(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(e,i){return!0}}return n.\u0275fac=function(e){return new(e||n)(Le(Rr),Le(ta),Le(Dh))},n.\u0275dir=Xt({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),n})();function sx(n,t){n.context.$implicit=t.item}let _n=(()=>{class n{constructor(e,i){this._viewContainer=e,this._context=new _F,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){ox("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){ox("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,i){return!0}}return n.\u0275fac=function(e){return new(e||n)(Le(Rr),Le(ta))},n.\u0275dir=Xt({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),n})();class _F{constructor(){this.$implicit=null,this.ngIf=null}}function ox(n,t){if(t&&!t.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${Un(t)}'.`)}class d${constructor(t,e){this._viewContainerRef=t,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(t){t&&!this._created?this.create():!t&&this._created&&this.destroy()}}let xl=(()=>{class n{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(e)}_matchCase(e){const i=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||i,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),i}_updateDefaultCases(e){if(this._defaultViews&&e!==this._defaultUsed){this._defaultUsed=e;for(let i=0;i<this._defaultViews.length;i++)this._defaultViews[i].enforceState(e)}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Xt({type:n,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),n})(),Cd=(()=>{class n{constructor(e,i,r){this.ngSwitch=r,r._addCase(),this._view=new d$(e,i)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return n.\u0275fac=function(e){return new(e||n)(Le(Rr),Le(ta),Le(xl,9))},n.\u0275dir=Xt({type:n,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),n})(),xd=(()=>{class n{constructor(e,i,r){r._addDefault(new d$(e,i))}}return n.\u0275fac=function(e){return new(e||n)(Le(Rr),Le(ta),Le(xl,9))},n.\u0275dir=Xt({type:n,selectors:[["","ngSwitchDefault",""]]}),n})(),Zi=(()=>{class n{constructor(e,i,r){this._ngEl=e,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,i){const[r,s]=e.split(".");null!=(i=null!=i&&s?`${i}${s}`:i)?this._renderer.setStyle(this._ngEl.nativeElement,r,i):this._renderer.removeStyle(this._ngEl.nativeElement,r)}_applyChanges(e){e.forEachRemovedItem(i=>this._setStyle(i.key,null)),e.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),e.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}}return n.\u0275fac=function(e){return new(e||n)(Le(_i),Le($d),Le(vl))},n.\u0275dir=Xt({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}}),n})(),wl=(()=>{class n{constructor(e){this._viewContainerRef=e,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null}ngOnChanges(e){if(e.ngTemplateOutlet){const i=this._viewContainerRef;this._viewRef&&i.remove(i.indexOf(this._viewRef)),this._viewRef=this.ngTemplateOutlet?i.createEmbeddedView(this.ngTemplateOutlet,this.ngTemplateOutletContext):null}else this._viewRef&&e.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return n.\u0275fac=function(e){return new(e||n)(Le(Rr))},n.\u0275dir=Xt({type:n,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet"},features:[eo]}),n})();const SF=new Dn("DATE_PIPE_DEFAULT_TIMEZONE");let lx=(()=>{class n{constructor(e,i){this.locale=e,this.defaultTimezone=i}transform(e,i="mediumDate",r,s){var o;if(null==e||""===e||e!=e)return null;try{return bd(e,i,s||this.locale,null!==(o=null!=r?r:this.defaultTimezone)&&void 0!==o?o:void 0)}catch(c){throw function co(n,t){return new Mt(2100,"")}()}}}return n.\u0275fac=function(e){return new(e||n)(Le(Ia,16),Le(SF,24))},n.\u0275pipe=mr({name:"date",type:n,pure:!0}),n})(),ux=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ws({type:n}),n.\u0275inj=ls({}),n})();const dx="browser";function p$(n){return n===dx}class g$ extends class VF extends class MN{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function SN(n){Ah||(Ah=n)}(new g$)}onAndCancel(t,e,i){return t.addEventListener(e,i,!1),()=>{t.removeEventListener(e,i,!1)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.parentNode&&t.parentNode.removeChild(t)}createElement(t,e){return(e=e||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return"window"===e?window:"document"===e?t:"body"===e?t.body:null}getBaseHref(t){const e=function GF(){return wd=wd||document.querySelector("base"),wd?wd.getAttribute("href"):null}();return null==e?null:function qF(n){Hh=Hh||document.createElement("a"),Hh.setAttribute("href",n);const t=Hh.pathname;return"/"===t.charAt(0)?t:`/${t}`}(e)}resetBaseElement(){wd=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return function pF(n,t){t=encodeURIComponent(t);for(const e of n.split(";")){const i=e.indexOf("="),[r,s]=-1==i?[e,""]:[e.slice(0,i),e.slice(i+1)];if(r.trim()===t)return decodeURIComponent(s)}return null}(document.cookie,t)}}let Hh,wd=null;const hx=new Dn("TRANSITION_ID"),KF=[{provide:j_,useFactory:function WF(n,t,e){return()=>{e.get(H_).donePromise.then(()=>{const i=Cl(),r=t.querySelectorAll(`style[ng-transition="${n}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[hx,Xr,Yr],multi:!0}];class m${static init(){!function tN(n){K_=n}(new m$)}addToWindow(t){Jn.getAngularTestability=(i,r=!0)=>{const s=t.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},Jn.getAllAngularTestabilities=()=>t.getAllTestabilities(),Jn.getAllAngularRootElements=()=>t.getAllRootElements(),Jn.frameworkStabilizers||(Jn.frameworkStabilizers=[]),Jn.frameworkStabilizers.push(i=>{const r=Jn.getAllAngularTestabilities();let s=r.length,o=!1;const c=function(m){o=o||m,s--,0==s&&i(o)};r.forEach(function(m){m.whenStable(c)})})}findTestabilityInTree(t,e,i){if(null==e)return null;const r=t.getTestability(e);return null!=r?r:i?Cl().isShadowRoot(e)?this.findTestabilityInTree(t,e.host,!0):this.findTestabilityInTree(t,e.parentElement,!0):null}}let YF=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=tn({token:n,factory:n.\u0275fac}),n})();const Uh=new Dn("EventManagerPlugins");let Vh=(()=>{class n{constructor(e,i){this._zone=i,this._eventNameToPlugin=new Map,e.forEach(r=>r.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,i,r){return this._findPluginFor(i).addEventListener(e,i,r)}addGlobalEventListener(e,i,r){return this._findPluginFor(i).addGlobalEventListener(e,i,r)}getZone(){return this._zone}_findPluginFor(e){const i=this._eventNameToPlugin.get(e);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(e))return this._eventNameToPlugin.set(e,o),o}throw new Error(`No event manager plugin found for event ${e}`)}}return n.\u0275fac=function(e){return new(e||n)(rn(Uh),rn(vn))},n.\u0275prov=tn({token:n,factory:n.\u0275fac}),n})();class px{constructor(t){this._doc=t}addGlobalEventListener(t,e,i){const r=Cl().getGlobalEventTarget(this._doc,t);if(!r)throw new Error(`Unsupported event target ${r} for event ${e}`);return this.addEventListener(r,e,i)}}let gx=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(e){const i=new Set;e.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=tn({token:n,factory:n.\u0275fac}),n})(),Ed=(()=>{class n extends gx{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,i,r){e.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,r.push(i.appendChild(o))})}addHost(e){const i=[];this._addStylesToHost(this._stylesSet,e,i),this._hostNodes.set(e,i)}removeHost(e){const i=this._hostNodes.get(e);i&&i.forEach(mx),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(e,r,i)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(mx))}}return n.\u0275fac=function(e){return new(e||n)(rn(Xr))},n.\u0275prov=tn({token:n,factory:n.\u0275fac}),n})();function mx(n){Cl().remove(n)}const _$={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},$$=/%COMP%/g;function Gh(n,t,e){for(let i=0;i<t.length;i++){let r=t[i];Array.isArray(r)?Gh(n,r,e):(r=r.replace($$,n),e.push(r))}return e}function vx(n){return t=>{if("__ngUnwrap__"===t)return n;!1===n(t)&&(t.preventDefault(),t.returnValue=!1)}}let qh=(()=>{class n{constructor(e,i,r){this.eventManager=e,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new v$(e)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;switch(i.encapsulation){case Zs.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new tO(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(e),r}case 1:case Zs.ShadowDom:return new nO(this.eventManager,this.sharedStylesHost,e,i);default:if(!this.rendererByCompId.has(i.id)){const r=Gh(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(e){return new(e||n)(rn(Vh),rn(Ed),rn(md))},n.\u0275prov=tn({token:n,factory:n.\u0275fac}),n})();class v${constructor(t){this.eventManager=t,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(t,e){return e?document.createElementNS(_$[e]||e,t):document.createElement(t)}createComment(t){return document.createComment(t)}createText(t){return document.createTextNode(t)}appendChild(t,e){t.appendChild(e)}insertBefore(t,e,i){t&&t.insertBefore(e,i)}removeChild(t,e){t&&t.removeChild(e)}selectRootElement(t,e){let i="string"==typeof t?document.querySelector(t):t;if(!i)throw new Error(`The selector "${t}" did not match any elements`);return e||(i.textContent=""),i}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,i,r){if(r){e=r+":"+e;const s=_$[r];s?t.setAttributeNS(s,e,i):t.setAttribute(e,i)}else t.setAttribute(e,i)}removeAttribute(t,e,i){if(i){const r=_$[i];r?t.removeAttributeNS(r,e):t.removeAttribute(`${i}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,i,r){r&(hs.DashCase|hs.Important)?t.style.setProperty(e,i,r&hs.Important?"important":""):t.style[e]=i}removeStyle(t,e,i){i&hs.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,i){t[e]=i}setValue(t,e){t.nodeValue=e}listen(t,e,i){return"string"==typeof t?this.eventManager.addGlobalEventListener(t,e,vx(i)):this.eventManager.addEventListener(t,e,vx(i))}}class tO extends v${constructor(t,e,i,r){super(t),this.component=i;const s=Gh(r+"-"+i.id,i.styles,[]);e.addStyles(s),this.contentAttr=function QF(n){return"_ngcontent-%COMP%".replace($$,n)}(r+"-"+i.id),this.hostAttr=function JF(n){return"_nghost-%COMP%".replace($$,n)}(r+"-"+i.id)}applyToHost(t){super.setAttribute(t,this.hostAttr,"")}createElement(t,e){const i=super.createElement(t,e);return super.setAttribute(i,this.contentAttr,""),i}}class nO extends v${constructor(t,e,i,r){super(t),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=Gh(r.id,r.styles,[]);for(let o=0;o<s.length;o++){const c=document.createElement("style");c.textContent=s[o],this.shadowRoot.appendChild(c)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,i){return super.insertBefore(this.nodeOrShadowRoot(t),e,i)}removeChild(t,e){return super.removeChild(this.nodeOrShadowRoot(t),e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}}let iO=(()=>{class n extends px{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,r){return e.addEventListener(i,r,!1),()=>this.removeEventListener(e,i,r)}removeEventListener(e,i,r){return e.removeEventListener(i,r)}}return n.\u0275fac=function(e){return new(e||n)(rn(Xr))},n.\u0275prov=tn({token:n,factory:n.\u0275fac}),n})();const yx=["alt","control","meta","shift"],sO={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Cx={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},oO={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let aO=(()=>{class n extends px{constructor(e){super(e)}supports(e){return null!=n.parseEventName(e)}addEventListener(e,i,r){const s=n.parseEventName(i),o=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Cl().onAndCancel(e,s.domEventName,o))}static parseEventName(e){const i=e.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=n._normalizeKey(i.pop());let o="";if(yx.forEach(m=>{const I=i.indexOf(m);I>-1&&(i.splice(I,1),o+=m+".")}),o+=s,0!=i.length||0===s.length)return null;const c={};return c.domEventName=r,c.fullKey=o,c}static getEventFullKey(e){let i="",r=function lO(n){let t=n.key;if(null==t){if(t=n.keyIdentifier,null==t)return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===n.location&&Cx.hasOwnProperty(t)&&(t=Cx[t]))}return sO[t]||t}(e);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),yx.forEach(s=>{s!=r&&oO[s](e)&&(i+=s+".")}),i+=r,i}static eventCallback(e,i,r){return s=>{n.getEventFullKey(s)===e&&r.runGuarded(()=>i(s))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return n.\u0275fac=function(e){return new(e||n)(rn(Xr))},n.\u0275prov=tn({token:n,factory:n.\u0275fac}),n})();const fO=N2(EN,"browser",[{provide:_d,useValue:dx},{provide:M2,useValue:function cO(){g$.makeCurrent(),m$.init()},multi:!0},{provide:Xr,useFactory:function dO(){return function VS(n){Lg=n}(document),document},deps:[]}]),hO=[{provide:t_,useValue:"root"},{provide:Xu,useFactory:function uO(){return new Xu},deps:[]},{provide:Uh,useClass:iO,multi:!0,deps:[Xr,vn,_d]},{provide:Uh,useClass:aO,multi:!0,deps:[Xr]},{provide:qh,useClass:qh,deps:[Vh,Ed,md]},{provide:dd,useExisting:qh},{provide:gx,useExisting:Ed},{provide:Ed,useClass:Ed,deps:[Xr]},{provide:W_,useClass:W_,deps:[vn]},{provide:Vh,useClass:Vh,deps:[Uh,vn]},{provide:class UF{},useClass:YF,deps:[]}];let xx=(()=>{class n{constructor(e){if(e)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:n,providers:[{provide:md,useValue:e.appId},{provide:hx,useExisting:md},KF]}}}return n.\u0275fac=function(e){return new(e||n)(rn(n,12))},n.\u0275mod=ws({type:n}),n.\u0275inj=ls({providers:hO,imports:[ux,TN]}),n})();"undefined"!=typeof window&&window;let Tx=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=tn({token:n,factory:function(e){let i=null;return i=e?new(e||n):rn(Ix),i},providedIn:"root"}),n})(),Ix=(()=>{class n extends Tx{constructor(e){super(),this._doc=e}sanitize(e,i){if(null==i)return null;switch(e){case ci.NONE:return i;case ci.HTML:return bo(i,"HTML")?fs(i):Ov(this._doc,String(i)).toString();case ci.STYLE:return bo(i,"Style")?fs(i):i;case ci.SCRIPT:if(bo(i,"Script"))return fs(i);throw new Error("unsafe value used in a script context");case ci.URL:return Sv(i),bo(i,"URL")?fs(i):Wu(String(i));case ci.RESOURCE_URL:if(bo(i,"ResourceURL"))return fs(i);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${e} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(e){return function rk(n){return new JM(n)}(e)}bypassSecurityTrustStyle(e){return function sk(n){return new ek(n)}(e)}bypassSecurityTrustScript(e){return function ok(n){return new tk(n)}(e)}bypassSecurityTrustUrl(e){return function ak(n){return new nk(n)}(e)}bypassSecurityTrustResourceUrl(e){return function lk(n){return new ik(n)}(e)}}return n.\u0275fac=function(e){return new(e||n)(rn(Xr))},n.\u0275prov=tn({token:n,factory:function(e){let i=null;return i=e?new e:function xO(n){return new Ix(n.get(Xr))}(rn(Yr)),i},providedIn:"root"}),n})();X(5386);const{isArray:wO}=Array,{getPrototypeOf:EO,prototype:TO,keys:IO}=Object;function Sx(n){if(1===n.length){const t=n[0];if(wO(t))return{args:t,keys:null};if(function SO(n){return n&&"object"==typeof n&&EO(n)===TO}(t)){const e=IO(t);return{args:e.map(i=>t[i]),keys:e}}}return{args:n,keys:null}}const{isArray:MO}=Array;function Td(n){return ve(t=>function kO(n,t){return MO(t)?n(...t):n(t)}(n,t))}function Mx(n,t){return n.reduce((e,i,r)=>(e[i]=t[r],e),{})}let kx=(()=>{class n{constructor(e,i){this._renderer=e,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return n.\u0275fac=function(e){return new(e||n)(Le(vl),Le(_i))},n.\u0275dir=Xt({type:n}),n})(),El=(()=>{class n extends kx{}return n.\u0275fac=function(){let t;return function(i){return(t||(t=vr(n)))(i||n)}}(),n.\u0275dir=Xt({type:n,features:[Yn]}),n})();const To=new Dn("NgValueAccessor"),AO={provide:To,useExisting:qn(()=>Jr),multi:!0};let Jr=(()=>{class n extends El{writeValue(e){this.setProperty("checked",e)}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=vr(n)))(i||n)}}(),n.\u0275dir=Xt({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(e,i){1&e&&Te("change",function(s){return i.onChange(s.target.checked)})("blur",function(){return i.onTouched()})},features:[ui([AO]),Yn]}),n})();const PO={provide:To,useExisting:qn(()=>fi),multi:!0},Dx=new Dn("CompositionEventMode");let fi=(()=>{class n extends kx{constructor(e,i,r){super(e,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function NO(){const n=Cl()?Cl().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(e){this.setProperty("value",null==e?"":e)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return n.\u0275fac=function(e){return new(e||n)(Le(vl),Le(_i),Le(Dx,8))},n.\u0275dir=Xt({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,i){1&e&&Te("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},features:[ui([PO]),Yn]}),n})();function Ma(n){return null==n||0===n.length}function Ax(n){return null!=n&&"number"==typeof n.length}const Cr=new Dn("NgValidators"),ka=new Dn("NgAsyncValidators");function Fx(n){return Ma(n.value)?{required:!0}:null}function Wh(n){return null}function jx(n){return null!=n}function Hx(n){const t=ph(n)?Dr(n):n;return ky(t),t}function Ux(n){let t={};return n.forEach(e=>{t=null!=e?Object.assign(Object.assign({},t),e):t}),0===Object.keys(t).length?null:t}function Vx(n,t){return t.map(e=>e(n))}function Gx(n){return n.map(t=>function OO(n){return!n.validate}(t)?t:e=>t.validate(e))}function y$(n){return null!=n?function qx(n){if(!n)return null;const t=n.filter(jx);return 0==t.length?null:function(e){return Ux(Vx(e,t))}}(Gx(n)):null}function C$(n){return null!=n?function Wx(n){if(!n)return null;const t=n.filter(jx);return 0==t.length?null:function(e){return function DO(...n){const t=al(n),{args:e,keys:i}=Sx(n),r=new f(s=>{const{length:o}=e;if(!o)return void s.complete();const c=new Array(o);let m=o,I=o;for(let Z=0;Z<o;Z++){let fe=!1;pr(e[Z]).subscribe(re(s,pe=>{fe||(fe=!0,I--),c[Z]=pe},()=>m--,void 0,()=>{(!m||!fe)&&(I||s.next(i?Mx(i,c):c),s.complete())}))}});return t?r.pipe(Td(t)):r}(Vx(e,t).map(Hx)).pipe(ve(Ux))}}(Gx(n)):null}function Kx(n,t){return null===n?[t]:Array.isArray(n)?[...n,t]:[n,t]}function x$(n){return n?Array.isArray(n)?n:[n]:[]}function Kh(n,t){return Array.isArray(n)?n.includes(t):n===t}function Xx(n,t){const e=x$(t);return x$(n).forEach(r=>{Kh(e,r)||e.push(r)}),e}function Qx(n,t){return x$(t).filter(e=>!Kh(n,e))}class Jx{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=y$(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=C$(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t){this.control&&this.control.reset(t)}hasError(t,e){return!!this.control&&this.control.hasError(t,e)}getError(t,e){return this.control?this.control.getError(t,e):null}}class Da extends Jx{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class Lr extends Jx{get formDirective(){return null}get path(){return null}}class ew{constructor(t){this._cd=t}is(t){var e,i,r;return"submitted"===t?!!(null===(e=this._cd)||void 0===e?void 0:e.submitted):!!(null===(r=null===(i=this._cd)||void 0===i?void 0:i.control)||void 0===r?void 0:r[t])}}let hi=(()=>{class n extends ew{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(Le(Da,2))},n.\u0275dir=Xt({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,i){2&e&&gh("ng-untouched",i.is("untouched"))("ng-touched",i.is("touched"))("ng-pristine",i.is("pristine"))("ng-dirty",i.is("dirty"))("ng-valid",i.is("valid"))("ng-invalid",i.is("invalid"))("ng-pending",i.is("pending"))},features:[Yn]}),n})(),Tl=(()=>{class n extends ew{constructor(e){super(e)}}return n.\u0275fac=function(e){return new(e||n)(Le(Lr,10))},n.\u0275dir=Xt({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,i){2&e&&gh("ng-untouched",i.is("untouched"))("ng-touched",i.is("touched"))("ng-pristine",i.is("pristine"))("ng-dirty",i.is("dirty"))("ng-valid",i.is("valid"))("ng-invalid",i.is("invalid"))("ng-pending",i.is("pending"))("ng-submitted",i.is("submitted"))},features:[Yn]}),n})();function Id(n,t){T$(n,t),t.valueAccessor.writeValue(n.value),function VO(n,t){t.valueAccessor.registerOnChange(e=>{n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&nw(n,t)})}(n,t),function qO(n,t){const e=(i,r)=>{t.valueAccessor.writeValue(i),r&&t.viewToModelUpdate(i)};n.registerOnChange(e),t._registerOnDestroy(()=>{n._unregisterOnChange(e)})}(n,t),function GO(n,t){t.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&nw(n,t),"submit"!==n.updateOn&&n.markAsTouched()})}(n,t),function UO(n,t){if(t.valueAccessor.setDisabledState){const e=i=>{t.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(e),t._registerOnDestroy(()=>{n._unregisterOnDisabledChange(e)})}}(n,t)}function Qh(n,t){n.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function T$(n,t){const e=function Yx(n){return n._rawValidators}(n);null!==t.validator?n.setValidators(Kx(e,t.validator)):"function"==typeof e&&n.setValidators([e]);const i=function Zx(n){return n._rawAsyncValidators}(n);null!==t.asyncValidator?n.setAsyncValidators(Kx(i,t.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const r=()=>n.updateValueAndValidity();Qh(t._rawValidators,r),Qh(t._rawAsyncValidators,r)}function nw(n,t){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function M$(n,t){const e=n.indexOf(t);e>-1&&n.splice(e,1)}const Sd="VALID",ep="INVALID",Qc="PENDING",Md="DISABLED";function D$(n){return(tp(n)?n.validators:n)||null}function ow(n){return Array.isArray(n)?y$(n):n||null}function A$(n,t){return(tp(t)?t.asyncValidators:n)||null}function aw(n){return Array.isArray(n)?C$(n):n||null}function tp(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}const P$=n=>n instanceof F$;function cw(n){return(n=>n instanceof fw)(n)?n.value:n.getRawValue()}function uw(n,t){const e=P$(n),i=n.controls;if(!(e?Object.keys(i):i).length)throw new Mt(1e3,"");if(!i[t])throw new Mt(1001,"")}function dw(n,t){P$(n),n._forEachChild((i,r)=>{if(void 0===t[r])throw new Mt(1002,"")})}class N${constructor(t,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=e,this._composedValidatorFn=ow(this._rawValidators),this._composedAsyncValidatorFn=aw(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get valid(){return this.status===Sd}get invalid(){return this.status===ep}get pending(){return this.status==Qc}get disabled(){return this.status===Md}get enabled(){return this.status!==Md}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._rawValidators=t,this._composedValidatorFn=ow(t)}setAsyncValidators(t){this._rawAsyncValidators=t,this._composedAsyncValidatorFn=aw(t)}addValidators(t){this.setValidators(Xx(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(Xx(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(Qx(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(Qx(t,this._rawAsyncValidators))}hasValidator(t){return Kh(this._rawValidators,t)}hasAsyncValidator(t){return Kh(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){this.touched=!0,this._parent&&!t.onlySelf&&this._parent.markAsTouched(t)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(t=>t.markAllAsTouched())}markAsUntouched(t={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}markAsDirty(t={}){this.pristine=!1,this._parent&&!t.onlySelf&&this._parent.markAsDirty(t)}markAsPristine(t={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}markAsPending(t={}){this.status=Qc,!1!==t.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!t.onlySelf&&this._parent.markAsPending(t)}disable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=Md,this.errors=null,this._forEachChild(i=>{i.disable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this._updateValue(),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(i=>i(!0))}enable(t={}){const e=this._parentMarkedDirty(t.onlySelf);this.status=Sd,this._forEachChild(i=>{i.enable(Object.assign(Object.assign({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},t),{skipPristineCheck:e})),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(t){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(t){this._parent=t}updateValueAndValidity(t={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Sd||this.status===Qc)&&this._runAsyncValidator(t.emitEvent)),!1!==t.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(t)}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Md:Sd}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t){if(this.asyncValidator){this.status=Qc,this._hasOwnPendingAsyncValidator=!0;const e=Hx(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:t})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(!1!==e.emitEvent)}get(t){return function ZO(n,t,e){if(null==t||(Array.isArray(t)||(t=t.split(e)),Array.isArray(t)&&0===t.length))return null;let i=n;return t.forEach(r=>{i=P$(i)?i.controls.hasOwnProperty(r)?i.controls[r]:null:(n=>n instanceof QO)(i)&&i.at(r)||null}),i}(this,t,".")}getError(t,e){const i=e?this.get(e):this;return i&&i.errors?i.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(t)}_initObservables(){this.valueChanges=new Cn,this.statusChanges=new Cn}_calculateStatus(){return this._allControlsDisabled()?Md:this.errors?ep:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Qc)?Qc:this._anyControlsHaveStatus(ep)?ep:Sd}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t={}){this.pristine=!this._anyControlsDirty(),this._parent&&!t.onlySelf&&this._parent._updatePristine(t)}_updateTouched(t={}){this.touched=this._anyControlsTouched(),this._parent&&!t.onlySelf&&this._parent._updateTouched(t)}_isBoxedValue(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){tp(t)&&null!=t.updateOn&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){return!t&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class fw extends N${constructor(t=null,e,i){super(D$(e),A$(i,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),tp(e)&&e.initialValueIsDefault&&(this.defaultValue=this._isBoxedValue(t)?t.value:t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){M$(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){M$(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(t){this._isBoxedValue(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}}class F$ extends N${constructor(t,e,i){super(D$(e),A$(i,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,i={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,i={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){dw(this,t),Object.keys(t).forEach(i=>{uw(this,i),this.controls[i].setValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(Object.keys(t).forEach(i=>{this.controls[i]&&this.controls[i].patchValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((i,r)=>{i.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,i)=>(t[i]=cw(e),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,i)=>!!i._syncPendingControls()||e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{const i=this.controls[e];i&&t(i,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(const e of Object.keys(this.controls)){const i=this.controls[e];if(this.contains(e)&&t(i))return!0}return!1}_reduceValue(){return this._reduceChildren({},(t,e,i)=>((e.enabled||this.disabled)&&(t[i]=e.value),t))}_reduceChildren(t,e){let i=t;return this._forEachChild((r,s)=>{i=e(i,r,s)}),i}_allControlsDisabled(){for(const t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}}class QO extends N${constructor(t,e,i){super(D$(e),A$(i,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(t){return this.controls[t]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,i={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,i={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),this.controls.splice(t,1),e&&(this.controls.splice(t,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){dw(this,t),t.forEach((i,r)=>{uw(this,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){null!=t&&(t.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((i,r)=>{i.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>cw(t))}clear(t={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_syncPendingControls(){let t=this.controls.reduce((e,i)=>!!i._syncPendingControls()||e,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((e,i)=>{t(e,i)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(const t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}}const JO={provide:Lr,useExisting:qn(()=>ia)},kd=(()=>Promise.resolve(null))();let ia=(()=>{class n extends Lr{constructor(e,i){super(),this.submitted=!1,this._directives=new Set,this.ngSubmit=new Cn,this.form=new F$({},y$(e),C$(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){kd.then(()=>{const i=this._findContainer(e.path);e.control=i.registerControl(e.name,e.control),Id(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){kd.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){kd.then(()=>{const i=this._findContainer(e.path),r=new F$({});(function iw(n,t){T$(n,t)})(r,e),i.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){kd.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,i){kd.then(()=>{this.form.get(e.path).setValue(i)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,function sw(n,t){n._syncPendingControls(),t.forEach(e=>{const i=e.control;"submit"===i.updateOn&&i._pendingChange&&(e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}(this.form,this._directives),this.ngSubmit.emit(e),!1}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return n.\u0275fac=function(e){return new(e||n)(Le(Cr,10),Le(ka,10))},n.\u0275dir=Xt({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,i){1&e&&Te("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[ui([JO]),Yn]}),n})();const tR={provide:Da,useExisting:qn(()=>oi)},gw=(()=>Promise.resolve(null))();let oi=(()=>{class n extends Da{constructor(e,i,r,s,o){super(),this._changeDetectorRef=o,this.control=new fw,this._registered=!1,this.update=new Cn,this._parent=e,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function S$(n,t){if(!t)return null;let e,i,r;return Array.isArray(t),t.forEach(s=>{s.constructor===fi?e=s:function YO(n){return Object.getPrototypeOf(n.constructor)===El}(s)?i=s:r=s}),r||i||e||null}(0,s)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const i=e.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),function I$(n,t){if(!n.hasOwnProperty("model"))return!1;const e=n.model;return!!e.isFirstChange()||!Object.is(t,e.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Id(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){gw.then(()=>{var i;this.control.setValue(e,{emitViewToModelChange:!1}),null===(i=this._changeDetectorRef)||void 0===i||i.markForCheck()})}_updateDisabled(e){const i=e.isDisabled.currentValue,r=""===i||i&&"false"!==i;gw.then(()=>{var s;r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),null===(s=this._changeDetectorRef)||void 0===s||s.markForCheck()})}_getPath(e){return this._parent?function Zh(n,t){return[...t.path,n]}(e,this._parent):[e]}}return n.\u0275fac=function(e){return new(e||n)(Le(Lr,9),Le(Cr,10),Le(ka,10),Le(To,10),Le(Di,8))},n.\u0275dir=Xt({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[ui([tR]),Yn,eo]}),n})(),Il=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Xt({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),n})();const nR={provide:To,useExisting:qn(()=>gs),multi:!0};let gs=(()=>{class n extends El{writeValue(e){this.setProperty("value",null==e?"":e)}registerOnChange(e){this.onChange=i=>{e(""==i?null:parseFloat(i))}}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=vr(n)))(i||n)}}(),n.\u0275dir=Xt({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(e,i){1&e&&Te("input",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},features:[ui([nR]),Yn]}),n})();const iR={provide:To,useExisting:qn(()=>Aa),multi:!0};let mw=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ws({type:n}),n.\u0275inj=ls({}),n})(),rR=(()=>{class n{constructor(){this._accessors=[]}add(e,i){this._accessors.push([e,i])}remove(e){for(let i=this._accessors.length-1;i>=0;--i)if(this._accessors[i][1]===e)return void this._accessors.splice(i,1)}select(e){this._accessors.forEach(i=>{this._isSameGroup(i,e)&&i[1]!==e&&i[1].fireUncheck(e.value)})}_isSameGroup(e,i){return!!e[0].control&&e[0]._parent===i._control._parent&&e[1].name===i.name}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=tn({token:n,factory:n.\u0275fac,providedIn:mw}),n})(),Aa=(()=>{class n extends El{constructor(e,i,r,s){super(e,i),this._registry=r,this._injector=s,this.onChange=()=>{}}ngOnInit(){this._control=this._injector.get(Da),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(e){this._state=e===this.value,this.setProperty("checked",this._state)}registerOnChange(e){this._fn=e,this.onChange=()=>{e(this.value),this._registry.select(this)}}fireUncheck(e){this.writeValue(e)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}}return n.\u0275fac=function(e){return new(e||n)(Le(vl),Le(_i),Le(rR),Le(Yr))},n.\u0275dir=Xt({type:n,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(e,i){1&e&&Te("change",function(){return i.onChange()})("blur",function(){return i.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[ui([iR]),Yn]}),n})();const sR={provide:To,useExisting:qn(()=>ms),multi:!0};let ms=(()=>{class n extends El{writeValue(e){this.setProperty("value",parseFloat(e))}registerOnChange(e){this.onChange=i=>{e(""==i?null:parseFloat(i))}}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=vr(n)))(i||n)}}(),n.\u0275dir=Xt({type:n,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,i){1&e&&Te("change",function(s){return i.onChange(s.target.value)})("input",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},features:[ui([sR]),Yn]}),n})();const dR={provide:To,useExisting:qn(()=>es),multi:!0};function yw(n,t){return null==n?`${t}`:(t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let es=(()=>{class n extends El{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const r=yw(this._getOptionId(e),e);this.setProperty("value",r)}registerOnChange(e){this.onChange=i=>{this.value=this._getOptionValue(i),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i),e))return i;return null}_getOptionValue(e){const i=function fR(n){return n.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i):e}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=vr(n)))(i||n)}}(),n.\u0275dir=Xt({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,i){1&e&&Te("change",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[ui([dR]),Yn]}),n})(),zr=(()=>{class n{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(yw(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(e){return new(e||n)(Le(_i),Le(vl),Le(es,9))},n.\u0275dir=Xt({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();const hR={provide:To,useExisting:qn(()=>L$),multi:!0};function Cw(n,t){return null==n?`${t}`:("string"==typeof t&&(t=`'${t}'`),t&&"object"==typeof t&&(t="Object"),`${n}: ${t}`.slice(0,50))}let L$=(()=>{class n extends El{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let i;if(this.value=e,Array.isArray(e)){const r=e.map(s=>this._getOptionId(s));i=(s,o)=>{s._setSelected(r.indexOf(o.toString())>-1)}}else i=(r,s)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(e){this.onChange=i=>{const r=[],s=i.selectedOptions;if(void 0!==s){const o=s;for(let c=0;c<o.length;c++){const I=this._getOptionValue(o[c].value);r.push(I)}}else{const o=i.options;for(let c=0;c<o.length;c++){const m=o[c];if(m.selected){const I=this._getOptionValue(m.value);r.push(I)}}}this.value=r,e(r)}}_registerOption(e){const i=(this._idCounter++).toString();return this._optionMap.set(i,e),i}_getOptionId(e){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i)._value,e))return i;return null}_getOptionValue(e){const i=function pR(n){return n.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i)._value:e}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=vr(n)))(i||n)}}(),n.\u0275dir=Xt({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,i){1&e&&Te("change",function(s){return i.onChange(s.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[ui([hR]),Yn]}),n})(),jr=(()=>{class n{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(Cw(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(Cw(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return n.\u0275fac=function(e){return new(e||n)(Le(_i),Le(vl),Le(L$,9))},n.\u0275dir=Xt({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),n})();function xw(n){return"number"==typeof n?n:parseInt(n,10)}function ww(n){return"number"==typeof n?n:parseFloat(n)}let Sl=(()=>{class n{constructor(){this._validator=Wh}ngOnChanges(e){if(this.inputName in e){const i=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):Wh,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275dir=Xt({type:n,features:[eo]}),n})();const mR={provide:Cr,useExisting:qn(()=>Io),multi:!0};let Io=(()=>{class n extends Sl{constructor(){super(...arguments),this.inputName="max",this.normalizeInput=e=>ww(e),this.createValidator=e=>function Nx(n){return t=>{if(Ma(t.value)||Ma(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e>n?{max:{max:n,actual:t.value}}:null}}(e)}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=vr(n)))(i||n)}}(),n.\u0275dir=Xt({type:n,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Rt("max",i._enabled?i.max:null)},inputs:{max:"max"},features:[ui([mR]),Yn]}),n})();const _R={provide:Cr,useExisting:qn(()=>So),multi:!0};let So=(()=>{class n extends Sl{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=e=>ww(e),this.createValidator=e=>function Px(n){return t=>{if(Ma(t.value)||Ma(n))return null;const e=parseFloat(t.value);return!isNaN(e)&&e<n?{min:{min:n,actual:t.value}}:null}}(e)}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=vr(n)))(i||n)}}(),n.\u0275dir=Xt({type:n,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Rt("min",i._enabled?i.min:null)},inputs:{min:"min"},features:[ui([_R]),Yn]}),n})();const $R={provide:Cr,useExisting:qn(()=>np),multi:!0};let np=(()=>{class n extends Sl{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=e=>function gR(n){return null!=n&&!1!==n&&"false"!=`${n}`}(e),this.createValidator=e=>Fx}enabled(e){return e}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=vr(n)))(i||n)}}(),n.\u0275dir=Xt({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,i){2&e&&Rt("required",i._enabled?"":null)},inputs:{required:"required"},features:[ui([$R]),Yn]}),n})();const yR={provide:Cr,useExisting:qn(()=>z$),multi:!0};let z$=(()=>{class n extends Sl{constructor(){super(...arguments),this.inputName="minlength",this.normalizeInput=e=>xw(e),this.createValidator=e=>function Bx(n){return t=>Ma(t.value)||!Ax(t.value)?null:t.value.length<n?{minlength:{requiredLength:n,actualLength:t.value.length}}:null}(e)}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=vr(n)))(i||n)}}(),n.\u0275dir=Xt({type:n,selectors:[["","minlength","","formControlName",""],["","minlength","","formControl",""],["","minlength","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Rt("minlength",i._enabled?i.minlength:null)},inputs:{minlength:"minlength"},features:[ui([yR]),Yn]}),n})();const CR={provide:Cr,useExisting:qn(()=>j$),multi:!0};let j$=(()=>{class n extends Sl{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=e=>xw(e),this.createValidator=e=>function Lx(n){return t=>Ax(t.value)&&t.value.length>n?{maxlength:{requiredLength:n,actualLength:t.value.length}}:null}(e)}}return n.\u0275fac=function(){let t;return function(i){return(t||(t=vr(n)))(i||n)}}(),n.\u0275dir=Xt({type:n,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Rt("maxlength",i._enabled?i.maxlength:null)},inputs:{maxlength:"maxlength"},features:[ui([CR]),Yn]}),n})(),wR=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ws({type:n}),n.\u0275inj=ls({imports:[[mw]]}),n})(),ER=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ws({type:n}),n.\u0275inj=ls({imports:[wR]}),n})();class Sw{}const ra="*";function xn(n,t){return{type:7,name:n,definitions:t,options:{}}}function Ft(n,t=null){return{type:4,styles:t,timings:n}}function Mw(n,t=null){return{type:2,steps:n,options:t}}function Ye(n){return{type:6,styles:n,offset:null}}function ip(n,t,e){return{type:0,name:n,styles:t,options:e}}function nn(n){return{type:5,steps:n}}function Bt(n,t,e=null){return{type:1,expr:n,animation:t,options:e}}function kw(n){Promise.resolve(null).then(n)}class Dd{constructor(t=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){kw(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(t=>t()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(t){this._position=this.totalTime?t*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class Dw{constructor(t){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;let e=0,i=0,r=0;const s=this.players.length;0==s?kw(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++e==s&&this._onFinish()}),o.onDestroy(()=>{++i==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,c)=>Math.max(o,c.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this.players.forEach(t=>t.init())}onStart(t){this._onStartFns.push(t)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(t=>t()),this._onStartFns=[])}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(t=>t.play())}pause(){this.players.forEach(t=>t.pause())}restart(){this.players.forEach(t=>t.restart())}finish(){this._onFinish(),this.players.forEach(t=>t.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(t=>t.destroy()),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}reset(){this.players.forEach(t=>t.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(t){const e=t*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,e/i.totalTime):1;i.setPosition(r)})}getPosition(){const t=this.players.reduce((e,i)=>null===e||i.totalTime>e.totalTime?i:e,null);return null!=t?t.getPosition():0}beforeDestroy(){this.players.forEach(t=>{t.beforeDestroy&&t.beforeDestroy()})}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}const Pn=!1;function Aw(n){return new Mt(3e3,Pn)}function o6(){return"undefined"!=typeof window&&void 0!==window.document}function U$(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function Pa(n){switch(n.length){case 0:return new Dd;case 1:return n[0];default:return new Dw(n)}}function Pw(n,t,e,i,r={},s={}){const o=[],c=[];let m=-1,I=null;if(i.forEach(Z=>{const fe=Z.offset,pe=fe==m,ye=pe&&I||{};Object.keys(Z).forEach(we=>{let Me=we,Oe=Z[we];if("offset"!==we)switch(Me=t.normalizePropertyName(Me,o),Oe){case"!":Oe=r[we];break;case ra:Oe=s[we];break;default:Oe=t.normalizeStyleValue(we,Me,Oe,o)}ye[Me]=Oe}),pe||c.push(ye),I=ye,m=fe}),o.length)throw function YR(n){return new Mt(3502,Pn)}();return c}function V$(n,t,e,i){switch(t){case"start":n.onStart(()=>i(e&&G$(e,"start",n)));break;case"done":n.onDone(()=>i(e&&G$(e,"done",n)));break;case"destroy":n.onDestroy(()=>i(e&&G$(e,"destroy",n)))}}function G$(n,t,e){const i=e.totalTime,s=q$(n.element,n.triggerName,n.fromState,n.toState,t||n.phaseName,null==i?n.totalTime:i,!!e.disabled),o=n._data;return null!=o&&(s._data=o),s}function q$(n,t,e,i,r="",s=0,o){return{element:n,triggerName:t,fromState:e,toState:i,phaseName:r,totalTime:s,disabled:!!o}}function _s(n,t,e){let i;return n instanceof Map?(i=n.get(t),i||n.set(t,i=e)):(i=n[t],i||(i=n[t]=e)),i}function Nw(n){const t=n.indexOf(":");return[n.substring(1,t),n.substr(t+1)]}let W$=(n,t)=>!1,Fw=(n,t,e)=>[],Ow=null;function K$(n){const t=n.parentNode||n.host;return t===Ow?null:t}(U$()||"undefined"!=typeof Element)&&(o6()?(Ow=(()=>document.documentElement)(),W$=(n,t)=>{for(;t;){if(t===n)return!0;t=K$(t)}return!1}):W$=(n,t)=>n.contains(t),Fw=(n,t,e)=>{if(e)return Array.from(n.querySelectorAll(t));const i=n.querySelector(t);return i?[i]:[]});let Ml=null,Rw=!1;function Bw(n){Ml||(Ml=function l6(){return"undefined"!=typeof document?document.body:null}()||{},Rw=!!Ml.style&&"WebkitAppearance"in Ml.style);let t=!0;return Ml.style&&!function a6(n){return"ebkit"==n.substring(1,6)}(n)&&(t=n in Ml.style,!t&&Rw&&(t="Webkit"+n.charAt(0).toUpperCase()+n.substr(1)in Ml.style)),t}const Lw=W$,zw=Fw;let jw=(()=>{class n{validateStyleProperty(e){return Bw(e)}matchesElement(e,i){return!1}containsElement(e,i){return Lw(e,i)}getParentElement(e){return K$(e)}query(e,i,r){return zw(e,i,r)}computeStyle(e,i,r){return r||""}animate(e,i,r,s,o,c=[],m){return new Dd(r,s)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=tn({token:n,factory:n.\u0275fac}),n})(),Y$=(()=>{class n{}return n.NOOP=new jw,n})();const Z$="ng-enter",sp="ng-leave",op="ng-trigger",ap=".ng-trigger",Uw="ng-animating",X$=".ng-animating";function kl(n){if("number"==typeof n)return n;const t=n.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:Q$(parseFloat(t[1]),t[2])}function Q$(n,t){return"s"===t?1e3*n:n}function lp(n,t,e){return n.hasOwnProperty("duration")?n:function d6(n,t,e){let r,s=0,o="";if("string"==typeof n){const c=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===c)return t.push(Aw()),{duration:0,delay:0,easing:""};r=Q$(parseFloat(c[1]),c[2]);const m=c[3];null!=m&&(s=Q$(parseFloat(m),c[4]));const I=c[5];I&&(o=I)}else r=n;if(!e){let c=!1,m=t.length;r<0&&(t.push(function IR(){return new Mt(3100,Pn)}()),c=!0),s<0&&(t.push(function SR(){return new Mt(3101,Pn)}()),c=!0),c&&t.splice(m,0,Aw())}return{duration:r,delay:s,easing:o}}(n,t,e)}function Jc(n,t={}){return Object.keys(n).forEach(e=>{t[e]=n[e]}),t}function Na(n,t,e={}){if(t)for(let i in n)e[i]=n[i];else Jc(n,e);return e}function Gw(n,t,e){return e?t+":"+e+";":""}function qw(n){let t="";for(let e=0;e<n.style.length;e++){const i=n.style.item(e);t+=Gw(0,i,n.style.getPropertyValue(i))}for(const e in n.style)n.style.hasOwnProperty(e)&&!e.startsWith("_")&&(t+=Gw(0,p6(e),n.style[e]));n.setAttribute("style",t)}function Mo(n,t,e){n.style&&(Object.keys(t).forEach(i=>{const r=e0(i);e&&!e.hasOwnProperty(i)&&(e[i]=n.style[r]),n.style[r]=t[i]}),U$()&&qw(n))}function Dl(n,t){n.style&&(Object.keys(t).forEach(e=>{const i=e0(e);n.style[i]=""}),U$()&&qw(n))}function Ad(n){return Array.isArray(n)?1==n.length?n[0]:Mw(n):n}const J$=new RegExp("{{\\s*(.+?)\\s*}}","g");function Ww(n){let t=[];if("string"==typeof n){let e;for(;e=J$.exec(n);)t.push(e[1]);J$.lastIndex=0}return t}function cp(n,t,e){const i=n.toString(),r=i.replace(J$,(s,o)=>{let c=t[o];return t.hasOwnProperty(o)||(e.push(function kR(n){return new Mt(3003,Pn)}()),c=""),c.toString()});return r==i?n:r}function up(n){const t=[];let e=n.next();for(;!e.done;)t.push(e.value),e=n.next();return t}const h6=/-+([a-z0-9])/g;function e0(n){return n.replace(h6,(...t)=>t[1].toUpperCase())}function p6(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function $s(n,t,e){switch(t.type){case 7:return n.visitTrigger(t,e);case 0:return n.visitState(t,e);case 1:return n.visitTransition(t,e);case 2:return n.visitSequence(t,e);case 3:return n.visitGroup(t,e);case 4:return n.visitAnimate(t,e);case 5:return n.visitKeyframes(t,e);case 6:return n.visitStyle(t,e);case 8:return n.visitReference(t,e);case 9:return n.visitAnimateChild(t,e);case 10:return n.visitAnimateRef(t,e);case 11:return n.visitQuery(t,e);case 12:return n.visitStagger(t,e);default:throw function DR(n){return new Mt(3004,Pn)}()}}function Kw(n,t){return window.getComputedStyle(n)[t]}function b6(n,t){const e=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function y6(n,t,e){if(":"==n[0]){const m=function C6(n,t){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,i)=>parseFloat(i)>parseFloat(e);case":decrement":return(e,i)=>parseFloat(i)<parseFloat(e);default:return t.push(function GR(n){return new Mt(3016,Pn)}()),"* => *"}}(n,e);if("function"==typeof m)return void t.push(m);n=m}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return e.push(function VR(n){return new Mt(3015,Pn)}()),t;const r=i[1],s=i[2],o=i[3];t.push(Yw(r,o));"<"==s[0]&&!("*"==r&&"*"==o)&&t.push(Yw(o,r))}(i,e,t)):e.push(n),e}const pp=new Set(["true","1"]),gp=new Set(["false","0"]);function Yw(n,t){const e=pp.has(n)||gp.has(n),i=pp.has(t)||gp.has(t);return(r,s)=>{let o="*"==n||n==r,c="*"==t||t==s;return!o&&e&&"boolean"==typeof r&&(o=r?pp.has(n):gp.has(n)),!c&&i&&"boolean"==typeof s&&(c=s?pp.has(t):gp.has(t)),o&&c}}const x6=new RegExp("s*:selfs*,?","g");function t0(n,t,e,i){return new w6(n).build(t,e,i)}class w6{constructor(t){this._driver=t}build(t,e,i){const r=new I6(e);this._resetContextStyleTimingState(r);const s=$s(this,Ad(t),r);return r.unsupportedCSSPropertiesFound.size&&r.unsupportedCSSPropertiesFound.keys(),s}_resetContextStyleTimingState(t){t.currentQuerySelector="",t.collectedStyles={},t.collectedStyles[""]={},t.currentTime=0}visitTrigger(t,e){let i=e.queryCount=0,r=e.depCount=0;const s=[],o=[];return"@"==t.name.charAt(0)&&e.errors.push(function PR(){return new Mt(3006,Pn)}()),t.definitions.forEach(c=>{if(this._resetContextStyleTimingState(e),0==c.type){const m=c,I=m.name;I.toString().split(/\s*,\s*/).forEach(Z=>{m.name=Z,s.push(this.visitState(m,e))}),m.name=I}else if(1==c.type){const m=this.visitTransition(c,e);i+=m.queryCount,r+=m.depCount,o.push(m)}else e.errors.push(function NR(){return new Mt(3007,Pn)}())}),{type:7,name:t.name,states:s,transitions:o,queryCount:i,depCount:r,options:null}}visitState(t,e){const i=this.visitStyle(t.styles,e),r=t.options&&t.options.params||null;if(i.containsDynamicStyles){const s=new Set,o=r||{};i.styles.forEach(c=>{if(mp(c)){const m=c;Object.keys(m).forEach(I=>{Ww(m[I]).forEach(Z=>{o.hasOwnProperty(Z)||s.add(Z)})})}}),s.size&&(up(s.values()),e.errors.push(function FR(n,t){return new Mt(3008,Pn)}()))}return{type:0,name:t.name,style:i,options:r?{params:r}:null}}visitTransition(t,e){e.queryCount=0,e.depCount=0;const i=$s(this,Ad(t.animation),e);return{type:1,matchers:b6(t.expr,e.errors),animation:i,queryCount:e.queryCount,depCount:e.depCount,options:Al(t.options)}}visitSequence(t,e){return{type:2,steps:t.steps.map(i=>$s(this,i,e)),options:Al(t.options)}}visitGroup(t,e){const i=e.currentTime;let r=0;const s=t.steps.map(o=>{e.currentTime=i;const c=$s(this,o,e);return r=Math.max(r,e.currentTime),c});return e.currentTime=r,{type:3,steps:s,options:Al(t.options)}}visitAnimate(t,e){const i=function M6(n,t){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return n0(lp(n,t).duration,0,"");const e=n;if(e.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=n0(0,0,"");return s.dynamic=!0,s.strValue=e,s}const r=lp(e,t);return n0(r.duration,r.delay,r.easing)}(t.timings,e.errors);e.currentAnimateTimings=i;let r,s=t.styles?t.styles:Ye({});if(5==s.type)r=this.visitKeyframes(s,e);else{let o=t.styles,c=!1;if(!o){c=!0;const I={};i.easing&&(I.easing=i.easing),o=Ye(I)}e.currentTime+=i.duration+i.delay;const m=this.visitStyle(o,e);m.isEmptyStep=c,r=m}return e.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(t,e){const i=this._makeStyleAst(t,e);return this._validateStyleAst(i,e),i}_makeStyleAst(t,e){const i=[];Array.isArray(t.styles)?t.styles.forEach(o=>{"string"==typeof o?o==ra?i.push(o):e.errors.push(function OR(n){return new Mt(3002,Pn)}()):i.push(o)}):i.push(t.styles);let r=!1,s=null;return i.forEach(o=>{if(mp(o)){const c=o,m=c.easing;if(m&&(s=m,delete c.easing),!r)for(let I in c)if(c[I].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:i,easing:s,offset:t.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(t,e){const i=e.currentAnimateTimings;let r=e.currentTime,s=e.currentTime;i&&s>0&&(s-=i.duration+i.delay),t.styles.forEach(o=>{"string"!=typeof o&&Object.keys(o).forEach(c=>{if(!this._driver.validateStyleProperty(c))return delete o[c],void e.unsupportedCSSPropertiesFound.add(c);const m=e.collectedStyles[e.currentQuerySelector],I=m[c];let Z=!0;I&&(s!=r&&s>=I.startTime&&r<=I.endTime&&(e.errors.push(function RR(n,t,e,i,r){return new Mt(3010,Pn)}()),Z=!1),s=I.startTime),Z&&(m[c]={startTime:s,endTime:r}),e.options&&function f6(n,t,e){const i=t.params||{},r=Ww(n);r.length&&r.forEach(s=>{i.hasOwnProperty(s)||e.push(function MR(n){return new Mt(3001,Pn)}())})}(o[c],e.options,e.errors)})})}visitKeyframes(t,e){const i={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function BR(){return new Mt(3011,Pn)}()),i;let s=0;const o=[];let c=!1,m=!1,I=0;const Z=t.steps.map(Be=>{const ke=this._makeStyleAst(Be,e);let ze=null!=ke.offset?ke.offset:function S6(n){if("string"==typeof n)return null;let t=null;if(Array.isArray(n))n.forEach(e=>{if(mp(e)&&e.hasOwnProperty("offset")){const i=e;t=parseFloat(i.offset),delete i.offset}});else if(mp(n)&&n.hasOwnProperty("offset")){const e=n;t=parseFloat(e.offset),delete e.offset}return t}(ke.styles),je=0;return null!=ze&&(s++,je=ke.offset=ze),m=m||je<0||je>1,c=c||je<I,I=je,o.push(je),ke});m&&e.errors.push(function LR(){return new Mt(3012,Pn)}()),c&&e.errors.push(function zR(){return new Mt(3200,Pn)}());const fe=t.steps.length;let pe=0;s>0&&s<fe?e.errors.push(function jR(){return new Mt(3202,Pn)}()):0==s&&(pe=1/(fe-1));const ye=fe-1,we=e.currentTime,Me=e.currentAnimateTimings,Oe=Me.duration;return Z.forEach((Be,ke)=>{const ze=pe>0?ke==ye?1:pe*ke:o[ke],je=ze*Oe;e.currentTime=we+Me.delay+je,Me.duration=je,this._validateStyleAst(Be,e),Be.offset=ze,i.styles.push(Be)}),i}visitReference(t,e){return{type:8,animation:$s(this,Ad(t.animation),e),options:Al(t.options)}}visitAnimateChild(t,e){return e.depCount++,{type:9,options:Al(t.options)}}visitAnimateRef(t,e){return{type:10,animation:this.visitReference(t.animation,e),options:Al(t.options)}}visitQuery(t,e){const i=e.currentQuerySelector,r=t.options||{};e.queryCount++,e.currentQuery=t;const[s,o]=function E6(n){const t=!!n.split(/\s*,\s*/).find(e=>":self"==e);return t&&(n=n.replace(x6,"")),n=n.replace(/@\*/g,ap).replace(/@\w+/g,e=>ap+"-"+e.substr(1)).replace(/:animating/g,X$),[n,t]}(t.selector);e.currentQuerySelector=i.length?i+" "+s:s,_s(e.collectedStyles,e.currentQuerySelector,{});const c=$s(this,Ad(t.animation),e);return e.currentQuery=null,e.currentQuerySelector=i,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:c,originalSelector:t.selector,options:Al(t.options)}}visitStagger(t,e){e.currentQuery||e.errors.push(function HR(){return new Mt(3013,Pn)}());const i="full"===t.timings?{duration:0,delay:0,easing:"full"}:lp(t.timings,e.errors,!0);return{type:12,animation:$s(this,Ad(t.animation),e),timings:i,options:null}}}class I6{constructor(t){this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function mp(n){return!Array.isArray(n)&&"object"==typeof n}function Al(n){return n?(n=Jc(n)).params&&(n.params=function T6(n){return n?Jc(n):null}(n.params)):n={},n}function n0(n,t,e){return{duration:n,delay:t,easing:e}}function r0(n,t,e,i,r,s,o=null,c=!1){return{type:1,element:n,keyframes:t,preStyleProps:e,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:c}}class _p{constructor(){this._map=new Map}get(t){return this._map.get(t)||[]}append(t,e){let i=this._map.get(t);i||this._map.set(t,i=[]),i.push(...e)}has(t){return this._map.has(t)}clear(){this._map.clear()}}const A6=new RegExp(":enter","g"),N6=new RegExp(":leave","g");function s0(n,t,e,i,r,s={},o={},c,m,I=[]){return(new F6).buildKeyframes(n,t,e,i,r,s,o,c,m,I)}class F6{buildKeyframes(t,e,i,r,s,o,c,m,I,Z=[]){I=I||new _p;const fe=new o0(t,e,I,r,s,Z,[]);fe.options=m,fe.currentTimeline.setStyles([o],null,fe.errors,m),$s(this,i,fe);const pe=fe.timelines.filter(ye=>ye.containsAnimation());if(Object.keys(c).length){let ye;for(let we=pe.length-1;we>=0;we--){const Me=pe[we];if(Me.element===e){ye=Me;break}}ye&&!ye.allowOnlyTimelineStyles()&&ye.setStyles([c],null,fe.errors,m)}return pe.length?pe.map(ye=>ye.buildKeyframes()):[r0(e,[],[],[],0,0,"",!1)]}visitTrigger(t,e){}visitState(t,e){}visitTransition(t,e){}visitAnimateChild(t,e){const i=e.subInstructions.get(e.element);if(i){const r=e.createSubContext(t.options),s=e.currentTimeline.currentTime,o=this._visitSubInstructions(i,r,r.options);s!=o&&e.transformIntoNewTimeline(o)}e.previousNode=t}visitAnimateRef(t,e){const i=e.createSubContext(t.options);i.transformIntoNewTimeline(),this.visitReference(t.animation,i),e.transformIntoNewTimeline(i.currentTimeline.currentTime),e.previousNode=t}_visitSubInstructions(t,e,i){let s=e.currentTimeline.currentTime;const o=null!=i.duration?kl(i.duration):null,c=null!=i.delay?kl(i.delay):null;return 0!==o&&t.forEach(m=>{const I=e.appendInstructionToTimeline(m,o,c);s=Math.max(s,I.duration+I.delay)}),s}visitReference(t,e){e.updateOptions(t.options,!0),$s(this,t.animation,e),e.previousNode=t}visitSequence(t,e){const i=e.subContextCount;let r=e;const s=t.options;if(s&&(s.params||s.delay)&&(r=e.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=$p);const o=kl(s.delay);r.delayNextStep(o)}t.steps.length&&(t.steps.forEach(o=>$s(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),e.previousNode=t}visitGroup(t,e){const i=[];let r=e.currentTimeline.currentTime;const s=t.options&&t.options.delay?kl(t.options.delay):0;t.steps.forEach(o=>{const c=e.createSubContext(t.options);s&&c.delayNextStep(s),$s(this,o,c),r=Math.max(r,c.currentTimeline.currentTime),i.push(c.currentTimeline)}),i.forEach(o=>e.currentTimeline.mergeTimelineCollectedStyles(o)),e.transformIntoNewTimeline(r),e.previousNode=t}_visitTiming(t,e){if(t.dynamic){const i=t.strValue;return lp(e.params?cp(i,e.params,e.errors):i,e.errors)}return{duration:t.duration,delay:t.delay,easing:t.easing}}visitAnimate(t,e){const i=e.currentAnimateTimings=this._visitTiming(t.timings,e),r=e.currentTimeline;i.delay&&(e.incrementTime(i.delay),r.snapshotCurrentStyles());const s=t.style;5==s.type?this.visitKeyframes(s,e):(e.incrementTime(i.duration),this.visitStyle(s,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=t}visitStyle(t,e){const i=e.currentTimeline,r=e.currentAnimateTimings;!r&&i.getCurrentStyleProperties().length&&i.forwardFrame();const s=r&&r.easing||t.easing;t.isEmptyStep?i.applyEmptyStep(s):i.setStyles(t.styles,s,e.errors,e.options),e.previousNode=t}visitKeyframes(t,e){const i=e.currentAnimateTimings,r=e.currentTimeline.duration,s=i.duration,c=e.createSubContext().currentTimeline;c.easing=i.easing,t.styles.forEach(m=>{c.forwardTime((m.offset||0)*s),c.setStyles(m.styles,m.easing,e.errors,e.options),c.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(c),e.transformIntoNewTimeline(r+s),e.previousNode=t}visitQuery(t,e){const i=e.currentTimeline.currentTime,r=t.options||{},s=r.delay?kl(r.delay):0;s&&(6===e.previousNode.type||0==i&&e.currentTimeline.getCurrentStyleProperties().length)&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=$p);let o=i;const c=e.invokeQuery(t.selector,t.originalSelector,t.limit,t.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=c.length;let m=null;c.forEach((I,Z)=>{e.currentQueryIndex=Z;const fe=e.createSubContext(t.options,I);s&&fe.delayNextStep(s),I===e.element&&(m=fe.currentTimeline),$s(this,t.animation,fe),fe.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,fe.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(o),m&&(e.currentTimeline.mergeTimelineCollectedStyles(m),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=t}visitStagger(t,e){const i=e.parentContext,r=e.currentTimeline,s=t.timings,o=Math.abs(s.duration),c=o*(e.currentQueryTotal-1);let m=o*e.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":m=c-m;break;case"full":m=i.currentStaggerTime}const Z=e.currentTimeline;m&&Z.delayNextStep(m);const fe=Z.currentTime;$s(this,t.animation,e),e.previousNode=t,i.currentStaggerTime=r.currentTime-fe+(r.startTime-i.currentTimeline.startTime)}}const $p={};class o0{constructor(t,e,i,r,s,o,c,m){this._driver=t,this.element=e,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=c,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=$p,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=m||new vp(this._driver,e,0),c.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(t,e){if(!t)return;const i=t;let r=this.options;null!=i.duration&&(r.duration=kl(i.duration)),null!=i.delay&&(r.delay=kl(i.delay));const s=i.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(c=>{(!e||!o.hasOwnProperty(c))&&(o[c]=cp(s[c],o,this.errors))})}}_copyOptions(){const t={};if(this.options){const e=this.options.params;if(e){const i=t.params={};Object.keys(e).forEach(r=>{i[r]=e[r]})}}return t}createSubContext(t=null,e,i){const r=e||this.element,s=new o0(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(t),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(t){return this.previousNode=$p,this.currentTimeline=this.currentTimeline.fork(this.element,t),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(t,e,i){const r={duration:null!=e?e:t.duration,delay:this.currentTimeline.currentTime+(null!=i?i:0)+t.delay,easing:""},s=new O6(this._driver,t.element,t.keyframes,t.preStyleProps,t.postStyleProps,r,t.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(t){this.currentTimeline.forwardTime(this.currentTimeline.duration+t)}delayNextStep(t){t>0&&this.currentTimeline.delayNextStep(t)}invokeQuery(t,e,i,r,s,o){let c=[];if(r&&c.push(this.element),t.length>0){t=(t=t.replace(A6,"."+this._enterClassName)).replace(N6,"."+this._leaveClassName);let I=this._driver.query(this.element,t,1!=i);0!==i&&(I=i<0?I.slice(I.length+i,I.length):I.slice(0,i)),c.push(...I)}return!s&&0==c.length&&o.push(function UR(n){return new Mt(3014,Pn)}()),c}}class vp{constructor(t,e,i,r){this._driver=t,this.element=e,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(t){const e=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||e?(this.forwardTime(this.currentTime+t),e&&this.snapshotCurrentStyles()):this.startTime+=t}fork(t,e){return this.applyStylesToKeyframe(),new vp(this._driver,t,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(t){this.applyStylesToKeyframe(),this.duration=t,this._loadKeyframe()}_updateStyle(t,e){this._localTimelineStyles[t]=e,this._globalTimelineStyles[t]=e,this._styleSummary[t]={time:this.currentTime,value:e}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(t){t&&(this._previousKeyframe.easing=t),Object.keys(this._globalTimelineStyles).forEach(e=>{this._backFill[e]=this._globalTimelineStyles[e]||ra,this._currentKeyframe[e]=ra}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(t,e,i,r){e&&(this._previousKeyframe.easing=e);const s=r&&r.params||{},o=function R6(n,t){const e={};let i;return n.forEach(r=>{"*"===r?(i=i||Object.keys(t),i.forEach(s=>{e[s]=ra})):Na(r,!1,e)}),e}(t,this._globalTimelineStyles);Object.keys(o).forEach(c=>{const m=cp(o[c],s,i);this._pendingStyles[c]=m,this._localTimelineStyles.hasOwnProperty(c)||(this._backFill[c]=this._globalTimelineStyles.hasOwnProperty(c)?this._globalTimelineStyles[c]:ra),this._updateStyle(c,m)})}applyStylesToKeyframe(){const t=this._pendingStyles,e=Object.keys(t);0!=e.length&&(this._pendingStyles={},e.forEach(i=>{this._currentKeyframe[i]=t[i]}),Object.keys(this._localTimelineStyles).forEach(i=>{this._currentKeyframe.hasOwnProperty(i)||(this._currentKeyframe[i]=this._localTimelineStyles[i])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(t=>{const e=this._localTimelineStyles[t];this._pendingStyles[t]=e,this._updateStyle(t,e)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const t=[];for(let e in this._currentKeyframe)t.push(e);return t}mergeTimelineCollectedStyles(t){Object.keys(t._styleSummary).forEach(e=>{const i=this._styleSummary[e],r=t._styleSummary[e];(!i||r.time>i.time)&&this._updateStyle(e,r.value)})}buildKeyframes(){this.applyStylesToKeyframe();const t=new Set,e=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((c,m)=>{const I=Na(c,!0);Object.keys(I).forEach(Z=>{const fe=I[Z];"!"==fe?t.add(Z):fe==ra&&e.add(Z)}),i||(I.offset=m/this.duration),r.push(I)});const s=t.size?up(t.values()):[],o=e.size?up(e.values()):[];if(i){const c=r[0],m=Jc(c);c.offset=0,m.offset=1,r=[c,m]}return r0(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}}class O6 extends vp{constructor(t,e,i,r,s,o,c=!1){super(t,e,o.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=c,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let t=this.keyframes,{delay:e,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const s=[],o=i+e,c=e/o,m=Na(t[0],!1);m.offset=0,s.push(m);const I=Na(t[0],!1);I.offset=Qw(c),s.push(I);const Z=t.length-1;for(let fe=1;fe<=Z;fe++){let pe=Na(t[fe],!1);pe.offset=Qw((e+pe.offset*i)/o),s.push(pe)}i=o,e=0,r="",t=s}return r0(this.element,t,this.preStyleProps,this.postStyleProps,i,e,r,!0)}}function Qw(n,t=3){const e=Math.pow(10,t-1);return Math.round(n*e)/e}class a0{}class B6 extends a0{normalizePropertyName(t,e){return e0(t)}normalizeStyleValue(t,e,i,r){let s="";const o=i.toString().trim();if(L6[e]&&0!==i&&"0"!==i)if("number"==typeof i)s="px";else{const c=i.match(/^[+-]?[\d\.]+([a-z]*)$/);c&&0==c[1].length&&r.push(function AR(n,t){return new Mt(3005,Pn)}())}return o+s}}const L6=(()=>function z6(n){const t={};return n.forEach(e=>t[e]=!0),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function Jw(n,t,e,i,r,s,o,c,m,I,Z,fe,pe){return{type:0,element:n,triggerName:t,isRemovalTransition:r,fromState:e,fromStyles:s,toState:i,toStyles:o,timelines:c,queriedElements:m,preStyleProps:I,postStyleProps:Z,totalTime:fe,errors:pe}}const l0={};class eE{constructor(t,e,i){this._triggerName=t,this.ast=e,this._stateStyles=i}match(t,e,i,r){return function j6(n,t,e,i,r){return n.some(s=>s(t,e,i,r))}(this.ast.matchers,t,e,i,r)}buildStyles(t,e,i){const r=this._stateStyles["*"],s=this._stateStyles[t],o=r?r.buildStyles(e,i):{};return s?s.buildStyles(e,i):o}build(t,e,i,r,s,o,c,m,I,Z){const fe=[],pe=this.ast.options&&this.ast.options.params||l0,we=this.buildStyles(i,c&&c.params||l0,fe),Me=m&&m.params||l0,Oe=this.buildStyles(r,Me,fe),Be=new Set,ke=new Map,ze=new Map,je="void"===r,st={params:Object.assign(Object.assign({},pe),Me)},ot=Z?[]:s0(t,e,this.ast.animation,s,o,we,Oe,st,I,fe);let tt=0;if(ot.forEach(Je=>{tt=Math.max(Je.duration+Je.delay,tt)}),fe.length)return Jw(e,this._triggerName,i,r,je,we,Oe,[],[],ke,ze,tt,fe);ot.forEach(Je=>{const at=Je.element,ft=_s(ke,at,{});Je.preStyleProps.forEach(zt=>ft[zt]=!0);const Ut=_s(ze,at,{});Je.postStyleProps.forEach(zt=>Ut[zt]=!0),at!==e&&Be.add(at)});const _t=up(Be.values());return Jw(e,this._triggerName,i,r,je,we,Oe,ot,_t,ke,ze,tt)}}class H6{constructor(t,e,i){this.styles=t,this.defaultParams=e,this.normalizer=i}buildStyles(t,e){const i={},r=Jc(this.defaultParams);return Object.keys(t).forEach(s=>{const o=t[s];null!=o&&(r[s]=o)}),this.styles.styles.forEach(s=>{if("string"!=typeof s){const o=s;Object.keys(o).forEach(c=>{let m=o[c];m.length>1&&(m=cp(m,r,e));const I=this.normalizer.normalizePropertyName(c,e);m=this.normalizer.normalizeStyleValue(c,I,m,e),i[I]=m})}}),i}}class V6{constructor(t,e,i){this.name=t,this.ast=e,this._normalizer=i,this.transitionFactories=[],this.states={},e.states.forEach(r=>{this.states[r.name]=new H6(r.style,r.options&&r.options.params||{},i)}),tE(this.states,"true","1"),tE(this.states,"false","0"),e.transitions.forEach(r=>{this.transitionFactories.push(new eE(t,r,this.states))}),this.fallbackTransition=function G6(n,t,e){return new eE(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,c)=>!0],options:null,queryCount:0,depCount:0},t)}(t,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(t,e,i,r){return this.transitionFactories.find(o=>o.match(t,e,i,r))||null}matchStyles(t,e,i){return this.fallbackTransition.buildStyles(t,e,i)}}function tE(n,t,e){n.hasOwnProperty(t)?n.hasOwnProperty(e)||(n[e]=n[t]):n.hasOwnProperty(e)&&(n[t]=n[e])}const q6=new _p;class W6{constructor(t,e,i){this.bodyNode=t,this._driver=e,this._normalizer=i,this._animations={},this._playersById={},this.players=[]}register(t,e){const i=[],s=t0(this._driver,e,i,[]);if(i.length)throw function ZR(n){return new Mt(3503,Pn)}();this._animations[t]=s}_buildPlayer(t,e,i){const r=t.element,s=Pw(0,this._normalizer,0,t.keyframes,e,i);return this._driver.animate(r,s,t.duration,t.delay,t.easing,[],!0)}create(t,e,i={}){const r=[],s=this._animations[t];let o;const c=new Map;if(s?(o=s0(this._driver,e,s,Z$,sp,{},{},i,q6,r),o.forEach(Z=>{const fe=_s(c,Z.element,{});Z.postStyleProps.forEach(pe=>fe[pe]=null)})):(r.push(function XR(){return new Mt(3300,Pn)}()),o=[]),r.length)throw function QR(n){return new Mt(3504,Pn)}();c.forEach((Z,fe)=>{Object.keys(Z).forEach(pe=>{Z[pe]=this._driver.computeStyle(fe,pe,ra)})});const I=Pa(o.map(Z=>{const fe=c.get(Z.element);return this._buildPlayer(Z,{},fe)}));return this._playersById[t]=I,I.onDestroy(()=>this.destroy(t)),this.players.push(I),I}destroy(t){const e=this._getPlayer(t);e.destroy(),delete this._playersById[t];const i=this.players.indexOf(e);i>=0&&this.players.splice(i,1)}_getPlayer(t){const e=this._playersById[t];if(!e)throw function JR(n){return new Mt(3301,Pn)}();return e}listen(t,e,i,r){const s=q$(e,"","","");return V$(this._getPlayer(t),i,s,r),()=>{}}command(t,e,i,r){if("register"==i)return void this.register(t,r[0]);if("create"==i)return void this.create(t,e,r[0]||{});const s=this._getPlayer(t);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(t)}}}const nE="ng-animate-queued",c0="ng-animate-disabled",Q6=[],iE={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},J6={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Ps="__ng_removed";class u0{constructor(t,e=""){this.namespaceId=e;const i=t&&t.hasOwnProperty("value");if(this.value=function i8(n){return null!=n?n:null}(i?t.value:t),i){const s=Jc(t);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(t){const e=t.params;if(e){const i=this.options.params;Object.keys(e).forEach(r=>{null==i[r]&&(i[r]=e[r])})}}}const Pd="void",d0=new u0(Pd);class e8{constructor(t,e,i){this.id=t,this.hostElement=e,this._engine=i,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,Ns(e,this._hostClassName)}listen(t,e,i,r){if(!this._triggers.hasOwnProperty(e))throw function e6(n,t){return new Mt(3302,Pn)}();if(null==i||0==i.length)throw function t6(n){return new Mt(3303,Pn)}();if(!function r8(n){return"start"==n||"done"==n}(i))throw function n6(n,t){return new Mt(3400,Pn)}();const s=_s(this._elementListeners,t,[]),o={name:e,phase:i,callback:r};s.push(o);const c=_s(this._engine.statesByElement,t,{});return c.hasOwnProperty(e)||(Ns(t,op),Ns(t,op+"-"+e),c[e]=d0),()=>{this._engine.afterFlush(()=>{const m=s.indexOf(o);m>=0&&s.splice(m,1),this._triggers[e]||delete c[e]})}}register(t,e){return!this._triggers[t]&&(this._triggers[t]=e,!0)}_getTrigger(t){const e=this._triggers[t];if(!e)throw function i6(n){return new Mt(3401,Pn)}();return e}trigger(t,e,i,r=!0){const s=this._getTrigger(e),o=new f0(this.id,e,t);let c=this._engine.statesByElement.get(t);c||(Ns(t,op),Ns(t,op+"-"+e),this._engine.statesByElement.set(t,c={}));let m=c[e];const I=new u0(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&m&&I.absorbOptions(m.options),c[e]=I,m||(m=d0),I.value!==Pd&&m.value===I.value){if(!function a8(n,t){const e=Object.keys(n),i=Object.keys(t);if(e.length!=i.length)return!1;for(let r=0;r<e.length;r++){const s=e[r];if(!t.hasOwnProperty(s)||n[s]!==t[s])return!1}return!0}(m.params,I.params)){const Me=[],Oe=s.matchStyles(m.value,m.params,Me),Be=s.matchStyles(I.value,I.params,Me);Me.length?this._engine.reportError(Me):this._engine.afterFlush(()=>{Dl(t,Oe),Mo(t,Be)})}return}const pe=_s(this._engine.playersByElement,t,[]);pe.forEach(Me=>{Me.namespaceId==this.id&&Me.triggerName==e&&Me.queued&&Me.destroy()});let ye=s.matchTransition(m.value,I.value,t,I.params),we=!1;if(!ye){if(!r)return;ye=s.fallbackTransition,we=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:e,transition:ye,fromState:m,toState:I,player:o,isFallbackTransition:we}),we||(Ns(t,nE),o.onStart(()=>{eu(t,nE)})),o.onDone(()=>{let Me=this.players.indexOf(o);Me>=0&&this.players.splice(Me,1);const Oe=this._engine.playersByElement.get(t);if(Oe){let Be=Oe.indexOf(o);Be>=0&&Oe.splice(Be,1)}}),this.players.push(o),pe.push(o),o}deregister(t){delete this._triggers[t],this._engine.statesByElement.forEach((e,i)=>{delete e[t]}),this._elementListeners.forEach((e,i)=>{this._elementListeners.set(i,e.filter(r=>r.name!=t))})}clearElementCache(t){this._engine.statesByElement.delete(t),this._elementListeners.delete(t);const e=this._engine.playersByElement.get(t);e&&(e.forEach(i=>i.destroy()),this._engine.playersByElement.delete(t))}_signalRemovalForInnerTriggers(t,e){const i=this._engine.driver.query(t,ap,!0);i.forEach(r=>{if(r[Ps])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,e,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(t,e,i,r){const s=this._engine.statesByElement.get(t),o=new Map;if(s){const c=[];if(Object.keys(s).forEach(m=>{if(o.set(m,s[m].value),this._triggers[m]){const I=this.trigger(t,m,Pd,r);I&&c.push(I)}}),c.length)return this._engine.markElementAsRemoved(this.id,t,!0,e,o),i&&Pa(c).onDone(()=>this._engine.processLeaveNode(t)),!0}return!1}prepareLeaveAnimationListeners(t){const e=this._elementListeners.get(t),i=this._engine.statesByElement.get(t);if(e&&i){const r=new Set;e.forEach(s=>{const o=s.name;if(r.has(o))return;r.add(o);const m=this._triggers[o].fallbackTransition,I=i[o]||d0,Z=new u0(Pd),fe=new f0(this.id,o,t);this._engine.totalQueuedPlayers++,this._queue.push({element:t,triggerName:o,transition:m,fromState:I,toState:Z,player:fe,isFallbackTransition:!0})})}}removeNode(t,e){const i=this._engine;if(t.childElementCount&&this._signalRemovalForInnerTriggers(t,e),this.triggerLeaveAnimation(t,e,!0))return;let r=!1;if(i.totalAnimations){const s=i.players.length?i.playersByQueriedElement.get(t):[];if(s&&s.length)r=!0;else{let o=t;for(;o=o.parentNode;)if(i.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(t),r)i.markElementAsRemoved(this.id,t,!1,e);else{const s=t[Ps];(!s||s===iE)&&(i.afterFlush(()=>this.clearElementCache(t)),i.destroyInnerAnimations(t),i._onRemovalComplete(t,e))}}insertNode(t,e){Ns(t,this._hostClassName)}drainQueuedTransitions(t){const e=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const s=i.element,o=this._elementListeners.get(s);o&&o.forEach(c=>{if(c.name==i.triggerName){const m=q$(s,i.triggerName,i.fromState.value,i.toState.value);m._data=t,V$(i.player,c.phase,m,c.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(i)}),this._queue=[],e.sort((i,r)=>{const s=i.transition.ast.depCount,o=r.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(t){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,t)}elementContainsData(t){let e=!1;return this._elementListeners.has(t)&&(e=!0),e=!!this._queue.find(i=>i.element===t)||e,e}}class t8{constructor(t,e,i){this.bodyNode=t,this.driver=e,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}_onRemovalComplete(t,e){this.onRemovalComplete(t,e)}get queuedPlayers(){const t=[];return this._namespaceList.forEach(e=>{e.players.forEach(i=>{i.queued&&t.push(i)})}),t}createNamespace(t,e){const i=new e8(t,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(i,e):(this.newHostElements.set(e,i),this.collectEnterElement(e)),this._namespaceLookup[t]=i}_balanceNamespaceList(t,e){const i=this._namespaceList,r=this.namespacesByHostElement,s=i.length-1;if(s>=0){let o=!1;if(void 0!==this.driver.getParentElement){let c=this.driver.getParentElement(e);for(;c;){const m=r.get(c);if(m){const I=i.indexOf(m);i.splice(I+1,0,t),o=!0;break}c=this.driver.getParentElement(c)}}else for(let c=s;c>=0;c--)if(this.driver.containsElement(i[c].hostElement,e)){i.splice(c+1,0,t),o=!0;break}o||i.unshift(t)}else i.push(t);return r.set(e,t),t}register(t,e){let i=this._namespaceLookup[t];return i||(i=this.createNamespace(t,e)),i}registerTrigger(t,e,i){let r=this._namespaceLookup[t];r&&r.register(e,i)&&this.totalAnimations++}destroy(t,e){if(!t)return;const i=this._fetchNamespace(t);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[t];const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>i.destroy(e))}_fetchNamespace(t){return this._namespaceLookup[t]}fetchNamespacesByElement(t){const e=new Set,i=this.statesByElement.get(t);if(i){const r=Object.keys(i);for(let s=0;s<r.length;s++){const o=i[r[s]].namespaceId;if(o){const c=this._fetchNamespace(o);c&&e.add(c)}}}return e}trigger(t,e,i,r){if(bp(e)){const s=this._fetchNamespace(t);if(s)return s.trigger(e,i,r),!0}return!1}insertNode(t,e,i,r){if(!bp(e))return;const s=e[Ps];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(e);o>=0&&this.collectedLeaveElements.splice(o,1)}if(t){const o=this._fetchNamespace(t);o&&o.insertNode(e,i)}r&&this.collectEnterElement(e)}collectEnterElement(t){this.collectedEnterElements.push(t)}markElementAsDisabled(t,e){e?this.disabledNodes.has(t)||(this.disabledNodes.add(t),Ns(t,c0)):this.disabledNodes.has(t)&&(this.disabledNodes.delete(t),eu(t,c0))}removeNode(t,e,i,r){if(bp(e)){const s=t?this._fetchNamespace(t):null;if(s?s.removeNode(e,r):this.markElementAsRemoved(t,e,!1,r),i){const o=this.namespacesByHostElement.get(e);o&&o.id!==t&&o.removeNode(e,r)}}else this._onRemovalComplete(e,r)}markElementAsRemoved(t,e,i,r,s){this.collectedLeaveElements.push(e),e[Ps]={namespaceId:t,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(t,e,i,r,s){return bp(e)?this._fetchNamespace(t).listen(e,i,r,s):()=>{}}_buildInstruction(t,e,i,r,s){return t.transition.build(this.driver,t.element,t.fromState.value,t.toState.value,i,r,t.fromState.options,t.toState.options,e,s)}destroyInnerAnimations(t){let e=this.driver.query(t,ap,!0);e.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(t,X$,!0),e.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(t){const e=this.playersByElement.get(t);e&&e.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(t){const e=this.playersByQueriedElement.get(t);e&&e.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(t=>{if(this.players.length)return Pa(this.players).onDone(()=>t());t()})}processLeaveNode(t){var e;const i=t[Ps];if(i&&i.setForRemoval){if(t[Ps]=iE,i.namespaceId){this.destroyInnerAnimations(t);const r=this._fetchNamespace(i.namespaceId);r&&r.clearElementCache(t)}this._onRemovalComplete(t,i.setForRemoval)}(null===(e=t.classList)||void 0===e?void 0:e.contains(c0))&&this.markElementAsDisabled(t,!1),this.driver.query(t,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(t=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)Ns(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{e=this._flushAnimations(i,t)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],e.length?Pa(e).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(t){throw function r6(n){return new Mt(3402,Pn)}()}_flushAnimations(t,e){const i=new _p,r=[],s=new Map,o=[],c=new Map,m=new Map,I=new Map,Z=new Set;this.disabledNodes.forEach(bt=>{Z.add(bt);const wt=this.driver.query(bt,".ng-animate-queued",!0);for(let Et=0;Et<wt.length;Et++)Z.add(wt[Et])});const fe=this.bodyNode,pe=Array.from(this.statesByElement.keys()),ye=oE(pe,this.collectedEnterElements),we=new Map;let Me=0;ye.forEach((bt,wt)=>{const Et=Z$+Me++;we.set(wt,Et),bt.forEach(Pt=>Ns(Pt,Et))});const Oe=[],Be=new Set,ke=new Set;for(let bt=0;bt<this.collectedLeaveElements.length;bt++){const wt=this.collectedLeaveElements[bt],Et=wt[Ps];Et&&Et.setForRemoval&&(Oe.push(wt),Be.add(wt),Et.hasAnimation?this.driver.query(wt,".ng-star-inserted",!0).forEach(Pt=>Be.add(Pt)):ke.add(wt))}const ze=new Map,je=oE(pe,Array.from(Be));je.forEach((bt,wt)=>{const Et=sp+Me++;ze.set(wt,Et),bt.forEach(Pt=>Ns(Pt,Et))}),t.push(()=>{ye.forEach((bt,wt)=>{const Et=we.get(wt);bt.forEach(Pt=>eu(Pt,Et))}),je.forEach((bt,wt)=>{const Et=ze.get(wt);bt.forEach(Pt=>eu(Pt,Et))}),Oe.forEach(bt=>{this.processLeaveNode(bt)})});const st=[],ot=[];for(let bt=this._namespaceList.length-1;bt>=0;bt--)this._namespaceList[bt].drainQueuedTransitions(e).forEach(Et=>{const Pt=Et.player,mn=Et.element;if(st.push(Pt),this.collectedEnterElements.length){const Ei=mn[Ps];if(Ei&&Ei.setForMove){if(Ei.previousTriggersValues&&Ei.previousTriggersValues.has(Et.triggerName)){const mo=Ei.previousTriggersValues.get(Et.triggerName),Cs=this.statesByElement.get(Et.element);Cs&&Cs[Et.triggerName]&&(Cs[Et.triggerName].value=mo)}return void Pt.destroy()}}const Rn=!fe||!this.driver.containsElement(fe,mn),Hn=ze.get(mn),mi=we.get(mn),wn=this._buildInstruction(Et,i,mi,Hn,Rn);if(wn.errors&&wn.errors.length)return void ot.push(wn);if(Rn)return Pt.onStart(()=>Dl(mn,wn.fromStyles)),Pt.onDestroy(()=>Mo(mn,wn.toStyles)),void r.push(Pt);if(Et.isFallbackTransition)return Pt.onStart(()=>Dl(mn,wn.fromStyles)),Pt.onDestroy(()=>Mo(mn,wn.toStyles)),void r.push(Pt);const pt=[];wn.timelines.forEach(Ei=>{Ei.stretchStartingKeyframe=!0,this.disabledNodes.has(Ei.element)||pt.push(Ei)}),wn.timelines=pt,i.append(mn,wn.timelines),o.push({instruction:wn,player:Pt,element:mn}),wn.queriedElements.forEach(Ei=>_s(c,Ei,[]).push(Pt)),wn.preStyleProps.forEach((Ei,mo)=>{const Cs=Object.keys(Ei);if(Cs.length){let Ws=m.get(mo);Ws||m.set(mo,Ws=new Set),Cs.forEach(rl=>Ws.add(rl))}}),wn.postStyleProps.forEach((Ei,mo)=>{const Cs=Object.keys(Ei);let Ws=I.get(mo);Ws||I.set(mo,Ws=new Set),Cs.forEach(rl=>Ws.add(rl))})});if(ot.length){const bt=[];ot.forEach(wt=>{bt.push(function s6(n,t){return new Mt(3505,Pn)}())}),st.forEach(wt=>wt.destroy()),this.reportError(bt)}const tt=new Map,_t=new Map;o.forEach(bt=>{const wt=bt.element;i.has(wt)&&(_t.set(wt,wt),this._beforeAnimationBuild(bt.player.namespaceId,bt.instruction,tt))}),r.forEach(bt=>{const wt=bt.element;this._getPreviousPlayers(wt,!1,bt.namespaceId,bt.triggerName,null).forEach(Pt=>{_s(tt,wt,[]).push(Pt),Pt.destroy()})});const Je=Oe.filter(bt=>lE(bt,m,I)),at=new Map;sE(at,this.driver,ke,I,ra).forEach(bt=>{lE(bt,m,I)&&Je.push(bt)});const Ut=new Map;ye.forEach((bt,wt)=>{sE(Ut,this.driver,new Set(bt),m,"!")}),Je.forEach(bt=>{const wt=at.get(bt),Et=Ut.get(bt);at.set(bt,Object.assign(Object.assign({},wt),Et))});const zt=[],fn=[],Nn={};o.forEach(bt=>{const{element:wt,player:Et,instruction:Pt}=bt;if(i.has(wt)){if(Z.has(wt))return Et.onDestroy(()=>Mo(wt,Pt.toStyles)),Et.disabled=!0,Et.overrideTotalTime(Pt.totalTime),void r.push(Et);let mn=Nn;if(_t.size>1){let Hn=wt;const mi=[];for(;Hn=Hn.parentNode;){const wn=_t.get(Hn);if(wn){mn=wn;break}mi.push(Hn)}mi.forEach(wn=>_t.set(wn,mn))}const Rn=this._buildAnimation(Et.namespaceId,Pt,tt,s,Ut,at);if(Et.setRealPlayer(Rn),mn===Nn)zt.push(Et);else{const Hn=this.playersByElement.get(mn);Hn&&Hn.length&&(Et.parentPlayer=Pa(Hn)),r.push(Et)}}else Dl(wt,Pt.fromStyles),Et.onDestroy(()=>Mo(wt,Pt.toStyles)),fn.push(Et),Z.has(wt)&&r.push(Et)}),fn.forEach(bt=>{const wt=s.get(bt.element);if(wt&&wt.length){const Et=Pa(wt);bt.setRealPlayer(Et)}}),r.forEach(bt=>{bt.parentPlayer?bt.syncPlayerEvents(bt.parentPlayer):bt.destroy()});for(let bt=0;bt<Oe.length;bt++){const wt=Oe[bt],Et=wt[Ps];if(eu(wt,sp),Et&&Et.hasAnimation)continue;let Pt=[];if(c.size){let Rn=c.get(wt);Rn&&Rn.length&&Pt.push(...Rn);let Hn=this.driver.query(wt,X$,!0);for(let mi=0;mi<Hn.length;mi++){let wn=c.get(Hn[mi]);wn&&wn.length&&Pt.push(...wn)}}const mn=Pt.filter(Rn=>!Rn.destroyed);mn.length?s8(this,wt,mn):this.processLeaveNode(wt)}return Oe.length=0,zt.forEach(bt=>{this.players.push(bt),bt.onDone(()=>{bt.destroy();const wt=this.players.indexOf(bt);this.players.splice(wt,1)}),bt.play()}),zt}elementContainsData(t,e){let i=!1;const r=e[Ps];return r&&r.setForRemoval&&(i=!0),this.playersByElement.has(e)&&(i=!0),this.playersByQueriedElement.has(e)&&(i=!0),this.statesByElement.has(e)&&(i=!0),this._fetchNamespace(t).elementContainsData(e)||i}afterFlush(t){this._flushFns.push(t)}afterFlushAnimationsDone(t){this._whenQuietFns.push(t)}_getPreviousPlayers(t,e,i,r,s){let o=[];if(e){const c=this.playersByQueriedElement.get(t);c&&(o=c)}else{const c=this.playersByElement.get(t);if(c){const m=!s||s==Pd;c.forEach(I=>{I.queued||!m&&I.triggerName!=r||o.push(I)})}}return(i||r)&&(o=o.filter(c=>!(i&&i!=c.namespaceId||r&&r!=c.triggerName))),o}_beforeAnimationBuild(t,e,i){const s=e.element,o=e.isRemovalTransition?void 0:t,c=e.isRemovalTransition?void 0:e.triggerName;for(const m of e.timelines){const I=m.element,Z=I!==s,fe=_s(i,I,[]);this._getPreviousPlayers(I,Z,o,c,e.toState).forEach(ye=>{const we=ye.getRealPlayer();we.beforeDestroy&&we.beforeDestroy(),ye.destroy(),fe.push(ye)})}Dl(s,e.fromStyles)}_buildAnimation(t,e,i,r,s,o){const c=e.triggerName,m=e.element,I=[],Z=new Set,fe=new Set,pe=e.timelines.map(we=>{const Me=we.element;Z.add(Me);const Oe=Me[Ps];if(Oe&&Oe.removedBeforeQueried)return new Dd(we.duration,we.delay);const Be=Me!==m,ke=function o8(n){const t=[];return aE(n,t),t}((i.get(Me)||Q6).map(tt=>tt.getRealPlayer())).filter(tt=>!!tt.element&&tt.element===Me),ze=s.get(Me),je=o.get(Me),st=Pw(0,this._normalizer,0,we.keyframes,ze,je),ot=this._buildPlayer(we,st,ke);if(we.subTimeline&&r&&fe.add(Me),Be){const tt=new f0(t,c,Me);tt.setRealPlayer(ot),I.push(tt)}return ot});I.forEach(we=>{_s(this.playersByQueriedElement,we.element,[]).push(we),we.onDone(()=>function n8(n,t,e){let i;if(n instanceof Map){if(i=n.get(t),i){if(i.length){const r=i.indexOf(e);i.splice(r,1)}0==i.length&&n.delete(t)}}else if(i=n[t],i){if(i.length){const r=i.indexOf(e);i.splice(r,1)}0==i.length&&delete n[t]}return i}(this.playersByQueriedElement,we.element,we))}),Z.forEach(we=>Ns(we,Uw));const ye=Pa(pe);return ye.onDestroy(()=>{Z.forEach(we=>eu(we,Uw)),Mo(m,e.toStyles)}),fe.forEach(we=>{_s(r,we,[]).push(ye)}),ye}_buildPlayer(t,e,i){return e.length>0?this.driver.animate(t.element,e,t.duration,t.delay,t.easing,i):new Dd(t.duration,t.delay)}}class f0{constructor(t,e,i){this.namespaceId=t,this.triggerName=e,this.element=i,this._player=new Dd,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(t){this._containsRealPlayer||(this._player=t,Object.keys(this._queuedCallbacks).forEach(e=>{this._queuedCallbacks[e].forEach(i=>V$(t,e,void 0,i))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(t.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(t){this.totalTime=t}syncPlayerEvents(t){const e=this._player;e.triggerCallback&&t.onStart(()=>e.triggerCallback("start")),t.onDone(()=>this.finish()),t.onDestroy(()=>this.destroy())}_queueEvent(t,e){_s(this._queuedCallbacks,t,[]).push(e)}onDone(t){this.queued&&this._queueEvent("done",t),this._player.onDone(t)}onStart(t){this.queued&&this._queueEvent("start",t),this._player.onStart(t)}onDestroy(t){this.queued&&this._queueEvent("destroy",t),this._player.onDestroy(t)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(t){this.queued||this._player.setPosition(t)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(t){const e=this._player;e.triggerCallback&&e.triggerCallback(t)}}function bp(n){return n&&1===n.nodeType}function rE(n,t){const e=n.style.display;return n.style.display=null!=t?t:"none",e}function sE(n,t,e,i,r){const s=[];e.forEach(m=>s.push(rE(m)));const o=[];i.forEach((m,I)=>{const Z={};m.forEach(fe=>{const pe=Z[fe]=t.computeStyle(I,fe,r);(!pe||0==pe.length)&&(I[Ps]=J6,o.push(I))}),n.set(I,Z)});let c=0;return e.forEach(m=>rE(m,s[c++])),o}function oE(n,t){const e=new Map;if(n.forEach(c=>e.set(c,[])),0==t.length)return e;const r=new Set(t),s=new Map;function o(c){if(!c)return 1;let m=s.get(c);if(m)return m;const I=c.parentNode;return m=e.has(I)?I:r.has(I)?1:o(I),s.set(c,m),m}return t.forEach(c=>{const m=o(c);1!==m&&e.get(m).push(c)}),e}function Ns(n,t){var e;null===(e=n.classList)||void 0===e||e.add(t)}function eu(n,t){var e;null===(e=n.classList)||void 0===e||e.remove(t)}function s8(n,t,e){Pa(e).onDone(()=>n.processLeaveNode(t))}function aE(n,t){for(let e=0;e<n.length;e++){const i=n[e];i instanceof Dw?aE(i.players,t):t.push(i)}}function lE(n,t,e){const i=e.get(n);if(!i)return!1;let r=t.get(n);return r?i.forEach(s=>r.add(s)):t.set(n,i),e.delete(n),!0}class yp{constructor(t,e,i){this.bodyNode=t,this._driver=e,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new t8(t,e,i),this._timelineEngine=new W6(t,e,i),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(t,e,i,r,s){const o=t+"-"+r;let c=this._triggerCache[o];if(!c){const m=[],Z=t0(this._driver,s,m,[]);if(m.length)throw function KR(n,t){return new Mt(3404,Pn)}();c=function U6(n,t,e){return new V6(n,t,e)}(r,Z,this._normalizer),this._triggerCache[o]=c}this._transitionEngine.registerTrigger(e,r,c)}register(t,e){this._transitionEngine.register(t,e)}destroy(t,e){this._transitionEngine.destroy(t,e)}onInsert(t,e,i,r){this._transitionEngine.insertNode(t,e,i,r)}onRemove(t,e,i,r){this._transitionEngine.removeNode(t,e,r||!1,i)}disableAnimations(t,e){this._transitionEngine.markElementAsDisabled(t,e)}process(t,e,i,r){if("@"==i.charAt(0)){const[s,o]=Nw(i);this._timelineEngine.command(s,e,o,r)}else this._transitionEngine.trigger(t,e,i,r)}listen(t,e,i,r,s){if("@"==i.charAt(0)){const[o,c]=Nw(i);return this._timelineEngine.listen(o,e,c,s)}return this._transitionEngine.listen(t,e,i,r,s)}flush(t=-1){this._transitionEngine.flush(t)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let c8=(()=>{class n{constructor(e,i,r){this._element=e,this._startStyles=i,this._endStyles=r,this._state=0;let s=n.initialStylesByElement.get(e);s||n.initialStylesByElement.set(e,s={}),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&Mo(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Mo(this._element,this._initialStyles),this._endStyles&&(Mo(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(Dl(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Dl(this._element,this._endStyles),this._endStyles=null),Mo(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function h0(n){let t=null;const e=Object.keys(n);for(let i=0;i<e.length;i++){const r=e[i];u8(r)&&(t=t||{},t[r]=n[r])}return t}function u8(n){return"display"===n||"position"===n}class cE{constructor(t,e,i,r){this.element=t,this.keyframes=e,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(t=>t()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(t,e,i){return t.animate(e,i)}onStart(t){this._onStartFns.push(t)}onDone(t){this._onDoneFns.push(t)}onDestroy(t){this._onDestroyFns.push(t)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(t=>t()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(t=>t()),this._onDestroyFns=[])}setPosition(t){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=t*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const t={};if(this.hasStarted()){const e=this._finalKeyframe;Object.keys(e).forEach(i=>{"offset"!=i&&(t[i]=this._finished?e[i]:Kw(this.element,i))})}this.currentSnapshot=t}triggerCallback(t){const e="start"==t?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class d8{validateStyleProperty(t){return Bw(t)}matchesElement(t,e){return!1}containsElement(t,e){return Lw(t,e)}getParentElement(t){return K$(t)}query(t,e,i){return zw(t,e,i)}computeStyle(t,e,i){return window.getComputedStyle(t)[e]}animate(t,e,i,r,s,o=[]){const m={duration:i,delay:r,fill:0==r?"both":"forwards"};s&&(m.easing=s);const I={},Z=o.filter(pe=>pe instanceof cE);(function g6(n,t){return 0===n||0===t})(i,r)&&Z.forEach(pe=>{let ye=pe.currentSnapshot;Object.keys(ye).forEach(we=>I[we]=ye[we])}),e=function m6(n,t,e){const i=Object.keys(e);if(i.length&&t.length){let s=t[0],o=[];if(i.forEach(c=>{s.hasOwnProperty(c)||o.push(c),s[c]=e[c]}),o.length)for(var r=1;r<t.length;r++){let c=t[r];o.forEach(function(m){c[m]=Kw(n,m)})}}return t}(t,e=e.map(pe=>Na(pe,!1)),I);const fe=function l8(n,t){let e=null,i=null;return Array.isArray(t)&&t.length?(e=h0(t[0]),t.length>1&&(i=h0(t[t.length-1]))):t&&(e=h0(t)),e||i?new c8(n,e,i):null}(t,e);return new cE(t,e,m,fe)}}let f8=(()=>{class n extends Sw{constructor(e,i){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(i.body,{id:"0",encapsulation:Zs.None,styles:[],data:{animation:[]}})}build(e){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(e)?Mw(e):e;return uE(this._renderer,null,i,"register",[r]),new h8(i,this._renderer)}}return n.\u0275fac=function(e){return new(e||n)(rn(dd),rn(Xr))},n.\u0275prov=tn({token:n,factory:n.\u0275fac}),n})();class h8 extends class TR{}{constructor(t,e){super(),this._id=t,this._renderer=e}create(t,e){return new p8(this._id,t,e||{},this._renderer)}}class p8{constructor(t,e,i,r){this.id=t,this.element=e,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(t,e){return this._renderer.listen(this.element,`@@${this.id}:${t}`,e)}_command(t,...e){return uE(this._renderer,this.element,this.id,t,e)}onDone(t){this._listen("done",t)}onStart(t){this._listen("start",t)}onDestroy(t){this._listen("destroy",t)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(t){this._command("setPosition",t)}getPosition(){var t,e;return null!==(e=null===(t=this._renderer.engine.players[+this.id])||void 0===t?void 0:t.getPosition())&&void 0!==e?e:0}}function uE(n,t,e,i,r){return n.setProperty(t,`@@${e}:${i}`,r)}const dE="@.disabled";let g8=(()=>{class n{constructor(e,i,r){this.delegate=e,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(s,o)=>{const c=null==o?void 0:o.parentNode(s);c&&o.removeChild(c,s)}}createRenderer(e,i){const s=this.delegate.createRenderer(e,i);if(!(e&&i&&i.data&&i.data.animation)){let Z=this._rendererCache.get(s);return Z||(Z=new fE("",s,this.engine),this._rendererCache.set(s,Z)),Z}const o=i.id,c=i.id+"-"+this._currentId;this._currentId++,this.engine.register(c,e);const m=Z=>{Array.isArray(Z)?Z.forEach(m):this.engine.registerTrigger(o,c,e,Z.name,Z)};return i.data.animation.forEach(m),new m8(this,c,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,i,r){e>=0&&e<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,c]=s;o(c)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(e){return new(e||n)(rn(dd),rn(yp),rn(vn))},n.\u0275prov=tn({token:n,factory:n.\u0275fac}),n})();class fE{constructor(t,e,i){this.namespaceId=t,this.delegate=e,this.engine=i,this.destroyNode=this.delegate.destroyNode?r=>e.destroyNode(r):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(t,e){return this.delegate.createElement(t,e)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}appendChild(t,e){this.delegate.appendChild(t,e),this.engine.onInsert(this.namespaceId,e,t,!1)}insertBefore(t,e,i,r=!0){this.delegate.insertBefore(t,e,i),this.engine.onInsert(this.namespaceId,e,t,r)}removeChild(t,e,i){this.engine.onRemove(this.namespaceId,e,this.delegate,i)}selectRootElement(t,e){return this.delegate.selectRootElement(t,e)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,e,i,r){this.delegate.setAttribute(t,e,i,r)}removeAttribute(t,e,i){this.delegate.removeAttribute(t,e,i)}addClass(t,e){this.delegate.addClass(t,e)}removeClass(t,e){this.delegate.removeClass(t,e)}setStyle(t,e,i,r){this.delegate.setStyle(t,e,i,r)}removeStyle(t,e,i){this.delegate.removeStyle(t,e,i)}setProperty(t,e,i){"@"==e.charAt(0)&&e==dE?this.disableAnimations(t,!!i):this.delegate.setProperty(t,e,i)}setValue(t,e){this.delegate.setValue(t,e)}listen(t,e,i){return this.delegate.listen(t,e,i)}disableAnimations(t,e){this.engine.disableAnimations(t,e)}}class m8 extends fE{constructor(t,e,i,r){super(e,i,r),this.factory=t,this.namespaceId=e}setProperty(t,e,i){"@"==e.charAt(0)?"."==e.charAt(1)&&e==dE?this.disableAnimations(t,i=void 0===i||!!i):this.engine.process(this.namespaceId,t,e.substr(1),i):this.delegate.setProperty(t,e,i)}listen(t,e,i){if("@"==e.charAt(0)){const r=function _8(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(t);let s=e.substr(1),o="";return"@"!=s.charAt(0)&&([s,o]=function $8(n){const t=n.indexOf(".");return[n.substring(0,t),n.substr(t+1)]}(s)),this.engine.listen(this.namespaceId,r,s,o,c=>{this.factory.scheduleListenerCallback(c._data||-1,i,c)})}return this.delegate.listen(t,e,i)}}let v8=(()=>{class n extends yp{constructor(e,i,r){super(e.body,i,r)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(e){return new(e||n)(rn(Xr),rn(Y$),rn(a0))},n.\u0275prov=tn({token:n,factory:n.\u0275fac}),n})();const hE=new Dn("AnimationModuleType"),pE=[{provide:Sw,useClass:f8},{provide:a0,useFactory:function b8(){return new B6}},{provide:yp,useClass:v8},{provide:dd,useFactory:function y8(n,t,e){return new g8(n,t,e)},deps:[qh,yp,vn]}],gE=[{provide:Y$,useFactory:()=>new d8},{provide:hE,useValue:"BrowserAnimations"},...pE],C8=[{provide:Y$,useClass:jw},{provide:hE,useValue:"NoopAnimations"},...pE];let x8=(()=>{class n{static withConfig(e){return{ngModule:n,providers:e.disableAnimations?C8:gE}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ws({type:n}),n.\u0275inj=ls({providers:gE,imports:[xx]}),n})(),Nd=(()=>{class n{constructor(){this.count=0,this.animeState="active"}ngOnChanges(){this.animeState="inactive",queueMicrotask(()=>{this.animeState="active"})}animationShuffleDone(e){this.animeState="inactive"}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Zt({type:n,selectors:[["badge"]],inputs:{count:"count"},features:[eo],decls:2,vars:2,consts:[[1,"badge"]],template:function(e,i){1&e&&(K(0,"div",0),be(1),J()),2&e&&(te("@bounce",i.animeState),U(1),qe(i.count))},styles:[".badge[_ngcontent-%COMP%]{min-width:8px;min-height:8px;font-size:8px;padding:2px 4px;border-radius:100px;text-align:center;color:#eee;background-color:#cf5252}"],data:{animation:[xn("bounce",[ip("active",Ye({transform:""})),Bt("* => active",[Ft("600ms ease",nn([Ye({transform:"scale3d(0.5, 0.5, 0.5)",offset:0}),Ye({transform:"scale3d(2, 2, 2)",offset:.5}),Ye({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),Ye({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),Ye({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])])]}}),n})();var p0,en=X(5861);(p0||(p0={})).resize=function t(e,i,r,s){let o=e.width,c=e.height,m=o/(i=Math.round(i)),I=c/(r=Math.round(r)),Z=Math.ceil(m/2),fe=Math.ceil(I/2),pe=e.getContext("2d"),ye=pe.getImageData(0,0,o,c),we=pe.createImageData(i,r),Me=ye.data,Oe=we.data;for(let Be=0;Be<r;Be++)for(let ke=0;ke<i;ke++){let ze=4*(ke+Be*i),je=0,st=0,ot=0,tt=0,_t=0,Je=0,at=0,ft=(Be+.5)*I,Ut=Math.floor(Be*I),zt=Math.ceil((Be+1)*I);for(let fn=Ut;fn<zt;fn++){let Nn=Math.abs(ft-(fn+.5))/fe,bt=(ke+.5)*m,wt=Nn*Nn,Et=Math.floor(ke*m),Pt=Math.ceil((ke+1)*m);for(let mn=Et;mn<Pt;mn++){let Rn=Math.abs(bt-(mn+.5))/Z,Hn=Math.sqrt(wt+Rn*Rn);if(Hn>=1)continue;je=2*Hn*Hn*Hn-3*Hn*Hn+1;let mi=4*(mn+fn*o);at+=je*Me[mi+3],ot+=je,Me[mi+3]<255&&(je=je*Me[mi+3]/250),tt+=je*Me[mi],_t+=je*Me[mi+1],Je+=je*Me[mi+2],st+=je}}Oe[ze]=tt/st,Oe[ze+1]=_t/st,Oe[ze+2]=Je/st,Oe[ze+3]=at/ot}!0===s?(e.width=i,e.height=r):pe.clearRect(0,0,o,c),pe.putImageData(we,0,0)};var uo,w8=X(7412),mE=X(1817);!function(n){function r(){return(r=(0,en.Z)(function*(m){return m instanceof Blob?s(m):c(m)})).apply(this,arguments)}function s(m){return o.apply(this,arguments)}function o(){return(o=(0,en.Z)(function*(m){return c(yield n.readAsArrayBufferAsync(m))})).apply(this,arguments)}function c(m){let I=w8.create(m);return mE(I).toString()}n.readAsArrayBufferAsync=function t(m){return new Promise((I,Z)=>{let fe=new FileReader;fe.onload=pe=>{I(fe.result)},fe.onabort=fe.onerror=pe=>{Z(pe)},fe.readAsArrayBuffer(m)})},n.readAsTextAsync=function e(m){return new Promise((I,Z)=>{let fe=new FileReader;fe.onload=pe=>{I(fe.result)},fe.onabort=fe.onerror=pe=>{Z(pe)},fe.readAsText(m)})},n.calcSHA256Async=function i(m){return r.apply(this,arguments)}}(uo||(uo={}));var Bi=(()=>(function(n){n[n.NULL=0]="NULL",n[n.THUMBNAIL=1]="THUMBNAIL",n[n.COMPLETE=2]="COMPLETE",n[n.URL=1e3]="URL"}(Bi||(Bi={})),Bi))();class Ht{constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:"",thumbnail:{blob:null,type:"",url:""}}}get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob?this.context.blob:this.context.thumbnail.blob}get url(){return this.context.url?this.context.url:this.context.thumbnail.url}get thumbnail(){return this.context.thumbnail}get state(){return this.url||this.blob?this.url&&!this.blob?Bi.URL:this.blob===this.thumbnail.blob?Bi.THUMBNAIL:Bi.COMPLETE:Bi.NULL}get isEmpty(){return this.state<=Bi.NULL}static createEmpty(t){let e=new Ht;return e.context.identifier=t,e}static create(t){if("string"==typeof t){let e=new Ht;return e.context.identifier=t,e.context.name=t,e.context.url=t,e}{let e=new Ht;return e.apply(t),e}}static createAsync(t){return(0,en.Z)(function*(){return t instanceof File?yield Ht._createAsync(t,t.name):t instanceof Blob?yield Ht._createAsync(t):void 0})()}static _createAsync(t,e){return(0,en.Z)(function*(){let i=yield uo.readAsArrayBufferAsync(t),r=new Ht;r.context.identifier=yield uo.calcSHA256Async(i),r.context.name=e,r.context.blob=new Blob([i],{type:t.type}),r.context.url=window.URL.createObjectURL(r.context.blob);try{r.context.thumbnail=yield Ht.createThumbnailAsync(r.context)}catch(s){throw s}return null!=r.context.name&&(r.context.name=r.context.identifier),r})()}destroy(){this.revokeURLs()}apply(t){!this.context.identifier&&t.identifier&&(this.context.identifier=t.identifier),!this.context.name&&t.name&&(this.context.name=t.name),!this.context.blob&&t.blob&&(this.context.blob=t.blob),!this.context.type&&t.type&&(this.context.type=t.type),!this.context.url&&t.url&&(this.state!==Bi.URL&&window.URL.revokeObjectURL(this.context.url),this.context.url=t.url),!this.context.thumbnail.blob&&t.thumbnail.blob&&(this.context.thumbnail.blob=t.thumbnail.blob),!this.context.thumbnail.type&&t.thumbnail.type&&(this.context.thumbnail.type=t.thumbnail.type),!this.context.thumbnail.url&&t.thumbnail.url&&(this.state!==Bi.URL&&window.URL.revokeObjectURL(this.context.thumbnail.url),this.context.thumbnail.url=t.thumbnail.url),this.createURLs()}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url,thumbnail:{blob:this.context.thumbnail.blob,type:this.context.thumbnail.type,url:this.context.thumbnail.url}}}createURLs(){this.state!==Bi.URL&&(this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob)),this.context.thumbnail.blob&&""===this.context.thumbnail.url&&(this.context.thumbnail.url=window.URL.createObjectURL(this.context.thumbnail.blob)))}revokeURLs(){this.state!==Bi.URL&&(window.URL.revokeObjectURL(this.context.url),window.URL.revokeObjectURL(this.context.thumbnail.url))}static createThumbnailAsync(t){return new Promise((e,i)=>{let r=new Image;r.onload=s=>{let o=Math.min(128/Math.max(r.width,r.height),1),c=r.width*o,m=r.height*o,I=document.createElement("canvas"),Z=I.getContext("2d");I.width=r.width,I.height=r.height,Z.drawImage(r,0,0),p0.resize(I,c,m,!0),I.toBlob(fe=>{let pe={type:fe.type,blob:fe,url:window.URL.createObjectURL(fe)};e(pe)},t.blob.type)},r.onabort=r.onerror=()=>{i()},r.src=t.url})}}Ht.Empty=Ht.createEmpty("null");let tu=0;const Fd=new Map,xp=new MessageChannel;function xr(n){if(4294967296===tu&&(tu=0),++tu in Fd)throw new Error("setZeroTimeout queue overflow.");return Fd.set(tu,n),xp.port2.postMessage(tu),tu}xp.port1.onmessage=function(n){const t=Fd.get(n.data);Fd.delete(n.data),t&&t()},xp.port1.start(),xp.port2.start();class _E{}var $E=X(8497),Fa=(()=>(function(n){n[n.UNSPECIFIED=0]="UNSPECIFIED",n[n.LOW=1]="LOW",n[n.MIDDLE=2]="MIDDLE",n[n.HIGH=3]="HIGH"}(Fa||(Fa={})),Fa))();const I8=function T8(n){if(n.length>=255)throw new TypeError("Alphabet too long");const t=new Uint8Array(256);for(let I=0;I<t.length;I++)t[I]=255;for(let I=0;I<n.length;I++){const Z=n.charAt(I),fe=Z.charCodeAt(0);if(255!==t[fe])throw new TypeError(Z+" is ambiguous");t[fe]=I}const e=n.length,i=n.charAt(0),r=Math.log(e)/Math.log(256),s=Math.log(256)/Math.log(e);function c(I){if("string"!=typeof I)throw new TypeError("Expected String");if(0===I.length)return new Uint8Array;let Z=0;if(" "===I[Z])return;let fe=0,pe=0;for(;I[Z]===i;)fe++,Z++;const ye=(I.length-Z)*r+1>>>0,we=new Uint8Array(ye);for(;I[Z];){let ke=t[I.charCodeAt(Z)];if(255===ke)return;let ze=0;for(let je=ye-1;(0!==ke||ze<pe)&&-1!==je;je--,ze++)ke+=e*we[je]>>>0,we[je]=ke%256>>>0,ke=ke/256>>>0;if(0!==ke)throw new Error("Non-zero carry");pe=ze,Z++}if(" "===I[Z])return;let Me=ye-pe;for(;Me!==ye&&0===we[Me];)Me++;const Oe=new Uint8Array(fe+(ye-Me));let Be=fe;for(;Me!==ye;)Oe[Be++]=we[Me++];return Oe}return{encode:function o(I){if(I instanceof Uint8Array||(ArrayBuffer.isView(I)?I=new Uint8Array(I.buffer,I.byteOffset,I.byteLength):Array.isArray(I)&&(I=Uint8Array.from(I))),!(I instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===I.length)return"";let Z=0,fe=0,pe=0;const ye=I.length;for(;pe!==ye&&0===I[pe];)pe++,Z++;const we=(ye-pe)*s+1>>>0,Me=new Uint8Array(we);for(;pe!==ye;){let ke=I[pe],ze=0;for(let je=we-1;(0!==ke||ze<fe)&&-1!==je;je--,ze++)ke+=256*Me[je]>>>0,Me[je]=ke%e>>>0,ke=ke/e>>>0;if(0!==ke)throw new Error("Non-zero carry");fe=ze,pe++}let Oe=we-fe;for(;Oe!==we&&0===Me[Oe];)Oe++;let Be=i.repeat(Z);for(;Oe<we;++Oe)Be+=n.charAt(Me[Oe]);return Be},decodeUnsafe:c,decode:function m(I){const Z=c(I);if(Z)return Z;throw new Error("Non-base"+e+" character")}}}("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),S8=/^(\w{6})(\w{3})(\w*)-(\w*)/i;class pi{constructor(t){this.peerId="",this.userId="",this.roomId="",this.roomName="",this.password="",this.digestUserId="",this.digestPassword="",this.isOpen=!1,this.session={grade:Fa.UNSPECIFIED,ping:0,health:0,speed:0,description:""},this.parse(t)}get isRoom(){return 0<this.roomId.length}get hasPassword(){return 0<this.password.length+this.digestPassword.length}parse(t){try{this.peerId=t;let e=S8.exec(t);if(null!=e)return this.digestUserId=e[1],this.roomId=e[2],this.roomName=$E.L(e[3]),void(this.digestPassword=e[4])}catch(e){console.warn(e)}this.digestUserId=t}verifyPassword(t){return vE(this.roomId,t)===this.digestPassword}static parse(t){return new pi(t)}static create(...t){return t.length<=1?pi._create.apply(this,t):pi._createRoom.apply(this,t)}static _create(t=""){let e=function M8(n){return null==n?"":bE(n)}(t),i=new pi(e);return i.userId=t,i}static _createRoom(t="",e="",i="",r=""){let s=this.generateId("******"),o=vE(e,r),c=`${s}${e}${$E.n(i)}-${o}`,m=new pi(c);return m.userId=t,m.password=r,m}static generateId(t="********"){const e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";let i=t;return i=t.replace(/\*/g,r=>e[Math.floor(Math.random()*e.length)]),i}}function vE(n,t){return null==n||null==t?"":0<t.length?bE(n+t,7):""}function bE(n,t=-1){if(null==n)return"";let e=mE(n),i=new Uint8Array(Uint32Array.from(e.words).buffer),r=I8.encode(i);return t<0&&(t=r.length),r.length<t&&(t=r.length),r=r.slice(0,t),r}function nu(n){let t=n.length;for(;--t>=0;)n[t]=0}const v0=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),wp=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),R8=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),SE=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),sa=new Array(576);nu(sa);const Bd=new Array(60);nu(Bd);const Ld=new Array(512);nu(Ld);const zd=new Array(256);nu(zd);const b0=new Array(29);nu(b0);const Ep=new Array(30);function y0(n,t,e,i,r){this.static_tree=n,this.extra_bits=t,this.extra_base=e,this.elems=i,this.max_length=r,this.has_stree=n&&n.length}let ME,kE,DE;function C0(n,t){this.dyn_tree=n,this.max_code=0,this.stat_desc=t}nu(Ep);const AE=n=>n<256?Ld[n]:Ld[256+(n>>>7)],jd=(n,t)=>{n.pending_buf[n.pending++]=255&t,n.pending_buf[n.pending++]=t>>>8&255},ts=(n,t,e)=>{n.bi_valid>16-e?(n.bi_buf|=t<<n.bi_valid&65535,jd(n,n.bi_buf),n.bi_buf=t>>16-n.bi_valid,n.bi_valid+=e-16):(n.bi_buf|=t<<n.bi_valid&65535,n.bi_valid+=e)},ko=(n,t,e)=>{ts(n,e[2*t],e[2*t+1])},PE=(n,t)=>{let e=0;do{e|=1&n,n>>>=1,e<<=1}while(--t>0);return e>>>1},NE=(n,t,e)=>{const i=new Array(16);let s,o,r=0;for(s=1;s<=15;s++)i[s]=r=r+e[s-1]<<1;for(o=0;o<=t;o++){let c=n[2*o+1];0!==c&&(n[2*o]=PE(i[c]++,c))}},FE=n=>{let t;for(t=0;t<286;t++)n.dyn_ltree[2*t]=0;for(t=0;t<30;t++)n.dyn_dtree[2*t]=0;for(t=0;t<19;t++)n.bl_tree[2*t]=0;n.dyn_ltree[512]=1,n.opt_len=n.static_len=0,n.last_lit=n.matches=0},OE=n=>{n.bi_valid>8?jd(n,n.bi_buf):n.bi_valid>0&&(n.pending_buf[n.pending++]=n.bi_buf),n.bi_buf=0,n.bi_valid=0},RE=(n,t,e,i)=>{const r=2*t,s=2*e;return n[r]<n[s]||n[r]===n[s]&&i[t]<=i[e]},x0=(n,t,e)=>{const i=n.heap[e];let r=e<<1;for(;r<=n.heap_len&&(r<n.heap_len&&RE(t,n.heap[r+1],n.heap[r],n.depth)&&r++,!RE(t,i,n.heap[r],n.depth));)n.heap[e]=n.heap[r],e=r,r<<=1;n.heap[e]=i},BE=(n,t,e)=>{let i,r,o,c,s=0;if(0!==n.last_lit)do{i=n.pending_buf[n.d_buf+2*s]<<8|n.pending_buf[n.d_buf+2*s+1],r=n.pending_buf[n.l_buf+s],s++,0===i?ko(n,r,t):(o=zd[r],ko(n,o+256+1,t),c=v0[o],0!==c&&(r-=b0[o],ts(n,r,c)),i--,o=AE(i),ko(n,o,e),c=wp[o],0!==c&&(i-=Ep[o],ts(n,i,c)))}while(s<n.last_lit);ko(n,256,t)},w0=(n,t)=>{const e=t.dyn_tree,i=t.stat_desc.static_tree,r=t.stat_desc.has_stree,s=t.stat_desc.elems;let o,c,I,m=-1;for(n.heap_len=0,n.heap_max=573,o=0;o<s;o++)0!==e[2*o]?(n.heap[++n.heap_len]=m=o,n.depth[o]=0):e[2*o+1]=0;for(;n.heap_len<2;)I=n.heap[++n.heap_len]=m<2?++m:0,e[2*I]=1,n.depth[I]=0,n.opt_len--,r&&(n.static_len-=i[2*I+1]);for(t.max_code=m,o=n.heap_len>>1;o>=1;o--)x0(n,e,o);I=s;do{o=n.heap[1],n.heap[1]=n.heap[n.heap_len--],x0(n,e,1),c=n.heap[1],n.heap[--n.heap_max]=o,n.heap[--n.heap_max]=c,e[2*I]=e[2*o]+e[2*c],n.depth[I]=(n.depth[o]>=n.depth[c]?n.depth[o]:n.depth[c])+1,e[2*o+1]=e[2*c+1]=I,n.heap[1]=I++,x0(n,e,1)}while(n.heap_len>=2);n.heap[--n.heap_max]=n.heap[1],((n,t)=>{const e=t.dyn_tree,i=t.max_code,r=t.stat_desc.static_tree,s=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,c=t.stat_desc.extra_base,m=t.stat_desc.max_length;let I,Z,fe,pe,ye,we,Me=0;for(pe=0;pe<=15;pe++)n.bl_count[pe]=0;for(e[2*n.heap[n.heap_max]+1]=0,I=n.heap_max+1;I<573;I++)Z=n.heap[I],pe=e[2*e[2*Z+1]+1]+1,pe>m&&(pe=m,Me++),e[2*Z+1]=pe,!(Z>i)&&(n.bl_count[pe]++,ye=0,Z>=c&&(ye=o[Z-c]),we=e[2*Z],n.opt_len+=we*(pe+ye),s&&(n.static_len+=we*(r[2*Z+1]+ye)));if(0!==Me){do{for(pe=m-1;0===n.bl_count[pe];)pe--;n.bl_count[pe]--,n.bl_count[pe+1]+=2,n.bl_count[m]--,Me-=2}while(Me>0);for(pe=m;0!==pe;pe--)for(Z=n.bl_count[pe];0!==Z;)fe=n.heap[--I],!(fe>i)&&(e[2*fe+1]!==pe&&(n.opt_len+=(pe-e[2*fe+1])*e[2*fe],e[2*fe+1]=pe),Z--)}})(n,t),NE(e,m,n.bl_count)},LE=(n,t,e)=>{let i,s,r=-1,o=t[1],c=0,m=7,I=4;for(0===o&&(m=138,I=3),t[2*(e+1)+1]=65535,i=0;i<=e;i++)s=o,o=t[2*(i+1)+1],!(++c<m&&s===o)&&(c<I?n.bl_tree[2*s]+=c:0!==s?(s!==r&&n.bl_tree[2*s]++,n.bl_tree[32]++):c<=10?n.bl_tree[34]++:n.bl_tree[36]++,c=0,r=s,0===o?(m=138,I=3):s===o?(m=6,I=3):(m=7,I=4))},zE=(n,t,e)=>{let i,s,r=-1,o=t[1],c=0,m=7,I=4;for(0===o&&(m=138,I=3),i=0;i<=e;i++)if(s=o,o=t[2*(i+1)+1],!(++c<m&&s===o)){if(c<I)do{ko(n,s,n.bl_tree)}while(0!=--c);else 0!==s?(s!==r&&(ko(n,s,n.bl_tree),c--),ko(n,16,n.bl_tree),ts(n,c-3,2)):c<=10?(ko(n,17,n.bl_tree),ts(n,c-3,3)):(ko(n,18,n.bl_tree),ts(n,c-11,7));c=0,r=s,0===o?(m=138,I=3):s===o?(m=6,I=3):(m=7,I=4)}};let jE=!1;const HE=(n,t,e,i)=>{ts(n,0+(i?1:0),3),((n,t,e,i)=>{OE(n),jd(n,e),jd(n,~e),n.pending_buf.set(n.window.subarray(t,t+e),n.pending),n.pending+=e})(n,t,e)};var tB={_tr_init:n=>{jE||((()=>{let n,t,e,i,r;const s=new Array(16);for(e=0,i=0;i<28;i++)for(b0[i]=e,n=0;n<1<<v0[i];n++)zd[e++]=i;for(zd[e-1]=i,r=0,i=0;i<16;i++)for(Ep[i]=r,n=0;n<1<<wp[i];n++)Ld[r++]=i;for(r>>=7;i<30;i++)for(Ep[i]=r<<7,n=0;n<1<<wp[i]-7;n++)Ld[256+r++]=i;for(t=0;t<=15;t++)s[t]=0;for(n=0;n<=143;)sa[2*n+1]=8,n++,s[8]++;for(;n<=255;)sa[2*n+1]=9,n++,s[9]++;for(;n<=279;)sa[2*n+1]=7,n++,s[7]++;for(;n<=287;)sa[2*n+1]=8,n++,s[8]++;for(NE(sa,287,s),n=0;n<30;n++)Bd[2*n+1]=5,Bd[2*n]=PE(n,5);ME=new y0(sa,v0,257,286,15),kE=new y0(Bd,wp,0,30,15),DE=new y0(new Array(0),R8,0,19,7)})(),jE=!0),n.l_desc=new C0(n.dyn_ltree,ME),n.d_desc=new C0(n.dyn_dtree,kE),n.bl_desc=new C0(n.bl_tree,DE),n.bi_buf=0,n.bi_valid=0,FE(n)},_tr_stored_block:HE,_tr_flush_block:(n,t,e,i)=>{let r,s,o=0;n.level>0?(2===n.strm.data_type&&(n.strm.data_type=(n=>{let e,t=4093624447;for(e=0;e<=31;e++,t>>>=1)if(1&t&&0!==n.dyn_ltree[2*e])return 0;if(0!==n.dyn_ltree[18]||0!==n.dyn_ltree[20]||0!==n.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==n.dyn_ltree[2*e])return 1;return 0})(n)),w0(n,n.l_desc),w0(n,n.d_desc),o=(n=>{let t;for(LE(n,n.dyn_ltree,n.l_desc.max_code),LE(n,n.dyn_dtree,n.d_desc.max_code),w0(n,n.bl_desc),t=18;t>=3&&0===n.bl_tree[2*SE[t]+1];t--);return n.opt_len+=3*(t+1)+5+5+4,t})(n),r=n.opt_len+3+7>>>3,s=n.static_len+3+7>>>3,s<=r&&(r=s)):r=s=e+5,e+4<=r&&-1!==t?HE(n,t,e,i):4===n.strategy||s===r?(ts(n,2+(i?1:0),3),BE(n,sa,Bd)):(ts(n,4+(i?1:0),3),((n,t,e,i)=>{let r;for(ts(n,t-257,5),ts(n,e-1,5),ts(n,i-4,4),r=0;r<i;r++)ts(n,n.bl_tree[2*SE[r]+1],3);zE(n,n.dyn_ltree,t-1),zE(n,n.dyn_dtree,e-1)})(n,n.l_desc.max_code+1,n.d_desc.max_code+1,o+1),BE(n,n.dyn_ltree,n.dyn_dtree)),FE(n),i&&OE(n)},_tr_tally:(n,t,e)=>(n.pending_buf[n.d_buf+2*n.last_lit]=t>>>8&255,n.pending_buf[n.d_buf+2*n.last_lit+1]=255&t,n.pending_buf[n.l_buf+n.last_lit]=255&e,n.last_lit++,0===t?n.dyn_ltree[2*e]++:(n.matches++,t--,n.dyn_ltree[2*(zd[e]+256+1)]++,n.dyn_dtree[2*AE(t)]++),n.last_lit===n.lit_bufsize-1),_tr_align:n=>{ts(n,2,3),ko(n,256,sa),(n=>{16===n.bi_valid?(jd(n,n.bi_buf),n.bi_buf=0,n.bi_valid=0):n.bi_valid>=8&&(n.pending_buf[n.pending++]=255&n.bi_buf,n.bi_buf>>=8,n.bi_valid-=8)})(n)}},Hd=(n,t,e,i)=>{let r=65535&n|0,s=n>>>16&65535|0,o=0;for(;0!==e;){o=e>2e3?2e3:e,e-=o;do{r=r+t[i++]|0,s=s+r|0}while(--o);r%=65521,s%=65521}return r|s<<16|0};const iB=new Uint32Array((()=>{let n,t=[];for(var e=0;e<256;e++){n=e;for(var i=0;i<8;i++)n=1&n?3988292384^n>>>1:n>>>1;t[e]=n}return t})());var rr=(n,t,e,i)=>{const r=iB,s=i+e;n^=-1;for(let o=i;o<s;o++)n=n>>>8^r[255&(n^t[o])];return-1^n},Nl={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Fl={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:rB,_tr_stored_block:sB,_tr_flush_block:oB,_tr_tally:Oa,_tr_align:aB}=tB,{Z_NO_FLUSH:Ol,Z_PARTIAL_FLUSH:lB,Z_FULL_FLUSH:cB,Z_FINISH:Ra,Z_BLOCK:UE,Z_OK:Do,Z_STREAM_END:VE,Z_STREAM_ERROR:Fs,Z_DATA_ERROR:uB,Z_BUF_ERROR:E0,Z_DEFAULT_COMPRESSION:dB,Z_FILTERED:fB,Z_HUFFMAN_ONLY:Tp,Z_RLE:hB,Z_FIXED:pB,Z_DEFAULT_STRATEGY:gB,Z_UNKNOWN:mB,Z_DEFLATED:Ip}=Fl,fo=262,La=(n,t)=>(n.msg=Nl[t],t),GE=n=>(n<<1)-(n>4?9:0),za=n=>{let t=n.length;for(;--t>=0;)n[t]=0};let ja=(n,t,e)=>(t<<n.hash_shift^e)&n.hash_mask;const Ha=n=>{const t=n.state;let e=t.pending;e>n.avail_out&&(e=n.avail_out),0!==e&&(n.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+e),n.next_out),n.next_out+=e,t.pending_out+=e,n.total_out+=e,n.avail_out-=e,t.pending-=e,0===t.pending&&(t.pending_out=0))},dr=(n,t)=>{oB(n,n.block_start>=0?n.block_start:-1,n.strstart-n.block_start,t),n.block_start=n.strstart,Ha(n.strm)},Vn=(n,t)=>{n.pending_buf[n.pending++]=t},Gd=(n,t)=>{n.pending_buf[n.pending++]=t>>>8&255,n.pending_buf[n.pending++]=255&t},IB=(n,t,e,i)=>{let r=n.avail_in;return r>i&&(r=i),0===r?0:(n.avail_in-=r,t.set(n.input.subarray(n.next_in,n.next_in+r),e),1===n.state.wrap?n.adler=Hd(n.adler,t,r,e):2===n.state.wrap&&(n.adler=rr(n.adler,t,r,e)),n.next_in+=r,n.total_in+=r,r)},qE=(n,t)=>{let r,s,e=n.max_chain_length,i=n.strstart,o=n.prev_length,c=n.nice_match;const m=n.strstart>n.w_size-fo?n.strstart-(n.w_size-fo):0,I=n.window,Z=n.w_mask,fe=n.prev,pe=n.strstart+258;let ye=I[i+o-1],we=I[i+o];n.prev_length>=n.good_match&&(e>>=2),c>n.lookahead&&(c=n.lookahead);do{if(r=t,I[r+o]===we&&I[r+o-1]===ye&&I[r]===I[i]&&I[++r]===I[i+1]){i+=2,r++;do{}while(I[++i]===I[++r]&&I[++i]===I[++r]&&I[++i]===I[++r]&&I[++i]===I[++r]&&I[++i]===I[++r]&&I[++i]===I[++r]&&I[++i]===I[++r]&&I[++i]===I[++r]&&i<pe);if(s=258-(pe-i),i=pe-258,s>o){if(n.match_start=t,o=s,s>=c)break;ye=I[i+o-1],we=I[i+o]}}}while((t=fe[t&Z])>m&&0!=--e);return o<=n.lookahead?o:n.lookahead},Ll=n=>{const t=n.w_size;let e,i,r,s,o;do{if(s=n.window_size-n.lookahead-n.strstart,n.strstart>=t+(t-fo)){n.window.set(n.window.subarray(t,t+t),0),n.match_start-=t,n.strstart-=t,n.block_start-=t,i=n.hash_size,e=i;do{r=n.head[--e],n.head[e]=r>=t?r-t:0}while(--i);i=t,e=i;do{r=n.prev[--e],n.prev[e]=r>=t?r-t:0}while(--i);s+=t}if(0===n.strm.avail_in)break;if(i=IB(n.strm,n.window,n.strstart+n.lookahead,s),n.lookahead+=i,n.lookahead+n.insert>=3)for(o=n.strstart-n.insert,n.ins_h=n.window[o],n.ins_h=ja(n,n.ins_h,n.window[o+1]);n.insert&&(n.ins_h=ja(n,n.ins_h,n.window[o+3-1]),n.prev[o&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=o,o++,n.insert--,!(n.lookahead+n.insert<3)););}while(n.lookahead<fo&&0!==n.strm.avail_in)},S0=(n,t)=>{let e,i;for(;;){if(n.lookahead<fo){if(Ll(n),n.lookahead<fo&&t===Ol)return 1;if(0===n.lookahead)break}if(e=0,n.lookahead>=3&&(n.ins_h=ja(n,n.ins_h,n.window[n.strstart+3-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),0!==e&&n.strstart-e<=n.w_size-fo&&(n.match_length=qE(n,e)),n.match_length>=3)if(i=Oa(n,n.strstart-n.match_start,n.match_length-3),n.lookahead-=n.match_length,n.match_length<=n.max_lazy_match&&n.lookahead>=3){n.match_length--;do{n.strstart++,n.ins_h=ja(n,n.ins_h,n.window[n.strstart+3-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart}while(0!=--n.match_length);n.strstart++}else n.strstart+=n.match_length,n.match_length=0,n.ins_h=n.window[n.strstart],n.ins_h=ja(n,n.ins_h,n.window[n.strstart+1]);else i=Oa(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++;if(i&&(dr(n,!1),0===n.strm.avail_out))return 1}return n.insert=n.strstart<2?n.strstart:2,t===Ra?(dr(n,!0),0===n.strm.avail_out?3:4):n.last_lit&&(dr(n,!1),0===n.strm.avail_out)?1:2},su=(n,t)=>{let e,i,r;for(;;){if(n.lookahead<fo){if(Ll(n),n.lookahead<fo&&t===Ol)return 1;if(0===n.lookahead)break}if(e=0,n.lookahead>=3&&(n.ins_h=ja(n,n.ins_h,n.window[n.strstart+3-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),n.prev_length=n.match_length,n.prev_match=n.match_start,n.match_length=2,0!==e&&n.prev_length<n.max_lazy_match&&n.strstart-e<=n.w_size-fo&&(n.match_length=qE(n,e),n.match_length<=5&&(n.strategy===fB||3===n.match_length&&n.strstart-n.match_start>4096)&&(n.match_length=2)),n.prev_length>=3&&n.match_length<=n.prev_length){r=n.strstart+n.lookahead-3,i=Oa(n,n.strstart-1-n.prev_match,n.prev_length-3),n.lookahead-=n.prev_length-1,n.prev_length-=2;do{++n.strstart<=r&&(n.ins_h=ja(n,n.ins_h,n.window[n.strstart+3-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart)}while(0!=--n.prev_length);if(n.match_available=0,n.match_length=2,n.strstart++,i&&(dr(n,!1),0===n.strm.avail_out))return 1}else if(n.match_available){if(i=Oa(n,0,n.window[n.strstart-1]),i&&dr(n,!1),n.strstart++,n.lookahead--,0===n.strm.avail_out)return 1}else n.match_available=1,n.strstart++,n.lookahead--}return n.match_available&&(i=Oa(n,0,n.window[n.strstart-1]),n.match_available=0),n.insert=n.strstart<2?n.strstart:2,t===Ra?(dr(n,!0),0===n.strm.avail_out?3:4):n.last_lit&&(dr(n,!1),0===n.strm.avail_out)?1:2};function Ao(n,t,e,i,r){this.good_length=n,this.max_lazy=t,this.nice_length=e,this.max_chain=i,this.func=r}const qd=[new Ao(0,0,0,0,(n,t)=>{let e=65535;for(e>n.pending_buf_size-5&&(e=n.pending_buf_size-5);;){if(n.lookahead<=1){if(Ll(n),0===n.lookahead&&t===Ol)return 1;if(0===n.lookahead)break}n.strstart+=n.lookahead,n.lookahead=0;const i=n.block_start+e;if((0===n.strstart||n.strstart>=i)&&(n.lookahead=n.strstart-i,n.strstart=i,dr(n,!1),0===n.strm.avail_out)||n.strstart-n.block_start>=n.w_size-fo&&(dr(n,!1),0===n.strm.avail_out))return 1}return n.insert=0,t===Ra?(dr(n,!0),0===n.strm.avail_out?3:4):(n.strstart>n.block_start&&dr(n,!1),1)}),new Ao(4,4,8,4,S0),new Ao(4,5,16,8,S0),new Ao(4,6,32,32,S0),new Ao(4,4,16,16,su),new Ao(8,16,32,32,su),new Ao(8,16,128,128,su),new Ao(8,32,128,256,su),new Ao(32,128,258,1024,su),new Ao(32,258,258,4096,su)];function AB(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Ip,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),za(this.dyn_ltree),za(this.dyn_dtree),za(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),za(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),za(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const WE=n=>{if(!n||!n.state)return La(n,Fs);n.total_in=n.total_out=0,n.data_type=mB;const t=n.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:113,n.adler=2===t.wrap?0:1,t.last_flush=Ol,rB(t),Do},KE=n=>{const t=WE(n);return t===Do&&(n=>{n.window_size=2*n.w_size,za(n.head),n.max_lazy_match=qd[n.level].max_lazy,n.good_match=qd[n.level].good_length,n.nice_match=qd[n.level].nice_length,n.max_chain_length=qd[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0})(n.state),t},YE=(n,t,e,i,r,s)=>{if(!n)return Fs;let o=1;if(t===dB&&(t=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),r<1||r>9||e!==Ip||i<8||i>15||t<0||t>9||s<0||s>pB)return La(n,Fs);8===i&&(i=9);const c=new AB;return n.state=c,c.strm=n,c.wrap=o,c.gzhead=null,c.w_bits=i,c.w_size=1<<c.w_bits,c.w_mask=c.w_size-1,c.hash_bits=r+7,c.hash_size=1<<c.hash_bits,c.hash_mask=c.hash_size-1,c.hash_shift=~~((c.hash_bits+3-1)/3),c.window=new Uint8Array(2*c.w_size),c.head=new Uint16Array(c.hash_size),c.prev=new Uint16Array(c.w_size),c.lit_bufsize=1<<r+6,c.pending_buf_size=4*c.lit_bufsize,c.pending_buf=new Uint8Array(c.pending_buf_size),c.d_buf=1*c.lit_bufsize,c.l_buf=3*c.lit_bufsize,c.level=t,c.strategy=s,c.method=e,KE(n)};var Wd_deflateInit2=YE,Wd_deflateSetHeader=(n,t)=>n&&n.state&&2===n.state.wrap?(n.state.gzhead=t,Do):Fs,Wd_deflate=(n,t)=>{let e,i;if(!n||!n.state||t>UE||t<0)return n?La(n,Fs):Fs;const r=n.state;if(!n.output||!n.input&&0!==n.avail_in||666===r.status&&t!==Ra)return La(n,0===n.avail_out?E0:Fs);r.strm=n;const s=r.last_flush;if(r.last_flush=t,42===r.status)if(2===r.wrap)n.adler=0,Vn(r,31),Vn(r,139),Vn(r,8),r.gzhead?(Vn(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Vn(r,255&r.gzhead.time),Vn(r,r.gzhead.time>>8&255),Vn(r,r.gzhead.time>>16&255),Vn(r,r.gzhead.time>>24&255),Vn(r,9===r.level?2:r.strategy>=Tp||r.level<2?4:0),Vn(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(Vn(r,255&r.gzhead.extra.length),Vn(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(n.adler=rr(n.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(Vn(r,0),Vn(r,0),Vn(r,0),Vn(r,0),Vn(r,0),Vn(r,9===r.level?2:r.strategy>=Tp||r.level<2?4:0),Vn(r,3),r.status=113);else{let o=Ip+(r.w_bits-8<<4)<<8,c=-1;c=r.strategy>=Tp||r.level<2?0:r.level<6?1:6===r.level?2:3,o|=c<<6,0!==r.strstart&&(o|=32),o+=31-o%31,r.status=113,Gd(r,o),0!==r.strstart&&(Gd(r,n.adler>>>16),Gd(r,65535&n.adler)),n.adler=1}if(69===r.status)if(r.gzhead.extra){for(e=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>e&&(n.adler=rr(n.adler,r.pending_buf,r.pending-e,e)),Ha(n),e=r.pending,r.pending!==r.pending_buf_size));)Vn(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>e&&(n.adler=rr(n.adler,r.pending_buf,r.pending-e,e)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){e=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>e&&(n.adler=rr(n.adler,r.pending_buf,r.pending-e,e)),Ha(n),e=r.pending,r.pending===r.pending_buf_size)){i=1;break}i=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,Vn(r,i)}while(0!==i);r.gzhead.hcrc&&r.pending>e&&(n.adler=rr(n.adler,r.pending_buf,r.pending-e,e)),0===i&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){e=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>e&&(n.adler=rr(n.adler,r.pending_buf,r.pending-e,e)),Ha(n),e=r.pending,r.pending===r.pending_buf_size)){i=1;break}i=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,Vn(r,i)}while(0!==i);r.gzhead.hcrc&&r.pending>e&&(n.adler=rr(n.adler,r.pending_buf,r.pending-e,e)),0===i&&(r.status=103)}else r.status=103;if(103===r.status&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&Ha(n),r.pending+2<=r.pending_buf_size&&(Vn(r,255&n.adler),Vn(r,n.adler>>8&255),n.adler=0,r.status=113)):r.status=113),0!==r.pending){if(Ha(n),0===n.avail_out)return r.last_flush=-1,Do}else if(0===n.avail_in&&GE(t)<=GE(s)&&t!==Ra)return La(n,E0);if(666===r.status&&0!==n.avail_in)return La(n,E0);if(0!==n.avail_in||0!==r.lookahead||t!==Ol&&666!==r.status){let o=r.strategy===Tp?((n,t)=>{let e;for(;;){if(0===n.lookahead&&(Ll(n),0===n.lookahead)){if(t===Ol)return 1;break}if(n.match_length=0,e=Oa(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++,e&&(dr(n,!1),0===n.strm.avail_out))return 1}return n.insert=0,t===Ra?(dr(n,!0),0===n.strm.avail_out?3:4):n.last_lit&&(dr(n,!1),0===n.strm.avail_out)?1:2})(r,t):r.strategy===hB?((n,t)=>{let e,i,r,s;const o=n.window;for(;;){if(n.lookahead<=258){if(Ll(n),n.lookahead<=258&&t===Ol)return 1;if(0===n.lookahead)break}if(n.match_length=0,n.lookahead>=3&&n.strstart>0&&(r=n.strstart-1,i=o[r],i===o[++r]&&i===o[++r]&&i===o[++r])){s=n.strstart+258;do{}while(i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&r<s);n.match_length=258-(s-r),n.match_length>n.lookahead&&(n.match_length=n.lookahead)}if(n.match_length>=3?(e=Oa(n,1,n.match_length-3),n.lookahead-=n.match_length,n.strstart+=n.match_length,n.match_length=0):(e=Oa(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++),e&&(dr(n,!1),0===n.strm.avail_out))return 1}return n.insert=0,t===Ra?(dr(n,!0),0===n.strm.avail_out?3:4):n.last_lit&&(dr(n,!1),0===n.strm.avail_out)?1:2})(r,t):qd[r.level].func(r,t);if((3===o||4===o)&&(r.status=666),1===o||3===o)return 0===n.avail_out&&(r.last_flush=-1),Do;if(2===o&&(t===lB?aB(r):t!==UE&&(sB(r,0,0,!1),t===cB&&(za(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),Ha(n),0===n.avail_out))return r.last_flush=-1,Do}return t!==Ra?Do:r.wrap<=0?VE:(2===r.wrap?(Vn(r,255&n.adler),Vn(r,n.adler>>8&255),Vn(r,n.adler>>16&255),Vn(r,n.adler>>24&255),Vn(r,255&n.total_in),Vn(r,n.total_in>>8&255),Vn(r,n.total_in>>16&255),Vn(r,n.total_in>>24&255)):(Gd(r,n.adler>>>16),Gd(r,65535&n.adler)),Ha(n),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?Do:VE)},Wd_deflateEnd=n=>{if(!n||!n.state)return Fs;const t=n.state.status;return 42!==t&&69!==t&&73!==t&&91!==t&&103!==t&&113!==t&&666!==t?La(n,Fs):(n.state=null,113===t?La(n,uB):Do)},Wd_deflateSetDictionary=(n,t)=>{let e=t.length;if(!n||!n.state)return Fs;const i=n.state,r=i.wrap;if(2===r||1===r&&42!==i.status||i.lookahead)return Fs;if(1===r&&(n.adler=Hd(n.adler,t,e,0)),i.wrap=0,e>=i.w_size){0===r&&(za(i.head),i.strstart=0,i.block_start=0,i.insert=0);let m=new Uint8Array(i.w_size);m.set(t.subarray(e-i.w_size,e),0),t=m,e=i.w_size}const s=n.avail_in,o=n.next_in,c=n.input;for(n.avail_in=e,n.next_in=0,n.input=t,Ll(i);i.lookahead>=3;){let m=i.strstart,I=i.lookahead-2;do{i.ins_h=ja(i,i.ins_h,i.window[m+3-1]),i.prev[m&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=m,m++}while(--I);i.strstart=m,i.lookahead=2,Ll(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,n.next_in=o,n.input=c,n.avail_in=s,i.wrap=r,Do};const WB=(n,t)=>Object.prototype.hasOwnProperty.call(n,t);var Ap_assign=function(n){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const e=t.shift();if(e){if("object"!=typeof e)throw new TypeError(e+"must be non-object");for(const i in e)WB(e,i)&&(n[i]=e[i])}}return n},Ap_flattenChunks=n=>{let t=0;for(let i=0,r=n.length;i<r;i++)t+=n[i].length;const e=new Uint8Array(t);for(let i=0,r=0,s=n.length;i<s;i++){let o=n[i];e.set(o,r),r+=o.length}return e};let ZE=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(n){ZE=!1}const Kd=new Uint8Array(256);for(let n=0;n<256;n++)Kd[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;Kd[254]=Kd[254]=1;var Yd_string2buf=n=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(n);let t,e,i,r,s,o=n.length,c=0;for(r=0;r<o;r++)e=n.charCodeAt(r),55296==(64512&e)&&r+1<o&&(i=n.charCodeAt(r+1),56320==(64512&i)&&(e=65536+(e-55296<<10)+(i-56320),r++)),c+=e<128?1:e<2048?2:e<65536?3:4;for(t=new Uint8Array(c),s=0,r=0;s<c;r++)e=n.charCodeAt(r),55296==(64512&e)&&r+1<o&&(i=n.charCodeAt(r+1),56320==(64512&i)&&(e=65536+(e-55296<<10)+(i-56320),r++)),e<128?t[s++]=e:e<2048?(t[s++]=192|e>>>6,t[s++]=128|63&e):e<65536?(t[s++]=224|e>>>12,t[s++]=128|e>>>6&63,t[s++]=128|63&e):(t[s++]=240|e>>>18,t[s++]=128|e>>>12&63,t[s++]=128|e>>>6&63,t[s++]=128|63&e);return t},Yd_buf2string=(n,t)=>{const e=t||n.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(n.subarray(0,t));let i,r;const s=new Array(2*e);for(r=0,i=0;i<e;){let o=n[i++];if(o<128){s[r++]=o;continue}let c=Kd[o];if(c>4)s[r++]=65533,i+=c-1;else{for(o&=2===c?31:3===c?15:7;c>1&&i<e;)o=o<<6|63&n[i++],c--;c>1?s[r++]=65533:o<65536?s[r++]=o:(o-=65536,s[r++]=55296|o>>10&1023,s[r++]=56320|1023&o)}}return((n,t)=>{if(t<65534&&n.subarray&&ZE)return String.fromCharCode.apply(null,n.length===t?n:n.subarray(0,t));let e="";for(let i=0;i<t;i++)e+=String.fromCharCode(n[i]);return e})(s,r)},Yd_utf8border=(n,t)=>{(t=t||n.length)>n.length&&(t=n.length);let e=t-1;for(;e>=0&&128==(192&n[e]);)e--;return e<0||0===e?t:e+Kd[n[e]]>t?e:t},XE=function eL(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const QE=Object.prototype.toString,{Z_NO_FLUSH:tL,Z_SYNC_FLUSH:nL,Z_FULL_FLUSH:iL,Z_FINISH:rL,Z_OK:Pp,Z_STREAM_END:sL,Z_DEFAULT_COMPRESSION:oL,Z_DEFAULT_STRATEGY:aL,Z_DEFLATED:lL}=Fl;function Zd(n){this.options=Ap_assign({level:oL,method:lL,chunkSize:16384,windowBits:15,memLevel:8,strategy:aL},n||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new XE,this.strm.avail_out=0;let e=Wd_deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(e!==Pp)throw new Error(Nl[e]);if(t.header&&Wd_deflateSetHeader(this.strm,t.header),t.dictionary){let i;if(i="string"==typeof t.dictionary?Yd_string2buf(t.dictionary):"[object ArrayBuffer]"===QE.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,e=Wd_deflateSetDictionary(this.strm,i),e!==Pp)throw new Error(Nl[e]);this._dict_set=!0}}function M0(n,t){const e=new Zd(t);if(e.push(n,!0),e.err)throw e.msg||Nl[e.err];return e.result}Zd.prototype.push=function(n,t){const e=this.strm,i=this.options.chunkSize;let r,s;if(this.ended)return!1;for(s=t===~~t?t:!0===t?rL:tL,e.input="string"==typeof n?Yd_string2buf(n):"[object ArrayBuffer]"===QE.call(n)?new Uint8Array(n):n,e.next_in=0,e.avail_in=e.input.length;;)if(0===e.avail_out&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),(s===nL||s===iL)&&e.avail_out<=6)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else{if(r=Wd_deflate(e,s),r===sL)return e.next_out>0&&this.onData(e.output.subarray(0,e.next_out)),r=Wd_deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===Pp;if(0!==e.avail_out){if(s>0&&e.next_out>0)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else if(0===e.avail_in)break}else this.onData(e.output)}return!0},Zd.prototype.onData=function(n){this.chunks.push(n)},Zd.prototype.onEnd=function(n){n===Pp&&(this.result=Ap_flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};var mL={Deflate:Zd,deflate:M0,deflateRaw:function cL(n,t){return(t=t||{}).raw=!0,M0(n,t)},gzip:function uL(n,t){return(t=t||{}).gzip=!0,M0(n,t)},constants:Fl},$L=function(t,e){let i,r,s,o,c,m,I,Z,fe,pe,ye,we,Me,Oe,Be,ke,ze,je,st,ot,tt,_t,Je,at;const ft=t.state;i=t.next_in,Je=t.input,r=i+(t.avail_in-5),s=t.next_out,at=t.output,o=s-(e-t.avail_out),c=s+(t.avail_out-257),m=ft.dmax,I=ft.wsize,Z=ft.whave,fe=ft.wnext,pe=ft.window,ye=ft.hold,we=ft.bits,Me=ft.lencode,Oe=ft.distcode,Be=(1<<ft.lenbits)-1,ke=(1<<ft.distbits)-1;e:do{we<15&&(ye+=Je[i++]<<we,we+=8,ye+=Je[i++]<<we,we+=8),ze=Me[ye&Be];t:for(;;){if(je=ze>>>24,ye>>>=je,we-=je,je=ze>>>16&255,0===je)at[s++]=65535&ze;else{if(!(16&je)){if(0==(64&je)){ze=Me[(65535&ze)+(ye&(1<<je)-1)];continue t}if(32&je){ft.mode=12;break e}t.msg="invalid literal/length code",ft.mode=30;break e}st=65535&ze,je&=15,je&&(we<je&&(ye+=Je[i++]<<we,we+=8),st+=ye&(1<<je)-1,ye>>>=je,we-=je),we<15&&(ye+=Je[i++]<<we,we+=8,ye+=Je[i++]<<we,we+=8),ze=Oe[ye&ke];n:for(;;){if(je=ze>>>24,ye>>>=je,we-=je,je=ze>>>16&255,!(16&je)){if(0==(64&je)){ze=Oe[(65535&ze)+(ye&(1<<je)-1)];continue n}t.msg="invalid distance code",ft.mode=30;break e}if(ot=65535&ze,je&=15,we<je&&(ye+=Je[i++]<<we,we+=8,we<je&&(ye+=Je[i++]<<we,we+=8)),ot+=ye&(1<<je)-1,ot>m){t.msg="invalid distance too far back",ft.mode=30;break e}if(ye>>>=je,we-=je,je=s-o,ot>je){if(je=ot-je,je>Z&&ft.sane){t.msg="invalid distance too far back",ft.mode=30;break e}if(tt=0,_t=pe,0===fe){if(tt+=I-je,je<st){st-=je;do{at[s++]=pe[tt++]}while(--je);tt=s-ot,_t=at}}else if(fe<je){if(tt+=I+fe-je,je-=fe,je<st){st-=je;do{at[s++]=pe[tt++]}while(--je);if(tt=0,fe<st){je=fe,st-=je;do{at[s++]=pe[tt++]}while(--je);tt=s-ot,_t=at}}}else if(tt+=fe-je,je<st){st-=je;do{at[s++]=pe[tt++]}while(--je);tt=s-ot,_t=at}for(;st>2;)at[s++]=_t[tt++],at[s++]=_t[tt++],at[s++]=_t[tt++],st-=3;st&&(at[s++]=_t[tt++],st>1&&(at[s++]=_t[tt++]))}else{tt=s-ot;do{at[s++]=at[tt++],at[s++]=at[tt++],at[s++]=at[tt++],st-=3}while(st>2);st&&(at[s++]=at[tt++],st>1&&(at[s++]=at[tt++]))}break}}break}}while(i<r&&s<c);st=we>>3,i-=st,we-=st<<3,ye&=(1<<we)-1,t.next_in=i,t.next_out=s,t.avail_in=i<r?r-i+5:5-(i-r),t.avail_out=s<c?c-s+257:257-(s-c),ft.hold=ye,ft.bits=we};const vL=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),bL=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),yL=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),CL=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Xd=(n,t,e,i,r,s,o,c)=>{const m=c.bits;let ze,je,st,ot,tt,at,I=0,Z=0,fe=0,pe=0,ye=0,we=0,Me=0,Oe=0,Be=0,ke=0,_t=null,Je=0;const ft=new Uint16Array(16),Ut=new Uint16Array(16);let Nn,bt,wt,zt=null,fn=0;for(I=0;I<=15;I++)ft[I]=0;for(Z=0;Z<i;Z++)ft[t[e+Z]]++;for(ye=m,pe=15;pe>=1&&0===ft[pe];pe--);if(ye>pe&&(ye=pe),0===pe)return r[s++]=20971520,r[s++]=20971520,c.bits=1,0;for(fe=1;fe<pe&&0===ft[fe];fe++);for(ye<fe&&(ye=fe),Oe=1,I=1;I<=15;I++)if(Oe<<=1,Oe-=ft[I],Oe<0)return-1;if(Oe>0&&(0===n||1!==pe))return-1;for(Ut[1]=0,I=1;I<15;I++)Ut[I+1]=Ut[I]+ft[I];for(Z=0;Z<i;Z++)0!==t[e+Z]&&(o[Ut[t[e+Z]]++]=Z);if(0===n?(_t=zt=o,at=19):1===n?(_t=vL,Je-=257,zt=bL,fn-=257,at=256):(_t=yL,zt=CL,at=-1),ke=0,Z=0,I=fe,tt=s,we=ye,Me=0,st=-1,Be=1<<ye,ot=Be-1,1===n&&Be>852||2===n&&Be>592)return 1;for(;;){Nn=I-Me,o[Z]<at?(bt=0,wt=o[Z]):o[Z]>at?(bt=zt[fn+o[Z]],wt=_t[Je+o[Z]]):(bt=96,wt=0),ze=1<<I-Me,je=1<<we,fe=je;do{je-=ze,r[tt+(ke>>Me)+je]=Nn<<24|bt<<16|wt|0}while(0!==je);for(ze=1<<I-1;ke&ze;)ze>>=1;if(0!==ze?(ke&=ze-1,ke+=ze):ke=0,Z++,0==--ft[I]){if(I===pe)break;I=t[e+o[Z]]}if(I>ye&&(ke&ot)!==st){for(0===Me&&(Me=ye),tt+=fe,we=I-Me,Oe=1<<we;we+Me<pe&&(Oe-=ft[we+Me],!(Oe<=0));)we++,Oe<<=1;if(Be+=1<<we,1===n&&Be>852||2===n&&Be>592)return 1;st=ke&ot,r[st]=ye<<24|we<<16|tt-s|0}}return 0!==ke&&(r[tt+ke]=I-Me<<24|64<<16|0),c.bits=ye,0};const{Z_FINISH:s3,Z_BLOCK:wL,Z_TREES:Fp,Z_OK:zl,Z_STREAM_END:EL,Z_NEED_DICT:TL,Z_STREAM_ERROR:Os,Z_DATA_ERROR:o3,Z_MEM_ERROR:a3,Z_BUF_ERROR:IL,Z_DEFLATED:l3}=Fl,A3=n=>(n>>>24&255)+(n>>>8&65280)+((65280&n)<<8)+((255&n)<<24);function AL(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const P3=n=>{if(!n||!n.state)return Os;const t=n.state;return n.total_in=n.total_out=t.total=0,n.msg="",t.wrap&&(n.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,zl},N3=n=>{if(!n||!n.state)return Os;const t=n.state;return t.wsize=0,t.whave=0,t.wnext=0,P3(n)},F3=(n,t)=>{let e;if(!n||!n.state)return Os;const i=n.state;return t<0?(e=0,t=-t):(e=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Os:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=e,i.wbits=t,N3(n))},O3=(n,t)=>{if(!n)return Os;const e=new AL;n.state=e,e.window=null;const i=F3(n,t);return i!==zl&&(n.state=null),i};let N0,F0,R3=!0;const NL=n=>{if(R3){N0=new Int32Array(512),F0=new Int32Array(32);let t=0;for(;t<144;)n.lens[t++]=8;for(;t<256;)n.lens[t++]=9;for(;t<280;)n.lens[t++]=7;for(;t<288;)n.lens[t++]=8;for(Xd(1,n.lens,0,288,N0,0,n.work,{bits:9}),t=0;t<32;)n.lens[t++]=5;Xd(2,n.lens,0,32,F0,0,n.work,{bits:5}),R3=!1}n.lencode=N0,n.lenbits=9,n.distcode=F0,n.distbits=5},B3=(n,t,e,i)=>{let r;const s=n.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),i>=s.wsize?(s.window.set(t.subarray(e-s.wsize,e),0),s.wnext=0,s.whave=s.wsize):(r=s.wsize-s.wnext,r>i&&(r=i),s.window.set(t.subarray(e-i,e-i+r),s.wnext),(i-=r)?(s.window.set(t.subarray(e-i,e),0),s.wnext=i,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0};var aa_inflateReset=N3,aa_inflateInit2=O3,aa_inflate=(n,t)=>{let e,i,r,s,o,c,m,I,Z,fe,pe,ye,we,Me,Be,ke,ze,je,st,ot,tt,_t,Oe=0;const Je=new Uint8Array(4);let at,ft;const Ut=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!n||!n.state||!n.output||!n.input&&0!==n.avail_in)return Os;e=n.state,12===e.mode&&(e.mode=13),o=n.next_out,r=n.output,m=n.avail_out,s=n.next_in,i=n.input,c=n.avail_in,I=e.hold,Z=e.bits,fe=c,pe=m,_t=zl;e:for(;;)switch(e.mode){case 1:if(0===e.wrap){e.mode=13;break}for(;Z<16;){if(0===c)break e;c--,I+=i[s++]<<Z,Z+=8}if(2&e.wrap&&35615===I){e.check=0,Je[0]=255&I,Je[1]=I>>>8&255,e.check=rr(e.check,Je,2,0),I=0,Z=0,e.mode=2;break}if(e.flags=0,e.head&&(e.head.done=!1),!(1&e.wrap)||(((255&I)<<8)+(I>>8))%31){n.msg="incorrect header check",e.mode=30;break}if((15&I)!==l3){n.msg="unknown compression method",e.mode=30;break}if(I>>>=4,Z-=4,tt=8+(15&I),0===e.wbits)e.wbits=tt;else if(tt>e.wbits){n.msg="invalid window size",e.mode=30;break}e.dmax=1<<e.wbits,n.adler=e.check=1,e.mode=512&I?10:12,I=0,Z=0;break;case 2:for(;Z<16;){if(0===c)break e;c--,I+=i[s++]<<Z,Z+=8}if(e.flags=I,(255&e.flags)!==l3){n.msg="unknown compression method",e.mode=30;break}if(57344&e.flags){n.msg="unknown header flags set",e.mode=30;break}e.head&&(e.head.text=I>>8&1),512&e.flags&&(Je[0]=255&I,Je[1]=I>>>8&255,e.check=rr(e.check,Je,2,0)),I=0,Z=0,e.mode=3;case 3:for(;Z<32;){if(0===c)break e;c--,I+=i[s++]<<Z,Z+=8}e.head&&(e.head.time=I),512&e.flags&&(Je[0]=255&I,Je[1]=I>>>8&255,Je[2]=I>>>16&255,Je[3]=I>>>24&255,e.check=rr(e.check,Je,4,0)),I=0,Z=0,e.mode=4;case 4:for(;Z<16;){if(0===c)break e;c--,I+=i[s++]<<Z,Z+=8}e.head&&(e.head.xflags=255&I,e.head.os=I>>8),512&e.flags&&(Je[0]=255&I,Je[1]=I>>>8&255,e.check=rr(e.check,Je,2,0)),I=0,Z=0,e.mode=5;case 5:if(1024&e.flags){for(;Z<16;){if(0===c)break e;c--,I+=i[s++]<<Z,Z+=8}e.length=I,e.head&&(e.head.extra_len=I),512&e.flags&&(Je[0]=255&I,Je[1]=I>>>8&255,e.check=rr(e.check,Je,2,0)),I=0,Z=0}else e.head&&(e.head.extra=null);e.mode=6;case 6:if(1024&e.flags&&(ye=e.length,ye>c&&(ye=c),ye&&(e.head&&(tt=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(i.subarray(s,s+ye),tt)),512&e.flags&&(e.check=rr(e.check,i,ye,s)),c-=ye,s+=ye,e.length-=ye),e.length))break e;e.length=0,e.mode=7;case 7:if(2048&e.flags){if(0===c)break e;ye=0;do{tt=i[s+ye++],e.head&&tt&&e.length<65536&&(e.head.name+=String.fromCharCode(tt))}while(tt&&ye<c);if(512&e.flags&&(e.check=rr(e.check,i,ye,s)),c-=ye,s+=ye,tt)break e}else e.head&&(e.head.name=null);e.length=0,e.mode=8;case 8:if(4096&e.flags){if(0===c)break e;ye=0;do{tt=i[s+ye++],e.head&&tt&&e.length<65536&&(e.head.comment+=String.fromCharCode(tt))}while(tt&&ye<c);if(512&e.flags&&(e.check=rr(e.check,i,ye,s)),c-=ye,s+=ye,tt)break e}else e.head&&(e.head.comment=null);e.mode=9;case 9:if(512&e.flags){for(;Z<16;){if(0===c)break e;c--,I+=i[s++]<<Z,Z+=8}if(I!==(65535&e.check)){n.msg="header crc mismatch",e.mode=30;break}I=0,Z=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),n.adler=e.check=0,e.mode=12;break;case 10:for(;Z<32;){if(0===c)break e;c--,I+=i[s++]<<Z,Z+=8}n.adler=e.check=A3(I),I=0,Z=0,e.mode=11;case 11:if(0===e.havedict)return n.next_out=o,n.avail_out=m,n.next_in=s,n.avail_in=c,e.hold=I,e.bits=Z,TL;n.adler=e.check=1,e.mode=12;case 12:if(t===wL||t===Fp)break e;case 13:if(e.last){I>>>=7&Z,Z-=7&Z,e.mode=27;break}for(;Z<3;){if(0===c)break e;c--,I+=i[s++]<<Z,Z+=8}switch(e.last=1&I,I>>>=1,Z-=1,3&I){case 0:e.mode=14;break;case 1:if(NL(e),e.mode=20,t===Fp){I>>>=2,Z-=2;break e}break;case 2:e.mode=17;break;case 3:n.msg="invalid block type",e.mode=30}I>>>=2,Z-=2;break;case 14:for(I>>>=7&Z,Z-=7&Z;Z<32;){if(0===c)break e;c--,I+=i[s++]<<Z,Z+=8}if((65535&I)!=(I>>>16^65535)){n.msg="invalid stored block lengths",e.mode=30;break}if(e.length=65535&I,I=0,Z=0,e.mode=15,t===Fp)break e;case 15:e.mode=16;case 16:if(ye=e.length,ye){if(ye>c&&(ye=c),ye>m&&(ye=m),0===ye)break e;r.set(i.subarray(s,s+ye),o),c-=ye,s+=ye,m-=ye,o+=ye,e.length-=ye;break}e.mode=12;break;case 17:for(;Z<14;){if(0===c)break e;c--,I+=i[s++]<<Z,Z+=8}if(e.nlen=257+(31&I),I>>>=5,Z-=5,e.ndist=1+(31&I),I>>>=5,Z-=5,e.ncode=4+(15&I),I>>>=4,Z-=4,e.nlen>286||e.ndist>30){n.msg="too many length or distance symbols",e.mode=30;break}e.have=0,e.mode=18;case 18:for(;e.have<e.ncode;){for(;Z<3;){if(0===c)break e;c--,I+=i[s++]<<Z,Z+=8}e.lens[Ut[e.have++]]=7&I,I>>>=3,Z-=3}for(;e.have<19;)e.lens[Ut[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,at={bits:e.lenbits},_t=Xd(0,e.lens,0,19,e.lencode,0,e.work,at),e.lenbits=at.bits,_t){n.msg="invalid code lengths set",e.mode=30;break}e.have=0,e.mode=19;case 19:for(;e.have<e.nlen+e.ndist;){for(;Oe=e.lencode[I&(1<<e.lenbits)-1],Be=Oe>>>24,ke=Oe>>>16&255,ze=65535&Oe,!(Be<=Z);){if(0===c)break e;c--,I+=i[s++]<<Z,Z+=8}if(ze<16)I>>>=Be,Z-=Be,e.lens[e.have++]=ze;else{if(16===ze){for(ft=Be+2;Z<ft;){if(0===c)break e;c--,I+=i[s++]<<Z,Z+=8}if(I>>>=Be,Z-=Be,0===e.have){n.msg="invalid bit length repeat",e.mode=30;break}tt=e.lens[e.have-1],ye=3+(3&I),I>>>=2,Z-=2}else if(17===ze){for(ft=Be+3;Z<ft;){if(0===c)break e;c--,I+=i[s++]<<Z,Z+=8}I>>>=Be,Z-=Be,tt=0,ye=3+(7&I),I>>>=3,Z-=3}else{for(ft=Be+7;Z<ft;){if(0===c)break e;c--,I+=i[s++]<<Z,Z+=8}I>>>=Be,Z-=Be,tt=0,ye=11+(127&I),I>>>=7,Z-=7}if(e.have+ye>e.nlen+e.ndist){n.msg="invalid bit length repeat",e.mode=30;break}for(;ye--;)e.lens[e.have++]=tt}}if(30===e.mode)break;if(0===e.lens[256]){n.msg="invalid code -- missing end-of-block",e.mode=30;break}if(e.lenbits=9,at={bits:e.lenbits},_t=Xd(1,e.lens,0,e.nlen,e.lencode,0,e.work,at),e.lenbits=at.bits,_t){n.msg="invalid literal/lengths set",e.mode=30;break}if(e.distbits=6,e.distcode=e.distdyn,at={bits:e.distbits},_t=Xd(2,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,at),e.distbits=at.bits,_t){n.msg="invalid distances set",e.mode=30;break}if(e.mode=20,t===Fp)break e;case 20:e.mode=21;case 21:if(c>=6&&m>=258){n.next_out=o,n.avail_out=m,n.next_in=s,n.avail_in=c,e.hold=I,e.bits=Z,$L(n,pe),o=n.next_out,r=n.output,m=n.avail_out,s=n.next_in,i=n.input,c=n.avail_in,I=e.hold,Z=e.bits,12===e.mode&&(e.back=-1);break}for(e.back=0;Oe=e.lencode[I&(1<<e.lenbits)-1],Be=Oe>>>24,ke=Oe>>>16&255,ze=65535&Oe,!(Be<=Z);){if(0===c)break e;c--,I+=i[s++]<<Z,Z+=8}if(ke&&0==(240&ke)){for(je=Be,st=ke,ot=ze;Oe=e.lencode[ot+((I&(1<<je+st)-1)>>je)],Be=Oe>>>24,ke=Oe>>>16&255,ze=65535&Oe,!(je+Be<=Z);){if(0===c)break e;c--,I+=i[s++]<<Z,Z+=8}I>>>=je,Z-=je,e.back+=je}if(I>>>=Be,Z-=Be,e.back+=Be,e.length=ze,0===ke){e.mode=26;break}if(32&ke){e.back=-1,e.mode=12;break}if(64&ke){n.msg="invalid literal/length code",e.mode=30;break}e.extra=15&ke,e.mode=22;case 22:if(e.extra){for(ft=e.extra;Z<ft;){if(0===c)break e;c--,I+=i[s++]<<Z,Z+=8}e.length+=I&(1<<e.extra)-1,I>>>=e.extra,Z-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=23;case 23:for(;Oe=e.distcode[I&(1<<e.distbits)-1],Be=Oe>>>24,ke=Oe>>>16&255,ze=65535&Oe,!(Be<=Z);){if(0===c)break e;c--,I+=i[s++]<<Z,Z+=8}if(0==(240&ke)){for(je=Be,st=ke,ot=ze;Oe=e.distcode[ot+((I&(1<<je+st)-1)>>je)],Be=Oe>>>24,ke=Oe>>>16&255,ze=65535&Oe,!(je+Be<=Z);){if(0===c)break e;c--,I+=i[s++]<<Z,Z+=8}I>>>=je,Z-=je,e.back+=je}if(I>>>=Be,Z-=Be,e.back+=Be,64&ke){n.msg="invalid distance code",e.mode=30;break}e.offset=ze,e.extra=15&ke,e.mode=24;case 24:if(e.extra){for(ft=e.extra;Z<ft;){if(0===c)break e;c--,I+=i[s++]<<Z,Z+=8}e.offset+=I&(1<<e.extra)-1,I>>>=e.extra,Z-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){n.msg="invalid distance too far back",e.mode=30;break}e.mode=25;case 25:if(0===m)break e;if(ye=pe-m,e.offset>ye){if(ye=e.offset-ye,ye>e.whave&&e.sane){n.msg="invalid distance too far back",e.mode=30;break}ye>e.wnext?(ye-=e.wnext,we=e.wsize-ye):we=e.wnext-ye,ye>e.length&&(ye=e.length),Me=e.window}else Me=r,we=o-e.offset,ye=e.length;ye>m&&(ye=m),m-=ye,e.length-=ye;do{r[o++]=Me[we++]}while(--ye);0===e.length&&(e.mode=21);break;case 26:if(0===m)break e;r[o++]=e.length,m--,e.mode=21;break;case 27:if(e.wrap){for(;Z<32;){if(0===c)break e;c--,I|=i[s++]<<Z,Z+=8}if(pe-=m,n.total_out+=pe,e.total+=pe,pe&&(n.adler=e.check=e.flags?rr(e.check,r,pe,o-pe):Hd(e.check,r,pe,o-pe)),pe=m,(e.flags?I:A3(I))!==e.check){n.msg="incorrect data check",e.mode=30;break}I=0,Z=0}e.mode=28;case 28:if(e.wrap&&e.flags){for(;Z<32;){if(0===c)break e;c--,I+=i[s++]<<Z,Z+=8}if(I!==(4294967295&e.total)){n.msg="incorrect length check",e.mode=30;break}I=0,Z=0}e.mode=29;case 29:_t=EL;break e;case 30:_t=o3;break e;case 31:return a3;default:return Os}return n.next_out=o,n.avail_out=m,n.next_in=s,n.avail_in=c,e.hold=I,e.bits=Z,(e.wsize||pe!==n.avail_out&&e.mode<30&&(e.mode<27||t!==s3))&&B3(n,n.output,n.next_out,pe-n.avail_out),fe-=n.avail_in,pe-=n.avail_out,n.total_in+=fe,n.total_out+=pe,e.total+=pe,e.wrap&&pe&&(n.adler=e.check=e.flags?rr(e.check,r,pe,n.next_out-pe):Hd(e.check,r,pe,n.next_out-pe)),n.data_type=e.bits+(e.last?64:0)+(12===e.mode?128:0)+(20===e.mode||15===e.mode?256:0),(0===fe&&0===pe||t===s3)&&_t===zl&&(_t=IL),_t},aa_inflateEnd=n=>{if(!n||!n.state)return Os;let t=n.state;return t.window&&(t.window=null),n.state=null,zl},aa_inflateGetHeader=(n,t)=>{if(!n||!n.state)return Os;const e=n.state;return 0==(2&e.wrap)?Os:(e.head=t,t.done=!1,zl)},aa_inflateSetDictionary=(n,t)=>{const e=t.length;let i,r,s;return n&&n.state&&(i=n.state,0===i.wrap||11===i.mode)?11===i.mode&&(r=1,r=Hd(r,t,e,0),r!==i.check)?o3:(s=B3(n,t,e,e),s?(i.mode=31,a3):(i.havedict=1,zl)):Os},ZL=function YL(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const L3=Object.prototype.toString,{Z_NO_FLUSH:XL,Z_FINISH:QL,Z_OK:Qd,Z_STREAM_END:O0,Z_NEED_DICT:R0,Z_STREAM_ERROR:JL,Z_DATA_ERROR:z3,Z_MEM_ERROR:e9}=Fl;function Jd(n){this.options=Ap_assign({chunkSize:65536,windowBits:15,to:""},n||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(n&&n.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new XE,this.strm.avail_out=0;let e=aa_inflateInit2(this.strm,t.windowBits);if(e!==Qd)throw new Error(Nl[e]);if(this.header=new ZL,aa_inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=Yd_string2buf(t.dictionary):"[object ArrayBuffer]"===L3.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(e=aa_inflateSetDictionary(this.strm,t.dictionary),e!==Qd)))throw new Error(Nl[e])}function B0(n,t){const e=new Jd(t);if(e.push(n),e.err)throw e.msg||Nl[e.err];return e.result}Jd.prototype.push=function(n,t){const e=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let s,o,c;if(this.ended)return!1;for(o=t===~~t?t:!0===t?QL:XL,e.input="[object ArrayBuffer]"===L3.call(n)?new Uint8Array(n):n,e.next_in=0,e.avail_in=e.input.length;;){for(0===e.avail_out&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),s=aa_inflate(e,o),s===R0&&r&&(s=aa_inflateSetDictionary(e,r),s===Qd?s=aa_inflate(e,o):s===z3&&(s=R0));e.avail_in>0&&s===O0&&e.state.wrap>0&&0!==n[e.next_in];)aa_inflateReset(e),s=aa_inflate(e,o);switch(s){case JL:case z3:case R0:case e9:return this.onEnd(s),this.ended=!0,!1}if(c=e.avail_out,e.next_out&&(0===e.avail_out||s===O0))if("string"===this.options.to){let m=Yd_utf8border(e.output,e.next_out),I=e.next_out-m,Z=Yd_buf2string(e.output,m);e.next_out=I,e.avail_out=i-I,I&&e.output.set(e.output.subarray(m,m+I),0),this.onData(Z)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(s!==Qd||0!==c){if(s===O0)return s=aa_inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(0===e.avail_in)break}}return!0},Jd.prototype.onData=function(n){this.chunks.push(n)},Jd.prototype.onEnd=function(n){n===Qd&&(this.result="string"===this.options.to?this.chunks.join(""):Ap_flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};var a9={Inflate:Jd,inflate:B0,inflateRaw:function t9(n,t){return(t=t||{}).raw=!0,B0(n,t)},ungzip:B0,constants:Fl};const{Deflate:l9}=mL,{Inflate:f9}=a9;var j3=l9,H3=f9;function L0(){return L0=(0,en.Z)(function*(n,t){const e=new j3({level:2,gzip:!0});try{return yield U3(e,n,t),e.result}catch(i){console.error(i)}return null}),L0.apply(this,arguments)}function z0(){return z0=(0,en.Z)(function*(n,t){const e=new H3;try{return yield U3(e,n,t),e.result}catch(i){console.error(i)}return null}),z0.apply(this,arguments)}function U3(n,t){return j0.apply(this,arguments)}function j0(){return j0=(0,en.Z)(function*(n,t,e=16384){let i=Math.ceil(t.byteLength/e),r=null;for(let s=0;s<i;s++)yield E9(),r=t.slice(s*e,(s+1)*e),n.push(r,i<=s+1);if(n.err)throw new Error(`error: ${n.err}`);return n}),j0.apply(this,arguments)}function E9(){return new Promise(n=>xr(n))}var vs,V3=X(2391);!function(n){n.encode=function t(i){try{return V3.encode(i)}catch(r){console.error(r,i)}return null},n.decode=function e(i){try{return V3.decode(i)}catch(r){console.error(r,i)}return null}}(vs||(vs={}));var ns,T9=X(9069);!function(n){let t=[];for(let i=0;i<256;i++)t[i]=(i<16?"0":"")+i.toString(16);n.generateUuid=function e(){const i=new Uint32Array(4);window.crypto.getRandomValues(i);const r=i[0],s=i[1],o=i[2],c=i[3];return t[255&r]+t[r>>8&255]+t[r>>16&255]+t[r>>24&255]+"-"+t[255&s]+t[s>>8&255]+"-"+t[s>>16&15|64]+t[s>>24&255]+"-"+t[63&o|128]+t[o>>8&255]+"-"+t[o>>16&255]+t[o>>24&255]+t[255&c]+t[c>>8&255]+t[c>>16&255]+t[c>>24&255]}}(ns||(ns={}));class la{constructor(t,e){this.timerMilliSecond=0,this.timeoutDate=0,this.isStopped=!1,this.callback=t,this.timerMilliSecond=e,this.reset()}get isActive(){return null!=this.timeoutTimer}stop(){this.isStopped=!0}clear(){this.callback=null,this.timerMilliSecond=0,this.timeoutDate=0,this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.isStopped=!1}reset(...t){1===t.length?this.timerMilliSecond=t[0]:1<t.length&&(this.callback=t[0],this.timerMilliSecond=t[1]),this.isStopped=!1;let e=this.timeoutDate;this.timeoutDate=performance.now()+this.timerMilliSecond,!(this.timeoutTimer&&e<=this.timeoutDate)&&this.setTimeout()}setTimeout(){this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.callback&&(this.timeoutTimer=setTimeout(()=>{this.timeoutTimer=null,!this.isStopped&&(performance.now()<this.timeoutDate?this.setTimeout():this.callback&&this.callback())},this.timeoutDate-performance.now()))}}class Lp{constructor(){}static add(t){this.monitoringConnections.add(t),t.updateStatsAsync(),this.restart()}static remove(t){this.monitoringConnections.delete(t)}static restart(){null==this.updateWebRTCStatsTimer?this.updateWebRTCStatsTimer=new la(()=>this.doMonitoringAsync(),this.calcIntervalTime()):this.updateWebRTCStatsTimer.isActive||this.updateWebRTCStatsTimer.reset(this.calcIntervalTime())}static calcIntervalTime(){return Math.min(2e3+1e3*this.monitoringConnections.size,1e4)}static doMonitoringAsync(){var t=this;return(0,en.Z)(function*(){for(let e of t.monitoringConnections)e.open?yield e.updateStatsAsync():t.remove(e);t.monitoringConnections.size<1?t.updateWebRTCStatsTimer=null:t.restart()})()}}Lp.updateWebRTCStatsTimer=null,Lp.monitoringConnections=new Set;var Rs=(()=>(function(n){n.UNKNOWN="unknown",n.RELAY="relay",n.PRFLX="prflx",n.SRFLX="srflx",n.HOST="host"}(Rs||(Rs={})),Rs))();class I9{constructor(t){this.peerConnection=t,this.candidateType=Rs.UNKNOWN}updateAsync(){var t=this;return(0,en.Z)(function*(){let e=null;try{e=yield t.peerConnection.getStats()}catch(pe){console.warn(pe)}if(null==e)return void(t.candidateType=Rs.UNKNOWN);let i=[],r=[],s=[],o=[],c=[],m=[],I=[];e.forEach(pe=>{0<=pe.type.indexOf("candidate-pair")&&i.push(pe),0<=pe.type.indexOf("local-candidate")&&r.push(pe),0<=pe.type.indexOf("remote-candidate")&&s.push(pe)}),i.forEach(pe=>{"succeeded"===pe.state&&(o.push(pe.localCandidateId),c.push(pe.remoteCandidateId))}),r.forEach(pe=>{o.includes(pe.id)&&m.push(pe)}),s.forEach(pe=>{c.includes(pe.id)&&I.push(pe)});let Z=Rs.UNKNOWN,fe=Object.values(Rs);m.concat(I).forEach(pe=>{let ye=fe.indexOf(pe.candidateType);fe.indexOf(Z)<ye&&(Z=fe[ye])}),t.candidateType=Z})()}}class G3 extends T9.EventEmitter{constructor(t){super(),this.conn=t,this.chunkSize=15872,this.receivedMap=new Map,this.timeoutTimer=null,this._timestamp=performance.now(),this._ping=0,this._candidateType=Rs.UNKNOWN,t.on("data",e=>this.onData(e)),t.on("open",()=>{this.stats=new I9(this.getPeerConnection()),this.clearTimeoutTimer(),function S9(n){n._dc&&n._sendBuffer&&(n._startSendLoop=M9)}(t),this.emit("open"),this.startMonitoring()}),t.on("close",()=>{this.clearTimeoutTimer(),this.emit("close")}),t.on("error",e=>{this.clearTimeoutTimer(),this.emit("error",e)}),this.setTimeoutTimer()}get open(){return this.conn.open}get remoteId(){return this.conn.remoteId}get metadata(){return this.conn.metadata}get bufferedAmount(){var t,e;return null!==(e=null===(t=this.conn._dc)||void 0===t?void 0:t.bufferedAmount)&&void 0!==e?e:0}get timestamp(){return this._timestamp}set timestamp(t){this._timestamp=t}get ping(){return this._ping}set ping(t){this._ping=t}get candidateType(){return this._candidateType}set candidateType(t){this._candidateType=t}close(){this.clearTimeoutTimer(),this.stopMonitoring(),this.conn.close()}send(t){let e=vs.encode(t),i=Math.ceil(e.byteLength/this.chunkSize);if(i<=1)return void this.conn.send(e);let r=ns.generateUuid(),s=null,o=null;for(let c=0;c<i;c++)s=e.slice(c*this.chunkSize,(c+1)*this.chunkSize),o={id:r,data:s,index:c,total:i},this.conn.send(vs.encode(o))}getPeerConnection(){return this.conn.getPeerConnection()}startMonitoring(){Lp.add(this)}stopMonitoring(){Lp.remove(this)}updateStatsAsync(){var t=this;return(0,en.Z)(function*(){null!=t.stats&&(t.sendPing(),yield t.stats.updateAsync(),t.candidateType=t.stats.candidateType,t.emit("stats",t.stats))})()}sendPing(){let t=vs.encode({from:this.remoteId,ping:performance.now()});this.conn.send(t)}receivePing(t){if(t.from===this.remoteId){let i=performance.now()-t.ping;this.ping=i<=this.ping?.5*this.ping+.5*i:i}else{let e=vs.encode(t);this.conn.send(e)}}onData(t){this.timestamp=performance.now();let e=vs.decode(new Uint8Array(t));if(null!=e.ping)return void this.receivePing(e);let r=e;if(null==r.id)return void this.emit("data",e);let s=this.receivedMap.get(r.id);if(null==s&&(s={id:r.id,chanks:new Array(r.total),length:0,byteLength:0},this.receivedMap.set(r.id,s)),null!=s.chanks[r.index]||(s.length++,s.byteLength+=r.data.byteLength,s.chanks[r.index]=r.data,s.length<r.total))return;this.receivedMap.delete(r.id);let o=new Uint8Array(s.byteLength),c=0;for(let I of s.chanks)o.set(I,c),c+=I.byteLength;let m=vs.decode(o);this.emit("data",m)}setTimeoutTimer(){this.clearTimeoutTimer(),this.timeoutTimer=setTimeout(()=>{console.warn(`timeout ${this.conn.remoteId}`),this.timeoutTimer=null,this.emit("close")},15e3)}clearTimeoutTimer(){null!=this.timeoutTimer&&(clearTimeout(this.timeoutTimer),this.timeoutTimer=null)}}function M9(){this.sendInterval||(this.sendInterval=xr(q3.bind(this)))}function q3(){const n=this._sendBuffer.shift();try{this._dc.send(n)}catch(t){this._sendBuffer.push(n)}this.sendInterval=0===this._sendBuffer.length?void 0:xr(q3.bind(this))}class k9{constructor(){this._peerIds=[],this.peerContext=pi.parse("???"),this.peerContexts=[],this.callback=new _E,this.bandwidthUsage=0,this.key="",this.connections=[],this.listAllPeersCache=[],this.httpRequestInterval=performance.now()+500,this.outboundQueue=Promise.resolve(),this.inboundQueue=Promise.resolve(),this.relayingPeerIds=new Map,this.maybeUnavailablePeerIds=new Set}get peerId(){return this.peerContext?this.peerContext.peerId:"???"}get peerIds(){return this._peerIds}open(...t){console.log("open",t),this.peerContext=0===t.length?pi.create(pi.generateId()):1===t.length?pi.create(t[0]):pi.create(t[0],t[1],t[2],t[3]),this.openPeer()}close(){this.peer&&this.peer.destroy(),this.disconnectAll(),this.peer=null,this.peerContext=pi.parse("???")}connect(t){if(!this.shouldConnect(t))return!1;let e=new G3(this.peer.connect(t,{serialization:"none",metadata:{sendFrom:this.peerId}}));return this.openDataConnection(e),!0}shouldConnect(t){return this.peerContext&&this.peer&&this.peerId?this.peerId===t?(console.log("connect() is Fail. "+t+" is me."),!1):this.findDataConnection(t)?(console.log("connect() is Fail. <"+t+"> is already connecting."),!1):!(!t||!t.length||t===this.peerId):(console.log("connect() is Fail. ID\u304c\u5272\u308a\u632f\u3089\u308c\u308b\u307e\u3067\u5f85\u3066\u3084"),!1)}disconnect(t){let e=this.findDataConnection(t);return!!e&&(this.closeDataConnection(e),!0)}disconnectAll(){console.log("<closeAllDataConnection()>");for(let t of this.connections.concat())this.closeDataConnection(t)}send(t,e){var i=this;if(this.connections.length<1)return;let r={data:vs.encode(t),ttl:1},s=r.data.byteLength;this.bandwidthUsage+=s,this.outboundQueue=this.outboundQueue.then(()=>new Promise((o,c)=>{xr((0,en.Z)(function*(){if(1024<r.data.byteLength&&Array.isArray(t)&&1<t.length){let m=yield function x9(n,t){return L0.apply(this,arguments)}(r.data);m.byteLength<r.data.byteLength&&(r.data=m,r.isCompressed=!0)}return e?i.sendUnicast(r,e):i.sendBroadcast(r),i.bandwidthUsage-=s,o()}))}))}sendUnicast(t,e){t.ttl=0;let i=this.findDataConnection(e);i&&i.open&&i.send(t)}sendBroadcast(t){for(let e of this.connections)e.open&&e.send(t)}setApiKey(t){this.key!==t&&console.log("Key Change"),this.key=t}listAllPeers(){return new Promise((t,e)=>{if(!this.peer)return t([]);let i=performance.now();if(i<this.httpRequestInterval)return console.warn("httpRequestInterval... "+(this.httpRequestInterval-i)),void t(this.listAllPeersCache.concat());this.httpRequestInterval=i+6e3,this.peer.listAllPeers(r=>{this.listAllPeersCache=r.concat(),t(r)})})}openPeer(){this.peer&&(console.warn("It is already opened."),this.close());let t=new Peer(this.peerContext.peerId,{key:this.key});t.on("open",e=>{console.log("My peer ID is: "+e),(!this.peerContext||this.peerContext.peerId!==e)&&(this.peerContext=pi.parse(e)),this.peerContext.isOpen=!0,console.log("My peer Context",this.peerContext),this.callback.onOpen&&this.callback.onOpen(this.peerId)}),t.on("close",()=>{console.log("Peer close"),this.peerContext&&this.peerContext.isOpen&&(this.peerContext.isOpen=!1,this.callback.onClose&&this.callback.onClose(this.peerId))}),t.on("connection",e=>{this.openDataConnection(new G3(e))}),t.on("error",e=>{console.error("<"+this.peerId+"> "+e.type+" => "+e.message);let i=`${this.getSkyWayErrorMessage(e.type)}\n\n${e.type}: ${e.message}`;switch(e.type){case"peer-unavailable":let r=/"(.+)"/.exec(e.message)[1];this.disconnect(r);break;case"disconnected":case"socket-error":case"unavailable-id":case"authentication":case"server-error":this.peerContext&&this.peerContext.isOpen&&(this.close(),this.callback.onClose&&this.callback.onClose(this.peerId))}this.callback.onError&&this.callback.onError(this.peerId,e.type,i,e)}),this.peer=t}openDataConnection(t){if(!1===this.addDataConnection(t))return;let e=this.connections.indexOf(t),i=null;0<=e&&(i=this.peerContexts[e]),this.maybeUnavailablePeerIds.add(t.remoteId),t.on("data",r=>{this.onData(t,r)}),t.on("open",()=>{this.maybeUnavailablePeerIds.delete(t.remoteId),i&&(i.isOpen=!0),this.updatePeerList(),this.callback.onConnect&&this.callback.onConnect(t.remoteId)}),t.on("close",()=>{this.closeDataConnection(t)}),t.on("error",()=>{this.closeDataConnection(t)}),t.on("stats",()=>{let r=performance.now()-t.timestamp,s=r<=1e4?1:5e3/(r-1e4+5e3),o=s<1?r:t.ping,c=500/(o+500);switch(i.session.health=s,i.session.ping=o,i.session.speed=c*s,t.candidateType){case Rs.HOST:i.session.grade=Fa.HIGH;break;case Rs.SRFLX:case Rs.PRFLX:i.session.grade=Fa.MIDDLE;break;case Rs.RELAY:i.session.grade=Fa.LOW;break;default:i.session.grade=Fa.UNSPECIFIED}i.session.description=t.candidateType,i.session.health<.2&&this.closeDataConnection(t)})}closeDataConnection(t){t.close();let e=this.connections.indexOf(t);0<=e&&(console.log(t.remoteId+" is \u3048\u3093\u3044\u30fcindex:"+e+" length:"+this.connections.length),this.connections.splice(e,1),this.peerContexts.splice(e,1)),this.relayingPeerIds.delete(t.remoteId),this.relayingPeerIds.forEach(i=>{let r=i.indexOf(t.remoteId);0<=r&&i.splice(r,1)}),console.log("<close()> Peer:"+t.remoteId+" length:"+this.connections.length+":"+this.peerContexts.length),this.updatePeerList(),0<=e&&this.callback.onDisconnect&&this.callback.onDisconnect(t.remoteId)}addDataConnection(t){let e=this.findDataConnection(t.remoteId);if(null!==e){if(console.log("add() is Fail. "+t.remoteId+" is already connecting."),e!==t){if(!(e.metadata.sendFrom<t.metadata.sendFrom))return this.closeDataConnection(e),this.addDataConnection(t),!0;this.closeDataConnection(t)}return!1}return this.connections.push(t),this.peerContexts.push(pi.parse(t.remoteId)),console.log("<add()> Peer:"+t.remoteId+" length:"+this.connections.length),!0}findDataConnection(t){for(let e of this.connections)if(e.remoteId===t)return e;return null}onData(t,e){var i=this;if(e.peers&&0<e.peers.length&&this.onUpdatePeerList(t,e),0<e.ttl&&this.onRelay(t,e),this.callback.onData){let r=e.data.byteLength;this.bandwidthUsage+=r,this.inboundQueue=this.inboundQueue.then(()=>new Promise((s,o)=>{xr((0,en.Z)(function*(){let c=e.isCompressed?yield function w9(n,t){return z0.apply(this,arguments)}(e.data):e.data;return i.callback.onData(t.remoteId,vs.decode(c)),i.bandwidthUsage-=r,s()}))}))}}onRelay(t,e){e.ttl--;let i=this.relayingPeerIds.get(t.remoteId);if(null!=i)for(let r of i){let s=this.findDataConnection(r);s&&s.open&&(console.log("<"+r+"> \u8ee2\u9001\u3057\u306a\u304d\u3083\u30fb\u30fb\u30fb"),s.send(e))}}onUpdatePeerList(t,e){let i=[],r=[],s=function D9(n,t){let e=[],i=[],r=!1,s=!1;for(let o of n.concat(t))r=n.includes(o),s=t.includes(o),r&&!s?e.push(o):!r&&s&&i.push(o);return{diff1:e,diff2:i}}(this._peerIds,e.peers);if(i=s.diff1,r=s.diff2,this.relayingPeerIds.set(t.remoteId,i),e.peers=e.peers.concat(i),r.length)for(let o of r)!this.maybeUnavailablePeerIds.has(o)&&this.connect(o)&&console.log("auto connect to unknown Peer <"+o+">")}updatePeerList(){let t=[];for(let e of this.connections)e.open&&t.push(e.remoteId);return t.push(this.peerId),t.sort(function(e,i){return e>i?1:e<i?-1:0}),this._peerIds=t,console.log("<update()>",t),this.notifyPeerList(),t}notifyPeerList(){if(this.connections.length<1)return;let t={data:vs.encode([]),peers:this._peerIds,ttl:1};this.sendBroadcast(t)}getSkyWayErrorMessage(t){switch(t){case"room-error":return"SkyWay Room API \u306b\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002";case"permission":return"\u8a72\u5f53\u306e SkyWay Room \u306e\u5229\u7528\u304c\u8a31\u53ef\u3055\u308c\u3066\u307e\u305b\u3093\u3002";case"list-error":return"SkyWay listAllPeers API \u304c Disabled \u3067\u3059\u3002";case"disconnected":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u306b\u63a5\u7d9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002";case"socket-error":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u3068\u306e\u901a\u4fe1\u3067\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002";case"invalid-id":return"Peer ID \u304c\u4e0d\u6b63\u3067\u3059\u3002";case"unavailable-id":return"\u305d\u306e Peer ID \u3059\u3067\u306b\u4f7f\u7528\u3055\u308c\u3066\u3044\u307e\u3059\u3002";case"peer-unavailable":return"\u305d\u306e Peer ID \u306f\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002";case"invalid-key":return"SkyWay API \u30ad\u30fc\u304c\u7121\u52b9\u3067\u3059\u3002";case"invalid-domain":return"SkyWay API \u30ad\u30fc\u306b\u306f\u73fe\u5728\u306e\u30c9\u30e1\u30a4\u30f3\u306f\u767b\u9332\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002";case"authentication":return"\u8a8d\u8a3c\u30a8\u30e9\u30fc\u3067\u3059\u3002";case"server-error":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u3068\u306e\u63a5\u7d9a\u4e2d\u306b\u554f\u984c\u304c\u3042\u308a\u307e\u3057\u305f\u3002 \u5c11\u3057\u5f85\u3063\u3066\u3001\u30ea\u30c8\u30e9\u30a4\u3057\u3066\u304f\u3060\u3055\u3044\u3002";case"sfu-client-not-supported":return"\u3053\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306f SFU \u306e\u4f7f\u7528\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u6700\u65b0\u306e Google Chrome \u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044";case"peer-unavailable":return"Peer \u3078\u30c7\u30fc\u30bf\u3092\u9001\u4fe1\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002Peer ID \u304c\u6b63\u3057\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002";case"signaling-limited":return"\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u56de\u6570\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u5168\u3066\u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09";case"sfu-limited":return"SFU \u30b5\u30fc\u30d0\u306e\u5229\u7528\u91cf\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001SFU \u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09";case"turn-limited":return"TURN \u30b5\u30fc\u30d0\u306e\u5229\u7528\u91cf\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001TURN \u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09\n\u3053\u306e\u72b6\u614b\u3067\u306f\u3001\u4e00\u90e8\u306e\u30e6\u30fc\u30b6\u306e\u63a5\u7d9a\u306b\u554f\u984c\u304c\u767a\u751f\u3059\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002";case"peer-unavailable":return"\u305d\u306ePeer ID\u306f\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002";default:return"SkyWay\u306b\u95a2\u3059\u308b\u4e0d\u660e\u306a\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002"}}}const W3=pi.parse("???");class Po{constructor(){this.callback=new _E,this.key="",this.queue=new Set,this.sendInterval=null,this.sendCallback=()=>{this.sendQueue()},this.callbackUnload=t=>{this.close()},console.log("Network ready...")}static get instance(){return Po._instance||(Po._instance=new Po),Po._instance}get peerId(){return this.connection?this.connection.peerId:W3.peerId}get peerIds(){return this.connection?this.connection.peerIds.concat():[]}get peerContexts(){return this.connection?this.connection.peerContexts.concat():[]}get peerContext(){return this.connection?this.connection.peerContext:W3}get isOpen(){return!(!this.connection||!this.connection.peerContext)&&this.connection.peerContext.isOpen}get bandwidthUsage(){return this.connection?this.connection.bandwidthUsage:0}open(...t){this.connection&&this.connection.peerContext&&(console.warn("It is already opened."),this.close()),console.log("Network open...",t),this.connection=this.initializeConnection(),this.connection.open.apply(this.connection,t),window.addEventListener("unload",this.callbackUnload,!1)}close(){this.connection&&this.connection.close(),this.connection=null,window.removeEventListener("unload",this.callbackUnload,!1),console.log("Network close...")}connect(t){return!!this.connection&&this.connection.connect(t)}disconnect(t){!this.connection||this.connection.disconnect(t)&&(console.log("<disconnectPeer()> Peer:"+t),this.disconnect(t))}send(t,e){this.queue.add({data:t,sendTo:e}),null===this.sendInterval&&(this.sendInterval=xr(this.sendCallback))}sendQueue(){let t=[],e={},i=[],r=this.queue.size<128?this.queue.size:128;for(let s of this.queue){if(r<=0)break;r--,this.queue.delete(s),null==s.sendTo?t.push(s.data):s.sendTo===this.peerId?i.push(s.data):(s.sendTo in e||(e[s.sendTo]=[]),e[s.sendTo].push(s.data))}if(this.connection){t.length&&this.connection.send(t);for(let s in e)this.connection.send(e[s],s)}this.callback.onData&&(this.callback.onData(null,t),this.callback.onData(this.peerId,i)),this.sendInterval=0<this.queue.size?xr(this.sendCallback):null}setApiKey(t){this.key!==t&&console.log("Key Change"),this.key=t}listAllPeers(){return this.connection?this.connection.listAllPeers():Promise.resolve([])}initializeConnection(){let t=new k9;return t.setApiKey(this.key),t.callback.onOpen=e=>{this.callback.onOpen&&this.callback.onOpen(e)},t.callback.onClose=e=>{this.callback.onClose&&this.callback.onClose(e)},t.callback.onConnect=e=>{this.callback.onConnect&&this.callback.onConnect(e)},t.callback.onDisconnect=e=>{this.callback.onDisconnect&&this.callback.onDisconnect(e)},t.callback.onData=(e,i)=>{this.callback.onData&&this.callback.onData(e,i)},t.callback.onError=(e,i,r,s)=>{this.callback.onError&&this.callback.onError(e,i,r,s)},0<this.queue.size&&null===this.sendInterval&&(this.sendInterval=xr(this.sendCallback)),t}}class zp{constructor(t,e,i=Po.instance.peerId){this.eventName=t,this.data=e,this.sendFrom=i,this.isSendFromSelf=!1,this.isSendFromSelf=this.sendFrom===Po.instance.peerId}toContext(){return{sendFrom:this.sendFrom,eventName:this.eventName,data:this.data}}}class H0{constructor(t,e){this._priority=0,this._isRegistered=!1,this._subject=t,this._key=e}get subject(){return this._subject}get key(){return this._key}get eventName(){return this._eventName}get priority(){return this._priority}get callback(){return this._callback}get isOnlyOnce(){return this._isOnlyOnce}get isRegistered(){return this._isRegistered}on(...t){return this._isOnlyOnce=!1,2===t.length?this.register(t[0],0,t[1]):this.register(t[0],t[1],t[2])}once(...t){let e=this.on.apply(this,t);return this._isOnlyOnce=!0,e}register(t,e,i){return this.isRegistered&&this.unregister(),this._eventName=t||"*",this._priority=e,this._callback=i,this.subject.registerListener(this),this._isRegistered=!0,new H0(this.subject,this.key)}unregister(){return this.subject.unregisterListener(this),this._callback=null,this._isRegistered=!1,this}trigger(t){this.callback&&this.isRegistered&&(this.callback.apply(this.key,[t,this]),this.isOnlyOnce&&this.unregister())}isEqual(t,e,i){return!(null!=t&&t!==this.key||null!=e&&e!==this.eventName||null!=i&&i!==this.callback)}}class jl{constructor(){this.listenerMap=new Map,console.log("EventSystem ready...")}static get instance(){return jl._instance||(jl._instance=new jl,jl._instance.initializeNetworkEvent()),jl._instance}register(t){return new H0(this,t)}unregister(...t){1===t.length?this._unregister(t[0],null,null):2===t.length?"string"==typeof t[1]?this._unregister(t[0],t[1],null):this._unregister(t[0],null,t[1]):this._unregister(t[0],t[1],t[2])}_unregister(t=this,e,i){let r=this.listenerMap.values();for(let s of r)for(let o of s.concat())o.isEqual(t,e,i)&&o.unregister()}registerListener(t){let e=this.getListeners(t.eventName);return e.push(t),e.sort((i,r)=>r.priority-i.priority),this.listenerMap.set(t.eventName,e),t}unregisterListener(t){let e=this.getListeners(t.eventName),i=e.indexOf(t);return i<0?null:(e.splice(i,1),t.unregister(),e.length<1&&this.listenerMap.delete(t.eventName),t)}call(...t){"string"==typeof t[0]?this._call(new zp(t[0],t[1]),t[2]):this._call(t[0],t[1])}_call(t,e){let i=t.toContext();Po.instance.send(i,e)}trigger(...t){if(2!==t.length)return this._trigger(t[0]instanceof zp?t[0]:new zp(t[0].eventName,t[0].data,t[0].sendFrom));this._trigger(new zp(t[0],t[1]))}_trigger(t){let e=this.getListeners(t.eventName).concat(this.getListeners("*"));for(let i of e)i.trigger(t);return t}getListeners(t){return this.listenerMap.has(t)?this.listenerMap.get(t):[]}initializeNetworkEvent(){let t=Po.instance.callback;t.onOpen=e=>{this.trigger("OPEN_NETWORK",{peerId:e})},t.onClose=e=>{this.trigger("CLOSE_NETWORK",{peerId:e})},t.onConnect=e=>{this.sendSystemMessage("<"+e+"> connect <DataConnection>"),this.trigger("CONNECT_PEER",{peerId:e})},t.onDisconnect=e=>{this.sendSystemMessage("<"+e+"> disconnect <DataConnection>"),this.trigger("DISCONNECT_PEER",{peerId:e})},t.onData=(e,i)=>{for(let r of i)this.trigger(r)},t.onError=(e,i,r,s)=>{this.sendSystemMessage("<"+e+"> "+r),this.trigger("NETWORK_ERROR",{peerId:e,errorType:i,errorMessage:r,errorObject:s})}}sendSystemMessage(t){console.log(t)}}const Fe=jl.instance,yt=Po.instance;class lt{constructor(){this.identifierMap=new Map,this.aliasNameMap=new Map,this.garbageMap=new Map,this.queueMap=new Map,this.updateInterval=null,this.garbageCollectionInterval=null,this.updateCallback=()=>{this.updateQueue()},console.log("ObjectStore ready...")}static get instance(){return lt._instance||(lt._instance=new lt),lt._instance}add(t,e=!0){return null!=this.get(t.identifier)||this.isDeleted(t.identifier)?null:(this.identifierMap.set(t.identifier,t),(this.aliasNameMap.has(t.aliasName)?this.aliasNameMap.get(t.aliasName):this.aliasNameMap.set(t.aliasName,new Map).get(t.aliasName)).set(t.identifier,t),t.onStoreAdded(),e&&this.update(t.toContext()),t)}remove(t){if(!this.identifierMap.has(t.identifier))return null;this.identifierMap.delete(t.identifier);let e=this.aliasNameMap.get(t.aliasName);return e&&e.delete(t.identifier),t.onStoreRemoved(),t}delete(t,e=!0){let i=null,r=null;return"string"==typeof t?(i=this.get(t),r=t):(i=t,r=t.identifier),this.markForDelete(r),null==i?null:this._delete(i,e)}_delete(t,e){return null===this.remove(t)?null:(e&&Fe.call("DELETE_GAME_OBJECT",{aliasName:t.aliasName,identifier:t.identifier}),t)}markForDelete(t){this.garbageMap.set(t,performance.now()),this.garbageCollection(6e5)}get(t){return this.identifierMap.has(t)?this.identifierMap.get(t):null}getObjects(t){if(null==t)return Array.from(this.identifierMap.values());let e="";return e="string"==typeof t?t:t.aliasName,this.aliasNameMap.has(e)?Array.from(this.aliasNameMap.get(e).values()):[]}update(t){let e=null;if("string"==typeof t){let i=this.get(t);i&&(e=i.toContext())}else e=t;if(e){if(this.queueMap.has(e.identifier)){let i=this.queueMap.get(e.identifier);for(let r in e)i[r]=e[r];return}Fe.call("UPDATE_GAME_OBJECT",e),this.queueMap.set(e.identifier,e),null===this.updateInterval&&(this.updateInterval=xr(this.updateCallback))}}updateQueue(){this.queueMap.clear(),this.updateInterval=null}isDeleted(t){return null!=this.garbageMap.get(t)}getCatalog(){let t=[];for(let e of this.identifierMap.values())t.push({identifier:e.identifier,version:e.version});return t}clearDeleteHistory(){this.garbageMap.clear()}garbageCollection(t){"number"==typeof t?null===this.garbageCollectionInterval&&(this.garbageCollectionInterval=setTimeout(()=>{this.garbageCollectionInterval=null},1e3),this._garbageCollection(t)):this.garbageMap.delete(t.identifier)}_garbageCollection(t){let e=performance.now(),i=this.garbageMap.size-1e5;if(i<1)return;let r=this.garbageMap.entries();for(;i<1;){i--;let s=r.next();if(s.done)break;let o=s.value[0];s.value[1]+t<e||this.garbageMap.delete(o)}}}var ca,A9=X(383);class No{constructor(){this.constructorMap=new Map,this.aliasMap=new Map,console.log("ObjectFactory ready...")}static get instance(){return No._instance||(No._instance=new No),No._instance}register(t,e){var i,r,s;e||(e=null!==(i=t.name)&&void 0!==i?i:null!==(s=null===(r=t.toString().match(/function\s*([^(]*)\(/))||void 0===r?void 0:r[1])&&void 0!==s?s:""),this.constructorMap.has(e)?console.error("\u305d\u306e alias<"+e+"> \u306f\u3059\u3067\u306b\u5272\u308a\u5f53\u3066\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f"):this.aliasMap.has(t)?console.error("\u305d\u306e constructor \u306f\u3059\u3067\u306b\u767b\u9332\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f",t):(console.log("addGameObjectFactory -> "+e),this.constructorMap.set(e,t),this.aliasMap.set(t,e))}create(t,e){let i=this.constructorMap.get(t);return i?new i(e):(console.error(t+"\u3068\u3044\u3046\u540d\u306eGameObject\u30af\u30e9\u30b9\u306f\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),null)}getAlias(t){var e;return null!==(e=this.aliasMap.get(t))&&void 0!==e?e:""}}function K3(n){return t=>{No.instance.register(t,n)}}function au(){return(n,t)=>{Object.defineProperty(n,t,{get:function e(){return this.context.syncData[t]},set:function i(r){this.context.syncData[t]=r,this.update()},enumerable:!0,configurable:!0})}}!function(n){const t=/&|<|>|"|'/g,e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"},i=/&amp;|&lt;|&gt;|&quot;|&apos;/g,r={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'"},s=/((?:[\0-\x08\x0B\f\x0E-\x1F\uFFFD\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))/g;function Z(pe){return e[pe]}function fe(pe){return r[pe]}n.xml2element=function o(pe){let ye=new DOMParser,we=null;try{pe=function I(pe){return pe.replace(s,"").trim()}(pe),we=ye.parseFromString(pe,"application/xml"),we.getElementsByTagName("parsererror").length&&(console.error("XML\u306e\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3057\u305f",we.documentElement),we=null)}catch(Me){console.error(Me)}return we?we.documentElement:null},n.encodeEntityReference=function c(pe){return pe.replace(t,Z)},n.decodeEntityReference=function m(pe){return pe.replace(i,fe)}}(ca||(ca={}));const N9=Object.getOwnPropertyNames(Object.prototype);Object.getOwnPropertyNames(Array.prototype);class Zn{constructor(){console.log("ObjectSerializer ready...")}static get instance(){return Zn._instance||(Zn._instance=new Zn),Zn._instance}toXml(t){let e="",i="toAttributes"in t?t.toAttributes():Zn.toAttributes(t.toContext().syncData),r=t.aliasName,s="";for(let o in i){let c=ca.encodeEntityReference(i[o]+"");null!=c&&(s+=" "+o+'="'+c+'"')}return e+=`<${r+s}>`,e+="innerXml"in t?t.innerXml():"",e+=`</${r}>`,e}static toAttributes(t){let e={};for(let i in t){let o=Zn.make2Attributes(t[i],i);for(let c in o)e[c]=o[c]}return e}static make2Attributes(t,e){let i={};if(Array.isArray(t)){let r=Zn.array2attributes(t,e);for(let s in r)i[s]=r[s]}else if("object"==typeof t){let r=Zn.object2attributes(t,e);for(let s in r)i[s]=r[s]}else i[e]=t;return i}static object2attributes(t,e){let i={};for(let r in t){let c=Zn.make2Attributes(t[r],e+"."+r);for(let m in c)i[m]=c[m]}return i}static array2attributes(t,e){let i={},r=t.length;for(let s=0;s<r;s++){let m=Zn.make2Attributes(t[s],e+"."+s);for(let I in m)i[I]=m[I]}return i}parseXml(t){let e=null;if(e="string"==typeof t?ca.xml2element(t):t,!e)return console.error("xmlElement\u304c\u7a7a\u3067\u3059"),null;let i=No.instance.create(e.tagName);if(!i)return null;if("parseAttributes"in i)i.parseAttributes(e.attributes);else{let r=i.toContext();Zn.parseAttributes(r.syncData,e.attributes),i.apply(r)}return i.initialize(),"parseInnerXml"in i&&i.parseInnerXml(e),i}static parseAttributes(t,e){let i=e.length;for(let r=0;r<i;r++){let s=e[r].value;s=ca.decodeEntityReference(s);let o=e[r].name.split("."),c=o[0],m=t,I=o.find(fe=>N9.includes(fe));null==I?1<o.length&&(({obj:m,key:c}=Zn.attributes2object(o,m,c)),null==c)||("string"!=typeof m[c]&&null!=m[c]&&(s=JSON.parse(s)),m[c]=s):console.log(`skip invalid key (${I})`)}return t}static attributes2object(t,e,i){let r=null,s=t.length;for(let o=0;o<s;o++){let c=parseInt(t[o]);if(r&&!Number.isNaN(c)&&!Array.isArray(e)&&Object.keys(r).length&&(r[i]=[],e=r[i]),i=Number.isNaN(c)?t[o]:c,Array.isArray(e)&&"number"!=typeof i)return console.warn("Array\u306b\u306findex\u306e\u633f\u5165\u3057\u304b\u8a31\u53ef\u3057\u306a\u3044"),{obj:e,key:null};o+1<s&&(null==e[i]&&(e[i]="number"==typeof i?[]:{}),r=e,e=e[i])}return{obj:e,key:i}}static parseInnerXml(t){return null}}class Ua{constructor(t=ns.generateUuid()){this.context={aliasName:this.constructor.aliasName,identifier:"",majorVersion:0,minorVersion:0,syncData:{}},this.context.identifier=t}static get aliasName(){return No.instance.getAlias(this)}get aliasName(){return this.context.aliasName}get identifier(){return this.context.identifier}get version(){return this.context.majorVersion+this.context.minorVersion}initialize(){lt.instance.add(this)}destroy(){lt.instance.delete(this)}onStoreAdded(){}onStoreRemoved(){}update(){this.versionUp(),lt.instance.update(this.identifier)}versionUp(){this.context.majorVersion+=1,this.context.minorVersion=Math.random()}apply(t){null!==t&&this.identifier===t.identifier&&(this.context.majorVersion=t.majorVersion,this.context.minorVersion=t.minorVersion,this.context.syncData=t.syncData)}clone(){let t=this.toXml();return Zn.instance.parseXml(t)}toContext(){return{aliasName:this.context.aliasName,identifier:this.context.identifier,majorVersion:this.context.majorVersion,minorVersion:this.context.minorVersion,syncData:Y3(this.context.syncData)}}toXml(){return Zn.instance.toXml(this)}}function Y3(n){if(null==n)return n;let t=Array.isArray(n)?[]:{},e=Object.getOwnPropertyNames(n);for(let i of e){let r=typeof n[i];null!=n[i]&&"object"===r?t[i]=Y3(n[i]):"function"!==r&&(t[i]=n[i])}return t}var Fo;let zn=Fo=class extends Ua{constructor(){super(...arguments),this.value="",this.attributes={},this.parentIdentifier="",this.majorIndex=0,this.minorIndex=Math.random(),this._children=[],this.needsSort=!0}get index(){return this.majorIndex+this.minorIndex}set index(t){this.majorIndex=0|t,this.minorIndex=t-this.majorIndex,this.parent&&(this.parent.needsSort=!0)}get parent(){return lt.instance.get(this.parentIdentifier)}get parentId(){return this.parentIdentifier}get parentIsAssigned(){return 0<this.parentIdentifier.length}get parentIsUnknown(){return this.parentIsAssigned&&null==lt.instance.get(this.parentIdentifier)}get parentIsDestroyed(){return this.parentIsAssigned&&lt.instance.isDeleted(this.parentIdentifier)}get children(){return this.needsSort&&(this.needsSort=!1,this._children.sort((t,e)=>t.index-e.index)),this._children.concat()}destroy(){super.destroy();for(let t of this._children.concat())t.destroy();this._children=[]}onStoreAdded(){super.onStoreAdded(),this.initializeChildren()}onStoreRemoved(){super.onStoreRemoved(),this.parent&&this.parent.removeChild(this)}onChildAdded(t){}onChildRemoved(t){}_onChildAdded(t){let e=this;for(;e&&(e.onChildAdded(t),e=e.parent,e!==this););}_onChildRemoved(t){let e=this;for(;e&&(e.onChildRemoved(t),e=e.parent,e!==this););}initializeChildren(){if(null==Fo.unknownNodes[this.identifier])return;let t=Fo.unknownNodes[this.identifier];for(let e of t)e.parent===this&&this.updateChildren(e);Fo.unknownNodes[this.identifier]&&delete Fo.unknownNodes[this.identifier]}updateChildren(t=this){let e=this._children.indexOf(t),i=!1,r=t.parent===this;if(e<0&&r)this._children.push(t),e=this._children.length-1,i=!0;else{if(0<=e&&!r)return this._children.splice(e,1),void this._onChildRemoved(t);if(e<0&&!r)return}let s=this._children.length;s&&((this._children[e-1<0?0:e-1].index>t.index||t.index>this._children[s-1<e+1?s-1:e+1].index)&&(this.needsSort=!0),i&&this._onChildAdded(t))}updateIndexs(){let t=this.children;for(let e=0;e<t.length;e++)t[e].majorIndex=e,t[e].minorIndex=Math.random()}appendChild(t){if(t.contains(this))return null;t.parent&&t.parent!==this&&t.parent.removeChild(t);let e=0<this.children.length?this.children[this.children.length-1].majorIndex+1:0;return t.parentIdentifier=this.identifier,t.majorIndex=e,t.minorIndex=Math.random(),this.updateChildren(t),t}insertBefore(t,e){if(t.contains(this))return null;if(t===e&&t.parent===this)return t;t.parent&&t.parent!==this&&t.parent.removeChild(t);let i=this.children.indexOf(e);if(i<0)return this.appendChild(t);t.parentIdentifier=this.identifier;let r=0<i?this.children[i-1].index:0,s=e.index-r,o=r+s*(.45+.1*Math.random());return t.majorIndex=0|o,t.minorIndex=o-t.majorIndex,this.updateChildren(t),s<1e-7&&this.updateIndexs(),t}removeChild(t){return this.children.indexOf(t)<0?null:(t.parentIdentifier="",t.majorIndex=0,t.minorIndex=Math.random(),this.updateChildren(t),t)}contains(t){let e=t.parent;for(;e;){if(e===t)return console.error("\u3042 \u3084\u3063\u3079\u3001\u5faa\u74b0\u53c2\u7167",t),!1;if(e===this)return!0;e=e.parent}return!1}setAttribute(t,e){this.attributes[t]=e,this.update()}getAttribute(t){return null==this.attributes[t]?"":this.attributes[t]}removeAttribute(t){delete this.attributes[t],this.update()}toAttributes(){return Zn.toAttributes(this.attributes)}parseAttributes(t){Zn.parseAttributes(this.attributes,t)}innerXml(){let t="";t+=ca.encodeEntityReference(this.value+"");for(let e of this.children)t+=Zn.instance.toXml(e);return t}parseInnerXml(t){let e=t.children,i=e.length;if(0<i)for(let r=0;r<i;r++){let s=Zn.instance.parseXml(e[r]);s instanceof Fo&&this.appendChild(s)}else this.value=ca.decodeEntityReference(t.innerHTML)}apply(t){let e=this.parent;super.apply(t),e&&this.parent!==e&&e.updateChildren(this),this.parent?this.parent.updateChildren(this):this.parentIsAssigned&&(this.parentIdentifier in Fo.unknownNodes||(Fo.unknownNodes[this.parentIdentifier]=[]),Fo.unknownNodes[this.parentIdentifier].push(this))}};function Xn(n){return t=>{K3(n)(t)}}function rt(){return(n,t)=>{n instanceof zn?function P9(){return(n,t)=>{Object.defineProperty(n,t,{get:function e(){return this.getAttribute(t)},set:function i(r){this.setAttribute(t,r)},enumerable:!0,configurable:!0})}}()(n,t):au()(n,t)}}zn.unknownNodes={},B([au()],zn.prototype,"value",void 0),B([au()],zn.prototype,"attributes",void 0),B([au()],zn.prototype,"parentIdentifier",void 0),B([au()],zn.prototype,"majorIndex",void 0),B([au()],zn.prototype,"minorIndex",void 0),zn=Fo=B([K3("node")],zn);class Z3{constructor(t="Queue"){this.name=t,this.queue=Promise.resolve(),this._length=0}get length(){return this._length}add(t){this._length++,console.log(`${this.name} add: ${this._length}`),this.queue=this.queue.then("function"==typeof t.then?()=>t:0<t.length?()=>new Promise(t):t);let e=this.queue;return this.queue=this.queue.catch(i=>{console.error(i)}),this.queue=this.queue.then(()=>{this._length--,console.log(`${this.name} done: ${this._length}`)}),e}}var et,Qn;!function(n){const t=new RegExp(["\ud83c[\udf00-\udfff]","\ud83d[\udc00-\ude4f]","\ud83d[\ude80-\udeff]","\ud7c9[\ude00-\udeff]","[\u2600-\u27bf]"].join("|"));n.toHalfWidth=function e(pe){return pe.replace(/[\uff01-\uff5e]/g,ye=>String.fromCharCode(ye.charCodeAt(0)-65248))},n.isEmote=function i(pe){return!!pe&&(pe=this.cr(pe).replace(/[\s\r\n]/g,""),Array.from(pe).length<=3&&!/[\u300c\u300d]/.test(pe)&&(t.test(pe)||/[$\uff04\\\uffe5\uff01\uff1f\u2755\u2762\u203d\u203c/!/?\u2665\u266a\u266c\u2669\u266b\u263a\ud83e\udd2e\u2764\ufe0f\u2620\ufe0f]/.test(pe)))},n.cr=function r(pe){if(!pe)return"";let ye="",we="";return[...pe].forEach(Me=>{if(we){switch(Me){case"n":case"\uff4e":ye+="\n";break;case"\\":case"\uffe5":ye+=Me;break;default:ye+=we+Me}we=""}else"\\"==Me||"\uffe5"==Me?we=Me:ye+=Me}),ye},n.validUrl=function s(pe){if(!pe)return!1;try{new URL(pe.trim())}catch(ye){return!1}return/^https?\:\/\//.test(pe.trim())},n.sameOrigin=function o(pe){if(!pe)return!1;try{return new URL(pe).origin===window.location.origin}catch(ye){return!1}},n.escapeHtml=function c(pe){return"string"!=typeof pe&&(pe=pe.toString()),pe.replace(/[&'`"<>]/g,function(ye){return{"&":"&amp;","'":"&#x27;","`":"&#x60;",'"':"&quot;","<":"&lt;",">":"&gt;"}[ye]})},n.rubyToHtml=function m(pe){return"string"!=typeof pe&&(pe=pe.toString()),pe.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g,"<ruby>$1<rp>(</rp><rt>$2</rt><rp>)</rp></ruby>")},n.rubyToText=function I(pe){return"string"!=typeof pe&&(pe=pe.toString()),pe.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g,"$1($2)")},n.aliasNameToClassName=function Z(pe){switch(pe){case"character":return"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc";case"cut-in":return"\u30ab\u30c3\u30c8\u30a4\u30f3";case"dice-roll-table":return"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868";case"terrain":return"\u5730\u5f62";case"table-mask":return"\u30de\u30c3\u30d7\u30de\u30b9\u30af";case"text-note":return"\u5171\u6709\u30e1\u30e2";case"card":return"\u30ab\u30fc\u30c9";case"dice-symbol":return"\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb";case"card-stack":return"\u5c71\u672d";case"game-table":return"\u30c6\u30fc\u30d6\u30eb";case"chat-tab":return"\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6";case"range":return"\u5c04\u7a0b\u30fb\u7bc4\u56f2";default:return pe}},n.textShadowColor=function fe(pe,ye="#ffffff",we="#333333"){return pe&&/^\#[0-9a-f]{6}$/i.test(pe)&&pe.substring(1,7).match(/.{2}/g).reduce((Me,Oe)=>Me+parseInt(Oe,16),0)>510?we:ye}}(et||(et={}));class kt{constructor(){this.imageHash={},console.log("ImageStorage ready...")}static get instance(){return kt._instance||(kt._instance=new kt),kt._instance}get images(){let t=[];for(let e in this.imageHash)t.push(this.imageHash[e]);return t}destroy(){for(let t in this.imageHash)this.delete(t)}addAsync(t){var e=this;return(0,en.Z)(function*(){let i=yield Ht.createAsync(t);return e._add(i)})()}add(t){let e;if("string"==typeof t)e=Ht.create(t);else if(t instanceof Ht)e=t;else{if(this.update(t))return this.imageHash[t.identifier];e=Ht.create(t)}return this._add(e)}_add(t){return Bi.COMPLETE<=t.state&&this.lazySynchronize(100),this.update(t)?this.imageHash[t.identifier]:(this.imageHash[t.identifier]=t,console.log("add Image: "+t.identifier),t)}update(t){let e;e=t instanceof Ht?t.toContext():t;let i=this.imageHash[t.identifier];return!!i&&(i.apply(t),!0)}delete(t){let e=this.imageHash[t];return!!e&&(e.destroy(),delete this.imageHash[t],!0)}get(t){return this.imageHash[t]||null}synchronize(t){this.lazyTimer&&this.lazyTimer.stop(),Fe.call("SYNCHRONIZE_FILE_LIST",this.getCatalog(),t)}lazySynchronize(t,e){null==this.lazyTimer&&(this.lazyTimer=new la(()=>this.synchronize(e),t)),this.lazyTimer.reset(t)}getCatalog(){let t=[];for(let e of this.images)Bi.COMPLETE<=e.state&&t.push({identifier:e.identifier,state:e.state});return t}}let Ue=Qn=class extends Ua{constructor(){super(...arguments),this.userId="",this.peerId="",this.name="",this.imageIdentifier="",this.color=Qn.CHAT_DEFAULT_COLOR,this.isGMMode=!1}get isMine(){return Qn.myCursor&&Qn.myCursor===this}get image(){return kt.instance.get(this.imageIdentifier)}onStoreAdded(){super.onStoreAdded(),this.isMine||Fe.register(this).on("DISCONNECT_PEER",t=>{t.data.peerId===this.peerId&&setTimeout(()=>{yt.peerIds.includes(this.peerId)||(Qn.userIdMap.delete(this.userId),Qn.peerIdMap.delete(this.peerId),lt.instance.remove(this))},3e4)})}onStoreRemoved(){super.onStoreRemoved(),Fe.unregister(this),Qn.userIdMap.delete(this.userId),Qn.peerIdMap.delete(this.peerId)}static findByUserId(t){return this.find(Qn.userIdMap,t,!0)}static findByPeerId(t){return this.find(Qn.peerIdMap,t,!1)}static find(t,e,i){let r=t.get(e);if(null!=r&&lt.instance.get(r))return lt.instance.get(r);let s=lt.instance.getObjects(Qn);for(let o of s){let c=i?o.userId:o.peerId;if(c===e)return t.set(c,o.identifier),o}return null}static createMyCursor(){return Qn.myCursor?(console.warn("It is already created."),Qn.myCursor):(Qn.myCursor=new Qn,Qn.myCursor.peerId=yt.peerId,Qn.myCursor.initialize(),window.localStorage&&localStorage.getItem(Qn.CHAT_MY_NAME_LOCAL_STORAGE_KEY)&&(Qn.myCursor.name=localStorage.getItem(Qn.CHAT_MY_NAME_LOCAL_STORAGE_KEY)),window.localStorage&&localStorage.getItem(Qn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)&&(Qn.myCursor.color=localStorage.getItem(Qn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)),Qn.myCursor)}apply(t){let e=t.syncData.userId,i=t.syncData.peerId;e!==this.userId&&(Qn.userIdMap.set(e,this.identifier),Qn.userIdMap.delete(this.userId)),i!==this.peerId&&(Qn.peerIdMap.set(i,this.identifier),Qn.peerIdMap.delete(this.peerId)),super.apply(t)}isPeerAUdon(){return null!=/u.*d.*o.*n/gi.exec(this.peerId)}};Ue.isGMHold=!1,Ue.CHAT_MY_NAME_LOCAL_STORAGE_KEY="udonanaumu-chat-my-name-local-storage",Ue.CHAT_MY_COLOR_LOCAL_STORAGE_KEY="udonanaumu-chat-my-color-local-storage",Ue.CHAT_DEFAULT_COLOR="#444444",Ue.CHAT_TRANSPARENT_COLOR="#ffffff",Ue.myCursor=null,Ue.userIdMap=new Map,Ue.peerIdMap=new Map,B([rt()],Ue.prototype,"userId",void 0),B([rt()],Ue.prototype,"peerId",void 0),B([rt()],Ue.prototype,"name",void 0),B([rt()],Ue.prototype,"imageIdentifier",void 0),B([rt()],Ue.prototype,"color",void 0),B([rt()],Ue.prototype,"isGMMode",void 0),Ue=Qn=B([Xn("PeerCursor")],Ue);let lu=class extends zn{constructor(){super(...arguments),this.dicebot="",this.paletteColor="",this._palettes=[],this._paletteLines=[],this._paletteVariables=[],this.isAnalized=!1}get color(){return this.paletteColor&&"#ffffff"!=this.paletteColor?this.paletteColor:window.localStorage&&localStorage.getItem(Ue.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)&&"#ffffff"!=localStorage.getItem(Ue.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)?localStorage.getItem(Ue.CHAT_MY_COLOR_LOCAL_STORAGE_KEY):Ue.CHAT_DEFAULT_COLOR}set color(t){this.paletteColor=t}get paletteLines(){return this.isAnalized||this.parse(this.value),this._paletteLines}get paletteVariables(){return this.isAnalized||this.parse(this.value),this._paletteVariables}getPalette(){return this.isAnalized||this.parse(this.value),this._palettes}setPalette(t){this.value=t,this.isAnalized=!1}evaluate(t,e){let i="";i="string"==typeof t?t:t.palette,console.log(i);let s=0,o=!0;for(;o;)s++,o=!1,i=i.replace(/[{\uff5b]\s*([^{}\uff5b\uff5d]+)\s*[}\uff5d]/g,(c,m)=>{o=!0;let I="";for(let Z of this.paletteVariables)Z.name==m&&(I=Z.value);if(e){let Z=e.getFirstElementByNameUnsensitive(m);return Z?(I=Z.isNumberResource?Z.currentValue:Z.isCheckProperty?(Z.currentValue+"").split(/[|\uff5c]/g)[Z.value?0:1]:Z.isAbilityScore?Z.calcAbilityScore():Z.value,null==I&&(I="")):((Z=e.getFirstElementByNameUnsensitive(m.replace(/^\u6700\u5927/,""))||e.getFirstElementByNameUnsensitive(m.replace(/^Max[\:\_\-\s]?/i,""))||e.getFirstElementByNameUnsensitive(m.replace(/^\u57fa\u672c/,""))||e.getFirstElementByNameUnsensitive(m.replace(/^\u521d\u671f/,""))||e.getFirstElementByNameUnsensitive(m.replace(/^\u539f/,""))||e.getFirstElementByNameUnsensitive(m.replace(/\u57fa\u672c\u5024$/,""))||e.getFirstElementByNameUnsensitive(m.replace(/\u521d\u671f\u5024$/,""))||e.getFirstElementByNameUnsensitive(m.replace(/\u539f\u70b9$/,"")))&&(Z.isNumberResource||Z.isAbilityScore)&&(I=Z.value),(Z=e.getFirstElementByNameUnsensitive(m.replace(/\u4fee\u6b63\u5024?$/,""))||e.getFirstElementByNameUnsensitive(m.replace(/\s*Mod(ifier|\.)?$/i,""))||e.getFirstElementByNameUnsensitive(m.replace(/\u30dc\u30fc\u30ca\u30b9$/,"")))&&Z.isAbilityScore&&(I=Z.calcAbilityScore())),I+""}return""}),128<s&&(o=!1);return i}parse(t){this._palettes=t.split("\n"),this._paletteLines=[],this._paletteVariables=[];for(let e of this._palettes){let i=this.parseVariable(e);i?this._paletteVariables.push(i):this._paletteLines.push({palette:e})}this.isAnalized=!0}parseVariable(t){let e=/^\s*[/\uff0f]{2}([^=\uff1d{}\uff5b\uff5d\s]+)\s*[=\uff1d]\s*(.+)\s*/gi.exec(t);return e?{name:et.toHalfWidth(e[1]),value:e[2]}:null}apply(t){super.apply(t),this.isAnalized=!1}};var Va;B([rt()],lu.prototype,"dicebot",void 0),B([rt()],lu.prototype,"paletteColor",void 0),lu=B([Xn("chat-palette")],lu);let ht=Va=class extends zn{get isSimpleNumber(){return null!=this.type&&"simpleNumber"===this.type}get isNumberResource(){return null!=this.type&&"numberResource"===this.type}get isCheckProperty(){return null!=this.type&&"checkProperty"===this.type}get isNote(){return null!=this.type&&"note"===this.type}get isAbilityScore(){return null!=this.type&&"abilityScore"===this.type}get isUrl(){return null!=this.type&&"url"===this.type}static create(t,e="",i={},r=""){let s;return s=r&&0<r.length?new Va(r):new Va,s.attributes=i,s.name=t,s.value=e,s.initialize(),s}getElementsByName(t){let e=[];for(let i of this.children)i instanceof Va&&(i.getAttribute("name")===t&&e.push(i),Array.prototype.push.apply(e,i.getElementsByName(t)));return e}getElementsByType(t){let e=[];for(let i of this.children)i instanceof Va&&(i.getAttribute("type")===t&&e.push(i),Array.prototype.push.apply(e,i.getElementsByType(t)));return e}getFirstElementByName(t){for(let e of this.children)if(e instanceof Va){if(e.getAttribute("name")===t)return e;let i=e.getFirstElementByName(t);if(i)return i}return null}getFirstElementByNameUnsensitive(t){for(let e of this.children)if(e instanceof Va){if(et.toHalfWidth(e.getAttribute("name").replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).toLowerCase()===et.toHalfWidth(t.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).toLowerCase())return e;let i=e.getFirstElementByNameUnsensitive(t);if(i)return i}return null}calcAbilityScore(){if(!this.isAbilityScore||!this.value)return 0;let t;return(t=this.currentValue.toString().match(/^div(\d+)$/))?Math.floor(+this.value/+t[1]):(t=this.currentValue.toString().match(/^DnD/))?Math.floor((+this.value-10)/2):+this.value}};B([rt()],ht.prototype,"name",void 0),B([rt()],ht.prototype,"type",void 0),B([rt()],ht.prototype,"currentValue",void 0),ht=Va=B([Xn("data")],ht);let $i=class extends zn{constructor(){super(...arguments),this.location={name:"table",x:0,y:0},this.posZ=0,this._imageFile=Ht.Empty,this._shadowImageFile=Ht.Empty,this._dataElements={},this.currntImageIndex=0,this.isUseIconToOverviewImage=!1,this.currntIconIndex=0,this.isAltitudeIndicate=!1,this.isInverse=!1,this.isHollow=!1,this.isBlackPaint=!1,this.aura=-1,this.isNotRide=!0,this.isInventoryIndicate=!0}get isVisibleOnTable(){return"table"===this.location.name}get rootDataElement(){for(let t of this.children)if(t.getAttribute("name")===this.aliasName)return t;return null}get imageDataElement(){return this.getElement("image")}get commonDataElement(){return this.getElement("common")}get detailDataElement(){return this.getElement("detail")}get imageElement(){if(!this.imageDataElement)return null;let t=this.imageDataElement.getElementsByName("imageIdentifier");return t[this.currntImageIndex<0?0:this.currntImageIndex>=t.length?t.length-1:this.currntImageIndex]}get imageFile(){if(!this.imageDataElement)return this._imageFile;let t=this.imageElement;if(t&&this._imageFile.identifier!==t.value){let e=kt.instance.get(t.value);this._imageFile=e||Ht.Empty}return this._imageFile}get imageFiles(){return this.imageDataElement?this.imageDataElement.getElementsByName("imageIdentifier").map(e=>kt.instance.get(e.value)||null).filter(e=>null!=e):[]}get faceIcon(){if(!this.imageDataElement)return null;let t=this.imageDataElement.getElementsByName("faceIcon");if(t){let e=t[this.currntIconIndex];return this.currntIconIndex<0&&(this.currntIconIndex=0),e?kt.instance.get(e.value):null}return null}get faceIcons(){return this.imageDataElement?this.imageDataElement.getElementsByName("faceIcon").map(e=>kt.instance.get(e.value)||null).filter(e=>null!=e):[]}get shadowImageFile(){if(!this.imageDataElement)return this._shadowImageFile;let t=this.imageDataElement.getFirstElementByName("shadowImageIdentifier");if(t&&this._shadowImageFile.identifier!==t.value){let e=kt.instance.get(t.value);this._shadowImageFile=e||Ht.Empty}else{let e=this.imageElement;if(e&&this._shadowImageFile.identifier!==e.currentValue){let i=kt.instance.get(e.currentValue);this._shadowImageFile=i||Ht.Empty}}return this._shadowImageFile}get altitude(){let t=this.getElement("altitude",this.commonDataElement);!t&&this.commonDataElement&&this.commonDataElement.appendChild(ht.create("altitude",0,{},"altitude_"+this.identifier));let e=t?+t.value:0;return Number.isNaN(e)?0:e}set altitude(t){let e=this.getElement("altitude",this.commonDataElement);e&&(e.value=t)}get isGMMode(){return!!Ue.myCursor&&Ue.myCursor.isGMMode}createDataElements(){this.initialize();let t=this.aliasName;if(!this.rootDataElement){let e=ht.create(t,"",{},t+"_"+this.identifier);this.appendChild(e)}this.imageDataElement||(this.rootDataElement.appendChild(ht.create("image","",{},"image_"+this.identifier)),this.imageDataElement.appendChild(ht.create("imageIdentifier","",{type:"image"},"imageIdentifier_"+this.identifier))),this.commonDataElement||this.rootDataElement.appendChild(ht.create("common","",{},"common_"+this.identifier)),this.detailDataElement||this.rootDataElement.appendChild(ht.create("detail","",{},"detail_"+this.identifier))}getElement(t,e=this.rootDataElement){if(!e)return null;let i=this._dataElements[t]?lt.instance.get(this._dataElements[t]):null;return(!i||!e.contains(i))&&(i=e.getFirstElementByName(t),this._dataElements[t]=i?i.identifier:null),i}getCommonValue(t,e){let i=this.getElement(t,this.commonDataElement);if(!i)return e;if("number"==typeof e){let r=+i.value;return Number.isNaN(r)?e:r}return i.value+""}getUrls(){return this.rootDataElement.getElementsByType("url")}setCommonValue(t,e){let i=this.getElement(t,this.commonDataElement);!i||(i.value=e)}getImageFile(t){if(!this.imageDataElement)return null;let e=this.getElement(t,this.imageDataElement);return e?kt.instance.get(e.value):null}setImageFile(t,e){let i=e?this.getElement(t,this.imageDataElement):null;!i||(i.value=e.identifier)}setLocation(t){this.location.name=t,this.update()}};B([rt()],$i.prototype,"location",void 0),B([rt()],$i.prototype,"posZ",void 0),B([rt()],$i.prototype,"currntImageIndex",void 0),B([rt()],$i.prototype,"isUseIconToOverviewImage",void 0),B([rt()],$i.prototype,"currntIconIndex",void 0),B([rt()],$i.prototype,"isAltitudeIndicate",void 0),B([rt()],$i.prototype,"isInverse",void 0),B([rt()],$i.prototype,"isHollow",void 0),B([rt()],$i.prototype,"isBlackPaint",void 0),B([rt()],$i.prototype,"aura",void 0),B([rt()],$i.prototype,"isNotRide",void 0),B([rt()],$i.prototype,"isInventoryIndicate",void 0),$i=B([Xn("TabletopObject")],$i);var wi=(()=>(function(n){n[n.Default=1]="Default",n[n.Image=2]="Image",n[n.Postfix=3]="Postfix",n[n.PostfixOrImage=4]="PostfixOrImage",n[n.PostfixAndImage=5]="PostfixAndImage",n[n.NotConditionStandUp=6]="NotConditionStandUp"}(wi||(wi={})),wi))();let Ga=class extends ht{constructor(){super(...arguments),this.position=5,this.height=35,this.overviewIndex=-1}get standElements(){return this.getElementsByName("stand")}add(t){let e=this.getFirstElementByName("stand")?wi.NotConditionStandUp:wi.Default,i=ht.create("stand");i.appendChild(ht.create("name","",{},"name_"+i.identifier)),i.appendChild(ht.create("imageIdentifier",t&&t!=Ht.Empty.identifier?t:"stand_no_image",{type:"image"},"imageIdentifier_"+i.identifier)),i.appendChild(ht.create("conditionType",e,{},"conditionType_"+i.identifier)),i.appendChild(ht.create("height",0,{currentValue:0},"height_"+i.identifier)),i.appendChild(ht.create("applyImageEffect","",{},"applyImageEffect_"+i.identifier)),i.appendChild(ht.create("applyRoll","",{},"applyRoll_"+i.identifier)),i.appendChild(ht.create("applyDialog","applyDialog",{},"applyDialog_"+i.identifier)),i.appendChild(ht.create("showName","showName",{},"showName_"+i.identifier)),i.appendChild(ht.create("postfix","",{},"postfix_"+i.identifier)),i.appendChild(ht.create("position",0,{currentValue:""},"position_"+i.identifier)),i.appendChild(ht.create("speakingImageIdentifier","",{type:"image"},"speakingImageIdentifier_"+i.identifier)),this.appendChild(i)}remove(t){this.removeChild(t)}matchStandInfo(t,e,i=null){const r=e instanceof Ht?e.identifier:e;let s="",o=!1,c=[];["\uff20\u9000\u53bb","@farewell"].forEach(ye=>{et.toHalfWidth(t).trimRight().toUpperCase().endsWith(et.toHalfWidth(ye).toUpperCase())&&(("@"==ye.slice(0,1)||"\uff20"==ye.slice(0,1))&&s.length<ye.length&&(s=ye),o=!0)});for(const ye of this.standElements){const we=ye.getFirstElementByName("name");we&&we.value.toString()==i&&c.push(ye)}let m=1,I=!0,Z=[],fe=[];for(const ye of this.standElements){if(!ye.getFirstElementByName("imageIdentifier")||!ye.getFirstElementByName("conditionType"))continue;const we=ye.getFirstElementByName("conditionType").value;if(we!=wi.NotConditionStandUp)if(we==wi.Default)Z.push(ye);else{const Me=ye.getFirstElementByName("postfix")?ye.getFirstElementByName("postfix").value.toString():null,Oe=ye.getFirstElementByName("targetImageIdentifier")?ye.getElementsByName("targetImageIdentifier").map(ze=>ze.value):[];let Be=!1,ke=!1;if(Me&&(we==wi.Postfix||we==wi.PostfixOrImage||we==wi.PostfixAndImage))for(let ze of Me.split(/[\r\n]+/g))null==ze||0==ze.trim().length||et.toHalfWidth(t).toUpperCase().trimRight().endsWith(et.toHalfWidth(ze).trimRight().toUpperCase())&&(("@"==ze.slice(0,1)||"\uff20"==ze.slice(0,1))&&s.length<ze.length&&(s=ze),Be=!0);Oe.length>0&&(we==wi.Image||we==wi.PostfixOrImage||we==wi.PostfixAndImage)&&(ke=r&&Oe.indexOf(r)>=0),(Be&&(we==wi.Postfix||we==wi.PostfixOrImage)||ke&&(we==wi.Image||we==wi.PostfixOrImage)||Be&&ke&&we==wi.PostfixAndImage)&&(I=!1,fe.push(ye),m<+we&&(m=+we))}}i||(c=I?Z:fe.filter(ye=>+ye.getFirstElementByName("conditionType").value==m));let pe={standElementIdentifier:null,matchMostLongText:s,farewell:o};return c&&c.length>0&&(pe.standElementIdentifier=c[Math.floor(Math.random()*c.length)].identifier),pe}};var jp;B([rt()],Ga.prototype,"position",void 0),B([rt()],Ga.prototype,"height",void 0),B([rt()],Ga.prototype,"overviewIndex",void 0),Ga=B([Xn("stand-list")],Ga);let Vt=jp=class extends $i{constructor(t=ns.generateUuid()){super(t),this.rotate=0,this.roll=0,this.isDropShadow=!0,this.isShowChatBubble=!0,this.owner="",this.text="",this.isEmote=!1,this.isLoaded=!1,this.isAltitudeIndicate=!0}get name(){return this.getCommonValue("name","")}set name(t){this.setCommonValue("name",t)}get size(){return this.getCommonValue("size",1)}get height(){let t=this.getElement("height",this.commonDataElement);!t&&this.commonDataElement&&this.commonDataElement.insertBefore(ht.create("height",0,{currentValue:""},"height_"+this.identifier),this.getElement("altitude",this.commonDataElement));let e=t?+t.value:0;return t&&t.currentValue&&(e=(Number.isNaN(e)?0:e)*this.size),Number.isNaN(e)?0:e}get chatPalette(){for(let t of this.children)if(t instanceof lu)return t;return null}get ownerName(){let t=Ue.findByUserId(this.owner);return t?t.name:null}get ownerColor(){let t=Ue.findByUserId(this.owner);return t?t.color:"#444444"}get standList(){for(let e of this.children)if(e instanceof Ga)return e;let t=new Ga("StandList_"+this.identifier);return t.initialize(),this.appendChild(t),t}static create(t,e,i){let r=new jp;return r.createDataElements(),r.initialize(),r.createTestGameDataElement(t,e,i),r}get isHideIn(){return!!this.owner}get isVisible(){return!this.owner||yt.peerContext.userId===this.owner}static get isStealthMode(){for(const t of lt.instance.getObjects(jp))if(t.isHideIn&&t.isVisible&&"table"===t.location.name)return!0;return!1}createTestGameDataElement(t,e,i){this.createDataElements();let r=ht.create("name",t,{},"name_"+this.identifier),s=ht.create("size",e,{},"size_"+this.identifier),o=ht.create("height",0,{currentValue:""},"height_"+this.identifier),c=ht.create("altitude",0,{},"altitude_"+this.identifier);this.imageDataElement.getFirstElementByName("imageIdentifier")&&(this.imageDataElement.getFirstElementByName("imageIdentifier").value=i);let m=ht.create("\u30ea\u30bd\u30fc\u30b9","",{},"\u30ea\u30bd\u30fc\u30b9"+this.identifier),I=ht.create("HP",200,{type:"numberResource",currentValue:"200"},"HP_"+this.identifier),Z=ht.create("MP",100,{type:"numberResource",currentValue:"100"},"MP_"+this.identifier);this.commonDataElement.appendChild(r),this.commonDataElement.appendChild(s),this.commonDataElement.appendChild(o),this.commonDataElement.appendChild(c),this.detailDataElement.appendChild(m),m.appendChild(I),m.appendChild(Z);let fe=ht.create("\u60c5\u5831","",{},"\u60c5\u5831"+this.identifier);this.detailDataElement.appendChild(fe),fe.appendChild(ht.create("\u8aac\u660e","\u3053\u3053\u306b\u8aac\u660e\u3092\u66f8\u304f\n\u3042\u3044\u3046\u3048\u304a",{type:"note"},"\u8aac\u660e"+this.identifier)),fe.appendChild(ht.create("\u30e1\u30e2","\u4efb\u610f\u306e\u6587\u5b57\u5217\n\uff11\n\uff12\n\uff13\n\uff14\n\uff15",{type:"note"},"\u30e1\u30e2"+this.identifier)),fe.appendChild(ht.create("\u53c2\u7167URL","https://www.example.com",{type:"url"},"\u53c2\u7167URL"+this.identifier)),fe=ht.create("\u80fd\u529b","",{},"\u80fd\u529b"+this.identifier),this.detailDataElement.appendChild(fe),fe.appendChild(ht.create("\u5668\u7528\u5ea6",24,{type:"abilityScore",currentValue:"div6"},"\u5668\u7528\u5ea6"+this.identifier)),fe.appendChild(ht.create("\u654f\u6377\u5ea6",24,{type:"abilityScore",currentValue:"div6"},"\u654f\u6377\u5ea6"+this.identifier)),fe.appendChild(ht.create("\u7b4b\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u7b4b\u529b"+this.identifier)),fe.appendChild(ht.create("\u751f\u547d\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u751f\u547d\u529b"+this.identifier)),fe.appendChild(ht.create("\u77e5\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u77e5\u529b"+this.identifier)),fe.appendChild(ht.create("\u7cbe\u795e\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u7cbe\u795e\u529b"+this.identifier)),fe=ht.create("\u6226\u95d8\u7279\u6280","",{},"\u6226\u95d8\u7279\u6280"+this.identifier),this.detailDataElement.appendChild(fe),fe.appendChild(ht.create("Lv1","\u5168\u529b\u653b\u6483",{},"Lv1"+this.identifier)),fe.appendChild(ht.create("Lv3","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9",{},"Lv3"+this.identifier)),fe.appendChild(ht.create("Lv5","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9\u2161",{},"Lv5"+this.identifier)),fe.appendChild(ht.create("Lv7","\u9811\u5f37",{},"Lv7"+this.identifier)),fe.appendChild(ht.create("Lv9","\u8599\u304e\u6255\u3044",{},"Lv9"+this.identifier)),fe.appendChild(ht.create("\u81ea\u52d5","\u6cbb\u7652\u9069\u6b63",{},"\u81ea\u52d5"+this.identifier)),(new DOMParser).parseFromString(this.rootDataElement.toXml(),"application/xml");let we=new lu("ChatPalette_"+this.identifier);we.setPalette("\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u5165\u529b\u4f8b\uff1a\n2d6+1 \u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\n\uff11\uff44\uff12\uff10\uff0b{\u654f\u6377}\uff0b\uff5b\u683c\u95d8\uff5d\u3000{name}\u306e\u683c\u95d8\uff01\n//\u654f\u6377=10+{\u654f\u6377A}\n//\u654f\u6377A=10\n//\u683c\u95d8\uff1d\uff11"),we.initialize(),this.appendChild(we);let Me=new Ga("StandList_"+this.identifier);Me.initialize(),this.appendChild(Me)}};B([rt()],Vt.prototype,"rotate",void 0),B([rt()],Vt.prototype,"roll",void 0),B([rt()],Vt.prototype,"isDropShadow",void 0),B([rt()],Vt.prototype,"isShowChatBubble",void 0),B([rt()],Vt.prototype,"owner",void 0),Vt=jp=B([Xn("character")],Vt);let ua=class extends zn{constructor(){super(...arguments),this.name="",this.command="",this.dice=""}parseText(){return this.value?this.value.split(/[\r\n]+/).map(t=>{let e=null;if(e=(t=t.trim()).match(/([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[\-\u2015\uff0d~\uff5e][\s\u3000]*([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[:\uff1a](.+)/)){const i=+et.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-")),r=+et.toHalfWidth(e[2].replace(/[\-\uff0d\u2010]/,"-"));return i<=r?{range:{start:i,end:r},result:e[3]}:{range:{start:r,end:i},result:e[3]}}if(e=t.match(/([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[\-\u2015\uff0d~\uff5e][\s\u3000]*[\*\uff0a][\s\u3000]*[:\uff1a](.+)/))return{range:{start:+et.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-")),end:null},result:e[2]};if(e=t.match(/[\*\uff0a][\s\u3000]*[\-\u2015\uff0d~\uff5e][\s\u3000]*([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[:\uff1a](.+)/))return{range:{start:null,end:+et.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-"))},result:e[2]};if(e=t.match(/([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[:\uff1a](.+)/)){const i=+et.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-"));return{range:{start:i,end:i},result:e[2]}}return(e=t.match(/[\*\uff0a][\s\u3000]*[\-\u2015\uff0d~\uff5e][\*\uff0a][\s\u3000]*[:\uff1a](.+)/))||(e=t.match(/[\*\uff0a][\s\u3000]*[:\uff1a](.+)/))?{range:{start:null,end:null},result:e[1]}:null}).filter(t=>t):[]}};var Bs;B([rt()],ua.prototype,"name",void 0),B([rt()],ua.prototype,"command",void 0),B([rt()],ua.prototype,"dice",void 0),ua=B([Xn("dice-roll-table")],ua);let ho=Bs=class extends zn{static get instance(){return Bs._instance||(Bs._instance=new Bs("DiceRollTableList"),Bs._instance.initialize()),Bs._instance}get diceRollTables(){return this.children}addDiceRollTable(...t){let e=null;if(t[0]instanceof ua)e=t[0];else{let i=t[0];e=new ua(t[1]),e.name=i,e.initialize()}return this.appendChild(e)}parseInnerXml(t){for(let i of Bs.instance.children)i.destroy();let e=Bs.instance.toContext();e.syncData=this.toContext().syncData,Bs.instance.apply(e),Bs.instance.update(),super.parseInnerXml.apply(Bs.instance,[t]),this.destroy()}};ho=Bs=B([Xn("dice-roll-table-list")],ho);var fr=(()=>(function(n){n[n.NULL=0]="NULL",n[n.THUMBNAIL=1]="THUMBNAIL",n[n.COMPLETE=2]="COMPLETE",n[n.URL=1e3]="URL"}(fr||(fr={})),fr))();class bs{constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:""},this.isHidden=!1}get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob}get url(){return this.context.url}get isReady(){return fr.NULL<this.state}get state(){return this.url||this.blob?this.url&&!this.blob?fr.URL:fr.COMPLETE:fr.NULL}static createEmpty(t){let e=new bs;return e.context.identifier=t,e}static create(t){if("string"==typeof t){let e=new bs;return e.context.identifier=t,e.context.name=t,e.context.url=t,e}{let e=new bs;return e.apply(t),e}}static createAsync(t){return(0,en.Z)(function*(){return t instanceof File?yield bs._createAsync(t,t.name):t instanceof Blob?yield bs._createAsync(t):void 0})()}static _createAsync(t,e){return(0,en.Z)(function*(){let i=yield uo.readAsArrayBufferAsync(t),r=new bs;return r.context.identifier=yield uo.calcSHA256Async(i),r.context.name=e,r.context.blob=new Blob([i],{type:t.type}),r.context.type=r.context.blob.type,r.context.url=window.URL.createObjectURL(r.context.blob),r.context.name||(r.context.name=r.context.identifier),r})()}destroy(){this.revokeURLs()}apply(t){!this.context.identifier&&t.identifier&&(this.context.identifier=t.identifier),t.name&&(this.context.name=t.name),!this.context.blob&&t.blob&&(this.context.blob=t.blob),!this.context.type&&t.type&&(this.context.type=t.type),!this.context.url&&t.url&&(this.state!==fr.URL&&window.URL.revokeObjectURL(this.context.url),this.context.url=t.url),this.createURLs()}createURLs(){this.state!==fr.URL&&this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob))}revokeURLs(){this.state!==fr.URL&&window.URL.revokeObjectURL(this.context.url)}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url}}}var qa=(()=>(function(n){n[n.MASTER=0]="MASTER",n[n.AUDITION=1]="AUDITION"}(qa||(qa={})),qa))();class At{constructor(t){this.volumeType=qa.MASTER,this.audio=t}static get audioContext(){return At._audioContext||(At._audioContext=new(window.AudioContext||window.webkitAudioContext)),At._audioContext}static get volume(){return At._volume}static set volume(t){At._volume=t,At.masterGainNode.gain.setTargetAtTime(At._volume,At.audioContext.currentTime,.01)}static get auditionVolume(){return At._auditionVolume}static set auditionVolume(t){At._auditionVolume=t,At.auditionGainNode.gain.setTargetAtTime(At._auditionVolume,At.audioContext.currentTime,.01)}static get masterGainNode(){if(!At._masterGainNode){let t=At.audioContext.createGain();t.gain.setValueAtTime(At._volume,At.audioContext.currentTime),t.connect(At.audioContext.destination),At._masterGainNode=t}return At._masterGainNode}static get auditionGainNode(){if(!At._auditionGainNode){let t=At.audioContext.createGain();t.gain.setValueAtTime(At._auditionVolume,At.audioContext.currentTime),t.connect(At.audioContext.destination),At._auditionGainNode=t}return At._auditionGainNode}static get rootNode(){return At.masterGainNode}static get auditionNode(){return At.auditionGainNode}get audioElm(){return this._audioElm||(this._audioElm=new Audio,this._audioElm.onplay=()=>{},this._audioElm.onpause=()=>{this.mediaElementSource.disconnect()},this._audioElm.onended=()=>{this.mediaElementSource.disconnect()}),this._audioElm}get mediaElementSource(){return this._mediaElementSource||(this._mediaElementSource=At.audioContext.createMediaElementSource(this.audioElm)),this._mediaElementSource}get volume(){return this.audioElm.volume}set volume(t){this.audioElm.volume=t}get loop(){return this.audioElm.loop}set loop(t){this.audioElm.loop=t}get paused(){return this.audioElm.paused}static play(t,e=1){this.playBufferAsync(t,e)}play(t=this.audio){if(this.stop(),this.audio=t,!this.audio)return;let e=this.audio.url;t.state===fr.URL&&(At.cacheMap.has(t.identifier)?e=At.cacheMap.get(t.identifier).url:At.createCacheAsync(t)),this.mediaElementSource.connect(this.getConnectingAudioNode()),this.audioElm.src=e,this.audioElm.load(),this.audioElm.play().catch(i=>{console.warn(i)})}pause(){this.audioElm.pause()}stop(){!this.audioElm||(this.pause(),this.audioElm.currentTime=0,this.audioElm.src="",this.audioElm.load(),this.mediaElementSource.disconnect())}getConnectingAudioNode(){return this.volumeType===qa.AUDITION?At.auditionNode:At.rootNode}static playBufferAsync(t,e=1){return(0,en.Z)(function*(){let i=yield At.createBufferSourceAsync(t);if(!i)return;let r=At.audioContext.createGain();r.gain.setValueAtTime(e,At.audioContext.currentTime),r.connect(At.rootNode),i.connect(r),i.onended=()=>{i.stop(),i.disconnect(),r.disconnect(),i.buffer=null},i.start()})()}static createBufferSourceAsync(t){var e=this;return(0,en.Z)(function*(){if(!t)return null;try{let i=t.blob;if(t.state===fr.URL)if(At.cacheMap.has(t.identifier))i=At.cacheMap.get(t.identifier).blob;else{let o=yield At.createCacheAsync(t);i=o&&o.blob?o.blob:null}if(!i)return null;let r=yield e.decodeAudioDataAsync(i),s=At.audioContext.createBufferSource();return s.buffer=r,s}catch(i){return console.warn(i),null}})()}static decodeAudioDataAsync(t){return new Promise(function(){var e=(0,en.Z)(function*(i,r){At.audioContext.decodeAudioData(yield uo.readAsArrayBufferAsync(t),s=>i(s),s=>r(s))});return function(i,r){return e.apply(this,arguments)}}())}static getBlobAsync(t){return(0,en.Z)(function*(){if(t.blob)return t.blob;if(t.url.length<1)throw new Error("\u3048\u3063 \u306a\u306b\u305d\u308c\u6016\u3044");try{let e=yield fetch(t.url);if(!e.ok)throw new Error("Network response was not ok.");return yield e.blob()}catch(e){throw console.warn("There has been a problem with your fetch operation: ",e.message),e}})()}static createCacheAsync(t){return(0,en.Z)(function*(){let e={url:t.url,blob:null};try{e.blob=yield At.getBlobAsync(t)}catch(i){return console.error(i),e}return At.cacheMap.has(t.identifier)?At.cacheMap.get(t.identifier):(e.url=URL.createObjectURL(e.blob),At.cacheMap.set(t.identifier,e),e)})()}static resumeAudioContext(){At.audioContext.resume();let t=()=>{At.audioContext.resume(),document.removeEventListener("touchstart",t,!0),document.removeEventListener("mousedown",t,!0),console.log("resumeAudioContext")};document.addEventListener("touchstart",t,!0),document.addEventListener("mousedown",t,!0)}}At._volume=.5,At._auditionVolume=.5,At.cacheMap=new Map;class Lt{constructor(){this.hash={},console.log("AudioStorage ready...")}static get instance(){return Lt._instance||(Lt._instance=new Lt),Lt._instance}get audios(){let t=[];for(let e in this.hash)t.push(this.hash[e]);return t}destroy(){for(let t in this.hash)this.delete(t)}addAsync(t){var e=this;return(0,en.Z)(function*(){let i=yield bs.createAsync(t);return e._add(i)})()}add(t){let e;if("string"==typeof t)e=bs.create(t);else if(t instanceof bs)e=t;else{if(this.update(t))return this.hash[t.identifier];e=bs.create(t)}return this._add(e)}_add(t){return fr.COMPLETE<=t.state&&this.lazySynchronize(100),this.update(t)?this.hash[t.identifier]:(this.hash[t.identifier]=t,console.log("add Audio: "+t.identifier),t)}update(t){let e;e=t instanceof bs?t.toContext():t;let i=this.hash[t.identifier];return!!i&&(i.apply(t),!0)}delete(t){let e=this.hash[t];return!!e&&(e.destroy(),delete this.hash[t],!0)}get(t){return this.hash[t]||null}synchronize(t){this.lazyTimer&&this.lazyTimer.stop(),Fe.call("SYNCHRONIZE_AUDIO_LIST",this.getCatalog(),t)}lazySynchronize(t,e){null==this.lazyTimer&&(this.lazyTimer=new la(()=>this.synchronize(e),t)),this.lazyTimer.reset(t)}getCatalog(){let t=[];for(let e of Lt.instance.audios)fr.COMPLETE<=e.state&&t.push({identifier:e.identifier,state:e.state});return t}}var Hp=(()=>(function(n){n.ACTION="action",n.SEPARATOR="separator"}(Hp||(Hp={})),Hp))();const Tt={name:"",disabled:!0,type:Hp.SEPARATOR};let sr=(()=>{class n{constructor(){this.title="",this.actions=[],this.position={x:0,y:0},this.titleColor=Ue.CHAT_DEFAULT_COLOR,this.titleBold=!1}get isShow(){return!!this.panelComponentRef}open(e,i,r,s,o,c){let m;this.close(),s||(s=n.defaultParentViewContainerRef,console.log("Context Open")),m=s.createComponent(n.ContextMenuComponentClass,{index:s.length,injector:s.injector});const I=m.injector.get(n);I.panelComponentRef=m,i&&(I.actions=i),e&&(I.position.x=e.x,I.position.y=e.y),I.titleColor=o||Ue.CHAT_DEFAULT_COLOR,I.titleBold=c,I.title=null!=r?r:"",m.onDestroy(()=>{I.panelComponentRef=null})}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}}return n.ContextMenuComponentClass=null,n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=tn({token:n,factory:n.\u0275fac}),n})(),ai=(()=>{class n{constructor(e){this.ngZone=e,this.callbackOnPointerDown=i=>this.onPointerDown(i),this.callbackOnPointerMove=i=>this.onPointerMove(i),this.callbackOnPointerUp=i=>this.onPointerUp(i),this.callbackOnContextMenu=i=>this.onContextMenu(i),this._isAllowedToOpenContextMenu=!1,this.pointers=[{x:0,y:0,z:0,identifier:-1}],this.startPostion=this.pointers[0],this.primaryPointer=this.pointers[0],this._isDragging=!1}get isAllowedToOpenContextMenu(){return this._isAllowedToOpenContextMenu}get pointer(){return this.primaryPointer}get pointerX(){return this.primaryPointer.x}get pointerY(){return this.primaryPointer.y}get isDragging(){return this._isDragging}set isDragging(e){e!==this._isDragging&&this.ngZone.run(()=>this._isDragging=e)}initialize(){this.addEventListeners()}destroy(){this.removeEventListeners()}onPointerDown(e){this.onPointerMove(e),this._isAllowedToOpenContextMenu=!0,this.startPostion=this.pointers[0]}onPointerMove(e){e.touches?this.onTouchMove(e):this.onMouseMove(e),this.targetElement=e.target}onPointerUp(e){this.onPointerMove(e)}onMouseMove(e){let i={x:e.pageX,y:e.pageY,z:0,identifier:-9999};this.isSyntheticEvent(i)||(this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(i),this.pointers=[i],this.primaryPointer=i)}onTouchMove(e){let i=e.touches.length;if(!(i<1)){this.pointers=[];for(let r=0;r<i;r++){let s=e.touches[r],o={x:s.pageX,y:s.pageY,z:0,identifier:s.identifier};this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(o),this.pointers.push(o)}this.primaryPointer=this.pointers[0]}}onContextMenu(e){this._isAllowedToOpenContextMenu=!0,this.onPointerUp(e)}preventContextMenuIfNeeded(e,i=3){i**2<(e.x-this.startPostion.x)**2+(e.y-this.startPostion.y)**2&&(this._isAllowedToOpenContextMenu=!1)}isSyntheticEvent(e,i=15){for(let r of this.pointers)if(r.identifier!==e.identifier&&(e.x-r.x)**2+(e.y-r.y)**2<i**2)return!0;return!1}addEventListeners(){this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.addEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.addEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.addEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.addEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.addEventListener("touchend",this.callbackOnPointerUp,!0),document.body.addEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.addEventListener("drop",this.callbackOnPointerUp,!0),document.body.addEventListener("contextmenu",this.callbackOnContextMenu,!0)})}removeEventListeners(){document.body.removeEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.removeEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.removeEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.removeEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.removeEventListener("touchend",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.removeEventListener("drop",this.callbackOnPointerUp,!0),document.body.removeEventListener("contextmenu",this.callbackOnContextMenu,!0)}}return n.\u0275fac=function(e){return new(e||n)(rn(vn))},n.\u0275prov=tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Pi;!function(n){function e(i,r=0){return i=parseFloat(i),isNaN(i)?r:i}n.relation=function t(i,r,s=0){return"number"==typeof i?i:"string"==typeof i?(i=i.trim().toLowerCase()).indexOf("%")>0?e(i.replace("%",""),s)/100*r:i.indexOf("px")>0||i.indexOf("pt")>0?e(i.replace("px",""),s):i.indexOf("vw")>0?e(i.replace("vw",""),s)/100*window.innerWidth:i.indexOf("vh")>0?e(i.replace("vh",""),s)/100*window.innerHeight:i.indexOf("vm")>0?e(i.replace("vm",""),s)/100*Math.min(window.innerWidth,window.innerHeight):i.indexOf("em")>0?e(i.replace("em",""),s):"top"===i||"left"===i?0:"center"===i||"middle"===i?.5*r:"bottom"===i||"right"===i?r:s:s},n.parse=e}(Pi||(Pi={}));class Ls{constructor(t,e={capture:!1,passive:!1,always:!1}){this.target=t,this.callbackOnMouse=this.onMouse.bind(this),this.callbackOnTouch=this.onTouch.bind(this),this.callbackOnMenu=this.onMenu.bind(this),this.lastPointers=[],this.primaryPointer={x:0,y:0,z:0,identifier:-9999},this._isDragging=!1,this._isGrabbing=!1,this._isDestroyed=!1,this.option=null,this.option={capture:!0===e.capture,passive:!0===e.passive,always:!0===e.always},this.initialize()}get pointer(){return this.primaryPointer}get isDragging(){return this._isDragging}get isGrabbing(){return this._isGrabbing}get isDestroyed(){return this._isDestroyed}initialize(){this.target.addEventListener("mousedown",this.callbackOnMouse,this.option.capture),this.target.addEventListener("touchstart",this.callbackOnTouch,this.option.capture),this.option.always&&this.addEventListeners()}destroy(){this.cancel(),this._isDestroyed=!0,this.target.removeEventListener("mousedown",this.callbackOnMouse,this.option.capture),this.target.removeEventListener("touchstart",this.callbackOnTouch,this.option.capture),this.removeEventListeners()}cancel(){this._isDragging=this._isGrabbing=!1,this.option.always||this.removeEventListeners()}onMouse(t){let e={x:t.pageX,y:t.pageY,z:0,identifier:-9999};this.isSyntheticEvent(e)||(this.lastPointers=[e],this.primaryPointer=e,this.onPointer(t))}onTouch(t){let e=t.changedTouches.length;if(!(e<1)){this.lastPointers=[];for(let i=0;i<e;i++){let r=t.changedTouches[i];this.lastPointers.push({x:r.pageX,y:r.pageY,z:0,identifier:r.identifier})}if("touchstart"===t.type)this.primaryPointer=this.lastPointers[0];else{let r=Array.from(t.changedTouches).find(o=>o.identifier===this.primaryPointer.identifier);if(null==r)return void(null!=Array.from(t.touches).find(c=>c.identifier===this.primaryPointer.identifier)||(this.onEnd&&this.onEnd(t),this.cancel()));this.primaryPointer={x:r.pageX,y:r.pageY,z:0,identifier:r.identifier}}this.onPointer(t)}}onPointer(t){switch(t.type){case"mousedown":case"touchstart":this._isGrabbing=!0,this._isDragging=!1,this.addEventListeners(),this.onStart&&this.onStart(t);break;case"mousemove":case"touchmove":this.onMove&&this.onMove(t),this._isDragging=this._isGrabbing;break;default:this.onEnd&&this.onEnd(t),this.cancel()}}onMenu(t){this.onContextMenu&&this.onContextMenu(t)}isSyntheticEvent(t,e=15){for(let i of this.lastPointers)if(i.identifier!==t.identifier&&(t.x-i.x)**2+(t.y-i.y)**2<e**2)return!0;return!1}addEventListeners(){let t={capture:this.option.capture,passive:this.option.passive};this.target.ownerDocument.addEventListener("mousemove",this.callbackOnMouse,t),this.target.ownerDocument.addEventListener("mouseup",this.callbackOnMouse,t),this.target.ownerDocument.addEventListener("touchmove",this.callbackOnTouch,t),this.target.ownerDocument.addEventListener("touchend",this.callbackOnTouch,t),this.target.ownerDocument.addEventListener("touchcancel",this.callbackOnTouch,t),this.target.ownerDocument.addEventListener("contextmenu",this.callbackOnMenu,t),this.target.ownerDocument.addEventListener("drop",this.callbackOnMouse,t)}removeEventListeners(){let t={capture:this.option.capture};this.target.ownerDocument.removeEventListener("mousemove",this.callbackOnMouse,t),this.target.ownerDocument.removeEventListener("mouseup",this.callbackOnMouse,t),this.target.ownerDocument.removeEventListener("touchmove",this.callbackOnTouch,t),this.target.ownerDocument.removeEventListener("touchend",this.callbackOnTouch,t),this.target.ownerDocument.removeEventListener("touchcancel",this.callbackOnTouch,t),this.target.ownerDocument.removeEventListener("contextmenu",this.callbackOnMenu,t),this.target.ownerDocument.removeEventListener("drop",this.callbackOnMouse,t)}}let U0=(()=>{class n{constructor(e,i){this.ngZone=e,this.elementRef=i,this.isDisable=!1,this.boundsSelector="body",this.handleSelector="",this.unhandleSelector="input,textarea,button,select,option,span",this.stackSelector="",this.opacity=.7,this.allowOverHalf=!1,this.onstart=new Cn,this.onmove=new Cn,this.onend=new Cn,this.callbackOnResize=this.adjustPosition.bind(this),this.input=null,this.startPosition={x:0,y:0,z:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={x:0,y:0,z:0}}ngAfterViewInit(){this.initialize(),this.adjustPosition(),this.setForeground()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.input=new Ls(this.elementRef.nativeElement),window.addEventListener("resize",this.callbackOnResize,!1)}),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this)}cancel(){this.input.cancel()}destroy(){window.removeEventListener("resize",this.callbackOnResize,!1),this.input.destroy()}onInputStart(e){if(this.isDisable)return this.cancel();if(1===e.button||2===e.button)return this.cancel();this.setForeground(),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=this.input.pointer,this.prevTrans={x:0,y:0,z:0};let i=this.isHandleElement(e.target),r=this.isUnhandleElement(e.target),s=null!=e.touches&&this.isScrollableElement(e.target);!i||r||s?this.cancel():(this.elementRef.nativeElement.style.cursor="grabbing",e.stopPropagation())}onInputMove(e){let i={x:this.input.pointer.x-this.startPointer.x,y:this.input.pointer.y-this.startPointer.y,z:this.input.pointer.z-this.startPointer.z},s=this.calcCorrectionPosition({x:i.x-this.prevTrans.x,y:i.y-this.prevTrans.y,z:i.z-this.prevTrans.z});i.x+=s.x,i.y+=s.y,i.z+=s.z,0<i.x**2+i.y**2+i.z**2&&(this.elementRef.nativeElement.style.opacity=this.opacity+""),this.elementRef.nativeElement.style.willChange="top, left",this.elementRef.nativeElement.style.left=i.x+this.startPosition.x+"px",this.elementRef.nativeElement.style.top=i.y+this.startPosition.y+"px",this.elementRef.nativeElement.style.cursor="grabbing",this.prevTrans=i,e.cancelable&&e.preventDefault(),e.stopPropagation()}onInputEnd(e){this.elementRef.nativeElement.style.opacity=null,this.elementRef.nativeElement.style.cursor=null,this.elementRef.nativeElement.style.willChange=null,this.input.isDragging&&e.cancelable&&(this.preventClickIfNeeded(e),e.preventDefault()),e.stopPropagation()}onContextMenu(e){e.stopPropagation()}preventClickIfNeeded(e){if(null!=e.touches)return;if(225>(this.input.pointer.x-this.startPointer.x)**2+(this.input.pointer.y-this.startPointer.y)**2+(this.input.pointer.z-this.startPointer.z)**2)return;let c=m=>{m.cancelable&&m.preventDefault(),m.stopPropagation()};this.elementRef.nativeElement.addEventListener("click",c,!0),queueMicrotask(()=>this.elementRef.nativeElement.removeEventListener("click",c,!0))}adjustPosition(){let e=this.calcElementPosition(this.elementRef.nativeElement),i=this.calcCorrectionPosition();this.elementRef.nativeElement.style.left=i.x+e.x+"px",this.elementRef.nativeElement.style.top=i.y+e.y+"px"}isHandleElement(e){return this.handleSelector.length<1||this.isContainsElement(e,this.handleSelector)}isUnhandleElement(e){return!(this.unhandleSelector.length<1)&&this.isContainsElement(e,this.unhandleSelector)}isContainsElement(e,i){let r=this.elementRef.nativeElement.querySelectorAll(i);for(let s=0;s<r.length;s++)if(r[s].contains(e))return!0;return!1}isScrollableElement(e){let i=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector),r=e,s=["scroll","auto"],o=["fixed","sticky","-webkit-sticky"];for(;r&&i!==r&&this.elementRef.nativeElement!==r;){let c=window.getComputedStyle(r);if(0<=s.indexOf(c.overflowY)&&r.offsetHeight<r.scrollHeight)return!0;if(0<=o.indexOf(c.position))return!1;r=r.parentElement}return!1}calcCorrectionPosition(e={x:0,y:0,z:0}){let i={x:0,y:0,z:0},r=this.elementRef.nativeElement.getBoundingClientRect(),s=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();if(this.allowOverHalf){const o=r.right-r.left,c=r.bottom-r.top;s.right+o/2<r.right+e.x&&(i.x+=s.right+o/2-(r.right+e.x)),r.left+e.x<s.left-o/2&&(i.x+=s.left-o/2-(r.left+e.x)),s.bottom+c/2<r.bottom+e.y&&(i.y+=s.bottom+c/2-(r.bottom+e.y)),r.top+e.y<s.top-c/2&&(i.y+=s.top-c/2-(r.top+e.y))}else s.right<r.right+e.x&&(i.x+=s.right-(r.right+e.x)),r.left+e.x<s.left&&(i.x+=s.left-(r.left+e.x)),s.bottom<r.bottom+e.y&&(i.y+=s.bottom-(r.bottom+e.y)),r.top+e.y<s.top&&(i.y+=s.top-(r.top+e.y));return i}calcElementPosition(e){let i=window.getComputedStyle(e);return{x:Pi.relation(i.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),y:Pi.relation(i.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),z:0}}setForeground(){if(this.stackSelector.length<1)return;let e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),i=0,r=99999;e.forEach(s=>{let o=parseInt(s.style.zIndex);i<o&&(i=o),o<r&&(r=o)}),!(i<=parseInt(this.elementRef.nativeElement.style.zIndex))&&(e.forEach(s=>{s.style.zIndex=parseInt(s.style.zIndex)-r+""}),this.elementRef.nativeElement.style.zIndex=i+1+"")}}return n.\u0275fac=function(e){return new(e||n)(Le(vn),Le(_i))},n.\u0275dir=Xt({type:n,selectors:[["","appDraggable",""]],inputs:{isDisable:["draggable.disable","isDisable"],boundsSelector:["draggable.bounds","boundsSelector"],handleSelector:["draggable.handle","handleSelector"],unhandleSelector:["draggable.unhandle","unhandleSelector"],stackSelector:["draggable.stack","stackSelector"],opacity:["draggable.opacity","opacity"],allowOverHalf:["draggable.allowOverHalf","allowOverHalf"]},outputs:{onstart:"draggable.start",onmove:"draggable.move",onend:"draggable.end"}}),n})();class Wa extends le{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){const e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){const{hasError:t,thrownError:e,_value:i}=this;if(t)throw e;return this._throwIfClosed(),i}next(t){super.next(this._value=t)}}function Ka(...n){return Dr(n,Wo(n))}function Q3(n,t,e){return e?Q3(n,t).pipe(Td(e)):new f(i=>{const r=(...o)=>i.next(1===o.length?o[0]:o),s=n(r);return a(t)?()=>t(r,s):void 0})}function Ya(...n){const t=Wo(n),e=al(n),{args:i,keys:r}=Sx(n);if(0===i.length)return Dr([],t);const s=new f(J3(i,t,r?o=>Mx(r,o):h));return e?s.pipe(Td(e)):s}function J3(n,t,e=h){return i=>{eT(t,()=>{const{length:r}=n,s=new Array(r);let o=r,c=r;for(let m=0;m<r;m++)eT(t,()=>{const I=Dr(n[m],t);let Z=!1;I.subscribe(re(i,fe=>{s[m]=fe,Z||(Z=!0,c--),c||i.next(e(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}function eT(n,t,e){n?Ks(e,n,t):t()}function Oo(n){return n<=0?()=>ic:O((t,e)=>{let i=0;t.subscribe(re(e,r=>{++i<=n&&(e.next(r),n<=i&&e.complete())}))})}function Up(...n){return function O9(){return yf(1)}()(Dr(n,Wo(n)))}function tT(...n){const t=Wo(n);return O((e,i)=>{(t?Up(n,e,t):Up(n,e)).subscribe(i)})}function nT(n,t,e){const i=a(n)||t||e?{next:n,error:t,complete:e}:n;return i?O((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let c=!0;r.subscribe(re(s,m=>{var I;null===(I=i.next)||void 0===I||I.call(i,m),s.next(m)},()=>{var m;c=!1,null===(m=i.complete)||void 0===m||m.call(i),s.complete()},m=>{var I;c=!1,null===(I=i.error)||void 0===I||I.call(i,m),s.error(m)},()=>{var m,I;c&&(null===(m=i.unsubscribe)||void 0===m||m.call(i)),null===(I=i.finalize)||void 0===I||I.call(i)}))}):h}function V0(n){return O((t,e)=>{pr(n).subscribe(re(e,()=>e.complete(),G)),!e.closed&&t.subscribe(e)})}class B9 extends f{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,T(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,null==t||t.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new d;const e=this.getSubject();t.add(this.source.subscribe(re(e,void 0,()=>{this._teardown(),e.complete()},i=>{this._teardown(),e.error(i)},()=>this._teardown()))),t.closed&&(this._connection=null,t=d.EMPTY)}return t}refCount(){return function R9(){return O((n,t)=>{let e=null;n._refCount++;const i=re(t,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(e=null);const r=n._connection,s=e;e=null,r&&(!s||r===s)&&r.unsubscribe(),t.unsubscribe()});n.subscribe(i),i.closed||(e=n.connect())})}()(this)}}const z9={connector:()=>new le};function iT(n,t=z9){const{connector:e}=t;return O((i,r)=>{const s=e();pr(n(function L9(n){return new f(t=>n.subscribe(t))}(s))).subscribe(r),r.add(i.subscribe(s))})}function rT(n){return n?t=>iT(n)(t):t=>function j9(n,t){const e=a(n)?n:()=>n;return a(t)?iT(t,{connector:e}):i=>new B9(i,e)}(new le)(t)}function ef(n,t){return O((e,i)=>{let r=null,s=0,o=!1;const c=()=>o&&!r&&i.complete();e.subscribe(re(i,m=>{null==r||r.unsubscribe();let I=0;const Z=s++;pr(n(m,Z)).subscribe(r=re(i,fe=>i.next(t?t(m,fe,Z,I++):fe),()=>{r=null,c()}))},()=>{o=!0,c()}))})}function G0(...n){const t=al(n);return O((e,i)=>{const r=n.length,s=new Array(r);let o=n.map(()=>!1),c=!1;for(let m=0;m<r;m++)pr(n[m]).subscribe(re(i,I=>{s[m]=I,!c&&!o[m]&&(o[m]=!0,(c=o.every(h))&&(o=null))},G));e.subscribe(re(i,m=>{if(c){const I=[m,...s];i.next(t?t(...I):I)}}))})}function H9(n,t,e,i,r){return(s,o)=>{let c=e,m=t,I=0;s.subscribe(re(o,Z=>{const fe=I++;m=c?n(m,Z,fe):(c=!0,Z),i&&o.next(m)},r&&(()=>{c&&o.next(m),o.complete()})))}}function G9(n,t){return n===t}const{isArray:q9}=Array;function W9(n){return 1===n.length&&q9(n[0])?n[0]:n}function sT(...n){const t=al(n);return t?u(sT(...n),Td(t)):O((e,i)=>{J3([e,...W9(n)])(i)})}function Hl(n,t){return O((e,i)=>{let r=0;e.subscribe(re(i,s=>n.call(t,s,r++)&&i.next(s)))})}const Y9=["youtubeContainer"];let lT=(()=>{class n{constructor(e,i){this._ngZone=e,this._youtubeContainer=new le,this._destroyed=new le,this._playerChanges=new Wa(void 0),this._videoId=new Wa(void 0),this._height=new Wa(390),this._width=new Wa(640),this._startSeconds=new Wa(void 0),this._endSeconds=new Wa(void 0),this._suggestedQuality=new Wa(void 0),this._playerVars=new Wa(void 0),this.ready=this._getLazyEmitter("onReady"),this.stateChange=this._getLazyEmitter("onStateChange"),this.error=this._getLazyEmitter("onError"),this.apiChange=this._getLazyEmitter("onApiChange"),this.playbackQualityChange=this._getLazyEmitter("onPlaybackQualityChange"),this.playbackRateChange=this._getLazyEmitter("onPlaybackRateChange"),this._isBrowser=p$(i)}get videoId(){return this._videoId.value}set videoId(e){this._videoId.next(e)}get height(){return this._height.value}set height(e){this._height.next(e||390)}get width(){return this._width.value}set width(e){this._width.next(e||640)}set startSeconds(e){this._startSeconds.next(e)}set endSeconds(e){this._endSeconds.next(e)}set suggestedQuality(e){this._suggestedQuality.next(e)}get playerVars(){return this._playerVars.value}set playerVars(e){this._playerVars.next(e)}ngOnInit(){if(!this._isBrowser)return;let e=Ka(!0);if(!window.YT||!window.YT.Player){const r=new le;this._existingApiReadyCallback=window.onYouTubeIframeAPIReady,window.onYouTubeIframeAPIReady=()=>{this._existingApiReadyCallback&&this._existingApiReadyCallback(),this._ngZone.run(()=>r.next(!0))},e=r.pipe(Oo(1),tT(!1))}const i=function J9(n,t,e,i,r,s,o){const c=Ya([t,s]).pipe(G0(Ya([i,r])),ve(([m,I])=>{const[Z,fe]=m,[pe,ye]=I;return Z?{videoId:Z,playerVars:fe,width:pe,height:ye}:void 0}));return Ya([n,c,Ka(o)]).pipe(function e7(n){return u(sT(n),function K9(n){return O((t,e)=>{let i=!1,r=0;t.subscribe(re(e,s=>(i||(i=!n(s,r++)))&&e.next(s)))})}(([t,e])=>!e),ve(([t])=>t))}(e),function U9(n,t){return O(H9(n,t,arguments.length>=2,!0))}(t7,void 0),function V9(n,t=h){return n=null!=n?n:G9,O((e,i)=>{let r,s=!0;e.subscribe(re(i,o=>{const c=t(o);(s||!n(r,c))&&(s=!1,r=c,i.next(o))}))})}())}(this._youtubeContainer,this._videoId,e,this._width,this._height,this._playerVars,this._ngZone).pipe(nT(r=>{this._playerChanges.next(r)}),function Q9(n){return qo(t=>t?cT(t)?Ka(t):new f(e=>{let i=!1,r=!1;const s=o=>{r=!0,i||(o.target.removeEventListener("onReady",s),e.next(o.target))};return t.addEventListener("onReady",s),()=>{i=!0,r||n(t)}}).pipe(Oo(1),tT(void 0)):Ka(void 0))}(r=>{cT(r)||r.destroy()}),V0(this._destroyed),rT());i.subscribe(r=>{this._player=r,r&&this._pendingPlayerState&&this._initializePlayer(r,this._pendingPlayerState),this._pendingPlayerState=void 0}),function Z9(n,t,e){Ya([n,t,e]).subscribe(([i,r,s])=>i&&i.setSize(r,s))}(i,this._width,this._height),function X9(n,t){Ya([n,t]).subscribe(([e,i])=>e&&i&&e.setPlaybackQuality(i))}(i,this._suggestedQuality),function n7(n,t,e,i,r,s){const o=Ya([e,i]).pipe(ve(([Z,fe])=>({startSeconds:Z,endSeconds:fe}))),c=o.pipe(q0(n,Z=>!!Z&&!function i7(n){const t=n.getPlayerState();return t!==YT.PlayerState.UNSTARTED&&t!==YT.PlayerState.CUED}(Z))),m=t.pipe(q0(n,(Z,fe)=>!!Z&&Z.videoId!==fe));qr(n.pipe(q0(Ya([t,o]),([Z,fe],pe)=>!(!pe||Z==pe.videoId&&!fe.startSeconds&&!fe.endSeconds))),m,c).pipe(G0(Ya([n,t,o,r])),ve(([Z,fe])=>fe),V0(s)).subscribe(([Z,fe,pe,ye])=>{!fe||!Z||(Z.videoId=fe,Z.cueVideoById(Object.assign({videoId:fe,suggestedQuality:ye},pe)))})}(i,this._videoId,this._startSeconds,this._endSeconds,this._suggestedQuality,this._destroyed),i.connect()}ngAfterViewInit(){this._youtubeContainer.next(this.youtubeContainer.nativeElement)}ngOnDestroy(){this._player&&(this._player.destroy(),window.onYouTubeIframeAPIReady=this._existingApiReadyCallback),this._playerChanges.complete(),this._videoId.complete(),this._height.complete(),this._width.complete(),this._startSeconds.complete(),this._endSeconds.complete(),this._suggestedQuality.complete(),this._youtubeContainer.complete(),this._playerVars.complete(),this._destroyed.next(),this._destroyed.complete()}playVideo(){this._player?this._player.playVideo():this._getPendingState().playbackState=YT.PlayerState.PLAYING}pauseVideo(){this._player?this._player.pauseVideo():this._getPendingState().playbackState=YT.PlayerState.PAUSED}stopVideo(){this._player?this._player.stopVideo():this._getPendingState().playbackState=YT.PlayerState.CUED}seekTo(e,i){this._player?this._player.seekTo(e,i):this._getPendingState().seek={seconds:e,allowSeekAhead:i}}mute(){this._player?this._player.mute():this._getPendingState().muted=!0}unMute(){this._player?this._player.unMute():this._getPendingState().muted=!1}isMuted(){return this._player?this._player.isMuted():!!this._pendingPlayerState&&!!this._pendingPlayerState.muted}setVolume(e){this._player?this._player.setVolume(e):this._getPendingState().volume=e}getVolume(){return this._player?this._player.getVolume():this._pendingPlayerState&&null!=this._pendingPlayerState.volume?this._pendingPlayerState.volume:0}setPlaybackRate(e){if(this._player)return this._player.setPlaybackRate(e);this._getPendingState().playbackRate=e}getPlaybackRate(){return this._player?this._player.getPlaybackRate():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackRate?this._pendingPlayerState.playbackRate:0}getAvailablePlaybackRates(){return this._player?this._player.getAvailablePlaybackRates():[]}getVideoLoadedFraction(){return this._player?this._player.getVideoLoadedFraction():0}getPlayerState(){if(this._isBrowser&&window.YT)return this._player?this._player.getPlayerState():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackState?this._pendingPlayerState.playbackState:YT.PlayerState.UNSTARTED}getCurrentTime(){return this._player?this._player.getCurrentTime():this._pendingPlayerState&&this._pendingPlayerState.seek?this._pendingPlayerState.seek.seconds:0}getPlaybackQuality(){return this._player?this._player.getPlaybackQuality():"default"}getAvailableQualityLevels(){return this._player?this._player.getAvailableQualityLevels():[]}getDuration(){return this._player?this._player.getDuration():0}getVideoUrl(){return this._player?this._player.getVideoUrl():""}getVideoEmbedCode(){return this._player?this._player.getVideoEmbedCode():""}_getPendingState(){return this._pendingPlayerState||(this._pendingPlayerState={}),this._pendingPlayerState}_initializePlayer(e,i){const{playbackState:r,playbackRate:s,volume:o,muted:c,seek:m}=i;switch(r){case YT.PlayerState.PLAYING:e.playVideo();break;case YT.PlayerState.PAUSED:e.pauseVideo();break;case YT.PlayerState.CUED:e.stopVideo()}null!=s&&e.setPlaybackRate(s),null!=o&&e.setVolume(o),null!=c&&(c?e.mute():e.unMute()),null!=m&&e.seekTo(m.seconds,m.allowSeekAhead)}_getLazyEmitter(e){return this._playerChanges.pipe(ef(i=>i?Q3(r=>{i.addEventListener(e,r)},r=>{try{i.removeEventListener&&i.removeEventListener(e,r)}catch(s){}}):Ka()),i=>new f(r=>i.subscribe({next:s=>this._ngZone.run(()=>r.next(s)),error:s=>r.error(s),complete:()=>r.complete()})),V0(this._destroyed))}}return n.\u0275fac=function(e){return new(e||n)(Le(vn),Le(_d))},n.\u0275cmp=Zt({type:n,selectors:[["youtube-player"]],viewQuery:function(e,i){if(1&e&&on(Y9,5),2&e){let r;sn(r=an())&&(i.youtubeContainer=r.first)}},inputs:{videoId:"videoId",height:"height",width:"width",startSeconds:"startSeconds",endSeconds:"endSeconds",suggestedQuality:"suggestedQuality",playerVars:"playerVars",showBeforeIframeApiLoads:"showBeforeIframeApiLoads"},outputs:{ready:"ready",stateChange:"stateChange",error:"error",apiChange:"apiChange",playbackQualityChange:"playbackQualityChange",playbackRateChange:"playbackRateChange"},decls:2,vars:0,consts:[["youtubeContainer",""]],template:function(e,i){1&e&&it(0,"div",null,0)},encapsulation:2,changeDetection:0}),n})();function t7(n,[t,e,i]){if(n&&e&&n.playerVars!==e.playerVars)n.destroy();else{if(!e)return void(n&&n.destroy());if(n)return n}const r=i.runOutsideAngular(()=>new YT.Player(t,e));return r.videoId=e.videoId,r.playerVars=e.playerVars,r}function cT(n){return"getPlayerStatus"in n}function q0(n,t){return u(G0(n),Hl(([e,i])=>t(i,e)),ve(([e])=>e))}let r7=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ws({type:n}),n.\u0275inj=ls({}),n})(),ti=(()=>{class n{constructor(e){this._sanitizer=e}transform(e,i="html"){switch(i){case"html":return this._sanitizer.bypassSecurityTrustHtml(e);case"style":return this._sanitizer.bypassSecurityTrustStyle(e);case"script":return this._sanitizer.bypassSecurityTrustScript(e);case"url":return this._sanitizer.bypassSecurityTrustUrl(e);case"resourceUrl":return this._sanitizer.bypassSecurityTrustResourceUrl(e);default:throw new Error(`Invalid safe type specified: ${i}`)}}}return n.\u0275fac=function(e){return new(e||n)(Le(Tx,16))},n.\u0275pipe=mr({name:"safe",type:n,pure:!0}),n})();const s7=["cutInImageElement"],o7=["videoPlayerComponent"];function a7(n,t){1&n&&pn(0)}const tf=function(n,t,e,i,r,s,o){return{video:n,test:t,secret:e,minimaize:i,"is-bordered":r,"is-grab":s,"is-grabbing":o}};function l7(n,t){if(1&n){const e=Xe();K(0,"div",2,3),Te("@cutInNone.done",function(){De(e);const r=ge();return r.isVisible?null:r.end()})("dblclick",function(){return De(e),ge().stop()})("mousedown",function(){return De(e),ge().draggstart()})("mouseup",function(){return De(e),ge().draggend()})("mouseleave",function(){return De(e),ge().draggend()})("mouseout",function(){return De(e),ge().draggend()})("mousemove",function(){De(e);const r=ge();return!!r.isPointerDragging&&r.draggstart()}),xe(2,a7,1,0,"ng-container",4),J()}if(2&n){const e=ge(),i=Wt(6);Ke("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible&&!e.videoId?"auto":"none"),te("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInNone",void 0)("ngClass",Zc(17,tf,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),U(2),te("ngTemplateOutlet",i)}}function c7(n,t){1&n&&pn(0)}function u7(n,t){if(1&n){const e=Xe();K(0,"div",2,3),Te("@cutInFadeInOut.done",function(){De(e);const r=ge();return r.isVisible?null:r.end()})("dblclick",function(){return De(e),ge().stop()})("mousedown",function(){return De(e),ge().draggstart()})("mouseup",function(){return De(e),ge().draggend()})("mouseleave",function(){return De(e),ge().draggend()})("mouseout",function(){return De(e),ge().draggend()})("mousemove",function(){De(e);const r=ge();return!!r.isPointerDragging&&r.draggstart()}),xe(2,c7,1,0,"ng-container",4),J()}if(2&n){const e=ge(),i=Wt(6);Ke("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible&&!e.videoId?"auto":"none"),te("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInFadeInOut",void 0)("ngClass",Zc(17,tf,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),U(2),te("ngTemplateOutlet",i)}}function d7(n,t){1&n&&pn(0)}function f7(n,t){if(1&n){const e=Xe();K(0,"div",2,3),Te("@cutInBounceInOut.done",function(){De(e);const r=ge();return r.isVisible?null:r.end()})("dblclick",function(){return De(e),ge().stop()})("mousedown",function(){return De(e),ge().draggstart()})("mouseup",function(){return De(e),ge().draggend()})("mouseleave",function(){return De(e),ge().draggend()})("mouseout",function(){return De(e),ge().draggend()})("mousemove",function(){De(e);const r=ge();return!!r.isPointerDragging&&r.draggstart()}),xe(2,d7,1,0,"ng-container",4),J()}if(2&n){const e=ge(),i=Wt(6);Ke("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible?"auto":"none"),te("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInBounceInOut",void 0)("ngClass",Zc(17,tf,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),U(2),te("ngTemplateOutlet",i)}}function h7(n,t){1&n&&pn(0)}function p7(n,t){if(1&n){const e=Xe();K(0,"div",2,3),Te("@cutInOpenInOut.done",function(){De(e);const r=ge();return r.isVisible?null:r.end()})("dblclick",function(){return De(e),ge().stop()})("mousedown",function(){return De(e),ge().draggstart()})("mouseup",function(){return De(e),ge().draggend()})("mouseleave",function(){return De(e),ge().draggend()})("mouseout",function(){return De(e),ge().draggend()})("mousemove",function(){De(e);const r=ge();return!!r.isPointerDragging&&r.draggstart()}),xe(2,h7,1,0,"ng-container",4),J()}if(2&n){const e=ge(),i=Wt(6);Ke("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible?"auto":"none"),te("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInOpenInOut",void 0)("ngClass",Zc(17,tf,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),U(2),te("ngTemplateOutlet",i)}}function g7(n,t){1&n&&pn(0)}function m7(n,t){if(1&n){const e=Xe();K(0,"div",2,3),Te("@cutInOpenInOut2.done",function(){De(e);const r=ge();return r.isVisible?null:r.end()})("dblclick",function(){return De(e),ge().stop()})("mousedown",function(){return De(e),ge().draggstart()})("mouseup",function(){return De(e),ge().draggend()})("mouseleave",function(){return De(e),ge().draggend()})("mouseout",function(){return De(e),ge().draggend()})("mousemove",function(){De(e);const r=ge();return!!r.isPointerDragging&&r.draggstart()}),xe(2,g7,1,0,"ng-container",4),J()}if(2&n){const e=ge(),i=Wt(6);Ke("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible?"auto":"none"),te("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInOpenInOut2",void 0)("ngClass",Zc(17,tf,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),U(2),te("ngTemplateOutlet",i)}}function _7(n,t){1&n&&(K(0,"div",21),be(1,"TEST"),J())}function $7(n,t){1&n&&(K(0,"div",22),be(1,"TEST"),J())}function v7(n,t){1&n&&(K(0,"div",23),be(1,"TEST"),J())}function b7(n,t){1&n&&(K(0,"div",24),be(1,"TEST"),J())}function y7(n,t){1&n&&(K(0,"div",25)(1,"i",26),be(2,"visibility"),J(),be(3," For Your Eyes Only"),J())}function C7(n,t){1&n&&(K(0,"div",27),be(1,"For Your Eyes Only "),K(2,"i",26),be(3,"visibility"),J()())}function x7(n,t){if(1&n&&(K(0,"div",28)(1,"span")(2,"span",29),be(3),J()()()),2&n){const e=ge(2);U(1),Ke("color",e.senderColor),U(1),Ke("width",e.pixcelWidth-(e.isBordered?6:0),"px"),U(1),Ta("",e.senderName,"",e.isMine?"\uff08\u3042\u306a\u305f\uff09":"","")}}function w7(n,t){if(1&n&&(K(0,"div",30)(1,"span")(2,"span",29),be(3),J()()()),2&n){const e=ge(2);U(1),Ke("color",e.senderColor),U(1),Ke("width",e.pixcelWidth-(e.isBordered?6:0),"px"),U(1),Ta("",e.senderName,"",e.isMine?"\uff08\u3042\u306a\u305f\uff09":"","")}}function E7(n,t){if(1&n){const e=Xe();K(0,"div",31),Te("contextmenu",function(r){return De(e),ge(2).onContextMenu(r)}),J()}if(2&n){const e=ge(2);Ke("width",e.pixcelWidth,"px")("height",e.pixcelHeight,"px")}}const T7=function(n,t,e,i){return{autoplay:1,controls:0,start:n,loop:t,playsinline:1,rel:0,listType:"playlist",list:e,playlist:i,disablekb:1,fs:0,iv_load_policy:3,modestbranding:1}};function I7(n,t){if(1&n){const e=Xe();K(0,"youtube-player",32,33),Te("ready",function(r){return De(e),ge(2).onPlayerReady(r)})("stateChange",function(r){return De(e),ge(2).onPlayerStateChange(r)}),J()}if(2&n){const e=ge(2);Ke("visibility",e.videoId&&!e.isSoundOnly?"visible":"hidden"),te("videoId",e.videoId)("width",e.pixcelWidth-(e.isBordered?6:0))("height",e.pixcelHeight-(e.isBordered?6:0))("playerVars",oo(6,T7,e.cutIn.videoStart,e.cutIn&&e.cutIn.isLoop?1:0,e.playListId?e.playListId:null,e.playListId?null:e.videoId))}}function S7(n,t){if(1&n){const e=Xe();K(0,"img",34,35),Te("error",function(){return De(e),ge(2).onErrorFallback()}),J()}if(2&n){const e=ge(2);Ke("object-fit",e.objectFit),te("src","https://img.youtube.com/vi/"+e.videoId+"/hqdefault.jpg",Jt)}}function M7(n,t){if(1&n){const e=Xe();K(0,"img",36,35),Te("load",function(){return De(e),ge(2).onImageLoad()})("contextmenu",function(r){return De(e),ge(2).onContextMenu(r)}),Ct(2,"safe"),J()}if(2&n){const e=ge(2);Ke("object-fit",e.objectFit),te("src",xt(2,3,e.cutInImage.url,"resourceUrl"),Jt)}}const Vp=function(n){return{transform:n}};function k7(n,t){if(1&n){const e=Xe();xe(0,_7,2,0,"div",5),xe(1,$7,2,0,"div",6),xe(2,v7,2,0,"div",7),xe(3,b7,2,0,"div",8),xe(4,y7,4,0,"div",9),xe(5,C7,4,0,"div",10),xe(6,x7,4,6,"div",11),xe(7,w7,4,6,"div",12),K(8,"div",13),Te("contextmenu",function(r){return De(e),ge().onContextMenu(r)}),J(),K(9,"div",14),Te("contextmenu",function(r){return De(e),ge().onContextMenu(r)}),J(),K(10,"div",15),Te("contextmenu",function(r){return De(e),ge().onContextMenu(r)}),J(),K(11,"div",16),Te("contextmenu",function(r){return De(e),ge().onContextMenu(r)}),J(),xe(12,E7,1,4,"div",17),xe(13,I7,2,11,"youtube-player",18),xe(14,S7,2,3,"img",19),xe(15,M7,3,6,"img",20)}if(2&n){const e=ge();te("ngIf",e.isTest),U(1),te("ngIf",e.isTest),U(1),te("ngIf",e.isTest),U(1),te("ngIf",e.isTest),U(1),te("ngIf",e.isSecret),U(1),te("ngIf",e.isSecret),U(1),te("ngIf",e.isIndicateSender),U(1),te("ngIf",e.isIndicateSender),U(1),Ke("width",e.pixcelWidth+3,"px")("height",19,"px"),te("ngStyle",ut(32,Vp,"translateX(-"+(e.isBordered?6:3)+"px) translateY(-"+(e.isBordered?6:3)+"px)")),U(1),Ke("width",e.pixcelWidth+3,"px")("height",19,"px"),te("ngStyle",ut(34,Vp,"translateX("+(e.isBordered?6:3)+"px) translateY("+(e.isBordered?6:3)+"px)")),U(1),Ke("width",19,"px")("height",e.pixcelHeight+3,"px"),te("ngStyle",ut(36,Vp,"translateX(-"+(e.isBordered?6:3)+"px) translateY(-"+(e.isBordered?6:3)+"px)")),U(1),Ke("width",19,"px")("height",e.pixcelHeight+3,"px"),te("ngStyle",ut(38,Vp,"translateX("+(e.isBordered?6:3)+"px) translateY("+(e.isBordered?6:3)+"px)")),U(1),te("ngIf",!e.videoId),U(1),te("ngIf",e.videoId),U(1),te("ngIf",e.videoId&&!e.isSoundOnly),U(1),te("ngIf",!e.videoId||e.isSoundOnly)}}let uT=(()=>{class n{constructor(e,i,r){this.pointerDeviceService=e,this.contextMenuService=i,this.ngZone=r,this.animationType=0,this._imageFile=Ht.Empty,this._isVisible=!1,this._isEnd=!1,this.videoStateTransition=!1,this.isMinimize=!1,this.isBackyard=!1,this.isSecret=!1,this.isTest=!1,this.isIndicateSender=!1,this.sender="",this.videoId="",this.playListId="",this.cutInImageTransformOrigin="center",this._naturalWidth=0,this._naturalHeight=0,this._dragging=!1,this.audioPlayer=new At}get naturalWidth(){return this.videoId&&!this.isSoundOnly?480:this._naturalWidth}get naturalHeight(){return this.videoId&&!this.isSoundOnly?270:this._naturalHeight}ngOnInit(){Fe.register(this).on("CHANGE_JUKEBOX_VOLUME",-100,e=>{this.videoPlayer&&this.videoPlayer.setVolume(this.videoVolume)}).on("PLAY_VIDEO_CUT_IN",-1e3,e=>{this.cutIn&&this.cutIn.identifier!=e.data.identifier&&this.videoId&&this.stop()})}ngOnDestroy(){Fe.unregister(this,"UPDATE_AUDIO_RESOURE"),Fe.unregister(this,"CHANGE_JUKEBOX_VOLUME"),Fe.unregister(this,"PLAY_VIDEO_CUT_IN"),clearTimeout(this._timeoutId),clearTimeout(this._timeoutIdVideo)}get isPointerDragging(){return this._dragging}draggstart(){this.ngZone.run(()=>{this._dragging=!0})}draggend(){this.ngZone.run(()=>{this._dragging=!1})}get isVisible(){return this.cutIn&&this._isVisible}set isVisible(e){this._isVisible=e}get isEnd(){return!this.cutIn||this._isEnd}get cutInImage(){if(!this.cutIn)return this._imageFile;if(this._imageFile.identifier!==this.cutIn.imageIdentifier){let e=kt.instance.get(this.cutIn.imageIdentifier);this._imageFile=e||Ht.Empty}return this._imageFile}get pixcelWidthPreAdjust(){if(this.isMinimize)return n.MIN_SIZE;let e=0;return this.cutIn&&(e=this.cutIn.width<=0&&this.cutIn.height<=0?this.naturalWidth:this.cutIn.width<=0?document.documentElement.offsetHeight*this.cutIn.height*(this.naturalWidth/this.naturalHeight)/100:document.documentElement.clientWidth*this.cutIn.width/100),e}get pixcelWidth(){let e=this.pixcelWidthPreAdjust;return(this.cutIn.isPreventOutBounds||this.videoId)&&(this.isAjustAspect?this.isAjustAspectWidth?e=document.documentElement.clientWidth:e*=document.documentElement.offsetHeight/this.pixcelHeightPreAdjust:e>document.documentElement.clientWidth&&(e=document.documentElement.clientWidth)),!this.isMinimize&&(this.cutIn.width<=0||this.cutIn.height<=0)&&this.pixelWidthAspectMinimun>e?e=this.pixelWidthAspectMinimun:e<n.MIN_SIZE&&(e=n.MIN_SIZE),e}get pixcelHeightPreAdjust(){if(this.isMinimize)return n.MIN_SIZE;let e=0;return this.cutIn&&(e=this.cutIn.width<=0&&this.cutIn.height<=0?this.naturalHeight:this.cutIn.height<=0?document.documentElement.clientWidth*this.cutIn.width*(this.naturalHeight/this.naturalWidth)/100:document.documentElement.offsetHeight*this.cutIn.height/100),e}get pixelWidthAspectMinimun(){let e=n.MIN_SIZE;return this.cutIn&&this.naturalWidth>this.naturalHeight&&(e=n.MIN_SIZE*this.naturalWidth/this.naturalHeight),e}get pixcelHeight(){let e=this.pixcelHeightPreAdjust;return(this.cutIn.isPreventOutBounds||this.videoId)&&(this.isAjustAspect?this.isAjustAspectWidth?e*=document.documentElement.offsetWidth/this.pixcelWidthPreAdjust:e=document.documentElement.offsetHeight:e>document.documentElement.offsetHeight&&(e=document.documentElement.offsetHeight)),!this.isMinimize&&(this.cutIn.width<=0||this.cutIn.height<=0)&&this.pixelHeightAspectMinimun>e?e=this.pixelHeightAspectMinimun:e<n.MIN_SIZE&&(e=n.MIN_SIZE),e}get pixelHeightAspectMinimun(){let e=n.MIN_SIZE;return this.cutIn&&this.naturalWidth<this.naturalHeight&&(e=n.MIN_SIZE*this.naturalHeight/this.naturalWidth),e}get isAjustAspect(){return(this.cutIn.width<=0||this.cutIn.height<=0)&&(this.pixcelWidthPreAdjust>document.documentElement.clientWidth||this.pixcelHeightPreAdjust>document.documentElement.offsetHeight)}get isAjustAspectWidth(){const e=this.pixcelWidthPreAdjust;return e>document.documentElement.clientWidth?!(document.documentElement.offsetHeight<this.pixcelHeightPreAdjust*(document.documentElement.clientWidth/e)):(document,!1)}get pixcelPosX(){let e=0;if(!this.cutIn)return e;if(e=document.documentElement.clientWidth*this.cutIn.posX/100-this.pixcelWidth/2,this.cutIn.isPreventOutBounds||this.videoId){const i=this.pixcelWidth/2-document.documentElement.clientWidth*this.cutIn.posX/100;i>0&&(e+=i);const r=-(document.documentElement.clientWidth-document.documentElement.clientWidth*this.cutIn.posX/100-this.pixcelWidth/2);r>0&&(e-=r)}return e}get pixcelPosY(){let e=0;if(!this.cutIn)return e;if(e=document.documentElement.offsetHeight*this.cutIn.posY/100-this.pixcelHeight/2,this.cutIn.isPreventOutBounds||this.videoId){const i=this.pixcelHeight/2-document.documentElement.offsetHeight*this.cutIn.posY/100;i>0&&(e+=i);const r=-(document.documentElement.offsetHeight-document.documentElement.offsetHeight*this.cutIn.posY/100-this.pixcelHeight/2);r>0&&(e-=r)}return e}get zIndex(){return!this.cutIn||this.isBackyard?0:(this.cutIn.isFrontOfStand||this.videoId?15e5:5e5)+this.cutIn.zIndex+(this.videoId?1e3:0)}get objectFit(){return this.cutIn?this.isMinimize||this.videoId&&!this.isSoundOnly||2==this.cutIn.objectFitType?"contain":1==this.cutIn.objectFitType?"cover":"fill":"none"}get videoVolume(){return 100*(this.isTest?At.auditionVolume:At.volume)}get isBordered(){return this.cutIn&&this.cutIn.borderStyle>0}get isSoundOnly(){return this.cutIn&&this.cutIn.isSoundOnly}get senderName(){let e="";if(!this.sender)return e;let i=Ue.findByPeerId(this.sender);return i instanceof Ue&&(e=i.name),e}get isMine(){return this.sender===Ue.myCursor.peerId}get senderColor(){let e=Ue.CHAT_DEFAULT_COLOR;if(!this.sender)return e;let i=Ue.findByPeerId(this.sender);return i instanceof Ue&&(e=i.color),e}play(){this.isEnd||(this._isVisible?this.cutIn.videoId||this.audioPlayer.play():(this.ngZone.run(()=>{this._isVisible=!0,this.cutIn.videoId||this._play()}),this.cutIn.duration>0&&(this._timeoutId=setTimeout(()=>{this.stop(),clearTimeout(this._timeoutId),this._timeoutId=null},1e3*this.cutIn.duration))))}_play(){if(this.isEnd)return;const e=Lt.instance.get(this.cutIn.audioIdentifier);e&&e.isReady?(this.audioPlayer.volumeType=this.isTest?qa.AUDITION:qa.MASTER,this.audioPlayer.loop=this.cutIn.isLoop,this.cutIn.videoId||this.audioPlayer.play(e)):Fe.register(this).on("UPDATE_AUDIO_RESOURE",-100,i=>{this.cutIn.videoId||this._play()})}pause(){this.cutIn.videoId||this.audioPlayer.pause()}stop(){Fe.unregister(this,"UPDATE_AUDIO_RESOURE"),this.ngZone.run(()=>{this._isVisible=!1,this._dragging=!1,this.audioPlayer.stop()})}end(){this._isEnd=!0,this.audioPlayer.stop()}onImageLoad(){this._naturalWidth=this.cutInImageElement.nativeElement.naturalWidth,this._naturalHeight=this.cutInImageElement.nativeElement.naturalHeight}onPlayerReady(e){e.target.setVolume(this.videoVolume),e.target.playVideo()}onPlayerStateChange(e){const i=e.data;1==i&&(this.videoStateTransition=!0,this._timeoutIdVideo=setTimeout(()=>{this.ngZone.run(()=>{this.videoStateTransition=!1,this._timeoutIdVideo=null})},200),this.cutIn&&Fe.trigger("PLAY_VIDEO_CUT_IN",{identifier:this.cutIn.identifier})),2==i&&(this.videoStateTransition=!0,this._timeoutIdVideo=setTimeout(()=>{this.ngZone.run(()=>{this.videoStateTransition=!1,this._timeoutIdVideo=null})},200)),5==i&&(this.videoStateTransition=!0,this._timeoutIdVideo=setTimeout(()=>{this.ngZone.run(()=>{this.videoStateTransition=!1,this._timeoutIdVideo=null})},200))}onErrorFallback(){console.log("fallback"),this.videoId&&(this.cutInImageElement.nativeElement.src="https://img.youtube.com/vi/"+this.videoId+"/default.jpg")}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:"\u9589\u3058\u308b\uff08\u81ea\u5206\u306e\u307f\u505c\u6b62\uff09",action:()=>{this.stop()},default:!0,selfOnly:!0},Tt,{name:(this.isIndicateSender?"\u2611":"\u2610")+"\u9001\u4fe1\u8005\u3092\u8868\u793a",action:()=>{this.isIndicateSender=!this.isIndicateSender},selfOnly:!0},{name:(this.isBackyard?"\u2611":"\u2610")+"\u30a6\u30a3\u30f3\u30c9\u30a6\u306e\u80cc\u5f8c\u306b\u8868\u793a",action:()=>{this.isBackyard=!this.isBackyard},selfOnly:!0},{name:(this.isMinimize?"\u2611":"\u2610")+"\u6700\u5c0f\u5316",action:()=>{this.isMinimize=!this.isMinimize},selfOnly:!0}],this.cutIn.name)}}return n.MIN_SIZE=250,n.\u0275fac=function(e){return new(e||n)(Le(ai),Le(sr),Le(vn))},n.\u0275cmp=Zt({type:n,selectors:[["cut-in"]],viewQuery:function(e,i){if(1&e&&(on(s7,5),on(o7,5)),2&e){let r;sn(r=an())&&(i.cutInImageElement=r.first),sn(r=an())&&(i.videoPlayer=r.first)}},hostBindings:function(e,i){1&e&&Te("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{cutIn:"cutIn",animationType:"animationType"},decls:7,vars:5,consts:[["appDraggable","","class","container","style","position: absolute",3,"draggable.allowOverHalf","draggable.unhandle","width","height","left","top","z-index","pointer-events","ngClass","dblclick","mousedown","mouseup","mouseleave","mouseout","mousemove",4,"ngIf"],["image",""],["appDraggable","",1,"container",2,"position","absolute",3,"draggable.allowOverHalf","draggable.unhandle","ngClass","dblclick","mousedown","mouseup","mouseleave","mouseout","mousemove"],["cutInContainerElement",""],[4,"ngTemplateOutlet"],["class","test-indicator grow left-top",4,"ngIf"],["class","test-indicator grow right-top",4,"ngIf"],["class","test-indicator grow left-bottom",4,"ngIf"],["class","test-indicator grow right-bottom",4,"ngIf"],["class","secret-indicator grow left-top",4,"ngIf"],["class","secret-indicator grow right-bottom","style","text-align: right",4,"ngIf"],["class","name-indicator grow right-top","style","text-align: right",4,"ngIf"],["class","name-indicator grow left-bottom",4,"ngIf"],[1,"handler","top",3,"ngStyle","contextmenu"],[1,"handler","bottom",3,"ngStyle","contextmenu"],[1,"handler","left",3,"ngStyle","contextmenu"],[1,"handler","right",3,"ngStyle","contextmenu"],["style","pointer-events: auto","class","handler",3,"width","height","contextmenu",4,"ngIf"],["style","position: absolute; pointer-events: auto","suggestedQuality","default",3,"visibility","videoId","width","height","playerVars","ready","stateChange",4,"ngIf"],["style","pointer-events: auto","draggable","false",3,"object-fit","src","error",4,"ngIf"],["style","pointer-events: none","draggable","false",3,"object-fit","src","load","contextmenu",4,"ngIf"],[1,"test-indicator","grow","left-top"],[1,"test-indicator","grow","right-top"],[1,"test-indicator","grow","left-bottom"],[1,"test-indicator","grow","right-bottom"],[1,"secret-indicator","grow","left-top"],[1,"material-icons",2,"font-size","smaller"],[1,"secret-indicator","grow","right-bottom",2,"text-align","right"],[1,"name-indicator","grow","right-top",2,"text-align","right"],[2,"display","inline-block","white-space","nowrap","overflow","hidden","text-overflow","ellipsis"],[1,"name-indicator","grow","left-bottom"],[1,"handler",2,"pointer-events","auto",3,"contextmenu"],["suggestedQuality","default",2,"position","absolute","pointer-events","auto",3,"videoId","width","height","playerVars","ready","stateChange"],["videoPlayerComponent",""],["draggable","false",2,"pointer-events","auto",3,"src","error"],["cutInImageElement",""],["draggable","false",2,"pointer-events","none",3,"src","load","contextmenu"]],template:function(e,i){1&e&&(xe(0,l7,3,25,"div",0),xe(1,u7,3,25,"div",0),xe(2,f7,3,25,"div",0),xe(3,p7,3,25,"div",0),xe(4,m7,3,25,"div",0),xe(5,k7,16,40,"ng-template",null,1,Ln)),2&e&&(te("ngIf",i.isVisible&&-1==i.animationType),U(1),te("ngIf",i.isVisible&&0==i.animationType),U(1),te("ngIf",i.isVisible&&1==i.animationType),U(1),te("ngIf",i.isVisible&&2==i.animationType),U(1),te("ngIf",i.isVisible&&3==i.animationType))},directives:[_n,U0,Wn,wl,Zi,lT],pipes:[ti],styles:[".container[_ngcontent-%COMP%]{margin:0;padding:0}.container.video[_ngcontent-%COMP%]{background-color:#000}.is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}img[_ngcontent-%COMP%]{margin:0;padding:0;width:100%;height:100%}.container[_ngcontent-%COMP%]:hover{outline:3px dotted #22F}.container.minimaize[_ngcontent-%COMP%]{outline:3px solid #22F}.container.is-bordered[_ngcontent-%COMP%]{border:3px ridge #dde}.container.is-bordered[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:1px solid black;box-sizing:border-box}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.test-indicator[_ngcontent-%COMP%]{position:absolute;pointer-events:none;z-index:5;color:#00f;font-size:smaller;padding:0 3px 1px;font-weight:bolder}.secret-indicator[_ngcontent-%COMP%]{position:absolute;pointer-events:none;z-index:5;color:gray;font-size:smaller;padding:0 3px 2px;font-weight:bolder;opacity:.6}.name-indicator[_ngcontent-%COMP%]{position:absolute;pointer-events:none;z-index:10;padding:0 3px 0 6px;font-weight:bolder;font-size:smaller}.left-top[_ngcontent-%COMP%]{left:0px;top:0px}.left-bottom[_ngcontent-%COMP%]{left:0px;bottom:0px}.right-top[_ngcontent-%COMP%]{right:0px;top:0px}.right-bottom[_ngcontent-%COMP%]{right:0px;bottom:0px}.handler[_ngcontent-%COMP%]{position:absolute;z-index:20;pointer-events:auto}.handler.top[_ngcontent-%COMP%]{top:0px;left:0px}.handler.bottom[_ngcontent-%COMP%]{bottom:0px;right:0px}.handler.left[_ngcontent-%COMP%]{top:0px;left:0px}.handler.right[_ngcontent-%COMP%]{right:0px;bottom:0px}"],data:{animation:[xn("cutInNone",[Bt("void => *",[Ft("10ms ease-in",nn([Ye({opacity:0,offset:0}),Ye({opacity:1,offset:1})]))]),Bt("* => void",[Ft("10ms ease-in",nn([Ye({opacity:0,offset:1})]))])]),xn("cutInFadeInOut",[Bt("void => *",[Ft("330ms ease-in",nn([Ye({opacity:0,offset:0}),Ye({opacity:1,offset:1})]))]),Bt("* => void",[Ft("330ms ease-in",nn([Ye({opacity:1,offset:0}),Ye({opacity:0,offset:1})]))])]),xn("cutInBounceInOut",[Bt("void => *",[Ft("600ms ease",nn([Ye({transform:"scale3d(0, 0, 0)",offset:0}),Ye({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),Ye({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),Ye({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),Ye({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Bt("* => void",[Ft(100,Ye({transform:"scale3d(0, 0, 0)"}))])]),xn("cutInOpenInOut",[Bt("void => *",[Ft("262ms ease",nn([Ye({opacity:0,transform:"scale3d(0, 1.0, 1.0)",offset:0}),Ye({opacity:1,transform:"scale3d(1.1, 1.0, 1.0)",offset:.875}),Ye({opacity:1,transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Bt("* => void",[Ft(100,Ye({opacity:0,transform:"scale3d(0, 1.0, 1.0)"}))])]),xn("cutInOpenInOut2",[Bt("void => *",[Ft("262ms ease",nn([Ye({opacity:0,transform:"scale3d(1.0, 0, 1.0)",offset:0}),Ye({opacity:1,transform:"scale3d(1.0, 1.1, 1.0)",offset:.875}),Ye({opacity:1,transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Bt("* => void",[Ft(100,Ye({opacity:0,transform:"scale3d(1.0, 0, 1.0)"}))])])]}}),n})(),Gp=(()=>{class n{constructor(){}static nowShowingIdentifiers(){return this.cutInComponentRefQueue.filter(e=>e&&e.instance&&e.instance.cutIn&&e.instance.isVisible).map(e=>e.instance.cutIn.identifier)}play(e,i=!1,r=!1,s=null){if(!e)return;for(const c of n.cutInComponentRefQueue)if(c&&c.instance){const m=c.instance;if(m.isEnd)c.destroy();else{const I=m.cutIn;(e.identifier===I.identifier||e.videoId&&I.videoId||null!=e.tag&&""!=e.tag.trim()&&null!=I.tag&&""!=I.tag.trim()&&et.toHalfWidth(e.tag).toUpperCase().trim()==et.toHalfWidth(I.tag).toUpperCase().trim())&&m.stop()}}n.cutInComponentRefQueue=n.cutInComponentRefQueue.filter(c=>c&&c.instance);const o=n.defaultParentViewContainerRef.createComponent(uT);o.instance.cutIn=e,o.instance.animationType=e.animationType,o.instance.videoId=e.videoId,o.instance.playListId=e.playListId,o.instance.isSecret=i,o.instance.isTest=r,o.instance.sender=s,o.instance.play(),n.cutInComponentRefQueue.push(o)}stop(e){if(e){e instanceof vi&&(e=e.identifier);for(const i of n.cutInComponentRefQueue)if(i&&i.instance){const r=i.instance;r.isEnd?i.destroy():e===r.cutIn.identifier&&r.stop()}n.cutInComponentRefQueue=n.cutInComponentRefQueue.filter(i=>i&&i.instance)}}}return n.cutInComponentRefQueue=[],n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),vi=class extends zn{constructor(){super(...arguments),this.name="",this.tag="",this.duration=6,this.width=0,this.height=0,this.posX=50,this.posY=50,this.zIndex=0,this.objectFitType=0,this.animationType=0,this.borderStyle=0,this.isFrontOfStand=!1,this.isPreventOutBounds=!1,this.imageIdentifier=Ht.Empty.identifier,this.isVideoCutIn=!1,this.videoUrl="",this.isSoundOnly=!1,this.audioFileName="",this.audioIdentifier="",this.isLoop=!1}get videoId(){if(!this.isVideoCutIn||!this.videoUrl)return"";let t="";if(!et.validUrl(this.videoUrl))return"";{const e=new URL(this.videoUrl).hostname;if("youtube.com"==e||"www.youtube.com"==e){let i=this.videoUrl.split("v=");i[1]&&(t=encodeURI(i[1].split(/[\?\&\#\/]/)[0]))}else{if("youtu.be"!=e)return"";{let i=this.videoUrl.split("youtu.be/");i[1]&&(t=encodeURI(i[1].split(/[\?\&\#\/]/)[0]))}}}return t.replace(/[\<\>\/\:\s\r\n]/g,"")}get videoStart(){if(!this.isVideoCutIn||!this.videoUrl||!this.videoId)return null;const t=/[\&\?](?:start|t)\=([\dhms]+)/i.exec(this.videoUrl);return t&&t[1]?this._sec(t[1]):null}_sec(t){if(!t)return null;let e=null;if(e=/^(\d+)$/.exec(t))return e[1];if(e=/^(?:(\d+)h)?(?:(\d+)m)?(?:(\d+)s)?$/i.exec(t)){let i=0;return e[1]&&(i+=60*+e[1]*60),e[2]&&(i+=60*+e[2]),e[3]&&(i+=+e[3]),""+i}return null}get playListId(){if(!this.isVideoCutIn||!this.videoId)return"";let t="";if(!et.validUrl(this.videoUrl))return"";{let e=this.videoUrl.split("list=");e[1]&&(t=encodeURI(e[1].split(/[\&\#\/]/)[0]))}return t.replace(/[\<\>\/\:\s\r\n]/g,"")}get isValidAudio(){return 0==this.audioFileName.length||0==this.audioIdentifier.length||!!Lt.instance.get(this.audioIdentifier)}get postfixes(){return null==this.value||""==(this.value+"").trim()?[]:Array.from(new Set(this.value.split(/[\r\n]+/g).map(t=>null!=t?t.trimRight():""))).filter(t=>""!=t)}get isPlayingNow(){return Gp.nowShowingIdentifiers().includes(this.identifier)}};var zs;B([rt()],vi.prototype,"name",void 0),B([rt()],vi.prototype,"tag",void 0),B([rt()],vi.prototype,"duration",void 0),B([rt()],vi.prototype,"width",void 0),B([rt()],vi.prototype,"height",void 0),B([rt()],vi.prototype,"posX",void 0),B([rt()],vi.prototype,"posY",void 0),B([rt()],vi.prototype,"zIndex",void 0),B([rt()],vi.prototype,"objectFitType",void 0),B([rt()],vi.prototype,"animationType",void 0),B([rt()],vi.prototype,"borderStyle",void 0),B([rt()],vi.prototype,"isFrontOfStand",void 0),B([rt()],vi.prototype,"isPreventOutBounds",void 0),B([rt()],vi.prototype,"imageIdentifier",void 0),B([rt()],vi.prototype,"isVideoCutIn",void 0),B([rt()],vi.prototype,"videoUrl",void 0),B([rt()],vi.prototype,"audioFileName",void 0),B([rt()],vi.prototype,"audioIdentifier",void 0),B([rt()],vi.prototype,"isLoop",void 0),vi=B([Xn("cut-in")],vi);let po=zs=class extends zn{static get instance(){return zs._instance||(zs._instance=new zs("CutInList"),zs._instance.initialize()),zs._instance}get cutIns(){return this.children}addCutIn(...t){let e=null;if(t[0]instanceof vi)e=t[0];else{let i=t[0];e=new vi(t[1]),e.name=i,e.initialize()}return this.appendChild(e)}parseInnerXml(t){for(let i of zs.instance.children)i.destroy();let e=zs.instance.toContext();e.syncData=this.toContext().syncData,zs.instance.apply(e),zs.instance.update(),super.parseInnerXml.apply(zs.instance,[t]),this.destroy()}matchCutInInfo(t){t=et.toHalfWidth(t).toUpperCase().trimRight();let e="",i=new Map;const r=[];for(const c of this.cutIns.map(m=>[Math.random(),m]).sort((m,I)=>m[0]-I[0]).map(m=>m[1])){if(!c)continue;let m=!1;for(const I of c.postfixes)t.endsWith(et.toHalfWidth(I).toUpperCase().trimRight())&&(m=!0,("@"==I.slice(0,1)||"\uff20"==I.slice(0,1))&&e.length<I.length&&(e=I));if(m){const I=c.tag;null!=I&&I.trim().length>0?i.set(et.toHalfWidth(I).toUpperCase().trim(),c):r.push(c)}}r.push(...i.values());const o=r.map(c=>[Math.random(),c]).sort((c,m)=>c[0]-m[0]);return{names:o.map(c=>c[1].name),identifiers:o.map(c=>c[1].identifier),matchMostLongText:e}}};var cn;po=zs=B([Xn("cut-in-list")],po);let jn=cn=class extends Ua{constructor(t,e=null){super(t),this.chatMessageService=e}onStoreAdded(){var t=this;super.onStoreAdded(),Fe.register(this).on("SEND_MESSAGE",function(){var e=(0,en.Z)(function*(i){const r=lt.instance.get(i.data.messageIdentifier);if(!r||!r.isSendFromSelf||r.isSystem||r.isOperationLog)return;const s=et.toHalfWidth(r.text).replace("\u200b","");let o=r.tag.replace("noface","").trim();o=o||"DiceBot";try{const c=/^((srepeat|repeat|srep|rep|sx|x)?(\d+)?[ \u3000]+)?([^\n]*)?/gi.exec(s),m=c[2],I=m&&0===m.toUpperCase().indexOf("S"),Z=null!=c[3]?Number(c[3]):1;let fe=null!=c[4]?c[4]:s;if(!fe||Z<=0)return;let pe={id:"DiceBot",result:"",isSecret:!1,isDiceRollTable:!1,isEmptyDice:!0,isSuccess:!1,isFailure:!0,isCritical:!1,isFumble:!1},ye=!1;for(const we of ho.instance.diceRollTables){if(null==we.command)continue;let Me=!1,Oe=0,Be="",ke=!1;const ze=et.toHalfWidth(we.command.replace(/[\u2015\u30fc\u2014\u2010]/g,"-").trim()).toUpperCase(),je=et.toHalfWidth(fe.replace(/[\u2015\u30fc\u2014\u2010]/g,"-").trim()).toUpperCase();if(!je.startsWith("S"+ze)||je[("S"+ze).length]&&!/[ \=\+\-]/.test(je.charAt(("S"+ze).length))?je.startsWith(ze)&&(!je[ze.length]||/[ \=\+\-]/.test(je.charAt(ze.length)))&&(ye=!0,je[ze.length]&&" "!=je[ze.length]&&(Be=je.substring(ze.length))):(ye=!0,Me=!0,je[("S"+ze).length]&&" "!=je[("S"+ze).length]&&(Be=je.substring(("S"+ze).length))),Be)if(Be=Be.split(" ")[0],/^[\+\-]\d+$/.test(Be))Oe=+Be,Be=` (\u4fee\u6b63${Be})`;else{if(!/^\=\-?\d+$/.test(Be)){ye=!1;continue}ke=!0}if(ye){pe.isFailure=!1,pe.isDiceRollTable=!0,pe.tableName=we.name&&we.name.length>0?we.name:"(\u7121\u540d\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868)",pe.isSecret=Me||I;const st=we.parseText();for(let ot=0;ot<Z&&ot<32;ot++){let tt=null,_t=yield cn.diceRollAsync(ke?`C(${Be.substring(1)})`:et.toHalfWidth(we.dice).replace(/[\u216e\xd0]/g,"D").replace(/\\xd7/g,"*").replace(/\\xf7/g,"/").replace(/[\u2015\u30fc\u2014\u2010]/g,"-"),"DiceBot",1);pe.isEmptyDice=pe.isEmptyDice&&_t.isEmptyDice,_t.result&&(_t.result=t.formatRollResult(_t.result));let Je=null;_t.result.length>0&&(Je=_t.result.match(/\s\u2192\s(?:\u6210\u529f\u6570|\u8a08\u7b97\u7d50\u679c)?(\-?\d+)$/))&&(tt=+Je[1]);let at=!1;if(null!=tt)for(const ft of st)if((null===ft.range.start||ft.range.start<=tt+Oe)&&(null===ft.range.end||tt+Oe<=ft.range.end)){pe.result+=ke?"\u6307\u5b9a="+tt+"\n"+et.cr(ft.result):_t.result+Be+(Be?` \u2192 ${tt+Oe}`:"")+"\n"+et.cr(ft.result),at=!0;break}at||(pe.result+=null==tt?"\uff08\u30a8\u30e9\u30fc\uff1a\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u304b\u3089\u6570\u5b57\u304c\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\uff09\n(\u7d50\u679c\u306a\u3057)":ke?"\u6307\u5b9a="+tt+"\n(\u7d50\u679c\u306a\u3057)":_t.result+Be+(Be?` \u2192 ${tt+Oe}`:"")+"\n(\u7d50\u679c\u306a\u3057)"),1<Z&&(pe.result+=` #${ot+1}`),ot<Z-1&&(pe.result+="\n")}break}}if(!ye){if(!cn.apiUrl&&!(yield cn.loadGameSystemAsync(o)).COMMAND_PATTERN.test(fe))return;let Me,we=!1;if((Me=/^(S?CHOICE\d*)[ \u3000]+([^ \u3000]*)/gi.exec(fe.trim()))&&(fe=fe.trim().replace(/[\u3000\s]+/g," "),we=!0),we||((Me=/^(S?CHOICE\d*\[[^\[\]]+\])/gi.exec(fe.trim()))||(Me=/^(S?CHOICE\d*\([^\(\)]+\))/gi.exec(fe.trim())))&&(ho.instance.diceRollTables.map(Oe=>Oe.command).some(Oe=>null!=Oe&&Oe.trim().toUpperCase()===Me[1].toUpperCase())||(fe=Me[1],we=!0)),we||(fe=fe.trim().split(/\s+/)[0].replace(/[\u216e\xd0]/g,"D").replace(/\\xd7/g,"*").replace(/\\xf7/g,"/").replace(/[\u2015\u30fc\u2014\u2010]/g,"-")),cn.apiUrl){if(!we&&!/choice\d*\[.*\]/i.test(fe)&&!/^[a-zA-Z0-9!-/:-@\xa5[-`{-~\}]+$/.test(fe))return;pe=yield cn.diceRollAsync(fe,o,Z),pe.isSecret=pe.isSecret||I}else for(let Oe=0;Oe<Z&&Oe<32;Oe++){let Be=yield cn.diceRollAsync(fe,o,Z);if(Be.result.length<1)break;pe.id=Be.id,pe.result+=Be.result,pe.isSecret=pe.isSecret||Be.isSecret||I,pe.isEmptyDice=pe.isEmptyDice&&Be.isEmptyDice,pe.isSuccess=pe.isSuccess||Be.isSuccess,pe.isFailure=pe.isFailure&&Be.isFailure,pe.isCritical=pe.isCritical||Be.isCritical,pe.isFumble=pe.isFumble||Be.isFumble,1<Z&&(pe.result+=` #${Oe+1}\n`)}}if(!pe.result)return;pe.result=pe.result.trimRight(),t.sendResultMessage(pe,r)}catch(c){console.error(c)}});return function(i){return e.apply(this,arguments)}}())}onStoreRemoved(){super.onStoreRemoved(),Fe.unregister(this)}sendResultMessage(t,e){let i=t.id.split(":")[0],r=t.result;const s=t.isSecret,o=t.isEmptyDice,c=t.isSuccess,m=t.isFailure,I=t.isCritical,Z=t.isFumble;if(r.length<1)return;t.isDiceRollTable||(r=this.formatRollResult(r));let fe="system";s&&(fe+=" secret"),o&&(fe+=" empty"),c&&(fe+=" success"),m&&(fe+=" failure"),I&&(fe+=" critical"),Z&&(fe+=" fumble");let pe={identifier:"",tabIdentifier:e.tabIdentifier,originFrom:e.from,from:t.isDiceRollTable?"Dice-Roll Table":cn.apiUrl?`BCDice-API(${cn.apiUrl})`:"System-BCDice",timestamp:e.timestamp+1,imageIdentifier:"",tag:fe,name:`${t.isDiceRollTable?t.tableName:i} : ${e.name}${s?" (Secret)":""}`,text:r,color:e.color,isUseStandImage:e.isUseStandImage},ye="";const we=lt.instance.get(e.characterIdentifier);if(we instanceof Vt){const Be=we.standList.matchStandInfo(r,e.imageIdentifier);if(!s&&!e.standName&&e.isUseStandImage)if(Be.farewell){const ke={characterIdentifier:we.identifier};if(e.to){const ze=Ue.findByUserId(e.to);ze&&(ze.peerId!=Ue.myCursor.peerId&&Fe.call("FAREWELL_STAND_IMAGE",ke,ze.peerId),Fe.call("FAREWELL_STAND_IMAGE",ke,Ue.myCursor.peerId))}else Fe.call("FAREWELL_STAND_IMAGE",ke)}else if(Be&&Be.standElementIdentifier){const ke=lt.instance.get(Be.standElementIdentifier);if(ke&&ke.getFirstElementByName("conditionType")){const ze=+ke.getFirstElementByName("conditionType").value;if(ze==wi.Postfix||ze==wi.PostfixOrImage||ze==wi.PostfixAndImage){const je={characterIdentifier:we.identifier,standIdentifier:Be.standElementIdentifier,color:e.color,secret:!!e.to};if(je.secret){const st=Ue.findByUserId(e.to);st&&(st.peerId!=Ue.myCursor.peerId&&Fe.call("POPUP_STAND_IMAGE",je,st.peerId),Fe.call("POPUP_STAND_IMAGE",je,Ue.myCursor.peerId))}else Fe.call("POPUP_STAND_IMAGE",je)}}}ye=Be.matchMostLongText}const Me=lt.instance.get(e.tabIdentifier),Oe=po.instance.matchCutInInfo(r);if(!s&&Me.isUseStandImage&&Oe){for(const Be of Oe.identifiers){const ke={identifier:Be,secret:!!e.to,sender:Ue.myCursor.peerId};if(ke.secret){const ze=Ue.findByUserId(e.to);ze&&(ze.peerId!=Ue.myCursor.peerId&&Fe.call("PLAY_CUT_IN",ke,ze.peerId),Fe.call("PLAY_CUT_IN",ke,Ue.myCursor.peerId))}else Fe.call("PLAY_CUT_IN",ke)}if(Oe.names&&Oe.names.length&&!e.to&&this.chatMessageService){const Be=new Map;for(const ze of Oe.names){let je=Be.get(ze)||0;je+=1,Be.set(""==ze?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":ze,je)}const ke=`${[...Be.keys()].map(ze=>Be.get(ze)>1?`${ze}\xd7${Be.get(ze)}`:ze).join("\u3001")}`;this.chatMessageService.sendOperationLog(ke+" \u304c\u8d77\u52d5\u3057\u305f")}}ye.length<Oe.matchMostLongText.length&&(ye=Oe.matchMostLongText),ye&&pe.text&&(pe.text=pe.text.slice(0,pe.text.length-ye.length)),null!=e.to&&0<e.to.length&&(pe.to=e.to,e.to.indexOf(e.from)<0&&(pe.to+=" "+e.from)),Me&&Me.addMessage(pe)}static diceRollAsync(t,e,i=1){return(0,en.Z)(function*(){if(e=e||"DiceBot",cn.apiUrl){const r=1==cn.apiVersion?cn.apiUrl+"/v1/diceroll?system="+(e?encodeURIComponent(e):"DiceBot")+"&command="+encodeURIComponent(t):`${cn.apiUrl}/v2/game_system/${e?encodeURIComponent(e):"DiceBot"}/roll?command=${encodeURIComponent(t)}`,s=[];for(let o=1;o<=i;o++)s.push(fetch(r,{mode:"cors"}).then(c=>{if(c.ok)return c.json();throw new Error(c.statusText)}).then(c=>({id:e,result:(1==cn.apiVersion?c.result:c.text)+(i>1?` #${o}\n`:""),isSecret:c.secret,isEmptyDice:1==cn.apiVersion?c.dices&&0==c.dices.length:c.rands&&0==c.rands.length,isSuccess:c.success,isFailure:c.failure,isCritical:c.critical,isFumble:c.fumble})).catch(c=>({id:e,result:"",isSecret:!1,isEmptyDice:!0})));return Promise.all(s).then(o=>o.reduce((c,m)=>({id:e,result:c.result+m.result,isSecret:c.isSecret||m.isSecret,isEmptyDice:c.isEmptyDice&&m.isEmptyDice,isSuccess:c.isSuccess||m.isSuccess,isFailure:c.isFailure&&m.isFailure,isCritical:c.isCritical||m.isCritical,isFumble:c.isFumble||m.isFumble}),{id:e,result:"",isSecret:!1,isEmptyDice:!0,isSuccess:!1,isFailure:!0,isCritical:!1,isFumble:!1}))}try{let r=yield cn.loadGameSystemAsync(e);const s=r.eval(t);return s?(console.log("diceRoll!!!",s),console.log("isSecret!!!",s.secret),console.log("isEmptyDice!!!",!s.rands||0==s.rands.length),{id:r.ID,result:s.text,isSecret:s.secret,isEmptyDice:!s.rands||0==s.rands.length,isSuccess:s.success,isFailure:s.failure,isCritical:s.critical,isFumble:s.fumble}):{id:e,result:"",isSecret:!1,isEmptyDice:!0}}catch(r){console.error(r)}return{id:e,result:"",isSecret:!1,isEmptyDice:!0}})()}static getHelpMessage(t){return(0,en.Z)(function*(){if(t=t||"DiceBot",cn.apiUrl){const e=[fetch(1==cn.apiVersion?cn.apiUrl+"/v1/systeminfo?system=DiceBot":`${cn.apiUrl}/v2/game_system/DiceBot`,{mode:"cors"}).then(i=>i.json())];return t&&"DiceBot"!=t&&e.push(fetch(1==cn.apiVersion?cn.apiUrl+"/v1/systeminfo?system="+encodeURIComponent(t):`${cn.apiUrl}/v2/game_system/${encodeURIComponent(t)}`,{mode:"cors"}).then(i=>i.json())),Promise.all(e).then(i=>i.map(r=>1==cn.apiVersion&&r.systeminfo&&r.systeminfo.info?r.systeminfo.info.replace("\u90e8\u5c4b\u306e\u30b7\u30b9\u30c6\u30e0\u540d","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306a\u3069\u306e\u30b7\u30b9\u30c6\u30e0\u540d"):r.help_message?r.help_message.replace("\u90e8\u5c4b\u306e\u30b7\u30b9\u30c6\u30e0\u540d","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306a\u3069\u306e\u30b7\u30b9\u30c6\u30e0\u540d"):"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u60c5\u5831\u304c\u3042\u308a\u307e\u305b\u3093\u3002"))}{let e=[""];try{if(e=[(yield cn.loadGameSystemAsync("DiceBot")).HELP_MESSAGE],t&&""!=t&&"DiceBot"!=t){let i=yield cn.loadGameSystemAsync(t);e.push(i&&"DiceBot"!=i.ID&&i.HELP_MESSAGE?i.HELP_MESSAGE.replace("\u90e8\u5c4b\u306e\u30b7\u30b9\u30c6\u30e0\u540d","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306a\u3069\u306e\u30b7\u30b9\u30c6\u30e0\u540d"):"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u60c5\u5831\u304c\u3042\u308a\u307e\u305b\u3093\u3002")}}catch(i){console.error(i)}return e}})()}static loadGameSystemAsync(t){var e=this;return(0,en.Z)(function*(){return yield cn.queue.add(()=>{const i=e.diceBotInfos.some(r=>r.id===t)?t:"DiceBot";try{return cn.loader.getGameSystemClass(i)}catch(r){return cn.loader.dynamicLoad(i)}})})()}static initializeDiceBotQueue(){let t=new Z3("DiceBotQueue");return t.add((0,en.Z)(function*(){cn.loader=new((yield Promise.resolve().then(X.bind(X,383))).default),cn.diceBotInfos=cn.loader.listAvailableGameSystems().filter(e=>"DiceBot"!=e.id).sort((e,i)=>{const r=e.sortKey,s=i.sortKey;return r<s?-1:r>s?1:0}).map(e=>{const i=/.+\:(.+)/.exec(e.id);let r;return i&&i[1]&&(r="ChineseTraditional"==i[1]?"\u6b63\u9ad4\u4e2d\u6587":"Korean"==i[1]?"\ud55c\uad6d\uc5b4":"English"==i[1]?"English":"Other"),{id:e.id,game:e.name,lang:r,sort_key:e.sortKey}})})),t}formatRollResult(t){return null==t?"":t.split("\n").map(e=>{let i=[],r=[],s=[],o=[];return e.split(" \uff1e ").map((c,m,I)=>{if(1===I.length)return c;if(0==m){const fe=cn.apiUrl&&1==cn.apiVersion?/^(?:\: )\((CHOICE(?:\d+)?[\[\( ].+)\)$/i:/^\((CHOICE(?:\d+)?[\[\( ].+)\)$/i,pe=c.match(cn.apiUrl&&1==cn.apiVersion?/^(?:\: )\(([A-Z\d\+\-\*\/=\(\),\[\]\<\>@]+)\)$/i:/^\(([A-Z\d\+\-\*\/=\(\),\[\]\<\>@]+)\)$/i)||c.match(fe);return pe&&!pe[1].toUpperCase().startsWith("CHOICE")&&(i=[...c.matchAll(/(?<diceCount>\d+)D\d+(?:(?<keepDrop>[KD][HL])(?<keepDropCount>\d+))?/gi)],i.length||(r=[...c.matchAll(/\d+B\d+(?:\+\d+B\d+)*(?:\[6\]Limit\[\d+\])?(?<sign><=|>=|<>|==|!=|<|>|=)(?<criteria>\d+)/gi)],r.length||(s=[...c.matchAll(/\d+R\d+(?:\+\d+R\d+)*\[(?<rerollSign><=|>=|<>|==|!=|<|>|=)?(?<rerollCriteria>\d+)\](?:(?<sign><=|>=|<>|==|!=|<|>|=)(?<criteria>\d+))?/gi)],s.length||(o=[...c.matchAll(/\d+U\d+(?:\+\d+U\d+)*\[(?<rerollCriteria>\d+)\](?<modifier>[\-+]\d+)?(?:(?<sign><=|>=|<>|==|!=|<|>|=)(?<criteria>\d+))?/gi)])))),pe?"\u{1f3b2}"+pe[1]:c}if(m==I.length-1)return c;if(1==m&&(i.length||r.length||s.length||o.length))try{let Z=c;const pe=[...c.matchAll(i.length?/(?<total>\d+)\[(?<diceArrayString>\d+(?:,\d+)*)?\]/gi:o.length?/(?:(?<total>\d+)\[(?<diceArrayString>\d+(?:,\d+)*)?\])|(?<modifier2>[\-+]\d+)|(?<dieString>\d+)/gi:/(?<diceArrayString>\d+(?:,\d+)*)/gi)];if(pe.length){let we,ye=0;pe.forEach((Me,Oe)=>{if(we=Me[0],i.length){const{diceCount:ke,keepDrop:ze,keepDropCount:je}=i[Oe].groups,{total:st,diceArrayString:ot}=Me.groups;if(ze){const tt=null!=ot?ot.split(",").sort((at,ft)=>+at-+ft):[],_t=ze.startsWith("K")?je:ke-je;("KH"===ze||"DL"===ze)&&tt.reverse();const Je=tt.map((at,ft)=>ft+1<=_t?`${at}`:`~~~${at}~~~`);("DH"===ze||"DL"===ze)&&Je.reverse(),we=`${st}[${Je.join(",")}]`}}else if(r.length){const{sign:ke,criteria:ze}=r[0].groups,{diceArrayString:je}=Me.groups;we=je.split(",").map(st=>cn.isPass(st,ke,ze)?`${st}`:`~~~${st}~~~`).join(",")}else if(s.length){let{rerollSign:ke,rerollCriteria:ze,sign:je,criteria:st}=s[0].groups;ke||(ke=je),ze||(ze=st);const{diceArrayString:ot}=Me.groups;we=ot.split(",").map(tt=>cn.isPass(tt,ke,ze)?`###${tt}###`:tt).map(tt=>cn.isPass(tt,je,st,!1)?tt:`~~~${tt}~~~`).join(",")}else if(o.length){const{rerollCriteria:ke,modifier:ze,sign:je,criteria:st}=o[0].groups,{total:ot,diceArrayString:tt,modifier2:_t,dieString:Je}=Me.groups;if(console.log(o[0],Me),_t)we=` (${_t})`;else if(ot)we=ot+"["+tt.split(",").map(at=>cn.isPass(at,">=",ke)?`###${at}###`:at).join(",")+"]",cn.isPass(+ot+(ze?+ze:0),je,st)||(we=`~~~${we}~~~`);else{let at=we;we=cn.isPass(Je,">=",ke)?`###${Je}###`:Je,cn.isPass(+at+(ze?+ze:0),je,st)||(we=`~~~${we}~~~`)}}const Be=Z.indexOf(Me[0],ye);we!=Me[0]&&(Z=Z.substring(0,Be)+we+Z.substring(Be+Me[0].length)),ye=Be+we.length})}c=Z}catch(Z){console.error(Z)}return c}).join(" \u2192 ")}).join("\n")}static isPass(t,e,i,r=!0){if(null==t)return r;let s=t.toString().match(/(\d+)/);s&&(t=s[1]);let o=r;switch(e){case"==":case"=":o=+t==+i;break;case"!=":case"<>":o=+t!=+i;break;case">=":o=+t>=+i;break;case"<=":o=+t<=+i;break;case"<":o=+t<+i;break;case">":o=+t>+i}return o}};function dT(n,t){if(Array.prototype.indexOf)return n.indexOf(t);for(var e=0,i=n.length;e<i;e++)if(n[e]===t)return e;return-1}function Ul(n,t){for(var e=n.length-1;e>=0;e--)!0===t(n[e])&&n.splice(e,1)}function fT(n){throw new Error("Unhandled case for value: '".concat(n,"'"))}jn.queue=cn.initializeDiceBotQueue(),jn.loader=new A9.default,jn.apiUrl=null,jn.apiVersion=1,jn.adminUrl=null,jn.diceBotInfos=[],jn.diceBotInfosIndexed=[],jn.replaceData=[["\u65b0\u30af\u30c8\u30a5\u30eb\u30d5","\u30b7\u30f3\u30af\u30c8\u30a6\u30eb\u30d5\u30b7\u30f3\u30efTRPG","\u65b0\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG"],["\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG","\u30af\u30c8\u30a6\u30eb\u30d5\u30b7\u30f3\u30efTRPG","(\u65e7) \u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG"],["\ud06c\ud234\ub8e8","\ud06c\ud234\ub8e8\uc758 \ubd80\ub984 6\ud310","\ud06c\ud234\ub8e8\uc758 \ubd80\ub984 6\ud310"],["\u514b\u8607\u9b6f\u795e\u8a71","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c\u516d\u7248","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c\u516d\u7248"],["\u514b\u8607\u9b6f\u795e\u8a71\u7b2c7\u7248","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c7\u7248","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c\u4e03\u7248"],["\u30c0\u30d6\u30eb\u30af\u30ed\u30b92nd,3rd","\u30bf\u30d5\u30eb\u30af\u30ed\u30b9 The 2nd Edition/The 3rd Edtion","\u30c0\u30d6\u30eb\u30af\u30ed\u30b9 The 2nd Edition, The 3rd Edtion"],["\u30c8\u30fc\u30b0","\u30c8\u30aa\u30af","\u30c8\u30fc\u30b0\uff08TORG\uff09"],["\u30ef\u30fc\u30d7\u30b9","\u30ef\u30a2\u30d5\u30b9","WARPS"],["\u30c8\u30fc\u30b01.5\u7248","\u30c8\u30aa\u30af1.5\u30cf\u30f3","\u30c8\u30fc\u30b0\uff08TORG\uff09 1.5\u7248"],["\u30c8\u30fc\u30b0 \u30a8\u30bf\u30cb\u30c6\u30a3","\u30c8\u30aa\u30af\u30a8\u30bf\u30cb\u30c6\u30a4","\u30c8\u30fc\u30b0\uff08TORG\uff09 \u30a8\u30bf\u30cb\u30c6\u30a3"],["\u5fc3\u885d\u60f3\u6a5fTRPG\u30a2\u30eb\u30c8\u30ec\u30a4\u30ba","\u30b7\u30f3\u30b7\u30e8\u30a6\u30bd\u30a6\u30adTRPG\u30a2\u30eb\u30c8\u30ec\u30a4\u30b9","\u5fc3\u885d\u60f3\u6a5fTRPG \u30a2\u30eb\u30c8\u30ec\u30a4\u30ba"],["\u30d1\u30e9\u30b5\u30a4\u30c8\u30d6\u30e9\u30c3\u30c9RPG","\u30cf\u30e9\u30b5\u30a4\u30c8\u30d5\u30e9\u30c4\u30c8","\u30d1\u30e9\u30b5\u30a4\u30c8\u30d6\u30e9\u30c3\u30c9"],["\u72af\u7f6a\u6d3b\u5287RPG\u30d0\u30c3\u30c9\u30e9\u30a4\u30d5","\u30cf\u30f3\u30b5\u30a4\u30ab\u30c4\u30b1\u30adRPG\u30cf\u30c4\u30c8\u30e9\u30a4\u30d5","\u72af\u7f6a\u6d3b\u5287RPG\u30d0\u30c3\u30c9\u30e9\u30a4\u30d5"],["\u6643\u5929\u306e\u30a4\u30eb\u30fc\u30b8\u30aa","\u30b3\u30a6\u30c6\u30f3\u30ce\u30a4\u30eb\u30a6\u30b7\u30aa","\u6643\u5929\u306e\u30a4\u30eb\u30fc\u30b8\u30aa"],["\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb","\u30cf\u30af\u30eb\u30de\u30ce\u30c8\u30a6\u30ce\u30b9\u30ab\u30a4\u30ce\u30aa\u30c4","\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb"],["\u5728\u308a\u3066\u904d\u304f\u30aa\u30eb\u30ac\u30ec\u30a4\u30f3","\u30a2\u30ea\u30c6\u30a2\u30de\u30cd\u30af\u30aa\u30eb\u30ab\u30ec\u30a4\u30f3","\u5728\u308a\u3066\u904d\u304f\u30aa\u30eb\u30ac\u30ec\u30a4\u30f3"],["Pathfinder","\u30cf\u30b9\u30d5\u30a2\u30a4\u30f3\u30bf\u30a2RPG","\u30d1\u30b9\u30d5\u30a1\u30a4\u30f3\u30c0\u30fcRPG"],["\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG\u3000\u899a\u9192\u7de8","\u30b7\u30f3\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4TRPG\u30ab\u30af\u30bb\u30a4\u30d8\u30f3","\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG \u899a\u9192\u7bc7"],["\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG\u3000\u899a\u9192\u7bc7","\u30b7\u30f3\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4TRPG\u30ab\u30af\u30bb\u30a4\u30d8\u30f3","\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG \u899a\u9192\u7bc7"],["YearZeroEngine","\u30a4\u30e4\u30a2\u30bb\u30ed\u30a8\u30f3\u30b7\u30f3","Year Zero Engine"],["Year Zero Engine","\u30a4\u30e4\u30a2\u30bb\u30ed\u30a8\u30f3\u30b7\u30f3","Year Zero Engine"],["ADVANCED FIGHTING FANTASY 2nd Edition","\u30a2\u30c8\u30cf\u30f3\u30b9\u30c8\u30d5\u30a1\u30a4\u30c6\u30a4\u30f3\u30af\u30d5\u30a1\u30f3\u30bf\u30b7\u30a4\u30bf\u30a42\u30cf\u30f3","\u30a2\u30c9\u30d0\u30f3\u30b9\u30c8\u30fb\u30d5\u30a1\u30a4\u30c6\u30a3\u30f3\u30b0\u30fb\u30d5\u30a1\u30f3\u30bf\u30b8\u30fc \u7b2c2\u7248"],["Vampire: The Masquerade 5th Edition","\u30a6\u30a2\u30f3\u30cf\u30a4\u30a2\u30b5\u30de\u30b9\u30ab\u30ec\u30a8\u30c8\u30bf\u30a45\u30cf\u30f3","\u30f4\u30a1\u30f3\u30d1\u30a4\u30a2\uff1a\u30b6\u30fb\u30de\u30b9\u30ab\u30ec\u30fc\u30c9 \u7b2c5\u7248"],["\u30ef\u30fc\u30eb\u30c9\u30aa\u30d6\u30c0\u30fc\u30af\u30cd\u30b9","\u30ef\u30a2\u30eb\u30c8\u30aa\u30d5\u30bf\u30a2\u30af\u30cd\u30b9","\u30ef\u30fc\u30eb\u30c9\u30fb\u30aa\u30d6\u30fb\u30c0\u30fc\u30af\u30cd\u30b9"],["\u30e2\u30ce\u30c8\u30fc\u30f3\u30fb\u30df\u30e5\u30fc\u30b8\u30a2\u30e0","\u30e2\u30ce\u30c8\u30aa\u30f3\u30df\u30e6\u30a6\u30b7\u30a2\u30e0","\u30e2\u30ce\u30c8\u30fc\u30f3\u30df\u30e5\u30fc\u30b8\u30a2\u30e0"],["\u5263\u306e\u8857\u306e\u7570\u90a6\u4ebaTRPG","\u30c4\u30eb\u30ad\u30ce\u30de\u30c1\u30ce\u30a4\u30db\u30a6\u30b7\u30f3TRPG"],["\u58ca\u308c\u305f\u4e16\u754c\u306e\u30dd\u30b9\u30c8\u30de\u30f3","\u30b3\u30ef\u30ec\u30bf\u30bb\u30ab\u30a4\u30ce\u30db\u30b9\u30c8\u30de\u30f3","\u58ca\u308c\u305f\u4e16\u754c\u306e\u30dd\u30b9\u30c8\u30de\u30f3"],["\u7d2b\u7e1e\u306e\u30ea\u30f4\u30e9\u30c9\u30fc\u30eb","\u30b7\u30b7\u30de\u30ce\u30ea\u30d5\u30e9\u30c8\u30aa\u30eb","\u7d2b\u7e1e\u306e\u30ea\u30f4\u30e9\u30c9\u30fc\u30eb"],["SRS\u6c4e\u7528(\u6539\u9020\u7248)","\u30b9\u30bf\u30f3\u30bf\u30a2\u30c8RPG\u30b7\u30b9\u30c6\u30e0\u30aa\u30eb\u30bf\u30ca\u30c6\u30a4\u30d5\u30cf\u30f3","SRS\u6c4e\u7528 \u30aa\u30eb\u30bf\u30ca\u30c6\u30a3\u30f4"],["Standard RPG System","\u30b9\u30bf\u30f3\u30bf\u30a2\u30c8RPG\u30b7\u30b9\u30c6\u30e0","\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0\uff08SRS\uff09"],["\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0","\u30b9\u30bf\u30f3\u30bf\u30a2\u30c8RPG\u30b7\u30b9\u30c6\u30e0","\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0\uff08SRS\uff09"],["NJSLYRBATTLE","\u30cb\u30f3\u30b7\u30e4\u30b9\u30ec\u30a4\u30e4\u30a2\u30cf\u30c8\u30eb"],["Record of Steam","\u30ec\u30b3\u30aa\u30c8\u30aa\u30d5\u30b9\u30c1\u30a4\u30e0"],["\u8a69\u7247\u306e\u30a2\u30eb\u30bb\u30c3\u30c8","\u30a6\u30bf\u30ab\u30bf\u30ce\u30a2\u30eb\u30bb\u30c4\u30c8"],["Shared\u2020Fantasia","\u30b7\u30a8\u30a2\u30a2\u30c8\u30d5\u30a2\u30f3\u30bf\u30b7\u30a2"],["\u771f\u30fb\u5973\u795e\u8ee2\u751f","\u30b7\u30f3\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4"],["\u5973\u795e\u8ee2\u751f","\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4"],["\u899a\u9192\u7bc7","\u30ab\u30af\u30bb\u30a4\u30d8\u30f3"],["Chill","\u30c1\u30eb"],["BBNTRPG","\u30d2\u30a4\u30d2\u30a4\u30a8\u30ccTRPG","BBNTRPG (Black Black Network TRPG)"],["TORG Eternity","\u30c8\u30aa\u30af\u30a8\u30bf\u30a2\u30cb\u30c6\u30a4"],["\u30ac\u30fc\u30d7\u30b9","\u30ab\u30a2\u30d5\u30b9","GURPS"],["\u30ac\u30fc\u30d7\u30b9\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba","\u30ab\u30a2\u30d5\u30b9\u30d5\u30a4\u30eb\u30c8\u30a6\u30a4\u30b9","GURPS\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba"],["\u7d76\u5bfe\u96b7\u5974","\u30bb\u30c4\u30bf\u30a4\u30ec\u30a4\u30c8"],["\u30bb\u30e9\u30d5\u30a3\u30b6\u30a4\u30f3","\u30bb\u30a4\u30b7\u30e6\u30f3\u30b7\u30c4\u30ab\u30f3TRPG\u30bb\u30e9\u30d5\u30a4\u30b5\u30a4\u30f3","\u9752\u6625\u75be\u60a3TRPG \u30bb\u30e9\u30d5\u30a3\u30b6\u30a4\u30f3"],["\u8266\u3053\u308c","\u30ab\u30f3\u30b3\u30ec"],["\u795e\u6211\u72e9","\u30ab\u30df\u30ab\u30ab\u30ea"],["\u9d7a\u93e1","\u30cc\u30a8\u30ab\u30ab\u30df"],["\u30c8\u30fc\u30ad\u30e7\u30fc","\u30c8\u30aa\u30ad\u30e8\u30a6"],["\uff2e\u25ce\uff36\uff21","\u30ce\u30a6\u30a2"],["\u521d\u97f3\u30df\u30af","\u30cf\u30c4\u30cd\u30df\u30af"],["\u6731\u306e\u5b64\u5854","\u30a2\u30b1\u30ce\u30b3\u30c8\u30a6"],["\u5728\u308a\u3066\u904d\u304f","\u30a2\u30ea\u30c6\u30a2\u30de\u30cd\u30af"],["\u592e\u83ef\u5c01\u795e","\u30aa\u30a6\u30ab\u30db\u30a6\u30b7\u30f3"],["\u5fc3\u885d\u60f3\u6a5f","\u30b7\u30f3\u30b7\u30e8\u30a6\u30bd\u30a6\u30ad"],["\u80ce\u3088\u308a\u60f3\u3048","\u30cf\u30e9\u30e8\u30ea\u30aa\u30e2\u30a8"],["\u5c55\u721b\u4f1a","\u30c6\u30f3\u30e9\u30f3\u30ab\u30a4"],["\u58ca\u308c\u305f","\u30b3\u30ef\u30ec\u30bf"],["\u6bd4\u53e1\u5c71","\u30d2\u30a8\u30a4\u30b5\u30f3"],["\u4e16\u754c\u6a39","\u30bb\u30ab\u30a4\u30b7\u30e6"],["\u7570\u90a6\u4eba","\u30a4\u30db\u30a6\u30b7\u30f3"],["\u8ee2\u653b\u751f","\u30c6\u30f3\u30b3\u30a6\u30bb\u30a4"],["\u63a2\u7a7a\u58eb","\u30b9\u30ab\u30a4\u30ce\u30aa\u30c4"],["\u5263\u306e\u8857","\u30c4\u30eb\u30ad\u30ce\u30de\u30c1"],["\u9ed2\u7d62","\u30b3\u30c4\u30b1\u30f3"],["\u7d2b\u7e1e","\u30b7\u30b7\u30de"],["\u7834\u754c","\u30cf\u30ab\u30a4"],["\u9280\u5263","\u30ad\u30f3\u30b1\u30f3"],["\u6771\u4eac","\u30c8\u30a6\u30ad\u30e8\u30a6"],["\u7247\u9053","\u30ab\u30bf\u30df\u30c1"],["\u52c7\u8005","\u30e6\u30a6\u30b7\u30e4"],["\u5c11\u5973","\u30b7\u30e8\u30a6\u30b7\u30e8"],["\u771f\u7a7a","\u30b7\u30f3\u30af\u30a6"],["\u5b66\u5712","\u30ab\u30af\u30a8\u30f3"],["\u4e16\u754c","\u30bb\u30ab\u30a4"],["\u9752\u6625","\u30bb\u30a4\u30b7\u30e6\u30f3"],["\u75be\u60a3","\u30b7\u30c4\u30ab\u30f3"],["\u8ff7\u5bae","\u30e1\u30a4\u30ad\u30e6\u30a6"],["\u6b6f\u8eca","\u30cf\u30af\u30eb\u30de"],["\u84bc\u5929","\u30bd\u30a6\u30c6\u30f3"],["\u589c\u843d","\u30c4\u30a4\u30e9\u30af"],["\u7279\u547d","\u30c8\u30af\u30e1\u30a4"],["\u6643\u5929","\u30b3\u30a6\u30c6\u30f3"],["\u53db\u9006","\u30cf\u30f3\u30ad\u30e4\u30af"],["\u72af\u7f6a","\u30cf\u30f3\u30b5\u30a4"],["\u6d3b\u5287","\u30ab\u30c4\u30b1\u30ad"],["\u78a7\u7a7a","\u30d8\u30ad\u30af\u30a6"],["\u84ec\u83b1","\u30db\u30a6\u30e9\u30a4"],["\u5192\u967a","\u30db\u30a6\u30b1\u30f3"],["\u516d\u9580","\u30ed\u30af\u30e2\u30f3"],["\u708e\u4e0a","\u30a8\u30f3\u30b7\u30e8\u30a6"],["\u7121\u9650","\u30e0\u30b1\u30f3"],["\u5854","\u30c8\u30a6"],["\u7363","\u30b1\u30e2\u30ce"],["\u7378","\u30b1\u30e2\u30ce"],["\u68ee","\u30e2\u30ea"],["&","\u30a2\u30f3\u30c8"],["\uff06","\u30a2\u30f3\u30c8"],["\u30f4\u30a1","\u30cf"],["\u30f4\u30a3","\u30d2"],["\u30f4\u30a7","\u30d8"],["\u30f4\u30a9","\u30db"],["\u30f4","\u30d5"],["\u30a1","\u30a2"],["\u30a3","\u30a4"],["\u30a5","\u30a6"],["\u30a7","\u30a8"],["\u30a9","\u30aa"],["\u30e3","\u30e4"],["\u30e5","\u30e6"],["\u30e7","\u30e8"],["\u30c3","\u30c4"],["\u30f2","\u30aa"],["\u30ac","\u30ab"],["\u30ae","\u30ad"],["\u30b0","\u30af"],["\u30b2","\u30b1"],["\u30b4","\u30b3"],["\u30b6","\u30b5"],["\u30b8","\u30b7"],["\u30ba","\u30b9"],["\u30bc","\u30bb"],["\u30be","\u30bd"],["\u30c0","\u30bf"],["\u30c2","\u30c1"],["\u30c5","\u30c4"],["\u30c7","\u30c6"],["\u30c9","\u30c8"],["\u30d0","\u30cf"],["\u30d3","\u30d2"],["\u30d6","\u30d5"],["\u30d9","\u30d8"],["\u30dc","\u30db"],["\u30d1","\u30cf"],["\u30d4","\u30d2"],["\u30d7","\u30d5"],["\u30da","\u30d8"],["\u30dd","\u30db"]],jn=cn=B([Xn("dice-bot")],jn);var e,W0=function(){function n(t){void 0===t&&(t={}),this.tagName="",this.attrs={},this.innerHTML="",this.whitespaceRegex=/\s+/,this.tagName=t.tagName||"",this.attrs=t.attrs||{},this.innerHTML=t.innerHtml||t.innerHTML||""}return n.prototype.setTagName=function(t){return this.tagName=t,this},n.prototype.getTagName=function(){return this.tagName||""},n.prototype.setAttr=function(t,e){return this.getAttrs()[t]=e,this},n.prototype.getAttr=function(t){return this.getAttrs()[t]},n.prototype.setAttrs=function(t){return Object.assign(this.getAttrs(),t),this},n.prototype.getAttrs=function(){return this.attrs||(this.attrs={})},n.prototype.setClass=function(t){return this.setAttr("class",t)},n.prototype.addClass=function(t){for(var o,e=this.getClass(),i=this.whitespaceRegex,r=e?e.split(i):[],s=t.split(i);o=s.shift();)-1===dT(r,o)&&r.push(o);return this.getAttrs().class=r.join(" "),this},n.prototype.removeClass=function(t){for(var o,e=this.getClass(),i=this.whitespaceRegex,r=e?e.split(i):[],s=t.split(i);r.length&&(o=s.shift());){var c=dT(r,o);-1!==c&&r.splice(c,1)}return this.getAttrs().class=r.join(" "),this},n.prototype.getClass=function(){return this.getAttrs().class||""},n.prototype.hasClass=function(t){return-1!==(" "+this.getClass()+" ").indexOf(" "+t+" ")},n.prototype.setInnerHTML=function(t){return this.innerHTML=t,this},n.prototype.setInnerHtml=function(t){return this.setInnerHTML(t)},n.prototype.getInnerHTML=function(){return this.innerHTML||""},n.prototype.getInnerHtml=function(){return this.getInnerHTML()},n.prototype.toAnchorString=function(){var t=this.getTagName(),e=this.buildAttrsStr();return["<",t,e=e?" "+e:"",">",this.getInnerHtml(),"</",t,">"].join("")},n.prototype.buildAttrsStr=function(){if(!this.attrs)return"";var t=this.getAttrs(),e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(i+'="'+t[i]+'"');return e.join(" ")},n}(),hT=function(){function n(t){void 0===t&&(t={}),this.newWindow=!1,this.truncate={},this.className="",this.newWindow=t.newWindow||!1,this.truncate=t.truncate||{},this.className=t.className||""}return n.prototype.build=function(t){return new W0({tagName:"a",attrs:this.createAttrs(t),innerHtml:this.processAnchorText(t.getAnchorText())})},n.prototype.createAttrs=function(t){var e={href:t.getAnchorHref()},i=this.createCssClass(t);return i&&(e.class=i),this.newWindow&&(e.target="_blank",e.rel="noopener noreferrer"),this.truncate&&this.truncate.length&&this.truncate.length<t.getAnchorText().length&&(e.title=t.getAnchorHref()),e},n.prototype.createCssClass=function(t){var e=this.className;if(e){for(var i=[e],r=t.getCssClassSuffixes(),s=0,o=r.length;s<o;s++)i.push(e+"-"+r[s]);return i.join(" ")}return""},n.prototype.processAnchorText=function(t){return this.doTruncate(t)},n.prototype.doTruncate=function(t){var e=this.truncate;if(!e||!e.length)return t;var i=e.length,r=e.location;return"smart"===r?function N7(n,t,e){var i,r;null==e?(e="&hellip;",r=3,i=8):(r=e.length,i=e.length);var o=function(ke){var ze="";return ke.scheme&&ke.host&&(ze+=ke.scheme+"://"),ke.host&&(ze+=ke.host),ke.path&&(ze+="/"+ke.path),ke.query&&(ze+="?"+ke.query),ke.fragment&&(ze+="#"+ke.fragment),ze},c=function(ke,ze){var je=ze/2,st=Math.ceil(je),ot=-1*Math.floor(je),tt="";return ot<0&&(tt=ke.substr(ot)),ke.substr(0,st)+e+tt};if(n.length<=t)return n;var ze,je,st,m=t-r,I=(ze={},(st=(je=n).match(/^([a-z]+):\/\//i))&&(ze.scheme=st[1],je=je.substr(st[0].length)),(st=je.match(/^(.*?)(?=(\?|#|\/|$))/i))&&(ze.host=st[1],je=je.substr(st[0].length)),(st=je.match(/^\/(.*?)(?=(\?|#|$))/i))&&(ze.path=st[1],je=je.substr(st[0].length)),(st=je.match(/^\?(.*?)(?=(#|$))/i))&&(ze.query=st[1],je=je.substr(st[0].length)),(st=je.match(/^#(.*?)$/i))&&(ze.fragment=st[1]),ze);if(I.query){var Z=I.query.match(/^(.*?)(?=(\?|\#))(.*?)$/i);Z&&(I.query=I.query.substr(0,Z[1].length),n=o(I))}if(n.length<=t||(I.host&&(I.host=I.host.replace(/^www\./,""),n=o(I)),n.length<=t))return n;var fe="";if(I.host&&(fe+=I.host),fe.length>=m)return I.host.length==t?(I.host.substr(0,t-r)+e).substr(0,m+i):c(fe,m).substr(0,m+i);var pe="";if(I.path&&(pe+="/"+I.path),I.query&&(pe+="?"+I.query),pe){if((fe+pe).length>=m)return(fe+pe).length==t?(fe+pe).substr(0,t):(fe+c(pe,m-fe.length)).substr(0,m+i);fe+=pe}if(I.fragment){var we="#"+I.fragment;if((fe+we).length>=m)return(fe+we).length==t?(fe+we).substr(0,t):(fe+c(we,m-fe.length)).substr(0,m+i);fe+=we}if(I.scheme&&I.host){var Oe=I.scheme+"://";if((fe+Oe).length<m)return(Oe+fe).substr(0,t)}if(fe.length<=t)return fe;var Be="";return m>0&&(Be=fe.substr(-1*Math.floor(m/2))),(fe.substr(0,Math.ceil(m/2))+e+Be).substr(0,m+i)}(t,i):"middle"===r?function F7(n,t,e){if(n.length<=t)return n;var i,r;null==e?(e="&hellip;",i=8,r=3):(i=e.length,r=e.length);var s=t-r,o="";return s>0&&(o=n.substr(-1*Math.floor(s/2))),(n.substr(0,Math.ceil(s/2))+e+o).substr(0,s+i)}(t,i):function O7(n,t,e){return function A7(n,t,e){var i;return n.length>t&&(null==e?(e="&hellip;",i=3):i=e.length,n=n.substring(0,t-i)+e),n}(n,t,e)}(t,i)},n}(),cu=function(){function n(t){this.__jsduckDummyDocProp=null,this.matchedText="",this.offset=0,this.tagBuilder=t.tagBuilder,this.matchedText=t.matchedText,this.offset=t.offset}return n.prototype.getMatchedText=function(){return this.matchedText},n.prototype.setOffset=function(t){this.offset=t},n.prototype.getOffset=function(){return this.offset},n.prototype.getCssClassSuffixes=function(){return[this.getType()]},n.prototype.buildTag=function(){return this.tagBuilder.build(this)},n}(),pT=function(n){function t(e){var i=n.call(this,e)||this;return i.email="",i.email=e.email,i}return Ee(t,n),t.prototype.getType=function(){return"email"},t.prototype.getEmail=function(){return this.email},t.prototype.getAnchorHref=function(){return"mailto:"+this.email},t.prototype.getAnchorText=function(){return this.email},t}(cu),gT=function(n){function t(e){var i=n.call(this,e)||this;return i.serviceName="",i.hashtag="",i.serviceName=e.serviceName,i.hashtag=e.hashtag,i}return Ee(t,n),t.prototype.getType=function(){return"hashtag"},t.prototype.getServiceName=function(){return this.serviceName},t.prototype.getHashtag=function(){return this.hashtag},t.prototype.getAnchorHref=function(){var e=this.serviceName,i=this.hashtag;switch(e){case"twitter":return"https://twitter.com/hashtag/"+i;case"facebook":return"https://www.facebook.com/hashtag/"+i;case"instagram":return"https://instagram.com/explore/tags/"+i;case"tiktok":return"https://www.tiktok.com/tag/"+i;default:throw new Error("Unknown service name to point hashtag to: "+e)}},t.prototype.getAnchorText=function(){return"#"+this.hashtag},t}(cu),mT=function(n){function t(e){var i=n.call(this,e)||this;return i.serviceName="twitter",i.mention="",i.mention=e.mention,i.serviceName=e.serviceName,i}return Ee(t,n),t.prototype.getType=function(){return"mention"},t.prototype.getMention=function(){return this.mention},t.prototype.getServiceName=function(){return this.serviceName},t.prototype.getAnchorHref=function(){switch(this.serviceName){case"twitter":return"https://twitter.com/"+this.mention;case"instagram":return"https://instagram.com/"+this.mention;case"soundcloud":return"https://soundcloud.com/"+this.mention;case"tiktok":return"https://www.tiktok.com/@"+this.mention;default:throw new Error("Unknown service name to point mention to: "+this.serviceName)}},t.prototype.getAnchorText=function(){return"@"+this.mention},t.prototype.getCssClassSuffixes=function(){var e=n.prototype.getCssClassSuffixes.call(this),i=this.getServiceName();return i&&e.push(i),e},t}(cu),_T=function(n){function t(e){var i=n.call(this,e)||this;return i.number="",i.plusSign=!1,i.number=e.number,i.plusSign=e.plusSign,i}return Ee(t,n),t.prototype.getType=function(){return"phone"},t.prototype.getPhoneNumber=function(){return this.number},t.prototype.getNumber=function(){return this.getPhoneNumber()},t.prototype.getAnchorHref=function(){return"tel:"+(this.plusSign?"+":"")+this.number},t.prototype.getAnchorText=function(){return this.matchedText},t}(cu),$T=function(n){function t(e){var i=n.call(this,e)||this;return i.url="",i.urlMatchType="scheme",i.protocolUrlMatch=!1,i.protocolRelativeMatch=!1,i.stripPrefix={scheme:!0,www:!0},i.stripTrailingSlash=!0,i.decodePercentEncoding=!0,i.schemePrefixRegex=/^(https?:\/\/)?/i,i.wwwPrefixRegex=/^(https?:\/\/)?(www\.)?/i,i.protocolRelativeRegex=/^\/\//,i.protocolPrepended=!1,i.urlMatchType=e.urlMatchType,i.url=e.url,i.protocolUrlMatch=e.protocolUrlMatch,i.protocolRelativeMatch=e.protocolRelativeMatch,i.stripPrefix=e.stripPrefix,i.stripTrailingSlash=e.stripTrailingSlash,i.decodePercentEncoding=e.decodePercentEncoding,i}return Ee(t,n),t.prototype.getType=function(){return"url"},t.prototype.getUrlMatchType=function(){return this.urlMatchType},t.prototype.getUrl=function(){var e=this.url;return!this.protocolRelativeMatch&&!this.protocolUrlMatch&&!this.protocolPrepended&&(e=this.url="http://"+e,this.protocolPrepended=!0),e},t.prototype.getAnchorHref=function(){return this.getUrl().replace(/&amp;/g,"&")},t.prototype.getAnchorText=function(){var e=this.getMatchedText();return this.protocolRelativeMatch&&(e=this.stripProtocolRelativePrefix(e)),this.stripPrefix.scheme&&(e=this.stripSchemePrefix(e)),this.stripPrefix.www&&(e=this.stripWwwPrefix(e)),this.stripTrailingSlash&&(e=this.removeTrailingSlash(e)),this.decodePercentEncoding&&(e=this.removePercentEncoding(e)),e},t.prototype.stripSchemePrefix=function(e){return e.replace(this.schemePrefixRegex,"")},t.prototype.stripWwwPrefix=function(e){return e.replace(this.wwwPrefixRegex,"$1")},t.prototype.stripProtocolRelativePrefix=function(e){return e.replace(this.protocolRelativeRegex,"")},t.prototype.removeTrailingSlash=function(e){return"/"===e.charAt(e.length-1)&&(e=e.slice(0,-1)),e},t.prototype.removePercentEncoding=function(e){var i=e.replace(/%22/gi,"&quot;").replace(/%26/gi,"&amp;").replace(/%27/gi,"&#39;").replace(/%3C/gi,"&lt;").replace(/%3E/gi,"&gt;");try{return decodeURIComponent(i)}catch(r){return i}},t}(cu),uu=function n(t){this.__jsduckDummyDocProp=null,this.tagBuilder=t.tagBuilder},K0=/[A-Za-z]/,R7=/[\d]/,B7=/[\D]/,Vl=/\s/,Y0=/['"]/,L7=/[\x00-\x1F\x7F]/,vT=/A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC/.source,bT=vT+/\u2700-\u27bf\udde6-\uddff\ud800-\udbff\udc00-\udfff\ufe0e\ufe0f\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0\ud83c\udffb-\udfff\u200d\u3299\u3297\u303d\u3030\u24c2\ud83c\udd70-\udd71\udd7e-\udd7f\udd8e\udd91-\udd9a\udde6-\uddff\ude01-\ude02\ude1a\ude2f\ude32-\ude3a\ude50-\ude51\u203c\u2049\u25aa-\u25ab\u25b6\u25c0\u25fb-\u25fe\u00a9\u00ae\u2122\u2139\udc04\u2600-\u26FF\u2b05\u2b06\u2b07\u2b1b\u2b1c\u2b50\u2b55\u231a\u231b\u2328\u23cf\u23e9-\u23f3\u23f8-\u23fa\udccf\u2935\u2934\u2190-\u21ff/.source+/\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D4-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D01-\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF8\u1CF9\u1DC0-\u1DF5\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F/.source,qp=/0-9\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19/.source,H7=bT+qp,gi=bT+qp,U7="(?:["+qp+"]{1,3}\\.){3}["+qp+"]{1,3}",V7="["+gi+"](?:["+gi+"\\-]{0,61}["+gi+"])?",yT=function(n){return"(?=("+V7+"))\\"+n},Z0=function(n){return"(?:"+yT(n)+"(?:\\."+yT(n+1)+"){0,126}|"+U7+")"},Wp=(new RegExp("["+gi+".\\-]*["+gi+"\\-]"),new RegExp("[".concat(gi,"]"))),CT=/(?:xn--vermgensberatung-pwb|xn--vermgensberater-ctb|xn--clchc0ea0b2g2a9gcd|xn--w4r85el8fhu5dnra|northwesternmutual|travelersinsurance|verm\xf6gensberatung|xn--3oq18vl8pn36a|xn--5su34j936bgsg|xn--bck1b9a5dre4c|xn--mgbah1a3hjkrd|xn--mgbai9azgqp6j|xn--mgberp4a5d4ar|xn--xkc2dl3a5ee0h|verm\xf6gensberater|xn--fzys8d69uvgm|xn--mgba7c0bbn0a|xn--mgbcpq6gpa1a|xn--xkc2al3hye2a|americanexpress|kerryproperties|sandvikcoromant|xn--i1b6b1a6a2e|xn--kcrx77d1x4a|xn--lgbbat1ad8j|xn--mgba3a4f16a|xn--mgbaakc7dvf|xn--mgbc0a9azcg|xn--nqv7fs00ema|afamilycompany|americanfamily|bananarepublic|cancerresearch|cookingchannel|kerrylogistics|weatherchannel|xn--54b7fta0cc|xn--6qq986b3xl|xn--80aqecdr1a|xn--b4w605ferd|xn--fiq228c5hs|xn--h2breg3eve|xn--jlq480n2rg|xn--jlq61u9w7b|xn--mgba3a3ejt|xn--mgbaam7a8h|xn--mgbayh7gpa|xn--mgbbh1a71e|xn--mgbca7dzdo|xn--mgbi4ecexp|xn--mgbx4cd0ab|xn--rvc1e0am3e|international|lifeinsurance|travelchannel|wolterskluwer|xn--cckwcxetd|xn--eckvdtc9d|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--h2brj9c8c|xn--tiq49xqyj|xn--yfro4i67o|xn--ygbi2ammx|construction|lplfinancial|scholarships|versicherung|xn--3e0b707e|xn--45br5cyl|xn--4dbrk0ce|xn--80adxhks|xn--80asehdb|xn--8y0a063a|xn--gckr3f0f|xn--mgb9awbf|xn--mgbab2bd|xn--mgbgu82a|xn--mgbpl2fh|xn--mgbt3dhd|xn--mk1bu44c|xn--ngbc5azd|xn--ngbe9e0a|xn--ogbpf8fl|xn--qcka1pmc|accountants|barclaycard|blackfriday|blockbuster|bridgestone|calvinklein|contractors|creditunion|engineering|enterprises|foodnetwork|investments|kerryhotels|lamborghini|motorcycles|olayangroup|photography|playstation|productions|progressive|redumbrella|williamhill|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--3bst00m|xn--3ds443g|xn--3hcrj9c|xn--42c2d9a|xn--45brj9c|xn--55qw42g|xn--6frz82g|xn--80ao21a|xn--9krt00a|xn--cck2b3b|xn--czr694b|xn--d1acj3b|xn--efvy88h|xn--fct429k|xn--fjq720a|xn--flw351e|xn--g2xx48c|xn--gecrj9c|xn--gk3at1e|xn--h2brj9c|xn--hxt814e|xn--imr513n|xn--j6w193g|xn--jvr189m|xn--kprw13d|xn--kpry57d|xn--mgbbh1a|xn--mgbtx2b|xn--mix891f|xn--nyqy26a|xn--otu796d|xn--pgbs0dh|xn--q9jyb4c|xn--rhqv96g|xn--rovu88b|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--vuq861b|xn--w4rs40l|xn--xhq521b|xn--zfr164b|\u0b9a\u0bbf\u0b99\u0bcd\u0b95\u0baa\u0bcd\u0baa\u0bc2\u0bb0\u0bcd|accountant|apartments|associates|basketball|bnpparibas|boehringer|capitalone|consulting|creditcard|cuisinella|eurovision|extraspace|foundation|healthcare|immobilien|industries|management|mitsubishi|nextdirect|properties|protection|prudential|realestate|republican|restaurant|schaeffler|swiftcover|tatamotors|technology|university|vlaanderen|volkswagen|xn--30rr7y|xn--3pxu8k|xn--45q11c|xn--4gbrim|xn--55qx5d|xn--5tzm5g|xn--80aswg|xn--90a3ac|xn--9dbq2a|xn--9et52u|xn--c2br7g|xn--cg4bki|xn--czrs0t|xn--czru2d|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--io0a7i|xn--kput3i|xn--mxtq1m|xn--o3cw4h|xn--pssy2u|xn--q7ce6a|xn--unup4y|xn--wgbh1c|xn--wgbl6a|xn--y9a3aq|accenture|alfaromeo|allfinanz|amsterdam|analytics|aquarelle|barcelona|bloomberg|christmas|community|directory|education|equipment|fairwinds|financial|firestone|fresenius|frontdoor|furniture|goldpoint|hisamitsu|homedepot|homegoods|homesense|institute|insurance|kuokgroup|lancaster|landrover|lifestyle|marketing|marshalls|melbourne|microsoft|panasonic|passagens|pramerica|richardli|scjohnson|shangrila|solutions|statebank|statefarm|stockholm|travelers|vacations|xn--90ais|xn--c1avg|xn--d1alf|xn--e1a4c|xn--fhbei|xn--j1aef|xn--j1amh|xn--l1acc|xn--ngbrx|xn--nqv7f|xn--p1acf|xn--qxa6a|xn--tckwe|xn--vhquv|yodobashi|\u0645\u0648\u0631\u064a\u062a\u0627\u0646\u064a\u0627|abudhabi|airforce|allstate|attorney|barclays|barefoot|bargains|baseball|boutique|bradesco|broadway|brussels|budapest|builders|business|capetown|catering|catholic|cipriani|cityeats|cleaning|clinique|clothing|commbank|computer|delivery|deloitte|democrat|diamonds|discount|discover|download|engineer|ericsson|etisalat|exchange|feedback|fidelity|firmdale|football|frontier|goodyear|grainger|graphics|guardian|hdfcbank|helsinki|holdings|hospital|infiniti|ipiranga|istanbul|jpmorgan|lighting|lundbeck|marriott|maserati|mckinsey|memorial|merckmsd|mortgage|observer|partners|pharmacy|pictures|plumbing|property|redstone|reliance|saarland|samsclub|security|services|shopping|showtime|softbank|software|stcgroup|supplies|training|vanguard|ventures|verisign|woodside|xn--90ae|xn--node|xn--p1ai|xn--qxam|yokohama|\u0627\u0644\u0633\u0639\u0648\u062f\u064a\u0629|abogado|academy|agakhan|alibaba|android|athleta|auction|audible|auspost|avianca|banamex|bauhaus|bentley|bestbuy|booking|brother|bugatti|capital|caravan|careers|channel|charity|chintai|citadel|clubmed|college|cologne|comcast|company|compare|contact|cooking|corsica|country|coupons|courses|cricket|cruises|dentist|digital|domains|exposed|express|farmers|fashion|ferrari|ferrero|finance|fishing|fitness|flights|florist|flowers|forsale|frogans|fujitsu|gallery|genting|godaddy|grocery|guitars|hamburg|hangout|hitachi|holiday|hosting|hoteles|hotmail|hyundai|ismaili|jewelry|juniper|kitchen|komatsu|lacaixa|lanxess|lasalle|latrobe|leclerc|limited|lincoln|markets|monster|netbank|netflix|network|neustar|okinawa|oldnavy|organic|origins|philips|pioneer|politie|realtor|recipes|rentals|reviews|rexroth|samsung|sandvik|schmidt|schwarz|science|shiksha|singles|staples|storage|support|surgery|systems|temasek|theater|theatre|tickets|tiffany|toshiba|trading|walmart|wanggou|watches|weather|website|wedding|whoswho|windows|winners|xfinity|yamaxun|youtube|zuerich|\u043a\u0430\u0442\u043e\u043b\u0438\u043a|\u0627\u062a\u0635\u0627\u0644\u0627\u062a|\u0627\u0644\u0628\u062d\u0631\u064a\u0646|\u0627\u0644\u062c\u0632\u0627\u0626\u0631|\u0627\u0644\u0639\u0644\u064a\u0627\u0646|\u067e\u0627\u06a9\u0633\u062a\u0627\u0646|\u0643\u0627\u062b\u0648\u0644\u064a\u0643|\u0b87\u0ba8\u0bcd\u0ba4\u0bbf\u0baf\u0bbe|abarth|abbott|abbvie|africa|agency|airbus|airtel|alipay|alsace|alstom|amazon|anquan|aramco|author|bayern|beauty|berlin|bharti|bostik|boston|broker|camera|career|casino|center|chanel|chrome|church|circle|claims|clinic|coffee|comsec|condos|coupon|credit|cruise|dating|datsun|dealer|degree|dental|design|direct|doctor|dunlop|dupont|durban|emerck|energy|estate|events|expert|family|flickr|futbol|gallup|garden|george|giving|global|google|gratis|health|hermes|hiphop|hockey|hotels|hughes|imamat|insure|intuit|jaguar|joburg|juegos|kaufen|kinder|kindle|kosher|lancia|latino|lawyer|lefrak|living|locker|london|luxury|madrid|maison|makeup|market|mattel|mobile|monash|mormon|moscow|museum|mutual|nagoya|natura|nissan|nissay|norton|nowruz|office|olayan|online|oracle|orange|otsuka|pfizer|photos|physio|pictet|quebec|racing|realty|reisen|repair|report|review|rocher|rogers|ryukyu|safety|sakura|sanofi|school|schule|search|secure|select|shouji|soccer|social|stream|studio|supply|suzuki|swatch|sydney|taipei|taobao|target|tattoo|tennis|tienda|tjmaxx|tkmaxx|toyota|travel|unicom|viajes|viking|villas|virgin|vision|voting|voyage|vuelos|walter|webcam|xihuan|yachts|yandex|zappos|\u043c\u043e\u0441\u043a\u0432\u0430|\u043e\u043d\u043b\u0430\u0439\u043d|\u0627\u0628\u0648\u0638\u0628\u064a|\u0627\u0631\u0627\u0645\u0643\u0648|\u0627\u0644\u0627\u0631\u062f\u0646|\u0627\u0644\u0645\u063a\u0631\u0628|\u0627\u0645\u0627\u0631\u0627\u062a|\u0641\u0644\u0633\u0637\u064a\u0646|\u0645\u0644\u064a\u0633\u064a\u0627|\u092d\u093e\u0930\u0924\u092e\u094d|\u0b87\u0bb2\u0b99\u0bcd\u0b95\u0bc8|\u30d5\u30a1\u30c3\u30b7\u30e7\u30f3|actor|adult|aetna|amfam|amica|apple|archi|audio|autos|azure|baidu|beats|bible|bingo|black|boats|bosch|build|canon|cards|chase|cheap|cisco|citic|click|cloud|coach|codes|crown|cymru|dabur|dance|deals|delta|drive|dubai|earth|edeka|email|epson|faith|fedex|final|forex|forum|gallo|games|gifts|gives|glade|glass|globo|gmail|green|gripe|group|gucci|guide|homes|honda|horse|house|hyatt|ikano|irish|jetzt|koeln|kyoto|lamer|lease|legal|lexus|lilly|linde|lipsy|lixil|loans|locus|lotte|lotto|macys|mango|media|miami|money|movie|nexus|nikon|ninja|nokia|nowtv|omega|osaka|paris|parts|party|phone|photo|pizza|place|poker|praxi|press|prime|promo|quest|radio|rehab|reise|ricoh|rocks|rodeo|rugby|salon|sener|seven|sharp|shell|shoes|skype|sling|smart|smile|solar|space|sport|stada|store|study|style|sucks|swiss|tatar|tires|tirol|tmall|today|tokyo|tools|toray|total|tours|trade|trust|tunes|tushu|ubank|vegas|video|vodka|volvo|wales|watch|weber|weibo|works|world|xerox|yahoo|\u05d9\u05e9\u05e8\u05d0\u05dc|\u0627\u06cc\u0631\u0627\u0646|\u0628\u0627\u0632\u0627\u0631|\u0628\u06be\u0627\u0631\u062a|\u0633\u0648\u062f\u0627\u0646|\u0633\u0648\u0631\u064a\u0629|\u0647\u0645\u0631\u0627\u0647|\u092d\u093e\u0930\u094b\u0924|\u0938\u0902\u0917\u0920\u0928|\u09ac\u09be\u0982\u09b2\u09be|\u0c2d\u0c3e\u0c30\u0c24\u0c4d|\u0d2d\u0d3e\u0d30\u0d24\u0d02|\u5609\u91cc\u5927\u9152\u5e97|aarp|able|adac|aero|akdn|ally|amex|arab|army|arpa|arte|asda|asia|audi|auto|baby|band|bank|bbva|beer|best|bike|bing|blog|blue|bofa|bond|book|buzz|cafe|call|camp|care|cars|casa|case|cash|cbre|cern|chat|citi|city|club|cool|coop|cyou|data|date|dclk|deal|dell|desi|diet|dish|docs|duck|dvag|erni|fage|fail|fans|farm|fast|fiat|fido|film|fire|fish|flir|food|ford|free|fund|game|gbiz|gent|ggee|gift|gmbh|gold|golf|goog|guge|guru|hair|haus|hdfc|help|here|hgtv|host|hsbc|icbc|ieee|imdb|immo|info|itau|java|jeep|jobs|jprs|kddi|kiwi|kpmg|kred|land|lego|lgbt|lidl|life|like|limo|link|live|loan|loft|love|ltda|luxe|maif|meet|meme|menu|mini|mint|mobi|moda|moto|name|navy|news|next|nico|nike|ollo|open|page|pars|pccw|pics|ping|pink|play|plus|pohl|porn|post|prod|prof|qpon|raid|read|reit|rent|rest|rich|rmit|room|rsvp|ruhr|safe|sale|sarl|save|saxo|scot|seat|seek|sexy|shaw|shia|shop|show|silk|sina|site|skin|sncf|sohu|song|sony|spot|star|surf|talk|taxi|team|tech|teva|tiaa|tips|town|toys|tube|vana|visa|viva|vivo|vote|voto|wang|weir|wien|wiki|wine|work|xbox|yoga|zara|zero|zone|\u0434\u0435\u0442\u0438|\u0441\u0430\u0439\u0442|\u0628\u0627\u0631\u062a|\u0628\u064a\u062a\u0643|\u0680\u0627\u0631\u062a|\u062a\u0648\u0646\u0633|\u0634\u0628\u0643\u0629|\u0639\u0631\u0627\u0642|\u0639\u0645\u0627\u0646|\u0645\u0648\u0642\u0639|\u092d\u093e\u0930\u0924|\u09ad\u09be\u09b0\u09a4|\u09ad\u09be\u09f0\u09a4|\u0a2d\u0a3e\u0a30\u0a24|\u0aad\u0abe\u0ab0\u0aa4|\u0b2d\u0b3e\u0b30\u0b24|\u0cad\u0cbe\u0cb0\u0ca4|\u0dbd\u0d82\u0d9a\u0dcf|\u30a2\u30de\u30be\u30f3|\u30b0\u30fc\u30b0\u30eb|\u30af\u30e9\u30a6\u30c9|\u30dd\u30a4\u30f3\u30c8|\u5927\u4f17\u6c7d\u8f66|\u7ec4\u7ec7\u673a\u6784|\u96fb\u8a0a\u76c8\u79d1|\u9999\u683c\u91cc\u62c9|aaa|abb|abc|aco|ads|aeg|afl|aig|anz|aol|app|art|aws|axa|bar|bbc|bbt|bcg|bcn|bet|bid|bio|biz|bms|bmw|bom|boo|bot|box|buy|bzh|cab|cal|cam|car|cat|cba|cbn|cbs|ceo|cfa|cfd|com|cpa|crs|csc|dad|day|dds|dev|dhl|diy|dnp|dog|dot|dtv|dvr|eat|eco|edu|esq|eus|fan|fit|fly|foo|fox|frl|ftr|fun|fyi|gal|gap|gay|gdn|gea|gle|gmo|gmx|goo|gop|got|gov|hbo|hiv|hkt|hot|how|ibm|ice|icu|ifm|inc|ing|ink|int|ist|itv|jcb|jio|jll|jmp|jnj|jot|joy|kfh|kia|kim|kpn|krd|lat|law|lds|llc|llp|lol|lpl|ltd|man|map|mba|med|men|mil|mit|mlb|mls|mma|moe|moi|mom|mov|msd|mtn|mtr|nab|nba|nec|net|new|nfl|ngo|nhk|now|nra|nrw|ntt|nyc|obi|off|one|ong|onl|ooo|org|ott|ovh|pay|pet|phd|pid|pin|pnc|pro|pru|pub|pwc|qvc|red|ren|ril|rio|rip|run|rwe|sap|sas|sbi|sbs|sca|scb|ses|sew|sex|sfr|ski|sky|soy|spa|srl|stc|tab|tax|tci|tdk|tel|thd|tjx|top|trv|tui|tvs|ubs|uno|uol|ups|vet|vig|vin|vip|wed|win|wme|wow|wtc|wtf|xin|xxx|xyz|you|yun|zip|\u0431\u0435\u043b|\u043a\u043e\u043c|\u049b\u0430\u0437|\u043c\u043a\u0434|\u043c\u043e\u043d|\u043e\u0440\u0433|\u0440\u0443\u0441|\u0441\u0440\u0431|\u0443\u043a\u0440|\u0570\u0561\u0575|\u05e7\u05d5\u05dd|\u0639\u0631\u0628|\u0642\u0637\u0631|\u0643\u0648\u0645|\u0645\u0635\u0631|\u0915\u0949\u092e|\u0928\u0947\u091f|\u0e04\u0e2d\u0e21|\u0e44\u0e17\u0e22|\u0ea5\u0eb2\u0ea7|\u30b9\u30c8\u30a2|\u30bb\u30fc\u30eb|\u307f\u3093\u306a|\u4e2d\u6587\u7f51|\u4e9a\u9a6c\u900a|\u5929\u4e3b\u6559|\u6211\u7231\u4f60|\u65b0\u52a0\u5761|\u6de1\u9a6c\u9521|\u8bfa\u57fa\u4e9a|\u98de\u5229\u6d66|ac|ad|ae|af|ag|ai|al|am|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|\u03b5\u03bb|\u03b5\u03c5|\u0431\u0433|\u0435\u044e|\u0440\u0444|\u10d2\u10d4|\ub2f7\ub137|\ub2f7\ucef4|\uc0bc\uc131|\ud55c\uad6d|\u30b3\u30e0|\u4e16\u754c|\u4e2d\u4fe1|\u4e2d\u56fd|\u4e2d\u570b|\u4f01\u4e1a|\u4f5b\u5c71|\u4fe1\u606f|\u5065\u5eb7|\u516b\u5366|\u516c\u53f8|\u516c\u76ca|\u53f0\u6e7e|\u53f0\u7063|\u5546\u57ce|\u5546\u5e97|\u5546\u6807|\u5609\u91cc|\u5728\u7ebf|\u5927\u62ff|\u5a31\u4e50|\u5bb6\u96fb|\u5e7f\u4e1c|\u5fae\u535a|\u6148\u5584|\u624b\u673a|\u62db\u8058|\u653f\u52a1|\u653f\u5e9c|\u65b0\u95fb|\u65f6\u5c1a|\u66f8\u7c4d|\u673a\u6784|\u6e38\u620f|\u6fb3\u9580|\u70b9\u770b|\u79fb\u52a8|\u7f51\u5740|\u7f51\u5e97|\u7f51\u7ad9|\u7f51\u7edc|\u8054\u901a|\u8c37\u6b4c|\u8d2d\u7269|\u901a\u8ca9|\u96c6\u56e2|\u98df\u54c1|\u9910\u5385|\u9999\u6e2f)/,G7=new RegExp("[".concat(gi,"!#$%&'*+/=?^_`{|}~-]")),q7=new RegExp("^".concat(CT.source,"$")),xT=function(n){function t(){var e=null!==n&&n.apply(this,arguments)||this;return e.localPartCharRegex=G7,e.strictTldRegex=q7,e}return Ee(t,n),t.prototype.parseMatches=function(e){for(var i=this.tagBuilder,r=this.localPartCharRegex,s=this.strictTldRegex,o=[],c=e.length,m=new Kp,I={m:"a",a:"i",i:"l",l:"t",t:"o",o:":"},Z=0,fe=0,pe=m;Z<c;){var ye=e.charAt(Z);switch(fe){case 0:"m"===(Je=ye)?ot(1):r.test(Je)&&ot();break;case 1:Me(e.charAt(Z-1),ye);break;case 2:Oe(ye);break;case 3:Be(ye);break;case 4:ke(ye);break;case 5:ze(ye);break;case 6:je(ye);break;case 7:st(ye);break;default:fT(fe)}Z++}var Je;return _t(),o;function Me(Je,at){":"===Je?r.test(at)?(fe=2,pe=new Kp(ce(ce({},pe),{hasMailtoPrefix:!0}))):tt():I[Je]===at||(r.test(at)?fe=2:"."===at?fe=3:"@"===at?fe=4:tt())}function Oe(Je){"."===Je?fe=3:"@"===Je?fe=4:r.test(Je)||tt()}function Be(Je){"."===Je||"@"===Je?tt():r.test(Je)?fe=2:tt()}function ke(Je){Wp.test(Je)?fe=5:tt()}function ze(Je){"."===Je?fe=7:"-"===Je?fe=6:Wp.test(Je)||_t()}function je(Je){"-"===Je||"."===Je?_t():Wp.test(Je)?fe=5:_t()}function st(Je){"."===Je||"-"===Je?_t():Wp.test(Je)?(fe=5,pe=new Kp(ce(ce({},pe),{hasDomainDot:!0}))):_t()}function ot(Je){void 0===Je&&(Je=2),fe=Je,pe=new Kp({idx:Z})}function tt(){fe=0,pe=m}function _t(){if(pe.hasDomainDot){var Je=e.slice(pe.idx,Z);/[-.]$/.test(Je)&&(Je=Je.slice(0,-1));var at=pe.hasMailtoPrefix?Je.slice(7):Je;(function ft(Ut){var fn=(Ut.split(".").pop()||"").toLowerCase();return s.test(fn)})(at)&&o.push(new pT({tagBuilder:i,matchedText:Je,offset:pe.idx,email:at}))}tt()}},t}(uu),Kp=function n(t){void 0===t&&(t={}),this.idx=void 0!==t.idx?t.idx:-1,this.hasMailtoPrefix=!!t.hasMailtoPrefix,this.hasDomainDot=!!t.hasDomainDot},W7=function(){function n(){}return n.isValid=function(t,e){return!(e&&!this.isValidUriScheme(e)||this.urlMatchDoesNotHaveProtocolOrDot(t,e)||this.urlMatchDoesNotHaveAtLeastOneWordChar(t,e)&&!this.isValidIpAddress(t)||this.containsMultipleDots(t))},n.isValidIpAddress=function(t){var e=new RegExp(this.hasFullProtocolRegex.source+this.ipRegex.source);return null!==t.match(e)},n.containsMultipleDots=function(t){var e=t;return this.hasFullProtocolRegex.test(t)&&(e=t.split("://")[1]),e.split("/")[0].indexOf("..")>-1},n.isValidUriScheme=function(t){var e=t.match(this.uriSchemeRegex),i=e&&e[0].toLowerCase();return"javascript:"!==i&&"vbscript:"!==i},n.urlMatchDoesNotHaveProtocolOrDot=function(t,e){return!(!t||e&&this.hasFullProtocolRegex.test(e)||-1!==t.indexOf("."))},n.urlMatchDoesNotHaveAtLeastOneWordChar=function(t,e){return!(!t||!e||this.hasFullProtocolRegex.test(e)||this.hasWordCharAfterProtocolRegex.test(t))},n.hasFullProtocolRegex=/^[A-Za-z][-.+A-Za-z0-9]*:\/\//,n.uriSchemeRegex=/^[A-Za-z][-.+A-Za-z0-9]*:/,n.hasWordCharAfterProtocolRegex=new RegExp(":[^\\s]*?["+vT+"]"),n.ipRegex=/[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?(:[0-9]*)?\/?$/,n}(),K7=(e=new RegExp("[/?#](?:["+gi+"\\-+&@#/%=~_()|'$*\\[\\]{}?!:,.;^\u2713]*["+gi+"\\-+&@#/%=~_()|'$*\\[\\]{}\u2713])?"),new RegExp(["(?:","(",/(?:[A-Za-z][-.+A-Za-z0-9]{0,63}:(?![A-Za-z][-.+A-Za-z0-9]{0,63}:\/\/)(?!\d+\/?)(?:\/\/)?)/.source,Z0(2),")","|","(","(//)?",/(?:www\.)/.source,Z0(6),")","|","(","(//)?",Z0(10)+"\\.",CT.source,"(?![-"+H7+"])",")",")","(?::[0-9]+)?","(?:"+e.source+")?"].join(""),"gi")),Y7=new RegExp("["+gi+"]"),wT=function(n){function t(e){var i=n.call(this,e)||this;return i.stripPrefix={scheme:!0,www:!0},i.stripTrailingSlash=!0,i.decodePercentEncoding=!0,i.matcherRegex=K7,i.wordCharRegExp=Y7,i.stripPrefix=e.stripPrefix,i.stripTrailingSlash=e.stripTrailingSlash,i.decodePercentEncoding=e.decodePercentEncoding,i}return Ee(t,n),t.prototype.parseMatches=function(e){for(var I,i=this.matcherRegex,r=this.stripPrefix,s=this.stripTrailingSlash,o=this.decodePercentEncoding,c=this.tagBuilder,m=[],Z=function(){var pe=I[0],ye=I[1],we=I[4],Be=I.index,ke=I[5]||I[9],ze=e.charAt(Be-1);if(!W7.isValid(pe,ye)||Be>0&&"@"===ze||Be>0&&ke&&fe.wordCharRegExp.test(ze))return"continue";if(/\?$/.test(pe)&&(pe=pe.substr(0,pe.length-1)),fe.matchHasUnbalancedClosingParen(pe))pe=pe.substr(0,pe.length-1);else{var je=fe.matchHasInvalidCharAfterTld(pe,ye);je>-1&&(pe=pe.substr(0,je))}var st=["http://","https://"].find(function(Je){return!!ye&&-1!==ye.indexOf(Je)});if(st){var ot=pe.indexOf(st);pe=pe.substr(ot),ye=ye.substr(ot),Be+=ot}m.push(new $T({tagBuilder:c,matchedText:pe,offset:Be,urlMatchType:ye?"scheme":we?"www":"tld",url:pe,protocolUrlMatch:!!ye,protocolRelativeMatch:!!ke,stripPrefix:r,stripTrailingSlash:s,decodePercentEncoding:o}))},fe=this;null!==(I=i.exec(e));)Z();return m},t.prototype.matchHasUnbalancedClosingParen=function(e){var r,i=e.charAt(e.length-1);if(")"===i)r="(";else if("]"===i)r="[";else{if("}"!==i)return!1;r="{"}for(var s=0,o=0,c=e.length-1;o<c;o++){var m=e.charAt(o);m===r?s++:m===i&&(s=Math.max(s-1,0))}return 0===s},t.prototype.matchHasInvalidCharAfterTld=function(e,i){if(!e)return-1;var r=0;i&&(r=e.indexOf(":"),e=e.slice(r));var o=new RegExp("^((.?//)?[-."+gi+"]*[-"+gi+"]\\.[-"+gi+"]+)").exec(e);return null===o?-1:(r+=o[1].length,e=e.slice(o[1].length),/^[^-.A-Za-z0-9:\/?#]/.test(e)?r:-1)},t}(uu),Z7=new RegExp("#[_".concat(gi,"]{1,139}(?![_").concat(gi,"])"),"g"),X7=new RegExp("[^"+gi+"]"),ET=function(n){function t(e){var i=n.call(this,e)||this;return i.serviceName="twitter",i.matcherRegex=Z7,i.nonWordCharRegex=X7,i.serviceName=e.serviceName,i}return Ee(t,n),t.prototype.parseMatches=function(e){for(var m,i=this.matcherRegex,r=this.nonWordCharRegex,s=this.serviceName,o=this.tagBuilder,c=[];null!==(m=i.exec(e));){var I=m.index,Z=e.charAt(I-1);if(0===I||r.test(Z)){var fe=m[0],pe=m[0].slice(1);c.push(new gT({tagBuilder:o,matchedText:fe,offset:I,serviceName:s,hashtag:pe}))}}return c},t}(uu),ez=new RegExp("".concat(/(?:(?:(?:(\+)?\d{1,3}[-\040.]?)?\(?\d{3}\)?[-\040.]?\d{3}[-\040.]?\d{4})|(?:(\+)(?:9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)[-\040.]?(?:\d[-\040.]?){6,12}\d+))([,;]+[0-9]+#?)*/.source,"|").concat(/(0([1-9]{1}-?[1-9]\d{3}|[1-9]{2}-?\d{3}|[1-9]{2}\d{1}-?\d{2}|[1-9]{2}\d{2}-?\d{1})-?\d{4}|0[789]0-?\d{4}-?\d{4}|050-?\d{4}-?\d{4})/.source),"g"),TT=function(n){function t(){var e=null!==n&&n.apply(this,arguments)||this;return e.matcherRegex=ez,e}return Ee(t,n),t.prototype.parseMatches=function(e){for(var o,i=this.matcherRegex,r=this.tagBuilder,s=[];null!==(o=i.exec(e));){var c=o[0],m=c.replace(/[^0-9,;#]/g,""),I=!(!o[1]&&!o[2]),Z=0==o.index?"":e.substr(o.index-1,1),fe=e.substr(o.index+c.length,1),pe=!Z.match(/\d/)&&!fe.match(/\d/);this.testMatch(o[3])&&this.testMatch(c)&&pe&&s.push(new _T({tagBuilder:r,matchedText:c,offset:o.index,number:m,plusSign:I}))}return s},t.prototype.testMatch=function(e){return B7.test(e)},t}(uu),tz=new RegExp("@[_".concat(gi,"]{1,50}(?![_").concat(gi,"])"),"g"),nz=new RegExp("@[_.".concat(gi,"]{1,30}(?![_").concat(gi,"])"),"g"),iz=new RegExp("@[-_.".concat(gi,"]{1,50}(?![-_").concat(gi,"])"),"g"),rz=new RegExp("@[_.".concat(gi,"]{1,23}[_").concat(gi,"](?![_").concat(gi,"])"),"g"),sz=new RegExp("[^"+gi+"]"),IT=function(n){function t(e){var i=n.call(this,e)||this;return i.serviceName="twitter",i.matcherRegexes={twitter:tz,instagram:nz,soundcloud:iz,tiktok:rz},i.nonWordCharRegex=sz,i.serviceName=e.serviceName,i}return Ee(t,n),t.prototype.parseMatches=function(e){var m,i=this.serviceName,r=this.matcherRegexes[this.serviceName],s=this.nonWordCharRegex,o=this.tagBuilder,c=[];if(!r)return c;for(;null!==(m=r.exec(e));){var I=m.index,Z=e.charAt(I-1);if(0===I||s.test(Z)){var fe=m[0].replace(/\.+$/g,""),pe=fe.slice(1);c.push(new mT({tagBuilder:o,matchedText:fe,offset:I,serviceName:i,mention:pe}))}}return c},t}(uu);var Ro=function n(t){void 0===t&&(t={}),this.idx=void 0!==t.idx?t.idx:-1,this.type=t.type||"tag",this.name=t.name||"",this.isOpening=!!t.isOpening,this.isClosing=!!t.isClosing},az=function(){function n(t){void 0===t&&(t={}),this.version=n.version,this.urls={},this.email=!0,this.phone=!0,this.hashtag=!1,this.mention=!1,this.newWindow=!0,this.stripPrefix={scheme:!0,www:!0},this.stripTrailingSlash=!0,this.decodePercentEncoding=!0,this.truncate={length:0,location:"end"},this.className="",this.replaceFn=null,this.context=void 0,this.sanitizeHtml=!1,this.matchers=null,this.tagBuilder=null,this.urls=this.normalizeUrlsCfg(t.urls),this.email="boolean"==typeof t.email?t.email:this.email,this.phone="boolean"==typeof t.phone?t.phone:this.phone,this.hashtag=t.hashtag||this.hashtag,this.mention=t.mention||this.mention,this.newWindow="boolean"==typeof t.newWindow?t.newWindow:this.newWindow,this.stripPrefix=this.normalizeStripPrefixCfg(t.stripPrefix),this.stripTrailingSlash="boolean"==typeof t.stripTrailingSlash?t.stripTrailingSlash:this.stripTrailingSlash,this.decodePercentEncoding="boolean"==typeof t.decodePercentEncoding?t.decodePercentEncoding:this.decodePercentEncoding,this.sanitizeHtml=t.sanitizeHtml||!1;var e=this.mention;if(!1!==e&&-1===["twitter","instagram","soundcloud","tiktok"].indexOf(e))throw new Error("invalid `mention` cfg '".concat(e,"' - see docs"));var i=this.hashtag;if(!1!==i&&-1===["twitter","facebook","instagram","tiktok"].indexOf(i))throw new Error("invalid `hashtag` cfg '".concat(i,"' - see docs"));this.truncate=this.normalizeTruncateCfg(t.truncate),this.className=t.className||this.className,this.replaceFn=t.replaceFn||this.replaceFn,this.context=t.context||this}return n.link=function(t,e){return new n(e).link(t)},n.parse=function(t,e){return new n(e).parse(t)},n.prototype.normalizeUrlsCfg=function(t){return null==t&&(t=!0),"boolean"==typeof t?{schemeMatches:t,wwwMatches:t,tldMatches:t}:{schemeMatches:"boolean"!=typeof t.schemeMatches||t.schemeMatches,wwwMatches:"boolean"!=typeof t.wwwMatches||t.wwwMatches,tldMatches:"boolean"!=typeof t.tldMatches||t.tldMatches}},n.prototype.normalizeStripPrefixCfg=function(t){return null==t&&(t=!0),"boolean"==typeof t?{scheme:t,www:t}:{scheme:"boolean"!=typeof t.scheme||t.scheme,www:"boolean"!=typeof t.www||t.www}},n.prototype.normalizeTruncateCfg=function(t){return"number"==typeof t?{length:t,location:"end"}:function D7(n,t){for(var e in t)t.hasOwnProperty(e)&&void 0===n[e]&&(n[e]=t[e]);return n}(t||{},{length:Number.POSITIVE_INFINITY,location:"end"})},n.prototype.parse=function(t){var e=this,i=["a","style","script"],r=0,s=[];return function oz(n,t){for(var e=t.onOpenTag,i=t.onCloseTag,r=t.onText,s=t.onComment,o=t.onDoctype,c=new Ro,m=0,I=n.length,Z=0,fe=0,pe=c;m<I;){var ye=n.charAt(m);switch(Z){case 0:"<"===ye&&mn();break;case 1:"!"===(pt=ye)?Z=13:"/"===pt?(Z=2,pe=new Ro(ce(ce({},pe),{isClosing:!0}))):"<"===pt?mn():K0.test(pt)?(Z=3,pe=new Ro(ce(ce({},pe),{isOpening:!0}))):(Z=0,pe=c);break;case 2:Be(ye);break;case 3:Oe(ye);break;case 4:ke(ye);break;case 5:ze(ye);break;case 6:je(ye);break;case 7:st(ye);break;case 8:ot(ye);break;case 9:tt(ye);break;case 10:_t(ye);break;case 11:Je(ye);break;case 12:at(ye);break;case 13:"--"===n.substr(m,2)?(m+=2,pe=new Ro(ce(ce({},pe),{type:"comment"})),Z=14):"DOCTYPE"===n.substr(m,7).toUpperCase()?(m+=7,pe=new Ro(ce(ce({},pe),{type:"doctype"})),Z=20):Pt();break;case 14:Ut(ye);break;case 15:zt(ye);break;case 16:fn(ye);break;case 17:Nn(ye);break;case 18:bt(ye);break;case 19:wt(ye);break;case 20:Et(ye);break;default:fT(Z)}m++}var pt;function Oe(pt){Vl.test(pt)?(pe=new Ro(ce(ce({},pe),{name:mi()})),Z=4):"<"===pt?mn():"/"===pt?(pe=new Ro(ce(ce({},pe),{name:mi()})),Z=12):">"===pt?(pe=new Ro(ce(ce({},pe),{name:mi()})),Rn()):!K0.test(pt)&&!R7.test(pt)&&":"!==pt&&Pt()}function Be(pt){">"===pt?Pt():K0.test(pt)?Z=3:Pt()}function ke(pt){Vl.test(pt)||("/"===pt?Z=12:">"===pt?Rn():"<"===pt?mn():"="===pt||Y0.test(pt)||L7.test(pt)?Pt():Z=5)}function ze(pt){Vl.test(pt)?Z=6:"/"===pt?Z=12:"="===pt?Z=7:">"===pt?Rn():"<"===pt?mn():Y0.test(pt)&&Pt()}function je(pt){Vl.test(pt)||("/"===pt?Z=12:"="===pt?Z=7:">"===pt?Rn():"<"===pt?mn():Y0.test(pt)?Pt():Z=5)}function st(pt){Vl.test(pt)||('"'===pt?Z=8:"'"===pt?Z=9:/[>=`]/.test(pt)?Pt():"<"===pt?mn():Z=10)}function ot(pt){'"'===pt&&(Z=11)}function tt(pt){"'"===pt&&(Z=11)}function _t(pt){Vl.test(pt)?Z=4:">"===pt?Rn():"<"===pt&&mn()}function Je(pt){Vl.test(pt)?Z=4:"/"===pt?Z=12:">"===pt?Rn():"<"===pt?mn():(Z=4,function wn(){m--}())}function at(pt){">"===pt?(pe=new Ro(ce(ce({},pe),{isClosing:!0})),Rn()):Z=4}function Ut(pt){"-"===pt?Z=15:">"===pt?Pt():Z=16}function zt(pt){"-"===pt?Z=18:">"===pt?Pt():Z=16}function fn(pt){"-"===pt&&(Z=17)}function Nn(pt){Z="-"===pt?18:16}function bt(pt){">"===pt?Rn():"!"===pt?Z=19:"-"===pt||(Z=16)}function wt(pt){"-"===pt?Z=17:">"===pt?Rn():Z=16}function Et(pt){">"===pt?Rn():"<"===pt&&mn()}function Pt(){Z=0,pe=c}function mn(){Z=1,pe=new Ro({idx:m})}function Rn(){var pt=n.slice(fe,pe.idx);pt&&r(pt,fe),"comment"===pe.type?s(pe.idx):"doctype"===pe.type?o(pe.idx):(pe.isOpening&&e(pe.name,pe.idx),pe.isClosing&&i(pe.name,pe.idx)),Pt(),fe=m+1}function mi(){return n.slice(pe.idx+(pe.isClosing?2:1),m).toLowerCase()}fe<m&&function Hn(){var pt=n.slice(fe,m);r(pt,fe),fe=m+1}()}(t,{onOpenTag:function(o){i.indexOf(o)>=0&&r++},onText:function(o,c){if(0===r){var I=function P7(n,t){if(!t.global)throw new Error("`splitRegex` must have the 'g' flag set");for(var r,e=[],i=0;r=t.exec(n);)e.push(n.substring(i,r.index)),e.push(r[0]),i=r.index+r[0].length;return e.push(n.substring(i)),e}(o,/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi),Z=c;I.forEach(function(fe,pe){if(pe%2==0){var ye=e.parseText(fe,Z);s.push.apply(s,ye)}Z+=fe.length})}},onCloseTag:function(o){i.indexOf(o)>=0&&(r=Math.max(r-1,0))},onComment:function(o){},onDoctype:function(o){}}),s=this.compactMatches(s),s=this.removeUnwantedMatches(s)},n.prototype.compactMatches=function(t){t.sort(function(m,I){return m.getOffset()-I.getOffset()});for(var e=0;e<t.length-1;){var i=t[e],r=i.getOffset(),s=i.getMatchedText().length,o=r+s;if(e+1<t.length){if(t[e+1].getOffset()===r){var c=t[e+1].getMatchedText().length>s?e:e+1;t.splice(c,1);continue}if(t[e+1].getOffset()<o){t.splice(e+1,1);continue}}e++}return t},n.prototype.removeUnwantedMatches=function(t){return this.hashtag||Ul(t,function(e){return"hashtag"===e.getType()}),this.email||Ul(t,function(e){return"email"===e.getType()}),this.phone||Ul(t,function(e){return"phone"===e.getType()}),this.mention||Ul(t,function(e){return"mention"===e.getType()}),this.urls.schemeMatches||Ul(t,function(e){return"url"===e.getType()&&"scheme"===e.getUrlMatchType()}),this.urls.wwwMatches||Ul(t,function(e){return"url"===e.getType()&&"www"===e.getUrlMatchType()}),this.urls.tldMatches||Ul(t,function(e){return"url"===e.getType()&&"tld"===e.getUrlMatchType()}),t},n.prototype.parseText=function(t,e){void 0===e&&(e=0),e=e||0;for(var i=this.getMatchers(),r=[],s=0,o=i.length;s<o;s++){for(var c=i[s].parseMatches(t),m=0,I=c.length;m<I;m++)c[m].setOffset(e+c[m].getOffset());r.push.apply(r,c)}return r},n.prototype.link=function(t){if(!t)return"";this.sanitizeHtml&&(t=t.replace(/</g,"&lt;").replace(/>/g,"&gt;"));for(var e=this.parse(t),i=[],r=0,s=0,o=e.length;s<o;s++){var c=e[s];i.push(t.substring(r,c.getOffset())),i.push(this.createMatchReturnVal(c)),r=c.getOffset()+c.getMatchedText().length}return i.push(t.substring(r)),i.join("")},n.prototype.createMatchReturnVal=function(t){var e;return this.replaceFn&&(e=this.replaceFn.call(this.context,t)),"string"==typeof e?e:!1===e?t.getMatchedText():e instanceof W0?e.toAnchorString():t.buildTag().toAnchorString()},n.prototype.getMatchers=function(){if(this.matchers)return this.matchers;var t=this.getTagBuilder(),e=[new ET({tagBuilder:t,serviceName:this.hashtag}),new xT({tagBuilder:t}),new TT({tagBuilder:t}),new IT({tagBuilder:t,serviceName:this.mention}),new wT({tagBuilder:t,stripPrefix:this.stripPrefix,stripTrailingSlash:this.stripTrailingSlash,decodePercentEncoding:this.decodePercentEncoding})];return this.matchers=e},n.prototype.getTagBuilder=function(){var t=this.tagBuilder;return t||(t=this.tagBuilder=new hT({newWindow:this.newWindow,truncate:this.truncate,className:this.className})),t},n.version="3.15.0",n.AnchorTagBuilder=hT,n.HtmlTag=W0,n.matcher={Email:xT,Hashtag:ET,Matcher:uu,Mention:IT,Phone:TT,Url:wT},n.match={Email:pT,Hashtag:gT,Match:cu,Mention:mT,Phone:_T,Url:$T},n}();const ST=az,X0=ST;let In=(()=>{class n{constructor(){this.title="\u7121\u540d\u306e\u30d1\u30cd\u30eb",this.left=0,this.top=0,this.width=100,this.height=100,this.isAbleMinimizeButton=!0,this.isAbleFullScreenButton=!0,this.isAbleCloseButton=!0,this.isAbleRotateButton=!1,this.scrollablePanel=null}get isShow(){return!!this.panelComponentRef}open(e,i,r){let s;r||(r=n.defaultParentViewContainerRef),s=r.createComponent(n.UIPanelComponentClass,{index:r.length,injector:r.injector});let o=s.instance.content.createComponent(e);const c=s.injector.get(n);return c.panelComponentRef=s,i&&(i.title&&(c.title=i.title),i.top&&(c.top=i.top),i.left&&(c.left=i.left),i.width&&(c.width=i.width),i.height&&(c.height=i.height)),s.onDestroy(()=>{c.panelComponentRef=null}),o.instance}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}}return n.UIPanelComponentClass=null,n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=tn({token:n,factory:n.\u0275fac}),n})();class lz{constructor(t,e,i){this._resolve=t,this._reject=e,this.option=i}resolve(t){this._resolve(t),this._resolve=null}reject(t){this._reject(t),this._reject=null}}let kn=(()=>{class n{constructor(){this.modalContext=null,this.count=0,this.title="\u7121\u540d\u306e\u30e2\u30fc\u30c0\u30eb"}get option(){return this.modalContext?this.modalContext.option:null}get isShow(){return this.count>0}open(e,i,r){let s;return r||(r=n.defaultParentViewContainerRef),new Promise((o,c)=>{const Z=new n;Z.modalContext=new lz(pe=>{s&&(s.destroy(),o(pe),this.count--)},pe=>{s&&(s.destroy(),c(pe),this.count--)},i);const fe=Yr.create({providers:[{provide:n,useValue:Z}],parent:r.injector});s=r.createComponent(n.ModalComponentClass,{index:r.length,injector:fe}),s.instance.content.createComponent(e),s.onDestroy(()=>{this.count--}),this.count++})}resolve(e){this.modalContext&&(this.modalContext.resolve(e),this.modalContext=null)}reject(e){this.modalContext&&(this.modalContext.reject(e),this.modalContext=null)}}return n.ModalComponentClass=null,n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=tn({token:n,factory:n.\u0275fac}),n})();const cz=function(n){return{outer:n}};function uz(n,t){if(1&n&&(K(0,"div",5),be(1),K(2,"span",6),be(3),J(),be(4),K(5,"span",7),be(6),J()()),2&n){const e=ge();U(1),An("",e.urlObj.protocol,"//"),U(1),te("ngClass",ut(6,cz,e.isOuter)),U(1),qe(e.urlObj.host),U(1),qe(e.urlObj.pathname),U(2),Ta("",e.urlObj.search,"",e.urlObj.hash,"")}}function dz(n,t){if(1&n&&(K(0,"div",5),be(1),J()),2&n){const e=ge();U(1),qe(e.url)}}function fz(n,t){1&n&&(K(0,"div"),be(1,"\u3053\u306eURL\u3092\u958b\u304d\u307e\u3059\u304b\uff1f\uff08\u5225\u30a6\u30a3\u30f3\u30c9\u30a6\u3067\u958b\u304d\u307e\u3059\u3001\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u3092\u8a31\u53ef\u3057\u3066\u304f\u3060\u3055\u3044\uff09"),J())}function hz(n,t){1&n&&(K(0,"div"),be(1,"\u26a0\ufe0fURL\u304c\u4e0d\u6b63\u3067\u3059\u3002"),J())}let Hr=(()=>{class n{constructor(e,i){this.panelService=e,this.modalService=i,this.url="",this.title="",this.subTitle="",this.url=i.option.url?i.option.url:"",this.title=i.option.title?i.option.title:"",this.subTitle=i.option.subTitle?i.option.subTitle:"",this.urlObj=this.isValid?new URL(this.url):null}get isValid(){return et.validUrl(this.url.trim())}get isOuter(){return!!this.isValid&&window.location.origin!=this.urlObj.origin}ngOnInit(){Promise.resolve().then(()=>{let e="\u5916\u90e8URL\u3092\u958b\u304f";this.title?e+="\u3008"+this.title+(this.subTitle?`\uff1a${this.subTitle}`:"")+"\u3009":this.subTitle&&(e+=`\u3008${this.subTitle}\u3009`),this.modalService.title=this.panelService.title=e}),Fe.register(this)}ngOnDestroy(){Fe.unregister(this)}openUrl(){window.open(this.url.trim(),"_blank","noopener"),this.modalService.resolve(!0)}cancel(){this.modalService.resolve(!1)}}return n.\u0275fac=function(e){return new(e||n)(Le(In),Le(kn))},n.\u0275cmp=Zt({type:n,selectors:[["open-url"]],decls:11,vars:5,consts:[["class","url",4,"ngIf"],[1,"help"],[4,"ngIf"],["type","submit",3,"disabled","click"],["type","button",3,"click"],[1,"url"],[3,"ngClass"],[1,"opt"]],template:function(e,i){1&e&&(K(0,"div"),xe(1,uz,7,8,"div",0),xe(2,dz,2,1,"div",0),it(3,"hr"),K(4,"div",1),xe(5,fz,2,0,"div",2),xe(6,hz,2,0,"div",2),J()(),K(7,"button",3),Te("click",function(){return i.openUrl()}),be(8,"\u958b\u304f"),J(),K(9,"button",4),Te("click",function(){return i.cancel()}),be(10,"\u30ad\u30e3\u30f3\u30bb\u30eb"),J()),2&e&&(U(1),te("ngIf",i.isValid),U(1),te("ngIf",!i.isValid),U(3),te("ngIf",i.isValid),U(1),te("ngIf",!i.isValid),U(1),te("disabled",!i.isValid))},directives:[_n,Wn],styles:[".url[_ngcontent-%COMP%]{word-break:break-all}.url[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]{font-weight:700}.opt[_ngcontent-%COMP%]{color:gray}.help[_ngcontent-%COMP%]{font-size:smaller}"]}),n})();const pz=["message"];function gz(n,t){if(1&n&&(K(0,"span")(1,"pre",1),be(2),J()()),2&n){const e=ge();U(2),qe(e.text)}}function mz(n,t){1&n&&it(0,"hr")}function _z(n,t){if(1&n){const e=Xe();K(0,"pre",1)(1,"span",3,4),Te("click",function(r){return De(e),ge(2).onLinkClick(r)}),Ct(3,"safe"),J(),xe(4,mz,1,0,"hr",0),J()}if(2&n){const e=t.$implicit,i=t.last,r=ge(2);U(1),te("innerHTML",xt(3,2,r.htmlEscapeLinking(e),"html"),qi),U(3),te("ngIf",!i)}}function $z(n,t){if(1&n&&(K(0,"span"),xe(1,_z,5,5,"pre",2),J()),2&n){const e=ge();U(1),te("ngForOf",e.text)}}let du=(()=>{class n{constructor(e,i){this.panelService=e,this.modalService=i,this.text="",this.title="",this.stringUtil=et}ngOnInit(){Promise.resolve().then(()=>{this.panelService.title=this.title,this.modalService.option&&null!=this.modalService.option.title&&(this.modalService.title=this.modalService.option.title?this.modalService.option.title:"",this.text=this.modalService.option.text?this.modalService.option.text:"")})}htmlEscapeLinking(e,i=!1){return X0.link(et.escapeHtml(e),{urls:{schemeMatches:!0,wwwMatches:!0,tldMatches:!1},truncate:{length:96,location:"end"},decodePercentEncoding:i,stripPrefix:i,stripTrailingSlash:i,email:!1,phone:!1,replaceFn:function(r){if("url"==r.getType()&&et.validUrl(r.getAnchorHref())){if(et.sameOrigin(r.getAnchorHref()))return!0;{const s=r.buildTag();return s.setAttr("rel","nofollow"),s.addClass("outer-link"),s}}return!1}})}isObj(e){return"object"==typeof e}onLinkClick(e){if(e&&"A"==e.target.tagName){const i=e.target.getAttribute("href");if(!et.sameOrigin(i))return e.preventDefault(),this.modalService.open(Hr,{url:e.target.getAttribute("href")}),!1}return!0}}return n.\u0275fac=function(e){return new(e||n)(Le(In),Le(kn))},n.\u0275cmp=Zt({type:n,selectors:[["text-view"]],viewQuery:function(e,i){if(1&e&&on(pz,5),2&e){let r;sn(r=an())&&(i.messageElm=r.first)}},inputs:{text:"text",title:"title"},decls:2,vars:2,consts:[[4,"ngIf"],[1,"text"],["class","text",4,"ngFor","ngForOf"],[3,"innerHTML","click"],["message",""]],template:function(e,i){1&e&&(xe(0,gz,3,1,"span",0),xe(1,$z,2,1,"span",0)),2&e&&(te("ngIf",!i.isObj(i.text)),U(1),te("ngIf",i.isObj(i.text)))},directives:[_n,ei],pipes:[ti],styles:["[_nghost-%COMP%]{display:block}.text[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;font-size:12px;white-space:pre-wrap;margin:0;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}"]}),n})();var fu;let Ze=(()=>{class n{}return n.dicePick="",n.dicePut="",n.diceRoll1="",n.diceRoll2="",n.cardDraw="",n.cardPick="",n.cardPut="",n.cardShuffle="",n.piecePick="",n.piecePut="",n.blockPick="",n.blockPut="",n.lock="",n.unlock="",n.sweep="",n.puyon="",n.surprise="",n.coinToss="",n})(),dt=fu=class extends Ua{onStoreAdded(){super.onStoreAdded(),Fe.register(this).on("SOUND_EFFECT",t=>{At.play(Lt.instance.get(t.data),.5)}).on("SEND_MESSAGE",t=>{let e=lt.instance.get(t.data.messageIdentifier);!e||!e.isSendFromSelf||e.isEmptyDice||(Math.random()<.5?fu.play(Ze.diceRoll1):fu.play(Ze.diceRoll2))})}onStoreRemoved(){super.onStoreRemoved(),Fe.unregister(this)}play(t){fu.play(t)}static play(t){let e="";e="string"==typeof t?t:t.identifier,fu._play(e)}static _play(t){Fe.call("SOUND_EFFECT",t)}};var nf;dt=fu=B([Xn("sound-effect")],dt);let yn=nf=class extends zn{constructor(){super(...arguments),this.imageIdentifier="",this.tag="",this.hide=!1}get words(){return(null==this.tag||""==this.tag.trim())&&(this.tag=""),""===this.tag.trim()?[]:(this.tag=et.toHalfWidth(this.tag).toLowerCase(),this.tag.trim().split(/\s+/))}containsWords(t,e=!0){if("string"==typeof t&&(t=t.trim().split(/\s+/)),0==t.length)return!1;if(t=t.concat(),e){for(const i of t)if(` ${this.tag} `.indexOf(` ${et.toHalfWidth(i).toLowerCase()} `)>=0)return!0;return!1}for(const i of t)if(` ${this.tag} `.indexOf(` ${et.toHalfWidth(i).toLowerCase()} `)<0)return!1;return!0}addWords(t){"string"==typeof t&&(t=t.trim().split(/\s+/)),t=t.concat();const e=Array.from(new Set(t.map(i=>et.toHalfWidth(i).toLowerCase())));return this.tag=Array.from(new Set(e.concat(this.words))).sort().join(" "),Fe.call("OPERATE_IMAGE_TAGS",this.identifier),e}removeWords(t){"string"==typeof t&&(t=t.trim().split(/\s+/)),t=t.concat();const e=Array.from(new Set(t.map(i=>et.toHalfWidth(i).toLowerCase())));return this.tag=this.words.filter(i=>!e.includes(et.toHalfWidth(i).toLowerCase())).sort().join(" "),Fe.call("OPERATE_IMAGE_TAGS",this.identifier),e}static get(t){return lt.instance.get(`imagetag_${t}`)}static create(t){const e=new nf(`imagetag_${t}`);return e.imageIdentifier=t,e.initialize(),e}parseInnerXml(t){let e=nf.get(this.imageIdentifier);e||(e=nf.create(this.imageIdentifier));const i=e.toContext();i.syncData=this.toContext().syncData,e.apply(i),e.update(),this.destroy()}};var Gl;B([rt()],yn.prototype,"imageIdentifier",void 0),B([rt()],yn.prototype,"tag",void 0),B([rt()],yn.prototype,"hide",void 0),yn=nf=B([Xn("image-tag")],yn);let wr=Gl=class extends zn{constructor(){super(...arguments),this.identifiers=[]}static searchImages(t,e,i,r){"string"==typeof t&&(t=t.trim().split(/\s+/));const s=Gl.allImagesOwnWords(r);return t=t.filter(c=>s.includes(c)),this.allImages(r).filter(c=>{const m=yn.get(c.identifier);return e&&(i||0===t.length)&&(!m||null==m.tag||""===m.tag.trim())||(!e||i)&&m&&m.containsWords(t,i)})}static allImages(t){return kt.instance.images.filter(i=>{if(t)return!0;const r=yn.get(i.identifier);return!r||!r.hide})}static allImagesOwnWords(t){return Gl.imagesOwnWords(this.allImages(t))}static imagesOwnWords(t,e=!1){if(e){if(0===t.length)return[];const i=t.map(s=>yn.get(s.identifier));if(!i[0])return[];let r=i[0].words;for(let s=1;s<i.length;s++){if(!i[s])return[];if(r=r.filter(o=>i[s].words.includes(o)),0===r.length)return r}return r.sort()}{const i=[];for(const r of t){const s=yn.get(r.identifier);s&&i.push(...s.words)}return Array.from(new Set(i)).sort()}}static countAllImagesHasWord(t,e){let i=0;if(null!=t&&""===t.trim())return i;for(const r of Gl.allImages(e)){const s=yn.get(r.identifier);null==t?(!s||null==s.tag||""==s.tag.trim())&&i++:s&&s.containsWords(t.trim(),!1)&&i++}return i}static imagesIsHidden(t){for(const e of t){const i=yn.get(e.identifier);if(!i||!i.hide)return!1}return!0}static sortImagesByWords(t,e){const i=t.map(r=>{const s=yn.get(r.identifier);return{image:r,tag:s&&null!=s.tag?s.tag:""}});return i.sort((r,s)=>{let o=0;return e.some(c=>(o=Gl._sortByWordCriteria(r,s,c),!!o)),o}),i.map(r=>r.image)}static _sortByWordCriteria(t,e,i){if(null==i)return""==t.tag&&""==e.tag?0:""==t.tag?-1:""==e.tag?1:0;const r=` ${t.tag} `.indexOf(` ${i} `),s=` ${e.tag} `.indexOf(` ${i} `);return-1==r&&-1==s?0:r>=0&&-1==s?-1:-1==r&&s>=0?1:0}onStoreAdded(){super.onStoreAdded(),lt.instance.remove(this)}innerXml(){return Array.from(new Set(this.identifiers)).map(t=>yn.get(t)).filter(t=>t).map(t=>t.toXml()).join("")}static create(t){const e=new Gl;return e.identifiers=t.map(i=>i.identifier),e}};wr=Gl=B([Xn("image-tag-list")],wr);var ql,MT=X(4327),kT=X(5650);!function(n){const t={avif:"image/avif",gif:"image/gif",jpg:"image/jpeg",jpeg:"image/jpeg",jpe:"image/jpeg",jfif:"image/jpeg",pjpeg:"image/jpeg",pjp:"image/jpeg",png:"image/png",apng:"image/apng",webp:"image/webp",svg:"image/svg+xml",svgz:"image/svg+xml",ico:"image/x-icon",cur:"image/x-icon",bmp:"image/bmp",html:"text/html",htm:"text/html",shtml:"text/html",xml:"text/xml",yml:"text/yaml",yaml:"text/yaml",json:"application/json",map:"application/json",zip:"application/zip",mp3:"audio/mp3",wav:"audio/wav",m4a:"audio/aac",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",mp4:"video/mp4",webm:"video/webm"};n.type=function e(r){let s=r.replace(/.*[\.\/\\]/,"").toLowerCase();return t[s]?t[s]:""},n.extension=function i(r){for(let s in t)if(t[s]===r)return s;return r.split("/")[1]}}(ql||(ql={}));class Bo{constructor(){this.maxImageSize=2097152,this.maxAudioeSize=10485760,console.log("FileArchiver ready...")}static get instance(){return Bo._instance||(Bo._instance=new Bo),Bo._instance}initialize(){this.destroy(),this.addEventListeners()}destroy(){this.removeEventListeners()}addEventListeners(){this.removeEventListeners(),this.callbackOnDragEnter=t=>this.onDragEnter(t),this.callbackOnDragOver=t=>this.onDragOver(t),this.callbackOnDrop=t=>this.onDrop(t),document.body.addEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.addEventListener("dragover",this.callbackOnDragOver,!1),document.body.addEventListener("drop",this.callbackOnDrop,!1)}removeEventListeners(){document.body.removeEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.removeEventListener("dragover",this.callbackOnDragOver,!1),document.body.removeEventListener("drop",this.callbackOnDrop,!1),this.callbackOnDragEnter=null,this.callbackOnDragOver=null,this.callbackOnDrop=null}onDragEnter(t){t.preventDefault()}onDragOver(t){t.preventDefault()}onDrop(t){t.preventDefault(),console.log("onDrop",t.dataTransfer),this.load(t.dataTransfer.files)}load(t){var e=this;return(0,en.Z)(function*(){if(!t)return;let i=t instanceof FileList?AT(t):t;for(let r of i)yield e.handleImage(r),yield e.handleAudio(r),yield e.handleText(r),yield e.handleZip(r),Fe.trigger("FILE_LOADED",{file:r})})()}handleImage(t){var e=this;return(0,en.Z)(function*(){if(!(t.type.indexOf("image/")<0)){if(e.maxImageSize<t.size)return void console.warn(`File size limit exceeded. -> ${t.name} (${(t.size/1024/1024).toFixed(2)}MB)`);console.log(t.name+" type:"+t.type),yield kt.instance.addAsync(t)}})()}handleAudio(t){var e=this;return(0,en.Z)(function*(){if(!(t.type.indexOf("audio/")<0)){if(e.maxAudioeSize<t.size)return void console.warn(`File size limit exceeded. -> ${t.name} (${(t.size/1024/1024).toFixed(2)}MB)`);console.log(t.name+" type:"+t.type),yield Lt.instance.addAsync(t)}})()}handleText(t){return(0,en.Z)(function*(){if(!(t.type.indexOf("text/")<0)){console.log(t.name+" type:"+t.type);try{let e=ca.xml2element(yield uo.readAsTextAsync(t));e&&Fe.trigger("XML_LOADED",{xmlElement:e})}catch(e){console.warn(e)}}})()}handleZip(t){var e=this;return(0,en.Z)(function*(){if(!(0<=t.type.indexOf("application/")||t.type.length<1))return;let i=new kT;try{i=yield i.loadAsync(t)}catch(s){return void console.warn(s)}let r=[];i.forEach((s,o)=>r.push(o));for(let s of r)try{let o=yield s.async("arraybuffer");console.log(s.name+" \u89e3\u51cd..."),yield e.load([new File([o],s.name,{type:ql.type(s.name)})])}catch(o){console.warn(o)}})()}saveAsync(t,e,i){return(0,en.Z)(function*(){if(!t)return;let r=t instanceof FileList?AT(t):t,s=new kT;for(let c of r)s.file(c.name,c);let o=yield s.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}},i);(0,MT.saveAs)(o,e+".zip")})()}}function AT(n){let t=[],e=n.length;for(let i=0;i<e;i++)t.push(n[i]);return t}function vz(n,t){if(1&n&&(K(0,"i",6),be(1),J()),2&n){const e=ge();U(1),qe(e.materialIcon)}}function bz(n,t){if(1&n&&(K(0,"div",7),be(1),J()),2&n){const e=ge();U(1),qe(e.help)}}function yz(n,t){1&n&&(it(0,"div",8),Ct(1,"safe")),2&n&&te("innerHTML",xt(1,1,ge().helpHtml,"html"),qi)}function Cz(n,t){if(1&n){const e=Xe();K(0,"button",9),Te("click",function(){return De(e),ge().cancel()}),be(1,"\u30ad\u30e3\u30f3\u30bb\u30eb"),J()}}let Qi=(()=>{class n{constructor(e,i){this.panelService=e,this.modalService=i,this.title="",this.subTitle="",this.text="",this.help="",this.helpHtml="",this.materialIcon="",this.type=Ci.OK,this.action=null,this.cancelAction=null,this.title=i.option.title?i.option.title:"",this.subTitle=i.option.subTitle?i.option.subTitle:"",this.text=i.option.text?i.option.text:"",this.help=i.option.help?i.option.help:"",this.helpHtml=i.option.helpHtml?i.option.helpHtml:"",this.materialIcon=i.option.materialIcon?i.option.materialIcon:"",this.type=i.option.type?i.option.type:Ci.OK,this.action=i.option.action?i.option.action:null,this.cancelAction=i.option.cancelAction?i.option.cancelAction:null}ngOnInit(){Promise.resolve().then(()=>{let e="\u78ba\u8a8d";this.title?e+="\u3008"+this.title+(this.subTitle?`\uff1a${this.subTitle}`:"")+"\u3009":this.subTitle&&(e+=`\u3008${this.subTitle}\u3009`),this.modalService.title=this.panelService.title=e}),Fe.register(this)}ngOnDestroy(){Fe.unregister(this)}ok(){this.modalService.resolve(!0),this.action&&this.action()}cancel(){this.modalService.resolve(!1),this.cancelAction&&this.cancelAction()}}return n.\u0275fac=function(e){return new(e||n)(Le(In),Le(kn))},n.\u0275cmp=Zt({type:n,selectors:[["app-confirmation"]],decls:9,vars:5,consts:[[1,"text"],["class","material-icons icon",4,"ngIf"],["class","help",4,"ngIf"],["class","help",3,"innerHTML",4,"ngIf"],["type","submit",3,"click"],["type","button",3,"click",4,"ngIf"],[1,"material-icons","icon"],[1,"help"],[1,"help",3,"innerHTML"],["type","button",3,"click"]],template:function(e,i){1&e&&(K(0,"div",0),xe(1,vz,2,1,"i",1),be(2),J(),it(3,"hr"),xe(4,bz,2,1,"div",2),xe(5,yz,2,4,"div",3),K(6,"button",4),Te("click",function(){return i.ok()}),be(7,"\uff2f\uff2b"),J(),xe(8,Cz,2,0,"button",5)),2&e&&(U(1),te("ngIf",i.materialIcon),U(1),qe(i.text),U(2),te("ngIf",i.help&&!i.helpHtml),U(1),te("ngIf",i.helpHtml),U(3),te("ngIf",i.type>1))},directives:[_n],pipes:[ti],styles:[".text[_ngcontent-%COMP%]{font-weight:bolder;white-space:pre-wrap;word-break:break-all}.icon[_ngcontent-%COMP%]{display:inline-block;font-size:2.5rem;vertical-align:middle;margin-right:4px;padding:2px;text-shadow:2px 2px 2px #555}.help[_ngcontent-%COMP%]{font-size:smaller;white-space:pre-wrap;word-break:break-all;margin-bottom:3px}"]}),n})();var Ci=(()=>(function(n){n[n.OK=1]="OK",n[n.OK_CANCEL=2]="OK_CANCEL"}(Ci||(Ci={})),Ci))();function xz(n,t){1&n&&it(0,"badge",12),2&n&&te("count",ge(2).countImagesHasWord(null))("@.disabled",!0)}function wz(n,t){if(1&n){const e=Xe();K(0,"label")(1,"input",25),Te("ngModelChange",function(r){return De(e),ge().searchNoTagImage=r})("change",function(){De(e);const r=ge();return r.searchNoTagImage=!!r.searchNoTagImage}),J(),K(2,"div",26)(3,"s"),be(4,"No Tag"),J(),xe(5,xz,1,2,"badge",27),J()()}if(2&n){const e=ge();U(1),ct("checked",e.searchNoTagImage?"checked":""),te("ngModel",e.searchNoTagImage),U(4),te("ngIf",e.countImagesHasWord(null)>0)}}function Ez(n,t){if(1&n&&it(0,"badge",12),2&n){const e=ge().$implicit;te("count",ge().countImagesHasWord(e))("@.disabled",!0)}}function Tz(n,t){if(1&n){const e=Xe();K(0,"label")(1,"input",28),Te("change",function(){const s=De(e).$implicit;return ge().onSelectedWord(s)}),J(),K(2,"div"),be(3),xe(4,Ez,1,2,"badge",27),J()()}if(2&n){const e=t.$implicit,i=ge();U(1),ct("value",e),te("checked",i.searchWords.includes(e)),U(2),qe(e),U(1),te("ngIf",i.countImagesHasWord(e)>0)}}function Iz(n,t){1&n&&pn(0)}function Sz(n,t){if(1&n&&(K(0,"label",40),be(1),J()),2&n){const e=ge().$implicit;U(1),qe(e)}}function Mz(n,t){1&n&&(K(0,"span",41),be(1,"\u2026"),J())}function kz(n,t){if(1&n&&(Ve(0),xe(1,Sz,2,1,"label",38),xe(2,Mz,2,0,"span",39),Ge()),2&n){const e=t.index;U(1),te("ngIf",e<6),U(1),te("ngIf",6==e)}}function Dz(n,t){if(1&n&&(K(0,"div",37),xe(1,kz,3,2,"ng-container",14),J()),2&n){const e=ge().$implicit,i=ge();U(1),te("ngForOf",i.getTagWords(e))}}function Az(n,t){1&n&&(K(0,"div",37)(1,"s",42),be(2,"No Tag"),J()())}function Pz(n,t){1&n&&(K(0,"div",43)(1,"i",44),be(2,"visibility"),J()())}function Nz(n,t){if(1&n){const e=Xe();K(0,"img",45),Te("click",function(){De(e);const r=ge().$implicit;return ge().onSelectedFile(r)}),Ct(1,"safe"),J()}if(2&n){const e=ge().$implicit;te("src",xt(1,2,e.url,"resourceUrl"),Jt)("alt",e.name)}}function Fz(n,t){1&n&&it(0,"img",46),2&n&&ct("alt",ge().$implicit.name)}const Oz=function(n){return{selected:n}};function Rz(n,t){if(1&n&&(K(0,"div",29)(1,"div",30),xe(2,Iz,1,0,"ng-container",31),xe(3,Dz,2,1,"ng-template",null,32,Ln),xe(5,Az,3,0,"ng-template",null,33,Ln),J(),xe(7,Pz,3,0,"div",34),xe(8,Nz,2,5,"img",35),xe(9,Fz,1,1,"img",36),J()),2&n){const e=t.$implicit,i=Wt(4),r=Wt(6),s=ge();te("@scaleInOut",void 0)("ngClass",ut(8,Oz,s.selected(e))),U(2),te("ngIf",s.getTagWords(e).length>0)("ngIfThen",i)("ngIfElse",r),U(5),te("ngIf",s.getHidden(e)),U(1),te("ngIf",0<e.url.length),U(1),te("ngIf",e.url.length<=0)}}function Bz(n,t){if(1&n){const e=Xe();K(0,"label",56),Te("click",function(){const s=De(e).$implicit;return ge(3).removeTagWord(s)}),be(1),K(2,"sup",57),be(3,"\xd7"),J()()}if(2&n){const e=t.$implicit;U(1),qe(e)}}function Lz(n,t){if(1&n&&(Ve(0),xe(1,Bz,4,1,"label",55),Ge()),2&n){const e=ge(2);U(1),te("ngForOf",e.selectedImagesOwnWords())}}function zz(n,t){1&n&&(Ve(0),K(1,"span",58)(2,"s"),be(3,"No Tag"),J()(),Ge())}function jz(n,t){if(1&n&&(K(0,"option",59),be(1),J()),2&n){const e=t.$implicit;ct("value",e),U(1),qe(e)}}const PT=function(n){return{"red-eye":n}};function Hz(n,t){if(1&n){const e=Xe();K(0,"div",47)(1,"div")(2,"div",48)(3,"button",49),Te("click",function(){De(e);const r=ge();return r.setectedImagesToHidden(!r.selectedImagesIsHidden)}),K(4,"i",8),be(5),J()()(),K(6,"button",50),Te("click",function(){return De(e),ge().onUnselect()}),be(7),J(),K(8,"input",51),Te("ngModelChange",function(r){return De(e),ge().addingTagWord=r}),J(),K(9,"button",52),Te("click",function(){return De(e),ge().addTagWord()}),be(10,"\u30bf\u30b0\u8ffd\u52a0 \u27a1"),J(),xe(11,Lz,2,1,"ng-container",13),xe(12,zz,4,0,"ng-container",13),J(),K(13,"datalist",53),xe(14,jz,2,2,"option",54),J()()}if(2&n){const e=ge();te("@fadeAndUpInOut",void 0),U(3),Rt("title",e.selectedImagesIsHidden?"\u9078\u629e\u753b\u50cf\u3092\u8868\u793a\u8a2d\u5b9a\u306b\u3059\u308b":"\u9078\u629e\u753b\u50cf\u3092\u975e\u8868\u793a\u8a2d\u5b9a\u306b\u3059\u308b"),U(1),te("ngClass",ut(12,PT,e.selectedImagesIsHidden)),U(1),qe(e.selectedImagesIsHidden?"visibility":"visibility_off"),U(2),An("\u9078\u629e\u89e3\u9664 (",e.selectedImageFiles.length," \u9078\u629e\u4e2d)"),U(1),l_("list","",e.panelId,"_suggest"),te("ngModel",e.addingTagWord),U(1),te("disabled",null==e.addingTagWord||""===e.addingTagWord.trim()),U(2),te("ngIf",e.selectedImagesOwnWords().length>0),U(1),te("ngIf",0==e.selectedImagesOwnWords().length),U(1),Wi("id","",e.panelId,"_suggest"),U(1),te("ngForOf",e.suggestWords())}}const Uz=function(n){return{selecter:n}};let js=(()=>{class n{constructor(e,i,r){this.changeDetector=e,this.panelService=i,this.modalService=r,this._searchNoTagImage=!0,this.serchCondIsOr=!0,this.addingTagWord="",this.searchWords=[],this.deletedWords=[],this.selectedImageFiles=[],this.isSort=!0,this.isShowHideImages=!1}get images(){const e=wr.searchImages(this.searchWords,this.searchNoTagImage&&this.countAllImagesHasWord(null)>0,this.serchCondIsOr,this.isShowHideImages),i=e.map(r=>r.identifier);return this.selectedImageFiles=this.selectedImageFiles.filter(r=>i.includes(r.identifier)),this.isSort?wr.sortImagesByWords(e,n.sortOrder):e}get searchNoTagImage(){return this._searchNoTagImage}set searchNoTagImage(e){e?n.sortOrder.unshift(null):n.sortOrder=n.sortOrder.filter(i=>null!=i),n.sortOrder=Array.from(new Set(n.sortOrder)),this._searchNoTagImage=e,Fe.trigger("CHANGE_SORT_ORDER",null)}get searchAllImage(){if(!this.searchNoTagImage&&this.countAllImagesHasWord(null)>0)return!1;for(const e of this.allImagesOwnWords)if(!this.searchWords.includes(e))return!1;return!0}get isSelected(){let e=this.selectedImageFiles.length>0;return e||(this.addingTagWord=""),e}get selectedImagesIsHidden(){return wr.imagesIsHidden(this.selectedImageFiles)}get allImagesOwnWords(){return wr.allImagesOwnWords(this.isShowHideImages)}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7"),this.searchWords=this.allImagesOwnWords,this.panelId=ns.generateUuid()}ngAfterViewInit(){Fe.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("OPERATE_IMAGE_TAGS",e=>{this.changeDetector.markForCheck()}).on("CHANGE_SORT_ORDER",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){Fe.unregister(this)}allImages(){return wr.allImages(this.isShowHideImages)}countAllImagesHasWord(e){return wr.countAllImagesHasWord(e,this.isShowHideImages)}countImagesHasWord(e){let i=0;if(null!=e&&""===e.trim())return i;for(const r of this.images){const s=yn.get(r.identifier);null==e?(!s||null==s.tag||""==s.tag.trim())&&i++:s&&s.containsWords(e.trim(),!1)&&i++}return i}handleFileSelect(e){let i=e.target,r=i.files;r.length&&Bo.instance.load(r),i.value=""}selected(e){return this.selectedImageFiles.map(i=>i.identifier).includes(e.identifier)}selectedImagesOwnWords(e=!1){return wr.imagesOwnWords(this.selectedImageFiles,e)}onSelectedWord(e){null==e||""===e.trim()||(this.searchWords.includes(e)?(this.searchWords=this.searchWords.filter(i=>e!==i),n.sortOrder=n.sortOrder.filter(i=>e!==i)):(this.searchWords.push(e),n.sortOrder.unshift(e)),n.sortOrder=Array.from(new Set(n.sortOrder)),Fe.trigger("CHANGE_SORT_ORDER",e))}onSelectedFile(e){this.selected(e)?this.selectedImageFiles=this.selectedImageFiles.filter(i=>i.identifier!==e.identifier):this.selectedImageFiles.push(e)}getTagWords(e){const i=yn.get(e.identifier);return i?i.words:[]}getHidden(e){const i=yn.get(e.identifier);return!!i&&i.hide}onSearchAllImage(){this.searchAllImage?(this.searchWords=[],this._searchNoTagImage=!1):(this.searchWords=this.allImagesOwnWords,this._searchNoTagImage=!0)}onUnselect(){this.selectedImageFiles=[]}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(Qi,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:Ci.OK_CANCEL,materialIcon:"visibility",action:()=>{this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}setectedImagesToHidden(e){this.modalService.open(Qi,{title:e?"\u975e\u8868\u793a\u306b\u8a2d\u5b9a":"\u975e\u8868\u793a\u8a2d\u5b9a\u3092\u89e3\u9664",text:`\u753b\u50cf${e?"\u3092\u975e\u8868\u793a\u306b\u8a2d\u5b9a":"\u306e\u975e\u8868\u793a\u8a2d\u5b9a\u3092\u89e3\u9664"}\u3057\u307e\u3059\u304b\uff1f`,help:e?"\u9078\u629e\u3057\u305f\u753b\u50cf\u3092\u975e\u8868\u793a\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u3053\u308c\u306f\u300c\u610f\u56f3\u305b\u305a\u306b\u30cd\u30bf\u30d0\u30ec\u3092\u898b\u3066\u3057\u307e\u3046\u300d\u3053\u3068\u306a\u3069\u3092\u9632\u3050\u3082\u306e\u3067\u3042\u308a\u3001\u4ed6\u8005\u304b\u3089\u5b8c\u5168\u306b\u96a0\u3059\u3082\u306e\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002":"\u9078\u629e\u3057\u305f\u753b\u50cf\u306e\u975e\u8868\u793a\u8a2d\u5b9a\u3092\u89e3\u9664\u3057\u307e\u3059\u3002",type:Ci.OK_CANCEL,materialIcon:e?"visibility_off":"visibility",action:()=>{for(const i of this.selectedImageFiles){const r=yn.get(i.identifier)||yn.create(i.identifier);r.hide=e,Fe.call("OPERATE_IMAGE_TAGS",r.identifier)}}})}addTagWord(){if(null==this.addingTagWord||""==this.addingTagWord.trim())return;const e=this.addingTagWord.trim().split(/\s+/);this.modalService.open(Qi,{title:"\u753b\u50cf\u306b\u30bf\u30b0\u3092\u8ffd\u52a0",text:"\u753b\u50cf\u306b\u30bf\u30b0\u3092\u8ffd\u52a0\u3057\u307e\u3059\u304b\uff1f",helpHtml:"\u9078\u629e\u3057\u305f\u753b\u50cf\u306b "+e.map(i=>`<b class="word-tag">${et.escapeHtml(i)}</b>`).join(" ")+" \u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002",type:Ci.OK_CANCEL,materialIcon:"sell",action:()=>{let i=null;for(const r of this.selectedImageFiles)i=(yn.get(r.identifier)||yn.create(r.identifier)).addWords(e);i&&(this.serchCondIsOr&&this.searchWords.push(...i),n.sortOrder.unshift(...i)),this.serchCondIsOr&&(this.searchWords=Array.from(new Set(this.searchWords)).sort()),n.sortOrder=Array.from(new Set(n.sortOrder)),Fe.trigger("CHANGE_SORT_ORDER",i),this.addingTagWord=""}})}removeTagWord(e){this.modalService.open(Qi,{title:"\u753b\u50cf\u304b\u3089\u30bf\u30b0\u3092\u524a\u9664",text:"\u753b\u50cf\u304b\u3089\u30bf\u30b0\u3092\u524a\u9664\u3057\u307e\u3059\u304b\uff1f",helpHtml:`\u9078\u629e\u3057\u305f\u753b\u50cf\u304b\u3089 <b class="word-tag">${et.escapeHtml(e)}</b> \u3092\u524a\u9664\u3057\u307e\u3059\u3002`,type:Ci.OK_CANCEL,materialIcon:"sell",action:()=>{if(null==e||""==e.trim())return;for(const r of this.selectedImageFiles){let s=yn.get(r.identifier);s&&s.removeWords(e)}const i=this.allImagesOwnWords;this.searchWords=this.searchWords.filter(r=>i.includes(r)),this.deletedWords.push(e),this.deletedWords=Array.from(new Set(this.deletedWords)),Fe.trigger("CHANGE_SORT_ORDER",this.deletedWords)}})}identify(e,i){return i.identifier}suggestWords(){const e=this.selectedImagesOwnWords(!0);return Array.from(new Set(this.allImagesOwnWords.concat(this.deletedWords))).filter(i=>0!==i.indexOf("*")&&!e.includes(i))}}return n.sortOrder=[],n.\u0275fac=function(e){return new(e||n)(Le(Di),Le(In),Le(kn))},n.\u0275cmp=Zt({type:n,selectors:[["file-storage"]],decls:41,vars:19,consts:[[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","image/*",2,"display","none",3,"change"],[1,"sticky-top"],[2,"float","right","margin-top","3px","margin-right","3px"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[1,"word-selecter"],["name","word-selecter","type","checkbox","value","ALL",3,"checked","click"],[1,"all-tags"],[1,"badge",3,"count"],[4,"ngIf"],[4,"ngFor","ngForOf"],[2,"white-space","nowrap"],[2,"margin-left","3px",3,"ngModel","ngModelChange"],["value","true"],["value",""],["sytle","white-space: nowrap","title","\u6700\u8fd1\u4f7f\u3063\u305f\u30bf\u30b0\u306e\u753b\u50cf\u3092\u524d\u306b"],["name","is-sort","value","Sort","type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"font-size","smaller","margin-right","3px"],["id","file-list",2,"padding-top","3px",3,"ngClass"],["class","image","style","text-align: center; min-width: 100px; height: 120px; position: relative;",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["class","sticky-bottom",4,"ngIf"],["name","word-selecter","type","checkbox","value","No Tag",3,"ngModel","checked","ngModelChange","change"],[1,"no-tag"],["class","badge",3,"count",4,"ngIf"],["name","word-selecter","type","checkbox",3,"value","checked","change"],[1,"image",2,"text-align","center","min-width","100px","height","120px","position","relative",3,"ngClass"],[2,"position","absolute","font-size","xx-small","text-align","left","bottom","0px","width","100%","height","100%","overflow","hidden","pointer-events","none"],[4,"ngIf","ngIfThen","ngIfElse"],["tagsBlock",""],["noTagBlock",""],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["height","120",3,"src","alt","click",4,"ngIf"],["src","assets/images/loading.gif",3,"alt",4,"ngIf"],[2,"position","absolute","bottom","0px","z-index","5"],["class","word-tag grow","style","display: block; width: 88px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],["class","grow","style","display: block; width: 88px; overflow: hidden; padding-left: 2px; font-weight: bold; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],[1,"word-tag","grow",2,"display","block","width","88px","overflow","hidden","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"display","block","width","88px","overflow","hidden","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"color","gray","display","block","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons","red-eye",2,"margin-right","2px","font-size","16px","display","block"],["height","120",3,"src","alt","click"],["src","assets/images/loading.gif",3,"alt"],[1,"sticky-bottom"],[2,"margin-left","3px","float","right"],[2,"padding","2px 0.5em",3,"click"],[2,"font-size","x-small","margin-right","2em",3,"click"],["type","text","placeholder","\u30b9\u30da\u30fc\u30b9 \u533a\u5207\u308a\u3067 \u8907\u6570\u53ef\u80fd",2,"width","14em",3,"ngModel","ngModelChange"],[2,"font-size","x-small",3,"disabled","click"],[3,"id"],[3,"value",4,"ngFor","ngForOf"],["class","word-tag","style","cursor: pointer; font-size: smaller",3,"click",4,"ngFor","ngForOf"],[1,"word-tag",2,"cursor","pointer","font-size","smaller",3,"click"],[2,"font-size","xx-small","color","red"],[2,"font-size","smaller","font-weight","bolder","margin-left","3px","color","gray"],[3,"value"]],template:function(e,i){1&e&&(K(0,"label")(1,"div",0)(2,"div")(3,"i",1),be(4,"add_photo_alternate"),J()(),K(5,"div"),be(6,"\u3053\u3053\u306b\u753b\u50cf\u3092\u30c9\u30ed\u30c3\u30d7"),J(),K(7,"div",2),be(8,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),J(),K(9,"input",3),Te("change",function(s){return i.handleFileSelect(s)}),J(),K(10,"div",2),it(11,"br"),be(12,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d2MB\u307e\u3067"),J()()(),K(13,"div",4)(14,"div",5)(15,"label",6)(16,"input",7),Te("click",function(s){return i.onShowHiddenImages(s)}),J(),K(17,"i",8),be(18),J()()(),K(19,"span",9)(20,"label")(21,"input",10),Te("click",function(){return i.onSearchAllImage()}),J(),K(22,"div",11)(23,"b"),be(24,"ALL"),J(),it(25,"badge",12),J()(),xe(26,wz,6,3,"label",13),xe(27,Tz,5,4,"label",14),J(),K(28,"span",15)(29,"select",16),Te("ngModelChange",function(s){return i.serchCondIsOr=s}),K(30,"option",17),be(31,"\u3044\u305a\u308c\u304b (OR)"),J(),K(32,"option",18),be(33,"\u3059\u3079\u3066 (AND)"),J()(),K(34,"label",19)(35,"input",20),Te("ngModelChange",function(s){return i.isSort=s})("change",function(){return i.isSort=!!i.isSort}),J(),K(36,"b",21),be(37,"\u30bd\u30fc\u30c8"),J()()()(),K(38,"div",22),xe(39,Rz,10,10,"div",23),J(),xe(40,Hz,15,14,"div",24)),2&e&&(U(16),ct("checked",i.isShowHideImages?"checked":""),U(1),te("ngClass",ut(15,PT,i.isShowHideImages)),U(1),qe(i.isShowHideImages?"visibility":"visibility_off"),U(3),ct("checked",i.searchAllImage?"checked":""),U(4),te("count",i.images.length)("@.disabled",!0),U(1),te("ngIf",i.countAllImagesHasWord(null)>0),U(1),te("ngForOf",i.allImagesOwnWords),U(2),te("ngModel",i.serchCondIsOr),U(6),ct("checked",i.isSort?"checked":""),te("ngModel",i.isSort),U(3),te("ngClass",ut(17,Uz,i.isSelected)),U(1),te("ngForOf",i.images)("ngForTrackBy",i.identify),U(1),te("ngIf",i.isSelected))},directives:[Wn,Nd,_n,Jr,hi,oi,ei,es,zr,jr,fi],pipes:[ti],styles:['[_nghost-%COMP%]{display:block}.drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.image[_ngcontent-%COMP%]{font-size:0;display:inline-block;border:2px solid transparent;margin-right:-2px;cursor:pointer}.image[_ngcontent-%COMP%]:hover{border:2px dotted red;transform:scale(1.08);z-index:150;transition-duration:60ms}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom;transition-duration:.12s}.image.selected[_ngcontent-%COMP%]{border:2px solid red}.selecter[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]:not(.selected)   img[_ngcontent-%COMP%]{filter:saturate(40%) opacity(90%) blur(2px)}.image[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(1px);backdrop-filter:blur(1px);filter:none!important}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.sticky-top[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;top:0;background-color:#f0dabde6;border-bottom:1px dotted #666;z-index:100}.sticky-bottom[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;bottom:0;background-color:#f0dabde6;border-top:1px dotted #666;z-index:200}.word-tag[_ngcontent-%COMP%]{margin-right:3px;display:inline-block;color:#000;font-weight:bolder}.word-tag[_ngcontent-%COMP%]:hover{color:red}.word-selecter[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.word-selecter[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{display:none}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div.all-tags[_ngcontent-%COMP%]{background-color:#eee;color:#008b8b}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}'],data:{animation:[xn("scaleInOut",[Bt("void => *",[Ft("200ms ease",nn([Ye({transform:"scale3d(0, 0, 0)",offset:0}),Ye({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Bt("* => void",[Ft("180ms ease",Ye({transform:"scale3d(0, 0, 0)"}))])]),xn("fadeAndUpInOut",[Bt("void => *",[Ft("100ms ease-in-out",nn([Ye({"transform-origin":"center bottom",transform:"translateY(8px) scaleY(0)",opacity:.6}),Ye({"transform-origin":"center bottom",transform:"translateY(0px) scaleY(1.0)",opacity:1})]))]),Bt("* => void",[Ft("100ms ease-in-out",Ye({"transform-origin":"center bottom",transform:"translateY(0px) scaleY(1.0)",opacity:1})),Ft("100ms ease-in-out",Ye({"transform-origin":"center bottom",transform:"translateY(8px) scaleY(0)",opacity:.6}))])])]},changeDetection:0}),n})();function Vz(n,t){1&n&&it(0,"badge",8),2&n&&te("count",ge(2).countImagesHasWord(null))("@.disabled",!0)}function Gz(n,t){if(1&n){const e=Xe();K(0,"label")(1,"input",21),Te("ngModelChange",function(r){return De(e),ge().searchNoTagImage=r})("change",function(){De(e);const r=ge();return r.searchNoTagImage=!!r.searchNoTagImage}),J(),K(2,"div",22)(3,"s"),be(4,"No Tag"),J(),xe(5,Vz,1,2,"badge",23),J()()}if(2&n){const e=ge();U(1),ct("checked",e.searchNoTagImage?"checked":""),te("ngModel",e.searchNoTagImage),U(4),te("ngIf",e.countImagesHasWord(null)>0)}}function qz(n,t){if(1&n&&it(0,"badge",8),2&n){const e=ge().$implicit;te("count",ge().countImagesHasWord(e))("@.disabled",!0)}}function Wz(n,t){if(1&n){const e=Xe();K(0,"label")(1,"input",24),Te("change",function(){const s=De(e).$implicit;return ge().onSelectedWord(s)}),J(),K(2,"div"),be(3),xe(4,qz,1,2,"badge",23),J()()}if(2&n){const e=t.$implicit,i=ge();U(1),ct("value",e),te("checked",i.searchWords.includes(e)),U(2),qe(e),U(1),te("ngIf",i.countImagesHasWord(e)>0)}}function Kz(n,t){if(1&n){const e=Xe();K(0,"span",25)(1,"button",26),Te("click",function(){De(e);const r=ge();return r.onSelectedFile(r.empty)}),be(2,"\u753b\u50cf\u306a\u3057"),it(3,"br"),be(4,"/\u8a2d\u5b9a\u89e3\u9664"),J()()}}function Yz(n,t){1&n&&pn(0)}function Zz(n,t){if(1&n&&(K(0,"label",39),be(1),J()),2&n){const e=ge().$implicit;U(1),qe(e)}}function Xz(n,t){1&n&&(K(0,"span",40),be(1,"\u2026"),J())}function Qz(n,t){if(1&n&&(Ve(0),xe(1,Zz,2,1,"label",37),xe(2,Xz,2,0,"span",38),Ge()),2&n){const e=t.index;U(1),te("ngIf",e<6),U(1),te("ngIf",6==e)}}function Jz(n,t){if(1&n&&(K(0,"div",36),xe(1,Qz,3,2,"ng-container",10),J()),2&n){const e=ge().$implicit,i=ge();U(1),te("ngForOf",i.getTagWords(e))}}function ej(n,t){1&n&&(K(0,"div",36)(1,"s",41),be(2,"No Tag"),J()())}function tj(n,t){1&n&&(K(0,"div",42)(1,"i",43),be(2,"visibility"),J()())}function nj(n,t){1&n&&(K(0,"div",44)(1,"b",45),be(2,"\u8a2d\u5b9a\u4e2d"),J()())}function ij(n,t){if(1&n){const e=Xe();K(0,"img",46),Te("click",function(){De(e);const r=ge().$implicit,s=ge();return!s.getCurrent(r)&&s.onSelectedFile(r)}),Ct(1,"safe"),J()}if(2&n){const e=ge().$implicit;te("src",xt(1,2,e.url,"resourceUrl"),Jt)("alt",e.name)}}function rj(n,t){1&n&&it(0,"img",47),2&n&&ct("alt",ge().$implicit.name)}const sj=function(n){return{"current-images":n}};function oj(n,t){if(1&n&&(K(0,"div",27)(1,"div",28),xe(2,Yz,1,0,"ng-container",29),xe(3,Jz,2,1,"ng-template",null,30,Ln),xe(5,ej,3,0,"ng-template",null,31,Ln),J(),xe(7,tj,3,0,"div",32),xe(8,nj,3,0,"div",33),xe(9,ij,2,5,"img",34),xe(10,rj,1,1,"img",35),J()),2&n){const e=t.$implicit,i=Wt(4),r=Wt(6),s=ge();te("@scaleInOut",void 0)("ngClass",ut(9,sj,s.getCurrent(e))),U(2),te("ngIf",s.getTagWords(e).length>0)("ngIfThen",i)("ngIfElse",r),U(5),te("ngIf",s.getHidden(e)),U(1),te("ngIf",s.getCurrent(e)),U(1),te("ngIf",0<e.url.length),U(1),te("ngIf",e.url.length<=0)}}const aj=function(n){return{"red-eye":n}};let Lo=(()=>{class n{constructor(e,i,r){this.changeDetector=e,this.panelService=i,this.modalService=r,this.isAllowedEmpty=!1,this.currentImageIdentifires=[],this._searchNoTagImage=!0,this.serchCondIsOr=!0,this.addingTagWord="",this.searchWords=[],this.isSort=!0,this.isShowHideImages=!1,this.isAllowedEmpty=!(!this.modalService.option||!this.modalService.option.isAllowedEmpty),this.modalService.option&&this.modalService.option.currentImageIdentifires&&(this.currentImageIdentifires=this.modalService.option.currentImageIdentifires)}get images(){const e=wr.searchImages(this.searchWords,this.searchNoTagImage&&this.countAllImagesHasWord(null)>0,this.serchCondIsOr,this.isShowHideImages);return this.isSort?wr.sortImagesByWords(e,js.sortOrder).sort((i,r)=>this.getCurrent(i)?this.getCurrent(r)?0:-1:this.getCurrent(r)?1:0):e}get empty(){return Ht.Empty}get searchNoTagImage(){return this._searchNoTagImage}set searchNoTagImage(e){e?js.sortOrder.unshift(null):js.sortOrder=js.sortOrder.filter(i=>null!=i),js.sortOrder=Array.from(new Set(js.sortOrder)),this._searchNoTagImage=e,Fe.trigger("CHANGE_SORT_ORDER",null)}get searchAllImage(){if(!this.searchNoTagImage&&this.countAllImagesHasWord(null)>0)return!1;for(const e of this.allImagesOwnWords)if(!this.searchWords.includes(e))return!1;return!0}get allImagesOwnWords(){return wr.allImagesOwnWords(this.isShowHideImages)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7"),this.searchWords=this.allImagesOwnWords}ngAfterViewInit(){Fe.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("OPERATE_IMAGE_TAGS",e=>{this.changeDetector.markForCheck()}).on("CHANGE_SORT_ORDER",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){Fe.unregister(this)}allImages(){return wr.allImages(this.isShowHideImages)}countAllImagesHasWord(e){return wr.countAllImagesHasWord(e,this.isShowHideImages)}countImagesHasWord(e){let i=0;if(null!=e&&""===e.trim())return i;for(const r of this.images){const s=yn.get(r.identifier);null==e?(!s||null==s.tag||""==s.tag.trim())&&i++:s&&s.containsWords(e.trim(),!1)&&i++}return i}getTagWords(e){const i=yn.get(e.identifier);return i?i.words:[]}getHidden(e){const i=yn.get(e.identifier);return!!i&&i.hide}getCurrent(e){return!!this.currentImageIdentifires&&this.currentImageIdentifires.includes(e.identifier)}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(Qi,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:Ci.OK_CANCEL,materialIcon:"visibility",action:()=>{this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}onSelectedFile(e){this.modalService.resolve(e.identifier)}onSearchAllImage(){this.searchAllImage?(this.searchWords=[],this._searchNoTagImage=!1):(this.searchWords=this.allImagesOwnWords,this._searchNoTagImage=!0)}onSelectedWord(e){null==e||""===e.trim()||(this.searchWords.includes(e)?(this.searchWords=this.searchWords.filter(i=>e!==i),js.sortOrder=js.sortOrder.filter(i=>e!==i)):(this.searchWords.push(e),js.sortOrder.unshift(e)),js.sortOrder=Array.from(new Set(js.sortOrder)),Fe.trigger("CHANGE_SORT_ORDER",e))}cancel(){this.modalService.resolve(!1)}identify(e,i){return i.identifier}}return n.\u0275fac=function(e){return new(e||n)(Le(Di),Le(In),Le(kn))},n.\u0275cmp=Zt({type:n,selectors:[["file-selector"]],inputs:{isAllowedEmpty:"isAllowedEmpty",currentImageIdentifires:"currentImageIdentifires"},decls:28,vars:16,consts:[[1,"sticky-top"],[2,"float","right","margin-top","3px","margin-right","3px"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[1,"word-selecter"],["name","word-selecter","type","checkbox","value","ALL",3,"checked","click"],[1,"all-tags"],[1,"badge",3,"count"],[4,"ngIf"],[4,"ngFor","ngForOf"],[2,"white-space","nowrap"],[2,"margin-left","3px",3,"ngModel","ngModelChange"],["value","true"],["value",""],["sytle","white-space: nowrap","title","\u6700\u8fd1\u4f7f\u3063\u305f\u30bf\u30b0\u306e\u753b\u50cf\u3092\u524d\u306b"],["name","is-sort","value","Sort","type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"font-size","smaller","margin-right","3px"],["id","file-list",2,"min-height","250px","margin-left","1px","padding-top","3px"],["class","empty","style","display: inline-block;",4,"ngIf"],["class","image","style","text-align: center; min-width: 100px; height: 120px; position: relative",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["name","word-selecter","type","checkbox","value","No Tag",3,"ngModel","checked","ngModelChange","change"],[1,"no-tag"],["class","badge",3,"count",4,"ngIf"],["name","word-selecter","type","checkbox",3,"value","checked","change"],[1,"empty",2,"display","inline-block"],[2,"min-width","100px","margin-left","-1px","margin-right","3px",3,"click"],[1,"image",2,"text-align","center","min-width","100px","height","120px","position","relative",3,"ngClass"],[2,"position","absolute","font-size","xx-small","text-align","left","bottom","0px","width","100%","height","100%","overflow","hidden","pointer-events","none"],[4,"ngIf","ngIfThen","ngIfElse"],["tagsBlock",""],["noTagBlock",""],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["style","position: absolute; top: 0px; left: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["height","120",3,"src","alt","click",4,"ngIf"],["src","assets/images/loading.gif",3,"alt",4,"ngIf"],[2,"position","absolute","bottom","0px","z-index","5"],["class","word-tag grow","style","display: block; width: 88px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],["class","grow","style","display: block; width: 88px; overflow: hidden; padding-left: 2px; font-weight: bold; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],[1,"word-tag","grow",2,"display","block","width","88px","overflow","hidden","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"display","block","width","88px","overflow","hidden","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"color","gray","display","block","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons","red-eye",2,"z-index","5","margin-right","2px","font-size","16px","display","block"],[2,"position","absolute","top","0px","left","0px","pointer-events","none","z-index","5"],[1,"grow",2,"font-size","13px","color","red","padding-left","2px"],["height","120",3,"src","alt","click"],["src","assets/images/loading.gif",3,"alt"]],template:function(e,i){1&e&&(K(0,"div",0)(1,"div",1)(2,"label",2)(3,"input",3),Te("click",function(s){return i.onShowHiddenImages(s)}),J(),K(4,"i",4),be(5),J()()(),K(6,"span",5)(7,"label")(8,"input",6),Te("click",function(){return i.onSearchAllImage()}),J(),K(9,"div",7)(10,"b"),be(11,"ALL"),J(),it(12,"badge",8),J()(),xe(13,Gz,6,3,"label",9),xe(14,Wz,5,4,"label",10),J(),K(15,"span",11)(16,"select",12),Te("ngModelChange",function(s){return i.serchCondIsOr=s}),K(17,"option",13),be(18,"\u3044\u305a\u308c\u304b (OR)"),J(),K(19,"option",14),be(20,"\u3059\u3079\u3066 (AND)"),J()(),K(21,"label",15)(22,"input",16),Te("ngModelChange",function(s){return i.isSort=s})("change",function(){return i.isSort=!!i.isSort}),J(),K(23,"b",17),be(24,"\u30bd\u30fc\u30c8"),J()()()(),K(25,"div",18),xe(26,Kz,5,0,"span",19),xe(27,oj,11,11,"div",20),J()),2&e&&(U(3),ct("checked",i.isShowHideImages?"checked":""),U(1),te("ngClass",ut(14,aj,i.isShowHideImages)),U(1),qe(i.isShowHideImages?"visibility":"visibility_off"),U(3),ct("checked",i.searchAllImage?"checked":""),U(4),te("count",i.images.length)("@.disabled",!0),U(1),te("ngIf",i.countAllImagesHasWord(null)>0),U(1),te("ngForOf",i.allImagesOwnWords),U(2),te("ngModel",i.serchCondIsOr),U(6),ct("checked",i.isSort?"checked":""),te("ngModel",i.isSort),U(4),te("ngIf",i.isAllowedEmpty),U(1),te("ngForOf",i.images)("ngForTrackBy",i.identify))},directives:[Wn,Nd,_n,Jr,hi,oi,ei,es,zr,jr],pipes:[ti],styles:["[_nghost-%COMP%]{display:block}.image[_ngcontent-%COMP%]{font-size:0;display:inline-block;border:2px solid transparent;margin-left:-2px}.image[_ngcontent-%COMP%]:not(.current-images){cursor:pointer}.image[_ngcontent-%COMP%]:not(.current-images):hover{border:2px dotted red;transform:scale(1.08);z-index:200;transition-duration:60ms}.current-images[_ngcontent-%COMP%]{border:2px solid red}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom;transition-duration:.12s}.image[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(1px);backdrop-filter:blur(1px);filter:none!important}.empty[_ngcontent-%COMP%]{line-height:120px;vertical-align:top}.empty[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:120px;margin:1px;box-sizing:border-box;vertical-align:top}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.sticky-top[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;top:0;background-color:#f0dabde6;border-top:1px dotted #666;border-bottom:1px dotted #666;z-index:100}.word-tag[_ngcontent-%COMP%]{margin-right:3px;display:inline-block;color:#000;font-weight:bolder}.word-tag[_ngcontent-%COMP%]:hover{color:red}.word-selecter[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.word-selecter[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{display:none}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div.all-tags[_ngcontent-%COMP%]{background-color:#eee;color:#008b8b}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}"],data:{animation:[xn("scaleInOut",[Bt("void => *",[Ft("200ms ease",nn([Ye({transform:"scale3d(0, 0, 0)",offset:0}),Ye({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Bt("* => void",[Ft("180ms ease",Ye({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),n})();function Q0(n,t=[]){let e=lt.instance.getObjects(n.aliasName);t.forEach(s=>e=e.concat(lt.instance.getObjects(s))),e=e.filter(s=>s.isVisibleOnTable);let i=-1,r=!1;for(let s=0;s<e.length;s++)i===e[s].zindex?r=!0:i<e[s].zindex&&(i=e[s].zindex,r=!1);if((i!==n.zindex||r)&&(n.zindex=i+1,!(n.zindex<e.length+256))){e.sort((s,o)=>s.zindex-o.zindex);for(let s=0;s<e.length;s++)e[s].zindex=s}}var Yp,ys=(()=>(function(n){n[n.FRONT=0]="FRONT",n[n.BACK=1]="BACK"}(ys||(ys={})),ys))();let On=Yp=class extends $i{constructor(){super(...arguments),this.state=ys.FRONT,this.rotate=0,this.owner="",this.zindex=0,this.isLocked=!1}get isVisibleOnTable(){return"table"===this.location.name&&(!this.parentIsAssigned||this.parentIsDestroyed)}get name(){return this.getCommonValue("name","")}get size(){return this.getCommonValue("size",2)}set size(t){this.setCommonValue("size",t)}get frontImage(){return this.getImageFile("front")}get backImage(){return this.getImageFile("back")}get imageFile(){return this.isVisible?this.frontImage:this.backImage}get fontsize(){let t=this.getElement("fontsize",this.commonDataElement);return!t&&this.commonDataElement&&this.commonDataElement.appendChild(ht.create("fontsize",18,{},"fontsize_"+this.identifier)),t?+t.value:18}set fontsize(t){this.setCommonValue("fontsize",t)}get text(){let t=this.getElement("text",this.commonDataElement);return!t&&this.commonDataElement&&this.commonDataElement.appendChild(ht.create("text","",{type:"note",currentValue:""},"text_"+this.identifier)),t?t.value+"":""}set text(t){this.setCommonValue("text",t)}get color(){return this.getCommonValue("color","#555555")}set color(t){this.setCommonValue("color",t)}get ownerName(){let t=Ue.findByUserId(this.owner);return t?t.name:""}get ownerColor(){let t=Ue.findByUserId(this.owner);return t?t.color:"#444444"}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return!!this.hasOwner&&(yt.peerContext.userId===this.owner&&yt.peerContext.isOpen||yt.peerContexts.some(t=>{const e=Ue.findByPeerId(t.peerId);return e&&e.userId===this.owner&&t.isOpen}))}get isHand(){return yt.peerContext.userId===this.owner}get isFront(){return this.state===ys.FRONT}get isVisible(){return this.isHand||this.isFront}faceUp(){this.state=ys.FRONT,this.owner=""}faceDown(){this.state=ys.BACK,this.owner=""}toTopmost(){Q0(this,["card-stack"])}static create(t,e,i,r=2,s){let o=null;return o=s?new Yp(s):new Yp,o.createDataElements(),o.commonDataElement.appendChild(ht.create("name",t,{},"name_"+o.identifier)),o.commonDataElement.appendChild(ht.create("size",r,{},"size_"+o.identifier)),o.imageDataElement.appendChild(ht.create("front",e,{type:"image"},"front_"+o.identifier)),o.imageDataElement.appendChild(ht.create("back",i,{type:"image"},"back_"+o.identifier)),o.commonDataElement.appendChild(ht.create("fontsize",18,{},"fontsize_"+o.identifier)),o.commonDataElement.appendChild(ht.create("text","",{type:"note",currentValue:""},"text_"+o.identifier)),o.commonDataElement.appendChild(ht.create("color","#555555",{type:"color"},"ccolor_"+o.identifier)),o.initialize(),o}};var Zp;B([rt()],On.prototype,"state",void 0),B([rt()],On.prototype,"rotate",void 0),B([rt()],On.prototype,"owner",void 0),B([rt()],On.prototype,"zindex",void 0),B([rt()],On.prototype,"isLocked",void 0),On=Yp=B([Xn("card")],On);let Gn=Zp=class extends $i{constructor(){super(...arguments),this.rotate=0,this.zindex=0,this.owner="",this.isShowTotal=!0,this.isLocked=!1}get name(){return this.getCommonValue("name","")}get ownerName(){let t=Ue.findByUserId(this.owner);return t?t.name:""}get ownerColor(){let t=Ue.findByUserId(this.owner);return t?t.color:"#444444"}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return!!this.hasOwner&&(yt.peerContext.userId===this.owner&&yt.peerContext.isOpen||yt.peerContexts.some(t=>{const e=Ue.findByPeerId(t.peerId);return e&&e.userId===this.owner&&t.isOpen}))}get cardRoot(){for(let t of this.children)if("cardRoot"===t.getAttribute("name"))return t;return null}get cards(){return this.cardRoot?this.cardRoot.children:[]}get topCard(){return this.isEmpty?null:this.cards[0]}get isEmpty(){return this.cards.length<1}get imageFile(){return this.topCard?this.topCard.imageFile:null}onChildRemoved(t){super.onChildRemoved(t),t instanceof On&&Fe.trigger("CARD_STACK_DECREASED",{cardStackIdentifier:this.identifier,cardIdentifier:t.identifier})}shuffle(){if(!this.cardRoot)return;let t=this.cardRoot.children.length;for(let e of this.cards)e.index=Math.random()*t,e.rotate=180*Math.floor(2*Math.random()),this.setSamePositionFor(e);return this.cards}drawCard(){let t=this.topCard?this.cardRoot.removeChild(this.topCard):null;return t&&(t.rotate+=this.rotate,360<t.rotate&&(t.rotate-=360),this.setSamePositionFor(t),t.toTopmost()),t}drawCardAll(){let t=this.cards;for(let e of t)this.cardRoot.removeChild(e),e.rotate+=this.rotate,this.setSamePositionFor(e),360<e.rotate&&(e.rotate-=360);return t}faceUp(){this.topCard&&(this.topCard.faceUp(),this.setSamePositionFor(this.topCard))}faceDown(){this.topCard&&(this.topCard.faceDown(),this.setSamePositionFor(this.topCard))}faceUpAll(){for(let t of this.cards)t.faceUp(),this.setSamePositionFor(t)}faceDownAll(){for(let t of this.cards)t.faceDown(),this.setSamePositionFor(t)}uprightAll(){for(let t of this.cards)t.rotate=0,this.setSamePositionFor(t)}inverse(){const t=[];for(;;){let e=this.topCard?this.cardRoot.removeChild(this.topCard):null;if(null==e)break;t.unshift(e),e.state=e.state==ys.FRONT?ys.BACK:ys.FRONT}for(let e of t)this.putOnBottom(e)}unifyCardsSize(t){for(const e of this.cards)e.size!==t&&(e.size=t)}putOnTop(t){if(!this.cardRoot)return null;if(!this.topCard)return this.putOnBottom(t);t.owner="",t.zindex=0;let e=Math.abs(t.rotate-this.rotate);return 180<e&&(e=360-e),t.rotate=e<=90?0:180,this.setSamePositionFor(t),this.cardRoot.insertBefore(t,this.topCard)}putOnBottom(t){if(!this.cardRoot)return null;t.owner="",t.zindex=0;let e=Math.abs(t.rotate-this.rotate);return 180<e&&(e=360-e),t.rotate=e<=90?0:180,this.setSamePositionFor(t),this.cardRoot.appendChild(t)}toTopmost(){Q0(this,["card"])}setLocation(t){super.setLocation(t);let e=this.cards;for(let i of e)i.setLocation(t)}setSamePositionFor(t){t.location.name=this.location.name,t.location.x=this.location.x,t.location.y=this.location.y,t.posZ=this.posZ}static create(t,e){let i=null;i=e?new Zp(e):new Zp,i.createDataElements(),i.commonDataElement.appendChild(ht.create("name",t,{},"name_"+i.identifier));let r=new zn("cardRoot_"+i.identifier);return r.setAttribute("name","cardRoot"),r.initialize(),i.appendChild(r),i.initialize(),i}};B([rt()],Gn.prototype,"rotate",void 0),B([rt()],Gn.prototype,"zindex",void 0),B([rt()],Gn.prototype,"owner",void 0),B([rt()],Gn.prototype,"isShowTotal",void 0),B([rt()],Gn.prototype,"isLocked",void 0),Gn=Zp=B([Xn("card-stack")],Gn);var Xp,Mi=(()=>(function(n){n[n.D2=0]="D2",n[n.D4=1]="D4",n[n.D6=2]="D6",n[n.D8=3]="D8",n[n.D10=4]="D10",n[n.D10_10TIMES=5]="D10_10TIMES",n[n.D12=6]="D12",n[n.D20=7]="D20"}(Mi||(Mi={})),Mi))();let or=Xp=class extends $i{constructor(){super(...arguments),this.face="0",this.owner="",this.rotate=0,this.isDropShadow=!0,this.isLock=!1}get name(){return this.getCommonValue("name","")}set name(t){this.setCommonValue("name",t)}get size(){return this.getCommonValue("size",1)}set size(t){this.setCommonValue("size",t)}get faces(){return this.imageDataElement?this.imageDataElement.children.filter(t=>"nothing"!=t.currentValue).map(t=>t.name):[]}get imageFile(){return this.isVisible?this.getImageFile(this.face):this.faces.length?this.getImageFile(this.faces[0]):null}get backFaceImageFile(){return this.isCoin?this.getImageFile(this.isVisible?"\u8868"==this.face?"\u88cf":"\u8868":this.faces[1]):this.imageFile}get nothingFaces(){return this.imageDataElement.children.filter(t=>"nothing"==t.currentValue).map(t=>t.name)}get ownerName(){let t=Ue.findByUserId(this.owner);return t?t.name:""}get ownerColor(){let t=Ue.findByUserId(this.owner);return t?t.color:"#444444"}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return this.hasOwner&&yt.peerContexts.some(t=>t.userId===this.owner&&t.isOpen)}get isMine(){return yt.peerContext.userId===this.owner}get isVisible(){return!this.hasOwner||this.isMine||this.isGMMode}get isCoin(){return 2===this.faces.length}diceRoll(){let t=this.faces;return this.face=0<t.length?t[Math.floor(Math.random()*t.length)]:"",this.face}setDicetype(t){this.makeDiceFace(t)}makeDiceFace(t,e){let i=1,r=[],s=o=>o+1+"";switch(t){case Mi.D2:i=2,s=c=>0===c?"\u8868":"\u88cf";break;case Mi.D4:i=4;break;case Mi.D6:i=6,r.push(ht.create("\u306a\u3057","",{type:"image",currentValue:"nothing"},null!=e?"nothing_"+e:null));break;case Mi.D8:i=8;break;case Mi.D10_10TIMES:s=c=>c+1+"0";case Mi.D10:i=10;break;case Mi.D12:i=12;break;case Mi.D20:i=20;break;default:i=2}for(let o=0;o<i;o++){let c=s(o);r.push(ht.create(c,"",{type:"image"},null!=e?c+"_"+e:null))}return this.imageDataElement.children.forEach(o=>o.destroy()),r.forEach(o=>this.imageDataElement.appendChild(o)),this.face=this.faces[0],r}static create(t,e,i,r){let s=r?new Xp(r):new Xp;return s.createDataElements(),s.commonDataElement.appendChild(ht.create("name",t,{},"name_"+s.identifier)),s.commonDataElement.appendChild(ht.create("size",i,{},"size_"+s.identifier)),s.makeDiceFace(e,s.identifier),s.initialize(),s}};var J0;B([rt()],or.prototype,"face",void 0),B([rt()],or.prototype,"owner",void 0),B([rt()],or.prototype,"rotate",void 0),B([rt()],or.prototype,"isDropShadow",void 0),B([rt()],or.prototype,"isLock",void 0),or=Xp=B([Xn("dice-symbol")],or);let Kn=J0=class extends zn{constructor(){super(...arguments),this.toName="",this.toImageIdentifier="",this.toColor="",this.aura=-1,this.lastUpdate=0,this.isAnimated=!1,this._sendTo=[],this._tags=[],this.locale="en-US"}get tabIdentifier(){return this.parent.identifier}get text(){return this.value}set text(t){this.value=null==t?"":t}get timestamp(){let t=this.getAttribute("timestamp"),e=t?+t:0;return Number.isNaN(e)?1:e}get sendTo(){return this._to!==this.to&&(this._to=this.to,this._sendTo=null!=this.to&&0<this.to.trim().length?this.to.trim().split(/\s+/):[]),this._sendTo}get isEdited(){return this.lastUpdate>0}get tags(){return this._tag!==this.tag&&(this._tag=this.tag,this._tags=null!=this.tag&&0<this.tag.trim().length?this.tag.trim().split(/\s+/):[]),this._tags}get image(){return kt.instance.get(this.imageIdentifier)}get toImage(){return kt.instance.get(this.toImageIdentifier)}get index(){return this.minorIndex+this.timestamp}get isDirect(){return 0<this.sendTo.length||-1<this.tags.indexOf("direct")}get isSendFromSelf(){return this.from===yt.peerContext.userId||this.originFrom===yt.peerContext.userId||-1<this.tags.indexOf("mine")}get isRelatedToMe(){return-1<this.sendTo.indexOf(yt.peerContext.userId)||this.isSendFromSelf||this.isGMMode}get isDisplayable(){return!this.isDirect||this.isRelatedToMe}get isSystem(){return-1<this.tags.indexOf("system")}get isDicebot(){return this.isSystem&&this.from.indexOf("Dice")>=0&&!/^C\(.+\) \u2192/i.test(this.text)}get isCalculate(){return this.isSystem&&this.from.indexOf("Dice")>=0&&/^C\(.+\) \u2192/i.test(this.text)}get isSecret(){return-1<this.tags.indexOf("secret")}get isEmptyDice(){return!this.isDicebot||-1<this.tags.indexOf("empty")}get isSpecialColor(){return this.isDirect||this.isSecret||this.isSystem||this.isOperationLog||this.isDicebot||this.isCalculate}get isEditable(){return!this.isSystem&&!this.isOperationLog&&this.from===yt.peerContext.userId}get isFaceIcon(){return!this.isSystem&&(!this.characterIdentifier||this.tags.indexOf("noface")<0)}get isOperationLog(){return-1<this.tags.indexOf("opelog")}get isSuccess(){return this.isDicebot&&-1<this.tags.indexOf("success")}get isFailure(){return this.isDicebot&&-1<this.tags.indexOf("failure")}get isCritical(){return this.isDicebot&&-1<this.tags.indexOf("critical")}get isFumble(){return this.isDicebot&&-1<this.tags.indexOf("fumble")}get isGMMode(){return!!Ue.myCursor&&Ue.myCursor.isGMMode}logFragment(t,e=null,i="HH:mm",r=!0){return 0==t?this.logFragmentText(e,i):this.logFragmentHtml(e,i,2!=t)}logFragmentText(t=null,e="HH:mm"){t=t&&""!=t.trim()?`[${t}] `:"";const i=""==e?"":bd(new Date(this.timestamp),e,this.locale)+"\uff1a",r=this.isEdited?""==e?" (\u7de8\u96c6\u6e08)":` (\u7de8\u96c6\u6e08 ${bd(new Date(this.lastUpdate),e,this.locale)})`:"";let s=et.rubyToText(this.text);return this.isDicebot&&(s=s.replace(/###(.+?)###/g,"*$1").replace(/\~\~\~(.+?)\~\~\~/g,"~$1")),s.lastIndexOf("\n")==s.length-1&&!r&&(s+="\n"),`${t}${i}${this.name}${this.toColor?" \u27a1 "+this.toName:""}\uff1a${this.isSecret&&!this.isSendFromSelf?"\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09":s+r}`}logFragmentHtml(t=null,e="HH:mm",i=!0){const r=et.escapeHtml(this.color?this.color:Ue.CHAT_DEFAULT_COLOR),s=` style="color: ${r}"`,o=this.toColor?et.escapeHtml(this.toColor):"",c=this.toColor?` style="color: ${o}"`:"",m=this.isDirect||this.isSecret?' class="grow"':"",I=t&&""!=t.trim()?`<span class="tab-name">${et.escapeHtml(t)}</span> `:"",Z=new Date(this.timestamp),fe=""==e?"":`<time datetime="${Z.toISOString()}">${et.escapeHtml(bd(Z,e,this.locale))}</time>\uff1a`,pe=`<span${m}${s}>${et.escapeHtml(this.name)}</span>`+(this.toColor?` \u27a1 <span${m}${c}>${et.escapeHtml(this.toName)}</span>`:"");let ye=["message"];(this.isDirect||this.isSecret)&&ye.push("direct-message"),this.isSystem&&ye.push("system-message"),(this.isDicebot||this.isCalculate)&&ye.push("dicebot-message"),this.isOperationLog&&ye.push("operation-log");let we=["msg-text"];(!this.isSecret||this.isSendFromSelf)&&(this.isSuccess&&we.push("is-success"),this.isFailure&&we.push("is-failure"),this.isCritical&&we.push("is-critical"),this.isFumble&&we.push("is-fumble"));let Me=this.isSecret&&!this.isSendFromSelf?"<s>\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09</s>":ST.link(this.isOperationLog?et.escapeHtml(this.text):et.rubyToHtml(et.escapeHtml(this.text)),{urls:{schemeMatches:!0,wwwMatches:!0,tldMatches:!1},truncate:{length:96,location:"end"},decodePercentEncoding:!1,stripPrefix:!1,stripTrailingSlash:!1,email:!1,phone:!1,className:"outer-link",replaceFn:function(Be){return"url"==Be.getType()&&et.validUrl(Be.getAnchorHref())}});this.isDicebot&&(Me=J0.decorationDiceResult(Me));let Oe="";if(this.isEdited)if(""==e)Oe='<span class="is-edited">\u7de8\u96c6\u6e08</span>';else{const Be=new Date(this.lastUpdate);Oe=`<span class="is-edited"><b>\u7de8\u96c6\u6e08</b> <time datetime="${Be.toISOString()}">${et.escapeHtml(bd(Be,e,this.locale))}</time></span>`}return Me.lastIndexOf("\n")==Me.length-1&&!Oe&&(Me+="\n"),`<div class="${ye.join(" ")}" style="border-left-color: ${r}">\n  <div class="msg-header">${I}${fe}<span class="msg-name">${pe}</span>\uff1a</div>\n  <div class="${we.join(" ")}"><span${this.isSpecialColor?"":s}>${Me}</span>${Oe}</div>\n</div>`}static logCss(t=!0){return"body {\n  color: #444;\n  background-color: #FFF;\n}\n.message {\n  display: flex;\n  width: 100%;\n  word-wrap: break-word;\n  overflow-wrap: anywhere;\n  word-break: break-word;\n  border-left: 4px solid transparent;\n  margin-top: 1px;\n}\n.direct-message {\n  background-color: #555;\n  color: #CCC;\n}\n.dicebot-message .msg-text {\n  color: #11F;\n}\n.direct-message.dicebot-message .msg-text {\n  color: #CCF;\n}\n.dicebot-message .msg-text.is-success {\n  color: #17f;\n}\n.dicebot-message .msg-text.is-failure {\n  color: #F05;\n}\n.direct-message.dicebot-message .msg-text.is-success {\n  color: #adF;\n}\n.direct-message.dicebot-message .msg-text.is-failure {\n  color: #F66;\n}\n.operation-log {\n  color: #666;\n  background-color: #CCCCCCAA;\n}\n.dicebot-message .msg-name,\n.dicebot-message .msg-text,\n.operation-log .msg-name,\n.operation-log .msg-text {\n  font-style: oblique;\n}\n.tab-name {\n  display: inline-block;\n}\n.tab-name::before {\n  content: '[';\n}\n.tab-name::after {\n  content: ']';\n}\n.msg-header {\n  white-space: nowrap;\n  border-left: 1px solid #FFF;\n  padding-left: 2px;\n}\n.msg-name {\n  font-weight: bolder;\n}\n.msg-text {\n  white-space: pre-wrap;\n  width: 100%\n}\n.is-edited {\n  margin-left: 2px;\n  font-size: 8px;\n}\n.is-edited::before {\n  content: '(';\n}\n.is-edited::after {\n  content: ')';\n}\na[target=_blank] {\n  text-decoration: none;\n  word-break: break-all;\n}\na[target=_blank]:hover {\n  text-decoration: underline;\n}\na.outer-link::after {\n  margin-right: 2px;\n  margin-left: 2px;\n  font-family: 'Material Icons';\n  content: '\\e89e';\n  font-weight: bolder;\n  text-decoration: none;\n  display: inline-block;\n  font-size: smaller;\n  vertical-align: 25%;\n}\n.direct-message a[href] {\n  color: #CCF;\n}\n.direct-message a[href]:visited {\n  color: #99D;\n}\nruby {\n  ruby-align: space-between;\n}\ns.drop-dice .dropped {\n  color: #999;\n}\n.grow {\n  text-shadow: \n       1px  0px 1px #ffffff,\n       0px  1px 1px #ffffff,\n      -1px  0px 1px #ffffff,\n       0px -1px 1px #ffffff; \n}"}static decorationDiceResult(t){return t.replace(/###(.+?)###/g,'<b class="special-dice">$1</b>').replace(/\~\~\~(.+?)\~\~\~/g,'<s class="drop-dice"><span class="dropped">$1</span></s>')}};B([rt()],Kn.prototype,"originFrom",void 0),B([rt()],Kn.prototype,"from",void 0),B([rt()],Kn.prototype,"to",void 0),B([rt()],Kn.prototype,"name",void 0),B([rt()],Kn.prototype,"toName",void 0),B([rt()],Kn.prototype,"tag",void 0),B([rt()],Kn.prototype,"dicebot",void 0),B([rt()],Kn.prototype,"imageIdentifier",void 0),B([rt()],Kn.prototype,"toImageIdentifier",void 0),B([rt()],Kn.prototype,"color",void 0),B([rt()],Kn.prototype,"toColor",void 0),B([rt()],Kn.prototype,"isInverseIcon",void 0),B([rt()],Kn.prototype,"isHollowIcon",void 0),B([rt()],Kn.prototype,"isBlackPaint",void 0),B([rt()],Kn.prototype,"aura",void 0),B([rt()],Kn.prototype,"characterIdentifier",void 0),B([rt()],Kn.prototype,"standIdentifier",void 0),B([rt()],Kn.prototype,"standName",void 0),B([rt()],Kn.prototype,"isUseStandImage",void 0),B([rt()],Kn.prototype,"lastUpdate",void 0),Kn=J0=B([Xn("chat")],Kn);let Za=class extends zn{constructor(){super(...arguments),this.name="\u30bf\u30d6",this.isUseStandImage=!0,this.recieveOperationLogLevel=0,this._unreadLength=0}get chatMessages(){return this.children}get unreadLength(){return this._unreadLength}get hasUnread(){return 0<this.unreadLength}get latestTimeStamp(){let t=this.chatMessages.length-1;return t<0?0:this.chatMessages[t].timestamp}onChildAdded(t){super.onChildAdded(t),t.parent===this&&t instanceof Kn&&t.isDisplayable&&(this._unreadLength++,Fe.trigger("MESSAGE_ADDED",{tabIdentifier:this.identifier,messageIdentifier:t.identifier}))}addMessage(t){t.tabIdentifier=this.identifier;let e=new Kn;for(let i in t)if("identifier"!==i&&"tabIdentifier"!==i){if("text"===i){e.value=t[i];continue}null==t[i]||""===t[i]||e.setAttribute(i,t[i])}return e.initialize(),Fe.trigger("SEND_MESSAGE",{tabIdentifier:this.identifier,messageIdentifier:e.identifier}),this.appendChild(e),e}markForRead(){this._unreadLength=0}innerXml(){let t="";for(let e of this.children)e instanceof Kn&&!e.isDisplayable||(t+=Zn.instance.toXml(e));return t}parseInnerXml(t){return super.parseInnerXml(t)}log(t,e,i=!0){const r=this.chatMessages.filter(s=>s.isDisplayable&&(i||!s.isOperationLog)).sort((s,o)=>s.index-o.index).map(s=>s.logFragment(t,null,e)).join("\n");return 0==t?r:`<!DOCTYPE html>\n<html lang="ja-JP">\n<head>\n<meta charset="UTF-8">\n<title>Udonarium with Fly\uff1a\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0\uff1a${et.escapeHtml(""==this.name?"(\u7121\u540d\u306e\u30bf\u30d6)":this.name)}</title>\n<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">\n<style>\n${Kn.logCss()}\n</style>\n</head>\n<body>\n${r}\n</body>\n</html>`}};var Hs;B([rt()],Za.prototype,"name",void 0),B([rt()],Za.prototype,"isUseStandImage",void 0),B([rt()],Za.prototype,"recieveOperationLogLevel",void 0),Za=B([Xn("chat-tab")],Za);let go=Hs=class extends zn{static get instance(){return Hs._instance||(Hs._instance=new Hs("ChatTabList"),Hs._instance.initialize()),Hs._instance}get chatTabs(){return this.children}addChatTab(...t){let e=null;if(t[0]instanceof Za)e=t[0];else{let i=t[0];e=new Za(t[1]),e.name=i,e.initialize()}return this.appendChild(e)}parseInnerXml(t){for(let i of Hs.instance.children)i.destroy();let e=Hs.instance.toContext();e.syncData=this.toContext().syncData,Hs.instance.apply(e),Hs.instance.update(),super.parseInnerXml.apply(Hs.instance,[t]),this.destroy()}log(t,e,i=!0){if(!this.chatTabs)return"";const r=this.chatTabs.reduce((s,o)=>(o&&s.push(...o.chatMessages.filter(c=>c.isDisplayable&&(i||!c.isOperationLog)).map(c=>({index:c.index,tabName:o.name,chatMessage:c}))),s),[]).sort((s,o)=>s.index-o.index).map(s=>s.chatMessage.logFragment(t,s.tabName,e)).join("\n");return 0==t?r:`<!DOCTYPE html>\n<html lang="ja-JP">\n<head>\n<meta charset="UTF-8">\n<title>Udonarium with Fly\uff1a\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0\uff1a\u5168\u3066\u306e\u30bf\u30d6</title>\n<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">\n<style>\n${Kn.logCss()}\n</style>\n</head>\n<body>\n${r}\n</body>\n</html>`}};go=Hs=B([Xn("chat-tab-list")],go);let Er=(()=>{class n{constructor(){this.intervalTimer=null,this.timeOffset=Date.now(),this.performanceOffset=performance.now(),this.ntpApiUrls=["https://worldtimeapi.org/api/ip"],this.gameType=""}get chatTabs(){return go.instance.chatTabs}calibrateTimeOffset(){if(null!=this.intervalTimer)return void console.log("calibrateTimeOffset was canceled.");let e=Math.floor(Math.random()*this.ntpApiUrls.length),i=this.ntpApiUrls[e],r=performance.now();fetch(i).then(s=>{if(s.ok)return s.json();throw new Error("Network response was not ok.")}).then(s=>{let o=performance.now(),c=(o-r)/2,I=new Date(s.utc_datetime).getTime();this.timeOffset=I+c,this.performanceOffset=o,console.log("latency: "+c+"ms"),console.log("st: "+I),console.log("timeOffset: "+this.timeOffset),console.log("performanceOffset: "+this.performanceOffset),this.setIntervalTimer()}).catch(s=>{console.warn("There has been a problem with your fetch operation: ",s.message),this.setIntervalTimer()}),this.setIntervalTimer()}setIntervalTimer(){null!=this.intervalTimer&&clearTimeout(this.intervalTimer),this.intervalTimer=setTimeout(()=>{this.intervalTimer=null,this.calibrateTimeOffset()},216e5)}getTime(){return Math.floor(this.timeOffset+(performance.now()-this.performanceOffset))}sendMessage(e,i,r,s,o,c,m,I,Z,fe,pe,ye,we,Me,Oe){let Be=!(pe&&this.findFaceIconIdentifier(s)),ke={from:yt.peerContext.userId,to:n.findId(o),name:this.findObjectName(s),toName:o?this.findObjectName(o):"",imageIdentifier:this.findImageIdentifier(s,pe),toImageIdentifier:o?this.findImageIdentifier(o):"",timestamp:this.calcTimeStamp(e),tag:Be?`${r} noface`:r,text:et.cr(i),color:c,toColor:o?this.findObjectColor(o):"",isInverseIcon:Be&&m?1:0,isHollowIcon:Be&&I?1:0,isBlackPaint:Be&&Z?1:0,aura:Be?fe:-1,characterIdentifier:ye,standIdentifier:we,standName:Me,isUseStandImage:Oe};return e.addMessage(ke)}sendOperationLog(e,i=1){for(const r of this.chatTabs){if(r.recieveOperationLogLevel<i)continue;let s={from:yt.peerContext.userId,name:Ue.myCursor.name,imageIdentifier:Ue.myCursor.imageIdentifier,timestamp:this.calcTimeStamp(r),tag:"opelog",text:et.cr(e),color:Ue.myCursor.color};r.addMessage(s)}}static findId(e){let i=lt.instance.get(e);return i instanceof Vt?i.identifier:i instanceof Ue?i.userId:null}findObjectName(e){let i=lt.instance.get(e);return i instanceof Vt?i.name&&i.name.length?i.name:"\uff08\u7121\u540d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\uff09":i instanceof Ue?i.name&&i.name.length?i.name:"\uff08\u7121\u540d\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\uff09":e}findObjectColor(e){let i=lt.instance.get(e);return i instanceof Vt?i.chatPalette.color:i instanceof Ue?i.color:null}makeMessageName(e,i){let r=this.findObjectName(e);return null==i||i.length<1?r:r+" \u27a1 "+this.findObjectName(i)}findImageIdentifier(e,i=!1){let r=lt.instance.get(e);return r instanceof Vt?i&&r.faceIcon&&0<r.faceIcon.url.length?r.faceIcon.identifier:r.imageFile?r.imageFile.identifier:"":r instanceof Ue?r.imageIdentifier:e}findFaceIconIdentifier(e){let i=lt.instance.get(e);return i instanceof Vt&&i.faceIcon&&0<i.faceIcon.url.length?i.faceIcon.identifier:""}calcTimeStamp(e){let i=this.getTime(),r=e.latestTimeStamp;return i<=r?r+1:i}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=tn({token:n,factory:n.\u0275fac}),n})();const cj=["chatInput"],uj=["chatPlette"];function dj(n,t){1&n&&(K(0,"i",13),be(1,"how_to_reg"),J())}function fj(n,t){1&n&&(K(0,"i",13),be(1,"history_edu"),J())}function hj(n,t){1&n&&it(0,"badge",14),2&n&&te("count",ge().$implicit.unreadLength)}function pj(n,t){if(1&n){const e=Xe();K(0,"label")(1,"input",10),Te("ngModelChange",function(r){return De(e),ge().chatTabidentifier=r}),J(),K(2,"div")(3,"span"),be(4),J(),xe(5,dj,2,0,"i",11),xe(6,fj,2,0,"i",11),xe(7,hj,1,1,"badge",12),J()()}if(2&n){const e=t.$implicit,i=ge();U(1),ct("value",e.identifier),te("ngModel",i.chatTabidentifier),U(2),Ke("cursor",i.chatTabidentifier!=e.identifier?"pointer":"")("color",""==e.name&&i.chatTabidentifier!=e.identifier?"gray":""),U(1),qe(""==e.name?"(\u7121\u540d\u306e\u30bf\u30d6)":e.name),U(1),te("ngIf",e.isUseStandImage),U(1),te("ngIf",e.recieveOperationLogLevel>0),U(1),te("ngIf",e.hasUnread)}}function gj(n,t){1&n&&(K(0,"div",15)(1,"i",16),be(2,"info_outline"),J(),be(3," \u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u7de8\u96c6\u4e2d\u3067\u3059"),J())}function mj(n,t){if(1&n&&(K(0,"option",21),be(1),J()),2&n){const e=ge().$implicit;Ke("color",ge(3).color),ct("value",e),U(1),qe(e)}}function _j(n,t){if(1&n&&(Ve(0),xe(1,mj,2,4,"option",20),Ge()),2&n){const e=t.$implicit,i=ge(3);U(1),te("ngIf",i.filter(e))}}function $j(n,t){if(1&n&&(Ve(0),xe(1,_j,2,1,"ng-container",3),Ge()),2&n){const e=ge(2);U(1),te("ngForOf",e.palette.getPalette())}}function vj(n,t){if(1&n){const e=Xe();K(0,"div",17)(1,"select",18,19),Te("input",function(r){return De(e),ge().selectPalette(r.target.value)})("click",function(r){return De(e),ge().clickPalette(r.target.value)}),xe(3,$j,2,1,"ng-container",9),J()()}if(2&n){const e=ge();U(3),te("ngIf",e.palette)}}function bj(n,t){if(1&n){const e=Xe();K(0,"div",17)(1,"textarea",22),Te("ngModelChange",function(r){return De(e),ge().editPalette=r}),J()()}if(2&n){const e=ge();U(1),te("ngModel",e.editPalette)}}function yj(n,t){1&n&&(K(0,"span"),be(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u7de8\u96c6"),J())}function Cj(n,t){1&n&&(K(0,"span"),be(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u78ba\u5b9a"),J())}let hu=(()=>{class n{constructor(e,i){this.chatMessageService=e,this.panelService=i,this.character=null,this._gameType="",this.chatTabidentifier="",this.text="",this.sendTo="",this.isEdit=!1,this.editPalette="",this.filterText="",this.doubleClickTimer=null,this.selectedPaletteIndex=-1}get palette(){return this.character.chatPalette}get color(){return this.chatInputComponent.color}get gameType(){return this._gameType?this._gameType:"DiceBot"}set gameType(e){this._gameType=e,this.character.chatPalette&&(this.character.chatPalette.dicebot=e)}get sendFrom(){return this.character.identifier}set sendFrom(e){this.onSelectedCharacter(e)}get diceBotInfos(){return jn.diceBotInfos}get chatTab(){return lt.instance.get(this.chatTabidentifier)}get myPeer(){return Ue.myCursor}get otherPeers(){return lt.instance.getObjects(Ue)}ngOnInit(){Promise.resolve().then(()=>this.updatePanelTitle()),this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"",this.gameType=this.character.chatPalette?this.character.chatPalette.dicebot:"",Fe.register(this).on("DELETE_GAME_OBJECT",e=>{this.character&&this.character.identifier===e.data.identifier&&this.panelService.close(),this.chatTabidentifier===e.data.identifier&&(this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"")})}ngOnDestroy(){Fe.unregister(this),this.isEdit&&this.toggleEditMode()}updatePanelTitle(){this.panelService.title=this.character.name+" \u306e\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8"}onSelectedCharacter(e){this.isEdit&&this.toggleEditMode();let i=lt.instance.get(e);if(i instanceof Vt){this.character=i;let r=this.character.chatPalette?this.character.chatPalette.dicebot:"";0<r.length&&(this.gameType=r)}this.updatePanelTitle()}selectPalette(e){this.text=e}clickPalette(e){if(!this.chatPletteElementRef.nativeElement)return;const i=this.palette.evaluate(e,this.character.rootDataElement);this.doubleClickTimer&&this.selectedPaletteIndex===this.chatPletteElementRef.nativeElement.selectedIndex?(clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.chatInputComponent.sendChat(null)):(this.selectedPaletteIndex=this.chatPletteElementRef.nativeElement.selectedIndex,this.text=i,this.chatInputComponent.textAreaElementRef.nativeElement.value=this.text,this.doubleClickTimer=setTimeout(()=>{this.doubleClickTimer=null},400))}sendChat(e){if(this.chatTab){let i=this.palette.evaluate(e.text,this.character.rootDataElement);this.chatMessageService.sendMessage(this.chatTab,i,e.gameType,e.sendFrom,e.sendTo,e.color,e.isInverse,e.isHollow,e.isBlackPaint,e.aura,e.isUseFaceIcon,e.characterIdentifier,e.standIdentifier,e.standName,e.isUseStandImage),this.filterText=""}}resetPletteSelect(){!this.chatPletteElementRef.nativeElement||(this.chatPletteElementRef.nativeElement.selectedIndex=-1)}toggleEditMode(){this.isEdit=!this.isEdit,this.isEdit?this.editPalette=this.palette.value+"":this.palette.setPalette(this.editPalette)}filter(e){return null==this.filterText||""==this.filterText.trim()||e.search(this.filterText)>=0}}return n.\u0275fac=function(e){return new(e||n)(Le(Er),Le(In))},n.\u0275cmp=Zt({type:n,selectors:[["chat-palette"]],viewQuery:function(e,i){if(1&e&&(on(cj,7),on(uj,5)),2&e){let r;sn(r=an())&&(i.chatInputComponent=r.first),sn(r=an())&&(i.chatPletteElementRef=r.first)}},inputs:{character:"character"},decls:14,vars:11,consts:[[1,"flex-container"],[2,"flex-grow","0"],[1,"chat-tab"],[4,"ngFor","ngForOf"],[3,"onlyCharacters","chatTabidentifier","gameType","sendFrom","text","gameTypeChange","sendFromChange","textChange","chat"],["chatInput",""],["class","edit-info",4,"ngIf"],["style","flex-grow: 1; height: 0; min-height: 100px;",4,"ngIf"],["type","submit",3,"click"],[4,"ngIf"],["name","chat-tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],["class","material-icons small-font",4,"ngIf"],["class","badge",3,"count",4,"ngIf"],[1,"material-icons","small-font"],[1,"badge",3,"count"],[1,"edit-info"],[1,"material-icons",2,"vertical-align","bottom","size","0.8rem"],[2,"flex-grow","1","height","0","min-height","100px"],["size","5",1,"palette",2,"overflow-y","auto",3,"input","click"],["chatPlette",""],[3,"value","color",4,"ngIf"],[3,"value"],["placeholder","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8",1,"palette",2,"resize","none",3,"ngModel","ngModelChange"]],template:function(e,i){1&e&&(K(0,"div",0)(1,"div",1)(2,"form")(3,"div",2),xe(4,pj,8,10,"label",3),J()(),K(5,"chat-input",4,5),Te("gameTypeChange",function(s){return i.gameType=s})("sendFromChange",function(s){return i.sendFrom=s})("textChange",function(s){return i.text=s})("chat",function(s){return i.sendChat(s)}),J(),xe(7,gj,4,0,"div",6),J(),xe(8,vj,4,1,"div",7),xe(9,bj,2,1,"div",7),K(10,"div",1)(11,"button",8),Te("click",function(){return i.toggleEditMode()}),xe(12,yj,2,0,"span",9),xe(13,Cj,2,0,"span",9),J()()()),2&e&&(U(4),te("ngForOf",i.chatMessageService.chatTabs),U(1),te("onlyCharacters",!0)("chatTabidentifier",i.chatTabidentifier)("gameType",i.gameType)("sendFrom",i.sendFrom)("text",i.text),U(2),te("ngIf",i.isEdit),U(1),te("ngIf",!i.isEdit),U(1),te("ngIf",i.isEdit),U(3),te("ngIf",!i.isEdit),U(1),te("ngIf",i.isEdit))},styles:["[_nghost-%COMP%]{display:block;height:100%}.edit-info[_ngcontent-%COMP%]{width:100%;text-align:center;color:#ccc;background-color:#1e1e1ecc}.palette[_ngcontent-%COMP%]{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;width:100%;height:100%}.flex-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.chat-tab[_ngcontent-%COMP%]{padding:0 5px 5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:8px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:top;font-size:.6rem}"]}),n})();function xj(n,t){if(1&n&&(K(0,"div",11),be(1),J()),2&n){const e=ge(2);U(1),qe(e.isSpeaking?"\u{1f603}":"\u{1f910}")}}const wj=function(n){return{transform:n}},Ej=function(n){return{inverse:n}},Tj=function(n,t,e,i,r,s,o,c){return{black:n,blue:t,green:e,cyan:i,red:r,magenta:s,yellow:o,white:c}},Ij=function(n,t){return{"black-paint":n,hollow:t}};function Sj(n,t){if(1&n){const e=Xe();Ve(0),K(1,"div")(2,"div",5)(3,"div",6)(4,"span",7)(5,"img",8),Te("dblclick",function(){return De(e),ge().openModal()}),Ct(6,"safe"),J()()()(),K(7,"button",9),Te("click",function(){return De(e),ge().openModal()}),K(8,"b"),be(9),J()(),xe(10,xj,2,1,"div",10),J(),Ge()}if(2&n){const e=ge();U(2),te("ngStyle",ut(10,wj,e.isApplyRoll?"rotate("+e.gameCharacter.roll+"deg)":"")),U(1),te("ngClass",ut(12,Ej,e.isApplyImageEffect&&e.gameCharacter.isInverse)),U(1),te("ngClass",ao(14,Tj,e.isApplyImageEffect&&0==e.gameCharacter.aura,e.isApplyImageEffect&&1==e.gameCharacter.aura,e.isApplyImageEffect&&2==e.gameCharacter.aura,e.isApplyImageEffect&&3==e.gameCharacter.aura,e.isApplyImageEffect&&4==e.gameCharacter.aura,e.isApplyImageEffect&&5==e.gameCharacter.aura,e.isApplyImageEffect&&6==e.gameCharacter.aura,e.isApplyImageEffect&&7==e.gameCharacter.aura)),U(1),te("src",xt(6,7,e.standImage.url,"resourceUrl"),Jt)("ngClass",Kt(23,Ij,e.isApplyImageEffect&&e.gameCharacter.isBlackPaint,e.isApplyImageEffect&&e.gameCharacter.isHollow)),U(4),An("",e.isSpeakable?"\u901a\u5e38":"","\u753b\u50cf\u5909\u66f4"),U(1),te("ngIf",e.isSpeakable)}}function Mj(n,t){if(1&n){const e=Xe();Ve(0),K(1,"span",12)(2,"input",13),Te("ngModelChange",function(r){return De(e),ge().nameElement.value=r}),J()(),Ge()}if(2&n){const e=ge();U(2),te("ngModel",e.nameElement.value)}}function kj(n,t){if(1&n){const e=Xe();Ve(0),K(1,"b",12),be(2,"\u3000Cond: "),J(),K(3,"select",14),Te("ngModelChange",function(r){return De(e),ge().conditionTypeElement.value=r}),K(4,"option",15),be(5,"\u30c7\u30d5\u30a9\u30eb\u30c8"),J(),K(6,"option",15),be(7,"\u6307\u5b9a\u753b\u50cf"),J(),K(8,"option",15),be(9,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e"),J(),K(10,"option",15),be(11,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e \u307e\u305f\u306f \u6307\u5b9a\u753b\u50cf"),J(),K(12,"option",15),be(13,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e \u304b\u3064 \u6307\u5b9a\u753b\u50cf"),J(),K(14,"option",15),be(15,"\u9078\u629e\u6642\u306e\u307f"),J()(),Ge()}if(2&n){const e=ge();U(3),te("ngModel",e.conditionTypeElement.value),U(1),ct("value",e.standConditionType.Default),U(2),ct("value",e.standConditionType.Image),U(2),ct("value",e.standConditionType.Postfix),U(2),ct("value",e.standConditionType.PostfixOrImage),U(2),ct("value",e.standConditionType.PostfixAndImage),U(2),ct("value",e.standConditionType.NotConditionStandUp)}}function Dj(n,t){if(1&n){const e=Xe();Ve(0),K(1,"span",12)(2,"b",16),be(3,"Tag: "),J(),K(4,"input",17),Te("ngModelChange",function(r){return De(e),ge().nameElement.currentValue=r}),J()(),Ge()}if(2&n){const e=ge();U(4),te("ngModel",e.nameElement.currentValue)}}function Aj(n,t){if(1&n){const e=Xe();Ve(0),K(1,"label",18)(2,"input",19),Te("ngModelChange",function(r){return De(e),ge().showNameElement.value=r})("change",function(){De(e);const r=ge();return r.showNameElement.value=r.showNameElement.value?"showName":""}),J(),K(3,"b",12),be(4,"\u30cd\u30fc\u30e0\u30bf\u30b0"),J()(),Ge()}if(2&n){const e=ge();U(2),ct("checked",e.showNameElement.value?"checked":""),te("ngModel",e.showNameElement.value)}}function Pj(n,t){if(1&n){const e=Xe();Ve(0),K(1,"label",18)(2,"input",19),Te("ngModelChange",function(r){return De(e),ge().applyImageEffectElement.value=r})("change",function(){De(e);const r=ge();return r.applyImageEffectElement.value=r.applyImageEffectElement.value?"applyImageEffect":""}),J(),K(3,"b",12),be(4,"\u753b\u50cf\u52b9\u679c\u53cd\u6620"),J()(),Ge()}if(2&n){const e=ge();U(2),ct("checked",e.applyImageEffectElement.value?"checked":""),te("ngModel",e.applyImageEffectElement.value)}}function Nj(n,t){if(1&n){const e=Xe();Ve(0),K(1,"label",18)(2,"input",19),Te("ngModelChange",function(r){return De(e),ge().applyRollElement.value=r})("change",function(){De(e);const r=ge();return r.applyRollElement.value=r.applyRollElement.value?"applyRoll":""}),J(),K(3,"b",12),be(4,"\u56de\u8ee2\u53cd\u6620"),J()(),Ge()}if(2&n){const e=ge();U(2),ct("checked",e.applyRollElement.value?"checked":""),te("ngModel",e.applyRollElement.value)}}function Fj(n,t){if(1&n){const e=Xe();Ve(0),K(1,"label",20)(2,"input",19),Te("ngModelChange",function(r){return De(e),ge().applyDialogElement.value=r})("change",function(){De(e);const r=ge();return r.applyDialogElement.value=r.applyDialogElement.value?"applyDialog":""}),J(),K(3,"b",12),be(4,"\u{1f4ad}"),J()(),Ge()}if(2&n){const e=ge();U(2),ct("checked",e.applyDialogElement.value?"checked":""),te("ngModel",e.applyDialogElement.value)}}const Oj=function(n){return{"disabled-text":n}};function Rj(n,t){if(1&n){const e=Xe();Ve(0),it(1,"br"),K(2,"button",21),Te("click",function(){return De(e),ge().testStandUp()}),K(3,"b"),be(4,"\u30c6\u30b9\u30c8 (\u81ea\u5206\u3060\u3051\u898b\u308b)"),K(5,"sup",22),be(6,"*"),J()()(),K(7,"label",23)(8,"input",19),Te("ngModelChange",function(r){return De(e),ge().positionElement.currentValue=r})("change",function(){De(e);const r=ge();return r.positionElement.currentValue=r.positionElement.currentValue?"posSpecialize":""}),J(),K(9,"b",12),be(10,"Pos\u500b\u5225\u6307\u5b9a: "),J()(),K(11,"span",24)(12,"input",25),Te("ngModelChange",function(r){return De(e),ge().positionElement.value=r}),J(),K(13,"input",26),Te("ngModelChange",function(r){return De(e),ge().positionElement.value=r}),J(),K(14,"b",27),be(15,"%"),J()(),Ge()}if(2&n){const e=ge();U(8),ct("checked",e.positionElement.currentValue?"checked":""),te("ngModel",e.positionElement.currentValue),U(4),te("ngModel",e.positionElement.value)("disabled",!e.positionElement.currentValue),U(1),te("ngModel",e.positionElement.value)("disabled",!e.positionElement.currentValue),U(1),te("ngClass",ut(7,Oj,!e.positionElement.currentValue))}}function Bj(n,t){if(1&n){const e=Xe();Ve(0),it(1,"br"),K(2,"span",24)(3,"b",28),be(4,"Height (0=\u6307\u5b9a\u306a\u3057): "),J(),K(5,"input",29),Te("ngModelChange",function(r){return De(e),ge().heightElement.value=r}),J(),K(6,"input",30),Te("ngModelChange",function(r){return De(e),ge().heightElement.value=r}),J(),K(7,"b",31),be(8,"%"),J()(),K(9,"span",32)(10,"b",28),be(11,"AdjY: "),J(),K(12,"input",33),Te("ngModelChange",function(r){return De(e),ge().heightElement.currentValue=r}),J(),K(13,"b",31),be(14,"%"),J()(),Ge()}if(2&n){const e=ge();U(5),te("ngModel",e.heightElement.value),U(1),te("ngModel",e.heightElement.value),U(6),te("ngModel",e.heightElement.currentValue)}}function Lj(n,t){if(1&n){const e=Xe();K(0,"div")(1,"textarea",34),Te("ngModelChange",function(r){return De(e),ge().postfixElement.value=r}),J()()}if(2&n){const e=ge();U(1),te("ngModel",e.postfixElement.value)}}const zj=function(n){return{"current-icon":n}};function jj(n,t){if(1&n){const e=Xe();K(0,"div",39)(1,"img",40),Te("click",function(){De(e);const r=ge().$implicit;return ge(3).selectImage(r.identifier)}),Ct(2,"safe"),J()()}if(2&n){const e=ge().$implicit,i=ge(3);te("ngClass",ut(6,zj,i.isSelectedImage(e.identifier))),U(1),te("src",xt(2,3,e.url,"resourceUrl"),Jt)("alt",e.name)}}function Hj(n,t){if(1&n&&(Ve(0),xe(1,jj,3,8,"div",38),Ge()),2&n){const e=t.$implicit;U(1),te("ngIf",0<e.url.length)}}function Uj(n,t){if(1&n&&(K(0,"div",36),xe(1,Hj,2,1,"ng-container",37),J()),2&n){const e=ge(2);U(1),te("ngForOf",e.imageList)}}function Vj(n,t){1&n&&(K(0,"div"),be(1,"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u753b\u50cf\u3001\u9854IC\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),J())}function Gj(n,t){if(1&n&&(K(0,"div"),xe(1,Uj,2,1,"div",35),xe(2,Vj,2,0,"div",2),J()),2&n){const e=ge();U(1),te("ngIf",e.imageList&&e.imageList.length>0),U(1),te("ngIf",!e.imageList||0==e.imageList.length)}}let NT=(()=>{class n{constructor(e){this.modalService=e,this.standElement=null,this.imageList=[],this.gameCharacter=null,this.isSpeaking=!1,this._imageFile=Ht.Empty,this.standConditionType=wi}ngOnInit(){}get standImage(){if(!this.standElement)return this._imageFile;let e=null;if(this.isSpeaking&&(e=this.standElement.getFirstElementByName("speakingImageIdentifier"),e||(e=this.standElement.appendChild(ht.create("speakingImageIdentifier",Ht.Empty.identifier,{type:"image"},"speakingImageIdentifier_"+this.standElement.identifier)))),(!e||!e.value||e.value==Ht.Empty.identifier)&&(e=this.standElement.getFirstElementByName("imageIdentifier")),e){if(this._imageFile.identifier!==e.value){let i=kt.instance.get(e.value);this._imageFile=i||Ht.Empty}}else{let i=Ht.createEmpty("stand_no_image").toContext();i.url="./assets/images/nc96424.png",this._imageFile=kt.instance.add(i),this.standElement.appendChild(ht.create("imageIdentifier",this._imageFile.identifier,{type:"image"},"imageIdentifier_"+this.standElement.identifier))}return this._imageFile}get nameElement(){return this.standElement?this.standElement.getFirstElementByName("name")||this.standElement.appendChild(ht.create("name","",{},"name_"+this.standElement.identifier)):null}get heightElement(){return this.standElement?this.standElement.getFirstElementByName("height")||this.standElement.appendChild(ht.create("height",0,{currentValue:0},"height_"+this.standElement.identifier)):null}get conditionTypeElement(){return this.standElement?this.standElement.getFirstElementByName("conditionType")||this.standElement.appendChild(ht.create("conditionType",wi.Default,{},"conditionType_"+this.standElement.identifier)):null}get postfixElement(){return this.standElement?this.standElement.getFirstElementByName("postfix")||this.standElement.appendChild(ht.create("postfix","",{},"postfix_"+this.standElement.identifier)):null}get applyImageEffectElement(){return this.standElement?this.standElement.getFirstElementByName("applyImageEffect")||this.standElement.appendChild(ht.create("applyImageEffect","",{},"applyImageEffect_"+this.standElement.identifier)):null}get applyRollElement(){return this.standElement?this.standElement.getFirstElementByName("applyRoll")||this.standElement.appendChild(ht.create("applyRoll","",{},"applyRoll_"+this.standElement.identifier)):null}get applyDialogElement(){return this.standElement?this.standElement.getFirstElementByName("applyDialog")||this.standElement.appendChild(ht.create("applyDialog","applyDialog",{},"applyDialog_"+this.standElement.identifier)):null}get showNameElement(){return this.standElement?this.standElement.getFirstElementByName("showName")||this.standElement.appendChild(ht.create("showName","showName",{},"showName_"+this.standElement.identifier)):null}get positionElement(){return this.standElement?this.standElement.getFirstElementByName("position")||this.standElement.appendChild(ht.create("position",0,{currentValue:""},"position_"+this.standElement.identifier)):null}get isApplyImageEffect(){let e=this.applyImageEffectElement;return!(!e||!e.value)}get isApplyRoll(){let e=this.applyRollElement;return!(!e||!e.value)}get isApplyDialog(){let e=this.applyDialogElement;return!(!e||!e.value)}get isShowName(){let e=this.showNameElement;return!(!e||!e.value)}get isSpeakable(){if(!this.standElement)return!1;const e=this.standElement.getFirstElementByName("speakingImageIdentifier");return e&&e.value&&e.value!==Ht.Empty.identifier}openModal(e="imageIdentifier",i=!1){if(!this.standElement)return;let r=[],s=this.standElement.getFirstElementByName(e);s?r=[s.value+""]:s=this.standElement.appendChild(ht.create(e,"",{type:"image"},e+"_"+this.standElement.identifier)),this.modalService.open(Lo,{isAllowedEmpty:i,currentImageIdentifires:r}).then(o=>{!o||(s.value=o)})}openSpeakingModal(){this.openModal("speakingImageIdentifier",!0)}remove(){!this.standElement||this.standElement.parent.removeChild(this.standElement)}selectImage(e){if(!this.standElement)return;let i=!1;for(let r of this.standElement.getElementsByName("targetImageIdentifier")){let s=!0;for(let o of this.imageList)if(o.identifier==r.value){s=!1;break}s?this.standElement.removeChild(r):r.value==e&&(i=!0,this.standElement.removeChild(r))}i||this.standElement.appendChild(ht.create("targetImageIdentifier",e,{},"targetImageIdentifier_"+ns.generateUuid()))}isSelectedImage(e){let i=this.standElement.getElementsByName("targetImageIdentifier");for(let r of i)if(r.value==e)return!0;return!1}testStandUp(){Fe.trigger("POPUP_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier,standIdentifier:this.standElement.identifier,color:this.gameCharacter.chatPalette?this.gameCharacter.chatPalette.color:null}),Fe.trigger("POPUP_CHAT_BALLOON",{characterIdentifier:this.gameCharacter.identifier,text:"\u3053\u308c\u306f\u30c6\u30b9\u30c8\u3067\u3059\u3001\u3042\u306a\u305f\u306b\u3060\u3051\u898b\u3048\u3066\u3044\u307e\u3059\u3002\u30b9\u30bf\u30f3\u30c9\u306e\u8a2d\u5b9a\u3092\u884c\u3046\u969b\u306f\u3001\u30e1\u30cb\u30e5\u30fc\u306e\u300c\u500b\u4eba\u8a2d\u5b9a\u300d\u304b\u3089\u300c\u900f\u660e\u5316\u3001\u81ea\u52d5\u9000\u53bb\u300d\u3092\u30aa\u30d5\u306b\u3059\u308b\u3068\u5fae\u8abf\u6574\u304c\u884c\u3044\u3084\u3059\u304f\u306a\u308a\u307e\u3059\u3002",color:this.gameCharacter.chatPalette?this.gameCharacter.chatPalette.color:null,dialogTest:!0})}}return n.\u0275fac=function(e){return new(e||n)(Le(kn))},n.\u0275cmp=Zt({type:n,selectors:[["stand-element"]],inputs:{standElement:"standElement",imageList:"imageList",gameCharacter:"gameCharacter",isSpeaking:"isSpeaking"},decls:20,vars:14,consts:[[1,"stand-container"],[1,"stand-image-container"],[4,"ngIf"],[2,"display","flex","flex-direction","column","padding-left","3px","width","100%"],[2,"font-size","9px",3,"click"],[3,"ngStyle"],[1,"inverser",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"stand-image",3,"src","ngClass","dblclick"],[1,"stand-image-button",2,"font-size","smaller","padding","2px 3px",3,"click"],["style","position: absolute; margin-top: -26px; margin-left: 120px; font-size: 22px; filter: grayscale(100%); opacity: 0.5; cursor: default;",4,"ngIf"],[2,"position","absolute","margin-top","-26px","margin-left","120px","font-size","22px","filter","grayscale(100%)","opacity","0.5","cursor","default"],[2,"font-size","smaller"],["type","text","placeholder","Name",2,"width","7em",3,"ngModel","ngModelChange"],[2,"width","15.5em",3,"ngModel","ngModelChange"],[3,"value"],[2,"margin-left","1em"],["type","text","placeholder","Tag",2,"width","3em",3,"ngModel","ngModelChange"],[2,"margin-right","0.6em"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"margin-right","0.2em"],[2,"font-size","9px","margin-right","1em",3,"click"],[1,"self-only"],[2,"margin-right","0.3em"],[2,"white-space","nowrap","font-size","smaller"],["type","range","min","0","max","100",2,"width","140px",3,"ngModel","disabled","ngModelChange"],["type","number","min","0","max","100",2,"width","3em","text-align","right",3,"ngModel","disabled","ngModelChange"],[2,"display","inline-block","font-size","smaller","margin-left","3px",3,"ngClass"],[2,"display","inline-block","margin-left","3px"],["type","range","min","0","max","100",2,"width","130px",3,"ngModel","ngModelChange"],["type","number","min","0","max","200",2,"width","3em","text-align","right",3,"ngModel","ngModelChange"],[2,"display","inline-block","font-size","smaller","margin-left","3px"],[2,"white-space","nowrap","margin-left","0.8em","font-size","smaller"],["type","number","min","-100","max","100",2,"width","3.4em","text-align","right",3,"ngModel","ngModelChange"],["placeholder","1\u884c\u306b\u4e00\u3064\u3001\u5192\u982d@\u3092\u4ed8\u3051\u308b\u3068\u30de\u30c3\u30c1\u6642\u306b\u30c6\u30ad\u30b9\u30c8\u304b\u3089\u5207\u308a\u53d6\u308a\r\n@\u6012\u308a\r\n@\u5fc5\u6bba\u6280",2,"width","100%","margin-top","3px","height","2.4rem",3,"ngModel","ngModelChange"],["style","display: flex; flex-wrap: wrap; margin-right: -30px;",4,"ngIf"],[2,"display","flex","flex-wrap","wrap","margin-right","-30px"],[4,"ngFor","ngForOf"],["class","icon-image-box",3,"ngClass",4,"ngIf"],[1,"icon-image-box",3,"ngClass"],[3,"src","alt","click"]],template:function(e,i){1&e&&(K(0,"div")(1,"div",0)(2,"div",1),xe(3,Sj,11,26,"ng-container",2),J(),K(4,"div",3)(5,"div"),xe(6,Mj,3,1,"ng-container",2),xe(7,kj,16,7,"ng-container",2),xe(8,Dj,5,1,"ng-container",2),J(),K(9,"div"),xe(10,Aj,5,2,"ng-container",2),xe(11,Pj,5,2,"ng-container",2),xe(12,Nj,5,2,"ng-container",2),xe(13,Fj,5,2,"ng-container",2),K(14,"button",4),Te("click",function(){return i.openSpeakingModal()}),be(15,"\u53e3\u30d1\u30af\u753b\u50cf (APNG\u306a\u3069)"),J(),xe(16,Rj,16,9,"ng-container",2),xe(17,Bj,15,3,"ng-container",2),J(),xe(18,Lj,2,1,"div",2),xe(19,Gj,3,2,"div",2),J()()()),2&e&&(U(3),te("ngIf",i.standImage),U(3),te("ngIf",i.nameElement),U(1),te("ngIf",i.conditionTypeElement),U(1),te("ngIf",i.nameElement),U(2),te("ngIf",i.showNameElement),U(1),te("ngIf",i.applyImageEffectElement),U(1),te("ngIf",i.applyRollElement),U(1),te("ngIf",i.applyDialogElement),U(1),Ke("font-weight",i.isSpeakable?"bolder":"normal"),U(2),te("ngIf",i.positionElement),U(1),te("ngIf",i.heightElement),U(1),te("ngIf",i.postfixElement&&(i.conditionTypeElement.value==i.standConditionType.Postfix||i.conditionTypeElement.value==i.standConditionType.PostfixOrImage||i.conditionTypeElement.value==i.standConditionType.PostfixAndImage)),U(1),te("ngIf",i.conditionTypeElement.value==i.standConditionType.Image||i.conditionTypeElement.value==i.standConditionType.PostfixOrImage||i.conditionTypeElement.value==i.standConditionType.PostfixAndImage))},directives:[_n,Zi,Wn,fi,hi,oi,es,zr,jr,Jr,ms,So,Io,gs,ei],pipes:[ti],styles:[".stand-container[_ngcontent-%COMP%]{display:flex;flex-direction:row}.stand-image-container[_ngcontent-%COMP%]{width:150px;height:150px}.stand-image[_ngcontent-%COMP%]{width:150px;height:150px;-o-object-fit:contain;object-fit:contain;transform-origin:bottom;z-index:5}.stand-image-button[_ngcontent-%COMP%]{display:block;margin-top:-154px;margin-left:-4px;position:relative;z-index:10}.postfix-text[_ngcontent-%COMP%]{width:8em}.position-indicate[_ngcontent-%COMP%]{display:inline-block;font-size:smaller;width:3em}.remove-button[_ngcontent-%COMP%]{font-weight:bolder;color:red;background-color:transparent}.remove-button[_ngcontent-%COMP%]:hover{background-color:#eee}.icon-image-box[_ngcontent-%COMP%]{position:relative;width:50px;height:50px;max-width:50px;max-height:50px;border-radius:.5rem;color:#000;z-index:100;margin-top:1px;margin-bottom:1px;margin-left:2px}.icon-image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:.5rem;border:2px solid transparent}.icon-image-box[_ngcontent-%COMP%]:hover{z-index:600}.icon-image-box[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{border:2px dotted rgba(255,0,0,40)}.icon-image-box.current-icon[_ngcontent-%COMP%]{z-index:500}.icon-image-box.current-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid red}.icon-image-box[_ngcontent-%COMP%]:not(.current-icon){z-index:400}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #fff)}.disabled-text[_ngcontent-%COMP%]{color:gray}.self-only[_ngcontent-%COMP%]{color:red}"]}),n})();function qj(n,t){if(1&n){const e=Xe();K(0,"div",14)(1,"div",15)(2,"div",16)(3,"input",17),Te("click",function(){const s=De(e).index;return ge().overviewIndex=s}),J()(),K(4,"div",18),it(5,"stand-element",19,20),J(),K(7,"div",21)(8,"button",22),Te("click",function(){const r=De(e),s=r.$implicit,o=r.index;return ge().delele(s,o)}),be(9,"\xd7"),J(),K(10,"button",23),Te("click",function(){const s=De(e).$implicit;return ge().upStandIndex(s)}),be(11,"\u2191"),J(),K(12,"button",24),Te("click",function(){const s=De(e).$implicit;return ge().downStandIndex(s)}),be(13,"\u2193"),J()()(),it(14,"hr"),J()}if(2&n){const e=t.$implicit,i=t.index,r=ge();U(1),Ke("border-color",r.overviewIndex==i?"red":"transparent"),U(2),Wi("name","",r.panelId,"_overviewIndex"),ct("value",i),te("checked",r.overviewIndex==i),U(2),te("standElement",e)("imageList",r.imageList)("gameCharacter",r.character)}}function Wj(n,t){if(1&n){const e=Xe();K(0,"button",12),Te("click",function(){return De(e),ge().restore()}),be(1,"\u76f4\u524d\u306b\u524a\u9664\u3057\u305f\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u3092\u623b\u3059"),J()}}let Qp=(()=>{class n{constructor(e,i,r){this.panelService=e,this.pointerDeviceService=i,this.modalService=r,this.character=null,this.standSettingXML="",this.isSpeaking=!1}get standElements(){return this.character.standList.standElements}get imageList(){if(!this.character)return[];let e=[],i={};const s=this.character.imageDataElement.getElementsByName("imageIdentifier").concat(this.character.imageDataElement.getElementsByName("faceIcon"));for(let o of s){if(i[o.value])continue;let c=this.imageElementToFile(o);c&&(i[o.value]=!0,e.push(c))}return e}get position(){return this.character&&this.character.standList?this.character.standList.position:0}set position(e){!this.character||!this.character.standList||(this.character.standList.position=e)}get height(){return this.character&&this.character.standList?this.character.standList.height:0}set height(e){!this.character||!this.character.standList||(this.character.standList.height=e)}get overviewIndex(){return this.character&&this.character.standList?this.character.standList.overviewIndex:-1}set overviewIndex(e){!this.character||!this.character.standList||(this.character.standList.overviewIndex=e)}ngOnInit(){Promise.resolve().then(()=>this.updatePanelTitle()),Fe.register(this).on("DELETE_GAME_OBJECT",-1e3,e=>{this.character&&this.character.identifier===e.data.identifier&&this.panelService.close()}),this.panelId=ns.generateUuid()}ngAfterViewInit(){this._intervalId=setInterval(()=>{this.isSpeaking=!this.isSpeaking,this.standElementComponents.forEach(e=>{e.isSpeaking=this.isSpeaking})},3600)}ngOnDestroy(){clearInterval(this._intervalId),Fe.unregister(this)}updatePanelTitle(){this.panelService.title=this.character.name+" \u306e\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a"}add(){this.character.standList.add(this.character.imageFile.identifier),this.standSettingXML=""}delele(e,i){Fe.call("DELETE_STAND_IMAGE",{characterIdentifier:this.character.identifier,identifier:e.identifier}),this.character&&this.character.standList&&this.modalService.open(Qi,{title:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u306e\u524a\u9664",text:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u3092\u524a\u9664\u3057\u307e\u3059\u304b\uff1f",type:Ci.OK_CANCEL,materialIcon:"person_off",action:()=>{this.standSettingXML=e.toXml(),this.character.standList.removeChild(e)&&(this.character.standList.overviewIndex==i?this.character.standList.overviewIndex=-1:this.character.standList.overviewIndex>i&&(this.character.standList.overviewIndex-=1))}})}restore(){if(!this.standSettingXML)return;let e=Zn.instance.parseXml(this.standSettingXML);this.character.standList.appendChild(e),this.standSettingXML=""}upStandIndex(e){this.standSettingXML="";let i=this.character.standList,r=i.children.indexOf(e);0<r&&(i.insertBefore(e,i.children[r-1]),this.character.standList.overviewIndex==r?this.character.standList.overviewIndex-=1:this.character.standList.overviewIndex==r-1&&(this.character.standList.overviewIndex+=1))}downStandIndex(e){this.standSettingXML="";let i=this.character.standList,r=i.children.indexOf(e);r<i.children.length-1&&(i.insertBefore(i.children[r+1],e),this.character.standList.overviewIndex==r?this.character.standList.overviewIndex+=1:this.character.standList.overviewIndex==r+1&&(this.character.standList.overviewIndex-=1))}helpStandSeteing(){let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(du,{left:e.x,top:e.y,width:600,height:590});r.title="\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u30d8\u30eb\u30d7",r.text='\u3000\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306e\u30b9\u30bf\u30f3\u30c9\u306e\u540d\u524d\u3001\u4f4d\u7f6e\u3068\u753b\u50cf\u306e\u9ad8\u3055\uff08\u305d\u308c\u305e\u308c\u753b\u9762\u30b5\u30a4\u30ba\u306b\u5bfe\u3059\u308b\u76f8\u5bfe\u6307\u5b9a\uff09\u3001\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u306b\u30b9\u30bf\u30f3\u30c9\u304c\u8868\u793a\u3055\u308c\u308b\u6761\u4ef6\u3092\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\n\n\u3000\u30b9\u30bf\u30f3\u30c9\u306b\u540d\u524d\u3092\u8a2d\u5b9a\u3057\u305f\u5834\u5408\u3001\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3001\u30c1\u30e3\u30c3\u30c8\u30d1\u30cd\u30eb\u306e\u30ea\u30b9\u30c8\u306b\u8868\u793a\u3055\u308c\u3001\u9078\u629e\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\u307e\u305f\u3001\u30bf\u30b0\u3092\u8a2d\u5b9a\u3057\u305f\u5834\u5408\u3001\u7570\u306a\u308b\u30bf\u30b0\u3067\u306f\u540c\u3058\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3067\u3042\u3063\u3066\u3082\u767b\u5834\u3001\u9000\u53bb\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u304c\u884c\u308f\u308c\u307e\u3059\u3002\n\n\u3000\u753b\u50cf\u306e\u4f4d\u7f6e\u3068\u9ad8\u3055\u306f\u500b\u5225\u6307\u5b9a\u3082\u53ef\u80fd\u3067\u3059\u3001\u4f4d\u7f6e\u306e\u500b\u5225\u6307\u5b9a\u306f\u30c1\u30a7\u30c3\u30af\u306a\u3057\u3001\u9ad8\u3055\u306f0\u3068\u3057\u305f\u5834\u5408\u306b\u5168\u4f53\u306e\u8a2d\u5b9a\u304c\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002\u7e26\u4f4d\u7f6e\u8abf\u6574(AdjY)\u306f\u3001\u30b9\u30bf\u30f3\u30c9\u753b\u50cf\u306e\u9ad8\u3055\u306b\u5bfe\u3059\u308b\u76f8\u5bfe\u6307\u5b9a\u3068\u306a\u308a\u307e\u3059\uff08\u4f8b\u3048\u3070\u3001-50%\u3068\u3059\u308b\u3068\u753b\u50cf\u306e\u4e0b\u534a\u5206\u304c\u753b\u9762\u7aef\u3088\u308a\u4e0b\u306b\u96a0\u308c\u307e\u3059\uff09\u3002\n\n\u3000\u6761\u4ef6\u306e\u300c\u6307\u5b9a\u753b\u50cf\u300d\u306f\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u753b\u50cf\u3042\u308b\u3044\u306f\u9854IC\u3067\u3059\u3002\u307e\u305f\u3001\u7279\u5225\u306a\u6761\u4ef6\u3068\u3057\u3066\u5e38\u306b\u3001\u30c1\u30e3\u30c3\u30c8\u30c6\u30ad\u30b9\u30c8\u306e\u672b\u5c3e\u304c"@\u9000\u53bb"\u307e\u305f\u306f"@farewell"\u306e\u5834\u5408\u306f\u3001\u305d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306e\u30b9\u30bf\u30f3\u30c9\u3092\u9000\u53bb\u3055\u305b\u307e\u3059\u3002\n\n\u3000\u512a\u5148\u9806\u4f4d\u306f\u9ad8\u3044\u3082\u306e\u304b\u3089\n\n\u3000\u3000\uff11. "@\u9000\u53bb"\u3001"@farewell"\u306b\u3088\u308b\u9000\u53bb\n\u3000\u3000\uff12. \u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3001\u30c1\u30e3\u30c3\u30c8\u30d1\u30cd\u30eb\u306e\u30ea\u30b9\u30c8\u3067\u9078\u629e\u3057\u305f\u540d\u524d\n\u3000\u3000\uff13. \u300c\u6307\u5b9a\u753b\u50cf \u304b\u3064 \u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u300d\n\u3000\u3000\uff14. \u300c\u6307\u5b9a\u753b\u50cf \u307e\u305f\u306f \u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u300d\n\u3000\u3000\uff15. \u300c\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u300d\n\u3000\u3000\uff16. \u300c\u6307\u5b9a\u753b\u50cf\u300d\n\n\u3000\u3069\u306e\u6761\u4ef6\u3082\u6e80\u305f\u3055\u306a\u3044\u5834\u5408\u300c\u30c7\u30d5\u30a9\u30eb\u30c8\u300d\u306e\u3082\u306e\u304c\u4f7f\u7528\u3055\u308c\u3001\u540c\u3058\u512a\u5148\u9806\u4f4d\u306e\u6761\u4ef6\u304c\u8907\u6570\u3042\u308b\u5834\u5408\u306f\u30e9\u30f3\u30c0\u30e0\u30671\u3064\u304c\u9078\u629e\u3055\u308c\u307e\u3059\u3002\n\n\u3000\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u4e00\u81f4\u3092\u5224\u5b9a\u3059\u308b\u969b\u3001\u5168\u89d2\u534a\u89d2\u3001\u30a2\u30eb\u30d5\u30a1\u3079\u30c3\u30c8\u306e\u5927\u6587\u5b57\u5c0f\u6587\u5b57\u306f\u533a\u5225\u3055\u308c\u307e\u305b\u3093\u3002\n\u3000\u307e\u305f\u3001"@\u9000\u53bb"\u3001"@farewell"\u306b\u3088\u308b\u9000\u53bb\u6642\u3001\u3042\u308b\u3044\u306f"@\u7b11\u3044"\u306e\u3088\u3046\u306b\u5148\u982d\u304c"@"\u3067\u59cb\u307e\u308b\u6761\u4ef6\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u5834\u5408\u3001\uff08\u30b9\u30bf\u30f3\u30c9\u306e\u6709\u52b9\u7121\u52b9\u3001\u6761\u4ef6\u3092\u6e80\u305f\u3059\u304b\u306b\u95a2\u308f\u3089\u305a\uff09\u305d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3067\u306e\u9001\u4fe1\u6642\u306b\u3001\u6761\u4ef6\u306b\u4e00\u81f4\u3059\u308b\u30c1\u30e3\u30c3\u30c8\u30c6\u30ad\u30b9\u30c8\u672b\u5c3e\u306e@\u4ee5\u4e0b\u306f\u5207\u308a\u843d\u3068\u3055\u308c\u307e\u3059\u3002'}imageElementToFile(e){return e?kt.instance.get(e.value):null}}return n.\u0275fac=function(e){return new(e||n)(Le(In),Le(ai),Le(kn))},n.\u0275cmp=Zt({type:n,selectors:[["app-stand-setting"]],viewQuery:function(e,i){if(1&e&&on(NT,5),2&e){let r;sn(r=an())&&(i.standElementComponents=r)}},inputs:{character:"character"},decls:27,vars:10,consts:[[2,"margin-bottom","4px"],[2,"float","right",3,"click"],[1,"position-indicate"],["type","range","min","0","max","100",2,"width","350px",3,"ngModel","ngModelChange"],["type","number","min","0","max","100",2,"width","3em","text-align","right","margin-right","3px",3,"ngModel","ngModelChange"],["sytle","margin-left: 3px; margin-right: 1em "],["type","number","min","0","max","200",2,"width","3em","text-align","right","margin-right","3px",3,"ngModel","ngModelChange"],[1,"overview-selecter",2,"padding","0px","width","695px"],[2,"font-size","smaller","font-weight","bolder"],["type","radio","value","-1",3,"name","checked","click"],[2,"display","flex","flex-direction","row","flex-wrap","wrap"],["style","width: 700px",4,"ngFor","ngForOf"],[3,"click"],[3,"click",4,"ngIf"],[2,"width","700px"],[1,"overview-selecter",2,"display","flex","flex-direction","row","justify-content","space-between"],[2,"display","flex","align-items","center","justify-content","center"],["type","radio",2,"z-index","10",3,"name","value","checked","click"],[2,"margin-left","-1em","margin-right","-1em"],[3,"standElement","imageList","gameCharacter"],["standElementComponent",""],[2,"text-align","right","width","3em"],[1,"remove-button","danger",3,"click"],[1,"remove-button",2,"margin-top","5px",3,"click"],[1,"remove-button",2,"margin-top","2px",3,"click"]],template:function(e,i){1&e&&(K(0,"div",0)(1,"button",1),Te("click",function(){return i.helpStandSeteing()}),be(2,"?"),J(),K(3,"div",2)(4,"b"),be(5,"Pos: "),J(),K(6,"input",3),Te("ngModelChange",function(s){return i.position=s}),J(),K(7,"input",4),Te("ngModelChange",function(s){return i.position=s}),J(),K(8,"b",5),be(9,"\uff05\u3000"),J()(),K(10,"div",2)(11,"b"),be(12,"Height (0=\u5143\u753b\u50cf\u306e\u307e\u307e): "),J(),K(13,"input",3),Te("ngModelChange",function(s){return i.height=s}),J(),K(14,"input",6),Te("ngModelChange",function(s){return i.height=s}),J(),K(15,"b",5),be(16,"\uff05"),J()()(),K(17,"div",7)(18,"label",8)(19,"input",9),Te("click",function(){return i.overviewIndex=-1}),J(),be(20," \u30b9\u30bf\u30f3\u30c9\u753b\u50cf\u3092\u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u4f7f\u7528\u3057\u306a\u3044"),J()(),it(21,"hr"),K(22,"div",10),xe(23,qj,15,8,"div",11),J(),K(24,"button",12),Te("click",function(){return i.add()}),be(25,"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u306e\u8ffd\u52a0"),J(),xe(26,Wj,2,0,"button",13)),2&e&&(U(6),te("ngModel",i.position),U(1),te("ngModel",i.position),U(6),te("ngModel",i.height),U(1),te("ngModel",i.height),U(3),Ke("border-color",-1==i.overviewIndex?"red":"transparent"),U(2),Wi("name","",i.panelId,"_overviewIndex"),te("checked",-1==i.overviewIndex),U(4),te("ngForOf",i.standElements),U(3),te("ngIf",i.standSettingXML))},directives:[ms,fi,hi,oi,So,Io,gs,ei,NT,_n],styles:[".position-indicate[_ngcontent-%COMP%]{display:inline-block;font-size:smaller}.description[_ngcontent-%COMP%]{font-size:smaller}.remove-button[_ngcontent-%COMP%]{display:inline-block;font-weight:bolder;font-size:smaller;margin-top:-4px;margin-right:-1px}.overview-selecter[_ngcontent-%COMP%]{border:2px solid red;border-radius:8px;padding-top:1px;padding-bottom:4px}input[type=radio][_ngcontent-%COMP%]{width:1.5em;height:1.5em}"]}),n})();var Jp;let ni=Jp=class extends $i{constructor(t=ns.generateUuid()){super(t),this.isLocked=!1,this.rotate=0,this.followingCharctorIdentifier=null,this.followingCounterDummy=0,this.offSetX=!1,this.offSetY=!1,this.type="CORN",this.subDivisionSnapPolygonal=!0,this.fillType=1,this.isExpandByFollowing=!1,this.isFollowAltitude=!1,this.followingCharactorCache=null,this.gridSize=50,this.isAltitudeIndicate=!0,this.followingCharctorIdentifier=null}get name(){return this.getCommonValue("name","")}get length(){return this.getCommonValue("length",1)}get width(){return this.getCommonValue("width",1)}get opacity(){let t=this.getElement("opacity",this.commonDataElement),e=t?t.currentValue/t.value:1;return Number.isNaN(e)?1:e}get rangeColor(){let t=this.getElement("color",this.commonDataElement);return t?t.value+"":"#ff0000"}set rangeColor(t){this.setCommonValue("color",t)}get gridColor(){let t=this.getElement("color",this.commonDataElement);return t?t.currentValue+"":"#ffff00"}set gridColor(t){let e=this.getElement("color",this.commonDataElement);e&&(e.currentValue=t)}get isApplyWidth(){return"LINE"===this.type||"CORN"===this.type}get followingCharactor(){if(this.followingCharctorIdentifier){if(!this.followingCharactorCache||this.followingCharactorCache.identifier!==this.followingCharctorIdentifier){let t=lt.instance.get(this.followingCharctorIdentifier);t&&t instanceof Vt?this.followingCharactorCache=t:(this.followingCharctorIdentifier=null,this.followingCharactorCache=null)}}else this.followingCharactorCache=null;return this.followingCharactorCache}set followingCharactor(t){t?(this.followingCharactorCache=t,this.followingCharctorIdentifier=t.identifier):(this.followingCharactorCache=null,this.followingCharctorIdentifier=null)}followingCounterDummyCount(){this.followingCounterDummy++,this.followingCounterDummy>=50&&(this.followingCounterDummy=0)}following(){if(!this.followingCharactor||this.followingCharactor.isHideIn)return console.log("\u8ffd\u5f93\u5bfe\u8c61\u898b\u5931\u3044"),void(this.followingCharactor=null);this.location.x=this.followingCharactor.location.x+this.gridSize*this.followingCharactor.size/2,this.location.y=this.followingCharactor.location.y+this.gridSize*this.followingCharactor.size/2,this.posZ=this.followingCharactor.posZ,this.isFollowAltitude&&(this.altitude=this.followingCharactor.altitude),this.followingCounterDummyCount()}static create(t,e,i,r,s){let o=null;return o=s?new Jp(s):new Jp,o.createDataElements(),o.commonDataElement.appendChild(ht.create("name",t,{},"name_"+o.identifier)),o.commonDataElement.appendChild(ht.create("length",i,{},"length_"+o.identifier)),o.commonDataElement.appendChild(ht.create("width",e,{},"width_"+o.identifier)),o.commonDataElement.appendChild(ht.create("opacity",r,{type:"numberResource",currentValue:r},"opacity_"+o.identifier)),o.commonDataElement.appendChild(ht.create("color","#ff0000",{type:"colors",currentValue:"#ffff00"},"ccolor_"+o.identifier)),o.commonDataElement.appendChild(ht.create("altitude",0,{},"altitude_"+o.identifier)),o.initialize(),o}};B([rt()],ni.prototype,"isLocked",void 0),B([rt()],ni.prototype,"rotate",void 0),B([rt()],ni.prototype,"followingCharctorIdentifier",void 0),B([rt()],ni.prototype,"followingCounterDummy",void 0),B([rt()],ni.prototype,"offSetX",void 0),B([rt()],ni.prototype,"offSetY",void 0),B([rt()],ni.prototype,"type",void 0),B([rt()],ni.prototype,"subDivisionSnapPolygonal",void 0),B([rt()],ni.prototype,"fillType",void 0),B([rt()],ni.prototype,"isExpandByFollowing",void 0),B([rt()],ni.prototype,"isFollowAltitude",void 0),ni=Jp=B([Xn("range")],ni);var zo,rf=(()=>(function(n){n.ASC="ASC",n.DESC="DESC"}(rf||(rf={})),rf))();let jo=zo=class extends Ua{constructor(){super(...arguments),this.sortTag="name",this.sortOrder=rf.ASC,this.dataTag="HP MP \u654f\u6377\u5ea6 \u751f\u547d\u529b \u7cbe\u795e\u529b"}static get instance(){return zo._instance||(zo._instance=new zo("DataSummarySetting"),zo._instance.initialize()),zo._instance}get dataTags(){return this._dataTag!==this.dataTag&&(this._dataTag=this.dataTag,this._dataTags=null!=this.dataTag&&0<this.dataTag.trim().length?this.dataTag.trim().split(/\s+/):[]),this._dataTags}innerXml(){return""}parseInnerXml(t){let e=zo.instance.toContext();e.syncData=this.toContext().syncData,zo.instance.apply(e),zo.instance.update(),this.destroy()}};var eg;B([rt()],jo.prototype,"sortTag",void 0),B([rt()],jo.prototype,"sortOrder",void 0),B([rt()],jo.prototype,"dataTag",void 0),jo=zo=B([Xn("summary-setting")],jo);let is=eg=class extends $i{constructor(){super(...arguments),this.isLock=!1,this.blendType=0,this.isTransparentOnGMMode=!1}get name(){return this.getCommonValue("name","")}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get opacity(){let t=this.getElement("opacity",this.commonDataElement),e=t?t.currentValue/t.value:1;return Number.isNaN(e)?1:e}get fontsize(){let t=this.getElement("fontsize",this.commonDataElement);return!t&&this.commonDataElement&&this.commonDataElement.appendChild(ht.create("fontsize",18,{},"fontsize_"+this.identifier)),t?+t.value:18}set fontsize(t){this.setCommonValue("fontsize",t)}get text(){let t=this.getElement("text",this.commonDataElement);return!t&&this.commonDataElement&&this.commonDataElement.appendChild(ht.create("text","",{type:"note",currentValue:""},"text_"+this.identifier)),t?t.value+"":""}set text(t){this.setCommonValue("text",t)}get color(){let t=this.getElement("color",this.commonDataElement);return t?t.value+"":"#555555"}set color(t){this.setCommonValue("color",t)}get bgcolor(){let t=this.getElement("color",this.commonDataElement);return t?t.currentValue+"":"#0a0a0a"}set bgcolor(t){let e=this.getElement("color",this.commonDataElement);e&&(e.currentValue=t)}static create(t,e,i,r,s){let o=null;return o=s?new eg(s):new eg,o.createDataElements(),o.commonDataElement.appendChild(ht.create("name",t,{},"name_"+o.identifier)),o.commonDataElement.appendChild(ht.create("width",e,{},"width_"+o.identifier)),o.commonDataElement.appendChild(ht.create("height",i,{},"height_"+o.identifier)),o.commonDataElement.appendChild(ht.create("opacity",r,{type:"numberResource",currentValue:r},"opacity_"+o.identifier)),o.commonDataElement.appendChild(ht.create("fontsize",18,{},"fontsize_"+o.identifier)),o.commonDataElement.appendChild(ht.create("text","",{type:"note",currentValue:""},"text_"+o.identifier)),o.commonDataElement.appendChild(ht.create("color","#555555",{type:"colors",currentValue:"#0a0a0a"},"ccolor_"+o.identifier)),o.commonDataElement.appendChild(ht.create("altitude",0,{},"altitude_"+o.identifier)),o.initialize(),o}};B([rt()],is.prototype,"isLock",void 0),B([rt()],is.prototype,"blendType",void 0),B([rt()],is.prototype,"isTransparentOnGMMode",void 0),is=eg=B([Xn("table-mask")],is);var tg,da=(()=>(function(n){n[n.NULL=0]="NULL",n[n.FLOOR=1]="FLOOR",n[n.WALL=2]="WALL",n[n.ALL=3]="ALL"}(da||(da={})),da))(),ii=(()=>(function(n){n[n.NONE=0]="NONE",n[n.TOP=1]="TOP",n[n.BOTTOM=2]="BOTTOM",n[n.LEFT=3]="LEFT",n[n.RIGHT=4]="RIGHT"}(ii||(ii={})),ii))();let ar=tg=class extends $i{constructor(){super(...arguments),this.isLocked=!1,this.mode=da.ALL,this.rotate=0,this.isDropShadow=!0,this.isSurfaceShading=!0,this.isInteract=!0,this.isSlope=!1,this.slopeDirection=ii.NONE}get width(){return this.getCommonValue("width",1)}set width(t){this.setCommonValue("width",t)}get height(){return this.getCommonValue("height",1)}set height(t){this.setCommonValue("height",t)}get depth(){return this.getCommonValue("depth",1)}set depth(t){this.setCommonValue("depth",t)}get name(){return this.getCommonValue("name","")}set name(t){this.setCommonValue("name",t)}get wallImage(){return this.getImageFile("wall")}get floorImage(){return this.getImageFile("floor")}get hasWall(){return!!(this.mode&da.WALL)}get hasFloor(){return!!(this.mode&da.FLOOR)}static create(t,e,i,r,s,o,c){let m=null;return m=c?new tg(c):new tg,m.createDataElements(),m.commonDataElement.appendChild(ht.create("name",t,{},"name_"+m.identifier)),m.commonDataElement.appendChild(ht.create("width",e,{},"width_"+m.identifier)),m.commonDataElement.appendChild(ht.create("height",r,{},"height_"+m.identifier)),m.commonDataElement.appendChild(ht.create("depth",i,{},"depth_"+m.identifier)),m.commonDataElement.appendChild(ht.create("altitude",0,{},"altitude_"+m.identifier)),m.imageDataElement.appendChild(ht.create("wall",s,{type:"image"},"wall_"+m.identifier)),m.imageDataElement.appendChild(ht.create("floor",o,{type:"image"},"floor_"+m.identifier)),m.initialize(),m}};B([rt()],ar.prototype,"isLocked",void 0),B([rt()],ar.prototype,"mode",void 0),B([rt()],ar.prototype,"rotate",void 0),B([rt()],ar.prototype,"isDropShadow",void 0),B([rt()],ar.prototype,"isSurfaceShading",void 0),B([rt()],ar.prototype,"isInteract",void 0),B([rt()],ar.prototype,"isSlope",void 0),B([rt()],ar.prototype,"slopeDirection",void 0),ar=tg=B([Xn("terrain")],ar);var Us=(()=>(function(n){n[n.NONE=-1]="NONE",n[n.SQUARE=0]="SQUARE",n[n.HEX_VERTICAL=1]="HEX_VERTICAL",n[n.HEX_HORIZONTAL=2]="HEX_HORIZONTAL"}(Us||(Us={})),Us))(),ng=(()=>(function(n){n.NONE="",n.WHITE="white",n.BLACK="black"}(ng||(ng={})),ng))();let Li=class extends zn{constructor(){super(...arguments),this.name="\u30c6\u30fc\u30d6\u30eb",this.width=20,this.height=20,this.gridSize=50,this.imageIdentifier="imageIdentifier",this.backgroundImageIdentifier="imageIdentifier",this.backgroundFilterType=ng.NONE,this.selected=!1,this.gridType=Us.SQUARE,this.gridColor="#000000e6",this.isShowNumber=!0,this.gridHeight=0}get terrains(){let t=[];return this.children.forEach(e=>{e instanceof ar&&t.push(e)}),t}get masks(){let t=[];return this.children.forEach(e=>{e instanceof is&&t.push(e)}),t}onStoreAdded(){super.onStoreAdded(),this.selected&&Fe.trigger("SELECT_GAME_TABLE",{identifier:this.identifier})}};var ig;B([rt()],Li.prototype,"name",void 0),B([rt()],Li.prototype,"width",void 0),B([rt()],Li.prototype,"height",void 0),B([rt()],Li.prototype,"gridSize",void 0),B([rt()],Li.prototype,"imageIdentifier",void 0),B([rt()],Li.prototype,"backgroundImageIdentifier",void 0),B([rt()],Li.prototype,"backgroundFilterType",void 0),B([rt()],Li.prototype,"selected",void 0),B([rt()],Li.prototype,"gridType",void 0),B([rt()],Li.prototype,"gridColor",void 0),B([rt()],Li.prototype,"isShowNumber",void 0),Li=B([Xn("game-table")],Li);let Tr=ig=class extends $i{constructor(){super(...arguments),this.rotate=0,this.zindex=0,this.password="",this.isUpright=!0,this.isLocked=!1,this.isWhiteOut=!1}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get fontSize(){return this.getCommonValue("fontsize",1)}get title(){return this.getCommonValue("title","")}get text(){return this.getCommonValue("text","")}set text(t){this.setCommonValue("text",t)}get color(){return this.getCommonValue("color","#444444")}set color(t){this.setCommonValue("color",t)}toTopmost(){Q0(this)}static create(t,e,i=16,r=1,s=1,o){let c=o?new ig(o):new ig;return c.createDataElements(),c.commonDataElement.appendChild(ht.create("width",r,{},"width_"+c.identifier)),c.commonDataElement.appendChild(ht.create("height",s,{},"height_"+c.identifier)),c.commonDataElement.appendChild(ht.create("fontsize",i,{},"fontsize_"+c.identifier)),c.commonDataElement.appendChild(ht.create("title",t,{},"title_"+c.identifier)),c.commonDataElement.appendChild(ht.create("text",e,{type:"note",currentValue:e},"text_"+c.identifier)),c.commonDataElement.appendChild(ht.create("color","#444444",{type:"color"},"ccolor_"+c.identifier)),c.commonDataElement.appendChild(ht.create("altitude",0,{},"altitude_"+c.identifier)),c.initialize(),c}};B([rt()],Tr.prototype,"rotate",void 0),B([rt()],Tr.prototype,"zindex",void 0),B([rt()],Tr.prototype,"password",void 0),B([rt()],Tr.prototype,"isUpright",void 0),B([rt()],Tr.prototype,"isLocked",void 0),B([rt()],Tr.prototype,"isWhiteOut",void 0),Tr=ig=B([Xn("text-note")],Tr);let e1=class extends Ua{onStoreAdded(){super.onStoreAdded(),lt.instance.remove(this)}innerXml(){let t="",e=[];e=e.concat(lt.instance.getObjects(Li)),e=e.concat(lt.instance.getObjects(Vt)),e=e.concat(lt.instance.getObjects(ni)),e=e.concat(lt.instance.getObjects(Tr)),e=e.concat(lt.instance.getObjects(Gn)),e=e.concat(lt.instance.getObjects(On).filter(i=>null===i.parent)),e=e.concat(lt.instance.getObjects(or));for(let i of e)t+=i.toXml();return t}parseInnerXml(t){let e=[];e=e.concat(lt.instance.getObjects(Li)),e=e.concat(lt.instance.getObjects(is)),e=e.concat(lt.instance.getObjects(ar)),e=e.concat(lt.instance.getObjects(Vt)),e=e.concat(lt.instance.getObjects(ni)),e=e.concat(lt.instance.getObjects(Tr)),e=e.concat(lt.instance.getObjects(Gn)),e=e.concat(lt.instance.getObjects(On)),e=e.concat(lt.instance.getObjects(or));for(let i of e)i.destroy();for(let i=0;i<t.children.length;i++)Zn.instance.parseXml(t.children[i])}};e1=B([Xn("room")],e1);var Kj=X(1203);class Ir{constructor(t,e){this.ngZone=t,this.chatMessageService=e}saveRoomAsync(t="fly_\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",e){return this.chatMessageService.sendOperationLog(`\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf ${t}.zip \u3092\u4fdd\u5b58`),Ir.queue.add((i,r)=>i(this._saveRoomAsync(t,e)))}_saveRoomAsync(t="fly_\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",e){let i=[],r=this.convertToXml(new e1),s=this.convertToXml(go.instance),o=this.convertToXml(ho.instance),c=this.convertToXml(po.instance),m=this.convertToXml(jo.instance);i.push(new File([r],"fly_data.xml",{type:"text/plain"})),i.push(new File([s],"fly_chat.xml",{type:"text/plain"})),i.push(new File([o],"fly_rollTable.xml",{type:"text/plain"})),i.push(new File([c],"fly_cutIn.xml",{type:"text/plain"})),i.push(new File([m],"summary.xml",{type:"text/plain"}));let I=[];I=I.concat(this.searchImageFiles(r)),I=I.concat(this.searchImageFiles(s)),I=I.concat(this.searchImageFiles(c));for(const fe of I)fe.state===Bi.COMPLETE&&i.push(new File([fe.blob],fe.identifier+"."+ql.extension(fe.blob.type),{type:fe.blob.type}));let Z=this.convertToXml(wr.create(I));return i.push(new File([Z],"fly_imageTag.xml",{type:"text/plain"})),this.saveAsync(i,this.appendTimestamp(t),e)}saveGameObjectAsync(t,e="fly_xml_data",i){return this.chatMessageService.sendOperationLog(`${et.aliasNameToClassName(t.aliasName)}\u306e\u30c7\u30fc\u30bf ${e}.zip \u3092\u4fdd\u5b58`),Ir.queue.add((r,s)=>r(this._saveGameObjectAsync(t,e,i)))}_saveGameObjectAsync(t,e="fly_xml_data",i){let r=[],s=this.convertToXml(t);r.push(new File([s],"fly_data.xml",{type:"text/plain"}));let o=[];o=o.concat(this.searchImageFiles(s));for(const m of o)m.state===Bi.COMPLETE&&r.push(new File([m.blob],m.identifier+"."+ql.extension(m.blob.type),{type:m.blob.type}));let c=this.convertToXml(wr.create(o));return r.push(new File([c],"fly_imageTag.xml",{type:"text/plain"})),this.saveAsync(r,this.appendTimestamp(e),i)}saveAsync(t,e,i){let r=-1;return Bo.instance.saveAsync(t,e,s=>{let o=0|s.percent;o<=r||(r=o,this.ngZone.run(()=>i(r)))})}convertToXml(t){return'<?xml version="1.0" encoding="UTF-8"?>\n'+Kj.xml(t.toXml(),2)}searchImageFiles(t){let e=ca.xml2element(t),i=[];if(!e)return i;let r={},s=e.ownerDocument.querySelectorAll('*[type="image"]');for(let o=0;o<s.length;o++){let c=s[o].innerHTML;r[c]=kt.instance.get(c);let m=s[o].getAttribute("currentValue");m&&(r[m]=kt.instance.get(m))}s=e.ownerDocument.querySelectorAll("*[imageIdentifier], *[toImageIdentifier], *[backgroundImageIdentifier]");for(let o=0;o<s.length;o++){let c=s[o].getAttribute("imageIdentifier");c&&(r[c]=kt.instance.get(c));let m=s[o].getAttribute("toImageIdentifier");m&&(r[c]=kt.instance.get(m));let I=s[o].getAttribute("backgroundImageIdentifier");I&&(r[I]=kt.instance.get(I))}for(let o in r){let c=r[o];c&&i.push(c)}return i}appendTimestamp(t){let e=new Date;return t+`_${e.getFullYear()}-${("00"+(e.getMonth()+1)).slice(-2)}-${("00"+e.getDate()).slice(-2)}_${("00"+e.getHours()).slice(-2)}${("00"+e.getMinutes()).slice(-2)}`}saveChatLog(t,e,i=null,r="HH:mm",s=!0){const o=0==t?"text/plain":"text/html",c=0==t?".txt":".html",m="fly_"+this.appendTimestamp(e)+c;this.chatMessageService.sendOperationLog(`\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0 ${m} \u3092\u4fdd\u5b58`),MT(new Blob([i?i.log(t,r,s):go.instance.log(t,r,s)],{type:`${o};charset=utf-8`}),m)}}Ir.queue=new Z3("SaveDataServiceQueue"),Ir.\u0275fac=function(t){return new(t||Ir)(rn(vn),rn(Er))},Ir.\u0275prov=tn({token:Ir,factory:Ir.\u0275fac,providedIn:"root"});class Vs{constructor(t,e){this.elementRef=t,this.chatMessageService=e,this.isDisable=!1,this.timeout=666,this.showValue=!0,this.type="\u30aa\u30d6\u30b8\u30a7\u30af\u30c8"}ngAfterViewInit(){let t=this.dataElement;for(;(t=t.parent)&&(t instanceof On&&(this.type="\u30ab\u30fc\u30c9"),t instanceof Gn&&(this.type="\u5c71\u672d"),t instanceof or&&(this.type=t.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9"),t instanceof Vt&&(this.type="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc"),t instanceof is&&(this.type="\u30de\u30c3\u30d7\u30de\u30b9\u30af"),t instanceof ar&&(this.type="\u5730\u5f62"),t instanceof Tr&&(this.type="\u5171\u6709\u30e1\u30e2"),t instanceof ni&&(this.type="\u5c04\u7a0b\u30fb\u7bc4\u56f2"),t.parentIsAssigned&&!t.parentIsUnknown););const e=Vs.LoggingValueMap,i=this.dataElement.identifier,r=this.elementRef.nativeElement;e.set(i,{oldValue:this.loggingValue}),r.addEventListener("input",()=>{e.get(i).timerId&&clearTimeout(e.get(i).timerId),e.get(i).timerId=setTimeout(()=>{this.doLogging()},this.timeout)})}ngOnDestroy(){const t=Vs.LoggingValueMap,e=this.dataElement.identifier;t.get(e)&&t.get(e).timerId&&this.doLogging()}doLogging(){const t=Vs.LoggingValueMap,e=this.dataElement.identifier;t.get(e).timerId&&(clearTimeout(t.get(e).timerId),t.get(e).timerId=null);const i=t.get(e).oldValue,r=this.loggingValue,s=this.dataElement;if(!this.isDisable&&r!=i){let o=`${""==this.name?`(\u7121\u540d\u306e${this.type})`:this.name} \u306e ${""==s.name?"(\u7121\u540d\u306e\u5909\u6570)":s.name} \u3092\u5909\u66f4`;this.showValue&&(s.isSimpleNumber||s.isNumberResource||s.isAbilityScore)?o+=` ${i} \u2192 ${r}`:s.isCheckProperty&&(o+=` ${r}`),this.chatMessageService.sendOperationLog(o)}t.get(e).oldValue=r}get loggingValue(){const t=this.dataElement;if(!t)return;let e;if(t.isSimpleNumber)e=`${t.value}`;else if(t.isNumberResource)e=`${t.currentValue}/${t.value&&0!=t.value?t.value:"???"}`;else if(t.isCheckProperty)e=t.value?" \u2192 \u2714ON":" \u2192 OFF";else if(t.isAbilityScore){const i=t.calcAbilityScore();e=`${t.value}`,t.currentValue&&(e+=`(${i>=0?"+":""}${i})`)}else e=t.value?t.value.toString():"";return e}}function Yj(n,t){1&n&&pn(0)}function Zj(n,t){if(1&n){const e=Xe();K(0,"div",3),xe(1,Yj,1,0,"ng-container",5),K(2,"select",6),Te("change",function(r){return De(e),ge(3).setElementType(r.target.value)}),K(3,"option",7),be(4,"\u901a\u5e38"),J(),K(5,"option",8),be(6,"\u6570\u5024"),J(),K(7,"option",9),be(8,"\u30ea\u30bd\u30fc\u30b9"),J(),K(9,"option",10),be(10,"\u80fd\u529b\u5024"),J(),K(11,"option",11),be(12,"\u30c1\u30a7\u30c3\u30af"),J(),K(13,"option",12),be(14,"\u30ce\u30fc\u30c8"),J(),K(15,"option",13),be(16,"\u53c2\u7167URL"),J()()()}if(2&n){const e=ge(3),i=Wt(2);U(1),te("ngTemplateOutlet",i),U(1),te("ngModel",e.gameDataElement.type)}}function Xj(n,t){1&n&&(Ve(0),it(1,"br"),K(2,"span",15),be(3,"0=\u753b\u50cf\u4f9d\u5b58"),J(),Ge())}function Qj(n,t){if(1&n&&(Ve(0),K(1,"span",14),be(2),J(),xe(3,Xj,4,0,"ng-container",0),Ge()),2&n){const e=ge(3);U(2),qe(e.name),U(1),te("ngIf","character"===e.descriptionType&&"height"===e.name)}}function Jj(n,t){if(1&n){const e=Xe();Ve(0),K(1,"div",16),be(2),J(),K(3,"input",17),Te("ngModelChange",function(r){return De(e),ge(3).name=r}),J(),Ge()}if(2&n){const e=ge(3);U(2),qe(e.name),U(1),te("ngModel",e.name)}}function eH(n,t){if(1&n){const e=Xe();Ve(0),K(1,"input",21),Te("ngModelChange",function(r){return De(e),ge(4).currentValue=r}),Ct(2,"safe"),J(),it(3,"br"),K(4,"input",22),Te("ngModelChange",function(r){return De(e),ge(4).currentValue=r}),J(),K(5,"b",23),be(6,"%"),J(),Ge()}if(2&n){const e=ge(4);U(1),ur(xt(2,5,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),Wi("title","",e.currentValue,"%"),te("ngModel",e.currentValue),U(3),te("ngModel",e.currentValue)}}function tH(n,t){if(1&n){const e=Xe();Ve(0),K(1,"label",24)(2,"input",25),Te("ngModelChange",function(r){return De(e),ge(5).value=r}),J(),K(3,"div",26),be(4),J()(),K(5,"label",27)(6,"input",25),Te("ngModelChange",function(r){return De(e),ge(5).currentValue=r}),J(),K(7,"div",26),be(8),J()(),Ge()}if(2&n){const e=ge(5);U(1),Ke("color",e.value)("background-color",e.currentValue)("text-shadow",e.colorSampleTextShadowCss),U(1),te("ngModel",e.value),U(2),qe(e.value),U(1),Ke("color",e.value)("background-color",e.currentValue)("text-shadow",e.colorSampleTextShadowCss),U(1),te("ngModel",e.currentValue),U(2),An("(",e.currentValue,")")}}function nH(n,t){if(1&n){const e=Xe();Ve(0),K(1,"label",24)(2,"input",25),Te("ngModelChange",function(r){return De(e),ge(5).value=r}),J(),be(3),J(),Ge()}if(2&n){const e=ge(5);U(1),Ke("color",e.value)("text-shadow",e.colorSampleTextShadowCss),U(1),te("ngModel",e.value),U(1),An(" ",e.value,"")}}function iH(n,t){if(1&n&&(Ve(0),xe(1,tH,9,16,"ng-container",0),xe(2,nH,4,6,"ng-container",0),Ge()),2&n){const e=ge(4);U(1),te("ngIf","colors"===e.gameDataElement.type),U(1),te("ngIf","color"===e.gameDataElement.type)}}function rH(n,t){if(1&n){const e=Xe();K(0,"dev",31)(1,"label")(2,"input",32),Te("ngModelChange",function(r){return De(e),ge(5).currentValue=r})("change",function(){De(e);const r=ge(5);return r.currentValue=r.currentValue?r.name:""}),J(),be(3,"\xd7 size"),J()()}if(2&n){const e=ge(5);U(2),ct("checked",e.currentValue?"checked":""),te("ngModel",e.currentValue)}}function sH(n,t){if(1&n){const e=Xe();Ve(0),K(1,"input",28),Te("ngModelChange",function(r){return De(e),ge(4).value=r}),Ct(2,"safe"),J(),it(3,"br"),K(4,"input",29),Te("ngModelChange",function(r){return De(e),ge(4).value=r}),J(),xe(5,rH,4,2,"dev",30),Ge()}if(2&n){const e=ge(4);U(1),ur(xt(2,11,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),ct("title",e.value),ct("min","altitude"===e.name?-12:"fontsize"===e.name||"length"===e.name?1:0),ct("max","fontsize"===e.name?128:12),ct("step","fontsize"===e.name?1:.5),te("ngModel",e.value),U(3),ct("min","altitude"===e.name?-24:"fontsize"===e.name||"length"===e.name?1:0),ct("step","fontsize"===e.name?1:.1),te("ngModel",e.value),U(1),te("ngIf","character"===e.descriptionType&&"height"===e.name)}}function oH(n,t){if(1&n&&(Ve(0)(1,18),xe(2,eH,7,8,"ng-container",19),xe(3,iH,3,2,"ng-container",19),xe(4,sH,6,14,"ng-container",20),Ge()()),2&n){const e=ge(3);U(1),te("ngSwitch",e.gameDataElement.name),U(1),te("ngSwitchCase","opacity"),U(1),te("ngSwitchCase","color")}}function aH(n,t){if(1&n){const e=Xe();Ve(0),K(1,"div",33),be(2),J(),K(3,"input",34),Te("ngModelChange",function(r){return De(e),ge(4).value=r}),J(),Ge()}if(2&n){const e=ge(4);U(2),qe(e.value),U(1),ct("type",e.isNum(e.value)?"number":"text"),te("logging.name",e.tableTopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.value)}}function lH(n,t){if(1&n){const e=Xe();Ve(0),K(1,"input",35),Te("ngModelChange",function(r){return De(e),ge(4).currentValue=r}),Ct(2,"safe"),J(),it(3,"br"),K(4,"input",36),Te("ngModelChange",function(r){return De(e),ge(4).currentValue=r}),J(),be(5," / "),K(6,"input",37),Te("ngModelChange",function(r){return De(e),ge(4).value=r}),J(),Ge()}if(2&n){const e=ge(4);U(1),ur(xt(2,16,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),ct("title",e.currentValue),ct("max",e.isNum(e.value)?e.value:1e3),te("logging.name",e.tableTopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.currentValue),U(3),te("logging.name",e.tableTopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.currentValue),U(2),te("logging.name",e.tableTopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.value)}}function cH(n,t){if(1&n){const e=Xe();Ve(0),K(1,"select",39),Te("ngModelChange",function(r){return De(e),ge(5).currentValue=r}),K(2,"option",7),be(3,"\u306a\u3057"),J(),K(4,"option",40),be(5,"\xf72"),J(),K(6,"option",41),be(7,"\xf73 SRS,LHZ"),J(),K(8,"option",42),be(9,"\xf74"),J(),K(10,"option",43),be(11,"\xf75"),J(),K(12,"option",44),be(13,"\xf76 SW"),J(),K(14,"option",45),be(15,"\xf710"),J(),K(16,"option",46),be(17,"D&D 3e\uff5e"),J()(),Ge()}if(2&n){const e=ge(5);U(1),te("ngModel",e.currentValue)}}function uH(n,t){if(1&n&&(Ve(0),K(1,"span",47),be(2),J(),Ge()),2&n){const e=ge(5);U(2),qe("("+(e.abilityScore>=0?"+":"")+e.abilityScore+")")}}function dH(n,t){if(1&n){const e=Xe();Ve(0),K(1,"input",38),Te("ngModelChange",function(r){return De(e),ge(4).value=r}),J(),xe(2,cH,18,1,"ng-container",0),xe(3,uH,3,1,"ng-container",0),Ge()}if(2&n){const e=ge(4);U(1),ct("type",e.isNum(e.value)?"number":"text"),te("logging.name",e.tableTopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.value),U(1),te("ngIf",e.isEdit),U(1),te("ngIf",!e.isEdit&&e.currentValue)}}function fH(n,t){if(1&n){const e=Xe();K(0,"input",51),Te("ngModelChange",function(r){return De(e),ge(5).currentValue=r}),J()}2&n&&te("ngModel",ge(5).currentValue)}function hH(n,t){if(1&n&&(K(0,"span",52),be(1),J()),2&n){const e=ge(5);U(1),qe(e.checkValue)}}function pH(n,t){if(1&n){const e=Xe();Ve(0),K(1,"input",48),Te("ngModelChange",function(r){return De(e),ge(4).value=r})("change",function(){De(e);const r=ge(4);return r.value=r.value?r.name:""}),J(),xe(2,fH,1,1,"input",49),xe(3,hH,2,1,"span",50),Ge()}if(2&n){const e=ge(4);U(1),ct("checked",e.value?"checked":""),te("logging.name",e.tableTopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.value),U(1),te("ngIf",e.isEdit),U(1),te("ngIf",!e.isEdit)}}function gH(n,t){if(1&n){const e=Xe();Ve(0),K(1,"textarea",53),Te("ngModelChange",function(r){return De(e),ge(4).value=r}),J(),Ge()}if(2&n){const e=ge(4);U(1),te("ngModel",e.value)}}function mH(n,t){if(1&n){const e=Xe();Ve(0),K(1,"div",33),be(2),J(),K(3,"span",54)(4,"input",55),Te("ngModelChange",function(r){return De(e),ge(4).value=r}),J(),K(5,"button",56),Te("click",function(){De(e);const r=ge(4);return!!r.stringUtil.validUrl(r.value)&&r.openUrl(r.value)}),K(6,"i",57),be(7),J()()(),Ge()}if(2&n){const e=ge(4);U(2),qe(e.value),U(2),te("ngModel",e.value),U(1),Rt("disabled",e.stringUtil.validUrl(e.value)?null:""),U(2),qe(e.stringUtil.validUrl(e.value)?e.stringUtil.sameOrigin(e.value)?"link":"open_in_new":"link_off")}}function _H(n,t){if(1&n){const e=Xe();K(0,"input",60),Te("ngModelChange",function(r){return De(e),ge(5).value=r}),J()}2&n&&te("ngModel",ge(5).value)}function $H(n,t){1&n&&(K(0,"span",61),be(1,"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09"),J())}function vH(n,t){if(1&n&&(Ve(0),K(1,"div",33),be(2),J(),xe(3,_H,1,1,"input",58),xe(4,$H,2,0,"span",59),Ge()),2&n){const e=ge(4);U(2),qe(e.value),U(1),te("ngIf",!(e.isHideText&&e.isTableTopObjectName)),U(1),te("ngIf",e.isHideText&&e.isTableTopObjectName)}}function bH(n,t){if(1&n&&(Ve(0)(1,18),xe(2,aH,4,6,"ng-container",19),xe(3,lH,7,19,"ng-container",19),xe(4,dH,4,7,"ng-container",19),xe(5,pH,4,7,"ng-container",19),xe(6,gH,2,1,"ng-container",19),xe(7,mH,8,4,"ng-container",19),xe(8,vH,5,3,"ng-container",20),Ge()()),2&n){const e=ge(3);U(1),te("ngSwitch",e.gameDataElement.type),U(1),te("ngSwitchCase","simpleNumber"),U(1),te("ngSwitchCase","numberResource"),U(1),te("ngSwitchCase","abilityScore"),U(1),te("ngSwitchCase","checkProperty"),U(1),te("ngSwitchCase","note"),U(1),te("ngSwitchCase","url")}}function yH(n,t){if(1&n&&(Ve(0),xe(1,Zj,17,2,"div",2),K(2,"div",3),xe(3,Qj,4,2,"ng-container",0),xe(4,Jj,4,2,"ng-container",0),J(),K(5,"div",4),xe(6,oH,5,3,"ng-container",0),xe(7,bH,9,7,"ng-container",0),J(),Ge()),2&n){const e=ge(2);U(1),te("ngIf",e.isEdit),U(2),te("ngIf",e.isTagLocked),U(1),te("ngIf",!e.isTagLocked),U(2),te("ngIf",e.isCommonValue),U(1),te("ngIf",!e.isCommonValue)}}function CH(n,t){1&n&&pn(0)}function xH(n,t){if(1&n&&(K(0,"div",67),xe(1,CH,1,0,"ng-container",5),J()),2&n){ge(3);const e=Wt(2);U(1),te("ngTemplateOutlet",e)}}function wH(n,t){if(1&n&&(Ve(0),K(1,"div",68),be(2),J(),Ge()),2&n){const e=ge(3);U(2),qe(e.name)}}function EH(n,t){if(1&n){const e=Xe();Ve(0),K(1,"input",69),Te("ngModelChange",function(r){return De(e),ge(3).name=r}),J(),Ge()}if(2&n){const e=ge(3);U(1),te("ngModel",e.name)}}function TH(n,t){if(1&n&&it(0,"div",72),2&n){const e=t.$implicit,i=ge(4);te("gameDataElement",e)("tableTopObjectName",i.tableTopObjectName)("isEdit",i.isEdit)("isTagLocked",i.isTagLocked)("isHideText",i.isHideText)("isNoLogging",i.isNoLogging)("descriptionType",i.descriptionType)}}function IH(n,t){if(1&n&&(K(0,"div",70),xe(1,TH,1,7,"div",71),J()),2&n){const e=ge(3);U(1),te("ngForOf",e.gameDataElement.children)}}function SH(n,t){if(1&n&&(Ve(0),xe(1,xH,2,1,"div",62),it(2,"div",63),K(3,"div",64)(4,"div",65),xe(5,wH,3,1,"ng-container",0),xe(6,EH,2,1,"ng-container",0),J(),xe(7,IH,2,1,"div",66),J(),Ge()),2&n){const e=ge(2);U(1),te("ngIf",e.isEdit),U(3),Ke("border-color",e.isTagLocked&&"common"===e.name?"transparent":""),U(1),te("ngIf",e.isTagLocked&&"common"!=e.name),U(1),te("ngIf",!e.isTagLocked),U(1),te("ngIf",0<e.gameDataElement.children.length)}}function MH(n,t){if(1&n&&(Ve(0),xe(1,yH,8,5,"ng-container",0),xe(2,SH,8,6,"ng-container",0),Ge()),2&n){const e=ge();U(1),te("ngIf",e.gameDataElement.children.length<1),U(1),te("ngIf",0<e.gameDataElement.children.length)}}function kH(n,t){if(1&n){const e=Xe();K(0,"button",73),Te("click",function(){return De(e),ge().addElement()}),K(1,"i",74),be(2,"add_circle"),J()(),K(3,"button",73),Te("click",function(){return De(e),ge().upElement()}),K(4,"i",74),be(5,"arrow_upward"),J()(),it(6,"br"),K(7,"button",73),Te("click",function(){return De(e),ge().deleteElement()}),K(8,"i",74),be(9,"remove_circle_outline"),J()(),K(10,"button",73),Te("click",function(){return De(e),ge().downElement()}),K(11,"i",74),be(12,"arrow_downward"),J()()}}Vs.LoggingValueMap=new Map,Vs.\u0275fac=function(t){return new(t||Vs)(Le(_i),Le(Er))},Vs.\u0275dir=Xt({type:Vs,selectors:[["","appLogging",""]],inputs:{isDisable:["logging.disable","isDisable"],timeout:["logging.timeout","timeout"],name:["logging.name","name"],dataElement:["logging.dataElement","dataElement"],showValue:["logging.loggingValue","showValue"]}});let DH=(()=>{class n{constructor(e,i){this.changeDetector=e,this.modalService=i,this.tableTopObjectName=null,this.gameDataElement=null,this.isEdit=!1,this.isTagLocked=!1,this.isValueLocked=!1,this.isHideText=!1,this.isNoLogging=!1,this.stringUtil=et,this._name="",this._value=0,this._currentValue=0,this.updateTimer=null}get name(){return this._name}set name(e){this._name=e,this.setUpdateTimer()}get value(){return this._value}set value(e){this._value=e,this.setUpdateTimer()}get currentValue(){return this._currentValue}set currentValue(e){this._currentValue=e,this.setUpdateTimer()}get abilityScore(){return this.gameDataElement.calcAbilityScore()}get isTableTopObjectName(){return this.isTagLocked&&"name"===this.gameDataElement.name}get checkValue(){if(null==this.currentValue)return"";let e=this.currentValue.toString().split(/[|\uff5c]/,2);return e.length<=1?null==this.value||""==this.value?"":this.currentValue.toString():null==this.value||""==this.value?e[1]:e[0]}get isCommonValue(){return!!this.gameDataElement&&this.isTagLocked&&("size"===this.gameDataElement.name||"width"===this.gameDataElement.name||"height"===this.gameDataElement.name||"depth"===this.gameDataElement.name||"length"===this.gameDataElement.name||"fontsize"===this.gameDataElement.name||"opacity"===this.gameDataElement.name||"altitude"===this.gameDataElement.name||"color"===this.gameDataElement.name)}get isNotApplicable(){return this.isCommonValue&&"range-not-width"===this.descriptionType&&"width"===this.gameDataElement.name}get colorSampleTextShadowCss(){const e=et.textShadowColor(this.value.toString());return`${e} -1px -1px 0px, \n      ${e} 0px -1px 0px, \n      ${e} 1px -1px 0px, \n      ${e} -1px 0px 0px, \n      ${e} 1px 0px 0px,\n      ${e} -1px 1px 0px,\n      ${e} 0px 1px 0px,\n      ${e} 1px 1px 0px`}get identifier(){return this.gameDataElement.identifier}ngOnInit(){this.gameDataElement&&this.setValues(this.gameDataElement),Fe.register(this).on("UPDATE_GAME_OBJECT",e=>{this.gameDataElement&&e.data.identifier===this.gameDataElement.identifier&&(this.setValues(this.gameDataElement),this.changeDetector.markForCheck())}).on("DELETE_GAME_OBJECT",e=>{this.gameDataElement&&this.gameDataElement.identifier===e.data.identifier&&this.changeDetector.markForCheck()})}ngOnDestroy(){Fe.unregister(this)}ngAfterViewInit(){}addElement(){this.gameDataElement.appendChild(ht.create("\u30bf\u30b0","",{}))}deleteElement(){this.gameDataElement.destroy()}upElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);0<i&&e.insertBefore(this.gameDataElement,e.children[i-1])}downElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.gameDataElement)}setElementType(e){this.gameDataElement.setAttribute("type",e)}isNum(e){return isFinite(e)}openUrl(e){et.sameOrigin(e)?window.open(e.trim(),"_blank","noopener"):this.modalService.open(Hr,{url:e,title:this.tableTopObjectName,subTitle:this.name})}setValues(e){this._name=e.name,this._currentValue=e.currentValue,this._value=e.value}setUpdateTimer(){clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>{this.gameDataElement.name!==this.name&&(this.gameDataElement.name=this.name),this.gameDataElement.currentValue!==this.currentValue&&(this.gameDataElement.currentValue=this.currentValue),this.gameDataElement.value!==this.value&&(this.gameDataElement.value=this.value),this.updateTimer=null},66)}}return n.\u0275fac=function(e){return new(e||n)(Le(Di),Le(kn))},n.\u0275cmp=Zt({type:n,selectors:[["game-data-element"],["","game-data-element",""]],inputs:{tableTopObjectName:"tableTopObjectName",gameDataElement:"gameDataElement",isEdit:"isEdit",isTagLocked:"isTagLocked",isValueLocked:"isValueLocked",isHideText:"isHideText",isNoLogging:"isNoLogging",descriptionType:"descriptionType"},decls:3,vars:1,consts:[[4,"ngIf"],["editButtons",""],["class","table-cell table-cell_solid",4,"ngIf"],[1,"table-cell","table-cell_solid"],[1,"table-cell"],[4,"ngTemplateOutlet"],[3,"ngModel","change"],["value",""],["value","simpleNumber"],["value","numberResource"],["value","abilityScore"],["value","checkProperty"],["value","note"],["value","url"],[2,"font-family","Cambria, Georgia","font-size","0.9rem"],[2,"font-size","0.4rem"],[1,"hidden-spacer",2,"font-family","Cambria, Georgia","font-size","0.9rem"],["size","1","placeholder","Value",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","0.9rem",3,"ngModel","ngModelChange"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["type","range","min","0","max","100","step","1",2,"width","90%",3,"ngModel","title","ngModelChange"],["type","number","min","0","max","100","step","1","size","1","placeholder","Opacity",2,"margin-left","3.5em","width","4em","text-align","right",3,"ngModel","ngModelChange"],[1,"move",2,"font-size","small"],[1,"color-sample",2,"padding","0px 2px 0px 0xp","width","6.5em"],["type","color",2,"width","1em",3,"ngModel","ngModelChange"],[2,"display","inline-block","box-sizing","border-box","width","calc(100% - 1em)","text-align","center"],[1,"color-sample",2,"padding","0px 2px 0px 0xp","width","7.5em"],["type","range",2,"width","90%",3,"ngModel","title","min","max","step","ngModelChange"],["type","number","size","1","placeholder","Value",2,"width","35%","max-width","4em","text-align","right",3,"min","step","ngModel","ngModelChange"],["style","color: #444; font-family: Cambria, Georgia; font-size: 0.9rem; display: inline-block; margin-left: 3px",4,"ngIf"],[2,"color","#444","font-family","Cambria, Georgia","font-size","0.9rem","display","inline-block","margin-left","3px"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[1,"hidden-spacer",2,"font-size","1.0em","font-family","Cambria, Georgia"],["appLogging","","size","1","placeholder","Number",2,"width","40%","min-width","3em","max-width","8em","text-align","right",3,"logging.name","logging.dataElement","logging.disable","type","ngModel","ngModelChange"],["appLogging","","type","range","min","0",3,"logging.name","logging.dataElement","logging.disable","ngModel","title","max","ngModelChange"],["appLogging","","size","1","type","number","placeholder","Value",2,"width","5em","text-align","right",3,"logging.name","logging.dataElement","logging.disable","ngModel","ngModelChange"],["appLogging","","size","1","type","number","placeholder","Value",2,"width","5em",3,"logging.name","logging.dataElement","logging.disable","ngModel","ngModelChange"],["appLogging","","size","1","placeholder","Value",2,"width","40%","max-width","5em","text-align","right",3,"logging.name","logging.dataElement","logging.disable","type","ngModel","ngModelChange"],[1,"modeifire-type",2,"width","40%","max-width","5em",3,"ngModel","ngModelChange"],["value","div2"],["value","div3"],["value","div4"],["value","div5"],["value","div6"],["value","div10"],["value","DnD3"],[2,"font-size","smaller"],["appLogging","","type","checkbox",2,"width","30%","max-width","4em",3,"logging.name","logging.dataElement","logging.disable","ngModel","checked","ngModelChange","change"],["style","width:50%; max-width:4em","type","text","size","1","placeholder","Option",3,"ngModel","ngModelChange",4,"ngIf"],["style","font-size: 1.0em; font-family: Cambria, Georgia; color: #555",4,"ngIf"],["type","text","size","1","placeholder","Option",2,"width","50%","max-width","4em",3,"ngModel","ngModelChange"],[2,"font-size","1.0em","font-family","Cambria, Georgia","color","#555"],["placeholder","Note",2,"width","100%","height","5em","min-width","50px","resize","bose","font-size","0.8em",3,"ngModel","ngModelChange"],[2,"white-space","nowrap"],["type","url","size","1","placeholder","https://www.example.com",2,"width","calc(100% - 1.6rem)","min-width","10px",3,"ngModel","ngModelChange"],[2,"width","1.6rem",3,"click"],[1,"material-icons",2,"font-size","1.0rem"],["style","width:100%; min-width:10px;","size","1","placeholder","",3,"ngModel","ngModelChange",4,"ngIf"],["style","color: gray; font-size: 1.0em; font-family: Cambria, Georgia;",4,"ngIf"],["size","1","placeholder","",2,"width","100%","min-width","10px",3,"ngModel","ngModelChange"],[2,"color","gray","font-size","1.0em","font-family","Cambria, Georgia"],["class","table-cell table-cell_solid","style","vertical-align: top;",4,"ngIf"],[1,"table-cell","table-cell_inner-table",2,"padding","0","width","0"],[1,"table-cell_inner-table"],[1,"table-cell_inner-table-title"],["class","table",4,"ngIf"],[1,"table-cell","table-cell_solid",2,"vertical-align","top"],[2,"padding","2px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold"],["size","1","placeholder","Value",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold",3,"ngModel","ngModelChange"],[1,"table"],["game-data-element","","class","table-row",3,"gameDataElement","tableTopObjectName","isEdit","isTagLocked","isHideText","isNoLogging","descriptionType",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","tableTopObjectName","isEdit","isTagLocked","isHideText","isNoLogging","descriptionType"],[3,"click"],[1,"material-icons"]],template:function(e,i){1&e&&(xe(0,MH,3,2,"ng-container",0),xe(1,kH,13,0,"ng-template",null,1,Ln)),2&e&&te("ngIf",i.gameDataElement&&!i.isNotApplicable&&!(i.isHideText&&("text"==i.name||"fontsize"==i.name||"color"==i.name)))},directives:[_n,wl,es,hi,oi,zr,jr,fi,xl,Cd,ms,So,Io,gs,xd,Jr,Vs,ei,n],pipes:[ti],styles:[".game-data-element[_ngcontent-%COMP%]{margin-left:10px}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{padding-top:10px;display:table-row;box-sizing:border-box}.table-cell[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.5em 0 .1em .5em;border-bottom:1px dotted #888;box-sizing:border-box}.table-cell_solid[_ngcontent-%COMP%]{width:10px;white-space:nowrap}.table-cell_inner-table[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.2em 0 .1em .5em;border:none;box-sizing:border-box}.table-cell_inner-table-title[_ngcontent-%COMP%]{border-bottom:1px solid #444;border-left:8px solid #444;padding-left:8px}.box[_ngcontent-%COMP%]{display:inline-block;margin:10px}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;max-width:20em;overflow:hidden;padding:0 3px;box-sizing:border-box}input[_ngcontent-%COMP%], button[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}input[_ngcontent-%COMP%]:hover, textarea[_ngcontent-%COMP%]:hover, select[_ngcontent-%COMP%]:hover{background:#EEE}input[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{background:#FFF}button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}.table-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.5rem}button[_ngcontent-%COMP%]:disabled{color:gray}button[_ngcontent-%COMP%]:disabled:hover{background-color:transparent}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.modeifire-type[_ngcontent-%COMP%]{font-size:smaller}input[type=color][_ngcontent-%COMP%]:hover, input[type=color][_ngcontent-%COMP%]:not(:hover){-webkit-appearance:auto;-moz-appearance:auto;appearance:auto;width:44px;height:22px;background-color:#efefef;cursor:default;color:#000;border-width:1px;border-style:solid;border-color:#767676;-o-border-image:none;border-image:none;-o-border-image:initial;border-image:initial;padding:1px 2px}@media (prefers-color-scheme: dark){input[type=color][_ngcontent-%COMP%]:hover, input[type=color][_ngcontent-%COMP%]:not(:hover){background-color:#3b3b3b;color:#fff;border-color:#858585}}.color-sample[_ngcontent-%COMP%]{display:inline-block;font-weight:bolder;width:6em;text-shadow:#eee -1px -1px 0px,#eee 0px -1px 0px,#eee 1px -1px 0px,#eee -1px 0px 0px,#eee 1px 0px 0px,#eee -1px 1px 0px,#eee 0px 1px 0px,#eee 1px 1px 0px}input[_ngcontent-%COMP%] + .move[_ngcontent-%COMP%]{display:inline-block;transform:translate(-1em);transition:transform 18ms}input[_ngcontent-%COMP%]:hover + .move[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:active + .move[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:focus + .move[_ngcontent-%COMP%]{display:inline-block;transform:translate(0);transition:transform 18ms}@supports (-moz-user-select: -moz-none){input[_ngcontent-%COMP%] + .move[_ngcontent-%COMP%]{transform:translate(0)}}"],changeDetection:0}),n})();const AH=["mainImage"];function PH(n,t){1&n&&pn(0)}function NH(n,t){if(1&n){const e=Xe();Ve(0),K(1,"button",4),Te("click",function(){return De(e),ge().openModal("front")}),be(2,"\u8868\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),J(),K(3,"button",0),Te("click",function(){return De(e),ge().openModal("back")}),be(4,"\u88cf\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),J(),Ge()}if(2&n){const e=ge();U(1),te("disabled",!e.isVisible)}}function FH(n,t){if(1&n){const e=Xe();Ve(0),K(1,"button",0),Te("click",function(){return De(e),ge().openModalChangeAllCardImages()}),be(2,"\u5168\u30ab\u30fc\u30c9\u306e\u88cf\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),J(),Ge()}}function OH(n,t){if(1&n){const e=Xe();Ve(0),K(1,"button",0),Te("click",function(){return De(e),ge().openModal("floor")}),be(2,"\u5e8a\u306e\u753b\u50cf\u3092\u5909\u66f4"),J(),K(3,"button",0),Te("click",function(){return De(e),ge().openModal("wall")}),be(4,"\u58c1\u306e\u753b\u50cf\u3092\u5909\u66f4"),J(),Ge()}}function RH(n,t){if(1&n){const e=Xe();Ve(0),K(1,"button",4),Te("click",function(){De(e);const r=ge();return r.openModal(r.tabletopObject.face)}),be(2,"\u30c0\u30a4\u30b9\u76ee\u306e\u753b\u50cf\u3092\u5909\u66f4"),J(),Ge()}if(2&n){const e=ge();U(1),te("disabled",!e.isVisible)}}function BH(n,t){if(1&n){const e=Xe();Ve(0),K(1,"button",0),Te("click",function(){De(e);const r=ge();return r.openModalReplaceImage(r.tabletopObject.imageFiles.length>1||0<(null==r.tabletopObject.imageFile?null:r.tabletopObject.imageFile.url.length))}),be(2),J(),K(3,"button",4),Te("click",function(){return De(e),ge().openModal("faceIcon")}),be(4),J(),Ge()}if(2&n){const e=ge();U(2),An("\u753b\u50cf",(null==e.tabletopObject.imageFiles?null:e.tabletopObject.imageFiles.length)>1?"\u7f6e\u63db/\u524a\u9664":"\u8a2d\u5b9a",""),U(1),te("disabled",(null==e.tabletopObject.faceIcons?null:e.tabletopObject.faceIcons.length)>=e.MAX_IMAGE_ICON_COUNT),U(1),An("\u9854IC",(null==e.tabletopObject.faceIcons?null:e.tabletopObject.faceIcons.length)>0?"\u8ffd\u52a0":"\u8a2d\u5b9a","")}}function LH(n,t){if(1&n){const e=Xe();Ve(0),K(1,"button",0),Te("click",function(){De(e);const r=ge(2);return r.openModal("imageIdentifier",r.tabletopObject.imageFile&&r.tabletopObject.imageFile.url.length>0)}),be(2,"\u753b\u50cf\u5909\u66f4"),J(),Ge()}}function zH(n,t){if(1&n&&(Ve(0),xe(1,LH,3,0,"ng-container",8),Ge()),2&n){const e=ge();U(1),te("ngIf","range"!==e.tabletopObject.aliasName)}}function jH(n,t){if(1&n&&(K(0,"div",10),be(1),J()),2&n){const e=ge();U(1),An("",e.progresPercent,"%")}}function HH(n,t){if(1&n){const e=Xe();K(0,"select",12),Te("change",function(r){return De(e),ge(2).setLocation(r.target.value)}),K(1,"option",13),be(2,"\u30c6\u30fc\u30d6\u30eb"),J(),K(3,"option",14),be(4,"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),J(),K(5,"option",15),be(6,"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),J(),K(7,"option",16),be(8,"\u5893\u5730"),J()()}if(2&n){const e=ge(2);te("ngModel",e.tabletopObject.location.name),U(5),ct("value",e.networkService.peerId)}}function UH(n,t){if(1&n){const e=Xe();Ve(0),xe(1,HH,9,2,"select",11),K(2,"button",4),Te("click",function(){De(e);const r=ge();return r.openModal("shadowImageIdentifier",r.tabletopObject.shadowImageFile.url.length>0)}),be(3,"\u753b\u50cf\u306e\u5f71\u306e\u5909\u66f4"),J(),Ge()}if(2&n){const e=ge();U(1),te("ngIf",e.tabletopObject),U(1),te("disabled",!e.tabletopObject.imageElement||"null"==e.tabletopObject.imageElement.value)}}function VH(n,t){if(1&n){const e=Xe();K(0,"button",35),Te("click",function(){De(e);const r=ge(2),s=r.index,o=r.$implicit;return ge(3).deleteIcon(s,o.identifier)}),K(1,"b",36),be(2,"close"),J()()}}const GH=function(n){return{"current-icon":n}};function qH(n,t){if(1&n){const e=Xe();K(0,"div",32)(1,"img",33),Te("click",function(){De(e);const r=ge().index;return ge(3).selectIcon(r)}),Ct(2,"safe"),J(),xe(3,VH,3,0,"button",34),J()}if(2&n){const e=ge(),i=e.index,r=e.$implicit,s=ge(3);te("@bounceInOut",void 0)("ngClass",ut(8,GH,s.tabletopObject.currntIconIndex==i)),U(1),te("src",xt(2,5,r.url,"resourceUrl"),Jt)("alt",r.name),U(2),te("ngIf",s.tabletopObject.currntIconIndex==i)}}function WH(n,t){if(1&n&&(K(0,"div",5),xe(1,qH,4,10,"div",31),J()),2&n){const e=t.$implicit,i=t.index;Ke("top",-ge(3).showIconOffset(i),"px"),U(1),te("ngIf",0<e.url.length)}}const KH=function(n){return{hide:n}};function YH(n,t){if(1&n){const e=Xe();K(0,"span",37)(1,"img",33),Te("click",function(){const s=De(e).index;return ge(3).selectImage(s)}),Ct(2,"safe"),J()()}if(2&n){const e=t.$implicit,i=t.index,r=ge(3);Ke("left",50*(r.tabletopObject.currntImageIndex<=i?i-1:i)-r.showCaseOffset(i),"px"),te("ngClass",ut(9,KH,r.tabletopObject.currntImageIndex==i)),U(1),te("@bounceInOut",void 0)("src",xt(2,6,e.url,"resourceUrl"),Jt)("alt",e.name)}}function ZH(n,t){if(1&n){const e=Xe();K(0,"button",38),Te("click",function(){return De(e),ge(3).openModalAddImage()}),be(1),J()}if(2&n){const e=ge(3);Ke("left",e.tabletopObject.imageFiles.length<0?-5:45*(e.tabletopObject.imageFiles.length-1)-5-e.showCaseOffset(e.tabletopObject.imageFiles.length-2),"px"),U(1),qe(e.tabletopObject.imageFiles.length<2?"\u5207\u308a\u66ff\u3048\u753b\u50cf\u8a2d\u5b9a":"\uff0b")}}const XH=function(n){return{transform:n}};function QH(n,t){if(1&n&&(K(0,"div",39),it(1,"div",40),Ct(2,"safe"),J()),2&n){const e=ge(3);Ke("width",e.imageAreaRreact.width,"px")("height",e.imageAreaRreact.height,"px"),te("ngStyle",ut(15,XH,"scale("+e.imageAreaRreact.scale+")")),U(1),Ke("font-size",e.cardFontSize,"px")("color",e.cardColor)("text-shadow",e.cardTextShadowCss),te("innerHTML",xt(2,12,e.cardText,"html"),qi)}}const JH=function(n){return{inverse:n}},eU=function(n,t,e,i,r,s,o,c){return{black:n,blue:t,green:e,cyan:i,red:r,magenta:s,yellow:o,white:c}},tU=function(n,t,e){return{"black-paint":n,hollow:t,small:e}};function nU(n,t){if(1&n){const e=Xe();K(0,"div",20)(1,"div",21),xe(2,WH,2,3,"div",22),J(),K(3,"div",23),xe(4,YH,3,11,"span",24),xe(5,ZH,2,3,"button",25),J(),xe(6,QH,3,17,"div",26),K(7,"span",27)(8,"span",28)(9,"img",29,30),Te("dblclick",function(){return De(e),ge(2).openMainImageModal()})("load",function(){return De(e),ge(2).onMainImageLoad()}),Ct(11,"safe"),J()()()()}if(2&n){const e=ge(2);U(2),te("ngForOf",e.tabletopObject.faceIcons)("ngForTrackBy",e.identify),U(2),te("ngForOf",e.tabletopObject.imageFiles),U(1),te("ngIf","character"==e.tabletopObject.aliasName&&e.tabletopObject.imageFiles.length<e.MAX_IMAGE_ICON_COUNT&&(e.tabletopObject.imageFiles.length>1||0<(null==e.tabletopObject.imageFile?null:e.tabletopObject.imageFile.url.length))),U(1),te("ngIf","card"==e.tabletopObject.aliasName&&(e.tabletopObject.isFront||e.tabletopObject.isHand||e.isVisible)||"card-stack"==e.tabletopObject.aliasName&&e.tabletopObject.topCard.isFront),U(1),te("ngClass",ut(14,JH,e.tabletopObject.isInverse)),U(1),te("ngClass",ao(16,eU,0==e.tabletopObject.aura,1==e.tabletopObject.aura,2==e.tabletopObject.aura,3==e.tabletopObject.aura,4==e.tabletopObject.aura,5==e.tabletopObject.aura,6==e.tabletopObject.aura,7==e.tabletopObject.aura)),U(1),te("src",xt(11,11,e.imageFile.url,"resourceUrl"),Jt)("alt",e.imageFile.name)("ngClass",Zr(25,tU,e.isBlackPaint,e.tabletopObject.isHollow,""==e.tabletopObject.aliasName))("@switchImage",e.tabletopObject.currntImageIndex)}}function iU(n,t){if(1&n){const e=Xe();K(0,"div",45)(1,"button",46),Te("click",function(){return De(e),ge(3).showChatPalette()}),be(2,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a"),J(),K(3,"button",46),Te("click",function(){return De(e),ge(3).showStandSetting()}),be(4,"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a"),J()()}}function rU(n,t){if(1&n&&(Ve(0),K(1,"div",41)(2,"div",42),it(3,"div",43),J(),xe(4,iU,5,0,"div",44),J(),Ge()),2&n){const e=ge(2);U(3),te("gameDataElement",e.tabletopObject.commonDataElement)("tableTopObjectName",e.tableTopObjectName)("isTagLocked",!0)("isHideText","card"===e.tabletopObject.aliasName&&!e.tabletopObject.isFront&&!e.tabletopObject.isHand&&!e.tabletopObject.isGMMode)("isNoLogging",e.isNoLogging)("descriptionType",e.descriptionType),U(1),te("ngIf","character"===e.tabletopObject.aliasName)}}function sU(n,t){if(1&n&&(K(0,"div",41)(1,"div",42),it(2,"div",48),J()()),2&n){const e=t.$implicit,i=ge(3);U(2),te("gameDataElement",e)("tableTopObjectName",i.tableTopObjectName)("isEdit",i.isEdit)("isNoLogging",i.isNoLogging)}}function oU(n,t){if(1&n&&(Ve(0),xe(1,sU,3,4,"div",47),Ge()),2&n){const e=ge(2);U(1),te("ngForOf",e.tabletopObject.detailDataElement.children)}}function aU(n,t){if(1&n){const e=Xe();Ve(0),K(1,"div",41)(2,"button",49),Te("click",function(){return De(e),ge(2).addDataElement()}),be(3,"\u65b0\u3057\u3044\u9805\u76ee\u3092\u8ffd\u52a0"),J()(),Ge()}}function lU(n,t){if(1&n){const e=Xe();K(0,"div",17)(1,"img",18),Te("click",function(){return De(e),ge().openModal("shadowImageIdentifier",!0)}),Ct(2,"safe"),J(),xe(3,nU,12,29,"div",19),xe(4,rU,5,7,"ng-container",8),xe(5,oU,2,1,"ng-container",8),xe(6,aU,4,0,"ng-container",8),J()}if(2&n){const e=ge();U(1),te("src",xt(2,6,e.tabletopObject.shadowImageFile.url,"resourceUrl"),Jt)("alt",e.tabletopObject.shadowImageFile.name),U(2),te("ngIf",(0<(null==e.tabletopObject.imageFile?null:e.tabletopObject.imageFile.url.length)||0<(null==e.tabletopObject.faceIcons?null:e.tabletopObject.faceIcons.length))&&"table-mask"!=e.tabletopObject.aliasName),U(1),te("ngIf",e.tabletopObject.commonDataElement),U(1),te("ngIf",e.tabletopObject.detailDataElement),U(1),te("ngIf",e.isEdit)}}const cU=function(n){return{"is-hidden":n}};let Gs=(()=>{class n{constructor(e,i,r,s){this.saveDataService=e,this.panelService=i,this.modalService=r,this.pointerDeviceService=s,this.tabletopObject=null,this.isEdit=!1,this.networkService=yt,this.MAX_IMAGE_ICON_COUNT=8,this.isSaveing=!1,this.progresPercent=0,this.gridSize=50,this.naturalWidth=0,this.naturalHeight=0,this.mainImageWidth=0,this.mainImageHeight=0}ngOnInit(){Fe.register(this).on("DELETE_GAME_OBJECT",e=>{this.tabletopObject&&this.tabletopObject.identifier===e.data.identifier&&this.panelService.close()}).on("UPDATE_GAME_OBJECT",-1e3,e=>{if(this.tabletopObject&&this.tabletopObject.identifier===e.data.identifier)switch(this.tabletopObject.aliasName){case"terrain":this.panelService.title=`\u5730\u5f62\u8a2d\u5b9a - ${this.tableTopObjectName}`;break;case"card":const i=this.tabletopObject;i instanceof On&&(this.panelService.title=`\u30ab\u30fc\u30c9\u8a2d\u5b9a - ${i.isFront?this.tableTopObjectName:"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09"}`);break;case"card-stack":this.panelService.title=`\u5c71\u672d\u8a2d\u5b9a - ${this.tableTopObjectName}`;break;case"table-mask":this.panelService.title=`\u30de\u30c3\u30d7\u30de\u30b9\u30af\u8a2d\u5b9a - ${this.tableTopObjectName}`;break;case"text-note":this.panelService.title=`\u5171\u6709\u30e1\u30e2\u8a2d\u5b9a - ${this.tableTopObjectName}`;break;case"dice-symbol":this.panelService.title=`\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u8a2d\u5b9a - ${this.tableTopObjectName}`;break;case"character":this.panelService.title=`\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8 - ${this.tableTopObjectName}`;break;case"range":this.panelService.title=`\u5c04\u7a0b\u30fb\u7bc4\u56f2\u8a2d\u5b9a - ${this.tableTopObjectName}`}})}ngAfterViewInit(){}ngOnDestroy(){Fe.unregister(this)}toggleEditMode(){this.isEdit=!this.isEdit}addDataElement(){if(this.tabletopObject.detailDataElement){let e=ht.create("\u898b\u51fa\u3057","",{}),i=ht.create("\u30bf\u30b0","",{});e.appendChild(i),this.tabletopObject.detailDataElement.appendChild(e)}}clone(){let e=this.tabletopObject.clone();switch(e.location.x+=50,e.location.y+=50,this.tabletopObject.parent&&this.tabletopObject.parent.appendChild(e),e.update(),this.tabletopObject.aliasName){case"terrain":dt.play(Ze.blockPut),e.isLocked=!1;break;case"card":case"card-stack":e.owner="",e.toTopmost();case"table-mask":e.isLock=!1,dt.play(Ze.cardPut);break;case"text-note":e.toTopmost(),dt.play(Ze.cardPut);break;case"dice-symbol":dt.play(Ze.dicePut);default:dt.play(Ze.piecePut)}}get tableTopObjectName(){let e=this.tabletopObject.commonDataElement.getFirstElementByName("name")||this.tabletopObject.commonDataElement.getFirstElementByName("title");return e?e.value:""}get imageFile(){const e=this.tabletopObject;return e?e instanceof On&&this.isVisible?e.frontImage:e.imageFile:Ht.Empty}get descriptionType(){return this.tabletopObject instanceof ni&&!this.tabletopObject.isApplyWidth?"range-not-width":this.tabletopObject.aliasName}saveToXML(){var e=this;return(0,en.Z)(function*(){if(!e.tabletopObject||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i=e.tableTopObjectName;yield e.saveDataService.saveGameObjectAsync(e.tabletopObject,"fly_xml_"+i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}setLocation(e){Fe.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.tabletopObject.identifier}),dt.play("graveyard"==e?Ze.sweep:Ze.piecePut),this.tabletopObject.setLocation(e)}openModal(e="",i=!1){let r=[];if("shadowImageIdentifier"==e){const s=this.tabletopObject.imageElement;s&&"null"!=s.value&&s.currentValue&&(r=[s.currentValue+""])}else{const s=this.tabletopObject.imageDataElement.getElementsByName(e);s&&s.length>0&&(r=s.map(o=>o.value+""))}this.modalService.open(Lo,{isAllowedEmpty:i,currentImageIdentifires:r}).then(s=>{if(this.tabletopObject&&this.tabletopObject.imageDataElement&&s)if("shadowImageIdentifier"==e){const o=this.tabletopObject.imageElement;if(o){"null"!=o.value&&(o.currentValue=s);const c=this.tabletopObject.imageDataElement.getElementsByName("shadowImageIdentifier");for(const m of c)this.tabletopObject.imageDataElement.removeChild(m)}}else if("faceIcon"===e){let o=this.tabletopObject.imageDataElement.getElementsByName(e);if(o.length>=this.MAX_IMAGE_ICON_COUNT){for(let c=this.MAX_IMAGE_ICON_COUNT;c<o.length;c++)this.deleteIcon(c);o[this.MAX_IMAGE_ICON_COUNT-1].value=s}else this.tabletopObject.imageDataElement.appendChild(ht.create(e,s,{type:"image"},e+ns.generateUuid()));this.tabletopObject.currntIconIndex<0&&(this.tabletopObject.currntIconIndex=0)}else{let o=this.tabletopObject.imageDataElement.getFirstElementByName(e);if(!o)return;o.value=s}})}openModalAddImage(){let e=[];const i=this.tabletopObject.imageDataElement.getElementsByName("imageIdentifier");i.length>0&&(e=i.map(r=>r.value+"")),this.modalService.open(Lo,{currentImageIdentifires:e}).then(r=>{if(!this.tabletopObject||!this.tabletopObject.imageDataElement||!r)return;let s=this.tabletopObject.imageDataElement.getElementsByName("imageIdentifier");if(s.length>=this.MAX_IMAGE_ICON_COUNT){for(let o=this.MAX_IMAGE_ICON_COUNT;o<s.length;o++)this.deleteImage(o);s[this.MAX_IMAGE_ICON_COUNT-1].value=r}else this.tabletopObject.imageDataElement.appendChild(ht.create("imageIdentifier",r,{type:"image"},name+ns.generateUuid()));this.tabletopObject.currntImageIndex<0&&(this.tabletopObject.currntImageIndex=0)})}openModalReplaceImage(e=!1){let i=[];const r=this.tabletopObject.imageDataElement.getElementsByName("imageIdentifier");r.length>0&&(i=r.map(s=>s.value+"")),this.modalService.open(Lo,{isAllowedEmpty:e,currentImageIdentifires:i}).then(s=>{!this.tabletopObject||!this.tabletopObject.imageDataElement||!s||("null"==s?this.tabletopObject.imageElement&&1==this.tabletopObject.imageFiles.length?(this.tabletopObject.imageElement.value=s,this.tabletopObject.imageElement.currentValue=s):this.deleteImage(this.tabletopObject.currntImageIndex):this.tabletopObject.imageElement&&(this.tabletopObject.imageElement.value=s))})}openModalChangeAllCardImages(){this.modalService.open(Lo,{isAllowedEmpty:!1}).then(e=>{!this.tabletopObject||!this.tabletopObject||!(this.tabletopObject instanceof Gn)||!e||this.tabletopObject.cards.forEach(i=>{let r=i.imageDataElement.getFirstElementByName("back");r&&(r.value=e)})})}selectImage(e,i="imageIdentifier"){this.tabletopObject.currntImageIndex!=e&&(this.tabletopObject.currntImageIndex=e,dt.play(Ze.surprise),Fe.trigger("UPDATE_INVENTORY",null))}selectIcon(e){this.tabletopObject.currntIconIndex!=e&&(this.tabletopObject.currntIconIndex=e)}deleteImage(e=0,i="imageIdentifier"){if(!this.tabletopObject||!this.tabletopObject.imageDataElement)return;let r=this.tabletopObject.imageDataElement.getElementsByName(i);r&&0<r.length&&e<r.length&&(this.tabletopObject.currntImageIndex>e&&(this.tabletopObject.currntImageIndex-=1),this.tabletopObject.imageDataElement.removeChild(r[e]),this.tabletopObject.currntImageIndex>=r.length-1&&(this.tabletopObject.currntImageIndex=r.length-2),this.tabletopObject.currntImageIndex<0&&(this.tabletopObject.currntImageIndex=0))}deleteIcon(e=0,i=""){if(!this.tabletopObject||!this.tabletopObject.imageDataElement)return;let r=this.tabletopObject.imageDataElement.getElementsByName("faceIcon");r&&0<r.length&&e<r.length&&(!i||r[e].value===i)&&(this.tabletopObject.currntIconIndex>e&&(this.tabletopObject.currntIconIndex-=1),this.tabletopObject.imageDataElement.removeChild(r[e]),this.tabletopObject.currntIconIndex>=r.length-1&&(this.tabletopObject.currntIconIndex=r.length-2),this.tabletopObject.currntIconIndex<0&&(this.tabletopObject.currntIconIndex=0))}openMainImageModal(){var e;this.tabletopObject instanceof Gn||(this.tabletopObject instanceof On?this.openModal(this.tabletopObject.isVisible?"front":"back"):this.tabletopObject instanceof or?this.openModal(this.tabletopObject.face):this.tabletopObject instanceof Vt?this.openModalReplaceImage(this.tabletopObject.imageFiles.length>1||0<(null===(e=this.tabletopObject.imageFile)||void 0===e?void 0:e.url.length)):this.openModal("imageIdentifier",this.tabletopObject.imageFile&&this.tabletopObject.imageFile.url.length>0))}showChatPalette(){if(!(this.tabletopObject instanceof Vt))return;let e=this.pointerDeviceService.pointers[0];this.panelService.open(hu,{left:e.x-250,top:e.y-175,width:620,height:350}).character=this.tabletopObject}showStandSetting(){if(!(this.tabletopObject instanceof Vt))return;let e=this.pointerDeviceService.pointers[0];this.panelService.open(Qp,{left:e.x-400,top:e.y-175,width:720,height:572}).character=this.tabletopObject}onMainImageLoad(){!this.mainImageElement||(this.mainImageWidth=this.mainImageElement.nativeElement.clientWidth,this.mainImageHeight=this.mainImageElement.nativeElement.clientHeight,this.naturalWidth=this.mainImageElement.nativeElement.naturalWidth,this.naturalHeight=this.mainImageElement.nativeElement.naturalHeight)}identify(e,i){return i.identifier}get imageAreaRreact(){return this.calcImageAreaRect(this.mainImageWidth,this.mainImageHeight,0)}calcImageAreaRect(e,i,r){const s={width:0,height:0,top:r,left:r,scale:1};if(0==this.naturalWidth||0==this.naturalHeight)return s;const o=e-2*r,c=i-2*r;this.naturalHeight*o/this.naturalWidth>c?(s.width=this.naturalWidth*c/this.naturalHeight,s.height=c,s.left=r+(o-s.width)/2):(s.width=o,s.height=this.naturalHeight*o/this.naturalWidth,s.top=r+(c-s.height)/2);let m=null;return this.tabletopObject instanceof Gn?m=this.tabletopObject.topCard:this.tabletopObject instanceof On&&(m=this.tabletopObject),m&&(s.scale=s.width/(m.size*this.gridSize),s.width=m.size*this.gridSize,s.height=s.width*this.naturalHeight/this.naturalWidth),s}get cardColor(){let e=null;return this.tabletopObject instanceof Gn?e=this.tabletopObject.topCard:this.tabletopObject instanceof On&&(e=this.tabletopObject),e?e.color:"#555555"}get cardFontSize(){let e=null;return this.tabletopObject instanceof Gn?e=this.tabletopObject.topCard:this.tabletopObject instanceof On&&(e=this.tabletopObject),e?e.fontsize+9:18}get cardText(){let e=null;return this.tabletopObject instanceof Gn?e=this.tabletopObject.topCard:this.tabletopObject instanceof On&&(e=this.tabletopObject),e?et.rubyToHtml(et.escapeHtml(e.text)):""}get cardTextShadowCss(){const e=et.textShadowColor(this.cardColor);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}get isVisible(){return!!this.tabletopObject&&(!(!Ue.myCursor||!Ue.myCursor.isGMMode)||(this.tabletopObject instanceof On?this.tabletopObject.isFront||this.tabletopObject.isHand:!(this.tabletopObject instanceof or)||this.tabletopObject.isVisible))}get isBlackPaint(){return this.tabletopObject instanceof Vt?this.tabletopObject.isBlackPaint:this.tabletopObject instanceof or&&!this.isVisible}get isNoLogging(){return this.tabletopObject instanceof On?!this.tabletopObject.isFront:this.tabletopObject instanceof or&&this.tabletopObject.hasOwner}showCaseOffset(e){let i=this.tabletopObject.imageFiles.length;return i<=5?0:(50-160/(i-2))*(this.tabletopObject.currntImageIndex<=e?e-1:e)}showIconOffset(e){let i=this.tabletopObject.faceIcons.length;return i<=5?0:(50-200/(i-1))*e+2}}return n.\u0275fac=function(e){return new(e||n)(Le(Ir),Le(In),Le(kn),Le(ai))},n.\u0275cmp=Zt({type:n,selectors:[["game-character-sheet"]],viewQuery:function(e,i){if(1&e&&on(AH,5),2&e){let r;sn(r=an())&&(i.mainImageElement=r.first)}},inputs:{tabletopObject:"tabletopObject"},decls:19,vars:14,consts:[[3,"click"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[4,"ngIf"],["class","flex-container",4,"ngIf"],[1,"progress"],[3,"ngModel","change",4,"ngIf"],[3,"ngModel","change"],["value","table"],["value","common"],[3,"value"],["value","graveyard"],[1,"flex-container"],[1,"shadow-image",3,"src","alt","click"],["class","box main-image-box",4,"ngIf"],[1,"box","main-image-box"],[1,"icons-box"],["style","position: relative",3,"top",4,"ngFor","ngForOf","ngForTrackBy"],[1,"image-showcase",2,"position","absolute","height","50px","top","300px"],["class","image-thumbnail","style","position: absolute;",3,"ngClass","left",4,"ngFor","ngForOf"],["style","position: relative; bottom: 30px; z-index: 700;",3,"left","click",4,"ngIf"],["class","text",3,"width","height","ngStyle",4,"ngIf"],[1,"inverser",2,"display","inline-block",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"main-image",3,"src","alt","ngClass","dblclick","load"],["mainImage",""],["class","icon-image-box",3,"ngClass",4,"ngIf"],[1,"icon-image-box",3,"ngClass"],[3,"src","alt","click"],["class","button-delete-icon","title","\u9854IC\u524a\u9664",3,"click",4,"ngIf"],["title","\u9854IC\u524a\u9664",1,"button-delete-icon",3,"click"],[1,"material-icons",2,"font-size","1rem"],[1,"image-thumbnail",2,"position","absolute",3,"ngClass"],[2,"position","relative","bottom","30px","z-index","700",3,"click"],[1,"text",3,"ngStyle"],[3,"innerHTML"],[1,"flex-item"],[1,"table"],["game-data-element","",1,"table-row",3,"gameDataElement","tableTopObjectName","isTagLocked","isHideText","isNoLogging","descriptionType"],["style","margin-top: 3px; text-align: right",4,"ngIf"],[2,"margin-top","3px","text-align","right"],[2,"font-size","11px","color","#444",3,"click"],["class","flex-item",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","tableTopObjectName","isEdit","isNoLogging"],[2,"width","100%","color","#555",3,"click"]],template:function(e,i){1&e&&(K(0,"button",0),Te("click",function(){return i.toggleEditMode()}),be(1,"\u7de8\u96c6\u5207\u308a\u66ff\u3048"),J(),Ve(2,1),xe(3,PH,1,0,"ng-container",2),xe(4,NH,5,1,"ng-container",2),xe(5,FH,3,0,"ng-container",2),xe(6,OH,5,0,"ng-container",2),xe(7,RH,3,1,"ng-container",2),xe(8,BH,5,3,"ng-container",2),xe(9,zH,2,1,"ng-container",3),Ge(),K(10,"button",0),Te("click",function(){return i.clone()}),be(11,"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b"),J(),K(12,"button",4),Te("click",function(){return i.saveToXML()}),K(13,"div",5)(14,"div",6),be(15,"\u4fdd\u5b58"),J(),xe(16,jH,2,1,"div",7),J()(),xe(17,UH,4,2,"ng-container",8),xe(18,lU,7,9,"div",9)),2&e&&(U(2),te("ngSwitch",i.tabletopObject.aliasName),U(1),te("ngSwitchCase","numberResource"),U(1),te("ngSwitchCase","card"),U(1),te("ngSwitchCase","card-stack"),U(1),te("ngSwitchCase","terrain"),U(1),te("ngSwitchCase","dice-symbol"),U(1),te("ngSwitchCase","character"),U(4),te("disabled",i.isSaveing),U(2),te("ngClass",ut(12,cU,i.isSaveing)),U(2),te("ngIf",i.isSaveing),U(1),te("ngIf","character"===i.tabletopObject.aliasName),U(1),te("ngIf",i.tabletopObject))},directives:[xl,Cd,xd,_n,Wn,es,hi,oi,zr,jr,ei,Zi,DH],pipes:[ti],styles:["[_nghost-%COMP%]{display:block}.main-image-box[_ngcontent-%COMP%]{width:250px;height:250px;z-index:0}.main-image[_ngcontent-%COMP%]{width:250px;-o-object-position:center bottom;object-position:center bottom}.image-showcase[_ngcontent-%COMP%]{vertical-align:top;text-align:left;position:absolute;display:inline-block;vertical-align:bottom;transform-origin:center bottom}.image-thumbnail[_ngcontent-%COMP%]{color:#000;filter:drop-shadow(1px 1px 0px rgb(255,244,232)) drop-shadow(-1px 1px 0px rgb(255,244,232)) drop-shadow(-1px -1px 0px rgb(255,244,232)) drop-shadow(1px -1px 0px rgb(255,244,232));z-index:100;vertical-align:bottom;transform-origin:center bottom;transition:all 132ms ease-in-out}.image-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;max-height:100px;position:absolute;left:0;right:0;bottom:0;margin:auto;-o-object-fit:contain;object-fit:contain;-o-object-position:center bottom;object-position:center bottom;transform-origin:center bottom}.image-thumbnail[_ngcontent-%COMP%]:hover{z-index:600}.image-thumbnail[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{width:75px;max-height:150px;left:-12px;transition:all 132ms ease-in-out}.image-thumbnail.hide[_ngcontent-%COMP%]{transform:scale3d(0,0,0)}.icons-box[_ngcontent-%COMP%]{vertical-align:top;text-align:center;position:absolute;left:216px;z-index:2}.icon-image-box[_ngcontent-%COMP%]{position:relative;width:50px;height:50px;max-width:50px;max-height:50px;border-radius:.5rem;color:#000;filter:drop-shadow(1px 1px 0px rgb(255,244,232)) drop-shadow(-1px 1px 0px rgb(255,244,232)) drop-shadow(-1px -1px 0px rgb(255,244,232)) drop-shadow(1px -1px 0px rgb(255,244,232));z-index:100;margin-top:1px;margin-left:-3px}.icon-image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:.5rem;border:2px solid transparent}.icon-image-box[_ngcontent-%COMP%]:hover{z-index:600}.icon-image-box[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{border:2px dotted rgba(255,0,0,40)}.icon-image-box.current-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid red}.icon-image-box[_ngcontent-%COMP%]{z-index:400}.shadow-image[_ngcontent-%COMP%]{position:absolute;width:50px;filter:brightness(0) blur(1px) drop-shadow(0px 0px 1px #fff);opacity:.7;margin-top:6px;margin-left:6px;z-index:5}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{display:table-row;box-sizing:border-box}.table-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:table-cell;border:1px solid #FFF;vertical-align:top;box-sizing:border-box}.box[_ngcontent-%COMP%]{display:inline-block;margin:5px;box-sizing:border-box}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px 0;padding:10px;flex:1 0 auto;box-sizing:border-box;min-width:25px;background-color:#eac99dcc;background-color:#f0dabdcc;color:#444;z-index:1}.flex-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{color:#ccc}.button-delete-icon[_ngcontent-%COMP%]{display:inline-block;position:absolute;margin:0;padding:2px 0 0;background-color:transparent;right:-3px;top:1px;height:18px;width:18px;font-size:8px;color:red}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #fff)}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;font-size:.9em}.text[_ngcontent-%COMP%]{transform-origin:left top;position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}"],data:{animation:[xn("switchImage",[Bt(":increment, :decrement",[Ft("200ms ease",nn([Ye({transform:"scale3d(0, 0, 0)"}),Ye({transform:"scale3d(0, 1.2, 1.2)"}),Ye({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),xn("showcase",[Bt(":increment, :decrement",[Ft("200ms 200ms ease-in",nn([Ye({transform:"scale3d(0, 1.0, 1.0)"}),Ye({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),xn("showcaseItem",[Bt(":enter",[Ft("200ms ease",nn([Ye({transform:"scale3d(0, 0, 0)"}),Ye({transform:"scale3d(1.0, 1.0, 1.0)"})]))]),Bt(":leave",[Ft("200ms ease",nn([Ye({transform:"scale3d(1.0, 1.0, 1.0)"}),Ye({transform:"scale3d(0, 0, 0)"})]))])]),xn("bounceInOut",[Bt("void => *",[Ft("600ms ease",nn([Ye({transform:"scale3d(0, 0, 0)",offset:0}),Ye({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),Ye({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),Ye({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),Ye({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Bt("* => void",[Ft(100,Ye({transform:"scale3d(0, 0, 0)"}))])])]}}),n})();const uU=["passwordInput"],dU=function(){return{standalone:!0}};let fU=(()=>{class n{constructor(e,i){this.panelService=e,this.modalService=i,this.password="",this.help="",this.targetPeerContext=null,this.title="",this.targetPeerContext=pi.parse(i.option.peerId?i.option.peerId:"???"),this.title=i.option.title?i.option.title:""}get peerId(){return yt.peerId}get isConnected(){return!(yt.peerIds.length<=1)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title=`\u30d1\u30b9\u30ef\u30fc\u30c9\u3008${this.title}\u3009`),Fe.register(this)}ngAfterViewInit(){this.passwordInputElementRef.nativeElement.focus()}ngOnDestroy(){Fe.unregister(this)}onInputChange(e){this.help=""}submit(){this.targetPeerContext.verifyPassword(this.password)&&this.modalService.resolve(this.password),this.help="\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u9055\u3044\u307e\u3059"}}return n.\u0275fac=function(e){return new(e||n)(Le(In),Le(kn))},n.\u0275cmp=Zt({type:n,selectors:[["password-check"]],viewQuery:function(e,i){if(1&e&&on(uU,7),2&e){let r;sn(r=an())&&(i.passwordInputElementRef=r.first)}},decls:11,vars:4,consts:[["passwordForm","ngForm"],["placeholder","\u30d1\u30b9\u30ef\u30fc\u30c9",3,"ngModel","ngModelOptions","ngModelChange","input"],["passwordInput",""],["type","submit",3,"click"],[2,"font-size","12px"]],template:function(e,i){1&e&&(K(0,"form",null,0)(2,"div"),be(3,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),K(4,"input",1,2),Te("ngModelChange",function(s){return i.password=s})("input",function(s){return i.onInputChange(s.target.value)}),J()(),K(6,"button",3),Te("click",function(){return i.submit()}),be(7,"\u5165\u5ba4"),J()(),K(8,"div")(9,"span",4),be(10),J()()),2&e&&(U(4),te("ngModel",i.password)("ngModelOptions",ea(3,dU)),U(6),qe(i.help))},directives:[Il,Tl,ia,fi,hi,oi],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}"]}),n})();function hU(n,t){if(1&n&&(K(0,"div")(1,"div",9),be(2," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),J(),K(3,"div",9),be(4," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),J(),K(5,"div",9),be(6," \u30eb\u30fc\u30e0\u540d\u524d\u306e\u9577\u3055\u306f128\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),J()()),2&n){ge();const e=Wt(4);U(1),te("hidden",!e.errors.required),U(2),te("hidden",!e.errors.minlength),U(2),te("hidden",!e.errors.maxlength)}}function pU(n,t){if(1&n&&(K(0,"div")(1,"div",9),be(2," \u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u306f12\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),J()()),2&n){ge();const e=Wt(8);U(1),te("hidden",!e.errors.maxlength)}}function gU(n,t){1&n&&(K(0,"div"),be(1," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5408\u8a08\u304c\u9577\u3059\u304e\u308b\u3088\u3046\u3067\u3059\u3002\u3069\u3061\u3089\u304b\u3092\u5c11\u3057\u77ed\u304f\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002 "),J())}function mU(n,t){if(1&n){const e=Xe();K(0,"div")(1,"div"),be(2,"\u30eb\u30fc\u30e0\u540d : "),K(3,"input",3,4),Te("input",function(r){De(e);const s=ge();return s.calcPeerId(r.target.value,s.password)})("ngModelChange",function(r){return De(e),ge().roomName=r}),J()(),K(5,"div"),be(6,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),K(7,"input",5,6),Te("input",function(r){De(e);const s=ge();return s.calcPeerId(s.roomName,r.target.value)})("ngModelChange",function(r){return De(e),ge().password=r}),J()(),it(9,"hr"),xe(10,hU,7,3,"div",7),xe(11,pU,3,1,"div",7),xe(12,gU,2,0,"div",7),K(13,"div")(14,"button",8),Te("click",function(){return De(e),ge().createRoom()}),be(15,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210"),J()()()}if(2&n){const e=Wt(4),i=Wt(8),r=ge();U(3),te("ngModel",r.roomName),U(4),te("ngModel",r.password),U(3),te("ngIf",e.errors&&(e.dirty||e.touched)),U(1),te("ngIf",i.errors&&(i.dirty||i.touched)),U(1),te("ngIf",!r.validateLength),U(2),te("disabled",!e.valid||!i.valid||!r.validateLength)}}function _U(n,t){1&n&&(K(0,"span",1),be(1,"\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u63a5\u7d9a\u3057\u305f\u307e\u307e\u3067\u306f\u30eb\u30fc\u30e0\u4f5c\u6210\u3092\u884c\u3048\u307e\u305b\u3093\u3002"),it(2,"br"),be(3,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),it(4,"br"),be(5,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),J())}let $U=(()=>{class n{constructor(e,i){this.panelService=e,this.modalService=i,this.peers=[],this.isReloading=!1,this.roomName="\u3075\u3064\u3046\u306e\u90e8\u5c4b",this.password="",this.isPrivate=!1,this.validateLength=!1}get peerId(){return yt.peerId}get isConnected(){return!(yt.peerIds.length<=1)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30eb\u30fc\u30e0\u4f5c\u6210"),Fe.register(this),this.calcPeerId(this.roomName,this.password)}ngOnDestroy(){Fe.unregister(this)}calcPeerId(e,i){let r=yt.peerContext?yt.peerContext.userId:pi.generateId(),s=pi.create(r,pi.generateId("***"),e,i);this.validateLength=s.peerId.length<64}createRoom(){let e=yt.peerContext?yt.peerContext.userId:pi.generateId();yt.open(e,pi.generateId("***"),this.roomName,this.password),Ue.myCursor.peerId=yt.peerId,this.modalService.resolve()}}return n.\u0275fac=function(e){return new(e||n)(Le(In),Le(kn))},n.\u0275cmp=Zt({type:n,selectors:[["room-setting"]],decls:6,vars:2,consts:[[4,"ngIf","ngIfElse"],[2,"font-size","12px"],["other_content",""],["required","","minlength","1","maxlength","128","placeholder","\u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808",1,"input",3,"ngModel","input","ngModelChange"],["roomNameValidation","ngModel"],["maxlength","12","placeholder","\u7a7a\u306a\u3089\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u3057",1,"input",3,"ngModel","input","ngModelChange"],["passwordValidation","ngModel"],[4,"ngIf"],[3,"disabled","click"],[3,"hidden"]],template:function(e,i){if(1&e&&(xe(0,mU,16,6,"div",0),K(1,"div")(2,"span",1),be(3,"\u203b\u4f5c\u6210\u3057\u305f\u30eb\u30fc\u30e0\u306f\u53c2\u52a0\u8005\u304c0\u4eba\u306b\u306a\u3063\u305f\u6642\u70b9\u3067\u89e3\u6563\u3057\u307e\u3059\u3002\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),J()(),xe(4,_U,6,0,"ng-template",null,2,Ln)),2&e){const r=Wt(5);te("ngIf",!i.isConnected)("ngIfElse",r)}},directives:[_n,fi,np,z$,j$,hi,oi],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.input[_ngcontent-%COMP%]{width:100%}"]}),n})();function vU(n,t){1&n&&(K(0,"td")(1,"i",11),be(2,"lock"),J()())}function bU(n,t){1&n&&(K(0,"td"),be(1,"-"),J())}function yU(n,t){if(1&n){const e=Xe();K(0,"button",12),Te("click",function(){De(e);const r=ge().$implicit;return ge(3).connect(r.peerContexts)}),be(1,"\u63a5\u7d9a"),J()}if(2&n){const e=ge().$implicit,i=ge(3);te("disabled",(null==e.peerContexts[0]?null:e.peerContexts[0].roomId)===i.currentRoom)}}function CU(n,t){if(1&n&&(Ve(0),K(1,"tr")(2,"td",9),be(3),J(),K(4,"td",7),be(5),J(),xe(6,vU,3,0,"td",4),xe(7,bU,2,0,"td",4),K(8,"td"),be(9),J(),K(10,"td"),xe(11,yU,2,1,"button",10),J()(),Ge()),2&n){const e=t.$implicit;U(3),qe(null==e.peerContexts[0]?null:e.peerContexts[0].roomId),U(2),qe(e.roomName),U(1),te("ngIf",e.peerContexts[0].hasPassword),U(1),te("ngIf",!e.peerContexts[0].hasPassword),U(2),An("",e.peerContexts.length,"\u4eba"),U(2),te("ngIf",0<e.alias.length)}}function xU(n,t){if(1&n&&(Ve(0),K(1,"table",6)(2,"tr")(3,"th"),be(4,"\u30eb\u30fc\u30e0ID"),J(),K(5,"th",7),be(6,"\u30eb\u30fc\u30e0\u540d"),J(),K(7,"th"),be(8,"\u30d1\u30b9\u30ef\u30fc\u30c9"),J(),K(9,"th"),be(10,"\u53c2\u52a0\u8005"),J(),it(11,"th"),J(),xe(12,CU,12,6,"ng-container",8),J(),Ge()),2&n){const e=ge(2);U(12),te("ngForOf",e.rooms)}}function wU(n,t){if(1&n&&(K(0,"span",13),be(1),J()),2&n){const e=ge(2);U(1),qe(e.help)}}function EU(n,t){if(1&n){const e=Xe();K(0,"div")(1,"button",2),Te("click",function(){return De(e),ge().reload()}),be(2,"\u4e00\u89a7\u3092\u66f4\u65b0"),J(),K(3,"button",3),Te("click",function(){return De(e),ge().showRoomSetting()}),be(4,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b"),J(),it(5,"hr"),xe(6,xU,13,1,"ng-container",4),xe(7,wU,2,1,"span",5),J()}if(2&n){const e=ge();U(1),te("disabled",e.isReloading),U(5),te("ngIf",e.rooms.length),U(1),te("ngIf",e.rooms.length<1)}}function TU(n,t){1&n&&(K(0,"span",13),be(1,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),it(2,"br"),be(3,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),J())}let IU=(()=>{class n{constructor(e,i){this.panelService=e,this.modalService=i,this.rooms=[],this.isReloading=!1,this.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"}get currentRoom(){return yt.peerContext.roomId}get peerId(){return yt.peerId}get isConnected(){return!(yt.peerIds.length<=1)}ngOnInit(){Promise.resolve().then(()=>this.changeTitle()),Fe.register(this).on("OPEN_NETWORK",e=>{this.changeTitle()}).on("CONNECT_PEER",e=>{this.changeTitle()}),this.reload()}changeTitle(){this.modalService.title=this.panelService.title="\u30ed\u30d3\u30fc",yt.peerContext.roomName.length&&(this.modalService.title=this.panelService.title="\u3008"+yt.peerContext.roomName+"/"+yt.peerContext.roomId+"\u3009")}ngOnDestroy(){Fe.unregister(this)}reload(){var e=this;return(0,en.Z)(function*(){e.isReloading=!0,e.help="\u691c\u7d22\u4e2d...",e.rooms=[];let i={},r=yield yt.listAllPeers();for(let s of r){let o=pi.parse(s);if(o.isRoom){let c=o.roomId+o.roomName;c in i||(i[c]=[]),i[c].push(o)}}for(let s in i)e.rooms.push({alias:s,roomName:i[s][0].roomName,peerContexts:i[s]});e.rooms.sort((s,o)=>s.alias<o.alias?-1:s.alias>o.alias?1:0),e.help="\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u300c\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b\u300d\u3067\u65b0\u898f\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002",e.isReloading=!1})()}connect(e){var i=this;return(0,en.Z)(function*(){let r=e[0],s="";if(r.hasPassword&&(s=yield i.modalService.open(fU,{peerId:r.peerId,title:`${r.roomName}/${r.roomId}`}),null==s&&(s="")),!r.verifyPassword(s))return;let o=yt.peerContext?yt.peerContext.userId:pi.generateId();yt.open(o,r.roomId,r.roomName,s),Ue.myCursor.peerId=yt.peerId;let c=[];Fe.register(c).on("OPEN_NETWORK",m=>{console.log("LobbyComponent OPEN_PEER",m.data.peerId),Fe.unregister(c),lt.instance.clearDeleteHistory();for(let I of e)yt.connect(I.peerId);Fe.register(c).on("CONNECT_PEER",I=>{console.log("\u63a5\u7d9a\u6210\u529f\uff01",I.data.peerId),c.push(I.data.peerId),console.log("\u63a5\u7d9a\u6210\u529f "+c.length+"/"+e.length),e.length<=c.length&&(i.resetNetwork(),Fe.unregister(c),i.closeIfConnected())}).on("DISCONNECT_PEER",I=>{console.warn("\u63a5\u7d9a\u5931\u6557",I.data.peerId),c.push(I.data.peerId),console.warn("\u63a5\u7d9a\u5931\u6557 "+c.length+"/"+e.length),e.length<=c.length&&(i.resetNetwork(),Fe.unregister(c),i.closeIfConnected())})})})()}resetNetwork(){yt.peerContexts.length<1&&(yt.open(),Ue.myCursor.peerId=yt.peerId)}closeIfConnected(){0<yt.peerContexts.length&&this.modalService.resolve()}showRoomSetting(){var e=this;return(0,en.Z)(function*(){yield e.modalService.open($U,{width:700,height:400,left:0,top:400}),e.reload(),e.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"})()}}return n.\u0275fac=function(e){return new(e||n)(Le(In),Le(kn))},n.\u0275cmp=Zt({type:n,selectors:[["lobby"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["other_content",""],[3,"disabled","click"],[3,"click"],[4,"ngIf"],["style","font-size: 12px;",4,"ngIf"],[1,"room-list"],[1,"room-name"],[4,"ngFor","ngForOf"],[1,"is-small-font"],["type","submit",3,"disabled","click",4,"ngIf"],[1,"material-icons",2,"vertical-align","middle","font-size","0.9rem"],["type","submit",3,"disabled","click"],[2,"font-size","12px"]],template:function(e,i){if(1&e&&(xe(0,EU,8,3,"div",0),xe(1,TU,4,0,"ng-template",null,1,Ln)),2&e){const r=Wt(2);te("ngIf",!i.isConnected)("ngIfElse",r)}},directives:[_n,ei],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.room-list[_ngcontent-%COMP%]{font-size:12px;border:0;border-spacing:0;padding:0;width:100%;max-width:100%;white-space:nowrap}.room-list[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:1px .5em;text-align:center}.room-name[_ngcontent-%COMP%]{white-space:normal;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;min-width:50%}.is-small-font[_ngcontent-%COMP%]{font-size:10px}"]}),n})();var Ji_isObject=function SU(n){return"object"==typeof n&&null!==n},Ji_repeat=function DU(n,t){var i,e="";for(i=0;i<t;i+=1)e+=n;return e},Ji_isNegativeZero=function AU(n){return 0===n&&Number.NEGATIVE_INFINITY===1/n};function OT(n,t){var e="",i=n.reason||"(unknown reason)";return n.mark?(n.mark.name&&(e+='in "'+n.mark.name+'" '),e+="("+(n.mark.line+1)+":"+(n.mark.column+1)+")",!t&&n.mark.snippet&&(e+="\n\n"+n.mark.snippet),i+" "+e):i}function sf(n,t){Error.call(this),this.name="YAMLException",this.reason=n,this.mark=t,this.message=OT(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}(sf.prototype=Object.create(Error.prototype)).constructor=sf,sf.prototype.toString=function(t){return this.name+": "+OT(this,t)};var Ur=sf;function t1(n,t,e,i,r){var s="",o="",c=Math.floor(r/2)-1;return i-t>c&&(t=i-c+(s=" ... ").length),e-i>c&&(e=i+c-(o=" ...").length),{str:s+n.slice(t,e).replace(/\t/g,"\u2192")+o,pos:i-t+s.length}}function n1(n,t){return Ji_repeat(" ",t-n.length)+n}var jU=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],HU=["scalar","sequence","mapping"],hr=function VU(n,t){if(t=t||{},Object.keys(t).forEach(function(e){if(-1===jU.indexOf(e))throw new Ur('Unknown option "'+e+'" is met in definition of "'+n+'" YAML type.')}),this.options=t,this.tag=n,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(e){return e},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=function UU(n){var t={};return null!==n&&Object.keys(n).forEach(function(e){n[e].forEach(function(i){t[String(i)]=e})}),t}(t.styleAliases||null),-1===HU.indexOf(this.kind))throw new Ur('Unknown kind "'+this.kind+'" is specified for "'+n+'" YAML type.')};function RT(n,t){var e=[];return n[t].forEach(function(i){var r=e.length;e.forEach(function(s,o){s.tag===i.tag&&s.kind===i.kind&&s.multi===i.multi&&(r=o)}),e[r]=i}),e}function i1(n){return this.extend(n)}i1.prototype.extend=function(t){var e=[],i=[];if(t instanceof hr)i.push(t);else if(Array.isArray(t))i=i.concat(t);else{if(!t||!Array.isArray(t.implicit)&&!Array.isArray(t.explicit))throw new Ur("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");t.implicit&&(e=e.concat(t.implicit)),t.explicit&&(i=i.concat(t.explicit))}e.forEach(function(s){if(!(s instanceof hr))throw new Ur("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(s.loadKind&&"scalar"!==s.loadKind)throw new Ur("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(s.multi)throw new Ur("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),i.forEach(function(s){if(!(s instanceof hr))throw new Ur("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var r=Object.create(i1.prototype);return r.implicit=(this.implicit||[]).concat(e),r.explicit=(this.explicit||[]).concat(i),r.compiledImplicit=RT(r,"implicit"),r.compiledExplicit=RT(r,"explicit"),r.compiledTypeMap=function GU(){var t,e,n={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function i(r){r.multi?(n.multi[r.kind].push(r),n.multi.fallback.push(r)):n[r.kind][r.tag]=n.fallback[r.tag]=r}for(t=0,e=arguments.length;t<e;t+=1)arguments[t].forEach(i);return n}(r.compiledImplicit,r.compiledExplicit),r};var BT=i1,LT=new hr("tag:yaml.org,2002:str",{kind:"scalar",construct:function(n){return null!==n?n:""}}),zT=new hr("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(n){return null!==n?n:[]}}),jT=new hr("tag:yaml.org,2002:map",{kind:"mapping",construct:function(n){return null!==n?n:{}}}),HT=new BT({explicit:[LT,zT,jT]}),UT=new hr("tag:yaml.org,2002:null",{kind:"scalar",resolve:function qU(n){if(null===n)return!0;var t=n.length;return 1===t&&"~"===n||4===t&&("null"===n||"Null"===n||"NULL"===n)},construct:function WU(){return null},predicate:function KU(n){return null===n},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"}),VT=new hr("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function YU(n){if(null===n)return!1;var t=n.length;return 4===t&&("true"===n||"True"===n||"TRUE"===n)||5===t&&("false"===n||"False"===n||"FALSE"===n)},construct:function ZU(n){return"true"===n||"True"===n||"TRUE"===n},predicate:function XU(n){return"[object Boolean]"===Object.prototype.toString.call(n)},represent:{lowercase:function(n){return n?"true":"false"},uppercase:function(n){return n?"TRUE":"FALSE"},camelcase:function(n){return n?"True":"False"}},defaultStyle:"lowercase"});function QU(n){return 48<=n&&n<=57||65<=n&&n<=70||97<=n&&n<=102}function JU(n){return 48<=n&&n<=55}function eV(n){return 48<=n&&n<=57}var GT=new hr("tag:yaml.org,2002:int",{kind:"scalar",resolve:function tV(n){if(null===n)return!1;var r,t=n.length,e=0,i=!1;if(!t)return!1;if(("-"===(r=n[e])||"+"===r)&&(r=n[++e]),"0"===r){if(e+1===t)return!0;if("b"===(r=n[++e])){for(e++;e<t;e++)if("_"!==(r=n[e])){if("0"!==r&&"1"!==r)return!1;i=!0}return i&&"_"!==r}if("x"===r){for(e++;e<t;e++)if("_"!==(r=n[e])){if(!QU(n.charCodeAt(e)))return!1;i=!0}return i&&"_"!==r}if("o"===r){for(e++;e<t;e++)if("_"!==(r=n[e])){if(!JU(n.charCodeAt(e)))return!1;i=!0}return i&&"_"!==r}}if("_"===r)return!1;for(;e<t;e++)if("_"!==(r=n[e])){if(!eV(n.charCodeAt(e)))return!1;i=!0}return!(!i||"_"===r)},construct:function nV(n){var i,t=n,e=1;if(-1!==t.indexOf("_")&&(t=t.replace(/_/g,"")),("-"===(i=t[0])||"+"===i)&&("-"===i&&(e=-1),i=(t=t.slice(1))[0]),"0"===t)return 0;if("0"===i){if("b"===t[1])return e*parseInt(t.slice(2),2);if("x"===t[1])return e*parseInt(t.slice(2),16);if("o"===t[1])return e*parseInt(t.slice(2),8)}return e*parseInt(t,10)},predicate:function iV(n){return"[object Number]"===Object.prototype.toString.call(n)&&n%1==0&&!Ji_isNegativeZero(n)},represent:{binary:function(n){return n>=0?"0b"+n.toString(2):"-0b"+n.toString(2).slice(1)},octal:function(n){return n>=0?"0o"+n.toString(8):"-0o"+n.toString(8).slice(1)},decimal:function(n){return n.toString(10)},hexadecimal:function(n){return n>=0?"0x"+n.toString(16).toUpperCase():"-0x"+n.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),rV=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),aV=/^[-+]?[0-9]+e/,qT=new hr("tag:yaml.org,2002:float",{kind:"scalar",resolve:function sV(n){return!(null===n||!rV.test(n)||"_"===n[n.length-1])},construct:function oV(n){var t,e;return e="-"===(t=n.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),".inf"===t?1===e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===t?NaN:e*parseFloat(t,10)},predicate:function cV(n){return"[object Number]"===Object.prototype.toString.call(n)&&(n%1!=0||Ji_isNegativeZero(n))},represent:function lV(n,t){var e;if(isNaN(n))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===n)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===n)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(Ji_isNegativeZero(n))return"-0.0";return e=n.toString(10),aV.test(e)?e.replace("e",".e"):e},defaultStyle:"lowercase"}),KT=HT.extend({implicit:[UT,VT,GT,qT]}),ZT=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),XT=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$"),QT=new hr("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function uV(n){return null!==n&&(null!==ZT.exec(n)||null!==XT.exec(n))},construct:function dV(n){var t,e,i,r,s,o,c,pe,m=0,I=null;if(null===(t=ZT.exec(n))&&(t=XT.exec(n)),null===t)throw new Error("Date resolve error");if(e=+t[1],i=+t[2]-1,r=+t[3],!t[4])return new Date(Date.UTC(e,i,r));if(s=+t[4],o=+t[5],c=+t[6],t[7]){for(m=t[7].slice(0,3);m.length<3;)m+="0";m=+m}return t[9]&&(I=6e4*(60*+t[10]+ +(t[11]||0)),"-"===t[9]&&(I=-I)),pe=new Date(Date.UTC(e,i,r,s,o,c,m)),I&&pe.setTime(pe.getTime()-I),pe},instanceOf:Date,represent:function fV(n){return n.toISOString()}}),JT=new hr("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function hV(n){return"<<"===n||null===n}}),r1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r",eI=new hr("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function pV(n){if(null===n)return!1;var t,e,i=0,r=n.length,s=r1;for(e=0;e<r;e++)if(!((t=s.indexOf(n.charAt(e)))>64)){if(t<0)return!1;i+=6}return i%8==0},construct:function gV(n){var t,e,i=n.replace(/[\r\n=]/g,""),r=i.length,s=r1,o=0,c=[];for(t=0;t<r;t++)t%4==0&&t&&(c.push(o>>16&255),c.push(o>>8&255),c.push(255&o)),o=o<<6|s.indexOf(i.charAt(t));return 0==(e=r%4*6)?(c.push(o>>16&255),c.push(o>>8&255),c.push(255&o)):18===e?(c.push(o>>10&255),c.push(o>>2&255)):12===e&&c.push(o>>4&255),new Uint8Array(c)},predicate:function _V(n){return"[object Uint8Array]"===Object.prototype.toString.call(n)},represent:function mV(n){var i,r,t="",e=0,s=n.length,o=r1;for(i=0;i<s;i++)i%3==0&&i&&(t+=o[e>>18&63],t+=o[e>>12&63],t+=o[e>>6&63],t+=o[63&e]),e=(e<<8)+n[i];return 0==(r=s%3)?(t+=o[e>>18&63],t+=o[e>>12&63],t+=o[e>>6&63],t+=o[63&e]):2===r?(t+=o[e>>10&63],t+=o[e>>4&63],t+=o[e<<2&63],t+=o[64]):1===r&&(t+=o[e>>2&63],t+=o[e<<4&63],t+=o[64],t+=o[64]),t}}),$V=Object.prototype.hasOwnProperty,vV=Object.prototype.toString,tI=new hr("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function bV(n){if(null===n)return!0;var e,i,r,s,o,t=[],c=n;for(e=0,i=c.length;e<i;e+=1){if(o=!1,"[object Object]"!==vV.call(r=c[e]))return!1;for(s in r)if($V.call(r,s)){if(o)return!1;o=!0}if(!o)return!1;if(-1!==t.indexOf(s))return!1;t.push(s)}return!0},construct:function yV(n){return null!==n?n:[]}}),CV=Object.prototype.toString,nI=new hr("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function xV(n){if(null===n)return!0;var t,e,i,r,s,o=n;for(s=new Array(o.length),t=0,e=o.length;t<e;t+=1){if("[object Object]"!==CV.call(i=o[t])||1!==(r=Object.keys(i)).length)return!1;s[t]=[r[0],i[r[0]]]}return!0},construct:function wV(n){if(null===n)return[];var t,e,i,r,s,o=n;for(s=new Array(o.length),t=0,e=o.length;t<e;t+=1)i=o[t],r=Object.keys(i),s[t]=[r[0],i[r[0]]];return s}}),EV=Object.prototype.hasOwnProperty,iI=new hr("tag:yaml.org,2002:set",{kind:"mapping",resolve:function TV(n){if(null===n)return!0;var t,e=n;for(t in e)if(EV.call(e,t)&&null!==e[t])return!1;return!0},construct:function IV(n){return null!==n?n:{}}}),s1=KT.extend({implicit:[QT,JT],explicit:[eI,tI,nI,iI]}),Xa=Object.prototype.hasOwnProperty,MV=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,kV=/[\x85\u2028\u2029]/,DV=/[,\[\]\{\}]/,aI=/^(?:!|!!|![a-z\-]+!)$/i,lI=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function cI(n){return Object.prototype.toString.call(n)}function Ho(n){return 10===n||13===n}function Wl(n){return 9===n||32===n}function rs(n){return 9===n||32===n||10===n||13===n}function pu(n){return 44===n||91===n||93===n||123===n||125===n}function AV(n){var t;return 48<=n&&n<=57?n-48:97<=(t=32|n)&&t<=102?t-97+10:-1}function PV(n){return 120===n?2:117===n?4:85===n?8:0}function NV(n){return 48<=n&&n<=57?n-48:-1}function uI(n){return 48===n?"\0":97===n?"\x07":98===n?"\b":116===n||9===n?"\t":110===n?"\n":118===n?"\v":102===n?"\f":114===n?"\r":101===n?"\x1b":32===n?" ":34===n?'"':47===n?"/":92===n?"\\":78===n?"\x85":95===n?"\xa0":76===n?"\u2028":80===n?"\u2029":""}function FV(n){return n<=65535?String.fromCharCode(n):String.fromCharCode(55296+(n-65536>>10),56320+(n-65536&1023))}for(var dI=new Array(256),fI=new Array(256),gu=0;gu<256;gu++)dI[gu]=uI(gu)?1:0,fI[gu]=uI(gu);function OV(n,t){this.input=n,this.filename=t.filename||null,this.schema=t.schema||s1,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=n.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function hI(n,t){var e={name:n.filename,buffer:n.input.slice(0,-1),position:n.position,line:n.line,column:n.position-n.lineStart};return e.snippet=function LU(n,t){if(t=Object.create(t||null),!n.buffer)return null;t.maxLength||(t.maxLength=79),"number"!=typeof t.indent&&(t.indent=1),"number"!=typeof t.linesBefore&&(t.linesBefore=3),"number"!=typeof t.linesAfter&&(t.linesAfter=2);for(var s,e=/\r?\n|\r|\0/g,i=[0],r=[],o=-1;s=e.exec(n.buffer);)r.push(s.index),i.push(s.index+s[0].length),n.position<=s.index&&o<0&&(o=i.length-2);o<0&&(o=i.length-1);var m,I,c="",Z=Math.min(n.line+t.linesAfter,r.length).toString().length,fe=t.maxLength-(t.indent+Z+3);for(m=1;m<=t.linesBefore&&!(o-m<0);m++)I=t1(n.buffer,i[o-m],r[o-m],n.position-(i[o]-i[o-m]),fe),c=Ji_repeat(" ",t.indent)+n1((n.line-m+1).toString(),Z)+" | "+I.str+"\n"+c;for(I=t1(n.buffer,i[o],r[o],n.position,fe),c+=Ji_repeat(" ",t.indent)+n1((n.line+1).toString(),Z)+" | "+I.str+"\n",c+=Ji_repeat("-",t.indent+Z+3+I.pos)+"^\n",m=1;m<=t.linesAfter&&!(o+m>=r.length);m++)I=t1(n.buffer,i[o+m],r[o+m],n.position-(i[o]-i[o+m]),fe),c+=Ji_repeat(" ",t.indent)+n1((n.line+m+1).toString(),Z)+" | "+I.str+"\n";return c.replace(/\n$/,"")}(e),new Ur(t,e)}function Gt(n,t){throw hI(n,t)}function og(n,t){n.onWarning&&n.onWarning.call(null,hI(n,t))}var pI={YAML:function(t,e,i){var r,s,o;null!==t.version&&Gt(t,"duplication of %YAML directive"),1!==i.length&&Gt(t,"YAML directive accepts exactly one argument"),null===(r=/^([0-9]+)\.([0-9]+)$/.exec(i[0]))&&Gt(t,"ill-formed argument of the YAML directive"),s=parseInt(r[1],10),o=parseInt(r[2],10),1!==s&&Gt(t,"unacceptable YAML version of the document"),t.version=i[0],t.checkLineBreaks=o<2,1!==o&&2!==o&&og(t,"unsupported YAML version of the document")},TAG:function(t,e,i){var r,s;2!==i.length&&Gt(t,"TAG directive accepts exactly two arguments"),s=i[1],aI.test(r=i[0])||Gt(t,"ill-formed tag handle (first argument) of the TAG directive"),Xa.call(t.tagMap,r)&&Gt(t,'there is a previously declared suffix for "'+r+'" tag handle'),lI.test(s)||Gt(t,"ill-formed tag prefix (second argument) of the TAG directive");try{s=decodeURIComponent(s)}catch(o){Gt(t,"tag prefix is malformed: "+s)}t.tagMap[r]=s}};function Qa(n,t,e,i){var r,s,o,c;if(t<e){if(c=n.input.slice(t,e),i)for(r=0,s=c.length;r<s;r+=1)9===(o=c.charCodeAt(r))||32<=o&&o<=1114111||Gt(n,"expected valid JSON character");else MV.test(c)&&Gt(n,"the stream contains non-printable characters");n.result+=c}}function gI(n,t,e,i){var r,s,o,c;for(Ji_isObject(e)||Gt(n,"cannot merge mappings; the provided source object is unacceptable"),o=0,c=(r=Object.keys(e)).length;o<c;o+=1)Xa.call(t,s=r[o])||(t[s]=e[s],i[s]=!0)}function mu(n,t,e,i,r,s,o,c,m){var I,Z;if(Array.isArray(r))for(I=0,Z=(r=Array.prototype.slice.call(r)).length;I<Z;I+=1)Array.isArray(r[I])&&Gt(n,"nested arrays are not supported inside keys"),"object"==typeof r&&"[object Object]"===cI(r[I])&&(r[I]="[object Object]");if("object"==typeof r&&"[object Object]"===cI(r)&&(r="[object Object]"),r=String(r),null===t&&(t={}),"tag:yaml.org,2002:merge"===i)if(Array.isArray(s))for(I=0,Z=s.length;I<Z;I+=1)gI(n,t,s[I],e);else gI(n,t,s,e);else!n.json&&!Xa.call(e,r)&&Xa.call(t,r)&&(n.line=o||n.line,n.lineStart=c||n.lineStart,n.position=m||n.position,Gt(n,"duplicated mapping key")),"__proto__"===r?Object.defineProperty(t,r,{configurable:!0,enumerable:!0,writable:!0,value:s}):t[r]=s,delete e[r];return t}function a1(n){var t;10===(t=n.input.charCodeAt(n.position))?n.position++:13===t?(n.position++,10===n.input.charCodeAt(n.position)&&n.position++):Gt(n,"a line break is expected"),n.line+=1,n.lineStart=n.position,n.firstTabInLine=-1}function zi(n,t,e){for(var i=0,r=n.input.charCodeAt(n.position);0!==r;){for(;Wl(r);)9===r&&-1===n.firstTabInLine&&(n.firstTabInLine=n.position),r=n.input.charCodeAt(++n.position);if(t&&35===r)do{r=n.input.charCodeAt(++n.position)}while(10!==r&&13!==r&&0!==r);if(!Ho(r))break;for(a1(n),r=n.input.charCodeAt(n.position),i++,n.lineIndent=0;32===r;)n.lineIndent++,r=n.input.charCodeAt(++n.position)}return-1!==e&&0!==i&&n.lineIndent<e&&og(n,"deficient indentation"),i}function ag(n){var e,t=n.position;return!(45!==(e=n.input.charCodeAt(t))&&46!==e||e!==n.input.charCodeAt(t+1)||e!==n.input.charCodeAt(t+2)||(t+=3,e=n.input.charCodeAt(t),0!==e&&!rs(e)))}function l1(n,t){1===t?n.result+=" ":t>1&&(n.result+=Ji_repeat("\n",t-1))}function mI(n,t){var e,m,i=n.tag,r=n.anchor,s=[],c=!1;if(-1!==n.firstTabInLine)return!1;for(null!==n.anchor&&(n.anchorMap[n.anchor]=s),m=n.input.charCodeAt(n.position);0!==m&&(-1!==n.firstTabInLine&&(n.position=n.firstTabInLine,Gt(n,"tab characters must not be used in indentation")),45===m&&rs(n.input.charCodeAt(n.position+1)));)if(c=!0,n.position++,zi(n,!0,-1)&&n.lineIndent<=t)s.push(null),m=n.input.charCodeAt(n.position);else if(e=n.line,_u(n,t,3,!1,!0),s.push(n.result),zi(n,!0,-1),m=n.input.charCodeAt(n.position),(n.line===e||n.lineIndent>t)&&0!==m)Gt(n,"bad indentation of a sequence entry");else if(n.lineIndent<t)break;return!!c&&(n.tag=i,n.anchor=r,n.kind="sequence",n.result=s,!0)}function UV(n){var t,r,s,o,e=!1,i=!1;if(33!==(o=n.input.charCodeAt(n.position)))return!1;if(null!==n.tag&&Gt(n,"duplication of a tag property"),60===(o=n.input.charCodeAt(++n.position))?(e=!0,o=n.input.charCodeAt(++n.position)):33===o?(i=!0,r="!!",o=n.input.charCodeAt(++n.position)):r="!",t=n.position,e){do{o=n.input.charCodeAt(++n.position)}while(0!==o&&62!==o);n.position<n.length?(s=n.input.slice(t,n.position),o=n.input.charCodeAt(++n.position)):Gt(n,"unexpected end of the stream within a verbatim tag")}else{for(;0!==o&&!rs(o);)33===o&&(i?Gt(n,"tag suffix cannot contain exclamation marks"):(r=n.input.slice(t-1,n.position+1),aI.test(r)||Gt(n,"named tag handle cannot contain such characters"),i=!0,t=n.position+1)),o=n.input.charCodeAt(++n.position);s=n.input.slice(t,n.position),DV.test(s)&&Gt(n,"tag suffix cannot contain flow indicator characters")}s&&!lI.test(s)&&Gt(n,"tag name cannot contain such characters: "+s);try{s=decodeURIComponent(s)}catch(c){Gt(n,"tag name is malformed: "+s)}return e?n.tag=s:Xa.call(n.tagMap,r)?n.tag=n.tagMap[r]+s:"!"===r?n.tag="!"+s:"!!"===r?n.tag="tag:yaml.org,2002:"+s:Gt(n,'undeclared tag handle "'+r+'"'),!0}function VV(n){var t,e;if(38!==(e=n.input.charCodeAt(n.position)))return!1;for(null!==n.anchor&&Gt(n,"duplication of an anchor property"),e=n.input.charCodeAt(++n.position),t=n.position;0!==e&&!rs(e)&&!pu(e);)e=n.input.charCodeAt(++n.position);return n.position===t&&Gt(n,"name of an anchor node must contain at least one character"),n.anchor=n.input.slice(t,n.position),!0}function _u(n,t,e,i,r){var s,o,c,fe,pe,ye,we,Me,Oe,m=1,I=!1,Z=!1;if(null!==n.listener&&n.listener("open",n),n.tag=null,n.anchor=null,n.kind=null,n.result=null,s=o=c=4===e||3===e,i&&zi(n,!0,-1)&&(I=!0,n.lineIndent>t?m=1:n.lineIndent===t?m=0:n.lineIndent<t&&(m=-1)),1===m)for(;UV(n)||VV(n);)zi(n,!0,-1)?(I=!0,c=s,n.lineIndent>t?m=1:n.lineIndent===t?m=0:n.lineIndent<t&&(m=-1)):c=!1;if(c&&(c=I||r),(1===m||4===e)&&(Me=1===e||2===e?t:t+1,Oe=n.position-n.lineStart,1===m?c&&(mI(n,Oe)||function HV(n,t,e){var i,r,s,o,c,m,ke,I=n.tag,Z=n.anchor,fe={},pe=Object.create(null),ye=null,we=null,Me=null,Oe=!1,Be=!1;if(-1!==n.firstTabInLine)return!1;for(null!==n.anchor&&(n.anchorMap[n.anchor]=fe),ke=n.input.charCodeAt(n.position);0!==ke;){if(!Oe&&-1!==n.firstTabInLine&&(n.position=n.firstTabInLine,Gt(n,"tab characters must not be used in indentation")),i=n.input.charCodeAt(n.position+1),s=n.line,63!==ke&&58!==ke||!rs(i)){if(o=n.line,c=n.lineStart,m=n.position,!_u(n,e,2,!1,!0))break;if(n.line===s){for(ke=n.input.charCodeAt(n.position);Wl(ke);)ke=n.input.charCodeAt(++n.position);if(58===ke)rs(ke=n.input.charCodeAt(++n.position))||Gt(n,"a whitespace character is expected after the key-value separator within a block mapping"),Oe&&(mu(n,fe,pe,ye,we,null,o,c,m),ye=we=Me=null),Be=!0,Oe=!1,r=!1,ye=n.tag,we=n.result;else{if(!Be)return n.tag=I,n.anchor=Z,!0;Gt(n,"can not read an implicit mapping pair; a colon is missed")}}else{if(!Be)return n.tag=I,n.anchor=Z,!0;Gt(n,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===ke?(Oe&&(mu(n,fe,pe,ye,we,null,o,c,m),ye=we=Me=null),Be=!0,Oe=!0,r=!0):Oe?(Oe=!1,r=!0):Gt(n,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),n.position+=1,ke=i;if((n.line===s||n.lineIndent>t)&&(Oe&&(o=n.line,c=n.lineStart,m=n.position),_u(n,t,4,!0,r)&&(Oe?we=n.result:Me=n.result),Oe||(mu(n,fe,pe,ye,we,Me,o,c,m),ye=we=Me=null),zi(n,!0,-1),ke=n.input.charCodeAt(n.position)),(n.line===s||n.lineIndent>t)&&0!==ke)Gt(n,"bad indentation of a mapping entry");else if(n.lineIndent<t)break}return Oe&&mu(n,fe,pe,ye,we,null,o,c,m),Be&&(n.tag=I,n.anchor=Z,n.kind="mapping",n.result=fe),Be}(n,Oe,Me))||function zV(n,t){var i,r,s,c,Z,fe,pe,ye,Me,Oe,Be,ke,e=!0,o=n.tag,m=n.anchor,we=Object.create(null);if(91===(ke=n.input.charCodeAt(n.position)))Z=93,ye=!1,c=[];else{if(123!==ke)return!1;Z=125,ye=!0,c={}}for(null!==n.anchor&&(n.anchorMap[n.anchor]=c),ke=n.input.charCodeAt(++n.position);0!==ke;){if(zi(n,!0,t),(ke=n.input.charCodeAt(n.position))===Z)return n.position++,n.tag=o,n.anchor=m,n.kind=ye?"mapping":"sequence",n.result=c,!0;e?44===ke&&Gt(n,"expected the node content, but found ','"):Gt(n,"missed comma between flow collection entries"),Be=null,fe=pe=!1,63===ke&&rs(n.input.charCodeAt(n.position+1))&&(fe=pe=!0,n.position++,zi(n,!0,t)),i=n.line,r=n.lineStart,s=n.position,_u(n,t,1,!1,!0),Oe=n.tag,Me=n.result,zi(n,!0,t),ke=n.input.charCodeAt(n.position),(pe||n.line===i)&&58===ke&&(fe=!0,ke=n.input.charCodeAt(++n.position),zi(n,!0,t),_u(n,t,1,!1,!0),Be=n.result),ye?mu(n,c,we,Oe,Me,Be,i,r,s):c.push(fe?mu(n,null,we,Oe,Me,Be,i,r,s):Me),zi(n,!0,t),44===(ke=n.input.charCodeAt(n.position))?(e=!0,ke=n.input.charCodeAt(++n.position)):e=!1}Gt(n,"unexpected end of the stream within a flow collection")}(n,Me)?Z=!0:(o&&function jV(n,t){var e,i,Z,fe,r=1,s=!1,o=!1,c=t,m=0,I=!1;if(124===(fe=n.input.charCodeAt(n.position)))i=!1;else{if(62!==fe)return!1;i=!0}for(n.kind="scalar",n.result="";0!==fe;)if(43===(fe=n.input.charCodeAt(++n.position))||45===fe)1===r?r=43===fe?3:2:Gt(n,"repeat of a chomping mode identifier");else{if(!((Z=NV(fe))>=0))break;0===Z?Gt(n,"bad explicit indentation width of a block scalar; it cannot be less than one"):o?Gt(n,"repeat of an indentation width identifier"):(c=t+Z-1,o=!0)}if(Wl(fe)){do{fe=n.input.charCodeAt(++n.position)}while(Wl(fe));if(35===fe)do{fe=n.input.charCodeAt(++n.position)}while(!Ho(fe)&&0!==fe)}for(;0!==fe;){for(a1(n),n.lineIndent=0,fe=n.input.charCodeAt(n.position);(!o||n.lineIndent<c)&&32===fe;)n.lineIndent++,fe=n.input.charCodeAt(++n.position);if(!o&&n.lineIndent>c&&(c=n.lineIndent),Ho(fe))m++;else{if(n.lineIndent<c){3===r?n.result+=Ji_repeat("\n",s?1+m:m):1===r&&s&&(n.result+="\n");break}for(i?Wl(fe)?(I=!0,n.result+=Ji_repeat("\n",s?1+m:m)):I?(I=!1,n.result+=Ji_repeat("\n",m+1)):0===m?s&&(n.result+=" "):n.result+=Ji_repeat("\n",m):n.result+=Ji_repeat("\n",s?1+m:m),s=!0,o=!0,m=0,e=n.position;!Ho(fe)&&0!==fe;)fe=n.input.charCodeAt(++n.position);Qa(n,e,n.position,!1)}}return!0}(n,Me)||function BV(n,t){var e,i,r;if(39!==(e=n.input.charCodeAt(n.position)))return!1;for(n.kind="scalar",n.result="",n.position++,i=r=n.position;0!==(e=n.input.charCodeAt(n.position));)if(39===e){if(Qa(n,i,n.position,!0),39!==(e=n.input.charCodeAt(++n.position)))return!0;i=n.position,n.position++,r=n.position}else Ho(e)?(Qa(n,i,r,!0),l1(n,zi(n,!1,t)),i=r=n.position):n.position===n.lineStart&&ag(n)?Gt(n,"unexpected end of the document within a single quoted scalar"):(n.position++,r=n.position);Gt(n,"unexpected end of the stream within a single quoted scalar")}(n,Me)||function LV(n,t){var e,i,r,s,o,c;if(34!==(c=n.input.charCodeAt(n.position)))return!1;for(n.kind="scalar",n.result="",n.position++,e=i=n.position;0!==(c=n.input.charCodeAt(n.position));){if(34===c)return Qa(n,e,n.position,!0),n.position++,!0;if(92===c){if(Qa(n,e,n.position,!0),Ho(c=n.input.charCodeAt(++n.position)))zi(n,!1,t);else if(c<256&&dI[c])n.result+=fI[c],n.position++;else if((o=PV(c))>0){for(r=o,s=0;r>0;r--)(o=AV(c=n.input.charCodeAt(++n.position)))>=0?s=(s<<4)+o:Gt(n,"expected hexadecimal character");n.result+=FV(s),n.position++}else Gt(n,"unknown escape sequence");e=i=n.position}else Ho(c)?(Qa(n,e,i,!0),l1(n,zi(n,!1,t)),e=i=n.position):n.position===n.lineStart&&ag(n)?Gt(n,"unexpected end of the document within a double quoted scalar"):(n.position++,i=n.position)}Gt(n,"unexpected end of the stream within a double quoted scalar")}(n,Me)?Z=!0:function GV(n){var t,e,i;if(42!==(i=n.input.charCodeAt(n.position)))return!1;for(i=n.input.charCodeAt(++n.position),t=n.position;0!==i&&!rs(i)&&!pu(i);)i=n.input.charCodeAt(++n.position);return n.position===t&&Gt(n,"name of an alias node must contain at least one character"),e=n.input.slice(t,n.position),Xa.call(n.anchorMap,e)||Gt(n,'unidentified alias "'+e+'"'),n.result=n.anchorMap[e],zi(n,!0,-1),!0}(n)?(Z=!0,(null!==n.tag||null!==n.anchor)&&Gt(n,"alias node should not have any properties")):function RV(n,t,e){var r,s,o,c,m,I,Z,ye,fe=n.kind,pe=n.result;if(rs(ye=n.input.charCodeAt(n.position))||pu(ye)||35===ye||38===ye||42===ye||33===ye||124===ye||62===ye||39===ye||34===ye||37===ye||64===ye||96===ye||(63===ye||45===ye)&&(rs(r=n.input.charCodeAt(n.position+1))||e&&pu(r)))return!1;for(n.kind="scalar",n.result="",s=o=n.position,c=!1;0!==ye;){if(58===ye){if(rs(r=n.input.charCodeAt(n.position+1))||e&&pu(r))break}else if(35===ye){if(rs(n.input.charCodeAt(n.position-1)))break}else{if(n.position===n.lineStart&&ag(n)||e&&pu(ye))break;if(Ho(ye)){if(m=n.line,I=n.lineStart,Z=n.lineIndent,zi(n,!1,-1),n.lineIndent>=t){c=!0,ye=n.input.charCodeAt(n.position);continue}n.position=o,n.line=m,n.lineStart=I,n.lineIndent=Z;break}}c&&(Qa(n,s,o,!1),l1(n,n.line-m),s=o=n.position,c=!1),Wl(ye)||(o=n.position+1),ye=n.input.charCodeAt(++n.position)}return Qa(n,s,o,!1),!!n.result||(n.kind=fe,n.result=pe,!1)}(n,Me,1===e)&&(Z=!0,null===n.tag&&(n.tag="?")),null!==n.anchor&&(n.anchorMap[n.anchor]=n.result)):0===m&&(Z=c&&mI(n,Oe))),null===n.tag)null!==n.anchor&&(n.anchorMap[n.anchor]=n.result);else if("?"===n.tag){for(null!==n.result&&"scalar"!==n.kind&&Gt(n,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+n.kind+'"'),fe=0,pe=n.implicitTypes.length;fe<pe;fe+=1)if((we=n.implicitTypes[fe]).resolve(n.result)){n.result=we.construct(n.result),n.tag=we.tag,null!==n.anchor&&(n.anchorMap[n.anchor]=n.result);break}}else if("!"!==n.tag){if(Xa.call(n.typeMap[n.kind||"fallback"],n.tag))we=n.typeMap[n.kind||"fallback"][n.tag];else for(we=null,fe=0,pe=(ye=n.typeMap.multi[n.kind||"fallback"]).length;fe<pe;fe+=1)if(n.tag.slice(0,ye[fe].tag.length)===ye[fe].tag){we=ye[fe];break}we||Gt(n,"unknown tag !<"+n.tag+">"),null!==n.result&&we.kind!==n.kind&&Gt(n,"unacceptable node kind for !<"+n.tag+'> tag; it should be "'+we.kind+'", not "'+n.kind+'"'),we.resolve(n.result,n.tag)?(n.result=we.construct(n.result,n.tag),null!==n.anchor&&(n.anchorMap[n.anchor]=n.result)):Gt(n,"cannot resolve a node with !<"+n.tag+"> explicit tag")}return null!==n.listener&&n.listener("close",n),null!==n.tag||null!==n.anchor||Z}function qV(n){var e,i,r,o,t=n.position,s=!1;for(n.version=null,n.checkLineBreaks=n.legacy,n.tagMap=Object.create(null),n.anchorMap=Object.create(null);0!==(o=n.input.charCodeAt(n.position))&&(zi(n,!0,-1),o=n.input.charCodeAt(n.position),!(n.lineIndent>0||37!==o));){for(s=!0,o=n.input.charCodeAt(++n.position),e=n.position;0!==o&&!rs(o);)o=n.input.charCodeAt(++n.position);for(r=[],(i=n.input.slice(e,n.position)).length<1&&Gt(n,"directive name must not be less than one character in length");0!==o;){for(;Wl(o);)o=n.input.charCodeAt(++n.position);if(35===o){do{o=n.input.charCodeAt(++n.position)}while(0!==o&&!Ho(o));break}if(Ho(o))break;for(e=n.position;0!==o&&!rs(o);)o=n.input.charCodeAt(++n.position);r.push(n.input.slice(e,n.position))}0!==o&&a1(n),Xa.call(pI,i)?pI[i](n,i,r):og(n,'unknown document directive "'+i+'"')}zi(n,!0,-1),0===n.lineIndent&&45===n.input.charCodeAt(n.position)&&45===n.input.charCodeAt(n.position+1)&&45===n.input.charCodeAt(n.position+2)?(n.position+=3,zi(n,!0,-1)):s&&Gt(n,"directives end mark is expected"),_u(n,n.lineIndent-1,4,!1,!0),zi(n,!0,-1),n.checkLineBreaks&&kV.test(n.input.slice(t,n.position))&&og(n,"non-ASCII line breaks are interpreted as content"),n.documents.push(n.result),n.position===n.lineStart&&ag(n)?46===n.input.charCodeAt(n.position)&&(n.position+=3,zi(n,!0,-1)):n.position<n.length-1&&Gt(n,"end of the stream or a document separator is expected")}function _I(n,t){t=t||{},0!==(n=String(n)).length&&(10!==n.charCodeAt(n.length-1)&&13!==n.charCodeAt(n.length-1)&&(n+="\n"),65279===n.charCodeAt(0)&&(n=n.slice(1)));var e=new OV(n,t),i=n.indexOf("\0");for(-1!==i&&(e.position=i,Gt(e,"null byte is not allowed in input")),e.input+="\0";32===e.input.charCodeAt(e.position);)e.lineIndent+=1,e.position+=1;for(;e.position<e.length-1;)qV(e);return e.documents}var $I_load=function KV(n,t){var e=_I(n,t);if(0!==e.length){if(1===e.length)return e[0];throw new Ur("expected a single document in the stream, but found more")}};function p1(n,t){return function(){throw new Error("Function yaml."+n+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var BI=$I_load;p1("safeLoad","load"),p1("safeLoadAll","loadAll"),p1("safeDump","dump");const LI=Object.getOwnPropertyNames(Object.prototype),qG=Object.getOwnPropertyNames(Array.prototype);let g1=(()=>{class n{constructor(){this.peerHistory=[],this.isOpen=!1}initialize(){this.initAppConfig()}initAppConfig(){var e=this;return(0,en.Z)(function*(){try{console.log("YAML\u8aad\u307f\u8fbc\u307f...");let i=yield e.loadYaml(),r=BI(i);n.applyConfig(r)}catch(i){console.warn(i)}Fe.trigger("LOAD_CONFIG",n.appConfig)})()}loadYaml(){return(0,en.Z)(function*(){let e=document.querySelector('script[type$="yaml"]');if(!e)return console.warn("loadYaml element not found."),"";let i=e.getAttribute("src");return null==i?(console.warn("loadYaml url undefined."),e.textContent):(yield fetch(i)).text()})()}static applyConfig(e,i=n.appConfig){if(null==e)return i;let r=Object.getOwnPropertyNames(e);for(let s of r)(Array.isArray(e)||Array.isArray(i)?LI.concat(qG):LI).includes(s)?console.log(`skip invalid key (${s})`):null!=e[s]&&"object"==typeof e[s]?(null==i[s]&&(i[s]=Array.isArray(e[s])?[]:{}),n.applyConfig(e[s],i[s])):"function"!=typeof e[s]&&"function"!=typeof i[s]&&(i[s]=e[s]);return i}}return n.appConfig={webrtc:{key:""},app:{title:"",mode:""},dice:{url:"",api:1}},n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=tn({token:n,factory:n.\u0275fac}),n})();function WG(n,t){if(1&n){const e=Xe();K(0,"div",12),Te("click",function(){return De(e),ge(2).changeIcon()}),Ct(1,"safe"),J()}2&n&&Ke("background-image",xt(1,2,"url("+ge(2).myPeer.image.url+")","style"))}const KG=function(n){return{"i-am-gm":n}};function YG(n,t){if(1&n){const e=Xe();K(0,"div")(1,"div",3),xe(2,WG,2,5,"div",4),K(3,"div")(4,"label",5)(5,"b",6)(6,"input",7),Te("click",function(r){return De(e),ge().onGMMode(r)}),J(),be(7),J()(),it(8,"br"),K(9,"button",8),Te("click",function(){return De(e),ge().changeIcon()}),be(10,"\u30d7\u30ec\u30a4\u30e4\u30fc\u30a2\u30a4\u30b3\u30f3\u5909\u66f4"),J()()(),K(11,"div"),be(12," \u3042\u306a\u305f\u306e\u8272\u3068\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\uff1a"),K(13,"input",9),Te("ngModelChange",function(r){return De(e),ge().myPeerColor=r}),J(),K(14,"input",10),Te("ngModelChange",function(r){return De(e),ge().myPeerName=r}),J(),it(15,"br"),be(16," \u203b\u6700\u5f8c\u306b\u4f7f\u3063\u305f\u8272\u3068\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\u3092\u30d6\u30e9\u30a6\u30b6\u306b\u4fdd\u5b58\u3002"),it(17,"br"),K(18,"span",11),be(19,"\u8272\u3092\u521d\u671f\u5024\u306b\u623b\u3059\u969b\u306f\u767d(255,255,255)\u3092\u9078\u629e\u3002"),J()()()}if(2&n){const e=ge();U(2),te("ngIf",e.myPeer.image),U(2),te("ngClass",ut(8,KG,e.isGMMode||e.isGMHold)),U(2),ct("checked",e.isGMMode||e.isGMHold?"checked":""),U(1),qe(e.isGMMode?"\u73fe\u5728GM\u30e2\u30fc\u30c9\u3067\u3059":e.isGMHold?"GM\u30e2\u30fc\u30c9\u4fdd\u7559\u4e2d":"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b"),U(6),te("ngModel",e.myPeerColor),U(1),Ke("color",e.myPeerColor),te("ngModel",e.myPeerName)}}function ZG(n,t){if(1&n){const e=Xe();K(0,"button",18),Te("click",function(){return De(e),ge(2).copyPeerId()}),K(1,"b",19),be(2,"content_copy"),J()()}2&n&&te("disabled",ge(2).isCopied)}function XG(n,t){if(1&n&&(Ve(0),K(1,"span",13)(2,"span",14),be(3),J(),it(4,"input",15),J(),xe(5,ZG,3,1,"button",16),K(6,"span",17),be(7),J(),Ge()),2&n){const e=ge();U(3),qe(e.networkService.peerContext.userId),U(1),ct("value",e.networkService.peerContext.userId),U(1),te("ngIf",e.isAbleClipboardCopy),U(1),Ke("color",e.myPeerColor),te("@fadeInOut",e.isCopied),U(1),An(" ",e.isCopied?"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002":"","")}}function QG(n,t){1&n&&(K(0,"span",20),be(1,"???"),J())}function JG(n,t){if(1&n){const e=Xe();K(0,"button",18),Te("click",function(){return De(e),ge(3).copyRoomName()}),K(1,"b",19),be(2,"content_copy"),J()()}2&n&&te("disabled",ge(3).isRoomNameCopied)}function eq(n,t){if(1&n&&(Ve(0),K(1,"span",13)(2,"span",21),be(3),J(),it(4,"input",22),J(),xe(5,JG,3,1,"button",16),K(6,"span",17),be(7),J(),Ge()),2&n){const e=ge(2);U(3),Ta("",e.networkService.peerContext.roomName,"/",e.networkService.peerContext.roomId,""),U(1),ct("value",e.networkService.peerContext.roomName+"/"+e.networkService.peerContext.roomId),U(1),te("ngIf",e.isAbleClipboardCopy),U(1),Ke("color",e.myPeerColor),te("@fadeInOut",e.isRoomNameCopied),U(1),An(" ",e.isRoomNameCopied?"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002":"","")}}function tq(n,t){if(1&n&&(K(0,"span",13)(1,"span",21),be(2),J(),it(3,"input",22),J()),2&n){const e=ge(3);U(2),qe(e.networkService.peerContext.password),U(1),ct("value",e.networkService.peerContext.password)}}function nq(n,t){if(1&n&&(K(0,"div",29),be(1),J()),2&n){const e=ge(3);U(1),qe(e.maskedPassword)}}function iq(n,t){if(1&n){const e=Xe();K(0,"button",18),Te("click",function(){return De(e),ge(3).copyPassword()}),K(1,"b",19),be(2,"content_copy"),J()()}2&n&&te("disabled",ge(3).isPasswordCopied)}const rq=function(n){return{"red-eye":n}};function sq(n,t){if(1&n){const e=Xe();Ve(0),K(1,"div"),be(2," \u30d1\u30b9\u30ef\u30fc\u30c9 "),K(3,"label",23)(4,"input",24),Te("click",function(r){return De(e),ge(2).onPasswordOpen(r)}),J(),K(5,"b",25),be(6),J(),be(7,"\uff1a "),J(),K(8,"div",26),xe(9,tq,4,2,"span",27),xe(10,nq,2,1,"div",28),xe(11,iq,3,1,"button",16),K(12,"span",17),be(13),J()()(),Ge()}if(2&n){const e=ge(2);U(4),ct("checked",e.isPasswordOpen?"checked":""),U(1),te("ngClass",ut(10,rq,e.isPasswordOpen)),U(1),qe(e.isPasswordOpen?"visibility":"visibility_off"),U(3),te("ngIf",e.isPasswordOpen),U(1),te("ngIf",!e.isPasswordOpen),U(1),te("ngIf",e.isAbleClipboardCopy&&e.isPasswordOpen),U(1),Ke("color",e.myPeerColor),te("@fadeInOut",e.isPasswordCopied),U(1),An(" ",e.isPasswordCopied?"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002":"","")}}function oq(n,t){if(1&n&&(Ve(0),it(1,"hr"),K(2,"div"),be(3,"\u30eb\u30fc\u30e0\u540d\uff1a "),K(4,"span"),xe(5,eq,8,8,"ng-container",0),J()(),xe(6,sq,14,12,"ng-container",0),Ge()),2&n){const e=ge();U(5),te("ngIf",e.networkService.isOpen),U(1),te("ngIf",e.networkService.peerContext.password)}}function aq(n,t){1&n&&(K(0,"div",20),be(1,"\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u63a5\u7d9a\u72b6\u614b"),K(2,"span",35),be(3,"\uff08\u826f\u597d "),J(),K(4,"i",36),be(5,"sentiment_very_satisfied"),J(),K(6,"span",35),be(7," \uff1e "),J(),K(8,"i",37),be(9,"sentiment_dissatisfied"),J(),K(10,"span",35),be(11," \uff1e "),J(),K(12,"i",38),be(13,"mood_bad"),J(),K(14,"span",35),be(15," \uff1e "),J(),K(16,"i",39),be(17,"sentiment_very_dissatisfied"),J(),K(18,"span",35),be(19," \u4e0d\u826f\uff09"),J(),be(20,"\uff1a"),J())}function lq(n,t){1&n&&(K(0,"div"),be(1,"[\u63a5\u7d9a\u4e2d]"),J())}function cq(n,t){if(1&n&&(K(0,"div",40),Ct(1,"safe"),J()),2&n){const e=ge().$implicit;Ke("background-image",xt(1,2,"url("+ge().findPeerImageUrl(e.peerId)+")","style"))}}const uq=function(n){return{"is-gm-mode":n}};function dq(n,t){if(1&n&&(K(0,"div"),xe(1,aq,21,0,"div",30),K(2,"div"),xe(3,lq,2,0,"div",0),K(4,"div",31)(5,"i",32),be(6),J(),K(7,"span",33),be(8),J(),be(9,"["),xe(10,cq,2,5,"div",34),K(11,"span")(12,"b"),be(13),J()(),be(14,"]"),J()()()),2&n){const e=t.$implicit,i=t.index,r=ge();U(1),te("ngIf",0==i),U(2),te("ngIf",!e.isOpen),U(1),te("ngClass",ut(12,uq,r.findPeerIsGMMode(e.peerId))),U(1),sd("material-icons health "+r.healthClass(e.session.health)),U(1),qe(r.healthIcon(e.session.health)),U(2),qe(r.findUserId(e.peerId)),U(2),te("ngIf",r.findPeerImageUrl(e.peerId)),U(2),Ke("color",r.findPeerColor(e.peerId)),U(1),qe(r.findPeerName(e.peerId))}}function fq(n,t){if(1&n){const e=Xe();Ve(0),K(1,"input",41),Te("ngModelChange",function(r){return De(e),ge(2).targetUserId=r}),J(),K(2,"button",18),Te("click",function(){return De(e),ge(2).connectPeer()}),be(3,"\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a"),J(),it(4,"br"),Ge()}if(2&n){const e=ge(2);U(1),te("ngModel",e.targetUserId)("disabled",e.isDisableConnect),U(1),te("disabled",!e.networkService.isOpen||null==e.targetUserId||""==e.targetUserId||e.isDisableConnect)}}function hq(n,t){if(1&n){const e=Xe();K(0,"button",18),Te("click",function(){return De(e),ge(2).showLobby()}),be(1,"\u30ed\u30d3\u30fc\uff08\u30eb\u30fc\u30e0\u4e00\u89a7\uff09\u3092\u8868\u793a"),J()}if(2&n){const e=ge(2);te("disabled",!e.networkService.isOpen||e.isDisableConnect)}}function pq(n,t){if(1&n&&(K(0,"div"),xe(1,fq,5,3,"ng-container",0),xe(2,hq,2,1,"button",16),J()),2&n){const e=ge();U(1),te("ngIf",!e.networkService.peerContext.isRoom),U(1),te("ngIf",e.networkService.peerIds.length<=1)}}function gq(n,t){1&n&&(K(0,"div",43),be(1,"\u203b\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306f\u3001\u304a\u4e92\u3044\u306eID\u3092\u30e6\u30c9\u30ca\u30ea\u30a6\u30e0\u5916\u3067\u5171\u6709\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),J())}function mq(n,t){1&n&&(K(0,"div",43),be(1,"\u203b\u4e00\u4eba\u3067\u52d5\u4f5c\u78ba\u8a8d\u3092\u884c\u3044\u305f\u3044\u5834\u5408\u306f\u30d6\u30e9\u30a6\u30b6\u30922\u3064\u958b\u304f\u3068\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u3002"),J())}function _q(n,t){if(1&n&&(Ve(0),xe(1,gq,2,0,"div",42),xe(2,mq,2,0,"div",42),Ge()),2&n){const e=ge(2);U(1),te("ngIf",e.networkService.peerContexts.length<1),U(1),te("ngIf",e.networkService.peerContexts.length<1)}}function $q(n,t){1&n&&(Ve(0),K(1,"div",43),be(2,"\u203b\u30eb\u30fc\u30e0\u6a5f\u80fd\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u6642\u306f\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002"),J(),Ge())}function vq(n,t){if(1&n&&(Ve(0),xe(1,_q,3,2,"ng-container",0),xe(2,$q,3,0,"ng-container",0),Ge()),2&n){const e=ge();U(1),te("ngIf",!e.networkService.peerContext.isRoom),U(1),te("ngIf",e.networkService.peerContext.isRoom)}}function bq(n,t){1&n&&(Ve(0),K(1,"div",43),be(2,"\u203bGM\u30e2\u30fc\u30c9\u4e2d\uff08\u4fdd\u7559\u4e2d\u542b\u3080\uff09\u306f\u81ea\u5206\u304b\u3089\u63a5\u7d9a\u3092\u884c\u3048\u307e\u305b\u3093\u3002"),J(),Ge())}let m1=(()=>{class n{constructor(e,i,r,s){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.appConfigService=s,this.targetUserId="",this.networkService=yt,this.gameRoomService=lt.instance,this.isCopied=!1,this.isRoomNameCopied=!1,this.isPasswordCopied=!1,this.isPasswordOpen=!1,this.help=""}get myPeer(){return Ue.myCursor}get myPeerName(){return Ue.myCursor?Ue.myCursor.name:null}set myPeerName(e){window.localStorage&&localStorage.setItem(Ue.CHAT_MY_NAME_LOCAL_STORAGE_KEY,e),Ue.myCursor&&(Ue.myCursor.name=e)}get myPeerColor(){return Ue.myCursor?Ue.myCursor.color:Ue.CHAT_DEFAULT_COLOR}set myPeerColor(e){Ue.myCursor&&(Ue.myCursor.color=e==Ue.CHAT_TRANSPARENT_COLOR?Ue.CHAT_DEFAULT_COLOR:e),window.localStorage&&localStorage.setItem(Ue.CHAT_MY_COLOR_LOCAL_STORAGE_KEY,Ue.myCursor.color)}get isGMMode(){return!!Ue.myCursor&&Ue.myCursor.isGMMode}set isGMMode(e){Ue.myCursor&&(Ue.myCursor.isGMMode=e)}get isGMHold(){return Ue.isGMHold}get isDisableConnect(){return this.isGMHold||this.isGMMode}get maskedPassword(){return"\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf"}ngOnInit(){Promise.resolve().then(()=>{this.panelService.title="\u63a5\u7d9a\u60c5\u5831",this.panelService.isAbleFullScreenButton=!1})}ngOnDestroy(){clearTimeout(this._timeOutId),clearTimeout(this._timeOutId2),clearTimeout(this._timeOutId3),Fe.unregister(this)}changeIcon(){let e=[];this.myPeer&&this.myPeer.imageIdentifier&&(e=[this.myPeer.imageIdentifier]),this.modalService.open(Lo,{currentImageIdentifires:e}).then(i=>{!this.myPeer||!i||(this.myPeer.imageIdentifier=i)})}connectPeer(){let e=this.targetUserId;if(this.targetUserId="",e.length<1)return;let i=pi.create(e);i.isRoom||(lt.instance.clearDeleteHistory(),yt.connect(i.peerId),(Ue.isGMHold||this.isGMMode)&&(Ue.isGMHold=!1,this.isGMMode=!1,this.isGMMode&&(this.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664"),Fe.trigger("CHANGE_GM_MODE",null))))}showLobby(){(Ue.isGMHold||this.isGMMode)&&(Ue.isGMHold=!1,this.isGMMode=!1,this.isGMMode&&(this.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664"),Fe.trigger("CHANGE_GM_MODE",null))),this.modalService.open(IU,{width:700,height:400,left:0,top:400})}findUserId(e){const i=Ue.findByPeerId(e);return i?i.userId:""}findPeerName(e){const i=Ue.findByPeerId(e);return i?i.name:""}findPeerColor(e){const i=Ue.findByPeerId(e);return i?i.color:""}findPeerImageUrl(e){const i=Ue.findByPeerId(e);return i?i.image.url:""}findPeerIsGMMode(e){const i=Ue.findByPeerId(e);return!!i&&i.isGMMode}copyPeerId(){navigator.clipboard&&(navigator.clipboard.writeText(this.networkService.peerContext.userId),this.isCopied=!0,clearTimeout(this._timeOutId),this._timeOutId=setTimeout(()=>{this.isCopied=!1},1e3))}copyRoomName(){navigator.clipboard&&(navigator.clipboard.writeText(this.networkService.peerContext.roomName+"/"+this.networkService.peerContext.roomId),this.isRoomNameCopied=!0,clearTimeout(this._timeOutId2),this._timeOutId2=setTimeout(()=>{this.isRoomNameCopied=!1},1e3))}copyPassword(){navigator.clipboard&&(navigator.clipboard.writeText(this.networkService.peerContext.password),this.isPasswordCopied=!0,clearTimeout(this._timeOutId3),this._timeOutId2=setTimeout(()=>{this.isPasswordCopied=!1},1e3),this.isPasswordOpen=!1)}isAbleClipboardCopy(){return!!navigator.clipboard}onPasswordOpen(e){this.isPasswordOpen?this.isPasswordOpen=!1:(e.preventDefault(),this.modalService.open(Qi,{title:"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u8868\u793a",text:"\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",type:Ci.OK_CANCEL,materialIcon:"visibility",action:()=>{this.isPasswordOpen=!0,e.target.checked=!0}}))}onGMMode(e){Ue.isGMHold||this.isGMMode?this.isGMMode?(e.preventDefault(),this.modalService.open(Qi,{title:"GM\u30e2\u30fc\u30c9\u89e3\u9664",text:"GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664\u3057\u307e\u3059\u304b\uff1f",type:Ci.OK_CANCEL,materialIcon:"person_remove",action:()=>{Ue.isGMHold=!1,this.isGMMode=!1,e.target.checked=!1,this.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664"),Fe.trigger("CHANGE_GM_MODE",null),Vt.isStealthMode&&this.modalService.open(Qi,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:Ci.OK,materialIcon:"disabled_visible"})}})):(Ue.isGMHold=!1,this.isGMMode=!1):(e.preventDefault(),this.modalService.open(Qi,{title:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b",text:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u304b\uff1f\nGM\u30e2\u30fc\u30c9\u4e2d\uff08\u4fdd\u7559\u4e2d\u542b\u3080\uff09\u306f\u3042\u306a\u305f\u304b\u3089\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3001\u30eb\u30fc\u30e0\u3078\u306e\u63a5\u7d9a\u306f\u884c\u3048\u307e\u305b\u3093\u3002",helpHtml:"GM\u30e2\u30fc\u30c9\u3067\u306f\u3001<b>\u79d8\u8a71</b>\u3001\u88cf\u5411\u304d\u306e<b>\u30ab\u30fc\u30c9</b>\u3001\u516c\u958b\u3055\u308c\u3066\u3044\u306a\u3044<b>\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb</b>\u3001<b>\u30ad\u30e3\u30e9\u30af\u30bf\u30fc</b>\u4f4d\u7f6e\u3001<b>\u30ab\u30fc\u30bd\u30eb</b>\u4f4d\u7f6e\u3092\u3059\u3079\u3066\u898b\u308b\u3053\u3068\u304c\u3067\u304d\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u3089\u306a\u304f\u306a\u308a\u307e\u3059\u3002\n\n<b><big>\u2014With great power comes great responsibility.</big></b>",type:Ci.OK_CANCEL,materialIcon:"person_add",action:()=>{Ue.isGMHold=!0,this.isGMMode=!1,e.target.checked=!0,this.modalService.open(Qi,{title:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b",text:"\u307e\u3060GM\u30e2\u30fc\u30c9\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002",helpHtml:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b\u306b\u306f\u3001\u30c1\u30e3\u30c3\u30c8\u304b\u3089 <b>GM\u306b\u306a\u308b</b> \u307e\u305f\u306f <b>GM\u306b\u306a\u308a\u307e\u3059</b> \u3092\u542b\u3080\u6587\u3092\u9001\u4fe1\u3057\u307e\u3059\u3002",type:Ci.OK,materialIcon:"person_add"})}}))}healthIcon(e){return e>=.99?"sentiment_very_satisfied":e>.97?"sentiment_dissatisfied":e>.95?"mood_bad":"sentiment_very_dissatisfied"}healthClass(e){return e>=.99?"health-blue":e>.97?"health-green":e>.95?"health-yellow":"health-red"}}return n.\u0275fac=function(e){return new(e||n)(Le(kn),Le(In),Le(Er),Le(g1))},n.\u0275cmp=Zt({type:n,selectors:[["peer-menu"]],decls:13,vars:8,consts:[[4,"ngIf"],["style","font-weight: bold;",4,"ngIf"],[4,"ngFor","ngForOf"],[2,"display","flex","align-items","flex-end","margin-bottom","4px"],["class","image cover","style","cursor: pointer",3,"background-image","click",4,"ngIf"],[2,"display","inline-block","margin-bottom","2px",3,"ngClass"],[2,"font-size","smaller"],["type","checkbox","name","i-am-gamemaster","value","I'm Gamemaster",3,"checked","click"],[3,"click"],["type","color",2,"width","1em","margin-right","0.5em",3,"ngModel","ngModelChange"],["placeholder","\u30cb\u30c3\u30af\u30cd\u30fc\u30e0",2,"font-weight","bolder",3,"ngModel","ngModelChange"],[2,"font-size","smaller","margin-left","1em"],[1,"image","cover",2,"cursor","pointer",3,"click"],[1,"id-input-container"],[1,"id-spacer"],["type","text","readonly","",1,"id-input",3,"value"],[3,"disabled","click",4,"ngIf"],[1,"copied"],[3,"disabled","click"],[1,"material-icons",2,"font-size","1em","vertical-align","bottom"],[2,"font-weight","bold"],[1,"id-spacer","room-data"],["type","text","readonly","",1,"id-input","room-data",3,"value"],["sytle","white-space: nowrap"],["name","show-hide-password","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[2,"display","inline"],["class","id-input-container",4,"ngIf"],["style","display: inline","class","masked-password","draggable","false",4,"ngIf"],["draggable","false",1,"masked-password",2,"display","inline"],["style","font-weight: bold",4,"ngIf"],[3,"ngClass"],[2,"margin-right","2px"],[2,"margin-right","3px"],["class","cover mini-icon",3,"background-image",4,"ngIf"],[1,"health"],[1,"material-icons","health","health-blue"],[1,"material-icons","health","health-green"],[1,"material-icons","health","health-yellow"],[1,"material-icons","health","health-red"],[1,"cover","mini-icon"],["placeholder","\u63a5\u7d9a\u3057\u305f\u3044\u76f8\u624b\u306eID","name","targetUserId",3,"ngModel","disabled","ngModelChange"],["style","font-size: 12px",4,"ngIf"],[2,"font-size","12px"]],template:function(e,i){1&e&&(xe(0,YG,20,10,"div",0),K(1,"div")(2,"div"),be(3,"\u3042\u306a\u305f\u306eID\uff1a "),K(4,"span"),xe(5,XG,8,7,"ng-container",0),J(),xe(6,QG,2,0,"span",1),J()(),xe(7,oq,7,2,"ng-container",0),it(8,"hr"),xe(9,dq,15,14,"div",2),xe(10,pq,3,2,"div",0),xe(11,vq,3,2,"ng-container",0),xe(12,bq,3,0,"ng-container",0)),2&e&&(te("ngIf",i.myPeer),U(5),te("ngIf",i.networkService.isOpen),U(1),te("ngIf",!i.networkService.isOpen),U(1),te("ngIf",i.networkService.peerContext.isRoom),U(2),te("ngForOf",i.networkService.peerContexts),U(1),te("ngIf",!i.isGMMode&&!i.isGMHold),U(1),te("ngIf",!i.isGMMode&&!i.isGMHold),U(1),te("ngIf",i.isGMMode||i.isGMHold))},directives:[_n,Wn,fi,hi,oi,ei],pipes:[ti],styles:['[_nghost-%COMP%]{display:block}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:table-cell;vertical-align:top;border-radius:.6rem}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto;height:auto;max-width:100%;max-height:100%;vertical-align:bottom}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}.id-input-container[_ngcontent-%COMP%]{display:inline-block;position:relative}.id-spacer[_ngcontent-%COMP%]{visibility:hidden;display:inline-block;pointer-events:none;padding:0 3px;box-sizing:border-box;border-color:transparent;border-radius:3px;border-width:2px;border-style:solid;font-family:Cambria,Georgia;font-size:larger;font-weight:bolder}.id-input[_ngcontent-%COMP%]{top:0;left:-4px;width:100%;position:absolute;background:none;border:none;outline:none;color:#444;font-family:Cambria,Georgia;font-size:larger;padding:2px;box-sizing:border-box;border-color:transparent;border-radius:3px;border-width:2px;border-style:solid;font-weight:bolder}.room-data[_ngcontent-%COMP%]{font-size:medium}.masked-password[_ngcontent-%COMP%]{font-weight:bolder;color:#444;font-family:Cambria,Georgia;-webkit-user-select:none;-moz-user-select:none;user-select:none;display:inline-block}.id-input[_ngcontent-%COMP%]:active, .id-input[_ngcontent-%COMP%]:hover{border-color:#444}.copied[_ngcontent-%COMP%]{font-size:smaller;opacity:0;white-space:nowrap}.health[_ngcontent-%COMP%]{font-size:14px;font-weight:400}.health-blue[_ngcontent-%COMP%]{color:#00f;filter:drop-shadow(0px 0px 2px skyblue)}.health-green[_ngcontent-%COMP%]{color:green;filter:drop-shadow(0px 0px 1px greenyellow)}.health-yellow[_ngcontent-%COMP%]{color:#757532;filter:drop-shadow(0px 0px 1px yellow)}.health-red[_ngcontent-%COMP%]{color:#8b0000;filter:drop-shadow(0px 0px 2px red)}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}.mini-icon[_ngcontent-%COMP%]{display:inline-block;padding:0;width:16px;height:16px;vertical-align:middle;border-radius:.2rem;margin-right:2px}.is-gm-mode[_ngcontent-%COMP%]:after{content:"\\3010GM\\3011";color:red}.i-am-gm[_ngcontent-%COMP%]{color:red;text-shadow:1px 1px 0px #eee,-1px 1px 0px #eee,1px -1px 0px #eee,-1px -1px 0px #eee,1px 0px 0px #eee,0px 1px 0px #eee,-1px 0px 0px #eee,0px -1px 0px #eee,0px 0px 2px crimson}'],data:{animation:[xn("fadeInOut",[Bt("false => true",[Ft("50ms ease-in-out",Ye({opacity:1})),Ft("900ms ease-in-out",Ye({opacity:0}))])])]}}),n})(),ug=(()=>{class n{constructor(e){this.ngZone=e,this.batchTask=new Map,this.batchTaskTimer=null,this.needsChangeDetection=!1}add(e,i={}){this.batchTask.set(i,e),this.startTimer()}remove(e={}){this.batchTask.delete(e)}requireChangeDetection(){this.needsChangeDetection=!0,this.startTimer()}startTimer(){null==this.batchTaskTimer&&this.ngZone.runOutsideAngular(()=>{xr(()=>this.execBatch()),this.batchTaskTimer=setInterval(()=>{0<this.batchTask.size?this.execBatch():(clearInterval(this.batchTaskTimer),this.batchTaskTimer=null)},66)})}execBatch(){this.batchTask.forEach(e=>e()),this.batchTask.clear(),this.needsChangeDetection&&(this.needsChangeDetection=!1,this.ngZone.run(()=>{}))}}return n.\u0275fac=function(e){return new(e||n)(rn(vn))},n.\u0275prov=tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const yq=["textArea"];function Cq(n,t){1&n&&(it(0,"img",27),Ct(1,"safe")),2&n&&te("src",xt(1,1,ge(2).imageFile.url,"resourceUrl"),Jt)}function xq(n,t){if(1&n&&(K(0,"div",25),xe(1,Cq,2,4,"img",26),J()),2&n){const e=ge();U(1),te("ngIf",0<e.imageFile.url.length)}}function wq(n,t){if(1&n&&(K(0,"div",25),it(1,"img",27),Ct(2,"safe"),J()),2&n){const e=ge(2);U(1),te("src",xt(2,1,null==e.character.faceIcon?null:e.character.faceIcon.url,"resourceUrl"),Jt)}}const Eq=function(n,t){return{inverse:n,hollow:t}},Tq=function(n,t,e,i,r,s,o,c){return{black:n,blue:t,green:e,cyan:i,red:r,magenta:s,yellow:o,white:c}},Iq=function(n){return{"black-paint":n}};function Sq(n,t){if(1&n&&(K(0,"div",30)(1,"span",31),it(2,"img",32),Ct(3,"safe"),J()()),2&n){const e=ge(3);te("ngClass",Kt(7,Eq,e.character.isInverse,e.character.isHollow)),U(1),te("ngClass",ao(10,Tq,0==e.character.aura,1==e.character.aura,2==e.character.aura,3==e.character.aura,4==e.character.aura,5==e.character.aura,6==e.character.aura,7==e.character.aura)),U(1),te("src",xt(3,4,e.character.imageFile.url,"resourceUrl"),Jt)("ngClass",ut(19,Iq,e.character.isBlackPaint))}}function Mq(n,t){if(1&n&&xe(0,Sq,4,21,"div",29),2&n){const e=ge(2);te("ngIf",e.character&&null!=e.character.imageFile&&0<e.character.imageFile.url.length)}}function kq(n,t){if(1&n&&(xe(0,wq,3,4,"div",2),xe(1,Mq,1,1,"ng-template",null,28,Ln)),2&n){const e=Wt(2),i=ge();te("ngIf",i.isUseFaceIcon&&i.character&&null!=i.character.faceIcon&&0<(null==i.character.faceIcon||null==i.character.faceIcon.url?null:i.character.faceIcon.url.length))("ngIfElse",e)}}function Dq(n,t){if(1&n){const e=Xe();K(0,"input",33),Te("ngModelChange",function(r){return De(e),ge().isUseFaceIcon=r})("change",function(){De(e);const r=ge();return r.isUseFaceIcon=!!r.isUseFaceIcon}),J()}if(2&n){const e=ge();ct("checked",e.isUseFaceIcon?"checked":""),te("ngModel",e.isUseFaceIcon)}}function Aq(n,t){1&n&&(K(0,"b",34),be(1,"\u9854IC"),J())}function Pq(n,t){if(1&n&&(K(0,"option",35),be(1),J()),2&n){const e=ge();Ke("color",e.myColor),ct("value",null==e.myPeer?null:e.myPeer.identifier),U(1),An("",null==e.myPeer?null:e.myPeer.name,"\uff08\u3042\u306a\u305f\uff09")}}function Nq(n,t){if(1&n&&(K(0,"option",36),be(1),J()),2&n){const e=t.$implicit;Ke("color",e.chatPalette&&e.chatPalette.color&&"#ffffff"!=e.chatPalette.color?e.chatPalette.color:"#444"),ct("value",e.identifier),U(1),qe(e.name)}}function Fq(n,t){1&n&&(Ve(0),be(1,"\uff08\u3042\u306a\u305f\uff09"),Ge())}function Oq(n,t){if(1&n&&(K(0,"option",35),be(1),xe(2,Fq,2,0,"ng-container",24),J()),2&n){const e=t.$implicit,i=ge();Ke("color",e.color),ct("value",e.identifier),U(1),An("",e.name," "),U(1),te("ngIf",e===i.myPeer)}}function Rq(n,t){if(1&n&&(K(0,"option",42),be(1),J()),2&n){const e=t.$implicit;ct("value",e.script),U(1),qe(e.game)}}function Bq(n,t){if(1&n&&(K(0,"optgroup",40),xe(1,Rq,2,2,"option",41),J()),2&n){const e=t.$implicit;ct("label",e.index),U(1),te("ngForOf",e.infos)}}const uf=function(){return{standalone:!0}},dg=function(n){return{"not-specified":n}};function Lq(n,t){if(1&n){const e=Xe();K(0,"select",37),Te("change",function(r){return De(e),ge().loadDiceBot(r.target.value)})("ngModelChange",function(r){return De(e),ge().gameType=r}),K(1,"option",38),be(2,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u6307\u5b9a\u306a\u3057"),J(),xe(3,Bq,2,2,"optgroup",39),J()}if(2&n){const e=ge();te("ngModel",e.gameType)("ngModelOptions",ea(4,uf))("ngClass",ut(5,dg,"DiceBot"==e.gameType||""==e.gameType)),U(3),te("ngForOf",e.diceBotInfosIndexed)}}function zq(n,t){if(1&n){const e=Xe();K(0,"select",43),Te("change",function(r){return De(e),ge().loadDiceBot(r.target.value)})("ngModelChange",function(r){return De(e),ge().gameType=r}),K(1,"option",38),be(2,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8aad\u8fbc\u4e2d\u2026"),J()()}if(2&n){const e=ge();te("ngModel",e.gameType)("ngModelOptions",ea(3,uf))("ngClass",ut(4,dg,"DiceBot"==e.gameType||""==e.gameType))}}function jq(n,t){if(1&n&&(K(0,"option",42),be(1),J()),2&n){const e=t.$implicit;ct("value",e),U(1),qe(e)}}const Hq=function(n){return{"disabled-stand":n}};function Uq(n,t){if(1&n){const e=Xe();K(0,"div",44)(1,"label",45)(2,"input",33),Te("ngModelChange",function(r){return De(e),ge().isUseStandImage=r})("change",function(){De(e);const r=ge();return r.isUseStandImage=!!r.isUseStandImage}),J(),K(3,"b",34),be(4,"Stand: "),J()(),K(5,"select",46),Te("change",function(){return De(e),ge().isUseStandImage=!0})("ngModelChange",function(r){return De(e),ge().standName=r}),K(6,"option",13),be(7,"\u672a\u9078\u629e"),J(),xe(8,jq,2,2,"option",41),J(),K(9,"span",47)(10,"b",34),be(11,"Pos: "),J(),K(12,"input",48),Te("change",function(){return De(e),ge().isUseStandImage=!0})("ngModelChange",function(r){return De(e),ge().character.standList.position=r}),J(),K(13,"input",49),Te("change",function(){return De(e),ge().isUseStandImage=!0})("ngModelChange",function(r){return De(e),ge().character.standList.position=r}),J(),K(14,"b",34),be(15,"\uff05"),J()(),K(16,"button",50),Te("click",function(){return De(e),ge().farewellStand()}),be(17,"\u9000\u53bb"),J()()}if(2&n){const e=ge();te("ngClass",ut(14,Hq,!e.isUseStandImageOnChatTab)),U(2),ct("checked",e.isUseStandImage?"checked":""),te("ngModel",e.isUseStandImage),Rt("disabled",e.isUseStandImageOnChatTab?null:""),U(3),te("ngModel",e.standName)("ngModelOptions",ea(16,uf))("ngClass",ut(17,dg,""==e.standName)),Rt("disabled",e.isUseStandImageOnChatTab?null:""),U(3),te("ngForOf",e.standNameList),U(4),te("ngModel",e.character.standList.position),Rt("disabled",e.isUseStandImageOnChatTab?null:""),U(1),te("ngModel",e.character.standList.position),Rt("disabled",e.isUseStandImageOnChatTab?null:""),U(3),Rt("disabled",e.isUseStandImageOnChatTab?null:"")}}function Vq(n,t){if(1&n){const e=Xe();K(0,"input",51),Te("ngModelChange",function(r){return De(e),ge().paletteColor=r}),J()}2&n&&te("ngModel",ge().paletteColor)("ngModelOptions",ea(2,uf))}function Gq(n,t){1&n&&(K(0,"div",58),Ct(1,"safe"),J()),2&n&&Ke("background-image",xt(1,2,"url("+ge().$implicit.imageUrl+")","style"))}function qq(n,t){1&n&&(K(0,"span",59),be(1,", "),J())}function Wq(n,t){if(1&n&&(K(0,"div",53),xe(1,Gq,2,5,"div",54),K(2,"div",55),Ct(3,"safe"),K(4,"span",56),be(5),J(),xe(6,qq,2,0,"span",57),J()()),2&n){const e=t.$implicit,i=t.index,r=ge(2);U(1),te("ngIf",e.imageUrl),U(1),Ke("color",xt(3,5,e.color,"style")),U(3),qe(e.name),U(1),te("ngIf",r.writingPeerNameAndColors.length!==i+1)}}function Kq(n,t){if(1&n&&(Ve(0),xe(1,Wq,7,8,"div",52),be(2," \u304c\u5165\u529b\u4e2d... "),Ge()),2&n){const e=ge();U(1),te("ngForOf",e.writingPeerNameAndColors)}}const Yq=function(n){return{"direct-message":n}},zI=function(n,t){return{color:n,"font-weight":t}};class er{constructor(t,e,i,r,s,o){this.ngZone=t,this.chatMessageService=e,this.batchService=i,this.panelService=r,this.pointerDeviceService=s,this.contextMenuService=o,this.onlyCharacters=!1,this.chatTabidentifier="",this._gameType="",this.gameTypeChange=new Cn,this._sendFrom=this.myPeer?this.myPeer.identifier:"",this.sendFromChange=new Cn,this._sendTo="",this.sendToChange=new Cn,this._text="",this.textChange=new Cn,this.chat=new Cn,this.gameHelp="",this.isUseFaceIcon=!0,this.isUseStandImage=!0,this.currentHistoryIndex=-1,this.standName="",this.shouldUpdateCharacterList=!0,this._gameCharacters=[],this.writingEventInterval=null,this.previousWritingLength=0,this.writingPeers=new Map,this.writingPeerNameAndColors=[]}get isUseStandImageOnChatTab(){const t=lt.instance.get(this.chatTabidentifier);return t&&t.isUseStandImage}get gameType(){return this._gameType}set gameType(t){this._gameType=t,this.gameTypeChange.emit(t)}get sendFrom(){return this._sendFrom}set sendFrom(t){this._sendFrom=t,this.sendFromChange.emit(t)}get sendTo(){return this._sendTo}set sendTo(t){this._sendTo=t,this.sendToChange.emit(t)}get text(){return this._text}set text(t){this._text=t,this.textChange.emit(t)}get isDirect(){return!(null==this.sendTo||!this.sendTo.length)}get character(){let t=lt.instance.get(this.sendFrom);return t instanceof Vt?t:null}get hasStand(){return!(!this.character||!this.character.standList)&&this.character.standList.standElements.length>0}get standNameList(){if(!this.hasStand)return[];let t=[];for(let e of this.character.standList.standElements){let i=e.getFirstElementByName("name");i&&i.value&&t.indexOf(i.value.toString())<0&&t.push(i.value.toString())}return t.sort()}get standListNoGroup(){return[]}get standListWithGroup(){if(!this.hasStand)return[];let t={};const e=this.character.standList.standElements.map(i=>i.getFirstElementByName("name")).filter(i=>i);e.sort((i,r)=>i.currentValue===r.currentValue?0:i.currentValue>r.currentValue?-1:1);for(const i of e)if(i&&i.value){const r=i.currentValue&&i.currentValue.toString().length>0?i.currentValue.toString():"";r&&(t[r]||(t[r]=[]),t[r].indexOf(i.value.toString())<0&&t[r].push(i.value.toString()))}return Object.keys(t).sort().map(i=>({name:i,stands:t[i].sort()})).filter(i=>i.stands.length>0)}get imageFile(){let t=lt.instance.get(this.sendFrom),e=null;return t instanceof Vt?e=t.imageFile:t instanceof Ue&&(e=t.image),e||Ht.Empty}get paletteColor(){return this.character&&this.character.chatPalette&&this.character.chatPalette.paletteColor?this.character.chatPalette.paletteColor:Ue.CHAT_TRANSPARENT_COLOR}set paletteColor(t){this.character.chatPalette.color=t||Ue.CHAT_TRANSPARENT_COLOR}get myColor(){return Ue.myCursor&&Ue.myCursor.color&&Ue.myCursor.color!=Ue.CHAT_TRANSPARENT_COLOR?Ue.myCursor.color:Ue.CHAT_DEFAULT_COLOR}get color(){return this.paletteColor&&this.paletteColor!=Ue.CHAT_TRANSPARENT_COLOR?this.paletteColor:this.myColor}get sendToColor(){let t=lt.instance.get(this.sendTo);return t instanceof Ue?t.color:Ue.CHAT_DEFAULT_COLOR}get gameCharacters(){return this.shouldUpdateCharacterList&&(this.shouldUpdateCharacterList=!1,this._gameCharacters=lt.instance.getObjects(Vt).filter(t=>this.allowsChat(t))),this._gameCharacters}get diceBotInfos(){return jn.diceBotInfos}get myPeer(){return Ue.myCursor}get otherPeers(){return lt.instance.getObjects(Ue)}get diceBotInfosIndexed(){return jn.diceBotInfosIndexed}ngOnInit(){Fe.register(this).on("MESSAGE_ADDED",t=>{if(t.data.tabIdentifier!==this.chatTabidentifier)return;let e=lt.instance.get(t.data.messageIdentifier),i=lt.instance.getObjects(Ue).find(s=>s.userId===e.from),r=i?i.peerId:"?";this.writingPeers.has(r)&&(this.writingPeers.get(r).stop(),this.writingPeers.delete(r),this.updateWritingPeerNameAndColors())}).on("UPDATE_GAME_OBJECT",t=>{if(t.data.aliasName!==Vt.aliasName||(this.shouldUpdateCharacterList=!0,t.data.identifier!==this.sendFrom))return;let e=lt.instance.get(t.data.identifier);e&&!this.allowsChat(e)&&(this.sendFrom=0<this.gameCharacters.length&&this.onlyCharacters?this.gameCharacters[0].identifier:this.myPeer.identifier)}).on("DISCONNECT_PEER",t=>{let e=lt.instance.get(this.sendTo);e instanceof Ue&&e.peerId===t.data.peerId&&(this.sendTo="")}).on("WRITING_A_MESSAGE",t=>{t.isSendFromSelf||t.data!==this.chatTabidentifier||(this.writingPeers.has(t.sendFrom)||this.writingPeers.set(t.sendFrom,new la(()=>{this.writingPeers.delete(t.sendFrom),this.updateWritingPeerNameAndColors(),this.ngZone.run(()=>{})},2e3)),this.writingPeers.get(t.sendFrom).reset(),this.updateWritingPeerNameAndColors(),this.batchService.requireChangeDetection())})}ngOnDestroy(){Fe.unregister(this),this.batchService.remove(this)}updateWritingPeerNameAndColors(){this.writingPeerNameAndColors=Array.from(this.writingPeers.keys()).map(t=>{let e=Ue.findByPeerId(t);return{name:e?e.name:"",color:e?e.color:Ue.CHAT_TRANSPARENT_COLOR,imageUrl:e?e.image.url:""}})}onInput(){if(null===this.writingEventInterval&&this.previousWritingLength<=this.text.length){let t=null;if(this.isDirect){let e=lt.instance.get(this.sendTo);if(e instanceof Ue){let i=pi.parse(e.peerId);i&&(t=i.peerId)}}Fe.call("WRITING_A_MESSAGE",this.chatTabidentifier,t),this.writingEventInterval=setTimeout(()=>{this.writingEventInterval=null},200)}this.previousWritingLength=this.text.length,this.calcFitHeight()}moveHistory(t,e){if(t&&t.preventDefault(),this.currentHistoryIndex<0&&(this.tmpText=this.text),e<0&&this.currentHistoryIndex<0)this.currentHistoryIndex=-1;else{if(e>0&&this.currentHistoryIndex>=er.history.length-1)return void(this.currentHistoryIndex=er.history.length-1);this.currentHistoryIndex=this.currentHistoryIndex+e}let i;this.currentHistoryIndex<0?(this.currentHistoryIndex=-1,i=this.tmpText&&this.tmpText.length?this.tmpText:""):i=er.history[this.currentHistoryIndex],this.text=i,this.previousWritingLength=this.text.length,this.textAreaElementRef.nativeElement.value=i,this.calcFitHeight()}sendChat(t){if(t&&t.preventDefault(),t&&13!==t.keyCode)return;this.sendFrom.length||(this.sendFrom=this.myPeer.identifier);let e=this.text,i="",r=null;if(this.character&&(et.cr(e).trim()||this.standName)&&(e=this.character.chatPalette.evaluate(this.text,this.character.rootDataElement),this.character.standList)){let c=null;c=this.isUseFaceIcon&&this.character.faceIcon?this.character.faceIcon.identifier:this.character.imageFile?this.character.imageFile.identifier:null;const m=this.character.standList.matchStandInfo(e,c,this.standName);if(this.isUseStandImage&&this.isUseStandImageOnChatTab)if(m.farewell)this.farewellStand();else if(m.standElementIdentifier){r=m.standElementIdentifier;const I={characterIdentifier:this.character.identifier,standIdentifier:m.standElementIdentifier,color:this.character.chatPalette?this.character.chatPalette.color:Ue.CHAT_DEFAULT_COLOR,secret:!!this.sendTo};if(I.secret){const Z=lt.instance.get(this.sendTo);Z&&(Z.peerId!=Ue.myCursor.peerId&&Fe.call("POPUP_STAND_IMAGE",I,Z.peerId),Fe.call("POPUP_STAND_IMAGE",I,Ue.myCursor.peerId))}else Fe.call("POPUP_STAND_IMAGE",I)}i=m.matchMostLongText}const s=po.instance.matchCutInInfo(e);if(this.isUseStandImageOnChatTab&&s){for(const c of s.identifiers){const m={identifier:c,secret:!!this.sendTo,sender:Ue.myCursor.peerId};if(m.secret){const I=lt.instance.get(this.sendTo);I&&(I.peerId!=Ue.myCursor.peerId&&Fe.call("PLAY_CUT_IN",m,I.peerId),Fe.call("PLAY_CUT_IN",m,Ue.myCursor.peerId))}else Fe.call("PLAY_CUT_IN",m)}if(s.names&&s.names.length&&!this.sendTo){const c=new Map;for(const I of s.names){let Z=c.get(I)||0;Z+=1,c.set(""==I?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":I,Z)}const m=`${[...c.keys()].map(I=>c.get(I)>1?`${I}\xd7${c.get(I)}`:I).join("\u3001")}`;this.chatMessageService.sendOperationLog(m+" \u304c\u8d77\u52d5\u3057\u305f")}}if(i.length<s.matchMostLongText.length&&(i=s.matchMostLongText),e=e.slice(0,e.length-i.length),this.character&&et.cr(e).trim()){const c=/^((srepeat|repeat|srep|rep|sx|x)?(\d+)?[ \u3000]+)?([^\n]*)?/gi.exec(e);let I,m=null!=c[4]?c[4].trim():e.trim();/^(S?CHOICE\d*)[ \u3000]+([^ \u3000]*)/gi.test(m)?m="":((I=/^(S?CHOICE\d*\[[^\[\]]+\])/gi.exec(m))||(I=/^(S?CHOICE\d*\([^\(\)]+\))/gi.exec(m)))&&(m=m.slice(I[1].length));const Z=/\u300c+([\s\S]+?)\u300d/gm;let fe,pe=[];for(;null!==(fe=Z.exec(m));)pe.push(fe[1]);if(0===pe.length){const ye=m.split(/[\s\u3000]/).slice(-1)[0];et.isEmote(ye)&&pe.push(ye)}if(pe.length>0){const ye={characterIdentifier:this.character.identifier,text:pe.join("\n\n"),faceIconIdentifier:this.isUseFaceIcon&&this.character.faceIcon?this.character.faceIcon.identifier:null,color:this.color,secret:!!this.sendTo};if(ye.secret){const we=lt.instance.get(this.sendTo);we&&(we.peerId!=Ue.myCursor.peerId&&Fe.call("POPUP_CHAT_BALLOON",ye,we.peerId),Fe.call("POPUP_CHAT_BALLOON",ye,Ue.myCursor.peerId))}else Fe.call("POPUP_CHAT_BALLOON",ye)}else et.cr(e).trim()&&this.character.text&&Fe.call("FAREWELL_CHAT_BALLOON",{characterIdentifier:this.character.identifier})}Ue.isGMHold&&!this.sendTo&&!Ue.myCursor.isGMMode&&/GM(?:\u30e2\u30fc\u30c9)?\u306b\u306a(?:\u308a\u307e\u3059|\u308b)/i.test(et.toHalfWidth(e))&&(Ue.myCursor.isGMMode=!0,this.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u306b\u306a\u3063\u305f"),Fe.trigger("CHANGE_GM_MODE",null)),et.cr(e).trim()&&(er.history=er.history.filter(c=>c!==this.text),er.history.unshift(this.text),er.history.length>=er.MAX_HISTORY_NUM&&er.history.pop(),this.currentHistoryIndex=-1,this.tmpText=null,this.chat.emit({text:e,gameType:this.gameType,sendFrom:this.sendFrom,sendTo:this.sendTo,color:this.color,isInverse:!!this.character&&this.character.isInverse,isHollow:!!this.character&&this.character.isHollow,isBlackPaint:!!this.character&&this.character.isBlackPaint,aura:this.character?this.character.aura:-1,isUseFaceIcon:this.isUseFaceIcon,characterIdentifier:this.character?this.character.identifier:null,standIdentifier:r,standName:this.standName,isUseStandImage:this.isUseStandImage&&this.isUseStandImageOnChatTab})),this.text="",this.previousWritingLength=this.text.length,this.textAreaElementRef.nativeElement.value="",this.calcFitHeight(),Fe.trigger("MESSAGE_EDITING_START",null)}calcFitHeight(){let t=this.textAreaElementRef.nativeElement;t.style.height="",t.scrollHeight>=t.offsetHeight&&(t.style.height=t.scrollHeight+"px")}loadDiceBot(t){console.log("onChangeGameType ready"),jn.getHelpMessage(t).then(e=>{console.log("onChangeGameType done\n"+e)})}showDicebotHelp(){jn.getHelpMessage(this.gameType).then(t=>{this.gameHelp=t;let e="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8";for(let o of jn.diceBotInfos)o.id===this.gameType&&(e="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3008"+o.game+"\u3009");e+="\u4f7f\u7528\u6cd5";let i=this.pointerDeviceService.pointers[0],s=this.panelService.open(du,{left:i.x,top:i.y,width:600,height:500});s.title=e,s.text=this.gameHelp})}onContextMenu(t){if(t.stopPropagation(),t.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let e=this.pointerDeviceService.pointers[0];if(!this.character)return void this.contextMenuService.open(e,[{name:"\u63a5\u7d9a\u60c5\u5831",action:()=>{this.panelService.open(m1,{width:520,height:600,top:e.y-100,left:e.x-100})}}],Ue.myCursor.name,null,Ue.myCursor.color,!0);let i=[{name:"\u300c\u300d\u3092\u5165\u529b",action:()=>{let r=this.textAreaElementRef.nativeElement,s=this.text.trim();"\u300c"!=s.slice(0,1)&&(s="\u300c"+s),"\u300d"!=s.slice(-1)&&(s+="\u300d"),this.text=s,r.value=this.text,r.selectionStart=this.text.length-1,r.selectionEnd=this.text.length-1,r.focus()}}];this.character&&(this.isUseFaceIcon&&this.character.faceIcon?(i.push(Tt),i.push({name:"\u9854\u30a2\u30a4\u30b3\u30f3\u306e\u5207\u308a\u66ff\u3048",action:null,subActions:this.character.faceIcons.map((r,s)=>({name:this.character.currntIconIndex==s?"\u25c9":"\u25cb",action:()=>{this.character.currntIconIndex!=s&&(this.character.currntIconIndex=s)},default:this.character.currntIconIndex==s,icon:r})),disabled:this.character.faceIcons.length<=1})):(this.character.imageFiles.length>1&&(i.push(Tt),i.push({name:"\u753b\u50cf\u5207\u308a\u66ff\u3048",action:null,subActions:this.character.imageFiles.map((r,s)=>({name:this.character.currntImageIndex==s?"\u25c9":"\u25cb",action:()=>{this.character.currntImageIndex=s,dt.play(Ze.surprise),Fe.trigger("UPDATE_INVENTORY",null)},default:this.character.currntImageIndex==s,icon:r}))})),i.push(Tt),i.push({name:"\u753b\u50cf\u52b9\u679c",action:null,subActions:[this.character.isInverse?{name:"\u2611 \u53cd\u8ee2",action:()=>{this.character.isInverse=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u53cd\u8ee2",action:()=>{this.character.isInverse=!0,Fe.trigger("UPDATE_INVENTORY",null)}},this.character.isHollow?{name:"\u2611 \u307c\u304b\u3057",action:()=>{this.character.isHollow=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u307c\u304b\u3057",action:()=>{this.character.isHollow=!0,Fe.trigger("UPDATE_INVENTORY",null)}},this.character.isBlackPaint?{name:"\u2611 \u9ed2\u5857\u308a",action:()=>{this.character.isBlackPaint=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ed2\u5857\u308a",action:()=>{this.character.isBlackPaint=!0,Fe.trigger("UPDATE_INVENTORY",null)}},{name:"\u30aa\u30fc\u30e9",action:null,subActions:[{name:(-1==this.character.aura?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{this.character.aura=-1,Fe.trigger("UPDATE_INVENTORY",null)}},Tt].concat(["\u30d6\u30e9\u30c3\u30af","\u30d6\u30eb\u30fc","\u30b0\u30ea\u30fc\u30f3","\u30b7\u30a2\u30f3","\u30ec\u30c3\u30c9","\u30de\u30bc\u30f3\u30bf","\u30a4\u30a8\u30ed\u30fc","\u30db\u30ef\u30a4\u30c8"].map((r,s)=>({name:`${this.character.aura==s?"\u25c9":"\u25cb"} ${r}`,action:()=>{this.character.aura=s,Fe.trigger("UPDATE_INVENTORY",null)}})))},Tt,{name:"\u30ea\u30bb\u30c3\u30c8",action:()=>{this.character.isInverse=!1,this.character.isHollow=!1,this.character.isBlackPaint=!1,this.character.aura=-1,Fe.trigger("UPDATE_INVENTORY",null)},disabled:!this.character.isInverse&&!this.character.isHollow&&!this.character.isBlackPaint&&-1==this.character.aura}]})),i.push(Tt),i.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.character)}}),this.onlyCharacters||i.push({name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a",action:()=>{this.showChatPalette(this.character)}}),i.push({name:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a",action:()=>{this.showStandSetting(this.character)}})),this.contextMenuService.open(e,i,this.character.name)}farewellStand(){if(this.character){const t={characterIdentifier:this.character.identifier};if(this.sendTo){const e=lt.instance.get(this.sendTo);e&&(e.peerId!=Ue.myCursor.peerId&&Fe.call("FAREWELL_STAND_IMAGE",t,e.peerId),Fe.call("FAREWELL_STAND_IMAGE",t,Ue.myCursor.peerId))}else Fe.call("FAREWELL_STAND_IMAGE",t)}}showDetail(t){let e=this.pointerDeviceService.pointers[0],i="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";t.name.length&&(i+=" - "+t.name),this.panelService.open(Gs,{title:i,left:e.x-400,top:e.y-300,width:800,height:600}).tabletopObject=t}showChatPalette(t){let e=this.pointerDeviceService.pointers[0];this.panelService.open(hu,{left:e.x-250,top:e.y-175,width:620,height:350}).character=t}showStandSetting(t){let e=this.pointerDeviceService.pointers[0];this.panelService.open(Qp,{left:e.x-400,top:e.y-175,width:730,height:572}).character=t}allowsChat(t){switch(t.location.name){case"table":case this.myPeer.peerId:return!0;case"graveyard":return!1;default:for(const e of yt.peerContexts)if(e.isOpen&&t.location.name===e.peerId)return!1;return!0}}}er.history=new Array,er.MAX_HISTORY_NUM=1e3,er.\u0275fac=function(t){return new(t||er)(Le(vn),Le(Er),Le(ug),Le(In),Le(ai),Le(sr))},er.\u0275cmp=Zt({type:er,selectors:[["chat-input"]],viewQuery:function(t,e){if(1&t&&on(yq,7),2&t){let i;sn(i=an())&&(e.textAreaElementRef=i.first)}},inputs:{onlyCharacters:"onlyCharacters",chatTabidentifier:"chatTabidentifier",_gameType:["gameType","_gameType"],_sendFrom:["sendFrom","_sendFrom"],_sendTo:["sendTo","_sendTo"],_text:["text","_text"]},outputs:{gameTypeChange:"gameTypeChange",sendFromChange:"sendFromChange",sendToChange:"sendToChange",textChange:"textChange",chat:"chat"},decls:35,vars:34,consts:[[1,"table",3,"ngClass"],[1,"table-cell","imagebox",2,"cursor","context-menu","padding-left","4px",3,"contextmenu"],["class","imagebox",4,"ngIf","ngIfElse"],["isCharacter",""],[1,"table-cell"],[2,"margin-right","5px"],["type","checkbox",3,"ngModel","checked","ngModelChange","change",4,"ngIf"],["style","font-size: smaller;",4,"ngIf"],[3,"ngModel","ngStyle","ngModelChange","change"],["style","font-weight: bolder;",3,"value","color",4,"ngIf"],["style","font-weight: normal;",3,"color","value",4,"ngFor","ngForOf"],[2,"white-space","nowrap"],[2,"max-width","9.5em",3,"ngModel","ngClass","ngStyle","ngModelChange"],["value","",1,"not-specified"],["style","font-weight: bolder;",3,"value","color",4,"ngFor","ngForOf"],["style","width: 12em;",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange",4,"ngIf"],["style","width: 12em;","disabled","",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange",4,"ngIf"],[3,"click"],["style","font-size: smaller",3,"ngClass",4,"ngIf"],["type","color","style","width:1em; margin-left: 3px",3,"ngModel","ngModelOptions","ngModelChange",4,"ngIf"],[1,"chat-input",3,"placeholder","ngModel","ngModelOptions","ngModelChange","input","keydown.enter","keydown.control.arrowup","keydown.control.arrowdown"],["textArea",""],["type","submit",3,"click"],[1,"writing-info"],[4,"ngIf"],[1,"imagebox"],["class","image face-icon",3,"src",4,"ngIf"],[1,"image","face-icon",3,"src"],["noFaceIcon",""],["class","inverser",3,"ngClass",4,"ngIf"],[1,"inverser",3,"ngClass"],[1,"aura","imagebox",3,"ngClass"],[1,"image",3,"src","ngClass"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"font-size","smaller"],[2,"font-weight","bolder",3,"value"],[2,"font-weight","normal",3,"value"],[2,"width","12em",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange"],["value","DiceBot",1,"not-specified"],["class","dice-bot-group",3,"label",4,"ngFor","ngForOf"],[1,"dice-bot-group",3,"label"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["disabled","",2,"width","12em",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange"],[2,"font-size","smaller",3,"ngClass"],[2,"margin-right","2px"],[2,"width","8em","margin-right","6px",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange"],[2,"white-space","nowrap","margin-left","1em","display","inline-block"],["type","range","min","0","max","100",2,"width","186px",3,"ngModel","change","ngModelChange"],["type","number","min","0","max","100",2,"width","3em","text-align","right","margin-right","3px",3,"ngModel","change","ngModelChange"],["type","button",2,"margin-left","1.3em","font-size","smaller",3,"click"],["type","color",2,"width","1em","margin-left","3px",3,"ngModel","ngModelOptions","ngModelChange"],["style","display: inline; white-space: pre",4,"ngFor","ngForOf"],[2,"display","inline","white-space","pre"],["class","cover mini-icon",3,"background-image",4,"ngIf"],[2,"font-weight","bold","display","inline"],[1,"peer-name"],["style","user-select: none",4,"ngIf"],[1,"cover","mini-icon"],[2,"user-select","none"]],template:function(t,e){if(1&t&&(K(0,"div",0)(1,"div",1),Te("contextmenu",function(r){return e.onContextMenu(r)}),xe(2,xq,2,1,"div",2),xe(3,kq,3,2,"ng-template",null,3,Ln),J(),K(5,"div",4)(6,"div")(7,"label",5),xe(8,Dq,1,2,"input",6),xe(9,Aq,2,0,"b",7),J(),K(10,"select",8),Te("ngModelChange",function(r){return e.sendFrom=r})("change",function(){return e.standName=""}),xe(11,Pq,2,4,"option",9),xe(12,Nq,2,4,"option",10),J(),K(13,"span",11),be(14," \u27a1 "),K(15,"select",12),Te("ngModelChange",function(r){return e.sendTo=r}),K(16,"option",13),be(17,"\u5168\u54e1"),J(),xe(18,Oq,3,5,"option",14),J()(),K(19,"span",11),xe(20,Lq,4,7,"select",15),xe(21,zq,3,6,"select",16),K(22,"button",17),Te("click",function(){return e.showDicebotHelp()}),be(23,"?"),J()()(),xe(24,Uq,18,19,"div",18),K(25,"div")(26,"form"),xe(27,Vq,1,3,"input",19),K(28,"textarea",20,21),Te("ngModelChange",function(r){return e.text=r})("input",function(){return e.onInput()})("keydown.enter",function(r){return e.sendChat(r)})("keydown.control.arrowup",function(r){return e.moveHistory(r,1)})("keydown.control.arrowdown",function(r){return e.moveHistory(r,-1)}),J(),K(30,"button",22),Te("click",function(){return e.sendChat(null)}),K(31,"b"),be(32,"SEND"),J()()()(),K(33,"div",23),xe(34,Kq,3,1,"ng-container",24),J()()()),2&t){const i=Wt(4);te("ngClass",ut(23,Yq,e.isDirect)),U(2),te("ngIf",!e.character)("ngIfElse",i),U(6),te("ngIf",e.character),U(1),te("ngIf",e.character),U(1),Ke("max-width",e.character?"9.5em":"13em"),te("ngModel",e.sendFrom)("ngStyle",Kt(25,zI,e.color,e.sendFrom!=(null==e.myPeer?null:e.myPeer.identifier)?"normal":"bolder")),U(1),te("ngIf",!e.onlyCharacters),U(1),te("ngForOf",e.gameCharacters),U(3),te("ngModel",e.sendTo)("ngClass",ut(28,dg,""==e.sendTo))("ngStyle",Kt(30,zI,""==e.sendTo?null:e.sendToColor,""==e.sendTo?"normal":"bolder")),U(3),te("ngForOf",e.otherPeers),U(2),te("ngIf",e.diceBotInfosIndexed.length>0),U(1),te("ngIf",e.diceBotInfosIndexed.length<1),U(3),te("ngIf",e.hasStand),U(3),te("ngIf",e.onlyCharacters),U(1),te("placeholder",e.onlyCharacters?"Ctrl+\u21c5:\u5c65\u6b74 \u23ce:\u9001\u4fe1 Shift+\u23ce:\u6539\u884c\u3000\u767d(255,255,255):\u3042\u306a\u305f\u306e\u8272":"Ctrl+\u21c5:\u5c65\u6b74 \u23ce:\u9001\u4fe1 Shift+\u23ce:\u6539\u884c\u3000\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u8272\u3092\u512a\u5148")("ngModel",e.text)("ngModelOptions",ea(33,uf)),U(6),te("ngIf",0<e.writingPeerNameAndColors.length)}},directives:[Wn,_n,Jr,hi,oi,es,Zi,zr,jr,ei,ms,fi,So,Io,gs,Il,Tl,ia],pipes:[ti],styles:['[_nghost-%COMP%]{display:block}.table[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px;display:table;width:100%}.table[_ngcontent-%COMP%]   .table-cell[_ngcontent-%COMP%]{display:table-cell}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:50px;height:50px;max-width:50px;max-height:50px;vertical-align:top;text-align:center}.image[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%}.image.face-icon[_ngcontent-%COMP%]{border-radius:.5rem}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #00f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 6px #ccc) drop-shadow(0 -4px 4px #fff)}.chat-input[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,"M+ 1p",sans-serif;line-height:1.3;font-size:13px;width:calc(100% - 100px);height:calc(1em + 4px);min-height:calc(1em + 7px);max-height:calc(6em + 7px);overflow-y:auto;padding:1px;margin:5px;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;vertical-align:bottom}.writing-info[_ngcontent-%COMP%]{font-size:8px;height:1.3em}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.not-specified[_ngcontent-%COMP%]{color:gray}.dice-bot-group[_ngcontent-%COMP%]{color:#f5f5f5;background-color:#555}option[_ngcontent-%COMP%]{color:#000;background-color:#fff}.disabled-stand[_ngcontent-%COMP%]{color:gray}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}.direct-message[_ngcontent-%COMP%]   .writing-info[_ngcontent-%COMP%]{color:#eee}.mini-icon[_ngcontent-%COMP%]{display:inline-block;padding:0;width:.9rem;height:.9rem;vertical-align:middle;border-radius:.2rem;margin-right:1px;-o-object-fit:cover;object-fit:cover}.direct-message[_ngcontent-%COMP%]   .mini-icon[_ngcontent-%COMP%]{filter:drop-shadow(1px 1px 1px #ffffff) drop-shadow(-1px -1px 1px #ffffff)}.direct-message[_ngcontent-%COMP%]   .peer-name[_ngcontent-%COMP%]{text-shadow:1px 0px 1px #ffffff,0px 1px 1px #ffffff,-1px 0px 1px #ffffff,0px -1px 1px #ffffff}']});let _1=(()=>{class n{constructor(){this.tableInventory=new fg(e=>"table"===e.location.name),this.commonInventory=new fg(e=>!this.isAnyLocation(e.location.name)),this.privateInventory=new fg(e=>e.location.name===yt.peerId),this.graveyardInventory=new fg(e=>"graveyard"===e.location.name),this.indicateAll=!1,this._sortStop=!1,this.locationMap=new Map,this.tagNameMap=new Map,this.newLineString="/",this.newLineDataElement=ht.create(this.newLineString),this.initialize()}get summarySetting(){return jo.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(e){this.summarySetting.sortTag=e}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(e){this.summarySetting.sortOrder=e}get dataTag(){return this.summarySetting.dataTag}set dataTag(e){this.summarySetting.dataTag=e}get dataTags(){return this.summarySetting.dataTags}get sortStop(){return this.sortStop}set sortStop(e){const i=this._sortStop;this._sortStop=e,i&&!this._sortStop&&this.refresh()}initialize(){Fe.register(this).on("OPEN_NETWORK",e=>{this.refresh()}).on("CONNECT_PEER",e=>{this.refresh()}).on("DISCONNECT_PEER",e=>{this.refresh()}).on("UPDATE_GAME_OBJECT",e=>{let i=lt.instance.get(e.data.identifier);if(i)if(i instanceof Vt){let r=this.locationMap.get(i.identifier);i.location.name!==r&&(this.locationMap.set(i.identifier,i.location.name),this.refresh())}else if(i instanceof ht){if(!this.containsInGameCharacter(i))return;let r=this.tagNameMap.get(i.identifier);(this.dataTags.includes(r)||this.dataTags.includes(i.name))&&i.name!==r&&(this.tagNameMap.set(i.identifier,i.name),this.refreshDataElements()),this.sortTag===i.name&&this.refreshSort(),0<i.children.length&&(this.refreshDataElements(),this.refreshSort()),this.callInventoryUpdate()}else i instanceof jo&&(this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate())}).on("DELETE_GAME_OBJECT",e=>{this.locationMap.delete(e.data.identifier),this.tagNameMap.delete(e.data.identifier),this.refresh()}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.callInventoryUpdate()})}containsInGameCharacter(e){let i=e.parent,r=Vt.aliasName;for(;i;){if(i.aliasName===r)return!0;i=i.parent}return!1}refresh(){this.refreshObjects(),this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate()}refreshObjects(){this.tableInventory.refreshObjects(),this.commonInventory.refreshObjects(),this.privateInventory.refreshObjects(),this.graveyardInventory.refreshObjects()}refreshDataElements(){this.tableInventory.refreshDataElements(),this.commonInventory.refreshDataElements(),this.privateInventory.refreshDataElements(),this.graveyardInventory.refreshDataElements()}refreshSort(){this._sortStop||(this.tableInventory.refreshSort(),this.commonInventory.refreshSort(),this.privateInventory.refreshSort(),this.graveyardInventory.refreshSort())}callInventoryUpdate(){Fe.trigger("UPDATE_INVENTORY",null)}isAnyLocation(e){if("table"===e||e===yt.peerId||"graveyard"===e)return!0;for(let i of yt.peerContexts)if(i.isOpen&&e===i.peerId)return!0;return!1}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class fg{constructor(t){this.classifier=t,this.newLineString="/",this.newLineDataElement=ht.create(this.newLineString),this._tabletopObjects=[],this._dataElementMap=new Map,this.needsRefreshObjects=!0,this.needsRefreshElements=!0,this.needsSort=!0}get summarySetting(){return jo.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(t){this.summarySetting.sortTag=t}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(t){this.summarySetting.sortOrder=t}get dataTag(){return this.summarySetting.dataTag}set dataTag(t){this.summarySetting.dataTag=t}get dataTags(){return this.summarySetting.dataTags}get tabletopObjects(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this.needsSort&&(this._tabletopObjects=this.sortTabletopObjects(this._tabletopObjects),this.needsSort=!1),this._tabletopObjects}get length(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this._tabletopObjects.length}get dataElementMap(){if(this.needsRefreshElements){this._dataElementMap.clear();let t=this.tabletopObjects;for(let e of t){if(!e.detailDataElement)continue;let i=this.dataTags.map(r=>r===this.newLineString?this.newLineDataElement:e.detailDataElement.getFirstElementByName(r));this._dataElementMap.set(e.identifier,i)}this.needsRefreshElements=!1}return this._dataElementMap}refreshObjects(){this.needsRefreshObjects=!0}refreshDataElements(){this.needsRefreshElements=!0}refreshSort(){this.needsSort=!0}searchTabletopObjects(){let t=lt.instance.getObjects(Vt),e=[];for(let i of t)this.classifier(i)&&e.push(i);return e}sortTabletopObjects(t){let e=this.sortTag.length?this.sortTag.trim():"",i="ASC"===this.sortOrder?-1:1;return e.length<1||t.sort((r,s)=>{var o,c;let m=null===(o=r.rootDataElement)||void 0===o?void 0:o.getFirstElementByName(e),I=null===(c=s.rootDataElement)||void 0===c?void 0:c.getFirstElementByName(e);if(!m&&!I)return 0;if(!I)return-1;if(!m)return 1;let Z=this.convertToSortableValue(m),fe=this.convertToSortableValue(I);return Z<fe?i:Z>fe?-1*i:0}),t}convertToSortableValue(t){let i=et.toHalfWidth(((t.isNumberResource?t.currentValue:t.value)+"").trim()),r=+i;return Number.isNaN(r)?i:r}}var Kl;let lr=Kl=class extends Ua{constructor(){super(...arguments),this.viewTableIdentifier="",this.gridShow=!1,this.gridSnap=!0}static get instance(){return Kl._instance||(Kl._instance=new Kl("TableSelecter"),Kl._instance.initialize()),Kl._instance}onStoreAdded(){super.onStoreAdded(),Fe.register(this).on("SELECT_GAME_TABLE",t=>{console.log("SELECT_GAME_TABLE "+this.identifier),this.viewTable&&(this.viewTable.selected=!1),this.viewTableIdentifier=t.data.identifier,this.viewTable&&(this.viewTable.selected=!0)})}onStoreRemoved(){super.onStoreRemoved(),Fe.unregister(this)}get viewTable(){let t=lt.instance.get(this.viewTableIdentifier);return t||(t=lt.instance.getObjects(Li)[0],t&&(this.viewTableIdentifier.length<1||lt.instance.isDeleted(this.viewTableIdentifier))&&(this.viewTableIdentifier=t.identifier,Fe.trigger("SELECT_GAME_TABLE",{identifier:t.identifier}))),t}};B([rt()],lr.prototype,"viewTableIdentifier",void 0),lr=Kl=B([Xn("TableSelecter")],lr);class tr{constructor(){this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1}static create(t,e=null,i=new tr){return t&&t.ownerDocument?i.setCSS((e||window.getComputedStyle(t)).transform):i.identity()}setData(t){if(null==t)return;let e=t.length;return 16==e?(this.m11=t[0],this.m12=t[1],this.m13=t[2],this.m14=t[3],this.m21=t[4],this.m22=t[5],this.m23=t[6],this.m24=t[7],this.m31=t[8],this.m32=t[9],this.m33=t[10],this.m34=t[11],this.m41=t[12],this.m42=t[13],this.m43=t[14],this.m44=t[15]):6==e?(this.m11=t[0],this.m12=t[1],this.m13=0,this.m14=0,this.m21=t[2],this.m22=t[3],this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=t[4],this.m42=t[5],this.m43=0,this.m44=1):9==e&&(this.m11=t[0],this.m12=t[1],this.m13=0,this.m14=t[2],this.m21=t[3],this.m22=t[4],this.m23=0,this.m24=t[5],this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=t[6],this.m42=t[7],this.m43=0,this.m44=t[8]),this}identity(){return this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1,this}scalar(t){return this.m11*=t,this.m12*=t,this.m13*=t,this.m14*=t,this.m21*=t,this.m22*=t,this.m23*=t,this.m24*=t,this.m31*=t,this.m32*=t,this.m33*=t,this.m34*=t,this.m41*=t,this.m42*=t,this.m43*=t,this.m44*=t,this}unproject(t,e={x:0,y:0,z:0,w:1}){let i=t.x*this.m11+t.y*this.m21+this.m41,r=t.x*this.m12+t.y*this.m22+this.m42,s=t.x*this.m13+t.y*this.m23+this.m43,o=t.x*this.m14+t.y*this.m24+this.m44,c=i+this.m31,m=r+this.m32,I=s+this.m33,Z=o+this.m34;0==o&&(o=1e-4),i/=o,r/=o,s/=o,0==Z&&(Z=1e-4),c/=Z,m/=Z,I/=Z;let fe=I-s;if(0==fe)return e.x=i,e.y=r,e.z=s,e.w=s,e;let pe=-s/fe;return i+=pe*(c-i),r+=pe*(m-r),e.x=i,e.y=r,e.z=s,e.w=s,e}project(t,e={x:0,y:0,z:0,w:1}){let i=t.z,r=t.x*this.m14+t.y*this.m24+i*this.m34+this.m44,s=t.x*this.m11+t.y*this.m21+i*this.m31+this.m41,o=t.x*this.m12+t.y*this.m22+i*this.m32+this.m42;return 0==r&&(r=1e-4),s/=r,o/=r,r<0&&(s-=this.m41,o-=this.m42,s*=1/r,o*=1/r,s+=this.m41,o+=this.m42),e.x=s,e.y=o,e.z=i,e.w=i,e}append(t){return tr.multiply(this,t,this)}setPosition(t){return this.m41=t.x,this.m42=t.y,this.m43=t.z,this}getPosition(t={x:0,y:0,z:0,w:1}){return t.x=this.m41,t.y=this.m42,t.z=this.m43,t}static makePosition(t,e=new tr){return e.identity(),e.setPosition(t),e}appendPosition(...t){let e;return e=1===t.length?t[0]:{x:t[0],y:t[1],z:t[2],w:1},this.append(tr.makePosition(e,tr.MATRIX3D))}static makePerspective(t,e=new tr){return e.identity(),e.m34=t?-1/t:0,e}appendPerspective(t){return t?this.append(tr.makePerspective(t,tr.MATRIX3D)):this}invert(t){t=t||this;let e=[],i=this.m11,r=this.m12,s=this.m13,o=this.m14,c=this.m21,m=this.m22,I=this.m23,Z=this.m24,fe=this.m31,pe=this.m32,ye=this.m33,we=this.m34,Me=this.m41,Oe=this.m42,Be=this.m43,ke=this.m44;e[0]=I*we*Oe-Z*ye*Oe+Z*pe*Be-m*we*Be-I*pe*ke+m*ye*ke,e[1]=o*ye*Oe-s*we*Oe-o*pe*Be+r*we*Be+s*pe*ke-r*ye*ke,e[2]=s*Z*Oe-o*I*Oe+o*m*Be-r*Z*Be-s*m*ke+r*I*ke,e[3]=o*I*pe-s*Z*pe-o*m*ye+r*Z*ye+s*m*we-r*I*we;let ze=i*e[0]+c*e[1]+fe*e[2]+Me*e[3];return 0==ze?(console.warn("Can not invert matrix, determinant is 0"),this):(e[4]=Z*ye*Me-I*we*Me-Z*fe*Be+c*we*Be+I*fe*ke-c*ye*ke,e[5]=s*we*Me-o*ye*Me+o*fe*Be-i*we*Be-s*fe*ke+i*ye*ke,e[6]=o*I*Me-s*Z*Me-o*c*Be+i*Z*Be+s*c*ke-i*I*ke,e[7]=s*Z*fe-o*I*fe+o*c*ye-i*Z*ye-s*c*we+i*I*we,e[8]=m*we*Me-Z*pe*Me+Z*fe*Oe-c*we*Oe-m*fe*ke+c*pe*ke,e[9]=o*pe*Me-r*we*Me-o*fe*Oe+i*we*Oe+r*fe*ke-i*pe*ke,e[10]=r*Z*Me-o*m*Me+o*c*Oe-i*Z*Oe-r*c*ke+i*m*ke,e[11]=o*m*fe-r*Z*fe-o*c*pe+i*Z*pe+r*c*we-i*m*we,e[12]=I*pe*Me-m*ye*Me-I*fe*Oe+c*ye*Oe+m*fe*Be-c*pe*Be,e[13]=r*ye*Me-s*pe*Me+s*fe*Oe-i*ye*Oe-r*fe*Be+i*pe*Be,e[14]=s*m*Me-r*I*Me-s*c*Oe+i*I*Oe+r*c*Be-i*m*Be,e[15]=r*I*fe-s*m*fe+s*c*pe-i*I*pe-r*c*ye+i*m*ye,t.setData(e),t.scalar(1/ze),t)}setCSS(t){if(!t||"none"==t)return this.identity();let e=t.replace("matrix3d(","").replace("matrix(","").replace(")","").split(","),i=e.length;for(let r=0;r<i;++r)e[r]=Pi.parse(e[r]);return this.setData(e)}appendCSS(t,e=!1){return t&&"none"!=t?e&&t.indexOf("matrix3d")>=0?this.append(tr.MATRIX3D.setCSS(t).flatten()):this.append(tr.MATRIX3D.setCSS(t)):this}flatten(){return this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m44=1,this.m14=0,this.m24=0,this.m43=0,this}static multiply(t,e,i=new tr){let s=t.m11*e.m12+t.m12*e.m22+t.m13*e.m32+t.m14*e.m42,o=t.m11*e.m13+t.m12*e.m23+t.m13*e.m33+t.m14*e.m43,c=t.m11*e.m14+t.m12*e.m24+t.m13*e.m34+t.m14*e.m44,m=t.m21*e.m11+t.m22*e.m21+t.m23*e.m31+t.m24*e.m41,I=t.m21*e.m12+t.m22*e.m22+t.m23*e.m32+t.m24*e.m42,Z=t.m21*e.m13+t.m22*e.m23+t.m23*e.m33+t.m24*e.m43,fe=t.m21*e.m14+t.m22*e.m24+t.m23*e.m34+t.m24*e.m44,pe=t.m31*e.m11+t.m32*e.m21+t.m33*e.m31+t.m34*e.m41,ye=t.m31*e.m12+t.m32*e.m22+t.m33*e.m32+t.m34*e.m42,we=t.m31*e.m13+t.m32*e.m23+t.m33*e.m33+t.m34*e.m43,Me=t.m31*e.m14+t.m32*e.m24+t.m33*e.m34+t.m34*e.m44,Oe=t.m41*e.m11+t.m42*e.m21+t.m43*e.m31+t.m44*e.m41,Be=t.m41*e.m12+t.m42*e.m22+t.m43*e.m32+t.m44*e.m42,ke=t.m41*e.m13+t.m42*e.m23+t.m43*e.m33+t.m44*e.m43,ze=t.m41*e.m14+t.m42*e.m24+t.m43*e.m34+t.m44*e.m44;return i.m11=t.m11*e.m11+t.m12*e.m21+t.m13*e.m31+t.m14*e.m41,i.m12=s,i.m13=o,i.m14=c,i.m21=m,i.m22=I,i.m23=Z,i.m24=fe,i.m31=pe,i.m32=ye,i.m33=we,i.m34=Me,i.m41=Oe,i.m42=Be,i.m43=ke,i.m44=ze,i}toString(t=3){return"m11="+this.m11.toFixed(t)+"\tm21="+this.m21.toFixed(t)+"\tm31="+this.m31.toFixed(t)+"\tm41="+this.m41.toFixed(t)+"\nm12="+this.m12.toFixed(t)+"\tm22="+this.m22.toFixed(t)+"\tm32="+this.m32.toFixed(t)+"\tm42="+this.m42.toFixed(t)+"\nm13="+this.m13.toFixed(t)+"\tm23="+this.m23.toFixed(t)+"\tm33="+this.m33.toFixed(t)+"\tm43="+this.m43.toFixed(t)+"\nm14="+this.m14.toFixed(t)+"\tm24="+this.m24.toFixed(t)+"\tm34="+this.m34.toFixed(t)+"\tm44="+this.m44.toFixed(t)}}tr.MATRIX3D=new tr;class df{constructor(t){this.matrix=new tr,this.sceneTransform=new tr,this.inverseSceneTransform=new tr,this.initialize(t)}clear(){return this.element=null,this.matrix.identity(),this}initialize(t){if(!t)return;this.element=t;let e=window.getComputedStyle(t),i=0,r=0;return this.element.parentElement?(i=this.element.parentElement.clientWidth,r=this.element.parentElement.clientHeight):(i=window.innerWidth,r=window.innerHeight),this.paddingLeft=Pi.relation(e.paddingTop,i),this.paddingTop=Pi.relation(e.paddingTop,r),this.marginLeft=Pi.relation(e.marginLeft,i),this.marginTop=Pi.relation(e.marginTop,r),this.borderLeft=Pi.relation(e.borderLeft,i),this.borderTop=Pi.relation(e.borderTop,r),this.matrix.setCSS(e.transform),this.sceneTransform.identity(),this.extract(this,this.sceneTransform),this.sceneTransform.invert(this.inverseSceneTransform),this}globalToLocal(t,e,i=0){let r={x:t,y:e,z:i,w:1};return this.inverseSceneTransform.unproject(r,r),this.fromBorderBox(r),r}localToGlobal(t,e,i=0){let r={x:t,y:e,z:i,w:1};return this.sceneTransform.project(r,r),this.fromBorderBox(r),r}localToLocal(t,e,i,r){let s_x=t,s_y=e,s_z=i,o=new df(r),c=tr.multiply(this.sceneTransform,o.inverseSceneTransform),m={x:0,y:0,z:0,w:1};return m.x=s_x*c.m11+s_y*c.m21+s_z*c.m31+1*c.m41,m.y=s_x*c.m12+s_y*c.m22+s_z*c.m32+1*c.m42,m.z=s_x*c.m13+s_y*c.m23+s_z*c.m33+1*c.m43,m.w=s_x*c.m14+s_y*c.m24+s_z*c.m34+1*c.m44,o.clear(),this.toBorderBox(m),m}extract(t,e){let r=t.element;for(;r;)this.extractMatrix(r,e),r&&"fixed"===r.style.position&&(console.warn("fixed\u9818\u57df\u306f\u8a08\u7b97\u304c\u4e0d\u6b63\u78ba"),e.appendPosition(window.pageXOffset,window.pageYOffset,0)),r=r.parentElement}extractMatrix(t,e=null){if(e||(e=new tr),!t)return e;let i=t,r=window.getComputedStyle(t);if("none"!=r.transform){let c=r.transformOrigin?r.transformOrigin.split(" "):[],m=Pi.relation(c[0],i.offsetWidth,.5*i.offsetWidth),I=Pi.relation(c[1],i.offsetHeight,.5*i.offsetHeight),Z=Pi.relation(c[2],0,0);e.appendPosition(-m,-I,-Z),e.appendCSS(r.transform),e.appendPosition(m,I,Z)}let s=this.getPosition(t);e.appendPosition(s.x,s.y,0);let o=0;if(t.parentElement){let c=window.getComputedStyle(t.parentElement);o=Pi.parse(c.perspective)}if(t.parentElement&&o){let m=window.getComputedStyle(t.parentElement).perspectiveOrigin.split(" "),I=Pi.relation(m[0],i.parentElement.offsetWidth),Z=Pi.relation(m[1],i.parentElement.offsetHeight);e.appendPosition(-I,-Z,0),e.appendPerspective(o),e.appendPosition(I,Z,0)}return e}getPosition(t){let e={x:0,y:0};return e.x=t.offsetParent?t.parentElement===t.offsetParent?t.offsetLeft:t.parentElement.offsetParent===t.offsetParent?t.offsetLeft-t.parentElement.offsetLeft:0:t.offsetLeft,e.y=t.offsetParent?t.parentElement===t.offsetParent?t.offsetTop:t.parentElement.offsetParent===t.offsetParent?t.offsetTop-t.parentElement.offsetTop:0:t.offsetTop,e.x+=t.offsetParent?t.offsetParent.clientLeft:0,e.y+=t.offsetParent?t.offsetParent.clientTop:0,e}fromBorderBox(t){t.x+=this.paddingLeft,t.y+=this.paddingTop,t.x-=this.marginLeft,t.y-=this.marginTop,t.x-=this.borderLeft,t.y-=this.borderTop}toBorderBox(t){t.x-=this.paddingLeft,t.y-=this.paddingTop,t.x+=this.marginLeft,t.y+=this.marginTop,t.x+=this.borderLeft,t.y+=this.borderTop}}let Ja=(()=>{class n{constructor(e){this.pointerDeviceService=e,this.tabletopOriginElement=document.body}convertToLocal(e,i=document.body){let r=new df(i),s=r.globalToLocal(e.x,e.y,e.z?e.z:0);return r.clear(),{x:s.x,y:s.y,z:s.z}}convertToGlobal(e,i=document.body){let r=new df(i),s=r.localToGlobal(e.x,e.y,e.z?e.z:0);return r.clear(),{x:s.x,y:s.y,z:s.z}}convertLocalToLocal(e,i,r){let s=new df(i),o=s.globalToLocal(e.x,e.y,e.z?e.z:0),c=s.localToLocal(o.x,o.y,0,r);return s.clear(),{x:c.x,y:c.y,z:c.z}}calcTabletopLocalCoordinate(e={x:this.pointerDeviceService.pointers[0].x,y:this.pointerDeviceService.pointers[0].y,z:0},i=this.pointerDeviceService.targetElement){return i.contains(this.tabletopOriginElement)?(e=this.convertToLocal(e,this.tabletopOriginElement)).z=0:e=this.convertLocalToLocal(e,i,this.tabletopOriginElement),{x:e.x,y:e.y,z:0<e.z?e.z:0}}}return n.\u0275fac=function(e){return new(e||n)(rn(ai))},n.\u0275prov=tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),vu=(()=>{class n{constructor(e){this.coordinateService=e,this._emptyTable=new Li(""),this.locationMap=new Map,this.parentMap=new Map,this.characterCache=new el(()=>lt.instance.getObjects(Vt).filter(i=>i.isVisibleOnTable)),this.cardCache=new el(()=>lt.instance.getObjects(On).filter(i=>i.isVisibleOnTable)),this.cardStackCache=new el(()=>lt.instance.getObjects(Gn).filter(i=>i.isVisibleOnTable)),this.tableMaskCache=new el(()=>{let i=this.tableSelecter.viewTable;return i?i.masks:[]}),this.rangeCache=new el(()=>lt.instance.getObjects(ni).filter(i=>i.isVisibleOnTable)),this.terrainCache=new el(()=>{let i=this.tableSelecter.viewTable;return i?i.terrains:[]}),this.textNoteCache=new el(()=>lt.instance.getObjects(Tr)),this.diceSymbolCache=new el(()=>lt.instance.getObjects(or)),this.initialize()}get tableSelecter(){return lr.instance}get currentTable(){return this.tableSelecter.viewTable||this._emptyTable}get characters(){return this.characterCache.objects}get cards(){return this.cardCache.objects}get cardStacks(){return this.cardStackCache.objects}get tableMasks(){return this.tableMaskCache.objects}get ranges(){return this.rangeCache.objects}get terrains(){return this.terrainCache.objects}get textNotes(){return this.textNoteCache.objects}get diceSymbols(){return this.diceSymbolCache.objects}get peerCursors(){return lt.instance.getObjects(Ue)}initialize(){this.refreshCacheAll(),Fe.register(this).on("UPDATE_GAME_OBJECT",e=>{if(e.data.identifier===this.currentTable.identifier||e.data.identifier===this.tableSelecter.identifier)return this.refreshCache(is.aliasName),void this.refreshCache(ar.aliasName);let i=lt.instance.get(e.data.identifier);i&&i instanceof $i?this.shouldRefreshCache(i)&&(this.refreshCache(e.data.aliasName),this.updateMap(i)):this.refreshCache(e.data.aliasName)}).on("DELETE_GAME_OBJECT",e=>{let i=e.data.aliasName;i?this.refreshCache(i):this.refreshCacheAll()}).on("XML_LOADED",e=>{let r=Zn.instance.parseXml(e.data.xmlElement);if(r instanceof $i){let s=this.coordinateService.calcTabletopLocalCoordinate();r.location.x=s.x-25,r.location.y=s.y-25,r.posZ=s.z,this.placeToTabletop(r),dt.play(Ze.piecePut)}else r instanceof Za?go.instance.addChatTab(r):r instanceof ua?ho.instance.addDiceRollTable(r):r instanceof vi&&po.instance.addCutIn(r)})}findCache(e){switch(e){case Vt.aliasName:return this.characterCache;case On.aliasName:return this.cardCache;case Gn.aliasName:return this.cardStackCache;case is.aliasName:return this.tableMaskCache;case ar.aliasName:return this.terrainCache;case Tr.aliasName:return this.textNoteCache;case or.aliasName:return this.diceSymbolCache;case ni.aliasName:return this.rangeCache;default:return null}}refreshCache(e){let i=this.findCache(e);i&&i.refresh()}refreshCacheAll(){this.characterCache.refresh(),this.cardCache.refresh(),this.cardStackCache.refresh(),this.tableMaskCache.refresh(),this.terrainCache.refresh(),this.textNoteCache.refresh(),this.diceSymbolCache.refresh(),this.rangeCache.refresh(),this.clearMap()}shouldRefreshCache(e){return this.locationMap.get(e.identifier)!==e.location.name||this.parentMap.get(e.identifier)!==e.parentId}updateMap(e){this.locationMap.set(e.identifier,e.location.name),this.parentMap.set(e.identifier,e.parentId)}clearMap(){this.locationMap.clear(),this.parentMap.clear()}placeToTabletop(e){switch(e.aliasName){case is.aliasName:e instanceof is&&(e.isLock=!1);case ar.aliasName:if(e instanceof ar&&(e.isLocked=!1),!this.tableSelecter||!this.tableSelecter.viewTable)return;this.tableSelecter.viewTable.appendChild(e);break;case On.aliasName:case Gn.aliasName:case ni.aliasName:case Tr.aliasName:(e instanceof On||e instanceof Gn||e instanceof ni||e instanceof Tr)&&(e.isLocked=!1),e instanceof ni&&(e.followingCharctorIdentifier=null);default:e.setLocation("table")}}}return n.\u0275fac=function(e){return new(e||n)(rn(Ja))},n.\u0275prov=tn({token:n,factory:n.\u0275fac}),n})();class el{constructor(t){this.refreshCollector=t,this.needsRefresh=!0,this._objects=[]}get objects(){return this.needsRefresh&&(this._objects=this.refreshCollector(),this._objects=this._objects?this._objects:[],this.needsRefresh=!1),this._objects}refresh(){this.needsRefresh=!0}}class Yl{constructor(t,e,i){this.chanks=[],this.chankSize=32768,this.chankReceiveCount=0,this.sentChankIndex=0,this.bufferingChankRange=4,this.completedChankIndex=0,this.startTime=0,this.isCanceled=!1,this.identifier=t,this.sendTo=e,this.data=i}static createSendTask(t,e,i){let r=new Yl(t,e,i);return r.onstart=()=>r.initializeSend(),r}static createReceiveTask(t){let e=new Yl(t);return e.onstart=()=>e.initializeReceive(),e}start(t){this.onstart?(this.data=t,this.onstart(),this.onstart=null):console.warn("\u518d\u8d77\u52d5\u3059\u308b\u4ed5\u69d8\u306a\u3069\u7121\u3044\u3002")}progress(t,e){this.onprogress&&this.onprogress(this,t,e)}finish(){this.isCanceled||(this.isCanceled=!0,this.onfinish&&this.onfinish(this,this.data),this.dispose())}timeout(){this.isCanceled||(this.isCanceled=!0,this.ontimeout&&this.ontimeout(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}cancel(){this.isCanceled||(null!=this.sendTo&&Fe.call("CANCEL_TASK_"+this.identifier,null,this.sendTo),this._cancel())}_cancel(){this.isCanceled||(this.isCanceled=!0,this.oncancel&&this.oncancel(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}dispose(){Fe.unregister(this),this.sendChankTimer&&function E8(n){Fd.delete(n)}(this.sendChankTimer),this.timeoutTimer&&this.timeoutTimer.clear(),this.sendChankTimer=null,this.timeoutTimer=null,this.onprogress=this.onfinish=this.ontimeout=this.oncancel=null}initializeSend(){this.uint8Array=vs.encode(this.data);let t=Math.ceil(this.uint8Array.byteLength/this.chankSize);this.chanks=new Array(t),console.log("\u30c1\u30e3\u30f3\u30af\u5206\u5272 "+this.identifier,this.chanks.length),Fe.register(this).on("FILE_MORE_CHANK_"+this.identifier,e=>{this.sendTo===e.sendFrom&&(this.completedChankIndex=e.data,null==this.sendChankTimer&&this.sentChankIndex+1<this.chanks.length&&this.sendChank(this.sentChankIndex+1),this.resetTimeout())}).on("DISCONNECT_PEER",e=>{e.data.peerId===this.sendTo&&(console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,e.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,e=>{console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,e.sendFrom),this._cancel()}),this.sentChankIndex=this.completedChankIndex=0,this.startTime=performance.now(),xr(()=>this.sendChank(0))}sendChank(t){let e=this.uint8Array.slice(t*this.chankSize,(t+1)*this.chankSize);Fe.call("FILE_SEND_CHANK_"+this.identifier,{index:t,length:this.chanks.length,chank:e},this.sendTo),this.sentChankIndex=t,this.sendChankTimer=null,this.chanks.length<=t+1?(console.log("\u30d0\u30c3\u30d5\u30a1\u9001\u4fe1\u5b8c\u4e86",this.identifier),this.outputTransferRate(this.uint8Array.byteLength),xr(()=>this.finish())):this.completedChankIndex+this.bufferingChankRange<=t?this.resetTimeout():this.sendChankTimer=xr(()=>{this.sendChank(this.sentChankIndex+1)})}initializeReceive(){this.resetTimeout(),this.startTime=performance.now(),this.chankReceiveCount=0,Fe.register(this).on("FILE_SEND_CHANK_"+this.identifier,t=>{this.chanks.length<1&&(this.chanks=new Array(t.data.length)),null==this.chanks[t.data.index]?(this.chankReceiveCount++,this.chanks[t.data.index]=t.data.chank,this.progress(t.data.index,t.data.length),this.chanks.length<=this.chankReceiveCount?this.finishReceive():(this.resetTimeout(),Fe.call("FILE_MORE_CHANK_"+this.identifier,t.data.index,t.sendFrom))):console.log(`already received. [${t.data.index}] <${this.identifier}>`)}).on("DISCONNECT_PEER",t=>{t.data.peerId===this.sendTo&&(console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,t.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,t=>{console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,t.sendFrom),this._cancel()})}finishReceive(){console.log("\u30d0\u30c3\u30d5\u30a1\u53d7\u4fe1\u5b8c\u4e86",this.identifier);let t=0;for(let r of this.chanks)t+=r.byteLength;this.outputTransferRate(t);let e=new Uint8Array(t),i=0;for(let r of this.chanks)e.set(r,i),i+=r.byteLength;this.data=vs.decode(e),this.finish()}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new la(()=>this.timeout(),1e4)),this.timeoutTimer.reset()}outputTransferRate(t){let e=performance.now()-this.startTime,i=t/1024/1024/(e/1e3);console.log(`${(t/1024).toFixed(2)}KB ${(e/1e3).toFixed(2)}\u79d2 \u8ee2\u9001\u901f\u5ea6: ${i.toFixed(2)}MB/s`)}}class bu{constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4}static get instance(){return bu._instance||(bu._instance=new bu),bu._instance}initialize(){console.log("AudioSharingSystem ready..."),this.destroy(),Fe.register(this).on("CONNECT_PEER",-1,t=>{!t.isSendFromSelf||(console.log("CONNECT_PEER AudioStorageService !!!",t.data.peerId),Lt.instance.synchronize())}).on("SYNCHRONIZE_AUDIO_LIST",t=>{if(t.isSendFromSelf)return;console.log("SYNCHRONIZE_AUDIO_LIST "+t.sendFrom);let e=t.data,i=[];console.log("SYNCHRONIZE_AUDIO_LIST active tasks ",this.sendTaskMap.size+this.receiveTaskMap.size);for(let s of e){let o=Lt.instance.get(s.identifier);null===o&&(o=bs.createEmpty(s.identifier),Lt.instance.add(o)),o.state<fr.COMPLETE&&!this.receiveTaskMap.has(s.identifier)&&i.push({identifier:s.identifier,state:o.state})}if(i.length<1&&!this.hasActiveTask()&&e.length<Lt.instance.getCatalog().length&&Lt.instance.synchronize(t.sendFrom),i.length<1||this.isLimitReceiveTask())return;let r=Math.floor(Math.random()*i.length);this.request([i[r]],t.sendFrom)}).on("REQUEST_AUDIO_RESOURE",t=>{if(t.isSendFromSelf)return;let e=t.data.identifiers,i=[];for(let r of e){let s=Lt.instance.get(r.identifier);s&&r.state<s.state&&i.push({identifier:r.identifier,state:r.state})}if(!1===this.isLimitSendTask()&&0<i.length&&!this.existsSendTask(t.data.receiver)){console.log("REQUEST_AUDIO_RESOURE Send!!! "+t.data.receiver+" -> "+i);let r=Math.floor(Math.random()*i.length),o=Lt.instance.get(i[r].identifier);this.startSendTask(o,t.data.receiver)}else{let r=t.data.candidatePeers,s=r.indexOf(yt.peerId);-1<s&&r.splice(s,1);for(let o of r)return console.log("REQUEST_AUDIO_RESOURE AudioStorageService Relay!!! "+o+" -> "+t.data.identifiers),void Fe.call(t,o);console.log("REQUEST_FILE_RESOURE AudioStorageService \u3042\u3076\u308c\u305f..."+t.data.receiver,i.length)}}).on("UPDATE_AUDIO_RESOURE",1e3,t=>{let e=t.data;console.log("UPDATE_AUDIO_RESOURE AudioStorageService "+t.sendFrom+" -> ",e);for(let i of e)i.blob&&(i.blob=new Blob([i.blob],{type:i.type})),Lt.instance.add(i)}).on("START_AUDIO_TRANSMISSION",t=>{console.log("START_AUDIO_TRANSMISSION "+t.data.fileIdentifier);let e=t.data.fileIdentifier,i=Lt.instance.get(e);this.receiveTaskMap.has(e)||i&&fr.COMPLETE<=i.state?(console.warn("CANCEL_TASK_ "+e),Fe.call("CANCEL_TASK_"+e,null,t.sendFrom)):this.startReceiveTask(e)})}destroy(){Fe.unregister(this)}startSendTask(t,e){var i=this;return(0,en.Z)(function*(){let r=Yl.createSendTask(t.identifier,e);i.sendTaskMap.set(t.identifier,r),Fe.call("START_AUDIO_TRANSMISSION",{fileIdentifier:t.identifier},e);let s={identifier:t.identifier,name:t.name,blob:null,type:"",url:null};t.state===fr.URL?s.url=t.url:(s.blob=yield uo.readAsArrayBufferAsync(t.blob),s.type=t.blob.type),r.onfinish=()=>{i.stopSendTask(r.identifier),Lt.instance.synchronize()},r.start(s)})()}startReceiveTask(t){let e=Lt.instance.get(t),i=Yl.createReceiveTask(t);this.receiveTaskMap.set(t,i),i.onprogress=(r,s,o)=>{let c=e.toContext();c.name=(100*s/o).toFixed(1)+"%",e.apply(c)},i.onfinish=(r,s)=>{this.stopReceiveTask(r.identifier),s&&Fe.trigger("UPDATE_AUDIO_RESOURE",[s]),Lt.instance.synchronize()},i.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(t){let e=this.sendTaskMap.get(t);e&&e.cancel(),this.sendTaskMap.delete(t),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(t){let e=this.receiveTaskMap.get(t);e&&e.cancel(),this.receiveTaskMap.delete(t),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(t,e){console.log("requestFile() "+e);let i=yt.peerIds;i.splice(i.indexOf(yt.peerId),1),Fe.call("REQUEST_AUDIO_RESOURE",{identifiers:t,receiver:yt.peerId,candidatePeers:i},e)}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(t){for(let e of this.sendTaskMap.values())if(e&&e.sendTo===t)return!0;return!1}}class yu{constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4,console.log("FileSharingSystem ready...")}static get instance(){return yu._instance||(yu._instance=new yu),yu._instance}initialize(){var t=this;Fe.register(this).on("CONNECT_PEER",1,e=>{!e.isSendFromSelf||(console.log("CONNECT_PEER ImageStorageService !!!",e.data.peerId),kt.instance.synchronize())}).on("XML_LOADED",e=>{!function Zq(n){let t=[],e=n.querySelectorAll('*[type="image"]');for(let i=0;i<e.length;i++){let r=e[i].innerHTML;!kt.instance.get(r)&&0<ql.type(r).length&&t.push(r)}e=n.querySelectorAll("*[imageIdentifier]");for(let i=0;i<e.length;i++){let r=e[i].getAttribute("imageIdentifier");!kt.instance.get(r)&&0<ql.type(r).length&&t.push(r)}for(let i of t)kt.instance.add(i)}(e.data.xmlElement)}).on("SYNCHRONIZE_FILE_LIST",e=>{if(e.isSendFromSelf)return;console.log("SYNCHRONIZE_FILE_LIST ImageStorageService "+e.sendFrom);let i=e.data,r=[];for(let s of i){let o=kt.instance.get(s.identifier);null===o&&(o=Ht.createEmpty(s.identifier),kt.instance.add(o)),o.state<Bi.COMPLETE&&!this.receiveTaskMap.has(s.identifier)&&r.push({identifier:s.identifier,state:o.state})}r.length<1&&!this.hasActiveTask()&&i.length<kt.instance.getCatalog().length&&kt.instance.synchronize(e.sendFrom),!(r.length<1||this.isLimitReceiveTask())&&this.request(r,e.sendFrom)}).on("REQUEST_FILE_RESOURE",function(){var e=(0,en.Z)(function*(i){if(i.isSendFromSelf)return;let r=i.data.identifiers,s=[];for(let o of r){let c=kt.instance.get(o.identifier);c&&o.state<c.state&&s.push({identifier:o.identifier,state:o.state})}if(!1===t.isLimitSendTask()&&0<s.length&&!t.existsSendTask(i.data.receiver)){let o=t.makeSendUpdateImages(s);console.log("REQUEST_FILE_RESOURE ImageStorageService Send!!! "+i.data.receiver+" -> "+o.length),t.startSendTask(o,i.data.receiver)}else{let o=i.data.candidatePeers,c=o.indexOf(yt.peerId);-1<c&&o.splice(c,1);for(let m of o)return console.log("REQUEST_FILE_RESOURE ImageStorageService Relay!!! "+m+" -> "+i.data.identifiers),void Fe.call(i,m);console.log("REQUEST_FILE_RESOURE ImageStorageService \u3042\u3076\u308c\u305f..."+i.data.receiver,s.length)}});return function(i){return e.apply(this,arguments)}}()).on("UPDATE_FILE_RESOURE",1e3,e=>{let i=e.data.updateImages;console.log("UPDATE_FILE_RESOURE ImageStorageService "+e.sendFrom+" -> ",i);for(let r of i)r.blob&&(r.blob=new Blob([r.blob],{type:r.type})),r.thumbnail.blob&&(r.thumbnail.blob=new Blob([r.thumbnail.blob],{type:r.thumbnail.type})),kt.instance.add(r)}).on("START_FILE_TRANSMISSION",e=>{console.log("START_FILE_TRANSMISSION "+e.data.taskIdentifier);let i=e.data.taskIdentifier,r=kt.instance.get(i);this.receiveTaskMap.has(i)||r&&Bi.COMPLETE<=r.state?(console.warn("CANCEL_TASK_ "+i),Fe.call("CANCEL_TASK_"+i,null,e.sendFrom)):this.startReceiveTask(i)})}destroy(){Fe.unregister(this)}startSendTask(t,e){var i=this;return(0,en.Z)(function*(){let r=1===t.length?t[0].identifier:ns.generateUuid(),s=Yl.createSendTask(r,e);i.sendTaskMap.set(s.identifier,s),Fe.call("START_FILE_TRANSMISSION",{taskIdentifier:r},e);for(let o of t)o.thumbnail.blob?o.thumbnail.blob=yield uo.readAsArrayBufferAsync(o.thumbnail.blob):o.blob&&(o.blob=yield uo.readAsArrayBufferAsync(o.blob));s.onfinish=(o,c)=>{i.stopSendTask(o.identifier),kt.instance.synchronize()},s.start(t)})()}startReceiveTask(t){let e=Yl.createReceiveTask(t);this.receiveTaskMap.set(t,e),e.onfinish=(i,r)=>{this.stopReceiveTask(i.identifier),r&&Fe.trigger("UPDATE_FILE_RESOURE",{identifier:i.identifier,updateImages:r}),kt.instance.synchronize()},e.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(t){let e=this.sendTaskMap.get(t);e&&e.cancel(),this.sendTaskMap.delete(t),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(t){let e=this.receiveTaskMap.get(t);e&&e.cancel(),this.receiveTaskMap.delete(t),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(t,e){console.log("requestFile() "+e);let i=yt.peerIds;i.splice(i.indexOf(yt.peerId),1),Fe.call("REQUEST_FILE_RESOURE",{identifiers:t,receiver:yt.peerId,candidatePeers:i},e)}makeSendUpdateImages(t,e=524288){let i=[],r=0;for(let s=t.length-1;0<=s;s--){let o=Math.floor(Math.random()*(s+1));[t[s],t[o]]=[t[o],t[s]]}t.sort((s,o)=>s.state<o.state?-1:s.state>o.state?1:0);for(let s=0;s<t.length;s++){let o=t[s],c=kt.instance.get(o.identifier),m={identifier:c.identifier,name:c.name,type:"",blob:null,url:null,thumbnail:{type:"",blob:null,url:null}};c.state===Bi.URL?m.url=c.url:o.state===Bi.NULL?(m.thumbnail.blob=c.thumbnail.blob,m.thumbnail.type=c.thumbnail.type):(m.blob=c.blob,m.type=c.blob.type);let I=m.blob?m.blob.size:m.thumbnail.blob?m.thumbnail.blob.size:100;if(i.push(m),r+=I,e<r)break}return i}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(t){for(let e of this.sendTaskMap.values())if(e&&e.sendTo===t)return!0;return!1}}class Ni{constructor(t){this.peerId=t,this.requestMap=new Map}static create(t,e){Ni.tasksMap.size<1&&Fe.register(Ni.key).on("DISCONNECT_PEER",r=>{Ni.onDisconnect(r.data.peerId)}).on("UPDATE_GAME_OBJECT",r=>{r.isSendFromSelf||Ni.onUpdate(r.data.identifier)}).on("DELETE_GAME_OBJECT",r=>{r.isSendFromSelf||Ni.onUpdate(r.data.identifier)});let i=new Ni(t);return i.initialize(e),i}cancel(){this.timeoutTimer&&this.timeoutTimer.clear(),this.timeoutTimer=null,this.onsynchronize=this.onfinish=this.ontimeout=null;for(let t of this.requestMap.values())this.deleteTasksMap(t.identifier);this.requestMap.clear()}initialize(t){for(let e of t){e.ttl--,this.requestMap.set(e.identifier,e);let i=Ni.tasksMap.get(e.identifier);null==i&&(i=[]),i.push(this),Ni.tasksMap.set(e.identifier,i);let r=null!=this.peerId&&e.holderIds.includes(this.peerId)?this.peerId:null;Fe.call("REQUEST_GAME_OBJECT",e.identifier,r)}this.requestMap.size<1?setTimeout(()=>this.finish()):this.resetTimeout()}finish(){this.onfinish&&this.onfinish(this),this.cancel()}timeout(){this.ontimeout&&this.ontimeout(this,Array.from(this.requestMap.values()).filter(t=>0<=t.ttl)),this.finish()}static onDisconnect(t){for(let e of Ni.tasksMap.values())for(let i of e.concat())i.peerId===t&&i.timeout();Ni.tasksMap.size<1&&Fe.unregister(Ni.key)}static onUpdate(t){if(!Ni.tasksMap.has(t))return;let e=Ni.tasksMap.get(t);for(let i of e.concat())i.onUpdate(t);Ni.tasksMap.size<1&&Fe.unregister(Ni.key)}onUpdate(t){this.requestMap.delete(t),this.onsynchronize&&this.onsynchronize(this,t),this.requestMap.size<1?this.finish():this.resetTimeout()}deleteTasksMap(t){let e=Ni.tasksMap.get(t),i=e.indexOf(this);-1<i&&e.splice(i,1),e.length<1&&Ni.tasksMap.delete(t)}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new la(()=>this.timeout(),3e4)),this.timeoutTimer.reset()}}Ni.key={},Ni.tasksMap=new Map;class Cu{constructor(){this.requestMap=new Map,this.peerMap=new Map,this.tasks=[]}static get instance(){return Cu._instance||(Cu._instance=new Cu),Cu._instance}initialize(){this.destroy(),console.log("ObjectSynchronizer ready..."),Fe.register(this).on("CONNECT_PEER",2,t=>{!t.isSendFromSelf||(console.log("CONNECT_PEER GameRoomService !!!",t.data.peerId),this.sendCatalog(t.data.peerId))}).on("DISCONNECT_PEER",t=>{this.removePeerMap(t.data.peerId)}).on("SYNCHRONIZE_GAME_OBJECT",t=>{if(t.isSendFromSelf)return;console.log("SYNCHRONIZE_GAME_OBJECT "+t.sendFrom);let e=t.data;for(let i of e)lt.instance.isDeleted(i.identifier)?Fe.call("DELETE_GAME_OBJECT",{aliasName:"",identifier:i.identifier},t.sendFrom):this.addRequestMap(i,t.sendFrom);this.synchronize()}).on("REQUEST_GAME_OBJECT",t=>{if(!t.isSendFromSelf)if(lt.instance.isDeleted(t.data))Fe.call("DELETE_GAME_OBJECT",{aliasName:"",identifier:t.data},t.sendFrom);else{let e=lt.instance.get(t.data);e&&Fe.call("UPDATE_GAME_OBJECT",e.toContext(),t.sendFrom)}}).on("UPDATE_GAME_OBJECT",1e3,t=>{let e=t.data,i=lt.instance.get(e.identifier);i?t.isSendFromSelf||this.updateObject(i,e):lt.instance.isDeleted(e.identifier)?Fe.call("DELETE_GAME_OBJECT",{aliasName:e.aliasName,identifier:e.identifier},t.sendFrom):this.createObject(e)}).on("DELETE_GAME_OBJECT",1e3,t=>{lt.instance.delete(t.data.identifier,!1)})}destroy(){Fe.unregister(this)}updateObject(t,e){e.majorVersion+e.minorVersion>t.version&&t.apply(e)}createObject(t){let e=No.instance.create(t.aliasName,t.identifier);e?(lt.instance.add(e,!1),e.apply(t)):console.warn(t.aliasName+" is Unknown...?",t)}sendCatalog(t){let e=lt.instance.getCatalog(),i=setInterval(()=>{Fe.call("SYNCHRONIZE_GAME_OBJECT",e.splice(0,e.length<2048?e.length:2048),t),e.length<1&&clearInterval(i)})}addRequestMap(t,e){let i=this.requestMap.get(t.identifier);i&&i.version===t.version?(i.holderIds.push(e),this.addPeerMap(e)):(!i||i.version<t.version)&&(this.requestMap.set(t.identifier,{identifier:t.identifier,version:t.version,holderIds:[e],ttl:2}),this.addPeerMap(e))}addPeerMap(t){this.peerMap.has(t)||this.peerMap.set(t,[])}removePeerMap(t){this.peerMap.delete(t)}synchronize(){for(;0<this.requestMap.size&&this.tasks.length<32;)this.runSynchronizeTask()}runSynchronizeTask(){let t=this.getTargetPeerId(),e=this.makeRequestList(t);if(e.length<1)return void this.removePeerMap(t);let i=Ni.create(t,e);this.tasks.push(i);let r=this.peerMap.get(t);r&&r.push(i),i.onfinish=s=>{this.tasks.splice(this.tasks.indexOf(s),1);let o=this.peerMap.get(t);o&&o.splice(o.indexOf(s),1),this.synchronize()},i.ontimeout=(s,o)=>{console.log("GameObject synchronize \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8"),o.forEach(c=>this.requestMap.set(c.identifier,c))}}makeRequestList(t,e=32){let i=[];for(let[r,s]of this.requestMap){if(e<=i.length)break;if(!s.holderIds.includes(t))continue;let o=lt.instance.get(s.identifier);(!o||o.version<s.version)&&i.push(s),this.requestMap.delete(r)}return i}getTargetPeerId(){let t=9999,e=null,i=yt.peerContexts;for(let r=i.length-1;0<=r;r--){let s=Math.floor(Math.random()*(r+1));[i[r],i[s]]=[i[s],i[r]]}for(let r of i){let s=this.peerMap.get(r.peerId);r.isOpen&&s&&s.length<t&&(t=s.length,e=r.peerId)}return e}}let Zl=class extends Ua{constructor(){super(...arguments),this.audioIdentifier="",this.startTime=0,this.isLoop=!1,this.isPlaying=!1,this.audioPlayer=new At}get audio(){return Lt.instance.get(this.audioIdentifier)}onStoreAdded(){super.onStoreAdded(),this.unlockAfterUserInteraction()}onStoreRemoved(){super.onStoreRemoved(),this._stop()}play(t,e=!1){let i=Lt.instance.get(t);!i||!i.isReady||(this.audioIdentifier=t,this.isPlaying=!0,this.isLoop=e,this._play())}_play(){this._stop(),this.audio&&this.audio.isReady?(this.audioPlayer.loop=!0,this.audioPlayer.play(this.audio)):this.playAfterFileUpdate()}stop(){this.audioIdentifier="",this.isPlaying=!1,this._stop()}_stop(){this.unregisterEvent(),this.audioPlayer.stop()}playAfterFileUpdate(){Fe.register(this).on("UPDATE_AUDIO_RESOURE",t=>{this._play()})}unlockAfterUserInteraction(){let t=()=>{document.body.removeEventListener("touchstart",t,!0),document.body.removeEventListener("mousedown",t,!0),this.audioPlayer.stop(),this.isPlaying&&this._play()};document.body.addEventListener("touchstart",t,!0),document.body.addEventListener("mousedown",t,!0)}unregisterEvent(){Fe.unregister(this,"UPDATE_AUDIO_RESOURE")}apply(t){let e=this.audioIdentifier,i=this.isPlaying;super.apply(t),e===this.audioIdentifier&&i||!this.isPlaying?i!==this.isPlaying&&!this.isPlaying&&this._stop():this._play()}};function Xq(n,t){if(1&n&&(K(0,"option",6),be(1),J()),2&n){const e=t.$implicit;ct("value",e.identifier),U(1),qe(e.name)}}function Qq(n,t){if(1&n){const e=Xe();Ve(0),K(1,"div",7)(2,"div"),be(3," \u30bf\u30d6"),K(4,"sup",8),be(5,"*"),J(),be(6,"\uff1a "),K(7,"label")(8,"input",9),Te("ngModelChange",function(r){return De(e),ge().isAllTabs=r}),J(),be(9,"\u9078\u629e\u3057\u305f\u30bf\u30d6"),J(),K(10,"label")(11,"input",9),Te("ngModelChange",function(r){return De(e),ge().isAllTabs=r}),J(),be(12,"\u5168\u3066\u306e\u30bf\u30d6"),J()(),K(13,"div"),be(14," \u5f62\u5f0f"),K(15,"sup",8),be(16,"*"),J(),be(17,"\uff1a "),K(18,"label")(19,"input",9),Te("ngModelChange",function(r){return De(e),ge().logFormat=r}),J(),be(20,"\u30c6\u30ad\u30b9\u30c8"),J(),K(21,"label")(22,"input",9),Te("ngModelChange",function(r){return De(e),ge().logFormat=r}),J(),be(23,"HTML"),J()(),K(24,"div"),be(25," \u6642\u523b"),K(26,"sup",8),be(27,"*"),J(),be(28,"\uff1a "),K(29,"label")(30,"input",9),Te("ngModelChange",function(r){return De(e),ge().dateFormat=r}),J(),be(31,"\u306a\u3057"),J(),K(32,"label")(33,"input",9),Te("ngModelChange",function(r){return De(e),ge().dateFormat=r}),J(),be(34,"\u6642\uff1a\u5206"),J(),K(35,"label")(36,"input",9),Te("ngModelChange",function(r){return De(e),ge().dateFormat=r}),J(),be(37,"\u65e5\u4ed8\u6642\u523b"),J()()(),it(38,"hr"),K(39,"div",10)(40,"div")(41,"label",11)(42,"input",12),Te("ngModelChange",function(r){return De(e),ge().isWriteOerationLog=r}),J(),be(43,"\u64cd\u4f5c\u30ed\u30b0\u3092\u542b\u3081\u308b"),K(44,"sup",8),be(45,"*"),J()()(),K(46,"div",13)(47,"button",14),Te("click",function(){return De(e),ge().saveLog()}),be(48,"\u30ed\u30b0\u51fa\u529b"),J()()(),Ge()}if(2&n){const e=ge();U(8),Wi("name","",e.panelId,"-log-output-tab"),te("ngModel",e.isAllTabs)("checked",!e.isAllTabs)("value",!1),U(3),Wi("name","",e.panelId,"-log-output-tab"),te("ngModel",e.isAllTabs)("checked",e.isAllTabs)("value",!0),U(8),Wi("name","",e.panelId,"-log-output-format"),te("ngModel",e.logFormat)("checked",0==e.logFormat)("value",0),U(3),Wi("name","",e.panelId,"-log-output-format"),te("ngModel",e.logFormat)("checked",1==e.logFormat)("value",1),U(8),Wi("name","",e.panelId,"-log-output-timestamp-type"),te("ngModel",e.dateFormat)("checked",""==e.dateFormat)("value",""),U(3),Wi("name","",e.panelId,"-log-output-timestamp-type"),te("ngModel",e.dateFormat)("checked","HH:mm"==e.dateFormat)("value","HH:mm"),U(3),Wi("name","",e.panelId,"-log-output-timestamp-type"),te("ngModel",e.dateFormat)("checked","yyyy/MM/dd HH:mm"==e.dateFormat)("value","yyyy/MM/dd HH:mm"),U(6),ct("checked",e.isWriteOerationLog?"checked":""),te("ngModel",e.isWriteOerationLog),U(5),te("disabled",e.isDiable)}}function Jq(n,t){1&n&&(Ve(0),K(1,"div",15),be(2,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002"),J(),Ge())}B([rt()],Zl.prototype,"audioIdentifier",void 0),B([rt()],Zl.prototype,"startTime",void 0),B([rt()],Zl.prototype,"isLoop",void 0),B([rt()],Zl.prototype,"isPlaying",void 0),Zl=B([Xn("jukebox")],Zl);let jI=(()=>{class n{constructor(e,i,r,s){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.saveDataService=s,this.selectedTab=null}get isAllTabs(){return n.isAllTabs}set isAllTabs(e){n.isAllTabs=e}get logFormat(){return n.logFormat}set logFormat(e){n.logFormat=e}get dateFormat(){return n.dateFormat}set dateFormat(e){n.dateFormat=e}get isWriteOerationLog(){return n.isWriteOerationLog}set isWriteOerationLog(e){n.isWriteOerationLog=e}get tabName(){return this.selectedTab.name}set tabName(e){this.selectedTab.name=e}get chatTabs(){return this.chatMessageService.chatTabs}get isEmpty(){return this.chatMessageService.chatTabs.length<1}get isDeleted(){return!!this.selectedTab&&null==lt.instance.get(this.selectedTab.identifier)}get isDiable(){return this.isEmpty||!this.isAllTabs&&(!this.selectedTab||this.isDeleted)}get roomName(){return yt.peerContext&&0<yt.peerContext.roomName.length?yt.peerContext.roomName:"\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf"}ngOnInit(){Promise.resolve().then(()=>{this.modalService.title=this.panelService.title="\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0\u51fa\u529b",this.panelService.isAbleFullScreenButton=!1}),Fe.register(this).on("DELETE_GAME_OBJECT",1e3,e=>{this.selectedTab&&e.data.identifier===this.selectedTab.identifier&&lt.instance.get(e.data.identifier)}),this.panelId=ns.generateUuid()}ngOnDestroy(){Fe.unregister(this)}onChangeSelectTab(e){this.selectedTab=lt.instance.get(e)}saveLog(){this.isDiable||this.saveDataService.saveChatLog(this.logFormat,this.roomName+"_chatLog_"+(this.isAllTabs?"\u5168\u3066\u306e\u30bf\u30d6":this.selectedTab.name),this.isAllTabs?null:this.selectedTab,this.dateFormat,this.isWriteOerationLog)}}return n.isAllTabs=!1,n.logFormat=1,n.dateFormat="HH:mm",n.isWriteOerationLog=!0,n.\u0275fac=function(e){return new(e||n)(Le(kn),Le(In),Le(Er),Le(Ir))},n.\u0275cmp=Zt({type:n,selectors:[["app-chat-log-output"]],decls:7,vars:5,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],["size","10",2,"width","140px",3,"ngModel","disabled","change"],[3,"value",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[3,"value"],[2,"font-weight","bolder","font-size","smaller","padding-top","3px"],[1,"self-only"],["type","radio",3,"name","ngModel","checked","value","ngModelChange"],[2,"width","100%","display","flex"],[2,"font-weight","bolder","font-size","smaller","padding-top","3px","padding-right","1em"],["type","checkbox",3,"ngModel","checked","ngModelChange"],[2,"flex-grow","1","text-align","right"],[2,"font-size","smaller",3,"disabled","click"],[2,"font-size","12px"]],template:function(e,i){1&e&&(K(0,"div",0)(1,"div",1)(2,"select",2),Te("change",function(s){return i.onChangeSelectTab(s.target.value)}),xe(3,Xq,2,2,"option",3),J()(),K(4,"div",4),xe(5,Qq,49,31,"ng-container",5),J()(),xe(6,Jq,3,0,"ng-container",5)),2&e&&(U(2),te("ngModel",null==i.selectedTab?null:i.selectedTab.identifier)("disabled",i.isAllTabs),U(1),te("ngForOf",i.chatTabs),U(2),te("ngIf",!i.isEmpty),U(1),te("ngIf",i.isEmpty))},directives:[es,hi,oi,ei,zr,jr,_n,Aa,fi,Jr],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;font-size:.9em}label[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]{margin-left:.5em}.self-only[_ngcontent-%COMP%]{color:red}.log-sample-text[_ngcontent-%COMP%], .log-sample-html[_ngcontent-%COMP%]{background-color:#fff;font-size:smaller;overflow-y:hidden;width:100%;min-height:1.6em}select[_ngcontent-%COMP%]:disabled   option[_ngcontent-%COMP%]{color:HighlightText;background-color:Highlight}"]}),n})();function eW(n,t){if(1&n&&(K(0,"option",7),be(1),J()),2&n){const e=t.$implicit;Ke("color",""==e.name?"gray":""),ct("value",e.identifier),ct("title",e.name),U(1),qe(""==e.name?"(\u7121\u540d\u306e\u30bf\u30d6)":e.name)}}function tW(n,t){if(1&n&&(K(0,"div",20),be(1),J()),2&n){const e=ge(3);U(1),An("",e.progresPercent,"%")}}const nW=function(n){return{"is-hidden":n}};function iW(n,t){if(1&n){const e=Xe();Ve(0),K(1,"button",12),Te("click",function(){return De(e),ge(2).upTabIndex()}),be(2,"\u2191"),J(),K(3,"button",12),Te("click",function(){return De(e),ge(2).downTabIndex()}),be(4,"\u2193"),J(),K(5,"div",13)(6,"button",12),Te("click",function(){return De(e),ge(2).showLogOutput()}),K(7,"i",14),be(8,"history_edu"),J(),be(9,"\u30ed\u30b0"),J(),K(10,"button",15),Te("click",function(){return De(e),ge(2).save()}),K(11,"div",16)(12,"div",17),be(13,"\u4fdd\u5b58"),J(),xe(14,tW,2,1,"div",18),J()(),K(15,"button",19),Te("click",function(){return De(e),ge(2).delete()}),be(16,"\u524a\u9664"),J()(),Ge()}if(2&n){const e=ge(2);U(10),te("disabled",e.isSaveing),U(2),te("ngClass",ut(4,nW,e.isSaveing)),U(2),te("ngIf",e.isSaveing),U(1),Rt("disabled",e.chatTabs.length<=1?"":null)}}function rW(n,t){if(1&n){const e=Xe();Ve(0),K(1,"button",12),Te("click",function(){return De(e),ge(2).restore()}),be(2,"\u5143\u306b\u623b\u3059"),J(),Ge()}}function sW(n,t){if(1&n){const e=Xe();Ve(0),K(1,"div")(2,"label")(3,"b",8),be(4,"\u30bf\u30d6\u540d: "),J(),K(5,"input",9),Te("ngModelChange",function(r){return De(e),ge().tabName=r}),J()()(),K(6,"div",10)(7,"label")(8,"input",11),Te("ngModelChange",function(r){return De(e),ge().isUseStandImage=r})("change",function(){De(e);const r=ge();return r.isUseStandImage=!!r.isUseStandImage}),J(),be(9," \u30ab\u30c3\u30c8\u30a4\u30f3\u3001\u30b9\u30bf\u30f3\u30c9\u6709\u52b9 "),J()(),K(10,"div",10)(11,"label")(12,"input",11),Te("ngModelChange",function(r){return De(e),ge().recieveOperationLogLevel=r})("change",function(){De(e);const r=ge();return r.recieveOperationLogLevel=r.recieveOperationLogLevel>0?1:0}),J(),be(13," \u64cd\u4f5c\u30ed\u30b0\u3092\u53d7\u4fe1\u3059\u308b "),J()(),it(14,"hr"),K(15,"div"),xe(16,iW,17,6,"ng-container",6),xe(17,rW,3,0,"ng-container",6),J(),Ge()}if(2&n){const e=ge();U(5),te("ngModel",e.tabName),Rt("disabled",e.isEditable?null:""),U(3),ct("checked",e.isUseStandImage?"checked":""),te("ngModel",e.isUseStandImage),Rt("disabled",e.isEditable?null:""),U(4),ct("checked",e.recieveOperationLogLevel>0?"checked":""),te("ngModel",e.recieveOperationLogLevel),Rt("disabled",e.isEditable?null:""),U(4),te("ngIf",!e.isDeleted),U(1),te("ngIf",e.isDeleted)}}function oW(n,t){1&n&&(Ve(0),K(1,"div",21),be(2,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b\u300d\u304b\u3089\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),J(),Ge())}let aW=(()=>{class n{constructor(e,i,r,s,o){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.saveDataService=s,this.pointerDeviceService=o,this.selectedTab=null,this.selectedTabXml="",this.isSaveing=!1,this.progresPercent=0}get tabName(){return this.selectedTab.name}set tabName(e){this.isEditable&&(this.selectedTab.name=e)}get isUseStandImage(){return this.selectedTab.isUseStandImage}set isUseStandImage(e){this.isEditable&&(this.selectedTab.isUseStandImage=e)}get recieveOperationLogLevel(){return this.selectedTab.recieveOperationLogLevel}set recieveOperationLogLevel(e){this.isEditable&&(this.selectedTab.recieveOperationLogLevel=e)}get chatTabs(){return this.chatMessageService.chatTabs}get isEmpty(){return this.chatMessageService.chatTabs.length<1}get isDeleted(){return!!this.selectedTab&&null==lt.instance.get(this.selectedTab.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}get roomName(){return yt.peerContext&&0<yt.peerContext.roomName.length?yt.peerContext.roomName:"\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf"}ngOnInit(){Promise.resolve().then(()=>{this.modalService.title=this.panelService.title="\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u8a2d\u5b9a",this.panelService.isAbleFullScreenButton=!1}),Fe.register(this).on("DELETE_GAME_OBJECT",2e3,e=>{if(!this.selectedTab||e.data.identifier!==this.selectedTab.identifier)return;let i=lt.instance.get(e.data.identifier);null!==i&&(this.selectedTabXml=i.toXml())})}ngOnDestroy(){Fe.unregister(this)}onChangeSelectTab(e){this.selectedTab=lt.instance.get(e),this.selectedTabXml=""}create(){go.instance.addChatTab("\u30bf\u30d6")}save(){var e=this;return(0,en.Z)(function*(){if(!e.selectedTab||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i="fly_chat_"+e.selectedTab.name;yield e.saveDataService.saveGameObjectAsync(e.selectedTab,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}delete(){!this.isEmpty&&this.selectedTab&&(this.selectedTabXml=this.selectedTab.toXml(),this.selectedTab.destroy())}restore(){if(this.selectedTab&&this.selectedTabXml){let e=Zn.instance.parseXml(this.selectedTabXml);go.instance.addChatTab(e),this.selectedTabXml=""}}upTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,i=e.children.indexOf(this.selectedTab);0<i&&e.insertBefore(this.selectedTab,e.children[i-1])}downTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,i=e.children.indexOf(this.selectedTab);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.selectedTab)}showLogOutput(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(jI,{left:e.x-250,top:e.y-175,width:450,height:300}).selectedTab=this.selectedTab}}return n.\u0275fac=function(e){return new(e||n)(Le(kn),Le(In),Le(Er),Le(Ir),Le(ai))},n.\u0275cmp=Zt({type:n,selectors:[["app-chat-tab-setting"]],decls:10,vars:4,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[2,"font-size","smaller","margin-bottom","2px",3,"click"],["size","10",2,"width","100%","max-width","140px",3,"ngModel","change"],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[3,"value","title"],[2,"font-size","smaller"],["placeholder","Name",2,"width","200px",3,"ngModel","ngModelChange"],[2,"font-weight","bolder","font-size","smaller","padding-top","3px"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[3,"click"],[2,"float","right"],[1,"material-icons","small-font"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,i){1&e&&(K(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Te("click",function(){return i.create()}),be(4,"\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b"),J()(),K(5,"select",3),Te("change",function(s){return i.onChangeSelectTab(s.target.value)}),xe(6,eW,2,5,"option",4),J()(),K(7,"div",5),xe(8,sW,18,10,"ng-container",6),J()(),xe(9,oW,3,0,"ng-container",6)),2&e&&(U(5),te("ngModel",null==i.selectedTab?null:i.selectedTab.identifier),U(1),te("ngForOf",i.chatTabs),U(2),te("ngIf",!i.isEmpty&&i.selectedTab),U(1),te("ngIf",i.isEmpty))},directives:[es,hi,oi,ei,zr,jr,_n,fi,Jr,Wn],styles:["[_nghost-%COMP%]{display:block}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;font-size:.9em}.small-font[_ngcontent-%COMP%]{font-size:16px;vertical-align:middle}"]}),n})();const lW=["edit"];function cW(n,t){1&n&&pn(0)}function uW(n,t){if(1&n&&(Ve(0),xe(1,cW,1,0,"ng-container",11),Ge()),2&n){ge();const e=Wt(11);U(1),te("ngTemplateOutlet",e)}}function dW(n,t){1&n&&pn(0)}function fW(n,t){if(1&n&&(Ve(0),xe(1,dW,1,0,"ng-container",11),Ge()),2&n){ge();const e=Wt(13);U(1),te("ngTemplateOutlet",e)}}function hW(n,t){1&n&&pn(0)}function pW(n,t){1&n&&pn(0)}function gW(n,t){if(1&n&&(K(0,"div"),xe(1,pW,1,0,"ng-container",11),J()),2&n){ge();const e=Wt(19);U(1),te("ngTemplateOutlet",e)}}function mW(n,t){1&n&&pn(0)}function _W(n,t){if(1&n&&(Ve(0),xe(1,mW,1,0,"ng-container",11),Ge()),2&n){ge();const e=Wt(13);U(1),te("ngTemplateOutlet",e)}}function $W(n,t){1&n&&pn(0)}function vW(n,t){if(1&n&&(Ve(0),xe(1,$W,1,0,"ng-container",11),Ge()),2&n){ge();const e=Wt(11);U(1),te("ngTemplateOutlet",e)}}const bW=function(n,t){return{"black-paint":n,"face-icon":t}};function yW(n,t){if(1&n&&(it(0,"img",15),Ct(1,"safe")),2&n){const e=ge(2);te("src",xt(1,2,null==e.imageFile?null:e.imageFile.url,"resourceUrl"),Jt)("ngClass",Kt(5,bW,1==e.chatMessage.isBlackPaint,e.chatMessage.isFaceIcon))}}const CW=function(n,t){return{inverse:n,hollow:t}},xW=function(n,t,e,i,r,s,o,c){return{black:n,blue:t,green:e,cyan:i,red:r,magenta:s,yellow:o,white:c}};function wW(n,t){if(1&n&&(K(0,"div",12)(1,"span",13),xe(2,yW,2,8,"img",14),J()()),2&n){const e=ge();te("ngClass",Kt(3,CW,1==e.chatMessage.isInverseIcon,1==e.chatMessage.isHollowIcon)),U(1),te("ngClass",ao(6,xW,0==e.chatMessage.aura,1==e.chatMessage.aura,2==e.chatMessage.aura,3==e.chatMessage.aura,4==e.chatMessage.aura,5==e.chatMessage.aura,6==e.chatMessage.aura,7==e.chatMessage.aura)),U(1),te("ngIf",0<(null==e.imageFile||null==e.imageFile.url?null:e.imageFile.url.length))}}function EW(n,t){if(1&n&&(Ve(0),K(1,"span",19),be(2),Ct(3,"date"),J(),Ge()),2&n){const e=ge(2);U(2),qe(xt(3,1,e.chatMessage.timestamp,"H:mm"))}}function TW(n,t){if(1&n&&(it(0,"img",22),Ct(1,"safe")),2&n){const e=ge(3);te("src",xt(1,1,null==e.toImageFile?null:e.toImageFile.url,"resourceUrl"),Jt)}}const $1=function(n){return{grow:n}};function IW(n,t){if(1&n&&(Ve(0),xe(1,TW,2,4,"img",20),K(2,"span",18),be(3),J(),K(4,"span",21),be(5,"\u27a1"),J(),Ge()),2&n){const e=ge(2);U(1),te("ngIf",0<(null==e.toImageFile||null==e.toImageFile.url?null:e.toImageFile.url.length)),U(1),Ke("color",e.chatMessage.toColor&&"#ffffff"!=e.chatMessage.toColor?e.chatMessage.toColor:""),te("ngClass",ut(5,$1,e.chatMessage.isDirect||e.chatMessage.isSecret)),U(1),qe(e.chatMessage.toName)}}function SW(n,t){if(1&n&&(it(0,"img",22),Ct(1,"safe")),2&n){const e=ge(3);te("src",xt(1,1,null==e.toImageFile?null:e.toImageFile.url,"resourceUrl"),Jt)}}function MW(n,t){if(1&n&&(Ve(0),K(1,"span",23),be(2,"\u27a1"),J(),xe(3,SW,2,4,"img",20),K(4,"span",18),be(5),J(),Ge()),2&n){const e=ge(2);U(3),te("ngIf",0<(null==e.toImageFile||null==e.toImageFile.url?null:e.toImageFile.url.length)),U(1),Ke("color",e.chatMessage.toColor&&"#ffffff"!=e.chatMessage.toColor?e.chatMessage.toColor:""),te("ngClass",ut(5,$1,e.chatMessage.isDirect||e.chatMessage.isSecret)),U(1),qe(e.chatMessage.toName)}}function kW(n,t){if(1&n){const e=Xe();K(0,"span",27),Te("click",function(r){return De(e),ge(3).onLinkClick(r)}),Ct(1,"safe"),J()}2&n&&te("innerHTML",xt(1,1,ge(3).htmlEscapedFrom,"html"),qi)}function DW(n,t){if(1&n&&(K(0,"span",19),be(1),Ct(2,"date"),J()),2&n){const e=ge(3);U(1),qe(xt(2,1,e.chatMessage.timestamp,"y/M/d H:mm"))}}function AW(n,t){if(1&n&&(K(0,"span",19),be(1),Ct(2,"date"),J()),2&n){const e=ge(3);U(1),qe(xt(2,1,e.chatMessage.timestamp,"H:mm"))}}function PW(n,t){1&n&&pn(0)}function NW(n,t){if(1&n&&(Ve(0),xe(1,kW,2,4,"span",24),xe(2,DW,3,4,"span",25),xe(3,AW,3,4,"span",25),xe(4,PW,1,0,"ng-container",26),Ge()),2&n){const e=ge(2),i=Wt(19);U(1),te("ngIf",!e.isCompact),U(1),te("ngIf",!e.isCompact&&e.chatMessage.timestamp),U(1),te("ngIf",e.isCompact&&e.chatMessage.timestamp),U(1),te("ngIf",!(e.isEditable&&!e.isCompact))("ngIfElse",i)}}function FW(n,t){if(1&n&&(K(0,"div",16),xe(1,EW,4,4,"ng-container",2),K(2,"span",17),xe(3,IW,6,7,"ng-container",2),K(4,"span",18),be(5),J(),xe(6,MW,6,7,"ng-container",2),J(),xe(7,NW,5,5,"ng-container",2),J()),2&n){const e=ge();U(1),te("ngIf",e.isCompact&&!e.isMine&&e.chatMessage.timestamp),U(2),te("ngIf",!e.isMine&&e.chatMessage.toColor),U(1),Ke("color",e.chatMessage.color&&"#ffffff"!=e.chatMessage.color?e.chatMessage.color:""),te("ngClass",ut(8,$1,e.chatMessage.isDirect||e.chatMessage.isSecret)),U(1),qe(e.chatMessage.name),U(1),te("ngIf",e.isMine&&e.chatMessage.toColor),U(1),te("ngIf",!e.isCompact||e.isMine)}}function OW(n,t){if(1&n){const e=Xe();K(0,"div",33)(1,"span",34),be(2),J(),K(3,"textarea",35,36),Te("ngModelChange",function(r){return De(e),ge(2).editingText=r})("keydown.enter",function(r){return De(e),ge(2).editEnd(r)})("keydown.escape",function(){return De(e),ge(2).editCancel()}),J()()}if(2&n){const e=ge(2);U(2),qe(e.lastNewLineAdjust(e.editingText)),U(1),te("ngModel",e.editingText)}}function RW(n,t){if(1&n&&(K(0,"span",37)(1,"b",38),be(2,"\u7de8\u96c6\u6e08"),J(),be(3),Ct(4,"date"),J()),2&n){const e=ge(2);U(3),An(" ",xt(4,1,e.chatMessage.lastUpdate,"M/d H:mm"),"")}}function BW(n,t){if(1&n){const e=Xe();K(0,"button",39),Te("click",function(){return De(e),ge(2).discloseMessage()}),be(1,"\u7d50\u679c\u3092\u516c\u958b"),J()}}function LW(n,t){if(1&n){const e=Xe();xe(0,OW,5,2,"div",28),K(1,"div")(2,"span",29)(3,"span",30),Te("click",function(r){return De(e),ge().onLinkClick(r)}),Ct(4,"safe"),J(),xe(5,RW,5,4,"span",31),xe(6,BW,2,0,"button",32),J()()}if(2&n){const e=ge();te("ngIf",e.isEditing),U(1),Ke("display",e.isEditing?"none":"block"),U(2),Ke("color",!e.chatMessage.isSpecialColor&&e.chatMessage.color&&"#ffffff"!=e.chatMessage.color?e.chatMessage.color:""),te("innerHTML",xt(4,8,e.htmlEscapedText,"html"),qi),U(2),te("ngIf",!e.isEditing&&e.chatMessage.isEdited),U(1),te("ngIf",e.chatMessage.isSecret)}}function zW(n,t){1&n&&(K(0,"span")(1,"s"),be(2,"\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09"),J()())}function jW(n,t){if(1&n){const e=Xe();K(0,"button",45),Te("click",function(){return De(e),ge(2).editStart()}),K(1,"i",46),be(2,"edit"),J()()}}function HW(n,t){1&n&&(K(0,"button",47)(1,"i",46),be(2,"clear"),J()())}function UW(n,t){if(1&n){const e=Xe();K(0,"button",48),Te("click",function(){return De(e),ge(2).editEnd()}),K(1,"i",46),be(2,"done"),J()()}2&n&&te("disabled",0==ge(2).editingText.trim().length)}function VW(n,t){if(1&n){const e=Xe();K(0,"button",49),Te("click",function(){return De(e),ge(2).editCancel()}),K(1,"i",46),be(2,"clear"),J()()}}function GW(n,t){if(1&n&&(K(0,"span",40),xe(1,jW,3,0,"button",41),xe(2,HW,3,0,"button",42),xe(3,UW,3,1,"button",43),xe(4,VW,3,0,"button",44),J()),2&n){const e=ge();Ke("visibility",e.isEditing?"visible":""),U(1),te("ngIf",!e.isEditing),U(1),te("ngIf",!e.isEditing),U(1),te("ngIf",e.isEditing),U(1),te("ngIf",e.isEditing)}}const qW=function(n,t){return{compact:n,editing:t}},WW=function(n,t,e,i,r,s){return{"is-mine":n,"is-others":t,"direct-message":e,"system-message":i,"dicebot-message":r,"operation-log":s}},KW=function(n,t,e,i){return{"is-success":n,"is-failure":t,"is-critical":e,"is-fumble":i}};let YW=(()=>{class n{constructor(e,i,r){this.chatMessageService=e,this.modalService=i,this.changeDetector=r,this.compact=!1,this.imageFile=Ht.Empty,this.animeState="inactive",this.isEditing=!1,this.editingText="",this.stringUtil=et}ngOnInit(){Fe.register(this).on("MESSAGE_EDITING_START",-1e3,r=>{r.isSendFromSelf&&(!r.data||r.data.messageIdentifier!==this.chatMessage.identifier)&&this.editCancel()}).on("CHANGE_GM_MODE",r=>{this.changeDetector.markForCheck()});let e=this.chatMessage.image;e&&(this.imageFile=e),e=this.chatMessage.toImage,e&&(this.toImageFile=e),this.chatMessageService.getTime()-1e4<this.chatMessage.timestamp&&(this.animeState="active")}ngAfterViewInit(){this.chatMessage.isAnimated=!0}get isMine(){return this.chatMessage.isSendFromSelf}get isEditable(){return this.chatMessage.isEditable}get isCompact(){return this.compact||this.chatMessage.isOperationLog}get htmlEscapedFrom(){return this._htmlEscapeLinking(this.chatMessage.from,!0)}get htmlEscapedText(){let e=this._htmlEscapeLinking(this.chatMessage.text,!1,!this.chatMessage.isOperationLog);return this.chatMessage.isDicebot&&(e=Kn.decorationDiceResult(e)),e}_htmlEscapeLinking(e,i=!1,r=!1){return e=et.escapeHtml(e),r&&(e=et.rubyToHtml(e)),X0.link(this.lastNewLineAdjust(e),{urls:{schemeMatches:!0,wwwMatches:!0,tldMatches:!1},truncate:{length:48,location:"end"},decodePercentEncoding:i,stripPrefix:i,stripTrailingSlash:i,email:!1,phone:!1,replaceFn:function(s){if("url"==s.getType()&&et.validUrl(s.getAnchorHref())){if(et.sameOrigin(s.getAnchorHref()))return!0;{const o=s.buildTag();return o.setAttr("rel","nofollow"),o.addClass("outer-link"),o}}return!1}})}discloseMessage(){this.chatMessage.tag=this.chatMessage.tag.replace("secret","")}editStart(){Fe.trigger("MESSAGE_EDITING_START",{messageIdentifier:this.chatMessage.identifier}),this.editingText=this.chatMessage.text,this.isEditing=!0,setTimeout(()=>{this.editElm.nativeElement&&this.editElm.nativeElement.focus()})}editEnd(e=null){e&&e.preventDefault(),(!e||13===e.keyCode)&&(this.isEditable&&this.editingText.trim().length>0&&this.chatMessage.text!=this.editingText?(this.chatMessage.isSecret||(this.chatMessage.lastUpdate=Date.now()),this.chatMessage.text=this.editingText,this.isEditing=!1):this.editCancel())}editCancel(){this.isEditing=!1}lastNewLineAdjust(e){return null==e?"":!this.isEditing&&(this.chatMessage.isEdited||this.chatMessage.isSecret)||e.lastIndexOf("\n")!=e.length-1?e:e+"\n"}onLinkClick(e){if(e&&"A"==e.target.tagName){const i=e.target.getAttribute("href");if(!et.sameOrigin(i))return e.preventDefault(),this.modalService.open(Hr,{url:e.target.getAttribute("href")}),!1}return!0}}return n.\u0275fac=function(e){return new(e||n)(Le(Er),Le(kn),Le(Di))},n.\u0275cmp=Zt({type:n,selectors:[["chat-message"]],viewQuery:function(e,i){if(1&e&&on(lW,5),2&e){let r;sn(r=an())&&(i.editElm=r.first)}},inputs:{chatMessage:"chatMessage",compact:"compact"},features:[ui([{provide:Dx,useValue:!1}])],decls:20,vars:36,consts:[[1,"container",3,"ngClass"],[1,"message",3,"ngClass"],[4,"ngIf"],[1,"body"],[1,"text","msg-text",3,"ngClass"],[4,"ngIf","ngIfThen","ngIfElse"],["image",""],["title",""],["visible",""],["secret",""],["editor",""],[4,"ngTemplateOutlet"],[1,"image",3,"ngClass"],[1,"aura",3,"ngClass"],["draggable","false",3,"src","ngClass",4,"ngIf"],["draggable","false",3,"src","ngClass"],[1,"title"],[1,"msg-name"],[3,"ngClass"],[1,"tip","msg-timestamp"],["draggable","false","class","mini-icon",3,"src",4,"ngIf"],[2,"display","inline-block","margin","0px 6px","user-select","none","transform","rotateY(180deg)"],["draggable","false",1,"mini-icon",3,"src"],[2,"display","inline-block","margin","0px 6px","user-select","none"],["class","tip msg-from",3,"innerHTML","click",4,"ngIf"],["class","tip msg-timestamp",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"tip","msg-from",3,"innerHTML","click"],["style","position: relative",4,"ngIf"],[2,"display","inline-block"],[3,"innerHTML","click"],["class","is-edited",4,"ngIf"],["style","padding-top: 1px; padding-bottom: 1px; margin-left: 3px;",3,"click",4,"ngIf"],[2,"position","relative"],["aria-hidden","true",2,"visibility","hidden","display","inline-block"],[2,"position","absolute","top","0px","left","0px","width","100%","height","100%",3,"ngModel","ngModelChange","keydown.enter","keydown.escape"],["edit",""],[1,"is-edited"],[2,"white-space","nowrap"],[2,"padding-top","1px","padding-bottom","1px","margin-left","3px",3,"click"],[1,"edit-buttons",2,"margin-left","4px","white-space","nowrap"],["class","edit-button","title","\u7de8\u96c6",3,"click",4,"ngIf"],["class","edit-button","aria-hidden","true","style","visibility: hidden",4,"ngIf"],["class","edit-button","title","\u78ba\u5b9a",3,"disabled","click",4,"ngIf"],["class","edit-button","title","\u30ad\u30e3\u30f3\u30bb\u30eb",3,"click",4,"ngIf"],["title","\u7de8\u96c6",1,"edit-button",3,"click"],[1,"material-icons","small-font"],["aria-hidden","true",1,"edit-button",2,"visibility","hidden"],["title","\u78ba\u5b9a",1,"edit-button",3,"disabled","click"],["title","\u30ad\u30e3\u30f3\u30bb\u30eb",1,"edit-button",3,"click"]],template:function(e,i){if(1&e&&(K(0,"div",0)(1,"div",1),xe(2,uW,2,1,"ng-container",2),K(3,"div",3),xe(4,fW,2,1,"ng-container",2),K(5,"div",4),xe(6,hW,1,0,"ng-container",5),J(),xe(7,gW,2,1,"div",2),xe(8,_W,2,1,"ng-container",2),J(),xe(9,vW,2,1,"ng-container",2),J()(),xe(10,wW,3,15,"ng-template",null,6,Ln),xe(12,FW,8,10,"ng-template",null,7,Ln),xe(14,LW,7,11,"ng-template",null,8,Ln),xe(16,zW,3,0,"ng-template",null,9,Ln),xe(18,GW,5,6,"ng-template",null,10,Ln)),2&e){const r=Wt(15),s=Wt(17);te("ngClass",Kt(21,qW,i.isCompact,i.isEditing)),U(1),Ke("border-left-color",!i.chatMessage.isSystem||i.chatMessage.isDicebot||i.chatMessage.isCalculate?i.chatMessage.color:"#444444")("border-right-color",!i.chatMessage.isSystem||i.chatMessage.isDicebot||i.chatMessage.isCalculate?i.chatMessage.color:"#444444"),te("ngClass",I_(24,WW,i.isMine,!i.isMine,i.chatMessage.isDirect||i.chatMessage.isSecret,i.chatMessage.isSystem,i.chatMessage.isDicebot||i.chatMessage.isCalculate,i.chatMessage.isOperationLog))("@flyInOut",i.isMine?null:"active")("@flyInOutMe",i.isMine?"active":null),U(1),te("ngIf",i.isMine&&!i.isCompact),U(1),Ke("justify-content",i.isCompact&&!i.isMine?"flex-end":"flex-start"),U(1),te("ngIf",!i.isCompact||i.isMine),U(1),Ke("flex-grow",i.isCompact&&!i.isEditing?0:1),te("ngClass",oo(31,KW,(!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf)&&i.chatMessage.isSuccess,(!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf)&&i.chatMessage.isFailure,(!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf)&&i.chatMessage.isCritical,(!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf)&&i.chatMessage.isFumble)),U(1),te("ngIf",!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf||i.chatMessage.isGMMode)("ngIfThen",r)("ngIfElse",s),U(1),te("ngIf",i.isEditable&&i.isCompact),U(1),te("ngIf",i.isCompact&&!i.isMine),U(1),te("ngIf",!i.isMine&&!i.isCompact)}},directives:[Wn,_n,wl,fi,hi,oi],pipes:[ti,lx],styles:['[_nghost-%COMP%]{display:block}.container[_ngcontent-%COMP%]{width:100%;overflow-x:hidden;box-sizing:border-box}.message[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;box-sizing:border-box;padding:5px;width:100%;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;border-bottom:1px dotted #999}.is-mine.message[_ngcontent-%COMP%]{border-left:4px solid #555}.is-others.message[_ngcontent-%COMP%]{border-right:4px solid #555}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc;border-bottom:1px dotted #CCC}.is-mine.direct-message[_ngcontent-%COMP%]{border-left:4px solid #555}.is-others.direct-message[_ngcontent-%COMP%]{border-right:4px solid #555}.operation-log[_ngcontent-%COMP%]{color:#666;background-color:#cccc}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{padding:0;width:50px;height:50px;flex-shrink:0;vertical-align:top;pointer-events:none}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img.face-icon[_ngcontent-%COMP%]{border-radius:.5rem}.message[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{flex-grow:1}.message[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{vertical-align:top;font-size:14px;padding-left:12px;padding-right:12px}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.message[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{vertical-align:top;padding:2px 12px 0;font-size:14px}.message[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{font-size:8px;padding-left:12px}.msg-name[_ngcontent-%COMP%]{font-weight:700}.msg-text[_ngcontent-%COMP%]{white-space:pre-wrap}.dicebot-message[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%]{font-size:8px}.dicebot-message[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{color:#11f}.direct-message.dicebot-message[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{color:#ccf}.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-success[_ngcontent-%COMP%]{color:#17f}.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-failure[_ngcontent-%COMP%]{color:#f05}.direct-message.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-success[_ngcontent-%COMP%]{color:#adf}.direct-message.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-failure[_ngcontent-%COMP%]{color:#f66}.dicebot-message[_ngcontent-%COMP%]{border-left:4px transparent}.dicebot-message[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%], .dicebot-message[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%], .operation-log[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%], .operation-log[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{font-style:oblique}.is-others[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .is-others[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{text-align:right}.is-others[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-align:left;max-width:100%}.is-edited[_ngcontent-%COMP%]{margin-left:2px;font-size:8px;vertical-align:bottom}.is-edited[_ngcontent-%COMP%]:before{content:"("}.is-edited[_ngcontent-%COMP%]:after{content:")"}.edit-button[_ngcontent-%COMP%]{padding:0 6px;vertical-align:10%;margin:0 1px 0 0}.edit-buttons[_ngcontent-%COMP%]{visibility:hidden}.container[_ngcontent-%COMP%]:hover   .edit-buttons[_ngcontent-%COMP%]{visibility:visible}textarea[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,"M+ 1p",sans-serif;margin:-3px;font-size:14px;resize:none}.small-font[_ngcontent-%COMP%]{font-size:14px;vertical-align:bottom}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #00f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 6px #ccc) drop-shadow(0 -4px 4px #fff)}.msg-timestamp[_ngcontent-%COMP%]{white-space:nowrap}.container.compact[_ngcontent-%COMP%]{overflow:hidden}.container.compact.editing[_ngcontent-%COMP%]{padding-top:1px}.container.compact[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{padding:2px!important}.container.compact[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap}.container.compact[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{min-width:6em}.container.compact[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .container.compact[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .container.compact[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{padding:0 3px;text-align:left}.container.compact[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%]{flex-grow:0}.container.compact[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{flex-grow:1}.container.compact[_ngcontent-%COMP%]   .edit-buttons[_ngcontent-%COMP%]{display:none}.container.compact[_ngcontent-%COMP%]:hover   .edit-buttons[_ngcontent-%COMP%], .container.compact.editing[_ngcontent-%COMP%]   .edit-buttons[_ngcontent-%COMP%]{display:inline-block}.container.compact[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{margin:-3px}.grow[_ngcontent-%COMP%]{text-shadow:1px 0px 1px #ffffff,0px 1px 1px #ffffff,-1px 0px 1px #ffffff,0px -1px 1px #ffffff}.mini-icon[_ngcontent-%COMP%]{display:inline-block;padding:0;width:1rem;height:1rem;vertical-align:middle;border-radius:.2rem;-o-object-fit:cover;object-fit:cover;margin-right:2px;filter:drop-shadow(1px 1px 1px #ffffff) drop-shadow(-1px -1px 1px #ffffff)}'],data:{animation:[xn("flyInOut",[Bt("* => active",[Ft("200ms ease-out",nn([Ye({transform:"translateX(100px)",opacity:"0",offset:0}),Ye({transform:"translateX(0)",opacity:"1",offset:1})]))]),Bt("void => *",[Ft("200ms ease-out",nn([Ye({opacity:"0",offset:0}),Ye({opacity:"1",offset:1})]))])]),xn("flyInOutMe",[Bt("* => active",[Ft("200ms ease-out",nn([Ye({transform:"translateX(-100px)",opacity:"0",offset:0}),Ye({transform:"translateX(0)",opacity:"1",offset:1})]))]),Bt("void => *",[Ft("200ms ease-out",nn([Ye({opacity:"0",offset:0}),Ye({opacity:"1",offset:1})]))])])]}}),n})();const ZW=["logContainer"],XW=["messageContainer"];function QW(n,t){if(1&n&&it(0,"chat-message",7),2&n){const e=ge().$implicit,i=ge(2);te("chatMessage",e)("compact",i.compact)("@.disabled",i.compact||e.isAnimated)}}function JW(n,t){if(1&n&&(Ve(0),xe(1,QW,1,3,"chat-message",6),Ge()),2&n){const e=t.$implicit;U(1),te("ngIf",e.isDisplayable)}}function eK(n,t){if(1&n&&(Ve(0),xe(1,JW,2,1,"ng-container",5),Ge()),2&n){const e=ge();U(1),te("ngForOf",e.chatMessages)("ngForTrackBy",e.trackByChatMessage)}}function tK(n,t){if(1&n&&it(0,"chat-message",7),2&n){const e=t.$implicit,i=ge(2);te("chatMessage",e)("compact",i.compact)("@.disabled",i.compact||e.isAnimated)}}function nK(n,t){if(1&n&&(Ve(0),xe(1,tK,1,3,"chat-message",8),Ge()),2&n){const e=ge();U(1),te("ngForOf",e.sampleMessages)}}const v1=window.navigator.userAgent.toLowerCase(),HI=v1.indexOf("iphone")>-1||v1.indexOf("ipad")>-1||v1.indexOf("macintosh")>-1&&"ontouchend"in document;let iK=(()=>{class n{constructor(e,i,r){this.ngZone=e,this.changeDetector=i,this.panelService=r,this.compact=!1,this.sampleMessages=[{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",tag:"mine",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u30b5\u30fc\u30d0\u30fc\u3092\u4f7f\u7528\u3057\u306a\u3044TRPG\u30aa\u30f3\u30bb\u30c4\u30fc\u30eb\u3067\u3059\u3002\u53c2\u52a0\u8005\u540c\u58eb\u3067\u63a5\u7d9a\u3057\u3001\u30b3\u30de\u3084\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u306a\u3069\u3092\u540c\u671f\u3057\u307e\u3059\u3002"},{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",tag:"mine",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u5168\u3066\u306e\u30c7\u30fc\u30bf\u304c\u5404\u53c2\u52a0\u8005\u306e\u30d6\u30e9\u30a6\u30b6\u5185\u306b\u3042\u308b\u305f\u3081\u3001\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3092\u5b9f\u884c\u3057\u3066\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u3092\u751f\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u4fdd\u5b58\u3057\u305fzip\u306e\u8aad\u307f\u8fbc\u307f\u306f\u30d6\u30e9\u30a6\u30b6\u753b\u9762\u3078\u306e\u30d5\u30a1\u30a4\u30eb\u30c9\u30ed\u30c3\u30d7\u3067\u884c\u3048\u307e\u3059\u3002"},{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",toColor:"#444444",tag:"mine direct",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",toName:"\u30d7\u30ec\u30a4\u30e4\u30fc",text:"\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\uff08\u79d8\u5bc6\u4f1a\u8a71\uff09\u306f\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\u306b\u8a18\u9332\u3055\u308c\u307e\u305b\u3093\u3002"},{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",toColor:"#444444",tag:"mine direct",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",toName:"\u30d7\u30ec\u30a4\u30e4\u30fc",text:"\u307e\u305f\u3001\u904e\u53bb\u306e\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u3042\u306a\u305f\u306eID\u304c\u66f4\u65b0\u3055\u308c\u308b\u3068\u540c\u3058\u30eb\u30fc\u30e0\u5185\u3067\u3042\u3063\u3066\u3082\u898b\u3048\u306a\u304f\u306a\u308a\u307e\u3059\u3002\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002"},{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",tag:"mine",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u52d5\u4f5c\u63a8\u5968\u74b0\u5883\u306f\u30c7\u30b9\u30af\u30c8\u30c3\u30d7Chrome\u3067\u3059\u3002\u4eca\u306e\u3068\u3053\u308d\u3001\u30b9\u30de\u30db\u304b\u3089\u3060\u3068\u4e0a\u624b\u304f\u64cd\u4f5c\u3067\u304d\u307e\u305b\u3093\u3002"},{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",tag:"mine",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u4ee5\u4e0a\u3067\u3059\u3002\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u6700\u521d\u306e\u30c1\u30e3\u30c3\u30c8\u3092\u5165\u529b\u3059\u308b\u3068\u975e\u8868\u793a\u306b\u306a\u308a\u307e\u3059\u3002"}],this.topTimestamp=0,this.botomTimestamp=0,this.needUpdate=!0,this.topElm=null,this.bottomElm=null,this.topElmBox=null,this.bottomElmBox=null,this.topIndex=0,this.bottomIndex=0,this.preScrollTop=0,this.scrollSpeed=0,this._chatMessages=[],this.scrollEventShortTimer=null,this.scrollEventLongTimer=null,this.addMessageEventTimer=null,this.callbackOnScroll=()=>this.onScroll(),this.callbackOnScrollToBottom=()=>this.resetMessages(),this.onAddMessage=new Cn}get minMessageHeight(){if(this.compact)return 26;let e=this.chatTab.chatMessages[this.chatTab.chatMessages.length-1];return e&&e.isOperationLog?26:61}get chatMessages(){if(!this.chatTab)return[];if(this.needUpdate){this.needUpdate=!1;let e=this.chatTab?this.chatTab.chatMessages:[];this.adjustIndex(),this._chatMessages=e.slice(this.topIndex,this.bottomIndex+1),this.topTimestamp=0<this._chatMessages.length?this._chatMessages[0].timestamp:0,this.botomTimestamp=0<this._chatMessages.length?this._chatMessages[this._chatMessages.length-1].timestamp:0}return this._chatMessages}get minScrollHeight(){return this.chatTab.chatMessages.reduce((i,r)=>i+(r.isDisplayable?this.compact||r.isOperationLog?26:61:0),0)}get topSpace(){return this.minScrollHeight-this.bottomSpace}get bottomSpace(){return 0<this.chatMessages.length?(this.chatTab.chatMessages.length-this.bottomIndex-1)*this.minMessageHeight:0}get isEmpty(){return this.chatTab.chatMessages.every(e=>!e.isDisplayable)}ngOnInit(){let e=[];for(let i of this.sampleMessages){let r=new Kn;for(let s in i)if("identifier"!==s&&"tabIdentifier"!==s){if("text"===s){r.value=i[s];continue}null==i[s]||""===i[s]||r.setAttribute(s,i[s])}e.push(r)}this.sampleMessages=e,Fe.register(this).on("MESSAGE_ADDED",i=>{let r=lt.instance.get(i.data.messageIdentifier);!r||!this.chatTab.contains(r)||this.topTimestamp<=r.timestamp&&(this.changeDetector.markForCheck(),this.needUpdate=!0,this.onMessageInit())}).on("UPDATE_GAME_OBJECT",i=>{let r=lt.instance.get(i.data.identifier);r&&r instanceof Kn&&this.topTimestamp<=r.timestamp&&r.timestamp<=this.botomTimestamp&&this.chatTab.contains(r)&&this.changeDetector.markForCheck()})}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.scrollEventShortTimer=new la(()=>this.lazyScrollUpdate(),33),this.scrollEventLongTimer=new la(()=>this.lazyScrollUpdate(!1),66),this.onScroll(),this.panelService.scrollablePanel.addEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.addEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1)})}ngOnDestroy(){Fe.unregister(this),this.panelService.scrollablePanel.removeEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.removeEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1),this.scrollEventShortTimer.clear(),this.scrollEventLongTimer.clear(),this.addMessageEventTimer&&clearTimeout(this.addMessageEventTimer),this.addMessageEventTimer=null}ngOnChanges(){Promise.resolve().then(()=>this.resetMessages())}ngAfterViewChecked(){!this.topElm||!this.bottomElm||this.ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>this.adjustScrollPosition())})}onMessageInit(){null==this.addMessageEventTimer&&this.ngZone.runOutsideAngular(()=>{this.addMessageEventTimer=setTimeout(()=>{this.addMessageEventTimer=null,this.ngZone.run(()=>this.onAddMessage.emit())},0)})}resetMessages(){let e=this.chatTab.chatMessages.length-1;this.topIndex=e-Math.floor(this.panelService.scrollablePanel.clientHeight/this.minMessageHeight),this.bottomIndex=e,this.needUpdate=!0,this.preScrollTop=-1,this.scrollSpeed=0,this.topElm=this.bottomElm=null,this.adjustIndex(),this.changeDetector.markForCheck()}trackByChatMessage(e,i){return i.identifier}adjustIndex(){let e=this.chatTab?this.chatTab.chatMessages:[],i=0<e.length?e.length-1:0;this.topIndex<0&&(this.topIndex=0),i<this.bottomIndex&&(this.bottomIndex=i),this.topIndex<0&&(this.topIndex=0),this.bottomIndex<0&&(this.bottomIndex=0),i<this.topIndex&&(this.topIndex=i),i<this.bottomIndex&&(this.bottomIndex=i)}getScrollPosition(){let e=this.panelService.scrollablePanel.scrollTop,i=this.panelService.scrollablePanel.clientHeight,r=this.panelService.scrollablePanel.scrollHeight;return e<0&&(e=0),r-i<e&&(e=r-i),{top:e,bottom:e+i,clientHeight:i,scrollHeight:r}}adjustScrollPosition(){if(!this.topElm||!this.bottomElm)return;let e=this.logContainerRef.nativeElement.contains(this.topElm),i=this.logContainerRef.nativeElement.contains(this.bottomElm),{hasTopBlank:r,hasBotomBlank:s}=this.checkBlank(e,i);this.topElm=this.bottomElm=null,(r||s||!e&&!i)&&xr(()=>this.lazyScrollUpdate())}checkBlank(e,i){let r=!e,s=!i;if(!e&&!i)return{hasTopBlank:r,hasBotomBlank:s};let o=null,c=null,m=null,I=0;i?(o=this.bottomElm,c=this.bottomElmBox):e&&(o=this.topElm,c=this.topElmBox),m=o.getBoundingClientRect(),I=c.top-m.top-this.scrollSpeed,(!r||!s)&&.25<I**2&&(this.panelService.scrollablePanel.scrollTop-=I);let Z=this.logContainerRef.nativeElement.getBoundingClientRect(),fe=this.messageContainerRef.nativeElement.getBoundingClientRect(),pe=fe.top-Z.top,ye=pe+fe.height,we=this.getScrollPosition();return r=we.top<pe,s=ye<we.bottom&&we.bottom<we.scrollHeight,{hasTopBlank:r,hasBotomBlank:s}}markForReadIfNeeded(){if(!this.chatTab.hasUnread)return;let e=this.getScrollPosition();e.scrollHeight<=e.bottom+100&&xr(()=>{this.chatTab.markForRead(),this.changeDetector.markForCheck(),this.ngZone.run(()=>{})})}onScroll(){this.scrollEventShortTimer.reset(),this.scrollEventLongTimer.isActive||this.scrollEventLongTimer.reset()}lazyScrollUpdate(e=!0){this.scrollEventShortTimer.stop(),this.scrollEventLongTimer.stop();let i=this.messageContainerRef.nativeElement.querySelectorAll("chat-message"),r=this.messageContainerRef.nativeElement.offsetTop,s=r+this.messageContainerRef.nativeElement.clientHeight,o=this.topIndex,c=this.bottomIndex,m=this.getScrollPosition();this.scrollSpeed=m.top-this.preScrollTop,this.preScrollTop=m.top;let I=m.top<r,Z=s<m.bottom&&m.bottom<m.scrollHeight;if(e||this.scrollEventShortTimer.reset(),!e&&!I&&!Z)return;let fe=m.top-(!e&&I?100:1200),pe=m.bottom+(!e&&Z?100:1200);this.markForReadIfNeeded(),this.calcItemIndexRange(r,s,fe,pe,m,i),(this.topIndex!=o||this.bottomIndex!=c)&&(this.needUpdate=!0,this.topElm=i[0],this.bottomElm=i[i.length-1],this.topElmBox=this.topElm.getBoundingClientRect(),this.bottomElmBox=this.bottomElm.getBoundingClientRect(),xr(()=>{let we=this.getScrollPosition();this.scrollSpeed=we.top-this.preScrollTop,this.preScrollTop=we.top,this.changeDetector.markForCheck(),this.ngZone.run(()=>{})}))}calcElementMaxHeight(e){let i=this.minMessageHeight;for(let r=e.length-1;0<=r;r--){let s=e[r].clientHeight;i<s&&(i=s)}return i}calcItemIndexRange(e,i,r,s,o,c){if(r>=i||e>=s)this.bottomIndex=this.chatTab.chatMessages.length-1-Math.floor((o.scrollHeight-o.top-o.clientHeight)/this.minMessageHeight),this.topIndex=this.bottomIndex-Math.floor(o.clientHeight/this.minMessageHeight),this.bottomIndex+=1,this.topIndex-=1;else{let m=this.calcElementMaxHeight(c);r<e?this.topIndex-=Math.floor((e-r)/m)+1:r>e&&(HI||(this.topIndex+=Math.floor((r-e)/m))),i>s?HI||(this.bottomIndex-=Math.floor((i-s)/m)):i<s&&(this.bottomIndex+=Math.floor((s-i)/m)+1)}this.adjustIndex()}}return n.\u0275fac=function(e){return new(e||n)(Le(vn),Le(Di),Le(In))},n.\u0275cmp=Zt({type:n,selectors:[["chat-tab"]],viewQuery:function(e,i){if(1&e&&(on(ZW,7),on(XW,7)),2&e){let r;sn(r=an())&&(i.logContainerRef=r.first),sn(r=an())&&(i.messageContainerRef=r.first)}},inputs:{compact:"compact",chatTab:"chatTab"},outputs:{onAddMessage:"onAddMessage"},features:[eo],decls:6,vars:6,consts:[[1,"log"],["logContainer",""],[1,"virtual-scroll-container"],["messageContainer",""],[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"chatMessage","compact",4,"ngIf"],[3,"chatMessage","compact"],[3,"chatMessage","compact",4,"ngFor","ngForOf"]],template:function(e,i){1&e&&(K(0,"div",0,1)(2,"div",2,3),xe(4,eK,2,2,"ng-container",4),xe(5,nK,2,1,"ng-container",4),J()()),2&e&&(Ke("min-height",i.minScrollHeight,"px"),U(2),Ke("margin-bottom",i.bottomSpace,"px"),U(2),te("ngIf",!i.isEmpty),U(1),te("ngIf",i.isEmpty))},directives:[_n,ei,YW],styles:["[_nghost-%COMP%]{display:block}.log[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:flex-end;align-items:flex-end;width:100%;height:100%}.virtual-scroll-container[_ngcontent-%COMP%]{flex-shrink:0;width:100%}"],changeDetection:0}),n})();const rK=["chatTabComponemt"];function sK(n,t){if(1&n){const e=Xe();K(0,"chat-tab",13,14),Te("onAddMessage",function(){return De(e),ge().scrollToBottom()}),J()}if(2&n){const e=ge();te("chatTab",e.chatTab)("compact",e.isCompact)}}function oK(n,t){1&n&&(K(0,"div"),be(1,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u306e\u5185\u5bb9\u304c\u66f4\u65b0\u3055\u308c\u307e\u3057\u305f\u3002\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u9078\u629e\u3057\u306a\u304a\u3059\u304b\u3001\u3053\u306e\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u958b\u304d\u306a\u304a\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),J())}function aK(n,t){1&n&&(K(0,"i",8),be(1,"how_to_reg"),J())}function lK(n,t){1&n&&(K(0,"i",8),be(1,"history_edu"),J())}function cK(n,t){1&n&&it(0,"badge",19),2&n&&te("count",ge().$implicit.unreadLength)}function uK(n,t){if(1&n){const e=Xe();K(0,"label",15)(1,"input",16),Te("ngModelChange",function(r){return De(e),ge().chatTabidentifier=r}),J(),K(2,"div")(3,"span"),be(4),J(),xe(5,aK,2,0,"i",17),xe(6,lK,2,0,"i",17),xe(7,cK,1,1,"badge",18),J()()}if(2&n){const e=t.$implicit,i=ge();U(1),ct("value",e.identifier),te("ngModel",i.chatTabidentifier),U(2),Ke("cursor",i.chatTabidentifier!=e.identifier?"pointer":"")("color",""==e.name&&i.chatTabidentifier!=e.identifier?"gray":""),U(1),qe(""==e.name?"(\u7121\u540d\u306e\u30bf\u30d6)":e.name),U(1),te("ngIf",e.isUseStandImage),U(1),te("ngIf",e.recieveOperationLogLevel>0),U(1),te("ngIf",e.hasUnread)}}let UI=(()=>{class n{constructor(e,i,r){this.chatMessageService=e,this.panelService=i,this.pointerDeviceService=r,this.sendFrom="Guest",this._isCompact=!1,this._chatTabidentifier="",this.isAutoScroll=!0,this.scrollToBottomTimer=null}get isCompact(){return this._isCompact}set isCompact(e){this._isCompact=e,this.chatTabComponemt.onScroll()}get gameType(){return this.chatMessageService.gameType?this.chatMessageService.gameType:"DiceBot"}set gameType(e){this.chatMessageService.gameType=e}get chatTabidentifier(){return this._chatTabidentifier}set chatTabidentifier(e){let i=this._chatTabidentifier!==e;this._chatTabidentifier=e,this.updatePanelTitle(),i&&this.scrollToBottom(!0)}get chatTab(){return lt.instance.get(this.chatTabidentifier)}ngOnInit(){this.sendFrom=Ue.myCursor.identifier,this._chatTabidentifier=0<this.chatMessageService.chatTabs.length?this.chatMessageService.chatTabs[0].identifier:"",Fe.register(this).on("MESSAGE_ADDED",e=>{if(e.data.tabIdentifier!==this.chatTabidentifier)return;let i=lt.instance.get(e.data.messageIdentifier);i&&i.isSendFromSelf?this.isAutoScroll=!0:this.checkAutoScroll(),this.isAutoScroll&&this.chatTab&&this.chatTab.markForRead()}),Promise.resolve().then(()=>this.updatePanelTitle())}ngAfterViewInit(){queueMicrotask(()=>this.scrollToBottom(!0))}ngOnDestroy(){Fe.unregister(this)}scrollToBottom(e=!1){if(e&&(this.isAutoScroll=!0),!this.isAutoScroll)return;let i=new CustomEvent("scrolltobottom",{});this.panelService.scrollablePanel.dispatchEvent(i),null==this.scrollToBottomTimer&&(this.scrollToBottomTimer=setTimeout(()=>{this.chatTab&&this.chatTab.markForRead(),this.scrollToBottomTimer=null,this.isAutoScroll=!1,this.panelService.scrollablePanel&&(this.panelService.scrollablePanel.scrollTop=this.panelService.scrollablePanel.scrollHeight)},0))}checkAutoScroll(){this.panelService.scrollablePanel&&(this.isAutoScroll=this.panelService.scrollablePanel.scrollHeight-this.panelService.scrollablePanel.clientHeight-150<=this.panelService.scrollablePanel.scrollTop)}updatePanelTitle(){this.panelService.title=this.chatTab&&""!==this.chatTab.name?"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6 - "+this.chatTab.name:"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6"}onSelectedTab(e){this.updatePanelTitle()}showTabSetting(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(aW,{left:e.x-250,top:e.y-175,width:460,height:330}).selectedTab=this.chatTab}showLogOutput(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(jI,{left:e.x-250,top:e.y-175,width:460,height:300}).selectedTab=this.chatTab}sendChat(e){this.chatTab&&this.chatMessageService.sendMessage(this.chatTab,e.text,e.gameType,e.sendFrom,e.sendTo,e.color,e.isInverse,e.isHollow,e.isBlackPaint,e.aura,e.isUseFaceIcon,e.characterIdentifier,e.standIdentifier,e.standName,e.isUseStandImage)}trackByChatTab(e,i){return i.identifier}}return n.\u0275fac=function(e){return new(e||n)(Le(Er),Le(In),Le(ai))},n.\u0275cmp=Zt({type:n,selectors:[["chat-window"]],viewQuery:function(e,i){if(1&e&&on(rK,5),2&e){let r;sn(r=an())&&(i.chatTabComponemt=r.first)}},decls:23,vars:10,consts:[[1,"component"],[1,"log"],[3,"chatTab","compact","onAddMessage",4,"ngIf"],[4,"ngIf"],[1,"sticky-bottom"],[1,"chat-tab"],["class","tab",4,"ngFor","ngForOf","ngForTrackBy"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[1,"small-font",2,"float","right","padding","1px 4px 1px 2px","margin-left","2px","height","24px","box-sizing","border-box"],["name","isCompact","type","checkbox",3,"ngModel","value","checked","ngModelChange"],[2,"color","red"],[3,"chatTabidentifier","gameType","sendFrom","gameTypeChange","sendFromChange","chat"],[3,"chatTab","compact","onAddMessage"],["chatTabComponemt",""],[1,"tab"],["name","chat-tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],["class","material-icons small-font",4,"ngIf"],["class","badge",3,"count",4,"ngIf"],[1,"badge",3,"count"]],template:function(e,i){1&e&&(K(0,"div",0)(1,"div",1),xe(2,sK,2,2,"chat-tab",2),xe(3,oK,2,0,"div",3),J(),K(4,"div",4)(5,"form")(6,"div",5),xe(7,uK,8,10,"label",6),K(8,"button",7),Te("click",function(){return i.showTabSetting()}),K(9,"i",8),be(10,"settings"),J(),be(11,"\u30bf\u30d6\u8a2d\u5b9a"),J(),K(12,"button",7),Te("click",function(){return i.showLogOutput()}),K(13,"i",8),be(14,"history_edu"),J(),be(15,"\u30ed\u30b0"),J(),K(16,"label",9)(17,"input",10),Te("ngModelChange",function(s){return i.isCompact=s}),J(),K(18,"b"),be(19,"\u7c21\u6613\u8868\u793a"),K(20,"sup",11),be(21,"*"),J()()()()(),K(22,"chat-input",12),Te("gameTypeChange",function(s){return i.gameType=s})("sendFromChange",function(s){return i.sendFrom=s})("chat",function(s){return i.sendChat(s)}),J()()()),2&e&&(U(2),te("ngIf",i.chatTab),U(1),te("ngIf",!i.chatTab),U(4),te("ngForOf",i.chatMessageService.chatTabs)("ngForTrackBy",i.trackByChatTab),U(10),te("ngModel",i.isCompact)("value",!0)("checked",i.isCompact),U(5),te("chatTabidentifier",i.chatTabidentifier)("gameType",i.gameType)("sendFrom",i.sendFrom))},directives:[_n,iK,Il,Tl,ia,ei,Aa,fi,hi,oi,Nd,Jr,er],styles:["[_nghost-%COMP%]{display:block;height:100%}.loop-anime[_ngcontent-%COMP%]{-webkit-animation:anime1 1.3s infinite ease-in-out;animation:anime1 1.3s infinite ease-in-out}.component[_ngcontent-%COMP%]{min-height:100%;display:flex;flex-direction:column;justify-content:space-between;align-content:space-between}.sticky-bottom[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;bottom:0;width:100%;background-color:#f0dabdcc;border-top:1px dotted #666;margin-bottom:0}.chat-tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 4px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}label.compact[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.tab[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{vertical-align:top;font-size:.8rem}"]}),n})();const dK=["root"],fK=["altitudeSlider"];function hK(n,t){if(1&n){const e=Xe();K(0,"span",12),be(1," (\u9ad8\u5ea6 "),K(2,"input",13),Te("ngModelChange",function(r){return De(e),ge(2).altitudeHande.altitude=r}),J(),be(3,")"),J()}if(2&n){const e=ge(2);U(2),te("ngModel",e.altitudeHande.altitude)}}function pK(n,t){if(1&n&&(K(0,"div")(1,"div",10),be(2),xe(3,hK,4,1,"span",11),J()()),2&n){const e=ge();U(1),Ke("color",e.titleColor)("font-weight",e.titleBold?"bolder":"normal"),U(1),qe(e.title),U(1),te("ngIf",e.altitudeHande)}}function gK(n,t){1&n&&(K(0,"div",14)(1,"div",15),be(2,"\u9ad8"),J(),K(3,"div",16),be(4,"0"),J(),K(5,"div",17),be(6,"\u4f4e"),J()())}function mK(n,t){if(1&n){const e=Xe();K(0,"div",18)(1,"input",19,20),Te("ngModelChange",function(r){return De(e),ge().altitudeHande.altitude=r}),J()()}if(2&n){const e=ge();U(1),ct("title",e.altitudeHande.altitude),te("ngModel",e.altitudeHande.altitude)}}function _K(n,t){1&n&&pn(0)}const $K=function(n){return{action:n}};function vK(n,t){if(1&n&&(Ve(0),xe(1,_K,1,0,"ng-container",21),Ge()),2&n){const e=ge().$implicit;ge();const i=Wt(12),r=Wt(10);U(1),te("ngTemplateOutlet","separator"===(null==e?null:e.type)?i:r)("ngTemplateOutletContext",ut(2,$K,e))}}function bK(n,t){if(1&n&&(Ve(0),xe(1,vK,2,4,"ng-container",2),Ge()),2&n){const e=t.$implicit;U(1),te("ngIf",e)}}function yK(n,t){1&n&&(K(0,"span",43),be(1,"\u26a0\ufe0f"),J()),2&n&&ct("title",ge().action.error)}function CK(n,t){1&n&&it(0,"input",44),2&n&&te("disabled",ge().action.disabled)}function xK(n,t){1&n&&it(0,"input",45),2&n&&te("disabled",ge().action.disabled)}function wK(n,t){1&n&&it(0,"input",46),2&n&&te("disabled",ge().action.disabled)}function EK(n,t){1&n&&it(0,"input",47),2&n&&te("disabled",ge().action.disabled)}function TK(n,t){1&n&&(K(0,"span",48),be(1,"\u25a0"),J())}function IK(n,t){1&n&&(K(0,"span",49),be(1,"\u25a0"),J())}function SK(n,t){1&n&&(K(0,"span",50),be(1,"\u25a0"),J())}function MK(n,t){1&n&&(K(0,"span",51),be(1,"\u25a0"),J())}function kK(n,t){1&n&&(K(0,"span",52),be(1,"\u25a0"),J())}function DK(n,t){1&n&&(K(0,"span",53),be(1,"\u25a0"),J())}function AK(n,t){1&n&&(K(0,"span",54),be(1,"\u25a0"),J())}function PK(n,t){1&n&&(K(0,"span",55),be(1,"\u25a0"),J())}function NK(n,t){if(1&n&&(K(0,"span",56)(1,"i",57),be(2),J()()),2&n){const e=ge().action;U(2),qe(e.materialIcon)}}function FK(n,t){1&n&&(K(0,"sup",58),be(1,"*"),J())}function OK(n,t){if(1&n&&(K(0,"span",59),it(1,"img",60),Ct(2,"safe"),J()),2&n){const e=ge().action;U(1),te("src",xt(2,1,e.icon.url,"resourceUrl"),Jt)}}function RK(n,t){1&n&&(K(0,"i",61),be(1,"open_in_new"),J())}function BK(n,t){1&n&&(K(0,"div",62)(1,"i",63),be(2,"arrow_forward_ios"),J()())}function LK(n,t){if(1&n&&it(0,"context-menu",64),2&n){const e=ge().action,i=ge();te("title",e.name)("actions",i.subMenu)("isSubmenu",!0)}}const zK=function(n,t){return{hasHighlight:n,disabled:t}},jK=function(n,t){return{"icon-menu":n,default:t}};function HK(n,t){if(1&n){const e=Xe();K(0,"li",22),Te("click",function(){const s=De(e).action,o=ge();return!(s.disabled||s.altitudeHande&&0==s.altitudeHande.altitude)&&o.doAction(s)})("mouseenter",function(){const s=De(e).action,o=ge();return!(s.disabled||s.altitudeHande&&0==s.altitudeHande.altitude)&&o.showSubMenu(s)}),K(1,"div",23),xe(2,yK,2,1,"span",24),xe(3,CK,1,1,"input",25),xe(4,xK,1,1,"input",26),xe(5,wK,1,1,"input",27),xe(6,EK,1,1,"input",28),xe(7,TK,2,0,"span",29),xe(8,IK,2,0,"span",30),xe(9,SK,2,0,"span",31),xe(10,MK,2,0,"span",32),xe(11,kK,2,0,"span",33),xe(12,DK,2,0,"span",34),xe(13,AK,2,0,"span",35),xe(14,PK,2,0,"span",36),xe(15,NK,3,1,"span",37),be(16),xe(17,FK,2,0,"sup",38),xe(18,OK,3,4,"span",39),xe(19,RK,2,0,"i",40),J(),xe(20,BK,3,0,"div",41),xe(21,LK,1,3,"context-menu",42),J()}if(2&n){const e=t.action,i=ge();Ke("padding-left",e.icon?0:(e.level?e.level+1.5:1.5)-(i.altitudeHande?.5:0),"em")("color",e.color?e.color:"")("text-align",e.center?"center":""),te("ngClass",Kt(28,zK,!(e.disabled||e.icon||e.altitudeHande&&0==e.altitudeHande.altitude),e.disabled||e.altitudeHande&&0==e.altitudeHande.altitude)),U(1),te("ngClass",Kt(31,jK,e.icon,e.default)),U(1),te("ngIf",e.error),U(1),te("ngIf",e.name&&0==e.name.indexOf("\u2611")),U(1),te("ngIf",e.name&&0==e.name.indexOf("\u2610")),U(1),te("ngIf",e.name&&0==e.name.indexOf("\u25c9")),U(1),te("ngIf",e.name&&0==e.name.indexOf("\u25cb")),U(1),te("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30d6\u30e9\u30c3\u30af")),U(1),te("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30d6\u30eb\u30fc")),U(1),te("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30b0\u30ea\u30fc\u30f3")),U(1),te("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30b7\u30a2\u30f3")),U(1),te("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30ec\u30c3\u30c9")),U(1),te("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30de\u30bc\u30f3\u30bf")),U(1),te("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30a4\u30a8\u30ed\u30fc")),U(1),te("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30db\u30ef\u30a4\u30c8")),U(1),te("ngIf",e.materialIcon),U(1),An(" ",e.name.replace("\u2611","").replace("\u2610","").replace("\u25c9","").replace("\u25cb",""),""),U(1),te("ngIf",e.selfOnly),U(1),te("ngIf",e.icon&&0<(null==e.icon?null:e.icon.url.length)),U(1),te("ngIf",e.isOuterLink),U(1),te("ngIf",e.subActions&&!e.disabled),U(1),te("ngIf",i.subMenu&&i.parentMenu===e)}}function UK(n,t){1&n&&(K(0,"li"),it(1,"hr",65),J())}const VK=function(n,t,e,i){return{"icons-panel":n,"submenu-panel":t,"is-max-limit":e,"pointer-events-none":i}};let GK=(()=>{class n{constructor(e,i,r){this.elementRef=e,this.contextMenuService=i,this.pointerDeviceService=r,this.title="",this.actions=[],this.titleColor=Ue.CHAT_DEFAULT_COLOR,this.titleBold=!1,this.isSubmenu=!1,this.callbackOnOutsideClick=s=>this.onOutsideClick(s)}get isPointerDragging(){return this.pointerDeviceService.isDragging}get altitudeHande(){for(let e of this.actions)if(e&&e.altitudeHande)return e.altitudeHande;return null}get isIconsMenu(){for(let e of this.actions)if(!e||!e.icon)return!1;return!0}ngOnInit(){this.isSubmenu||(this.title=this.contextMenuService.title,this.actions=this.contextMenuService.actions,this.titleColor=this.contextMenuService.titleColor,this.titleBold=this.contextMenuService.titleBold)}ngAfterViewInit(){this.isSubmenu?this.adjustPositionSub():(this.adjustPositionRoot(),document.addEventListener("touchstart",this.callbackOnOutsideClick,!0),document.addEventListener("mousedown",this.callbackOnOutsideClick,!0))}ngOnDestroy(){document.removeEventListener("touchstart",this.callbackOnOutsideClick,!0),document.removeEventListener("mousedown",this.callbackOnOutsideClick,!0)}onOutsideClick(e){!1===this.rootElementRef.nativeElement.contains(e.target)&&this.close()}onContextMenu(e){e.stopPropagation(),e.preventDefault()}adjustPositionRoot(){let e=this.rootElementRef.nativeElement;e.style.left=this.contextMenuService.position.x+"px",e.style.top=this.contextMenuService.position.y+"px";let i=e.getBoundingClientRect(),r=0,s=0;window.innerWidth<i.right+r&&(r+=window.innerWidth-(i.right+r)),i.left+r<0&&(r+=0-(i.left+r)),window.innerHeight<i.bottom+s&&(s+=window.innerHeight-(i.bottom+s)),i.top+s<0&&(s+=0-(i.top+s)),e.style.left=e.offsetLeft+r+"px",e.style.top=e.offsetTop+s+"px",this.altitudeSlider&&(this.altitudeSlider.nativeElement.style.height=e.clientHeight-72+"px")}adjustPositionSub(){let i=this.rootElementRef.nativeElement,r=this.elementRef.nativeElement.parentElement.getBoundingClientRect(),s=i.getBoundingClientRect(),o=0,c=0;window.innerWidth<s.right+o&&(o-=r.width+s.width,o+=8),s.left+o<0&&(o+=0-(s.left+o)),window.innerHeight<s.bottom+c&&(c+=window.innerHeight-(s.bottom+c)),s.top+c<0&&(c+=0-(s.top+c)),i.style.left=i.offsetLeft+o+"px",i.style.top=i.offsetTop+c+"px"}doAction(e){this.showSubMenu(e),null!=e.action&&(e.action(),this.close())}showSubMenu(e){this.hideSubMenu(),clearTimeout(this.showSubMenuTimer),!(null==e.subActions||e.subActions.length<1)&&(this.showSubMenuTimer=setTimeout(()=>{this.parentMenu=e,this.subMenu=e.subActions,clearTimeout(this.hideSubMenuTimer)},250))}hideSubMenu(){clearTimeout(this.hideSubMenuTimer),this.hideSubMenuTimer=setTimeout(()=>{this.subMenu=null},1200)}close(){this.contextMenuService&&this.contextMenuService.close()}}return n.\u0275fac=function(e){return new(e||n)(Le(_i),Le(sr),Le(ai))},n.\u0275cmp=Zt({type:n,selectors:[["context-menu"]],viewQuery:function(e,i){if(1&e&&(on(dK,7),on(fK,5)),2&e){let r;sn(r=an())&&(i.rootElementRef=r.first),sn(r=an())&&(i.altitudeSlider=r.first)}},hostBindings:function(e,i){1&e&&Te("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{title:"title",actions:"actions",titleColor:"titleColor",titleBold:"titleBold",isSubmenu:"isSubmenu"},decls:13,vars:10,consts:[[1,"component",2,"display","flex","flex-direction","column",3,"ngClass","mouseleave"],["root",""],[4,"ngIf"],[2,"display","flex","align-items","center"],["class","altitude ruler","style","display: flex; align-self: stretch; flex-direction: column; align-content: center",4,"ngIf"],["class","altitude",4,"ngIf"],[2,"flex-grow","1"],[4,"ngFor","ngForOf"],["actionMenu",""],["separator",""],[1,"title"],["style","font-size: small;",4,"ngIf"],[2,"font-size","small"],["type","number","step","0.1",2,"font-size","small","width","3.6em","text-align","right",3,"ngModel","ngModelChange"],[1,"altitude","ruler",2,"display","flex","align-self","stretch","flex-direction","column","align-content","center"],[2,"margin-top","2em"],[2,"align-self","center","margin-top","auto","margin-bottom","auto"],[2,"margin-bottom","2em"],[1,"altitude"],["type","range","max","12","min","-12","step","0.5","orient","vertical",1,"altitude",3,"title","ngModel","ngModelChange"],["altitudeSlider",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngClass","click","mouseenter"],[1,"menu-title",3,"ngClass"],[3,"title",4,"ngIf"],["type","checkbox","checked","",3,"disabled",4,"ngIf"],["type","checkbox",3,"disabled",4,"ngIf"],["type","radio","checked","",3,"disabled",4,"ngIf"],["type","radio",3,"disabled",4,"ngIf"],["class","color-indicator","style","color: #000",4,"ngIf"],["class","color-indicator","style","color: #00f",4,"ngIf"],["class","color-indicator","style","color: #0f0",4,"ngIf"],["class","color-indicator","style","color: #0ff",4,"ngIf"],["class","color-indicator","style","color: #f00",4,"ngIf"],["class","color-indicator","style","color: #f0f",4,"ngIf"],["class","color-indicator","style","color: #ff0",4,"ngIf"],["class","color-indicator","style","color: #fff",4,"ngIf"],["style","vertical-align: top",4,"ngIf"],["class","self-only",4,"ngIf"],["class","imagebox",4,"ngIf"],["class","material-icons","style","font-size: 1rem",4,"ngIf"],["class","sub-menu-arrow",4,"ngIf"],[3,"title","actions","isSubmenu",4,"ngIf"],[3,"title"],["type","checkbox","checked","",3,"disabled"],["type","checkbox",3,"disabled"],["type","radio","checked","",3,"disabled"],["type","radio",3,"disabled"],[1,"color-indicator",2,"color","#000"],[1,"color-indicator",2,"color","#00f"],[1,"color-indicator",2,"color","#0f0"],[1,"color-indicator",2,"color","#0ff"],[1,"color-indicator",2,"color","#f00"],[1,"color-indicator",2,"color","#f0f"],[1,"color-indicator",2,"color","#ff0"],[1,"color-indicator",2,"color","#fff"],[2,"vertical-align","top"],[1,"material-icons",2,"font-size","150%","padding-left","2px"],[1,"self-only"],[1,"imagebox"],[1,"image",3,"src"],[1,"material-icons",2,"font-size","1rem"],[1,"sub-menu-arrow"],[1,"material-icons",2,"font-size","1em","vertical-align","bottom"],[3,"title","actions","isSubmenu"],[1,"separator"]],template:function(e,i){1&e&&(K(0,"div",0,1),Te("mouseleave",function(){return i.hideSubMenu()}),xe(2,pK,4,6,"div",2),K(3,"div",3),xe(4,gK,7,0,"div",4),xe(5,mK,3,2,"div",5),K(6,"div",6)(7,"ul"),xe(8,bK,2,1,"ng-container",7),J()()()(),xe(9,HK,22,34,"ng-template",null,8,Ln),xe(11,UK,2,0,"ng-template",null,9,Ln)),2&e&&(te("ngClass",oo(5,VK,i.isIconsMenu,i.isSubmenu,!i.isSubmenu,i.isPointerDragging)),U(2),te("ngIf",!i.isIconsMenu&&0<i.title.length||i.altitudeHande),U(2),te("ngIf",i.altitudeHande),U(1),te("ngIf",i.altitudeHande),U(3),te("ngForOf",i.actions))},directives:[Wn,_n,gs,fi,hi,oi,ms,ei,wl,n],pipes:[ti],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;padding:0;white-space:nowrap;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;z-index:2000000}.submenu-panel[_ngcontent-%COMP%]{position:absolute;left:calc(100% - 4px);top:-16px}.icons-panel[_ngcontent-%COMP%]{padding-bottom:2px}.icons-panel[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{width:54px;padding:1px}.icons-panel[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{padding:1px 0}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-max-limit[_ngcontent-%COMP%]{max-height:100%;max-width:100%}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em;font-size:12px;text-align:center;padding:4px 16px;margin:0 2px;color:#444;border-bottom:1px solid #AAA}.menu-title[_ngcontent-%COMP%]{display:inline-block}hr.separator[_ngcontent-%COMP%]{margin:.1em -12px;height:1px;border:0;background-color:#aaa}.sub-menu-arrow[_ngcontent-%COMP%]{display:inline-block;position:absolute;top:2px;bottom:0;right:1px}ul[_ngcontent-%COMP%]{list-style:none;padding:2px 0;margin:0}ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:relative;cursor:-moz-default;cursor:-webkit-default;cursor:default;padding:2px 20px;font-size:12px;color:#444}ul[_ngcontent-%COMP%] > li.hasHighlight[_ngcontent-%COMP%]:hover{color:#ccc;background-color:#1e1e1ecc}.menu-title[_ngcontent-%COMP%]:not(.icon-menu){overflow:hidden;max-width:16.5em;text-overflow:ellipsis}td.altitude[_ngcontent-%COMP%]{vertical-align:middle}input.altitude[_ngcontent-%COMP%]{writing-mode:bt-lr;-webkit-appearance:slider-vertical;-moz-appearance:slider-vertical;appearance:slider-vertical;width:8px;height:100%;padding:3px}.disabled[_ngcontent-%COMP%]   .menu-title[_ngcontent-%COMP%], .disabled[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{color:gray}.altitude-view[_ngcontent-%COMP%]{color:#000;vertical-align:top;width:3em;text-align:right}.ruler[_ngcontent-%COMP%]{color:#444;font-size:small;padding-left:4px;padding-right:2px}.default[_ngcontent-%COMP%]{font-weight:bolder}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:50px;height:50px;max-width:50px;max-height:50px;vertical-align:top;margin-left:auto;margin-right:auto;text-align:center}.image[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:middle;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:.5rem}.icon-menu[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none}.icon-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid transparent;z-index:400}.icon-menu[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{border:2px dotted rgba(255,0,0,40);z-index:600}.icon-menu.default[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid red;z-index:500}.color-indicator[_ngcontent-%COMP%]{font-size:larger;text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff;margin-right:-.2rem}.self-only[_ngcontent-%COMP%]{color:red}"]}),n})(),qK=(()=>{class n{constructor(e,i,r){this.viewContainerRef=e,this.modalService=i,this.panelService=r,this.name="\u30b2\u30fc\u30e0\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",this.size=1,this.xml="",this.minSize=1,this.maxSize=20,this.tableBackgroundImage=Ht.createEmpty("null")}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u30fc"),Fe.register(this).on("SELECT_FILE",e=>{console.log("SELECT_FILE GameCharacterGeneratorComponent "+e.data.fileIdentifier);let r=kt.instance.get(e.data.fileIdentifier);r&&(this.tableBackgroundImage=r)})}ngAfterViewInit(){}ngOnDestroy(){Fe.unregister(this)}createGameCharacter(){Vt.create(this.name,this.size,this.tableBackgroundImage.identifier)}createGameTableMask(){let e=lr.instance.viewTable;if(!e)return;let i=is.create("\u30de\u30c3\u30d7\u30de\u30b9\u30af",5,5,100);e.appendChild(i)}createGameCharacterForXML(e){Zn.instance.parseXml(e)}openModal(){this.modalService.open(Lo)}}return n.\u0275fac=function(e){return new(e||n)(Le(Rr),Le(kn),Le(In))},n.\u0275cmp=Zt({type:n,selectors:[["game-character-generator"]],decls:15,vars:12,consts:[[3,"click"],["height","120",3,"src"],["placeholder","Name","name","name",3,"ngModel","ngModelChange"],["type","range","name","size",3,"ngModel","title","min","max","ngModelChange"],["type","number",3,"ngModel","min","max","ngModelChange"]],template:function(e,i){1&e&&(K(0,"button",0),Te("click",function(){return i.openModal()}),be(1,"\u753b\u50cf\u3092\u9078\u3076"),J(),K(2,"div"),it(3,"img",1),Ct(4,"safe"),J(),K(5,"input",2),Te("ngModelChange",function(s){return i.name=s}),J(),K(6,"div")(7,"div")(8,"input",3),Te("ngModelChange",function(s){return i.size=s}),J(),be(9," Size : "),K(10,"input",4),Te("ngModelChange",function(s){return i.size=s}),J()(),K(11,"button",0),Te("click",function(){return i.createGameCharacter()}),be(12,"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u4f5c\u308b"),J(),K(13,"button",0),Te("click",function(){return i.createGameTableMask()}),be(14,"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u4f5c\u308b"),J()()),2&e&&(U(3),te("src",xt(4,9,i.tableBackgroundImage.url,"resourceUrl"),Jt),U(2),te("ngModel",i.name),U(3),ct("title",i.size),ct("min",i.minSize),ct("max",i.maxSize),te("ngModel",i.size),U(2),ct("min",i.minSize),ct("max",i.maxSize),te("ngModel",i.size))},directives:[fi,hi,oi,ms,gs,So,Io],pipes:[ti],styles:[""]}),n})();function WK(n,t){1&n&&pn(0)}function KK(n,t){1&n&&pn(0)}function YK(n,t){if(1&n&&(K(0,"div"),be(1),J()),2&n){const e=ge();U(1),An("",e.getTabTitle(e.selectTab),"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306f\u7a7a\u3067\u3059")}}function ZK(n,t){if(1&n&&(K(0,"div",12),be(1),J()),2&n){const e=ge().$implicit;Ke("background-color",e.ownerColor),U(1),qe(e.ownerName?e.ownerName:"\uff08\u7121\u540d\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\uff09")}}function XK(n,t){1&n&&pn(0)}const QK=function(n,t,e){return{box:!0,selected:n,"is-hide-in":t,"is-inventory-no-indicate":e}},JK=function(n){return{gameObject:n}};function eY(n,t){if(1&n){const e=Xe();K(0,"div",9),Te("contextmenu",function(r){const o=De(e).$implicit;return ge().onContextMenu(r,o)})("click",function(){const s=De(e).$implicit;return ge().selectGameObject(s)})("dblclick",function(r){const o=De(e).$implicit;return ge().focusGameObject(o,r)}),xe(1,ZK,2,3,"div",10),xe(2,XK,1,0,"ng-container",11),J()}if(2&n){const e=t.$implicit,i=ge(),r=Wt(11);te("ngClass",Zr(4,QK,i.selectedIdentifier===e.identifier,e.isHideIn,!e.isInventoryIndicate)),U(1),te("ngIf",e.isHideIn&&null!=e.ownerName),U(1),te("ngTemplateOutlet",r)("ngTemplateOutletContext",ut(8,JK,e))}}function tY(n,t){if(1&n){const e=Xe();K(0,"div",13)(1,"button",14),Te("click",function(){return De(e),ge().cleanInventory()}),be(2,"\u5893\u5834\u3092\u7a7a\u306b\u3059\u308b"),J()()}if(2&n){const e=ge();U(1),Rt("disabled",e.getGameObjects(e.selectTab).length<1?"":null)}}function nY(n,t){if(1&n){const e=Xe();K(0,"label")(1,"input",18),Te("ngModelChange",function(r){return De(e),ge(2).selectTab=r}),J(),K(2,"div"),be(3),J()()}if(2&n){const e=t.$implicit,i=ge(2);U(1),ct("value",e),te("ngModel",i.selectTab),U(2),Ta("",i.getTabTitle(e)," (",i.getGameObjects(e).length,")")}}function iY(n,t){if(1&n&&(K(0,"form",15)(1,"div",16),xe(2,nY,4,4,"label",17),J()()),2&n){const e=ge();U(2),te("ngForOf",e.inventoryTypes)}}function rY(n,t){if(1&n){const e=Xe();Ve(0),K(1,"div")(2,"div",19)(3,"b"),be(4,"\u4e26\u3073\u9806: "),J()(),K(5,"input",20),Te("ngModelChange",function(r){return De(e),ge(2).sortTag=r}),J(),K(6,"select",21),Te("ngModelChange",function(r){return De(e),ge(2).sortOrder=r}),K(7,"option",22),be(8,"\u6607\u9806"),J(),K(9,"option",23),be(10,"\u964d\u9806"),J()()(),K(11,"div",24)(12,"b"),be(13,"\u8868\u793a\u9805\u76ee: "),J()(),K(14,"input",25),Te("ngModelChange",function(r){return De(e),ge(2).dataTag=r}),J(),K(15,"div",13)(16,"button",26),Te("click",function(){return De(e),ge(2).toggleEdit()}),K(17,"i",27),be(18,"settings"),J(),be(19,"\u5b8c\u4e86"),J()(),Ge()}if(2&n){const e=ge(2);U(5),te("ngModel",e.sortTag),U(1),te("ngModel",e.sortOrder),U(8),te("ngModel",e.dataTag)}}function sY(n,t){if(1&n&&(Ve(0),K(1,"span"),be(2),J(),Ge()),2&n){const e=ge(3);U(2),Ta("",e.sortTag," (",e.sortOrderName,")")}}function oY(n,t){1&n&&(Ve(0),be(1,"-"),Ge())}function aY(n,t){if(1&n){const e=Xe();K(0,"label",32)(1,"input",33),Te("ngModelChange",function(r){return De(e),ge(3).indicateAll=r}),J(),K(2,"b"),be(3,"\u3059\u3079\u3066\u8868\u793a"),K(4,"sup",34),be(5,"*"),J()()()}if(2&n){const e=ge(3);U(1),te("ngModel",e.indicateAll)}}function lY(n,t){if(1&n){const e=Xe();Ve(0),K(1,"table",28)(2,"tr")(3,"th",29),be(4,"\u4e26\u3073\u9806:"),J(),K(5,"td",29),xe(6,sY,3,2,"ng-container",2),xe(7,oY,2,0,"ng-container",2),J(),K(8,"td",30)(9,"button",26),Te("click",function(){return De(e),ge(2).toggleEdit()}),K(10,"i",27),be(11,"settings"),J(),be(12,"\u8a2d\u5b9a"),J(),xe(13,aY,6,1,"label",31),J()()(),Ge()}if(2&n){const e=ge(2);U(6),te("ngIf",0<e.sortTag.length),U(1),te("ngIf",e.sortTag.length<1),U(6),te("ngIf","table"===e.selectTab)}}function cY(n,t){if(1&n&&(xe(0,rY,20,3,"ng-container",2),xe(1,lY,14,3,"ng-container",2)),2&n){const e=ge();te("ngIf",e.isEdit),U(1),te("ngIf",!e.isEdit)}}function uY(n,t){if(1&n&&(K(0,"i",56),it(1,"img",57),Ct(2,"safe"),J()),2&n){const e=ge().gameObject;U(1),te("src",xt(2,1,e.faceIcon.url,"resourceUrl"),Jt)}}function dY(n,t){1&n&&(K(0,"i",42),be(1,"emoji_emotions"),J())}const fY=function(n){return{opacity:n}};function hY(n,t){if(1&n&&(K(0,"i",56),it(1,"img",58),Ct(2,"safe"),J()),2&n){const e=ge().gameObject;U(1),te("ngStyle",ut(5,fY,e.isDropShadow?.7:.3))("src",xt(2,2,e.shadowImageFile.url,"resourceUrl"),Jt)}}function pY(n,t){if(1&n&&(K(0,"i",42),be(1),J()),2&n){const e=ge().gameObject;U(1),qe(e.isDropShadow?"star_half":"star_border")}}function gY(n,t){if(1&n){const e=Xe();K(0,"button",59),Te("click",function(r){De(e);const s=ge().gameObject;return ge().onContextMenu(r,s)}),K(1,"i",42),be(2,"settings"),J()()}}const mY=function(n,t,e,i){return{inverse:n,hollow:t,"is-hide-in":e,"black-paint":i}};function _Y(n,t){if(1&n&&(it(0,"img",60),Ct(1,"safe")),2&n){const e=ge().gameObject;te("src",xt(1,2,e.imageFile.url,"resourceUrl"),Jt)("ngClass",oo(5,mY,e.isInverse,e.isHollow,e.isHideIn,e.isBlackPaint))}}function $Y(n,t){1&n&&pn(0)}const vY=function(n,t){return{dataElm:n,name:t}};function bY(n,t){if(1&n&&(Ve(0),xe(1,$Y,1,0,"ng-container",11),Ge()),2&n){const e=t.$implicit,i=ge(2).gameObject;ge();const r=Wt(13);U(1),te("ngTemplateOutlet",r)("ngTemplateOutletContext",Kt(2,vY,e,i.name))}}function yY(n,t){if(1&n&&(K(0,"div"),xe(1,bY,2,5,"ng-container",61),J()),2&n){const e=ge().gameObject,i=ge();U(1),te("ngForOf",i.getInventoryTags(e))("ngForTrackBy",i.trackByGameObject)}}const xu=function(n){return{"is-active":n}},VI=function(n){return{"is-hide-in":n}},CY=function(n,t,e,i,r,s,o,c){return{black:n,blue:t,green:e,cyan:i,red:r,magenta:s,yellow:o,white:c}};function xY(n,t){if(1&n){const e=Xe();K(0,"div",35)(1,"div",36)(2,"button",37),Te("click",function(){const s=De(e).gameObject;return s.isUseIconToOverviewImage=!s.isUseIconToOverviewImage}),xe(3,uY,3,4,"i",38),xe(4,dY,2,0,"ng-template",null,39,Ln),J(),K(6,"span",40),be(7),J(),K(8,"button",41),Te("click",function(){const s=De(e).gameObject;return s.isShowChatBubble=!s.isShowChatBubble}),K(9,"i",42),be(10),J()(),K(11,"button",43),Te("click",function(){const s=De(e).gameObject;return s.isDropShadow=!s.isDropShadow}),xe(12,hY,3,7,"i",38),xe(13,pY,2,1,"ng-template",null,44,Ln),J(),K(15,"button",45),Te("click",function(){const s=De(e).gameObject;return s.isNotRide=!s.isNotRide}),K(16,"i",42),be(17),J()(),K(18,"button",46),Te("click",function(){const s=De(e).gameObject;return s.isAltitudeIndicate=!s.isAltitudeIndicate}),K(19,"i",47),be(20,"straighten"),J(),K(21,"span",48),be(22),J()(),K(23,"button",49),Te("click",function(){const s=De(e).gameObject;return s.isInventoryIndicate=!s.isInventoryIndicate}),K(24,"i",42),be(25,"all_inbox"),J()(),xe(26,gY,3,0,"button",50),J(),K(27,"div",51)(28,"div",52)(29,"span",53),xe(30,_Y,2,10,"img",54),J()(),K(31,"div",55),xe(32,yY,2,2,"div",2),J()()()}if(2&n){const e=t.gameObject,i=Wt(5),r=Wt(14),s=ge();U(2),te("disabled",s.selectedIdentifier!==e.identifier)("ngClass",ut(26,xu,e.isUseIconToOverviewImage)),U(1),te("ngIf",e.faceIcon&&0<(null==e.faceIcon?null:e.faceIcon.url.length))("ngIfElse",i),U(4),qe(e.name),U(1),te("disabled",s.selectedIdentifier!==e.identifier)("ngClass",ut(28,xu,e.isShowChatBubble)),U(2),qe(e.isShowChatBubble?"textsms":"speaker_notes_off"),U(1),te("disabled",s.selectedIdentifier!==e.identifier)("ngClass",ut(30,xu,e.isDropShadow)),U(1),te("ngIf",e.shadowImageFile&&0<e.shadowImageFile.url.length)("ngIfElse",r),U(3),te("disabled",s.selectedIdentifier!==e.identifier)("ngClass",ut(32,xu,!e.isNotRide)),U(2),qe(e.isNotRide?"directions_run":"directions_bike"),U(1),te("disabled",s.selectedIdentifier!==e.identifier)("ngClass",ut(34,xu,e.isAltitudeIndicate)),U(4),qe(e.altitude),U(1),te("disabled",s.selectedIdentifier!==e.identifier)("ngClass",ut(36,xu,e.isInventoryIndicate)),U(3),te("ngIf",s.selectedIdentifier===e.identifier),U(1),te("ngClass",ut(38,VI,e.isHideIn)),U(1),te("ngClass",ut(40,VI,e.isHideIn)),U(1),te("ngClass",ao(42,CY,0==e.aura,1==e.aura,2==e.aura,3==e.aura,4==e.aura,5==e.aura,6==e.aura,7==e.aura)),U(1),te("ngIf",e.imageFile.url),U(2),te("ngIf",e.rootDataElement)}}function wY(n,t){1&n&&(Ve(0),it(1,"br"),Ge())}function EY(n,t){if(1&n){const e=Xe();Ve(0),K(1,"div",67)(2,"span"),be(3),J()(),K(4,"div",68)(5,"div",69)(6,"div",70)(7,"div",71),be(8),J(),K(9,"input",72),Te("ngModelChange",function(r){return De(e),ge(2).dataElm.value=r}),J()()()(),Ge()}if(2&n){const e=ge(2),i=e.dataElm,r=e.name;U(3),qe(i.name),U(5),qe(i.value),U(1),ct("type",i.value&&i.value==+i.value?"number":"text"),te("logging.name",r)("logging.dataElement",i)("ngModel",i.value)}}const TY=function(){return{"background-color":"green"}};function IY(n,t){if(1&n){const e=Xe();Ve(0),K(1,"div",73)(2,"div",74)(3,"span"),be(4),J()(),K(5,"input",75),Te("ngModelChange",function(r){return De(e),ge(2).dataElm.currentValue=r}),J()(),K(6,"div",73)(7,"input",76),Te("ngModelChange",function(r){return De(e),ge(2).dataElm.currentValue=r}),Ct(8,"safe"),J()(),Ge()}if(2&n){const e=ge(2),i=e.dataElm,r=e.name;U(4),qe(i.name),U(1),te("logging.name",r)("logging.dataElement",i)("ngModel",i.currentValue),Rt("data-init-value",i.currentValue),U(2),ur(xt(8,14,"font-size: 0.8em; min-width: 1em; width:"+(i.name.length+4.5)+"em; --min: 0; --max: "+i.value+"; --val:"+i.currentValue+";","style")),ct("title",i.currentValue),ct("max",+i.value?i.value:1e3),te("logging.name",r)("logging.dataElement",i)("ngStyle",ea(17,TY))("ngModel",i.currentValue),Rt("data-init-value",i.currentValue)}}function SY(n,t){if(1&n){const e=Xe();Ve(0),K(1,"div",67)(2,"span"),be(3),J()(),K(4,"div",68)(5,"div",69)(6,"div",70)(7,"input",77),Te("ngModelChange",function(r){return De(e),ge(2).dataElm.value=r})("change",function(){De(e);const r=ge(2).dataElm;return r.value=r.value?r.name:""}),J()()()(),Ge()}if(2&n){const e=ge(2),i=e.dataElm,r=e.name;U(1),Ke("text-decoration",i.value?"none":"line-through"),U(2),qe(i.name),U(4),ct("checked",i.value?"checked":""),te("logging.name",r)("logging.dataElement",i)("ngModel",i.value)}}function MY(n,t){if(1&n&&(K(0,"span",79),be(1),J()),2&n){const e=ge(3).dataElm;U(1),An("(",(e.calcAbilityScore()>=0?"+":"")+e.calcAbilityScore(),")")}}function kY(n,t){if(1&n){const e=Xe();Ve(0),K(1,"div",67)(2,"span"),be(3),J()(),K(4,"div",68)(5,"div",69)(6,"div",70)(7,"div",71),be(8),J(),K(9,"input",72),Te("ngModelChange",function(r){return De(e),ge(2).dataElm.value=r}),J(),xe(10,MY,2,1,"span",78),J()()(),Ge()}if(2&n){const e=ge(2),i=e.dataElm,r=e.name;U(3),qe(i.name),U(5),qe(i.value),U(1),ct("type",i.value&&i.value==+i.value?"number":"text"),te("logging.name",r)("logging.dataElement",i)("ngModel",i.value),U(1),te("ngIf",i.currentValue)}}const DY=function(n){return{"outer-link":n}};function AY(n,t){if(1&n){const e=Xe();Ve(0),K(1,"div",67)(2,"a",80),Te("click",function(){De(e);const r=ge(2),s=r.dataElm,o=r.name,c=ge();return!!c.stringUtil.validUrl(s.value)&&c.openUrl(s.value,o,s.name)}),Ct(3,"safe"),K(4,"span",81),be(5),J()()(),Ge()}if(2&n){const e=ge(2).dataElm,i=ge();U(2),te("ngClass",ut(8,DY,!i.stringUtil.sameOrigin(e.value))),Rt("title",e.value)("href",xt(3,5,i.stringUtil.validUrl(e.value)?e.value:"","url"),Jt)("disabled",i.stringUtil.validUrl(e.value)?null:""),U(3),qe(e.name)}}function PY(n,t){1&n&&pn(0)}function NY(n,t){1&n&&pn(0)}function FY(n,t){1&n&&pn(0)}function OY(n,t){if(1&n){const e=Xe();Ve(0),K(1,"div",67)(2,"span"),be(3),J()(),K(4,"div",68)(5,"div",69)(6,"div",70)(7,"div",71),be(8),J(),K(9,"input",82),Te("ngModelChange",function(r){return De(e),ge(3).dataElm.value=r}),J()()()(),Ge()}if(2&n){const e=ge(3).dataElm;U(3),qe(e.name),U(5),qe(e.value),U(1),ct("type","size"===e.name||"altitude"===e.name?"number":"text"),ct("min","size"===e.name?"0":""),te("ngModel",e.value)}}function RY(n,t){if(1&n&&(Ve(0),xe(1,OY,10,5,"ng-container",2),Ge()),2&n){const e=ge(2).dataElm;U(1),te("ngIf",0==e.children.length)}}function BY(n,t){if(1&n&&(K(0,"div",63),Ve(1,64),xe(2,EY,10,6,"ng-container",65),xe(3,IY,9,18,"ng-container",65),xe(4,SY,8,7,"ng-container",65),xe(5,kY,11,7,"ng-container",65),xe(6,AY,6,10,"ng-container",65),xe(7,PY,1,0,"ng-container",65),xe(8,NY,1,0,"ng-container",65),xe(9,FY,1,0,"ng-container",65),xe(10,RY,2,1,"ng-container",66),Ge(),J()),2&n){const e=ge().dataElm;U(1),te("ngSwitch",e.attributes.type),U(1),te("ngSwitchCase","simpleNumber"),U(1),te("ngSwitchCase","numberResource"),U(1),te("ngSwitchCase","checkProperty"),U(1),te("ngSwitchCase","abilityScore"),U(1),te("ngSwitchCase","url"),U(1),te("ngSwitchCase","colors"),U(1),te("ngSwitchCase","color"),U(1),te("ngSwitchCase","note")}}function LY(n,t){if(1&n&&(xe(0,wY,2,0,"ng-container",2),xe(1,BY,11,9,"div",62)),2&n){const e=t.dataElm,i=ge();te("ngIf",(null==e?null:e.name)===i.newLineString),U(1),te("ngIf",e&&e.name!==i.newLineString)}}let zY=(()=>{class n{constructor(e,i,r,s,o,c){this.changeDetector=e,this.panelService=i,this.inventoryService=r,this.contextMenuService=s,this.pointerDeviceService=o,this.modalService=c,this.inventoryTypes=["table","common","graveyard"],this.selectTab="table",this.selectedIdentifier="",this.isEdit=!1,this.stringUtil=et,this.sortStopTimerId=null}get sortTag(){return this.inventoryService.sortTag}set sortTag(e){this.inventoryService.sortTag=e}get sortOrder(){return this.inventoryService.sortOrder}set sortOrder(e){this.inventoryService.sortOrder=e}get dataTag(){return this.inventoryService.dataTag}set dataTag(e){this.inventoryService.dataTag=e}get dataTags(){return this.inventoryService.dataTags}get indicateAll(){return this.inventoryService.indicateAll}set indicateAll(e){this.inventoryService.indicateAll=e}get sortOrderName(){return this.sortOrder===rf.ASC?"\u6607\u9806":"\u964d\u9806"}get newLineString(){return this.inventoryService.newLineString}get isGMMode(){return!!Ue.myCursor&&Ue.myCursor.isGMMode}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),Fe.register(this).on("SELECT_TABLETOP_OBJECT",e=>{lt.instance.get(e.data.identifier)instanceof $i&&(this.selectedIdentifier=e.data.identifier,this.changeDetector.markForCheck())}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("UPDATE_INVENTORY",e=>{(e.isSendFromSelf||e.data)&&this.changeDetector.markForCheck()}).on("OPEN_NETWORK",e=>{this.inventoryTypes=["table","common",yt.peerId,"graveyard"],this.inventoryTypes.includes(this.selectTab)||(this.selectTab=yt.peerId)}),this.inventoryTypes=["table","common",yt.peerId,"graveyard"]}ngOnDestroy(){Fe.unregister(this),this.sortStopTimerId&&clearTimeout(this.sortStopTimerId)}getTabTitle(e){switch(e){case"table":return"\u30c6\u30fc\u30d6\u30eb";case yt.peerId:return"\u500b\u4eba";case"graveyard":return"\u5893\u5834";default:return"\u5171\u6709"}}getInventory(e){switch(e){case"table":return this.inventoryService.tableInventory;case yt.peerId:return this.inventoryService.privateInventory;case"graveyard":return this.inventoryService.graveyardInventory;default:return this.inventoryService.commonInventory}}getGameObjects(e){return this.getInventory(e).tabletopObjects.filter(i=>"table"!=e||this.indicateAll||i.isInventoryIndicate)}getInventoryTags(e){return this.getInventory(e.location.name).dataElementMap.get(e.identifier)}onContextMenu(e,i){if(document.activeElement instanceof HTMLInputElement&&"range"!==document.activeElement.getAttribute("type")||(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;this.selectGameObject(i);let r=this.pointerDeviceService.pointers[0],s=[];"table"===i.location.name&&(this.isGMMode||i.isVisible)&&s.push({name:"\u30c6\u30fc\u30d6\u30eb\u4e0a\u304b\u3089\u63a2\u3059",action:()=>{"table"===i.location.name&&Fe.trigger("FOCUS_TABLETOP_OBJECT",{x:i.location.x,y:i.location.y,z:i.posZ+(i.altitude>0?50*i.altitude:0)})},default:"table"===i.location.name,disabled:"table"!==i.location.name,selfOnly:!0}),i.isHideIn&&s.push({name:"\u4f4d\u7f6e\u3092\u516c\u958b\u3059\u308b",action:()=>{i.owner="",dt.play(Ze.piecePut),Fe.trigger("UPDATE_INVENTORY",null)}}),(!i.isHideIn||!i.isVisible)&&s.push({name:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u308b\uff08\u30b9\u30c6\u30eb\u30b9\uff09",action:()=>{"table"===i.location.name&&!Vt.isStealthMode&&!Ue.myCursor.isGMMode&&this.modalService.open(Qi,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:Ci.OK,materialIcon:"disabled_visible"}),i.owner=yt.peerContext.userId,dt.play(Ze.sweep),Fe.call("UPDATE_INVENTORY",!0)}}),s.push(Tt),i.imageFiles.length>1&&(s.push({name:"\u753b\u50cf\u5207\u308a\u66ff\u3048",action:null,subActions:i.imageFiles.map((c,m)=>({name:i.currntImageIndex==m?"\u25c9":"\u25cb",action:()=>{i.currntImageIndex=m,dt.play(Ze.surprise),Fe.trigger("UPDATE_INVENTORY",null)},default:i.currntImageIndex==m,icon:c}))}),s.push(Tt)),s.push(i.isUseIconToOverviewImage?{name:"\u2611 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{i.isUseIconToOverviewImage=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{i.isUseIconToOverviewImage=!0,Fe.trigger("UPDATE_INVENTORY",null)}}),s.push(i.isShowChatBubble?{name:"\u2611 \u{1f4ad}\u306e\u8868\u793a",action:()=>{i.isShowChatBubble=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u{1f4ad}\u306e\u8868\u793a",action:()=>{i.isShowChatBubble=!0,Fe.trigger("UPDATE_INVENTORY",null)}}),s.push(i.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{i.isDropShadow=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{i.isDropShadow=!0,Fe.trigger("UPDATE_INVENTORY",null)}}),s.push({name:"\u753b\u50cf\u52b9\u679c",action:null,subActions:[i.isInverse?{name:"\u2611 \u53cd\u8ee2",action:()=>{i.isInverse=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u53cd\u8ee2",action:()=>{i.isInverse=!0,Fe.trigger("UPDATE_INVENTORY",null)}},i.isHollow?{name:"\u2611 \u307c\u304b\u3057",action:()=>{i.isHollow=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u307c\u304b\u3057",action:()=>{i.isHollow=!0,Fe.trigger("UPDATE_INVENTORY",null)}},i.isBlackPaint?{name:"\u2611 \u9ed2\u5857\u308a",action:()=>{i.isBlackPaint=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ed2\u5857\u308a",action:()=>{i.isBlackPaint=!0,Fe.trigger("UPDATE_INVENTORY",null)}},{name:"\u30aa\u30fc\u30e9",action:null,subActions:[{name:(-1==i.aura?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{i.aura=-1,Fe.trigger("UPDATE_INVENTORY",null)}},Tt].concat(["\u30d6\u30e9\u30c3\u30af","\u30d6\u30eb\u30fc","\u30b0\u30ea\u30fc\u30f3","\u30b7\u30a2\u30f3","\u30ec\u30c3\u30c9","\u30de\u30bc\u30f3\u30bf","\u30a4\u30a8\u30ed\u30fc","\u30db\u30ef\u30a4\u30c8"].map((c,m)=>({name:`${i.aura==m?"\u25c9":"\u25cb"} ${c}`,action:()=>{i.aura=m,Fe.trigger("UPDATE_INVENTORY",null)}})))},Tt,{name:"\u30ea\u30bb\u30c3\u30c8",action:()=>{i.isInverse=!1,i.isHollow=!1,i.isBlackPaint=!1,i.aura=-1,Fe.trigger("UPDATE_INVENTORY",null)},disabled:!i.isInverse&&!i.isHollow&&!i.isBlackPaint&&-1==i.aura}]}),s.push(Tt),s.push(i.isNotRide?{name:"\u2610 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{i.isNotRide=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2611 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{i.isNotRide=!0,Fe.trigger("UPDATE_INVENTORY",null)}}),s.push(i.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{i.isAltitudeIndicate=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{i.isAltitudeIndicate=!0,Fe.trigger("UPDATE_INVENTORY",null)}}),s.push({name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=i.altitude&&(i.altitude=0,"table"===i.location.name&&dt.play(Ze.sweep))},altitudeHande:i}),s.push(Tt),s.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(i)}}),s.push({name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a",action:()=>{this.showChatPalette(i)},disabled:"graveyard"===i.location.name}),s.push({name:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a",action:()=>{this.showStandSetting(i)}}),s.push(Tt),s.push({name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:i.getUrls().map(c=>{const m=c.value.toString();return{name:c.name?c.name:m,action:()=>{et.sameOrigin(m)?window.open(m.trim(),"_blank","noopener"):this.modalService.open(Hr,{url:m,title:i.name,subTitle:c.name})},disabled:!et.validUrl(m),error:et.validUrl(m)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:et.validUrl(m)&&!et.sameOrigin(m)}}),disabled:i.getUrls().length<=0}),s.push(Tt),s.push(i.isInventoryIndicate?{name:"\u2611 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{i.isInventoryIndicate=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{i.isInventoryIndicate=!0,Fe.trigger("UPDATE_INVENTORY",null)}});let o=[{name:"table",alias:"\u30c6\u30fc\u30d6\u30eb"},{name:"common",alias:"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"},{name:yt.peerId,alias:"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"},{name:"graveyard",alias:"\u5893\u5834"}];s.push({name:`${(o.find(c=>c.name==i.location.name)||o[1]).alias}\u304b\u3089\u79fb\u52d5`,action:null,subActions:o.filter((c,m)=>!(i.location.name==c.name||1==m&&!o.map(I=>I.name).includes(i.location.name))).map(c=>({name:`${c.alias}`,action:()=>{let m=Vt.isStealthMode;Fe.call("FAREWELL_STAND_IMAGE",{characterIdentifier:i.identifier}),i.setLocation(c.name),"table"===c.name&&i.isHideIn&&i.isVisible&&!m&&!Ue.myCursor.isGMMode&&this.modalService.open(Qi,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:Ci.OK,materialIcon:"disabled_visible"}),dt.play("graveyard"==c.name?Ze.sweep:Ze.piecePut),Fe.call("UPDATE_INVENTORY",!0)}})),disabled:!i.isVisible&&!this.isGMMode}),s.push(Tt),s.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{this.cloneGameObject(i),dt.play(Ze.piecePut)},disabled:!i.isVisible&&!this.isGMMode}),s.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b\uff08\u81ea\u52d5\u63a1\u756a\uff09",action:()=>{const c=i.clone(),m=c.name.split("_");let I;I=m.length>1&&/\d+/.test(m[m.length-1])?m.slice(0,m.length-1).join("_"):m.join("_");let Z=0;for(const fe of lt.instance.getObjects(Vt)){if(!fe.name.startsWith(I))continue;let pe=fe.name.match(/_(\d+)$/)?+RegExp.$1:0;pe>Z&&(Z=pe)}c.name=I+"_"+(Z+1),c.update(),dt.play(Ze.piecePut)},disabled:!i.isVisible&&!this.isGMMode}),"graveyard"===i.location.name?(s.push(Tt),s.push({name:"\u524a\u9664\u3059\u308b\uff08\u5b8c\u5168\u306b\u524a\u9664\uff09",action:()=>{this.deleteGameObject(i),dt.play(Ze.sweep)}})):(s.push(Tt),s.push({name:"\u524a\u9664\u3059\u308b\uff08\u5893\u5834\u3078\u79fb\u52d5\uff09",action:()=>{Fe.call("FAREWELL_STAND_IMAGE",{characterIdentifier:i.identifier}),i.setLocation("graveyard"),dt.play(Ze.sweep)}})),this.contextMenuService.open(r,s,i.name)}toggleEdit(){this.isEdit=!this.isEdit}cleanInventory(){let e=this.getTabTitle(this.selectTab),i=this.getGameObjects(this.selectTab);this.modalService.open(Qi,{title:"\u5893\u5834\u3092\u7a7a\u306b\u3059\u308b",text:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u5b8c\u5168\u306b\u524a\u9664\u3057\u307e\u3059\u304b\uff1f",helpHtml:`<b>${et.escapeHtml(e)}</b>\u306b\u5b58\u5728\u3059\u308b <b>${i.length}</b> \u4f53\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u5b8c\u5168\u306b\u524a\u9664\u3057\u307e\u3059\u3002`,type:Ci.OK_CANCEL,materialIcon:"delete_forever",action:()=>{for(const r of i)this.deleteGameObject(r);dt.play(Ze.sweep)}})}cloneGameObject(e){e.clone()}showDetail(e){Fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(r+=" - "+e.name),this.panelService.open(Gs,{title:r,left:i.x-800,top:i.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(hu,{left:i.x-250,top:i.y-175,width:620,height:350}).character=e}selectGameObject(e){Fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName,highlighting:!0})}focusGameObject(e,i){i.target instanceof HTMLElement&&(new Set(["input","button"]).has(i.target.tagName.toLowerCase())||"table"!==e.location.name||!e.isVisible&&!this.isGMMode||Fe.trigger("FOCUS_TABLETOP_OBJECT",{x:e.location.x,y:e.location.y,z:e.posZ+(e.altitude>0?50*e.altitude:0)}))}deleteGameObject(e){e.destroy(),this.changeDetector.markForCheck()}showStandSetting(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(Qp,{left:i.x-400,top:i.y-175,width:730,height:572}).character=e}trackByGameObject(e,i){return i?i.identifier:e}openUrl(e,i=null,r=null){return et.sameOrigin(e)?window.open(e.trim(),"_blank","noopener"):this.modalService.open(Hr,{url:e,title:i,subTitle:r}),!1}onInput(){this.inventoryService.sortStop=!0,this.sortStopTimerId&&clearTimeout(this.sortStopTimerId),this.sortStopTimerId=setTimeout(()=>{this.inventoryService.sortStop=!1},666)}}return n.\u0275fac=function(e){return new(e||n)(Le(Di),Le(In),Le(_1),Le(sr),Le(ai),Le(kn))},n.\u0275cmp=Zt({type:n,selectors:[["game-object-inventory"]],decls:14,vars:6,consts:[[1,"component",3,"input"],[4,"ngTemplateOutlet"],[4,"ngIf"],["class","object-container",3,"ngClass","contextmenu","click","dblclick",4,"ngFor","ngForOf","ngForTrackBy"],["style","padding-top: 6px;",4,"ngIf"],["inventoryTab",""],["inventoryViewSetting",""],["gameObjectTags",""],["dataElmTag",""],[1,"object-container",3,"ngClass","contextmenu","click","dblclick"],["class","owner-tag",3,"background-color",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"owner-tag"],[2,"padding-top","6px"],[1,"danger",3,"click"],[1,"is-sticky-top"],[1,"tab"],[4,"ngFor","ngForOf"],["name","tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],[2,"font-size","12px"],["placeholder","\u30bf\u30b0\u540d",1,"order-control",3,"ngModel","ngModelChange"],[1,"order-control",3,"ngModel","ngModelChange"],["value","ASC"],["value","DESC"],[2,"font-size","12px","padding-top","6px"],["placeholder","\u30b9\u30da\u30fc\u30b9\u533a\u5207\u308a\u3067\u30bf\u30b0\u540d \u30b9\u30e9\u30c3\u30b7\u30e5\u3067\u6539\u884c ex.\u300cHP MP / \u30e1\u30e2\u300d",2,"width","100%","box-sizing","border-box",3,"ngModel","ngModelChange"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[2,"font-size","0.8em"],["nowrap","",2,"vertical-align","middle"],["width","100%","nowrap",""],["style","float: right; font-size: smaller",4,"ngIf"],[2,"float","right","font-size","smaller"],["type","checkbox",3,"ngModel","ngModelChange"],[1,"self_only"],[1,"inventory-object"],[1,"object-name"],["title","\u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854\u30a2\u30a4\u30b3\u30f3\u3092\u4f7f\u7528",1,"indicate",2,"font-size","0.8em","padding","1px","width","24px","height","16px","margin-bottom","1px",3,"disabled","ngClass","click"],["class","face-icon",4,"ngIf","ngIfElse"],["altImage",""],[1,"game-object-name",2,"margin-left","3px","margin-right","3px"],["title","\u{1f4ad}\u306e\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"disabled","ngClass","click"],[1,"material-icons",2,"font-size","1em"],["title","\u5f71\u306e\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","1px","width","24px","height","16px","margin-bottom","1px",3,"disabled","ngClass","click"],["altShadow",""],["title","\u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"disabled","ngClass","click"],["title","\u9ad8\u5ea6\u306e\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"disabled","ngClass","click"],[1,"material-icons","rotate",2,"font-size","1em"],[2,"display","inline-block","text-align","center","font-size","xx-small","color","gray","min-width","2em"],["title","\u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"disabled","ngClass","click"],["style","font-size: 0.8em; padding: 2px 5px;","title","\u30e1\u30cb\u30e5\u30fc",3,"click",4,"ngIf"],[1,"object-tags-box",3,"ngClass"],[1,"table-cell","image-box",3,"ngClass"],[1,"aura",3,"ngClass"],["class","inverser","draggable","false",3,"src","ngClass",4,"ngIf"],[1,"table-cell"],[1,"face-icon"],["alt","",3,"src"],["alt","",2,"filter","brightness(0)",3,"ngStyle","src"],["title","\u30e1\u30cb\u30e5\u30fc",2,"font-size","0.8em","padding","2px 5px",3,"click"],["draggable","false",1,"inverser",3,"src","ngClass"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","object-tag",4,"ngIf"],[1,"object-tag"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"tag-name"],[2,"text-align","center"],[2,"display","inline-block"],[1,"tag-value-box"],[1,"hidden-spacer",2,"font-weight","bold"],["appLogging","","size","1","placeholder","",1,"input","tag-value",3,"logging.name","logging.dataElement","type","ngModel","ngModelChange"],[1,"resource-tag"],[2,"font-size","0.8em","display","inline-block","margin-right","0.5em"],["appLogging","","type","number","size","1","placeholder","Value",1,"input","resource-value",3,"logging.name","logging.dataElement","ngModel","ngModelChange"],["appLogging","","type","range","min","0",3,"logging.name","logging.dataElement","title","max","ngStyle","ngModel","ngModelChange"],["appLogging","","type","checkbox",3,"logging.name","logging.dataElement","ngModel","checked","ngModelChange","change"],["style","font-size: smaller;",4,"ngIf"],[2,"font-size","smaller"],["target","_blank",3,"ngClass","click"],[1,"url-link"],["size","1",1,"input","tag-value",2,"min-width","4em",3,"type","min","ngModel","ngModelChange"]],template:function(e,i){if(1&e&&(K(0,"div",0),Te("input",function(){return i.onInput()}),xe(1,WK,1,0,"ng-container",1),xe(2,KK,1,0,"ng-container",1),xe(3,YK,2,1,"div",2),xe(4,eY,3,10,"div",3),xe(5,tY,3,1,"div",4),J(),xe(6,iY,3,1,"ng-template",null,5,Ln),xe(8,cY,2,2,"ng-template",null,6,Ln),xe(10,xY,33,51,"ng-template",null,7,Ln),xe(12,LY,2,2,"ng-template",null,8,Ln)),2&e){const r=Wt(7),s=Wt(9);U(1),te("ngTemplateOutlet",r),U(1),te("ngTemplateOutlet",s),U(1),te("ngIf",i.getGameObjects(i.selectTab).length<1),U(1),te("ngForOf",i.getGameObjects(i.selectTab))("ngForTrackBy",i.trackByGameObject),U(1),te("ngIf","graveyard"===i.selectTab)}},directives:[wl,_n,ei,Wn,Il,Tl,ia,Aa,fi,hi,oi,es,zr,jr,Jr,Zi,xl,Cd,Vs,gs,ms,xd],pipes:[ti],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{width:100%}.box[_ngcontent-%COMP%]{border:transparent 2px solid;border-left:transparent 6px solid;margin-top:2px;padding:2px 2px 3px;box-sizing:border-box;border-bottom:1px dotted #666}.selected[_ngcontent-%COMP%]{padding:2px;border:2px dotted #666;border-left:6px solid #EFBC70}.selected.is-inventory-no-indicate[_ngcontent-%COMP%]{border-left-color:#80ccee}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;font-size:1em;min-width:1em;max-width:12em;overflow:hidden;padding:0 2px;box-sizing:border-box;white-space:nowrap}.input[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;padding:2px;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#EEE}.input[_ngcontent-%COMP%]:focus{background:#FFF}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.tab[_ngcontent-%COMP%]{padding:0;border:solid 1px #555;border-radius:.3em;overflow:hidden;display:flex;flex-flow:row nowrap;justify-content:space-around;align-items:stretch;text-align:center;margin:0;max-width:500px;background-color:#f0dabde6}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;flex:1 0 auto;flex-grow:1}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:checked{background:#555;color:#ccc}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{vertical-align:middle;outline:0;font-size:.6em;background-color:transparent;color:#444;box-sizing:border-box;margin:0;padding:2px 8px;cursor:pointer}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.is-sticky-top[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;top:0;z-index:10000}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.table-cell[_ngcontent-%COMP%]{display:table-cell}.image-box[_ngcontent-%COMP%]{padding:0;width:32px;height:32px;display:table-cell;vertical-align:top}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%}.inventory-object[_ngcontent-%COMP%]{font-size:14px;display:inline-block;vertical-align:text-top}.object-name[_ngcontent-%COMP%]{font-size:.8em;font-weight:700;padding:0 .25em}.object-tags-box[_ngcontent-%COMP%]{display:table;table-layout:fixed}.object-tag[_ngcontent-%COMP%]{display:inline-block;padding:0 .25em;vertical-align:middle}.resource-tag[_ngcontent-%COMP%]{text-align:center;vertical-align:bottom;overflow:hidden;white-space:nowrap}.resource-value[_ngcontent-%COMP%]{font-weight:700;width:4em;text-align:right;font-family:inherit}.tag-name[_ngcontent-%COMP%]{font-size:.8em;text-align:left;vertical-align:bottom;min-width:1em;max-width:12em;overflow:hidden;white-space:nowrap}.tag-value-box[_ngcontent-%COMP%]{display:table-cell;width:10px}.tag-value[_ngcontent-%COMP%]{font-size:1em;font-weight:700;width:100%;min-width:1em;max-width:12em;text-align:center;font-family:inherit}.tag-value[type=number][_ngcontent-%COMP%]{min-width:3.4em;text-align:right}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.5}.inverser.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.inverser.is-hide-in[_ngcontent-%COMP%]{filter:invert(100%)}.inverser.black-paint.is-hide-in[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #00f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 3px #aaa) drop-shadow(0 -2px 2px #fff)}.material-icons.rotate[_ngcontent-%COMP%]{transform:rotate(90deg)}button.indicate[_ngcontent-%COMP%]:disabled{border-color:transparent}button.indicate[_ngcontent-%COMP%]:disabled   .material-icons[_ngcontent-%COMP%]{color:#000}button.indicate[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:.5}button.is-active[_ngcontent-%COMP%]{background-color:#fff}button.is-active[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:1}button.link[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}button.link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button.link[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}button.link[_ngcontent-%COMP%]:disabled{color:gray}button.link[_ngcontent-%COMP%]:disabled:hover{background-color:transparent}.face-icon[_ngcontent-%COMP%]{display:inline-block;width:12px;height:12px;max-width:12px;max-height:12px;vertical-align:middle;overflow:hidden}.face-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:.2rem}.self_only[_ngcontent-%COMP%]{color:red}.order-control[_ngcontent-%COMP%]{box-sizing:border-box;height:1.6em}.object-container.is-hide-in[_ngcontent-%COMP%]{background-color:#34549966}.object-container.is-hide-in[_ngcontent-%COMP%]   .game-object-name[_ngcontent-%COMP%], .object-tags-box.is-hide-in[_ngcontent-%COMP%]{color:#ddd;filter:invert(85%)}.image-box.is-hide-in[_ngcontent-%COMP%]{filter:invert(100%)}.object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:#ddd}.object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active, .object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{color:#222}.object-container[_ngcontent-%COMP%]{position:relative}.owner-tag[_ngcontent-%COMP%]{position:absolute;font-size:8px;width:-webkit-min-content;width:-moz-min-content;width:min-content;max-width:100%;overflow:hidden;color:#f5f5f5;background-color:#1e1e1e;box-sizing:border-box;padding:2px 6px;border-radius:6px;white-space:nowrap;text-overflow:ellipsis;opacity:.9;top:1px;right:1px;pointer-events:none}.url-link[_ngcontent-%COMP%]{cursor:pointer}"],changeDetection:0}),n})();const jY=Ht.create("./assets/images/skeleton.png");let wu=(()=>{class n{constructor(){}getSkeletonOr(e){let i=e instanceof Ht?e:kt.instance.get(e);return i&&!i.isEmpty?i:jY}getEmptyOr(e){let i=e instanceof Ht?e:kt.instance.get(e);return i&&!i.isEmpty?i:Ht.Empty}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function HY(n,t){if(1&n&&(K(0,"option",11),be(1),J()),2&n){const e=t.$implicit;Ke("color",""==e.name?"gray":""),ct("value",e.identifier),ct("title",e.name),U(1),qe(""==e.name?"(\u7121\u540d\u306e\u30c6\u30fc\u30d6\u30eb)":e.name)}}function UY(n,t){if(1&n&&(K(0,"div",41)(1,"i",42),be(2),J()()),2&n){const e=ge(2);U(1),sd(e.isShowHideImages?"red-eye":"grow"),U(1),qe(e.isShowHideImages?"visibility":"visibility_off")}}function VY(n,t){if(1&n){const e=Xe();K(0,"div")(1,"button",43),Te("click",function(){return De(e),ge(2).openDistanceViewImageModal()}),be(2,"\u80cc\u666f\u753b\u50cf\u3092\u8ffd\u52a0"),J()()}if(2&n){const e=ge(2);U(1),te("disabled",!e.isEditable)}}function GY(n,t){if(1&n&&(K(0,"div",41)(1,"i",42),be(2),J()()),2&n){const e=ge(3);U(1),sd(e.isShowHideImages?"red-eye":"grow"),U(1),qe(e.isShowHideImages?"visibility":"visibility_off")}}const GI=function(n){return{blackout:n}};function qY(n,t){if(1&n){const e=Xe();K(0,"div",13),Te("click",function(){return De(e),ge(2).openDistanceViewImageModal()}),xe(1,GY,3,3,"div",14),it(2,"img",15),Ct(3,"safe"),J()}if(2&n){const e=ge(2);U(1),te("ngIf",e.getHidden(e.tableDistanceviewImage)),U(1),te("ngClass",ut(6,GI,!e.isShowHideImages&&e.getHidden(e.tableDistanceviewImage)))("src",xt(3,3,e.tableDistanceviewImage.url,"resourceUrl"),Jt)}}function WY(n,t){if(1&n&&(K(0,"div",48),be(1),J()),2&n){const e=ge(3);U(1),An("",e.progresPercent,"%")}}const KY=function(n){return{"is-hidden":n}};function YY(n,t){if(1&n){const e=Xe();Ve(0),K(1,"button",44),Te("click",function(){return De(e),ge(2).save()}),K(2,"div",45)(3,"div",32),be(4,"\u4fdd\u5b58"),J(),xe(5,WY,2,1,"div",46),J()(),K(6,"button",47),Te("click",function(){return De(e),ge(2).delete()}),be(7,"\u524a\u9664"),J(),Ge()}if(2&n){const e=ge(2);U(1),te("disabled",e.isSaveing),U(2),te("ngClass",ut(4,KY,e.isSaveing)),U(2),te("ngIf",e.isSaveing),U(1),te("disabled",e.getGameTables().length<=1)}}function ZY(n,t){if(1&n){const e=Xe();Ve(0),K(1,"button",49),Te("click",function(){return De(e),ge(2).restore()}),be(2,"\u5143\u306b\u623b\u3059"),J(),Ge()}}const XY=function(n){return{disabled:n}};function QY(n,t){if(1&n){const e=Xe();Ve(0),K(1,"div",12)(2,"div")(3,"b"),be(4,"\u753b\u50cf"),J(),K(5,"div",13),Te("click",function(){return De(e),ge().openBgImageModal()}),xe(6,UY,3,3,"div",14),it(7,"img",15),Ct(8,"safe"),J()(),K(9,"div")(10,"b"),be(11,"\u80cc\u666f"),J(),xe(12,VY,3,1,"div",10),xe(13,qY,4,8,"div",16),J()(),K(14,"div")(15,"label",17),be(16,"Name\uff1a"),K(17,"input",18),Te("ngModelChange",function(r){return De(e),ge().tableName=r}),J()()(),K(18,"div")(19,"label",17),be(20,"Width\uff1a"),K(21,"input",19),Te("ngModelChange",function(r){return De(e),ge().tableWidth=r}),J()(),K(22,"input",20),Te("ngModelChange",function(r){return De(e),ge().tableWidth=r}),J()(),K(23,"div")(24,"label",17),be(25,"Height\uff1a"),K(26,"input",21),Te("ngModelChange",function(r){return De(e),ge().tableHeight=r}),J()(),K(27,"input",20),Te("ngModelChange",function(r){return De(e),ge().tableHeight=r}),J()(),K(28,"div")(29,"label",17),be(30,"\u30b0\u30ea\u30c3\u30c9\uff1a "),K(31,"select",22),Te("ngModelChange",function(r){return De(e),ge().tableGridType=r}),K(32,"option",23),be(33,"\u306a\u3057"),J(),K(34,"option",24),be(35,"\u30b9\u30af\u30a8\u30a2"),J(),K(36,"option",25),be(37,"\u30d8\u30af\u30b9\uff08\u7e26\u63c3\u3048\uff09"),J(),K(38,"option",26),be(39,"\u30d8\u30af\u30b9\uff08\u6a2a\u63c3\u3048\uff09"),J()()(),K(40,"label",27),be(41,"\u8272\uff1a "),K(42,"select",28),Te("ngModelChange",function(r){return De(e),ge().tableGridColor=r}),K(43,"option",29),be(44,"\u9ed2"),J(),K(45,"option",30),be(46,"\u767d"),J()()()(),K(47,"div")(48,"label",17)(49,"input",31),Te("ngModelChange",function(r){return De(e),ge().tableGridNumberShow=r}),J(),K(50,"span",32),be(51,"\u30b0\u30ea\u30c3\u30c9\u306e\u5ea7\u6a19\u756a\u53f7\u3092\u8868\u793a"),J()()(),K(52,"div")(53,"label",17),be(54,"\u80cc\u666f\u30d5\u30a3\u30eb\u30bf\uff1a "),K(55,"select",33),Te("ngModelChange",function(r){return De(e),ge().tableDistanceviewFilter=r}),K(56,"option",34),be(57,"\u306a\u3057"),J(),K(58,"option",35),be(59,"\u30db\u30ef\u30a4\u30c8"),J(),K(60,"option",36),be(61,"\u30d6\u30e9\u30c3\u30af"),J()()()(),it(62,"hr"),K(63,"div")(64,"label",17)(65,"input",37),Te("ngModelChange",function(r){return De(e),ge().tableGridShow=r}),J(),be(66," \u30b0\u30ea\u30c3\u30c9\u3092\u5e38\u306b\u8868\u793a"),K(67,"sup",38),be(68,"*"),J()(),K(69,"label",39)(70,"input",40),Te("ngModelChange",function(r){return De(e),ge().tableGridSnap=r}),J(),be(71," \u30b9\u30ca\u30c3\u30d7"),K(72,"sup",38),be(73,"*"),J()(),xe(74,YY,8,6,"ng-container",10),xe(75,ZY,3,0,"ng-container",10),J(),Ge()}if(2&n){const e=ge();U(6),te("ngIf",e.getHidden(e.tableBackgroundImage)),U(1),te("ngClass",ut(41,GI,!e.isShowHideImages&&e.getHidden(e.tableBackgroundImage)))("src",xt(8,38,e.tableBackgroundImage.url,"resourceUrl"),Jt),U(5),te("ngIf",!e.tableDistanceviewImage.url),U(1),te("ngIf",e.tableDistanceviewImage.url),U(4),te("ngModel",e.tableName)("disabled",!e.isEditable),U(4),ct("title",e.tableWidth),ct("min",e.minSize),ct("max",e.maxSize),te("ngModel",e.tableWidth)("disabled",!e.isEditable),U(1),ct("min",e.minSize),ct("max",e.maxSize),te("ngModel",e.tableWidth)("disabled",!e.isEditable),U(4),ct("title",e.tableHeight),ct("min",e.minSize),ct("max",e.maxSize),te("ngModel",e.tableHeight)("disabled",!e.isEditable),U(1),ct("min",e.minSize),ct("max",e.maxSize),te("ngModel",e.tableHeight)("disabled",!e.isEditable),U(4),te("ngModel",e.tableGridType)("disabled",!e.isEditable),U(11),te("ngModel",e.tableGridColor)("disabled",!e.isEditable||-1==e.tableGridType),U(7),te("ngModel",e.tableGridNumberShow)("disabled",!e.isEditable||-1==e.tableGridType),U(1),te("ngClass",ut(43,XY,!e.isEditable||-1==e.tableGridType)),U(5),te("ngModel",e.tableDistanceviewFilter)("disabled",!e.isEditable),U(10),te("ngModel",e.tableGridShow),U(5),te("ngModel",e.tableGridSnap),U(4),te("ngIf",!e.isDeleted),U(1),te("ngIf",e.isDeleted)}}function JY(n,t){1&n&&(Ve(0),K(1,"div",50),be(2,"\u203b\u30c6\u30fc\u30d6\u30eb\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b\u300d\u304b\u3089\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),J(),Ge())}const eZ=function(n){return{"red-eye":n}};let qI=(()=>{class n{constructor(e,i,r,s,o){this.changeDetector=e,this.modalService=i,this.saveDataService=r,this.imageService=s,this.panelService=o,this.minSize=1,this.maxSize=100,this.isShowHideImages=!1,this.selectedTable=null,this.selectedTableXml="",this.isSaveing=!1,this.progresPercent=0}get tableBackgroundImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.imageIdentifier:null)}get tableDistanceviewImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.backgroundImageIdentifier:null)}get tableName(){return this.selectedTable.name}set tableName(e){this.isEditable&&(this.selectedTable.name=e)}get tableWidth(){return this.selectedTable.width}set tableWidth(e){this.isEditable&&(this.selectedTable.width=e)}get tableHeight(){return this.selectedTable.height}set tableHeight(e){this.isEditable&&(this.selectedTable.height=e)}get tableGridColor(){return this.selectedTable.gridColor}set tableGridColor(e){this.isEditable&&(this.selectedTable.gridColor=e)}get tableGridShow(){return this.tableSelecter.gridShow}set tableGridShow(e){this.tableSelecter.gridShow=e,Fe.trigger("UPDATE_GAME_OBJECT",this.tableSelecter.toContext())}get tableGridSnap(){return this.tableSelecter.gridSnap}set tableGridSnap(e){this.tableSelecter.gridSnap=e}get tableGridType(){return this.selectedTable.gridType}set tableGridType(e){this.isEditable&&(this.selectedTable.gridType=Number(e))}get tableGridNumberShow(){return this.selectedTable.isShowNumber}set tableGridNumberShow(e){this.selectedTable.isShowNumber=e,Fe.trigger("UPDATE_GAME_OBJECT",this.tableSelecter.toContext())}get tableDistanceviewFilter(){return this.selectedTable.backgroundFilterType}set tableDistanceviewFilter(e){this.isEditable&&(this.selectedTable.backgroundFilterType=e)}get tableSelecter(){return lr.instance}get isEmpty(){return!this.tableSelecter||!this.tableSelecter.viewTable}get isDeleted(){return!this.selectedTable||null==lt.instance.get(this.selectedTable.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}ngOnInit(){Promise.resolve().then(()=>{this.modalService.title=this.panelService.title="\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a"}),this.selectedTable=this.tableSelecter.viewTable,Fe.register(this).on("DELETE_GAME_OBJECT",2e3,e=>{if(!this.selectedTable||e.data.identifier!==this.selectedTable.identifier)return;let i=lt.instance.get(e.data.identifier);null!==i&&(this.selectedTableXml=i.toXml())})}ngAfterViewInit(){}ngOnDestroy(){Fe.unregister(this)}selectGameTable(e){Fe.call("SELECT_GAME_TABLE",{identifier:e},yt.peerId),this.selectedTable=lt.instance.get(e),this.selectedTableXml=""}getGameTables(){return lt.instance.getObjects(Li)}createGameTable(){let e=new Li;e.name="\u767d\u7d19\u306e\u30c6\u30fc\u30d6\u30eb",e.imageIdentifier="testTableBackgroundImage_image",e.initialize(),this.selectGameTable(e.identifier)}save(){var e=this;return(0,en.Z)(function*(){!e.selectedTable||e.isSaveing||(e.isSaveing=!0,e.progresPercent=0,e.selectedTable.selected=!0,yield e.saveDataService.saveGameObjectAsync(e.selectedTable,"fly_map_"+e.selectedTable.name,i=>{e.progresPercent=i}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500))})()}delete(){!this.isEmpty&&this.selectedTable&&(this.selectedTableXml=this.selectedTable.toXml(),this.selectedTable.destroy())}restore(){if(this.selectedTable&&this.selectedTableXml){let e=Zn.instance.parseXml(this.selectedTableXml);this.selectGameTable(e.identifier),this.selectedTableXml=""}}getHidden(e){const i=yn.get(e.identifier);return!!i&&i.hide}openBgImageModal(){if(this.isDeleted)return;let e=[];this.selectedTable&&this.selectedTable.imageIdentifier&&(e=[this.selectedTable.imageIdentifier]),this.modalService.open(Lo,{currentImageIdentifires:e}).then(i=>{!this.selectedTable||!i||(this.selectedTable.imageIdentifier=i)})}openDistanceViewImageModal(){if(this.isDeleted)return;let e=[];this.selectedTable&&this.selectedTable.backgroundImageIdentifier&&(e=[this.selectedTable.backgroundImageIdentifier]),this.modalService.open(Lo,{isAllowedEmpty:!0,currentImageIdentifires:e}).then(i=>{!this.selectedTable||!i||(this.selectedTable.backgroundImageIdentifier=i)})}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(Qi,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:Ci.OK_CANCEL,materialIcon:"visibility",action:()=>{this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}}return n.\u0275fac=function(e){return new(e||n)(Le(Di),Le(kn),Le(Ir),Le(wu),Le(In))},n.\u0275cmp=Zt({type:n,selectors:[["game-table-setting"]],decls:15,vars:9,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[2,"margin-bottom","2px","font-size","smaller",3,"click"],["size","10",2,"width","100%","max-width","155px",3,"ngModel","change"],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[2,"float","right","margin-top","3px","margin-right","3px"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[4,"ngIf"],[3,"value","title"],[1,"images-select"],[2,"position","relative","overflow","hidden","cursor","pointer",3,"click"],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["height","120",3,"ngClass","src"],["style","position: relative; overflow: hidden; cursor: pointer",3,"click",4,"ngIf"],[1,"self-setting"],["placeholder","Name",3,"ngModel","disabled","ngModelChange"],["type","range","name","tableWidth",3,"ngModel","title","min","max","disabled","ngModelChange"],["type","number",2,"width","5em",3,"ngModel","min","max","disabled","ngModelChange"],["type","range","name","tableHeight",3,"ngModel","title","min","max","disabled","ngModelChange"],["name","tableGridType",3,"ngModel","disabled","ngModelChange"],["value","-1"],["value","0"],["value","1"],["value","2"],[1,"self-setting",2,"margin-left","3px"],["name","tableGridColor",3,"ngModel","disabled","ngModelChange"],["value","#000000e6"],["value","#dddddde6"],["type","checkbox","name","tableGridNumberShow",3,"ngModel","disabled","ngModelChange"],[3,"ngClass"],["name","tableDistanceviewFilter",3,"ngModel","disabled","ngModelChange"],["value",""],["value","white"],["value","black"],["type","checkbox","name","tableGridShow",3,"ngModel","ngModelChange"],[1,"self-only"],[1,"self-setting",2,"margin-left","1em"],["type","checkbox","name","tableGridSnap",3,"ngModel","ngModelChange"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons",2,"margin-right","2px","font-size","16px","display","block"],[2,"height","120px",3,"disabled","click"],[2,"margin-left","2em",3,"disabled","click"],[2,"position","relative"],["class","progress",4,"ngIf"],[1,"danger",3,"disabled","click"],[1,"progress"],[3,"click"],[2,"font-size","12px"]],template:function(e,i){1&e&&(K(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Te("click",function(){return i.createGameTable()}),be(4,"\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b"),J()(),K(5,"select",3),Te("change",function(s){return i.selectGameTable(s.target.value)}),xe(6,HY,2,5,"option",4),J()(),K(7,"div",5)(8,"div",6)(9,"label",7)(10,"input",8),Te("click",function(s){return i.onShowHiddenImages(s)}),J(),K(11,"i",9),be(12),J()()(),xe(13,QY,76,45,"ng-container",10),J()(),xe(14,JY,3,0,"ng-container",10)),2&e&&(U(5),te("ngModel",null==i.selectedTable?null:i.selectedTable.identifier),U(1),te("ngForOf",i.getGameTables()),U(4),ct("checked",i.isShowHideImages?"checked":""),U(1),te("ngClass",ut(7,eZ,i.isShowHideImages)),U(1),qe(i.isShowHideImages?"visibility":"visibility_off"),U(1),te("ngIf",!i.isEmpty||i.selectedTable),U(1),te("ngIf",i.isEmpty))},directives:[es,hi,oi,ei,zr,jr,Wn,_n,fi,ms,gs,So,Io,Jr],pipes:[ti],styles:["[_nghost-%COMP%]{display:block}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.images-select[_ngcontent-%COMP%]{display:flex}input[type=number][_ngcontent-%COMP%]{text-align:right}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;font-size:.9em}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.blackout[_ngcontent-%COMP%]{filter:blur(12px) grayscale(70%)}.self-only[_ngcontent-%COMP%]{color:red}img[_ngcontent-%COMP%]{transition:all .1s 0s ease}.self-setting[_ngcontent-%COMP%]{font-weight:bolder;font-size:smaller}.disabled[_ngcontent-%COMP%]{color:gray;font-weight:400}"]}),n})();function tZ(n,t){if(1&n){const e=Xe();K(0,"button",21),Te("click",function(){De(e);const r=ge().$implicit;return ge().play(r)}),K(1,"i",22),be(2,"play_arrow"),J(),be(3,"\u8a66\u8074"),K(4,"sup",23),be(5,"*"),J()()}2&n&&te("disabled",!ge().$implicit.isReady)}function nZ(n,t){if(1&n){const e=Xe();K(0,"button",21),Te("click",function(){return De(e),ge(2).stop()}),K(1,"i",22),be(2,"stop"),J(),be(3,"\u8a66\u8074"),K(4,"sup",23),be(5,"*"),J()()}2&n&&te("disabled",!ge().$implicit.isReady)}function iZ(n,t){if(1&n){const e=Xe();K(0,"button",21),Te("click",function(){De(e);const r=ge().$implicit;return ge().playBGM(r)}),K(1,"i",22),be(2,"loop"),J(),be(3,"\uff22\uff27\uff2d"),J()}2&n&&te("disabled",!ge().$implicit.isReady)}function rZ(n,t){if(1&n){const e=Xe();K(0,"button",21),Te("click",function(){De(e);const r=ge().$implicit;return ge().stopBGM(r)}),K(1,"i",22),be(2,"stop"),J(),be(3,"\uff22\uff27\uff2d"),J()}2&n&&te("disabled",!ge().$implicit.isReady)}function sZ(n,t){1&n&&(K(0,"span",20)(1,"b"),be(2,"\u3010\u8a66\u8074\u4e2d\u3011"),J()())}function oZ(n,t){1&n&&(K(0,"span",20)(1,"b"),be(2,"\u3010\uff22\uff27\uff2d\u3011"),J()())}function aZ(n,t){1&n&&(K(0,"span",20)(1,"b"),be(2,"\u3010\u8a66\u8074/BGM\u3011"),J()())}function lZ(n,t){if(1&n&&(Ve(0),xe(1,oZ,3,0,"span",18),xe(2,aZ,3,0,"span",18),Ge()),2&n){const e=ge().$implicit,i=ge();U(1),te("ngIf",e!=(null==i.auditionPlayer?null:i.auditionPlayer.audio)||e==(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&(null==i.auditionPlayer?null:i.auditionPlayer.paused)),U(1),te("ngIf",e===(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&!(null!=i.auditionPlayer&&i.auditionPlayer.paused))}}const cZ=function(n){return{last:n}};function uZ(n,t){if(1&n&&(K(0,"div",16),xe(1,tZ,6,1,"button",17),xe(2,nZ,6,1,"button",17),xe(3,iZ,4,1,"button",17),xe(4,rZ,4,1,"button",17),xe(5,sZ,3,0,"span",18),xe(6,lZ,3,2,"ng-container",19),K(7,"span",20),be(8),J()()),2&n){const e=t.$implicit,i=t.last,r=ge();te("ngClass",ut(10,cZ,i)),U(1),te("ngIf",e!==(null==r.auditionPlayer?null:r.auditionPlayer.audio)||(null==r.auditionPlayer?null:r.auditionPlayer.paused)),U(1),te("ngIf",e===(null==r.auditionPlayer?null:r.auditionPlayer.audio)&&!(null!=r.auditionPlayer&&r.auditionPlayer.paused)),U(1),te("ngIf",e!==(null==r.jukebox?null:r.jukebox.audio)),U(1),te("ngIf",e===(null==r.jukebox?null:r.jukebox.audio)),U(1),te("ngIf",e===(null==r.auditionPlayer?null:r.auditionPlayer.audio)&&!(null!=r.auditionPlayer&&r.auditionPlayer.paused)&&e!=(null==r.jukebox?null:r.jukebox.audio)),U(1),te("ngIf",e===(null==r.jukebox?null:r.jukebox.audio)),U(1),Ke("font-weight",e===(null==r.jukebox?null:r.jukebox.audio)?"bolder":"normal"),U(1),qe(e.name)}}function dZ(n,t){1&n&&(K(0,"div",24)(1,"small")(2,"b"),be(3,"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u3053\u3053\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002"),J()()())}let fZ=(()=>{class n{constructor(e,i,r){this.modalService=e,this.panelService=i,this.ngZone=r,this.auditionPlayer=new At,this.lazyUpdateTimer=null}get volume(){return At.volume}set volume(e){At.volume=e,Fe.trigger("CHANGE_JUKEBOX_VOLUME",null)}get auditionVolume(){return At.auditionVolume}set auditionVolume(e){At.auditionVolume=e,Fe.trigger("CHANGE_JUKEBOX_VOLUME",null)}get audios(){return Lt.instance.audios.filter(e=>!e.isHidden)}get jukebox(){return lt.instance.get("Jukebox")}get percentAuditionVolume(){return Math.floor(100*At.auditionVolume)}set percentAuditionVolume(e){At.auditionVolume=e/100}get percentVolume(){return Math.floor(100*At.volume)}set percentVolume(e){At.volume=e/100}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30b8\u30e5\u30fc\u30af\u30dc\u30c3\u30af\u30b9"),this.auditionPlayer.volumeType=qa.AUDITION,Fe.register(this).on("*",e=>{e.eventName.startsWith("FILE_")&&this.lazyNgZoneUpdate()})}ngOnDestroy(){Fe.unregister(this),this.stop()}play(e){this.auditionPlayer.play(e)}stop(){this.auditionPlayer.stop()}playBGM(e){this.jukebox.play(e.identifier,!0)}stopBGM(e){this.jukebox.audio===e&&this.jukebox.stop()}handleFileSelect(e){let i=e.target,r=i.files;r.length&&Bo.instance.load(r),i.value=""}lazyNgZoneUpdate(){null===this.lazyUpdateTimer&&(this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,this.ngZone.run(()=>{})},100))}}return n.\u0275fac=function(e){return new(e||n)(Le(kn),Le(In),Le(vn))},n.\u0275cmp=Zt({type:n,selectors:[["app-jukebox"]],decls:52,vars:10,consts:[[1,"header",2,"position","sticky","top","0px"],[1,"self-only"],[1,"material-icons",2,"font-size","22px"],["type","range","min","0","max","1","step","0.01",2,"width","53%",3,"ngModel","title","ngModelChange"],[2,"white-space","nowrap"],["type","number","min","0","max","100","step","1",2,"width","3em",3,"ngModel","ngModelChange"],[2,"font-size","smaller","padding-left","3px"],[2,"margin-bottom","3px"],["class","box","style","white-space: nowrap; text-overflow: ellipsis; overflow: hidden",3,"ngClass",4,"ngFor","ngForOf"],["style","padding: 1em 0px; text-align: center",4,"ngIf"],[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","audio/*",2,"display","none",3,"change"],[2,"font-size","12px","margin-top","3px"],[2,"font-size","12px"],[1,"box",2,"white-space","nowrap","text-overflow","ellipsis","overflow","hidden",3,"ngClass"],[3,"disabled","click",4,"ngIf"],["style","padding-left: 2px",4,"ngIf"],[4,"ngIf"],[2,"padding-left","2px"],[3,"disabled","click"],[1,"material-icons"],[1,"self-only",2,"font-size","larger"],[2,"padding","1em 0px","text-align","center"]],template:function(e,i){1&e&&(K(0,"div",0)(1,"div")(2,"b"),be(3,"\u8a66\u8074\u97f3\u91cf"),K(4,"sup",1),be(5,"*"),J(),be(6,"\uff1a"),J(),K(7,"i",2),be(8),J(),K(9,"input",3),Te("ngModelChange",function(s){return i.auditionVolume=s}),J(),K(10,"span",4)(11,"input",5),Te("ngModelChange",function(s){return i.percentAuditionVolume=s}),J(),K(12,"b",6),be(13,"%"),J()()(),K(14,"div")(15,"b"),be(16,"\u518d\u751f\u97f3\u91cf"),K(17,"sup",1),be(18,"*"),J(),be(19,"\uff1a"),J(),K(20,"i",2),be(21),J(),K(22,"input",3),Te("ngModelChange",function(s){return i.volume=s}),J(),K(23,"span",4)(24,"input",5),Te("ngModelChange",function(s){return i.percentVolume=s}),J(),K(25,"b",6),be(26,"%"),J()()()(),K(27,"div",7),xe(28,uZ,9,12,"div",8),xe(29,dZ,4,0,"div",9),J(),K(30,"label")(31,"div",10)(32,"div")(33,"i",11),be(34,"playlist_add"),J()(),K(35,"div"),be(36,"\u3053\u3053\u306b\u97f3\u697d\u3092\u30c9\u30ed\u30c3\u30d7"),J(),K(37,"div",12),be(38,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),J(),K(39,"input",13),Te("change",function(s){return i.handleFileSelect(s)}),J(),K(40,"div",12),it(41,"br"),be(42,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d10MB\u307e\u3067"),J()()(),K(43,"div",14),be(44,"\u203b\u300c\u8a66\u8074"),K(45,"sup",1),be(46,"*"),J(),be(47,"\u300d\u306f\u81ea\u5206\u306e\u30b9\u30d4\u30fc\u30ab\u30fc\u3060\u3051\u3067\u97f3\u697d\u30921\u56de\u518d\u751f\u3057\u307e\u3059\u3002"),J(),K(48,"div",15),be(49,"\u203b\u300cBGM\u300d\u306f\u30eb\u30fc\u30e0\u5185\u306e\u5168\u54e1\u30671\u3064\u306e\u97f3\u697d\u3092\u30eb\u30fc\u30d7\u518d\u751f\u3057\u307e\u3059\u3002"),J(),K(50,"div",15),be(51,"\u203b\u73fe\u884c\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u306b\u306f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u542b\u307e\u308c\u307e\u305b\u3093\u3002\uff08\u6bce\u56de\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u304c\u5fc5\u8981\u3067\u3059\uff09"),J()),2&e&&(U(8),qe(0==i.auditionVolume?"volume_off":i.auditionVolume<=.5?"volume_down":"volume_up"),U(1),ct("title",i.percentAuditionVolume+"%"),te("ngModel",i.auditionVolume),U(2),te("ngModel",i.percentAuditionVolume),U(10),qe(0==i.volume?"volume_off":i.volume<=.5?"volume_down":"volume_up"),U(1),ct("title",i.percentVolume+"%"),te("ngModel",i.volume),U(2),te("ngModel",i.percentVolume),U(4),te("ngForOf",i.audios),U(1),te("ngIf",i.audios.length<1))},directives:[ms,fi,hi,oi,So,Io,gs,ei,Wn,_n],styles:['[_nghost-%COMP%]{display:block}.drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.box[_ngcontent-%COMP%]{font-size:smaller;border-bottom:1px dotted #888;vertical-align:baseline}.box.last[_ngcontent-%COMP%]{border-bottom:0px none transparent}.volume[_ngcontent-%COMP%]{display:inline-block;width:3em;text-align:right}input[type=number][_ngcontent-%COMP%]{text-align:right}.self-only[_ngcontent-%COMP%]{color:red}button[_ngcontent-%COMP%]   .self-only[_ngcontent-%COMP%]{vertical-align:text-top}.box[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:12px;height:26px;width:5.6em;margin-left:0;margin-right:0}button[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:12px}.header[_ngcontent-%COMP%]{background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border-bottom:dotted 1px #888}']}),n})();const hZ=["content"],pZ=["*"];let gZ=(()=>{class n{constructor(e){this.modalService=e}clickBackground(e){e.target===e.currentTarget&&this.resolve()}resolve(){this.modalService.resolve(null)}reject(){this.modalService.reject()}}return n.\u0275fac=function(e){return new(e||n)(Le(kn))},n.\u0275cmp=Zt({type:n,selectors:[["modal"]],viewQuery:function(e,i){if(1&e&&on(hZ,7,Rr),2&e){let r;sn(r=an())&&(i.content=r.first)}},ngContentSelectors:pZ,decls:13,vars:3,consts:[[1,"component"],[1,"modal-background",3,"click"],[1,"modal-panel"],[1,"title"],[1,"title-button"],[3,"click"],[1,"material-icons",2,"font-size","14px"],[1,"scrollable-panel"],["content",""]],template:function(e,i){1&e&&(g_(),K(0,"div",0)(1,"div",1),Te("click",function(s){return i.clickBackground(s)}),J(),K(2,"div",2)(3,"div",3)(4,"div",4)(5,"button",5),Te("click",function(){return i.resolve()}),K(6,"i",6),be(7,"close"),J()()(),be(8),J(),K(9,"div",7),m_(10),it(11,"div",null,8),J()()()),2&e&&(U(1),te("@bgInOut","in"),U(1),te("@flyInOut","in"),U(6),An(" ",i.modalService.title," "))},styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;top:0;bottom:0;left:0;right:0;z-index:1899999;display:flex;align-items:center;justify-content:center;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.modal-background[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;color:#ccc;background-color:#1e1e1e4d;top:0;bottom:0;left:0;right:0;z-index:-1}.modal-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:hidden;color:#444;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;height:auto;max-height:calc(100% - 10px);width:800px;max-width:100%}.title[_ngcontent-%COMP%]{position:relative;overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;padding:2px 5px;width:100%;background-color:#ccc;color:#444}.title-button[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#444}.header[_ngcontent-%COMP%], .content[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]{padding:10px}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;max-height:calc(100vh - 41px);width:100%;padding:8px}"],data:{animation:[xn("flyInOut",[Bt("void => *",[Ft("100ms ease-out",nn([Ye({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),Ye({transform:"scale(1.0, 1.0)",opacity:"1.0",offset:1})]))]),Bt("* => void",[Ft(100,Ye({transform:"scale(0, 0)"}))])]),xn("bgInOut",[ip("in",Ye({"background-color":"rgba(30, 30, 30, 0.4)"})),Bt("void => *",[Ye({"background-color":"rgba(30, 30, 30, 0.0)"}),Ft(200)]),Bt("* => void",[Ft(200,Ye({"background-color":"rgba(30, 30, 30, 0.0)"}))])])]}}),n})();var gn=(()=>(function(n){n.N="n",n.E="e",n.W="w",n.S="s",n.NE="ne",n.NW="nw",n.SE="se",n.SW="sw"}(gn||(gn={})),gn))();class mZ{constructor(t,e){this.target=t,this.type=e,this.input=null,this.handle=null,this.width=12,this.initialize()}initialize(){this.handle=this.target.ownerDocument.createElement("div"),this.handle.classList.add("ui-resize-handler-"+this.type),this.input=new Ls(this.handle),this.target.appendChild(this.handle);let t=this.handle.style;switch(t.position="absolute",t.zIndex="1",t.backgroundColor="transparent",this.type){case gn.N:t.top=3*-this.width/4+"px",t.left="0px",t.right="0px",t.height=`${this.width}px`;break;case gn.E:t.top="0px",t.bottom="0px",t.right=3*-this.width/4+"px",t.width=`${this.width}px`;break;case gn.W:t.top="0px",t.bottom="0px",t.left=3*-this.width/4+"px",t.width=`${this.width}px`;break;case gn.S:t.bottom=3*-this.width/4+"px",t.left="0px",t.right="0px",t.height=`${this.width}px`;break;case gn.NE:t.top=3*-this.width/4+"px",t.right=3*-this.width/4+"px",t.width=3*this.width/2+"px",t.height=3*this.width/2+"px",t.zIndex="2";break;case gn.NW:t.top=3*-this.width/4+"px",t.left=3*-this.width/4+"px",t.width=3*this.width/2+"px",t.height=3*this.width/2+"px",t.zIndex="2";break;case gn.SE:t.bottom=3*-this.width/4+"px",t.right=3*-this.width/4+"px",t.width=3*this.width/2+"px",t.height=3*this.width/2+"px",t.zIndex="2";break;case gn.SW:t.bottom=3*-this.width/4+"px",t.left=3*-this.width/4+"px",t.width=3*this.width/2+"px",t.height=3*this.width/2+"px",t.zIndex="2"}this.cursor(!0)}destroy(){this.handle.remove(),this.input.destroy()}cursor(t){let e=this.handle.style;if(t)switch(this.type){case gn.N:e.cursor="ns-resize";break;case gn.E:case gn.W:e.cursor="ew-resize";break;case gn.S:e.cursor="ns-resize";break;case gn.NE:e.cursor="nesw-resize";break;case gn.NW:case gn.SE:e.cursor="nwse-resize";break;case gn.SW:e.cursor="nesw-resize"}else e.cursor="default"}}let _Z=(()=>{class n{constructor(e,i){this.ngZone=e,this.elementRef=i,this.boundsSelector="body",this.stackSelector="",this.minWidth=100,this.minHeight=100,this.ostart=new Cn,this.onmove=new Cn,this.onend=new Cn,this.handleMap=new Map,this._isDisable=!1,this._align="normal",this.startPosition={left:0,top:0,width:0,height:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={left:0,top:0,width:0,height:0}}set isDisable(e){this._isDisable=e,this.initialize()}set align(e){this._align=e,this.initialize()}get handleTypes(){return this._isDisable||"none"===this._align?[]:"horizontal"===this._align?[gn.E,gn.W]:"vertical"===this._align?[gn.N,gn.S]:[gn.N,gn.E,gn.W,gn.S,gn.NE,gn.NW,gn.SE,gn.SW]}ngAfterViewInit(){this.initialize(),this.setForeground()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.handleMap.forEach(e=>e.destroy()),this.handleMap.clear(),this.handleTypes.forEach(e=>{let i=new mZ(this.elementRef.nativeElement,e);this.handleMap.set(e,i),i.input.onStart=r=>this.onResizeStart(r,i),i.input.onMove=r=>this.onResizeMove(r,i),i.input.onEnd=r=>this.onResizeEnd(r,i),i.input.onContextMenu=r=>this.onContextMenu(r,i)})})}cancel(){this.handleMap.forEach(e=>e.input.cancel())}destroy(){this.handleMap.forEach(e=>e.destroy()),this.handleMap.clear()}onResizeStart(e,i){if(this._isDisable||1===e.button||2===e.button)return this.cancel();this.setForeground(),this.handleMap.forEach(r=>{r!==i&&r.input.cancel()}),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=i.input.pointer,this.prevTrans={left:0,top:0,width:0,height:0},e.stopPropagation()}onResizeMove(e,i){let r={left:0,top:0,width:i.input.pointer.x-this.startPointer.x,height:i.input.pointer.y-this.startPointer.y};switch(i.type){case gn.N:case gn.S:r.width=0;break;case gn.E:case gn.W:r.height=0}switch(i.type){case gn.SW:r.left=r.width,r.width*=-1;break;case gn.NE:r.top=r.height,r.height*=-1;break;case gn.E:case gn.S:case gn.SE:break;case gn.N:case gn.W:case gn.NW:r.left=r.width,r.top=r.height,r.width*=-1,r.height*=-1}r.width+this.startPosition.width<this.minWidth&&(r.width=this.minWidth-this.startPosition.width,r.left=0!==r.left?-r.width:r.left),r.height+this.startPosition.height<this.minHeight&&(r.height=this.minHeight-this.startPosition.height,r.top=0!==r.top?-r.height:r.top);let o=this.calcCorrectionPosition({left:r.left-this.prevTrans.left,top:r.top-this.prevTrans.top,width:r.width-this.prevTrans.width,height:r.height-this.prevTrans.height});r.left+=o.left,r.top+=o.top,r.width+=o.width,r.height+=o.height,this.elementRef.nativeElement.style.left=r.left+this.startPosition.left+"px",this.elementRef.nativeElement.style.top=r.top+this.startPosition.top+"px",this.elementRef.nativeElement.style.width=r.width+this.startPosition.width+"px",this.elementRef.nativeElement.style.height=r.height+this.startPosition.height+"px",this.prevTrans=r,e.cancelable&&e.preventDefault(),e.stopPropagation()}onResizeEnd(e,i){i.input.isDragging&&e.cancelable&&e.preventDefault(),e.stopPropagation()}onContextMenu(e,i){e.stopPropagation()}calcCorrectionPosition(e={left:0,top:0,width:0,height:0}){let i={left:0,top:0,width:0,height:0},r=this.elementRef.nativeElement.getBoundingClientRect(),s=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();return s.right<r.right+e.left+e.width&&(i.width+=s.right-(r.right+e.left+e.width)),r.left+e.left<s.left&&(i.left+=s.left-(r.left+e.left),i.width-=i.left),s.bottom<r.bottom+e.top+e.height&&(i.height+=s.bottom-(r.bottom+e.top+e.height)),r.top+e.top<s.top&&(i.top+=s.top-(r.top+e.top),i.height-=i.top),i}calcElementPosition(e){let i=window.getComputedStyle(e);return{left:Pi.relation(i.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),top:Pi.relation(i.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),width:Pi.relation(i.width,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),height:Pi.relation(i.height,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight)}}setForeground(){if(this.stackSelector.length<1)return;let e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),i=0,r=99999;e.forEach(s=>{let o=parseInt(s.style.zIndex);i<o&&(i=o),o<r&&(r=o)}),!(i<=parseInt(this.elementRef.nativeElement.style.zIndex))&&(e.forEach(s=>{s.style.zIndex=parseInt(s.style.zIndex)-r+""}),this.elementRef.nativeElement.style.zIndex=i+1+"")}}return n.\u0275fac=function(e){return new(e||n)(Le(vn),Le(_i))},n.\u0275dir=Xt({type:n,selectors:[["","appResizable",""]],inputs:{boundsSelector:["resizable.bounds","boundsSelector"],stackSelector:["resizable.stack","stackSelector"],minWidth:["resizable.minWidth","minWidth"],minHeight:["resizable.minHeight","minHeight"],isDisable:["resizable.disable","isDisable"],align:["resizable.align","align"]},outputs:{ostart:"resizable.start",onmove:"resizable.move",onend:"resizable.end"}}),n})();const $Z=["draggablePanel"],vZ=["scrollablePanel"],bZ=["content"],yZ=["titleBar"];function CZ(n,t){if(1&n){const e=Xe();K(0,"button",11),Te("click",function(){return De(e),ge().toggleRotate()}),K(1,"i",12),be(2,"pivot_table_chart"),J()()}}function xZ(n,t){if(1&n){const e=Xe();K(0,"button",13),Te("click",function(){return De(e),ge().toggleMinimize()}),K(1,"i",14),be(2),J()()}if(2&n){const e=ge();U(1),Ke("font-size",e.isMinimized?12:14,"px"),U(1),qe(e.isMinimized?"crop_din":"minimize")}}function wZ(n,t){if(1&n){const e=Xe();K(0,"button",13),Te("click",function(){return De(e),ge().toggleFullScreen()}),K(1,"i",14),be(2),J()()}if(2&n){const e=ge();U(1),Ke("font-size",e.isFullScreen&&!e.isMinimized?12:14,"px"),U(1),qe(e.isFullScreen?e.isMinimized?"minimize":"crop_din":"fullscreen")}}function EZ(n,t){if(1&n){const e=Xe();K(0,"button",13),Te("click",function(){return De(e),ge().close()}),K(1,"i",12),be(2,"close"),J()()}}const TZ=function(n,t,e,i){return{"pointer-events-none":n,"is-full-screen":t,"is-minimized":e,"i-am-gm":i}},IZ=function(n){return{rotateble:n}},SZ=function(n,t){return{overlay:n,horizontal:t}},MZ=["*"];let WI=(()=>{class n{constructor(e,i){this.panelService=e,this.pointerDeviceService=i,this.rotateEvent=new Cn,this.showTitleButtons=!0,this.preLeft=0,this.preTop=0,this.preWidth=100,this.preHeight=100,this.horizontalWidth=1032,this.horizontalHeight=100,this.verticalWidth=0,this.verticalHeight=0,this.isMinimized=!1,this.isFullScreen=!1,this.isHorizontal=!1}set title(e){this.panelService.title=e}set left(e){this.panelService.left=e}set top(e){this.panelService.top=e}set width(e){this.panelService.width=e}set height(e){this.panelService.height=e}set isAbleMinimizeButton(e){this.panelService.isAbleMinimizeButton=e}set isAbleFullScreenButton(e){this.panelService.isAbleFullScreenButton=e}set isAbleCloseButton(e){this.panelService.isAbleCloseButton=e}set isAbleRotateButton(e){this.panelService.isAbleRotateButton=e}get title(){return this.panelService.title}get left(){return this.panelService.left}get top(){return this.panelService.top}get width(){return this.panelService.width}get height(){return this.panelService.height}get isAbleMinimizeButton(){return this.panelService.isAbleMinimizeButton}get isAbleFullScreenButton(){return this.panelService.isAbleFullScreenButton}get isAbleCloseButton(){return this.panelService.isAbleCloseButton}get isAbleRotateButton(){return this.panelService.isAbleRotateButton}get isGMMode(){return!!Ue.myCursor&&Ue.myCursor.isGMMode}get isPointerDragging(){return this.pointerDeviceService.isDragging}ngOnInit(){this.panelService.scrollablePanel=this.scrollablePanel.nativeElement}toggleMinimize(){const e=this.draggablePanel.nativeElement,i=this.scrollablePanel.nativeElement;if(e.style.transition="width 0.1s ease-in-out, height 0.1s ease-in-out",i.style.overflowY="hidden",setTimeout(()=>{e.style.transition=null,i.style.overflowY=null},100),!this.isMinimized&&!this.isFullScreen){const r=e.offsetWidth,s=e.offsetHeight;this.isHorizontal?(this.horizontalWidth=r,this.horizontalHeight=s):(this.verticalWidth=r,this.verticalHeight=s)}this.isMinimized=!this.isMinimized,this.isFullScreen=!1}toggleFullScreen(){const e=this.draggablePanel.nativeElement,i=this.scrollablePanel.nativeElement;if(e.style.transition="width 0.1s ease-in-out, height 0.1s ease-in-out",i.style.overflowY="hidden",setTimeout(()=>{e.style.transition=null,i.style.overflowY=null},100),!this.isMinimized&&!this.isFullScreen){const r=e.offsetWidth,s=e.offsetHeight;this.isHorizontal?(this.horizontalWidth=r,this.horizontalHeight=s):(this.verticalWidth=r,this.verticalHeight=s)}this.isFullScreen=!this.isFullScreen}toggleRotate(){const e=this.draggablePanel.nativeElement,i=this.scrollablePanel.nativeElement;e.style.transition="width 0.1s ease-in-out, height 0.1s ease-in-out",i.style.overflowY="hidden",setTimeout(()=>{e.style.transition=null,i.style.overflowY=null},100);const r=e.offsetWidth,s=e.offsetHeight;this.isHorizontal?(this.isHorizontal=!1,e.style.width=(this.verticalWidth<100?100:this.verticalWidth)+"px",e.style.height=(this.verticalHeight<100?100:this.verticalHeight)+"px",!this.isMinimized&&!this.isFullScreen&&(this.horizontalWidth=r,this.horizontalHeight=s)):(this.isHorizontal=!0,e.style.width=(this.horizontalWidth<100?100:this.horizontalWidth)+"px",e.style.height=(this.horizontalHeight<100?100:this.horizontalHeight)+"px",!this.isMinimized&&!this.isFullScreen&&(this.verticalWidth=r,this.verticalHeight=s)),this.isMinimized=!1,this.isFullScreen=!1,this.rotateEvent.emit(this.isHorizontal)}close(){this.panelService&&this.panelService.close()}}return n.\u0275fac=function(e){return new(e||n)(Le(In),Le(ai))},n.\u0275cmp=Zt({type:n,selectors:[["ui-panel"]],viewQuery:function(e,i){if(1&e&&(on($Z,7),on(vZ,7),on(bZ,7,Rr),on(yZ,7)),2&e){let r;sn(r=an())&&(i.draggablePanel=r.first),sn(r=an())&&(i.scrollablePanel=r.first),sn(r=an())&&(i.content=r.first),sn(r=an())&&(i.titleBar=r.first)}},inputs:{title:"title",left:"left",top:"top",width:"width",height:"height",isAbleMinimizeButton:"isAbleMinimizeButton",isAbleFullScreenButton:"isAbleFullScreenButton",isAbleCloseButton:"isAbleCloseButton",isAbleRotateButton:"isAbleRotateButton",showTitleButtons:"showTitleButtons"},outputs:{rotateEvent:"rotateEvent"},features:[ui([In])],ngContentSelectors:MZ,decls:16,vars:34,consts:[["appDraggable","","appResizable","",1,"draggable-panel",3,"ngClass","resizable.disable","resizable.align","draggable.disable","draggable.stack","resizable.stack"],["draggablePanel",""],[1,"title"],["titleBar",""],["style","padding: 0px; height: 14px; margin-top: 3px; margin-left: 1px",3,"click",4,"ngIf"],[3,"ngClass"],[1,"title-button"],[3,"click",4,"ngIf"],[1,"scrollable-panel",3,"ngClass"],["scrollablePanel",""],["content",""],[2,"padding","0px","height","14px","margin-top","3px","margin-left","1px",3,"click"],[1,"material-icons",2,"font-size","14px"],[3,"click"],[1,"material-icons"]],template:function(e,i){1&e&&(g_(),K(0,"div",0,1)(2,"div",2,3),xe(4,CZ,3,0,"button",4),K(5,"div",5),be(6),J(),K(7,"div",6),xe(8,xZ,3,3,"button",7),xe(9,wZ,3,3,"button",7),xe(10,EZ,3,0,"button",7),J()(),K(11,"div",8,9),m_(13),it(14,"div",null,10),J()()),2&e&&(Ke("left",i.left,"px")("top",i.top,"px")("width",i.width,"px")("height",i.height,"px"),te("@flyInOut","in")("ngClass",oo(24,TZ,i.isPointerDragging,i.isFullScreen,i.isMinimized&&!i.isFullScreen,i.isGMMode))("resizable.disable",i.isMinimized||i.isFullScreen)("resizable.align",i.isAbleRotateButton?i.isHorizontal?"horizontal":"vertical":"normal")("draggable.disable",i.isFullScreen)("draggable.stack",".draggable-panel")("resizable.stack",".draggable-panel"),U(4),te("ngIf",i.isAbleRotateButton),U(1),te("ngClass",ut(29,IZ,i.isAbleRotateButton)),U(1),qe(i.panelService.title),U(2),te("ngIf",i.isAbleMinimizeButton),U(1),te("ngIf",i.isAbleFullScreenButton),U(1),te("ngIf",i.isAbleCloseButton),U(1),Ke("display",i.isMinimized&&!i.isFullScreen?"none":null),te("ngClass",Kt(31,SZ,i.isAbleRotateButton,i.isHorizontal)))},directives:[U0,_Z,Wn,_n],styles:["[_nghost-%COMP%]{display:block}.draggable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;color:#444;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;padding:0;top:200px;height:200px;width:300px;max-height:100%;max-width:100%;cursor:-webkit-grab;cursor:grab}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;position:absolute;top:25px;bottom:0;width:100%;padding:8px;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;padding:2px 5px;width:100%;background-color:#555;color:#ccc;-webkit-user-select:none;-moz-user-select:none;user-select:none}.title-button[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#ccc}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}@media screen and (-webkit-min-device-pixel-ratio: 0){.scrollable-panel.overlay[_ngcontent-%COMP%]{overflow:overlay}}.scrollable-panel.horizontal[_ngcontent-%COMP%]{overflow-x:auto;overflow-y:hidden}.rotateble[_ngcontent-%COMP%]{display:inline;top:-3px;position:relative}.is-minimized[_ngcontent-%COMP%]{height:27px!important}.is-full-screen[_ngcontent-%COMP%]{left:0px!important;top:0px!important;width:100vw!important;height:100vh!important;cursor:default}.draggable-panel.is-full-screen[_ngcontent-%COMP%]{border:0px none}.draggable-panel.i-am-gm[_ngcontent-%COMP%]{background:linear-gradient(-30deg,rgba(240,208,208,.9),rgba(255,236,236,.9))}"],data:{animation:[xn("flyInOut",[Bt("void => *",[Ft("100ms ease-out",nn([Ye({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),Ye({transform:"scale(1.0, 1.0)",opacity:"1",offset:1})]))]),Bt("* => void",[Ft(100,Ye({transform:"scale(0, 0)"}))])])]}}),n})();const kZ=["standImageElement"],DZ=["dialogElement"],AZ=function(n){return{"emote-secret":n}};function PZ(n,t){if(1&n&&(K(0,"div",12),be(1),J()),2&n){const e=ge(3);Ke("visibility",e.isShowStand&&e.isApplyDialog?"visible":"hidden")("width",e.imageWidth,"px")("font-size",e.imageWidth/4.5>16?e.imageWidth/4.5:16,"px")("color",e.color?e.color:"#444")("bottom",e.emoteCssBottom,"px"),te("@fadeAndScaleInOut",void 0)("ngClass",ut(13,AZ,e.isSecret)),U(1),qe(e.gameCharacter.text)}}const NZ=function(n,t){return{"transform-origin":n,transform:t}},FZ=function(n){return{inverse:n}},OZ=function(n,t,e,i,r,s,o,c){return{black:n,blue:t,green:e,cyan:i,red:r,magenta:s,yellow:o,white:c}},RZ=function(n,t){return{"black-paint":n,hollow:t}};function BZ(n,t){if(1&n){const e=Xe();Ve(0),xe(1,PZ,2,15,"div",5),K(2,"div",6)(3,"div",7)(4,"div",8)(5,"div",9)(6,"img",10,11),Te("load",function(){return De(e),ge(2).onImageLoad()}),Ct(8,"safe"),J()()()()(),Ge()}if(2&n){const e=ge(2);U(1),te("ngIf",!e.isBackyard&&e.gameCharacter.isEmote),U(1),te("ngStyle",Kt(11,NZ,e.standImageTransformOrigin,e.isApplyRoll?"rotate("+e.gameCharacter.roll+"deg)":"")),U(1),te("ngClass",ut(14,FZ,e.isApplyImageEffect&&e.gameCharacter.isInverse)),U(1),te("ngClass",ao(16,OZ,e.isApplyImageEffect&&0==e.gameCharacter.aura,e.isApplyImageEffect&&1==e.gameCharacter.aura,e.isApplyImageEffect&&2==e.gameCharacter.aura,e.isApplyImageEffect&&3==e.gameCharacter.aura,e.isApplyImageEffect&&4==e.gameCharacter.aura,e.isApplyImageEffect&&5==e.gameCharacter.aura,e.isApplyImageEffect&&6==e.gameCharacter.aura,e.isApplyImageEffect&&7==e.gameCharacter.aura)),U(2),Ke("height",e.height>0?e.height+"vh":"auto"),te("src",xt(8,8,e.standImage.url,"resourceUrl"),Jt)("ngClass",Kt(25,RZ,e.isApplyImageEffect&&e.gameCharacter.isBlackPaint,e.isApplyImageEffect&&e.gameCharacter.isHollow))}}const LZ=function(n,t,e,i){return{"is-can-be-gone":n,"is-ghostly":t,backyard:e,secret:i}};function zZ(n,t){if(1&n){const e=Xe();K(0,"div",3),Te("click",function(){De(e);const r=ge();return r.toGhostly(),r.toBackyard()}),xe(1,BZ,9,28,"ng-container",4),J()}if(2&n){const e=ge();Ke("left",e.position+"%")("height",0==e.height?"":e.height+"vh")("margin-left",-e.imageWidth/2,"px")("margin-bottom",e.adjustY,"px"),te("@standInOut",e.groupValue)("ngClass",oo(11,LZ,e.isCanBeGone,e.isGhostly,e.isBackyard,e.isSecret)),U(1),te("ngIf",e.gameCharacter&&e.standImage.url&&e.standImage.url.length>0)}}const jZ=function(n,t,e){return{"is-can-be-gone":n,"is-ghostly":t,backyard:e}};function HZ(n,t){if(1&n&&(K(0,"span",13)(1,"b"),be(2),J()()),2&n){const e=ge();Ke("color",e.color?e.color:"#444")("left",e.position+"%")("margin-bottom",e.adjustY>0?e.adjustY:0,"px")("border-color",e.color?e.color:"#444")("margin-left",e.nameTagCSSMarginLeft,"px"),te("ngClass",Zr(12,jZ,e.isCanBeGone,e.isGhostly,e.isBackyard)),U(2),qe(e.gameCharacter.name)}}const UZ=function(n,t,e){return{left:n,right:t,"transform-origin":e}},VZ=function(n,t,e,i,r,s){return{"is-can-be-gone":n,"is-ghostly":t,backyard:e,"dialog-secret":i,"is-position-right":r,"is-position-left":s}};function GZ(n,t){if(1&n){const e=Xe();K(0,"div",14,15),Te("click",function(){De(e);const r=ge();return r.toGhostly(),r.toBackyard()}),K(2,"p",16),Te("@dialogShake.start",function(r){return De(e),ge().onSpeaking(r)}),Ct(3,"safe"),J()()}if(2&n){const e=ge();Ke("visibility",e.isShowStand&&e.isApplyDialog?"visible":"hidden")("color",e.isSecret?"#ccc":e.color?e.color:"#444")("left",e.dialogBoxCSSLeft,"px")("bottom",e.dialogBoxCssBottom>12?e.dialogBoxCssBottom:12,"px")("max-width",e.dialogBoxCSSMaxWidth,"px")("border-color",e.color?e.color:"#444"),te("@fadeAndScaleInOut",void 0)("ngStyle",Zr(20,UZ,e.position<=50?e.dialogBoxCSSLeft+"px":"auto",e.position>50?e.dialogBoxCSSRight+"px":"auto",e.position<=50?"12px calc(100% + 12px)":"calc(100% - 12px) calc(100% + 12px)"))("ngClass",I_(24,VZ,e.isCanBeGone,e.isGhostly,e.isBackyard,e.isSecret,e.position<=50,e.position>50)),U(2),te("@dialogShake",e.math.floor(e.dialogText.length/2))("innerHTML",xt(3,17,e.dialogText,"html"),qi)}}let Uo=(()=>{class n{constructor(e){this.ngZone=e,this._imageFile=Ht.Empty,this.isFarewell=!1,this.isGhostly=!1,this.isBackyard=!1,this.isVisible=!1,this.isSecret=!1,this.standImageTransformOrigin="center",this.naturalWidth=0,this.naturalHeight=0,this.isSpeaking=!1,this.math=Math}onSpeaking(e){this.gameCharacter&&this.gameCharacter.text&&(this.isApplyDialog||this.isSpeakable||this.gameCharacter.isShowChatBubble)&&(clearTimeout(this._timeoutId),this._timeoutId=setTimeout(()=>{this.ngZone.run(()=>{this.isVisible=!1})},12e3)),this.isSpeakable&&(clearTimeout(this._dialogTimeoutId),this.gameCharacter&&this.gameCharacter.text&&(this.isSpeaking=!0),this._dialogTimeoutId=setTimeout(()=>{this.ngZone.run(()=>{this.isSpeaking=!1})},300))}get isShowStand(){return n.isShowStand}get isShowNameTag(){return n.isShowNameTag&&this.isShowName}get isCanBeGone(){return n.isCanBeGone}set dialog(e){if(!this.gameCharacter||"table"===this.gameCharacter.location.name&&!this.gameCharacter.isHideIn||"graveyard"===this.gameCharacter.location.name)return;clearTimeout(this._dialogTimeoutId);let i=et.cr(e.text);const r=et.isEmote(i),s=[],o=/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g;let c,m=0,I=0;if(!r)for(i=i.replace(/[\u3002\u3001]{3}/g,"\u2026").replace(/[\u3002\u3001]{2}/g,"\u2025").replace(/(\u3002|[\r\n]{2,})/g,"$1                            ").trimEnd();null!==(c=o.exec(i));){let Be=c.index-3*m;s.push({base:c[1],ruby:c[2],start:Be-I,end:Be+c[1].length-I-1}),m++,I+=c[2].length}let Z=1e3/Array.from(i).length>36?1e3/Array.from(i).length:36;Z>200&&(Z=200),this._dialogTimeoutId=setTimeout(()=>{this.gameCharacter.text="",this.gameCharacter.isEmote=!1},Array.from(i).length*Z+6e3),this.gameCharacter.isEmote=r,m=0;let fe=0,pe=0,ye="",we=s.shift(),Me="",Oe=!1;if(r)this.gameCharacter.text=i;else{const Be=Array.from(i.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a.+?\u300b/g,"$1"));this._chatIntervalId=setInterval(()=>{let ke=Be[m],ze=ke.length>1;if(ke){if(!Oe&&we&&fe>=we.start&&(ye+="<ruby>",Oe=!0,pe=0),ye+=et.escapeHtml(ke),Oe){pe+=1;let je=we.ruby;Me="<rt>"+et.escapeHtml(Array.from(je).slice(0,Math.ceil(Array.from(je).length*(pe/Array.from(we.base).length))).join(""))+"</rt>"}Oe&&we&&fe>=we.end-(ze?1:0)&&(ye+=Me+"</ruby>",Oe=!1,we=s.shift()),fe+=ke.length}m+=1,this.gameCharacter.text=ye+(Oe?Me+"</ruby>":""),m>=Be.length&&clearInterval(this._chatIntervalId)},Z)}}get dialogText(){return this.gameCharacter&&this.gameCharacter.text?this.gameCharacter.text.replace(/[\r\n]{2,}/g,"\n\n").replace(/                            /g,"").trim():""}get standImage(){if(!this.standElement)return this._imageFile;let e=null;if(this.isSpeaking&&(e=this.standElement.getFirstElementByName("speakingImageIdentifier")),(!e||!e.value||e.value==Ht.Empty.identifier)&&(e=this.standElement.getFirstElementByName("imageIdentifier")),e&&this._imageFile.identifier!==e.value){let i=kt.instance.get(e.value);this._imageFile=i||Ht.Empty}return this._imageFile}get isSpeakable(){if(!this.standElement)return!1;let e=this.standElement.getFirstElementByName("speakingImageIdentifier");return e&&e.value&&e.value!==Ht.Empty.identifier}ngOnInit(){Fe.register(this).on("POPUP_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&this.ngZone.run(()=>{this.dialog=e.data})}).on("FAREWELL_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&(this.ngZone.run(()=>{this.dialog=null,this.gameCharacter.text="",this.gameCharacter.isEmote=!1}),clearTimeout(this._dialogTimeoutId),clearInterval(this._chatIntervalId))})}ngOnDestroy(){clearTimeout(this._timeoutId),clearTimeout(this._dialogTimeoutId)}get group(){if(!this.gameCharacter)return"";let e=this.standElement.getFirstElementByName("name");return e.currentValue&&e.currentValue.toString().length>0?e.currentValue.toString():""}get groupValue(){let e=0;const i=this.group;for(let r=0;r<i.length;r++)e=(e<<5)-e+i.charCodeAt(r),e|=0;return e}get position(){if(!this.gameCharacter)return 0;let e=this.standElement.getFirstElementByName("position");return e&&e.currentValue?+e.value:this.gameCharacter.standList.position}get adjustY(){if(!this.gameCharacter)return 0;let e=this.standElement.getFirstElementByName("height");return this.imageHeight*(e&&e.currentValue?+e.currentValue:0)/100}get height(){if(!this.gameCharacter||!this.standElement)return 0;let e=this.standElement.getFirstElementByName("height");return e&&0!=+e.value||!this.gameCharacter.standList?e?+e.value:0:this.gameCharacter.standList.height}get imageHeight(){return 0==this.height?this.naturalHeight:document.documentElement.offsetHeight*this.height/100}get imageWidth(){return this.imageHeight*this.naturalWidth/this.naturalHeight}get dialogBoxCSSLeft(){return this.imageWidth*(this.position>50?.33:.66)-this.imageWidth/2-12+this.position*document.documentElement.clientWidth/100-(this.position>50?this.dialogBoxCSSMaxWidth:0)}get dialogBoxCSSRight(){return document.documentElement.clientWidth-this.dialogBoxCSSLeft-this.dialogBoxCSSMaxWidth}get dialogBoxCSSMaxWidth(){let e=this.imageWidth/document.documentElement.clientWidth;return e/=2,e<.14&&(e=.14),e*document.documentElement.clientWidth}get dialogBoxCssBottom(){let e=.66*this.imageHeight+this.adjustY;return e<48&&(e=48),this.dialogElement&&e>document.documentElement.offsetHeight-this.dialogElement.nativeElement.clientHeight&&(e=document.documentElement.offsetHeight-this.dialogElement.nativeElement.clientHeight),e}get emoteCssBottom(){let e=.66*this.imageHeight+(this.imageWidth/4.5>16?this.imageWidth/4.5:16);return e<0&&(e=0),e}get nameTagCSSMarginLeft(){let e=this.imageWidth/2-this.position*document.documentElement.clientWidth/100;return e<32&&(e=32),-this.imageWidth/2+e}get isApplyImageEffect(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("applyImageEffect");return!(!e||!e.value)}get isApplyRoll(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("applyRoll");return!(!e||!e.value)}get isApplyDialog(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("applyDialog");return!(!e||!e.value)}get isShowName(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("showName");return!(!e||!e.value)}calcStandImageTransformOrigin(){return"center 66%"}toGhostly(){this.ngZone.run(()=>{this.isGhostly=!0})}toBackyard(){this.ngZone.run(()=>{this.isBackyard=!0})}toFront(){this.ngZone.run(()=>{this.isFarewell=!1,this.isGhostly=!1,this.isBackyard=!1,this.isVisible=!0}),clearTimeout(this._timeoutId),this._timeoutId=setTimeout(()=>{this.ngZone.run(()=>{this.isVisible=!1})},12e3)}toFarewell(){this.ngZone.run(()=>{this.isFarewell=!0,this.isVisible=!1})}onImageLoad(){this.naturalWidth=this.standImageElement.nativeElement.naturalWidth,this.naturalHeight=this.standImageElement.nativeElement.naturalHeight,this.standImageTransformOrigin=this.calcStandImageTransformOrigin()}}return n.isShowStand=!0,n.isShowNameTag=!0,n.isCanBeGone=!0,n.\u0275fac=function(e){return new(e||n)(Le(vn))},n.\u0275cmp=Zt({type:n,selectors:[["stand-image"]],viewQuery:function(e,i){if(1&e&&(on(kZ,5),on(DZ,5)),2&e){let r;sn(r=an())&&(i.standImageElement=r.first),sn(r=an())&&(i.dialogElement=r.first)}},inputs:{gameCharacter:"gameCharacter",standElement:"standElement",color:"color"},decls:4,vars:7,consts:[["class","stand-image-container",3,"left","height","margin-left","margin-bottom","ngClass","click",4,"ngIf"],["class","name-tag","style","pointer-events: none;",3,"color","ngClass","left","margin-bottom","border-color","margin-left",4,"ngIf"],["class","name-tag dialog chat-bubble-buyo","style","margin-left: 12px; min-width: 5em; white-space: pre-wrap; font-size: 14px; pointer-events: none;",3,"visibility","color","left","bottom","max-width","ngStyle","ngClass","border-color","click",4,"ngIf"],[1,"stand-image-container",3,"ngClass","click"],[4,"ngIf"],["class","emote chat-bubble-buyo","style","position: absolute; pointer-events: none; text-align: center; margin-top: -1em",3,"visibility","width","font-size","color","bottom","ngClass",4,"ngIf"],[3,"ngStyle"],[1,"inverser",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"color-fillter"],["draggable","false",1,"stand-image",3,"src","ngClass","load"],["standImageElement",""],[1,"emote","chat-bubble-buyo",2,"position","absolute","pointer-events","none","text-align","center","margin-top","-1em",3,"ngClass"],[1,"name-tag",2,"pointer-events","none",3,"ngClass"],[1,"name-tag","dialog","chat-bubble-buyo",2,"margin-left","12px","min-width","5em","white-space","pre-wrap","font-size","14px","pointer-events","none",3,"ngStyle","ngClass","click"],["dialogElement",""],[2,"width","100%",3,"innerHTML"]],template:function(e,i){1&e&&(K(0,"div"),xe(1,zZ,2,16,"div",0),xe(2,HZ,3,16,"span",1),xe(3,GZ,4,31,"div",2),J()),2&e&&(Ke("visibility",i.isShowStand?"visible":"hidden")("pointer-events",i.isShowStand?"auto":"none"),U(1),te("ngIf",!i.isFarewell&&(i.isVisible||!i.isCanBeGone)),U(1),te("ngIf",i.isShowStand&&!i.isFarewell&&(i.isVisible||!i.isCanBeGone)&&i.isShowNameTag&&i.gameCharacter&&i.gameCharacter.name),U(1),te("ngIf",!i.isFarewell&&i.isVisible&&!i.isBackyard&&i.gameCharacter&&i.gameCharacter.text&&!i.gameCharacter.isEmote))},directives:[_n,Wn,Zi],pipes:[ti],styles:['.stand-image-container[_ngcontent-%COMP%]{position:absolute;display:inline-block;bottom:-.1%;z-index:1000000;transition:opacity .1s ease-in}.is-ghostly[_ngcontent-%COMP%]{z-index:900000}.is-can-be-gone.is-ghostly[_ngcontent-%COMP%]{opacity:.5;filter:brightness(.5)}.backyard[_ngcontent-%COMP%]{pointer-events:none;z-index:0}.name-tag[_ngcontent-%COMP%]{color:#444;background-color:#f5f5f5;border:2px solid #444;border-radius:24px;padding:4px 12px;bottom:2px;display:inline-block;white-space:nowrap;position:absolute;font-size:16px;opacity:.9;z-index:1000005}.name-tag.is-ghostly[_ngcontent-%COMP%]{z-index:900005}.is-can-be-gone.name-tag.is-ghostly[_ngcontent-%COMP%]{opacity:.5}.name-tag.backyard[_ngcontent-%COMP%]{z-index:1}.is-can-be-gone.is-ghostly.backyard[_ngcontent-%COMP%]{opacity:.25}.secret[_ngcontent-%COMP%]   .color-fillter[_ngcontent-%COMP%]{filter:grayscale(80%)}.name-tag.dialog[_ngcontent-%COMP%]{border-radius:24px 24px 24px 12px}.name-tag.dialog-secret[_ngcontent-%COMP%]{border-radius:24px 12px;background:rgba(85,85,85,.9)}.name-tag.dialog.is-position-left[_ngcontent-%COMP%]{border-radius:24px 24px 12px}.name-tag.dialog.dialog-secret.is-position-left[_ngcontent-%COMP%]{border-radius:12px 24px}.emote[_ngcontent-%COMP%]{text-align:center;font-size:48px;font-weight:700;border:none;background:none;-webkit-text-stroke:2px whitesmoke;white-space:pre-wrap;word-break:break-word}.emote.emote-secret[_ngcontent-%COMP%]{-webkit-text-stroke:2px #555}.emote.emote-secret.is-ghostly[_ngcontent-%COMP%]{z-index:900005}.emote[_ngcontent-%COMP%]{z-index:1000005}.emote.is-ghostly[_ngcontent-%COMP%]{z-index:900005}.dialog[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{overflow-wrap:anywhere;word-break:break-word;display:inline-block;margin-top:.5em;margin-bottom:.5em}.dialog.is-position-right[_ngcontent-%COMP%]:after{box-sizing:border-box;content:"";position:absolute;padding:0;line-height:1;vertical-align:baseline;bottom:-25px;border:12px solid transparent;border-top-color:inherit;left:17px;margin:0 0 0 -12px}.dialog.is-position-left[_ngcontent-%COMP%]:before{box-sizing:border-box;content:"";position:absolute;margin:0 -12px 0 0;padding:0;line-height:1;vertical-align:baseline;bottom:-25px;border:12px solid transparent;border-top-color:inherit;right:17px}.chat-bubble-buyo[_ngcontent-%COMP%]{transition:transform .2s ease;-webkit-animation:chat-bubble-buyo 1.2s ease-in-out .1s infinite alternate;animation:chat-bubble-buyo 1.2s ease-in-out .1s infinite alternate;transform:scale3d(.9,.9,.9)}.chat-bubble-buyo.emote[_ngcontent-%COMP%]{-webkit-animation-duration:.6s;animation-duration:.6s;transform-origin:center bottom}@-webkit-keyframes chat-bubble-buyo{0%{transform:scale3d(.9,.9,.9)}to{transform:scale(1)}}@keyframes chat-bubble-buyo{0%{transform:scale3d(.9,.9,.9)}to{transform:scale(1)}}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #fff)}'],data:{animation:[xn("standInOut",[Bt("void => *,:increment,:decrement",[Ft("132ms cubic-bezier(.21,.97,.75,1.25)",nn([Ye({opacity:.6,transform:"translateY(48px) scale(0.9)",offset:0}),Ye({opacity:1,transform:"translateY(0px) scale(1.0)",offset:1})]))]),Bt("* => void,:increment,:decrement",[Ft("132ms ease-out",nn([Ye({transform:"translateY(0px) scale(1.0)",offset:0}),Ye({opacity:0,transform:"translateY(96px) scale(0.9)",offset:1})]))])]),xn("dialogShake",[Bt(":increment",[Ft("19ms ease",nn([Ye({transform:"translateX(1px)"})])),Ft("19ms ease",nn([Ye({transform:"translateX(-1px)"})]))])]),xn("fadeAndScaleInOut",[Bt("void => *, true => false",[Ft("200ms ease-in-out",nn([Ye({transform:"scale3d(0, 0, 0)",opacity:0}),Ye({transform:"scale3d(0.9, 0.9, 0.9)",opacity:.9})]))]),Bt("* => void, true => false",[Ft("100ms ease-in-out",Ye({transform:"scale3d(0, 0, 0)",opacity:0}))])])]}}),n})();class nr{constructor(){}show(t,e,i=null,r=!1){let s=!0;for(const o of nr.currentStandImageShowing){const c=o[0],m=o[1];if(!m)continue;const I=m.instance;I.isVisible&&t.identifier!=c?I.toGhostly():t.identifier==c&&"graveyard"!=t.location.name?(I.standElement=e,I.color=i||t.chatPalette.color,I.isSecret=r,I.toFront(),s=!1):(I.isFarewell||Uo.isCanBeGone)&&(m.destroy(),nr.currentStandImageShowing.delete(c))}if(s&&"graveyard"!=t.location.name){const o=nr.defaultParentViewContainerRef.createComponent(Uo);o.instance.gameCharacter=t,o.instance.standElement=e,o.instance.color=i||t.chatPalette.color,o.instance.isSecret=r,o.instance.toFront(),nr.currentStandImageShowing.set(t.identifier,o)}}farewell(t){t instanceof Vt&&(t=t.identifier);const e=nr.currentStandImageShowing.get(t);e&&e.instance&&e.instance.toFarewell()}destroy(t,e){t instanceof Vt&&(t=t.identifier),e instanceof ht&&(e=e.identifier);for(const i of nr.currentStandImageShowing){const r=i[1];!r||(!r.instance||!r.instance.standElement||r.instance.standElement.identifier==e)&&(r.destroy(),nr.currentStandImageShowing.delete(t))}}destroyAll(){for(const t of nr.currentStandImageShowing){const e=t[0],i=t[1];!i||(i.destroy(),nr.currentStandImageShowing.delete(e))}}}nr.currentStandImageShowing=new Map,nr.\u0275fac=function(t){return new(t||nr)},nr.\u0275prov=tn({token:nr,factory:nr.\u0275fac,providedIn:"root"});const qZ=["diceRollTableSelecter"];function WZ(n,t){if(1&n&&(K(0,"option",9),be(1),J()),2&n){const e=t.$implicit;Ke("color",""==e.name?"gray":""),ct("value",e.identifier),ct("title",e.name),U(1),qe(""==e.name?"(\u7121\u540d\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868)":e.name)}}function KZ(n,t){if(1&n&&(K(0,"div",25),be(1),J()),2&n){const e=ge(3);U(1),An("",e.progresPercent,"%")}}const YZ=function(n){return{"is-hidden":n}};function ZZ(n,t){if(1&n){const e=Xe();Ve(0),K(1,"button",18),Te("click",function(){return De(e),ge(2).upTabIndex()}),be(2,"\u2191"),J(),K(3,"button",18),Te("click",function(){return De(e),ge(2).downTabIndex()}),be(4,"\u2193"),J(),K(5,"div",19)(6,"button",20),Te("click",function(){return De(e),ge(2).save()}),K(7,"div",21)(8,"div",22),be(9,"\u4fdd\u5b58"),J(),xe(10,KZ,2,1,"div",23),J()(),K(11,"button",24),Te("click",function(){return De(e),ge(2).delete()}),be(12,"\u524a\u9664"),J()(),Ge()}if(2&n){const e=ge(2);U(6),te("disabled",e.isSaveing),U(2),te("ngClass",ut(3,YZ,e.isSaveing)),U(2),te("ngIf",e.isSaveing)}}function XZ(n,t){if(1&n){const e=Xe();Ve(0),K(1,"button",18),Te("click",function(){return De(e),ge(2).restore()}),be(2,"\u5143\u306b\u623b\u3059"),J(),Ge()}}function QZ(n,t){if(1&n){const e=Xe();Ve(0),K(1,"div",10)(2,"div",11)(3,"b"),be(4,"name: "),J(),K(5,"input",12),Te("ngModelChange",function(r){return De(e),ge().diceRollTableName=r}),J()(),K(6,"div")(7,"span",13)(8,"b"),be(9,"command: "),J(),K(10,"input",14),Te("ngModelChange",function(r){return De(e),ge().diceRollTableCommand=r}),J()(),K(11,"span",15)(12,"b"),be(13,"dice: "),J(),K(14,"input",16),Te("ngModelChange",function(r){return De(e),ge().diceRollTableDice=r}),J()()()(),K(15,"div")(16,"textarea",17),Te("ngModelChange",function(r){return De(e),ge().diceRollTableText=r}),J()(),it(17,"hr"),K(18,"div"),xe(19,ZZ,13,5,"ng-container",8),xe(20,XZ,3,0,"ng-container",8),J(),Ge()}if(2&n){const e=ge();U(5),te("ngModel",e.diceRollTableName),Rt("disabled",e.isEditable?null:""),U(5),te("ngModel",e.diceRollTableCommand),Rt("disabled",e.isEditable?null:""),U(4),te("ngModel",e.diceRollTableDice),Rt("disabled",e.isEditable?null:""),U(2),te("ngModel",e.diceRollTableText),Rt("disabled",e.isEditable?null:""),U(3),te("ngIf",!e.isDeleted),U(1),te("ngIf",e.isDeleted&&e.selectedDiceRollTableXml)}}function JZ(n,t){if(1&n){const e=Xe();Ve(0),K(1,"button",18),Te("click",function(){return De(e),ge(2).restore()}),be(2,"\u5143\u306b\u623b\u3059"),J(),Ge()}}function eX(n,t){if(1&n&&(Ve(0),K(1,"div",26),be(2," \u203b\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u304c\u3042\u308a\u307e\u305b\u3093\u3002 "),xe(3,JZ,3,0,"ng-container",8),J(),Ge()),2&n){const e=ge();U(3),te("ngIf",e.isDeleted&&e.selectedDiceRollTableXml)}}let tX=(()=>{class n{constructor(e,i,r,s){this.pointerDeviceService=e,this.modalService=i,this.panelService=r,this.saveDataService=s,this.selectedDiceRollTable=null,this.selectedDiceRollTableXml="",this.isSaveing=!1,this.progresPercent=0}get diceRollTableName(){return this.selectedDiceRollTable.name}set diceRollTableName(e){this.isEditable&&(this.selectedDiceRollTable.name=e)}get diceRollTableDice(){return this.selectedDiceRollTable.dice}set diceRollTableDice(e){this.isEditable&&(this.selectedDiceRollTable.dice=e)}get diceRollTableCommand(){return this.selectedDiceRollTable.command}set diceRollTableCommand(e){this.isEditable&&(this.selectedDiceRollTable.command=e)}get diceRollTableText(){return this.selectedDiceRollTable.value}set diceRollTableText(e){this.isEditable&&(this.selectedDiceRollTable.value=e)}get diceRollTables(){return ho.instance.children}get isEmpty(){return this.diceRollTables.length<1}get isDeleted(){return!!this.selectedDiceRollTable&&null==lt.instance.get(this.selectedDiceRollTable.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u8a2d\u5b9a"),Fe.register(this).on("DELETE_GAME_OBJECT",1e3,e=>{if(!this.selectedDiceRollTable||e.data.identifier!==this.selectedDiceRollTable.identifier)return;let i=lt.instance.get(e.data.identifier);null!==i&&(this.selectedDiceRollTableXml=i.toXml())})}ngAfterViewInit(){this.diceRollTables.length>0&&queueMicrotask(()=>{this.onChangeDiceRollTable(this.diceRollTables[0].identifier),this.diceRollTableSelecter.nativeElement.selectedIndex=0})}ngOnDestroy(){Fe.unregister(this)}onChangeDiceRollTable(e){this.selectedDiceRollTable=lt.instance.get(e),this.selectedDiceRollTableXml=""}create(e="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868"){return ho.instance.addDiceRollTable(e)}add(){const e=this.create();queueMicrotask(()=>{this.onChangeDiceRollTable(e.identifier),this.diceRollTableSelecter.nativeElement.value=e.identifier})}save(){var e=this;return(0,en.Z)(function*(){if(!e.selectedDiceRollTable||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i="fly_rollTable_"+e.selectedDiceRollTable.name;yield e.saveDataService.saveGameObjectAsync(e.selectedDiceRollTable,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}saveAll(){var e=this;return(0,en.Z)(function*(){e.isSaveing||(e.isSaveing=!0,e.progresPercent=0,yield e.saveDataService.saveGameObjectAsync(ho.instance,"fly_rollTable_All",i=>{e.progresPercent=i}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500))})()}delete(){!this.isEmpty&&this.selectedDiceRollTable&&(this.selectedDiceRollTableXml=this.selectedDiceRollTable.toXml(),this.selectedDiceRollTable.destroy())}restore(){if(this.selectedDiceRollTable&&this.selectedDiceRollTableXml){let e=Zn.instance.parseXml(this.selectedDiceRollTableXml);ho.instance.addDiceRollTable(e),this.selectedDiceRollTableXml="",queueMicrotask(()=>{const i=this.diceRollTables;this.onChangeDiceRollTable(i[i.length-1].identifier),this.diceRollTableSelecter.nativeElement.selectedIndex=i.length-1})}}upTabIndex(){if(!this.selectedDiceRollTable)return;let e=this.selectedDiceRollTable.parent,i=e.children.indexOf(this.selectedDiceRollTable);0<i&&e.insertBefore(this.selectedDiceRollTable,e.children[i-1])}downTabIndex(){if(!this.selectedDiceRollTable)return;let e=this.selectedDiceRollTable.parent,i=e.children.indexOf(this.selectedDiceRollTable);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.selectedDiceRollTable)}helpDiceRollTable(){let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(du,{left:e.x,top:e.y,width:600,height:788});r.title="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u30d8\u30eb\u30d7",r.text="\u3000\u540d\u524d\u3001\u30b3\u30de\u30f3\u30c9\u3001\u632f\u308b\u30c0\u30a4\u30b9\u3092\u8a2d\u5b9a\u3057\u3001\u30c0\u30a4\u30b9\u306e\u6570\u5b57\u3067\u8868\u3092\u53c2\u7167\u3057\u3001\u8868\u793a\u3057\u307e\u3059\u3002\n\u3000\u30c1\u30e3\u30c3\u30c8\u3067\u30b3\u30de\u30f3\u30c9\u3092\u9001\u4fe1\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3068\u540c\u69d8\u306b\u7d50\u679c\u304c\u9001\u4fe1\u3055\u308c\u307e\u3059\u3002\n\u3000\u8868\u306f1\u884c\u3054\u3068\u306b\u6570\u5b57\u3068\u7d50\u679c\u3092:\uff08\u30b3\u30ed\u30f3\uff09\u3067\u533a\u5207\u308a\u300c\u6570\u5b57:\u7d50\u679c\u300d\u306e\u5f62\u3067\u8a18\u8ff0\u3057\u307e\u3059\uff08\u3088\u3063\u3066\u3001\u30c0\u30a4\u30b9\u306f\u6700\u5f8c\u306b\u4e00\u3064\u306e\u6570\u5b57\u3092\u8fd4\u3059\u3082\u306e\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3001\u30d0\u30e9\u30d0\u30e9\u30c0\u30a4\u30b9 nBm\u3001\u500b\u6570\u632f\u308a\u8db3\u3057\u30c0\u30a4\u30b9 nRm\u3001\u4e0a\u65b9\u7121\u9650\u30ed\u30fc\u30eb nUm \u306e\u6210\u529f\u6570\u306b\u3082\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\uff09\u3002\n\u3000\n\u3000-\uff08\u30cf\u30a4\u30d5\u30f3\uff09\u307e\u305f\u306f\uff5e\u3067\u533a\u5207\u3063\u3066\u6570\u5b57\u306e\u7bc4\u56f2\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\u3000\u8868\u306b \\n \u3068\u66f8\u304f\u3068\u3001\u305d\u3053\u3067\u6539\u884c\u3057\u307e\u3059\uff08\\n\u306f\u8868\u793a\u3055\u308c\u307e\u305b\u3093\uff09\u3002\n\n\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u4f8b\uff09\n\u3000name: \u906d\u9047\u8266\u7a2e\u3000\n\u3000command: ShipType\u3000\u3000dice: 1d6\n\n\u3000\u30001:\u6226\u8266\n\u3000\u30002:\u7a7a\u6bcd\n\u3000\u30003:\u91cd\u5de1\u6d0b\u8266\n\u3000\u30004:\u8efd\u5de1\u6d0b\u8266\n\u3000\u30005-6:\u99c6\u9010\u8266\n\n\u3000\u8868\u3092\u53c2\u7167\u3059\u308b\u969b\u306f\u5148\u306b\u3042\u308b\u3082\u306e\u304c\u512a\u5148\u3055\u308c\u307e\u3059\u3001\u4e0a\u8a18\u306e\u4f8b\u3067\u306f\u6700\u5f8c\u306e\u884c\u3092\u300c1-6:\u99c6\u9010\u8266\u300d\u306a\u3069\u3068\u3057\u3066\u3082\u540c\u3058\u7d50\u679c\u306b\u306a\u308a\u307e\u3059\uff08\u304c\u3001\u5206\u304b\u308a\u3084\u3059\u3044\u8a18\u8ff0\u3092\u304a\u52e7\u3081\u3057\u307e\u3059\uff09\u3002\n\u3000\u30c7\u30d5\u30a9\u30eb\u30c8\u306e D66 \u306f\u30bd\u30fc\u30c8\u3055\u308c\u307e\u305b\u3093\u306e\u3067\u3001\u5fc5\u8981\u306a\u5834\u5408\uff08\u30b5\u30a4\u30b3\u30ed\u30fb\u30d5\u30a3\u30af\u30b7\u30e7\u30f3\u306e\u540d\u524d\u8868\u306a\u3069\uff09\u306f\u3001 D66S \u3068\u3057\u3066\u30bd\u30fc\u30c8\u3057\u305f\u6570\u5b57\u3092\u5f97\u3066\u304f\u3060\u3055\u3044\u3002\n\u3000\u6570\u5b57\u306e\u8a18\u8ff0\u306e\u969b *\uff08\u30a2\u30b9\u30bf\u30ea\u30b9\u30af\uff09\u3092\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\uff08\u4efb\u610f\u306e\u6570\u5b57\uff09\u3068\u3057\u3066\u4f7f\u7528\u53ef\u80fd\u3067\u3059\u3001\u4f8b\u3048\u3070 *-1 \u3068\u3059\u308c\u30701\u4ee5\u4e0b\u30016-* \u3068\u3059\u308c\u30706\u4ee5\u4e0a\u306e\u4efb\u610f\u306e\u6570\u5b57\u3067\u3059\uff08*\u5358\u72ec\u306f\u3059\u3079\u3066\u306e\u6570\u5b57\u3068\u306a\u308a\u3001\u5148\u306b\u3042\u308b\u3082\u306e\u304b\u3089\u53c2\u7167\u3055\u308c\u307e\u3059\u306e\u3067\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u9014\u4e2d\u306e\u884c\u306b\u66f8\u3044\u305f\u5834\u5408\u305d\u308c\u3088\u308a\u5148\u306e\u884c\u304c\u53c2\u7167\u3055\u308c\u306a\u304f\u306a\u308a\u307e\u3059\uff09\u3002\u5f8c\u8ff0\u306e\u4fee\u6b63\u306b\u3088\u308a\u8868\u304b\u3089\u306f\u307f\u51fa\u3057\u3066\u3082\u7d50\u679c\u3092\u5f97\u3089\u308c\u308b\u3088\u3046\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u3000\u30c1\u30e3\u30c3\u30c8\u304b\u3089\u306e\u30b3\u30de\u30f3\u30c9\u306e\u969b\u3001\u5168\u89d2\u534a\u89d2\u3001\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u306e\u5927\u6587\u5b57\u5c0f\u6587\u5b57\u306f\u7121\u8996\u3055\u308c\u307e\u3059\u3002\u307e\u305f\u30c0\u30a4\u30b9\u306b\u4fee\u6b63\u3092\u8db3\u3057\u5f15\u304d\u3059\u308b\u3001\u3042\u308b\u3044\u306f\u4efb\u610f\u306e\u6570\u5b57\u3067\u53c2\u7167\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\u30b3\u30de\u30f3\u30c9\u306e\u5f8c\u306b +\u4fee\u6b63\u5024 \u307e\u305f\u306f -\u4fee\u6b63\u5024 \u3092\u8a18\u8ff0\u3059\u308b\u3053\u3068\u3067\u632f\u3089\u308c\u305f\u30c0\u30a4\u30b9\u306e\u6570\u5b57\u3092\u4fee\u6b63\u3057\u307e\u3059\u3002\u307e\u305f =\u6307\u5b9a\u5024 \u3068\u8a18\u8f09\u3059\u308b\u3053\u3068\u3067\u3001\u305d\u306e\u6570\u5b57\u3067\u30b3\u30de\u30f3\u30c9\u306b\u5bfe\u5fdc\u3059\u308b\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u3092\u53c2\u7167\u3057\u307e\u3059\u3002\u4fee\u6b63\u5024\u3001\u6307\u5b9a\u5024\u306f\u4efb\u610f\u306e\u6574\u6570\u3067\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\u306e\u4f8b\uff09\n\u3000ShipType=3\n\u3000\u524d\u8ff0\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u4f8b\u300c\u906d\u9047\u8266\u7a2e\u300d\u3092\u6570\u5b573\u6307\u5b9a\u3067\u53c2\u7167\u3057\u307e\u3059\u3001\u7d50\u679c\u300c\u91cd\u5de1\u6d0b\u8266\u300d\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\u3082\u3057\u30011\u672a\u6e80\u30846\u3092\u8d85\u3048\u308b\u6570\u5b57\u3092\u6307\u5b9a\u3057\u305f\u5834\u5408\u300c\uff08\u7d50\u679c\u306a\u3057\uff09\u300d\u3068\u306a\u308b\u3067\u3057\u3087\u3046\u3002\n\n\u3000ShipType+2\n\u3000\u524d\u8ff0\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u4f8b\u300c\u906d\u9047\u8266\u7a2e\u300d\u30921d6\u306e\u7d50\u679c\u306b+2\u3057\u305f\u6570\u5b57\u3067\u53c2\u7167\u3057\u307e\u3059\u3002\u300c\u906d\u9047\u8266\u7a2e\u300d\u306b\u306f7\u4ee5\u964d\u306e\u8a18\u8f09\u304c\u3042\u308a\u307e\u305b\u3093\u3001\u305d\u306e\u5834\u5408\u300c\uff08\u7d50\u679c\u306a\u3057\uff09\u300d\u3068\u306a\u308b\u3067\u3057\u3087\u3046\u3001\u305d\u308c\u3092\u907f\u3051\u305f\u3044\u5834\u5408\u306f\u524d\u8ff0\u306e\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9 * \u3092\u4f7f\u7528\u3057\u307e\u3059\u3002"}}return n.\u0275fac=function(e){return new(e||n)(Le(ai),Le(kn),Le(In),Le(Ir))},n.\u0275cmp=Zt({type:n,selectors:[["dice-roll-table-setting"]],viewQuery:function(e,i){if(1&e&&on(qZ,5),2&e){let r;sn(r=an())&&(i.diceRollTableSelecter=r.first)}},decls:13,vars:3,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[2,"font-size","smaller","margin-bottom","3px",3,"click"],["size","15",2,"width","14em",3,"change"],["diceRollTableSelecter",""],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[2,"float","right",3,"click"],[4,"ngIf"],[3,"value","title"],[2,"font-size","smaller"],[2,"margin-bottom","3px"],["placeholder","Name",2,"width","60%","min-width","5em",3,"ngModel","ngModelChange"],[2,"white-space","nowrap"],["placeholder","Command",2,"width","7em",3,"ngModel","ngModelChange"],[2,"white-space","nowrap","margin-left","1em"],["placeholder","Dice",2,"width","3.3em","text-align","center",3,"ngModel","ngModelChange"],["placeholder","1:\u6570\u5b57\u3068\u7d50\u679c\u3092:\uff08\u30b3\u30ed\u30f3\uff09\u3067\u533a\u5207\u3063\u3066\u8a18\u8ff0\r\n2:\u7d50\u679c\uff12\r\n3:\u7d50\u679c\uff13\r\n4:\u2026",2,"width","100%","height","20em","margin-top","3px","resize","vertical",3,"ngModel","ngModelChange"],[3,"click"],[2,"float","right"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,i){1&e&&(K(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Te("click",function(){return i.add()}),be(4,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u8ffd\u52a0"),J()(),K(5,"select",3,4),Te("change",function(s){return i.onChangeDiceRollTable(s.target.value)}),xe(7,WZ,2,5,"option",5),J()(),K(8,"div",6)(9,"button",7),Te("click",function(){return i.helpDiceRollTable()}),be(10,"?"),J(),xe(11,QZ,21,10,"ng-container",8),J()(),xe(12,eX,4,1,"ng-container",8)),2&e&&(U(7),te("ngForOf",i.diceRollTables),U(4),te("ngIf",!i.isEmpty&&i.selectedDiceRollTable),U(1),te("ngIf",i.isEmpty))},directives:[ei,zr,jr,_n,fi,hi,oi,Wn],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;font-size:.9em}"]}),n})();const nX=["cutInSelecter"];function iX(n,t){if(1&n&&(K(0,"option",10),be(1),J()),2&n){const e=t.$implicit;Ke("color",e.isValidAudio?""==e.name?"gray":"":"red"),ct("value",e.identifier),ct("title",e.name),U(1),qe((e.isPlayingNow?"\u25b6 ":"\u25a0 ")+(e.isValidAudio?"":"\u26a0\ufe0f")+(""==e.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":e.name))}}function rX(n,t){if(1&n&&(K(0,"div",66)(1,"i",67),be(2),J()()),2&n){const e=ge(2);U(1),sd(e.isShowHideImages?"red-eye":"grow"),U(1),qe(e.isShowHideImages?"visibility":"visibility_off")}}function sX(n,t){if(1&n){const e=Xe();K(0,"button",8),Te("click",function(){return De(e),ge(3).openModal()}),K(1,"b"),be(2,"\u753b\u50cf\u5909\u66f4"),J()()}}function oX(n,t){if(1&n&&(K(0,"div",68),xe(1,sX,3,0,"button",69),J()),2&n){const e=ge(2);U(1),te("ngIf",!e.cutInVideoId||e.cutInisSoundOnly)}}function aX(n,t){if(1&n&&(K(0,"div",70)(1,"i",71),be(2),J()()),2&n){const e=ge(2);U(2),qe(e.cutInPlayListId?"featured_play_list":"movie")}}function lX(n,t){1&n&&(Ve(0),be(1,"\uff08\u3042\u306a\u305f\uff09"),Ge())}function cX(n,t){if(1&n&&(K(0,"option",72),be(1),xe(2,lX,2,0,"ng-container",9),J()),2&n){const e=t.$implicit,i=ge(2);Ke("color",e.color),ct("value",e.identifier),U(1),An("",e.name," "),U(1),te("ngIf",e===i.myPeer)}}function uX(n,t){if(1&n&&(K(0,"option",73),be(1),J()),2&n){const e=t.$implicit;ct("value",e.identifier),U(1),qe(e.name)}}function dX(n,t){1&n&&(K(0,"span",48)(1,"i",76),be(2,"check"),J(),K(3,"span",77),be(4,"Link OK"),J()())}function fX(n,t){if(1&n&&(K(0,"span",78),it(1,"i",79),K(2,"span",80),be(3,"\u26a0\ufe0fLink NG:"),J(),be(4),J()),2&n){const e=ge(3);U(4),An(" ",e.cutInAudioFileName,"")}}function hX(n,t){if(1&n&&(Ve(0),xe(1,dX,5,0,"span",74),xe(2,fX,5,1,"span",75),Ge()),2&n){const e=ge(2);U(1),te("ngIf",e.isValidAudio),U(1),te("ngIf",!e.isValidAudio)}}function pX(n,t){if(1&n&&(K(0,"div",86),be(1),J()),2&n){const e=ge(3);U(1),An("",e.progresPercent,"%")}}const gX=function(n){return{"is-hidden":n}};function mX(n,t){if(1&n){const e=Xe();Ve(0),K(1,"button",8),Te("click",function(){return De(e),ge(2).upTabIndex()}),be(2,"\u2191"),J(),K(3,"button",8),Te("click",function(){return De(e),ge(2).downTabIndex()}),be(4,"\u2193"),J(),K(5,"div",19)(6,"button",81),Te("click",function(){return De(e),ge(2).save()}),K(7,"div",82)(8,"div",83),be(9,"\u4fdd\u5b58"),J(),xe(10,pX,2,1,"div",84),J()(),K(11,"button",85),Te("click",function(){return De(e),ge(2).delete()}),be(12,"\u524a\u9664"),J()(),Ge()}if(2&n){const e=ge(2);U(6),te("disabled",e.isSaveing),U(2),te("ngClass",ut(3,gX,e.isSaveing)),U(2),te("ngIf",e.isSaveing)}}function _X(n,t){if(1&n){const e=Xe();Ve(0),K(1,"button",8),Te("click",function(){return De(e),ge(2).restore()}),be(2,"\u5143\u306b\u623b\u3059"),J(),Ge()}}const $X=function(n){return{blackout:n}},vX=function(n){return{"red-eye":n}},KI=function(n){return{"not-specified":n}},bX=function(n,t){return{color:n,"font-weight":t}};function yX(n,t){if(1&n){const e=Xe();Ve(0),K(1,"div",11)(2,"div")(3,"div",12),Te("dblclick",function(){De(e);const r=ge();return!(!r.isEditable||r.cutInVideoId&&!r.cutInisSoundOnly)&&r.openModal()}),xe(4,rX,3,3,"div",13),xe(5,oX,2,1,"div",14),xe(6,aX,3,1,"div",15),it(7,"img",16),Ct(8,"safe"),J()(),K(9,"div",17)(10,"div",18)(11,"div",19)(12,"label",20)(13,"input",21),Te("click",function(r){return De(e),ge().onShowHiddenImages(r)}),J(),K(14,"i",22),be(15),J()()()(),K(16,"div",23)(17,"b",24),be(18,"Name: "),J(),K(19,"input",25),Te("ngModelChange",function(r){return De(e),ge().cutInName=r}),J(),K(20,"b",26),be(21,"Tag: "),J(),K(22,"input",27),Te("ngModelChange",function(r){return De(e),ge().cutInTag=r}),J()(),K(23,"div",28)(24,"b",24),be(25,"Duration (0=\u7121\u5236\u9650): "),J(),K(26,"input",29),Te("ngModelChange",function(r){return De(e),ge().cutInDuration=r}),J(),K(27,"b",30),be(28,"sec."),J()(),K(29,"div",23)(30,"b",24),be(31,"Cut In: "),J(),K(32,"select",31),Te("ngModelChange",function(r){return De(e),ge().cutInType=r}),K(33,"option",32),be(34,"\u5373\u6642\u51fa\u73fe"),J(),K(35,"option",32),be(36,"\u6d6e\u304d\u51fa\u308b"),J(),K(37,"option",32),be(38,"\u98db\u3073\u51fa\u3059"),J(),K(39,"option",32),be(40,"\u958b\u304f\uff08\u5de6\u53f3\uff09"),J(),K(41,"option",32),be(42,"\u958b\u304f\uff08\u4e0a\u4e0b\uff09"),J()(),K(43,"label",33)(44,"input",34),Te("click",function(){De(e);const r=ge();return r.borderStyle=0==r.borderStyle?1:0}),J(),K(45,"b"),be(46,"\u67a0\u3042\u308a"),J()()(),K(47,"div",23)(48,"b",24),be(49,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e: "),J(),it(50,"br"),K(51,"textarea",35),Te("ngModelChange",function(r){return De(e),ge().cutInCond=r}),J()()()(),K(52,"div",36)(53,"div")(54,"button",8),Te("click",function(){return De(e),ge().testCutIn()}),K(55,"b"),be(56,"\u30c6\u30b9\u30c8 (\u81ea\u5206\u3060\u3051\u898b\u308b)"),K(57,"sup",37),be(58,"*"),J()()(),K(59,"span",38)(60,"button",39),Te("click",function(){return De(e),ge().playCutIn()}),K(61,"b")(62,"i",40),be(63,"play_arrow"),J(),be(64,"\u518d\u751f"),J()(),K(65,"button",41),Te("click",function(){return De(e),ge().stopCutIn()}),K(66,"b")(67,"i",40),be(68,"stop"),J(),be(69,"\u505c\u6b62"),J()(),K(70,"span",42),be(71," \u27a1 "),K(72,"select",43),Te("ngModelChange",function(r){return De(e),ge().sendTo=r}),K(73,"option",44),be(74,"\u5168\u54e1"),J(),xe(75,cX,3,5,"option",45),J()()()(),K(76,"div",46)(77,"div")(78,"b",47),be(79,"\u4f4d\u7f6e"),J(),K(80,"label",48)(81,"input",49),Te("ngModelChange",function(r){return De(e),ge().cutInIsPreventOutBounds=r}),J(),K(82,"b"),be(83,"\u898b\u5207\u308c\u9632\u6b62"),J()()(),K(84,"div",50)(85,"b"),be(86,"PosX: "),J(),K(87,"input",51),Te("ngModelChange",function(r){return De(e),ge().cutInPosX=r}),J(),K(88,"input",52),Te("ngModelChange",function(r){return De(e),ge().cutInPosX=r}),J(),K(89,"b",23),be(90,"%"),J()(),K(91,"div",50)(92,"b"),be(93,"PosY: "),J(),K(94,"input",53),Te("ngModelChange",function(r){return De(e),ge().cutInPosY=r}),J(),K(95,"input",52),Te("ngModelChange",function(r){return De(e),ge().cutInPosY=r}),J(),K(96,"b",23),be(97,"%"),J()(),K(98,"div",50)(99,"b"),be(100,"Z-Index (\u5927\u304d\u3044\u3082\u306e\u304c\u524d): "),J(),K(101,"input",52),Te("ngModelChange",function(r){return De(e),ge().cutInZIndex=r}),J(),K(102,"label",48)(103,"input",54),Te("ngModelChange",function(r){return De(e),ge().cutInIsFrontOfStand=r}),J(),K(104,"b"),be(105,"\u30b9\u30bf\u30f3\u30c9\u306e\u524d\u9762\u306b\u8868\u793a"),J()()()(),K(106,"div",46)(107,"div")(108,"b",47),be(109,"\u30b5\u30a4\u30ba\uff08\u5e45\u3001\u9ad8\u3055\u5171\u306b0\u306e\u5834\u5408\u306f\u5143\u753b\u50cf\u306e\u307e\u307e\uff09"),J()(),K(110,"div",50)(111,"b"),be(112,"Width (0=\u6307\u5b9a\u306a\u3057): "),J(),K(113,"input",55),Te("ngModelChange",function(r){return De(e),ge().cutInWidth=r}),J(),K(114,"input",52),Te("ngModelChange",function(r){return De(e),ge().cutInWidth=r}),J(),K(115,"b",23),be(116,"%"),J()(),K(117,"div",50)(118,"b"),be(119,"Height (0=\u6307\u5b9a\u306a\u3057): "),J(),K(120,"input",56),Te("ngModelChange",function(r){return De(e),ge().cutInHeight=r}),J(),K(121,"input",52),Te("ngModelChange",function(r){return De(e),ge().cutInHeight=r}),J(),K(122,"b",23),be(123,"%"),J()(),K(124,"div",50)(125,"b"),be(126,"\u5143\u753b\u50cf\u3068\u7e26\u6a2a\u6bd4\u304c\u7570\u306a\u308b\u5834\u5408: "),J(),K(127,"select",57),Te("ngModelChange",function(r){return De(e),ge().objectFitType=r}),K(128,"option",32),be(129,"\u4f38\u7e2e\u3059\u308b"),J(),K(130,"option",32),be(131,"\u5207\u308a\u53d6\u308b"),J()()()(),K(132,"div",46)(133,"div")(134,"b",47),be(135,"\u52b9\u679c\u97f3\u30fb\u52d5\u753b"),J(),K(136,"label",48)(137,"input",58),Te("ngModelChange",function(r){return De(e),ge().cutInSEIsLoop=r}),J(),K(138,"b"),be(139,"\u7e70\u308a\u8fd4\u3057"),J()()(),K(140,"div",50)(141,"input",59),Te("ngModelChange",function(r){return De(e),ge().cutInIsVideo=r}),J(),K(142,"label",60)(143,"b"),be(144,"\u97f3\u697d\u30d5\u30a1\u30a4\u30eb: "),J()(),K(145,"select",61),Te("ngModelChange",function(r){return De(e),ge().cutInAudioIdentifier=r})("change",function(r){return De(e),ge().onAudioFileChange(r.target.value)}),K(146,"option",44),be(147,"\u52b9\u679c\u97f3\u306a\u3057"),J(),xe(148,uX,2,2,"option",62),J(),xe(149,hX,3,2,"ng-container",9),J(),K(150,"div",50)(151,"input",59),Te("ngModelChange",function(r){return De(e),ge().cutInIsVideo=r}),J(),K(152,"label",60)(153,"b"),be(154,"\u52d5\u753bURL: "),J()(),K(155,"input",63),Te("ngModelChange",function(r){return De(e),ge().cutInVideoURL=r}),J()(),K(156,"div",64)(157,"a",65),Te("click",function(){return De(e),ge().openYouTubeTerms()}),be(158,"YouTube \u5229\u7528\u898f\u7d04"),J()()()(),it(159,"hr"),K(160,"div"),xe(161,mX,13,5,"ng-container",9),xe(162,_X,3,0,"ng-container",9),J(),Ge()}if(2&n){const e=ge();U(4),te("ngIf",(!e.cutInVideoId||e.cutInisSoundOnly)&&e.getHidden(e.cutInImage)),U(1),te("ngIf",e.isEditable),U(1),te("ngIf",e.cutInVideoId&&!e.cutInisSoundOnly),U(1),te("ngClass",ut(125,$X,(!e.cutInVideoId||e.cutInisSoundOnly)&&!e.isShowHideImages&&e.getHidden(e.cutInImage)))("src",xt(8,122,e.cutInImageUrl,"resourceUrl"),Jt),U(6),ct("checked",e.isShowHideImages?"checked":""),U(1),te("ngClass",ut(127,vX,e.isShowHideImages)),U(1),qe(e.isShowHideImages?"visibility":"visibility_off"),U(4),te("ngModel",e.cutInName),Rt("disabled",e.isEditable?null:""),U(3),te("ngModel",e.cutInTag),Rt("disabled",e.isEditable?null:""),U(4),te("ngModel",e.cutInDuration),Rt("disabled",!e.isEditable||e.isPlaying?"":null),U(6),te("ngModel",e.cutInType),Rt("disabled",e.isEditable?null:""),U(1),te("value",-1)("selected",-1==e.cutInType),U(2),te("value",0)("selected",0==e.cutInType),U(2),te("value",1)("selected",1==e.cutInType),U(2),te("value",2)("selected",2==e.cutInType),U(2),te("value",3)("selected",3==e.cutInType),U(3),te("checked",1==e.borderStyle),Rt("disabled",e.isEditable?null:""),U(7),te("ngModel",e.cutInCond),Rt("disabled",e.isEditable?null:""),U(3),Rt("disabled",e.isEditable?null:""),U(6),Rt("disabled",e.isEditable?null:""),U(5),Rt("disabled",e.isEditable?null:""),U(7),te("ngModel",e.sendTo)("ngClass",ut(129,KI,""==e.sendTo))("ngStyle",Kt(131,bX,""==e.sendTo?null:e.sendToColor,""==e.sendTo?"normal":"bolder")),U(3),te("ngForOf",e.otherPeers),U(6),te("ngModel",e.cutInIsPreventOutBounds)("checked",e.cutInIsPreventOutBounds)("value",!0),Rt("disabled",!e.isEditable||e.cutInVideoId?"":null),U(6),ct("title",e.cutInPosX),ct("min",e.minSize),ct("max",e.maxSize),te("ngModel",e.cutInPosX),Rt("disabled",e.isEditable?null:""),U(1),ct("min",e.minSize),ct("max",e.maxSize),te("ngModel",e.cutInPosX),Rt("disabled",e.isEditable?null:""),U(6),ct("title",e.cutInPosY),ct("min",e.minSize),ct("max",e.maxSize),te("ngModel",e.cutInPosY),Rt("disabled",e.isEditable?null:""),U(1),ct("min",e.minSize),ct("max",e.maxSize),te("ngModel",e.cutInPosY),Rt("disabled",e.isEditable?null:""),U(6),ct("min",-e.maxSize),ct("max",e.maxSize),te("ngModel",e.cutInZIndex),Rt("disabled",!e.isEditable||e.cutInVideoId?"":null),U(2),te("ngModel",e.cutInIsFrontOfStand)("checked",e.cutInIsFrontOfStand)("value",!0),Rt("disabled",!e.isEditable||e.cutInVideoId?"":null),U(10),ct("title",e.cutInWidth),ct("min",e.minSize),ct("max",e.maxSize),te("ngModel",e.cutInWidth),Rt("disabled",e.isEditable?null:""),U(1),ct("min",e.minSize),ct("max",2*e.maxSize),te("ngModel",e.cutInWidth),Rt("disabled",e.isEditable?null:""),U(6),ct("title",e.cutInHeight),ct("min",e.minSize),ct("max",e.maxSize),te("ngModel",e.cutInHeight),Rt("disabled",e.isEditable?null:""),U(1),ct("min",e.minSize),ct("max",2*e.maxSize),te("ngModel",e.cutInHeight),Rt("disabled",e.isEditable?null:""),U(6),te("ngModel",e.objectFitType),Rt("disabled",e.cutInVideoId&&!e.cutInisSoundOnly||!e.isEditable?"":null),U(1),te("value",0)("selected",0==e.objectFitType),U(2),te("value",1)("selected",1==e.objectFitType),U(7),te("ngModel",e.cutInSEIsLoop)("checked",e.cutInSEIsLoop)("value",!0),Rt("disabled",!e.isEditable||e.isPlaying?"":null),U(4),Wi("name","",e.panelId,"-media")("id","",e.panelId,"-media-sound"),te("ngModel",e.cutInIsVideo)("checked",!e.cutInIsVideo)("value",!1),Rt("disabled",!e.isEditable||e.isPlaying?"":null),U(1),Wi("for","",e.panelId,"-media-sound"),U(3),Ke("min-width",e.isValidAudio?10:5,"em")("max-width",e.isValidAudio?20:5,"em"),te("ngModel",e.cutInAudioIdentifier)("ngClass",ut(134,KI,""==e.cutInAudioIdentifier)),Rt("disabled",e.cutInIsVideo||!e.isEditable||e.isPlaying?"":null),U(3),te("ngForOf",e.audios),U(1),te("ngIf",e.isEditable&&e.cutInAudioFileName.length>0),U(2),Wi("name","",e.panelId,"-media")("id","",e.panelId,"-media-video"),te("ngModel",e.cutInIsVideo)("checked",e.cutInIsVideo)("value",!0),Rt("disabled",!e.isEditable||e.isPlaying?"":null),U(1),Wi("for","",e.panelId,"-media-video"),U(3),te("ngModel",e.cutInVideoURL),Rt("disabled",e.cutInIsVideo&&e.isEditable&&!e.isPlaying?null:""),U(6),te("ngIf",!e.isDeleted),U(1),te("ngIf",e.isDeleted&&e.selectedCutInXml)}}function CX(n,t){if(1&n){const e=Xe();Ve(0),K(1,"button",8),Te("click",function(){return De(e),ge(2).restore()}),be(2,"\u5143\u306b\u623b\u3059"),J(),Ge()}}function xX(n,t){if(1&n&&(Ve(0),K(1,"div",87),be(2," \u203b\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u3042\u308a\u307e\u305b\u3093\u3002 "),xe(3,CX,3,0,"ng-container",9),J(),Ge()),2&n){const e=ge();U(3),te("ngIf",e.isDeleted&&e.selectedCutInXml)}}let wX=(()=>{class n{constructor(e,i,r,s,o,c){this.changeDetector=e,this.pointerDeviceService=i,this.modalService=r,this.panelService=s,this.saveDataService=o,this.chatMessageService=c,this.minSize=0,this.maxSize=100,this.isShowHideImages=!1,this.selectedCutIn=null,this.selectedCutInXml="",this.sendTo="",this.isSaveing=!1,this.progresPercent=0}get cutIns(){return po.instance.cutIns}get cutInName(){return this.selectedCutIn.name}set cutInName(e){this.isEditable&&(this.selectedCutIn.name=e)}get cutInTag(){return this.selectedCutIn.tag}set cutInTag(e){this.isEditable&&(this.selectedCutIn.tag=e)}get cutInDuration(){return this.selectedCutIn.duration}set cutInDuration(e){this.isEditable&&(this.selectedCutIn.duration=e)}get cutInCond(){return this.selectedCutIn.value+""}set cutInCond(e){this.isEditable&&(this.selectedCutIn.value=e)}get cutInIsPreventOutBounds(){return this.selectedCutIn.isPreventOutBounds}set cutInIsPreventOutBounds(e){this.isEditable&&(this.selectedCutIn.isPreventOutBounds=e)}get cutInWidth(){return this.selectedCutIn.width}set cutInWidth(e){this.isEditable&&(this.selectedCutIn.width=e)}get cutInHeight(){return this.selectedCutIn.height}set cutInHeight(e){this.isEditable&&(this.selectedCutIn.height=e)}get objectFitType(){return this.selectedCutIn.objectFitType}set objectFitType(e){this.isEditable&&(this.selectedCutIn.objectFitType=e)}get cutInPosX(){return this.selectedCutIn.posX}set cutInPosX(e){this.isEditable&&(this.selectedCutIn.posX=e)}get cutInPosY(){return this.selectedCutIn.posY}set cutInPosY(e){this.isEditable&&(this.selectedCutIn.posY=e)}get cutInZIndex(){return this.selectedCutIn.zIndex}set cutInZIndex(e){this.isEditable&&(this.selectedCutIn.zIndex=e)}get cutInIsFrontOfStand(){return this.selectedCutIn.isFrontOfStand}set cutInIsFrontOfStand(e){this.isEditable&&(this.selectedCutIn.isFrontOfStand=e)}get cutInAudioIdentifier(){return this.selectedCutIn.audioIdentifier}set cutInAudioIdentifier(e){this.isEditable&&(this.selectedCutIn.audioIdentifier=e)}get cutInAudioFileName(){return this.selectedCutIn.audioFileName}set cutInAudioFileName(e){this.isEditable&&(this.selectedCutIn.audioFileName=e)}get cutInSEIsLoop(){return this.selectedCutIn.isLoop}set cutInSEIsLoop(e){this.isEditable&&(this.selectedCutIn.isLoop=e)}get cutInType(){return this.selectedCutIn.animationType}set cutInType(e){this.isEditable&&(this.selectedCutIn.animationType=e)}get borderStyle(){return this.selectedCutIn.borderStyle}set borderStyle(e){this.isEditable&&(this.selectedCutIn.borderStyle=e)}get isEmpty(){return this.cutIns.length<1}get isDeleted(){return!!this.selectedCutIn&&null==lt.instance.get(this.selectedCutIn.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}get cutInIsVideo(){return this.selectedCutIn.isVideoCutIn}set cutInIsVideo(e){this.isEditable&&(this.selectedCutIn.isVideoCutIn=e)}get cutInVideoURL(){return this.selectedCutIn.videoUrl}set cutInVideoURL(e){this.isEditable&&(this.selectedCutIn.videoUrl=e)}get cutInisSoundOnly(){return this.selectedCutIn.isSoundOnly}set cutInisSoundOnly(e){this.isEditable&&(this.selectedCutIn.isSoundOnly=e)}get cutInVideoId(){return this.selectedCutIn?this.selectedCutIn.videoId:""}get cutInPlayListId(){return this.cutInVideoId?this.selectedCutIn.playListId:""}get cutInImage(){return this.selectedCutIn&&kt.instance.get(this.selectedCutIn.imageIdentifier)||Ht.Empty}get cutInImageUrl(){return this.selectedCutIn?!this.selectedCutIn.videoId||this.cutInisSoundOnly?this.cutInImage.url:`https://img.youtube.com/vi/${this.selectedCutIn.videoId}/hqdefault.jpg`:Ht.Empty.url}get isPlaying(){return!!this.selectedCutIn&&Gp.nowShowingIdentifiers().includes(this.selectedCutIn.identifier)}get isValidAudio(){return!this.selectedCutIn||this.selectedCutIn.isValidAudio}get myPeer(){return Ue.myCursor}get otherPeers(){return lt.instance.getObjects(Ue)}get myColor(){return Ue.myCursor&&Ue.myCursor.color&&Ue.myCursor.color!=Ue.CHAT_TRANSPARENT_COLOR?Ue.myCursor.color:Ue.CHAT_DEFAULT_COLOR}get sendToColor(){let e=lt.instance.get(this.sendTo);return e instanceof Ue?e.color:Ue.CHAT_DEFAULT_COLOR}get audios(){return Lt.instance.audios.filter(e=>!e.isHidden)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30ab\u30c3\u30c8\u30a4\u30f3\u8a2d\u5b9a"),Fe.register(this).on("SYNCHRONIZE_AUDIO_LIST",-1e3,e=>{this.onAudioFileChange()}),this.panelId=ns.generateUuid()}ngAfterViewInit(){this.cutIns.length>0&&queueMicrotask(()=>{this.onChangeCutIn(this.cutIns[0].identifier),this.cutInSelecter.nativeElement.selectedIndex=0})}ngOnDestroy(){Fe.unregister(this)}onChangeCutIn(e){this.selectedCutIn=lt.instance.get(e),this.selectedCutInXml=""}create(e="\u30ab\u30c3\u30c8\u30a4\u30f3"){return po.instance.addCutIn(e)}add(){const e=this.create();e.imageIdentifier="stand_no_image",queueMicrotask(()=>{this.onChangeCutIn(e.identifier),this.cutInSelecter.nativeElement.value=e.identifier})}save(){var e=this;return(0,en.Z)(function*(){if(!e.selectedCutIn||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i="fly_cutIn_"+e.selectedCutIn.name;yield e.saveDataService.saveGameObjectAsync(e.selectedCutIn,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}delete(){!this.selectedCutIn||(Fe.call("STOP_CUT_IN",{identifier:this.selectedCutIn.identifier}),this.isEmpty||(this.selectedCutInXml=this.selectedCutIn.toXml(),this.selectedCutIn.destroy()))}restore(){if(this.selectedCutIn&&this.selectedCutInXml){let e=Zn.instance.parseXml(this.selectedCutInXml);po.instance.addCutIn(e),this.selectedCutInXml="",queueMicrotask(()=>{const i=this.cutIns;this.onChangeCutIn(i[i.length-1].identifier),this.cutInSelecter.nativeElement.selectedIndex=i.length-1})}}getHidden(e){const i=yn.get(e.identifier);return!!i&&i.hide}upTabIndex(){if(!this.selectedCutIn)return;let e=this.selectedCutIn.parent,i=e.children.indexOf(this.selectedCutIn);0<i&&e.insertBefore(this.selectedCutIn,e.children[i-1])}downTabIndex(){if(!this.selectedCutIn)return;let e=this.selectedCutIn.parent,i=e.children.indexOf(this.selectedCutIn);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.selectedCutIn)}openModal(){if(this.isDeleted)return;let e=[];this.selectedCutIn&&this.selectedCutIn.imageIdentifier&&(e=[this.selectedCutIn.imageIdentifier]),this.modalService.open(Lo,{currentImageIdentifires:e}).then(i=>{!this.selectedCutIn||!i||(this.selectedCutIn.imageIdentifier=i)})}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(Qi,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:Ci.OK_CANCEL,materialIcon:"visibility",action:()=>{this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}playCutIn(){const e=this.selectedCutIn;if(!e)return;const i={identifier:e.identifier,secret:!!this.sendTo,sender:Ue.myCursor.peerId};if(i.secret){const r=lt.instance.get(this.sendTo);r&&(r.peerId!=Ue.myCursor.peerId&&Fe.call("PLAY_CUT_IN",i,r.peerId),Fe.call("PLAY_CUT_IN",i,Ue.myCursor.peerId))}else Fe.call("PLAY_CUT_IN",i),this.chatMessageService.sendOperationLog((""==e.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":e.name)+" \u3092\u518d\u751f\u3057\u305f")}stopCutIn(){if(!this.selectedCutIn)return;const e={identifier:this.selectedCutIn.identifier,secret:!!this.sendTo,sender:Ue.myCursor.peerId};if(e.secret){const i=lt.instance.get(this.sendTo);i&&(i.peerId!=Ue.myCursor.peerId&&Fe.call("STOP_CUT_IN",e,i.peerId),Fe.call("STOP_CUT_IN",e,Ue.myCursor.peerId))}else Fe.call("STOP_CUT_IN",e)}testCutIn(){!this.selectedCutIn||queueMicrotask(()=>{Fe.trigger("PLAY_CUT_IN",{identifier:this.selectedCutIn.identifier,test:!0})})}onAudioFileChange(e=""){if(!e&&this.selectedCutIn&&(e=this.selectedCutIn.audioIdentifier),""==e)return void(this.cutInAudioFileName="");const i=Lt.instance.get(e);this.cutInAudioFileName=i?i.name:""}openYouTubeTerms(){return this.modalService.open(Hr,{url:"https://www.youtube.com/terms",title:"YouTube \u5229\u7528\u898f\u7d04"}),!1}helpCutIn(){let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(du,{left:e.x,top:e.y,width:600,height:620});r.title="\u30ab\u30c3\u30c8\u30a4\u30f3\u30d8\u30eb\u30d7",r.text=`\u3000\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u540d\u524d\u3001\u8868\u793a\u6642\u9593\u3001\u4f4d\u7f6e\u3068\u5e45\u3068\u9ad8\u3055\uff08\u305d\u308c\u305e\u308c\u753b\u9762\u30b5\u30a4\u30ba\u306b\u5bfe\u3059\u308b\u76f8\u5bfe\u6307\u5b9a\uff09\u3001\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u306b\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u8868\u793a\u3055\u308c\u308b\u6761\u4ef6\u3092\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\u307e\u305f\u3001\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u5834\u5408\u304a\u3088\u3073\u300c\u898b\u5207\u308c\u9632\u6b62\u300d\u306b\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u305f\u5834\u5408\u3001\u753b\u9762\u5185\u306b\u53ce\u307e\u308b\u3088\u3046\u306b\u4f4d\u7f6e\u3068\u30b5\u30a4\u30ba\u304c\u8abf\u6574\u3055\u308c\u307e\u3059\u3002\n\u3000\n\u3000\u6a2a\u4f4d\u7f6e\uff08PosX\uff09\u3068\u7e26\u4f4d\u7f6e\uff08PosY\uff09\u306f\u3001\u753b\u9762\u306e\u5de6\u4e0a\u9685\u304b\u3089\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u4e2d\u5fc3\u4f4d\u7f6e\u307e\u3067\u306e\u8ddd\u96e2\u3068\u306a\u308a\u307e\u3059\u3002\u30b5\u30a4\u30ba\u306e\u5e45\uff08Width\uff09\u3068\u9ad8\u3055\uff08Height\uff09\u306e\u3069\u3061\u3089\u304b\u30920\u3068\u3057\u305f\u5834\u5408\u3001\u5143\u753b\u50cf\u306e\u7e26\u6a2a\u6bd4\u3092\u4fdd\u3063\u3066\u62e1\u5927\u7e2e\u5c0f\u3057\u307e\u3059\uff08\u305f\u3060\u3057\u3001\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u6700\u5c0f\u5e45\u3001\u9ad8\u3055\u306f${uT.MIN_SIZE}\u30d4\u30af\u30bb\u30eb\u3068\u306a\u308a\u307e\u3059\uff09\u3002\n\u3000\n\u3000\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u5fc5\u305a\u524d\u9762\u3001\u305d\u306e\u4ed6\u306f\u5f8c\u304b\u3089\u8868\u793a\u3055\u308c\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u753b\u50cf\u304c\u3088\u308a\u524d\u9762\u306b\u306a\u308a\u307e\u3059\u304c\u3001\u91cd\u306a\u308a\u9806\uff08Z-Index\uff09\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3067\u5236\u5fa1\u53ef\u80fd\u3067\u3059\u3002\u540c\u3058\u30ab\u30c3\u30c8\u30a4\u30f3\u3001\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u3001\u540c\u3058\u30bf\u30b0\u304c\u6307\u5b9a\u3055\u308c\u305f\u30ab\u30c3\u30c8\u30a4\u30f3\u3092\u518d\u751f\u3059\u308b\u5834\u5408\u306f\u3001\u4ee5\u524d\u306e\u3082\u306e\u306f\u505c\u6b62\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u6761\u4ef6\u3092\u6e80\u305f\u3059\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u8907\u6570\u3042\u308b\u5834\u5408\u3001\n\n\u3000\u3000\u30fb\u30bf\u30b0\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3082\u306e\u306f\u3059\u3079\u3066\n\u3000\u3000\u30fb\u30bf\u30b0\u304c\u8a2d\u5b9a\u3055\u308c\u305f\u3082\u306e\u306f\u3001\u540c\u3058\u30bf\u30b0\u306e\u3082\u306e\u306e\u4e2d\u304b\u3089\u30e9\u30f3\u30c0\u30e0\u306b1\u3064\n\u3000\u3000\u30fb\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u4e0a\u8a18\u306e\u4e2d\u304b\u3089\u30e9\u30f3\u30c0\u30e0\u306b1\u3064\u3092\u9078\u629e\n\n\u3068\u306a\u308a\u307e\u3059\u3002\n\n\u3000\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u30c9\u30e9\u30c3\u30b0\u306b\u3088\u3063\u3066\u79fb\u52d5\u53ef\u80fd\u3067\u3059\uff08\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u7aef\u3092\u30c9\u30e9\u30c3\u30b0\uff09\u3002\u307e\u305f\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af\u3067\u9589\u3058\u308b\uff08\u81ea\u5206\u3060\u3051\u505c\u6b62\uff09\u3001\u53f3\u30af\u30ea\u30c3\u30af\u3067\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u64cd\u4f5c\u304c\u53ef\u80fd\u3067\u3059\uff08\u300c\u9589\u3058\u308b\u300d\u300c\u30a6\u30a3\u30f3\u30c9\u30a6\u306e\u80cc\u9762\u306b\u8868\u793a\u300d\u300c\u6700\u5c0f\u5316\u300d\u304c\u53ef\u80fd\u3001\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u7aef\u3067\u53d7\u4ed8\uff09\u3002\n\n\u3000\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u3092\u30ab\u30c3\u30c8\u30a4\u30f3\u8868\u793a\u6642\u306e\u52b9\u679c\u97f3\u3068\u3057\u3066\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\u97f3\u91cf\u306b\u306f\u30b8\u30e5\u30fc\u30af\u30dc\u30c3\u30af\u30b9\u306e\u8a2d\u5b9a\uff08\u300c\u30c6\u30b9\u30c8 (\u81ea\u5206\u3060\u3051\u898b\u308b)\u300d\u306e\u5834\u5408\u306f\u8a66\u8074\u97f3\u91cf\uff09\u304c\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002\u8868\u793a\u6642\u9593\u3084\u624b\u52d5\u64cd\u4f5c\u306b\u3088\u3063\u3066\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u505c\u6b62\u3057\u305f\u969b\u306b\u306f\u3001\u9014\u4e2d\u3067\u3042\u3063\u3066\u3082\u97f3\u58f0\u3082\u505c\u6b62\u3057\u307e\u3059\u3002\u30ab\u30c3\u30c8\u30a4\u30f3\u3084\u90e8\u5c4b\u306e\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u306b\u306f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u542b\u307e\u308c\u307e\u305b\u3093\u306e\u3067\u3001\u5fc5\u8981\u3067\u3057\u305f\u3089\u5225\u9014\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u304f\u3060\u3055\u3044\uff08\u30ab\u30c3\u30c8\u30a4\u30f3\u3068\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306e\u30ea\u30f3\u30af\u306f\u30d5\u30a1\u30a4\u30eb\u306e\u5185\u5bb9\u306b\u3088\u308a\u307e\u3059\u3001\u540c\u540d\u306e\u5225\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u3082\u518d\u30ea\u30f3\u30af\u3055\u308c\u307e\u305b\u3093\uff09\u3002\n\n\u3000\u30ab\u30c3\u30c8\u30a4\u30f3\u306b\u52d5\u753b\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u3001URL\u306f\u73fe\u5728YouTube\u306e\u3082\u306e\u306e\u307f\u6709\u52b9\u3067\u3059\u3002\u52d5\u753b\u3092\u5229\u7528\u3059\u308b\u969b\u306f\u6a29\u5229\u8005\u304a\u3088\u3073YouTube\u306e\u5b9a\u3081\u305f\u5229\u7528\u898f\u7d04\u3092\u53c2\u7167\u3057\u3001\u9806\u5b88\u3057\u3066\u304f\u3060\u3055\u3044\u3002`}}return n.\u0275fac=function(e){return new(e||n)(Le(Di),Le(ai),Le(kn),Le(In),Le(Ir),Le(Er))},n.\u0275cmp=Zt({type:n,selectors:[["app-cut-in-setting"]],viewQuery:function(e,i){if(1&e&&on(nX,5),2&e){let r;sn(r=an())&&(i.cutInSelecter=r.first)}},decls:14,vars:3,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[2,"font-size","smaller","margin-bottom","3px",3,"click"],["size","15",2,"width","12em",3,"change"],["cutInSelecter",""],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[2,"float","right","margin-top","3px","margin-right","3px"],[3,"click"],[4,"ngIf"],[3,"value","title"],[2,"display","flex"],[2,"position","relative","overflow","hidden",3,"dblclick"],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["style","position: absolute; top: 1px; left: -1px; z-index: 5",4,"ngIf"],["class","grow","style","opacity: 0.8; position: absolute; bottom: 1px; right: -1px; z-index: 5",4,"ngIf"],[2,"width","160px","height","160px","object-fit","contain",3,"ngClass","src"],[2,"display","flex","flex-direction","column","width","100%"],[2,"padding-bottom","2px"],[2,"float","right"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[2,"padding-left","2px"],[2,"font-size","smaller"],["type","text","placeholder","Name",2,"width","8em",3,"ngModel","ngModelChange"],[2,"font-size","smaller","margin-left","1em"],["type","text","placeholder","Tag",2,"width","3em",3,"ngModel","ngModelChange"],[2,"padding-left","2px","padding-top","2px"],["type","number","min","0","max","1000",2,"width","3.5em",3,"ngModel","ngModelChange"],[2,"font-size","smaller","padding-left","2px"],[2,"min-width","8em",3,"ngModel","ngModelChange"],[3,"value","selected"],[2,"margin-left","1em","font-size","smaller"],["name","borderStyle","type","checkbox",3,"checked","click"],["placeholder","1\u884c\u306b\u4e00\u3064\u3001\u5192\u982d@\u3067\u30de\u30c3\u30c1\u6642\u306b\u30c6\u30ad\u30b9\u30c8\u304b\u3089\u5207\u308a\u53d6\u308a\r\n@\u8857\u4e26\u307f",2,"width","100%","height","3em",3,"ngModel","ngModelChange"],[2,"font-size","smaller","display","flex","flex-direction","column","width","100%"],[1,"self-only"],[2,"margin-left","2em"],[2,"margin-right","0px",3,"click"],[1,"material-icons",2,"font-size","smaller"],[2,"margin-left","0px",3,"click"],[2,"white-space","nowrap"],[2,"max-width","10em",3,"ngModel","ngClass","ngStyle","ngModelChange"],["value","",1,"not-specified"],["style","font-weight: bolder;",3,"value","color",4,"ngFor","ngForOf"],[1,"section"],[1,"header"],[2,"margin-left","0.6em"],["name","cutInIsPreventOutBounds","type","checkbox",3,"ngModel","checked","value","ngModelChange"],[2,"padding-left","1em"],["type","range","name","cutInPosX",2,"width","180px",3,"ngModel","title","min","max","ngModelChange"],["type","number",2,"width","3.5em",3,"ngModel","min","max","ngModelChange"],["type","range","name","cutInPosY",2,"width","180px",3,"ngModel","title","min","max","ngModelChange"],["name","cutInIsFrontOfStand","type","checkbox",3,"ngModel","checked","value","ngModelChange"],["type","range","name","cutInWidth",2,"width","180px",3,"ngModel","title","min","max","ngModelChange"],["type","range","name","cutIHeight",2,"width","180px",3,"ngModel","title","min","max","ngModelChange"],[3,"ngModel","ngModelChange"],["name","cutInSEIsLoop","type","checkbox",3,"ngModel","checked","value","ngModelChange"],["type","radio",3,"name","id","ngModel","checked","value","ngModelChange"],[3,"for"],[3,"ngModel","ngClass","ngModelChange","change"],["style","color: black",3,"value",4,"ngFor","ngForOf"],["type","text",2,"width","24em",3,"ngModel","ngModelChange"],[2,"padding-left","2.5em"],["href","https://www.youtube.com/terms","target","_blank",1,"outer-link",3,"click"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons",2,"margin-right","2px","font-size","16px","display","block"],[2,"position","absolute","top","1px","left","-1px","z-index","5"],[3,"click",4,"ngIf"],[1,"grow",2,"opacity","0.8","position","absolute","bottom","1px","right","-1px","z-index","5"],[1,"material-icons",2,"font-size","32px"],[2,"font-weight","bolder",3,"value"],[2,"color","black",3,"value"],["style","margin-left: 0.6em",4,"ngIf"],["style","margin-left: 0.6em; color: red; display:inline-block; white-space: nowrap; max-width: 20em; overflow: hidden; text-overflow: ellipsis",4,"ngIf"],[1,"material-icons",2,"font-size","14px"],[2,"color","blue"],[2,"margin-left","0.6em","color","red","display","inline-block","white-space","nowrap","max-width","20em","overflow","hidden","text-overflow","ellipsis"],[1,"material-icons"],[2,"font-weight","bolder"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,i){1&e&&(K(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Te("click",function(){return i.add()}),be(4,"\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u8ffd\u52a0"),J()(),K(5,"select",3,4),Te("change",function(s){return i.onChangeCutIn(s.target.value)}),xe(7,iX,2,5,"option",5),J()(),K(8,"div",6)(9,"div",7)(10,"button",8),Te("click",function(){return i.helpCutIn()}),be(11,"?"),J()(),xe(12,yX,163,136,"ng-container",9),J()(),xe(13,xX,4,1,"ng-container",9)),2&e&&(U(7),te("ngForOf",i.cutIns),U(5),te("ngIf",!i.isEmpty&&i.selectedCutIn),U(1),te("ngIf",i.isEmpty))},directives:[ei,zr,jr,_n,Wn,fi,hi,oi,So,Io,gs,es,Zi,Jr,ms,Aa],pipes:[ti],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.header[_ngcontent-%COMP%]{margin-top:3px}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;font-size:.9em}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.blackout[_ngcontent-%COMP%]{filter:blur(12px) grayscale(70%)}.self-only[_ngcontent-%COMP%]{color:red}img[_ngcontent-%COMP%]{transition:all .1s 0s ease}.self-setting[_ngcontent-%COMP%]{font-weight:bolder;font-size:smaller}input[type=number][_ngcontent-%COMP%]{text-align:right}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.not-specified[_ngcontent-%COMP%]{color:gray}.self-only[_ngcontent-%COMP%]{color:red;vertical-align:text-top}.section[_ngcontent-%COMP%]{margin-top:.4em}"]}),n})();function YI(n){return new f(t=>{pr(n()).subscribe(t)})}const TX=["addListener","removeListener"],IX=["addEventListener","removeEventListener"],SX=["on","off"];function hg(n,t,e,i){if(a(e)&&(i=e,e=void 0),i)return hg(n,t,e).pipe(Td(i));const[r,s]=function DX(n){return a(n.addEventListener)&&a(n.removeEventListener)}(n)?IX.map(o=>c=>n[o](t,c,e)):function MX(n){return a(n.addListener)&&a(n.removeListener)}(n)?TX.map(ZI(n,t)):function kX(n){return a(n.on)&&a(n.off)}(n)?SX.map(ZI(n,t)):[];if(!r&&sl(n))return qo(o=>hg(o,t,e))(pr(n));if(!r)throw new TypeError("Invalid event target");return new f(o=>{const c=(...m)=>o.next(1<m.length?m:m[0]);return r(c),()=>s(c)})}function ZI(n,t){return e=>i=>n[e](t,i)}const tl=new f(G);class AX extends d{constructor(t,e){super()}schedule(t,e=0){return this}}const pg={setInterval(n,t,...e){const{delegate:i}=pg;return(null==i?void 0:i.setInterval)?i.setInterval(n,t,...e):setInterval(n,t,...e)},clearInterval(n){const{delegate:t}=pg;return((null==t?void 0:t.clearInterval)||clearInterval)(n)},delegate:void 0},XI={now:()=>(XI.delegate||Date).now(),delegate:void 0};class ff{constructor(t,e=ff.now){this.schedulerActionCtor=t,this.now=e}schedule(t,e=0,i){return new this.schedulerActionCtor(this,t).schedule(i,e)}}ff.now=XI.now;const QI=new class NX extends ff{constructor(t,e=ff.now){super(t,e),this.actions=[],this._active=!1}flush(t){const{actions:e}=this;if(this._active)return void e.push(t);let i;this._active=!0;do{if(i=t.execute(t.state,t.delay))break}while(t=e.shift());if(this._active=!1,i){for(;t=e.shift();)t.unsubscribe();throw i}}}(class PX extends AX{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){var i;if(this.closed)return this;this.state=t;const r=this.id,s=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(s,r,e)),this.pending=!0,this.delay=e,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(s,this.id,e),this}requestAsyncId(t,e,i=0){return pg.setInterval(t.flush.bind(t,this),i)}recycleAsyncId(t,e,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return e;null!=e&&pg.clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(t,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let r,i=!1;try{this.work(t)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:t,scheduler:e}=this,{actions:i}=e;this.work=this.state=this.scheduler=null,this.pending=!1,p(i,this),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null,super.unsubscribe()}}}),FX=QI;function JI(n,t){return t?e=>Up(t.pipe(Oo(1),function OX(){return O((n,t)=>{n.subscribe(re(t,G))})}()),e.pipe(JI(n))):qo((e,i)=>n(e,i).pipe(Oo(1),function RX(n){return ve(()=>n)}(e)))}const hf="Service workers are disabled or not supported by this browser";class gg{constructor(t){if(this.serviceWorker=t,t){const i=hg(t,"controllerchange").pipe(ve(()=>t.controller)),s=Up(YI(()=>Ka(t.controller)),i);this.worker=s.pipe(Hl(Z=>!!Z)),this.registration=this.worker.pipe(ef(()=>t.getRegistration()));const I=hg(t,"message").pipe(ve(Z=>Z.data)).pipe(Hl(Z=>Z&&Z.type)).pipe(rT());I.connect(),this.events=I}else this.worker=this.events=this.registration=function jX(n){return YI(()=>function EX(n,t){const e=a(n)?n:()=>n,i=r=>r.error(e());return new f(t?r=>t.schedule(i,0,r):i)}(new Error(n)))}(hf)}postMessage(t,e){return this.worker.pipe(Oo(1),nT(i=>{i.postMessage(Object.assign({action:t},e))})).toPromise().then(()=>{})}postMessageWithOperation(t,e,i){const r=this.waitForOperationCompleted(i),s=this.postMessage(t,e);return Promise.all([s,r]).then(([,o])=>o)}generateNonce(){return Math.round(1e7*Math.random())}eventsOfType(t){let e;return e="string"==typeof t?i=>i.type===t:i=>t.includes(i.type),this.events.pipe(Hl(e))}nextEventOfType(t){return this.eventsOfType(t).pipe(Oo(1))}waitForOperationCompleted(t){return this.eventsOfType("OPERATION_COMPLETED").pipe(Hl(e=>e.nonce===t),Oo(1),ve(e=>{if(void 0!==e.result)return e.result;throw new Error(e.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}}let HX=(()=>{class n{constructor(e){if(this.sw=e,this.subscriptionChanges=new le,!e.isEnabled)return this.messages=tl,this.notificationClicks=tl,void(this.subscription=tl);this.messages=this.sw.eventsOfType("PUSH").pipe(ve(r=>r.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(ve(r=>r.data)),this.pushManager=this.sw.registration.pipe(ve(r=>r.pushManager));const i=this.pushManager.pipe(ef(r=>r.getSubscription()));this.subscription=qr(i,this.subscriptionChanges)}get isEnabled(){return this.sw.isEnabled}requestSubscription(e){if(!this.sw.isEnabled)return Promise.reject(new Error(hf));const i={userVisibleOnly:!0};let r=this.decodeBase64(e.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),s=new Uint8Array(new ArrayBuffer(r.length));for(let o=0;o<r.length;o++)s[o]=r.charCodeAt(o);return i.applicationServerKey=s,this.pushManager.pipe(ef(o=>o.subscribe(i)),Oo(1)).toPromise().then(o=>(this.subscriptionChanges.next(o),o))}unsubscribe(){return this.sw.isEnabled?this.subscription.pipe(Oo(1),ef(i=>{if(null===i)throw new Error("Not subscribed to push notifications.");return i.unsubscribe().then(r=>{if(!r)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})})).toPromise():Promise.reject(new Error(hf))}decodeBase64(e){return atob(e)}}return n.\u0275fac=function(e){return new(e||n)(rn(gg))},n.\u0275prov=tn({token:n,factory:n.\u0275fac}),n})(),eS=(()=>{class n{constructor(e){if(this.sw=e,!e.isEnabled)return this.versionUpdates=tl,this.available=tl,this.activated=tl,void(this.unrecoverable=tl);this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY"]),this.available=this.versionUpdates.pipe(Hl(i=>"VERSION_READY"===i.type),ve(i=>({type:"UPDATE_AVAILABLE",current:i.currentVersion,available:i.latestVersion}))),this.activated=this.sw.eventsOfType("UPDATE_ACTIVATED"),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}get isEnabled(){return this.sw.isEnabled}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(hf));const e=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:e},e)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(hf));const e=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:e},e)}}return n.\u0275fac=function(e){return new(e||n)(rn(gg))},n.\u0275prov=tn({token:n,factory:n.\u0275fac}),n})();class b1{}const tS=new Dn("NGSW_REGISTER_SCRIPT");function UX(n,t,e,i){return()=>{if(!p$(i)||!("serviceWorker"in navigator)||!1===e.enabled)return;let s;if(navigator.serviceWorker.addEventListener("controllerchange",()=>{null!==navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({action:"INITIALIZE"})}),"function"==typeof e.registrationStrategy)s=e.registrationStrategy();else{const[c,...m]=(e.registrationStrategy||"registerWhenStable:30000").split(":");switch(c){case"registerImmediately":s=Ka(null);break;case"registerWithDelay":s=nS(+m[0]||0);break;case"registerWhenStable":s=m[0]?qr(iS(n),nS(+m[0])):iS(n);break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${e.registrationStrategy}`)}}n.get(vn).runOutsideAngular(()=>s.pipe(Oo(1)).subscribe(()=>navigator.serviceWorker.register(t,{scope:e.scope}).catch(c=>console.error("Service worker registration failed with:",c))))}}function nS(n){return Ka(null).pipe(function zX(n,t=QI){const e=function LX(n=0,t,e=FX){let i=-1;return null!=t&&(Mu(t)?e=t:i=t),new f(r=>{let s=function BX(n){return n instanceof Date&&!isNaN(n)}(n)?+n-e.now():n;s<0&&(s=0);let o=0;return e.schedule(function(){r.closed||(r.next(o++),0<=i?this.schedule(void 0,i):r.complete())},s)})}(n,t);return JI(()=>e)}(n))}function iS(n){return n.get(Z_).isStable.pipe(Hl(e=>e))}function VX(n,t){return new gg(p$(t)&&!1!==n.enabled?navigator.serviceWorker:void 0)}let GX=(()=>{class n{static register(e,i={}){return{ngModule:n,providers:[{provide:tS,useValue:e},{provide:b1,useValue:i},{provide:gg,useFactory:VX,deps:[b1,_d]},{provide:j_,useFactory:UX,deps:[Yr,tS,b1,_d],multi:!0}]}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ws({type:n}),n.\u0275inj=ls({providers:[HX,eS]}),n})();class qX{constructor(t){this.canvasElement=t}makeBrush(t,e,i){t.strokeStyle=i,t.fillStyle=t.strokeStyle,t.lineWidth=1;let r=Math.floor(e/5);return t.font=`bold ${r}px sans-serif`,t.textBaseline="top",t.textAlign="center",t}render(t,e,i=50,r=Us.SQUARE,s="#000000e6",o=!0){this.canvasElement.width=t*i,this.canvasElement.height=e*i;let c=this.canvasElement.getContext("2d");if(r<0)return;let m=this.generateCalcGridPositionFunc(r);this.makeBrush(c,i,s);for(let I=0;I<=e;I++)for(let Z=0;Z<=t;Z++){let{gx:fe,gy:pe}=m(Z,I,i);this.strokeSquare(c,fe,pe,i),o&&c.fillText((Z+1).toString()+"-"+(I+1).toString(),fe+i/2,pe+i/2)}}generateCalcGridPositionFunc(t){switch(t){case Us.HEX_VERTICAL:return(e,i,r)=>e%2==1?{gx:e*r,gy:i*r}:{gx:e*r,gy:i*r+r/2};case Us.HEX_HORIZONTAL:return(e,i,r)=>i%2==1?{gx:e*r,gy:i*r}:{gx:e*r+r/2,gy:i*r};default:return(e,i,r)=>({gx:e*r,gy:i*r})}}strokeSquare(t,e,i,r){t.beginPath(),t.strokeRect(e,i,r,r)}strokeHex(t,e,i,r,s){let o=s===Us.HEX_HORIZONTAL?-30:0,c=r/Math.sqrt(3),m=e+r/2,I=i+r/2;t.beginPath();for(let Z=0;Z<6;Z++){o+=60;let fe=Math.PI/180*o,pe=Math.cos(fe)*c+m,ye=Math.sin(fe)*c+I;t.lineTo(pe,ye)}t.closePath(),t.stroke()}}var Xl=(()=>(function(n){n.DRAG="drag",n.ZOOM="zoom",n.ROTATE="rotate",n.KEYBOARD="keyboard"}(Xl||(Xl={})),Xl))(),qs=(()=>(function(n){n.ArrowLeft="ArrowLeft",n.ArrowUp="ArrowUp",n.ArrowRight="ArrowRight",n.ArrowDown="ArrowDown"}(qs||(qs={})),qs))();class WX{constructor(t){this.targetElement=t,this.currentPositionX=0,this.currentPositionY=0,this.buttonCode=0,this.input=null,this.callbackOnWheel=e=>this.onWheel(e),this.callbackOnKeydown=e=>this.onKeydown(e),this.onstart=null,this.onend=null,this.ontransform=null,this.initialize()}get isGrabbing(){return this.input.isGrabbing}get isDragging(){return this.input.isDragging}initialize(){this.input=new Ls(this.targetElement,{capture:!0}),this.addEventListeners(),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this)}cancel(){this.input.cancel()}destroy(){this.input.destroy(),this.removeEventListeners()}onInputStart(t){this.currentPositionX=this.input.pointer.x,this.currentPositionY=this.input.pointer.y,this.buttonCode=t.button,this.onstart&&this.onstart(t)}onInputEnd(t){this.onend&&this.onend(t)}onInputMove(t){let e=this.input.pointer.x,i=this.input.pointer.y,r=e-this.currentPositionX,s=i-this.currentPositionY,o=0,c=0,I=0,fe=0,pe=Xl.DRAG;2===this.buttonCode?(pe=Xl.ROTATE,fe=-r/5,I=-s/5):(o=r,c=s),this.currentPositionX=e,this.currentPositionY=i,this.ontransform&&this.ontransform(o,c,0,I,0,fe,pe,t)}onWheel(t){let e=0;switch(t.deltaMode){case WheelEvent.DOM_DELTA_LINE:e=16*t.deltaY;break;case WheelEvent.DOM_DELTA_PAGE:e=t.deltaY*window.innerHeight;break;default:e=t.deltaY}let s=0;s=-1.5*e,9e4<s**2&&(s=Math.min(Math.max(s,-300),300)),this.ontransform&&this.ontransform(0,0,s,0,0,0,Xl.ZOOM,t)}onKeydown(t){let e=0,i=0,r=0,s=0,c=0,m=this.getKeyName(t);switch(m){case qs.ArrowLeft:t.shiftKey?c=-2:e=10;break;case qs.ArrowUp:t.shiftKey?s=-2:t.ctrlKey?r=150:i=10;break;case qs.ArrowRight:t.shiftKey?c=2:e=-10;break;case qs.ArrowDown:t.shiftKey?s=2:t.ctrlKey?r=-150:i=-10}null!=qs[m]&&this.ontransform&&this.ontransform(e,i,r,s,0,c,Xl.KEYBOARD,t)}getKeyName(t){if(t.key)return t.key;switch(t.keyCode){case 37:return qs.ArrowLeft;case 38:return qs.ArrowUp;case 39:return qs.ArrowRight;case 40:return qs.ArrowDown;default:return""}}addEventListeners(){this.targetElement.addEventListener("wheel",this.callbackOnWheel,!1),document.body.addEventListener("keydown",this.callbackOnKeydown,!1)}removeEventListeners(){this.targetElement.removeEventListener("wheel",this.callbackOnWheel,!1),document.body.removeEventListener("keydown",this.callbackOnKeydown,!1)}}var nl=(()=>(function(n){n.PAN="pan",n.TAP_PINCH="tappinch",n.PINCH="pinch",n.ROTATE="rotate"}(nl||(nl={})),nl))();class KX{constructor(t,e){this.targetElement=t,this.ngZone=e,this.hammer=null,this.deltaHammerDeltaX=0,this.deltaHammerDeltaY=1,this.deltaHammerScale=1,this.deltaHammerRotation=0,this.prevHammerDeltaX=0,this.prevHammerDeltaY=0,this.prevHammerScale=0,this.prevHammerRotation=0,this.tappedPanTimer=null,this.tappedPanCenter={x:0,y:0},this.onstart=null,this.onend=null,this.ongesture=null,this.ontransform=null,this.initializeHammer()}destroy(){this.clearTappedPanTimer(),this.hammer.destroy()}initializeHammer(){this.hammer=new Hammer.Manager(this.targetElement,{inputClass:Hammer.TouchInput});let t=new Hammer.Tap,e=new Hammer.Pan({event:"pan1p",pointers:1,threshold:0}),i=new Hammer.Pan({event:"pan2p",pointers:2,threshold:0}),r=new Hammer.Pinch,s=new Hammer.Rotate;e.recognizeWith(i),e.recognizeWith(s),e.recognizeWith(r),i.recognizeWith(r),i.recognizeWith(s),r.recognizeWith(s),this.hammer.add([t,e,i,r,s]),this.hammer.on("hammer.input",this.onHammer.bind(this)),this.hammer.on("tap",this.onTap.bind(this)),this.hammer.on("pan1pstart",this.onTappedPanStart.bind(this)),this.hammer.on("pan1pmove",this.onTappedPanMove.bind(this)),this.hammer.on("pan1pend",this.onTappedPanEnd.bind(this)),this.hammer.on("pan1pcancel",this.onTappedPanEnd.bind(this)),this.hammer.on("pan2pmove",this.onPanMove.bind(this)),this.hammer.on("pinchmove",this.onPinchMove.bind(this)),this.hammer.on("rotatemove",this.onRotateMove.bind(this));let o=window.navigator.userAgent.toLowerCase();(o.indexOf("iphone")>-1||o.indexOf("ipad")>-1||o.indexOf("macintosh")>-1&&"ontouchend"in document)&&(this.hammer.add(new Hammer.Press({time:251})),this.hammer.on("press",m=>{let I=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,clientX:m.center.x,clientY:m.center.y});this.ngZone.run(()=>m.srcEvent.target.dispatchEvent(I))}))}onHammer(t){t.isFirst?(this.deltaHammerScale=t.scale,this.deltaHammerRotation=t.rotation,this.deltaHammerDeltaX=t.deltaX,this.deltaHammerDeltaY=t.deltaY,this.onstart&&this.onstart(t.srcEvent)):t.isFinal?this.onend&&this.onend(t.srcEvent):(this.deltaHammerScale=t.scale-this.prevHammerScale,this.deltaHammerRotation=t.rotation-this.prevHammerRotation,this.deltaHammerDeltaX=t.deltaX-this.prevHammerDeltaX,this.deltaHammerDeltaY=t.deltaY-this.prevHammerDeltaY),this.prevHammerScale=t.scale,this.prevHammerRotation=t.rotation,this.prevHammerDeltaX=t.deltaX,this.prevHammerDeltaY=t.deltaY,null!=this.tappedPanTimer&&t.eventType==Hammer.INPUT_START&&2500<(this.tappedPanCenter.x-t.center.x)**2+(this.tappedPanCenter.y-t.center.y)**2&&this.clearTappedPanTimer()}onTap(t){this.tappedPanCenter=t.center,this.tappedPanTimer=setTimeout(()=>{this.tappedPanTimer=null},400),this.ongesture&&this.ongesture(t.srcEvent)}onTappedPanStart(t){null!=this.tappedPanTimer&&(this.clearTappedPanTimer(!1),this.ongesture&&this.ongesture(t.srcEvent))}onTappedPanEnd(t){this.clearTappedPanTimer()}onTappedPanMove(t){if(null==this.tappedPanTimer){let e=this.deltaHammerDeltaX,i=this.deltaHammerDeltaY,r=0;this.ontransform&&this.ontransform(e,i,r,0,0,0,nl.PAN,t.srcEvent)}else{this.clearTappedPanTimer(!1);let i=7.5*this.deltaHammerDeltaY;this.ongesture&&this.ongesture(t.srcEvent),this.ontransform&&this.ontransform(0,0,i,0,0,0,nl.TAP_PINCH,t.srcEvent)}}onPanMove(t){this.clearTappedPanTimer();let e=-this.deltaHammerDeltaY/window.innerHeight*100;this.ongesture&&this.ongesture(t.srcEvent),this.ontransform&&this.ontransform(0,0,0,e,0,0,nl.ROTATE,t.srcEvent)}onPinchMove(t){this.clearTappedPanTimer();let e=500*this.deltaHammerScale;this.ongesture&&this.ongesture(t.srcEvent),this.ontransform&&this.ontransform(0,0,e,0,0,0,nl.PINCH,t.srcEvent)}onRotateMove(t){this.clearTappedPanTimer();let e=this.deltaHammerRotation;this.ongesture&&this.ongesture(t.srcEvent),this.ontransform&&this.ontransform(0,0,0,0,0,e,nl.ROTATE,t.srcEvent)}clearTappedPanTimer(t=!0){clearTimeout(this.tappedPanTimer),t&&(this.tappedPanTimer=null)}}let mg=(()=>{class n{constructor(){}createGameCharacter(e){let i=Vt.create("\u65b0\u3057\u3044\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",1,"");return i.location.x=e.x-25,i.location.y=e.y-25,i.posZ=e.z,i}createGameTableMask(e){let i=this.getViewTable();if(!i)return;let r=is.create("\u30de\u30c3\u30d7\u30de\u30b9\u30af",5,5,100);return r.location.x=e.x-25,r.location.y=e.y-25,r.posZ=e.z,i.appendChild(r),r}createTerrain(e){let i="./assets/images/tex.jpg",r=kt.instance.get(i);r||(r=kt.instance.add(i),yn.create(r.identifier).tag="*default \u5730\u5f62");let s=this.getViewTable();if(!s)return;let o=ar.create("\u5730\u5f62",2,2,2,r.identifier,r.identifier);return o.location.x=e.x-50,o.location.y=e.y-50,o.posZ=e.z,s.appendChild(o),o}createTextNote(e){let i=Tr.create("\u5171\u6709\u30e1\u30e2","\u30c6\u30ad\u30b9\u30c8\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044",5,4,3);return i.location.x=e.x,i.location.y=e.y,i.posZ=e.z,i}createDiceSymbol(e,i,r,s){let o=or.create(i,r,1),c=null;return o.nothingFaces.forEach(m=>{let I=`./assets/images/dice/${s}/${s}[0].png`;c=kt.instance.get(I),c||(c=kt.instance.add(I),yn.create(c.identifier).tag="*default "+(r===Mi.D2?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")),o.imageDataElement.getFirstElementByName(m).value=c.identifier}),o.faces.forEach(m=>{let I=`./assets/images/dice/${s}/${s}[${m}].png`;c=kt.instance.get(I),c||(c=kt.instance.add(I),yn.create(c.identifier).tag="*default "+(r===Mi.D2?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")),o.imageDataElement.getFirstElementByName(m).value=c.identifier}),o.location.x=e.x-25,o.location.y=e.y-25,o.posZ=e.z,o}createBlankCard(e){const i="./assets/images/trump/blank_card.png",r="./assets/images/trump/z01.gif";let s,o;s=kt.instance.get(i),s||(s=kt.instance.add(i),yn.create(s.identifier).tag="*default \u30ab\u30fc\u30c9"),o=kt.instance.get(r),o||(o=kt.instance.add(r),yn.create(o.identifier).tag="*default \u30ab\u30fc\u30c9");let c=On.create("\u30ab\u30fc\u30c9",s.identifier,o.identifier);return c.location.x=e.x-25,c.location.y=e.y-25,c.posZ=e.z,c}cardName(e){let i="";const r=e.slice(0,1),s=parseInt(e.substring(1,3));switch(r){case"c":i="\u30af\u30e9\u30d6";break;case"d":i="\u30c0\u30a4\u30e4";break;case"h":i="\u30cf\u30fc\u30c8";break;case"s":i="\u30b9\u30da\u30fc\u30c9";break;case"x":i="\u30b8\u30e7\u30fc\u30ab\u30fc"}return i+="x"==r?`\uff08${1==s?"\u8d64":"\u9ed2"}\uff09`:`\u306e${1==s?"\u30a8\u30fc\u30b9":s>=11?["\u30b8\u30e3\u30c3\u30af","\u30af\u30a4\u30fc\u30f3","\u30ad\u30f3\u30b0"][s-11]:s}`,i}createTrump(e){let i=Gn.create("\u30c8\u30e9\u30f3\u30d7\u5c71\u672d");i.location.x=e.x-25,i.location.y=e.y-25,i.posZ=e.z;let r="./assets/images/trump/z02.gif";if(!kt.instance.get(r)){const c=kt.instance.add(r);yn.create(c.identifier).tag="*default \u30ab\u30fc\u30c9"}let s=["c","d","h","s"],o=[];for(let c of s)for(let m=1;m<=13;m++)o.push(c+("00"+m).slice(-2));o.push("x01"),o.push("x02");for(let c of o){let m="./assets/images/trump/"+c+".gif";if(!kt.instance.get(m)){const Z=kt.instance.add(m);yn.create(Z.identifier).tag="*default \u30ab\u30fc\u30c9"}let I=On.create(this.cardName(c),m,r);i.putOnBottom(I)}return i}createRangeArea(e,i){let r;switch(i){case"LINE":r=ni.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u76f4\u7dda)",1,6,100);break;case"CIRCLE":r=ni.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u5186)",3,3,100);break;case"SQUARE":r=ni.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u6b63\u65b9\u5f62)",3,3,100);break;case"DIAMOND":r=ni.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u30c0\u30a4\u30e4)",3,3,100);break;default:r=ni.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u9310\u5f62)",6,6,100)}return r.location.x=e.x,r.location.y=e.y,r.posZ=e.z,r.type=i,r.commonDataElement.getFirstElementByName("opacity").currentValue=60,r}makeDefaultTable(){let e=new Li("gameTable"),i=null,r=Ht.createEmpty("testTableBackgroundImage_image").toContext();r.url="./assets/images/BG10a_80.jpg",i=kt.instance.add(r),yn.create(i.identifier).tag="*default \u30c6\u30fc\u30d6\u30eb",e.name="\u6700\u521d\u306e\u30c6\u30fc\u30d6\u30eb",e.imageIdentifier=i.identifier,e.width=20,e.height=15,e.initialize(),lr.instance.viewTableIdentifier=e.identifier}makeDefaultTabletopObjects(){let e=null,i=null,r=null;e=new Vt("testCharacter_1"),r=Ht.createEmpty("testCharacter_1_image").toContext(),r.url="./assets/images/mon_052.gif",i=kt.instance.add(r),yn.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=250,e.location.y=450,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcA",1,i.identifier),e=new Vt("testCharacter_2"),e.location.x=400,e.location.y=400,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcB",1,i.identifier),e=new Vt("testCharacter_3"),r=Ht.createEmpty("testCharacter_3_image").toContext(),r.url="./assets/images/mon_128.gif",i=kt.instance.add(r),yn.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=200,e.location.y=100,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcC",3,i.identifier),e=new Vt("testCharacter_4"),r=Ht.createEmpty("testCharacter_4_image").toContext(),r.url="./assets/images/mon_150.gif",i=kt.instance.add(r),yn.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=300,e.location.y=550,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcA",1,i.identifier),e=new Vt("testCharacter_5"),r=Ht.createEmpty("testCharacter_5_image").toContext(),r.url="./assets/images/mon_211.gif",i=kt.instance.add(r),yn.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=600,e.location.y=600,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcB",1,i.identifier),e=new Vt("testCharacter_6"),r=Ht.createEmpty("testCharacter_6_image").toContext(),r.url="./assets/images/mon_135.gif",i=kt.instance.add(r),yn.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.initialize(),e.location.x=250,e.location.y=650,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcC",1,i.identifier)}makeDefaultContextMenuActions(e){return[this.getCreateCharacterMenu(e),this.getCreateTableMaskMenu(e),this.getCreateTerrainMenu(e),this.getCreateTextNoteMenu(e),this.getCreateBlankCardMenu(e),this.getCreateTrumpMenu(e),this.getCreateDiceSymbolMenu(e),this.getCreateRangeMenu(e)]}getCreateCharacterMenu(e){return{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u4f5c\u6210",action:()=>{let i=this.createGameCharacter(e);Fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:i.identifier,className:i.aliasName}),dt.play(Ze.piecePut)}}}getCreateTableMaskMenu(e){return{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u4f5c\u6210",action:()=>{this.createGameTableMask(e),dt.play(Ze.cardPut)}}}getCreateTerrainMenu(e){return{name:"\u5730\u5f62\u3092\u4f5c\u6210",action:()=>{this.createTerrain(e),dt.play(Ze.blockPut)}}}getCreateTextNoteMenu(e){return{name:"\u5171\u6709\u30e1\u30e2\u3092\u4f5c\u6210",action:()=>{this.createTextNote(e),dt.play(Ze.cardPut)}}}getCreateBlankCardMenu(e){return{name:"\u30d6\u30e9\u30f3\u30af\u30ab\u30fc\u30c9\u3092\u4f5c\u6210",action:()=>{this.createBlankCard(e),dt.play(Ze.cardPut)}}}getCreateTrumpMenu(e){return{name:"\u30c8\u30e9\u30f3\u30d7\u306e\u5c71\u672d\u3092\u4f5c\u6210",action:()=>{this.createTrump(e),dt.play(Ze.cardPut)}}}getCreateDiceSymbolMenu(e){let r=[];return[{menuName:"\u30b3\u30a4\u30f3 (\u8868/\u88cf)",diceName:"\u30b3\u30a4\u30f3",type:Mi.D2,imagePathPrefix:"2_coin"},{menuName:"D4",diceName:"D4",type:Mi.D4,imagePathPrefix:"4_dice"},{menuName:"D6",diceName:"D6",type:Mi.D6,imagePathPrefix:"6_dice"},{menuName:"D6 (Black)",diceName:"D6",type:Mi.D6,imagePathPrefix:"6_dice_black"},{menuName:"D8",diceName:"D8",type:Mi.D8,imagePathPrefix:"8_dice"},{menuName:"D10",diceName:"D10",type:Mi.D10,imagePathPrefix:"10_dice"},{menuName:"D10 (00-90)",diceName:"D10",type:Mi.D10_10TIMES,imagePathPrefix:"100_dice"},{menuName:"D12",diceName:"D12",type:Mi.D12,imagePathPrefix:"12_dice"},{menuName:"D20",diceName:"D20",type:Mi.D20,imagePathPrefix:"20_dice"}].forEach(s=>{r.push({name:s.menuName,action:()=>{this.createDiceSymbol(e,s.diceName,s.type,s.imagePathPrefix),dt.play(Ze.dicePut)}})}),{name:"\u30c0\u30a4\u30b9\u3092\u4f5c\u6210",action:null,subActions:r}}getCreateRangeMenu(e){let r=[];return[{menuName:"\u9310\u5f62",typeName:"CORN"},{menuName:"\u76f4\u7dda",typeName:"LINE"},{menuName:"\u5186",typeName:"CIRCLE"},{menuName:"\u6b63\u65b9\u5f62",typeName:"SQUARE"},{menuName:"\u30c0\u30a4\u30e4\u30e2\u30f3\u30c9",typeName:"DIAMOND"}].forEach(s=>{r.push({name:s.menuName,action:()=>{this.createRangeArea(e,s.typeName),dt.play(Ze.dicePut)}})}),{name:"\u5c04\u7a0b\u30fb\u7bc4\u56f2\u3092\u4f5c\u6210",action:null,subActions:r}}getViewTable(){return lr.instance.viewTable}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=tn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),il=(()=>{class n{constructor(e,i,r,s,o,c){this.ngZone=e,this.elementRef=i,this.batchService=r,this.pointerDeviceService=s,this.coordinateService=o,this.tabletopService=c,this.layerName="",this.colideLayers=[],this.transformCssOffset="",this.isDisable=!1,this.isInteract=!0,this.onstart=new Cn,this.ondragstart=new Cn,this.ondrag=new Cn,this.ondragend=new Cn,this.onend=new Cn,this._posX=0,this._posY=0,this._posZ=0,this.pointerOffset2d={x:0,y:0,z:0},this.pointerStart3d={x:0,y:0,z:0},this.height=0,this.width=0,this.ratio=1,this.updateTimer=null,this.collidableElements=[],this.input=null}set option(e){this.tabletopObject=null!=e.tabletopObject?e.tabletopObject:this.tabletopObject,this.layerName=null!=e.layerName?e.layerName:this.layerName,this.colideLayers=null!=e.colideLayers?e.colideLayers:this.colideLayers,this.transformCssOffset=null!=e.transformCssOffset?e.transformCssOffset:this.transformCssOffset}get nativeElement(){return this.elementRef.nativeElement}get posX(){return this._posX}set posX(e){this._posX=e,this.setUpdateTimer()}get posY(){return this._posY}set posY(e){this._posY=e,this.setUpdateTimer()}get posZ(){return this._posZ}set posZ(e){this._posZ=e,this.setUpdateTimer()}get isGridSnap(){return lr.instance.gridSnap}ngAfterViewInit(){this.batchService.add(()=>this.initialize(),this.elementRef),this.setPosition(this.tabletopObject)}ngOnDestroy(){this.cancel(),this.input.destroy(),this.unregister(),Fe.unregister(this),this.batchService.remove(this),this.batchService.remove(this.elementRef)}initialize(){this.input=new Ls(this.nativeElement),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),Fe.register(this).on("UPDATE_GAME_OBJECT",e=>{e.isSendFromSelf&&this.input.isGrabbing||e.data.identifier!==this.tabletopObject.identifier||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.stopTransition(),this.setPosition(this.tabletopObject)},this)}),this.layerName.length<1&&this.tabletopObject&&(this.layerName=this.tabletopObject.aliasName),this.register(),this.findCollidableElements(),this.setPosition(this.tabletopObject)}cancel(){this.input.cancel(),this.setPointerEvents(!0),this.setAnimatedTransition(!0),this.setCollidableLayer(!1),this.tabletopService.tableSelecter.viewTable&&(this.tabletopService.tableSelecter.viewTable.gridHeight=0)}onInputStart(e){if(this.callSelectedEvent(),this.collidableElements.length<1&&this.findCollidableElements(),this.isDisable||1===e.button||2===e.button)return this.cancel();this.onstart.emit(e),this.setPointerEvents(!1),this.setAnimatedTransition(!1),this.setCollidableLayer(this.isInteract),this.width=this.nativeElement.clientWidth,this.height=this.nativeElement.clientHeight;let i={x:this.posX+this.width/2,y:this.posY+this.height/2,z:this.posZ},r=this.coordinateService.convertToGlobal(i,this.coordinateService.tabletopOriginElement);this.setPointerEvents(!0),this.pointerOffset2d.x=r.x-this.input.pointer.x,this.pointerOffset2d.y=r.y-this.input.pointer.y,this.pointerOffset2d.z=r.z-this.input.pointer.z,this.pointerStart3d.x=i.x,this.pointerStart3d.y=i.y,this.pointerStart3d.z=i.z,this.targetStartRect=this.nativeElement.getBoundingClientRect(),this.ratio=1,this.tabletopService.tableSelecter.viewTable.gridHeight=this.posZ+.5,this.setUpdateTimer()}onInputMove(e){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();e.cancelable&&e.preventDefault(),this.input.isDragging||this.setPointerEvents(!1);let i={x:this.input.pointer.x+this.pointerOffset2d.x*this.ratio,y:this.input.pointer.y+this.pointerOffset2d.y*this.ratio,z:0};i.x=Math.min(window.innerWidth-.1,Math.max(i.x,.1)),i.y=Math.min(window.innerHeight-.1,Math.max(i.y,.1));let r=document.elementFromPoint(i.x,i.y);if(null==r)return;let s=this.coordinateService.calcTabletopLocalCoordinate(i,r);if(s.x-=this.width/2,s.y-=this.height/2,this.posX===s.x&&this.posY===s.y&&this.posZ===s.z)return;this.input.isDragging||this.ondragstart.emit(e),this.ondrag.emit(e);let c=this.nativeElement.getBoundingClientRect().width/this.targetStartRect.width;c<this.ratio&&(this.ratio+=.1*(c-this.ratio)),this.posX=s.x,this.posY=s.y,this.posZ=s.z,lr.instance.viewTable.gridHeight=this.posZ+.5}onInputEnd(e){if(this.isDisable)return this.cancel();this.input.isDragging&&this.ondragend.emit(e),this.isGridSnap&&this.input.isDragging&&this.snapToGrid(),this.cancel(),this.onend.emit(e)}onContextMenu(e){if(this.isDisable)return this.cancel();e.cancelable&&e.preventDefault(),this.isGridSnap&&this.input.isDragging&&this.snapToGrid();let i=this.input.isGrabbing&&e.isTrusted;if(this.cancel(),i){e.stopPropagation();let r=new MouseEvent(e.type,e);this.ngZone.run(()=>this.nativeElement.dispatchEvent(r))}}callSelectedEvent(){this.tabletopObject&&Fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:this.tabletopObject.identifier,className:this.tabletopObject.aliasName})}snapToGrid(e=25){this.posX=this.calcSnapNum(this.posX,e),this.posY=this.calcSnapNum(this.posY,e)}calcSnapNum(e,i){return i<=0?e:(e=e<0?e-i/2:e+i/2)-e%i}setPosition(e){this._posX=e.location.x,this._posY=e.location.y,this._posZ=e.posZ,this.updateTransformCss()}setUpdateTimer(){null===this.updateTimer&&this.tabletopObject&&(this.updateTimer=setTimeout(()=>{this.tabletopObject.location.x=this.posX,this.tabletopObject.location.y=this.posY,this.tabletopObject.posZ=this.posZ,this.updateTimer=null},66)),this.updateTransformCss()}findCollidableElements(){this.collidableElements=[],"none"===getComputedStyle(this.nativeElement).pointerEvents?this.findNestedCollidableElements(this.nativeElement):this.collidableElements=[this.nativeElement]}findNestedCollidableElements(e){let i=e.children;for(let r=0;r<i.length;r++){let s=i[r];s instanceof HTMLElement&&"none"!==getComputedStyle(s).pointerEvents&&this.collidableElements.push(s)}if(this.collidableElements.length<1)for(let r=0;r<i.length;r++){let s=i[r];s instanceof HTMLElement&&this.findNestedCollidableElements(s)}}setPointerEvents(e){let i=e?"auto":"none";this.collidableElements.forEach(r=>r.style.pointerEvents=i)}setAnimatedTransition(e){this.nativeElement.style.transition=e?"transform 132ms linear":""}shouldTransition(e){return e.location.x!==this.posX||e.location.y!==this.posY||e.posZ!==this.posZ}stopTransition(){this.nativeElement.style.transform=window.getComputedStyle(this.nativeElement).transform}updateTransformCss(){let e=`${this.transformCssOffset} translate3d(${this.posX.toFixed(4)}px, ${this.posY.toFixed(4)}px, ${this.posZ.toFixed(4)}px)`;this.nativeElement.style.transform=e}setCollidableLayer(e){let i=e;for(let r in n.layerHash)i=-1<this.colideLayers.indexOf(r)?"character"==r?!this.input.isGrabbing||e&&!this.tabletopObject.isNotRide:!this.input.isGrabbing||e:!e,n.layerHash[r].forEach(s=>{s===this||s.input.isGrabbing||s.setPointerEvents(i)})}register(){this.layerName in n.layerHash||(n.layerHash[this.layerName]=[]),n.layerHash[this.layerName].indexOf(this)<0&&n.layerHash[this.layerName].push(this)}unregister(){if(!(this.layerName in n.layerHash))return;let e=n.layerHash[this.layerName].indexOf(this);-1<e&&n.layerHash[this.layerName].splice(e,1)}}return n.layerHash={},n.\u0275fac=function(e){return new(e||n)(Le(vn),Le(_i),Le(ug),Le(ai),Le(Ja),Le(vu))},n.\u0275dir=Xt({type:n,selectors:[["","appMovable",""]],inputs:{option:["movable.option","option"],isDisable:["movable.disable","isDisable"],isInteract:["movable.interact","isInteract"]},outputs:{onstart:"movable.onstart",ondragstart:"movable.ondragstart",ondrag:"movable.ondrag",ondragend:"movable.ondragend",onend:"movable.onend"}}),n})(),Ql=(()=>{class n{constructor(e,i,r,s,o){this.elementRef=e,this.batchService=i,this.pointerDeviceService=r,this.coordinateService=s,this.tabletopService=o,this.transformCssOffset="",this.grabbingSelecter=".rotate-grab",this.isDisable=!1,this.polygonal=24,this.onstart=new Cn,this.ondragstart=new Cn,this.ondrag=new Cn,this.ondragend=new Cn,this.onend=new Cn,this._rotate=0,this.valueChange=new Cn,this.rotateOffset=0,this.updateTimer=null,this.grabbingElement=null,this.input=null}set option(e){this.tabletopObject=null!=e.tabletopObject?e.tabletopObject:this.tabletopObject,this.grabbingSelecter=null!=e.grabbingSelecter?e.grabbingSelecter:this.grabbingSelecter,this.transformCssOffset=null!=e.transformCssOffset?e.transformCssOffset:this.transformCssOffset}get nativeElement(){return this.elementRef.nativeElement}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.setUpdateTimer()}set value(e){this._rotate=e,this.updateTransformCss()}get isAllowedToRotate(){if(!this.grabbingElement||!this.nativeElement)return!1;if(this.grabbingSelecter.length<1)return!0;let e=this.nativeElement.querySelectorAll(this.grabbingSelecter),i=!1;for(let r=0;r<e.length;r++)if(i=e[r].contains(this.grabbingElement),i)return!0;return!1}ngAfterViewInit(){this.batchService.add(()=>this.initialize(),this.elementRef),this.tabletopObject?this.setRotate(this.tabletopObject):this.updateTransformCss()}ngOnDestroy(){this.cancel(),this.input.destroy(),Fe.unregister(this),this.batchService.remove(this),this.batchService.remove(this.elementRef)}initialize(){this.input=new Ls(this.nativeElement),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),this.tabletopObject?(Fe.register(this).on("UPDATE_GAME_OBJECT",e=>{e.isSendFromSelf&&this.input.isGrabbing||e.data.identifier!==this.tabletopObject.identifier||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.stopTransition(),this.setRotate(this.tabletopObject)},this)}),this.setRotate(this.tabletopObject)):this.updateTransformCss()}cancel(){this.input.cancel(),this.grabbingElement=null,this.setAnimatedTransition(!0),this.tabletopService.tableSelecter.viewTable&&(this.tabletopService.tableSelecter.viewTable.gridHeight=0)}onInputStart(e){if(this.grabbingElement=e.target,this.isDisable||!this.isAllowedToRotate||1===e.button||2===e.button)return this.cancel();e.stopPropagation(),this.onstart.emit(e);let i=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.nativeElement.parentElement);this.rotateOffset=this.calcRotate(i,this.rotate),this.setAnimatedTransition(!1),this.tabletopObject&&(this.tabletopService.tableSelecter.viewTable.gridHeight=this.tabletopObject.posZ+.5,this.setUpdateTimer())}onInputMove(e){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();e.cancelable&&e.preventDefault(),e.stopPropagation();let i=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.nativeElement.parentElement),r=this.calcRotate(i,this.rotateOffset);this.input.isDragging||this.ondragstart.emit(e),this.ondrag.emit(e),this.rotate=r}onInputEnd(e){if(this.isDisable)return this.cancel();e.stopPropagation(),this.input.isDragging&&this.ondragend.emit(e),this.cancel(),this.snapToPolygonal(this.polygonal),this.onend.emit(e)}onContextMenu(e){if(this.isDisable)return this.cancel();e.cancelable&&e.preventDefault(),this.cancel(),this.snapToPolygonal(this.polygonal)}calcRotate(e,i){return(180*Math.atan2(e.y-this.nativeElement.clientHeight/2,e.x-this.nativeElement.clientWidth/2)/Math.PI-i)%360}snapToPolygonal(e=24){e<=1||(this.rotate=this.rotate<0?this.rotate-180/e:this.rotate+180/e,this.rotate-=this.rotate%(360/e))}setUpdateTimer(){null===this.updateTimer&&(this.updateTimer=setTimeout(()=>{this.valueChange.emit(this.rotate),this.tabletopObject&&(this.tabletopObject.rotate=this.rotate),this.updateTimer=null},66)),this.updateTransformCss()}setRotate(e){e&&(this._rotate=e.rotate),this.updateTransformCss()}setAnimatedTransition(e){this.nativeElement.style.transition=e?"transform 132ms linear":""}shouldTransition(e){return e.rotate!==this.rotate}stopTransition(){this.nativeElement.style.transform=window.getComputedStyle(this.nativeElement).transform}updateTransformCss(){let e=`${this.transformCssOffset} rotateZ(${this.rotate.toFixed(4)}deg)`;this.nativeElement.style.transform=e}}return n.\u0275fac=function(e){return new(e||n)(Le(_i),Le(ug),Le(ai),Le(Ja),Le(vu))},n.\u0275dir=Xt({type:n,selectors:[["","appRotable",""]],inputs:{option:["rotable.option","option"],isDisable:["rotable.disable","isDisable"],polygonal:["rotable.polygonal","polygonal"],value:["rotable.value","value"]},outputs:{onstart:"rotable.onstart",ondragstart:"rotable.ondragstart",ondrag:"rotable.ondrag",ondragend:"rotable.ondragend",onend:"rotable.onend",valueChange:"rotable.valueChange"}}),n})();const rS=function(n){return{"blinking-animation":n}};function YX(n,t){if(1&n&&(K(0,"div",6),Ct(1,"safe"),J()),2&n){const e=ge(2);Ke("background-image",xt(1,3,"url("+e.floorImage.url+")","style")),te("ngClass",ut(6,rS,!e.isLocked))}}function ZX(n,t){if(1&n&&(Ve(0),xe(1,YX,2,8,"div",5),Ge()),2&n){const e=ge();U(1),te("ngIf",e.isDropShadow&&(0!=e.terreinAltitude||e.isSlope&&!e.hasWall))}}const XX=function(n,t,e){return{"backface-visibility":n,transform:t,filter:e}};function QX(n,t){if(1&n&&(Ve(0),K(1,"div",7),Ct(2,"safe"),J(),Ge()),2&n){const e=ge();U(1),Ke("background-image",xt(2,4,"url("+e.floorImage.url+")","style")),te("ngClass",ut(7,rS,!e.isLocked))("ngStyle",Zr(9,XX,e.isSlope?"visible":"hidden","translateZ("+e.height/(e.isSlope?2:1)*e.gridSize+"px)"+e.floorModCss,"brightness("+e.floorBrightness+")"))}}const _g=function(n,t,e,i){return{"blinking-animation":n,"no-shadow":t,"is-slope":e,"is-inverse-slope":i}};function JX(n,t){if(1&n&&(K(0,"div",9),Ct(1,"safe"),J()),2&n){const e=ge(3);Ke("background-image",xt(1,7,"url("+e.wallImage.url+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),te("ngClass",oo(10,_g,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.LEFT,e.slopeDirection==e.slopeDirectionState.RIGHT))}}function eQ(n,t){if(1&n&&(Ve(0),xe(1,JX,2,15,"div",8),Ge()),2&n){const e=ge(2);U(1),te("ngIf",e.isVisibleWallTopBottom)}}function tQ(n,t){if(1&n&&(K(0,"div",11),Ct(1,"safe"),J()),2&n){const e=ge(3);Ke("background-image",xt(1,7,"url("+e.wallImage.url+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),te("ngClass",oo(10,_g,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.LEFT,e.slopeDirection==e.slopeDirectionState.RIGHT))}}function nQ(n,t){if(1&n&&(Ve(0),xe(1,tQ,2,15,"div",10),Ge()),2&n){const e=ge(2);U(1),te("ngIf",e.isVisibleWallTopBottom)}}function iQ(n,t){if(1&n&&(K(0,"div",13),Ct(1,"safe"),J()),2&n){const e=ge(3);Ke("background-image",xt(1,7,"url("+e.wallImage.url+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),te("ngClass",oo(10,_g,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.BOTTOM,e.slopeDirection==e.slopeDirectionState.TOP))}}function rQ(n,t){if(1&n&&(Ve(0),xe(1,iQ,2,15,"div",12),Ge()),2&n){const e=ge(2);U(1),te("ngIf",e.isVisibleWallLeftRight)}}function sQ(n,t){if(1&n&&(K(0,"div",15),Ct(1,"safe"),J()),2&n){const e=ge(3);Ke("background-image",xt(1,7,"url("+e.wallImage.url+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),te("ngClass",oo(10,_g,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.BOTTOM,e.slopeDirection==e.slopeDirectionState.TOP))}}function oQ(n,t){if(1&n&&(Ve(0),xe(1,sQ,2,15,"div",14),Ge()),2&n){const e=ge(2);U(1),te("ngIf",e.isVisibleWallLeftRight)}}function aQ(n,t){if(1&n&&(Ve(0),xe(1,eQ,2,1,"ng-container",2),xe(2,nQ,2,1,"ng-container",2),xe(3,rQ,2,1,"ng-container",2),xe(4,oQ,2,1,"ng-container",2),Ge()),2&n){const e=ge();U(1),te("ngIf",e.slopeDirection!=e.slopeDirectionState.TOP),U(1),te("ngIf",e.slopeDirection!=e.slopeDirectionState.BOTTOM),U(1),te("ngIf",e.slopeDirection!=e.slopeDirectionState.LEFT),U(1),te("ngIf",e.slopeDirection!=e.slopeDirectionState.RIGHT)}}function lQ(n,t){if(1&n&&(Ve(0),K(1,"div",16),it(2,"div",17),K(3,"div",18)(4,"i",19),be(5,"autorenew"),J()(),K(6,"div",20)(7,"i",19),be(8,"autorenew"),J()(),K(9,"div",21)(10,"i",19),be(11,"autorenew"),J()(),K(12,"div",22)(13,"i",19),be(14,"autorenew"),J()()(),Ge()),2&n){const e=ge();U(1),Ke("opacity",e.isInteract?"1.0":"0.5")("height",e.depth*e.gridSize,"px")}}const sS=function(n){return{transform:n}};function cQ(n,t){if(1&n&&(K(0,"div",23)(1,"div",24),be(2),J(),K(3,"div",25),be(4),J()()),2&n){const e=ge();Ke("height",e.math.abs(e.terreinAltitude*e.gridSize),"px"),te("ngStyle",ut(5,sS,"translateX("+e.width*e.gridSize/2+"px) translateY("+-e.depth*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.terreinAltitude>0?-(e.altitude+(e.isSlope||e.isWallExist?0:e.height))*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),U(2),qe(e.math.abs(e.terreinAltitude)),U(2),qe(e.math.abs(e.terreinAltitude))}}const uQ=function(n){return{"is-grab":n}},dQ=function(n,t){return{"upright-transform":n,fall:t}};let fQ=(()=>{class n{constructor(e,i,r,s,o,c,m,I,Z,fe){this.ngZone=e,this.imageService=i,this.tabletopActionService=r,this.contextMenuService=s,this.elementRef=o,this.panelService=c,this.changeDetector=m,this.pointerDeviceService=I,this.modalService=Z,this.coordinateService=fe,this.terrain=null,this.is3D=!1,this.gridSize=50,this.movableOption={},this.rotableOption={},this.math=Math,this.slopeDirectionState=ii,this.input=null,this.viewRotateZ=10}get name(){return this.terrain.name}get mode(){return this.terrain.mode}set mode(e){this.terrain.mode=e}get isLocked(){return this.terrain.isLocked}set isLocked(e){this.terrain.isLocked=e}get hasWall(){return this.terrain.hasWall}get hasFloor(){return this.terrain.hasFloor}get wallImage(){return this.imageService.getSkeletonOr(this.terrain.wallImage)}get floorImage(){return this.imageService.getSkeletonOr(this.terrain.floorImage)}get height(){return this.adjustMinBounds(this.terrain.height)}get width(){return this.adjustMinBounds(this.terrain.width)}get depth(){return this.adjustMinBounds(this.terrain.depth)}get altitude(){return this.terrain.altitude}set altitude(e){this.terrain.altitude=e}get isDropShadow(){return this.terrain.isDropShadow}set isDropShadow(e){this.terrain.isDropShadow=e}get isSurfaceShading(){return this.terrain.isSurfaceShading}set isSurfaceShading(e){this.terrain.isSurfaceShading=e}get isInteract(){return this.terrain.isInteract}set isInteract(e){this.terrain.isInteract=e}get isSlope(){return this.terrain.isSlope}set isSlope(e){this.terrain.isSlope=e,e||(this.terrain.slopeDirection=ii.NONE)}get slopeDirection(){return this.terrain.isSlope?this.terrain.isSlope&&this.terrain.slopeDirection===ii.NONE?ii.BOTTOM:this.terrain.slopeDirection:ii.NONE}set slopeDirection(e){this.terrain.isSlope=e!=ii.NONE,this.terrain.slopeDirection=e}get isAltitudeIndicate(){return this.terrain.isAltitudeIndicate}set isAltitudeIndicate(e){this.terrain.isAltitudeIndicate=e}get isVisibleFloor(){return 0<this.width*this.depth}get isVisibleWallTopBottom(){return 0<this.width*this.height}get isVisibleWallLeftRight(){return 0<this.depth*this.height}get isWallExist(){return this.hasWall&&this.wallImage&&this.wallImage.url&&this.wallImage.url.length>0}get terreinAltitude(){let e=this.altitude;return(this.altitude<0||!this.isSlope&&!this.isWallExist)&&(e+=this.height),e}ngOnInit(){Fe.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=lt.instance.get(e.data.identifier);!this.terrain||!i||(this.terrain===i||i instanceof zn&&this.terrain.contains(i))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.terrain,colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.terrain}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new Ls(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this.input.destroy(),Fe.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLocked&&Fe.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate();this.contextMenuService.open(i,[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,dt.play(Ze.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,dt.play(Ze.lock)}},Tt,{name:"\u50be\u659c",action:null,subActions:[{name:(this.slopeDirection==ii.NONE?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{this.slopeDirection=ii.NONE}},Tt,{name:(this.slopeDirection==ii.TOP?"\u25c9":"\u25cb")+" \u4e0a\uff08\u5317\uff09",action:()=>{this.slopeDirection=ii.TOP}},{name:(this.slopeDirection==ii.BOTTOM?"\u25c9":"\u25cb")+" \u4e0b\uff08\u5357\uff09",action:()=>{this.slopeDirection=ii.BOTTOM}},{name:(this.slopeDirection==ii.LEFT?"\u25c9":"\u25cb")+" \u5de6\uff08\u897f\uff09",action:()=>{this.slopeDirection=ii.LEFT}},{name:(this.slopeDirection==ii.RIGHT?"\u25c9":"\u25cb")+" \u53f3\uff08\u6771\uff09",action:()=>{this.slopeDirection=ii.RIGHT}}]},{name:"\u58c1\u306e\u8868\u793a",action:null,subActions:[{name:(this.hasWall&&this.isSurfaceShading?"\u25c9":"\u25cb")+" \u901a\u5e38",action:()=>{this.mode=da.ALL,this.isSurfaceShading=!0}},{name:(this.hasWall&&!this.isSurfaceShading?"\u25c9":"\u25cb")+" \u9670\u5f71\u306a\u3057",action:()=>{this.mode=da.ALL,this.isSurfaceShading=!1}},{name:(this.hasWall?"\u25cb":"\u25c9")+" \u975e\u8868\u793a",action:()=>{this.mode=da.FLOOR,this.depth*this.width==0&&(this.terrain.width=this.width<=0?1:this.width,this.terrain.depth=this.depth<=0?1:this.depth)}}]},Tt,this.isDropShadow?{name:"\u2611 \u5f71\u3092\u843d\u3068\u3059",action:()=>{this.isDropShadow=!1}}:{name:"\u2610 \u5f71\u3092\u843d\u3068\u3059",action:()=>{this.isDropShadow=!0}},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0}},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,dt.play(Ze.sweep))},altitudeHande:this.terrain},Tt,{name:"\u5730\u5f62\u8a2d\u5b9a\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.terrain)}},this.terrain.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.terrain.getUrls().map(s=>{const o=s.value.toString();return{name:s.name?s.name:o,action:()=>{et.sameOrigin(o)?window.open(o.trim(),"_blank","noopener"):this.modalService.open(Hr,{url:o,title:this.terrain.name,subTitle:s.name})},disabled:!et.validUrl(o),error:et.validUrl(o)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:et.validUrl(o)&&!et.sameOrigin(o)}})},this.terrain.getUrls().length<=0?null:Tt,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let s=this.terrain.clone();s.location.x+=this.gridSize,s.location.y+=this.gridSize,s.isLocked=!1,this.terrain.parent&&this.terrain.parent.appendChild(s),dt.play(Ze.blockPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.terrain.destroy(),dt.play(Ze.sweep)}},Tt,{name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(r)}],this.name)}onMove(){dt.play(Ze.blockPick)}onMoved(){dt.play(Ze.blockPut)}get floorModCss(){let e="",i=0;switch(this.slopeDirection){case ii.TOP:i=Math.atan(this.height/this.depth),e=" rotateX("+i+"rad) scaleY("+1/Math.cos(i)+")";break;case ii.BOTTOM:i=Math.atan(this.height/this.depth),e=" rotateX("+-i+"rad) scaleY("+1/Math.cos(i)+")";break;case ii.LEFT:i=Math.atan(this.height/this.width),e=" rotateY("+-i+"rad) scaleX("+1/Math.cos(i)+")";break;case ii.RIGHT:i=Math.atan(this.height/this.width),e=" rotateY("+i+"rad) scaleX("+1/Math.cos(i)+")"}return e}get floorBrightness(){let e=1;if(!this.isSurfaceShading)return e;switch(this.slopeDirection){case ii.TOP:e=.4;break;case ii.BOTTOM:e=1;break;case ii.LEFT:e=.6;break;case ii.RIGHT:e=.9}return e}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){Fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5730\u5f62\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Gs,{title:r,left:i.x-250,top:i.y-150,width:550,height:380}).tabletopObject=e}}return n.\u0275fac=function(e){return new(e||n)(Le(vn),Le(wu),Le(mg),Le(sr),Le(_i),Le(In),Le(Di),Le(ai),Le(kn),Le(Ja))},n.\u0275cmp=Zt({type:n,selectors:[["terrain"]],hostBindings:function(e,i){1&e&&Te("dragstart",function(s){return i.onDragstart(s)})("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{terrain:"terrain",is3D:"is3D"},decls:8,vars:24,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.option","movable.disable","movable.interact","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"ngClass","rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],[4,"ngIf"],[1,"is-3d","texture",2,"z-index","1",3,"ngClass","ngStyle"],["class","is-3d","style","display:flex; align-items: center; border-left: 2px dashed blanchedalmond; position: absolute; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],["style","opacity: 0.7; filter: brightness(0) blur(1px); transform: translateZ(0.3px) scale(0.98); backface-visibility: visible","class","is-3d texture chrome-smooth-image-trick",3,"ngClass","background-image",4,"ngIf"],[1,"is-3d","texture","chrome-smooth-image-trick",2,"opacity","0.7","filter","brightness(0) blur(1px)","transform","translateZ(0.3px) scale(0.98)","backface-visibility","visible",3,"ngClass"],[1,"is-3d","texture","chrome-smooth-image-trick",3,"ngClass","ngStyle"],["class","is-3d texture of-wall-top chrome-smooth-image-trick","style","transform: translateY(-100%) rotateX(90deg) rotateZ(180deg) scaleX(-1.0)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-top","chrome-smooth-image-trick",2,"transform","translateY(-100%) rotateX(90deg) rotateZ(180deg) scaleX(-1.0)",3,"ngClass"],["class","is-3d texture of-wall-bottom chrome-smooth-image-trick","style","transform: rotateX(-90deg)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-bottom","chrome-smooth-image-trick",2,"transform","rotateX(-90deg)",3,"ngClass"],["class","is-3d texture of-wall-left chrome-smooth-image-trick","style","transform: rotateZ(90deg) rotateX(-90deg) scaleX(-1.0) translateX(-100%) translateY(-100%)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-left","chrome-smooth-image-trick",2,"transform","rotateZ(90deg) rotateX(-90deg) scaleX(-1.0) translateX(-100%) translateY(-100%)",3,"ngClass"],["class","is-3d texture of-wall-right chrome-smooth-image-trick","style","transform: rotateZ(-90deg) rotateX(-90deg) translateY(-100%)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-right","chrome-smooth-image-trick",2,"transform","rotateZ(-90deg) rotateX(-90deg) translateY(-100%)",3,"ngClass"],[1,"is-3d",2,"z-index","0"],[1,"pedestal-grab","rotate-grab","is-3d"],[1,"rotate-grab","of-left-top","rotate-grab-icon","is-3d"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","rotate-grab-icon","is-3d"],[1,"rotate-grab","of-right-bottom","rotate-grab-icon","is-3d"],[1,"rotate-grab","of-right-top","rotate-grab-icon","is-3d"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","position","absolute","transform-origin","top left",3,"ngStyle"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"]],template:function(e,i){1&e&&(K(0,"div",0),Te("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),K(1,"div",1),Te("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),xe(2,ZX,2,1,"ng-container",2),K(3,"div",3),xe(4,QX,3,13,"ng-container",2),xe(5,aQ,5,4,"ng-container",2),J(),xe(6,lQ,15,4,"ng-container",2),J(),xe(7,cQ,5,7,"div",4),J()),2&e&&(Ke("width",i.width*i.gridSize,"px")("height",i.depth*i.gridSize,"px"),te("movable.option",i.movableOption)("movable.disable",i.isLocked)("movable.interact",i.isInteract),U(1),te("ngClass",ut(17,uQ,!i.isLocked))("rotable.option",i.rotableOption)("rotable.disable",i.isLocked),U(1),te("ngIf",i.hasFloor&&i.isVisibleFloor&&0<(null==i.floorImage?null:i.floorImage.url.length)),U(1),te("ngClass",Kt(19,dQ,i.height<.5&&0==i.altitude,i.height>=.5&&0==i.altitude))("ngStyle",ut(22,sS,"translateZ("+i.altitude*i.gridSize+"px)")),U(1),te("ngIf",i.hasFloor&&i.isVisibleFloor&&0<(null==i.floorImage?null:i.floorImage.url.length)),U(1),te("ngIf",i.isWallExist),U(1),te("ngIf",!i.isLocked),U(1),te("ngIf",i.isAltitudeIndicate&&!((i.isSlope||i.isWallExist)&&-i.height<i.altitude&&i.altitude<0)&&(i.terreinAltitude<=-.5||.5<=i.terreinAltitude)))},directives:[il,Ql,Wn,_n,Zi],pipes:[ti],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{height:100%;width:100%}.texture[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;background-repeat:no-repeat;background-size:100% 100%;height:100%;width:100%}.of-wall-top[_ngcontent-%COMP%]{top:0px;left:0px;transform-origin:50% 100%;transform:translateY(-100%) rotateX(90deg) rotate(180deg) scaleX(-1);filter:brightness(.3)}.of-wall-bottom[_ngcontent-%COMP%]{bottom:0px;left:0px;transform-origin:50% 100%;transform:rotateX(-90deg)}.of-wall-left[_ngcontent-%COMP%]{top:0px;left:0px;transform-origin:0% 0%;transform:rotate(90deg) rotateX(-90deg) scaleX(-1) translate(-100%) translateY(-100%);filter:brightness(.5)}.of-wall-right[_ngcontent-%COMP%]{top:0px;right:0px;transform-origin:100% 0%;transform:rotate(-90deg) rotateX(-90deg) translateY(-100%);filter:brightness(.8)}.of-wall-top.is-slope[_ngcontent-%COMP%], .of-wall-bottom.is-slope[_ngcontent-%COMP%], .of-wall-left.is-slope[_ngcontent-%COMP%], .of-wall-right.is-slope[_ngcontent-%COMP%]{-webkit-clip-path:polygon(100% 0%,0% 100%,100% 100%);clip-path:polygon(100% 0%,0% 100%,100% 100%)}.of-wall-top.is-inverse-slope[_ngcontent-%COMP%], .of-wall-bottom.is-inverse-slope[_ngcontent-%COMP%], .of-wall-left.is-inverse-slope[_ngcontent-%COMP%], .of-wall-right.is-inverse-slope[_ngcontent-%COMP%]{-webkit-clip-path:polygon(0% 0%,100% 100%,0% 100%);clip-path:polygon(0% 0%,100% 100%,0% 100%)}.of-wall-top.no-shadow[_ngcontent-%COMP%], .of-wall-left.no-shadow[_ngcontent-%COMP%], .of-wall-right.no-shadow[_ngcontent-%COMP%]{filter:brightness(1)}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;position:absolute;top:-14px;left:-14px;right:-14px;bottom:-14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.rotate-grab[_ngcontent-%COMP%]{opacity:0;z-index:-1}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;border:solid 2px #CCCCCC;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:0;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;transform-style:preserve-3d;transform:translateZ(.1px)}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px;border-radius:14px 7px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px;border-radius:7px 14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px;border-radius:14px 7px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px;border-radius:7px 14px}.blinking-animation[_ngcontent-%COMP%]{-webkit-animation:blink 1s linear infinite alternate;animation:blink 1s linear infinite alternate}@-webkit-keyframes blink{0%{opacity:.9}to{opacity:.5}}@keyframes blink{0%{opacity:.9}to{opacity:.5}}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.upright-transform[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.fall[_ngcontent-%COMP%]{transition:transform 132ms cubic-bezier(.21,.97,.75,1.25)}"],changeDetection:0}),n})();const hQ=["draggablePanel"],pQ=["cardImage"],gQ=["fullCardImage"],mQ=["textArea"];function _Q(n,t){1&n&&pn(0)}function $Q(n,t){1&n&&pn(0)}const oS=function(n){return{card:n}};function vQ(n,t){if(1&n&&(Ve(0),xe(1,$Q,1,0,"ng-container",14),Ge()),2&n){const e=ge(),i=Wt(13);U(1),te("ngTemplateOutlet",i)("ngTemplateOutletContext",ut(2,oS,e.tabletopObject))}}function bQ(n,t){1&n&&pn(0)}function yQ(n,t){if(1&n&&(Ve(0),xe(1,bQ,1,0,"ng-container",14),Ge()),2&n){const e=ge(),i=Wt(13);U(1),te("ngTemplateOutlet",i)("ngTemplateOutletContext",ut(2,oS,e.tabletopObject))}}function CQ(n,t){1&n&&pn(0)}const xQ=function(n){return{note:n}};function wQ(n,t){if(1&n&&(Ve(0),xe(1,CQ,1,0,"ng-container",14),Ge()),2&n){const e=ge(),i=Wt(15);U(1),te("ngTemplateOutlet",i)("ngTemplateOutletContext",ut(2,xQ,e.tabletopObject))}}function EQ(n,t){1&n&&pn(0)}const TQ=function(n){return{character:n}};function IQ(n,t){if(1&n&&(Ve(0),xe(1,EQ,1,0,"ng-container",14),Ge()),2&n){const e=ge(),i=Wt(17);U(1),te("ngTemplateOutlet",i)("ngTemplateOutletContext",ut(2,TQ,e.tabletopObject))}}function SQ(n,t){1&n&&pn(0)}const MQ=function(n){return{dice:n}};function kQ(n,t){if(1&n&&(Ve(0),xe(1,SQ,1,0,"ng-container",14),Ge()),2&n){const e=ge(),i=Wt(19);U(1),te("ngTemplateOutlet",i)("ngTemplateOutletContext",ut(2,MQ,e.tabletopObject))}}function DQ(n,t){1&n&&pn(0)}const AQ=function(n){return{range:n}};function PQ(n,t){if(1&n&&(Ve(0),xe(1,DQ,1,0,"ng-container",14),Ge()),2&n){const e=ge(),i=Wt(21);U(1),te("ngTemplateOutlet",i)("ngTemplateOutletContext",ut(2,AQ,e.tabletopObject))}}function NQ(n,t){1&n&&pn(0)}const FQ=function(n){return{object:n}};function OQ(n,t){if(1&n&&(Ve(0),xe(1,NQ,1,0,"ng-container",14),Ge()),2&n){const e=ge(),i=Wt(23);U(1),te("ngTemplateOutlet",i)("ngTemplateOutletContext",ut(2,FQ,e.tabletopObject))}}function RQ(n,t){1&n&&pn(0)}function BQ(n,t){if(1&n&&(Ve(0),xe(1,RQ,1,0,"ng-container",15),Ge()),2&n){ge();const e=Wt(27);U(1),te("ngTemplateOutlet",e)}}const aS=function(n){return{transform:n}};function LQ(n,t){if(1&n&&(K(0,"div",28),it(1,"div",29),Ct(2,"safe"),J()),2&n){const e=ge(3);Ke("width",e.imageAreaRect.width,"px")("height",e.imageAreaRect.height,"px")("left",e.imageAreaRect.left,"px"),te("ngStyle",ut(17,aS,"scale("+e.imageAreaRect.scale+")")),U(1),Ke("font-size",e.cardFontSize,"px")("color",e.cardColor)("text-shadow",e.cardTextShadowCss),te("innerHTML",xt(2,14,e.cardText,"html"),qi)}}const lS=function(n){return{"with-button-marign":n}};function zQ(n,t){if(1&n&&(K(0,"div",30)(1,"div",31),be(2),J()()),2&n){const e=ge(2).card,i=ge();te("ngClass",ut(4,lS,i.hasImage)),U(1),Ke("background-color",e.ownerColor),U(1),qe(e.ownerName)}}function jQ(n,t){if(1&n){const e=Xe();K(0,"div",21),xe(1,LQ,3,19,"div",22),K(2,"img",23,24),Te("load",function(){return De(e),ge(2).onCardImageLoad()}),Ct(4,"safe"),J(),K(5,"button",25),Te("click",function(){return De(e),ge(2).chanageImageView(!0)}),K(6,"i",26),be(7,"zoom_in"),J()(),xe(8,zQ,3,6,"div",27),J()}if(2&n){const e=ge().card,i=ge();U(1),te("ngIf","card"==e.aliasName&&(e.isFront||e.isHand||e.isGMMode)||"card-stack"==e.aliasName&&e.topCard.isFront),U(1),te("src",xt(4,3,i.imageUrl,"resourceUrl"),Jt),U(6),te("ngIf",e.ownerIsOnline&&0<e.ownerName.length)}}function HQ(n,t){if(1&n&&(Ve(0),be(1),Ge()),2&n){const e=ge().card;U(1),qe(e.name)}}function UQ(n,t){1&n&&(Ve(0),be(1," \u306e\u30c8\u30c3\u30d7"),Ge())}function VQ(n,t){1&n&&(Ve(0),be(1,"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09"),Ge())}function GQ(n,t){1&n&&pn(0)}const Eu=function(n,t){return{dataElm:n,name:t}};function qQ(n,t){if(1&n&&(Ve(0),xe(1,GQ,1,0,"ng-container",14),Ge()),2&n){const e=t.$implicit,i=ge(2).card;ge();const r=Wt(25);U(1),te("ngTemplateOutlet",r)("ngTemplateOutletContext",Kt(2,Eu,e,i.name))}}function WQ(n,t){if(1&n&&(K(0,"div",32)(1,"div",33),xe(2,qQ,2,5,"ng-container",34),J()()),2&n){const e=ge(2);U(2),te("ngForOf",e.dataElms)}}const Mr=function(n,t){return{"is-pointer-events-auto":n,"pointer-events-none":t}};function KQ(n,t){if(1&n&&(K(0,"div",16),xe(1,jQ,9,6,"div",17),K(2,"div",18),xe(3,HQ,2,1,"ng-container",5),xe(4,UQ,2,0,"ng-container",5),xe(5,VQ,2,0,"ng-container",5),J(),K(6,"div",19),xe(7,WQ,3,1,"div",20),J()()),2&n){const e=t.card,i=ge();te("ngClass",Kt(7,Mr,!i.isPointerDragging,i.isPointerDragging)),U(1),te("ngIf",i.hasImage),U(1),te("ngClass",ut(10,lS,i.hasImage)),U(1),te("ngIf",null==e.isVisible||e.isVisible||e.isGMMode),U(1),te("ngIf","card-stack"==e.aliasName&&!e.isEmpty),U(1),te("ngIf",null!=e.isVisible&&!e.isVisible&&!e.isGMMode),U(2),te("ngIf",i.hasDataElms&&(e.isVisible||e.isGMMode))}}const YQ=function(n){return{"hide-text-area":n}},ZQ=function(n){return{"hide-area":n}};function XQ(n,t){if(1&n){const e=Xe();K(0,"div",35)(1,"div",36),be(2),J(),K(3,"div",37)(4,"div",38),Te("mousedown",function(){return De(e),ge().textAreaActivate()}),K(5,"div",39)(6,"textarea",40,41),Te("ngModelChange",function(r){return De(e).note.text=r}),J()(),it(8,"div",42),Ct(9,"safe"),it(10,"div",43),Ct(11,"safe"),J()()()}if(2&n){const e=t.note,i=ge();te("ngClass",Kt(13,Mr,!i.isPointerDragging,i.isPointerDragging)),U(2),qe(e.title),U(4),te("ngModel",e.text)("ngClass",ut(16,YQ,!i.isSelected)),U(2),te("innerHTML",xt(9,7,i.adjustedRubiedNote(e.text),"html"),qi)("ngClass",ut(18,ZQ,i.isSelected)),U(2),te("innerHTML",xt(11,10,i.adjustedRubiedNote(e.text,!i.isSelected),"html"),qi)}}const QQ=function(n){return{transform:n}},cS=function(n,t){return{inverse:n,hollow:t}},uS=function(n,t,e,i,r,s,o,c){return{black:n,blue:t,green:e,cyan:i,red:r,magenta:s,yellow:o,white:c}},dS=function(n){return{"black-paint":n}};function JQ(n,t){if(1&n&&(Ve(0),K(1,"div",51)(2,"div",52)(3,"span",53),it(4,"img",54),Ct(5,"safe"),J()()(),Ge()),2&n){const e=ge(3);U(1),te("ngStyle",ut(8,QQ,"rotate("+e.roll+"deg)")),U(1),te("ngClass",Kt(10,cS,e.isInverse,e.isHollow)),U(1),te("ngClass",ao(13,uS,0==e.aura,1==e.aura,2==e.aura,3==e.aura,4==e.aura,5==e.aura,6==e.aura,7==e.aura)),U(1),te("ngClass",ut(22,dS,e.isBlackPaint))("src",xt(5,5,e.imageUrl,"resourceUrl"),Jt)}}function eJ(n,t){if(1&n&&(Ve(0),it(1,"img",55),Ct(2,"safe"),Ge()),2&n){const e=ge(3);U(1),te("src",xt(2,1,e.imageUrl,"resourceUrl"),Jt)}}const tJ=function(n,t,e){return{"has-icon":n,"is-pointer-events-auto":t,"pointer-events-none":e}};function nJ(n,t){if(1&n&&(K(0,"div",50),xe(1,JQ,6,24,"ng-container",5),xe(2,eJ,3,4,"ng-container",5),J()),2&n){const e=ge(2);te("ngClass",Zr(3,tJ,e.isUseIcon,!e.isPointerDragging,e.isPointerDragging)),U(1),te("ngIf",!e.isUseIcon),U(1),te("ngIf",e.isUseIcon)}}function iJ(n,t){1&n&&pn(0)}function rJ(n,t){if(1&n&&(Ve(0),K(1,"div",33),xe(2,iJ,1,0,"ng-container",14),J(),Ge()),2&n){const e=ge().$implicit,i=ge(2).character;ge();const r=Wt(25);U(2),te("ngTemplateOutlet",r)("ngTemplateOutletContext",Kt(2,Eu,e,i.name))}}function sJ(n,t){if(1&n&&(Ve(0),xe(1,rJ,3,5,"ng-container",5),Ge()),2&n){const e=t.$implicit,i=ge(3);U(1),te("ngIf",e&&e.name!==i.newLineString)}}function oJ(n,t){if(1&n&&(K(0,"div",32),xe(1,sJ,2,1,"ng-container",34),J()),2&n){const e=ge(2);U(1),te("ngForOf",e.inventoryDataElms)}}function aJ(n,t){if(1&n&&(K(0,"div",44),it(1,"div",45),xe(2,nJ,3,7,"div",46),K(3,"div",47),be(4),J(),it(5,"div",48),K(6,"div",49),xe(7,oJ,2,1,"div",20),J()()),2&n){const e=t.character,i=ge();U(1),te("ngClass",Kt(6,Mr,!i.isPointerDragging,i.isPointerDragging)),U(1),te("ngIf",i.hasImage),U(1),te("ngClass",Kt(9,Mr,!i.isPointerDragging,i.isPointerDragging)),U(1),qe(e.name),U(2),te("ngClass",Kt(12,Mr,!i.isPointerDragging,i.isPointerDragging)),U(1),te("ngIf",i.hasDataElms)}}function lJ(n,t){if(1&n&&(Ve(0),be(1),Ge()),2&n){const e=ge().dice;U(1),An("",e.name,":")}}function cJ(n,t){if(1&n&&(Ve(0),be(1),Ge()),2&n){const e=ge().dice;U(1),qe(e.face)}}function uJ(n,t){1&n&&(Ve(0),be(1,"???"),Ge())}function dJ(n,t){if(1&n&&(K(0,"div",57)(1,"div",31),be(2),J()()),2&n){const e=ge().dice,i=ge();te("ngClass",Kt(4,Mr,!i.isPointerDragging,i.isPointerDragging)),U(1),Ke("background-color",e.ownerColor),U(1),An("",e.ownerName," ")}}const fJ=function(n,t){return{"is-black-mask":n,"is-harf-black-mask":t}};function hJ(n,t){if(1&n&&(K(0,"div",50),it(1,"img",58),Ct(2,"safe"),J()),2&n){const e=ge().dice,i=ge();te("ngClass",Kt(6,Mr,!i.isPointerDragging,i.isPointerDragging)),U(1),te("ngClass",Kt(9,fJ,!e.isVisible,e.isMine||e.isGMMode&&e.hasOwner))("src",xt(2,3,i.imageUrl,"resourceUrl"),Jt)}}function pJ(n,t){1&n&&pn(0)}function gJ(n,t){if(1&n&&(Ve(0),xe(1,pJ,1,0,"ng-container",14),Ge()),2&n){const e=ge().$implicit,i=ge(2).dice;ge();const r=Wt(25);U(1),te("ngTemplateOutlet",r)("ngTemplateOutletContext",Kt(2,Eu,e,i.name))}}function mJ(n,t){if(1&n&&(Ve(0),xe(1,gJ,2,5,"ng-container",5),Ge()),2&n){const e=t.$implicit,i=ge(3);U(1),te("ngIf",e&&e.name!==i.newLineString)}}function _J(n,t){if(1&n&&(K(0,"div",32)(1,"div",33),xe(2,mJ,2,1,"ng-container",34),J()()),2&n){const e=ge(2);U(2),te("ngForOf",e.dataElms)}}function $J(n,t){if(1&n&&(K(0,"div",44),it(1,"div",45),K(2,"div",47),xe(3,lJ,2,1,"ng-container",5),xe(4,cJ,2,1,"ng-container",5),xe(5,uJ,2,0,"ng-container",5),J(),xe(6,dJ,3,7,"div",56),xe(7,hJ,3,12,"div",46),it(8,"div",48),K(9,"div",49),xe(10,_J,3,1,"div",20),J()()),2&n){const e=t.dice,i=ge();U(1),te("ngClass",Kt(9,Mr,!i.isPointerDragging,i.isPointerDragging)),U(1),te("ngClass",Kt(12,Mr,!i.isPointerDragging,i.isPointerDragging)),U(1),te("ngIf",0<(null==e||null==e.name?null:e.name.length)),U(1),te("ngIf",e.isVisible),U(1),te("ngIf",!e.isVisible),U(1),te("ngIf",e.hasOwner&&0<e.ownerName.length),U(1),te("ngIf",i.hasImage),U(2),te("ngClass",Kt(15,Mr,!i.isPointerDragging,i.isPointerDragging)),U(1),te("ngIf",i.hasDataElms&&e.isVisible)}}function vJ(n,t){if(1&n){const e=Xe();Ve(0),K(1,"div",60),be(2),J(),K(3,"div",61)(4,"div",62)(5,"div",63),be(6),J(),K(7,"input",64),Te("ngModelChange",function(r){return De(e),ge().$implicit.value=r}),J()()(),K(8,"div",65)(9,"input",66),Te("ngModelChange",function(r){return De(e),ge().$implicit.value=r}),Ct(10,"safe"),J()(),Ge()}if(2&n){const e=ge().$implicit;U(1),Rt("title",e.name),U(1),qe(e.name),U(4),qe(e.value),U(1),te("ngModel",e.value),U(2),ur(xt(10,9,"font-size: 0.8em; width: 100%; --min: 0; --max:"+e.value+"; --val:"+e.currentValue+";","style")),ct("title",e.value),te("min","length"==e.name?1:0)("ngModel",e.value)}}function bJ(n,t){if(1&n){const e=Xe();Ve(0),K(1,"div",60),be(2),J(),K(3,"div",61)(4,"div",62)(5,"div",63),be(6),J(),K(7,"input",67),Te("ngModelChange",function(r){return De(e),ge().$implicit.currentValue=r}),J(),K(8,"b",68),be(9,"%"),J()()(),K(10,"div",65)(11,"input",69),Te("ngModelChange",function(r){return De(e),ge().$implicit.currentValue=r}),Ct(12,"safe"),J()(),Ge()}if(2&n){const e=ge().$implicit;U(1),Rt("title",e.name),U(1),qe(e.name),U(4),qe(e.currentValue),U(1),te("ngModel",e.currentValue),U(4),ur(xt(12,8,"font-size: 0.8em; width: 100%; --min: 0; --max:"+e.value+"; --val:"+e.currentValue+";","style")),Wi("title","",e.currentValue,"%"),te("ngModel",e.currentValue)}}function yJ(n,t){if(1&n&&(Ve(0),xe(1,vJ,11,12,"ng-container",5),xe(2,bJ,13,11,"ng-container",5),Ge()),2&n){const e=t.$implicit;U(1),te("ngIf","length"==e.name||"width"==e.name),U(1),te("ngIf","opacity"==e.name)}}function CJ(n,t){if(1&n&&(Ve(0),K(1,"div",70),be(2),J(),K(3,"div",71)(4,"div",72)(5,"span",73),it(6,"img",74),Ct(7,"safe"),J()()(),Ge()),2&n){const e=ge(2).range;U(2),An("\u27a1 ",e.followingCharactor.name,""),U(2),te("ngClass",Kt(8,cS,e.followingCharactor.isInverse,e.followingCharactor.isHollow)),U(1),te("ngClass",ao(11,uS,0==e.followingCharactor.aura,1==e.followingCharactor.aura,2==e.followingCharactor.aura,3==e.followingCharactor.aura,4==e.followingCharactor.aura,5==e.followingCharactor.aura,6==e.followingCharactor.aura,7==e.followingCharactor.aura)),U(1),te("ngClass",ut(20,dS,e.followingCharactor.isBlackPaint))("src",xt(7,5,e.followingCharactor.imageFile.url,"resourceUrl"),Jt)}}function xJ(n,t){1&n&&it(0,"div",75)}function wJ(n,t){1&n&&pn(0)}function EJ(n,t){if(1&n&&(Ve(0),xe(1,wJ,1,0,"ng-container",14),Ge()),2&n){const e=ge().$implicit,i=ge(2).range;ge();const r=Wt(25);U(1),te("ngTemplateOutlet",r)("ngTemplateOutletContext",Kt(2,Eu,e,i.name))}}function TJ(n,t){if(1&n&&(Ve(0),xe(1,EJ,2,5,"ng-container",5),Ge()),2&n){const e=t.$implicit,i=ge(3);U(1),te("ngIf",e&&e.name!==i.newLineString)}}function IJ(n,t){if(1&n&&(K(0,"div",32)(1,"div",33),xe(2,yJ,3,2,"ng-container",34),xe(3,CJ,8,22,"ng-container",5),xe(4,xJ,1,0,"div",59),xe(5,TJ,2,1,"ng-container",34),J()()),2&n){const e=ge().range,i=ge();U(2),te("ngForOf",i.rangeElms),U(1),te("ngIf",e.followingCharactor),U(1),te("ngIf",i.dataElms.length>0),U(1),te("ngForOf",i.dataElms)}}function SJ(n,t){if(1&n&&(K(0,"div",44),it(1,"div",45),K(2,"div",47),be(3),J(),it(4,"div",48),K(5,"div",49),xe(6,IJ,6,4,"div",20),J()()),2&n){const e=t.range,i=ge();U(1),te("ngClass",Kt(5,Mr,!i.isPointerDragging,i.isPointerDragging)),U(1),te("ngClass",Kt(8,Mr,!i.isPointerDragging,i.isPointerDragging)),U(1),qe(e.name),U(2),te("ngClass",Kt(11,Mr,!i.isPointerDragging,i.isPointerDragging)),U(1),te("ngIf",i.rangeElms.length>0)}}function MJ(n,t){1&n&&pn(0)}function kJ(n,t){if(1&n&&(Ve(0),xe(1,MJ,1,0,"ng-container",14),Ge()),2&n){const e=ge().$implicit,i=ge().object;ge();const r=Wt(25);U(1),te("ngTemplateOutlet",r)("ngTemplateOutletContext",Kt(2,Eu,e,i.name))}}function DJ(n,t){if(1&n&&(Ve(0),xe(1,kJ,2,5,"ng-container",5),Ge()),2&n){const e=t.$implicit,i=ge(2);U(1),te("ngIf",e&&e.name!==i.newLineString)}}function AJ(n,t){if(1&n&&(K(0,"div",44),it(1,"div",45),K(2,"div",47),be(3),J(),it(4,"div",48),K(5,"div",49)(6,"div",32)(7,"div",33),xe(8,DJ,2,1,"ng-container",34),J()()()()),2&n){const e=t.object,i=ge();U(1),te("ngClass",Kt(5,Mr,!i.isPointerDragging,i.isPointerDragging)),U(1),te("ngClass",Kt(8,Mr,!i.isPointerDragging,i.isPointerDragging)),U(1),qe(e.name),U(2),te("ngClass",Kt(11,Mr,!i.isPointerDragging,i.isPointerDragging)),U(3),te("ngForOf",i.dataElms)}}function PJ(n,t){1&n&&pn(0)}function NJ(n,t){if(1&n&&(K(0,"div",82),be(1),J()),2&n){const e=ge(2).dataElm;Rt("title",e.name),U(1),qe(e.name)}}function FJ(n,t){1&n&&pn(0)}function OJ(n,t){if(1&n&&(Ve(0),xe(1,FJ,1,0,"ng-container",14),Ge()),2&n){const e=t.$implicit,i=ge(2).name;ge();const r=Wt(25);U(1),te("ngTemplateOutlet",r)("ngTemplateOutletContext",Kt(2,Eu,e,i))}}function RJ(n,t){if(1&n&&(K(0,"div",79),xe(1,NJ,2,2,"div",80),K(2,"div",81),xe(3,OJ,2,5,"ng-container",34),J()()),2&n){const e=ge().dataElm;U(1),te("ngIf",0<e.name.trim().length),U(2),te("ngForOf",e.children)}}function BJ(n,t){if(1&n){const e=Xe();Ve(0),K(1,"div",84)(2,"div"),be(3),J(),K(4,"div",85)(5,"div",39)(6,"textarea",86),Te("ngModelChange",function(r){return De(e),ge(2).dataElm.value=r}),J()(),K(7,"div",87),be(8),J()()(),Ge()}if(2&n){const e=ge(2).dataElm;U(2),Rt("title",e.name),U(1),qe(e.name),U(3),te("ngModel",e.value),U(2),qe(e.value)}}function LJ(n,t){if(1&n){const e=Xe();Ve(0),K(1,"div",70),be(2),J(),K(3,"div",61)(4,"div",88),be(5),J(),K(6,"input",89),Te("ngModelChange",function(r){return De(e),ge(2).dataElm.value=r}),J()(),Ge()}if(2&n){const e=ge(2),i=e.dataElm,r=e.name,s=ge();U(1),Rt("title",i.name),U(1),qe(i.name),U(3),qe(i.value),U(1),ct("type",i.value&&i.value==+i.value?"number":"text"),te("logging.name",r)("logging.dataElement",i)("logging.disable",s.isNoLogging)("ngModel",i.value)}}function zJ(n,t){if(1&n){const e=Xe();Ve(0),K(1,"div",60),be(2),J(),K(3,"div",61)(4,"div",62)(5,"div",63),be(6),J(),K(7,"input",90),Te("ngModelChange",function(r){return De(e),ge(2).dataElm.currentValue=r}),J()(),K(8,"div",91),be(9),J()(),K(10,"div",65)(11,"input",92),Te("ngModelChange",function(r){return De(e),ge(2).dataElm.currentValue=r}),Ct(12,"safe"),J()(),Ge()}if(2&n){const e=ge(2),i=e.dataElm,r=e.name,s=ge();U(1),Rt("title",i.name),U(1),qe(i.name),U(4),qe(i.currentValue),U(1),te("logging.name",r)("logging.dataElement",i)("logging.disable",s.isNoLogging)("ngModel",i.currentValue),U(2),An(" / ",+i.value?i.value:"???",""),U(2),ur(xt(12,16,"font-size: 0.8em; width: 100%; --min: 0; --max:"+i.value+"; --val:"+i.currentValue+";","style")),ct("title",i.currentValue),ct("max",+i.value?i.value:1e3),te("logging.name",r)("logging.dataElement",i)("logging.disable",s.isNoLogging)("ngModel",i.currentValue)}}function jJ(n,t){if(1&n){const e=Xe();Ve(0),K(1,"div",70)(2,"span"),be(3),J(),be(4),J(),K(5,"div",61)(6,"input",93),Te("ngModelChange",function(r){return De(e),ge(2).dataElm.value=r})("change",function(){De(e);const r=ge(2).dataElm;return r.value=r.value?r.name:""}),J()(),Ge()}if(2&n){const e=ge(2),i=e.dataElm,r=e.name,s=ge();U(1),Rt("title",i.name),U(1),Ke("text-decoration",i.value?"none":"line-through"),U(1),qe(i.name),U(1),An(" ",i.currentValue.toString().split(s.checkRegExp)[i.value?0:1],""),U(2),ct("checked",i.value?"checked":""),te("logging.name",r)("logging.dataElement",i)("logging.disable",s.isNoLogging)("ngModel",i.value)}}function HJ(n,t){if(1&n&&(K(0,"span",95),be(1),J()),2&n){const e=ge(3).dataElm;U(1),An("(",(e.calcAbilityScore()>=0?"+":"")+e.calcAbilityScore(),")")}}function UJ(n,t){if(1&n){const e=Xe();Ve(0),K(1,"div",70),be(2),J(),K(3,"div",61)(4,"div",88),be(5),J(),K(6,"input",89),Te("ngModelChange",function(r){return De(e),ge(2).dataElm.value=r}),J(),xe(7,HJ,2,1,"span",94),J(),Ge()}if(2&n){const e=ge(2),i=e.dataElm,r=e.name,s=ge();U(1),Rt("title",i.name),U(1),qe(i.name),U(3),qe(i.value),U(1),ct("type",i.value&&i.value==+i.value?"number":"text"),te("logging.name",r)("logging.dataElement",i)("logging.disable",s.isNoLogging)("ngModel",i.value),U(1),te("ngIf",i.currentValue)}}function VJ(n,t){if(1&n){const e=Xe();Ve(0),K(1,"div",70),be(2),J(),K(3,"div",61)(4,"div",88),be(5),J(),K(6,"input",96),Te("ngModelChange",function(r){return De(e),ge(2).dataElm.value=r}),J(),K(7,"button",97),Te("click",function(){De(e);const r=ge(2),s=r.dataElm,o=r.name,c=ge();return!!c.stringUtil.validUrl(s.value)&&c.openUrl(s.value,o,s.name)}),K(8,"i",98),be(9),J()()(),Ge()}if(2&n){const e=ge(2).dataElm,i=ge();U(1),Rt("title",e.name),U(1),qe(e.name),U(3),qe(e.value),U(1),te("ngModel",e.value),U(1),Rt("disabled",i.stringUtil.validUrl(e.value)?null:""),U(2),qe(i.stringUtil.validUrl(e.value)?i.stringUtil.sameOrigin(e.value)?"link":"open_in_new":"link_off")}}function GJ(n,t){if(1&n&&(K(0,"div",70),be(1),J()),2&n){const e=ge(3).dataElm;Rt("title",e.name),U(1),qe(e.name)}}function qJ(n,t){if(1&n&&(K(0,"div",88),be(1),J()),2&n){const e=ge(3).dataElm;U(1),qe(e.value)}}const WJ=function(n){return{"min-width":n}};function KJ(n,t){if(1&n){const e=Xe();Ve(0),xe(1,GJ,2,2,"div",99),K(2,"div",61),xe(3,qJ,2,1,"div",100),K(4,"input",101),Te("ngModelChange",function(r){return De(e),ge(2).dataElm.value=r}),J()(),Ge()}if(2&n){const e=ge(2).dataElm;U(1),te("ngIf",e.name),U(2),te("ngIf",e.name),U(1),ct("type","size"===e.name||"altitude"===e.name?"number":"text"),ct("min","size"===e.name?"0":""),te("ngStyle",ut(6,WJ,e.name?"8em":"100%"))("ngModel",e.value)}}function YJ(n,t){1&n&&(Ve(0,2),xe(1,BJ,9,4,"ng-container",3),xe(2,LJ,7,8,"ng-container",3),xe(3,zJ,13,19,"ng-container",3),xe(4,jJ,7,10,"ng-container",3),xe(5,UJ,8,9,"ng-container",3),xe(6,VJ,10,6,"ng-container",3),xe(7,KJ,5,8,"ng-container",4),Ge(),it(8,"div",83)),2&n&&(te("ngSwitch",ge().dataElm.type),U(1),te("ngSwitchCase","note"),U(1),te("ngSwitchCase","simpleNumber"),U(1),te("ngSwitchCase","numberResource"),U(1),te("ngSwitchCase","checkProperty"),U(1),te("ngSwitchCase","abilityScore"),U(1),te("ngSwitchCase","url"))}function ZJ(n,t){if(1&n&&(xe(0,PJ,1,0,"ng-container",76),xe(1,RJ,4,2,"ng-template",null,77,Ln),xe(3,YJ,9,7,"ng-template",null,78,Ln)),2&n){const e=t.dataElm,i=Wt(2),r=Wt(4);te("ngIf",0<e.children.length)("ngIfThen",i)("ngIfElse",r)}}function XJ(n,t){if(1&n&&(K(0,"div",107),it(1,"div",29),Ct(2,"safe"),J()),2&n){const e=ge(2);Ke("width",e.fullImageAreaRect.width,"px")("height",e.fullImageAreaRect.height,"px")("left",e.fullImageAreaRect.left,"px")("top",e.fullImageAreaRect.top,"px"),te("ngStyle",ut(19,aS,"scale("+e.fullImageAreaRect.scale+")")),U(1),Ke("font-size",e.cardFontSize,"px")("color",e.cardColor)("text-shadow",e.cardTextShadowCss),te("innerHTML",xt(2,16,e.cardText,"html"),qi)}}function QJ(n,t){if(1&n){const e=Xe();K(0,"div",102),Te("click",function(){return De(e),ge().chanageImageView(!1)}),xe(1,XJ,3,21,"div",103),K(2,"div",104)(3,"i",26),be(4,"close"),J()(),it(5,"img",105,106),Ct(7,"safe"),J()}if(2&n){const e=ge();te("@fadeInOut","in"),U(1),te("ngIf","card"==e.tabletopObject.aliasName&&(e.tabletopObject.isFront||e.tabletopObject.isHand||e.tabletopObject.isGMMode)||"card-stack"==e.tabletopObject.aliasName&&e.tabletopObject.topCard.isFront),U(4),te("src",xt(7,3,e.imageUrl,"resourceUrl"),Jt)}}let JJ=(()=>{class n{constructor(e,i,r,s){this.inventoryService=e,this.changeDetector=i,this.pointerDeviceService=r,this.modalService=s,this.tabletopObject=null,this.left=0,this.top=0,this.gridSize=50,this.naturalWidth=0,this.naturalHeight=0,this.stringUtil=et,this._imageFile=Ht.Empty,this.isOpenImageView=!1,this.checkRegExp=/[|\uff5c]/g}get imageUrl(){if(!this.tabletopObject)return"";if(this.isUseIcon)return this.tabletopObject.faceIcon.url;if(this.tabletopObject instanceof Vt&&this.tabletopObject.standList&&this.tabletopObject.standList.overviewIndex>-1){const e=this.tabletopObject.standList.standElements[this.tabletopObject.standList.overviewIndex];if(!e)return"";try{const i=e.getFirstElementByName("imageIdentifier");if(!i)return"";if(this._imageFile.identifier!=i.value){const r=kt.instance.get(i.value);this._imageFile=r||Ht.Empty}}catch(i){console.log(i)}return this._imageFile.url}return this.tabletopObject instanceof On&&this.tabletopObject.isGMMode?this.tabletopObject.frontImage?this.tabletopObject.frontImage.url:"":this.tabletopObject.imageFile?this.tabletopObject.imageFile.url:""}get hasImage(){return 0<this.imageUrl.length}get isUseIcon(){return this.tabletopObject instanceof Vt&&this.tabletopObject.isUseIconToOverviewImage&&this.tabletopObject.faceIcon&&0<this.tabletopObject.faceIcon.url.length}get roll(){if(this.tabletopObject instanceof Vt){if(this.tabletopObject.standList&&this.tabletopObject.standList.overviewIndex>-1){const e=this.tabletopObject.standList.standElements[this.tabletopObject.standList.overviewIndex];if(!e)return 0;try{const i=e.getFirstElementByName("applyRoll");return i&&i.value?this.tabletopObject.roll:0}catch(i){console.log(i)}}return this.tabletopObject.roll}return 0}get applyImageEffect(){if(this.tabletopObject instanceof Vt){if(this.tabletopObject.standList&&this.tabletopObject.standList.overviewIndex>-1){const e=this.tabletopObject.standList.standElements[this.tabletopObject.standList.overviewIndex];if(!e)return!1;try{const i=e.getFirstElementByName("applyImageEffect");return!(!i||!i.value)}catch(i){console.log(i)}}return!0}return!1}get isInverse(){return!!(this.tabletopObject instanceof Vt&&this.applyImageEffect)&&this.tabletopObject.isInverse}get isHollow(){return!!(this.tabletopObject instanceof Vt&&this.applyImageEffect)&&this.tabletopObject.isHollow}get isBlackPaint(){return!!(this.tabletopObject instanceof Vt&&this.applyImageEffect)&&this.tabletopObject.isBlackPaint}get aura(){return this.tabletopObject instanceof Vt&&this.applyImageEffect?this.tabletopObject.aura:-1}get inventoryDataElms(){return this.tabletopObject?this.getInventoryTags(this.tabletopObject):[]}get dataElms(){return this.tabletopObject&&this.tabletopObject.detailDataElement?this.tabletopObject.detailDataElement.children:[]}get hasDataElms(){return 0<this.dataElms.length}get newLineString(){return this.inventoryService.newLineString}get isPointerDragging(){return this.pointerDeviceService.isDragging}get pointerEventsStyle(){return{"is-pointer-events-auto":!this.isPointerDragging,"pointer-events-none":this.isPointerDragging}}ngAfterViewInit(){this.initPanelPosition(),setTimeout(()=>{this.adjustPositionRoot()},16),Fe.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=lt.instance.get(e.data.identifier);!this.tabletopObject||!i||!(i instanceof zn)||(this.tabletopObject===i||this.tabletopObject.contains(i))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()})}ngOnDestroy(){Fe.unregister(this)}initPanelPosition(){let e=this.draggablePanel.nativeElement,i=e.offsetWidth,s=this.left+100,o=this.top-e.offsetHeight-50,c=!1;window.innerWidth<s+i&&(s=window.innerWidth-i,c=!0),o<=0&&(o=0),c&&(s=this.left-i-100),s<0&&(s=0),o<0&&(o=0),e.style.left=s+"px",e.style.top=o+"px"}adjustPositionRoot(){let e=this.draggablePanel.nativeElement,i=e.getBoundingClientRect(),r=0,s=0;window.innerWidth<i.right+r&&(r+=window.innerWidth-(i.right+r)),i.left+r<0&&(r+=0-(i.left+r)),window.innerHeight<i.bottom+s&&(s+=window.innerHeight-(i.bottom+s)),i.top+s<0&&(s+=0-(i.top+s)),e.style.left=e.offsetLeft+r+"px",e.style.top=e.offsetTop+s+"px"}chanageImageView(e){this.isOpenImageView=e}openUrl(e,i=null,r=null){et.sameOrigin(e)?window.open(e.trim(),"_blank","noopener"):this.modalService.open(Hr,{url:e,title:i,subTitle:r})}getInventoryTags(e){return this.inventoryService.tableInventory.dataElementMap.get(e.identifier)}onCardImageLoad(){!this.cardImageElement||(this.naturalWidth=this.cardImageElement.nativeElement.naturalWidth,this.naturalHeight=this.cardImageElement.nativeElement.naturalHeight)}onFullCardImageLoad(){!this.cardImageElement||(this.naturalWidth=this.cardImageElement.nativeElement.naturalWidth,this.naturalHeight=this.cardImageElement.nativeElement.naturalHeight)}get imageAreaRect(){return this.calcImageAreaRect(250,330,8)}get fullImageAreaRect(){return this.calcImageAreaRect(document.documentElement.clientWidth,document.documentElement.offsetHeight,16)}calcImageAreaRect(e,i,r){const s={width:0,height:0,top:r,left:r,scale:1};if(0==this.naturalWidth||0==this.naturalHeight)return s;const o=e-2*r,c=i-2*r;this.naturalHeight*o/this.naturalWidth>c?(s.width=this.naturalWidth*c/this.naturalHeight,s.height=c,s.left=r+(o-s.width)/2):(s.width=o,s.height=this.naturalHeight*o/this.naturalWidth,s.top=r+(c-s.height)/2);let m=null;return this.tabletopObject instanceof Gn?m=this.tabletopObject.topCard:this.tabletopObject instanceof On&&(m=this.tabletopObject),m&&(s.scale=s.width/(m.size*this.gridSize),s.width=m.size*this.gridSize,s.height=s.width*this.naturalHeight/this.naturalWidth),s}get cardColor(){let e=null;return this.tabletopObject instanceof Gn?e=this.tabletopObject.topCard:this.tabletopObject instanceof On&&(e=this.tabletopObject),e?e.color:"#555555"}get cardFontSize(){let e=null;return this.tabletopObject instanceof Gn?e=this.tabletopObject.topCard:this.tabletopObject instanceof On&&(e=this.tabletopObject),e?e.fontsize+9:18}get cardText(){let e=null;return this.tabletopObject instanceof Gn?e=this.tabletopObject.topCard:this.tabletopObject instanceof On&&(e=this.tabletopObject),e?et.rubyToHtml(et.escapeHtml(e.text)):""}get cardTextShadowCss(){const e=et.textShadowColor(this.cardColor);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}get rangeElms(){let e=[];return!this.tabletopObject||!(this.tabletopObject instanceof ni)||!this.tabletopObject.commonDataElement||(this.tabletopObject.commonDataElement.getFirstElementByName("length")&&e.push(this.tabletopObject.commonDataElement.getFirstElementByName("length")),("CORN"===this.tabletopObject.type||"LINE"===this.tabletopObject.type)&&this.tabletopObject.commonDataElement.getFirstElementByName("width")&&e.push(this.tabletopObject.commonDataElement.getFirstElementByName("width")),this.tabletopObject.commonDataElement.getFirstElementByName("opacity")&&e.push(this.tabletopObject.commonDataElement.getFirstElementByName("opacity"))),e}get isNoLogging(){return this.tabletopObject instanceof On?!this.tabletopObject.isFront:this.tabletopObject instanceof or&&this.tabletopObject.hasOwner}get isSelected(){return this.textAreaElementRef&&document.activeElement===this.textAreaElementRef.nativeElement}adjustedRubiedNote(e,i=!0){if(!e)return"";let r=et.escapeHtml(e);return i&&(r=et.rubyToHtml(r)),r.lastIndexOf("\n")==r.length-1?r+"\n":r}textAreaActivate(){this.textAreaElementRef&&this.textAreaElementRef.nativeElement&&this.textAreaElementRef.nativeElement.focus()}}return n.\u0275fac=function(e){return new(e||n)(Le(_1),Le(Di),Le(ai),Le(kn))},n.\u0275cmp=Zt({type:n,selectors:[["overview-panel"]],viewQuery:function(e,i){if(1&e&&(on(hQ,7),on(pQ,5),on(gQ,5),on(mQ,5)),2&e){let r;sn(r=an())&&(i.draggablePanel=r.first),sn(r=an())&&(i.cardImageElement=r.first),sn(r=an())&&(i.fullCardImageElement=r.first),sn(r=an())&&(i.textAreaElementRef=r.first)}},inputs:{tabletopObject:"tabletopObject",left:"left",top:"top"},decls:28,vars:10,consts:[["appDraggable","",1,"component","is-pointer-events-none"],["draggablePanel",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngIf"],["overviewCard",""],["overviewNote",""],["overviewCharacter",""],["overviewDiceSymbol",""],["overviewRange",""],["overviewTabletop",""],["dataElement",""],["imageView",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngTemplateOutlet"],[1,"component-content","is-small-size",3,"ngClass"],["style","position: relative;",4,"ngIf"],[1,"component-title","title-background",3,"ngClass"],[1,"component-background"],["class","grid-container-root",4,"ngIf"],[2,"position","relative"],["class","text","style","z-index: 5; top: 8px",3,"width","height","left","ngStyle",4,"ngIf"],["draggable","false",1,"card-image",3,"src","load"],["cardImage",""],[1,"zoom-button",2,"z-index","10",3,"click"],[1,"material-icons"],["class","component-owner position-right-bottom","style","z-index: 10",3,"ngClass",4,"ngIf"],[1,"text",2,"z-index","5","top","8px",3,"ngStyle"],[3,"innerHTML"],[1,"component-owner","position-right-bottom",2,"z-index","10",3,"ngClass"],[1,"owner-tag"],[1,"grid-container-root"],[1,"grid-container"],[4,"ngFor","ngForOf"],[1,"component-content","is-large-size",3,"ngClass"],[1,"component-title","title-background"],[1,"component-background","text-note-container"],[2,"position","relative",3,"mousedown"],[1,"is-fill"],["spellcheck","false",1,"textarea",2,"resize","none",3,"ngModel","ngClass","ngModelChange"],["textArea",""],[1,"note-text",2,"pointer-events","none","position","absolute",3,"innerHTML","ngClass"],[1,"textarea-spacer",2,"pointer-events","none",3,"innerHTML"],[1,"component-content","character-grid-container","is-middle-size"],[1,"title-bg-area","title-background",3,"ngClass"],["class","image-area character-image-box",3,"ngClass",4,"ngIf"],[1,"title-area","component-title",3,"ngClass"],[1,"void-area","is-pointer-events-none"],[1,"dataElm-area","component-background",3,"ngClass"],[1,"image-area","character-image-box",3,"ngClass"],[3,"ngStyle"],[1,"inverser",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"character-image",2,"pointer-events","none",3,"ngClass","src"],[1,"character-image",2,"pointer-events","none",3,"src"],["class","owner-name-area component-owner",3,"ngClass",4,"ngIf"],[1,"owner-name-area","component-owner",3,"ngClass"],["draggable","false",1,"character-image",3,"ngClass","src"],["class","section border","style","padding-top: 2px",4,"ngIf"],[1,"tag",2,"min-width","100px"],[1,"value"],[2,"display","inline-block","width","min-content"],[1,"hidden-spacer",2,"margin-right","2em"],["type","number","step","0.1","size","1",1,"input",2,"width","4em",3,"ngModel","ngModelChange"],[1,"section",2,"line-height","1em"],["type","range","max","12","step","0.5",3,"title","min","ngModel","ngModelChange"],["type","number","size","1",1,"input",2,"width","4em",3,"ngModel","ngModelChange"],[1,"move",2,"font-size","small"],["type","range","min","0","max","100",3,"title","ngModel","ngModelChange"],[1,"tag"],[1,"value",2,"margin-top","3px","pointer-events","none"],[1,"inverser",2,"min-width","32px","min-height","32px","max-width","32px","max-height","32px","margin-left","auto","margin-right","0px",3,"ngClass"],[1,"aura-following",3,"ngClass"],["draggable","false",1,"character-image",2,"pointer-events","none",3,"ngClass","src"],[1,"section","border",2,"padding-top","2px"],[4,"ngIf","ngIfThen","ngIfElse"],["thenBlock",""],["elseBlock",""],[1,"section",2,"padding-top","0.5em"],["class","section-text",4,"ngIf"],[1,"grid-container","indetnt"],[1,"section-text"],[1,"section","border"],[1,"section"],[1,"note",2,"position","relative"],["spellcheck","false",1,"textarea",3,"ngModel","ngModelChange"],[1,"textarea-spacer"],[1,"hidden-spacer"],["appLogging","","size","1",1,"input",2,"width","4em",3,"logging.name","logging.dataElement","logging.disable","type","ngModel","ngModelChange"],["appLogging","","type","number","size","1",1,"input",2,"width","4em",3,"logging.name","logging.dataElement","logging.disable","ngModel","ngModelChange"],[2,"display","inline"],["appLogging","","type","range","min","0",3,"logging.name","logging.dataElement","logging.disable","title","max","ngModel","ngModelChange"],["appLogging","","type","checkbox",2,"width","2em","margin-right","1em",3,"logging.name","logging.dataElement","logging.disable","ngModel","checked","ngModelChange","change"],["style","font-size: smaller;",4,"ngIf"],[2,"font-size","smaller"],["type","url","size","1",1,"input",2,"width","calc(8em - 1.6rem)",3,"ngModel","ngModelChange"],[1,"link",2,"width","1.6rem",3,"click"],[1,"material-icons",2,"font-size","1.0rem"],["class","tag",4,"ngIf"],["class","hidden-spacer",4,"ngIf"],["size","1",1,"input",3,"ngStyle","type","min","ngModel","ngModelChange"],[1,"image-view-background","is-fill",3,"click"],["class","text","style","z-index: 5",3,"width","height","left","top","ngStyle",4,"ngIf"],[1,"close-button","is-pointer-events-none",2,"z-index","10"],["draggable","false",1,"contain-image",3,"src"],["fullCardImage",""],[1,"text",2,"z-index","5",3,"ngStyle"]],template:function(e,i){1&e&&(K(0,"div",0,1),Ve(2,2),xe(3,_Q,1,0,"ng-container",3),xe(4,vQ,2,4,"ng-container",3),xe(5,yQ,2,4,"ng-container",3),xe(6,wQ,2,4,"ng-container",3),xe(7,IQ,2,4,"ng-container",3),xe(8,kQ,2,4,"ng-container",3),xe(9,PQ,2,4,"ng-container",3),xe(10,OQ,2,4,"ng-container",4),Ge(),J(),xe(11,BQ,2,1,"ng-container",5),xe(12,KQ,8,12,"ng-template",null,6,Ln),xe(14,XQ,12,20,"ng-template",null,7,Ln),xe(16,aJ,8,15,"ng-template",null,8,Ln),xe(18,$J,11,18,"ng-template",null,9,Ln),xe(20,SJ,7,14,"ng-template",null,10,Ln),xe(22,AJ,9,14,"ng-template",null,11,Ln),xe(24,ZJ,5,3,"ng-template",null,12,Ln),xe(26,QJ,8,6,"ng-template",null,13,Ln)),2&e&&(te("@fadeInOut","in"),U(2),te("ngSwitch",i.tabletopObject.aliasName),U(1),te("ngSwitchCase","numberResource"),U(1),te("ngSwitchCase","card"),U(1),te("ngSwitchCase","card-stack"),U(1),te("ngSwitchCase","text-note"),U(1),te("ngSwitchCase","character"),U(1),te("ngSwitchCase","dice-symbol"),U(1),te("ngSwitchCase","range"),U(2),te("ngIf",i.isOpenImageView))},directives:[U0,xl,Cd,wl,xd,_n,Wn,Zi,ei,fi,hi,oi,gs,ms,Vs,Jr],pipes:[ti],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;max-height:100%;max-width:100%;box-sizing:border-box;overflow:visible;color:#444;z-index:9000;overscroll-behavior:contain;-webkit-overflow-scrolling:touch;cursor:-webkit-grab;cursor:grab}.component-content[_ngcontent-%COMP%]{font-size:12px}.is-large-size[_ngcontent-%COMP%]{max-width:350px}.is-middle-size[_ngcontent-%COMP%]{max-width:270px}.is-small-size[_ngcontent-%COMP%]{max-width:250px}.is-middle-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:270px}.is-small-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:250px}.component-background[_ngcontent-%COMP%]{background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border-bottom:solid 1px #999}.component-title[_ngcontent-%COMP%]{color:#ccc;font-size:1em;text-align:right;vertical-align:middle;height:32px;line-height:32px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 1em}.title-background[_ngcontent-%COMP%]{background-color:#555;border-top:solid 1px #999;border-left:solid 1px #999;border-right:solid 1px #999}.component-owner[_ngcontent-%COMP%]{font-size:.8em;color:#ccc;vertical-align:middle;overflow:hidden;text-align:right;padding:2px 1em;max-width:100%;box-sizing:border-box}.owner-tag[_ngcontent-%COMP%]{width:-webkit-min-content;width:-moz-min-content;width:min-content;max-width:100%;margin-left:auto;margin-right:0;overflow:hidden;color:#f5f5f5;background-color:#1e1e1e;box-sizing:border-box;padding:3px 9px;border-radius:6px;white-space:nowrap;text-overflow:ellipsis;opacity:.9}.card-image[_ngcontent-%COMP%]{width:250px;max-height:330px;padding:8px;vertical-align:bottom;-o-object-fit:contain;object-fit:contain;box-sizing:border-box;background-color:#cccccc80}.zoom-button[_ngcontent-%COMP%]{position:absolute;left:8px;bottom:-21px;width:42px;height:42px;border-radius:100px;padding:4px}.zoom-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:24px;vertical-align:bottom}.position-right-bottom[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0}.image-view-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1e4d;z-index:9900}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{position:absolute;right:16px;top:16px}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:36px}.contain-image[_ngcontent-%COMP%]{width:100%;height:100%;box-sizing:border-box;padding:16px;vertical-align:bottom;-o-object-fit:contain;object-fit:contain}.text-note-container[_ngcontent-%COMP%]{width:100%;max-height:400px;padding:.6em 1.2em;box-sizing:border-box;overflow:hidden auto;line-height:1.8;border-left:solid 1px #999;border-right:solid 1px #999}.character-image-box[_ngcontent-%COMP%]{width:100px;vertical-align:bottom;margin-left:.5em;margin-bottom:-6px;z-index:1;overflow:visible}.character-image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:150px;vertical-align:bottom;-o-object-fit:contain;object-fit:contain;-o-object-position:bottom center;object-position:bottom center}.character-image-box.has-icon[_ngcontent-%COMP%]{width:100px;height:100px;max-width:100px;max-height:100px;transform:translateY(-16px);margin-top:16px}.character-image-box.has-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:1em}.character-image[_ngcontent-%COMP%]{padding:0;width:100%;vertical-align:bottom}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.character-grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:-webkit-min-content auto;grid-template-columns:min-content auto;grid-template-rows:1fr auto auto auto}.title-bg-area[_ngcontent-%COMP%]{grid-area:3 / 1 / 4 / 3}.title-area[_ngcontent-%COMP%]{grid-area:3 / 2 / 4 / 3}.owner-name-area[_ngcontent-%COMP%]{grid-area:2 / 2 / 3 / 3}.image-area[_ngcontent-%COMP%]{grid-area:1 / 1 / 4 / 2}.void-area[_ngcontent-%COMP%]{grid-area:1 / 2 / 3 / 3}.dataElm-area[_ngcontent-%COMP%]{grid-area:4 / 1 / 5 / 3}.grid-container-root[_ngcontent-%COMP%]{padding:.5em 1.2em;max-height:250px;overflow:hidden auto;box-sizing:border-box;border-left:solid 1px #999;border-right:solid 1px #999}.grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr fit-content(80%)}.grid-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{box-sizing:border-box;line-height:24px}.indetnt[_ngcontent-%COMP%]{padding-left:.5em}.section[_ngcontent-%COMP%]{max-width:100%;grid-column:1 / span 2}.section-text[_ngcontent-%COMP%]{font-size:1.1em;font-weight:700;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.note[_ngcontent-%COMP%]{margin-left:.5em;font-size:1em;line-height:1.8}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box;resize:none;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.textarea[_ngcontent-%COMP%]:hover{background:#EEE}.textarea[_ngcontent-%COMP%]:focus{background:#FFF}.tag[_ngcontent-%COMP%]{padding-right:1em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;min-width:7em}.value[_ngcontent-%COMP%]{font-size:1.2em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;text-align:right}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0px;min-width:3em;overflow:hidden;white-space:pre-wrap}.textarea-spacer[_ngcontent-%COMP%]{visibility:hidden;min-width:3em;height:auto;min-height:24px;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.input[_ngcontent-%COMP%]{min-width:3em;text-align:right;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#EEE}.input[_ngcontent-%COMP%]:focus{background:#FFF}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}.border[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.separator[_ngcontent-%COMP%]{padding:2px 0;border-bottom:1px solid #888}.with-button-marign[_ngcontent-%COMP%]{padding-left:60px}.is-fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0}.is-bold[_ngcontent-%COMP%]{font-weight:700}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #fff)}.aura-following.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px black)}.aura-following.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #33f)}.aura-following.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3f3)}.aura-following.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3ff)}.aura-following.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f00)}.aura-following.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f0f)}.aura-following.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #ff3)}.aura-following.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #fff)}button.link[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}button.link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button.link[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}button.link[_ngcontent-%COMP%]:disabled{color:gray}button.link[_ngcontent-%COMP%]:disabled:hover{background-color:transparent}.text[_ngcontent-%COMP%]{transform-origin:left top;position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.hide-area[_ngcontent-%COMP%]{overflow:hidden!important;font-size:0pt!important;width:0px!important;height:0px!important;margin:0!important;padding:0!important;border:0px none!important}.note-text[_ngcontent-%COMP%]{color:#444;min-width:3em;height:auto;min-height:24px;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.hide-text-area[_ngcontent-%COMP%]{color:transparent}input[_ngcontent-%COMP%] + .move[_ngcontent-%COMP%]{display:inline-block;transform:translate(-1em);transition:transform 18ms}input[_ngcontent-%COMP%]:hover + .move[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:active + .move[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:focus + .move[_ngcontent-%COMP%]{display:inline-block;transform:translate(0);transition:transform 18ms}@supports (-moz-user-select: -moz-none){input[_ngcontent-%COMP%] + .move[_ngcontent-%COMP%]{transform:translate(0)}}"],data:{animation:[xn("fadeInOut",[Bt("void => *",[Ft("100ms ease-out",nn([Ye({opacity:0,offset:0}),Ye({opacity:1,offset:1})]))]),Bt("* => void",[Ft("100ms ease-in",nn([Ye({opacity:1,offset:0}),Ye({opacity:0,offset:1})]))])])]},changeDetection:0}),n})(),fS=(()=>{class n{constructor(e,i,r){this.ngZone=e,this.viewContainerRef=i,this.pointerDeviceService=r,this.callbackOnMouseEnter=s=>this.onMouseEnter(s),this.callbackOnMouseLeave=s=>this.onMouseLeave(s),this.callbackOnMouseDown=s=>this.onMouseDown(s)}ngOnInit(){}ngAfterViewInit(){this.addEventListeners(this.viewContainerRef.element.nativeElement)}ngOnDestroy(){this.removeEventListeners(this.viewContainerRef.element.nativeElement),this.clearTimer(),this.close()}onMouseEnter(e){this.clearTimer(),this.tooltipComponentRef||this.startOpenTimer()}onMouseLeave(e){this.clearTimer(),this.tooltipComponentRef&&this.startCloseTimer()}onMouseDown(e){!this.tooltipComponentRef||!this.tooltipComponentRef.location.nativeElement.contains(e.target)&&!this.viewContainerRef.element.nativeElement.contains(e.target)&&this.ngZone.run(()=>this.closeAll())}startOpenTimer(){let e=this.pointerDeviceService.pointerX,i=this.pointerDeviceService.pointerY;this.openTooltipTimer=setTimeout(()=>{this.openTooltipTimer=null,4<(e-this.pointerDeviceService.pointerX)**2+(i-this.pointerDeviceService.pointerY)**2?this.startOpenTimer():this.ngZone.run(()=>this.open())},100)}startCloseTimer(){this.closeTooltipTimer=setTimeout(()=>{this.closeTooltipTimer=null,this.tooltipComponentRef&&this.tooltipComponentRef.location.nativeElement.contains(document.activeElement)?this.startCloseTimer():this.ngZone.run(()=>this.closeAll())},400)}clearTimer(){this.closeTooltipTimer&&clearTimeout(this.closeTooltipTimer),this.openTooltipTimer&&clearTimeout(this.openTooltipTimer),this.closeTooltipTimer=this.openTooltipTimer=null}open(){if(this.closeAll(),this.pointerDeviceService.isDragging)return;let e=sr.defaultParentViewContainerRef;this.tooltipComponentRef=e.createComponent(JJ,{index:e.length,injector:e.injector}),this.tooltipComponentRef.instance.tabletopObject=this.tabletopObject,this.tooltipComponentRef.instance.left=this.pointerDeviceService.pointerX,this.tooltipComponentRef.instance.top=this.pointerDeviceService.pointerY,this.addEventListeners(this.tooltipComponentRef.location.nativeElement),this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.addEventListener("mousedown",this.callbackOnMouseDown,!0)}),Fe.register(this).on("DELETE_GAME_OBJECT",i=>{this.tabletopObject&&this.tabletopObject.identifier===i.data.identifier&&this.closeAll()}),this.tooltipComponentRef.onDestroy(()=>{this.removeEventListeners(this.tooltipComponentRef.location.nativeElement),document.body.removeEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.removeEventListener("mousedown",this.callbackOnMouseDown,!0),this.clearTimer(),this.tooltipComponentRef=null,Fe.unregister(this)}),n.activeTooltips.push(this.tooltipComponentRef)}close(){if(!this.tooltipComponentRef)return;let e=n.activeTooltips.indexOf(this.tooltipComponentRef);0<=e&&n.activeTooltips.splice(e,1),this.tooltipComponentRef.destroy(),this.tooltipComponentRef=null}closeAll(){n.activeTooltips.forEach(e=>e.destroy()),n.activeTooltips=[],this.close()}addEventListeners(e){this.ngZone.runOutsideAngular(()=>{e.addEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.addEventListener("mouseleave",this.callbackOnMouseLeave,!1)})}removeEventListeners(e){e.removeEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.removeEventListener("mouseleave",this.callbackOnMouseLeave,!1)}}return n.activeTooltips=[],n.\u0275fac=function(e){return new(e||n)(Le(vn),Le(Rr),Le(ai))},n.\u0275dir=Xt({type:n,selectors:[["","appTooltip",""]],inputs:{tabletopObject:["appTooltip","tabletopObject"]}}),n})();function eee(n,t){if(1&n&&(it(0,"img",9),Ct(1,"safe")),2&n){const e=ge();Ke("mix-blend-mode",1==e.blendType?null:"hard-light"),te("src",xt(1,3,e.imageFile.url,"resourceUrl"),Jt)}}const tee=function(n){return{transform:n}};function nee(n,t){if(1&n&&(K(0,"div",10)(1,"div",11)(2,"span",12),be(3),J(),K(4,"span",13),be(5),J()()()),2&n){const e=ge();Ke("height",e.math.abs(e.gameTableMaskAltitude*e.gridSize),"px"),te("ngStyle",ut(5,tee,"translateX("+e.width*e.gridSize/2+"px) translateY("+-e.height*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),U(3),qe(e.math.abs(e.gameTableMaskAltitude)),U(2),qe(e.gameTableMaskAltitude)}}const iee=function(n){return{"is-grab":n}},y1=function(n){return{fall:n}},hS=function(n){return{transform:n}},ree=function(n){return{"is-inverse":n}},see=function(n,t){return{"border-width":n,transform:t}},oee=function(n){return{image:n}};let aee=(()=>{class n{constructor(e,i,r,s,o,c,m,I,Z){this.ngZone=e,this.tabletopActionService=i,this.contextMenuService=r,this.elementRef=s,this.panelService=o,this.changeDetector=c,this.pointerDeviceService=m,this.modalService=I,this.coordinateService=Z,this.gameTableMask=null,this.is3D=!1,this.gridSize=50,this.math=Math,this.viewRotateZ=10,this.movableOption={},this.input=null}get name(){return this.gameTableMask.name}get width(){return this.adjustMinBounds(this.gameTableMask.width)}get height(){return this.adjustMinBounds(this.gameTableMask.height)}get opacity(){return this.gameTableMask.opacity}get imageFile(){return this.gameTableMask.imageFile}get isLock(){return this.gameTableMask.isLock}set isLock(e){this.gameTableMask.isLock=e}get blendType(){return this.gameTableMask.blendType}set blendType(e){this.gameTableMask.blendType=e}get fontSize(){return this.gameTableMask.fontsize}set fontSize(e){this.gameTableMask.fontsize=e}get text(){return this.gameTableMask.text}set text(e){this.gameTableMask.text=e}get color(){return this.gameTableMask.color}set color(e){this.gameTableMask.color=e}get bgcolor(){return this.gameTableMask.bgcolor}set bgcolor(e){this.gameTableMask.bgcolor=e}get textShadowCss(){const e=et.textShadowColor(this.color);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}get altitude(){return this.gameTableMask.altitude}set altitude(e){this.gameTableMask.altitude=e}get isAltitudeIndicate(){return this.gameTableMask.isAltitudeIndicate}set isAltitudeIndicate(e){this.gameTableMask.isAltitudeIndicate=e}get gameTableMaskAltitude(){return+this.altitude.toFixed(1)}get rubiedText(){return et.rubyToHtml(et.escapeHtml(this.text))}get isInverse(){return 90<Math.abs(this.viewRotateZ)%360&&Math.abs(this.viewRotateZ)%360<270}get isGMMode(){return this.gameTableMask.isGMMode}ngOnInit(){Fe.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=lt.instance.get(e.data.identifier);!this.gameTableMask||!i||(this.gameTableMask===i||i instanceof zn&&this.gameTableMask.contains(i))&&this.changeDetector.markForCheck()}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.gameTableMask,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new Ls(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this.input.destroy(),Fe.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLock&&Fe.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate();this.contextMenuService.open(i,[this.isGMMode?this.gameTableMask.isTransparentOnGMMode?{name:"\u2611 GM\u30e2\u30fc\u30c9\u6642\u900f\u904e",action:()=>{this.gameTableMask.isTransparentOnGMMode=!1,dt.play(Ze.lock)}}:{name:"\u2610 GM\u30e2\u30fc\u30c9\u6642\u900f\u904e",action:()=>{this.gameTableMask.isTransparentOnGMMode=!0,dt.play(Ze.unlock)}}:null,this.isGMMode?Tt:null,this.isLock?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLock=!1,dt.play(Ze.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLock=!0,dt.play(Ze.lock)}},{name:"\u753b\u50cf\u3068\u8272",subActions:[{name:(0==this.blendType?"\u25c9":"\u25cb")+" \u753b\u50cf\u306e\u307f",action:()=>{this.blendType=0,dt.play(Ze.cardDraw)}},{name:(1==this.blendType?"\u25c9":"\u25cb")+" \u80cc\u666f\u8272\u3068\u91cd\u306d\u308b",action:()=>{this.blendType=1,dt.play(Ze.cardDraw)}},{name:(2==this.blendType?"\u25c9":"\u25cb")+" \u80cc\u666f\u8272\u3068\u6df7\u305c\u308b",action:()=>{this.blendType=2,dt.play(Ze.cardDraw)}},Tt,{name:"\u8272\u306e\u521d\u671f\u5316",action:()=>{this.color="#555555",this.bgcolor="#0a0a0a",dt.play(Ze.cardDraw)}}]},Tt,this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0}},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,dt.play(Ze.sweep))},altitudeHande:this.gameTableMask},Tt,{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.gameTableMask)}},this.gameTableMask.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.gameTableMask.getUrls().map(s=>{const o=s.value.toString();return{name:s.name?s.name:o,action:()=>{et.sameOrigin(o)?window.open(o.trim(),"_blank","noopener"):this.modalService.open(Hr,{url:o,title:this.gameTableMask.name,subTitle:s.name})},disabled:!et.validUrl(o),error:et.validUrl(o)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:et.validUrl(o)&&!et.sameOrigin(o)}})},this.gameTableMask.getUrls().length<=0?null:Tt,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let s=this.gameTableMask.clone();console.log("\u30b3\u30d4\u30fc",s),s.location.x+=this.gridSize,s.location.y+=this.gridSize,s.isLock=!1,this.gameTableMask.parent&&this.gameTableMask.parent.appendChild(s),dt.play(Ze.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.gameTableMask.destroy(),dt.play(Ze.sweep)}},Tt,{name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(r)}],this.name)}onMove(){dt.play(Ze.cardPick)}onMoved(){dt.play(Ze.cardPut)}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u30de\u30c3\u30d7\u30de\u30b9\u30af\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Gs,{title:r,left:i.x-200,top:i.y-150,width:400,height:530}).tabletopObject=e}}return n.\u0275fac=function(e){return new(e||n)(Le(vn),Le(mg),Le(sr),Le(_i),Le(In),Le(Di),Le(ai),Le(kn),Le(Ja))},n.\u0275cmp=Zt({type:n,selectors:[["game-table-mask"]],hostBindings:function(e,i){1&e&&Te("dragstart",function(s){return i.onDragstart(s)})("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{gameTableMask:"gameTableMask",is3D:"is3D"},decls:10,vars:52,consts:[["appMovable","",1,"component","is-3d",2,"pointer-events","none",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],[1,"is-3d","text",2,"left","2px","top","2px","backface-visibility","hidden",3,"ngClass","ngStyle"],[1,"is-3d",2,"z-index","5","pointer-events","none",3,"ngClass","innerHtml"],[1,"border","is-fit-full",2,"backface-visibility","hidden",3,"ngClass","ngStyle"],[1,"is-fit-full","is-3d","chrome-smooth-image-trick",2,"pointer-events","auto",3,"ngClass"],["class","is-fit-full is-3d chrome-smooth-image-trick","style","pointer-events: none; position: absolute;",3,"mix-blend-mode","src",4,"ngIf"],[1,"lock-icon","is-center","is-3d",2,"pointer-events","none","z-index","10",3,"ngClass","ngStyle"],[1,"material-icons","is-3d",2,"pointer-events","none","backface-visibility","hidden"],["class","is-3d","style","display: flex; align-items: center; border-left: 2px dashed blanchedalmond; transform-origin: top left; pointer-events: none",3,"height","ngStyle",4,"ngIf"],[1,"is-fit-full","is-3d","chrome-smooth-image-trick",2,"pointer-events","none","position","absolute",3,"src"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","transform-origin","top left","pointer-events","none",3,"ngStyle"],[1,"is-3d",2,"pointer-events","none"],[1,"altitude-indicator","is-3d",2,"position","absolute","pointer-events","none"],[1,"altitude-indicator","is-3d",2,"position","absolute","pointer-events","none","transform","rotateY(-180deg)"]],template:function(e,i){1&e&&(K(0,"div",0),Te("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),K(1,"div",1),it(2,"div",2),J(),K(3,"div",3)(4,"div",4),xe(5,eee,2,6,"img",5),J()(),K(6,"div",6)(7,"i",7),be(8),J()(),xe(9,nee,6,7,"div",8),J()),2&e&&(Ke("width",i.width*i.gridSize,"px")("height",i.height*i.gridSize,"px"),te("ngClass",ut(33,iee,!i.isLock))("movable.option",i.movableOption)("movable.disable",i.isLock),U(1),Ke("width",i.width*i.gridSize-4,"px")("height",i.height*i.gridSize-4,"px"),te("ngClass",ut(35,y1,0==i.altitude))("ngStyle",ut(37,hS,"translateZ("+i.altitude*i.gridSize+"px)")),U(1),Ke("font-size",i.fontSize+9,"px")("color",i.color)("text-shadow",i.textShadowCss),te("ngClass",ut(39,ree,i.isInverse))("innerHtml",i.rubiedText,qi),U(1),te("ngClass",ut(41,y1,0==i.altitude))("ngStyle",Kt(43,see,i.isLock?"0px":"2px","translateZ("+i.altitude*i.gridSize+"px)")),U(1),Ke("opacity",i.opacity*(i.isGMMode&&i.gameTableMask.isTransparentOnGMMode?.6:1))("background-color",i.imageFile.url.length<1||i.blendType>0?i.bgcolor:null),te("ngClass",ut(46,oee,i.imageFile.url.length>=1)),U(1),te("ngIf",i.imageFile.url.length>=1),U(1),te("ngClass",ut(48,y1,0==i.altitude))("ngStyle",ut(50,hS,"translateZ("+i.altitude*i.gridSize+"px)")),U(2),qe(i.isLock?"lock":"open_with"),U(1),te("ngIf",i.isAltitudeIndicate&&i.math.abs(i.gameTableMaskAltitude)>=.5))},directives:[il,Wn,Zi,_n],pipes:[ti],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.image[_ngcontent-%COMP%]{display:block;box-sizing:border-box}.lock-icon[_ngcontent-%COMP%]{background-color:#ccc;border-radius:100%;color:#444;width:25px;height:25px;visibility:hidden}.component[_ngcontent-%COMP%]:hover   .lock-icon[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .lock-icon[_ngcontent-%COMP%]{visibility:visible}.is-center[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0;margin:auto}.border[_ngcontent-%COMP%]{box-sizing:border-box;border:2px solid transparent}.image.border[_ngcontent-%COMP%]{border-width:0px}.component[_ngcontent-%COMP%]:hover   .border[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .border[_ngcontent-%COMP%], .is-grab[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{border:2px solid #cccccc!important}.is-fit-full[_ngcontent-%COMP%]{height:100%;width:100%}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.fall[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.text[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.is-inverse[_ngcontent-%COMP%]{transform:rotate(180deg)}"],changeDetection:0}),n})();const lee=["textArea"];function cee(n,t){if(1&n&&(K(0,"div",20),be(1),J()),2&n){const e=ge();U(1),qe(e.title)}}function uee(n,t){if(1&n&&(K(0,"div",20),be(1),J()),2&n){const e=ge();U(1),qe(e.title)}}const dee=function(n){return{"is-grab":n}},C1=function(n){return{transform:n}};function fee(n,t){if(1&n&&it(0,"div",21),2&n){const e=ge();Ke("width",(e.width-1)*e.gridSize,"px")("min-height",e.gridSize/2,"px"),te("ngClass",ut(6,dee,!e.isLocked))("ngStyle",ut(8,C1,"translateX("+e.gridSize/2+"px) translateY("+-e.gridSize/4+"px)"))}}function hee(n,t){1&n&&(K(0,"div")(1,"div",15)(2,"i",16),be(3,"autorenew"),J()(),K(4,"div",17)(5,"i",16),be(6,"autorenew"),J()()())}const pee=function(n){return{transform:n}};function gee(n,t){if(1&n&&(K(0,"div",22)(1,"div",23)(2,"span",24),be(3),J(),K(4,"span",25),be(5),J()()()),2&n){const e=ge();Ke("height",e.math.abs(e.textNoteAltitude*e.gridSize),"px"),te("ngStyle",ut(5,pee,"rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),U(3),qe(e.math.abs(e.textNoteAltitude)),U(2),qe(e.textNoteAltitude)}}const mee=function(n,t){return{"is-transition":n,fall:t}},pS=function(n){return{"is-bg-filter":n}},_ee=function(n,t,e){return{"is-pointer-events-none":n,"is-pointer-events-auto":t,"hide-area":e}},$ee=function(n){return{"hide-area":n}};let vee=(()=>{class n{constructor(e,i,r,s,o,c,m){this.ngZone=e,this.contextMenuService=i,this.elementRef=r,this.panelService=s,this.changeDetector=o,this.pointerDeviceService=c,this.modalService=m,this.textNote=null,this.is3D=!1,this.callbackOnMouseUp=I=>this.onMouseUp(I),this.gridSize=50,this.math=Math,this._transitionTimeout=null,this._transition=!1,this._fallTimeout=null,this._fall=!1,this.calcFitHeightTimer=null,this.movableOption={},this.rotableOption={},this.viewRotateZ=10,this.input=null}get title(){return this.textNote.title}get text(){return this.calcFitHeightIfNeeded(),this.textNote.text}set text(e){this.calcFitHeightIfNeeded(),this.textNote.text=e}get color(){return this.textNote.color}set color(e){this.textNote.color=e}get textShadowCss(){const e=et.textShadowColor(this.color,"#f2f2f2","#000000");return`${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px,\n    ${e} 0px 0px 0.5px,\n    ${e} 0px 0px 0.5px`}get fontSize(){return this.calcFitHeightIfNeeded(),this.textNote.fontSize}get imageFile(){return this.textNote.imageFile}get rotate(){return this.textNote.rotate}set rotate(e){this.textNote.rotate=e}get height(){return this.adjustMinBounds(this.textNote.height)}get width(){return this.adjustMinBounds(this.textNote.width)}get altitude(){return this.textNote.altitude}set altitude(e){this.textNote.altitude=e}get textNoteAltitude(){let e=this.altitude;if(this.isUpright&&this.altitude<0){if(-this.height<=this.altitude)return 0;e+=this.height}return+e.toFixed(1)}get isUpright(){return this.textNote.isUpright}set isUpright(e){this.textNote.isUpright=e}get isAltitudeIndicate(){return this.textNote.isAltitudeIndicate}set isAltitudeIndicate(e){this.textNote.isAltitudeIndicate=e}get isLocked(){return this.textNote.isLocked}set isLocked(e){this.textNote.isLocked=e}get isWhiteOut(){return this.textNote.isWhiteOut}set isWhiteOut(e){this.textNote.isWhiteOut=e}get isSelected(){return document.activeElement===this.textAreaElementRef.nativeElement}get rubiedText(){return et.rubyToHtml(et.escapeHtml(this.text))}get transition(){return this._transition}set transition(e){this._transition=e,this._transitionTimeout&&clearTimeout(this._transitionTimeout),this._transitionTimeout=e?setTimeout(()=>{this._transition=!1},132):null}get fall(){return this._fall}set fall(e){this._fall=e,this._fallTimeout&&clearTimeout(this._fallTimeout),this._fallTimeout=e?setTimeout(()=>{this._fall=!1},132):null}ngOnInit(){Fe.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=lt.instance.get(e.data.identifier);!this.textNote||!i||(this.textNote===i||i instanceof zn&&this.textNote.contains(i))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.textNote,transformCssOffset:"translateZ(0.17px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.textNote}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new Ls(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this._transitionTimeout&&clearTimeout(this._transitionTimeout),this._fallTimeout&&clearTimeout(this._fallTimeout),Fe.unregister(this)}onInputStart(e){this.input.cancel(),this.textNote.isLocked&&Fe.trigger("DRAG_LOCKED_OBJECT",{})}onDragstart(e){e.stopPropagation(),e.preventDefault()}onMouseDown(e){if(!this.isSelected){if(e.preventDefault(),this.textNote.toTopmost(),2===e.button)return void Fe.trigger("DRAG_LOCKED_OBJECT",{});this.addMouseEventListeners()}}onMouseUp(e){if(this.pointerDeviceService.isAllowedToOpenContextMenu){let i=window.getSelection();i.isCollapsed||i.removeAllRanges(),this.textAreaElementRef.nativeElement.focus()}this.removeMouseEventListeners(),e.preventDefault()}onRotateMouseDown(e){e.stopPropagation(),e.preventDefault()}onContextMenu(e){this.removeMouseEventListeners(),!this.isSelected&&(e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu)&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,dt.play(Ze.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,dt.play(Ze.lock)}},Tt,this.isUpright?{name:"\u2611 \u76f4\u7acb",action:()=>{this.transition=!0,this.isUpright=!1}}:{name:"\u2610 \u76f4\u7acb",action:()=>{this.transition=!0,this.isUpright=!0}},this.isWhiteOut?{name:"\u2611 \u753b\u50cf\u306e\u8272\u629c\u304d",action:()=>{this.isWhiteOut=!1}}:{name:"\u2610 \u753b\u50cf\u306e\u8272\u629c\u304d",action:()=>{this.isWhiteOut=!0}},Tt,this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0}},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.isUpright?this.fall=!0:this.transition=!0,this.altitude=0,dt.play(Ze.sweep))},altitudeHande:this.textNote},Tt,{name:"\u30e1\u30e2\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.textNote)}},this.textNote.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.textNote.getUrls().map(r=>{const s=r.value.toString();return{name:r.name?r.name:s,action:()=>{et.sameOrigin(s)?window.open(s.trim(),"_blank","noopener"):this.modalService.open(Hr,{url:s,title:this.textNote.title,subTitle:r.name})},disabled:!et.validUrl(s),error:et.validUrl(s)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:et.validUrl(s)&&!et.sameOrigin(s)}})},this.textNote.getUrls().length<=0?null:Tt,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.textNote.clone();r.isLocked=!1,console.log("\u30b3\u30d4\u30fc",r),r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.toTopmost(),dt.play(Ze.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.textNote.destroy(),dt.play(Ze.sweep)}}],this.title)}onMove(){dt.play(Ze.cardPick)}onMoved(){dt.play(Ze.cardPut)}calcFitHeightIfNeeded(){this.calcFitHeightTimer||this.ngZone.runOutsideAngular(()=>{this.calcFitHeightTimer=setTimeout(()=>{this.calcFitHeight(),this.calcFitHeightTimer=null},0)})}calcFitHeight(){let e=this.textAreaElementRef.nativeElement;e.style.height="0",e.scrollHeight>e.offsetHeight&&(e.style.height=e.scrollHeight+"px")}lastNewLineAdjust(e){return null==e?"":this.isSelected||e.lastIndexOf("\n")!=e.length-1?e:e+"\n"}adjustMinBounds(e,i=0){return e<i?i:e}addMouseEventListeners(){document.body.addEventListener("mouseup",this.callbackOnMouseUp,!1)}removeMouseEventListeners(){document.body.removeEventListener("mouseup",this.callbackOnMouseUp,!1)}showDetail(e){Fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5171\u6709\u30e1\u30e2\u8a2d\u5b9a";e.title.length&&(r+=" - "+e.title),this.panelService.open(Gs,{title:r,left:i.x-350,top:i.y-200,width:560,height:470}).tabletopObject=e}}return n.\u0275fac=function(e){return new(e||n)(Le(vn),Le(sr),Le(_i),Le(In),Le(Di),Le(ai),Le(kn))},n.\u0275cmp=Zt({type:n,selectors:[["text-note"]],viewQuery:function(e,i){if(1&e&&on(lee,7),2&e){let r;sn(r=an())&&(i.textAreaElementRef=r.first)}},hostBindings:function(e,i){1&e&&Te("dragstart",function(s){return i.onDragstart(s)})("mousedown",function(s){return i.onMouseDown(s)})("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{textNote:"textNote",is3D:"is3D"},decls:28,vars:77,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.option","movable.disable","movable.ondragstart","movable.ondragend"],["appRotable","",1,"is-3d",3,"rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],[1,"component-content","is-3d","is-pointer-events-auto"],[1,"is-3d",3,"ngClass","ngStyle"],[1,"upright-transform","is-3d","is-bg-color","is-front","is-bg-texture","chrome-smooth-image-trick",3,"ngClass"],["class","title is-3d is-black-background is-pointer-events-none",4,"ngIf"],["spellcheck","false",1,"textarea","is-3d",3,"ngClass","ngModel","input","ngModelChange"],["textArea",""],[1,"is-3d","is-outline-text","note-text",2,"margin-top","-18px",3,"ngClass","innerHTML"],[1,"upright-transform","is-3d","is-back","is-bg-color","is-bg-texture","chrome-smooth-image-trick",3,"ngClass"],[1,"is-3d","is-pointer-events-none",2,"visibility","hidden"],["spellcheck","false","readonly","",1,"textarea","is-3d","hide-area","is-pointer-events-none",3,"ngModel","ngModelChange"],[1,"is-3d","is-outline-text","note-text","is-pointer-events-none",2,"margin-top","-18px",3,"innerHTML"],["class","grand-grabing-area","style","position: absolute",3,"ngClass","ngStyle","width","min-height",4,"ngIf"],[3,"ngStyle"],[1,"rotate-grab","of-left-top"],[1,"material-icons"],[1,"rotate-grab","of-right-top"],[4,"ngIf"],["class","is-3d","style","display: flex; align-items: center; border-left: 2px dashed blanchedalmond; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],[1,"title","is-3d","is-black-background","is-pointer-events-none"],[1,"grand-grabing-area",2,"position","absolute",3,"ngClass","ngStyle"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","transform-origin","top left",3,"ngStyle"],[1,"is-3d"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"]],template:function(e,i){1&e&&(K(0,"div",0),Te("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),K(1,"div",1),Te("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),K(2,"div",2)(3,"div",3)(4,"div",4),Ct(5,"safe"),xe(6,cee,2,1,"div",5),K(7,"textarea",6,7),Te("input",function(){return i.calcFitHeight()})("ngModelChange",function(s){return i.text=s}),J(),it(9,"div",8),Ct(10,"safe"),J(),K(11,"div",9),Ct(12,"safe"),K(13,"div",10),xe(14,uee,2,1,"div",5),K(15,"textarea",11),Te("ngModelChange",function(s){return i.text=s}),J(),it(16,"div",12),Ct(17,"safe"),J()()(),xe(18,fee,1,10,"div",13),K(19,"div",14)(20,"div",15)(21,"i",16),be(22),J()(),K(23,"div",17)(24,"i",16),be(25),J()()(),xe(26,hee,7,0,"div",18),J()(),xe(27,gee,6,7,"div",19),J()),2&e&&(te("movable.option",i.movableOption)("movable.disable",i.isSelected||i.isLocked),U(1),te("rotable.option",i.rotableOption)("rotable.disable",i.isLocked),U(1),Ke("width",i.width*i.gridSize,"px"),U(1),te("ngClass",Kt(60,mee,i.transition,i.fall))("ngStyle",ut(63,C1,"translateZ("+i.altitude*i.gridSize+"px) rotateY(90deg) rotateZ("+(i.isUpright?0:90)+"deg) rotateY(-90deg)")),U(1),Ke("background-image",xt(5,48,"url("+(null==i.imageFile?null:i.imageFile.url)+")","style"))("width",i.width*i.gridSize,"px")("min-height",i.height*i.gridSize,"px"),te("ngClass",ut(65,pS,i.isWhiteOut&&(null==i.imageFile?null:i.imageFile.url.length)>0)),U(2),te("ngIf",i.title.length),U(1),Ke("font-size",i.fontSize+9,"px"),te("ngClass",Zr(67,_ee,!i.isSelected,i.isSelected,!i.isSelected))("ngModel",i.text),U(2),Ke("font-size",i.fontSize+9,"px")("color",i.color)("text-shadow",i.textShadowCss),te("ngClass",ut(71,$ee,i.isSelected))("innerHTML",xt(10,51,i.lastNewLineAdjust(i.rubiedText),"html"),qi),U(2),Ke("background-image",xt(12,54,"url("+(null==i.imageFile?null:i.imageFile.url)+")","style"))("width",i.width*i.gridSize,"px")("min-height",i.height*i.gridSize,"px"),te("ngClass",ut(73,pS,i.isWhiteOut&&(null==i.imageFile?null:i.imageFile.url.length)>0)),U(3),te("ngIf",i.title.length),U(1),Ke("font-size",i.fontSize+9,"px"),te("ngModel",i.text),U(1),Ke("font-size",i.fontSize+9,"px"),te("innerHTML",xt(17,57,i.lastNewLineAdjust(i.rubiedText),"html"),qi),U(2),te("ngIf",!i.isLocked),U(1),te("ngStyle",ut(75,C1,"translateZ("+i.altitude*i.gridSize+"px)")),U(3),qe(i.isLocked?"lock":"autorenew"),U(3),qe(i.isLocked?"lock":"autorenew"),U(1),te("ngIf",!i.isLocked),U(1),te("ngIf",i.isAltitudeIndicate&&i.math.abs(i.textNoteAltitude)>=.5))},directives:[il,Ql,Wn,Zi,_n,fi,hi,oi],pipes:[ti],styles:['[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;width:1px;height:0}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;transform:translate(-50%)}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;-webkit-backface-visibility:hidden;backface-visibility:hidden}.is-front[_ngcontent-%COMP%]{transform-origin:50% 100%;transform:rotateX(-90deg)}.is-back[_ngcontent-%COMP%]{transform-origin:50% 100%;transform:rotateX(-90deg) rotateY(180deg)}.is-bg-texture[_ngcontent-%COMP%]{background-repeat:no-repeat;background-size:100% 100%}.is-bg-filter[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0px;bottom:0px;left:0px;right:0px;background:rgba(255,255,255,.7);transition:background-color .2s}.is-bg-color[_ngcontent-%COMP%]{box-sizing:border-box;color:#444;background-color:#f0dabde6;border:solid 1px #999}.title[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;-webkit-backface-visibility:hidden;backface-visibility:hidden}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;resize:none;overflow:hidden;box-sizing:border-box;background:none;border:none;border-radius:0;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1rem;padding:2px;margin:0;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;-webkit-backface-visibility:hidden;backface-visibility:hidden}.textarea[_ngcontent-%COMP%]:focus{background:rgba(255,255,255,.75)}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.is-outline-text[_ngcontent-%COMP%]{font-size:24px;color:#444;text-shadow:#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:42px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;text-align:center;padding:2px;background-color:#ccc;border-radius:28px;color:#444;font-size:8px}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-21px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-21px}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.fall[_ngcontent-%COMP%]{transition:transform 132ms cubic-bezier(.21,.97,.75,1.25)}.hide-area[_ngcontent-%COMP%]{overflow:hidden!important;font-size:0pt!important;width:0px!important;height:0px!important;margin:0!important;padding:0!important;border:0px none!important}.note-text[_ngcontent-%COMP%]{font-family:Cambria,Georgia;padding:2px;white-space:pre-wrap;-webkit-backface-visibility:hidden;backface-visibility:hidden;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}'],changeDetection:0}),n})();const bee=["cardImage"],yee=function(n){return{transform:n}};let Cee=(()=>{class n{constructor(){this.card=null,this.gridSize=50,this.naturalWidth=0,this.naturalHeight=0}ngOnInit(){}onCardImageLoad(){!this.cardImageElement||(this.naturalWidth=this.cardImageElement.nativeElement.naturalWidth,this.naturalHeight=this.cardImageElement.nativeElement.naturalHeight)}get rubiedText(){return this.card?et.rubyToHtml(et.escapeHtml(this.card.text)):""}get imageAreaRect(){return this.calcImageAreaRect(64,64,0)}calcImageAreaRect(e,i,r){const s={width:0,height:0,top:r,left:r,scale:1};if(0==this.naturalWidth||0==this.naturalHeight)return s;const o=e-2*r,c=i-2*r;return this.naturalHeight*o/this.naturalWidth>c?(s.width=this.naturalWidth*c/this.naturalHeight,s.height=c,s.left=r+(o-s.width)/2):(s.width=o,s.height=this.naturalHeight*o/this.naturalWidth,s.top=r+(c-s.height)/2),this.card&&(s.scale=s.width/(this.card.size*this.gridSize),s.width=this.card.size*this.gridSize,s.height=s.width*this.naturalHeight/this.naturalWidth),s}get cardColor(){return this.card?this.card.color:"#555555"}get cardFontSize(){return this.card?this.card.fontsize+9:18}get cardText(){return this.card?this.card.text:""}get textShadowCss(){const e=et.textShadowColor(this.cardColor);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=Zt({type:n,selectors:[["card-list-image"]],viewQuery:function(e,i){if(1&e&&on(bee,7),2&e){let r;sn(r=an())&&(i.cardImageElement=r.first)}},inputs:{card:"card"},decls:11,vars:30,consts:[[1,"image-box",2,"position","relative",3,"appTooltip"],[1,"text",2,"z-index","5",3,"ngStyle"],[3,"innerHTML"],[1,"image","contain"],[3,"src","load"],["cardImage",""],[3,"src"]],template:function(e,i){1&e&&(K(0,"div",0)(1,"div",1),it(2,"div",2),Ct(3,"safe"),J(),K(4,"div",3)(5,"img",4,5),Te("load",function(){return i.onCardImageLoad()}),Ct(7,"safe"),J()(),K(8,"div",3),it(9,"img",6),Ct(10,"safe"),J()()),2&e&&(te("appTooltip",i.card),U(1),Ke("width",i.imageAreaRect.width,"px")("height",i.imageAreaRect.height,"px")("left",i.imageAreaRect.left,"px")("top",i.imageAreaRect.top,"px"),te("ngStyle",ut(28,yee,"scale("+i.imageAreaRect.scale+")")),U(1),Ke("font-size",i.cardFontSize,"px")("color",i.cardColor)("text-shadow",i.textShadowCss),te("innerHTML",xt(3,19,i.rubiedText,"html"),qi),U(3),te("src",xt(7,22,null==i.card||null==i.card.frontImage?null:i.card.frontImage.url,"resourceUrl"),Jt),U(4),te("src",xt(10,25,null==i.card||null==i.card.backImage?null:i.card.backImage.url,"resourceUrl"),Jt))},directives:[fS,Zi],pipes:[ti],styles:[".image-box[_ngcontent-%COMP%]{display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:64px;height:64px;-o-object-fit:contain;object-fit:contain}.text[_ngcontent-%COMP%]{transform-origin:left top;position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}"]}),n})();function xee(n,t){if(1&n){const e=Xe();K(0,"div",2),it(1,"card-list-image",3),K(2,"div",4)(3,"button",5),Te("click",function(){const s=De(e).$implicit;return ge().drawCard(s)}),be(4,"\u5c71\u672d\u304b\u3089\u51fa\u3059"),J(),K(5,"button",0),Te("click",function(){const s=De(e).$implicit;return ge().showDetail(s)}),K(6,"i",6),be(7,"settings"),J(),be(8,"\u7de8\u96c6"),J(),it(9,"br"),K(10,"button",0),Te("click",function(){const s=De(e).$implicit;return ge().up(s)}),be(11,"\u2191"),J(),K(12,"button",0),Te("click",function(){const s=De(e).$implicit;return ge().down(s)}),be(13,"\u2193"),J(),it(14,"br"),J()()}if(2&n){const e=t.$implicit;U(1),te("card",e)}}let wee=(()=>{class n{constructor(e,i,r){this.panelService=e,this.changeDetector=i,this.chatMessageService=r,this.cardStack=null,this.owner=yt.peerContext.userId}ngOnInit(){Promise.resolve().then(()=>this.panelService.title=this.cardStack.name+" \u306e\u30ab\u30fc\u30c9\u4e00\u89a7"),Fe.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=lt.instance.get(e.data.identifier);!this.cardStack||!i||((this.cardStack===i||i instanceof zn&&this.cardStack.contains(i))&&this.changeDetector.markForCheck(),e.data.identifier===this.cardStack.identifier&&this.cardStack.owner!==this.owner&&this.panelService.close())}).on("DELETE_GAME_OBJECT",e=>{this.cardStack&&this.cardStack.identifier===e.data.identifier&&this.panelService.close()})}ngOnDestroy(){Fe.unregister(this),this.cardStack.owner===this.owner&&(this.cardStack.owner="")}drawCard(e){e.parent.removeChild(e),e.location.x=this.cardStack.location.x+100+50*Math.random(),e.location.y=this.cardStack.location.y+25+50*Math.random(),e.location.name=this.cardStack.location.name,e.rotate+=this.cardStack.rotate,360<e.rotate&&(e.rotate-=360),e.toTopmost(),dt.play(Ze.cardDraw),this.chatMessageService.sendOperationLog(e.isFront?`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${""==e.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":e.name} \u3092\u53d6\u308a\u51fa\u3057\u305f`:`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 1\u679a\u53d6\u308a\u51fa\u3057\u3066\u4f0f\u305b\u305f`)}up(e){let i=e.parent,r=i.children.indexOf(e);0<r&&i.insertBefore(e,i.children[r-1])}down(e){let i=e.parent,r=i.children.indexOf(e);r<i.children.length-1&&i.insertBefore(i.children[r+1],e)}close(e=!1){e&&(this.cardStack.shuffle(),Fe.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier}),dt.play(Ze.cardShuffle)),this.panelService.close()}showDetail(e){let r="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Gs,{title:r,left:this.panelService.left+10,top:this.panelService.top+20,width:600,height:600}).tabletopObject=e}trackByCard(e,i){return i.identifier}}return n.\u0275fac=function(e){return new(e||n)(Le(In),Le(Di),Le(Er))},n.\u0275cmp=Zt({type:n,selectors:[["card-stack-list"]],inputs:{cardStack:"cardStack"},decls:5,vars:2,consts:[[3,"click"],["class","box",4,"ngFor","ngForOf","ngForTrackBy"],[1,"box"],[3,"card"],[2,"display","inline-block"],["type","submit",3,"click"],[1,"material-icons",2,"font-size","1.1em","vertical-align","text-bottom"]],template:function(e,i){1&e&&(K(0,"div")(1,"button",0),Te("click",function(){return i.close(!0)}),be(2,"\u30b7\u30e3\u30c3\u30d5\u30eb\u3057\u3066\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b"),J(),it(3,"hr"),xe(4,xee,15,1,"div",1),J()),2&e&&(U(4),te("ngForOf",i.cardStack.cards)("ngForTrackBy",i.trackByCard))},directives:[ei,Cee],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image-box[_ngcontent-%COMP%]{display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}"],changeDetection:0}),n})();const x1=function(n){return{transform:n}};function Eee(n,t){if(1&n&&(K(0,"div",9),it(1,"div",10),Ct(2,"safe"),J()),2&n){const e=ge(2);te("ngStyle",ut(11,x1,"rotateZ("+e.topCard.rotate+"deg)")),U(1),Ke("font-size",e.topCard.fontsize+9,"px")("color",e.topCard.color)("text-shadow",e.textShadowCss(e.topCard.color)),te("innerHTML",xt(2,8,e.rubiedText,"html"),qi)}}function Tee(n,t){if(1&n){const e=Xe();K(0,"div",6),Te("@shuffle.start",function(r){return De(e),ge().animationShuffleStarted(r)})("@shuffle.done",function(r){return De(e),ge().animationShuffleDone(r)}),xe(1,Eee,3,13,"div",7),it(2,"img",8),Ct(3,"safe"),J()}if(2&n){const e=ge();te("@bounceInOut",void 0)("@shuffle",e.animeState),U(1),te("ngIf",e.topCard.isFront),U(1),te("ngStyle",ut(8,x1,"rotateZ("+e.topCard.rotate+"deg)"))("src",xt(3,5,e.imageFile.url,"resourceUrl"),Jt)}}function Iee(n,t){if(1&n&&(Ve(0),K(1,"div",11)(2,"i",12),be(3),J()(),K(4,"div",13)(5,"i",12),be(6),J()(),K(7,"div",14)(8,"i",12),be(9),J()(),K(10,"div",15)(11,"i",12),be(12),J()(),Ge()),2&n){const e=ge();U(3),qe(e.isLocked?"lock":"autorenew"),U(3),qe(e.isLocked?"lock":"autorenew"),U(3),qe(e.isLocked?"lock":"autorenew"),U(3),qe(e.isLocked?"lock":"autorenew")}}const gS=function(n){return{"is-inverse":n}};function See(n,t){if(1&n&&(K(0,"div",16)(1,"span",17),be(2),J()()),2&n){const e=ge();te("ngStyle",ut(3,x1,"translateY(-50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateZ("+(e.isInverse?180:0)+"deg)")),U(1),te("ngClass",ut(5,gS,e.isInverse)),U(1),An("",e.cards.length,"\u679a")}}const Mee=function(n,t){return{"background-color":n,transform:t}};function kee(n,t){if(1&n&&(K(0,"div",18)(1,"span",17)(2,"b"),be(3),J(),be(4," \u304c\u78ba\u8a8d\u4e2d"),J()()),2&n){const e=ge();te("ngStyle",Kt(3,Mee,e.ownerColor,"translateY(50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateZ("+(e.isInverse?180:0)+"deg)")),U(1),te("ngClass",ut(6,gS,e.isInverse)),U(2),qe(e.ownerName)}}const Dee=function(n){return{"is-empty":n}},Aee=function(n){return{"is-grab":n}};let Pee=(()=>{class n{constructor(e,i,r,s,o,c,m,I,Z){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.elementRef=s,this.changeDetector=o,this.imageService=c,this.pointerDeviceService=m,this.modalService=I,this.chatMessageService=Z,this.cardStack=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.viewRotateZ=10,this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null}get name(){return this.cardStack.name}get rotate(){return this.cardStack.rotate}set rotate(e){this.cardStack.rotate=e}get zindex(){return this.cardStack.zindex}get isShowTotal(){return this.cardStack.isShowTotal}get cards(){return this.cardStack.cards}get isEmpty(){return this.cardStack.isEmpty}get size(){let e=this.cardStack.topCard;return e?e.size:2}get hasOwner(){return this.cardStack.hasOwner}get ownerIsOnline(){return this.cardStack.ownerIsOnline}get ownerName(){return this.cardStack.ownerName}get ownerColor(){return this.cardStack.ownerColor}get topCard(){return this.cardStack.topCard}get imageFile(){return this.imageService.getSkeletonOr(this.cardStack.imageFile)}get isIconHidden(){return null!=this.iconHiddenTimer}get rubiedText(){return et.rubyToHtml(et.escapeHtml(this.topCard.text))}get isLocked(){return!!this.cardStack&&this.cardStack.isLocked}set isLocked(e){this.cardStack&&(this.cardStack.isLocked=e)}get isInverse(){const e=Math.abs(this.viewRotateZ+this.rotate)%360;return 90<e&&e<270}ngOnInit(){Fe.register(this).on("SHUFFLE_CARD_STACK",e=>{e.data.identifier===this.cardStack.identifier&&(this.animeState="active",this.changeDetector.markForCheck())}).on("INVERSE_CARD_STACK",e=>{e.data.identifier===this.cardStack.identifier&&(this.animeState="inverse",this.changeDetector.markForCheck())}).on("UPDATE_GAME_OBJECT",e=>{let i=lt.instance.get(e.data.identifier);!this.cardStack||!i||(this.cardStack===i||i instanceof zn&&this.cardStack.contains(i)||i instanceof Ue&&i.userId===this.cardStack.owner)&&this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on("CARD_STACK_DECREASED",e=>{e.data.cardStackIdentifier===this.cardStack.identifier&&this.cardStack&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=Ue.findByPeerId(e.data.peerId);(!i||this.cardStack.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.cardStack,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain","text-note"]},this.rotableOption={tabletopObject:this.cardStack}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new Ls(this.elementRef.nativeElement)}),this.input.onStart=e=>this.ngZone.run(()=>this.onInputStart(e))}ngOnDestroy(){this.input.destroy(),Fe.unregister(this)}animationShuffleStarted(e){}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onCardDrop(e){if(this.cardStack!==e.detail&&(e.detail instanceof On||e.detail instanceof Gn))if(e.stopPropagation(),e.preventDefault(),e.detail instanceof On){let i=e.detail;(i.location.x-this.cardStack.location.x)**2+(i.location.y-this.cardStack.location.y)**2+(i.posZ-this.cardStack.posZ)**2<2500&&(this.chatMessageService.sendOperationLog(`${i.isFront?""==i.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":i.name:"\u4f0f\u305b\u305f\u30ab\u30fc\u30c9"} \u3092 ${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306b\u4e57\u305b\u305f`),this.cardStack.putOnTop(i))}else if(e.detail instanceof Gn){let i=e.detail;(i.location.x-this.cardStack.location.x)**2+(i.location.y-this.cardStack.location.y)**2+(i.posZ-this.cardStack.posZ)**2<625&&(this.chatMessageService.sendOperationLog(`${""==i.name?"(\u7121\u540d\u306e\u5c71\u672d)":i.name} \u3092\u5168\u3066 ${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306b\u4e57\u305b\u305f`),this.concatStack(i))}}startDoubleClickTimer(e){if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(()=>this.stopDoubleClickTimer(),e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}stopDoubleClickTimer(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}onDoubleClick(){if(this.stopDoubleClickTimer(),(this.doubleClickPoint.x-this.input.pointer.x)**2+(this.doubleClickPoint.y-this.input.pointer.y)**2<100){console.log("onDoubleClick !!!!");const i=this.drawCard();if(i){let r;dt.play(Ze.cardDraw),r=i.isFront?`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${""==i.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":i.name} \u3092\u5f15\u3044\u305f`:`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 1\u679a\u5f15\u3044\u3066\u4f0f\u305b\u305f`,this.chatMessageService.sendOperationLog(r)}}}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.startDoubleClickTimer(e),this.cardStack.toTopmost(),this.startIconHiddenTimer(),this.isLocked&&Fe.trigger("DRAG_LOCKED_OBJECT",{}),Fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:this.cardStack.identifier,className:"GameCharacter"})}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,dt.play(Ze.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,dt.play(Ze.lock)}},Tt,{name:"\u30ab\u30fc\u30c9\u3092\uff11\u679a\u5f15\u304f",action:()=>{const r=this.drawCard();if(r){let s;dt.play(Ze.cardDraw),s=r.isFront?`${this.cardStack.name} \u304b\u3089 ${""==r.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":r.name} \u3092\u5f15\u3044\u305f`:`${this.cardStack.name} \u304b\u3089 1\u679a\u5f15\u3044\u3066\u4f0f\u305b\u305f`,this.chatMessageService.sendOperationLog(s)}},default:this.cards.length>0,disabled:0==this.cards.length},{name:"\u30ab\u30fc\u30c9\u3092\u5f15\u304f",action:null,subActions:[2,3,4,5,10].map(r=>({name:`${r}\u679a`,action:()=>{const s=[];for(let o=0;o<r;o++){const c=this.drawCard();c&&(s.push(c),(0==o||3==o||9==o)&&dt.play(Ze.cardDraw))}if(s.length>0){const o=s.filter(c=>c.isFront);if(0==o.length)this.chatMessageService.sendOperationLog(`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${s.length}\u679a\u5f15\u3044\u3066\u4f0f\u305b\u305f`);else{const c=new Map;for(const I of o){let Z=c.get(I.name)||0;Z+=1,c.set(""==I.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":I.name,Z)}let m=`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${[...c.keys()].map(I=>`${I} \u3092 ${c.get(I)}\u679a`).join("\u3001")}`;m+=o.length===s.length?"\u5f15\u3044\u305f":`\u5f15\u304d\u3001${s.length-o.length}\u679a\u3092\u4f0f\u305b\u305f`,this.chatMessageService.sendOperationLog(m)}}}})),disabled:0==this.cards.length},Tt,0!=this.cards.length&&this.cardStack.topCard.isFront?{name:"\u4e00\u756a\u4e0a\u3092\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDown(),dt.play(Ze.cardDraw)},disabled:0==this.cards.length}:{name:"\u4e00\u756a\u4e0a\u3092\u8868\u306b\u3059\u308b",action:()=>{!this.cardStack.topCard||(this.cardStack.topCard.isFront||this.chatMessageService.sendOperationLog(`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306e\u4e00\u756a\u4e0a\u306e ${""==this.cardStack.topCard.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.cardStack.topCard.name} \u3092\u516c\u958b\u3057\u305f`),this.cardStack.faceUp(),dt.play(Ze.cardDraw))},disabled:0==this.cards.length},Tt,{name:"\u3059\u3079\u3066\u8868\u306b\u3059\u308b",action:()=>{this.cardStack.faceUpAll(),dt.play(Ze.cardDraw)},disabled:0==this.cards.length},{name:"\u3059\u3079\u3066\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDownAll(),dt.play(Ze.cardDraw)},disabled:0==this.cards.length},{name:"\u3059\u3079\u3066\u6b63\u4f4d\u7f6e\u306b\u3059\u308b",action:()=>{this.cardStack.uprightAll(),dt.play(Ze.cardDraw)},disabled:0==this.cards.length},Tt,{name:"\u30b7\u30e3\u30c3\u30d5\u30eb",action:()=>{this.cardStack.shuffle(),dt.play(Ze.cardShuffle),Fe.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier})},disabled:0==this.cards.length},{name:"\u30ab\u30fc\u30c9\u4e00\u89a7\u3092\u898b\u308b",action:()=>{this.showStackList(this.cardStack),this.chatMessageService.sendOperationLog(`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306e\u30ab\u30fc\u30c9\u4e00\u89a7\u3092\u898b\u305f`)},disabled:0==this.cards.length},Tt,this.isShowTotal?{name:"\u2611 \u679a\u6570\u3092\u8868\u793a",action:()=>{this.cardStack.isShowTotal=!1}}:{name:"\u2610 \u679a\u6570\u3092\u8868\u793a",action:()=>{this.cardStack.isShowTotal=!0}},{name:"\u30ab\u30fc\u30c9\u30b5\u30a4\u30ba\u3092\u63c3\u3048\u308b",action:()=>{this.cardStack.topCard&&this.cardStack.unifyCardsSize(this.cardStack.topCard.size)},disabled:0==this.cards.length},Tt,{name:"\u5c71\u672d\u3092\u5206\u5272\u3059\u308b",subActions:[{name:"\u4eba\u6570\u3067\u5206\u5272",action:()=>{this.splitStack(yt.peerIds.length),dt.play(Ze.cardDraw)}},Tt,...[2,3,4,5,6].map(r=>({name:`${r}\u3064\u306b\u5206\u5272`,action:()=>{this.splitStack(r),dt.play(Ze.cardDraw)}}))],disabled:0==this.cards.length},{name:"\u5c71\u672d\u3092\u5d29\u3059",action:()=>{this.breakStack(),dt.play(Ze.cardShuffle)},disabled:0==this.cards.length},{name:"\u5c71\u672d\u5168\u4f53\u3092\u88cf\u8fd4\u3059",action:()=>{this.cardStack.inverse(),dt.play(Ze.cardDraw),dt.play(Ze.cardDraw),Fe.call("INVERSE_CARD_STACK",{identifier:this.cardStack.identifier})},disabled:0==this.cards.length},Tt,{name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.cardStack)}},this.cardStack.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.cardStack.getUrls().map(r=>{const s=r.value.toString();return{name:r.name?r.name:s,action:()=>{et.sameOrigin(s)?window.open(s.trim(),"_blank","noopener"):this.modalService.open(Hr,{url:s,title:this.cardStack.name,subTitle:r.name})},disabled:!et.validUrl(s),error:et.validUrl(s)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:et.validUrl(s)&&!et.sameOrigin(s)}})},this.cardStack.getUrls().length<=0?null:Tt,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.cardStack.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.owner="",r.isLocked=!1,r.toTopmost(),dt.play(Ze.cardPut)}},{name:"\u5c71\u672d\u3092\u524a\u9664\u3059\u308b",action:()=>{this.cardStack.setLocation("graveyard"),this.cardStack.destroy(),dt.play(Ze.sweep)}}],this.name)}onMove(){dt.play(Ze.cardPick)}onMoved(){dt.play(Ze.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}drawCard(){let e=this.cardStack.drawCard();return e&&(this.cardStack.update(),e.location.x+=100+50*Math.random(),e.location.y+=25+50*Math.random(),e.setLocation(this.cardStack.location.name)),e}textShadowCss(e){const i=et.textShadowColor(e);return`${i} 0px 0px 2px, \n    ${i} 0px 0px 2px, \n    ${i} 0px 0px 2px, \n    ${i} 0px 0px 2px, \n    ${i} 0px 0px 2px, \n    ${i} 0px 0px 2px,\n    ${i} 0px 0px 2px,\n    ${i} 0px 0px 2px`}breakStack(){let e=this.cardStack.drawCardAll().reverse();for(let i of e)i.location.x+=25-50*Math.random(),i.location.y+=25-50*Math.random(),i.toTopmost(),i.setLocation(this.cardStack.location.name);this.cardStack.setLocation("graveyard"),this.cardStack.destroy()}splitStack(e){if(e<2)return;let i=[];for(let c=0;c<e;c++){let m=Gn.create(`${this.cardStack.name}_${("0"+(c+1).toString()).slice(-2)}`);m.location.x=this.cardStack.location.x+50-100*Math.random(),m.location.y=this.cardStack.location.y+50-100*Math.random(),m.posZ=this.cardStack.posZ,m.location.name=this.cardStack.location.name,m.rotate=this.rotate,m.toTopmost(),i.push(m)}let r=this.cardStack.drawCardAll();this.cardStack.setLocation("graveyard"),this.cardStack.destroy();let s=0,o=r.length/e*(s+1);for(let c=0;c<r.length;c++)i[s].putOnBottom(r[c]),o<=c+1&&(s++,o=r.length/e*(s+1))}concatStack(e,i=this.cardStack){let r=Gn.create(i.name);r.location.name=i.location.name,r.location.x=i.location.x,r.location.y=i.location.y,r.posZ=i.posZ,r.zindex=e.zindex,r.rotate=i.rotate;let s=i.drawCardAll(),o=e.drawCardAll();for(let c of o.concat(s))r.putOnBottom(c);i.setLocation(""),i.destroy(),e.setLocation(""),e.destroy()}dispatchCardDropEvent(){let r=this.elementRef.nativeElement.parentElement.children,s=new CustomEvent("carddrop",{detail:this.cardStack,bubbles:!0});for(let o=0;o<r.length;o++)r[o].dispatchEvent(s)}showDetail(e){Fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5c71\u672d\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Gs,{title:r,left:i.x-300,top:i.y-300,width:600,height:490}).tabletopObject=e}showStackList(e){Fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r={left:i.x-200,top:i.y-300,width:400,height:600};this.cardStack.owner=yt.peerContext.userId,this.panelService.open(wee,r).cardStack=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}}return n.\u0275fac=function(e){return new(e||n)(Le(vn),Le(sr),Le(In),Le(_i),Le(Di),Le(wu),Le(ai),Le(kn),Le(Er))},n.\u0275cmp=Zt({type:n,selectors:[["card-stack"]],hostBindings:function(e,i){1&e&&Te("carddrop",function(s){return i.onCardDrop(s)})("dragstart",function(s){return i.onDragstart(s)})("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{cardStack:"cardStack",is3D:"is3D"},decls:6,vars:16,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-pointer-events-auto","is-3d",3,"ngClass","rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],["class","is-3d",4,"ngIf"],[4,"ngIf"],["class","name-tag is-nowrap is-black-background is-3d number-of-cards","style","z-index: 10",3,"ngStyle",4,"ngIf"],["class","name-tag has-length-limit is-nowrap is-black-background is-3d","style","z-index: 10; color: whitesmoke",3,"ngStyle",4,"ngIf"],[1,"is-3d"],["class","text is-3d","style","width: 100%; height: 100%",3,"ngStyle",4,"ngIf"],[1,"card-image","chrome-smooth-image-trick",3,"ngStyle","src"],[1,"text","is-3d",2,"width","100%","height","100%",3,"ngStyle"],[1,"is-3d",3,"innerHTML"],[1,"rotate-grab","of-left-top","is-3d"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","is-3d"],[1,"rotate-grab","of-right-bottom","is-3d"],[1,"rotate-grab","of-right-top","is-3d"],[1,"name-tag","is-nowrap","is-black-background","is-3d","number-of-cards",2,"z-index","10",3,"ngStyle"],[3,"ngClass"],[1,"name-tag","has-length-limit","is-nowrap","is-black-background","is-3d",2,"z-index","10","color","whitesmoke",3,"ngStyle"]],template:function(e,i){1&e&&(K(0,"div",0),Te("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),K(1,"div",1),Te("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),xe(2,Tee,4,10,"div",2),xe(3,Iee,13,4,"ng-container",3),xe(4,See,3,7,"div",4),xe(5,kee,5,8,"div",5),J()()),2&e&&(Ke("width",i.size*i.gridSize,"px"),te("ngClass",ut(12,Dee,i.isEmpty))("movable.option",i.movableOption)("movable.disable",i.isLocked),U(1),te("ngClass",ut(14,Aee,!i.isLocked))("rotable.option",i.rotableOption)("rotable.disable",i.isLocked),U(1),te("ngIf",i.topCard&&i.imageFile),U(1),te("ngIf",!i.isIconHidden),U(1),te("ngIf",i.isShowTotal),U(1),te("ngIf",i.ownerIsOnline))},directives:[il,Wn,Ql,_n,Zi],pipes:[ti],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.is-empty[_ngcontent-%COMP%]{height:100px;width:100px}.component[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;margin-top:-5px;margin-left:-5px;border:solid 5px #CCCCCC;border-radius:5px;background-color:#ccc;-webkit-backface-visibility:hidden;backface-visibility:hidden}.card-image[_ngcontent-%COMP%]{display:block;top:0;left:0;bottom:0;right:0;margin:auto;height:auto;width:100%}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.rotate-grab[_ngcontent-%COMP%]{display:none;z-index:11}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:50%;opacity:.9}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.text[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.component[_ngcontent-%COMP%]:not(.is-empty):hover   .number-of-cards[_ngcontent-%COMP%]{visibility:hidden}.is-inverse[_ngcontent-%COMP%]{transform:rotate(180deg)}"],data:{animation:[xn("shuffle",[ip("active",Ye({transform:""})),Bt("* => active",[Ft("800ms ease",nn([Ye({transform:"scale3d(0, 0, 0) rotateZ(0deg)",offset:0}),Ye({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(360deg)",offset:.5}),Ye({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(520deg)",offset:.75}),Ye({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(630deg)",offset:.875}),Ye({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(720deg)",offset:1})]))]),Bt("* => inverse",[Ft("200ms ease",nn([Ye({transform:"scale3d(1.0, 1.0, 1.0)",offset:0}),Ye({transform:"scale3d(0.6, 1.2, 1.2)",offset:.5}),Ye({transform:"scale3d(0, 0.75, 0.75)",offset:.75}),Ye({transform:"scale3d(0.5, 1.125, 1.125)",offset:.875}),Ye({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])]),xn("bounceInOut",[Bt("void => *",[Ft("600ms ease",nn([Ye({transform:"scale3d(0, 0, 0)",offset:0}),Ye({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),Ye({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),Ye({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),Ye({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Bt("* => void",[Ft(100,Ye({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),n})();function Nee(n,t){if(1&n&&(K(0,"div",8),it(1,"div",9),Ct(2,"safe"),J()),2&n){const e=ge();Ke("opacity",e.isFront?1:.8)("transform",e.isFront?"":"scale(0.9)"),te("@flipOpen",void 0),U(1),Ke("font-size",e.fontSize+9,"px")("color",e.color)("text-shadow",e.textShadowCss),te("@inverse",e.state)("innerHTML",xt(2,13,e.rubiedText,"html"),qi)}}function Fee(n,t){if(1&n&&(it(0,"img",10),Ct(1,"safe")),2&n){const e=ge();te("@inverse",e.state)("src",xt(1,2,e.isFront?e.frontImage.url:e.backImage.url,"resourceUrl"),Jt)}}const Oee=function(n,t){return{"background-color":n,transform:t}};function Ree(n,t){if(1&n&&(K(0,"div",11)(1,"span",12)(2,"b"),be(3),J()()()),2&n){const e=ge();te("ngStyle",Kt(2,Oee,e.ownerColor,"translateY(-75%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),U(3),qe(e.ownerName)}}function Bee(n,t){1&n&&(it(0,"img",13),Ct(1,"safe")),2&n&&te("src",xt(1,1,ge().frontImage.url,"resourceUrl"),Jt)}function Lee(n,t){if(1&n&&(Ve(0),K(1,"div",14)(2,"i",15),be(3),J()(),K(4,"div",16)(5,"i",15),be(6),J()(),K(7,"div",17)(8,"i",15),be(9),J()(),K(10,"div",18)(11,"i",15),be(12),J()(),it(13,"div",19),Ge()),2&n){const e=ge();U(3),qe(e.isLocked?"lock":"autorenew"),U(3),qe(e.isLocked?"lock":"autorenew"),U(3),qe(e.isLocked?"lock":"autorenew"),U(3),qe(e.isLocked?"lock":"autorenew")}}const zee=function(n){return{"is-grab":n}};let jee=(()=>{class n{constructor(e,i,r,s,o,c,m,I,Z,fe){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.elementRef=s,this.changeDetector=o,this.tabletopService=c,this.imageService=m,this.pointerDeviceService=I,this.modalService=Z,this.chatMessageService=fe,this.card=null,this.is3D=!1,this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null}get name(){return this.card.name}get state(){return this.card.state}set state(e){this.card.state=e}get rotate(){return this.card.rotate}set rotate(e){this.card.rotate=e}get owner(){return this.card.owner}set owner(e){this.card.owner=e}get zindex(){return this.card.zindex}get size(){return this.adjustMinBounds(this.card.size)}get fontSize(){return this.card.fontsize}set fontSize(e){this.card.fontsize=e}get text(){return this.card.text}set text(e){this.card.text=e}get color(){return this.card.color}set color(e){this.card.color=e}get textShadowCss(){const e=et.textShadowColor(this.color);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}get isHand(){return this.card.isHand}get isFront(){return this.card.isFront}get isVisible(){return this.card.isVisible}get hasOwner(){return this.card.hasOwner}get ownerIsOnline(){return this.card.ownerIsOnline}get ownerName(){return this.card.ownerName}get ownerColor(){return this.card.ownerColor}get isGMMode(){return this.card.isGMMode}get imageFile(){return this.imageService.getSkeletonOr(this.card.imageFile)}get frontImage(){return this.imageService.getSkeletonOr(this.card.frontImage)}get backImage(){return this.imageService.getSkeletonOr(this.card.backImage)}get isIconHidden(){return null!=this.iconHiddenTimer}get rubiedText(){return et.rubyToHtml(et.escapeHtml(this.text))}get isLocked(){return!!this.card&&this.card.isLocked}set isLocked(e){this.card&&(this.card.isLocked=e)}ngOnInit(){Fe.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=lt.instance.get(e.data.identifier);!this.card||!i||(this.card===i||i instanceof zn&&this.card.contains(i)||i instanceof Ue&&i.userId===this.card.owner)&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=Ue.findByPeerId(e.data.peerId);(!i||this.card.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.card,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain","text-note"]},this.rotableOption={tabletopObject:this.card}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new Ls(this.elementRef.nativeElement)}),this.input.onStart=e=>this.ngZone.run(()=>this.onInputStart(e))}ngOnDestroy(){this.input.destroy(),Fe.unregister(this)}onCardDrop(e){if(this.card!==e.detail&&(e.detail instanceof On||e.detail instanceof Gn)&&(e.stopPropagation(),e.preventDefault(),e.detail instanceof Gn)){if(this.isLocked)return;let i=e.detail;(i.location.x-this.card.location.x)**2+(i.location.y-this.card.location.y)**2+(i.posZ-this.card.posZ)**2<625&&(i.location.x=this.card.location.x,i.location.y=this.card.location.y,i.posZ=this.card.posZ,i.putOnBottom(this.card),this.isLocked=!1)}}startDoubleClickTimer(e){if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(()=>this.stopDoubleClickTimer(),e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}stopDoubleClickTimer(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}onDoubleClick(){if(!this.isLocked&&(this.stopDoubleClickTimer(),(this.doubleClickPoint.x-this.input.pointer.x)**2+(this.doubleClickPoint.y-this.input.pointer.y)**2<100)){if(console.log("onDoubleClick !!!!"),this.ownerIsOnline&&!this.isHand)return;this.state=this.isVisible&&!this.isHand?ys.BACK:ys.FRONT,this.owner="",this.state===ys.FRONT&&this.chatMessageService.sendOperationLog((""==this.card.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.card.name)+" \u3092\u516c\u958b"),dt.play(Ze.cardDraw)}}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.startDoubleClickTimer(e),this.card.toTopmost(),this.startIconHiddenTimer(),this.isLocked&&Fe.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,dt.play(Ze.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,dt.play(Ze.lock)}},Tt,!this.isVisible||this.isHand?{name:this.isHand?"\u8868\u5411\u304d\u3067\u51fa\u3059\uff08\u516c\u958b\u3059\u308b\uff09":this.ownerIsOnline?"\u8868\u306b\u3059\u308b\uff08\u516c\u958b\u3059\u308b\uff09":"\u8868\u306b\u3059\u308b",action:()=>{this.card.faceUp(),this.chatMessageService.sendOperationLog((""==this.card.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.card.name)+" \u3092\u516c\u958b"),dt.play(Ze.cardDraw)},default:!this.isLocked&&(!this.ownerIsOnline||this.isHand)}:{name:"\u88cf\u306b\u3059\u308b",action:()=>{this.card.faceDown(),dt.play(Ze.cardDraw)},default:!this.card.isLocked&&(!this.ownerIsOnline||this.isHand)},this.isHand?{name:"\u88cf\u5411\u304d\u3067\u51fa\u3059",action:()=>{this.card.faceDown(),dt.play(Ze.cardDraw)}}:{name:"\u81ea\u5206\u3060\u3051\u898b\u308b\uff08\u624b\u672d\u306b\u3059\u308b\uff09",action:()=>{dt.play(Ze.cardDraw),this.chatMessageService.sendOperationLog(`${this.card.isFront?""==this.card.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.card.name:"(\u4f0f\u305b\u305f\u30ab\u30fc\u30c9)"} \u3092\u81ea\u5206\u3060\u3051\u898b\u305f`),this.card.faceDown(),this.owner=yt.peerContext.userId}},Tt,{name:"\u91cd\u306a\u3063\u305f\u30ab\u30fc\u30c9\u3067\u5c71\u672d\u3092\u4f5c\u308b",action:()=>{this.createStack(),dt.play(Ze.cardPut)},disabled:this.isLocked},Tt,{name:"\u30ab\u30fc\u30c9\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.card)}},this.isVisible&&this.card.getUrls().length>0?{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.card.getUrls().map(r=>{const s=r.value.toString();return{name:r.name?r.name:s,action:()=>{et.sameOrigin(s)?window.open(s.trim(),"_blank","noopener"):this.modalService.open(Hr,{url:s,title:this.card.name,subTitle:r.name})},disabled:!et.validUrl(s),error:et.validUrl(s)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:et.validUrl(s)&&!et.sameOrigin(s)}})}:null,this.isVisible&&this.card.getUrls().length>0?Tt:null,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.card.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.toTopmost(),r.isLocked=!1,dt.play(Ze.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.card.destroy(),dt.play(Ze.sweep)}}],this.isVisible?this.name:"\u30ab\u30fc\u30c9")}onMove(){this.input.cancel(),dt.play(Ze.cardPick)}onMoved(){dt.play(Ze.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}createStack(){let e=this.tabletopService.cards.filter(r=>(r.location.x-this.card.location.x)**2+(r.location.y-this.card.location.y)**2+(r.posZ-this.card.posZ)**2<1e4&&!r.isLocked);if(0==e.length)return;let i=Gn.create("\u5c71\u672d");i.location.x=this.card.location.x,i.location.y=this.card.location.y,i.posZ=this.card.posZ,i.location.name=this.card.location.name,i.rotate=this.rotate,i.zindex=this.card.zindex,e.sort((r,s)=>r.zindex<s.zindex?1:r.zindex>s.zindex?-1:0);for(let r of e)i.putOnBottom(r)}dispatchCardDropEvent(){console.log("dispatchCardDropEvent");let r=this.elementRef.nativeElement.parentElement.children,s=new CustomEvent("carddrop",{detail:this.card,bubbles:!0});for(let o=0;o<r.length;o++)r[o].dispatchEvent(s)}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){Fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(r+=" - "+(this.isVisible?e.name:"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09")),this.panelService.open(Gs,{title:r,left:i.x-300,top:i.y-300,width:600,height:490}).tabletopObject=e}}return n.\u0275fac=function(e){return new(e||n)(Le(vn),Le(sr),Le(In),Le(_i),Le(Di),Le(vu),Le(wu),Le(ai),Le(kn),Le(Er))},n.\u0275cmp=Zt({type:n,selectors:[["card"]],hostBindings:function(e,i){1&e&&Te("carddrop",function(s){return i.onCardDrop(s)})("dragstart",function(s){return i.onDragstart(s)})("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{card:"card",is3D:"is3D"},decls:8,vars:15,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],[1,"is-pointer-events-none","is-3d"],["appRotable","",1,"component-content","is-pointer-events-auto","is-3d",3,"rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],["class","text is-3d","style","width: 100%; height: 100%",3,"opacity","transform",4,"ngIf"],["class","card-image is-3d chrome-smooth-image-trick",3,"src",4,"ngIf"],["class","name-tag is-nowrap has-length-limit is-black-background is-3d",3,"ngStyle",4,"ngIf"],["class","card-image thumbnail-transform is-translucent is-3d chrome-smooth-image-trick",3,"src",4,"ngIf"],[4,"ngIf"],[1,"text","is-3d",2,"width","100%","height","100%"],[1,"is-3d",3,"innerHTML"],[1,"card-image","is-3d","chrome-smooth-image-trick",3,"src"],[1,"name-tag","is-nowrap","has-length-limit","is-black-background","is-3d",3,"ngStyle"],[1,"is-3d"],[1,"card-image","thumbnail-transform","is-translucent","is-3d","chrome-smooth-image-trick",3,"src"],[1,"rotate-grab","of-left-top","is-3d"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","is-3d"],[1,"rotate-grab","of-right-bottom","is-3d"],[1,"rotate-grab","of-right-top","is-3d"],[1,"border-bg","is-pointer-events-none","is-3d"]],template:function(e,i){1&e&&(K(0,"div",0),Te("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),K(1,"div",1)(2,"div",2),Te("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),xe(3,Nee,3,16,"div",3),xe(4,Fee,2,5,"img",4),xe(5,Ree,4,5,"div",5),xe(6,Bee,2,4,"img",6),xe(7,Lee,14,4,"ng-container",7),J()()()),2&e&&(Ke("width",i.size*i.gridSize,"px"),te("ngClass",ut(13,zee,!i.isLocked))("movable.option",i.movableOption)("movable.disable",i.isLocked),U(1),te("@slidInOut",void 0),U(1),te("rotable.option",i.rotableOption)("rotable.disable",i.isLocked),U(1),te("ngIf",i.isFront||i.isHand||i.isGMMode),U(1),te("ngIf",i.imageFile),U(1),te("ngIf",!i.isFront&&i.ownerIsOnline&&0<i.ownerName.length),U(1),te("ngIf",!i.isFront&&(i.isHand||i.isGMMode)&&i.frontImage),U(1),te("ngIf",!i.isIconHidden))},directives:[il,Wn,Ql,_n,Zi],pipes:[ti],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:auto;width:auto;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;min-width:25px;min-height:25px}.component-content[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;height:100%;width:100%;box-sizing:border-box}.card-image[_ngcontent-%COMP%]{display:block;top:0;left:0;bottom:0;right:0;margin:auto;height:auto;width:100%}.thumbnail-transform[_ngcontent-%COMP%]{position:absolute;transform:scale(.9)}.is-translucent[_ngcontent-%COMP%]{filter:opacity(.8)}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;z-index:11}.rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-10px;left:-10px;border-radius:14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-10px;left:-10px;border-radius:14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-10px;right:-10px;border-radius:14px}.of-right-top[_ngcontent-%COMP%]{top:-10px;right:-10px;border-radius:14px}.border-bg[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;border-radius:8px;background-color:#cccccc80;top:-2px;left:-2px;right:-2px;bottom:-2px;z-index:-1}.border-bg[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .border-bg[_ngcontent-%COMP%]{display:block}.component[_ngcontent-%COMP%]:active   .border-bg[_ngcontent-%COMP%]{display:none}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:0;color:#f5f5f5!important;opacity:.9;z-index:10}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.text[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}"],data:{animation:[xn("inverse",[ip("inverse",Ye({transform:""})),Bt(":increment, :decrement",[Ft("200ms ease",nn([Ye({transform:"scale3d(1.0, 1.0, 1.0)",offset:0}),Ye({transform:"scale3d(0.6, 1.2, 1.2)",offset:.5}),Ye({transform:"scale3d(0, 0.75, 0.75)",offset:.75}),Ye({transform:"scale3d(0.5, 1.125, 1.125)",offset:.875}),Ye({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])]),xn("flipOpen",[Bt(":enter",[Ft("200ms ease",nn([Ye({transform:"scale3d(0, 1.0, 1.0)",offset:0}),Ye({transform:"scale3d(0, 1.2, 1.2)",offset:.5}),Ye({transform:"scale3d(0, 0.75, 0.75)",offset:.75}),Ye({transform:"scale3d(0.5, 1.125, 1.125)",offset:.875}),Ye({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])]),xn("slidInOut",[Bt("void => *",[Ft("200ms ease",nn([Ye({"transform-origin":"left center",transform:"scale3d(0, 1.0, 1.0)",offset:0}),Ye({"transform-origin":"left center",transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Bt("* => void",[Ft(100,Ye({"transform-origin":"left center",transform:"scale3d(0, 1.0, 1.0)"}))])])]},changeDetection:0}),n})();class pf{constructor(t,e,i){this.canvasElement=t,this.canvasElementRange=e,this.canvasElementCenter=i}makeBrush(t,e,i){t.strokeStyle=i,t.fillStyle=t.strokeStyle,t.lineWidth=1;let r=Math.floor(e/5);return t.font=`bold ${r}px sans-serif`,t.textBaseline="top",t.textAlign="center",t}chkOuterProduct(t,e,i,r,s,o){return(i-t)*(o-e)-(r-e)*(s-t)>=-.01}chkInCircle(t,e,i){return t*t>=e*e+i*i}renderCircle(t){let e=t.gridSize,i=t.areaWidth*e/2,r=t.areaHeight*e/2,o=(Math,-t.centerX%e),c=-t.centerY%e;o>0&&(o-=e),c>0&&(c-=e),t.offSetX&&(o<-.5?o+=e/2:o-=e/2),t.offSetY&&(c<-.5?c+=e/2:c-=e/2),this.canvasElement.width=t.areaWidth*e,this.canvasElement.height=t.areaHeight*e;let m=this.canvasElement.getContext("2d"),I=0,Z=0,fe=this.generateCalcGridPositionFunc(t.gridType,t.centerX,t.centerY,t.areaWidth,t.areaHeight);if(0==t.fillType)this.makeBrush(m,e,t.gridColor),m.beginPath(),m.arc(i,r,t.range*e,0,2*Math.PI,!0),m.fill();else{this.makeBrush(m,e,t.gridColor);for(let pe=0;pe<=t.areaHeight+1;pe++)for(let ye=0;ye<=t.areaWidth+1;ye++){let{gx:we,gy:Me}=fe(ye,pe,e);if(1==t.fillType)I=we+o+e/2-i,Z=Me+c+e/2-r,this.chkInCircle(t.range*e,I,Z)&&this.fillSquare(m,we+o,Me+c,e);else{let Oe=0;for(let Be=0;Be<e;Be++)for(let ke=0;ke<e;ke++)I=we+o+Be-i+.5,Z=Me+c+ke-r+.5,this.chkInCircle(t.range*e,I,Z)&&Oe++;(2==t.fillType&&Oe>=1||3==t.fillType&&Oe>=e*e/2||4==t.fillType&&Oe>=e*e)&&this.fillSquare(m,we+o,Me+c,e)}}}this.canvasElementRange.width=t.areaWidth*e,this.canvasElementRange.height=t.areaHeight*e,m=this.canvasElementRange.getContext("2d"),this.makeBrush(m,e,t.rangeColor),m.beginPath(),m.lineWidth=2,m.arc(i,r,t.range*e,0,2*Math.PI,!0),m.stroke(),t.isDocking?(m.beginPath(),m.strokeRect(i-6,r-6,12,12)):(m.beginPath(),m.arc(i,i,5,0,2*Math.PI,!0),m.fill()),this.canvasElementCenter.width=t.areaWidth*e,this.canvasElementCenter.height=t.areaHeight*e,m=this.canvasElementCenter.getContext("2d"),this.makeBrush(m,e,t.rangeColor),t.isDocking?(m.beginPath(),m.strokeRect(i-6,r-6,12,12)):(m.beginPath(),m.arc(i,i,5,0,2*Math.PI,!0),m.fill())}renderLine(t){let e=t.gridSize,i=t.areaWidth*e/2,r=t.areaHeight*e/2,s=Math.PI/180*t.degree,o=-t.centerX%e,c=-t.centerY%e;o>0&&(o-=e),c>0&&(c-=e),t.offSetX&&(o<-.5?o+=e/2:o-=e/2),t.offSetY&&(c<-.5?c+=e/2:c-=e/2),this.canvasElement.width=t.areaWidth*e,this.canvasElement.height=t.areaHeight*e;let m=this.canvasElement.getContext("2d"),Z=.5*t.width*e,pe=-.5*t.width*e,ye=t.range*e,we=-.5*t.width*e,Me=t.range*e,Oe=.5*t.width*e,Be=0-e*Math.sqrt(2),ke=Z+e*Math.sqrt(2),ze=0-e*Math.sqrt(2),je=pe-e*Math.sqrt(2),st=ye+e*Math.sqrt(2),ot=we-e*Math.sqrt(2),tt=Me+e*Math.sqrt(2),_t=Oe+e*Math.sqrt(2),Je=0*Math.cos(s)-Z*Math.sin(s),at=0*Math.sin(s)+Z*Math.cos(s),ft=0*Math.cos(s)-pe*Math.sin(s),Ut=0*Math.sin(s)+pe*Math.cos(s),zt=ye*Math.cos(s)-we*Math.sin(s),fn=ye*Math.sin(s)+we*Math.cos(s),Nn=Me*Math.cos(s)-Oe*Math.sin(s),bt=Me*Math.sin(s)+Oe*Math.cos(s),wt={clip01x:Be*Math.cos(s)-ke*Math.sin(s),clip01y:Be*Math.sin(s)+ke*Math.cos(s),clip02x:ze*Math.cos(s)-je*Math.sin(s),clip02y:ze*Math.sin(s)+je*Math.cos(s),clip03x:st*Math.cos(s)-ot*Math.sin(s),clip03y:st*Math.sin(s)+ot*Math.cos(s),clip04x:tt*Math.cos(s)-_t*Math.sin(s),clip04y:tt*Math.sin(s)+_t*Math.cos(s)},Et=0,Pt=0,mn=this.generateCalcGridPositionFunc(t.gridType,t.centerX,t.centerY,t.areaWidth,t.areaHeight);if(this.makeBrush(m,e,t.gridColor),0==t.fillType)this.makeBrush(m,e,t.gridColor),m.beginPath(),m.moveTo(Je+i,at+r),m.lineTo(ft+i,Ut+r),m.lineTo(zt+i,fn+r),m.lineTo(Nn+i,bt+r),m.lineTo(Je+i,at+r),m.fill();else{this.makeBrush(m,e,t.gridColor);for(let Rn=0;Rn<=t.areaHeight+1;Rn++)for(let Hn=0;Hn<=t.areaWidth+1;Hn++){let{gx:mi,gy:wn}=mn(Hn,Rn,e);if(1==t.fillType)Et=mi+o+e/2-i,Pt=wn+c+e/2-r,this.chkOuterProduct(Je,at,ft,Ut,Et,Pt)&&this.chkOuterProduct(ft,Ut,zt,fn,Et,Pt)&&this.chkOuterProduct(zt,fn,Nn,bt,Et,Pt)&&this.chkOuterProduct(Nn,bt,Je,at,Et,Pt)&&this.fillSquare(m,mi+o,wn+c,e);else{let pt=0;for(let Jl=0;Jl<e;Jl++)for(let Ei=0;Ei<e;Ei++)Et=mi+o+Jl-i+.5,Pt=wn+c+Ei-r+.5,this.chkOuterProduct(Je,at,ft,Ut,Et,Pt)&&this.chkOuterProduct(ft,Ut,zt,fn,Et,Pt)&&this.chkOuterProduct(zt,fn,Nn,bt,Et,Pt)&&this.chkOuterProduct(Nn,bt,Je,at,Et,Pt)&&pt++;(2==t.fillType&&pt>=1||3==t.fillType&&pt>=e*e/2||4==t.fillType&&pt>=e*e)&&this.fillSquare(m,mi+o,wn+c,e)}}}return this.canvasElementRange.width=t.areaWidth*e,this.canvasElementRange.height=t.areaHeight*e,m=this.canvasElementRange.getContext("2d"),this.makeBrush(m,e,t.rangeColor),m.beginPath(),m.lineWidth=2,m.moveTo(Je+i,at+r),m.lineTo(ft+i,Ut+r),m.lineTo(zt+i,fn+r),m.lineTo(Nn+i,bt+r),m.lineTo(Je+i,at+r),m.stroke(),m.beginPath(),m.arc(i,i,5,0,2*Math.PI,!0),m.fill(),this.canvasElementCenter.width=t.areaWidth*e,this.canvasElementCenter.height=t.areaHeight*e,m=this.canvasElementCenter.getContext("2d"),this.makeBrush(m,e,t.rangeColor),m.beginPath(),m.arc(i,i,5,0,2*Math.PI,!0),m.fill(),wt}static gripAreaPathLine(t){let e=t.gridSize,i=Math.PI/180*t.degree,ye=.5*t.width*e,Me=-.5*t.width*e,Oe=t.range*e,Be=-.5*t.width*e,ke=t.range*e,ze=.5*t.width*e;return{clip01x:0*Math.cos(i)-ye*Math.sin(i),clip01y:0*Math.sin(i)+ye*Math.cos(i),clip02x:0*Math.cos(i)-Me*Math.sin(i),clip02y:0*Math.sin(i)+Me*Math.cos(i),clip03x:Oe*Math.cos(i)-Be*Math.sin(i),clip03y:Oe*Math.sin(i)+Be*Math.cos(i),clip04x:ke*Math.cos(i)-ze*Math.sin(i),clip04y:ke*Math.sin(i)+ze*Math.cos(i)}}renderSquare(t){let e=t.gridSize,i=t.areaWidth*e/2,r=t.areaHeight*e/2,o=(Math,-t.centerX%e),c=-t.centerY%e;o>0&&(o-=e),c>0&&(c-=e),t.offSetX&&(o<-.5?o+=e/2:o-=e/2),t.offSetY&&(c<-.5?c+=e/2:c-=e/2),this.canvasElement.width=t.areaWidth*e,this.canvasElement.height=t.areaHeight*e;let m=this.canvasElement.getContext("2d"),I=-t.range*e,Z=t.range*e,fe=-t.range*e,pe=-t.range*e,ye=t.range*e,we=-t.range*e,Me=t.range*e,Oe=t.range*e,Je={clip01x:I-1*e,clip01y:Z+1*e,clip02x:fe-1*e,clip02y:pe-1*e,clip03x:ye+1*e,clip03y:we-1*e,clip04x:Me+1*e,clip04y:Oe+1*e},at=0,ft=0,Ut=this.generateCalcGridPositionFunc(t.gridType,t.centerX,t.centerY,t.areaWidth,t.areaHeight);if(this.makeBrush(m,e,t.gridColor),0==t.fillType)this.makeBrush(m,e,t.gridColor),m.beginPath(),m.moveTo(I+i,Z+r),m.lineTo(fe+i,pe+r),m.lineTo(ye+i,we+r),m.lineTo(Me+i,Oe+r),m.lineTo(I+i,Z+r),m.fill();else{this.makeBrush(m,e,t.gridColor);for(let zt=0;zt<=t.areaHeight+1;zt++)for(let fn=0;fn<=t.areaWidth+1;fn++){let{gx:Nn,gy:bt}=Ut(fn,zt,e);if(1==t.fillType)at=Nn+o+e/2-i,ft=bt+c+e/2-r,this.chkOuterProduct(I,Z,fe,pe,at,ft)&&this.chkOuterProduct(fe,pe,ye,we,at,ft)&&this.chkOuterProduct(ye,we,Me,Oe,at,ft)&&this.chkOuterProduct(Me,Oe,I,Z,at,ft)&&this.fillSquare(m,Nn+o,bt+c,e);else{let wt=0;for(let Et=0;Et<e;Et++)for(let Pt=0;Pt<e;Pt++)at=Nn+o+Et-i+.5,ft=bt+c+Pt-r+.5,this.chkOuterProduct(I,Z,fe,pe,at,ft)&&this.chkOuterProduct(fe,pe,ye,we,at,ft)&&this.chkOuterProduct(ye,we,Me,Oe,at,ft)&&this.chkOuterProduct(Me,Oe,I,Z,at,ft)&&wt++;(2==t.fillType&&wt>=1||3==t.fillType&&wt>=e*e/2||4==t.fillType&&wt>=e*e)&&this.fillSquare(m,Nn+o,bt+c,e)}}}return this.canvasElementRange.width=t.areaWidth*e,this.canvasElementRange.height=t.areaHeight*e,m=this.canvasElementRange.getContext("2d"),this.makeBrush(m,e,t.rangeColor),m.beginPath(),m.lineWidth=2,m.moveTo(I+i,Z+r),m.lineTo(fe+i,pe+r),m.lineTo(ye+i,we+r),m.lineTo(Me+i,Oe+r),m.lineTo(I+i,Z+r),m.stroke(),t.isDocking?(m.beginPath(),m.strokeRect(i-6,r-6,12,12)):(m.beginPath(),m.arc(i,i,5,0,2*Math.PI,!0),m.fill()),this.canvasElementCenter.width=t.areaWidth*e,this.canvasElementCenter.height=t.areaHeight*e,m=this.canvasElementCenter.getContext("2d"),this.makeBrush(m,e,t.rangeColor),t.isDocking?(m.beginPath(),m.strokeRect(i-6,r-6,12,12)):(m.beginPath(),m.arc(i,i,5,0,2*Math.PI,!0),m.fill()),Je}static gripAreaPathSquare(t){let e=t.gridSize;return Math,{clip01x:-t.range*e,clip01y:t.range*e,clip02x:-t.range*e,clip02y:-t.range*e,clip03x:t.range*e,clip03y:-t.range*e,clip04x:t.range*e,clip04y:t.range*e}}renderDiamond(t){let e=t.gridSize,i=t.areaWidth*e/2,r=t.areaHeight*e/2,s=-t.centerX%e,o=-t.centerY%e;s>0&&(s-=e),o>0&&(o-=e),t.offSetX&&(s<-.5?s+=e/2:s-=e/2),t.offSetY&&(o<-.5?o+=e/2:o-=e/2),this.canvasElement.width=t.areaWidth*e,this.canvasElement.height=t.areaHeight*e;let c=this.canvasElement.getContext("2d"),m=-t.range*e,fe=-t.range*e,pe=t.range*e,Me=t.range*e,_t={clip01x:m-2*e,clip01y:0,clip02x:0,clip02y:fe-2*e,clip03x:pe+2*e,clip03y:0,clip04x:0,clip04y:Me+2*e},Je=0,at=0,ft=this.generateCalcGridPositionFunc(t.gridType,t.centerX,t.centerY,t.areaWidth,t.areaHeight);if(this.makeBrush(c,e,t.gridColor),0==t.fillType)this.makeBrush(c,e,t.gridColor),c.beginPath(),c.moveTo(m+i,0+r),c.lineTo(0+i,fe+r),c.lineTo(pe+i,0+r),c.lineTo(0+i,Me+r),c.lineTo(m+i,0+r),c.fill();else{this.makeBrush(c,e,t.gridColor);for(let Ut=0;Ut<=t.areaHeight+1;Ut++)for(let zt=0;zt<=t.areaWidth+1;zt++){let{gx:fn,gy:Nn}=ft(zt,Ut,e);if(1==t.fillType)Je=fn+s+e/2-i,at=Nn+o+e/2-r,this.chkOuterProduct(m,0,0,fe,Je,at)&&this.chkOuterProduct(0,fe,pe,0,Je,at)&&this.chkOuterProduct(pe,0,0,Me,Je,at)&&this.chkOuterProduct(0,Me,m,0,Je,at)&&this.fillSquare(c,fn+s,Nn+o,e);else{let bt=0;for(let wt=0;wt<e;wt++)for(let Et=0;Et<e;Et++)Je=fn+s+wt-i+.5,at=Nn+o+Et-r+.5,this.chkOuterProduct(m,0,0,fe,Je,at)&&this.chkOuterProduct(0,fe,pe,0,Je,at)&&this.chkOuterProduct(pe,0,0,Me,Je,at)&&this.chkOuterProduct(0,Me,m,0,Je,at)&&bt++;(2==t.fillType&&bt>=1||3==t.fillType&&bt>=e*e/2||4==t.fillType&&bt>=e*e)&&this.fillSquare(c,fn+s,Nn+o,e)}}}return this.canvasElementRange.width=t.areaWidth*e,this.canvasElementRange.height=t.areaHeight*e,c=this.canvasElementRange.getContext("2d"),this.makeBrush(c,e,t.rangeColor),c.beginPath(),c.lineWidth=2,c.moveTo(m+i,0+r),c.lineTo(0+i,fe+r),c.lineTo(pe+i,0+r),c.lineTo(0+i,Me+r),c.lineTo(m+i,0+r),c.stroke(),t.isDocking?(c.beginPath(),c.strokeRect(i-6,r-6,12,12)):(c.beginPath(),c.arc(i,i,5,0,2*Math.PI,!0),c.fill()),this.canvasElementCenter.width=t.areaWidth*e,this.canvasElementCenter.height=t.areaHeight*e,c=this.canvasElementCenter.getContext("2d"),this.makeBrush(c,e,t.rangeColor),t.isDocking?(c.beginPath(),c.strokeRect(i-6,r-6,12,12)):(c.beginPath(),c.arc(i,i,5,0,2*Math.PI,!0),c.fill()),_t}static gripAreaPathDiamond(t){let e=t.gridSize;return{clip01x:-t.range*e,clip01y:0,clip02x:0,clip02y:-t.range*e,clip03x:t.range*e,clip03y:0,clip04x:0,clip04y:t.range*e}}renderCorn(t){let e=t.gridSize,i=t.areaWidth*e/2,r=t.areaHeight*e/2,s=Math.PI/180*t.degree,o=-t.centerX%e,c=-t.centerY%e;o>0&&(o-=e),c>0&&(c-=e),t.offSetX&&(o<-.5?o+=e/2:o-=e/2),t.offSetY&&(c<-.5?c+=e/2:c-=e/2),this.canvasElement.width=t.areaWidth*e,this.canvasElement.height=t.areaHeight*e;let m=this.canvasElement.getContext("2d"),fe=t.range*e,pe=-.5*t.width*e,ye=t.range*e,we=.5*t.width*e,Me=0-e*Math.sqrt(2),Be=0-e*Math.sqrt(2),ke=0-e*Math.sqrt(2),ze=fe-e*Math.sqrt(2),je=pe-e*Math.sqrt(2),st=fe,ot=pe-e*Math.sqrt(2),tt=fe+e*Math.sqrt(2),_t=pe-e*Math.sqrt(2),Je=tt,at=-_t,ft=st,Ut=-ot,zt=ze,fn=-je,Nn=Be,bt=-ke,Pt=fe*Math.cos(s)-pe*Math.sin(s),mn=fe*Math.sin(s)+pe*Math.cos(s),Rn=ye*Math.cos(s)-we*Math.sin(s),Hn=ye*Math.sin(s)+we*Math.cos(s),mi={clip01x:Me*Math.cos(s)-0*Math.sin(s),clip01y:Me*Math.sin(s)+0*Math.cos(s),clip02x:Be*Math.cos(s)-ke*Math.sin(s),clip02y:Be*Math.sin(s)+ke*Math.cos(s),clip03x:ze*Math.cos(s)-je*Math.sin(s),clip03y:ze*Math.sin(s)+je*Math.cos(s),clip04x:st*Math.cos(s)-ot*Math.sin(s),clip04y:st*Math.sin(s)+ot*Math.cos(s),clip05x:tt*Math.cos(s)-_t*Math.sin(s),clip05y:tt*Math.sin(s)+_t*Math.cos(s),clip06x:Je*Math.cos(s)-at*Math.sin(s),clip06y:Je*Math.sin(s)+at*Math.cos(s),clip07x:ft*Math.cos(s)-Ut*Math.sin(s),clip07y:ft*Math.sin(s)+Ut*Math.cos(s),clip08x:zt*Math.cos(s)-fn*Math.sin(s),clip08y:zt*Math.sin(s)+fn*Math.cos(s),clip09x:Nn*Math.cos(s)-bt*Math.sin(s),clip09y:Nn*Math.sin(s)+bt*Math.cos(s)},wn=0,pt=0,Jl=this.generateCalcGridPositionFunc(t.gridType,t.centerX,t.centerY,t.areaWidth,t.areaHeight);if(0==t.fillType)this.makeBrush(m,e,t.gridColor),m.beginPath(),m.moveTo(0+i,0+r),m.lineTo(Pt+i,mn+r),m.lineTo(Rn+i,Hn+r),m.lineTo(0+i,0+r),m.fill();else{this.makeBrush(m,e,t.gridColor);for(let Ei=0;Ei<=t.areaHeight+1;Ei++)for(let mo=0;mo<=t.areaWidth+1;mo++){let{gx:Cs,gy:Ws}=Jl(mo,Ei,e);if(1==t.fillType)wn=Cs+o+e/2-i,pt=Ws+c+e/2-r,this.chkOuterProduct(0,0,Pt,mn,wn,pt)&&this.chkOuterProduct(Pt,mn,Rn,Hn,wn,pt)&&this.chkOuterProduct(Rn,Hn,0,0,wn,pt)&&this.fillSquare(m,Cs+o,Ws+c,e);else{let rl=0;for(let w1=0;w1<e;w1++)for(let E1=0;E1<e;E1++)wn=Cs+o+w1-i+.5,pt=Ws+c+E1-r+.5,this.chkOuterProduct(0,0,Pt,mn,wn,pt)&&this.chkOuterProduct(Pt,mn,Rn,Hn,wn,pt)&&this.chkOuterProduct(Rn,Hn,0,0,wn,pt)&&rl++;(2==t.fillType&&rl>=1||3==t.fillType&&rl>=e*e/2||4==t.fillType&&rl>=e*e)&&this.fillSquare(m,Cs+o,Ws+c,e)}}}return this.canvasElementRange.width=t.areaWidth*e,this.canvasElementRange.height=t.areaHeight*e,m=this.canvasElementRange.getContext("2d"),this.makeBrush(m,e,t.rangeColor),m.beginPath(),m.lineWidth=2,m.moveTo(0+i,0+r),m.lineTo(Pt+i,mn+r),m.lineTo(Rn+i,Hn+r),m.lineTo(0+i,0+r),m.stroke(),m.beginPath(),m.arc(i,i,5,0,2*Math.PI,!0),m.fill(),this.canvasElementCenter.width=t.areaWidth*e,this.canvasElementCenter.height=t.areaHeight*e,m=this.canvasElementCenter.getContext("2d"),this.makeBrush(m,e,t.rangeColor),m.beginPath(),m.arc(i,i,5,0,2*Math.PI,!0),m.fill(),mi}static gripAreaPathCorn(t){let e=t.gridSize,i=Math.PI/180*t.degree,o=t.range*e,c=-.5*t.width*e,pe=o,ye=c,we=o,Me=c,Oe=o,Be=c,ke=Oe,ze=-Be,je=we,st=-Me,ot=pe,tt=-ye;return{clip01x:0*Math.cos(i)-0*Math.sin(i),clip01y:0*Math.sin(i)+0*Math.cos(i),clip02x:0*Math.cos(i)-0*Math.sin(i),clip02y:0*Math.sin(i)+0*Math.cos(i),clip03x:pe*Math.cos(i)-ye*Math.sin(i),clip03y:pe*Math.sin(i)+ye*Math.cos(i),clip04x:we*Math.cos(i)-Me*Math.sin(i),clip04y:we*Math.sin(i)+Me*Math.cos(i),clip05x:Oe*Math.cos(i)-Be*Math.sin(i),clip05y:Oe*Math.sin(i)+Be*Math.cos(i),clip06x:ke*Math.cos(i)-ze*Math.sin(i),clip06y:ke*Math.sin(i)+ze*Math.cos(i),clip07x:je*Math.cos(i)-st*Math.sin(i),clip07y:je*Math.sin(i)+st*Math.cos(i),clip08x:ot*Math.cos(i)-tt*Math.sin(i),clip08y:ot*Math.sin(i)+tt*Math.cos(i),clip09x:0*Math.cos(i)- -0*Math.sin(i),clip09y:0*Math.sin(i)+-0*Math.cos(i)}}generateCalcGridPositionFunc(t,e,i,r,s){switch(t){case Us.HEX_VERTICAL:return(o,c,m)=>(o+(e%(2*m)<m?1:0)+(r%4==0?1:0))%2==1?{gx:o*m,gy:c*m}:{gx:o*m,gy:c*m+m/2};case Us.HEX_HORIZONTAL:return(o,c,m)=>(c+(i%(2*m)<m?1:0)+(s%4==0?1:0))%2==1?{gx:o*m,gy:c*m}:{gx:o*m+m/2,gy:c*m};default:return(o,c,m)=>({gx:o*m,gy:c*m})}}fillSquare(t,e,i,r){t.beginPath(),t.fillRect(e,i,r,r)}strokeSquare(t,e,i,r){t.beginPath(),t.strokeStyle="#55555533",t.strokeRect(e,i,r,r)}strokeHex(t,e,i,r,s){let o=s===Us.HEX_HORIZONTAL?-30:0,c=r/Math.sqrt(3),m=e+r/2,I=i+r/2;t.beginPath();for(let Z=0;Z<6;Z++){o+=60;let fe=Math.PI/180*o,pe=Math.cos(fe)*c+m,ye=Math.sin(fe)*c+I;t.lineTo(pe,ye)}t.closePath(),t.stroke()}}const Hee=["gridCanvas"],Uee=["rangeCanvas"],Vee=["centerPunch"],Gee=["rotate"];function qee(n,t){if(1&n&&(K(0,"div",15)(1,"i",16),be(2),J()()),2&n){const e=ge();U(2),qe(e.isLocked?"lock":"open_with")}}function Wee(n,t){if(1&n&&(Ve(0),K(1,"div",21)(2,"i",16),be(3),J()(),Ge()),2&n){const e=t.$implicit,i=ge(2);U(1),Ke("left",i.math.ceil((e-.3)*i.gridSize),"px"),U(2),qe(i.isLocked?"lock":"autorenew")}}function Kee(n,t){if(1&n&&(Ve(0),K(1,"div",17),xe(2,Wee,4,3,"ng-container",18),K(3,"div",19)(4,"i",16),be(5),J()(),K(6,"div",20)(7,"i",16),be(8),J()()(),Ge()),2&n){const e=ge();U(2),te("ngForOf",e.rotateHandlesLeftPos),U(3),qe(e.isLocked?"lock":"autorenew"),U(3),qe(e.isLocked?"lock":"autorenew")}}const Yee=function(n){return{transform:n}};function Zee(n,t){if(1&n&&(K(0,"div",22)(1,"div",23)(2,"span",24)(3,"i"),be(4),J()(),K(5,"span",25)(6,"i"),be(7),J()()(),K(8,"div",23)(9,"span",26),be(10),J(),K(11,"span",27),be(12),J()(),K(13,"div",23)(14,"span",24)(15,"i"),be(16),J()(),K(17,"span",25)(18,"i"),be(19),J()()()()),2&n){const e=ge();Ke("border-left-color",e.range.rangeColor)("height",e.math.abs(e.altitude*e.gridSize),"px"),te("ngStyle",ut(39,Yee,"rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),U(1),Ke("visibility",e.altitude>0?"visible":"hidden"),U(1),Ke("color",e.range.rangeColor)("text-shadow",e.textShadowCss),U(2),qe(e.elevation),U(1),Ke("color",e.range.rangeColor)("text-shadow",e.textShadowCss),U(2),qe(e.elevation),U(2),Ke("color",e.range.rangeColor)("text-shadow",e.textShadowCss),U(1),qe(e.math.abs(e.altitude)),U(1),Ke("color",e.range.rangeColor)("text-shadow",e.textShadowCss),U(1),qe(e.math.abs(e.altitude)),U(1),Ke("visibility",e.altitude<0?"visible":"hidden"),U(1),Ke("color",e.range.rangeColor)("text-shadow",e.textShadowCss),U(2),qe(e.elevation),U(1),Ke("color",e.range.rangeColor)("text-shadow",e.textShadowCss),U(2),qe(e.elevation)}}const Xee=function(n){return{"is-grab":n}},Qee=function(n){return{fall:n}};let Jee=(()=>{class n{constructor(e,i,r,s,o,c,m,I,Z,fe){this.ngZone=e,this.tabletopActionService=i,this.contextMenuService=r,this.elementRef=s,this.panelService=o,this.changeDetector=c,this.pointerDeviceService=m,this.coordinateService=I,this.tabletopService=Z,this.modalService=fe,this.range=null,this.is3D=!1,this.clipAreaCorn={clip01x:0,clip01y:0,clip02x:100,clip02y:0,clip03x:100,clip03y:100,clip04x:0,clip04y:100,clip05x:0,clip05y:0,clip06x:0,clip06y:0,clip07x:0,clip07y:0,clip08x:0,clip08y:0,clip09x:0,clip09y:0},this.gripAreaCorn={clip01x:0,clip01y:0,clip02x:100,clip02y:0,clip03x:100,clip03y:100,clip04x:0,clip04y:100,clip05x:0,clip05y:0,clip06x:0,clip06y:0,clip07x:0,clip07y:0,clip08x:0,clip08y:0,clip09x:0,clip09y:0},this.clipAreaLine={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.gripAreaLine={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.clipAreaSquare={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.gripAreaSquare={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.clipAreaDiamond={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.gripAreaDiamond={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.gridSize=50,this.movableOption={},this.rotableOption={},this.viewRotateZ=10,this.isMoving=!1,this.math=Math,this.input=null}get clipPathText(){let e="";switch(this.range.type){case"LINE":e=this.clipLine;break;case"CIRCLE":e=this.clipCircle;break;case"SQUARE":e=this.clipSquare;break;case"DIAMOND":e=this.clipDiamond;break;default:e=this.clipCorn}return e}get gripPathText(){let e="";switch(this.range.type){case"LINE":e=this.gripLine;break;case"CIRCLE":e=this.gripCircle;break;case"SQUARE":e=this.gripSquare;break;case"DIAMOND":e=this.gripDiamond;break;default:e=this.gripCorn}return e}get clipCircle(){return"circle("+(this.rangeLength+1.5)*this.gridSize+"px)"}get gripCircle(){return"circle("+(this.rangeLength>1?this.rangeLength:1)*this.gridSize+"px)"}get clipCorn(){return this.clipCornPath(this.clipAreaCorn)}get gripCorn(){return this.clipCornPath(this.gripAreaCorn)}clipCornPath(e){let i="polygon("+e.clip01x+"px "+e.clip01y+"px, ";return i+=e.clip02x+"px "+e.clip02y+"px, ",i+=e.clip03x+"px "+e.clip03y+"px, ",i+=e.clip04x+"px "+e.clip04y+"px, ",i+=e.clip05x+"px "+e.clip05y+"px, ",i+=e.clip06x+"px "+e.clip06y+"px, ",i+=e.clip07x+"px "+e.clip07y+"px, ",i+=e.clip08x+"px "+e.clip08y+"px, ",i+=e.clip09x+"px "+e.clip09y+"px)",i}get clipLine(){return this.clipLinePath(this.clipAreaLine)}get gripLine(){return this.clipLinePath(this.gripAreaLine)}clipLinePath(e){let i="polygon("+e.clip01x+"px "+e.clip01y+"px, ";return i+=e.clip02x+"px "+e.clip02y+"px, ",i+=e.clip03x+"px "+e.clip03y+"px, ",i+=e.clip04x+"px "+e.clip04y+"px)",i}get clipSquare(){return this.clipSquarePath(this.clipAreaSquare)}get gripSquare(){return this.clipSquarePath(this.gripAreaSquare)}clipSquarePath(e){let i="polygon("+e.clip01x+"px "+e.clip01y+"px, ";return i+=e.clip02x+"px "+e.clip02y+"px, ",i+=e.clip03x+"px "+e.clip03y+"px, ",i+=e.clip04x+"px "+e.clip04y+"px)",i}get clipDiamond(){return this.clipDiamondPath(this.clipAreaDiamond)}get gripDiamond(){return this.clipDiamondPath(this.gripAreaDiamond)}clipDiamondPath(e){let i="polygon("+e.clip01x+"px "+e.clip01y+"px, ";return i+=e.clip02x+"px "+e.clip02y+"px, ",i+=e.clip03x+"px "+e.clip03y+"px, ",i+=e.clip04x+"px "+e.clip04y+"px)",i}get gripLength(){return this.rangeLength>1?this.rangeLength:1}get gripWidth(){return"CIRCLE"==this.range.type||"SQUARE"==this.range.type||"DIAMOND"==this.range.type?this.gripLength:this.range.width>this.gripLength?this.range.width:this.gripLength}get tableSelecter(){return this.tabletopService.tableSelecter}get currentTable(){return this.tabletopService.currentTable}get name(){return this.range.name}get width(){return this.adjustMinBounds(this.range.width)}get length(){return this.adjustMinBounds(this.range.length)}get opacity(){return this.range.opacity}get imageFile(){return this.range.imageFile}get isLocked(){return this.range.isLocked}set isLocked(e){this.range.isLocked=e}get areaQuadrantSize(){let e=this.width<1?1:this.width,i=this.rangeLength<1?1:this.rangeLength;return Math.ceil(Math.sqrt(e*e+i*i))+1}get rotateDeg(){let e="0.0";return this.rotate&&this.rotate.nativeElement&&this.rotate.nativeElement.style&&this.rotate.nativeElement.style.transform?(e=this.rotate.nativeElement.style.transform.replace(/[^0-9\.\-]/g,""),e||(e="0.0"),parseFloat(e)):0}get altitude(){return this.range.altitude}set altitude(e){this.range.altitude=e}get elevation(){return+((this.range.posZ+this.altitude*this.gridSize)/this.gridSize).toFixed(1)}get isAltitudeIndicate(){return this.range.isAltitudeIndicate}set isAltitudeIndicate(e){this.range.isAltitudeIndicate=e}get textShadowCss(){return`${et.textShadowColor(this.range.rangeColor,"#f5f5f5")} 0px 0px 3px`}get followingCharactor(){return this.range.followingCharactor}set followingCharactor(e){this.range.followingCharactor=e}get dockableCharacters(){let e=this.tabletopService.characters.filter(i=>"table"===i.location.name&&!i.isHideIn&&[{x:0,y:0},{x:i.size*this.gridSize,y:0},{x:0,y:i.size*this.gridSize},{x:i.size*this.gridSize,y:i.size*this.gridSize}].some(r=>this.range.location.x-this.rangeLength*this.gridSize<=i.location.x+r.x&&i.location.x+r.x<=this.range.location.x+this.rangeLength*this.gridSize&&this.range.location.y-this.rangeLength*this.gridSize<=i.location.y+r.y&&i.location.y+r.y<=this.range.location.y+this.rangeLength*this.gridSize));return this.followingCharactor&&!e.some(i=>i===this.followingCharactor)&&e.push(this.followingCharactor),e.sort((i,r)=>i.name.localeCompare(r.name,"ja"))}get rangeLength(){let e=this.length<1?1:this.length;return this.followingCharactor&&this.range.isExpandByFollowing&&(e+=this.followingCharactor.size/2),e}get rotateHandlesLeftPos(){let e=[];for(let i=1;i<Math.ceil(this.rangeLength/6);i++)e.push(this.rangeLength*i/Math.ceil(this.rangeLength/6));return e.push(this.rangeLength),e}ngOnInit(){Fe.register(this).on("UPDATE_GAME_OBJECT",-1e3,e=>{let i=lt.instance.get(e.data.identifier);if(!this.range||!i)return;let r=!1;(this.range===i||i instanceof zn&&this.range.contains(i))&&(this.ngZone.run(()=>{this.setRange()}),r=!0),this.followingCharactor&&(i.identifier===this.followingCharactor.identifier||i instanceof zn&&this.followingCharactor.contains(i))&&(this.ngZone.run(()=>{this.range.following(),this.setRange()}),r=!0),r&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",-1e3,e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.range,transformCssOffset:"translateZ(0.25px)",colideLayers:["terrain","text-note"]},this.rotableOption={tabletopObject:this.range},this.setRange()}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new Ls(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this),this.setRange(),queueMicrotask(()=>{this.changeDetector.markForCheck()})}ngOnDestroy(){this.input.destroy(),Fe.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLocked&&Fe.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate(),s=[];if(s.push(this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,dt.play(Ze.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,dt.play(Ze.lock)}}),s.push({name:"\u5f71\u97ff\u30b0\u30ea\u30c3\u30c9\u306e\u5224\u5b9a\u65b9\u6cd5",action:null,subActions:[{name:(0==this.range.fillType?"\u25c9":"\u25cb")+" \u5224\u5b9a\u306a\u3057 (\u8f2a\u90ed\u5185\u3092\u5857\u308a\u3064\u3076\u3059)",action:()=>{this.range.fillType=0}},Tt,{name:(1==this.range.fillType?"\u25c9":"\u25cb")+" \u30b0\u30ea\u30c3\u30c9\u306e\u4e2d\u5fc3\u3092\u8986\u3046",action:()=>{this.range.fillType=1}},{name:(2==this.range.fillType?"\u25c9":"\u25cb")+" \u30b0\u30ea\u30c3\u30c9\u306e\u4e00\u90e8\u3067\u3082\u8986\u3046",action:()=>{this.range.fillType=2}},{name:(3==this.range.fillType?"\u25c9":"\u25cb")+" \u30b0\u30ea\u30c3\u30c9\u306e\u534a\u5206\u4ee5\u4e0a\u3092\u8986\u3046",action:()=>{this.range.fillType=3}},{name:(4==this.range.fillType?"\u25c9":"\u25cb")+" \u30b0\u30ea\u30c3\u30c9\u5168\u4f53\u3092\u8986\u3046",action:()=>{this.range.fillType=4}}]}),s.push(Tt),"CIRCLE"==this.range.type||"SQUARE"==this.range.type||"DIAMOND"==this.range.type){let o=this.dockableCharacters.length<=0?this.followingCharactor?[]:[{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c\u3044\u307e\u305b\u3093",action:null,disabled:!0,center:!0}]:this.dockableCharacters.map(c=>({name:`${this.followingCharactor&&this.followingCharactor.identifier===c.identifier?"\u25c9":"\u25cb"} ${c.name}`,action:()=>{this.followingCharactor=c,this.ngZone.run(()=>{this.range.following()}),dt.play(Ze.lock)}}));0!=o.length&&o.push(Tt),o.push({name:"\u8ffd\u5f93\u3092\u89e3\u9664\u3059\u308b",action:()=>{dt.play(Ze.unlock),this.followingCharactor=null},disabled:!this.followingCharactor}),s.push({name:"\u4ed8\u8fd1\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u8ffd\u5f93",action:null,subActions:o}),s.push(this.range.isExpandByFollowing?{name:"\u2611 \u8ffd\u5f93\u6642\u30b5\u30a4\u30ba\u306b\u5408\u308f\u305b\u3066\u62e1\u5927",action:()=>{this.range.isExpandByFollowing=!1}}:{name:"\u2610 \u8ffd\u5f93\u6642\u30b5\u30a4\u30ba\u306b\u5408\u308f\u305b\u3066\u62e1\u5927",action:()=>{this.range.isExpandByFollowing=!0}}),s.push(this.range.isFollowAltitude?{name:"\u2611 \u9ad8\u5ea6\u306b\u3082\u8ffd\u5f93",action:()=>{this.range.isFollowAltitude=!1}}:{name:"\u2610 \u9ad8\u5ea6\u306b\u3082\u8ffd\u5f93",action:()=>{this.range.isFollowAltitude=!0,this.followingCharactor&&this.range.following()}})}else s.push(this.range.subDivisionSnapPolygonal?{name:"\u2611 \u7d30\u304b\u3044\u89d2\u5ea6\u3067\u56de\u8ee2",action:()=>{this.range.subDivisionSnapPolygonal=!1}}:{name:"\u2610 \u7d30\u304b\u3044\u89d2\u5ea6\u3067\u56de\u8ee2",action:()=>{this.range.subDivisionSnapPolygonal=!0}});s.push(this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0}}),s.push({name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,dt.play(Ze.sweep))},altitudeHande:this.range}),s.push(Tt),s.push({name:"\u5c04\u7a0b\u30fb\u7bc4\u56f2\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.range)}}),this.range.getUrls().length>0&&(s.push({name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.range.getUrls().map(o=>{const c=o.value.toString();return{name:o.name?o.name:c,action:()=>{et.sameOrigin(c)?window.open(c.trim(),"_blank","noopener"):this.modalService.open(Hr,{url:c,title:this.range.name,subTitle:o.name})},disabled:!et.validUrl(c),error:et.validUrl(c)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:et.validUrl(c)&&!et.sameOrigin(c)}})}),s.push(Tt)),s.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let o=this.range.clone();console.log("\u30b3\u30d4\u30fc",o),o.location.x+=this.gridSize,o.location.y+=this.gridSize,o.isLocked=!1,o.followingCharctorIdentifier=null,this.range.parent&&this.range.parent.appendChild(o),dt.play(Ze.cardPut)}}),s.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.range.destroy(),dt.play(Ze.sweep)}}),s.push(Tt),s.push({name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(r)}),this.contextMenuService.open(i,s,this.name)}onMove(){this.isMoving=!0,dt.play(Ze.cardPick)}onMoved(){this.isMoving=!1,dt.play(Ze.cardPut)}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u5c04\u7a0b\u30fb\u7bc4\u56f2\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Gs,{title:r,left:i.x-200,top:i.y-150,width:400,height:390}).tabletopObject=e}setRange(){let e=new pf(this.gridCanvas.nativeElement,this.rangeCanvas.nativeElement,this.centerPunch.nativeElement),i={areaWidth:2*this.areaQuadrantSize,areaHeight:2*this.areaQuadrantSize,range:this.rangeLength,width:this.width<.1?.1:this.width,centerX:this.range.location.x,centerY:this.range.location.y,gridSize:this.gridSize,type:this.range.type,gridColor:this.range.gridColor,rangeColor:this.range.rangeColor,fanDegree:0,degree:this.rotateDeg,offSetX:this.range.offSetX,offSetY:this.range.offSetY,gridType:this.currentTable.gridType,isDocking:!!this.followingCharactor,fillType:this.range.fillType};switch(this.range.type){case"LINE":this.clipAreaLine=e.renderLine(i),this.gripAreaLine=pf.gripAreaPathLine(i);break;case"CIRCLE":e.renderCircle(i);break;case"SQUARE":this.clipAreaSquare=e.renderSquare(i),this.gripAreaSquare=pf.gripAreaPathSquare(i);break;case"DIAMOND":this.clipAreaDiamond=e.renderDiamond(i),this.gripAreaDiamond=pf.gripAreaPathDiamond(i);break;default:this.clipAreaCorn=e.renderCorn(i),this.gripAreaCorn=pf.gripAreaPathCorn(i)}this.gridCanvas.nativeElement.style.opacity=this.range.opacity+""}}return n.\u0275fac=function(e){return new(e||n)(Le(vn),Le(mg),Le(sr),Le(_i),Le(In),Le(Di),Le(ai),Le(Ja),Le(vu),Le(kn))},n.\u0275cmp=Zt({type:n,selectors:[["range"]],viewQuery:function(e,i){if(1&e&&(on(Hee,7),on(Uee,7),on(Vee,7),on(Gee,5)),2&e){let r;sn(r=an())&&(i.gridCanvas=r.first),sn(r=an())&&(i.rangeCanvas=r.first),sn(r=an())&&(i.centerPunch=r.first),sn(r=an())&&(i.rotate=r.first)}},hostBindings:function(e,i){1&e&&Te("dragstart",function(s){return i.onDragstart(s)})("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{range:"range",is3D:"is3D"},decls:19,vars:48,consts:[["appMovable","",1,"component","is-3d",2,"pointer-events","none",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],[1,"is-3d",3,"ngClass"],[1,"is-3d",2,"position","absolute"],[1,"is-fill",2,"position","absolute","pointer-events","auto","top","-100%"],[1,"is-3d",2,"position","absolute","pointer-events","none"],[1,"is-3d",2,"position","absolute","z-index","0"],[1,"is-fill","is-3d"],["gridCanvas",""],["rangeCanvas",""],["appRotable","",1,"component-content","is-3d",2,"transform","rotateZ(0deg)",3,"rotable.option","rotable.polygonal","rotable.disable","rotable.ondragstart","rotable.ondragend"],["rotate",""],["class","is-3d","class","lock-icon is-center",4,"ngIf"],[4,"ngIf"],["class","is-3d","style","display: flex; flex-flow: column nowrap; justify-content: space-between; border-left: 2px dashed black; transform-origin: top left",3,"border-left-color","height","ngStyle",4,"ngIf"],["centerPunch",""],[1,"lock-icon","is-center"],[1,"material-icons"],[1,"is-3d",2,"position","absolute","width","28px","pointer-events","auto"],[4,"ngFor","ngForOf"],[1,"rotate-grab","of-corn-bottom","rotate-grab-icon","is-3d","will-change"],[1,"rotate-grab","of-corn-top","rotate-grab-icon","is-3d","will-change"],[1,"rotate-grab","of-corn-tip","rotate-grab-icon","is-3d","will-change",2,"position","absolute"],[1,"is-3d",2,"display","flex","flex-flow","column nowrap","justify-content","space-between","border-left","2px dashed black","transform-origin","top left",3,"ngStyle"],[1,"is-3d"],[1,"elevation-indicator","is-3d",2,"position","absolute"],[1,"elevation-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"]],template:function(e,i){1&e&&(K(0,"div",0),Te("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),K(1,"div",1)(2,"div",2),it(3,"div",3),J(),K(4,"div",4)(5,"div",5),it(6,"canvas",6,7),J(),K(8,"div",2),it(9,"canvas",6,8),J(),K(11,"div",9,10),Te("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),xe(13,qee,3,1,"div",11),xe(14,Kee,9,3,"ng-container",12),J()()(),xe(15,Zee,20,41,"div",13),K(16,"div",5),it(17,"canvas",6,14),J()()),2&e&&(te("ngClass",ut(44,Xee,!i.isLocked))("movable.option",i.movableOption)("movable.disable",i.isLocked),U(1),Ke("transform","translateZ("+i.altitude*i.gridSize+"px)"),te("ngClass",ut(46,Qee,0==i.altitude)),U(1),Ke("clip-path",i.gripPathText),U(1),Ke("left",1.5*-i.gripLength*i.gridSize,"px")("width",3*i.gripLength*i.gridSize,"px")("height",3*i.gripWidth*i.gridSize,"px"),U(1),Ke("width",0,"px")("height",0,"px")("clip-path",i.clipPathText),U(1),Ke("top",0,"px")("left",-1*i.areaQuadrantSize*i.gridSize,"px"),U(3),Ke("z-index",i.isMoving?5:0)("top",0,"px")("left",-1*i.areaQuadrantSize*i.gridSize,"px"),U(3),Ke("opacity",i.isMoving?.7:1),te("rotable.option",i.rotableOption)("rotable.polygonal",i.range.subDivisionSnapPolygonal?360:24)("rotable.disable",i.isLocked),U(2),te("ngIf","CIRCLE"==i.range.type||"SQUARE"==i.range.type||"DIAMOND"==i.range.type),U(1),te("ngIf","CIRCLE"!=i.range.type&&"SQUARE"!=i.range.type&&"DIAMOND"!=i.range.type),U(1),te("ngIf",i.isAltitudeIndicate&&(i.altitude<=-.5||.5<=i.altitude)),U(1),Ke("visibility",0!=i.altitude?"visible":"hidden")("top",0,"px")("left",-1*i.areaQuadrantSize*i.gridSize,"px"))},directives:[il,Wn,Ql,_n,ei,Zi],styles:[".is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.image[_ngcontent-%COMP%]{display:block}.lock-icon[_ngcontent-%COMP%]{background-color:#ccc;border-radius:100%;color:#444;width:25px;height:25px;visibility:hidden}.component[_ngcontent-%COMP%]:hover   .lock-icon[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .lock-icon[_ngcontent-%COMP%]{visibility:visible}.is-center[_ngcontent-%COMP%]{position:absolute;top:-12.5px;left:-12.5px;margin:auto}.border[_ngcontent-%COMP%]{box-sizing:border-box;border:solid 2px #CCCCCC}.is-fit-full[_ngcontent-%COMP%]{height:100%;width:100%}.pedestal-grab-corn[_ngcontent-%COMP%]{z-index:-1;position:absolute;top:-14px;left:-14px;right:14px;bottom:-14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;position:absolute;top:-14px;left:-14px;right:-14px;bottom:-14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:1}.rotate-grab[_ngcontent-%COMP%]{opacity:0;z-index:-1}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:30px;height:30px;box-sizing:border-box;border:solid 2px #CCCCCC;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:0;background-color:#ccc;border-radius:100%;color:#444;font-size:24px;transform-style:preserve-3d;transform:translateZ(.1px)}.will-change[_ngcontent-%COMP%]{will-change:opacity}.of-corn-top[_ngcontent-%COMP%]{top:-30px;left:-15px;border-radius:15px 15px 0 0}.of-corn-bottom[_ngcontent-%COMP%]{bottom:-30px;left:-15px;border-radius:0 0 15px 15px}.of-corn-tip[_ngcontent-%COMP%]{top:-15px;left:-15px;border-radius:15px}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px;border-radius:14px 7px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px;border-radius:7px 14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px;border-radius:14px 7px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px;border-radius:7px 14px}.is-fill[_ngcontent-%COMP%]{display:block;position:absolute;top:0;left:0;bottom:0;right:0;margin:auto}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.fall[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.altitude-indicator[_ngcontent-%COMP%]{font-size:10px}.elevation-indicator[_ngcontent-%COMP%], .altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;color:#000;text-shadow:whitesmoke 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.elevation-indicator[_ngcontent-%COMP%]{font-weight:bolder;font-size:12px}"],changeDetection:0}),n})();function ete(n,t){1&n&&(Ve(0),K(1,"div",20)(2,"div",21)(3,"div",22),be(4,"autorenew"),J(),K(5,"div",23),be(6,"autorenew"),J()()(),Ge())}function tte(n,t){1&n&&(K(0,"i",24),be(1,"lock"),J())}function nte(n,t){1&n&&(K(0,"span"),be(1,"\uff1a"),J())}function ite(n,t){if(1&n&&(K(0,"span"),be(1),J()),2&n){const e=ge();U(1),qe(e.face)}}function rte(n,t){1&n&&(K(0,"span"),be(1,"???"),J())}function ste(n,t){1&n&&(K(0,"i",24),be(1,"lock"),J())}function ote(n,t){1&n&&(K(0,"span"),be(1,"\uff1a"),J())}function ate(n,t){if(1&n&&(K(0,"span"),be(1),J()),2&n){const e=ge();U(1),qe(e.face)}}function lte(n,t){1&n&&(K(0,"span"),be(1,"???"),J())}const cte=function(n,t){return{"background-color":n,transform:t}};function ute(n,t){if(1&n&&(K(0,"div",25)(1,"div",26)(2,"b"),be(3),J()(),K(4,"div",27)(5,"b"),be(6),J()()()),2&n){const e=ge();te("ngStyle",Kt(3,cte,e.ownerColor+"dd","translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateX("+e.nameTagRotate+"deg)")),U(3),qe(e.ownerName),U(3),qe(e.ownerName)}}const mS=function(n,t){return{"is-black-mask":n,"is-harf-black-mask":t}};function dte(n,t){if(1&n&&(it(0,"img",28),Ct(1,"safe")),2&n){const e=ge();te("src",xt(1,2,e.imageFile.url,"resourceUrl"),Jt)("ngClass",Kt(5,mS,!e.isVisible,e.isMine||e.isGMMode&&e.hasOwner))}}function fte(n,t){if(1&n&&(it(0,"img",29),Ct(1,"safe")),2&n){const e=ge();te("src",xt(1,2,e.backFaceImageFile.url,"resourceUrl"),Jt)("ngClass",Kt(5,mS,!e.isVisible,e.isMine||e.isGMMode&&e.hasOwner||e.isVisible&&e.isCoin))}}function hte(n,t){1&n&&(it(0,"img",30),Ct(1,"safe")),2&n&&te("src",xt(1,1,ge().imageFile.url,"resourceUrl"),Jt)}function pte(n,t){if(1&n&&(it(0,"img",30),Ct(1,"safe")),2&n){const e=ge();Ke("transform",e.isCoin?"scaleX(-1)":"scaleX(-1) scaleY(-1)"),te("src",xt(1,3,e.backFaceImageFile.url,"resourceUrl"),Jt)}}const gte=function(n){return{"is-gray-border":n}},mte=function(n){return{transform:n}};let _te=(()=>{class n{constructor(e,i,r,s,o,c,m,I,Z){this.ngZone=e,this.panelService=i,this.contextMenuService=r,this.elementRef=s,this.changeDetector=o,this.pointerDeviceService=c,this.imageService=m,this.modalService=I,this.chatMessageService=Z,this.diceSymbol=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null,this.viewRotateX=50,this.viewRotateZ=10}get face(){return this.diceSymbol.face}set face(e){this.diceSymbol.face=e}get owner(){return this.diceSymbol.owner}set owner(e){this.diceSymbol.owner=e}get rotate(){return this.diceSymbol.rotate}set rotate(e){this.diceSymbol.rotate=e}get name(){return this.diceSymbol.name}set name(e){this.diceSymbol.name=e}get size(){return this.adjustMinBounds(this.diceSymbol.size)}get faces(){return this.diceSymbol.faces}get nothingFaces(){return this.diceSymbol.nothingFaces}get imageFile(){return this.imageService.getEmptyOr(this.diceSymbol.imageFile)}get backFaceImageFile(){return this.imageService.getEmptyOr(this.diceSymbol.backFaceImageFile)}get isGMMode(){return this.diceSymbol.isGMMode}get isMine(){return this.diceSymbol.isMine}get hasOwner(){return this.diceSymbol.hasOwner}get ownerName(){return this.diceSymbol.ownerName}get ownerColor(){return this.diceSymbol.ownerColor}get isVisible(){return this.diceSymbol.isVisible}get isDropShadow(){return this.diceSymbol.isDropShadow}set isDropShadow(e){this.diceSymbol.isDropShadow=e}get isLock(){return this.diceSymbol.isLock}set isLock(e){this.diceSymbol.isLock=e}get isCoin(){return this.diceSymbol.isCoin}get isIconHidden(){return null!=this.iconHiddenTimer}get nameTagRotate(){let e=this.viewRotateX%360-90,i=(this.viewRotateZ+this.rotate)%360;return i=i>0?i:360+i,(e>0?e:360+e)*(this.isFlip?1:-1)}get isFlip(){let e=(this.viewRotateZ+this.rotate)%360;return e=e>0?e:360+e,90<e&&e<270}ngOnInit(){Fe.register(this).on("ROLL_DICE_SYMBOL",e=>{e.data.identifier===this.diceSymbol.identifier&&this.ngZone.run(()=>{this.animeState="inactive",this.changeDetector.markForCheck(),queueMicrotask(()=>{this.animeState="active",this.changeDetector.markForCheck()})})}).on("UPDATE_GAME_OBJECT",e=>{let i=lt.instance.get(e.data.identifier);!this.diceSymbol||!i||(this.diceSymbol===i||i instanceof zn&&this.diceSymbol.contains(i)||i instanceof Ue&&i.userId===this.diceSymbol.owner)&&this.changeDetector.markForCheck()}).on("DICE_ALL_OPEN",e=>{this.owner&&!this.isLock&&(this.owner="",dt.play(Ze.unlock),this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u306e${this.isCoin?"\u8868\uff0f\u88cf":"\u76ee"}\u3092\u516c\u958b \u2192 ${this.face}`))}).on("TABLE_VIEW_ROTATE",e=>{this.ngZone.run(()=>{this.viewRotateX=e.data.x,this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=Ue.findByPeerId(e.data.peerId);(!i||this.diceSymbol.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.diceSymbol,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain","text-note","character"]},this.rotableOption={tabletopObject:this.diceSymbol}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new Ls(this.elementRef.nativeElement)}),this.input.onStart=e=>this.ngZone.run(()=>this.onInputStart(e))}ngOnDestroy(){this.input.destroy(),Fe.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onInputStart(e){this.startDoubleClickTimer(e),this.startIconHiddenTimer()}startDoubleClickTimer(e){if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(()=>this.stopDoubleClickTimer(),e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}stopDoubleClickTimer(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}onDoubleClick(){this.stopDoubleClickTimer(),(this.doubleClickPoint.x-this.input.pointer.x)**2+(this.doubleClickPoint.y-this.input.pointer.y)**2<100&&this.isVisible&&this.diceRoll()}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];if(r.push({name:this.isCoin?"\u30b3\u30a4\u30f3\u30c8\u30b9":"\u30c0\u30a4\u30b9\u3092\u632f\u308b",action:()=>{this.diceRoll()},disabled:!this.isVisible,default:this.isVisible}),r.push(Tt),(this.isMine||this.hasOwner)&&r.push({name:(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+"\u3092\u516c\u958b",action:()=>{this.owner="",dt.play(Ze.unlock),this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u306e${this.isCoin?"\u8868\uff0f\u88cf":"\u76ee"}\u3092\u516c\u958b \u2192 ${this.face}`)}}),this.isMine||r.push({name:"\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{this.owner=yt.peerContext.userId,this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u3092\u81ea\u5206\u3060\u3051\u898b\u305f`),dt.play(Ze.lock)}}),r.push(this.isLock?{name:"\u2611 \u4e00\u6589\u516c\u958b\u3057\u306a\u3044",action:()=>{this.isLock=!1,dt.play(Ze.unlock)},disabled:this.hasOwner&&!this.isVisible}:{name:"\u2610 \u4e00\u6589\u516c\u958b\u3057\u306a\u3044",action:()=>{this.isLock=!0,dt.play(Ze.lock)},disabled:this.hasOwner&&!this.isVisible}),this.isVisible){let s=[],o=this.nothingFaces;o.length>0&&(o.forEach(c=>{s.push({name:`${this.face==c?"\u25c9":"\u25cb"} ${c}\u3000`,action:()=>{dt.play(Ze.dicePut),this.face=c}})}),s.push(Tt)),this.faces.forEach(c=>{s.push({name:`${this.face==c?"\u25c9":"\u25cb"} ${c}\u3000`,action:()=>{""===this.owner&&dt.play(Ze.dicePut),""===this.owner&&this.face!=c&&this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u306e${this.isCoin?"\u8868\uff0f\u88cf":"\u76ee"}\u3092\u5909\u66f4 \u2192 ${c}`),this.face=c}})}),r.push({name:this.isCoin?"\u8868\uff0f\u88cf":"\u30c0\u30a4\u30b9\u76ee",action:null,subActions:s})}r.push(Tt),r.push(this.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!1}}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!0}}),r.push(Tt),r.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.diceSymbol)}}),this.diceSymbol.getUrls().length>0&&(r.push({name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.diceSymbol.getUrls().map(s=>{const o=s.value.toString();return{name:s.name?s.name:o,action:()=>{et.sameOrigin(o)?window.open(o.trim(),"_blank","noopener"):this.modalService.open(Hr,{url:o,title:this.diceSymbol.name,subTitle:s.name})},disabled:!et.validUrl(o),error:et.validUrl(o)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:et.validUrl(o)&&!et.sameOrigin(o)}})}),r.push(Tt)),r.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let s=this.diceSymbol.clone();s.location.x+=this.gridSize,s.location.y+=this.gridSize,s.update(),dt.play(Ze.dicePut)}}),r.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.diceSymbol.destroy(),dt.play(Ze.sweep)}}),this.contextMenuService.open(i,r,this.name)}onMove(){dt.play(Ze.dicePick)}onMoved(){dt.play(Ze.dicePut)}diceRoll(){Fe.call("ROLL_DICE_SYMBOL",{identifier:this.diceSymbol.identifier}),dt.play(this.isCoin?Ze.coinToss:Ze.diceRoll1);let e=this.diceSymbol.diceRoll(),i=`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u3092${this.isCoin?"\u30c8\u30b9\u3057\u305f":"\u632f\u3063\u305f"}`;return""===this.owner&&(i+=` \u2192 ${e}`),this.chatMessageService.sendOperationLog(i),e}showDetail(e){Fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Gs,{title:r,left:i.x-300,top:i.y-300,width:600,height:490}).tabletopObject=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}adjustMinBounds(e,i=0){return e<i?i:e}}return n.\u0275fac=function(e){return new(e||n)(Le(vn),Le(In),Le(sr),Le(_i),Le(Di),Le(ai),Le(wu),Le(kn),Le(Er))},n.\u0275cmp=Zt({type:n,selectors:[["dice-symbol"]],hostBindings:function(e,i){1&e&&Te("dragstart",function(s){return i.onDragstart(s)})("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{diceSymbol:"diceSymbol",is3D:"is3D"},decls:31,vars:48,consts:[["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.option","movable.ondragstart","movable.ondragend"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[1,"pedestal-inner",3,"ngClass"],[1,"pedestal-outer"],[4,"ngIf"],[1,"upright-transform","is-fit-width","is-3d"],[1,"rotate-frame","is-3d"],[1,"rotate-inner","is-3d"],[1,"is-3d",3,"ngStyle"],[1,"name-tag","is-nowrap","is-black-background","is-3d",2,"transform","translateX(-50%)"],[1,"fornt-tag","is-3d"],["class","material-icons lock-icon",4,"ngIf"],[1,"back-tag","is-3d"],["class","owner-tag is-nowrap is-black-background is-3d",3,"ngStyle",4,"ngIf"],["class","image front-face is-3d chrome-smooth-image-trick",3,"src","ngClass",4,"ngIf"],["class","image back-face is-3d chrome-smooth-image-trick","style","transform: rotateY(-180deg)",3,"src","ngClass",4,"ngIf"],[1,"is-3d",2,"position","relative","top","-20%"],["class","image shadow is-3d","style","opacity: 0.7; filter: brightness(0) blur(1px)",3,"src",4,"ngIf"],["class","image shadow is-3d","style","opacity: 0.7; filter: brightness(0) blur(1px)",3,"src","transform",4,"ngIf"],[1,"pedestal-grab","rotate-grab","is-3d"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"material-icons","lock-icon"],[1,"owner-tag","is-nowrap","is-black-background","is-3d",3,"ngStyle"],[1,"fornt-tag","is-3d",2,"color","whitesmoke"],[1,"back-tag","is-3d",2,"color","whitesmoke"],[1,"image","front-face","is-3d","chrome-smooth-image-trick",3,"src","ngClass"],[1,"image","back-face","is-3d","chrome-smooth-image-trick",2,"transform","rotateY(-180deg)",3,"src","ngClass"],[1,"image","shadow","is-3d",2,"opacity","0.7","filter","brightness(0) blur(1px)",3,"src"]],template:function(e,i){1&e&&(K(0,"div",0),Te("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),K(1,"div",1)(2,"div",2),Te("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),it(3,"div",3)(4,"div",4),xe(5,ete,7,0,"ng-container",5),K(6,"div",1)(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"div",10),Te("@diceRollNameTag.done",function(s){return i.animationShuffleDone(s)}),K(12,"div",11),xe(13,tte,2,0,"i",12),be(14),xe(15,nte,2,0,"span",5),xe(16,ite,2,1,"span",5),xe(17,rte,2,0,"span",5),J(),K(18,"div",13),xe(19,ste,2,0,"i",12),be(20),xe(21,ote,2,0,"span",5),xe(22,ate,2,1,"span",5),xe(23,lte,2,0,"span",5),J()()(),xe(24,ute,7,6,"div",14),K(25,"div",1),Te("@diceRoll.done",function(s){return i.animationShuffleDone(s)})("@coinFlip.done",function(s){return i.animationShuffleDone(s)}),xe(26,dte,2,8,"img",15),xe(27,fte,2,8,"img",16),J()()()(),K(28,"div",17),Te("@diceRoll.done",function(s){return i.animationShuffleDone(s)}),xe(29,hte,2,4,"img",18),xe(30,pte,2,6,"img",19),J()()()()()),2&e&&(Ke("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),te("movable.option",i.movableOption),U(1),te("@bounceInOut","in"),U(1),te("rotable.option",i.rotableOption),U(1),te("ngClass",ut(44,gte,i.hasOwner)),U(2),te("ngIf",!i.isIconHidden),U(3),Ke("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),U(2),te("ngStyle",ut(46,mte,"translateX("+i.size*i.gridSize/2+"px) rotateX("+i.nameTagRotate+"deg)")),U(1),te("@changeFaceNameTag",i.isVisible?i.face:null)("@diceRollNameTag",i.animeState),U(2),te("ngIf",i.isLock&&i.hasOwner),U(1),qe(i.name),U(1),te("ngIf",0<i.name.length),U(1),te("ngIf",i.isVisible),U(1),te("ngIf",!i.isVisible),U(2),te("ngIf",i.isLock&&i.hasOwner),U(1),qe(i.name),U(1),te("ngIf",0<i.name.length),U(1),te("ngIf",i.isVisible),U(1),te("ngIf",!i.isVisible),U(1),te("ngIf",i.hasOwner&&0<i.ownerName.length),U(1),Ke("transform",i.isCoin?"rotateX(30deg)":""),te("@changeFace",!i.isCoin&&i.isVisible?i.face:null)("@changeFaceCoin",i.isCoin&&i.isVisible?"\u88cf"==i.face?0:1:null)("@diceRoll",!i.isCoin&&i.animeState)("@coinFlip",i.isCoin&&i.animeState),U(1),te("ngIf",0<i.imageFile.url.length),U(1),te("ngIf",0<i.backFaceImageFile.url.length),U(1),Ke("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),te("@changeFace",!i.isCoin&&i.isVisible?i.face:null)("@changeFaceCoin",i.isCoin&&i.isVisible?"\u8868"==i.face?1:2:null)("@diceRoll",i.animeState),U(1),te("ngIf",!i.isFlip&&i.isDropShadow&&0<i.imageFile.url.length),U(1),te("ngIf",i.isFlip&&i.isDropShadow&&0<i.backFaceImageFile.url.length))},directives:[il,Ql,Wn,_n,Zi],pipes:[ti],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:100%;box-sizing:border-box;border-top:solid 28px #999;border-left:solid 12px #999;border-right:solid 12px #CCC;border-bottom:solid 28px #CCC;border-radius:22px}.pedestal-inner[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 6px rgb(216,139,75);border-radius:5px}.is-gray-border[_ngcontent-%COMP%]{border-color:#999}.pedestal-outer[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 2px #212121;border-radius:5px}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{bottom:0;left:0;right:0;margin:auto;width:100%;height:auto;vertical-align:bottom}.image.shadow[_ngcontent-%COMP%]{width:100%;height:100%}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:6px;position:absolute;top:-30px;transform-origin:center bottom}.owner-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:12px;padding:3px 9px;border-radius:6px;position:absolute;top:-55px;transform-origin:center bottom}.rotate-frame[_ngcontent-%COMP%]{bottom:0;left:0;right:0}.rotate-inner[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;width:100%;height:auto}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.fornt-tag[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.back-tag[_ngcontent-%COMP%]{position:absolute;top:3px;-webkit-backface-visibility:hidden;backface-visibility:hidden;transform:rotateY(-180deg)}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;bottom:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{position:absolute;width:24px;top:0;left:0;right:0;margin:auto;color:#444}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.material-icons.lock-icon[_ngcontent-%COMP%]{display:inline-block;font-size:smaller;margin-right:2px}.front-face[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.back-face[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;transform:rotateY(-180deg)}"],data:{animation:[xn("diceRoll",[Bt("* => active",[Ft("800ms ease",nn([Ye({transform:"scale3d(0.8, 0.8, 0.8) rotateZ(-0deg)",offset:0}),Ye({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(-360deg)",offset:.5}),Ye({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(-520deg)",offset:.75}),Ye({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(-630deg)",offset:.875}),Ye({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(-720deg)",offset:1})]))])]),xn("coinFlip",[Bt("* => active",[Ft("800ms ease-out",nn([Ye({transform:"scale3d(0.8, 0.8, 0.8) translateY(0%) rotateX(60deg) rotateX(-0deg) rotateY(-0deg)",offset:0}),Ye({transform:"scale3d(1.2, 1.2, 1.2)  translateY(-28%) rotateX(60deg) rotateX(-360deg) rotateY(-360deg)",offset:.5}),Ye({transform:"scale3d(0.75, 0.75, 0.75) translateY(-40%) rotateX(60deg) rotateX(-520deg) rotateY(-520deg)",offset:.75}),Ye({transform:"scale3d(1.125, 1.125, 1.125) translateY(-28%) rotateX(60deg) rotateX(-630deg) rotateY(-630deg)",offset:.875}),Ye({transform:"scale3d(1.0, 1.0, 1.0) translateY(0%) rotateX(60deg) rotateX(-720deg) rotateY(-720deg)",offset:1})]))])]),xn("diceRollNameTag",[Bt("* => active",[Ft("800ms ease",nn([Ye({transform:"translateX(-50%) scale3d(0.8, 0.8, 0.8) rotateY(0deg)",offset:0}),Ye({transform:"translateX(-50%) scale3d(1.2, 1.2, 1.2) rotateY(360deg)",offset:.5}),Ye({transform:"translateX(-50%) scale3d(0.75, 0.75, 0.75) rotateY(520deg)",offset:.75}),Ye({transform:"translateX(-50%) scale3d(1.125, 1.125, 1.125) rotateY(630deg)",offset:.875}),Ye({transform:"translateX(-50%) scale3d(1.0, 1.0, 1.0) rotateY(720deg)",offset:1})]))])]),xn("changeFace",[Bt(":increment,:decrement",[Ft("200ms ease",nn([Ye({transform:"scale3d(0.8, 0.8, 0.8) rotateZ(0deg)",offset:0}),Ye({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(-360deg)",offset:1})]))])]),xn("changeFaceCoin",[Bt(":increment,:decrement",[Ft("200ms ease",nn([Ye({transform:"scale3d(0.8, 0.8, 0.8) rotateX(0deg)",offset:0}),Ye({transform:"scale3d(1.0, 1.0, 1.0) rotateX(-720deg)",offset:1})]))])]),xn("changeFaceNameTag",[Bt(":increment,:decrement",[Ft("200ms ease",nn([Ye({transform:"translateX(-50%) scale3d(0.8, 0.8, 0.8) rotateY(0deg)",offset:0}),Ye({transform:"translateX(-50%) scale3d(1.0, 1.0, 1.0) rotateY(360deg)",offset:1})]))])]),xn("bounceInOut",[Bt("void => *",[Ft("600ms ease",nn([Ye({transform:"scale3d(0, 0, 0)",offset:0}),Ye({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),Ye({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),Ye({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),Ye({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Bt("* => void",[Ft(100,Ye({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),n})();const $te=["characterImage"],vte=["chatBubble"],bte=function(n){return{opacity:n}};function yte(n,t){if(1&n&&(it(0,"img",31),Ct(1,"safe")),2&n){const e=ge();Ke("height",e.characterShadowImageHeight,"px")("filter","brightness(0) blur(1px)"+(e.isHideIn?" invert(85%)":"")),te("src",xt(1,7,0<e.shadowImageFile.url.length?e.shadowImageFile.url:e.imageFile.url,"resourceUrl"),Jt)("ngStyle",ut(10,bte,(e.isHollow?.5:.7)*(e.isHideIn?.85:1)))("@switchImageShadow",e.gameCharacter.currntImageIndex)}}const Cte=function(n,t){return{"background-color":n,transform:t}};function xte(n,t){if(1&n&&(K(0,"div",32)(1,"div",33)(2,"b"),be(3),J()(),K(4,"div",34)(5,"b"),be(6),J()()()),2&n){const e=ge();te("ngStyle",Kt(3,Cte,e.ownerColor+"dd","translateX(-50%) translateX("+e.size*e.gridSize/2+"px) translateY(6px) rotateX("+e.nameTagRotate+"deg)")),U(3),qe(e.ownerName),U(3),qe(e.ownerName)}}const wte=function(n){return{"is-hide-in-tag":n}},gf=function(n){return{transform:n}};function Ete(n,t){if(1&n&&(K(0,"div",35)(1,"div",36),be(2),J(),K(3,"div",37),be(4),J()()),2&n){const e=ge();te("ngClass",ut(4,wte,e.isHideIn))("ngStyle",ut(6,gf,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateX("+e.nameTagRotate+"deg)")),U(2),qe(e.name),U(2),qe(e.name)}}const Tte=function(n){return{"is-hide-in":n}};function Ite(n,t){if(1&n){const e=Xe();K(0,"img",38,39),Te("load",function(){return De(e),ge().onImageLoad()}),Ct(2,"safe"),J()}if(2&n){const e=ge();Ke("height",e.characterImageHeight,"px"),te("src",xt(2,4,e.imageFile.url,"resourceUrl"),Jt)("ngClass",ut(7,Tte,e.isHideIn))}}function Ste(n,t){if(1&n&&(K(0,"span",46),it(1,"img",47),Ct(2,"safe"),J()),2&n){const e=ge(2);U(1),Ke("border-color",e.dialogColor),te("src",xt(2,3,e.dialogFaceIcon.url,"resourceUrl"),Jt)}}function Mte(n,t){if(1&n&&(K(0,"span",46),it(1,"img",47),Ct(2,"safe"),J()),2&n){const e=ge(2);U(1),Ke("border-color",e.dialogColor),te("src",xt(2,3,e.dialogFaceIcon.url,"resourceUrl"),Jt)}}const _S=function(n,t,e){return{emote:n,rubied:t,"is-whisper":e}};function kte(n,t){if(1&n&&(K(0,"div",40)(1,"div",41)(2,"p",42),xe(3,Ste,3,6,"span",43),it(4,"span",44),Ct(5,"safe"),J(),K(6,"p",45),xe(7,Mte,3,6,"span",43),it(8,"span",44),Ct(9,"safe"),J()()()),2&n){const e=ge();Ke("color",!e.isEmote&&e.isWhisper?"#ccc":e.dialogColor),te("@fadeAndScaleInOut",e.isEmote),U(2),Ke("min-width",e.dialogChatBubbleMinWidth,"px")("border-color",e.dialogColor),te("ngClass",Zr(23,_S,e.isEmote,e.isRubied,e.isWhisper)),U(1),te("ngIf",!e.isEmote&&e.isUseFaceIcon&&0<(null==e.dialogFaceIcon?null:e.dialogFaceIcon.url.length)),U(1),te("innerHTML",xt(5,17,e.dialogText,"html"),qi),U(2),Ke("min-width",e.dialogChatBubbleMinWidth,"px")("border-color",e.dialogColor),te("ngClass",Zr(27,_S,e.isEmote,e.isRubied,e.isWhisper)),U(1),te("ngIf",!e.isEmote&&e.isUseFaceIcon&&0<(null==e.dialogFaceIcon?null:e.dialogFaceIcon.url.length)),U(1),te("innerHTML",xt(9,20,e.dialogText,"html"),qi)}}const Dte=function(n){return{transform:n}};function Ate(n,t){if(1&n&&(K(0,"div",48)(1,"div",41)(2,"span",49)(3,"i"),be(4),J()(),K(5,"span",50)(6,"i"),be(7),J()()(),K(8,"div",41)(9,"span",51),be(10),J(),K(11,"span",52),be(12),J()(),K(13,"div",41)(14,"span",49)(15,"i"),be(16),J()(),K(17,"span",50)(18,"i"),be(19),J()()()()),2&n){const e=ge();Ke("height",e.math.abs(e.altitude*e.gridSize)-(e.altitude>0?0:e.chatBubbleAltitude+4),"px"),te("ngStyle",ut(13,Dte,"translateX("+e.size*e.gridSize/2+"px) translateY("+-e.size*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),U(1),Ke("visibility",e.altitude>0?"visible":"hidden"),U(3),qe(e.elevation),U(3),qe(e.elevation),U(3),qe(e.math.abs(e.altitude)),U(2),qe(e.math.abs(e.altitude)),U(1),Ke("visibility",e.altitude<0?"visible":"hidden"),U(3),qe(e.elevation),U(3),qe(e.elevation)}}const Pte=function(n,t,e){return{selected:n,"not-inventory":t,"is-hide-in-pedestal":e}},$S=function(n,t,e,i,r,s,o,c){return{black:n,blue:t,green:e,cyan:i,red:r,magenta:s,yellow:o,white:c}},Nte=function(n){return{fall:n}},Fte=function(n,t,e){return{inverse:n,"black-paint":t,hollow:e}},Ote=function(n,t,e){return{bottom:n,transform:t,visibility:e}};let Rte=(()=>{class n{constructor(e,i,r,s,o,c){this.contextMenuService=e,this.panelService=i,this.changeDetector=r,this.pointerDeviceService=s,this.ngZone=o,this.modalService=c,this.gameCharacter=null,this.is3D=!1,this.gridSize=50,this.math=Math,this.stringUtil=et,this.viewRotateX=50,this.viewRotateZ=10,this.heightWidthRatio=1.5,this.selected=!1,this._dialog=null,this.dialogTimeOutId=null,this.chatIntervalId=null,this.naturalImageWidth=0,this.naturalImageHeight=0,this.naturaHeightWidthRatio=1,this.movableOption={},this.rotableOption={}}get name(){return this.gameCharacter.name}get size(){return this.adjustMinBounds(this.gameCharacter.size)}get altitude(){return this.gameCharacter.altitude}set altitude(e){this.gameCharacter.altitude=e}get height(){return this.adjustMinBounds(this.gameCharacter.height)}get imageFile(){return this.gameCharacter.imageFile}get rotate(){return this.gameCharacter.rotate}set rotate(e){this.gameCharacter.rotate=e}get roll(){return this.gameCharacter.roll}set roll(e){this.gameCharacter.roll=e}get isDropShadow(){return this.gameCharacter.isDropShadow}set isDropShadow(e){this.gameCharacter.isDropShadow=e}get isAltitudeIndicate(){return this.gameCharacter.isAltitudeIndicate}set isAltitudeIndicate(e){this.gameCharacter.isAltitudeIndicate=e}get isInverse(){return this.gameCharacter.isInverse}set isInverse(e){this.gameCharacter.isInverse=e}get isHollow(){return this.gameCharacter.isHollow}set isHollow(e){this.gameCharacter.isHollow=e}get isBlackPaint(){return this.gameCharacter.isBlackPaint}set isBlackPaint(e){this.gameCharacter.isBlackPaint=e}get aura(){return this.gameCharacter.aura}set aura(e){this.gameCharacter.aura=e}get isNotRide(){return this.gameCharacter.isNotRide}set isNotRide(e){this.gameCharacter.isNotRide=e}get isUseIconToOverviewImage(){return this.gameCharacter.isUseIconToOverviewImage}set isUseIconToOverviewImage(e){this.gameCharacter.isUseIconToOverviewImage=e}get ownerName(){return this.gameCharacter.ownerName}get ownerColor(){return this.gameCharacter.ownerColor}get isHideIn(){return!!this.gameCharacter.owner}get isVisible(){return this.gameCharacter.isVisible}get isGMMode(){return!!Ue.myCursor&&Ue.myCursor.isGMMode}get faceIcon(){return this.gameCharacter.faceIcon}get dialogFaceIcon(){return this.dialog&&this.dialog.faceIconIdentifier?kt.instance.get(this.dialog.faceIconIdentifier):null}get shadowImageFile(){return this.gameCharacter.shadowImageFile}get elevation(){return+((this.gameCharacter.posZ+this.altitude*this.gridSize)/this.gridSize).toFixed(1)}set dialog(e){if(!this.gameCharacter||this.gameCharacter.isHideIn)return;clearTimeout(this.dialogTimeOutId),clearInterval(this.chatIntervalId);let i=et.cr(e.text);const r=et.isEmote(i),s=[],o=/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g;let c,m=0,I=0;if(!r)for(i=i.replace(/[\u3002\u3001]{3}/g,"\u2026").replace(/[\u3002\u3001]{2}/g,"\u2025").replace(/(\u3002|[\r\n]{2,})/g,"$1                            ").trimEnd();null!==(c=o.exec(i));){let Be=c.index-3*m;s.push({base:c[1],ruby:c[2],start:Be-I,end:Be+c[1].length-I-1}),m++,I+=c[2].length}let Z=1e3/Array.from(i).length>36?1e3/Array.from(i).length:36;Z>200&&(Z=200),this.dialogTimeOutId=setTimeout(()=>{this._dialog=null,this.gameCharacter.text="",this.gameCharacter.isEmote=!1,this.changeDetector.markForCheck()},Array.from(i).length*Z+6e3),this._dialog=e,this.gameCharacter.isEmote=r,m=0;let fe=0,pe=0,ye="",we=s.shift(),Me="",Oe=!1;if(r)this.gameCharacter.text=i,this.changeDetector.markForCheck();else{const Be=Array.from(i.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a.+?\u300b/g,"$1"));this.chatIntervalId=setInterval(()=>{let ke=Be[m],ze=ke.length>1;if(ke){if(!Oe&&we&&fe>=we.start&&(ye+="<ruby>",Oe=!0,pe=0),ye+=et.escapeHtml(ke),Oe){pe+=1;let je=we.ruby;Me="<rt>"+et.escapeHtml(Array.from(je).slice(0,Math.ceil(Array.from(je).length*(pe/Array.from(we.base).length))).join(""))+"</rt>"}Oe&&we&&fe>=we.end-(ze?1:0)&&(ye+=Me+"</ruby>",Oe=!1,we=s.shift()),fe+=ke.length}m+=1,this.gameCharacter.text=ye+(Oe?Me+"</ruby>":""),this.changeDetector.markForCheck(),m>=Be.length&&clearInterval(this.chatIntervalId)},Z)}}get dialogText(){if(!this.gameCharacter||!this.gameCharacter.text)return"";const e=this.gameCharacter.text.replace(/\u3002/g,"\u3002\n\n").split(/[\r\n]{2,}/g).filter(i=>i.trim());return e.length>0?e.reverse()[0].trim():""}get isRubied(){return!(!this.gameCharacter||!this.gameCharacter.text)&&-1<this.dialogText.indexOf("<ruby>")}get dialogChatBubbleMinWidth(){const e=this.characterImageWidth+2.1*this.gridSize,i=this.isUseFaceIcon&&this.dialogFaceIcon&&this.dialogFaceIcon.url,r=11*Array.from(this.dialogText).length+52+(i?32:0);return e<r?e:r}get dialog(){return this._dialog}get chatBubbleXDeg(){let e=90-this.viewRotateX;return e<0&&(e=360+e),e%=360,e>180&&(e=-(180-(e-180))),e>90&&(e=90),e<-90&&(e=-90),e/1.5}get characterImageHeight(){if(!this.characterImage||!this.naturalImageHeight)return 0;if(this.height>0)return this.gridSize*this.height;let e=this.naturaHeightWidthRatio;return e>this.heightWidthRatio&&(e=this.heightWidthRatio),e*this.gridSize*this.size}get characterImageWidth(){if(!this.characterImage||!this.naturalImageWidth)return 0;if(this.height<=0)return this.gridSize*this.size;let e=this.naturaHeightWidthRatio;return e>this.heightWidthRatio&&(e=this.heightWidthRatio),this.gridSize*this.height/e}get characterShadowImageHeight(){return this.characterImageHeight}get characterShadowImageWidth(){return this.characterImageWidth}get characterShadowOffset(){let e=0;return.2<this.height&&this.height<=.3?e=.09:.1<this.height&&this.height<=.2?e=.19:0<this.height&&this.height<=.1&&(e=.29),this.gridSize*this.size/2-.99*this.characterShadowImageHeight-this.gridSize*e}get chatBubbleAltitude(){let e=Math.cos(this.roll*Math.PI/180),i=Math.abs(Math.sin(this.roll*Math.PI/180));e<.5&&(e=.5),i<.5&&(i=.5);const r=(this.characterImageHeight+(this.name?36:0))*e+4,s=this.characterImageWidth/2*i+4+this.characterImageWidth/2;return r>s?r:s}get nameTagRotate(){let e=this.viewRotateX%360-90,i=(this.viewRotateZ+this.rotate)%360,r=this.roll%360;return i=i>0?i:360+i,r=r>0?r:360+r,(e>0?e:360+e)*(90<i&&i<270?1:-1)*(90<=r&&r<=270?-1:1)}get isListen(){return this.dialog&&this.dialog.text&&!this.dialog.dialogTest&&this.dialog.text.trim().length>0}get isWhisper(){return this.dialog&&this.dialog.secret}get isEmote(){return this.gameCharacter.isEmote}get isUseFaceIcon(){return this.dialog&&this.dialog.faceIconIdentifier}get dialogColor(){return this.dialog&&this.dialog.color?this.dialog.color:Ue.CHAT_DEFAULT_COLOR}ngOnInit(){Fe.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=lt.instance.get(e.data.identifier);!this.gameCharacter||!i||(this.gameCharacter===i||i instanceof zn&&this.gameCharacter.contains(i))&&(this.gameCharacter.imageFiles.length<=0&&(this.naturalImageHeight=0,this.naturalImageWidth=0,this.naturaHeightWidthRatio=1),this.changeDetector.markForCheck())}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateX=e.data.x,this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on("SELECT_TABLETOP_OBJECT",-1e3,e=>{this.ngZone.run(()=>{this.selected=!(!e.data.highlighting||e.data.identifier!==this.gameCharacter.identifier),this.changeDetector.markForCheck()})}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on("POPUP_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&this.ngZone.run(()=>{this.dialog=e.data,this.changeDetector.markForCheck()})}).on("FAREWELL_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&(this.ngZone.run(()=>{this._dialog=null,this.gameCharacter.text="",this.gameCharacter.isEmote=!1,this.changeDetector.markForCheck()}),clearTimeout(this.dialogTimeOutId),clearInterval(this.chatIntervalId))}),this.movableOption={tabletopObject:this.gameCharacter,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain","text-note","character"]},this.rotableOption={tabletopObject:this.gameCharacter}}ngAfterViewInit(){queueMicrotask(()=>{this.gameCharacter.isLoaded=!0})}ngOnDestroy(){clearTimeout(this.dialogTimeOutId),clearInterval(this.chatIntervalId),this.gameCharacter&&(this.gameCharacter.text="",this.gameCharacter.isEmote=!1),Fe.unregister(this)}onDragstart(e){console.log("Dragstart Cancel !!!!"),e.stopPropagation(),e.preventDefault()}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:this.isHideIn?"\u4f4d\u7f6e\u3092\u516c\u958b\u3059\u308b":"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u308b\uff08\u30b9\u30c6\u30eb\u30b9\uff09",action:()=>{this.isHideIn?(this.gameCharacter.owner="",dt.play(Ze.piecePut)):(!Vt.isStealthMode&&!Ue.myCursor.isGMMode&&this.modalService.open(Qi,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:Ci.OK,materialIcon:"disabled_visible"}),this.gameCharacter.owner=yt.peerContext.userId,dt.play(Ze.sweep),Fe.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier})),Fe.call("UPDATE_INVENTORY",!0)}},Tt,this.gameCharacter.imageFiles.length<=1?null:{name:"\u753b\u50cf\u5207\u308a\u66ff\u3048",action:null,subActions:this.gameCharacter.imageFiles.map((r,s)=>({name:this.gameCharacter.currntImageIndex==s?"\u25c9":"\u25cb",action:()=>{this.changeImage(s)},default:this.gameCharacter.currntImageIndex==s,icon:r}))},this.gameCharacter.imageFiles.length<=1?null:Tt,this.isUseIconToOverviewImage?{name:"\u2611 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{this.isUseIconToOverviewImage=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{this.isUseIconToOverviewImage=!0,Fe.trigger("UPDATE_INVENTORY",null)}},this.gameCharacter.isShowChatBubble?{name:"\u2611 \u{1f4ad}\u306e\u8868\u793a",action:()=>{this.gameCharacter.isShowChatBubble=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u{1f4ad}\u306e\u8868\u793a",action:()=>{this.gameCharacter.isShowChatBubble=!0,Fe.trigger("UPDATE_INVENTORY",null)}},this.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!0,Fe.trigger("UPDATE_INVENTORY",null)}},{name:"\u753b\u50cf\u52b9\u679c",action:null,subActions:[this.isInverse?{name:"\u2611 \u53cd\u8ee2",action:()=>{this.isInverse=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u53cd\u8ee2",action:()=>{this.isInverse=!0,Fe.trigger("UPDATE_INVENTORY",null)}},this.isHollow?{name:"\u2611 \u307c\u304b\u3057",action:()=>{this.isHollow=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u307c\u304b\u3057",action:()=>{this.isHollow=!0,Fe.trigger("UPDATE_INVENTORY",null)}},this.isBlackPaint?{name:"\u2611 \u9ed2\u5857\u308a",action:()=>{this.isBlackPaint=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ed2\u5857\u308a",action:()=>{this.isBlackPaint=!0,Fe.trigger("UPDATE_INVENTORY",null)}},{name:"\u30aa\u30fc\u30e9",action:null,subActions:[{name:(-1==this.aura?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{this.aura=-1,Fe.trigger("UPDATE_INVENTORY",null)}},Tt].concat(["\u30d6\u30e9\u30c3\u30af","\u30d6\u30eb\u30fc","\u30b0\u30ea\u30fc\u30f3","\u30b7\u30a2\u30f3","\u30ec\u30c3\u30c9","\u30de\u30bc\u30f3\u30bf","\u30a4\u30a8\u30ed\u30fc","\u30db\u30ef\u30a4\u30c8"].map((r,s)=>({name:`${this.aura==s?"\u25c9":"\u25cb"} ${r}`,colorSample:!0,action:()=>{this.aura=s,Fe.trigger("UPDATE_INVENTORY",null)}})))},Tt,{name:"\u30ea\u30bb\u30c3\u30c8",action:()=>{this.isInverse=!1,this.isHollow=!1,this.isBlackPaint=!1,this.aura=-1,Fe.trigger("UPDATE_INVENTORY",null)},disabled:!this.isInverse&&!this.isHollow&&!this.isBlackPaint&&-1==this.aura}]},Tt,this.isNotRide?{name:"\u2610 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{this.isNotRide=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2611 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{this.isNotRide=!0,Fe.trigger("UPDATE_INVENTORY",null)}},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0,Fe.trigger("UPDATE_INVENTORY",null)}},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,this.isHideIn||dt.play(Ze.sweep))},altitudeHande:this.gameCharacter},Tt,{name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.gameCharacter)}},{name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a",action:()=>{this.showChatPalette(this.gameCharacter)}},{name:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a",action:()=>{this.showStandSetting(this.gameCharacter)}},Tt,{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.gameCharacter.getUrls().map(r=>{const s=r.value.toString();return{name:r.name?r.name:s,action:()=>{et.sameOrigin(s)?window.open(s.trim(),"_blank","noopener"):this.modalService.open(Hr,{url:s,title:this.gameCharacter.name,subTitle:r.name})},disabled:!et.validUrl(s),error:et.validUrl(s)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:et.validUrl(s)&&!et.sameOrigin(s)}}),disabled:this.gameCharacter.getUrls().length<=0},Tt,this.gameCharacter.isInventoryIndicate?{name:"\u2611 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{this.gameCharacter.isInventoryIndicate=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{this.gameCharacter.isInventoryIndicate=!0,Fe.trigger("UPDATE_INVENTORY",null)}},{name:"\u30c6\u30fc\u30d6\u30eb\u304b\u3089\u79fb\u52d5",action:null,subActions:[{name:"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea",action:()=>{Fe.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation("common"),dt.play(Ze.piecePut)}},{name:"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea",action:()=>{Fe.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation(yt.peerId),dt.play(Ze.piecePut)}},{name:"\u5893\u5834",action:()=>{Fe.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation("graveyard"),dt.play(Ze.sweep)}}]},Tt,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.gameCharacter.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.update(),dt.play(Ze.piecePut)}},{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b\uff08\u81ea\u52d5\u63a1\u756a\uff09",action:()=>{const r=this.gameCharacter.clone(),s=r.name.split("_");let o;o=s.length>1&&/\d+/.test(s[s.length-1])?s.slice(0,s.length-1).join("_"):s.join("_");let c=0;for(const m of lt.instance.getObjects(Vt)){if(!m.name.startsWith(o))continue;let I=m.name.match(/_(\d+)$/)?+RegExp.$1:0;I>c&&(c=I)}r.name=o+"_"+(c+1),r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.update(),dt.play(Ze.piecePut)}},Tt,{name:"\u524a\u9664\u3059\u308b\uff08\u5893\u5834\u3078\u79fb\u52d5\uff09",action:()=>{Fe.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation("graveyard"),dt.play(Ze.sweep)}}],this.name)}onMove(){this.isHideIn||dt.play(Ze.piecePick)}onMoved(){this.gameCharacter&&this.gameCharacter.text&&Fe.call("FAREWELL_CHAT_BALLOON",{characterIdentifier:this.gameCharacter.identifier}),this.isHideIn||dt.play(Ze.piecePut),this.selected=!1}onImageLoad(){this.naturalImageWidth=this.characterImage.nativeElement.naturalWidth,this.naturalImageHeight=this.characterImage.nativeElement.naturalHeight,this.naturaHeightWidthRatio=this.naturalImageWidth&&this.naturalImageHeight?this.naturalImageHeight/this.naturalImageWidth:1}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(r+=" - "+e.name),this.panelService.open(Gs,{title:r,left:i.x-400,top:i.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(hu,{left:i.x-250,top:i.y-175,width:620,height:350}).character=e}showStandSetting(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(Qp,{left:i.x-400,top:i.y-175,width:730,height:572}).character=e}changeImage(e){this.gameCharacter.currntImageIndex!=e&&(this.gameCharacter.currntImageIndex=e,this.isHideIn||dt.play(Ze.surprise),Fe.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),Fe.trigger("UPDATE_INVENTORY",null))}nextImage(){this.gameCharacter.imageFiles.length<=1||this.changeImage(this.gameCharacter.currntImageIndex+1>=this.gameCharacter.imageFiles.length?0:this.gameCharacter.currntImageIndex+1)}}return n.\u0275fac=function(e){return new(e||n)(Le(sr),Le(In),Le(Di),Le(ai),Le(vn),Le(kn))},n.\u0275cmp=Zt({type:n,selectors:[["game-character"]],viewQuery:function(e,i){if(1&e&&(on($te,5),on(vte,5)),2&e){let r;sn(r=an())&&(i.characterImage=r.first),sn(r=an())&&(i.chatBubble=r.first)}},hostBindings:function(e,i){1&e&&Te("dragstart",function(s){return i.onDragstart(s)})("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{gameCharacter:"gameCharacter",is3D:"is3D"},decls:36,vars:85,consts:[["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.option","movable.ondragstart","movable.ondragend"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[1,"pedestal-inner",3,"ngClass"],[1,"pedestal-outer"],[1,"pedestal-grab","rotate-grab"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"is-pointer-events-none","is-3d",2,"transform-origin","center bottom"],[1,"image-box","is-3d",2,"transform-origin","center 66%"],[1,"aura","is-3d",2,"pointer-events","none",3,"ngClass"],[1,"is-3d",2,"pointer-events","none","transition","transform 132ms 0s ease",3,"ngStyle"],["class","image drop-shadow is-3d  chrome-smooth-image-trick","style","pointer-events: none",3,"height","src","filter","ngStyle",4,"ngIf"],[1,"upright-transform","is-fit-width","is-3d",3,"ngClass","ngStyle","dblclick"],["appRotable","",1,"rotate-frame","is-3d",2,"position","absolute",3,"rotable.value","rotable.valueChange","rotable.ondragstart","rotable.ondragend"],[1,"rotate-inner","is-3d"],["class","owner-tag is-nowrap is-black-background is-3d",3,"ngStyle",4,"ngIf"],["class","name-tag is-nowrap is-black-background is-3d",3,"ngClass","ngStyle",4,"ngIf"],[1,"is-pointer-events-none","is-3d","aura",3,"ngClass"],[1,"inverser","is-3d",3,"ngClass"],[1,"image-box","is-3d"],["class","image is-3d chrome-smooth-image-trick",3,"src","ngClass","height","load",4,"ngIf"],[1,"grab-group","is-3d"],[1,"rotate-grab","rotate-grab-icon","of-top","is-3d",3,"ngStyle"],[1,"material-icons"],[1,"rotate-grab","rotate-grab-icon","of-bottom","is-3d",3,"ngStyle"],[1,"chat-bubble","is-3d",3,"ngStyle"],["chatBubble",""],["class","is-3d","style","transform-origin: center bottom;",3,"color",4,"ngIf"],["class","is-3d","style","display: flex; flex-flow: column nowrap; justify-content: space-between; border-left: 2px dashed black; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],[1,"image","drop-shadow","is-3d","chrome-smooth-image-trick",2,"pointer-events","none",3,"src","ngStyle"],[1,"owner-tag","is-nowrap","is-black-background","is-3d",3,"ngStyle"],[1,"fornt-tag","is-3d",2,"color","whitesmoke"],[1,"back-tag","is-3d",2,"color","whitesmoke"],[1,"name-tag","is-nowrap","is-black-background","is-3d",3,"ngClass","ngStyle"],[1,"fornt-tag","has-length-limit","is-3d"],[1,"back-tag","has-length-limit","is-3d"],[1,"image","is-3d","chrome-smooth-image-trick",3,"src","ngClass","load"],["characterImage",""],[1,"is-3d",2,"transform-origin","center bottom"],[1,"is-3d"],[1,"is-3d","chat-bubble-buyo",2,"position","absolute","backface-visibility","hidden",3,"ngClass"],["class","face-icon-box is-3d",4,"ngIf"],[3,"innerHTML"],[1,"is-3d","chat-bubble-buyo","back",2,"backface-visibility","hidden","transform","rotateY(-180deg)",3,"ngClass"],[1,"face-icon-box","is-3d"],[1,"face-icon","is-3d",3,"src"],[1,"is-3d",2,"display","flex","flex-flow","column nowrap","justify-content","space-between","border-left","2px dashed black","transform-origin","top left",3,"ngStyle"],[1,"elevation-indicator","is-3d",2,"position","absolute"],[1,"elevation-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"]],template:function(e,i){1&e&&(K(0,"div",0),Te("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),K(1,"div",1)(2,"div",2),Te("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),it(3,"div",3)(4,"div",4),K(5,"div",5)(6,"div",6)(7,"div",7),be(8,"autorenew"),J(),K(9,"div",8),be(10,"autorenew"),J()()(),K(11,"div",9)(12,"div",10)(13,"div",11)(14,"div",12),xe(15,yte,2,12,"img",13),J()()()(),K(16,"div",14),Te("dblclick",function(){return i.nextImage()}),K(17,"div",15),Te("rotable.valueChange",function(s){return i.roll=s})("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),K(18,"div",16),xe(19,xte,7,6,"div",17),xe(20,Ete,5,8,"div",18),K(21,"div",19)(22,"div",20)(23,"span",21),xe(24,Ite,3,9,"img",22),J()()(),K(25,"div",23)(26,"div",24)(27,"i",25),be(28,"autorenew"),J()(),K(29,"div",26)(30,"i",25),be(31,"autorenew"),J()()()()(),K(32,"div",27,28),xe(34,kte,10,31,"div",29),J()()(),xe(35,Ate,20,15,"div",30),J()()),2&e&&(Ke("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),te("movable.option",i.movableOption),U(1),te("@bounceInOut","in"),U(1),te("rotable.option",i.rotableOption),U(1),te("@switchImagePedestal",i.gameCharacter.currntImageIndex)("ngClass",Zr(45,Pte,i.selected,!i.gameCharacter.isInventoryIndicate,i.isHideIn)),U(1),te("@switchImagePedestal",i.gameCharacter.currntImageIndex),U(7),Ke("transform","translateX("+(i.size*i.gridSize-i.characterShadowImageWidth)/2+"px) translateY("+i.characterShadowOffset+"px) scale(1.0, 0.66)"),U(1),Ke("width",i.characterShadowImageWidth,"px")("height",i.characterShadowImageHeight,"px")("transform","rotateZ("+i.roll+"deg)"),U(1),te("ngClass",ao(49,$S,0==i.aura,1==i.aura,2==i.aura,3==i.aura,4==i.aura,5==i.aura,6==i.aura,7==i.aura)),U(1),te("ngStyle",ut(58,gf,"scaleX("+(i.isInverse?"-1":"1")+")")),U(1),te("ngIf",i.isDropShadow&&(0<i.imageFile.url.length||0<i.shadowImageFile.url.length)),U(1),te("ngClass",ut(60,Nte,0==i.altitude))("ngStyle",ut(62,gf,"rotateY(90deg) rotateZ(-90deg) rotateY(-90deg) translateY(-50%) translateY("+-i.altitude*i.gridSize+"px)")),U(1),Ke("transform-origin","center "+.333*-i.characterImageHeight+"px"),te("rotable.value",i.roll),U(1),Ke("transform","translateZ("+-i.size*i.gridSize/2+"px)"),U(1),te("ngIf",i.isGMMode&&i.isHideIn&&0<i.ownerName.length),U(1),te("ngIf",0<i.name.length),U(1),te("@switchImage",i.gameCharacter.currntImageIndex)("ngClass",ao(64,$S,0==i.aura,1==i.aura,2==i.aura,3==i.aura,4==i.aura,5==i.aura,6==i.aura,7==i.aura)),U(1),te("ngClass",Zr(73,Fte,i.isInverse,i.isBlackPaint,i.isHollow)),U(1),Ke("width",i.characterImageWidth,"px")("height",i.characterImageHeight,"px")("transform","translateX("+(i.size*i.gridSize-i.characterImageWidth)/2+"px)"),U(1),te("ngIf",0<i.imageFile.url.length),U(2),te("ngStyle",ut(77,gf,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px) translateY("+(-i.characterImageHeight-(i.isGMMode&&i.isHideIn?20:0))+"px)")),U(3),te("ngStyle",ut(79,gf,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px")),U(3),te("ngStyle",Zr(81,Ote,i.chatBubbleAltitude-(i.isEmote?i.gridSize/2:0)-4+"px","translateZ("+-i.size*i.gridSize/2+"px) translateX(-50%) translateX("+i.size*i.gridSize/2+"px) rotateY("+(i.rotate+i.viewRotateZ)+"deg) rotateX("+i.chatBubbleXDeg+"deg)",i.gameCharacter.isShowChatBubble?"visible":"hidden")),U(2),te("ngIf",i.isListen),U(1),te("ngIf",i.isAltitudeIndicate&&(i.altitude<=-.5||.5<=i.altitude)))},directives:[il,Ql,Wn,Zi,_n],pipes:[ti],styles:['[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.upright-transform.fall[_ngcontent-%COMP%]{transition:transform 132ms cubic-bezier(.21,.97,.75,1.25)}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:100%;box-sizing:border-box;border-top:solid 28px #999;border-left:solid 12px #999;border-right:solid 12px #CCC;border-bottom:solid 28px #CCC;border-radius:37px}.pedestal-inner[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 6px #FFCC80;border-radius:25px}.pedestal-inner.not-inventory[_ngcontent-%COMP%]{border-color:#80ccee}.pedestal-outer[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 2px #212121;border-radius:25px}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{bottom:0;left:0;right:0;margin:auto;width:100%;height:auto;vertical-align:bottom}.image-box[_ngcontent-%COMP%]{display:inline-block;text-align:center}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{-o-object-fit:contain;object-fit:contain;-o-object-position:50% 100%;object-position:50% 100%;margin-bottom:0;margin-top:auto;image-rendering:-webkit-optimize-contrast;image-rendering:crisp-edges}.inverse[_ngcontent-%COMP%]{transform:rotateY(-180deg)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #fff)}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:13px;padding:2px 8px;border-radius:12px;position:absolute;top:-26px;transform-origin:center bottom}.owner-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:11px;padding:2px 9px;border-radius:6px;position:absolute;top:-55px;transform-origin:center bottom}.rotate-frame[_ngcontent-%COMP%]{bottom:0;left:0;right:0;overflow:visible}.rotate-inner[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;width:100%;height:auto;overflow:visible}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.is-black-background.is-hide-in-tag[_ngcontent-%COMP%]{color:#1e1e1e;background-color:#e9e9e9cc}.fornt-tag[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.back-tag[_ngcontent-%COMP%]{position:absolute;top:3px;-webkit-backface-visibility:hidden;backface-visibility:hidden;transform:rotateY(-180deg)}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:24em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;bottom:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{position:absolute;width:24px;top:0;left:0;right:0;margin:auto;color:#444}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.altitude-indicator[_ngcontent-%COMP%]{font-size:10px}.elevation-indicator[_ngcontent-%COMP%], .altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;color:#000;text-shadow:#f5f5f5 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.elevation-indicator[_ngcontent-%COMP%]{font-weight:bolder;font-size:12px}.chat-bubble[_ngcontent-%COMP%]{position:absolute;pointer-events:none;transform-origin:center calc(100% + 12px)}.chat-bubble[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{box-sizing:border-box;display:inline-block;max-width:100%;min-width:130px;font-size:13px;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:1px solid;border-radius:24px;margin:0;padding:6px 12px;white-space:pre-wrap;word-break:break-word;overflow-wrap:anywhere;text-align:center}.chat-bubble[_ngcontent-%COMP%]   p.rubied[_ngcontent-%COMP%]{padding-top:12px}.chat-bubble[_ngcontent-%COMP%]   p.emote[_ngcontent-%COMP%]{text-align:center;font-size:38px;font-weight:700;border:none;background:none;min-width:300px;-webkit-text-stroke:1px rgb(240,218,189);letter-spacing:-2px;white-space:pre}.chat-bubble[_ngcontent-%COMP%]   p.is-whisper[_ngcontent-%COMP%]{border-radius:24px 12px;font-size:13px;background:rgba(85,85,85,.8);box-shadow:0 0 2px #ccc}.chat-bubble[_ngcontent-%COMP%]   p.is-whisper.emote[_ngcontent-%COMP%]{font-size:38px;font-weight:700;border:none;background:none;min-width:200px;-webkit-text-stroke:2px #555;box-shadow:none}.chat-bubble[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:after{box-sizing:border-box;content:"";position:absolute;padding:0;line-height:1;vertical-align:baseline;left:50%;margin:0 0 0 -8px;bottom:-17px;border:8px solid transparent;border-top-color:inherit}.chat-bubble[_ngcontent-%COMP%]   p.emote[_ngcontent-%COMP%]:after{border:0px none transparent}.chat-bubble[_ngcontent-%COMP%]   p.is-whisper.emote[_ngcontent-%COMP%]:after{content:none}.chat-bubble-buyo[_ngcontent-%COMP%]{transform-origin:center calc(100% + 8px);transition:all .2s ease;-webkit-animation:chat-bubble-buyo 1.2s ease-in-out .1s infinite alternate;animation:chat-bubble-buyo 1.2s ease-in-out .1s infinite alternate;transform:scale3d(.9,.9,.9)}.chat-bubble-buyo.back[_ngcontent-%COMP%]{transform-origin:center calc(100% + 8px);transition:all .2s ease;-webkit-animation:chat-bubble-buyo-back 1.2s ease-in-out .1s infinite alternate;animation:chat-bubble-buyo-back 1.2s ease-in-out .1s infinite alternate;transform:rotateY(-180deg) scale3d(.9,.9,.9)}.chat-bubble-buyo.emote[_ngcontent-%COMP%]{-webkit-animation-duration:.6s;animation-duration:.6s}@-webkit-keyframes chat-bubble-buyo{0%{transform:scale3d(.9,.9,.9)}to{transform:scale(1)}}@keyframes chat-bubble-buyo{0%{transform:scale3d(.9,.9,.9)}to{transform:scale(1)}}@-webkit-keyframes chat-bubble-buyo-back{0%{transform:rotateY(-180deg) scale3d(.9,.9,.9)}to{transform:rotateY(-180deg) scale(1)}}@keyframes chat-bubble-buyo-back{0%{transform:rotateY(-180deg) scale3d(.9,.9,.9)}to{transform:rotateY(-180deg) scale(1)}}.drop-shadow[_ngcontent-%COMP%]{pointer-events:none}.face-icon-box[_ngcontent-%COMP%]{display:block;position:relative;border:0px none;width:36px;height:36px;max-width:36px;max-height:36px;overflow:hidden;left:-20px;top:-18px;margin-right:-16px;margin-bottom:-22px;float:left;-webkit-backface-visibility:hidden;backface-visibility:hidden}p.rubied[_ngcontent-%COMP%]   .face-icon-box[_ngcontent-%COMP%]{top:-21px}.face-icon-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:.4em}.selected[_ngcontent-%COMP%]{filter:drop-shadow(0px 0px 8px yellow) drop-shadow(0px 0px 4px yellow);transition:all .2s ease-in}.is-hide-in-pedestal[_ngcontent-%COMP%]{filter:grayscale(70%)}.is-hide-in-pedestal.selected[_ngcontent-%COMP%]{filter:grayscale(70%) drop-shadow(0px 0px 8px yellow) drop-shadow(0px 0px 4px yellow)}.is-hide-in[_ngcontent-%COMP%]{filter:invert(85%) opacity(85%)}'],data:{animation:[xn("switchImage",[Bt(":increment, :decrement",[Ft("400ms ease",nn([Ye({transform:"scale3d(0.8, 0.8, 0.8) rotateY(0deg)"}),Ye({transform:"scale3d(1.2, 1.2, 1.2) rotateY(180deg)"}),Ye({transform:"scale3d(1.0, 1.0, 1.0) rotateY(360deg)"})]))])]),xn("switchImageShadow",[Bt(":increment, :decrement",[Ft("400ms ease",nn([Ye({transform:"scale3d(0.8, 0.8, 0.8)"}),Ye({transform:"scale3d(0, 1.2, 1.2)"}),Ye({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),xn("switchImagePedestal",[Bt(":increment, :decrement",[Ft("400ms ease",nn([Ye({transform:"scale3d(0, 0, 0)"}),Ye({transform:"scale3d(1.2, 1.2, 1.2)"}),Ye({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),xn("bounceInOut",[Bt("void => *",[Ft("600ms ease",nn([Ye({transform:"scale3d(0, 0, 0)",offset:0}),Ye({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),Ye({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),Ye({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),Ye({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Bt("* => void",[Ft(100,Ye({transform:"scale3d(0, 0, 0)"}))])]),xn("fadeAndScaleInOut",[Bt("void => *, true => false",[Ft("200ms ease-in-out",nn([Ye({transform:"scale3d(0, 0, 0)",opacity:0}),Ye({transform:"scale3d(1.0, 1.0, 1.0)",opacity:.8})]))]),Bt("* => void, true => false",[Ft("100ms ease-in-out",Ye({transform:"scale3d(0, 0, 0)",opacity:0}))])])]},changeDetection:0}),n})();const Bte=["cursor"],Lte=["opacity"],zte=["rotate"];function jte(n,t){if(1&n&&(K(0,"div",8)(1,"div",9),Ct(2,"safe"),K(3,"div",10)(4,"span",11),be(5),J()()()()),2&n){const e=t.$implicit,i=ge(2);Ke("background-color",i.color),te("ngClass",e),U(1),Ke("background-image",xt(2,8,"url("+i.iconUrl+")","style")),U(2),Ke("background-color",i.color),U(2),qe(i.name)}}const Hte=function(){return["is-front","is-back"]};function Ute(n,t){1&n&&(Ve(0),K(1,"div",1,2)(3,"div",3,4)(5,"div",5,6),xe(7,jte,6,11,"div",7),J()()(),Ge()),2&n&&(U(7),te("ngForOf",ea(1,Hte)))}class kr{constructor(t,e,i,r){this.changeDetector=t,this.batchService=e,this.coordinateService=i,this.ngZone=r,this.cursor=Ue.myCursor,this.cursorElement=null,this.opacityElement=null,this.rotateElement=null,this.fadeOutTimer=null,this.updateInterval=null,this.callcack=s=>this.onMouseMove(s),this._x=0,this._y=0}get iconUrl(){return this.cursor.image.url}get name(){return this.cursor.name}get isMine(){return this.cursor.isMine}get color(){return this.cursor.color&&"#ffffff"!=this.cursor.color?this.cursor.color:"#f0dabd"}get rotateZ(){return kr.viewRotateZ}get nameTagRotate(){let t=kr.viewRotateX%360-90;return-(t>0?t:360+t)}get delayMs(){let t=16.6*yt.peerIds.length;return t<100?100:t}ngOnInit(){this.isMine||Fe.register(this).on("CURSOR_MOVE",t=>{t.sendFrom===this.cursor.peerId&&this.batchService.add(()=>{this.stopTransition(),this.setAnimatedTransition(),this.setPosition(t.data[0],t.data[1],t.data[2]),this.setRotate(),this.resetFadeOut(),this.changeDetector.markForCheck()},this)}).on("TABLE_VIEW_ROTATE",-1e3,t=>{this.ngZone.run(()=>{kr.viewRotateX=t.data.x,kr.viewRotateZ=t.data.z,this.rotateElement&&this.setRotate(),this.changeDetector.markForCheck()})})}ngAfterViewInit(){this.isMine?this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousemove",this.callcack),document.body.addEventListener("touchmove",this.callcack)}):(this.cursorElement=this.cursorElementRef.nativeElement,this.opacityElement=this.opacityElementRef.nativeElement,this.rotateElement=this.rotateElementRef.nativeElement,this.setAnimatedTransition(),this.setPosition(0,0,0),this.resetFadeOut())}ngOnDestroy(){document.body.removeEventListener("mousemove",this.callcack),document.body.removeEventListener("touchmove",this.callcack),Fe.unregister(this),this.batchService.remove(this),this.fadeOutTimer&&this.fadeOutTimer.clear()}onMouseMove(t){let e=t.touches?t.changedTouches[0].pageX:t.pageX,i=t.touches?t.changedTouches[0].pageY:t.pageY;e===this._x&&i===this._y||(this._x=e,this._y=i,this._target=t.target,this.updateInterval||(this.updateInterval=setTimeout(()=>{this.updateInterval=null,this.calcLocalCoordinate(this._x,this._y,this._target)},this.delayMs)))}calcLocalCoordinate(t,e,i){if(!document.getElementById("app-table-layer").contains(i))return;let r={x:t,y:e,z:0};r=this.coordinateService.calcTabletopLocalCoordinate(r,i),Fe.call("CURSOR_MOVE",[r.x,r.y,r.z])}resetFadeOut(){this.opacityElement.style.opacity="1.0",null==this.fadeOutTimer&&(this.fadeOutTimer=new la(()=>{this.opacityElement.style.opacity="0.0"},3e3)),this.fadeOutTimer.reset()}stopTransition(){this.cursorElement.style.transform=window.getComputedStyle(this.cursorElement).transform}setAnimatedTransition(){this.cursorElement.style.transition=`transform ${this.delayMs+33}ms linear, opacity 0.5s ease-out`}setPosition(t,e,i){this.cursorElement.style.transform=`translateX(${t.toFixed(4)}px) translateY(${e.toFixed(4)}px) translateZ(${i.toFixed(4)}px)`}setRotate(){this.rotateElement.style.transform=`rotateZ(${-this.rotateZ}deg) rotateX(${this.nameTagRotate}deg)`}}kr.viewRotateX=50,kr.viewRotateZ=10,kr.ctor=void Fe.register(kr).on("TABLE_VIEW_ROTATE",-1e3,n=>{kr.viewRotateX=n.data.x,kr.viewRotateZ=n.data.z}),kr.\u0275fac=function(t){return new(t||kr)(Le(Di),Le(ug),Le(Ja),Le(vn))},kr.\u0275cmp=Zt({type:kr,selectors:[["peer-cursor"],["","peer-cursor",""]],viewQuery:function(t,e){if(1&t&&(on(Bte,5),on(Lte,5),on(zte,5)),2&t){let i;sn(i=an())&&(e.cursorElementRef=i.first),sn(i=an())&&(e.opacityElementRef=i.first),sn(i=an())&&(e.rotateElementRef=i.first)}},inputs:{cursor:"cursor"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"component","is-3d","is-transition","is-pointer-events-none"],["cursor",""],[1,"is-3d"],["rotate",""],[1,"upright-transform","is-3d","is-transition"],["opacity",""],["class","peer-cursor is-3d",3,"ngClass","background-color",4,"ngFor","ngForOf"],[1,"peer-cursor","is-3d",3,"ngClass"],[1,"icon","is-3d"],[1,"name","is-center","is-3d"],[1,"is-3d",2,"white-space","nowrap","color","whitesmoke"]],template:function(t,e){1&t&&xe(0,Ute,8,2,"ng-container",0),2&t&&te("ngIf",!e.isMine)},directives:[_n,ei,Wn],pipes:[ti],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;overflow:visible;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.is-transition[_ngcontent-%COMP%]{transition:transform 133ms linear,opacity .5s ease-out}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.peer-cursor[_ngcontent-%COMP%]{height:45px;width:45px;position:absolute;left:0;top:0;box-sizing:border-box;border:solid 1px rgba(240,218,189);border-radius:50% 50% 5%;opacity:.7;transform-origin:100% 100%;-webkit-backface-visibility:hidden;backface-visibility:hidden}.is-front[_ngcontent-%COMP%]{transform:translate(-100%) translateY(-100%) rotateX(-90deg) rotate(45deg)}.is-back[_ngcontent-%COMP%]{transform:translate(-100%) translateY(-100%) rotateX(-90deg) rotateY(180deg) rotate(45deg)}.icon[_ngcontent-%COMP%]{overflow:visible;height:100%;width:100%;border-radius:100%;background-position:top,center;background-repeat:no-repeat;background-size:cover;background-color:#f0dabd;transform:rotate(-45deg) scale(.85)}.name[_ngcontent-%COMP%]{box-sizing:border-box;font-size:7px;padding:2px 5px;border-radius:14px;color:#ccc;background-color:#1e1e1ecc;transform-origin:center}.is-center[_ngcontent-%COMP%]{position:absolute;left:50%;top:-26px;transform:translate(-50%)}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}"]});const Vte=["root"],Gte=["gameTable"],qte=["gameObjects"],Wte=["gridCanvas"];function Kte(n,t){if(1&n&&(Ve(0),it(1,"terrain",18),Ge()),2&n){const e=ge().$implicit;U(1),Ke("z-index",e.height>0?0:1),te("terrain",e)("appTooltip",e)}}function Yte(n,t){if(1&n&&(Ve(0),it(1,"terrain",19),Ge()),2&n){const e=ge().$implicit;U(1),Ke("z-index",e.height>0?0:1),te("terrain",e)}}function Zte(n,t){if(1&n&&(Ve(0),xe(1,Kte,2,4,"ng-container",17),xe(2,Yte,2,3,"ng-container",17),Ge()),2&n){const e=t.$implicit;U(1),te("ngIf",e.detailDataElement&&0<e.detailDataElement.children.length),U(1),te("ngIf",!e.detailDataElement||e.detailDataElement.children.length<=0)}}function Xte(n,t){if(1&n&&(Ve(0),it(1,"game-table-mask",20),Ge()),2&n){const e=ge().$implicit;U(1),te("gameTableMask",e)("appTooltip",e)}}function Qte(n,t){if(1&n&&(Ve(0),it(1,"game-table-mask",21),Ge()),2&n){const e=ge().$implicit;U(1),te("gameTableMask",e)}}function Jte(n,t){if(1&n&&(Ve(0),xe(1,Xte,2,2,"ng-container",17),xe(2,Qte,2,1,"ng-container",17),Ge()),2&n){const e=t.$implicit;U(1),te("ngIf",e.detailDataElement&&0<e.detailDataElement.children.length),U(1),te("ngIf",!e.detailDataElement||e.detailDataElement.children.length<=0)}}const ene=function(n){return{"z-index":n}};function tne(n,t){if(1&n&&it(0,"text-note",22),2&n){const e=t.$implicit;te("textNote",e)("appTooltip",e)("ngStyle",ut(3,ene,e.zindex))}}const vS=function(n,t){return{"z-index":n,transform:t}};function nne(n,t){if(1&n&&it(0,"card-stack",23),2&n){const e=t.$implicit;te("cardStack",e)("appTooltip",e)("ngStyle",Kt(3,vS,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function ine(n,t){if(1&n&&it(0,"card",24),2&n){const e=t.$implicit;te("card",e)("appTooltip",e)("ngStyle",Kt(3,vS,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function rne(n,t){if(1&n&&it(0,"range",25),2&n){const e=t.$implicit;te("range",e)("appTooltip",e)}}function sne(n,t){if(1&n&&it(0,"dice-symbol",26),2&n){const e=t.$implicit;te("diceSymbol",e)("appTooltip",e)}}function one(n,t){if(1&n&&(Ve(0),it(1,"game-character",27),Ge()),2&n){const e=ge().$implicit;U(1),Ke("display",e.isLoaded?"":"none"),te("gameCharacter",e)("appTooltip",e)}}function ane(n,t){if(1&n&&(Ve(0),xe(1,one,2,4,"ng-container",17),Ge()),2&n){const e=t.$implicit,i=ge();U(1),te("ngIf",e&&(e.isVisible||i.isGMMode))}}function lne(n,t){if(1&n&&it(0,"peer-cursor",28),2&n){const e=t.$implicit,i=ge();Ke("display",i.isCursorHidIn(e)&&!i.isGMMode?"none":""),te("cursor",e)}}const cne=function(n,t,e){return[n,t,e]},une=function(n){return{"is-grabbing":n}},dne=function(n){return{transform:n}};let fne=(()=>{class n{constructor(e,i,r,s,o,c,m,I){this.ngZone=e,this.contextMenuService=i,this.pointerDeviceService=r,this.coordinateService=s,this.imageService=o,this.tabletopService=c,this.tabletopActionService=m,this.modalService=I,this.isTableTransformMode=!1,this.isTableTransformed=!1,this.viewPotisonX=100,this.viewPotisonY=0,this.viewPotisonZ=0,this.viewRotateX=50,this.viewRotateY=0,this.viewRotateZ=10,this.mouseGesture=null,this.touchGesture=null}get tableSelecter(){return this.tabletopService.tableSelecter}get currentTable(){return this.tabletopService.currentTable}get gridHeight(){return this.tabletopService.currentTable.gridHeight}get tableImage(){return this.imageService.getSkeletonOr(this.currentTable.imageIdentifier)}get backgroundImage(){return this.imageService.getEmptyOr(this.currentTable.backgroundImageIdentifier)}get backgroundFilterType(){return this.currentTable.backgroundFilterType}get isPointerDragging(){return this.pointerDeviceService.isDragging}get characters(){return this.tabletopService.characters}get tableMasks(){return this.tabletopService.tableMasks}get cards(){return this.tabletopService.cards}get cardStacks(){return this.tabletopService.cardStacks}get ranges(){return this.tabletopService.ranges}get terrains(){return this.tabletopService.terrains}get textNotes(){return this.tabletopService.textNotes}get diceSymbols(){return this.tabletopService.diceSymbols}get peerCursors(){return this.tabletopService.peerCursors}get isStealthMode(){return Vt.isStealthMode}get isGMMode(){return Ue.myCursor&&Ue.myCursor.isGMMode}ngOnInit(){Fe.register(this).on("UPDATE_GAME_OBJECT",e=>{e.data.identifier!==this.currentTable.identifier&&e.data.identifier!==this.tableSelecter.identifier||(console.log("UPDATE_GAME_OBJECT GameTableComponent "+this.currentTable.identifier),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor,this.currentTable.isShowNumber))}).on("DRAG_LOCKED_OBJECT",e=>{this.isTableTransformMode=!0,this.pointerDeviceService.isDragging=!1,this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}).on("RESET_POINT_OF_VIEW",e=>{this.isTableTransformMode=!1,this.pointerDeviceService.isDragging=!1,this.setTransform(this.viewPotisonX,this.viewPotisonY,this.viewPotisonZ,this._rightRotate(this.viewRotateX),this._rightRotate(this.viewRotateY,!0),this._rightRotate(this.viewRotateZ),!0),setTimeout(()=>{this.gridCanvas.nativeElement.style.opacity="0.0",this.gameTable.nativeElement.style.transition="0.1s ease-out",setTimeout(()=>{this.gameTable.nativeElement.style.transition=null},100),e&&"top"==e.data?this.setTransform(0,0,0,0,0,0,!0):this.setTransform(100,0,0,50,0,10,!0)},50),this.removeFocus()}).on("FOCUS_TABLETOP_OBJECT",e=>{setTimeout(()=>{console.log(`move table to focus (${e.data.x}, ${e.data.y})`),this.gameTable.nativeElement.style.transition="0.1s ease-out",setTimeout(()=>{this.gameTable.nativeElement.style.transition=null},100);let s=e.data.x-this.gridCanvas.nativeElement.clientWidth/2,o=e.data.y-this.gridCanvas.nativeElement.clientHeight/2,c=e.data.z,m=this.viewRotateZ/180*Math.PI,I=s*Math.cos(m)-o*Math.sin(m),Z=s*Math.sin(m)+o*Math.cos(m),fe=this.viewRotateX/180*Math.PI,pe=Z*Math.cos(fe),ye=Z*Math.sin(fe)+c;this.setTransform(100-I-this.viewPotisonX,-pe-this.viewPotisonY,-ye-this.viewPotisonZ,0,0,0)},50)}),this.tabletopActionService.makeDefaultTable(),this.tabletopActionService.makeDefaultTabletopObjects()}_rightRotate(e,i=!1){let r=e%360;return i||(r>180?r-=360:r<-180&&(r+=360)),r}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.initializeTableTouchGesture(),this.initializeTableMouseGesture()}),this.cancelInput(),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor),this.setTransform(0,0,0,0,0,0),this.coordinateService.tabletopOriginElement=this.gameObjects.nativeElement}ngOnDestroy(){Fe.unregister(this),this.mouseGesture.destroy(),this.touchGesture.destroy()}initializeTableTouchGesture(){this.touchGesture=new KX(this.rootElementRef.nativeElement,this.ngZone),this.touchGesture.onstart=this.onTableTouchStart.bind(this),this.touchGesture.onend=this.onTableTouchEnd.bind(this),this.touchGesture.ongesture=this.onTableTouchGesture.bind(this),this.touchGesture.ontransform=this.onTableTouchTransform.bind(this)}initializeTableMouseGesture(){this.mouseGesture=new WX(this.rootElementRef.nativeElement),this.mouseGesture.onstart=this.onTableMouseStart.bind(this),this.mouseGesture.onend=this.onTableMouseEnd.bind(this),this.mouseGesture.ontransform=this.onTableMouseTransform.bind(this)}onTableTouchStart(){this.mouseGesture.cancel()}onTableTouchEnd(){this.cancelInput()}onTableTouchGesture(){this.cancelInput()}onTableTouchTransform(e,i,r,s,o,c,m,I){if(!this.isTableTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),I.cancelable&&I.preventDefault();let Z=(1e3+Math.abs(this.viewPotisonZ))/1e3;80<s+this.viewRotateX&&(s+=80-(s+this.viewRotateX)),s+this.viewRotateX<0&&(s+=0-(s+this.viewRotateX)),750<r+this.viewPotisonZ&&(r+=750-(r+this.viewPotisonZ)),this.setTransform(e*=Z,i*=Z,r,s,o,c),this.isTableTransformed=!0}onTableMouseStart(e){e.target.contains(this.gameObjects.nativeElement)||1===e.button||2===e.button?this.isTableTransformMode=!0:(this.isTableTransformMode=!1,this.pointerDeviceService.isDragging=!0,this.gridCanvas.nativeElement.style.opacity="1"),document.activeElement.contains(e.target)||(this.removeSelectionRanges(),this.removeFocus())}onTableMouseEnd(e){this.cancelInput()}onTableMouseTransform(e,i,r,s,o,c,m,I){if(!this.isTableTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),I.cancelable&&I.preventDefault();let Z=(1e3+Math.abs(this.viewPotisonZ))/1e3;this.setTransform(e*=Z,i*=Z,r,s,o,c),this.isTableTransformed=!0}cancelInput(){this.mouseGesture.cancel(),this.isTableTransformMode=!0,this.pointerDeviceService.isDragging=!1,this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}onContextMenu(e){if(!document.activeElement.contains(this.gameObjects.nativeElement)||(e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate(),s=[];Array.prototype.push.apply(s,this.tabletopActionService.makeDefaultContextMenuActions(r)),s.push(Tt),s.push({name:"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a",action:()=>{this.modalService.open(qI)}}),this.contextMenuService.open(i,s,this.currentTable.name)}onDocumentMouseDown(e){this.isTableTransformed=!1}onDocumentTouchStart(e){this.isTableTransformed=!1}onDocumentContextMenu(e){this.isTableTransformed&&!this.pointerDeviceService.isAllowedToOpenContextMenu&&e.preventDefault()}setTransform(e,i,r,s,o,c,m=!1){m?(this.viewRotateX=s,this.viewRotateY=o,this.viewRotateZ=c,this.viewPotisonX=e,this.viewPotisonY=i,this.viewPotisonZ=r):(this.viewRotateX+=s,this.viewRotateY+=o,this.viewRotateZ+=c,this.viewPotisonX+=e,this.viewPotisonY+=i,this.viewPotisonZ+=r),(m||0!=s||0!=o||0!=s)&&this.ngZone.run(()=>{Fe.trigger("TABLE_VIEW_ROTATE",{x:this.viewRotateX,y:this.viewRotateY,z:this.viewRotateZ})}),this.gameTable.nativeElement.style.transform=`translateZ(${this.viewPotisonZ.toFixed(4)}px) translateY(${this.viewPotisonY.toFixed(4)}px) translateX(${this.viewPotisonX.toFixed(4)}px) rotateY(${this.viewRotateY.toFixed(4)}deg) rotateX(${this.viewRotateX.toFixed(4)+"deg) rotateZ("+this.viewRotateZ.toFixed(4)}deg)`}setGameTableGrid(e,i,r=50,s=Us.SQUARE,o="#000000e6",c=!0){this.gameTable.nativeElement.style.width=e*r+"px",this.gameTable.nativeElement.style.height=i*r+"px",new qX(this.gridCanvas.nativeElement).render(e,i,r,s,o,c),this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}removeSelectionRanges(){let e=window.getSelection();e.isCollapsed||e.removeAllRanges()}removeFocus(){document.activeElement instanceof HTMLElement&&document.activeElement.blur()}trackByGameObject(e,i){return i.identifier}isCursorHidIn(e){if(e.isGMMode)return!0;for(let i of this.characters)if(i.isHideIn&&"table"===i.location.name&&i.owner===e.userId)return!0;return!1}}return n.\u0275fac=function(e){return new(e||n)(Le(vn),Le(sr),Le(ai),Le(Ja),Le(wu),Le(vu),Le(mg),Le(kn))},n.\u0275cmp=Zt({type:n,selectors:[["game-table"]],viewQuery:function(e,i){if(1&e&&(on(Vte,7),on(Gte,7),on(qte,7),on(Wte,7)),2&e){let r;sn(r=an())&&(i.rootElementRef=r.first),sn(r=an())&&(i.gameTable=r.first),sn(r=an())&&(i.gameObjects=r.first),sn(r=an())&&(i.gridCanvas=r.first)}},hostBindings:function(e,i){1&e&&Te("contextmenu",function(s){return i.onContextMenu(s)})("mousedown",function(s){return i.onDocumentMouseDown(s)},!1,th)("touchstart",function(s){return i.onDocumentTouchStart(s)},!1,th)("contextmenu",function(s){return i.onDocumentContextMenu(s)},!1,th)},decls:21,vars:39,consts:[[1,"background-image","is-pointer-events-none",3,"ngClass"],[1,"component","is-fill","is-perspective",3,"ngClass"],["root",""],[1,"component-content","is-fill","is-3d"],["gameTable",""],["id","app-game-table",1,"game-table","table-image","is-3d"],["gameObjects",""],[1,"grid-canvas","is-fill","is-pointer-events-none",3,"ngStyle"],["gridCanvas",""],[1,"is-fill","is-3d","is-pointer-events-none"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"textNote","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"cardStack","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"card","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"range","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"diceSymbol","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"cursor","display",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],[1,"is-3d",3,"terrain","appTooltip"],[1,"is-3d",3,"terrain"],[1,"is-3d",3,"gameTableMask","appTooltip"],[1,"is-3d",3,"gameTableMask"],[1,"is-3d",3,"textNote","appTooltip","ngStyle"],[1,"is-3d",3,"cardStack","appTooltip","ngStyle"],[1,"is-3d",3,"card","appTooltip","ngStyle"],[1,"is-3d",3,"range","appTooltip"],[1,"is-3d",3,"diceSymbol","appTooltip"],[1,"is-3d",3,"gameCharacter","appTooltip"],[1,"is-3d",3,"cursor"]],template:function(e,i){1&e&&(K(0,"div",0),Ct(1,"safe"),J(),K(2,"div",1,2)(4,"div",3,4)(6,"div",5,6),Ct(8,"safe"),it(9,"canvas",7,8),K(11,"div",9),xe(12,Zte,3,2,"ng-container",10),J(),xe(13,Jte,3,2,"ng-container",10),xe(14,tne,1,5,"text-note",11),xe(15,nne,1,6,"card-stack",12),xe(16,ine,1,6,"card",13),xe(17,rne,1,2,"range",14),xe(18,sne,1,2,"dice-symbol",15),xe(19,ane,2,1,"ng-container",10),xe(20,lne,1,3,"peer-cursor",16),J()()()),2&e&&(Ke("background-image",xt(1,25,"url("+i.backgroundImage.url+")","style")),te("ngClass",Zr(31,cne,i.backgroundFilterType?"is-filter":"",i.isStealthMode&&!i.isGMMode?"is-hide-in":"",i.backgroundFilterType)),U(2),te("ngClass",ut(35,une,i.isPointerDragging)),U(4),Ke("background-image",xt(8,28,"url("+i.tableImage.url+")","style")),U(3),te("ngStyle",ut(37,dne,"translateZ("+(i.gridHeight+.1)+"px)")),U(3),te("ngForOf",i.terrains)("ngForTrackBy",i.trackByGameObject),U(1),te("ngForOf",i.tableMasks)("ngForTrackBy",i.trackByGameObject),U(1),te("ngForOf",i.textNotes)("ngForTrackBy",i.trackByGameObject),U(1),te("ngForOf",i.cardStacks)("ngForTrackBy",i.trackByGameObject),U(1),te("ngForOf",i.cards)("ngForTrackBy",i.trackByGameObject),U(1),te("ngForOf",i.ranges)("ngForTrackBy",i.trackByGameObject),U(1),te("ngForOf",i.diceSymbols)("ngForTrackBy",i.trackByGameObject),U(1),te("ngForOf",i.characters)("ngForTrackBy",i.trackByGameObject),U(1),te("ngForOf",i.peerCursors)("ngForTrackBy",i.trackByGameObject))},directives:[Wn,Zi,ei,_n,fQ,fS,aee,vee,Pee,jee,Jee,_te,Rte,kr],pipes:[ti],styles:['[_nghost-%COMP%]{display:block}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-perspective[_ngcontent-%COMP%]{perspective:1000px}.is-fill[_ngcontent-%COMP%]{display:block;position:absolute;top:0;left:0;bottom:0;right:0;margin:auto}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.component[_ngcontent-%COMP%]{-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;touch-action:manipulation;height:100%;width:100%;overflow:hidden}.component-content[_ngcontent-%COMP%]{height:2000px;width:2000px}.grid-canvas[_ngcontent-%COMP%]{opacity:0;transform:translateZ(.15px);transition:.1s ease-out;-webkit-backface-visibility:hidden;backface-visibility:hidden}.game-table[_ngcontent-%COMP%]{height:100%;width:100%}.table-image[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;background-repeat:no-repeat;background-size:100% 100%}.background-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;bottom:0;right:0;margin:-5px;background-repeat:no-repeat;background-position:center;background-size:cover;transition:filter .2s ease-in-out}.background-image.is-filter[_ngcontent-%COMP%]{will-change:filter}.background-image.is-filter.white[_ngcontent-%COMP%], .background-image.is-filter.black[_ngcontent-%COMP%]{filter:blur(5px)}.background-image.is-filter[_ngcontent-%COMP%]:after{display:block;content:"";width:100%;height:100%}.background-image.is-filter.white[_ngcontent-%COMP%]:after{background-color:#f7f7f7;filter:opacity(.2)}.background-image.is-filter.black[_ngcontent-%COMP%]:after{background-color:#1a1a1a;filter:opacity(.3)}.background-image.is-filter.is-hide-in.white[_ngcontent-%COMP%]:after{background-color:#1a1a1a;filter:opacity(.3)}.background-image.is-filter.is-hide-in.black[_ngcontent-%COMP%]:after{background-color:#f7f7f7;filter:opacity(.2)}.background-image.is-filter.is-hide-in[_ngcontent-%COMP%]{filter:invert(85%) blur(5px);-webkit-backdrop-filter:invert(85%);backdrop-filter:invert(85%)}.background-image.is-hide-in[_ngcontent-%COMP%]{filter:invert(85%);-webkit-backdrop-filter:invert(85%);backdrop-filter:invert(85%);background-color:#ffcc80}']}),n})(),hne=(()=>{class n{constructor(e){this.elementRef=e,this.timer=null,this.needRepeat=!1}ngAfterViewInit(){let e=()=>{this.needRepeat?(this.timer=setTimeout(e,650),this.needRepeat=!1):(this.timer=null,this.elementRef.nativeElement.style.display="none")};Fe.register(this).on("*",i=>{this.needRepeat||yt.bandwidthUsage<3072||(null===this.timer?(this.elementRef.nativeElement.style.display="block",this.timer=setTimeout(e,650)):this.needRepeat=!0)})}ngOnDestroy(){Fe.unregister(this)}}return n.\u0275fac=function(e){return new(e||n)(Le(_i))},n.\u0275cmp=Zt({type:n,selectors:[["network-indicator"]],decls:12,vars:0,consts:[[1,"sk-cube-grid"],[1,"sk-cube","sk-cube1"],[1,"sk-cube","sk-cube2"],[1,"sk-cube","sk-cube3"],[1,"sk-cube","sk-cube4"],[1,"sk-cube","sk-cube5"],[1,"sk-cube","sk-cube6"],[1,"sk-cube","sk-cube7"],[1,"sk-cube","sk-cube8"],[1,"sk-cube","sk-cube9"],[1,"sk-title"]],template:function(e,i){1&e&&(K(0,"div",0),it(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9),K(10,"div",10),be(11,"sync"),J()())},styles:["[_nghost-%COMP%]{display:block}.sk-cube-grid[_ngcontent-%COMP%]{font-size:8px;color:#444;height:100%;width:100%;background-color:#f7f7f799}.sk-cube[_ngcontent-%COMP%]{background-color:#555}.sk-title[_ngcontent-%COMP%]{padding:2px 0;background-color:#f7f7f799}"]}),n})();const pne=["modalLayer"];function gne(n,t){if(1&n){const e=Xe();K(0,"li",3),Te("click",function(){return De(e),ge().save()}),K(1,"a",4)(2,"div")(3,"i",6),be(4,"sd_storage"),J()(),K(5,"div"),be(6,"\u4fdd\u5b58"),J()()()}}function mne(n,t){if(1&n&&(K(0,"li",14)(1,"a")(2,"div")(3,"i",15),be(4,"sd_storage"),J()(),K(5,"div"),be(6),J()()()),2&n){const e=ge();U(6),An("",e.progresPercent,"%")}}const _ne=function(n){return{horizontal:n}};let $ne=(()=>{class n{constructor(e,i,r,s,o,c,m,I,Z,fe,pe){var ye=this;this.swUpdate=e,this.modalService=i,this.panelService=r,this.pointerDeviceService=s,this.chatMessageService=o,this.appConfigService=c,this.saveDataService=m,this.ngZone=I,this.contextMenuService=Z,this.standImageService=fe,this.cutInService=pe,this.immediateUpdateTimer=null,this.lazyUpdateTimer=null,this.openPanelCount=0,this.isSaveing=!1,this.progresPercent=0,this.isHorizontal=!1,this.isLoggedin=!1,this.isUpdateCanceled=!1,this.ngZone.runOutsideAngular(()=>{Bo.instance.initialize(),yu.instance.initialize(),bu.instance.initialize(),Cu.instance.initialize()}),this.appConfigService.initialize(),this.pointerDeviceService.initialize(),lr.instance.initialize(),go.instance.initialize(),jo.instance.initialize(),new jn("DiceBot",this.chatMessageService).initialize(),jn.getHelpMessage("").then(()=>this.lazyNgZoneUpdate(!0)),new Zl("Jukebox").initialize(),new dt("SoundEffect").initialize(),go.instance.addChatTab("\u30e1\u30a4\u30f3\u30bf\u30d6","MainTab"),go.instance.addChatTab("\u30b5\u30d6\u30bf\u30d6","SubTab").recieveOperationLogLevel=1,po.instance.initialize();let ke=new ua("SampleDiceRollTable");ke.initialize(),ke.name="\u30b5\u30f3\u30d7\u30eb\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868",ke.command="SAMPLE",ke.dice="1d6",ke.value="1:\u3053\u308c\u306f\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u30b5\u30f3\u30d7\u30eb\u3067\u3059\n2:\u6570\u5b57\u3068\u5bfe\u5fdc\u3059\u308b\u7d50\u679c\u30921\u884c\u306b1\u3064\u3065\u3064:\uff08\u30b3\u30ed\u30f3\uff09\u3067\u533a\u5207\u308a\n3:\u6570\u5b57:\u7d50\u679c\u306e\u3088\u3046\u306b\u8a18\u8ff0\u3057\u307e\u3059\n4:\\\\n  \\n\u3067\u6539\u884c\u3057\u307e\u3059\n5-6:\u307e\u305f\u3001-\uff08\u30cf\u30a4\u30d5\u30f3\uff09\u3067\u533a\u5207\u3063\u3066\u6570\u5b57\u306e\u7bc4\u56f2\u3092\u6307\u5b9a\u53ef\u80fd\u3067\u3059",ho.instance.addDiceRollTable(ke);let ze=Ht.createEmpty("none_icon").toContext();ze.url="./assets/images/ic_account_circle_black_24dp_2x.png";let je=kt.instance.add(ze);yn.create(je.identifier).tag="*default \u30a2\u30a4\u30b3\u30f3",ze=Ht.createEmpty("stand_no_image").toContext(),ze.url="./assets/images/nc96424.png";let st=kt.instance.add(ze);yn.create(st.identifier).tag="*default \u30b9\u30bf\u30f3\u30c9",At.resumeAudioContext(),Ze.dicePick=Lt.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,Ze.dicePut=Lt.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,Ze.diceRoll1=Lt.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu01.mp3").identifier,Ze.diceRoll2=Lt.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu02.mp3").identifier,Ze.cardDraw=Lt.instance.add("./assets/sounds/soundeffect-lab/card-turn-over1.mp3").identifier,Ze.cardPick=Lt.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,Ze.cardPut=Lt.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,Ze.cardShuffle=Lt.instance.add("./assets/sounds/soundeffect-lab/card-open1.mp3").identifier,Ze.piecePick=Lt.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,Ze.piecePut=Lt.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,Ze.blockPick=Lt.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,Ze.blockPut=Lt.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,Ze.lock=Lt.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,Ze.unlock=Lt.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,Ze.sweep=Lt.instance.add("./assets/sounds/tm2/tm2_swing003.wav").identifier,Ze.puyon=Lt.instance.add("./assets/sounds/soundeffect-lab/puyon1.mp3").identifier,Ze.surprise=Lt.instance.add("./assets/sounds/otologic/Onmtp-Surprise02-1.mp3").identifier,Ze.coinToss=Lt.instance.add("./assets/sounds/niconicomons/nc146227.mp3").identifier,Lt.instance.get(Ze.dicePick).isHidden=!0,Lt.instance.get(Ze.dicePut).isHidden=!0,Lt.instance.get(Ze.diceRoll1).isHidden=!0,Lt.instance.get(Ze.diceRoll2).isHidden=!0,Lt.instance.get(Ze.cardDraw).isHidden=!0,Lt.instance.get(Ze.cardPick).isHidden=!0,Lt.instance.get(Ze.cardPut).isHidden=!0,Lt.instance.get(Ze.cardShuffle).isHidden=!0,Lt.instance.get(Ze.piecePick).isHidden=!0,Lt.instance.get(Ze.piecePut).isHidden=!0,Lt.instance.get(Ze.blockPick).isHidden=!0,Lt.instance.get(Ze.blockPut).isHidden=!0,Lt.instance.get(Ze.lock).isHidden=!0,Lt.instance.get(Ze.unlock).isHidden=!0,Lt.instance.get(Ze.sweep).isHidden=!0,Lt.instance.get(Ze.puyon).isHidden=!0,Lt.instance.get(Ze.surprise).isHidden=!0,Lt.instance.get(Ze.coinToss).isHidden=!0,Ue.createMyCursor(),Ue.myCursor.name||(Ue.myCursor.name="\u30d7\u30ec\u30a4\u30e4\u30fc"),Ue.myCursor.imageIdentifier=je.identifier,Fe.register(this).on("UPDATE_GAME_OBJECT",ot=>{this.lazyNgZoneUpdate(ot.isSendFromSelf)}).on("DELETE_GAME_OBJECT",ot=>{this.lazyNgZoneUpdate(ot.isSendFromSelf)}).on("SYNCHRONIZE_AUDIO_LIST",ot=>{ot.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("SYNCHRONIZE_FILE_LIST",ot=>{ot.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("LOAD_CONFIG",ot=>{if(console.log("LOAD_CONFIG !!!",ot.data),ot.data.dice&&ot.data.dice.url){const tt=ot.data.dice.api;fetch(ot.data.dice.url+(1==tt?"/v1/names":"/v2/game_system"),{mode:"cors"}).then(_t=>_t.json()).then(_t=>{let Je=ot.data.dice.url;jn.apiUrl=Je.endsWith("/")?Je.substring(0,Je.length-1):Je,jn.apiVersion=tt,jn.diceBotInfos=[];let at=(1==tt?_t.names:_t.game_system).filter(ft=>"DiceBot"!=(1==tt?ft.system:ft.id)).map(ft=>{let Ut=ft.sort_key&&ft.sort_key.indexOf("\u56fd\u969b\u5316")<0?ft.sort_key:ft.name.normalize("NFKD");for(let zt of jn.replaceData)zt[2]&&ft.name===zt[0]&&(Ut=zt[1],ft.name=zt[2]),Ut=Ut.split(zt[0].normalize("NFKD")).join(zt[1].normalize("NFKD"));return ft.normalize=Ut.replace(/[\u3041-\u3096]/g,zt=>String.fromCharCode(zt.charCodeAt(0)+96)).replace(/\u7b2c(.+?)\u7248/g,"\u30bf\u30a4$1\u30cf\u30f3").replace(/[\u30fb!?\uff01\uff1f\s\u3000:\uff1a=\uff1d\/\uff0f\uff08\uff09\(\)]+/g,"").replace(/([\u30a2\u30ab\u30b5\u30bf\u30ca\u30cf\u30de\u30e4\u30e9\u30ef])\u30fc+/g,"$1\u30a2").replace(/([\u30a4\u30ad\u30b7\u30c1\u30cb\u30d2\u30df\u30ea])\u30fc+/g,"$1\u30a4").replace(/([\u30a6\u30af\u30b9\u30c4\u30cc\u30d5\u30e0\u30e6\u30eb])\u30fc+/g,"$1\u30a6").replace(/([\u30a8\u30b1\u30bb\u30c6\u30cd\u30d8\u30e1\u30ec])\u30fc+/g,"$1\u30a8").replace(/([\u30aa\u30b3\u30bd\u30c8\u30ce\u30db\u30e2\u30e8\u30ed])\u30fc+/g,"$1\u30aa").replace(/\u30f3+\u30fc+/g,"\u30f3").replace(/\u30f3+/g,"\u30f3"),ft}).map(ft=>{const Ut=/.+\:(.+)/.exec(1==tt?ft.system:ft.id);return ft.lang=Ut?Ut[1]:"A",ft}).sort((ft,Ut)=>ft.lang<Ut.lang?-1:ft.lang>Ut.lang?1:ft.normalize==Ut.normalize?0:ft.normalize<Ut.normalize?-1:1);if(jn.diceBotInfos.push(...at.map(ft=>({script:1==tt?ft.system:ft.id,game:ft.name}))),at.length>0){let ft=at[0].normalize.substring(0,1),Ut={index:at[0].normalize.substring(0,1),infos:[]};for(let zt of at){let fn="Other"==zt.lang?"\u305d\u306e\u4ed6":"ChineseTraditional"==zt.lang?"\u6b63\u9ad4\u4e2d\u6587":"Korean"==zt.lang?"\ud55c\uad6d\uc5b4":"English"==zt.lang?"English":"SimplifiedChinese"==zt.lang?"\u7b80\u4f53\u4e2d\u6587":zt.normalize.substring(0,1);fn!==ft&&(ft=fn,jn.diceBotInfosIndexed.push(Ut),Ut={index:fn,infos:[]}),Ut.infos.push({script:1==tt?zt.system:zt.id,game:zt.name})}jn.diceBotInfosIndexed.push(Ut),jn.diceBotInfosIndexed.sort((zt,fn)=>zt.index==fn.index?0:zt.index<fn.index?-1:1)}})}else{jn.diceBotInfos.forEach(Je=>{let at=Je.sort_key.normalize("NFKD");for(let ft of jn.replaceData)ft[2]&&Je.game===ft[0]&&(at=ft[1],Je.game=ft[2]),at=at.split(ft[0].normalize("NFKD")).join(ft[1].normalize("NFKD"));at=at.replace(/[\u3041-\u3096]/g,ft=>String.fromCharCode(ft.charCodeAt(0)+96)).replace(/\u7b2c(.+?)\u7248/g,"\u30bf\u30a4$1\u30cf\u30f3").replace(/[\u30fb!?\uff01\uff1f\s\u3000:\uff1a=\uff1d\/\uff0f\uff08\uff09\(\)]+/g,"").replace(/([\u30a2\u30ab\u30b5\u30bf\u30ca\u30cf\u30de\u30e4\u30e9\u30ef])\u30fc+/g,"$1\u30a2").replace(/([\u30a4\u30ad\u30b7\u30c1\u30cb\u30d2\u30df\u30ea])\u30fc+/g,"$1\u30a4").replace(/([\u30a6\u30af\u30b9\u30c4\u30cc\u30d5\u30e0\u30e6\u30eb])\u30fc+/g,"$1\u30a6").replace(/([\u30a8\u30b1\u30bb\u30c6\u30cd\u30d8\u30e1\u30ec])\u30fc+/g,"$1\u30a8").replace(/([\u30aa\u30b3\u30bd\u30c8\u30ce\u30db\u30e2\u30e8\u30ed])\u30fc+/g,"$1\u30aa").replace(/\u30f3+\u30fc+/g,"\u30f3").replace(/\u30f3+/g,"\u30f3"),Je.sort_key=Je.lang?Je.lang:at.normalize("NFKD")}),jn.diceBotInfos.sort((Je,at)=>"Other"==Je.sort_key&&"Other"==at.sort_key?0:"Other"==Je.sort_key?1:"Other"==at.sort_key?-1:Je.sort_key==at.sort_key?0:Je.sort_key<at.sort_key?-1:1);let tt=jn.diceBotInfos[0].sort_key[0],_t={index:tt,infos:[]};for(let Je of jn.diceBotInfos)"Other"==Je.lang&&(Je.lang="\u7b80\u4f53\u4e2d\u6587"),(Je.lang?Je.lang:Je.sort_key[0])!==tt&&(tt=Je.lang?Je.lang:Je.sort_key[0],jn.diceBotInfosIndexed.push(_t),_t={index:tt,infos:[]}),_t.infos.push({script:Je.id,game:Je.game});jn.diceBotInfosIndexed.push(_t)}jn.diceBotInfosIndexed.sort((tt,_t)=>tt.index==_t.index?0:tt.index<_t.index?-1:1),yt.setApiKey(ot.data.webrtc.key),yt.open()}).on("FILE_LOADED",ot=>{this.lazyNgZoneUpdate(!1)}).on("OPEN_NETWORK",ot=>{console.log("OPEN_NETWORK",ot.data.peerId),Ue.myCursor.peerId=yt.peerContext.peerId,Ue.myCursor.userId=yt.peerContext.userId,this.isLoggedin=!1}).on("NETWORK_ERROR",ot=>{console.log("NETWORK_ERROR",ot.data.peerId);let tt=ot.data.errorType,_t=ot.data.errorMessage;this.ngZone.run((0,en.Z)(function*(){["peer-unavailable"].includes(tt)||(yield ye.modalService.open(du,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:_t}),["disconnected","socket-error","unavailable-id","authentication","server-error"].includes(tt)&&(yield ye.modalService.open(du,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:"\u3053\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b\u3068\u518d\u63a5\u7d9a\u3092\u8a66\u307f\u307e\u3059\u3002"}),yt.open(),ye.isLoggedin=!1))}))}).on("CONNECT_PEER",ot=>{ot.isSendFromSelf&&(this.chatMessageService.calibrateTimeOffset(),this.isLoggedin||(this.isLoggedin=!0,o.sendOperationLog((yt.peerContext.isRoom?yt.peerContext.roomName+" \u306b":"\u4ed6\u8005\u3068")+"\u63a5\u7d9a\u3057\u305f"))),this.lazyNgZoneUpdate(ot.isSendFromSelf)}).on("DISCONNECT_PEER",ot=>{this.lazyNgZoneUpdate(ot.isSendFromSelf),ot.isSendFromSelf&&(this.isLoggedin=!1)}).on("PLAY_CUT_IN",-1e3,ot=>{let tt=lt.instance.get(ot.data.identifier);this.cutInService.play(tt,!!ot.data.secret&&ot.data.secret,!!ot.data.test&&ot.data.test,ot.data.sender)}).on("STOP_CUT_IN",-1e3,ot=>{this.cutInService.stop(ot.data.identifier)}).on("POPUP_STAND_IMAGE",-1e3,ot=>{let tt=lt.instance.get(ot.data.standIdentifier),_t=lt.instance.get(ot.data.characterIdentifier);this.standImageService.show(_t,tt,ot.data.color?ot.data.color:null,ot.data.secret)}).on("FAREWELL_STAND_IMAGE",-1e3,ot=>{this.standImageService.farewell(ot.data.characterIdentifier)}).on("DELETE_STAND_IMAGE",-1e3,ot=>{this.standImageService.destroy(ot.data.characterIdentifier,ot.data.identifier)}).on("DESTORY_STAND_IMAGE_ALL",-1e3,ot=>{this.standImageService.destroyAll()})}get otherPeers(){return lt.instance.getObjects(Ue)}ngOnInit(){window.addEventListener("beforeunload",n.beforeUnloadProc)}ngAfterViewInit(){In.defaultParentViewContainerRef=kn.defaultParentViewContainerRef=sr.defaultParentViewContainerRef=nr.defaultParentViewContainerRef=Gp.defaultParentViewContainerRef=this.modalLayerViewContainerRef,queueMicrotask(()=>{this.panelService.open(m1,{width:520,height:450,left:100}),this.panelService.open(UI,{width:700,height:400,left:100,top:450})}),this.swUpdate.versionUpdates.subscribe(e=>{switch(e.type){case"VERSION_DETECTED":console.log(`Downloading new app version: ${e.version.hash}`);break;case"VERSION_READY":console.log(`Current app version: ${e.currentVersion.hash}`),console.log(`New app version ready for use: ${e.latestVersion.hash}`),this.isUpdateCanceled||this.modalService.open(Qi,{title:"Udonarium with Fly \u306e\u66f4\u65b0",text:"Udonarium with Fly \u306e\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u516c\u958b\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u66f4\u65b0\u3092\u884c\u3044\u307e\u3059\u304b\uff1f",help:"\u66f4\u65b0\u306e\u969b\u306b\u30da\u30fc\u30b8\u3092\u518d\u8aad\u307f\u8fbc\u307f\u3057\u307e\u3059\u3002\u624b\u52d5\u3067\u518d\u8aad\u307f\u8fbc\u307f\u3092\u884c\u3046\u3053\u3068\u3067\u3082\u66f4\u65b0\u53ef\u80fd\u3067\u3059\u3002",type:Ci.OK_CANCEL,materialIcon:"browser_updated",action:()=>{this.swUpdate.activateUpdate().then(()=>{window.removeEventListener("beforeunload",n.beforeUnloadProc),document.location.reload()})},cancelAction:()=>{this.isUpdateCanceled=!0}});break;case"VERSION_INSTALLATION_FAILED":console.log(`Failed to install app version '${e.version.hash}': ${e.error}`)}})}ngOnDestroy(){Fe.unregister(this)}open(e){let i=null,r={width:450,height:600,left:100};switch(e){case"PeerMenuComponent":r.width=520,i=m1;break;case"ChatWindowComponent":i=UI,r.width=700;break;case"GameTableSettingComponent":i=qI,r={width:610,height:400,left:100};break;case"FileStorageComponent":i=js,r.width=700;break;case"GameCharacterSheetComponent":i=Gs;break;case"JukeboxComponent":i=fZ;break;case"GameCharacterGeneratorComponent":i=qK,r={width:500,height:300,left:100};break;case"GameObjectInventoryComponent":i=zY;break;case"DiceRollTableSettingComponent":i=tX,r={width:645,height:475};break;case"CutInSettingComponent":i=wX,r={width:700,height:600}}i&&(r.top=20*(this.openPanelCount%10+1),r.left=100+5*(this.openPanelCount%20+1),this.openPanelCount=this.openPanelCount+1,this.panelService.open(i,r))}save(){var e=this;return(0,en.Z)(function*(){if(e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i=yt.peerContext&&0<yt.peerContext.roomName.length?yt.peerContext.roomName:"fly_\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf";yield e.saveDataService.saveRoomAsync(i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}handleFileSelect(e){let i=e.target,r=i.files;r.length&&Bo.instance.load(r),i.value=""}lazyNgZoneUpdate(e){if(e){if(null!==this.immediateUpdateTimer)return;this.immediateUpdateTimer=setTimeout(()=>{this.immediateUpdateTimer=null,null!=this.lazyUpdateTimer&&(clearTimeout(this.lazyUpdateTimer),this.lazyUpdateTimer=null),this.ngZone.run(()=>{})},0)}else{if(null!==this.lazyUpdateTimer)return;this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,null!=this.immediateUpdateTimer&&(clearTimeout(this.immediateUpdateTimer),this.immediateUpdateTimer=null),this.ngZone.run(()=>{})},100)}}toolBox(){const e=[],i=po.instance.cutIns;e.push({name:"\u30ab\u30c3\u30c8\u30a4\u30f3\u518d\u751f",materialIcon:"play_arrow",action:null,subActions:0===i.length?[{name:"(\u30ab\u30c3\u30c8\u30a4\u30f3\u306a\u3057)",disabled:!0,center:!0}]:i.map(r=>({name:`${r.isValidAudio?"":"\u26a0\ufe0f"}${""==r.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":r.name}`,subActions:[{name:"\u5168\u54e1",action:()=>{Fe.call("PLAY_CUT_IN",{identifier:r.identifier,secret:!1,sender:Ue.myCursor.peerId}),this.chatMessageService.sendOperationLog((""==r.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":r.name)+" \u3092\u518d\u751f\u3057\u305f")}},Tt,...this.otherPeers.map(s=>({name:s.name+(s===Ue.myCursor?" (\u3042\u306a\u305f)":""),color:s.color,default:!0,action:()=>{s!==Ue.myCursor&&Fe.call("PLAY_CUT_IN",{identifier:r.identifier,secret:!0,sender:Ue.myCursor.peerId},s.peerId),Fe.call("PLAY_CUT_IN",{identifier:r.identifier,secret:!0,sender:Ue.myCursor.peerId},Ue.myCursor.peerId)}}))]}))}),e.push(Tt),e.push({name:"\u30ab\u30c3\u30c8\u30a4\u30f3\u8a2d\u5b9a",materialIcon:"movie_creation",action:()=>this.open("CutInSettingComponent")}),e.push({name:"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u8a2d\u5b9a",materialIcon:"table_rows",action:()=>this.open("DiceRollTableSettingComponent")}),this.contextMenuService.open(this.pointerDeviceService.pointers[0],e,"\u30c4\u30fc\u30eb\u30dc\u30c3\u30af\u30b9")}resetPointOfView(){this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:"\u521d\u671f\u8996\u70b9\u306b\u623b\u3059",action:()=>Fe.trigger("RESET_POINT_OF_VIEW",null)},{name:"\u771f\u4e0a\u304b\u3089\u8996\u308b",action:()=>Fe.trigger("RESET_POINT_OF_VIEW","top")}],"\u8996\u70b9\u30ea\u30bb\u30c3\u30c8")}standSetteings(){const e=Uo.isShowStand,i=Uo.isShowNameTag,r=Uo.isCanBeGone;this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:(lr.instance.gridShow?"\u2611":"\u2610")+"\u30c6\u30fc\u30d6\u30eb\u30b0\u30ea\u30c3\u30c9\u3092\u5e38\u306b\u8868\u793a",action:()=>{lr.instance.gridShow=!lr.instance.gridShow,Fe.trigger("UPDATE_GAME_OBJECT",lr.instance.toContext())}},{name:(lr.instance.gridSnap?"\u2611":"\u2610")+"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u79fb\u52d5\u6642\u306b\u30b9\u30ca\u30c3\u30d7",action:()=>{lr.instance.gridSnap=!lr.instance.gridSnap}},Tt,{name:(e?"\u2611":"\u2610")+"\u30b9\u30bf\u30f3\u30c9\u8868\u793a",action:()=>{Uo.isShowStand=!e}},{name:(i?"\u2611":"\u2610")+"\u30cd\u30fc\u30e0\u30bf\u30b0\u8868\u793a",action:()=>{Uo.isShowNameTag=!i},level:1,disabled:!Uo.isShowStand},{name:(r?"\u2611":"\u2610")+"\u900f\u660e\u5316\u3001\u81ea\u52d5\u9000\u53bb",action:()=>{Uo.isCanBeGone=!r},level:1,disabled:!Uo.isShowStand},Tt,{name:"\u8868\u793a\u30b9\u30bf\u30f3\u30c9\u5168\u6d88\u53bb",action:()=>Fe.trigger("DESTORY_STAND_IMAGE_ALL",null)}],"\u500b\u4eba\u8a2d\u5b9a")}diceAllOpne(){this.modalService.open(Qi,{title:"\u30c0\u30a4\u30b9\u4e00\u6589\u516c\u958b",text:"\u30c6\u30fc\u30d6\u30eb\u4e0a\u306e\u30c0\u30a4\u30b9\u3001\u30b3\u30a4\u30f3\u3092\u516c\u958b\u3057\u307e\u3059\u304b\uff1f",help:"\u300c\u4e00\u6589\u516c\u958b\u3057\u306a\u3044\u300d\u8a2d\u5b9a\u306e\u3082\u306e\u306f\u516c\u958b\u3055\u308c\u307e\u305b\u3093\u3002",type:Ci.OK_CANCEL,materialIcon:"all_out",action:()=>{Fe.trigger("DICE_ALL_OPEN",null)}})}deleteGameObject(e){throw new Error("Method not implemented.")}rotateChange(e){this.isHorizontal=e}}return n.beforeUnloadProc=t=>{t.preventDefault(),t.returnValue=""},n.\u0275fac=function(e){return new(e||n)(Le(eS),Le(kn),Le(In),Le(ai),Le(Er),Le(g1),Le(Ir),Le(vn),Le(sr),Le(nr),Le(Gp))},n.\u0275cmp=Zt({type:n,selectors:[["app-root"]],viewQuery:function(e,i){if(1&e&&on(pne,7,Rr),2&e){let r;sn(r=an())&&(i.modalLayerViewContainerRef=r.first)}},decls:98,vars:13,consts:[["id","app-table-layer",2,"position","absolute","width","100%","height","100%","overflow","hidden"],[3,"top","left","width","height","title","isAbleFullScreenButton","isAbleCloseButton","isAbleRotateButton","rotateEvent"],[3,"ngClass"],[3,"click"],["routerLink","/","routerLinkActive","active"],[1,"material-icons","icon-size"],[1,"material-icons"],[1,"self-only"],["type","file","multiple","","accept","application/xml,text/xml,application/zip",2,"display","none",3,"change"],[3,"click",4,"ngIf"],["style","pointer-events: none;",4,"ngIf"],[1,"self-only-indicater",2,"font-size","8px","text-align","center"],["modalLayer",""],[1,"networkIndicator"],[2,"pointer-events","none"],[1,"material-icons","vibration-amine"]],template:function(e,i){1&e&&(K(0,"div",0),it(1,"game-table"),J(),K(2,"ui-panel",1),Te("rotateEvent",function(s){return i.rotateChange(s)}),K(3,"nav",2)(4,"ul")(5,"li",3),Te("click",function(){return i.open("PeerMenuComponent")}),K(6,"a",4)(7,"div")(8,"i",5),be(9,"people"),J()(),K(10,"div"),be(11,"\u63a5\u7d9a"),J()()(),K(12,"li",3),Te("click",function(){return i.open("ChatWindowComponent")}),K(13,"a",4)(14,"div")(15,"i",5),be(16,"speaker_notes"),J()(),K(17,"div"),be(18,"\u30c1\u30e3\u30c3\u30c8\u753b\u9762"),J()()(),K(19,"li",3),Te("click",function(){return i.open("GameTableSettingComponent")}),K(20,"a",4)(21,"div")(22,"i",5),be(23,"layers"),J()(),K(24,"div"),be(25,"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a"),J()()(),K(26,"li",3),Te("click",function(){return i.open("FileStorageComponent")}),K(27,"a",4)(28,"div")(29,"i",5),be(30,"photo_library"),J()(),K(31,"div"),be(32,"\u753b\u50cf"),J()()(),K(33,"li",3),Te("click",function(){return i.open("JukeboxComponent")}),K(34,"a",4)(35,"div")(36,"i",6),be(37,"queue_music"),J()(),K(38,"div"),be(39,"\u97f3\u697d"),J()()(),K(40,"li",3),Te("click",function(){return i.toolBox()}),K(41,"a",4)(42,"div")(43,"i",6),be(44,"build"),J()(),K(45,"div"),be(46,"\u30c4\u30fc\u30eb\u30dc\u30c3\u30af\u30b9"),J()()(),K(47,"li",3),Te("click",function(){return i.open("GameObjectInventoryComponent")}),K(48,"a",4)(49,"div")(50,"i",5),be(51,"folder_shared"),J()(),K(52,"div"),be(53,"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),J()()(),K(54,"li",3),Te("click",function(){return i.diceAllOpne()}),K(55,"a",4)(56,"div")(57,"i",5),be(58,"all_out"),J()(),K(59,"div"),be(60,"\u30c0\u30a4\u30b9\u4e00\u6589\u516c\u958b"),J()()(),K(61,"li",3),Te("click",function(){return i.standSetteings()}),K(62,"a",4)(63,"div")(64,"i",5),be(65,"how_to_reg"),J()(),K(66,"div"),be(67,"\u500b\u4eba\u8a2d\u5b9a"),K(68,"sup",7),be(69,"*"),J()()()(),K(70,"li",3),Te("click",function(){return i.resetPointOfView()}),K(71,"a",4)(72,"div")(73,"i",5),be(74,"remove_red_eye"),J()(),K(75,"div"),be(76,"\u8996\u70b9\u30ea\u30bb\u30c3\u30c8"),K(77,"sup",7),be(78,"*"),J()()()(),K(79,"li")(80,"a",4)(81,"label")(82,"div")(83,"i",6),be(84,"open_in_browser"),J()(),K(85,"div"),be(86,"ZIP\u8aad\u8fbc"),J(),K(87,"input",8),Te("change",function(s){return i.handleFileSelect(s)}),J()()()(),xe(88,gne,7,0,"li",9),xe(89,mne,7,1,"li",10),J(),K(90,"div",11)(91,"b")(92,"sup",7),be(93,"*"),J(),be(94,"\u306f\u81ea\u5206\u306e\u307f"),J()()()(),it(95,"div",null,12)(97,"network-indicator",13)),2&e&&(U(2),te("top",0)("left",0)("width",100)("height",710)("title","\u30e1\u30cb\u30e5\u30fc")("isAbleFullScreenButton",!1)("isAbleCloseButton",!1)("isAbleRotateButton",!0),U(1),te("ngClass",ut(11,_ne,i.isHorizontal)),U(85),te("ngIf",!i.isSaveing),U(1),te("ngIf",i.isSaveing))},directives:[fne,WI,Wn,_n,hne],styles:["[_nghost-%COMP%]{display:block}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{text-align:center;padding:5px;color:#ccc;color:#444;cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:hover{color:#ccc;background-color:#1e1e1ecc}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{height:128px;width:128px;font-size:8px;-webkit-user-select:none;-moz-user-select:none;user-select:none}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:24px}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{text-decoration:none}.icon-size[_ngcontent-%COMP%]{font-size:40px}.side-menu[_ngcontent-%COMP%]{top:0px;left:0px;box-sizing:border-box;overflow:auto;position:absolute;color:#ccc;background-color:#1e1e1ecc;border:solid 1px #999;padding:0;height:100%;width:300px}.networkIndicator[_ngcontent-%COMP%]{display:none;z-index:9999;pointer-events:none;position:absolute;top:3px;right:3px;height:30px;width:30px}.vibration-amine[_ngcontent-%COMP%]{-webkit-animation:vibration .2s infinite;animation:vibration .2s infinite}@-webkit-keyframes vibration{0%{transform:scale(1) translate(0)}50%{transform:scale(1.02,.95) translateY(5%)}to{transform:scale(1) translate(0)}}@keyframes vibration{0%{transform:scale(1) translate(0)}50%{transform:scale(1.02,.95) translateY(5%)}to{transform:scale(1) translate(0)}}.self-only[_ngcontent-%COMP%]{color:red}.horizontal[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap}.horizontal[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{display:inline-block;width:74px}[_ngcontent-%COMP%]:not(.horizontal)   .self-only-indicater[_ngcontent-%COMP%]{margin-top:2em}.horizontal[_ngcontent-%COMP%]   .self-only-indicater[_ngcontent-%COMP%]{display:none}"]}),n})();In.UIPanelComponentClass=WI,sr.ContextMenuComponentClass=GK,kn.ModalComponentClass=gZ;let vne=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ws({type:n}),n.\u0275inj=ls({}),n})(),bne=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=ws({type:n,bootstrap:[$ne]}),n.\u0275inj=ls({providers:[g1,Er,sr,kn,_1,In,ai,vu,nr],imports:[[xx,x8,ux,ER,vne,r7,GX.register("ngsw-worker.js",{enabled:true})]]}),n})();Dg(hu,[Il,Tl,ia,ei,Aa,fi,hi,oi,_n,Nd,er,zr,jr],[]),Dg(hu,[Il,Tl,ia,ei,Aa,fi,hi,oi,_n,Nd,er,zr,jr],[]),function uN(){B2=!1}(),fO().bootstrapModule(bne).catch(n=>console.error(n))},5904:(E,ae,X)=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0}),X(8827),X(4748),X(9202),X(8465);var a=X(3583),y=X(3693),w=function(){function p(d,M){this.internal=null!=M?M:a.BCDice.Base.$new(d)}return p.eval=function(d){var M=a.BCDice.Base.$eval(d);return y.parseResult(M)},Object.defineProperty(p.prototype,"randomizer",{get:function(){return this.internal.randomizer},enumerable:!1,configurable:!0}),p.prototype.eval=function(){var d=this.internal.$eval();return y.parseResult(d)},p}();ae.default=w},8827:(E,ae,X)=>{X(9993),Opal.queue(function(a){var F,V,ue,Y,ne,H,se,G,y=[],w=a.nil,p=a.$$$,d=a.module,M=a.hash2,v=a.truthy,D=a.def;return F=y,V=G=[d(y[0],"BCDice")].concat(F),se=[H=d(G[0],"ArithmeticEvaluator")].concat(V),Y=[ue=a.get_singleton_class(H)].concat(se),ne=a.$r(Y),D(ue,"$eval",function(q,z){var A,N=w;if(null==z)z=M([],{});else if(!z.$$is_hash)throw a.ArgumentError.$new("expected kwargs");return null==(A=z.$$smap.round_type)&&(A=p(ne("RoundType"),"FLOOR")),v(q)&&v(N=ne("Arithmetic").$eval(q,A))?N:0},-2)})},9202:(E,ae,X)=>{X(9993),Opal.modules.json=function(a){var ee,ue,y=[],w=a.nil,p=a.$$$,d=a.module,M=a.klass,v=a.send,D=a.to_a,$=a.rb_minus,F=a.Object,oe=a.hash2,G=a.eqeqeq,L=a.defs,V=a.truthy,H=a.def;return function(se,ue){var ee=d(se,"JSON"),Y=[ee].concat(ue),ne=a.$r(Y),k=w;M(Y[0],ne("StandardError"),"JSONError"),M(Y[0],ne("JSONError"),"ParserError");var q=a.hasOwnProperty;function z(N){try{return JSON.parse(N)}catch(P){ee.$raise(p(ne("JSON"),"ParserError"),P.message)}}function A(N,P){var g,b,C,h,u,l;switch(typeof N){case"string":case"number":return N;case"boolean":return!!N;case"undefined":return w;case"object":if(!N)return w;if(N.$$is_array){for(b=P.array_class.$new(),h=0,u=N.length;h<u;h++)b.$push(A(N[h],P));return b}for(l in C=P.object_class.$new(),N)q.call(N,l)&&(k=[l,A(N[l],P)],v(C,"[]=",D(k)),$(k.length,1));return P.parse||(g=C["$[]"](ne("JSON").$create_id()))==w?C:F.$const_get(g).$json_create(C)}}a.get_singleton_class(ee).$attr_accessor("create_id"),v(ee,"create_id=",D(k=["json_class"])),$(k.length,1),L(ee,"$[]",function(P,g){return null==g&&(g=oe([],{})),G(ne("String"),P)?this.$parse(P,g):this.$generate(P,g)},-2),L(ee,"$parse",function(P,g){return null==g&&(g=oe([],{})),this.$from_object(z(P),g.$merge(oe(["parse"],{parse:!0})))},-2),L(ee,"$parse!",function(P,g){return null==g&&(g=oe([],{})),this.$parse(P,g)},-2),L(ee,"$load",function(P,g){return null==g&&(g=oe([],{})),this.$from_object(z(P),g)},-2),L(ee,"$from_object",function(P,g){var C=w;return null==g&&(g=oe([],{})),V(g["$[]"]("object_class"))||(C=["object_class",ne("Hash")],v(g,"[]=",D(C)),$(C.length,1)),V(g["$[]"]("array_class"))||(C=["array_class",ne("Array")],v(g,"[]=",D(C)),$(C.length,1)),A(P,g.$$smap)},-2),L(ee,"$generate",function(P,g){return null==g&&(g=oe([],{})),P.$to_json(g)},-2),L(ee,"$dump",function(P,g,b){var h;return null==g&&(g=w),null==b&&(b=w),h=this.$generate(P),V(g)?(V(g["$responds_to?"]("to_io"))&&(g=g.$to_io()),g.$write(h),g):h},-2)}(y[0],y),ee=M(y[0],null,"Object"),H(ee,"$to_json",function(){return this.$to_s().$to_json()},0),ue=d(y[0],"Enumerable"),H(ue,"$to_json",function(){return this.$to_a().$to_json()},0),function(se,ue){var ee=M(se,null,"Array");H(ee,"$to_json",function(){for(var k=[],q=0,z=this.length;q<z;q++)k.push(this[q].$to_json());return"["+k.join(",")+"]"},0)}(y[0]),function(se,ue){var ee=M(se,null,"Boolean");H(ee,"$to_json",function(){return 1==this?"true":"false"},0)}(y[0]),function(se,ue){var ee=M(se,null,"Hash");H(ee,"$to_json",function(){for(var N,P,k=[],q=0,z=this.$$keys,A=z.length;q<A;q++)(N=z[q]).$$is_string?P=this.$$smap[N]:(P=N.value,N=N.key),k.push(N.$to_s().$to_json()+":"+P.$to_json());return"{"+k.join(",")+"}"},0)}(y[0]),function(se,ue){var ee=M(se,null,"NilClass");H(ee,"$to_json",function(){return"null"},0)}(y[0]),function(se,ue){var ee=M(se,null,"Numeric");H(ee,"$to_json",function(){return this.toString()},0)}(y[0]),function(se,ue){var ee=M(se,null,"String");H(ee,"$to_json",function(){return JSON.stringify(this)},0)}(y[0]),function(se,ue){var ee=M(se,null,"Time");H(ee,"$to_json",function(){return this.$strftime("%FT%T%z").$to_json()},0)}(y[0]),function(se,ue){var ee=M(se,null,"Date");return H(ee,"$to_json",function(){return this.$to_s().$to_json()},0),H(ee,"$as_json",function(){return this.$to_s()},0)}(y[0])},Opal.modules.i18n=function(a){var ee,k,z,A,Y,ne,w=[],p=a.nil,d=a.$$$,M=a.module,v=a.class_variable_set,D=a.class_variable_get,$=a.def,F=a.truthy,oe=a.hash2,G=a.send,L=a.to_a,H=a.alias,se=a.klass;return a.top.$require("json"),ee=w,ne=[Y=M(w[0],"I18n")].concat(ee),k=a.get_singleton_class(Y),z=[k].concat(ne),A=a.$r(z),v(z[1],"@@load_path",[]),v(z[1],"@@table",p),$(k,"$load_path",function(){return D(z[1],"@@load_path",!1)},0),$(k,"$default_locale",function(){return D(z[1],"@@default_locale",!1)},0),$(k,"$default_locale=",function(P){return v(z[1],"@@default_locale",P)},1),$(k,"$fallbacks",function(){return d(d(A("I18n"),"Locale"),"Fallbacks").$new()},0),$(k,"$load_default_translation",function(){return F(D(z[1],"@@table",!1)["$nil?"]())?(v(z[1],"@@table",oe([],{})),this.$load_translation(JSON.stringify(X(6884)))):p},0),$(k,"$load_translation",function(P){var b;return this.$load_default_translation(),b=A("JSON").$parse(P,oe(["symbolize_names"],{symbolize_names:!0})),v(z[1],"@@table",G(D(z[1],"@@table",!1),"merge",[b],function(h,u,l){return null==h&&(h=p),null==u&&(u=p),null==l&&(l=p),u.$merge(l)},3))},1),$(k,"$clear_translate_table",function(){return v(z[1],"@@table",p)},0),$(k,"$translate",function(P,g){var b,C,u,l,f=p,_=p,x=p;if(null==g)g=oe([],{});else if(!g.$$is_hash)throw a.ArgumentError.$new("expected kwargs");null==(b=g.$$smap.locale)&&(b=p),C=a.kwrestargs(g,{locale:!0}),this.$load_default_translation(),u=G(P.$split("."),"map",[],"to_sym".$to_proc()),l=D(z[1],"@@table",!1),f=D(z[1],"@@default_locale",!1),_=F(x=G(l,"dig",[b].concat(L(u))))?x:G(l,"dig",[f].concat(L(u)));try{F(_["$is_a?"](A("String")))&&(_=this.$format(_,a.to_hash(C)))}catch(S){if(!a.rescue(S,[A("ArgumentError"),A("KeyError")]))throw S;a.pop_exception()}return F(x=_)?x:C["$[]"]("default")},-2),H(k,"t","translate"),function(k,q){var P,g,b,A=[M(k,"Locale")].concat(q),N=a.$r(A);P=A[0],g=N("Hash"),b=se(P,g,"Fallbacks"),$(b,"$defaults=",function(h){return p},1)}(ne[0],ne),function(k,q){var A=[M(k,"Backend")].concat(q);M(A[0],"Simple")}(ne[0],ne),function(k,q){var N,z=M(k,"Thread");return[z].concat(q),N=a.get_singleton_class(z),$(N,"$current",function(){return oe(["i18n_fallbacks"],{i18n_fallbacks:p})},0)}(ne[0],ne)},Opal.modules["i18n/backend/fallbacks"]=function(a){var Y,q,A,N,ne,k,y=[],w=a.nil,p=a.$$$,d=a.module,M=a.class_variable_set,v=a.truthy,D=a.class_variable_get,$=a.def,F=a.send,oe=a.to_a,G=a.rb_minus,L=a.send2,V=a.find_super,H=a.hash2,se=a.find_block_super,ue=a.neqeq;return Y=y,k=[ne=d(y[0],"I18n")].concat(Y),M(k[0],"@@fallbacks",w),q=a.get_singleton_class(ne),A=[q].concat(k),N=a.$r(A),$(q,"$fallbacks",function(){var b=w;return M(A[1],"@@fallbacks",v(null!=A[1].$$cvars["@@fallbacks"]?"class variable":w)&&v(b=D(A[1],"@@fallbacks",!1))?b:p(p(N("I18n"),"Locale"),"Fallbacks").$new()),v(b=N("Thread").$current()["$[]"]("i18n_fallbacks"))?b:D(A[1],"@@fallbacks",!1)},0),$(q,"$fallbacks=",function(g){var b;return M(A[1],"@@fallbacks",v(g["$is_a?"](N("Array")))?p(p(N("I18n"),"Locale"),"Fallbacks").$new(g):g),b=["i18n_fallbacks",D(A[1],"@@fallbacks",!1)],F(N("Thread").$current(),"[]=",oe(b)),b[G(b.length,1)]},1),function(q,z){var g,b,C,h,N=[d(q,"Backend")].concat(z);return g=N,C=[b=d(N[0],"Fallbacks")].concat(g),h=a.$r(C),$(b,"$translate",function u(l,f,_){try{var x=u.$$p||w,S=this,Q=w,le=w;return delete u.$$p,null==_&&(_=h("EMPTY_HASH")),v(_.$fetch("fallback",!0))?v(_["$[]"]("fallback_in_progress"))?L(S,V(S,"translate",u,!1,!0),"translate",[l,f,_],x):(v(_["$[]"]("default"))&&(Q=S["$extract_non_symbol_default!"](_)),le=_.$merge(H(["fallback_in_progress"],{fallback_in_progress:!0})),F(h("I18n").$fallbacks()["$[]"](l),"each",[],function Ce(T){var O=null==Ce.$$s?this:Ce.$$s;null==T&&(T=w);try{return F(O,"catch",["exception"],function re(){var j=null==re.$$s?this:re.$$s,ve=w;if(ve=L(j,se(j,"translate",re.$$def||Ce.$$def||u,!1,!1),"translate",[T,f,le],null),v(ve["$nil?"]()))return w;ue(l.$to_s(),T.$to_s())&&j.$on_fallback(l,T,f,_),a.ret(ve)},{$$arity:0,$$s:O})}catch(re){if(!a.rescue(re,[p(h("I18n"),"InvalidLocale")]))throw re;try{return w}finally{a.pop_exception()}}},{$$arity:1,$$s:S}),v(_["$key?"]("default"))&&v(_["$[]"]("default")["$nil?"]())?w:v(Q)?L(S,V(S,"translate",u,!1,!0),"translate",[l,w,_.$merge(H(["default"],{default:Q}))],null):S.$throw("exception",p(h("I18n"),"MissingTranslation").$new(l,f,_))):L(S,V(S,"translate",u,!1,!0),"translate",[l,f,_],x)}catch(Ce){if(Ce===a.returner)return Ce.$v;throw Ce}},-3),$(b,"$extract_non_symbol_default!",function(l){var _,f=w,x=w;return f=[l["$[]"]("default")].$flatten(),_=F(f,"detect",[],function(Q){return null==Q&&(Q=w),Q["$is_a?"](h("Symbol"))["$!"]()},1),v(_)&&(x=["default",f["$[]"](0,f.$index(_))],F(l,"[]=",oe(x)),G(x.length,1)),_},1),$(b,"$exists?",function u(l,f,_){try{var x=u.$$p||w,S=this;return delete u.$$p,null==_&&(_=h("EMPTY_HASH")),v(_.$fetch("fallback",!0))?(F(h("I18n").$fallbacks()["$[]"](l),"each",[],function Q(le){var Ce=null==Q.$$s?this:Q.$$s;null==le&&(le=w);try{if(!v(L(Ce,se(Ce,"exists?",Q.$$def||u,!1,!1),"exists?",[le,f],null)))return w;a.ret(!0)}catch(T){if(!a.rescue(T,[p(h("I18n"),"InvalidLocale")]))throw T;try{return w}finally{a.pop_exception()}}},{$$arity:1,$$s:S}),!1):L(S,V(S,"exists?",u,!1,!0),"exists?",[l,f,_],x)}catch(Q){if(Q===a.returner)return Q.$v;throw Q}},-3),b.$private(),$(b,"$on_fallback",function(l,f,_,x){return w},4)}(k[0],k)},Opal.modules["bcdice/randomizer"]=function(a){var ne,P,g,b,C,h,q,z,y=[],w=a.nil,p=a.$$$,M=a.klass,v=a.const_set,D=a.def,$=a.truthy,F=a.rb_gt,oe=a.rb_plus,G=a.rb_le,L=a.send,V=a.rb_minus,H=a.eqeq,se=a.rb_times,ue=a.eqeqeq,ee=a.rb_ge;return ne=y,q=[(0,a.module)(y[0],"BCDice")].concat(ne),z=a.$r(q),P=q,b=[g=M(q[0],null,"Randomizer")].concat(P),C=a.$r(b),(h=g.$$prototype).rand_results=h.detailed_rand_results=w,v(b[0],"UPPER_LIMIT_DICE_TIMES",200),v(b[0],"UPPER_LIMIT_DICE_SIDES",1e4),v(b[0],"UPPER_LIMIT_RANDS",1e4),D(g,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]},0),g.$attr_reader("rand_results"),g.$attr_reader("detailed_rand_results"),v(b[0],"DetailedRandResult",C("Struct").$new("kind","sides","value")),D(g,"$roll_barabara",function(l,f){var _=this;return $(F(oe(_.rand_results.$size(),l),C("UPPER_LIMIT_RANDS")))&&_.$raise(C("TooManyRandsError")),$(G(l,0))||$(F(l,C("UPPER_LIMIT_DICE_TIMES")))?[]:L(C("Array"),"new",[l],function x(){return(null==x.$$s?this:x.$$s).$roll_once(f)},{$$arity:0,$$s:_})},2),D(g,"$roll_sum",function(l,f){return this.$roll_barabara(l,f).$sum()},2),D(g,"$roll_once",function(l){var _=w;return $(G(l,0))||$(F(l,C("UPPER_LIMIT_DICE_SIDES")))?0:(_=this.$rand_inner(l),this.$push_to_detail("normal",l,_),_)},1),D(g,"$roll_index",function(l){return V(this.$roll_once(l),1)},1),D(g,"$roll_tens_d10",function(){var _,f=w;return f=this.$rand_inner(10),H(f,10)&&(f=0),_=se(f,10),this.$push_to_detail("tens_d10",10,_),_},0),D(g,"$roll_d9",function(){var f;return f=V(this.$rand_inner(10),1),this.$push_to_detail("d9",10,f),f},0),D(g,"$roll_d66",function(l){var x,_=w;return _=L(C("Array"),"new",[2],function S(){return(null==S.$$s?this:S.$$s).$roll_once(6)},{$$arity:0,$$s:this}),ue(p(C("D66SortType"),"ASC"),x=l)?_["$sort!"]():ue(p(C("D66SortType"),"DESC"),x)&&_["$sort!"]()["$reverse!"](),oe(se(_["$[]"](0),10),_["$[]"](1))},1),g.$private(),D(g,"$rand_inner",function(l){var _,f=this;return $(ee(f.rand_results.$size(),C("UPPER_LIMIT_RANDS")))&&f.$raise(C("TooManyRandsError")),_=f.$random(l),f.rand_results["$<<"]([_,l]),_},1),D(g,"$random",function(l){return oe(C("Kernel").$rand(l),1)},1),D(g,"$push_to_detail",function(l,f,_){var S;return S=C("DetailedRandResult").$new(l,f,_),this.detailed_rand_results.$push(S)},3),M(q[0],z("StandardError"),"TooManyRandsError"),w},Opal.modules["bcdice/dice_table/roll_result"]=function(a){var $,L,ee,Y,ne,k,q,H,oe,y=[],w=a.nil,p=a.module,d=a.klass,M=a.def,v=a.truthy;return $=y,L=oe=[p(y[0],"BCDice")].concat($),ee=H=[p(oe[0],"DiceTable")].concat(L),ne=[Y=d(H[0],null,"RollResult")].concat(ee),k=a.$r(ne),(q=Y.$$prototype).table_name=q.value=q.body=w,M(Y,"$initialize",function(A,N,P){var g=this;return g.table_name=A,g.value=N,g.body=P},3),Y.$attr_reader("table_name"),Y.$attr_reader("value"),Y.$attr_reader("body"),M(Y,"$to_s",function(){var A=this;return A.table_name+"("+A.value+") \uff1e "+A.body},0),M(Y,"$last_body",function(){var A=this;return v(A.body["$is_a?"](k("RollResult")))?A.body.$last_body():A.body},0),M(Y,"$empty?",function(){return!1},0)},Opal.modules["bcdice/dice_table/chain_table"]=function(a){var F,V,Y,ne,k,q,z,se,G,y=[],w=a.nil,p=a.module,d=a.klass,M=a.truthy,v=a.def,D=a.rb_minus;return F=y,V=G=[p(y[0],"BCDice")].concat(F),Y=se=[p(G[0],"DiceTable")].concat(V),k=[ne=d(se[0],null,"ChainTable")].concat(Y),q=a.$r(k),(z=ne.$$prototype).times=z.sides=z.items=z.name=w,v(ne,"$initialize",function(N,P,g){var b=this,C=w;return b.name=N,b.items=g.$freeze(),C=/(\d+)D(\d+)/i.$match(P),M(C)||b.$raise(q("ArgumentError"),"Unexpected table type: "+P),b.times=C["$[]"](1).$to_i(),b.sides=C["$[]"](2).$to_i()},3),v(ne,"$roll",function(N){var g,b,P=this,C=w;return g=N.$roll_sum(P.times,P.sides),b=D(g,P.times),C=P.items["$[]"](b),M(C["$respond_to?"]("roll"))&&(C=C.$roll(N)),q("RollResult").$new(P.name,g,C)},1)},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(a){var L,ue,q,z,A,N,P,Y,H,y=[],w=a.nil,p=a.module,d=a.klass,M=a.hash2,v=a.defs,D=a.def,$=a.rb_plus,F=a.rb_times,oe=a.rb_minus;return L=y,ue=H=[p(y[0],"BCDice")].concat(L),q=Y=[p(H[0],"DiceTable")].concat(ue),A=[z=d(Y[0],null,"D66GridTable")].concat(q),N=a.$r(A),(P=z.$$prototype).name=P.items=w,v(z,"$from_i18n",function(b,C){var u=w;return u=N("I18n").$t(b,M(["locale","raise"],{locale:C,raise:!0})),this.$new(u["$[]"]("name"),u["$[]"]("items"))},2),D(z,"$initialize",function(b,C){return this.name=b,this.items=C.$freeze()},2),D(z,"$roll",function(b){var h,u,l,f,_;return h=b.$roll_once(6),u=b.$roll_once(6),l=$(F(h,10),u),f=oe(h,1),_=oe(u,1),N("RollResult").$new(this.name,l,this.items["$[]"](f)["$[]"](_))},1)},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(a){var oe,H,k,q,z,A,ue,ee,L,w=[],p=a.nil,d=a.module,M=a.klass,v=a.hash2,D=a.defs,$=a.def;return a.top.$require("bcdice/dice_table/d66_grid_table"),oe=w,H=L=[d(w[0],"BCDice")].concat(oe),ue=[d(L[0],"DiceTable")].concat(H),ee=a.$r(ue),k=ue,z=[q=M(ue[0],ee("D66GridTable"),"D66HalfGridTable")].concat(k),A=a.$r(z),D(q,"$from_i18n",function(P,g){var C=p;return C=A("I18n").$t(P,v(["locale","raise"],{locale:g,raise:!0})),this.$new(C["$[]"]("name"),C["$[]"]("items_1_2_3"),C["$[]"]("items_4_5_6"))},2),$(q,"$initialize",function(P,g,b){return this.name=P,this.items=[g,g,g,b,b,b].$freeze()},3)},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(a){var oe,H,k,q,z,A,ue,ee,L,w=[],p=a.nil,d=a.module,M=a.klass,v=a.hash2,D=a.defs,$=a.def;return a.top.$require("bcdice/dice_table/d66_grid_table"),oe=w,H=L=[d(w[0],"BCDice")].concat(oe),ue=[d(L[0],"DiceTable")].concat(H),ee=a.$r(ue),k=ue,z=[q=M(ue[0],ee("D66GridTable"),"D66OneThirdTable")].concat(k),A=a.$r(z),D(q,"$from_i18n",function(P,g){var C=p;return C=A("I18n").$t(P,v(["locale","raise"],{locale:g,raise:!0})),this.$new(C["$[]"]("name"),C["$[]"]("items_1_2"),C["$[]"]("items_3_4"),C["$[]"]("items_5_6"))},2),$(q,"$initialize",function(P,g,b,C){return this.name=P,this.items=[g,g,b,b,C,C].$freeze()},4)},Opal.modules["bcdice/dice_table/d66_table"]=function(a){var H,Y,A,N,P,g,b,k,ue,y=[],w=a.nil,p=a.$$$,d=a.module,M=a.klass,v=a.hash2,D=a.defs,$=a.def,F=a.eqeqeq,oe=a.rb_plus,G=a.rb_times,L=a.truthy;return H=y,Y=ue=[d(y[0],"BCDice")].concat(H),A=k=[d(ue[0],"DiceTable")].concat(Y),P=[N=M(k[0],null,"D66Table")].concat(A),g=a.$r(P),(b=N.$$prototype).sort_type=b.items=b.name=w,D(N,"$from_i18n",function(h,u){var _,f=w;return f=g("I18n").$t(h,v(["locale"],{locale:u})),_=g("D66SortType").$const_get(f["$[]"]("d66_sort_type")),this.$new(f["$[]"]("name"),_,f["$[]"]("items"))},2),$(N,"$initialize",function(h,u,l){var f=this;return f.name=h,f.sort_type=u,f.items=l.$freeze()},3),$(N,"$roll",function(h){var u=this,l=w,f=w,_=w,x=w;return l=h.$roll_barabara(2,6),F(p(g("D66SortType"),"ASC"),f=u.sort_type)?l["$sort!"]():F(p(g("D66SortType"),"DESC"),f)&&l["$sort!"]()["$reverse!"](),_=oe(G(l["$[]"](0),10),l["$[]"](1)),x=L(f=u.items["$[]"](_))?f:u.items["$[]"](_.$to_s()),L(x["$respond_to?"]("roll"))&&(x=x.$roll(h)),g("RollResult").$new(u.name,_,x)},1),$(N,"$choice",function(h){return g("RollResult").$new(this.name,h,this.items["$[]"](h))},1)},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(a){var ee,q,A,N,ne,w=[],p=a.nil,d=a.module,M=a.klass,v=a.hash2,D=a.send,$=a.to_ary,F=a.rb_plus,oe=a.rb_times,G=a.to_a,L=a.rb_minus,V=a.send2,H=a.find_super,se=a.def;return a.top.$require("bcdice/dice_table/d66_table"),ee=w,q=ne=[d(w[0],"BCDice")].concat(ee),A=[d(ne[0],"DiceTable")].concat(q),N=a.$r(A),se(M(A[0],N("D66Table"),"D66LeftRangeTable"),"$initialize",function C(h,u,l){var x;return delete C.$$p,x=v([],{}),D(l,"each",[],function(Q){var le,O;return null==Q&&(Q=p),le=$(Q),O=null==le[1]?p:le[1],D(null==le[0]?p:le[0],"each",[],function(j){return null==j&&(j=p),D(O,"each_with_index",[],function(de,Ee){var ce,he;return null==de&&(de=p),null==Ee&&(Ee=p),ce=F(oe(j,10),F(Ee,1)),D(x,"[]=",G(he=[ce,de])),he[L(he.length,1)]},2)},1)},1),V(this,H(this,"initialize",C,!1,!0),"initialize",[h,u,x],null)},3)},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(a){var V,ee,z,A,N,P,g,ne,se,y=[],w=a.nil,p=a.module,d=a.klass,M=a.hash2,v=a.defs,D=a.def,$=a.truthy,F=a.rb_minus,oe=a.rb_plus,G=a.rb_times;return V=y,ee=se=[p(y[0],"BCDice")].concat(V),z=ne=[p(se[0],"DiceTable")].concat(ee),N=[A=d(ne[0],null,"D66ParityTable")].concat(z),P=a.$r(N),(g=A.$$prototype).odd=g.even=g.name=w,v(A,"$from_i18n",function(C,h){var l=w;return l=P("I18n").$t(C,M(["locale","raise"],{locale:h,raise:!0})),this.$new(l["$[]"]("name"),l["$[]"]("odd"),l["$[]"]("even"))},2),D(A,"$initialize",function(C,h,u){var l=this;return l.name=C,l.odd=h.$freeze(),l.even=u.$freeze()},3),D(A,"$roll",function(C){var l,_,x,h=this,u=w;return u=C.$roll_once(6),l=C.$roll_once(6),_=($(u["$odd?"]())?h.odd:h.even)["$[]"](F(l,1)),x=oe(G(u,10),l),P("RollResult").$new(h.name,x,_)},1)},Opal.modules["bcdice/dice_table/d66_range_table"]=function(a){var oe,H,ne,k,q,z,A,ue,L,y=[],w=a.nil,p=a.module,d=a.klass,M=a.def,v=a.rb_plus,D=a.rb_times,$=a.send;return oe=y,H=L=[p(y[0],"BCDice")].concat(oe),ne=ue=[p(L[0],"DiceTable")].concat(H),q=[k=d(ue[0],null,"D66RangeTable")].concat(ne),z=a.$r(q),(A=k.$$prototype).items=A.name=w,M(k,"$initialize",function(P,g){return this.name=P,this.items=g.$freeze()},2),M(k,"$roll",function(P){var b,C,h,u=w;return b=P.$roll_once(6),C=P.$roll_once(6),h=v(D(b,10),C),u=$(this.items,"find",[],function(f){return null==f&&(f=w),f["$[]"](0)["$include?"](h)},1),z("RollResult").$new(this.name,h,u["$[]"](1))},1)},Opal.modules["bcdice/dice_table/range_table"]=function(a){var se,ne,N,P,g,b,C,q,ee,y=[],w=a.nil,p=a.module,d=a.klass,M=a.const_set,v=a.send,D=a.truthy,$=a.def,F=a.to_a,oe=a.rb_minus,G=a.eqeqeq,L=a.rb_times,V=a.rb_plus;return se=y,ne=ee=[p(y[0],"BCDice")].concat(se),N=q=[p(ee[0],"DiceTable")].concat(ne),g=[P=d(q[0],null,"RangeTable")].concat(N),b=a.$r(g),(C=P.$$prototype).name=C.items=C.num_of_dice=C.num_of_sides=C.formatter=w,M(g[0],"RollResult",v(b("Struct"),"new",["sum","values","content","formatted"],function h(){return(null==h.$$s?this:h.$$s).$alias_method("to_s","formatted")},{$$arity:0,$$s:P})),M(g[0],"Item",b("Struct").$new("range","content")),M(g[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),M(g[0],"DEFAULT_FORMATTER",v(P,"lambda",[],function(u,l){return null==u&&(u=w),null==l&&(l=w),u.$name()+"("+l.$sum()+") \uff1e "+l.$content()},2)),P.$attr_reader("name"),P.$attr_reader("num_of_dice"),P.$attr_reader("num_of_sides"),$(P,"$initialize",function h(u,l,f){var S,_=h.$$p||w,x=this,Q=w;return delete h.$$p,x.name=u.$freeze(),x.formatter=D(S=_)?S:b("DEFAULT_FORMATTER"),Q=b("DICE_ROLL_METHOD_RE").$match(l),D(Q)||x.$raise(b("ArgumentError"),x.name+": invalid dice roll method: "+l),x.num_of_dice=Q["$[]"](1).$to_i(),x.num_of_sides=Q["$[]"](2).$to_i(),x.$store(f)},3),$(P,"$fetch",function(u){var f,l=this;return f=v(l.items,"find",[],function(x){return null==x&&(x=w),x.$range()["$include?"](u)},1),D(f)||l.$raise(b("RangeError"),l.name+": value is out of range: "+u),f},1),$(P,"$roll",function(u){var _,x,S,l=this,f=w;return _=(f=u.$roll_barabara(l.num_of_dice,l.num_of_sides)).$sum(),x=b("RollResult").$new(_,f,l.$fetch(_).$content()),S=[l.formatter["$[]"](l,x)],v(x,"formatted=",F(S)),oe(S.length,1),x},1),P.$private(),$(P,"$store",function(u){var f,_,l=this;return f=v(u,"map",[],function x(S,Q){return null==S&&(S=w),null==Q&&(Q=w),[(null==x.$$s?this:x.$$s).$coerce_to_int_range(S),Q]},{$$arity:2,$$s:l}),_=v(f,"sort_by",[],function(S,Q){return null==S&&(S=w),null==Q&&(Q=w),S.$min()},2),l.$assert_min_sum_is_covered(_),l.$assert_max_sum_is_covered(_),l.$assert_no_gap_or_overlap_in_ranges(_),l.items=v(_,"map",[],function(S,Q){return null==S&&(S=w),null==Q&&(Q=w),b("Item").$new(S,Q.$freeze()).$freeze()},2).$freeze(),l},1),$(P,"$coerce_to_int_range",function(u){var f;return G(b("Integer"),f=u)?b("Range").$new(u,u):G(b("Range"),f)&&D(u.$begin()["$is_a?"](b("Integer")))&&D(u.$end()["$is_a?"](b("Integer")))?u:this.$raise(b("TypeError"),this.name+": "+u+" ("+u.$class()+") must be an Integer or a Range with Integers ")},1),$(P,"$assert_min_sum_is_covered",function(u){var f,l=this,_=w;return f=l.num_of_dice,_=u.$first()["$[]"](0),D(_["$include?"](f))||l.$raise(b("RangeError"),l.name+": min value ("+f+") is not covered: "+_),l},1),$(P,"$assert_max_sum_is_covered",function(u){var f,l=this,_=w;return f=L(l.num_of_dice,l.num_of_sides),_=u.$last()["$[]"](0),D(_["$include?"](f))||l.$raise(b("RangeError"),l.name+": max value ("+f+") is not covered: "+_),l},1),$(P,"$assert_no_gap_or_overlap_in_ranges",function(u){return v(u,"each_cons",[2],function f(_,x){var Ce,T,S=null==f.$$s?this:f.$$s,Q=w,le=w;return null==S.name&&(S.name=w),null==_&&(_=w),null==x&&(x=w),Q=_["$[]"](0),le=x["$[]"](0),Ce=Q.$max(),T=V(Ce,1),D(le["$include?"](Ce))&&S.$raise(b("RangeError"),S.name+": Range overlap: "+Q+" and "+le),D(le["$include?"](T))?w:S.$raise(b("RangeError"),S.name+": Range gap: "+Q+" and "+le)},{$$arity:2,$$s:this}),this},1)},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(a){var oe,H,ne,N,P,g,b,q,ue,L,y=[],w=a.nil,p=a.$$$,d=a.module,M=a.klass,v=a.send,D=a.def,$=a.rb_minus;return oe=y,H=L=[d(y[0],"BCDice")].concat(oe),ne=ue=[d(L[0],"DiceTable")].concat(H),N=q=[M(ue[0],null,"SaiFicSkillTable")].concat(ne),g=[P=M(q[0],null,"Category")].concat(N),b=a.$r(g),P.$$prototype.name=w,D(P,"$initialize",function(u,l,f,_){var x=this;return x.name=u,x.skills=v(l.$map(),"with_index",[2],function(Q,le){return null==Q&&(Q=w),null==le&&(le=w),p(b("SaiFicSkillTable"),"Skill").$new(u,Q,f,le,_)},2),x.dice=f},4),D(P,"$roll",function(u){return this.$skills()["$[]"]($(u.$roll_sum(2,6),2))},1),D(P,"$to_s",function(){return this.name},0),P.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(a){var $,L,ee,z,A,ne,H,oe,y=[],w=a.nil,p=a.module,d=a.klass,M=a.def,v=a.hash2;return $=y,L=oe=[p(y[0],"BCDice")].concat($),ee=H=[p(oe[0],"DiceTable")].concat(L),ne=[d(H[0],null,"SaiFicSkillTable")].concat(ee),(A=(z=d(ne[0],null,"Skill")).$$prototype).s_format=A.category_dice=A.row_dice=A.category_name=A.name=w,M(z,"$initialize",function(P,g,b,C,h){var u=this;return u.category_name=P,u.name=g,u.category_dice=b,u.row_dice=C,u.s_format=h},5),M(z,"$to_s",function(){var P=this;return P.$format(P.s_format,v(["category_dice","row_dice","category_name","skill_name"],{category_dice:P.category_dice,row_dice:P.row_dice,category_name:P.category_name,skill_name:P.name}))},0),z.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(a){var Y,z,b,C,h,u,l,N,k,y=a.top,w=[],p=a.nil,d=a.$$$,M=a.module,v=a.klass,D=a.hash2,$=a.send,oe=a.defs,G=a.const_set,L=a.to_ary,V=a.def,H=a.truthy,se=a.rb_minus,ue=a.rb_plus;return y.$require("bcdice/dice_table/sai_fic_skill_table/category"),y.$require("bcdice/dice_table/sai_fic_skill_table/skill"),Y=w,z=k=[M(w[0],"BCDice")].concat(Y),b=N=[M(k[0],"DiceTable")].concat(z),h=[C=v(N[0],null,"SaiFicSkillTable")].concat(b),u=a.$r(h),(l=C.$$prototype).rtt=l.rtt_format=l.rct=l.rct_format=l.rttn=l.rttn_format=l.categories=p,oe(C,"$from_i18n",function(_,x,S){var Q,le,Ce,j,re=p;if(null==S)S=D([],{});else if(!S.$$is_hash)throw a.ArgumentError.$new("expected kwargs");return null==(Q=S.$$smap.rtt)&&(Q=p),null==(le=S.$$smap.rct)&&(le=p),null==(Ce=S.$$smap.rttn)&&(Ce=p),j=(re=u("I18n").$t("RTT",D(["locale","raise","default"],{locale:x,raise:!1,default:D([],{})})).$merge(u("I18n").$t(_,D(["locale","raise"],{locale:x,raise:!0}))))["$[]"]("items"),re=$(re,"select",[],function(de,Ee){return null==de&&(de=p),null==Ee&&(Ee=p),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](de)},2),this.$new(j,a.to_hash(re).$merge(D(["rtt","rct","rttn"],{rtt:Q,rct:le,rttn:Ce})))},-3),G(h[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),G(h[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),G(h[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),G(h[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),V(C,"$initialize",function(_,x){var S,Q,le,Ce,T,O,re,j=this;if(null==x)x=D([],{});else if(!x.$$is_hash)throw a.ArgumentError.$new("expected kwargs");return null==(S=x.$$smap.rtt)&&(S=p),null==(Q=x.$$smap.rct)&&(Q=p),null==(le=x.$$smap.rttn)&&(le=p),null==(Ce=x.$$smap.rtt_format)&&(Ce=u("DEFAULT_RTT")),null==(T=x.$$smap.rct_format)&&(T=u("DEFAULT_RCT")),null==(O=x.$$smap.rttn_format)&&(O=u("DEFAULT_RTTN")),null==(re=x.$$smap.s_format)&&(re=u("DEFAULT_S")),j.categories=$(_.$map(),"with_index",[1],function(de,Ee){var ce,B,R;return null==de&&(de=p),null==Ee&&(Ee=p),B=null==(ce=L(de))[0]?p:ce[0],R=null==ce[1]?p:ce[1],d(u("SaiFicSkillTable"),"Category").$new(B,R,Ee,re)},{$$arity:2,$$has_top_level_mlhs_arg:!0}),j.rtt=S,j.rct=Q,j.rttn=le.$to_a(),j.rtt_format=Ce,j.rct_format=T,j.rttn_format=O},-2),G(h[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),C.$attr_reader("categories"),V(C,"$roll_command",function(_,x){var Q,S=this,le=p,Ce=p;return H(["RTT",S.rtt]["$include?"](Q=x))?S.$format_skill(S.rtt_format,S.$roll_skill(_)):H(["RCT",S.rct]["$include?"](Q))?(le=S.$roll_category(_),S.$format(S.rct_format,D(["category_dice","category_name"],{category_dice:le.$dice(),category_name:le.$name()}))):H(Ce=u("RTTN").$index(Q))||H(Ce=S.rttn.$index(Q))?S.$format_skill(S.rttn_format,S.categories["$[]"](Ce).$roll(_)):p},2),V(C,"$roll_category",function(_){return this.categories["$[]"](se(_.$roll_once(6),1))},1),V(C,"$roll_skill",function(_){return this.$roll_category(_).$roll(_)},1),V(C,"$prefixes",function(){var _=this;return ue(["RTT[1-6]?","RCT",_.rtt,_.rct],_.rttn).$compact()},0),C.$private(),V(C,"$format_skill",function(_,x){return this.$format(_,D(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:x.$category_dice(),row_dice:x.$row_dice(),category_name:x.$category_name(),skill_name:x.$name(),text:x.$to_s()}))},2)},Opal.modules["bcdice/dice_table/table"]=function(a){var G,se,k,q,z,A,N,ee,V,y=[],w=a.nil,p=a.module,d=a.klass,M=a.hash2,v=a.defs,D=a.truthy,$=a.def,F=a.rb_minus;return G=y,se=V=[p(y[0],"BCDice")].concat(G),k=ee=[p(V[0],"DiceTable")].concat(se),z=[q=d(ee[0],null,"Table")].concat(k),A=a.$r(z),(N=q.$$prototype).times=N.sides=N.name=N.items=w,v(q,"$from_i18n",function(g,b){var h=w;return h=A("I18n").$t(g,M(["locale"],{locale:b})),this.$new(h["$[]"]("name"),h["$[]"]("type"),h["$[]"]("items"))},2),$(q,"$initialize",function(g,b,C){var h=this,u=w;return h.name=g,h.items=C.$freeze(),u=/(\d+)D(\d+)/i.$match(b),D(u)||h.$raise(A("ArgumentError"),"Unexpected table type: "+b),h.times=u["$[]"](1).$to_i(),h.sides=u["$[]"](2).$to_i()},3),$(q,"$roll",function(g){var C,b=this;return C=g.$roll_sum(b.times,b.sides),b.$choice(C)},1),$(q,"$choice",function(g){var C,b=this;return C=F(g,b.times),A("RollResult").$new(b.name,g,b.items["$[]"](C))},1)},Opal.modules["bcdice/dice_table"]=function(a){var y=a.top;return y.$require("bcdice/dice_table/roll_result"),y.$require("bcdice/dice_table/chain_table"),y.$require("bcdice/dice_table/d66_grid_table"),y.$require("bcdice/dice_table/d66_half_grid_table"),y.$require("bcdice/dice_table/d66_one_third_table"),y.$require("bcdice/dice_table/d66_left_range_table"),y.$require("bcdice/dice_table/d66_parity_table"),y.$require("bcdice/dice_table/d66_range_table"),y.$require("bcdice/dice_table/d66_table"),y.$require("bcdice/dice_table/range_table"),y.$require("bcdice/dice_table/sai_fic_skill_table"),y.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(a){var v,oe,L,$,y=[],p=a.module,d=a.const_set;return v=y,oe=$=[p(y[0],"BCDice")].concat(v),L=[p($[0],"D66SortType")].concat(oe),d(L[0],"NO_SORT","no_sort"),d(L[0],"ASC","asc"),d(L[0],"DESC","desc"),function(F,oe){var L=[p(F,"RoundType")].concat(oe);return d(L[0],"CEIL","ceil"),d(L[0],"FLOOR","floor"),d(L[0],"ROUND","round")}($[0],$)},Opal.modules["bcdice/translate"]=function(a){var $,L,V,H,se,oe,y=[],w=a.nil,p=a.module,d=a.hash2,v=a.def;return $=y,L=oe=[p(y[0],"BCDice")].concat($),H=[V=p(oe[0],"Translate")].concat(L),se=a.$r(H),v(V,"$translate",function(ee,Y){var ne,k=this;if(null==k.locale&&(k.locale=w),null==Y)Y=d([],{});else if(!Y.$$is_hash)throw a.ArgumentError.$new("expected kwargs");return ne=a.kwrestargs(Y,{}),se("I18n").$translate(ee,d(["locale","raise"],{locale:k.locale,raise:!0}).$merge(a.to_hash(ne)))},-2)},Opal.modules["bcdice/result"]=function(a){var oe,se,ne,ue,Y,L,y=[],w=a.nil,d=a.klass,M=a.send,v=a.to_a,D=a.rb_minus,$=a.def;return oe=y,se=L=[(0,a.module)(y[0],"BCDice")].concat(oe),[ue=d(L[0],null,"Result")].concat(se),(Y=ue.$$prototype).secret=Y.success=Y.failure=Y.critical=Y.fumble=w,$(ne=a.get_singleton_class(ue),"$success",function(z){return M(this.$new(),"tap",[],function(P){var g=w;return null==P&&(P=w),M(P,"text=",v(g=[z])),D(g.length,1),M(P,"success=",v(g=[!0])),g[D(g.length,1)]},1)},1),$(ne,"$failure",function(z){return M(this.$new(),"tap",[],function(P){var g=w;return null==P&&(P=w),M(P,"text=",v(g=[z])),D(g.length,1),M(P,"failure=",v(g=[!0])),g[D(g.length,1)]},1)},1),$(ne,"$critical",function(z){return M(this.$new(),"tap",[],function(P){var g=w;return null==P&&(P=w),M(P,"text=",v(g=[z])),D(g.length,1),M(P,"critical=",v(g=[!0])),D(g.length,1),M(P,"success=",v(g=[!0])),g[D(g.length,1)]},1)},1),$(ne,"$fumble",function(z){return M(this.$new(),"tap",[],function(P){var g=w;return null==P&&(P=w),M(P,"text=",v(g=[z])),D(g.length,1),M(P,"fumble=",v(g=[!0])),D(g.length,1),M(P,"failure=",v(g=[!0])),g[D(g.length,1)]},1)},1),$(ne,"$nothing",function(){return"nothing"},0),$(ue,"$initialize",function(k){var q=this;return null==k&&(k=w),q.text=k,q.rands=w,q.detailed_rands=w,q.secret=!1,q.success=!1,q.failure=!1,q.critical=!1,q.fumble=!1},-1),ue.$attr_accessor("text","rands","detailed_rands"),ue.$attr_writer("secret","success","failure","critical","fumble"),$(ue,"$secret?",function(){return this.secret},0),$(ue,"$success?",function(){return this.success},0),$(ue,"$failure?",function(){return this.failure},0),$(ue,"$critical?",function(){return this.critical},0),$(ue,"$fumble?",function(){return this.fumble},0),$(ue,"$condition=",function(k){return this.success=k,this.failure=k["$!"]()},1)},Opal.modules["racc/parser"]=function(a){var b,h,u,w=[],p=a.$r(w),d=a.nil,M=a.$$$,v=a.module,D=a.klass,$=a.truthy,F=a.const_set,oe=a.defs,G=a.gvars,L=a.rb_lt,V=a.send,H=a.to_a,se=a.rb_minus,ue=a.def,ee=a.to_ary,Y=a.neqeq,ne=a.rb_plus,k=a.eqeq,q=a.rb_ge,z=a.rb_gt,A=a.eqeqeq,N=a.rb_le,P=a.rb_times;return b=w,h=[v(w[0],"Racc")].concat(b),u=a.$r(h),D(h[0],u("StandardError"),"ParseError"),$(M("::","ParseError","skip_raise")?"constant":d)||F(w[0],"ParseError",M(p("Racc"),"ParseError")),function(g,b){var x,S,Q,le,Ce,u=[v(g,"Racc")].concat(b),l=a.$r(u);return $(l("Racc_No_Extensions","skip_raise")?"constant":d)||F(u[0],"Racc_No_Extensions",!1),x=u,Q=[S=D(u[0],null,"Parser")].concat(x),le=a.$r(Q),(Ce=S.$$prototype).yydebug=Ce.racc_debug_out=Ce.racc_error_status=Ce.racc_t=Ce.racc_vstack=Ce.racc_val=Ce.racc_state=Ce.racc_tstack=d,F(Q[0],"Racc_Runtime_Version","1.4.6"),F(Q[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),F(Q[0],"Racc_Runtime_Core_Version_R","1.4.6"),F(Q[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),F(Q[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),F(Q[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),F(Q[0],"Racc_Runtime_Core_Version",le("Racc_Runtime_Core_Version_R")),F(Q[0],"Racc_Runtime_Core_Revision",le("Racc_Runtime_Core_Revision_R")),F(Q[0],"Racc_Runtime_Type","ruby"),oe(le("Parser"),"$racc_runtime_type",function(){return le("Racc_Runtime_Type")},0),ue(S,"$_racc_setup",function(){var O,re,j=this,ve=d,de=d,Ee=d;return null==G.stderr&&(G.stderr=d),$(M(j.$class(),"Racc_debug_parser"))||(j.yydebug=!1),$(null!=(O=j.yydebug)&&O!==d?"instance-variable":d)||(j.yydebug=!1),$(j.yydebug)&&($(null!=(re=j.racc_debug_out)&&re!==d?"instance-variable":d)||(j.racc_debug_out=G.stderr),j.racc_debug_out=$(ve=j.racc_debug_out)?ve:G.stderr),de=M(j.$class(),"Racc_arg"),$(L(de.$size(),14))&&(V(de,"[]=",H(Ee=[13,!0])),se(Ee.length,1)),de},0),ue(S,"$_racc_init_sysvars",function(){var O=this;return O.racc_state=[0],O.racc_tstack=[],O.racc_vstack=[],O.racc_t=d,O.racc_val=d,O.racc_read_next=!0,O.racc_user_yyerror=!1,O.racc_error_status=0},0),ue(S,"$do_parse",function(){return this.$__send__(le("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},0),ue(S,"$next_token",function(){return this.$raise(le("NotImplementedError"),this.$class()+"#next_token is not defined")},0),ue(S,"$_racc_do_parse_rb",function(O,re){var j,Ee=d,ce=d,he=d,B=d,ie=d,W=d,me=d,$e=d;return j=ee(O),Ee=null==j[0]?d:j[0],ce=null==j[1]?d:j[1],he=null==j[2]?d:j[2],B=null==j[3]?d:j[3],ie=null==j[10]?d:j[10],this.$_racc_init_sysvars(),W=me=$e=d,V(this,"catch",["racc_end_parse"],function _e(){var Pe,Ae,Ne=null==_e.$$s?this:_e.$$s,We=d;for(null==Ne.racc_state&&(Ne.racc_state=d),null==Ne.racc_read_next&&(Ne.racc_read_next=d),null==Ne.racc_t&&(Ne.racc_t=d),null==Ne.yydebug&&(Ne.yydebug=d),null==Ne.racc_val&&(Ne.racc_val=d);$(!0);)for($($e=B["$[]"](Ne.racc_state["$[]"](-1)))?($(Ne.racc_read_next)&&Y(Ne.racc_t,0)&&(Ae=Ne.$next_token(),Pe=ee(Ae),W=null==Pe[0]?d:Pe[0],Ne.racc_val=null==Pe[1]?d:Pe[1],Ne.racc_t=$(W)?$(We=ie["$[]"](W))?We:1:0,$(Ne.yydebug)&&Ne.$racc_read_token(Ne.racc_t,W,Ne.racc_val),Ne.racc_read_next=!1),$e=ne($e,Ne.racc_t),$(q($e,0))&&$(me=Ee["$[]"]($e))&&k(ce["$[]"]($e),Ne.racc_state["$[]"](-1))||(me=he["$[]"](Ne.racc_state["$[]"](-1)))):me=he["$[]"](Ne.racc_state["$[]"](-1));$(me=Ne.$_racc_evalact(me,O)););},{$$arity:0,$$s:this})},2),ue(S,"$yyparse",function(O,re){return this.$__send__(le("Racc_YY_Parse_Method"),O,re,this.$_racc_setup(),!0)},2),ue(S,"$_racc_yyparse_rb",function(O,re,j,ve){var de,he=d,B=d,R=d,ie=d,me=d,$e=d,_e=d;return de=ee(j),he=null==de[0]?d:de[0],B=null==de[1]?d:de[1],R=null==de[2]?d:de[2],ie=null==de[3]?d:de[3],me=null==de[10]?d:de[10],this.$_racc_init_sysvars(),$e=d,_e=d,V(this,"catch",["racc_end_parse"],function Ie(){var Ne=null==Ie.$$s?this:Ie.$$s;for(null==Ne.racc_state&&(Ne.racc_state=d);!$(_e=ie["$[]"](Ne.racc_state["$[]"](-1)));)for(;$($e=Ne.$_racc_evalact(R["$[]"](Ne.racc_state["$[]"](-1)),j)););return V(O,"__send__",[re],function We(nt,Nt){var mt=null==We.$$s?this:We.$$s,$t=d,cr=d;for(null==mt.racc_t&&(mt.racc_t=d),null==mt.racc_state&&(mt.racc_state=d),null==mt.racc_read_next&&(mt.racc_read_next=d),null==nt&&(nt=d),null==Nt&&(Nt=d),mt.racc_t=$(nt)?$($t=me["$[]"](nt))?$t:1:0,mt.racc_val=Nt,mt.racc_read_next=!1,_e=ne(_e,mt.racc_t),$(q(_e,0))&&$($e=he["$[]"](_e))&&k(B["$[]"](_e),mt.racc_state["$[]"](-1))||($e=R["$[]"](mt.racc_state["$[]"](-1)));$($e=mt.$_racc_evalact($e,j)););for(;$($($t=$(cr=(_e=ie["$[]"](mt.racc_state["$[]"](-1)))["$!"]())?cr:mt.racc_read_next["$!"]())?$t:mt.racc_t["$=="](0));)for($(_e)&&$(_e=ne(_e,mt.racc_t))&&$(q(_e,0))&&$($e=he["$[]"](_e))&&k(B["$[]"](_e),mt.racc_state["$[]"](-1))||($e=R["$[]"](mt.racc_state["$[]"](-1)));$($e=mt.$_racc_evalact($e,j)););},{$$arity:2,$$s:Ne})},{$$arity:0,$$s:this})},4),ue(S,"$_racc_evalact",function(O,re){var j,R,de=this,Ee=d,ce=d,B=d,ie=d,W=d,me=d,$e=d;if(Ee=null==(j=ee(re))[0]?d:j[0],ce=null==j[1]?d:j[1],B=null==j[3]?d:j[3],R=null==j[11]?d:j[11],ie=null==j[12]?d:j[12],$(z(O,0))&&$(L(O,R)))$(z(de.racc_error_status,0))&&(k(de.racc_t,1)||(de.racc_error_status=se(de.racc_error_status,1))),de.racc_vstack.$push(de.racc_val),de.racc_state.$push(O),de.racc_read_next=!0,$(de.yydebug)&&(de.racc_tstack.$push(de.racc_t),de.$racc_shift(de.racc_t,de.racc_tstack,de.racc_vstack));else if($(L(O,0))&&$(z(O,ie["$-@"]()))){if(W=V(de,"catch",["racc_jump"],function _e(){var Ie=null==_e.$$s?this:_e.$$s;return null==Ie.racc_state&&(Ie.racc_state=d),Ie.racc_state.$push(Ie.$_racc_do_reduce(re,O)),!1},{$$arity:0,$$s:de}),$(W)){if(A(1,me=W))return de.racc_user_yyerror=!0,ie["$-@"]();if(A(2,me))return R;de.$raise("[Racc Bug] unknown jump code")}}else if(k(O,R))$(de.yydebug)&&de.$racc_accept(),de.$throw("racc_end_parse",de.racc_vstack["$[]"](0));else{if(k(O,ie["$-@"]())){for(A(0,me=de.racc_error_status)?$(re["$[]"](21))||de.$on_error(de.racc_t,de.racc_val,de.racc_vstack):A(3,me)&&(k(de.racc_t,0)&&de.$throw("racc_end_parse",d),de.racc_read_next=!0),de.racc_user_yyerror=!1,de.racc_error_status=3;$(!0)&&!($($e=B["$[]"](de.racc_state["$[]"](-1)))&&($e=ne($e,1),$(q($e,0))&&$(O=Ee["$[]"]($e))&&k(ce["$[]"]($e),de.racc_state["$[]"](-1))));)$(N(de.racc_state.$size(),1))&&de.$throw("racc_end_parse",d),de.racc_state.$pop(),de.racc_vstack.$pop(),$(de.yydebug)&&(de.racc_tstack.$pop(),de.$racc_e_pop(de.racc_state,de.racc_tstack,de.racc_vstack));return O}de.$raise("[Racc Bug] unknown action "+O.$inspect())}return $(de.yydebug)&&de.$racc_next_state(de.racc_state["$[]"](-1),de.racc_state),d},2),ue(S,"$_racc_do_reduce",function(O,re){var j,ie,me,Ne,We,nt,mt,de=this,ce=d,he=d,B=d,R=d,W=d,$e=d,_e=d,Ie=d,Pe=d,Ae=d,Nt=d,jt=d,Ot=d,$t=d;return ce=null==(j=ee(O))[4]?d:j[4],he=null==j[5]?d:j[5],B=null==j[6]?d:j[6],R=null==j[7]?d:j[7],ie=null==j[8]?d:j[8],W=null==j[9]?d:j[9],me=null==j[13]?d:j[13],$e=de.racc_state,_e=de.racc_vstack,Ie=de.racc_tstack,Pe=P(re,-3),Ae=W["$[]"](Pe),Ne=W["$[]"](ne(Pe,1)),We=W["$[]"](ne(Pe,2)),nt=[],$(de.yydebug)&&(Nt=Ie["$[]"](Ae["$-@"](),Ae)),jt=_e["$[]"](Ae["$-@"](),Ae),$(de.yydebug)&&(Ot=[Ae["$-@"](),Ae,nt],V(Ie,"[]=",H(Ot)),se(Ot.length,1)),Ot=[Ae["$-@"](),Ae,nt],V(_e,"[]=",H(Ot)),se(Ot.length,1),Ot=[Ae["$-@"](),Ae,nt],V($e,"[]=",H(Ot)),se(Ot.length,1),$(me)?_e.$push(de.$__send__(We,jt,_e,jt["$[]"](0))):_e.$push(de.$__send__(We,jt,_e)),Ie.$push(Ne),$(de.yydebug)&&de.$racc_reduce(Nt,Ne,Ie,_e),mt=se(Ne,ie),$(Pe=R["$[]"](mt))&&(Pe=ne(Pe,$e["$[]"](-1)),$(q(Pe,0))&&$($t=ce["$[]"](Pe))&&k(he["$[]"](Pe),mt))?$t:B["$[]"](mt)},2),ue(S,"$on_error",function(O,re,j){var de;return this.$raise(le("ParseError"),this.$sprintf("\nparse error on value %s (%s)",re.$inspect(),$(de=this.$token_to_str(O))?de:"?"))},3),ue(S,"$yyerror",function(){return this.$throw("racc_jump",1)},0),ue(S,"$yyaccept",function(){return this.$throw("racc_jump",2)},0),ue(S,"$yyerrok",function(){return this.racc_error_status=0},0),ue(S,"$racc_read_token",function(O,re,j){var ve=this;return ve.racc_debug_out.$print("read    "),ve.racc_debug_out.$print(re.$inspect(),"(",ve.$racc_token2str(O),") "),ve.racc_debug_out.$puts(j.$inspect()),ve.racc_debug_out.$puts()},3),ue(S,"$racc_shift",function(O,re,j){return this.racc_debug_out.$puts("shift   "+this.$racc_token2str(O)),this.$racc_print_stacks(re,j),this.racc_debug_out.$puts()},3),ue(S,"$racc_reduce",function(O,re,j,ve){var de=this,Ee=d;return(Ee=de.racc_debug_out).$print("reduce "),$(O["$empty?"]())?Ee.$print(" <none>"):V(O,"each",[],function ce(he){return null==he&&(he=d),Ee.$print(" ",(null==ce.$$s?this:ce.$$s).$racc_token2str(he))},{$$arity:1,$$s:de}),Ee.$puts(" --\x3e "+de.$racc_token2str(re)),de.$racc_print_stacks(j,ve),de.racc_debug_out.$puts()},4),ue(S,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},0),ue(S,"$racc_e_pop",function(O,re,j){return this.racc_debug_out.$puts("error recovering mode: pop token"),this.$racc_print_states(O),this.$racc_print_stacks(re,j),this.racc_debug_out.$puts()},3),ue(S,"$racc_next_state",function(O,re){var j=this;return j.racc_debug_out.$puts("goto    "+O),j.$racc_print_states(re),j.racc_debug_out.$puts()},2),ue(S,"$racc_print_stacks",function(O,re){var ve=d;return(ve=this.racc_debug_out).$print("        ["),V(O,"each_index",[],function de(Ee){return null==Ee&&(Ee=d),ve.$print(" (",(null==de.$$s?this:de.$$s).$racc_token2str(O["$[]"](Ee))," ",re["$[]"](Ee).$inspect(),")")},{$$arity:1,$$s:this}),ve.$puts(" ]")},2),ue(S,"$racc_print_states",function(O){var j=d;return(j=this.racc_debug_out).$print("        ["),V(O,"each",[],function(de){return null==de&&(de=d),j.$print(" ",de)},1),j.$puts(" ]")},1),ue(S,"$racc_token2str",function(O){var j;return $(j=M(this.$class(),"Racc_token_to_s_table")["$[]"](O))?j:this.$raise("[Racc Bug] can't convert token "+O+" to string")},1),ue(S,"$token_to_str",function(O){return M(this.$class(),"Racc_token_to_s_table")["$[]"](O)},1)}(w[0],w)},Opal.modules["bcdice/arithmetic/node"]=function(a){var ue,k,N,u,l,g,b,z,Y,y=[],w=a.nil,p=a.$$$,d=a.module,M=a.klass,v=a.def,D=a.send2,$=a.find_super,F=a.eqeq,oe=a.const_set,G=a.eqeqeq,L=a.rb_divide,V=a.truthy,H=a.alias;return ue=y,k=Y=[d(y[0],"BCDice")].concat(ue),N=z=[d(Y[0],"Arithmetic")].concat(k),g=[d(z[0],"Node")].concat(N),b=a.$r(g),(l=(u=M(g[0],null,"BinaryOp")).$$prototype).lhs=l.rhs=l.op=w,v(u,"$initialize",function(_,x,S){var Q=this;return Q.lhs=_,Q.op=x,Q.rhs=S},3),v(u,"$eval",function(_){var Q,x=this,S=w;return S=x.lhs.$eval(_),Q=x.rhs.$eval(_),S.$send(x.op,Q)},1),v(u,"$output",function(){var _=this;return""+_.lhs.$output()+_.op+_.rhs.$output()},0),v(u,"$s_exp",function(){var _=this;return"("+_.$op_for_s_exp()+" "+_.lhs.$s_exp()+" "+_.rhs.$s_exp()+")"},0),v(u,"$op_for_s_exp",function(){return this.op},0),function(C,h,u){var l=M(C,h,"DivideBase"),f=[l].concat(u),_=a.$r(f),x=l.$$prototype;x.lhs=x.rhs=x.op=w,v(l,"$initialize",function S(Q,le){return delete S.$$p,D(this,$(this,"initialize",S,!1,!0),"initialize",[Q,"/",le],null)},2),v(l,"$eval",function(Q){var Ce,T;return Ce=this.lhs.$eval(Q),T=this.rhs.$eval(Q),F(T,0)&&this.$raise(_("ZeroDivisionError")),this.$divide_and_round(Ce,T,Q)},1),v(l,"$output",function S(){var Q=S.$$p||w;return delete S.$$p,""+D(this,$(this,"output",S,!1,!0),"output",[],Q)+this.$rounding_method()},0),l.$private(),v(l,"$rounding_method",function(){return p(this.$class(),"ROUNDING_METHOD")},0),v(l,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()},0),v(l,"$divide_and_round",function(Q,le,Ce){return this.$raise(_("NotImplementedError"))},3)}(g[0],b("BinaryOp"),g),function(C,h,u){var l=M(C,h,"DivideWithGameSystemDefault"),f=[l].concat(u),_=a.$r(f);oe(f[0],"ROUNDING_METHOD",""),l.$private(),v(l,"$divide_and_round",function(S,Q,le){var Ce,T=w;return G(p(_("RoundType"),"CEIL"),Ce=le)?L(S.$to_f(),Q).$ceil():G(p(_("RoundType"),"ROUND"),Ce)?(T=L(S.$to_f(),Q),V(T["$negative?"]())?T.$abs().$round()["$-@"]():T.$round()):L(S,Q).$floor()},3)}(g[0],b("DivideBase"),g),function(C,h,u){var l=M(C,h,"DivideWithCeil"),f=[l].concat(u);oe(f[0],"ROUNDING_METHOD","C"),l.$private(),v(l,"$divide_and_round",function(x,S,Q){return L(x.$to_f(),S).$ceil()},3)}(g[0],b("DivideBase"),g),function(C,h,u){var l=M(C,h,"DivideWithRound"),f=[l].concat(u);oe(f[0],"ROUNDING_METHOD","R"),l.$private(),v(l,"$divide_and_round",function(x,S,Q){var le=w;return le=L(x.$to_f(),S),V(le["$negative?"]())?le.$abs().$round()["$-@"]():le.$round()},3)}(g[0],b("DivideBase"),g),function(C,h,u){var l=M(C,h,"DivideWithFloor"),f=[l].concat(u);oe(f[0],"ROUNDING_METHOD","F"),l.$private(),v(l,"$divide_and_round",function(x,S,Q){return L(x,S).$floor()},3)}(g[0],b("DivideBase"),g),function(C,h){var u=M(C,null,"Negative");u.$$prototype.body=w,v(u,"$initialize",function(_){return this.body=_},1),v(u,"$eval",function(_){return this.body.$eval(_)["$-@"]()},1),v(u,"$output",function(){return"-"+this.body.$output()},0),v(u,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"},0)}(g[0]),function(C,h){var u=M(C,null,"Parenthesis");u.$$prototype.expr=w,v(u,"$initialize",function(_){return this.expr=_},1),v(u,"$eval",function(_){return this.expr.$eval(_)},1),v(u,"$output",function(){return"("+this.expr.$output()+")"},0),v(u,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"},0)}(g[0]),function(C,h){var u=M(C,null,"Number");return u.$$prototype.value=w,v(u,"$initialize",function(_){return this.value=_},1),v(u,"$eval",function(_){return this.value},1),v(u,"$output",function(){return this.value.$to_s()},0),H(u,"s_exp","output")}(g[0])},Opal.modules.strscan=function(a){var H,se,ue,ee,Y,y=[],w=a.nil,d=a.def,M=a.truthy,v=a.eqeqeq,D=a.Opal,$=a.send,F=a.to_a,oe=a.rb_minus,G=a.alias;return H=y,ue=[se=(0,a.klass)(y[0],null,"StringScanner")].concat(H),ee=a.$r(ue),(Y=se.$$prototype).pos=Y.string=Y.working=Y.matched=Y.prev_pos=Y.match=w,se.$attr_reader("pos","matched"),d(se,"$initialize",function(k){var q=this;return q.string=k,q.pos=0,q.matched=w,q.working=k,q.match=[]},1),se.$attr_reader("string"),d(se,"$beginning_of_line?",function(){var k=this;return 0===k.pos||"\n"===k.string.charAt(k.pos-1)},0),d(se,"$scan",function(k){var q=this,z=(k=q.$anchor(k)).exec(q.working);return null==z?q.matched=w:"object"==typeof z?(q.prev_pos=q.pos,q.pos+=z[0].length,q.working=q.working.substring(z[0].length),q.matched=z[0],q.match=z,z[0]):"string"==typeof z?(q.pos+=z.length,q.working=q.working.substring(z.length),z):w},1),d(se,"$scan_until",function(k){var q=this;k=q.$anchor(k);for(var N,z=q.pos,A=q.working;;){if(N=k.exec(A),z+=1,A=A.substr(1),null!=N)return q.matched=q.string.substr(q.pos,z-q.pos-1+N[0].length),q.match=N,q.prev_pos=z-1,q.pos=z,q.working=A.substr(N[0].length),q.matched;if(0===A.length)return q.match=[],q.matched=w}},1),d(se,"$[]",function(k){var z;if(M(this.match["$empty?"]()))return w;v(ee("Symbol"),z=k)?k=k.$to_s():v(ee("String"),z)||(k=D["$coerce_to!"](k,ee("Integer"),"to_int"));var A=this.match;return k<0&&(k+=A.length),k<0||k>=A.length||null==A[k]?w:A[k]},1),d(se,"$check",function(k){var q=this,z=(k=q.$anchor(k)).exec(q.working);return q.matched=null==z?w:z[0]},1),d(se,"$check_until",function(k){var q=this,z=q.prev_pos,A=q.pos,N=q.$scan_until(k);return N!==w&&(q.matched=N.substr(-1),q.working=q.string.substr(A)),q.prev_pos=z,q.pos=A,N},1),d(se,"$peek",function(k){return this.working.substring(0,k)},1),d(se,"$eos?",function(){return 0===this.working.length},0),d(se,"$exist?",function(k){var z=k.exec(this.working);return null==z?w:0==z.index?0:z.index+1},1),d(se,"$skip",function(k){var q=this,z=(k=q.$anchor(k)).exec(q.working);if(null==z)return q.match=[],q.matched=w;var A=z[0],N=A.length;return q.matched=A,q.match=z,q.prev_pos=q.pos,q.pos+=N,q.working=q.working.substring(N),N},1),d(se,"$skip_until",function(k){var z=this.$scan_until(k);return z===w?w:(this.matched=z.substr(-1),z.length)},1),d(se,"$get_byte",function(){var k=this,q=w;return k.pos<k.string.length?(k.prev_pos=k.pos,k.pos+=1,q=k.matched=k.working.substring(0,1),k.working=k.working.substring(1)):k.matched=w,q},0),d(se,"$match?",function(k){var q=this,z=(k=q.$anchor(k)).exec(q.working);return null==z?w:(q.prev_pos=q.pos,z[0].length)},1),d(se,"$pos=",function(k){var q=this;return k<0&&(k+=q.string.$length()),q.pos=k,q.working=q.string.slice(k)},1),d(se,"$matched_size",function(){return this.matched===w?w:this.matched.length},0),d(se,"$post_match",function(){var k=this;return k.matched===w?w:k.string.substr(k.pos)},0),d(se,"$pre_match",function(){var k=this;return k.matched===w?w:k.string.substr(0,k.prev_pos)},0),d(se,"$reset",function(){var k=this;return k.working=k.string,k.matched=w,k.pos=0},0),d(se,"$rest",function(){return this.working},0),d(se,"$rest?",function(){return 0!==this.working.length},0),d(se,"$rest_size",function(){return this.$rest().$size()},0),d(se,"$terminate",function(){var q,k=this;return k.match=w,q=[k.string.$length()],$(k,"pos=",F(q)),q[oe(q.length,1)]},0),d(se,"$unscan",function(){var k=this;return k.pos=k.prev_pos,k.prev_pos=w,k.match=w,k},0),G(se,"bol?","beginning_of_line?"),G(se,"getch","get_byte"),se.$private(),d(se,"$anchor",function(k){var q=k.toString().match(/\/([^\/]+)$/);return q=q?q[1]:void 0,new RegExp("^(?:"+k.source+")",q)},1)},Opal.modules["bcdice/normalize"]=function(a){var $,L,oe,y=[],w=a.nil,p=a.module,d=a.eqeqeq,M=a.def,v=a.eqeq;return $=y,oe=[p(y[0],"BCDice")].concat($),(L=p(oe[0],"Normalize")).$module_function(),M(L,"$comparison_operator",function(H){var se;return d(/<=|=</,se=H)?"<=":d(/>=|=>/,se)?">=":d(/<>|!=|=!/,se)?"!=":d(/</,se)?"<":d(/>/,se)?">":d(/=/,se)?"==":w},1),M(L,"$target_number",function(H){return v(H,"?")?H:H.$to_i()},1)},Opal.modules["bcdice/command/lexer"]=function(a){var L,ue,q,z,A,N,P,Y,H,y=a.top,w=[],p=a.nil,d=a.module,M=a.klass,v=a.const_set,D=a.hash2,$=a.truthy,F=a.send,oe=a.def;return y.$require("strscan"),y.$require("bcdice/normalize"),L=w,ue=H=[d(w[0],"BCDice")].concat(L),q=Y=[d(H[0],"Command")].concat(ue),A=[z=M(Y[0],null,"Lexer")].concat(q),N=a.$r(A),(P=z.$$prototype).scanner=P.notations=p,v(A[0],"SYMBOLS",D(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),oe(z,"$initialize",function(b,C){var h,u,f;return b=$(f=(u=(h=b)===p||null==h?p:F(h,"split",[" ",2]))===p||null==u?p:F(u,"first",[]))?f:"",this.scanner=N("StringScanner").$new(b),this.notations=F(C,"map",[],function(x){return null==x&&(x=p),$(x["$is_a?"](N("String")))?N("Regexp").$new(x):x},1)},2),oe(z,"$next_token",function(){try{var b=this,C=p,h=p,l=p,f=p;return $(b.scanner["$eos?"]())?[!1,"$"]:(F(b.notations,"each",[],function _(x){var Q,S=null==_.$$s?this:_.$$s;if(null==S.scanner&&(S.scanner=p),null==x&&(x=p),Q=S.scanner.$scan(x),!$(Q))return p;a.ret(["NOTATION",Q])},{$$arity:1,$$s:b}),$(C=b.scanner.$scan(/\d+/))?["NUMBER",C.$to_i()]:$(h=b.scanner.$scan(/[<>!=]+/))?(h=N("Normalize").$comparison_operator(h),[$(h)?"CMP_OP":"ILLEGAL",h]):(l=b.scanner.$getch().$upcase(),[$(f=N("SYMBOLS")["$[]"](l))?f:l.$to_sym(),l]))}catch(_){if(_===a.returner)return _.$v;throw _}},0),oe(z,"$source",function(){return this.scanner.$string()},0)},Opal.modules["bcdice/command/parsed"]=function(a){var F,V,Y,ne,k,q,z,se,G,y=[],w=a.nil,p=a.module,d=a.klass,M=a.def,v=a.truthy,D=a.eqeqeq;return F=y,V=G=[p(y[0],"BCDice")].concat(F),Y=se=[p(G[0],"Command")].concat(V),k=[ne=d(se[0],null,"Parsed")].concat(Y),q=a.$r(k),(z=ne.$$prototype).question_target=z.critical=z.fumble=z.dollar=z.modify_number=z.target_number=z.prefix_number=z.command=z.suffix_number=z.cmp_op=w,ne.$attr_accessor("command"),ne.$attr_accessor("prefix_number"),ne.$attr_accessor("suffix_number"),ne.$attr_accessor("critical"),ne.$attr_accessor("fumble"),ne.$attr_accessor("dollar"),ne.$attr_accessor("modify_number"),ne.$attr_accessor("cmp_op"),ne.$attr_accessor("target_number"),ne.$attr_writer("question_target"),M(ne,"$initialize",function(){var N=this;return N.prefix_number=w,N.suffix_number=w,N.critical=w,N.fumble=w,N.dollar=w,N.cmp_op=w,N.target_number=w,N.question_target=!1},0),M(ne,"$question_target?",function(){return this.question_target},0),M(ne,"$to_s",function(N){var l,P=this,g=w,b=w,C=w,h=w,u=w;return null==N&&(N="after_command"),g=v(P.critical)?"@"+P.critical:w,b=v(P.fumble)?"#"+P.fumble:w,C=v(P.dollar)?"$"+P.dollar:w,h=q("Format").$modifier(P.modify_number),u=v(P.question_target)?"?":P.target_number,D("after_command",l=N)?[P.prefix_number,P.command,P.suffix_number,g,b,C,h,P.cmp_op,u].$join():D("after_modify_number",l)?[P.prefix_number,P.command,P.suffix_number,h,g,b,C,P.cmp_op,u].$join():D("after_target_number",l)?[P.prefix_number,P.command,P.suffix_number,h,P.cmp_op,u,g,b,C].$join():w},-1)},Opal.modules["bcdice/command/parser"]=function(a){var q,P,l,S,Q,le,Ce,T,O,re,j,ve,ce,f,_,x,R,b,C,A,y=a.top,w=[],p=a.$r(w),d=a.nil,M=a.$$$,v=a.klass,D=a.module,$=a.hash2,F=a.send2,oe=a.find_super,G=a.def,L=a.send,V=a.to_a,H=a.rb_minus,se=a.eqeq,ue=a.hash,ee=a.const_set,Y=a.truthy,ne=a.to_ary;return y.$require("racc/parser.rb"),y.$require("bcdice/arithmetic/node"),y.$require("bcdice/command/lexer"),y.$require("bcdice/command/parsed"),v(M(p("BCDice"),"Command"),M(p("Racc"),"Parser"),"Parser"),q=w,P=A=[D(w[0],"BCDice")].concat(q),b=[D(A[0],"Command")].concat(P),C=a.$r(b),l=b,_=[f=v(b[0],M(C("Racc"),"Parser"),"Parser")].concat(l),x=a.$r(_),(R=f.$$prototype).notations=R.lexer=R.modifier=R.suffix_number=R.prefix_number=R.need_suffix_number=R.need_prefix_number=R.critical=R.fumble=R.dollar=R.allowed_cmp_op=R.question_target=d,G(f,"$initialize",function ie(W,me){var $e,_e,Ie,Pe,Ne=this;if(delete ie.$$p,$e=a.slice.call(arguments),null==(_e=a.extract_kwargs($e)))_e=$([],{});else if(!_e.$$is_hash)throw a.ArgumentError.$new("expected kwargs");if(Ie=$e,!a.hasOwnProperty.call(_e.$$smap,"round_type"))throw a.ArgumentError.$new("missing keyword: round_type");return Pe=_e.$$smap.round_type,F(Ne,oe(Ne,"initialize",ie,!1,!0),"initialize",[],null),Ne.notations=Ie,Ne.round_type=Pe,Ne.prefix_number=!1,Ne.suffix_number=!1,Ne.need_prefix_number=!1,Ne.need_suffix_number=!1,Ne.modifier=!0,Ne.critical=!1,Ne.fumble=!1,Ne.dollar=!1,Ne.allowed_cmp_op=[d,">=",">","<=","<","==","!="],Ne.question_target=!1},-2),G(f,"$disable_modifier",function(){return this.modifier=!1,this},0),G(f,"$enable_prefix_number",function(){return this.prefix_number=!0,this},0),G(f,"$enable_suffix_number",function(){return this.suffix_number=!0,this},0),G(f,"$has_prefix_number",function(){var W=this;return W.prefix_number=!0,W.need_prefix_number=!0,W},0),G(f,"$has_suffix_number",function(){var W=this;return W.suffix_number=!0,W.need_suffix_number=!0,W},0),G(f,"$enable_critical",function(){return this.critical=!0,this},0),G(f,"$enable_fumble",function(){return this.fumble=!0,this},0),G(f,"$enable_dollar",function(){return this.dollar=!0,this},0),G(f,"$restrict_cmp_op_to",function(W){var me,_e=this;return me=a.slice.call(arguments),_e.allowed_cmp_op=me,_e},-1),G(f,"$enable_question_target",function(){return this.question_target=!0,this},0),G(f,"$parse",function(W){try{return this.lexer=x("Lexer").$new(W,this.notations),this.$do_parse()}catch($e){if(!a.rescue($e,[x("ParseError"),x("ZeroDivisionError")]))throw $e;try{return d}finally{a.pop_exception()}}},1),f.$private(),G(f,"$parsed",function(W,me,$e,_e){return L(x("Parsed").$new(),"tap",[],function Pe(Ae){var Ne,We,nt,Nt,jt,Ot,mt=null==Pe.$$s?this:Pe.$$s,$t=d;return null==mt.round_type&&(mt.round_type=d),null==Ae&&(Ae=d),$t=[W["$[]"]("command")],L(Ae,"command=",V($t)),H($t.length,1),$t=[(Ne=W["$[]"]("prefix"),Ne===d||null==Ne?d:L(Ne,"eval",[mt.round_type]))],L(Ae,"prefix_number=",V($t)),H($t.length,1),$t=[(We=W["$[]"]("suffix"),We===d||null==We?d:L(We,"eval",[mt.round_type]))],L(Ae,"suffix_number=",V($t)),H($t.length,1),$t=[(nt=me["$[]"]("critical"),nt===d||null==nt?d:L(nt,"eval",[mt.round_type]))],L(Ae,"critical=",V($t)),H($t.length,1),$t=[(Nt=me["$[]"]("fumble"),Nt===d||null==Nt?d:L(Nt,"eval",[mt.round_type]))],L(Ae,"fumble=",V($t)),H($t.length,1),$t=[(jt=me["$[]"]("dollar"),jt===d||null==jt?d:L(jt,"eval",[mt.round_type]))],L(Ae,"dollar=",V($t)),H($t.length,1),$t=[$e.$eval(mt.round_type)],L(Ae,"modify_number=",V($t)),H($t.length,1),$t=[_e["$[]"]("cmp_op")],L(Ae,"cmp_op=",V($t)),H($t.length,1),se(_e["$[]"]("target"),"?")?(L(Ae,"question_target=",V($t=[!0])),H($t.length,1),L(Ae,"target_number=",V($t=[0])),$t[H($t.length,1)]):(L(Ae,"question_target=",V($t=[!1])),H($t.length,1),$t=[(Ot=_e["$[]"]("target"),Ot===d||null==Ot?d:L(Ot,"eval",[mt.round_type]))],L(Ae,"target_number=",V($t)),$t[H($t.length,1)])},{$$arity:1,$$s:this})},4),G(f,"$next_token",function(){return this.lexer.$next_token()},0),S=[6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,d,5,36,37,17,18,6,d,5,36,37,17,18,6,d,5,36,37,17,18,6,d,5,33,34,17,18,6,d,5,36,37,17,18,6,d,5,36,37,17,18,6,d,5,36,37,17,18,6,d,5,36,37,17,18,6,d,5,d,d,17,18,6,d,5,d,d,17,18,d,d,5,23,24,25,26,56,54,55,57],Q=[0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,d,17,15,15,18,18,23,d,18,30,30,23,23,24,d,23,31,31,24,24,25,d,24,44,44,25,25,28,d,25,47,47,28,28,29,d,28,48,48,29,29,33,d,29,49,49,33,33,34,d,33,50,50,34,34,36,d,34,d,d,36,36,37,d,36,d,d,37,37,d,d,37,27,27,27,27,52,52,52,52],le=[-2,4,16,-3,-1,11,d,33,13,35,23,30,1,d,28,40,d,37,44,d,d,-2,d,51,58,65,0,106,72,79,47,54,d,86,93,d,100,107,d,d,d,d,d,d,63,d,d,68,75,82,89,d,120,d,d,d,d,d],Ce=[-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29],T=[30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,d,d,21,47,48,40,51,52,49,50,44,46,3,d,d,d,13,d,d,d,d,d,d,d,32],O=[8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,d,d,4,8,8,5,7,7,8,8,9,5,6,d,d,d,6,d,d,d,d,d,d,d,6],re=[d,6,13,3,9,-1,27,-15,-10,-1,-38],j=[d,d,d,d,d,d,19,16,15,d,d],ve=[0,0,"racc_error",4,20,"_reduce_1",4,20,"_reduce_2",3,20,"_reduce_3",3,21,"_reduce_4",2,21,"_reduce_5",2,21,"_reduce_6",1,21,"_reduce_7",0,22,"_reduce_8",3,22,"_reduce_9",3,22,"_reduce_10",3,22,"_reduce_11",2,23,"_reduce_12",2,23,"_reduce_13",3,23,"_reduce_14",3,23,"_reduce_15",0,24,"_reduce_16",2,24,"_reduce_17",2,24,"_reduce_18",3,28,"_reduce_19",3,28,"_reduce_20",1,28,"_reduce_none",3,27,"_reduce_22",4,27,"_reduce_23",1,27,"_reduce_none",0,29,"_reduce_25",1,29,"_reduce_26",1,29,"_reduce_27",1,29,"_reduce_28",1,29,"_reduce_29",2,26,"_reduce_30",2,26,"_reduce_31",1,26,"_reduce_none",3,25,"_reduce_33",1,25,"_reduce_34"],ce=ue(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),ee(_[0],"Racc_arg",[S,Q,Ce,le,T,O,j,re,19,ve,ce,58,35,!0]),ee(_[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),ee(_[0],"Racc_debug_parser",!1),G(f,"$_reduce_1",function(W,me,$e){var _e;return Y(this.modifier)||this.$raise(x("ParseError")),_e=ne(W),this.$parsed(null==_e[0]?d:_e[0],null==_e[1]?d:_e[1],null==_e[2]?d:_e[2],null==_e[3]?d:_e[3])},3),G(f,"$_reduce_2",function(W,me,$e){var _e;return Y(this.modifier)||this.$raise(x("ParseError")),_e=ne(W),this.$parsed(null==_e[0]?d:_e[0],null==_e[2]?d:_e[2],null==_e[1]?d:_e[1],null==_e[3]?d:_e[3])},3),G(f,"$_reduce_3",function(W,me,$e){var _e,We;return We=null==(_e=ne(W))[2]?d:_e[2],this.$parsed(null==_e[0]?d:_e[0],null==_e[1]?d:_e[1],M(M(x("Arithmetic"),"Node"),"Number").$new(0),We)},3),G(f,"$_reduce_4",function(W,me,$e){return Y(this.prefix_number)&&Y(this.suffix_number)||this.$raise(x("ParseError")),$(["command","prefix","suffix"],{command:W["$[]"](1),prefix:W["$[]"](0),suffix:W["$[]"](2)})},3),G(f,"$_reduce_5",function(W,me,$e){return Y(this.prefix_number)||this.$raise(x("ParseError")),Y(this.need_suffix_number)&&this.$raise(x("ParseError")),$(["command","prefix"],{command:W["$[]"](1),prefix:W["$[]"](0)})},3),G(f,"$_reduce_6",function(W,me,$e){return Y(this.suffix_number)||this.$raise(x("ParseError")),Y(this.need_prefix_number)&&this.$raise(x("ParseError")),$(["command","suffix"],{command:W["$[]"](0),suffix:W["$[]"](1)})},3),G(f,"$_reduce_7",function(W,me,$e){return(Y(this.need_prefix_number)||Y(this.need_suffix_number))&&this.$raise(x("ParseError")),$(["command"],{command:W["$[]"](0)})},3),G(f,"$_reduce_8",function(W,me,$e){return $([],{})},3),G(f,"$_reduce_9",function(W,me,$e){var _e,We,nt,Ae=d;return Ae=null==(_e=ne(W))[0]?d:_e[0],We=null==_e[2]?d:_e[2],Y(this.critical)&&Y(Ae["$[]"]("critical")["$nil?"]())||this.$raise(x("ParseError")),L(Ae,"[]=",V(nt=["critical",We])),H(nt.length,1),Ae},3),G(f,"$_reduce_10",function(W,me,$e){var _e,We,nt,Ae=d;return Ae=null==(_e=ne(W))[0]?d:_e[0],We=null==_e[2]?d:_e[2],Y(this.fumble)&&Y(Ae["$[]"]("fumble")["$nil?"]())||this.$raise(x("ParseError")),L(Ae,"[]=",V(nt=["fumble",We])),H(nt.length,1),Ae},3),G(f,"$_reduce_11",function(W,me,$e){var _e,We,nt,Ae=d;return Ae=null==(_e=ne(W))[0]?d:_e[0],We=null==_e[2]?d:_e[2],Y(this.dollar)&&Y(Ae["$[]"]("dollar")["$nil?"]())||this.$raise(x("ParseError")),L(Ae,"[]=",V(nt=["dollar",We])),H(nt.length,1),Ae},3),G(f,"$_reduce_12",function(W,me,$e){return W["$[]"](1)},3),G(f,"$_reduce_13",function(W,me,$e){return M(M(x("Arithmetic"),"Node"),"Negative").$new(W["$[]"](1))},3),G(f,"$_reduce_14",function(W,me,$e){return M(M(x("Arithmetic"),"Node"),"BinaryOp").$new(W["$[]"](0),"+",W["$[]"](2))},3),G(f,"$_reduce_15",function(W,me,$e){return M(M(x("Arithmetic"),"Node"),"BinaryOp").$new(W["$[]"](0),"-",W["$[]"](2))},3),G(f,"$_reduce_16",function(W,me,$e){return Y(this.allowed_cmp_op["$include?"](d))||this.$raise(x("ParseError")),$([],{})},3),G(f,"$_reduce_17",function(W,me,$e){var _e,Ae,Ne;return Ne=null==(_e=ne(W))[1]?d:_e[1],Y(this.allowed_cmp_op["$include?"](Ae=null==_e[0]?d:_e[0]))||this.$raise(x("ParseError")),$(["cmp_op","target"],{cmp_op:Ae,target:Ne})},3),G(f,"$_reduce_18",function(W,me,$e){var Ie;return Ie=W["$[]"](0),Y(this.question_target)||this.$raise(x("ParseError")),Y(this.allowed_cmp_op["$include?"](Ie))||this.$raise(x("ParseError")),$(["cmp_op","target"],{cmp_op:Ie,target:"?"})},3),G(f,"$_reduce_19",function(W,me,$e){return M(M(x("Arithmetic"),"Node"),"BinaryOp").$new(W["$[]"](0),"+",W["$[]"](2))},3),G(f,"$_reduce_20",function(W,me,$e){return M(M(x("Arithmetic"),"Node"),"BinaryOp").$new(W["$[]"](0),"-",W["$[]"](2))},3),G(f,"$_reduce_22",function(W,me,$e){return M(M(x("Arithmetic"),"Node"),"BinaryOp").$new(W["$[]"](0),"*",W["$[]"](2))},3),G(f,"$_reduce_23",function(W,me,$e){return W["$[]"](3).$new(W["$[]"](0),W["$[]"](2))},3),G(f,"$_reduce_25",function(W,me,$e){return M(M(x("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),G(f,"$_reduce_26",function(W,me,$e){return M(M(x("Arithmetic"),"Node"),"DivideWithCeil")},3),G(f,"$_reduce_27",function(W,me,$e){return M(M(x("Arithmetic"),"Node"),"DivideWithCeil")},3),G(f,"$_reduce_28",function(W,me,$e){return M(M(x("Arithmetic"),"Node"),"DivideWithRound")},3),G(f,"$_reduce_29",function(W,me,$e){return M(M(x("Arithmetic"),"Node"),"DivideWithFloor")},3),G(f,"$_reduce_30",function(W,me,$e){return W["$[]"](1)},3),G(f,"$_reduce_31",function(W,me,$e){return M(M(x("Arithmetic"),"Node"),"Negative").$new(W["$[]"](1))},3),G(f,"$_reduce_33",function(W,me,$e){return W["$[]"](1)},3),G(f,"$_reduce_34",function(W,me,$e){return M(M(x("Arithmetic"),"Node"),"Number").$new(W["$[]"](0))},3),G(f,"$_reduce_none",function(W,me,$e){return W["$[]"](0)},3)},Opal.modules["bcdice/deprecated/checker"]=function(a){var F,V,ee,Y,ne,k,se,G,y=[],w=a.nil,p=a.module,d=a.send,M=a.eqeqeq,v=a.truthy,D=a.def;return F=y,V=G=[p(y[0],"BCDice")].concat(F),ee=se=[p(G[0],"Deprecated")].concat(V),ne=[Y=p(se[0],"Checker")].concat(ee),k=a.$r(ne),Y.$private(),D(Y,"$check_result_legacy",function(z,A,N,P){var h,g=this,b=w,C=w,u=w,l=w;return b=d(A,"map",[],"sides".$to_proc()),h=(C=d(A,"map",[],"value".$to_proc())).$sum(),u=M([100],l=b)?g.$check_1D100(z,h,N,P):M([20],l)?g.$check_1D20(z,h,N,P):M([6,6],l)?g.$check_2D6(z,h,C,N,P):w,(v(u["$nil?"]())||v(u["$empty?"]()))&&(u=M([10],l=b.$uniq())?g.$check_nD10(z,h,C,N,P):M([6],l)?g.$check_nD6(z,h,C,N,P):w,v(u["$nil?"]())||v(u["$empty?"]()))?w:k("Result").$new(u.$delete_prefix(" \uff1e "))},4),D(Y,"$check_1D100",function(z,A,N,P){return w},4),D(Y,"$check_1D20",function(z,A,N,P){return w},4),D(Y,"$check_nD10",function(z,A,N,P,g){return w},5),D(Y,"$check_2D6",function(z,A,N,P,g){return w},5),D(Y,"$check_nD6",function(z,A,N,P,g){return w},5)},Opal.queue(function(a){var A,C,_,S,Q,h,u,l,f,P,y=a.top,w=[],p=a.$r(w),d=a.nil,M=a.$$$,v=a.module,D=a.klass,$=a.truthy,F=a.def,oe=a.regexp,G=a.rb_plus,L=a.send,V=a.to_a,H=a.rb_minus,se=a.eqeqeq,ue=a.eqeq,ee=a.range,Y=a.rb_divide,ne=a.rb_times,k=a.rb_ge,q=d;return y.$require("i18n"),y.$require("i18n/backend/fallbacks"),y.$require("bcdice/randomizer"),y.$require("bcdice/dice_table"),y.$require("bcdice/enum"),y.$require("bcdice/translate"),y.$require("bcdice/result"),y.$require("bcdice/command/parser"),y.$require("bcdice/deprecated/checker"),A=w,C=P=[v(w[0],"BCDice")].concat(A),u=[h=D(P[0],null,"Base")].concat(C),l=a.$r(u),(f=h.$$prototype).sort_add_dice=f.sort_barabara_dice=f.enabled_d9=f.raw_input=f.randomizer=f.enabled_upcase_input=f.debug=d,S=[_=a.get_singleton_class(h)].concat(u),Q=a.$r(S),_.$attr_reader("prefixes"),F(_,"$register_prefix",function(Ce){var O,re=this,j=d;return null==re.prefixes&&(re.prefixes=d),O=a.slice.call(arguments),re.prefixes=$(j=re.prefixes)?j:[],re.prefixes.$concat(O.$flatten())},-1),F(_,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())},0),F(_,"$prefixes_pattern",function(){var Ce=this,T=d;return null==Ce.prefixes_pattern&&(Ce.prefixes_pattern=d),null==Ce.prefixes&&(Ce.prefixes=d),Ce.prefixes_pattern=$(T=Ce.prefixes_pattern)?T:d,$(Ce.prefixes_pattern)?Ce.prefixes_pattern:(Ce.prefixes=$(T=Ce.prefixes)?T:[],Ce.prefixes.$freeze(),Ce.prefixes_pattern=($(Ce.prefixes["$empty?"]())?/(?!)/:oe(["^(S)?(",Ce.prefixes.$join("|"),")"],"i")).$freeze())},0),F(_,"$command_pattern",function(){var Ce=this,T=d,O=d;return null==Ce.command_pattern&&(Ce.command_pattern=d),null==Ce.prefixes&&(Ce.prefixes=d),Ce.command_pattern=$(T=Ce.command_pattern)?T:d,$(Ce.command_pattern)?Ce.command_pattern:(Ce.prefixes=$(T=Ce.prefixes)?T:[],Ce.prefixes.$freeze(),O=G(L(M(Q("CommonCommand"),"COMMANDS"),"map",[],function(j){return null==j&&(j=d),M(j,"PREFIX_PATTERN").$source()},1),Ce.prefixes),Ce.command_pattern=oe(["^S?(",O.$join("|"),")"],"i").$freeze())},0),F(_,"$eval",function(Ce){return this.$new(Ce).$eval()},1),h.$include(l("Translate")),h.$include(M(l("Deprecated"),"Checker")),F(h,"$initialize",function(x){var S=this;return S.raw_input=x,S.sort_add_dice=!1,S.sort_barabara_dice=!1,S.d66_sort_type=M(l("D66SortType"),"NO_SORT"),S.enabled_d9=!1,S.round_type=M(l("RoundType"),"FLOOR"),S.sides_implicit_d=6,S.upper_dice_reroll_threshold=d,S.reroll_dice_reroll_threshold=d,S.default_cmp_op=d,S.default_target_number=d,S.enabled_upcase_input=!0,S.locale="ja_jp",S.randomizer=M(l("BCDice"),"Randomizer").$new(),S.debug=!1},1),h.$attr_accessor("randomizer"),h.$attr_reader("d66_sort_type"),h.$attr_reader("round_type"),h.$attr_reader("sides_implicit_d"),h.$attr_reader("upper_dice_reroll_threshold"),h.$attr_reader("reroll_dice_reroll_threshold"),h.$attr_reader("default_cmp_op"),h.$attr_reader("default_target_number"),F(h,"$sort_add_dice?",function(){return this.sort_add_dice},0),F(h,"$sort_barabara_dice?",function(){return this.sort_barabara_dice},0),F(h,"$enabled_d9?",function(){return this.enabled_d9},0),F(h,"$enable_debug",function(){return this.debug=!0},0),F(h,"$eval",function(){var S,Q,le,x=this,Ce=d;return S=M(l("BCDice"),"Preprocessor").$process(x.raw_input,x),Q=$(le=x.$dice_command(S))?le:x.$eval_common_command(x.raw_input),$(Q)?(Ce=[x.randomizer.$rand_results()],L(Q,"rands=",V(Ce)),H(Ce.length,1),Ce=[x.randomizer.$detailed_rand_results()],L(Q,"detailed_rands=",V(Ce)),H(Ce.length,1),Q):d},0),F(h,"$change_text",function(x){return x},1),F(h,"$check_result",function(x,S,Q,le){var Ce=this,T=d,O=d,re=d,j=d,ve=d;return T=Ce.$check_result_legacy(x,S,Q,le),$(T)?T:(O=L(S,"map",[],"sides".$to_proc()),j=(re=L(S,"map",[],"value".$to_proc())).$sum(),T=se([100],ve=O)?Ce.$result_1d100(x,j,Q,le):se([20],ve)?Ce.$result_1d20(x,j,Q,le):se([6,6],ve)?Ce.$result_2d6(x,j,re,Q,le):d,ue(T,l("Result").$nothing())?d:$(T)?T:(T=se([10],ve=O.$uniq())?Ce.$result_nd10(x,j,re,Q,le):se([6],ve)?Ce.$result_nd6(x,j,re,Q,le):d,ue(T,l("Result").$nothing())?d:$(T)?T:Ce.$result_ndx(x,Q,le)))},4),F(h,"$grich_text",function(x,S,Q){return d},3),h.$private(),F(h,"$eval_common_command",function(x){try{return x=this.$change_text(x),L(M(l("CommonCommand"),"COMMANDS"),"each",[],function Q(le){var T,Ce=null==Q.$$s?this:Q.$$s;if(null==Ce.randomizer&&(Ce.randomizer=d),null==le&&(le=d),T=le.$eval(x,Ce,Ce.randomizer),!$(T))return d;a.ret(T)},{$$arity:1,$$s:this}),d}catch(Q){if(Q===a.returner)return Q.$v;throw Q}},1),F(h,"$dice_command",function(x){var S=this,Q=d,le=d,Ce=d,T=d,O=d;return $(S.enabled_upcase_input)&&(x=x.$upcase()),Q=S.$class().$prefixes_pattern().$match(x),$(Q)?(le=Q["$[]"](1)["$nil?"]()["$!"](),$(le)&&(x=x["$[]"](ee(1,-1,!1))),Ce=S.$eval_game_system_specific_command(x),$(Ce["$is_a?"](l("Result")))?(T=[$(O=Ce["$secret?"]())?O:le],L(Ce,"secret=",V(T)),H(T.length,1),Ce):$(Ce["$nil?"]())||$(Ce["$empty?"]())||ue(Ce,"1")?d:L(l("Result").$new(),"tap",[],function(j){return null==j&&(j=d),T=[Ce.$to_s()],L(j,"text=",V(T)),H(T.length,1),L(j,"secret=",V(T=[le])),T[H(T.length,1)]},1)):d},1),F(h,"$eval_game_system_specific_command",function(x){return d},1),F(h,"$result_ndx",function(x,S,Q){return $(Q["$is_a?"](l("String")))?d:$(x.$send(S,Q))?l("Result").$success(this.$translate("success")):l("Result").$failure(this.$translate("failure"))},3),F(h,"$result_1d100",function(x,S,Q,le){return d},4),F(h,"$result_1d20",function(x,S,Q,le){return d},4),F(h,"$result_nd10",function(x,S,Q,le,Ce){return d},5),F(h,"$result_2d6",function(x,S,Q,le,Ce){return d},5),F(h,"$result_nd6",function(x,S,Q,le,Ce){return d},5),F(h,"$get_table_by_2d6",function(x){return this.$get_table_by_nD6(x,2)},1),F(h,"$get_table_by_1d6",function(x){return this.$get_table_by_nD6(x,1)},1),F(h,"$get_table_by_nD6",function(x,S){return this.$get_table_by_nDx(x,S,6)},2),F(h,"$get_table_by_nDx",function(x,S,Q){var Ce,T=d;return Ce=this.randomizer.$roll_sum(S,Q),T=this.$get_table_value(x["$[]"](H(Ce,S))),$(T["$nil?"]())?["1",0]:[T,Ce]},3),F(h,"$get_table_by_1d3",function(x){var le,Ce,S=this,T=d;return S.$debug("get_table_by_1d3"),le=S.randomizer.$roll_sum(1,6),S.$debug("num",le),Ce=Y(H(le,1),2).$to_i(),S.$debug("index",Ce),T=x["$[]"](Ce),$(T["$nil?"]())?["1",0]:[T,le]},1),F(h,"$get_table_by_d66_swap",function(x){var Q;return Q=this.randomizer.$roll_d66(M(l("D66SortType"),"ASC")),[this.$get_table_by_number(Q,x),Q]},1),F(h,"$get_table_by_d66",function(x){var Q,le,Ce,O,T=d;return Q=this.randomizer.$roll_once(6),le=this.randomizer.$roll_once(6),Ce=G(ne(H(Q,1),6),H(le,1)),T=x["$[]"](Ce),O=""+Q+le,$(T["$nil?"]())?["1",O]:[T,O]},1),F(h,"$get_table_by_number",function(x,S,Q){try{return null==Q&&(Q="1"),L(S,"each",[],function Ce(T){var re,O=null==Ce.$$s?this:Ce.$$s;if(null==T&&(T=d),re=T["$[]"](0),!$(k(re,x)))return d;a.ret(O.$get_table_value(T["$[]"](1)))},{$$arity:1,$$s:this}),this.$get_table_value(Q)}catch(Ce){if(Ce===a.returner)return Ce.$v;throw Ce}},-3),F(h,"$get_table_value",function(x){return $(x["$is_a?"](l("Proc")))?x.$call():x},1),F(h,"$roll_tables",function(x,S){var le=d;return le=S["$[]"](x),$(le)?le.$roll(this.randomizer).$to_s():d},2),F(h,"$debug",function(x,S){var le,Ce=this,T=d,O=d;return le=a.slice.call(arguments,1),$(Ce.debug)?(T=$(x["$is_a?"](l("String")))?x:x.$inspect(),$(le["$empty?"]())?Ce.$warn(T):(O=L(le,"map",[],function(j){return null==j&&(j=d),$(j["$is_a?"](l("String")))?'"'+j+'"':j.$inspect()},1),Ce.$warn(T+": "+O.$join(", ")))):d},-2),M(M(p("I18n"),"Backend"),"Simple").$include(M(M(p("I18n"),"Backend"),"Fallbacks")),p("I18n").$load_path()["$<<"](p("Dir")["$[]"](p("File").$join("bcdice","../../i18n/**/*.yml"))),q=["ja_jp"],L(p("I18n"),"default_locale=",V(q)),H(q.length,1),q=[["ja_jp"]],L(p("I18n").$fallbacks(),"defaults=",V(q)),q[H(q.length,1)]})},4748:(E,ae,X)=>{X(9993),Opal.modules["bcdice/normalize"]=function(a){var $,L,oe,y=[],w=a.nil,p=a.module,d=a.eqeqeq,M=a.def,v=a.eqeq;return $=y,oe=[p(y[0],"BCDice")].concat($),(L=p(oe[0],"Normalize")).$module_function(),M(L,"$comparison_operator",function(H){var se;return d(/<=|=</,se=H)?"<=":d(/>=|=>/,se)?">=":d(/<>|!=|=!/,se)?"!=":d(/</,se)?"<":d(/>/,se)?">":d(/=/,se)?"==":w},1),M(L,"$target_number",function(H){return v(H,"?")?H:H.$to_i()},1)},Opal.modules["racc/parser"]=function(a){var b,h,u,w=[],p=a.$r(w),d=a.nil,M=a.$$$,v=a.module,D=a.klass,$=a.truthy,F=a.const_set,oe=a.defs,G=a.gvars,L=a.rb_lt,V=a.send,H=a.to_a,se=a.rb_minus,ue=a.def,ee=a.to_ary,Y=a.neqeq,ne=a.rb_plus,k=a.eqeq,q=a.rb_ge,z=a.rb_gt,A=a.eqeqeq,N=a.rb_le,P=a.rb_times;return b=w,h=[v(w[0],"Racc")].concat(b),u=a.$r(h),D(h[0],u("StandardError"),"ParseError"),$(M("::","ParseError","skip_raise")?"constant":d)||F(w[0],"ParseError",M(p("Racc"),"ParseError")),function(g,b){var x,S,Q,le,Ce,u=[v(g,"Racc")].concat(b),l=a.$r(u);return $(l("Racc_No_Extensions","skip_raise")?"constant":d)||F(u[0],"Racc_No_Extensions",!1),x=u,Q=[S=D(u[0],null,"Parser")].concat(x),le=a.$r(Q),(Ce=S.$$prototype).yydebug=Ce.racc_debug_out=Ce.racc_error_status=Ce.racc_t=Ce.racc_vstack=Ce.racc_val=Ce.racc_state=Ce.racc_tstack=d,F(Q[0],"Racc_Runtime_Version","1.4.6"),F(Q[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),F(Q[0],"Racc_Runtime_Core_Version_R","1.4.6"),F(Q[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),F(Q[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),F(Q[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),F(Q[0],"Racc_Runtime_Core_Version",le("Racc_Runtime_Core_Version_R")),F(Q[0],"Racc_Runtime_Core_Revision",le("Racc_Runtime_Core_Revision_R")),F(Q[0],"Racc_Runtime_Type","ruby"),oe(le("Parser"),"$racc_runtime_type",function(){return le("Racc_Runtime_Type")},0),ue(S,"$_racc_setup",function(){var O,re,j=this,ve=d,de=d,Ee=d;return null==G.stderr&&(G.stderr=d),$(M(j.$class(),"Racc_debug_parser"))||(j.yydebug=!1),$(null!=(O=j.yydebug)&&O!==d?"instance-variable":d)||(j.yydebug=!1),$(j.yydebug)&&($(null!=(re=j.racc_debug_out)&&re!==d?"instance-variable":d)||(j.racc_debug_out=G.stderr),j.racc_debug_out=$(ve=j.racc_debug_out)?ve:G.stderr),de=M(j.$class(),"Racc_arg"),$(L(de.$size(),14))&&(V(de,"[]=",H(Ee=[13,!0])),se(Ee.length,1)),de},0),ue(S,"$_racc_init_sysvars",function(){var O=this;return O.racc_state=[0],O.racc_tstack=[],O.racc_vstack=[],O.racc_t=d,O.racc_val=d,O.racc_read_next=!0,O.racc_user_yyerror=!1,O.racc_error_status=0},0),ue(S,"$do_parse",function(){return this.$__send__(le("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},0),ue(S,"$next_token",function(){return this.$raise(le("NotImplementedError"),this.$class()+"#next_token is not defined")},0),ue(S,"$_racc_do_parse_rb",function(O,re){var j,Ee=d,ce=d,he=d,B=d,ie=d,W=d,me=d,$e=d;return j=ee(O),Ee=null==j[0]?d:j[0],ce=null==j[1]?d:j[1],he=null==j[2]?d:j[2],B=null==j[3]?d:j[3],ie=null==j[10]?d:j[10],this.$_racc_init_sysvars(),W=me=$e=d,V(this,"catch",["racc_end_parse"],function _e(){var Pe,Ae,Ne=null==_e.$$s?this:_e.$$s,We=d;for(null==Ne.racc_state&&(Ne.racc_state=d),null==Ne.racc_read_next&&(Ne.racc_read_next=d),null==Ne.racc_t&&(Ne.racc_t=d),null==Ne.yydebug&&(Ne.yydebug=d),null==Ne.racc_val&&(Ne.racc_val=d);$(!0);)for($($e=B["$[]"](Ne.racc_state["$[]"](-1)))?($(Ne.racc_read_next)&&Y(Ne.racc_t,0)&&(Ae=Ne.$next_token(),Pe=ee(Ae),W=null==Pe[0]?d:Pe[0],Ne.racc_val=null==Pe[1]?d:Pe[1],Ne.racc_t=$(W)?$(We=ie["$[]"](W))?We:1:0,$(Ne.yydebug)&&Ne.$racc_read_token(Ne.racc_t,W,Ne.racc_val),Ne.racc_read_next=!1),$e=ne($e,Ne.racc_t),$(q($e,0))&&$(me=Ee["$[]"]($e))&&k(ce["$[]"]($e),Ne.racc_state["$[]"](-1))||(me=he["$[]"](Ne.racc_state["$[]"](-1)))):me=he["$[]"](Ne.racc_state["$[]"](-1));$(me=Ne.$_racc_evalact(me,O)););},{$$arity:0,$$s:this})},2),ue(S,"$yyparse",function(O,re){return this.$__send__(le("Racc_YY_Parse_Method"),O,re,this.$_racc_setup(),!0)},2),ue(S,"$_racc_yyparse_rb",function(O,re,j,ve){var de,he=d,B=d,R=d,ie=d,me=d,$e=d,_e=d;return de=ee(j),he=null==de[0]?d:de[0],B=null==de[1]?d:de[1],R=null==de[2]?d:de[2],ie=null==de[3]?d:de[3],me=null==de[10]?d:de[10],this.$_racc_init_sysvars(),$e=d,_e=d,V(this,"catch",["racc_end_parse"],function Ie(){var Ne=null==Ie.$$s?this:Ie.$$s;for(null==Ne.racc_state&&(Ne.racc_state=d);!$(_e=ie["$[]"](Ne.racc_state["$[]"](-1)));)for(;$($e=Ne.$_racc_evalact(R["$[]"](Ne.racc_state["$[]"](-1)),j)););return V(O,"__send__",[re],function We(nt,Nt){var mt=null==We.$$s?this:We.$$s,$t=d,cr=d;for(null==mt.racc_t&&(mt.racc_t=d),null==mt.racc_state&&(mt.racc_state=d),null==mt.racc_read_next&&(mt.racc_read_next=d),null==nt&&(nt=d),null==Nt&&(Nt=d),mt.racc_t=$(nt)?$($t=me["$[]"](nt))?$t:1:0,mt.racc_val=Nt,mt.racc_read_next=!1,_e=ne(_e,mt.racc_t),$(q(_e,0))&&$($e=he["$[]"](_e))&&k(B["$[]"](_e),mt.racc_state["$[]"](-1))||($e=R["$[]"](mt.racc_state["$[]"](-1)));$($e=mt.$_racc_evalact($e,j)););for(;$($($t=$(cr=(_e=ie["$[]"](mt.racc_state["$[]"](-1)))["$!"]())?cr:mt.racc_read_next["$!"]())?$t:mt.racc_t["$=="](0));)for($(_e)&&$(_e=ne(_e,mt.racc_t))&&$(q(_e,0))&&$($e=he["$[]"](_e))&&k(B["$[]"](_e),mt.racc_state["$[]"](-1))||($e=R["$[]"](mt.racc_state["$[]"](-1)));$($e=mt.$_racc_evalact($e,j)););},{$$arity:2,$$s:Ne})},{$$arity:0,$$s:this})},4),ue(S,"$_racc_evalact",function(O,re){var j,R,de=this,Ee=d,ce=d,B=d,ie=d,W=d,me=d,$e=d;if(Ee=null==(j=ee(re))[0]?d:j[0],ce=null==j[1]?d:j[1],B=null==j[3]?d:j[3],R=null==j[11]?d:j[11],ie=null==j[12]?d:j[12],$(z(O,0))&&$(L(O,R)))$(z(de.racc_error_status,0))&&(k(de.racc_t,1)||(de.racc_error_status=se(de.racc_error_status,1))),de.racc_vstack.$push(de.racc_val),de.racc_state.$push(O),de.racc_read_next=!0,$(de.yydebug)&&(de.racc_tstack.$push(de.racc_t),de.$racc_shift(de.racc_t,de.racc_tstack,de.racc_vstack));else if($(L(O,0))&&$(z(O,ie["$-@"]()))){if(W=V(de,"catch",["racc_jump"],function _e(){var Ie=null==_e.$$s?this:_e.$$s;return null==Ie.racc_state&&(Ie.racc_state=d),Ie.racc_state.$push(Ie.$_racc_do_reduce(re,O)),!1},{$$arity:0,$$s:de}),$(W)){if(A(1,me=W))return de.racc_user_yyerror=!0,ie["$-@"]();if(A(2,me))return R;de.$raise("[Racc Bug] unknown jump code")}}else if(k(O,R))$(de.yydebug)&&de.$racc_accept(),de.$throw("racc_end_parse",de.racc_vstack["$[]"](0));else{if(k(O,ie["$-@"]())){for(A(0,me=de.racc_error_status)?$(re["$[]"](21))||de.$on_error(de.racc_t,de.racc_val,de.racc_vstack):A(3,me)&&(k(de.racc_t,0)&&de.$throw("racc_end_parse",d),de.racc_read_next=!0),de.racc_user_yyerror=!1,de.racc_error_status=3;$(!0)&&!($($e=B["$[]"](de.racc_state["$[]"](-1)))&&($e=ne($e,1),$(q($e,0))&&$(O=Ee["$[]"]($e))&&k(ce["$[]"]($e),de.racc_state["$[]"](-1))));)$(N(de.racc_state.$size(),1))&&de.$throw("racc_end_parse",d),de.racc_state.$pop(),de.racc_vstack.$pop(),$(de.yydebug)&&(de.racc_tstack.$pop(),de.$racc_e_pop(de.racc_state,de.racc_tstack,de.racc_vstack));return O}de.$raise("[Racc Bug] unknown action "+O.$inspect())}return $(de.yydebug)&&de.$racc_next_state(de.racc_state["$[]"](-1),de.racc_state),d},2),ue(S,"$_racc_do_reduce",function(O,re){var j,ie,me,Ne,We,nt,mt,de=this,ce=d,he=d,B=d,R=d,W=d,$e=d,_e=d,Ie=d,Pe=d,Ae=d,Nt=d,jt=d,Ot=d,$t=d;return ce=null==(j=ee(O))[4]?d:j[4],he=null==j[5]?d:j[5],B=null==j[6]?d:j[6],R=null==j[7]?d:j[7],ie=null==j[8]?d:j[8],W=null==j[9]?d:j[9],me=null==j[13]?d:j[13],$e=de.racc_state,_e=de.racc_vstack,Ie=de.racc_tstack,Pe=P(re,-3),Ae=W["$[]"](Pe),Ne=W["$[]"](ne(Pe,1)),We=W["$[]"](ne(Pe,2)),nt=[],$(de.yydebug)&&(Nt=Ie["$[]"](Ae["$-@"](),Ae)),jt=_e["$[]"](Ae["$-@"](),Ae),$(de.yydebug)&&(Ot=[Ae["$-@"](),Ae,nt],V(Ie,"[]=",H(Ot)),se(Ot.length,1)),Ot=[Ae["$-@"](),Ae,nt],V(_e,"[]=",H(Ot)),se(Ot.length,1),Ot=[Ae["$-@"](),Ae,nt],V($e,"[]=",H(Ot)),se(Ot.length,1),$(me)?_e.$push(de.$__send__(We,jt,_e,jt["$[]"](0))):_e.$push(de.$__send__(We,jt,_e)),Ie.$push(Ne),$(de.yydebug)&&de.$racc_reduce(Nt,Ne,Ie,_e),mt=se(Ne,ie),$(Pe=R["$[]"](mt))&&(Pe=ne(Pe,$e["$[]"](-1)),$(q(Pe,0))&&$($t=ce["$[]"](Pe))&&k(he["$[]"](Pe),mt))?$t:B["$[]"](mt)},2),ue(S,"$on_error",function(O,re,j){var de;return this.$raise(le("ParseError"),this.$sprintf("\nparse error on value %s (%s)",re.$inspect(),$(de=this.$token_to_str(O))?de:"?"))},3),ue(S,"$yyerror",function(){return this.$throw("racc_jump",1)},0),ue(S,"$yyaccept",function(){return this.$throw("racc_jump",2)},0),ue(S,"$yyerrok",function(){return this.racc_error_status=0},0),ue(S,"$racc_read_token",function(O,re,j){var ve=this;return ve.racc_debug_out.$print("read    "),ve.racc_debug_out.$print(re.$inspect(),"(",ve.$racc_token2str(O),") "),ve.racc_debug_out.$puts(j.$inspect()),ve.racc_debug_out.$puts()},3),ue(S,"$racc_shift",function(O,re,j){return this.racc_debug_out.$puts("shift   "+this.$racc_token2str(O)),this.$racc_print_stacks(re,j),this.racc_debug_out.$puts()},3),ue(S,"$racc_reduce",function(O,re,j,ve){var de=this,Ee=d;return(Ee=de.racc_debug_out).$print("reduce "),$(O["$empty?"]())?Ee.$print(" <none>"):V(O,"each",[],function ce(he){return null==he&&(he=d),Ee.$print(" ",(null==ce.$$s?this:ce.$$s).$racc_token2str(he))},{$$arity:1,$$s:de}),Ee.$puts(" --\x3e "+de.$racc_token2str(re)),de.$racc_print_stacks(j,ve),de.racc_debug_out.$puts()},4),ue(S,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},0),ue(S,"$racc_e_pop",function(O,re,j){return this.racc_debug_out.$puts("error recovering mode: pop token"),this.$racc_print_states(O),this.$racc_print_stacks(re,j),this.racc_debug_out.$puts()},3),ue(S,"$racc_next_state",function(O,re){var j=this;return j.racc_debug_out.$puts("goto    "+O),j.$racc_print_states(re),j.racc_debug_out.$puts()},2),ue(S,"$racc_print_stacks",function(O,re){var ve=d;return(ve=this.racc_debug_out).$print("        ["),V(O,"each_index",[],function de(Ee){return null==Ee&&(Ee=d),ve.$print(" (",(null==de.$$s?this:de.$$s).$racc_token2str(O["$[]"](Ee))," ",re["$[]"](Ee).$inspect(),")")},{$$arity:1,$$s:this}),ve.$puts(" ]")},2),ue(S,"$racc_print_states",function(O){var j=d;return(j=this.racc_debug_out).$print("        ["),V(O,"each",[],function(de){return null==de&&(de=d),j.$print(" ",de)},1),j.$puts(" ]")},1),ue(S,"$racc_token2str",function(O){var j;return $(j=M(this.$class(),"Racc_token_to_s_table")["$[]"](O))?j:this.$raise("[Racc Bug] can't convert token "+O+" to string")},1),ue(S,"$token_to_str",function(O){return M(this.$class(),"Racc_token_to_s_table")["$[]"](O)},1)}(w[0],w)},Opal.modules.strscan=function(a){var H,se,ue,ee,Y,y=[],w=a.nil,d=a.def,M=a.truthy,v=a.eqeqeq,D=a.Opal,$=a.send,F=a.to_a,oe=a.rb_minus,G=a.alias;return H=y,ue=[se=(0,a.klass)(y[0],null,"StringScanner")].concat(H),ee=a.$r(ue),(Y=se.$$prototype).pos=Y.string=Y.working=Y.matched=Y.prev_pos=Y.match=w,se.$attr_reader("pos","matched"),d(se,"$initialize",function(k){var q=this;return q.string=k,q.pos=0,q.matched=w,q.working=k,q.match=[]},1),se.$attr_reader("string"),d(se,"$beginning_of_line?",function(){var k=this;return 0===k.pos||"\n"===k.string.charAt(k.pos-1)},0),d(se,"$scan",function(k){var q=this,z=(k=q.$anchor(k)).exec(q.working);return null==z?q.matched=w:"object"==typeof z?(q.prev_pos=q.pos,q.pos+=z[0].length,q.working=q.working.substring(z[0].length),q.matched=z[0],q.match=z,z[0]):"string"==typeof z?(q.pos+=z.length,q.working=q.working.substring(z.length),z):w},1),d(se,"$scan_until",function(k){var q=this;k=q.$anchor(k);for(var N,z=q.pos,A=q.working;;){if(N=k.exec(A),z+=1,A=A.substr(1),null!=N)return q.matched=q.string.substr(q.pos,z-q.pos-1+N[0].length),q.match=N,q.prev_pos=z-1,q.pos=z,q.working=A.substr(N[0].length),q.matched;if(0===A.length)return q.match=[],q.matched=w}},1),d(se,"$[]",function(k){var z;if(M(this.match["$empty?"]()))return w;v(ee("Symbol"),z=k)?k=k.$to_s():v(ee("String"),z)||(k=D["$coerce_to!"](k,ee("Integer"),"to_int"));var A=this.match;return k<0&&(k+=A.length),k<0||k>=A.length||null==A[k]?w:A[k]},1),d(se,"$check",function(k){var q=this,z=(k=q.$anchor(k)).exec(q.working);return q.matched=null==z?w:z[0]},1),d(se,"$check_until",function(k){var q=this,z=q.prev_pos,A=q.pos,N=q.$scan_until(k);return N!==w&&(q.matched=N.substr(-1),q.working=q.string.substr(A)),q.prev_pos=z,q.pos=A,N},1),d(se,"$peek",function(k){return this.working.substring(0,k)},1),d(se,"$eos?",function(){return 0===this.working.length},0),d(se,"$exist?",function(k){var z=k.exec(this.working);return null==z?w:0==z.index?0:z.index+1},1),d(se,"$skip",function(k){var q=this,z=(k=q.$anchor(k)).exec(q.working);if(null==z)return q.match=[],q.matched=w;var A=z[0],N=A.length;return q.matched=A,q.match=z,q.prev_pos=q.pos,q.pos+=N,q.working=q.working.substring(N),N},1),d(se,"$skip_until",function(k){var z=this.$scan_until(k);return z===w?w:(this.matched=z.substr(-1),z.length)},1),d(se,"$get_byte",function(){var k=this,q=w;return k.pos<k.string.length?(k.prev_pos=k.pos,k.pos+=1,q=k.matched=k.working.substring(0,1),k.working=k.working.substring(1)):k.matched=w,q},0),d(se,"$match?",function(k){var q=this,z=(k=q.$anchor(k)).exec(q.working);return null==z?w:(q.prev_pos=q.pos,z[0].length)},1),d(se,"$pos=",function(k){var q=this;return k<0&&(k+=q.string.$length()),q.pos=k,q.working=q.string.slice(k)},1),d(se,"$matched_size",function(){return this.matched===w?w:this.matched.length},0),d(se,"$post_match",function(){var k=this;return k.matched===w?w:k.string.substr(k.pos)},0),d(se,"$pre_match",function(){var k=this;return k.matched===w?w:k.string.substr(0,k.prev_pos)},0),d(se,"$reset",function(){var k=this;return k.working=k.string,k.matched=w,k.pos=0},0),d(se,"$rest",function(){return this.working},0),d(se,"$rest?",function(){return 0!==this.working.length},0),d(se,"$rest_size",function(){return this.$rest().$size()},0),d(se,"$terminate",function(){var q,k=this;return k.match=w,q=[k.string.$length()],$(k,"pos=",F(q)),q[oe(q.length,1)]},0),d(se,"$unscan",function(){var k=this;return k.pos=k.prev_pos,k.prev_pos=w,k.match=w,k},0),G(se,"bol?","beginning_of_line?"),G(se,"getch","get_byte"),se.$private(),d(se,"$anchor",function(k){var q=k.toString().match(/\/([^\/]+)$/);return q=q?q[1]:void 0,new RegExp("^(?:"+k.source+")",q)},1)},Opal.modules["bcdice/common_command/lexer"]=function(a){var G,se,k,q,z,A,ee,V,y=a.top,w=[],p=a.nil,d=a.module,M=a.klass,v=a.const_set,D=a.hash2,$=a.truthy,F=a.def;return y.$require("strscan"),y.$require("bcdice/normalize"),G=w,se=V=[d(w[0],"BCDice")].concat(G),k=ee=[d(V[0],"CommonCommand")].concat(se),z=[q=M(ee[0],null,"Lexer")].concat(k),A=a.$r(z),q.$$prototype.scanner=p,v(z[0],"SYMBOLS",D(["+","-","*","/","(",")","[","]","?","@"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","?":"QUESTION","@":"AT"}).$freeze()),F(q,"$initialize",function(g){var C;return g=$(C=g.$split(" ",2).$first())?C:"",this.scanner=A("StringScanner").$new(g)},1),F(q,"$next_token",function(){var g=this,b=p,C=p,h=p,l=p;return $(g.scanner["$eos?"]())?[!1,"$"]:$(b=g.scanner.$scan(/\d+/))?["NUMBER",b.$to_i()]:$(C=g.scanner.$scan(/[<>!=]+/))?["CMP_OP",A("Normalize").$comparison_operator(C)]:(h=g.scanner.$getch().$upcase(),[$(l=A("SYMBOLS")["$[]"](h))?l:h.$to_sym(),h])},0),F(q,"$source",function(){return this.scanner.$string()},0)},Opal.modules.singleton=function(a){var G,ue,ee,Y,ne,L,V,H,y=[],w=a.nil,p=a.module,d=a.def,M=a.send2,v=a.find_super,D=a.send,$=a.truthy,F=a.defs;return G=y,V=[L=p(y[0],"Singleton")].concat(G),H=a.$r(V),d(L,"$clone",function(){return this.$raise(H("TypeError"),"can't clone instance of singleton "+this.$class())},0),d(L,"$dup",function(){return this.$raise(H("TypeError"),"can't dup instance of singleton "+this.$class())},0),ue=V,Y=[ee=p(V[0],"SingletonClassMethods")].concat(ue),ne=a.$r(Y),d(ee,"$clone",function k(){var q=k.$$p||w;return delete k.$$p,ne("Singleton").$__init__(M(this,v(this,"clone",k,!1,!0),"clone",[],q))},0),d(ee,"$inherited",function k(q){var z=k.$$p||w;return delete k.$$p,M(this,v(this,"inherited",k,!1,!0),"inherited",[q],z),ne("Singleton").$__init__(q)},1),function(se,ue){var ee=[se].concat(ue),Y=a.$r(ee);return d(se,"$__init__",function(k){return D(k,"instance_eval",[],function z(){return(null==z.$$s?this:z.$$s).singleton__instance__=w},{$$arity:0,$$s:this}),F(k,"$instance",function(){var A=this;return null==A.singleton__instance__&&(A.singleton__instance__=w),$(A.singleton__instance__)?A.singleton__instance__:A.singleton__instance__=A.$new()},0),k},1),d(se,"$included",function ne(k){var q=ne.$$p||w;return delete ne.$$p,M(this,v(this,"included",ne,!1,!0),"included",[k],q),k.$extend(Y("SingletonClassMethods")),Y("Singleton").$__init__(k)},1)}(a.get_singleton_class(H("Singleton")),V)},Opal.modules["bcdice/common_command/add_dice/node"]=function(a){var A,b,l,S,re,j,ve,de,Ee,le,Ce,_,h,P,w=[],p=a.nil,d=a.$$$,M=a.module,v=a.klass,D=a.def,$=a.rb_plus,F=a.send,oe=a.truthy,G=a.rb_le,L=a.to_a,V=a.rb_minus,H=a.eqeqeq,se=a.alias,ue=a.send2,ee=a.find_super,Y=a.const_set,ne=a.rb_divide,k=a.not,q=a.neqeq;return a.top.$require("singleton"),A=w,b=P=[M(w[0],"BCDice")].concat(A),l=h=[M(P[0],"CommonCommand")].concat(b),S=_=[M(h[0],"AddDice")].concat(l),le=[M(_[0],"Node")].concat(S),Ce=a.$r(le),re=le,ve=[j=v(le[0],null,"Command")].concat(re),de=a.$r(ve),(Ee=j.$$prototype).lhs=Ee.rhs=Ee.cmp_op=p,j.$attr_reader("lhs"),j.$attr_reader("cmp_op"),j.$attr_reader("rhs"),D(j,"$initialize",function(he,B,R,ie){var W=this;return null==R&&(R=p),null==ie&&(ie=p),W.secret=he,W.lhs=B,W.cmp_op=R,W.rhs=ie},-3),D(j,"$expr",function(he){var B,R=this;return $($(R.lhs.$expr(he),R.$cmp_op_text()),(B=R.rhs,B===p||null==B?p:F(B,"eval",[he,p])).$to_s())},1),D(j,"$s_exp",function(){var he=this;return oe(he.cmp_op)?"(Command ("+he.cmp_op+" "+he.lhs.$s_exp()+" "+he.rhs.$s_exp()+"))":"(Command "+he.lhs.$s_exp()+")"},0),D(j,"$eval",function(he,B){var R,Ie,ie=this,W=p,me=p,$e=p,_e=p,Pe=p;return B=de("Randomizer").$new(B,he),W=ie.lhs.$eval(he,B),me=oe(G(B.$rand_results().$size(),1))&&oe(ie.lhs["$is_a?"](d(de("Node"),"DiceRoll")))?p:ie.lhs.$output(),$e=oe(ie.cmp_op)?(_e=ie.rhs.$eval(he,p),he.$check_result(W,B.$rand_results(),ie.cmp_op,_e)):p,$e=oe(Ie=$e)?Ie:de("Result").$new(),Pe=["("+ie.$expr(he)+")",me,W,(R=$e,R===p||null==R?p:F(R,"text",[]))].$compact(),F($e,"tap",[],function Ae(Ne){var We=null==Ae.$$s?this:Ae.$$s,nt=p;return null==We.secret&&(We.secret=p),null==Ne&&(Ne=p),F(Ne,"secret=",L(nt=[We.secret])),V(nt.length,1),nt=[Pe.$join(" \uff1e ")],F(Ne,"text=",L(nt)),nt[V(nt.length,1)]},{$$arity:1,$$s:ie})},2),j.$private(),D(j,"$cmp_op_text",function(){var B;return H("!=",B=this.cmp_op)?"<>":H("==",B)?"=":this.cmp_op.$to_s()},0),function(T,O,re){var j=v(T,null,"UndecidedTarget"),ve=[j].concat(re),de=a.$r(ve);j.$include(de("Singleton")),D(j,"$eval",function(ce,he){return"?"},2),D(j,"$include_dice?",function(){return!1},0),D(j,"$expr",function(ce){return"?"},1),D(j,"$output",function(){return"?"},0),se(j,"s_exp","output")}(le[0],0,le),function(T,O){var re=v(T,null,"BinaryOp"),j=re.$$prototype;j.lhs=j.rhs=j.op=p,D(re,"$initialize",function(de,Ee,ce){return this.lhs=de,this.op=Ee,this.rhs=ce},3),D(re,"$eval",function(de,Ee){var he,B;return he=this.lhs.$eval(de,Ee),B=this.rhs.$eval(de,Ee),this.$calc(he,B,de.$round_type()).$to_i()},2),D(re,"$include_dice?",function(){var Ee;return oe(Ee=this.lhs["$include_dice?"]())?Ee:this.rhs["$include_dice?"]()},0),D(re,"$expr",function(de){var ce,he;return ce=this.lhs.$expr(de),he=this.rhs.$expr(de),""+ce+this.op+he},1),D(re,"$output",function(){return""+this.lhs.$output()+this.op+this.rhs.$output()},0),D(re,"$s_exp",function(){return"("+this.$op_for_s_exp()+" "+this.lhs.$s_exp()+" "+this.rhs.$s_exp()+")"},0),re.$private(),D(re,"$calc",function(de,Ee,ce){return de.$send(this.op,Ee).$to_i()},3),D(re,"$op_for_s_exp",function(){return this.op},0)}(le[0]),function(T,O,re){var j=v(T,O,"DivideBase"),ve=[j].concat(re),de=a.$r(ve);j.$$prototype.op=p,D(j,"$initialize",function ce(he,B){return delete ce.$$p,ue(this,ee(this,"initialize",ce,!1,!0),"initialize",[he,"/",B],null)},2),D(j,"$expr",function ce(he){var R=this;return delete ce.$$p,""+ue(R,ee(R,"expr",ce,!1,!0),"expr",[he],null)+R.$rounding_method()},1),D(j,"$output",function ce(){var he=ce.$$p||p,B=this;return delete ce.$$p,""+ue(B,ee(B,"output",ce,!1,!0),"output",[],he)+B.$rounding_method()},0),j.$private(),D(j,"$rounding_method",function(){return d(this.$class(),"ROUNDING_METHOD")},0),D(j,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()},0),D(j,"$calc",function(he,B,R){return oe(B["$zero?"]())?1:this.$divide_and_round(he,B,R).$to_i()},3),D(j,"$divide_and_round",function(he,B,R){return this.$raise(de("NotImplementedError"))},3)}(le[0],Ce("BinaryOp"),le),function(T,O,re){var j=v(T,O,"DivideWithGameSystemDefault"),ve=[j].concat(re),de=a.$r(ve);Y(ve[0],"ROUNDING_METHOD",""),j.$private(),D(j,"$divide_and_round",function(ce,he,B){var R,ie=p;return H(d(de("RoundType"),"CEIL"),R=B)?ne(ce.$to_f(),he).$ceil():H(d(de("RoundType"),"ROUND"),R)?(ie=ne(ce.$to_f(),he),oe(ie["$negative?"]())?ie.$abs().$round()["$-@"]():ie.$round()):ne(ce,he).$floor()},3)}(le[0],Ce("DivideBase"),le),function(T,O,re){var j=v(T,O,"DivideWithRoundingUp"),ve=[j].concat(re);Y(ve[0],"ROUNDING_METHOD","U"),j.$private(),D(j,"$divide_and_round",function(Ee,ce,he){return ne(Ee.$to_f(),ce).$ceil()},3)}(le[0],Ce("DivideBase"),le),function(T,O,re){var j=v(T,O,"DivideWithRoundingOff"),ve=[j].concat(re);Y(ve[0],"ROUNDING_METHOD","R"),j.$private(),D(j,"$divide_and_round",function(Ee,ce,he){var B=p;return B=ne(Ee.$to_f(),ce),oe(B["$negative?"]())?B.$abs().$round()["$-@"]():B.$round()},3)}(le[0],Ce("DivideBase"),le),function(T,O,re){var j=v(T,O,"DivideWithRoundingDown"),ve=[j].concat(re);Y(ve[0],"ROUNDING_METHOD","F"),j.$private(),D(j,"$divide_and_round",function(Ee,ce,he){return ne(Ee,ce).$floor()},3)}(le[0],Ce("DivideBase"),le),function(T,O){var re=v(T,null,"Negate");re.$$prototype.body=p,re.$attr_reader("body"),D(re,"$initialize",function(de){return this.body=de},1),D(re,"$eval",function(de,Ee){return this.body.$eval(de,Ee).$to_i()["$-@"]()},2),D(re,"$include_dice?",function(){return this.body["$include_dice?"]()},0),D(re,"$expr",function(de){return"-"+this.body.$expr(de)},1),D(re,"$output",function(){return"-"+this.body.$output()},0),D(re,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"},0)}(le[0]),function(T,O){var re=v(T,null,"DiceRoll"),j=re.$$prototype;j.times=j.text=j.sides=p,D(re,"$initialize",function(de,Ee){return this.times=de,this.sides=Ee,this.text=p},2),D(re,"$eval",function(de,Ee){var he,B,R=p,ie=p;return he=this.times.$eval(de,p),B=this.$eval_sides(de),ie=(R=Ee.$roll(he,B)).$sum(),this.text=ie+"["+R.$join(",")+"]",ie.$to_i()},2),D(re,"$include_dice?",function(){return!0},0),D(re,"$expr",function(de){return this.times.$eval(de,p)+"D"+this.$eval_sides(de)},1),D(re,"$output",function(){return this.text},0),D(re,"$s_exp",function(){return"(DiceRoll "+this.times.$s_exp()+" "+this.sides.$s_exp()+")"},0),re.$private(),D(re,"$eval_sides",function(de){return this.sides.$eval(de,p)},1)}(le[0]),function(T,O){var re=v(T,O,"ImplicitSidesDiceRoll");re.$$prototype.times=p,D(re,"$initialize",function(de){return this.times=de,this.text=p},1),D(re,"$s_exp",function(){return"(ImplicitSidesDiceRoll "+this.times.$s_exp()+")"},0),re.$private(),D(re,"$eval_sides",function(de){return de.$sides_implicit_d()},1)}(le[0],Ce("DiceRoll")),function(T,O,re){var j=v(T,null,"DiceRollWithFilter"),ve=[j].concat(re),de=a.$r(ve),Ee=j.$$prototype;Ee.times=Ee.n_filtering=Ee.filter=Ee.sides=Ee.text=p,Y(ve[0],"Filter",de("Struct").$new("abbr","apply")),Y(ve[0],"KEEP_HIGHEST",de("Filter").$new("KH",F(j,"lambda",[],function(he,B){return null==he&&(he=p),null==B&&(B=p),he.$reverse().$take(B)},2)).$freeze()),Y(ve[0],"KEEP_LOWEST",de("Filter").$new("KL",F(j,"lambda",[],function(he,B){return null==he&&(he=p),null==B&&(B=p),he.$take(B)},2)).$freeze()),Y(ve[0],"DROP_HIGHEST",de("Filter").$new("DH",F(j,"lambda",[],function(he,B){return null==he&&(he=p),null==B&&(B=p),he.$reverse().$drop(B)},2)).$freeze()),Y(ve[0],"DROP_LOWEST",de("Filter").$new("DL",F(j,"lambda",[],function(he,B){return null==he&&(he=p),null==B&&(B=p),he.$drop(B)},2)).$freeze()),D(j,"$initialize",function(he,B,R,ie){var W=this;return q(B,"implicit")&&k(B["$respond_to?"]("eval"))&&W.$raise(de("TypeError"),"sides must be a Node or :implicit ("+B.$inspect()+")"),W.times=he,W.sides=B,W.n_filtering=R,W.filter=ie,W.text=p},4),D(j,"$eval",function(he,B){var ie,W,me,R=this,$e=p,_e=p;return ie=R.times.$eval(he,p),W=R.$eval_sides(he),me=R.n_filtering.$eval(he,p),$e=B.$roll(ie,W).$sort(),_e=R.filter.$apply()["$[]"]($e,me).$sum(),R.text=_e+"["+$e.$join(",")+"]",_e.$to_i()},2),D(j,"$include_dice?",function(){return!0},0),D(j,"$implicit_sides?",function(){return this.sides["$=="]("implicit")},0),D(j,"$expr",function(he){var R,ie,W,B=this;return R=B.times.$eval(he,p),ie=B.$eval_sides(he),W=B.n_filtering.$eval(he,p),R+"D"+ie+B.filter.$abbr()+W},1),D(j,"$output",function(){return this.text},0),D(j,"$s_exp",function(){var B,he=this;return B=oe(he["$implicit_sides?"]())?he.sides.$inspect():he.sides.$s_exp(),"(DiceRollWithFilter "+he.times.$s_exp()+" "+B+" "+he.filter.$abbr().$inspect()+" "+he.n_filtering.$s_exp()+")"},0),j.$private(),D(j,"$eval_sides",function(he){return oe(this["$implicit_sides?"]())?he.$sides_implicit_d():this.sides.$eval(he,p)},1)}(le[0],0,le),function(T,O){var re=v(T,null,"Parenthesis");re.$$prototype.expr=p,D(re,"$initialize",function(de){return this.expr=de},1),D(re,"$eval",function(de,Ee){return this.expr.$eval(de,Ee).$to_i()},2),D(re,"$include_dice?",function(){return this.expr["$include_dice?"]()},0),D(re,"$expr",function(de){return"("+this.expr.$expr(de)+")"},1),D(re,"$output",function(){return"("+this.expr.$output()+")"},0),D(re,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"},0)}(le[0]),function(T,O,re){var j=v(T,null,"Number"),ve=[j].concat(re),de=a.$r(ve);return j.$$prototype.literal=p,j.$attr_reader("literal"),D(j,"$initialize",function(he){return this.literal=he.$to_i()},1),D(j,"$negate",function(){return de("Number").$new(this.literal["$-@"]())},0),D(j,"$eval",function(he,B){return this.literal.$to_i()},2),D(j,"$include_dice?",function(){return!1},0),D(j,"$expr",function(he){return this.literal.$to_s()},1),D(j,"$output",function(){return this.literal.$to_s()},0),se(j,"s_exp","output")}(le[0],0,le)},Opal.modules["bcdice/common_command/add_dice/parser"]=function(a){var Y,z,g,f,Q,le,Ce,T,O,re,j,ve,de,he,_,x,S,C,h,N,k,y=a.top,w=[],p=a.nil,d=a.$$$,M=a.module,v=a.klass,D=a.defs,$=a.def,F=a.truthy,oe=a.eqeq,G=a.hash,L=a.const_set,V=a.to_ary,H=a.not,se=a.neqeq,ue=a.hash2;return y.$require("racc/parser.rb"),y.$require("bcdice/common_command/lexer"),y.$require("bcdice/common_command/add_dice/node"),Y=w,z=k=[M(w[0],"BCDice")].concat(Y),g=N=[M(k[0],"CommonCommand")].concat(z),C=[M(N[0],"AddDice")].concat(g),h=a.$r(C),f=C,x=[_=v(C[0],d(h("Racc"),"Parser"),"Parser")].concat(f),S=a.$r(x),_.$$prototype.lexer=p,D(_,"$parse",function(me){return this.$new().$parse(me)},1),$(_,"$parse",function(me){try{return this.lexer=S("Lexer").$new(me),this.$do_parse()}catch(_e){if(!a.rescue(_e,[S("ParseError")]))throw _e;try{return p}finally{a.pop_exception()}}},1),_.$private(),$(_,"$next_token",function(){return this.lexer.$next_token()},0),$(_,"$expand_negate",function(me,$e){if(F($e["$is_a?"](d(S("Node"),"Negate")))){if(oe(me,"+"))return["-",$e.$body()];if(oe(me,"-"))return["+",$e.$body()]}return[me,$e]},2),Q=[14,14,50,12,51,19,20,14,14,14,12,3,12,17,18,14,8,9,12,4,13,13,28,8,9,8,9,13,13,13,14,8,9,12,15,13,14,23,14,12,56,12,19,20,57,14,8,9,12,p,13,p,8,9,8,9,13,14,13,p,12,8,9,14,16,13,-27,-27,19,20,-27,17,18,8,9,p,42,13,p,17,18,40,39,13,p,38,-28,-28,40,39,-28,p,38,45,47,44,46,52,53,54,55],le=[16,12,38,16,38,6,6,2,36,8,2,0,8,27,27,9,16,16,9,1,16,12,16,2,2,8,8,2,36,8,13,9,9,13,4,9,17,11,18,17,50,18,29,29,51,19,13,13,19,p,13,p,17,17,18,18,17,20,18,p,20,19,19,23,5,19,23,23,30,30,23,25,25,20,20,p,25,20,p,5,5,24,24,23,p,24,33,33,34,34,33,p,34,32,32,32,32,39,39,40,40],Ce=[7,19,5,p,34,61,-15,p,7,13,p,32,-1,28,p,p,-2,34,36,43,55,p,p,61,76,53,p,-5,p,22,48,p,79,81,83,p,6,p,-8,90,92,p,p,p,p,p,p,p,p,p,29,31,p,p,p,p,p,p],T=[-3,-41,-41,-4,-41,-1,-9,-12,-41,-41,-20,-26,-41,-41,-40,58,-41,-41,-41,-41,-41,-18,-19,-22,-24,-41,-2,-5,-6,-7,-8,-10,-13,-21,-41,-25,-37,-30,-41,-41,-41,-38,-39,-11,-14,-15,-16,-17,-23,-29,-41,-41,-33,-34,-35,-36,-31,-32],O=[24,5,21,22,29,30,35,1,2,26,43,33,25,31,32,27,48,34,p,p,p,p,p,p,49],re=[9,3,6,6,5,5,11,1,2,4,7,9,3,6,6,3,11,10,p,p,p,p,p,p,9],j=[p,7,8,-1,-7,-13,-6,-22,p,-12,-6,-18,p,p,p],ve=[p,p,p,p,p,6,7,p,10,11,p,p,36,37,41],de=[0,0,"racc_error",2,26,"_reduce_1",4,26,"_reduce_2",0,27,"_reduce_3",1,27,"_reduce_4",1,29,"_reduce_none",1,29,"_reduce_6",3,28,"_reduce_7",3,28,"_reduce_8",1,28,"_reduce_none",3,30,"_reduce_10",4,30,"_reduce_11",1,30,"_reduce_none",0,32,"_reduce_13",1,32,"_reduce_14",1,32,"_reduce_15",1,32,"_reduce_16",1,32,"_reduce_17",2,31,"_reduce_18",2,31,"_reduce_19",1,31,"_reduce_none",3,33,"_reduce_21",2,33,"_reduce_22",4,33,"_reduce_23",2,33,"_reduce_24",3,33,"_reduce_25",1,33,"_reduce_none",0,35,"_reduce_27",1,35,"_reduce_28",2,36,"_reduce_29",1,36,"_reduce_30",3,39,"_reduce_31",3,39,"_reduce_32",2,37,"_reduce_33",2,37,"_reduce_34",2,37,"_reduce_35",2,37,"_reduce_36",1,38,"_reduce_none",1,38,"_reduce_none",3,34,"_reduce_39",1,34,"_reduce_40"],he=G(!1,0,"error",1,"NUMBER",2,"CMP_OP",3,"S",4,"D",5,"K",6,"H",7,"L",8,"M",9,"A",10,"X",11,"I",12,"N",13,"U",14,"R",15,"F",16,"C",17,"PLUS",18,"MINUS",19,"ASTERISK",20,"SLASH",21,"PARENL",22,"PARENR",23,"QUESTION",24),L(x[0],"Racc_arg",[Q,le,T,Ce,O,re,ve,j,25,de,he,58,41,!0]),L(x[0],"Racc_token_to_s_table",["$end","error","NUMBER","CMP_OP","S","D","K","H","L","M","A","X","I","N","U","R","F","C","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","QUESTION","$start","command","secret","add","target","mul","unary","round_type","dice","term","explicit_or_implicit_sides","filter","filter_type","filter_type_with_shorthand","filter_shorthand"]),L(x[0],"Racc_debug_parser",!1),$(_,"$_reduce_1",function(me,$e,_e){var Ie,Ne,We=p;return Ne=null==(Ie=V(me))[0]?p:Ie[0],F((We=null==Ie[1]?p:Ie[1])["$include_dice?"]())||this.$raise(S("ParseError")),d(S("Node"),"Command").$new(Ne,We)},3),$(_,"$_reduce_2",function(me,$e,_e){var Ie,Ne,We=p,nt=p,Nt=p;return Ne=null==(Ie=V(me))[0]?p:Ie[0],nt=null==Ie[2]?p:Ie[2],Nt=null==Ie[3]?p:Ie[3],(H((We=null==Ie[1]?p:Ie[1])["$include_dice?"]())||F(Nt["$include_dice?"]())||F(nt["$nil?"]()))&&this.$raise(S("ParseError")),d(S("Node"),"Command").$new(Ne,We,nt,Nt)},3),$(_,"$_reduce_3",function(me,$e,_e){return!1},3),$(_,"$_reduce_4",function(me,$e,_e){return!0},3),$(_,"$_reduce_6",function(me,$e,_e){return d(S("Node"),"UndecidedTarget").$instance()},3),$(_,"$_reduce_7",function(me,$e,_e){var Ie,Pe,Ne,We,nt;return Ne=me["$[]"](0),Pe=this.$expand_negate("+",me["$[]"](2)),We=null==(Ie=V(Pe))[0]?p:Ie[0],nt=null==Ie[1]?p:Ie[1],d(S("Node"),"BinaryOp").$new(Ne,We,nt)},3),$(_,"$_reduce_8",function(me,$e,_e){var Ie,Pe,Ne,We,nt;return Ne=me["$[]"](0),Pe=this.$expand_negate("-",me["$[]"](2)),We=null==(Ie=V(Pe))[0]?p:Ie[0],nt=null==Ie[1]?p:Ie[1],d(S("Node"),"BinaryOp").$new(Ne,We,nt)},3),$(_,"$_reduce_10",function(me,$e,_e){var Ie,Pe;return Ie=me["$[]"](0),Pe=me["$[]"](2),d(S("Node"),"BinaryOp").$new(Ie,"*",Pe)},3),$(_,"$_reduce_11",function(me,$e,_e){var Ie,Pe;return Ie=me["$[]"](0),Pe=me["$[]"](2),me["$[]"](3).$new(Ie,Pe)},3),$(_,"$_reduce_13",function(me,$e,_e){return d(S("Node"),"DivideWithGameSystemDefault")},3),$(_,"$_reduce_14",function(me,$e,_e){return d(S("Node"),"DivideWithRoundingDown")},3),$(_,"$_reduce_15",function(me,$e,_e){return d(S("Node"),"DivideWithRoundingUp")},3),$(_,"$_reduce_16",function(me,$e,_e){return d(S("Node"),"DivideWithRoundingUp")},3),$(_,"$_reduce_17",function(me,$e,_e){return d(S("Node"),"DivideWithRoundingOff")},3),$(_,"$_reduce_18",function(me,$e,_e){return me["$[]"](1)},3),$(_,"$_reduce_19",function(me,$e,_e){var Ie=p;return Ie=me["$[]"](1),F(Ie["$is_a?"](d(S("Node"),"Negate")))?Ie.$body():d(S("Node"),"Negate").$new(Ie)},3),$(_,"$_reduce_21",function(me,$e,_e){var Pe=p,Ae=p;return Pe=me["$[]"](0),Ae=me["$[]"](2),(F(Pe["$include_dice?"]())||F(Ae["$include_dice?"]()))&&this.$raise(S("ParseError")),d(S("Node"),"DiceRoll").$new(Pe,Ae)},3),$(_,"$_reduce_22",function(me,$e,_e){var Pe=p;return Pe=me["$[]"](0),F(Pe["$include_dice?"]())&&this.$raise(S("ParseError")),d(S("Node"),"ImplicitSidesDiceRoll").$new(Pe)},3),$(_,"$_reduce_23",function(me,$e,_e){var Ne,Pe=p,Ae=p,We=p;return Pe=me["$[]"](0),Ae=me["$[]"](2),Ne=me["$[]"](3)["$[]"]("filter"),We=me["$[]"](3)["$[]"]("n_filtering"),se(Ae,"implicit")&&F(Ae["$include_dice?"]())&&this.$raise(S("ParseError")),(F(Pe["$include_dice?"]())||F(We["$include_dice?"]()))&&this.$raise(S("ParseError")),d(S("Node"),"DiceRollWithFilter").$new(Pe,Ae,We,Ne)},3),$(_,"$_reduce_24",function(me,$e,_e){var Pe,Ae=p;return Pe=d(S("Node"),"Number").$new(1),Ae=me["$[]"](1),F(Ae["$include_dice?"]())&&this.$raise(S("ParseError")),F(Ae["$instance_of?"](d(S("Node"),"Number")))&&oe(Ae.$literal(),66)&&this.$raise(S("ParseError")),d(S("Node"),"DiceRoll").$new(Pe,Ae)},3),$(_,"$_reduce_25",function(me,$e,_e){var Pe,Ne,Ae=p,We=p;return Pe=d(S("Node"),"Number").$new(1),Ae=me["$[]"](1),Ne=me["$[]"](2)["$[]"]("filter"),We=me["$[]"](2)["$[]"]("n_filtering"),se(Ae,"implicit")&&F(Ae["$include_dice?"]())&&this.$raise(S("ParseError")),F(We["$include_dice?"]())&&this.$raise(S("ParseError")),F(Ae["$instance_of?"](d(S("Node"),"Number")))&&oe(Ae.$literal(),66)&&this.$raise(S("ParseError")),d(S("Node"),"DiceRollWithFilter").$new(Pe,Ae,We,Ne)},3),$(_,"$_reduce_27",function(me,$e,_e){return"implicit"},3),$(_,"$_reduce_28",function(me,$e,_e){return me["$[]"](0)},3),$(_,"$_reduce_29",function(me,$e,_e){return ue(["filter","n_filtering"],{filter:me["$[]"](0),n_filtering:me["$[]"](1)})},3),$(_,"$_reduce_30",function(me,$e,_e){return ue(["filter","n_filtering"],{filter:me["$[]"](0),n_filtering:d(S("Node"),"Number").$new(1)})},3),$(_,"$_reduce_31",function(me,$e,_e){return d(d(S("Node"),"DiceRollWithFilter"),"KEEP_HIGHEST")},3),$(_,"$_reduce_32",function(me,$e,_e){return d(d(S("Node"),"DiceRollWithFilter"),"KEEP_LOWEST")},3),$(_,"$_reduce_33",function(me,$e,_e){return d(d(S("Node"),"DiceRollWithFilter"),"KEEP_HIGHEST")},3),$(_,"$_reduce_34",function(me,$e,_e){return d(d(S("Node"),"DiceRollWithFilter"),"KEEP_LOWEST")},3),$(_,"$_reduce_35",function(me,$e,_e){return d(d(S("Node"),"DiceRollWithFilter"),"DROP_HIGHEST")},3),$(_,"$_reduce_36",function(me,$e,_e){return d(d(S("Node"),"DiceRollWithFilter"),"DROP_LOWEST")},3),$(_,"$_reduce_39",function(me,$e,_e){return d(S("Node"),"Parenthesis").$new(me["$[]"](1))},3),$(_,"$_reduce_40",function(me,$e,_e){return d(S("Node"),"Number").$new(me["$[]"](0))},3),$(_,"$_reduce_none",function(me,$e,_e){return me["$[]"](0)},3)},Opal.modules["bcdice/common_command/add_dice/randomizer"]=function(a){var G,se,ne,N,P,g,b,C,q,ee,V,y=[],w=a.nil,p=a.module,d=a.klass,M=a.const_set,v=a.def,D=a.eqeq,$=a.send,F=a.truthy;return G=y,se=V=[p(y[0],"BCDice")].concat(G),ne=ee=[p(V[0],"CommonCommand")].concat(se),N=q=[p(ee[0],"AddDice")].concat(ne),g=[P=d(q[0],null,"Randomizer")].concat(N),b=a.$r(g),(C=P.$$prototype).game_system=C.rand_source=C.rand_results=w,P.$attr_reader("rand_results"),M(g[0],"RandResult",b("Struct").$new("sides","value")),v(P,"$initialize",function(u,l){var f=this;return f.rand_source=u,f.game_system=l,f.rand_results=[]},2),v(P,"$roll",function(u,l){var x,f=this,_=w;return _=D(l,66)?$(b("Array"),"new",[u],function S(){var Q=null==S.$$s?this:S.$$s;return null==Q.rand_source&&(Q.rand_source=w),null==Q.game_system&&(Q.game_system=w),Q.rand_source.$roll_d66(Q.game_system.$d66_sort_type())},{$$arity:0,$$s:f}):D(l,9)&&F(f.game_system["$enabled_d9?"]())?$(b("Array"),"new",[u],function S(){var Q=null==S.$$s?this:S.$$s;return null==Q.rand_source&&(Q.rand_source=w),Q.rand_source.$roll_d9()},{$$arity:0,$$s:f}):f.rand_source.$roll_barabara(u,l),F(f.game_system["$sort_add_dice?"]())&&_["$sort!"](),x=$(_,"map",[],function(Q){return null==Q&&(Q=w),b("RandResult").$new(l,Q)},1),f.rand_results.$concat(x),_},2)},Opal.modules["bcdice/common_command/add_dice"]=function(a){var F,V,ee,k,z,A,Y,ne,se,G,y=a.top,w=[],p=a.nil,d=a.module,M=a.const_set,v=a.send,D=a.def;return y.$require("bcdice/normalize"),y.$require("bcdice/common_command/add_dice/parser"),y.$require("bcdice/common_command/add_dice/randomizer"),F=w,V=G=[d(w[0],"BCDice")].concat(F),ee=se=[d(G[0],"CommonCommand")].concat(V),M((ne=[Y=d(se[0],"AddDice")].concat(ee))[0],"PREFIX_PATTERN",/[+\-(]*(\d+|D\d+)/.$freeze()),z=[k=a.get_singleton_class(Y)].concat(ne),A=a.$r(z),D(k,"$eval",function(P,g,b){var C;return(C=A("Parser").$parse(P))===p||null==C?p:v(C,"eval",[g,b])},3)},Opal.modules["bcdice/common_command/reroll_dice/node"]=function(a){var ne,A,b,l,Q,le,Ce,T,O,_,h,P,q,y=[],w=a.nil,p=a.module,d=a.klass,M=a.hash2,v=a.def,D=a.truthy,$=a.send,F=a.rb_lt,oe=a.rb_plus,G=a.rb_gt,L=a.eqeq,V=a.to_a,H=a.rb_minus,se=a.eqeqeq,ue=a.rb_le,ee=a.rb_ge;return ne=y,A=q=[p(y[0],"BCDice")].concat(ne),b=P=[p(q[0],"CommonCommand")].concat(A),l=h=[p(P[0],"RerollDice")].concat(b),Q=_=[p(h[0],"Node")].concat(l),Ce=[le=d(_[0],null,"Command")].concat(Q),T=a.$r(Ce),(O=le.$$prototype).cmp_op=O.reroll_cmp_op=O.target_number_node=O.reroll_threshold_node=O.notations=O.source=w,v(le,"$initialize",function(j){var ve,de,Ee,ce,he,B,R,ie=this;if(null==j)j=M([],{});else if(!j.$$is_hash)throw a.ArgumentError.$new("expected kwargs");if(!a.hasOwnProperty.call(j.$$smap,"secret"))throw a.ArgumentError.$new("missing keyword: secret");if(ve=j.$$smap.secret,!a.hasOwnProperty.call(j.$$smap,"notations"))throw a.ArgumentError.$new("missing keyword: notations");if(de=j.$$smap.notations,!a.hasOwnProperty.call(j.$$smap,"source"))throw a.ArgumentError.$new("missing keyword: source");return Ee=j.$$smap.source,null==(ce=j.$$smap.cmp_op)&&(ce=w),null==(he=j.$$smap.target_number)&&(he=w),null==(B=j.$$smap.reroll_cmp_op)&&(B=w),null==(R=j.$$smap.reroll_threshold)&&(R=w),ie.secret=ve,ie.notations=de,ie.cmp_op=ce,ie.target_number_node=he,ie.reroll_cmp_op=B,ie.reroll_threshold_node=R,ie.source=Ee},1),v(le,"$eval",function(j,ve){var de,Ee,he,B,ie,me,$e,Ie,ce=this,R=w,W=w,_e=w,Pe=w,Ae=w,Ne=w,We=w,nt=w;return he=j.$round_type(),B=D(R=ce.cmp_op)?R:j.$default_cmp_op(),ie=D(R=D(W=ce.reroll_cmp_op)?W:B)?R:">=",me=D(R=(de=ce.target_number_node)===w||null==de?w:$(de,"eval",[he]))?R:j.$default_target_number(),$e=D(R=D(W=(Ee=ce.reroll_threshold_node)===w||null==Ee?w:$(Ee,"eval",[he]))?W:j.$reroll_dice_reroll_threshold())?R:me,_e=T("RerollCondition").$new(ie,$e),Ie=$(ce.notations,"map",[],function(jt){return null==jt&&(jt=w),jt.$to_dice(he)},1),D($(Ie,"all?",[],function(jt){return null==jt&&(jt=w),_e["$valid?"](jt.$sides())},1))?(Ae=(Pe=ce.$roll(Ie,ve,_e,j["$sort_barabara_dice?"]())).$flatten(),Ne=Pe.$take(ce.notations.$size()).$flatten().$count(1),We=D(B)?$(Ae,"count",[],function(jt){return null==jt&&(jt=w),jt.$send(B,me)},1):0,nt=[ce.$expr(he,_e,B,me),$(Pe,"map",[],function(jt){return null==jt&&(jt=w),jt.$join(",")},1).$join(" + "),"\u6210\u529f\u6570"+We,j.$grich_text(Ne,Ae.$size(),We)].$compact(),ce.$result_with_text(nt.$join(" \uff1e "))):ce.$result_with_text(ce.source+" \uff1e \u6761\u4ef6\u304c\u9593\u9055\u3063\u3066\u3044\u307e\u3059\u30022R6>=5 \u3042\u308b\u3044\u306f 2R6[5] \u306e\u3088\u3046\u306b\u632f\u308a\u8db3\u3057\u76ee\u6a19\u5024\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002")},2),le.$private(),v(le,"$roll",function(j,ve,de,Ee){var he=w,B=w,R=w,ie=w,W=w,me=w;for(he=[],B=0;D(D(R=j["$empty?"]()["$!"]())?F(B,T("REROLL_LIMIT")):R);)ie=j.$shift(),B=oe(B,1),W=ie.$roll(ve),D(Ee)&&W["$sort!"](),he.$push(W),me=$(W,"count",[],function(_e){return null==_e&&(_e=w),de["$reroll?"](_e)},1),D(G(me,0))&&j.$push(T("Dice").$new(me,ie.$sides()));return he},4),v(le,"$expr",function(j,ve,de,Ee){var he,B,R;return he=$(this.notations,"map",[],function(W){return null==W&&(W=w),W.$to_dice(j)},1).$join("+"),B=L(ve.$cmp_op(),de)?"":T("Format").$comparison_operator(ve.$cmp_op()),R=T("Format").$comparison_operator(de),"("+he+"["+B+ve.$threshold()+"]"+R+Ee+")"},4),v(le,"$result_with_text",function(j){return $(T("Result").$new(),"tap",[],function de(Ee){var ce=null==de.$$s?this:de.$$s,he=w;return null==ce.secret&&(ce.secret=w),null==Ee&&(Ee=w),$(Ee,"secret=",V(he=[ce.secret])),H(he.length,1),$(Ee,"text=",V(he=[j])),he[H(he.length,1)]},{$$arity:1,$$s:this})},1),function(x,S){var Q=d(x,null,"RerollCondition"),le=Q.$$prototype;le.threshold=le.cmp_op=w,Q.$attr_reader("cmp_op"),Q.$attr_reader("threshold"),v(Q,"$initialize",function(T,O){return this.cmp_op=T,this.threshold=O},2),v(Q,"$valid?",function(T){var O=this,re=w;return!!D(O.threshold)&&(se("<=",re=O.cmp_op)?F(O.threshold,T):se("<",re)?ue(O.threshold,T):se(">=",re)?G(O.threshold,1):se(">",re)?ee(O.threshold,1):!se("!=",re)||a.Range.$new(1,T,!1)["$include?"](O.threshold))},1),v(Q,"$reroll?",function(T){return T.$send(this.cmp_op,this.threshold)},1)}(_[0]),function(x,S,Q){var le=d(x,null,"Notation"),Ce=[le].concat(Q),T=a.$r(Ce),O=le.$$prototype;O.times=O.sides=w,v(le,"$initialize",function(j,ve){return this.times=j,this.sides=ve},2),v(le,"$to_dice",function(j){var de,Ee;return de=this.times.$eval(j),Ee=this.sides.$eval(j),T("Dice").$new(de,Ee)},1)}(_[0],0,_),function(x,S){var Q=d(x,null,"Dice");return Q.$attr_reader("times","sides"),v(Q,"$initialize",function(Ce,T){return this.times=Ce,this.sides=T},2),v(Q,"$roll",function(Ce){return Ce.$roll_barabara(this.$times(),this.$sides())},1),v(Q,"$to_s",function(){return this.$times()+"R"+this.$sides()},0)}(_[0])},Opal.modules["bcdice/arithmetic/node"]=function(a){var ue,k,N,u,l,g,b,z,Y,y=[],w=a.nil,p=a.$$$,d=a.module,M=a.klass,v=a.def,D=a.send2,$=a.find_super,F=a.eqeq,oe=a.const_set,G=a.eqeqeq,L=a.rb_divide,V=a.truthy,H=a.alias;return ue=y,k=Y=[d(y[0],"BCDice")].concat(ue),N=z=[d(Y[0],"Arithmetic")].concat(k),g=[d(z[0],"Node")].concat(N),b=a.$r(g),(l=(u=M(g[0],null,"BinaryOp")).$$prototype).lhs=l.rhs=l.op=w,v(u,"$initialize",function(_,x,S){var Q=this;return Q.lhs=_,Q.op=x,Q.rhs=S},3),v(u,"$eval",function(_){var Q,x=this,S=w;return S=x.lhs.$eval(_),Q=x.rhs.$eval(_),S.$send(x.op,Q)},1),v(u,"$output",function(){var _=this;return""+_.lhs.$output()+_.op+_.rhs.$output()},0),v(u,"$s_exp",function(){var _=this;return"("+_.$op_for_s_exp()+" "+_.lhs.$s_exp()+" "+_.rhs.$s_exp()+")"},0),v(u,"$op_for_s_exp",function(){return this.op},0),function(C,h,u){var l=M(C,h,"DivideBase"),f=[l].concat(u),_=a.$r(f),x=l.$$prototype;x.lhs=x.rhs=x.op=w,v(l,"$initialize",function S(Q,le){return delete S.$$p,D(this,$(this,"initialize",S,!1,!0),"initialize",[Q,"/",le],null)},2),v(l,"$eval",function(Q){var Ce,T;return Ce=this.lhs.$eval(Q),T=this.rhs.$eval(Q),F(T,0)&&this.$raise(_("ZeroDivisionError")),this.$divide_and_round(Ce,T,Q)},1),v(l,"$output",function S(){var Q=S.$$p||w;return delete S.$$p,""+D(this,$(this,"output",S,!1,!0),"output",[],Q)+this.$rounding_method()},0),l.$private(),v(l,"$rounding_method",function(){return p(this.$class(),"ROUNDING_METHOD")},0),v(l,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()},0),v(l,"$divide_and_round",function(Q,le,Ce){return this.$raise(_("NotImplementedError"))},3)}(g[0],b("BinaryOp"),g),function(C,h,u){var l=M(C,h,"DivideWithGameSystemDefault"),f=[l].concat(u),_=a.$r(f);oe(f[0],"ROUNDING_METHOD",""),l.$private(),v(l,"$divide_and_round",function(S,Q,le){var Ce,T=w;return G(p(_("RoundType"),"CEIL"),Ce=le)?L(S.$to_f(),Q).$ceil():G(p(_("RoundType"),"ROUND"),Ce)?(T=L(S.$to_f(),Q),V(T["$negative?"]())?T.$abs().$round()["$-@"]():T.$round()):L(S,Q).$floor()},3)}(g[0],b("DivideBase"),g),function(C,h,u){var l=M(C,h,"DivideWithCeil"),f=[l].concat(u);oe(f[0],"ROUNDING_METHOD","C"),l.$private(),v(l,"$divide_and_round",function(x,S,Q){return L(x.$to_f(),S).$ceil()},3)}(g[0],b("DivideBase"),g),function(C,h,u){var l=M(C,h,"DivideWithRound"),f=[l].concat(u);oe(f[0],"ROUNDING_METHOD","R"),l.$private(),v(l,"$divide_and_round",function(x,S,Q){var le=w;return le=L(x.$to_f(),S),V(le["$negative?"]())?le.$abs().$round()["$-@"]():le.$round()},3)}(g[0],b("DivideBase"),g),function(C,h,u){var l=M(C,h,"DivideWithFloor"),f=[l].concat(u);oe(f[0],"ROUNDING_METHOD","F"),l.$private(),v(l,"$divide_and_round",function(x,S,Q){return L(x,S).$floor()},3)}(g[0],b("DivideBase"),g),function(C,h){var u=M(C,null,"Negative");u.$$prototype.body=w,v(u,"$initialize",function(_){return this.body=_},1),v(u,"$eval",function(_){return this.body.$eval(_)["$-@"]()},1),v(u,"$output",function(){return"-"+this.body.$output()},0),v(u,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"},0)}(g[0]),function(C,h){var u=M(C,null,"Parenthesis");u.$$prototype.expr=w,v(u,"$initialize",function(_){return this.expr=_},1),v(u,"$eval",function(_){return this.expr.$eval(_)},1),v(u,"$output",function(){return"("+this.expr.$output()+")"},0),v(u,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"},0)}(g[0]),function(C,h){var u=M(C,null,"Number");return u.$$prototype.value=w,v(u,"$initialize",function(_){return this.value=_},1),v(u,"$eval",function(_){return this.value},1),v(u,"$output",function(){return this.value.$to_s()},0),H(u,"s_exp","output")}(g[0])},Opal.modules["bcdice/common_command/barabara_dice/parser"]=function(a){var se,ne,A,h,_,x,S,Q,le,Ce,T,O,re,de,u,l,f,P,g,q,ee,y=a.top,w=[],p=a.nil,d=a.$$$,M=a.module,v=a.klass,D=a.defs,$=a.def,F=a.hash,oe=a.const_set,G=a.hash2,L=a.to_ary,V=a.truthy;return y.$require("racc/parser.rb"),y.$require("bcdice/common_command/lexer"),y.$require("bcdice/common_command/reroll_dice/node"),y.$require("bcdice/arithmetic/node"),se=w,ne=ee=[M(w[0],"BCDice")].concat(se),A=q=[M(ee[0],"CommonCommand")].concat(ne),P=[M(q[0],"BarabaraDice")].concat(A),g=a.$r(P),h=P,l=[u=v(P[0],d(g("Racc"),"Parser"),"Parser")].concat(h),f=a.$r(l),u.$$prototype.lexer=p,D(u,"$parse",function(R){return this.$new().$parse(R)},1),$(u,"$parse",function(R){try{return this.lexer=f("Lexer").$new(R),this.$do_parse()}catch(W){if(!a.rescue(W,[f("ParseError")]))throw W;try{return p}finally{a.pop_exception()}}},1),u.$private(),$(u,"$next_token",function(){return this.lexer.$next_token()},0),_=[13,9,3,9,24,25,9,9,9,26,18,19,8,12,8,18,19,8,8,8,9,4,9,38,36,37,39,18,19,18,19,8,9,8,9,27,28,24,25,18,19,18,19,8,9,8,9,27,28,27,28,18,19,18,19,8,10,8,14],x=[5,2,0,8,15,15,13,14,12,15,8,8,2,5,8,12,12,13,14,12,18,1,19,34,34,34,34,18,18,19,19,18,24,19,25,16,16,21,21,24,24,25,25,24,27,25,28,31,31,32,32,27,27,28,28,27,4,28,7],S=[-6,21,-1,p,56,-9,p,55,1,p,p,p,6,4,5,-5,24,p,18,20,p,28,p,p,30,32,p,42,44,p,p,36,38,p,19,p,p,p,p,p],Q=[-2,-25,-25,-3,-25,-4,-7,-25,-25,-24,40,-1,-25,-25,-25,-25,-11,-14,-25,-25,-22,-5,-6,-8,-25,-25,-23,-25,-25,-20,-21,-9,-10,-12,-15,-13,-16,-17,-18,-19],le=[7,1,6,15,2,29,30,21,31,32,5,7,23,22,33,34,11,35],Ce=[7,1,6,5,2,9,9,5,8,8,3,7,7,6,9,9,4,10],T=[p,1,4,8,11,-5,0,-2,-16,-13,-17],O=[p,p,p,p,p,p,p,20,16,17,p],re=[0,0,"racc_error",3,24,"_reduce_1",0,25,"_reduce_2",1,25,"_reduce_3",0,27,"_reduce_4",2,27,"_reduce_5",3,26,"_reduce_6",1,26,"_reduce_7",3,29,"_reduce_8",3,28,"_reduce_9",3,28,"_reduce_10",1,28,"_reduce_none",3,31,"_reduce_12",4,31,"_reduce_13",1,31,"_reduce_none",0,33,"_reduce_15",1,33,"_reduce_16",1,33,"_reduce_17",1,33,"_reduce_18",1,33,"_reduce_19",2,32,"_reduce_20",2,32,"_reduce_21",1,32,"_reduce_none",3,30,"_reduce_23",1,30,"_reduce_24"],de=F(!1,0,"error",1,"NUMBER",2,"B",3,"R",4,"U",5,"C",6,"F",7,"S",8,"PLUS",9,"MINUS",10,"ASTERISK",11,"SLASH",12,"PARENL",13,"PARENR",14,"BRACKETL",15,"BRACKETR",16,"LESS",17,"GREATER",18,"EQUAL",19,"NOT",20,"AT",21,"CMP_OP",22),oe(l[0],"Racc_arg",[_,x,Q,S,le,Ce,O,T,23,re,de,40,25,!0]),oe(l[0],"Racc_token_to_s_table",["$end","error","NUMBER","B","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","LESS","GREATER","EQUAL","NOT","AT","CMP_OP","$start","expr","secret","notations","target","add","dice","term","mul","unary","round_type"]),oe(l[0],"Racc_debug_parser",!1),$(u,"$_reduce_1",function(R,ie,W){return d(f("Node"),"Command").$new(G(["secret","notations","cmp_op","target_number"],{secret:R["$[]"](0),notations:R["$[]"](1),cmp_op:R["$[]"](2)["$[]"]("cmp_op"),target_number:R["$[]"](2)["$[]"]("target")}))},3),$(u,"$_reduce_2",function(R,ie,W){return!1},3),$(u,"$_reduce_3",function(R,ie,W){return!0},3),$(u,"$_reduce_4",function(R,ie,W){return G([],{})},3),$(u,"$_reduce_5",function(R,ie,W){var me,Ie,Pe;return Pe=null==(me=L(R))[1]?p:me[1],V(Ie=null==me[0]?p:me[0])||this.$raise(f("ParseError")),G(["cmp_op","target"],{cmp_op:Ie,target:Pe})},3),$(u,"$_reduce_6",function(R,ie,W){var me=p;return(me=R["$[]"](0)).$push(R["$[]"](2)),me},3),$(u,"$_reduce_7",function(R,ie,W){return[R["$[]"](0)]},3),$(u,"$_reduce_8",function(R,ie,W){var me,$e;return me=R["$[]"](0),$e=R["$[]"](2),d(f("Node"),"Notation").$new(me,$e)},3),$(u,"$_reduce_9",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"BinaryOp").$new(R["$[]"](0),"+",R["$[]"](2))},3),$(u,"$_reduce_10",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"BinaryOp").$new(R["$[]"](0),"-",R["$[]"](2))},3),$(u,"$_reduce_12",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"BinaryOp").$new(R["$[]"](0),"*",R["$[]"](2))},3),$(u,"$_reduce_13",function(R,ie,W){return R["$[]"](3).$new(R["$[]"](0),R["$[]"](2))},3),$(u,"$_reduce_15",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),$(u,"$_reduce_16",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"DivideWithCeil")},3),$(u,"$_reduce_17",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"DivideWithCeil")},3),$(u,"$_reduce_18",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"DivideWithRound")},3),$(u,"$_reduce_19",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"DivideWithFloor")},3),$(u,"$_reduce_20",function(R,ie,W){return R["$[]"](1)},3),$(u,"$_reduce_21",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"Negative").$new(R["$[]"](1))},3),$(u,"$_reduce_23",function(R,ie,W){return R["$[]"](1)},3),$(u,"$_reduce_24",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"Number").$new(R["$[]"](0))},3),$(u,"$_reduce_none",function(R,ie,W){return R["$[]"](0)},3)},Opal.modules["bcdice/common_command/barabara_dice"]=function(a){var F,V,ee,k,z,A,Y,ne,se,G,w=[],p=a.nil,d=a.module,M=a.const_set,v=a.send,D=a.def;return a.top.$require("bcdice/common_command/barabara_dice/parser"),F=w,V=G=[d(w[0],"BCDice")].concat(F),ee=se=[d(G[0],"CommonCommand")].concat(V),M((ne=[Y=d(se[0],"BarabaraDice")].concat(ee))[0],"PREFIX_PATTERN",/\d+B\d+/.$freeze()),z=[k=a.get_singleton_class(Y)].concat(ne),A=a.$r(z),D(k,"$eval",function(P,g,b){var C;return(C=A("Parser").$parse(P))===p||null==C?p:v(C,"eval",[g,b])},3)},Opal.modules["bcdice/result"]=function(a){var oe,se,ne,ue,Y,L,y=[],w=a.nil,d=a.klass,M=a.send,v=a.to_a,D=a.rb_minus,$=a.def;return oe=y,se=L=[(0,a.module)(y[0],"BCDice")].concat(oe),[ue=d(L[0],null,"Result")].concat(se),(Y=ue.$$prototype).secret=Y.success=Y.failure=Y.critical=Y.fumble=w,$(ne=a.get_singleton_class(ue),"$success",function(z){return M(this.$new(),"tap",[],function(P){var g=w;return null==P&&(P=w),M(P,"text=",v(g=[z])),D(g.length,1),M(P,"success=",v(g=[!0])),g[D(g.length,1)]},1)},1),$(ne,"$failure",function(z){return M(this.$new(),"tap",[],function(P){var g=w;return null==P&&(P=w),M(P,"text=",v(g=[z])),D(g.length,1),M(P,"failure=",v(g=[!0])),g[D(g.length,1)]},1)},1),$(ne,"$critical",function(z){return M(this.$new(),"tap",[],function(P){var g=w;return null==P&&(P=w),M(P,"text=",v(g=[z])),D(g.length,1),M(P,"critical=",v(g=[!0])),D(g.length,1),M(P,"success=",v(g=[!0])),g[D(g.length,1)]},1)},1),$(ne,"$fumble",function(z){return M(this.$new(),"tap",[],function(P){var g=w;return null==P&&(P=w),M(P,"text=",v(g=[z])),D(g.length,1),M(P,"fumble=",v(g=[!0])),D(g.length,1),M(P,"failure=",v(g=[!0])),g[D(g.length,1)]},1)},1),$(ne,"$nothing",function(){return"nothing"},0),$(ue,"$initialize",function(k){var q=this;return null==k&&(k=w),q.text=k,q.rands=w,q.detailed_rands=w,q.secret=!1,q.success=!1,q.failure=!1,q.critical=!1,q.fumble=!1},-1),ue.$attr_accessor("text","rands","detailed_rands"),ue.$attr_writer("secret","success","failure","critical","fumble"),$(ue,"$secret?",function(){return this.secret},0),$(ue,"$success?",function(){return this.success},0),$(ue,"$failure?",function(){return this.failure},0),$(ue,"$critical?",function(){return this.critical},0),$(ue,"$fumble?",function(){return this.fumble},0),$(ue,"$condition=",function(k){return this.success=k,this.failure=k["$!"]()},1)},Opal.modules["bcdice/common_command/tally_dice/node"]=function(a){var Y,z,g,u,S,Q,le,Ce,f,C,N,k,w=[],p=a.nil,d=a.module,M=a.klass,v=a.const_set,D=a.hash2,$=a.def,F=a.truthy,oe=a.rb_gt,G=a.send,L=a.not,V=a.eqeq,H=a.to_a,se=a.rb_minus,ue=a.alias;return a.top.$require("bcdice/result"),Y=w,z=k=[d(w[0],"BCDice")].concat(Y),g=N=[d(k[0],"CommonCommand")].concat(z),u=C=[d(N[0],"TallyDice")].concat(g),S=f=[d(C[0],"Node")].concat(u),le=[Q=M(f[0],null,"Command")].concat(S),Ce=a.$r(le),Q.$$prototype.notation=p,v(le[0],"MAX_SIDES",20),$(Q,"$initialize",function(re){var j,ve;if(null==re)re=D([],{});else if(!re.$$is_hash)throw a.ArgumentError.$new("expected kwargs");if(!a.hasOwnProperty.call(re.$$smap,"secret"))throw a.ArgumentError.$new("missing keyword: secret");if(j=re.$$smap.secret,!a.hasOwnProperty.call(re.$$smap,"notation"))throw a.ArgumentError.$new("missing keyword: notation");return ve=re.$$smap.notation,this.secret=j,this.notation=ve},1),$(Q,"$eval",function(re,j){var de=p,Ee=p,ce=p,he=p,B=p,R=p;return de=this.notation.$to_dice(re.$round_type()),F(de["$valid?"]())?F(oe(de.$sides(),Ce("MAX_SIDES")))?Ce("Result").$new("("+de+") \uff1e \u9762\u6570\u306f1\u4ee5\u4e0a\u3001"+Ce("MAX_SIDES")+"\u4ee5\u4e0b\u3068\u3057\u3066\u304f\u3060\u3055\u3044"):(Ee=de.$roll(j),ce=(F(re["$sort_barabara_dice?"]())?Ee.$sort():Ee).$join(","),he=G(G(Ee,"group_by",[],"itself".$to_proc()),"transform_values",[],"length".$to_proc()),B=G(a.Range.$new(1,de.$sides(),!1),"map",[],function(W){var me;return null==W&&(W=p),me=he.$fetch(W,0),V(me,0)&&L(de["$show_zeros?"]())?p:"["+W+"]\xd7"+he.$fetch(W,0)},1),R=["("+de+")",ce,B.$compact().$join(", ")].$compact(),G(Ce("Result").$new(),"tap",[],function ie(W){var me=null==ie.$$s?this:ie.$$s,$e=p;return null==me.secret&&(me.secret=p),null==W&&(W=p),G(W,"secret=",H($e=[me.secret])),se($e.length,1),$e=[R.$join(" \uff1e ")],G(W,"text=",H($e)),$e[se($e.length,1)]},{$$arity:1,$$s:this})):p},2),function(_,x,S){var Q=M(_,null,"Notation"),le=[Q].concat(S),Ce=a.$r(le),T=Q.$$prototype;T.times=T.sides=T.show_zeros=p,Q.$attr_reader("times"),Q.$attr_reader("sides"),Q.$attr_reader("show_zeros"),$(Q,"$initialize",function(re){var j,ve,de;if(null==re)re=D([],{});else if(!re.$$is_hash)throw a.ArgumentError.$new("expected kwargs");if(!a.hasOwnProperty.call(re.$$smap,"times"))throw a.ArgumentError.$new("missing keyword: times");if(j=re.$$smap.times,!a.hasOwnProperty.call(re.$$smap,"sides"))throw a.ArgumentError.$new("missing keyword: sides");if(ve=re.$$smap.sides,!a.hasOwnProperty.call(re.$$smap,"show_zeros"))throw a.ArgumentError.$new("missing keyword: show_zeros");return de=re.$$smap.show_zeros,this.times=j,this.sides=ve,this.show_zeros=de},1),$(Q,"$to_dice",function(re){var ve,de,j=this;return ve=j.times.$eval(re),de=j.sides.$eval(re),Ce("Dice").$new(D(["times","sides","show_zeros"],{times:ve,sides:de,show_zeros:j.show_zeros}))},1)}(f[0],0,f),function(_,x){var S=M(_,null,"Dice"),Q=S.$$prototype;return Q.times=Q.sides=Q.show_zeros=p,S.$attr_reader("times"),S.$attr_reader("sides"),S.$attr_reader("show_zeros"),ue(S,"show_zeros?","show_zeros"),$(S,"$initialize",function(Ce){var T,O,re,j=this;if(null==Ce)Ce=D([],{});else if(!Ce.$$is_hash)throw a.ArgumentError.$new("expected kwargs");if(!a.hasOwnProperty.call(Ce.$$smap,"times"))throw a.ArgumentError.$new("missing keyword: times");if(T=Ce.$$smap.times,!a.hasOwnProperty.call(Ce.$$smap,"sides"))throw a.ArgumentError.$new("missing keyword: sides");if(O=Ce.$$smap.sides,!a.hasOwnProperty.call(Ce.$$smap,"show_zeros"))throw a.ArgumentError.$new("missing keyword: show_zeros");return re=Ce.$$smap.show_zeros,j.times=T,j.sides=O,j.show_zeros=re},1),$(S,"$valid?",function(){var T;return F(T=oe(this.times,0))?oe(this.sides,0):T},0),$(S,"$roll",function(Ce){return Ce.$roll_barabara(this.times,this.sides)},1),$(S,"$to_s",function(){var T;return T=F(this.show_zeros)?"Z":"Y",this.times+"T"+T+this.sides},0)}(f[0])},Opal.modules["bcdice/common_command/tally_dice/parser"]=function(a){var V,ee,q,b,l,f,_,x,S,Q,le,Ce,T,j,C,h,u,A,N,ne,se,y=a.top,w=[],p=a.nil,d=a.$$$,M=a.module,v=a.klass,D=a.defs,$=a.def,F=a.hash,oe=a.const_set,G=a.hash2;return y.$require("racc/parser.rb"),y.$require("bcdice/common_command/lexer"),y.$require("bcdice/common_command/tally_dice/node"),y.$require("bcdice/arithmetic/node"),V=w,ee=se=[M(w[0],"BCDice")].concat(V),q=ne=[M(se[0],"CommonCommand")].concat(ee),A=[M(ne[0],"TallyDice")].concat(q),N=a.$r(A),b=A,h=[C=v(A[0],d(N("Racc"),"Parser"),"Parser")].concat(b),u=a.$r(h),C.$$prototype.lexer=p,D(C,"$parse",function(he){return this.$new().$parse(he)},1),$(C,"$parse",function(he){try{return this.lexer=u("Lexer").$new(he),this.$do_parse()}catch(R){if(!a.rescue(R,[u("ParseError")]))throw R;try{return p}finally{a.pop_exception()}}},1),C.$private(),$(C,"$next_token",function(){return this.lexer.$next_token()},0),l=[8,8,18,19,20,21,8,8,8,22,14,15,3,7,7,14,15,14,15,7,7,7,8,4,8,35,33,34,36,8,9,14,15,14,15,7,8,7,14,15,23,24,7,23,24,14,15,23,24,7,10],f=[2,7,10,10,11,11,14,17,15,11,7,7,0,2,7,14,14,15,15,14,17,15,20,1,21,31,31,31,31,23,4,20,20,21,21,20,24,21,23,23,12,12,23,28,28,24,24,29,29,24,6],_=[2,23,-2,p,30,p,47,-1,p,p,-2,-7,27,p,4,6,p,5,p,p,20,22,p,27,34,p,p,p,30,34,p,19,p,p,p,p,p],x=[-2,-23,-23,-3,-23,-1,-23,-23,-22,37,-23,-23,-9,-12,-23,-23,-20,-23,-5,-6,-23,-23,-21,-23,-23,-18,-19,-4,-7,-8,-10,-13,-11,-14,-15,-16,-17],S=[6,25,26,12,1,2,5,17,11,32,30,31,p,p,p,27,28,29],Q=[4,8,8,7,1,2,3,5,6,9,8,8,p,p,p,4,7,7],le=[p,4,5,4,-2,-3,1,-4,-13,-22],Ce=[p,p,p,p,16,p,p,p,13,p],T=[0,0,"racc_error",2,18,"_reduce_1",0,19,"_reduce_2",1,19,"_reduce_3",4,20,"_reduce_4",1,22,"_reduce_5",1,22,"_reduce_6",3,23,"_reduce_7",3,23,"_reduce_8",1,23,"_reduce_none",3,24,"_reduce_10",4,24,"_reduce_11",1,24,"_reduce_none",0,26,"_reduce_13",1,26,"_reduce_14",1,26,"_reduce_15",1,26,"_reduce_16",1,26,"_reduce_17",2,25,"_reduce_18",2,25,"_reduce_19",1,25,"_reduce_none",3,21,"_reduce_21",1,21,"_reduce_22"],j=F(!1,0,"error",1,"NUMBER",2,"T",3,"Y",4,"Z",5,"R",6,"U",7,"C",8,"F",9,"S",10,"PLUS",11,"MINUS",12,"ASTERISK",13,"SLASH",14,"PARENL",15,"PARENR",16),oe(h[0],"Racc_arg",[l,f,x,_,S,Q,Ce,le,17,T,j,37,23,!0]),oe(h[0],"Racc_token_to_s_table",["$end","error","NUMBER","T","Y","Z","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","$start","expr","secret","notation","term","show_zeros","add","mul","unary","round_type"]),oe(h[0],"Racc_debug_parser",!1),$(C,"$_reduce_1",function(he,B,R){return d(u("Node"),"Command").$new(G(["secret","notation"],{secret:he["$[]"](0),notation:he["$[]"](1)}))},3),$(C,"$_reduce_2",function(he,B,R){return!1},3),$(C,"$_reduce_3",function(he,B,R){return!0},3),$(C,"$_reduce_4",function(he,B,R){return d(u("Node"),"Notation").$new(G(["times","sides","show_zeros"],{times:he["$[]"](0),sides:he["$[]"](3),show_zeros:he["$[]"](2)}))},3),$(C,"$_reduce_5",function(he,B,R){return!1},3),$(C,"$_reduce_6",function(he,B,R){return!0},3),$(C,"$_reduce_7",function(he,B,R){return d(d(u("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"+",he["$[]"](2))},3),$(C,"$_reduce_8",function(he,B,R){return d(d(u("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"-",he["$[]"](2))},3),$(C,"$_reduce_10",function(he,B,R){return d(d(u("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"*",he["$[]"](2))},3),$(C,"$_reduce_11",function(he,B,R){return he["$[]"](3).$new(he["$[]"](0),he["$[]"](2))},3),$(C,"$_reduce_13",function(he,B,R){return d(d(u("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),$(C,"$_reduce_14",function(he,B,R){return d(d(u("Arithmetic"),"Node"),"DivideWithCeil")},3),$(C,"$_reduce_15",function(he,B,R){return d(d(u("Arithmetic"),"Node"),"DivideWithCeil")},3),$(C,"$_reduce_16",function(he,B,R){return d(d(u("Arithmetic"),"Node"),"DivideWithRound")},3),$(C,"$_reduce_17",function(he,B,R){return d(d(u("Arithmetic"),"Node"),"DivideWithFloor")},3),$(C,"$_reduce_18",function(he,B,R){return he["$[]"](1)},3),$(C,"$_reduce_19",function(he,B,R){return d(d(u("Arithmetic"),"Node"),"Negative").$new(he["$[]"](1))},3),$(C,"$_reduce_21",function(he,B,R){return he["$[]"](1)},3),$(C,"$_reduce_22",function(he,B,R){return d(d(u("Arithmetic"),"Node"),"Number").$new(he["$[]"](0))},3),$(C,"$_reduce_none",function(he,B,R){return he["$[]"](0)},3)},Opal.modules["bcdice/common_command/tally_dice"]=function(a){var F,V,ee,k,z,A,Y,ne,se,G,w=[],p=a.nil,d=a.module,M=a.const_set,v=a.send,D=a.def;return a.top.$require("bcdice/common_command/tally_dice/parser"),F=w,V=G=[d(w[0],"BCDice")].concat(F),ee=se=[d(G[0],"CommonCommand")].concat(V),M((ne=[Y=d(se[0],"TallyDice")].concat(ee))[0],"PREFIX_PATTERN",/\d+T[YZ]\d+/.$freeze()),z=[k=a.get_singleton_class(Y)].concat(ne),A=a.$r(z),D(k,"$eval",function(P,g,b){var C;return(C=A("Parser").$parse(P))===p||null==C?p:v(C,"eval",[g,b])},3)},Opal.modules["bcdice/common_command/calc/node"]=function(a){var H,Y,z,g,l,f,_,x,C,N,k,ue,w=[],p=a.nil,d=a.$$$,M=a.module,v=a.klass,D=a.hash2,$=a.def,F=a.truthy,oe=a.send,G=a.to_a,L=a.rb_minus;return a.top.$require("bcdice/arithmetic/node"),H=w,Y=ue=[M(w[0],"BCDice")].concat(H),z=k=[M(ue[0],"CommonCommand")].concat(Y),g=N=[M(k[0],"Calc")].concat(z),l=C=[M(N[0],"Node")].concat(g),_=[f=v(C[0],null,"Command")].concat(l),x=a.$r(_),f.$$prototype.expr=p,$(f,"$initialize",function(le){var Ce,T;if(null==le)le=D([],{});else if(!le.$$is_hash)throw a.ArgumentError.$new("expected kwargs");if(!a.hasOwnProperty.call(le.$$smap,"secret"))throw a.ArgumentError.$new("missing keyword: secret");if(Ce=le.$$smap.secret,!a.hasOwnProperty.call(le.$$smap,"expr"))throw a.ArgumentError.$new("missing keyword: expr");return T=le.$$smap.expr,this.secret=Ce,this.expr=T},1),$(f,"$eval",function(le){var T,O,Ce=this;return T=function(){try{return Ce.expr.$eval(le).$to_i()}catch(re){if(!a.rescue(re,[x("ZeroDivisionError")]))throw re;try{return"\u30bc\u30ed\u9664\u7b97\u304c\u767a\u751f\u3057\u305f\u305f\u3081\u8a08\u7b97\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f"}finally{a.pop_exception()}}}(),O=F(Ce.expr["$is_a?"](d(d(x("Arithmetic"),"Node"),"Parenthesis")))?Ce.expr.$output():"("+Ce.expr.$output()+")",oe(x("Result").$new(),"tap",[],function re(j){var ve=null==re.$$s?this:re.$$s,de=p;return null==ve.secret&&(ve.secret=p),null==j&&(j=p),oe(j,"secret=",G(de=[ve.secret])),L(de.length,1),oe(j,"text=",G(de=["c"+O+" \uff1e "+T])),de[L(de.length,1)]},{$$arity:1,$$s:Ce})},1)},Opal.modules["bcdice/common_command/calc/parser"]=function(a){var V,ee,q,b,l,f,_,x,S,Q,le,Ce,T,j,C,h,u,A,N,ne,se,y=a.top,w=[],p=a.nil,d=a.$$$,M=a.module,v=a.klass,D=a.defs,$=a.def,F=a.hash,oe=a.const_set,G=a.hash2;return y.$require("racc/parser.rb"),y.$require("bcdice/common_command/lexer"),y.$require("bcdice/common_command/calc/node"),y.$require("bcdice/arithmetic/node"),V=w,ee=se=[M(w[0],"BCDice")].concat(V),q=ne=[M(se[0],"CommonCommand")].concat(ee),A=[M(ne[0],"Calc")].concat(q),N=a.$r(A),b=A,h=[C=v(A[0],d(N("Racc"),"Parser"),"Parser")].concat(b),u=a.$r(h),C.$$prototype.lexer=p,D(C,"$parse",function(he){return this.$new().$parse(he)},1),$(C,"$parse",function(he){try{return this.lexer=u("Lexer").$new(he),this.$do_parse()}catch(R){if(!a.rescue(R,[u("ParseError")]))throw R;try{return p}finally{a.pop_exception()}}},1),C.$private(),$(C,"$next_token",function(){return this.lexer.$next_token()},0),l=[14,3,14,15,16,4,10,11,10,11,13,14,13,14,17,18,5,10,11,10,11,13,14,13,14,17,18,6,10,11,10,11,13,14,13,14,17,18,p,10,11,10,11,13,p,13,15,16,p,p,p,26,30,28,29,31],f=[5,0,10,7,7,1,5,5,10,10,5,11,10,13,8,8,2,11,11,13,13,11,15,13,16,22,22,4,15,15,16,16,15,17,16,18,23,23,p,17,17,18,18,17,p,18,21,21,p,p,p,21,25,25,25,25],_=[-6,5,11,p,27,-2,p,-5,4,p,0,9,p,11,p,20,22,31,33,p,p,38,15,26,p,49,p,p,p,p,p,p],x=[-2,-20,-20,-3,-20,-20,32,-1,-6,-9,-20,-20,-17,-20,-19,-20,-20,-20,-20,-15,-16,-20,-4,-5,-7,-10,-18,-8,-11,-12,-13,-14],S=[7,1,19,20,22,23,2,27,21,24,25],Q=[3,1,5,5,4,4,2,6,3,5,5],le=[p,1,6,-5,-11,-8,-18,p],Ce=[p,p,p,p,8,9,p,12],T=[0,0,"racc_error",3,15,"_reduce_1",0,16,"_reduce_2",1,16,"_reduce_3",3,17,"_reduce_4",3,17,"_reduce_5",1,17,"_reduce_none",3,18,"_reduce_7",4,18,"_reduce_8",1,18,"_reduce_none",0,20,"_reduce_10",1,20,"_reduce_11",1,20,"_reduce_12",1,20,"_reduce_13",1,20,"_reduce_14",2,19,"_reduce_15",2,19,"_reduce_16",1,19,"_reduce_none",3,21,"_reduce_18",1,21,"_reduce_19"],j=F(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"S",7,"PLUS",8,"MINUS",9,"ASTERISK",10,"SLASH",11,"PARENL",12,"PARENR",13),oe(h[0],"Racc_arg",[l,f,x,_,S,Q,Ce,le,14,T,j,32,20,!0]),oe(h[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","$start","expr","secret","add","mul","unary","round_type","term"]),oe(h[0],"Racc_debug_parser",!1),$(C,"$_reduce_1",function(he,B,R){return d(u("Node"),"Command").$new(G(["secret","expr"],{secret:he["$[]"](0),expr:he["$[]"](2)}))},3),$(C,"$_reduce_2",function(he,B,R){return!1},3),$(C,"$_reduce_3",function(he,B,R){return!0},3),$(C,"$_reduce_4",function(he,B,R){return d(d(u("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"+",he["$[]"](2))},3),$(C,"$_reduce_5",function(he,B,R){return d(d(u("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"-",he["$[]"](2))},3),$(C,"$_reduce_7",function(he,B,R){return d(d(u("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"*",he["$[]"](2))},3),$(C,"$_reduce_8",function(he,B,R){return he["$[]"](3).$new(he["$[]"](0),he["$[]"](2))},3),$(C,"$_reduce_10",function(he,B,R){return d(d(u("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),$(C,"$_reduce_11",function(he,B,R){return d(d(u("Arithmetic"),"Node"),"DivideWithCeil")},3),$(C,"$_reduce_12",function(he,B,R){return d(d(u("Arithmetic"),"Node"),"DivideWithCeil")},3),$(C,"$_reduce_13",function(he,B,R){return d(d(u("Arithmetic"),"Node"),"DivideWithRound")},3),$(C,"$_reduce_14",function(he,B,R){return d(d(u("Arithmetic"),"Node"),"DivideWithFloor")},3),$(C,"$_reduce_15",function(he,B,R){return he["$[]"](1)},3),$(C,"$_reduce_16",function(he,B,R){return d(d(u("Arithmetic"),"Node"),"Negative").$new(he["$[]"](1))},3),$(C,"$_reduce_18",function(he,B,R){return d(d(u("Arithmetic"),"Node"),"Parenthesis").$new(he["$[]"](1))},3),$(C,"$_reduce_19",function(he,B,R){return d(d(u("Arithmetic"),"Node"),"Number").$new(he["$[]"](0))},3),$(C,"$_reduce_none",function(he,B,R){return he["$[]"](0)},3)},Opal.modules["bcdice/common_command/calc"]=function(a){var F,V,ee,k,z,A,Y,ne,se,G,w=[],p=a.nil,d=a.module,M=a.const_set,v=a.send,D=a.def;return a.top.$require("bcdice/common_command/calc/parser"),F=w,V=G=[d(w[0],"BCDice")].concat(F),ee=se=[d(G[0],"CommonCommand")].concat(V),M((ne=[Y=d(se[0],"Calc")].concat(ee))[0],"PREFIX_PATTERN",/C[+\-(]*\d+/.$freeze()),z=[k=a.get_singleton_class(Y)].concat(ne),A=a.$r(z),D(k,"$eval",function(P,g,b){var C;return(C=A("Parser").$parse(P))===p||null==C?p:v(C,"eval",[g.$round_type()])},3)},Opal.modules["bcdice/common_command/choice"]=function(a){var ne,A,C,x,Q,h,u,l,f,P,q,w=[],p=a.nil,d=a.$$$,M=a.module,v=a.klass,D=a.const_set,$=a.hash2,F=a.send,oe=a.def,G=a.truthy,L=a.eqeq,V=a.eqeqeq,H=a.rb_lt,se=a.rb_gt,ue=a.to_a,ee=a.rb_minus;return a.top.$require("strscan"),ne=w,A=q=[M(w[0],"BCDice")].concat(ne),C=P=[M(q[0],"CommonCommand")].concat(A),u=[h=v(P[0],null,"Choice")].concat(C),l=a.$r(u),(f=h.$$prototype).items=f.takes=f.block_delimiter=p,D(u[0],"PREFIX_PATTERN",/choice/.$freeze()),x=u,D((Q=[M(u[0],"BlockDelimiter")].concat(x))[0],"BRACKET","bracket"),D(Q[0],"PAREN","paren"),D(Q[0],"SPACE","space"),D(u[0],"DELIMITER",$(["bracket","paren","space"],{bracket:/,/,paren:/,/,space:/\s+/}).$freeze()),D(u[0],"DELIMITER_CHAR",$(["bracket","paren","space"],{bracket:", ",paren:", ",space:" "}).$freeze()),D(u[0],"TERMINATION",$(["bracket","paren","space"],{bracket:/\]/,paren:/\)/,space:/$/}).$freeze()),D(u[0],"SUFFIX",$(["bracket","paren","space"],{bracket:"]",paren:")",space:""}).$freeze()),function(_,x){var S=[_].concat(x),Q=a.$r(S);oe(_,"$eval",function(Ce,T,O){var re;return(re=this.$parse(Ce))===p||null==re?p:F(re,"roll",[O])},3),_.$private(),oe(_,"$parse",function(Ce){var T,ve,ce,he,B,j=p,de=p,Ee=p,R=p,ie=p,W=p;if((j=Q("StringScanner").$new(Ce)).$skip(/\s+/),ve=j.$scan(/S/i)["$nil?"]()["$!"](),!G(j.$scan(/choice/i))||(de=G(Ee=(T=j.$scan(/\d+/))===p||null==T?p:F(T,"to_i",[]))?Ee:1,L(de,0)))return p;for(ce=V("[",Ee=j.$scan(/\(|\[|\s+/))?d(Q("BlockDelimiter"),"BRACKET"):V("(",Ee)?d(Q("BlockDelimiter"),"PAREN"):V(Q("String"),Ee)?d(Q("BlockDelimiter"),"SPACE"):p,he=Q("DELIMITER")["$[]"](ce),B=Q("TERMINATION")["$[]"](ce),R=[];G(ie=j.$scan_until(he));)R.$push(ie.$delete_suffix(","));return W=j.$scan_until(B),!G(W)||(R.$push(W.$delete_suffix(Q("SUFFIX")["$[]"](ce))),R=F(F(R,"map",[],"strip".$to_proc()),"reject",[],"empty?".$to_proc()),L(R.$size(),1)&&(R=this.$parse_multi_item_shorthand(R.$first())),G(R["$empty?"]())||G(H(R.$size(),de)))?p:this.$new($(["secret","block_delimiter","takes","items"],{secret:ve,block_delimiter:ce,takes:de,items:R}))},1),oe(_,"$parse_multi_item_shorthand",function(Ce){var O,re;return G(O=G(re=this.$parse_multi_nums_shorthand(Ce))?re:this.$parse_multi_chars_shorthand(Ce))?O:[]},1),oe(_,"$parse_multi_nums_shorthand",function(Ce){var T=p,O=p,re=p;return T=/^(\d+)-(\d+)$/.$match(Ce),!G(T)||(O=T["$[]"](1).$to_i(),re=T["$[]"](2).$to_i(),G(se(O,re)))?p:O.$upto(re).$to_a()},1),oe(_,"$parse_multi_chars_shorthand",function(Ce){var O,T=p,re=p,j=p;return T=G(O=/^([a-z])-([a-z])$/.$match(Ce))?O:/^([A-Z])-([A-Z])$/.$match(Ce),!G(T)||(re=T["$[]"](1),j=T["$[]"](2),G(se(re,j)))?p:re.$upto(j).$to_a()},1)}(a.get_singleton_class(h),u),oe(h,"$initialize",function(x){var S,Q,le,Ce,T=this;if(null==x)x=$([],{});else if(!x.$$is_hash)throw a.ArgumentError.$new("expected kwargs");if(!a.hasOwnProperty.call(x.$$smap,"secret"))throw a.ArgumentError.$new("missing keyword: secret");if(S=x.$$smap.secret,!a.hasOwnProperty.call(x.$$smap,"block_delimiter"))throw a.ArgumentError.$new("missing keyword: block_delimiter");if(Q=x.$$smap.block_delimiter,!a.hasOwnProperty.call(x.$$smap,"takes"))throw a.ArgumentError.$new("missing keyword: takes");if(le=x.$$smap.takes,!a.hasOwnProperty.call(x.$$smap,"items"))throw a.ArgumentError.$new("missing keyword: items");return Ce=x.$$smap.items,T.secret=S,T.block_delimiter=Q,T.takes=le,T.items=Ce},1),oe(h,"$roll",function(x){var S=this,Q=p,le=p;return G(se(S.items.$size(),100))?l("Result").$new("\u9805\u76ee\u6570\u306f100\u4ee5\u4e0b\u3068\u3057\u3066\u304f\u3060\u3055\u3044"):(Q=S.items.$dup(),le=[],F(S.takes,"times",[],function(){var T;return T=x.$roll_index(Q.$size()),le["$<<"](Q.$delete_at(T))},0),F(l("Result").$new(),"tap",[],function Ce(T){var re,O=null==Ce.$$s?this:Ce.$$s,j=p;return null==O.block_delimiter&&(O.block_delimiter=p),null==O.secret&&(O.secret=p),null==T&&(T=p),re=le.$join(l("DELIMITER_CHAR")["$[]"](O.block_delimiter)),F(T,"secret=",ue(j=[O.secret])),ee(j.length,1),j=["("+O.$expr()+") \uff1e "+re],F(T,"text=",ue(j)),j[ee(j.length,1)]},{$$arity:1,$$s:S}))},1),oe(h,"$expr",function(){var S,Q,x=this;return S=L(x.takes,1)?p:x.takes,V(d(l("BlockDelimiter"),"SPACE"),Q=x.block_delimiter)?"choice"+S+" "+x.items.$join(" "):V(d(l("BlockDelimiter"),"BRACKET"),Q)?"choice"+S+"["+x.items.$join(",")+"]":V(d(l("BlockDelimiter"),"PAREN"),Q)?"choice"+S+"("+x.items.$join(",")+")":p},0)},Opal.modules["bcdice/common_command/d66_dice"]=function(a){var ee,q,g,l,_,x,b,C,h,A,ne,y=[],w=a.nil,p=a.$$$,d=a.module,M=a.klass,v=a.const_set,D=a.send,$=a.def,F=a.truthy,oe=a.hash2,G=a.eqeqeq,L=a.to_a,V=a.rb_minus,H=a.rb_plus,se=a.rb_times;return ee=y,q=ne=[d(y[0],"BCDice")].concat(ee),g=A=[d(ne[0],"CommonCommand")].concat(q),C=[b=M(A[0],null,"D66Dice")].concat(g),h=a.$r(C),b.$$prototype.sort_type=w,v(C[0],"PREFIX_PATTERN",/D66/.$freeze()),_=[l=a.get_singleton_class(b)].concat(C),x=a.$r(_),$(l,"$eval",function(Q,le,Ce){var T;return(T=this.$parse(Q,le))===w||null==T?w:D(T,"eval",[Ce])},3),l.$private(),$(l,"$parse",function(Q,le){var T=w,O=w;return Q=Q.$split(" ",2).$first(),T=/^(S)?D66([ANSD])?$/i.$match(Q.$upcase()),F(T)?this.$new(oe(["secret","sort_type","suffix"],{secret:T["$[]"](1)["$nil?"]()["$!"](),sort_type:F(O=this.$sort_type_from_suffix(T["$[]"](2)))?O:le.$d66_sort_type(),suffix:T["$[]"](2)})):w},2),$(l,"$sort_type_from_suffix",function(Q){var le;return G("A",le=Q)||G("S",le)?p(x("D66SortType"),"ASC"):G("D",le)?p(x("D66SortType"),"DESC"):G("N",le)?p(x("D66SortType"),"NO_SORT"):w},1),$(b,"$initialize",function(f){var _,x,S,Q=this;if(null==f)f=oe([],{});else if(!f.$$is_hash)throw a.ArgumentError.$new("expected kwargs");if(!a.hasOwnProperty.call(f.$$smap,"secret"))throw a.ArgumentError.$new("missing keyword: secret");if(_=f.$$smap.secret,!a.hasOwnProperty.call(f.$$smap,"sort_type"))throw a.ArgumentError.$new("missing keyword: sort_type");if(x=f.$$smap.sort_type,!a.hasOwnProperty.call(f.$$smap,"suffix"))throw a.ArgumentError.$new("missing keyword: suffix");return S=f.$$smap.suffix,Q.secret=_,Q.sort_type=x,Q.suffix=S},1),$(b,"$eval",function(f){var x;return x=this.$roll(f),D(h("Result").$new(),"tap",[],function S(Q){var le=null==S.$$s?this:S.$$s,Ce=w;return null==le.secret&&(le.secret=w),null==le.suffix&&(le.suffix=w),null==Q&&(Q=w),D(Q,"secret=",L(Ce=[le.secret])),V(Ce.length,1),D(Q,"text=",L(Ce=["(D66"+le.suffix+") \uff1e "+x])),Ce[V(Ce.length,1)]},{$$arity:1,$$s:this})},1),b.$private(),$(b,"$roll",function(f){var S,x=w;return x=D(h("Array"),"new",[2],function(){return f.$roll_once(6)},0),G(p(h("D66SortType"),"ASC"),S=this.sort_type)?x["$sort!"]():G(p(h("D66SortType"),"DESC"),S)&&x["$sort!"]()["$reverse!"](),H(se(x["$[]"](0),10),x["$[]"](1))},1)},Opal.modules["bcdice/common_command/repeat"]=function(a){var ue,k,P,u,f,_,g,b,C,h,z,Y,w=[],p=a.nil,d=a.module,M=a.klass,v=a.const_set,D=a.send,$=a.def,F=a.truthy,oe=a.hash2,G=a.to_a,L=a.rb_minus,V=a.eqeq,H=a.rb_lt;return a.top.$require("strscan"),ue=w,k=Y=[d(w[0],"BCDice")].concat(ue),P=z=[d(Y[0],"CommonCommand")].concat(k),b=[g=M(z[0],null,"Repeat")].concat(P),C=a.$r(b),(h=g.$$prototype).times=h.trailer=h.secret=p,v(b[0],"PREFIX_PATTERN",/(repeat|rep|x)\d+/.$freeze()),v(b[0],"REPEAT_LIMIT",100),f=[u=a.get_singleton_class(g)].concat(b),_=a.$r(f),$(u,"$eval",function(S,Q,le){var Ce;return(Ce=this.$parse(S))===p||null==Ce?p:D(Ce,"roll",[Q,le])},3),u.$private(),$(u,"$parse",function(S){var Q,T,Ce=p,O=p,re=p,j=p,ve=p;return T=(Ce=_("StringScanner").$new(S)).$scan(/s/i)["$nil?"]()["$!"](),O=Ce.$scan(/repeat|rep|x/i),re=(Q=Ce.$scan(/\d+/))===p||null==Q?p:D(Q,"to_i",[]),j=Ce.$scan(/\s+/),F(O["$nil?"]())||F(re["$nil?"]())||F(j["$nil?"]())||(ve=Ce.$post_match(),F(ve["$nil?"]())||F(ve["$empty?"]()))?p:this.$new(oe(["secret","times","trailer"],{secret:T,times:re,trailer:ve}))},1),$(g,"$initialize",function(l){var f,_,x,S=this;if(null==l)l=oe([],{});else if(!l.$$is_hash)throw a.ArgumentError.$new("expected kwargs");if(!a.hasOwnProperty.call(l.$$smap,"secret"))throw a.ArgumentError.$new("missing keyword: secret");if(f=l.$$smap.secret,!a.hasOwnProperty.call(l.$$smap,"times"))throw a.ArgumentError.$new("missing keyword: times");if(_=l.$$smap.times,!a.hasOwnProperty.call(l.$$smap,"trailer"))throw a.ArgumentError.$new("missing keyword: trailer");return x=l.$$smap.trailer,S.secret=f,S.times=_,S.trailer=x},1),$(g,"$roll",function(l,f){var x,_=this,S=p,Q=p,le=p,Ce=p;return x=_.$validate(),F(x)?x:(S=D(C("Array"),"new",[_.times],function T(){var j,O=null==T.$$s?this:T.$$s,re=p;return null==O.trailer&&(O.trailer=p),re=l.$class().$new(O.trailer),D(re,"randomizer=",G(j=[f])),L(j.length,1),re.$eval()},{$$arity:0,$$s:_}),V(D(S,"count",[],function(O){return null==O&&(O=p),O["$=="](p)},1),_.times)?_.$result_with_text("\u7e70\u308a\u8fd4\u3057\u5bfe\u8c61\u306e\u30b3\u30de\u30f3\u30c9\u304c\u5b9f\u884c\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f ("+_.trailer+")"):(Q=D(S.$map(),"with_index",[1],function(O,re){return null==O&&(O=p),null==re&&(re=p),"#"+re+"\n"+O.$text()},2).$join("\n\n"),le=F(Ce=_.secret)?Ce:D(S,"any?",[],"secret?".$to_proc()),D(C("Result").$new(),"tap",[],function(O){var re=p;return null==O&&(O=p),D(O,"secret=",G(re=[le])),L(re.length,1),D(O,"text=",G(re=[Q])),re[L(re.length,1)]},1)))},2),g.$private(),$(g,"$validate",function(){var l=this;return F(/^(repeat|rep|x)\d+/["$match?"](l.trailer))?l.$result_with_text("Repeat\u30b3\u30de\u30f3\u30c9\u306e\u91cd\u8907\u306f\u3067\u304d\u307e\u305b\u3093"):F(H(l.times,1))||F(H(C("REPEAT_LIMIT"),l.times))?l.$result_with_text("\u7e70\u308a\u8fd4\u3057\u56de\u6570\u306f1\u4ee5\u4e0a\u3001"+C("REPEAT_LIMIT")+"\u4ee5\u4e0b\u3068\u3057\u3066\u304f\u3060\u3055\u3044"):p},0),$(g,"$result_with_text",function(l){return D(C("Result").$new(),"tap",[],function _(x){var S=null==_.$$s?this:_.$$s,Q=p;return null==S.secret&&(S.secret=p),null==x&&(x=p),D(x,"secret=",G(Q=[S.secret])),L(Q.length,1),D(x,"text=",G(Q=[l])),Q[L(Q.length,1)]},{$$arity:1,$$s:this})},1)},Opal.modules["bcdice/format"]=function(a){var oe,H,se,ue,ee,L,y=[],w=a.nil,p=a.module,d=a.eqeqeq,M=a.def,v=a.truthy,D=a.eqeq,$=a.rb_gt;return oe=y,H=L=[p(y[0],"BCDice")].concat(oe),ue=[se=p(L[0],"Format")].concat(H),ee=a.$r(ue),se.$module_function(),M(se,"$comparison_operator",function(ne){var k;return d("==",k=ne)?"=":d("!=",k)?"<>":d(ee("Symbol"),k)?ne.$to_s():w},1),M(se,"$modifier",function(ne){return v(ne["$nil?"]())?w:D(ne,0)?"":v($(ne,0))?"+"+ne:ne.$to_s()},1)},Opal.modules["bcdice/common_command/barabara_dice/result"]=function(a){var G,se,ne,N,ee,V,w=[],p=a.nil,d=a.$$$,M=a.module,v=a.klass,D=a.send2,$=a.find_super,F=a.def;return a.top.$require("bcdice/result"),G=w,se=V=[M(w[0],"BCDice")].concat(G),ne=ee=[M(V[0],"CommonCommand")].concat(se),(N=v([M(ee[0],"BarabaraDice")].concat(ne)[0],d(d("BCDice"),"Result"),"Result")).$attr_accessor("last_dice_list_list"),N.$attr_accessor("last_dice_list"),N.$attr_accessor("success_num"),F(N,"$initialize",function P(g){var C=this;return delete P.$$p,null==g&&(g=p),D(C,$(C,"initialize",P,!1,!0),"initialize",[g],null),C.last_dice_list_list=[],C.last_dice_list=[],C.success_num=0},-1)},Opal.modules["bcdice/common_command/barabara_dice/node"]=function(a){var V,ee,q,P,u,l,f,_,x,b,A,ne,se,y=a.top,w=[],p=a.nil,d=a.module,M=a.klass,v=a.hash2,D=a.def,$=a.send,F=a.truthy,oe=a.to_a,G=a.rb_minus;return y.$require("bcdice/format"),y.$require("bcdice/common_command/barabara_dice/result"),V=w,ee=se=[d(w[0],"BCDice")].concat(V),q=ne=[d(se[0],"CommonCommand")].concat(ee),P=A=[d(ne[0],"BarabaraDice")].concat(q),u=b=[d(A[0],"Node")].concat(P),f=[l=M(b[0],null,"Command")].concat(u),_=a.$r(f),(x=l.$$prototype).notations=x.cmp_op=x.target_number=p,D(l,"$initialize",function(Q){var le,Ce,T,O;if(null==Q)Q=v([],{});else if(!Q.$$is_hash)throw a.ArgumentError.$new("expected kwargs");if(!a.hasOwnProperty.call(Q.$$smap,"secret"))throw a.ArgumentError.$new("missing keyword: secret");if(le=Q.$$smap.secret,!a.hasOwnProperty.call(Q.$$smap,"notations"))throw a.ArgumentError.$new("missing keyword: notations");if(Ce=Q.$$smap.notations,!a.hasOwnProperty.call(Q.$$smap,"cmp_op"))throw a.ArgumentError.$new("missing keyword: cmp_op");if(T=Q.$$smap.cmp_op,!a.hasOwnProperty.call(Q.$$smap,"target_number"))throw a.ArgumentError.$new("missing keyword: target_number");return O=Q.$$smap.target_number,this.secret=le,this.notations=Ce,this.cmp_op=T,this.target_number=O},1),D(l,"$eval",function(Q,le){var Ce,O,j,de,he,B,T=this,re=p,ve=p,Ee=p,ce=p,R=p,ie=p;return O=Q.$round_type(),re=$(T.notations,"map",[],function(me){return null==me&&(me=p),me.$to_dice(O)},1),j=F(ve=T.cmp_op)?ve:Q.$default_cmp_op(),de=F(ve=(Ce=T.target_number)===p||null==Ce?p:$(Ce,"eval",[O]))?ve:Q.$default_target_number(),Ee=$(re,"map",[],function(me){return null==me&&(me=p),me.$roll(le)},1),F(Q["$sort_barabara_dice?"]())&&$(Ee,"map!",[],"sort".$to_proc()),he=(ce=Ee.$flatten()).$count(1),B=F(j)?$(ce,"count",[],function(me){return null==me&&(me=p),me.$send(j,de)},1):0,F(j)&&(R="\u6210\u529f\u6570"+B),ie=["("+re.$join("+")+_("Format").$comparison_operator(j)+de+")",ce.$join(","),R,Q.$grich_text(he,ce.$size(),B)].$compact(),$(_("Result").$new(),"tap",[],function W(me){var $e=null==W.$$s?this:W.$$s,_e=p;return null==$e.secret&&($e.secret=p),null==me&&(me=p),$(me,"secret=",oe(_e=[$e.secret])),G(_e.length,1),_e=[ie.$join(" \uff1e ")],$(me,"text=",oe(_e)),G(_e.length,1),$(me,"last_dice_list_list=",oe(_e=[Ee])),G(_e.length,1),$(me,"last_dice_list=",oe(_e=[ce])),G(_e.length,1),$(me,"success_num=",oe(_e=[B])),_e[G(_e.length,1)]},{$$arity:1,$$s:T})},2),function(C,h,u){var l=M(C,null,"Notation"),f=[l].concat(u),_=a.$r(f),x=l.$$prototype;x.times=x.sides=p,D(l,"$initialize",function(Q,le){return this.times=Q,this.sides=le},2),D(l,"$to_dice",function(Q){var Ce,T;return Ce=this.times.$eval(Q),T=this.sides.$eval(Q),_("Dice").$new(Ce,T)},1)}(b[0],0,b),function(C,h){var u=M(C,null,"Dice"),l=u.$$prototype;return l.times=l.sides=p,D(u,"$initialize",function(_,x){return this.times=_,this.sides=x},2),D(u,"$roll",function(_){return _.$roll_barabara(this.times,this.sides)},1),D(u,"$to_s",function(){return this.times+"B"+this.sides},0)}(b[0])},Opal.modules["bcdice/common_command/reroll_dice/parser"]=function(a){var se,ne,A,h,_,x,S,Q,le,Ce,T,O,re,de,u,l,f,P,g,q,ee,y=a.top,w=[],p=a.nil,d=a.$$$,M=a.module,v=a.klass,D=a.defs,$=a.def,F=a.hash,oe=a.const_set,G=a.hash2,L=a.to_ary,V=a.truthy;return y.$require("racc/parser.rb"),y.$require("bcdice/common_command/lexer"),y.$require("bcdice/common_command/barabara_dice/node"),y.$require("bcdice/arithmetic/node"),se=w,ne=ee=[M(w[0],"BCDice")].concat(se),A=q=[M(ee[0],"CommonCommand")].concat(ne),P=[M(q[0],"RerollDice")].concat(A),g=a.$r(P),h=P,l=[u=v(P[0],d(g("Racc"),"Parser"),"Parser")].concat(h),f=a.$r(l),u.$$prototype.lexer=p,D(u,"$parse",function(R){return this.$new().$parse(R)},1),$(u,"$parse",function(R){try{return this.lexer=f("Lexer").$new(R),this.$do_parse()}catch(W){if(!a.rescue(W,[f("ParseError")]))throw W;try{return p}finally{a.pop_exception()}}},1),u.$private(),$(u,"$next_token",function(){return this.lexer.$next_token()},0),_=[9,3,9,9,9,15,20,21,20,21,8,14,8,8,8,9,9,4,13,28,10,39,20,21,9,8,8,31,32,9,20,21,33,16,8,20,21,9,24,8,34,35,9,20,21,31,32,8,20,21,9,13,8,31,32,9,20,21,34,35,8,20,21,9,p,8,34,35,9,20,21,31,32,8,20,21,9,p,8,p,31,32,20,21,31,32,8,40,p,p,p,47,51,49,50,52],x=[14,0,24,2,15,5,14,14,24,24,14,5,24,2,15,16,8,1,5,14,4,24,8,8,13,16,8,17,17,20,13,13,17,7,13,20,20,21,11,20,18,18,28,21,21,26,26,21,28,28,31,12,28,38,38,32,31,31,42,42,31,32,32,34,p,32,43,43,35,34,34,46,46,34,35,35,39,p,35,p,27,27,39,39,41,41,39,27,p,p,p,41,45,45,45,45],S=[-6,17,1,p,20,-3,p,30,14,p,p,18,30,22,-2,2,13,19,30,p,27,35,p,p,0,p,37,72,40,p,p,48,53,p,61,66,p,p,45,74,p,76,48,56,p,89,63,p,p,p,p,p,p],Q=[-4,-31,-31,-5,-31,-6,-13,-31,-31,-30,53,-1,-6,-31,-31,-31,-31,-31,-17,-20,-31,-31,-28,-3,-31,-2,-7,-31,-31,-12,-14,-31,-31,-29,-31,-31,-26,-27,-10,-31,-8,-31,-15,-16,-18,-21,-11,-9,-19,-22,-23,-24,-25],le=[17,7,11,36,37,26,27,1,6,25,42,43,2,5,7,30,38,44,45,12,41,29,23,48,p,p,p,p,p,p,p,46],Ce=[7,9,4,11,11,7,7,1,8,4,10,10,2,3,9,9,7,11,11,5,7,8,6,12,p,p,p,p,p,p,p,7],T=[p,7,12,11,-3,14,11,-8,6,-1,-21,-17,-22],O=[p,p,p,p,p,p,p,p,p,22,18,19,p],re=[0,0,"racc_error",3,23,"_reduce_1",4,23,"_reduce_2",4,23,"_reduce_3",0,24,"_reduce_4",1,24,"_reduce_5",0,26,"_reduce_6",2,26,"_reduce_7",3,27,"_reduce_8",4,27,"_reduce_9",2,28,"_reduce_10",3,28,"_reduce_11",3,25,"_reduce_12",1,25,"_reduce_13",3,30,"_reduce_14",3,29,"_reduce_15",3,29,"_reduce_16",1,29,"_reduce_none",3,32,"_reduce_18",4,32,"_reduce_19",1,32,"_reduce_none",0,34,"_reduce_21",1,34,"_reduce_22",1,34,"_reduce_23",1,34,"_reduce_24",1,34,"_reduce_25",2,33,"_reduce_26",2,33,"_reduce_27",1,33,"_reduce_none",3,31,"_reduce_29",1,31,"_reduce_30"],de=F(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"S",7,"PLUS",8,"MINUS",9,"ASTERISK",10,"SLASH",11,"PARENL",12,"PARENR",13,"BRACKETL",14,"BRACKETR",15,"LESS",16,"GREATER",17,"EQUAL",18,"NOT",19,"AT",20,"CMP_OP",21),oe(l[0],"Racc_arg",[_,x,Q,S,le,Ce,O,T,22,re,de,53,31,!0]),oe(l[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","LESS","GREATER","EQUAL","NOT","AT","CMP_OP","$start","expr","secret","notations","target","bracket","at","add","dice","term","mul","unary","round_type"]),oe(l[0],"Racc_debug_parser",!1),$(u,"$_reduce_1",function(R,ie,W){return d(f("Node"),"Command").$new(G(["secret","notations","cmp_op","target_number","source"],{secret:R["$[]"](0),notations:R["$[]"](1),cmp_op:R["$[]"](2)["$[]"]("cmp_op"),target_number:R["$[]"](2)["$[]"]("target"),source:this.lexer.$source()}))},3),$(u,"$_reduce_2",function(R,ie,W){var $e=p,_e=p;return $e=R["$[]"](3),_e=R["$[]"](2),d(f("Node"),"Command").$new(G(["secret","notations","cmp_op","target_number","reroll_cmp_op","reroll_threshold","source"],{secret:R["$[]"](0),notations:R["$[]"](1),cmp_op:$e["$[]"]("cmp_op"),target_number:$e["$[]"]("target"),reroll_cmp_op:_e["$[]"]("cmp_op"),reroll_threshold:_e["$[]"]("threshold"),source:this.lexer.$source()}))},3),$(u,"$_reduce_3",function(R,ie,W){var $e=p,_e=p;return $e=R["$[]"](2),_e=R["$[]"](3),d(f("Node"),"Command").$new(G(["secret","notations","cmp_op","target_number","reroll_cmp_op","reroll_threshold","source"],{secret:R["$[]"](0),notations:R["$[]"](1),cmp_op:$e["$[]"]("cmp_op"),target_number:$e["$[]"]("target"),reroll_cmp_op:_e["$[]"]("cmp_op"),reroll_threshold:_e["$[]"]("threshold"),source:this.lexer.$source()}))},3),$(u,"$_reduce_4",function(R,ie,W){return!1},3),$(u,"$_reduce_5",function(R,ie,W){return!0},3),$(u,"$_reduce_6",function(R,ie,W){return G([],{})},3),$(u,"$_reduce_7",function(R,ie,W){var me,Ie,Pe;return Pe=null==(me=L(R))[1]?p:me[1],V(Ie=null==me[0]?p:me[0])||this.$raise(f("ParseError")),G(["cmp_op","target"],{cmp_op:Ie,target:Pe})},3),$(u,"$_reduce_8",function(R,ie,W){return G(["threshold"],{threshold:R["$[]"](1)})},3),$(u,"$_reduce_9",function(R,ie,W){var $e,_e;return $e=R["$[]"](1),_e=R["$[]"](2),V($e)||this.$raise(f("ParseError")),G(["cmp_op","threshold"],{cmp_op:$e,threshold:_e})},3),$(u,"$_reduce_10",function(R,ie,W){return G(["threshold"],{threshold:R["$[]"](1)})},3),$(u,"$_reduce_11",function(R,ie,W){var $e,_e;return $e=R["$[]"](1),_e=R["$[]"](2),V($e)||this.$raise(f("ParseError")),G(["cmp_op","threshold"],{cmp_op:$e,threshold:_e})},3),$(u,"$_reduce_12",function(R,ie,W){var me=p;return(me=R["$[]"](0)).$push(R["$[]"](2)),me},3),$(u,"$_reduce_13",function(R,ie,W){return[R["$[]"](0)]},3),$(u,"$_reduce_14",function(R,ie,W){var me,$e;return me=R["$[]"](0),$e=R["$[]"](2),d(f("Node"),"Notation").$new(me,$e)},3),$(u,"$_reduce_15",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"BinaryOp").$new(R["$[]"](0),"+",R["$[]"](2))},3),$(u,"$_reduce_16",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"BinaryOp").$new(R["$[]"](0),"-",R["$[]"](2))},3),$(u,"$_reduce_18",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"BinaryOp").$new(R["$[]"](0),"*",R["$[]"](2))},3),$(u,"$_reduce_19",function(R,ie,W){return R["$[]"](3).$new(R["$[]"](0),R["$[]"](2))},3),$(u,"$_reduce_21",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),$(u,"$_reduce_22",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"DivideWithCeil")},3),$(u,"$_reduce_23",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"DivideWithCeil")},3),$(u,"$_reduce_24",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"DivideWithRound")},3),$(u,"$_reduce_25",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"DivideWithFloor")},3),$(u,"$_reduce_26",function(R,ie,W){return R["$[]"](1)},3),$(u,"$_reduce_27",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"Negative").$new(R["$[]"](1))},3),$(u,"$_reduce_29",function(R,ie,W){return R["$[]"](1)},3),$(u,"$_reduce_30",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"Number").$new(R["$[]"](0))},3),$(u,"$_reduce_none",function(R,ie,W){return R["$[]"](0)},3)},Opal.modules["bcdice/common_command/reroll_dice"]=function(a){var F,V,ee,k,z,A,Y,ne,se,G,y=a.top,w=[],p=a.nil,d=a.module,M=a.const_set,v=a.send,D=a.def;return y.$require("bcdice/normalize"),y.$require("bcdice/format"),y.$require("bcdice/common_command/reroll_dice/parser"),F=w,V=G=[d(w[0],"BCDice")].concat(F),ee=se=[d(G[0],"CommonCommand")].concat(V),M((ne=[Y=d(se[0],"RerollDice")].concat(ee))[0],"PREFIX_PATTERN",/\d+R\d+/.$freeze()),M(ne[0],"REROLL_LIMIT",1e4),z=[k=a.get_singleton_class(Y)].concat(ne),A=a.$r(z),D(k,"$eval",function(P,g,b){var C;return(C=A("Parser").$parse(P))===p||null==C?p:v(C,"eval",[g,b])},3)},Opal.modules["bcdice/common_command/upper_dice/node"]=function(a){var ue,k,N,C,_,x,S,Q,le,u,g,z,Y,y=[],w=a.nil,p=a.module,d=a.klass,M=a.hash2,v=a.def,D=a.send,$=a.truthy,F=a.rb_le,oe=a.rb_plus,G=a.eqeq,L=a.to_a,V=a.rb_minus,H=a.rb_lt;return ue=y,k=Y=[p(y[0],"BCDice")].concat(ue),N=z=[p(Y[0],"CommonCommand")].concat(k),C=g=[p(z[0],"UpperDice")].concat(N),_=u=[p(g[0],"Node")].concat(C),S=[x=d(u[0],null,"Command")].concat(_),Q=a.$r(S),(le=x.$$prototype).notations=le.reroll_threshold=le.modifier=le.target_number=le.cmp_op=w,v(x,"$initialize",function(T){var O,re,j,ve,de,Ee,ce=this;if(null==T)T=M([],{});else if(!T.$$is_hash)throw a.ArgumentError.$new("expected kwargs");if(!a.hasOwnProperty.call(T.$$smap,"secret"))throw a.ArgumentError.$new("missing keyword: secret");if(O=T.$$smap.secret,!a.hasOwnProperty.call(T.$$smap,"notations"))throw a.ArgumentError.$new("missing keyword: notations");if(re=T.$$smap.notations,!a.hasOwnProperty.call(T.$$smap,"modifier"))throw a.ArgumentError.$new("missing keyword: modifier");if(j=T.$$smap.modifier,!a.hasOwnProperty.call(T.$$smap,"cmp_op"))throw a.ArgumentError.$new("missing keyword: cmp_op");if(ve=T.$$smap.cmp_op,!a.hasOwnProperty.call(T.$$smap,"target_number"))throw a.ArgumentError.$new("missing keyword: target_number");return de=T.$$smap.target_number,null==(Ee=T.$$smap.reroll_threshold)&&(Ee=w),ce.secret=O,ce.notations=re,ce.modifier=j,ce.cmp_op=ve,ce.target_number=de,ce.reroll_threshold=Ee},1),v(x,"$eval",function(T,O){var re,j,ve,Ee,ce,he,ie,me,R,W,de=this,B=w,$e=w,_e=w,Ie=w;return Ee=T.$round_type(),ce=D(de.notations,"map",[],function(Ae){return null==Ae&&(Ae=w),Ae.$to_dice(Ee)},1),he=$(B=$(R=(re=de.reroll_threshold)===w||null==re?w:D(re,"eval",[Ee]))?R:T.$upper_dice_reroll_threshold())?B:0,ie=$(B=(j=de.modifier)===w||null==j?w:D(j,"eval",[Ee]))?B:0,W=(ve=de.target_number)===w||null==ve?w:D(ve,"eval",[Ee]),me=de.$expr(ce,he,ie,W),$(F(he,1))?de.$result_with_text("("+me+") \uff1e \u7121\u9650\u30ed\u30fc\u30eb\u306e\u6761\u4ef6\u304c\u307e\u3061\u304c\u3063\u3066\u3044\u307e\u3059"):($e=D(ce,"map",[],function(Ae){return null==Ae&&(Ae=w),Ae.$roll(O,he,T["$sort_barabara_dice?"]())},1).$reduce([],"concat"),_e=$(de.cmp_op)?de.$result_success_count($e,ie,W):de.$result_max_sum($e,ie),Ie=["("+me+")",de.$interlim_expr($e,ie),_e],de.$result_with_text(Ie.$join(" \uff1e ")))},2),x.$private(),v(x,"$result_success_count",function(T,O,re){return"\u6210\u529f\u6570"+D(T,"count",[],function de(Ee){var ce=null==de.$$s?this:de.$$s;return null==ce.cmp_op&&(ce.cmp_op=w),null==Ee&&(Ee=w),oe(Ee["$[]"]("sum"),O).$send(ce.cmp_op,re)},{$$arity:1,$$s:this})},3),v(x,"$result_max_sum",function(T,O){var j,re=w;return re=D(T,"map",[],function(Ee){return null==Ee&&(Ee=w),Ee["$[]"]("sum")},1),j=oe(re.$sum(),O),D(re,"map",[],function(Ee){return null==Ee&&(Ee=w),oe(Ee,O)},1).$max()+"/"+j+"(\u6700\u5927/\u5408\u8a08)"},2),v(x,"$interlim_expr",function(T,O){var re;return re=D(T,"map",[],function(ve){return null==ve&&(ve=w),G(ve["$[]"]("list").$size(),1)?ve["$[]"]("sum"):ve["$[]"]("sum")+"["+ve["$[]"]("list").$join(",")+"]"},1).$join(","),oe(re,Q("Format").$modifier(O))},2),v(x,"$expr",function(T,O,re,j){var de,Ee;return de=Q("Format").$comparison_operator(this.cmp_op),Ee=Q("Format").$modifier(re),T.$join("+")+"["+O+"]"+Ee+de+j},4),v(x,"$result_with_text",function(T){return D(Q("Result").$new(),"tap",[],function re(j){var ve=null==re.$$s?this:re.$$s,de=w;return null==ve.secret&&(ve.secret=w),null==j&&(j=w),D(j,"secret=",L(de=[ve.secret])),V(de.length,1),D(j,"text=",L(de=[T])),de[V(de.length,1)]},{$$arity:1,$$s:this})},1),function(l,f,_){var x=d(l,null,"Notation"),S=[x].concat(_),Q=a.$r(S),le=x.$$prototype;le.roll_times=le.sides=w,v(x,"$initialize",function(T,O){return this.roll_times=T,this.sides=O},2),v(x,"$to_dice",function(T){var re,j;return re=this.roll_times.$eval(T),j=this.sides.$eval(T),Q("Dice").$new(re,j)},1)}(u[0],0,u),function(l,f,_){var x=d(l,null,"Dice"),S=[x].concat(_),Q=a.$r(S),le=x.$$prototype;return le.roll_times=le.sides=w,v(x,"$initialize",function(T,O){return this.roll_times=T,this.sides=O},2),v(x,"$roll",function(T,O,re){var ve=w;return ve=D(Q("Array"),"new",[this.roll_times],function de(){var ce=w;return ce=(null==de.$$s?this:de.$$s).$roll_ones(T,O),M(["sum","list"],{sum:ce.$sum(),list:ce})},{$$arity:0,$$s:this}),$(re)&&(ve=D(ve,"sort_by",[],function(Ee){return null==Ee&&(Ee=w),Ee["$[]"]("sum")},1)),ve},3),v(x,"$to_s",function(){return this.roll_times+"U"+this.sides},0),x.$private(),v(x,"$roll_ones",function(T,O){var re=this,j=w;return j=[],function(){var ve=a.new_brk();try{D(re,"loop",[],function de(){var ce,Ee=null==de.$$s?this:de.$$s;if(null==Ee.sides&&(Ee.sides=w),ce=T.$roll_once(Ee.sides),j.$push(ce),!$(H(ce,O)))return w;a.brk(w,ve)},{$$arity:0,$$s:re,$$brk:ve})}catch(de){if(de===ve)return de.$v;throw de}}(),j},2)}(u[0],0,u)},Opal.modules["bcdice/common_command/upper_dice/parser"]=function(a){var se,ne,A,h,_,x,S,Q,le,Ce,T,O,re,de,u,l,f,P,g,q,ee,y=a.top,w=[],p=a.nil,d=a.$$$,M=a.module,v=a.klass,D=a.defs,$=a.def,F=a.hash,oe=a.const_set,G=a.hash2,L=a.to_ary,V=a.truthy;return y.$require("racc/parser.rb"),y.$require("bcdice/common_command/lexer"),y.$require("bcdice/common_command/upper_dice/node"),y.$require("bcdice/arithmetic/node"),se=w,ne=ee=[M(w[0],"BCDice")].concat(se),A=q=[M(ee[0],"CommonCommand")].concat(ne),P=[M(q[0],"UpperDice")].concat(A),g=a.$r(P),h=P,l=[u=v(P[0],d(g("Racc"),"Parser"),"Parser")].concat(h),f=a.$r(l),u.$$prototype.lexer=p,D(u,"$parse",function(R){return this.$new().$parse(R)},1),$(u,"$parse",function(R){try{return this.lexer=f("Lexer").$new(R),this.$do_parse()}catch(W){if(!a.rescue(W,[f("ParseError")]))throw W;try{return p}finally{a.pop_exception()}}},1),u.$private(),$(u,"$next_token",function(){return this.lexer.$next_token()},0),_=[9,9,36,37,3,9,9,21,22,49,8,8,21,22,9,8,8,14,15,9,21,22,4,16,8,21,22,9,10,8,36,37,9,21,22,38,17,8,21,22,9,25,8,27,15,9,21,22,28,29,8,21,22,9,44,8,39,40,9,21,22,39,40,8,21,22,9,25,8,39,40,9,21,22,36,37,8,21,22,9,17,8,39,40,9,21,22,39,40,8,21,22,9,p,8,39,40,p,21,22,39,40,8,58,56,57,59,36,37],x=[2,8,34,34,0,17,14,8,8,34,2,8,14,14,15,17,14,5,5,16,15,15,1,5,15,16,16,21,4,16,18,18,22,21,21,18,7,21,22,22,25,11,22,12,12,27,25,25,13,13,25,27,27,28,24,27,19,19,29,28,28,30,30,28,29,29,36,26,29,33,33,37,36,36,45,45,36,37,37,39,32,37,47,47,40,39,39,48,48,39,40,40,44,p,40,50,50,p,44,44,51,51,44,53,53,53,53,54,54],S=[-3,22,-2,p,28,9,p,32,-1,p,p,20,35,40,4,12,17,3,22,46,p,25,30,p,34,38,46,43,51,56,51,p,76,59,-6,p,64,69,p,77,82,p,p,p,90,66,p,72,77,p,85,90,p,100,99,p,p,p,p,p],Q=[-4,-35,-35,-5,-35,-6,-17,-35,-35,-34,60,-12,-6,-7,-35,-35,-35,-35,-35,-21,-24,-35,-35,-32,-1,-35,-12,-35,-35,-35,-8,-16,-32,-9,-35,-18,-35,-35,-33,-35,-35,-30,-31,-3,-35,-13,-2,-10,-11,-14,-19,-20,-22,-25,-15,-23,-26,-27,-28,-29],le=[18,30,33,41,42,24,6,1,34,2,5,12,11,7,30,47,48,45,31,26,46,52,53,50,51,32,43,55,35,p,p,p,p,p,p,p,54],Ce=[10,9,9,13,13,5,11,1,10,2,3,6,4,12,9,9,9,10,11,4,5,13,13,9,9,12,7,14,12,p,p,p,p,p,p,p,10],T=[p,7,9,8,7,-6,6,2,p,-13,-8,4,11,-18,-26],O=[p,p,p,p,p,p,p,p,13,19,p,p,23,20,p],re=[0,0,"racc_error",4,23,"_reduce_1",5,23,"_reduce_2",5,23,"_reduce_3",0,24,"_reduce_4",1,24,"_reduce_5",0,26,"_reduce_6",1,26,"_reduce_7",2,30,"_reduce_8",2,30,"_reduce_9",3,30,"_reduce_10",3,30,"_reduce_11",0,27,"_reduce_12",2,27,"_reduce_13",3,28,"_reduce_14",2,29,"_reduce_15",3,25,"_reduce_16",1,25,"_reduce_17",3,33,"_reduce_18",3,32,"_reduce_19",3,32,"_reduce_20",1,32,"_reduce_none",3,31,"_reduce_22",4,31,"_reduce_23",1,31,"_reduce_none",0,36,"_reduce_25",1,36,"_reduce_26",1,36,"_reduce_27",1,36,"_reduce_28",1,36,"_reduce_29",2,35,"_reduce_30",2,35,"_reduce_31",1,35,"_reduce_none",3,34,"_reduce_33",1,34,"_reduce_34"],de=F(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"S",7,"PLUS",8,"MINUS",9,"ASTERISK",10,"SLASH",11,"PARENL",12,"PARENR",13,"BRACKETL",14,"BRACKETR",15,"LESS",16,"GREATER",17,"EQUAL",18,"NOT",19,"AT",20,"CMP_OP",21),oe(l[0],"Racc_arg",[_,x,Q,S,le,Ce,O,T,22,re,de,60,35,!0]),oe(l[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","LESS","GREATER","EQUAL","NOT","AT","CMP_OP","$start","expr","secret","notations","modifier","target","bracket","at","modifier_expr","mul","add","dice","term","unary","round_type"]),oe(l[0],"Racc_debug_parser",!1),$(u,"$_reduce_1",function(R,ie,W){return d(d(f("UpperDice"),"Node"),"Command").$new(G(["secret","notations","modifier","cmp_op","target_number"],{secret:R["$[]"](0),notations:R["$[]"](1),modifier:R["$[]"](2),cmp_op:R["$[]"](3)["$[]"]("cmp_op"),target_number:R["$[]"](3)["$[]"]("target")}))},3),$(u,"$_reduce_2",function(R,ie,W){return d(d(f("UpperDice"),"Node"),"Command").$new(G(["secret","notations","modifier","cmp_op","target_number","reroll_threshold"],{secret:R["$[]"](0),notations:R["$[]"](1),modifier:R["$[]"](3),cmp_op:R["$[]"](4)["$[]"]("cmp_op"),target_number:R["$[]"](4)["$[]"]("target"),reroll_threshold:R["$[]"](2)}))},3),$(u,"$_reduce_3",function(R,ie,W){return d(d(f("UpperDice"),"Node"),"Command").$new(G(["secret","notations","modifier","cmp_op","target_number","reroll_threshold"],{secret:R["$[]"](0),notations:R["$[]"](1),modifier:R["$[]"](2),cmp_op:R["$[]"](3)["$[]"]("cmp_op"),target_number:R["$[]"](3)["$[]"]("target"),reroll_threshold:R["$[]"](4)}))},3),$(u,"$_reduce_4",function(R,ie,W){return!1},3),$(u,"$_reduce_5",function(R,ie,W){return!0},3),$(u,"$_reduce_6",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"Number").$new(0)},3),$(u,"$_reduce_7",function(R,ie,W){return R["$[]"](0)},3),$(u,"$_reduce_8",function(R,ie,W){return R["$[]"](1)},3),$(u,"$_reduce_9",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"Negative").$new(R["$[]"](1))},3),$(u,"$_reduce_10",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"BinaryOp").$new(R["$[]"](0),"+",R["$[]"](2))},3),$(u,"$_reduce_11",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"BinaryOp").$new(R["$[]"](0),"-",R["$[]"](2))},3),$(u,"$_reduce_12",function(R,ie,W){return G([],{})},3),$(u,"$_reduce_13",function(R,ie,W){var me,Ie,Pe;return Pe=null==(me=L(R))[1]?p:me[1],V(Ie=null==me[0]?p:me[0])||this.$raise(f("ParseError")),G(["cmp_op","target"],{cmp_op:Ie,target:Pe})},3),$(u,"$_reduce_14",function(R,ie,W){return R["$[]"](1)},3),$(u,"$_reduce_15",function(R,ie,W){return R["$[]"](1)},3),$(u,"$_reduce_16",function(R,ie,W){var me=p;return(me=R["$[]"](0)).$push(R["$[]"](2)),me},3),$(u,"$_reduce_17",function(R,ie,W){return[R["$[]"](0)]},3),$(u,"$_reduce_18",function(R,ie,W){var me,$e;return me=R["$[]"](0),$e=R["$[]"](2),d(d(f("UpperDice"),"Node"),"Notation").$new(me,$e)},3),$(u,"$_reduce_19",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"BinaryOp").$new(R["$[]"](0),"+",R["$[]"](2))},3),$(u,"$_reduce_20",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"BinaryOp").$new(R["$[]"](0),"-",R["$[]"](2))},3),$(u,"$_reduce_22",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"BinaryOp").$new(R["$[]"](0),"*",R["$[]"](2))},3),$(u,"$_reduce_23",function(R,ie,W){return R["$[]"](3).$new(R["$[]"](0),R["$[]"](2))},3),$(u,"$_reduce_25",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),$(u,"$_reduce_26",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"DivideWithCeil")},3),$(u,"$_reduce_27",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"DivideWithCeil")},3),$(u,"$_reduce_28",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"DivideWithRound")},3),$(u,"$_reduce_29",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"DivideWithFloor")},3),$(u,"$_reduce_30",function(R,ie,W){return R["$[]"](1)},3),$(u,"$_reduce_31",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"Negative").$new(R["$[]"](1))},3),$(u,"$_reduce_33",function(R,ie,W){return R["$[]"](1)},3),$(u,"$_reduce_34",function(R,ie,W){return d(d(f("Arithmetic"),"Node"),"Number").$new(R["$[]"](0))},3),$(u,"$_reduce_none",function(R,ie,W){return R["$[]"](0)},3)},Opal.modules["bcdice/common_command/upper_dice"]=function(a){var F,V,ee,k,z,A,Y,ne,se,G,w=[],p=a.nil,d=a.module,M=a.const_set,v=a.send,D=a.def;return a.top.$require("bcdice/common_command/upper_dice/parser"),F=w,V=G=[d(w[0],"BCDice")].concat(F),ee=se=[d(G[0],"CommonCommand")].concat(V),M((ne=[Y=d(se[0],"UpperDice")].concat(ee))[0],"PREFIX_PATTERN",/\d+U\d+/.$freeze()),z=[k=a.get_singleton_class(Y)].concat(ne),A=a.$r(z),D(k,"$eval",function(P,g,b){var C;return(C=A("Parser").$parse(P))===p||null==C?p:v(C,"eval",[g,b])},3)},Opal.modules["bcdice/common_command/version"]=function(a){var L,ue,k,A,P,g,q,z,Y,H,y=[],w=a.nil,p=a.$$$,d=a.module,M=a.const_set,v=a.truthy,D=a.send,$=a.to_a,F=a.rb_minus,oe=a.def;return L=y,ue=H=[d(y[0],"BCDice")].concat(L),k=Y=[d(H[0],"CommonCommand")].concat(ue),M((z=[q=d(Y[0],"Version")].concat(k))[0],"PREFIX_PATTERN",/BCDiceVersion/.$freeze()),P=[A=a.get_singleton_class(q)].concat(z),g=a.$r(P),oe(A,"$eval",function(C,h,u){return C=C.$split(" ",2).$first(),v(C["$match?"](/^BCDiceVersion$/i))?D(g("Result").$new(),"tap",[],function(f){var _;return null==f&&(f=w),_=["BCDice "+p(g("BCDice"),"VERSION")],D(f,"text=",$(_)),_[F(_.length,1)]},1):w},3)},Opal.queue(function(a){var D,G,V,H,F,y=a.top,w=[],d=a.module,M=a.const_set;return y.$require("bcdice/common_command/add_dice"),y.$require("bcdice/common_command/barabara_dice"),y.$require("bcdice/common_command/tally_dice"),y.$require("bcdice/common_command/calc"),y.$require("bcdice/common_command/choice"),y.$require("bcdice/common_command/d66_dice"),y.$require("bcdice/common_command/repeat"),y.$require("bcdice/common_command/reroll_dice"),y.$require("bcdice/common_command/upper_dice"),y.$require("bcdice/common_command/version"),D=w,G=F=[d(w[0],"BCDice")].concat(D),V=[d(F[0],"CommonCommand")].concat(G),H=a.$r(V),M(V[0],"COMMANDS",[H("AddDice"),H("BarabaraDice"),H("TallyDice"),H("Calc"),H("Choice"),H("D66Dice"),H("Repeat"),H("RerollDice"),H("UpperDice"),H("Version")].$freeze())})},9993:function(){(function(E){"use strict";var ae;if("undefined"!=typeof globalThis?E=globalThis:"undefined"!=typeof global?E=global:"undefined"!=typeof window&&(E=window),"log"in(ae="object"==typeof E.console?E.console:null==E.console?E.console={}:{})||(ae.log=function(){}),"warn"in ae||(ae.warn=ae.log),void 0!==E.Opal)return ae.warn("Opal already loaded. Loading twice can cause troubles, please fix your setup."),E.Opal;var X,a,y,w,p,d,M,v=E.Opal={};v.global=E,E.Opal=v,v.config={missing_require_severity:"error",unsupported_features_severity:"warning",experimental_features_severity:"warning",enable_stack_trace:!0};var D=Object.hasOwnProperty,$=Function.prototype.bind,F=Object.setPrototypeOf,oe=Array.prototype.slice,G=Array.prototype.splice,V=4;function H(T,O,re){"string"==typeof T?T[O]=re:Object.defineProperty(T,O,{value:re,enumerable:!1,configurable:!0,writable:!0})}v.uid=function(){return V+=2},v.id=function(T){return T.$$is_number?2*T+1:(null!=T.$$id||H(T,"$$id",v.uid()),T.$$id)},v.gvars={},v.exit=function(T){v.gvars.DEBUG&&ae.log("Exited with status "+T)},v.exceptions=[],v.pop_exception=function(){var T=v.exceptions.pop();T?(v.gvars["!"]=T,v.gvars["@"]=T.$backtrace()):v.gvars["!"]=v.gvars["@"]=X},v.prop=H,v.defineProperty=v.prop,v.slice=oe;var se=v.truthy=function(T){return!(!1===T||X===T||null==T||T instanceof Boolean&&!0!==T.valueOf())};function ue(T){var O,re,j;for(O=0,re=v.tracers_for_class.length;O<re;O++)(j=v.tracers_for_class[O]).trace_object=T,j.block.$call(j)}function ee(T,O){if(T.$$autoload[O].loaded){if(T.$$autoload[O].loaded&&!T.$$autoload[O].required&&T.$$autoload[O].exception)throw T.$$autoload[O].exception}else{T.$$autoload[O].loaded=!0;try{v.Kernel.$require(T.$$autoload[O].path)}catch(re){throw T.$$autoload[O].exception=re,re}if(T.$$autoload[O].required=!0,null!=T.$$const[O])return T.$$autoload[O].success=!0,T.$$const[O]}}function Y(T,O){if(T){if(null!=T.$$const[O])return T.$$const[O];if(T.$$autoload&&T.$$autoload[O])return ee(T,O)}}function k(T,O){var re,j,ve;if(null!=T)for(re=0,j=(ve=v.ancestors(T)).length;re<j;re++){if(ve[re].$$const&&D.call(ve[re].$$const,O))return ve[re].$$const[O];if(ve[re].$$autoload&&ve[re].$$autoload[O])return ee(ve[re],O)}}function z(T,O,re){if(!re)return(T||y).$const_missing(O)}function A(T,O,re){return(null==T||"::"===T)&&(T=y),re.$$is_a_module&&((null==re.$$name||re.$$name===X)&&(re.$$name=O),null==re.$$base_module&&(re.$$base_module=T)),T.$$const=T.$$const||Object.create(null),T.$$const[O]=re,T.$$=T.$$const,v.const_cache_version++,T===y&&(v[O]=re),H(T,O,re),re}function b(T){return T.hasOwnProperty("$$iclass")&&T.hasOwnProperty("$$root")}function l(T){var O=f(T);return T.$$is_module&&T.$$iclasses.push(O),O}function f(T){var O={},re=T.$$prototype;re.hasOwnProperty("$$dummy")&&(re=re.$$define_methods_on);var de,j=Object.getOwnPropertyNames(re),ve=j.length;for(de=0;de<ve;de++){var Ee=j[de];H(O,Ee,re[Ee])}return H(O,"$$iclass",!0),H(O,"$$module",T),O}function _(T){var O=T.length,re=T[0];if(H(re,"$$root",!0),1===O)return{first:re,last:re};for(var j=re,ve=1;ve<O;ve++){var de=T[ve];F(j,de),j=de}return{first:T[0],last:T[O-1]}}function x(T){if(!T.hasOwnProperty("$$dummy")){if(T.hasOwnProperty("$$iclass"))return T.$$module;if(T.hasOwnProperty("$$class"))return T.$$class}}function Q(T,O){"number"==typeof O?T.$$arity=O:"object"==typeof O&&Object.assign(T,O)}function le(T){return"function"==typeof T&&!T.$$stub}v.falsy=function(T){return!se(T)},v.type_error=function(T,O,re,j){return T=T.$$class,v.TypeError.$new(j&&re?"can't convert "+T+" into "+O+" ("+T+"#"+re+" gives "+(j=j.$$class)+")":"no implicit conversion of "+T+" into "+O)},v.coerce_to=function(T,O,re,j){if(O["$==="](T))return T;if(!T["$respond_to?"](re))throw v.type_error(T,O);return null==j&&(j=[]),v.send(T,re,j)},v.respond_to=function(T,O,re){if(null==T||!T.$$class)return!1;re=!!re;var j=T[O];return T["$respond_to?"].$$pristine?"function"==typeof j&&!j.$$stub||(T["$respond_to_missing?"].$$pristine?void 0:v.send(T,T["$respond_to_missing?"],[O.substr(1),re])):v.send(T,T["$respond_to?"],[O.substr(1),re])},v.trace_class=!1,v.tracers_for_class=[],v.const_get_local=function(T,O,re){var j;if(null!=T){if("::"===T&&(T=y),!T.$$is_module&&!T.$$is_class)throw new v.TypeError(T.toString()+" is not a class/module");if(null!=(j=Y(T,O))||null!=(j=z(T,O,re)))return j}},v.const_get_qualified=function(T,O,re){var j,ve,de,Ee=v.const_cache_version;if(null==O)return null!=(j=Y(y,T))?j:v.const_get_qualified(y,T,re);if(null!=T){if("::"===T&&(T=y),!T.$$is_module&&!T.$$is_class)throw new v.TypeError(T.toString()+" is not a class/module");return null==(ve=T.$$const_cache)&&(H(T,"$$const_cache",Object.create(null)),ve=T.$$const_cache),null==(de=ve[O])||de[0]!==Ee?(null!=(j=Y(T,O))||(j=k(T,O)),ve[O]=[Ee,j]):j=de[1],null!=j?j:z(T,O,re)}},v.const_cache_version=1,v.const_get_relative=function(T,O,re){var ve,Ee,ce,j=T[0],de=v.const_cache_version;return null==(Ee=T.$$const_cache)&&(H(T,"$$const_cache",Object.create(null)),Ee=T.$$const_cache),null==(ce=Ee[O])||ce[0]!==de?(null!=(ve=Y(j,O))||null!=(ve=function ne(T,O){var re,j,ve;if(0!==T.length)for(re=0,j=T.length;re<j;re++){if(null!=(ve=T[re].$$const[O]))return ve;if(T[re].$$autoload&&T[re].$$autoload[O])return ee(T[re],O)}}(T,O))||null!=(ve=k(j,O))||(ve=function q(T,O){if(null==T||T.$$is_module)return k(y,O)}(j,O)),Ee[O]=[de,ve]):ve=ce[1],null!=ve?ve:z(j,O,re)},v.const_set=A,v.constants=function(T,O){null==O&&(O=!0);var re,ve,de,ce,j=[T],Ee={};for(O&&(j=j.concat(v.ancestors(T))),O&&T.$$is_module&&(j=j.concat([v.Object]).concat(v.ancestors(v.Object))),ve=0,de=j.length;ve<de&&(re=j[ve],T===y||re!=y);ve++){for(ce in re.$$const)Ee[ce]=!0;if(re.$$autoload)for(ce in re.$$autoload)Ee[ce]=!0}return Object.keys(Ee)},v.const_remove=function(T,O){if(v.const_cache_version++,null!=T.$$const[O]){var re=T.$$const[O];return delete T.$$const[O],re}if(T.$$autoload&&T.$$autoload[O])return delete T.$$autoload[O],X;throw v.NameError.$new("constant "+T+"::"+T.$name()+" not defined")},v.const_get_relative_factory=function(T){return function(O,re){return v.$$(T,O,re)}},v.$$=v.const_get_relative,v.$$$=v.const_get_qualified,v.$r=v.const_get_relative_factory,v.allocate_class=function(T,O,re){var j,ve;if(ve=null!=O&&O.$$bridge?function(){var he=oe.call(arguments),B=new($.apply(O.$$constructor,[null].concat(he)));return F(B,j.$$prototype),B}:function(){},T&&T!==X&&H(ve,"displayName","::"+T),H(j=ve,"$$name",T),H(j,"$$constructor",ve),H(j,"$$prototype",ve.prototype),H(j,"$$const",{}),H(j,"$$is_class",!0),H(j,"$$is_a_module",!0),H(j,"$$super",O),H(j,"$$cvars",{}),H(j,"$$own_included_modules",[]),H(j,"$$own_prepended_modules",[]),H(j,"$$ancestors",[]),H(j,"$$ancestors_cache_version",null),H(j,"$$subclasses",[]),H(j.$$prototype,"$$class",j),v.Class&&F(j,v.Class.prototype),null!=O){if(F(j.$$prototype,O.$$prototype),!0!==re)if("undefined"!=typeof WeakRef){var de,Ee,ce=[];for(de=0;de<O.$$subclasses.length;de++)void 0!==(Ee=O.$$subclasses[de]).deref()&&ce.push(Ee);ce.push(new WeakRef(j)),O.$$subclasses=ce}else O.$$subclasses.push(j);O.$$meta&&v.build_class_singleton_class(j)}return j},v.klass=function(T,O,re){var j;if(null==T||"::"==T?T=y:!T.$$is_class&&!T.$$is_module&&(T=T.$$class),null!=O&&(!O.hasOwnProperty||O.hasOwnProperty&&!O.hasOwnProperty("$$is_class"))){if(!O.constructor||"Function"!=O.constructor.name)throw v.TypeError.$new("superclass must be a Class ("+(O.constructor&&(O.constructor.name||O.constructor.$$name)||typeof O)+" given)");j=O,O=y}var ve=function N(T,O){var re=Y(T,O);if(re){if(!re.$$is_class)throw v.TypeError.$new(O+" is not a class");return re}}(T,re);return ve?(O&&function P(T,O){if(T.$$super!==O)throw v.TypeError.$new("superclass mismatch for class "+T.$$name)}(ve,O),v.trace_class&&ue(ve),ve):(null==O&&(O=y),A(T,re,ve=v.allocate_class(re,O)),O.$inherited&&O.$inherited(ve),j&&v.bridge(j,ve),v.trace_class&&ue(ve),ve)},v.allocate_module=function(T){var O=function(){};T&&H(O,"displayName",T+".$$constructor");var re=O;return T&&H(O,"displayName",T+".constructor"),H(re,"$$name",T),H(re,"$$prototype",O.prototype),H(re,"$$const",{}),H(re,"$$is_module",!0),H(re,"$$is_a_module",!0),H(re,"$$cvars",{}),H(re,"$$iclasses",[]),H(re,"$$own_included_modules",[]),H(re,"$$own_prepended_modules",[]),H(re,"$$ancestors",[re]),H(re,"$$ancestors_cache_version",null),F(re,v.Module.prototype),re},v.module=function(T,O){var re;return null==T||"::"==T?T=y:!T.$$is_class&&!T.$$is_module&&(T=T.$$class),re=function g(T,O){var re=Y(T,O);if(null==re&&T===y&&(re=k(y,O)),re&&!re.$$is_module&&re!==y)throw v.TypeError.$new(O+" is not a module");return re}(T,O),re?(v.trace_class&&ue(re),re):(A(T,O,re=v.allocate_module(O)),v.trace_class&&ue(re),re)},v.get_singleton_class=function(T){return T.$$meta?T.$$meta:T.hasOwnProperty("$$is_class")?v.build_class_singleton_class(T):T.hasOwnProperty("$$is_module")?v.build_module_singleton_class(T):v.build_object_singleton_class(T)},v.build_class_singleton_class=function(T){var O,re;return T.$$meta?T.$$meta:(O=T===a?p:v.get_singleton_class(T.$$super),H(re=v.allocate_class(null,O,!0),"$$is_singleton",!0),H(re,"$$singleton_of",T),H(T,"$$meta",re),F(T,re.$$prototype),H(T,"$$class",v.Class),re)},v.build_module_singleton_class=function(T){if(T.$$meta)return T.$$meta;var O=v.allocate_class(null,v.Module,!0);return H(O,"$$is_singleton",!0),H(O,"$$singleton_of",T),H(T,"$$meta",O),F(T,O.$$prototype),H(T,"$$class",v.Module),O},v.build_object_singleton_class=function(T){var re=v.allocate_class(X,T.$$class,!0);return H(re,"$$is_singleton",!0),H(re,"$$singleton_of",T),delete re.$$prototype.$$class,H(T,"$$meta",re),F(T,T.$$meta.$$prototype),re},v.is_method=function(T){return"$"===T[0]&&"$"!==T[1]},v.instance_methods=function(T){for(var O=[],re=[],j=v.ancestors(T),ve=0,de=j.length;ve<de;ve++){var ce=j[ve].$$prototype;ce.hasOwnProperty("$$dummy")&&(ce=ce.$$define_methods_on);for(var he=Object.getOwnPropertyNames(ce),B=0,R=he.length;B<R;B++){var ie=he[B];if(v.is_method(ie)){var W=ie.slice(1),me=ce[ie];me.$$stub&&-1===O.indexOf(W)&&O.push(W),!me.$$stub&&-1===re.indexOf(W)&&-1===O.indexOf(W)&&re.push(W)}}}return re},v.own_instance_methods=function(T){var O=[],re=T.$$prototype;re.hasOwnProperty("$$dummy")&&(re=re.$$define_methods_on);for(var j=Object.getOwnPropertyNames(re),ve=0,de=j.length;ve<de;ve++){var Ee=j[ve];if(v.is_method(Ee)&&!re[Ee].$$stub){var he=Ee.slice(1);O.push(he)}}return O},v.methods=function(T){return v.instance_methods(T.$$meta||T.$$class)},v.own_methods=function(T){return T.$$meta?v.own_instance_methods(T.$$meta):[]},v.receiver_methods=function(T){var O=v.get_singleton_class(T),re=v.own_instance_methods(O),j=v.own_instance_methods(O.$$super);return re.concat(j)},v.class_variables=function(T){var re,O=v.ancestors(T),ve={};for(re=O.length-1;re>=0;re--){var de=O[re];for(var Ee in de.$$cvars)ve[Ee]=de.$$cvars[Ee]}return ve},v.class_variable_set=function(T,O,re){var ve,j=v.ancestors(T);for(ve=j.length-2;ve>=0;ve--){var Ee=j[ve];if(D.call(Ee.$$cvars,O))return Ee.$$cvars[O]=re,re}return T.$$cvars[O]=re,re},v.class_variable_get=function(T,O,re){if(D.call(T.$$cvars,O))return T.$$cvars[O];var ve,j=v.ancestors(T),de=j.length;for(ve=0;ve<de;ve++){var Ee=j[ve];if(D.call(Ee.$$cvars,O))return Ee.$$cvars[O]}if(!re)throw v.NameError.$new("uninitialized class variable "+O+" in "+T.$name());return X},v.append_features=function(T,O){var re=v.ancestors(T),j=[];if(-1!==re.indexOf(O))throw v.ArgumentError.$new("cyclic include detected");for(var ve=0,de=re.length;ve<de;ve++){var ce=l(re[ve]);H(ce,"$$included",!0),j.push(ce)}var R,ie,he=v.ancestors(O),B=_(j);if(-1===he.indexOf(T))R=O.$$prototype,ie=Object.getPrototypeOf(O.$$prototype);else{for(var W=O.$$prototype,me=Object.getPrototypeOf(W);null!=me&&(me.$$module!==T||!b(me));)W=me,me=Object.getPrototypeOf(me);if(me){for(var $e=Object.getPrototypeOf(me);$e.hasOwnProperty("$$iclass")&&!b($e);)$e=Object.getPrototypeOf($e);R=W,ie=$e}else R=O.$$prototype,ie=Object.getPrototypeOf(O.$$prototype)}F(R,B.first),F(B.last,ie),O.$$own_included_modules=function C(T){for(var re,O=[],j=Object.getPrototypeOf(T.$$prototype);j&&!j.hasOwnProperty("$$class");)(re=x(j))&&O.push(re),j=Object.getPrototypeOf(j);return O}(O),v.const_cache_version++},v.prepend_features=function(T,O){var re=v.ancestors(T),j=[];if(-1!==re.indexOf(O))throw v.ArgumentError.$new("cyclic prepend detected");for(var ve=0,de=re.length;ve<de;ve++){var ce=l(re[ve]);H(ce,"$$prepended",!0),j.push(ce)}var ie,W,me,he=_(j),B=O.$$prototype,R=Object.getPrototypeOf(B);if(B.hasOwnProperty("$$dummy")?ie=B.$$define_methods_on:(ie=f(O),function u(T){for(var O=T.$$prototype,re=Object.getOwnPropertyNames(O),j=0;j<re.length;j++){var ve=re[j];v.is_method(ve)&&delete O[ve]}}(O),H(B,"$$dummy",!0),H(B,"$$define_methods_on",ie),F(B,ie),F(ie,R)),-1!==v.ancestors(O).indexOf(T))throw v.RuntimeError.$new("Prepending a module multiple times is not supported");for(W=B,me=Object.getPrototypeOf(B);null!=me&&!me.hasOwnProperty("$$root")&&me!==ie&&me.hasOwnProperty("$$iclass");)me=Object.getPrototypeOf(me);F(W,he.first),F(he.last,me),O.$$own_prepended_modules=function h(T){var re,O=[],j=Object.getPrototypeOf(T.$$prototype);if(T.$$prototype.hasOwnProperty("$$dummy"))for(;j&&j!==T.$$prototype.$$define_methods_on;)(re=x(j))&&O.push(re),j=Object.getPrototypeOf(j);return O}(O),v.const_cache_version++},v.bridge=function(T,O){if(T.hasOwnProperty("$$bridge"))throw v.ArgumentError.$new("already bridged");H(T,"$$bridge",O),F(T.prototype,(O.$$super||v.Object).$$prototype),H(O,"$$prototype",T.prototype),H(O.$$prototype,"$$class",O),H(O,"$$constructor",T),H(O,"$$bridge",!0)},v.ancestors=function(T){if(!T)return[];if(T.$$ancestors_cache_version===v.const_cache_version)return T.$$ancestors;var re,j,ve,O=[];for(re=0,j=function S(T){return T.$$own_prepended_modules.concat([T]).concat(T.$$own_included_modules)}(T),ve=j.length;re<ve;re++)O.push(j[re]);if(T.$$super)for(re=0,ve=(j=v.ancestors(T.$$super)).length;re<ve;re++)O.push(j[re]);return T.$$ancestors_cache_version=v.const_cache_version,T.$$ancestors=O,O},v.included_modules=function(T){for(var O=[],re=null,j=Object.getPrototypeOf(T.$$prototype);j&&Object.getPrototypeOf(j);j=Object.getPrototypeOf(j))(re=x(j))&&re.$$is_module&&j.$$iclass&&j.$$included&&O.push(re);return O},v.add_stubs=function(T){for(var re,j,O=v.BasicObject.$$prototype,ve=0,de=(T=T.split(",")).length;ve<de;ve++)(null==(j=O[re="$"+T[ve]])||j.$$stub)&&v.add_stub_for(O,re)},v.add_stub_for=function(T,O){H(T,O,v.stub_for(O))},v.stub_for=function(T){function O(){this.$method_missing.$$p=O.$$p,delete O.$$p;for(var re=new Array(arguments.length),j=0,ve=re.length;j<ve;j++)re[j]=arguments[j];return this.$method_missing.apply(this,[T.slice(1)].concat(re))}return O.$$stub=!0,O},v.ac=function(T,O,re,j){var ve="";throw ve+=re.$$is_a_module?re.$$name+".":re.$$class.$$name+"#",v.ArgumentError.$new("["+(ve+=j)+"] wrong number of arguments (given "+T+", expected "+O+")")},v.block_ac=function(T,O,re){throw v.ArgumentError.$new("`block in "+re+"': wrong number of arguments (given "+T+", expected "+O+")")},v.find_super=function(T,O,re,j,ve){for(var Ee,ce,de="$"+O,B=(Ee=T.hasOwnProperty("$$meta")?v.ancestors(T.$$meta):v.ancestors(T.$$class)).indexOf(re.$$owner)+1;B<Ee.length;B++){var ie=Ee[B].$$prototype;if(ie.hasOwnProperty("$$dummy")&&(ie=ie.$$define_methods_on),ie.hasOwnProperty(de)){ce=ie[de];break}}if(!j&&ce&&ce.$$stub&&T.$method_missing.$$pristine)throw v.NoMethodError.$new("super: no superclass method `"+O+"' for "+T,O);return ce.$$stub&&!ve?null:ce},v.find_block_super=function(T,O,re,j,ve){var de=O;if(!re)throw v.RuntimeError.$new("super called outside of method");if(ve&&re.$$define_meth)throw v.RuntimeError.$new("implicit argument passing of super from method defined by define_method() is not supported. Specify all arguments explicitly");return re.$$def&&(de=re.$$jsid),v.find_super(T,de,re,j)},v.find_super_dispatcher=v.find_super,v.find_iter_super_dispatcher=v.find_block_super,v.ret=function(T){throw v.returner.$v=T,v.returner},v.brk=function(T,O){throw O.$v=T,O},v.new_brk=function(){return new Error("unexpected break")},v.yield1=function(T,O){if("function"!=typeof T)throw v.LocalJumpError.$new("no block given");var j=T.$$has_trailing_comma_in_args;return(T.length>1||(T.$$has_top_level_mlhs_arg||j)&&1===T.length)&&(O=v.to_ary(O)),(T.length>1||j&&1===T.length)&&O.$$is_array?T.apply(null,O):T(O)},v.yieldX=function(T,O){if("function"!=typeof T)throw v.LocalJumpError.$new("no block given");if(T.length>1&&1===O.length&&O[0].$$is_array)return T.apply(null,O[0]);if(!O.$$is_array){for(var re=new Array(O.length),j=0,ve=re.length;j<ve;j++)re[j]=O[j];return T.apply(null,re)}return T.apply(null,O)},v.rescue=function(T,O){for(var re=0;re<O.length;re++){var j=O[re];if(j.$$is_array){var ve=v.rescue(T,j);if(ve)return ve}else{if(j===v.JS.Error)return j;if(j["$==="](T))return j}}return null},v.is_a=function(T,O){if(null!=O&&T.$$meta===O||T.$$class===O)return!0;if(T.$$is_number&&O.$$is_number_class)return!O.$$is_integer_class||T%1==0;var re,j,ve=v.ancestors(T.$$is_class?v.get_singleton_class(T):T.$$meta||T.$$class);for(re=0,j=ve.length;re<j;re++)if(ve[re]===O)return!0;return!1},v.to_hash=function(T){if(T.$$is_hash)return T;if(T["$respond_to?"]("to_hash",!0)){var O=T.$to_hash();if(O.$$is_hash)return O;throw v.TypeError.$new("Can't convert "+T.$$class+" to Hash ("+T.$$class+"#to_hash gives "+O.$$class+")")}throw v.TypeError.$new("no implicit conversion of "+T.$$class+" into Hash")},v.to_ary=function(T){if(T.$$is_array)return T;if(T["$respond_to?"]("to_ary",!0)){var O=T.$to_ary();if(O===X)return[T];if(O.$$is_array)return O;throw v.TypeError.$new("Can't convert "+T.$$class+" to Array ("+T.$$class+"#to_ary gives "+O.$$class+")")}return[T]},v.to_a=function(T){if(T.$$is_array)return T.slice();if(T["$respond_to?"]("to_a",!0)){var O=T.$to_a();if(O===X)return[T];if(O.$$is_array)return O;throw v.TypeError.$new("Can't convert "+T.$$class+" to Array ("+T.$$class+"#to_a gives "+O.$$class+")")}return[T]},v.extract_kwargs=function(T){var O=T[T.length-1];return null!=O&&v.respond_to(O,"$to_hash",!0)?(G.call(T,T.length-1),O.$to_hash()):v.hash2([],{})},v.kwrestargs=function(T,O){var ve,re=[],j={},de=T.$$smap;for(ve in de)O[ve]||(re.push(ve),j[ve]=de[ve]);return v.hash2(re,j)},v.send=function(T,O,re,j,ve){var de;if(Q(j,ve),"function"==typeof O)de=O,O=null;else{if("string"!=typeof O)throw v.NameError.$new("Passed method should be a string or a function");de=T["$"+O]}return v.send2(T,de,O,re,j)},v.send2=function(T,O,re,j,ve,de){return null==O&&null!=re&&T.$method_missing&&(O=T.$method_missing,j=[re].concat(j)),Q(ve,de),"function"==typeof ve&&(O.$$p=ve),O.apply(T,j)},v.refined_send=function(T,O,re,j,ve,de){var Ee,ce,he,B,R,ie,W,me,$e;for(B=O.hasOwnProperty("$$meta")?v.ancestors(O.$$meta):v.ancestors(O.$$class),Q(ve,de),Ee=0;Ee<B.length;Ee++)for(R=v.id(B[Ee]),ce=0;ce<T.length;ce++)for(he=(ie=T[ce]).length-1;he>=0;he--)if(void 0!==(W=ie[he]).$$refine_modules&&void 0!==(me=W.$$refine_modules)[R]&&void 0!==($e=me[R]).$$prototype["$"+re])return v.send2(O,$e.$$prototype["$"+re],re,j,ve);return v.send(O,re,j,ve)},v.lambda=function(T,O){return T.$$is_lambda=!0,Q(T,O),T},v.def=function(T,O,re,j){return Q(re,j),T===v.top?v.defn(v.Object,O,re):!T.$$eval&&T.$$is_a_module?v.defn(T,O,re):v.defs(T,O,re)},v.defn=function(T,O,re){re.displayName=O,re.$$owner=T;var j=O.substr(1),ve=T.$$prototype;if(ve.hasOwnProperty("$$dummy")&&(ve=ve.$$define_methods_on),H(ve,O,re),T.$$is_module){T.$$module_function&&v.defs(T,O,re);for(var de=0,Ee=T.$$iclasses,ce=Ee.length;de<ce;de++)H(Ee[de],O,re)}var B=T.$$singleton_of;return!T.$method_added||T.$method_added.$$stub||B?B&&B.$singleton_method_added&&!B.$singleton_method_added.$$stub&&B.$singleton_method_added(j):T.$method_added(j),j},v.defs=function(T,O,re,j){if(Q(re,j),T.$$is_string||T.$$is_number)throw v.TypeError.$new("can't define singleton");return v.defn(v.get_singleton_class(T),O,re)},v.rdef=function(T,O){if(!D.call(T.$$prototype,O))throw v.NameError.$new("method '"+O.substr(1)+"' not defined in "+T.$name());delete T.$$prototype[O],T.$$is_singleton?T.$$prototype.$singleton_method_removed&&!T.$$prototype.$singleton_method_removed.$$stub&&T.$$prototype.$singleton_method_removed(O.substr(1)):T.$method_removed&&!T.$method_removed.$$stub&&T.$method_removed(O.substr(1))},v.udef=function(T,O){if(!T.$$prototype[O]||T.$$prototype[O].$$stub)throw v.NameError.$new("method '"+O.substr(1)+"' not defined in "+T.$name());v.add_stub_for(T.$$prototype,O),T.$$is_singleton?T.$$prototype.$singleton_method_undefined&&!T.$$prototype.$singleton_method_undefined.$$stub&&T.$$prototype.$singleton_method_undefined(O.substr(1)):T.$method_undefined&&!T.$method_undefined.$$stub&&T.$method_undefined(O.substr(1))},v.alias=function(T,O,re){var de,Ee,j="$"+O,ve="$"+re;if(void 0===T.$$prototype&&(T=v.Object),de=T.$$prototype["$"+re],T.$$eval)return v.alias(v.get_singleton_class(T),O,re);if(!le(de)){for(var ce=T.$$super;"function"!=typeof de&&ce;)de=ce[ve],ce=ce.$$super;if(!le(de)&&T.$$is_module&&(de=v.Object.$$prototype[ve]),!le(de))throw v.NameError.$new("undefined method `"+re+"' for class `"+T.$name()+"'")}de.$$alias_of&&(de=de.$$alias_of),Ee=function(){var B,R,ie,he=Ee.$$p;for(B=new Array(arguments.length),R=0,ie=arguments.length;R<ie;R++)B[R]=arguments[R];return delete Ee.$$p,v.send(this,de,B,he)};try{Object.defineProperty(Ee,"length",{value:de.length})}catch(he){}return Ee.displayName=O,Ee.$$arity=de.$$arity,Ee.$$parameters=de.$$parameters,Ee.$$source_location=de.$$source_location,Ee.$$alias_of=de,Ee.$$alias_name=O,v.defn(T,j,Ee),T},v.alias_gvar=function(T,O){return Object.defineProperty(v.gvars,T,{configurable:!0,enumerable:!0,get:function(){return v.gvars[O]},set:function(re){v.gvars[O]=re}}),X},v.alias_native=function(T,O,re){var j="$"+O,ve=T.$$prototype[re];if("function"!=typeof ve||ve.$$stub)throw v.NameError.$new("undefined native method `"+re+"' for class `"+T.$name()+"'");return v.defn(T,j,ve),T},v.hash_init=function(T){T.$$smap=Object.create(null),T.$$map=Object.create(null),T.$$keys=[]},v.hash_clone=function(T,O){O.$$none=T.$$none,O.$$proc=T.$$proc;for(var Ee,ce,re=0,j=T.$$keys,ve=T.$$smap,de=j.length;re<de;re++)(Ee=j[re]).$$is_string?ce=ve[Ee]:(ce=Ee.value,Ee=Ee.key),v.hash_put(O,Ee,ce)},v.hash_put=function(T,O,re){if(O.$$is_string)return D.call(T.$$smap,O)||T.$$keys.push(O),void(T.$$smap[O]=re);var j,ve,de;if(j=T.$$by_identity?v.id(O):O.$hash(),!D.call(T.$$map,j))return T.$$keys.push(ve={key:O,key_hash:j,value:re}),void(T.$$map[j]=ve);for(ve=T.$$map[j];ve;){if(O===ve.key||O["$eql?"](ve.key)){de=void 0,ve.value=re;break}de=ve,ve=ve.next}de&&(T.$$keys.push(ve={key:O,key_hash:j,value:re}),de.next=ve)},v.hash_get=function(T,O){if(O.$$is_string)return D.call(T.$$smap,O)?T.$$smap[O]:void 0;var re,j;if(re=T.$$by_identity?v.id(O):O.$hash(),D.call(T.$$map,re))for(j=T.$$map[re];j;){if(O===j.key||O["$eql?"](j.key))return j.value;j=j.next}},v.hash_delete=function(T,O){var re,de,Ee,j=T.$$keys,ve=j.length;if(O.$$is_string){if("string"!=typeof O&&(O=O.valueOf()),!D.call(T.$$smap,O))return;for(re=0;re<ve;re++)if((Ee=j[re]).$$is_string&&"string"!=typeof Ee&&(Ee=Ee.valueOf()),Ee===O){j.splice(re,1);break}return de=T.$$smap[O],delete T.$$smap[O],de}var ce=O.$hash();if(D.call(T.$$map,ce))for(var B,he=T.$$map[ce];he;){if(O===he.key||O["$eql?"](he.key)){for(de=he.value,re=0;re<ve;re++)if(j[re]===he){j.splice(re,1);break}return B&&he.next?B.next=he.next:B?delete B.next:he.next?T.$$map[ce]=he.next:delete T.$$map[ce],de}B=he,he=he.next}},v.hash_rehash=function(T){for(var j,ve,de,O=0,re=T.$$keys.length;O<re;O++)if(!T.$$keys[O].$$is_string&&(j=T.$$keys[O].key.$hash())!==T.$$keys[O].key_hash){for(ve=T.$$map[T.$$keys[O].key_hash],de=void 0;ve;){if(ve===T.$$keys[O]){de&&ve.next?de.next=ve.next:de?delete de.next:ve.next?T.$$map[T.$$keys[O].key_hash]=ve.next:delete T.$$map[T.$$keys[O].key_hash];break}de=ve,ve=ve.next}if(T.$$keys[O].key_hash=j,!D.call(T.$$map,j)){T.$$map[j]=T.$$keys[O];continue}for(ve=T.$$map[j],de=void 0;ve;){if(ve===T.$$keys[O]){de=void 0;break}de=ve,ve=ve.next}de&&(de.next=T.$$keys[O])}},v.hash=function(){var O,re,j,ve,de,T=arguments.length;if(1===T&&arguments[0].$$is_hash)return arguments[0];if(re=new v.Hash,v.hash_init(re),1===T&&arguments[0].$$is_array){for(ve=(O=arguments[0]).length,j=0;j<ve;j++){if(2!==O[j].length)throw v.ArgumentError.$new("value not of length 2: "+O[j].$inspect());v.hash_put(re,de=O[j][0],O[j][1])}return re}if(1===T){for(de in O=arguments[0])D.call(O,de)&&v.hash_put(re,de,O[de]);return re}if(T%2!=0)throw v.ArgumentError.$new("odd number of arguments for Hash");for(j=0;j<T;j+=2)v.hash_put(re,de=arguments[j],arguments[j+1]);return re},v.hash2=function(T,O){var re=new v.Hash;return re.$$smap=O,re.$$map=Object.create(null),re.$$keys=T,re},v.range=function(T,O,re){var j=new v.Range;return j.begin=T,j.end=O,j.excl=re,j},v.ivar=function(T){return"constructor"===T||"displayName"===T||"__count__"===T||"__noSuchMethod__"===T||"__parent__"===T||"__proto__"===T||"hasOwnProperty"===T||"valueOf"===T?T+"$":T},v.escape_regexp=function(T){return T.replace(/([-[\]\/{}()*+?.^$\\| ])/g,"\\$1").replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r").replace(/[\f]/g,"\\f").replace(/[\t]/g,"\\t")},v.global_regexp=function(T){return T.global?T:(null==T.$$g?T.$$g=new RegExp(T.source,(T.multiline?"gm":"g")+(T.ignoreCase?"i":"")):T.$$g.lastIndex=null,T.$$g)},v.global_multiline_regexp=function(T){var O;if(T.multiline){if(T.global)return T;O=null!=T.$$g?T.$$g:T.$$g=new RegExp(T.source,"gm"+(T.ignoreCase?"i":""))}else O=null!=T.$$gm?T.$$gm:T.$$gm=new RegExp(T.source,"gm"+(T.ignoreCase?"i":""));return O.lastIndex=null,O},v.regexp=function(T,O){for(var re,j=void 0!==O&&O&&O.indexOf("i")>=0,ve=0,de=T.length;ve<de;ve++)(re=T[ve])instanceof RegExp&&(re.ignoreCase!==j&&v.Kernel.$warn("ignore case doesn't match for "+re.source.$inspect(),v.hash({uplevel:1})),re=re.source),""===re&&(re="(?:"+re+")"),T[ve]=re;return O?new RegExp(T.join(""),O):new RegExp(T.join(""))},v.modules={},v.loaded_features=["corelib/runtime"],v.current_dir=".",v.require_table={"corelib/runtime":!0},v.normalize=function(T){var O,re,j=[];"."!==v.current_dir&&(T=v.current_dir.replace(/\/*$/,"/")+T);for(var de=0,Ee=(O=(T=(T=T.replace(/^\.\//,"")).replace(/\.(rb|opal|js)$/,"")).split("/")).length;de<Ee;de++)""!==(re=O[de])&&(".."===re?j.pop():j.push(re));return j.join("/")},v.loaded=function(T){var O,re,j;for(O=0,re=T.length;O<re;O++)j=v.normalize(T[O]),!v.require_table[j]&&(v.loaded_features.push(j),v.require_table[j]=!0)},v.load=function(T){T=v.normalize(T),v.loaded([T]);var O=v.modules[T];if(O){var re=O(v);if("undefined"!=typeof Promise&&re instanceof Promise)return re.then(function(){return!0})}else{var j=v.config.missing_require_severity,ve="cannot load such file -- "+T;if("error"===j)throw v.LoadError?v.LoadError.$new(ve):ve;"warning"===j&&ae.warn("WARNING: LoadError: "+ve)}return!0},v.require=function(T){return T=v.normalize(T),!v.require_table[T]&&v.load(T)},v.encodings=Object.create(null),v.set_encoding=function(T,O,re){if(void 0===re&&(re="encoding"),"string"==typeof T||!0===T.$$frozen)throw v.FrozenError.$new("can't modify frozen String");var j=v.find_encoding(O);return j===T[re]||(T[re]=j),T},v.find_encoding=function(T){var O=v.encodings,re=O[T]||O[T.toUpperCase()];if(!re)throw v.ArgumentError.$new("unknown encoding name - "+T);return re},v.enc=function(T,O){var re=new String(T);return(re=v.set_encoding(re,O)).internal_encoding=re.encoding,re},v.binary=function(T){var O=new String(T);return v.set_encoding(O,"binary","internal_encoding")},v.last_promise=null,v.promise_unhandled_exception=!1,v.queue=function(T){if(v.last_promise)return v.last_promise=v.last_promise.then(function(){if(!v.promise_unhandled_exception)return T(v)}).catch(function(re){v.respond_to(re,"$full_message")&&(re=re.$full_message()),ae.error(re),v.promise_unhandled_exception=!0,v.exit(1)}),v.last_promise;var O=T(v);return"function"==typeof Promise&&"object"==typeof O&&O instanceof Promise&&(v.last_promise=O),O},v.rb_plus=function(T,O){return"number"==typeof T&&"number"==typeof O?T+O:T["$+"](O)},v.rb_minus=function(T,O){return"number"==typeof T&&"number"==typeof O?T-O:T["$-"](O)},v.rb_times=function(T,O){return"number"==typeof T&&"number"==typeof O?T*O:T["$*"](O)},v.rb_divide=function(T,O){return"number"==typeof T&&"number"==typeof O?T/O:T["$/"](O)},v.rb_lt=function(T,O){return"number"==typeof T&&"number"==typeof O?T<O:T["$<"](O)},v.rb_gt=function(T,O){return"number"==typeof T&&"number"==typeof O?T>O:T["$>"](O)},v.rb_le=function(T,O){return"number"==typeof T&&"number"==typeof O?T<=O:T["$<="](O)},v.rb_ge=function(T,O){return"number"==typeof T&&"number"==typeof O?T>=O:T["$>="](O)},v.eqeq=function(T,O){return"number"==typeof T&&"number"==typeof O||"string"==typeof T&&"string"==typeof O?T===O:se(T["$=="](O))},v.eqeqeq=function(T,O){return"number"==typeof T&&"number"==typeof O||"string"==typeof T&&"string"==typeof O?T===O:se(T["$==="](O))},v.neqeq=function(T,O){return"number"==typeof T&&"number"==typeof O||"string"==typeof T&&"string"==typeof O?T!==O:se(T["$!="](O))},v.not=function(T){return!0!==T&&(null==T||!1===T||X===T||se(T["$!"]()))},v.BasicObject=a=v.allocate_class("BasicObject",null),v.Object=y=v.allocate_class("Object",v.BasicObject),v.Module=w=v.allocate_class("Module",v.Object),v.Class=p=v.allocate_class("Class",v.Module),v.Opal=d=v.allocate_module("Opal"),v.Kernel=M=v.allocate_module("Kernel"),F(v.BasicObject,v.Class.$$prototype),F(v.Object,v.Class.$$prototype),F(v.Module,v.Class.$$prototype),F(v.Class,v.Class.$$prototype),a.$$const.BasicObject=a,A(y,"BasicObject",a),A(y,"Object",y),A(y,"Module",w),A(y,"Class",p),A(y,"Opal",d),A(y,"Kernel",M),a.$$class=p,y.$$class=p,w.$$class=p,p.$$class=p,d.$$class=w,M.$$class=w,H(y.$$prototype,"toString",function(){var T=this.$to_s();return T.$$is_string&&"object"==typeof T?T.valueOf():T}),H(y.$$prototype,"$require",v.require),v.top=new y,v.top.$to_s=v.top.$inspect=function(){return"main"},v.top.$define_method=function Ce(){var T=v.slice.call(arguments),O=Ce.$$p;return delete Ce.$$p,v.send(y,"define_method",T,O)},v.NilClass=v.allocate_class("NilClass",v.Object),A(y,"NilClass",v.NilClass),(X=v.nil=new v.NilClass).$$id=4,X.call=X.apply=function(){throw v.LocalJumpError.$new("no block given")},v.breaker=new Error("unexpected break (old)"),v.returner=new Error("unexpected return"),TypeError.$$super=Error}).call(this),Opal.loaded(["corelib/runtime.js"]),Opal.modules["corelib/helpers"]=function(E){var ae=E.nil,X=E.$$$,a=E.type_error,y=E.coerce_to,w=E.module,p=E.defs,d=E.eqeqeq,M=E.Kernel,v=E.truthy,D=E.Opal;return function($){var F=w("::","Opal");p(F,"$bridge",function(L,V){return E.bridge(L,V)},2),p(F,"$coerce_to!",function(L,V,H,se){var ue,Y=ae;return ue=E.slice.call(arguments,3),Y=y(L,V,H,ue),d(V,Y)||M.$raise(a(L,V,H,Y)),Y},-4),p(F,"$coerce_to?",function(L,V,H,se){var ee,Y=ae;return ee=E.slice.call(arguments,3),!v(L["$respond_to?"](H))||(Y=y(L,V,H,ee),v(Y["$nil?"]()))?ae:(d(V,Y)||M.$raise(a(L,V,H,Y)),Y)},-4),p(F,"$try_convert",function(L,V,H){return d(V,L)?L:v(L["$respond_to?"](H))?L.$__send__(H):ae},3),p(F,"$compare",function(L,V){var H;return H=L["$<=>"](V),v(H===ae)&&M.$raise(X("ArgumentError"),"comparison of "+L.$class()+" with "+V.$class()+" failed"),H},2),p(F,"$destructure",function(L){if(1==L.length)return L[0];if(L.$$is_array)return L;for(var V=new Array(L.length),H=0,se=V.length;H<se;H++)V[H]=L[H];return V},1),p(F,"$respond_to?",function(L,V,H){return null==H&&(H=!1),!(null==L||!L.$$class)&&L["$respond_to?"](V,H)},-3),p(F,"$instance_variable_name!",function(L){return L=D["$coerce_to!"](L,X("String"),"to_str"),v(/^@[a-zA-Z_][a-zA-Z0-9_]*?$/.test(L))||M.$raise(X("NameError").$new("'"+L+"' is not allowed as an instance variable name",L)),L},1),p(F,"$class_variable_name!",function(L){return L=D["$coerce_to!"](L,X("String"),"to_str"),v(L.length<3||"@@"!==L.slice(0,2))&&M.$raise(X("NameError").$new("`"+L+"' is not allowed as a class variable name",L)),L},1),p(F,"$const_name?",function(L){return"string"!=typeof L&&(L=D["$coerce_to!"](L,X("String"),"to_str")),L[0]===L[0].toUpperCase()},1),p(F,"$const_name!",function(L){return v(X("::","String","skip_raise")?"constant":ae)&&(L=D["$coerce_to!"](L,X("String"),"to_str")),(!L||L[0]!=L[0].toUpperCase())&&this.$raise(X("NameError"),"wrong constant name "+L),L},1),p(F,"$pristine",function(L,V){for(var se,ee,Y=(se=E.slice.call(arguments,1)).length-1;Y>=0;Y--)(ee=L.$$prototype["$"+se[Y]])&&!ee.$$stub&&(ee.$$pristine=!0);return ae},-2);var oe=[];return p(F,"$inspect",function(L){var H=!1;return function(){try{try{return null===L?"null":void 0===L?"undefined":void 0===L.$$class?Object.prototype.toString.apply(L):"function"!=typeof L.$inspect||L.$inspect.$$stub||-1!==oe.indexOf(L.$__id__())?"#<"+L.$$class+":0x"+L.$__id__().$to_s(16)+">":(oe.push(L.$__id__()),H=!0,L.$inspect())}catch(se){if(!E.rescue(se,[X("Exception")]))throw se;try{return"#<"+L.$$class+":0x"+L.$__id__().$to_s(16)+">"}finally{E.pop_exception()}}}finally{H&&oe.pop()}}()},-1)}()},Opal.modules["corelib/module"]=function(E){var P,g,b,C,X=E.nil,a=E.$$$,y=E.truthy,w=E.coerce_to,p=E.const_set,d=E.Object,M=E.klass,v=E.defs,D=E.send,$=E.def,F=E.eqeqeq,oe=E.Module,G=E.Kernel,L=E.rb_lt,V=E.rb_gt,H=E.to_a,se=E.hash2,ue=E.Opal,ee=E.eqeq,Y=E.lambda,ne=E.range,k=E.send2,q=E.find_super,z=E.alias;return P=[],g=M("::",null,"Module"),b=[g].concat(P),C=E.$r(b),v(g,"$allocate",function(){var l=E.allocate_module(X,function(){});return this!==E.Module&&Object.setPrototypeOf(l,this.$$prototype),l},0),$(g,"$initialize",function h(){var u=h.$$p||X;return delete h.$$p,u!==X?D(this,"module_eval",[],u.$to_proc()):X},0),$(g,"$===",function(u){return!y(null==u)&&E.is_a(u,this)},1),$(g,"$<",function(u){var _,x,S,l=this;if(F(oe,u)||G.$raise(a("TypeError"),"compared with non class/module"),l===u)return!1;for(x=0,S=(_=E.ancestors(l)).length;x<S;x++)if(_[x]===u)return!0;for(x=0,S=(_=E.ancestors(u)).length;x<S;x++)if(_[x]===l)return!1;return X},1),$(g,"$<=",function(u){var f;return y(f=this["$equal?"](u))?f:L(this,u)},1),$(g,"$>",function(u){return F(oe,u)||G.$raise(a("TypeError"),"compared with non class/module"),L(u,this)},1),$(g,"$>=",function(u){var f;return y(f=this["$equal?"](u))?f:V(this,u)},1),$(g,"$<=>",function(u){var f=X;return this===u?0:!F(oe,u)||(f=L(this,u),y(f["$nil?"]()))?X:y(f)?-1:1},1),$(g,"$alias_method",function(u,l){return u=w(u,a("String"),"to_str"),l=w(l,a("String"),"to_str"),E.alias(this,u,l),this},2),$(g,"$alias_native",function(u,l){return null==l&&(l=u),E.alias_native(this,u,l),this},-2),$(g,"$ancestors",function(){return E.ancestors(this)},0),$(g,"$append_features",function(u){return E.append_features(this,u),this},1),$(g,"$attr_accessor",function(u){var l,f,_=this;return l=E.slice.call(arguments),D(_,"attr_reader",H(f=l)),D(_,"attr_writer",H(f))},-1),$(g,"$attr",function(u){var f,_=this;return 2!=(f=E.slice.call(arguments)).length||!0!==f[1]&&!1!==f[1]?D(_,"attr_reader",H(f)):(_.$warn("optional boolean argument is obsoleted",se(["uplevel"],{uplevel:1})),f[1]?_.$attr_accessor(f[0]):_.$attr_reader(f[0]),X)},-1),$(g,"$attr_reader",function(u){var l,f,_=this;l=E.slice.call(arguments);for(var x=_.$$prototype,S=(f=l).length-1;S>=0;S--){var Q=f[S],le="$"+Q,Ce=E.ivar(Q),T=function(O){return function(){return null==this[O]?X:this[O]}}(Ce);E.prop(x,Ce,X),T.$$parameters=[],T.$$arity=0,E.defn(_,le,T)}return X},-1),$(g,"$attr_writer",function(u){var l,f,_=this;l=E.slice.call(arguments);for(var x=_.$$prototype,S=(f=l).length-1;S>=0;S--){var Q=f[S],le="$"+Q+"=",Ce=E.ivar(Q),T=function(O){return function(re){return this[O]=re}}(Ce);T.$$parameters=[["req"]],T.$$arity=1,E.prop(x,Ce,X),E.defn(_,le,T)}return X},-1),$(g,"$autoload",function(u,l){var f=this;return C("Opal")["$const_name?"](u)||G.$raise(a("NameError"),"autoload must be constant name: "+u),""==l&&G.$raise(a("ArgumentError"),"empty file name"),f.$$const.hasOwnProperty(u)||(f.$$autoload||(f.$$autoload={}),E.const_cache_version++,f.$$autoload[u]={path:l,loaded:!1,required:!1,success:!1,exception:!1}),X},2),$(g,"$autoload?",function(u){var l=this;if(l.$$autoload&&l.$$autoload[u]&&!l.$$autoload[u].required&&!l.$$autoload[u].success)return l.$$autoload[u].path;for(var f=l.$ancestors(),_=0,x=f.length;_<x;_++)if(f[_].$$autoload&&f[_].$$autoload[u]&&!f[_].$$autoload[u].required&&!f[_].$$autoload[u].success)return f[_].$$autoload[u].path;return X},1),$(g,"$class_variables",function(){return Object.keys(E.class_variables(this))},0),$(g,"$class_variable_get",function(u){return u=ue["$class_variable_name!"](u),E.class_variable_get(this,u,!1)},1),$(g,"$class_variable_set",function(u,l){return u=ue["$class_variable_name!"](u),E.class_variable_set(this,u,l)},2),$(g,"$class_variable_defined?",function(u){return u=ue["$class_variable_name!"](u),E.class_variables(this).hasOwnProperty(u)},1),$(g,"$remove_class_variable",function(u){var l=this;if(u=ue["$class_variable_name!"](u),E.hasOwnProperty.call(l.$$cvars,u)){var f=l.$$cvars[u];return delete l.$$cvars[u],f}G.$raise(a("NameError"),"cannot remove "+u+" for "+l)},1),$(g,"$constants",function(u){return null==u&&(u=!0),E.constants(this,u)},-1),v(g,"$constants",function(u){if(null==u){var _,S,Q,f=(this.$$nesting||[]).concat(d),x={};for(S=0,Q=f.length;S<Q;S++)for(_ in f[S].$$const)x[_]=!0;return Object.keys(x)}return E.constants(this,u)},-1),v(g,"$nesting",function(){return this.$$nesting||[]},0),$(g,"$const_defined?",function(u,l){var f=this;null==l&&(l=!0),u=C("Opal")["$const_name!"](u),y(u["$=~"](a(ue,"CONST_NAME_REGEXP")))||G.$raise(a("NameError").$new("wrong constant name "+u,u));var _,Q,le,x=[f];for(l&&(x=x.concat(E.ancestors(f)),f.$$is_module&&(x=x.concat([d]).concat(E.ancestors(d)))),Q=0,le=x.length;Q<le;Q++)if(null!=(_=x[Q]).$$const[u]||_.$$autoload&&_.$$autoload[u]&&!_.$$autoload[u].required&&!_.$$autoload[u].success)return!0;return!1},-2),$(g,"$const_get",function(u,l){var f=this;return null==l&&(l=!0),0===(u=C("Opal")["$const_name!"](u)).indexOf("::")&&"::"!==u&&(u=u.slice(2)),y(-1!=u.indexOf("::")&&"::"!=u)?D(u.$split("::"),"inject",[f],function(x,S){return null==x&&(x=X),null==S&&(S=X),x.$const_get(S)},2):(y(u["$=~"](a(ue,"CONST_NAME_REGEXP")))||G.$raise(a("NameError").$new("wrong constant name "+u,u)),l?E.$$([f],u):E.const_get_local(f,u))},-2),$(g,"$const_missing",function(u){var f;return f=ee(this,d)?u:this+"::"+u,G.$raise(a("NameError").$new("uninitialized constant "+f,u))},1),$(g,"$const_set",function(u,l){return u=ue["$const_name!"](u),(y(u["$!~"](a(ue,"CONST_NAME_REGEXP")))||y(u["$start_with?"]("::")))&&G.$raise(a("NameError").$new("wrong constant name "+u,u)),p(this,u,l),l},2),$(g,"$public_constant",function(u){return X},1),$(g,"$define_method",function h(u,l){var x,f=h.$$p||X,S=X;delete h.$$p,void 0===l&&f===X&&G.$raise(a("ArgumentError"),"tried to create a Proc object without a block"),f=y(x=f)?x:F(a("Proc"),S=l)?l:F(a("Method"),S)?l.$to_proc().$$unbound:F(a("UnboundMethod"),S)?Y(function le(Ce){var O,re=null==le.$$s?this:le.$$s,j=X;return O=E.slice.call(arguments),j=l.$bind(re),D(j,"call",H(O))},{$$arity:-1,$$s:this}):G.$raise(a("TypeError"),"wrong argument type "+f.$class()+" (expected Proc/Method)");var Q="$"+u;return f.$$jsid=u,f.$$s=null,f.$$def=f,f.$$define_meth=!0,E.defn(this,Q,f)},-2),$(g,"$remove_method",function(u){for(var f,_=this,x=0,S=(f=E.slice.call(arguments)).length;x<S;x++)E.rdef(_,"$"+f[x]);return _},-1),$(g,"$singleton_class?",function(){return!!this.$$is_singleton},0),$(g,"$include",function(u){for(var f,_=this,x=(f=E.slice.call(arguments)).length-1;x>=0;x--){var S=f[x];S.$$is_module||G.$raise(a("TypeError"),"wrong argument type "+S.$class()+" (expected Module)"),S.$append_features(_),S.$included(_)}return _},-1),$(g,"$included_modules",function(){return E.included_modules(this)},0),$(g,"$include?",function(u){u.$$is_module||G.$raise(a("TypeError"),"wrong argument type "+u.$class()+" (expected Module)");var f,_,x,S=E.ancestors(this);for(f=0,_=S.length;f<_;f++)if((x=S[f])===u&&x!==this)return!0;return!1},1),$(g,"$instance_method",function(u){var l=this,f=l.$$prototype["$"+u];return(!f||f.$$stub)&&G.$raise(a("NameError").$new("undefined method `"+u+"' for class `"+l.$name()+"'",u)),a("UnboundMethod").$new(l,f.$$owner||l,f,u)},1),$(g,"$instance_methods",function(u){return null==u&&(u=!0),y(u)?E.instance_methods(this):E.own_instance_methods(this)},-1),$(g,"$included",function(u){return X},1),$(g,"$extended",function(u){return X},1),$(g,"$extend_object",function(u){return X},1),$(g,"$method_added",function(u){return E.slice.call(arguments),X},-1),$(g,"$method_removed",function(u){return E.slice.call(arguments),X},-1),$(g,"$method_undefined",function(u){return E.slice.call(arguments),X},-1),$(g,"$module_eval",function h(u){var _,x,l=h.$$p||X,S=this,Q=X,T=X,O=X,re=X,j=X;delete h.$$p,_=E.slice.call(arguments),y(l["$nil?"]())&&y(!!E.compile)?(y(ne(1,3,!1)["$cover?"](_.$size()))||G.$raise(a("ArgumentError"),"wrong number of arguments (0 for 1..3)"),Q=null==(x=[].concat(H(_)))[0]?X:x[0],T=se(["file","eval"],{file:y(O=null==x[1]?X:x[1])?O:"(eval)",eval:!0}),re=E.hash({arity_check:!1}).$merge(T),j=ue.$compile(Q,re),l=D(G,"proc",[],function Ee(){var ce=null==Ee.$$s?this:Ee.$$s;return new Function("Opal,self","return "+j)(E,ce)},{$$arity:0,$$s:S})):y(_["$any?"]())&&G.$raise(a("ArgumentError"),"wrong number of arguments ("+_.$size()+" for 0)\n\n  NOTE:If you want to enable passing a String argument please add \"require 'opal-parser'\" to your script\n");var de,ve=l.$$s;return l.$$s=null,de=l.apply(S,[S]),l.$$s=ve,de},-1),$(g,"$module_exec",function h(u){var _,l=h.$$p||X,x=this;delete h.$$p,_=E.slice.call(arguments),l===X&&G.$raise(a("LocalJumpError"),"no block given");var Q,S=l.$$s;return l.$$s=null,Q=l.apply(x,_),l.$$s=S,Q},-1),$(g,"$method_defined?",function(u){var f=this.$$prototype["$"+u];return!!f&&!f.$$stub},1),$(g,"$module_function",function(u){var f,_=this;if(0===(f=E.slice.call(arguments)).length)return _.$$module_function=!0,X;for(var x=0,S=f.length;x<S;x++){var Q=f[x],le="$"+Q,Ce=_.$$prototype[le];E.defs(_,le,Ce)}return 1===f.length?f[0]:f},-1),$(g,"$name",function(){var u=this;if(u.$$full_name)return u.$$full_name;for(var l=[],f=u;f;){if(f.$$name===X||null==f.$$name)return X;if(l.unshift(f.$$name),(f=f.$$base_module)===d)break}return 0===l.length?X:u.$$full_name=l.join("::")},0),$(g,"$prepend",function(u){var f,_=this;0===(f=E.slice.call(arguments)).length&&G.$raise(a("ArgumentError"),"wrong number of arguments (given 0, expected 1+)");for(var x=f.length-1;x>=0;x--){var S=f[x];S.$$is_module||G.$raise(a("TypeError"),"wrong argument type "+S.$class()+" (expected Module)"),S.$prepend_features(_),S.$prepended(_)}return _},-1),$(g,"$prepend_features",function(u){var l=this;return l.$$is_module||G.$raise(a("TypeError"),"wrong argument type "+l.$class()+" (expected Module)"),E.prepend_features(l,u),l},1),$(g,"$prepended",function(u){return X},1),$(g,"$remove_const",function(u){return E.const_remove(this,u)},1),$(g,"$to_s",function(){var l,u=this;return y(l=E.Module.$name.call(u))?l:"#<"+(u.$$is_module?"Module":"Class")+":0x"+u.$__id__().$to_s(16)+">"},0),$(g,"$undef_method",function(u){for(var f,_=this,x=0,S=(f=E.slice.call(arguments)).length;x<S;x++)E.udef(_,"$"+f[x]);return _},-1),$(g,"$instance_variables",function(){var u=this,l=X;E.Module.$$nesting=b,l=u.$constants();var f=[];for(var _ in u)u.hasOwnProperty(_)&&"$"!==_.charAt(0)&&"constructor"!==_&&!l["$include?"](_)&&f.push("@"+_);return f},0),$(g,"$dup",function h(){var u=h.$$p||X,l=this,f=X;return delete h.$$p,(f=k(l,q(l,"dup",h,!1,!0),"dup",[],u)).$copy_class_variables(l),f.$copy_constants(l),f},0),$(g,"$copy_class_variables",function(u){for(var f in u.$$cvars)this.$$cvars[f]=u.$$cvars[f]},1),$(g,"$copy_constants",function(u){var f,_=u.$$const;for(f in _)p(this,f,_[f])},1),$(g,"$refine",function h(u){var f,x,Q,l=h.$$p||X,_=this,S=X;return delete h.$$p,x=(f=[_,X,X])[0],S=f[1],Q=E.id(u),void 0===_.$$refine_modules&&(_.$$refine_modules={}),(S=void 0===_.$$refine_modules[Q]?_.$$refine_modules[Q]=a("Refinement").$new():_.$$refine_modules[Q]).refinement_module=x,S.refined_class=u,D(S,"class_exec",[],l.$to_proc()),S},1),$(g,"$using",function(u){return G.$raise("Module#using is not permitted in methods")},1),z(g,"class_eval","module_eval"),z(g,"class_exec","module_exec"),z(g,"inspect","to_s"),function(A,N){var P=M("::",N,"Refinement"),g=P.$$prototype;return g.refinement_module=g.refined_class=X,$(P,"$inspect",function b(){var C=b.$$p||X,h=this;return delete b.$$p,y(h.refinement_module)?"#<refinement:"+h.refined_class.$inspect()+"@"+h.refinement_module.$inspect()+">":k(h,q(h,"inspect",b,!1,!0),"inspect",[],C)},0)}(0,oe)},Opal.modules["corelib/class"]=function(E){var G,L,V,H,a=E.nil,y=E.klass,w=E.send,p=E.defs,d=E.def,M=E.rb_plus,v=E.send2,D=E.find_super,$=E.alias;return E.top.$require("corelib/module"),G=[],V=[L=y("::",null,"Class")].concat(G),H=E.$r(V),p(L,"$new",function se(ue){var ee=se.$$p||a;if(delete se.$$p,null==ue&&(ue=H("Object")),!ue.$$is_class)throw E.TypeError.$new("superclass must be a Class");var Y=E.allocate_class(a,ue);return ue.$inherited(Y),ee!==a&&w(Y,"class_eval",[],ee.$to_proc()),Y},-1),d(L,"$allocate",function(){var ee=new this.$$constructor;return ee.$$id=E.uid(),ee},0),d(L,"$descendants",function(){return M(this.$subclasses(),w(this.$subclasses(),"map",[],"descendants".$to_proc()).$flatten())},0),d(L,"$inherited",function(ue){return a},1),d(L,"$initialize_dup",function(ue){this.$initialize_copy(ue),this.$$name=null,this.$$full_name=null},1),d(L,"$new",function se(ue){var ne,ee=se.$$p||a,k=this;delete se.$$p,ne=E.slice.call(arguments);var q=k.$allocate();return E.send(q,q.$initialize,ne,ee),q},-1),d(L,"$subclasses",function(){if("undefined"!=typeof WeakRef){var ee,Y,ne=[];for(ee=0;ee<this.$$subclasses.length;ee++)void 0!==(Y=this.$$subclasses[ee].deref())&&ne.push(Y);return ne}return this.$$subclasses},0),d(L,"$superclass",function(){return this.$$super||a},0),d(L,"$to_s",function se(){delete se.$$p;var Y=this.$$singleton_of;return Y&&Y.$$is_a_module?"#<Class:"+Y.$name()+">":Y?"#<Class:#<"+Y.$$class.$name()+":0x"+E.id(Y).$to_s(16)+">>":v(this,D(this,"to_s",se,!1,!0),"to_s",[],null)},0),$(L,"inspect","to_s")},Opal.modules["corelib/basic_object"]=function(E){"use strict";var H,ae=E.nil,X=E.$$$,y=E.def,w=E.alias,p=E.truthy,d=E.range,M=E.Kernel,v=E.to_a,D=E.hash2,$=E.Opal,F=E.send,oe=E.eqeq,G=E.rb_ge;return y(H=(0,E.klass)("::",null,"BasicObject"),"$initialize",function(ue){return E.slice.call(arguments),ae},-1),y(H,"$==",function(ue){return this===ue},1),y(H,"$eql?",function(ue){return this["$=="](ue)},1),w(H,"equal?","=="),y(H,"$__id__",function(){return null!=this.$$id||E.prop(this,"$$id",E.uid()),this.$$id},0),y(H,"$__send__",function se(ue,ee){var k,Y=se.$$p||ae,q=this;delete se.$$p,k=E.slice.call(arguments,1),ue.$$is_string||q.$raise(X("TypeError"),q.$inspect()+" is not a symbol nor a string");var z=q["$"+ue];return z?(Y!==ae&&(z.$$p=Y),z.apply(q,k)):(Y!==ae&&(q.$method_missing.$$p=Y),q.$method_missing.apply(q,[ue].concat(k)))},-2),y(H,"$!",function(){return!1},0),y(H,"$!=",function(ue){return this["$=="](ue)["$!"]()},1),y(H,"$instance_eval",function se(ue){var ne,k,ee=se.$$p||ae,q=this,z=ae,P=ae,g=ae,b=ae,C=ae;if(delete se.$$p,ne=E.slice.call(arguments),p(ee["$nil?"]())&&p(!!E.compile))p(d(1,3,!1)["$cover?"](ne.$size()))||M.$raise(X("ArgumentError"),"wrong number of arguments (0 for 1..3)"),z=null==(k=[].concat(v(ne)))[0]?ae:k[0],P=D(["file","eval"],{file:p(g=null==k[1]?ae:k[1])?g:"(eval)",eval:!0}),b=E.hash({arity_check:!1}).$merge(P),C=$.$compile(z,b),ee=F(M,"proc",[],function l(){var f=null==l.$$s?this:l.$$s;return new Function("Opal,self","return "+C)(E,f)},{$$arity:0,$$s:q});else{if(p(ee["$nil?"]())&&p(G(ne.$length(),1))&&oe(ne.$first()["$[]"](0),"@"))return q.$instance_variable_get(ne.$first());p(ne["$any?"]())&&M.$raise(X("ArgumentError"),"wrong number of arguments ("+ne.$size()+" for 0)")}var u,h=ee.$$s;if(ee.$$s=null,q.$$is_a_module){q.$$eval=!0;try{u=ee.call(q,q)}finally{q.$$eval=!1}}else u=ee.call(q,q);return ee.$$s=h,u},-1),y(H,"$instance_exec",function se(ue){var ne,ee=se.$$p||ae,k=this;delete se.$$p,ne=E.slice.call(arguments),p(ee)||M.$raise(X("ArgumentError"),"no block given");var z,q=ee.$$s;if(ee.$$s=null,k.$$is_a_module){k.$$eval=!0;try{z=ee.apply(k,ne)}finally{k.$$eval=!1}}else z=ee.apply(k,ne);return ee.$$s=q,z},-1),y(H,"$singleton_method_added",function(ue){return E.slice.call(arguments),ae},-1),y(H,"$singleton_method_removed",function(ue){return E.slice.call(arguments),ae},-1),y(H,"$singleton_method_undefined",function(ue){return E.slice.call(arguments),ae},-1),y(H,"$method_missing",function se(ue,ee){var k,q=this,z=ae;return delete se.$$p,k=E.slice.call(arguments,1),z=$.$inspect(q),M.$raise(X("NoMethodError").$new("undefined method `"+ue+"' for "+z,ue,k),ae,M.$caller(1))},-2),$.$pristine(H,"method_missing"),y(H,"$respond_to_missing?",function(ue,ee){return null==ee&&(ee=!1),!1},-2)},Opal.modules["corelib/kernel"]=function(E){"use strict";var z,X=E.nil,a=E.$$$,y=E.truthy,w=E.coerce_to,p=E.respond_to,d=E.Opal,M=E.module,v=E.def,D=E.Kernel,$=E.gvars,F=E.hash2,oe=E.send,G=E.to_a,L=E.rb_plus,V=E.eqeq,H=E.eqeqeq,se=E.rb_le,ue=E.rb_lt,ee=E.Object,Y=E.alias,ne=E.klass;return function(k,q){var z=M("::","Kernel"),A=[z].concat([]),N=E.$r(A);v(z,"$=~",function(b){return!1},1),v(z,"$!~",function(b){return this["$=~"](b)["$!"]()},1),v(z,"$===",function(b){var h;return y(h=this.$object_id()["$=="](b.$object_id()))?h:this["$=="](b)},1),v(z,"$<=>",function(b){this.$$comparable=!0;var h=this["$=="](b);return h&&h!==X?0:X},1),v(z,"$method",function(b){var C=this,h=C["$"+b];return(!h||h.$$stub)&&D.$raise(a("NameError").$new("undefined method `"+b+"' for class `"+C.$class()+"'",b)),a("Method").$new(C,h.$$owner||C.$class(),h,b)},1),v(z,"$methods",function(b){return null==b&&(b=!0),y(b)?E.methods(this):E.own_methods(this)},-1),v(z,"$public_methods",function(b){return null==b&&(b=!0),y(b)?E.methods(this):E.receiver_methods(this)},-1),v(z,"$Array",function(b){var C;return b===X?[]:b.$$is_array?b:(C=d["$coerce_to?"](b,a("Array"),"to_ary"))!==X||(C=d["$coerce_to?"](b,a("Array"),"to_a"))!==X?C:[b]},1),v(z,"$at_exit",function g(){var C,b=g.$$p||X;return null==$.__at_exit__&&($.__at_exit__=X),delete g.$$p,$.__at_exit__=y(C=$.__at_exit__)?C:[],$.__at_exit__["$<<"](b),b},0),v(z,"$caller",function(b,C){var h,u;null==b&&(b=1),null==C&&(C=X),u=[];for(var l=b+1,f=(h=(new Error).$backtrace()).length;l<f;l++)h[l].match(/runtime\.js/)||u.push(h[l]);return C!=X&&(u=u.slice(0,C)),u},-1),v(z,"$class",function(){return this.$$class},0),v(z,"$copy_instance_variables",function(b){var u,l,f,h=Object.keys(b);for(u=0,l=h.length;u<l;u++)"$"!==(f=h[u]).charAt(0)&&b.hasOwnProperty(f)&&(this[f]=b[f])},1),v(z,"$copy_singleton_methods",function(b){var h,u,l,f;if(b.hasOwnProperty("$$meta")){var _=E.get_singleton_class(b),x=E.get_singleton_class(this);for(h=0,f=(l=Object.getOwnPropertyNames(_.$$prototype)).length;h<f;h++)E.is_method(u=l[h])&&(x.$$prototype[u]=_.$$prototype[u]);x.$$const=Object.assign({},_.$$const),Object.setPrototypeOf(x.$$prototype,Object.getPrototypeOf(_.$$prototype))}for(h=0,f=(l=Object.getOwnPropertyNames(b)).length;h<f;h++)"$"===(u=l[h]).charAt(0)&&"$"!==u.charAt(1)&&b.hasOwnProperty(u)&&(this[u]=b[u])},1),v(z,"$clone",function(b){var h=this,u=X;if(null==b)b=F([],{});else if(!b.$$is_hash)throw E.ArgumentError.$new("expected kwargs");return(u=h.$class().$allocate()).$copy_instance_variables(h),u.$copy_singleton_methods(h),u.$initialize_clone(h),u},-1),v(z,"$initialize_clone",function(b){return this.$initialize_copy(b)},1),v(z,"$define_singleton_method",function g(b,C){var h=g.$$p||X;return delete g.$$p,oe(this.$singleton_class(),"define_method",[b,C],h.$to_proc())},-2),v(z,"$dup",function(){var b=this,C=X;return(C=b.$class().$allocate()).$copy_instance_variables(b),C.$initialize_dup(b),C},0),v(z,"$initialize_dup",function(b){return this.$initialize_copy(b)},1),v(z,"$enum_for",function g(b,C){var u,l,f,h=g.$$p||X,_=this;return delete g.$$p,(u=E.slice.call(arguments)).length>0&&(l=u.shift()),null==l&&(l="each"),f=u,oe(a("Enumerator"),"for",[_,l].concat(G(f)),h.$to_proc())},-1),v(z,"$equal?",function(b){return this===b},1),v(z,"$exit",function(b){var h;for(null==$.__at_exit__&&($.__at_exit__=X),null==b&&(b=!0),$.__at_exit__=y(h=$.__at_exit__)?h:[];!y($.__at_exit__["$empty?"]());)$.__at_exit__.$pop().$call();return b=b.$$is_boolean?b?0:1:w(b,a("Integer"),"to_int"),E.exit(b),X},-1),v(z,"$extend",function(b){var h,u=this;h=E.slice.call(arguments);for(var l=u.$singleton_class(),f=h.length-1;f>=0;f--){var _=h[f];_.$$is_module||D.$raise(a("TypeError"),"wrong argument type "+_.$class()+" (expected Module)"),_.$append_features(l),_.$extend_object(u),_.$extended(u)}return u},-1),v(z,"$gets",function(b){var C;return null==$.stdin&&($.stdin=X),C=E.slice.call(arguments),oe($.stdin,"gets",G(C))},-1),v(z,"$hash",function(){return this.$__id__()},0),v(z,"$initialize_copy",function(b){return X},1);var P=[];v(z,"$inspect",function(){var b=this,C=X,h=X,u=X;return function(){try{try{return C="",h=b.$__id__(),y(P["$include?"](h))?C=" ...":(P["$<<"](h),u=!0,oe(b.$instance_variables(),"each",[],function f(_){var S,Q;return null==_&&(_=X),S=(null==f.$$s?this:f.$$s).$instance_variable_get(_),Q=N("Opal").$inspect(S),C=L(C," "+_+"="+Q)},{$$arity:1,$$s:b})),"#<"+b.$class()+":0x"+h.$to_s(16)+C+">"}catch(f){if(!E.rescue(f,[N("StandardError")]))throw f;try{return"#<"+b.$class()+":0x"+h.$to_s(16)+">"}finally{E.pop_exception()}}}finally{y(u)&&P.$pop()}}()},0),v(z,"$instance_of?",function(b){return!b.$$is_class&&!b.$$is_module&&D.$raise(a("TypeError"),"class or module required"),this.$$class===b},1),v(z,"$instance_variable_defined?",function(b){return b=d["$instance_variable_name!"](b),E.hasOwnProperty.call(this,b.substr(1))},1),v(z,"$instance_variable_get",function(b){b=d["$instance_variable_name!"](b);var h=this[E.ivar(b.substr(1))];return null==h?X:h},1),v(z,"$instance_variable_set",function(b,C){return b=d["$instance_variable_name!"](b),this[E.ivar(b.substr(1))]=C},2),v(z,"$remove_instance_variable",function(b){var C=this;b=d["$instance_variable_name!"](b);var u,h=E.ivar(b.substr(1));return C.hasOwnProperty(h)?(u=C[h],delete C[h],u):D.$raise(a("NameError"),"instance variable "+b+" not defined")},1),v(z,"$instance_variables",function(){var h,C=[];for(var u in this)this.hasOwnProperty(u)&&"$"!==u.charAt(0)&&(h="$"===u.substr(-1)?u.slice(0,u.length-1):u,C.push("@"+h));return C},0),v(z,"$Integer",function(b,C){var h,u,l;return b.$$is_string?"0"===b?0:(void 0===C?C=0:(1===(C=w(C,a("Integer"),"to_int"))||C<0||C>36)&&D.$raise(a("ArgumentError"),"invalid radix "+C),u=(u=(u=b.toLowerCase()).replace(/(\d)_(?=\d)/g,"$1")).replace(/^(\s*[+-]?)(0[bodx]?)/,function(f,_,x){switch(x){case"0b":if(0===C||2===C)return C=2,_;case"0":case"0o":if(0===C||8===C)return C=8,_;case"0d":if(0===C||10===C)return C=10,_;case"0x":if(0===C||16===C)return C=16,_}D.$raise(a("ArgumentError"),'invalid value for Integer(): "'+b+'"')}),l="0-"+((C=0===C?10:C)<=10?C-1:"9a-"+String.fromCharCode(C-11+97)),new RegExp("^\\s*[+-]?["+l+"]+\\s*$").test(u)||D.$raise(a("ArgumentError"),'invalid value for Integer(): "'+b+'"'),h=parseInt(u,C),isNaN(h)&&D.$raise(a("ArgumentError"),'invalid value for Integer(): "'+b+'"'),h):(void 0!==C&&D.$raise(a("ArgumentError"),"base specified for non string value"),b===X&&D.$raise(a("TypeError"),"can't convert nil into Integer"),b.$$is_number?((b===1/0||b===-1/0||isNaN(b))&&D.$raise(a("FloatDomainError"),b),Math.floor(b)):b["$respond_to?"]("to_int")&&(h=b.$to_int())!==X?h:d["$coerce_to!"](b,a("Integer"),"to_i"))},-2),v(z,"$Float",function(b){var C;return b===X&&D.$raise(a("TypeError"),"can't convert nil into Float"),b.$$is_string?(C=(C=b.toString()).replace(/(\d)_(?=\d)/g,"$1"),/^\s*[-+]?0[xX][0-9a-fA-F]+\s*$/.test(C)?D.$Integer(C):(/^\s*[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?\s*$/.test(C)||D.$raise(a("ArgumentError"),'invalid value for Float(): "'+b+'"'),parseFloat(C))):d["$coerce_to!"](b,a("Float"),"to_f")},1),v(z,"$Hash",function(b){return y(b["$nil?"]())||V(b,[])?F([],{}):H(a("Hash"),b)?b:d["$coerce_to!"](b,a("Hash"),"to_hash")},1),v(z,"$is_a?",function(b){return!b.$$is_class&&!b.$$is_module&&D.$raise(a("TypeError"),"class or module required"),E.is_a(this,b)},1),v(z,"$itself",function(){return this},0),v(z,"$lambda",function g(){var b=g.$$p||X;return delete g.$$p,E.lambda(b)},0),v(z,"$load",function(b){return b=d["$coerce_to!"](b,a("String"),"to_str"),E.load(b)},1),v(z,"$loop",function g(){var C=g.$$p||X,u=X;if(delete g.$$p,C===X)return oe(this,"enum_for",["loop"],function(){return a(a("Float"),"INFINITY")},0);for(;y(!0);)try{E.yieldX(C,[])}catch(l){if(!E.rescue(l,[a("StopIteration")]))throw l;u=l;try{return u.$result()}finally{E.pop_exception()}}return this},0),v(z,"$nil?",function(){return!1},0),v(z,"$printf",function(b){var C,h,u=this;return C=E.slice.call(arguments),y((h=C)["$any?"]())&&u.$print(oe(u,"format",G(h))),X},-1),v(z,"$proc",function g(){var b=g.$$p||X;return delete g.$$p,y(b)||D.$raise(a("ArgumentError"),"tried to create Proc object without a block"),b.$$is_lambda=!1,b},0),v(z,"$puts",function(b){var C;return null==$.stdout&&($.stdout=X),C=E.slice.call(arguments),oe($.stdout,"puts",G(C))},-1),v(z,"$p",function(b){var C,h;return C=E.slice.call(arguments),oe(h=C,"each",[],function(l){return null==$.stdout&&($.stdout=X),null==l&&(l=X),$.stdout.$puts(l.$inspect())},1),y(se(h.$length(),1))?h["$[]"](0):h},-1),v(z,"$print",function(b){var C;return null==$.stdout&&($.stdout=X),C=E.slice.call(arguments),oe($.stdout,"print",G(C))},-1),v(z,"$readline",function(b){var C;return null==$.stdin&&($.stdin=X),C=E.slice.call(arguments),oe($.stdin,"readline",G(C))},-1),v(z,"$warn",function(b,C){var h,u,l,f,_,x,S=this,Q=X;if(null==$.VERBOSE&&($.VERBOSE=X),null==$.stderr&&($.stderr=X),h=E.slice.call(arguments),null==(u=E.extract_kwargs(h)))u=F([],{});else if(!u.$$is_hash)throw E.ArgumentError.$new("expected kwargs");return l=h,null==(f=u.$$smap.uplevel)&&(f=X),y(f)&&(f=d["$coerce_to!"](f,a("Integer"),"to_str"),y(ue(f,0))&&D.$raise(a("ArgumentError"),"negative level ("+f+")"),x=(_=S.$caller(L(f,1),1).$first())===X||null==_?X:oe(_,"split",[":in `"]),Q=x===X||null==x?X:oe(x,"first",[]),y(Q)&&(Q+=": "),l=oe(l,"map",[],function(Ce){return null==Ce&&(Ce=X),Q+"warning: "+Ce},1)),y($.VERBOSE["$nil?"]())||y(l["$empty?"]())?X:oe($.stderr,"puts",G(l))},-1),v(z,"$raise",function(b,C,h){throw null==$["!"]&&($["!"]=X),null==$["@"]&&($["@"]=X),null==C&&(C=X),null==h&&(h=X),null==b&&$["!"]!==X?$["!"]:(null==b?b=a("RuntimeError").$new(""):p(b,"$to_str")?b=a("RuntimeError").$new(b.$to_str()):b.$$is_class&&p(b,"$exception")?b=b.$exception(C):b.$$is_exception||(b=a("TypeError").$new("exception class/object expected")),h!==X&&b.$set_backtrace(h),$["!"]!==X&&E.exceptions.push($["!"]),$["!"]=b,$["@"]=b.$backtrace(),b)},-1),v(z,"$rand",function(b){return void 0===b?a(a("Random"),"DEFAULT").$rand():(b.$$is_number&&(b<0&&(b=Math.abs(b)),b%1!=0&&(b=b.$to_i()),0===b&&(b=void 0)),a(a("Random"),"DEFAULT").$rand(b))},-1),v(z,"$respond_to?",function(b,C){var h=this;null==C&&(C=!1);var u=h["$"+b];return"function"==typeof u&&!u.$$stub||!0!==h["$respond_to_missing?"].$$pristine&&h["$respond_to_missing?"](b,C)},-2),v(z,"$respond_to_missing?",function(b,C){return null==C&&(C=!1),!1},-2),d.$pristine(z,"respond_to?","respond_to_missing?"),v(z,"$require",function(b){return"string"!=typeof b&&E.String&&E.Array&&(b=d["$coerce_to!"](b,a("String"),"to_str")),E.require(b)},1),v(z,"$require_relative",function(b){return d["$try_convert!"](b,a("String"),"to_str"),b=a("File").$expand_path(a("File").$join(E.current_file,"..",b)),E.require(b)},1),v(z,"$require_tree",function(b,C){var h;if(null==C)C=F([],{});else if(!C.$$is_hash)throw E.ArgumentError.$new("expected kwargs");null==(h=C.$$smap.autoload)&&(h=!1);var u=[];for(var l in b=a("File").$expand_path(b),"."===(b=E.normalize(b))&&(b=""),E.modules)l["$start_with?"](b)&&u.push(h?[l,!0]:[l,E.require(l)]);return u},-2),v(z,"$singleton_class",function(){return E.get_singleton_class(this)},0),v(z,"$sleep",function(b){null==b&&(b=X),b===X&&D.$raise(a("TypeError"),"can't convert NilClass into time interval"),b.$$is_number||D.$raise(a("TypeError"),"can't convert "+b.$class()+" into time interval"),b<0&&D.$raise(a("ArgumentError"),"time interval must be positive");for(var C=E.global.performance?function(){return performance.now()}:function(){return new Date},h=C();C()-h<=1e3*b;);return Math.round(b)},-1),v(z,"$srand",function(b){return null==b&&(b=N("Random").$new_seed()),a("Random").$srand(b)},-1),v(z,"$String",function(b){var C;return y(C=d["$coerce_to?"](b,a("String"),"to_str"))?C:d["$coerce_to!"](b,a("String"),"to_s")},1),v(z,"$tap",function g(){var b=g.$$p||X;return delete g.$$p,E.yield1(b,this),this},0),v(z,"$to_proc",function(){return this},0),v(z,"$to_s",function(){return"#<"+this.$class()+":0x"+this.$__id__().$to_s(16)+">"},0),v(z,"$catch",function g(b){var C=g.$$p||X,h=X,u=X;delete g.$$p,null==b&&(b=X);try{return b=y(h=b)?h:ee.$new(),E.yield1(C,b)}catch(l){if(!E.rescue(l,[a("UncaughtThrowError")]))throw l;u=l;try{return V(u.$tag(),b)?u.$value():D.$raise()}finally{E.pop_exception()}}},-1),v(z,"$throw",function(b,C){return null==C&&(C=X),D.$raise(a("UncaughtThrowError").$new(b,C))},-2),v(z,"$open",function g(b){var u,C=g.$$p||X;return delete g.$$p,u=E.slice.call(arguments),oe(a("File"),"open",G(u),C.$to_proc())},-1),v(z,"$yield_self",function g(){var b=g.$$p||X;return delete g.$$p,b===X?oe(this,"enum_for",["yield_self"],function(){return 1},0):E.yield1(b,this)},0),Y(z,"fail","raise"),Y(z,"kind_of?","is_a?"),Y(z,"object_id","__id__"),Y(z,"public_send","__send__"),Y(z,"send","__send__"),Y(z,"then","yield_self"),Y(z,"to_enum","enum_for")}(),z=ne("::",null,"Object"),delete ee.$$prototype.$require,z.$include(D)},Opal.modules["corelib/main"]=function(E){var d,y=E.def,w=E.Object,p=E.Kernel;return y(d=E.get_singleton_class(E.top),"$to_s",function(){return"main"},0),y(d,"$include",function(D){return w.$include(D)},1),y(d,"$autoload",function(D){var $;return $=E.slice.call(arguments),E.Object.$autoload.apply(E.Object,$)},-1),y(d,"$using",function(D){return p.$raise("main.using is permitted only at toplevel")},1)},Opal.modules["corelib/error/errno"]=function(E){var F,oe,G,ae=[],X=E.nil,a=E.$$$,y=E.module,w=E.truthy,p=E.rb_plus,d=E.send2,M=E.find_super,v=E.def,D=E.klass;return function($,F){var L,H,oe=y("::","Errno"),V=([oe].concat(F),X);for(L=[["EINVAL","Invalid argument",22],["EEXIST","File exists",17],["EISDIR","Is a directory",21],["EMFILE","Too many open files",24],["EACCES","Permission denied",13],["EPERM","Operation not permitted",1],["ENOENT","No such file or directory",2]],V=X,H=0;H<L.length;H++)!function(){var Y,ue=L[H][1],ee=L[H][2];(V=E.klass(oe,E.SystemCallError,L[H][0])).errno=ee,Y=E.get_singleton_class(V),v(Y,"$new",function k(q){var N=X;return delete k.$$p,null==q&&(q=X),N=ue,w(q)&&(N=p(N," - "+q)),d(this,M(this,"new",k,!1,!0),"new",[N],null)},-1)}()}(0,ae),F=a("StandardError"),oe=ae,[G=D("::",F,"SystemCallError")].concat(oe),v(G,"$errno",function(){return this.$class().$errno()},0),E.get_singleton_class(G).$attr_reader("errno")},Opal.modules["corelib/error"]=function(E){var Y,ne,ae=[],X=E.nil,a=E.$$$,y=E.klass,w=E.gvars,p=E.defs,d=E.send,M=E.to_a,v=E.def,D=E.truthy,$=E.hash2,F=E.Kernel,oe=E.not,G=E.rb_plus,L=E.eqeq,V=E.Object,H=E.send2,se=E.find_super,ue=E.module;return function(ee,Y,ne){var N,k=y("::",Y,"Exception"),q=[k].concat(ne),z=E.$r(q);function P(g){for(var C,b=[],h=0;h<g.length;h++){var u=g[h];!u||!u.$$is_string||((C=u.match(/^    at (.*?) \((.*?)\)$/))?b.push(C[2]+":in `"+C[1]+"'"):(C=u.match(/^    at (.*?)$/))?b.push(C[1]+":in `undefined'"):(C=u.match(/^  from (.*?)$/))?b.push(C[1]):(C=u.match(/^(.*?)@(.*?)$/))&&b.push(C[2]+":in `"+C[1]+"'"))}return b}k.$$prototype.message=X,E.prop(k.$$prototype,"$$is_exception",!0),p(k,"$new",function(b){var h,u=this;null==w["!"]&&(w["!"]=X);var l=(h=E.slice.call(arguments)).length>0?h[0]:X,f=new u.$$constructor(l);return f.name=u.$$name,f.message=l,f.cause=w["!"],E.send(f,f.$initialize,h),E.config.enable_stack_trace&&Error.captureStackTrace&&Error.captureStackTrace(f,N),f},-1),N=k.$new,p(k,"$exception",function(b){var C,u=this;return C=E.slice.call(arguments),d(u,"new",M(C))},-1),v(k,"$initialize",function(b){var C,h,u=this;return C=E.slice.call(arguments),u.message=(h=C).length>0?h[0]:X},-1),v(k,"$backtrace",function(){var b=this;if(b.backtrace)return b.backtrace;var C=b.stack;return void 0!==C&&C.$$is_string?b.backtrace=P(C.split("\n").slice(0,15)):C?b.backtrace=P(C.slice(0,15)):[]},0),v(k,"$backtrace_locations",function(){var b,C=this;return C.backtrace_locations||(C.backtrace_locations=(b=C.$backtrace())===X||null==b?X:d(b,"map",[],function(u){return null==u&&(u=X),a(a(a("Thread"),"Backtrace"),"Location").$new(u)},1)),C.backtrace_locations},0),v(k,"$cause",function(){return this.cause||X},0),v(k,"$exception",function(b){var C=this;if(null==b&&(b=X),b===X||C===b)return C;var h=C.$clone();return h.message=b,C.backtrace&&(h.backtrace=C.backtrace.$dup()),h.stack=C.stack,h.cause=C.cause,h},-1),v(k,"$message",function(){return this.$to_s()},0),v(k,"$full_message",function(b){var h,u=this,l=X,f=X,_=X,x=X,S=X,Q=X,le=X,Ce=X,T=X;return null==w.stderr&&(w.stderr=X),null==b&&(b=X),D(z("Hash","skip_raise")?"constant":X)?(_=(h=[(b=$(["highlight","order"],{highlight:w.stderr["$tty?"](),order:"top"}).$merge(D(l=b)?l:$([],{})))["$[]"]("highlight"),b["$[]"]("order")])[1],D([!0,!1]["$include?"](f=h[0]))||F.$raise(a("ArgumentError"),"expected true or false as highlight: "+f),D(["top","bottom"]["$include?"](_))||F.$raise(a("ArgumentError"),"expected :top or :bottom as order: "+_),D(f)?(x="\x1b[1;4m",S="\x1b[1m",Q="\x1b[m"):x=S=Q="",le=u.$backtrace().$dup(),(oe(le)||D(le["$empty?"]()))&&(le=u.$caller()),Ce=le.$shift(),T=G(T=Ce+": ",""+S+u.$to_s()+" ("+x+u.$class()+Q+S+")"+Q+"\n"),T=G(T,d(le,"map",[],function(re){return null==re&&(re=X),"\tfrom "+re+"\n"},1).$join()),D(u.$cause())&&(T=G(T,u.$cause().$full_message($(["highlight"],{highlight:f})))),L(_,"bottom")&&(T=T.$split("\n").$reverse().$join("\n"),T=G(S+"Traceback"+Q+" (most recent call last):\n",T)),T):u.message+"\n"+u.stack},-1),v(k,"$inspect",function(){var b=this,C=X;return C=b.$to_s(),D(C["$empty?"]())?b.$class().$to_s():"#<"+b.$class().$to_s()+": "+b.$to_s()+">"},0),v(k,"$set_backtrace",function(b){var u,l,C=this,h=!0;if(b===X)C.backtrace=X,C.stack="";else if(b.$$is_string)C.backtrace=[b],C.stack="  from "+b;else{if(b.$$is_array){for(u=0,l=b.length;u<l;u++)if(!b[u].$$is_string){h=!1;break}}else h=!1;!1===h&&F.$raise(a("TypeError"),"backtrace must be Array of String"),C.backtrace=b,C.stack=d(b,"map",[],function(_){return null==_&&(_=X),G("  from ",_)},1).join("\n")}return b},1),v(k,"$to_s",function(){var C,h,b=this;return D(C=D(h=b.message)?b.message.$to_s():h)?C:b.$class().$to_s()},0)}(0,Error,ae),y("::",a("Exception"),"ScriptError"),y("::",a("ScriptError"),"SyntaxError"),y("::",a("ScriptError"),"LoadError"),y("::",a("ScriptError"),"NotImplementedError"),y("::",a("Exception"),"SystemExit"),y("::",a("Exception"),"NoMemoryError"),y("::",a("Exception"),"SignalException"),y("::",a("SignalException"),"Interrupt"),y("::",a("Exception"),"SecurityError"),y("::",a("Exception"),"SystemStackError"),y("::",a("Exception"),"StandardError"),y("::",a("StandardError"),"EncodingError"),y("::",a("StandardError"),"ZeroDivisionError"),y("::",a("StandardError"),"NameError"),y("::",a("NameError"),"NoMethodError"),y("::",a("StandardError"),"RuntimeError"),y("::",a("RuntimeError"),"FrozenError"),y("::",a("StandardError"),"LocalJumpError"),y("::",a("StandardError"),"TypeError"),y("::",a("StandardError"),"ArgumentError"),y("::",a("ArgumentError"),"UncaughtThrowError"),y("::",a("StandardError"),"IndexError"),y("::",a("IndexError"),"StopIteration"),y("::",a("StopIteration"),"ClosedQueueError"),y("::",a("IndexError"),"KeyError"),y("::",a("StandardError"),"RangeError"),y("::",a("RangeError"),"FloatDomainError"),y("::",a("StandardError"),"IOError"),y("::",a("IOError"),"EOFError"),y("::",a("StandardError"),"SystemCallError"),y("::",a("StandardError"),"RegexpError"),y("::",a("StandardError"),"ThreadError"),y("::",a("StandardError"),"FiberError"),V.$autoload("Errno","corelib/error/errno"),Y=a("ArgumentError"),(ne=y("::",Y,"UncaughtThrowError")).$$prototype.tag=X,ne.$attr_reader("tag","value"),v(ne,"$initialize",function q(z,A){var P=this;return delete q.$$p,null==A&&(A=X),P.tag=z,P.value=A,H(P,se(P,"initialize",q,!1,!0),"initialize",["uncaught throw "+P.tag.$inspect()],null)},-2),function(ee,Y){var ne=y("::",null,"NameError");ne.$attr_reader("name"),v(ne,"$initialize",function k(q,z){var N=this;return delete k.$$p,null==z&&(z=X),H(N,se(N,"initialize",k,!1,!0),"initialize",[q],null),N.name=z},-2)}(),function(ee,Y){var ne=y("::",null,"NoMethodError");ne.$attr_reader("args"),v(ne,"$initialize",function k(q,z,A){var P=this;return delete k.$$p,null==z&&(z=X),null==A&&(A=[]),H(P,se(P,"initialize",k,!1,!0),"initialize",[q,z],null),P.args=A},-2)}(),y("::",null,"StopIteration").$attr_reader("result"),function(ee,Y){var ne=y("::",null,"KeyError"),k=ne.$$prototype;k.receiver=k.key=X,v(ne,"$initialize",function q(z,A){var N,P,b=this;if(delete q.$$p,null==A)A=$([],{});else if(!A.$$is_hash)throw E.ArgumentError.$new("expected kwargs");return null==(N=A.$$smap.receiver)&&(N=X),null==(P=A.$$smap.key)&&(P=X),H(b,se(b,"initialize",q,!1,!0),"initialize",[z],null),b.receiver=N,b.key=P},-2),v(ne,"$receiver",function(){var A;return D(A=this.receiver)?A:F.$raise(a("ArgumentError"),"no receiver is available")},0),v(ne,"$key",function(){var A;return D(A=this.key)?A:F.$raise(a("ArgumentError"),"no key is available")},0)}(),function(ee,Y){var k=[ue("::","JS")].concat(Y);return y(k[0],null,"Error"),X}(0,ae)},Opal.modules["corelib/constants"]=function(E){var X=E.$$$,a=E.const_set;return a("::","RUBY_PLATFORM","opal"),a("::","RUBY_ENGINE","opal"),a("::","RUBY_VERSION","3.1.0"),a("::","RUBY_ENGINE_VERSION","1.4.1"),a("::","RUBY_RELEASE_DATE","2022-01-12"),a("::","RUBY_PATCHLEVEL",0),a("::","RUBY_REVISION","0"),a("::","RUBY_COPYRIGHT","opal - Copyright (C) 2013-2021 Adam Beynon and the Opal contributors"),a("::","RUBY_DESCRIPTION","opal "+X("RUBY_ENGINE_VERSION")+" ("+X("RUBY_RELEASE_DATE")+" revision "+X("RUBY_REVISION")+")")},Opal.modules["opal/base"]=function(E){var X=E.Object;return X.$require("corelib/runtime"),X.$require("corelib/helpers"),X.$require("corelib/module"),X.$require("corelib/class"),X.$require("corelib/basic_object"),X.$require("corelib/kernel"),X.$require("corelib/main"),X.$require("corelib/error"),X.$require("corelib/constants")},Opal.modules["corelib/nil"]=function(E){var H,L,X=E.nil,a=E.$$$,w=E.Kernel,p=E.def,d=E.hash2,M=E.NilClass,v=E.truthy,D=E.rb_gt,$=E.alias;return[L=(0,E.klass)("::",null,"NilClass")].concat([]),L.$$prototype.$$meta=L,H=E.get_singleton_class(L),p(H,"$allocate",function(){return w.$raise(a("TypeError"),"allocator undefined for "+this.$name())},0),E.udef(H,"$new"),p(L,"$!",function(){return!0},0),p(L,"$&",function(se){return!1},1),p(L,"$|",function(se){return!1!==se&&se!==X},1),p(L,"$^",function(se){return!1!==se&&se!==X},1),p(L,"$==",function(se){return se===X},1),p(L,"$dup",function(){return X},0),p(L,"$clone",function(se){if(null==se)se=d([],{});else if(!se.$$is_hash)throw E.ArgumentError.$new("expected kwargs");return X},-1),p(L,"$inspect",function(){return"nil"},0),p(L,"$nil?",function(){return!0},0),p(L,"$singleton_class",function(){return M},0),p(L,"$to_a",function(){return[]},0),p(L,"$to_h",function(){return E.hash()},0),p(L,"$to_i",function(){return 0},0),p(L,"$to_s",function(){return""},0),p(L,"$to_c",function(){return a("Complex").$new(0,0)},0),p(L,"$rationalize",function(se){var ue;return ue=E.slice.call(arguments),v(D(ue.$length(),1))&&w.$raise(a("ArgumentError")),w.$Rational(0,1)},-1),p(L,"$to_r",function(){return w.$Rational(0,1)},0),p(L,"$instance_variables",function(){return[]},0),$(L,"to_f","to_i")},Opal.modules["corelib/boolean"]=function(E){"use strict";var X=E.nil,a=E.$$$,y=E.klass,w=E.Kernel,p=E.def,d=E.hash2,M=E.truthy,v=E.send2,D=E.find_super,$=E.to_a,F=E.alias;return function(oe,G,L){var ee,V=y("::",G,"Boolean");[V].concat([]),E.prop(V.$$prototype,"$$is_boolean",!0);for(var se=["$$class","$$meta"],ue=0;ue<se.length;ue++)Object.defineProperty(V.$$prototype,se[ue],{configurable:!0,enumerable:!1,get:function(){return 1==this?E.TrueClass:0==this?E.FalseClass:E.Boolean}});Object.defineProperty(V.$$prototype,"$$id",{configurable:!0,enumerable:!1,get:function(){return 1==this?2:0==this?0:X}}),ee=E.get_singleton_class(V),p(ee,"$allocate",function(){return w.$raise(a("TypeError"),"allocator undefined for "+this.$name())},0),E.udef(ee,"$new"),p(V,"$__id__",function(){return this.valueOf()?2:0},0),p(V,"$!",function(){return 1!=this},0),p(V,"$&",function(Y){return 1==this&&!1!==Y&&Y!==X},1),p(V,"$|",function(Y){return 1==this||!1!==Y&&Y!==X},1),p(V,"$^",function(Y){return 1==this?!1===Y||Y===X:!1!==Y&&Y!==X},1),p(V,"$==",function(Y){return 1==this===Y.valueOf()},1),p(V,"$singleton_class",function(){return this.$$meta},0),p(V,"$to_s",function(){return 1==this?"true":"false"},0),p(V,"$dup",function(){return this},0),p(V,"$clone",function(Y){if(null==Y)Y=d([],{});else if(!Y.$$is_hash)throw E.ArgumentError.$new("expected kwargs");return this},-1),p(V,"$method_missing",function ee(Y,ne){var z,k=ee.$$p||X,A=this;delete ee.$$p,z=E.slice.call(arguments,1);var N=A.$$class.$$prototype["$"+Y];return M(void 0!==N&&!N.$$stub)||v(A,D(A,"method_missing",ee,!1,!0),"method_missing",[Y].concat($(z)),k),E.send(A,N,z,k)},-2),p(V,"$respond_to_missing?",function(Y,ne){null==ne&&(ne=!1);var q=this.$$class.$$prototype["$"+Y];return void 0!==q&&!q.$$stub},-2),F(V,"eql?","=="),F(V,"equal?","=="),F(V,"inspect","to_s"),F(V,"object_id","__id__")}(0,Boolean),y("::",a("Boolean"),"TrueClass"),y("::",a("Boolean"),"FalseClass"),X},Opal.modules["corelib/comparable"]=function(E){var ae=E.nil,X=E.$$$,a=E.truthy,y=E.module,w=E.rb_gt,p=E.rb_lt,d=E.eqeqeq,M=E.Kernel,v=E.def;return function(D){var $=y("::","Comparable"),F=ae;function oe(V){return E.is_a(V,E.Integer)?V:w(V,0)?1:p(V,0)?-1:0}function L(V,H){var se=V["$<=>"](H);return a(se)||function G(V,H){var se;se=d(ae,F=H)||d(!0,F)||d(!1,F)||d(X("Integer"),F)||d(X("Float"),F)?H.$inspect():H.$$class,M.$raise(X("ArgumentError"),"comparison of "+V.$class()+" with "+se+" failed")}(V,H),oe(se)}return v($,"$==",function(H){var se=this,ue=ae;return!!a(se["$equal?"](H))||se["$<=>"]!=E.Kernel["$<=>"]&&(se.$$comparable?(delete se.$$comparable,!1):!!a(ue=se["$<=>"](H))&&0==oe(ue))},1),v($,"$>",function(H){return L(this,H)>0},1),v($,"$>=",function(H){return L(this,H)>=0},1),v($,"$<",function(H){return L(this,H)<0},1),v($,"$<=",function(H){return L(this,H)<=0},1),v($,"$between?",function(H,se){return!(p(this,H)||w(this,se))},2),v($,"$clamp",function(H,se){var ee,Y;if(null==se&&(se=ae),se===ae&&(E.is_a(H,E.Range)||M.$raise(X("TypeError"),"wrong argument type "+H.$class()+" (expected Range)"),Y=H.excl,se=H.end,H=H.begin,se!==ae&&Y&&M.$raise(X("ArgumentError"),"cannot clamp with an exclusive range")),H!==ae&&se!==ae&&L(H,se)>0&&M.$raise(X("ArgumentError"),"min argument must be smaller than max argument"),H!==ae){if(0==(ee=L(this,H)))return this;if(ee<0)return H}return se!==ae&&(ee=L(this,se))>0?se:this},-2)}()},Opal.modules["corelib/regexp"]=function(E){var k,q,P,b,C,z,A,N,ae=[],X=E.nil,a=E.$$$,y=E.coerce_to,w=E.klass,p=E.const_set,d=E.send2,M=E.find_super,v=E.def,D=E.truthy,$=E.gvars,F=E.Kernel,oe=E.Opal,G=E.alias,L=E.send,V=E.hash2,H=E.rb_plus,se=E.rb_ge,ue=E.to_a,ee=E.eqeqeq,Y=E.rb_minus;return w("::",a("StandardError"),"RegexpError"),k=RegExp,q=ae,A=[z=w("::",k,"Regexp")].concat(q),N=E.$r(A),p(z,"IGNORECASE",1),p(z,"EXTENDED",2),p(z,"MULTILINE",4),E.prop(z.$$prototype,"$$is_regexp",!0),b=[P=E.get_singleton_class(z)].concat(A),C=E.$r(b),v(P,"$allocate",function h(){var u=h.$$p||X,f=X;return delete h.$$p,(f=d(this,M(this,"allocate",h,!1,!0),"allocate",[],u)).uninitialized=!0,f},0),v(P,"$escape",function(u){return E.escape_regexp(u)},1),v(P,"$last_match",function(u){return null==$["~"]&&($["~"]=X),null==u&&(u=X),D(u["$nil?"]())?$["~"]:D($["~"])?$["~"]["$[]"](u):X},-1),v(P,"$union",function(u){var f,x,S,Q,le,Ce,_=this;if(0==(f=E.slice.call(arguments)).length)return/(?!)/;if(1==f.length&&f[0].$$is_regexp)return f[0];x=f[0].$$is_array,f.length>1&&x&&F.$raise(a("TypeError"),"no implicit conversion of Array into String"),x&&(f=f[0]),le=void 0,S=[];for(var T=0;T<f.length;T++)(Q=f[T]).$$is_string?S.push(_.$escape(Q)):Q.$$is_regexp?(Ce=Q.$options(),null!=le&&le!=Ce&&F.$raise(a("TypeError"),"All expressions must use the same options"),le=Ce,S.push("("+Q.source+")")):S.push(_.$escape(Q.$to_str()));return _.$new(S.$join("|"),le)},-1),v(P,"$new",function(u,l){if(u.$$is_regexp)return new RegExp(u);if("\\"===(u=oe["$coerce_to!"](u,a("String"),"to_str")).charAt(u.length-1)&&"\\"!==u.charAt(u.length-2)&&F.$raise(a("RegexpError"),"too short escape sequence: /"+u+"/"),void 0===l||l["$!"]())return new RegExp(u);if(l.$$is_number){var f="";C("IGNORECASE")&l&&(f+="i"),C("MULTILINE")&l&&(f+="m"),l=f}else l="i";return new RegExp(u,l)},-2),G(P,"compile","new"),G(P,"quote","escape"),v(z,"$==",function(g){return g instanceof RegExp&&this.toString()===g.toString()},1),v(z,"$===",function(g){return this.$match(oe["$coerce_to?"](g,a("String"),"to_str"))!==X},1),v(z,"$=~",function(g){var C;return null==$["~"]&&($["~"]=X),D(C=this.$match(g))?$["~"].$begin(0):C},1),v(z,"$inspect",function(){var C=this.toString(),h=/^\/(.*)\/([^\/]*)$/.exec(C);if(h){for(var l=h[2],f=h[1].split(""),_=f.length,x=!1,S="",Q=0;Q<_;Q++){var le=f[Q];!x&&"/"==le&&(S=S.concat("\\")),S=S.concat(le),x="\\"==le&&!x}return"/"+S+"/"+l}return C},0),v(z,"$match",function P(g,b){var C=P.$$p||X,h=this;if(null==$["~"]&&($["~"]=X),delete P.$$p,h.uninitialized&&F.$raise(a("TypeError"),"uninitialized Regexp"),void 0===b){if(g===X)return $["~"]=X;var u=h.exec(y(g,a("String"),"to_str"));return u?($["~"]=a("MatchData").$new(h,u),C===X?$["~"]:E.yield1(C,$["~"])):$["~"]=X}if(b=y(b,a("Integer"),"to_int"),g===X||(g=y(g,a("String"),"to_str"),b<0&&(b+=g.length)<0))return $["~"]=X;for(var l,f=E.global_regexp(h);;){if(null===(l=f.exec(g)))return $["~"]=X;if(l.index>=b)return $["~"]=a("MatchData").$new(f,l),C===X?$["~"]:E.yield1(C,$["~"]);f.lastIndex=l.index+1}},-2),v(z,"$match?",function(g,b){var h,C=this;return C.uninitialized&&F.$raise(a("TypeError"),"uninitialized Regexp"),void 0===b?g!==X&&C.test(y(g,a("String"),"to_str")):(b=y(b,a("Integer"),"to_int"),!(g===X||(g=y(g,a("String"),"to_str"),b<0&&(b+=g.length)<0)||null===(h=E.global_regexp(C).exec(g))||h.index<b))},-2),v(z,"$names",function(){return L(this.$source().$scan(/\(?<(\w+)>/,V(["no_matchdata"],{no_matchdata:!0})),"map",[],"first".$to_proc()).$uniq()},0),v(z,"$named_captures",function(){return L(L(L(this.$source().$scan(/\(?<(\w+)>/,V(["no_matchdata"],{no_matchdata:!0})),"map",[],"first".$to_proc()).$each_with_index(),"group_by",[],"first".$to_proc()),"transform_values",[],function(C){return null==C&&(C=X),L(C,"map",[],function(u){return null==u&&(u=X),H(u.$last(),1)},1)},1)},0),v(z,"$~",function(){return null==$._&&($._=X),this["$=~"]($._)},0),v(z,"$source",function(){return this.source},0),v(z,"$options",function(){var g=this;g.uninitialized&&F.$raise(a("TypeError"),"uninitialized Regexp");var b=0;return g.multiline&&(b|=N("MULTILINE")),g.ignoreCase&&(b|=N("IGNORECASE")),b},0),v(z,"$casefold?",function(){return this.ignoreCase},0),G(z,"eql?","=="),G(z,"to_s","source"),function(ne,k,q){var z=w(ne,null,"MatchData"),A=[z].concat(q),N=E.$r(A);return z.$$prototype.matches=X,z.$attr_reader("post_match","pre_match","regexp","string"),v(z,"$initialize",function(b,C,h){var u,l=this;if(null==h)h=V([],{});else if(!h.$$is_hash)throw E.ArgumentError.$new("expected kwargs");null==(u=h.$$smap.no_matchdata)&&(u=!1),D(u)||($["~"]=l),l.regexp=b,l.begin=C.index,l.string=C.input,l.pre_match=C.input.slice(0,C.index),l.post_match=C.input.slice(C.index+C[0].length),l.matches=[];for(var f=0,_=C.length;f<_;f++){var x=C[f];l.matches.push(null==x?X:x)}},-3),v(z,"$match",function(b){var h;return D(h=this["$[]"](b))?h:D(b["$is_a?"](N("Integer")))&&D(se(b,this.$length()))?F.$raise(a("IndexError"),"index "+b+" out of matches"):X},1),v(z,"$match_length",function(b){var C;return(C=this.$match(b))===X||null==C?X:L(C,"length",[])},1),v(z,"$[]",function(b){var h,u=this;return(h=E.slice.call(arguments))[0].$$is_string?(u.$regexp().$names()["$include?"](h["$[]"](0))["$!"]()&&F.$raise(a("IndexError"),"undefined group name reference: "+h["$[]"](0)),u.$named_captures()["$[]"](h["$[]"](0))):L(u.matches,"[]",ue(h))},-1),v(z,"$offset",function(b){var C=this;return 0!==b&&F.$raise(a("ArgumentError"),"MatchData#offset only supports 0th element"),[C.begin,C.begin+C.matches[b].length]},1),v(z,"$==",function(b){var C=this,h=X,u=X,l=X,f=X;return!!ee(a("MatchData"),b)&&(D(h=D(u=D(l=D(f=C.string==b.string)?C.regexp.toString()==b.regexp.toString():f)?C.pre_match==b.pre_match:l)?C.post_match==b.post_match:u)?C.begin==b.begin:h)},1),v(z,"$begin",function(b){return 0!==b&&F.$raise(a("ArgumentError"),"MatchData#begin only supports 0th element"),this.begin},1),v(z,"$end",function(b){return 0!==b&&F.$raise(a("ArgumentError"),"MatchData#end only supports 0th element"),this.begin+this.matches[b].length},1),v(z,"$captures",function(){return this.matches.slice(1)},0),v(z,"$named_captures",function(){var C=X;return C=this.$captures(),L(this.$regexp().$named_captures(),"transform_values",[],function(u){return null==u&&(u=X),C["$[]"](Y(u.$last(),1))},1)},0),v(z,"$names",function(){return this.$regexp().$names()},0),v(z,"$inspect",function(){var b=this,C="#<MatchData "+b.matches[0].$inspect();if(b.$regexp().$names()["$empty?"]())for(var h=1,u=b.matches.length;h<u;h++)C+=" "+h+":"+b.matches[h].$inspect();else L(b.$named_captures(),"each",[],function(f,_){return null==f&&(f=X),null==_&&(_=X),C+=" "+f+":"+_.$inspect()},2);return C+">"},0),v(z,"$length",function(){return this.matches.length},0),v(z,"$to_a",function(){return this.matches},0),v(z,"$to_s",function(){return this.matches[0]},0),v(z,"$values_at",function(b){var h,u=this;h=E.slice.call(arguments);var l,f,_,x=[];for(l=0;l<h.length;l++)h[l].$$is_range&&((f=h[l].$to_a()).unshift(l,1),Array.prototype.splice.apply(h,f)),(_=oe["$coerce_to!"](h[l],a("Integer"),"to_int"))<0&&(_+=u.matches.length)<0?x.push(X):x.push(u.matches[_]);return x},-1),G(z,"eql?","=="),G(z,"size","length")}(ae[0],0,ae)},Opal.modules["corelib/string"]=function(E){var ae=E.top,X=[],a=E.$r(X),y=E.nil,w=E.$$$,p=E.coerce_to,d=E.respond_to,M=E.global_multiline_regexp,v=E.klass,D=E.def,$=E.Opal,F=E.defs,oe=E.send,G=E.to_a,L=E.hash2,V=E.eqeqeq,H=E.Kernel,se=E.truthy,ue=E.gvars,ee=E.rb_divide,Y=E.rb_plus,ne=E.alias,k=E.const_set;return ae.$require("corelib/comparable"),ae.$require("corelib/regexp"),function(q,z,A){var N=v("::",String,"String"),P=[N].concat(A),g=E.$r(P);function b(C){function h(T){var re,ve,de,Ee,ce,he,O="",j=T.length;for(re=0;re<j;re++)if("-"===(ve=T.charAt(re))&&re>0&&re<j-1&&!de){for((Ee=T.charCodeAt(re-1))>(ce=T.charCodeAt(re+1))&&H.$raise(w("ArgumentError"),'invalid range "'+Ee+"-"+ce+'" in string transliteration'),he=Ee+1;he<ce+1;he++)O+=String.fromCharCode(he);de=!0,re++}else de="\\"===ve,O+=ve;return O}function u(T,O){if(0===T.length)return O;var j,de,re="",ve=T.length;for(j=0;j<ve;j++)de=T.charAt(j),-1!==O.indexOf(de)&&(re+=de);return re}var l,f,_,x,S,Q,le="",Ce="";for(l=0,f=C.length;l<f;l++)x="^"===(_=p(C[l],w("String"),"to_str")).charAt(0)&&_.length>1,_=h(x?_.slice(1):_),x?Ce=u(Ce,_):le=u(le,_);if(le.length>0&&Ce.length>0){for(Q="",l=0,f=le.length;l<f;l++)S=le.charAt(l),-1===Ce.indexOf(S)&&(Q+=S);le=Q,Ce=""}return le.length>0?"["+w("Regexp").$escape(le)+"]":Ce.length>0?"[^"+w("Regexp").$escape(Ce)+"]":null}N.$include(w("Comparable")),E.prop(N.$$prototype,"$$is_string",!0),E.prop(N.$$prototype,"$$cast",function(C){var h=this.$$class;return h.$$constructor===String?C:new h.$$constructor(C)}),D(N,"$__id__",function(){return this.toString()},0),F(N,"$try_convert",function(h){return $["$coerce_to?"](h,w("String"),"to_str")},1),F(N,"$new",function(h){var l,f=this,_=(l=E.slice.call(arguments))[0]||"",x=l[l.length-1];return _=p(_,w("String"),"to_str"),x&&x.$$is_hash&&x.$$smap.encoding&&(_=_.$force_encoding(x.$$smap.encoding)),(_=new f.$$constructor(_)).$initialize.$$pristine||oe(_,"initialize",G(l)),_},-1),D(N,"$initialize",function(h,u){var l,f;if(l=E.slice.call(arguments),null==(f=E.extract_kwargs(l)))f=L([],{});else if(!f.$$is_hash)throw E.ArgumentError.$new("expected kwargs");return l.length>0&&l.shift(),y},-1),D(N,"$%",function(h){var u=this;return V(w("Array"),h)?oe(u,"format",[u].concat(G(h))):u.$format(u,h)},1),D(N,"$*",function(h){var u=this;if((h=p(h,w("Integer"),"to_int"))<0&&H.$raise(w("ArgumentError"),"negative argument"),0===h)return u.$$cast("");var l="",f=u.toString();for(f.length*h>=1<<28&&H.$raise(w("RangeError"),"multiply count must not overflow maximum string size");1==(1&h)&&(l+=f),0!=(h>>>=1);)f+=f;return u.$$cast(l)},1),D(N,"$+",function(h){var u=this;if(""==(h=p(h,w("String"),"to_str"))&&u.$$class===E.String)return u;if(""==u&&h.$$class===E.String)return h;var l=u+h;return u.encoding===l.encoding&&h.encoding===l.encoding||"UTF-8"===u.encoding.name||"UTF-8"===h.encoding.name?l:E.enc(l,u.encoding)},1),D(N,"$<=>",function(h){var u=this;if(se(h["$respond_to?"]("to_str")))return u>(h=h.$to_str().$to_s())?1:u<h?-1:0;var l=h["$<=>"](u);return l===y?y:l>0?-1:l<0?1:0},1),D(N,"$==",function(h){return h.$$is_string?this.toString()===h.toString():!!d(h,"$to_str")&&h["$=="](this)},1),D(N,"$=~",function(h){return h.$$is_string&&H.$raise(w("TypeError"),"type mismatch: String given"),h["$=~"](this)},1),D(N,"$[]",function(h,u){var _,x,l=this,f=l.length;if(h.$$is_range)return _=h.excl,x=h,u=h.end===y?-1:p(h.end,w("Integer"),"to_int"),h=h.begin===y?0:p(h.begin,w("Integer"),"to_int"),Math.abs(h)>f?y:(h<0&&(h+=f),u<0&&(u+=f),(!_||x.end===y)&&(u+=1),(u-=h)<0&&(u=0),l.$$cast(l.substr(h,u)));if(h.$$is_string)return null!=u&&H.$raise(w("TypeError")),-1!==l.indexOf(h)?l.$$cast(h):y;if(h.$$is_regexp){var S=l.match(h);return null===S?(ue["~"]=y,y):(ue["~"]=w("MatchData").$new(h,S),null==u?l.$$cast(S[0]):(u=p(u,w("Integer"),"to_int"))<0&&-u<S.length?l.$$cast(S[u+=S.length]):u>=0&&u<S.length?l.$$cast(S[u]):y)}return(h=p(h,w("Integer"),"to_int"))<0&&(h+=f),null==u?h>=f||h<0?y:l.$$cast(l.substr(h,1)):(u=p(u,w("Integer"),"to_int"))<0||h>f||h<0?y:l.$$cast(l.substr(h,u))},-2),D(N,"$b",function(){return new String(this).$force_encoding("binary")},0),D(N,"$capitalize",function(){var h=this;return h.$$cast(h.charAt(0).toUpperCase()+h.substr(1).toLowerCase())},0),D(N,"$casecmp",function(h){var u=this;if(!se(h["$respond_to?"]("to_str")))return y;h=p(h,w("String"),"to_str").$to_s();var l=/^[\x00-\x7F]*$/;return l.test(u)&&l.test(h)&&(u=u.toLowerCase(),h=h.toLowerCase()),u["$<=>"](h)},1),D(N,"$casecmp?",function(h){var l=this.$casecmp(h);return l===y?y:0===l},1),D(N,"$center",function(h,u){var l=this;if(null==u&&(u=" "),h=p(h,w("Integer"),"to_int"),u=p(u,w("String"),"to_str").$to_s(),se(u["$empty?"]())&&H.$raise(w("ArgumentError"),"zero width padding"),se(h<=l.length))return l;var f=l.$ljust(ee(Y(h,l.length),2).$ceil(),u),_=l.$rjust(ee(Y(h,l.length),2).$floor(),u);return l.$$cast(_+f.slice(l.length))},-2),D(N,"$chomp",function(h){var l,u=this;return null==ue["/"]&&(ue["/"]=y),null==h&&(h=ue["/"]),se(h===y||0===u.length)?u:("\n"===(h=$["$coerce_to!"](h,w("String"),"to_str").$to_s())?l=u.replace(/\r?\n?$/,""):""===h?l=u.replace(/(\r?\n)+$/,""):u.length>=h.length&&u.substr(u.length-h.length,h.length)===h&&(l=u.substr(0,u.length-h.length)),null!=l?u.$$cast(l):u)},-1),D(N,"$chop",function(){var l,h=this,u=h.length;return l=u<=1?"":"\n"===h.charAt(u-1)&&"\r"===h.charAt(u-2)?h.substr(0,u-2):h.substr(0,u-1),h.$$cast(l)},0),D(N,"$chr",function(){return this.charAt(0)},0),D(N,"$clone",function(){var h=this,u=y;return(u=new String(h)).$copy_singleton_methods(h),u.$initialize_clone(h),u},0),D(N,"$dup",function(){var u=y;return(u=new String(this)).$initialize_dup(this),u},0),D(N,"$count",function(h){var l,f=this;0===(l=E.slice.call(arguments)).length&&H.$raise(w("ArgumentError"),"ArgumentError: wrong number of arguments (0 for 1+)");var _=b(l);return null===_?0:f.length-f.replace(new RegExp(_,"g"),"").length},-1),D(N,"$delete",function(h){var l,f=this;0===(l=E.slice.call(arguments)).length&&H.$raise(w("ArgumentError"),"ArgumentError: wrong number of arguments (0 for 1+)");var _=b(l);return null===_?f:f.$$cast(f.replace(new RegExp(_,"g"),""))},-1),D(N,"$delete_prefix",function(h){var u=this;return h.$$is_string||(h=p(h,w("String"),"to_str")),u.slice(0,h.length)===h?u.$$cast(u.slice(h.length)):u},1),D(N,"$delete_suffix",function(h){var u=this;return h.$$is_string||(h=p(h,w("String"),"to_str")),u.slice(u.length-h.length)===h?u.$$cast(u.slice(0,u.length-h.length)):u},1),D(N,"$downcase",function(){return this.$$cast(this.toLowerCase())},0),D(N,"$each_line",function C(h,u){var f,_,x,S,le,Ce,T,O,re,j,ve,de,l=C.$$p||y,Q=this;if(null==ue["/"]&&(ue["/"]=y),delete C.$$p,f=E.slice.call(arguments),null==(_=E.extract_kwargs(f)))_=L([],{});else if(!_.$$is_hash)throw E.ArgumentError.$new("expected kwargs");if(f.length>0&&(x=f.shift()),null==x&&(x=ue["/"]),null==(S=_.$$smap.chomp)&&(S=!1),l===y)return Q.$enum_for("each_line",x,L(["chomp"],{chomp:S}));if(x===y)return E.yield1(l,Q),Q;if(0===(x=p(x,w("String"),"to_str")).length){for(Ce=0,T=(le=Q.split(/((?:\r?\n){2})(?:(?:\r?\n)*)/)).length;Ce<T;Ce+=2)(le[Ce]||le[Ce+1])&&(de=(le[Ce]||"")+(le[Ce+1]||""),S&&(de=de.$chomp("\n")),E.yield1(l,de));return Q}for(re=Q.$chomp(x),j=Q.length!=re.length,Ce=0,O=(ve=re.split(x)).length;Ce<O;Ce++)de=ve[Ce],(Ce<O-1||j)&&(de+=x),S&&(de=de.$chomp(x)),E.yield1(l,de);return Q},-1),D(N,"$empty?",function(){return 0===this.length},0),D(N,"$end_with?",function(h){for(var l,f=this,_=0,x=(l=E.slice.call(arguments)).length;_<x;_++){var S=p(l[_],w("String"),"to_str").$to_s();if(f.length>=S.length&&f.substr(f.length-S.length,S.length)==S)return!0}return!1},-1),D(N,"$gsub",function C(h,u){var l=C.$$p||y,f=this;if(delete C.$$p,void 0===u&&l===y)return f.$enum_for("gsub",h);var Q,le,Ce,_="",x=y,S=0;for(h.$$is_regexp?h=M(h):(h=p(h,w("String"),"to_str"),h=new RegExp(h.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"));;){if(null===(Q=h.exec(f))){ue["~"]=y,_+=f.slice(S);break}x=w("MatchData").$new(h,Q),void 0===u?(Ce=h.lastIndex,le=l(Q[0]),h.lastIndex=Ce):u.$$is_hash?le=u["$[]"](Q[0]).$to_s():(u.$$is_string||(u=p(u,w("String"),"to_str")),le=u.replace(/([\\]+)([0-9+&`'])/g,function(T,O,re){if(O.length%2==0)return T;switch(re){case"+":for(var j=Q.length-1;j>0;j--)if(void 0!==Q[j])return O.slice(1)+Q[j];return"";case"&":return O.slice(1)+Q[0];case"`":return O.slice(1)+f.slice(0,Q.index);case"'":return O.slice(1)+f.slice(Q.index+Q[0].length);default:return O.slice(1)+(Q[re]||"")}}).replace(/\\\\/g,"\\")),h.lastIndex===Q.index?(_+=f.slice(S,Q.index)+le+(f[Q.index]||""),h.lastIndex+=1):_+=f.slice(S,Q.index)+le,S=h.lastIndex}return ue["~"]=x,f.$$cast(_)},-2),D(N,"$hash",function(){return this.toString()},0),D(N,"$hex",function(){return this.$to_i(16)},0),D(N,"$include?",function(h){return h.$$is_string||(h=p(h,w("String"),"to_str")),-1!==this.indexOf(h)},1),D(N,"$index",function(h,u){var f,_,x,l=this;if(void 0===u)u=0;else if((u=p(u,w("Integer"),"to_int"))<0&&(u+=l.length)<0)return y;if(h.$$is_regexp)for(x=M(h);;){if(null===(_=x.exec(l))){ue["~"]=y,f=-1;break}if(_.index>=u){ue["~"]=w("MatchData").$new(x,_),f=_.index;break}x.lastIndex=_.index+1}else f=0===(h=p(h,w("String"),"to_str")).length&&u>l.length?-1:l.indexOf(h,u);return-1===f?y:f},-2),D(N,"$inspect",function(){var h=this,l={"\x07":"\\a","\x1b":"\\e","\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\v":"\\v",'"':'\\"',"\\":"\\\\"};return'"'+h.replace(/[\\\"\x00-\x1f\u007F-\u009F\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,function(_){return l[_]?l[_]:(_=_.charCodeAt(0))<=255&&(h.encoding["$binary?"]()||h.internal_encoding["$binary?"]())?"\\x"+("00"+_.toString(16).toUpperCase()).slice(-2):"\\u"+("0000"+_.toString(16).toUpperCase()).slice(-4)}).replace(/\#[\$\@\{]/g,"\\$&")+'"'},0),D(N,"$intern",function(){return this.toString()},0),D(N,"$lines",function C(h,u){var f,_,x,S,l=C.$$p||y,Q=this,le=y;if(null==ue["/"]&&(ue["/"]=y),delete C.$$p,f=E.slice.call(arguments),null==(_=E.extract_kwargs(f)))_=L([],{});else if(!_.$$is_hash)throw E.ArgumentError.$new("expected kwargs");return f.length>0&&(x=f.shift()),null==x&&(x=ue["/"]),null==(S=_.$$smap.chomp)&&(S=!1),le=oe(Q,"each_line",[x,L(["chomp"],{chomp:S})],l.$to_proc()),se(l)?Q:le.$to_a()},-1),D(N,"$ljust",function(h,u){var l=this;if(null==u&&(u=" "),h=p(h,w("Integer"),"to_int"),u=p(u,w("String"),"to_str").$to_s(),se(u["$empty?"]())&&H.$raise(w("ArgumentError"),"zero width padding"),se(h<=l.length))return l;var f=-1,_="";for(h-=l.length;++f<h;)_+=u;return l.$$cast(l+_.slice(0,h))},-2),D(N,"$lstrip",function(){return this.replace(/^[\u0000\s]*/,"")},0),D(N,"$ascii_only?",function(){return!!this.encoding.ascii&&/^[\x00-\x7F]*$/.test(this)},0),D(N,"$match",function C(h,u){var l=C.$$p||y;return delete C.$$p,(V(g("String"),h)||se(h["$respond_to?"]("to_str")))&&(h=w("Regexp").$new(h.$to_str())),V(w("Regexp"),h)||H.$raise(w("TypeError"),"wrong argument type "+h.$class()+" (expected Regexp)"),oe(h,"match",[this,u],l.$to_proc())},-2),D(N,"$match?",function(h,u){return(V(g("String"),h)||se(h["$respond_to?"]("to_str")))&&(h=w("Regexp").$new(h.$to_str())),V(w("Regexp"),h)||H.$raise(w("TypeError"),"wrong argument type "+h.$class()+" (expected Regexp)"),h["$match?"](this,u)},-2),D(N,"$next",function(){var h=this,u=h.length;if(0===u)return h.$$cast("");for(var x,l=h,f=h.search(/[a-zA-Z0-9]/),_=!1;u--;){if((x=h.charCodeAt(u))>=48&&x<=57||x>=65&&x<=90||x>=97&&x<=122)switch(x){case 57:_=!0,x=48;break;case 90:_=!0,x=65;break;case 122:_=!0,x=97;break;default:_=!1,x+=1}else-1===f?255===x?(_=!0,x=0):(_=!1,x+=1):_=!0;if(l=l.slice(0,u)+String.fromCharCode(x)+l.slice(u+1),_&&(0===u||u===f)){switch(x){case 65:case 97:break;default:x+=1}l=0===u?String.fromCharCode(x)+l:l.slice(0,u)+String.fromCharCode(x)+l.slice(u),_=!1}if(!_)break}return h.$$cast(l)},0),D(N,"$oct",function(){var u,l=this,f=8;return/^\s*_/.test(l)?0:(l=l.replace(/^(\s*[+-]?)(0[bodx]?)(.+)$/i,function(_,x,S,Q){switch(Q.charAt(0)){case"+":case"-":return _;case"0":if("x"===Q.charAt(1)&&"0x"===S)return _}switch(S){case"0b":f=2;break;case"0":case"0o":f=8;break;case"0d":f=10;break;case"0x":f=16}return x+Q}),u=parseInt(l.replace(/_(?!_)/g,""),f),isNaN(u)?0:u)},0),D(N,"$ord",function(){var h=this;return"function"==typeof h.codePointAt?h.codePointAt(0):h.charCodeAt(0)},0),D(N,"$partition",function(h){var l,f,u=this;return h.$$is_regexp?null===(f=h.exec(u))?l=-1:(w("MatchData").$new(h,f),h=f[0],l=f.index):(h=p(h,w("String"),"to_str"),l=u.indexOf(h)),-1===l?[u,"",""]:[u.slice(0,l),u.slice(l,l+h.length),u.slice(l+h.length)]},1),D(N,"$reverse",function(){return this.split("").reverse().join("")},0),D(N,"$rindex",function(h,u){var f,_,x,S,l=this;if(void 0===u)u=l.length;else if((u=p(u,w("Integer"),"to_int"))<0&&(u+=l.length)<0)return y;if(h.$$is_regexp){for(_=null,x=M(h);!(null===(S=x.exec(l))||S.index>u);)x.lastIndex=(_=S).index+1;null===_?(ue["~"]=y,f=-1):(w("MatchData").$new(x,_),f=_.index)}else h=p(h,w("String"),"to_str"),f=l.lastIndexOf(h,u);return-1===f?y:f},-2),D(N,"$rjust",function(h,u){var l=this;if(null==u&&(u=" "),h=p(h,w("Integer"),"to_int"),u=p(u,w("String"),"to_str").$to_s(),se(u["$empty?"]())&&H.$raise(w("ArgumentError"),"zero width padding"),se(h<=l.length))return l;var f=Math.floor(h-l.length),_=Math.floor(f/u.length),x=Array(_+1).join(u);return l.$$cast(x+u.slice(0,f-x.length)+l)},-2),D(N,"$rpartition",function(h){var l,f,_,x,u=this;if(h.$$is_regexp){for(f=null,_=M(h);null!==(x=_.exec(u));)_.lastIndex=(f=x).index+1;null===f?l=-1:(w("MatchData").$new(_,f),h=f[0],l=f.index)}else h=p(h,w("String"),"to_str"),l=u.lastIndexOf(h);return-1===l?["","",u]:[u.slice(0,l),u.slice(l,l+h.length),u.slice(l+h.length)]},1),D(N,"$rstrip",function(){return this.replace(/[\s\u0000]*$/,"")},0),D(N,"$scan",function C(h,u){var f,l=C.$$p||y;if(delete C.$$p,null==u)u=L([],{});else if(!u.$$is_hash)throw E.ArgumentError.$new("expected kwargs");null==(f=u.$$smap.no_matchdata)&&(f=!1);var Q,x=[],S=y;for(h.$$is_regexp?h=M(h):(h=p(h,w("String"),"to_str"),h=new RegExp(h.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"));null!=(Q=h.exec(this));)S=w("MatchData").$new(h,Q,L(["no_matchdata"],{no_matchdata:f})),l===y?x.push(1==Q.length?Q[0]:S.$captures()):E.yield1(l,1==Q.length?Q[0]:S.$captures()),h.lastIndex===Q.index&&(h.lastIndex+=1);return f||(ue["~"]=S),l!==y?this:x},-2),D(N,"$singleton_class",function(){return E.get_singleton_class(this)},0),D(N,"$split",function(h,u){var l=this,f=y;if(null==ue[";"]&&(ue[";"]=y),0===l.length)return[];if(void 0===u)u=0;else if(1===(u=$["$coerce_to!"](u,w("Integer"),"to_int")))return[l];(void 0===h||h===y)&&(h=se(f=ue[";"])?f:" ");var Q,le,Ce,_=[],x=l.toString(),S=0;if(h.$$is_regexp?h=M(h):" "===(h=p(h,w("String"),"to_str").$to_s())?(h=/\s+/gm,x=x.replace(/^\s+/,"")):h=new RegExp(h.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"),1===(_=x.split(h)).length&&_[0]===x)return[l.$$cast(_[0])];for(;-1!==(le=_.indexOf(void 0));)_.splice(le,1);function T(){for(le=0;le<_.length;le++)_[le]=l.$$cast(_[le])}if(0===u){for(;""===_[_.length-1];)_.length-=1;return T(),_}if(Q=h.exec(x),u<0){if(null!==Q&&""===Q[0]&&-1===h.source.indexOf("(?="))for(le=0,Ce=Q.length;le<Ce;le++)_.push("");return T(),_}if(null!==Q&&""===Q[0])return _.splice(u-1,_.length-1,_.slice(u-1).join("")),T(),_;if(u>=_.length)return T(),_;for(le=0;null!==Q&&(le++,S=h.lastIndex,le+1!==u);)Q=h.exec(x);return _.splice(u-1,_.length-1,x.slice(S)),T(),_},-1),D(N,"$squeeze",function(h){var l,f=this;if(0===(l=E.slice.call(arguments)).length)return f.$$cast(f.replace(/(.)\1+/g,"$1"));var _=b(l);return null===_?f:f.$$cast(f.replace(new RegExp("("+_+")\\1+","g"),"$1"))},-1),D(N,"$start_with?",function(h){for(var l,f=this,_=0,x=(l=E.slice.call(arguments)).length;_<x;_++)if(l[_].$$is_regexp){var S=l[_],Q=S.exec(f);if(null!=Q&&0===Q.index)return ue["~"]=w("MatchData").$new(S,Q),!0;ue["~"]=y}else{var le=p(l[_],w("String"),"to_str").$to_s();if(0===f.indexOf(le))return!0}return!1},-1),D(N,"$strip",function(){return this.replace(/^[\s\u0000]*|[\s\u0000]*$/g,"")},0),D(N,"$sub",function C(h,u){var l=C.$$p||y,f=this;delete C.$$p,h.$$is_regexp||(h=p(h,w("String"),"to_str"),h=new RegExp(h.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")));var _,x=h.exec(f);return null===x?(ue["~"]=y,_=f.toString()):(w("MatchData").$new(h,x),void 0===u?(l===y&&H.$raise(w("ArgumentError"),"wrong number of arguments (1 for 2)"),_=f.slice(0,x.index)+l(x[0])+f.slice(x.index+x[0].length)):u.$$is_hash?_=f.slice(0,x.index)+u["$[]"](x[0]).$to_s()+f.slice(x.index+x[0].length):(u=(u=p(u,w("String"),"to_str")).replace(/([\\]+)([0-9+&`'])/g,function(S,Q,le){if(Q.length%2==0)return S;switch(le){case"+":for(var Ce=x.length-1;Ce>0;Ce--)if(void 0!==x[Ce])return Q.slice(1)+x[Ce];return"";case"&":return Q.slice(1)+x[0];case"`":return Q.slice(1)+f.slice(0,x.index);case"'":return Q.slice(1)+f.slice(x.index+x[0].length);default:return Q.slice(1)+(x[le]||"")}}).replace(/\\\\/g,"\\"),_=f.slice(0,x.index)+u+f.slice(x.index+x[0].length))),f.$$cast(_)},-2),D(N,"$sum",function(h){null==h&&(h=16),h=p(h,w("Integer"),"to_int");for(var l=0,f=this.length,_=0;_<f;_++)l+=this.charCodeAt(_);return h<=0?l:l&Math.pow(2,h)-1},-1),D(N,"$swapcase",function(){var h=this,u=h.replace(/([a-z]+)|([A-Z]+)/g,function(l,f,_){return f?l.toUpperCase():l.toLowerCase()});return h.constructor===String?u:h.$class().$new(u)},0),D(N,"$to_f",function(){if("_"===this.charAt(0))return 0;var u=parseFloat(this.replace(/_/g,""));return isNaN(u)||u==1/0||u==-1/0?0:u},0),D(N,"$to_i",function(h){null==h&&(h=10);var l,f=this.toLowerCase(),_=p(h,w("Integer"),"to_int");return(1===_||_<0||_>36)&&H.$raise(w("ArgumentError"),"invalid radix "+_),/^\s*_/.test(f)?0:(f=f.replace(/^(\s*[+-]?)(0[bodx]?)(.+)$/,function(x,S,Q,le){switch(le.charAt(0)){case"+":case"-":return x;case"0":if("x"===le.charAt(1)&&"0x"===Q&&(0===_||16===_))return x}switch(Q){case"0b":if(0===_||2===_)return _=2,S+le;break;case"0":case"0o":if(0===_||8===_)return _=8,S+le;break;case"0d":if(0===_||10===_)return _=10,S+le;break;case"0x":if(0===_||16===_)return _=16,S+le}return x}),l=parseInt(f.replace(/_(?!_)/g,""),_),isNaN(l)?0:l)},-1),D(N,"$to_proc",function C(){var l;return delete C.$$p,l=Y("$",this.valueOf()),oe(H,"proc",[],function f(_){var Q,x=f.$$p||y;delete f.$$p,0===(Q=E.slice.call(arguments)).length&&H.$raise(w("ArgumentError"),"no receiver given");var le=Q[0];null==le&&(le=y);var Ce=le[l];return Ce?("function"==typeof x&&(Ce.$$p=x),1===Q.length?Ce.call(le):Ce.apply(le,Q.slice(1))):le.$method_missing.apply(le,Q)},-1)},0),D(N,"$to_s",function(){return this.toString()},0),D(N,"$tr",function(h,u){var l=this;if(h=p(h,w("String"),"to_str").$to_s(),u=p(u,w("String"),"to_str").$to_s(),0==h.length||h===u)return l;var f,_,x,S,Q,le,Ce,T={},O=h.split(""),re=O.length,j=u.split(""),ve=j.length,de=!1,Ee=null;"^"===O[0]&&O.length>1&&(de=!0,O.shift(),Ee=j[ve-1],re-=1);var ce=[],he=null;for(_=!1,f=0;f<re;f++)if(S=O[f],null==he)he=S,ce.push(S);else if("-"===S)"-"===he?(ce.push("-"),ce.push("-")):f==re-1?ce.push("-"):_=!0;else if(_){for((Q=he.charCodeAt(0))>(le=S.charCodeAt(0))&&H.$raise(w("ArgumentError"),'invalid range "'+String.fromCharCode(Q)+"-"+String.fromCharCode(le)+'" in string transliteration'),x=Q+1;x<le;x++)ce.push(String.fromCharCode(x));ce.push(S),_=null,he=null}else ce.push(S);if(re=(O=ce).length,de)for(f=0;f<re;f++)T[O[f]]=!0;else{if(ve>0){var B=[],R=null;for(_=!1,f=0;f<ve;f++)if(S=j[f],null==R)R=S,B.push(S);else if("-"===S)"-"===R?(B.push("-"),B.push("-")):f==ve-1?B.push("-"):_=!0;else if(_){for((Q=R.charCodeAt(0))>(le=S.charCodeAt(0))&&H.$raise(w("ArgumentError"),'invalid range "'+String.fromCharCode(Q)+"-"+String.fromCharCode(le)+'" in string transliteration'),x=Q+1;x<le;x++)B.push(String.fromCharCode(x));B.push(S),_=null,R=null}else B.push(S);ve=(j=B).length}var ie=re-ve;if(ie>0){var W=ve>0?j[ve-1]:"";for(f=0;f<ie;f++)j.push(W)}for(f=0;f<re;f++)T[O[f]]=j[f]}var me="";for(f=0,Ce=l.length;f<Ce;f++){var $e=T[S=l.charAt(f)];me+=de?null==$e?Ee:S:null!=$e?$e:S}return l.$$cast(me)},2),D(N,"$tr_s",function(h,u){var l=this;if(h=p(h,w("String"),"to_str").$to_s(),u=p(u,w("String"),"to_str").$to_s(),0==h.length)return l;var f,_,x,S,Q,le,Ce,T={},O=h.split(""),re=O.length,j=u.split(""),ve=j.length,de=!1,Ee=null;"^"===O[0]&&O.length>1&&(de=!0,O.shift(),Ee=j[ve-1],re-=1);var ce=[],he=null;for(_=!1,f=0;f<re;f++)if(S=O[f],null==he)he=S,ce.push(S);else if("-"===S)"-"===he?(ce.push("-"),ce.push("-")):f==re-1?ce.push("-"):_=!0;else if(_){for((Q=he.charCodeAt(0))>(le=S.charCodeAt(0))&&H.$raise(w("ArgumentError"),'invalid range "'+String.fromCharCode(Q)+"-"+String.fromCharCode(le)+'" in string transliteration'),x=Q+1;x<le;x++)ce.push(String.fromCharCode(x));ce.push(S),_=null,he=null}else ce.push(S);if(re=(O=ce).length,de)for(f=0;f<re;f++)T[O[f]]=!0;else{if(ve>0){var B=[];for(_=!1,f=0;f<ve;f++)if(S=j[f],null==he)he=S,B.push(S);else if("-"===S)f==ve-1?B.push("-"):_=!0;else if(_){for((Q=he.charCodeAt(0))>(le=S.charCodeAt(0))&&H.$raise(w("ArgumentError"),'invalid range "'+String.fromCharCode(Q)+"-"+String.fromCharCode(le)+'" in string transliteration'),x=Q+1;x<le;x++)B.push(String.fromCharCode(x));B.push(S),_=null,he=null}else B.push(S);ve=(j=B).length}var ie=re-ve;if(ie>0){var W=ve>0?j[ve-1]:"";for(f=0;f<ie;f++)j.push(W)}for(f=0;f<re;f++)T[O[f]]=j[f]}var me="",$e=null;for(f=0,Ce=l.length;f<Ce;f++){var _e=T[S=l.charAt(f)];de?null==_e?null==$e&&(me+=Ee,$e=!0):(me+=S,$e=null):null!=_e?(null==$e||$e!==_e)&&(me+=_e,$e=_e):(me+=S,$e=null)}return l.$$cast(me)},2),D(N,"$upcase",function(){return this.$$cast(this.toUpperCase())},0),D(N,"$upto",function C(h,u){var l=C.$$p||y,f=this;if(delete C.$$p,null==u&&(u=!1),l===y)return f.$enum_for("upto",h,u);var _,x,S=f.toString();if(h=p(h,w("String"),"to_str"),1===S.length&&1===h.length)for(_=S.charCodeAt(0),x=h.charCodeAt(0);_<=x&&(!u||_!==x);)l(String.fromCharCode(_)),_+=1;else if(parseInt(S,10).toString()===S&&parseInt(h,10).toString()===h)for(_=parseInt(S,10),x=parseInt(h,10);_<=x&&(!u||_!==x);)l(_.toString()),_+=1;else for(;S.length<=h.length&&S<=h&&(!u||S!==h);)l(S),S=S.$succ();return f},-2),D(N,"$instance_variables",function(){return[]},0),F(N,"$_load",function(h){var u,f=this;return u=E.slice.call(arguments),oe(f,"new",G(u))},-1),D(N,"$unicode_normalize",function(h){return null==h&&(h="nfc"),se(["nfc","nfd","nfkc","nfkd"]["$include?"](h))||H.$raise(w("ArgumentError"),"Invalid normalization form "+h),this.normalize(h.$upcase())},-1),D(N,"$unicode_normalized?",function(h){return null==h&&(h="nfc"),this.$unicode_normalize(h)["$=="](this)},-1),D(N,"$unpack",function(h){return H.$raise("To use String#unpack, you must first require 'corelib/string/unpack'.")},1),D(N,"$unpack1",function(h){return H.$raise("To use String#unpack1, you must first require 'corelib/string/unpack'.")},1),D(N,"$freeze",function(){var h=this;return"string"==typeof h||(h.$$frozen=!0),h},0),D(N,"$-@",function(){var h=this;return"string"==typeof h||!0===h.$$frozen?h:"UTF-8"==h.encoding.name&&"UTF-8"==h.internal_encoding.name?h.toString():h.$dup().$freeze()},0),D(N,"$frozen?",function(){return"string"==typeof this||!0===this.$$frozen},0),ne(N,"+@","dup"),ne(N,"===","=="),ne(N,"byteslice","[]"),ne(N,"eql?","=="),ne(N,"equal?","==="),ne(N,"object_id","__id__"),ne(N,"slice","[]"),ne(N,"succ","next"),ne(N,"to_str","to_s"),ne(N,"to_sym","intern"),$.$pristine(N,"initialize")}(0,0,X),k(X[0],"Symbol",a("String"))},Opal.modules["corelib/enumerable"]=function(E){var ae=E.nil,X=E.$$$,a=E.truthy,y=E.coerce_to,w=E.yield1,p=E.yieldX,d=E.module,M=E.send,v=E.to_a,D=E.Opal,$=E.def,F=E.Kernel,oe=E.rb_gt,G=E.rb_times,L=E.rb_lt,V=E.eqeq,H=E.rb_plus,se=E.rb_minus,ue=E.rb_divide,ee=E.rb_le,Y=E.hash2,ne=E.lambda,k=E.not,q=E.alias;return function(z){var A=d("::","Enumerable");function N(P){return 0===P.length&&(P=[ae]),P.length>1&&(P=[P]),P}return $(A,"$all?",function P(g){try{var b=P.$$p||ae;return delete P.$$p,a(void 0!==g)?M(this,"each",[],function(u){var _=ae;if(_=N(E.slice.call(arguments)),a(M(g,"public_send",["==="].concat(v(_)))))return ae;E.ret(!1)},-1):M(this,"each",[],b!==ae?function(u){var l;if(l=E.slice.call(arguments),a(E.yieldX(b,v(l))))return ae;E.ret(!1)}:function(u){var l;if(l=E.slice.call(arguments),a(D.$destructure(l)))return ae;E.ret(!1)},-1),!0}catch(h){if(h===E.returner)return h.$v;throw h}},-1),$(A,"$any?",function P(g){try{var b=P.$$p||ae;return delete P.$$p,a(void 0!==g)?M(this,"each",[],function(u){var _=ae;if(_=N(E.slice.call(arguments)),!a(M(g,"public_send",["==="].concat(v(_)))))return ae;E.ret(!0)},-1):M(this,"each",[],b!==ae?function(u){var l;if(l=E.slice.call(arguments),!a(E.yieldX(b,v(l))))return ae;E.ret(!0)}:function(u){var l;if(l=E.slice.call(arguments),!a(D.$destructure(l)))return ae;E.ret(!0)},-1),!1}catch(h){if(h===E.returner)return h.$v;throw h}},-1),$(A,"$chunk",function P(){var g=P.$$p||ae,b=this;return delete P.$$p,g===ae?M(b,"to_enum",["chunk"],function C(){return(null==C.$$s?this:C.$$s).$enumerator_size()},{$$arity:0,$$s:b}):M(X("Enumerator"),"new",[],function C(h){var u=null==C.$$s?this:C.$$s;null==h&&(h=ae);var l=ae,f=[];function _(){f.length>0&&h.$yield(l,f)}u.$each.$$p=function(x){var S=w(g,x);S===ae?(_(),f=[],l=ae):(l===ae||l===S?f.push(x):(_(),f=[x]),l=S)},u.$each(),_()},{$$arity:1,$$s:b})},0),$(A,"$chunk_while",function P(){var g=P.$$p||ae;return delete P.$$p,g===ae&&F.$raise(X("ArgumentError"),"no block given"),M(this,"slice_when",[],function(h,u){return null==h&&(h=ae),null==u&&(u=ae),E.yieldX(g,[h,u])["$!"]()},2)},0),$(A,"$collect",function P(){var g=P.$$p||ae,b=this;if(delete P.$$p,g===ae)return M(b,"enum_for",["collect"],function h(){return(null==h.$$s?this:h.$$s).$enumerator_size()},{$$arity:0,$$s:b});var C=[];return b.$each.$$p=function(){var h=p(g,arguments);C.push(h)},b.$each(),C},0),$(A,"$collect_concat",function P(){var g=P.$$p||ae,b=this;return delete P.$$p,g===ae?M(b,"enum_for",["collect_concat"],function C(){return(null==C.$$s?this:C.$$s).$enumerator_size()},{$$arity:0,$$s:b}):M(b,"map",[],function(h){return null==h&&(h=ae),E.yield1(g,h)},1).$flatten(1)},0),$(A,"$compact",function(){return this.$to_a().$compact()},0),$(A,"$count",function P(g){var b=P.$$p||ae,h=ae;return delete P.$$p,h=0,null!=g&&b!==ae&&this.$warn("warning: given block not used"),a(null!=g)?b=M(F,"proc",[],function(l){var f;return f=E.slice.call(arguments),D.$destructure(f)["$=="](g)},-1):a(b["$nil?"]())&&(b=M(F,"proc",[],function(){return!0},0)),M(this,"each",[],function(l){var f;return f=E.slice.call(arguments),a(p(b,f))?h++:ae},-1),h},-1),$(A,"$cycle",function P(g){var b=P.$$p||ae,C=this;if(delete P.$$p,null==g&&(g=ae),b===ae)return M(C,"enum_for",["cycle",g],function _(){var x=null==_.$$s?this:_.$$s;return a(g["$nil?"]())?a(x["$respond_to?"]("size"))?X(X("Float"),"INFINITY"):ae:(g=D["$coerce_to!"](g,X("Integer"),"to_int"),a(oe(g,0))?G(x.$enumerator_size(),g):0)},{$$arity:0,$$s:C});if(!a(g["$nil?"]())&&(g=D["$coerce_to!"](g,X("Integer"),"to_int"),a(g<=0)))return ae;var u,l,h=[];if(C.$each.$$p=function(){var _=D.$destructure(arguments);w(b,_),h.push(_)},C.$each(),0===h.length)return ae;if(g===ae)for(;;)for(u=0,l=h.length;u<l;u++)w(b,h[u]);else for(;g>1;){for(u=0,l=h.length;u<l;u++)w(b,h[u]);g--}},-1),$(A,"$detect",function P(g){try{var b=P.$$p||ae;return delete P.$$p,b===ae?this.$enum_for("detect",g):(M(this,"each",[],function(u){var l,_=ae;if(l=E.slice.call(arguments),_=D.$destructure(l),!a(E.yield1(b,_)))return ae;E.ret(_)},-1),void 0!==g?"function"==typeof g?g():g:ae)}catch(h){if(h===E.returner)return h.$v;throw h}},-1),$(A,"$drop",function(g){g=y(g,X("Integer"),"to_int"),a(g<0)&&F.$raise(X("ArgumentError"),"attempt to drop negative size");var C=[],h=0;return this.$each.$$p=function(){g<=h&&C.push(D.$destructure(arguments)),h++},this.$each(),C},1),$(A,"$drop_while",function P(){var g=P.$$p||ae,b=this;if(delete P.$$p,g===ae)return b.$enum_for("drop_while");var C=[],h=!0;return b.$each.$$p=function(){var u=D.$destructure(arguments);if(h){var l=w(g,u);a(l)||(h=!1,C.push(u))}else C.push(u)},b.$each(),C},0),$(A,"$each_cons",function P(g){var b=P.$$p||ae,C=this;if(delete P.$$p,a(1!=arguments.length)&&F.$raise(X("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 1)"),g=D.$try_convert(g,X("Integer"),"to_int"),a(g<=0)&&F.$raise(X("ArgumentError"),"invalid size"),b===ae)return M(C,"enum_for",["each_cons",g],function u(){var f=ae;return f=(null==u.$$s?this:u.$$s).$enumerator_size(),a(f["$nil?"]())?ae:V(f,0)||a(L(f,g))?0:H(se(f,g),1)},{$$arity:0,$$s:C});var h=[];return C.$each.$$p=function(){var u=D.$destructure(arguments);h.push(u),h.length>g&&h.shift(),h.length==g&&w(b,h.slice(0,g))},C.$each(),C},1),$(A,"$each_entry",function P(g){var h,b=P.$$p||ae,u=this;return delete P.$$p,h=E.slice.call(arguments),b===ae?M(u,"to_enum",["each_entry"].concat(v(h)),function l(){return(null==l.$$s?this:l.$$s).$enumerator_size()},{$$arity:0,$$s:u}):(u.$each.$$p=function(){var l=D.$destructure(arguments);w(b,l)},u.$each.apply(u,h),u)},-1),$(A,"$each_slice",function P(g){var b=P.$$p||ae,C=this;if(delete P.$$p,g=y(g,X("Integer"),"to_int"),a(g<=0)&&F.$raise(X("ArgumentError"),"invalid slice size"),b===ae)return M(C,"enum_for",["each_slice",g],function u(){var l=null==u.$$s?this:u.$$s;return a(l["$respond_to?"]("size"))?ue(l.$size(),g).$ceil():ae},{$$arity:0,$$s:C});var h=[];return C.$each.$$p=function(){var u=D.$destructure(arguments);h.push(u),h.length===g&&(w(b,h),h=[])},C.$each(),h.length>0&&w(b,h),C},1),$(A,"$each_with_index",function P(g){var h,b=P.$$p||ae,u=this;if(delete P.$$p,h=E.slice.call(arguments),b===ae)return M(u,"enum_for",["each_with_index"].concat(v(h)),function f(){return(null==f.$$s?this:f.$$s).$enumerator_size()},{$$arity:0,$$s:u});var l=0;return u.$each.$$p=function(){var f=D.$destructure(arguments);b(f,l),l++},u.$each.apply(u,h),u},-1),$(A,"$each_with_object",function P(g){var b=P.$$p||ae,C=this;return delete P.$$p,b===ae?M(C,"enum_for",["each_with_object",g],function h(){return(null==h.$$s?this:h.$$s).$enumerator_size()},{$$arity:0,$$s:C}):(C.$each.$$p=function(){var h=D.$destructure(arguments);b(h,g)},C.$each(),g)},1),$(A,"$entries",function(g){var C,h=this;C=E.slice.call(arguments);var u=[];return h.$each.$$p=function(){u.push(D.$destructure(arguments))},h.$each.apply(h,C),u},-1),$(A,"$filter_map",function P(){var g=P.$$p||ae,b=this;return delete P.$$p,g===ae?M(b,"enum_for",["filter_map"],function C(){return(null==C.$$s?this:C.$$s).$enumerator_size()},{$$arity:0,$$s:b}):M(M(b,"map",[],g.$to_proc()),"select",[],"itself".$to_proc())},0),$(A,"$find_all",function P(){var g=P.$$p||ae,b=this;if(delete P.$$p,g===ae)return M(b,"enum_for",["find_all"],function h(){return(null==h.$$s?this:h.$$s).$enumerator_size()},{$$arity:0,$$s:b});var C=[];return b.$each.$$p=function(){var h=D.$destructure(arguments),u=w(g,h);a(u)&&C.push(h)},b.$each(),C},0),$(A,"$find_index",function P(g){try{var b=P.$$p||ae,C=this,h=ae;return delete P.$$p,a(void 0===g&&b===ae)?C.$enum_for("find_index"):(null!=g&&b!==ae&&C.$warn("warning: given block not used"),h=0,a(null!=g)?M(C,"each",[],function(l){var f;return f=E.slice.call(arguments),V(D.$destructure(f),g)&&E.ret(h),h+=1},-1):M(C,"each",[],function(l){var f;return f=E.slice.call(arguments),a(E.yieldX(b,v(f)))&&E.ret(h),h+=1},-1),ae)}catch(u){if(u===E.returner)return u.$v;throw u}},-1),$(A,"$first",function(g){try{var C=ae,h=ae;return a(void 0===g)?M(this,"each",[],function(l){null==l&&(l=ae),E.ret(l)},1):(C=[],g=y(g,X("Integer"),"to_int"),a(g<0)&&F.$raise(X("ArgumentError"),"attempt to take negative size"),a(0==g)?[]:(h=0,M(this,"each",[],function(l){var f;if(f=E.slice.call(arguments),C.push(D.$destructure(f)),!a(g<=++h))return ae;E.ret(C)},-1),C))}catch(u){if(u===E.returner)return u.$v;throw u}},-1),$(A,"$grep",function P(g){var b=P.$$p||ae,h=ae;return delete P.$$p,h=[],M(this,"each",[],function(l){var _,x=ae;return x=N(_=E.slice.call(arguments)),a(M(g,"__send__",["==="].concat(v(x))))?(b!==ae?(a(oe(_.$length(),1))&&(_=[_]),_=E.yieldX(b,v(_))):a(ee(_.$length(),1))&&(_=_["$[]"](0)),h.$push(_)):ae},-1),h},1),$(A,"$grep_v",function P(g){var b=P.$$p||ae,h=ae;return delete P.$$p,h=[],M(this,"each",[],function(l){var _,x=ae;return x=N(_=E.slice.call(arguments)),a(M(g,"__send__",["==="].concat(v(x))))?ae:(b!==ae?(a(oe(_.$length(),1))&&(_=[_]),_=E.yieldX(b,v(_))):a(ee(_.$length(),1))&&(_=_["$[]"](0)),h.$push(_))},-1),h},1),$(A,"$group_by",function P(){var g=P.$$p||ae,b=this,C=ae,h=ae,u=ae;return delete P.$$p,g===ae?M(b,"enum_for",["group_by"],function f(){return(null==f.$$s?this:f.$$s).$enumerator_size()},{$$arity:0,$$s:b}):(C=Y([],{}),b.$each.$$p=function(){var f=D.$destructure(arguments),_=w(g,f);(a(h=C["$[]"](_))?h:(u=[_,[]],M(C,"[]=",v(u)),u[se(u.length,1)]))["$<<"](f)},b.$each(),C)},0),$(A,"$include?",function(g){try{return M(this,"each",[],function(h){var u;if(u=E.slice.call(arguments),!V(D.$destructure(u),g))return ae;E.ret(!0)},-1),!1}catch(C){if(C===E.returner)return C.$v;throw C}},1),$(A,"$inject",function P(g,b){var C=P.$$p||ae,h=this;delete P.$$p;var u=g;return C!==ae&&void 0===b?h.$each.$$p=function(){var l=D.$destructure(arguments);void 0!==u?(l=p(C,[u,l]),u=l):u=l}:(void 0===b&&(X("Symbol")["$==="](g)||F.$raise(X("TypeError"),g.$inspect()+" is not a Symbol"),b=g,u=void 0),h.$each.$$p=function(){var l=D.$destructure(arguments);u=void 0!==u?u.$__send__(b,l):l}),h.$each(),null==u?ae:u},-1),$(A,"$lazy",function(){return M(X(X("Enumerator"),"Lazy"),"new",[this,this.$enumerator_size()],function(C,h){var u;return null==C&&(C=ae),u=E.slice.call(arguments,1),M(C,"yield",v(u))},-2)},0),$(A,"$enumerator_size",function(){return a(this["$respond_to?"]("size"))?this.$size():ae},0),$(A,"$max",function P(g){var h,u,b=P.$$p||ae,C=this;return delete P.$$p,void 0===g||g===ae?(C.$each.$$p=function(){var l=D.$destructure(arguments);void 0!==h?((u=b!==ae?p(b,[l,h]):l["$<=>"](h))===ae&&F.$raise(X("ArgumentError"),"comparison failed"),u>0&&(h=l)):h=l},C.$each(),void 0===h?ae:h):(g=y(g,X("Integer"),"to_int"),M(C,"sort",[],b.$to_proc()).$reverse().$first(g))},-1),$(A,"$max_by",function P(g){var h,u,b=P.$$p||ae,C=this;return delete P.$$p,null==g&&(g=ae),a(b)?a(g["$nil?"]())?(C.$each.$$p=function(){var l=D.$destructure(arguments),f=w(b,l);if(void 0===h)return h=l,void(u=f);f["$<=>"](u)>0&&(h=l,u=f)},C.$each(),void 0===h?ae:h):M(C,"sort_by",[],b.$to_proc()).$reverse().$take(g):M(C,"enum_for",["max_by",g],function l(){return(null==l.$$s?this:l.$$s).$enumerator_size()},{$$arity:0,$$s:C})},-1),$(A,"$min",function P(g){var h,b=P.$$p||ae,C=this;return delete P.$$p,null==g&&(g=ae),a(g["$nil?"]())?(C.$each.$$p=b!==ae?function(){var u=D.$destructure(arguments);if(void 0!==h){var l=b(u,h);l===ae&&F.$raise(X("ArgumentError"),"comparison failed"),l<0&&(h=u)}else h=u}:function(){var u=D.$destructure(arguments);void 0!==h?D.$compare(u,h)<0&&(h=u):h=u},C.$each(),void 0===h?ae:h):b!==ae?M(C,"sort",[],function(l,f){return null==l&&(l=ae),null==f&&(f=ae),E.yieldX(b,[l,f])},2).$take(g):C.$sort().$take(g)},-1),$(A,"$min_by",function P(g){var h,u,b=P.$$p||ae,C=this;return delete P.$$p,null==g&&(g=ae),a(b)?a(g["$nil?"]())?(C.$each.$$p=function(){var l=D.$destructure(arguments),f=w(b,l);if(void 0===h)return h=l,void(u=f);f["$<=>"](u)<0&&(h=l,u=f)},C.$each(),void 0===h?ae:h):M(C,"sort_by",[],b.$to_proc()).$take(g):M(C,"enum_for",["min_by",g],function l(){return(null==l.$$s?this:l.$$s).$enumerator_size()},{$$arity:0,$$s:C})},-1),$(A,"$minmax",function P(){var C,g=P.$$p||ae;delete P.$$p,g=a(C=g)?C:M(F,"proc",[],function(_,x){return null==_&&(_=ae),null==x&&(x=ae),_["$<=>"](x)},2);var h=ae,u=ae,l=!0;return this.$each.$$p=function(){var f=D.$destructure(arguments);if(l)h=u=f,l=!1;else{var _=g.$call(h,f);_===ae?F.$raise(X("ArgumentError"),"comparison failed"):_>0&&(h=f);var x=g.$call(u,f);x===ae?F.$raise(X("ArgumentError"),"comparison failed"):x<0&&(u=f)}},this.$each(),[h,u]},0),$(A,"$minmax_by",function P(){var g=P.$$p||ae,b=this;if(delete P.$$p,!a(g))return M(b,"enum_for",["minmax_by"],function f(){return(null==f.$$s?this:f.$$s).$enumerator_size()},{$$arity:0,$$s:b});var u,l,C=ae,h=ae;return b.$each.$$p=function(){var f=D.$destructure(arguments),_=w(g,f);(void 0===u||_["$<=>"](u)<0)&&(C=f,u=_),(void 0===l||_["$<=>"](l)>0)&&(h=f,l=_)},b.$each(),[C,h]},0),$(A,"$none?",function P(g){try{var b=P.$$p||ae;return delete P.$$p,a(void 0!==g)?M(this,"each",[],function(u){var _=ae;if(_=N(E.slice.call(arguments)),!a(M(g,"public_send",["==="].concat(v(_)))))return ae;E.ret(!1)},-1):M(this,"each",[],b!==ae?function(u){var l;if(l=E.slice.call(arguments),!a(E.yieldX(b,v(l))))return ae;E.ret(!1)}:function(u){var l,_=ae;if(l=E.slice.call(arguments),_=D.$destructure(l),!a(_))return ae;E.ret(!1)},-1),!0}catch(h){if(h===E.returner)return h.$v;throw h}},-1),$(A,"$one?",function P(g){try{var b=P.$$p||ae,h=ae;return delete P.$$p,h=0,a(void 0!==g)?M(this,"each",[],function(l){var x=ae;return x=N(E.slice.call(arguments)),a(M(g,"public_send",["==="].concat(v(x))))?(h=H(h,1),a(oe(h,1))?void E.ret(!1):ae):ae},-1):M(this,"each",[],b!==ae?function(l){var f;return f=E.slice.call(arguments),a(E.yieldX(b,v(f)))?(h=H(h,1),a(oe(h,1))?void E.ret(!1):ae):ae}:function(l){var f;return f=E.slice.call(arguments),a(D.$destructure(f))?(h=H(h,1),a(oe(h,1))?void E.ret(!1):ae):ae},-1),h["$=="](1)}catch(u){if(u===E.returner)return u.$v;throw u}},-1),$(A,"$partition",function P(){var g=P.$$p||ae,b=this;if(delete P.$$p,g===ae)return M(b,"enum_for",["partition"],function l(){return(null==l.$$s?this:l.$$s).$enumerator_size()},{$$arity:0,$$s:b});var C=[],h=[];return b.$each.$$p=function(){var l=D.$destructure(arguments),f=w(g,l);a(f)?C.push(l):h.push(l)},b.$each(),[C,h]},0),$(A,"$reject",function P(){var g=P.$$p||ae,b=this;if(delete P.$$p,g===ae)return M(b,"enum_for",["reject"],function h(){return(null==h.$$s?this:h.$$s).$enumerator_size()},{$$arity:0,$$s:b});var C=[];return b.$each.$$p=function(){var h=D.$destructure(arguments),u=w(g,h);a(u)||C.push(h)},b.$each(),C},0),$(A,"$reverse_each",function P(){var g=P.$$p||ae,b=this;if(delete P.$$p,g===ae)return M(b,"enum_for",["reverse_each"],function u(){return(null==u.$$s?this:u.$$s).$enumerator_size()},{$$arity:0,$$s:b});var C=[];b.$each.$$p=function(){C.push(arguments)},b.$each();for(var h=C.length-1;h>=0;h--)p(g,C[h]);return C},0),$(A,"$slice_before",function P(g){var b=P.$$p||ae,C=this;return delete P.$$p,a(void 0===g&&b===ae)&&F.$raise(X("ArgumentError"),"both pattern and block are given"),a(void 0!==g&&b!==ae||arguments.length>1)&&F.$raise(X("ArgumentError"),"wrong number of arguments ("+arguments.length+" expected 1)"),M(X("Enumerator"),"new",[],function h(u){var l=null==h.$$s?this:h.$$s;null==u&&(u=ae);var f=[];l.$each.$$p=b!==ae?void 0===g?function(){var _=D.$destructure(arguments),x=w(b,_);a(x)&&f.length>0&&(u["$<<"](f),f=[]),f.push(_)}:function(){var _=D.$destructure(arguments),x=b(_,g.$dup());a(x)&&f.length>0&&(u["$<<"](f),f=[]),f.push(_)}:function(){var _=D.$destructure(arguments),x=g["$==="](_);a(x)&&f.length>0&&(u["$<<"](f),f=[]),f.push(_)},l.$each(),f.length>0&&u["$<<"](f)},{$$arity:1,$$s:C})},-1),$(A,"$slice_after",function P(g){var b=P.$$p||ae,C=this;return delete P.$$p,a(void 0===g&&b===ae)&&F.$raise(X("ArgumentError"),"both pattern and block are given"),a(void 0!==g&&b!==ae||arguments.length>1)&&F.$raise(X("ArgumentError"),"wrong number of arguments ("+arguments.length+" expected 1)"),a(void 0!==g)&&(b=M(F,"proc",[],function(u){return null==u&&(u=ae),g["$==="](u)},1)),M(X("Enumerator"),"new",[],function h(u){var f,l=null==h.$$s?this:h.$$s;null==u&&(u=ae),l.$each.$$p=function(){var _=D.$destructure(arguments),x=w(b,_);null==f&&(f=[]),a(x)?(f.push(_),u.$yield(f),f=null):f.push(_)},l.$each(),null!=f&&u.$yield(f)},{$$arity:1,$$s:C})},-1),$(A,"$slice_when",function P(){var g=P.$$p||ae;return delete P.$$p,g===ae&&F.$raise(X("ArgumentError"),"wrong number of arguments (0 for 1)"),M(X("Enumerator"),"new",[],function C(h){var u=null==C.$$s?this:C.$$s;null==h&&(h=ae);var l=ae,f=ae;u.$each_cons.$$p=function(){var _=D.$destructure(arguments),x=_[0],S=_[1],Q=p(g,[x,S]);f=S,l===ae&&(l=[]),a(Q)?(l.push(x),h.$yield(l),l=[]):l.push(x)},u.$each_cons(2),l!==ae&&(l.push(f),h.$yield(l))},{$$arity:1,$$s:this})},0),$(A,"$sort",function P(){var C,g=P.$$p||ae;return delete P.$$p,C=this.$to_a(),g===ae&&(g=ne(function(u,l){return null==u&&(u=ae),null==l&&(l=ae),u["$<=>"](l)},2)),M(C,"sort",[],g.$to_proc())},0),$(A,"$sort_by",function P(){var g=P.$$p||ae,b=this,C=ae;return delete P.$$p,g===ae?M(b,"enum_for",["sort_by"],function h(){return(null==h.$$s?this:h.$$s).$enumerator_size()},{$$arity:0,$$s:b}):(C=M(b,"map",[],function(){var u=ae;return u=D.$destructure(arguments),[E.yield1(g,u),u]},0),M(C,"sort!",[],function(u,l){return null==u&&(u=ae),null==l&&(l=ae),u[0]["$<=>"](l[0])},2),M(C,"map!",[],function(u){return null==u&&(u=ae),u[1]},1))},0),$(A,"$sum",function P(g){var b=P.$$p||ae,h=ae,u=ae;return delete P.$$p,null==g&&(g=0),h=g,u=0,M(this,"each",[],function(f){var x,S=ae,Q=ae,le=ae;return x=E.slice.call(arguments),S=b!==ae?E.yieldX(b,v(x)):D.$destructure(x),k([X(X("Float"),"INFINITY"),X(X("Float"),"INFINITY")["$-@"]()]["$include?"](S))&&a(S["$respond_to?"]("-"))?(Q=se(S,u),le=H(h,Q),u=se(se(le,h),Q),h=le):h=H(h,S)},-1),h},-1),$(A,"$take",function(g){return this.$first(g)},1),$(A,"$take_while",function P(){try{var g=P.$$p||ae,C=ae;return delete P.$$p,a(g)?(C=[],M(this,"each",[],function(u){var l,_=ae;return l=E.slice.call(arguments),_=D.$destructure(l),a(E.yield1(g,_))||E.ret(C),C.push(_)},-1)):this.$enum_for("take_while")}catch(h){if(h===E.returner)return h.$v;throw h}},0),$(A,"$uniq",function P(){var g=P.$$p||ae,C=ae;return delete P.$$p,C=Y([],{}),M(this,"each",[],function(u){var l,_=ae,x=ae,S=ae;return l=E.slice.call(arguments),_=D.$destructure(l),x=g!==ae?E.yield1(g,_):_,a(C["$key?"](x))?ae:(M(C,"[]=",v(S=[x,_])),S[se(S.length,1)])},-1),C.$values()},0),$(A,"$tally",function(g){var C;return C=M(M(this,"group_by",[],"itself".$to_proc()),"transform_values",[],"count".$to_proc()),a(g)?(M(C,"each",[],function(u,l){var f;return null==u&&(u=ae),null==l&&(l=ae),f=[u,H(g.$fetch(u,0),l)],M(g,"[]=",v(f)),f[se(f.length,1)]},2),g):C},-1),$(A,"$to_h",function P(g){var h,b=P.$$p||ae,u=this;if(delete P.$$p,h=E.slice.call(arguments),b!==ae)return M(M(u,"map",[],b.$to_proc()),"to_h",v(h));var l=Y([],{});return u.$each.$$p=function(){var f=D.$destructure(arguments),_=D["$coerce_to?"](f,X("Array"),"to_ary");_.$$is_array||F.$raise(X("TypeError"),"wrong element type "+_.$class()+" (expected array)"),2!==_.length&&F.$raise(X("ArgumentError"),"wrong array length (expected 2, was "+_.$length()+")"),E.hash_put(l,_[0],_[1])},u.$each.apply(u,h),l},-1),$(A,"$zip",function P(g){var h,u=this;return delete P.$$p,h=E.slice.call(arguments),M(u.$to_a(),"zip",v(h))},-1),q(A,"find","detect"),q(A,"filter","find_all"),q(A,"flat_map","collect_concat"),q(A,"map","collect"),q(A,"member?","include?"),q(A,"reduce","inject"),q(A,"select","find_all"),q(A,"to_a","entries")}()},Opal.modules["corelib/enumerator/arithmetic_sequence"]=function(E){var k,q,z,X=E.nil,a=E.$$$,y=E.klass,w=E.truthy,p=E.to_a,d=E.eqeq,M=E.Kernel,v=E.def,D=E.rb_gt,$=E.rb_lt,F=E.rb_le,oe=E.rb_ge,G=E.rb_plus,L=E.rb_minus,V=E.eqeqeq,H=E.not,se=E.rb_times,ue=E.rb_divide,ee=E.alias;return k=[],z=[q=y("::",null,"Enumerator")].concat(k),function(A,N,P){var g=y(A,N,"ArithmeticSequence"),b=[g].concat(P),C=E.$r(b),h=g.$$prototype;h.step_arg2=h.receiver_num=h.step_arg1=h.step=h.range=h.topfx=h.bypfx=h.creation_method=h.skipped_arg=X,E.prop(g.$$prototype,"$$is_arithmetic_seq",!0);var u=1/0;return v(g,"$initialize",function(f,_,x){var S,Q=this,le=X;return null==x&&(x="step"),Q.creation_method=x,w(f["$is_a?"](a("Array")))?(S=[].concat(p(f)),Q.step_arg1=null==S[0]?X:S[0],Q.step_arg2=null==S[1]?X:S[1],Q.topfx=null==S[2]?X:S[2],Q.bypfx=null==S[3]?X:S[3],Q.receiver_num=_,Q.step=1,Q.range=w(Q.step_arg2)?(Q.step=Q.step_arg2,E.Range.$new(Q.receiver_num,Q.step_arg1,!1)):w(Q.step_arg1)?E.Range.$new(Q.receiver_num,Q.step_arg1,!1):E.Range.$new(Q.receiver_num,X,!1)):(w(_)||(Q.skipped_arg=!0),S=[f,w(le=_)?le:1],Q.range=S[0],Q.step=S[1]),Q.object=Q,d(Q.step,0)&&M.$raise(C("ArgumentError"),"step can't be 0"),w(Q.step["$respond_to?"]("to_int"))?X:M.$raise(C("ArgumentError"),"no implicit conversion of "+Q.step.$class()+" into Integer")},-2),g.$attr_reader("step"),v(g,"$begin",function(){return this.range.$begin()},0),v(g,"$end",function(){return this.range.$end()},0),v(g,"$exclude_end?",function(){return this.range["$exclude_end?"]()},0),v(g,"$_lesser_than_end?",function(f){var x,S,_=this;return x=w(S=_.$end())?S:u,w(D(_.$step(),0))?w(_["$exclude_end?"]())?$(f,x):F(f,x):w(_["$exclude_end?"]())?D(f,x):oe(f,x)},1),v(g,"$_greater_than_begin?",function(f){var x,S;return x=w(S=this.$begin())?S:u["$-@"](),w(D(this.$step(),0))?D(f,x):$(f,x)},1),v(g,"$first",function(f){var x=this,S=X,Q=X,le=X;if(S=w(Q=x.$begin())?Q:u["$-@"](),!w(f))return w(x["$_lesser_than_end?"](S))?S:X;for(le=[];w(w(Q=x["$_lesser_than_end?"](S))?D(f,0):Q);)le["$<<"](S),S=G(S,x.$step()),f=L(f,1);return le},-1),v(g,"$each",function l(){var S,f=l.$$p||X,x=this,Q=X;if(delete l.$$p,f===X)return x;for(V(X,x.$begin())&&M.$raise(C("TypeError"),"nil can't be coerced into Integer"),Q=w(S=x.$begin())?S:u["$-@"]();w(x["$_lesser_than_end?"](Q));)E.yield1(f,Q),Q=G(Q,x.$step());return x},0),v(g,"$last",function(f){var x=this,S=X,Q=X,le=X;if(V(u,S=x.$end())||V(u["$-@"](),S)?M.$raise(a("FloatDomainError"),x.$end()):V(X,S)&&M.$raise(a("RangeError"),"cannot get the last element of endless arithmetic sequence"),Q=L(x.$end(),L(x.$end(),x.$begin())["$%"](x.$step())),w(x["$_lesser_than_end?"](Q))||(Q=L(Q,x.$step())),!w(f))return w(x["$_greater_than_begin?"](Q))?Q:X;for(le=[];w(w(S=x["$_greater_than_begin?"](Q))?D(f,0):S);)le["$<<"](Q),Q=L(Q,x.$step()),f=L(f,1);return le.$reverse()},-1),v(g,"$size",function(){var _,f=this,x=X;return _=w(D(f.$step(),0))?1:-1,H(f["$_lesser_than_end?"](f.$begin()))?0:w([u["$-@"](),u]["$include?"](f.$step()))?1:w([se(u["$-@"](),_),X]["$include?"](f.$begin()))||w([se(u,_),X]["$include?"](f.$end()))?u:(x=L(f.$end(),L(f.$end(),f.$begin())["$%"](f.$step())),w(f["$_lesser_than_end?"](x))||(x=L(x,f.$step())),G(ue(L(x,f.$begin()),f.$step()).$abs().$to_i(),1))},0),v(g,"$==",function(f){var x,S,Q,le,_=this;return w(x=w(S=w(Q=w(le=_.$class()["$=="](f.$class()))?_.$begin()["$=="](f.$begin()):le)?_.$end()["$=="](f.$end()):Q)?_.$step()["$=="](f.$step()):S)?_["$exclude_end?"]()["$=="](f["$exclude_end?"]()):x},1),v(g,"$hash",function(){var f=this;return[f.$begin(),f.$end(),f.$step(),f["$exclude_end?"]()].$hash()},0),v(g,"$inspect",function(){var f=this,_=X;return w(f.receiver_num)?(_=w(f.step_arg2)?"("+f.topfx+f.step_arg1.$inspect()+", "+f.bypfx+f.step_arg2.$inspect()+")":w(f.step_arg1)?"("+f.topfx+f.step_arg1.$inspect()+")":X,"("+f.receiver_num.$inspect()+"."+f.creation_method+_+")"):(_=w(f.skipped_arg)?X:"("+f.step+")","(("+f.range.$inspect()+")."+f.creation_method+_+")")},0),ee(g,"===","=="),ee(g,"eql?","==")}(q,q,z)},Opal.modules["corelib/enumerator/chain"]=function(E){var G,L,$,ae=E.nil,X=E.$$$,a=E.klass,y=E.def,w=E.send,p=E.to_a,d=E.truthy,M=E.rb_plus;return $=a("::",null,"Enumerator"),(L=(G=a($,$,"Chain")).$$prototype).enums=L.iterated=ae,y(G,"$initialize",function(H){var se,ee=this;return se=E.slice.call(arguments),ee.enums=se,ee.iterated=[],ee.object=ee},-1),y(G,"$each",function V(H){var ue,ee,se=V.$$p||ae,Y=this;return delete V.$$p,ue=E.slice.call(arguments),ee=ue,se===ae?w(Y,"to_enum",["each"].concat(p(ee)),function ne(){return(null==ne.$$s?this:ne.$$s).$size()},{$$arity:0,$$s:Y}):(w(Y.enums,"each",[],function ne(k){var q=null==ne.$$s?this:ne.$$s;return null==q.iterated&&(q.iterated=ae),null==k&&(k=ae),q.iterated["$<<"](k),w(k,"each",p(ee),se.$to_proc())},{$$arity:1,$$s:Y}),Y)},-1),y(G,"$size",function(H){try{var se,ue,ee=this,Y=ae;return se=E.slice.call(arguments),ue=se,Y=0,w(ee.enums,"each",[],function(k){var q;return null==k&&(k=ae),q=w(k,"size",p(ue)),d([ae,X(X("Float"),"INFINITY")]["$include?"](q))&&E.ret(q),Y=M(Y,q)},1),Y}catch(ne){if(ne===E.returner)return ne.$v;throw ne}},-1),y(G,"$rewind",function(){var H=this;return w(H.iterated,"reverse_each",[],function(ue){return null==ue&&(ue=ae),d(ue["$respond_to?"]("rewind"))?ue.$rewind():ae},1),H.iterated=[],H},0),y(G,"$inspect",function(){return"#<Enumerator::Chain: "+this.enums.$inspect()+">"},0)},Opal.modules["corelib/enumerator/generator"]=function(E){var F,H,se,ue,ee,G,ae=[],X=E.nil,a=E.$$$,y=E.breaker,w=E.klass,p=E.truthy,d=E.Kernel,M=E.def,v=E.send;return F=ae,H=G=[w(ae[0],null,"Enumerator")].concat(F),ue=[se=w(G[0],null,"Generator")].concat(H),ee=E.$r(ue),se.$$prototype.block=X,se.$include(a("Enumerable")),M(se,"$initialize",function ne(){var k=ne.$$p||X;return delete ne.$$p,p(k)||d.$raise(a("LocalJumpError"),"no block given"),this.block=k},0),M(se,"$each",function ne(k){var A,q=ne.$$p||X,N=this,P=X;delete ne.$$p,A=E.slice.call(arguments),P=v(ee("Yielder"),"new",[],q.$to_proc());try{A.unshift(P),E.yieldX(N.block,A)}catch(g){if(g===y)return y.$v;throw g}return N},-1)},Opal.modules["corelib/enumerator/lazy"]=function(E){var k,P,g,b,C,q,X=E.nil,a=E.$$$,y=E.truthy,w=E.coerce_to,p=E.yield1,d=E.yieldX,M=E.klass,v=E.send2,D=E.find_super,$=E.to_a,F=E.defs,oe=E.Kernel,G=E.send,L=E.def,V=E.Opal,H=E.rb_lt,se=E.eqeqeq,ue=E.rb_plus,ee=E.alias;return k=[],P=[q=M("::",null,"Enumerator")].concat(k),b=[g=M(q,q,"Lazy")].concat(P),C=E.$r(b),g.$$prototype.enumerator=X,M(g,a("Exception"),"StopLazyError"),F(g,"$for",function u(l,f){var x,S=u.$$p||X,Q=this,le=X;return delete u.$$p,x=E.slice.call(arguments,1),(le=v(Q,D(Q,"for",u,!1,!0),"for",[l].concat($(x)),S)).enumerator=l,le},-2),L(g,"$initialize",function u(l,f){var _=u.$$p||X,x=this;return delete u.$$p,null==f&&(f=X),_===X&&oe.$raise(a("ArgumentError"),"tried to call lazy new without a block"),x.enumerator=l,v(x,D(x,"initialize",u,!1,!0),"initialize",[f],function(Q,le){var T;null==Q&&(Q=X),T=E.slice.call(arguments,1);try{return G(l,"each",$(T),function(re){var ve;(ve=E.slice.call(arguments)).unshift(Q),d(_,ve)},-1)}catch(O){if(!E.rescue(O,[C("StopLazyError")]))throw O;try{return X}finally{E.pop_exception()}}},-2)},-2),L(g,"$lazy",function(){return this},0),L(g,"$collect",function u(){var l=u.$$p||X;return delete u.$$p,y(l)||oe.$raise(a("ArgumentError"),"tried to call lazy map without a block"),G(C("Lazy"),"new",[this,this.$enumerator_size()],function(x,S){var Q;null==x&&(x=X),Q=E.slice.call(arguments,1);var Ce=d(l,Q);x.$yield(Ce)},-2)},0),L(g,"$collect_concat",function u(){var l=u.$$p||X;return delete u.$$p,y(l)||oe.$raise(a("ArgumentError"),"tried to call lazy map without a block"),G(C("Lazy"),"new",[this,X],function(x,S){var Q;null==x&&(x=X),Q=E.slice.call(arguments,1);var Ce=d(l,Q);if(Ce["$respond_to?"]("force")&&Ce["$respond_to?"]("each"))G(Ce,"each",[],function(re){return null==re&&(re=X),x.$yield(re)},1);else{var T=V.$try_convert(Ce,a("Array"),"to_ary");T===X?x.$yield(Ce):G(Ce,"each",[],function(re){return null==re&&(re=X),x.$yield(re)},1)}},-2)},0),L(g,"$drop",function(l){var _,x,S=X;return l=w(l,a("Integer"),"to_int"),y(H(l,0))&&oe.$raise(a("ArgumentError"),"attempt to drop negative size"),_=this.$enumerator_size(),x=se(a("Integer"),_)&&y(H(l,_))?l:_,S=0,G(C("Lazy"),"new",[this,x],function(le,Ce){var O;return null==le&&(le=X),O=E.slice.call(arguments,1),y(H(S,l))?S=ue(S,1):G(le,"yield",$(O))},-2)},1),L(g,"$drop_while",function u(){var l=u.$$p||X,_=X;return delete u.$$p,y(l)||oe.$raise(a("ArgumentError"),"tried to call lazy drop_while without a block"),_=!0,G(C("Lazy"),"new",[this,X],function(S,Q){var Ce;if(null==S&&(S=X),Ce=E.slice.call(arguments,1),!y(_))return G(S,"yield",$(Ce));var T=d(l,Ce);y(T)||(_=!1,G(S,"yield",$(Ce)))},-2)},0),L(g,"$enum_for",function u(l,f){var x,S,Q,_=u.$$p||X,le=this;return delete u.$$p,(x=E.slice.call(arguments)).length>0&&(S=x.shift()),null==S&&(S="each"),Q=x,G(le.$class(),"for",[le,S].concat($(Q)),_.$to_proc())},-1),L(g,"$find_all",function u(){var l=u.$$p||X;return delete u.$$p,y(l)||oe.$raise(a("ArgumentError"),"tried to call lazy select without a block"),G(C("Lazy"),"new",[this,X],function(x,S){var Q,le;null==x&&(x=X),Q=E.slice.call(arguments,1);var Ce=d(l,le=Q);y(Ce)&&G(x,"yield",$(le))},-2)},0),L(g,"$grep",function u(l){var f=u.$$p||X;return delete u.$$p,y(f)?G(C("Lazy"),"new",[this,X],function(S,Q){var le;null==S&&(S=X),le=E.slice.call(arguments,1);var T=V.$destructure(le),O=l["$==="](T);y(O)&&(O=p(f,T),S.$yield(p(f,T)))},-2):G(C("Lazy"),"new",[this,X],function(S,Q){var le;null==S&&(S=X),le=E.slice.call(arguments,1);var T=V.$destructure(le),O=l["$==="](T);y(O)&&S.$yield(T)},-2)},1),L(g,"$reject",function u(){var l=u.$$p||X;return delete u.$$p,y(l)||oe.$raise(a("ArgumentError"),"tried to call lazy reject without a block"),G(C("Lazy"),"new",[this,X],function(x,S){var Q,le;null==x&&(x=X),Q=E.slice.call(arguments,1);var Ce=d(l,le=Q);y(Ce)||G(x,"yield",$(le))},-2)},0),L(g,"$take",function(l){var _,x,S=X;return l=w(l,a("Integer"),"to_int"),y(H(l,0))&&oe.$raise(a("ArgumentError"),"attempt to take negative size"),_=this.$enumerator_size(),x=se(a("Integer"),_)&&y(H(l,_))?l:_,S=0,G(C("Lazy"),"new",[this,x],function(le,Ce){var O;return null==le&&(le=X),O=E.slice.call(arguments,1),y(H(S,l))?(G(le,"yield",$(O)),S=ue(S,1)):oe.$raise(C("StopLazyError"))},-2)},1),L(g,"$take_while",function u(){var l=u.$$p||X;return delete u.$$p,y(l)||oe.$raise(a("ArgumentError"),"tried to call lazy take_while without a block"),G(C("Lazy"),"new",[this,X],function(x,S){var Q,le;null==x&&(x=X),Q=E.slice.call(arguments,1);var Ce=d(l,le=Q);y(Ce)?G(x,"yield",$(le)):oe.$raise(C("StopLazyError"))},-2)},0),L(g,"$inspect",function(){return"#<"+this.$class()+": "+this.enumerator.$inspect()+">"},0),ee(g,"force","to_a"),ee(g,"filter","find_all"),ee(g,"flat_map","collect_concat"),ee(g,"map","collect"),ee(g,"select","find_all"),ee(g,"to_enum","enum_for")},Opal.modules["corelib/enumerator/yielder"]=function(E){var D,L,F,ae=[],X=E.nil,a=E.breaker,y=E.klass,w=E.def,p=E.send,d=E.to_a;return D=ae,F=[y(ae[0],null,"Enumerator")].concat(D),(L=y(F[0],null,"Yielder")).$$prototype.block=X,w(L,"$initialize",function H(){var se=H.$$p||X;return delete H.$$p,this.block=se,this},0),w(L,"$yield",function(se){var ue,Y=this;ue=E.slice.call(arguments);var ne=E.yieldX(Y.block,ue);if(ne===a)throw a;return ne},-1),w(L,"$<<",function(se){return this.$yield(se),this},1),w(L,"$to_proc",function(){return p(this,"proc",[],function ue(ee){var Y,k=null==ue.$$s?this:ue.$$s;return Y=E.slice.call(arguments),p(k,"yield",d(Y))},{$$arity:-1,$$s:this})},0)},Opal.modules["corelib/enumerator"]=function(E){var q,z,A,N,P,a=E.nil,y=E.$$$,w=E.slice,p=E.coerce_to,d=E.klass,M=E.defs,v=E.truthy,D=E.send,$=E.not,F=E.def,oe=E.rb_plus,G=E.to_a,L=E.Opal,V=E.send2,H=E.find_super,se=E.rb_ge,ue=E.Kernel,ee=E.rb_le,Y=E.alias;return E.top.$require("corelib/enumerable"),q=[],A=[z=d("::",null,"Enumerator")].concat(q),N=E.$r(A),(P=z.$$prototype).size=P.args=P.object=P.method=P.values=P.cursor=a,z.$include(y("Enumerable")),z.$$prototype.$$is_enumerator=!0,M(z,"$for",function g(b,C,h){var l,f,_,u=g.$$p||a,x=this;delete g.$$p,(l=E.slice.call(arguments,1)).length>0&&(f=l.shift()),null==f&&(f="each"),_=l;var S=x.$allocate();return S.object=b,S.size=u,S.method=f,S.args=_,S.cursor=0,S},-2),F(z,"$initialize",function g(b){var C=g.$$p||a,l=this;return delete g.$$p,E.slice.call(arguments),l.cursor=0,v(C)?(l.object=D(N("Generator"),"new",[],C.$to_proc()),l.method="each",l.args=[],l.size=arguments[0]||a,v(l.size)&&$(l.size["$respond_to?"]("call"))?l.size=p(l.size,y("Integer"),"to_int"):a):(l.object=arguments[0],l.method=arguments[1]||"each",l.args=w.call(arguments,2),l.size=a)},-1),F(z,"$each",function g(b){var u,C=g.$$p||a,l=this;return delete g.$$p,u=E.slice.call(arguments),v(C["$nil?"]())&&v(u["$empty?"]())?l:(u=oe(l.args,u),v(C["$nil?"]())?D(l.$class(),"new",[l.object,l.method].concat(G(u))):D(l.object,"__send__",[l.method].concat(G(u)),C.$to_proc()))},-1),F(z,"$size",function(){var b=this;return v(b.size["$respond_to?"]("call"))?D(b.size,"call",G(b.args)):b.size},0),F(z,"$with_index",function g(b){var C=g.$$p||a,h=this;if(delete g.$$p,null==b&&(b=0),b=v(b)?p(b,y("Integer"),"to_int"):0,!v(C))return D(h,"enum_for",["with_index",b],function f(){return(null==f.$$s?this:f.$$s).$size()},{$$arity:0,$$s:h});var l=b;return h.$each.$$p=function(){var f=L.$destructure(arguments),_=C(f,l);return l++,_},h.$each()},-1),F(z,"$each_with_index",function g(){var b=g.$$p||a,C=this;return delete g.$$p,b===a?D(C,"enum_for",["each_with_index"],function h(){return(null==h.$$s?this:h.$$s).$size()},{$$arity:0,$$s:C}):(V(C,H(C,"each_with_index",g,!1,!0),"each_with_index",[],b),C.object)},0),F(z,"$rewind",function(){return this.cursor=0,this},0),F(z,"$peek_values",function(){var C,b=this;return b.values=v(C=b.values)?C:D(b,"map",[],function(u){return E.slice.call(arguments)},-1),v(se(b.cursor,b.values.$length()))&&ue.$raise(y("StopIteration"),"iteration reached an end"),b.values["$[]"](b.cursor)},0),F(z,"$peek",function(){var C=a;return C=this.$peek_values(),v(ee(C.$length(),1))?C["$[]"](0):C},0),F(z,"$next_values",function(){var C,b=this;return C=b.$peek_values(),b.cursor=oe(b.cursor,1),C},0),F(z,"$next",function(){var C=a;return C=this.$next_values(),v(ee(C.$length(),1))?C["$[]"](0):C},0),F(z,"$feed",function(b){return this.$raise(N("NotImplementedError"),"Opal doesn't support Enumerator#feed")},1),F(z,"$+",function(b){return y(y("Enumerator"),"Chain").$new(this,b)},1),F(z,"$inspect",function(){var b=this,C=a;return C="#<"+b.$class()+": "+b.object.$inspect()+":"+b.method,v(b.args["$any?"]())&&(C=oe(C,"("+b.args.$inspect()["$[]"](y("Range").$new(1,-2))+")")),oe(C,">")},0),Y(z,"with_object","each_with_object"),z.$autoload("ArithmeticSequence","corelib/enumerator/arithmetic_sequence"),z.$autoload("Chain","corelib/enumerator/chain"),z.$autoload("Generator","corelib/enumerator/generator"),z.$autoload("Lazy","corelib/enumerator/lazy"),z.$autoload("Yielder","corelib/enumerator/yielder")},Opal.modules["corelib/numeric"]=function(E){var A,X=E.nil,a=E.$$$,y=E.klass,w=E.truthy,p=E.Kernel,d=E.def,M=E.to_ary,v=E.eqeqeq,D=E.rb_minus,$=E.rb_times,F=E.rb_lt,oe=E.eqeq,G=E.rb_divide,L=E.Opal,V=E.hash2,H=E.not,se=E.send,ue=E.rb_ge,ee=E.rb_le,Y=E.rb_plus,ne=E.rb_gt,k=E.alias;return E.top.$require("corelib/comparable"),(A=y("::",null,"Numeric")).$include(a("Comparable")),d(A,"$coerce",function(P){var g=this;return w(P["$instance_of?"](g.$class()))?[P,g]:[p.$Float(P),p.$Float(g)]},1),d(A,"$__coerced__",function(P,g){var b,C,f=X;return w(g["$respond_to?"]("coerce"))?(C=g.$coerce(this),(null==(b=M(C))[0]?X:b[0]).$__send__(P,null==b[1]?X:b[1])):v("+",f=P)||v("-",f)||v("*",f)||v("/",f)||v("%",f)||v("&",f)||v("|",f)||v("^",f)||v("**",f)?p.$raise(a("TypeError"),g.$class()+" can't be coerced into Numeric"):v(">",f)||v(">=",f)||v("<",f)||v("<=",f)||v("<=>",f)?p.$raise(a("ArgumentError"),"comparison of "+this.$class()+" with "+g.$class()+" failed"):X},2),d(A,"$<=>",function(P){return w(this["$equal?"](P))?0:X},1),d(A,"$+@",function(){return this},0),d(A,"$-@",function(){return D(0,this)},0),d(A,"$%",function(P){return D(this,$(P,this.$div(P)))},1),d(A,"$abs",function(){var P=this;return F(P,0)?P["$-@"]():P},0),d(A,"$abs2",function(){return $(this,this)},0),d(A,"$angle",function(){return F(this,0)?a(a("Math"),"PI"):0},0),d(A,"$ceil",function(P){return null==P&&(P=0),this.$to_f().$ceil(P)},-1),d(A,"$conj",function(){return this},0),d(A,"$denominator",function(){return this.$to_r().$denominator()},0),d(A,"$div",function(P){return oe(P,0)&&p.$raise(a("ZeroDivisionError"),"divided by o"),G(this,P).$floor()},1),d(A,"$divmod",function(P){return[this.$div(P),this["$%"](P)]},1),d(A,"$fdiv",function(P){return G(this.$to_f(),P)},1),d(A,"$floor",function(P){return null==P&&(P=0),this.$to_f().$floor(P)},-1),d(A,"$i",function(){return p.$Complex(0,this)},0),d(A,"$imag",function(){return 0},0),d(A,"$integer?",function(){return!1},0),d(A,"$nonzero?",function(){return w(this["$zero?"]())?X:this},0),d(A,"$numerator",function(){return this.$to_r().$numerator()},0),d(A,"$polar",function(){return[this.$abs(),this.$arg()]},0),d(A,"$quo",function(P){return G(L["$coerce_to!"](this,a("Rational"),"to_r"),P)},1),d(A,"$real",function(){return this},0),d(A,"$real?",function(){return!0},0),d(A,"$rect",function(){return[this,0]},0),d(A,"$round",function(P){return this.$to_f().$round(P)},-1),d(A,"$step",function N(P,g,b){var h,u,l,f,_,x,C=N.$$p||X,Q=this,le=X;if(delete N.$$p,h=E.slice.call(arguments),null==(u=E.extract_kwargs(h)))u=V([],{});else if(!u.$$is_hash)throw E.ArgumentError.$new("expected kwargs");function Ce(){f===X&&p.$raise(a("TypeError"),"step must be numeric"),null!=f&&f["$=="](0)&&p.$raise(a("ArgumentError"),"step can't be 0"),(f===X||null==f)&&(f=1);var B=f["$<=>"](0);B===X&&p.$raise(a("ArgumentError"),"0 can't be coerced into "+f.$class()),(l===X||null==l)&&(l=B>0?a(a("Float"),"INFINITY"):a(a("Float"),"INFINITY")["$-@"]()),L.$compare(Q,l)}function T(){if(f>0&&Q>l||f<0&&Q<l)return 0;if(f===1/0||f===-1/0)return 1;var B=Math.abs,R=Math.floor,ie=(B(Q)+B(l)+B(l-Q))/B(f)*a(a("Float"),"EPSILON");return ie===1/0||ie===-1/0?0:(ie>.5&&(ie=.5),R((l-Q)/f+ie)+1)}function O(){if(Ce(),0===f)return 1/0;if(f%1!=0)return T();if(f>0&&Q>l||f<0&&Q<l)return 0;var B=Math.ceil,R=Math.abs;return B((R(Q-l)+1)/R(f))}if(h.length>0&&(l=h.shift()),h.length>0&&(f=h.shift()),_=u.$$smap.to,x=u.$$smap.by,void 0!==l&&void 0!==_&&p.$raise(a("ArgumentError"),"to is given twice"),void 0!==f&&void 0!==x&&p.$raise(a("ArgumentError"),"step is given twice"),void 0!==_&&(l=_),void 0!==x&&(f=x),void 0===l&&(l=X),C===X)return(H(l)||w(l["$is_a?"](a("Numeric"))))&&(H(f)||w(f["$is_a?"](a("Numeric"))))?a(a("Enumerator"),"ArithmeticSequence").$new([l,f,w(_)?"to: ":X,w(x)?"by: ":X],Q):se(Q,"enum_for",["step",l,f],O.$to_proc());Ce();var re=f["$negative?"](),j=f["$=="](0)||l===1/0&&!re||l===-1/0&&re;if(Q.$$is_number&&f.$$is_number&&l.$$is_number){if(Q%1!=0||!j&&l%1!=0||f%1!=0){var de=Q.$to_f().valueOf();f=f.$to_f().valueOf(),l=l.$to_f().valueOf();var Ee=T();if(isFinite(f))if(0===f)for(;;)C(de);else for(var ce=0;ce<Ee;ce++){var he=ce*f+Q;(f>=0?l<he:l>he)&&(he=l),C(he)}else 0!==Ee&&C(de);return Q}var ve=Q;if(j)for(;;ve+=f)C(ve);else if(re)for(;ve>=l;ve+=f)C(ve);else for(;ve<=l;ve+=f)C(ve);return Q}for(le=Q;w(re?ue(le,l):ee(le,l));)E.yield1(C,le),le=Y(le,f)},-1),d(A,"$to_c",function(){return p.$Complex(this,0)},0),d(A,"$to_int",function(){return this.$to_i()},0),d(A,"$truncate",function(P){return null==P&&(P=0),this.$to_f().$truncate(P)},-1),d(A,"$zero?",function(){return this["$=="](0)},0),d(A,"$positive?",function(){return ne(this,0)},0),d(A,"$negative?",function(){return F(this,0)},0),d(A,"$dup",function(){return this},0),d(A,"$clone",function(P){if(null==P)P=V([],{});else if(!P.$$is_hash)throw E.ArgumentError.$new("expected kwargs");return this},-1),d(A,"$finite?",function(){return!0},0),d(A,"$infinite?",function(){return X},0),k(A,"arg","angle"),k(A,"conjugate","conj"),k(A,"imaginary","imag"),k(A,"magnitude","abs"),k(A,"modulo","%"),k(A,"phase","arg"),k(A,"rectangular","rect")},Opal.modules["corelib/array"]=function(E){var ae=E.top,a=E.nil,y=E.$$$,w=E.truthy,p=E.falsy,d=E.hash_ids,M=E.yield1,v=E.hash_get,D=E.hash_put,$=E.hash_delete,F=E.coerce_to,oe=E.respond_to,G=E.klass,L=E.defs,V=E.Kernel,H=E.def,se=E.Opal,ue=E.eqeqeq,ee=E.hash2,Y=E.send2,ne=E.find_super,k=E.send,q=E.rb_gt,z=E.rb_times,A=E.eqeq,N=E.rb_minus,P=E.to_a,g=E.to_ary,b=E.gvars,C=E.rb_ge,h=E.rb_lt,u=E.neqeq,l=E.alias;return ae.$require("corelib/enumerable"),ae.$require("corelib/numeric"),function(f,_,x){var S=G("::",Array,"Array"),Q=[S].concat([]),le=E.$r(Q);function T(he,B){return B.$$name===E.Array?he:B.$allocate().$replace(he.$to_a())}function O(he,B,R){for(var ie,W=null,me=new Array(he.length),$e=0,_e=0,Ie=he.length;$e<Ie;$e++){if(!W)try{ie=M(R,he[$e])}catch(Pe){W=Pe}(W||B(ie))&&(me[_e]=he[$e],_e+=1)}if(_e!==$e&&(he.splice.apply(he,[0,me.length].concat(me)),he.splice(_e,me.length)),W)throw W}function re(he,B){var ie,W,me,R=he.length;return ie=B.excl,W=B.begin===a?0:F(B.begin,E.Integer,"to_int"),me=B.end===a?-1:F(B.end,E.Integer,"to_int"),W<0&&(W+=R)<0||(B.excl_rev&&B.begin!==a&&(W+=1),W>R)?a:me<0&&(me+=R)<0?[]:((!ie||B.end===a)&&(me+=1),he.slice(W,me))}function de(he,B){return he===B||0===B?1:B>0&&he>B?de(he-1,B-1)+de(he-1,B):0}S.$include(y("Enumerable")),E.prop(S.$$prototype,"$$is_array",!0),L(S,"$[]",function(B){var W=this;return T(E.slice.call(arguments),W)},-1),H(S,"$initialize",function he(B,R){var me,$e,ie=he.$$p||a,W=this;if(delete he.$$p,null==B&&(B=a),null==R&&(R=a),R!==a&&ie!==a&&V.$warn("warning: block supersedes default value argument"),B>y(y("Integer"),"MAX")&&V.$raise(y("ArgumentError"),"array size too big"),arguments.length>2&&V.$raise(y("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..2)"),0===arguments.length)return W.splice(0,W.length),W;if(1===arguments.length){if(B.$$is_array)return W.$replace(B.$to_a()),W;if(B["$respond_to?"]("to_ary"))return W.$replace(B.$to_ary()),W}if((B=F(B,y("Integer"),"to_int"))<0&&V.$raise(y("ArgumentError"),"negative array size"),W.splice(0,W.length),ie===a)for(me=0;me<B;me++)W.push(R);else for(me=0;me<B;me++)$e=ie(me),W[me]=$e;return W},-1),L(S,"$try_convert",function(B){return se["$coerce_to?"](B,y("Array"),"to_ary")},1),H(S,"$&",function(B){B=ue(y("Array"),B)?B.$to_a():F(B,y("Array"),"to_ary").$to_a();var me,$e,_e,ie=[],W=ee([],{});for(me=0,$e=B.length;me<$e;me++)D(W,B[me],!0);for(me=0,$e=this.length;me<$e;me++)void 0!==$(W,_e=this[me])&&ie.push(_e);return ie},1),H(S,"$|",function(B){B=ue(y("Array"),B)?B.$to_a():F(B,y("Array"),"to_ary").$to_a();var W,me,ie=ee([],{});for(W=0,me=this.length;W<me;W++)D(ie,this[W],!0);for(W=0,me=B.length;W<me;W++)D(ie,B[W],!0);return ie.$keys()},1),H(S,"$*",function(B){if(w(B["$respond_to?"]("to_str")))return this.$join(B.$to_str());B=F(B,y("Integer"),"to_int"),w(B<0)&&V.$raise(y("ArgumentError"),"negative argument");for(var ie=[],W=this.$to_a(),me=0;me<B;me++)ie=ie.concat(W);return ie},1),H(S,"$+",function(B){return B=ue(y("Array"),B)?B.$to_a():F(B,y("Array"),"to_ary").$to_a(),this.concat(B)},1),H(S,"$-",function(B){var R=this;if(B=ue(y("Array"),B)?B.$to_a():F(B,y("Array"),"to_ary").$to_a(),w(0===R.length))return[];if(w(0===B.length))return R.slice();var me,$e,_e,ie=[],W=ee([],{});for(me=0,$e=B.length;me<$e;me++)D(W,B[me],!0);for(me=0,$e=R.length;me<$e;me++)void 0===v(W,_e=R[me])&&ie.push(_e);return ie},1),H(S,"$<<",function(B){return this.push(B),this},1),H(S,"$<=>",function(B){var R=this;if(ue(y("Array"),B))B=B.$to_a();else{if(!w(B["$respond_to?"]("to_ary")))return a;B=B.$to_ary().$to_a()}if(R.$hash()===B.$hash())return 0;for(var ie=Math.min(R.length,B.length),W=0;W<ie;W++){var me=R[W]["$<=>"](B[W]);if(0!==me)return me}return R.length["$<=>"](B.length)},1),H(S,"$==",function(B){var ie={};return function W(me,$e){var _e,Ie,Pe,Ae;if(me===$e)return!0;if(!$e.$$is_array)return!!oe($e,"$to_ary")&&$e["$=="](me);if(me.$$constructor!==Array&&(me=me.$to_a()),$e.$$constructor!==Array&&($e=$e.$to_a()),me.length!==$e.length)return!1;for(ie[me.$object_id()]=!0,_e=0,Ie=me.length;_e<Ie;_e++)if(Ae=$e[_e],(Pe=me[_e]).$$is_array){if(Ae.$$is_array&&Ae.length!==Pe.length||!ie.hasOwnProperty(Pe.$object_id())&&!W(Pe,Ae))return!1}else if(!Pe["$=="](Ae))return!1;return!0}(this,B)},1),H(S,"$[]",function(B,R){return B.$$is_range?re(this,B):B.$$is_arithmetic_seq?function j(he,B){var R,ie=[],W=0;for(R=B.step<0?re(he,{begin:B.range.end,end:B.range.begin,excl:!1,excl_rev:B.range.excl}).$reverse():re(he,B.range);W<R.length;)ie.push(R[W]),W+=Math.abs(B.step);return ie}(this,B):function ve(he,B,R){var ie=he.length;return(B=F(B,E.Integer,"to_int"))<0&&(B+=ie)<0?a:void 0===R?B>=ie||B<0?a:he[B]:(R=F(R,E.Integer,"to_int"))<0||B>ie||B<0?a:he.slice(B,B+R)}(this,B,R)},-2),H(S,"$[]=",function(B,R,ie){var _e,We,W=this,me=a,$e=a,Ie=W.length;if(ue(y("Range"),B)){me=ue(y("Array"),R)?R.$to_a():w(R["$respond_to?"]("to_ary"))?R.$to_ary().$to_a():[R];var Pe=B.excl,Ae=B.begin===a?0:F(B.begin,E.Integer,"to_int"),Ne=B.end===a?-1:F(B.end,E.Integer,"to_int");if(Ae<0&&(Ae+=Ie)<0&&V.$raise(y("RangeError"),B.$inspect()+" out of range"),Ne<0&&(Ne+=Ie),(!Pe||B.end===a)&&(Ne+=1),Ae>Ie)for(_e=Ie;_e<Ae;_e++)W[_e]=a;return W.splice.apply(W,Ne<0?[Ae,0].concat(me):[Ae,Ne-Ae].concat(me)),R}if(w(void 0===ie)?$e=1:($e=R,R=ie,me=ue(y("Array"),R)?R.$to_a():w(R["$respond_to?"]("to_ary"))?R.$to_ary().$to_a():[R]),B=F(B,y("Integer"),"to_int"),$e=F($e,y("Integer"),"to_int"),B<0&&(We=B,(B+=Ie)<0&&V.$raise(y("IndexError"),"index "+We+" too small for array; minimum "+-W.length)),$e<0&&V.$raise(y("IndexError"),"negative length ("+$e+")"),B>Ie)for(_e=Ie;_e<B;_e++)W[_e]=a;return void 0===ie?W[B]=R:W.splice.apply(W,[B,$e].concat(me)),R},-3),H(S,"$any?",function he(B){var R=he.$$p||a;return delete he.$$p,0!==this.length&&Y(this,ne(this,"any?",he,!1,!0),"any?",[B],R)},-1),H(S,"$assoc",function(B){for(var me,ie=0,W=this.length;ie<W;ie++)if((me=this[ie]).length&&me[0]["$=="](B))return me;return a},1),H(S,"$at",function(B){var R=this;return(B=F(B,y("Integer"),"to_int"))<0&&(B+=R.length),B<0||B>=R.length?a:R[B]},1),H(S,"$bsearch_index",function he(){var B=he.$$p||a,R=this;if(delete he.$$p,B===a)return R.$enum_for("bsearch_index");for(var me,_e,ie=0,W=R.length,Ie=!1,Pe=a;ie<W;){if(me=ie+Math.floor((W-ie)/2),!0===(_e=M(B,R[me])))Pe=me,Ie=!0;else if(!1===_e||_e===a)Ie=!1;else if(_e.$$is_number){if(0===_e)return me;Ie=_e<0}else V.$raise(y("TypeError"),"wrong argument type "+_e.$class()+" (must be numeric, true, false or nil)");Ie?W=me:ie=me+1}return Pe},0),H(S,"$bsearch",function he(){var B=he.$$p||a,R=this,ie=a;return delete he.$$p,B===a?R.$enum_for("bsearch"):null!=(ie=k(R,"bsearch_index",[],B.$to_proc()))&&ie.$$is_number?R[ie]:ie},0),H(S,"$cycle",function he(B){var W,me,R=he.$$p||a,ie=this;if(delete he.$$p,null==B&&(B=a),R===a)return k(ie,"enum_for",["cycle",B],function _e(){var Ie=null==_e.$$s?this:_e.$$s;return w(B["$nil?"]())?y(y("Float"),"INFINITY"):(B=se["$coerce_to!"](B,y("Integer"),"to_int"),w(q(B,0))?z(Ie.$enumerator_size(),B):0)},{$$arity:0,$$s:ie});if(w(ie["$empty?"]())||A(B,0))return a;if(B===a)for(;;)for(W=0,me=ie.length;W<me;W++)M(R,ie[W]);else{if((B=se["$coerce_to!"](B,y("Integer"),"to_int"))<=0)return ie;for(;B>0;){for(W=0,me=ie.length;W<me;W++)M(R,ie[W]);B--}}return ie},-1),H(S,"$clear",function(){var B=this;return B.splice(0,B.length),B},0),H(S,"$count",function he(B){var R=he.$$p||a;return delete he.$$p,w(void 0!==B)||w(R)?Y(this,ne(this,"count",he,!1,!0),"count",[B],R):this.$size()},-1),H(S,"$initialize_copy",function(B){return this.$replace(B)},1),H(S,"$collect",function he(){var B=he.$$p||a,R=this;if(delete he.$$p,B===a)return k(R,"enum_for",["collect"],function _e(){return(null==_e.$$s?this:_e.$$s).$size()},{$$arity:0,$$s:R});for(var ie=[],W=0,me=R.length;W<me;W++){var $e=M(B,R[W]);ie.push($e)}return ie},0),H(S,"$collect!",function he(){var B=he.$$p||a,R=this;if(delete he.$$p,B===a)return k(R,"enum_for",["collect!"],function $e(){return(null==$e.$$s?this:$e.$$s).$size()},{$$arity:0,$$s:R});for(var ie=0,W=R.length;ie<W;ie++){var me=M(B,R[ie]);R[ie]=me}return R},0),H(S,"$combination",function he(B){var W,me,$e,_e,Ie,Pe,Ae,Ne,R=he.$$p||a,ie=this;if(delete he.$$p,W=se["$coerce_to!"](B,y("Integer"),"to_int"),R===a)return k(ie,"enum_for",["combination",W],function We(){return de((null==We.$$s?this:We.$$s).length,W)},{$$arity:0,$$s:ie});if(0===W)E.yield1(R,[]);else if(1===W)for(me=0,$e=ie.length;me<$e;me++)E.yield1(R,[ie[me]]);else if(W===ie.length)E.yield1(R,ie.slice());else if(W>=0&&W<ie.length){for(_e=[],me=0;me<=W+1;me++)_e.push(0);for(Ie=[],Pe=0,Ae=!1,_e[0]=-1;!Ae;){for(Ie[Pe]=ie[_e[Pe+1]];Pe<W-1;)Ne=_e[1+ ++Pe]=_e[Pe]+1,Ie[Pe]=ie[Ne];E.yield1(R,Ie.slice()),Pe++;do{Ae=0===Pe,_e[Pe]++,Pe--}while(_e[Pe+1]+W===ie.length+Pe+1)}}return ie},1),H(S,"$repeated_combination",function he(B){var W,R=he.$$p||a;return delete he.$$p,W=se["$coerce_to!"](B,y("Integer"),"to_int"),R===a?k(this,"enum_for",["repeated_combination",W],function $e(){return de((null==$e.$$s?this:$e.$$s).length+W-1,W)},{$$arity:0,$$s:this}):(W>=0&&function me($e,_e,Ie,Pe){if(Ie.length!=$e)for(var Ne=_e;Ne<Pe.length;Ne++)Ie.push(Pe[Ne]),me($e,Ne,Ie,Pe),Ie.pop();else{var Ae=Ie.slice();E.yield1(R,Ae)}}(W,0,[],this),this)},1),H(S,"$compact",function(){for(var me,R=[],ie=0,W=this.length;ie<W;ie++)(me=this[ie])!==a&&R.push(me);return R},0),H(S,"$compact!",function(){for(var B=this,R=B.length,ie=0,W=B.length;ie<W;ie++)B[ie]===a&&(B.splice(ie,1),W--,ie--);return B.length===R?a:B},0),H(S,"$concat",function(B){var R,ie,W=this;return R=E.slice.call(arguments),ie=k(ie=R,"map",[],function me($e){var _e=null==me.$$s?this:me.$$s;return null==$e&&($e=a),$e=ue(y("Array"),$e)?$e.$to_a():F($e,y("Array"),"to_ary").$to_a(),w($e["$equal?"](_e))&&($e=$e.$dup()),$e},{$$arity:1,$$s:W}),k(ie,"each",[],function me($e){var _e=null==me.$$s?this:me.$$s;null==$e&&($e=a);for(var Ie=0,Pe=$e.length;Ie<Pe;Ie++)_e.push($e[Ie])},{$$arity:1,$$s:W}),W},-1),H(S,"$delete",function he(B){var R=he.$$p||a;delete he.$$p;for(var W=this.length,me=0,$e=W;me<$e;me++)this[me]["$=="](B)&&(this.splice(me,1),$e--,me--);return this.length===W?R!==a?E.yieldX(R,[]):a:B},1),H(S,"$delete_at",function(B){var R=this;if((B=F(B,y("Integer"),"to_int"))<0&&(B+=R.length),B<0||B>=R.length)return a;var ie=R[B];return R.splice(B,1),ie},1),H(S,"$delete_if",function he(){var B=he.$$p||a,R=this;return delete he.$$p,B===a?k(R,"enum_for",["delete_if"],function ie(){return(null==ie.$$s?this:ie.$$s).$size()},{$$arity:0,$$s:R}):(O(R,p,B),R)},0),H(S,"$difference",function(B){var R,W=this;return R=E.slice.call(arguments),k(R,"reduce",[W.$to_a().$dup()],function($e,_e){return null==$e&&($e=a),null==_e&&(_e=a),N($e,_e)},2)},-1),H(S,"$dig",function(B,R){var W,me=this,$e=a;return W=E.slice.call(arguments,1),($e=me["$[]"](B))===a||0===W.length?$e:(w($e["$respond_to?"]("dig"))||V.$raise(y("TypeError"),$e.$class()+" does not have #dig method"),k($e,"dig",P(W)))},-2),H(S,"$drop",function(B){return(B=F(B,y("Integer"),"to_int"))<0&&V.$raise(y("ArgumentError")),this.slice(B)},1),H(S,"$dup",function he(){var B=he.$$p||a,R=this;return delete he.$$p,R.$$class===E.Array&&R.$$class.$allocate.$$pristine&&R.$copy_instance_variables.$$pristine&&R.$initialize_dup.$$pristine?R.slice(0):Y(R,ne(R,"dup",he,!1,!0),"dup",[],B)},0),H(S,"$each",function he(){var B=he.$$p||a,R=this;if(delete he.$$p,B===a)return k(R,"enum_for",["each"],function $e(){return(null==$e.$$s?this:$e.$$s).$size()},{$$arity:0,$$s:R});for(var ie=0,W=R.length;ie<W;ie++)M(B,R[ie]);return R},0),H(S,"$each_index",function he(){var B=he.$$p||a,R=this;if(delete he.$$p,B===a)return k(R,"enum_for",["each_index"],function $e(){return(null==$e.$$s?this:$e.$$s).$size()},{$$arity:0,$$s:R});for(var ie=0,W=R.length;ie<W;ie++)M(B,ie);return R},0),H(S,"$empty?",function(){return 0===this.length},0),H(S,"$eql?",function(B){var ie={};return function W(me,$e){var _e,Ie,Pe,Ae;if(!$e.$$is_array||($e=$e.$to_a(),me.length!==$e.length))return!1;for(ie[me.$object_id()]=!0,_e=0,Ie=me.length;_e<Ie;_e++)if(Ae=$e[_e],(Pe=me[_e]).$$is_array){if(Ae.$$is_array&&Ae.length!==Pe.length||!ie.hasOwnProperty(Pe.$object_id())&&!W(Pe,Ae))return!1}else if(!Pe["$eql?"](Ae))return!1;return!0}(this,B)},1),H(S,"$fetch",function he(B,R){var ie=he.$$p||a,W=this;delete he.$$p;var me=B;return(B=F(B,y("Integer"),"to_int"))<0&&(B+=W.length),B>=0&&B<W.length?W[B]:(ie!==a&&null!=R&&W.$warn("warning: block supersedes default value argument"),ie!==a?ie(me):null!=R?R:void V.$raise(y("IndexError"),0===W.length?"index "+me+" outside of array bounds: 0...0":"index "+me+" outside of array bounds: -"+W.length+"..."+W.length))},-2),H(S,"$fill",function he(B){var W,me,nt,jt,R=he.$$p||a,_e=this,Ie=a,Pe=a,Ae=a,Ne=a,We=a;if(delete he.$$p,W=E.slice.call(arguments),w(R)?(w(W.length>2)&&V.$raise(y("ArgumentError"),"wrong number of arguments ("+W.$length()+" for 0..2)"),Ie=null==(me=g(W))[0]?a:me[0],Pe=null==me[1]?a:me[1]):(w(0==W.length)?V.$raise(y("ArgumentError"),"wrong number of arguments (0 for 1..3)"):w(W.length>3)&&V.$raise(y("ArgumentError"),"wrong number of arguments ("+W.$length()+" for 1..3)"),Ae=null==(me=g(W))[0]?a:me[0],Ie=null==me[1]?a:me[1],Pe=null==me[2]?a:me[2]),ue(y("Range"),Ie)){if(w(Pe)&&V.$raise(y("TypeError"),"length invalid with range"),Ne=Ie.begin===a?0:F(Ie.begin,y("Integer"),"to_int"),w(Ne<0)&&(Ne+=this.length),w(Ne<0)&&V.$raise(y("RangeError"),Ie.$inspect()+" out of range"),We=Ie.end===a?-1:F(Ie.end,y("Integer"),"to_int"),w(We<0)&&(We+=this.length),w(Ie["$exclude_end?"]())||(We+=1),w(We<=Ne))return _e}else if(w(Ie))if(Ne=F(Ie,y("Integer"),"to_int"),w(Ne<0)&&(Ne+=this.length),w(Ne<0)&&(Ne=0),w(Pe)){if(We=F(Pe,y("Integer"),"to_int"),w(0==We))return _e;We+=Ne}else We=this.length;else Ne=0,We=this.length;if(w(Ne>this.length))for(nt=this.length;nt<We;nt++)_e[nt]=a;if(w(We>this.length)&&(this.length=We),w(R))for(;Ne<We;Ne++)jt=R(Ne),_e[Ne]=jt;else for(;Ne<We;Ne++)_e[Ne]=Ae;return _e},-1),H(S,"$first",function(B){var R=this;return null==B?0===R.length?a:R[0]:((B=F(B,y("Integer"),"to_int"))<0&&V.$raise(y("ArgumentError"),"negative array size"),R.slice(0,B))},-1),H(S,"$flatten",function(B){var R=this;return void 0!==B&&(B=F(B,y("Integer"),"to_int")),function ie(W,me){var _e,Ie,Pe,Ae,$e=[];for(_e=0,Ie=(W=W.$to_a()).length;_e<Ie;_e++)if(oe(Pe=W[_e],"$to_ary",!0))if((Ae=Pe.$to_ary())!==a)switch(Ae.$$is_array||V.$raise(y("TypeError")),Ae===R&&V.$raise(y("ArgumentError")),me){case void 0:$e=$e.concat(ie(Ae));break;case 0:$e.push(Ae);break;default:$e.push.apply($e,ie(Ae,me-1))}else $e.push(Pe);else $e.push(Pe);return $e}(R,B)},-1),H(S,"$flatten!",function(B){var R=this,ie=R.$flatten(B);if(R.length==ie.length){for(var W=0,me=R.length;W<me&&R[W]===ie[W];W++);if(W==me)return a}return R.$replace(ie),R},-1),H(S,"$hash",function(){var $e,_e,B=this,R=void 0===d,ie=["A"],W=B.$object_id();try{if(R&&(d=Object.create(null)),d[W])return"self";for(_e in d)if(B["$eql?"](d[_e]))return"self";for(d[W]=B,$e=0;$e<B.length;$e++)ie.push(B[$e].$hash());return ie.join(",")}finally{R&&(d=void 0)}},0),H(S,"$include?",function(B){for(var ie=0,W=this.length;ie<W;ie++)if(this[ie]["$=="](B))return!0;return!1},1),H(S,"$index",function he(B){var W,me,$e,R=he.$$p||a,ie=this;if(delete he.$$p,null!=B&&R!==a&&ie.$warn("warning: given block not used"),null!=B){for(W=0,me=ie.length;W<me;W++)if(ie[W]["$=="](B))return W}else{if(R===a)return ie.$enum_for("index");for(W=0,me=ie.length;W<me;W++)if(!1!==($e=R(ie[W]))&&$e!==a)return W}return a},-1),H(S,"$insert",function(B,R){var W,me=this;if(W=E.slice.call(arguments,1),B=F(B,y("Integer"),"to_int"),W.length>0){if(B<0&&(B+=me.length+1)<0&&V.$raise(y("IndexError"),B+" is out of bounds"),B>me.length)for(var $e=me.length;$e<B;$e++)me.push(a);me.splice.apply(me,[B,0].concat(W))}return me},-2);var R,Ee=[];return H(S,"$inspect",function(){var B=this,R=[],ie=B.$__id__(),W=!0;return function(){try{if(-1!==Ee.indexOf(ie))return W=!1,"[...]";Ee.push(ie);for(var me=0,$e=B.length;me<$e;me++){var _e=B["$[]"](me);R.push(le("Opal").$inspect(_e))}return"["+R.join(", ")+"]"}finally{W&&Ee.pop()}}()},0),H(S,"$intersection",function(B){var R,W=this;return R=E.slice.call(arguments),k(R,"reduce",[W.$to_a().$dup()],function($e,_e){return null==$e&&($e=a),null==_e&&(_e=a),$e["$&"](_e)},2)},-1),H(S,"$intersect?",function(B){return this.$intersection(B)["$empty?"]()["$!"]()},1),H(S,"$join",function(B){var R=this;if(null==b[","]&&(b[","]=a),null==B&&(B=a),w(0===R.length))return"";w(B===a)&&(B=b[","]);var W,me,$e,_e,ie=[];for(W=0,me=R.length;W<me;W++)oe($e=R[W],"$to_str")&&(_e=$e.$to_str())!==a?ie.push(_e.$to_s()):oe($e,"$to_ary")&&((_e=$e.$to_ary())===R&&V.$raise(y("ArgumentError")),_e!==a)?ie.push(_e.$join(B)):oe($e,"$to_s")&&(_e=$e.$to_s())!==a?ie.push(_e):V.$raise(y("NoMethodError").$new(le("Opal").$inspect(R.$item())+" doesn't respond to #to_str, #to_ary or #to_s","to_str"));return ie.join(B===a?"":se["$coerce_to!"](B,y("String"),"to_str").$to_s())},-1),H(S,"$keep_if",function he(){var B=he.$$p||a,R=this;return delete he.$$p,B===a?k(R,"enum_for",["keep_if"],function ie(){return(null==ie.$$s?this:ie.$$s).$size()},{$$arity:0,$$s:R}):(O(R,w,B),R)},0),H(S,"$last",function(B){var R=this;return null==B?0===R.length?a:R[R.length-1]:((B=F(B,y("Integer"),"to_int"))<0&&V.$raise(y("ArgumentError"),"negative array size"),B>R.length&&(B=R.length),R.slice(R.length-B,R.length))},-1),H(S,"$length",function(){return this.length},0),H(S,"$max",function he(B){var R=he.$$p||a;return delete he.$$p,k(this.$each(),"max",[B],R.$to_proc())},-1),H(S,"$min",function he(){var B=he.$$p||a;return delete he.$$p,k(this.$each(),"min",[],B.$to_proc())},0),H(S,"$permutation",function he(B){var $e,_e,Ie,R=he.$$p||a,ie=this,W=a,me=a;if(delete he.$$p,R===a)return k(ie,"enum_for",["permutation",B],function Ae(){var Ne=null==Ae.$$s?this:Ae.$$s;return function ce(he,B){for(var R=B>=0?1:0;B;)R*=he,he--,B--;return R}(Ne.length,void 0===B?Ne.length:B)},{$$arity:0,$$s:ie});if(!((B=void 0===B?ie.length:F(B,y("Integer"),"to_int"))<0||ie.length<B))if(0===B)E.yield1(R,[]);else if(1===B)for(var Pe=0;Pe<ie.length;Pe++)E.yield1(R,[ie[Pe]]);else W=le("Array").$new(B),me=le("Array").$new(ie.length,!1),$e=function(Ae,Ne,We,nt,Nt){ie=this;for(var jt=0;jt<ie.length;jt++)if(nt["$[]"](jt)["$!"]())if(Ne[We]=jt,We<Ae-1)nt[jt]=!0,$e.call(ie,Ae,Ne,We+1,nt,Nt),nt[jt]=!1;else{Ie=[];for(var Ot=0;Ot<Ne.length;Ot++)Ie.push(ie[Ne[Ot]]);M(Nt,Ie)}},R!==a?(_e=ie.slice(),$e.call(_e,B,W,0,me,R)):$e.call(ie,B,W,0,me,R);return ie},-1),H(S,"$repeated_permutation",function he(B){var W,R=he.$$p||a;return delete he.$$p,W=se["$coerce_to!"](B,y("Integer"),"to_int"),R===a?k(this,"enum_for",["repeated_permutation",W],function $e(){var _e=null==$e.$$s?this:$e.$$s;return w(C(W,0))?_e.$size()["$**"](W):0},{$$arity:0,$$s:this}):(function me($e,_e,Ie){if(_e.length!=$e)for(var Ae=0;Ae<Ie.length;Ae++)_e.push(Ie[Ae]),me($e,_e,Ie),_e.pop();else{var Pe=_e.slice();E.yield1(R,Pe)}}(W,[],this.slice()),this)},1),H(S,"$pop",function(B){var R=this;return w(void 0===B)?w(0===R.length)?a:R.pop():(B=F(B,y("Integer"),"to_int"),w(B<0)&&V.$raise(y("ArgumentError"),"negative array size"),w(0===R.length)?[]:w(1===B)?[R.pop()]:w(B>R.length)?R.splice(0,R.length):R.splice(R.length-B,R.length))},-1),H(S,"$product",function he(B){var ie,W,R=he.$$p||a,me=this;delete he.$$p,ie=E.slice.call(arguments);var Ne,We,nt,Nt,$e=R!==a?null:[],_e=(W=ie).length+1,Ie=new Array(_e),Pe=new Array(_e),Ae=new Array(_e),jt=1;for(Ae[0]=me,Ne=1;Ne<_e;Ne++)Ae[Ne]=F(W[Ne-1],y("Array"),"to_ary");for(Ne=0;Ne<_e;Ne++){if(0===(Nt=Ae[Ne].length))return $e||me;(jt*=Nt)>2147483647&&V.$raise(y("RangeError"),"too big to product"),Pe[Ne]=Nt,Ie[Ne]=0}e:for(;;){for(nt=[],Ne=0;Ne<_e;Ne++)nt.push(Ae[Ne][Ie[Ne]]);for($e?$e.push(nt):E.yield1(R,nt),Ie[We=_e-1]++;Ie[We]===Pe[We];){if(Ie[We]=0,--We<0)break e;Ie[We]++}}return $e||me},-1),H(S,"$push",function(B){for(var ie,W=this,me=0,$e=(ie=E.slice.call(arguments)).length;me<$e;me++)W.push(ie[me]);return W},-1),H(S,"$rassoc",function(B){for(var me,ie=0,W=this.length;ie<W;ie++)if((me=this[ie]).length&&void 0!==me[1]&&me[1]["$=="](B))return me;return a},1),H(S,"$reject",function he(){var B=he.$$p||a,R=this;if(delete he.$$p,B===a)return k(R,"enum_for",["reject"],function _e(){return(null==_e.$$s?this:_e.$$s).$size()},{$$arity:0,$$s:R});for(var $e,ie=[],W=0,me=R.length;W<me;W++)(!1===($e=B(R[W]))||$e===a)&&ie.push(R[W]);return ie},0),H(S,"$reject!",function he(){var B=he.$$p||a,R=this,ie=a;return delete he.$$p,B===a?k(R,"enum_for",["reject!"],function W(){return(null==W.$$s?this:W.$$s).$size()},{$$arity:0,$$s:R}):(ie=R.$length(),k(R,"delete_if",[],B.$to_proc()),A(R.$length(),ie)?a:R)},0),H(S,"$replace",function(B){var R=this;return B=ue(y("Array"),B)?B.$to_a():F(B,y("Array"),"to_ary").$to_a(),R.splice(0,R.length),R.push.apply(R,B),R},1),H(S,"$reverse",function(){return this.slice(0).reverse()},0),H(S,"$reverse!",function(){return this.reverse()},0),H(S,"$reverse_each",function he(){var B=he.$$p||a,R=this;return delete he.$$p,B===a?k(R,"enum_for",["reverse_each"],function ie(){return(null==ie.$$s?this:ie.$$s).$size()},{$$arity:0,$$s:R}):(k(R.$reverse(),"each",[],B.$to_proc()),R)},0),H(S,"$rindex",function he(B){var W,me,R=he.$$p||a,ie=this;if(delete he.$$p,null!=B&&R!==a&&ie.$warn("warning: given block not used"),null!=B){for(W=ie.length-1;W>=0&&!(W>=ie.length);W--)if(ie[W]["$=="](B))return W}else if(R!==a){for(W=ie.length-1;W>=0&&!(W>=ie.length);W--)if(!1!==(me=R(ie[W]))&&me!==a)return W}else if(null==B)return ie.$enum_for("rindex");return a},-1),H(S,"$rotate",function(B){var ie,W,me,$e,R=this;return null==B&&(B=1),B=F(B,y("Integer"),"to_int"),1===R.length?R.slice():0===R.length?[]:(me=(ie=R.slice()).slice(W=B%ie.length),$e=ie.slice(0,W),me.concat($e))},-1),H(S,"$rotate!",function(B){var R=this,ie=a;return null==B&&(B=1),0===R.length||1===R.length?R:(B=F(B,y("Integer"),"to_int"),ie=R.$rotate(B),R.$replace(ie))},-1),(R=G(S,null,"SampleRandom")).$$prototype.rng=a,H(R,"$initialize",function(me){return this.rng=me},1),H(R,"$rand",function(me){var _e;return _e=F(this.rng.$rand(me),y("Integer"),"to_int"),w(_e<0)&&V.$raise(y("RangeError"),"random value must be >= 0"),w(_e<me)||V.$raise(y("RangeError"),"random value must be less than Array size"),_e},1),H(S,"$sample",function(B,R){var $e,_e,Ie,Pe,Ae,Ne,We,nt,ie=this,W=a,me=a;if(w(void 0===B))return ie.$at(V.$rand(ie.length));if(w(void 0===R)?w(W=se["$coerce_to?"](B,y("Hash"),"to_hash"))?(R=W,B=a):(R=a,B=F(B,y("Integer"),"to_int")):(B=F(B,y("Integer"),"to_int"),R=F(R,y("Hash"),"to_hash")),w(B)&&w(B<0)&&V.$raise(y("ArgumentError"),"count must be greater than 0"),w(R)&&(me=R["$[]"]("random")),me=w(me)&&w(me["$respond_to?"]("rand"))?le("SampleRandom").$new(me):V,!w(B))return ie[me.$rand(ie.length)];switch(B>ie.length&&(B=ie.length),B){case 0:return[];case 1:return[ie[me.$rand(ie.length)]];case 2:return(Pe=me.$rand(ie.length))===(Ae=me.$rand(ie.length))&&(Ae=0===Pe?Pe+1:Pe-1),[ie[Pe],ie[Ae]];default:if(ie.length/B>3){for($e=!1,_e=0,Pe=1,(Ie=le("Array").$new(B))[0]=me.$rand(ie.length);Pe<B;){for(Ne=me.$rand(ie.length),Ae=0;Ae<Pe;){for(;Ne===Ie[Ae];){if(++_e>100){$e=!0;break}Ne=me.$rand(ie.length)}if($e)break;Ae++}if($e)break;Ie[Pe]=Ne,Pe++}if(!$e){for(Pe=0;Pe<B;)Ie[Pe]=ie[Ie[Pe]],Pe++;return Ie}}Ie=ie.slice();for(var Nt=0;Nt<B;Nt++)We=me.$rand(ie.length),nt=Ie[Nt],Ie[Nt]=Ie[We],Ie[We]=nt;return B===ie.length?Ie:Ie["$[]"](0,B)}},-1),H(S,"$select",function he(){var B=he.$$p||a,R=this;if(delete he.$$p,B===a)return k(R,"enum_for",["select"],function Ie(){return(null==Ie.$$s?this:Ie.$$s).$size()},{$$arity:0,$$s:R});for(var $e,_e,ie=[],W=0,me=R.length;W<me;W++)_e=M(B,$e=R[W]),w(_e)&&ie.push($e);return ie},0),H(S,"$select!",function he(){var B=he.$$p||a,R=this;if(delete he.$$p,B===a)return k(R,"enum_for",["select!"],function W(){return(null==W.$$s?this:W.$$s).$size()},{$$arity:0,$$s:R});var ie=R.length;return k(R,"keep_if",[],B.$to_proc()),R.length===ie?a:R},0),H(S,"$shift",function(B){var R=this;return w(void 0===B)?w(0===R.length)?a:function Ce(he){for(var B=he[0],R=1,ie=he.length;R<ie;R++)he[R-1]=he[R];return he.pop(),B}(R):(B=F(B,y("Integer"),"to_int"),w(B<0)&&V.$raise(y("ArgumentError"),"negative array size"),w(0===R.length)?[]:R.splice(0,B))},-1),H(S,"$shuffle",function(B){return this.$dup().$to_a()["$shuffle!"](B)},-1),H(S,"$shuffle!",function(B){var ie,me,$e,R=this,W=R.length;for(void 0!==B&&(B=se["$coerce_to?"](B,y("Hash"),"to_hash"))!==a&&(B=B["$[]"]("random"))!==a&&B["$respond_to?"]("rand")&&(ie=B);W;)ie?((me=ie.$rand(W).$to_int())<0&&V.$raise(y("RangeError"),"random number too small "+me),me>=W&&V.$raise(y("RangeError"),"random number too big "+me)):me=R.$rand(W),$e=R[--W],R[W]=R[me],R[me]=$e;return R},-1),H(S,"$slice!",function(B,R){var ie=this,W=a,me=a,$e=a,_e=a,Ie=a;if(W=a,w(void 0===R))if(ue(y("Range"),B)){W=ie["$[]"](me=B),$e=me.begin===a?0:F(me.begin,y("Integer"),"to_int"),_e=me.end===a?-1:F(me.end,y("Integer"),"to_int"),$e<0&&($e+=ie.length),_e<0?_e+=ie.length:_e>=ie.length&&(_e=ie.length-1,me.excl&&(_e+=1));var Pe=_e-$e;me.excl&&me.end!==a?_e-=1:Pe+=1,$e<ie.length&&$e>=0&&_e<ie.length&&_e>=0&&Pe>0&&ie.splice($e,Pe)}else{if((Ie=F(B,y("Integer"),"to_int"))<0&&(Ie+=ie.length),Ie<0||Ie>=ie.length)return a;W=ie[Ie],0===Ie?ie.shift():ie.splice(Ie,1)}else{if(Ie=F(B,y("Integer"),"to_int"),(R=F(R,y("Integer"),"to_int"))<0)return a;W=ie["$[]"](Ie,R),Ie<0&&(Ie+=ie.length),Ie+R>ie.length&&(R=ie.length-Ie),Ie<ie.length&&Ie>=0&&ie.splice(Ie,R)}return W},-2),H(S,"$sort",function he(){var B=he.$$p||a,R=this;return delete he.$$p,w(R.length>1)?(B===a&&(B=function(ie,W){return ie["$<=>"](W)}),R.slice().sort(function(ie,W){var me=B(ie,W);return me===a&&V.$raise(y("ArgumentError"),"comparison of "+ie.$inspect()+" with "+W.$inspect()+" failed"),q(me,0)?1:h(me,0)?-1:0})):R},0),H(S,"$sort!",function he(){var ie,B=he.$$p||a,R=this;delete he.$$p,ie=B!==a?k(R.slice(),"sort",[],B.$to_proc()):R.slice().$sort(),R.length=0;for(var W=0,me=ie.length;W<me;W++)R.push(ie[W]);return R},0),H(S,"$sort_by!",function he(){var B=he.$$p||a,R=this;return delete he.$$p,B===a?k(R,"enum_for",["sort_by!"],function ie(){return(null==ie.$$s?this:ie.$$s).$size()},{$$arity:0,$$s:R}):R.$replace(k(R,"sort_by",[],B.$to_proc()))},0),H(S,"$take",function(B){return B<0&&V.$raise(y("ArgumentError")),this.slice(0,B)},1),H(S,"$take_while",function he(){var B=he.$$p||a;delete he.$$p;for(var $e,_e,ie=[],W=0,me=this.length;W<me;W++){if(!1===(_e=B($e=this[W]))||_e===a)return ie;ie.push($e)}return ie},0),H(S,"$to_a",function(){var B=this;return B.$$class===E.Array?B:E.Array.$new(B)},0),H(S,"$to_ary",function(){return this},0),H(S,"$to_h",function he(){var B=he.$$p||a,ie=a;delete he.$$p,ie=this,B!==a&&(ie=k(ie,"map",[],B.$to_proc()));var W,$e,me=ie.length,Pe=ee([],{});for(W=0;W<me;W++)($e=se["$coerce_to?"](ie[W],y("Array"),"to_ary")).$$is_array||V.$raise(y("TypeError"),"wrong element type "+$e.$class()+" at "+W+" (expected array)"),2!==$e.length&&V.$raise(y("ArgumentError"),"wrong array length at "+W+" (expected 2, was "+$e.$length()+")"),D(Pe,$e[0],$e[1]);return Pe},0),H(S,"$transpose",function(){var R=a,ie=a;return w(this["$empty?"]())?[]:(R=[],ie=a,k(this,"each",[],function(me){var $e=a;return null==me&&(me=a),me=ue(y("Array"),me)?me.$to_a():F(me,y("Array"),"to_ary").$to_a(),ie=w($e=ie)?$e:me.length,u(me.length,ie)&&V.$raise(y("IndexError"),"element size differs ("+me.length+" should be "+ie+")"),k(me.length,"times",[],function(Ie){var Ae=a;return null==Ie&&(Ie=a),(w($e=R["$[]"](Ie))?$e:(k(R,"[]=",P(Ae=[Ie,[]])),Ae[N(Ae.length,1)]))["$<<"](me.$at(Ie))},1)},1),R)},0),H(S,"$union",function(B){var R,W=this;return R=E.slice.call(arguments),k(R,"reduce",[W.$uniq()],function($e,_e){return null==$e&&($e=a),null==_e&&(_e=a),$e["$|"](_e)},2)},-1),H(S,"$uniq",function he(){var B=he.$$p||a,R=this;delete he.$$p;var W,me,$e,_e,ie=ee([],{});if(B===a)for(W=0,me=R.length;W<me;W++)void 0===v(ie,$e=R[W])&&D(ie,$e,$e);else for(W=0,me=R.length;W<me;W++)_e=M(B,$e=R[W]),void 0===v(ie,_e)&&D(ie,_e,$e);return ie.$values()},0),H(S,"$uniq!",function he(){var B=he.$$p||a,R=this;delete he.$$p;var me,$e,_e,Ie,ie=R.length,W=ee([],{});for(me=0,$e=ie;me<$e;me++)_e=R[me],Ie=B===a?_e:M(B,_e),void 0!==v(W,Ie)?(R.splice(me,1),$e--,me--):D(W,Ie,_e);return R.length===ie?a:R},0),H(S,"$unshift",function(B){var R,ie,W=this;R=E.slice.call(arguments);var me=W.length,$e=(ie=R).length;if(0==$e)return W;for(var _e=me-$e,Ie=0;Ie<$e;Ie++)W.push(W[_e+Ie]);for(var Pe=me-1;Pe-$e>=0;)W[Pe]=W[Pe-$e],Pe--;for(var Ae=0;Ae<$e;Ae++)W[Ae]=ie[Ae];return W},-1),H(S,"$values_at",function(B){var R,W=this,me=a;return R=E.slice.call(arguments),me=[],k(R,"each",[],function $e(_e){var Ie=null==$e.$$s?this:$e.$$s,Pe=a,Ae=a,Ne=a;return null==_e&&(_e=a),w(_e["$is_a?"](y("Range")))?(Pe=_e.$end()===a?-1:F(_e.$end(),y("Integer"),"to_int"),(Ae=_e.$begin()===a?0:F(_e.$begin(),y("Integer"),"to_int"))<0?(Ae+=Ie.length,a):(Pe<0&&(Pe+=Ie.length),_e["$exclude_end?"]()&&_e.$end()!==a&&Pe--,Pe<Ae?a:k(Ae,"upto",[Pe],function We(nt){return null==nt&&(nt=a),me["$<<"]((null==We.$$s?this:We.$$s).$at(nt))},{$$arity:1,$$s:Ie}))):(Ne=F(_e,y("Integer"),"to_int"),me["$<<"](Ie.$at(Ne)))},{$$arity:1,$$s:W}),me},-1),H(S,"$zip",function he(B){var ie,W,R=he.$$p||a,me=this,$e=a;delete he.$$p,ie=E.slice.call(arguments);var Pe,Ae,Ne,We,nt,_e=[],Ie=me.length;for(We=0,nt=(W=ie).length;We<nt;We++)if(!(Ae=W[We]).$$is_array){if(Ae.$$is_range||Ae.$$is_enumerator){W[We]=Ae.$take(Ie);continue}W[We]=(w($e=se["$coerce_to?"](Ae,y("Array"),"to_ary"))?$e:se["$coerce_to!"](Ae,y("Enumerator"),"to_enum","each")).$to_a()}for(Ne=0;Ne<Ie;Ne++){for(Pe=[me[Ne]],We=0,nt=W.length;We<nt;We++)null==(Ae=W[We][Ne])&&(Ae=a),Pe[We+1]=Ae;_e[Ne]=Pe}if(R!==a){for(Ne=0;Ne<Ie;Ne++)E.yield1(R,_e[Ne]);return a}return _e},-1),L(S,"$inherited",function(B){B.$$prototype.$to_a=function(){return this.slice(0,this.length)}},1),H(S,"$instance_variables",function he(){var B=he.$$p||a;return delete he.$$p,k(Y(this,ne(this,"instance_variables",he,!1,!0),"instance_variables",[],B),"reject",[],function(W){var me;return null==W&&(W=a),w(me=/^@\d+$/.test(W))?me:W["$=="]("@length")},1)},0),H(S,"$pack",function(B){return E.slice.call(arguments),V.$raise("To use Array#pack, you must first require 'corelib/array/pack'.")},-1),l(S,"append","push"),l(S,"filter","select"),l(S,"filter!","select!"),l(S,"map","collect"),l(S,"map!","collect!"),l(S,"prepend","unshift"),l(S,"size","length"),l(S,"slice","[]"),l(S,"to_s","inspect"),se.$pristine(S.$singleton_class(),"allocate"),se.$pristine(S,"copy_instance_variables","initialize_dup")}()},Opal.modules["corelib/hash"]=function(E){var A,b,N,P,g,a=E.nil,y=E.$$$,w=E.yield1,p=E.hash,d=E.hash_init,M=E.hash_get,v=E.hash_put,D=E.hash_delete,$=E.klass,F=E.Opal,oe=E.Kernel,G=E.defs,L=E.def,V=E.send,H=E.rb_ge,se=E.rb_gt,ue=E.hash2,ee=E.truthy,Y=E.to_a,ne=E.rb_minus,k=E.alias;return E.top.$require("corelib/enumerable"),A=[],P=[N=$("::",null,"Hash")].concat(A),g=E.$r(P),N.$include(y("Enumerable")),N.$$prototype.$$is_hash=!0,G(N,"$[]",function(h){var l,_,S,f=this,x=(l=E.slice.call(arguments)).length;if(1===x){if((_=F["$coerce_to?"](l["$[]"](0),y("Hash"),"to_hash"))!==a)return f.$allocate()["$merge!"](_);for((l=F["$coerce_to?"](l["$[]"](0),y("Array"),"to_ary"))===a&&oe.$raise(y("ArgumentError"),"odd number of arguments for Hash"),x=l.length,_=f.$allocate(),S=0;S<x;S++)if(l[S].$$is_array)switch(l[S].length){case 1:_.$store(l[S][0],a);break;case 2:_.$store(l[S][0],l[S][1]);break;default:oe.$raise(y("ArgumentError"),"invalid number of elements ("+l[S].length+" for 1..2)")}return _}for(x%2!=0&&oe.$raise(y("ArgumentError"),"odd number of arguments for Hash"),_=f.$allocate(),S=0;S<x;S+=2)_.$store(l[S],l[S+1]);return _},-1),G(N,"$allocate",function(){var u=new this.$$constructor;return d(u),u.$$none=a,u.$$proc=a,u},0),G(N,"$try_convert",function(h){return F["$coerce_to?"](h,y("Hash"),"to_hash")},1),L(N,"$initialize",function C(h){var u=C.$$p||a,l=this;return delete C.$$p,void 0!==h&&u!==a&&oe.$raise(y("ArgumentError"),"wrong number of arguments (1 for 0)"),l.$$none=void 0===h?a:h,l.$$proc=u,l},-1),L(N,"$==",function(h){var u=this;if(u===h)return!0;if(!h.$$is_hash||u.$$keys.length!==h.$$keys.length)return!1;for(var x,S,Q,l=0,f=u.$$keys,_=f.length;l<_;l++)if((x=f[l]).$$is_string?(S=u.$$smap[x],Q=h.$$smap[x]):(S=x.value,Q=M(h,x.key)),void 0===Q||!S["$eql?"](Q))return!1;return!0},1),L(N,"$>=",function(h){var l=a;return h=F["$coerce_to!"](h,y("Hash"),"to_hash"),!(this.$$keys.length<h.$$keys.length)&&(l=!0,V(h,"each",[],function f(_,x){var Q;null==_&&(_=a),null==x&&(x=a),null!=(Q=(null==f.$$s?this:f.$$s).$fetch(_,null))&&Q===x||(l=!1)},{$$arity:2,$$s:this}),l)},1),L(N,"$>",function(h){return h=F["$coerce_to!"](h,y("Hash"),"to_hash"),!(this.$$keys.length<=h.$$keys.length)&&H(this,h)},1),L(N,"$<",function(h){return h=F["$coerce_to!"](h,y("Hash"),"to_hash"),se(h,this)},1),L(N,"$<=",function(h){return h=F["$coerce_to!"](h,y("Hash"),"to_hash"),H(h,this)},1),L(N,"$[]",function(h){var l=M(this,h);return void 0!==l?l:this.$default(h)},1),L(N,"$[]=",function(h,u){return v(this,h,u),u},2),L(N,"$assoc",function(h){for(var x,l=0,f=this.$$keys,_=f.length;l<_;l++)if((x=f[l]).$$is_string){if(x["$=="](h))return[x,this.$$smap[x]]}else if(x.key["$=="](h))return[x.key,x.value];return a},1),L(N,"$clear",function(){return d(this),this},0),L(N,"$clone",function(){var u=new this.$$class;return d(u),E.hash_clone(this,u),u},0),L(N,"$compact",function(){for(var x,S,u=p(),l=0,f=this.$$keys,_=f.length;l<_;l++)(x=f[l]).$$is_string?S=this.$$smap[x]:(S=x.value,x=x.key),S!==a&&v(u,x,S);return u},0),L(N,"$compact!",function(){for(var x,S,h=this,u=!1,l=0,f=h.$$keys,_=f.length;l<_;l++)(x=f[l]).$$is_string?S=h.$$smap[x]:(S=x.value,x=x.key),S===a&&void 0!==D(h,x)&&(u=!0,_--,l--);return u?h:a},0),L(N,"$compare_by_identity",function(){var u,l,f,x,h=this,_=h.$$keys;if(h.$$by_identity)return h;if(0===h.$$keys.length)return h.$$by_identity=!0,h;for(x=ue([],{}).$compare_by_identity(),u=0,l=_.length;u<l;u++)(f=_[u]).$$is_string||(f=f.key),v(x,f,M(h,f));return h.$$by_identity=!0,h.$$map=x.$$map,h.$$smap=x.$$smap,h},0),L(N,"$compare_by_identity?",function(){return!0===this.$$by_identity},0),L(N,"$default",function(h){var u=this;return void 0!==h&&u.$$proc!==a&&void 0!==u.$$proc?u.$$proc.$call(u,h):void 0===u.$$none?a:u.$$none},-1),L(N,"$default=",function(h){return this.$$proc=a,this.$$none=h,h},1),L(N,"$default_proc",function(){return void 0!==this.$$proc?this.$$proc:a},0),L(N,"$default_proc=",function(h){var l=h;return l!==a&&(l=F["$coerce_to!"](l,y("Proc"),"to_proc"))["$lambda?"]()&&2!==l.$arity().$abs()&&oe.$raise(y("TypeError"),"default_proc takes two arguments"),this.$$none=a,this.$$proc=l,h},1),L(N,"$delete",function C(h){var u=C.$$p||a;delete C.$$p;var f=D(this,h);return void 0!==f?f:u!==a?E.yield1(u,h):a},1),L(N,"$delete_if",function C(){var h=C.$$p||a,u=this;if(delete C.$$p,!ee(h))return V(u,"enum_for",["delete_if"],function le(){return(null==le.$$s?this:le.$$s).$size()},{$$arity:0,$$s:u});for(var x,S,Q,l=0,f=u.$$keys,_=f.length;l<_;l++)(x=f[l]).$$is_string?S=u.$$smap[x]:(S=x.value,x=x.key),!1!==(Q=h(x,S))&&Q!==a&&void 0!==D(u,x)&&(_--,l--);return u},0),L(N,"$dig",function(h,u){var f,_=this,x=a;return f=E.slice.call(arguments,1),(x=_["$[]"](h))===a||0===f.length?x:(ee(x["$respond_to?"]("dig"))||oe.$raise(y("TypeError"),x.$class()+" does not have #dig method"),V(x,"dig",Y(f)))},-2),L(N,"$each",function C(){var h=C.$$p||a,u=this;if(delete C.$$p,!ee(h))return V(u,"enum_for",["each"],function Q(){return(null==Q.$$s?this:Q.$$s).$size()},{$$arity:0,$$s:u});for(var x,S,l=0,f=u.$$keys,_=f.length;l<_;l++)(x=f[l]).$$is_string?S=u.$$smap[x]:(S=x.value,x=x.key),w(h,[x,S]);return u},0),L(N,"$each_key",function C(){var h=C.$$p||a,u=this;if(delete C.$$p,!ee(h))return V(u,"enum_for",["each_key"],function S(){return(null==S.$$s?this:S.$$s).$size()},{$$arity:0,$$s:u});for(var x,l=0,f=u.$$keys,_=f.length;l<_;l++)h((x=f[l]).$$is_string?x:x.key);return u},0),L(N,"$each_value",function C(){var h=C.$$p||a,u=this;if(delete C.$$p,!ee(h))return V(u,"enum_for",["each_value"],function S(){return(null==S.$$s?this:S.$$s).$size()},{$$arity:0,$$s:u});for(var x,l=0,f=u.$$keys,_=f.length;l<_;l++)h((x=f[l]).$$is_string?u.$$smap[x]:x.value);return u},0),L(N,"$empty?",function(){return 0===this.$$keys.length},0),L(N,"$except",function(h){var l,f=this;return l=E.slice.call(arguments),V(f.$dup(),"except!",Y(l))},-1),L(N,"$except!",function(h){var u,f=this;return u=E.slice.call(arguments),V(u,"each",[],function _(x){return null==x&&(x=a),(null==_.$$s?this:_.$$s).$delete(x)},{$$arity:1,$$s:f}),f},-1),L(N,"$fetch",function C(h,u){var l=C.$$p||a;delete C.$$p;var _=M(this,h);return void 0!==_?_:l!==a?l(h):void 0!==u?u:oe.$raise(y("KeyError").$new("key not found: "+h.$inspect(),ue(["key","receiver"],{key:h,receiver:this})))},-2),L(N,"$fetch_values",function C(h){var l,u=C.$$p||a,_=this;return delete C.$$p,l=E.slice.call(arguments),V(l,"map",[],function x(S){return null==S&&(S=a),V(null==x.$$s?this:x.$$s,"fetch",[S],u.$to_proc())},{$$arity:1,$$s:_})},-1),L(N,"$flatten",function(h){null==h&&(h=1),h=F["$coerce_to!"](h,y("Integer"),"to_int");for(var S,Q,l=[],f=0,_=this.$$keys,x=_.length;f<x;f++)if((S=_[f]).$$is_string?Q=this.$$smap[S]:(Q=S.value,S=S.key),l.push(S),Q.$$is_array){if(1===h){l.push(Q);continue}l=l.concat(Q.$flatten(h-2))}else l.push(Q);return l},-1),L(N,"$has_key?",function(h){return void 0!==M(this,h)},1),L(N,"$has_value?",function(h){for(var x,l=0,f=this.$$keys,_=f.length;l<_;l++)if(((x=f[l]).$$is_string?this.$$smap[x]:x.value)["$=="](h))return!0;return!1},1),L(N,"$hash",function(){var _,h=this,u=void 0===E.hash_ids,l=h.$object_id(),f=["Hash"];try{if(u&&(E.hash_ids=Object.create(null)),E[l])return"self";for(_ in E.hash_ids)if(h["$eql?"](E.hash_ids[_]))return"self";E.hash_ids[l]=h;for(var S=0,Q=h.$$keys,le=Q.length;S<le;S++)f.push((_=Q[S]).$$is_string?[_,h.$$smap[_].$hash()]:[_.key_hash,_.value.$hash()]);return f.sort().join()}finally{u&&(E.hash_ids=void 0)}},0),L(N,"$index",function(h){for(var x,S,l=0,f=this.$$keys,_=f.length;l<_;l++)if((x=f[l]).$$is_string?S=this.$$smap[x]:(S=x.value,x=x.key),S["$=="](h))return x;return a},1),L(N,"$indexes",function(h){for(var l,le,f=this,_=[],x=0,S=(l=E.slice.call(arguments)).length;x<S;x++)void 0!==(le=M(f,l[x]))?_.push(le):_.push(f.$default());return _},-1),L(N,"$inspect",function(){var h=this,u=void 0===b,l=h.$object_id(),f=[];return function(){try{if(u&&(b={}),b.hasOwnProperty(l))return"{...}";b[l]=!0;for(var Q,le,_=0,x=h.$$keys,S=x.length;_<S;_++)(Q=x[_]).$$is_string?le=h.$$smap[Q]:(le=Q.value,Q=Q.key),Q=g("Opal").$inspect(Q),le=g("Opal").$inspect(le),f.push(Q+"=>"+le);return"{"+f.join(", ")+"}"}finally{u&&(b=void 0)}}()},0),L(N,"$invert",function(){for(var x,S,u=p(),l=0,f=this.$$keys,_=f.length;l<_;l++)(x=f[l]).$$is_string?S=this.$$smap[x]:(S=x.value,x=x.key),v(u,S,x);return u},0),L(N,"$keep_if",function C(){var h=C.$$p||a,u=this;if(delete C.$$p,!ee(h))return V(u,"enum_for",["keep_if"],function le(){return(null==le.$$s?this:le.$$s).$size()},{$$arity:0,$$s:u});for(var x,S,Q,l=0,f=u.$$keys,_=f.length;l<_;l++)(x=f[l]).$$is_string?S=u.$$smap[x]:(S=x.value,x=x.key),(!1===(Q=h(x,S))||Q===a)&&void 0!==D(u,x)&&(_--,l--);return u},0),L(N,"$keys",function(){for(var x,u=[],l=0,f=this.$$keys,_=f.length;l<_;l++)u.push((x=f[l]).$$is_string?x:x.key);return u},0),L(N,"$length",function(){return this.$$keys.length},0),L(N,"$merge",function C(h){var f,u=C.$$p||a,_=this;return delete C.$$p,f=E.slice.call(arguments),V(_.$dup(),"merge!",Y(f),u.$to_proc())},-1),L(N,"$merge!",function C(h){var f,x,S,Q,le,Ce,T,O,re,u=C.$$p||a,_=this;for(delete C.$$p,f=E.slice.call(arguments),x=0;x<f.length;++x)if(Ce=(le=(Q=F["$coerce_to!"](f[x],y("Hash"),"to_hash")).$$keys).length,u===a)for(S=0;S<Ce;S++)(T=le[S]).$$is_string?re=Q.$$smap[T]:(re=T.value,T=T.key),v(_,T,re);else for(S=0;S<Ce;S++)(T=le[S]).$$is_string?re=Q.$$smap[T]:(re=T.value,T=T.key),void 0!==(O=M(_,T))?v(_,T,u(T,O,re)):v(_,T,re);return _},-1),L(N,"$rassoc",function(h){for(var x,S,l=0,f=this.$$keys,_=f.length;l<_;l++)if((x=f[l]).$$is_string?S=this.$$smap[x]:(S=x.value,x=x.key),S["$=="](h))return[x,S];return a},1),L(N,"$rehash",function(){return E.hash_rehash(this),this},0),L(N,"$reject",function C(){var h=C.$$p||a,u=this;if(delete C.$$p,!ee(h))return V(u,"enum_for",["reject"],function Ce(){return(null==Ce.$$s?this:Ce.$$s).$size()},{$$arity:0,$$s:u});for(var S,Q,le,l=p(),f=0,_=u.$$keys,x=_.length;f<x;f++)(S=_[f]).$$is_string?Q=u.$$smap[S]:(Q=S.value,S=S.key),(!1===(le=h(S,Q))||le===a)&&v(l,S,Q);return l},0),L(N,"$reject!",function C(){var h=C.$$p||a,u=this;if(delete C.$$p,!ee(h))return V(u,"enum_for",["reject!"],function Ce(){return(null==Ce.$$s?this:Ce.$$s).$size()},{$$arity:0,$$s:u});for(var S,Q,le,l=!1,f=0,_=u.$$keys,x=_.length;f<x;f++)(S=_[f]).$$is_string?Q=u.$$smap[S]:(Q=S.value,S=S.key),!1!==(le=h(S,Q))&&le!==a&&void 0!==D(u,S)&&(l=!0,x--,f--);return l?u:a},0),L(N,"$replace",function(h){var u=this,l=a;h=F["$coerce_to!"](h,y("Hash"),"to_hash"),d(u);for(var S,le,f=0,_=h.$$keys,x=_.length;f<x;f++)(S=_[f]).$$is_string?le=h.$$smap[S]:(le=S.value,S=S.key),v(u,S,le);return ee(h.$default_proc())?(l=[h.$default_proc()],V(u,"default_proc=",Y(l)),ne(l.length,1)):(l=[h.$default()],V(u,"default=",Y(l)),ne(l.length,1)),u},1),L(N,"$select",function C(){var h=C.$$p||a,u=this;if(delete C.$$p,!ee(h))return V(u,"enum_for",["select"],function Ce(){return(null==Ce.$$s?this:Ce.$$s).$size()},{$$arity:0,$$s:u});for(var S,Q,le,l=p(),f=0,_=u.$$keys,x=_.length;f<x;f++)(S=_[f]).$$is_string?Q=u.$$smap[S]:(Q=S.value,S=S.key),!1!==(le=h(S,Q))&&le!==a&&v(l,S,Q);return l},0),L(N,"$select!",function C(){var h=C.$$p||a,u=this;if(delete C.$$p,!ee(h))return V(u,"enum_for",["select!"],function Ce(){return(null==Ce.$$s?this:Ce.$$s).$size()},{$$arity:0,$$s:u});for(var S,Q,le,l=a,f=0,_=u.$$keys,x=_.length;f<x;f++)(S=_[f]).$$is_string?Q=u.$$smap[S]:(Q=S.value,S=S.key),(!1===(le=h(S,Q))||le===a)&&(void 0!==D(u,S)&&(x--,f--),l=u);return l},0),L(N,"$shift",function(){var l,h=this,u=h.$$keys;return u.length>0?[l=(l=u[0]).$$is_string?l:l.key,D(h,l)]:h.$default(a)},0),L(N,"$slice",function(h){var l,f=this;l=E.slice.call(arguments);for(var _=p(),x=0,S=l.length;x<S;x++){var Q=l[x],le=M(f,Q);void 0!==le&&v(_,Q,le)}return _},-1),L(N,"$to_a",function(){for(var x,S,u=[],l=0,f=this.$$keys,_=f.length;l<_;l++)(x=f[l]).$$is_string?S=this.$$smap[x]:(S=x.value,x=x.key),u.push([x,S]);return u},0),L(N,"$to_h",function C(){var h=C.$$p||a,u=this;if(delete C.$$p,h!==a)return V(u,"map",[],h.$to_proc()).$to_h();if(u.$$class===E.Hash)return u;var l=new E.Hash;return d(l),E.hash_clone(u,l),l},0),L(N,"$to_hash",function(){return this},0),L(N,"$to_proc",function(){return V(this,"proc",[],function u(l){var f=null==u.$$s?this:u.$$s;return null==l&&oe.$raise(y("ArgumentError"),"no key given"),f["$[]"](l)},{$$arity:-1,$$s:this})},0),L(N,"$transform_keys",function C(){var h=C.$$p||a,u=this;if(delete C.$$p,!ee(h))return V(u,"enum_for",["transform_keys"],function le(){return(null==le.$$s?this:le.$$s).$size()},{$$arity:0,$$s:u});for(var S,Q,l=p(),f=0,_=u.$$keys,x=_.length;f<x;f++)(S=_[f]).$$is_string?Q=u.$$smap[S]:(Q=S.value,S=S.key),S=w(h,S),v(l,S,Q);return l},0),L(N,"$transform_keys!",function C(){var h=C.$$p||a,u=this;if(delete C.$$p,!ee(h))return V(u,"enum_for",["transform_keys!"],function le(){return(null==le.$$s?this:le.$$s).$size()},{$$arity:0,$$s:u});var f,x,S,Q,l=E.slice.call(u.$$keys),_=l.length;for(f=0;f<_;f++)(x=l[f]).$$is_string?S=u.$$smap[x]:(S=x.value,x=x.key),Q=w(h,x),D(u,x),v(u,Q,S);return u},0),L(N,"$transform_values",function C(){var h=C.$$p||a,u=this;if(delete C.$$p,!ee(h))return V(u,"enum_for",["transform_values"],function le(){return(null==le.$$s?this:le.$$s).$size()},{$$arity:0,$$s:u});for(var S,Q,l=p(),f=0,_=u.$$keys,x=_.length;f<x;f++)(S=_[f]).$$is_string?Q=u.$$smap[S]:(Q=S.value,S=S.key),Q=w(h,Q),v(l,S,Q);return l},0),L(N,"$transform_values!",function C(){var h=C.$$p||a,u=this;if(delete C.$$p,!ee(h))return V(u,"enum_for",["transform_values!"],function Q(){return(null==Q.$$s?this:Q.$$s).$size()},{$$arity:0,$$s:u});for(var x,S,l=0,f=u.$$keys,_=f.length;l<_;l++)(x=f[l]).$$is_string?S=u.$$smap[x]:(S=x.value,x=x.key),S=w(h,S),v(u,x,S);return u},0),L(N,"$values",function(){for(var x,u=[],l=0,f=this.$$keys,_=f.length;l<_;l++)u.push((x=f[l]).$$is_string?this.$$smap[x]:x.value);return u},0),k(N,"dup","clone"),k(N,"each_pair","each"),k(N,"eql?","=="),k(N,"filter","select"),k(N,"filter!","select!"),k(N,"include?","has_key?"),k(N,"indices","indexes"),k(N,"key","index"),k(N,"key?","has_key?"),k(N,"member?","has_key?"),k(N,"size","length"),k(N,"store","[]="),k(N,"to_s","inspect"),k(N,"update","merge!"),k(N,"value?","has_value?"),k(N,"values_at","indexes")},Opal.modules["corelib/number"]=function(E){var P,g,h,l,f,b,C,X=[],a=E.nil,y=E.$$$,w=E.klass,p=E.Opal,d=E.Kernel,M=E.def,v=E.eqeqeq,D=E.truthy,$=E.rb_gt,F=E.not,oe=E.rb_lt,G=E.send2,L=E.find_super,V=E.send,H=E.rb_plus,se=E.rb_minus,ue=E.eqeq,ee=E.rb_divide,Y=E.to_ary,ne=E.rb_times,k=E.rb_le,q=E.rb_ge,z=E.alias,A=E.const_set;return E.top.$require("corelib/numeric"),function(N,P,g){var u,b=w("::",P,"Number");[b].concat(g),p.$bridge(Number,b),E.prop(b.$$prototype,"$$is_number",!0),b.$$is_number_class=!0,u=E.get_singleton_class(b),M(u,"$allocate",function(){return d.$raise(y("TypeError"),"allocator undefined for "+this.$name())},0),E.udef(u,"$new"),M(b,"$coerce",function(l){var f=this;if(l===a)d.$raise(y("TypeError"),"can't convert "+l.$class()+" into Float");else{if(l.$$is_string)return[d.$Float(l),f];if(l["$respond_to?"]("to_f"))return[p["$coerce_to!"](l,y("Float"),"to_f"),f];if(l.$$is_number)return[l,f];d.$raise(y("TypeError"),"can't convert "+l.$class()+" into Float")}},1),M(b,"$__id__",function(){return 2*this+1},0),M(b,"$+",function(l){return l.$$is_number?this+l:this.$__coerced__("+",l)},1),M(b,"$-",function(l){return l.$$is_number?this-l:this.$__coerced__("-",l)},1),M(b,"$*",function(l){return l.$$is_number?this*l:this.$__coerced__("*",l)},1),M(b,"$/",function(l){return l.$$is_number?this/l:this.$__coerced__("/",l)},1),M(b,"$%",function(l){var f=this;return l.$$is_number?l==-1/0?l:0!=l?l<0||f<0?(f%l+l)%l:f%l:void d.$raise(y("ZeroDivisionError"),"divided by 0"):f.$__coerced__("%",l)},1),M(b,"$&",function(l){return l.$$is_number?this&l:this.$__coerced__("&",l)},1),M(b,"$|",function(l){return l.$$is_number?this|l:this.$__coerced__("|",l)},1),M(b,"$^",function(l){return l.$$is_number?this^l:this.$__coerced__("^",l)},1),M(b,"$<",function(l){return l.$$is_number?this<l:this.$__coerced__("<",l)},1),M(b,"$<=",function(l){return l.$$is_number?this<=l:this.$__coerced__("<=",l)},1),M(b,"$>",function(l){return l.$$is_number?this>l:this.$__coerced__(">",l)},1),M(b,"$>=",function(l){return l.$$is_number?this>=l:this.$__coerced__(">=",l)},1),M(b,"$<=>",function(l){try{return function(u,l){return l.$$is_number?isNaN(u)||isNaN(l)?a:u>l?1:u<l?-1:0:u.$__coerced__("<=>",l)}(this,l)}catch(_){if(!E.rescue(_,[y("ArgumentError")]))throw _;try{return a}finally{E.pop_exception()}}},1),M(b,"$<<",function(l){return(l=p["$coerce_to!"](l,y("Integer"),"to_int"))>0?this<<l:this>>-l},1),M(b,"$>>",function(l){return(l=p["$coerce_to!"](l,y("Integer"),"to_int"))>0?this>>l:this<<-l},1),M(b,"$[]",function(l){return(l=p["$coerce_to!"](l,y("Integer"),"to_int"))<0?0:l>=32?this<0?1:0:this>>l&1},1),M(b,"$+@",function(){return+this},0),M(b,"$-@",function(){return-this},0),M(b,"$~",function(){return~this},0),M(b,"$**",function(l){var f=this;return v(y("Integer"),l)?F(y("Integer")["$==="](f))||D($(l,0))?Math.pow(f,l):y("Rational").$new(f,1)["$**"](l):oe(f,0)&&(v(y("Float"),l)||v(y("Rational"),l))?y("Complex").$new(f,0)["$**"](l.$to_f()):D(null!=l.$$is_number)?Math.pow(f,l):f.$__coerced__("**",l)},1),M(b,"$===",function(l){return l.$$is_number?this.valueOf()===l.valueOf():!!l["$respond_to?"]("==")&&l["$=="](this)},1),M(b,"$==",function(l){return l.$$is_number?this.valueOf()===l.valueOf():!!l["$respond_to?"]("==")&&l["$=="](this)},1),M(b,"$abs",function(){return Math.abs(this)},0),M(b,"$abs2",function(){return Math.abs(this*this)},0),M(b,"$allbits?",function(l){return(this&(l=p["$coerce_to!"](l,y("Integer"),"to_int")))==l},1),M(b,"$anybits?",function(l){return 0!=(this&p["$coerce_to!"](l,y("Integer"),"to_int"))},1),M(b,"$angle",function(){var l=this;return D(l["$nan?"]())?l:0==l?1/l>0?0:Math.PI:l<0?Math.PI:0},0),M(b,"$bit_length",function(){var l=this;if(v(y("Integer"),l)||d.$raise(y("NoMethodError").$new("undefined method `bit_length` for "+l+":Float","bit_length")),0===l||-1===l)return 0;for(var f=0,_=l<0?~l:l;0!=_;)f+=1,_>>>=1;return f},0),M(b,"$ceil",function(l){null==l&&(l=0);var _=this.$to_f();if(_%1==0&&l>=0)return _;var x=Math.pow(10,l),S=Math.ceil(_*x)/x;return _%1==0&&(S=Math.round(S)),S},-1),M(b,"$chr",function(l){return E.enc(String.fromCharCode(this),l||"BINARY")},-1),M(b,"$denominator",function u(){var l=u.$$p||a,f=this;return delete u.$$p,D(f["$nan?"]())||D(f["$infinite?"]())?1:G(f,L(f,"denominator",u,!1,!0),"denominator",[],l)},0),M(b,"$downto",function u(l){var f=u.$$p||a,_=this;if(delete u.$$p,f===a)return V(_,"enum_for",["downto",l],function S(){var Q=null==S.$$s?this:S.$$s;return v(y("Numeric"),l)||d.$raise(y("ArgumentError"),"comparison of "+Q.$class()+" with "+l.$class()+" failed"),D($(l,Q))?0:H(se(Q,l),1)},{$$arity:0,$$s:_});l.$$is_number||d.$raise(y("ArgumentError"),"comparison of "+_.$class()+" with "+l.$class()+" failed");for(var x=_;x>=l;x--)f(x);return _},1),M(b,"$equal?",function(l){var _;return D(_=this["$=="](l))?_:isNaN(this)&&isNaN(l)},1),M(b,"$even?",function(){return this%2==0},0),M(b,"$floor",function(l){null==l&&(l=0);var _=this.$to_f();if(_%1==0&&l>=0)return _;var x=Math.pow(10,l),S=Math.floor(_*x)/x;return _%1==0&&(S=Math.round(S)),S},-1),M(b,"$gcd",function(l){v(y("Integer"),l)||d.$raise(y("TypeError"),"not an integer");for(var _=Math.abs(this),x=Math.abs(l);_>0;){var S=_;_=x%_,x=S}return x},1),M(b,"$gcdlcm",function(l){return[this.$gcd(l),this.$lcm(l)]},1),M(b,"$integer?",function(){return this%1==0},0),M(b,"$is_a?",function u(l){var f=u.$$p||a,_=this;return delete u.$$p,!!(ue(l,y("Integer"))&&v(y("Integer"),_)||ue(l,y("Integer"))&&v(y("Integer"),_)||ue(l,y("Float"))&&v(y("Float"),_))||G(_,L(_,"is_a?",u,!1,!0),"is_a?",[l],f)},1),M(b,"$instance_of?",function u(l){var f=u.$$p||a,_=this;return delete u.$$p,!!(ue(l,y("Integer"))&&v(y("Integer"),_)||ue(l,y("Integer"))&&v(y("Integer"),_)||ue(l,y("Float"))&&v(y("Float"),_))||G(_,L(_,"instance_of?",u,!1,!0),"instance_of?",[l],f)},1),M(b,"$lcm",function(l){var f=this;return v(y("Integer"),l)||d.$raise(y("TypeError"),"not an integer"),0==f||0==l?0:Math.abs(f*l/f.$gcd(l))},1),M(b,"$next",function(){return this+1},0),M(b,"$nobits?",function(l){return 0==(this&p["$coerce_to!"](l,y("Integer"),"to_int"))},1),M(b,"$nonzero?",function(){return 0==this?a:this},0),M(b,"$numerator",function u(){var l=u.$$p||a,f=this;return delete u.$$p,D(f["$nan?"]())||D(f["$infinite?"]())?f:G(f,L(f,"numerator",u,!1,!0),"numerator",[],l)},0),M(b,"$odd?",function(){return this%2!=0},0),M(b,"$ord",function(){return this},0),M(b,"$pow",function(l,f){var _=this;return 0==_&&d.$raise(y("ZeroDivisionError"),"divided by 0"),void 0===f?_["$**"](l):(y("Integer")["$==="](l)||d.$raise(y("TypeError"),"Integer#pow() 2nd argument not allowed unless a 1st argument is integer"),l<0&&d.$raise(y("TypeError"),"Integer#pow() 1st argument cannot be negative when 2nd argument specified"),y("Integer")["$==="](f)||d.$raise(y("TypeError"),"Integer#pow() 2nd argument not allowed unless all arguments are integers"),0===f&&d.$raise(y("ZeroDivisionError"),"divided by 0"),_["$**"](l)["$%"](f))},-2),M(b,"$pred",function(){return this-1},0),M(b,"$quo",function u(l){var f=u.$$p||a,_=this;return delete u.$$p,v(y("Integer"),_)?G(_,L(_,"quo",u,!1,!0),"quo",[l],f):ee(_,l)},1),M(b,"$rationalize",function(l){var f,_,x=this,S=a,Q=a;return arguments.length>1&&d.$raise(y("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),v(y("Integer"),x)?y("Rational").$new(x,1):D(x["$infinite?"]())?d.$raise(y("FloatDomainError"),"Infinity"):D(x["$nan?"]())?d.$raise(y("FloatDomainError"),"NaN"):D(null==l)?(_=y("Math").$frexp(x),S=null==(f=Y(_))[0]?a:f[0],Q=null==f[1]?a:f[1],S=y("Math").$ldexp(S,y(y("Float"),"MANT_DIG")).$to_i(),Q=se(Q,y(y("Float"),"MANT_DIG")),y("Rational").$new(ne(2,S),1["$<<"](se(1,Q))).$rationalize(y("Rational").$new(1,1["$<<"](se(1,Q))))):x.$to_r().$rationalize(l)},-1),M(b,"$remainder",function(l){return se(this,ne(l,ee(this,l).$truncate()))},1),M(b,"$round",function(l){var f,_,Q,x=this;if(v(y("Integer"),x)){if(D(null==l)||(v(y("Float"),l)&&D(l["$infinite?"]())&&d.$raise(y("RangeError"),"Infinity"),l=p["$coerce_to!"](l,y("Integer"),"to_int"),D(oe(l,y(y("Integer"),"MIN")))&&d.$raise(y("RangeError"),"out of bounds"),D(l>=0)))return x;if(.415241*(l=l["$-@"]())-.125>x.$size())return 0;var le=Math.pow(10,l),Ce=Math.floor((Math.abs(x)+le/2)/le)*le;return x<0?-Ce:Ce}if(D(x["$nan?"]())&&D(null==l)&&d.$raise(y("FloatDomainError"),"NaN"),l=p["$coerce_to!"](l||0,y("Integer"),"to_int"),D(k(l,0)))D(x["$nan?"]())?d.$raise(y("RangeError"),"NaN"):D(x["$infinite?"]())&&d.$raise(y("FloatDomainError"),"Infinity");else{if(ue(l,0))return Math.round(x);if(D(x["$nan?"]())||D(x["$infinite?"]()))return x}return _=y("Math").$frexp(x),Q=null==(f=Y(_))[1]?a:f[1],D(q(l,se(H(y(y("Float"),"DIG"),2),D($(Q,0))?ee(Q,4):se(ee(Q,3),1))))?x:D(oe(l,(D($(Q,0))?H(ee(Q,3),1):ee(Q,4))["$-@"]()))?0:Math.round(x*Math.pow(10,l))/Math.pow(10,l)},-1),M(b,"$times",function u(){var l=u.$$p||a,f=this;if(delete u.$$p,!D(l))return V(f,"enum_for",["times"],function x(){return null==x.$$s?this:x.$$s},{$$arity:0,$$s:f});for(var _=0;_<f;_++)l(_);return f},0),M(b,"$to_f",function(){return this},0),M(b,"$to_i",function(){var l=this;return l<0?Math.ceil(l):Math.floor(l)},0),M(b,"$to_r",function(){var l,f,_=this,x=a,S=a;return v(y("Integer"),_)?y("Rational").$new(_,1):(f=y("Math").$frexp(_),x=null==(l=Y(f))[0]?a:l[0],S=null==l[1]?a:l[1],x=y("Math").$ldexp(x,y(y("Float"),"MANT_DIG")).$to_i(),S=se(S,y(y("Float"),"MANT_DIG")),ne(x,y(y("Float"),"RADIX")["$**"](S)).$to_r())},0),M(b,"$to_s",function(l){var f=this;return null==l&&(l=10),l=p["$coerce_to!"](l,y("Integer"),"to_int"),(D(oe(l,2))||D($(l,36)))&&d.$raise(y("ArgumentError"),"invalid radix "+l),ue(f,0)&&D(1/f==-1/0)?"-0.0":f.toString(l)},-1),M(b,"$truncate",function(l){null==l&&(l=0);var _=this.$to_f();if(_%1==0&&l>=0)return _;var x=Math.pow(10,l),S=parseInt(_*x,10)/x;return _%1==0&&(S=Math.round(S)),S},-1),M(b,"$digits",function(l){var f=this;null==l&&(l=10),oe(f,0)&&d.$raise(y(y("Math"),"DomainError"),"out of domain"),l=p["$coerce_to!"](l,y("Integer"),"to_int"),D(oe(l,2))&&d.$raise(y("ArgumentError"),"invalid radix "+l),f!=parseInt(f)&&d.$raise(y("NoMethodError"),"undefined method `digits' for "+f.$inspect());var _=f,x=[];if(0==f)return[0];for(;0!=_;)x.push(_%l),_=parseInt(_/l,10);return x},-1),M(b,"$divmod",function u(l){var f=u.$$p||a,_=this;return delete u.$$p,D(_["$nan?"]())||D(l["$nan?"]())?d.$raise(y("FloatDomainError"),"NaN"):D(_["$infinite?"]())?d.$raise(y("FloatDomainError"),"Infinity"):G(_,L(_,"divmod",u,!1,!0),"divmod",[l],f)},1),M(b,"$upto",function u(l){var f=u.$$p||a,_=this;if(delete u.$$p,f===a)return V(_,"enum_for",["upto",l],function S(){var Q=null==S.$$s?this:S.$$s;return v(y("Numeric"),l)||d.$raise(y("ArgumentError"),"comparison of "+Q.$class()+" with "+l.$class()+" failed"),D(oe(l,Q))?0:H(se(l,Q),1)},{$$arity:0,$$s:_});l.$$is_number||d.$raise(y("ArgumentError"),"comparison of "+_.$class()+" with "+l.$class()+" failed");for(var x=_;x<=l;x++)f(x);return _},1),M(b,"$zero?",function(){return 0==this},0),M(b,"$size",function(){return 4},0),M(b,"$nan?",function(){return isNaN(this)},0),M(b,"$finite?",function(){var l=this;return l!=1/0&&l!=-1/0&&!isNaN(l)},0),M(b,"$infinite?",function(){return this==1/0?1:this==-1/0?-1:a},0),M(b,"$positive?",function(){var l=this;return 0!=l&&(l==1/0||1/l>0)},0),M(b,"$negative?",function(){return this==-1/0||1/this<0},0),z(b,"arg","angle"),z(b,"eql?","=="),z(b,"fdiv","/"),z(b,"inspect","to_s"),z(b,"kind_of?","is_a?"),z(b,"magnitude","abs"),z(b,"modulo","%"),z(b,"object_id","__id__"),z(b,"phase","angle"),z(b,"succ","next"),z(b,"to_int","to_i")}(0,y("Numeric"),X),A("::","Fixnum",y("Number")),P=y("Numeric"),g=X,C=[b=w("::",P,"Integer")].concat(g),b.$$is_number_class=!0,b.$$is_integer_class=!0,l=[h=E.get_singleton_class(b)].concat(C),f=E.$r(l),M(h,"$allocate",function(){return d.$raise(y("TypeError"),"allocator undefined for "+this.$name())},0),E.udef(h,"$new"),M(h,"$sqrt",function(x){return(x=p["$coerce_to!"](x,y("Integer"),"to_int"))<0&&d.$raise(y(y("Math"),"DomainError"),'Numerical argument is out of domain - "isqrt"'),parseInt(Math.sqrt(x),10)},1),M(h,"$try_convert",function(x){return f("Opal")["$coerce_to?"](x,this,"to_int")},1),A(b,"MAX",Math.pow(2,30)-1),A(b,"MIN",-Math.pow(2,30)),function(N,P,g){var b=w("::",P,"Float");return[b].concat(g),b.$$is_number_class=!0,function(h,u){M(h,"$allocate",function(){return d.$raise(y("TypeError"),"allocator undefined for "+this.$name())},0),E.udef(h,"$new"),M(h,"$===",function(f){return!!f.$$is_number},1)}(E.get_singleton_class(b)),A(b,"INFINITY",1/0),A(b,"MAX",Number.MAX_VALUE),A(b,"MIN",Number.MIN_VALUE),A(b,"NAN",NaN),A(b,"DIG",15),A(b,"MANT_DIG",53),A(b,"RADIX",2),A(b,"EPSILON",Number.EPSILON||2220446049250313e-31)}(0,y("Numeric"),X)},Opal.modules["corelib/range"]=function(E){var a=E.nil,y=E.$$$,w=E.klass,p=E.truthy,d=E.Kernel,M=E.def,v=E.not,D=E.send2,$=E.find_super,F=E.rb_lt,oe=E.rb_le,G=E.send,L=E.eqeq,V=E.eqeqeq,H=E.rb_gt,se=E.rb_minus,ue=E.Opal,ee=E.rb_divide,Y=E.rb_plus,ne=E.rb_times,k=E.rb_ge,q=E.alias;return E.top.$require("corelib/enumerable"),function(z,A,N){var P=w("::",null,"Range"),g=[P].concat([]),b=E.$r(g),C=P.$$prototype;function h(u){return u.begin===a||u.end===a||u.begin===-1/0||u.end===1/0||u.begin===1/0||u.end===-1/0}return C.begin=C.end=C.excl=a,P.$include(y("Enumerable")),P.$$prototype.$$is_range=!0,P.$attr_reader("begin","end"),M(P,"$initialize",function(l,f,_){var x=this;return null==_&&(_=!1),p(x.begin)&&d.$raise(y("NameError"),"'initialize' called twice"),p(l["$<=>"](f))||p(l["$nil?"]())||p(f["$nil?"]())||d.$raise(y("ArgumentError"),"bad value for range"),x.begin=l,x.end=f,x.excl=_},-3),M(P,"$===",function(l){return this["$include?"](l)},1),M(P,"$count",function u(){var l=u.$$p||a,f=this;return delete u.$$p,v(l!==a)&&p(h(f))?y(y("Float"),"INFINITY"):D(f,$(f,"count",u,!1,!0),"count",[],l)},0),M(P,"$to_a",function u(){var l=u.$$p||a,f=this;return delete u.$$p,p(h(f))&&d.$raise(y("TypeError"),"cannot convert endless range to an array"),D(f,$(f,"to_a",u,!1,!0),"to_a",[],l)},0),M(P,"$cover?",function(l){var _,le,f=this,x=a,S=a,Q=a;return _=p(x=p(S=p(Q=f.begin["$nil?"]())?-1:Q)?S:f.begin["$<=>"](l))&&x,le=p(x=p(S=p(Q=f.end["$nil?"]())?-1:Q)?S:l["$<=>"](f.end))&&x,p(x=p(S=p(f.excl)?p(Q=le)?F(le,0):Q:p(Q=le)?oe(le,0):Q)?_:S)?oe(_,0):x},1),M(P,"$each",function u(){var S,le,Ce,l=u.$$p||a,_=this,x=a,Q=a;if(delete u.$$p,l===a)return G(_,"enum_for",["each"],function T(){return(null==T.$$s?this:T.$$s).$size()},{$$arity:0,$$s:_});if(_.begin.$$is_number&&_.end.$$is_number){for((_.begin%1!=0||_.end%1!=0)&&d.$raise(y("TypeError"),"can't iterate from Float"),le=_.begin,Ce=_.end+(p(_.excl)?0:1);le<Ce;le++)l(le);return _}if(_.begin.$$is_string&&_.end.$$is_string)return G(_.begin,"upto",[_.end,_.excl],l.$to_proc()),_;for(S=_.end,p((x=_.begin)["$respond_to?"]("succ"))||d.$raise(y("TypeError"),"can't iterate from "+x.$class());p(p(Q=_.end["$nil?"]())?Q:F(x["$<=>"](S),0));)E.yield1(l,x),x=x.$succ();return v(_.excl)&&L(x,S)&&E.yield1(l,x),_},0),M(P,"$eql?",function(l){var f=this,_=a,x=a;return!!V(y("Range"),l)&&(p(_=p(x=f.excl["$==="](l["$exclude_end?"]()))?f.begin["$eql?"](l.$begin()):x)?f.end["$eql?"](l.$end()):_)},1),M(P,"$exclude_end?",function(){return this.excl},0),M(P,"$first",function u(l){var f=u.$$p||a,_=this;return delete u.$$p,p(_.begin["$nil?"]())&&d.$raise(y("RangeError"),"cannot get the minimum of beginless range"),p(null==l)?_.begin:D(_,$(_,"first",u,!1,!0),"first",[l],f)},-1),M(P,"$last",function(l){var f=this;return p(f.end["$nil?"]())&&d.$raise(y("RangeError"),"cannot get the maximum of endless range"),p(null==l)?f.end:f.$to_a().$last(l)},-1),M(P,"$max",function u(){var l=u.$$p||a,f=this;return delete u.$$p,p(f.end["$nil?"]())?d.$raise(y("RangeError"),"cannot get the maximum of endless range"):l!==a?D(f,$(f,"max",u,!1,!0),"max",[],l):v(f.begin["$nil?"]())&&(p(H(f.begin,f.end))||p(f.excl)&&L(f.begin,f.end))?a:f.excl?f.end-1:f.end},0),M(P,"$min",function u(){var l=u.$$p||a,f=this;return delete u.$$p,p(f.begin["$nil?"]())?d.$raise(y("RangeError"),"cannot get the minimum of beginless range"):l!==a?D(f,$(f,"min",u,!1,!0),"min",[],l):v(f.end["$nil?"]())&&(p(H(f.begin,f.end))||p(f.excl)&&L(f.begin,f.end))?a:f.begin},0),M(P,"$size",function(){var l=this,f=a,_=a,x=a;return f=y(y("Float"),"INFINITY"),L(l.begin,f)&&v(l.end["$nil?"]())||L(l.end,f["$-@"]())&&v(l.begin["$nil?"]())?0:p(h(l))?f:V(y("Numeric"),l.begin)&&V(y("Numeric"),l.end)?(_=l.begin,x=l.end,p(l.excl)&&(x=se(x,1)),p(F(x,_))?0:(Math.abs(x-_)+1).$to_i()):a},0),M(P,"$step",function u(l){var f=u.$$p||a,_=this,x=a,S=a;function Q(){null==l?l=1:l.$$is_number||(l=ue["$coerce_to!"](l,y("Integer"),"to_int")),l<0?d.$raise(y("ArgumentError"),"step can't be negative"):0===l&&d.$raise(y("ArgumentError"),"step can't be 0")}return delete u.$$p,f===a?(p(_.begin["$is_a?"](b("Numeric")))||p(_.begin["$nil?"]()))&&(p(_.end["$is_a?"](b("Numeric")))||p(_.end["$nil?"]()))&&v(p(x=_.begin["$nil?"]())?_.end["$nil?"]():x)?y(y("Enumerator"),"ArithmeticSequence").$new(_,l,"step"):G(_,"enum_for",["step",l],function(){return Q(),function le(){if(!_.begin["$respond_to?"]("succ")||_.begin.$$is_string&&_.end.$$is_string)return a;if(l%1==0)return ee(_.$size(),l).$ceil();var ve,Ce=_.begin,T=_.end,O=Math.abs,re=Math.floor,j=(O(Ce)+O(T)+O(T-Ce))/O(l)*y(y("Float"),"EPSILON");return j>.5&&(j=.5),_.excl?(ve=re((T-Ce)/l-j))*l+Ce<T&&ve++:ve=re((T-Ce)/l+j)+1,ve}()},0):(Q(),p(_.begin.$$is_number&&_.end.$$is_number)?(S=0,function(){var Ce=E.new_brk();try{G(_,"loop",[],function T(){var re,O=null==T.$$s?this:T.$$s;return null==O.begin&&(O.begin=a),null==O.excl&&(O.excl=a),null==O.end&&(O.end=a),re=Y(O.begin,ne(S,l)),p(O.excl)?p(k(re,O.end))&&E.brk(a,Ce):p(H(re,O.end))&&E.brk(a,Ce),E.yield1(f,re),S=Y(S,1)},{$$arity:0,$$s:_,$$brk:Ce})}catch(T){if(T===Ce)return T.$v;throw T}}()):(_.begin.$$is_string&&_.end.$$is_string&&l%1!=0&&d.$raise(y("TypeError"),"no implicit conversion to float from string"),G(_,"each_with_index",[],function(T,O){return null==T&&(T=a),null==O&&(O=a),L(O["$%"](l),0)?E.yield1(f,T):a},2)),_)},-1),M(P,"$%",function(l){var f=this;return p(f.begin["$is_a?"](b("Numeric")))&&p(f.end["$is_a?"](b("Numeric")))?y(y("Enumerator"),"ArithmeticSequence").$new(f,l,"%"):f.$step(l)},1),M(P,"$bsearch",function u(){var l=u.$$p||a,f=this;return delete u.$$p,l===a?f.$enum_for("bsearch"):(p(h(f)&&(f.begin.$$is_number||f.end.$$is_number))&&d.$raise(y("NotImplementedError"),"Can't #bsearch an infinite range"),p(f.begin.$$is_number&&f.end.$$is_number)||d.$raise(y("TypeError"),"can't do binary search for "+f.begin.$class()),G(f.$to_a(),"bsearch",[],l.$to_proc()))},0),M(P,"$to_s",function(){var l=this,f=a;return(p(f=l.begin)?f:"")+(p(l.excl)?"...":"..")+(p(f=l.end)?f:"")},0),M(P,"$inspect",function(){var l=this,f=a;return(p(f=l.begin)?l.begin.$inspect():f)+(p(l.excl)?"...":"..")+(p(f=l.end)?l.end.$inspect():f)},0),M(P,"$marshal_load",function(l){var f=this;return f.begin=l["$[]"]("begin"),f.end=l["$[]"]("end"),f.excl=l["$[]"]("excl")},1),M(P,"$hash",function(){var l=this;return[l.begin,l.end,l.excl].$hash()},0),q(P,"==","eql?"),q(P,"include?","cover?"),q(P,"member?","cover?")}()},Opal.modules["corelib/proc"]=function(E){var L,ae=E.nil,X=E.$$$,a=E.slice,w=E.truthy,p=E.Kernel,d=E.defs,M=E.def,v=E.send,D=E.to_a,$=E.Opal,F=E.alias;return L=(0,E.klass)("::",Function,"Proc"),E.prop(L.$$prototype,"$$is_proc",!0),E.prop(L.$$prototype,"$$is_lambda",!1),d(L,"$new",function V(){var H=V.$$p||ae;return delete V.$$p,w(H)||p.$raise(X("ArgumentError"),"tried to create a Proc object without a block"),H},0),M(L,"$call",function V(H){var ee,se=V.$$p||ae,Y=this;delete V.$$p,ee=E.slice.call(arguments),se!==ae&&(Y.$$p=se);var ne,k=Y.$$brk;if(k)try{ne=Y.$$is_lambda?Y.apply(null,ee):E.yieldX(Y,ee)}catch(q){if(q===k)return k.$v;throw q}else ne=Y.$$is_lambda?Y.apply(null,ee):E.yieldX(Y,ee);return ne},-1),M(L,"$>>",function V(H){return delete V.$$p,v(p,"proc",[],function ee(Y){var k,ne=ee.$$p||ae,z=null==ee.$$s?this:ee.$$s,A=ae;return delete ee.$$p,k=E.slice.call(arguments),A=v(z,"call",D(k),ne.$to_proc()),H.$call(A)},{$$arity:-1,$$s:this})},1),M(L,"$<<",function V(H){return delete V.$$p,v(p,"proc",[],function ee(Y){var k,ne=ee.$$p||ae,z=null==ee.$$s?this:ee.$$s,A=ae;return delete ee.$$p,k=E.slice.call(arguments),A=v(H,"call",D(k),ne.$to_proc()),z.$call(A)},{$$arity:-1,$$s:this})},1),M(L,"$to_proc",function(){return this},0),M(L,"$lambda?",function(){return!!this.$$is_lambda},0),M(L,"$arity",function(){return this.$$is_curried?-1:this.$$arity},0),M(L,"$source_location",function(){return ae},0),M(L,"$binding",function(){return this.$$is_curried&&p.$raise(X("ArgumentError"),"Can't create Binding"),w(X("::","Binding","skip_raise")?"constant":ae)?X("Binding").$new(ae,[],this.$$s,this.$source_location()):ae},0),M(L,"$parameters",function(){var H=this;if(H.$$is_curried)return[["rest"]];if(H.$$parameters){if(H.$$is_lambda)return H.$$parameters;var ue,ee,se=[];for(ue=0,ee=H.$$parameters.length;ue<ee;ue++){var Y=H.$$parameters[ue];"req"===Y[0]&&(Y=["opt",Y[1]]),se.push(Y)}return se}return[]},0),M(L,"$curry",function(H){var se=this;function ue(){var ne,ee=a.call(arguments),Y=ee.length;return Y>H&&se.$$is_lambda&&!se.$$is_curried&&p.$raise(X("ArgumentError"),"wrong number of arguments ("+Y+" for "+H+")"),Y>=H?se.$call.apply(se,ee):(ne=function(){return ue.apply(null,ee.concat(a.call(arguments)))},ne.$$is_lambda=se.$$is_lambda,ne.$$is_curried=!0,ne)}return void 0===H?H=se.length:(H=$["$coerce_to!"](H,X("Integer"),"to_int"),se.$$is_lambda&&H!==se.length&&p.$raise(X("ArgumentError"),"wrong number of arguments ("+H+" for "+se.length+")")),ue.$$is_lambda=se.$$is_lambda,ue.$$is_curried=!0,ue},-1),M(L,"$dup",function(){var H=this,se=H.$$original_proc||H,ue=function(){return se.apply(this,arguments)};for(var ee in H)H.hasOwnProperty(ee)&&(ue[ee]=H[ee]);return ue},0),F(L,"===","call"),F(L,"clone","dup"),F(L,"yield","call"),F(L,"[]","call")},Opal.modules["corelib/method"]=function(E){var F,oe,ae=E.nil,X=E.$$$,a=E.klass,y=E.def,w=E.truthy,p=E.alias,d=E.Kernel,M=E.send,v=E.to_a;return(oe=(F=a("::",null,"Method")).$$prototype).method=oe.receiver=oe.owner=oe.name=ae,F.$attr_reader("owner","receiver","name"),y(F,"$initialize",function(L,V,H,se){return this.receiver=L,this.owner=V,this.name=se,this.method=H},4),y(F,"$arity",function(){return this.method.$arity()},0),y(F,"$parameters",function(){return this.method.$$parameters},0),y(F,"$source_location",function(){var V;return w(V=this.method.$$source_location)?V:["(eval)",0]},0),y(F,"$comments",function(){var V;return w(V=this.method.$$comments)?V:[]},0),y(F,"$call",function G(L){var se,V=G.$$p||ae,ue=this;return delete G.$$p,se=E.slice.call(arguments),ue.method.$$p=V,ue.method.apply(ue.receiver,se)},-1),y(F,"$curry",function(L){return this.method.$curry(L)},-1),y(F,"$>>",function(L){return this.method["$>>"](L)},1),y(F,"$<<",function(L){return this.method["$<<"](L)},1),y(F,"$unbind",function(){var L=this;return X("UnboundMethod").$new(L.receiver.$class(),L.owner,L.method,L.name)},0),y(F,"$to_proc",function(){var L=this,V=L.$call.bind(L);return V.$$unbound=L.method,V.$$is_lambda=!0,V.$$arity=L.method.$$arity,V.$$parameters=L.method.$$parameters,V},0),y(F,"$inspect",function(){var L=this;return"#<"+L.$class()+": "+L.receiver.$class()+"#"+L.name+" (defined in "+L.owner+" in "+L.$source_location().$join(":")+")>"},0),p(F,"[]","call"),p(F,"===","call"),function(D,$){var F=a("::",null,"UnboundMethod"),oe=F.$$prototype;return oe.method=oe.owner=oe.name=oe.source=ae,F.$attr_reader("source","owner","name"),y(F,"$initialize",function(L,V,H,se){return this.source=L,this.owner=V,this.method=H,this.name=se},4),y(F,"$arity",function(){return this.method.$arity()},0),y(F,"$parameters",function(){return this.method.$$parameters},0),y(F,"$source_location",function(){var V;return w(V=this.method.$$source_location)?V:["(eval)",0]},0),y(F,"$comments",function(){var V;return w(V=this.method.$$comments)?V:[]},0),y(F,"$bind",function(L){var V=this;if(V.owner.$$is_module||E.is_a(L,V.owner))return X("Method").$new(L,V.owner,V.method,V.name);d.$raise(X("TypeError"),"can't bind singleton method to a different class (expected "+L+".kind_of?("+V.owner+" to be true)")},1),y(F,"$bind_call",function G(L,V){var ue,H=G.$$p||ae,ee=this;return delete G.$$p,ue=E.slice.call(arguments,1),M(ee.$bind(L),"call",v(ue),H.$to_proc())},-2),y(F,"$inspect",function(){var L=this;return"#<"+L.$class()+": "+L.source+"#"+L.name+" (defined in "+L.owner+" in "+L.$source_location().$join(":")+")>"},0)}()},Opal.modules["corelib/variables"]=function(E){var ae=E.nil,X=E.gvars,a=E.const_set,y=E.Object,w=E.hash2;return X["&"]=X["~"]=X["`"]=X["'"]=ae,X.LOADED_FEATURES=X['"']=E.loaded_features,X.LOAD_PATH=X[":"]=[],X["/"]="\n",X[","]=ae,a("::","ARGV",[]),a("::","ARGF",y.$new()),a("::","ENV",w([],{})),X.VERBOSE=!1,X.DEBUG=!1,X.SAFE=0},Opal.modules["corelib/io"]=function(E){var z,A,ae=E.nil,X=E.$$$,y=E.const_set,w=E.not,p=E.truthy,d=E.def,M=E.Kernel,v=E.gvars,D=E.send,$=E.to_a,F=E.rb_plus,oe=E.neqeq,G=E.range,L=E.hash2,V=E.eqeq,H=E.to_ary,se=E.rb_gt,ue=E.alias,ee=E.rb_minus,Y=ae;(A=(z=(0,E.klass)("::",null,"IO")).$$prototype).fd=A.read_buffer=A.closed=ae,y(z,"SEEK_SET",0),y(z,"SEEK_CUR",1),y(z,"SEEK_END",2),y(z,"SEEK_DATA",3),y(z,"SEEK_HOLE",4),y(z,"READABLE",1),y(z,"WRITABLE",4),z.$attr_reader("eof"),z.$attr_accessor("read_proc","sync","tty","write_proc"),d(z,"$initialize",function(P,g){var b=this;return null==g&&(g="r"),b.fd=P,b.flags=g,b.eof=!1,p(g["$include?"]("r"))&&w(g["$match?"](/[wa+]/))?b.closed="write":p(g["$match?"](/[wa]/))&&w(g["$match?"](/[r+]/))?b.closed="read":ae},-2),d(z,"$fileno",function(){return this.fd},0),d(z,"$tty?",function(){return 1==this.tty},0),d(z,"$write",function(P){return this.write_proc(P),P.$size()},1),d(z,"$flush",function(){return ae},0),d(z,"$<<",function(P){return this.$write(P),this},1),d(z,"$print",function(P){var b,C=this;null==v[","]&&(v[","]=ae);for(var h=0,u=(b=E.slice.call(arguments)).length;h<u;h++)b[h]=M.$String(b[h]);return C.$write(b.join(v[","])),ae},-1),d(z,"$puts",function(P){var b,h,C=this;if(0===(b=E.slice.call(arguments)).length)return C.$write("\n"),ae;for(var u=0,l=b.length;u<l;u++)if(b[u].$$is_array){var f=b[u].$flatten();f.length>0&&D(C,"puts",$(f))}else(h=b[u].$$is_string?b[u].valueOf():M.$String(b[u])).endsWith("\n")||(h+="\n"),C.$write(h);return ae},-1),d(z,"$getc",function(){var b,g=this,C=ae,h=ae;g.read_buffer=p(b=g.read_buffer)?b:"",C="";do{if(g.read_buffer=F(g.read_buffer,C),oe(g.read_buffer,""))return h=g.read_buffer["$[]"](0),g.read_buffer=g.read_buffer["$[]"](G(1,-1,!1)),h}while(p(C=g.$sysread_noraise(1)));return ae},0),d(z,"$getbyte",function(){var P;return(P=this.$getc())===ae||null==P?ae:D(P,"ord",[])},0),d(z,"$readbyte",function(){return this.$readchar().$ord()},0),d(z,"$readchar",function(){var g;return p(g=this.$getc())?g:M.$raise(X("EOFError"),"end of file reached")},0),d(z,"$readline",function(P){var g,C=this,h=ae;return g=E.slice.call(arguments),p(h=D(C,"gets",$(g)))?h:M.$raise(X("EOFError"),"end of file reached")},-1),d(z,"$gets",function(P,g,b){var C,h,u,f,x,l=this,_=ae,S=ae,Q=ae,le=ae;null==v["/"]&&(v["/"]=ae),null==P&&(P=!1),null==g&&(g=ae),null==b&&(b=L([],{})),p(P.$$is_number)&&w(g)&&(P=(C=[!1,P,g])[0],g=C[1],b=C[2]),p(P.$$is_hash)&&w(g)&&V(b,L([],{}))?(P=(C=[!1,ae,P])[0],g=C[1],b=C[2]):p(g.$$is_hash)&&V(b,L([],{}))&&(P=(C=[P,ae,g])[0],g=C[1],b=C[2]),f=P,V(P,!1)&&(P=v["/"]),V(P,"")&&(P=/\r?\n\r?\n/),P=p(_=P)?_:"",V(f,"")||(P=P.$to_str()),x=V(f,"")?2:P.$length(),V(P," ")&&(P=/ /),l.read_buffer=p(_=l.read_buffer)?_:"",S="",Q=ae;do{if(l.read_buffer=F(l.read_buffer,S),oe(P,"")&&p(p(P.$$is_regexp)?l.read_buffer["$match?"](P):l.read_buffer["$include?"](P))){le=l.read_buffer,u=l.read_buffer.$split(P,2),Q=null==(h=H(u))[0]?ae:h[0],l.read_buffer=null==h[1]?ae:h[1],oe(Q,le)&&(Q=F(Q,le["$[]"](Q.$length(),x)));break}}while(p(S=l.$sysread_noraise(V(P,"")?65536:1)));return p(Q)||(Q=(C=[p(_=l.read_buffer)?_:"",""])[0],l.read_buffer=C[1],V(Q,"")&&(Q=ae)),p(Q)&&(p(g)&&(Q=Q["$[]"](E.Range.$new(0,g,!0)),l.read_buffer=F(Q["$[]"](E.Range.$new(g,-1,!1)),l.read_buffer)),p(b["$[]"]("chomp"))&&(Q=Q.$sub(/\r?\n$/,"")),V(f,"")&&(Q=Q.$sub(/^[\r\n]+/,""))),V(f,!1)&&(v._=Q),Q},-1),d(z,"$sysread",function(P){var b;return p(b=this.read_proc(P))?b:(this.eof=!0,M.$raise(X("EOFError"),"end of file reached"))},1),d(z,"$sysread_noraise",function(P){try{return this.$sysread(P)}catch(b){if(!E.rescue(b,[X("EOFError")]))throw b;try{return ae}finally{E.pop_exception()}}},1),d(z,"$readpartial",function(P){var g,h,b=this,C=ae,u=ae;return b.read_buffer=p(C=b.read_buffer)?C:"",h=b.$sysread(P),u=(g=[F(b.read_buffer,p(C=h)?C:""),""])[0],b.read_buffer=g[1],V(u,"")&&(u=ae),u},1),d(z,"$read",function(P){var g,b,C=this,h=ae,u=ae,l=ae;null==P&&(P=ae),C.read_buffer=p(h=C.read_buffer)?h:"",u="",l=ae;do{if(C.read_buffer=F(C.read_buffer,u),p(P)&&p(se(C.read_buffer.$length(),P)))return l=(b=[C.read_buffer["$[]"](E.Range.$new(0,P,!0)),C.read_buffer["$[]"](E.Range.$new(P,-1,!1))])[0],C.read_buffer=b[1],l}while(p(u=C.$sysread_noraise(p(h=P)?h:65536)));return l=(g=[C.read_buffer,""])[0],C.read_buffer=g[1],l},-1),d(z,"$readlines",function(P){return null==v["/"]&&(v["/"]=ae),null==P&&(P=v["/"]),this.$each_line(P).$to_a()},-1),d(z,"$each",function N(P,g){var C,h,u,b=N.$$p||ae,f=this,_=ae;if(null==v["/"]&&(v["/"]=ae),delete N.$$p,(C=E.slice.call(arguments)).length>0&&(h=C.shift()),null==h&&(h=v["/"]),u=C,b===ae)return D(f,"enum_for",["each",h].concat($(u)));for(;p(_=D(f,"gets",[h].concat($(u))));)E.yield1(b,_);return f},-1),d(z,"$each_byte",function N(){var P=N.$$p||ae,b=this,C=ae;if(delete N.$$p,P===ae)return b.$enum_for("each_byte");for(;p(C=b.$getbyte());)E.yield1(P,C);return b},0),d(z,"$each_char",function N(){var P=N.$$p||ae,b=this,C=ae;if(delete N.$$p,P===ae)return b.$enum_for("each_char");for(;p(C=b.$getc());)E.yield1(P,C);return b},0),d(z,"$close",function(){return this.closed="both"},0),d(z,"$close_read",function(){return this.closed=V(this.closed,"write")?"both":"read"},0),d(z,"$close_write",function(){return this.closed=V(this.closed,"read")?"both":"write"},0),d(z,"$closed?",function(){return this.closed["$=="]("both")},0),d(z,"$closed_read?",function(){var g;return p(g=this.closed["$=="]("read"))?g:this.closed["$=="]("both")},0),d(z,"$closed_write?",function(){var g;return p(g=this.closed["$=="]("write"))?g:this.closed["$=="]("both")},0),d(z,"$check_writable",function(){return p(this["$closed_write?"]())?M.$raise(X("IOError"),"not opened for writing"):ae},0),d(z,"$check_readable",function(){return p(this["$closed_read?"]())?M.$raise(X("IOError"),"not opened for reading"):ae},0),ue(z,"each_line","each"),ue(z,"eof?","eof"),y("::","STDIN",v.stdin=X("IO").$new(0,"r")),y("::","STDOUT",v.stdout=X("IO").$new(1,"w")),y("::","STDERR",v.stderr=X("IO").$new(2,"w"));var ne=E.global.console;return Y=["object"==typeof process&&"object"==typeof process.stdout?function(k){process.stdout.write(k)}:function(k){ne.log(k)}],D(X("STDOUT"),"write_proc=",$(Y)),ee(Y.length,1),Y=["object"==typeof process&&"object"==typeof process.stderr?function(k){process.stderr.write(k)}:function(k){ne.warn(k)}],D(X("STDERR"),"write_proc=",$(Y)),ee(Y.length,1),Y=[function(k){var q=prompt();return null!==q?q+"\n":ae}],D(X("STDIN"),"read_proc=",$(Y)),Y[ee(Y.length,1)]},Opal.modules["opal/regexp_anchors"]=function(E){var d,M,v,D,ae=[],a=E.$$$,w=E.const_set;return d=ae,v=[M=(0,E.module)(ae[0],"Opal")].concat(d),D=E.$r(v),w(M,"REGEXP_START","^"),w(M,"REGEXP_END","$"),w(M,"FORBIDDEN_STARTING_IDENTIFIER_CHARS","\\u0001-\\u002F\\u003A-\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),w(M,"FORBIDDEN_ENDING_IDENTIFIER_CHARS","\\u0001-\\u0020\\u0022-\\u002F\\u003A-\\u003E\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),w(M,"INLINE_IDENTIFIER_REGEXP",D("Regexp").$new("[^"+a(M,"FORBIDDEN_STARTING_IDENTIFIER_CHARS")+"]*[^"+a(M,"FORBIDDEN_ENDING_IDENTIFIER_CHARS")+"]")),w(M,"FORBIDDEN_CONST_NAME_CHARS","\\u0001-\\u0020\\u0021-\\u002F\\u003B-\\u003F\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),w(M,"CONST_NAME_REGEXP",D("Regexp").$new(a(M,"REGEXP_START")+"(::)?[A-Z][^"+a(M,"FORBIDDEN_CONST_NAME_CHARS")+"]*"+a(M,"REGEXP_END")))},Opal.modules["opal/mini"]=function(E){var X=E.Object;return X.$require("opal/base"),X.$require("corelib/nil"),X.$require("corelib/boolean"),X.$require("corelib/string"),X.$require("corelib/comparable"),X.$require("corelib/enumerable"),X.$require("corelib/enumerator"),X.$require("corelib/array"),X.$require("corelib/hash"),X.$require("corelib/number"),X.$require("corelib/range"),X.$require("corelib/proc"),X.$require("corelib/method"),X.$require("corelib/regexp"),X.$require("corelib/variables"),X.$require("corelib/io"),X.$require("opal/regexp_anchors")},Opal.modules["corelib/kernel/format"]=function(E){var oe,ae=E.nil,X=E.$$$,a=E.coerce_to,w=E.truthy,p=E.eqeq,d=E.Opal,M=E.Kernel,v=E.gvars,$=E.alias;return(0,E.def)(oe=(0,E.module)("::","Kernel"),"$format",function(L,V){var H,se,ue=ae;null==v.DEBUG&&(v.DEBUG=ae),H=E.slice.call(arguments,1),p((se=H).$length(),1)&&w(se["$[]"](0)["$respond_to?"]("to_ary"))&&(ue=d["$coerce_to?"](se["$[]"](0),X("Array"),"to_ary"),w(ue["$nil?"]())||(se=ue.$to_a()));var ne,k,z,A,N,P,g,b,C,h,u,l,f,_,x,le,ee="",Y=0,q=L.length,S=1,Q=0,Ce=0,T=1,O=2,re=4,j=8,ve=16,de=32,Ee=64,ce=128;function he(){le&de&&M.$raise(X("ArgumentError"),"flag after width"),le&ce&&M.$raise(X("ArgumentError"),"flag after precision")}function B(){le&de&&M.$raise(X("ArgumentError"),"width given twice"),le&ce&&M.$raise(X("ArgumentError"),"width after precision")}function R(Ie){return Ie>=se.length&&M.$raise(X("ArgumentError"),"too few arguments"),se[Ie]}function ie(){switch(Q){case-1:M.$raise(X("ArgumentError"),"unnumbered("+S+") mixed with numbered");case-2:M.$raise(X("ArgumentError"),"unnumbered("+S+") mixed with named")}return R((Q=S++)-1)}function W(Ie){return Q>0&&M.$raise(X("ArgumentError"),"numbered("+Ie+") after unnumbered("+Q+")"),-2===Q&&M.$raise(X("ArgumentError"),"numbered("+Ie+") after named"),Ie<1&&M.$raise(X("ArgumentError"),"invalid index - "+Ie+"$"),Q=-1,R(Ie-1)}function me(){return void 0===x?ie():x}function $e(Ie){for(var Pe,Ae="";;k++){if(k===q&&M.$raise(X("ArgumentError"),"malformed format string - %*[0-9]"),L.charCodeAt(k)<48||L.charCodeAt(k)>57)return k--,(Pe=parseInt(Ae,10)||0)>2147483647&&M.$raise(X("ArgumentError"),Ie+" too big"),Pe;Ae+=L.charAt(k)}}function _e(Ie){var Pe,Ae=$e(Ie);return"$"===L.charAt(k+1)?(k++,Pe=W(Ae)):Pe=ie(),Pe.$to_int()}for(k=L.indexOf("%");-1!==k;k=L.indexOf("%",k)){switch(A=void 0,le=Ce,P=-1,g=-1,x=void 0,ne=k,k++,L.charAt(k)){case"%":Y=k;case"":case"\n":case"\0":k++;continue}e:for(;k<q;k++)switch(L.charAt(k)){case" ":he(),le|=ve;continue e;case"#":he(),le|=T;continue e;case"+":he(),le|=re;continue e;case"-":he(),le|=O;continue e;case"0":he(),le|=j;continue e;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":if(b=$e("width"),"$"===L.charAt(k+1)){if(k+2===q){A="%",k++;break e}void 0!==x&&M.$raise(X("ArgumentError"),"value given twice - %"+b+"$"),x=W(b),k++}else B(),le|=de,P=b;continue e;case"<":case"{":for(h="<"===L.charAt(k)?">":"}",C="",k++;;k++){if(k===q&&M.$raise(X("ArgumentError"),"malformed name - unmatched parenthesis"),L.charAt(k)===h){if(Q>0&&M.$raise(X("ArgumentError"),"named "+C+" after unnumbered("+Q+")"),-1===Q&&M.$raise(X("ArgumentError"),"named "+C+" after numbered"),Q=-2,(void 0===se[0]||!se[0].$$is_hash)&&M.$raise(X("ArgumentError"),"one hash required"),x=se[0].$fetch(C),">"===h)continue e;if(A=x.toString(),-1!==g&&(A=A.slice(0,g)),le&O)for(;A.length<P;)A+=" ";else for(;A.length<P;)A=" "+A;break e}C+=L.charAt(k)}case"*":k++,B(),le|=de,(P=_e("width"))<0&&(le|=O,P=-P);continue e;case".":if(le&ce&&M.$raise(X("ArgumentError"),"precision given twice"),le|=Ee|ce,g=0,k++,"*"===L.charAt(k)){k++,(g=_e("precision"))<0&&(le&=~Ee);continue e}g=$e("precision");continue e;case"d":case"i":case"u":if((z=M.$Integer(me()))>=0){for(A=z.toString();A.length<g;)A="0"+A;if(le&O)for((le&re||le&ve)&&(A=(le&re?"+":" ")+A);A.length<P;)A+=" ";else if(le&j&&-1===g){for(;A.length<P-(le&re||le&ve?1:0);)A="0"+A;(le&re||le&ve)&&(A=(le&re?"+":" ")+A)}else for((le&re||le&ve)&&(A=(le&re?"+":" ")+A);A.length<P;)A=" "+A}else{for(A=(-z).toString();A.length<g;)A="0"+A;if(le&O)for(A="-"+A;A.length<P;)A+=" ";else if(le&j&&-1===g){for(;A.length<P-1;)A="0"+A;A="-"+A}else for(A="-"+A;A.length<P;)A=" "+A}break e;case"b":case"B":case"o":case"x":case"X":switch(L.charAt(k)){case"b":case"B":u=2,l="0b",f=/^1+/,_="1";break;case"o":u=8,l="0",f=/^3?7+/,_="7";break;case"x":case"X":u=16,l="0x",f=/^f+/,_="f"}if((z=M.$Integer(me()))>=0){for(A=z.toString(u);A.length<g;)A="0"+A;if(le&O)for((le&re||le&ve)&&(A=(le&re?"+":" ")+A),le&T&&0!==z&&(A=l+A);A.length<P;)A+=" ";else if(le&j&&-1===g){for(;A.length<P-(le&re||le&ve?1:0)-(le&T&&0!==z?l.length:0);)A="0"+A;le&T&&0!==z&&(A=l+A),(le&re||le&ve)&&(A=(le&re?"+":" ")+A)}else for(le&T&&0!==z&&(A=l+A),(le&re||le&ve)&&(A=(le&re?"+":" ")+A);A.length<P;)A=" "+A}else if(le&re||le&ve){for(A=(-z).toString(u);A.length<g;)A="0"+A;if(le&O)for(le&T&&(A=l+A),A="-"+A;A.length<P;)A+=" ";else if(le&j&&-1===g){for(;A.length<P-1-(le&T?2:0);)A="0"+A;le&T&&(A=l+A),A="-"+A}else for(le&T&&(A=l+A),A="-"+A;A.length<P;)A=" "+A}else{for(A=(z>>>0).toString(u).replace(f,_);A.length<g-2;)A=_+A;if(le&O)for(A=".."+A,le&T&&(A=l+A);A.length<P;)A+=" ";else if(le&j&&-1===g){for(;A.length<P-2-(le&T?l.length:0);)A=_+A;A=".."+A,le&T&&(A=l+A)}else for(A=".."+A,le&T&&(A=l+A);A.length<P;)A=" "+A}L.charAt(k)===L.charAt(k).toUpperCase()&&(A=A.toUpperCase());break e;case"f":case"e":case"E":case"g":case"G":if((z=M.$Float(me()))>=0||isNaN(z)){if(z===1/0)A="Inf";else switch(L.charAt(k)){case"f":A=z.toFixed(-1===g?6:g);break;case"e":case"E":A=z.toExponential(-1===g?6:g);break;case"g":case"G":A=z.toExponential(),(N=parseInt(A.split("e")[1],10))<-4||N>=(-1===g?6:g)||(A=z.toPrecision(-1===g?le&T?6:void 0:g))}if(le&O)for((le&re||le&ve)&&(A=(le&re?"+":" ")+A);A.length<P;)A+=" ";else if(le&j&&z!==1/0&&!isNaN(z)){for(;A.length<P-(le&re||le&ve?1:0);)A="0"+A;(le&re||le&ve)&&(A=(le&re?"+":" ")+A)}else for((le&re||le&ve)&&(A=(le&re?"+":" ")+A);A.length<P;)A=" "+A}else{if(z===-1/0)A="Inf";else switch(L.charAt(k)){case"f":A=(-z).toFixed(-1===g?6:g);break;case"e":case"E":A=(-z).toExponential(-1===g?6:g);break;case"g":case"G":A=(-z).toExponential(),(N=parseInt(A.split("e")[1],10))<-4||N>=(-1===g?6:g)||(A=(-z).toPrecision(-1===g?le&T?6:void 0:g))}if(le&O)for(A="-"+A;A.length<P;)A+=" ";else if(le&j&&z!==-1/0){for(;A.length<P-1;)A="0"+A;A="-"+A}else for(A="-"+A;A.length<P;)A=" "+A}L.charAt(k)===L.charAt(k).toUpperCase()&&z!==1/0&&z!==-1/0&&!isNaN(z)&&(A=A.toUpperCase()),A=A.replace(/([eE][-+]?)([0-9])$/,"$10$2");break e;case"a":case"A":M.$raise(X("NotImplementedError"),"`A` and `a` format field types are not implemented in Opal yet");case"c":if((z=me())["$respond_to?"]("to_ary")&&(z=z.$to_ary()[0]),1!==(A=z["$respond_to?"]("to_str")?z.$to_str():String.fromCharCode(a(z,X("Integer"),"to_int"))).length&&M.$raise(X("ArgumentError"),"%c requires a character"),le&O)for(;A.length<P;)A+=" ";else for(;A.length<P;)A=" "+A;break e;case"p":if(A=me().$inspect(),-1!==g&&(A=A.slice(0,g)),le&O)for(;A.length<P;)A+=" ";else for(;A.length<P;)A=" "+A;break e;case"s":if(A=me().$to_s(),-1!==g&&(A=A.slice(0,g)),le&O)for(;A.length<P;)A+=" ";else for(;A.length<P;)A=" "+A;break e;default:M.$raise(X("ArgumentError"),"malformed format string - %"+L.charAt(k))}void 0===A&&M.$raise(X("ArgumentError"),"malformed format string - %"),ee+=L.slice(Y,ne)+A,Y=k+1}return v.DEBUG&&Q>=0&&S<se.length&&M.$raise(X("ArgumentError"),"too many arguments for format string"),ee+L.slice(Y)},-2),$(oe,"sprintf","format")},Opal.modules["corelib/string/encoding"]=function(E){var ee,k,q,ae=E.top,a=E.$r([]),y=E.nil,w=E.$$$,p=E.klass,d=E.hash2,M=E.rb_plus,v=E.truthy,D=E.send,$=E.defs,F=E.eqeq,oe=E.def,G=E.Kernel,L=E.Opal,V=E.rb_lt,H=E.alias,se=E.to_a,ue=E.rb_minus;return ae.$require("corelib/string"),(q=(k=p("::",null,"Encoding")).$$prototype).ascii=q.dummy=q.name=y,$(k,"$register",function z(A,N){var b,h,u,P=z.$$p||y,C=y,l=y,f=y;return delete z.$$p,null==N&&(N=d([],{})),b=M([A],v(C=N["$[]"]("aliases"))?C:[]),h=v(C=N["$[]"]("ascii"))&&C,u=v(C=N["$[]"]("dummy"))&&C,v(N["$[]"]("inherits"))?(l=N["$[]"]("inherits").$clone()).$initialize(A,b,h,u):l=this.$new(A,b,h,u),P!==y&&D(l,"instance_eval",[],P.$to_proc()),f=E.encodings,D(b,"each",[],function _(x){return null==x&&(x=y),(null==_.$$s?this:_.$$s).$const_set(x.$tr("-","_"),l),f[x]=l},{$$arity:1,$$s:this})},-2),$(k,"$find",function(A){return F(A,"default_external")?this.$default_external():E.find_encoding(A)},1),k.$singleton_class().$attr_accessor("default_external"),k.$attr_reader("name","names"),oe(k,"$initialize",function(A,N,P,g){var b=this;return b.name=A,b.names=N,b.ascii=P,b.dummy=g},4),oe(k,"$ascii_compatible?",function(){return this.ascii},0),oe(k,"$dummy?",function(){return this.dummy},0),oe(k,"$binary?",function(){return!1},0),oe(k,"$to_s",function(){return this.name},0),oe(k,"$inspect",function(){return"#<Encoding:"+this.name+(v(this.dummy)?" (dummy)":y)+">"},0),oe(k,"$charsize",function(A){for(var N=0,P=0,g=A.length;P<g;P++){var b=A.charCodeAt(P);b>=55296&&b<=56319||N++}return N},1),oe(k,"$each_char",function z(A){var N=z.$$p||y;delete z.$$p;for(var P="",g=0,b=A.length;g<b;g++){var C=A.charCodeAt(g),h=A.charAt(g);C>=56320&&C<=57343?P=h:(C>=55296&&C<=56319&&(h=P+h),"UTF-8"!=A.encoding.name&&((h=new String(h)).encoding=A.encoding),E.yield1(N,h))}},1),oe(k,"$each_byte",function(A){return E.slice.call(arguments),G.$raise(w("NotImplementedError"))},-1),oe(k,"$bytesize",function(A){return E.slice.call(arguments),G.$raise(w("NotImplementedError"))},-1),p("::",w("StandardError"),"EncodingError"),p("::",w("EncodingError"),"CompatibilityError"),D(w("Encoding"),"register",["UTF-8",d(["aliases","ascii"],{aliases:["CP65001"],ascii:!0})],function Y(){var ne=null==Y.$$s?this:Y.$$s;return oe(ne,"$each_byte",function k(q){var z=k.$$p||y;delete k.$$p;for(var N,A=1/0,P=q.length,g=null,b=0;b<P;++b){if((N=q.charCodeAt(b))>55295&&N<57344){if(!g){if(N>56319){(A-=3)>-1&&(E.yield1(z,239),E.yield1(z,191),E.yield1(z,189));continue}if(b+1===P){(A-=3)>-1&&(E.yield1(z,239),E.yield1(z,191),E.yield1(z,189));continue}g=N;continue}if(N<56320){(A-=3)>-1&&(E.yield1(z,239),E.yield1(z,191),E.yield1(z,189)),g=N;continue}N=65536+(g-55296<<10|N-56320)}else g&&(A-=3)>-1&&(E.yield1(z,239),E.yield1(z,191),E.yield1(z,189));if(g=null,N<128){if((A-=1)<0)break;E.yield1(z,N)}else if(N<2048){if((A-=2)<0)break;E.yield1(z,N>>6|192),E.yield1(z,63&N|128)}else if(N<65536){if((A-=3)<0)break;E.yield1(z,N>>12|224),E.yield1(z,N>>6&63|128),E.yield1(z,63&N|128)}else if(N<1114112){if((A-=4)<0)break;E.yield1(z,N>>18|240),E.yield1(z,N>>12&63|128),E.yield1(z,N>>6&63|128),E.yield1(z,63&N|128)}}},1),oe(ne,"$bytesize",function(q){return q.$bytes().$length()},1)},{$$arity:0,$$s:ae}),D(w("Encoding"),"register",["UTF-16LE"],function Y(){var ne=null==Y.$$s?this:Y.$$s;return oe(ne,"$each_byte",function k(q){var z=k.$$p||y;delete k.$$p;for(var A=0,N=q.length;A<N;A++){var P=q.charCodeAt(A);E.yield1(z,255&P),E.yield1(z,P>>8)}},1),oe(ne,"$bytesize",function(q){return 2*q.length},1)},{$$arity:0,$$s:ae}),D(w("Encoding"),"register",["UTF-16BE",d(["inherits"],{inherits:w(w("Encoding"),"UTF_16LE")})],function Y(){return oe(null==Y.$$s?this:Y.$$s,"$each_byte",function k(q){var z=k.$$p||y;delete k.$$p;for(var A=0,N=q.length;A<N;A++){var P=q.charCodeAt(A);E.yield1(z,P>>8),E.yield1(z,255&P)}},1)},{$$arity:0,$$s:ae}),D(w("Encoding"),"register",["UTF-32LE"],function Y(){var ne=null==Y.$$s?this:Y.$$s;return oe(ne,"$each_byte",function k(q){var z=k.$$p||y;delete k.$$p;for(var A=0,N=q.length;A<N;A++){var P=q.charCodeAt(A);E.yield1(z,255&P),E.yield1(z,P>>8),E.yield1(z,0),E.yield1(z,0)}},1),oe(ne,"$bytesize",function(q){return 4*q.length},1)},{$$arity:0,$$s:ae}),D(w("Encoding"),"register",["UTF-32BE",d(["inherits"],{inherits:w(w("Encoding"),"UTF_32LE")})],function Y(){return oe(null==Y.$$s?this:Y.$$s,"$each_byte",function k(q){var z=k.$$p||y;delete k.$$p;for(var A=0,N=q.length;A<N;A++){var P=q.charCodeAt(A);E.yield1(z,0),E.yield1(z,0),E.yield1(z,P>>8),E.yield1(z,255&P)}},1)},{$$arity:0,$$s:ae}),D(w("Encoding"),"register",["ASCII-8BIT",d(["aliases","ascii"],{aliases:["BINARY"],ascii:!0})],function Y(){var ne=null==Y.$$s?this:Y.$$s;return oe(ne,"$each_char",function k(q){var z=k.$$p||y;delete k.$$p;for(var A=0,N=q.length;A<N;A++){var P=new String(q.charAt(A));P.encoding=q.encoding,E.yield1(z,P)}},1),oe(ne,"$charsize",function(q){return q.length},1),oe(ne,"$each_byte",function k(q){var z=k.$$p||y;delete k.$$p;for(var A=0,N=q.length;A<N;A++){var P=q.charCodeAt(A);E.yield1(z,255&P)}},1),oe(ne,"$bytesize",function(q){return q.length},1),oe(ne,"$binary?",function(){return!0},0)},{$$arity:0,$$s:ae}),w("Encoding").$register("ISO-8859-1",d(["aliases","ascii","inherits"],{aliases:["ISO8859-1"],ascii:!0,inherits:w(w("Encoding"),"ASCII_8BIT")})),w("Encoding").$register("US-ASCII",d(["aliases","ascii","inherits"],{aliases:["ASCII"],ascii:!0,inherits:w(w("Encoding"),"ASCII_8BIT")})),function(Y,ne){var k=p("::",null,"String"),q=k.$$prototype;q.internal_encoding=q.bytes=q.encoding=y,k.$attr_reader("encoding"),k.$attr_reader("internal_encoding"),E.prop(String.prototype,"bytes",y),E.prop(String.prototype,"encoding",w(w("Encoding"),"UTF_8")),E.prop(String.prototype,"internal_encoding",w(w("Encoding"),"UTF_8")),oe(k,"$b",function(){return this.$dup().$force_encoding("binary")},0),oe(k,"$bytesize",function(){return this.internal_encoding.$bytesize(this)},0),oe(k,"$each_byte",function z(){var A=z.$$p||y,N=this;return delete z.$$p,A===y?D(N,"enum_for",["each_byte"],function P(){return(null==P.$$s?this:P.$$s).$bytesize()},{$$arity:0,$$s:N}):(D(N.internal_encoding,"each_byte",[N],A.$to_proc()),N)},0),oe(k,"$bytes",function(){var A=this,N=y;return"string"==typeof A?new String(A).$each_byte().$to_a():(A.bytes=v(N=A.bytes)?N:A.$each_byte().$to_a(),A.bytes.$dup())},0),oe(k,"$each_char",function z(){var A=z.$$p||y,N=this;return delete z.$$p,A===y?D(N,"enum_for",["each_char"],function P(){return(null==P.$$s?this:P.$$s).$length()},{$$arity:0,$$s:N}):(D(N.encoding,"each_char",[N],A.$to_proc()),N)},0),oe(k,"$chars",function z(){var A=z.$$p||y;return delete z.$$p,v(A)?D(this,"each_char",[],A.$to_proc()):this.$each_char().$to_a()},0),oe(k,"$each_codepoint",function z(){var A=z.$$p||y,N=this;if(delete z.$$p,A===y)return N.$enum_for("each_codepoint");for(var P=0,g=N.length;P<g;P++)E.yield1(A,N.codePointAt(P));return N},0),oe(k,"$codepoints",function z(){var A=z.$$p||y;return delete z.$$p,A!==y?D(this,"each_codepoint",[],A.$to_proc()):this.$each_codepoint().$to_a()},0),oe(k,"$encode",function(A){return E.enc(this,A)},1),oe(k,"$force_encoding",function(A){var P=this;return A===P.encoding||(A=L["$coerce_to!"](A,w("String"),"to_s"),(A=w("Encoding").$find(A))===P.encoding)||(P=E.set_encoding(P,A)),P},1),oe(k,"$getbyte",function(A){var P=y;return P=this.$bytes(),A=L["$coerce_to!"](A,w("Integer"),"to_int"),v(V(P.$length(),A))?y:P["$[]"](A)},1),oe(k,"$initialize_copy",function(A){return"\n      self.encoding = other.encoding;\n      self.internal_encoding = other.internal_encoding;\n    "},1),oe(k,"$length",function(){return this.length},0),H(k,"size","length"),oe(k,"$valid_encoding?",function(){return!0},0)}(),ee=[w(a("Encoding"),"UTF_8")],D(w("Encoding"),"default_external=",se(ee)),ee[ue(ee.length,1)]},Opal.modules["corelib/math"]=function(E){var V,H,se,ue,a=E.$$$,y=E.type_error,p=E.const_set,d=E.Class,M=E.Kernel,v=E.defs,D=E.def,$=E.truthy,F=E.rb_minus,oe=E.eqeqeq,G=E.rb_divide;return V=[],se=[H=(0,E.module)("::","Math")].concat(V),ue=E.$r(se),p(H,"E",Math.E),p(H,"PI",Math.PI),p(H,"DomainError",d.$new(a("StandardError"))),v(H,"$checked",function(Y,ne){var q;if(q=E.slice.call(arguments,1),isNaN(q[0])||2==q.length&&isNaN(q[1]))return NaN;var z=Math[Y].apply(null,q);return isNaN(z)&&M.$raise(ue("DomainError"),'Numerical argument is out of domain - "'+Y+'"'),z},-2),v(H,"$float!",function(Y){try{return M.$Float(Y)}catch(ne){if(!E.rescue(ne,[a("ArgumentError")]))throw ne;try{return M.$raise(y(Y,a("Float")))}finally{E.pop_exception()}}},1),v(H,"$integer!",function(Y){try{return M.$Integer(Y)}catch(ne){if(!E.rescue(ne,[a("ArgumentError")]))throw ne;try{return M.$raise(y(Y,a("Integer")))}finally{E.pop_exception()}}},1),H.$module_function(),D(H,"$acos",function(Y){return a("Math").$checked("acos",a("Math")["$float!"](Y))},1),$(void 0!==Math.acosh)||(Math.acosh=function(ee){return Math.log(ee+Math.sqrt(ee*ee-1))}),D(H,"$acosh",function(Y){return a("Math").$checked("acosh",a("Math")["$float!"](Y))},1),D(H,"$asin",function(Y){return a("Math").$checked("asin",a("Math")["$float!"](Y))},1),$(void 0!==Math.asinh)||(Math.asinh=function(ee){return Math.log(ee+Math.sqrt(ee*ee+1))}),D(H,"$asinh",function(Y){return a("Math").$checked("asinh",a("Math")["$float!"](Y))},1),D(H,"$atan",function(Y){return a("Math").$checked("atan",a("Math")["$float!"](Y))},1),D(H,"$atan2",function(Y,ne){return a("Math").$checked("atan2",a("Math")["$float!"](Y),a("Math")["$float!"](ne))},2),$(void 0!==Math.atanh)||(Math.atanh=function(ee){return.5*Math.log((1+ee)/(1-ee))}),D(H,"$atanh",function(Y){return a("Math").$checked("atanh",a("Math")["$float!"](Y))},1),$(void 0!==Math.cbrt)||(Math.cbrt=function(ee){if(0==ee)return 0;if(ee<0)return-Math.cbrt(-ee);for(var Y=ee,ne=0;Y<.125;)Y*=8,ne--;for(;Y>1;)Y*=.125,ne++;for(Y=(-.46946116*Y+1.072302)*Y+.3812513;ne<0;)Y*=.5,ne++;for(;ne>0;)Y*=2,ne--;return 2/3*(Y=2/3*(Y=2/3*(Y=2/3*Y+1/3*ee/(Y*Y))+1/3*ee/(Y*Y))+1/3*ee/(Y*Y))+1/3*ee/(Y*Y)}),D(H,"$cbrt",function(Y){return a("Math").$checked("cbrt",a("Math")["$float!"](Y))},1),D(H,"$cos",function(Y){return a("Math").$checked("cos",a("Math")["$float!"](Y))},1),$(void 0!==Math.cosh)||(Math.cosh=function(ee){return(Math.exp(ee)+Math.exp(-ee))/2}),D(H,"$cosh",function(Y){return a("Math").$checked("cosh",a("Math")["$float!"](Y))},1),$(void 0!==Math.erf)||E.prop(Math,"erf",function(ee){var N=1;ee<0&&(N=-1);var P=1/(1+.3275911*(ee=Math.abs(ee)));return N*(1-((((1.061405429*P-1.453152027)*P+1.421413741)*P-.284496736)*P+.254829592)*P*Math.exp(-ee*ee))}),D(H,"$erf",function(Y){return a("Math").$checked("erf",a("Math")["$float!"](Y))},1),$(void 0!==Math.erfc)||E.prop(Math,"erfc",function(ee){var Y=Math.abs(ee),ne=1/(.5*Y+1),u=ne*Math.exp(-Y*Y-1.26551223+ne*(ne*(ne*(ne*(ne*(ne*(ne*(ne*(.17087277*ne-.82215223)+1.48851587)-1.13520398)+.27886807)-.18628806)+.09678418)+.37409196)+1.00002368));return ee<0?2-u:u}),D(H,"$erfc",function(Y){return a("Math").$checked("erfc",a("Math")["$float!"](Y))},1),D(H,"$exp",function(Y){return a("Math").$checked("exp",a("Math")["$float!"](Y))},1),D(H,"$frexp",function(Y){if(Y=ue("Math")["$float!"](Y),isNaN(Y))return[NaN,0];var ne=Math.floor(Math.log(Math.abs(Y))/Math.log(2))+1;return[Y/Math.pow(2,ne),ne]},1),D(H,"$gamma",function(Y){Y=ue("Math")["$float!"](Y);var ne,k,q,z,A,N,P,g,b,h=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];if(isNaN(Y))return NaN;if(0===Y&&1/Y<0)return-1/0;if((-1===Y||Y===-1/0)&&M.$raise(ue("DomainError"),'Numerical argument is out of domain - "gamma"'),ue("Integer")["$==="](Y)){if(Y<=0)return isFinite(Y)?1/0:NaN;if(Y>171)return 1/0;for(z=Y-2,A=Y-1;z>1;)A*=z,z--;return 0==A&&(A=1),A}if(Y<.5)return Math.PI/(Math.sin(Math.PI*Y)*a("Math").$gamma(F(1,Y)));if(Y>=171.35)return 1/0;if(Y>85)return b=(g=(P=(N=Y*Y)*Y)*Y)*Y,Math.sqrt(2*Math.PI/Y)*Math.pow(Y/Math.E,Y)*(1+1/(12*Y)+1/(288*N)-139/(51840*P)-571/(2488320*g)+163879/(209018880*b)+5246819/(75246796800*b*Y));for(Y-=1,q=h[0],ne=1;ne<h.length;++ne)q+=h[ne]/(Y+ne);return k=Y+4.7421875+.5,Math.sqrt(2*Math.PI)*Math.pow(k,Y+.5)*Math.exp(-k)*q},1),$(void 0!==Math.hypot)||(Math.hypot=function(ee,Y){return Math.sqrt(ee*ee+Y*Y)}),D(H,"$hypot",function(Y,ne){return a("Math").$checked("hypot",a("Math")["$float!"](Y),a("Math")["$float!"](ne))},2),D(H,"$ldexp",function(Y,ne){return Y=ue("Math")["$float!"](Y),ne=ue("Math")["$integer!"](ne),isNaN(ne)&&M.$raise(a("RangeError"),"float NaN out of range of integer"),Y*Math.pow(2,ne)},2),D(H,"$lgamma",function(Y){return-1==Y?[1/0,1]:[Math.log(Math.abs(a("Math").$gamma(Y))),a("Math").$gamma(Y)<0?-1:1]},1),D(H,"$log",function(Y,ne){return oe(a("String"),Y)&&M.$raise(y(Y,a("Float"))),$(null==ne)?a("Math").$checked("log",a("Math")["$float!"](Y)):(oe(a("String"),ne)&&M.$raise(y(ne,a("Float"))),G(a("Math").$checked("log",a("Math")["$float!"](Y)),a("Math").$checked("log",a("Math")["$float!"](ne))))},-2),$(void 0!==Math.log10)||(Math.log10=function(ee){return Math.log(ee)/Math.LN10}),D(H,"$log10",function(Y){return oe(a("String"),Y)&&M.$raise(y(Y,a("Float"))),a("Math").$checked("log10",a("Math")["$float!"](Y))},1),$(void 0!==Math.log2)||(Math.log2=function(ee){return Math.log(ee)/Math.LN2}),D(H,"$log2",function(Y){return oe(a("String"),Y)&&M.$raise(y(Y,a("Float"))),a("Math").$checked("log2",a("Math")["$float!"](Y))},1),D(H,"$sin",function(Y){return a("Math").$checked("sin",a("Math")["$float!"](Y))},1),$(void 0!==Math.sinh)||(Math.sinh=function(ee){return(Math.exp(ee)-Math.exp(-ee))/2}),D(H,"$sinh",function(Y){return a("Math").$checked("sinh",a("Math")["$float!"](Y))},1),D(H,"$sqrt",function(Y){return a("Math").$checked("sqrt",a("Math")["$float!"](Y))},1),D(H,"$tan",function(Y){return Y=a("Math")["$float!"](Y),$(Y["$infinite?"]())?a(a("Float"),"NAN"):a("Math").$checked("tan",a("Math")["$float!"](Y))},1),$(void 0!==Math.tanh)||(Math.tanh=function(ee){return ee==1/0?1:ee==-1/0?-1:(Math.exp(ee)-Math.exp(-ee))/(Math.exp(ee)+Math.exp(-ee))}),D(H,"$tanh",function(Y){return a("Math").$checked("tanh",a("Math")["$float!"](Y))},1)},Opal.modules["corelib/complex/base"]=function(E){var M,v,D,$,ae=[],X=E.nil,y=E.truthy,w=E.def,p=E.klass;return M=ae,D=[v=(0,E.module)("::","Kernel")].concat(M),$=E.$r(D),w(v,"$Complex",function(oe,G){return null==G&&(G=X),y(G)?$("Complex").$new(oe,G):$("Complex").$new(oe,0)},-2),function(d,M,v){var D=p("::",null,"String"),$=[D].concat(v),F=E.$r($);return w(D,"$to_c",function(){return F("Complex").$from_string(this)},0)}(0,0,ae)},Opal.modules["corelib/complex"]=function(E){var k,q,z,A,N,ae=E.top,a=E.nil,y=E.$$$,w=E.klass,p=E.truthy,d=E.eqeqeq,M=E.Kernel,v=E.defs,D=E.rb_times,$=E.def,F=E.rb_plus,oe=E.rb_minus,G=E.rb_divide,L=E.eqeq,V=E.to_ary,H=E.rb_gt,se=E.neqeq,ue=E.const_set,ee=E.alias;return ae.$require("corelib/numeric"),ae.$require("corelib/complex/base"),k=[],z=[q=w("::",y("Numeric"),"Complex")].concat(k),A=E.$r(z),(N=q.$$prototype).real=N.imag=a,v(q,"$rect",function(g,b){return null==b&&(b=0),d(y("Numeric"),g)&&p(g["$real?"]())&&d(y("Numeric"),b)&&p(b["$real?"]())||M.$raise(y("TypeError"),"not a real"),this.$new(g,b)},-2),v(q,"$polar",function(g,b){return null==b&&(b=0),d(y("Numeric"),g)&&p(g["$real?"]())&&d(y("Numeric"),b)&&p(b["$real?"]())||M.$raise(y("TypeError"),"not a real"),this.$new(D(g,y("Math").$cos(b)),D(g,y("Math").$sin(b)))},-2),q.$attr_reader("real","imag"),$(q,"$initialize",function(g,b){return null==b&&(b=0),this.real=g,this.imag=b},-2),$(q,"$coerce",function(g){return d(y("Complex"),g)?[g,this]:d(y("Numeric"),g)&&p(g["$real?"]())?[y("Complex").$new(g,0),this]:M.$raise(y("TypeError"),g.$class()+" can't be coerced into Complex")},1),$(q,"$==",function(g){var b=this,C=a;return d(y("Complex"),g)?p(C=b.real["$=="](g.$real()))?b.imag["$=="](g.$imag()):C:d(y("Numeric"),g)&&p(g["$real?"]())?p(C=b.real["$=="](g))?b.imag["$=="](0):C:g["$=="](b)},1),$(q,"$-@",function(){return M.$Complex(this.real["$-@"](),this.imag["$-@"]())},0),$(q,"$+",function(g){var b=this;return d(y("Complex"),g)?M.$Complex(F(b.real,g.$real()),F(b.imag,g.$imag())):d(y("Numeric"),g)&&p(g["$real?"]())?M.$Complex(F(b.real,g),b.imag):b.$__coerced__("+",g)},1),$(q,"$-",function(g){var b=this;return d(y("Complex"),g)?M.$Complex(oe(b.real,g.$real()),oe(b.imag,g.$imag())):d(y("Numeric"),g)&&p(g["$real?"]())?M.$Complex(oe(b.real,g),b.imag):b.$__coerced__("-",g)},1),$(q,"$*",function(g){var b=this;return d(y("Complex"),g)?M.$Complex(oe(D(b.real,g.$real()),D(b.imag,g.$imag())),F(D(b.real,g.$imag()),D(b.imag,g.$real()))):d(y("Numeric"),g)&&p(g["$real?"]())?M.$Complex(D(b.real,g),D(b.imag,g)):b.$__coerced__("*",g)},1),$(q,"$/",function(g){var b=this;return d(y("Complex"),g)?d(y("Number"),b.real)&&p(b.real["$nan?"]())||d(y("Number"),b.imag)&&p(b.imag["$nan?"]())||d(y("Number"),g.$real())&&p(g.$real()["$nan?"]())||d(y("Number"),g.$imag())&&p(g.$imag()["$nan?"]())?y("Complex").$new(y(y("Float"),"NAN"),y(y("Float"),"NAN")):G(D(b,g.$conj()),g.$abs2()):d(y("Numeric"),g)&&p(g["$real?"]())?M.$Complex(b.real.$quo(g),b.imag.$quo(g)):b.$__coerced__("/",g)},1),$(q,"$**",function(g){var b,C,h,u,l=this,f=a,_=a,x=a,S=a,Q=a,le=a,Ce=a,T=a,O=a,re=a,j=a;if(L(g,0))return y("Complex").$new(1,0);if(d(y("Complex"),g))return C=l.$polar(),f=null==(b=V(C))[0]?a:b[0],_=null==b[1]?a:b[1],x=g.$real(),S=g.$imag(),Q=y("Math").$exp(oe(D(x,y("Math").$log(f)),D(S,_))),le=F(D(_,x),D(S,y("Math").$log(f))),y("Complex").$polar(Q,le);if(d(y("Integer"),g)){if(p(H(g,0))){for(T=Ce=l,O=oe(g,1);se(O,0);){for(h=O.$divmod(2),re=null==(C=V(h))[0]?a:C[0],j=null==C[1]?a:C[1];L(j,0);)Ce=M.$Complex(oe(D(Ce.$real(),Ce.$real()),D(Ce.$imag(),Ce.$imag())),D(D(2,Ce.$real()),Ce.$imag())),u=(O=re).$divmod(2),re=null==(h=V(u))[0]?a:h[0],j=null==h[1]?a:h[1];T=D(T,Ce),O=oe(O,1)}return T}return G(y("Rational").$new(1,1),l)["$**"](g["$-@"]())}return d(y("Float"),g)||d(y("Rational"),g)?(C=l.$polar(),f=null==(b=V(C))[0]?a:b[0],_=null==b[1]?a:b[1],y("Complex").$polar(f["$**"](g),D(_,g))):l.$__coerced__("**",g)},1),$(q,"$abs",function(){return y("Math").$hypot(this.real,this.imag)},0),$(q,"$abs2",function(){var g=this;return F(D(g.real,g.real),D(g.imag,g.imag))},0),$(q,"$angle",function(){return y("Math").$atan2(this.imag,this.real)},0),$(q,"$conj",function(){return M.$Complex(this.real,this.imag["$-@"]())},0),$(q,"$denominator",function(){return this.real.$denominator().$lcm(this.imag.$denominator())},0),$(q,"$eql?",function(g){var C,h,b=this;return p(C=p(h=A("Complex")["$==="](g))?b.real.$class()["$=="](b.imag.$class()):h)?b["$=="](g):C},1),$(q,"$fdiv",function(g){return d(y("Numeric"),g)||M.$raise(y("TypeError"),g.$class()+" can't be coerced into Complex"),G(this,g)},1),$(q,"$finite?",function(){var b;return p(b=this.real["$finite?"]())?this.imag["$finite?"]():b},0),$(q,"$hash",function(){return"Complex:"+this.real+":"+this.imag},0),$(q,"$infinite?",function(){var b;return p(b=this.real["$infinite?"]())?b:this.imag["$infinite?"]()},0),$(q,"$inspect",function(){return"("+this+")"},0),$(q,"$numerator",function(){var b,g=this;return b=g.$denominator(),M.$Complex(D(g.real.$numerator(),G(b,g.real.$denominator())),D(g.imag.$numerator(),G(b,g.imag.$denominator())))},0),$(q,"$polar",function(){return[this.$abs(),this.$arg()]},0),$(q,"$rationalize",function(g){var b=this;return arguments.length>1&&M.$raise(y("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),se(b.imag,0)&&M.$raise(y("RangeError"),"can't convert "+b+" into Rational"),b.$real().$rationalize(g)},-1),$(q,"$real?",function(){return!1},0),$(q,"$rect",function(){return[this.real,this.imag]},0),$(q,"$to_f",function(){var g=this;return L(g.imag,0)||M.$raise(y("RangeError"),"can't convert "+g+" into Float"),g.real.$to_f()},0),$(q,"$to_i",function(){var g=this;return L(g.imag,0)||M.$raise(y("RangeError"),"can't convert "+g+" into Integer"),g.real.$to_i()},0),$(q,"$to_r",function(){var g=this;return L(g.imag,0)||M.$raise(y("RangeError"),"can't convert "+g+" into Rational"),g.real.$to_r()},0),$(q,"$to_s",function(){var g=this,b=a;return b=g.real.$inspect(),b=F(b,d(y("Number"),g.imag)&&p(g.imag["$nan?"]())||p(g.imag["$positive?"]())||p(g.imag["$zero?"]())?"+":"-"),b=F(b,g.imag.$abs().$inspect()),d(y("Number"),g.imag)&&(p(g.imag["$nan?"]())||p(g.imag["$infinite?"]()))&&(b=F(b,"*")),F(b,"i")},0),ue(z[0],"I",q.$new(0,1)),v(q,"$from_string",function(g){var h,u,b=/[+-]?[\d_]+(\.[\d_]+)?(e\d+)?/;function f(){return b.test(g)}function _(){var Q=g.match(b)[0];return g=g.slice(Q.length),Q.replace(/_/g,"")}function x(){if(f()){var S=parseFloat(_());if("/"===g[0]){if(g=g.slice(1),f()){var Q=parseFloat(_());return M.$Rational(S,Q)}return g="/"+g,S}return S}return null}return g.match(b),(h=x())?(u=x())?M.$Complex(h,u):"i"===g[0]?M.$Complex(0,h):M.$Complex(h,0):M.$Complex(0,"i"===g[0]?1:"-"===g[0]&&"i"===g[1]?-1:"+"===g[0]&&"i"===g[1]?1:0)},1),ee(E.get_singleton_class(q),"rectangular","rect"),ee(q,"arg","angle"),ee(q,"conjugate","conj"),ee(q,"divide","/"),ee(q,"imaginary","imag"),ee(q,"magnitude","abs"),ee(q,"phase","arg"),ee(q,"quo","/"),ee(q,"rectangular","rect"),E.udef(q,"$negative?"),E.udef(q,"$positive?"),E.udef(q,"$step"),a},Opal.modules["corelib/rational/base"]=function(E){var X=E.$$$,y=E.def,w=E.klass;return y((0,E.module)("::","Kernel"),"$Rational",function(v,D){return null==D&&(D=1),X("Rational").$convert(v,D)},-2),y(w("::",null,"String"),"$to_r",function(){return X("Rational").$from_string(this)},0)},Opal.modules["corelib/rational"]=function(E){var k,q,ae=E.top,X=E.nil,a=E.$$$,y=E.klass,w=E.eqeq,p=E.Kernel,d=E.truthy,M=E.rb_lt,v=E.rb_divide,D=E.defs,$=E.eqeqeq,F=E.not,oe=E.Opal,G=E.def,L=E.rb_minus,V=E.rb_times,H=E.rb_plus,se=E.rb_gt,ue=E.rb_le,ee=E.alias;return ae.$require("corelib/numeric"),ae.$require("corelib/rational/base"),(q=(k=y("::",a("Numeric"),"Rational")).$$prototype).num=q.den=X,D(k,"$reduce",function(A,N){var g;if(A=A.$to_i(),N=N.$to_i(),w(N,0))p.$raise(a("ZeroDivisionError"),"divided by 0");else if(d(M(N,0)))A=A["$-@"](),N=N["$-@"]();else if(w(N,1))return this.$new(A,N);return g=A.$gcd(N),this.$new(v(A,g),v(N,g))},2),D(k,"$convert",function(A,N){return(d(A["$nil?"]())||d(N["$nil?"]()))&&p.$raise(a("TypeError"),"cannot convert nil into Rational"),$(a("Integer"),A)&&$(a("Integer"),N)?this.$reduce(A,N):(($(a("Float"),A)||$(a("String"),A)||$(a("Complex"),A))&&(A=A.$to_r()),($(a("Float"),N)||$(a("String"),N)||$(a("Complex"),N))&&(N=N.$to_r()),d(N["$equal?"](1))&&F(a("Integer")["$==="](A))?oe["$coerce_to!"](A,a("Rational"),"to_r"):$(a("Numeric"),A)&&$(a("Numeric"),N)?v(A,N):this.$reduce(A,N))},2),G(k,"$initialize",function(A,N){return this.num=A,this.den=N},2),G(k,"$numerator",function(){return this.num},0),G(k,"$denominator",function(){return this.den},0),G(k,"$coerce",function(A){var P,N=this;return $(a("Rational"),P=A)?[A,N]:$(a("Integer"),P)?[A.$to_r(),N]:$(a("Float"),P)?[A,N.$to_f()]:X},1),G(k,"$==",function(A){var P,N=this,g=X;return $(a("Rational"),P=A)?d(g=N.num["$=="](A.$numerator()))?N.den["$=="](A.$denominator()):g:$(a("Integer"),P)?d(g=N.num["$=="](A))?N.den["$=="](1):g:$(a("Float"),P)?N.$to_f()["$=="](A):A["$=="](N)},1),G(k,"$<=>",function(A){var P,N=this;return $(a("Rational"),P=A)?L(V(N.num,A.$denominator()),V(N.den,A.$numerator()))["$<=>"](0):$(a("Integer"),P)?L(N.num,V(N.den,A))["$<=>"](0):$(a("Float"),P)?N.$to_f()["$<=>"](A):N.$__coerced__("<=>",A)},1),G(k,"$+",function(A){var P,N=this,g=X,b=X;return $(a("Rational"),P=A)?(g=H(V(N.num,A.$denominator()),V(N.den,A.$numerator())),b=V(N.den,A.$denominator()),p.$Rational(g,b)):$(a("Integer"),P)?p.$Rational(H(N.num,V(A,N.den)),N.den):$(a("Float"),P)?H(N.$to_f(),A):N.$__coerced__("+",A)},1),G(k,"$-",function(A){var P,N=this,g=X,b=X;return $(a("Rational"),P=A)?(g=L(V(N.num,A.$denominator()),V(N.den,A.$numerator())),b=V(N.den,A.$denominator()),p.$Rational(g,b)):$(a("Integer"),P)?p.$Rational(L(N.num,V(A,N.den)),N.den):$(a("Float"),P)?L(N.$to_f(),A):N.$__coerced__("-",A)},1),G(k,"$*",function(A){var P,N=this,g=X,b=X;return $(a("Rational"),P=A)?(g=V(N.num,A.$numerator()),b=V(N.den,A.$denominator()),p.$Rational(g,b)):$(a("Integer"),P)?p.$Rational(V(N.num,A),N.den):$(a("Float"),P)?V(N.$to_f(),A):N.$__coerced__("*",A)},1),G(k,"$/",function(A){var P,N=this,g=X,b=X;return $(a("Rational"),P=A)?(g=V(N.num,A.$denominator()),b=V(N.den,A.$numerator()),p.$Rational(g,b)):$(a("Integer"),P)?w(A,0)?v(N.$to_f(),0):p.$Rational(N.num,V(N.den,A)):$(a("Float"),P)?v(N.$to_f(),A):N.$__coerced__("/",A)},1),G(k,"$**",function(A){var P,N=this;return $(a("Integer"),P=A)?w(N,0)&&d(M(A,0))?a(a("Float"),"INFINITY"):d(se(A,0))?p.$Rational(N.num["$**"](A),N.den["$**"](A)):d(M(A,0))?p.$Rational(N.den["$**"](A["$-@"]()),N.num["$**"](A["$-@"]())):p.$Rational(1,1):$(a("Float"),P)?N.$to_f()["$**"](A):$(a("Rational"),P)?w(A,0)?p.$Rational(1,1):w(A.$denominator(),1)?d(M(A,0))?p.$Rational(N.den["$**"](A.$numerator().$abs()),N.num["$**"](A.$numerator().$abs())):p.$Rational(N.num["$**"](A.$numerator()),N.den["$**"](A.$numerator())):w(N,0)&&d(M(A,0))?p.$raise(a("ZeroDivisionError"),"divided by 0"):N.$to_f()["$**"](A):N.$__coerced__("**",A)},1),G(k,"$abs",function(){return p.$Rational(this.num.$abs(),this.den.$abs())},0),G(k,"$ceil",function(A){var N=this;return null==A&&(A=0),w(A,0)?v(N.num["$-@"](),N.den)["$-@"]().$ceil():N.$with_precision("ceil",A)},-1),G(k,"$floor",function(A){var N=this;return null==A&&(A=0),w(A,0)?v(N.num["$-@"](),N.den)["$-@"]().$floor():N.$with_precision("floor",A)},-1),G(k,"$hash",function(){return"Rational:"+this.num+":"+this.den},0),G(k,"$inspect",function(){return"("+this+")"},0),G(k,"$rationalize",function(A){var N=this;if(arguments.length>1&&p.$raise(a("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),null==A)return N;for(var f,_,x,S,Q,P=A.$abs(),g=L(N,P),b=H(N,P),C=0,h=1,u=1,l=0;x=g.$ceil(),!ue(x,b);)f=(S=x-1)*h+C,_=S*l+u,Q=v(1,L(b,S)),b=v(1,L(g,S)),g=Q,C=h,u=l,h=f,l=_;return p.$Rational(x*h+C,x*l+u)},-1),G(k,"$round",function(A){var N=this,P=X,g=X,b=X;return null==A&&(A=0),w(A,0)?w(N.num,0)?0:w(N.den,1)?N.num:(P=H(V(N.num.$abs(),2),N.den),g=V(N.den,2),b=v(P,g).$truncate(),d(M(N.num,0))?b["$-@"]():b):N.$with_precision("round",A)},-1),G(k,"$to_f",function(){return v(this.num,this.den)},0),G(k,"$to_i",function(){return this.$truncate()},0),G(k,"$to_r",function(){return this},0),G(k,"$to_s",function(){return this.num+"/"+this.den},0),G(k,"$truncate",function(A){var N=this;return null==A&&(A=0),w(A,0)?d(M(N.num,0))?N.$ceil():N.$floor():N.$with_precision("truncate",A)},-1),G(k,"$with_precision",function(A,N){var g,b=X;return $(a("Integer"),N)||p.$raise(a("TypeError"),"not an Integer"),g=10["$**"](N),b=V(this,g),d(M(N,1))?v(b.$send(A),g).$to_i():p.$Rational(b.$send(A),g)},2),D(k,"$from_string",function(A){var b,C,N=A.trimLeft(),P=/^[+-]?[\d_]+(\.[\d_]+)?/;function h(){return P.test(N)}function u(){var f=N.match(P)[0];return N=N.slice(f.length),f.replace(/_/g,"")}return N.match(P),h()?(b=parseFloat(u()),"/"===N[0]?(N=N.slice(1),h()?(C=parseFloat(u()),p.$Rational(b,C)):p.$Rational(b,1)):p.$Rational(b,1)):p.$Rational(0,1)},1),ee(k,"divide","/"),ee(k,"quo","/")},Opal.modules["corelib/time"]=function(E){var a=E.nil,y=E.$$$,w=E.slice,p=E.klass,d=E.Kernel,M=E.Opal,v=E.defs,D=E.eqeqeq,$=E.def,F=E.truthy,oe=E.rb_gt,G=E.rb_lt,L=E.rb_plus,V=E.rb_divide,H=E.rb_minus,se=E.range,ue=E.neqeq,ee=E.rb_le,Y=E.eqeq,ne=E.alias;return E.top.$require("corelib/comparable"),function(k,q,z){var A=p("::",q,"Time"),N=[A].concat([]),P=E.$r(N);A.$include(y("Comparable"));var l,g=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],b=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],h=["January","February","March","April","May","June","July","August","September","October","November","December"];function u(l,f,_,x,S,Q){if(l=l.$$is_string?parseInt(l,10):M["$coerce_to!"](l,y("Integer"),"to_int"),f===a)f=1;else if(!f.$$is_number)if(f["$respond_to?"]("to_str"))switch(f=f.$to_str(),f.toLowerCase()){case"jan":f=1;break;case"feb":f=2;break;case"mar":f=3;break;case"apr":f=4;break;case"may":f=5;break;case"jun":f=6;break;case"jul":f=7;break;case"aug":f=8;break;case"sep":f=9;break;case"oct":f=10;break;case"nov":f=11;break;case"dec":f=12;break;default:f=f.$to_i()}else f=M["$coerce_to!"](f,y("Integer"),"to_int");return(f<1||f>12)&&d.$raise(y("ArgumentError"),"month out of range: "+f),f-=1,((_=_===a?1:_.$$is_string?parseInt(_,10):M["$coerce_to!"](_,y("Integer"),"to_int"))<1||_>31)&&d.$raise(y("ArgumentError"),"day out of range: "+_),((x=x===a?0:x.$$is_string?parseInt(x,10):M["$coerce_to!"](x,y("Integer"),"to_int"))<0||x>24)&&d.$raise(y("ArgumentError"),"hour out of range: "+x),((S=S===a?0:S.$$is_string?parseInt(S,10):M["$coerce_to!"](S,y("Integer"),"to_int"))<0||S>59)&&d.$raise(y("ArgumentError"),"min out of range: "+S),Q===a?Q=0:Q.$$is_number||(Q=Q.$$is_string?parseInt(Q,10):M["$coerce_to!"](Q,y("Integer"),"to_int")),(Q<0||Q>60)&&d.$raise(y("ArgumentError"),"sec out of range: "+Q),[l,f,_,x,S,Q]}return v(A,"$at",function(f,_){var x;return y("Time")["$==="](f)?(void 0!==_&&d.$raise(y("TypeError"),"can't convert Time into an exact number"),(x=new Date(f.getTime())).is_utc=f.is_utc,x):(f.$$is_number||(f=M["$coerce_to!"](f,y("Integer"),"to_int")),void 0===_?new Date(1e3*f):(_.$$is_number||(_=M["$coerce_to!"](_,y("Integer"),"to_int")),new Date(1e3*f+_/1e3)))},-2),v(A,"$new",function(f,_,x,S,Q,le,Ce){var T,O;return null==_&&(_=a),null==x&&(x=a),null==S&&(S=a),null==Q&&(Q=a),null==le&&(le=a),null==Ce&&(Ce=a),void 0===f?new Date:(Ce!==a&&d.$raise(y("ArgumentError"),"Opal does not support explicitly specifying UTC offset for Time"),f=(T=u(f,_,x,S,Q,le))[0],_=T[1],x=T[2],S=T[3],Q=T[4],le=T[5],O=new Date(f,_,x,S,Q,0,1e3*le),f<100&&O.setFullYear(f),O)},-1),v(A,"$local",function(f,_,x,S,Q,le,Ce,T,O,re){var j,ve;return null==_&&(_=a),null==x&&(x=a),null==S&&(S=a),null==Q&&(Q=a),null==le&&(le=a),null==Ce&&(Ce=a),null==T&&(T=a),null==O&&(O=a),null==re&&(re=a),10===arguments.length&&(f=(j=w.call(arguments))[5],_=j[4],x=j[3],S=j[2],Q=j[1],le=j[0]),f=(j=u(f,_,x,S,Q,le))[0],_=j[1],x=j[2],S=j[3],Q=j[4],le=j[5],ve=new Date(f,_,x,S,Q,0,1e3*le),f<100&&ve.setFullYear(f),ve},-2),v(A,"$gm",function(f,_,x,S,Q,le,Ce,T,O,re){var j,ve;return null==_&&(_=a),null==x&&(x=a),null==S&&(S=a),null==Q&&(Q=a),null==le&&(le=a),null==Ce&&(Ce=a),null==T&&(T=a),null==O&&(O=a),null==re&&(re=a),10===arguments.length&&(f=(j=w.call(arguments))[5],_=j[4],x=j[3],S=j[2],Q=j[1],le=j[0]),f=(j=u(f,_,x,S,Q,le))[0],_=j[1],x=j[2],S=j[3],Q=j[4],le=j[5],ve=new Date(Date.UTC(f,_,x,S,Q,0,1e3*le)),f<100&&ve.setUTCFullYear(f),ve.is_utc=!0,ve},-2),v(A,"$now",function(){return this.$new()},0),$(A,"$+",function(f){D(y("Time"),f)&&d.$raise(y("TypeError"),"time + time?"),f.$$is_number||(f=M["$coerce_to!"](f,y("Integer"),"to_int"));var x=new Date(this.getTime()+1e3*f);return x.is_utc=this.is_utc,x},1),$(A,"$-",function(f){var _=this;if(D(y("Time"),f))return(_.getTime()-f.getTime())/1e3;f.$$is_number||(f=M["$coerce_to!"](f,y("Integer"),"to_int"));var x=new Date(_.getTime()-1e3*f);return x.is_utc=_.is_utc,x},1),$(A,"$<=>",function(f){var x=a;return D(y("Time"),f)?this.$to_f()["$<=>"](f.$to_f()):(x=f["$<=>"](this),F(x["$nil?"]())?a:F(oe(x,0))?-1:F(G(x,0))?1:0)},1),$(A,"$==",function(f){var x;return F(x=y("Time")["$==="](f))?this.$to_f()===f.$to_f():x},1),$(A,"$asctime",function(){return this.$strftime("%a %b %e %H:%M:%S %Y")},0),$(A,"$day",function(){var f=this;return f.is_utc?f.getUTCDate():f.getDate()},0),$(A,"$yday",function(){var _,x,f=this;return _=P("Time").$new(f.$year()).$to_i(),x=P("Time").$new(f.$year(),f.$month(),f.$day()).$to_i(),L(V(H(x,_),86400).$round(),1)},0),$(A,"$isdst",function(){var f=this,_=new Date(f.getFullYear(),0,1),x=new Date(f.getFullYear(),6,1);return f.getTimezoneOffset()<Math.max(_.getTimezoneOffset(),x.getTimezoneOffset())},0),$(A,"$dup",function(){var f=this,_=a;return(_=new Date(f.getTime())).$copy_instance_variables(f),_.$initialize_dup(f),_},0),$(A,"$eql?",function(f){var x;return F(x=f["$is_a?"](y("Time")))?this["$<=>"](f)["$zero?"]():x},1),$(A,"$friday?",function(){return 5==this.$wday()},0),$(A,"$hash",function(){return"Time:"+this.getTime()},0),$(A,"$hour",function(){var f=this;return f.is_utc?f.getUTCHours():f.getHours()},0),$(A,"$inspect",function(){var f=this;return F(f["$utc?"]())?f.$strftime("%Y-%m-%d %H:%M:%S UTC"):f.$strftime("%Y-%m-%d %H:%M:%S %z")},0),$(A,"$min",function(){var f=this;return f.is_utc?f.getUTCMinutes():f.getMinutes()},0),$(A,"$mon",function(){var f=this;return(f.is_utc?f.getUTCMonth():f.getMonth())+1},0),$(A,"$monday?",function(){return 1==this.$wday()},0),$(A,"$saturday?",function(){return 6==this.$wday()},0),$(A,"$sec",function(){var f=this;return f.is_utc?f.getUTCSeconds():f.getSeconds()},0),$(A,"$succ",function(){var _=new Date(this.getTime()+1e3);return _.is_utc=this.is_utc,_},0),$(A,"$usec",function(){return 1e3*this.getMilliseconds()},0),$(A,"$zone",function(){var x,_=this.toString();return"GMT"==(x=-1==_.indexOf("(")?_.match(/[A-Z]{3,4}/)[0]:_.match(/\((.+)\)(?:\s|$)/)[1])&&/(GMT\W*\d{4})/.test(_)?RegExp.$1:x},0),$(A,"$getgm",function(){var _=new Date(this.getTime());return _.is_utc=!0,_},0),$(A,"$gmtime",function(){return this.is_utc=!0,this},0),$(A,"$gmt?",function(){return!0===this.is_utc},0),$(A,"$gmt_offset",function(){return this.is_utc?0:60*-this.getTimezoneOffset()},0),$(A,"$strftime",function(f){var _=this;return f.replace(/%([\-_#^0]*:{0,2})(\d+)?([EO]*)(.)/g,function(x,S,Q,le,Ce){var T="",O=-1!==S.indexOf("0"),re=-1===S.indexOf("-"),j=-1!==S.indexOf("_"),ve=-1!==S.indexOf("^"),de=-1!==S.indexOf("#"),Ee=(S.match(":")||[]).length;switch(Q=parseInt(Q,10),O&&j&&(S.indexOf("0")<S.indexOf("_")?O=!1:j=!1),Ce){case"Y":T+=_.$year();break;case"C":O=!j,T+=Math.round(_.$year()/100);break;case"y":O=!j,T+=_.$year()%100;break;case"m":O=!j,T+=_.$mon();break;case"B":T+=h[_.$mon()-1];break;case"b":case"h":j=!O,T+=C[_.$mon()-1];break;case"d":O=!j,T+=_.$day();break;case"e":j=!O,T+=_.$day();break;case"j":O=!j,Q=isNaN(Q)?3:Q,T+=_.$yday();break;case"H":O=!j,T+=_.$hour();break;case"k":j=!O,T+=_.$hour();break;case"I":O=!j,T+=_.$hour()%12||12;break;case"l":j=!O,T+=_.$hour()%12||12;break;case"P":T+=_.$hour()>=12?"pm":"am";break;case"p":T+=_.$hour()>=12?"PM":"AM";break;case"M":O=!j,T+=_.$min();break;case"S":O=!j,T+=_.$sec();break;case"L":O=!j,Q=isNaN(Q)?3:Q,T+=_.getMilliseconds();break;case"N":Q=isNaN(Q)?9:Q,T=(T+=_.getMilliseconds().toString().$rjust(3,"0")).$ljust(Q,"0");break;case"z":var ce=_.getTimezoneOffset(),he=Math.floor(Math.abs(ce)/60),B=Math.abs(ce)%60;T+=ce<0?"+":"-",T+=he<10?"0":"",T+=he,Ee>0&&(T+=":"),T+=B<10?"0":"",T+=B,Ee>1&&(T+=":00");break;case"Z":T+=_.$zone();break;case"A":T+=g[_.$wday()];break;case"a":T+=b[_.$wday()];break;case"u":T+=_.$wday()+1;break;case"w":T+=_.$wday();break;case"V":T+=_.$cweek_cyear()["$[]"](0).$to_s().$rjust(2,"0");break;case"G":T+=_.$cweek_cyear()["$[]"](1);break;case"g":T+=_.$cweek_cyear()["$[]"](1)["$[]"](se(-2,-1,!1));break;case"s":T+=_.$to_i();break;case"n":T+="\n";break;case"t":T+="\t";break;case"%":T+="%";break;case"c":T+=_.$strftime("%a %b %e %T %Y");break;case"D":case"x":T+=_.$strftime("%m/%d/%y");break;case"F":T+=_.$strftime("%Y-%m-%d");break;case"v":T+=_.$strftime("%e-%^b-%4Y");break;case"r":T+=_.$strftime("%I:%M:%S %p");break;case"R":T+=_.$strftime("%H:%M");break;case"T":case"X":T+=_.$strftime("%H:%M:%S");break;default:return x}return ve&&(T=T.toUpperCase()),de&&(T=T.replace(/[A-Z]/,function(R){R.toLowerCase()}).replace(/[a-z]/,function(R){R.toUpperCase()})),re&&(O||j)&&(T=T.$rjust(isNaN(Q)?2:Q,j?" ":"0")),T})},1),$(A,"$sunday?",function(){return 0==this.$wday()},0),$(A,"$thursday?",function(){return 4==this.$wday()},0),$(A,"$to_a",function(){var f=this;return[f.$sec(),f.$min(),f.$hour(),f.$day(),f.$month(),f.$year(),f.$wday(),f.$yday(),f.$isdst(),f.$zone()]},0),$(A,"$to_f",function(){return this.getTime()/1e3},0),$(A,"$to_i",function(){return parseInt(this.getTime()/1e3,10)},0),$(A,"$tuesday?",function(){return 2==this.$wday()},0),$(A,"$wday",function(){var f=this;return f.is_utc?f.getUTCDay():f.getDay()},0),$(A,"$wednesday?",function(){return 3==this.$wday()},0),$(A,"$year",function(){var f=this;return f.is_utc?f.getUTCFullYear():f.getFullYear()},0),$(A,"$cweek_cyear",function(){var x,f=this,Q=a,le=a,Ce=a,O=a;return x=y("Time").$new(f.$year(),1,1).$wday(),Q=f.$year(),F(ee(x,4))&&ue(x,0)?le=H(x,1):(le=H(H(x,7),1),Y(le,-8)&&(le=-1)),Ce=V(L(f.$yday(),le),7).$ceil(),F(ee(Ce,0))?y("Time").$new(H(f.$year(),1),12,31).$cweek_cyear():(Y(Ce,53)&&(O=y("Time").$new(f.$year(),12,31).$wday(),F(ee(O,3))&&ue(O,0)&&(Ce=1,Q=L(Q,1))),[Ce,Q])},0),l=E.get_singleton_class(A),ne(l,"mktime","local"),ne(l,"utc","gm"),ne(A,"ctime","asctime"),ne(A,"dst?","isdst"),ne(A,"getutc","getgm"),ne(A,"gmtoff","gmt_offset"),ne(A,"mday","day"),ne(A,"month","mon"),ne(A,"to_s","inspect"),ne(A,"tv_sec","to_i"),ne(A,"tv_usec","usec"),ne(A,"utc","gmtime"),ne(A,"utc?","gmt?"),ne(A,"utc_offset","gmt_offset")}(0,Date)},Opal.modules["corelib/struct"]=function(E){var a=E.nil,y=E.$$$,w=E.klass,p=E.hash2,d=E.truthy,M=E.neqeq,v=E.eqeq,D=E.Opal,$=E.send,F=E.Class,oe=E.to_a,G=E.def,L=E.defs,V=E.Kernel,H=E.rb_gt,se=E.rb_minus,ue=E.eqeqeq,ee=E.rb_lt,Y=E.rb_ge,ne=E.rb_plus,k=E.alias;return E.top.$require("corelib/enumerable"),function(q,z,A){var N=w("::",null,"Struct"),P=[N].concat([]),g=E.$r(P);N.$include(y("Enumerable")),L(N,"$new",function C(h,u,l){var _,x,S,Q,f=C.$$p||a,le=this,Ce=a;if(delete C.$$p,_=E.slice.call(arguments,1),null==(x=E.extract_kwargs(_)))x=p([],{});else if(!x.$$is_hash)throw E.ArgumentError.$new("expected kwargs");if(S=_,null==(Q=x.$$smap.keyword_init)&&(Q=!1),d(h))if(v(h.$class(),y("String"))&&M(h["$[]"](0).$upcase(),h["$[]"](0)))S.$unshift(h),h=a;else try{h=D["$const_name!"](h)}catch(T){if(!E.rescue(T,[y("TypeError"),y("NameError")]))throw T;try{S.$unshift(h),h=a}finally{E.pop_exception()}}return $(S,"map",[],function(O){return null==O&&(O=a),D["$coerce_to!"](O,y("String"),"to_str")},1),Ce=$(F,"new",[le],function T(){var re,O=null==T.$$s?this:T.$$s;return $(S,"each",[],function re(j){return null==j&&(j=a),(null==re.$$s?this:re.$$s).$define_struct_attribute(j)},{$$arity:1,$$s:O}),re=E.get_singleton_class(O),G(re,"$new",function(de){var ce,he=this,B=a;return ce=E.slice.call(arguments),(B=he.$allocate()).$$data={},$(B,"initialize",oe(ce)),B},-1),re.$alias_method("[]","new")},{$$arity:0,$$s:le}),d(f)&&$(Ce,"module_eval",[],f.$to_proc()),Ce.$$keyword_init=Q,d(h)&&y("Struct").$const_set(h,Ce),Ce},-2),L(N,"$define_struct_attribute",function(h){var u=this;return v(u,y("Struct"))&&V.$raise(y("ArgumentError"),"you cannot define attributes to the Struct class"),u.$members()["$<<"](h),$(u,"define_method",[h],function l(){return(null==l.$$s?this:l.$$s).$$data[h]},{$$arity:0,$$s:u}),$(u,"define_method",[h+"="],function l(f){return null==f&&(f=a),(null==l.$$s?this:l.$$s).$$data[h]=f},{$$arity:1,$$s:u})},1),L(N,"$members",function(){var u,h=this;return null==h.members&&(h.members=a),v(h,y("Struct"))&&V.$raise(y("ArgumentError"),"the Struct class has no members"),h.members=d(u=h.members)?u:[]},0),L(N,"$inherited",function(h){var l,u=this;return null==u.members&&(u.members=a),l=u.members,$(h,"instance_eval",[],function f(){return(null==f.$$s?this:f.$$s).members=l},{$$arity:0,$$s:u})},1),G(N,"$initialize",function(h){var u,l,f=this,_=a,x=a,S=a;return u=E.slice.call(arguments),l=u,d(f.$class().$$keyword_init)?(_=d(x=l.$last())?x:p([],{}),(d(H(l.$length(),1))||d(1===l.length&&!_.$$is_hash))&&V.$raise(y("ArgumentError"),"wrong number of arguments (given "+l.$length()+", expected 0)"),S=se(_.$keys(),f.$class().$members()),d(S["$any?"]())&&V.$raise(y("ArgumentError"),"unknown keywords: "+S.$join(", ")),$(f.$class().$members(),"each",[],function Q(le){var T,Ce=null==Q.$$s?this:Q.$$s;return null==le&&(le=a),T=[le,_["$[]"](le)],$(Ce,"[]=",oe(T)),T[se(T.length,1)]},{$$arity:1,$$s:f})):(d(H(l.$length(),f.$class().$members().$length()))&&V.$raise(y("ArgumentError"),"struct size differs"),$(f.$class().$members(),"each_with_index",[],function Q(le,Ce){var O,T=null==Q.$$s?this:Q.$$s;return null==le&&(le=a),null==Ce&&(Ce=a),O=[le,l["$[]"](Ce)],$(T,"[]=",oe(O)),O[se(O.length,1)]},{$$arity:2,$$s:f}))},-1),G(N,"$initialize_copy",function(h){this.$$data={};var f,_,x,l=Object.keys(h.$$data);for(f=0,_=l.length;f<_;f++)this.$$data[x=l[f]]=h.$$data[x]},1),L(N,"$keyword_init?",function(){return this.$$keyword_init},0),G(N,"$members",function(){return this.$class().$members()},0),G(N,"$hash",function(){return g("Hash").$new(this.$$data).$hash()},0),G(N,"$[]",function(h){var u=this;return ue(y("Integer"),h)?(d(ee(h,u.$class().$members().$size()["$-@"]()))&&V.$raise(y("IndexError"),"offset "+h+" too small for struct(size:"+u.$class().$members().$size()+")"),d(Y(h,u.$class().$members().$size()))&&V.$raise(y("IndexError"),"offset "+h+" too large for struct(size:"+u.$class().$members().$size()+")"),h=u.$class().$members()["$[]"](h)):ue(y("String"),h)?u.$$data.hasOwnProperty(h)||V.$raise(y("NameError").$new("no member '"+h+"' in struct",h)):V.$raise(y("TypeError"),"no implicit conversion of "+h.$class()+" into Integer"),h=D["$coerce_to!"](h,y("String"),"to_str"),u.$$data[h]},1),G(N,"$[]=",function(h,u){var l=this;return ue(y("Integer"),h)?(d(ee(h,l.$class().$members().$size()["$-@"]()))&&V.$raise(y("IndexError"),"offset "+h+" too small for struct(size:"+l.$class().$members().$size()+")"),d(Y(h,l.$class().$members().$size()))&&V.$raise(y("IndexError"),"offset "+h+" too large for struct(size:"+l.$class().$members().$size()+")"),h=l.$class().$members()["$[]"](h)):ue(y("String"),h)?d(l.$class().$members()["$include?"](h.$to_sym()))||V.$raise(y("NameError").$new("no member '"+h+"' in struct",h)):V.$raise(y("TypeError"),"no implicit conversion of "+h.$class()+" into Integer"),h=D["$coerce_to!"](h,y("String"),"to_str"),l.$$data[h]=u},2),G(N,"$==",function(h){if(!d(h["$instance_of?"](this.$class())))return!1;var l={},f={};return function _(x,S){var Q,le,Ce;for(Q in l[x.$__id__()]=!0,f[S.$__id__()]=!0,x.$$data)if(le=x.$$data[Q],Ce=S.$$data[Q],y("Struct")["$==="](le)){if(!(l.hasOwnProperty(le.$__id__())&&f.hasOwnProperty(Ce.$__id__())||_(le,Ce)))return!1}else if(!le["$=="](Ce))return!1;return!0}(this,h)},1),G(N,"$eql?",function(h){if(!d(h["$instance_of?"](this.$class())))return!1;var l={},f={};return function _(x,S){var Q,le,Ce;for(Q in l[x.$__id__()]=!0,f[S.$__id__()]=!0,x.$$data)if(le=x.$$data[Q],Ce=S.$$data[Q],y("Struct")["$==="](le)){if(!(l.hasOwnProperty(le.$__id__())&&f.hasOwnProperty(Ce.$__id__())||_(le,Ce)))return!1}else if(!le["$eql?"](Ce))return!1;return!0}(this,h)},1),G(N,"$each",function C(){var h=C.$$p||a,u=this;return delete C.$$p,h===a?$(u,"enum_for",["each"],function l(){return(null==l.$$s?this:l.$$s).$size()},{$$arity:0,$$s:u}):($(u.$class().$members(),"each",[],function l(f){return null==f&&(f=a),E.yield1(h,(null==l.$$s?this:l.$$s)["$[]"](f))},{$$arity:1,$$s:u}),u)},0),G(N,"$each_pair",function C(){var h=C.$$p||a,u=this;return delete C.$$p,h===a?$(u,"enum_for",["each_pair"],function l(){return(null==l.$$s?this:l.$$s).$size()},{$$arity:0,$$s:u}):($(u.$class().$members(),"each",[],function l(f){return null==f&&(f=a),E.yield1(h,[f,(null==l.$$s?this:l.$$s)["$[]"](f)])},{$$arity:1,$$s:u}),u)},0),G(N,"$length",function(){return this.$class().$members().$length()},0),G(N,"$to_a",function(){return $(this.$class().$members(),"map",[],function u(l){return null==l&&(l=a),(null==u.$$s?this:u.$$s)["$[]"](l)},{$$arity:1,$$s:this})},0);var b=[];return G(N,"$inspect",function(){var h=this,u=a,l=a;return function(){try{return u="#<struct ",d(b["$include?"](h.$__id__()))?ne(u,":...>"):(b["$<<"](h.$__id__()),l=!0,ue(y("Struct"),h)&&d(h.$class().$name())&&(u=ne(u,h.$class()+" ")),u=ne(u,$(h.$each_pair(),"map",[],function(_,x){return null==_&&(_=a),null==x&&(x=a),_+"="+g("Opal").$inspect(x)},2).$join(", ")),u=ne(u,">"))}finally{d(l)&&b.pop()}}()},0),G(N,"$to_h",function C(){var h=C.$$p||a,u=this;return delete C.$$p,h!==a?$($(u,"map",[],h.$to_proc()),"to_h",oe(u.$args())):$(u.$class().$members(),"each_with_object",[p([],{})],function l(f,_){var S;return null==f&&(f=a),null==_&&(_=a),S=[f,(null==l.$$s?this:l.$$s)["$[]"](f)],$(_,"[]=",oe(S)),S[se(S.length,1)]},{$$arity:2,$$s:u})},0),G(N,"$values_at",function(h){var u,l,f=this;u=E.slice.call(arguments);for(var _=[],x=0,S=(l=$(l=u,"map",[],function(le){return null==le&&(le=a),le.$$is_range?le.$to_a():le},1).$flatten()).length;x<S;x++)l[x].$$is_number||V.$raise(y("TypeError"),"no implicit conversion of "+l[x].$class()+" into Integer"),_.push(f["$[]"](l[x]));return _},-1),G(N,"$dig",function(h,u){var f,_=this,x=a;return f=E.slice.call(arguments,1),(x=d(h.$$is_string&&_.$$data.hasOwnProperty(h))&&_.$$data[h]||a)===a||0===f.length?x:(d(x["$respond_to?"]("dig"))||V.$raise(y("TypeError"),x.$class()+" does not have #dig method"),$(x,"dig",oe(f)))},-2),k(N,"size","length"),k(N,"to_s","inspect"),k(N,"values","to_a")}()},Opal.modules["corelib/dir"]=function(E){var oe,$,X=E.nil,a=E.$$$,w=E.def,p=E.truthy,d=E.alias;return[$=(0,E.klass)("::",null,"Dir")].concat([]),oe=E.get_singleton_class($),w(oe,"$chdir",function L(V){var H=L.$$p||X,se=X;return delete L.$$p,function(){try{return se=E.current_dir,E.current_dir=V,E.yieldX(H,[])}finally{E.current_dir=se}}()},1),w(oe,"$pwd",function(){return E.current_dir||"."},0),w(oe,"$home",function(){var V;return p(V=a("ENV")["$[]"]("HOME"))?V:"."},0),d(oe,"getwd","pwd")},Opal.modules["corelib/file"]=function(E){var ee,Y,ne,k,X=E.nil,a=E.$$$,y=E.truthy,p=E.const_set,d=E.Opal,M=E.regexp,v=E.rb_plus,D=E.def,$=E.Kernel,F=E.eqeq,oe=E.rb_lt,G=E.rb_minus,L=E.range,V=E.send,H=E.alias;return ee=[],ne=[Y=(0,E.klass)("::",a("IO"),"File")].concat(ee),k=X,p(ne[0],"Separator",p(ne[0],"SEPARATOR","/")),p(ne[0],"ALT_SEPARATOR",X),p(ne[0],"PATH_SEPARATOR",":"),p(ne[0],"FNM_SYSCASE",0),k=/^[a-zA-Z]:(?:\\|\/)/,function(q,z){var A=[q].concat(z),N=E.$r(A);function P(b){return y(b["$respond_to?"]("to_path"))&&(b=b.$to_path()),d["$coerce_to!"](b,a("String"),"to_str")}function g(){return N("ALT_SEPARATOR")===X?E.escape_regexp(N("SEPARATOR")):E.escape_regexp(v(N("SEPARATOR"),N("ALT_SEPARATOR")))}return D(q,"$absolute_path",function(C,h){var u,l,_,x,S,f=X,Q=X,le=X,Ce=X,T=X;null==h&&(h=X),u=N("SEPARATOR"),l=g(),f=[],C=y(C["$respond_to?"]("to_path"))?C.$to_path():C,C=d["$coerce_to!"](C,a("String"),"to_str"),h=y(_=h)?_:a("Dir").$pwd(),x=C.substr(0,u.length)===u||k.test(C),S=h.substr(0,u.length)===u||k.test(h),y(x)?(Q=C.$split(M(["[",l,"]"])),le=k.test(C)?"":C.$sub(M(["^([",l,"]+).*$"]),"\\1"),Ce=!0):(Q=v(h.$split(M(["[",l,"]"])),C.$split(M(["[",l,"]"]))),le=k.test(h)?"":h.$sub(M(["^([",l,"]+).*$"]),"\\1"),Ce=S);for(var O,re=0,j=Q.length;re<j;re++)(O=Q[re])!==X&&(""!==O||0!==f.length&&!Ce)&&("."!==O||0!==f.length&&!Ce)&&(".."===O?f.pop():f.push(O));return!Ce&&"."!==Q[0]&&f.$unshift("."),T=f.$join(u),y(Ce)&&(T=v(le,T)),T},-2),D(q,"$expand_path",function(C,h){var l,f,_=X,x=X,S=X;return null==h&&(h=X),l=N("SEPARATOR"),f=g(),y("~"===C[0]||h&&"~"===h[0])&&(_=N("Dir").$home(),y(_)||$.$raise(a("ArgumentError"),"couldn't find HOME environment -- expanding `~'"),x=k.test(_)?"":_.$sub(M(["^([",f,"]+).*$"]),"\\1"),y(_["$start_with?"](x))||$.$raise(a("ArgumentError"),"non-absolute home"),_=v(_,l),S=M(["^\\~(?:",l,"|$)"]),C=C.$sub(S,_),y(h)&&(h=h.$sub(S,_))),this.$absolute_path(C,h)},-2),D(q,"$dirname",function(C,h){var l;if(null==h&&(h=1),F(h,0))return C;y(oe(h,0))&&$.$raise(a("ArgumentError"),"level can't be negative"),l=g();var _,f=(C=P(C)).match(new RegExp("^["+l+"]"));return _=""===(C=(C=(C=C.replace(new RegExp("["+l+"]+$"),"")).replace(new RegExp("[^"+l+"]+$"),"")).replace(new RegExp("["+l+"]+$"),""))?f?"/":".":C,1==h?_:this.$dirname(_,G(h,1))},-2),D(q,"$basename",function(C,h){var u;return null==h&&(h=X),u=g(),0==(C=P(C)).length||(h=h!==X?d["$coerce_to!"](h,a("String"),"to_str"):null,C=(C=C.replace(new RegExp("(.)["+u+"]*$"),"$1")).replace(new RegExp("^(?:.*["+u+"])?([^"+u+"]+)$"),"$1"),".*"===h?C=C.replace(/\.[^\.]+$/,""):null!==h&&(h=E.escape_regexp(h),C=C.replace(new RegExp(h+"$"),""))),C},-2),D(q,"$extname",function(C){var u=X,l=X;return C=P(C),u=this.$basename(C),y(u["$empty?"]())||(l=u["$[]"](L(1,-1,!1)).$rindex("."),y(l["$nil?"]())||F(v(l,1),G(u.$length(),1)))?"":u["$[]"](E.Range.$new(v(l,1),-1,!1))},1),D(q,"$exist?",function(C){return null!=E.modules[C]},1),D(q,"$directory?",function(C){var h=X;for(var l in h=[],E.modules)h.push(l);return C=C.$gsub(M(["(^.",N("SEPARATOR"),"+|",N("SEPARATOR"),"+$)"])),V(h,"find",[],function(_){return null==_&&(_=X),_["$=~"](M(["^",C]))},1)},1),D(q,"$join",function(C){var h,u,l=X;return h=E.slice.call(arguments),y((u=h)["$empty?"]())?"":(l="",u=V(u.$flatten().$each_with_index(),"map",[],function(_,x){return null==_&&(_=X),null==x&&(x=X),F(x,0)&&y(_["$empty?"]())||F(u.$length(),v(x,1))&&y(_["$empty?"]())?N("SEPARATOR"):_},2),u=V(u,"reject",[],"empty?".$to_proc()),V(u,"each_with_index",[],function(_,x){var S=X;return null==_&&(_=X),null==x&&(x=X),S=u["$[]"](v(x,1)),y(S["$nil?"]())?l=""+l+_:(y(_["$end_with?"](N("SEPARATOR")))&&y(S["$start_with?"](N("SEPARATOR")))&&(_=_.$sub(M([N("SEPARATOR"),"+$"]),"")),l=y(_["$end_with?"](N("SEPARATOR")))||y(S["$start_with?"](N("SEPARATOR")))?""+l+_:""+l+_+N("SEPARATOR"))},2),l)},-1),D(q,"$split",function(C){return C.$split(N("SEPARATOR"))},1),H(q,"realpath","expand_path"),H(q,"exists?","exist?")}(E.get_singleton_class(Y),ne)},Opal.modules["corelib/process/base"]=function(E){var p,ae=E.nil,X=E.klass,a=E.defs;return p=X("::",null,"Signal"),a(p,"$trap",function(M){return E.slice.call(arguments),ae},-1),function(y,w){var p=X("::",null,"GC");return a(p,"$start",function(){return ae},0)}()},Opal.modules["corelib/process"]=function(E){var ae=E.nil,X=E.$$$,a=E.module,y=E.defs,w=E.truthy,p=E.Kernel;return function(d){var M=a("::","Process"),v=ae;if(M.__clocks__=[],y(M,"$__register_clock__",function(F,oe){var G=this;return null==G.__clocks__&&(G.__clocks__=ae),G.$const_set(F,G.__clocks__.$size()),G.__clocks__["$<<"](oe)},2),M.$__register_clock__("CLOCK_REALTIME",function(){return Date.now()}),v=!1,E.global.performance)v=function(){return performance.now()};else if(E.global.process&&process.hrtime){var D=process.hrtime();v=function(){var $=process.hrtime(D);return 1e3*$[0]+($[1]/1e3|0)/1e3}}return w(v)&&M.$__register_clock__("CLOCK_MONOTONIC",v),y(M,"$pid",function(){return 0},0),y(M,"$times",function(){var F;return F=X("Time").$now().$to_f(),X(X("Benchmark"),"Tms").$new(F,F,F,F,F)},0),y(M,"$clock_gettime",function(F,oe){var G=this,V=ae;null==G.__clocks__&&(G.__clocks__=ae),null==oe&&(oe="float_second"),w(V=G.__clocks__["$[]"](F))||p.$raise(X(X("Errno"),"EINVAL"),"clock_gettime("+F+") "+G.__clocks__["$[]"](F));var H=V();switch(oe){case"float_second":return H/1e3;case"float_millisecond":return H/1;case"float_microsecond":return 1e3*H;case"second":return H/1e3|0;case"millisecond":return H/1|0;case"microsecond":return 1e3*H|0;case"nanosecond":return 1e6*H|0;default:p.$raise(X("ArgumentError"),"unexpected unit: "+oe)}},-2)}()},Opal.modules["corelib/random/formatter"]=function(E){var V,ee,Y,ne,k,H,X=E.nil,a=E.$$$,w=E.module,p=E.def,d=E.send,M=E.to_a,v=E.rb_minus,D=E.range,$=E.rb_divide,F=E.Kernel,oe=E.Opal;return V=[],ee=[H=(0,E.klass)("::",null,"Random")].concat(V),ne=[Y=w(H,"Formatter")].concat(ee),k=E.$r(ne),p(Y,"$hex",function(z){null==z&&(z=X),z=a("Random").$_verify_count(z);for(var N=this.$bytes(z),P="",g=0;g<z;g++)P+=N.charCodeAt(g).toString(16).padStart(2,"0");return P.$encode("US-ASCII")},-1),p(Y,"$random_bytes",function(z){return null==z&&(z=X),this.$bytes(z)},-1),p(Y,"$base64",function(z){return null==z&&(z=X),a("Base64").$strict_encode64(this.$random_bytes(z)).$encode("US-ASCII")},-1),p(Y,"$urlsafe_base64",function(z,A){return null==z&&(z=X),null==A&&(A=!1),a("Base64").$urlsafe_encode64(this.$random_bytes(z),A).$encode("US-ASCII")},-1),p(Y,"$uuid",function(){var A=X,N=X;return A=this.$hex(16).$split(""),d(A,"[]=",M(N=[12,"4"])),v(N.length,1),N=[16,(3&parseInt(A["$[]"](16),16)|8).toString(16)],d(A,"[]=",M(N)),v(N.length,1),A=[A["$[]"](D(0,8,!0)),A["$[]"](D(8,12,!0)),A["$[]"](D(12,16,!0)),A["$[]"](D(16,20,!0)),A["$[]"](D(20,32,!0))],(A=d(A,"map",[],"join".$to_proc())).$join("-")},0),p(Y,"$random_float",function(){var A=X,N=X;return A=this.$bytes(4),N=0,d(4,"times",[],function(g){return null==g&&(g=X),N=(N=N["$<<"](8))["$|"](A["$[]"](g).$ord())},1),$(N.$abs(),2147483647)},0),p(Y,"$random_number",function(z){var A=this;function N(){return A.$random_float()}function P(b){return Math.floor(N()*b)}return null==z?N():z.$$is_range?function g(){var b=z.begin,C=z.end;if(b===X||C===X)return X;var h=C-b;return h<0?X:0===h?b:(C%1==0&&b%1==0&&!z.excl&&h++,P(h)+b)}():z.$$is_number?(z<=0&&F.$raise(a("ArgumentError"),"invalid argument - "+z),z%1==0?P(z):N()*z):((z=oe["$coerce_to!"](z,a("Integer"),"to_int"))<=0&&F.$raise(a("ArgumentError"),"invalid argument - "+z),P(z))},-1),p(Y,"$alphanumeric",function(z){var N=X;return null==z&&(z=X),z=k("Random").$_verify_count(z),N=d([D("0","9",!1),D("a","z",!1),D("A","Z",!1)],"map",[],"to_a".$to_proc()).$flatten(),d(a("Array"),"new",[z],function P(g){return null==g&&(g=X),N["$[]"]((null==P.$$s?this:P.$$s).$random_number(N.$length()))},{$$arity:1,$$s:this}).$join()},-1),H.$include(a(a("Random"),"Formatter")),H.$extend(a(a("Random"),"Formatter"))},Opal.modules["corelib/random/mersenne_twister"]=function(E){var F,$,oe,X=E.$$$,a=E.klass,y=E.const_set,w=E.send,p=E.to_a,d=E.rb_minus,M=E.nil;return M=function(){var v=624,D=397,L=function(ne,k){return function(ne,k){return 2147483648&ne|2147483647&k}(ne,k)>>>1^(1&k?2567483615:0)};function ue(ne){var k;return--ne.left<=0&&function se(ne){var z,k=0,q=ne.state;for(ne.left=v,ne.next=0,z=228;--z;k++)q[k]=q[k+D]^L(q[k+0],q[k+1]);for(z=D;--z;k++)q[k]=q[k+(D-v)]^L(q[k+0],q[k+1]);q[k]=q[k+(D-v)]^L(q[k+0],q[0])}(ne),k=ne.state[ne.next++],k^=k>>>11,k^=k<<7&2636928640,k^=k<<15&4022730752,(k^=k>>>18)>>>0}return{genrand_real:function Y(ne){return function ee(ne,k){return(67108864*(ne>>>=5)+(k>>>=6))*(1/9007199254740992)}(ue(ne),ue(ne))},init:function V(ne){var k={left:0,next:v,state:new Array(v)};return function H(ne,k){var q;for(ne.state[0]=k>>>0,q=1;q<v;q++)ne.state[q]=1812433253*(ne.state[q-1]^ne.state[q-1]>>30>>>0)+q,ne.state[q]&=4294967295;ne.left=1,ne.next=v}(k,ne),k}}}(),$=a("::",null,"Random"),oe=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1,y($,"MERSENNE_TWISTER_GENERATOR",{new_seed:function(){return Math.round(Math.random()*oe)},reseed:function(G){return M.init(G)},rand:function(G){return M.genrand_real(G)}}),w($,"generator=",p(F=[X($,"MERSENNE_TWISTER_GENERATOR")])),F[d(F.length,1)]},Opal.modules["corelib/random"]=function(E){var G,ae=E.top,X=E.nil,a=E.$$$,y=E.truthy,w=E.klass,p=E.Kernel,d=E.defs,M=E.Opal,v=E.def,D=E.eqeqeq,$=E.send;return ae.$require("corelib/random/formatter"),(G=w("::",null,"Random")).$attr_reader("seed","state"),d(G,"$_verify_count",function(V){return y(V)||(V=16),"number"!=typeof V&&(V=V.$to_int()),V<0&&p.$raise(a("ArgumentError"),"negative string size (or size too big)"),Math.floor(V)},1),v(G,"$initialize",function(V){return null==V&&(V=a("Random").$new_seed()),V=M["$coerce_to!"](V,a("Integer"),"to_int"),this.state=V,this.$reseed(V)},-1),v(G,"$reseed",function(V){return this.seed=V,this.$rng=E.$$rand.reseed(V)},1),d(G,"$new_seed",function(){return E.$$rand.new_seed()},0),d(G,"$rand",function(V){return a(this,"DEFAULT").$rand(V)},-1),d(G,"$srand",function(V){var se;return null==V&&(V=a("Random").$new_seed()),V=M["$coerce_to!"](V,a("Integer"),"to_int"),se=a(this,"DEFAULT").$seed(),a(this,"DEFAULT").$reseed(V),se},-1),d(G,"$urandom",function(V){return a("SecureRandom").$bytes(V)},1),v(G,"$==",function(V){var se=X;return!!D(a("Random"),V)&&(y(se=this.$seed()["$=="](V.$seed()))?this.$state()["$=="](V.$state()):se)},1),v(G,"$bytes",function(V){return V=a("Random").$_verify_count(V),$(a("Array"),"new",[V],function se(){return(null==se.$$s?this:se.$$s).$rand(255).$chr()},{$$arity:0,$$s:this}).$join().$encode("ASCII-8BIT")},1),d(G,"$bytes",function(V){return a(this,"DEFAULT").$bytes(V)},1),v(G,"$rand",function(V){return this.$random_number(V)},-1),v(G,"$random_float",function(){return this.state++,E.$$rand.rand(this.$rng)},0),d(G,"$random_float",function(){return a(this,"DEFAULT").$random_float()},0),d(G,"$generator=",function(V){var H=this;return E.$$rand=V,y(H["$const_defined?"]("DEFAULT"))?a(H,"DEFAULT").$reseed():H.$const_set("DEFAULT",H.$new(H.$new_seed()))},1),ae.$require("corelib/random/mersenne_twister")},Opal.modules["corelib/unsupported"]=function(E){var V,H,se,ae=E.top,a=E.nil,y=E.$$$,w=E.Kernel,p=E.klass,d=E.send,M=E.module,v=E.def,D=E.alias,$=E.defs,F={};function oe(L){switch(E.config.unsupported_features_severity){case"error":w.$raise(y("NotImplementedError"),L);break;case"warning":!function G(L){F[L]||(F[L]=!0,ae.$warn(L))}(L)}}return H=p("::",null,"String"),se="String#%s not supported. Mutable String methods are not supported in Opal.",d(["<<","capitalize!","chomp!","chop!","downcase!","gsub!","lstrip!","next!","reverse!","slice!","squeeze!","strip!","sub!","succ!","swapcase!","tr!","tr_s!","upcase!","prepend","[]=","clear","encode!","unicode_normalize!"],"each",[],function ue(ee){return null==ee&&(ee=a),d(null==ue.$$s?this:ue.$$s,"define_method",[ee],function(k){return E.slice.call(arguments),w.$raise(y("NotImplementedError"),se["$%"](ee))},-1)},{$$arity:1,$$s:H}),function(L){var V=M("::","Kernel"),H="Object freezing is not supported by Opal";v(V,"$freeze",function(){return oe(H),this},0),v(V,"$frozen?",function(){return oe(H),!1},0)}(),function(L){var V=M("::","Kernel"),H="Object tainting is not supported by Opal";v(V,"$taint",function(){return oe(H),this},0),v(V,"$untaint",function(){return oe(H),this},0),v(V,"$tainted?",function(){return oe(H),!1},0)}(),function(L,V){var H=p("::",null,"Module");v(H,"$public",function(ue){var Y,ne=this;return 0===(Y=E.slice.call(arguments)).length?(ne.$$module_function=!1,a):1===Y.length?Y[0]:Y},-1),v(H,"$private_class_method",function(ue){var Y;return 1===(Y=E.slice.call(arguments)).length?Y[0]:Y},-1),v(H,"$private_method_defined?",function(ue){return!1},1),v(H,"$private_constant",function(ue){return E.slice.call(arguments),a},-1),D(H,"nesting","public"),D(H,"private","public"),D(H,"protected","public"),D(H,"protected_method_defined?","private_method_defined?"),D(H,"public_class_method","private_class_method"),D(H,"public_instance_method","instance_method"),D(H,"public_instance_methods","instance_methods"),D(H,"public_method_defined?","method_defined?")}(),V=M("::","Kernel"),v(V,"$private_methods",function(se){return E.slice.call(arguments),[]},-1),D(V,"private_instance_methods","private_methods"),function(L,V){var H=M("::","Kernel"),se=[H].concat([]),ue=E.$r(se);v(H,"$eval",function(Y){return E.slice.call(arguments),w.$raise(y("NotImplementedError"),"To use Kernel#eval, you must first require 'opal-parser'. See https://github.com/opal/opal/blob/"+ue("RUBY_ENGINE_VERSION")+"/docs/opal_parser.md for details.")},-1)}(),$(ae,"$public",function(V){var se;return 1===(se=E.slice.call(arguments)).length?se[0]:se},-1),$(ae,"$private",function(V){var se;return 1===(se=E.slice.call(arguments)).length?se[0]:se},-1)},Opal.queue(function(E){var X=E.Object;return X.$require("opal/base"),X.$require("opal/mini"),X.$require("corelib/kernel/format"),X.$require("corelib/string/encoding"),X.$autoload("Math","corelib/math"),X.$require("corelib/complex/base"),X.$autoload("Complex","corelib/complex"),X.$require("corelib/rational/base"),X.$autoload("Rational","corelib/rational"),X.$require("corelib/time"),X.$autoload("Struct","corelib/struct"),X.$require("corelib/dir"),X.$autoload("File","corelib/file"),X.$require("corelib/process/base"),X.$autoload("Process","corelib/process"),X.$autoload("Random","corelib/random"),X.$require("corelib/unsupported")}),Opal.queue(function(E){var q,g,b,C,h,z,A,N,ae=E.top,X=[],a=E.$r(X),y=E.nil,w=E.$$$,p=E.module,d=E.defs,M=E.truthy,v=E.send,D=E.Kernel,$=E.hash2,F=E.range,oe=E.to_a,G=E.def,L=E.alias,V=E.klass,H=E.rb_minus,se=E.send2,ue=E.find_super,ee=E.eqeqeq,Y=E.rb_ge,ne=E.gvars;return q=X,A=[z=p(X[0],"Native")].concat(q),N=E.$r(A),d(z,"$is_a?",function(g,b){try{return g instanceof this.$try_convert(b)}catch(h){return!1}},2),d(z,"$try_convert",function(g,b){return null==b&&(b=y),this["$native?"](g)?g:g["$respond_to?"]("to_n")?g.$to_n():b},-2),d(z,"$convert",function(g){return this["$native?"](g)?g:g["$respond_to?"]("to_n")?g.$to_n():void this.$raise(N("ArgumentError"),g.$inspect()+" isn't native")},1),d(z,"$call",function P(g,b,C){var l,h=P.$$p||y,f=this;delete P.$$p,l=E.slice.call(arguments,2);var _=g[b];if(_ instanceof Function){for(var x=new Array(l.length),S=0,Q=l.length;S<Q;S++){var le=l[S],Ce=f.$try_convert(le);x[S]=Ce===y?le:Ce}return h!==y&&x.push(h),f.$Native(_.apply(g,x))}return f.$Native(_)},-3),d(z,"$proc",function P(){var g=P.$$p||y;return delete P.$$p,M(g)||this.$raise(N("LocalJumpError"),"no block given"),v(D,"proc",[],function C(h){var u,l,f=null==C.$$s?this:C.$$s,_=y;if(u=E.slice.call(arguments),v(l=u,"map!",[],function S(Q){return null==Q&&(Q=y),(null==S.$$s?this:S.$$s).$Native(Q)},{$$arity:1,$$s:f}),_=f.$Native(this),this===E.global)return g.apply(f,l);var x=g.$$s;g.$$s=null;try{return g.apply(_,l)}finally{g.$$s=x}},{$$arity:-1,$$s:this})},0),g=A,C=[b=p(A[0],"Helpers")].concat(g),h=E.$r(C),G(b,"$alias_native",function u(l,f,_){var x,S,Q,le,T=this;if(delete u.$$p,x=E.slice.call(arguments,1),null==(S=E.extract_kwargs(x)))S=$([],{});else if(!S.$$is_hash)throw E.ArgumentError.$new("expected kwargs");return x.length>0&&(Q=x.shift()),null==Q&&(Q=l),null==(le=S.$$smap.as)&&(le=y),M(Q["$end_with?"]("="))?v(T,"define_method",[l],function O(re){var j=null==O.$$s?this:O.$$s;return null==j.native&&(j.native=y),null==re&&(re=y),j.native[Q["$[]"](F(0,-2,!1))]=h("Native").$convert(re),re},{$$arity:1,$$s:T}):M(le)?v(T,"define_method",[l],function O(re){var de,j=O.$$p||y,Ee=null==O.$$s?this:O.$$s,ce=y;return null==Ee.native&&(Ee.native=y),delete O.$$p,de=E.slice.call(arguments),ce=v(h("Native"),"call",[Ee.native,Q].concat(oe(de)),j.$to_proc()),M(ce)?le.$new(ce.$to_n()):y},{$$arity:-1,$$s:T}):v(T,"define_method",[l],function O(re){var de,j=O.$$p||y,Ee=null==O.$$s?this:O.$$s;return null==Ee.native&&(Ee.native=y),delete O.$$p,de=E.slice.call(arguments),v(h("Native"),"call",[Ee.native,Q].concat(oe(de)),j.$to_proc())},{$$arity:-1,$$s:T})},-2),G(b,"$native_reader",function(l){var f,x=this;return f=E.slice.call(arguments),v(f,"each",[],function S(Q){var le=null==S.$$s?this:S.$$s;return null==Q&&(Q=y),v(le,"define_method",[Q],function Ce(){var T=null==Ce.$$s?this:Ce.$$s;return null==T.native&&(T.native=y),T.$Native(T.native[Q])},{$$arity:0,$$s:le})},{$$arity:1,$$s:x})},-1),G(b,"$native_writer",function(l){var f,x=this;return f=E.slice.call(arguments),v(f,"each",[],function S(Q){var le=null==S.$$s?this:S.$$s;return null==Q&&(Q=y),v(le,"define_method",[Q+"="],function Ce(T){var O=null==Ce.$$s?this:Ce.$$s;return null==O.native&&(O.native=y),null==T&&(T=y),O.$Native(O.native[Q]=T)},{$$arity:1,$$s:le})},{$$arity:1,$$s:x})},-1),G(b,"$native_accessor",function(l){var f,_,x=this;return f=E.slice.call(arguments),v(x,"native_reader",oe(_=f)),v(x,"native_writer",oe(_))},-1),function(P,g){var b=p(P,"Wrapper"),C=[b].concat(g),h=E.$r(C);G(b,"$initialize",function(l){return M(D["$native?"](l))||D.$raise(h("ArgumentError"),l.$inspect()+" isn't native"),this.native=l},1),G(b,"$to_n",function(){var l=this;return null==l.native&&(l.native=y),l.native},0),d(b,"$included",function(l){return l.$extend(h("Helpers"))},1)}(A[0],A),d(z,"$included",function(g){return this.$warn("Including ::Native is deprecated. Please include Native::Wrapper instead."),g.$include(N("Wrapper"))},1),function(k,q){var z=p(k,"Kernel"),A=[z].concat(q),N=E.$r(A);G(z,"$native?",function(g){return null==g||!g.$$class},1),G(z,"$Native",function P(g){var C=this;return delete P.$$p,M(null==g)?y:M(C["$native?"](g))?w(N("Native"),"Object").$new(g):M(g["$is_a?"](N("Array")))?v(g,"map",[],function h(u){return null==u&&(u=y),(null==h.$$s?this:h.$$s).$Native(u)},{$$arity:1,$$s:C}):M(g["$is_a?"](N("Proc")))?v(C,"proc",[],function h(u){var f,l=h.$$p||y,x=null==h.$$s?this:h.$$s;return delete h.$$p,f=E.slice.call(arguments),x.$Native(v(g,"call",oe(f),l.$to_proc()))},{$$arity:-1,$$s:C}):g},1),L(z,"_Array","Array"),G(z,"$Array",function P(g,b){var u,C=P.$$p||y,l=this;return delete P.$$p,u=E.slice.call(arguments,1),M(l["$native?"](g))?v(w(N("Native"),"Array"),"new",[g].concat(oe(u)),C.$to_proc()).$to_a():l.$_Array(g)},-2)}(X[0],X),function(k,q){var z=V(k,q,"Object");z.$$prototype.native=y,z.$include(w(w("Native"),"Wrapper")),G(z,"$==",function(P){return this.native===w("Native").$try_convert(P)},1),G(z,"$has_key?",function(P){return E.hasOwnProperty.call(this.native,P)},1),G(z,"$each",function N(P){var b,C=N.$$p||y,h=this;if(delete N.$$p,b=E.slice.call(arguments),C!==y){for(var u in h.native)E.yieldX(C,[u,h.native[u]]);return h}return v(h,"method_missing",["each"].concat(oe(b)))},-1),G(z,"$[]",function(P){var b=this.native[P];return b instanceof Function?b:w("Native").$call(this.native,P)},1),G(z,"$[]=",function(P,g){var C;return C=w("Native").$try_convert(g),this.native[P]=M(C===y)?g:C},2),G(z,"$merge!",function(P){for(var b in P=w("Native").$convert(P))this.native[b]=P[b];return this},1),G(z,"$respond_to?",function(P,g){return null==g&&(g=!1),D.$instance_method("respond_to?").$bind(this).$call(P,g)},-2),G(z,"$respond_to_missing?",function(P,g){return null==g&&(g=!1),E.hasOwnProperty.call(this.native,P)},-2),G(z,"$method_missing",function N(P,g){var h,b=N.$$p||y,u=this,l=y;return delete N.$$p,h=E.slice.call(arguments,1),"="===P.charAt(P.length-1)?(l=[P.$slice(0,H(P.$length(),1)),h["$[]"](0)],v(u,"[]=",oe(l)),l[H(l.length,1)]):v(w("Native"),"call",[u.native,P].concat(oe(h)),b.$to_proc())},-2),G(z,"$nil?",function(){return!1},0),G(z,"$is_a?",function(P){return E.is_a(this,P)},1),G(z,"$instance_of?",function(P){return this.$$class===P},1),G(z,"$class",function(){return this.$$class},0),G(z,"$to_a",function N(P){var g=N.$$p||y;return delete N.$$p,null==P&&(P=$([],{})),v(w(w("Native"),"Array"),"new",[this.native,P],g.$to_proc()).$to_a()},-1),G(z,"$inspect",function(){return"#<Native:"+String(this.native)+">"},0),L(z,"include?","has_key?"),L(z,"key?","has_key?"),L(z,"kind_of?","is_a?"),L(z,"member?","has_key?")}(a("Native"),a("BasicObject")),function(k,q,z){var A=V(k,null,"Array"),N=[A].concat(z),P=E.$r(N),g=A.$$prototype;g.named=g.native=g.get=g.block=g.set=g.length=y,A.$include(w(P("Native"),"Wrapper")),A.$include(P("Enumerable")),G(A,"$initialize",function b(C,h){var u=b.$$p||y,l=this,f=y;return delete b.$$p,null==h&&(h=$([],{})),se(l,ue(l,"initialize",b,!1,!0),"initialize",[C],null),l.get=M(f=h["$[]"]("get"))?f:h["$[]"]("access"),l.named=h["$[]"]("named"),l.set=M(f=h["$[]"]("set"))?f:h["$[]"]("access"),l.length=M(f=h["$[]"]("length"))?f:"length",l.block=u,M(null==l.$length())?l.$raise(P("ArgumentError"),"no length found on the array-like object"):y},-2),G(A,"$each",function b(){var C=b.$$p||y,h=this;if(delete b.$$p,!M(C))return h.$enum_for("each");for(var u=0,l=h.$length();u<l;u++)E.yield1(C,h["$[]"](u));return h},0),G(A,"$[]",function(C){var u,l,h=this;return u=ee(P("String"),l=C)||ee(P("Symbol"),l)?M(h.named)?h.native[h.named](C):h.native[C]:ee(P("Integer"),l)?M(h.get)?h.native[h.get](C):h.native[C]:y,M(u)?M(h.block)?h.block.$call(u):h.$Native(u):y},1),G(A,"$[]=",function(C,h){var u=this;return M(u.set)?u.native[u.set](C,P("Native").$convert(h)):u.native[C]=P("Native").$convert(h)},2),G(A,"$last",function(C){var u=this,l=y,f=y;if(null==C&&(C=y),M(C)){for(l=H(u.$length(),1),f=[];M(Y(l,0));)f["$<<"](u["$[]"](l)),l=H(l,1);return f}return u["$[]"](H(u.$length(),1))},-1),G(A,"$length",function(){return this.native[this.length]},0),G(A,"$inspect",function(){return this.$to_a().$inspect()},0),L(A,"to_ary","to_a")}(a("Native"),0,X),function(k,q){var z=V(k,null,"Numeric");G(z,"$to_n",function(){return this.valueOf()},0)}(X[0]),function(k,q){var z=V(k,null,"Proc");G(z,"$to_n",function(){return this},0)}(X[0]),function(k,q){var z=V(k,null,"String");G(z,"$to_n",function(){return this.valueOf()},0)}(X[0]),function(k,q){var z=V(k,null,"Regexp");G(z,"$to_n",function(){return this.valueOf()},0)}(X[0]),function(k,q){var z=V(k,null,"MatchData");z.$$prototype.matches=y,G(z,"$to_n",function(){return this.matches},0)}(X[0]),function(k,q,z){var A=V(k,null,"Struct"),N=[A].concat(z),P=E.$r(N);G(A,"$to_n",function(){var C=y;return C={},v(this,"each_pair",[],function(u,l){return null==u&&(u=y),null==l&&(l=y),C[u]=P("Native").$try_convert(l,l)},2),C},0)}(X[0],0,X),function(k,q,z){var A=V(k,null,"Array"),N=[A].concat(z),P=E.$r(N);G(A,"$to_n",function(){for(var C=[],h=0,u=this.length;h<u;h++){var l=this[h];C.push(P("Native").$try_convert(l,l))}return C},0)}(X[0],0,X),function(k,q){var z=V(k,null,"Boolean");G(z,"$to_n",function(){return this.valueOf()},0)}(X[0]),function(k,q){var z=V(k,null,"Time");G(z,"$to_n",function(){return this},0)}(X[0]),function(k,q){var z=V(k,null,"NilClass");G(z,"$to_n",function(){return null},0)}(X[0]),M(a("Hash")["$method_defined?"]("_initialize"))||function(k,q,z){var A=V(k,null,"Hash"),N=[A].concat(z),P=E.$r(N);L(A,"_initialize","initialize"),G(A,"$initialize",function g(b){var C=g.$$p||y,h=this;if(delete g.$$p,null!=b&&(void 0===b.constructor||b.constructor===Object)){var f,_,u=h.$$smap,l=h.$$keys;for(f in b)!(_=b[f])||void 0!==_.constructor&&_.constructor!==Object?_&&_.$$is_array?(_=_.map(function(x){return!x||void 0!==x.constructor&&x.constructor!==Object?h.$Native(x):P("Hash").$new(x)}),u[f]=_):u[f]=h.$Native(_):u[f]=P("Hash").$new(_),l.push(f);return h}return v(h,"_initialize",[b],C.$to_proc())},-1),G(A,"$to_n",function(){for(var l,f,C={},h=this.$$keys,u=this.$$smap,_=0,x=h.length;_<x;_++)f=(l=h[_]).$$is_string?u[l]:(l=l.key).value,C[l]=P("Native").$try_convert(f,f);return C},0)}(X[0],0,X),function(k,q){var z=V(k,null,"Module");G(z,"$native_module",function(){return E.global[this.$name()]=this},0)}(X[0]),function(k,q,z){var A=V(k,null,"Class"),N=[A].concat(z),P=E.$r(N);G(A,"$native_alias",function(b,C){var h=this,u=h.prototype["$"+C];u||h.$raise(P("NameError").$new("undefined method `"+C+"' for class `"+h.$inspect()+"'",C)),h.prototype[b]=u},2),G(A,"$native_class",function(){var b=this;return b.$native_module(),b.new=b.$new},0)}(X[0],0,X),ne.$=ne.global=ae.$Native(E.global)}),Opal.modules.strscan=function(E){var G,L,V,H,se,ae=[],X=E.nil,y=E.def,w=E.truthy,p=E.eqeqeq,d=E.Opal,M=E.send,v=E.to_a,D=E.rb_minus,$=E.alias;return G=ae,V=[L=(0,E.klass)(ae[0],null,"StringScanner")].concat(G),H=E.$r(V),(se=L.$$prototype).pos=se.string=se.working=se.matched=se.prev_pos=se.match=X,L.$attr_reader("pos","matched"),y(L,"$initialize",function(ee){var Y=this;return Y.string=ee,Y.pos=0,Y.matched=X,Y.working=ee,Y.match=[]},1),L.$attr_reader("string"),y(L,"$beginning_of_line?",function(){return 0===this.pos||"\n"===this.string.charAt(this.pos-1)},0),y(L,"$scan",function(ee){var Y=this,ne=(ee=Y.$anchor(ee)).exec(Y.working);return null==ne?Y.matched=X:"object"==typeof ne?(Y.prev_pos=Y.pos,Y.pos+=ne[0].length,Y.working=Y.working.substring(ne[0].length),Y.matched=ne[0],Y.match=ne,ne[0]):"string"==typeof ne?(Y.pos+=ne.length,Y.working=Y.working.substring(ne.length),ne):X},1),y(L,"$scan_until",function(ee){var Y=this;ee=Y.$anchor(ee);for(var q,ne=Y.pos,k=Y.working;;){if(q=ee.exec(k),ne+=1,k=k.substr(1),null!=q)return Y.matched=Y.string.substr(Y.pos,ne-Y.pos-1+q[0].length),Y.match=q,Y.prev_pos=ne-1,Y.pos=ne,Y.working=k.substr(q[0].length),Y.matched;if(0===k.length)return Y.match=[],Y.matched=X}},1),y(L,"$[]",function(ee){var ne;if(w(this.match["$empty?"]()))return X;p(H("Symbol"),ne=ee)?ee=ee.$to_s():p(H("String"),ne)||(ee=d["$coerce_to!"](ee,H("Integer"),"to_int"));var k=this.match;return ee<0&&(ee+=k.length),ee<0||ee>=k.length||null==k[ee]?X:k[ee]},1),y(L,"$check",function(ee){var Y=this,ne=(ee=Y.$anchor(ee)).exec(Y.working);return Y.matched=null==ne?X:ne[0]},1),y(L,"$check_until",function(ee){var Y=this,ne=Y.prev_pos,k=Y.pos,q=Y.$scan_until(ee);return q!==X&&(Y.matched=q.substr(-1),Y.working=Y.string.substr(k)),Y.prev_pos=ne,Y.pos=k,q},1),y(L,"$peek",function(ee){return this.working.substring(0,ee)},1),y(L,"$eos?",function(){return 0===this.working.length},0),y(L,"$exist?",function(ee){var ne=ee.exec(this.working);return null==ne?X:0==ne.index?0:ne.index+1},1),y(L,"$skip",function(ee){var Y=this,ne=(ee=Y.$anchor(ee)).exec(Y.working);if(null==ne)return Y.match=[],Y.matched=X;var k=ne[0],q=k.length;return Y.matched=k,Y.match=ne,Y.prev_pos=Y.pos,Y.pos+=q,Y.working=Y.working.substring(q),q},1),y(L,"$skip_until",function(ee){var ne=this.$scan_until(ee);return ne===X?X:(this.matched=ne.substr(-1),ne.length)},1),y(L,"$get_byte",function(){var ee=this,Y=X;return ee.pos<ee.string.length?(ee.prev_pos=ee.pos,ee.pos+=1,Y=ee.matched=ee.working.substring(0,1),ee.working=ee.working.substring(1)):ee.matched=X,Y},0),y(L,"$match?",function(ee){var Y=this,ne=(ee=Y.$anchor(ee)).exec(Y.working);return null==ne?X:(Y.prev_pos=Y.pos,ne[0].length)},1),y(L,"$pos=",function(ee){var Y=this;return ee<0&&(ee+=Y.string.$length()),Y.pos=ee,Y.working=Y.string.slice(ee)},1),y(L,"$matched_size",function(){return this.matched===X?X:this.matched.length},0),y(L,"$post_match",function(){return this.matched===X?X:this.string.substr(this.pos)},0),y(L,"$pre_match",function(){return this.matched===X?X:this.string.substr(0,this.prev_pos)},0),y(L,"$reset",function(){return this.working=this.string,this.matched=X,this.pos=0},0),y(L,"$rest",function(){return this.working},0),y(L,"$rest?",function(){return 0!==this.working.length},0),y(L,"$rest_size",function(){return this.$rest().$size()},0),y(L,"$terminate",function(){var Y;return this.match=X,Y=[this.string.$length()],M(this,"pos=",v(Y)),Y[D(Y.length,1)]},0),y(L,"$unscan",function(){var ee=this;return ee.pos=ee.prev_pos,ee.prev_pos=X,ee.match=X,ee},0),$(L,"bol?","beginning_of_line?"),$(L,"getch","get_byte"),L.$private(),y(L,"$anchor",function(ee){var Y=ee.toString().match(/\/([^\/]+)$/);return Y=Y?Y[1]:void 0,new RegExp("^(?:"+ee.source+")",Y)},1)},Opal.queue(function(E){var v,D,oe,$,ae=E.top,X=[],a=E.$r(X),y=E.nil,w=E.klass,p=E.def,d=E.module;return ae.$require("strscan"),D=X,[$=w(X[0],null,"Dir")].concat(D),oe=E.get_singleton_class($),p(oe,"$[]",function(){return[]},0),v=d(X[0],"ObjectFreezeStub"),p(v,"$freeze",function(){return this},0),a("Object").$prepend(a("ObjectFreezeStub")),function(M){var v=d(M,"StringScannerPatch");p(v,"$scan_until",function($){var F=this;$=(F=this).$anchor($);for(var L,oe=F.pos,G=F.working;;){var V=0===G.length;if(L=$.exec(G),oe+=1,G=G.substr(1),null!=L)return F.matched=F.string.substr(F.pos,oe-F.pos-1+L[0].length),F.prev_pos=oe-1,F.pos=oe,F.working=G.substr(L[0].length-1),F.matched;if(V)return F.matched=y}},1)}(X[0]),a("StringScanner").$prepend(a("StringScannerPatch")),E.top.$__dir__=()=>"/",y})},8465:(E,ae,X)=>{X(9993),Opal.modules["bcdice/arithmetic/node"]=function(a){var ue,k,N,u,l,g,b,z,Y,y=[],w=a.nil,p=a.$$$,d=a.module,M=a.klass,v=a.def,D=a.send2,$=a.find_super,F=a.eqeq,oe=a.const_set,G=a.eqeqeq,L=a.rb_divide,V=a.truthy,H=a.alias;return ue=y,k=Y=[d(y[0],"BCDice")].concat(ue),N=z=[d(Y[0],"Arithmetic")].concat(k),g=[d(z[0],"Node")].concat(N),b=a.$r(g),(l=(u=M(g[0],null,"BinaryOp")).$$prototype).lhs=l.rhs=l.op=w,v(u,"$initialize",function(_,x,S){var Q=this;return Q.lhs=_,Q.op=x,Q.rhs=S},3),v(u,"$eval",function(_){var Q,x=this,S=w;return S=x.lhs.$eval(_),Q=x.rhs.$eval(_),S.$send(x.op,Q)},1),v(u,"$output",function(){var _=this;return""+_.lhs.$output()+_.op+_.rhs.$output()},0),v(u,"$s_exp",function(){var _=this;return"("+_.$op_for_s_exp()+" "+_.lhs.$s_exp()+" "+_.rhs.$s_exp()+")"},0),v(u,"$op_for_s_exp",function(){return this.op},0),function(C,h,u){var l=M(C,h,"DivideBase"),f=[l].concat(u),_=a.$r(f),x=l.$$prototype;x.lhs=x.rhs=x.op=w,v(l,"$initialize",function S(Q,le){return delete S.$$p,D(this,$(this,"initialize",S,!1,!0),"initialize",[Q,"/",le],null)},2),v(l,"$eval",function(Q){var Ce,T;return Ce=this.lhs.$eval(Q),T=this.rhs.$eval(Q),F(T,0)&&this.$raise(_("ZeroDivisionError")),this.$divide_and_round(Ce,T,Q)},1),v(l,"$output",function S(){var Q=S.$$p||w;return delete S.$$p,""+D(this,$(this,"output",S,!1,!0),"output",[],Q)+this.$rounding_method()},0),l.$private(),v(l,"$rounding_method",function(){return p(this.$class(),"ROUNDING_METHOD")},0),v(l,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()},0),v(l,"$divide_and_round",function(Q,le,Ce){return this.$raise(_("NotImplementedError"))},3)}(g[0],b("BinaryOp"),g),function(C,h,u){var l=M(C,h,"DivideWithGameSystemDefault"),f=[l].concat(u),_=a.$r(f);oe(f[0],"ROUNDING_METHOD",""),l.$private(),v(l,"$divide_and_round",function(S,Q,le){var Ce,T=w;return G(p(_("RoundType"),"CEIL"),Ce=le)?L(S.$to_f(),Q).$ceil():G(p(_("RoundType"),"ROUND"),Ce)?(T=L(S.$to_f(),Q),V(T["$negative?"]())?T.$abs().$round()["$-@"]():T.$round()):L(S,Q).$floor()},3)}(g[0],b("DivideBase"),g),function(C,h,u){var l=M(C,h,"DivideWithCeil"),f=[l].concat(u);oe(f[0],"ROUNDING_METHOD","C"),l.$private(),v(l,"$divide_and_round",function(x,S,Q){return L(x.$to_f(),S).$ceil()},3)}(g[0],b("DivideBase"),g),function(C,h,u){var l=M(C,h,"DivideWithRound"),f=[l].concat(u);oe(f[0],"ROUNDING_METHOD","R"),l.$private(),v(l,"$divide_and_round",function(x,S,Q){var le=w;return le=L(x.$to_f(),S),V(le["$negative?"]())?le.$abs().$round()["$-@"]():le.$round()},3)}(g[0],b("DivideBase"),g),function(C,h,u){var l=M(C,h,"DivideWithFloor"),f=[l].concat(u);oe(f[0],"ROUNDING_METHOD","F"),l.$private(),v(l,"$divide_and_round",function(x,S,Q){return L(x,S).$floor()},3)}(g[0],b("DivideBase"),g),function(C,h){var u=M(C,null,"Negative");u.$$prototype.body=w,v(u,"$initialize",function(_){return this.body=_},1),v(u,"$eval",function(_){return this.body.$eval(_)["$-@"]()},1),v(u,"$output",function(){return"-"+this.body.$output()},0),v(u,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"},0)}(g[0]),function(C,h){var u=M(C,null,"Parenthesis");u.$$prototype.expr=w,v(u,"$initialize",function(_){return this.expr=_},1),v(u,"$eval",function(_){return this.expr.$eval(_)},1),v(u,"$output",function(){return"("+this.expr.$output()+")"},0),v(u,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"},0)}(g[0]),function(C,h){var u=M(C,null,"Number");return u.$$prototype.value=w,v(u,"$initialize",function(_){return this.value=_},1),v(u,"$eval",function(_){return this.value},1),v(u,"$output",function(){return this.value.$to_s()},0),H(u,"s_exp","output")}(g[0])},Opal.modules["racc/parser"]=function(a){var b,h,u,w=[],p=a.$r(w),d=a.nil,M=a.$$$,v=a.module,D=a.klass,$=a.truthy,F=a.const_set,oe=a.defs,G=a.gvars,L=a.rb_lt,V=a.send,H=a.to_a,se=a.rb_minus,ue=a.def,ee=a.to_ary,Y=a.neqeq,ne=a.rb_plus,k=a.eqeq,q=a.rb_ge,z=a.rb_gt,A=a.eqeqeq,N=a.rb_le,P=a.rb_times;return b=w,h=[v(w[0],"Racc")].concat(b),u=a.$r(h),D(h[0],u("StandardError"),"ParseError"),$(M("::","ParseError","skip_raise")?"constant":d)||F(w[0],"ParseError",M(p("Racc"),"ParseError")),function(g,b){var x,S,Q,le,Ce,u=[v(g,"Racc")].concat(b),l=a.$r(u);return $(l("Racc_No_Extensions","skip_raise")?"constant":d)||F(u[0],"Racc_No_Extensions",!1),x=u,Q=[S=D(u[0],null,"Parser")].concat(x),le=a.$r(Q),(Ce=S.$$prototype).yydebug=Ce.racc_debug_out=Ce.racc_error_status=Ce.racc_t=Ce.racc_vstack=Ce.racc_val=Ce.racc_state=Ce.racc_tstack=d,F(Q[0],"Racc_Runtime_Version","1.4.6"),F(Q[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),F(Q[0],"Racc_Runtime_Core_Version_R","1.4.6"),F(Q[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),F(Q[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),F(Q[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),F(Q[0],"Racc_Runtime_Core_Version",le("Racc_Runtime_Core_Version_R")),F(Q[0],"Racc_Runtime_Core_Revision",le("Racc_Runtime_Core_Revision_R")),F(Q[0],"Racc_Runtime_Type","ruby"),oe(le("Parser"),"$racc_runtime_type",function(){return le("Racc_Runtime_Type")},0),ue(S,"$_racc_setup",function(){var O,re,j=this,ve=d,de=d,Ee=d;return null==G.stderr&&(G.stderr=d),$(M(j.$class(),"Racc_debug_parser"))||(j.yydebug=!1),$(null!=(O=j.yydebug)&&O!==d?"instance-variable":d)||(j.yydebug=!1),$(j.yydebug)&&($(null!=(re=j.racc_debug_out)&&re!==d?"instance-variable":d)||(j.racc_debug_out=G.stderr),j.racc_debug_out=$(ve=j.racc_debug_out)?ve:G.stderr),de=M(j.$class(),"Racc_arg"),$(L(de.$size(),14))&&(V(de,"[]=",H(Ee=[13,!0])),se(Ee.length,1)),de},0),ue(S,"$_racc_init_sysvars",function(){var O=this;return O.racc_state=[0],O.racc_tstack=[],O.racc_vstack=[],O.racc_t=d,O.racc_val=d,O.racc_read_next=!0,O.racc_user_yyerror=!1,O.racc_error_status=0},0),ue(S,"$do_parse",function(){return this.$__send__(le("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},0),ue(S,"$next_token",function(){return this.$raise(le("NotImplementedError"),this.$class()+"#next_token is not defined")},0),ue(S,"$_racc_do_parse_rb",function(O,re){var j,Ee=d,ce=d,he=d,B=d,ie=d,W=d,me=d,$e=d;return j=ee(O),Ee=null==j[0]?d:j[0],ce=null==j[1]?d:j[1],he=null==j[2]?d:j[2],B=null==j[3]?d:j[3],ie=null==j[10]?d:j[10],this.$_racc_init_sysvars(),W=me=$e=d,V(this,"catch",["racc_end_parse"],function _e(){var Pe,Ae,Ne=null==_e.$$s?this:_e.$$s,We=d;for(null==Ne.racc_state&&(Ne.racc_state=d),null==Ne.racc_read_next&&(Ne.racc_read_next=d),null==Ne.racc_t&&(Ne.racc_t=d),null==Ne.yydebug&&(Ne.yydebug=d),null==Ne.racc_val&&(Ne.racc_val=d);$(!0);)for($($e=B["$[]"](Ne.racc_state["$[]"](-1)))?($(Ne.racc_read_next)&&Y(Ne.racc_t,0)&&(Ae=Ne.$next_token(),Pe=ee(Ae),W=null==Pe[0]?d:Pe[0],Ne.racc_val=null==Pe[1]?d:Pe[1],Ne.racc_t=$(W)?$(We=ie["$[]"](W))?We:1:0,$(Ne.yydebug)&&Ne.$racc_read_token(Ne.racc_t,W,Ne.racc_val),Ne.racc_read_next=!1),$e=ne($e,Ne.racc_t),$(q($e,0))&&$(me=Ee["$[]"]($e))&&k(ce["$[]"]($e),Ne.racc_state["$[]"](-1))||(me=he["$[]"](Ne.racc_state["$[]"](-1)))):me=he["$[]"](Ne.racc_state["$[]"](-1));$(me=Ne.$_racc_evalact(me,O)););},{$$arity:0,$$s:this})},2),ue(S,"$yyparse",function(O,re){return this.$__send__(le("Racc_YY_Parse_Method"),O,re,this.$_racc_setup(),!0)},2),ue(S,"$_racc_yyparse_rb",function(O,re,j,ve){var de,he=d,B=d,R=d,ie=d,me=d,$e=d,_e=d;return de=ee(j),he=null==de[0]?d:de[0],B=null==de[1]?d:de[1],R=null==de[2]?d:de[2],ie=null==de[3]?d:de[3],me=null==de[10]?d:de[10],this.$_racc_init_sysvars(),$e=d,_e=d,V(this,"catch",["racc_end_parse"],function Ie(){var Ne=null==Ie.$$s?this:Ie.$$s;for(null==Ne.racc_state&&(Ne.racc_state=d);!$(_e=ie["$[]"](Ne.racc_state["$[]"](-1)));)for(;$($e=Ne.$_racc_evalact(R["$[]"](Ne.racc_state["$[]"](-1)),j)););return V(O,"__send__",[re],function We(nt,Nt){var mt=null==We.$$s?this:We.$$s,$t=d,cr=d;for(null==mt.racc_t&&(mt.racc_t=d),null==mt.racc_state&&(mt.racc_state=d),null==mt.racc_read_next&&(mt.racc_read_next=d),null==nt&&(nt=d),null==Nt&&(Nt=d),mt.racc_t=$(nt)?$($t=me["$[]"](nt))?$t:1:0,mt.racc_val=Nt,mt.racc_read_next=!1,_e=ne(_e,mt.racc_t),$(q(_e,0))&&$($e=he["$[]"](_e))&&k(B["$[]"](_e),mt.racc_state["$[]"](-1))||($e=R["$[]"](mt.racc_state["$[]"](-1)));$($e=mt.$_racc_evalact($e,j)););for(;$($($t=$(cr=(_e=ie["$[]"](mt.racc_state["$[]"](-1)))["$!"]())?cr:mt.racc_read_next["$!"]())?$t:mt.racc_t["$=="](0));)for($(_e)&&$(_e=ne(_e,mt.racc_t))&&$(q(_e,0))&&$($e=he["$[]"](_e))&&k(B["$[]"](_e),mt.racc_state["$[]"](-1))||($e=R["$[]"](mt.racc_state["$[]"](-1)));$($e=mt.$_racc_evalact($e,j)););},{$$arity:2,$$s:Ne})},{$$arity:0,$$s:this})},4),ue(S,"$_racc_evalact",function(O,re){var j,R,de=this,Ee=d,ce=d,B=d,ie=d,W=d,me=d,$e=d;if(Ee=null==(j=ee(re))[0]?d:j[0],ce=null==j[1]?d:j[1],B=null==j[3]?d:j[3],R=null==j[11]?d:j[11],ie=null==j[12]?d:j[12],$(z(O,0))&&$(L(O,R)))$(z(de.racc_error_status,0))&&(k(de.racc_t,1)||(de.racc_error_status=se(de.racc_error_status,1))),de.racc_vstack.$push(de.racc_val),de.racc_state.$push(O),de.racc_read_next=!0,$(de.yydebug)&&(de.racc_tstack.$push(de.racc_t),de.$racc_shift(de.racc_t,de.racc_tstack,de.racc_vstack));else if($(L(O,0))&&$(z(O,ie["$-@"]()))){if(W=V(de,"catch",["racc_jump"],function _e(){var Ie=null==_e.$$s?this:_e.$$s;return null==Ie.racc_state&&(Ie.racc_state=d),Ie.racc_state.$push(Ie.$_racc_do_reduce(re,O)),!1},{$$arity:0,$$s:de}),$(W)){if(A(1,me=W))return de.racc_user_yyerror=!0,ie["$-@"]();if(A(2,me))return R;de.$raise("[Racc Bug] unknown jump code")}}else if(k(O,R))$(de.yydebug)&&de.$racc_accept(),de.$throw("racc_end_parse",de.racc_vstack["$[]"](0));else{if(k(O,ie["$-@"]())){for(A(0,me=de.racc_error_status)?$(re["$[]"](21))||de.$on_error(de.racc_t,de.racc_val,de.racc_vstack):A(3,me)&&(k(de.racc_t,0)&&de.$throw("racc_end_parse",d),de.racc_read_next=!0),de.racc_user_yyerror=!1,de.racc_error_status=3;$(!0)&&!($($e=B["$[]"](de.racc_state["$[]"](-1)))&&($e=ne($e,1),$(q($e,0))&&$(O=Ee["$[]"]($e))&&k(ce["$[]"]($e),de.racc_state["$[]"](-1))));)$(N(de.racc_state.$size(),1))&&de.$throw("racc_end_parse",d),de.racc_state.$pop(),de.racc_vstack.$pop(),$(de.yydebug)&&(de.racc_tstack.$pop(),de.$racc_e_pop(de.racc_state,de.racc_tstack,de.racc_vstack));return O}de.$raise("[Racc Bug] unknown action "+O.$inspect())}return $(de.yydebug)&&de.$racc_next_state(de.racc_state["$[]"](-1),de.racc_state),d},2),ue(S,"$_racc_do_reduce",function(O,re){var j,ie,me,Ne,We,nt,mt,de=this,ce=d,he=d,B=d,R=d,W=d,$e=d,_e=d,Ie=d,Pe=d,Ae=d,Nt=d,jt=d,Ot=d,$t=d;return ce=null==(j=ee(O))[4]?d:j[4],he=null==j[5]?d:j[5],B=null==j[6]?d:j[6],R=null==j[7]?d:j[7],ie=null==j[8]?d:j[8],W=null==j[9]?d:j[9],me=null==j[13]?d:j[13],$e=de.racc_state,_e=de.racc_vstack,Ie=de.racc_tstack,Pe=P(re,-3),Ae=W["$[]"](Pe),Ne=W["$[]"](ne(Pe,1)),We=W["$[]"](ne(Pe,2)),nt=[],$(de.yydebug)&&(Nt=Ie["$[]"](Ae["$-@"](),Ae)),jt=_e["$[]"](Ae["$-@"](),Ae),$(de.yydebug)&&(Ot=[Ae["$-@"](),Ae,nt],V(Ie,"[]=",H(Ot)),se(Ot.length,1)),Ot=[Ae["$-@"](),Ae,nt],V(_e,"[]=",H(Ot)),se(Ot.length,1),Ot=[Ae["$-@"](),Ae,nt],V($e,"[]=",H(Ot)),se(Ot.length,1),$(me)?_e.$push(de.$__send__(We,jt,_e,jt["$[]"](0))):_e.$push(de.$__send__(We,jt,_e)),Ie.$push(Ne),$(de.yydebug)&&de.$racc_reduce(Nt,Ne,Ie,_e),mt=se(Ne,ie),$(Pe=R["$[]"](mt))&&(Pe=ne(Pe,$e["$[]"](-1)),$(q(Pe,0))&&$($t=ce["$[]"](Pe))&&k(he["$[]"](Pe),mt))?$t:B["$[]"](mt)},2),ue(S,"$on_error",function(O,re,j){var de;return this.$raise(le("ParseError"),this.$sprintf("\nparse error on value %s (%s)",re.$inspect(),$(de=this.$token_to_str(O))?de:"?"))},3),ue(S,"$yyerror",function(){return this.$throw("racc_jump",1)},0),ue(S,"$yyaccept",function(){return this.$throw("racc_jump",2)},0),ue(S,"$yyerrok",function(){return this.racc_error_status=0},0),ue(S,"$racc_read_token",function(O,re,j){var ve=this;return ve.racc_debug_out.$print("read    "),ve.racc_debug_out.$print(re.$inspect(),"(",ve.$racc_token2str(O),") "),ve.racc_debug_out.$puts(j.$inspect()),ve.racc_debug_out.$puts()},3),ue(S,"$racc_shift",function(O,re,j){return this.racc_debug_out.$puts("shift   "+this.$racc_token2str(O)),this.$racc_print_stacks(re,j),this.racc_debug_out.$puts()},3),ue(S,"$racc_reduce",function(O,re,j,ve){var de=this,Ee=d;return(Ee=de.racc_debug_out).$print("reduce "),$(O["$empty?"]())?Ee.$print(" <none>"):V(O,"each",[],function ce(he){return null==he&&(he=d),Ee.$print(" ",(null==ce.$$s?this:ce.$$s).$racc_token2str(he))},{$$arity:1,$$s:de}),Ee.$puts(" --\x3e "+de.$racc_token2str(re)),de.$racc_print_stacks(j,ve),de.racc_debug_out.$puts()},4),ue(S,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},0),ue(S,"$racc_e_pop",function(O,re,j){return this.racc_debug_out.$puts("error recovering mode: pop token"),this.$racc_print_states(O),this.$racc_print_stacks(re,j),this.racc_debug_out.$puts()},3),ue(S,"$racc_next_state",function(O,re){var j=this;return j.racc_debug_out.$puts("goto    "+O),j.$racc_print_states(re),j.racc_debug_out.$puts()},2),ue(S,"$racc_print_stacks",function(O,re){var ve=d;return(ve=this.racc_debug_out).$print("        ["),V(O,"each_index",[],function de(Ee){return null==Ee&&(Ee=d),ve.$print(" (",(null==de.$$s?this:de.$$s).$racc_token2str(O["$[]"](Ee))," ",re["$[]"](Ee).$inspect(),")")},{$$arity:1,$$s:this}),ve.$puts(" ]")},2),ue(S,"$racc_print_states",function(O){var j=d;return(j=this.racc_debug_out).$print("        ["),V(O,"each",[],function(de){return null==de&&(de=d),j.$print(" ",de)},1),j.$puts(" ]")},1),ue(S,"$racc_token2str",function(O){var j;return $(j=M(this.$class(),"Racc_token_to_s_table")["$[]"](O))?j:this.$raise("[Racc Bug] can't convert token "+O+" to string")},1),ue(S,"$token_to_str",function(O){return M(this.$class(),"Racc_token_to_s_table")["$[]"](O)},1)}(w[0],w)},Opal.modules.strscan=function(a){var H,se,ue,ee,Y,y=[],w=a.nil,d=a.def,M=a.truthy,v=a.eqeqeq,D=a.Opal,$=a.send,F=a.to_a,oe=a.rb_minus,G=a.alias;return H=y,ue=[se=(0,a.klass)(y[0],null,"StringScanner")].concat(H),ee=a.$r(ue),(Y=se.$$prototype).pos=Y.string=Y.working=Y.matched=Y.prev_pos=Y.match=w,se.$attr_reader("pos","matched"),d(se,"$initialize",function(k){var q=this;return q.string=k,q.pos=0,q.matched=w,q.working=k,q.match=[]},1),se.$attr_reader("string"),d(se,"$beginning_of_line?",function(){var k=this;return 0===k.pos||"\n"===k.string.charAt(k.pos-1)},0),d(se,"$scan",function(k){var q=this,z=(k=q.$anchor(k)).exec(q.working);return null==z?q.matched=w:"object"==typeof z?(q.prev_pos=q.pos,q.pos+=z[0].length,q.working=q.working.substring(z[0].length),q.matched=z[0],q.match=z,z[0]):"string"==typeof z?(q.pos+=z.length,q.working=q.working.substring(z.length),z):w},1),d(se,"$scan_until",function(k){var q=this;k=q.$anchor(k);for(var N,z=q.pos,A=q.working;;){if(N=k.exec(A),z+=1,A=A.substr(1),null!=N)return q.matched=q.string.substr(q.pos,z-q.pos-1+N[0].length),q.match=N,q.prev_pos=z-1,q.pos=z,q.working=A.substr(N[0].length),q.matched;if(0===A.length)return q.match=[],q.matched=w}},1),d(se,"$[]",function(k){var z;if(M(this.match["$empty?"]()))return w;v(ee("Symbol"),z=k)?k=k.$to_s():v(ee("String"),z)||(k=D["$coerce_to!"](k,ee("Integer"),"to_int"));var A=this.match;return k<0&&(k+=A.length),k<0||k>=A.length||null==A[k]?w:A[k]},1),d(se,"$check",function(k){var q=this,z=(k=q.$anchor(k)).exec(q.working);return q.matched=null==z?w:z[0]},1),d(se,"$check_until",function(k){var q=this,z=q.prev_pos,A=q.pos,N=q.$scan_until(k);return N!==w&&(q.matched=N.substr(-1),q.working=q.string.substr(A)),q.prev_pos=z,q.pos=A,N},1),d(se,"$peek",function(k){return this.working.substring(0,k)},1),d(se,"$eos?",function(){return 0===this.working.length},0),d(se,"$exist?",function(k){var z=k.exec(this.working);return null==z?w:0==z.index?0:z.index+1},1),d(se,"$skip",function(k){var q=this,z=(k=q.$anchor(k)).exec(q.working);if(null==z)return q.match=[],q.matched=w;var A=z[0],N=A.length;return q.matched=A,q.match=z,q.prev_pos=q.pos,q.pos+=N,q.working=q.working.substring(N),N},1),d(se,"$skip_until",function(k){var z=this.$scan_until(k);return z===w?w:(this.matched=z.substr(-1),z.length)},1),d(se,"$get_byte",function(){var k=this,q=w;return k.pos<k.string.length?(k.prev_pos=k.pos,k.pos+=1,q=k.matched=k.working.substring(0,1),k.working=k.working.substring(1)):k.matched=w,q},0),d(se,"$match?",function(k){var q=this,z=(k=q.$anchor(k)).exec(q.working);return null==z?w:(q.prev_pos=q.pos,z[0].length)},1),d(se,"$pos=",function(k){var q=this;return k<0&&(k+=q.string.$length()),q.pos=k,q.working=q.string.slice(k)},1),d(se,"$matched_size",function(){return this.matched===w?w:this.matched.length},0),d(se,"$post_match",function(){var k=this;return k.matched===w?w:k.string.substr(k.pos)},0),d(se,"$pre_match",function(){var k=this;return k.matched===w?w:k.string.substr(0,k.prev_pos)},0),d(se,"$reset",function(){var k=this;return k.working=k.string,k.matched=w,k.pos=0},0),d(se,"$rest",function(){return this.working},0),d(se,"$rest?",function(){return 0!==this.working.length},0),d(se,"$rest_size",function(){return this.$rest().$size()},0),d(se,"$terminate",function(){var q,k=this;return k.match=w,q=[k.string.$length()],$(k,"pos=",F(q)),q[oe(q.length,1)]},0),d(se,"$unscan",function(){var k=this;return k.pos=k.prev_pos,k.prev_pos=w,k.match=w,k},0),G(se,"bol?","beginning_of_line?"),G(se,"getch","get_byte"),se.$private(),d(se,"$anchor",function(k){var q=k.toString().match(/\/([^\/]+)$/);return q=q?q[1]:void 0,new RegExp("^(?:"+k.source+")",q)},1)},Opal.modules["bcdice/normalize"]=function(a){var $,L,oe,y=[],w=a.nil,p=a.module,d=a.eqeqeq,M=a.def,v=a.eqeq;return $=y,oe=[p(y[0],"BCDice")].concat($),(L=p(oe[0],"Normalize")).$module_function(),M(L,"$comparison_operator",function(H){var se;return d(/<=|=</,se=H)?"<=":d(/>=|=>/,se)?">=":d(/<>|!=|=!/,se)?"!=":d(/</,se)?"<":d(/>/,se)?">":d(/=/,se)?"==":w},1),M(L,"$target_number",function(H){return v(H,"?")?H:H.$to_i()},1)},Opal.modules["bcdice/common_command/lexer"]=function(a){var G,se,k,q,z,A,ee,V,y=a.top,w=[],p=a.nil,d=a.module,M=a.klass,v=a.const_set,D=a.hash2,$=a.truthy,F=a.def;return y.$require("strscan"),y.$require("bcdice/normalize"),G=w,se=V=[d(w[0],"BCDice")].concat(G),k=ee=[d(V[0],"CommonCommand")].concat(se),z=[q=M(ee[0],null,"Lexer")].concat(k),A=a.$r(z),q.$$prototype.scanner=p,v(z[0],"SYMBOLS",D(["+","-","*","/","(",")","[","]","?","@"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","?":"QUESTION","@":"AT"}).$freeze()),F(q,"$initialize",function(g){var C;return g=$(C=g.$split(" ",2).$first())?C:"",this.scanner=A("StringScanner").$new(g)},1),F(q,"$next_token",function(){var g=this,b=p,C=p,h=p,l=p;return $(g.scanner["$eos?"]())?[!1,"$"]:$(b=g.scanner.$scan(/\d+/))?["NUMBER",b.$to_i()]:$(C=g.scanner.$scan(/[<>!=]+/))?["CMP_OP",A("Normalize").$comparison_operator(C)]:(h=g.scanner.$getch().$upcase(),[$(l=A("SYMBOLS")["$[]"](h))?l:h.$to_sym(),h])},0),F(q,"$source",function(){return this.scanner.$string()},0)},Opal.modules["bcdice/arithmetic/parser"]=function(a){var L,ue,z,g,b,C,h,u,l,f,_,x,le,A,N,P,Y,ne,H,y=a.top,w=[],p=a.nil,d=a.$$$,M=a.module,v=a.klass,D=a.defs,$=a.def,F=a.hash,oe=a.const_set;return y.$require("racc/parser.rb"),y.$require("bcdice/common_command/lexer"),y.$require("bcdice/arithmetic/node"),L=w,ue=H=[M(w[0],"BCDice")].concat(L),Y=[M(H[0],"Arithmetic")].concat(ue),ne=a.$r(Y),z=Y,N=[A=v(Y[0],d(ne("Racc"),"Parser"),"Parser")].concat(z),P=a.$r(N),A.$$prototype.lexer=p,D(A,"$parse",function(j){return this.$new().$parse(j)},1),$(A,"$parse",function(j){try{return this.lexer=d(d(P("BCDice"),"CommonCommand"),"Lexer").$new(j),this.$do_parse()}catch(de){if(!a.rescue(de,[P("ParseError")]))throw de;try{return p}finally{a.pop_exception()}}},1),A.$private(),$(A,"$next_token",function(){return this.lexer.$next_token()},0),g=[8,17,8,12,13,4,5,4,5,7,8,7,8,12,13,4,5,4,5,7,8,7,8,12,13,4,5,4,5,7,8,7,8,p,p,4,5,4,5,7,9,7,p,p,10,11,p,10,11,22,26,24,25,27],b=[0,9,4,2,2,0,0,4,4,0,5,4,7,18,18,5,5,7,7,5,10,7,11,19,19,10,10,11,11,10,12,11,13,p,p,12,12,13,13,12,1,13,p,p,16,16,p,1,1,16,21,21,21,21],C=[-2,40,-6,p,0,8,p,10,p,1,18,20,28,30,p,p,37,p,4,14,p,47,p,p,p,p,p,p],h=[-17,-17,-3,-6,-17,-17,-14,-17,-16,-17,-17,-17,-17,-17,-12,-13,-17,28,-1,-2,-4,-7,-15,-5,-8,-9,-10,-11],u=[14,15,23,1,18,19,p,p,20,21,16],l=[3,3,4,1,2,2,p,p,3,3,1],f=[p,3,-6,-4,-19,p],_=[p,p,2,3,p,6],x=[0,0,"racc_error",3,14,"_reduce_1",3,14,"_reduce_2",1,14,"_reduce_none",3,15,"_reduce_4",4,15,"_reduce_5",1,15,"_reduce_none",0,17,"_reduce_7",1,17,"_reduce_8",1,17,"_reduce_9",1,17,"_reduce_10",1,17,"_reduce_11",2,16,"_reduce_12",2,16,"_reduce_13",1,16,"_reduce_none",3,18,"_reduce_15",1,18,"_reduce_16"],le=F(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12),oe(N[0],"Racc_arg",[g,b,h,C,u,l,_,f,13,x,le,28,17,!0]),oe(N[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","$start","add","mul","unary","round_type","term"]),oe(N[0],"Racc_debug_parser",!1),$(A,"$_reduce_1",function(j,ve,de){return d(d(P("Arithmetic"),"Node"),"BinaryOp").$new(j["$[]"](0),"+",j["$[]"](2))},3),$(A,"$_reduce_2",function(j,ve,de){return d(d(P("Arithmetic"),"Node"),"BinaryOp").$new(j["$[]"](0),"-",j["$[]"](2))},3),$(A,"$_reduce_4",function(j,ve,de){return d(d(P("Arithmetic"),"Node"),"BinaryOp").$new(j["$[]"](0),"*",j["$[]"](2))},3),$(A,"$_reduce_5",function(j,ve,de){return j["$[]"](3).$new(j["$[]"](0),j["$[]"](2))},3),$(A,"$_reduce_7",function(j,ve,de){return d(d(P("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),$(A,"$_reduce_8",function(j,ve,de){return d(d(P("Arithmetic"),"Node"),"DivideWithCeil")},3),$(A,"$_reduce_9",function(j,ve,de){return d(d(P("Arithmetic"),"Node"),"DivideWithCeil")},3),$(A,"$_reduce_10",function(j,ve,de){return d(d(P("Arithmetic"),"Node"),"DivideWithRound")},3),$(A,"$_reduce_11",function(j,ve,de){return d(d(P("Arithmetic"),"Node"),"DivideWithFloor")},3),$(A,"$_reduce_12",function(j,ve,de){return j["$[]"](1)},3),$(A,"$_reduce_13",function(j,ve,de){return d(d(P("Arithmetic"),"Node"),"Negative").$new(j["$[]"](1))},3),$(A,"$_reduce_15",function(j,ve,de){return j["$[]"](1)},3),$(A,"$_reduce_16",function(j,ve,de){return d(d(P("Arithmetic"),"Node"),"Number").$new(j["$[]"](0))},3),$(A,"$_reduce_none",function(j,ve,de){return j["$[]"](0)},3)},Opal.modules["bcdice/arithmetic"]=function(a){var $,L,se,ee,Y,V,H,oe,y=a.top,w=[],p=a.nil,d=a.module,M=a.send,v=a.def;return y.$require("bcdice/arithmetic/node"),y.$require("bcdice/arithmetic/parser"),$=w,L=oe=[d(w[0],"BCDice")].concat($),H=[V=d(oe[0],"Arithmetic")].concat(L),ee=[se=a.get_singleton_class(V)].concat(H),Y=a.$r(ee),v(se,"$eval",function(k,q){var z;try{return(z=Y("Parser").$parse(k))===p||null==z?p:M(z,"eval",[q])}catch(N){if(!a.rescue(N,[Y("ZeroDivisionError")]))throw N;try{return p}finally{a.pop_exception()}}},2)},Opal.queue(function(a){var L,ee,Y,ne,k,q,H,w=[],p=a.nil,d=a.module,M=a.klass,v=a.defs,D=a.def,$=a.send,F=a.truthy,oe=a.eqeq;return a.top.$require("bcdice/arithmetic"),L=w,ee=H=[d(w[0],"BCDice")].concat(L),ne=[Y=M(H[0],null,"Preprocessor")].concat(ee),k=a.$r(ne),(q=Y.$$prototype).game_system=q.text=p,v(Y,"$process",function(A,N){return k("Preprocessor").$new(A,N).$process()},2),D(Y,"$initialize",function(A,N){return this.text=A,this.game_system=N},2),D(Y,"$process",function(){var A=this;return A.$trim_after_whitespace(),A.$replace_parentheses(),A.text=A.game_system.$change_text(A.text),A.$replace_implicit_d(),A.text},0),Y.$private(),D(Y,"$trim_after_whitespace",function(){return this.text=this.text.$strip().$split(/\s/,2).$first()},0),D(Y,"$replace_parentheses",function(){var A=this;return function(){var N=a.new_brk();try{return $(A,"loop",[],function P(){var b,g=null==P.$$s?this:P.$$s;if(null==g.text&&(g.text=p),b=g.text,g.text=$(g.text,"gsub",[/\([\d\/+*\-CURF]+\)/],function C(h){var l,u=null==C.$$s?this:C.$$s;return null==u.game_system&&(u.game_system=p),null==h&&(h=p),F(l=k("Arithmetic").$eval(h,u.game_system.$round_type()))?l:h},{$$arity:1,$$s:g}),!oe(b,g.text))return p;a.brk(p,N)},{$$arity:0,$$s:A,$$brk:N})}catch(P){if(P===N)return P.$v;throw P}}()},0),D(Y,"$replace_implicit_d",function(){var A=this;return A.text=$(A.text,"gsub",[/(\d+)D([^\w]|$)/i],function N(){var P=null==N.$$s?this:N.$$s;return null==P.game_system&&(P.game_system=p),k("Regexp").$last_match(1)+"D"+P.game_system.$sides_implicit_d()+k("Regexp").$last_match(2)},{$$arity:0,$$s:A})},0)})},6956:(E,ae,X)=>{X(9993),Opal.queue(function(a){var v,y=[];return v=y,(0,a.const_set)([(0,a.module)(y[0],"BCDice")].concat(v)[0],"VERSION","3.7.0")})},3583:function(E,ae,X){"use strict";var a=this&&this.__importDefault||function(p){return p&&p.__esModule?p:{default:p}};Object.defineProperty(ae,"__esModule",{value:!0}),ae.Opal=ae.I18n=ae.BCDice=void 0,X(6956);var y=a(X(8459));ae.BCDice=y.default.module(null,"BCDice"),ae.I18n=y.default.module(null,"I18n");var w=X(8459);Object.defineProperty(ae,"Opal",{enumerable:!0,get:function(){return a(w).default}})},8459:(E,ae,X)=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0}),ae.nilToNull=void 0,X(9993),Opal.config.unsupported_features_severity="ignore",ae.default=Opal,ae.nilToNull=function a(y){return y===Opal.nil?null:y}},3604:function(E,ae,X){"use strict";var G,a=this&&this.__extends||(G=function(L,V){return(G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(H,se){H.__proto__=se}||function(H,se){for(var ue in se)Object.prototype.hasOwnProperty.call(se,ue)&&(H[ue]=se[ue])})(L,V)},function(L,V){function H(){this.constructor=L}G(L,V),L.prototype=null===V?Object.create(V):(H.prototype=V.prototype,new H)}),y=this&&this.__awaiter||function(G,L,V,H){return new(V||(V=Promise))(function(ue,ee){function Y(q){try{k(H.next(q))}catch(z){ee(z)}}function ne(q){try{k(H.throw(q))}catch(z){ee(z)}}function k(q){q.done?ue(q.value):function se(ue){return ue instanceof V?ue:new V(function(ee){ee(ue)})}(q.value).then(Y,ne)}k((H=H.apply(G,L||[])).next())})},w=this&&this.__generator||function(G,L){var H,se,ue,ee,V={label:0,sent:function(){if(1&ue[0])throw ue[1];return ue[1]},trys:[],ops:[]};return ee={next:Y(0),throw:Y(1),return:Y(2)},"function"==typeof Symbol&&(ee[Symbol.iterator]=function(){return this}),ee;function Y(k){return function(q){return function ne(k){if(H)throw new TypeError("Generator is already executing.");for(;V;)try{if(H=1,se&&(ue=2&k[0]?se.return:k[0]?se.throw||((ue=se.return)&&ue.call(se),0):se.next)&&!(ue=ue.call(se,k[1])).done)return ue;switch(se=0,ue&&(k=[2&k[0],ue.value]),k[0]){case 0:case 1:ue=k;break;case 4:return V.label++,{value:k[1],done:!1};case 5:V.label++,se=k[1],k=[0];continue;case 7:k=V.ops.pop(),V.trys.pop();continue;default:if(!(ue=(ue=V.trys).length>0&&ue[ue.length-1])&&(6===k[0]||2===k[0])){V=0;continue}if(3===k[0]&&(!ue||k[1]>ue[0]&&k[1]<ue[3])){V.label=k[1];break}if(6===k[0]&&V.label<ue[1]){V.label=ue[1],ue=k;break}if(ue&&V.label<ue[2]){V.label=ue[2],V.ops.push(k);break}ue[2]&&V.ops.pop(),V.trys.pop();continue}k=L.call(G,V)}catch(q){k=[6,q],se=0}finally{H=ue=0}if(5&k[0])throw k[1];return{value:k[0]?k[1]:void 0,done:!0}}([k,q])}}},p=this&&this.__importDefault||function(G){return G&&G.__esModule?G:{default:G}};Object.defineProperty(ae,"__esModule",{value:!0}),ae.getGameSystemClass=void 0;var d=p(X(5904)),M=X(3583),v=X(3693),D=p(X(4682)),$=p(X(3034));function F(G){var L;return(L=function(V){function H(se,ue){return V.call(this,se,null!=ue?ue:G.$new(se))||this}return a(H,V),H.eval=function(se){return v.parseResult(G.$eval(se))},H}(d.default)).ID=G.$const_get("ID"),L.NAME=G.$const_get("NAME"),L.SORT_KEY=G.$const_get("SORT_KEY"),L.HELP_MESSAGE=G.$const_get("HELP_MESSAGE"),L.COMMAND_PATTERN=G.$command_pattern(),L}ae.getGameSystemClass=F;var oe=function(){function G(){}return G.prototype.getGameSystemIdByName=function(L){var V,H=null===(V=this.listAvailableGameSystems().find(function(se){return se.name===L}))||void 0===V?void 0:V.id;if(!H)throw new Error("GameSystem named "+L+" does not exists");return H},G.prototype.getGameSystemInfo=function(L){var V=this.listAvailableGameSystems().find(function(H){return H.id===L});if(!V)throw new Error("GameSystem is not found");return V},G.prototype.getGameSystemClass=function(L){var V=this.listLoadedGameSystems().find(function(H){return H.ID===L});if(!V)throw new Error("GameSystem "+L+" is not loaded");return V},G.prototype.getI18nInfos=function(L){var V=L.replace(/_[^0-9].*$/g,""),H=this.listAvailabletI18nInfoList().find(function(ee){return ee.baseClassName===V||ee.baseClassName===L}),se=H?[H]:[],ue=this.listAvailableGameSystems().find(function(ee){return ee.className===L});return ue?Array.from(new Set(this.getI18nInfos(ue.superClassName).concat(se))):se},G.prototype.listLoadedGameSystems=function(){var L,V,H;return null!==(H=null===(V=null===(L=M.BCDice.GameSystem)||void 0===L?void 0:L.$constants())||void 0===V?void 0:V.map(function(se){return F(M.BCDice.GameSystem[se])}))&&void 0!==H?H:[]},G.prototype.listAvailableGameSystems=function(){return D.default.gameSystems},G.prototype.listAvailabletI18nInfoList=function(){return $.default.i18nList},G.prototype.dynamicLoad=function(L){var V;return y(this,void 0,void 0,function(){var H,se,ue,ee,Y,ne,k,q,z,N,P,g,b;return w(this,function(C){switch(C.label){case 0:if(H=this.getGameSystemInfo(L),!(se=null!==(V=null==H?void 0:H.className)&&void 0!==V?V:L).match(/^[A-Z]\w*$/))throw new Error("Invalid id");ue=this.getI18nInfos(se),ee=0,Y=ue,C.label=1;case 1:if(!(ee<Y.length))return[3,6];k=(ne=Y[ee]).locales.filter(function(h){return h===H.locale||h===M.I18n.$default_locale()}),q=0,z=k,C.label=2;case 2:return q<z.length?(g=(P=JSON).stringify,[4,this.dynamicImportI18n(ne.baseClassName,z[q])]):[3,5];case 3:N=g.apply(P,[C.sent()]),M.I18n.$load_translation(N),C.label=4;case 4:return q++,[3,2];case 5:return ee++,[3,1];case 6:return[4,this.dynamicImport(se)];case 7:if(C.sent(),!(b=M.BCDice.GameSystem.$const_get(se)))throw new Error("Failed to load game system");return[2,F(b)]}})})},G.prototype.dynamicImportI18n=function(L,V){throw new Error("Not implemented")},G.prototype.dynamicImport=function(L){throw new Error("Not implemented")},G}();ae.default=oe},3693:function(E,ae,X){"use strict";var a=this&&this.__assign||function(){return a=Object.assign||function(d){for(var M,v=1,D=arguments.length;v<D;v++)for(var $ in M=arguments[v])Object.prototype.hasOwnProperty.call(M,$)&&(d[$]=M[$]);return d},a.apply(this,arguments)},y=this&&this.__rest||function(d,M){var v={};for(var D in d)Object.prototype.hasOwnProperty.call(d,D)&&M.indexOf(D)<0&&(v[D]=d[D]);if(null!=d&&"function"==typeof Object.getOwnPropertySymbols){var $=0;for(D=Object.getOwnPropertySymbols(d);$<D.length;$++)M.indexOf(D[$])<0&&Object.prototype.propertyIsEnumerable.call(d,D[$])&&(v[D[$]]=d[D[$]])}return v};Object.defineProperty(ae,"__esModule",{value:!0}),ae.parseResult=void 0;var w=X(3583);ae.parseResult=function p(d){if(d===w.Opal.nil)return null;var M=d.detailed_rands,v=y(d,["detailed_rands"]);return a(a({},v),{detailedRands:M.map(function(D){return D.$to_n()})})}},7585:function(E,ae,X){var a;E.exports=(a=a||function(y,w){var p;if("undefined"!=typeof window&&window.crypto&&(p=window.crypto),"undefined"!=typeof self&&self.crypto&&(p=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(p=globalThis.crypto),!p&&"undefined"!=typeof window&&window.msCrypto&&(p=window.msCrypto),!p&&"undefined"!=typeof global&&global.crypto&&(p=global.crypto),!p)try{p=X(2480)}catch(ee){}var d=function(){if(p){if("function"==typeof p.getRandomValues)try{return p.getRandomValues(new Uint32Array(1))[0]}catch(ee){}if("function"==typeof p.randomBytes)try{return p.randomBytes(4).readInt32LE()}catch(ee){}}throw new Error("Native crypto module could not be used to get secure random number.")},M=Object.create||function(){function ee(){}return function(Y){var ne;return ee.prototype=Y,ne=new ee,ee.prototype=null,ne}}(),v={},D=v.lib={},$=D.Base={extend:function(ee){var Y=M(this);return ee&&Y.mixIn(ee),(!Y.hasOwnProperty("init")||this.init===Y.init)&&(Y.init=function(){Y.$super.init.apply(this,arguments)}),Y.init.prototype=Y,Y.$super=this,Y},create:function(){var ee=this.extend();return ee.init.apply(ee,arguments),ee},init:function(){},mixIn:function(ee){for(var Y in ee)ee.hasOwnProperty(Y)&&(this[Y]=ee[Y]);ee.hasOwnProperty("toString")&&(this.toString=ee.toString)},clone:function(){return this.init.prototype.extend(this)}},F=D.WordArray=$.extend({init:function(ee,Y){ee=this.words=ee||[],this.sigBytes=null!=Y?Y:4*ee.length},toString:function(ee){return(ee||G).stringify(this)},concat:function(ee){var Y=this.words,ne=ee.words,k=this.sigBytes,q=ee.sigBytes;if(this.clamp(),k%4)for(var z=0;z<q;z++)Y[k+z>>>2]|=(ne[z>>>2]>>>24-z%4*8&255)<<24-(k+z)%4*8;else for(var N=0;N<q;N+=4)Y[k+N>>>2]=ne[N>>>2];return this.sigBytes+=q,this},clamp:function(){var ee=this.words,Y=this.sigBytes;ee[Y>>>2]&=4294967295<<32-Y%4*8,ee.length=y.ceil(Y/4)},clone:function(){var ee=$.clone.call(this);return ee.words=this.words.slice(0),ee},random:function(ee){for(var Y=[],ne=0;ne<ee;ne+=4)Y.push(d());return new F.init(Y,ee)}}),oe=v.enc={},G=oe.Hex={stringify:function(ee){for(var Y=ee.words,ne=ee.sigBytes,k=[],q=0;q<ne;q++){var z=Y[q>>>2]>>>24-q%4*8&255;k.push((z>>>4).toString(16)),k.push((15&z).toString(16))}return k.join("")},parse:function(ee){for(var Y=ee.length,ne=[],k=0;k<Y;k+=2)ne[k>>>3]|=parseInt(ee.substr(k,2),16)<<24-k%8*4;return new F.init(ne,Y/2)}},L=oe.Latin1={stringify:function(ee){for(var Y=ee.words,ne=ee.sigBytes,k=[],q=0;q<ne;q++)k.push(String.fromCharCode(Y[q>>>2]>>>24-q%4*8&255));return k.join("")},parse:function(ee){for(var Y=ee.length,ne=[],k=0;k<Y;k++)ne[k>>>2]|=(255&ee.charCodeAt(k))<<24-k%4*8;return new F.init(ne,Y)}},V=oe.Utf8={stringify:function(ee){try{return decodeURIComponent(escape(L.stringify(ee)))}catch(Y){throw new Error("Malformed UTF-8 data")}},parse:function(ee){return L.parse(unescape(encodeURIComponent(ee)))}},H=D.BufferedBlockAlgorithm=$.extend({reset:function(){this._data=new F.init,this._nDataBytes=0},_append:function(ee){"string"==typeof ee&&(ee=V.parse(ee)),this._data.concat(ee),this._nDataBytes+=ee.sigBytes},_process:function(ee){var Y,ne=this._data,k=ne.words,q=ne.sigBytes,z=this.blockSize,N=q/(4*z),P=(N=ee?y.ceil(N):y.max((0|N)-this._minBufferSize,0))*z,g=y.min(4*P,q);if(P){for(var b=0;b<P;b+=z)this._doProcessBlock(k,b);Y=k.splice(0,P),ne.sigBytes-=g}return new F.init(Y,g)},clone:function(){var ee=$.clone.call(this);return ee._data=this._data.clone(),ee},_minBufferSize:0}),ue=(D.Hasher=H.extend({cfg:$.extend(),init:function(ee){this.cfg=this.cfg.extend(ee),this.reset()},reset:function(){H.reset.call(this),this._doReset()},update:function(ee){return this._append(ee),this._process(),this},finalize:function(ee){return ee&&this._append(ee),this._doFinalize()},blockSize:16,_createHelper:function(ee){return function(Y,ne){return new ee.init(ne).finalize(Y)}},_createHmacHelper:function(ee){return function(Y,ne){return new ue.HMAC.init(ee,ne).finalize(Y)}}}),v.algo={});return v}(Math),a)},7412:function(E,ae,X){var a;E.exports=(a=X(7585),function(){if("function"==typeof ArrayBuffer){var p=a.lib.WordArray,d=p.init,M=p.init=function(v){if(v instanceof ArrayBuffer&&(v=new Uint8Array(v)),(v instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&v instanceof Uint8ClampedArray||v instanceof Int16Array||v instanceof Uint16Array||v instanceof Int32Array||v instanceof Uint32Array||v instanceof Float32Array||v instanceof Float64Array)&&(v=new Uint8Array(v.buffer,v.byteOffset,v.byteLength)),v instanceof Uint8Array){for(var D=v.byteLength,$=[],F=0;F<D;F++)$[F>>>2]|=v[F]<<24-F%4*8;d.call(this,$,D)}else d.apply(this,arguments)};M.prototype=p}}(),a.lib.WordArray)},1817:function(E,ae,X){var a;E.exports=(a=X(7585),function(y){var w=a,p=w.lib,d=p.WordArray,M=p.Hasher,v=w.algo,D=[],$=[];!function(){function G(se){for(var ue=y.sqrt(se),ee=2;ee<=ue;ee++)if(!(se%ee))return!1;return!0}function L(se){return 4294967296*(se-(0|se))|0}for(var V=2,H=0;H<64;)G(V)&&(H<8&&(D[H]=L(y.pow(V,.5))),$[H]=L(y.pow(V,1/3)),H++),V++}();var F=[],oe=v.SHA256=M.extend({_doReset:function(){this._hash=new d.init(D.slice(0))},_doProcessBlock:function(G,L){for(var V=this._hash.words,H=V[0],se=V[1],ue=V[2],ee=V[3],Y=V[4],ne=V[5],k=V[6],q=V[7],z=0;z<64;z++){if(z<16)F[z]=0|G[L+z];else{var A=F[z-15],P=F[z-2];F[z]=((A<<25|A>>>7)^(A<<14|A>>>18)^A>>>3)+F[z-7]+((P<<15|P>>>17)^(P<<13|P>>>19)^P>>>10)+F[z-16]}var C=H&se^H&ue^se&ue,l=q+((Y<<26|Y>>>6)^(Y<<21|Y>>>11)^(Y<<7|Y>>>25))+(Y&ne^~Y&k)+$[z]+F[z];q=k,k=ne,ne=Y,Y=ee+l|0,ee=ue,ue=se,se=H,H=l+(((H<<30|H>>>2)^(H<<19|H>>>13)^(H<<10|H>>>22))+C)|0}V[0]=V[0]+H|0,V[1]=V[1]+se|0,V[2]=V[2]+ue|0,V[3]=V[3]+ee|0,V[4]=V[4]+Y|0,V[5]=V[5]+ne|0,V[6]=V[6]+k|0,V[7]=V[7]+q|0},_doFinalize:function(){var G=this._data,L=G.words,V=8*this._nDataBytes,H=8*G.sigBytes;return L[H>>>5]|=128<<24-H%32,L[14+(H+64>>>9<<4)]=y.floor(V/4294967296),L[15+(H+64>>>9<<4)]=V,G.sigBytes=4*L.length,this._process(),this._hash},clone:function(){var G=M.clone.call(this);return G._hash=this._hash.clone(),G}});w.SHA256=M._createHelper(oe),w.HmacSHA256=M._createHmacHelper(oe)}(Math),a.SHA256)},6654:E=>{!function(X){E.exports=X;var a="listeners",y={on:function p($,F){return D(this,$).push(F),this},once:function d($,F){var oe=this;return G.originalListener=F,D(oe,$).push(G),oe;function G(){M.call(oe,$,G),F.apply(this,arguments)}},off:M,emit:function v($,F){var oe=this,G=D(oe,$,!0);if(!G)return!1;var L=arguments.length;if(1===L)G.forEach(H);else if(2===L)G.forEach(se);else{var V=Array.prototype.slice.call(arguments,1);G.forEach(ue)}return!!G.length;function H(ee){ee.call(oe)}function se(ee){ee.call(oe,F)}function ue(ee){ee.apply(oe,V)}}};function w($){for(var F in y)$[F]=y[F];return $}function M($,F){var G,oe=this;if(arguments.length){if(F){if(G=D(oe,$,!0)){if(!(G=G.filter(L)).length)return M.call(oe,$);oe[a][$]=G}}else if((G=oe[a])&&(delete G[$],!Object.keys(G).length))return M.call(oe)}else delete oe[a];return oe;function L(V){return V!==F&&V.originalListener!==F}}function D($,F,oe){if(!oe||$[a]){var G=$[a]||($[a]={});return G[F]||(G[F]=[])}}w(X.prototype),X.mixin=w}(function ae(){if(!(this instanceof ae))return new ae})},9069:E=>{"use strict";var a,ae="object"==typeof Reflect?Reflect:null,X=ae&&"function"==typeof ae.apply?ae.apply:function(ne,k,q){return Function.prototype.apply.call(ne,k,q)};a=ae&&"function"==typeof ae.ownKeys?ae.ownKeys:Object.getOwnPropertySymbols?function(ne){return Object.getOwnPropertyNames(ne).concat(Object.getOwnPropertySymbols(ne))}:function(ne){return Object.getOwnPropertyNames(ne)};var w=Number.isNaN||function(ne){return ne!=ne};function p(){p.init.call(this)}E.exports=p,E.exports.once=function se(Y,ne){return new Promise(function(k,q){function z(N){Y.removeListener(ne,A),q(N)}function A(){"function"==typeof Y.removeListener&&Y.removeListener("error",z),k([].slice.call(arguments))}ee(Y,ne,A,{once:!0}),"error"!==ne&&function ue(Y,ne,k){"function"==typeof Y.on&&ee(Y,"error",ne,k)}(Y,z,{once:!0})})},p.EventEmitter=p,p.prototype._events=void 0,p.prototype._eventsCount=0,p.prototype._maxListeners=void 0;var d=10;function M(Y){if("function"!=typeof Y)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof Y)}function v(Y){return void 0===Y._maxListeners?p.defaultMaxListeners:Y._maxListeners}function D(Y,ne,k,q){var z,A,N;if(M(k),void 0===(A=Y._events)?(A=Y._events=Object.create(null),Y._eventsCount=0):(void 0!==A.newListener&&(Y.emit("newListener",ne,k.listener?k.listener:k),A=Y._events),N=A[ne]),void 0===N)N=A[ne]=k,++Y._eventsCount;else if("function"==typeof N?N=A[ne]=q?[k,N]:[N,k]:q?N.unshift(k):N.push(k),(z=v(Y))>0&&N.length>z&&!N.warned){N.warned=!0;var P=new Error("Possible EventEmitter memory leak detected. "+N.length+" "+String(ne)+" listeners added. Use emitter.setMaxListeners() to increase limit");P.name="MaxListenersExceededWarning",P.emitter=Y,P.type=ne,P.count=N.length,function y(Y){console&&console.warn&&console.warn(Y)}(P)}return Y}function $(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function F(Y,ne,k){var q={fired:!1,wrapFn:void 0,target:Y,type:ne,listener:k},z=$.bind(q);return z.listener=k,q.wrapFn=z,z}function oe(Y,ne,k){var q=Y._events;if(void 0===q)return[];var z=q[ne];return void 0===z?[]:"function"==typeof z?k?[z.listener||z]:[z]:k?function H(Y){for(var ne=new Array(Y.length),k=0;k<ne.length;++k)ne[k]=Y[k].listener||Y[k];return ne}(z):L(z,z.length)}function G(Y){var ne=this._events;if(void 0!==ne){var k=ne[Y];if("function"==typeof k)return 1;if(void 0!==k)return k.length}return 0}function L(Y,ne){for(var k=new Array(ne),q=0;q<ne;++q)k[q]=Y[q];return k}function ee(Y,ne,k,q){if("function"==typeof Y.on)q.once?Y.once(ne,k):Y.on(ne,k);else{if("function"!=typeof Y.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof Y);Y.addEventListener(ne,function z(A){q.once&&Y.removeEventListener(ne,z),k(A)})}}Object.defineProperty(p,"defaultMaxListeners",{enumerable:!0,get:function(){return d},set:function(Y){if("number"!=typeof Y||Y<0||w(Y))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+Y+".");d=Y}}),p.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},p.prototype.setMaxListeners=function(ne){if("number"!=typeof ne||ne<0||w(ne))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+ne+".");return this._maxListeners=ne,this},p.prototype.getMaxListeners=function(){return v(this)},p.prototype.emit=function(ne){for(var k=[],q=1;q<arguments.length;q++)k.push(arguments[q]);var z="error"===ne,A=this._events;if(void 0!==A)z=z&&void 0===A.error;else if(!z)return!1;if(z){var N;if(k.length>0&&(N=k[0]),N instanceof Error)throw N;var P=new Error("Unhandled error."+(N?" ("+N.message+")":""));throw P.context=N,P}var g=A[ne];if(void 0===g)return!1;if("function"==typeof g)X(g,this,k);else{var b=g.length,C=L(g,b);for(q=0;q<b;++q)X(C[q],this,k)}return!0},p.prototype.on=p.prototype.addListener=function(ne,k){return D(this,ne,k,!1)},p.prototype.prependListener=function(ne,k){return D(this,ne,k,!0)},p.prototype.once=function(ne,k){return M(k),this.on(ne,F(this,ne,k)),this},p.prototype.prependOnceListener=function(ne,k){return M(k),this.prependListener(ne,F(this,ne,k)),this},p.prototype.off=p.prototype.removeListener=function(ne,k){var q,z,A,N,P;if(M(k),void 0===(z=this._events))return this;if(void 0===(q=z[ne]))return this;if(q===k||q.listener===k)0==--this._eventsCount?this._events=Object.create(null):(delete z[ne],z.removeListener&&this.emit("removeListener",ne,q.listener||k));else if("function"!=typeof q){for(A=-1,N=q.length-1;N>=0;N--)if(q[N]===k||q[N].listener===k){P=q[N].listener,A=N;break}if(A<0)return this;0===A?q.shift():function V(Y,ne){for(;ne+1<Y.length;ne++)Y[ne]=Y[ne+1];Y.pop()}(q,A),1===q.length&&(z[ne]=q[0]),void 0!==z.removeListener&&this.emit("removeListener",ne,P||k)}return this},p.prototype.removeAllListeners=function(ne){var k,q,z;if(void 0===(q=this._events))return this;if(void 0===q.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==q[ne]&&(0==--this._eventsCount?this._events=Object.create(null):delete q[ne]),this;if(0===arguments.length){var N,A=Object.keys(q);for(z=0;z<A.length;++z)"removeListener"!==(N=A[z])&&this.removeAllListeners(N);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(k=q[ne]))this.removeListener(ne,k);else if(void 0!==k)for(z=k.length-1;z>=0;z--)this.removeListener(ne,k[z]);return this},p.prototype.listeners=function(ne){return oe(this,ne,!0)},p.prototype.rawListeners=function(ne){return oe(this,ne,!1)},p.listenerCount=function(Y,ne){return"function"==typeof Y.listenerCount?Y.listenerCount(ne):G.call(Y,ne)},p.prototype.listenerCount=G,p.prototype.eventNames=function(){return this._eventsCount>0?a(this._events):[]}},4327:function(E,ae){var y;void 0!==(y=function(){"use strict";function p(F,oe,G){var L=new XMLHttpRequest;L.open("GET",F),L.responseType="blob",L.onload=function(){$(L.response,oe,G)},L.onerror=function(){console.error("could not download file")},L.send()}function d(F){var oe=new XMLHttpRequest;oe.open("HEAD",F,!1);try{oe.send()}catch(G){}return 200<=oe.status&&299>=oe.status}function M(F){try{F.dispatchEvent(new MouseEvent("click"))}catch(G){var oe=document.createEvent("MouseEvents");oe.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),F.dispatchEvent(oe)}}var v="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,D=v.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),$=v.saveAs||("object"!=typeof window||window!==v?function(){}:"download"in HTMLAnchorElement.prototype&&!D?function(F,oe,G){var L=v.URL||v.webkitURL,V=document.createElement("a");V.download=oe=oe||F.name||"download",V.rel="noopener","string"==typeof F?(V.href=F,V.origin===location.origin?M(V):d(V.href)?p(F,oe,G):M(V,V.target="_blank")):(V.href=L.createObjectURL(F),setTimeout(function(){L.revokeObjectURL(V.href)},4e4),setTimeout(function(){M(V)},0))}:"msSaveOrOpenBlob"in navigator?function(F,oe,G){if(oe=oe||F.name||"download","string"!=typeof F)navigator.msSaveOrOpenBlob(function w(F,oe){return void 0===oe?oe={autoBom:!1}:"object"!=typeof oe&&(console.warn("Deprecated: Expected third argument to be a object"),oe={autoBom:!oe}),oe.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(F.type)?new Blob(["\ufeff",F],{type:F.type}):F}(F,G),oe);else if(d(F))p(F,oe,G);else{var L=document.createElement("a");L.href=F,L.target="_blank",setTimeout(function(){M(L)})}}:function(F,oe,G,L){if((L=L||open("","_blank"))&&(L.document.title=L.document.body.innerText="downloading..."),"string"==typeof F)return p(F,oe,G);var V="application/octet-stream"===F.type,H=/constructor/i.test(v.HTMLElement)||v.safari,se=/CriOS\/[\d]+/.test(navigator.userAgent);if((se||V&&H||D)&&"undefined"!=typeof FileReader){var ue=new FileReader;ue.onloadend=function(){var ne=ue.result;ne=se?ne:ne.replace(/^data:[^;]*;/,"data:attachment/file;"),L?L.location.href=ne:location=ne,L=null},ue.readAsDataURL(F)}else{var ee=v.URL||v.webkitURL,Y=ee.createObjectURL(F);L?L.location=Y:location.href=Y,L=null,setTimeout(function(){ee.revokeObjectURL(Y)},4e4)}});v.saveAs=$.saveAs=$,E.exports=$}.apply(ae,[]))&&(E.exports=y)},5386:(E,ae,X)=>{var a;!function(y,w,p,d){"use strict";var se,M=["","webkit","Moz","MS","ms","o"],v=w.createElement("div"),$=Math.round,F=Math.abs,oe=Date.now;function G(Se,Re,He){return setTimeout(ne(Se,He),Re)}function L(Se,Re,He){return!!Array.isArray(Se)&&(V(Se,He[Re],He),!0)}function V(Se,Re,He){var Qe;if(Se)if(Se.forEach)Se.forEach(Re,He);else if(Se.length!==d)for(Qe=0;Qe<Se.length;)Re.call(He,Se[Qe],Qe,Se),Qe++;else for(Qe in Se)Se.hasOwnProperty(Qe)&&Re.call(He,Se[Qe],Qe,Se)}function H(Se,Re,He){var Qe="DEPRECATED METHOD: "+Re+"\n"+He+" AT \n";return function(){var vt=new Error("get-stack-trace"),Dt=vt&&vt.stack?vt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",En=y.console&&(y.console.warn||y.console.log);return En&&En.call(y.console,Qe,Dt),Se.apply(this,arguments)}}se="function"!=typeof Object.assign?function(Re){if(Re===d||null===Re)throw new TypeError("Cannot convert undefined or null to object");for(var He=Object(Re),Qe=1;Qe<arguments.length;Qe++){var vt=arguments[Qe];if(vt!==d&&null!==vt)for(var Dt in vt)vt.hasOwnProperty(Dt)&&(He[Dt]=vt[Dt])}return He}:Object.assign;var ue=H(function(Re,He,Qe){for(var vt=Object.keys(He),Dt=0;Dt<vt.length;)(!Qe||Qe&&Re[vt[Dt]]===d)&&(Re[vt[Dt]]=He[vt[Dt]]),Dt++;return Re},"extend","Use `assign`."),ee=H(function(Re,He){return ue(Re,He,!0)},"merge","Use `assign`.");function Y(Se,Re,He){var vt,Qe=Re.prototype;(vt=Se.prototype=Object.create(Qe)).constructor=Se,vt._super=Qe,He&&se(vt,He)}function ne(Se,Re){return function(){return Se.apply(Re,arguments)}}function k(Se,Re){return"function"==typeof Se?Se.apply(Re&&Re[0]||d,Re):Se}function q(Se,Re){return Se===d?Re:Se}function z(Se,Re,He){V(g(Re),function(Qe){Se.addEventListener(Qe,He,!1)})}function A(Se,Re,He){V(g(Re),function(Qe){Se.removeEventListener(Qe,He,!1)})}function N(Se,Re){for(;Se;){if(Se==Re)return!0;Se=Se.parentNode}return!1}function P(Se,Re){return Se.indexOf(Re)>-1}function g(Se){return Se.trim().split(/\s+/g)}function b(Se,Re,He){if(Se.indexOf&&!He)return Se.indexOf(Re);for(var Qe=0;Qe<Se.length;){if(He&&Se[Qe][He]==Re||!He&&Se[Qe]===Re)return Qe;Qe++}return-1}function C(Se){return Array.prototype.slice.call(Se,0)}function h(Se,Re,He){for(var Qe=[],vt=[],Dt=0;Dt<Se.length;){var En=Re?Se[Dt][Re]:Se[Dt];b(vt,En)<0&&Qe.push(Se[Dt]),vt[Dt]=En,Dt++}return He&&(Qe=Re?Qe.sort(function(Ui,gr){return Ui[Re]>gr[Re]}):Qe.sort()),Qe}function u(Se,Re){for(var He,Qe,vt=Re[0].toUpperCase()+Re.slice(1),Dt=0;Dt<M.length;){if((Qe=(He=M[Dt])?He+vt:Re)in Se)return Qe;Dt++}return d}var l=1;function _(Se){var Re=Se.ownerDocument||Se;return Re.defaultView||Re.parentWindow||y}var S="ontouchstart"in y,Q=u(y,"PointerEvent")!==d,le=S&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),Ce="touch",O="mouse",Ie=["x","y"],Pe=["clientX","clientY"];function Ae(Se,Re){var He=this;this.manager=Se,this.callback=Re,this.element=Se.element,this.target=Se.options.inputTarget,this.domHandler=function(Qe){k(Se.options.enable,[Se])&&He.handler(Qe)},this.init()}function We(Se,Re,He){var Qe=He.pointers.length,vt=He.changedPointers.length,Dt=1&Re&&Qe-vt==0,En=12&Re&&Qe-vt==0;He.isFirst=!!Dt,He.isFinal=!!En,Dt&&(Se.session={}),He.eventType=Re,function nt(Se,Re){var He=Se.session,Qe=Re.pointers,vt=Qe.length;He.firstInput||(He.firstInput=Ot(Re)),vt>1&&!He.firstMultiple?He.firstMultiple=Ot(Re):1===vt&&(He.firstMultiple=!1);var Dt=He.firstInput,En=He.firstMultiple,Hi=En?En.center:Dt.center,Ui=Re.center=mt(Qe);Re.timeStamp=oe(),Re.deltaTime=Re.timeStamp-Dt.timeStamp,Re.angle=Vr(Hi,Ui),Re.distance=Vo(Hi,Ui),function Nt(Se,Re){var He=Re.center,Qe=Se.offsetDelta||{},vt=Se.prevDelta||{},Dt=Se.prevInput||{};(1===Re.eventType||4===Dt.eventType)&&(vt=Se.prevDelta={x:Dt.deltaX||0,y:Dt.deltaY||0},Qe=Se.offsetDelta={x:He.x,y:He.y}),Re.deltaX=vt.x+(He.x-Qe.x),Re.deltaY=vt.y+(He.y-Qe.y)}(He,Re),Re.offsetDirection=cr(Re.deltaX,Re.deltaY);var gr=$t(Re.deltaTime,Re.deltaX,Re.deltaY);Re.overallVelocityX=gr.x,Re.overallVelocityY=gr.y,Re.overallVelocity=F(gr.x)>F(gr.y)?gr.x:gr.y,Re.scale=En?function mf(Se,Re){return Vo(Re[0],Re[1],Pe)/Vo(Se[0],Se[1],Pe)}(En.pointers,Qe):1,Re.rotation=En?function Tu(Se,Re){return Vr(Re[1],Re[0],Pe)+Vr(Se[1],Se[0],Pe)}(En.pointers,Qe):0,Re.maxPointers=He.prevInput?Re.pointers.length>He.prevInput.maxPointers?Re.pointers.length:He.prevInput.maxPointers:Re.pointers.length,function jt(Se,Re){var vt,Dt,En,Hi,He=Se.lastInterval||Re,Qe=Re.timeStamp-He.timeStamp;if(8!=Re.eventType&&(Qe>25||He.velocity===d)){var Ui=Re.deltaX-He.deltaX,gr=Re.deltaY-He.deltaY,xs=$t(Qe,Ui,gr);Dt=xs.x,En=xs.y,vt=F(xs.x)>F(xs.y)?xs.x:xs.y,Hi=cr(Ui,gr),Se.lastInterval=Re}else vt=He.velocity,Dt=He.velocityX,En=He.velocityY,Hi=He.direction;Re.velocity=vt,Re.velocityX=Dt,Re.velocityY=En,Re.direction=Hi}(He,Re);var xs=Se.element;N(Re.srcEvent.target,xs)&&(xs=Re.srcEvent.target),Re.target=xs}(Se,He),Se.emit("hammer.input",He),Se.recognize(He),Se.session.prevInput=He}function Ot(Se){for(var Re=[],He=0;He<Se.pointers.length;)Re[He]={clientX:$(Se.pointers[He].clientX),clientY:$(Se.pointers[He].clientY)},He++;return{timeStamp:oe(),pointers:Re,center:mt(Re),deltaX:Se.deltaX,deltaY:Se.deltaY}}function mt(Se){var Re=Se.length;if(1===Re)return{x:$(Se[0].clientX),y:$(Se[0].clientY)};for(var He=0,Qe=0,vt=0;vt<Re;)He+=Se[vt].clientX,Qe+=Se[vt].clientY,vt++;return{x:$(He/Re),y:$(Qe/Re)}}function $t(Se,Re,He){return{x:Re/Se||0,y:He/Se||0}}function cr(Se,Re){return Se===Re?1:F(Se)>=F(Re)?Se<0?2:4:Re<0?8:16}function Vo(Se,Re,He){He||(He=Ie);var Qe=Re[He[0]]-Se[He[0]],vt=Re[He[1]]-Se[He[1]];return Math.sqrt(Qe*Qe+vt*vt)}function Vr(Se,Re,He){return He||(He=Ie),180*Math.atan2(Re[He[1]]-Se[He[1]],Re[He[0]]-Se[He[0]])/Math.PI}Ae.prototype={handler:function(){},init:function(){this.evEl&&z(this.element,this.evEl,this.domHandler),this.evTarget&&z(this.target,this.evTarget,this.domHandler),this.evWin&&z(_(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&A(this.element,this.evEl,this.domHandler),this.evTarget&&A(this.target,this.evTarget,this.domHandler),this.evWin&&A(_(this.element),this.evWin,this.domHandler)}};var sl={mousedown:1,mousemove:2,mouseup:4},ec="mousedown",ol="mousemove mouseup";function ss(){this.evEl=ec,this.evWin=ol,this.pressed=!1,Ae.apply(this,arguments)}Y(ss,Ae,{handler:function(Re){var He=sl[Re.type];1&He&&0===Re.button&&(this.pressed=!0),2&He&&1!==Re.which&&(He=4),this.pressed&&(4&He&&(this.pressed=!1),this.callback(this.manager,He,{pointers:[Re],changedPointers:[Re],pointerType:O,srcEvent:Re}))}});var Go={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},$g={2:Ce,3:"pen",4:O,5:"kinect"},Iu="pointerdown",Su="pointermove pointerup pointercancel";function tc(){this.evEl=Iu,this.evWin=Su,Ae.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}y.MSPointerEvent&&!y.PointerEvent&&(Iu="MSPointerDown",Su="MSPointerMove MSPointerUp MSPointerCancel"),Y(tc,Ae,{handler:function(Re){var He=this.store,Qe=!1,vt=Re.type.toLowerCase().replace("ms",""),Dt=Go[vt],En=$g[Re.pointerType]||Re.pointerType,Hi=En==Ce,Ui=b(He,Re.pointerId,"pointerId");1&Dt&&(0===Re.button||Hi)?Ui<0&&(He.push(Re),Ui=He.length-1):12&Dt&&(Qe=!0),!(Ui<0)&&(He[Ui]=Re,this.callback(this.manager,Dt,{pointers:He,changedPointers:[Re],pointerType:En,srcEvent:Re}),Qe&&He.splice(Ui,1))}});var _f={touchstart:1,touchmove:2,touchend:4,touchcancel:8},pr="touchstart",vg="touchstart touchmove touchend touchcancel";function $f(){this.evTarget=pr,this.evWin=vg,this.started=!1,Ae.apply(this,arguments)}function bg(Se,Re){var He=C(Se.touches),Qe=C(Se.changedTouches);return 12&Re&&(He=h(He.concat(Qe),"identifier",!0)),[He,Qe]}Y($f,Ae,{handler:function(Re){var He=_f[Re.type];if(1===He&&(this.started=!0),this.started){var Qe=bg.call(this,Re,He);12&He&&Qe[0].length-Qe[1].length==0&&(this.started=!1),this.callback(this.manager,He,{pointers:Qe[0],changedPointers:Qe[1],pointerType:Ce,srcEvent:Re})}}});var yg={touchstart:1,touchmove:2,touchend:4,touchcancel:8},vf="touchstart touchmove touchend touchcancel";function nc(){this.evTarget=vf,this.targetIds={},Ae.apply(this,arguments)}function Cg(Se,Re){var He=C(Se.touches),Qe=this.targetIds;if(3&Re&&1===He.length)return Qe[He[0].identifier]=!0,[He,He];var vt,Dt,En=C(Se.changedTouches),Hi=[],Ui=this.target;if(Dt=He.filter(function(gr){return N(gr.target,Ui)}),1===Re)for(vt=0;vt<Dt.length;)Qe[Dt[vt].identifier]=!0,vt++;for(vt=0;vt<En.length;)Qe[En[vt].identifier]&&Hi.push(En[vt]),12&Re&&delete Qe[En[vt].identifier],vt++;return Hi.length?[h(Dt.concat(Hi),"identifier",!0),Hi]:void 0}function qo(){Ae.apply(this,arguments);var Se=ne(this.handler,this);this.touch=new nc(this.manager,Se),this.mouse=new ss(this.manager,Se),this.primaryTouch=null,this.lastTouches=[]}function yf(Se,Re){1&Se?(this.primaryTouch=Re.changedPointers[0].identifier,ic.call(this,Re)):12&Se&&ic.call(this,Re)}function ic(Se){var Re=Se.changedPointers[0];if(Re.identifier===this.primaryTouch){var He={x:Re.clientX,y:Re.clientY};this.lastTouches.push(He);var Qe=this.lastTouches;setTimeout(function(){var Dt=Qe.indexOf(He);Dt>-1&&Qe.splice(Dt,1)},2500)}}function T1(Se){for(var Re=Se.srcEvent.clientX,He=Se.srcEvent.clientY,Qe=0;Qe<this.lastTouches.length;Qe++){var vt=this.lastTouches[Qe],Dt=Math.abs(Re-vt.x),En=Math.abs(He-vt.y);if(Dt<=25&&En<=25)return!0}return!1}Y(nc,Ae,{handler:function(Re){var He=yg[Re.type],Qe=Cg.call(this,Re,He);!Qe||this.callback(this.manager,He,{pointers:Qe[0],changedPointers:Qe[1],pointerType:Ce,srcEvent:Re})}}),Y(qo,Ae,{handler:function(Re,He,Qe){var Dt=Qe.pointerType==O;if(!(Dt&&Qe.sourceCapabilities&&Qe.sourceCapabilities.firesTouchEvents)){if(Qe.pointerType==Ce)yf.call(this,He,Qe);else if(Dt&&T1.call(this,Qe))return;this.callback(Re,He,Qe)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Cf=u(v.style,"touchAction"),Mu=Cf!==d,rc="compute",Wo="manipulation",Ko="none",ha="pan-x",pa="pan-y",sc=function wg(){if(!Mu)return!1;var Se={},Re=y.CSS&&y.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(He){Se[He]=!Re||y.CSS.supports("touch-action",He)}),Se}();function ku(Se,Re){this.manager=Se,this.set(Re)}function Sn(Se){this.options=se({},this.defaults,Se||{}),this.id=function f(){return l++}(),this.manager=null,this.options.enable=q(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function oc(Se){return 16&Se?"cancel":8&Se?"end":4&Se?"move":2&Se?"start":""}function Un(Se){return 16==Se?"down":8==Se?"up":2==Se?"left":4==Se?"right":""}function ma(Se,Re){var He=Re.manager;return He?He.get(Se):Se}function os(){Sn.apply(this,arguments)}function qn(){os.apply(this,arguments),this.pX=null,this.pY=null}function ln(){os.apply(this,arguments)}function ac(){Sn.apply(this,arguments),this._timer=null,this._input=null}function xf(){os.apply(this,arguments)}function Mt(){os.apply(this,arguments)}function _a(){Sn.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function qt(Se,Re){return(Re=Re||{}).recognizers=q(Re.recognizers,qt.defaults.preset),new Ef(Se,Re)}function Ef(Se,Re){this.options=se({},qt.defaults,Re||{}),this.options.inputTarget=this.options.inputTarget||Se,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Se,this.input=function Ne(Se){return new(Se.options.inputClass||(Q?tc:le?nc:S?qo:ss))(Se,We)}(this),this.touchAction=new ku(this,this.options.touchAction),Eg(this,!0),V(this.options.recognizers,function(He){var Qe=this.add(new He[0](He[1]));He[2]&&Qe.recognizeWith(He[2]),He[3]&&Qe.requireFailure(He[3])},this)}function Eg(Se,Re){var Qe,He=Se.element;He.style&&(V(Se.options.cssProps,function(vt,Dt){Qe=u(He.style,Dt),Re?(Se.oldCssProps[Qe]=He.style[Qe],He.style[Qe]=vt):He.style[Qe]=Se.oldCssProps[Qe]||""}),Re||(Se.oldCssProps={}))}ku.prototype={set:function(Se){Se==rc&&(Se=this.compute()),Mu&&this.manager.element.style&&sc[Se]&&(this.manager.element.style[Cf]=Se),this.actions=Se.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Se=[];return V(this.manager.recognizers,function(Re){k(Re.options.enable,[Re])&&(Se=Se.concat(Re.getTouchAction()))}),function xg(Se){if(P(Se,Ko))return Ko;var Re=P(Se,ha),He=P(Se,pa);return Re&&He?Ko:Re||He?Re?ha:pa:P(Se,Wo)?Wo:"auto"}(Se.join(" "))},preventDefaults:function(Se){var Re=Se.srcEvent,He=Se.offsetDirection;if(!this.manager.session.prevented){var Qe=this.actions,vt=P(Qe,Ko)&&!sc[Ko],Dt=P(Qe,pa)&&!sc[pa],En=P(Qe,ha)&&!sc[ha];if(vt&&1===Se.pointers.length&&Se.distance<2&&Se.deltaTime<250)return;return En&&Dt||!(vt||Dt&&6&He||En&&24&He)?void 0:this.preventSrc(Re)}Re.preventDefault()},preventSrc:function(Se){this.manager.session.prevented=!0,Se.preventDefault()}},Sn.prototype={defaults:{},set:function(Se){return se(this.options,Se),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Se){if(L(Se,"recognizeWith",this))return this;var Re=this.simultaneous;return Re[(Se=ma(Se,this)).id]||(Re[Se.id]=Se,Se.recognizeWith(this)),this},dropRecognizeWith:function(Se){return L(Se,"dropRecognizeWith",this)||(Se=ma(Se,this),delete this.simultaneous[Se.id]),this},requireFailure:function(Se){if(L(Se,"requireFailure",this))return this;var Re=this.requireFail;return-1===b(Re,Se=ma(Se,this))&&(Re.push(Se),Se.requireFailure(this)),this},dropRequireFailure:function(Se){if(L(Se,"dropRequireFailure",this))return this;Se=ma(Se,this);var Re=b(this.requireFail,Se);return Re>-1&&this.requireFail.splice(Re,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Se){return!!this.simultaneous[Se.id]},emit:function(Se){var Re=this,He=this.state;function Qe(vt){Re.manager.emit(vt,Se)}He<8&&Qe(Re.options.event+oc(He)),Qe(Re.options.event),Se.additionalEvent&&Qe(Se.additionalEvent),He>=8&&Qe(Re.options.event+oc(He))},tryEmit:function(Se){if(this.canEmit())return this.emit(Se);this.state=32},canEmit:function(){for(var Se=0;Se<this.requireFail.length;){if(!(33&this.requireFail[Se].state))return!1;Se++}return!0},recognize:function(Se){var Re=se({},Se);if(!k(this.options.enable,[this,Re]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(Re),30&this.state&&this.tryEmit(Re)},process:function(Se){},getTouchAction:function(){},reset:function(){}},Y(os,Sn,{defaults:{pointers:1},attrTest:function(Se){var Re=this.options.pointers;return 0===Re||Se.pointers.length===Re},process:function(Se){var Re=this.state,He=Se.eventType,Qe=6&Re,vt=this.attrTest(Se);return Qe&&(8&He||!vt)?16|Re:Qe||vt?4&He?8|Re:2&Re?4|Re:2:32}}),Y(qn,os,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var Se=this.options.direction,Re=[];return 6&Se&&Re.push(pa),24&Se&&Re.push(ha),Re},directionTest:function(Se){var Re=this.options,He=!0,Qe=Se.distance,vt=Se.direction,Dt=Se.deltaX,En=Se.deltaY;return vt&Re.direction||(6&Re.direction?(vt=0===Dt?1:Dt<0?2:4,He=Dt!=this.pX,Qe=Math.abs(Se.deltaX)):(vt=0===En?1:En<0?8:16,He=En!=this.pY,Qe=Math.abs(Se.deltaY))),Se.direction=vt,He&&Qe>Re.threshold&&vt&Re.direction},attrTest:function(Se){return os.prototype.attrTest.call(this,Se)&&(2&this.state||!(2&this.state)&&this.directionTest(Se))},emit:function(Se){this.pX=Se.deltaX,this.pY=Se.deltaY;var Re=Un(Se.direction);Re&&(Se.additionalEvent=this.options.event+Re),this._super.emit.call(this,Se)}}),Y(ln,os,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ko]},attrTest:function(Se){return this._super.attrTest.call(this,Se)&&(Math.abs(Se.scale-1)>this.options.threshold||2&this.state)},emit:function(Se){1!==Se.scale&&(Se.additionalEvent=this.options.event+(Se.scale<1?"in":"out")),this._super.emit.call(this,Se)}}),Y(ac,Sn,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(Se){var Re=this.options,He=Se.pointers.length===Re.pointers,Qe=Se.distance<Re.threshold,vt=Se.deltaTime>Re.time;if(this._input=Se,!Qe||!He||12&Se.eventType&&!vt)this.reset();else if(1&Se.eventType)this.reset(),this._timer=G(function(){this.state=8,this.tryEmit()},Re.time,this);else if(4&Se.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(Se){8===this.state&&(Se&&4&Se.eventType?this.manager.emit(this.options.event+"up",Se):(this._input.timeStamp=oe(),this.manager.emit(this.options.event,this._input)))}}),Y(xf,os,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ko]},attrTest:function(Se){return this._super.attrTest.call(this,Se)&&(Math.abs(Se.rotation)>this.options.threshold||2&this.state)}}),Y(Mt,os,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return qn.prototype.getTouchAction.call(this)},attrTest:function(Se){var He,Re=this.options.direction;return 30&Re?He=Se.overallVelocity:6&Re?He=Se.overallVelocityX:24&Re&&(He=Se.overallVelocityY),this._super.attrTest.call(this,Se)&&Re&Se.offsetDirection&&Se.distance>this.options.threshold&&Se.maxPointers==this.options.pointers&&F(He)>this.options.velocity&&4&Se.eventType},emit:function(Se){var Re=Un(Se.offsetDirection);Re&&this.manager.emit(this.options.event+Re,Se),this.manager.emit(this.options.event,Se)}}),Y(_a,Sn,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Wo]},process:function(Se){var Re=this.options,He=Se.pointers.length===Re.pointers,Qe=Se.distance<Re.threshold,vt=Se.deltaTime<Re.time;if(this.reset(),1&Se.eventType&&0===this.count)return this.failTimeout();if(Qe&&vt&&He){if(4!=Se.eventType)return this.failTimeout();var Dt=!this.pTime||Se.timeStamp-this.pTime<Re.interval,En=!this.pCenter||Vo(this.pCenter,Se.center)<Re.posThreshold;if(this.pTime=Se.timeStamp,this.pCenter=Se.center,En&&Dt?this.count+=1:this.count=1,this._input=Se,0==this.count%Re.taps)return this.hasRequireFailures()?(this._timer=G(function(){this.state=8,this.tryEmit()},Re.interval,this),2):8}return 32},failTimeout:function(){return this._timer=G(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),qt.VERSION="2.0.7",qt.defaults={domEvents:!1,touchAction:rc,enable:!0,inputTarget:null,inputClass:null,preset:[[xf,{enable:!1}],[ln,{enable:!1},["rotate"]],[Mt,{direction:6}],[qn,{direction:6},["swipe"]],[_a],[_a,{event:"doubletap",taps:2},["tap"]],[ac]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Ef.prototype={set:function(Se){return se(this.options,Se),Se.touchAction&&this.touchAction.update(),Se.inputTarget&&(this.input.destroy(),this.input.target=Se.inputTarget,this.input.init()),this},stop:function(Se){this.session.stopped=Se?2:1},recognize:function(Se){var Re=this.session;if(!Re.stopped){this.touchAction.preventDefaults(Se);var He,Qe=this.recognizers,vt=Re.curRecognizer;(!vt||vt&&8&vt.state)&&(vt=Re.curRecognizer=null);for(var Dt=0;Dt<Qe.length;)He=Qe[Dt],2===Re.stopped||vt&&He!=vt&&!He.canRecognizeWith(vt)?He.reset():He.recognize(Se),!vt&&14&He.state&&(vt=Re.curRecognizer=He),Dt++}},get:function(Se){if(Se instanceof Sn)return Se;for(var Re=this.recognizers,He=0;He<Re.length;He++)if(Re[He].options.event==Se)return Re[He];return null},add:function(Se){if(L(Se,"add",this))return this;var Re=this.get(Se.options.event);return Re&&this.remove(Re),this.recognizers.push(Se),Se.manager=this,this.touchAction.update(),Se},remove:function(Se){if(L(Se,"remove",this))return this;if(Se=this.get(Se)){var Re=this.recognizers,He=b(Re,Se);-1!==He&&(Re.splice(He,1),this.touchAction.update())}return this},on:function(Se,Re){if(Se!==d&&Re!==d){var He=this.handlers;return V(g(Se),function(Qe){He[Qe]=He[Qe]||[],He[Qe].push(Re)}),this}},off:function(Se,Re){if(Se!==d){var He=this.handlers;return V(g(Se),function(Qe){Re?He[Qe]&&He[Qe].splice(b(He[Qe],Re),1):delete He[Qe]}),this}},emit:function(Se,Re){this.options.domEvents&&function lc(Se,Re){var He=w.createEvent("Event");He.initEvent(Se,!0,!0),He.gesture=Re,Re.target.dispatchEvent(He)}(Se,Re);var He=this.handlers[Se]&&this.handlers[Se].slice();if(He&&He.length){Re.type=Se,Re.preventDefault=function(){Re.srcEvent.preventDefault()};for(var Qe=0;Qe<He.length;)He[Qe](Re),Qe++}},destroy:function(){this.element&&Eg(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},se(qt,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Ef,Input:Ae,TouchAction:ku,TouchInput:nc,MouseInput:ss,PointerEventInput:tc,TouchMouseInput:qo,SingleTouchInput:$f,Recognizer:Sn,AttrRecognizer:os,Tap:_a,Pan:qn,Swipe:Mt,Pinch:ln,Rotate:xf,Press:ac,on:z,off:A,each:V,merge:ee,extend:ue,assign:se,inherit:Y,bindFn:ne,prefixed:u}),(void 0!==y?y:"undefined"!=typeof self?self:{}).Hammer=qt,(a=function(){return qt}.call(ae,X,ae,E))!==d&&(E.exports=a)}(window,document)},8461:(E,ae)=>{ae.read=function(X,a,y,w,p){var d,M,v=8*p-w-1,D=(1<<v)-1,$=D>>1,F=-7,oe=y?p-1:0,G=y?-1:1,L=X[a+oe];for(oe+=G,d=L&(1<<-F)-1,L>>=-F,F+=v;F>0;d=256*d+X[a+oe],oe+=G,F-=8);for(M=d&(1<<-F)-1,d>>=-F,F+=w;F>0;M=256*M+X[a+oe],oe+=G,F-=8);if(0===d)d=1-$;else{if(d===D)return M?NaN:1/0*(L?-1:1);M+=Math.pow(2,w),d-=$}return(L?-1:1)*M*Math.pow(2,d-w)},ae.write=function(X,a,y,w,p,d){var M,v,D,$=8*d-p-1,F=(1<<$)-1,oe=F>>1,G=23===p?Math.pow(2,-24)-Math.pow(2,-77):0,L=w?0:d-1,V=w?1:-1,H=a<0||0===a&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(v=isNaN(a)?1:0,M=F):(M=Math.floor(Math.log(a)/Math.LN2),a*(D=Math.pow(2,-M))<1&&(M--,D*=2),(a+=M+oe>=1?G/D:G*Math.pow(2,1-oe))*D>=2&&(M++,D/=2),M+oe>=F?(v=0,M=F):M+oe>=1?(v=(a*D-1)*Math.pow(2,p),M+=oe):(v=a*Math.pow(2,oe-1)*Math.pow(2,p),M=0));p>=8;X[y+L]=255&v,L+=V,v/=256,p-=8);for(M=M<<p|v,$+=p;$>0;X[y+L]=255&M,L+=V,M/=256,$-=8);X[y+L-V]|=128*H}},6256:function(E,ae){!function(p){var L,d="undefined",M=d!==typeof Buffer&&Buffer,v=d!==typeof Uint8Array&&Uint8Array,D=d!==typeof ArrayBuffer&&ArrayBuffer,$=[0,0,0,0,0,0,0,0],F=Array.isArray||function N(P){return!!P&&"[object Array]"==Object.prototype.toString.call(P)},oe=4294967296;function V(P,g,b){var C=g?0:4,h=g?4:0,u=g?0:3,l=g?1:2,f=g?2:1,_=g?3:0,x=g?k:z,S=g?q:A,Q=T.prototype,le="is"+P,Ce="_"+le;return Q.buffer=void 0,Q.offset=0,Q[Ce]=!0,Q.toNumber=ve,Q.toString=function de(he){var B=this.buffer,R=this.offset,ie=ce(B,R+C),W=ce(B,R+h),me="",$e=!b&&2147483648&ie;for($e&&(ie=~ie,W=oe-W),he=he||10;;){var _e=ie%he*oe+W;if(ie=Math.floor(ie/he),W=Math.floor(_e/he),me=(_e%he).toString(he)+me,!ie&&!W)break}return $e&&(me="-"+me),me},Q.toJSON=ve,Q.toArray=H,M&&(Q.toBuffer=se),v&&(Q.toArrayBuffer=ue),T[le]=function O(he){return!(!he||!he[Ce])},p[P]=T,T;function T(he,B,R,ie){return this instanceof T?function re(he,B,R,ie,W){v&&D&&(B instanceof D&&(B=new v(B)),ie instanceof D&&(ie=new v(ie))),B||R||ie||L?(ee(B,R)||(W=R,ie=B,R=0,B=new(L||Array)(8)),he.buffer=B,he.offset=R|=0,d!==typeof ie&&("string"==typeof ie?function j(he,B,R,ie){var W=0,me=R.length,$e=0,_e=0;"-"===R[0]&&W++;for(var Ie=W;W<me;){var Pe=parseInt(R[W++],ie);if(!(Pe>=0))break;_e=_e*ie+Pe,$e=$e*ie+Math.floor(_e/oe),_e%=oe}Ie&&($e=~$e,_e?_e=oe-_e:$e++),Ee(he,B+C,$e),Ee(he,B+h,_e)}(B,R,ie,W||10):ee(ie,W)?Y(B,R,ie,W):"number"==typeof W?(Ee(B,R+C,ie),Ee(B,R+h,W)):ie>0?x(B,R,ie):ie<0?S(B,R,ie):Y(B,R,$,0))):he.buffer=ne($,0)}(this,he,B,R,ie):new T(he,B,R,ie)}function ve(){var he=this.buffer,B=this.offset,R=ce(he,B+C),ie=ce(he,B+h);return b||(R|=0),R?R*oe+ie:ie}function Ee(he,B,R){he[B+_]=255&R,he[B+f]=255&(R>>=8),he[B+l]=255&(R>>=8),he[B+u]=255&(R>>=8)}function ce(he,B){return 16777216*he[B+u]+(he[B+l]<<16)+(he[B+f]<<8)+he[B+_]}}function H(P){var g=this.buffer,b=this.offset;return L=null,!1!==P&&0===b&&8===g.length&&F(g)?g:ne(g,b)}function se(P){var g=this.buffer,b=this.offset;if(L=M,!1!==P&&0===b&&8===g.length&&Buffer.isBuffer(g))return g;var C=new M(8);return Y(C,0,g,b),C}function ue(P){var g=this.buffer,b=this.offset,C=g.buffer;if(L=v,!1!==P&&0===b&&C instanceof D&&8===C.byteLength)return C;var h=new v(8);return Y(h,0,g,b),h.buffer}function ee(P,g){var b=P&&P.length;return g|=0,b&&g+8<=b&&"string"!=typeof P[g]}function Y(P,g,b,C){g|=0,C|=0;for(var h=0;h<8;h++)P[g++]=255&b[C++]}function ne(P,g){return Array.prototype.slice.call(P,g,g+8)}function k(P,g,b){for(var C=g+8;C>g;)P[--C]=255&b,b/=256}function q(P,g,b){var C=g+8;for(b++;C>g;)P[--C]=255&-b^255,b/=256}function z(P,g,b){for(var C=g+8;g<C;)P[g++]=255&b,b/=256}function A(P,g,b){var C=g+8;for(b++;g<C;)P[g++]=255&-b^255,b/=256}V("Uint64BE",!0,!0),V("Int64BE",!0,!1),V("Uint64LE",!1,!0),V("Int64LE",!1,!1)}("string"!=typeof ae.nodeName?ae:this||{})},6425:E=>{var ae={}.toString;E.exports=Array.isArray||function(X){return"[object Array]"==ae.call(X)}},5650:E=>{E.exports=function ae(X,a,y){function w(M,v){if(!a[M]){if(!X[M]){if(p)return p(M,!0);var $=new Error("Cannot find module '"+M+"'");throw $.code="MODULE_NOT_FOUND",$}var F=a[M]={exports:{}};X[M][0].call(F.exports,function(oe){return w(X[M][1][oe]||oe)},F,F.exports,ae,X,a,y)}return a[M].exports}for(var p=void 0,d=0;d<y.length;d++)w(y[d]);return w}({1:[function(ae,X,a){"use strict";var y=ae("./utils"),w=ae("./support"),p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(d){for(var M,v,D,F,oe,G,L=[],V=0,H=d.length,se=H,ue="string"!==y.getTypeOf(d);V<d.length;)se=H-V,D=ue?(M=d[V++],v=V<H?d[V++]:0,V<H?d[V++]:0):(M=d.charCodeAt(V++),v=V<H?d.charCodeAt(V++):0,V<H?d.charCodeAt(V++):0),F=(3&M)<<4|v>>4,oe=1<se?(15&v)<<2|D>>6:64,G=2<se?63&D:64,L.push(p.charAt(M>>2)+p.charAt(F)+p.charAt(oe)+p.charAt(G));return L.join("")},a.decode=function(d){var M,v,D,$,F,oe,G=0,L=0,V="data:";if(d.substr(0,V.length)===V)throw new Error("Invalid base64 input, it looks like a data url.");var H,se=3*(d=d.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(d.charAt(d.length-1)===p.charAt(64)&&se--,d.charAt(d.length-2)===p.charAt(64)&&se--,se%1!=0)throw new Error("Invalid base64 input, bad content length.");for(H=w.uint8array?new Uint8Array(0|se):new Array(0|se);G<d.length;)M=p.indexOf(d.charAt(G++))<<2|($=p.indexOf(d.charAt(G++)))>>4,v=(15&$)<<4|(F=p.indexOf(d.charAt(G++)))>>2,D=(3&F)<<6|(oe=p.indexOf(d.charAt(G++))),H[L++]=M,64!==F&&(H[L++]=v),64!==oe&&(H[L++]=D);return H}},{"./support":30,"./utils":32}],2:[function(ae,X,a){"use strict";var y=ae("./external"),w=ae("./stream/DataWorker"),p=ae("./stream/Crc32Probe"),d=ae("./stream/DataLengthProbe");function M(v,D,$,F,oe){this.compressedSize=v,this.uncompressedSize=D,this.crc32=$,this.compression=F,this.compressedContent=oe}M.prototype={getContentWorker:function(){var v=new w(y.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new d("data_length")),D=this;return v.on("end",function(){if(this.streamInfo.data_length!==D.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),v},getCompressedWorker:function(){return new w(y.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},M.createWorkerFrom=function(v,D,$){return v.pipe(new p).pipe(new d("uncompressedSize")).pipe(D.compressWorker($)).pipe(new d("compressedSize")).withStreamInfo("compression",D)},X.exports=M},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(ae,X,a){"use strict";var y=ae("./stream/GenericWorker");a.STORE={magic:"\0\0",compressWorker:function(){return new y("STORE compression")},uncompressWorker:function(){return new y("STORE decompression")}},a.DEFLATE=ae("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(ae,X,a){"use strict";var y=ae("./utils"),w=function(){for(var p,d=[],M=0;M<256;M++){p=M;for(var v=0;v<8;v++)p=1&p?3988292384^p>>>1:p>>>1;d[M]=p}return d}();X.exports=function(p,d){return void 0!==p&&p.length?"string"!==y.getTypeOf(p)?function(M,v,D,$){var F=w,oe=0+D;M^=-1;for(var G=0;G<oe;G++)M=M>>>8^F[255&(M^v[G])];return-1^M}(0|d,p,p.length):function(M,v,D,$){var F=w,oe=0+D;M^=-1;for(var G=0;G<oe;G++)M=M>>>8^F[255&(M^v.charCodeAt(G))];return-1^M}(0|d,p,p.length):0}},{"./utils":32}],5:[function(ae,X,a){"use strict";a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!0,a.date=null,a.compression=null,a.compressionOptions=null,a.comment=null,a.unixPermissions=null,a.dosPermissions=null},{}],6:[function(ae,X,a){"use strict";var y;y="undefined"!=typeof Promise?Promise:ae("lie"),X.exports={Promise:y}},{lie:37}],7:[function(ae,X,a){"use strict";var y="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,w=ae("pako"),p=ae("./utils"),d=ae("./stream/GenericWorker"),M=y?"uint8array":"array";function v(D,$){d.call(this,"FlateWorker/"+D),this._pako=null,this._pakoAction=D,this._pakoOptions=$,this.meta={}}a.magic="\b\0",p.inherits(v,d),v.prototype.processChunk=function(D){this.meta=D.meta,null===this._pako&&this._createPako(),this._pako.push(p.transformTo(M,D.data),!1)},v.prototype.flush=function(){d.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},v.prototype.cleanUp=function(){d.prototype.cleanUp.call(this),this._pako=null},v.prototype._createPako=function(){this._pako=new w[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var D=this;this._pako.onData=function($){D.push({data:$,meta:D.meta})}},a.compressWorker=function(D){return new v("Deflate",D)},a.uncompressWorker=function(){return new v("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(ae,X,a){"use strict";function y(F,oe){var G,L="";for(G=0;G<oe;G++)L+=String.fromCharCode(255&F),F>>>=8;return L}function w(F,oe,G,L,V,H){var se,ue,ee=F.file,Y=F.compression,ne=H!==M.utf8encode,k=p.transformTo("string",H(ee.name)),q=p.transformTo("string",M.utf8encode(ee.name)),z=ee.comment,A=p.transformTo("string",H(z)),N=p.transformTo("string",M.utf8encode(z)),P=q.length!==ee.name.length,g=N.length!==z.length,b="",C="",h="",u=ee.dir,l=ee.date,f={crc32:0,compressedSize:0,uncompressedSize:0};oe&&!G||(f.crc32=F.crc32,f.compressedSize=F.compressedSize,f.uncompressedSize=F.uncompressedSize);var _=0;oe&&(_|=8),ne||!P&&!g||(_|=2048);var le,T,x=0,S=0;u&&(x|=16),"UNIX"===V?(S=798,x|=(T=le=ee.unixPermissions,le||(T=u?16893:33204),(65535&T)<<16)):(S=20,x|=function(le){return 63&(le||0)}(ee.dosPermissions)),se=l.getUTCHours(),se<<=6,se|=l.getUTCMinutes(),se<<=5,se|=l.getUTCSeconds()/2,ue=l.getUTCFullYear()-1980,ue<<=4,ue|=l.getUTCMonth()+1,ue<<=5,ue|=l.getUTCDate(),P&&(C=y(1,1)+y(v(k),4)+q,b+="up"+y(C.length,2)+C),g&&(h=y(1,1)+y(v(A),4)+N,b+="uc"+y(h.length,2)+h);var Q="";return Q+="\n\0",Q+=y(_,2),Q+=Y.magic,Q+=y(se,2),Q+=y(ue,2),Q+=y(f.crc32,4),Q+=y(f.compressedSize,4),Q+=y(f.uncompressedSize,4),Q+=y(k.length,2),Q+=y(b.length,2),{fileRecord:D.LOCAL_FILE_HEADER+Q+k+b,dirRecord:D.CENTRAL_FILE_HEADER+y(S,2)+Q+y(A.length,2)+"\0\0\0\0"+y(x,4)+y(L,4)+k+b+A}}var p=ae("../utils"),d=ae("../stream/GenericWorker"),M=ae("../utf8"),v=ae("../crc32"),D=ae("../signature");function $(F,oe,G,L){d.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=oe,this.zipPlatform=G,this.encodeFileName=L,this.streamFiles=F,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}p.inherits($,d),$.prototype.push=function(F){var oe=F.meta.percent||0,G=this.entriesCount,L=this._sources.length;this.accumulate?this.contentBuffer.push(F):(this.bytesWritten+=F.data.length,d.prototype.push.call(this,{data:F.data,meta:{currentFile:this.currentFile,percent:G?(oe+100*(G-L-1))/G:100}}))},$.prototype.openedSource=function(F){this.currentSourceOffset=this.bytesWritten,this.currentFile=F.file.name;var oe=this.streamFiles&&!F.file.dir;if(oe){var G=w(F,oe,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:G.fileRecord,meta:{percent:0}})}else this.accumulate=!0},$.prototype.closedSource=function(F){this.accumulate=!1;var L,oe=this.streamFiles&&!F.file.dir,G=w(F,oe,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(G.dirRecord),oe)this.push({data:(L=F,D.DATA_DESCRIPTOR+y(L.crc32,4)+y(L.compressedSize,4)+y(L.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:G.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},$.prototype.flush=function(){for(var F=this.bytesWritten,oe=0;oe<this.dirRecords.length;oe++)this.push({data:this.dirRecords[oe],meta:{percent:100}});var V,H,se,Y,L=(V=this.dirRecords.length,H=this.bytesWritten-F,se=F,Y=p.transformTo("string",(0,this.encodeFileName)(this.zipComment)),D.CENTRAL_DIRECTORY_END+"\0\0\0\0"+y(V,2)+y(V,2)+y(H,4)+y(se,4)+y(Y.length,2)+Y);this.push({data:L,meta:{percent:100}})},$.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},$.prototype.registerPrevious=function(F){this._sources.push(F);var oe=this;return F.on("data",function(G){oe.processChunk(G)}),F.on("end",function(){oe.closedSource(oe.previous.streamInfo),oe._sources.length?oe.prepareNextSource():oe.end()}),F.on("error",function(G){oe.error(G)}),this},$.prototype.resume=function(){return!!d.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},$.prototype.error=function(F){var oe=this._sources;if(!d.prototype.error.call(this,F))return!1;for(var G=0;G<oe.length;G++)try{oe[G].error(F)}catch(L){}return!0},$.prototype.lock=function(){d.prototype.lock.call(this);for(var F=this._sources,oe=0;oe<F.length;oe++)F[oe].lock()},X.exports=$},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(ae,X,a){"use strict";var y=ae("../compressions"),w=ae("./ZipFileWorker");a.generateWorker=function(p,d,M){var v=new w(d.streamFiles,M,d.platform,d.encodeFileName),D=0;try{p.forEach(function($,F){D++;var oe=function(H,se){var ue=H||se,ee=y[ue];if(!ee)throw new Error(ue+" is not a valid compression method !");return ee}(F.options.compression,d.compression),L=F.dir,V=F.date;F._compressWorker(oe,F.options.compressionOptions||d.compressionOptions||{}).withStreamInfo("file",{name:$,dir:L,date:V,comment:F.comment||"",unixPermissions:F.unixPermissions,dosPermissions:F.dosPermissions}).pipe(v)}),v.entriesCount=D}catch($){v.error($)}return v}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(ae,X,a){"use strict";function y(){if(!(this instanceof y))return new y;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var w=new y;for(var p in this)"function"!=typeof this[p]&&(w[p]=this[p]);return w}}(y.prototype=ae("./object")).loadAsync=ae("./load"),y.support=ae("./support"),y.defaults=ae("./defaults"),y.version="3.10.1",y.loadAsync=function(w,p){return(new y).loadAsync(w,p)},y.external=ae("./external"),X.exports=y},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(ae,X,a){"use strict";var y=ae("./utils"),w=ae("./external"),p=ae("./utf8"),d=ae("./zipEntries"),M=ae("./stream/Crc32Probe"),v=ae("./nodejsUtils");function D($){return new w.Promise(function(F,oe){var G=$.decompressed.getContentWorker().pipe(new M);G.on("error",function(L){oe(L)}).on("end",function(){G.streamInfo.crc32!==$.decompressed.crc32?oe(new Error("Corrupted zip : CRC32 mismatch")):F()}).resume()})}X.exports=function($,F){var oe=this;return F=y.extend(F||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:p.utf8decode}),v.isNode&&v.isStream($)?w.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):y.prepareContent("the loaded zip file",$,!0,F.optimizedBinaryString,F.base64).then(function(G){var L=new d(F);return L.load(G),L}).then(function(G){var L=[w.Promise.resolve(G)],V=G.files;if(F.checkCRC32)for(var H=0;H<V.length;H++)L.push(D(V[H]));return w.Promise.all(L)}).then(function(G){for(var L=G.shift(),V=L.files,H=0;H<V.length;H++){var se=V[H],ue=se.fileNameStr,ee=y.resolve(se.fileNameStr);oe.file(ee,se.decompressed,{binary:!0,optimizedBinaryString:!0,date:se.date,dir:se.dir,comment:se.fileCommentStr.length?se.fileCommentStr:null,unixPermissions:se.unixPermissions,dosPermissions:se.dosPermissions,createFolders:F.createFolders}),se.dir||(oe.file(ee).unsafeOriginalName=ue)}return L.zipComment.length&&(oe.comment=L.zipComment),oe})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(ae,X,a){"use strict";var y=ae("../utils"),w=ae("../stream/GenericWorker");function p(d,M){w.call(this,"Nodejs stream input adapter for "+d),this._upstreamEnded=!1,this._bindStream(M)}y.inherits(p,w),p.prototype._bindStream=function(d){var M=this;(this._stream=d).pause(),d.on("data",function(v){M.push({data:v,meta:{percent:0}})}).on("error",function(v){M.isPaused?this.generatedError=v:M.error(v)}).on("end",function(){M.isPaused?M._upstreamEnded=!0:M.end()})},p.prototype.pause=function(){return!!w.prototype.pause.call(this)&&(this._stream.pause(),!0)},p.prototype.resume=function(){return!!w.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},X.exports=p},{"../stream/GenericWorker":28,"../utils":32}],13:[function(ae,X,a){"use strict";var y=ae("readable-stream").Readable;function w(p,d,M){y.call(this,d),this._helper=p;var v=this;p.on("data",function(D,$){v.push(D)||v._helper.pause(),M&&M($)}).on("error",function(D){v.emit("error",D)}).on("end",function(){v.push(null)})}ae("../utils").inherits(w,y),w.prototype._read=function(){this._helper.resume()},X.exports=w},{"../utils":32,"readable-stream":16}],14:[function(ae,X,a){"use strict";X.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(y,w){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(y,w);if("number"==typeof y)throw new Error('The "data" argument must not be a number');return new Buffer(y,w)},allocBuffer:function(y){if(Buffer.alloc)return Buffer.alloc(y);var w=new Buffer(y);return w.fill(0),w},isBuffer:function(y){return Buffer.isBuffer(y)},isStream:function(y){return y&&"function"==typeof y.on&&"function"==typeof y.pause&&"function"==typeof y.resume}}},{}],15:[function(ae,X,a){"use strict";function y(ee,Y,ne){var k,q=p.getTypeOf(Y),z=p.extend(ne||{},v);z.date=z.date||new Date,null!==z.compression&&(z.compression=z.compression.toUpperCase()),"string"==typeof z.unixPermissions&&(z.unixPermissions=parseInt(z.unixPermissions,8)),z.unixPermissions&&16384&z.unixPermissions&&(z.dir=!0),z.dosPermissions&&16&z.dosPermissions&&(z.dir=!0),z.dir&&(ee=V(ee)),z.createFolders&&(k=L(ee))&&H.call(this,k,!0),ne&&void 0!==ne.binary||(z.binary=!("string"===q&&!1===z.binary&&!1===z.base64)),(Y instanceof D&&0===Y.uncompressedSize||z.dir||!Y||0===Y.length)&&(z.base64=!1,z.binary=!0,Y="",z.compression="STORE",q="string");var N;N=Y instanceof D||Y instanceof d?Y:oe.isNode&&oe.isStream(Y)?new G(ee,Y):p.prepareContent(ee,Y,z.binary,z.optimizedBinaryString,z.base64);var P=new $(ee,N,z);this.files[ee]=P}var w=ae("./utf8"),p=ae("./utils"),d=ae("./stream/GenericWorker"),M=ae("./stream/StreamHelper"),v=ae("./defaults"),D=ae("./compressedObject"),$=ae("./zipObject"),F=ae("./generate"),oe=ae("./nodejsUtils"),G=ae("./nodejs/NodejsStreamInputAdapter"),L=function(ee){"/"===ee.slice(-1)&&(ee=ee.substring(0,ee.length-1));var Y=ee.lastIndexOf("/");return 0<Y?ee.substring(0,Y):""},V=function(ee){return"/"!==ee.slice(-1)&&(ee+="/"),ee},H=function(ee,Y){return Y=void 0!==Y?Y:v.createFolders,ee=V(ee),this.files[ee]||y.call(this,ee,null,{dir:!0,createFolders:Y}),this.files[ee]};function se(ee){return"[object RegExp]"===Object.prototype.toString.call(ee)}var ue={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(ee){var Y,ne,k;for(Y in this.files)k=this.files[Y],(ne=Y.slice(this.root.length,Y.length))&&Y.slice(0,this.root.length)===this.root&&ee(ne,k)},filter:function(ee){var Y=[];return this.forEach(function(ne,k){ee(ne,k)&&Y.push(k)}),Y},file:function(ee,Y,ne){if(1!==arguments.length)return y.call(this,ee=this.root+ee,Y,ne),this;if(se(ee)){var k=ee;return this.filter(function(z,A){return!A.dir&&k.test(z)})}var q=this.files[this.root+ee];return q&&!q.dir?q:null},folder:function(ee){if(!ee)return this;if(se(ee))return this.filter(function(q,z){return z.dir&&ee.test(q)});var ne=H.call(this,this.root+ee),k=this.clone();return k.root=ne.name,k},remove:function(ee){var Y=this.files[ee=this.root+ee];if(Y||("/"!==ee.slice(-1)&&(ee+="/"),Y=this.files[ee]),Y&&!Y.dir)delete this.files[ee];else for(var ne=this.filter(function(q,z){return z.name.slice(0,ee.length)===ee}),k=0;k<ne.length;k++)delete this.files[ne[k].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(ee){var Y,ne={};try{if((ne=p.extend(ee||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:w.utf8encode})).type=ne.type.toLowerCase(),ne.compression=ne.compression.toUpperCase(),"binarystring"===ne.type&&(ne.type="string"),!ne.type)throw new Error("No output type specified.");p.checkSupport(ne.type),"darwin"!==ne.platform&&"freebsd"!==ne.platform&&"linux"!==ne.platform&&"sunos"!==ne.platform||(ne.platform="UNIX"),"win32"===ne.platform&&(ne.platform="DOS"),Y=F.generateWorker(this,ne,ne.comment||this.comment||"")}catch(q){(Y=new d("error")).error(q)}return new M(Y,ne.type||"string",ne.mimeType)},generateAsync:function(ee,Y){return this.generateInternalStream(ee).accumulate(Y)},generateNodeStream:function(ee,Y){return(ee=ee||{}).type||(ee.type="nodebuffer"),this.generateInternalStream(ee).toNodejsStream(Y)}};X.exports=ue},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(ae,X,a){"use strict";X.exports=ae("stream")},{stream:void 0}],17:[function(ae,X,a){"use strict";var y=ae("./DataReader");function w(p){y.call(this,p);for(var d=0;d<this.data.length;d++)p[d]=255&p[d]}ae("../utils").inherits(w,y),w.prototype.byteAt=function(p){return this.data[this.zero+p]},w.prototype.lastIndexOfSignature=function(p){for(var d=p.charCodeAt(0),M=p.charCodeAt(1),v=p.charCodeAt(2),D=p.charCodeAt(3),$=this.length-4;0<=$;--$)if(this.data[$]===d&&this.data[$+1]===M&&this.data[$+2]===v&&this.data[$+3]===D)return $-this.zero;return-1},w.prototype.readAndCheckSignature=function(p){var d=p.charCodeAt(0),M=p.charCodeAt(1),v=p.charCodeAt(2),D=p.charCodeAt(3),$=this.readData(4);return d===$[0]&&M===$[1]&&v===$[2]&&D===$[3]},w.prototype.readData=function(p){if(this.checkOffset(p),0===p)return[];var d=this.data.slice(this.zero+this.index,this.zero+this.index+p);return this.index+=p,d},X.exports=w},{"../utils":32,"./DataReader":18}],18:[function(ae,X,a){"use strict";var y=ae("../utils");function w(p){this.data=p,this.length=p.length,this.index=0,this.zero=0}w.prototype={checkOffset:function(p){this.checkIndex(this.index+p)},checkIndex:function(p){if(this.length<this.zero+p||p<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+p+"). Corrupted zip ?")},setIndex:function(p){this.checkIndex(p),this.index=p},skip:function(p){this.setIndex(this.index+p)},byteAt:function(){},readInt:function(p){var d,M=0;for(this.checkOffset(p),d=this.index+p-1;d>=this.index;d--)M=(M<<8)+this.byteAt(d);return this.index+=p,M},readString:function(p){return y.transformTo("string",this.readData(p))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var p=this.readInt(4);return new Date(Date.UTC(1980+(p>>25&127),(p>>21&15)-1,p>>16&31,p>>11&31,p>>5&63,(31&p)<<1))}},X.exports=w},{"../utils":32}],19:[function(ae,X,a){"use strict";var y=ae("./Uint8ArrayReader");function w(p){y.call(this,p)}ae("../utils").inherits(w,y),w.prototype.readData=function(p){this.checkOffset(p);var d=this.data.slice(this.zero+this.index,this.zero+this.index+p);return this.index+=p,d},X.exports=w},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(ae,X,a){"use strict";var y=ae("./DataReader");function w(p){y.call(this,p)}ae("../utils").inherits(w,y),w.prototype.byteAt=function(p){return this.data.charCodeAt(this.zero+p)},w.prototype.lastIndexOfSignature=function(p){return this.data.lastIndexOf(p)-this.zero},w.prototype.readAndCheckSignature=function(p){return p===this.readData(4)},w.prototype.readData=function(p){this.checkOffset(p);var d=this.data.slice(this.zero+this.index,this.zero+this.index+p);return this.index+=p,d},X.exports=w},{"../utils":32,"./DataReader":18}],21:[function(ae,X,a){"use strict";var y=ae("./ArrayReader");function w(p){y.call(this,p)}ae("../utils").inherits(w,y),w.prototype.readData=function(p){if(this.checkOffset(p),0===p)return new Uint8Array(0);var d=this.data.subarray(this.zero+this.index,this.zero+this.index+p);return this.index+=p,d},X.exports=w},{"../utils":32,"./ArrayReader":17}],22:[function(ae,X,a){"use strict";var y=ae("../utils"),w=ae("../support"),p=ae("./ArrayReader"),d=ae("./StringReader"),M=ae("./NodeBufferReader"),v=ae("./Uint8ArrayReader");X.exports=function(D){var $=y.getTypeOf(D);return y.checkSupport($),"string"!==$||w.uint8array?"nodebuffer"===$?new M(D):w.uint8array?new v(y.transformTo("uint8array",D)):new p(y.transformTo("array",D)):new d(D)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(ae,X,a){"use strict";a.LOCAL_FILE_HEADER="PK\x03\x04",a.CENTRAL_FILE_HEADER="PK\x01\x02",a.CENTRAL_DIRECTORY_END="PK\x05\x06",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",a.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",a.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(ae,X,a){"use strict";var y=ae("./GenericWorker"),w=ae("../utils");function p(d){y.call(this,"ConvertWorker to "+d),this.destType=d}w.inherits(p,y),p.prototype.processChunk=function(d){this.push({data:w.transformTo(this.destType,d.data),meta:d.meta})},X.exports=p},{"../utils":32,"./GenericWorker":28}],25:[function(ae,X,a){"use strict";var y=ae("./GenericWorker"),w=ae("../crc32");function p(){y.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}ae("../utils").inherits(p,y),p.prototype.processChunk=function(d){this.streamInfo.crc32=w(d.data,this.streamInfo.crc32||0),this.push(d)},X.exports=p},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(ae,X,a){"use strict";var y=ae("../utils"),w=ae("./GenericWorker");function p(d){w.call(this,"DataLengthProbe for "+d),this.propName=d,this.withStreamInfo(d,0)}y.inherits(p,w),p.prototype.processChunk=function(d){d&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+d.data.length),w.prototype.processChunk.call(this,d)},X.exports=p},{"../utils":32,"./GenericWorker":28}],27:[function(ae,X,a){"use strict";var y=ae("../utils"),w=ae("./GenericWorker");function p(d){w.call(this,"DataWorker");var M=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,d.then(function(v){M.dataIsReady=!0,M.data=v,M.max=v&&v.length||0,M.type=y.getTypeOf(v),M.isPaused||M._tickAndRepeat()},function(v){M.error(v)})}y.inherits(p,w),p.prototype.cleanUp=function(){w.prototype.cleanUp.call(this),this.data=null},p.prototype.resume=function(){return!!w.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,y.delay(this._tickAndRepeat,[],this)),!0)},p.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(y.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},p.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var d=null,M=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":d=this.data.substring(this.index,M);break;case"uint8array":d=this.data.subarray(this.index,M);break;case"array":case"nodebuffer":d=this.data.slice(this.index,M)}return this.index=M,this.push({data:d,meta:{percent:this.max?this.index/this.max*100:0}})},X.exports=p},{"../utils":32,"./GenericWorker":28}],28:[function(ae,X,a){"use strict";function y(w){this.name=w||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}y.prototype={push:function(w){this.emit("data",w)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(w){this.emit("error",w)}return!0},error:function(w){return!this.isFinished&&(this.isPaused?this.generatedError=w:(this.isFinished=!0,this.emit("error",w),this.previous&&this.previous.error(w),this.cleanUp()),!0)},on:function(w,p){return this._listeners[w].push(p),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(w,p){if(this._listeners[w])for(var d=0;d<this._listeners[w].length;d++)this._listeners[w][d].call(this,p)},pipe:function(w){return w.registerPrevious(this)},registerPrevious:function(w){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=w.streamInfo,this.mergeStreamInfo(),this.previous=w;var p=this;return w.on("data",function(d){p.processChunk(d)}),w.on("end",function(){p.end()}),w.on("error",function(d){p.error(d)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var w=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),w=!0),this.previous&&this.previous.resume(),!w},flush:function(){},processChunk:function(w){this.push(w)},withStreamInfo:function(w,p){return this.extraStreamInfo[w]=p,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var w in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,w)&&(this.streamInfo[w]=this.extraStreamInfo[w])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var w="Worker "+this.name;return this.previous?this.previous+" -> "+w:w}},X.exports=y},{}],29:[function(ae,X,a){"use strict";var y=ae("../utils"),w=ae("./ConvertWorker"),p=ae("./GenericWorker"),d=ae("../base64"),M=ae("../support"),v=ae("../external"),D=null;if(M.nodestream)try{D=ae("../nodejs/NodejsStreamOutputAdapter")}catch(oe){}function F(oe,G,L){var V=G;switch(G){case"blob":case"arraybuffer":V="uint8array";break;case"base64":V="string"}try{this._internalType=V,this._outputType=G,this._mimeType=L,y.checkSupport(V),this._worker=oe.pipe(new w(V)),oe.lock()}catch(H){this._worker=new p("error"),this._worker.error(H)}}F.prototype={accumulate:function(oe){return function $(oe,G){return new v.Promise(function(L,V){var H=[],se=oe._internalType,ue=oe._outputType,ee=oe._mimeType;oe.on("data",function(Y,ne){H.push(Y),G&&G(ne)}).on("error",function(Y){H=[],V(Y)}).on("end",function(){try{var Y=function(ne,k,q){switch(ne){case"blob":return y.newBlob(y.transformTo("arraybuffer",k),q);case"base64":return d.encode(k);default:return y.transformTo(ne,k)}}(ue,function(ne,k){var q,z=0,A=null,N=0;for(q=0;q<k.length;q++)N+=k[q].length;switch(ne){case"string":return k.join("");case"array":return Array.prototype.concat.apply([],k);case"uint8array":for(A=new Uint8Array(N),q=0;q<k.length;q++)A.set(k[q],z),z+=k[q].length;return A;case"nodebuffer":return Buffer.concat(k);default:throw new Error("concat : unsupported type '"+ne+"'")}}(se,H),ee);L(Y)}catch(ne){V(ne)}H=[]}).resume()})}(this,oe)},on:function(oe,G){var L=this;return this._worker.on(oe,"data"===oe?function(V){G.call(L,V.data,V.meta)}:function(){y.delay(G,arguments,L)}),this},resume:function(){return y.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(oe){if(y.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new D(this,{objectMode:"nodebuffer"!==this._outputType},oe)}},X.exports=F},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(ae,X,a){"use strict";if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,a.nodebuffer="undefined"!=typeof Buffer,a.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)a.blob=!1;else{var y=new ArrayBuffer(0);try{a.blob=0===new Blob([y],{type:"application/zip"}).size}catch(p){try{var w=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);w.append(y),a.blob=0===w.getBlob("application/zip").size}catch(d){a.blob=!1}}}try{a.nodestream=!!ae("readable-stream").Readable}catch(p){a.nodestream=!1}},{"readable-stream":16}],31:[function(ae,X,a){"use strict";for(var y=ae("./utils"),w=ae("./support"),p=ae("./nodejsUtils"),d=ae("./stream/GenericWorker"),M=new Array(256),v=0;v<256;v++)M[v]=252<=v?6:248<=v?5:240<=v?4:224<=v?3:192<=v?2:1;function D(){d.call(this,"utf-8 decode"),this.leftOver=null}function $(){d.call(this,"utf-8 encode")}M[254]=M[254]=1,a.utf8encode=function(F){return w.nodebuffer?p.newBufferFrom(F,"utf-8"):function(oe){var G,L,V,H,se,ue=oe.length,ee=0;for(H=0;H<ue;H++)55296==(64512&(L=oe.charCodeAt(H)))&&H+1<ue&&56320==(64512&(V=oe.charCodeAt(H+1)))&&(L=65536+(L-55296<<10)+(V-56320),H++),ee+=L<128?1:L<2048?2:L<65536?3:4;for(G=w.uint8array?new Uint8Array(ee):new Array(ee),H=se=0;se<ee;H++)55296==(64512&(L=oe.charCodeAt(H)))&&H+1<ue&&56320==(64512&(V=oe.charCodeAt(H+1)))&&(L=65536+(L-55296<<10)+(V-56320),H++),L<128?G[se++]=L:(L<2048?G[se++]=192|L>>>6:(L<65536?G[se++]=224|L>>>12:(G[se++]=240|L>>>18,G[se++]=128|L>>>12&63),G[se++]=128|L>>>6&63),G[se++]=128|63&L);return G}(F)},a.utf8decode=function(F){return w.nodebuffer?y.transformTo("nodebuffer",F).toString("utf-8"):function(oe){var G,L,V,H,se=oe.length,ue=new Array(2*se);for(G=L=0;G<se;)if((V=oe[G++])<128)ue[L++]=V;else if(4<(H=M[V]))ue[L++]=65533,G+=H-1;else{for(V&=2===H?31:3===H?15:7;1<H&&G<se;)V=V<<6|63&oe[G++],H--;1<H?ue[L++]=65533:V<65536?ue[L++]=V:(ue[L++]=55296|(V-=65536)>>10&1023,ue[L++]=56320|1023&V)}return ue.length!==L&&(ue.subarray?ue=ue.subarray(0,L):ue.length=L),y.applyFromCharCode(ue)}(F=y.transformTo(w.uint8array?"uint8array":"array",F))},y.inherits(D,d),D.prototype.processChunk=function(F){var oe=y.transformTo(w.uint8array?"uint8array":"array",F.data);if(this.leftOver&&this.leftOver.length){if(w.uint8array){var G=oe;(oe=new Uint8Array(G.length+this.leftOver.length)).set(this.leftOver,0),oe.set(G,this.leftOver.length)}else oe=this.leftOver.concat(oe);this.leftOver=null}var L=function(H,se){var ue;for((se=se||H.length)>H.length&&(se=H.length),ue=se-1;0<=ue&&128==(192&H[ue]);)ue--;return ue<0||0===ue?se:ue+M[H[ue]]>se?ue:se}(oe),V=oe;L!==oe.length&&(w.uint8array?(V=oe.subarray(0,L),this.leftOver=oe.subarray(L,oe.length)):(V=oe.slice(0,L),this.leftOver=oe.slice(L,oe.length))),this.push({data:a.utf8decode(V),meta:F.meta})},D.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=D,y.inherits($,d),$.prototype.processChunk=function(F){this.push({data:a.utf8encode(F.data),meta:F.meta})},a.Utf8EncodeWorker=$},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(ae,X,a){"use strict";var y=ae("./support"),w=ae("./base64"),p=ae("./nodejsUtils"),d=ae("./external");function M(G){return G}function v(G,L){for(var V=0;V<G.length;++V)L[V]=255&G.charCodeAt(V);return L}ae("setimmediate"),a.newBlob=function(G,L){a.checkSupport("blob");try{return new Blob([G],{type:L})}catch(H){try{var V=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return V.append(G),V.getBlob(L)}catch(se){throw new Error("Bug : can't construct the Blob.")}}};var D={stringifyByChunk:function(G,L,V){var H=[],se=0,ue=G.length;if(ue<=V)return String.fromCharCode.apply(null,G);for(;se<ue;)H.push(String.fromCharCode.apply(null,"array"===L||"nodebuffer"===L?G.slice(se,Math.min(se+V,ue)):G.subarray(se,Math.min(se+V,ue)))),se+=V;return H.join("")},stringifyByChar:function(G){for(var L="",V=0;V<G.length;V++)L+=String.fromCharCode(G[V]);return L},applyCanBeUsed:{uint8array:function(){try{return y.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(G){return!1}}(),nodebuffer:function(){try{return y.nodebuffer&&1===String.fromCharCode.apply(null,p.allocBuffer(1)).length}catch(G){return!1}}()}};function $(G){var L=65536,V=a.getTypeOf(G),H=!0;if("uint8array"===V?H=D.applyCanBeUsed.uint8array:"nodebuffer"===V&&(H=D.applyCanBeUsed.nodebuffer),H)for(;1<L;)try{return D.stringifyByChunk(G,V,L)}catch(se){L=Math.floor(L/2)}return D.stringifyByChar(G)}function F(G,L){for(var V=0;V<G.length;V++)L[V]=G[V];return L}a.applyFromCharCode=$;var oe={};oe.string={string:M,array:function(G){return v(G,new Array(G.length))},arraybuffer:function(G){return oe.string.uint8array(G).buffer},uint8array:function(G){return v(G,new Uint8Array(G.length))},nodebuffer:function(G){return v(G,p.allocBuffer(G.length))}},oe.array={string:$,array:M,arraybuffer:function(G){return new Uint8Array(G).buffer},uint8array:function(G){return new Uint8Array(G)},nodebuffer:function(G){return p.newBufferFrom(G)}},oe.arraybuffer={string:function(G){return $(new Uint8Array(G))},array:function(G){return F(new Uint8Array(G),new Array(G.byteLength))},arraybuffer:M,uint8array:function(G){return new Uint8Array(G)},nodebuffer:function(G){return p.newBufferFrom(new Uint8Array(G))}},oe.uint8array={string:$,array:function(G){return F(G,new Array(G.length))},arraybuffer:function(G){return G.buffer},uint8array:M,nodebuffer:function(G){return p.newBufferFrom(G)}},oe.nodebuffer={string:$,array:function(G){return F(G,new Array(G.length))},arraybuffer:function(G){return oe.nodebuffer.uint8array(G).buffer},uint8array:function(G){return F(G,new Uint8Array(G.length))},nodebuffer:M},a.transformTo=function(G,L){if(L=L||"",!G)return L;a.checkSupport(G);var V=a.getTypeOf(L);return oe[V][G](L)},a.resolve=function(G){for(var L=G.split("/"),V=[],H=0;H<L.length;H++){var se=L[H];"."===se||""===se&&0!==H&&H!==L.length-1||(".."===se?V.pop():V.push(se))}return V.join("/")},a.getTypeOf=function(G){return"string"==typeof G?"string":"[object Array]"===Object.prototype.toString.call(G)?"array":y.nodebuffer&&p.isBuffer(G)?"nodebuffer":y.uint8array&&G instanceof Uint8Array?"uint8array":y.arraybuffer&&G instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(G){if(!y[G.toLowerCase()])throw new Error(G+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(G){var L,V,H="";for(V=0;V<(G||"").length;V++)H+="\\x"+((L=G.charCodeAt(V))<16?"0":"")+L.toString(16).toUpperCase();return H},a.delay=function(G,L,V){setImmediate(function(){G.apply(V||null,L||[])})},a.inherits=function(G,L){function V(){}V.prototype=L.prototype,G.prototype=new V},a.extend=function(){var G,L,V={};for(G=0;G<arguments.length;G++)for(L in arguments[G])Object.prototype.hasOwnProperty.call(arguments[G],L)&&void 0===V[L]&&(V[L]=arguments[G][L]);return V},a.prepareContent=function(G,L,V,H,se){return d.Promise.resolve(L).then(function(ue){return y.blob&&(ue instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(ue)))&&"undefined"!=typeof FileReader?new d.Promise(function(ee,Y){var ne=new FileReader;ne.onload=function(k){ee(k.target.result)},ne.onerror=function(k){Y(k.target.error)},ne.readAsArrayBuffer(ue)}):ue}).then(function(ue){var Y,ee=a.getTypeOf(ue);return ee?("arraybuffer"===ee?ue=a.transformTo("uint8array",ue):"string"===ee&&(se?ue=w.decode(ue):V&&!0!==H&&(ue=v(Y=ue,y.uint8array?new Uint8Array(Y.length):new Array(Y.length)))),ue):d.Promise.reject(new Error("Can't read the data of '"+G+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(ae,X,a){"use strict";var y=ae("./reader/readerFor"),w=ae("./utils"),p=ae("./signature"),d=ae("./zipEntry"),M=ae("./support");function v(D){this.files=[],this.loadOptions=D}v.prototype={checkSignature:function(D){if(!this.reader.readAndCheckSignature(D)){this.reader.index-=4;var $=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+w.pretty($)+", expected "+w.pretty(D)+")")}},isSignature:function(D,$){var F=this.reader.index;this.reader.setIndex(D);var oe=this.reader.readString(4)===$;return this.reader.setIndex(F),oe},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var D=this.reader.readData(this.zipCommentLength),F=w.transformTo(M.uint8array?"uint8array":"array",D);this.zipComment=this.loadOptions.decodeFileName(F)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var D,$,F,oe=this.zip64EndOfCentralSize-44;0<oe;)D=this.reader.readInt(2),$=this.reader.readInt(4),F=this.reader.readData($),this.zip64ExtensibleData[D]={id:D,length:$,value:F}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var D,$;for(D=0;D<this.files.length;D++)this.reader.setIndex(($=this.files[D]).localHeaderOffset),this.checkSignature(p.LOCAL_FILE_HEADER),$.readLocalPart(this.reader),$.handleUTF8(),$.processAttributes()},readCentralDir:function(){var D;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(p.CENTRAL_FILE_HEADER);)(D=new d({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(D);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var D=this.reader.lastIndexOfSignature(p.CENTRAL_DIRECTORY_END);if(D<0)throw this.isSignature(0,p.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(D);var $=D;if(this.checkSignature(p.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===w.MAX_VALUE_16BITS||this.diskWithCentralDirStart===w.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===w.MAX_VALUE_16BITS||this.centralDirRecords===w.MAX_VALUE_16BITS||this.centralDirSize===w.MAX_VALUE_32BITS||this.centralDirOffset===w.MAX_VALUE_32BITS){if(this.zip64=!0,(D=this.reader.lastIndexOfSignature(p.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(D),this.checkSignature(p.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,p.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(p.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(p.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var F=this.centralDirOffset+this.centralDirSize;this.zip64&&(F+=20,F+=12+this.zip64EndOfCentralSize);var oe=$-F;if(0<oe)this.isSignature($,p.CENTRAL_FILE_HEADER)||(this.reader.zero=oe);else if(oe<0)throw new Error("Corrupted zip: missing "+Math.abs(oe)+" bytes.")},prepareReader:function(D){this.reader=y(D)},load:function(D){this.prepareReader(D),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},X.exports=v},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(ae,X,a){"use strict";var y=ae("./reader/readerFor"),w=ae("./utils"),p=ae("./compressedObject"),d=ae("./crc32"),M=ae("./utf8"),v=ae("./compressions"),D=ae("./support");function $(F,oe){this.options=F,this.loadOptions=oe}$.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(F){var oe,G;if(F.skip(22),this.fileNameLength=F.readInt(2),G=F.readInt(2),this.fileName=F.readData(this.fileNameLength),F.skip(G),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(oe=function(L){for(var V in v)if(Object.prototype.hasOwnProperty.call(v,V)&&v[V].magic===L)return v[V];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+w.pretty(this.compressionMethod)+" unknown (inner file : "+w.transformTo("string",this.fileName)+")");this.decompressed=new p(this.compressedSize,this.uncompressedSize,this.crc32,oe,F.readData(this.compressedSize))},readCentralPart:function(F){this.versionMadeBy=F.readInt(2),F.skip(2),this.bitFlag=F.readInt(2),this.compressionMethod=F.readString(2),this.date=F.readDate(),this.crc32=F.readInt(4),this.compressedSize=F.readInt(4),this.uncompressedSize=F.readInt(4);var oe=F.readInt(2);if(this.extraFieldsLength=F.readInt(2),this.fileCommentLength=F.readInt(2),this.diskNumberStart=F.readInt(2),this.internalFileAttributes=F.readInt(2),this.externalFileAttributes=F.readInt(4),this.localHeaderOffset=F.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");F.skip(oe),this.readExtraFields(F),this.parseZIP64ExtraField(F),this.fileComment=F.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var F=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==F&&(this.dosPermissions=63&this.externalFileAttributes),3==F&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var F=y(this.extraFields[1].value);this.uncompressedSize===w.MAX_VALUE_32BITS&&(this.uncompressedSize=F.readInt(8)),this.compressedSize===w.MAX_VALUE_32BITS&&(this.compressedSize=F.readInt(8)),this.localHeaderOffset===w.MAX_VALUE_32BITS&&(this.localHeaderOffset=F.readInt(8)),this.diskNumberStart===w.MAX_VALUE_32BITS&&(this.diskNumberStart=F.readInt(4))}},readExtraFields:function(F){var oe,G,L,V=F.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});F.index+4<V;)oe=F.readInt(2),G=F.readInt(2),L=F.readData(G),this.extraFields[oe]={id:oe,length:G,value:L};F.setIndex(V)},handleUTF8:function(){var F=D.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=M.utf8decode(this.fileName),this.fileCommentStr=M.utf8decode(this.fileComment);else{var oe=this.findExtraFieldUnicodePath();if(null!==oe)this.fileNameStr=oe;else{var G=w.transformTo(F,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(G)}var L=this.findExtraFieldUnicodeComment();if(null!==L)this.fileCommentStr=L;else{var V=w.transformTo(F,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(V)}}},findExtraFieldUnicodePath:function(){var F=this.extraFields[28789];if(F){var oe=y(F.value);return 1!==oe.readInt(1)||d(this.fileName)!==oe.readInt(4)?null:M.utf8decode(oe.readData(F.length-5))}return null},findExtraFieldUnicodeComment:function(){var F=this.extraFields[25461];if(F){var oe=y(F.value);return 1!==oe.readInt(1)||d(this.fileComment)!==oe.readInt(4)?null:M.utf8decode(oe.readData(F.length-5))}return null}},X.exports=$},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(ae,X,a){"use strict";function y(oe,G,L){this.name=oe,this.dir=L.dir,this.date=L.date,this.comment=L.comment,this.unixPermissions=L.unixPermissions,this.dosPermissions=L.dosPermissions,this._data=G,this._dataBinary=L.binary,this.options={compression:L.compression,compressionOptions:L.compressionOptions}}var w=ae("./stream/StreamHelper"),p=ae("./stream/DataWorker"),d=ae("./utf8"),M=ae("./compressedObject"),v=ae("./stream/GenericWorker");y.prototype={internalStream:function(oe){var G=null,L="string";try{if(!oe)throw new Error("No output type specified.");var V="string"===(L=oe.toLowerCase())||"text"===L;"binarystring"!==L&&"text"!==L||(L="string"),G=this._decompressWorker();var H=!this._dataBinary;H&&!V&&(G=G.pipe(new d.Utf8EncodeWorker)),!H&&V&&(G=G.pipe(new d.Utf8DecodeWorker))}catch(se){(G=new v("error")).error(se)}return new w(G,L,"")},async:function(oe,G){return this.internalStream(oe).accumulate(G)},nodeStream:function(oe,G){return this.internalStream(oe||"nodebuffer").toNodejsStream(G)},_compressWorker:function(oe,G){if(this._data instanceof M&&this._data.compression.magic===oe.magic)return this._data.getCompressedWorker();var L=this._decompressWorker();return this._dataBinary||(L=L.pipe(new d.Utf8EncodeWorker)),M.createWorkerFrom(L,oe,G)},_decompressWorker:function(){return this._data instanceof M?this._data.getContentWorker():this._data instanceof v?this._data:new p(this._data)}};for(var D=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],$=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},F=0;F<D.length;F++)y.prototype[D[F]]=$;X.exports=y},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(ae,X,a){(function(y){"use strict";var w,p,d=y.MutationObserver||y.WebKitMutationObserver;if(d){var M=0,v=new d(oe),D=y.document.createTextNode("");v.observe(D,{characterData:!0}),w=function(){D.data=M=++M%2}}else if(y.setImmediate||void 0===y.MessageChannel)w="document"in y&&"onreadystatechange"in y.document.createElement("script")?function(){var G=y.document.createElement("script");G.onreadystatechange=function(){oe(),G.onreadystatechange=null,G.parentNode.removeChild(G),G=null},y.document.documentElement.appendChild(G)}:function(){setTimeout(oe,0)};else{var $=new y.MessageChannel;$.port1.onmessage=oe,w=function(){$.port2.postMessage(0)}}var F=[];function oe(){var G,L;p=!0;for(var V=F.length;V;){for(L=F,F=[],G=-1;++G<V;)L[G]();V=F.length}p=!1}X.exports=function(G){1!==F.push(G)||p||w()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(ae,X,a){"use strict";var y=ae("immediate");function w(){}var p={},d=["REJECTED"],M=["FULFILLED"],v=["PENDING"];function D(V){if("function"!=typeof V)throw new TypeError("resolver must be a function");this.state=v,this.queue=[],this.outcome=void 0,V!==w&&G(this,V)}function $(V,H,se){this.promise=V,"function"==typeof H&&(this.onFulfilled=H,this.callFulfilled=this.otherCallFulfilled),"function"==typeof se&&(this.onRejected=se,this.callRejected=this.otherCallRejected)}function F(V,H,se){y(function(){var ue;try{ue=H(se)}catch(ee){return p.reject(V,ee)}ue===V?p.reject(V,new TypeError("Cannot resolve promise with itself")):p.resolve(V,ue)})}function oe(V){var H=V&&V.then;if(V&&("object"==typeof V||"function"==typeof V)&&"function"==typeof H)return function(){H.apply(V,arguments)}}function G(V,H){var se=!1;function ue(ne){se||(se=!0,p.reject(V,ne))}function ee(ne){se||(se=!0,p.resolve(V,ne))}var Y=L(function(){H(ee,ue)});"error"===Y.status&&ue(Y.value)}function L(V,H){var se={};try{se.value=V(H),se.status="success"}catch(ue){se.status="error",se.value=ue}return se}(X.exports=D).prototype.finally=function(V){if("function"!=typeof V)return this;var H=this.constructor;return this.then(function(se){return H.resolve(V()).then(function(){return se})},function(se){return H.resolve(V()).then(function(){throw se})})},D.prototype.catch=function(V){return this.then(null,V)},D.prototype.then=function(V,H){if("function"!=typeof V&&this.state===M||"function"!=typeof H&&this.state===d)return this;var se=new this.constructor(w);return this.state!==v?F(se,this.state===M?V:H,this.outcome):this.queue.push(new $(se,V,H)),se},$.prototype.callFulfilled=function(V){p.resolve(this.promise,V)},$.prototype.otherCallFulfilled=function(V){F(this.promise,this.onFulfilled,V)},$.prototype.callRejected=function(V){p.reject(this.promise,V)},$.prototype.otherCallRejected=function(V){F(this.promise,this.onRejected,V)},p.resolve=function(V,H){var se=L(oe,H);if("error"===se.status)return p.reject(V,se.value);var ue=se.value;if(ue)G(V,ue);else{V.state=M,V.outcome=H;for(var ee=-1,Y=V.queue.length;++ee<Y;)V.queue[ee].callFulfilled(H)}return V},p.reject=function(V,H){V.state=d,V.outcome=H;for(var se=-1,ue=V.queue.length;++se<ue;)V.queue[se].callRejected(H);return V},D.resolve=function(V){return V instanceof this?V:p.resolve(new this(w),V)},D.reject=function(V){var H=new this(w);return p.reject(H,V)},D.all=function(V){var H=this;if("[object Array]"!==Object.prototype.toString.call(V))return this.reject(new TypeError("must be an array"));var se=V.length,ue=!1;if(!se)return this.resolve([]);for(var ee=new Array(se),Y=0,ne=-1,k=new this(w);++ne<se;)q(V[ne],ne);return k;function q(z,A){H.resolve(z).then(function(N){ee[A]=N,++Y!==se||ue||(ue=!0,p.resolve(k,ee))},function(N){ue||(ue=!0,p.reject(k,N))})}},D.race=function(V){if("[object Array]"!==Object.prototype.toString.call(V))return this.reject(new TypeError("must be an array"));var se=V.length,ue=!1;if(!se)return this.resolve([]);for(var ee=-1,Y=new this(w);++ee<se;)this.resolve(V[ee]).then(function(k){ue||(ue=!0,p.resolve(Y,k))},function(k){ue||(ue=!0,p.reject(Y,k))});return Y}},{immediate:36}],38:[function(ae,X,a){"use strict";var y={};(0,ae("./lib/utils/common").assign)(y,ae("./lib/deflate"),ae("./lib/inflate"),ae("./lib/zlib/constants")),X.exports=y},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(ae,X,a){"use strict";var y=ae("./zlib/deflate"),w=ae("./utils/common"),p=ae("./utils/strings"),d=ae("./zlib/messages"),M=ae("./zlib/zstream"),v=Object.prototype.toString;function G(V){if(!(this instanceof G))return new G(V);this.options=w.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},V||{});var H=this.options;H.raw&&0<H.windowBits?H.windowBits=-H.windowBits:H.gzip&&0<H.windowBits&&H.windowBits<16&&(H.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new M,this.strm.avail_out=0;var se=y.deflateInit2(this.strm,H.level,H.method,H.windowBits,H.memLevel,H.strategy);if(0!==se)throw new Error(d[se]);if(H.header&&y.deflateSetHeader(this.strm,H.header),H.dictionary){var ue;if(ue="string"==typeof H.dictionary?p.string2buf(H.dictionary):"[object ArrayBuffer]"===v.call(H.dictionary)?new Uint8Array(H.dictionary):H.dictionary,0!==(se=y.deflateSetDictionary(this.strm,ue)))throw new Error(d[se]);this._dict_set=!0}}function L(V,H){var se=new G(H);if(se.push(V,!0),se.err)throw se.msg||d[se.err];return se.result}G.prototype.push=function(V,H){var se,ue,ee=this.strm,Y=this.options.chunkSize;if(this.ended)return!1;ue=H===~~H?H:!0===H?4:0,ee.input="string"==typeof V?p.string2buf(V):"[object ArrayBuffer]"===v.call(V)?new Uint8Array(V):V,ee.next_in=0,ee.avail_in=ee.input.length;do{if(0===ee.avail_out&&(ee.output=new w.Buf8(Y),ee.next_out=0,ee.avail_out=Y),1!==(se=y.deflate(ee,ue))&&0!==se)return this.onEnd(se),!(this.ended=!0);0!==ee.avail_out&&(0!==ee.avail_in||4!==ue&&2!==ue)||this.onData("string"===this.options.to?p.buf2binstring(w.shrinkBuf(ee.output,ee.next_out)):w.shrinkBuf(ee.output,ee.next_out))}while((0<ee.avail_in||0===ee.avail_out)&&1!==se);return 4===ue?(se=y.deflateEnd(this.strm),this.onEnd(se),this.ended=!0,0===se):2!==ue||(this.onEnd(0),!(ee.avail_out=0))},G.prototype.onData=function(V){this.chunks.push(V)},G.prototype.onEnd=function(V){0===V&&(this.result="string"===this.options.to?this.chunks.join(""):w.flattenChunks(this.chunks)),this.chunks=[],this.err=V,this.msg=this.strm.msg},a.Deflate=G,a.deflate=L,a.deflateRaw=function(V,H){return(H=H||{}).raw=!0,L(V,H)},a.gzip=function(V,H){return(H=H||{}).gzip=!0,L(V,H)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(ae,X,a){"use strict";var y=ae("./zlib/inflate"),w=ae("./utils/common"),p=ae("./utils/strings"),d=ae("./zlib/constants"),M=ae("./zlib/messages"),v=ae("./zlib/zstream"),D=ae("./zlib/gzheader"),$=Object.prototype.toString;function F(G){if(!(this instanceof F))return new F(G);this.options=w.assign({chunkSize:16384,windowBits:0,to:""},G||{});var L=this.options;L.raw&&0<=L.windowBits&&L.windowBits<16&&(L.windowBits=-L.windowBits,0===L.windowBits&&(L.windowBits=-15)),!(0<=L.windowBits&&L.windowBits<16)||G&&G.windowBits||(L.windowBits+=32),15<L.windowBits&&L.windowBits<48&&0==(15&L.windowBits)&&(L.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new v,this.strm.avail_out=0;var V=y.inflateInit2(this.strm,L.windowBits);if(V!==d.Z_OK)throw new Error(M[V]);this.header=new D,y.inflateGetHeader(this.strm,this.header)}function oe(G,L){var V=new F(L);if(V.push(G,!0),V.err)throw V.msg||M[V.err];return V.result}F.prototype.push=function(G,L){var V,H,se,ue,ee,Y,ne=this.strm,k=this.options.chunkSize,q=this.options.dictionary,z=!1;if(this.ended)return!1;H=L===~~L?L:!0===L?d.Z_FINISH:d.Z_NO_FLUSH,ne.input="string"==typeof G?p.binstring2buf(G):"[object ArrayBuffer]"===$.call(G)?new Uint8Array(G):G,ne.next_in=0,ne.avail_in=ne.input.length;do{if(0===ne.avail_out&&(ne.output=new w.Buf8(k),ne.next_out=0,ne.avail_out=k),(V=y.inflate(ne,d.Z_NO_FLUSH))===d.Z_NEED_DICT&&q&&(Y="string"==typeof q?p.string2buf(q):"[object ArrayBuffer]"===$.call(q)?new Uint8Array(q):q,V=y.inflateSetDictionary(this.strm,Y)),V===d.Z_BUF_ERROR&&!0===z&&(V=d.Z_OK,z=!1),V!==d.Z_STREAM_END&&V!==d.Z_OK)return this.onEnd(V),!(this.ended=!0);ne.next_out&&(0!==ne.avail_out&&V!==d.Z_STREAM_END&&(0!==ne.avail_in||H!==d.Z_FINISH&&H!==d.Z_SYNC_FLUSH)||("string"===this.options.to?(se=p.utf8border(ne.output,ne.next_out),ue=ne.next_out-se,ee=p.buf2string(ne.output,se),ne.next_out=ue,ne.avail_out=k-ue,ue&&w.arraySet(ne.output,ne.output,se,ue,0),this.onData(ee)):this.onData(w.shrinkBuf(ne.output,ne.next_out)))),0===ne.avail_in&&0===ne.avail_out&&(z=!0)}while((0<ne.avail_in||0===ne.avail_out)&&V!==d.Z_STREAM_END);return V===d.Z_STREAM_END&&(H=d.Z_FINISH),H===d.Z_FINISH?(V=y.inflateEnd(this.strm),this.onEnd(V),this.ended=!0,V===d.Z_OK):H!==d.Z_SYNC_FLUSH||(this.onEnd(d.Z_OK),!(ne.avail_out=0))},F.prototype.onData=function(G){this.chunks.push(G)},F.prototype.onEnd=function(G){G===d.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):w.flattenChunks(this.chunks)),this.chunks=[],this.err=G,this.msg=this.strm.msg},a.Inflate=F,a.inflate=oe,a.inflateRaw=function(G,L){return(L=L||{}).raw=!0,oe(G,L)},a.ungzip=oe},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(ae,X,a){"use strict";var y="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;a.assign=function(d){for(var M=Array.prototype.slice.call(arguments,1);M.length;){var v=M.shift();if(v){if("object"!=typeof v)throw new TypeError(v+"must be non-object");for(var D in v)v.hasOwnProperty(D)&&(d[D]=v[D])}}return d},a.shrinkBuf=function(d,M){return d.length===M?d:d.subarray?d.subarray(0,M):(d.length=M,d)};var w={arraySet:function(d,M,v,D,$){if(M.subarray&&d.subarray)d.set(M.subarray(v,v+D),$);else for(var F=0;F<D;F++)d[$+F]=M[v+F]},flattenChunks:function(d){var M,v,D,$,F,oe;for(M=D=0,v=d.length;M<v;M++)D+=d[M].length;for(oe=new Uint8Array(D),M=$=0,v=d.length;M<v;M++)oe.set(F=d[M],$),$+=F.length;return oe}},p={arraySet:function(d,M,v,D,$){for(var F=0;F<D;F++)d[$+F]=M[v+F]},flattenChunks:function(d){return[].concat.apply([],d)}};a.setTyped=function(d){d?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,w)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,p))},a.setTyped(y)},{}],42:[function(ae,X,a){"use strict";var y=ae("./common"),w=!0,p=!0;try{String.fromCharCode.apply(null,[0])}catch(D){w=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(D){p=!1}for(var d=new y.Buf8(256),M=0;M<256;M++)d[M]=252<=M?6:248<=M?5:240<=M?4:224<=M?3:192<=M?2:1;function v(D,$){if($<65537&&(D.subarray&&p||!D.subarray&&w))return String.fromCharCode.apply(null,y.shrinkBuf(D,$));for(var F="",oe=0;oe<$;oe++)F+=String.fromCharCode(D[oe]);return F}d[254]=d[254]=1,a.string2buf=function(D){var $,F,oe,G,L,V=D.length,H=0;for(G=0;G<V;G++)55296==(64512&(F=D.charCodeAt(G)))&&G+1<V&&56320==(64512&(oe=D.charCodeAt(G+1)))&&(F=65536+(F-55296<<10)+(oe-56320),G++),H+=F<128?1:F<2048?2:F<65536?3:4;for($=new y.Buf8(H),G=L=0;L<H;G++)55296==(64512&(F=D.charCodeAt(G)))&&G+1<V&&56320==(64512&(oe=D.charCodeAt(G+1)))&&(F=65536+(F-55296<<10)+(oe-56320),G++),F<128?$[L++]=F:(F<2048?$[L++]=192|F>>>6:(F<65536?$[L++]=224|F>>>12:($[L++]=240|F>>>18,$[L++]=128|F>>>12&63),$[L++]=128|F>>>6&63),$[L++]=128|63&F);return $},a.buf2binstring=function(D){return v(D,D.length)},a.binstring2buf=function(D){for(var $=new y.Buf8(D.length),F=0,oe=$.length;F<oe;F++)$[F]=D.charCodeAt(F);return $},a.buf2string=function(D,$){var F,oe,G,L,V=$||D.length,H=new Array(2*V);for(F=oe=0;F<V;)if((G=D[F++])<128)H[oe++]=G;else if(4<(L=d[G]))H[oe++]=65533,F+=L-1;else{for(G&=2===L?31:3===L?15:7;1<L&&F<V;)G=G<<6|63&D[F++],L--;1<L?H[oe++]=65533:G<65536?H[oe++]=G:(H[oe++]=55296|(G-=65536)>>10&1023,H[oe++]=56320|1023&G)}return v(H,oe)},a.utf8border=function(D,$){var F;for(($=$||D.length)>D.length&&($=D.length),F=$-1;0<=F&&128==(192&D[F]);)F--;return F<0||0===F?$:F+d[D[F]]>$?F:$}},{"./common":41}],43:[function(ae,X,a){"use strict";X.exports=function(y,w,p,d){for(var M=65535&y|0,v=y>>>16&65535|0,D=0;0!==p;){for(p-=D=2e3<p?2e3:p;v=v+(M=M+w[d++]|0)|0,--D;);M%=65521,v%=65521}return M|v<<16|0}},{}],44:[function(ae,X,a){"use strict";X.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(ae,X,a){"use strict";var y=function(){for(var w,p=[],d=0;d<256;d++){w=d;for(var M=0;M<8;M++)w=1&w?3988292384^w>>>1:w>>>1;p[d]=w}return p}();X.exports=function(w,p,d,M){var v=y,D=M+d;w^=-1;for(var $=M;$<D;$++)w=w>>>8^v[255&(w^p[$])];return-1^w}},{}],46:[function(ae,X,a){"use strict";var y,w=ae("../utils/common"),p=ae("./trees"),d=ae("./adler32"),M=ae("./crc32"),v=ae("./messages"),z=258,A=262,P=113;function u(ce,he){return ce.msg=v[he],he}function l(ce){return(ce<<1)-(4<ce?9:0)}function f(ce){for(var he=ce.length;0<=--he;)ce[he]=0}function _(ce){var he=ce.state,B=he.pending;B>ce.avail_out&&(B=ce.avail_out),0!==B&&(w.arraySet(ce.output,he.pending_buf,he.pending_out,B,ce.next_out),ce.next_out+=B,he.pending_out+=B,ce.total_out+=B,ce.avail_out-=B,he.pending-=B,0===he.pending&&(he.pending_out=0))}function x(ce,he){p._tr_flush_block(ce,0<=ce.block_start?ce.block_start:-1,ce.strstart-ce.block_start,he),ce.block_start=ce.strstart,_(ce.strm)}function S(ce,he){ce.pending_buf[ce.pending++]=he}function Q(ce,he){ce.pending_buf[ce.pending++]=he>>>8&255,ce.pending_buf[ce.pending++]=255&he}function le(ce,he){var B,R,ie=ce.max_chain_length,W=ce.strstart,me=ce.prev_length,$e=ce.nice_match,_e=ce.strstart>ce.w_size-A?ce.strstart-(ce.w_size-A):0,Ie=ce.window,Pe=ce.w_mask,Ae=ce.prev,Ne=ce.strstart+z,We=Ie[W+me-1],nt=Ie[W+me];ce.prev_length>=ce.good_match&&(ie>>=2),$e>ce.lookahead&&($e=ce.lookahead);do{if(Ie[(B=he)+me]===nt&&Ie[B+me-1]===We&&Ie[B]===Ie[W]&&Ie[++B]===Ie[W+1]){W+=2,B++;do{}while(Ie[++W]===Ie[++B]&&Ie[++W]===Ie[++B]&&Ie[++W]===Ie[++B]&&Ie[++W]===Ie[++B]&&Ie[++W]===Ie[++B]&&Ie[++W]===Ie[++B]&&Ie[++W]===Ie[++B]&&Ie[++W]===Ie[++B]&&W<Ne);if(R=z-(Ne-W),W=Ne-z,me<R){if(ce.match_start=he,$e<=(me=R))break;We=Ie[W+me-1],nt=Ie[W+me]}}}while((he=Ae[he&Pe])>_e&&0!=--ie);return me<=ce.lookahead?me:ce.lookahead}function Ce(ce){var he,B,R,ie,W,me,$e,_e,Ie,Pe,Ae=ce.w_size;do{if(ie=ce.window_size-ce.lookahead-ce.strstart,ce.strstart>=Ae+(Ae-A)){for(w.arraySet(ce.window,ce.window,Ae,Ae,0),ce.match_start-=Ae,ce.strstart-=Ae,ce.block_start-=Ae,he=B=ce.hash_size;R=ce.head[--he],ce.head[he]=Ae<=R?R-Ae:0,--B;);for(he=B=Ae;R=ce.prev[--he],ce.prev[he]=Ae<=R?R-Ae:0,--B;);ie+=Ae}if(0===ce.strm.avail_in)break;if($e=ce.window,_e=ce.strstart+ce.lookahead,Pe=void 0,(Ie=ie)<(Pe=(me=ce.strm).avail_in)&&(Pe=Ie),B=0===Pe?0:(me.avail_in-=Pe,w.arraySet($e,me.input,me.next_in,Pe,_e),1===me.state.wrap?me.adler=d(me.adler,$e,Pe,_e):2===me.state.wrap&&(me.adler=M(me.adler,$e,Pe,_e)),me.next_in+=Pe,me.total_in+=Pe,Pe),ce.lookahead+=B,ce.lookahead+ce.insert>=3)for(ce.ins_h=ce.window[W=ce.strstart-ce.insert],ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[W+1])&ce.hash_mask;ce.insert&&(ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[W+3-1])&ce.hash_mask,ce.prev[W&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=W,W++,ce.insert--,!(ce.lookahead+ce.insert<3)););}while(ce.lookahead<A&&0!==ce.strm.avail_in)}function T(ce,he){for(var B,R;;){if(ce.lookahead<A){if(Ce(ce),ce.lookahead<A&&0===he)return 1;if(0===ce.lookahead)break}if(B=0,ce.lookahead>=3&&(ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[ce.strstart+3-1])&ce.hash_mask,B=ce.prev[ce.strstart&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=ce.strstart),0!==B&&ce.strstart-B<=ce.w_size-A&&(ce.match_length=le(ce,B)),ce.match_length>=3)if(R=p._tr_tally(ce,ce.strstart-ce.match_start,ce.match_length-3),ce.lookahead-=ce.match_length,ce.match_length<=ce.max_lazy_match&&ce.lookahead>=3){for(ce.match_length--;ce.strstart++,ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[ce.strstart+3-1])&ce.hash_mask,B=ce.prev[ce.strstart&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=ce.strstart,0!=--ce.match_length;);ce.strstart++}else ce.strstart+=ce.match_length,ce.match_length=0,ce.ins_h=ce.window[ce.strstart],ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[ce.strstart+1])&ce.hash_mask;else R=p._tr_tally(ce,0,ce.window[ce.strstart]),ce.lookahead--,ce.strstart++;if(R&&(x(ce,!1),0===ce.strm.avail_out))return 1}return ce.insert=ce.strstart<2?ce.strstart:2,4===he?(x(ce,!0),0===ce.strm.avail_out?3:4):ce.last_lit&&(x(ce,!1),0===ce.strm.avail_out)?1:2}function O(ce,he){for(var B,R,ie;;){if(ce.lookahead<A){if(Ce(ce),ce.lookahead<A&&0===he)return 1;if(0===ce.lookahead)break}if(B=0,ce.lookahead>=3&&(ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[ce.strstart+3-1])&ce.hash_mask,B=ce.prev[ce.strstart&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=ce.strstart),ce.prev_length=ce.match_length,ce.prev_match=ce.match_start,ce.match_length=2,0!==B&&ce.prev_length<ce.max_lazy_match&&ce.strstart-B<=ce.w_size-A&&(ce.match_length=le(ce,B),ce.match_length<=5&&(1===ce.strategy||3===ce.match_length&&4096<ce.strstart-ce.match_start)&&(ce.match_length=2)),ce.prev_length>=3&&ce.match_length<=ce.prev_length){for(ie=ce.strstart+ce.lookahead-3,R=p._tr_tally(ce,ce.strstart-1-ce.prev_match,ce.prev_length-3),ce.lookahead-=ce.prev_length-1,ce.prev_length-=2;++ce.strstart<=ie&&(ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[ce.strstart+3-1])&ce.hash_mask,B=ce.prev[ce.strstart&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=ce.strstart),0!=--ce.prev_length;);if(ce.match_available=0,ce.match_length=2,ce.strstart++,R&&(x(ce,!1),0===ce.strm.avail_out))return 1}else if(ce.match_available){if((R=p._tr_tally(ce,0,ce.window[ce.strstart-1]))&&x(ce,!1),ce.strstart++,ce.lookahead--,0===ce.strm.avail_out)return 1}else ce.match_available=1,ce.strstart++,ce.lookahead--}return ce.match_available&&(R=p._tr_tally(ce,0,ce.window[ce.strstart-1]),ce.match_available=0),ce.insert=ce.strstart<2?ce.strstart:2,4===he?(x(ce,!0),0===ce.strm.avail_out?3:4):ce.last_lit&&(x(ce,!1),0===ce.strm.avail_out)?1:2}function re(ce,he,B,R,ie){this.good_length=ce,this.max_lazy=he,this.nice_length=B,this.max_chain=R,this.func=ie}function j(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new w.Buf16(1146),this.dyn_dtree=new w.Buf16(122),this.bl_tree=new w.Buf16(78),f(this.dyn_ltree),f(this.dyn_dtree),f(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new w.Buf16(16),this.heap=new w.Buf16(573),f(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new w.Buf16(573),f(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ve(ce){var he;return ce&&ce.state?(ce.total_in=ce.total_out=0,ce.data_type=2,(he=ce.state).pending=0,he.pending_out=0,he.wrap<0&&(he.wrap=-he.wrap),he.status=he.wrap?42:P,ce.adler=2===he.wrap?0:1,he.last_flush=0,p._tr_init(he),0):u(ce,-2)}function de(ce){var B,he=ve(ce);return 0===he&&((B=ce.state).window_size=2*B.w_size,f(B.head),B.max_lazy_match=y[B.level].max_lazy,B.good_match=y[B.level].good_length,B.nice_match=y[B.level].nice_length,B.max_chain_length=y[B.level].max_chain,B.strstart=0,B.block_start=0,B.lookahead=0,B.insert=0,B.match_length=B.prev_length=2,B.match_available=0,B.ins_h=0),he}function Ee(ce,he,B,R,ie,W){if(!ce)return-2;var me=1;if(-1===he&&(he=6),R<0?(me=0,R=-R):15<R&&(me=2,R-=16),ie<1||9<ie||8!==B||R<8||15<R||he<0||9<he||W<0||4<W)return u(ce,-2);8===R&&(R=9);var $e=new j;return(ce.state=$e).strm=ce,$e.wrap=me,$e.gzhead=null,$e.w_bits=R,$e.w_size=1<<$e.w_bits,$e.w_mask=$e.w_size-1,$e.hash_bits=ie+7,$e.hash_size=1<<$e.hash_bits,$e.hash_mask=$e.hash_size-1,$e.hash_shift=~~(($e.hash_bits+3-1)/3),$e.window=new w.Buf8(2*$e.w_size),$e.head=new w.Buf16($e.hash_size),$e.prev=new w.Buf16($e.w_size),$e.lit_bufsize=1<<ie+6,$e.pending_buf_size=4*$e.lit_bufsize,$e.pending_buf=new w.Buf8($e.pending_buf_size),$e.d_buf=1*$e.lit_bufsize,$e.l_buf=3*$e.lit_bufsize,$e.level=he,$e.strategy=W,$e.method=B,de(ce)}y=[new re(0,0,0,0,function(ce,he){var B=65535;for(B>ce.pending_buf_size-5&&(B=ce.pending_buf_size-5);;){if(ce.lookahead<=1){if(Ce(ce),0===ce.lookahead&&0===he)return 1;if(0===ce.lookahead)break}ce.strstart+=ce.lookahead,ce.lookahead=0;var R=ce.block_start+B;if((0===ce.strstart||ce.strstart>=R)&&(ce.lookahead=ce.strstart-R,ce.strstart=R,x(ce,!1),0===ce.strm.avail_out)||ce.strstart-ce.block_start>=ce.w_size-A&&(x(ce,!1),0===ce.strm.avail_out))return 1}return ce.insert=0,4===he?(x(ce,!0),0===ce.strm.avail_out?3:4):(ce.strstart>ce.block_start&&x(ce,!1),1)}),new re(4,4,8,4,T),new re(4,5,16,8,T),new re(4,6,32,32,T),new re(4,4,16,16,O),new re(8,16,32,32,O),new re(8,16,128,128,O),new re(8,32,128,256,O),new re(32,128,258,1024,O),new re(32,258,258,4096,O)],a.deflateInit=function(ce,he){return Ee(ce,he,8,15,8,0)},a.deflateInit2=Ee,a.deflateReset=de,a.deflateResetKeep=ve,a.deflateSetHeader=function(ce,he){return ce&&ce.state?2!==ce.state.wrap?-2:(ce.state.gzhead=he,0):-2},a.deflate=function(ce,he){var B,R,ie,W;if(!ce||!ce.state||5<he||he<0)return ce?u(ce,-2):-2;if(R=ce.state,!ce.output||!ce.input&&0!==ce.avail_in||666===R.status&&4!==he)return u(ce,0===ce.avail_out?-5:-2);if(R.strm=ce,B=R.last_flush,R.last_flush=he,42===R.status)if(2===R.wrap)ce.adler=0,S(R,31),S(R,139),S(R,8),R.gzhead?(S(R,(R.gzhead.text?1:0)+(R.gzhead.hcrc?2:0)+(R.gzhead.extra?4:0)+(R.gzhead.name?8:0)+(R.gzhead.comment?16:0)),S(R,255&R.gzhead.time),S(R,R.gzhead.time>>8&255),S(R,R.gzhead.time>>16&255),S(R,R.gzhead.time>>24&255),S(R,9===R.level?2:2<=R.strategy||R.level<2?4:0),S(R,255&R.gzhead.os),R.gzhead.extra&&R.gzhead.extra.length&&(S(R,255&R.gzhead.extra.length),S(R,R.gzhead.extra.length>>8&255)),R.gzhead.hcrc&&(ce.adler=M(ce.adler,R.pending_buf,R.pending,0)),R.gzindex=0,R.status=69):(S(R,0),S(R,0),S(R,0),S(R,0),S(R,0),S(R,9===R.level?2:2<=R.strategy||R.level<2?4:0),S(R,3),R.status=P);else{var me=8+(R.w_bits-8<<4)<<8;me|=(2<=R.strategy||R.level<2?0:R.level<6?1:6===R.level?2:3)<<6,0!==R.strstart&&(me|=32),me+=31-me%31,R.status=P,Q(R,me),0!==R.strstart&&(Q(R,ce.adler>>>16),Q(R,65535&ce.adler)),ce.adler=1}if(69===R.status)if(R.gzhead.extra){for(ie=R.pending;R.gzindex<(65535&R.gzhead.extra.length)&&(R.pending!==R.pending_buf_size||(R.gzhead.hcrc&&R.pending>ie&&(ce.adler=M(ce.adler,R.pending_buf,R.pending-ie,ie)),_(ce),ie=R.pending,R.pending!==R.pending_buf_size));)S(R,255&R.gzhead.extra[R.gzindex]),R.gzindex++;R.gzhead.hcrc&&R.pending>ie&&(ce.adler=M(ce.adler,R.pending_buf,R.pending-ie,ie)),R.gzindex===R.gzhead.extra.length&&(R.gzindex=0,R.status=73)}else R.status=73;if(73===R.status)if(R.gzhead.name){ie=R.pending;do{if(R.pending===R.pending_buf_size&&(R.gzhead.hcrc&&R.pending>ie&&(ce.adler=M(ce.adler,R.pending_buf,R.pending-ie,ie)),_(ce),ie=R.pending,R.pending===R.pending_buf_size)){W=1;break}W=R.gzindex<R.gzhead.name.length?255&R.gzhead.name.charCodeAt(R.gzindex++):0,S(R,W)}while(0!==W);R.gzhead.hcrc&&R.pending>ie&&(ce.adler=M(ce.adler,R.pending_buf,R.pending-ie,ie)),0===W&&(R.gzindex=0,R.status=91)}else R.status=91;if(91===R.status)if(R.gzhead.comment){ie=R.pending;do{if(R.pending===R.pending_buf_size&&(R.gzhead.hcrc&&R.pending>ie&&(ce.adler=M(ce.adler,R.pending_buf,R.pending-ie,ie)),_(ce),ie=R.pending,R.pending===R.pending_buf_size)){W=1;break}W=R.gzindex<R.gzhead.comment.length?255&R.gzhead.comment.charCodeAt(R.gzindex++):0,S(R,W)}while(0!==W);R.gzhead.hcrc&&R.pending>ie&&(ce.adler=M(ce.adler,R.pending_buf,R.pending-ie,ie)),0===W&&(R.status=103)}else R.status=103;if(103===R.status&&(R.gzhead.hcrc?(R.pending+2>R.pending_buf_size&&_(ce),R.pending+2<=R.pending_buf_size&&(S(R,255&ce.adler),S(R,ce.adler>>8&255),ce.adler=0,R.status=P)):R.status=P),0!==R.pending){if(_(ce),0===ce.avail_out)return R.last_flush=-1,0}else if(0===ce.avail_in&&l(he)<=l(B)&&4!==he)return u(ce,-5);if(666===R.status&&0!==ce.avail_in)return u(ce,-5);if(0!==ce.avail_in||0!==R.lookahead||0!==he&&666!==R.status){var $e=2===R.strategy?function(_e,Ie){for(var Pe;;){if(0===_e.lookahead&&(Ce(_e),0===_e.lookahead)){if(0===Ie)return 1;break}if(_e.match_length=0,Pe=p._tr_tally(_e,0,_e.window[_e.strstart]),_e.lookahead--,_e.strstart++,Pe&&(x(_e,!1),0===_e.strm.avail_out))return 1}return _e.insert=0,4===Ie?(x(_e,!0),0===_e.strm.avail_out?3:4):_e.last_lit&&(x(_e,!1),0===_e.strm.avail_out)?1:2}(R,he):3===R.strategy?function(_e,Ie){for(var Pe,Ae,Ne,We,nt=_e.window;;){if(_e.lookahead<=z){if(Ce(_e),_e.lookahead<=z&&0===Ie)return 1;if(0===_e.lookahead)break}if(_e.match_length=0,_e.lookahead>=3&&0<_e.strstart&&(Ae=nt[Ne=_e.strstart-1])===nt[++Ne]&&Ae===nt[++Ne]&&Ae===nt[++Ne]){We=_e.strstart+z;do{}while(Ae===nt[++Ne]&&Ae===nt[++Ne]&&Ae===nt[++Ne]&&Ae===nt[++Ne]&&Ae===nt[++Ne]&&Ae===nt[++Ne]&&Ae===nt[++Ne]&&Ae===nt[++Ne]&&Ne<We);_e.match_length=z-(We-Ne),_e.match_length>_e.lookahead&&(_e.match_length=_e.lookahead)}if(_e.match_length>=3?(Pe=p._tr_tally(_e,1,_e.match_length-3),_e.lookahead-=_e.match_length,_e.strstart+=_e.match_length,_e.match_length=0):(Pe=p._tr_tally(_e,0,_e.window[_e.strstart]),_e.lookahead--,_e.strstart++),Pe&&(x(_e,!1),0===_e.strm.avail_out))return 1}return _e.insert=0,4===Ie?(x(_e,!0),0===_e.strm.avail_out?3:4):_e.last_lit&&(x(_e,!1),0===_e.strm.avail_out)?1:2}(R,he):y[R.level].func(R,he);if(3!==$e&&4!==$e||(R.status=666),1===$e||3===$e)return 0===ce.avail_out&&(R.last_flush=-1),0;if(2===$e&&(1===he?p._tr_align(R):5!==he&&(p._tr_stored_block(R,0,0,!1),3===he&&(f(R.head),0===R.lookahead&&(R.strstart=0,R.block_start=0,R.insert=0))),_(ce),0===ce.avail_out))return R.last_flush=-1,0}return 4!==he?0:R.wrap<=0?1:(2===R.wrap?(S(R,255&ce.adler),S(R,ce.adler>>8&255),S(R,ce.adler>>16&255),S(R,ce.adler>>24&255),S(R,255&ce.total_in),S(R,ce.total_in>>8&255),S(R,ce.total_in>>16&255),S(R,ce.total_in>>24&255)):(Q(R,ce.adler>>>16),Q(R,65535&ce.adler)),_(ce),0<R.wrap&&(R.wrap=-R.wrap),0!==R.pending?0:1)},a.deflateEnd=function(ce){var he;return ce&&ce.state?42!==(he=ce.state.status)&&69!==he&&73!==he&&91!==he&&103!==he&&he!==P&&666!==he?u(ce,-2):(ce.state=null,he===P?u(ce,-3):0):-2},a.deflateSetDictionary=function(ce,he){var B,R,ie,W,me,$e,_e,Ie,Pe=he.length;if(!ce||!ce.state||2===(W=(B=ce.state).wrap)||1===W&&42!==B.status||B.lookahead)return-2;for(1===W&&(ce.adler=d(ce.adler,he,Pe,0)),B.wrap=0,Pe>=B.w_size&&(0===W&&(f(B.head),B.strstart=0,B.block_start=0,B.insert=0),Ie=new w.Buf8(B.w_size),w.arraySet(Ie,he,Pe-B.w_size,B.w_size,0),he=Ie,Pe=B.w_size),me=ce.avail_in,$e=ce.next_in,_e=ce.input,ce.avail_in=Pe,ce.next_in=0,ce.input=he,Ce(B);B.lookahead>=3;){for(R=B.strstart,ie=B.lookahead-2;B.ins_h=(B.ins_h<<B.hash_shift^B.window[R+3-1])&B.hash_mask,B.prev[R&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=R,R++,--ie;);B.strstart=R,B.lookahead=2,Ce(B)}return B.strstart+=B.lookahead,B.block_start=B.strstart,B.insert=B.lookahead,B.lookahead=0,B.match_length=B.prev_length=2,B.match_available=0,ce.next_in=$e,ce.input=_e,ce.avail_in=me,B.wrap=W,0},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(ae,X,a){"use strict";X.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(ae,X,a){"use strict";X.exports=function(y,w){var p,d,M,v,D,$,F,oe,G,L,V,H,se,ue,ee,Y,ne,k,q,z,A,N,P,g,b;g=y.input,M=(d=y.next_in)+(y.avail_in-5),b=y.output,D=(v=y.next_out)-(w-y.avail_out),$=v+(y.avail_out-257),F=(p=y.state).dmax,oe=p.wsize,G=p.whave,L=p.wnext,V=p.window,H=p.hold,se=p.bits,ue=p.lencode,ee=p.distcode,Y=(1<<p.lenbits)-1,ne=(1<<p.distbits)-1;e:do{se<15&&(H+=g[d++]<<se,H+=g[d++]<<(se+=8),se+=8),k=ue[H&Y];t:for(;;){if(H>>>=q=k>>>24,se-=q,0==(q=k>>>16&255))b[v++]=65535&k;else{if(!(16&q)){if(0==(64&q)){k=ue[(65535&k)+(H&(1<<q)-1)];continue t}if(32&q){p.mode=12;break e}y.msg="invalid literal/length code",p.mode=30;break e}z=65535&k,(q&=15)&&(se<q&&(H+=g[d++]<<se,se+=8),z+=H&(1<<q)-1,H>>>=q,se-=q),se<15&&(H+=g[d++]<<se,H+=g[d++]<<(se+=8),se+=8),k=ee[H&ne];n:for(;;){if(H>>>=q=k>>>24,se-=q,!(16&(q=k>>>16&255))){if(0==(64&q)){k=ee[(65535&k)+(H&(1<<q)-1)];continue n}y.msg="invalid distance code",p.mode=30;break e}if(A=65535&k,se<(q&=15)&&(H+=g[d++]<<se,(se+=8)<q&&(H+=g[d++]<<se,se+=8)),F<(A+=H&(1<<q)-1)){y.msg="invalid distance too far back",p.mode=30;break e}if(H>>>=q,se-=q,(q=v-D)<A){if(G<(q=A-q)&&p.sane){y.msg="invalid distance too far back",p.mode=30;break e}if(P=V,(N=0)===L){if(N+=oe-q,q<z){for(z-=q;b[v++]=V[N++],--q;);N=v-A,P=b}}else if(L<q){if(N+=oe+L-q,(q-=L)<z){for(z-=q;b[v++]=V[N++],--q;);if(N=0,L<z){for(z-=q=L;b[v++]=V[N++],--q;);N=v-A,P=b}}}else if(N+=L-q,q<z){for(z-=q;b[v++]=V[N++],--q;);N=v-A,P=b}for(;2<z;)b[v++]=P[N++],b[v++]=P[N++],b[v++]=P[N++],z-=3;z&&(b[v++]=P[N++],1<z&&(b[v++]=P[N++]))}else{for(N=v-A;b[v++]=b[N++],b[v++]=b[N++],b[v++]=b[N++],2<(z-=3););z&&(b[v++]=b[N++],1<z&&(b[v++]=b[N++]))}break}}break}}while(d<M&&v<$);d-=z=se>>3,H&=(1<<(se-=z<<3))-1,y.next_in=d,y.next_out=v,y.avail_in=d<M?M-d+5:5-(d-M),y.avail_out=v<$?$-v+257:257-(v-$),p.hold=H,p.bits=se}},{}],49:[function(ae,X,a){"use strict";var y=ae("../utils/common"),w=ae("./adler32"),p=ae("./crc32"),d=ae("./inffast"),M=ae("./inftrees"),F=-2;function V(N){return(N>>>24&255)+(N>>>8&65280)+((65280&N)<<8)+((255&N)<<24)}function H(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new y.Buf16(320),this.work=new y.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function se(N){var P;return N&&N.state?(N.total_in=N.total_out=(P=N.state).total=0,N.msg="",P.wrap&&(N.adler=1&P.wrap),P.mode=1,P.last=0,P.havedict=0,P.dmax=32768,P.head=null,P.hold=0,P.bits=0,P.lencode=P.lendyn=new y.Buf32(852),P.distcode=P.distdyn=new y.Buf32(592),P.sane=1,P.back=-1,0):F}function ue(N){var P;return N&&N.state?((P=N.state).wsize=0,P.whave=0,P.wnext=0,se(N)):F}function ee(N,P){var g,b;return N&&N.state?(b=N.state,P<0?(g=0,P=-P):(g=1+(P>>4),P<48&&(P&=15)),P&&(P<8||15<P)?F:(null!==b.window&&b.wbits!==P&&(b.window=null),b.wrap=g,b.wbits=P,ue(N))):F}function Y(N,P){var g,b;return N?(b=new H,(N.state=b).window=null,0!==(g=ee(N,P))&&(N.state=null),g):F}var ne,k,q=!0;function z(N){if(q){var P;for(ne=new y.Buf32(512),k=new y.Buf32(32),P=0;P<144;)N.lens[P++]=8;for(;P<256;)N.lens[P++]=9;for(;P<280;)N.lens[P++]=7;for(;P<288;)N.lens[P++]=8;for(M(1,N.lens,0,288,ne,0,N.work,{bits:9}),P=0;P<32;)N.lens[P++]=5;M(2,N.lens,0,32,k,0,N.work,{bits:5}),q=!1}N.lencode=ne,N.lenbits=9,N.distcode=k,N.distbits=5}function A(N,P,g,b){var C,h=N.state;return null===h.window&&(h.wsize=1<<h.wbits,h.wnext=0,h.whave=0,h.window=new y.Buf8(h.wsize)),b>=h.wsize?(y.arraySet(h.window,P,g-h.wsize,h.wsize,0),h.wnext=0,h.whave=h.wsize):(b<(C=h.wsize-h.wnext)&&(C=b),y.arraySet(h.window,P,g-b,C,h.wnext),(b-=C)?(y.arraySet(h.window,P,g-b,b,0),h.wnext=b,h.whave=h.wsize):(h.wnext+=C,h.wnext===h.wsize&&(h.wnext=0),h.whave<h.wsize&&(h.whave+=C))),0}a.inflateReset=ue,a.inflateReset2=ee,a.inflateResetKeep=se,a.inflateInit=function(N){return Y(N,15)},a.inflateInit2=Y,a.inflate=function(N,P){var g,b,C,h,u,l,f,_,x,S,Q,le,Ce,T,O,re,j,ve,de,Ee,ce,he,B,R,ie=0,W=new y.Buf8(4),me=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!N||!N.state||!N.output||!N.input&&0!==N.avail_in)return F;12===(g=N.state).mode&&(g.mode=13),u=N.next_out,C=N.output,h=N.next_in,b=N.input,_=g.hold,x=g.bits,S=l=N.avail_in,Q=f=N.avail_out,he=0;e:for(;;)switch(g.mode){case 1:if(0===g.wrap){g.mode=13;break}for(;x<16;){if(0===l)break e;l--,_+=b[h++]<<x,x+=8}if(2&g.wrap&&35615===_){W[g.check=0]=255&_,W[1]=_>>>8&255,g.check=p(g.check,W,2,0),x=_=0,g.mode=2;break}if(g.flags=0,g.head&&(g.head.done=!1),!(1&g.wrap)||(((255&_)<<8)+(_>>8))%31){N.msg="incorrect header check",g.mode=30;break}if(8!=(15&_)){N.msg="unknown compression method",g.mode=30;break}if(x-=4,ce=8+(15&(_>>>=4)),0===g.wbits)g.wbits=ce;else if(ce>g.wbits){N.msg="invalid window size",g.mode=30;break}g.dmax=1<<ce,N.adler=g.check=1,g.mode=512&_?10:12,x=_=0;break;case 2:for(;x<16;){if(0===l)break e;l--,_+=b[h++]<<x,x+=8}if(g.flags=_,8!=(255&g.flags)){N.msg="unknown compression method",g.mode=30;break}if(57344&g.flags){N.msg="unknown header flags set",g.mode=30;break}g.head&&(g.head.text=_>>8&1),512&g.flags&&(W[0]=255&_,W[1]=_>>>8&255,g.check=p(g.check,W,2,0)),x=_=0,g.mode=3;case 3:for(;x<32;){if(0===l)break e;l--,_+=b[h++]<<x,x+=8}g.head&&(g.head.time=_),512&g.flags&&(W[0]=255&_,W[1]=_>>>8&255,W[2]=_>>>16&255,W[3]=_>>>24&255,g.check=p(g.check,W,4,0)),x=_=0,g.mode=4;case 4:for(;x<16;){if(0===l)break e;l--,_+=b[h++]<<x,x+=8}g.head&&(g.head.xflags=255&_,g.head.os=_>>8),512&g.flags&&(W[0]=255&_,W[1]=_>>>8&255,g.check=p(g.check,W,2,0)),x=_=0,g.mode=5;case 5:if(1024&g.flags){for(;x<16;){if(0===l)break e;l--,_+=b[h++]<<x,x+=8}g.length=_,g.head&&(g.head.extra_len=_),512&g.flags&&(W[0]=255&_,W[1]=_>>>8&255,g.check=p(g.check,W,2,0)),x=_=0}else g.head&&(g.head.extra=null);g.mode=6;case 6:if(1024&g.flags&&(l<(le=g.length)&&(le=l),le&&(g.head&&(ce=g.head.extra_len-g.length,g.head.extra||(g.head.extra=new Array(g.head.extra_len)),y.arraySet(g.head.extra,b,h,le,ce)),512&g.flags&&(g.check=p(g.check,b,le,h)),l-=le,h+=le,g.length-=le),g.length))break e;g.length=0,g.mode=7;case 7:if(2048&g.flags){if(0===l)break e;for(le=0;ce=b[h+le++],g.head&&ce&&g.length<65536&&(g.head.name+=String.fromCharCode(ce)),ce&&le<l;);if(512&g.flags&&(g.check=p(g.check,b,le,h)),l-=le,h+=le,ce)break e}else g.head&&(g.head.name=null);g.length=0,g.mode=8;case 8:if(4096&g.flags){if(0===l)break e;for(le=0;ce=b[h+le++],g.head&&ce&&g.length<65536&&(g.head.comment+=String.fromCharCode(ce)),ce&&le<l;);if(512&g.flags&&(g.check=p(g.check,b,le,h)),l-=le,h+=le,ce)break e}else g.head&&(g.head.comment=null);g.mode=9;case 9:if(512&g.flags){for(;x<16;){if(0===l)break e;l--,_+=b[h++]<<x,x+=8}if(_!==(65535&g.check)){N.msg="header crc mismatch",g.mode=30;break}x=_=0}g.head&&(g.head.hcrc=g.flags>>9&1,g.head.done=!0),N.adler=g.check=0,g.mode=12;break;case 10:for(;x<32;){if(0===l)break e;l--,_+=b[h++]<<x,x+=8}N.adler=g.check=V(_),x=_=0,g.mode=11;case 11:if(0===g.havedict)return N.next_out=u,N.avail_out=f,N.next_in=h,N.avail_in=l,g.hold=_,g.bits=x,2;N.adler=g.check=1,g.mode=12;case 12:if(5===P||6===P)break e;case 13:if(g.last){_>>>=7&x,x-=7&x,g.mode=27;break}for(;x<3;){if(0===l)break e;l--,_+=b[h++]<<x,x+=8}switch(g.last=1&_,x-=1,3&(_>>>=1)){case 0:g.mode=14;break;case 1:if(z(g),g.mode=20,6!==P)break;_>>>=2,x-=2;break e;case 2:g.mode=17;break;case 3:N.msg="invalid block type",g.mode=30}_>>>=2,x-=2;break;case 14:for(_>>>=7&x,x-=7&x;x<32;){if(0===l)break e;l--,_+=b[h++]<<x,x+=8}if((65535&_)!=(_>>>16^65535)){N.msg="invalid stored block lengths",g.mode=30;break}if(g.length=65535&_,x=_=0,g.mode=15,6===P)break e;case 15:g.mode=16;case 16:if(le=g.length){if(l<le&&(le=l),f<le&&(le=f),0===le)break e;y.arraySet(C,b,h,le,u),l-=le,h+=le,f-=le,u+=le,g.length-=le;break}g.mode=12;break;case 17:for(;x<14;){if(0===l)break e;l--,_+=b[h++]<<x,x+=8}if(g.nlen=257+(31&_),x-=5,g.ndist=1+(31&(_>>>=5)),x-=5,g.ncode=4+(15&(_>>>=5)),_>>>=4,x-=4,286<g.nlen||30<g.ndist){N.msg="too many length or distance symbols",g.mode=30;break}g.have=0,g.mode=18;case 18:for(;g.have<g.ncode;){for(;x<3;){if(0===l)break e;l--,_+=b[h++]<<x,x+=8}g.lens[me[g.have++]]=7&_,_>>>=3,x-=3}for(;g.have<19;)g.lens[me[g.have++]]=0;if(g.lencode=g.lendyn,g.lenbits=7,he=M(0,g.lens,0,19,g.lencode,0,g.work,B={bits:g.lenbits}),g.lenbits=B.bits,he){N.msg="invalid code lengths set",g.mode=30;break}g.have=0,g.mode=19;case 19:for(;g.have<g.nlen+g.ndist;){for(;re=(ie=g.lencode[_&(1<<g.lenbits)-1])>>>16&255,j=65535&ie,!((O=ie>>>24)<=x);){if(0===l)break e;l--,_+=b[h++]<<x,x+=8}if(j<16)_>>>=O,x-=O,g.lens[g.have++]=j;else{if(16===j){for(R=O+2;x<R;){if(0===l)break e;l--,_+=b[h++]<<x,x+=8}if(_>>>=O,x-=O,0===g.have){N.msg="invalid bit length repeat",g.mode=30;break}ce=g.lens[g.have-1],le=3+(3&_),_>>>=2,x-=2}else if(17===j){for(R=O+3;x<R;){if(0===l)break e;l--,_+=b[h++]<<x,x+=8}x-=O,ce=0,le=3+(7&(_>>>=O)),_>>>=3,x-=3}else{for(R=O+7;x<R;){if(0===l)break e;l--,_+=b[h++]<<x,x+=8}x-=O,ce=0,le=11+(127&(_>>>=O)),_>>>=7,x-=7}if(g.have+le>g.nlen+g.ndist){N.msg="invalid bit length repeat",g.mode=30;break}for(;le--;)g.lens[g.have++]=ce}}if(30===g.mode)break;if(0===g.lens[256]){N.msg="invalid code -- missing end-of-block",g.mode=30;break}if(g.lenbits=9,he=M(1,g.lens,0,g.nlen,g.lencode,0,g.work,B={bits:g.lenbits}),g.lenbits=B.bits,he){N.msg="invalid literal/lengths set",g.mode=30;break}if(g.distbits=6,g.distcode=g.distdyn,he=M(2,g.lens,g.nlen,g.ndist,g.distcode,0,g.work,B={bits:g.distbits}),g.distbits=B.bits,he){N.msg="invalid distances set",g.mode=30;break}if(g.mode=20,6===P)break e;case 20:g.mode=21;case 21:if(6<=l&&258<=f){N.next_out=u,N.avail_out=f,N.next_in=h,N.avail_in=l,g.hold=_,g.bits=x,d(N,Q),u=N.next_out,C=N.output,f=N.avail_out,h=N.next_in,b=N.input,l=N.avail_in,_=g.hold,x=g.bits,12===g.mode&&(g.back=-1);break}for(g.back=0;re=(ie=g.lencode[_&(1<<g.lenbits)-1])>>>16&255,j=65535&ie,!((O=ie>>>24)<=x);){if(0===l)break e;l--,_+=b[h++]<<x,x+=8}if(re&&0==(240&re)){for(ve=O,de=re,Ee=j;re=(ie=g.lencode[Ee+((_&(1<<ve+de)-1)>>ve)])>>>16&255,j=65535&ie,!(ve+(O=ie>>>24)<=x);){if(0===l)break e;l--,_+=b[h++]<<x,x+=8}_>>>=ve,x-=ve,g.back+=ve}if(_>>>=O,x-=O,g.back+=O,g.length=j,0===re){g.mode=26;break}if(32&re){g.back=-1,g.mode=12;break}if(64&re){N.msg="invalid literal/length code",g.mode=30;break}g.extra=15&re,g.mode=22;case 22:if(g.extra){for(R=g.extra;x<R;){if(0===l)break e;l--,_+=b[h++]<<x,x+=8}g.length+=_&(1<<g.extra)-1,_>>>=g.extra,x-=g.extra,g.back+=g.extra}g.was=g.length,g.mode=23;case 23:for(;re=(ie=g.distcode[_&(1<<g.distbits)-1])>>>16&255,j=65535&ie,!((O=ie>>>24)<=x);){if(0===l)break e;l--,_+=b[h++]<<x,x+=8}if(0==(240&re)){for(ve=O,de=re,Ee=j;re=(ie=g.distcode[Ee+((_&(1<<ve+de)-1)>>ve)])>>>16&255,j=65535&ie,!(ve+(O=ie>>>24)<=x);){if(0===l)break e;l--,_+=b[h++]<<x,x+=8}_>>>=ve,x-=ve,g.back+=ve}if(_>>>=O,x-=O,g.back+=O,64&re){N.msg="invalid distance code",g.mode=30;break}g.offset=j,g.extra=15&re,g.mode=24;case 24:if(g.extra){for(R=g.extra;x<R;){if(0===l)break e;l--,_+=b[h++]<<x,x+=8}g.offset+=_&(1<<g.extra)-1,_>>>=g.extra,x-=g.extra,g.back+=g.extra}if(g.offset>g.dmax){N.msg="invalid distance too far back",g.mode=30;break}g.mode=25;case 25:if(0===f)break e;if(g.offset>(le=Q-f)){if((le=g.offset-le)>g.whave&&g.sane){N.msg="invalid distance too far back",g.mode=30;break}Ce=le>g.wnext?g.wsize-(le-=g.wnext):g.wnext-le,le>g.length&&(le=g.length),T=g.window}else T=C,Ce=u-g.offset,le=g.length;for(f<le&&(le=f),f-=le,g.length-=le;C[u++]=T[Ce++],--le;);0===g.length&&(g.mode=21);break;case 26:if(0===f)break e;C[u++]=g.length,f--,g.mode=21;break;case 27:if(g.wrap){for(;x<32;){if(0===l)break e;l--,_|=b[h++]<<x,x+=8}if(N.total_out+=Q-=f,g.total+=Q,Q&&(N.adler=g.check=g.flags?p(g.check,C,Q,u-Q):w(g.check,C,Q,u-Q)),Q=f,(g.flags?_:V(_))!==g.check){N.msg="incorrect data check",g.mode=30;break}x=_=0}g.mode=28;case 28:if(g.wrap&&g.flags){for(;x<32;){if(0===l)break e;l--,_+=b[h++]<<x,x+=8}if(_!==(4294967295&g.total)){N.msg="incorrect length check",g.mode=30;break}x=_=0}g.mode=29;case 29:he=1;break e;case 30:he=-3;break e;case 31:return-4;default:return F}return N.next_out=u,N.avail_out=f,N.next_in=h,N.avail_in=l,g.hold=_,g.bits=x,(g.wsize||Q!==N.avail_out&&g.mode<30&&(g.mode<27||4!==P))&&A(N,N.output,N.next_out,Q-N.avail_out)?(g.mode=31,-4):(Q-=N.avail_out,N.total_in+=S-=N.avail_in,N.total_out+=Q,g.total+=Q,g.wrap&&Q&&(N.adler=g.check=g.flags?p(g.check,C,Q,N.next_out-Q):w(g.check,C,Q,N.next_out-Q)),N.data_type=g.bits+(g.last?64:0)+(12===g.mode?128:0)+(20===g.mode||15===g.mode?256:0),(0==S&&0===Q||4===P)&&0===he&&(he=-5),he)},a.inflateEnd=function(N){if(!N||!N.state)return F;var P=N.state;return P.window&&(P.window=null),N.state=null,0},a.inflateGetHeader=function(N,P){var g;return N&&N.state?0==(2&(g=N.state).wrap)?F:((g.head=P).done=!1,0):F},a.inflateSetDictionary=function(N,P){var g,b=P.length;return N&&N.state?0!==(g=N.state).wrap&&11!==g.mode?F:11===g.mode&&w(1,P,b,0)!==g.check?-3:A(N,P,b,b)?(g.mode=31,-4):(g.havedict=1,0):F},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(ae,X,a){"use strict";var y=ae("../utils/common"),w=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],p=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],M=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];X.exports=function(v,D,$,F,oe,G,L,V){var H,se,ue,ee,Y,ne,k,q,z,A=V.bits,N=0,P=0,g=0,b=0,C=0,h=0,u=0,l=0,f=0,_=0,x=null,S=0,Q=new y.Buf16(16),le=new y.Buf16(16),Ce=null,T=0;for(N=0;N<=15;N++)Q[N]=0;for(P=0;P<F;P++)Q[D[$+P]]++;for(C=A,b=15;1<=b&&0===Q[b];b--);if(b<C&&(C=b),0===b)return oe[G++]=20971520,oe[G++]=20971520,V.bits=1,0;for(g=1;g<b&&0===Q[g];g++);for(C<g&&(C=g),N=l=1;N<=15;N++)if(l<<=1,(l-=Q[N])<0)return-1;if(0<l&&(0===v||1!==b))return-1;for(le[1]=0,N=1;N<15;N++)le[N+1]=le[N]+Q[N];for(P=0;P<F;P++)0!==D[$+P]&&(L[le[D[$+P]]++]=P);if(ne=0===v?(x=Ce=L,19):1===v?(x=w,S-=257,Ce=p,T-=257,256):(x=d,Ce=M,-1),N=g,Y=G,u=P=_=0,ue=-1,ee=(f=1<<(h=C))-1,1===v&&852<f||2===v&&592<f)return 1;for(;;){for(k=N-u,z=L[P]<ne?(q=0,L[P]):L[P]>ne?(q=Ce[T+L[P]],x[S+L[P]]):(q=96,0),H=1<<N-u,g=se=1<<h;oe[Y+(_>>u)+(se-=H)]=k<<24|q<<16|z|0,0!==se;);for(H=1<<N-1;_&H;)H>>=1;if(0!==H?(_&=H-1,_+=H):_=0,P++,0==--Q[N]){if(N===b)break;N=D[$+L[P]]}if(C<N&&(_&ee)!==ue){for(0===u&&(u=C),Y+=g,l=1<<(h=N-u);h+u<b&&!((l-=Q[h+u])<=0);)h++,l<<=1;if(f+=1<<h,1===v&&852<f||2===v&&592<f)return 1;oe[ue=_&ee]=C<<24|h<<16|Y-G|0}}return 0!==_&&(oe[Y+_]=N-u<<24|64<<16|0),V.bits=C,0}},{"../utils/common":41}],51:[function(ae,X,a){"use strict";X.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(ae,X,a){"use strict";var y=ae("../utils/common");function d(ie){for(var W=ie.length;0<=--W;)ie[W]=0}var D=256,$=286,F=30,L=15,ne=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],k=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],A=new Array(576);d(A);var N=new Array(60);d(N);var P=new Array(512);d(P);var g=new Array(256);d(g);var b=new Array(29);d(b);var C,h,u,l=new Array(F);function f(ie,W,me,$e,_e){this.static_tree=ie,this.extra_bits=W,this.extra_base=me,this.elems=$e,this.max_length=_e,this.has_stree=ie&&ie.length}function _(ie,W){this.dyn_tree=ie,this.max_code=0,this.stat_desc=W}function x(ie){return ie<256?P[ie]:P[256+(ie>>>7)]}function S(ie,W){ie.pending_buf[ie.pending++]=255&W,ie.pending_buf[ie.pending++]=W>>>8&255}function Q(ie,W,me){ie.bi_valid>16-me?(ie.bi_buf|=W<<ie.bi_valid&65535,S(ie,ie.bi_buf),ie.bi_buf=W>>16-ie.bi_valid,ie.bi_valid+=me-16):(ie.bi_buf|=W<<ie.bi_valid&65535,ie.bi_valid+=me)}function le(ie,W,me){Q(ie,me[2*W],me[2*W+1])}function Ce(ie,W){for(var me=0;me|=1&ie,ie>>>=1,me<<=1,0<--W;);return me>>>1}function T(ie,W,me){var $e,_e,Ie=new Array(16),Pe=0;for($e=1;$e<=L;$e++)Ie[$e]=Pe=Pe+me[$e-1]<<1;for(_e=0;_e<=W;_e++){var Ae=ie[2*_e+1];0!==Ae&&(ie[2*_e]=Ce(Ie[Ae]++,Ae))}}function O(ie){var W;for(W=0;W<$;W++)ie.dyn_ltree[2*W]=0;for(W=0;W<F;W++)ie.dyn_dtree[2*W]=0;for(W=0;W<19;W++)ie.bl_tree[2*W]=0;ie.dyn_ltree[512]=1,ie.opt_len=ie.static_len=0,ie.last_lit=ie.matches=0}function re(ie){8<ie.bi_valid?S(ie,ie.bi_buf):0<ie.bi_valid&&(ie.pending_buf[ie.pending++]=ie.bi_buf),ie.bi_buf=0,ie.bi_valid=0}function j(ie,W,me,$e){var _e=2*W,Ie=2*me;return ie[_e]<ie[Ie]||ie[_e]===ie[Ie]&&$e[W]<=$e[me]}function ve(ie,W,me){for(var $e=ie.heap[me],_e=me<<1;_e<=ie.heap_len&&(_e<ie.heap_len&&j(W,ie.heap[_e+1],ie.heap[_e],ie.depth)&&_e++,!j(W,$e,ie.heap[_e],ie.depth));)ie.heap[me]=ie.heap[_e],me=_e,_e<<=1;ie.heap[me]=$e}function de(ie,W,me){var $e,_e,Ie,Pe,Ae=0;if(0!==ie.last_lit)for(;$e=ie.pending_buf[ie.d_buf+2*Ae]<<8|ie.pending_buf[ie.d_buf+2*Ae+1],_e=ie.pending_buf[ie.l_buf+Ae],Ae++,0===$e?le(ie,_e,W):(le(ie,(Ie=g[_e])+D+1,W),0!==(Pe=ne[Ie])&&Q(ie,_e-=b[Ie],Pe),le(ie,Ie=x(--$e),me),0!==(Pe=k[Ie])&&Q(ie,$e-=l[Ie],Pe)),Ae<ie.last_lit;);le(ie,256,W)}function Ee(ie,W){var me,$e,_e,Ie=W.dyn_tree,Pe=W.stat_desc.static_tree,Ae=W.stat_desc.has_stree,Ne=W.stat_desc.elems,We=-1;for(ie.heap_len=0,ie.heap_max=573,me=0;me<Ne;me++)0!==Ie[2*me]?(ie.heap[++ie.heap_len]=We=me,ie.depth[me]=0):Ie[2*me+1]=0;for(;ie.heap_len<2;)Ie[2*(_e=ie.heap[++ie.heap_len]=We<2?++We:0)]=1,ie.depth[_e]=0,ie.opt_len--,Ae&&(ie.static_len-=Pe[2*_e+1]);for(W.max_code=We,me=ie.heap_len>>1;1<=me;me--)ve(ie,Ie,me);for(_e=Ne;me=ie.heap[1],ie.heap[1]=ie.heap[ie.heap_len--],ve(ie,Ie,1),$e=ie.heap[1],ie.heap[--ie.heap_max]=me,ie.heap[--ie.heap_max]=$e,Ie[2*_e]=Ie[2*me]+Ie[2*$e],ie.depth[_e]=(ie.depth[me]>=ie.depth[$e]?ie.depth[me]:ie.depth[$e])+1,Ie[2*me+1]=Ie[2*$e+1]=_e,ie.heap[1]=_e++,ve(ie,Ie,1),2<=ie.heap_len;);ie.heap[--ie.heap_max]=ie.heap[1],function(nt,Nt){var jt,Ot,mt,$t,cr,Vo,Vr=Nt.dyn_tree,Tu=Nt.max_code,mf=Nt.stat_desc.static_tree,sl=Nt.stat_desc.has_stree,ec=Nt.stat_desc.extra_bits,ol=Nt.stat_desc.extra_base,ss=Nt.stat_desc.max_length,Go=0;for($t=0;$t<=L;$t++)nt.bl_count[$t]=0;for(Vr[2*nt.heap[nt.heap_max]+1]=0,jt=nt.heap_max+1;jt<573;jt++)ss<($t=Vr[2*Vr[2*(Ot=nt.heap[jt])+1]+1]+1)&&($t=ss,Go++),Vr[2*Ot+1]=$t,Tu<Ot||(nt.bl_count[$t]++,cr=0,ol<=Ot&&(cr=ec[Ot-ol]),nt.opt_len+=(Vo=Vr[2*Ot])*($t+cr),sl&&(nt.static_len+=Vo*(mf[2*Ot+1]+cr)));if(0!==Go){do{for($t=ss-1;0===nt.bl_count[$t];)$t--;nt.bl_count[$t]--,nt.bl_count[$t+1]+=2,nt.bl_count[ss]--,Go-=2}while(0<Go);for($t=ss;0!==$t;$t--)for(Ot=nt.bl_count[$t];0!==Ot;)Tu<(mt=nt.heap[--jt])||(Vr[2*mt+1]!==$t&&(nt.opt_len+=($t-Vr[2*mt+1])*Vr[2*mt],Vr[2*mt+1]=$t),Ot--)}}(ie,W),T(Ie,We,ie.bl_count)}function ce(ie,W,me){var $e,_e,Ie=-1,Pe=W[1],Ae=0,Ne=7,We=4;for(0===Pe&&(Ne=138,We=3),W[2*(me+1)+1]=65535,$e=0;$e<=me;$e++)_e=Pe,Pe=W[2*($e+1)+1],++Ae<Ne&&_e===Pe||(Ae<We?ie.bl_tree[2*_e]+=Ae:0!==_e?(_e!==Ie&&ie.bl_tree[2*_e]++,ie.bl_tree[32]++):Ae<=10?ie.bl_tree[34]++:ie.bl_tree[36]++,Ie=_e,We=(Ae=0)===Pe?(Ne=138,3):_e===Pe?(Ne=6,3):(Ne=7,4))}function he(ie,W,me){var $e,_e,Ie=-1,Pe=W[1],Ae=0,Ne=7,We=4;for(0===Pe&&(Ne=138,We=3),$e=0;$e<=me;$e++)if(_e=Pe,Pe=W[2*($e+1)+1],!(++Ae<Ne&&_e===Pe)){if(Ae<We)for(;le(ie,_e,ie.bl_tree),0!=--Ae;);else 0!==_e?(_e!==Ie&&(le(ie,_e,ie.bl_tree),Ae--),le(ie,16,ie.bl_tree),Q(ie,Ae-3,2)):Ae<=10?(le(ie,17,ie.bl_tree),Q(ie,Ae-3,3)):(le(ie,18,ie.bl_tree),Q(ie,Ae-11,7));Ie=_e,We=(Ae=0)===Pe?(Ne=138,3):_e===Pe?(Ne=6,3):(Ne=7,4)}}d(l);var B=!1;function R(ie,W,me,$e){var _e,Ie,Pe;Q(ie,0+($e?1:0),3),Ie=W,Pe=me,re(_e=ie),S(_e,Pe),S(_e,~Pe),y.arraySet(_e.pending_buf,_e.window,Ie,Pe,_e.pending),_e.pending+=Pe}a._tr_init=function(ie){B||(function(){var W,me,$e,_e,Ie,Pe=new Array(16);for(_e=$e=0;_e<28;_e++)for(b[_e]=$e,W=0;W<1<<ne[_e];W++)g[$e++]=_e;for(g[$e-1]=_e,_e=Ie=0;_e<16;_e++)for(l[_e]=Ie,W=0;W<1<<k[_e];W++)P[Ie++]=_e;for(Ie>>=7;_e<F;_e++)for(l[_e]=Ie<<7,W=0;W<1<<k[_e]-7;W++)P[256+Ie++]=_e;for(me=0;me<=L;me++)Pe[me]=0;for(W=0;W<=143;)A[2*W+1]=8,W++,Pe[8]++;for(;W<=255;)A[2*W+1]=9,W++,Pe[9]++;for(;W<=279;)A[2*W+1]=7,W++,Pe[7]++;for(;W<=287;)A[2*W+1]=8,W++,Pe[8]++;for(T(A,287,Pe),W=0;W<F;W++)N[2*W+1]=5,N[2*W]=Ce(W,5);C=new f(A,ne,257,$,L),h=new f(N,k,0,F,L),u=new f(new Array(0),q,0,19,7)}(),B=!0),ie.l_desc=new _(ie.dyn_ltree,C),ie.d_desc=new _(ie.dyn_dtree,h),ie.bl_desc=new _(ie.bl_tree,u),ie.bi_buf=0,ie.bi_valid=0,O(ie)},a._tr_stored_block=R,a._tr_flush_block=function(ie,W,me,$e){var _e,Ie,Pe=0;0<ie.level?(2===ie.strm.data_type&&(ie.strm.data_type=function(Ae){var Ne,We=4093624447;for(Ne=0;Ne<=31;Ne++,We>>>=1)if(1&We&&0!==Ae.dyn_ltree[2*Ne])return 0;if(0!==Ae.dyn_ltree[18]||0!==Ae.dyn_ltree[20]||0!==Ae.dyn_ltree[26])return 1;for(Ne=32;Ne<D;Ne++)if(0!==Ae.dyn_ltree[2*Ne])return 1;return 0}(ie)),Ee(ie,ie.l_desc),Ee(ie,ie.d_desc),Pe=function(Ae){var Ne;for(ce(Ae,Ae.dyn_ltree,Ae.l_desc.max_code),ce(Ae,Ae.dyn_dtree,Ae.d_desc.max_code),Ee(Ae,Ae.bl_desc),Ne=18;3<=Ne&&0===Ae.bl_tree[2*z[Ne]+1];Ne--);return Ae.opt_len+=3*(Ne+1)+5+5+4,Ne}(ie),(Ie=ie.static_len+3+7>>>3)<=(_e=ie.opt_len+3+7>>>3)&&(_e=Ie)):_e=Ie=me+5,me+4<=_e&&-1!==W?R(ie,W,me,$e):4===ie.strategy||Ie===_e?(Q(ie,2+($e?1:0),3),de(ie,A,N)):(Q(ie,4+($e?1:0),3),function(Ae,Ne,We,nt){var Nt;for(Q(Ae,Ne-257,5),Q(Ae,We-1,5),Q(Ae,nt-4,4),Nt=0;Nt<nt;Nt++)Q(Ae,Ae.bl_tree[2*z[Nt]+1],3);he(Ae,Ae.dyn_ltree,Ne-1),he(Ae,Ae.dyn_dtree,We-1)}(ie,ie.l_desc.max_code+1,ie.d_desc.max_code+1,Pe+1),de(ie,ie.dyn_ltree,ie.dyn_dtree)),O(ie),$e&&re(ie)},a._tr_tally=function(ie,W,me){return ie.pending_buf[ie.d_buf+2*ie.last_lit]=W>>>8&255,ie.pending_buf[ie.d_buf+2*ie.last_lit+1]=255&W,ie.pending_buf[ie.l_buf+ie.last_lit]=255&me,ie.last_lit++,0===W?ie.dyn_ltree[2*me]++:(ie.matches++,W--,ie.dyn_ltree[2*(g[me]+D+1)]++,ie.dyn_dtree[2*x(W)]++),ie.last_lit===ie.lit_bufsize-1},a._tr_align=function(ie){var W;Q(ie,2,3),le(ie,256,A),16===(W=ie).bi_valid?(S(W,W.bi_buf),W.bi_buf=0,W.bi_valid=0):8<=W.bi_valid&&(W.pending_buf[W.pending++]=255&W.bi_buf,W.bi_buf>>=8,W.bi_valid-=8)}},{"../utils/common":41}],53:[function(ae,X,a){"use strict";X.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(ae,X,a){(function(y){!function(w,p){"use strict";if(!w.setImmediate){var d,M,v,D,$=1,F={},oe=!1,G=w.document,L=Object.getPrototypeOf&&Object.getPrototypeOf(w);L=L&&L.setTimeout?L:w,d="[object process]"==={}.toString.call(w.process)?function(ue){process.nextTick(function(){H(ue)})}:function(){if(w.postMessage&&!w.importScripts){var ue=!0,ee=w.onmessage;return w.onmessage=function(){ue=!1},w.postMessage("","*"),w.onmessage=ee,ue}}()?(D="setImmediate$"+Math.random()+"$",w.addEventListener?w.addEventListener("message",se,!1):w.attachEvent("onmessage",se),function(ue){w.postMessage(D+ue,"*")}):w.MessageChannel?((v=new MessageChannel).port1.onmessage=function(ue){H(ue.data)},function(ue){v.port2.postMessage(ue)}):G&&"onreadystatechange"in G.createElement("script")?(M=G.documentElement,function(ue){var ee=G.createElement("script");ee.onreadystatechange=function(){H(ue),ee.onreadystatechange=null,M.removeChild(ee),ee=null},M.appendChild(ee)}):function(ue){setTimeout(H,0,ue)},L.setImmediate=function(ue){"function"!=typeof ue&&(ue=new Function(""+ue));for(var ee=new Array(arguments.length-1),Y=0;Y<ee.length;Y++)ee[Y]=arguments[Y+1];return F[$]={callback:ue,args:ee},d($),$++},L.clearImmediate=V}function V(ue){delete F[ue]}function H(ue){if(oe)setTimeout(H,0,ue);else{var ee=F[ue];if(ee){oe=!0;try{!function(Y){var ne=Y.callback,k=Y.args;switch(k.length){case 0:ne();break;case 1:ne(k[0]);break;case 2:ne(k[0],k[1]);break;case 3:ne(k[0],k[1],k[2]);break;default:ne.apply(undefined,k)}}(ee)}finally{V(ue),oe=!1}}}}function se(ue){ue.source===w&&"string"==typeof ue.data&&0===ue.data.indexOf(D)&&H(+ue.data.slice(D.length))}}("undefined"==typeof self?void 0===y?this:y:self)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)},9263:(E,ae,X)=>{var a=X(9209),y=X(966);function w(p){this._init(p)}w.prototype={_init:function(p){p=p||{},this._data=null,this._table=null,this._result=null,this._onDataCallback=p.onData,this._onEndCallback=p.onEnd},_createTable:function(){for(var p=y.createBuffer(8,a.TABLE_LENGTH),d=0;d<a.TABLE_LENGTH;d++)p[d]=a.BASE62TABLE.charCodeAt(d);return p},_onData:function(p,d){var M=y.bufferToString_fast(p,d);this._onDataCallback?this._onDataCallback(M):this._result+=M},_onEnd:function(){this._onEndCallback&&this._onEndCallback(),this._data=this._table=null},_search:function(){var p=2,d=this._data,M=this._offset,v=a.BUFFER_MAX;if(this._dataLen-M<v&&(v=this._dataLen-M),p>v)return!1;var oe,G,L,V,H,D=M-a.WINDOW_BUFFER_MAX,$=d.substring(D,M+v),F=M+p-3-D;do{if(2===p){if(G=d.charAt(M)+d.charAt(M+1),!~(L=$.indexOf(G))||L>F)break}else 3===p?G+=d.charAt(M+2):G=d.substr(M,p);if(!~(V=a.STRING_LASTINDEXOF_BUG?d.substring(D,M+p-1).lastIndexOf(G):$.lastIndexOf(G,F)))break;H=V,oe=D+V;do{if(d.charCodeAt(M+p)!==d.charCodeAt(oe+p))break}while(++p<v);if(L===V){p++;break}}while(++p<v);return 2!==p&&(this._index=a.WINDOW_BUFFER_MAX-H,this._length=p-1,!0)},compress:function(p){if(null==p||0===p.length)return"";var d,M=this._createTable(),v=y.createWindow(),D=y.createBuffer(8,a.COMPRESS_CHUNK_SIZE),$=0;this._result="",this._offset=v.length,this._data=v+p,this._dataLen=this._data.length,v=p=null;for(var G,L,V,H,se,F=-1,oe=-1;this._offset<this._dataLen;)this._search()?(this._index<a.BUFFER_MAX?(L=this._index,V=0):V=(this._index-(L=this._index%a.BUFFER_MAX))/a.BUFFER_MAX,2===this._length?(D[$++]=M[V+a.COMPRESS_FIXED_START],D[$++]=M[L]):(D[$++]=M[V+a.COMPRESS_START],D[$++]=M[L],D[$++]=M[this._length]),this._offset+=this._length,~oe&&(oe=-1)):(G=this._data.charCodeAt(this._offset++))<a.LATIN_BUFFER_MAX?(G<a.UNICODE_CHAR_MAX?(L=G,V=0,F=a.LATIN_INDEX):F=(V=(G-(L=G%a.UNICODE_CHAR_MAX))/a.UNICODE_CHAR_MAX)+a.LATIN_INDEX,oe===F?D[$++]=M[L]:(D[$++]=M[F-a.LATIN_INDEX_START],D[$++]=M[L],oe=F)):(G<a.UNICODE_BUFFER_MAX?(L=G,V=0,F=a.UNICODE_INDEX):F=(V=(G-(L=G%a.UNICODE_BUFFER_MAX))/a.UNICODE_BUFFER_MAX)+a.UNICODE_INDEX,L<a.UNICODE_CHAR_MAX?(H=L,se=0):se=(L-(H=L%a.UNICODE_CHAR_MAX))/a.UNICODE_CHAR_MAX,oe===F?(D[$++]=M[H],D[$++]=M[se]):(D[$++]=M[a.CHAR_START],D[$++]=M[F-a.TABLE_LENGTH],D[$++]=M[H],D[$++]=M[se],oe=F)),$>=a.COMPRESS_CHUNK_MAX&&(this._onData(D,$),$=0);return $>0&&this._onData(D,$),this._onEnd(),d=this._result,this._result=null,null===d?"":d}},E.exports=w},9209:(E,ae)=>{var X=ae.HAS_TYPED="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array,a=!1,y=!1;try{"a"===String.fromCharCode.apply(null,[97])&&(a=!0)}catch(ue){}if(X)try{"a"===String.fromCharCode.apply(null,new Uint8Array([97]))&&(y=!0)}catch(ue){}ae.CAN_CHARCODE_APPLY=a,ae.CAN_CHARCODE_APPLY_TYPED=y;var w=ae.APPLY_BUFFER_SIZE=65533;ae.APPLY_BUFFER_SIZE_OK=null;var p=!1;-1!=="abc\u307b\u3052".lastIndexOf("\u307b\u3052",1)&&(p=!0),ae.STRING_LASTINDEXOF_BUG=p;var d=ae.BASE62TABLE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",M=ae.TABLE_LENGTH=d.length,v=Math.max(M,62)-Math.min(M,62);ae.BUFFER_MAX=M-1;var D=ae.WINDOW_MAX=1024;ae.WINDOW_BUFFER_MAX=304;var $=ae.COMPRESS_CHUNK_SIZE=w;ae.COMPRESS_CHUNK_MAX=$-M;var F=ae.DECOMPRESS_CHUNK_SIZE=w;ae.DECOMPRESS_CHUNK_MAX=F+2*D,ae.LATIN_BUFFER_MAX=132;var G=ae.UNICODE_CHAR_MAX=40;ae.UNICODE_BUFFER_MAX=G*(G+1),ae.LATIN_INDEX=M+1,ae.LATIN_INDEX_START=v+20,ae.UNICODE_INDEX=M+5,ae.DECODE_MAX=M-v-19;var L=ae.LATIN_DECODE_MAX=G+7,V=ae.CHAR_START=L+1,H=ae.COMPRESS_START=V+1,se=ae.COMPRESS_FIXED_START=H+5;ae.COMPRESS_INDEX=se+5},9727:(E,ae,X)=>{var a=X(9209),y=X(966);function w(p){this._init(p)}w.prototype={_init:function(p){p=p||{},this._result=null,this._onDataCallback=p.onData,this._onEndCallback=p.onEnd},_createTable:function(){for(var p={},d=0;d<a.TABLE_LENGTH;d++)p[a.BASE62TABLE.charAt(d)]=d;return p},_onData:function(p){var d;if(this._onDataCallback){if(p)d=this._result,this._result=[];else{var M=a.DECOMPRESS_CHUNK_SIZE-a.WINDOW_MAX;d=this._result.slice(a.WINDOW_MAX,a.WINDOW_MAX+M),this._result=this._result.slice(0,a.WINDOW_MAX).concat(this._result.slice(a.WINDOW_MAX+M))}d.length>0&&this._onDataCallback(y.bufferToString_fast(d))}},_onEnd:function(){this._onEndCallback&&this._onEndCallback()},decompress:function(p){if(null==p||0===p.length)return"";this._result=y.stringToArray(y.createWindow());for(var d,oe,G,L,H,se,ue,ee,Y,ne,M=this._createTable(),v=!1,D=null,$=p.length,F=0;F<$;F++)if(void 0!==(G=M[p.charAt(F)])){if(G<a.DECODE_MAX)H=v?M[p.charAt(++F)]*a.UNICODE_CHAR_MAX+G+a.UNICODE_BUFFER_MAX*D:D*a.UNICODE_CHAR_MAX+G,this._result[this._result.length]=H;else if(G<a.LATIN_DECODE_MAX)D=G-a.DECODE_MAX,v=!1;else if(G===a.CHAR_START)D=(L=M[p.charAt(++F)])-5,v=!0;else if(G<a.COMPRESS_INDEX){if(L=M[p.charAt(++F)],G<a.COMPRESS_FIXED_START?(se=(G-a.COMPRESS_START)*a.BUFFER_MAX+L,ue=M[p.charAt(++F)]):(se=(G-a.COMPRESS_FIXED_START)*a.BUFFER_MAX+L,ue=2),(ee=this._result.slice(-se)).length>ue&&(ee.length=ue),Y=ee.length,ee.length>0)for(ne=0;ne<ue;)for(oe=0;oe<Y&&(this._result[this._result.length]=ee[oe],!(++ne>=ue));oe++);D=null}this._result.length>=a.DECOMPRESS_CHUNK_MAX&&this._onData()}return this._result=this._result.slice(a.WINDOW_MAX),this._onData(!0),this._onEnd(),d=y.bufferToString_fast(this._result),this._result=null,d}},E.exports=w},8497:(E,ae,X)=>{var a=X(9263),y=X(9727);X(1014),ae.n=function(w,p){return new a(p).compress(w)},ae.L=function(w,p){return new y(p).decompress(w)}},966:(E,ae,X)=>{var a=X(9209),y=String.fromCharCode;ae.createBuffer=function(M,v){if(!a.HAS_TYPED)return new Array(v);switch(M){case 8:return new Uint8Array(v);case 16:return new Uint16Array(v)}};var w=ae.truncateBuffer=function(M,v){return M.length===v?M:M.subarray?M.subarray(0,v):(M.length=v,M)};ae.bufferToString_fast=function(M,v){if(null==v?v=M.length:M=w(M,v),a.CAN_CHARCODE_APPLY&&a.CAN_CHARCODE_APPLY_TYPED){var D=M.length;if(D<a.APPLY_BUFFER_SIZE&&a.APPLY_BUFFER_SIZE_OK)return y.apply(null,M);if(null===a.APPLY_BUFFER_SIZE_OK)try{var $=y.apply(null,M);return D>a.APPLY_BUFFER_SIZE&&(a.APPLY_BUFFER_SIZE_OK=!0),$}catch(F){a.APPLY_BUFFER_SIZE_OK=!1}}return p(M)};var p=ae.bufferToString_chunked=function(M){for(var F,v="",D=M.length,$=0;$<D;){if(F=M.subarray?M.subarray($,$+a.APPLY_BUFFER_SIZE):M.slice($,$+a.APPLY_BUFFER_SIZE),$+=a.APPLY_BUFFER_SIZE,!a.APPLY_BUFFER_SIZE_OK){if(null===a.APPLY_BUFFER_SIZE_OK)try{v+=y.apply(null,F),F.length>a.APPLY_BUFFER_SIZE&&(a.APPLY_BUFFER_SIZE_OK=!0);continue}catch(oe){a.APPLY_BUFFER_SIZE_OK=!1}return d(M)}v+=y.apply(null,F)}return v},d=ae.bufferToString_slow=function(M){for(var v="",D=M.length,$=0;$<D;$++)v+=y(M[$]);return v};ae.stringToArray=function(M){for(var v=[],D=M&&M.length,$=0;$<D;$++)v[$]=M.charCodeAt($);return v},ae.createWindow=function(){for(var M=a.WINDOW_MAX>>7,v="        ";!(M&a.WINDOW_MAX);)v+=v,M<<=1;return v}},2391:(E,ae,X)=>{ae.encode=X(8048).encode,ae.decode=X(9175).decode,X(7704),X(8131),X(1490),X(9234)},2295:function(E){function ae(X){return X&&X.isBuffer&&X}E.exports=ae("undefined"!=typeof Buffer&&Buffer)||ae(this.Buffer)||ae("undefined"!=typeof window&&window.Buffer)||this.Buffer},7625:(E,ae)=>{ae.copy=function w(p,d,M,v){var D;M||(M=0),!v&&0!==v&&(v=this.length),d||(d=0);var $=v-M;if(p===this&&M<d&&d<v)for(D=$-1;D>=0;D--)p[D+d]=this[D+M];else for(D=0;D<$;D++)p[D+d]=this[D+M];return $},ae.toString=function y(p,d,M){var v=this,D=0|d;M||(M=v.length);for(var $="",F=0;D<M;)(F=v[D++])<128?$+=String.fromCharCode(F):(192==(224&F)?F=(31&F)<<6|63&v[D++]:224==(240&F)?F=(15&F)<<12|(63&v[D++])<<6|63&v[D++]:240==(248&F)&&(F=(7&F)<<18|(63&v[D++])<<12|(63&v[D++])<<6|63&v[D++]),F>=65536?(F-=65536,$+=String.fromCharCode(55296+(F>>>10),56320+(1023&F))):$+=String.fromCharCode(F));return $},ae.write=function a(p,d){for(var M=this,v=d||(d|=0),D=p.length,$=0,F=0;F<D;)($=p.charCodeAt(F++))<128?M[v++]=$:$<2048?(M[v++]=192|$>>>6,M[v++]=128|63&$):$<55296||$>57343?(M[v++]=224|$>>>12,M[v++]=128|$>>>6&63,M[v++]=128|63&$):($=65536+($-55296<<10|p.charCodeAt(F++)-56320),M[v++]=240|$>>>18,M[v++]=128|$>>>12&63,M[v++]=128|$>>>6&63,M[v++]=128|63&$);return v-d}},1864:(E,ae,X)=>{var a=X(6093),y=E.exports=w(0);function w(d){return new Array(d)}y.alloc=w,y.concat=a.concat,y.from=function p(d){if(!a.isBuffer(d)&&a.isView(d))d=a.Uint8Array.from(d);else if(a.isArrayBuffer(d))d=new Uint8Array(d);else{if("string"==typeof d)return a.from.call(y,d);if("number"==typeof d)throw new TypeError('"value" argument must not be a number')}return Array.prototype.slice.call(d)}},1884:(E,ae,X)=>{var a=X(6093),y=a.global,w=E.exports=a.hasBuffer?p(0):[];function p(M){return new y(M)}w.alloc=a.hasBuffer&&y.alloc||p,w.concat=a.concat,w.from=function d(M){if(!a.isBuffer(M)&&a.isView(M))M=a.Uint8Array.from(M);else if(a.isArrayBuffer(M))M=new Uint8Array(M);else{if("string"==typeof M)return a.from.call(w,M);if("number"==typeof M)throw new TypeError('"value" argument must not be a number')}return y.from&&1!==y.from.length?y.from(M):new y(M)}},5364:(E,ae,X)=>{var a=X(7625);ae.copy=M,ae.slice=v,ae.toString=function D(F,oe,G){var L=!p&&y.isBuffer(this)?this.toString:a.toString;return L.apply(this,arguments)},ae.write=function $(F){return function oe(){return(this[F]||a[F]).apply(this,arguments)}}("write");var y=X(6093),w=y.global,p=y.hasBuffer&&"TYPED_ARRAY_SUPPORT"in w,d=p&&!w.TYPED_ARRAY_SUPPORT;function M(F,oe,G,L){var V=y.isBuffer(this),H=y.isBuffer(F);if(V&&H)return this.copy(F,oe,G,L);if(d||V||H||!y.isView(this)||!y.isView(F))return a.copy.call(this,F,oe,G,L);var se=G||null!=L?v.call(this,G,L):this;return F.set(se,oe),se.length}function v(F,oe){var G=this.slice||!d&&this.subarray;if(G)return G.call(this,F,oe);var L=y.alloc.call(this,oe-F);return M.call(this,L,0,F,oe),L}},5321:(E,ae,X)=>{var a=X(6093),y=E.exports=a.hasArrayBuffer?w(0):[];function w(d){return new Uint8Array(d)}y.alloc=w,y.concat=a.concat,y.from=function p(d){if(a.isView(d)){var M=d.byteOffset,v=d.byteLength;(d=d.buffer).byteLength!==v&&(d.slice?d=d.slice(M,M+v):(d=new Uint8Array(d)).byteLength!==v&&(d=Array.prototype.slice.call(d,M,M+v)))}else{if("string"==typeof d)return a.from.call(y,d);if("number"==typeof d)throw new TypeError('"value" argument must not be a number')}return new Uint8Array(d)}},6093:(E,ae,X)=>{var a=ae.global=X(2295),y=ae.hasBuffer=a&&!!a.isBuffer,w=ae.hasArrayBuffer="undefined"!=typeof ArrayBuffer,p=ae.isArray=X(6425);ae.isArrayBuffer=w?function H(ne){return ne instanceof ArrayBuffer||V(ne)}:ee;var d=ae.isBuffer=y?a.isBuffer:ee,M=ae.isView=w?ArrayBuffer.isView||Y("ArrayBuffer","buffer"):ee;ae.alloc=G,ae.concat=function L(ne,k){k||(k=0,Array.prototype.forEach.call(ne,function N(g){k+=g.length}));var z=G.call(this!==ae&&this||ne[0],k),A=0;return Array.prototype.forEach.call(ne,function P(g){A+=F.copy.call(g,z,A)}),z},ae.from=function oe(ne){return"string"==typeof ne?se.call(this,ne):ue(this).from(ne)};var v=ae.Array=X(1864),D=ae.Buffer=X(1884),$=ae.Uint8Array=X(5321),F=ae.prototype=X(5364);function G(ne){return ue(this).alloc(ne)}var V=Y("ArrayBuffer");function se(ne){var k=3*ne.length,q=G.call(this,k),z=F.write.call(q,ne);return k!==z&&(q=F.slice.call(q,0,z)),q}function ue(ne){return d(ne)?D:M(ne)?$:p(ne)?v:y?D:w?$:v}function ee(){return!1}function Y(ne,k){return ne="[object "+ne+"]",function(q){return null!=q&&{}.toString.call(k?q[k]:q)===ne}}},5166:(E,ae,X)=>{var a=X(6425);ae.createCodec=D,ae.install=function p($){for(var F in $)w.prototype[F]=d(w.prototype[F],$[F])},ae.filter=function v($){return a($)?function M($){return $=$.slice(),function(oe){return $.reduce(F,oe)};function F(oe,G){return G(oe)}}($):$};var y=X(6093);function w($){if(!(this instanceof w))return new w($);this.options=$,this.init()}function d($,F){return $&&F?function oe(){return $.apply(this,arguments),F.apply(this,arguments)}:$||F}function D($){return new w($)}w.prototype.init=function(){var $=this.options;return $&&$.uint8array&&(this.bufferish=y.Uint8Array),this},ae.preset=D({preset:!0})},9234:(E,ae,X)=>{X(8334),X(2732),X(5166)},5333:(E,ae,X)=>{ae.T=w;var a=X(8334).preset;function w(p){if(!(this instanceof w))return new w(p);if(p&&(this.options=p,p.codec)){var d=this.codec=p.codec;d.bufferish&&(this.bufferish=d.bufferish)}}X(6473).k.mixin(w.prototype),w.prototype.codec=a,w.prototype.fetch=function(){return this.codec.decode(this)}},9175:(E,ae,X)=>{ae.decode=function y(w,p){var d=new a(p);return d.write(w),d.read()};var a=X(5333).T},8131:(E,ae,X)=>{var y=X(6654),w=X(5333).T;function p(d){if(!(this instanceof p))return new p(d);w.call(this,d)}p.prototype=new w,y.mixin(p.prototype),p.prototype.decode=function(d){arguments.length&&this.write(d),this.flush()},p.prototype.push=function(d){this.emit("data",d)},p.prototype.end=function(d){this.decode(d),this.emit("end")}},8400:(E,ae,X)=>{ae.F=w;var a=X(2732).preset;function w(p){if(!(this instanceof w))return new w(p);if(p&&(this.options=p,p.codec)){var d=this.codec=p.codec;d.bufferish&&(this.bufferish=d.bufferish)}}X(6473).I.mixin(w.prototype),w.prototype.codec=a,w.prototype.write=function(p){this.codec.encode(this,p)}},8048:(E,ae,X)=>{ae.encode=function y(w,p){var d=new a(p);return d.write(w),d.read()};var a=X(8400).F},7704:(E,ae,X)=>{var y=X(6654),w=X(8400).F;function p(d){if(!(this instanceof p))return new p(d);w.call(this,d)}p.prototype=new w,y.mixin(p.prototype),p.prototype.encode=function(d){this.write(d),this.emit("data",this.read())},p.prototype.end=function(d){arguments.length&&this.encode(d),this.flush(),this.emit("end")}},7846:(E,ae,X)=>{ae.S=function y(w,p){if(!(this instanceof y))return new y(w,p);this.buffer=a.from(w),this.type=p};var a=X(6093)},4106:(E,ae,X)=>{ae.setExtPackers=function M(oe){oe.addExtPacker(14,Error,[F,v]),oe.addExtPacker(1,EvalError,[F,v]),oe.addExtPacker(2,RangeError,[F,v]),oe.addExtPacker(3,ReferenceError,[F,v]),oe.addExtPacker(4,SyntaxError,[F,v]),oe.addExtPacker(5,TypeError,[F,v]),oe.addExtPacker(6,URIError,[F,v]),oe.addExtPacker(10,RegExp,[$,v]),oe.addExtPacker(11,Boolean,[D,v]),oe.addExtPacker(12,String,[D,v]),oe.addExtPacker(13,Date,[Number,v]),oe.addExtPacker(15,Number,[D,v]),"undefined"!=typeof Uint8Array&&(oe.addExtPacker(17,Int8Array,w),oe.addExtPacker(18,Uint8Array,w),oe.addExtPacker(19,Int16Array,w),oe.addExtPacker(20,Uint16Array,w),oe.addExtPacker(21,Int32Array,w),oe.addExtPacker(22,Uint32Array,w),oe.addExtPacker(23,Float32Array,w),"undefined"!=typeof Float64Array&&oe.addExtPacker(24,Float64Array,w),"undefined"!=typeof Uint8ClampedArray&&oe.addExtPacker(25,Uint8ClampedArray,w),oe.addExtPacker(26,ArrayBuffer,w),oe.addExtPacker(29,DataView,w)),a.hasBuffer&&oe.addExtPacker(27,y,a.from)};var p,a=X(6093),y=a.global,w=a.Uint8Array.from,d={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function v(oe){return p||(p=X(8048).encode),p(oe)}function D(oe){return oe.valueOf()}function $(oe){(oe=RegExp.prototype.toString.call(oe).split("/")).shift();var G=[oe.pop()];return G.unshift(oe.join("/")),G}function F(oe){var G={};for(var L in d)G[L]=oe[L];return G}},9146:(E,ae,X)=>{ae.setExtUnpackers=function d(oe){oe.addExtUnpacker(14,[M,D(Error)]),oe.addExtUnpacker(1,[M,D(EvalError)]),oe.addExtUnpacker(2,[M,D(RangeError)]),oe.addExtUnpacker(3,[M,D(ReferenceError)]),oe.addExtUnpacker(4,[M,D(SyntaxError)]),oe.addExtUnpacker(5,[M,D(TypeError)]),oe.addExtUnpacker(6,[M,D(URIError)]),oe.addExtUnpacker(10,[M,v]),oe.addExtUnpacker(11,[M,$(Boolean)]),oe.addExtUnpacker(12,[M,$(String)]),oe.addExtUnpacker(13,[M,$(Date)]),oe.addExtUnpacker(15,[M,$(Number)]),"undefined"!=typeof Uint8Array&&(oe.addExtUnpacker(17,$(Int8Array)),oe.addExtUnpacker(18,$(Uint8Array)),oe.addExtUnpacker(19,[F,$(Int16Array)]),oe.addExtUnpacker(20,[F,$(Uint16Array)]),oe.addExtUnpacker(21,[F,$(Int32Array)]),oe.addExtUnpacker(22,[F,$(Uint32Array)]),oe.addExtUnpacker(23,[F,$(Float32Array)]),"undefined"!=typeof Float64Array&&oe.addExtUnpacker(24,[F,$(Float64Array)]),"undefined"!=typeof Uint8ClampedArray&&oe.addExtUnpacker(25,$(Uint8ClampedArray)),oe.addExtUnpacker(26,F),oe.addExtUnpacker(29,[F,$(DataView)])),a.hasBuffer&&oe.addExtUnpacker(27,$(y))};var w,a=X(6093),y=a.global,p={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function M(oe){return w||(w=X(9175).decode),w(oe)}function v(oe){return RegExp.apply(null,oe)}function D(oe){return function(G){var L=new oe;for(var V in p)L[V]=G[V];return L}}function $(oe){return function(G){return new oe(G)}}function F(oe){return new Uint8Array(oe).buffer}},1490:(E,ae,X)=>{X(8334),X(2732),X(5166)},6473:(E,ae,X)=>{ae.k=d,ae.I=M;var a=X(6093),p="BUFFER_SHORTAGE";function d(){if(!(this instanceof d))return new d}function M(){if(!(this instanceof M))return new M}function $(){throw new Error("method not implemented: write()")}function F(){throw new Error("method not implemented: fetch()")}function oe(){return this.buffers&&this.buffers.length?(this.flush(),this.pull()):this.fetch()}function G(H){(this.buffers||(this.buffers=[])).push(H)}function L(){return(this.buffers||(this.buffers=[])).shift()}function V(H){return function se(ue){for(var ee in H)ue[ee]=H[ee];return ue}}d.mixin=V(function v(){return{bufferish:a,write:function H(ee){var Y=this.offset?a.prototype.slice.call(this.buffer,this.offset):this.buffer;this.buffer=Y?ee?this.bufferish.concat([Y,ee]):Y:ee,this.offset=0},fetch:F,flush:function se(){for(;this.offset<this.buffer.length;){var Y,ee=this.offset;try{Y=this.fetch()}catch(ne){if(ne&&ne.message!=p)throw ne;this.offset=ee;break}this.push(Y)}},push:G,pull:L,read:oe,reserve:function ue(ee){var Y=this.offset,ne=Y+ee;if(ne>this.buffer.length)throw new Error(p);return this.offset=ne,Y},offset:0}}()),d.mixin(d.prototype),M.mixin=V(function D(){return{bufferish:a,write:$,fetch:function H(){var ne=this.start;if(ne<this.offset){var k=this.start=this.offset;return a.prototype.slice.call(this.buffer,ne,k)}},flush:function se(){for(;this.start<this.offset;){var ne=this.fetch();ne&&this.push(ne)}},push:G,pull:function ue(){var ne=this.buffers||(this.buffers=[]),k=ne.length>1?this.bufferish.concat(ne):ne[0];return ne.length=0,k},read:oe,reserve:function ee(ne){var k=0|ne;if(this.buffer){var q=this.buffer.length,z=0|this.offset,A=z+k;if(A<q)return this.offset=A,z;this.flush(),ne=Math.max(ne,Math.min(2*q,this.maxBufferSize))}return ne=Math.max(ne,this.minBufferSize),this.buffer=this.bufferish.alloc(ne),this.start=0,this.offset=k,0},send:function Y(ne){var k=ne.length;if(k>this.minBufferSize)this.flush(),this.push(ne);else{var q=this.reserve(k);a.prototype.copy.call(ne,this.buffer,q)}},maxBufferSize:65536,minBufferSize:2048,offset:0,start:0}}()),M.mixin(M.prototype)},8334:(E,ae,X)=>{var a=X(7846).S,y=X(9146),w=X(4613).readUint8,p=X(1788),d=X(5166);function v(){var F=this.options;return this.decode=function M(F){var oe=p.getReadToken(F);return function G(L){var V=w(L),H=oe[V];if(!H)throw new Error("Invalid type: "+(V&&"0x"+V.toString(16)));return H(L)}}(F),F&&F.preset&&y.setExtUnpackers(this),this}d.install({addExtUnpacker:function D(F,oe){(this.extUnpackers||(this.extUnpackers=[]))[F]=d.filter(oe)},getExtUnpacker:function $(F){return(this.extUnpackers||(this.extUnpackers=[]))[F]||function G(L){return new a(L,F)}},init:v}),ae.preset=v.call(d.preset)},4613:(E,ae,X)=>{var a=X(8461),y=X(6256),w=y.Uint64BE,p=y.Int64BE;ae.getReadFormat=function $(h){var l=h&&h.int64;return{map:v&&h&&h.usemap?oe:F,array:G,str:L,bin:d.hasArrayBuffer&&h&&h.binarraybuffer?H:V,ext:se,uint8:ue,uint16:Y,uint32:k,uint64:z(8,l?P:A),int8:ee,int16:ne,int32:q,int64:z(8,l?g:N),float32:z(4,b),float64:z(8,C)}},ae.readUint8=ue;var d=X(6093),M=X(5364),v="undefined"!=typeof Map;function F(h,u){var f,l={},_=new Array(u),x=new Array(u),S=h.codec.decode;for(f=0;f<u;f++)_[f]=S(h),x[f]=S(h);for(f=0;f<u;f++)l[_[f]]=x[f];return l}function oe(h,u){var f,l=new Map,_=new Array(u),x=new Array(u),S=h.codec.decode;for(f=0;f<u;f++)_[f]=S(h),x[f]=S(h);for(f=0;f<u;f++)l.set(_[f],x[f]);return l}function G(h,u){for(var l=new Array(u),f=h.codec.decode,_=0;_<u;_++)l[_]=f(h);return l}function L(h,u){var l=h.reserve(u);return M.toString.call(h.buffer,"utf-8",l,l+u)}function V(h,u){var l=h.reserve(u),_=M.slice.call(h.buffer,l,l+u);return d.from(_)}function H(h,u){var l=h.reserve(u),_=M.slice.call(h.buffer,l,l+u);return d.Uint8Array.from(_).buffer}function se(h,u){var l=h.reserve(u+1),f=h.buffer[l++],_=l+u,x=h.codec.getExtUnpacker(f);if(!x)throw new Error("Invalid ext type: "+(f&&"0x"+f.toString(16)));return x(M.slice.call(h.buffer,l,_))}function ue(h){var u=h.reserve(1);return h.buffer[u]}function ee(h){var u=h.reserve(1),l=h.buffer[u];return 128&l?l-256:l}function Y(h){var u=h.reserve(2),l=h.buffer;return l[u++]<<8|l[u]}function ne(h){var u=h.reserve(2),l=h.buffer,f=l[u++]<<8|l[u];return 32768&f?f-65536:f}function k(h){var u=h.reserve(4),l=h.buffer;return 16777216*l[u++]+(l[u++]<<16)+(l[u++]<<8)+l[u]}function q(h){var u=h.reserve(4),l=h.buffer;return l[u++]<<24|l[u++]<<16|l[u++]<<8|l[u]}function z(h,u){return function(l){var f=l.reserve(h);return u.call(l.buffer,f,!0)}}function A(h){return new w(this,h).toNumber()}function N(h){return new p(this,h).toNumber()}function P(h){return new w(this,h)}function g(h){return new p(this,h)}function b(h){return a.read(this,h,!1,23,4)}function C(h){return a.read(this,h,!1,52,8)}},1788:(E,ae,X)=>{var a=X(4613);function w(D){var $,F=new Array(256);for($=0;$<=127;$++)F[$]=d($);for($=128;$<=143;$++)F[$]=v($-128,D.map);for($=144;$<=159;$++)F[$]=v($-144,D.array);for($=160;$<=191;$++)F[$]=v($-160,D.str);for(F[192]=d(null),F[193]=null,F[194]=d(!1),F[195]=d(!0),F[196]=M(D.uint8,D.bin),F[197]=M(D.uint16,D.bin),F[198]=M(D.uint32,D.bin),F[199]=M(D.uint8,D.ext),F[200]=M(D.uint16,D.ext),F[201]=M(D.uint32,D.ext),F[202]=D.float32,F[203]=D.float64,F[204]=D.uint8,F[205]=D.uint16,F[206]=D.uint32,F[207]=D.uint64,F[208]=D.int8,F[209]=D.int16,F[210]=D.int32,F[211]=D.int64,F[212]=v(1,D.ext),F[213]=v(2,D.ext),F[214]=v(4,D.ext),F[215]=v(8,D.ext),F[216]=v(16,D.ext),F[217]=M(D.uint8,D.str),F[218]=M(D.uint16,D.str),F[219]=M(D.uint32,D.str),F[220]=M(D.uint16,D.array),F[221]=M(D.uint32,D.array),F[222]=M(D.uint16,D.map),F[223]=M(D.uint32,D.map),$=224;$<=255;$++)F[$]=d($-256);return F}function d(D){return function(){return D}}function M(D,$){return function(F){var oe=D(F);return $(F,oe)}}function v(D,$){return function(F){return $(F,D)}}ae.getReadToken=function y(D){var $=a.getReadFormat(D);return D&&D.useraw?function p(D){var $,F=w(D).slice();for(F[217]=F[196],F[218]=F[197],F[219]=F[198],$=160;$<=191;$++)F[$]=v($-160,D.bin);return F}($):w($)}},2732:(E,ae,X)=>{var a=X(7846).S,y=X(4106),w=X(9118),p=X(5166);function M(){var $=this.options;return this.encode=function d($){var F=w.getWriteType($);return function oe(G,L){var V=F[typeof L];if(!V)throw new Error('Unsupported type "'+typeof L+'": '+L);V(G,L)}}($),$&&$.preset&&y.setExtPackers(this),this}p.install({addExtPacker:function v($,F,oe){oe=p.filter(oe);var G=F.name;function H(se){return oe&&(se=oe(se)),new a(se,$)}G&&"Object"!==G?(this.extPackers||(this.extPackers={}))[G]=H:(this.extEncoderList||(this.extEncoderList=[])).unshift([F,H])},getExtPacker:function D($){var F=this.extPackers||(this.extPackers={}),oe=$.constructor,G=oe&&oe.name&&F[oe.name];if(G)return G;for(var L=this.extEncoderList||(this.extEncoderList=[]),V=L.length,H=0;H<V;H++){var se=L[H];if(oe===se[0])return se[1]}},init:M}),ae.preset=M.call(p.preset)},3041:(E,ae,X)=>{var a=X(8461),y=X(6256),w=y.Uint64BE,p=y.Int64BE,d=X(8323).w,M=X(6093),v=M.global,$=M.hasBuffer&&"TYPED_ARRAY_SUPPORT"in v&&!v.TYPED_ARRAY_SUPPORT,F=M.hasBuffer&&v.prototype||{};function L(){var z=d.slice();return z[196]=H(196),z[197]=se(197),z[198]=ue(198),z[199]=H(199),z[200]=se(200),z[201]=ue(201),z[202]=ee(202,4,F.writeFloatBE||k,!0),z[203]=ee(203,8,F.writeDoubleBE||q,!0),z[204]=H(204),z[205]=se(205),z[206]=ue(206),z[207]=ee(207,8,Y),z[208]=H(208),z[209]=se(209),z[210]=ue(210),z[211]=ee(211,8,ne),z[217]=H(217),z[218]=se(218),z[219]=ue(219),z[220]=se(220),z[221]=ue(221),z[222]=se(222),z[223]=ue(223),z}function H(z){return function(A,N){var P=A.reserve(2),g=A.buffer;g[P++]=z,g[P]=N}}function se(z){return function(A,N){var P=A.reserve(3),g=A.buffer;g[P++]=z,g[P++]=N>>>8,g[P]=N}}function ue(z){return function(A,N){var P=A.reserve(5),g=A.buffer;g[P++]=z,g[P++]=N>>>24,g[P++]=N>>>16,g[P++]=N>>>8,g[P]=N}}function ee(z,A,N,P){return function(g,b){var C=g.reserve(A+1);g.buffer[C++]=z,N.call(g.buffer,b,C,P)}}function Y(z,A){new w(this,A,z)}function ne(z,A){new p(this,A,z)}function k(z,A){a.write(this,z,A,!1,23,4)}function q(z,A){a.write(this,z,A,!1,52,8)}ae.getWriteToken=function oe(z){return z&&z.uint8array?function G(){var z=L();return z[202]=ee(202,4,k),z[203]=ee(203,8,q),z}():$||M.hasBuffer&&z&&z.safe?function V(){var z=d.slice();return z[196]=ee(196,1,v.prototype.writeUInt8),z[197]=ee(197,2,v.prototype.writeUInt16BE),z[198]=ee(198,4,v.prototype.writeUInt32BE),z[199]=ee(199,1,v.prototype.writeUInt8),z[200]=ee(200,2,v.prototype.writeUInt16BE),z[201]=ee(201,4,v.prototype.writeUInt32BE),z[202]=ee(202,4,v.prototype.writeFloatBE),z[203]=ee(203,8,v.prototype.writeDoubleBE),z[204]=ee(204,1,v.prototype.writeUInt8),z[205]=ee(205,2,v.prototype.writeUInt16BE),z[206]=ee(206,4,v.prototype.writeUInt32BE),z[207]=ee(207,8,Y),z[208]=ee(208,1,v.prototype.writeInt8),z[209]=ee(209,2,v.prototype.writeInt16BE),z[210]=ee(210,4,v.prototype.writeInt32BE),z[211]=ee(211,8,ne),z[217]=ee(217,1,v.prototype.writeUInt8),z[218]=ee(218,2,v.prototype.writeUInt16BE),z[219]=ee(219,4,v.prototype.writeUInt32BE),z[220]=ee(220,2,v.prototype.writeUInt16BE),z[221]=ee(221,4,v.prototype.writeUInt32BE),z[222]=ee(222,2,v.prototype.writeUInt16BE),z[223]=ee(223,4,v.prototype.writeUInt32BE),z}():L()}},9118:(E,ae,X)=>{var a=X(6425),y=X(6256),w=y.Uint64BE,p=y.Int64BE,d=X(6093),M=X(5364),v=X(3041),D=X(8323).w,$=X(7846).S,F="undefined"!=typeof Uint8Array,oe="undefined"!=typeof Map,G=[];G[1]=212,G[2]=213,G[4]=214,G[8]=215,G[16]=216,ae.getWriteType=function L(V){var H=v.getWriteToken(V),se=V&&V.useraw,ue=F&&V&&V.binarraybuffer,ee=ue?d.isArrayBuffer:d.isBuffer,Y=ue?function x(T,O){_(T,new Uint8Array(O))}:_,k=oe&&V&&V.usemap?function le(T,O){if(!(O instanceof Map))return Q(T,O);var re=O.size;H[re<16?128+re:re<=65535?222:223](T,re);var ve=T.codec.encode;O.forEach(function(de,Ee,ce){ve(T,Ee),ve(T,de)})}:Q;return{boolean:function z(T,O){H[O?195:194](T,O)},function:l,number:function A(T,O){var re=0|O;O===re?H[-32<=re&&re<=127?255&re:0<=re?re<=255?204:re<=65535?205:206:-128<=re?208:-32768<=re?209:210](T,re):H[203](T,O)},object:se?function u(T,O){if(ee(O))return function Ce(T,O){var re=O.length;H[re<32?160+re:re<=65535?218:219](T,re),T.send(O)}(T,O);h(T,O)}:h,string:function C(T){return function O(re,j){var ve=j.length;re.offset=re.reserve(5+3*ve);var Ee=re.buffer,ce=T(ve),he=re.offset+ce;ve=M.write.call(Ee,j,he);var B=T(ve);ce!==B&&M.copy.call(Ee,Ee,he+B-ce,he,he+ve),H[1===B?160+ve:B<=3?215+B:219](re,ve),re.offset+=ve}}(se?function b(T){return T<32?1:T<=65535?3:5}:function g(T){return T<32?1:T<=255?2:T<=65535?3:5}),symbol:l,undefined:l};function h(T,O){if(null===O)return l(T,O);if(ee(O))return Y(T,O);if(a(O))return function f(T,O){var re=O.length;H[re<16?144+re:re<=65535?220:221](T,re);for(var ve=T.codec.encode,de=0;de<re;de++)ve(T,O[de])}(T,O);if(w.isUint64BE(O))return function N(T,O){H[207](T,O.toArray())}(T,O);if(p.isInt64BE(O))return function P(T,O){H[211](T,O.toArray())}(T,O);var re=T.codec.getExtPacker(O);if(re&&(O=re(O)),O instanceof $)return function S(T,O){var re=O.buffer,j=re.length;H[G[j]||(j<255?199:j<=65535?200:201)](T,j),D[O.type](T),T.send(re)}(T,O);k(T,O)}function l(T,O){H[192](T,O)}function _(T,O){var re=O.length;H[re<255?196:re<=65535?197:198](T,re),T.send(O)}function Q(T,O){var re=Object.keys(O),j=re.length;H[j<16?128+j:j<=65535?222:223](T,j);var de=T.codec.encode;re.forEach(function(Ee){de(T,Ee),de(T,O[Ee])})}}},8323:(E,ae)=>{for(var X=ae.w=new Array(256),a=0;a<=255;a++)X[a]=y(a);function y(w){return function(p){var d=p.reserve(1);p.buffer[d]=w}}},1203:E=>{function ae(w){var p="    ";if(isNaN(parseInt(w)))p=w;else switch(w){case 1:p=" ";break;case 2:p="  ";break;case 3:p="   ";break;case 4:p="    ";break;case 5:p="     ";break;case 6:p="      ";break;case 7:p="       ";break;case 8:p="        ";break;case 9:p="         ";break;case 10:p="          ";break;case 11:p="           ";break;case 12:p="            "}for(var d=["\n"],M=0;M<100;M++)d.push(d[M]+p);return d}function X(){this.step="    ",this.shift=ae(this.step)}function a(w,p){return p-(w.replace(/\(/g,"").length-w.replace(/\)/g,"").length)}function y(w,p){return w.replace(/\s{1,}/g," ").replace(/ AND /gi,"~::~"+p+p+"AND ").replace(/ BETWEEN /gi,"~::~"+p+"BETWEEN ").replace(/ CASE /gi,"~::~"+p+"CASE ").replace(/ ELSE /gi,"~::~"+p+"ELSE ").replace(/ END /gi,"~::~"+p+"END ").replace(/ FROM /gi,"~::~FROM ").replace(/ GROUP\s{1,}BY/gi,"~::~GROUP BY ").replace(/ HAVING /gi,"~::~HAVING ").replace(/ IN /gi," IN ").replace(/ JOIN /gi,"~::~JOIN ").replace(/ CROSS~::~{1,}JOIN /gi,"~::~CROSS JOIN ").replace(/ INNER~::~{1,}JOIN /gi,"~::~INNER JOIN ").replace(/ LEFT~::~{1,}JOIN /gi,"~::~LEFT JOIN ").replace(/ RIGHT~::~{1,}JOIN /gi,"~::~RIGHT JOIN ").replace(/ ON /gi,"~::~"+p+"ON ").replace(/ OR /gi,"~::~"+p+p+"OR ").replace(/ ORDER\s{1,}BY/gi,"~::~ORDER BY ").replace(/ OVER /gi,"~::~"+p+"OVER ").replace(/\(\s{0,}SELECT /gi,"~::~(SELECT ").replace(/\)\s{0,}SELECT /gi,")~::~SELECT ").replace(/ THEN /gi," THEN~::~"+p).replace(/ UNION /gi,"~::~UNION~::~").replace(/ USING /gi,"~::~USING ").replace(/ WHEN /gi,"~::~"+p+"WHEN ").replace(/ WHERE /gi,"~::~WHERE ").replace(/ WITH /gi,"~::~WITH ").replace(/ ALL /gi," ALL ").replace(/ AS /gi," AS ").replace(/ ASC /gi," ASC ").replace(/ DESC /gi," DESC ").replace(/ DISTINCT /gi," DISTINCT ").replace(/ EXISTS /gi," EXISTS ").replace(/ NOT /gi," NOT ").replace(/ NULL /gi," NULL ").replace(/ LIKE /gi," LIKE ").replace(/\s{0,}SELECT /gi,"SELECT ").replace(/\s{0,}UPDATE /gi,"UPDATE ").replace(/ SET /gi," SET ").replace(/~::~{1,}/g,"~::~").split("~::~")}X.prototype.xml=function(w,p){var d=w.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").replace(/\s*xmlns\=/g,"~::~xmlns=").split("~::~"),M=d.length,v=!1,D=0,$="",F=0,oe=p?ae(p):this.shift;for(F=0;F<M;F++)d[F].search(/<!/)>-1?($+=oe[D]+d[F],v=!0,(d[F].search(/-->/)>-1||d[F].search(/\]>/)>-1||d[F].search(/!DOCTYPE/)>-1)&&(v=!1)):d[F].search(/-->/)>-1||d[F].search(/\]>/)>-1?($+=d[F],v=!1):/^<\w/.exec(d[F-1])&&/^<\/\w/.exec(d[F])&&/^<[\w:\-\.\,]+/.exec(d[F-1])==/^<\/[\w:\-\.\,]+/.exec(d[F])[0].replace("/","")?($+=d[F],v||D--):d[F].search(/<\w/)>-1&&-1==d[F].search(/<\//)&&-1==d[F].search(/\/>/)?$=$+=v?d[F]:oe[D++]+d[F]:d[F].search(/<\w/)>-1&&d[F].search(/<\//)>-1?$=$+=v?d[F]:oe[D]+d[F]:d[F].search(/<\//)>-1?$=$+=v?d[F]:oe[--D]+d[F]:d[F].search(/\/>/)>-1?$=$+=v?d[F]:oe[D]+d[F]:d[F].search(/<\?/)>-1||d[F].search(/xmlns\:/)>-1||d[F].search(/xmlns\=/)>-1?$+=oe[D]+d[F]:$+=d[F];return"\n"==$[0]?$.slice(1):$},X.prototype.json=function(w,d){return d=d||this.step,"undefined"==typeof JSON?w:"string"==typeof w?JSON.stringify(JSON.parse(w),null,d):"object"==typeof w?JSON.stringify(w,null,d):w},X.prototype.css=function(w,p){var d=w.replace(/\s{1,}/g," ").replace(/\{/g,"{~::~").replace(/\}/g,"~::~}~::~").replace(/\;/g,";~::~").replace(/\/\*/g,"~::~/*").replace(/\*\//g,"*/~::~").replace(/~::~\s{0,}~::~/g,"~::~").split("~::~"),M=d.length,v=0,D="",$=0,F=p?ae(p):this.shift;for($=0;$<M;$++)/\{/.exec(d[$])?D+=F[v++]+d[$]:/\}/.exec(d[$])?D+=F[--v]+d[$]:(/\*\\/.exec(d[$]),D+=F[v]+d[$]);return D.replace(/^\n{1,}/,"")},X.prototype.sql=function(w,p){var d=w.replace(/\s{1,}/g," ").replace(/\'/gi,"~::~'").split("~::~"),M=d.length,v=[],D=0,$=this.step,G=0,L="",V=0,H=p?ae(p):this.shift;for(V=0;V<M;V++)v=v.concat(V%2?d[V]:y(d[V],$));for(M=v.length,V=0;V<M;V++)G=a(v[V],G),/\s{0,}\s{0,}SELECT\s{0,}/.exec(v[V])&&(v[V]=v[V].replace(/\,/g,",\n"+$+$)),/\s{0,}\s{0,}SET\s{0,}/.exec(v[V])&&(v[V]=v[V].replace(/\,/g,",\n"+$+$)),/\s{0,}\(\s{0,}SELECT\s{0,}/.exec(v[V])?L+=H[++D]+v[V]:/\'/.exec(v[V])?(G<1&&D&&D--,L+=v[V]):(L+=H[D]+v[V],G<1&&D&&D--);return L.replace(/^\n{1,}/,"").replace(/\n{1,}/g,"\n")},X.prototype.xmlmin=function(w,p){return(p?w:w.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"").replace(/[ \r\n\t]{1,}xmlns/g," xmlns")).replace(/>\s{0,}</g,"><")},X.prototype.jsonmin=function(w){return"undefined"==typeof JSON?w:JSON.stringify(JSON.parse(w),null,0)},X.prototype.cssmin=function(w,p){return(p?w:w.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\//g,"")).replace(/\s{1,}/g," ").replace(/\{\s{1,}/g,"{").replace(/\}\s{1,}/g,"}").replace(/\;\s{1,}/g,";").replace(/\/\*\s{1,}/g,"/*").replace(/\*\/\s{1,}/g,"*/")},X.prototype.sqlmin=function(w){return w.replace(/\s{1,}/g," ").replace(/\s{1,}\(/,"(").replace(/\s{1,}\)/,")")},E.exports=new X},85:(E,ae,X)=>{var a={"./AFF2e":[7676,7327],"./AFF2e.js":[7676,7327],"./AceKillerGene":[1439,7217],"./AceKillerGene.js":[1439,7217],"./Ainecadette":[2160,8150],"./Ainecadette.js":[2160,8150],"./Airgetlamh":[6408,5247],"./Airgetlamh.js":[6408,5247],"./AlchemiaStruggle":[6510,5225],"./AlchemiaStruggle.js":[6510,5225],"./Alsetto":[905,2948],"./Alsetto.js":[905,2948],"./Alshard":[7058,6420],"./Alshard.js":[7058,6420],"./AlterRaise":[1105,3385],"./AlterRaise.js":[1105,3385],"./Amadeus":[5752,1582],"./Amadeus.js":[5752,1582],"./Amadeus_Korean":[6602,5512],"./Amadeus_Korean.js":[6602,5512],"./AngelGear":[4200,9437],"./AngelGear.js":[4200,9437],"./AnimaAnimus":[7164,2919],"./AnimaAnimus.js":[7164,2919],"./Aoharubaan":[5757,6968],"./Aoharubaan.js":[5757,6968],"./Arianrhod":[4005,5283],"./Arianrhod.js":[4005,5283],"./ArsMagica":[3655,5734],"./ArsMagica.js":[3655,5734],"./AssaultEngine":[3898,4339],"./AssaultEngine.js":[3898,4339],"./Avandner":[8206,3084],"./Avandner.js":[8206,3084],"./Ayabito":[5853,1253],"./Ayabito.js":[5853,1253],"./BBN":[8554,2522],"./BBN.js":[8554,2522],"./BadLife":[9538,4872],"./BadLife.js":[9538,4872],"./Bakenokawa":[6103,2135],"./Bakenokawa.js":[6103,2135],"./BarnaKronika":[5396,7073],"./BarnaKronika.js":[5396,7073],"./BattleTech":[2890,6344],"./BattleTech.js":[2890,6344],"./BeastBindTrinity":[1063,4572],"./BeastBindTrinity.js":[1063,4572],"./BeginningIdol":[8857,66],"./BeginningIdol.js":[8857,66],"./BeginningIdol2022":[8381,6466],"./BeginningIdol2022.js":[8381,6466],"./BeginningIdol_Korean":[7816,7117],"./BeginningIdol_Korean.js":[7816,7117],"./BladeOfArcana":[3449,1087],"./BladeOfArcana.js":[3449,1087],"./BlindMythos":[2639,5539],"./BlindMythos.js":[2639,5539],"./BloodCrusade":[2906,2013],"./BloodCrusade.js":[2906,2013],"./BloodMoon":[7994,593],"./BloodMoon.js":[7994,593],"./CardRanker":[6006,873],"./CardRanker.js":[6006,873],"./CastleInGray":[2519,1820],"./CastleInGray.js":[2519,1820],"./ChaosFlare":[229,1114],"./ChaosFlare.js":[229,1114],"./Chill":[9894,1919],"./Chill.js":[9894,1919],"./Chill3":[3294,8585],"./Chill3.js":[3294,8585],"./CodeLayerd":[6106,9606],"./CodeLayerd.js":[6106,9606],"./ColossalHunter":[519,2461],"./ColossalHunter.js":[519,2461],"./Comes":[1712,2793],"./Comes.js":[1712,2793],"./CrashWorld":[6506,2519],"./CrashWorld.js":[6506,2519],"./Cthulhu":[2605,3364],"./Cthulhu.js":[2605,3364],"./Cthulhu7th":[5149,8376],"./Cthulhu7th.js":[5149,8376],"./Cthulhu7th_ChineseTraditional":[9464,6447],"./Cthulhu7th_ChineseTraditional.js":[9464,6447],"./Cthulhu7th_Korean":[329,7170],"./Cthulhu7th_Korean.js":[329,7170],"./CthulhuTech":[9818,2555],"./CthulhuTech.js":[9818,2555],"./Cthulhu_ChineseTraditional":[3109,9285],"./Cthulhu_ChineseTraditional.js":[3109,9285],"./Cthulhu_Korean":[9585,7008],"./Cthulhu_Korean.js":[9585,7008],"./Cthulhu_SimplifiedChinese":[4916,1448],"./Cthulhu_SimplifiedChinese.js":[4916,1448],"./CyberpunkRed":[1933,347],"./CyberpunkRed.js":[1933,347],"./DarkBlaze":[7810,3005],"./DarkBlaze.js":[7810,3005],"./DarkDaysDrive":[3543,5736],"./DarkDaysDrive.js":[3543,5736],"./DarkSouls":[5581,3958],"./DarkSouls.js":[5581,3958],"./DeadlineHeroes":[2270,6143],"./DeadlineHeroes.js":[2270,6143],"./DemonParasite":[7605,5670],"./DemonParasite.js":[7605,5670],"./DesperateRun":[8999,148],"./DesperateRun.js":[8999,148],"./DetatokoSaga":[3264,5413],"./DetatokoSaga.js":[3264,5413],"./DetatokoSaga_Korean":[4236,7553],"./DetatokoSaga_Korean.js":[4236,7553],"./DiceBot":[8618,8159],"./DiceBot.js":[8618,8159],"./DiceOfTheDead":[2533,5651],"./DiceOfTheDead.js":[2533,5651],"./DoubleCross":[1316,8436],"./DoubleCross.js":[1316,8436],"./DoubleCross_Korean":[9761,6708],"./DoubleCross_Korean.js":[9761,6708],"./Dracurouge":[2204,2697],"./Dracurouge.js":[2204,2697],"./Dracurouge_Korean":[759,9678],"./Dracurouge_Korean.js":[759,9678],"./DungeonsAndDragons":[8454,8358],"./DungeonsAndDragons.js":[8454,8358],"./EarthDawn":[1329,517],"./EarthDawn.js":[1329,517],"./EarthDawn3":[4021,9730],"./EarthDawn3.js":[4021,9730],"./EarthDawn4":[9918,809],"./EarthDawn4.js":[9918,809],"./EclipsePhase":[410,9735],"./EclipsePhase.js":[410,9735],"./Elric":[8326,7309],"./Elric.js":[8326,7309],"./Elysion":[9626,7372],"./Elysion.js":[9626,7372],"./EmbryoMachine":[2035,9755],"./EmbryoMachine.js":[2035,9755],"./Emoklore":[8686,5620],"./Emoklore.js":[8686,5620],"./EndBreaker":[4869,3515],"./EndBreaker.js":[4869,3515],"./EtrianOdysseySRS":[3460,1851],"./EtrianOdysseySRS.js":[3460,1851],"./FateCoreSystem":[5925,5899],"./FateCoreSystem.js":[5925,5899],"./Fiasco":[6587,6739],"./Fiasco.js":[6587,6739],"./Fiasco_Korean":[3734,7036],"./Fiasco_Korean.js":[3734,7036],"./FilledWith":[4239,6705],"./FilledWith.js":[4239,6705],"./FullMetalPanic":[1959,8725],"./FullMetalPanic.js":[1959,8725],"./FutariSousa":[2729,4564],"./FutariSousa.js":[2729,4564],"./FutariSousa_Korean":[4424,8175],"./FutariSousa_Korean.js":[4424,8175],"./GURPS":[7782,6908],"./GURPS.js":[7782,6908],"./Garako":[1948,8165],"./Garako.js":[1948,8165],"./GardenOrder":[2017,172],"./GardenOrder.js":[2017,172],"./GehennaAn":[1647,5105],"./GehennaAn.js":[1647,5105],"./GeishaGirlwithKatana":[5593,8780],"./GeishaGirlwithKatana.js":[5593,8780],"./GhostLive":[4656,9626],"./GhostLive.js":[4656,9626],"./GoblinSlayer":[3983,2006],"./GoblinSlayer.js":[3983,2006],"./GoldenSkyStories":[3437,9940],"./GoldenSkyStories.js":[3437,9940],"./Gorilla":[6362,7576],"./Gorilla.js":[6362,7576],"./GranCrest":[7150,6613],"./GranCrest.js":[7150,6613],"./Gundog":[8166,6501],"./Gundog.js":[8166,6501],"./GundogRevised":[4196,427],"./GundogRevised.js":[4196,427],"./GundogZero":[5273,493],"./GundogZero.js":[5273,493],"./GurpsFW":[882,6949],"./GurpsFW.js":[882,6949],"./HarnMaster":[6765,4075],"./HarnMaster.js":[6765,4075],"./HatsuneMiku":[3124,6589],"./HatsuneMiku.js":[3124,6589],"./Hieizan":[7418,8171],"./Hieizan.js":[7418,8171],"./HouraiGakuen":[7945,7155],"./HouraiGakuen.js":[7945,7155],"./HuntersMoon":[4873,1909],"./HuntersMoon.js":[4873,1909],"./IfIfIf":[7043,4507],"./IfIfIf.js":[7043,4507],"./Illusio":[3843,4796],"./Illusio.js":[3843,4796],"./InfiniteBabeL":[7878,7641],"./InfiniteBabeL.js":[7878,7641],"./InfiniteFantasia":[6391,391],"./InfiniteFantasia.js":[6391,391],"./Insane":[5844,9001],"./Insane.js":[5844,9001],"./Insane_Korean":[9199,1918],"./Insane_Korean.js":[9199,1918],"./Irisbane":[4167,6957],"./Irisbane.js":[4167,6957],"./IthaWenUa":[2726,9872],"./IthaWenUa.js":[2726,9872],"./JamesBond":[4866,7097],"./JamesBond.js":[4866,7097],"./JekyllAndHyde":[817,4788],"./JekyllAndHyde.js":[817,4788],"./JuinKansen":[9673,9327],"./JuinKansen.js":[9673,9327],"./Kamigakari":[2920,8602],"./Kamigakari.js":[2920,8602],"./Kamigakari_Korean":[6250,5309],"./Kamigakari_Korean.js":[6250,5309],"./KanColle":[4670,2098],"./KanColle.js":[4670,2098],"./Karukami":[2838,1616],"./Karukami.js":[2838,1616],"./KemonoNoMori":[1151,3962],"./KemonoNoMori.js":[1151,3962],"./KillDeathBusiness":[744,6750],"./KillDeathBusiness.js":[744,6750],"./KillDeathBusiness_Korean":[346,4401],"./KillDeathBusiness_Korean.js":[346,4401],"./KurayamiCrying":[5627,164],"./KurayamiCrying.js":[5627,164],"./Kutulu":[76,8790],"./Kutulu.js":[76,8790],"./LiveraDoll":[6459,8440],"./LiveraDoll.js":[6459,8440],"./LogHorizon":[8991,4810],"./LogHorizon.js":[8991,4810],"./LogHorizon_Korean":[8959,348],"./LogHorizon_Korean.js":[8959,348],"./LostRecord":[6543,7171],"./LostRecord.js":[6543,7171],"./LostRoyal":[9348,9625],"./LostRoyal.js":[9348,9625],"./MagicaLogia":[5563,2399],"./MagicaLogia.js":[5563,2399],"./MagicaLogia_Korean":[2586,7729],"./MagicaLogia_Korean.js":[2586,7729],"./MagicaLogia_SimplifiedChinese":[3677,6875],"./MagicaLogia_SimplifiedChinese.js":[3677,6875],"./MeikyuDays":[3433,1493],"./MeikyuDays.js":[3433,1493],"./MeikyuKingdom":[9889,8326],"./MeikyuKingdom.js":[9889,8326],"./MeikyuKingdomBasic":[668,7016],"./MeikyuKingdomBasic.js":[668,7016],"./MetalHead":[1175,7276],"./MetalHead.js":[1175,7276],"./MetalHeadExtream":[1587,3062],"./MetalHeadExtream.js":[1587,3062],"./MetallicGuardian":[1245,2040],"./MetallicGuardian.js":[1245,2040],"./MonotoneMuseum":[4351,735],"./MonotoneMuseum.js":[4351,735],"./MonotoneMuseum_Korean":[3989,5249],"./MonotoneMuseum_Korean.js":[3989,5249],"./NSSQ":[6681,4238],"./NSSQ.js":[6681,4238],"./Nechronica":[8885,3532],"./Nechronica.js":[8885,3532],"./Nechronica_Korean":[4361,4116],"./Nechronica_Korean.js":[4361,4116],"./NeverCloud":[9447,3096],"./NeverCloud.js":[9447,3096],"./NightWizard":[7740,5811],"./NightWizard.js":[7740,5811],"./NightWizard3rd":[4933,3535],"./NightWizard3rd.js":[4933,3535],"./NightmareHunterDeep":[1387,298],"./NightmareHunterDeep.js":[1387,298],"./NinjaSlayer":[517,7381],"./NinjaSlayer.js":[517,7381],"./NjslyrBattle":[596,3443],"./NjslyrBattle.js":[596,3443],"./Nuekagami":[1848,3293],"./Nuekagami.js":[1848,3293],"./OneWayHeroics":[1989,3852],"./OneWayHeroics.js":[1989,3852],"./OracleEngine":[978,2989],"./OracleEngine.js":[978,2989],"./OrgaRain":[8614,644],"./OrgaRain.js":[8614,644],"./Oukahoushin3rd":[7133,3407],"./Oukahoushin3rd.js":[7133,3407],"./Paradiso":[2313,4246],"./Paradiso.js":[2313,4246],"./Paranoia":[6634,1031],"./Paranoia.js":[6634,1031],"./ParanoiaRebooted":[9628,5289],"./ParanoiaRebooted.js":[9628,5289],"./ParasiteBlood":[8073,1410],"./ParasiteBlood.js":[8073,1410],"./Pathfinder":[5017,1599],"./Pathfinder.js":[5017,1599],"./Peekaboo":[9309,844],"./Peekaboo.js":[9309,844],"./Pendragon":[9113,2311],"./Pendragon.js":[9113,2311],"./PersonaO":[6706,481],"./PersonaO.js":[6706,481],"./PhantasmAdventure":[926,8614],"./PhantasmAdventure.js":[926,8614],"./Postman":[3021,5124],"./Postman.js":[3021,5124],"./PulpCthulhu":[4292,9449],"./PulpCthulhu.js":[4292,9449],"./Raisondetre":[2909,293],"./Raisondetre.js":[2909,293],"./RecordOfLodossWar":[1925,281],"./RecordOfLodossWar.js":[1925,281],"./RecordOfSteam":[1293,2213],"./RecordOfSteam.js":[1293,2213],"./Revulture":[573,9886],"./Revulture.js":[573,9886],"./RokumonSekai2":[3592,9495],"./RokumonSekai2.js":[3592,9495],"./RoleMaster":[7612,2625],"./RoleMaster.js":[7612,2625],"./RuinBreakers":[1349,7696],"./RuinBreakers.js":[1349,7696],"./RuneQuest":[7543,7480],"./RuneQuest.js":[7543,7480],"./RyuTuber":[1287,1766],"./RyuTuber.js":[1287,1766],"./Ryutama":[8123,585],"./Ryutama.js":[8123,585],"./SRS":[5762,1377],"./SRS.js":[5762,1377],"./SamsaraBallad":[2255,2250],"./SamsaraBallad.js":[2255,2250],"./Satasupe":[8236,3314],"./Satasupe.js":[8236,3314],"./ScreamHighSchool":[7728,512],"./ScreamHighSchool.js":[7728,512],"./Sengensyou":[1369,3109],"./Sengensyou.js":[1369,3109],"./SevenFortressMobius":[2004,1091],"./SevenFortressMobius.js":[2004,1091],"./ShadowRun":[7633,8975],"./ShadowRun.js":[7633,8975],"./ShadowRun4":[8489,5925],"./ShadowRun4.js":[8489,5925],"./ShadowRun5":[3265,3665],"./ShadowRun5.js":[3265,3665],"./SharedFantasia":[554,2025],"./SharedFantasia.js":[554,2025],"./ShinMegamiTenseiKakuseihen":[6821,8657],"./ShinMegamiTenseiKakuseihen.js":[6821,8657],"./ShinkuuGakuen":[708,1763],"./ShinkuuGakuen.js":[708,1763],"./ShinobiGami":[1946,132],"./ShinobiGami.js":[1946,132],"./Shiranui":[9776,2709],"./Shiranui.js":[9776,2709],"./ShoujoTenrankai":[8491,8565],"./ShoujoTenrankai.js":[8491,8565],"./ShuumatsuKikou":[918,533],"./ShuumatsuKikou.js":[918,533],"./Skynauts":[8327,5150],"./Skynauts.js":[8327,5150],"./SkynautsBouken":[5444,303],"./SkynautsBouken.js":[5444,303],"./StarryDolls":[783,9354],"./StarryDolls.js":[783,9354],"./SteamPunkers":[6339,7103],"./SteamPunkers.js":[6339,7103],"./StellarKnights":[5849,628],"./StellarKnights.js":[5849,628],"./StellarKnights_Korean":[2795,6768],"./StellarKnights_Korean.js":[2795,6768],"./StellarLife":[8594,3740],"./StellarLife.js":[8594,3740],"./StrangerOfSwordCity":[5214,1593],"./StrangerOfSwordCity.js":[5214,1593],"./StratoShout":[203,8470],"./StratoShout.js":[203,8470],"./StratoShout_Korean":[2030,6114],"./StratoShout_Korean.js":[2030,6114],"./Strave":[1758,8233],"./Strave.js":[1758,8233],"./SwordWorld":[8250,3210],"./SwordWorld.js":[8250,3210],"./SwordWorld2_0":[3840,7043],"./SwordWorld2_0.js":[3840,7043],"./SwordWorld2_5":[9527,9753],"./SwordWorld2_5.js":[9527,9753],"./TalesFromTheLoop":[4331,1982],"./TalesFromTheLoop.js":[4331,1982],"./TherapieSein":[4028,5405],"./TherapieSein.js":[4028,5405],"./TokumeiTenkousei":[4905,5101],"./TokumeiTenkousei.js":[4905,5101],"./TokyoGhostResearch":[3874,2686],"./TokyoGhostResearch.js":[3874,2686],"./TokyoNova":[7459,7455],"./TokyoNova.js":[7459,7455],"./Torg":[3042,6604],"./Torg.js":[3042,6604],"./Torg1_5":[3257,8177],"./Torg1_5.js":[3257,8177],"./TorgEternity":[9543,9931],"./TorgEternity.js":[9543,9931],"./ToshiakiHolyGrailWar":[1641,4957],"./ToshiakiHolyGrailWar.js":[1641,4957],"./TrinitySeven":[8262,589],"./TrinitySeven.js":[8262,589],"./TunnelsAndTrolls":[6450,5188],"./TunnelsAndTrolls.js":[6450,5188],"./TwilightGunsmoke":[4547,6331],"./TwilightGunsmoke.js":[4547,6331],"./UnsungDuet":[6694,1209],"./UnsungDuet.js":[6694,1209],"./Utakaze":[5520,357],"./Utakaze.js":[5520,357],"./VampireTheMasquerade5th":[6409,7115],"./VampireTheMasquerade5th.js":[6409,7115],"./Villaciel":[6633,4906],"./Villaciel.js":[6633,4906],"./VisionConnect":[2527,35],"./VisionConnect.js":[2527,35],"./WARPS":[8581,1380],"./WARPS.js":[8581,1380],"./WaresBlade":[9840,4213],"./WaresBlade.js":[9840,4213],"./Warhammer":[9883,7339],"./Warhammer.js":[9883,7339],"./Warhammer4":[2135,4837],"./Warhammer4.js":[2135,4837],"./WitchQuest":[3617,6088],"./WitchQuest.js":[3617,6088],"./WorldOfDarkness":[3350,3726],"./WorldOfDarkness.js":[3350,3726],"./YankeeYogSothoth":[1930,7906],"./YankeeYogSothoth.js":[1930,7906],"./YearZeroEngine":[929,6632],"./YearZeroEngine.js":[929,6632],"./Yggdrasill":[7157,6467],"./Yggdrasill.js":[7157,6467],"./ZettaiReido":[6698,4999],"./ZettaiReido.js":[6698,4999]};function y(w){if(!X.o(a,w))return Promise.resolve().then(()=>{var M=new Error("Cannot find module '"+w+"'");throw M.code="MODULE_NOT_FOUND",M});var p=a[w],d=p[0];return X.e(p[1]).then(()=>X.t(d,23))}y.keys=()=>Object.keys(a),y.id=85,E.exports=y},6507:(E,ae,X)=>{var a={"./Amadeus.ja_jp.json":[6070,9299],"./Amadeus.ko_kr.json":[765,4092],"./BeginningIdol.ja_jp.json":[5355,8635],"./BeginningIdol.ko_kr.json":[2590,6961],"./Cthulhu.ja_jp.json":[8128,652],"./Cthulhu.ko_kr.json":[7002,2617],"./Cthulhu.zh_hans.json":[4209,4922],"./Cthulhu.zh_hant.json":[8021,3147],"./DetatokoSaga.ja_jp.json":[4608,5777],"./DetatokoSaga.ko_kr.json":[408,4502],"./DoubleCross.ja_jp.json":[9221,8706],"./DoubleCross.ko_kr.json":[9734,8517],"./Dracurouge.ja_jp.json":[2286,2847],"./Dracurouge.ko_kr.json":[3597,155],"./Fiasco.ja_jp.json":[9873,1800],"./Fiasco.ko_kr.json":[5244,783],"./FutariSousa.ja_jp.json":[9491,8078],"./FutariSousa.ko_kr.json":[8721,9567],"./Insane.ja_jp.json":[5040,6446],"./Insane.ko_kr.json":[5488,3978],"./Kamigakari.ja_jp.json":[2742,3922],"./Kamigakari.ko_kr.json":[7708,1197],"./KillDeathBusiness.ja_jp.json":[2288,3760],"./KillDeathBusiness.ko_kr.json":[1847,287],"./LogHorizon.ja_jp.json":[6438,3811],"./LogHorizon.ko_kr.json":[8319,5106],"./MagicaLogia.ja_jp.json":[4786,9120],"./MagicaLogia.ko_kr.json":[339,2107],"./MagicaLogia.zh_hans.json":[9116,3229],"./MonotoneMuseum.ja_jp.json":[5628,7848],"./MonotoneMuseum.ko_kr.json":[1302,8157],"./Nechronica.ja_jp.json":[9437,667],"./Nechronica.ko_kr.json":[4241,7743],"./StellarKnights.ja_jp.json":[7251,9206],"./StellarKnights.ko_kr.json":[6697,5717],"./StratoShout.ja_jp.json":[7313,7015],"./StratoShout.ko_kr.json":[424,4113],"./SwordWorld.ja_jp.json":[1243,7348],"./SwordWorld2_0.ja_jp.json":[7547,5351],"./SwordWorld2_5.ja_jp.json":[8368,669]};function y(w){if(!X.o(a,w))return Promise.resolve().then(()=>{var M=new Error("Cannot find module '"+w+"'");throw M.code="MODULE_NOT_FOUND",M});var p=a[w],d=p[0];return X.e(p[1]).then(()=>X.t(d,19))}y.keys=()=>Object.keys(a),y.id=6507,E.exports=y},2480:()=>{},5861:(E,ae,X)=>{"use strict";function a(w,p,d,M,v,D,$){try{var F=w[D]($),oe=F.value}catch(G){return void d(G)}F.done?p(oe):Promise.resolve(oe).then(M,v)}function y(w){return function(){var p=this,d=arguments;return new Promise(function(M,v){var D=w.apply(p,d);function $(oe){a(D,M,v,$,F,"next",oe)}function F(oe){a(D,M,v,$,F,"throw",oe)}$(void 0)})}}X.d(ae,{Z:()=>y})},4682:E=>{"use strict";E.exports=JSON.parse('{"gameSystems":[{"id":"Villaciel","name":"\u84bc\u5929\u306e\u30f4\u30a3\u30e9\u30b7\u30a8\u30eb","className":"Villaciel","superClassName":"Base","sortKey":"\u305d\u3046\u3066\u3093\u306e\u3046\u3044\u3089\u3057\u3048\u308b","locale":"ja_jp"},{"id":"SamsaraBallad","name":"\u30b5\u30f3\u30b5\u30fc\u30e9\u30fb\u30d0\u30e9\u30c3\u30c9","className":"SamsaraBallad","superClassName":"Base","sortKey":"\u3055\u3093\u3055\u3042\u3089\u306f\u3089\u3064\u3068","locale":"ja_jp"},{"id":"Satasupe","name":"\u30b5\u30bf\u30b9\u30da","className":"Satasupe","superClassName":"Base","sortKey":"\u3055\u305f\u3059\u3078","locale":"ja_jp"},{"id":"MagicaLogia:Korean","name":"\ub9c8\uae30\uce74\ub85c\uae30\uc544","className":"MagicaLogia_Korean","superClassName":"MagicaLogia","sortKey":"\u56fd\u969b\u5316:Korean:\ub9c8\uae30\uce74\ub85c\uae30\uc544","locale":"ko_kr"},{"id":"MagicaLogia:SimplifiedChinese","name":"\u9b54\u5bfc\u4e66\u5927\u6218","className":"MagicaLogia_SimplifiedChinese","superClassName":"MagicaLogia","sortKey":"\u56fd\u969b\u5316:Simplified Chinese:\u9b54\u5bfc\u4e66\u5927\u6218","locale":"zh_hans"},{"id":"MeikyuDays","name":"\u8ff7\u5bae\u30c7\u30a4\u30ba","className":"MeikyuDays","superClassName":"Base","sortKey":"\u3081\u3044\u304d\u3086\u3046\u3066\u3044\u3059","locale":"ja_jp"},{"id":"MeikyuKingdom","name":"\u8ff7\u5bae\u30ad\u30f3\u30b0\u30c0\u30e0","className":"MeikyuKingdom","superClassName":"Base","sortKey":"\u3081\u3044\u304d\u3086\u3046\u304d\u3093\u304f\u305f\u3080","locale":"ja_jp"},{"id":"BloodCrusade","name":"\u30d6\u30e9\u30c3\u30c9\u30fb\u30af\u30eb\u30bb\u30a4\u30c9","className":"BloodCrusade","superClassName":"Base","sortKey":"\u3075\u3089\u3064\u3068\u304f\u308b\u305b\u3044\u3068","locale":"ja_jp"},{"id":"BloodMoon","name":"\u30d6\u30e9\u30c3\u30c9\u30e0\u30fc\u30f3","className":"BloodMoon","superClassName":"Base","sortKey":"\u3075\u3089\u3064\u3068\u3080\u3046\u3093","locale":"ja_jp"},{"id":"AFF2e","name":"ADVANCED FIGHTING FANTASY 2nd Edition","className":"AFF2e","superClassName":"Base","sortKey":"\u3042\u3068\u306f\u3093\u3059\u3068\u3075\u3042\u3044\u3066\u3044\u3093\u304f\u3075\u3042\u3093\u305f\u3057\u30442","locale":"ja_jp"},{"id":"CardRanker","name":"\u30ab\u30fc\u30c9\u30e9\u30f3\u30ab\u30fc","className":"CardRanker","superClassName":"Base","sortKey":"\u304b\u3042\u3068\u3089\u3093\u304b\u3042","locale":"ja_jp"},{"id":"CastleInGray","name":"\u7070\u8272\u57ce\u7dba\u8b5a","className":"CastleInGray","superClassName":"Base","sortKey":"\u306f\u3044\u3044\u308d\u3057\u3088\u3046\u304d\u305f\u3093","locale":"ja_jp"},{"id":"ChaosFlare","name":"\u30ab\u30aa\u30b9\u30d5\u30ec\u30a2","className":"ChaosFlare","superClassName":"Base","sortKey":"\u304b\u304a\u3059\u3075\u308c\u3042","locale":"ja_jp"},{"id":"EmbryoMachine","name":"\u30a8\u30e0\u30d6\u30ea\u30aa\u30de\u30b7\u30f3RPG","className":"EmbryoMachine","superClassName":"Base","sortKey":"\u3048\u3080\u3075\u308a\u304a\u307e\u3057\u3093RPG","locale":"ja_jp"},{"id":"AceKillerGene","name":"\u30a8\u30fc\u30b9\u30ad\u30e9\u30fc\u30b8\u30fc\u30f3","className":"AceKillerGene","superClassName":"GardenOrder","sortKey":"\u3048\u3048\u3059\u304d\u3089\u3042\u3057\u3044\u3093","locale":"ja_jp"},{"id":"GardenOrder","name":"\u30ac\u30fc\u30c7\u30f3\u30aa\u30fc\u30c0\u30fc","className":"GardenOrder","superClassName":"Base","sortKey":"\u304b\u3042\u3066\u3093\u304a\u304a\u305f\u3042","locale":"ja_jp"},{"id":"Chill","name":"Chill","className":"Chill","superClassName":"Base","sortKey":"\u3061\u308b","locale":"ja_jp"},{"id":"VisionConnect","name":"\u30f4\u30a3\u30b8\u30e7\u30f3\u30b3\u30cd\u30af\u30c8","className":"VisionConnect","superClassName":"Base","sortKey":"\u3046\u3044\u3057\u3088\u3093\u3053\u306d\u304f\u3068","locale":"ja_jp"},{"id":"Emoklore","name":"\u30a8\u30e2\u30af\u30ed\u30a2TRPG","className":"Emoklore","superClassName":"Base","sortKey":"\u3048\u3082\u304f\u308d\u3042TRPG","locale":"ja_jp"},{"id":"ScreamHighSchool","name":"\u30b9\u30af\u30ea\u30fc\u30e0\u30cf\u30a4\u30b9\u30af\u30fc\u30eb","className":"ScreamHighSchool","superClassName":"GardenOrder","sortKey":"\u3059\u304f\u308a\u3044\u3080\u306f\u3044\u3059\u304f\u3046\u308b","locale":"ja_jp"},{"id":"WARPS","name":"\u30ef\u30fc\u30d7\u30b9","className":"WARPS","superClassName":"Base","sortKey":"\u308f\u3042\u3075\u3059","locale":"ja_jp"},{"id":"Sengensyou","name":"\u5343\u5e7b\u6284","className":"Sengensyou","superClassName":"Base","sortKey":"\u305b\u3093\u3051\u3093\u3057\u3088\u3046","locale":"ja_jp"},{"id":"Chill3","name":"Chill 3rd Edition","className":"Chill3","superClassName":"Base","sortKey":"\u3061\u308b3","locale":"ja_jp"},{"id":"EndBreaker","name":"\u30a8\u30f3\u30c9\u30d6\u30ec\u30a4\u30ab\u30fc\uff01","className":"EndBreaker","superClassName":"Base","sortKey":"\u3048\u3093\u3068\u3075\u308c\u3044\u304b\u3042","locale":"ja_jp"},{"id":"Ainecadette","name":"\u30a8\u30cd\u30ab\u30c7\u30c3\u30c8","className":"Ainecadette","superClassName":"Base","sortKey":"\u3048\u306d\u304b\u3066\u3064\u3068","locale":"ja_jp"},{"id":"CodeLayerd","name":"\u30b3\u30fc\u30c9\uff1a\u30ec\u30a4\u30e4\u30fc\u30c9","className":"CodeLayerd","superClassName":"Base","sortKey":"\u3053\u304a\u3068\u308c\u3044\u3084\u3042\u3068","locale":"ja_jp"},{"id":"ShadowRun","name":"\u30b7\u30e3\u30c9\u30a6\u30e9\u30f3","className":"ShadowRun","superClassName":"Base","sortKey":"\u3057\u3084\u3068\u3046\u3089\u3093","locale":"ja_jp"},{"id":"EtrianOdysseySRS","name":"\u4e16\u754c\u6a39\u306e\u8ff7\u5baeSRS","className":"EtrianOdysseySRS","superClassName":"SRS","sortKey":"\u305b\u304b\u3044\u3057\u3086\u306e\u3081\u3044\u304d\u3086\u3046SRS","locale":"ja_jp"},{"id":"FateCoreSystem","name":"Fate Core System","className":"FateCoreSystem","superClassName":"Base","sortKey":"\u3075\u3048\u3044\u3068\u3053\u3042\u3057\u3059\u3066\u3080","locale":"ja_jp"},{"id":"ShadowRun4","name":"\u30b7\u30e3\u30c9\u30a6\u30e9\u30f3 4th Edition","className":"ShadowRun4","superClassName":"Base","sortKey":"\u3057\u3084\u3068\u3046\u3089\u30934","locale":"ja_jp"},{"id":"Airgetlamh","name":"\u6731\u306e\u5b64\u5854\u306e\u30a8\u30a2\u30b2\u30c8\u30e9\u30e0","className":"Airgetlamh","superClassName":"Base","sortKey":"\u3042\u3051\u306e\u3053\u3068\u3046\u306e\u3048\u3042\u3051\u3068\u3089\u3080","locale":"ja_jp"},{"id":"ColossalHunter","name":"\u30b3\u30ed\u30c3\u30b5\u30eb\u30cf\u30f3\u30bf\u30fc","className":"ColossalHunter","superClassName":"Base","sortKey":"\u3053\u308d\u3064\u3055\u308b\u306f\u3093\u305f\u3042","locale":"ja_jp"},{"id":"Warhammer","name":"\u30a6\u30a9\u30fc\u30cf\u30f3\u30de\u30fc","className":"Warhammer","superClassName":"Base","sortKey":"\u3046\u304a\u304a\u306f\u3093\u307e\u3042","locale":"ja_jp"},{"id":"ShadowRun5","name":"\u30b7\u30e3\u30c9\u30a6\u30e9\u30f3 5th Edition","className":"ShadowRun5","superClassName":"ShadowRun4","sortKey":"\u3057\u3084\u3068\u3046\u3089\u30935","locale":"ja_jp"},{"id":"SevenFortressMobius","name":"\u30bb\u30d6\u30f3\uff1d\u30d5\u30a9\u30fc\u30c8\u30ec\u30b9 \u30e1\u30d3\u30a6\u30b9","className":"SevenFortressMobius","superClassName":"NightWizard","sortKey":"\u305b\u3075\u3093\u3075\u304a\u304a\u3068\u308c\u3059\u3081\u3072\u3046\u3059","locale":"ja_jp"},{"id":"Fiasco","name":"\u30d5\u30a3\u30a2\u30b9\u30b3","className":"Fiasco","superClassName":"Base","sortKey":"\u3075\u3044\u3042\u3059\u3053","locale":"ja_jp"},{"id":"WaresBlade","name":"\u30ef\u30fc\u30b9\u30d6\u30ec\u30a4\u30c9","className":"WaresBlade","superClassName":"Base","sortKey":"\u308f\u3042\u3059\u3075\u308c\u3044\u3068","locale":"ja_jp"},{"id":"SharedFantasia","name":"Shared\u2020Fantasia","className":"SharedFantasia","superClassName":"Base","sortKey":"\u3057\u3048\u3042\u3042\u3068\u3075\u3042\u3093\u305f\u3057\u3042","locale":"ja_jp"},{"id":"ShinMegamiTenseiKakuseihen","name":"\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG \u899a\u9192\u7bc7","className":"ShinMegamiTenseiKakuseihen","superClassName":"Base","sortKey":"\u3057\u3093\u3081\u304b\u307f\u3066\u3093\u305b\u3044TRPG\u304b\u304f\u305b\u3044\u3078\u3093","locale":"ja_jp"},{"id":"AlchemiaStruggle","name":"\u30a2\u30eb\u30b1\u30df\u30a2\u30fb\u30b9\u30c8\u30e9\u30b0\u30eb","className":"AlchemiaStruggle","superClassName":"Base","sortKey":"\u3042\u308b\u3051\u307f\u3042\u3059\u3068\u3089\u304f\u308b","locale":"ja_jp"},{"id":"Fiasco:Korean","name":"\ud53c\uc544\uc2a4\ucf54","className":"Fiasco_Korean","superClassName":"Fiasco","sortKey":"\u56fd\u969b\u5316:Korean:\ud53c\uc544\uc2a4\ucf54","locale":"ko_kr"},{"id":"FilledWith","name":"\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba","className":"FilledWith","superClassName":"Base","sortKey":"\u3075\u3044\u308b\u3068\u3046\u3044\u3059","locale":"ja_jp"},{"id":"ShinkuuGakuen","name":"\u771f\u7a7a\u5b66\u5712","className":"ShinkuuGakuen","superClassName":"Base","sortKey":"\u3057\u3093\u304f\u3046\u304b\u304f\u3048\u3093","locale":"ja_jp"},{"id":"Comes","name":"\u30ab\u30e0\u30ba","className":"Comes","superClassName":"Base","sortKey":"\u304b\u3080\u3059","locale":"ja_jp"},{"id":"CrashWorld","name":"\u589c\u843d\u4e16\u754c","className":"CrashWorld","superClassName":"Base","sortKey":"\u3064\u3044\u3089\u304f\u305b\u304b\u3044","locale":"ja_jp"},{"id":"Warhammer4","name":"\u30a6\u30a9\u30fc\u30cf\u30f3\u30de\u30fcRPG\u7b2c4\u7248","className":"Warhammer4","superClassName":"Base","sortKey":"\u3046\u304a\u304a\u306f\u3093\u307e\u30424","locale":"ja_jp"},{"id":"Cthulhu","name":"\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG","className":"Cthulhu","superClassName":"Base","sortKey":"\u304f\u3068\u3046\u308b\u3075\u3057\u3093\u308fTRPG","locale":"ja_jp"},{"id":"WitchQuest","name":"\u30a6\u30a3\u30c3\u30c1\u30af\u30a8\u30b9\u30c8","className":"WitchQuest","superClassName":"Base","sortKey":"\u3046\u3044\u3064\u3061\u304f\u3048\u3059\u3068","locale":"ja_jp"},{"id":"Alsetto","name":"\u8a69\u7247\u306e\u30a2\u30eb\u30bb\u30c3\u30c8","className":"Alsetto","superClassName":"Base","sortKey":"\u3046\u305f\u304b\u305f\u306e\u3042\u308b\u305b\u3064\u3068","locale":"ja_jp"},{"id":"Alshard","name":"\u30a2\u30eb\u30b7\u30e3\u30fc\u30c9","className":"Alshard","superClassName":"SRS","sortKey":"\u3042\u308b\u3057\u3084\u3042\u3068","locale":"ja_jp"},{"id":"SRS","name":"\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0","className":"SRS","superClassName":"Base","sortKey":"\u3059\u305f\u3093\u305f\u3042\u3068RPG\u3057\u3059\u3066\u3080","locale":"ja_jp"},{"id":"WorldOfDarkness","name":"\u30ef\u30fc\u30eb\u30c9\u30fb\u30aa\u30d6\u30fb\u30c0\u30fc\u30af\u30cd\u30b9","className":"WorldOfDarkness","superClassName":"Base","sortKey":"\u308f\u3042\u308b\u3068\u304a\u3075\u305f\u3042\u304f\u306d\u3059","locale":"ja_jp"},{"id":"MeikyuKingdomBasic","name":"\u8ff7\u5bae\u30ad\u30f3\u30b0\u30c0\u30e0 \u57fa\u672c\u30eb\u30fc\u30eb\u30d6\u30c3\u30af","className":"MeikyuKingdomBasic","superClassName":"MeikyuKingdom","sortKey":"\u3081\u3044\u304d\u3086\u3046\u304d\u3093\u304f\u305f\u3080\u304d\u307b\u3093\u308b\u3046\u308b\u3075\u3064\u304f","locale":"ja_jp"},{"id":"Cthulhu7th","name":"\u65b0\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG","className":"Cthulhu7th","superClassName":"Base","sortKey":"\u3057\u3093\u304f\u3068\u3046\u308b\u3075\u3057\u3093\u308fTRPG","locale":"ja_jp"},{"id":"YankeeYogSothoth","name":"\u30e4\u30f3\u30ad\u30fc\uff06\u30e8\u30b0\uff1d\u30bd\u30c8\u30fc\u30b9","className":"YankeeYogSothoth","superClassName":"Base","sortKey":"\u3084\u3093\u304d\u3044\u3042\u3093\u3068\u3088\u304f\u305d\u3068\u304a\u3059","locale":"ja_jp"},{"id":"ShinobiGami","name":"\u30b7\u30ce\u30d3\u30ac\u30df","className":"ShinobiGami","superClassName":"Base","sortKey":"\u3057\u306e\u3072\u304b\u307f","locale":"ja_jp"},{"id":"YearZeroEngine","name":"YearZeroEngine","className":"YearZeroEngine","superClassName":"Base","sortKey":"\u3044\u3084\u3042\u305b\u308d\u3048\u3093\u3057\u3093","locale":"ja_jp"},{"id":"FullMetalPanic","name":"\u30d5\u30eb\u30e1\u30bf\u30eb\u30fb\u30d1\u30cb\u30c3\u30af\uff01RPG","className":"FullMetalPanic","superClassName":"SRS","sortKey":"\u3075\u308b\u3081\u305f\u308b\u306f\u306b\u3064\u304fRPG","locale":"ja_jp"},{"id":"FutariSousa","name":"\u30d5\u30bf\u30ea\u30bd\u30a6\u30b5","className":"FutariSousa","superClassName":"Base","sortKey":"\u3075\u305f\u308a\u305d\u3046\u3055","locale":"ja_jp"},{"id":"FutariSousa:Korean","name":"\ub458\uc774\uc11c \uc218\uc0ac(\ud6c4\ud0c0\ub9ac\uc18c\uc6b0\uc0ac)","className":"FutariSousa_Korean","superClassName":"FutariSousa","sortKey":"\u56fd\u969b\u5316:Korean:\ub458\uc774\uc11c \uc218\uc0ac","locale":"ko_kr"},{"id":"Garako","name":"\u30ac\u30e9\u30b3\u3068\u7834\u754c\u306e\u5854","className":"Garako","superClassName":"Base","sortKey":"\u304b\u3089\u3053\u3068\u306f\u304b\u3044\u306e\u3068\u3046","locale":"ja_jp"},{"id":"Shiranui","name":"\u4e0d\u77e5\u706b","className":"Shiranui","superClassName":"Base","sortKey":"\u3057\u3089\u306c\u3044","locale":"ja_jp"},{"id":"GehennaAn","name":"\u30b2\u30d8\u30ca\u30fb\u30a2\u30ca\u30b9\u30bf\u30b7\u30b9","className":"GehennaAn","superClassName":"Base","sortKey":"\u3051\u3078\u306a\u3042\u306a\u3059\u305f\u3057\u3059","locale":"ja_jp"},{"id":"ShuumatsuKikou","name":"\u7d42\u672b\u7d00\u884c\uff32\uff30\uff27","className":"ShuumatsuKikou","superClassName":"Base","sortKey":"\u3057\u3086\u3046\u307e\u3064\u304d\u3053\u3046","locale":"ja_jp"},{"id":"Yggdrasill","name":"\u92fc\u9244\u306e\u30e6\u30b0\u30c9\u30e9\u30b7\u30eb","className":"Yggdrasill","superClassName":"Base","sortKey":"\u3053\u3046\u3066\u3064\u306e\u3086\u304f\u3068\u3089\u3057\u308b","locale":"ja_jp"},{"id":"Skynauts","name":"\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb\uff08\u516d\u7573\u9593\u5e7b\u60f3\u7a7a\u9593\uff09","className":"Skynauts","superClassName":"Base","sortKey":"\u306f\u304f\u308b\u307e\u306e\u3068\u3046\u306e\u3059\u304b\u3044\u306e\u304a\u3064","locale":"ja_jp"},{"id":"GeishaGirlwithKatana","name":"\u30b2\u30a4\u30b7\u30e3\u30fb\u30ac\u30fc\u30eb\u30fb\u30a6\u30a3\u30ba\u30fb\u30ab\u30bf\u30ca","className":"GeishaGirlwithKatana","superClassName":"Base","sortKey":"\u3051\u3044\u3057\u3084\u304b\u3042\u308b\u3046\u3044\u3059\u304b\u305f\u306a","locale":"ja_jp"},{"id":"AlterRaise","name":"\u30a2\u30eb\u30c8\u30ec\u30a4\u30ba","className":"AlterRaise","superClassName":"Base","sortKey":"\u3042\u308b\u3068\u308c\u3044\u3059","locale":"ja_jp"},{"id":"GhostLive","name":"\u5b9f\u6cc1\u30b4\u30fc\u30b9\u30c8\u30e9\u30a4\u30f4","className":"GhostLive","superClassName":"Base","sortKey":"\u3057\u3064\u304d\u3088\u3046\u3053\u304a\u3059\u3068\u3089\u3044\u3075","locale":"ja_jp"},{"id":"GoblinSlayer","name":"\u30b4\u30d6\u30ea\u30f3\u30b9\u30ec\u30a4\u30e4\u30fcTRPG","className":"GoblinSlayer","superClassName":"Base","sortKey":"\u3053\u3075\u308a\u3093\u3059\u308c\u3044\u3084\u3042TRPG","locale":"ja_jp"},{"id":"Amadeus","name":"\u30a2\u30de\u30c7\u30a6\u30b9","className":"Amadeus","superClassName":"Base","sortKey":"\u3042\u307e\u3066\u3046\u3059","locale":"ja_jp"},{"id":"SkynautsBouken","name":"\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb\uff08\u5192\u967a\u4f01\u753b\u5c40\uff09","className":"SkynautsBouken","superClassName":"Base","sortKey":"\u306f\u304f\u308b\u307e\u306e\u3068\u3046\u306e\u3059\u304b\u3044\u306e\u304a\u30642","locale":"ja_jp"},{"id":"Amadeus:Korean","name":"\uc544\ub9c8\ub370\uc6b0\uc2a4","className":"Amadeus_Korean","superClassName":"Amadeus","sortKey":"\u56fd\u969b\u5316:Korean:\uc544\ub9c8\ub370\uc6b0\uc2a4","locale":"ko_kr"},{"id":"AngelGear","name":"\u30a8\u30f3\u30bc\u30eb\u30ae\u30a2 \u5929\u4f7f\u5927\u6226TRPG The 2nd Editon","className":"AngelGear","superClassName":"Base","sortKey":"\u3048\u3093\u305b\u308b\u304d\u30422","locale":"ja_jp"},{"id":"MetalHead","name":"\u30e1\u30bf\u30eb\u30d8\u30c3\u30c9","className":"MetalHead","superClassName":"Base","sortKey":"\u3081\u305f\u308b\u3078\u3064\u3068","locale":"ja_jp"},{"id":"GoldenSkyStories","name":"\u3086\u3046\u3084\u3051\u3053\u3084\u3051","className":"GoldenSkyStories","superClassName":"Base","sortKey":"\u3086\u3046\u3084\u3051\u3053\u3084\u3051","locale":"ja_jp"},{"id":"AnimaAnimus","name":"\u30a2\u30cb\u30de\u30a2\u30cb\u30e0\u30b9","className":"AnimaAnimus","superClassName":"Base","sortKey":"\u3042\u306b\u307e\u3042\u306b\u3080\u3059","locale":"ja_jp"},{"id":"Cthulhu7th:ChineseTraditional","name":"\u514b\u8607\u9b6f\u795e\u8a71\u7b2c7\u7248","className":"Cthulhu7th_ChineseTraditional","superClassName":"Base","sortKey":"\u56fd\u969b\u5316:Chinese Traditional:\u514b\u8607\u9b6f\u795e\u8a71\u7b2c7\u7248","locale":"ja_jp"},{"id":"GranCrest","name":"\u30b0\u30e9\u30f3\u30af\u30ec\u30b9\u30c8RPG","className":"GranCrest","superClassName":"Base","sortKey":"\u304f\u3089\u3093\u304f\u308c\u3059\u3068RPG","locale":"ja_jp"},{"id":"Gorilla","name":"\u30b4\u30ea\u30e9TRPG","className":"Gorilla","superClassName":"Base","sortKey":"\u3053\u308a\u3089TRPG","locale":"ja_jp"},{"id":"Gundog","name":"\u30ac\u30f3\u30c9\u30c3\u30b0","className":"Gundog","superClassName":"Base","sortKey":"\u304b\u3093\u3068\u3064\u304f","locale":"ja_jp"},{"id":"ZettaiReido","name":"\u7d76\u5bfe\u96b7\u5974","className":"ZettaiReido","superClassName":"Base","sortKey":"\u305b\u3064\u305f\u3044\u308c\u3044\u3068","locale":"ja_jp"},{"id":"Aoharubaan","name":"\u3042\u304a\u306f\u308b\u3070\u30fc\u3093\u3063","className":"Aoharubaan","superClassName":"Base","sortKey":"\u3042\u304a\u306f\u308b\u306f\u3042\u3093\u3064","locale":"ja_jp"},{"id":"GundogRevised","name":"\u30ac\u30f3\u30c9\u30c3\u30b0\u30fb\u30ea\u30f4\u30a1\u30a4\u30ba\u30c9","className":"GundogRevised","superClassName":"Base","sortKey":"\u304b\u3093\u3068\u3064\u304f\u308a\u3046\u3042\u3044\u3059\u3068","locale":"ja_jp"},{"id":"MetalHeadExtream","name":"\u30e1\u30bf\u30eb\u30d8\u30c3\u30c9\u30a8\u30af\u30b9\u30c8\u30ea\u30fc\u30e0","className":"MetalHeadExtream","superClassName":"Base","sortKey":"\u3081\u305f\u308b\u3078\u3064\u3068\u3048\u304f\u3059\u3068\u308a\u3044\u3080","locale":"ja_jp"},{"id":"SteamPunkers","name":"\u30b9\u30c1\u30fc\u30e0\u30d1\u30f3\u30ab\u30fc\u30ba","className":"SteamPunkers","superClassName":"Base","sortKey":"\u3059\u3061\u3044\u3080\u306f\u3093\u304b\u3042\u3059","locale":"ja_jp"},{"id":"GundogZero","name":"\u30ac\u30f3\u30c9\u30c3\u30b0\u30bc\u30ed","className":"GundogZero","superClassName":"Gundog","sortKey":"\u304b\u3093\u3068\u3064\u304f\u305b\u308d","locale":"ja_jp"},{"id":"GURPS","name":"\u30ac\u30fc\u30d7\u30b9","className":"GURPS","superClassName":"Base","sortKey":"\u304b\u3042\u3075\u3059","locale":"ja_jp"},{"id":"Cthulhu7th:Korean","name":"\ud06c\ud234\ub8e8\uc758 \ubd80\ub984 7\ud310","className":"Cthulhu7th_Korean","superClassName":"Base","sortKey":"\u56fd\u969b\u5316:Korean:\ud06c\ud234\ub8e8\uc758 \ubd80\ub984 7\ud310","locale":"ja_jp"},{"id":"CthulhuTech","name":"\u30af\u30c8\u30a5\u30eb\u30d5\u30c6\u30c3\u30af","className":"CthulhuTech","superClassName":"Base","sortKey":"\u304f\u3068\u3046\u308b\u3075\u3066\u3064\u304f","locale":"ja_jp"},{"id":"StellarKnights","name":"\u9280\u5263\u306e\u30b9\u30c6\u30e9\u30ca\u30a4\u30c4","className":"StellarKnights","superClassName":"Base","sortKey":"\u304d\u3093\u3051\u3093\u306e\u3059\u3066\u3089\u306a\u3044\u3064","locale":"ja_jp"},{"id":"StarryDolls","name":"\u30b9\u30bf\u30ea\u30a3\u30c9\u30fc\u30eb","className":"StarryDolls","superClassName":"Base","sortKey":"\u3059\u305f\u308a\u3044\u3068\u304a\u308b","locale":"ja_jp"},{"id":"Arianrhod","name":"\u30a2\u30ea\u30a2\u30f3\u30ed\u30c3\u30c9RPG","className":"Arianrhod","superClassName":"Base","sortKey":"\u3042\u308a\u3042\u3093\u308d\u3064\u3068RPG","locale":"ja_jp"},{"id":"GurpsFW","name":"\u30ac\u30fc\u30d7\u30b9\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba","className":"GurpsFW","superClassName":"Base","sortKey":"\u304b\u3042\u3075\u3059\u3075\u3044\u308b\u3068\u3046\u3044\u3059","locale":"ja_jp"},{"id":"ArsMagica","name":"\u30a2\u30eb\u30b9\u30de\u30ae\u30ab","className":"ArsMagica","superClassName":"Base","sortKey":"\u3042\u308b\u3059\u307e\u304d\u304b","locale":"ja_jp"},{"id":"StellarKnights:Korean","name":"\uc740\uac80\uc758 \uc2a4\ud154\ub77c\ub098\uc774\uce20","className":"StellarKnights_Korean","superClassName":"StellarKnights","sortKey":"\u56fd\u969b\u5316:Korean:\uc740\uac80\uc758 \uc2a4\ud154\ub77c\ub098\uc774\uce20","locale":"ko_kr"},{"id":"StellarLife","name":"\u30b9\u30c6\u30e9\u30fc\u30e9\u30a4\u30d5TRPG","className":"StellarLife","superClassName":"Base","sortKey":"\u3059\u3066\u3089\u3042\u3089\u3044\u3075TRPG","locale":"ja_jp"},{"id":"Cthulhu:ChineseTraditional","name":"\u514b\u8607\u9b6f\u795e\u8a71","className":"Cthulhu_ChineseTraditional","superClassName":"Cthulhu","sortKey":"\u56fd\u969b\u5316:Chinese Traditional:\u514b\u8607\u9b6f\u795e\u8a71","locale":"zh_hant"},{"id":"AssaultEngine","name":"\u30a2\u30b5\u30eb\u30c8\u30a8\u30f3\u30b8\u30f3","className":"AssaultEngine","superClassName":"Base","sortKey":"\u3042\u3055\u308b\u3068\u3048\u3093\u3057\u3093","locale":"ja_jp"},{"id":"Cthulhu:Korean","name":"\ud06c\ud234\ub8e8","className":"Cthulhu_Korean","superClassName":"Cthulhu","sortKey":"\u56fd\u969b\u5316:Korean:\ud06c\ud234\ub8e8","locale":"ko_kr"},{"id":"Cthulhu:SimplifiedChinese","name":"\u514b\u82cf\u9c81\u7684\u547c\u5524 \u7b2c\u516d\u7248","className":"Cthulhu_SimplifiedChinese","superClassName":"Cthulhu","sortKey":"\u56fd\u969b\u5316:Simplified Chinese:\u514b\u82cf\u9c81\u7684\u547c\u5524 \u7b2c\u516d\u7248","locale":"zh_hans"},{"id":"StratoShout","name":"\u30b9\u30c8\u30e9\u30c8\u30b7\u30e3\u30a6\u30c8","className":"StratoShout","superClassName":"Base","sortKey":"\u3059\u3068\u3089\u3068\u3057\u3084\u3046\u3068","locale":"ja_jp"},{"id":"CyberpunkRed","name":"\u30b5\u30a4\u30d0\u30fc\u30d1\u30f3\u30afRED (\u30d1\u30c3\u30c1\u7248)","className":"CyberpunkRed","superClassName":"Base","sortKey":"\u3055\u3044\u306f\u3042\u306f\u3093\u304f\u308c\u3064\u3068","locale":"ja_jp"},{"id":"StrangerOfSwordCity","name":"\u5263\u306e\u8857\u306e\u7570\u90a6\u4ebaTRPG","className":"StrangerOfSwordCity","superClassName":"Base","sortKey":"\u3064\u308b\u304d\u306e\u307e\u3061\u306e\u3044\u307b\u3046\u3057\u3093TRPG","locale":"ja_jp"},{"id":"StratoShout:Korean","name":"\uc2a4\ud2b8\ub77c\ud1a0 \uc0e4\uc6b0\ud2b8","className":"StratoShout_Korean","superClassName":"StratoShout","sortKey":"\u56fd\u969b\u5316:Korean:\uc2a4\ud2b8\ub77c\ud1a0 \uc0e4\uc6b0\ud2b8","locale":"ko_kr"},{"id":"HarnMaster","name":"\u30cf\u30fc\u30f3\u30de\u30b9\u30bf\u30fc","className":"HarnMaster","superClassName":"Base","sortKey":"\u306f\u3042\u3093\u307e\u3059\u305f\u3042","locale":"ja_jp"},{"id":"Avandner","name":"\u9ed2\u7d62\u306e\u30a2\u30f4\u30a1\u30f3\u30c9\u30ca\u30fc","className":"Avandner","superClassName":"Base","sortKey":"\u3053\u3064\u3051\u3093\u306e\u3042\u3046\u3042\u3093\u3068\u306a\u3042","locale":"ja_jp"},{"id":"Ayabito","name":"\u3042\u3084\u3073\u3068","className":"Ayabito","superClassName":"Base","sortKey":"\u3042\u3084\u3072\u3068","locale":"ja_jp"},{"id":"MetallicGuardian","name":"\u30e1\u30bf\u30ea\u30c3\u30af\u30ac\u30fc\u30c7\u30a3\u30a2\u30f3RPG","className":"MetallicGuardian","superClassName":"SRS","sortKey":"\u3081\u305f\u308a\u3064\u304f\u304b\u3042\u3066\u3044\u3042\u3093RPG","locale":"ja_jp"},{"id":"MonotoneMuseum","name":"\u30e2\u30ce\u30c8\u30fc\u30f3\u30df\u30e5\u30fc\u30b8\u30a2\u30e0RPG","className":"MonotoneMuseum","superClassName":"Base","sortKey":"\u3082\u306e\u3068\u304a\u3093\u307f\u3086\u3046\u3057\u3042\u3080RPG","locale":"ja_jp"},{"id":"SwordWorld","name":"\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c9RPG","className":"SwordWorld","superClassName":"Base","sortKey":"\u305d\u304a\u3068\u308f\u3042\u308b\u3068","locale":"ja_jp"},{"id":"MonotoneMuseum:Korean","name":"\ubaa8\ub178\ud1a4 \ubba4\uc9c0\uc5c4","className":"MonotoneMuseum_Korean","superClassName":"MonotoneMuseum","sortKey":"\u56fd\u969b\u5316:Korean:\ubaa8\ub178\ud1a4 \ubba4\uc9c0\uc5c4","locale":"ko_kr"},{"id":"Bakenokawa","name":"\u30d0\u30b1\u30ce\u30ab\u30ef","className":"Bakenokawa","superClassName":"Base","sortKey":"\u306f\u3051\u306e\u304b\u308f","locale":"ja_jp"},{"id":"Nechronica","name":"\u30cd\u30af\u30ed\u30cb\u30ab","className":"Nechronica","superClassName":"Base","sortKey":"\u306d\u304f\u308d\u306b\u304b","locale":"ja_jp"},{"id":"HatsuneMiku","name":"\u521d\u97f3\u30df\u30afTRPG \u30b3\u30b3\u30ed\u30c0\u30f3\u30b8\u30e7\u30f3","className":"HatsuneMiku","superClassName":"Base","sortKey":"\u306f\u3064\u306d\u307f\u304fTRPG\u3053\u3053\u308d\u305f\u3093\u3057\u3088\u3093","locale":"ja_jp"},{"id":"Strave","name":"\u78a7\u7a7a\u306e\u30b9\u30c8\u30ec\u30a4\u30f4","className":"Strave","superClassName":"Base","sortKey":"\u3078\u304d\u304f\u3046\u306e\u3059\u3068\u308c\u3044\u3075","locale":"ja_jp"},{"id":"BBN","name":"BBNTRPG","className":"BBN","superClassName":"Base","sortKey":"\u3072\u3044\u3072\u3044\u3048\u306cTRPG","locale":"ja_jp"},{"id":"Nechronica:Korean","name":"\ub124\ud06c\ub85c\ub2c8\uce74","className":"Nechronica_Korean","superClassName":"Nechronica","sortKey":"\u56fd\u969b\u5316:Korean:\ub124\ud06c\ub85c\ub2c8\uce74","locale":"ko_kr"},{"id":"NeverCloud","name":"\u30cd\u30d0\u30fc\u30af\u30e9\u30a6\u30c9TRPG","className":"NeverCloud","superClassName":"Base","sortKey":"\u306d\u306f\u3042\u304f\u3089\u3046\u3068TRPG","locale":"ja_jp"},{"id":"BadLife","name":"\u30d0\u30c3\u30c9\u30e9\u30a4\u30d5","className":"BadLife","superClassName":"Base","sortKey":"\u306f\u3064\u3068\u3089\u3044\u3075","locale":"ja_jp"},{"id":"Hieizan","name":"\u6bd4\u53e1\u5c71\u708e\u4e0a","className":"Hieizan","superClassName":"Base","sortKey":"\u3072\u3048\u3044\u3055\u3093\u3048\u3093\u3057\u3088\u3046","locale":"ja_jp"},{"id":"HouraiGakuen","name":"\u84ec\u83b1\u5b66\u5712\u306e\u5192\u967a!!","className":"HouraiGakuen","superClassName":"Base","sortKey":"\u307b\u3046\u3089\u3044\u304b\u304f\u3048\u3093\u306e\u307b\u3046\u3051\u3093","locale":"ja_jp"},{"id":"NightWizard","name":"\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 2nd Edition","className":"NightWizard","superClassName":"Base","sortKey":"\u306a\u3044\u3068\u3046\u3044\u3055\u3042\u30682","locale":"ja_jp"},{"id":"DarkBlaze","name":"\u30c0\u30fc\u30af\u30d6\u30ec\u30a4\u30ba","className":"DarkBlaze","superClassName":"Base","sortKey":"\u305f\u3042\u304f\u3075\u308c\u3044\u3059","locale":"ja_jp"},{"id":"BarnaKronika","name":"\u30d0\u30eb\u30ca\u30fb\u30af\u30ed\u30cb\u30ab","className":"BarnaKronika","superClassName":"Base","sortKey":"\u306f\u308b\u306a\u304f\u308d\u306b\u304b","locale":"ja_jp"},{"id":"DarkDaysDrive","name":"\u30c0\u30fc\u30af\u30c7\u30a4\u30ba\u30c9\u30e9\u30a4\u30d6","className":"DarkDaysDrive","superClassName":"Base","sortKey":"\u305f\u3042\u304f\u3066\u3044\u3059\u3068\u3089\u3044\u3075","locale":"ja_jp"},{"id":"DarkSouls","name":"\u30c0\u30fc\u30af\u30bd\u30a6\u30ebTRPG","className":"DarkSouls","superClassName":"Base","sortKey":"\u305f\u3042\u304f\u305d\u3046\u308bTRPG","locale":"ja_jp"},{"id":"NightWizard3rd","name":"\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 3rd Edition","className":"NightWizard3rd","superClassName":"NightWizard","sortKey":"\u306a\u3044\u3068\u3046\u3044\u3055\u3042\u30683","locale":"ja_jp"},{"id":"NightmareHunterDeep","name":"\u30ca\u30a4\u30c8\u30e1\u30a2\u30cf\u30f3\u30bf\u30fc=\u30c7\u30a3\u30fc\u30d7","className":"NightmareHunterDeep","superClassName":"Base","sortKey":"\u306a\u3044\u3068\u3081\u3042\u306f\u3093\u305f\u3042\u3066\u3044\u3044\u3075","locale":"ja_jp"},{"id":"BattleTech","name":"\u30d0\u30c8\u30eb\u30c6\u30c3\u30af","className":"BattleTech","superClassName":"Base","sortKey":"\u306f\u3068\u308b\u3066\u3064\u304f","locale":"ja_jp"},{"id":"HuntersMoon","name":"\u30cf\u30f3\u30bf\u30fc\u30ba\u30fb\u30e0\u30fc\u30f3","className":"HuntersMoon","superClassName":"Base","sortKey":"\u306f\u3093\u305f\u3042\u3059\u3080\u3046\u3093","locale":"ja_jp"},{"id":"DeadlineHeroes","name":"\u30c7\u30c3\u30c9\u30e9\u30a4\u30f3\u30d2\u30fc\u30ed\u30fc\u30baRPG","className":"DeadlineHeroes","superClassName":"Base","sortKey":"\u3066\u3064\u3068\u3089\u3044\u3093\u3072\u3044\u308d\u304a\u3059RPG","locale":"ja_jp"},{"id":"NinjaSlayer","name":"\u30cb\u30f3\u30b8\u30e3\u30b9\u30ec\u30a4\u30e4\u30fcTRPG","className":"NinjaSlayer","superClassName":"Base","sortKey":"\u306b\u3093\u3057\u3084\u3059\u308c\u3044\u3084\u3042RPG","locale":"ja_jp"},{"id":"IfIfIf","name":"\u30a4\u30d5\u30fb\u30a4\u30d5\u30fb\u30a4\u30d5","className":"IfIfIf","superClassName":"Base","sortKey":"\u3044\u3075\u3044\u3075\u3044\u3075","locale":"ja_jp"},{"id":"SwordWorld2.0","name":"\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.0","className":"SwordWorld2_0","superClassName":"SwordWorld","sortKey":"\u305d\u304a\u3068\u308f\u3042\u308b\u30682.0","locale":"ja_jp"},{"id":"NjslyrBattle","name":"NJSLYRBATTLE","className":"NjslyrBattle","superClassName":"Base","sortKey":"\u306b\u3093\u3057\u3084\u3059\u308c\u3044\u3084\u3042\u306f\u3068\u308b","locale":"ja_jp"},{"id":"NSSQ","name":"SRS\u3058\u3083\u306a\u3044\u4e16\u754c\u6a39\u306e\u8ff7\u5baeTRPG","className":"NSSQ","superClassName":"Base","sortKey":"\u3048\u3059\u3042\u3042\u308b\u3048\u3059\u3057\u3084\u306a\u3044\u305b\u304b\u3044\u3057\u3086\u306e\u3081\u3044\u304d\u3086\u3046TRPG","locale":"ja_jp"},{"id":"DemonParasite","name":"\u30c7\u30e2\u30f3\u30d1\u30e9\u30b5\u30a4\u30c8","className":"DemonParasite","superClassName":"Base","sortKey":"\u3066\u3082\u3093\u306f\u3089\u3055\u3044\u3068","locale":"ja_jp"},{"id":"SwordWorld2.5","name":"\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.5","className":"SwordWorld2_5","superClassName":"SwordWorld2_0","sortKey":"\u305d\u304a\u3068\u308f\u3042\u308b\u30682.5","locale":"ja_jp"},{"id":"Illusio","name":"\u6643\u5929\u306e\u30a4\u30eb\u30fc\u30b8\u30aa","className":"Illusio","superClassName":"Base","sortKey":"\u3053\u3046\u3066\u3093\u306e\u3044\u308b\u3046\u3057\u304a","locale":"ja_jp"},{"id":"TalesFromTheLoop","name":"\u30b6\u30fb\u30eb\u30fc\u30d7TRPG","className":"TalesFromTheLoop","superClassName":"Base","sortKey":"\u3055\u308b\u3046\u3075TRPG","locale":"ja_jp"},{"id":"Nuekagami","name":"\u9d7a\u93e1","className":"Nuekagami","superClassName":"Base","sortKey":"\u306c\u3048\u304b\u304b\u307f","locale":"ja_jp"},{"id":"OneWayHeroics","name":"\u7247\u9053\u52c7\u8005TRPG","className":"OneWayHeroics","superClassName":"Base","sortKey":"\u304b\u305f\u307f\u3061\u3086\u3046\u3057\u3084TRPG","locale":"ja_jp"},{"id":"InfiniteBabeL","name":"\u5c11\u5e74\u306e\u305f\u3081\u306e\u5c11\u5973\u5c55\u721b\u4f1a\u7570\u805e Infinite BabeL","className":"InfiniteBabeL","superClassName":"ShoujoTenrankai","sortKey":"\u3057\u3088\u3046\u306d\u3093\u306e\u305f\u3081\u306e\u3057\u3088\u3046\u3057\u3088\u3066\u3093\u3089\u3093\u304b\u3044\u3044\u3075\u3093\u3044\u3093\u3075\u3044\u306b\u3064\u3068\u306f\u3078\u308b","locale":"ja_jp"},{"id":"DesperateRun","name":"Desperate Run TRPG","className":"DesperateRun","superClassName":"Base","sortKey":"\u3066\u3059\u3078\u308c\u3044\u3068\u3089\u3093TRPG","locale":"ja_jp"},{"id":"ShoujoTenrankai","name":"\u5c11\u5973\u5c55\u721b\u4f1aTRPG","className":"ShoujoTenrankai","superClassName":"Base","sortKey":"\u3057\u3088\u3046\u3057\u3088\u3066\u3093\u3089\u3093\u304b\u3044TRPG","locale":"ja_jp"},{"id":"TherapieSein","name":"\u30bb\u30e9\u30d5\u30a3\u30b6\u30a4\u30f3","className":"TherapieSein","superClassName":"Base","sortKey":"\u305b\u3089\u3075\u3044\u3055\u3044\u3093","locale":"ja_jp"},{"id":"TokumeiTenkousei","name":"\u7279\u547d\u8ee2\u653b\u751f","className":"TokumeiTenkousei","superClassName":"Base","sortKey":"\u3068\u304f\u3081\u3044\u3066\u3093\u3053\u3046\u305b\u3044","locale":"ja_jp"},{"id":"DetatokoSaga","name":"\u3067\u305f\u3068\u3053\u30b5\u30fc\u30ac","className":"DetatokoSaga","superClassName":"Base","sortKey":"\u3066\u305f\u3068\u3053\u3055\u3042\u304b","locale":"ja_jp"},{"id":"InfiniteFantasia","name":"\u7121\u9650\u306e\u30d5\u30a1\u30f3\u30bf\u30b8\u30a2","className":"InfiniteFantasia","superClassName":"Base","sortKey":"\u3080\u3051\u3093\u306e\u3075\u3042\u3093\u305f\u3057\u3042","locale":"ja_jp"},{"id":"Insane","name":"\u30a4\u30f3\u30bb\u30a4\u30f3","className":"Insane","superClassName":"Base","sortKey":"\u3044\u3093\u305b\u3044\u3093","locale":"ja_jp"},{"id":"TokyoGhostResearch","name":"\u6771\u4eac\u30b4\u30fc\u30b9\u30c8\u30ea\u30b5\u30fc\u30c1","className":"TokyoGhostResearch","superClassName":"Base","sortKey":"\u3068\u3046\u304d\u3088\u3046\u3053\u304a\u3059\u3068\u308a\u3055\u3042\u3061","locale":"ja_jp"},{"id":"Insane:Korean","name":"\uc778\uc138\uc778","className":"Insane_Korean","superClassName":"Insane","sortKey":"\u56fd\u969b\u5316:Korean:\uc778\uc138\uc778","locale":"ko_kr"},{"id":"Irisbane","name":"\u77b3\u9038\u3089\u3055\u306c\u30a4\u30ea\u30b9\u30d9\u30a4\u30f3","className":"Irisbane","superClassName":"Base","sortKey":"\u3072\u3068\u307f\u305d\u3089\u3055\u306c\u3044\u308a\u3059\u3078\u3044\u3093","locale":"ja_jp"},{"id":"BeastBindTrinity","name":"\u30d3\u30fc\u30b9\u30c8\u30d0\u30a4\u30f3\u30c9 \u30c8\u30ea\u30cb\u30c6\u30a3","className":"BeastBindTrinity","superClassName":"Base","sortKey":"\u3072\u3044\u3059\u3068\u306f\u3044\u3093\u3068\u3068\u308a\u306b\u3066\u3044","locale":"ja_jp"},{"id":"TokyoNova","name":"\u30c8\u30fc\u30ad\u30e7\u30fcN\u25ceVA","className":"TokyoNova","superClassName":"Base","sortKey":"\u3068\u304a\u304d\u3088\u304a\u306e\u306f","locale":"ja_jp"},{"id":"Torg","name":"\u30c8\u30fc\u30b0","className":"Torg","superClassName":"Base","sortKey":"\u3068\u304a\u304f","locale":"ja_jp"},{"id":"DetatokoSaga:Korean","name":"\ub370\ud0c0\ud1a0\ucf54 \uc0ac\uac00","className":"DetatokoSaga_Korean","superClassName":"DetatokoSaga","sortKey":"\u56fd\u969b\u5316:Korean:\ub370\ud0c0\ud1a0\ucf54 \uc0ac\uac00","locale":"ko_kr"},{"id":"DiceOfTheDead","name":"\u30c0\u30a4\u30b9\u30fb\u30aa\u30d6\u30fb\u30b6\u30fb\u30c7\u30c3\u30c9","className":"DiceOfTheDead","superClassName":"Base","sortKey":"\u305f\u3044\u3059\u304a\u3075\u3055\u3066\u3064\u3068","locale":"ja_jp"},{"id":"IthaWenUa","name":"\u30a4\u30b5\u30fc\u30fb\u30a6\u30a7\u30f3\uff1d\u30a2\u30fc","className":"IthaWenUa","superClassName":"Base","sortKey":"\u3044\u3055\u3042\u3046\u3048\u3093\u3042\u3042","locale":"ja_jp"},{"id":"JamesBond","name":"\u30b8\u30a7\u30fc\u30e0\u30ba\u30fb\u30dc\u30f3\u30c9007","className":"JamesBond","superClassName":"Base","sortKey":"\u3057\u3048\u3048\u3080\u3059\u307b\u3093\u3068007","locale":"ja_jp"},{"id":"JekyllAndHyde","name":"\u30b8\u30ad\u30eb\u3068\u30cf\u30a4\u30c9\u3068\u30b0\u30ea\u30c8\u30b0\u30e9","className":"JekyllAndHyde","superClassName":"DesperateRun","sortKey":"\u3057\u304d\u308b\u3068\u306f\u3044\u3068\u3068\u304f\u308a\u3068\u304f\u3089","locale":"ja_jp"},{"id":"JuinKansen","name":"\u546a\u5370\u611f\u67d3","className":"JuinKansen","superClassName":"Base","sortKey":"\u3057\u3086\u3044\u3093\u304b\u3093\u305b\u3093","locale":"ja_jp"},{"id":"DoubleCross","name":"\u30c0\u30d6\u30eb\u30af\u30ed\u30b92nd,3rd","className":"DoubleCross","superClassName":"Base","sortKey":"\u305f\u3075\u308b\u304f\u308d\u30592","locale":"ja_jp"},{"id":"Kamigakari","name":"\u795e\u6211\u72e9","className":"Kamigakari","superClassName":"Base","sortKey":"\u304b\u307f\u304b\u304b\u308a","locale":"ja_jp"},{"id":"OracleEngine","name":"\u30aa\u30e9\u30af\u30eb\u30a8\u30f3\u30b8\u30f3","className":"OracleEngine","superClassName":"Base","sortKey":"\u304a\u3089\u304f\u308b\u3048\u3093\u3057\u3093","locale":"ja_jp"},{"id":"Kamigakari:Korean","name":"\uce74\ubbf8\uac00\uce74\ub9ac","className":"Kamigakari_Korean","superClassName":"Kamigakari","sortKey":"\u56fd\u969b\u5316:Korean:\uce74\ubbf8\uac00\uce74\ub9ac","locale":"ko_kr"},{"id":"KanColle","name":"\u8266\u3053\u308cRPG","className":"KanColle","superClassName":"Base","sortKey":"\u304b\u3093\u3053\u308cRPG","locale":"ja_jp"},{"id":"BeginningIdol","name":"\u30d3\u30ae\u30cb\u30f3\u30b0\u30a2\u30a4\u30c9\u30eb","className":"BeginningIdol","superClassName":"Base","sortKey":"\u3072\u304d\u306b\u3093\u304f\u3042\u3044\u3068\u308b","locale":"ja_jp"},{"id":"OrgaRain","name":"\u5728\u308a\u3066\u904d\u304f\u30aa\u30eb\u30ac\u30ec\u30a4\u30f3","className":"OrgaRain","superClassName":"Base","sortKey":"\u3042\u308a\u3066\u3042\u307e\u306d\u304f\u304a\u308b\u304b\u308c\u3044\u3093","locale":"ja_jp"},{"id":"Oukahoushin3rd","name":"\u592e\u83ef\u5c01\u795eRPG \u7b2c\u4e09\u7248","className":"Oukahoushin3rd","superClassName":"Base","sortKey":"\u304a\u3046\u304b\u307b\u3046\u3057\u3093RPG3","locale":"ja_jp"},{"id":"Torg1.5","name":"\u30c8\u30fc\u30b01.5\u7248","className":"Torg1_5","superClassName":"Torg","sortKey":"\u3068\u304a\u304f1.5","locale":"ja_jp"},{"id":"Karukami","name":"\u30ab\u30eb\u30ab\u30df","className":"Karukami","superClassName":"Base","sortKey":"\u304b\u308b\u304b\u307f","locale":"ja_jp"},{"id":"Paradiso","name":"\u30c1\u30a7\u30ec\u30b9\u30c6\u8272\u306e\u30d1\u30e9\u30c7\u30a3\u30fc\u30be","className":"Paradiso","superClassName":"Base","sortKey":"\u3061\u3048\u308c\u3059\u3066\u3044\u308d\u306e\u306f\u3089\u3066\u3044\u3044\u305d","locale":"ja_jp"},{"id":"KemonoNoMori","name":"\u7378\u30ce\u68ee","className":"KemonoNoMori","superClassName":"Base","sortKey":"\u3051\u3082\u306e\u306e\u3082\u308a","locale":"ja_jp"},{"id":"DoubleCross:Korean","name":"\ub354\ube14\ud06c\ub85c\uc2a42nd,3rd","className":"DoubleCross_Korean","superClassName":"DoubleCross","sortKey":"\u56fd\u969b\u5316:Korean:\ub354\ube14\ud06c\ub85c\uc2a4","locale":"ko_kr"},{"id":"Dracurouge","name":"\u30c9\u30e9\u30af\u30eb\u30fc\u30b8\u30e5","className":"Dracurouge","superClassName":"Base","sortKey":"\u3068\u3089\u304f\u308b\u3046\u3057\u3086","locale":"ja_jp"},{"id":"TorgEternity","name":"\u30c8\u30fc\u30b0 \u30a8\u30bf\u30cb\u30c6\u30a3","className":"TorgEternity","superClassName":"Base","sortKey":"\u3068\u304a\u304f\u3048\u305f\u306b\u3066\u3044","locale":"ja_jp"},{"id":"DiceBot","name":"DiceBot","className":"DiceBot","superClassName":"Base","sortKey":"*\u305f\u3044\u3059\u307b\u3064\u3068","locale":"ja_jp"},{"id":"KillDeathBusiness","name":"\u30ad\u30eb\u30c7\u30b9\u30d3\u30b8\u30cd\u30b9","className":"KillDeathBusiness","superClassName":"Base","sortKey":"\u304d\u308b\u3066\u3059\u3072\u3057\u306d\u3059","locale":"ja_jp"},{"id":"Paranoia","name":"\u30d1\u30e9\u30ce\u30a4\u30a2","className":"Paranoia","superClassName":"Base","sortKey":"\u306f\u3089\u306e\u3044\u3042","locale":"ja_jp"},{"id":"ParanoiaRebooted","name":"\u30d1\u30e9\u30ce\u30a4\u30a2 \u30ea\u30d6\u30fc\u30c6\u30c3\u30c9","className":"ParanoiaRebooted","superClassName":"Base","sortKey":"\u306f\u3089\u306e\u3044\u3042\u308a\u3075\u3046\u3066\u3064\u3068","locale":"ja_jp"},{"id":"ParasiteBlood","name":"\u30d1\u30e9\u30b5\u30a4\u30c8\u30d6\u30e9\u30c3\u30c9RPG","className":"ParasiteBlood","superClassName":"DemonParasite","sortKey":"\u306f\u3089\u3055\u3044\u3068\u3075\u3089\u3064\u3068RPG","locale":"ja_jp"},{"id":"Pathfinder","name":"Pathfinder","className":"Pathfinder","superClassName":"DungeonsAndDragons","sortKey":"\u306f\u3059\u3075\u3042\u3044\u3093\u305f\u3042","locale":"ja_jp"},{"id":"Peekaboo","name":"\u30d4\u30fc\u30ab\u30fc\u30d6\u30fc","className":"Peekaboo","superClassName":"Base","sortKey":"\u3072\u3044\u304b\u3042\u3075\u3046","locale":"ja_jp"},{"id":"Pendragon","name":"\u30da\u30f3\u30c9\u30e9\u30b4\u30f3","className":"Pendragon","superClassName":"Base","sortKey":"\u3078\u3093\u3068\u3089\u3053\u3093","locale":"ja_jp"},{"id":"PersonaO","name":"\u30da\u30eb\u30bd\u30caTRPG-O","className":"PersonaO","superClassName":"Base","sortKey":"\u3078\u308b\u305d\u306aTRPGO","locale":"ja_jp"},{"id":"PhantasmAdventure","name":"\u30d5\u30a1\u30f3\u30bf\u30ba\u30e0\u30fb\u30a2\u30c9\u30d9\u30f3\u30c1\u30e3\u30fc","className":"PhantasmAdventure","superClassName":"Base","sortKey":"\u3075\u3042\u3093\u305f\u3059\u3080\u3042\u3068\u3078\u3093\u3061\u3084\u3042","locale":"ja_jp"},{"id":"Dracurouge:Korean","name":"\ub4dc\ub77c\ud06c\ub8e8\uc8fc","className":"Dracurouge_Korean","superClassName":"Dracurouge","sortKey":"\u56fd\u969b\u5316:Korean:\ub4dc\ub77c\ud06c\ub8e8\uc8fc","locale":"ko_kr"},{"id":"DungeonsAndDragons","name":"\u30c0\u30f3\u30b8\u30e7\u30f3\u30ba\uff06\u30c9\u30e9\u30b4\u30f3\u30ba","className":"DungeonsAndDragons","superClassName":"Base","sortKey":"\u305f\u3093\u3057\u3088\u3093\u3059\u3042\u3093\u3068\u3068\u3089\u3053\u3093\u3059","locale":"ja_jp"},{"id":"EarthDawn","name":"\u30a2\u30fc\u30b9\u30c9\u30fc\u30f3","className":"EarthDawn","superClassName":"Base","sortKey":"\u3042\u3042\u3059\u3068\u304a\u3093","locale":"ja_jp"},{"id":"KurayamiCrying","name":"\u30af\u30e9\u30e4\u30df\u30af\u30e9\u30a4\u30f3","className":"KurayamiCrying","superClassName":"Base","sortKey":"\u304f\u3089\u3084\u307f\u304f\u3089\u3044\u3093","locale":"ja_jp"},{"id":"KillDeathBusiness:Korean","name":"Kill Death Business (\ud55c\uad6d\uc5b4)","className":"KillDeathBusiness_Korean","superClassName":"KillDeathBusiness","sortKey":"\u56fd\u969b\u5316:Korean:Kill Death Business","locale":"ko_kr"},{"id":"Kutulu","name":"Kutulu","className":"Kutulu","superClassName":"Base","sortKey":"\u304f\u3068\u3046\u308b\u3046","locale":"ja_jp"},{"id":"TrinitySeven","name":"\u30c8\u30ea\u30cb\u30c6\u30a3\u30bb\u30d6\u30f3RPG","className":"TrinitySeven","superClassName":"Base","sortKey":"\u3068\u308a\u306b\u3066\u3044\u305b\u3075\u3093RPG","locale":"ja_jp"},{"id":"Postman","name":"\u58ca\u308c\u305f\u4e16\u754c\u306e\u30dd\u30b9\u30c8\u30de\u30f3","className":"Postman","superClassName":"Base","sortKey":"\u3053\u308f\u308c\u305f\u305b\u304b\u3044\u306e\u307b\u3059\u3068\u307e\u3093","locale":"ja_jp"},{"id":"LiveraDoll","name":"\u7d2b\u7e1e\u306e\u30ea\u30f4\u30e9\u30c9\u30fc\u30eb","className":"LiveraDoll","superClassName":"Base","sortKey":"\u3057\u3057\u307e\u306e\u308a\u3046\u3089\u3068\u304a\u308b","locale":"ja_jp"},{"id":"PulpCthulhu","name":"\u30d1\u30eb\u30d7\u30fb\u30af\u30c8\u30a5\u30eb\u30d5","className":"PulpCthulhu","superClassName":"Cthulhu7th","sortKey":"\u306f\u308b\u3075\u304f\u3068\u3046\u308b\u3075","locale":"ja_jp"},{"id":"Raisondetre","name":"\u53db\u9006\u30ec\u30be\u30f3\u30c7\u30fc\u30c8\u30eb","className":"Raisondetre","superClassName":"Base","sortKey":"\u306f\u3093\u304d\u3084\u304f\u308c\u305d\u3093\u3066\u3068\u304a\u308b","locale":"ja_jp"},{"id":"LogHorizon","name":"\u30ed\u30b0\u30fb\u30db\u30e9\u30a4\u30ba\u30f3TRPG","className":"LogHorizon","superClassName":"Base","sortKey":"\u308d\u304f\u307b\u3089\u3044\u3059\u3093TRPG","locale":"ja_jp"},{"id":"TunnelsAndTrolls","name":"\u30c8\u30f3\u30cd\u30eb\u30ba\uff06\u30c8\u30ed\u30fc\u30eb\u30ba","className":"TunnelsAndTrolls","superClassName":"Base","sortKey":"\u3068\u3093\u306d\u308b\u3059\u3042\u3093\u3068\u3068\u308d\u304a\u308b\u3059","locale":"ja_jp"},{"id":"ToshiakiHolyGrailWar","name":"\u3068\u3057\u3042\u304d\u306e\u8056\u676f\u6226\u4e89TRPG","className":"ToshiakiHolyGrailWar","superClassName":"Base","sortKey":"\u3068\u3057\u3042\u304d\u306e\u305b\u3044\u306f\u3044\u305b\u3093\u305d\u3046TRPG","locale":"ja_jp"},{"id":"RecordOfLodossWar","name":"\u30ed\u30fc\u30c9\u30b9\u5cf6\u6226\u8a18RPG","className":"RecordOfLodossWar","superClassName":"Base","sortKey":"\u308d\u304a\u3068\u3059\u3068\u3046\u305b\u3093\u304dRPG","locale":"ja_jp"},{"id":"RecordOfSteam","name":"Record of Steam","className":"RecordOfSteam","superClassName":"Base","sortKey":"\u308c\u3053\u304a\u3068\u304a\u3075\u3059\u3061\u3044\u3080","locale":"ja_jp"},{"id":"EarthDawn3","name":"\u30a2\u30fc\u30b9\u30c9\u30fc\u30f33\u7248","className":"EarthDawn3","superClassName":"EarthDawn","sortKey":"\u3042\u3042\u3059\u3068\u304a\u30933","locale":"ja_jp"},{"id":"TwilightGunsmoke","name":"\u30c8\u30ef\u30a4\u30e9\u30a4\u30c8\u30ac\u30f3\u30b9\u30e2\u30fc\u30af","className":"TwilightGunsmoke","superClassName":"Base","sortKey":"\u3068\u308f\u3044\u3089\u3044\u3068\u304b\u3093\u3059\u3082\u304a\u304f","locale":"ja_jp"},{"id":"UnsungDuet","name":"\u30a2\u30f3\u30b5\u30f3\u30b0\u30fb\u30c7\u30e5\u30a8\u30c3\u30c8","className":"UnsungDuet","superClassName":"Base","sortKey":"\u3042\u3093\u3055\u3093\u304f\u3066\u3086\u3048\u3064\u3068","locale":"ja_jp"},{"id":"Revulture","name":"\u5149\u7815\u306e\u30ea\u30f4\u30a1\u30eb\u30c1\u30e3\u30fc","className":"Revulture","superClassName":"Base","sortKey":"\u3053\u3046\u3055\u3044\u306e\u308a\u3046\u3042\u308b\u3061\u3084\u3042","locale":"ja_jp"},{"id":"Utakaze","name":"\u30a6\u30bf\u30ab\u30bc","className":"Utakaze","superClassName":"Base","sortKey":"\u3046\u305f\u304b\u305b","locale":"ja_jp"},{"id":"LogHorizon:Korean","name":"\ub85c\uadf8 \ud638\ub77c\uc774\uc98c","className":"LogHorizon_Korean","superClassName":"LogHorizon","sortKey":"\u56fd\u969b\u5316:Korean:\ub85c\uadf8 \ud638\ub77c\uc774\uc98c","locale":"ko_kr"},{"id":"LostRecord","name":"\u30ed\u30b9\u30c8\u30ec\u30b3\u30fc\u30c9","className":"LostRecord","superClassName":"Base","sortKey":"\u308d\u3059\u3068\u308c\u3053\u304a\u3068","locale":"ja_jp"},{"id":"LostRoyal","name":"\u30ed\u30b9\u30c8\u30ed\u30a4\u30e4\u30eb","className":"LostRoyal","superClassName":"Base","sortKey":"\u308d\u3059\u3068\u308d\u3044\u3084\u308b","locale":"ja_jp"},{"id":"BeginningIdol:Korean","name":"\ube44\uae30\ub2dd \uc544\uc774\ub3cc","className":"BeginningIdol_Korean","superClassName":"BeginningIdol","sortKey":"\u56fd\u969b\u5316:Korean:\ube44\uae30\ub2dd \uc544\uc774\ub3cc","locale":"ko_kr"},{"id":"BeginningIdol2022","name":"\u30d3\u30ae\u30cb\u30f3\u30b0\u30a2\u30a4\u30c9\u30eb\uff082022\u5e74\u6539\u8a02\u7248\uff09","className":"BeginningIdol2022","superClassName":"Base","sortKey":"\u3072\u304d\u306b\u3093\u304f\u3042\u3044\u3068\u308b2022","locale":"ja_jp"},{"id":"RokumonSekai2","name":"\u516d\u9580\u4e16\u754cRPG \u30bb\u30ab\u30f3\u30c9\u30a8\u30c7\u30a3\u30b7\u30e7\u30f3","className":"RokumonSekai2","superClassName":"Base","sortKey":"\u308d\u304f\u3082\u3093\u305b\u304b\u3044RPG2","locale":"ja_jp"},{"id":"VampireTheMasquerade5th","name":"Vampire: The Masquerade 5th Edition","className":"VampireTheMasquerade5th","superClassName":"Base","sortKey":"\u3046\u3042\u3093\u306f\u3044\u3042\u3055\u307e\u3059\u304b\u308c\u3048\u30685","locale":"ja_jp"},{"id":"EarthDawn4","name":"\u30a2\u30fc\u30b9\u30c9\u30fc\u30f34\u7248","className":"EarthDawn4","superClassName":"EarthDawn","sortKey":"\u3042\u3042\u3059\u3068\u304a\u30934","locale":"ja_jp"},{"id":"RoleMaster","name":"\u30ed\u30fc\u30eb\u30de\u30b9\u30bf\u30fc","className":"RoleMaster","superClassName":"Base","sortKey":"\u308d\u304a\u308b\u307e\u3059\u305f\u3042","locale":"ja_jp"},{"id":"RuinBreakers","name":"\u30eb\u30fc\u30a4\u30f3\u30d6\u30ec\u30a4\u30ab\u30fc\u30ba","className":"RuinBreakers","superClassName":"Base","sortKey":"\u308b\u3046\u3044\u3093\u3075\u308c\u3044\u304b\u3042\u3059","locale":"ja_jp"},{"id":"RuneQuest","name":"\u30eb\u30fc\u30f3\u30af\u30a8\u30b9\u30c8","className":"RuneQuest","superClassName":"Base","sortKey":"\u308b\u3046\u3093\u304f\u3048\u3059\u3068","locale":"ja_jp"},{"id":"BladeOfArcana","name":"\u30d6\u30ec\u30a4\u30c9\u30fb\u30aa\u30d6\u30fb\u30a2\u30eb\u30ab\u30ca","className":"BladeOfArcana","superClassName":"Base","sortKey":"\u3075\u308c\u3044\u3068\u304a\u3075\u3042\u308b\u304b\u306a","locale":"ja_jp"},{"id":"RyuTuber","name":"\u30ea\u30e5\u30fc\u30c1\u30e5\u30fc\u30d0\u30fc\u3068\u3061\u3044\u3055\u306a\u5947\u8de1","className":"RyuTuber","superClassName":"Base","sortKey":"\u308a\u3086\u3046\u3061\u3086\u3046\u306f\u3042\u3068\u3061\u3044\u3055\u306a\u304d\u305b\u304d","locale":"ja_jp"},{"id":"MagicaLogia","name":"\u30de\u30ae\u30ab\u30ed\u30ae\u30a2","className":"MagicaLogia","superClassName":"Base","sortKey":"\u307e\u304d\u304b\u308d\u304d\u3042","locale":"ja_jp"},{"id":"EclipsePhase","name":"\u30a8\u30af\u30ea\u30d7\u30b9\u30fb\u30d5\u30a7\u30a4\u30ba","className":"EclipsePhase","superClassName":"Base","sortKey":"\u3048\u304f\u308a\u3075\u3059\u3075\u3048\u3044\u3059","locale":"ja_jp"},{"id":"Ryutama","name":"\u308a\u3085\u3046\u305f\u307e","className":"Ryutama","superClassName":"Base","sortKey":"\u308a\u3086\u3046\u305f\u307e","locale":"ja_jp"},{"id":"BlindMythos","name":"\u30d6\u30e9\u30a4\u30f3\u30c9\u30fb\u30df\u30c8\u30b9RPG","className":"BlindMythos","superClassName":"Base","sortKey":"\u3075\u3089\u3044\u3093\u3068\u307f\u3068\u3059RPG","locale":"ja_jp"},{"id":"Elric","name":"\u30a8\u30eb\u30ea\u30c3\u30af\uff01","className":"Elric","superClassName":"Base","sortKey":"\u3048\u308b\u308a\u3064\u304f","locale":"ja_jp"},{"id":"Elysion","name":"\u30a8\u30ea\u30e5\u30b7\u30aa\u30f3","className":"Elysion","superClassName":"Base","sortKey":"\u3048\u308a\u3086\u3057\u304a\u3093","locale":"ja_jp"}]}')},6884:E=>{"use strict";E.exports=JSON.parse('{"ja_jp":{"success":"\u6210\u529f","failure":"\u5931\u6557","critical":"\u30af\u30ea\u30c6\u30a3\u30ab\u30eb","fumble":"\u30d5\u30a1\u30f3\u30d6\u30eb"},"ko_kr":{"success":"\uc131\uacf5","failure":"\uc2e4\ud328","fumble":"\ud38c\ube14","RTT":{"rtt_format":"\ub79c\ub364 \ud2b9\uae30 \uacb0\uc815\ud45c(%<category_dice>d,%<row_dice>d) \uff1e %<text>s","rttn_format":"\uc9c0\uc815\ud2b9\uae30(%<category_name>s)\ud45c(%<row_dice>d) \uff1e %<text>s"}},"zh_hans":{"success":"\u6210\u529f","failure":"\u5931\u8d25","fumble":"\u5927\u5931\u8d25","RTT":{"rtt_format":"\u968f\u673a\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s","rttn_format":"%<category_name>s\u9886\u57df\u968f\u673a\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"}},"zh_hant":{"success":"\u6210\u529f","failure":"\u5931\u6557"}}')},3034:E=>{"use strict";E.exports=JSON.parse('{"i18nList":[{"baseClassName":"Amadeus","locales":["ja_jp","ko_kr"]},{"baseClassName":"BeginningIdol","locales":["ja_jp","ko_kr"]},{"baseClassName":"Cthulhu","locales":["ja_jp","ko_kr","zh_hans","zh_hant"]},{"baseClassName":"DetatokoSaga","locales":["ja_jp","ko_kr"]},{"baseClassName":"DoubleCross","locales":["ja_jp","ko_kr"]},{"baseClassName":"Dracurouge","locales":["ja_jp","ko_kr"]},{"baseClassName":"Fiasco","locales":["ja_jp","ko_kr"]},{"baseClassName":"FutariSousa","locales":["ja_jp","ko_kr"]},{"baseClassName":"Insane","locales":["ja_jp","ko_kr"]},{"baseClassName":"Kamigakari","locales":["ja_jp","ko_kr"]},{"baseClassName":"KillDeathBusiness","locales":["ja_jp","ko_kr"]},{"baseClassName":"LogHorizon","locales":["ja_jp","ko_kr"]},{"baseClassName":"MagicaLogia","locales":["ja_jp","ko_kr","zh_hans"]},{"baseClassName":"MonotoneMuseum","locales":["ja_jp","ko_kr"]},{"baseClassName":"Nechronica","locales":["ja_jp","ko_kr"]},{"baseClassName":"StellarKnights","locales":["ja_jp","ko_kr"]},{"baseClassName":"StratoShout","locales":["ja_jp","ko_kr"]},{"baseClassName":"SwordWorld","locales":["ja_jp"]},{"baseClassName":"SwordWorld2_0","locales":["ja_jp"]},{"baseClassName":"SwordWorld2_5","locales":["ja_jp"]}]}')},1014:E=>{"use strict";E.exports={}}},E=>{E(E.s=9567)}]);