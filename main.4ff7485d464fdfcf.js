(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[8792],{1773:(Kt,X,me)=>{"use strict";var L=me(467);let B=null,S=1;const P=Symbol("SIGNAL");function O(t){const n=B;return B=t,n}function N(t){if((!Qe(t)||t.dirty)&&(t.dirty||t.lastCleanEpoch!==S)){if(!t.producerMustRecompute(t)&&!te(t))return t.dirty=!1,void(t.lastCleanEpoch=S);t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=S}}function te(t){pe(t);for(let n=0;n<t.producerNode.length;n++){const e=t.producerNode[n],i=t.producerLastReadVersion[n];if(i!==e.version||(N(e),i!==e.version))return!0}return!1}function ue(t,n){if(function Se(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}(t),pe(t),1===t.liveConsumerNode.length)for(let i=0;i<t.producerNode.length;i++)ue(t.producerNode[i],t.producerIndexOfThis[i]);const e=t.liveConsumerNode.length-1;if(t.liveConsumerNode[n]=t.liveConsumerNode[e],t.liveConsumerIndexOfThis[n]=t.liveConsumerIndexOfThis[e],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,n<t.liveConsumerNode.length){const i=t.liveConsumerIndexOfThis[n],r=t.liveConsumerNode[n];pe(r),r.producerIndexOfThis[i]=n}}function Qe(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function pe(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}let Tt=null;function Ae(t){return"function"==typeof t}function Re(t){const e=t(i=>{Error.call(i),i.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const fe=Re(t=>function(e){t(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function se(t,n){if(t){const e=t.indexOf(n);0<=e&&t.splice(e,1)}}class Ie{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const o of e)o.remove(this);else e.remove(this);const{initialTeardown:i}=this;if(Ae(i))try{i()}catch(o){n=o instanceof fe?o.errors:[o]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const o of r)try{qe(o)}catch(s){n=n??[],s instanceof fe?n=[...n,...s.errors]:n.push(s)}}if(n)throw new fe(n)}}add(n){var e;if(n&&n!==this)if(this.closed)qe(n);else{if(n instanceof Ie){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(n)}}_hasParent(n){const{_parentage:e}=this;return e===n||Array.isArray(e)&&e.includes(n)}_addParent(n){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(n),e):e?[e,n]:n}_removeParent(n){const{_parentage:e}=this;e===n?this._parentage=null:Array.isArray(e)&&se(e,n)}remove(n){const{_finalizers:e}=this;e&&se(e,n),n instanceof Ie&&n._removeParent(this)}}Ie.EMPTY=(()=>{const t=new Ie;return t.closed=!0,t})();const dt=Ie.EMPTY;function vt(t){return t instanceof Ie||t&&"closed"in t&&Ae(t.remove)&&Ae(t.add)&&Ae(t.unsubscribe)}function qe(t){Ae(t)?t():t.unsubscribe()}const Mt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Ht={setTimeout(t,n,...e){const{delegate:i}=Ht;return i?.setTimeout?i.setTimeout(t,n,...e):setTimeout(t,n,...e)},clearTimeout(t){const{delegate:n}=Ht;return(n?.clearTimeout||clearTimeout)(t)},delegate:void 0};function Dt(t){Ht.setTimeout(()=>{const{onUnhandledError:n}=Mt;if(!n)throw t;n(t)})}function hn(){}const Ii=yo("C",void 0,void 0);function yo(t,n,e){return{kind:t,value:n,error:e}}let ji=null;function Co(t){if(Mt.useDeprecatedSynchronousErrorHandling){const n=!ji;if(n&&(ji={errorThrown:!1,error:null}),t(),n){const{errorThrown:e,error:i}=ji;if(ji=null,e)throw i}}else t()}class jo extends Ie{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,vt(n)&&n.add(this)):this.destination=xs}static create(n,e,i){return new Da(n,e,i)}next(n){this.isStopped?Oa(function io(t){return yo("N",t,void 0)}(n),this):this._next(n)}error(n){this.isStopped?Oa(function jn(t){return yo("E",void 0,t)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?Oa(Ii,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const rs=Function.prototype.bind;function Nr(t,n){return rs.call(t,n)}class ca{constructor(n){this.partialObserver=n}next(n){const{partialObserver:e}=this;if(e.next)try{e.next(n)}catch(i){ua(i)}}error(n){const{partialObserver:e}=this;if(e.error)try{e.error(n)}catch(i){ua(i)}else ua(n)}complete(){const{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(e){ua(e)}}}class Da extends jo{constructor(n,e,i){let r;if(super(),Ae(n)||!n)r={next:n??void 0,error:e??void 0,complete:i??void 0};else{let o;this&&Mt.useDeprecatedNextContext?(o=Object.create(n),o.unsubscribe=()=>this.unsubscribe(),r={next:n.next&&Nr(n.next,o),error:n.error&&Nr(n.error,o),complete:n.complete&&Nr(n.complete,o)}):r=n}this.destination=new ca(r)}}function ua(t){Mt.useDeprecatedSynchronousErrorHandling?function Pi(t){Mt.useDeprecatedSynchronousErrorHandling&&ji&&(ji.errorThrown=!0,ji.error=t)}(t):Dt(t)}function Oa(t,n){const{onStoppedNotification:e}=Mt;e&&Ht.setTimeout(()=>e(t,n))}const xs={closed:!0,next:hn,error:function ka(t){throw t},complete:hn},ro="function"==typeof Symbol&&Symbol.observable||"@@observable";function oc(t){return t}let qi=(()=>{class t{constructor(e){e&&(this._subscribe=e)}lift(e){const i=new t;return i.source=this,i.operator=e,i}subscribe(e,i,r){const o=function $u(t){return t&&t instanceof jo||function uh(t){return t&&Ae(t.next)&&Ae(t.error)&&Ae(t.complete)}(t)&&vt(t)}(e)?e:new Da(e,i,r);return Co(()=>{const{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(e){try{return this._subscribe(e)}catch(i){e.error(i)}}forEach(e,i){return new(i=Wu(i))((r,o)=>{const s=new Da({next:a=>{try{e(a)}catch(c){o(c),s.unsubscribe()}},error:o,complete:r});this.subscribe(s)})}_subscribe(e){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(e)}[ro](){return this}pipe(...e){return function sc(t){return 0===t.length?oc:1===t.length?t[0]:function(e){return t.reduce((i,r)=>r(i),e)}}(e)(this)}toPromise(e){return new(e=Wu(e))((i,r)=>{let o;this.subscribe(s=>o=s,s=>r(s),()=>i(o))})}}return t.create=n=>new t(n),t})();function Wu(t){var n;return null!==(n=t??Mt.Promise)&&void 0!==n?n:Promise}const Yu=Re(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let zs=(()=>{class t extends qi{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const i=new Zu(this,this);return i.operator=e,i}_throwIfClosed(){if(this.closed)throw new Yu}next(e){Co(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(e)}})}error(e){Co(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:i}=this;for(;i.length;)i.shift().error(e)}})}complete(){Co(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:i,isStopped:r,observers:o}=this;return i||r?dt:(this.currentObservers=null,o.push(e),new Ie(()=>{this.currentObservers=null,se(o,e)}))}_checkFinalizedStatuses(e){const{hasError:i,thrownError:r,isStopped:o}=this;i?e.error(r):o&&e.complete()}asObservable(){const e=new qi;return e.source=this,e}}return t.create=(n,e)=>new Zu(n,e),t})();class Zu extends zs{constructor(n,e){super(),this.destination=n,this.source=e}next(n){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===i||i.call(e,n)}error(n){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===i||i.call(e,n)}complete(){var n,e;null===(e=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===e||e.call(n)}_subscribe(n){var e,i;return null!==(i=null===(e=this.source)||void 0===e?void 0:e.subscribe(n))&&void 0!==i?i:dt}}class ac extends zs{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){const e=super._subscribe(n);return!e.closed&&n.next(this._value),e}getValue(){const{hasError:n,thrownError:e,_value:i}=this;if(n)throw e;return this._throwIfClosed(),i}next(n){super.next(this._value=n)}}function Ol(t){return Ae(t?.lift)}function xo(t){return n=>{if(Ol(n))return n.lift(function(e){try{return t(e,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function oo(t,n,e,i,r){return new qu(t,n,e,i,r)}class qu extends jo{constructor(n,e,i,r,o,s){super(n),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=e?function(a){try{e(a)}catch(c){n.error(c)}}:super._next,this._error=r?function(a){try{r(a)}catch(c){n.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){n.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}}function Oo(t,n){return xo((e,i)=>{let r=0;e.subscribe(oo(i,o=>{i.next(t.call(n,o,r++))}))})}const qc="https://g.co/ng/security#xss";class mt extends Error{constructor(n,e){super(function Aa(t,n){return`NG0${Math.abs(t)}${n?": "+n:""}`}(n,e)),this.code=n}}function Ao(t){return{toString:t}.toString()}const Hs="__parameters__";function Is(t,n,e){return Ao(()=>{const i=function Es(t){return function(...e){if(t){const i=t(...e);for(const r in i)this[r]=i[r]}}}(n);function r(...o){if(this instanceof r)return i.apply(this,o),this;const s=new r(...o);return a.annotation=s,a;function a(c,u,f){const b=c.hasOwnProperty(Hs)?c[Hs]:Object.defineProperty(c,Hs,{value:[]})[Hs];for(;b.length<=f;)b.push(null);return(b[f]=b[f]||[]).push(s),c}}return e&&(r.prototype=Object.create(e.prototype)),r.prototype.ngMetadataName=t,r.annotationCls=r,r})}const li=globalThis;function hi(t){for(let n in t)if(t[n]===hi)return n;throw Error("Could not find renamed property on target object.")}function Ts(t,n){for(const e in n)n.hasOwnProperty(e)&&!t.hasOwnProperty(e)&&(t[e]=n[e])}function Ti(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(Ti).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const n=t.toString();if(null==n)return""+n;const e=n.indexOf("\n");return-1===e?n:n.substring(0,e)}function cc(t,n){return null==t||""===t?null===n?"":n:null==n||""===n?t:t+" "+n}const re=hi({__forward_ref__:hi});function be(t){return t.__forward_ref__=be,t.toString=function(){return Ti(this())},t}function ie(t){return Pe(t)?t():t}function Pe(t){return"function"==typeof t&&t.hasOwnProperty(re)&&t.__forward_ref__===be}function nn(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function ha(t){return{providers:t.providers||[],imports:t.imports||[]}}function fh(t){return Db(t,Ku)||Db(t,kb)}function Db(t,n){return t.hasOwnProperty(n)?t[n]:null}function Gf(t){return t&&(t.hasOwnProperty(hm)||t.hasOwnProperty(KC))?t[hm]:null}const Ku=hi({\u0275prov:hi}),hm=hi({\u0275inj:hi}),kb=hi({ngInjectableDef:hi}),KC=hi({ngInjectorDef:hi});class mn{constructor(n,e){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=nn({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function mm(t){return t&&!!t.\u0275providers}const jr=hi({\u0275cmp:hi}),Wf=hi({\u0275dir:hi}),Kc=hi({\u0275pipe:hi}),_m=hi({\u0275mod:hi}),Pa=hi({\u0275fac:hi}),Go=hi({__NG_ELEMENT_ID__:hi}),bm=hi({__NG_ENV_ID__:hi});function Hn(t){return"string"==typeof t?t:null==t?"":String(t)}function Ms(t,n){throw new mt(-201,!1)}var bi=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(bi||{});let $f;function Pl(){return $f}function Po(t){const n=$f;return $f=t,n}function Yf(t,n,e){const i=fh(t);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:e&bi.Optional?null:void 0!==n?n:void Ms()}const Jc={},vm="__NG_DI_FLAG__",Qu="ngTempTokenPath",ix=/\n/gm,ym="__source";let Fl;function uc(t){const n=Fl;return Fl=t,n}function Pb(t,n=bi.Default){if(void 0===Fl)throw new mt(-203,!1);return null===Fl?Yf(t,void 0,n):Fl.get(t,n&bi.Optional?null:void 0,n)}function Nn(t,n=bi.Default){return(Pl()||Pb)(ie(t),n)}function kn(t,n=bi.Default){return Nn(t,ph(n))}function ph(t){return typeof t>"u"||"number"==typeof t?t:(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function Cm(t){const n=[];for(let e=0;e<t.length;e++){const i=ie(t[e]);if(Array.isArray(i)){if(0===i.length)throw new mt(900,!1);let r,o=bi.Default;for(let s=0;s<i.length;s++){const a=i[s],c=xm(a);"number"==typeof c?-1===c?r=a.token:o|=c:r=a}n.push(Nn(r,o))}else n.push(Nn(i))}return n}function eu(t,n){return t[vm]=n,t.prototype[vm]=n,t}function xm(t){return t[vm]}const gh=eu(Is("Optional"),8),qf=eu(Is("SkipSelf"),4);function tu(t,n){return t.hasOwnProperty(Pa)?t[Pa]:null}function ed(t,n){t.forEach(e=>Array.isArray(e)?ed(e,n):n(e))}function Rb(t,n,e){n>=t.length?t.push(e):t.splice(n,0,e)}function Nl(t,n){return n>=t.length-1?t.pop():t.splice(n,1)[0]}function Wo(t,n,e){let i=td(t,n);return i>=0?t[1|i]=e:(i=~i,function Em(t,n,e,i){let r=t.length;if(r==n)t.push(e,i);else if(1===r)t.push(i,t[0]),t[0]=e;else{for(r--,t.push(t[r-1],t[r]);r>n;)t[r]=t[r-2],r--;t[n]=e,t[n+1]=i}}(t,i,n,e)),i}function Im(t,n){const e=td(t,n);if(e>=0)return t[1|e]}function td(t,n){return function iu(t,n,e){let i=0,r=t.length>>e;for(;r!==i;){const o=i+(r-i>>1),s=t[o<<e];if(n===s)return o<<e;s>n?r=o:i=o+1}return~(r<<e)}(t,n,1)}const Kr={},wi=[],nd=new mn(""),Bb=new mn("",-1),Tm=new mn("");class Kf{get(n,e=Jc){if(e===Jc){const i=new Error(`NullInjectorError: No provider for ${Ti(n)}!`);throw i.name="NullInjectorError",i}return e}}var Qf=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(Qf||{}),ks=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(ks||{}),Ce=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(Ce||{});function Ct(t,n,e){let i=t.length;for(;;){const r=t.indexOf(n,e);if(-1===r)return r;if(0===r||t.charCodeAt(r-1)<=32){const o=n.length;if(r+o===i||t.charCodeAt(r+o)<=32)return r}e=r+1}}function ut(t,n,e){let i=0;for(;i<e.length;){const r=e[i];if("number"==typeof r){if(0!==r)break;i++;const o=e[i++],s=e[i++],a=e[i++];t.setAttribute(n,s,a,o)}else{const o=r,s=e[++i];Gn(o)?t.setProperty(n,o,s):t.setAttribute(n,o,s),i++}}return i}function cn(t){return 3===t||4===t||6===t}function Gn(t){return 64===t.charCodeAt(0)}function vi(t,n){if(null!==n&&0!==n.length)if(null===t||0===t.length)t=n.slice();else{let e=-1;for(let i=0;i<n.length;i++){const r=n[i];"number"==typeof r?e=r:0===e||Qr(t,e,r,null,-1===e||2===e?n[++i]:null)}}return t}function Qr(t,n,e,i,r){let o=0,s=t.length;if(-1===n)s=-1;else for(;o<t.length;){const a=t[o++];if("number"==typeof a){if(a===n){s=-1;break}if(a>n){s=o-1;break}}}for(;o<t.length;){const a=t[o];if("number"==typeof a)break;if(a===e){if(null===i)return void(null!==r&&(t[o+1]=r));if(i===t[o+1])return void(t[o+2]=r)}o++,null!==i&&o++,null!==r&&o++}-1!==s&&(t.splice(s,0,n),o=s+1),t.splice(o++,0,e),null!==i&&t.splice(o++,0,i),null!==r&&t.splice(o++,0,r)}const Xi="ng-template";function Sm(t,n,e,i){let r=0;if(i){for(;r<n.length&&"string"==typeof n[r];r+=2)if("class"===n[r]&&-1!==Ct(n[r+1].toLowerCase(),e,0))return!0}else if(Mm(t))return!1;if(r=n.indexOf(1,r),r>-1){let o;for(;++r<n.length&&"string"==typeof(o=n[r]);)if(o.toLowerCase()===e)return!0}return!1}function Mm(t){return 4===t.type&&t.value!==Xi}function pa(t,n,e){return n===(4!==t.type||e?t.value:Xi)}function Jf(t,n,e){let i=4;const r=t.attrs,o=null!==r?function Gi(t){for(let n=0;n<t.length;n++)if(cn(t[n]))return n;return t.length}(r):0;let s=!1;for(let a=0;a<n.length;a++){const c=n[a];if("number"!=typeof c){if(!s)if(4&i){if(i=2|1&i,""!==c&&!pa(t,c,e)||""===c&&1===n.length){if(Fa(i))return!1;s=!0}}else if(8&i){if(null===r||!Sm(t,r,c,e)){if(Fa(i))return!1;s=!0}}else{const u=n[++a],f=id(c,r,Mm(t),e);if(-1===f){if(Fa(i))return!1;s=!0;continue}if(""!==u){let b;if(b=f>o?"":r[f+1].toLowerCase(),2&i&&u!==b){if(Fa(i))return!1;s=!0}}}}else{if(!s&&!Fa(i)&&!Fa(c))return!1;if(s&&Fa(c))continue;s=!1,i=c|1&i}}return Fa(i)||s}function Fa(t){return!(1&t)}function id(t,n,e,i){if(null===n)return-1;let r=0;if(i||!e){let o=!1;for(;r<n.length;){const s=n[r];if(s===t)return r;if(3===s||6===s)o=!0;else{if(1===s||2===s){let a=n[++r];for(;"string"==typeof a;)a=n[++r];continue}if(4===s)break;if(0===s){r+=4;continue}}r+=o?1:2}return-1}return function ax(t,n){let e=t.indexOf(4);if(e>-1)for(e++;e<t.length;){const i=t[e];if("number"==typeof i)return-1;if(i===n)return e;e++}return-1}(n,t)}function _h(t,n,e=!1){for(let i=0;i<n.length;i++)if(Jf(t,n[i],e))return!0;return!1}function Ub(t,n){e:for(let e=0;e<n.length;e++){const i=n[e];if(t.length===i.length){for(let r=0;r<t.length;r++)if(t[r]!==i[r])continue e;return!0}}return!1}function bh(t,n){return t?":not("+n.trim()+")":n}function lx(t){let n=t[0],e=1,i=2,r="",o=!1;for(;e<t.length;){let s=t[e];if("string"==typeof s)if(2&i){const a=t[++e];r+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+s:4&i&&(r+=" "+s);else""!==r&&!Fa(s)&&(n+=bh(o,r),r=""),i=s,o=o||!Fa(i);e++}return""!==r&&(n+=bh(o,r)),n}function In(t){return Ao(()=>{const n=zb(t),e={...n,decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===Qf.OnPush,directiveDefs:null,pipeDefs:null,dependencies:n.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||ks.Emulated,styles:t.styles||wi,_:null,schemas:t.schemas||null,tView:null,id:""};Hb(e);const i=t.dependencies;return e.directiveDefs=np(i,!1),e.pipeDefs=np(i,!0),e.id=function rp(t){let n=0;const e=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(const r of e)n=Math.imul(31,n)+r.charCodeAt(0)|0;return n+=2147483648,"c"+n}(e),e})}function dc(t){return Qn(t)||Jr(t)}function tp(t){return null!==t}function ga(t){return Ao(()=>({type:t.type,bootstrap:t.bootstrap||wi,declarations:t.declarations||wi,imports:t.imports||wi,exports:t.exports||wi,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function vh(t,n){if(null==t)return Kr;const e={};for(const i in t)if(t.hasOwnProperty(i)){const r=t[i];let o,s,a=Ce.None;Array.isArray(r)?(a=r[0],o=r[1],s=r[2]??o):(o=r,s=r),n?(e[o]=a!==Ce.None?[i,a]:i,n[o]=s):e[o]=i}return e}function Sn(t){return Ao(()=>{const n=zb(t);return Hb(n),n})}function $o(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,standalone:!0===t.standalone,onDestroy:t.type.prototype.ngOnDestroy||null}}function Qn(t){return t[jr]||null}function Jr(t){return t[Wf]||null}function Gr(t){return t[Kc]||null}function zb(t){const n={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:n,inputTransforms:null,inputConfig:t.inputs||Kr,exportAs:t.exportAs||null,standalone:!0===t.standalone,signals:!0===t.signals,selectors:t.selectors||wi,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:vh(t.inputs,n),outputs:vh(t.outputs),debugInfo:null}}function Hb(t){t.features?.forEach(n=>n(t))}function np(t,n){if(!t)return null;const e=n?Gr:dc;return()=>("function"==typeof t?t():t).map(i=>e(i)).filter(tp)}function dx(...t){return{\u0275providers:op(0,t),\u0275fromNgModule:!0}}function op(t,...n){const e=[],i=new Set;let r;const o=s=>{e.push(s)};return ed(n,s=>{const a=s;sp(a,o,[],i)&&(r||=[],r.push(a))}),void 0!==r&&Vb(r,o),e}function Vb(t,n){for(let e=0;e<t.length;e++){const{ngModule:i,providers:r}=t[e];Eo(r,o=>{n(o,i)})}}function sp(t,n,e,i){if(!(t=ie(t)))return!1;let r=null,o=Gf(t);const s=!o&&Qn(t);if(o||s){if(s&&!s.standalone)return!1;r=t}else{const c=t.ngModule;if(o=Gf(c),!o)return!1;r=c}const a=i.has(r);if(s){if(a)return!1;if(i.add(r),s.dependencies){const c="function"==typeof s.dependencies?s.dependencies():s.dependencies;for(const u of c)sp(u,n,e,i)}}else{if(!o)return!1;{if(null!=o.imports&&!a){let u;i.add(r);try{ed(o.imports,f=>{sp(f,n,e,i)&&(u||=[],u.push(f))})}finally{}void 0!==u&&Vb(u,n)}if(!a){const u=tu(r)||(()=>new r);n({provide:r,useFactory:u,deps:wi},r),n({provide:Tm,useValue:r,multi:!0},r),n({provide:nd,useValue:()=>Nn(r),multi:!0},r)}const c=o.providers;if(null!=c&&!a){const u=t;Eo(c,f=>{n(f,u)})}}}return r!==t&&void 0!==t.providers}function Eo(t,n){for(let e of t)mm(e)&&(e=e.\u0275providers),Array.isArray(e)?Eo(e,n):n(e)}const hx=hi({provide:String,useValue:hi});function Dm(t){return null!==t&&"object"==typeof t&&hx in t}function Rl(t){return"function"==typeof t}const Ch=new mn(""),Ll={},xh={};let ou;function su(){return void 0===ou&&(ou=new Kf),ou}class ls{}class rd extends ls{get destroyed(){return this._destroyed}constructor(n,e,i,r){super(),this.parent=e,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,hc(n,s=>this.processProvider(s)),this.records.set(Bb,Bl(void 0,this)),r.has("environment")&&this.records.set(ls,Bl(void 0,this));const o=this.records.get(Ch);null!=o&&"string"==typeof o.value&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(Tm,wi,bi.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;const n=O(null);try{for(const i of this._ngOnDestroyHooks)i.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const i of e)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),O(n)}}onDestroy(n){return this.assertNotDestroyed(),this._onDestroyHooks.push(n),()=>this.removeOnDestroy(n)}runInContext(n){this.assertNotDestroyed();const e=uc(this),i=Po(void 0);try{return n()}finally{uc(e),Po(i)}}get(n,e=Jc,i=bi.Default){if(this.assertNotDestroyed(),n.hasOwnProperty(bm))return n[bm](this);i=ph(i);const o=uc(this),s=Po(void 0);try{if(!(i&bi.SkipSelf)){let c=this.records.get(n);if(void 0===c){const u=function ee(t){return"function"==typeof t||"object"==typeof t&&t instanceof mn}(n)&&fh(n);c=u&&this.injectableDefInScope(u)?Bl(Om(n),Ll):null,this.records.set(n,c)}if(null!=c)return this.hydrate(n,c)}return(i&bi.Self?su():this.parent).get(n,e=i&bi.Optional&&e===Jc?null:e)}catch(a){if("NullInjectorError"===a.name){if((a[Qu]=a[Qu]||[]).unshift(Ti(n)),o)throw a;return function ox(t,n,e,i){const r=t[Qu];throw n[ym]&&r.unshift(n[ym]),t.message=function Fb(t,n,e,i=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.slice(2):t;let r=Ti(n);if(Array.isArray(n))r=n.map(Ti).join(" -> ");else if("object"==typeof n){let o=[];for(let s in n)if(n.hasOwnProperty(s)){let a=n[s];o.push(s+":"+("string"==typeof a?JSON.stringify(a):Ti(a)))}r=`{${o.join(", ")}}`}return`${e}${i?"("+i+")":""}[${r}]: ${t.replace(ix,"\n  ")}`}("\n"+t.message,r,e,i),t.ngTokenPath=r,t[Qu]=null,t}(a,n,"R3InjectorError",this.source)}throw a}finally{Po(s),uc(o)}}resolveInjectorInitializers(){const n=O(null),e=uc(this),i=Po(void 0);try{const o=this.get(nd,wi,bi.Self);for(const s of o)s()}finally{uc(e),Po(i),O(n)}}toString(){const n=[],e=this.records;for(const i of e.keys())n.push(Ti(i));return`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new mt(205,!1)}processProvider(n){let e=Rl(n=ie(n))?n:ie(n&&n.provide);const i=function px(t){return Dm(t)?Bl(void 0,t.useValue):Bl(Gb(t),Ll)}(n);if(!Rl(n)&&!0===n.multi){let r=this.records.get(e);r||(r=Bl(void 0,Ll,!0),r.factory=()=>Cm(r.multi),this.records.set(e,r)),e=n,r.multi.push(n)}this.records.set(e,i)}hydrate(n,e){const i=O(null);try{return e.value===Ll&&(e.value=xh,e.value=e.factory()),"object"==typeof e.value&&e.value&&function Wb(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}finally{O(i)}}injectableDefInScope(n){if(!n.providedIn)return!1;const e=ie(n.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}removeOnDestroy(n){const e=this._onDestroyHooks.indexOf(n);-1!==e&&this._onDestroyHooks.splice(e,1)}}function Om(t){const n=fh(t),e=null!==n?n.factory:tu(t);if(null!==e)return e;if(t instanceof mn)throw new mt(204,!1);if(t instanceof Function)return function fx(t){if(t.length>0)throw new mt(204,!1);const e=function XC(t){return t&&(t[Ku]||t[kb])||null}(t);return null!==e?()=>e.factory(t):()=>new t}(t);throw new mt(204,!1)}function Gb(t,n,e){let i;if(Rl(t)){const r=ie(t);return tu(r)||Om(r)}if(Dm(t))i=()=>ie(t.useValue);else if(function jb(t){return!(!t||!t.useFactory)}(t))i=()=>t.useFactory(...Cm(t.deps||[]));else if(function km(t){return!(!t||!t.useExisting)}(t))i=()=>Nn(ie(t.useExisting));else{const r=ie(t&&(t.useClass||t.provide));if(!function wh(t){return!!t.deps}(t))return tu(r)||Om(r);i=()=>new r(...Cm(t.deps))}return i}function Bl(t,n,e=!1){return{factory:t,value:n,multi:e?[]:void 0}}function hc(t,n){for(const e of t)Array.isArray(e)?hc(e,n):e&&mm(e)?hc(e.\u0275providers,n):n(e)}const Oi=0,Yt=1,_n=2,Wr=3,Na=4,Yo=5,ao=6,sd=7,or=8,Bi=9,Ra=10,Rn=11,Th=12,Yb=13,ad=14,gr=15,ld=16,cd=17,zl=18,au=19,ud=20,La=21,lp=22,fc=23,Wn=25,Ba=1,Zo=7,dd=9,Rr=10;var cp=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(cp||{});function eo(t){return Array.isArray(t)&&"object"==typeof t[Ba]}function Sr(t){return Array.isArray(t)&&!0===t[Ba]}function up(t){return!!(4&t.flags)}function cu(t){return t.componentOffset>-1}function uu(t){return!(1&~t.flags)}function Ua(t){return!!t.template}function dp(t){return!!(512&t[_n])}class Tx{constructor(n,e,i){this.previousValue=n,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}}function Qb(t,n,e,i){null!==n?n.applyValueToInputSignal(n,i):t[e]=i}function hr(){return Nm}function Nm(t){return t.type.prototype.ngOnChanges&&(t.setInput=Sx),Rm}function Rm(){const t=Lm(this),n=t?.current;if(n){const e=t.previous;if(e===Kr)t.previous=n;else for(let i in n)e[i]=n[i];t.current=null,this.ngOnChanges(n)}}function Sx(t,n,e,i,r){const o=this.declaredInputs[i],s=Lm(t)||function Jb(t,n){return t[pp]=n}(t,{previous:Kr,current:null}),a=s.current||(s.current={}),c=s.previous,u=c[o];a[o]=new Tx(u&&u.currentValue,e,c===Kr),Qb(t,n,r,e)}hr.ngInherit=!0;const pp="__ngSimpleChanges__";function Lm(t){return t[pp]||null}const cl=function(t,n,e){},Bm="svg";let ev=!1;function Ui(t){for(;Array.isArray(t);)t=t[Oi];return t}function du(t,n){return Ui(n[t])}function us(t,n){return Ui(n[t.index])}function Zn(t,n){return t.data[n]}function gd(t,n){return t[n]}function Ws(t,n){const e=n[t];return eo(e)?e:e[Oi]}function bp(t){return!(128&~t[_n])}function ul(t,n){return null==n?null:t[n]}function $s(t){t[cd]=0}function Dx(t){1024&t[_n]||(t[_n]|=1024,bp(t)&&md(t))}function Dh(t){return!!(9216&t[_n]||t[fc]?.dirty)}function vp(t){t[Ra].changeDetectionScheduler?.notify(1),Dh(t)?md(t):64&t[_n]&&(function tv(){return ev}()?(t[_n]|=1024,md(t)):t[Ra].changeDetectionScheduler?.notify())}function md(t){t[Ra].changeDetectionScheduler?.notify();let n=Hl(t);for(;null!==n&&!(8192&n[_n])&&(n[_n]|=8192,bp(n));)n=Hl(n)}function qo(t,n){if(!(256&~t[_n]))throw new mt(911,!1);null===t[La]&&(t[La]=[]),t[La].push(n)}function Hl(t){const n=t[Wr];return Sr(n)?n[Wr]:n}const Fn={lFrame:Ph(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function yp(){return Fn.bindingsEnabled}function Ys(){return null!==Fn.skipHydrationRootTNode}function _t(){return Fn.lFrame.lView}function fi(){return Fn.lFrame.tView}function V(t){return Fn.lFrame.contextLView=t,t[or]}function H(t){return Fn.lFrame.contextLView=null,t}function zi(){let t=ov();for(;null!==t&&64===t.type;)t=t.parent;return t}function ov(){return Fn.lFrame.currentTNode}function Ha(t,n){const e=Fn.lFrame;e.currentTNode=t,e.isParent=n}function Xo(){return Fn.lFrame.isParent}function ma(){Fn.lFrame.isParent=!1}function to(){const t=Fn.lFrame;let n=t.bindingRootIndex;return-1===n&&(n=t.bindingRootIndex=t.tView.bindingStartIndex),n}function hl(){return Fn.lFrame.bindingIndex}function Va(){return Fn.lFrame.bindingIndex++}function fl(t){const n=Fn.lFrame,e=n.bindingIndex;return n.bindingIndex=n.bindingIndex+t,e}function Px(t,n){const e=Fn.lFrame;e.bindingIndex=e.bindingRootIndex=t,Cp(n)}function Cp(t){Fn.lFrame.currentDirectiveIndex=t}function xp(){return Fn.lFrame.currentQueryIndex}function hu(t){Fn.lFrame.currentQueryIndex=t}function Wm(t){const n=t[Yt];return 2===n.type?n.declTNode:1===n.type?t[Yo]:null}function Ah(t,n,e){if(e&bi.SkipSelf){let r=n,o=t;for(;!(r=r.parent,null!==r||e&bi.Host||(r=Wm(o),null===r||(o=o[ad],10&r.type))););if(null===r)return!1;n=r,t=o}const i=Fn.lFrame=Ym();return i.currentTNode=n,i.lView=t,!0}function $m(t){const n=Ym(),e=t[Yt];Fn.lFrame=n,n.currentTNode=e.firstChild,n.lView=t,n.tView=e,n.contextLView=t,n.bindingIndex=e.bindingStartIndex,n.inI18n=!1}function Ym(){const t=Fn.lFrame,n=null===t?null:t.child;return null===n?Ph(t):n}function Ph(t){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=n),n}function Zm(){const t=Fn.lFrame;return Fn.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const wp=Zm;function qm(){const t=Zm();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function mr(){return Fn.lFrame.selectedIndex}function gc(t){Fn.lFrame.selectedIndex=t}function er(){const t=Fn.lFrame;return Zn(t.tView,t.selectedIndex)}function mc(){Fn.lFrame.currentNamespace=Bm}let Ep=!0;function fu(){return Ep}function _a(t){Ep=t}function Vl(t,n){for(let e=n.directiveStart,i=n.directiveEnd;e<i;e++){const o=t.data[e].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:u,ngOnDestroy:f}=o;s&&(t.contentHooks??=[]).push(-e,s),a&&((t.contentHooks??=[]).push(e,a),(t.contentCheckHooks??=[]).push(e,a)),c&&(t.viewHooks??=[]).push(-e,c),u&&((t.viewHooks??=[]).push(e,u),(t.viewCheckHooks??=[]).push(e,u)),null!=f&&(t.destroyHooks??=[]).push(e,f)}}function xn(t,n,e){_c(t,n,3,e)}function pu(t,n,e,i){(3&t[_n])===e&&_c(t,n,e,i)}function Fh(t,n){let e=t[_n];(3&e)===n&&(e&=16383,e+=1,t[_n]=e)}function _c(t,n,e,i){const o=i??-1,s=n.length-1;let a=0;for(let c=void 0!==i?65535&t[cd]:0;c<s;c++)if("number"==typeof n[c+1]){if(a=n[c],null!=i&&a>=i)break}else n[c]<0&&(t[cd]+=65536),(a<o||-1==o)&&(Xm(t,e,n,c),t[cd]=(4294901760&t[cd])+c+2),c++}function cv(t,n){cl(4,t,n);const e=O(null);try{n.call(t)}finally{O(e),cl(5,t,n)}}function Xm(t,n,e,i){const r=e[i]<0,o=e[i+1],a=t[r?-e[i]:e[i]];r?t[_n]>>14<t[cd]>>16&&(3&t[_n])===n&&(t[_n]+=16384,cv(a,o)):cv(a,o)}const gu=-1;class no{constructor(n,e,i){this.factory=n,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=i}}function Qm(t){return t!==gu}function Zs(t){return 32767&t}function mu(t,n){let e=function ds(t){return t>>16}(t),i=n;for(;e>0;)i=i[ad],e--;return i}let Jm=!0;function Cd(t){const n=Jm;return Jm=t,n}const hv=255,xd=5;let fv=0;const ja={};function Tp(t,n){const e=pv(t,n);if(-1!==e)return e;const i=n[Yt];i.firstCreatePass&&(t.injectorIndex=n.length,e_(i.data,t),e_(n,null),e_(i.blueprint,null));const r=Nh(t,n),o=t.injectorIndex;if(Qm(r)){const s=Zs(r),a=mu(r,n),c=a[Yt].data;for(let u=0;u<8;u++)n[o+u]=a[s+u]|c[s+u]}return n[o+8]=r,o}function e_(t,n){t.push(0,0,0,0,0,0,0,0,n)}function pv(t,n){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===n[t.injectorIndex+8]?-1:t.injectorIndex}function Nh(t,n){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let e=0,i=null,r=n;for(;null!==r;){if(i=_v(r),null===i)return gu;if(e++,r=r[ad],-1!==i.injectorIndex)return i.injectorIndex|e<<16}return gu}function Sp(t,n,e){!function Bx(t,n,e){let i;"string"==typeof e?i=e.charCodeAt(0)||0:e.hasOwnProperty(Go)&&(i=e[Go]),null==i&&(i=e[Go]=fv++);const r=i&hv;n.data[t+(r>>xd)]|=1<<r}(t,n,e)}function Mp(t,n,e){if(e&bi.Optional||void 0!==t)return t;Ms()}function t_(t,n,e,i){if(e&bi.Optional&&void 0===i&&(i=null),!(e&(bi.Self|bi.Host))){const r=t[Bi],o=Po(void 0);try{return r?r.get(n,i,e&bi.Optional):Yf(n,i,e&bi.Optional)}finally{Po(o)}}return Mp(i,0,e)}function wd(t,n,e,i=bi.Default,r){if(null!==t){if(2048&n[_n]&&!(i&bi.Self)){const s=function Hx(t,n,e,i,r){let o=t,s=n;for(;null!==o&&null!==s&&2048&s[_n]&&!(512&s[_n]);){const a=Dp(o,s,e,i|bi.Self,ja);if(a!==ja)return a;let c=o.parent;if(!c){const u=s[ud];if(u){const f=u.get(e,ja,i);if(f!==ja)return f}c=_v(s),s=s[ad]}o=c}return r}(t,n,e,i,ja);if(s!==ja)return s}const o=Dp(t,n,e,i,ja);if(o!==ja)return o}return t_(n,e,i,r)}function Dp(t,n,e,i,r){const o=function mv(t){if("string"==typeof t)return t.charCodeAt(0)||0;const n=t.hasOwnProperty(Go)?t[Go]:void 0;return"number"==typeof n?n>=0?n&hv:zx:n}(e);if("function"==typeof o){if(!Ah(n,t,i))return i&bi.Host?Mp(r,0,i):t_(n,e,i,r);try{let s;if(s=o(i),null!=s||i&bi.Optional)return s;Ms()}finally{wp()}}else if("number"==typeof o){let s=null,a=pv(t,n),c=gu,u=i&bi.Host?n[gr][Yo]:null;for((-1===a||i&bi.SkipSelf)&&(c=-1===a?Nh(t,n):n[a+8],c!==gu&&bc(i,!1)?(s=n[Yt],a=Zs(c),n=mu(c,n)):a=-1);-1!==a;){const f=n[Yt];if(Ga(o,a,f.data)){const b=gv(a,n,e,s,i,u);if(b!==ja)return b}c=n[a+8],c!==gu&&bc(i,n[Yt].data[a+8]===u)&&Ga(o,a,n)?(s=f,a=Zs(c),n=mu(c,n)):a=-1}}return r}function gv(t,n,e,i,r,o){const s=n[Yt],a=s.data[t+8],f=Rh(a,s,e,null==i?cu(a)&&Jm:i!=s&&!!(3&a.type),r&bi.Host&&o===a);return null!==f?gl(n,s,f,a):ja}function Rh(t,n,e,i,r){const o=t.providerIndexes,s=n.data,a=1048575&o,c=t.directiveStart,f=o>>20,C=r?a+f:t.directiveEnd;for(let x=i?a:a+f;x<C;x++){const M=s[x];if(x<c&&e===M||x>=c&&M.type===e)return x}if(r){const x=s[c];if(x&&Ua(x)&&x.type===e)return c}return null}function gl(t,n,e,i){let r=t[e];const o=n.data;if(function Rx(t){return t instanceof no}(r)){const s=r;s.resolving&&function Ab(t,n){throw n&&n.join(" > "),new mt(-200,t)}(function ki(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():Hn(t)}(o[e]));const a=Cd(s.canSeeViewProviders);s.resolving=!0;const u=s.injectImpl?Po(s.injectImpl):null;Ah(t,i,bi.Default);try{r=t[e]=s.factory(void 0,o,t,i),n.firstCreatePass&&e>=i.directiveStart&&function Ip(t,n,e){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=n.type.prototype;if(i){const s=Nm(n);(e.preOrderHooks??=[]).push(t,s),(e.preOrderCheckHooks??=[]).push(t,s)}r&&(e.preOrderHooks??=[]).push(0-t,r),o&&((e.preOrderHooks??=[]).push(t,o),(e.preOrderCheckHooks??=[]).push(t,o))}(e,o[e],n)}finally{null!==u&&Po(u),Cd(a),s.resolving=!1,wp()}}return r}function Ga(t,n,e){return!!(e[n+(t>>xd)]&1<<t)}function bc(t,n){return!(t&bi.Self||t&bi.Host&&n)}class lo{constructor(n,e){this._tNode=n,this._lView=e}get(n,e,i){return wd(this._tNode,this._lView,n,ph(i),e)}}function zx(){return new lo(zi(),_t())}function Ko(t){return Ao(()=>{const n=t.prototype.constructor,e=n[Pa]||n_(n),i=Object.prototype;let r=Object.getPrototypeOf(t.prototype).constructor;for(;r&&r!==i;){const o=r[Pa]||n_(r);if(o&&o!==e)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function n_(t){return Pe(t)?()=>{const n=n_(ie(t));return n&&n()}:tu(t)}function _v(t){const n=t[Yt],e=n.type;return 2===e?n.declTNode:1===e?t[Yo]:null}function xv(t,n=null,e=null,i){const r=wv(t,n,e,i);return r.resolveInjectorInitializers(),r}function wv(t,n=null,e=null,i,r=new Set){const o=[e||wi,dx(t)];return i=i||("object"==typeof t?void 0:Ti(t)),new rd(o,n||su(),i||null,r)}let hs=(()=>{class t{static#e=this.THROW_IF_NOT_FOUND=Jc;static#t=this.NULL=new Kf;static create(e,i){if(Array.isArray(e))return xv({name:""},i,e,"");{const r=e.name??"";return xv({name:r},e.parent,e.providers,r)}}static#n=this.\u0275prov=nn({token:t,providedIn:"any",factory:()=>Nn(Bb)});static#i=this.__NG_ELEMENT_ID__=-1}return t})();function s_(t){return t.ngOriginalError}class $a{constructor(){this._console=console}handleError(n){const e=this._findOriginalError(n);this._console.error("ERROR",n),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(n){let e=n&&s_(n);for(;e&&s_(e);)e=s_(e);return e||null}}const Iv=new mn("",{providedIn:"root",factory:()=>kn($a).handleError.bind(void 0)});let Id=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=Zx;static#t=this.__NG_ENV_ID__=e=>e}return t})();class Yx extends Id{constructor(n){super(),this._lView=n}onDestroy(n){return qo(this._lView,n),()=>function dl(t,n){if(null===t[La])return;const e=t[La].indexOf(n);-1!==e&&t[La].splice(e,1)}(this._lView,n)}}function Zx(){return new Yx(_t())}function qx(){return Td(zi(),_t())}function Td(t,n){return new fr(us(t,n))}let fr=(()=>{class t{constructor(e){this.nativeElement=e}static#e=this.__NG_ELEMENT_ID__=qx}return t})();function Tv(t){return t instanceof fr?t.nativeElement:t}function a_(t){return n=>{setTimeout(t,void 0,n)}}const ei=class Xx extends zs{constructor(n=!1){super(),this.destroyRef=void 0,this.__isAsync=n,function Gs(){return void 0!==Pl()||null!=function Ju(){return Fl}()}()&&(this.destroyRef=kn(Id,{optional:!0})??void 0)}emit(n){const e=O(null);try{super.next(n)}finally{O(e)}}subscribe(n,e,i){let r=n,o=e||(()=>null),s=i;if(n&&"object"==typeof n){const c=n;r=c.next?.bind(c),o=c.error?.bind(c),s=c.complete?.bind(c)}this.__isAsync&&(o=a_(o),r&&(r=a_(r)),s&&(s=a_(s)));const a=super.subscribe({next:r,error:o,complete:s});return n instanceof Ie&&n.add(a),a}};function Kx(){return this._results[Symbol.iterator]()}class l_{static#e=Symbol.iterator;get changes(){return this._changes??=new ei}constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._onDirty=void 0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;const e=l_.prototype;e[Symbol.iterator]||(e[Symbol.iterator]=Kx)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,e){return this._results.reduce(n,e)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,e){this.dirty=!1;const i=function Ds(t){return t.flat(Number.POSITIVE_INFINITY)}(n);(this._changesDetected=!function sx(t,n,e){if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++){let r=t[i],o=n[i];if(e&&(r=e(r),o=e(o)),o!==r)return!1}return!0}(this._results,i,e))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}onDirty(n){this._onDirty=n}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}}function Pp(t){return!(128&~t.flags)}const Bh=new Map;let Dv=0;const Np="__ngContext__";function Qo(t,n){eo(n)?(t[Np]=n[au],function ew(t){Bh.set(t[au],t)}(n)):t[Np]=n}function Lv(t){return Uv(t[Th])}function Bv(t){return Uv(t[Na])}function Uv(t){for(;null!==t&&!Sr(t);)t=t[Na];return t}let h_;function Ya(){if(void 0!==h_)return h_;if(typeof document<"u")return document;throw new mt(210,!1)}const Bp=new mn("",{providedIn:"root",factory:()=>Wv}),Wv="ng",f_=new mn(""),Za=new mn("",{providedIn:"platform",factory:()=>"unknown"}),p_=new mn(""),Up=new mn("",{providedIn:"root",factory:()=>Ya().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let Yv=()=>null;function C_(t,n,e=!1){return Yv(t,n,e)}const w_=new mn("",{providedIn:"root",factory:()=>!1});let $p,wc;function Md(t){return function E_(){if(void 0===$p&&($p=null,li.trustedTypes))try{$p=li.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return $p}()?.createHTML(t)||t}function qv(t){return function jh(){if(void 0===wc&&(wc=null,li.trustedTypes))try{wc=li.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return wc}()?.createHTML(t)||t}class co{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${qc})`}}class Dd extends co{getTypeName(){return"HTML"}}class Sw extends co{getTypeName(){return"Style"}}class Mw extends co{getTypeName(){return"Script"}}class Dw extends co{getTypeName(){return"URL"}}class kw extends co{getTypeName(){return"ResourceURL"}}function qs(t){return t instanceof co?t.changingThisBreaksApplicationSecurity:t}function Xa(t,n){const e=function jl(t){return t instanceof co&&t.getTypeName()||null}(t);if(null!=e&&e!==n){if("ResourceURL"===e&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${e} (see ${qc})`)}return e===n}class Aw{constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{const e=(new window.DOMParser).parseFromString(Md(n),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(n):(e.removeChild(e.firstChild),e)}catch{return null}}}class Qv{constructor(n){this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(n){const e=this.inertDocument.createElement("template");return e.innerHTML=Md(n),e}}const Pw=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Zp(t){return(t=String(t)).match(Pw)?t:"unsafe:"+t}function Gl(t){const n={};for(const e of t.split(","))n[e]=!0;return n}function Wh(...t){const n={};for(const e of t)for(const i in e)e.hasOwnProperty(i)&&(n[i]=!0);return n}const Jv=Gl("area,br,col,hr,img,wbr"),e1=Gl("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),t1=Gl("rp,rt"),T_=Wh(Jv,Wh(e1,Gl("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Wh(t1,Gl("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Wh(t1,e1)),S_=Gl("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),i1=Wh(S_,Gl("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Gl("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),M_=Gl("script,style,template");class Fw{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(n){let e=n.firstChild,i=!0,r=[];for(;e;)if(e.nodeType===Node.ELEMENT_NODE?i=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,i&&e.firstChild)r.push(e),e=To(e);else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let o=Rw(e);if(o){e=o;break}e=r.pop()}return this.buf.join("")}startElement(n){const e=fs(n).toLowerCase();if(!T_.hasOwnProperty(e))return this.sanitizedSomething=!0,!M_.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const i=n.attributes;for(let r=0;r<i.length;r++){const o=i.item(r),s=o.name,a=s.toLowerCase();if(!i1.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let c=o.value;S_[a]&&(c=Zp(c)),this.buf.push(" ",s,'="',D_(c),'"')}return this.buf.push(">"),!0}endElement(n){const e=fs(n).toLowerCase();T_.hasOwnProperty(e)&&!Jv.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(n){this.buf.push(D_(n))}}function Rw(t){const n=t.nextSibling;if(n&&t!==n.previousSibling)throw r1(n);return n}function To(t){const n=t.firstChild;if(n&&function Nw(t,n){return(t.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_CONTAINED_BY)!==Node.DOCUMENT_POSITION_CONTAINED_BY}(t,n))throw r1(n);return n}function fs(t){const n=t.nodeName;return"string"==typeof n?n:"FORM"}function r1(t){return new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`)}const Lw=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Bw=/([^\#-~ |!])/g;function D_(t){return t.replace(/&/g,"&amp;").replace(Lw,function(n){return"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";"}).replace(Bw,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let qp;function o1(t,n){let e=null;try{qp=qp||function Fi(t){const n=new Qv(t);return function Yp(){try{return!!(new window.DOMParser).parseFromString(Md(""),"text/html")}catch{return!1}}()?new Aw(n):n}(t);let i=n?String(n):"";e=qp.getInertBodyElement(i);let r=5,o=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=o,o=e.innerHTML,e=qp.getInertBodyElement(i)}while(i!==o);return Md((new Fw).sanitizeChildren(k_(e)||e))}finally{if(e){const i=k_(e)||e;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function k_(t){return"content"in t&&function s1(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var va=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(va||{});function $r(t){const n=$h();return n?qv(n.sanitize(va.HTML,t)||""):Xa(t,"HTML")?qv(qs(t)):o1(Ya(),Hn(t))}function bn(t){const n=$h();return n?n.sanitize(va.URL,t)||"":Xa(t,"URL")?qs(t):Zp(Hn(t))}function $h(){const t=_t();return t&&t[Ra].sanitizer}const Gw=/^>|^->|<!--|-->|--!>|<!-$/g,Ww=/(<|>)/g,a1="\u200b$1\u200b";function Yh(t){return t.ownerDocument}var Yr=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(Yr||{});let Zh;function L_(t,n){return Zh(t,n)}function Ad(t,n,e,i,r){if(null!=i){let o,s=!1;Sr(i)?o=i:eo(i)&&(s=!0,i=i[Oi]);const a=Ui(i);0===t&&null!==e?null==r?b1(n,e,a):yu(n,e,a,r||null,!0):1===t&&null!==e?yu(n,e,a,r||null,!0):2===t?function Qh(t,n,e){const i=Jp(t,n);i&&function lE(t,n,e,i){t.removeChild(n,e,i)}(t,i,n,e)}(n,a,s):3===t&&n.destroyNode(a),null!=o&&function le(t,n,e,i,r){const o=e[Zo];o!==Ui(e)&&Ad(n,t,i,o,r);for(let a=Rr;a<e.length;a++){const c=e[a];_(c[Yt],c,t,n,i,o)}}(n,t,o,e,r)}}function U_(t,n){return t.createComment(function A_(t){return t.replace(Gw,n=>n.replace(Ww,a1))}(n))}function Pd(t,n,e){return t.createElement(n,e)}function p1(t,n){n[Ra].changeDetectionScheduler?.notify(1),_(t,n,n[Rn],2,null,null)}function m1(t,n){const e=t[dd],i=e.indexOf(n);e.splice(i,1)}function qh(t,n){if(t.length<=Rr)return;const e=Rr+n,i=t[e];if(i){const r=i[ld];null!==r&&r!==t&&m1(r,i),n>0&&(t[e-1][Na]=i[Na]);const o=Nl(t,Rr+n);!function nE(t,n){p1(t,n),n[Oi]=null,n[Yo]=null}(i[Yt],i);const s=o[zl];null!==s&&s.detachView(o[Yt]),i[Wr]=null,i[Na]=null,i[_n]&=-129}return i}function Fd(t,n){if(!(256&n[_n])){const e=n[Rn];e.destroyNode&&_(t,n,e,3,null,null),function rE(t){let n=t[Th];if(!n)return Xh(t[Yt],t);for(;n;){let e=null;if(eo(n))e=n[Th];else{const i=n[Rr];i&&(e=i)}if(!e){for(;n&&!n[Na]&&n!==t;)eo(n)&&Xh(n[Yt],n),n=n[Wr];null===n&&(n=t),eo(n)&&Xh(n[Yt],n),e=n&&n[Na]}n=e}}(n)}}function Xh(t,n){if(256&n[_n])return;const e=O(null);try{n[_n]&=-129,n[_n]|=256,n[fc]&&function ce(t){if(pe(t),Qe(t))for(let n=0;n<t.producerNode.length;n++)ue(t.producerNode[n],t.producerIndexOfThis[n]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}(n[fc]),function aE(t,n){let e;if(null!=t&&null!=(e=t.destroyHooks))for(let i=0;i<e.length;i+=2){const r=n[e[i]];if(!(r instanceof no)){const o=e[i+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){const a=r[o[s]],c=o[s+1];cl(4,a,c);try{c.call(a)}finally{cl(5,a,c)}}else{cl(4,r,o);try{o.call(r)}finally{cl(5,r,o)}}}}}(t,n),function sE(t,n){const e=t.cleanup,i=n[sd];if(null!==e)for(let o=0;o<e.length-1;o+=2)if("string"==typeof e[o]){const s=e[o+3];s>=0?i[s]():i[-s].unsubscribe(),o+=2}else e[o].call(i[e[o+1]]);null!==i&&(n[sd]=null);const r=n[La];if(null!==r){n[La]=null;for(let o=0;o<r.length;o++)(0,r[o])()}}(t,n),1===n[Yt].type&&n[Rn].destroy();const i=n[ld];if(null!==i&&Sr(n[Wr])){i!==n[Wr]&&m1(i,n);const r=n[zl];null!==r&&r.detachView(t)}!function tw(t){Bh.delete(t[au])}(n)}finally{O(e)}}function z_(t,n,e){return function _1(t,n,e){let i=n;for(;null!==i&&40&i.type;)i=(n=i).parent;if(null===i)return e[Oi];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:o}=t.data[i.directiveStart+r];if(o===ks.None||o===ks.Emulated)return null}return us(i,e)}}(t,n.parent,e)}function yu(t,n,e,i,r){t.insertBefore(n,e,i,r)}function b1(t,n,e){t.appendChild(n,e)}function v1(t,n,e,i,r){null!==i?yu(t,n,e,i,r):b1(t,n,e)}function Jp(t,n){return t.parentNode(n)}function y1(t,n,e){return x1(t,n,e)}let H_,x1=function C1(t,n,e){return 40&t.type?us(t,e):null};function eg(t,n,e,i){const r=z_(t,i,n),o=n[Rn],a=y1(i.parent||n[Yo],i,n);if(null!=r)if(Array.isArray(e))for(let c=0;c<e.length;c++)v1(o,r,e[c],a,!1);else v1(o,r,e,a,!1);void 0!==H_&&H_(o,i,n,e,r)}function Kh(t,n){if(null!==n){const e=n.type;if(3&e)return us(n,t);if(4&e)return V_(-1,t[n.index]);if(8&e){const i=n.child;if(null!==i)return Kh(t,i);{const r=t[n.index];return Sr(r)?V_(-1,r):Ui(r)}}if(32&e)return L_(n,t)()||Ui(t[n.index]);{const i=E1(t,n);return null!==i?Array.isArray(i)?i[0]:Kh(Hl(t[gr]),i):Kh(t,n.next)}}return null}function E1(t,n){return null!==n?t[gr][Yo].projection[n.projection]:null}function V_(t,n){const e=Rr+t+1;if(e<n.length){const i=n[e],r=i[Yt].firstChild;if(null!==r)return Kh(i,r)}return n[Zo]}function d(t,n,e,i,r,o,s){for(;null!=e;){const a=i[e.index],c=e.type;if(s&&0===n&&(a&&Qo(Ui(a),i),e.flags|=2),32&~e.flags)if(8&c)d(t,n,e.child,i,r,o,!1),Ad(n,t,r,a,o);else if(32&c){const u=L_(e,i);let f;for(;f=u();)Ad(n,t,r,f,o);Ad(n,t,r,a,o)}else 16&c?G(t,n,i,e,r,o):Ad(n,t,r,a,o);e=s?e.projectionNext:e.next}}function _(t,n,e,i,r,o){d(e,i,t.firstChild,n,r,o,!1)}function G(t,n,e,i,r,o){const s=e[gr],c=s[Yo].projection[i.projection];if(Array.isArray(c))for(let u=0;u<c.length;u++)Ad(n,t,r,c[u],o);else{let u=c;const f=s[Wr];Pp(i)&&(u.flags|=128),d(t,n,u,f,r,o,!0)}}function $e(t,n,e){""===e?t.removeAttribute(n,"class"):t.setAttribute(n,"class",e)}function It(t,n,e){const{mergedAttrs:i,classes:r,styles:o}=e;null!==i&&ut(t,n,i),null!==r&&$e(t,n,r),null!==o&&function Me(t,n,e){t.setAttribute(n,"style",e)}(t,n,o)}const nt={};function h(t=1){Jt(fi(),_t(),mr()+t,!1)}function Jt(t,n,e,i){if(!i)if(3&~n[_n]){const o=t.preOrderHooks;null!==o&&pu(n,o,0,e)}else{const o=t.preOrderCheckHooks;null!==o&&xn(n,o,e)}gc(e)}function Y(t,n=bi.Default){const e=_t();return null===e?Nn(t,n):wd(zi(),e,ie(t),n)}function ni(t,n,e,i,r,o){const s=O(null);try{let a=null;r&Ce.SignalBased&&(a=n[i][P]),null!==a&&void 0!==a.transformFn&&(o=a.transformFn(o)),r&Ce.HasDecoratorInputTransform&&(o=t.inputTransforms[i].call(n,o)),null!==t.setInput?t.setInput(n,a,o,e,i):Qb(n,a,i,o)}finally{O(s)}}function si(t,n,e,i,r,o,s,a,c,u,f){const b=n.blueprint.slice();return b[Oi]=r,b[_n]=204|i,(null!==u||t&&2048&t[_n])&&(b[_n]|=2048),$s(b),b[Wr]=b[ad]=t,b[or]=e,b[Ra]=s||t&&t[Ra],b[Rn]=a||t&&t[Rn],b[Bi]=c||t&&t[Bi]||null,b[Yo]=o,b[au]=function Jx(){return Dv++}(),b[ao]=f,b[ud]=u,b[gr]=2==n.type?t[gr]:b,b}function ai(t,n,e,i,r){let o=t.data[n];if(null===o)o=function gs(t,n,e,i,r){const o=ov(),s=Xo(),c=t.data[n]=function cL(t,n,e,i,r,o){let s=n?n.injectorIndex:-1,a=0;return Ys()&&(a|=128),{type:e,index:i,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?o:o&&o.parent,e,n,i,r);return null===t.firstChild&&(t.firstChild=c),null!==o&&(s?null==o.child&&null!==c.parent&&(o.child=c):null===o.next&&(o.next=c,c.prev=o)),c}(t,n,e,i,r),function bd(){return Fn.lFrame.inI18n}()&&(o.flags|=32);else if(64&o.type){o.type=e,o.value=i,o.attrs=r;const s=function _d(){const t=Fn.lFrame,n=t.currentTNode;return t.isParent?n:n.parent}();o.injectorIndex=null===s?-1:s.injectorIndex}return Ha(o,!0),o}function uo(t,n,e,i){if(0===e)return-1;const r=n.length;for(let o=0;o<e;o++)n.push(i),t.blueprint.push(i),t.data.push(null);return r}function Ps(t,n,e,i,r){const o=mr(),s=2&i;try{gc(-1),s&&n.length>Wn&&Jt(t,n,Wn,!1),cl(s?2:0,r),e(i,r)}finally{gc(o),cl(s?3:1,r)}}function Dr(t,n,e){if(up(n)){const i=O(null);try{const o=n.directiveEnd;for(let s=n.directiveStart;s<o;s++){const a=t.data[s];a.contentQueries&&a.contentQueries(1,e[s],s)}}finally{O(i)}}}function Xs(t,n,e){yp()&&(function mL(t,n,e,i){const r=e.directiveStart,o=e.directiveEnd;cu(e)&&function wL(t,n,e){const i=us(n,t),r=j_(e);let s=16;e.signals?s=4096:e.onPush&&(s=64);const a=I1(t,si(t,r,null,s,i,n,null,t[Ra].rendererFactory.createRenderer(i,e),null,null,null));t[n.index]=a}(n,e,t.data[r+e.componentOffset]),t.firstCreatePass||Tp(e,n),Qo(i,n);const s=e.initialInputs;for(let a=r;a<o;a++){const c=t.data[a],u=gl(n,t,a,e);Qo(u,n),null!==s&&EL(0,a-r,u,c,0,s),Ua(c)&&(Ws(e.index,n)[or]=gl(n,t,a,e))}}(t,n,e,us(e,n)),!(64&~e.flags)&&FM(t,n,e))}function Ka(t,n,e=us){const i=n.localNames;if(null!==i){let r=n.index+1;for(let o=0;o<i.length;o+=2){const s=i[o+1],a=-1===s?e(n,t):t[s];t[r++]=a}}}function j_(t){const n=t.tView;return null===n||n.incompleteFirstPass?t.tView=uE(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):n}function uE(t,n,e,i,r,o,s,a,c,u,f){const b=Wn+i,C=b+r,x=function iL(t,n){const e=[];for(let i=0;i<n;i++)e.push(i<t?null:nt);return e}(b,C),M="function"==typeof u?u():u;return x[Yt]={type:t,blueprint:x,template:e,queries:null,viewQuery:a,declTNode:n,data:x.slice().fill(null,b),bindingStartIndex:b,expandoStartIndex:C,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:c,consts:M,incompleteFirstPass:!1,ssrId:f}}let kM=()=>null;function OM(t,n,e,i,r){for(let o in n){if(!n.hasOwnProperty(o))continue;const s=n[o];if(void 0===s)continue;i??={};let a,c=Ce.None;Array.isArray(s)?(a=s[0],c=s[1]):a=s;let u=o;if(null!==r){if(!r.hasOwnProperty(o))continue;u=r[o]}0===t?AM(i,e,u,a,c):AM(i,e,u,a)}return i}function AM(t,n,e,i,r){let o;t.hasOwnProperty(e)?(o=t[e]).push(n,i):o=t[e]=[n,i],void 0!==r&&o.push(r)}function Ca(t,n,e,i,r,o,s,a){const c=us(n,e);let f,u=n.inputs;!a&&null!=u&&(f=u[i])?(gE(t,e,f,i,r),cu(n)&&function hL(t,n){const e=Ws(n,t);16&e[_n]||(e[_n]|=64)}(e,n.index)):3&n.type&&(i=function dL(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(i),r=null!=s?s(r,n.value||"",i):r,o.setProperty(c,i,r))}function dE(t,n,e,i){if(yp()){const r=null===i?null:{"":-1},o=function bL(t,n){const e=t.directiveRegistry;let i=null,r=null;if(e)for(let o=0;o<e.length;o++){const s=e[o];if(_h(n,s.selectors,!1))if(i||(i=[]),Ua(s))if(null!==s.findHostDirectiveDefs){const a=[];r=r||new Map,s.findHostDirectiveDefs(s,a,r),i.unshift(...a,s),hE(t,n,a.length)}else i.unshift(s),hE(t,n,0);else r=r||new Map,s.findHostDirectiveDefs?.(s,i,r),i.push(s)}return null===i?null:[i,r]}(t,e);let s,a;null===o?s=a=null:[s,a]=o,null!==s&&PM(t,n,e,s,r,a),r&&function vL(t,n,e){if(n){const i=t.localNames=[];for(let r=0;r<n.length;r+=2){const o=e[n[r+1]];if(null==o)throw new mt(-301,!1);i.push(n[r],o)}}}(e,i,r)}e.mergedAttrs=vi(e.mergedAttrs,e.attrs)}function PM(t,n,e,i,r,o){for(let u=0;u<i.length;u++)Sp(Tp(e,n),t,i[u].type);!function CL(t,n,e){t.flags|=1,t.directiveStart=n,t.directiveEnd=n+e,t.providerIndexes=n}(e,t.data.length,i.length);for(let u=0;u<i.length;u++){const f=i[u];f.providersResolver&&f.providersResolver(f)}let s=!1,a=!1,c=uo(t,n,i.length,null);for(let u=0;u<i.length;u++){const f=i[u];e.mergedAttrs=vi(e.mergedAttrs,f.hostAttrs),xL(t,e,n,c,f),yL(c,f,r),null!==f.contentQueries&&(e.flags|=4),(null!==f.hostBindings||null!==f.hostAttrs||0!==f.hostVars)&&(e.flags|=64);const b=f.type.prototype;!s&&(b.ngOnChanges||b.ngOnInit||b.ngDoCheck)&&((t.preOrderHooks??=[]).push(e.index),s=!0),!a&&(b.ngOnChanges||b.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(e.index),a=!0),c++}!function uL(t,n,e){const r=n.directiveEnd,o=t.data,s=n.attrs,a=[];let c=null,u=null;for(let f=n.directiveStart;f<r;f++){const b=o[f],C=e?e.get(b):null,M=C?C.outputs:null;c=OM(0,b.inputs,f,c,C?C.inputs:null),u=OM(1,b.outputs,f,u,M);const U=null===c||null===s||Mm(n)?null:IL(c,f,s);a.push(U)}null!==c&&(c.hasOwnProperty("class")&&(n.flags|=8),c.hasOwnProperty("style")&&(n.flags|=16)),n.initialInputs=a,n.inputs=c,n.outputs=u}(t,e,o)}function FM(t,n,e){const i=e.directiveStart,r=e.directiveEnd,o=e.index,s=function sv(){return Fn.lFrame.currentDirectiveIndex}();try{gc(o);for(let a=i;a<r;a++){const c=t.data[a],u=n[a];Cp(a),(null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs)&&_L(c,u)}}finally{gc(-1),Cp(s)}}function _L(t,n){null!==t.hostBindings&&t.hostBindings(1,n)}function hE(t,n,e){n.componentOffset=e,(t.components??=[]).push(n.index)}function yL(t,n,e){if(e){if(n.exportAs)for(let i=0;i<n.exportAs.length;i++)e[n.exportAs[i]]=t;Ua(n)&&(e[""]=t)}}function xL(t,n,e,i,r){t.data[i]=r;const o=r.factory||(r.factory=tu(r.type)),s=new no(o,Ua(r),Y);t.blueprint[i]=s,e[i]=s,function pL(t,n,e,i,r){const o=r.hostBindings;if(o){let s=t.hostBindingOpCodes;null===s&&(s=t.hostBindingOpCodes=[]);const a=~n.index;(function gL(t){let n=t.length;for(;n>0;){const e=t[--n];if("number"==typeof e&&e<0)return e}return 0})(s)!=a&&s.push(a),s.push(e,i,o)}}(t,n,i,uo(t,e,r.hostVars,nt),r)}function Ec(t,n,e,i,r,o){const s=us(t,n);!function fE(t,n,e,i,r,o,s){if(null==o)t.removeAttribute(n,r,e);else{const a=null==s?Hn(o):s(o,i||"",r);t.setAttribute(n,r,a,e)}}(n[Rn],s,o,t.value,e,i,r)}function EL(t,n,e,i,r,o){const s=o[n];if(null!==s)for(let a=0;a<s.length;)ni(i,e,s[a++],s[a++],s[a++],s[a++])}function IL(t,n,e){let i=null,r=0;for(;r<e.length;){const o=e[r];if(0!==o)if(5!==o){if("number"==typeof o)break;if(t.hasOwnProperty(o)){null===i&&(i=[]);const s=t[o];for(let a=0;a<s.length;a+=3)if(s[a]===n){i.push(o,s[a+1],s[a+2],e[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function NM(t,n,e,i){return[t,!0,0,n,null,i,null,e,null,null]}function RM(t,n){const e=t.contentQueries;if(null!==e){const i=O(null);try{for(let r=0;r<e.length;r+=2){const s=e[r+1];if(-1!==s){const a=t.data[s];hu(e[r]),a.contentQueries(2,n[s],s)}}}finally{O(i)}}}function I1(t,n){return t[Th]?t[Yb][Na]=n:t[Th]=n,t[Yb]=n,n}function pE(t,n,e){hu(0);const i=O(null);try{n(t,e)}finally{O(i)}}function LM(t){return t[sd]||(t[sd]=[])}function BM(t){return t.cleanup||(t.cleanup=[])}function T1(t,n){const e=t[Bi],i=e?e.get($a,null):null;i&&i.handleError(n)}function gE(t,n,e,i,r){for(let o=0;o<e.length;){const s=e[o++],a=e[o++],c=e[o++];ni(t.data[s],n[s],i,a,c,r)}}function Cu(t,n,e){const i=du(n,t);!function Qp(t,n,e){t.setValue(n,e)}(t[Rn],i,e)}function TL(t,n){const e=Ws(n,t),i=e[Yt];!function SL(t,n){for(let e=n.length;e<t.blueprint.length;e++)n.push(t.blueprint[e])}(i,e);const r=e[Oi];null!==r&&null===e[ao]&&(e[ao]=C_(r,e[Bi])),mE(i,e,e[or])}function mE(t,n,e){$m(n);try{const i=t.viewQuery;null!==i&&pE(1,i,e);const r=t.template;null!==r&&Ps(t,n,r,1,e),t.firstCreatePass&&(t.firstCreatePass=!1),n[zl]?.finishViewCreation(t),t.staticContentQueries&&RM(t,n),t.staticViewQueries&&pE(2,t.viewQuery,e);const o=t.components;null!==o&&function ML(t,n){for(let e=0;e<n.length;e++)TL(t,n[e])}(n,o)}catch(i){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),i}finally{n[_n]&=-5,qm()}}function G_(t,n,e,i){const r=O(null);try{const o=n.tView,c=si(t,o,e,4096&t[_n]?4096:16,null,n,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null);c[ld]=t[n.index];const f=t[zl];return null!==f&&(c[zl]=f.createEmbeddedView(o)),mE(o,c,e),c}finally{O(r)}}function tg(t,n){return!n||null===n.firstChild||Pp(t)}function W_(t,n,e,i=!0){const r=n[Yt];if(function g1(t,n,e,i){const r=Rr+i,o=e.length;i>0&&(e[r-1][Na]=n),i<o-Rr?(n[Na]=e[r],Rb(e,Rr+i,n)):(e.push(n),n[Na]=null),n[Wr]=e;const s=n[ld];null!==s&&e!==s&&function oE(t,n){const e=t[dd];n[gr]!==n[Wr][Wr][gr]&&(t[_n]|=cp.HasTransplantedViews),null===e?t[dd]=[n]:e.push(n)}(s,n);const a=n[zl];null!==a&&a.insertView(t),vp(n),n[_n]|=128}(r,n,t,e),i){const s=V_(e,t),a=n[Rn],c=Jp(a,t[Zo]);null!==c&&function iE(t,n,e,i,r,o){i[Oi]=r,i[Yo]=n,_(t,i,e,1,r,o)}(r,t[Yo],a,n,c,s)}const o=n[ao];null!==o&&null!==o.firstChild&&(o.firstChild=null)}function $_(t,n,e,i,r=!1){for(;null!==e;){const o=n[e.index];null!==o&&i.push(Ui(o)),Sr(o)&&HM(o,i);const s=e.type;if(8&s)$_(t,n,e.child,i);else if(32&s){const a=L_(e,n);let c;for(;c=a();)i.push(c)}else if(16&s){const a=E1(n,e);if(Array.isArray(a))i.push(...a);else{const c=Hl(n[gr]);$_(c[Yt],c,a,i,!0)}}e=r?e.projectionNext:e.next}return i}function HM(t,n){for(let e=Rr;e<t.length;e++){const i=t[e],r=i[Yt].firstChild;null!==r&&$_(i[Yt],i,r,n)}t[Zo]!==t[Oi]&&n.push(t[Zo])}let VM=[];const AL={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{},consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{md(t.lView)},consumerOnSignalRead(){this.lView[fc]=this}},jM=100;function S1(t,n=!0,e=0){const i=t[Ra],r=i.rendererFactory;r.begin?.();try{!function PL(t,n){bE(t,n);let e=0;for(;Dh(t);){if(e===jM)throw new mt(103,!1);e++,bE(t,1)}}(t,e)}catch(s){throw n&&T1(t,s),s}finally{r.end?.(),i.inlineEffectRunner?.flush()}}function FL(t,n,e,i){const r=n[_n];if(!(256&~r))return;n[Ra].inlineEffectRunner?.flush(),$m(n);let s=null,a=null;(function NL(t){return 2!==t.type})(t)&&(a=function DL(t){return t[fc]??function kL(t){const n=VM.pop()??Object.create(AL);return n.lView=t,n}(t)}(n),s=function J(t){return t&&(t.nextProducerIndex=0),O(t)}(a));try{$s(n),function Gm(t){return Fn.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==e&&Ps(t,n,e,2,i);const c=!(3&~r);if(c){const b=t.preOrderCheckHooks;null!==b&&xn(n,b,null)}else{const b=t.preOrderHooks;null!==b&&pu(n,b,0,null),Fh(n,0)}if(function RL(t){for(let n=Lv(t);null!==n;n=Bv(n)){if(!(n[_n]&cp.HasTransplantedViews))continue;const e=n[dd];for(let i=0;i<e.length;i++){Dx(e[i])}}}(n),GM(n,0),null!==t.contentQueries&&RM(t,n),c){const b=t.contentCheckHooks;null!==b&&xn(n,b)}else{const b=t.contentHooks;null!==b&&pu(n,b,1),Fh(n,1)}!function An(t,n){const e=t.hostBindingOpCodes;if(null!==e)try{for(let i=0;i<e.length;i++){const r=e[i];if(r<0)gc(~r);else{const o=r,s=e[++i],a=e[++i];Px(s,o),a(2,n[o])}}}finally{gc(-1)}}(t,n);const u=t.components;null!==u&&$M(n,u,0);const f=t.viewQuery;if(null!==f&&pE(2,f,i),c){const b=t.viewCheckHooks;null!==b&&xn(n,b)}else{const b=t.viewHooks;null!==b&&pu(n,b,2),Fh(n,2)}if(!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),n[lp]){for(const b of n[lp])b();n[lp]=null}n[_n]&=-73}catch(c){throw md(n),c}finally{null!==a&&(function ae(t,n){if(O(n),t&&void 0!==t.producerNode&&void 0!==t.producerIndexOfThis&&void 0!==t.producerLastReadVersion){if(Qe(t))for(let e=t.nextProducerIndex;e<t.producerNode.length;e++)ue(t.producerNode[e],t.producerIndexOfThis[e]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}(a,s),function OL(t){t.lView[fc]!==t&&(t.lView=null,VM.push(t))}(a)),qm()}}function GM(t,n){for(let e=Lv(t);null!==e;e=Bv(e))for(let i=Rr;i<e.length;i++)WM(e[i],n)}function LL(t,n,e){WM(Ws(n,t),e)}function WM(t,n){bp(t)&&bE(t,n)}function bE(t,n){const i=t[Yt],r=t[_n],o=t[fc];let s=!!(0===n&&16&r);if(s||=!!(64&r&&0===n),s||=!!(1024&r),s||=!(!o?.dirty||!te(o)),o&&(o.dirty=!1),t[_n]&=-9217,s)FL(i,t,i.template,t[or]);else if(8192&r){GM(t,1);const a=i.components;null!==a&&$M(t,a,1)}}function $M(t,n,e){for(let i=0;i<n.length;i++)LL(t,n[i],e)}function Y_(t){for(t[Ra].changeDetectionScheduler?.notify();t;){t[_n]|=64;const n=Hl(t);if(dp(t)&&!n)return t;t=n}return null}class Z_{get rootNodes(){const n=this._lView,e=n[Yt];return $_(e,n,e.firstChild,[])}constructor(n,e,i=!0){this._lView=n,this._cdRefInjectingView=e,this.notifyErrorHandler=i,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[or]}set context(n){this._lView[or]=n}get destroyed(){return!(256&~this._lView[_n])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[Wr];if(Sr(n)){const e=n[8],i=e?e.indexOf(this):-1;i>-1&&(qh(n,i),Nl(e,i))}this._attachedToViewContainer=!1}Fd(this._lView[Yt],this._lView)}onDestroy(n){qo(this._lView,n)}markForCheck(){Y_(this._cdRefInjectingView||this._lView)}detach(){this._lView[_n]&=-129}reattach(){vp(this._lView),this._lView[_n]|=128}detectChanges(){this._lView[_n]|=1024,S1(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new mt(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,p1(this._lView[Yt],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new mt(902,!1);this._appRef=n,vp(this._lView)}}let xu=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=zL}return t})();const BL=xu,UL=class extends BL{constructor(n,e,i){super(),this._declarationLView=n,this._declarationTContainer=e,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(n,e){return this.createEmbeddedViewImpl(n,e)}createEmbeddedViewImpl(n,e,i){const r=G_(this._declarationLView,this._declarationTContainer,n,{embeddedViewInjector:e,dehydratedView:i});return new Z_(r)}};function zL(){return M1(zi(),_t())}function M1(t,n){return 4&t.type?new UL(n,t,Td(t,n)):null}let QM=()=>null;function ng(t,n){return QM(t,n)}class P1{}class u6{}class JM{}class h6{resolveComponentFactory(n){throw function d6(t){const n=Error(`No component factory found for ${Ti(t)}.`);return n.ngComponent=t,n}(n)}}let F1=(()=>{class t{static#e=this.NULL=new h6}return t})();class EE{}let Jh=(()=>{class t{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function f6(){const t=_t(),e=Ws(zi().index,t);return(eo(e)?e:t)[Rn]}()}return t})(),p6=(()=>{class t{static#e=this.\u0275prov=nn({token:t,providedIn:"root",factory:()=>null})}return t})();const IE={},t3=new Set;function Ic(t){t3.has(t)||(t3.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}function n3(...t){}class Pn{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new ei(!1),this.onMicrotaskEmpty=new ei(!1),this.onStable=new ei(!1),this.onError=new ei(!1),typeof Zone>"u")throw new mt(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&e,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function g6(){const t="function"==typeof li.requestAnimationFrame;let n=li[t?"requestAnimationFrame":"setTimeout"],e=li[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&n&&e){const i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i);const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function b6(t){const n=()=>{!function _6(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(li,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,SE(t),t.isCheckStableRunning=!0,TE(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),SE(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,i,r,o,s,a)=>{if(function v6(t){return!(!Array.isArray(t)||1!==t.length)&&!0===t[0].data?.__ignore_ng_zone__}(a))return e.invokeTask(r,o,s,a);try{return i3(t),e.invokeTask(r,o,s,a)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||t.shouldCoalesceRunChangeDetection)&&n(),r3(t)}},onInvoke:(e,i,r,o,s,a,c)=>{try{return i3(t),e.invoke(r,o,s,a,c)}finally{t.shouldCoalesceRunChangeDetection&&n(),r3(t)}},onHasTask:(e,i,r,o)=>{e.hasTask(r,o),i===r&&("microTask"==o.change?(t._hasPendingMicrotasks=o.microTask,SE(t),TE(t)):"macroTask"==o.change&&(t.hasPendingMacrotasks=o.macroTask))},onHandleError:(e,i,r,o)=>(e.handleError(r,o),t.runOutsideAngular(()=>t.onError.emit(o)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Pn.isInAngularZone())throw new mt(909,!1)}static assertNotInAngularZone(){if(Pn.isInAngularZone())throw new mt(909,!1)}run(n,e,i){return this._inner.run(n,e,i)}runTask(n,e,i,r){const o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+r,n,m6,n3,n3);try{return o.runTask(s,e,i)}finally{o.cancelTask(s)}}runGuarded(n,e,i){return this._inner.runGuarded(n,e,i)}runOutsideAngular(n){return this._outer.run(n)}}const m6={};function TE(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function SE(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function i3(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function r3(t){t._nesting--,TE(t)}class o3{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new ei,this.onMicrotaskEmpty=new ei,this.onStable=new ei,this.onError=new ei}run(n,e,i){return n.apply(e,i)}runGuarded(n,e,i){return n.apply(e,i)}runOutsideAngular(n){return n()}runTask(n,e,i,r){return n.apply(e,i)}}let J_=(()=>{class t{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){const e=[...this.internalCallbacks];this.internalCallbacks.length=0;for(const i of e)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}static#e=this.\u0275prov=nn({token:t,providedIn:"root",factory:()=>new t})}return t})();function R1(t,n,e){let i=e?t.styles:null,r=e?t.classes:null,o=0;if(null!==n)for(let s=0;s<n.length;s++){const a=n[s];"number"==typeof a?o=a:1==o?r=cc(r,a):2==o&&(i=cc(i,a+": "+n[++s]+";"))}e?t.styles=i:t.stylesWithoutHost=i,e?t.classes=r:t.classesWithoutHost=r}class d3 extends F1{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const e=Qn(n);return new n0(e,this.ngModule)}}function h3(t){const n=[];for(const e in t){if(!t.hasOwnProperty(e))continue;const i=t[e];void 0!==i&&n.push({propName:Array.isArray(i)?i[0]:i,templateName:e})}return n}class L1{constructor(n,e){this.injector=n,this.parentInjector=e}get(n,e,i){i=ph(i);const r=this.injector.get(n,IE,i);return r!==IE||e===IE?r:this.parentInjector.get(n,e,i)}}class n0 extends JM{get inputs(){const n=this.componentDef,e=n.inputTransforms,i=h3(n.inputs);if(null!==e)for(const r of i)e.hasOwnProperty(r.propName)&&(r.transform=e[r.propName]);return i}get outputs(){return h3(this.componentDef.outputs)}constructor(n,e){super(),this.componentDef=n,this.ngModule=e,this.componentType=n.type,this.selector=function cx(t){return t.map(lx).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!e}create(n,e,i,r){const o=O(null);try{let s=(r=r||this.ngModule)instanceof ls?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const a=s?new L1(n,s):n,c=a.get(EE,null);if(null===c)throw new mt(407,!1);const u=a.get(p6,null),C={rendererFactory:c,sanitizer:u,inlineEffectRunner:null,afterRenderEventManager:a.get(J_,null),changeDetectionScheduler:a.get(P1,null)},x=c.createRenderer(null,this.componentDef),M=this.componentDef.selectors[0][0]||"div",U=i?function rL(t,n,e,i){const o=i.get(w_,!1)||e===ks.ShadowDom,s=t.selectRootElement(n,o);return function oL(t){kM(t)}(s),s}(x,i,this.componentDef.encapsulation,a):Pd(x,M,function I6(t){const n=t.toLowerCase();return"svg"===n?Bm:"math"===n?"math":null}(M));let W=512;this.componentDef.signals?W|=4096:this.componentDef.onPush||(W|=16);let K=null;null!==U&&(K=C_(U,a,!0));const $=uE(0,null,null,1,0,null,null,null,null,null,null),ge=si(null,$,null,W,null,null,C,x,a,null,K);let ye,lt;$m(ge);try{const Ee=this.componentDef;let Be,ft=null;Ee.findHostDirectiveDefs?(Be=[],ft=new Map,Ee.findHostDirectiveDefs(Ee,Be,ft),Be.push(Ee)):Be=[Ee];const rt=function S6(t,n){const e=t[Yt],i=Wn;return t[i]=n,ai(e,i,2,"#host",null)}(ge,U),ht=function M6(t,n,e,i,r,o,s){const a=r[Yt];!function D6(t,n,e,i){for(const r of t)n.mergedAttrs=vi(n.mergedAttrs,r.hostAttrs);null!==n.mergedAttrs&&(R1(n,n.mergedAttrs,!0),null!==e&&It(i,e,n))}(i,t,n,s);let c=null;null!==n&&(c=C_(n,r[Bi]));const u=o.rendererFactory.createRenderer(n,e);let f=16;e.signals?f=4096:e.onPush&&(f=64);const b=si(r,j_(e),null,f,r[t.index],t,o,u,null,null,c);return a.firstCreatePass&&hE(a,t,i.length-1),I1(r,b),r[t.index]=b}(rt,U,Ee,Be,ge,C,x);lt=Zn($,Wn),U&&function O6(t,n,e,i){if(i)ut(t,e,["ng-version","17.3.12"]);else{const{attrs:r,classes:o}=function ux(t){const n=[],e=[];let i=1,r=2;for(;i<t.length;){let o=t[i];if("string"==typeof o)2===r?""!==o&&n.push(o,t[++i]):8===r&&e.push(o);else{if(!Fa(r))break;r=o}i++}return{attrs:n,classes:e}}(n.selectors[0]);r&&ut(t,e,r),o&&o.length>0&&$e(t,e,o.join(" "))}}(x,Ee,U,i),void 0!==e&&function A6(t,n,e){const i=t.projection=[];for(let r=0;r<n.length;r++){const o=e[r];i.push(null!=o?Array.from(o):null)}}(lt,this.ngContentSelectors,e),ye=function k6(t,n,e,i,r,o){const s=zi(),a=r[Yt],c=us(s,r);PM(a,r,s,e,null,i);for(let f=0;f<e.length;f++)Qo(gl(r,a,s.directiveStart+f,s),r);FM(a,r,s),c&&Qo(c,r);const u=gl(r,a,s.directiveStart+s.componentOffset,s);if(t[or]=r[or]=u,null!==o)for(const f of o)f(u,n);return Dr(a,s,r),u}(ht,Ee,Be,ft,ge,[P6]),mE($,ge,null)}finally{qm()}return new T6(this.componentType,ye,Td(lt,ge),ge,lt)}finally{O(o)}}}class T6 extends u6{constructor(n,e,i,r,o){super(),this.location=i,this._rootLView=r,this._tNode=o,this.previousInputValues=null,this.instance=e,this.hostView=this.changeDetectorRef=new Z_(r,void 0,!1),this.componentType=n}setInput(n,e){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[n])){if(this.previousInputValues??=new Map,this.previousInputValues.has(n)&&Object.is(this.previousInputValues.get(n),e))return;const o=this._rootLView;gE(o[Yt],o,r,n,e),this.previousInputValues.set(n,e),Y_(Ws(this._tNode.index,o))}}get injector(){return new lo(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}function P6(){const t=zi();Vl(_t()[Yt],t)}let xa=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=F6}return t})();function F6(){return g3(zi(),_t())}const N6=xa,f3=class extends N6{constructor(n,e,i){super(),this._lContainer=n,this._hostTNode=e,this._hostLView=i}get element(){return Td(this._hostTNode,this._hostLView)}get injector(){return new lo(this._hostTNode,this._hostLView)}get parentInjector(){const n=Nh(this._hostTNode,this._hostLView);if(Qm(n)){const e=mu(n,this._hostLView),i=Zs(n);return new lo(e[Yt].data[i+8],e)}return new lo(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const e=p3(this._lContainer);return null!==e&&e[n]||null}get length(){return this._lContainer.length-Rr}createEmbeddedView(n,e,i){let r,o;"number"==typeof i?r=i:null!=i&&(r=i.index,o=i.injector);const s=ng(this._lContainer,n.ssrId),a=n.createEmbeddedViewImpl(e||{},o,s);return this.insertImpl(a,r,tg(this._hostTNode,s)),a}createComponent(n,e,i,r,o){const s=n&&!function Ih(t){return"function"==typeof t}(n);let a;if(s)a=e;else{const M=e||{};a=M.index,i=M.injector,r=M.projectableNodes,o=M.environmentInjector||M.ngModuleRef}const c=s?n:new n0(Qn(n)),u=i||this.parentInjector;if(!o&&null==c.ngModule){const U=(s?u:this.parentInjector).get(ls,null);U&&(o=U)}const f=Qn(c.componentType??{}),b=ng(this._lContainer,f?.id??null),x=c.create(u,r,b?.firstChild??null,o);return this.insertImpl(x.hostView,a,tg(this._hostTNode,b)),x}insert(n,e){return this.insertImpl(n,e,!0)}insertImpl(n,e,i){const r=n._lView;if(function Mx(t){return Sr(t[Wr])}(r)){const a=this.indexOf(n);if(-1!==a)this.detach(a);else{const c=r[Wr],u=new f3(c,c[Yo],c[Wr]);u.detach(u.indexOf(n))}}const o=this._adjustIndex(e),s=this._lContainer;return W_(s,r,o,i),n.attachToViewContainerRef(),Rb(OE(s),o,n),n}move(n,e){return this.insert(n,e)}indexOf(n){const e=p3(this._lContainer);return null!==e?e.indexOf(n):-1}remove(n){const e=this._adjustIndex(n,-1),i=qh(this._lContainer,e);i&&(Nl(OE(this._lContainer),e),Fd(i[Yt],i))}detach(n){const e=this._adjustIndex(n,-1),i=qh(this._lContainer,e);return i&&null!=Nl(OE(this._lContainer),e)?new Z_(i):null}_adjustIndex(n,e=0){return n??this.length+e}};function p3(t){return t[8]}function OE(t){return t[8]||(t[8]=[])}function g3(t,n){let e;const i=n[t.index];return Sr(i)?e=i:(e=NM(i,n,null,t),n[t.index]=e,I1(n,e)),m3(e,n,t,i),new f3(e,t,n)}let m3=function b3(t,n,e,i){if(t[Zo])return;let r;r=8&e.type?Ui(i):function R6(t,n){const e=t[Rn],i=e.createComment(""),r=us(n,t);return yu(e,Jp(e,r),i,function cE(t,n){return t.nextSibling(n)}(e,r),!1),i}(n,e),t[Zo]=r},AE=()=>!1;class PE{constructor(n){this.queryList=n,this.matches=null}clone(){return new PE(this.queryList)}setDirty(){this.queryList.setDirty()}}class FE{constructor(n=[]){this.queries=n}createEmbeddedView(n){const e=n.queries;if(null!==e){const i=null!==n.contentQueries?n.contentQueries[0]:e.length,r=[];for(let o=0;o<i;o++){const s=e.getByIndex(o);r.push(this.queries[s.indexInDeclarationView].clone())}return new FE(r)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}finishViewCreation(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let e=0;e<this.queries.length;e++)null!==UE(n,e).matches&&this.queries[e].setDirty()}}class v3{constructor(n,e,i=null){this.flags=e,this.read=i,this.predicate="string"==typeof n?function G6(t){return t.split(",").map(n=>n.trim())}(n):n}}class NE{constructor(n=[]){this.queries=n}elementStart(n,e){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(n,e)}elementEnd(n){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(n)}embeddedTView(n){let e=null;for(let i=0;i<this.length;i++){const r=null!==e?e.length:0,o=this.getByIndex(i).embeddedTView(n,r);o&&(o.indexInDeclarationView=i,null!==e?e.push(o):e=[o])}return null!==e?new NE(e):null}template(n,e){for(let i=0;i<this.queries.length;i++)this.queries[i].template(n,e)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class RE{constructor(n,e=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(n,e){this.isApplyingToNode(e)&&this.matchTNode(n,e)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,e){this.elementStart(n,e)}embeddedTView(n,e){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,e),new RE(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1&~this.metadata.flags){const e=this._declarationNodeIndex;let i=n.parent;for(;null!==i&&8&i.type&&i.index!==e;)i=i.parent;return e===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(n,e){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const o=i[r];this.matchTNodeWithReadOption(n,e,z6(e,o)),this.matchTNodeWithReadOption(n,e,Rh(e,n,o,!1,!1))}else i===xu?4&e.type&&this.matchTNodeWithReadOption(n,e,-1):this.matchTNodeWithReadOption(n,e,Rh(e,n,i,!1,!1))}matchTNodeWithReadOption(n,e,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===fr||r===xa||r===xu&&4&e.type)this.addMatch(e.index,-2);else{const o=Rh(e,n,r,!1,!1);null!==o&&this.addMatch(e.index,o)}else this.addMatch(e.index,i)}}addMatch(n,e){null===this.matches?this.matches=[n,e]:this.matches.push(n,e)}}function z6(t,n){const e=t.localNames;if(null!==e)for(let i=0;i<e.length;i+=2)if(e[i]===n)return e[i+1];return null}function V6(t,n,e,i){return-1===e?function H6(t,n){return 11&t.type?Td(t,n):4&t.type?M1(t,n):null}(n,t):-2===e?function j6(t,n,e){return e===fr?Td(n,t):e===xu?M1(n,t):e===xa?g3(n,t):void 0}(t,n,i):gl(t,t[Yt],e,n)}function y3(t,n,e,i){const r=n[zl].queries[i];if(null===r.matches){const o=t.data,s=e.matches,a=[];for(let c=0;null!==s&&c<s.length;c+=2){const u=s[c];a.push(u<0?null:V6(n,o[u],s[c+1],e.metadata.read))}r.matches=a}return r.matches}function LE(t,n,e,i){const r=t.queries.getByIndex(e),o=r.matches;if(null!==o){const s=y3(t,n,r,e);for(let a=0;a<o.length;a+=2){const c=o[a];if(c>0)i.push(s[a/2]);else{const u=o[a+1],f=n[-c];for(let b=Rr;b<f.length;b++){const C=f[b];C[ld]===C[Wr]&&LE(C[Yt],C,u,i)}if(null!==f[dd]){const b=f[dd];for(let C=0;C<b.length;C++){const x=b[C];LE(x[Yt],x,u,i)}}}}}return i}function x3(t,n,e){const i=fi();return i.firstCreatePass&&(function E3(t,n,e){null===t.queries&&(t.queries=new NE),t.queries.track(new RE(n,e))}(i,new v3(t,n,e),-1),!(2&~n)&&(i.staticViewQueries=!0)),function C3(t,n,e){const i=new l_(!(4&~e));return function lL(t,n,e,i){const r=LM(n);r.push(e),t.firstCreatePass&&BM(t).push(i,r.length-1)}(t,n,i,i.destroy),(n[zl]??=new FE).queries.push(new PE(i))-1}(i,_t(),n)}function UE(t,n){return t.queries.getByIndex(n)}function I3(t,n){const e=t[Yt],i=UE(e,n);return i.crossesNgTemplate?LE(e,t,n,[]):y3(e,t,i,n)}function M3(t){return function T3(t){return"function"==typeof t&&void 0!==t[P]}(t)&&"function"==typeof t.set}function tr(t){let n=function U3(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),e=!0;const i=[t];for(;n;){let r;if(Ua(t))r=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new mt(903,!1);r=n.\u0275dir}if(r){if(e){i.push(r);const s=t;s.inputs=U1(t.inputs),s.inputTransforms=U1(t.inputTransforms),s.declaredInputs=U1(t.declaredInputs),s.outputs=U1(t.outputs);const a=r.hostBindings;a&&sB(t,a);const c=r.viewQuery,u=r.contentQueries;if(c&&rB(t,c),u&&oB(t,u),nB(t,r),Ts(t.outputs,r.outputs),Ua(r)&&r.data.animation){const f=t.data;f.animation=(f.animation||[]).concat(r.data.animation)}}const o=r.features;if(o)for(let s=0;s<o.length;s++){const a=o[s];a&&a.ngInherit&&a(t),a===tr&&(e=!1)}}n=Object.getPrototypeOf(n)}!function iB(t){let n=0,e=null;for(let i=t.length-1;i>=0;i--){const r=t[i];r.hostVars=n+=r.hostVars,r.hostAttrs=vi(r.hostAttrs,e=vi(e,r.hostAttrs))}}(i)}function nB(t,n){for(const e in n.inputs){if(!n.inputs.hasOwnProperty(e)||t.inputs.hasOwnProperty(e))continue;const i=n.inputs[e];if(void 0!==i&&(t.inputs[e]=i,t.declaredInputs[e]=n.declaredInputs[e],null!==n.inputTransforms)){const r=Array.isArray(i)?i[0]:i;if(!n.inputTransforms.hasOwnProperty(r))continue;t.inputTransforms??={},t.inputTransforms[r]=n.inputTransforms[r]}}}function U1(t){return t===Kr?{}:t===wi?[]:t}function rB(t,n){const e=t.viewQuery;t.viewQuery=e?(i,r)=>{n(i,r),e(i,r)}:n}function oB(t,n){const e=t.contentQueries;t.contentQueries=e?(i,r,o)=>{n(i,r,o),e(i,r,o)}:n}function sB(t,n){const e=t.hostBindings;t.hostBindings=e?(i,r)=>{n(i,r),e(i,r)}:n}function j3(t){const n=t.inputConfig,e={};for(const i in n)if(n.hasOwnProperty(i)){const r=n[i];Array.isArray(r)&&r[3]&&(e[i]=r[3])}t.inputTransforms=e}class nf{}class hB{}class HE extends nf{constructor(n,e,i){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new d3(this);const r=function so(t,n){const e=t[_m]||null;if(!e&&!0===n)throw new Error(`Type ${Ti(t)} does not have '\u0275mod' property.`);return e}(n);this._bootstrapComponents=function ps(t){return t instanceof Function?t():t}(r.bootstrap),this._r3Injector=wv(n,e,[{provide:nf,useValue:this},{provide:F1,useValue:this.componentFactoryResolver},...i],Ti(n),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(n)}get injector(){return this._r3Injector}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class VE extends hB{constructor(n){super(),this.moduleType=n}create(n){return new HE(this.moduleType,n,[])}}class G3 extends nf{constructor(n){super(),this.componentFactoryResolver=new d3(this),this.instance=null;const e=new rd([...n.providers,{provide:nf,useValue:this},{provide:F1,useValue:this.componentFactoryResolver}],n.parent||su(),n.debugName,new Set(["environment"]));this.injector=e,n.runEnvironmentInitializers&&e.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(n){this.injector.onDestroy(n)}}let o0=(()=>{class t{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new ac(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const e=this.taskId++;return this.pendingTasks.add(e),e}remove(e){this.pendingTasks.delete(e),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function H1(t){return!!jE(t)&&(Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t)}function jE(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Tc(t,n,e){return t[n]=e}function s0(t,n){return t[n]}function ho(t,n,e){return!Object.is(t[n],e)&&(t[n]=e,!0)}function rf(t,n,e,i){const r=ho(t,n,e);return ho(t,n+1,i)||r}function V1(t,n,e,i,r){const o=rf(t,n,e,i);return ho(t,n+2,r)||o}function _l(t,n,e,i,r,o){const s=rf(t,n,e,i);return rf(t,n+2,r,o)||s}function q(t,n,e,i,r,o,s,a){const c=_t(),u=fi(),f=t+Wn,b=u.firstCreatePass?function yB(t,n,e,i,r,o,s,a,c){const u=n.consts,f=ai(n,t,4,s||null,ul(u,a));dE(n,e,f,ul(u,c)),Vl(n,f);const b=f.tView=uE(2,f,i,r,o,n.directiveRegistry,n.pipeRegistry,null,n.schemas,u,null);return null!==n.queries&&(n.queries.template(n,f),b.queries=n.queries.embeddedTView(f)),f}(f,u,c,n,e,i,r,o,s):u.data[f];Ha(b,!1);const C=$3(u,c,b,t);fu()&&eg(u,c,C,b),Qo(C,c);const x=NM(C,c,C,b);return c[f]=x,I1(c,x),function _3(t,n,e){return AE(t,n,e)}(x,b,c),uu(b)&&Xs(u,c,b),null!=s&&Ka(c,b,a),q}let $3=function Y3(t,n,e,i){return _a(!0),n[Rn].createComment("")};function en(t,n,e,i){const r=_t();return ho(r,Va(),n)&&(fi(),Ec(er(),r,t,n,e,i)),en}function dg(t,n,e,i){return ho(t,Va(),e)?n+Hn(e)+i:nt}function JE(t,n,e,i,r,o){const s=_t(),a=dg(s,n,e,i);return a!==nt&&Ec(er(),s,t,a,r,o),JE}function Z1(t,n){return t<<17|n<<2}function Ld(t){return t>>17&32767}function e2(t){return 2|t}function sf(t){return(131068&t)>>2}function t2(t,n){return-131069&t|n<<2}function n2(t){return 1|t}function wD(t,n,e,i){const r=t[e+1],o=null===n;let s=i?Ld(r):sf(r),a=!1;for(;0!==s&&(!1===a||o);){const u=t[s+1];s8(t[s],n)&&(a=!0,t[s+1]=i?n2(u):e2(u)),s=i?Ld(u):sf(u)}a&&(t[e+1]=i?e2(r):n2(r))}function s8(t,n){return null===t||null==n||(Array.isArray(t)?t[1]:t)===n||!(!Array.isArray(t)||"string"!=typeof n)&&td(t,n)>=0}const No={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function ED(t){return t.substring(No.key,No.keyEnd)}function a8(t){return t.substring(No.value,No.valueEnd)}function ID(t,n){const e=No.textEnd;return e===n?-1:(n=No.keyEnd=function u8(t,n,e){for(;n<e&&t.charCodeAt(n)>32;)n++;return n}(t,No.key=n,e),vg(t,n,e))}function TD(t,n){const e=No.textEnd;let i=No.key=vg(t,n,e);return e===i?-1:(i=No.keyEnd=function d8(t,n,e){let i;for(;n<e&&(45===(i=t.charCodeAt(n))||95===i||(-33&i)>=65&&(-33&i)<=90||i>=48&&i<=57);)n++;return n}(t,i,e),i=MD(t,i,e),i=No.value=vg(t,i,e),i=No.valueEnd=function h8(t,n,e){let i=-1,r=-1,o=-1,s=n,a=s;for(;s<e;){const c=t.charCodeAt(s++);if(59===c)return a;34===c||39===c?a=s=DD(t,c,s,e):n===s-4&&85===o&&82===r&&76===i&&40===c?a=s=DD(t,41,s,e):c>32&&(a=s),o=r,r=i,i=-33&c}return a}(t,i,e),MD(t,i,e))}function SD(t){No.key=0,No.keyEnd=0,No.value=0,No.valueEnd=0,No.textEnd=t.length}function vg(t,n,e){for(;n<e&&t.charCodeAt(n)<=32;)n++;return n}function MD(t,n,e,i){return(n=vg(t,n,e))<e&&n++,n}function DD(t,n,e,i){let r=-1,o=e;for(;o<i;){const s=t.charCodeAt(o++);if(s==n&&92!==r)return o;r=92==s&&92===r?0:s}throw new Error}function m(t,n,e){const i=_t();return ho(i,Va(),n)&&Ca(fi(),er(),i,t,n,i[Rn],e,!1),m}function i2(t,n,e,i,r){const s=r?"class":"style";gE(t,e,n.inputs[s],s,i)}function je(t,n,e){return Wl(t,n,e,!1),je}function d0(t,n){return Wl(t,n,null,!0),d0}function ms(t){$l(AD,f8,t,!1)}function f8(t,n){for(let e=function c8(t){return SD(t),TD(t,vg(t,0,No.textEnd))}(n);e>=0;e=TD(n,e))AD(t,ED(n),a8(n))}function yg(t){$l(v8,Sc,t,!0)}function Sc(t,n){for(let e=function l8(t){return SD(t),ID(t,vg(t,0,No.textEnd))}(n);e>=0;e=ID(n,e))Wo(t,ED(n),!0)}function Wl(t,n,e,i){const r=_t(),o=fi(),s=fl(2);o.firstUpdatePass&&OD(o,t,s,i),n!==nt&&ho(r,s,n)&&PD(o,o.data[mr()],r,r[Rn],t,r[s+1]=function C8(t,n){return null==t||""===t||("string"==typeof n?t+=n:"object"==typeof t&&(t=Ti(qs(t)))),t}(n,e),i,s)}function $l(t,n,e,i){const r=fi(),o=fl(2);r.firstUpdatePass&&OD(r,null,o,i);const s=_t();if(e!==nt&&ho(s,o,e)){const a=r.data[mr()];if(ND(a,i)&&!kD(r,o)){let c=i?a.classesWithoutHost:a.stylesWithoutHost;null!==c&&(e=cc(c,e||"")),i2(r,a,s,e,i)}else!function y8(t,n,e,i,r,o,s,a){r===nt&&(r=wi);let c=0,u=0,f=0<r.length?r[0]:null,b=0<o.length?o[0]:null;for(;null!==f||null!==b;){const C=c<r.length?r[c+1]:void 0,x=u<o.length?o[u+1]:void 0;let U,M=null;f===b?(c+=2,u+=2,C!==x&&(M=b,U=x)):null===b||null!==f&&f<b?(c+=2,M=f):(u+=2,M=b,U=x),null!==M&&PD(t,n,e,i,M,U,s,a),f=c<r.length?r[c]:null,b=u<o.length?o[u]:null}}(r,a,s,s[Rn],s[o+1],s[o+1]=function b8(t,n,e){if(null==e||""===e)return wi;const i=[],r=qs(e);if(Array.isArray(r))for(let o=0;o<r.length;o++)t(i,r[o],!0);else if("object"==typeof r)for(const o in r)r.hasOwnProperty(o)&&t(i,o,r[o]);else"string"==typeof r&&n(i,r);return i}(t,n,e),i,o)}}function kD(t,n){return n>=t.expandoStartIndex}function OD(t,n,e,i){const r=t.data;if(null===r[e+1]){const o=r[mr()],s=kD(t,e);ND(o,i)&&null===n&&!s&&(n=!1),n=function p8(t,n,e,i){const r=function yd(t){const n=Fn.lFrame.currentDirectiveIndex;return-1===n?null:t[n]}(t);let o=i?n.residualClasses:n.residualStyles;if(null===r)0===(i?n.classBindings:n.styleBindings)&&(e=h0(e=r2(null,t,n,e,i),n.attrs,i),o=null);else{const s=n.directiveStylingLast;if(-1===s||t[s]!==r)if(e=r2(r,t,n,e,i),null===o){let c=function g8(t,n,e){const i=e?n.classBindings:n.styleBindings;if(0!==sf(i))return t[Ld(i)]}(t,n,i);void 0!==c&&Array.isArray(c)&&(c=r2(null,t,n,c[1],i),c=h0(c,n.attrs,i),function m8(t,n,e,i){t[Ld(e?n.classBindings:n.styleBindings)]=i}(t,n,i,c))}else o=function _8(t,n,e){let i;const r=n.directiveEnd;for(let o=1+n.directiveStylingLast;o<r;o++)i=h0(i,t[o].hostAttrs,e);return h0(i,n.attrs,e)}(t,n,i)}return void 0!==o&&(i?n.residualClasses=o:n.residualStyles=o),e}(r,o,n,i),function r8(t,n,e,i,r,o){let s=o?n.classBindings:n.styleBindings,a=Ld(s),c=sf(s);t[i]=e;let f,u=!1;if(Array.isArray(e)?(f=e[1],(null===f||td(e,f)>0)&&(u=!0)):f=e,r)if(0!==c){const C=Ld(t[a+1]);t[i+1]=Z1(C,a),0!==C&&(t[C+1]=t2(t[C+1],i)),t[a+1]=function n8(t,n){return 131071&t|n<<17}(t[a+1],i)}else t[i+1]=Z1(a,0),0!==a&&(t[a+1]=t2(t[a+1],i)),a=i;else t[i+1]=Z1(c,0),0===a?a=i:t[c+1]=t2(t[c+1],i),c=i;u&&(t[i+1]=e2(t[i+1])),wD(t,f,i,!0),wD(t,f,i,!1),function o8(t,n,e,i,r){const o=r?t.residualClasses:t.residualStyles;null!=o&&"string"==typeof n&&td(o,n)>=0&&(e[i+1]=n2(e[i+1]))}(n,f,t,i,o),s=Z1(a,c),o?n.classBindings=s:n.styleBindings=s}(r,o,n,e,s,i)}}function r2(t,n,e,i,r){let o=null;const s=e.directiveEnd;let a=e.directiveStylingLast;for(-1===a?a=e.directiveStart:a++;a<s&&(o=n[a],i=h0(i,o.hostAttrs,r),o!==t);)a++;return null!==t&&(e.directiveStylingLast=a),i}function h0(t,n,e){const i=e?1:2;let r=-1;if(null!==n)for(let o=0;o<n.length;o++){const s=n[o];"number"==typeof s?r=s:r===i&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),Wo(t,s,!!e||n[++o]))}return void 0===t?null:t}function AD(t,n,e){Wo(t,n,qs(e))}function v8(t,n,e){const i=String(n);""!==i&&!i.includes(" ")&&Wo(t,i,e)}function PD(t,n,e,i,r,o,s,a){if(!(3&n.type))return;const c=t.data,u=c[a+1],f=function i8(t){return!(1&~t)}(u)?FD(c,n,e,r,sf(u),s):void 0;q1(f)||(q1(o)||function t8(t){return!(2&~t)}(u)&&(o=FD(c,null,e,r,a,s)),function xe(t,n,e,i,r){if(n)r?t.addClass(e,i):t.removeClass(e,i);else{let o=-1===i.indexOf("-")?void 0:Yr.DashCase;null==r?t.removeStyle(e,i,o):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=Yr.Important),t.setStyle(e,i,r,o))}}(i,s,du(mr(),e),r,o))}function FD(t,n,e,i,r,o){const s=null===n;let a;for(;r>0;){const c=t[r],u=Array.isArray(c),f=u?c[1]:c,b=null===f;let C=e[r+1];C===nt&&(C=b?wi:void 0);let x=b?Im(C,i):f===i?C:void 0;if(u&&!q1(x)&&(x=Im(c,i)),q1(x)&&(a=x,s))return a;const M=t[r+1];r=s?Ld(M):sf(M)}if(null!==n){let c=o?n.residualClasses:n.residualStyles;null!=c&&(a=Im(c,i))}return a}function q1(t){return void 0!==t}function ND(t,n){return!!(t.flags&(n?8:16))}function UD(t,n,e){Ic("NgControlFlow");const i=_t(),r=Va(),o=function a2(t,n){return t[n]}(i,Wn+t);if(ho(i,r,n)){const a=O(null);try{if(function _E(t,n){const e=qh(t,n);return void 0!==e&&Fd(e[Yt],e),e}(o,0),-1!==n){const c=function l2(t,n){return Zn(t,n)}(i[Yt],Wn+n),u=ng(o,c.tView.ssrId);W_(o,G_(i,c,e,{dehydratedView:u}),0,tg(c,u))}}finally{O(a)}}else{const a=function zM(t,n){const e=Rr+n;if(e<t.length)return t[e]}(o,0);void 0!==a&&(a[or]=e)}}function p(t,n,e,i){const r=_t(),o=fi(),s=Wn+t,a=r[Rn],c=o.firstCreatePass?function j8(t,n,e,i,r,o){const s=n.consts,c=ai(n,t,2,i,ul(s,r));return dE(n,e,c,ul(s,o)),null!==c.attrs&&R1(c,c.attrs,!1),null!==c.mergedAttrs&&R1(c,c.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,c),c}(s,o,r,n,e,i):o.data[s],u=zD(o,r,c,a,n,t);r[s]=u;const f=uu(c);return Ha(c,!0),It(a,u,c),!function a0(t){return!(32&~t.flags)}(c)&&fu()&&eg(o,r,u,c),0===function Hm(){return Fn.lFrame.elementDepthCount}()&&Qo(u,r),function nv(){Fn.lFrame.elementDepthCount++}(),f&&(Xs(o,r,c),Dr(o,c,r)),null!==i&&Ka(r,c),p}function g(){let t=zi();Xo()?ma():(t=t.parent,Ha(t,!1));const n=t;(function Ox(t){return Fn.skipHydrationRootTNode===t})(n)&&function jm(){Fn.skipHydrationRootTNode=null}(),function Vm(){Fn.lFrame.elementDepthCount--}();const e=fi();return e.firstCreatePass&&(Vl(e,t),up(t)&&e.queries.elementEnd(t)),null!=n.classesWithoutHost&&function Lx(t){return!!(8&t.flags)}(n)&&i2(e,n,_t(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function dv(t){return!!(16&t.flags)}(n)&&i2(e,n,_t(),n.stylesWithoutHost,!1),g}function Ge(t,n,e,i){return p(t,n,e,i),g(),Ge}let zD=(t,n,e,i,r,o)=>(_a(!0),Pd(i,r,function pl(){return Fn.lFrame.currentNamespace}()));function Ue(t,n,e){const i=_t(),r=fi(),o=t+Wn,s=r.firstCreatePass?function $8(t,n,e,i,r){const o=n.consts,s=ul(o,i),a=ai(n,t,8,"ng-container",s);return null!==s&&R1(a,s,!0),dE(n,e,a,ul(o,r)),null!==n.queries&&n.queries.elementStart(n,a),a}(o,r,i,n,e):r.data[o];Ha(s,!0);const a=HD(r,i,s,t);return i[o]=a,fu()&&eg(r,i,a,s),Qo(a,i),uu(s)&&(Xs(r,i,s),Dr(r,s,i)),null!=e&&Ka(i,s),Ue}function ze(){let t=zi();const n=fi();return Xo()?ma():(t=t.parent,Ha(t,!1)),n.firstCreatePass&&(Vl(n,t),up(t)&&n.queries.elementEnd(t)),ze}function ii(t,n,e){return Ue(t,n,e),ze(),ii}let HD=(t,n,e,i)=>(_a(!0),U_(n[Rn],""));function Le(){return _t()}const af=void 0;var X8=["en",[["a","p"],["AM","PM"],af],[["AM","PM"],af,af],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],af,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],af,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",af,"{1} 'at' {0}",af],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function q8(t){const e=Math.floor(Math.abs(t)),i=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===i?1:5}];let Cg={};function Ks(t){const n=function K8(t){return t.toLowerCase().replace(/_/g,"-")}(t);let e=WD(n);if(e)return e;const i=n.split("-")[0];if(e=WD(i),e)return e;if("en"===i)return X8;throw new mt(701,!1)}function WD(t){return t in Cg||(Cg[t]=li.ng&&li.ng.common&&li.ng.common.locales&&li.ng.common.locales[t]),Cg[t]}var _r=function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t}(_r||{});const xg="en-US";let $D=xg;function he(t,n,e,i){const r=_t(),o=fi(),s=zi();return d2(o,r,r[Rn],s,t,n,i),he}function d2(t,n,e,i,r,o,s){const a=uu(i),u=t.firstCreatePass&&BM(t),f=n[or],b=LM(n);let C=!0;if(3&i.type||s){const U=us(i,n),W=s?s(U):U,K=b.length,$=s?ye=>s(Ui(ye[i.index])):i.index;let ge=null;if(!s&&a&&(ge=function YU(t,n,e,i){const r=t.cleanup;if(null!=r)for(let o=0;o<r.length-1;o+=2){const s=r[o];if(s===e&&r[o+1]===i){const a=n[sd],c=r[o+2];return a.length>c?a[c]:null}"string"==typeof s&&(o+=2)}return null}(t,n,r,i.index)),null!==ge)(ge.__ngLastListenerFn__||ge).__ngNextListenerFn__=o,ge.__ngLastListenerFn__=o,C=!1;else{o=yk(i,n,f,o,!1);const ye=e.listen(W,r,o);b.push(o,ye),u&&u.push(r,$,K,K+1)}}else o=yk(i,n,f,o,!1);const x=i.outputs;let M;if(C&&null!==x&&(M=x[r])){const U=M.length;if(U)for(let W=0;W<U;W+=2){const lt=n[M[W]][M[W+1]].subscribe(o),Ee=b.length;b.push(o,lt),u&&u.push(r,i.index,Ee,-(Ee+1))}}}function vk(t,n,e,i){const r=O(null);try{return cl(6,n,e),!1!==e(i)}catch(o){return T1(t,o),!1}finally{cl(7,n,e),O(r)}}function yk(t,n,e,i,r){return function o(s){if(s===Function)return i;Y_(t.componentOffset>-1?Ws(t.index,n):n);let c=vk(n,e,i,s),u=o.__ngNextListenerFn__;for(;u;)c=vk(n,e,u,s)&&c,u=u.__ngNextListenerFn__;return r&&!1===c&&s.preventDefault(),c}}function v(t=1){return function av(t){return(Fn.lFrame.contextLView=function Mh(t,n){for(;t>0;)n=n[ad],t--;return n}(t,Fn.lFrame.contextLView))[or]}(t)}function ZU(t,n){let e=null;const i=function ep(t){const n=t.attrs;if(null!=n){const e=n.indexOf(5);if(!(1&e))return n[e+1]}return null}(t);for(let r=0;r<n.length;r++){const o=n[r];if("*"!==o){if(null===i?_h(t,o,!0):Ub(i,o))return r}else e=r}return e}function h2(t){const n=_t()[gr][Yo];if(!n.projection){const i=n.projection=function Xf(t,n){const e=[];for(let i=0;i<t;i++)e.push(n);return e}(t?t.length:1,null),r=i.slice();let o=n.child;for(;null!==o;){const s=t?ZU(o,t):0;null!==s&&(r[s]?r[s].projectionNext=o:i[s]=o,r[s]=o),o=o.next}}}function f2(t,n=0,e){const i=_t(),r=fi(),o=ai(r,Wn+t,16,null,e||null);null===o.projection&&(o.projection=n),ma(),(!i[ao]||Ys())&&32&~o.flags&&function I(t,n,e){G(n[Rn],0,n,e,z_(t,e,n),y1(e.parent||n[Yo],e,n))}(r,i,o)}function Et(t,n,e){return go(t,"",n,"",e),Et}function go(t,n,e,i,r){const o=_t(),s=dg(o,n,e,i);return s!==nt&&Ca(fi(),er(),o,t,s,o[Rn],r,!1),go}function Ln(t,n,e){x3(t,n,e)}function Bn(t){const n=_t(),e=fi(),i=xp();hu(i+1);const r=UE(e,i);if(t.dirty&&function Sh(t){return!(4&~t[_n])}(n)===!(2&~r.metadata.flags)){if(null===r.matches)t.reset([]);else{const o=I3(n,i);t.reset(o,Tv),t.notifyOnChanges()}return!0}return!1}function Un(){return function BE(t,n){return t[zl].queries[n].queryList}(_t(),xp())}function pn(t){return gd(function Ax(){return Fn.lFrame.contextLView}(),Wn+t)}function y(t,n=""){const e=_t(),i=fi(),r=t+Wn,o=i.firstCreatePass?ai(i,r,1,n,null):i.data[r],s=Bk(i,e,o,n,t);e[r]=s,fu()&&eg(i,e,s,o),Ha(o,!1)}let Bk=(t,n,e,i,r)=>(_a(!0),function B_(t,n){return t.createText(n)}(n[Rn],i));function Xe(t){return Si("",t,""),Xe}function Si(t,n,e){const i=_t(),r=dg(i,t,n,e);return r!==nt&&Cu(i,mr(),r),Si}function Bd(t,n,e,i,r){const o=_t(),s=function hg(t,n,e,i,r,o){const a=rf(t,hl(),e,r);return fl(2),a?n+Hn(e)+i+Hn(r)+o:nt}(o,t,n,e,i,r);return s!==nt&&Cu(o,mr(),s),Bd}function p2(t,n,e,i,r,o,s,a,c,u,f){const b=_t(),C=function gg(t,n,e,i,r,o,s,a,c,u,f,b){const C=hl();let x=_l(t,C,e,r,s,c);return x=ho(t,C+4,f)||x,fl(5),x?n+Hn(e)+i+Hn(r)+o+Hn(s)+a+Hn(c)+u+Hn(f)+b:nt}(b,t,n,e,i,r,o,s,a,c,u,f);return C!==nt&&Cu(b,mr(),C),p2}function st(t,n,e){M3(n)&&(n=n());const i=_t();return ho(i,Va(),n)&&Ca(fi(),er(),i,t,n,i[Rn],e,!1),st}function it(t,n){const e=M3(t);return e&&t.set(n),e}function at(t,n){const e=_t(),i=fi(),r=zi();return d2(i,e,e[Rn],r,t,n),at}function g2(t,n,e,i,r){if(t=ie(t),Array.isArray(t))for(let o=0;o<t.length;o++)g2(t[o],n,e,i,r);else{const o=fi(),s=_t(),a=zi();let c=Rl(t)?t:ie(t.provide);const u=Gb(t),f=1048575&a.providerIndexes,b=a.directiveStart,C=a.providerIndexes>>20;if(Rl(t)||!t.multi){const x=new no(u,r,Y),M=_2(c,n,r?f:f+C,b);-1===M?(Sp(Tp(a,s),o,c),m2(o,t,n.length),n.push(c),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),e.push(x),s.push(x)):(e[M]=x,s[M]=x)}else{const x=_2(c,n,f+C,b),M=_2(c,n,f,f+C),W=M>=0&&e[M];if(r&&!W||!r&&!(x>=0&&e[x])){Sp(Tp(a,s),o,c);const K=function pz(t,n,e,i,r){const o=new no(t,e,Y);return o.multi=[],o.index=n,o.componentProviders=0,Wk(o,r,i&&!e),o}(r?fz:hz,e.length,r,i,u);!r&&W&&(e[M].providerFactory=K),m2(o,t,n.length,0),n.push(c),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),e.push(K),s.push(K)}else m2(o,t,x>-1?x:M,Wk(e[r?M:x],u,!r&&i));!r&&i&&W&&e[M].componentProviders++}}}function m2(t,n,e,i){const r=Rl(n),o=function yh(t){return!!t.useClass}(n);if(r||o){const c=(o?ie(n.useClass):n).prototype.ngOnDestroy;if(c){const u=t.destroyHooks||(t.destroyHooks=[]);if(!r&&n.multi){const f=u.indexOf(e);-1===f?u.push(e,[i,c]):u[f+1].push(i,c)}else u.push(e,c)}}}function Wk(t,n,e){return e&&t.componentProviders++,t.multi.push(n)-1}function _2(t,n,e,i){for(let r=e;r<i;r++)if(n[r]===t)return r;return-1}function hz(t,n,e,i){return b2(this.multi,[])}function fz(t,n,e,i){const r=this.multi;let o;if(this.providerFactory){const s=this.providerFactory.componentProviders,a=gl(e,e[Yt],this.providerFactory.index,i);o=a.slice(0,s),b2(r,o);for(let c=s;c<a.length;c++)o.push(a[c])}else o=[],b2(r,o);return o}function b2(t,n){for(let e=0;e<t.length;e++)n.push((0,t[e])());return n}function br(t,n=[]){return e=>{e.providersResolver=(i,r)=>function dz(t,n,e){const i=fi();if(i.firstCreatePass){const r=Ua(t);g2(e,i.data,i.blueprint,r,!0),g2(n,i.data,i.blueprint,r,!1)}}(i,r?r(t):t,n)}}let gz=(()=>{class t{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e)){const i=op(0,e.type),r=i.length>0?function W3(t,n,e=null){return new G3({providers:t,parent:n,debugName:e,runEnvironmentInitializers:!0}).injector}([i],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e,r)}return this.cachedInjectors.get(e)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=nn({token:t,providedIn:"environment",factory:()=>new t(Nn(ls))})}return t})();function v2(t){Ic("NgStandalone"),t.getStandaloneInjector=n=>n.get(gz).getOrCreateStandaloneInjector(t)}function wg(t,n,e){const i=t.\u0275cmp;i.directiveDefs=np(n,!1),i.pipeDefs=np(e,!0)}function wu(t,n,e){const i=to()+t,r=_t();return r[i]===nt?Tc(r,i,e?n.call(e):n()):s0(r,i)}function Ke(t,n,e,i){return function Yk(t,n,e,i,r,o){const s=n+e;return ho(t,s,r)?Tc(t,s+1,o?i.call(o,r):i(r)):v0(t,s+1)}(_t(),to(),t,n,e,i)}function Tn(t,n,e,i,r){return Zk(_t(),to(),t,n,e,i,r)}function Qs(t,n,e,i,r,o){return function qk(t,n,e,i,r,o,s,a){const c=n+e;return V1(t,c,r,o,s)?Tc(t,c+3,a?i.call(a,r,o,s):i(r,o,s)):v0(t,c+3)}(_t(),to(),t,n,e,i,r,o)}function Ja(t,n,e,i,r,o,s){return function Xk(t,n,e,i,r,o,s,a,c){const u=n+e;return _l(t,u,r,o,s,a)?Tc(t,u+4,c?i.call(c,r,o,s,a):i(r,o,s,a)):v0(t,u+4)}(_t(),to(),t,n,e,i,r,o,s)}function y2(t,n,e,i,r,o,s,a,c){const u=to()+t,f=_t(),b=_l(f,u,e,i,r,o);return rf(f,u+4,s,a)||b?Tc(f,u+6,c?n.call(c,e,i,r,o,s,a):n(e,i,r,o,s,a)):s0(f,u+6)}function Eg(t,n,e,i,r,o,s,a,c,u){const f=to()+t,b=_t();let C=_l(b,f,e,i,r,o);return V1(b,f+4,s,a,c)||C?Tc(b,f+7,u?n.call(u,e,i,r,o,s,a,c):n(e,i,r,o,s,a,c)):s0(b,f+7)}function Yl(t,n,e,i,r,o,s,a,c,u,f){const b=to()+t,C=_t(),x=_l(C,b,e,i,r,o);return _l(C,b+4,s,a,c,u)||x?Tc(C,b+8,f?n.call(f,e,i,r,o,s,a,c,u):n(e,i,r,o,s,a,c,u)):s0(C,b+8)}function v0(t,n){const e=t[n];return e===nt?void 0:e}function Zk(t,n,e,i,r,o,s){const a=n+e;return rf(t,a,r,o)?Tc(t,a+2,s?i.call(s,r,o):i(r,o)):v0(t,a+2)}function Ut(t,n){const e=fi();let i;const r=t+Wn;e.firstCreatePass?(i=function vz(t,n){if(n)for(let e=n.length-1;e>=0;e--){const i=n[e];if(t===i.name)return i}}(n,e.pipeRegistry),e.data[r]=i,i.onDestroy&&(e.destroyHooks??=[]).push(r,i.onDestroy)):i=e.data[r];const o=i.factory||(i.factory=tu(i.type)),a=Po(Y);try{const c=Cd(!1),u=o();return Cd(c),function JU(t,n,e,i){e>=t.data.length&&(t.data[e]=null,t.blueprint[e]=null),n[e]=i}(e,_t(),r,u),u}finally{Po(a)}}function zt(t,n,e,i){const r=t+Wn,o=_t(),s=gd(o,r);return function y0(t,n){return t[Yt].data[n].pure}(o,r)?Zk(o,to(),n,s.transform,e,i,s):s.transform(e,i)}function Ai(t,n){return M1(t,n)}const _O=new mn(""),ry=new mn("");let M2,T2=(()=>{class t{constructor(e,i,r){this._ngZone=e,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,M2||(function _9(t){M2=t}(r),r.addToWindow(i)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Pn.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb()}});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(e)||(clearTimeout(i.timeoutId),!1))}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,i,r){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(s=>s.timeoutId!==o),e()},i)),this._callbacks.push({doneCb:e,timeoutId:o,updateCb:r})}whenStable(e,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,i,r){return[]}static#e=this.\u0275fac=function(i){return new(i||t)(Nn(Pn),Nn(S2),Nn(ry))};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac})}return t})(),S2=(()=>{class t{constructor(){this._applications=new Map}registerApplication(e,i){this._applications.set(e,i)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,i=!0){return M2?.findTestabilityInTree(this,e,i)??null}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})();function oy(t){return!!t&&"function"==typeof t.then}function bO(t){return!!t&&"function"==typeof t.subscribe}const vO=new mn("");let D2=(()=>{class t{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((e,i)=>{this.resolve=e,this.reject=i}),this.appInits=kn(vO,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const e=[];for(const r of this.appInits){const o=r();if(oy(o))e.push(o);else if(bO(o)){const s=new Promise((a,c)=>{o.subscribe({complete:a,error:c})});e.push(s)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(e).then(()=>{i()}).catch(r=>{this.reject(r)}),0===e.length&&i(),this.initialized=!0}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const yO=new mn("");function wO(t,n){return Array.isArray(n)?n.reduce(wO,t):{...t,...n}}let Ud=(()=>{class t{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=kn(Iv),this.afterRenderEffectManager=kn(J_),this.externalTestViews=new Set,this.beforeRender=new zs,this.afterTick=new zs,this.componentTypes=[],this.components=[],this.isStable=kn(o0).hasPendingTasks.pipe(Oo(e=>!e)),this._injector=kn(ls)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(e,i){const r=e instanceof JM;if(!this._injector.get(D2).done)throw!r&&function js(t){const n=Qn(t)||Jr(t)||Gr(t);return null!==n&&n.standalone}(e),new mt(405,!1);let s;s=r?e:this._injector.get(F1).resolveComponentFactory(e),this.componentTypes.push(s.componentType);const a=function b9(t){return t.isBoundToModule}(s)?void 0:this._injector.get(nf),u=s.create(hs.NULL,[],i||s.selector,a),f=u.location.nativeElement,b=u.injector.get(_O,null);return b?.registerApplication(f),u.onDestroy(()=>{this.detachView(u.hostView),sy(this.components,u),b?.unregisterApplication(f)}),this._loadComponent(u),u}tick(){this._tick(!0)}_tick(e){if(this._runningTick)throw new mt(101,!1);const i=O(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(e)}catch(r){this.internalErrorHandler(r)}finally{this.afterTick.next(),this._runningTick=!1,O(i)}}detectChangesInAttachedViews(e){let i=0;const r=this.afterRenderEffectManager;for(;;){if(i===jM)throw new mt(103,!1);if(e){const o=0===i;this.beforeRender.next(o);for(let{_lView:s,notifyErrorHandler:a}of this._views)y9(s,o,a)}if(i++,r.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>k2(o))&&(r.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>k2(o))))break}}attachView(e){const i=e;this._views.push(i),i.attachToAppRef(this)}detachView(e){const i=e;sy(this._views,i),i.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e);const i=this._injector.get(yO,[]);[...this._bootstrapListeners,...i].forEach(r=>r(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>sy(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new mt(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function sy(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}function y9(t,n,e){!n&&!k2(t)||function C9(t,n,e){let i;e?(i=0,t[_n]|=1024):i=64&t[_n]?0:1,S1(t,n,i)}(t,e,n)}function k2(t){return Dh(t)}let I9=(()=>{class t{constructor(){this.zone=kn(Pn),this.applicationRef=kn(Ud)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function T9(){const t=kn(Pn),n=kn($a);return e=>t.runOutsideAngular(()=>n.handleError(e))}let M9=(()=>{class t{constructor(){this.subscription=new Ie,this.initialized=!1,this.zone=kn(Pn),this.pendingTasks=kn(o0)}initialize(){if(this.initialized)return;this.initialized=!0;let e=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(e=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Pn.assertNotInAngularZone(),queueMicrotask(()=>{null!==e&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(e),e=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Pn.assertInAngularZone(),e??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const Eu=new mn("",{providedIn:"root",factory:()=>kn(Eu,bi.Optional|bi.SkipSelf)||function D9(){return typeof $localize<"u"&&$localize.locale||xg}()}),O2=new mn("");let SO=(()=>{class t{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,i){const r=function y6(t="zone.js",n){return"noop"===t?new o3:"zone.js"===t?new Pn(n):t}(i?.ngZone,function TO(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return r.run(()=>{const o=function pB(t,n,e){return new HE(t,n,e)}(e.moduleType,this.injector,function IO(t){return[{provide:Pn,useFactory:t},{provide:nd,multi:!0,useFactory:()=>{const n=kn(I9,{optional:!0});return()=>n.initialize()}},{provide:nd,multi:!0,useFactory:()=>{const n=kn(M9);return()=>{n.initialize()}}},{provide:Iv,useFactory:T9}]}(()=>r)),s=o.injector.get($a,null);return r.runOutsideAngular(()=>{const a=r.onError.subscribe({next:c=>{s.handleError(c)}});o.onDestroy(()=>{sy(this._modules,o),a.unsubscribe()})}),function xO(t,n,e){try{const i=e();return oy(i)?i.catch(r=>{throw n.runOutsideAngular(()=>t.handleError(r)),r}):i}catch(i){throw n.runOutsideAngular(()=>t.handleError(i)),i}}(s,r,()=>{const a=o.injector.get(D2);return a.runInitializers(),a.donePromise.then(()=>(function YD(t){"string"==typeof t&&($D=t.toLowerCase().replace(/_/g,"-"))}(o.injector.get(Eu,xg)||xg),this._moduleDoBootstrap(o),o))})})}bootstrapModule(e,i=[]){const r=wO({},i);return function E9(t,n,e){const i=new VE(e);return Promise.resolve(i)}(0,0,e).then(o=>this.bootstrapModuleFactory(o,r))}_moduleDoBootstrap(e){const i=e.injector.get(Ud);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!e.instance.ngDoBootstrap)throw new mt(-403,!1);e.instance.ngDoBootstrap(i)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new mt(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const e=this._injector.get(O2,null);e&&(e.forEach(i=>i()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(i){return new(i||t)(Nn(hs))};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})(),zd=null;const MO=new mn("");function DO(t,n,e=[]){const i=`Platform: ${n}`,r=new mn(i);return(o=[])=>{let s=A2();if(!s||s.injector.get(MO,!1)){const a=[...e,...o,{provide:r,useValue:!0}];t?t(a):function A9(t){if(zd&&!zd.get(MO,!1))throw new mt(400,!1);(function CO(){!function et(t){Tt=t}(()=>{throw new mt(600,!1)})})(),zd=t;const n=t.get(SO);(function OO(t){t.get(f_,null)?.forEach(e=>e())})(t)}(function kO(t=[],n){return hs.create({name:n,providers:[{provide:Ch,useValue:"platform"},{provide:O2,useValue:new Set([()=>zd=null])},...t]})}(a,i))}return function P9(t){const n=A2();if(!n)throw new mt(401,!1);return n}()}}function A2(){return zd?.get(SO)??null}let Zr=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=N9}return t})();function N9(t){return function R9(t,n,e){if(cu(t)&&!e){const i=Ws(t.index,n);return new Z_(i,i)}return 47&t.type?new Z_(n[gr],n):null}(zi(),_t(),!(16&~t))}class RO{constructor(){}supports(n){return H1(n)}create(n){return new H9(n)}}const z9=(t,n)=>n;class H9{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||z9}forEachItem(n){let e;for(e=this._itHead;null!==e;e=e._next)n(e)}forEachOperation(n){let e=this._itHead,i=this._removalsHead,r=0,o=null;for(;e||i;){const s=!i||e&&e.currentIndex<BO(i,r,o)?e:i,a=BO(s,r,o),c=s.currentIndex;if(s===i)r--,i=i._nextRemoved;else if(e=e._next,null==s.previousIndex)r++;else{o||(o=[]);const u=a-r,f=c-r;if(u!=f){for(let C=0;C<u;C++){const x=C<o.length?o[C]:o[C]=0,M=x+C;f<=M&&M<u&&(o[C]=x+1)}o[s.previousIndex]=f-u}}a!==c&&n(s,a,c)}}forEachPreviousItem(n){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachMovedItem(n){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}forEachIdentityChange(n){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)n(e)}diff(n){if(null==n&&(n=[]),!H1(n))throw new mt(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let r,o,s,e=this._itHead,i=!1;if(Array.isArray(n)){this.length=n.length;for(let a=0;a<this.length;a++)o=n[a],s=this._trackByFn(a,o),null!==e&&Object.is(e.trackById,s)?(i&&(e=this._verifyReinsertion(e,o,s,a)),Object.is(e.item,o)||this._addIdentityChange(e,o)):(e=this._mismatch(e,o,s,a),i=!0),e=e._next}else r=0,function bB(t,n){if(Array.isArray(t))for(let e=0;e<t.length;e++)n(t[e]);else{const e=t[Symbol.iterator]();let i;for(;!(i=e.next()).done;)n(i.value)}}(n,a=>{s=this._trackByFn(r,a),null!==e&&Object.is(e.trackById,s)?(i&&(e=this._verifyReinsertion(e,a,s,r)),Object.is(e.item,a)||this._addIdentityChange(e,a)):(e=this._mismatch(e,a,s,r),i=!0),e=e._next,r++}),this.length=r;return this._truncate(e),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,e,i,r){let o;return null===n?o=this._itTail:(o=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._reinsertAfter(n,o,r)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._moveAfter(n,o,r)):n=this._addAfter(new V9(e,i),o,r),n}_verifyReinsertion(n,e,i,r){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==o?n=this._reinsertAfter(o,n._prev,r):n.currentIndex!=r&&(n.currentIndex=r,this._addToMoves(n,r)),n}_truncate(n){for(;null!==n;){const e=n._next;this._addToRemovals(this._unlink(n)),n=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,e,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const r=n._prevRemoved,o=n._nextRemoved;return null===r?this._removalsHead=o:r._nextRemoved=o,null===o?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(n,e,i),this._addToMoves(n,i),n}_moveAfter(n,e,i){return this._unlink(n),this._insertAfter(n,e,i),this._addToMoves(n,i),n}_addAfter(n,e,i){return this._insertAfter(n,e,i),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,e,i){const r=null===e?this._itHead:e._next;return n._next=r,n._prev=e,null===r?this._itTail=n:r._prev=n,null===e?this._itHead=n:e._next=n,null===this._linkedRecords&&(this._linkedRecords=new LO),this._linkedRecords.put(n),n.currentIndex=i,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const e=n._prev,i=n._next;return null===e?this._itHead=i:e._next=i,null===i?this._itTail=e:i._prev=e,n}_addToMoves(n,e){return n.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new LO),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,e){return n.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class V9{constructor(n,e){this.item=n,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class j9{constructor(){this._head=null,this._tail=null}add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,e){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===e||e<=i.currentIndex)&&Object.is(i.trackById,n))return i;return null}remove(n){const e=n._prevDup,i=n._nextDup;return null===e?this._head=i:e._nextDup=i,null===i?this._tail=e:i._prevDup=e,null===this._head}}class LO{constructor(){this.map=new Map}put(n){const e=n.trackById;let i=this.map.get(e);i||(i=new j9,this.map.set(e,i)),i.add(n)}get(n,e){const r=this.map.get(n);return r?r.get(n,e):null}remove(n){const e=n.trackById;return this.map.get(e).remove(n)&&this.map.delete(e),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function BO(t,n,e){const i=t.previousIndex;if(null===i)return i;let r=0;return e&&i<e.length&&(r=e[i]),i+n+r}class UO{constructor(){}supports(n){return n instanceof Map||jE(n)}create(){return new G9}}class G9{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(n){let e;for(e=this._mapHead;null!==e;e=e._next)n(e)}forEachPreviousItem(n){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)n(e)}forEachChangedItem(n){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}diff(n){if(n){if(!(n instanceof Map||jE(n)))throw new mt(900,!1)}else n=new Map;return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(n,(i,r)=>{if(e&&e.key===r)this._maybeAddToChanges(e,i),this._appendAfter=e,e=e._next;else{const o=this._getOrCreateRecordForKey(r,i);e=this._insertBeforeOrAppend(e,o)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let i=e;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,e){if(n){const i=n._prev;return e._next=n,e._prev=i,n._prev=e,i&&(i._next=e),n===this._mapHead&&(this._mapHead=e),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(n,e){if(this._records.has(n)){const r=this._records.get(n);this._maybeAddToChanges(r,e);const o=r._prev,s=r._next;return o&&(o._next=s),s&&(s._prev=o),r._next=null,r._prev=null,r}const i=new W9(n);return this._records.set(n,i),i.currentValue=e,this._addToAdditions(i),i}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;null!==n;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;null!=n;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,e){Object.is(e,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=e,this._addToChanges(n))}_addToAdditions(n){null===this._additionsHead?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){null===this._changesHead?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,e){n instanceof Map?n.forEach(e):Object.keys(n).forEach(i=>e(n[i],i))}}class W9{constructor(n){this.key=n,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function zO(){return new L2([new RO])}let L2=(()=>{class t{static#e=this.\u0275prov=nn({token:t,providedIn:"root",factory:zO});constructor(e){this.factories=e}static create(e,i){if(null!=i){const r=i.factories.slice();e=e.concat(r)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>t.create(e,i||zO()),deps:[[t,new qf,new gh]]}}find(e){const i=this.factories.find(r=>r.supports(e));if(null!=i)return i;throw new mt(901,!1)}}return t})();function HO(){return new uy([new UO])}let uy=(()=>{class t{static#e=this.\u0275prov=nn({token:t,providedIn:"root",factory:HO});constructor(e){this.factories=e}static create(e,i){if(i){const r=i.factories.slice();e=e.concat(r)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>t.create(e,i||HO()),deps:[[t,new qf,new gh]]}}find(e){const i=this.factories.find(r=>r.supports(e));if(i)return i;throw new mt(901,!1)}}return t})();const Z9=DO(null,"core",[]);let q9=(()=>{class t{constructor(e){}static#e=this.\u0275fac=function(i){return new(i||t)(Nn(Ud))};static#t=this.\u0275mod=ga({type:t});static#n=this.\u0275inj=ha({})}return t})();function cf(t){return"boolean"==typeof t?t:null!=t&&"false"!==t}function z2(t,n=NaN){return isNaN(parseFloat(t))||isNaN(Number(t))?n:Number(t)}let uA=null;function I0(){return uA}class OH{}const Iu=new mn("");var ea=function(t){return t[t.Format=0]="Format",t[t.Standalone=1]="Standalone",t}(ea||{}),pr=function(t){return t[t.Narrow=0]="Narrow",t[t.Abbreviated=1]="Abbreviated",t[t.Wide=2]="Wide",t[t.Short=3]="Short",t}(pr||{}),el=function(t){return t[t.Short=0]="Short",t[t.Medium=1]="Medium",t[t.Long=2]="Long",t[t.Full=3]="Full",t}(el||{});const So={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function _y(t,n){return vl(Ks(t)[_r.DateFormat],n)}function by(t,n){return vl(Ks(t)[_r.TimeFormat],n)}function vy(t,n){return vl(Ks(t)[_r.DateTimeFormat],n)}function bl(t,n){const e=Ks(t),i=e[_r.NumberSymbols][n];if(typeof i>"u"){if(n===So.CurrencyDecimal)return e[_r.NumberSymbols][So.Decimal];if(n===So.CurrencyGroup)return e[_r.NumberSymbols][So.Group]}return i}function hA(t){if(!t[_r.ExtraData])throw new Error(`Missing extra locale data for the locale "${t[_r.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function vl(t,n){for(let e=n;e>-1;e--)if(typeof t[e]<"u")return t[e];throw new Error("Locale data API: locale data undefined")}function V2(t){const[n,e]=t.split(":");return{hours:+n,minutes:+e}}const YH=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,yy={},ZH=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Tu=function(t){return t[t.Short=0]="Short",t[t.ShortGMT=1]="ShortGMT",t[t.Long=2]="Long",t[t.Extended=3]="Extended",t}(Tu||{}),Wi=function(t){return t[t.FullYear=0]="FullYear",t[t.Month=1]="Month",t[t.Date=2]="Date",t[t.Hours=3]="Hours",t[t.Minutes=4]="Minutes",t[t.Seconds=5]="Seconds",t[t.FractionalSeconds=6]="FractionalSeconds",t[t.Day=7]="Day",t}(Wi||{}),$i=function(t){return t[t.DayPeriods=0]="DayPeriods",t[t.Days=1]="Days",t[t.Months=2]="Months",t[t.Eras=3]="Eras",t}($i||{});function T0(t,n,e,i){let r=function i7(t){if(gA(t))return t;if("number"==typeof t&&!isNaN(t))return new Date(t);if("string"==typeof t){if(t=t.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(t)){const[r,o=1,s=1]=t.split("-").map(a=>+a);return Cy(r,o-1,s)}const e=parseFloat(t);if(!isNaN(t-e))return new Date(e);let i;if(i=t.match(YH))return function r7(t){const n=new Date(0);let e=0,i=0;const r=t[8]?n.setUTCFullYear:n.setFullYear,o=t[8]?n.setUTCHours:n.setHours;t[9]&&(e=Number(t[9]+t[10]),i=Number(t[9]+t[11])),r.call(n,Number(t[1]),Number(t[2])-1,Number(t[3]));const s=Number(t[4]||0)-e,a=Number(t[5]||0)-i,c=Number(t[6]||0),u=Math.floor(1e3*parseFloat("0."+(t[7]||0)));return o.call(n,s,a,c,u),n}(i)}const n=new Date(t);if(!gA(n))throw new Error(`Unable to convert "${t}" into a date`);return n}(t);n=Su(e,n)||n;let a,s=[];for(;n;){if(a=ZH.exec(n),!a){s.push(n);break}{s=s.concat(a.slice(1));const f=s.pop();if(!f)break;n=f}}let c=r.getTimezoneOffset();i&&(c=pA(i,c),r=function n7(t,n,e){const i=e?-1:1,r=t.getTimezoneOffset();return function t7(t,n){return(t=new Date(t.getTime())).setMinutes(t.getMinutes()+n),t}(t,i*(pA(n,r)-r))}(r,i,!0));let u="";return s.forEach(f=>{const b=function e7(t){if(G2[t])return G2[t];let n;switch(t){case"G":case"GG":case"GGG":n=vr($i.Eras,pr.Abbreviated);break;case"GGGG":n=vr($i.Eras,pr.Wide);break;case"GGGGG":n=vr($i.Eras,pr.Narrow);break;case"y":n=Mo(Wi.FullYear,1,0,!1,!0);break;case"yy":n=Mo(Wi.FullYear,2,0,!0,!0);break;case"yyy":n=Mo(Wi.FullYear,3,0,!1,!0);break;case"yyyy":n=Mo(Wi.FullYear,4,0,!1,!0);break;case"Y":n=Iy(1);break;case"YY":n=Iy(2,!0);break;case"YYY":n=Iy(3);break;case"YYYY":n=Iy(4);break;case"M":case"L":n=Mo(Wi.Month,1,1);break;case"MM":case"LL":n=Mo(Wi.Month,2,1);break;case"MMM":n=vr($i.Months,pr.Abbreviated);break;case"MMMM":n=vr($i.Months,pr.Wide);break;case"MMMMM":n=vr($i.Months,pr.Narrow);break;case"LLL":n=vr($i.Months,pr.Abbreviated,ea.Standalone);break;case"LLLL":n=vr($i.Months,pr.Wide,ea.Standalone);break;case"LLLLL":n=vr($i.Months,pr.Narrow,ea.Standalone);break;case"w":n=j2(1);break;case"ww":n=j2(2);break;case"W":n=j2(1,!0);break;case"d":n=Mo(Wi.Date,1);break;case"dd":n=Mo(Wi.Date,2);break;case"c":case"cc":n=Mo(Wi.Day,1);break;case"ccc":n=vr($i.Days,pr.Abbreviated,ea.Standalone);break;case"cccc":n=vr($i.Days,pr.Wide,ea.Standalone);break;case"ccccc":n=vr($i.Days,pr.Narrow,ea.Standalone);break;case"cccccc":n=vr($i.Days,pr.Short,ea.Standalone);break;case"E":case"EE":case"EEE":n=vr($i.Days,pr.Abbreviated);break;case"EEEE":n=vr($i.Days,pr.Wide);break;case"EEEEE":n=vr($i.Days,pr.Narrow);break;case"EEEEEE":n=vr($i.Days,pr.Short);break;case"a":case"aa":case"aaa":n=vr($i.DayPeriods,pr.Abbreviated);break;case"aaaa":n=vr($i.DayPeriods,pr.Wide);break;case"aaaaa":n=vr($i.DayPeriods,pr.Narrow);break;case"b":case"bb":case"bbb":n=vr($i.DayPeriods,pr.Abbreviated,ea.Standalone,!0);break;case"bbbb":n=vr($i.DayPeriods,pr.Wide,ea.Standalone,!0);break;case"bbbbb":n=vr($i.DayPeriods,pr.Narrow,ea.Standalone,!0);break;case"B":case"BB":case"BBB":n=vr($i.DayPeriods,pr.Abbreviated,ea.Format,!0);break;case"BBBB":n=vr($i.DayPeriods,pr.Wide,ea.Format,!0);break;case"BBBBB":n=vr($i.DayPeriods,pr.Narrow,ea.Format,!0);break;case"h":n=Mo(Wi.Hours,1,-12);break;case"hh":n=Mo(Wi.Hours,2,-12);break;case"H":n=Mo(Wi.Hours,1);break;case"HH":n=Mo(Wi.Hours,2);break;case"m":n=Mo(Wi.Minutes,1);break;case"mm":n=Mo(Wi.Minutes,2);break;case"s":n=Mo(Wi.Seconds,1);break;case"ss":n=Mo(Wi.Seconds,2);break;case"S":n=Mo(Wi.FractionalSeconds,1);break;case"SS":n=Mo(Wi.FractionalSeconds,2);break;case"SSS":n=Mo(Wi.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":n=wy(Tu.Short);break;case"ZZZZZ":n=wy(Tu.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":n=wy(Tu.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":n=wy(Tu.Long);break;default:return null}return G2[t]=n,n}(f);u+=b?b(r,e,c):"''"===f?"'":f.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),u}function Cy(t,n,e){const i=new Date(0);return i.setFullYear(t,n,e),i.setHours(0,0,0),i}function Su(t,n){const e=function NH(t){return Ks(t)[_r.LocaleId]}(t);if(yy[e]??={},yy[e][n])return yy[e][n];let i="";switch(n){case"shortDate":i=_y(t,el.Short);break;case"mediumDate":i=_y(t,el.Medium);break;case"longDate":i=_y(t,el.Long);break;case"fullDate":i=_y(t,el.Full);break;case"shortTime":i=by(t,el.Short);break;case"mediumTime":i=by(t,el.Medium);break;case"longTime":i=by(t,el.Long);break;case"fullTime":i=by(t,el.Full);break;case"short":const r=Su(t,"shortTime"),o=Su(t,"shortDate");i=xy(vy(t,el.Short),[r,o]);break;case"medium":const s=Su(t,"mediumTime"),a=Su(t,"mediumDate");i=xy(vy(t,el.Medium),[s,a]);break;case"long":const c=Su(t,"longTime"),u=Su(t,"longDate");i=xy(vy(t,el.Long),[c,u]);break;case"full":const f=Su(t,"fullTime"),b=Su(t,"fullDate");i=xy(vy(t,el.Full),[f,b])}return i&&(yy[e][n]=i),i}function xy(t,n){return n&&(t=t.replace(/\{([^}]+)}/g,function(e,i){return null!=n&&i in n?n[i]:e})),t}function Zl(t,n,e="-",i,r){let o="";(t<0||r&&t<=0)&&(r?t=1-t:(t=-t,o=e));let s=String(t);for(;s.length<n;)s="0"+s;return i&&(s=s.slice(s.length-n)),o+s}function Mo(t,n,e=0,i=!1,r=!1){return function(o,s){let a=function XH(t,n){switch(t){case Wi.FullYear:return n.getFullYear();case Wi.Month:return n.getMonth();case Wi.Date:return n.getDate();case Wi.Hours:return n.getHours();case Wi.Minutes:return n.getMinutes();case Wi.Seconds:return n.getSeconds();case Wi.FractionalSeconds:return n.getMilliseconds();case Wi.Day:return n.getDay();default:throw new Error(`Unknown DateType value "${t}".`)}}(t,o);if((e>0||a>-e)&&(a+=e),t===Wi.Hours)0===a&&-12===e&&(a=12);else if(t===Wi.FractionalSeconds)return function qH(t,n){return Zl(t,3).substring(0,n)}(a,n);const c=bl(s,So.MinusSign);return Zl(a,n,c,i,r)}}function vr(t,n,e=ea.Format,i=!1){return function(r,o){return function KH(t,n,e,i,r,o){switch(e){case $i.Months:return function BH(t,n,e){const i=Ks(t),o=vl([i[_r.MonthsFormat],i[_r.MonthsStandalone]],n);return vl(o,e)}(n,r,i)[t.getMonth()];case $i.Days:return function LH(t,n,e){const i=Ks(t),o=vl([i[_r.DaysFormat],i[_r.DaysStandalone]],n);return vl(o,e)}(n,r,i)[t.getDay()];case $i.DayPeriods:const s=t.getHours(),a=t.getMinutes();if(o){const u=function VH(t){const n=Ks(t);return hA(n),(n[_r.ExtraData][2]||[]).map(i=>"string"==typeof i?V2(i):[V2(i[0]),V2(i[1])])}(n),f=function jH(t,n,e){const i=Ks(t);hA(i);const o=vl([i[_r.ExtraData][0],i[_r.ExtraData][1]],n)||[];return vl(o,e)||[]}(n,r,i),b=u.findIndex(C=>{if(Array.isArray(C)){const[x,M]=C,U=s>=x.hours&&a>=x.minutes,W=s<M.hours||s===M.hours&&a<M.minutes;if(x.hours<M.hours){if(U&&W)return!0}else if(U||W)return!0}else if(C.hours===s&&C.minutes===a)return!0;return!1});if(-1!==b)return f[b]}return function RH(t,n,e){const i=Ks(t),o=vl([i[_r.DayPeriodsFormat],i[_r.DayPeriodsStandalone]],n);return vl(o,e)}(n,r,i)[s<12?0:1];case $i.Eras:return function UH(t,n){return vl(Ks(t)[_r.Eras],n)}(n,i)[t.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(r,o,t,n,e,i)}}function wy(t){return function(n,e,i){const r=-1*i,o=bl(e,So.MinusSign),s=r>0?Math.floor(r/60):Math.ceil(r/60);switch(t){case Tu.Short:return(r>=0?"+":"")+Zl(s,2,o)+Zl(Math.abs(r%60),2,o);case Tu.ShortGMT:return"GMT"+(r>=0?"+":"")+Zl(s,1,o);case Tu.Long:return"GMT"+(r>=0?"+":"")+Zl(s,2,o)+":"+Zl(Math.abs(r%60),2,o);case Tu.Extended:return 0===i?"Z":(r>=0?"+":"")+Zl(s,2,o)+":"+Zl(Math.abs(r%60),2,o);default:throw new Error(`Unknown zone width "${t}"`)}}}const QH=0,Ey=4;function fA(t){const n=t.getDay(),e=0===n?-3:Ey-n;return Cy(t.getFullYear(),t.getMonth(),t.getDate()+e)}function j2(t,n=!1){return function(e,i){let r;if(n){const o=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,s=e.getDate();r=1+Math.floor((s+o)/7)}else{const o=fA(e),s=function JH(t){const n=Cy(t,QH,1).getDay();return Cy(t,0,1+(n<=Ey?Ey:Ey+7)-n)}(o.getFullYear()),a=o.getTime()-s.getTime();r=1+Math.round(a/6048e5)}return Zl(r,t,bl(i,So.MinusSign))}}function Iy(t,n=!1){return function(e,i){return Zl(fA(e).getFullYear(),t,bl(i,So.MinusSign),n)}}const G2={};function pA(t,n){t=t.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+t)/6e4;return isNaN(e)?n:e}function gA(t){return t instanceof Date&&!isNaN(t.valueOf())}const X2=/\s+/,vA=[];let Ni=(()=>{class t{constructor(e,i){this._ngEl=e,this._renderer=i,this.initialClasses=vA,this.stateMap=new Map}set klass(e){this.initialClasses=null!=e?e.trim().split(X2):vA}set ngClass(e){this.rawClass="string"==typeof e?e.trim().split(X2):e}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const e=this.rawClass;if(Array.isArray(e)||e instanceof Set)for(const i of e)this._updateState(i,!0);else if(null!=e)for(const i of Object.keys(e))this._updateState(i,!!e[i]);this._applyStateDiff()}_updateState(e,i){const r=this.stateMap.get(e);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(e,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const e of this.stateMap){const i=e[0],r=e[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(e,i){(e=e.trim()).length>0&&e.split(X2).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static#e=this.\u0275fac=function(i){return new(i||t)(Y(fr),Y(Jh))};static#t=this.\u0275dir=Sn({type:t,selectors:[["","ngClass",""]],inputs:{klass:[Ce.None,"class","klass"],ngClass:"ngClass"},standalone:!0})}return t})();class b7{constructor(n,e,i,r){this.$implicit=n,this.ngForOf=e,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let nr=(()=>{class t{set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}constructor(e,i,r){this._viewContainer=e,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const i=this._viewContainer;e.forEachOperation((r,o,s)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new b7(r.item,this._ngForOf,-1,-1),null===s?void 0:s);else if(null==s)i.remove(null===o?void 0:o);else if(null!==o){const a=i.get(o);i.move(a,s),CA(a,r)}});for(let r=0,o=i.length;r<o;r++){const a=i.get(r).context;a.index=r,a.count=o,a.ngForOf=this._ngForOf}e.forEachIdentityChange(r=>{CA(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(e,i){return!0}static#e=this.\u0275fac=function(i){return new(i||t)(Y(xa),Y(xu),Y(L2))};static#t=this.\u0275dir=Sn({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return t})();function CA(t,n){t.context.$implicit=n.item}let ri=(()=>{class t{constructor(e,i){this._viewContainer=e,this._context=new v7,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){xA("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){xA("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,i){return!0}static#e=this.\u0275fac=function(i){return new(i||t)(Y(xa),Y(xu))};static#t=this.\u0275dir=Sn({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return t})();class v7{constructor(){this.$implicit=null,this.ngIf=null}}function xA(t,n){if(n&&!n.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${Ti(n)}'.`)}class K2{constructor(n,e){this._viewContainerRef=n,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(n){n&&!this._created?this.create():!n&&this._created&&this.destroy()}}let Hd=(()=>{class t{constructor(){this._defaultViews=[],this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews.push(e)}_matchCase(e){const i=e===this._ngSwitch;return this._lastCasesMatched||=i,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),i}_updateDefaultCases(e){if(this._defaultViews.length>0&&e!==this._defaultUsed){this._defaultUsed=e;for(const i of this._defaultViews)i.enforceState(e)}}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275dir=Sn({type:t,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0})}return t})(),Dg=(()=>{class t{constructor(e,i,r){this.ngSwitch=r,r._addCase(),this._view=new K2(e,i)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}static#e=this.\u0275fac=function(i){return new(i||t)(Y(xa),Y(xu),Y(Hd,9))};static#t=this.\u0275dir=Sn({type:t,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0})}return t})(),M0=(()=>{class t{constructor(e,i,r){r._addDefault(new K2(e,i))}static#e=this.\u0275fac=function(i){return new(i||t)(Y(xa),Y(xu),Y(Hd,9))};static#t=this.\u0275dir=Sn({type:t,selectors:[["","ngSwitchDefault",""]],standalone:!0})}return t})(),Lo=(()=>{class t{constructor(e,i,r){this._ngEl=e,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,i){const[r,o]=e.split("."),s=-1===r.indexOf("-")?void 0:Yr.DashCase;null!=i?this._renderer.setStyle(this._ngEl.nativeElement,r,o?`${i}${o}`:i,s):this._renderer.removeStyle(this._ngEl.nativeElement,r,s)}_applyChanges(e){e.forEachRemovedItem(i=>this._setStyle(i.key,null)),e.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),e.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}static#e=this.\u0275fac=function(i){return new(i||t)(Y(fr),Y(uy),Y(Jh))};static#t=this.\u0275dir=Sn({type:t,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0})}return t})(),uf=(()=>{class t{constructor(e){this._viewContainerRef=e,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(e){if(this._shouldRecreateView(e)){const i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),!this.ngTemplateOutlet)return void(this._viewRef=null);const r=this._createContextForwardProxy();this._viewRef=i.createEmbeddedView(this.ngTemplateOutlet,r,{injector:this.ngTemplateOutletInjector??void 0})}}_shouldRecreateView(e){return!!e.ngTemplateOutlet||!!e.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(e,i,r)=>!!this.ngTemplateOutletContext&&Reflect.set(this.ngTemplateOutletContext,i,r),get:(e,i,r)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,i,r)}})}static#e=this.\u0275fac=function(i){return new(i||t)(Y(xa))};static#t=this.\u0275dir=Sn({type:t,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[hr]})}return t})();const A7=new mn(""),P7=new mn("");let EA=(()=>{class t{constructor(e,i,r){this.locale=e,this.defaultTimezone=i,this.defaultOptions=r}transform(e,i,r,o){if(null==e||""===e||e!=e)return null;try{return T0(e,i??this.defaultOptions?.dateFormat??"mediumDate",o||this.locale,r??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(s){throw function ql(t,n){return new mt(2100,!1)}()}}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Eu,16),Y(A7,24),Y(P7,24))};static#t=this.\u0275pipe=$o({name:"date",type:t,pure:!0,standalone:!0})}return t})(),TA=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ga({type:t});static#n=this.\u0275inj=ha({})}return t})();const SA="browser";function eI(t){return t===SA}function MA(t){return"server"===t}class CV extends OH{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class nI extends CV{static makeCurrent(){!function kH(t){uA??=t}(new nI)}onAndCancel(n,e,i){return n.addEventListener(e,i),()=>{n.removeEventListener(e,i)}}dispatchEvent(n,e){n.dispatchEvent(e)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,e){return(e=e||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,e){return"window"===e?window:"document"===e?n:"body"===e?n.body:null}getBaseHref(n){const e=function xV(){return O0=O0||document.querySelector("base"),O0?O0.getAttribute("href"):null}();return null==e?null:function wV(t){return new URL(t,document.baseURI).pathname}(e)}resetBaseElement(){O0=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return function m7(t,n){n=encodeURIComponent(n);for(const e of t.split(";")){const i=e.indexOf("="),[r,o]=-1==i?[e,""]:[e.slice(0,i),e.slice(i+1)];if(r.trim()===n)return decodeURIComponent(o)}return null}(document.cookie,n)}}let O0=null,IV=(()=>{class t{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac})}return t})();const iI=new mn("");let LA=(()=>{class t{constructor(e,i){this._zone=i,this._eventNameToPlugin=new Map,e.forEach(r=>{r.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,i,r){return this._findPluginFor(i).addEventListener(e,i,r)}getZone(){return this._zone}_findPluginFor(e){let i=this._eventNameToPlugin.get(e);if(i)return i;if(i=this._plugins.find(o=>o.supports(e)),!i)throw new mt(5101,!1);return this._eventNameToPlugin.set(e,i),i}static#e=this.\u0275fac=function(i){return new(i||t)(Nn(iI),Nn(Pn))};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac})}return t})();class BA{constructor(n){this._doc=n}}const rI="ng-app-id";let UA=(()=>{class t{constructor(e,i,r,o={}){this.doc=e,this.appId=i,this.nonce=r,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=MA(o),this.resetHostNodes()}addStyles(e){for(const i of e)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(e){for(const i of e)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const e=this.styleNodesInDOM;e&&(e.forEach(i=>i.remove()),e.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(e){this.hostNodes.add(e);for(const i of this.getAllStyles())this.addStyleToHost(e,i)}removeHost(e){this.hostNodes.delete(e)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(e){for(const i of this.hostNodes)this.addStyleToHost(i,e)}onStyleRemoved(e){const i=this.styleRef;i.get(e)?.elements?.forEach(r=>r.remove()),i.delete(e)}collectServerRenderedStyles(){const e=this.doc.head?.querySelectorAll(`style[${rI}="${this.appId}"]`);if(e?.length){const i=new Map;return e.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(e,i){const r=this.styleRef;if(r.has(e)){const o=r.get(e);return o.usage+=i,o.usage}return r.set(e,{usage:i,elements:[]}),i}getStyleElement(e,i){const r=this.styleNodesInDOM,o=r?.get(i);if(o?.parentNode===e)return r.delete(i),o.removeAttribute(rI),o;{const s=this.doc.createElement("style");return this.nonce&&s.setAttribute("nonce",this.nonce),s.textContent=i,this.platformIsServer&&s.setAttribute(rI,this.appId),e.appendChild(s),s}}addStyleToHost(e,i){const r=this.getStyleElement(e,i),o=this.styleRef,s=o.get(i)?.elements;s?s.push(r):o.set(i,{elements:[r],usage:1})}resetHostNodes(){const e=this.hostNodes;e.clear(),e.add(this.doc.head)}static#e=this.\u0275fac=function(i){return new(i||t)(Nn(Iu),Nn(Bp),Nn(Up,8),Nn(Za))};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac})}return t})();const oI={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},sI=/%COMP%/g,DV=new mn("",{providedIn:"root",factory:()=>!0});function HA(t,n){return n.map(e=>e.replace(sI,t))}let aI=(()=>{class t{constructor(e,i,r,o,s,a,c,u=null){this.eventManager=e,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=a,this.ngZone=c,this.nonce=u,this.rendererByCompId=new Map,this.platformIsServer=MA(a),this.defaultRenderer=new lI(e,s,c,this.platformIsServer)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===ks.ShadowDom&&(i={...i,encapsulation:ks.Emulated});const r=this.getOrCreateRenderer(e,i);return r instanceof jA?r.applyToHost(e):r instanceof cI&&r.applyStyles(),r}getOrCreateRenderer(e,i){const r=this.rendererByCompId;let o=r.get(i.id);if(!o){const s=this.doc,a=this.ngZone,c=this.eventManager,u=this.sharedStylesHost,f=this.removeStylesOnCompDestroy,b=this.platformIsServer;switch(i.encapsulation){case ks.Emulated:o=new jA(c,u,i,this.appId,f,s,a,b);break;case ks.ShadowDom:return new PV(c,u,e,i,s,a,this.nonce,b);default:o=new cI(c,u,i,f,s,a,b)}r.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(i){return new(i||t)(Nn(LA),Nn(UA),Nn(Bp),Nn(DV),Nn(Iu),Nn(Za),Nn(Pn),Nn(Up))};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac})}return t})();class lI{constructor(n,e,i,r){this.eventManager=n,this.doc=e,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(n,e){return e?this.doc.createElementNS(oI[e]||e,n):this.doc.createElement(n)}createComment(n){return this.doc.createComment(n)}createText(n){return this.doc.createTextNode(n)}appendChild(n,e){(VA(n)?n.content:n).appendChild(e)}insertBefore(n,e,i){n&&(VA(n)?n.content:n).insertBefore(e,i)}removeChild(n,e){n&&n.removeChild(e)}selectRootElement(n,e){let i="string"==typeof n?this.doc.querySelector(n):n;if(!i)throw new mt(-5104,!1);return e||(i.textContent=""),i}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,e,i,r){if(r){e=r+":"+e;const o=oI[r];o?n.setAttributeNS(o,e,i):n.setAttribute(e,i)}else n.setAttribute(e,i)}removeAttribute(n,e,i){if(i){const r=oI[i];r?n.removeAttributeNS(r,e):n.removeAttribute(`${i}:${e}`)}else n.removeAttribute(e)}addClass(n,e){n.classList.add(e)}removeClass(n,e){n.classList.remove(e)}setStyle(n,e,i,r){r&(Yr.DashCase|Yr.Important)?n.style.setProperty(e,i,r&Yr.Important?"important":""):n.style[e]=i}removeStyle(n,e,i){i&Yr.DashCase?n.style.removeProperty(e):n.style[e]=""}setProperty(n,e,i){null!=n&&(n[e]=i)}setValue(n,e){n.nodeValue=e}listen(n,e,i){if("string"==typeof n&&!(n=I0().getGlobalEventTarget(this.doc,n)))throw new Error(`Unsupported event target ${n} for event ${e}`);return this.eventManager.addEventListener(n,e,this.decoratePreventDefault(i))}decoratePreventDefault(n){return e=>{if("__ngUnwrap__"===e)return n;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>n(e)):n(e))&&e.preventDefault()}}}function VA(t){return"TEMPLATE"===t.tagName&&void 0!==t.content}class PV extends lI{constructor(n,e,i,r,o,s,a,c){super(n,o,s,c),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const u=HA(r.id,r.styles);for(const f of u){const b=document.createElement("style");a&&b.setAttribute("nonce",a),b.textContent=f,this.shadowRoot.appendChild(b)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,e){return super.appendChild(this.nodeOrShadowRoot(n),e)}insertBefore(n,e,i){return super.insertBefore(this.nodeOrShadowRoot(n),e,i)}removeChild(n,e){return super.removeChild(this.nodeOrShadowRoot(n),e)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class cI extends lI{constructor(n,e,i,r,o,s,a,c){super(n,o,s,a),this.sharedStylesHost=e,this.removeStylesOnCompDestroy=r,this.styles=c?HA(c,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class jA extends cI{constructor(n,e,i,r,o,s,a,c){const u=r+"-"+i.id;super(n,e,i,o,s,a,c,u),this.contentAttr=function kV(t){return"_ngcontent-%COMP%".replace(sI,t)}(u),this.hostAttr=function OV(t){return"_nghost-%COMP%".replace(sI,t)}(u)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,e){const i=super.createElement(n,e);return super.setAttribute(i,this.contentAttr,""),i}}let FV=(()=>{class t extends BA{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,r){return e.addEventListener(i,r,!1),()=>this.removeEventListener(e,i,r)}removeEventListener(e,i,r){return e.removeEventListener(i,r)}static#e=this.\u0275fac=function(i){return new(i||t)(Nn(Iu))};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac})}return t})();const GA=["alt","control","meta","shift"],NV={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},RV={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let LV=(()=>{class t extends BA{constructor(e){super(e)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,i,r){const o=t.parseEventName(i),s=t.eventCallback(o.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>I0().onAndCancel(e,o.domEventName,s))}static parseEventName(e){const i=e.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const o=t._normalizeKey(i.pop());let s="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),s="code."),GA.forEach(u=>{const f=i.indexOf(u);f>-1&&(i.splice(f,1),s+=u+".")}),s+=o,0!=i.length||0===o.length)return null;const c={};return c.domEventName=r,c.fullKey=s,c}static matchEventFullKeyCode(e,i){let r=NV[e.key]||e.key,o="";return i.indexOf("code.")>-1&&(r=e.code,o="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),GA.forEach(s=>{s!==r&&(0,RV[s])(e)&&(o+=s+".")}),o+=r,o===i)}static eventCallback(e,i,r){return o=>{t.matchEventFullKeyCode(o,e)&&r.runGuarded(()=>i(o))}}static _normalizeKey(e){return"esc"===e?"escape":e}static#e=this.\u0275fac=function(i){return new(i||t)(Nn(Iu))};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac})}return t})();const $A=[{provide:Za,useValue:SA},{provide:f_,useValue:function BV(){nI.makeCurrent()},multi:!0},{provide:Iu,useFactory:function zV(){return function mw(t){h_=t}(document),document},deps:[]}],HV=DO(Z9,"browser",$A),VV=new mn(""),YA=[{provide:ry,useClass:class EV{addToWindow(n){li.getAngularTestability=(i,r=!0)=>{const o=n.findTestabilityInTree(i,r);if(null==o)throw new mt(5103,!1);return o},li.getAllAngularTestabilities=()=>n.getAllTestabilities(),li.getAllAngularRootElements=()=>n.getAllRootElements(),li.frameworkStabilizers||(li.frameworkStabilizers=[]),li.frameworkStabilizers.push(i=>{const r=li.getAllAngularTestabilities();let o=r.length;const s=function(){o--,0==o&&i()};r.forEach(a=>{a.whenStable(s)})})}findTestabilityInTree(n,e,i){return null==e?null:n.getTestability(e)??(i?I0().isShadowRoot(e)?this.findTestabilityInTree(n,e.host,!0):this.findTestabilityInTree(n,e.parentElement,!0):null)}},deps:[]},{provide:_O,useClass:T2,deps:[Pn,S2,ry]},{provide:T2,useClass:T2,deps:[Pn,S2,ry]}],ZA=[{provide:Ch,useValue:"root"},{provide:$a,useFactory:function UV(){return new $a},deps:[]},{provide:iI,useClass:FV,multi:!0,deps:[Iu,Pn,Za]},{provide:iI,useClass:LV,multi:!0,deps:[Iu]},aI,UA,LA,{provide:EE,useExisting:aI},{provide:class Y7{},useClass:IV,deps:[]},[]];let qA=(()=>{class t{constructor(e){}static withServerTransition(e){return{ngModule:t,providers:[{provide:Bp,useValue:e.appId}]}}static#e=this.\u0275fac=function(i){return new(i||t)(Nn(VV,12))};static#t=this.\u0275mod=ga({type:t});static#n=this.\u0275inj=ha({providers:[...ZA,...YA],imports:[TA,q9]})}return t})(),QA=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=nn({token:t,factory:function(i){let r=null;return r=i?new(i||t):Nn($V),r},providedIn:"root"})}return t})(),$V=(()=>{class t extends QA{constructor(e){super(),this._doc=e}sanitize(e,i){if(null==i)return null;switch(e){case va.NONE:return i;case va.HTML:return Xa(i,"HTML")?qs(i):o1(this._doc,String(i)).toString();case va.STYLE:return Xa(i,"Style")?qs(i):i;case va.SCRIPT:if(Xa(i,"Script"))return qs(i);throw new mt(5200,!1);case va.URL:return Xa(i,"URL")?qs(i):Zp(String(i));case va.RESOURCE_URL:if(Xa(i,"ResourceURL"))return qs(i);throw new mt(5201,!1);default:throw new mt(5202,!1)}}bypassSecurityTrustHtml(e){return function ti(t){return new Dd(t)}(e)}bypassSecurityTrustStyle(e){return function Xv(t){return new Sw(t)}(e)}bypassSecurityTrustScript(e){return function ba(t){return new Mw(t)}(e)}bypassSecurityTrustUrl(e){return function Kv(t){return new Dw(t)}(e)}bypassSecurityTrustResourceUrl(e){return function Ow(t){return new kw(t)}(e)}static#e=this.\u0275fac=function(i){return new(i||t)(Nn(Iu))};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();me(4511);var uI=function(t,n){return(uI=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])})(t,n)};function Xl(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}uI(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}var qr=function(){return qr=Object.assign||function(n){for(var e,i=1,r=arguments.length;i<r;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n},qr.apply(this,arguments)};function He(t,n,e,i){var s,r=arguments.length,o=r<3?n:null===i?i=Object.getOwnPropertyDescriptor(n,e):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,n,e,i);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(n,e,o):s(n,e))||o);return r>3&&o&&Object.defineProperty(n,e,o),o}function Vd(t){return this instanceof Vd?(this.v=t,this):new Vd(t)}function iP(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=function hI(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],i=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(o){e[o]=t[o]&&function(s){return new Promise(function(a,c){!function r(o,s,a,c){Promise.resolve(c).then(function(u){o({value:u,done:a})},s)}(a,c,(s=t[o](s)).done,s.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const fI=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function rP(t){return Ae(t?.then)}function oP(t){return Ae(t[ro])}function sP(t){return Symbol.asyncIterator&&Ae(t?.[Symbol.asyncIterator])}function aP(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const lP=function hj(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function cP(t){return Ae(t?.[lP])}function uP(t){return function nP(t,n,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=e.apply(t,n||[]),o=[];return r={},a("next"),a("throw"),a("return",function s(x){return function(M){return Promise.resolve(M).then(x,b)}}),r[Symbol.asyncIterator]=function(){return this},r;function a(x,M){i[x]&&(r[x]=function(U){return new Promise(function(W,K){o.push([x,U,W,K])>1||c(x,U)})},M&&(r[x]=M(r[x])))}function c(x,M){try{!function u(x){x.value instanceof Vd?Promise.resolve(x.value.v).then(f,b):C(o[0][2],x)}(i[x](M))}catch(U){C(o[0][3],U)}}function f(x){c("next",x)}function b(x){c("throw",x)}function C(x,M){x(M),o.shift(),o.length&&c(o[0][0],o[0][1])}}(this,arguments,function*(){const e=t.getReader();try{for(;;){const{value:i,done:r}=yield Vd(e.read());if(r)return yield Vd(void 0);yield yield Vd(i)}}finally{e.releaseLock()}})}function dP(t){return Ae(t?.getReader)}function tl(t){if(t instanceof qi)return t;if(null!=t){if(oP(t))return function fj(t){return new qi(n=>{const e=t[ro]();if(Ae(e.subscribe))return e.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(fI(t))return function pj(t){return new qi(n=>{for(let e=0;e<t.length&&!n.closed;e++)n.next(t[e]);n.complete()})}(t);if(rP(t))return function gj(t){return new qi(n=>{t.then(e=>{n.closed||(n.next(e),n.complete())},e=>n.error(e)).then(null,Dt)})}(t);if(sP(t))return hP(t);if(cP(t))return function mj(t){return new qi(n=>{for(const e of t)if(n.next(e),n.closed)return;n.complete()})}(t);if(dP(t))return function _j(t){return hP(uP(t))}(t)}throw aP(t)}function hP(t){return new qi(n=>{(function bj(t,n){var e,i,r,o;return function eP(t,n,e,i){return new(e||(e=Promise))(function(o,s){function a(f){try{u(i.next(f))}catch(b){s(b)}}function c(f){try{u(i.throw(f))}catch(b){s(b)}}function u(f){f.done?o(f.value):function r(o){return o instanceof e?o:new e(function(s){s(o)})}(f.value).then(a,c)}u((i=i.apply(t,n||[])).next())})}(this,void 0,void 0,function*(){try{for(e=iP(t);!(i=yield e.next()).done;)if(n.next(i.value),n.closed)return}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=e.return)&&(yield o.call(e))}finally{if(r)throw r.error}}n.complete()})})(t,n).catch(e=>n.error(e))})}function jd(t,n,e,i=0,r=!1){const o=n.schedule(function(){e(),r?t.add(this.schedule(null,i)):this.unsubscribe()},i);if(t.add(o),!r)return o}function fP(t,n=0){return xo((e,i)=>{e.subscribe(oo(i,r=>jd(i,t,()=>i.next(r),n),()=>jd(i,t,()=>i.complete(),n),r=>jd(i,t,()=>i.error(r),n)))})}function pP(t,n=0){return xo((e,i)=>{i.add(t.schedule(()=>e.subscribe(i),n))})}function gP(t,n){if(!t)throw new Error("Iterable cannot be null");return new qi(e=>{jd(e,n,()=>{const i=t[Symbol.asyncIterator]();jd(e,n,()=>{i.next().then(r=>{r.done?e.complete():e.next(r.value)})},0,!0)})})}function ky(t,n){return n?function Ej(t,n){if(null!=t){if(oP(t))return function vj(t,n){return tl(t).pipe(pP(n),fP(n))}(t,n);if(fI(t))return function Cj(t,n){return new qi(e=>{let i=0;return n.schedule(function(){i===t.length?e.complete():(e.next(t[i++]),e.closed||this.schedule())})})}(t,n);if(rP(t))return function yj(t,n){return tl(t).pipe(pP(n),fP(n))}(t,n);if(sP(t))return gP(t,n);if(cP(t))return function xj(t,n){return new qi(e=>{let i;return jd(e,n,()=>{i=t[lP](),jd(e,n,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(s){return void e.error(s)}o?e.complete():e.next(r)},0,!0)}),()=>Ae(i?.return)&&i.return()})}(t,n);if(dP(t))return function wj(t,n){return gP(uP(t),n)}(t,n)}throw aP(t)}(t,n):tl(t)}const{isArray:Ij}=Array,{getPrototypeOf:Tj,prototype:Sj,keys:Mj}=Object;function mP(t){return t&&Ae(t.schedule)}function pI(t){return t[t.length-1]}function gI(t){return mP(pI(t))?t.pop():void 0}const{isArray:Pj}=Array;function mI(t){return Oo(n=>function Fj(t,n){return Pj(n)?t(...n):t(n)}(t,n))}function Nj(t,n){return t.reduce((e,i,r)=>(e[i]=n[r],e),{})}function Rj(...t){const n=function Oj(t){return Ae(pI(t))?t.pop():void 0}(t),{args:e,keys:i}=function Dj(t){if(1===t.length){const n=t[0];if(Ij(n))return{args:n,keys:null};if(function kj(t){return t&&"object"==typeof t&&Tj(t)===Sj}(n)){const e=Mj(n);return{args:e.map(i=>n[i]),keys:e}}}return{args:t,keys:null}}(t),r=new qi(o=>{const{length:s}=e;if(!s)return void o.complete();const a=new Array(s);let c=s,u=s;for(let f=0;f<s;f++){let b=!1;tl(e[f]).subscribe(oo(o,C=>{b||(b=!0,u--),a[f]=C},()=>c--,void 0,()=>{(!c||!b)&&(u||o.next(i?Nj(i,a):a),o.complete())}))}});return n?r.pipe(mI(n)):r}let _P=(()=>{class t{constructor(e,i){this._renderer=e,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Jh),Y(fr))};static#t=this.\u0275dir=Sn({type:t})}return t})(),df=(()=>{class t extends _P{static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=Ko(t)))(r||t)}})();static#t=this.\u0275dir=Sn({type:t,features:[tr]})}return t})();const Mc=new mn(""),Lj={provide:Mc,useExisting:be(()=>Ea),multi:!0};let Ea=(()=>{class t extends df{writeValue(e){this.setProperty("checked",e)}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=Ko(t)))(r||t)}})();static#t=this.\u0275dir=Sn({type:t,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(i,r){1&i&&he("change",function(s){return r.onChange(s.target.checked)})("blur",function(){return r.onTouched()})},features:[br([Lj]),tr]})}return t})();const Bj={provide:Mc,useExisting:be(()=>kr),multi:!0},bP=new mn("");let kr=(()=>{class t extends _P{constructor(e,i,r){super(e,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Uj(){const t=I0()?I0().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Jh),Y(fr),Y(bP,8))};static#t=this.\u0275dir=Sn({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){1&i&&he("input",function(s){return r._handleInput(s.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(s){return r._compositionEnd(s.target.value)})},features:[br([Bj]),tr]})}return t})();function Gd(t){return null==t||("string"==typeof t||Array.isArray(t))&&0===t.length}function vP(t){return null!=t&&"number"==typeof t.length}const Fs=new mn(""),Wd=new mn("");function xP(t){return Gd(t.value)?{required:!0}:null}function Oy(t){return null}function MP(t){return null!=t}function DP(t){return oy(t)?ky(t):t}function kP(t){let n={};return t.forEach(e=>{n=null!=e?{...n,...e}:n}),0===Object.keys(n).length?null:n}function OP(t,n){return n.map(e=>e(t))}function AP(t){return t.map(n=>function Hj(t){return!t.validate}(n)?n:e=>n.validate(e))}function _I(t){return null!=t?function PP(t){if(!t)return null;const n=t.filter(MP);return 0==n.length?null:function(e){return kP(OP(e,n))}}(AP(t)):null}function bI(t){return null!=t?function FP(t){if(!t)return null;const n=t.filter(MP);return 0==n.length?null:function(e){return Rj(OP(e,n).map(DP)).pipe(Oo(kP))}}(AP(t)):null}function NP(t,n){return null===t?[n]:Array.isArray(t)?[...t,n]:[t,n]}function vI(t){return t?Array.isArray(t)?t:[t]:[]}function Ay(t,n){return Array.isArray(t)?t.includes(n):t===n}function BP(t,n){const e=vI(n);return vI(t).forEach(r=>{Ay(e,r)||e.push(r)}),e}function UP(t,n){return vI(n).filter(e=>!Ay(t,e))}class zP{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=_I(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=bI(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n=void 0){this.control&&this.control.reset(n)}hasError(n,e){return!!this.control&&this.control.hasError(n,e)}getError(n,e){return this.control?this.control.getError(n,e):null}}class ta extends zP{get formDirective(){return null}get path(){return null}}class $d extends zP{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class HP{constructor(n){this._cd=n}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let Or=(()=>{class t extends HP{constructor(e){super(e)}static#e=this.\u0275fac=function(i){return new(i||t)(Y($d,2))};static#t=this.\u0275dir=Sn({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){2&i&&d0("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[tr]})}return t})(),hf=(()=>{class t extends HP{constructor(e){super(e)}static#e=this.\u0275fac=function(i){return new(i||t)(Y(ta,10))};static#t=this.\u0275dir=Sn({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,r){2&i&&d0("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[tr]})}return t})();const P0="VALID",Fy="INVALID",kg="PENDING",F0="DISABLED";function xI(t){return(Ny(t)?t.validators:t)||null}function wI(t,n){return(Ny(n)?n.asyncValidators:t)||null}function Ny(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class EI{constructor(n,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(n),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get valid(){return this.status===P0}get invalid(){return this.status===Fy}get pending(){return this.status==kg}get disabled(){return this.status===F0}get enabled(){return this.status!==F0}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._assignValidators(n)}setAsyncValidators(n){this._assignAsyncValidators(n)}addValidators(n){this.setValidators(BP(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(BP(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(UP(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(UP(n,this._rawAsyncValidators))}hasValidator(n){return Ay(this._rawValidators,n)}hasAsyncValidator(n){return Ay(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){this.touched=!0,this._parent&&!n.onlySelf&&this._parent.markAsTouched(n)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(n=>n.markAllAsTouched())}markAsUntouched(n={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}markAsDirty(n={}){this.pristine=!1,this._parent&&!n.onlySelf&&this._parent.markAsDirty(n)}markAsPristine(n={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}markAsPending(n={}){this.status=kg,!1!==n.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!n.onlySelf&&this._parent.markAsPending(n)}disable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=F0,this.errors=null,this._forEachChild(i=>{i.disable({...n,onlySelf:!0})}),this._updateValue(),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...n,skipPristineCheck:e}),this._onDisabledChange.forEach(i=>i(!0))}enable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=P0,this._forEachChild(i=>{i.enable({...n,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors({...n,skipPristineCheck:e}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(n){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===P0||this.status===kg)&&this._runAsyncValidator(n.emitEvent)),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(n)}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?F0:P0}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n){if(this.asyncValidator){this.status=kg,this._hasOwnPendingAsyncValidator=!0;const e=DP(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:n})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(n,e={}){this.errors=n,this._updateControlsErrors(!1!==e.emitEvent)}get(n){let e=n;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((i,r)=>i&&i._find(r),this)}getError(n,e){const i=e?this.get(e):this;return i&&i.errors?i.errors[n]:null}hasError(n,e){return!!this.getError(n,e)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(n)}_initObservables(){this.valueChanges=new ei,this.statusChanges=new ei}_calculateStatus(){return this._allControlsDisabled()?F0:this.errors?Fy:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(kg)?kg:this._anyControlsHaveStatus(Fy)?Fy:P0}_anyControlsHaveStatus(n){return this._anyControls(e=>e.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n={}){this.pristine=!this._anyControlsDirty(),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}_updateTouched(n={}){this.touched=this._anyControlsTouched(),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){Ny(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(n){return null}_assignValidators(n){this._rawValidators=Array.isArray(n)?n.slice():n,this._composedValidatorFn=function Wj(t){return Array.isArray(t)?_I(t):t||null}(this._rawValidators)}_assignAsyncValidators(n){this._rawAsyncValidators=Array.isArray(n)?n.slice():n,this._composedAsyncValidatorFn=function $j(t){return Array.isArray(t)?bI(t):t||null}(this._rawAsyncValidators)}}class II extends EI{constructor(n,e,i){super(xI(e),wI(i,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,e){return this.controls[n]?this.controls[n]:(this.controls[n]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(n,e,i={}){this.registerControl(n,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(n,e={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(n,e,i={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],e&&this.registerControl(n,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,e={}){(function GP(t,n,e){t._forEachChild((i,r)=>{if(void 0===e[r])throw new mt(1002,"")})})(this,0,n),Object.keys(n).forEach(i=>{(function jP(t,n,e){const i=t.controls;if(!(n?Object.keys(i):i).length)throw new mt(1e3,"");if(!i[e])throw new mt(1001,"")})(this,!0,i),this.controls[i].setValue(n[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){null!=n&&(Object.keys(n).forEach(i=>{const r=this.controls[i];r&&r.patchValue(n[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n={},e={}){this._forEachChild((i,r)=>{i.reset(n?n[r]:null,{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(n,e,i)=>(n[i]=e.getRawValue(),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(e,i)=>!!i._syncPendingControls()||e);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(e=>{const i=this.controls[e];i&&n(i,e)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(const[e,i]of Object.entries(this.controls))if(this.contains(e)&&n(i))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,i,r)=>((i.enabled||this.disabled)&&(e[r]=i.value),e))}_reduceChildren(n,e){let i=n;return this._forEachChild((r,o)=>{i=e(i,r,o)}),i}_allControlsDisabled(){for(const n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(n){return this.controls.hasOwnProperty(n)?this.controls[n]:null}}const Og=new mn("CallSetDisabledState",{providedIn:"root",factory:()=>Ry}),Ry="always";function N0(t,n,e=Ry){TI(t,n),n.valueAccessor.writeValue(t.value),(t.disabled||"always"===e)&&n.valueAccessor.setDisabledState?.(t.disabled),function qj(t,n){n.valueAccessor.registerOnChange(e=>{t._pendingValue=e,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&WP(t,n)})}(t,n),function Kj(t,n){const e=(i,r)=>{n.valueAccessor.writeValue(i),r&&n.viewToModelUpdate(i)};t.registerOnChange(e),n._registerOnDestroy(()=>{t._unregisterOnChange(e)})}(t,n),function Xj(t,n){n.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&WP(t,n),"submit"!==t.updateOn&&t.markAsTouched()})}(t,n),function Zj(t,n){if(n.valueAccessor.setDisabledState){const e=i=>{n.valueAccessor.setDisabledState(i)};t.registerOnDisabledChange(e),n._registerOnDestroy(()=>{t._unregisterOnDisabledChange(e)})}}(t,n)}function Uy(t,n){t.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(n)})}function TI(t,n){const e=function RP(t){return t._rawValidators}(t);null!==n.validator?t.setValidators(NP(e,n.validator)):"function"==typeof e&&t.setValidators([e]);const i=function LP(t){return t._rawAsyncValidators}(t);null!==n.asyncValidator?t.setAsyncValidators(NP(i,n.asyncValidator)):"function"==typeof i&&t.setAsyncValidators([i]);const r=()=>t.updateValueAndValidity();Uy(n._rawValidators,r),Uy(n._rawAsyncValidators,r)}function WP(t,n){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}const nG={provide:ta,useExisting:be(()=>Mu)},R0=Promise.resolve();let Mu=(()=>{class t extends ta{constructor(e,i,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._directives=new Set,this.ngSubmit=new ei,this.form=new II({},_I(e),bI(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){R0.then(()=>{const i=this._findContainer(e.path);e.control=i.registerControl(e.name,e.control),N0(e.control,e,this.callSetDisabledState),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){R0.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){R0.then(()=>{const i=this._findContainer(e.path),r=new II({});(function $P(t,n){TI(t,n)})(r,e),i.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){R0.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,i){R0.then(()=>{this.form.get(e.path).setValue(i)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,function YP(t,n){t._syncPendingControls(),n.forEach(e=>{const i=e.control;"submit"===i.updateOn&&i._pendingChange&&(e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}(this.form,this._directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Fs,10),Y(Wd,10),Y(Og,8))};static#t=this.\u0275dir=Sn({type:t,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,r){1&i&&he("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{options:[Ce.None,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[br([nG]),tr]})}return t})();function ZP(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}function qP(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}const XP=class extends EI{constructor(n=null,e,i){super(xI(e),wI(i,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Ny(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=qP(n)?n.value:n)}setValue(n,e={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(n,e={}){this.setValue(n,e)}reset(n=this.defaultValue,e={}){this._applyFormState(n),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){ZP(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){ZP(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){qP(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}},oG={provide:$d,useExisting:be(()=>Cr)},JP=Promise.resolve();let Cr=(()=>{class t extends $d{constructor(e,i,r,o,s,a){super(),this._changeDetectorRef=s,this.callSetDisabledState=a,this.control=new XP,this._registered=!1,this.name="",this.update=new ei,this._parent=e,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function DI(t,n){if(!n)return null;let e,i,r;return Array.isArray(n),n.forEach(o=>{o.constructor===kr?e=o:function eG(t){return Object.getPrototypeOf(t.constructor)===df}(o)?i=o:r=o}),r||i||e||null}(0,o)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const i=e.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),function MI(t,n){if(!t.hasOwnProperty("model"))return!1;const e=t.model;return!!e.isFirstChange()||!Object.is(n,e.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){N0(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){JP.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const i=e.isDisabled.currentValue,r=0!==i&&cf(i);JP.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?function Ly(t,n){return[...n.path,t]}(e,this._parent):[e]}static#e=this.\u0275fac=function(i){return new(i||t)(Y(ta,9),Y(Fs,10),Y(Wd,10),Y(Mc,10),Y(Zr,8),Y(Og,8))};static#t=this.\u0275dir=Sn({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[Ce.None,"disabled","isDisabled"],model:[Ce.None,"ngModel","model"],options:[Ce.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[br([oG]),tr,hr]})}return t})(),ff=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275dir=Sn({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}return t})();const sG={provide:Mc,useExisting:be(()=>yl),multi:!0};let yl=(()=>{class t extends df{writeValue(e){this.setProperty("value",e??"")}registerOnChange(e){this.onChange=i=>{e(""==i?null:parseFloat(i))}}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=Ko(t)))(r||t)}})();static#t=this.\u0275dir=Sn({type:t,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,r){1&i&&he("input",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},features:[br([sG]),tr]})}return t})();const aG={provide:Mc,useExisting:be(()=>Yd),multi:!0};let lG=(()=>{class t{constructor(){this._accessors=[]}add(e,i){this._accessors.push([e,i])}remove(e){for(let i=this._accessors.length-1;i>=0;--i)if(this._accessors[i][1]===e)return void this._accessors.splice(i,1)}select(e){this._accessors.forEach(i=>{this._isSameGroup(i,e)&&i[1]!==e&&i[1].fireUncheck(e.value)})}_isSameGroup(e,i){return!!e[0].control&&e[0]._parent===i._control._parent&&e[1].name===i.name}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Yd=(()=>{class t extends df{constructor(e,i,r,o){super(e,i),this._registry=r,this._injector=o,this.setDisabledStateFired=!1,this.onChange=()=>{},this.callSetDisabledState=kn(Og,{optional:!0})??Ry}ngOnInit(){this._control=this._injector.get($d),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(e){this._state=e===this.value,this.setProperty("checked",this._state)}registerOnChange(e){this._fn=e,this.onChange=()=>{e(this.value),this._registry.select(this)}}setDisabledState(e){(this.setDisabledStateFired||e||"whenDisabledForLegacyCode"===this.callSetDisabledState)&&this.setProperty("disabled",e),this.setDisabledStateFired=!0}fireUncheck(e){this.writeValue(e)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Jh),Y(fr),Y(lG),Y(hs))};static#t=this.\u0275dir=Sn({type:t,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(i,r){1&i&&he("change",function(){return r.onChange()})("blur",function(){return r.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[br([aG]),tr]})}return t})();const cG={provide:Mc,useExisting:be(()=>Cl),multi:!0};let Cl=(()=>{class t extends df{writeValue(e){this.setProperty("value",parseFloat(e))}registerOnChange(e){this.onChange=i=>{e(""==i?null:parseFloat(i))}}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=Ko(t)))(r||t)}})();static#t=this.\u0275dir=Sn({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(i,r){1&i&&he("change",function(s){return r.onChange(s.target.value)})("input",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},features:[br([cG]),tr]})}return t})();const gG={provide:Mc,useExisting:be(()=>Ia),multi:!0};function rF(t,n){return null==t?`${n}`:(n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let Ia=(()=>{class t extends df{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const r=rF(this._getOptionId(e),e);this.setProperty("value",r)}registerOnChange(e){this.onChange=i=>{this.value=this._getOptionValue(i),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),e))return i;return null}_getOptionValue(e){const i=function mG(t){return t.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i):e}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=Ko(t)))(r||t)}})();static#t=this.\u0275dir=Sn({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,r){1&i&&he("change",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[br([gG]),tr]})}return t})(),na=(()=>{class t{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(rF(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static#e=this.\u0275fac=function(i){return new(i||t)(Y(fr),Y(Jh),Y(Ia,9))};static#t=this.\u0275dir=Sn({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}return t})();const _G={provide:Mc,useExisting:be(()=>PI),multi:!0};function oF(t,n){return null==t?`${n}`:("string"==typeof n&&(n=`'${n}'`),n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let PI=(()=>{class t extends df{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let i;if(this.value=e,Array.isArray(e)){const r=e.map(o=>this._getOptionId(o));i=(o,s)=>{o._setSelected(r.indexOf(s.toString())>-1)}}else i=(r,o)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(e){this.onChange=i=>{const r=[],o=i.selectedOptions;if(void 0!==o){const s=o;for(let a=0;a<s.length;a++){const u=this._getOptionValue(s[a].value);r.push(u)}}else{const s=i.options;for(let a=0;a<s.length;a++){const c=s[a];if(c.selected){const u=this._getOptionValue(c.value);r.push(u)}}}this.value=r,e(r)}}_registerOption(e){const i=(this._idCounter++).toString();return this._optionMap.set(i,e),i}_getOptionId(e){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,e))return i;return null}_getOptionValue(e){const i=function bG(t){return t.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i)._value:e}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=Ko(t)))(r||t)}})();static#t=this.\u0275dir=Sn({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,r){1&i&&he("change",function(s){return r.onChange(s.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[br([_G]),tr]})}return t})(),ia=(()=>{class t{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(oF(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(oF(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static#e=this.\u0275fac=function(i){return new(i||t)(Y(fr),Y(Jh),Y(PI,9))};static#t=this.\u0275dir=Sn({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}return t})();function sF(t){return"number"==typeof t?t:parseInt(t,10)}function aF(t){return"number"==typeof t?t:parseFloat(t)}let pf=(()=>{class t{constructor(){this._validator=Oy}ngOnChanges(e){if(this.inputName in e){const i=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):Oy,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275dir=Sn({type:t,features:[hr]})}return t})();const vG={provide:Fs,useExisting:be(()=>Du),multi:!0};let Du=(()=>{class t extends pf{constructor(){super(...arguments),this.inputName="max",this.normalizeInput=e=>aF(e),this.createValidator=e=>function CP(t){return n=>{if(Gd(n.value)||Gd(t))return null;const e=parseFloat(n.value);return!isNaN(e)&&e>t?{max:{max:t,actual:n.value}}:null}}(e)}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=Ko(t)))(r||t)}})();static#t=this.\u0275dir=Sn({type:t,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(i,r){2&i&&en("max",r._enabled?r.max:null)},inputs:{max:"max"},features:[br([vG]),tr]})}return t})();const yG={provide:Fs,useExisting:be(()=>ku),multi:!0};let ku=(()=>{class t extends pf{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=e=>aF(e),this.createValidator=e=>function yP(t){return n=>{if(Gd(n.value)||Gd(t))return null;const e=parseFloat(n.value);return!isNaN(e)&&e<t?{min:{min:t,actual:n.value}}:null}}(e)}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=Ko(t)))(r||t)}})();static#t=this.\u0275dir=Sn({type:t,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(i,r){2&i&&en("min",r._enabled?r.min:null)},inputs:{min:"min"},features:[br([yG]),tr]})}return t})();const CG={provide:Fs,useExisting:be(()=>Hy),multi:!0};let Hy=(()=>{class t extends pf{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=cf,this.createValidator=e=>xP}enabled(e){return e}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=Ko(t)))(r||t)}})();static#t=this.\u0275dir=Sn({type:t,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(i,r){2&i&&en("required",r._enabled?"":null)},inputs:{required:"required"},features:[br([CG]),tr]})}return t})();const EG={provide:Fs,useExisting:be(()=>FI),multi:!0};let FI=(()=>{class t extends pf{constructor(){super(...arguments),this.inputName="minlength",this.normalizeInput=e=>sF(e),this.createValidator=e=>function IP(t){return n=>Gd(n.value)||!vP(n.value)?null:n.value.length<t?{minlength:{requiredLength:t,actualLength:n.value.length}}:null}(e)}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=Ko(t)))(r||t)}})();static#t=this.\u0275dir=Sn({type:t,selectors:[["","minlength","","formControlName",""],["","minlength","","formControl",""],["","minlength","","ngModel",""]],hostVars:1,hostBindings:function(i,r){2&i&&en("minlength",r._enabled?r.minlength:null)},inputs:{minlength:"minlength"},features:[br([EG]),tr]})}return t})();const IG={provide:Fs,useExisting:be(()=>NI),multi:!0};let NI=(()=>{class t extends pf{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=e=>sF(e),this.createValidator=e=>function TP(t){return n=>vP(n.value)&&n.value.length>t?{maxlength:{requiredLength:t,actualLength:n.value.length}}:null}(e)}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=Ko(t)))(r||t)}})();static#t=this.\u0275dir=Sn({type:t,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(i,r){2&i&&en("maxlength",r._enabled?r.maxlength:null)},inputs:{maxlength:"maxlength"},features:[br([IG]),tr]})}return t})(),SG=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ga({type:t});static#n=this.\u0275inj=ha({})}return t})(),DG=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:Og,useValue:e.callSetDisabledState??Ry}]}}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ga({type:t});static#n=this.\u0275inj=ha({imports:[SG]})}return t})();var Vn=function(t){return t[t.State=0]="State",t[t.Transition=1]="Transition",t[t.Sequence=2]="Sequence",t[t.Group=3]="Group",t[t.Animate=4]="Animate",t[t.Keyframes=5]="Keyframes",t[t.Style=6]="Style",t[t.Trigger=7]="Trigger",t[t.Reference=8]="Reference",t[t.AnimateChild=9]="AnimateChild",t[t.AnimateRef=10]="AnimateRef",t[t.Query=11]="Query",t[t.Stagger=12]="Stagger",t}(Vn||{});const Ou="*";function Xn(t,n){return{type:Vn.Trigger,name:t,definitions:n,options:{}}}function rn(t,n=null){return{type:Vn.Animate,styles:n,timings:t}}function We(t){return{type:Vn.Style,styles:t,offset:null}}function RI(t,n,e){return{type:Vn.State,name:t,styles:n,options:e}}function En(t){return{type:Vn.Keyframes,steps:t}}function an(t,n,e=null){return{type:Vn.Transition,expr:t,animation:n,options:e}}class L0{constructor(n=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=n+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(n=>n()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(n){this._position=this.totalTime?n*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class dF{constructor(n){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=n;let e=0,i=0,r=0;const o=this.players.length;0==o?queueMicrotask(()=>this._onFinish()):this.players.forEach(s=>{s.onDone(()=>{++e==o&&this._onFinish()}),s.onDestroy(()=>{++i==o&&this._onDestroy()}),s.onStart(()=>{++r==o&&this._onStart()})}),this.totalTime=this.players.reduce((s,a)=>Math.max(s,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this.players.forEach(n=>n.init())}onStart(n){this._onStartFns.push(n)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(n=>n()),this._onStartFns=[])}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(n=>n.play())}pause(){this.players.forEach(n=>n.pause())}restart(){this.players.forEach(n=>n.restart())}finish(){this._onFinish(),this.players.forEach(n=>n.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(n=>n.destroy()),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this.players.forEach(n=>n.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(n){const e=n*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,e/i.totalTime):1;i.setPosition(r)})}getPosition(){const n=this.players.reduce((e,i)=>null===e||i.totalTime>e.totalTime?i:e,null);return null!=n?n.getPosition():0}beforeDestroy(){this.players.forEach(n=>{n.beforeDestroy&&n.beforeDestroy()})}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}function hF(t){return new mt(3e3,!1)}function Zd(t){switch(t.length){case 0:return new L0;case 1:return t[0];default:return new dF(t)}}function fF(t,n,e=new Map,i=new Map){const r=[],o=[];let s=-1,a=null;if(n.forEach(c=>{const u=c.get("offset"),f=u==s,b=f&&a||new Map;c.forEach((C,x)=>{let M=x,U=C;if("offset"!==x)switch(M=t.normalizePropertyName(M,r),U){case"!":U=e.get(x);break;case Ou:U=i.get(x);break;default:U=t.normalizeStyleValue(x,M,U,r)}b.set(M,U)}),f||o.push(b),a=b,s=u}),r.length)throw function iW(t){return new mt(3502,!1)}();return o}function BI(t,n,e,i){switch(n){case"start":t.onStart(()=>i(e&&UI(e,"start",t)));break;case"done":t.onDone(()=>i(e&&UI(e,"done",t)));break;case"destroy":t.onDestroy(()=>i(e&&UI(e,"destroy",t)))}}function UI(t,n,e){const o=zI(t.element,t.triggerName,t.fromState,t.toState,n||t.phaseName,e.totalTime??t.totalTime,!!e.disabled),s=t._data;return null!=s&&(o._data=s),o}function zI(t,n,e,i,r="",o=0,s){return{element:t,triggerName:n,fromState:e,toState:i,phaseName:r,totalTime:o,disabled:!!s}}function nl(t,n,e){let i=t.get(n);return i||t.set(n,i=e),i}function pF(t){const n=t.indexOf(":");return[t.substring(1,n),t.slice(n+1)]}const gW=typeof document>"u"?null:document.documentElement;function HI(t){const n=t.parentNode||t.host||null;return n===gW?null:n}let gf=null,gF=!1;function mF(t,n){for(;n;){if(n===t)return!0;n=HI(n)}return!1}function _F(t,n,e){if(e)return Array.from(t.querySelectorAll(n));const i=t.querySelector(n);return i?[i]:[]}let VI=(()=>{class t{validateStyleProperty(e){return function _W(t){gf||(gf=function bW(){return typeof document<"u"?document.body:null}()||{},gF=!!gf.style&&"WebkitAppearance"in gf.style);let n=!0;return gf.style&&!function mW(t){return"ebkit"==t.substring(1,6)}(t)&&(n=t in gf.style,!n&&gF&&(n="Webkit"+t.charAt(0).toUpperCase()+t.slice(1)in gf.style)),n}(e)}matchesElement(e,i){return!1}containsElement(e,i){return mF(e,i)}getParentElement(e){return HI(e)}query(e,i,r){return _F(e,i,r)}computeStyle(e,i,r){return r||""}animate(e,i,r,o,s,a=[],c){return new L0(r,o)}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac})}return t})();class jI{static#e=this.NOOP=new VI}class GI{}const yW=1e3,WI="ng-enter",Vy="ng-leave",jy="ng-trigger",Gy=".ng-trigger",vF="ng-animating",$I=".ng-animating";function Au(t){if("number"==typeof t)return t;const n=t.match(/^(-?[\.\d]+)(m?s)/);return!n||n.length<2?0:YI(parseFloat(n[1]),n[2])}function YI(t,n){return"s"===n?t*yW:t}function Wy(t,n,e){return t.hasOwnProperty("duration")?t:function xW(t,n,e){let r,o=0,s="";if("string"==typeof t){const a=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return n.push(hF()),{duration:0,delay:0,easing:""};r=YI(parseFloat(a[1]),a[2]);const c=a[3];null!=c&&(o=YI(parseFloat(c),a[4]));const u=a[5];u&&(s=u)}else r=t;if(!e){let a=!1,c=n.length;r<0&&(n.push(function NG(){return new mt(3100,!1)}()),a=!0),o<0&&(n.push(function RG(){return new mt(3101,!1)}()),a=!0),a&&n.splice(c,0,hF())}return{duration:r,delay:o,easing:s}}(t,n,e)}function Dc(t,n,e){n.forEach((i,r)=>{const o=qI(r);e&&!e.has(r)&&e.set(r,t.style[o]),t.style[o]=i})}function mf(t,n){n.forEach((e,i)=>{const r=qI(i);t.style[r]=""})}function B0(t){return Array.isArray(t)?1==t.length?t[0]:function kG(t,n=null){return{type:Vn.Sequence,steps:t,options:n}}(t):t}const ZI=new RegExp("{{\\s*(.+?)\\s*}}","g");function CF(t){let n=[];if("string"==typeof t){let e;for(;e=ZI.exec(t);)n.push(e[1]);ZI.lastIndex=0}return n}function U0(t,n,e){const i=`${t}`,r=i.replace(ZI,(o,s)=>{let a=n[s];return null==a&&(e.push(function BG(t){return new mt(3003,!1)}()),a=""),a.toString()});return r==i?t:r}const IW=/-+([a-z0-9])/g;function qI(t){return t.replace(IW,(...n)=>n[1].toUpperCase())}function il(t,n,e){switch(n.type){case Vn.Trigger:return t.visitTrigger(n,e);case Vn.State:return t.visitState(n,e);case Vn.Transition:return t.visitTransition(n,e);case Vn.Sequence:return t.visitSequence(n,e);case Vn.Group:return t.visitGroup(n,e);case Vn.Animate:return t.visitAnimate(n,e);case Vn.Keyframes:return t.visitKeyframes(n,e);case Vn.Style:return t.visitStyle(n,e);case Vn.Reference:return t.visitReference(n,e);case Vn.AnimateChild:return t.visitAnimateChild(n,e);case Vn.AnimateRef:return t.visitAnimateRef(n,e);case Vn.Query:return t.visitQuery(n,e);case Vn.Stagger:return t.visitStagger(n,e);default:throw function UG(t){return new mt(3004,!1)}()}}function XI(t,n){return window.getComputedStyle(t)[n]}const MW=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class xF extends GI{normalizePropertyName(n,e){return qI(n)}normalizeStyleValue(n,e,i,r){let o="";const s=i.toString().trim();if(MW.has(e)&&0!==i&&"0"!==i)if("number"==typeof i)o="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function zG(t,n){return new mt(3005,!1)}())}return s+o}}const $y="*";const Yy=new Set(["true","1"]),Zy=new Set(["false","0"]);function wF(t,n){const e=Yy.has(t)||Zy.has(t),i=Yy.has(n)||Zy.has(n);return(r,o)=>{let s=t==$y||t==r,a=n==$y||n==o;return!s&&e&&"boolean"==typeof r&&(s=r?Yy.has(t):Zy.has(t)),!a&&i&&"boolean"==typeof o&&(a=o?Yy.has(n):Zy.has(n)),s&&a}}const AW=new RegExp("s*:selfs*,?","g");function KI(t,n,e,i){return new PW(t).build(n,e,i)}class PW{constructor(n){this._driver=n}build(n,e,i){const r=new RW(e);return this._resetContextStyleTimingState(r),il(this,B0(n),r)}_resetContextStyleTimingState(n){n.currentQuerySelector="",n.collectedStyles=new Map,n.collectedStyles.set("",new Map),n.currentTime=0}visitTrigger(n,e){let i=e.queryCount=0,r=e.depCount=0;const o=[],s=[];return"@"==n.name.charAt(0)&&e.errors.push(function HG(){return new mt(3006,!1)}()),n.definitions.forEach(a=>{if(this._resetContextStyleTimingState(e),a.type==Vn.State){const c=a,u=c.name;u.toString().split(/\s*,\s*/).forEach(f=>{c.name=f,o.push(this.visitState(c,e))}),c.name=u}else if(a.type==Vn.Transition){const c=this.visitTransition(a,e);i+=c.queryCount,r+=c.depCount,s.push(c)}else e.errors.push(function VG(){return new mt(3007,!1)}())}),{type:Vn.Trigger,name:n.name,states:o,transitions:s,queryCount:i,depCount:r,options:null}}visitState(n,e){const i=this.visitStyle(n.styles,e),r=n.options&&n.options.params||null;if(i.containsDynamicStyles){const o=new Set,s=r||{};i.styles.forEach(a=>{a instanceof Map&&a.forEach(c=>{CF(c).forEach(u=>{s.hasOwnProperty(u)||o.add(u)})})}),o.size&&e.errors.push(function jG(t,n){return new mt(3008,!1)}(0,o.values()))}return{type:Vn.State,name:n.name,style:i,options:r?{params:r}:null}}visitTransition(n,e){e.queryCount=0,e.depCount=0;const i=il(this,B0(n.animation),e),r=function DW(t,n){const e=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(i=>function kW(t,n,e){if(":"==t[0]){const c=function OW(t,n){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,i)=>parseFloat(i)>parseFloat(e);case":decrement":return(e,i)=>parseFloat(i)<parseFloat(e);default:return n.push(function JG(t){return new mt(3016,!1)}()),"* => *"}}(t,e);if("function"==typeof c)return void n.push(c);t=c}const i=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return e.push(function QG(t){return new mt(3015,!1)}()),n;const r=i[1],o=i[2],s=i[3];n.push(wF(r,s)),"<"==o[0]&&(r!=$y||s!=$y)&&n.push(wF(s,r))}(i,e,n)):e.push(t),e}(n.expr,e.errors);return{type:Vn.Transition,matchers:r,animation:i,queryCount:e.queryCount,depCount:e.depCount,options:_f(n.options)}}visitSequence(n,e){return{type:Vn.Sequence,steps:n.steps.map(i=>il(this,i,e)),options:_f(n.options)}}visitGroup(n,e){const i=e.currentTime;let r=0;const o=n.steps.map(s=>{e.currentTime=i;const a=il(this,s,e);return r=Math.max(r,e.currentTime),a});return e.currentTime=r,{type:Vn.Group,steps:o,options:_f(n.options)}}visitAnimate(n,e){const i=function BW(t,n){if(t.hasOwnProperty("duration"))return t;if("number"==typeof t)return QI(Wy(t,n).duration,0,"");const e=t;if(e.split(/\s+/).some(o=>"{"==o.charAt(0)&&"{"==o.charAt(1))){const o=QI(0,0,"");return o.dynamic=!0,o.strValue=e,o}const r=Wy(e,n);return QI(r.duration,r.delay,r.easing)}(n.timings,e.errors);e.currentAnimateTimings=i;let r,o=n.styles?n.styles:We({});if(o.type==Vn.Keyframes)r=this.visitKeyframes(o,e);else{let s=n.styles,a=!1;if(!s){a=!0;const u={};i.easing&&(u.easing=i.easing),s=We(u)}e.currentTime+=i.duration+i.delay;const c=this.visitStyle(s,e);c.isEmptyStep=a,r=c}return e.currentAnimateTimings=null,{type:Vn.Animate,timings:i,style:r,options:null}}visitStyle(n,e){const i=this._makeStyleAst(n,e);return this._validateStyleAst(i,e),i}_makeStyleAst(n,e){const i=[],r=Array.isArray(n.styles)?n.styles:[n.styles];for(let a of r)"string"==typeof a?a===Ou?i.push(a):e.errors.push(new mt(3002,!1)):i.push(new Map(Object.entries(a)));let o=!1,s=null;return i.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(s=a.get("easing"),a.delete("easing")),!o))for(let c of a.values())if(c.toString().indexOf("{{")>=0){o=!0;break}}),{type:Vn.Style,styles:i,easing:s,offset:n.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(n,e){const i=e.currentAnimateTimings;let r=e.currentTime,o=e.currentTime;i&&o>0&&(o-=i.duration+i.delay),n.styles.forEach(s=>{"string"!=typeof s&&s.forEach((a,c)=>{const u=e.collectedStyles.get(e.currentQuerySelector),f=u.get(c);let b=!0;f&&(o!=r&&o>=f.startTime&&r<=f.endTime&&(e.errors.push(function WG(t,n,e,i,r){return new mt(3010,!1)}()),b=!1),o=f.startTime),b&&u.set(c,{startTime:o,endTime:r}),e.options&&function EW(t,n,e){const i=n.params||{},r=CF(t);r.length&&r.forEach(o=>{i.hasOwnProperty(o)||e.push(function LG(t){return new mt(3001,!1)}())})}(a,e.options,e.errors)})})}visitKeyframes(n,e){const i={type:Vn.Keyframes,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function $G(){return new mt(3011,!1)}()),i;let o=0;const s=[];let a=!1,c=!1,u=0;const f=n.steps.map(K=>{const $=this._makeStyleAst(K,e);let ge=null!=$.offset?$.offset:function LW(t){if("string"==typeof t)return null;let n=null;if(Array.isArray(t))t.forEach(e=>{if(e instanceof Map&&e.has("offset")){const i=e;n=parseFloat(i.get("offset")),i.delete("offset")}});else if(t instanceof Map&&t.has("offset")){const e=t;n=parseFloat(e.get("offset")),e.delete("offset")}return n}($.styles),ye=0;return null!=ge&&(o++,ye=$.offset=ge),c=c||ye<0||ye>1,a=a||ye<u,u=ye,s.push(ye),$});c&&e.errors.push(function YG(){return new mt(3012,!1)}()),a&&e.errors.push(function ZG(){return new mt(3200,!1)}());const b=n.steps.length;let C=0;o>0&&o<b?e.errors.push(function qG(){return new mt(3202,!1)}()):0==o&&(C=1/(b-1));const x=b-1,M=e.currentTime,U=e.currentAnimateTimings,W=U.duration;return f.forEach((K,$)=>{const ge=C>0?$==x?1:C*$:s[$],ye=ge*W;e.currentTime=M+U.delay+ye,U.duration=ye,this._validateStyleAst(K,e),K.offset=ge,i.styles.push(K)}),i}visitReference(n,e){return{type:Vn.Reference,animation:il(this,B0(n.animation),e),options:_f(n.options)}}visitAnimateChild(n,e){return e.depCount++,{type:Vn.AnimateChild,options:_f(n.options)}}visitAnimateRef(n,e){return{type:Vn.AnimateRef,animation:this.visitReference(n.animation,e),options:_f(n.options)}}visitQuery(n,e){const i=e.currentQuerySelector,r=n.options||{};e.queryCount++,e.currentQuery=n;const[o,s]=function FW(t){const n=!!t.split(/\s*,\s*/).find(e=>":self"==e);return n&&(t=t.replace(AW,"")),t=t.replace(/@\*/g,Gy).replace(/@\w+/g,e=>Gy+"-"+e.slice(1)).replace(/:animating/g,$I),[t,n]}(n.selector);e.currentQuerySelector=i.length?i+" "+o:o,nl(e.collectedStyles,e.currentQuerySelector,new Map);const a=il(this,B0(n.animation),e);return e.currentQuery=null,e.currentQuerySelector=i,{type:Vn.Query,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:s,animation:a,originalSelector:n.selector,options:_f(n.options)}}visitStagger(n,e){e.currentQuery||e.errors.push(function XG(){return new mt(3013,!1)}());const i="full"===n.timings?{duration:0,delay:0,easing:"full"}:Wy(n.timings,e.errors,!0);return{type:Vn.Stagger,animation:il(this,B0(n.animation),e),timings:i,options:null}}}class RW{constructor(n){this.errors=n,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function _f(t){return t?(t={...t}).params&&(t.params=function NW(t){return t?{...t}:null}(t.params)):t={},t}function QI(t,n,e){return{duration:t,delay:n,easing:e}}function JI(t,n,e,i,r,o,s=null,a=!1){return{type:1,element:t,keyframes:n,preStyleProps:e,postStyleProps:i,duration:r,delay:o,totalTime:r+o,easing:s,subTimeline:a}}class qy{constructor(){this._map=new Map}get(n){return this._map.get(n)||[]}append(n,e){let i=this._map.get(n);i||this._map.set(n,i=[]),i.push(...e)}has(n){return this._map.has(n)}clear(){this._map.clear()}}const HW=new RegExp(":enter","g"),jW=new RegExp(":leave","g");function eT(t,n,e,i,r,o=new Map,s=new Map,a,c,u=[]){return(new GW).buildKeyframes(t,n,e,i,r,o,s,a,c,u)}class GW{buildKeyframes(n,e,i,r,o,s,a,c,u,f=[]){u=u||new qy;const b=new tT(n,e,u,r,o,f,[]);b.options=c;const C=c.delay?Au(c.delay):0;b.currentTimeline.delayNextStep(C),b.currentTimeline.setStyles([s],null,b.errors,c),il(this,i,b);const x=b.timelines.filter(M=>M.containsAnimation());if(x.length&&a.size){let M;for(let U=x.length-1;U>=0;U--){const W=x[U];if(W.element===e){M=W;break}}M&&!M.allowOnlyTimelineStyles()&&M.setStyles([a],null,b.errors,c)}return x.length?x.map(M=>M.buildKeyframes()):[JI(e,[],[],[],0,C,"",!1)]}visitTrigger(n,e){}visitState(n,e){}visitTransition(n,e){}visitAnimateChild(n,e){const i=e.subInstructions.get(e.element);if(i){const r=e.createSubContext(n.options),o=e.currentTimeline.currentTime,s=this._visitSubInstructions(i,r,r.options);o!=s&&e.transformIntoNewTimeline(s)}e.previousNode=n}visitAnimateRef(n,e){const i=e.createSubContext(n.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([n.options,n.animation.options],e,i),this.visitReference(n.animation,i),e.transformIntoNewTimeline(i.currentTimeline.currentTime),e.previousNode=n}_applyAnimationRefDelays(n,e,i){for(const r of n){const o=r?.delay;if(o){const s="number"==typeof o?o:Au(U0(o,r?.params??{},e.errors));i.delayNextStep(s)}}}_visitSubInstructions(n,e,i){let o=e.currentTimeline.currentTime;const s=null!=i.duration?Au(i.duration):null,a=null!=i.delay?Au(i.delay):null;return 0!==s&&n.forEach(c=>{const u=e.appendInstructionToTimeline(c,s,a);o=Math.max(o,u.duration+u.delay)}),o}visitReference(n,e){e.updateOptions(n.options,!0),il(this,n.animation,e),e.previousNode=n}visitSequence(n,e){const i=e.subContextCount;let r=e;const o=n.options;if(o&&(o.params||o.delay)&&(r=e.createSubContext(o),r.transformIntoNewTimeline(),null!=o.delay)){r.previousNode.type==Vn.Style&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Xy);const s=Au(o.delay);r.delayNextStep(s)}n.steps.length&&(n.steps.forEach(s=>il(this,s,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),e.previousNode=n}visitGroup(n,e){const i=[];let r=e.currentTimeline.currentTime;const o=n.options&&n.options.delay?Au(n.options.delay):0;n.steps.forEach(s=>{const a=e.createSubContext(n.options);o&&a.delayNextStep(o),il(this,s,a),r=Math.max(r,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(s=>e.currentTimeline.mergeTimelineCollectedStyles(s)),e.transformIntoNewTimeline(r),e.previousNode=n}_visitTiming(n,e){if(n.dynamic){const i=n.strValue;return Wy(e.params?U0(i,e.params,e.errors):i,e.errors)}return{duration:n.duration,delay:n.delay,easing:n.easing}}visitAnimate(n,e){const i=e.currentAnimateTimings=this._visitTiming(n.timings,e),r=e.currentTimeline;i.delay&&(e.incrementTime(i.delay),r.snapshotCurrentStyles());const o=n.style;o.type==Vn.Keyframes?this.visitKeyframes(o,e):(e.incrementTime(i.duration),this.visitStyle(o,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=n}visitStyle(n,e){const i=e.currentTimeline,r=e.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const o=r&&r.easing||n.easing;n.isEmptyStep?i.applyEmptyStep(o):i.setStyles(n.styles,o,e.errors,e.options),e.previousNode=n}visitKeyframes(n,e){const i=e.currentAnimateTimings,r=e.currentTimeline.duration,o=i.duration,a=e.createSubContext().currentTimeline;a.easing=i.easing,n.styles.forEach(c=>{a.forwardTime((c.offset||0)*o),a.setStyles(c.styles,c.easing,e.errors,e.options),a.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(a),e.transformIntoNewTimeline(r+o),e.previousNode=n}visitQuery(n,e){const i=e.currentTimeline.currentTime,r=n.options||{},o=r.delay?Au(r.delay):0;o&&(e.previousNode.type===Vn.Style||0==i&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=Xy);let s=i;const a=e.invokeQuery(n.selector,n.originalSelector,n.limit,n.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=a.length;let c=null;a.forEach((u,f)=>{e.currentQueryIndex=f;const b=e.createSubContext(n.options,u);o&&b.delayNextStep(o),u===e.element&&(c=b.currentTimeline),il(this,n.animation,b),b.currentTimeline.applyStylesToKeyframe(),s=Math.max(s,b.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(s),c&&(e.currentTimeline.mergeTimelineCollectedStyles(c),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=n}visitStagger(n,e){const i=e.parentContext,r=e.currentTimeline,o=n.timings,s=Math.abs(o.duration),a=s*(e.currentQueryTotal-1);let c=s*e.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":c=a-c;break;case"full":c=i.currentStaggerTime}const f=e.currentTimeline;c&&f.delayNextStep(c);const b=f.currentTime;il(this,n.animation,e),e.previousNode=n,i.currentStaggerTime=r.currentTime-b+(r.startTime-i.currentTimeline.startTime)}}const Xy={};class tT{constructor(n,e,i,r,o,s,a,c){this._driver=n,this.element=e,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=o,this.errors=s,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Xy,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=c||new Ky(this._driver,e,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(n,e){if(!n)return;const i=n;let r=this.options;null!=i.duration&&(r.duration=Au(i.duration)),null!=i.delay&&(r.delay=Au(i.delay));const o=i.params;if(o){let s=r.params;s||(s=this.options.params={}),Object.keys(o).forEach(a=>{(!e||!s.hasOwnProperty(a))&&(s[a]=U0(o[a],s,this.errors))})}}_copyOptions(){const n={};if(this.options){const e=this.options.params;if(e){const i=n.params={};Object.keys(e).forEach(r=>{i[r]=e[r]})}}return n}createSubContext(n=null,e,i){const r=e||this.element,o=new tT(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(n),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(n){return this.previousNode=Xy,this.currentTimeline=this.currentTimeline.fork(this.element,n),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(n,e,i){const r={duration:e??n.duration,delay:this.currentTimeline.currentTime+(i??0)+n.delay,easing:""},o=new WW(this._driver,n.element,n.keyframes,n.preStyleProps,n.postStyleProps,r,n.stretchStartingKeyframe);return this.timelines.push(o),r}incrementTime(n){this.currentTimeline.forwardTime(this.currentTimeline.duration+n)}delayNextStep(n){n>0&&this.currentTimeline.delayNextStep(n)}invokeQuery(n,e,i,r,o,s){let a=[];if(r&&a.push(this.element),n.length>0){n=(n=n.replace(HW,"."+this._enterClassName)).replace(jW,"."+this._leaveClassName);let u=this._driver.query(this.element,n,1!=i);0!==i&&(u=i<0?u.slice(u.length+i,u.length):u.slice(0,i)),a.push(...u)}return!o&&0==a.length&&s.push(function KG(t){return new mt(3014,!1)}()),a}}class Ky{constructor(n,e,i,r){this._driver=n,this.element=e,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(n){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+n),e&&this.snapshotCurrentStyles()):this.startTime+=n}fork(n,e){return this.applyStylesToKeyframe(),new Ky(this._driver,n,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(n){this.applyStylesToKeyframe(),this.duration=n,this._loadKeyframe()}_updateStyle(n,e){this._localTimelineStyles.set(n,e),this._globalTimelineStyles.set(n,e),this._styleSummary.set(n,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(n){n&&this._previousKeyframe.set("easing",n);for(let[e,i]of this._globalTimelineStyles)this._backFill.set(e,i||Ou),this._currentKeyframe.set(e,Ou);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(n,e,i,r){e&&this._previousKeyframe.set("easing",e);const o=r&&r.params||{},s=function $W(t,n){const e=new Map;let i;return t.forEach(r=>{if("*"===r){i??=n.keys();for(let o of i)e.set(o,Ou)}else for(let[o,s]of r)e.set(o,s)}),e}(n,this._globalTimelineStyles);for(let[a,c]of s){const u=U0(c,o,i);this._pendingStyles.set(a,u),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??Ou),this._updateStyle(a,u)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((n,e)=>{this._currentKeyframe.set(e,n)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((n,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,n)}))}snapshotCurrentStyles(){for(let[n,e]of this._localTimelineStyles)this._pendingStyles.set(n,e),this._updateStyle(n,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const n=[];for(let e in this._currentKeyframe)n.push(e);return n}mergeTimelineCollectedStyles(n){n._styleSummary.forEach((e,i)=>{const r=this._styleSummary.get(i);(!r||e.time>r.time)&&this._updateStyle(i,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const n=new Set,e=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,c)=>{const u=new Map([...this._backFill,...a]);u.forEach((f,b)=>{"!"===f?n.add(b):f===Ou&&e.add(b)}),i||u.set("offset",c/this.duration),r.push(u)});const o=[...n.values()],s=[...e.values()];if(i){const a=r[0],c=new Map(a);a.set("offset",0),c.set("offset",1),r=[a,c]}return JI(this.element,r,o,s,this.duration,this.startTime,this.easing,!1)}}class WW extends Ky{constructor(n,e,i,r,o,s,a=!1){super(n,e,s.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=o,this._stretchStartingKeyframe=a,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let n=this.keyframes,{delay:e,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const o=[],s=i+e,a=e/s,c=new Map(n[0]);c.set("offset",0),o.push(c);const u=new Map(n[0]);u.set("offset",TF(a)),o.push(u);const f=n.length-1;for(let b=1;b<=f;b++){let C=new Map(n[b]);const x=C.get("offset");C.set("offset",TF((e+x*i)/s)),o.push(C)}i=s,e=0,r="",n=o}return JI(this.element,n,this.preStyleProps,this.postStyleProps,i,e,r,!0)}}function TF(t,n=3){const e=Math.pow(10,n-1);return Math.round(t*e)/e}function SF(t,n,e,i,r,o,s,a,c,u,f,b,C){return{type:0,element:t,triggerName:n,isRemovalTransition:r,fromState:e,fromStyles:o,toState:i,toStyles:s,timelines:a,queriedElements:c,preStyleProps:u,postStyleProps:f,totalTime:b,errors:C}}const nT={};class MF{constructor(n,e,i){this._triggerName=n,this.ast=e,this._stateStyles=i}match(n,e,i,r){return function YW(t,n,e,i,r){return t.some(o=>o(n,e,i,r))}(this.ast.matchers,n,e,i,r)}buildStyles(n,e,i){let r=this._stateStyles.get("*");return void 0!==n&&(r=this._stateStyles.get(n?.toString())||r),r?r.buildStyles(e,i):new Map}build(n,e,i,r,o,s,a,c,u,f){const b=[],C=this.ast.options&&this.ast.options.params||nT,M=this.buildStyles(i,a&&a.params||nT,b),U=c&&c.params||nT,W=this.buildStyles(r,U,b),K=new Set,$=new Map,ge=new Map,ye="void"===r,lt={params:DF(U,C),delay:this.ast.options?.delay},Ee=f?[]:eT(n,e,this.ast.animation,o,s,M,W,lt,u,b);let Be=0;return Ee.forEach(ft=>{Be=Math.max(ft.duration+ft.delay,Be)}),b.length?SF(e,this._triggerName,i,r,ye,M,W,[],[],$,ge,Be,b):(Ee.forEach(ft=>{const rt=ft.element,ht=nl($,rt,new Set);ft.preStyleProps.forEach(pt=>ht.add(pt));const xt=nl(ge,rt,new Set);ft.postStyleProps.forEach(pt=>xt.add(pt)),rt!==e&&K.add(rt)}),SF(e,this._triggerName,i,r,ye,M,W,Ee,[...K.values()],$,ge,Be))}}function DF(t,n){const e={...n};return Object.entries(t).forEach(([i,r])=>{null!=r&&(e[i]=r)}),e}class ZW{constructor(n,e,i){this.styles=n,this.defaultParams=e,this.normalizer=i}buildStyles(n,e){const i=new Map,r=DF(n,this.defaultParams);return this.styles.styles.forEach(o=>{"string"!=typeof o&&o.forEach((s,a)=>{s&&(s=U0(s,r,e));const c=this.normalizer.normalizePropertyName(a,e);s=this.normalizer.normalizeStyleValue(a,c,s,e),i.set(a,s)})}),i}}class XW{constructor(n,e,i){this.name=n,this.ast=e,this._normalizer=i,this.transitionFactories=[],this.states=new Map,e.states.forEach(r=>{this.states.set(r.name,new ZW(r.style,r.options&&r.options.params||{},i))}),kF(this.states,"true","1"),kF(this.states,"false","0"),e.transitions.forEach(r=>{this.transitionFactories.push(new MF(n,r,this.states))}),this.fallbackTransition=function KW(t,n,e){return new MF(t,{type:Vn.Transition,animation:{type:Vn.Sequence,steps:[],options:null},matchers:[(s,a)=>!0],options:null,queryCount:0,depCount:0},n)}(n,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(n,e,i,r){return this.transitionFactories.find(s=>s.match(n,e,i,r))||null}matchStyles(n,e,i){return this.fallbackTransition.buildStyles(n,e,i)}}function kF(t,n,e){t.has(n)?t.has(e)||t.set(e,t.get(n)):t.has(e)&&t.set(n,t.get(e))}const QW=new qy;class JW{constructor(n,e,i){this.bodyNode=n,this._driver=e,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(n,e){const i=[],o=KI(this._driver,e,i,[]);if(i.length)throw function rW(t){return new mt(3503,!1)}();this._animations.set(n,o)}_buildPlayer(n,e,i){const r=n.element,o=fF(this._normalizer,n.keyframes,e,i);return this._driver.animate(r,o,n.duration,n.delay,n.easing,[],!0)}create(n,e,i={}){const r=[],o=this._animations.get(n);let s;const a=new Map;if(o?(s=eT(this._driver,e,o,WI,Vy,new Map,new Map,i,QW,r),s.forEach(f=>{const b=nl(a,f.element,new Map);f.postStyleProps.forEach(C=>b.set(C,null))})):(r.push(function oW(){return new mt(3300,!1)}()),s=[]),r.length)throw function sW(t){return new mt(3504,!1)}();a.forEach((f,b)=>{f.forEach((C,x)=>{f.set(x,this._driver.computeStyle(b,x,Ou))})});const u=Zd(s.map(f=>{const b=a.get(f.element);return this._buildPlayer(f,new Map,b)}));return this._playersById.set(n,u),u.onDestroy(()=>this.destroy(n)),this.players.push(u),u}destroy(n){const e=this._getPlayer(n);e.destroy(),this._playersById.delete(n);const i=this.players.indexOf(e);i>=0&&this.players.splice(i,1)}_getPlayer(n){const e=this._playersById.get(n);if(!e)throw function aW(t){return new mt(3301,!1)}();return e}listen(n,e,i,r){const o=zI(e,"","","");return BI(this._getPlayer(n),i,o,r),()=>{}}command(n,e,i,r){if("register"==i)return void this.register(n,r[0]);if("create"==i)return void this.create(n,e,r[0]||{});const o=this._getPlayer(n);switch(i){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(n)}}}const OF="ng-animate-queued",iT="ng-animate-disabled",r$=[],AF={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},o$={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Kl="__ng_removed";class rT{get params(){return this.options.params}constructor(n,e=""){this.namespaceId=e;const i=n&&n.hasOwnProperty("value");if(this.value=function c$(t){return t??null}(i?n.value:n),i){const{value:o,...s}=n;this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(n){const e=n.params;if(e){const i=this.options.params;Object.keys(e).forEach(r=>{null==i[r]&&(i[r]=e[r])})}}}const z0="void",oT=new rT(z0);class s${constructor(n,e,i){this.id=n,this.hostElement=e,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+n,xl(e,this._hostClassName)}listen(n,e,i,r){if(!this._triggers.has(e))throw function lW(t,n){return new mt(3302,!1)}();if(null==i||0==i.length)throw function cW(t){return new mt(3303,!1)}();if(!function u$(t){return"start"==t||"done"==t}(i))throw function uW(t,n){return new mt(3400,!1)}();const o=nl(this._elementListeners,n,[]),s={name:e,phase:i,callback:r};o.push(s);const a=nl(this._engine.statesByElement,n,new Map);return a.has(e)||(xl(n,jy),xl(n,jy+"-"+e),a.set(e,oT)),()=>{this._engine.afterFlush(()=>{const c=o.indexOf(s);c>=0&&o.splice(c,1),this._triggers.has(e)||a.delete(e)})}}register(n,e){return!this._triggers.has(n)&&(this._triggers.set(n,e),!0)}_getTrigger(n){const e=this._triggers.get(n);if(!e)throw function dW(t){return new mt(3401,!1)}();return e}trigger(n,e,i,r=!0){const o=this._getTrigger(e),s=new sT(this.id,e,n);let a=this._engine.statesByElement.get(n);a||(xl(n,jy),xl(n,jy+"-"+e),this._engine.statesByElement.set(n,a=new Map));let c=a.get(e);const u=new rT(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&c&&u.absorbOptions(c.options),a.set(e,u),c||(c=oT),u.value!==z0&&c.value===u.value){if(!function f$(t,n){const e=Object.keys(t),i=Object.keys(n);if(e.length!=i.length)return!1;for(let r=0;r<e.length;r++){const o=e[r];if(!n.hasOwnProperty(o)||t[o]!==n[o])return!1}return!0}(c.params,u.params)){const U=[],W=o.matchStyles(c.value,c.params,U),K=o.matchStyles(u.value,u.params,U);U.length?this._engine.reportError(U):this._engine.afterFlush(()=>{mf(n,W),Dc(n,K)})}return}const C=nl(this._engine.playersByElement,n,[]);C.forEach(U=>{U.namespaceId==this.id&&U.triggerName==e&&U.queued&&U.destroy()});let x=o.matchTransition(c.value,u.value,n,u.params),M=!1;if(!x){if(!r)return;x=o.fallbackTransition,M=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:e,transition:x,fromState:c,toState:u,player:s,isFallbackTransition:M}),M||(xl(n,OF),s.onStart(()=>{Ag(n,OF)})),s.onDone(()=>{let U=this.players.indexOf(s);U>=0&&this.players.splice(U,1);const W=this._engine.playersByElement.get(n);if(W){let K=W.indexOf(s);K>=0&&W.splice(K,1)}}),this.players.push(s),C.push(s),s}deregister(n){this._triggers.delete(n),this._engine.statesByElement.forEach(e=>e.delete(n)),this._elementListeners.forEach((e,i)=>{this._elementListeners.set(i,e.filter(r=>r.name!=n))})}clearElementCache(n){this._engine.statesByElement.delete(n),this._elementListeners.delete(n);const e=this._engine.playersByElement.get(n);e&&(e.forEach(i=>i.destroy()),this._engine.playersByElement.delete(n))}_signalRemovalForInnerTriggers(n,e){const i=this._engine.driver.query(n,Gy,!0);i.forEach(r=>{if(r[Kl])return;const o=this._engine.fetchNamespacesByElement(r);o.size?o.forEach(s=>s.triggerLeaveAnimation(r,e,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(n,e,i,r){const o=this._engine.statesByElement.get(n),s=new Map;if(o){const a=[];if(o.forEach((c,u)=>{if(s.set(u,c.value),this._triggers.has(u)){const f=this.trigger(n,u,z0,r);f&&a.push(f)}}),a.length)return this._engine.markElementAsRemoved(this.id,n,!0,e,s),i&&Zd(a).onDone(()=>this._engine.processLeaveNode(n)),!0}return!1}prepareLeaveAnimationListeners(n){const e=this._elementListeners.get(n),i=this._engine.statesByElement.get(n);if(e&&i){const r=new Set;e.forEach(o=>{const s=o.name;if(r.has(s))return;r.add(s);const c=this._triggers.get(s).fallbackTransition,u=i.get(s)||oT,f=new rT(z0),b=new sT(this.id,s,n);this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:s,transition:c,fromState:u,toState:f,player:b,isFallbackTransition:!0})})}}removeNode(n,e){const i=this._engine;if(n.childElementCount&&this._signalRemovalForInnerTriggers(n,e),this.triggerLeaveAnimation(n,e,!0))return;let r=!1;if(i.totalAnimations){const o=i.players.length?i.playersByQueriedElement.get(n):[];if(o&&o.length)r=!0;else{let s=n;for(;s=s.parentNode;)if(i.statesByElement.get(s)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(n),r)i.markElementAsRemoved(this.id,n,!1,e);else{const o=n[Kl];(!o||o===AF)&&(i.afterFlush(()=>this.clearElementCache(n)),i.destroyInnerAnimations(n),i._onRemovalComplete(n,e))}}insertNode(n,e){xl(n,this._hostClassName)}drainQueuedTransitions(n){const e=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const o=i.element,s=this._elementListeners.get(o);s&&s.forEach(a=>{if(a.name==i.triggerName){const c=zI(o,i.triggerName,i.fromState.value,i.toState.value);c._data=n,BI(i.player,a.phase,c,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(i)}),this._queue=[],e.sort((i,r)=>{const o=i.transition.ast.depCount,s=r.transition.ast.depCount;return 0==o||0==s?o-s:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(n){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,n)}}class a${_onRemovalComplete(n,e){this.onRemovalComplete(n,e)}constructor(n,e,i,r){this.bodyNode=n,this.driver=e,this._normalizer=i,this.scheduler=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(o,s)=>{}}get queuedPlayers(){const n=[];return this._namespaceList.forEach(e=>{e.players.forEach(i=>{i.queued&&n.push(i)})}),n}createNamespace(n,e){const i=new s$(n,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(i,e):(this.newHostElements.set(e,i),this.collectEnterElement(e)),this._namespaceLookup[n]=i}_balanceNamespaceList(n,e){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let s=!1,a=this.driver.getParentElement(e);for(;a;){const c=r.get(a);if(c){const u=i.indexOf(c);i.splice(u+1,0,n),s=!0;break}a=this.driver.getParentElement(a)}s||i.unshift(n)}else i.push(n);return r.set(e,n),n}register(n,e){let i=this._namespaceLookup[n];return i||(i=this.createNamespace(n,e)),i}registerTrigger(n,e,i){let r=this._namespaceLookup[n];r&&r.register(e,i)&&this.totalAnimations++}destroy(n,e){n&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const i=this._fetchNamespace(n);this.namespacesByHostElement.delete(i.hostElement);const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1),i.destroy(e),delete this._namespaceLookup[n]}))}_fetchNamespace(n){return this._namespaceLookup[n]}fetchNamespacesByElement(n){const e=new Set,i=this.statesByElement.get(n);if(i)for(let r of i.values())if(r.namespaceId){const o=this._fetchNamespace(r.namespaceId);o&&e.add(o)}return e}trigger(n,e,i,r){if(Qy(e)){const o=this._fetchNamespace(n);if(o)return o.trigger(e,i,r),!0}return!1}insertNode(n,e,i,r){if(!Qy(e))return;const o=e[Kl];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;const s=this.collectedLeaveElements.indexOf(e);s>=0&&this.collectedLeaveElements.splice(s,1)}if(n){const s=this._fetchNamespace(n);s&&s.insertNode(e,i)}r&&this.collectEnterElement(e)}collectEnterElement(n){this.collectedEnterElements.push(n)}markElementAsDisabled(n,e){e?this.disabledNodes.has(n)||(this.disabledNodes.add(n),xl(n,iT)):this.disabledNodes.has(n)&&(this.disabledNodes.delete(n),Ag(n,iT))}removeNode(n,e,i){if(Qy(e)){this.scheduler?.notify();const r=n?this._fetchNamespace(n):null;r?r.removeNode(e,i):this.markElementAsRemoved(n,e,!1,i);const o=this.namespacesByHostElement.get(e);o&&o.id!==n&&o.removeNode(e,i)}else this._onRemovalComplete(e,i)}markElementAsRemoved(n,e,i,r,o){this.collectedLeaveElements.push(e),e[Kl]={namespaceId:n,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:o}}listen(n,e,i,r,o){return Qy(e)?this._fetchNamespace(n).listen(e,i,r,o):()=>{}}_buildInstruction(n,e,i,r,o){return n.transition.build(this.driver,n.element,n.fromState.value,n.toState.value,i,r,n.fromState.options,n.toState.options,e,o)}destroyInnerAnimations(n){let e=this.driver.query(n,Gy,!0);e.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(n,$I,!0),e.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(n){const e=this.playersByElement.get(n);e&&e.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(n){const e=this.playersByQueriedElement.get(n);e&&e.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(n=>{if(this.players.length)return Zd(this.players).onDone(()=>n());n()})}processLeaveNode(n){const e=n[Kl];if(e&&e.setForRemoval){if(n[Kl]=AF,e.namespaceId){this.destroyInnerAnimations(n);const i=this._fetchNamespace(e.namespaceId);i&&i.clearElementCache(n)}this._onRemovalComplete(n,e.setForRemoval)}n.classList?.contains(iT)&&this.markElementAsDisabled(n,!1),this.driver.query(n,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(n=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)xl(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{e=this._flushAnimations(i,n)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],e.length?Zd(e).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(n){throw function hW(t){return new mt(3402,!1)}()}_flushAnimations(n,e){const i=new qy,r=[],o=new Map,s=[],a=new Map,c=new Map,u=new Map,f=new Set;this.disabledNodes.forEach(gt=>{f.add(gt);const Wt=this.driver.query(gt,".ng-animate-queued",!0);for(let Gt=0;Gt<Wt.length;Gt++)f.add(Wt[Gt])});const b=this.bodyNode,C=Array.from(this.statesByElement.keys()),x=NF(C,this.collectedEnterElements),M=new Map;let U=0;x.forEach((gt,Wt)=>{const Gt=WI+U++;M.set(Wt,Gt),gt.forEach(St=>xl(St,Gt))});const W=[],K=new Set,$=new Set;for(let gt=0;gt<this.collectedLeaveElements.length;gt++){const Wt=this.collectedLeaveElements[gt],Gt=Wt[Kl];Gt&&Gt.setForRemoval&&(W.push(Wt),K.add(Wt),Gt.hasAnimation?this.driver.query(Wt,".ng-star-inserted",!0).forEach(St=>K.add(St)):$.add(Wt))}const ge=new Map,ye=NF(C,Array.from(K));ye.forEach((gt,Wt)=>{const Gt=Vy+U++;ge.set(Wt,Gt),gt.forEach(St=>xl(St,Gt))}),n.push(()=>{x.forEach((gt,Wt)=>{const Gt=M.get(Wt);gt.forEach(St=>Ag(St,Gt))}),ye.forEach((gt,Wt)=>{const Gt=ge.get(Wt);gt.forEach(St=>Ag(St,Gt))}),W.forEach(gt=>{this.processLeaveNode(gt)})});const lt=[],Ee=[];for(let gt=this._namespaceList.length-1;gt>=0;gt--)this._namespaceList[gt].drainQueuedTransitions(e).forEach(Gt=>{const St=Gt.player,yn=Gt.element;if(lt.push(St),this.collectedEnterElements.length){const zr=yn[Kl];if(zr&&zr.setForMove){if(zr.previousTriggersValues&&zr.previousTriggersValues.has(Gt.triggerName)){const rc=zr.previousTriggersValues.get(Gt.triggerName),Cs=this.statesByElement.get(Gt.element);if(Cs&&Cs.has(Gt.triggerName)){const ju=Cs.get(Gt.triggerName);ju.value=rc,Cs.set(Gt.triggerName,ju)}}return void St.destroy()}}const Di=!b||!this.driver.containsElement(b,yn),Li=ge.get(yn),Ir=M.get(yn),gi=this._buildInstruction(Gt,i,Ir,Li,Di);if(gi.errors&&gi.errors.length)return void Ee.push(gi);if(Di)return St.onStart(()=>mf(yn,gi.fromStyles)),St.onDestroy(()=>Dc(yn,gi.toStyles)),void r.push(St);if(Gt.isFallbackTransition)return St.onStart(()=>mf(yn,gi.fromStyles)),St.onDestroy(()=>Dc(yn,gi.toStyles)),void r.push(St);const Nt=[];gi.timelines.forEach(zr=>{zr.stretchStartingKeyframe=!0,this.disabledNodes.has(zr.element)||Nt.push(zr)}),gi.timelines=Nt,i.append(yn,gi.timelines),s.push({instruction:gi,player:St,element:yn}),gi.queriedElements.forEach(zr=>nl(a,zr,[]).push(St)),gi.preStyleProps.forEach((zr,rc)=>{if(zr.size){let Cs=c.get(rc);Cs||c.set(rc,Cs=new Set),zr.forEach((ju,ch)=>Cs.add(ch))}}),gi.postStyleProps.forEach((zr,rc)=>{let Cs=u.get(rc);Cs||u.set(rc,Cs=new Set),zr.forEach((ju,ch)=>Cs.add(ch))})});if(Ee.length){const gt=[];Ee.forEach(Wt=>{gt.push(function fW(t,n){return new mt(3505,!1)}())}),lt.forEach(Wt=>Wt.destroy()),this.reportError(gt)}const Be=new Map,ft=new Map;s.forEach(gt=>{const Wt=gt.element;i.has(Wt)&&(ft.set(Wt,Wt),this._beforeAnimationBuild(gt.player.namespaceId,gt.instruction,Be))}),r.forEach(gt=>{const Wt=gt.element;this._getPreviousPlayers(Wt,!1,gt.namespaceId,gt.triggerName,null).forEach(St=>{nl(Be,Wt,[]).push(St),St.destroy()})});const rt=W.filter(gt=>LF(gt,c,u)),ht=new Map;FF(ht,this.driver,$,u,Ou).forEach(gt=>{LF(gt,c,u)&&rt.push(gt)});const pt=new Map;x.forEach((gt,Wt)=>{FF(pt,this.driver,new Set(gt),c,"!")}),rt.forEach(gt=>{const Wt=ht.get(gt),Gt=pt.get(gt);ht.set(gt,new Map([...Wt?.entries()??[],...Gt?.entries()??[]]))});const Qt=[],ln=[],Mn={};s.forEach(gt=>{const{element:Wt,player:Gt,instruction:St}=gt;if(i.has(Wt)){if(f.has(Wt))return Gt.onDestroy(()=>Dc(Wt,St.toStyles)),Gt.disabled=!0,Gt.overrideTotalTime(St.totalTime),void r.push(Gt);let yn=Mn;if(ft.size>1){let Li=Wt;const Ir=[];for(;Li=Li.parentNode;){const gi=ft.get(Li);if(gi){yn=gi;break}Ir.push(Li)}Ir.forEach(gi=>ft.set(gi,yn))}const Di=this._buildAnimation(Gt.namespaceId,St,Be,o,pt,ht);if(Gt.setRealPlayer(Di),yn===Mn)Qt.push(Gt);else{const Li=this.playersByElement.get(yn);Li&&Li.length&&(Gt.parentPlayer=Zd(Li)),r.push(Gt)}}else mf(Wt,St.fromStyles),Gt.onDestroy(()=>Dc(Wt,St.toStyles)),ln.push(Gt),f.has(Wt)&&r.push(Gt)}),ln.forEach(gt=>{const Wt=o.get(gt.element);if(Wt&&Wt.length){const Gt=Zd(Wt);gt.setRealPlayer(Gt)}}),r.forEach(gt=>{gt.parentPlayer?gt.syncPlayerEvents(gt.parentPlayer):gt.destroy()});for(let gt=0;gt<W.length;gt++){const Wt=W[gt],Gt=Wt[Kl];if(Ag(Wt,Vy),Gt&&Gt.hasAnimation)continue;let St=[];if(a.size){let Di=a.get(Wt);Di&&Di.length&&St.push(...Di);let Li=this.driver.query(Wt,$I,!0);for(let Ir=0;Ir<Li.length;Ir++){let gi=a.get(Li[Ir]);gi&&gi.length&&St.push(...gi)}}const yn=St.filter(Di=>!Di.destroyed);yn.length?d$(this,Wt,yn):this.processLeaveNode(Wt)}return W.length=0,Qt.forEach(gt=>{this.players.push(gt),gt.onDone(()=>{gt.destroy();const Wt=this.players.indexOf(gt);this.players.splice(Wt,1)}),gt.play()}),Qt}afterFlush(n){this._flushFns.push(n)}afterFlushAnimationsDone(n){this._whenQuietFns.push(n)}_getPreviousPlayers(n,e,i,r,o){let s=[];if(e){const a=this.playersByQueriedElement.get(n);a&&(s=a)}else{const a=this.playersByElement.get(n);if(a){const c=!o||o==z0;a.forEach(u=>{u.queued||!c&&u.triggerName!=r||s.push(u)})}}return(i||r)&&(s=s.filter(a=>!(i&&i!=a.namespaceId||r&&r!=a.triggerName))),s}_beforeAnimationBuild(n,e,i){const o=e.element,s=e.isRemovalTransition?void 0:n,a=e.isRemovalTransition?void 0:e.triggerName;for(const c of e.timelines){const u=c.element,f=u!==o,b=nl(i,u,[]);this._getPreviousPlayers(u,f,s,a,e.toState).forEach(x=>{const M=x.getRealPlayer();M.beforeDestroy&&M.beforeDestroy(),x.destroy(),b.push(x)})}mf(o,e.fromStyles)}_buildAnimation(n,e,i,r,o,s){const a=e.triggerName,c=e.element,u=[],f=new Set,b=new Set,C=e.timelines.map(M=>{const U=M.element;f.add(U);const W=U[Kl];if(W&&W.removedBeforeQueried)return new L0(M.duration,M.delay);const K=U!==c,$=function h$(t){const n=[];return RF(t,n),n}((i.get(U)||r$).map(Be=>Be.getRealPlayer())).filter(Be=>!!Be.element&&Be.element===U),ge=o.get(U),ye=s.get(U),lt=fF(this._normalizer,M.keyframes,ge,ye),Ee=this._buildPlayer(M,lt,$);if(M.subTimeline&&r&&b.add(U),K){const Be=new sT(n,a,U);Be.setRealPlayer(Ee),u.push(Be)}return Ee});u.forEach(M=>{nl(this.playersByQueriedElement,M.element,[]).push(M),M.onDone(()=>function l$(t,n,e){let i=t.get(n);if(i){if(i.length){const r=i.indexOf(e);i.splice(r,1)}0==i.length&&t.delete(n)}return i}(this.playersByQueriedElement,M.element,M))}),f.forEach(M=>xl(M,vF));const x=Zd(C);return x.onDestroy(()=>{f.forEach(M=>Ag(M,vF)),Dc(c,e.toStyles)}),b.forEach(M=>{nl(r,M,[]).push(x)}),x}_buildPlayer(n,e,i){return e.length>0?this.driver.animate(n.element,e,n.duration,n.delay,n.easing,i):new L0(n.duration,n.delay)}}class sT{constructor(n,e,i){this.namespaceId=n,this.triggerName=e,this.element=i,this._player=new L0,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(n){this._containsRealPlayer||(this._player=n,this._queuedCallbacks.forEach((e,i)=>{e.forEach(r=>BI(n,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(n.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(n){this.totalTime=n}syncPlayerEvents(n){const e=this._player;e.triggerCallback&&n.onStart(()=>e.triggerCallback("start")),n.onDone(()=>this.finish()),n.onDestroy(()=>this.destroy())}_queueEvent(n,e){nl(this._queuedCallbacks,n,[]).push(e)}onDone(n){this.queued&&this._queueEvent("done",n),this._player.onDone(n)}onStart(n){this.queued&&this._queueEvent("start",n),this._player.onStart(n)}onDestroy(n){this.queued&&this._queueEvent("destroy",n),this._player.onDestroy(n)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(n){this.queued||this._player.setPosition(n)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(n){const e=this._player;e.triggerCallback&&e.triggerCallback(n)}}function Qy(t){return t&&1===t.nodeType}function PF(t,n){const e=t.style.display;return t.style.display=n??"none",e}function FF(t,n,e,i,r){const o=[];e.forEach(c=>o.push(PF(c)));const s=[];i.forEach((c,u)=>{const f=new Map;c.forEach(b=>{const C=n.computeStyle(u,b,r);f.set(b,C),(!C||0==C.length)&&(u[Kl]=o$,s.push(u))}),t.set(u,f)});let a=0;return e.forEach(c=>PF(c,o[a++])),s}function NF(t,n){const e=new Map;if(t.forEach(a=>e.set(a,[])),0==n.length)return e;const r=new Set(n),o=new Map;function s(a){if(!a)return 1;let c=o.get(a);if(c)return c;const u=a.parentNode;return c=e.has(u)?u:r.has(u)?1:s(u),o.set(a,c),c}return n.forEach(a=>{const c=s(a);1!==c&&e.get(c).push(a)}),e}function xl(t,n){t.classList?.add(n)}function Ag(t,n){t.classList?.remove(n)}function d$(t,n,e){Zd(e).onDone(()=>t.processLeaveNode(n))}function RF(t,n){for(let e=0;e<t.length;e++){const i=t[e];i instanceof dF?RF(i.players,n):n.push(i)}}function LF(t,n,e){const i=e.get(t);if(!i)return!1;let r=n.get(t);return r?i.forEach(o=>r.add(o)):n.set(t,i),e.delete(t),!0}class H0{constructor(n,e,i,r){this._driver=e,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(o,s)=>{},this._transitionEngine=new a$(n.body,e,i,r),this._timelineEngine=new JW(n.body,e,i),this._transitionEngine.onRemovalComplete=(o,s)=>this.onRemovalComplete(o,s)}registerTrigger(n,e,i,r,o){const s=n+"-"+r;let a=this._triggerCache[s];if(!a){const c=[],f=KI(this._driver,o,c,[]);if(c.length)throw function nW(t,n){return new mt(3404,!1)}();a=function qW(t,n,e){return new XW(t,n,e)}(r,f,this._normalizer),this._triggerCache[s]=a}this._transitionEngine.registerTrigger(e,r,a)}register(n,e){this._transitionEngine.register(n,e)}destroy(n,e){this._transitionEngine.destroy(n,e)}onInsert(n,e,i,r){this._transitionEngine.insertNode(n,e,i,r)}onRemove(n,e,i){this._transitionEngine.removeNode(n,e,i)}disableAnimations(n,e){this._transitionEngine.markElementAsDisabled(n,e)}process(n,e,i,r){if("@"==i.charAt(0)){const[o,s]=pF(i);this._timelineEngine.command(o,e,s,r)}else this._transitionEngine.trigger(n,e,i,r)}listen(n,e,i,r,o){if("@"==i.charAt(0)){const[s,a]=pF(i);return this._timelineEngine.listen(s,e,a,o)}return this._transitionEngine.listen(n,e,i,r,o)}flush(n=-1){this._transitionEngine.flush(n)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(n){this._transitionEngine.afterFlushAnimationsDone(n)}}class V0{static#e=this.initialStylesByElement=new WeakMap;constructor(n,e,i){this._element=n,this._startStyles=e,this._endStyles=i,this._state=0;let r=V0.initialStylesByElement.get(n);r||V0.initialStylesByElement.set(n,r=new Map),this._initialStyles=r}start(){this._state<1&&(this._startStyles&&Dc(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Dc(this._element,this._initialStyles),this._endStyles&&(Dc(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(V0.initialStylesByElement.delete(this._element),this._startStyles&&(mf(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(mf(this._element,this._endStyles),this._endStyles=null),Dc(this._element,this._initialStyles),this._state=3)}}function aT(t){let n=null;return t.forEach((e,i)=>{(function g$(t){return"display"===t||"position"===t})(i)&&(n=n||new Map,n.set(i,e))}),n}class BF{constructor(n,e,i,r){this.element=n,this.keyframes=e,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const n=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,n,this.options),this._finalKeyframe=n.length?n[n.length-1]:new Map;const e=()=>this._onFinish();this.domPlayer.addEventListener("finish",e),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",e)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(n){const e=[];return n.forEach(i=>{e.push(Object.fromEntries(i))}),e}_triggerWebAnimation(n,e,i){return n.animate(this._convertKeyframesToObject(e),i)}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(n=>n()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}setPosition(n){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=n*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const n=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&n.set(r,this._finished?i:XI(this.element,r))}),this.currentSnapshot=n}triggerCallback(n){const e="start"===n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class UF{validateStyleProperty(n){return!0}validateAnimatableStyleProperty(n){return!0}matchesElement(n,e){return!1}containsElement(n,e){return mF(n,e)}getParentElement(n){return HI(n)}query(n,e,i){return _F(n,e,i)}computeStyle(n,e,i){return XI(n,e)}animate(n,e,i,r,o,s=[]){const c={duration:i,delay:r,fill:0==r?"both":"forwards"};o&&(c.easing=o);const u=new Map,f=s.filter(x=>x instanceof BF);(function TW(t,n){return 0===t||0===n})(i,r)&&f.forEach(x=>{x.currentSnapshot.forEach((M,U)=>u.set(U,M))});let b=function wW(t){return t.length?t[0]instanceof Map?t:t.map(n=>new Map(Object.entries(n))):[]}(e).map(x=>new Map(x));b=function SW(t,n,e){if(e.size&&n.length){let i=n[0],r=[];if(e.forEach((o,s)=>{i.has(s)||r.push(s),i.set(s,o)}),r.length)for(let o=1;o<n.length;o++){let s=n[o];r.forEach(a=>s.set(a,XI(t,a)))}}return n}(n,b,u);const C=function p$(t,n){let e=null,i=null;return Array.isArray(n)&&n.length?(e=aT(n[0]),n.length>1&&(i=aT(n[n.length-1]))):n instanceof Map&&(e=aT(n)),e||i?new V0(t,e,i):null}(n,b);return new BF(n,b,c,C)}}const zF="@.disabled";class HF{constructor(n,e,i,r){this.namespaceId=n,this.delegate=e,this.engine=i,this._onDestroy=r,this.\u0275type=0}get data(){return this.delegate.data}destroyNode(n){this.delegate.destroyNode?.(n)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(n,e){return this.delegate.createElement(n,e)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}appendChild(n,e){this.delegate.appendChild(n,e),this.engine.onInsert(this.namespaceId,e,n,!1)}insertBefore(n,e,i,r=!0){this.delegate.insertBefore(n,e,i),this.engine.onInsert(this.namespaceId,e,n,r)}removeChild(n,e,i){this.engine.onRemove(this.namespaceId,e,this.delegate)}selectRootElement(n,e){return this.delegate.selectRootElement(n,e)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,e,i,r){this.delegate.setAttribute(n,e,i,r)}removeAttribute(n,e,i){this.delegate.removeAttribute(n,e,i)}addClass(n,e){this.delegate.addClass(n,e)}removeClass(n,e){this.delegate.removeClass(n,e)}setStyle(n,e,i,r){this.delegate.setStyle(n,e,i,r)}removeStyle(n,e,i){this.delegate.removeStyle(n,e,i)}setProperty(n,e,i){"@"==e.charAt(0)&&e==zF?this.disableAnimations(n,!!i):this.delegate.setProperty(n,e,i)}setValue(n,e){this.delegate.setValue(n,e)}listen(n,e,i){return this.delegate.listen(n,e,i)}disableAnimations(n,e){this.engine.disableAnimations(n,e)}}class m$ extends HF{constructor(n,e,i,r,o){super(e,i,r,o),this.factory=n,this.namespaceId=e}setProperty(n,e,i){"@"==e.charAt(0)?"."==e.charAt(1)&&e==zF?this.disableAnimations(n,i=void 0===i||!!i):this.engine.process(this.namespaceId,n,e.slice(1),i):this.delegate.setProperty(n,e,i)}listen(n,e,i){if("@"==e.charAt(0)){const r=function _$(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(n);let o=e.slice(1),s="";return"@"!=o.charAt(0)&&([o,s]=function b$(t){const n=t.indexOf(".");return[t.substring(0,n),t.slice(n+1)]}(o)),this.engine.listen(this.namespaceId,r,o,s,a=>{this.factory.scheduleListenerCallback(a._data||-1,i,a)})}return this.delegate.listen(n,e,i)}}class v${constructor(n,e,i){this.delegate=n,this.engine=e,this._zone=i,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,e.onRemovalComplete=(r,o)=>{const s=o?.parentNode(r);s&&o.removeChild(s,r)}}createRenderer(n,e){const r=this.delegate.createRenderer(n,e);if(!n||!e?.data?.animation){const u=this._rendererCache;let f=u.get(r);return f||(f=new HF("",r,this.engine,()=>u.delete(r)),u.set(r,f)),f}const o=e.id,s=e.id+"-"+this._currentId;this._currentId++,this.engine.register(s,n);const a=u=>{Array.isArray(u)?u.forEach(a):this.engine.registerTrigger(o,s,n,u.name,u)};return e.data.animation.forEach(a),new m$(this,s,r,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(n,e,i){if(n>=0&&n<this._microtaskId)return void this._zone.run(()=>e(i));const r=this._animationCallbacksBuffer;0==r.length&&queueMicrotask(()=>{this._zone.run(()=>{r.forEach(o=>{const[s,a]=o;s(a)}),this._animationCallbacksBuffer=[]})}),r.push([e,i])}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}let y$=(()=>{class t extends H0{constructor(e,i,r){super(e,i,r,kn(P1,{optional:!0}))}ngOnDestroy(){this.flush()}static#e=this.\u0275fac=function(i){return new(i||t)(Nn(Iu),Nn(jI),Nn(GI))};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac})}return t})();const VF=[{provide:GI,useFactory:function C$(){return new xF}},{provide:H0,useClass:y$},{provide:EE,useFactory:function x$(t,n,e){return new v$(t,n,e)},deps:[aI,H0,Pn]}],lT=[{provide:jI,useFactory:()=>new UF},{provide:p_,useValue:"BrowserAnimations"},...VF],jF=[{provide:jI,useClass:VI},{provide:p_,useValue:"NoopAnimations"},...VF];let w$=(()=>{class t{static withConfig(e){return{ngModule:t,providers:e.disableAnimations?jF:lT}}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ga({type:t});static#n=this.\u0275inj=ha({providers:lT,imports:[qA]})}return t})(),j0=(()=>{class t{constructor(){this.count=0,this.animeState="active"}ngOnChanges(){this.animeState="inactive",queueMicrotask(()=>{this.animeState="active"})}animationShuffleDone(e){this.animeState="inactive"}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275cmp=In({type:t,selectors:[["badge"]],inputs:{count:"count"},features:[hr],decls:2,vars:2,consts:[[1,"badge"]],template:function(i,r){1&i&&(p(0,"div",0),y(1),g()),2&i&&(m("@bounce",r.animeState),h(),Xe(r.count))},styles:[".badge[_ngcontent-%COMP%]{min-width:8px;min-height:8px;font-size:8px;padding:2px 4px;border-radius:100px;text-align:center;color:#eee;background-color:#cf5252}"],data:{animation:[Xn("bounce",[RI("active",We({transform:""})),an("* => active",[rn("600ms ease",En([We({transform:"scale3d(0.5, 0.5, 0.5)",offset:0}),We({transform:"scale3d(2, 2, 2)",offset:.5}),We({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),We({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),We({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])])]}})}return t})();var cT;(cT||(cT={})).resize=function n(e,i,r,o){let s=e.width,a=e.height,c=s/(i=Math.round(i)),u=a/(r=Math.round(r)),f=Math.ceil(c/2),b=Math.ceil(u/2),C=e.getContext("2d"),x=C.getImageData(0,0,s,a),M=C.createImageData(i,r),U=x.data,W=M.data;for(let K=0;K<r;K++)for(let $=0;$<i;$++){let ge=4*($+K*i),ye=0,lt=0,Ee=0,Be=0,ft=0,rt=0,ht=0,xt=(K+.5)*u,pt=Math.floor(K*u),Qt=Math.ceil((K+1)*u);for(let ln=pt;ln<Qt;ln++){let Mn=Math.abs(xt-(ln+.5))/b,gt=($+.5)*c,Wt=Mn*Mn,Gt=Math.floor($*c),St=Math.ceil(($+1)*c);for(let yn=Gt;yn<St;yn++){let Di=Math.abs(gt-(yn+.5))/f,Li=Math.sqrt(Wt+Di*Di);if(Li>=1)continue;ye=2*Li*Li*Li-3*Li*Li+1;let Ir=4*(yn+ln*s);ht+=ye*U[Ir+3],Ee+=ye,U[Ir+3]<255&&(ye=ye*U[Ir+3]/250),Be+=ye*U[Ir],ft+=ye*U[Ir+1],rt+=ye*U[Ir+2],lt+=ye}}W[ge]=Be/lt,W[ge+1]=ft/lt,W[ge+2]=rt/lt,W[ge+3]=ht/Ee}!0===o?(e.width=i,e.height=r):C.clearRect(0,0,s,a),C.putImageData(M,0,0)};var Fg,Ql,t,GF=me(8823),Pg=me(5168);(t=Fg||(Fg={})).sha256=function n(r){let o;if(r instanceof ArrayBuffer){let s=GF.create(r);o=Pg(s)}else o=Pg(r);return Uint32Array.from(o.words).buffer},t.sha256Hex=function e(r){if(r instanceof ArrayBuffer){let o=GF.create(r);return Pg(o).toString()}return Pg(r).toString()},t.sha256Base64Url=function i(r){if(null==r)return"";let o=Pg(r),s=Uint32Array.from(o.words).buffer;return btoa(String.fromCharCode(...new Uint8Array(s))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=*$/g,"")},function(t){function r(){return(r=(0,L.A)(function*(o){return o instanceof Blob?Fg.sha256Hex(yield t.readAsArrayBufferAsync(o)):Fg.sha256Hex(o)})).apply(this,arguments)}t.readAsArrayBufferAsync=function n(o){return new Promise((s,a)=>{let c=new FileReader;c.onload=u=>{s(c.result)},c.onabort=c.onerror=u=>{a(u)},c.readAsArrayBuffer(o)})},t.readAsTextAsync=function e(o){return new Promise((s,a)=>{let c=new FileReader;c.onload=u=>{s(c.result)},c.onabort=c.onerror=u=>{a(u)},c.readAsText(o)})},t.calcSHA256Async=function i(o){return r.apply(this,arguments)}}(Ql||(Ql={}));var Ri=function(t){return t[t.NULL=0]="NULL",t[t.THUMBNAIL=1]="THUMBNAIL",t[t.COMPLETE=2]="COMPLETE",t[t.URL=1e3]="URL",t}(Ri||{});class vn{get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob?this.context.blob:this.context.thumbnail.blob}get url(){return this.context.url?this.context.url:this.context.thumbnail.url}get thumbnail(){return this.context.thumbnail}get state(){return this.url||this.blob?this.url&&!this.blob?Ri.URL:this.blob===this.thumbnail.blob?Ri.THUMBNAIL:Ri.COMPLETE:Ri.NULL}get isEmpty(){return this.state<=Ri.NULL}constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:"",thumbnail:{blob:null,type:"",url:""}}}static createEmpty(n){let e=new vn;return e.context.identifier=n,e}static create(n){if("string"==typeof n){let e=new vn;return e.context.identifier=n,e.context.name=n,e.context.url=n,e}{let e=new vn;return e.apply(n),e}}static createAsync(n){return(0,L.A)(function*(){return n instanceof File?yield vn._createAsync(n,n.name):n instanceof Blob?yield vn._createAsync(n):void 0})()}static _createAsync(n,e){return(0,L.A)(function*(){let i=yield Ql.readAsArrayBufferAsync(n),r=new vn;r.context.identifier=yield Ql.calcSHA256Async(i),r.context.name=e,r.context.blob=new Blob([i],{type:n.type}),r.context.url=window.URL.createObjectURL(r.context.blob);try{r.context.thumbnail=yield vn.createThumbnailAsync(r.context)}catch(o){throw o}return null!=r.context.name&&(r.context.name=r.context.identifier),r})()}destroy(){this.revokeURLs()}apply(n){!this.context.identifier&&n.identifier&&(this.context.identifier=n.identifier),!this.context.name&&n.name&&(this.context.name=n.name),!this.context.blob&&n.blob&&(this.context.blob=n.blob),!this.context.type&&n.type&&(this.context.type=n.type),!this.context.url&&n.url&&(this.context.url=n.url),!this.context.thumbnail.blob&&n.thumbnail.blob&&(this.context.thumbnail.blob=n.thumbnail.blob),!this.context.thumbnail.type&&n.thumbnail.type&&(this.context.thumbnail.type=n.thumbnail.type),!this.context.thumbnail.url&&n.thumbnail.url&&(this.context.thumbnail.url=n.thumbnail.url),this.createURLs()}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url,thumbnail:{blob:this.context.thumbnail.blob,type:this.context.thumbnail.type,url:this.context.thumbnail.url}}}createURLs(){this.state!==Ri.URL&&(this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob)),this.context.thumbnail.blob&&""===this.context.thumbnail.url&&(this.context.thumbnail.url=window.URL.createObjectURL(this.context.thumbnail.blob)))}revokeURLs(){this.state!==Ri.URL&&(window.URL.revokeObjectURL(this.context.url),window.URL.revokeObjectURL(this.context.thumbnail.url))}static createThumbnailAsync(n){return new Promise((e,i)=>{let r=new Image;r.onload=o=>{let s=Math.min(128/Math.max(r.width,r.height),1),a=r.width*s,c=r.height*s,u=document.createElement("canvas"),f=u.getContext("2d");u.width=r.width,u.height=r.height,f.drawImage(r,0,0),cT.resize(u,a,c,!0),u.toBlob(b=>{let C={type:b.type,blob:b,url:window.URL.createObjectURL(b)};e(C)},n.blob.type)},r.onabort=r.onerror=()=>{i()},r.src=n.url})}static#e=this.Empty=vn.createEmpty("null")}let Ng=0;const G0=new Map,eC=new MessageChannel;function Ns(t){if(4294967296===Ng&&(Ng=0),++Ng in G0)throw new Error("setZeroTimeout queue overflow.");return G0.set(Ng,t),eC.port2.postMessage(Ng),Ng}eC.port1.onmessage=function(t){const n=G0.get(t.data);G0.delete(t.data),n&&n()},eC.port1.start(),eC.port2.start();class WF{}var $F=me(1782),I$=me(7385),Pu=function(t){return t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LOW=1]="LOW",t[t.MIDDLE=2]="MIDDLE",t[t.HIGH=3]="HIGH",t}(Pu||{});const T$=I$("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),S$=/^(\w{6})(\w{3})(\w*)-(\w*)/i;class Ar{get isRoom(){return 0<this.roomId.length}get hasPassword(){return 0<this.password.length+this.digestPassword.length}constructor(n){this.peerId="",this.userId="",this.roomId="",this.roomName="",this.password="",this.digestUserId="",this.digestPassword="",this.isOpen=!1,this.session={grade:Pu.UNSPECIFIED,ping:0,health:0,speed:0,description:""},this.parse(n)}parse(n){try{this.peerId=n;let e=S$.exec(n);if(null!=e)return this.digestUserId=e[1],this.roomId=e[2],this.roomName=$F.m(e[3]),void(this.digestPassword=e[4])}catch(e){console.warn(e)}this.digestUserId=n}verifyPassword(n){return YF(this.digestUserId,this.roomId,this.roomName,n)===this.digestPassword&&this.verifyRoomId(n)}verifyRoomId(n){return ZF(this.roomId,this.roomName,n)===this.roomId}verifyPeer(n){let e=Ar.parse(n);return this.roomId==e.roomId&&this.roomName==e.roomName&&this.hasPassword==e.hasPassword&&(!this.hasPassword||(this.password.length<1?(console.error("do not know password."),!1):e.verifyPassword(this.password)))}static parse(n){return new Ar(n)}static create(...n){return n.length<=1?Ar._create.apply(this,n):Ar._createRoom.apply(this,n)}static _create(n=""){let e=function M$(t){return null==t?"":tC(t)}(n),i=new Ar(e);return i.userId=n,i}static _createRoom(n="",e="",i="",r=""){let o=tC(n,6),s=ZF(e,i,r),a=YF(o,s,i,r),c=`${o}${s}${$F.B(i)}-${a}`,u=new Ar(c);return u.userId=n,u.password=r,u}static generateId(n="********"){let i=n;return i=n.replace(/\*/g,r=>"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())]),i}}function YF(t,n,e,i){return null==n||null==i?"":0<i.length?tC(t+n+e+i,7):""}function ZF(t,n,e){if(e.length<1)return t;let i=t.slice(0,2);return i+tC(i+n+e,1)}function tC(t,n=-1){if(null==t)return"";let e=Pg(t),i=new Uint8Array(Uint32Array.from(e.words).buffer),r=T$.encode(i);return n<0&&(n=r.length),r.length<n&&(n=r.length),r=r.slice(0,n),r}var uT;function Rg(t){let n=t.length;for(;--n>=0;)t[n]=0}!function(t){t.diff=function n(e,i){let r=[],o=[],s=!1,a=!1;for(let c of e.concat(i))s=e.includes(c),a=i.includes(c),s&&!a?r.push(c):!s&&a&&o.push(c);return{diff1:r,diff2:o}}}(uT||(uT={}));const gT=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),nC=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),R$=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),nN=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Fu=new Array(576);Rg(Fu);const Y0=new Array(60);Rg(Y0);const Z0=new Array(512);Rg(Z0);const q0=new Array(256);Rg(q0);const mT=new Array(29);Rg(mT);const iC=new Array(30);function _T(t,n,e,i,r){this.static_tree=t,this.extra_bits=n,this.extra_base=e,this.elems=i,this.max_length=r,this.has_stree=t&&t.length}let iN,rN,oN;function bT(t,n){this.dyn_tree=t,this.max_code=0,this.stat_desc=n}Rg(iC);const sN=t=>t<256?Z0[t]:Z0[256+(t>>>7)],X0=(t,n)=>{t.pending_buf[t.pending++]=255&n,t.pending_buf[t.pending++]=n>>>8&255},Ta=(t,n,e)=>{t.bi_valid>16-e?(t.bi_buf|=n<<t.bi_valid&65535,X0(t,t.bi_buf),t.bi_buf=n>>16-t.bi_valid,t.bi_valid+=e-16):(t.bi_buf|=n<<t.bi_valid&65535,t.bi_valid+=e)},kc=(t,n,e)=>{Ta(t,e[2*n],e[2*n+1])},aN=(t,n)=>{let e=0;do{e|=1&t,t>>>=1,e<<=1}while(--n>0);return e>>>1},lN=(t,n,e)=>{const i=new Array(16);let o,s,r=0;for(o=1;o<=15;o++)r=r+e[o-1]<<1,i[o]=r;for(s=0;s<=n;s++){let a=t[2*s+1];0!==a&&(t[2*s]=aN(i[a]++,a))}},cN=t=>{let n;for(n=0;n<286;n++)t.dyn_ltree[2*n]=0;for(n=0;n<30;n++)t.dyn_dtree[2*n]=0;for(n=0;n<19;n++)t.bl_tree[2*n]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},uN=t=>{t.bi_valid>8?X0(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},dN=(t,n,e,i)=>{const r=2*n,o=2*e;return t[r]<t[o]||t[r]===t[o]&&i[n]<=i[e]},vT=(t,n,e)=>{const i=t.heap[e];let r=e<<1;for(;r<=t.heap_len&&(r<t.heap_len&&dN(n,t.heap[r+1],t.heap[r],t.depth)&&r++,!dN(n,i,t.heap[r],t.depth));)t.heap[e]=t.heap[r],e=r,r<<=1;t.heap[e]=i},hN=(t,n,e)=>{let i,r,s,a,o=0;if(0!==t.sym_next)do{i=255&t.pending_buf[t.sym_buf+o++],i+=(255&t.pending_buf[t.sym_buf+o++])<<8,r=t.pending_buf[t.sym_buf+o++],0===i?kc(t,r,n):(s=q0[r],kc(t,s+256+1,n),a=gT[s],0!==a&&(r-=mT[s],Ta(t,r,a)),i--,s=sN(i),kc(t,s,e),a=nC[s],0!==a&&(i-=iC[s],Ta(t,i,a)))}while(o<t.sym_next);kc(t,256,n)},yT=(t,n)=>{const e=n.dyn_tree,i=n.stat_desc.static_tree,r=n.stat_desc.has_stree,o=n.stat_desc.elems;let s,a,u,c=-1;for(t.heap_len=0,t.heap_max=573,s=0;s<o;s++)0!==e[2*s]?(t.heap[++t.heap_len]=c=s,t.depth[s]=0):e[2*s+1]=0;for(;t.heap_len<2;)u=t.heap[++t.heap_len]=c<2?++c:0,e[2*u]=1,t.depth[u]=0,t.opt_len--,r&&(t.static_len-=i[2*u+1]);for(n.max_code=c,s=t.heap_len>>1;s>=1;s--)vT(t,e,s);u=o;do{s=t.heap[1],t.heap[1]=t.heap[t.heap_len--],vT(t,e,1),a=t.heap[1],t.heap[--t.heap_max]=s,t.heap[--t.heap_max]=a,e[2*u]=e[2*s]+e[2*a],t.depth[u]=(t.depth[s]>=t.depth[a]?t.depth[s]:t.depth[a])+1,e[2*s+1]=e[2*a+1]=u,t.heap[1]=u++,vT(t,e,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,n)=>{const e=n.dyn_tree,i=n.max_code,r=n.stat_desc.static_tree,o=n.stat_desc.has_stree,s=n.stat_desc.extra_bits,a=n.stat_desc.extra_base,c=n.stat_desc.max_length;let u,f,b,C,x,M,U=0;for(C=0;C<=15;C++)t.bl_count[C]=0;for(e[2*t.heap[t.heap_max]+1]=0,u=t.heap_max+1;u<573;u++)f=t.heap[u],C=e[2*e[2*f+1]+1]+1,C>c&&(C=c,U++),e[2*f+1]=C,!(f>i)&&(t.bl_count[C]++,x=0,f>=a&&(x=s[f-a]),M=e[2*f],t.opt_len+=M*(C+x),o&&(t.static_len+=M*(r[2*f+1]+x)));if(0!==U){do{for(C=c-1;0===t.bl_count[C];)C--;t.bl_count[C]--,t.bl_count[C+1]+=2,t.bl_count[c]--,U-=2}while(U>0);for(C=c;0!==C;C--)for(f=t.bl_count[C];0!==f;)b=t.heap[--u],!(b>i)&&(e[2*b+1]!==C&&(t.opt_len+=(C-e[2*b+1])*e[2*b],e[2*b+1]=C),f--)}})(t,n),lN(e,c,t.bl_count)},fN=(t,n,e)=>{let i,o,r=-1,s=n[1],a=0,c=7,u=4;for(0===s&&(c=138,u=3),n[2*(e+1)+1]=65535,i=0;i<=e;i++)o=s,s=n[2*(i+1)+1],!(++a<c&&o===s)&&(a<u?t.bl_tree[2*o]+=a:0!==o?(o!==r&&t.bl_tree[2*o]++,t.bl_tree[32]++):a<=10?t.bl_tree[34]++:t.bl_tree[36]++,a=0,r=o,0===s?(c=138,u=3):o===s?(c=6,u=3):(c=7,u=4))},pN=(t,n,e)=>{let i,o,r=-1,s=n[1],a=0,c=7,u=4;for(0===s&&(c=138,u=3),i=0;i<=e;i++)if(o=s,s=n[2*(i+1)+1],!(++a<c&&o===s)){if(a<u)do{kc(t,o,t.bl_tree)}while(0!=--a);else 0!==o?(o!==r&&(kc(t,o,t.bl_tree),a--),kc(t,16,t.bl_tree),Ta(t,a-3,2)):a<=10?(kc(t,17,t.bl_tree),Ta(t,a-3,3)):(kc(t,18,t.bl_tree),Ta(t,a-11,7));a=0,r=o,0===s?(c=138,u=3):o===s?(c=6,u=3):(c=7,u=4)}};let gN=!1;const mN=(t,n,e,i)=>{Ta(t,0+(i?1:0),3),uN(t),X0(t,e),X0(t,~e),e&&t.pending_buf.set(t.window.subarray(n,n+e),t.pending),t.pending+=e};var J$={_tr_init:t=>{gN||((()=>{let t,n,e,i,r;const o=new Array(16);for(e=0,i=0;i<28;i++)for(mT[i]=e,t=0;t<1<<gT[i];t++)q0[e++]=i;for(q0[e-1]=i,r=0,i=0;i<16;i++)for(iC[i]=r,t=0;t<1<<nC[i];t++)Z0[r++]=i;for(r>>=7;i<30;i++)for(iC[i]=r<<7,t=0;t<1<<nC[i]-7;t++)Z0[256+r++]=i;for(n=0;n<=15;n++)o[n]=0;for(t=0;t<=143;)Fu[2*t+1]=8,t++,o[8]++;for(;t<=255;)Fu[2*t+1]=9,t++,o[9]++;for(;t<=279;)Fu[2*t+1]=7,t++,o[7]++;for(;t<=287;)Fu[2*t+1]=8,t++,o[8]++;for(lN(Fu,287,o),t=0;t<30;t++)Y0[2*t+1]=5,Y0[2*t]=aN(t,5);iN=new _T(Fu,gT,257,286,15),rN=new _T(Y0,nC,0,30,15),oN=new _T(new Array(0),R$,0,19,7)})(),gN=!0),t.l_desc=new bT(t.dyn_ltree,iN),t.d_desc=new bT(t.dyn_dtree,rN),t.bl_desc=new bT(t.bl_tree,oN),t.bi_buf=0,t.bi_valid=0,cN(t)},_tr_stored_block:mN,_tr_flush_block:(t,n,e,i)=>{let r,o,s=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),yT(t,t.l_desc),yT(t,t.d_desc),s=(t=>{let n;for(fN(t,t.dyn_ltree,t.l_desc.max_code),fN(t,t.dyn_dtree,t.d_desc.max_code),yT(t,t.bl_desc),n=18;n>=3&&0===t.bl_tree[2*nN[n]+1];n--);return t.opt_len+=3*(n+1)+5+5+4,n})(t),r=t.opt_len+3+7>>>3,o=t.static_len+3+7>>>3,o<=r&&(r=o)):r=o=e+5,e+4<=r&&-1!==n?mN(t,n,e,i):4===t.strategy||o===r?(Ta(t,2+(i?1:0),3),hN(t,Fu,Y0)):(Ta(t,4+(i?1:0),3),((t,n,e,i)=>{let r;for(Ta(t,n-257,5),Ta(t,e-1,5),Ta(t,i-4,4),r=0;r<i;r++)Ta(t,t.bl_tree[2*nN[r]+1],3);pN(t,t.dyn_ltree,n-1),pN(t,t.dyn_dtree,e-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,s+1),hN(t,t.dyn_ltree,t.dyn_dtree)),cN(t),i&&uN(t)},_tr_tally:(t,n,e)=>(t.pending_buf[t.sym_buf+t.sym_next++]=n,t.pending_buf[t.sym_buf+t.sym_next++]=n>>8,t.pending_buf[t.sym_buf+t.sym_next++]=e,0===n?t.dyn_ltree[2*e]++:(t.matches++,n--,t.dyn_ltree[2*(q0[e]+256+1)]++,t.dyn_dtree[2*sN(n)]++),t.sym_next===t.sym_end),_tr_align:t=>{Ta(t,2,3),kc(t,256,Fu),(t=>{16===t.bi_valid?(X0(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}},K0=(t,n,e,i)=>{let r=65535&t,o=t>>>16&65535,s=0;for(;0!==e;){s=e>2e3?2e3:e,e-=s;do{r=r+n[i++]|0,o=o+r|0}while(--s);r%=65521,o%=65521}return r|o<<16};const tY=new Uint32Array((()=>{let t,n=[];for(var e=0;e<256;e++){t=e;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;n[e]=t}return n})());var Jo=(t,n,e,i)=>{const r=tY,o=i+e;t^=-1;for(let s=i;s<o;s++)t=t>>>8^r[255&(t^n[s])];return~t},vf={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},yf={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:nY,_tr_stored_block:CT,_tr_flush_block:iY,_tr_tally:qd,_tr_align:rY}=J$,{Z_NO_FLUSH:Xd,Z_PARTIAL_FLUSH:oY,Z_FULL_FLUSH:sY,Z_FINISH:wl,Z_BLOCK:_N,Z_OK:_s,Z_STREAM_END:bN,Z_STREAM_ERROR:Oc,Z_DATA_ERROR:aY,Z_BUF_ERROR:xT,Z_DEFAULT_COMPRESSION:lY,Z_FILTERED:cY,Z_HUFFMAN_ONLY:rC,Z_RLE:uY,Z_FIXED:dY,Z_DEFAULT_STRATEGY:hY,Z_UNKNOWN:fY,Z_DEFLATED:oC}=yf,Ac=262,wf=(t,n)=>(t.msg=vf[n],n),vN=t=>2*t-(t>4?9:0),Qd=t=>{let n=t.length;for(;--n>=0;)t[n]=0},wY=t=>{let n,e,i,r=t.w_size;n=t.hash_size,i=n;do{e=t.head[--i],t.head[i]=e>=r?e-r:0}while(--n);n=r,i=n;do{e=t.prev[--i],t.prev[i]=e>=r?e-r:0}while(--n)};let Jd=(t,n,e)=>(n<<t.hash_shift^e)&t.hash_mask;const rl=t=>{const n=t.state;let e=n.pending;e>t.avail_out&&(e=t.avail_out),0!==e&&(t.output.set(n.pending_buf.subarray(n.pending_out,n.pending_out+e),t.next_out),t.next_out+=e,n.pending_out+=e,t.total_out+=e,t.avail_out-=e,n.pending-=e,0===n.pending&&(n.pending_out=0))},ol=(t,n)=>{iY(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,n),t.block_start=t.strstart,rl(t.strm)},Yi=(t,n)=>{t.pending_buf[t.pending++]=n},J0=(t,n)=>{t.pending_buf[t.pending++]=n>>>8&255,t.pending_buf[t.pending++]=255&n},DT=(t,n,e,i)=>{let r=t.avail_in;return r>i&&(r=i),0===r?0:(t.avail_in-=r,n.set(t.input.subarray(t.next_in,t.next_in+r),e),1===t.state.wrap?t.adler=K0(t.adler,n,r,e):2===t.state.wrap&&(t.adler=Jo(t.adler,n,r,e)),t.next_in+=r,t.total_in+=r,r)},yN=(t,n)=>{let r,o,e=t.max_chain_length,i=t.strstart,s=t.prev_length,a=t.nice_match;const c=t.strstart>t.w_size-Ac?t.strstart-(t.w_size-Ac):0,u=t.window,f=t.w_mask,b=t.prev,C=t.strstart+258;let x=u[i+s-1],M=u[i+s];t.prev_length>=t.good_match&&(e>>=2),a>t.lookahead&&(a=t.lookahead);do{if(r=n,u[r+s]===M&&u[r+s-1]===x&&u[r]===u[i]&&u[++r]===u[i+1]){i+=2,r++;do{}while(u[++i]===u[++r]&&u[++i]===u[++r]&&u[++i]===u[++r]&&u[++i]===u[++r]&&u[++i]===u[++r]&&u[++i]===u[++r]&&u[++i]===u[++r]&&u[++i]===u[++r]&&i<C);if(o=258-(C-i),i=C-258,o>s){if(t.match_start=n,s=o,o>=a)break;x=u[i+s-1],M=u[i+s]}}}while((n=b[n&f])>c&&0!=--e);return s<=t.lookahead?s:t.lookahead},Hg=t=>{const n=t.w_size;let e,i,r;do{if(i=t.window_size-t.lookahead-t.strstart,t.strstart>=n+(n-Ac)&&(t.window.set(t.window.subarray(n,n+n-i),0),t.match_start-=n,t.strstart-=n,t.block_start-=n,t.insert>t.strstart&&(t.insert=t.strstart),wY(t),i+=n),0===t.strm.avail_in)break;if(e=DT(t.strm,t.window,t.strstart+t.lookahead,i),t.lookahead+=e,t.lookahead+t.insert>=3)for(r=t.strstart-t.insert,t.ins_h=t.window[r],t.ins_h=Jd(t,t.ins_h,t.window[r+1]);t.insert&&(t.ins_h=Jd(t,t.ins_h,t.window[r+3-1]),t.prev[r&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=r,r++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<Ac&&0!==t.strm.avail_in)},CN=(t,n)=>{let i,r,o,e=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,s=0,a=t.strm.avail_in;do{if(i=65535,o=t.bi_valid+42>>3,t.strm.avail_out<o||(o=t.strm.avail_out-o,r=t.strstart-t.block_start,i>r+t.strm.avail_in&&(i=r+t.strm.avail_in),i>o&&(i=o),i<e&&(0===i&&n!==wl||n===Xd||i!==r+t.strm.avail_in)))break;s=n===wl&&i===r+t.strm.avail_in?1:0,CT(t,0,0,s),t.pending_buf[t.pending-4]=i,t.pending_buf[t.pending-3]=i>>8,t.pending_buf[t.pending-2]=~i,t.pending_buf[t.pending-1]=~i>>8,rl(t.strm),r&&(r>i&&(r=i),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+r),t.strm.next_out),t.strm.next_out+=r,t.strm.avail_out-=r,t.strm.total_out+=r,t.block_start+=r,i-=r),i&&(DT(t.strm,t.strm.output,t.strm.next_out,i),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i)}while(0===s);return a-=t.strm.avail_in,a&&(a>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=a&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-a,t.strm.next_in),t.strstart),t.strstart+=a,t.insert+=a>t.w_size-t.insert?t.w_size-t.insert:a),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),s?4:n!==Xd&&n!==wl&&0===t.strm.avail_in&&t.strstart===t.block_start?2:(o=t.window_size-t.strstart,t.strm.avail_in>o&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,o+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),o>t.strm.avail_in&&(o=t.strm.avail_in),o&&(DT(t.strm,t.window,t.strstart,o),t.strstart+=o,t.insert+=o>t.w_size-t.insert?t.w_size-t.insert:o),t.high_water<t.strstart&&(t.high_water=t.strstart),o=t.bi_valid+42>>3,o=t.pending_buf_size-o>65535?65535:t.pending_buf_size-o,e=o>t.w_size?t.w_size:o,r=t.strstart-t.block_start,(r>=e||(r||n===wl)&&n!==Xd&&0===t.strm.avail_in&&r<=o)&&(i=r>o?o:r,s=n===wl&&0===t.strm.avail_in&&i===r?1:0,CT(t,t.block_start,i,s),t.block_start+=i,rl(t.strm)),s?3:1)},kT=(t,n)=>{let e,i;for(;;){if(t.lookahead<Ac){if(Hg(t),t.lookahead<Ac&&n===Xd)return 1;if(0===t.lookahead)break}if(e=0,t.lookahead>=3&&(t.ins_h=Jd(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==e&&t.strstart-e<=t.w_size-Ac&&(t.match_length=yN(t,e)),t.match_length>=3)if(i=qd(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=Jd(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=Jd(t,t.ins_h,t.window[t.strstart+1]);else i=qd(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(ol(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,n===wl?(ol(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(ol(t,!1),0===t.strm.avail_out)?1:2},Vg=(t,n)=>{let e,i,r;for(;;){if(t.lookahead<Ac){if(Hg(t),t.lookahead<Ac&&n===Xd)return 1;if(0===t.lookahead)break}if(e=0,t.lookahead>=3&&(t.ins_h=Jd(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==e&&t.prev_length<t.max_lazy_match&&t.strstart-e<=t.w_size-Ac&&(t.match_length=yN(t,e),t.match_length<=5&&(t.strategy===cY||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-3,i=qd(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=Jd(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,i&&(ol(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(i=qd(t,0,t.window[t.strstart-1]),i&&ol(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=qd(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,n===wl?(ol(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(ol(t,!1),0===t.strm.avail_out)?1:2};function Pc(t,n,e,i,r){this.good_length=t,this.max_lazy=n,this.nice_length=e,this.max_chain=i,this.func=r}const eb=[new Pc(0,0,0,0,CN),new Pc(4,4,8,4,kT),new Pc(4,5,16,8,kT),new Pc(4,6,32,32,kT),new Pc(4,4,16,16,Vg),new Pc(8,16,32,32,Vg),new Pc(8,16,128,128,Vg),new Pc(8,32,128,256,Vg),new Pc(32,128,258,1024,Vg),new Pc(32,258,258,4096,Vg)];function SY(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=oC,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Qd(this.dyn_ltree),Qd(this.dyn_dtree),Qd(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Qd(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Qd(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const tb=t=>{if(!t)return 1;const n=t.state;return!n||n.strm!==t||42!==n.status&&57!==n.status&&69!==n.status&&73!==n.status&&91!==n.status&&103!==n.status&&113!==n.status&&666!==n.status?1:0},xN=t=>{if(tb(t))return wf(t,Oc);t.total_in=t.total_out=0,t.data_type=fY;const n=t.state;return n.pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=2===n.wrap?57:n.wrap?42:113,t.adler=2===n.wrap?0:1,n.last_flush=-2,nY(n),_s},wN=t=>{const n=xN(t);return n===_s&&(t=>{t.window_size=2*t.w_size,Qd(t.head),t.max_lazy_match=eb[t.level].max_lazy,t.good_match=eb[t.level].good_length,t.nice_match=eb[t.level].nice_length,t.max_chain_length=eb[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0})(t.state),n},EN=(t,n,e,i,r,o)=>{if(!t)return Oc;let s=1;if(n===lY&&(n=6),i<0?(s=0,i=-i):i>15&&(s=2,i-=16),r<1||r>9||e!==oC||i<8||i>15||n<0||n>9||o<0||o>dY||8===i&&1!==s)return wf(t,Oc);8===i&&(i=9);const a=new SY;return t.state=a,a.strm=t,a.status=42,a.wrap=s,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=r+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<r+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=n,a.strategy=o,a.method=e,wN(t)};var nb={deflateInit:(t,n)=>EN(t,n,oC,15,8,hY),deflateInit2:EN,deflateReset:wN,deflateResetKeep:xN,deflateSetHeader:(t,n)=>tb(t)||2!==t.state.wrap?Oc:(t.state.gzhead=n,_s),deflate:(t,n)=>{if(tb(t)||n>_N||n<0)return t?wf(t,Oc):Oc;const e=t.state;if(!t.output||0!==t.avail_in&&!t.input||666===e.status&&n!==wl)return wf(t,0===t.avail_out?xT:Oc);const i=e.last_flush;if(e.last_flush=n,0!==e.pending){if(rl(t),0===t.avail_out)return e.last_flush=-1,_s}else if(0===t.avail_in&&vN(n)<=vN(i)&&n!==wl)return wf(t,xT);if(666===e.status&&0!==t.avail_in)return wf(t,xT);if(42===e.status&&0===e.wrap&&(e.status=113),42===e.status){let r=oC+(e.w_bits-8<<4)<<8,o=-1;if(o=e.strategy>=rC||e.level<2?0:e.level<6?1:6===e.level?2:3,r|=o<<6,0!==e.strstart&&(r|=32),r+=31-r%31,J0(e,r),0!==e.strstart&&(J0(e,t.adler>>>16),J0(e,65535&t.adler)),t.adler=1,e.status=113,rl(t),0!==e.pending)return e.last_flush=-1,_s}if(57===e.status)if(t.adler=0,Yi(e,31),Yi(e,139),Yi(e,8),e.gzhead)Yi(e,(e.gzhead.text?1:0)+(e.gzhead.hcrc?2:0)+(e.gzhead.extra?4:0)+(e.gzhead.name?8:0)+(e.gzhead.comment?16:0)),Yi(e,255&e.gzhead.time),Yi(e,e.gzhead.time>>8&255),Yi(e,e.gzhead.time>>16&255),Yi(e,e.gzhead.time>>24&255),Yi(e,9===e.level?2:e.strategy>=rC||e.level<2?4:0),Yi(e,255&e.gzhead.os),e.gzhead.extra&&e.gzhead.extra.length&&(Yi(e,255&e.gzhead.extra.length),Yi(e,e.gzhead.extra.length>>8&255)),e.gzhead.hcrc&&(t.adler=Jo(t.adler,e.pending_buf,e.pending,0)),e.gzindex=0,e.status=69;else if(Yi(e,0),Yi(e,0),Yi(e,0),Yi(e,0),Yi(e,0),Yi(e,9===e.level?2:e.strategy>=rC||e.level<2?4:0),Yi(e,3),e.status=113,rl(t),0!==e.pending)return e.last_flush=-1,_s;if(69===e.status){if(e.gzhead.extra){let r=e.pending,o=(65535&e.gzhead.extra.length)-e.gzindex;for(;e.pending+o>e.pending_buf_size;){let a=e.pending_buf_size-e.pending;if(e.pending_buf.set(e.gzhead.extra.subarray(e.gzindex,e.gzindex+a),e.pending),e.pending=e.pending_buf_size,e.gzhead.hcrc&&e.pending>r&&(t.adler=Jo(t.adler,e.pending_buf,e.pending-r,r)),e.gzindex+=a,rl(t),0!==e.pending)return e.last_flush=-1,_s;r=0,o-=a}let s=new Uint8Array(e.gzhead.extra);e.pending_buf.set(s.subarray(e.gzindex,e.gzindex+o),e.pending),e.pending+=o,e.gzhead.hcrc&&e.pending>r&&(t.adler=Jo(t.adler,e.pending_buf,e.pending-r,r)),e.gzindex=0}e.status=73}if(73===e.status){if(e.gzhead.name){let o,r=e.pending;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>r&&(t.adler=Jo(t.adler,e.pending_buf,e.pending-r,r)),rl(t),0!==e.pending)return e.last_flush=-1,_s;r=0}o=e.gzindex<e.gzhead.name.length?255&e.gzhead.name.charCodeAt(e.gzindex++):0,Yi(e,o)}while(0!==o);e.gzhead.hcrc&&e.pending>r&&(t.adler=Jo(t.adler,e.pending_buf,e.pending-r,r)),e.gzindex=0}e.status=91}if(91===e.status){if(e.gzhead.comment){let o,r=e.pending;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>r&&(t.adler=Jo(t.adler,e.pending_buf,e.pending-r,r)),rl(t),0!==e.pending)return e.last_flush=-1,_s;r=0}o=e.gzindex<e.gzhead.comment.length?255&e.gzhead.comment.charCodeAt(e.gzindex++):0,Yi(e,o)}while(0!==o);e.gzhead.hcrc&&e.pending>r&&(t.adler=Jo(t.adler,e.pending_buf,e.pending-r,r))}e.status=103}if(103===e.status){if(e.gzhead.hcrc){if(e.pending+2>e.pending_buf_size&&(rl(t),0!==e.pending))return e.last_flush=-1,_s;Yi(e,255&t.adler),Yi(e,t.adler>>8&255),t.adler=0}if(e.status=113,rl(t),0!==e.pending)return e.last_flush=-1,_s}if(0!==t.avail_in||0!==e.lookahead||n!==Xd&&666!==e.status){let r=0===e.level?CN(e,n):e.strategy===rC?((t,n)=>{let e;for(;;){if(0===t.lookahead&&(Hg(t),0===t.lookahead)){if(n===Xd)return 1;break}if(t.match_length=0,e=qd(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,e&&(ol(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,n===wl?(ol(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(ol(t,!1),0===t.strm.avail_out)?1:2})(e,n):e.strategy===uY?((t,n)=>{let e,i,r,o;const s=t.window;for(;;){if(t.lookahead<=258){if(Hg(t),t.lookahead<=258&&n===Xd)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(r=t.strstart-1,i=s[r],i===s[++r]&&i===s[++r]&&i===s[++r])){o=t.strstart+258;do{}while(i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&r<o);t.match_length=258-(o-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(e=qd(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(e=qd(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),e&&(ol(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,n===wl?(ol(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(ol(t,!1),0===t.strm.avail_out)?1:2})(e,n):eb[e.level].func(e,n);if((3===r||4===r)&&(e.status=666),1===r||3===r)return 0===t.avail_out&&(e.last_flush=-1),_s;if(2===r&&(n===oY?rY(e):n!==_N&&(CT(e,0,0,!1),n===sY&&(Qd(e.head),0===e.lookahead&&(e.strstart=0,e.block_start=0,e.insert=0))),rl(t),0===t.avail_out))return e.last_flush=-1,_s}return n!==wl?_s:e.wrap<=0?bN:(2===e.wrap?(Yi(e,255&t.adler),Yi(e,t.adler>>8&255),Yi(e,t.adler>>16&255),Yi(e,t.adler>>24&255),Yi(e,255&t.total_in),Yi(e,t.total_in>>8&255),Yi(e,t.total_in>>16&255),Yi(e,t.total_in>>24&255)):(J0(e,t.adler>>>16),J0(e,65535&t.adler)),rl(t),e.wrap>0&&(e.wrap=-e.wrap),0!==e.pending?_s:bN)},deflateEnd:t=>{if(tb(t))return Oc;const n=t.state.status;return t.state=null,113===n?wf(t,aY):_s},deflateSetDictionary:(t,n)=>{let e=n.length;if(tb(t))return Oc;const i=t.state,r=i.wrap;if(2===r||1===r&&42!==i.status||i.lookahead)return Oc;if(1===r&&(t.adler=K0(t.adler,n,e,0)),i.wrap=0,e>=i.w_size){0===r&&(Qd(i.head),i.strstart=0,i.block_start=0,i.insert=0);let c=new Uint8Array(i.w_size);c.set(n.subarray(e-i.w_size,e),0),n=c,e=i.w_size}const o=t.avail_in,s=t.next_in,a=t.input;for(t.avail_in=e,t.next_in=0,t.input=n,Hg(i);i.lookahead>=3;){let c=i.strstart,u=i.lookahead-2;do{i.ins_h=Jd(i,i.ins_h,i.window[c+3-1]),i.prev[c&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=c,c++}while(--u);i.strstart=c,i.lookahead=2,Hg(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,t.next_in=s,t.input=a,t.avail_in=o,i.wrap=r,_s},deflateInfo:"pako deflate (from Nodeca project)"};const VY=(t,n)=>Object.prototype.hasOwnProperty.call(t,n);var sC={assign:function(t){const n=Array.prototype.slice.call(arguments,1);for(;n.length;){const e=n.shift();if(e){if("object"!=typeof e)throw new TypeError(e+"must be non-object");for(const i in e)VY(e,i)&&(t[i]=e[i])}}return t},flattenChunks:t=>{let n=0;for(let i=0,r=t.length;i<r;i++)n+=t[i].length;const e=new Uint8Array(n);for(let i=0,r=0,o=t.length;i<o;i++){let s=t[i];e.set(s,r),r+=s.length}return e}};let IN=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{IN=!1}const ib=new Uint8Array(256);for(let t=0;t<256;t++)ib[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;ib[254]=ib[254]=1;var rb={string2buf:t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let n,e,i,r,o,s=t.length,a=0;for(r=0;r<s;r++)e=t.charCodeAt(r),55296==(64512&e)&&r+1<s&&(i=t.charCodeAt(r+1),56320==(64512&i)&&(e=65536+(e-55296<<10)+(i-56320),r++)),a+=e<128?1:e<2048?2:e<65536?3:4;for(n=new Uint8Array(a),o=0,r=0;o<a;r++)e=t.charCodeAt(r),55296==(64512&e)&&r+1<s&&(i=t.charCodeAt(r+1),56320==(64512&i)&&(e=65536+(e-55296<<10)+(i-56320),r++)),e<128?n[o++]=e:e<2048?(n[o++]=192|e>>>6,n[o++]=128|63&e):e<65536?(n[o++]=224|e>>>12,n[o++]=128|e>>>6&63,n[o++]=128|63&e):(n[o++]=240|e>>>18,n[o++]=128|e>>>12&63,n[o++]=128|e>>>6&63,n[o++]=128|63&e);return n},buf2string:(t,n)=>{const e=n||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,n));let i,r;const o=new Array(2*e);for(r=0,i=0;i<e;){let s=t[i++];if(s<128){o[r++]=s;continue}let a=ib[s];if(a>4)o[r++]=65533,i+=a-1;else{for(s&=2===a?31:3===a?15:7;a>1&&i<e;)s=s<<6|63&t[i++],a--;a>1?o[r++]=65533:s<65536?o[r++]=s:(s-=65536,o[r++]=55296|s>>10&1023,o[r++]=56320|1023&s)}}return((t,n)=>{if(n<65534&&t.subarray&&IN)return String.fromCharCode.apply(null,t.length===n?t:t.subarray(0,n));let e="";for(let i=0;i<n;i++)e+=String.fromCharCode(t[i]);return e})(o,r)},utf8border:(t,n)=>{(n=n||t.length)>t.length&&(n=t.length);let e=n-1;for(;e>=0&&128==(192&t[e]);)e--;return e<0||0===e?n:e+ib[t[e]]>n?e:n}},TN=function qY(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const SN=Object.prototype.toString,{Z_NO_FLUSH:XY,Z_SYNC_FLUSH:KY,Z_FULL_FLUSH:QY,Z_FINISH:JY,Z_OK:aC,Z_STREAM_END:eZ,Z_DEFAULT_COMPRESSION:tZ,Z_DEFAULT_STRATEGY:nZ,Z_DEFLATED:iZ}=yf;function ob(t){this.options=sC.assign({level:tZ,method:iZ,chunkSize:16384,windowBits:15,memLevel:8,strategy:nZ},t||{});let n=this.options;n.raw&&n.windowBits>0?n.windowBits=-n.windowBits:n.gzip&&n.windowBits>0&&n.windowBits<16&&(n.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new TN,this.strm.avail_out=0;let e=nb.deflateInit2(this.strm,n.level,n.method,n.windowBits,n.memLevel,n.strategy);if(e!==aC)throw new Error(vf[e]);if(n.header&&nb.deflateSetHeader(this.strm,n.header),n.dictionary){let i;if(i="string"==typeof n.dictionary?rb.string2buf(n.dictionary):"[object ArrayBuffer]"===SN.call(n.dictionary)?new Uint8Array(n.dictionary):n.dictionary,e=nb.deflateSetDictionary(this.strm,i),e!==aC)throw new Error(vf[e]);this._dict_set=!0}}function OT(t,n){const e=new ob(n);if(e.push(t,!0),e.err)throw e.msg||vf[e.err];return e.result}ob.prototype.push=function(t,n){const e=this.strm,i=this.options.chunkSize;let r,o;if(this.ended)return!1;for(o=n===~~n?n:!0===n?JY:XY,e.input="string"==typeof t?rb.string2buf(t):"[object ArrayBuffer]"===SN.call(t)?new Uint8Array(t):t,e.next_in=0,e.avail_in=e.input.length;;)if(0===e.avail_out&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),(o===KY||o===QY)&&e.avail_out<=6)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else{if(r=nb.deflate(e,o),r===eZ)return e.next_out>0&&this.onData(e.output.subarray(0,e.next_out)),r=nb.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===aC;if(0!==e.avail_out){if(o>0&&e.next_out>0)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else if(0===e.avail_in)break}else this.onData(e.output)}return!0},ob.prototype.onData=function(t){this.chunks.push(t)},ob.prototype.onEnd=function(t){t===aC&&(this.result=sC.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var dZ={Deflate:ob,deflate:OT,deflateRaw:function rZ(t,n){return(n=n||{}).raw=!0,OT(t,n)},gzip:function oZ(t,n){return(n=n||{}).gzip=!0,OT(t,n)},constants:yf};const lC=16209;var fZ=function(n,e){let i,r,o,s,a,c,u,f,b,C,x,M,U,W,K,$,ge,ye,lt,Ee,Be,ft,rt,ht;const xt=n.state;i=n.next_in,rt=n.input,r=i+(n.avail_in-5),o=n.next_out,ht=n.output,s=o-(e-n.avail_out),a=o+(n.avail_out-257),c=xt.dmax,u=xt.wsize,f=xt.whave,b=xt.wnext,C=xt.window,x=xt.hold,M=xt.bits,U=xt.lencode,W=xt.distcode,K=(1<<xt.lenbits)-1,$=(1<<xt.distbits)-1;e:do{M<15&&(x+=rt[i++]<<M,M+=8,x+=rt[i++]<<M,M+=8),ge=U[x&K];t:for(;;){if(ye=ge>>>24,x>>>=ye,M-=ye,ye=ge>>>16&255,0===ye)ht[o++]=65535&ge;else{if(!(16&ye)){if(64&ye){if(32&ye){xt.mode=16191;break e}n.msg="invalid literal/length code",xt.mode=lC;break e}ge=U[(65535&ge)+(x&(1<<ye)-1)];continue t}for(lt=65535&ge,ye&=15,ye&&(M<ye&&(x+=rt[i++]<<M,M+=8),lt+=x&(1<<ye)-1,x>>>=ye,M-=ye),M<15&&(x+=rt[i++]<<M,M+=8,x+=rt[i++]<<M,M+=8),ge=W[x&$];;){if(ye=ge>>>24,x>>>=ye,M-=ye,ye=ge>>>16&255,16&ye){if(Ee=65535&ge,ye&=15,M<ye&&(x+=rt[i++]<<M,M+=8,M<ye&&(x+=rt[i++]<<M,M+=8)),Ee+=x&(1<<ye)-1,Ee>c){n.msg="invalid distance too far back",xt.mode=lC;break e}if(x>>>=ye,M-=ye,ye=o-s,Ee>ye){if(ye=Ee-ye,ye>f&&xt.sane){n.msg="invalid distance too far back",xt.mode=lC;break e}if(Be=0,ft=C,0===b){if(Be+=u-ye,ye<lt){lt-=ye;do{ht[o++]=C[Be++]}while(--ye);Be=o-Ee,ft=ht}}else if(b<ye){if(Be+=u+b-ye,ye-=b,ye<lt){lt-=ye;do{ht[o++]=C[Be++]}while(--ye);if(Be=0,b<lt){ye=b,lt-=ye;do{ht[o++]=C[Be++]}while(--ye);Be=o-Ee,ft=ht}}}else if(Be+=b-ye,ye<lt){lt-=ye;do{ht[o++]=C[Be++]}while(--ye);Be=o-Ee,ft=ht}for(;lt>2;)ht[o++]=ft[Be++],ht[o++]=ft[Be++],ht[o++]=ft[Be++],lt-=3;lt&&(ht[o++]=ft[Be++],lt>1&&(ht[o++]=ft[Be++]))}else{Be=o-Ee;do{ht[o++]=ht[Be++],ht[o++]=ht[Be++],ht[o++]=ht[Be++],lt-=3}while(lt>2);lt&&(ht[o++]=ht[Be++],lt>1&&(ht[o++]=ht[Be++]))}break}if(64&ye){n.msg="invalid distance code",xt.mode=lC;break e}ge=W[(65535&ge)+(x&(1<<ye)-1)]}}break}}while(i<r&&o<a);lt=M>>3,i-=lt,M-=lt<<3,x&=(1<<M)-1,n.next_in=i,n.next_out=o,n.avail_in=i<r?r-i+5:5-(i-r),n.avail_out=o<a?a-o+257:257-(o-a),xt.hold=x,xt.bits=M};const pZ=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),gZ=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),mZ=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),_Z=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var sb=(t,n,e,i,r,o,s,a)=>{const c=a.bits;let ge,ye,lt,Ee,Be,rt,u=0,f=0,b=0,C=0,x=0,M=0,U=0,W=0,K=0,$=0,ft=null;const ht=new Uint16Array(16),xt=new Uint16Array(16);let Qt,ln,Mn,pt=null;for(u=0;u<=15;u++)ht[u]=0;for(f=0;f<i;f++)ht[n[e+f]]++;for(x=c,C=15;C>=1&&0===ht[C];C--);if(x>C&&(x=C),0===C)return r[o++]=20971520,r[o++]=20971520,a.bits=1,0;for(b=1;b<C&&0===ht[b];b++);for(x<b&&(x=b),W=1,u=1;u<=15;u++)if(W<<=1,W-=ht[u],W<0)return-1;if(W>0&&(0===t||1!==C))return-1;for(xt[1]=0,u=1;u<15;u++)xt[u+1]=xt[u]+ht[u];for(f=0;f<i;f++)0!==n[e+f]&&(s[xt[n[e+f]]++]=f);if(0===t?(ft=pt=s,rt=20):1===t?(ft=pZ,pt=gZ,rt=257):(ft=mZ,pt=_Z,rt=0),$=0,f=0,u=b,Be=o,M=x,U=0,lt=-1,K=1<<x,Ee=K-1,1===t&&K>852||2===t&&K>592)return 1;for(;;){Qt=u-U,s[f]+1<rt?(ln=0,Mn=s[f]):s[f]>=rt?(ln=pt[s[f]-rt],Mn=ft[s[f]-rt]):(ln=96,Mn=0),ge=1<<u-U,ye=1<<M,b=ye;do{ye-=ge,r[Be+($>>U)+ye]=Qt<<24|ln<<16|Mn}while(0!==ye);for(ge=1<<u-1;$&ge;)ge>>=1;if(0!==ge?($&=ge-1,$+=ge):$=0,f++,0==--ht[u]){if(u===C)break;u=n[e+s[f]]}if(u>x&&($&Ee)!==lt){for(0===U&&(U=x),Be+=b,M=u-U,W=1<<M;M+U<C&&(W-=ht[M+U],!(W<=0));)M++,W<<=1;if(K+=1<<M,1===t&&K>852||2===t&&K>592)return 1;lt=$&Ee,r[lt]=x<<24|M<<16|Be-o}}return 0!==$&&(r[Be+$]=u-U<<24|64<<16),a.bits=x,0};const{Z_FINISH:FN,Z_BLOCK:vZ,Z_TREES:cC,Z_OK:Ef,Z_STREAM_END:yZ,Z_NEED_DICT:CZ,Z_STREAM_ERROR:El,Z_DATA_ERROR:NN,Z_MEM_ERROR:RN,Z_BUF_ERROR:xZ,Z_DEFLATED:LN}=yf,uC=16180,dC=16190,Nu=16191,hC=16199,fC=16200,Br=16209,aR=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function TZ(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const If=t=>{if(!t)return 1;const n=t.state;return!n||n.strm!==t||n.mode<uC||n.mode>16211?1:0},lR=t=>{if(If(t))return El;const n=t.state;return t.total_in=t.total_out=n.total=0,t.msg="",n.wrap&&(t.adler=1&n.wrap),n.mode=uC,n.last=0,n.havedict=0,n.flags=-1,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new Int32Array(852),n.distcode=n.distdyn=new Int32Array(592),n.sane=1,n.back=-1,Ef},cR=t=>{if(If(t))return El;const n=t.state;return n.wsize=0,n.whave=0,n.wnext=0,lR(t)},uR=(t,n)=>{let e;if(If(t))return El;const i=t.state;return n<0?(e=0,n=-n):(e=5+(n>>4),n<48&&(n&=15)),n&&(n<8||n>15)?El:(null!==i.window&&i.wbits!==n&&(i.window=null),i.wrap=e,i.wbits=n,cR(t))},dR=(t,n)=>{if(!t)return El;const e=new TZ;t.state=e,e.strm=t,e.window=null,e.mode=uC;const i=uR(t,n);return i!==Ef&&(t.state=null),i};let RT,LT,hR=!0;const MZ=t=>{if(hR){RT=new Int32Array(512),LT=new Int32Array(32);let n=0;for(;n<144;)t.lens[n++]=8;for(;n<256;)t.lens[n++]=9;for(;n<280;)t.lens[n++]=7;for(;n<288;)t.lens[n++]=8;for(sb(1,t.lens,0,288,RT,0,t.work,{bits:9}),n=0;n<32;)t.lens[n++]=5;sb(2,t.lens,0,32,LT,0,t.work,{bits:5}),hR=!1}t.lencode=RT,t.lenbits=9,t.distcode=LT,t.distbits=5},fR=(t,n,e,i)=>{let r;const o=t.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),i>=o.wsize?(o.window.set(n.subarray(e-o.wsize,e),0),o.wnext=0,o.whave=o.wsize):(r=o.wsize-o.wnext,r>i&&(r=i),o.window.set(n.subarray(e-i,e-i+r),o.wnext),(i-=r)?(o.window.set(n.subarray(e-i,e),0),o.wnext=i,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0};var Ru={inflateReset:cR,inflateReset2:uR,inflateResetKeep:lR,inflateInit:t=>dR(t,15),inflateInit2:dR,inflate:(t,n)=>{let e,i,r,o,s,a,c,u,f,b,C,x,M,U,K,$,ge,ye,lt,Ee,Be,ft,W=0;const rt=new Uint8Array(4);let ht,xt;const pt=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(If(t)||!t.output||!t.input&&0!==t.avail_in)return El;e=t.state,e.mode===Nu&&(e.mode=16192),s=t.next_out,r=t.output,c=t.avail_out,o=t.next_in,i=t.input,a=t.avail_in,u=e.hold,f=e.bits,b=a,C=c,ft=Ef;e:for(;;)switch(e.mode){case uC:if(0===e.wrap){e.mode=16192;break}for(;f<16;){if(0===a)break e;a--,u+=i[o++]<<f,f+=8}if(2&e.wrap&&35615===u){0===e.wbits&&(e.wbits=15),e.check=0,rt[0]=255&u,rt[1]=u>>>8&255,e.check=Jo(e.check,rt,2,0),u=0,f=0,e.mode=16181;break}if(e.head&&(e.head.done=!1),!(1&e.wrap)||(((255&u)<<8)+(u>>8))%31){t.msg="incorrect header check",e.mode=Br;break}if((15&u)!==LN){t.msg="unknown compression method",e.mode=Br;break}if(u>>>=4,f-=4,Be=8+(15&u),0===e.wbits&&(e.wbits=Be),Be>15||Be>e.wbits){t.msg="invalid window size",e.mode=Br;break}e.dmax=1<<e.wbits,e.flags=0,t.adler=e.check=1,e.mode=512&u?16189:Nu,u=0,f=0;break;case 16181:for(;f<16;){if(0===a)break e;a--,u+=i[o++]<<f,f+=8}if(e.flags=u,(255&e.flags)!==LN){t.msg="unknown compression method",e.mode=Br;break}if(57344&e.flags){t.msg="unknown header flags set",e.mode=Br;break}e.head&&(e.head.text=u>>8&1),512&e.flags&&4&e.wrap&&(rt[0]=255&u,rt[1]=u>>>8&255,e.check=Jo(e.check,rt,2,0)),u=0,f=0,e.mode=16182;case 16182:for(;f<32;){if(0===a)break e;a--,u+=i[o++]<<f,f+=8}e.head&&(e.head.time=u),512&e.flags&&4&e.wrap&&(rt[0]=255&u,rt[1]=u>>>8&255,rt[2]=u>>>16&255,rt[3]=u>>>24&255,e.check=Jo(e.check,rt,4,0)),u=0,f=0,e.mode=16183;case 16183:for(;f<16;){if(0===a)break e;a--,u+=i[o++]<<f,f+=8}e.head&&(e.head.xflags=255&u,e.head.os=u>>8),512&e.flags&&4&e.wrap&&(rt[0]=255&u,rt[1]=u>>>8&255,e.check=Jo(e.check,rt,2,0)),u=0,f=0,e.mode=16184;case 16184:if(1024&e.flags){for(;f<16;){if(0===a)break e;a--,u+=i[o++]<<f,f+=8}e.length=u,e.head&&(e.head.extra_len=u),512&e.flags&&4&e.wrap&&(rt[0]=255&u,rt[1]=u>>>8&255,e.check=Jo(e.check,rt,2,0)),u=0,f=0}else e.head&&(e.head.extra=null);e.mode=16185;case 16185:if(1024&e.flags&&(x=e.length,x>a&&(x=a),x&&(e.head&&(Be=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(i.subarray(o,o+x),Be)),512&e.flags&&4&e.wrap&&(e.check=Jo(e.check,i,x,o)),a-=x,o+=x,e.length-=x),e.length))break e;e.length=0,e.mode=16186;case 16186:if(2048&e.flags){if(0===a)break e;x=0;do{Be=i[o+x++],e.head&&Be&&e.length<65536&&(e.head.name+=String.fromCharCode(Be))}while(Be&&x<a);if(512&e.flags&&4&e.wrap&&(e.check=Jo(e.check,i,x,o)),a-=x,o+=x,Be)break e}else e.head&&(e.head.name=null);e.length=0,e.mode=16187;case 16187:if(4096&e.flags){if(0===a)break e;x=0;do{Be=i[o+x++],e.head&&Be&&e.length<65536&&(e.head.comment+=String.fromCharCode(Be))}while(Be&&x<a);if(512&e.flags&&4&e.wrap&&(e.check=Jo(e.check,i,x,o)),a-=x,o+=x,Be)break e}else e.head&&(e.head.comment=null);e.mode=16188;case 16188:if(512&e.flags){for(;f<16;){if(0===a)break e;a--,u+=i[o++]<<f,f+=8}if(4&e.wrap&&u!==(65535&e.check)){t.msg="header crc mismatch",e.mode=Br;break}u=0,f=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),t.adler=e.check=0,e.mode=Nu;break;case 16189:for(;f<32;){if(0===a)break e;a--,u+=i[o++]<<f,f+=8}t.adler=e.check=aR(u),u=0,f=0,e.mode=dC;case dC:if(0===e.havedict)return t.next_out=s,t.avail_out=c,t.next_in=o,t.avail_in=a,e.hold=u,e.bits=f,CZ;t.adler=e.check=1,e.mode=Nu;case Nu:if(n===vZ||n===cC)break e;case 16192:if(e.last){u>>>=7&f,f-=7&f,e.mode=16206;break}for(;f<3;){if(0===a)break e;a--,u+=i[o++]<<f,f+=8}switch(e.last=1&u,u>>>=1,f-=1,3&u){case 0:e.mode=16193;break;case 1:if(MZ(e),e.mode=hC,n===cC){u>>>=2,f-=2;break e}break;case 2:e.mode=16196;break;case 3:t.msg="invalid block type",e.mode=Br}u>>>=2,f-=2;break;case 16193:for(u>>>=7&f,f-=7&f;f<32;){if(0===a)break e;a--,u+=i[o++]<<f,f+=8}if((65535&u)!=(u>>>16^65535)){t.msg="invalid stored block lengths",e.mode=Br;break}if(e.length=65535&u,u=0,f=0,e.mode=16194,n===cC)break e;case 16194:e.mode=16195;case 16195:if(x=e.length,x){if(x>a&&(x=a),x>c&&(x=c),0===x)break e;r.set(i.subarray(o,o+x),s),a-=x,o+=x,c-=x,s+=x,e.length-=x;break}e.mode=Nu;break;case 16196:for(;f<14;){if(0===a)break e;a--,u+=i[o++]<<f,f+=8}if(e.nlen=257+(31&u),u>>>=5,f-=5,e.ndist=1+(31&u),u>>>=5,f-=5,e.ncode=4+(15&u),u>>>=4,f-=4,e.nlen>286||e.ndist>30){t.msg="too many length or distance symbols",e.mode=Br;break}e.have=0,e.mode=16197;case 16197:for(;e.have<e.ncode;){for(;f<3;){if(0===a)break e;a--,u+=i[o++]<<f,f+=8}e.lens[pt[e.have++]]=7&u,u>>>=3,f-=3}for(;e.have<19;)e.lens[pt[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,ht={bits:e.lenbits},ft=sb(0,e.lens,0,19,e.lencode,0,e.work,ht),e.lenbits=ht.bits,ft){t.msg="invalid code lengths set",e.mode=Br;break}e.have=0,e.mode=16198;case 16198:for(;e.have<e.nlen+e.ndist;){for(;W=e.lencode[u&(1<<e.lenbits)-1],K=W>>>24,$=W>>>16&255,ge=65535&W,!(K<=f);){if(0===a)break e;a--,u+=i[o++]<<f,f+=8}if(ge<16)u>>>=K,f-=K,e.lens[e.have++]=ge;else{if(16===ge){for(xt=K+2;f<xt;){if(0===a)break e;a--,u+=i[o++]<<f,f+=8}if(u>>>=K,f-=K,0===e.have){t.msg="invalid bit length repeat",e.mode=Br;break}Be=e.lens[e.have-1],x=3+(3&u),u>>>=2,f-=2}else if(17===ge){for(xt=K+3;f<xt;){if(0===a)break e;a--,u+=i[o++]<<f,f+=8}u>>>=K,f-=K,Be=0,x=3+(7&u),u>>>=3,f-=3}else{for(xt=K+7;f<xt;){if(0===a)break e;a--,u+=i[o++]<<f,f+=8}u>>>=K,f-=K,Be=0,x=11+(127&u),u>>>=7,f-=7}if(e.have+x>e.nlen+e.ndist){t.msg="invalid bit length repeat",e.mode=Br;break}for(;x--;)e.lens[e.have++]=Be}}if(e.mode===Br)break;if(0===e.lens[256]){t.msg="invalid code -- missing end-of-block",e.mode=Br;break}if(e.lenbits=9,ht={bits:e.lenbits},ft=sb(1,e.lens,0,e.nlen,e.lencode,0,e.work,ht),e.lenbits=ht.bits,ft){t.msg="invalid literal/lengths set",e.mode=Br;break}if(e.distbits=6,e.distcode=e.distdyn,ht={bits:e.distbits},ft=sb(2,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,ht),e.distbits=ht.bits,ft){t.msg="invalid distances set",e.mode=Br;break}if(e.mode=hC,n===cC)break e;case hC:e.mode=fC;case fC:if(a>=6&&c>=258){t.next_out=s,t.avail_out=c,t.next_in=o,t.avail_in=a,e.hold=u,e.bits=f,fZ(t,C),s=t.next_out,r=t.output,c=t.avail_out,o=t.next_in,i=t.input,a=t.avail_in,u=e.hold,f=e.bits,e.mode===Nu&&(e.back=-1);break}for(e.back=0;W=e.lencode[u&(1<<e.lenbits)-1],K=W>>>24,$=W>>>16&255,ge=65535&W,!(K<=f);){if(0===a)break e;a--,u+=i[o++]<<f,f+=8}if($&&!(240&$)){for(ye=K,lt=$,Ee=ge;W=e.lencode[Ee+((u&(1<<ye+lt)-1)>>ye)],K=W>>>24,$=W>>>16&255,ge=65535&W,!(ye+K<=f);){if(0===a)break e;a--,u+=i[o++]<<f,f+=8}u>>>=ye,f-=ye,e.back+=ye}if(u>>>=K,f-=K,e.back+=K,e.length=ge,0===$){e.mode=16205;break}if(32&$){e.back=-1,e.mode=Nu;break}if(64&$){t.msg="invalid literal/length code",e.mode=Br;break}e.extra=15&$,e.mode=16201;case 16201:if(e.extra){for(xt=e.extra;f<xt;){if(0===a)break e;a--,u+=i[o++]<<f,f+=8}e.length+=u&(1<<e.extra)-1,u>>>=e.extra,f-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=16202;case 16202:for(;W=e.distcode[u&(1<<e.distbits)-1],K=W>>>24,$=W>>>16&255,ge=65535&W,!(K<=f);){if(0===a)break e;a--,u+=i[o++]<<f,f+=8}if(!(240&$)){for(ye=K,lt=$,Ee=ge;W=e.distcode[Ee+((u&(1<<ye+lt)-1)>>ye)],K=W>>>24,$=W>>>16&255,ge=65535&W,!(ye+K<=f);){if(0===a)break e;a--,u+=i[o++]<<f,f+=8}u>>>=ye,f-=ye,e.back+=ye}if(u>>>=K,f-=K,e.back+=K,64&$){t.msg="invalid distance code",e.mode=Br;break}e.offset=ge,e.extra=15&$,e.mode=16203;case 16203:if(e.extra){for(xt=e.extra;f<xt;){if(0===a)break e;a--,u+=i[o++]<<f,f+=8}e.offset+=u&(1<<e.extra)-1,u>>>=e.extra,f-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){t.msg="invalid distance too far back",e.mode=Br;break}e.mode=16204;case 16204:if(0===c)break e;if(x=C-c,e.offset>x){if(x=e.offset-x,x>e.whave&&e.sane){t.msg="invalid distance too far back",e.mode=Br;break}x>e.wnext?(x-=e.wnext,M=e.wsize-x):M=e.wnext-x,x>e.length&&(x=e.length),U=e.window}else U=r,M=s-e.offset,x=e.length;x>c&&(x=c),c-=x,e.length-=x;do{r[s++]=U[M++]}while(--x);0===e.length&&(e.mode=fC);break;case 16205:if(0===c)break e;r[s++]=e.length,c--,e.mode=fC;break;case 16206:if(e.wrap){for(;f<32;){if(0===a)break e;a--,u|=i[o++]<<f,f+=8}if(C-=c,t.total_out+=C,e.total+=C,4&e.wrap&&C&&(t.adler=e.check=e.flags?Jo(e.check,r,C,s-C):K0(e.check,r,C,s-C)),C=c,4&e.wrap&&(e.flags?u:aR(u))!==e.check){t.msg="incorrect data check",e.mode=Br;break}u=0,f=0}e.mode=16207;case 16207:if(e.wrap&&e.flags){for(;f<32;){if(0===a)break e;a--,u+=i[o++]<<f,f+=8}if(4&e.wrap&&u!==(4294967295&e.total)){t.msg="incorrect length check",e.mode=Br;break}u=0,f=0}e.mode=16208;case 16208:ft=yZ;break e;case Br:ft=NN;break e;case 16210:return RN;default:return El}return t.next_out=s,t.avail_out=c,t.next_in=o,t.avail_in=a,e.hold=u,e.bits=f,(e.wsize||C!==t.avail_out&&e.mode<Br&&(e.mode<16206||n!==FN))&&fR(t,t.output,t.next_out,C-t.avail_out),b-=t.avail_in,C-=t.avail_out,t.total_in+=b,t.total_out+=C,e.total+=C,4&e.wrap&&C&&(t.adler=e.check=e.flags?Jo(e.check,r,C,t.next_out-C):K0(e.check,r,C,t.next_out-C)),t.data_type=e.bits+(e.last?64:0)+(e.mode===Nu?128:0)+(e.mode===hC||16194===e.mode?256:0),(0===b&&0===C||n===FN)&&ft===Ef&&(ft=xZ),ft},inflateEnd:t=>{if(If(t))return El;let n=t.state;return n.window&&(n.window=null),t.state=null,Ef},inflateGetHeader:(t,n)=>{if(If(t))return El;const e=t.state;return 2&e.wrap?(e.head=n,n.done=!1,Ef):El},inflateSetDictionary:(t,n)=>{const e=n.length;let i,r,o;return If(t)||(i=t.state,0!==i.wrap&&i.mode!==dC)?El:i.mode===dC&&(r=1,r=K0(r,n,e,0),r!==i.check)?NN:(o=fR(t,n,e,e),o?(i.mode=16210,RN):(i.havedict=1,Ef))},inflateInfo:"pako inflate (from Nodeca project)"},GZ=function jZ(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const pR=Object.prototype.toString,{Z_NO_FLUSH:WZ,Z_FINISH:$Z,Z_OK:ab,Z_STREAM_END:BT,Z_NEED_DICT:UT,Z_STREAM_ERROR:YZ,Z_DATA_ERROR:gR,Z_MEM_ERROR:ZZ}=yf;function lb(t){this.options=sC.assign({chunkSize:65536,windowBits:15,to:""},t||{});const n=this.options;n.raw&&n.windowBits>=0&&n.windowBits<16&&(n.windowBits=-n.windowBits,0===n.windowBits&&(n.windowBits=-15)),n.windowBits>=0&&n.windowBits<16&&!(t&&t.windowBits)&&(n.windowBits+=32),n.windowBits>15&&n.windowBits<48&&(15&n.windowBits||(n.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new TN,this.strm.avail_out=0;let e=Ru.inflateInit2(this.strm,n.windowBits);if(e!==ab)throw new Error(vf[e]);if(this.header=new GZ,Ru.inflateGetHeader(this.strm,this.header),n.dictionary&&("string"==typeof n.dictionary?n.dictionary=rb.string2buf(n.dictionary):"[object ArrayBuffer]"===pR.call(n.dictionary)&&(n.dictionary=new Uint8Array(n.dictionary)),n.raw&&(e=Ru.inflateSetDictionary(this.strm,n.dictionary),e!==ab)))throw new Error(vf[e])}function zT(t,n){const e=new lb(n);if(e.push(t),e.err)throw e.msg||vf[e.err];return e.result}lb.prototype.push=function(t,n){const e=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let o,s,a;if(this.ended)return!1;for(s=n===~~n?n:!0===n?$Z:WZ,e.input="[object ArrayBuffer]"===pR.call(t)?new Uint8Array(t):t,e.next_in=0,e.avail_in=e.input.length;;){for(0===e.avail_out&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),o=Ru.inflate(e,s),o===UT&&r&&(o=Ru.inflateSetDictionary(e,r),o===ab?o=Ru.inflate(e,s):o===gR&&(o=UT));e.avail_in>0&&o===BT&&e.state.wrap>0&&0!==t[e.next_in];)Ru.inflateReset(e),o=Ru.inflate(e,s);switch(o){case YZ:case gR:case UT:case ZZ:return this.onEnd(o),this.ended=!0,!1}if(a=e.avail_out,e.next_out&&(0===e.avail_out||o===BT))if("string"===this.options.to){let c=rb.utf8border(e.output,e.next_out),u=e.next_out-c,f=rb.buf2string(e.output,c);e.next_out=u,e.avail_out=i-u,u&&e.output.set(e.output.subarray(c,c+u),0),this.onData(f)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(o!==ab||0!==a){if(o===BT)return o=Ru.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===e.avail_in)break}}return!0},lb.prototype.onData=function(t){this.chunks.push(t)},lb.prototype.onEnd=function(t){t===ab&&(this.result="string"===this.options.to?this.chunks.join(""):sC.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var tq={Inflate:lb,inflate:zT,inflateRaw:function qZ(t,n){return(n=n||{}).raw=!0,zT(t,n)},ungzip:zT,constants:yf};const{Deflate:nq}=dZ,{Inflate:sq}=tq;var mR=nq,_R=sq;function HT(){return HT=(0,L.A)(function*(t,n){const e=new mR({level:2,gzip:!0});try{return yield bR(e,t,n),e.result}catch(i){console.error(i)}return null}),HT.apply(this,arguments)}function VT(){return VT=(0,L.A)(function*(t,n){const e=new _R;try{return yield bR(e,t,n),e.result}catch(i){console.error(i)}return null}),VT.apply(this,arguments)}function bR(t,n){return jT.apply(this,arguments)}function jT(){return jT=(0,L.A)(function*(t,n,e=16384){let i=Math.ceil(n.byteLength/e),r=null;for(let o=0;o<i;o++)yield new Promise(t=>Ns(t)),r=n.slice(o*e,(o+1)*e),t.push(r,i<=o+1);if(t.err)throw new Error(`error: ${t.err}`);return t}),jT.apply(this,arguments)}var sl,vR=me(4999);!function(t){t.encode=function n(i){try{return vR.encode(i)}catch(r){console.error(r,i)}return null},t.decode=function e(i){try{return vR.decode(i)}catch(r){console.error(r,i)}return null}}(sl||(sl={}));class GT{get hasPassword(){return this.peers.some(n=>n.hasPassword)}constructor(n="",e="",i=[]){this.id="",this.name="",this.peers=[],this.id=n,this.name=e,this.peers=i}filterByPassword(n){return this.peers.filter(e=>e.verifyPassword(n))}static listFrom(n){let e=n.map(o=>Ar.parse(o)).sort((o,s)=>o.peerId>s.peerId?1:o.peerId<s.peerId?-1:0),i=new Map;for(let o of e)if(o.isRoom){let s=o.roomId+o.roomName,a=i.get(s)??new GT(o.roomId,o.roomName);a.peers.push(o),i.set(s,a)}return i.size<1?[]:Array.from(i.values()).sort((o,s)=>o.id+o.name<s.id+s.name?-1:o.id+o.name>s.id+s.name?1:0)}}var oa,yq=me(4356);!function(t){let n=[];for(let i=0;i<256;i++)n[i]=(i<16?"0":"")+i.toString(16);t.generateUuid=function e(){const i=new Uint32Array(4);window.crypto.getRandomValues(i);const r=i[0],o=i[1],s=i[2],a=i[3];return n[255&r]+n[r>>8&255]+n[r>>16&255]+n[r>>24&255]+"-"+n[255&o]+n[o>>8&255]+"-"+n[o>>16&15|64]+n[o>>24&255]+"-"+n[63&s|128]+n[s>>8&255]+"-"+n[s>>16&255]+n[s>>24&255]+n[255&a]+n[a>>8&255]+n[a>>16&255]+n[a>>24&255]}}(oa||(oa={}));var Fc=function(t){return t.UNKNOWN="unknown",t.RELAY="relay",t.PRFLX="prflx",t.SRFLX="srflx",t.HOST="host",t}(Fc||{});class Cq{constructor(n){this.peerConnection=n,this.candidateType=Fc.UNKNOWN}updateAsync(){var n=this;return(0,L.A)(function*(){let e=null;try{e=yield n.peerConnection.getStats()}catch(C){console.warn(C)}if(null==e)return void(n.candidateType=Fc.UNKNOWN);let i=[],r=[],o=[],s=[],a=[],c=[],u=[];e.forEach(C=>{0<=C.type.indexOf("candidate-pair")&&i.push(C),0<=C.type.indexOf("local-candidate")&&r.push(C),0<=C.type.indexOf("remote-candidate")&&o.push(C)}),i.forEach(C=>{"succeeded"===C.state&&(s.push(C.localCandidateId),a.push(C.remoteCandidateId))}),r.forEach(C=>{s.includes(C.id)&&c.push(C)}),o.forEach(C=>{a.includes(C.id)&&u.push(C)});let f=Fc.UNKNOWN,b=Object.values(Fc);c.concat(u).forEach(C=>{let x=b.indexOf(C.candidateType);b.indexOf(f)<x&&(f=b[x])}),n.candidateType=f})()}}class Nc{get isActive(){return null!=this.timeoutTimer}constructor(n,e,i=!0){this.timerMilliSecond=0,this.timeoutDate=0,this.isStopped=!1,this.callback=n,this.timerMilliSecond=e,i&&this.reset()}stop(){this.isStopped=!0}clear(){this.callback=null,this.timerMilliSecond=0,this.timeoutDate=0,this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.isStopped=!1}reset(...n){1===n.length?this.timerMilliSecond=n[0]:1<n.length&&(this.callback=n[0],this.timerMilliSecond=n[1]),this.isStopped=!1;let e=this.timeoutDate;this.timeoutDate=performance.now()+this.timerMilliSecond,!(this.timeoutTimer&&e<=this.timeoutDate)&&this.setTimeout()}setTimeout(){this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.callback&&(this.timeoutTimer=setTimeout(()=>{this.timeoutTimer=null,!this.isStopped&&(performance.now()<this.timeoutDate?this.setTimeout():this.callback&&this.callback())},this.timeoutDate-performance.now()))}}class yR{static#e=this.updateWebRTCStatsTimer=null;static#t=this.monitoringConnections=new Set;constructor(){}static add(n){this.monitoringConnections.add(n),n.updateStatsAsync(),this.restart()}static remove(n){this.monitoringConnections.delete(n)}static restart(){null==this.updateWebRTCStatsTimer?this.updateWebRTCStatsTimer=new Nc(()=>this.doMonitoringAsync(),this.calcIntervalTime()):this.updateWebRTCStatsTimer.isActive||this.updateWebRTCStatsTimer.reset(this.calcIntervalTime())}static calcIntervalTime(){return Math.min(2e3+1e3*this.monitoringConnections.size,8e3)}static doMonitoringAsync(){var n=this;return(0,L.A)(function*(){for(let e of n.monitoringConnections)e.open?yield e.updateStatsAsync():n.remove(e);n.monitoringConnections.size<1?n.updateWebRTCStatsTimer=null:n.restart()})()}}class CR extends yq.EventEmitter{get open(){return this.conn.open}get remoteId(){return this.conn.remoteId}get metadata(){return this.conn.metadata}get bufferedAmount(){return this.conn._dc?.bufferedAmount??0}get timestamp(){return this._timestamp}set timestamp(n){this._timestamp=n}get ping(){return this._ping}set ping(n){this._ping=n}get candidateType(){return this._candidateType}set candidateType(n){this._candidateType=n}constructor(n,e){super(),this.conn=n,this.chunkSize=15872,this.receivedMap=new Map,this.timeoutTimer=null,this._timestamp=performance.now(),this._ping=0,this._candidateType=Fc.UNKNOWN,this.peer=Ar.parse(e.peerId),this.peer.userId=e.userId,this.peer.password=e.password,n.on("data",i=>this.onData(i)),n.on("open",()=>{this.stats=new Cq(this.getPeerConnection()),this.peer.isOpen=!0,this.clearTimeoutTimer(),function xq(t){t._dc&&t._sendBuffer&&(t._startSendLoop=wq)}(n),this.emit("open"),this.startMonitoring()}),n.on("close",()=>{this.peer.isOpen=!1,this.clearTimeoutTimer(),this.emit("close")}),n.on("error",i=>{this.clearTimeoutTimer(),this.emit("error",i)}),this.setTimeoutTimer()}close(){this.peer.isOpen=!1,this.clearTimeoutTimer(),this.stopMonitoring(),this.conn.close()}send(n){let e=sl.encode(n),i=Math.ceil(e.byteLength/this.chunkSize);if(i<=1)return void this.conn.send(e);let r=oa.generateUuid(),o=null,s=null;for(let a=0;a<i;a++)o=e.slice(a*this.chunkSize,(a+1)*this.chunkSize),s={id:r,data:o,index:a,total:i},this.conn.send(sl.encode(s))}getPeerConnection(){return this.conn.getPeerConnection()}startMonitoring(){yR.add(this)}stopMonitoring(){yR.remove(this)}updateStatsAsync(){var n=this;return(0,L.A)(function*(){if(null==n.stats)return;n.sendPing(),yield n.stats.updateAsync(),n.candidateType=n.stats.candidateType;let e=performance.now()-n.timestamp,i=e<=1e4?1:5e3/(e-1e4+5e3),r=i<1?e:n.ping,o=500/(r+500);switch(n.peer.session.health=i,n.peer.session.ping=r,n.peer.session.speed=o*i,n.candidateType){case Fc.HOST:n.peer.session.grade=Pu.HIGH;break;case Fc.SRFLX:case Fc.PRFLX:n.peer.session.grade=Pu.MIDDLE;break;case Fc.RELAY:n.peer.session.grade=Pu.LOW;break;default:n.peer.session.grade=Pu.UNSPECIFIED}n.peer.session.description=n.candidateType,n.emit("stats",n.stats)})()}sendPing(){let n=sl.encode({from:this.remoteId,ping:performance.now()});this.conn.send(n)}receivePing(n){if(n.from===this.remoteId){let i=performance.now()-n.ping;this.ping=i<=this.ping?.5*this.ping+.5*i:i}else{let e=sl.encode(n);this.conn.send(e)}}onData(n){this.timestamp=performance.now();let e=sl.decode(new Uint8Array(n));if(null!=e.ping)return void this.receivePing(e);let r=e;if(null==r.id)return void this.emit("data",e);let o=this.receivedMap.get(r.id);if(null==o&&(o={id:r.id,chanks:new Array(r.total),length:0,byteLength:0},this.receivedMap.set(r.id,o)),null!=o.chanks[r.index]||(o.length++,o.byteLength+=r.data.byteLength,o.chanks[r.index]=r.data,o.length<r.total))return;this.receivedMap.delete(r.id);let s=new Uint8Array(o.byteLength),a=0;for(let u of o.chanks)s.set(u,a),a+=u.byteLength;let c=sl.decode(s);this.emit("data",c)}setTimeoutTimer(){this.clearTimeoutTimer(),this.timeoutTimer=setTimeout(()=>{console.warn(`timeout ${this.conn.remoteId}`),this.timeoutTimer=null,this.emit("close")},15e3)}clearTimeoutTimer(){null!=this.timeoutTimer&&(clearTimeout(this.timeoutTimer),this.timeoutTimer=null)}}function wq(){this.sendInterval||(this.sendInterval=Ns(xR.bind(this)))}function xR(){const t=this._sendBuffer.shift();try{this._dc.send(t)}catch{this._sendBuffer.push(t)}this.sendInterval=0===this._sendBuffer.length?void 0:Ns(xR.bind(this))}class Eq{constructor(){this.connections=[],this.needsRefreshPeers=!1,this._peers=[],this.needsRefreshPeerIds=!1,this._peerIds=[]}get length(){return this.connections.length}[Symbol.iterator](){let n=this.connections.concat(),e=0;return{next:()=>({value:n[e++],done:n.length+1<=e})}}get peers(){return this.needsRefreshPeers&&(this.needsRefreshPeers=!1,this._peers=this.connections.map(n=>n.peer),this._peers.sort((n,e)=>n.peerId>e.peerId?1:n.peerId<e.peerId?-1:0)),this._peers}get peerIds(){if(this.needsRefreshPeerIds){this.needsRefreshPeerIds=!1;let n=[];for(let e of this.connections)e.open&&n.push(e.remoteId);n.sort((e,i)=>e>i?1:e<i?-1:0),this._peerIds=n}return this._peerIds}add(n){let e=this.find(n.remoteId);if(null!=e){if(console.log("add() is Fail. "+n.remoteId+" is already connecting.",e),e!==n){if(!(e.metadata.sortKey<n.metadata.sortKey))return this.remove(e),this.add(n);this.remove(n)}return null}return this.connections.push(n),this.refresh(),console.log("<add()> Peer:"+n.remoteId+" length:"+this.connections.length),n}remove(n){n.close();let e=this.connections.indexOf(n);return 0<=e&&(console.log(n.remoteId+" is \u3048\u3093\u3044\u30fcindex:"+e+" length:"+this.connections.length),this.connections.splice(e,1),this.refresh()),console.log("<close()> Peer:"+n.remoteId+" length:"+this.connections.length),0<=e?n:null}find(n){return this.connections.find(e=>e.remoteId===n)}refresh(){this.needsRefreshPeers=!0,this.needsRefreshPeerIds=!0}}class Iq{constructor(){this.peer=Ar.parse("???"),this.callback=new WF,this.bandwidthUsage=0,this.key="",this.connections=new Eq,this.listAllPeersCache=[],this.httpRequestInterval=performance.now()+500,this.outboundQueue=Promise.resolve(),this.inboundQueue=Promise.resolve(),this.relayingPeerIds=new Map,this.maybeUnavailablePeerIds=new Set}get userIds(){return this.peers.map(n=>n.userId).filter(n=>0<n.length).concat([this.peer.userId])}get peerId(){return this.peer.peerId}get peerIds(){return this.connections.peerIds}get peers(){return this.connections.peers}open(...n){console.log("open",n),this.peer=0===n.length?Ar.create(Ar.generateId()):1===n.length?Ar.create(n[0]):Ar.create(n[0],n[1],n[2],n[3]),this.openSkyWay()}close(){this.skyWay&&this.skyWay.destroy(),this.disconnectAll(),this.skyWay=null,this.peer=Ar.parse("???")}connect(n){if(!this.shouldConnect(n.peerId))return!1;let e=new CR(this.skyWay.connect(n.peerId,{serialization:"none",metadata:{sortKey:this.peer.digestUserId,token:this.peer.isRoom?"":Fg.sha256Base64Url(this.peer.digestUserId+n.userId)}}),n);return this.openDataConnection(e),!0}shouldConnect(n){return this.peer&&this.skyWay&&this.peerId?this.peerId===n?(console.log("connect() is Fail. "+n+" is me."),!1):this.connections.find(n)?(console.log("connect() is Fail. <"+n+"> is already connecting."),!1):this.peer.verifyPeer(n)?!(!n||!n.length||n===this.peerId):(console.log("connect() is Fail. <"+n+"> is not valid."),!1):(console.log("connect() is Fail. ID\u304c\u5272\u308a\u632f\u3089\u308c\u308b\u307e\u3067\u5f85\u3066\u3084"),!1)}disconnect(n){let e=this.connections.find(n.peerId);return!!e&&(this.closeDataConnection(e),!0)}disconnectAll(){console.log("<closeAllDataConnection()>");for(let n of this.connections)this.closeDataConnection(n)}send(n,e){var i=this;if(this.connections.length<1)return;let r={data:sl.encode(n),ttl:1},o=r.data.byteLength;this.bandwidthUsage+=o,this.outboundQueue=this.outboundQueue.then(()=>new Promise((s,a)=>{Ns((0,L.A)(function*(){if(1024<r.data.byteLength&&Array.isArray(n)&&1<n.length){let c=yield function _q(t,n){return HT.apply(this,arguments)}(r.data);c.byteLength<r.data.byteLength&&(r.data=c,r.isCompressed=!0)}return e?i.sendUnicast(r,e):i.sendBroadcast(r),i.bandwidthUsage-=o,s()}))}))}sendUnicast(n,e){n.ttl=0;let i=this.connections.find(e);i&&i.open&&i.send(n)}sendBroadcast(n){for(let e of this.connections)e.open&&e.send(n)}setApiKey(n){this.key!==n&&console.log("Key Change"),this.key=n}listAllPeers(){return new Promise((n,e)=>{if(!this.skyWay)return n([]);let i=performance.now();if(i<this.httpRequestInterval)return console.warn("httpRequestInterval... "+(this.httpRequestInterval-i)),void n(this.listAllPeersCache.concat());this.httpRequestInterval=i+6e3,this.skyWay.listAllPeers(r=>{this.listAllPeersCache=r.concat(),n(r)})})}listAllRooms(){var n=this;return(0,L.A)(function*(){let e=yield n.listAllPeers();return GT.listFrom(e)})()}openSkyWay(){this.skyWay&&(console.warn("It is already opened."),this.close());let n=new Peer(this.peer.peerId,{key:this.key});n.on("open",e=>{console.log("My peer ID is: "+e),this.peer.peerId===e?(this.peer.isOpen=!0,console.log("My peer Context",this.peer),this.callback.onOpen&&this.callback.onOpen(this.peer)):console.error("...peer is not me? <"+e+">",this.peer)}),n.on("close",()=>{console.log("Peer close"),this.peer.isOpen&&(this.peer.isOpen=!1,this.callback.onClose&&this.callback.onClose(this.peer))}),n.on("connection",e=>{let i=this.peer.verifyPeer(e.remoteId),r=this.peer.isRoom||e.metadata.token===Fg.sha256Base64Url(e.metadata.sortKey+this.peer.userId);if(!i||!r)return e.close(),e.on("open",()=>e.close()),void console.log("connection is close. <"+e.remoteId+"> is not valid.");let o=Ar.parse(e.remoteId);this.openDataConnection(new CR(e,o))}),n.on("error",e=>{console.error("<"+this.peerId+"> "+e.type+" => "+e.message);let i=`${this.getSkyWayErrorMessage(e.type)}\n\n${e.type}: ${e.message}`;switch(e.type){case"peer-unavailable":let r=/"(.+)"/.exec(e.message)[1];this.disconnect(Ar.parse(r));break;case"disconnected":case"socket-error":case"unavailable-id":case"authentication":case"server-error":this.peer&&this.peer.isOpen&&(this.close(),this.callback.onClose&&this.callback.onClose(this.peer))}this.callback.onError&&this.callback.onError(this.peer,e.type,i,e)}),this.skyWay=n}openDataConnection(n){null!=this.connections.add(n)&&(this.maybeUnavailablePeerIds.add(n.remoteId),n.on("data",e=>{this.onData(n,e)}),n.on("open",()=>{this.maybeUnavailablePeerIds.delete(n.remoteId),this.notifyUserList(),this.callback.onConnect&&this.callback.onConnect(n.peer)}),n.on("close",()=>{this.closeDataConnection(n)}),n.on("error",()=>{this.closeDataConnection(n)}),n.on("stats",()=>{(n.peer.session.health<.35||n.peer.session.grade<1&&n.peer.session.health<.7)&&(console.log(`reconnecting... ${n.peer.peerId}`),this.closeDataConnection(n),this.connect(n.peer))}))}closeDataConnection(n){let e=this.connections.remove(n);this.relayingPeerIds.delete(n.remoteId),this.relayingPeerIds.forEach(i=>{let r=i.indexOf(n.remoteId);0<=r&&i.splice(r,1)}),this.notifyUserList(),e&&this.callback.onDisconnect&&this.callback.onDisconnect(n.peer)}onData(n,e){var i=this;if(e.users&&0<e.users.length&&this.onUpdateUserIds(n,e.users),0<e.ttl&&this.onRelay(n,e),!this.callback.onData)return;let r=e.data.byteLength;this.bandwidthUsage+=r,this.inboundQueue=this.inboundQueue.then(()=>new Promise((o,s)=>{Ns((0,L.A)(function*(){if(!i.callback.onData)return;let a=e.isCompressed?yield function bq(t,n){return VT.apply(this,arguments)}(e.data):e.data;return i.callback.onData(n.peer,sl.decode(a)),i.bandwidthUsage-=r,o()}))}))}onRelay(n,e){e.ttl--;let i=this.relayingPeerIds.get(n.remoteId);if(null!=i){e.users&&0<e.users.length&&(e.users=this.userIds);for(let r of i){let o=this.connections.find(r);o&&o.open&&(console.log("<"+r+"> \u8ee2\u9001\u3057\u306a\u304d\u3083\u30fb\u30fb\u30fb"),o.send(e))}}}onUpdateUserIds(n,e){let i=!1;e.forEach(a=>{let c=this.makeFriendPeer(a),u=this.connections.find(c.peerId);u&&u.peer.userId!==a&&(u.peer.userId=a,i=!0)});let r=uT.diff(this.userIds,e),s=r.diff2;if(this.relayingPeerIds.set(n.remoteId,r.diff1.map(a=>this.makeFriendPeer(a).peerId)),s.length)for(let a of s){let c=this.makeFriendPeer(a);!this.maybeUnavailablePeerIds.has(c.peerId)&&this.connect(c)&&console.log("auto connect to unknown Peer <"+c.peerId+">")}i&&this.notifyUserList()}notifyUserList(){if(this.connections.refresh(),this.connections.length<1)return;let n={data:sl.encode([]),users:this.userIds,ttl:1};this.sendBroadcast(n)}makeFriendPeer(n){return this.peer.isRoom?Ar.create(n,this.peer.roomId,this.peer.roomName,this.peer.password):Ar.create(n)}getSkyWayErrorMessage(n){switch(n){case"room-error":return"SkyWay Room API \u306b\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002";case"permission":return"\u8a72\u5f53\u306e SkyWay Room \u306e\u5229\u7528\u304c\u8a31\u53ef\u3055\u308c\u3066\u307e\u305b\u3093\u3002";case"list-error":return"SkyWay listAllPeers API \u304c Disabled \u3067\u3059\u3002";case"disconnected":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u306b\u63a5\u7d9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002";case"socket-error":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u3068\u306e\u901a\u4fe1\u3067\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002";case"invalid-id":return"Peer ID \u304c\u4e0d\u6b63\u3067\u3059\u3002";case"unavailable-id":return"\u305d\u306e Peer ID \u3059\u3067\u306b\u4f7f\u7528\u3055\u308c\u3066\u3044\u307e\u3059\u3002";case"invalid-key":return"SkyWay API \u30ad\u30fc\u304c\u7121\u52b9\u3067\u3059\u3002";case"invalid-domain":return"SkyWay API \u30ad\u30fc\u306b\u306f\u73fe\u5728\u306e\u30c9\u30e1\u30a4\u30f3\u306f\u767b\u9332\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002";case"authentication":return"\u8a8d\u8a3c\u30a8\u30e9\u30fc\u3067\u3059\u3002";case"server-error":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u3068\u306e\u63a5\u7d9a\u4e2d\u306b\u554f\u984c\u304c\u3042\u308a\u307e\u3057\u305f\u3002 \u5c11\u3057\u5f85\u3063\u3066\u3001\u30ea\u30c8\u30e9\u30a4\u3057\u3066\u304f\u3060\u3055\u3044\u3002";case"sfu-client-not-supported":return"\u3053\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306f SFU \u306e\u4f7f\u7528\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u6700\u65b0\u306e Google Chrome \u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044";case"peer-unavailable":return"Peer \u3078\u30c7\u30fc\u30bf\u3092\u9001\u4fe1\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002Peer ID \u304c\u6b63\u3057\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002";case"signaling-limited":return"\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u56de\u6570\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u5168\u3066\u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09";case"sfu-limited":return"SFU \u30b5\u30fc\u30d0\u306e\u5229\u7528\u91cf\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001SFU \u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09";case"turn-limited":return"TURN \u30b5\u30fc\u30d0\u306e\u5229\u7528\u91cf\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001TURN \u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09\n\u3053\u306e\u72b6\u614b\u3067\u306f\u3001\u4e00\u90e8\u306e\u30e6\u30fc\u30b6\u306e\u63a5\u7d9a\u306b\u554f\u984c\u304c\u767a\u751f\u3059\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002";default:return"SkyWay\u306b\u95a2\u3059\u308b\u4e0d\u660e\u306a\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002"}}}const wR=Ar.parse("???");class Rc{static get instance(){return Rc._instance||(Rc._instance=new Rc),Rc._instance}get isOpen(){return!!this.connection&&this.connection.peer.isOpen}get peerId(){return this.connection?this.connection.peerId:wR.peerId}get peerIds(){return this.connection?this.connection.peerIds.concat():[]}get peer(){return this.connection?this.connection.peer:wR}get peers(){return this.connection?this.connection.peers.concat():[]}get bandwidthUsage(){return this.connection?this.connection.bandwidthUsage:0}constructor(){this.callback=new WF,this.key="",this.queue=new Set,this.sendInterval=null,this.sendCallback=()=>{this.sendQueue()},this.callbackUnload=n=>{this.close()},console.log("Network ready...")}open(...n){this.connection&&this.connection.peer&&(console.warn("It is already opened."),this.close()),console.log("Network open...",n),this.connection=this.initializeConnection(),this.connection.open.apply(this.connection,n),window.addEventListener("unload",this.callbackUnload,!1)}close(){this.connection&&this.connection.close(),this.connection=null,window.removeEventListener("unload",this.callbackUnload,!1),console.log("Network close...")}connect(n){return!!this.connection&&this.connection.connect(n)}disconnect(n){this.connection&&this.connection.disconnect(n)&&(console.log("<disconnectPeer()> Peer:"+n.peerId),this.disconnect(n))}send(n,e){this.queue.add({data:n,sendTo:e}),null===this.sendInterval&&(this.sendInterval=Ns(this.sendCallback))}sendQueue(){let n=[],e={},i=[],r=this.queue.size<128?this.queue.size:128;for(let o of this.queue){if(r<=0)break;r--,this.queue.delete(o),null==o.sendTo?n.push(o.data):o.sendTo===this.peerId?i.push(o.data):(o.sendTo in e||(e[o.sendTo]=[]),e[o.sendTo].push(o.data))}if(this.connection){n.length&&this.connection.send(n);for(let o in e)this.connection.send(e[o],o)}this.callback.onData&&(this.callback.onData(null,n),this.callback.onData(this.peer,i)),this.sendInterval=0<this.queue.size?Ns(this.sendCallback):null}setApiKey(n){this.key!==n&&console.log("Key Change"),this.key=n}listAllPeers(){return this.connection?this.connection.listAllPeers():Promise.resolve([])}listAllRooms(){return this.connection?this.connection.listAllRooms():Promise.resolve([])}initializeConnection(){let n=new Iq;return n.setApiKey(this.key),n.callback.onOpen=e=>{this.callback.onOpen&&this.callback.onOpen(e)},n.callback.onClose=e=>{this.callback.onClose&&this.callback.onClose(e)},n.callback.onConnect=e=>{this.callback.onConnect&&this.callback.onConnect(e)},n.callback.onDisconnect=e=>{this.callback.onDisconnect&&this.callback.onDisconnect(e)},n.callback.onData=(e,i)=>{this.callback.onData&&this.callback.onData(e,i)},n.callback.onError=(e,i,r,o)=>{this.callback.onError&&this.callback.onError(e,i,r,o)},0<this.queue.size&&null===this.sendInterval&&(this.sendInterval=Ns(this.sendCallback)),n}}class Gg{constructor(n,e,i=Rc.instance.peerId){this.eventName=n,this.data=e,this.sendFrom=i,this.isSendFromSelf=!1,this.isSendFromSelf=this.sendFrom===Rc.instance.peerId}toContext(){return{sendFrom:this.sendFrom,eventName:this.eventName,data:this.data}}}class WT{get subject(){return this._subject}get key(){return this._key}get eventName(){return this._eventName}get priority(){return this._priority}get callback(){return this._callback}get isOnlyOnce(){return this._isOnlyOnce}get isRegistered(){return this._isRegistered}constructor(n,e){this._priority=0,this._isRegistered=!1,this._subject=n,this._key=e}on(...n){return this._isOnlyOnce=!1,2===n.length?this.register(n[0],0,n[1]):this.register(n[0],n[1],n[2])}once(...n){let e=this.on.apply(this,n);return this._isOnlyOnce=!0,e}register(n,e,i){return this.isRegistered&&this.unregister(),this._eventName=n||"*",this._priority=e,this._callback=i,this.subject.registerListener(this),this._isRegistered=!0,new WT(this.subject,this.key)}unregister(){return this.subject.unregisterListener(this),this._callback=null,this._isRegistered=!1,this}trigger(n){this.callback&&this.isRegistered&&(this.callback.apply(this.key,[n,this]),this.isOnlyOnce&&this.unregister())}isEqual(n,e,i){return!(null!=n&&n!==this.key||null!=e&&e!==this.eventName||null!=i&&i!==this.callback)}}class Tf{static get instance(){return Tf._instance||(Tf._instance=new Tf,Tf._instance.initializeNetworkEvent()),Tf._instance}constructor(){this.listenerMap=new Map,this.keyMap=new Map,console.log("EventSystem ready...")}register(n){return new WT(this,n)}unregister(...n){1===n.length?this._unregister(n[0],null,null):2===n.length?"string"==typeof n[1]?this._unregister(n[0],n[1],null):this._unregister(n[0],null,n[1]):this._unregister(n[0],n[1],n[2])}_unregister(n=this,e,i){let r=[];if(null!=n)r=this.getListenersByKey(n);else if(null!=e)r=this.getListenersByEventName(e);else{let o=this.listenerMap.values();for(let s of o)r=r.concat(s)}for(let o of r.concat())o.isEqual(n,e,i)&&o.unregister()}registerListener(n){let e=this.getListenersByEventName(n.eventName);return e.push(n),e.sort((i,r)=>r.priority-i.priority),this.listenerMap.set(n.eventName,e),e=this.getListenersByKey(n.key),e.push(n),this.keyMap.set(n.key,e),n}unregisterListener(n){let e=this.getListenersByEventName(n.eventName),i=e.indexOf(n);return i<0?null:(e.splice(i,1),e.length<1&&this.listenerMap.delete(n.eventName),e=this.getListenersByKey(n.key),i=e.indexOf(n),0<=i&&e.splice(i,1),e.length<1&&this.keyMap.delete(n.key),n.unregister(),n)}call(...n){"string"==typeof n[0]?this._call(new Gg(n[0],n[1]),n[2]):this._call(n[0],n[1])}_call(n,e){let i=n.toContext();Rc.instance.send(i,e)}trigger(...n){if(2!==n.length)return this._trigger(n[0]instanceof Gg?n[0]:new Gg(n[0].eventName,n[0].data,n[0].sendFrom));this._trigger(new Gg(n[0],n[1]))}_trigger(n){let e=this.getListenersByEventName(n.eventName).concat(this.getListenersByEventName("*"));for(let i of e)i.trigger(n);return n}getListenersByEventName(n){return this.listenerMap.has(n)?this.listenerMap.get(n):[]}getListenersByKey(n){return this.keyMap.has(n)?this.keyMap.get(n):[]}initializeNetworkEvent(){let n=Rc.instance.callback;n.onOpen=e=>{this.trigger("OPEN_NETWORK",{peerId:e.peerId})},n.onClose=e=>{this.trigger("CLOSE_NETWORK",{peerId:e.peerId})},n.onConnect=e=>{this.sendSystemMessage("<"+e.userId+"> connect <DataConnection>"),this.trigger("CONNECT_PEER",{peerId:e.peerId})},n.onDisconnect=e=>{this.sendSystemMessage("<"+e.userId+"> disconnect <DataConnection>"),this.trigger("DISCONNECT_PEER",{peerId:e.peerId})},n.onData=(e,i)=>{for(let r of i)this.trigger(r)},n.onError=(e,i,r,o)=>{this.sendSystemMessage("<"+e.userId+"> "+r),this.trigger("NETWORK_ERROR",{peerId:e.peerId,errorType:i,errorMessage:r,errorObject:o})}}sendSystemMessage(n){console.log(n)}}const ne=Tf.instance,jt=Rc.instance;class bt{static get instance(){return bt._instance||(bt._instance=new bt),bt._instance}constructor(){this.identifierMap=new Map,this.aliasNameMap=new Map,this.garbageMap=new Map,this.queueMap=new Map,this.updateInterval=null,this.garbageCollectionInterval=null,this.updateCallback=()=>{this.updateQueue()},console.log("ObjectStore ready...")}add(n,e=!0){return null!=this.get(n.identifier)||this.isDeleted(n.identifier)?null:(this.identifierMap.set(n.identifier,n),(this.aliasNameMap.has(n.aliasName)?this.aliasNameMap.get(n.aliasName):this.aliasNameMap.set(n.aliasName,new Map).get(n.aliasName)).set(n.identifier,n),n.onStoreAdded(),e&&this.update(n.toContext()),n)}remove(n){if(!this.identifierMap.has(n.identifier))return null;this.identifierMap.delete(n.identifier);let e=this.aliasNameMap.get(n.aliasName);return e&&e.delete(n.identifier),n.onStoreRemoved(),n}delete(n,e=!0){let i=null,r=null;return"string"==typeof n?(i=this.get(n),r=n):(i=n,r=n.identifier),this.markForDelete(r),null==i?null:this._delete(i,e)}_delete(n,e){return null===this.remove(n)?null:(e&&ne.call("DELETE_GAME_OBJECT",{aliasName:n.aliasName,identifier:n.identifier}),n)}markForDelete(n){this.garbageMap.set(n,performance.now()),this.garbageCollection(6e5)}get(n){return this.identifierMap.has(n)?this.identifierMap.get(n):null}getObjects(n){if(null==n)return Array.from(this.identifierMap.values());let e="";return e="string"==typeof n?n:n.aliasName,this.aliasNameMap.has(e)?Array.from(this.aliasNameMap.get(e).values()):[]}update(n){let e=null;if("string"==typeof n){let i=this.get(n);i&&(e=i.toContext())}else e=n;if(e){if(this.queueMap.has(e.identifier)){let i=this.queueMap.get(e.identifier);for(let r in e)i[r]=e[r];return}ne.call("UPDATE_GAME_OBJECT",e),this.queueMap.set(e.identifier,e),null===this.updateInterval&&(this.updateInterval=Ns(this.updateCallback))}}updateQueue(){this.queueMap.clear(),this.updateInterval=null}isDeleted(n){return null!=this.garbageMap.get(n)}getCatalog(){let n=[];for(let e of this.identifierMap.values())n.push({identifier:e.identifier,version:e.version});return n}clearDeleteHistory(){this.garbageMap.clear()}garbageCollection(n){"number"==typeof n?null===this.garbageCollectionInterval&&(this.garbageCollectionInterval=setTimeout(()=>{this.garbageCollectionInterval=null},1e3),this._garbageCollection(n)):this.garbageMap.delete(n.identifier)}_garbageCollection(n){let e=performance.now(),i=this.garbageMap.size-1e5;if(i<1)return;let r=this.garbageMap.entries();for(;i<1;){i--;let o=r.next();if(o.done)break;o.value[1]+n<e||this.garbageMap.delete(o.value[0])}}}class Lc{static get instance(){return Lc._instance||(Lc._instance=new Lc),Lc._instance}constructor(){this.constructorMap=new Map,this.aliasMap=new Map,console.log("ObjectFactory ready...")}register(n,e){e||(e=n.name??n.toString().match(/function\s*([^(]*)\(/)?.[1]??""),this.constructorMap.has(e)?console.error("\u305d\u306e alias<"+e+"> \u306f\u3059\u3067\u306b\u5272\u308a\u5f53\u3066\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f"):this.aliasMap.has(n)?console.error("\u305d\u306e constructor \u306f\u3059\u3067\u306b\u767b\u9332\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f",n):(console.log("addGameObjectFactory -> "+e),this.constructorMap.set(e,n),this.aliasMap.set(n,e))}create(n,e){let i=this.constructorMap.get(n);return i?new i(e):(console.error(n+"\u3068\u3044\u3046\u540d\u306eGameObject\u30af\u30e9\u30b9\u306f\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),null)}getAlias(n){return this.aliasMap.get(n)??""}}const ER=Symbol("synchronize-variables"),IR=Symbol("synchronize-attributes");function TR(t){return n=>{const e=class extends n{constructor(...r){super(...r),this.constructor===e&&function Sq(t){MR(t,ER,n=>function(){return this.context.syncData[n]},n=>function(i){this.context.syncData[n]=i,this.update()}),MR(t,IR,n=>function(){return this.context.syncData.attributes[n]},n=>function(i){this.context.syncData.attributes[n]=i,this.update()})}(this)}};return Lc.instance.register(e,t),e}}function Wg(){return(t,n)=>{SR(t,ER,n)}}function SR(t,n,e){t.hasOwnProperty(n)||Object.defineProperty(t,n,{enumerable:!1,configurable:!0,writable:!0,value:new Set}),t[n].add(e)}function MR(t,n,e,i){const r=new Set;let o=t;for(;o;){const s=o[n];if(null!=s&&o.hasOwnProperty(n))for(const a of s){if(r.has(a))continue;r.add(a);const c=t[a];Object.defineProperty(t,a,{get:e(a),set:i(a),enumerable:!0,configurable:!0}),void 0!==c&&(t[a]=c)}o=Object.getPrototypeOf(o)}}var Lu;!function(t){const n=/&|<|>|"|'/g,e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"},i=/&amp;|&lt;|&gt;|&quot;|&apos;/g,r={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'"},o=/((?:[\0-\x08\x0B\f\x0E-\x1F\uFFFD\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))/g;function f(C){return e[C]}function b(C){return r[C]}t.xml2element=function s(C){let x=new DOMParser,M=null;try{C=function u(C){return C.replace(o,"").trim()}(C),M=x.parseFromString(C,"application/xml"),M.getElementsByTagName("parsererror").length&&(console.error("XML\u306e\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3057\u305f",M.documentElement),M=null)}catch(U){console.error(U)}return M?M.documentElement:null},t.encodeEntityReference=function a(C){return C.replace(n,f)},t.decodeEntityReference=function c(C){return C.replace(i,b)}}(Lu||(Lu={}));const Mq=Object.getOwnPropertyNames(Object.prototype);Object.getOwnPropertyNames(Array.prototype);class ar{static get instance(){return ar._instance||(ar._instance=new ar),ar._instance}constructor(){console.log("ObjectSerializer ready...")}toXml(n){let e="",i="toAttributes"in n?n.toAttributes():ar.toAttributes(n.toContext().syncData),r=n.aliasName,o="";for(let s in i)void 0!==i[s]&&(o+=" "+s+'="'+Lu.encodeEntityReference(i[s]+"")+'"');return e+=`<${r+o}>`,e+="innerXml"in n?n.innerXml():"",e+=`</${r}>`,e}static toAttributes(n){let e={};for(let i in n){let s=ar.make2Attributes(n[i],i);for(let a in s)void 0!==s[a]&&(e[a]=s[a])}return e}static make2Attributes(n,e){let i={};if(Array.isArray(n)){let r=ar.array2attributes(n,e);for(let o in r)void 0!==r[o]&&(i[o]=r[o])}else if("object"==typeof n){let r=ar.object2attributes(n,e);for(let o in r)void 0!==r[o]&&(i[o]=r[o])}else void 0!==n&&(i[e]=n);return i}static object2attributes(n,e){let i={};for(let r in n){let a=ar.make2Attributes(n[r],e+"."+r);for(let c in a)void 0!==a[c]&&(i[c]=a[c])}return i}static array2attributes(n,e){let i={},r=n.length;for(let o=0;o<r;o++){let c=ar.make2Attributes(n[o],e+"."+o);for(let u in c)void 0!==c[u]&&(i[u]=c[u])}return i}parseXml(n){let e=null;if(e="string"==typeof n?Lu.xml2element(n):n,!e)return console.error("xmlElement\u304c\u7a7a\u3067\u3059"),null;let i=Lc.instance.create(e.tagName);if(!i)return null;if("parseAttributes"in i)i.parseAttributes(e.attributes);else{let r=i.toContext();ar.parseAttributes(r.syncData,e.attributes),i.apply(r)}i.initialize(),"parseInnerXml"in i&&i.parseInnerXml(e);try{i.complement()}catch(r){console.log(r)}return i}static parseAttributes(n,e){let i=e.length;for(let r=0;r<i;r++){let o=e[r].value;o=Lu.decodeEntityReference(o);let s=e[r].name.split("."),a=s[0],c=n,u=s.find(b=>Mq.includes(b));null==u?1<s.length&&(({obj:c,key:a}=ar.attributes2object(s,c,a)),null==a)||("string"!=typeof c[a]&&null!=c[a]&&(o=JSON.parse(o)),c[a]=o):console.log(`skip invalid key (${u})`)}return n}static attributes2object(n,e,i){let r=null,o=n.length;for(let s=0;s<o;s++){let a=parseInt(n[s]);if(r&&!Number.isNaN(a)&&!Array.isArray(e)&&Object.keys(r).length&&(r[i]=[],e=r[i]),i=Number.isNaN(a)?n[s]:a,Array.isArray(e)&&"number"!=typeof i)return console.warn("Array\u306b\u306findex\u306e\u633f\u5165\u3057\u304b\u8a31\u53ef\u3057\u306a\u3044"),{obj:e,key:null};s+1<o&&(null==e[i]&&(e[i]="number"==typeof i?[]:{}),r=e,e=e[i])}return{obj:e,key:i}}static parseInnerXml(n){return null}}class eh{static get aliasName(){return Lc.instance.getAlias(this)}get aliasName(){return this.context.aliasName}get identifier(){return this.context.identifier}get version(){return this.context.majorVersion+this.context.minorVersion}constructor(n=oa.generateUuid()){this.context={aliasName:this.constructor.aliasName,identifier:"",majorVersion:0,minorVersion:0,syncData:{}},this.context.identifier=n}initialize(){bt.instance.add(this)}destroy(){bt.instance.delete(this)}onStoreAdded(){}onStoreRemoved(){}update(){this.versionUp(),bt.instance.update(this.identifier)}versionUp(){this.context.majorVersion+=1,this.context.minorVersion=Math.random()}apply(n){null!==n&&this.identifier===n.identifier&&(this.context.majorVersion=n.majorVersion,this.context.minorVersion=n.minorVersion,this.context.syncData=n.syncData)}clone(){const n=this.toXml();return ar.instance.parseXml(n)}complement(){}toContext(){return{aliasName:this.context.aliasName,identifier:this.context.identifier,majorVersion:this.context.majorVersion,minorVersion:this.context.minorVersion,syncData:DR(this.context.syncData)}}toXml(){return ar.instance.toXml(this)}}function DR(t){if(null==t)return t;let n=Array.isArray(t)?[]:{},e=Object.getOwnPropertyNames(t);for(let i of e){let r=typeof t[i];null!=t[i]&&"object"===r?n[i]=DR(t[i]):"function"!==r&&(n[i]=t[i])}return n}const $T=new Map,ZT=new Set;let qT=!1;function kR(t,n=jt.peerId){$T.set(t.identifier,{object:t,originFrom:n}),t instanceof xr&&XT(t.parent),OR()}function XT(t){let n=t;for(;n&&(ZT.add(n.identifier),n=n.parent,n!==t););OR()}function OR(){qT||(queueMicrotask(Dq),qT=!0)}const Dq=()=>{qT=!1;let t=Array.from($T.values()),n=Array.from(ZT.values());$T.clear(),ZT.clear();for(let e of t){let i={aliasName:e.object.aliasName,identifier:e.object.identifier};ne.trigger(new Gg(`UPDATE_GAME_OBJECT/aliasName/${i.aliasName}`,i,e.originFrom)),ne.trigger(new Gg(`UPDATE_GAME_OBJECT/identifier/${i.identifier}`,i,e.originFrom))}for(let e of n)ne.trigger(`UPDATE_OBJECT_CHILDREN/identifier/${e}`,{identifier:e})};var KT;const Sf={};let xr=KT=class extends eh{constructor(){super(...arguments),this.value="",this.attributes={},this.parentIdentifier="",this.majorIndex=0,this.minorIndex=Math.random(),this._children=[],this.needsSort=!1}get index(){return this.majorIndex+this.minorIndex}set index(n){this.majorIndex=0|n,this.minorIndex=n-this.majorIndex,this.parent&&(this.parent.needsSort=!0)}get parent(){return bt.instance.get(this.parentIdentifier)}get parentId(){return this.parentIdentifier}get parentIsAssigned(){return 0<this.parentIdentifier.length}get parentIsUnknown(){return this.parentIsAssigned&&null==bt.instance.get(this.parentIdentifier)}get parentIsDestroyed(){return this.parentIsAssigned&&bt.instance.isDeleted(this.parentIdentifier)}get children(){return this.needsSort&&(this.needsSort=!1,this._children.sort((n,e)=>n.index-e.index)),this._children.concat()}destroy(){super.destroy();for(let n of this._children.concat())n.destroy();this._children=[]}onStoreAdded(){super.onStoreAdded(),this.initializeChildren()}onStoreRemoved(){super.onStoreRemoved(),this.parent&&this.parent.removeChild(this)}onChildAdded(n){}onChildRemoved(n){}_onChildAdded(n){XT(this);let e=this;for(;e&&(e.onChildAdded(n),e=e.parent,e!==this););}_onChildRemoved(n){XT(this);let e=this;for(;e&&(e.onChildRemoved(n),e=e.parent,e!==this););}initializeChildren(){if(null==Sf[this.identifier])return;let n=Sf[this.identifier];for(let e of n)e.parent===this&&this.updateChildren(e);Sf[this.identifier]&&delete Sf[this.identifier]}updateChildren(n=this){let e=this._children.indexOf(n),i=!1,r=n.parent===this;if(e<0&&r)this._children.push(n),e=this._children.length-1,i=!0;else{if(0<=e&&!r)return this._children.splice(e,1),void this._onChildRemoved(n);if(e<0&&!r)return}let o=this._children.length;o&&((this._children[e-1<0?0:e-1].index>n.index||n.index>this._children[o-1<e+1?o-1:e+1].index)&&(this.needsSort=!0),i&&this._onChildAdded(n))}updateIndexs(){let n=this.children;for(let e=0;e<n.length;e++)n[e].majorIndex=e,n[e].minorIndex=Math.random()}appendChild(n){if(n.contains(this))return null;n.parent&&n.parent!==this&&n.parent.removeChild(n);let e=0<this.children.length?this.children[this.children.length-1].majorIndex+1:0;return n.parentIdentifier=this.identifier,n.majorIndex=e,n.minorIndex=Math.random(),this.updateChildren(n),n}prependChild(n){return this._children.length<1?this.appendChild(n):this.insertBefore(n,this.children[0])}insertBefore(n,e){if(n.contains(this))return null;if(n===e&&n.parent===this)return n;n.parent&&n.parent!==this&&n.parent.removeChild(n);let i=this.children.indexOf(e);if(i<0)return this.appendChild(n);n.parentIdentifier=this.identifier;let r=0<i?this.children[i-1].index:0,o=e.index-r,s=r+o*(.45+.1*Math.random());return n.majorIndex=0|s,n.minorIndex=s-n.majorIndex,this.updateChildren(n),o<1e-7&&this.updateIndexs(),n}removeChild(n){return this.children.indexOf(n)<0?null:(n.parentIdentifier="",n.majorIndex=0,n.minorIndex=Math.random(),this.updateChildren(n),n)}contains(n){let e=n.parent;for(;e;){if(e===n)return console.error("\u3042 \u3084\u3063\u3079\u3001\u5faa\u74b0\u53c2\u7167",n),!1;if(e===this)return!0;e=e.parent}return!1}setAttribute(n,e){this.attributes[n]=e,this.update()}getAttribute(n){return null==this.attributes[n]?"":this.attributes[n]}removeAttribute(n){delete this.attributes[n],this.update()}toAttributes(){return ar.toAttributes(this.attributes)}parseAttributes(n){ar.parseAttributes(this.attributes,n)}innerXml(){let n="";n+=Lu.encodeEntityReference(this.value+"");for(let e of this.children)n+=ar.instance.toXml(e);return n}parseInnerXml(n){let e=n.children,i=e.length;if(0<i)for(let r=0;r<i;r++){let o=ar.instance.parseXml(e[r]);o instanceof KT&&this.appendChild(o)}else this.value=Lu.decodeEntityReference(n.innerHTML)}apply(n){let e=this.parent;super.apply(n),e&&this.parent!==e&&e.updateChildren(this),this.parent?this.parent.updateChildren(this):this.parentIsAssigned&&(this.parentIdentifier in Sf||(Sf[this.parentIdentifier]=[]),Sf[this.parentIdentifier].push(this))}};function ir(t){return n=>TR(t)(n)}function ct(){return(t,n)=>{t instanceof xr?function Tq(){return(t,n)=>{SR(t,IR,n)}}()(t,n):Wg()(t,n)}}He([Wg()],xr.prototype,"value",void 0),He([Wg()],xr.prototype,"attributes",void 0),He([Wg()],xr.prototype,"parentIdentifier",void 0),He([Wg()],xr.prototype,"majorIndex",void 0),He([Wg()],xr.prototype,"minorIndex",void 0),xr=KT=He([TR("node")],xr);class AR{get length(){return this._length}constructor(n="Queue"){this.name=n,this.queue=Promise.resolve(),this._length=0}add(n){this._length++,console.log(`${this.name} add: ${this._length}`),this.queue=this.queue.then("function"==typeof n.then?()=>n:0<n.length?()=>new Promise(n):n);let e=this.queue;return this.queue=this.queue.catch(i=>{console.error(i)}),this.queue=this.queue.then(()=>{this._length--,console.log(`${this.name} done: ${this._length}`)}),e}}var ke,th=function(t){return t[t.None=0]="None",t[t.IgnoreCase=1]="IgnoreCase",t[t.IgnoreWidth=2]="IgnoreWidth",t}(th||{});!function(t){const n=new RegExp(["\ud83c[\udf00-\udfff]","\ud83d[\udc00-\ude4f]","\ud83d[\ude80-\udeff]","\ud7c9[\ude00-\udeff]","[\u2600-\u27bf]"].join("|"));function C(U){return null==U||""==U.toString()?"":U.toString().replace(/[\uff01-\uff5e]/g,W=>String.fromCharCode(W.charCodeAt(0)-65248))}function M(U,W){if(W===th.None)return U;let K=U;return W&th.IgnoreCase&&(K=K.toLocaleLowerCase()),W&th.IgnoreWidth&&(K=C(K)),K}t.isEmote=function e(U){return!!U&&(U=this.cr(U).replace(/[\s\r\n]/g,""),Array.from(U).length<=3&&!/[\u300c\u300d]/.test(U)&&(n.test(U)||/[$\uff04\\\uffe5\uff01\uff1f\u2755\u2762\u203d\u203c/!/?\u2665\u266a\u266c\u2669\u266b\u263a\ud83e\udd2e\u2764\ufe0f\u2620\ufe0f]/.test(U)))},t.cr=function i(U){if(null==U||""==U)return"";let W="",K="";return[...U].forEach($=>{if(K){switch($){case"n":case"\uff4e":W+="\n";break;case"s":case"\uff53":W+="s"===$?" ":"\u3000";break;case"\\":case"\uffe5":W+=$;break;default:W+=K+$}K=""}else"\\"==$||"\uffe5"==$?K=$:W+=$}),W+K},t.parseCommands=function r(U,W=!1){const K=/[:\uff1a]/,$=/[\uff0b\uff1d+\-=\u2015\u2014\u2010\uff0d>\uff1e]/,ge=/[\s\u3000]/,lt=[K,$],Ee=[$,/[:\uff1a\s\u3000]/],Be=[$,K],ft=[...U],rt=[];let ht="",xt=0,pt=0,Qt={},ln="",Mn="",gt="",Wt="";for(;xt<ft.length;xt++){const St=ft[xt];if((!W||!Mn)&&ge.test(St))break;if(gt)K.test(St)||$.test(St)||W&&St===Mn||(ln+=gt),ln+=St,Wt+=St,gt="";else if("\\"!==St&&"\uffe5"!==St)if(W&&Mn)St!==Mn||null!=ft[xt-1]&&!Ee[pt].test(ft[xt+1])?ln+=St:Mn="",Wt+=St;else if(!W||'"'!==St&&"'"!==St||null!=ft[xt-1]&&!lt[pt].test(ft[xt-1]))if(Be[pt].test(St)){switch(Wt+=St,pt){case 0:Qt.targetName=Mn+ln,Qt.operator=this.toHalfWidth(St.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")),pt=1;break;case 1:Qt.value=Mn+ln,rt.push(Qt),Qt={},pt=0}ht+=Wt,Wt="",ln="",Mn=""}else ln+=St,Wt+=St;else Mn=St,Wt+=St;else gt=St,Wt+=St}const Gt=Mn+ln+gt;switch(pt){case 0:if(""==Gt)break;Qt.targetName=Gt,ht+=Gt,Qt.isIncomplete=!0,rt.push(Qt);break;case 1:Qt.value=Gt,ht+=Gt,rt.push(Qt)}return{commands:rt,commandString:ht,endString:(xt<ft.length?ft.slice(xt).join(""):"").replace(/^[\s\u3000]/,"")}},t.validUrl=function o(U){if(!U)return!1;try{new URL(U.trim())}catch{return!1}return/^https?\:\/\//.test(U.trim())},t.sameOrigin=function s(U){if(!U)return!1;try{return new URL(U).origin===window.location.origin}catch{return!1}},t.escapeHtml=function a(U){return"string"!=typeof U&&(U=U.toString()),U.replace(/[&'`"<>]/g,function(W){return{"&":"&amp;","'":"&#x27;","`":"&#x60;",'"':"&quot;","<":"&lt;",">":"&gt;"}[W]})},t.rubyToHtml=function c(U){return"string"!=typeof U&&(U=U.toString()),U.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g,"<ruby>$1<rp>(</rp><rt>$2</rt><rp>)</rp></ruby>")},t.rubyToText=function u(U){return"string"!=typeof U&&(U=U.toString()),U.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g,"$1($2)")},t.aliasNameToClassName=function f(U){switch(U){case"character":return"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc";case"cut-in":return"\u30ab\u30c3\u30c8\u30a4\u30f3";case"dice-roll-table":return"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868";case"terrain":return"\u5730\u5f62";case"table-mask":return"\u30de\u30c3\u30d7\u30de\u30b9\u30af";case"text-note":return"\u5171\u6709\u30e1\u30e2";case"card":return"\u30ab\u30fc\u30c9";case"dice-symbol":return"\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb";case"card-stack":return"\u5c71\u672d";case"game-table":return"\u30c6\u30fc\u30d6\u30eb";case"chat-tab":return"\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6";case"range":return"\u5c04\u7a0b\u30fb\u7bc4\u56f2";default:return U}},t.textShadowColor=function b(U,W="#ffffff",K="#333333"){return U&&/^\#[0-9a-f]{6}$/i.test(U)&&U.substring(1,7).match(/.{2}/g).reduce(($,ge)=>$+parseInt(ge,16),0)>510?K:W},t.toHalfWidth=C,t.equals=function x(U,W,K=th.None){return U.length===W.length&&(U===W||M(U,K)===M(W,K))},t.normalize=M}(ke||(ke={}));class on{static get instance(){return on._instance||(on._instance=new on),on._instance}get images(){let n=[];for(let e in this.imageHash)n.push(this.imageHash[e]);return n}constructor(){this.imageHash={},console.log("ImageStorage ready...")}destroy(){for(let n in this.imageHash)this.delete(n)}addAsync(n){var e=this;return(0,L.A)(function*(){let i=yield vn.createAsync(n);return e._add(i)})()}add(n){let e;if("string"==typeof n)e=vn.create(n);else if(n instanceof vn)e=n;else{if(this.update(n))return this.imageHash[n.identifier];e=vn.create(n)}return this._add(e)}_add(n){return Ri.COMPLETE<=n.state&&this.lazySynchronize(100),this.update(n)?this.imageHash[n.identifier]:(this.imageHash[n.identifier]=n,console.log("add Image: "+n.identifier),n)}update(n){let e;e=n instanceof vn?n.toContext():n;let i=this.imageHash[n.identifier];return!!i&&(i.apply(n),!0)}delete(n){let e=this.imageHash[n];return!!e&&(e.destroy(),delete this.imageHash[n],!0)}get(n){return this.imageHash[n]||null}synchronize(n){this.lazyTimer&&this.lazyTimer.stop(),ne.call("SYNCHRONIZE_FILE_LIST",this.getCatalog(),n)}lazySynchronize(n,e){null==this.lazyTimer&&(this.lazyTimer=new Nc(()=>this.synchronize(e),n)),this.lazyTimer.reset(n)}getCatalog(){let n=[];for(let e of this.images)Ri.COMPLETE<=e.state&&n.push({identifier:e.identifier,state:e.state});return n}}var zn,Jn=me(119);let Fe=class extends eh{constructor(){super(...arguments),this.userId="",this.peerId="",this.name="",this.imageIdentifier="",this.color=zn.CHAT_DEFAULT_COLOR,this.isGMMode=!1}static#e=zn=this;static#t=this.isGMHold=!1;static#n=this.CHAT_MY_NAME_LOCAL_STORAGE_KEY="udonanaumu-chat-my-name-local-storage";static#i=this.CHAT_MY_COLOR_LOCAL_STORAGE_KEY="udonanaumu-chat-my-color-local-storage";static#r=this.CHAT_MY_ICON_LOCAL_STORAGE_KEY="udonanaumu-chat-my-icon-local-storage";static#o=this.CHAT_DEFAULT_COLOR="#444444";static#s=this.CHAT_DEFAULT_NAME="\u30d7\u30ec\u30a4\u30e4\u30fc";static#a=this.CHAT_TRANSPARENT_COLOR="#ffffff";static#l=this.myCursor=null;static#c=this.userIdMap=new Map;static#u=this.peerIdMap=new Map;get isMine(){return zn.myCursor&&zn.myCursor===this}get image(){return on.instance.get(this.imageIdentifier)}onStoreAdded(){super.onStoreAdded(),this.isMine||ne.register(this).on("DISCONNECT_PEER",n=>{n.data.peerId===this.peerId&&setTimeout(()=>{jt.peerIds.includes(this.peerId)||(zn.userIdMap.delete(this.userId),zn.peerIdMap.delete(this.peerId),bt.instance.remove(this))},3e4)})}onStoreRemoved(){super.onStoreRemoved(),ne.unregister(this),zn.userIdMap.delete(this.userId),zn.peerIdMap.delete(this.peerId)}static findByUserId(n){return this.find(zn.userIdMap,n,!0)}static findByPeerId(n){return this.find(zn.peerIdMap,n,!1)}static find(n,e,i){let r=n.get(e);if(null!=r&&bt.instance.get(r))return bt.instance.get(r);let o=bt.instance.getObjects(zn);for(let s of o){let a=i?s.userId:s.peerId;if(a===e)return n.set(a,s.identifier),s}return null}static createMyCursor(){return(0,L.A)(function*(){if(zn.myCursor)return console.warn("It is already created."),zn.myCursor;zn.myCursor=new zn,zn.myCursor.peerId=jt.peerId,zn.myCursor.initialize();try{try{window.localStorage&&localStorage.getItem(zn.CHAT_MY_NAME_LOCAL_STORAGE_KEY)&&(zn.myCursor.name=localStorage.getItem(zn.CHAT_MY_NAME_LOCAL_STORAGE_KEY),yield Jn.setItem(zn.CHAT_MY_NAME_LOCAL_STORAGE_KEY,zn.myCursor.name,()=>{localStorage.removeItem(zn.CHAT_MY_NAME_LOCAL_STORAGE_KEY)}))}catch(n){console.log(n)}try{window.localStorage&&localStorage.getItem(zn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)&&(zn.myCursor.color=localStorage.getItem(zn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY),yield Jn.setItem(zn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY,zn.myCursor.color,()=>{localStorage.removeItem(zn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)}))}catch(n){console.log(n)}yield Jn.getItem(zn.CHAT_MY_NAME_LOCAL_STORAGE_KEY).then(n=>{"string"==typeof n?zn.myCursor.name=n:void 0!==n&&Jn.removeItem(zn.CHAT_MY_NAME_LOCAL_STORAGE_KEY)}),yield Jn.getItem(zn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY).then(n=>{"string"==typeof n&&/^\#[0-9a-f]{6}$/.test(n.trim().toLowerCase())?zn.myCursor.color=n.trim().toLowerCase():void 0!==n&&Jn.removeItem(zn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)});try{yield Jn.getItem(zn.CHAT_MY_ICON_LOCAL_STORAGE_KEY).then(n=>{let e=null;if("string"==typeof n)if(n.startsWith("data:image/")){const i=n.substring(5,n.indexOf(";")),r=atob(n.replace(/^.*,/,""));let o=new Uint8Array(r.length);for(let s=0;s<r.length;s++)o[s]=r.charCodeAt(s);e=new Blob([o.buffer],{type:i})}else on.instance.images.find(r=>r.identifier===n)?zn.myCursor.imageIdentifier=n:Jn.removeItem(zn.CHAT_MY_ICON_LOCAL_STORAGE_KEY);else n instanceof Blob?e=n:Jn.removeItem(zn.CHAT_MY_ICON_LOCAL_STORAGE_KEY);e&&vn.createAsync(e).then(i=>{i.state===Ri.COMPLETE?(on.instance.add(i),zn.myCursor.imageIdentifier=i.identifier):Jn.removeItem(zn.CHAT_MY_ICON_LOCAL_STORAGE_KEY)})}).catch(n=>{throw n})}catch(n){console.log(n),Jn.removeItem(zn.CHAT_MY_ICON_LOCAL_STORAGE_KEY)}}catch(n){console.log(n),yield Jn.removeItem(zn.CHAT_MY_NAME_LOCAL_STORAGE_KEY).catch(e=>console.log(e)),yield Jn.removeItem(zn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY).catch(e=>console.log(e))}return zn.myCursor})()}apply(n){let e=n.syncData.userId,i=n.syncData.peerId;e!==this.userId&&(zn.userIdMap.set(e,this.identifier),zn.userIdMap.delete(this.userId)),i!==this.peerId&&(zn.peerIdMap.set(i,this.identifier),zn.peerIdMap.delete(this.peerId)),super.apply(n)}isPeerAUdon(){return null!=/u.*d.*o.*n/gi.exec(this.peerId)}};He([ct()],Fe.prototype,"userId",void 0),He([ct()],Fe.prototype,"peerId",void 0),He([ct()],Fe.prototype,"name",void 0),He([ct()],Fe.prototype,"imageIdentifier",void 0),He([ct()],Fe.prototype,"color",void 0),He([ct()],Fe.prototype,"isGMMode",void 0),Fe=zn=He([ir("PeerCursor")],Fe);let $g=class extends xr{constructor(){super(...arguments),this.dicebot="",this.paletteColor="",this._palettes=[],this._paletteLines=[],this._paletteVariables=[],this.isAnalized=!1}get color(){return this.paletteColor&&this.paletteColor!=Fe.CHAT_TRANSPARENT_COLOR?this.paletteColor:Fe.myCursor&&Fe.myCursor.color!=Fe.CHAT_TRANSPARENT_COLOR?Fe.myCursor.color:Fe.CHAT_DEFAULT_COLOR}set color(n){this.paletteColor=n}get paletteLines(){return this.isAnalized||this.parse(this.value),this._paletteLines}get paletteVariables(){return this.isAnalized||this.parse(this.value),this._paletteVariables}getPalette(){return this.isAnalized||this.parse(this.value),this._palettes}setPalette(n){this.value=n,this.isAnalized=!1}evaluate(n,e,i){let r="";r="string"==typeof n?n:n.palette;const o=[];let a=0,c=!0;for(;c;)a++,c=!1,r=r.replace(/[{\uff5b][\s\u3000]*([^{}\uff5b\uff5d]+)[\s\u3000]*[}\uff5d]/g,(u,f)=>{if(o.includes(f))return u;c=!0;let b="";for(let C of this.paletteVariables)ke.cr(ke.toHalfWidth(C.name.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).toLowerCase()).replace(/[\s\r\n]+/," ").trim()===ke.cr(ke.toHalfWidth(f.replace(/[\u2015\u30fc\u2014\u2010]/g,"-"))).toLowerCase().replace(/[\s\r\n]+/," ").trim()&&(b=C.value);if(e){let C=e.getFirstElementByNameUnsensitive(f);if(C?(b=C.isNumberResource?C.currentValue:C.isCheckProperty?C.checkValue():C.isAbilityScore?C.calcAbilityScore():C.value,null==b&&(b="")):(C=e.getFirstElementByNameUnsensitive(f,/^\u6700\u5927/)||e.getFirstElementByNameUnsensitive(f,/^Max[\:\_\-\s]*/i)||e.getFirstElementByNameUnsensitive(f,/^\u521d\u671f/)||e.getFirstElementByNameUnsensitive(f,/\u521d\u671f\u5024$/)||e.getFirstElementByNameUnsensitive(f,/\u6700\u5927\u5024$/))&&(C.isNumberResource||C.isAbilityScore)||(C=e.getFirstElementByNameUnsensitive(f,/^\u57fa\u672c/)||e.getFirstElementByNameUnsensitive(f,/^\u539f/)||e.getFirstElementByNameUnsensitive(f,/\^$/)||e.getFirstElementByNameUnsensitive(f,/\u57fa\u672c\u5024$/)||e.getFirstElementByNameUnsensitive(f,/\u539f\u70b9$/))&&(C.isNumberResource||C.isAbilityScore)?b=C.value:(C=e.getFirstElementByNameUnsensitive(f,/\u4fee\u6b63\u5024?$/)||e.getFirstElementByNameUnsensitive(f,/\s*Mod(ifier|\.)?$/i)||e.getFirstElementByNameUnsensitive(f,/\u30dc\u30fc\u30ca\u30b9$/))&&C.isAbilityScore&&(b=C.calcAbilityScore()),""==b){let x;if(x=/^\$(.+)$/.exec(ke.toHalfWidth(f.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")))){if(i){if(/^\d+$/.test(ke.toHalfWidth(x[1]))){const M=parseInt(ke.toHalfWidth(x[1]));return null!=i[M-1]?i[M-1]:""}return u.replace(f,x[1])}return o.push(f),u}}return b+""}return""}),128<a&&(c=!1);return r}parse(n){this._palettes=n.split("\n"),this._paletteLines=[],this._paletteVariables=[];for(let e of this._palettes){let i=this.parseVariable(e);i?this._paletteVariables.push(i):this._paletteLines.push({palette:e})}this.isAnalized=!0}parseVariable(n){let e=/^[\s\u3000]*[/\uff0f]{2}([^=\uff1d{}\uff5b\uff5d\s\u3000]+)[\s\u3000]*[=\uff1d][\s\u3000]*(.+)[\s\u3000]*/gi.exec(n);return e?{name:ke.toHalfWidth(e[1]),value:e[2]}:null}apply(n){super.apply(n),this.isAnalized=!1}};var nh;He([ct()],$g.prototype,"dicebot",void 0),He([ct()],$g.prototype,"paletteColor",void 0),$g=He([ir("chat-palette")],$g);let wt=nh=class extends xr{get isSimpleNumber(){return null!=this.type&&"simpleNumber"===this.type}get isNumberResource(){return null!=this.type&&"numberResource"===this.type}get isCheckProperty(){return null!=this.type&&"checkProperty"===this.type}get isNote(){return null!=this.type&&"note"===this.type}get isAbilityScore(){return null!=this.type&&"abilityScore"===this.type}get isUrl(){return null!=this.type&&"url"===this.type}static create(n,e="",i={},r=""){let o;return o=r&&0<r.length?new nh(r):new nh,o.attributes=i,o.name=n,o.value=e,o.initialize(),o}get loggingValue(){let n;if(this.isSimpleNumber)n=`${this.value}`;else if(this.isNumberResource)n=`${this.currentValue}/${this.value&&0!=this.value?this.value:"???"}`;else if(this.isCheckProperty)n=this.value?" \u2192 \u2714ON":" \u2192 OFF";else if(this.isAbilityScore){const e=this.calcAbilityScore();n=`${this.value}`,this.currentValue&&(n+=`(${e>=0?"+":""}${e})`)}else n=null==this.value?"":this.value.toString();return this.oldLoggingValue!==n&&(this.oldLoggingValue=n,this.changeObserver&&this.changeObserver()),n}getElementsByName(n,e=th.None){let i=[];for(let r of this.children)r instanceof nh&&(ke.equals(r.getAttribute("name"),n,e)&&i.push(r),Array.prototype.push.apply(i,r.getElementsByName(n,e)));return i}getElementsByType(n,e=th.None){let i=[];for(let r of this.children)r instanceof nh&&(ke.equals(r.getAttribute("type"),n,e)&&i.push(r),Array.prototype.push.apply(i,r.getElementsByType(n,e)));return i}getFirstElementByName(n,e=th.None){for(let i of this.children)if(i instanceof nh){if(ke.equals(i.getAttribute("name"),n,e))return i;let r=i.getFirstElementByName(n,e);if(r)return r}return null}getFirstElementByNameUnsensitive(n,e=null,i=""){for(let r of this.children)if(r instanceof nh){let o=ke.cr(ke.toHalfWidth(n.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).toLowerCase()).replace(/[\s\r\n]+/," ").trim();if(null!=e&&(o=o.replace(e,i)),ke.cr(ke.toHalfWidth(r.getAttribute("name").replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).toLowerCase()).replace(/[\s\r\n]+/," ").trim()===o)return r;let s=r.getFirstElementByNameUnsensitive(n,e,i);if(s)return s}return null}calcAbilityScore(){if(!this.isAbilityScore||!this.value)return 0;let n;return null==this.currentValue?+this.value:(n=this.currentValue.toString().match(/^div(\d+)$/))?Math.floor(+this.value/+n[1]):(n=this.currentValue.toString().match(/^DnD/))?Math.floor((+this.value-10)/2):+this.value}checkValue(){if(!this.isCheckProperty)return"0";let n=(this.currentValue+"").trim().split(/[|\uff5c]/g,2);return null==n[1]&&(n[1]="0",(null==n[0]||""===n[0].trim()&&!/[|\uff5c]/.test(this.currentValue+""))&&(n[0]="1")),n[this.value?0:1].trim()}};var Hi;He([ct()],wt.prototype,"name",void 0),He([ct()],wt.prototype,"type",void 0),He([ct()],wt.prototype,"currentValue",void 0),wt=nh=He([ir("data")],wt),function(t){t.sqrMagnitude=function n(s,a={x:0,y:0,z:0}){return(s.x-a.x)**2+(s.y-a.y)**2+((s.z??0)-(a.z??0))**2},t.clampMin=function e(s,a=0){return s<a?a:s},t.clampMax=function i(s,a=100){return s<a?s:a},t.radians=function r(s){return s*Math.PI/180},t.degrees=function o(s){return 180*s/Math.PI}}(Hi||(Hi={}));let wr=class extends xr{constructor(){super(...arguments),this.location={name:"table",x:0,y:0},this.posZ=0,this._imageFile=vn.Empty,this._shadowImageFile=vn.Empty,this._dataElements={},this.currntImageIndex=0,this.isUseIconToOverviewImage=!1,this.currntIconIndex=0,this.isAltitudeIndicate=!1,this.isInverse=!1,this.isHollow=!1,this.isBlackPaint=!1,this.aura=-1,this.isNotRide=!0,this.isInventoryIndicate=!0}get isVisibleOnTable(){return"table"===this.location.name}get rootDataElement(){for(let n of this.children)if(n.getAttribute("name")===this.aliasName)return n;return null}get imageDataElement(){return this.getElement("image")}get commonDataElement(){return this.getElement("common")}get detailDataElement(){return this.getElement("detail")}get imageElement(){if(!this.imageDataElement)return null;let n=this.imageDataElement.getElementsByName("imageIdentifier");return n[this.currntImageIndex<0?0:this.currntImageIndex>=n.length?n.length-1:this.currntImageIndex]}get imageFile(){if(!this.imageDataElement)return this._imageFile;let n=this.imageElement;if(n&&this._imageFile.identifier!==n.value){let e=on.instance.get(n.value);this._imageFile=e||vn.Empty}return this._imageFile}get imageFiles(){return this.imageDataElement?this.imageDataElement.getElementsByName("imageIdentifier").map(e=>on.instance.get(e.value)||null).filter(e=>null!=e):[]}get faceIcon(){if(!this.imageDataElement)return null;let n=this.imageDataElement.getElementsByName("faceIcon");if(n){let e=n[this.currntIconIndex];return this.currntIconIndex<0&&(this.currntIconIndex=0),e?on.instance.get(e.value):null}return null}get faceIcons(){return this.imageDataElement?this.imageDataElement.getElementsByName("faceIcon").map(e=>on.instance.get(e.value)||null).filter(e=>null!=e):[]}get shadowImageFile(){if(!this.imageDataElement)return this._shadowImageFile;let n=this.imageDataElement.getFirstElementByName("shadowImageIdentifier");if(n&&this._shadowImageFile.identifier!==n.value){let e=on.instance.get(n.value);this._shadowImageFile=e||vn.Empty}else{let e=this.imageElement;if(e&&this._shadowImageFile.identifier!==e.currentValue){let i=on.instance.get(e.currentValue);this._shadowImageFile=i||vn.Empty}}return this._shadowImageFile}get altitude(){let n=this.getElement("altitude",this.commonDataElement),e=n?+n.value:0;return Number.isNaN(e)?0:e}set altitude(n){let e=this.getElement("altitude",this.commonDataElement);e&&(e.value=n)}get isHaveAltitude(){return!!this.getElement("altitude",this.commonDataElement)}get isGMMode(){return!!Fe.myCursor&&Fe.myCursor.isGMMode}calcSqrDistance(n){return Hi.sqrMagnitude({x:this.location.x,y:this.location.y,z:this.posZ},{x:n.location.x,y:n.location.y,z:n.posZ})}createDataElements(){this.initialize();let n=this.aliasName;if(!this.rootDataElement){let e=wt.create(n,"",{},n+"_"+this.identifier);this.appendChild(e)}this.imageDataElement||(this.rootDataElement.appendChild(wt.create("image","",{},"image_"+this.identifier)),this.imageDataElement.appendChild(wt.create("imageIdentifier","",{type:"image"},"imageIdentifier_"+this.identifier))),this.commonDataElement||this.rootDataElement.appendChild(wt.create("common","",{},"common_"+this.identifier)),this.detailDataElement||this.rootDataElement.appendChild(wt.create("detail","",{},"detail_"+this.identifier))}getElement(n,e=this.rootDataElement){if(!e)return null;let i=this._dataElements[n]?bt.instance.get(this._dataElements[n]):null;return(!i||!e.contains(i))&&(i=e.getFirstElementByName(n),this._dataElements[n]=i?i.identifier:null),i}getCommonValue(n,e){let i=this.getElement(n,this.commonDataElement);if(!i)return e;if("number"==typeof e){let r=+i.value;return Number.isNaN(r)?e:r}return i.value+""}getUrls(){return this.rootDataElement.getElementsByType("url")}setCommonValue(n,e){let i=this.getElement(n,this.commonDataElement);i&&(i.value=e)}getImageFile(n){if(!this.imageDataElement)return null;let e=this.getElement(n,this.imageDataElement);return e?on.instance.get(e.value):null}setImageFile(n,e){let i=e?this.getElement(n,this.imageDataElement):null;i&&(i.value=e.identifier)}setLocation(n){this.location.name=n,this.update()}};He([ct()],wr.prototype,"location",void 0),He([ct()],wr.prototype,"posZ",void 0),He([ct()],wr.prototype,"currntImageIndex",void 0),He([ct()],wr.prototype,"isUseIconToOverviewImage",void 0),He([ct()],wr.prototype,"currntIconIndex",void 0),He([ct()],wr.prototype,"isAltitudeIndicate",void 0),He([ct()],wr.prototype,"isInverse",void 0),He([ct()],wr.prototype,"isHollow",void 0),He([ct()],wr.prototype,"isBlackPaint",void 0),He([ct()],wr.prototype,"aura",void 0),He([ct()],wr.prototype,"isNotRide",void 0),He([ct()],wr.prototype,"isInventoryIndicate",void 0),wr=He([ir("TabletopObject")],wr);var mo=function(t){return t[t.Default=1]="Default",t[t.Image=2]="Image",t[t.Postfix=3]="Postfix",t[t.PostfixOrImage=4]="PostfixOrImage",t[t.PostfixAndImage=5]="PostfixAndImage",t[t.NotConditionStandUp=6]="NotConditionStandUp",t}(mo||{});let Bu=class extends wt{constructor(){super(...arguments),this.position=5,this.height=35,this.overviewIndex=-1,this.isSortNameList=!0}get standElements(){return this.getElementsByName("stand")}add(n){let e=this.getFirstElementByName("stand")?mo.NotConditionStandUp:mo.Default,i=wt.create("stand");i.appendChild(wt.create("name","",{},"name_"+i.identifier)),i.appendChild(wt.create("imageIdentifier",n&&n!=vn.Empty.identifier?n:"stand_no_image",{type:"image"},"imageIdentifier_"+i.identifier)),i.appendChild(wt.create("conditionType",e,{},"conditionType_"+i.identifier)),i.appendChild(wt.create("height",0,{currentValue:0},"height_"+i.identifier)),i.appendChild(wt.create("applyImageEffect","",{},"applyImageEffect_"+i.identifier)),i.appendChild(wt.create("applyRoll","",{},"applyRoll_"+i.identifier)),i.appendChild(wt.create("applyDialog","applyDialog",{},"applyDialog_"+i.identifier)),i.appendChild(wt.create("showName","showName",{},"showName_"+i.identifier)),i.appendChild(wt.create("postfix","",{},"postfix_"+i.identifier)),i.appendChild(wt.create("position",0,{currentValue:""},"position_"+i.identifier)),i.appendChild(wt.create("speakingImageIdentifier","",{type:"image"},"speakingImageIdentifier_"+i.identifier)),this.appendChild(i)}remove(n){this.removeChild(n)}matchStandInfo(n,e,i=null){const r=e instanceof vn?e.identifier:e;let o="",s=!1,a=[];["\uff20\u9000\u53bb","@farewell"].forEach(x=>{ke.toHalfWidth(n).trimRight().toUpperCase().endsWith(ke.toHalfWidth(x).toUpperCase())&&(("@"==x.slice(0,1)||"\uff20"==x.slice(0,1))&&o.length<x.length&&(o=x),s=!0)});for(const x of this.standElements){const M=x.getFirstElementByName("name");M&&M.value.toString()==i&&a.push(x)}let c=1,u=!0,f=[],b=[];for(const x of this.standElements){if(!x.getFirstElementByName("imageIdentifier")||!x.getFirstElementByName("conditionType"))continue;const M=x.getFirstElementByName("conditionType").value;if(M!=mo.NotConditionStandUp)if(M==mo.Default)f.push(x);else{const U=x.getFirstElementByName("postfix")?x.getFirstElementByName("postfix").value.toString():null,W=x.getFirstElementByName("targetImageIdentifier")?x.getElementsByName("targetImageIdentifier").map(ge=>ge.value):[];let K=!1,$=!1;if(U&&(M==mo.Postfix||M==mo.PostfixOrImage||M==mo.PostfixAndImage))for(let ge of U.split(/[\r\n]+/g))null==ge||0==ge.trim().length||ke.toHalfWidth(n.replaceAll("\uff1e","\u2192")).toUpperCase().trimRight().endsWith(ke.toHalfWidth(ge.replaceAll("\uff1e","\u2192")).trimRight().toUpperCase())&&(("@"==ge.slice(0,1)||"\uff20"==ge.slice(0,1))&&o.length<ge.length&&(o=ge),K=!0);W.length>0&&(M==mo.Image||M==mo.PostfixOrImage||M==mo.PostfixAndImage)&&($=r&&W.indexOf(r)>=0),(K&&(M==mo.Postfix||M==mo.PostfixOrImage)||$&&(M==mo.Image||M==mo.PostfixOrImage)||K&&$&&M==mo.PostfixAndImage)&&(u=!1,b.push(x),c<+M&&(c=+M))}}i||(a=u?f:b.filter(x=>+x.getFirstElementByName("conditionType").value==c));let C={standElementIdentifier:null,matchMostLongText:o,farewell:s};return a&&a.length>0&&(C.standElementIdentifier=a[Math.floor(Math.random()*a.length)].identifier),C}};var pC;He([ct()],Bu.prototype,"position",void 0),He([ct()],Bu.prototype,"height",void 0),He([ct()],Bu.prototype,"overviewIndex",void 0),He([ct()],Bu.prototype,"isSortNameList",void 0),Bu=He([ir("stand-list")],Bu);let gn=pC=class extends wr{constructor(n=oa.generateUuid()){super(n),this.rotate=0,this.roll=0,this.isDropShadow=!0,this.isShowChatBubble=!0,this.owner="",this.text="",this.dialog=null,this.isEmote=!1,this.isLoaded=!1,this.chatBubbleAltitude=0,this.isAltitudeIndicate=!0}get name(){return this.getCommonValue("name","")}set name(n){this.setCommonValue("name",n)}get size(){return this.getCommonValue("size",1)}get height(){let n=this.getElement("height",this.commonDataElement),e=n?+n.value:0;return n&&n.currentValue&&(e=(Number.isNaN(e)?0:e)*this.size),Number.isNaN(e)?0:e}get chatPalette(){for(let n of this.children)if(n instanceof $g)return n;return null}get ownerName(){let n=Fe.findByUserId(this.owner);return n?n.name:null}get ownerColor(){let n=Fe.findByUserId(this.owner);return n?n.color:"#444444"}get standList(){for(let e of this.children)if(e instanceof Bu)return e;let n=new Bu("StandList_"+this.identifier);return n.initialize(),this.appendChild(n),n}static create(n,e,i){let r=new pC;return r.createDataElements(),r.initialize(),r.createTestGameDataElement(n,e,i),r}get isHideIn(){return!!this.owner}get isVisible(){return!this.owner||jt.peer.userId===this.owner}static get isStealthMode(){for(const n of bt.instance.getObjects(pC))if(n.isHideIn&&n.isVisible&&"table"===n.location.name)return!0;return!1}complement(){let n=this.getElement("altitude",this.commonDataElement);!n&&this.commonDataElement&&this.commonDataElement.appendChild(wt.create("altitude",0,{},"altitude_"+this.identifier)),n=this.getElement("height",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.insertBefore(wt.create("height",0,{currentValue:""},"height_"+this.identifier),this.getElement("altitude",this.commonDataElement))}createTestGameDataElement(n,e,i){this.createDataElements();let r=wt.create("name",n,{},"name_"+this.identifier),o=wt.create("size",e,{},"size_"+this.identifier),s=wt.create("height",0,{currentValue:""},"height_"+this.identifier),a=wt.create("altitude",0,{},"altitude_"+this.identifier);this.imageDataElement.getFirstElementByName("imageIdentifier")&&(this.imageDataElement.getFirstElementByName("imageIdentifier").value=i);let c=wt.create("\u30ea\u30bd\u30fc\u30b9","",{},"\u30ea\u30bd\u30fc\u30b9"+this.identifier),u=wt.create("HP",200,{type:"numberResource",currentValue:"200"},"HP_"+this.identifier),f=wt.create("MP",100,{type:"numberResource",currentValue:"100"},"MP_"+this.identifier);this.commonDataElement.appendChild(r),this.commonDataElement.appendChild(o),this.commonDataElement.appendChild(s),this.commonDataElement.appendChild(a),this.detailDataElement.appendChild(c),c.appendChild(u),c.appendChild(f);let b=wt.create("\u60c5\u5831","",{},"\u60c5\u5831"+this.identifier);this.detailDataElement.appendChild(b),b.appendChild(wt.create("\u8aac\u660e","\u3053\u3053\u306b\u8aac\u660e\u3092\u66f8\u304f\n\u3042\u3044\u3046\u3048\u304a",{type:"note"},"\u8aac\u660e"+this.identifier)),b.appendChild(wt.create("\u30e1\u30e2","\u4efb\u610f\u306e\u6587\u5b57\u5217\n\uff11\n\uff12\n\uff13\n\uff14\n\uff15",{type:"note"},"\u30e1\u30e2"+this.identifier)),b.appendChild(wt.create("\u53c2\u7167URL","https://www.example.com",{type:"url"},"\u53c2\u7167URL"+this.identifier)),b=wt.create("\u80fd\u529b","",{},"\u80fd\u529b"+this.identifier),this.detailDataElement.appendChild(b),b.appendChild(wt.create("\u5668\u7528\u5ea6",24,{type:"abilityScore",currentValue:"div6"},"\u5668\u7528\u5ea6"+this.identifier)),b.appendChild(wt.create("\u654f\u6377\u5ea6",24,{type:"abilityScore",currentValue:"div6"},"\u654f\u6377\u5ea6"+this.identifier)),b.appendChild(wt.create("\u7b4b\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u7b4b\u529b"+this.identifier)),b.appendChild(wt.create("\u751f\u547d\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u751f\u547d\u529b"+this.identifier)),b.appendChild(wt.create("\u77e5\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u77e5\u529b"+this.identifier)),b.appendChild(wt.create("\u7cbe\u795e\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u7cbe\u795e\u529b"+this.identifier)),b=wt.create("\u6226\u95d8\u7279\u6280","",{},"\u6226\u95d8\u7279\u6280"+this.identifier),this.detailDataElement.appendChild(b),b.appendChild(wt.create("Lv1","\u5168\u529b\u653b\u6483",{},"Lv1"+this.identifier)),b.appendChild(wt.create("Lv3","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9",{},"Lv3"+this.identifier)),b.appendChild(wt.create("Lv5","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9\u2161",{},"Lv5"+this.identifier)),b.appendChild(wt.create("Lv7","\u9811\u5f37",{},"Lv7"+this.identifier)),b.appendChild(wt.create("Lv9","\u8599\u304e\u6255\u3044",{},"Lv9"+this.identifier)),b.appendChild(wt.create("\u81ea\u52d5","\u6cbb\u7652\u9069\u6b63",{},"\u81ea\u52d5"+this.identifier)),(new DOMParser).parseFromString(this.rootDataElement.toXml(),"application/xml");let M=new $g("ChatPalette_"+this.identifier);M.setPalette("\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u5165\u529b\u4f8b\uff1a\n2d6+1 \u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\n\uff11\uff44\uff12\uff10\uff0b{\u654f\u6377}\uff0b\uff5b\u683c\u95d8\uff5d\u3000{name}\u306e\u683c\u95d8\uff01\n:\uff48\uff50-3d6 2d20KH1+{\u5668\u7528\u5ea6}+2>=15 \u300a{Lv1}\u300b\u3092\u4f7f\u7528\u3000HP\uff5b\uff041\uff5d\n:HP={\u6700\u5927HP}:MP-10 HP\u5168\u56de\u5fa9\uff01 MP{$2}\u3001HP{HP} \u2192 {$HP}\uff08{$1}\u70b9\u56de\u5fa9\uff09\n//\u654f\u6377=10+{\u654f\u6377A}\n//\u654f\u6377A=10\n//\u683c\u95d8\uff1d\uff11"),M.initialize(),this.appendChild(M);let U=new Bu("StandList_"+this.identifier);U.initialize(),this.appendChild(U)}};He([ct()],gn.prototype,"rotate",void 0),He([ct()],gn.prototype,"roll",void 0),He([ct()],gn.prototype,"isDropShadow",void 0),He([ct()],gn.prototype,"isShowChatBubble",void 0),He([ct()],gn.prototype,"owner",void 0),gn=pC=He([ir("character")],gn);let Uu=class extends xr{constructor(){super(...arguments),this.name="",this.command="",this.dice=""}parseText(){return this.value?this.value.split(/[\r\n]+/).map(n=>{let e=null;if(e=(n=n.trim()).match(/([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[\-\u2015\uff0d~\uff5e][\s\u3000]*([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[:\uff1a](.+)/)){const i=+ke.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-")),r=+ke.toHalfWidth(e[2].replace(/[\-\uff0d\u2010]/,"-"));return i<=r?{range:{start:i,end:r},result:e[3]}:{range:{start:r,end:i},result:e[3]}}if(e=n.match(/([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[\-\u2015\uff0d~\uff5e][\s\u3000]*[\*\uff0a][\s\u3000]*[:\uff1a](.+)/))return{range:{start:+ke.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-")),end:null},result:e[2]};if(e=n.match(/[\*\uff0a][\s\u3000]*[\-\u2015\uff0d~\uff5e][\s\u3000]*([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[:\uff1a](.+)/))return{range:{start:null,end:+ke.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-"))},result:e[2]};if(e=n.match(/([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[:\uff1a](.+)/)){const i=+ke.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-"));return{range:{start:i,end:i},result:e[2]}}return(e=n.match(/[\*\uff0a][\s\u3000]*[\-\u2015\uff0d~\uff5e][\*\uff0a][\s\u3000]*[:\uff1a](.+)/))||(e=n.match(/[\*\uff0a][\s\u3000]*[:\uff1a](.+)/))?{range:{start:null,end:null},result:e[1]}:null}).filter(n=>n):[]}};var Il;He([ct()],Uu.prototype,"name",void 0),He([ct()],Uu.prototype,"command",void 0),He([ct()],Uu.prototype,"dice",void 0),Uu=He([ir("dice-roll-table")],Uu);let Jl=class extends xr{static#e=Il=this;static get instance(){return Il._instance||(Il._instance=new Il("DiceRollTableList"),Il._instance.initialize()),Il._instance}get diceRollTables(){return this.children}addDiceRollTable(...n){let e=null;if(n[0]instanceof Uu)e=n[0];else{let i=n[0];e=new Uu(n[1]),e.name=i,e.initialize()}return this.appendChild(e)}parseInnerXml(n){for(let i of Il.instance.children)i.destroy();let e=Il.instance.toContext();e.syncData=this.toContext().syncData,Il.instance.apply(e),Il.instance.update(),super.parseInnerXml.apply(Il.instance,[n]),this.destroy()}};Jl=Il=He([ir("dice-roll-table-list")],Jl);var Sa=function(t){return t[t.NULL=0]="NULL",t[t.THUMBNAIL=1]="THUMBNAIL",t[t.COMPLETE=2]="COMPLETE",t[t.URL=1e3]="URL",t}(Sa||{});class al{get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob}get url(){return this.context.url}get isReady(){return Sa.NULL<this.state}get state(){return this.url||this.blob?this.url&&!this.blob?Sa.URL:Sa.COMPLETE:Sa.NULL}constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:""},this.isHidden=!1}static createEmpty(n){let e=new al;return e.context.identifier=n,e}static create(n){if("string"==typeof n){let e=new al;return e.context.identifier=n,e.context.name=n,e.context.url=n,e}{let e=new al;return e.apply(n),e}}static createAsync(n){return(0,L.A)(function*(){return n instanceof File?yield al._createAsync(n,n.name):n instanceof Blob?yield al._createAsync(n):void 0})()}static _createAsync(n,e){return(0,L.A)(function*(){let i=yield Ql.readAsArrayBufferAsync(n),r=new al;return r.context.identifier=yield Ql.calcSHA256Async(i),r.context.name=e,r.context.blob=new Blob([i],{type:n.type}),r.context.type=r.context.blob.type,r.context.url=window.URL.createObjectURL(r.context.blob),r.context.name||(r.context.name=r.context.identifier),r})()}destroy(){this.revokeURLs()}apply(n){!this.context.identifier&&n.identifier&&(this.context.identifier=n.identifier),n.name&&(this.context.name=n.name),!this.context.blob&&n.blob&&(this.context.blob=n.blob),!this.context.type&&n.type&&(this.context.type=n.type),!this.context.url&&n.url&&(this.context.url=n.url),this.createURLs()}createURLs(){this.state!==Sa.URL&&this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob))}revokeURLs(){this.state!==Sa.URL&&window.URL.revokeObjectURL(this.context.url)}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url}}}var ec=function(t){return t[t.MASTER=0]="MASTER",t[t.AUDITION=1]="AUDITION",t[t.SOUND_EFFECT=2]="SOUND_EFFECT",t[t.NOTICE=3]="NOTICE",t}(ec||{});class Je{static#e=this.AUDITION_VOLUME_LOCAL_STORAGE_KEY="udonanaumu-audio-player-audition-volume-local-storage";static#t=this.MAIN_VOLUME_LOCAL_STORAGE_KEY="udonanaumu-audio-player-main-volume-local-storage";static#n=this.SOUND_EFFECT_VOLUME_LOCAL_STORAGE_KEY="udonanaumu-audio-player-sound-effect-volume-local-storage";static#i=this.NOTICE_VOLUME_LOCAL_STORAGE_KEY="udonanaumu-audio-player-notice-volume-local-storage";static#r=this.AUDITION_IS_MUTE_LOCAL_STORAGE_KEY="udonanaumu-audio-player-audition-is-mute-local-storage";static#o=this.MAIN_IS_MUTE_LOCAL_STORAGE_KEY="udonanaumu-audio-player-main-is-mute-local-storage";static#s=this.SOUND_EFFECT_IS_MUTE_LOCAL_STORAGE_KEY="udonanaumu-audio-player-sound-effect-is-mute-local-storage";static#a=this.NOTICE_IS_MUTE_LOCAL_STORAGE_KEY="udonanaumu-audio-player-notice-is-mute-local-storage";static get audioContext(){return Je._audioContext||(Je._audioContext=new(window.AudioContext||window.webkitAudioContext)),Je._audioContext}static#l=this._isMute=!1;static get isMute(){return Je._isMute}static set isMute(n){Je._isMute=n,Je.volume=Je._volume}static#c=this._volume=.5;static get volume(){return Je._volume}static set volume(n){Je._volume=n,Je.masterGainNode.gain.setTargetAtTime(Je.isMute?0:Je._volume,Je.audioContext.currentTime,.01)}static#u=this._isAuditionMute=!1;static get isAuditionMute(){return Je._isAuditionMute}static set isAuditionMute(n){Je._isAuditionMute=n,Je.auditionVolume=Je._auditionVolume}static#d=this._auditionVolume=.5;static get auditionVolume(){return Je._auditionVolume}static set auditionVolume(n){Je._auditionVolume=n,Je.auditionGainNode.gain.setTargetAtTime(Je.isAuditionMute?0:Je._auditionVolume,Je.audioContext.currentTime,.01)}static#h=this._isSoundEffectMute=!1;static get isSoundEffectMute(){return Je._isSoundEffectMute}static set isSoundEffectMute(n){Je._isSoundEffectMute=n,Je.soundEffectVolume=Je._soundEffectVolume}static#f=this._soundEffectVolume=.5;static get soundEffectVolume(){return Je._soundEffectVolume}static set soundEffectVolume(n){Je._soundEffectVolume=n,Je.soundEffectGainNode.gain.setTargetAtTime(Je.isSoundEffectMute?0:Je._soundEffectVolume,Je.audioContext.currentTime,.01)}static#p=this._isNoticeMute=!1;static get isNoticeMute(){return Je._isNoticeMute}static set isNoticeMute(n){Je._isNoticeMute=n,Je.noticeVolume=Je._noticeVolume}static#g=this._noticeVolume=.5;static get noticeVolume(){return Je._noticeVolume}static set noticeVolume(n){Je._noticeVolume=n,Je.noticeGainNode.gain.setTargetAtTime(Je.isNoticeMute?0:Je._noticeVolume,Je.audioContext.currentTime,.01)}static get masterGainNode(){if(!Je._masterGainNode){let n=Je.audioContext.createGain();n.gain.setValueAtTime(Je._volume,Je.audioContext.currentTime),n.connect(Je.audioContext.destination),Je._masterGainNode=n}return Je._masterGainNode}static get auditionGainNode(){if(!Je._auditionGainNode){let n=Je.audioContext.createGain();n.gain.setValueAtTime(Je._auditionVolume,Je.audioContext.currentTime),n.connect(Je.audioContext.destination),Je._auditionGainNode=n}return Je._auditionGainNode}static get soundEffectGainNode(){if(!Je._soundEffectGainNode){let n=Je.audioContext.createGain();n.gain.setValueAtTime(Je._soundEffectVolume,Je.audioContext.currentTime),n.connect(Je.audioContext.destination),Je._soundEffectGainNode=n}return Je._soundEffectGainNode}static get noticeGainNode(){if(!Je._noticeGainNode){let n=Je.audioContext.createGain();n.gain.setValueAtTime(Je._noticeVolume,Je.audioContext.currentTime),n.connect(Je.audioContext.destination),Je._noticeGainNode=n}return Je._noticeGainNode}static get rootNode(){return Je.masterGainNode}static get auditionNode(){return Je.auditionGainNode}static get soundEffectNode(){return Je.soundEffectGainNode}static get noticeNode(){return Je.noticeGainNode}get audioElm(){return this._audioElm||(this._audioElm=new Audio,this._audioElm.onplay=()=>{},this._audioElm.onpause=()=>{this.mediaElementSource.disconnect()},this._audioElm.onended=()=>{this.mediaElementSource.disconnect()}),this._audioElm}get mediaElementSource(){return this._mediaElementSource||(this._mediaElementSource=Je.audioContext.createMediaElementSource(this.audioElm)),this._mediaElementSource}get volume(){return this.audioElm.volume}set volume(n){this.audioElm.volume=n}get loop(){return this.audioElm.loop}set loop(n){this.audioElm.loop=n}get paused(){return this.audioElm.paused}static#m=this.cacheMap=new Map;constructor(n){this.volumeType=ec.MASTER,this.audio=n}static play(n,e=1){this.playBufferAsync(n,e)}static playSoundEffect(n,e=1){this.playBufferAsyncBase(Je.soundEffectNode,n,e)}play(n=this.audio){if(this.stop(),this.audio=n,!this.audio)return;let e=this.audio.url;n.state===Sa.URL&&(Je.cacheMap.has(n.identifier)?e=Je.cacheMap.get(n.identifier).url:Je.createCacheAsync(n)),this.mediaElementSource.connect(this.getConnectingAudioNode()),this.audioElm.src=e,this.audioElm.load(),this.audioElm.play().catch(i=>{console.warn(i)})}pause(){this.audioElm.pause()}stop(){this.audioElm&&(this.pause(),this.audioElm.currentTime=0,this.audioElm.src="",this.audioElm.load(),this.mediaElementSource.disconnect())}getConnectingAudioNode(){switch(this.volumeType){case ec.AUDITION:return Je.auditionNode;case ec.SOUND_EFFECT:return Je.soundEffectNode;case ec.NOTICE:return Je.noticeNode;default:return Je.rootNode}}static playBufferAsync(n,e=1){return(0,L.A)(function*(){Je.playBufferAsyncBase(Je.rootNode,n,e)})()}static playBufferAsyncBase(n,e,i=1){return(0,L.A)(function*(){let r=yield Je.createBufferSourceAsync(e);if(!r)return;let o=Je.audioContext.createGain();o.gain.setValueAtTime(i,Je.audioContext.currentTime),o.connect(n),r.connect(o),r.onended=()=>{r.stop(),r.disconnect(),o.disconnect(),r.buffer=null},r.start()})()}static createBufferSourceAsync(n){var e=this;return(0,L.A)(function*(){if(!n)return null;try{let i=n.blob;if(n.state===Sa.URL)if(Je.cacheMap.has(n.identifier))i=Je.cacheMap.get(n.identifier).blob;else{let s=yield Je.createCacheAsync(n);i=s&&s.blob?s.blob:null}if(!i)return null;let r=yield e.decodeAudioDataAsync(i),o=Je.audioContext.createBufferSource();return o.buffer=r,o}catch(i){return console.warn(i),null}})()}static decodeAudioDataAsync(n){return new Promise(function(){var e=(0,L.A)(function*(i,r){Je.audioContext.decodeAudioData(yield Ql.readAsArrayBufferAsync(n),o=>i(o),o=>r(o))});return function(i,r){return e.apply(this,arguments)}}())}static getBlobAsync(n){return(0,L.A)(function*(){if(n.blob)return n.blob;if(n.url.length<1)throw new Error("\u3048\u3063 \u306a\u306b\u305d\u308c\u6016\u3044");try{let e=yield fetch(n.url);if(!e.ok)throw new Error("Network response was not ok.");return yield e.blob()}catch(e){throw console.warn("There has been a problem with your fetch operation: ",e.message),e}})()}static createCacheAsync(n){return(0,L.A)(function*(){let e={url:n.url,blob:null};try{e.blob=yield Je.getBlobAsync(n)}catch(i){return console.error(i),e}return Je.cacheMap.has(n.identifier)?Je.cacheMap.get(n.identifier):(e.url=URL.createObjectURL(e.blob),Je.cacheMap.set(n.identifier,e),e)})()}static resumeAudioContext(){Je.audioContext.resume();let n=()=>{Je.audioContext.resume(),document.removeEventListener("touchstart",n,!0),document.removeEventListener("mousedown",n,!0),console.log("resumeAudioContext")};document.addEventListener("touchstart",n,!0),document.addEventListener("mousedown",n,!0)}}class un{static get instance(){return un._instance||(un._instance=new un),un._instance}get audios(){let n=[];for(let e in this.hash)n.push(this.hash[e]);return n}constructor(){this.hash={},console.log("AudioStorage ready...")}destroy(){for(let n in this.hash)this.delete(n)}addAsync(n){var e=this;return(0,L.A)(function*(){let i=yield al.createAsync(n);return e._add(i)})()}add(n){let e;if("string"==typeof n)e=al.create(n);else if(n instanceof al)e=n;else{if(this.update(n))return this.hash[n.identifier];e=al.create(n)}return this._add(e)}_add(n){return Sa.COMPLETE<=n.state&&this.lazySynchronize(100),this.update(n)?this.hash[n.identifier]:(this.hash[n.identifier]=n,console.log("add Audio: "+n.identifier),n)}update(n){let e;e=n instanceof al?n.toContext():n;let i=this.hash[n.identifier];return!!i&&(i.apply(n),!0)}delete(n){let e=this.hash[n];return!!e&&(e.destroy(),delete this.hash[n],!0)}get(n){return this.hash[n]||null}synchronize(n){this.lazyTimer&&this.lazyTimer.stop(),ne.call("SYNCHRONIZE_AUDIO_LIST",this.getCatalog(),n)}lazySynchronize(n,e){null==this.lazyTimer&&(this.lazyTimer=new Nc(()=>this.synchronize(e),n)),this.lazyTimer.reset(n)}getCatalog(){let n=[];for(let e of un.instance.audios)Sa.COMPLETE<=e.state&&n.push({identifier:e.identifier,state:e.state});return n}}var PR=function(t){return t.ACTION="action",t.SEPARATOR="separator",t}(PR||{});const Zt={name:"",disabled:!0,type:PR.SEPARATOR};let Bo=(()=>{class t{constructor(){this.title="",this.actions=[],this.position={x:0,y:0},this.titleColor=Fe.CHAT_DEFAULT_COLOR,this.titleBold=!1}static#e=this.ContextMenuComponentClass=null;get isShow(){return!!this.panelComponentRef}open(e,i,r,o,s,a){this.close(),o||(o=t.defaultParentViewContainerRef);let u=o.createComponent(t.ContextMenuComponentClass,{index:o.length,injector:o.injector});const f=u.injector.get(t);f.panelComponentRef=u,i&&(f.actions=i),e&&(f.position.x=e.x,f.position.y=e.y),f.titleColor=s||Fe.CHAT_DEFAULT_COLOR,f.titleBold=a,f.title=r??"",u.onDestroy(()=>{f.panelComponentRef=null})}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}static#t=this.\u0275fac=function(i){return new(i||t)};static#n=this.\u0275prov=nn({token:t,factory:t.\u0275fac})}return t})(),lr=(()=>{class t{get isAllowedToOpenContextMenu(){return this._isAllowedToOpenContextMenu}get pointer(){return this.primaryPointer}get pointerX(){return this.primaryPointer.x}get pointerY(){return this.primaryPointer.y}get isDragging(){return this._isDragging}set isDragging(e){e!==this._isDragging&&this.ngZone.run(()=>{this._isDragging=e,document.body.dispatchEvent(new CustomEvent("draggingstate",{detail:e,bubbles:!0}))})}constructor(e){this.ngZone=e,this.callbackOnPointerDown=i=>this.onPointerDown(i),this.callbackOnPointerMove=i=>this.onPointerMove(i),this.callbackOnPointerUp=i=>this.onPointerUp(i),this.callbackOnContextMenu=i=>this.onContextMenu(i),this._isAllowedToOpenContextMenu=!1,this.pointers=[{x:0,y:0,z:0,identifier:-1}],this.startPostion=this.pointers[0],this.primaryPointer=this.pointers[0],this._isDragging=!1,this.isTablePickGesture=!1}initialize(){this.addEventListeners()}destroy(){this.removeEventListeners()}onPointerDown(e){this.onPointerMove(e),this._isAllowedToOpenContextMenu=!0,this.startPostion=this.pointers[0]}onPointerMove(e){e.touches?this.onTouchMove(e):this.onMouseMove(e),this.targetElement=e.target}onPointerUp(e){this.onPointerMove(e)}onMouseMove(e){let i={x:e.pageX,y:e.pageY,z:0,identifier:-9999};this.isSyntheticEvent(i)||(this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(i,3),this.pointers=[i],this.primaryPointer=i)}onTouchMove(e){let i=e.touches.length;if(!(i<1)){this.pointers=[];for(let r=0;r<i;r++){let o=e.touches[r],s={x:o.pageX,y:o.pageY,z:0,identifier:o.identifier};this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(s,12),this.pointers.push(s)}this.primaryPointer=this.pointers[0]}}onContextMenu(e){this._isAllowedToOpenContextMenu=!0,this.onPointerUp(e)}preventContextMenuIfNeeded(e,i=3){i**2<Hi.sqrMagnitude(e,this.startPostion)&&(this._isAllowedToOpenContextMenu=!1)}isSyntheticEvent(e,i=15){for(let r of this.pointers)if(r.identifier!==e.identifier&&Hi.sqrMagnitude(e,r)<i**2)return!0;return!1}addEventListeners(){this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.addEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.addEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.addEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.addEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.addEventListener("touchend",this.callbackOnPointerUp,!0),document.body.addEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.addEventListener("drop",this.callbackOnPointerUp,!0),document.body.addEventListener("contextmenu",this.callbackOnContextMenu,!0)})}removeEventListeners(){document.body.removeEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.removeEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.removeEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.removeEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.removeEventListener("touchend",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.removeEventListener("drop",this.callbackOnPointerUp,!0),document.body.removeEventListener("contextmenu",this.callbackOnContextMenu,!0)}static#e=this.\u0275fac=function(i){return new(i||t)(Nn(Pn))};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function FR(t,n,e){return e?FR(t,n).pipe(mI(e)):new qi(i=>{const r=(...s)=>i.next(1===s.length?s[0]:s),o=t(r);return Ae(n)?()=>n(r,o):void 0})}function gC(...t){return ky(t,gI(t))}function cb(t,n){return xo((e,i)=>{let r=null,o=0,s=!1;const a=()=>s&&!r&&i.complete();e.subscribe(oo(i,c=>{r?.unsubscribe();let u=0;const f=o++;tl(t(c,f)).subscribe(r=oo(i,b=>i.next(n?n(c,b,f,u++):b),()=>{r=null,a()}))},()=>{s=!0,a()}))})}const Aq=["youtubeContainer"];function Pq(t,n){if(1&t){const e=Le();p(0,"youtube-player-placeholder",2),he("click",function(){return V(e),H(v()._load(!0))}),g()}if(2&t){const e=v();m("videoId",e.videoId)("width",e.width)("height",e.height)("isLoading",e._isLoading)("buttonLabel",e.placeholderButtonLabel)("quality",e.placeholderImageQuality)}}let Fq=(()=>{class t{_getBackgroundImage(){let e;return e="low"===this.quality?`https://i.ytimg.com/vi/${this.videoId}/hqdefault.jpg`:"high"===this.quality?`https://i.ytimg.com/vi/${this.videoId}/maxresdefault.jpg`:`https://i.ytimg.com/vi_webp/${this.videoId}/sddefault.webp`,`url(${e})`}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275cmp=In({type:t,selectors:[["youtube-player-placeholder"]],hostAttrs:[1,"youtube-player-placeholder"],hostVars:8,hostBindings:function(i,r){2&i&&(je("background-image",r._getBackgroundImage())("width",r.width,"px")("height",r.height,"px"),d0("youtube-player-placeholder-loading",r.isLoading))},inputs:{videoId:"videoId",width:"width",height:"height",isLoading:"isLoading",buttonLabel:"buttonLabel",quality:"quality"},standalone:!0,features:[v2],decls:4,vars:1,consts:[["type","button",1,"youtube-player-placeholder-button"],["height","100%","version","1.1","viewBox","0 0 68 48","focusable","false","aria-hidden","true"],["d","M66.52,7.74c-0.78-2.93-2.49-5.41-5.42-6.19C55.79,.13,34,0,34,0S12.21,.13,6.9,1.55 C3.97,2.33,2.27,4.81,1.48,7.74C0.06,13.05,0,24,0,24s0.06,10.95,1.48,16.26c0.78,2.93,2.49,5.41,5.42,6.19 C12.21,47.87,34,48,34,48s21.79-0.13,27.1-1.55c2.93-0.78,4.64-3.26,5.42-6.19C67.94,34.95,68,24,68,24S67.94,13.05,66.52,7.74z","fill","#f00"],["d","M 45,24 27,14 27,34","fill","#fff"]],template:function(i,r){1&i&&(p(0,"button",0),mc(),p(1,"svg",1),Ge(2,"path",2)(3,"path",3),g()()),2&i&&en("aria-label",r.buttonLabel)},styles:[".youtube-player-placeholder{display:flex;align-items:center;justify-content:center;width:100%;overflow:hidden;cursor:pointer;background-color:#000;background-position:center center;background-size:cover;transition:box-shadow 300ms ease;box-shadow:inset 0 120px 90px -90px rgba(0,0,0,.8)}.youtube-player-placeholder-button{transition:opacity 300ms ease;-moz-appearance:none;-webkit-appearance:none;background:none;border:none;padding:0;display:flex}.youtube-player-placeholder-button svg{width:68px;height:48px}.youtube-player-placeholder-loading{box-shadow:none}.youtube-player-placeholder-loading .youtube-player-placeholder-button{opacity:0}"],encapsulation:2,changeDetection:0})}return t})();const Nq=new mn("YOUTUBE_PLAYER_CONFIG");function LR(t){return null==t?t:z2(t,0)}let Rq=(()=>{class t{get height(){return this._height}set height(e){this._height=null==e||isNaN(e)?390:e}get width(){return this._width}set width(e){this._width=null==e||isNaN(e)?640:e}constructor(e,i){this._ngZone=e,this._destroyed=new zs,this._playerChanges=new ac(void 0),this._nonce=kn(Up,{optional:!0}),this._changeDetectorRef=kn(Zr),this._isLoading=!1,this._hasPlaceholder=!0,this._height=390,this._width=640,this.disableCookies=!1,this.disablePlaceholder=!1,this.showBeforeIframeApiLoads=!1,this.ready=this._getLazyEmitter("onReady"),this.stateChange=this._getLazyEmitter("onStateChange"),this.error=this._getLazyEmitter("onError"),this.apiChange=this._getLazyEmitter("onApiChange"),this.playbackQualityChange=this._getLazyEmitter("onPlaybackQualityChange"),this.playbackRateChange=this._getLazyEmitter("onPlaybackRateChange");const r=kn(Nq,{optional:!0});this.loadApi=r?.loadApi??!0,this.disablePlaceholder=!!r?.disablePlaceholder,this.placeholderButtonLabel=r?.placeholderButtonLabel||"Play video",this.placeholderImageQuality=r?.placeholderImageQuality||"standard",this._isBrowser=eI(i)}ngAfterViewInit(){this._conditionallyLoad()}ngOnChanges(e){this._shouldRecreatePlayer(e)?this._conditionallyLoad():this._player&&((e.width||e.height)&&this._setSize(),e.suggestedQuality&&this._setQuality(),(e.startSeconds||e.endSeconds||e.suggestedQuality)&&this._cuePlayer())}ngOnDestroy(){this._pendingPlayer?.destroy(),this._player&&(this._player.destroy(),window.onYouTubeIframeAPIReady=this._existingApiReadyCallback),this._playerChanges.complete(),this._destroyed.next(),this._destroyed.complete()}playVideo(){this._player?this._player.playVideo():this._getPendingState().playbackState=YT.PlayerState.PLAYING}pauseVideo(){this._player?this._player.pauseVideo():this._getPendingState().playbackState=YT.PlayerState.PAUSED}stopVideo(){this._player?this._player.stopVideo():this._getPendingState().playbackState=YT.PlayerState.CUED}seekTo(e,i){this._player?this._player.seekTo(e,i):this._getPendingState().seek={seconds:e,allowSeekAhead:i}}mute(){this._player?this._player.mute():this._getPendingState().muted=!0}unMute(){this._player?this._player.unMute():this._getPendingState().muted=!1}isMuted(){return this._player?this._player.isMuted():!!this._pendingPlayerState&&!!this._pendingPlayerState.muted}setVolume(e){this._player?this._player.setVolume(e):this._getPendingState().volume=e}getVolume(){return this._player?this._player.getVolume():this._pendingPlayerState&&null!=this._pendingPlayerState.volume?this._pendingPlayerState.volume:0}setPlaybackRate(e){if(this._player)return this._player.setPlaybackRate(e);this._getPendingState().playbackRate=e}getPlaybackRate(){return this._player?this._player.getPlaybackRate():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackRate?this._pendingPlayerState.playbackRate:0}getAvailablePlaybackRates(){return this._player?this._player.getAvailablePlaybackRates():[]}getVideoLoadedFraction(){return this._player?this._player.getVideoLoadedFraction():0}getPlayerState(){if(this._isBrowser&&window.YT)return this._player?this._player.getPlayerState():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackState?this._pendingPlayerState.playbackState:YT.PlayerState.UNSTARTED}getCurrentTime(){return this._player?this._player.getCurrentTime():this._pendingPlayerState&&this._pendingPlayerState.seek?this._pendingPlayerState.seek.seconds:0}getPlaybackQuality(){return this._player?this._player.getPlaybackQuality():"default"}getAvailableQualityLevels(){return this._player?this._player.getAvailableQualityLevels():[]}getDuration(){return this._player?this._player.getDuration():0}getVideoUrl(){return this._player?this._player.getVideoUrl():""}getVideoEmbedCode(){return this._player?this._player.getVideoEmbedCode():""}_load(e){this._isBrowser&&(window.YT&&window.YT.Player?this._createPlayer(e):(this.loadApi&&(this._isLoading=!0,function Lq(t){if(QT)return;const e=document.createElement("script"),i=r=>{e.removeEventListener("load",i),e.removeEventListener("error",i),"error"===r.type&&(QT=!1)};e.addEventListener("load",i),e.addEventListener("error",i),e.src="https://www.youtube.com/iframe_api",e.async=!0,t&&e.setAttribute("nonce",t),QT=!0,document.body.appendChild(e)}(this._nonce)),this._existingApiReadyCallback=window.onYouTubeIframeAPIReady,window.onYouTubeIframeAPIReady=()=>{this._existingApiReadyCallback?.(),this._ngZone.run(()=>this._createPlayer(e))}))}_conditionallyLoad(){this._shouldShowPlaceholder()?1===this.playerVars?.autoplay&&this._load(!0):this._load(!1)}_shouldShowPlaceholder(){return!this.disablePlaceholder&&(!this._isBrowser||this._hasPlaceholder&&!!this.videoId&&!this._player)}_getPendingState(){return this._pendingPlayerState||(this._pendingPlayerState={}),this._pendingPlayerState}_shouldRecreatePlayer(e){const i=e.videoId||e.playerVars||e.disableCookies||e.disablePlaceholder;return!!i&&!i.isFirstChange()}_createPlayer(e){if(this._player?.destroy(),this._pendingPlayer?.destroy(),typeof YT>"u"||!this.videoId&&!this.playerVars?.list)return;const i=this._ngZone.runOutsideAngular(()=>new YT.Player(this.youtubeContainer.nativeElement,{videoId:this.videoId,host:this.disableCookies?"https://www.youtube-nocookie.com":void 0,width:this.width,height:this.height,playerVars:e?{...this.playerVars||{},autoplay:1}:this.playerVars})),r=()=>{this._ngZone.run(()=>{this._isLoading=!1,this._hasPlaceholder=!1,this._player=i,this._pendingPlayer=void 0,i.removeEventListener("onReady",r),this._playerChanges.next(i),this._setSize(),this._setQuality(),this._pendingPlayerState&&(this._applyPendingPlayerState(i,this._pendingPlayerState),this._pendingPlayerState=void 0);const o=i.getPlayerState();(o===YT.PlayerState.UNSTARTED||o===YT.PlayerState.CUED||null==o)&&this._cuePlayer(),this._changeDetectorRef.markForCheck()})};this._pendingPlayer=i,i.addEventListener("onReady",r)}_applyPendingPlayerState(e,i){const{playbackState:r,playbackRate:o,volume:s,muted:a,seek:c}=i;switch(r){case YT.PlayerState.PLAYING:e.playVideo();break;case YT.PlayerState.PAUSED:e.pauseVideo();break;case YT.PlayerState.CUED:e.stopVideo()}null!=o&&e.setPlaybackRate(o),null!=s&&e.setVolume(s),null!=a&&(a?e.mute():e.unMute()),null!=c&&e.seekTo(c.seconds,c.allowSeekAhead)}_cuePlayer(){this._player&&this.videoId&&this._player.cueVideoById({videoId:this.videoId,startSeconds:this.startSeconds,endSeconds:this.endSeconds,suggestedQuality:this.suggestedQuality})}_setSize(){this._player?.setSize(this.width,this.height)}_setQuality(){this._player&&this.suggestedQuality&&this._player.setPlaybackQuality(this.suggestedQuality)}_getLazyEmitter(e){return this._playerChanges.pipe(cb(i=>i?FR(r=>{i.addEventListener(e,r)},r=>{try{i?.removeEventListener?.(e,r)}catch{}}):gC()),i=>new qi(r=>i.subscribe({next:o=>this._ngZone.run(()=>r.next(o)),error:o=>r.error(o),complete:()=>r.complete()})),function Oq(t){return xo((n,e)=>{tl(t).subscribe(oo(e,()=>e.complete(),hn)),!e.closed&&n.subscribe(e)})}(this._destroyed))}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Pn),Y(Za))};static#t=this.\u0275cmp=In({type:t,selectors:[["youtube-player"]],viewQuery:function(i,r){if(1&i&&Ln(Aq,7),2&i){let o;Bn(o=Un())&&(r.youtubeContainer=o.first)}},inputs:{videoId:"videoId",height:[Ce.HasDecoratorInputTransform,"height","height",z2],width:[Ce.HasDecoratorInputTransform,"width","width",z2],startSeconds:[Ce.HasDecoratorInputTransform,"startSeconds","startSeconds",LR],endSeconds:[Ce.HasDecoratorInputTransform,"endSeconds","endSeconds",LR],suggestedQuality:"suggestedQuality",playerVars:"playerVars",disableCookies:[Ce.HasDecoratorInputTransform,"disableCookies","disableCookies",cf],loadApi:[Ce.HasDecoratorInputTransform,"loadApi","loadApi",cf],disablePlaceholder:[Ce.HasDecoratorInputTransform,"disablePlaceholder","disablePlaceholder",cf],showBeforeIframeApiLoads:[Ce.HasDecoratorInputTransform,"showBeforeIframeApiLoads","showBeforeIframeApiLoads",cf],placeholderButtonLabel:"placeholderButtonLabel",placeholderImageQuality:"placeholderImageQuality"},outputs:{ready:"ready",stateChange:"stateChange",error:"error",apiChange:"apiChange",playbackQualityChange:"playbackQualityChange",playbackRateChange:"playbackRateChange"},standalone:!0,features:[j3,hr,v2],decls:4,vars:3,consts:[["youtubeContainer",""],[3,"videoId","width","height","isLoading","buttonLabel","quality"],[3,"click","videoId","width","height","isLoading","buttonLabel","quality"]],template:function(i,r){1&i&&(q(0,Pq,1,6,"youtube-player-placeholder",1),p(1,"div"),Ge(2,"div",null,0),g()),2&i&&(UD(0,r._shouldShowPlaceholder()?0:-1),h(),je("display",r._shouldShowPlaceholder()?"none":""))},dependencies:[Fq],encapsulation:2,changeDetection:0})}return t})(),QT=!1,Bq=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ga({type:t});static#n=this.\u0275inj=ha({})}return t})();var _o;!function(t){function e(i,r=0){return i=parseFloat(i),isNaN(i)?r:i}t.relation=function n(i,r,o=0){return"number"==typeof i?i:"string"==typeof i?(i=i.trim().toLowerCase()).indexOf("%")>0?e(i.replace("%",""),o)/100*r:i.indexOf("px")>0||i.indexOf("pt")>0?e(i.replace("px",""),o):i.indexOf("vw")>0?e(i.replace("vw",""),o)/100*window.innerWidth:i.indexOf("vh")>0?e(i.replace("vh",""),o)/100*window.innerHeight:i.indexOf("vm")>0?e(i.replace("vm",""),o)/100*Math.min(window.innerWidth,window.innerHeight):i.indexOf("em")>0?e(i.replace("em",""),o):"top"===i||"left"===i?0:"center"===i||"middle"===i?.5*r:"bottom"===i||"right"===i?r:o:o},t.parse=e}(_o||(_o={}));const ub=-9999;class Bc{get startPointer(){return this.firstPointer}get pointer(){return this.primaryPointer}get magnitude(){return Hi.sqrMagnitude(this.firstPointer,this.primaryPointer)}get isDragging(){return this._isDragging}get isGrabbing(){return this._isGrabbing}get isPointerMoved(){return this._isPointerMoved}get isDestroyed(){return this._isDestroyed}constructor(...n){this.callbackOnMouse=this.onMouse.bind(this),this.callbackOnTouch=this.onTouch.bind(this),this.callbackOnMenu=this.onMenu.bind(this),this.startTime=-1e3,this.clearLastPointerTimer=new Nc(this.clearLastPointer.bind(this),2e3,!1),this.firstPointer={x:0,y:0,z:0,identifier:ub},this.lastStartPointers=[],this.lastMovePointers=[],this.primaryPointer={x:0,y:0,z:0,identifier:ub},this._isDragging=!1,this._isGrabbing=!1,this._isPointerMoved=!1,this._isDestroyed=!1;let e=n[0],i={capture:!1,passive:!1,always:!1},r=!0;switch(n.length){case 3:i=n[1],r=n[2];break;case 2:"boolean"==typeof n[1]?r=n[1]:i=n[1]}this.target=e,this.option={capture:!0===i.capture,passive:!0===i.passive,always:!0===i.always},r&&this.initialize()}initialize(){this.target.addEventListener("mousedown",this.callbackOnMouse,this.option.capture),this.target.addEventListener("touchstart",this.callbackOnTouch,this.option.capture),this.option.always&&this.addEventListeners()}destroy(){this.cancel(),this.clearLastPointerTimer.clear(),this._isDestroyed=!0,this.target.removeEventListener("mousedown",this.callbackOnMouse,this.option.capture),this.target.removeEventListener("touchstart",this.callbackOnTouch,this.option.capture),this.removeEventListeners(),this.onStart=null,this.onMove=null,this.onEnd=null,this.onContextMenu=null}cancel(){this._isDragging=this._isGrabbing=!1,this.clearLastPointerTimer.reset(),this.option.always||this.removeEventListeners()}onMouse(n){let e={x:n.pageX,y:n.pageY,z:0,identifier:ub};this.isSyntheticEvent(n)?this.updateLastPointer(n):(this.updateLastPointer(n),this.primaryPointer=e,this.onPointer(n))}onTouch(n){if(!(n.changedTouches.length<1)){if(this.updateLastPointer(n),"touchstart"===n.type)this.primaryPointer=this.lastStartPointers[0];else{let r=Array.from(n.changedTouches).find(s=>s.identifier===this.primaryPointer.identifier);if(null==r)return void(null!=Array.from(n.touches).find(a=>a.identifier===this.primaryPointer.identifier)||(this.onEnd&&this.onEnd(n),this.cancel()));this.primaryPointer={x:r.pageX,y:r.pageY,z:0,identifier:r.identifier}}this.onPointer(n)}}onPointer(n){switch(n.type){case"mousedown":case"touchstart":this.onTap&&(this.startTime=performance.now()),this.clearLastPointerTimer.stop(),this.firstPointer=this.primaryPointer,this._isGrabbing=!0,this._isDragging=!1,this._isPointerMoved=!1,this.addEventListeners(),this.onStart&&this.onStart(n);break;case"mousemove":case"touchmove":this.onMove&&this.onMove(n),this._isDragging=this._isGrabbing,this._isPointerMoved=this._isPointerMoved||(n instanceof MouseEvent?3:12)**2<Hi.sqrMagnitude(this.firstPointer,this.primaryPointer);break;default:this.onEnd&&this.onEnd(n),this.onTap&&performance.now()-this.startTime<250&&!this._isPointerMoved&&this.onTap(n),this.cancel()}}onMenu(n){this.onContextMenu&&this.onContextMenu(n)}isSyntheticEvent(n,e=15){let i={x:n.pageX,y:n.pageY,z:0,identifier:ub},r=this.lastMovePointers;"mousemove"!==n.type&&(r=r.concat(this.lastStartPointers));for(let o of r)if(o.identifier!==i.identifier&&Hi.sqrMagnitude(i,o)<e**2)return!0;return!1}updateLastPointer(n){let e=[];if(n instanceof MouseEvent)e.push({x:n.pageX,y:n.pageY,z:0,identifier:ub});else{let i=n.touches.length;for(let r=0;r<i;r++){let o=n.touches[r];e.push({x:o.pageX,y:o.pageY,z:0,identifier:o.identifier})}}this.lastMovePointers=e,("mousedown"===n.type||"touchstart"===n.type)&&(this.lastStartPointers=e)}clearLastPointer(){this.clearLastPointerTimer.stop(),this.lastStartPointers=[],this.lastMovePointers=[]}addEventListeners(){let n={capture:this.option.capture,passive:this.option.passive};this.target.ownerDocument.addEventListener("mousemove",this.callbackOnMouse,n),this.target.ownerDocument.addEventListener("mouseup",this.callbackOnMouse,n),this.target.ownerDocument.addEventListener("touchmove",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("touchend",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("touchcancel",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("contextmenu",this.callbackOnMenu,n),this.target.ownerDocument.addEventListener("drop",this.callbackOnMouse,n)}removeEventListeners(){let n={capture:this.option.capture};this.target.ownerDocument.removeEventListener("mousemove",this.callbackOnMouse,n),this.target.ownerDocument.removeEventListener("mouseup",this.callbackOnMouse,n),this.target.ownerDocument.removeEventListener("touchmove",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("touchend",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("touchcancel",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("contextmenu",this.callbackOnMenu,n),this.target.ownerDocument.removeEventListener("drop",this.callbackOnMouse,n)}}let JT=(()=>{class t{constructor(e,i){this.ngZone=e,this.elementRef=i,this.isDisable=!1,this.boundsSelector="body",this.handleSelector="",this.unhandleSelector="input,textarea,button,select,option,span,label,li",this.stackSelector="",this.opacity=.7,this.allowOverHalf=!1,this.onstart=new ei,this.onmove=new ei,this.onend=new ei,this.callbackOnResize=this.adjustPosition.bind(this),this.input=null,this.startPosition={x:0,y:0,z:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={x:0,y:0,z:0}}ngAfterViewInit(){this.initialize(),this.adjustPosition(),this.setForeground()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.input=new Bc(this.elementRef.nativeElement),window.addEventListener("resize",this.callbackOnResize,!1)}),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this)}cancel(){this.input.cancel()}destroy(){window.removeEventListener("resize",this.callbackOnResize,!1),this.input.destroy()}onInputStart(e){if(this.isDisable)return this.cancel();if(1===e.button||2===e.button)return this.cancel();this.setForeground(),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=this.input.pointer,this.prevTrans={x:0,y:0,z:0};let i=this.isHandleElement(e.target),r=this.isUnhandleElement(e.target),o=null!=e.touches&&this.isScrollableElement(e.target);!i||r||o?this.cancel():(this.elementRef.nativeElement.style.cursor="grabbing",e.stopPropagation())}onInputMove(e){let i={x:this.input.pointer.x-this.startPointer.x,y:this.input.pointer.y-this.startPointer.y,z:this.input.pointer.z-this.startPointer.z},o=this.calcCorrectionPosition({x:i.x-this.prevTrans.x,y:i.y-this.prevTrans.y,z:i.z-this.prevTrans.z});i.x+=o.x,i.y+=o.y,i.z+=o.z,0<Hi.sqrMagnitude(i)&&(this.elementRef.nativeElement.style.opacity=this.opacity+""),this.elementRef.nativeElement.style.willChange="top, left",this.elementRef.nativeElement.style.left=i.x+this.startPosition.x+"px",this.elementRef.nativeElement.style.top=i.y+this.startPosition.y+"px",this.elementRef.nativeElement.style.cursor="grabbing",this.prevTrans=i,e.cancelable&&e.preventDefault(),e.stopPropagation()}onInputEnd(e){this.elementRef.nativeElement.style.opacity=null,this.elementRef.nativeElement.style.cursor=null,this.elementRef.nativeElement.style.willChange=null,this.input.isDragging&&e.cancelable&&(this.preventClickIfNeeded(e),e.preventDefault()),e.stopPropagation()}onContextMenu(e){e.stopPropagation()}preventClickIfNeeded(e){if(null!=e.touches)return;if(225>Hi.sqrMagnitude(this.input.pointer,this.startPointer))return;let r=o=>{o.cancelable&&o.preventDefault(),o.stopPropagation()};this.elementRef.nativeElement.addEventListener("click",r,!0),queueMicrotask(()=>this.elementRef.nativeElement.removeEventListener("click",r,!0))}adjustPosition(){let e=this.calcElementPosition(this.elementRef.nativeElement),i=this.calcCorrectionPosition();this.elementRef.nativeElement.style.left=i.x+e.x+"px",this.elementRef.nativeElement.style.top=i.y+e.y+"px"}isHandleElement(e){return this.handleSelector.length<1||this.isContainsElement(e,this.handleSelector)}isUnhandleElement(e){return!(this.unhandleSelector.length<1)&&this.isContainsElement(e,this.unhandleSelector)}isContainsElement(e,i){let r=this.elementRef.nativeElement.querySelectorAll(i);for(let o=0;o<r.length;o++)if(r[o].contains(e))return!0;return!1}isScrollableElement(e){let i=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector),r=e,o=["scroll","auto"],s=["fixed","sticky","-webkit-sticky"];for(;r&&i!==r&&this.elementRef.nativeElement!==r;){let a=window.getComputedStyle(r);if(0<=o.indexOf(a.overflowY)&&r.offsetHeight<r.scrollHeight)return!0;if(0<=s.indexOf(a.position))return!1;r=r.parentElement}return!1}calcCorrectionPosition(e={x:0,y:0,z:0}){let i={x:0,y:0,z:0},r=this.elementRef.nativeElement.getBoundingClientRect(),o=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();if(this.allowOverHalf){const s=r.right-r.left,a=r.bottom-r.top;o.right+s/2<r.right+e.x&&(i.x+=o.right+s/2-(r.right+e.x)),r.left+e.x<o.left-s/2&&(i.x+=o.left-s/2-(r.left+e.x)),o.bottom+a/2<r.bottom+e.y&&(i.y+=o.bottom+a/2-(r.bottom+e.y)),r.top+e.y<o.top-a/2&&(i.y+=o.top-a/2-(r.top+e.y))}else o.right<r.right+e.x&&(i.x+=o.right-(r.right+e.x)),r.left+e.x<o.left&&(i.x+=o.left-(r.left+e.x)),o.bottom<r.bottom+e.y&&(i.y+=o.bottom-(r.bottom+e.y)),r.top+e.y<o.top&&(i.y+=o.top-(r.top+e.y));return i}calcElementPosition(e){let i=window.getComputedStyle(e);return{x:_o.relation(i.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),y:_o.relation(i.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),z:0}}setForeground(){if(this.stackSelector.length<1)return;let e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),i=0,r=99999;e.forEach(o=>{let s=parseInt(o.style.zIndex);i<s&&(i=s),s<r&&(r=s)}),!(i<=parseInt(this.elementRef.nativeElement.style.zIndex))&&(e.forEach(o=>{o.style.zIndex=parseInt(o.style.zIndex)-r+""}),this.elementRef.nativeElement.style.zIndex=i+1+"")}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Pn),Y(fr))};static#t=this.\u0275dir=Sn({type:t,selectors:[["","appDraggable",""]],inputs:{isDisable:[Ce.None,"draggable.disable","isDisable"],boundsSelector:[Ce.None,"draggable.bounds","boundsSelector"],handleSelector:[Ce.None,"draggable.handle","handleSelector"],unhandleSelector:[Ce.None,"draggable.unhandle","unhandleSelector"],stackSelector:[Ce.None,"draggable.stack","stackSelector"],opacity:[Ce.None,"draggable.opacity","opacity"],allowOverHalf:[Ce.None,"draggable.allowOverHalf","allowOverHalf"]},outputs:{onstart:"draggable.start",onmove:"draggable.move",onend:"draggable.end"}})}return t})(),cr=(()=>{class t{constructor(e){this._sanitizer=e}transform(e,i="html"){switch(i){case"html":return this._sanitizer.bypassSecurityTrustHtml(e);case"style":return this._sanitizer.bypassSecurityTrustStyle(e);case"script":return this._sanitizer.bypassSecurityTrustScript(e);case"url":return this._sanitizer.bypassSecurityTrustUrl(e);case"resourceUrl":return this._sanitizer.bypassSecurityTrustResourceUrl(e);default:throw new Error(`Invalid safe type specified: ${i}`)}}static#e=this.\u0275fac=function(i){return new(i||t)(Y(QA,16))};static#t=this.\u0275pipe=$o({name:"safe",type:t,pure:!0})}return t})();const Uq=["cutInImageElement"],zq=["videoPlayerComponent"],db=(t,n,e,i,r,o,s)=>({video:t,test:n,secret:e,minimaize:i,"is-bordered":r,"is-grab":o,"is-grabbing":s}),mC=t=>({transform:t}),Hq=(t,n,e,i)=>({autoplay:1,controls:0,start:t,loop:n,playsinline:1,rel:0,listType:"player",list:e,playlist:i,disablekb:1,fs:0,iv_load_policy:3,modestbranding:1});function Vq(t,n){1&t&&ii(0)}function jq(t,n){if(1&t){const e=Le();p(0,"div",5,1),he("@cutInNone.done",function(){V(e);const r=v();return H(r.isVisible?null:r.end())})("dblclick",function(){return V(e),H(v().stop())})("mousedown",function(){return V(e),H(v().draggstart())})("mouseup",function(){return V(e),H(v().draggend())})("mouseleave",function(){return V(e),H(v().draggend())})("mouseout",function(){return V(e),H(v().draggend())})("mousemove",function(){V(e);const r=v();return H(!!r.isPointerDragging&&r.draggstart())}),q(2,Vq,1,0,"ng-container",6),g()}if(2&t){const e=v(),i=pn(6);je("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible&&!e.videoId?"auto":"none"),m("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInNone",void 0)("ngClass",Eg(17,db,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),h(2),m("ngTemplateOutlet",i)}}function Gq(t,n){1&t&&ii(0)}function Wq(t,n){if(1&t){const e=Le();p(0,"div",5,1),he("@cutInFadeInOut.done",function(){V(e);const r=v();return H(r.isVisible?null:r.end())})("dblclick",function(){return V(e),H(v().stop())})("mousedown",function(){return V(e),H(v().draggstart())})("mouseup",function(){return V(e),H(v().draggend())})("mouseleave",function(){return V(e),H(v().draggend())})("mouseout",function(){return V(e),H(v().draggend())})("mousemove",function(){V(e);const r=v();return H(!!r.isPointerDragging&&r.draggstart())}),q(2,Gq,1,0,"ng-container",6),g()}if(2&t){const e=v(),i=pn(6);je("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible&&!e.videoId?"auto":"none"),m("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInFadeInOut",void 0)("ngClass",Eg(17,db,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),h(2),m("ngTemplateOutlet",i)}}function $q(t,n){1&t&&ii(0)}function Yq(t,n){if(1&t){const e=Le();p(0,"div",5,1),he("@cutInBounceInOut.done",function(){V(e);const r=v();return H(r.isVisible?null:r.end())})("dblclick",function(){return V(e),H(v().stop())})("mousedown",function(){return V(e),H(v().draggstart())})("mouseup",function(){return V(e),H(v().draggend())})("mouseleave",function(){return V(e),H(v().draggend())})("mouseout",function(){return V(e),H(v().draggend())})("mousemove",function(){V(e);const r=v();return H(!!r.isPointerDragging&&r.draggstart())}),q(2,$q,1,0,"ng-container",6),g()}if(2&t){const e=v(),i=pn(6);je("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible?"auto":"none"),m("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInBounceInOut",void 0)("ngClass",Eg(17,db,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),h(2),m("ngTemplateOutlet",i)}}function Zq(t,n){1&t&&ii(0)}function qq(t,n){if(1&t){const e=Le();p(0,"div",5,1),he("@cutInOpenInOut.done",function(){V(e);const r=v();return H(r.isVisible?null:r.end())})("dblclick",function(){return V(e),H(v().stop())})("mousedown",function(){return V(e),H(v().draggstart())})("mouseup",function(){return V(e),H(v().draggend())})("mouseleave",function(){return V(e),H(v().draggend())})("mouseout",function(){return V(e),H(v().draggend())})("mousemove",function(){V(e);const r=v();return H(!!r.isPointerDragging&&r.draggstart())}),q(2,Zq,1,0,"ng-container",6),g()}if(2&t){const e=v(),i=pn(6);je("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible?"auto":"none"),m("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInOpenInOut",void 0)("ngClass",Eg(17,db,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),h(2),m("ngTemplateOutlet",i)}}function Xq(t,n){1&t&&ii(0)}function Kq(t,n){if(1&t){const e=Le();p(0,"div",5,1),he("@cutInOpenInOut2.done",function(){V(e);const r=v();return H(r.isVisible?null:r.end())})("dblclick",function(){return V(e),H(v().stop())})("mousedown",function(){return V(e),H(v().draggstart())})("mouseup",function(){return V(e),H(v().draggend())})("mouseleave",function(){return V(e),H(v().draggend())})("mouseout",function(){return V(e),H(v().draggend())})("mousemove",function(){V(e);const r=v();return H(!!r.isPointerDragging&&r.draggstart())}),q(2,Xq,1,0,"ng-container",6),g()}if(2&t){const e=v(),i=pn(6);je("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible?"auto":"none"),m("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInOpenInOut2",void 0)("ngClass",Eg(17,db,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),h(2),m("ngTemplateOutlet",i)}}function Qq(t,n){1&t&&(p(0,"div",23),y(1,"TEST"),g())}function Jq(t,n){1&t&&(p(0,"div",24),y(1,"TEST"),g())}function eX(t,n){1&t&&(p(0,"div",25),y(1,"TEST"),g())}function tX(t,n){1&t&&(p(0,"div",26),y(1,"TEST"),g())}function nX(t,n){1&t&&(p(0,"div",27)(1,"i",28),y(2,"visibility"),g(),y(3," For Your Eyes Only"),g())}function iX(t,n){1&t&&(p(0,"div",29),y(1,"For Your Eyes Only "),p(2,"i",28),y(3,"visibility"),g()())}function rX(t,n){if(1&t&&(p(0,"div",30)(1,"span")(2,"span",31),y(3),g()()()),2&t){const e=v(2);h(),je("color",e.senderColor),h(),je("width",e.pixcelWidth-(e.isBordered?6:0),"px"),h(),Bd("",e.senderName,"",e.isMine?"\uff08\u3042\u306a\u305f\uff09":"","")}}function oX(t,n){if(1&t&&(p(0,"div",32)(1,"span")(2,"span",31),y(3),g()()()),2&t){const e=v(2);h(),je("color",e.senderColor),h(),je("width",e.pixcelWidth-(e.isBordered?6:0),"px"),h(),Bd("",e.senderName,"",e.isMine?"\uff08\u3042\u306a\u305f\uff09":"","")}}function sX(t,n){if(1&t){const e=Le();p(0,"div",33),he("contextmenu",function(r){return V(e),H(v(2).onContextMenu(r))}),g()}if(2&t){const e=v(2);je("width",e.pixcelWidth,"px")("height",e.pixcelHeight,"px")}}function aX(t,n){if(1&t){const e=Le();p(0,"youtube-player",34,2),he("ready",function(r){return V(e),H(v(2).onPlayerReady(r))})("stateChange",function(r){return V(e),H(v(2).onPlayerStateChange(r))}),g()}if(2&t){const e=v(2);je("visibility",e.videoId&&!e.isSoundOnly?"visible":"hidden"),m("videoId",e.videoId)("width",e.pixcelWidth-(e.isBordered?6:0))("height",e.pixcelHeight-(e.isBordered?6:0))("playerVars",Ja(6,Hq,e.videoStart,e.cutIn&&e.cutIn.isLoop?1:0,e.playListId?e.playListId:null,e.playListId?null:e.videoId))}}function lX(t,n){if(1&t){const e=Le();p(0,"img",35,3),he("error",function(){return V(e),H(v(2).onErrorFallback())}),g()}if(2&t){const e=v(2);je("object-fit",e.objectFit),m("src","https://img.youtube.com/vi/"+e.videoId+"/hqdefault.jpg",bn)}}function cX(t,n){if(1&t){const e=Le();p(0,"img",36,3),Ut(2,"safe"),he("load",function(){return V(e),H(v(2).onImageLoad())})("contextmenu",function(r){return V(e),H(v(2).onContextMenu(r))}),g()}if(2&t){const e=v(2);je("object-fit",e.objectFit),m("src",zt(2,3,e.cutInImgageUrl,"resourceUrl"),bn)}}function uX(t,n){if(1&t){const e=Le();q(0,Qq,2,0,"div",7)(1,Jq,2,0,"div",8)(2,eX,2,0,"div",9)(3,tX,2,0,"div",10)(4,nX,4,0,"div",11)(5,iX,4,0,"div",12)(6,rX,4,6,"div",13)(7,oX,4,6,"div",14),p(8,"div",15),he("contextmenu",function(r){return V(e),H(v().onContextMenu(r))}),g(),p(9,"div",16),he("contextmenu",function(r){return V(e),H(v().onContextMenu(r))}),g(),p(10,"div",17),he("contextmenu",function(r){return V(e),H(v().onContextMenu(r))}),g(),p(11,"div",18),he("contextmenu",function(r){return V(e),H(v().onContextMenu(r))}),g(),q(12,sX,1,4,"div",19)(13,aX,2,11,"youtube-player",20)(14,lX,2,3,"img",21)(15,cX,3,6,"img",22)}if(2&t){const e=v();m("ngIf",e.isTest),h(),m("ngIf",e.isTest),h(),m("ngIf",e.isTest),h(),m("ngIf",e.isTest),h(),m("ngIf",e.isSecret),h(),m("ngIf",e.isSecret),h(),m("ngIf",e.isIndicateSender),h(),m("ngIf",e.isIndicateSender),h(),je("width",e.pixcelWidth+3,"px")("height",19,"px"),m("ngStyle",Ke(32,mC,"translateX(-"+(e.isBordered?6:3)+"px) translateY(-"+(e.isBordered?6:3)+"px)")),h(),je("width",e.pixcelWidth+3,"px")("height",19,"px"),m("ngStyle",Ke(34,mC,"translateX("+(e.isBordered?6:3)+"px) translateY("+(e.isBordered?6:3)+"px)")),h(),je("width",19,"px")("height",e.pixcelHeight+3,"px"),m("ngStyle",Ke(36,mC,"translateX(-"+(e.isBordered?6:3)+"px) translateY(-"+(e.isBordered?6:3)+"px)")),h(),je("width",19,"px")("height",e.pixcelHeight+3,"px"),m("ngStyle",Ke(38,mC,"translateX("+(e.isBordered?6:3)+"px) translateY("+(e.isBordered?6:3)+"px)")),h(),m("ngIf",!e.videoId),h(),m("ngIf",e.videoId),h(),m("ngIf",e.videoId&&!e.isSoundOnly),h(),m("ngIf",!e.videoId||e.isSoundOnly)}}let BR=(()=>{class t{static#e=this.MIN_SIZE=250;get naturalWidth(){return this.videoId&&!this.isSoundOnly?480:this._naturalWidth}get naturalHeight(){return this.videoId&&!this.isSoundOnly?270:this._naturalHeight}constructor(e,i,r){this.pointerDeviceService=e,this.contextMenuService=i,this.ngZone=r,this.animationType=0,this._imageFile=vn.Empty,this._isVisible=!1,this._isEnd=!1,this.videoStateTransition=!1,this.isMinimize=!1,this.isBackyard=!1,this.isSecret=!1,this.isTest=!1,this.isIndicateSender=!1,this.sender="",this.videoId="",this.playListId="",this.cutInImageTransformOrigin="center",this._naturalWidth=0,this._naturalHeight=0,this._dragging=!1,this.audioPlayer=new Je,this._cutInImgageUrl=""}ngOnInit(){ne.register(this).on("CHANGE_JUKEBOX_VOLUME",-100,e=>{this.videoPlayer&&this.videoPlayer.setVolume(this.videoVolume)}).on("PLAY_VIDEO_CUT_IN",-1e3,e=>{this.cutIn&&this.cutIn.identifier!=e.data.identifier&&this.videoId&&this.stop()}),this._cutInImgageUrl=this.cutInImage.state!==Ri.COMPLETE||this._cutInImgageUrl?this.cutInImage.url:URL.createObjectURL(this.cutInImage.blob)}ngOnDestroy(){ne.unregister(this,"UPDATE_AUDIO_RESOURE"),ne.unregister(this,"CHANGE_JUKEBOX_VOLUME"),ne.unregister(this,"PLAY_VIDEO_CUT_IN"),clearTimeout(this._timeoutId),clearTimeout(this._timeoutIdVideo),this._cutInImgageUrl&&URL.revokeObjectURL(this._cutInImgageUrl)}get isPointerDragging(){return this._dragging}draggstart(){this.ngZone.run(()=>{this._dragging=!0})}draggend(){this.ngZone.run(()=>{this._dragging=!1})}get isVisible(){return this.cutIn&&this._isVisible}set isVisible(e){this._isVisible=e}get isEnd(){return!this.cutIn||this._isEnd}get cutInImage(){if(!this.cutIn)return this._imageFile;if(this._imageFile.identifier!==this.cutIn.imageIdentifier){let e=on.instance.get(this.cutIn.imageIdentifier);this._imageFile=e||vn.Empty}return this._imageFile}get pixcelWidthPreAdjust(){if(this.isMinimize)return t.MIN_SIZE;let e=0;return this.cutIn&&(e=this.cutIn.width<=0&&this.cutIn.height<=0?this.naturalWidth:this.cutIn.width<=0?document.documentElement.offsetHeight*this.cutIn.height*(this.naturalWidth/this.naturalHeight)/100:document.documentElement.clientWidth*this.cutIn.width/100),e}get pixcelWidth(){let e=this.pixcelWidthPreAdjust;return(this.cutIn.isPreventOutBounds||this.videoId)&&(this.isAjustAspect?this.isAjustAspectWidth?e=document.documentElement.clientWidth:e*=document.documentElement.offsetHeight/this.pixcelHeightPreAdjust:e>document.documentElement.clientWidth&&(e=document.documentElement.clientWidth)),!this.isMinimize&&(this.cutIn.width<=0||this.cutIn.height<=0)&&this.pixelWidthAspectMinimun>e?e=this.pixelWidthAspectMinimun:e<t.MIN_SIZE&&(e=t.MIN_SIZE),e}get pixcelHeightPreAdjust(){if(this.isMinimize)return t.MIN_SIZE;let e=0;return this.cutIn&&(e=this.cutIn.width<=0&&this.cutIn.height<=0?this.naturalHeight:this.cutIn.height<=0?document.documentElement.clientWidth*this.cutIn.width*(this.naturalHeight/this.naturalWidth)/100:document.documentElement.offsetHeight*this.cutIn.height/100),e}get pixelWidthAspectMinimun(){let e=t.MIN_SIZE;return this.cutIn&&this.naturalWidth>this.naturalHeight&&(e=t.MIN_SIZE*this.naturalWidth/this.naturalHeight),e}get pixcelHeight(){let e=this.pixcelHeightPreAdjust;return(this.cutIn.isPreventOutBounds||this.videoId)&&(this.isAjustAspect?this.isAjustAspectWidth?e*=document.documentElement.offsetWidth/this.pixcelWidthPreAdjust:e=document.documentElement.offsetHeight:e>document.documentElement.offsetHeight&&(e=document.documentElement.offsetHeight)),!this.isMinimize&&(this.cutIn.width<=0||this.cutIn.height<=0)&&this.pixelHeightAspectMinimun>e?e=this.pixelHeightAspectMinimun:e<t.MIN_SIZE&&(e=t.MIN_SIZE),e}get pixelHeightAspectMinimun(){let e=t.MIN_SIZE;return this.cutIn&&this.naturalWidth<this.naturalHeight&&(e=t.MIN_SIZE*this.naturalHeight/this.naturalWidth),e}get isAjustAspect(){return(this.cutIn.width<=0||this.cutIn.height<=0)&&(this.pixcelWidthPreAdjust>document.documentElement.clientWidth||this.pixcelHeightPreAdjust>document.documentElement.offsetHeight)}get isAjustAspectWidth(){const e=this.pixcelWidthPreAdjust;return e>document.documentElement.clientWidth?!(document.documentElement.offsetHeight<this.pixcelHeightPreAdjust*(document.documentElement.clientWidth/e)):(document,!1)}get pixcelPosX(){let e=0;if(!this.cutIn)return e;if(e=document.documentElement.clientWidth*this.cutIn.posX/100-this.pixcelWidth/2,this.cutIn.isPreventOutBounds||this.videoId){const i=this.pixcelWidth/2-document.documentElement.clientWidth*this.cutIn.posX/100;i>0&&(e+=i);const r=-(document.documentElement.clientWidth-document.documentElement.clientWidth*this.cutIn.posX/100-this.pixcelWidth/2);r>0&&(e-=r)}return e}get pixcelPosY(){let e=0;if(!this.cutIn)return e;if(e=document.documentElement.offsetHeight*this.cutIn.posY/100-this.pixcelHeight/2,this.cutIn.isPreventOutBounds||this.videoId){const i=this.pixcelHeight/2-document.documentElement.offsetHeight*this.cutIn.posY/100;i>0&&(e+=i);const r=-(document.documentElement.offsetHeight-document.documentElement.offsetHeight*this.cutIn.posY/100-this.pixcelHeight/2);r>0&&(e-=r)}return e}get zIndex(){return!this.cutIn||this.isBackyard?0:(this.cutIn.isFrontOfStand||this.videoId?15e5:5e5)+this.cutIn.zIndex+(this.videoId?1e3:0)}get objectFit(){return this.cutIn?this.isMinimize||this.videoId&&!this.isSoundOnly||2==this.cutIn.objectFitType?"contain":1==this.cutIn.objectFitType?"cover":"fill":"none"}get videoVolume(){return this.isTest?Je.isAuditionMute?0:100*Je.auditionVolume:Je.isMute?0:100*Je.volume}get isBordered(){return this.cutIn&&this.cutIn.borderStyle>0}get isSoundOnly(){return this.cutIn&&this.cutIn.isSoundOnly}get senderName(){let e="";if(!this.sender)return e;let i=Fe.findByPeerId(this.sender);return i instanceof Fe&&(e=i.name),e}get isMine(){return this.sender===Fe.myCursor.peerId}get senderColor(){let e=Fe.CHAT_DEFAULT_COLOR;if(!this.sender)return e;let i=Fe.findByPeerId(this.sender);return i instanceof Fe&&(e=i.color),e}get cutInImgageUrl(){return this._cutInImgageUrl}get videoStart(){return parseInt(this.cutIn.videoStart)}play(){this.isEnd||(this._isVisible?this.cutIn.videoId||this.audioPlayer.play():(this.ngZone.run(()=>{this._isVisible=!0,this.cutIn.videoId||this._play()}),this.cutIn.duration>0&&(this._timeoutId=setTimeout(()=>{this.stop(),clearTimeout(this._timeoutId),this._timeoutId=null},1e3*(this.cutIn.videoId?12:this.cutIn.duration)))))}_play(){if(this.isEnd)return;const e=un.instance.get(this.cutIn.audioIdentifier);e&&e.isReady?(this.audioPlayer.volumeType=this.isTest?ec.AUDITION:ec.MASTER,this.audioPlayer.loop=this.cutIn.isLoop,this.cutIn.videoId||this.audioPlayer.play(e)):ne.register(this).on("UPDATE_AUDIO_RESOURE",-100,i=>{this.cutIn.videoId||this._play()})}pause(){this.cutIn.videoId||this.audioPlayer.pause()}stop(){ne.unregister(this,"UPDATE_AUDIO_RESOURE"),this.ngZone.run(()=>{this._isVisible=!1,this._dragging=!1,this.audioPlayer.stop()})}end(){this._isEnd=!0,this.audioPlayer.stop()}onImageLoad(){this._naturalWidth=this.cutInImageElement.nativeElement.naturalWidth,this._naturalHeight=this.cutInImageElement.nativeElement.naturalHeight}onPlayerReady(e){this.videoPlayer&&this.videoPlayer.setVolume(this.videoVolume),e.target.playVideo()}onPlayerStateChange(e){const i=e.data;if(1==i){if(this.videoPlayer&&this.videoPlayer.setVolume(this.videoVolume),this.videoStateTransition=!0,this._timeoutIdVideo=setTimeout(()=>{this.ngZone.run(()=>{this.videoStateTransition=!1,this._timeoutIdVideo=null})},200),this.cutIn.duration>0){clearTimeout(this._timeoutId);const r=this.cutIn.duration-this.videoPlayer.getCurrentTime()+(this.cutIn.videoStart?parseInt(this.cutIn.videoStart):0);r<=0?this.stop():this._timeoutId=setTimeout(()=>{this.stop(),clearTimeout(this._timeoutId),this._timeoutId=null},1e3*(this.cutIn.duration>r?r:this.cutIn.duration))}this.cutIn&&ne.trigger("PLAY_VIDEO_CUT_IN",{identifier:this.cutIn.identifier})}2==i&&(this.videoStateTransition=!0,this._timeoutIdVideo=setTimeout(()=>{this.ngZone.run(()=>{this.videoStateTransition=!1,this._timeoutIdVideo=null})},200)),5==i&&(this.videoStateTransition=!0,this._timeoutIdVideo=setTimeout(()=>{this.ngZone.run(()=>{this.videoStateTransition=!1,this._timeoutIdVideo=null})},200))}onErrorFallback(){console.log("fallback"),this.videoId&&(this.cutInImageElement.nativeElement.src="https://img.youtube.com/vi/"+this.videoId+"/default.jpg")}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:"\u9589\u3058\u308b\uff08\u81ea\u5206\u306e\u307f\u505c\u6b62\uff09",action:()=>{this.stop()},default:!0,selfOnly:!0},Zt,{name:(this.isIndicateSender?"\u2611":"\u2610")+"\u9001\u4fe1\u8005\u3092\u8868\u793a",action:()=>{this.isIndicateSender=!this.isIndicateSender},selfOnly:!0,checkBox:"check"},{name:(this.isBackyard?"\u2611":"\u2610")+"\u30a6\u30a3\u30f3\u30c9\u30a6\u306e\u80cc\u5f8c\u306b\u8868\u793a",action:()=>{this.isBackyard=!this.isBackyard},selfOnly:!0,checkBox:"check"},{name:(this.isMinimize?"\u2611":"\u2610")+"\u6700\u5c0f\u5316",action:()=>{this.isMinimize=!this.isMinimize},selfOnly:!0,checkBox:"check"}],this.cutIn.name)}static#t=this.\u0275fac=function(i){return new(i||t)(Y(lr),Y(Bo),Y(Pn))};static#n=this.\u0275cmp=In({type:t,selectors:[["cut-in"]],viewQuery:function(i,r){if(1&i&&(Ln(Uq,5),Ln(zq,5)),2&i){let o;Bn(o=Un())&&(r.cutInImageElement=o.first),Bn(o=Un())&&(r.videoPlayer=o.first)}},hostBindings:function(i,r){1&i&&he("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{cutIn:"cutIn",animationType:"animationType"},decls:7,vars:5,consts:[["image",""],["cutInContainerElement",""],["videoPlayerComponent",""],["cutInImageElement",""],["appDraggable","","class","container","style","position: absolute",3,"draggable.allowOverHalf","draggable.unhandle","width","height","left","top","z-index","pointer-events","ngClass","dblclick","mousedown","mouseup","mouseleave","mouseout","mousemove",4,"ngIf"],["appDraggable","",1,"container",2,"position","absolute",3,"dblclick","mousedown","mouseup","mouseleave","mouseout","mousemove","draggable.allowOverHalf","draggable.unhandle","ngClass"],[4,"ngTemplateOutlet"],["class","test-indicator grow left-top",4,"ngIf"],["class","test-indicator grow right-top",4,"ngIf"],["class","test-indicator grow left-bottom",4,"ngIf"],["class","test-indicator grow right-bottom",4,"ngIf"],["class","secret-indicator grow left-top",4,"ngIf"],["class","secret-indicator grow right-bottom","style","text-align: right",4,"ngIf"],["class","name-indicator grow right-top","style","text-align: right",4,"ngIf"],["class","name-indicator grow left-bottom",4,"ngIf"],[1,"handler","top",3,"contextmenu","ngStyle"],[1,"handler","bottom",3,"contextmenu","ngStyle"],[1,"handler","left",3,"contextmenu","ngStyle"],[1,"handler","right",3,"contextmenu","ngStyle"],["style","pointer-events: auto","class","handler",3,"width","height","contextmenu",4,"ngIf"],["style","position: absolute; pointer-events: auto","suggestedQuality","default",3,"visibility","videoId","width","height","playerVars","ready","stateChange",4,"ngIf"],["style","pointer-events: auto","draggable","false",3,"object-fit","src","error",4,"ngIf"],["style","pointer-events: none","draggable","false",3,"object-fit","src","load","contextmenu",4,"ngIf"],[1,"test-indicator","grow","left-top"],[1,"test-indicator","grow","right-top"],[1,"test-indicator","grow","left-bottom"],[1,"test-indicator","grow","right-bottom"],[1,"secret-indicator","grow","left-top"],[1,"material-icons",2,"font-size","smaller"],[1,"secret-indicator","grow","right-bottom",2,"text-align","right"],[1,"name-indicator","grow","right-top",2,"text-align","right"],[2,"display","inline-block","white-space","nowrap","overflow","hidden","text-overflow","ellipsis"],[1,"name-indicator","grow","left-bottom"],[1,"handler",2,"pointer-events","auto",3,"contextmenu"],["suggestedQuality","default",2,"position","absolute","pointer-events","auto",3,"ready","stateChange","videoId","width","height","playerVars"],["draggable","false",2,"pointer-events","auto",3,"error","src"],["draggable","false",2,"pointer-events","none",3,"load","contextmenu","src"]],template:function(i,r){1&i&&q(0,jq,3,25,"div",4)(1,Wq,3,25,"div",4)(2,Yq,3,25,"div",4)(3,qq,3,25,"div",4)(4,Kq,3,25,"div",4)(5,uX,16,40,"ng-template",null,0,Ai),2&i&&(m("ngIf",r.isVisible&&-1==r.animationType),h(),m("ngIf",r.isVisible&&0==r.animationType),h(),m("ngIf",r.isVisible&&1==r.animationType),h(),m("ngIf",r.isVisible&&2==r.animationType),h(),m("ngIf",r.isVisible&&3==r.animationType))},dependencies:[Ni,ri,uf,Lo,Rq,JT,cr],styles:[".container[_ngcontent-%COMP%]{margin:0;padding:0}.container.video[_ngcontent-%COMP%]{background-color:#000}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}img[_ngcontent-%COMP%]{margin:0;padding:0;width:100%;height:100%}.container[_ngcontent-%COMP%]:hover{outline:3px dotted #22F}.container.minimaize[_ngcontent-%COMP%]{outline:3px solid #22F}.container.is-bordered[_ngcontent-%COMP%]{border:3px ridge #dde}.container.is-bordered[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:1px solid black;box-sizing:border-box}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.test-indicator[_ngcontent-%COMP%]{position:absolute;pointer-events:none;z-index:5;color:#00f;font-size:smaller;padding:0 3px 1px;font-weight:bolder}.secret-indicator[_ngcontent-%COMP%]{position:absolute;pointer-events:none;z-index:5;color:gray;font-size:smaller;padding:0 3px 2px;font-weight:bolder;opacity:.6}.name-indicator[_ngcontent-%COMP%]{position:absolute;pointer-events:none;z-index:10;padding:0 3px 0 6px;font-weight:bolder;font-size:smaller}.left-top[_ngcontent-%COMP%]{left:0;top:0}.left-bottom[_ngcontent-%COMP%]{left:0;bottom:0}.right-top[_ngcontent-%COMP%]{right:0;top:0}.right-bottom[_ngcontent-%COMP%]{right:0;bottom:0}.handler[_ngcontent-%COMP%]{position:absolute;z-index:20;pointer-events:auto}.handler.top[_ngcontent-%COMP%]{top:0;left:0}.handler.bottom[_ngcontent-%COMP%]{bottom:0;right:0}.handler.left[_ngcontent-%COMP%]{top:0;left:0}.handler.right[_ngcontent-%COMP%]{right:0;bottom:0}"],data:{animation:[Xn("cutInNone",[an("void => *",[rn("10ms ease-in",En([We({opacity:0,offset:0}),We({opacity:1,offset:1})]))]),an("* => void",[rn("10ms ease-in",En([We({opacity:0,offset:1})]))])]),Xn("cutInFadeInOut",[an("void => *",[rn("330ms ease-in",En([We({opacity:0,offset:0}),We({opacity:1,offset:1})]))]),an("* => void",[rn("330ms ease-in",En([We({opacity:1,offset:0}),We({opacity:0,offset:1})]))])]),Xn("cutInBounceInOut",[an("void => *",[rn("600ms ease",En([We({transform:"scale3d(0, 0, 0)",offset:0}),We({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),We({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),We({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),We({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),an("* => void",[rn(100,We({transform:"scale3d(0, 0, 0)"}))])]),Xn("cutInOpenInOut",[an("void => *",[rn("262ms ease",En([We({opacity:0,transform:"scale3d(0, 1.0, 1.0)",offset:0}),We({opacity:1,transform:"scale3d(1.1, 1.0, 1.0)",offset:.875}),We({opacity:1,transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),an("* => void",[rn(100,We({opacity:0,transform:"scale3d(0, 1.0, 1.0)"}))])]),Xn("cutInOpenInOut2",[an("void => *",[rn("262ms ease",En([We({opacity:0,transform:"scale3d(1.0, 0, 1.0)",offset:0}),We({opacity:1,transform:"scale3d(1.0, 1.1, 1.0)",offset:.875}),We({opacity:1,transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),an("* => void",[rn(100,We({opacity:0,transform:"scale3d(1.0, 0, 1.0)"}))])])]}})}return t})(),_C=(()=>{class t{static#e=this.cutInComponentRefQueue=[];constructor(){}static nowShowingIdentifiers(){return t.cutInComponentRefQueue.filter(e=>e&&e.instance&&e.instance.cutIn&&e.instance.isVisible).map(e=>e.instance.cutIn.identifier)}play(e,i=!1,r=!1,o=null){if(!e)return;for(const a of t.cutInComponentRefQueue)if(a&&a.instance){const c=a.instance;if(c.isEnd)a.destroy();else{const u=c.cutIn;(e.identifier===u.identifier||e.videoId&&u.videoId||null!=e.tag&&""!=e.tag.trim()&&null!=u.tag&&""!=u.tag.trim()&&ke.toHalfWidth(e.tag).toUpperCase().trim()==ke.toHalfWidth(u.tag).toUpperCase().trim())&&c.stop()}}t.cutInComponentRefQueue=t.cutInComponentRefQueue.filter(a=>a&&a.instance);const s=t.defaultParentViewContainerRef.createComponent(BR);s.instance.cutIn=e,s.instance.animationType=e.animationType,s.instance.videoId=e.videoId,s.instance.playListId=e.playListId,s.instance.isSecret=i,s.instance.isTest=r,s.instance.sender=o,s.instance.play(),t.cutInComponentRefQueue.push(s)}stop(e){if(e){e instanceof Pr&&(e=e.identifier);for(const i of t.cutInComponentRefQueue)if(i&&i.instance){const r=i.instance;r.isEnd?i.destroy():e===r.cutIn.identifier&&r.stop()}t.cutInComponentRefQueue=t.cutInComponentRefQueue.filter(i=>i&&i.instance)}}static#t=this.\u0275fac=function(i){return new(i||t)};static#n=this.\u0275prov=nn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Pr=class extends xr{constructor(){super(...arguments),this.name="",this.tag="",this.duration=6,this.width=0,this.height=0,this.posX=50,this.posY=50,this.zIndex=0,this.objectFitType=0,this.animationType=0,this.borderStyle=0,this.isFrontOfStand=!1,this.isPreventOutBounds=!1,this.imageIdentifier=vn.Empty.identifier,this.isVideoCutIn=!1,this.videoUrl="",this.isSoundOnly=!1,this.audioFileName="",this.audioIdentifier="",this.isLoop=!1}get videoId(){if(!this.isVideoCutIn||!this.videoUrl)return"";let n="";if(!ke.validUrl(this.videoUrl))return"";{const e=new URL(this.videoUrl).hostname;if("youtube.com"==e||"www.youtube.com"==e){let i=this.videoUrl.split("v=");i[1]&&(n=encodeURI(i[1].split(/[\?\&\#\/]/)[0]))}else{if("youtu.be"!=e)return"";{let i=this.videoUrl.split("youtu.be/");i[1]&&(n=encodeURI(i[1].split(/[\?\&\#\/]/)[0]))}}}return n.replace(/[\<\>\/\:\s\r\n]/g,"")}get videoStart(){if(!this.isVideoCutIn||!this.videoUrl||!this.videoId)return null;const n=/[\&\?](?:start|t)\=([\dhms]+)/i.exec(this.videoUrl);return n&&n[1]?this._sec(n[1]):null}_sec(n){if(!n)return null;let e=null;if(e=/^(\d+)$/.exec(n))return e[1];if(e=/^(?:(\d+)h)?(?:(\d+)m)?(?:(\d+)s)?$/i.exec(n)){let i=0;return e[1]&&(i+=60*+e[1]*60),e[2]&&(i+=60*+e[2]),e[3]&&(i+=+e[3]),""+i}return null}get playListId(){if(!this.isVideoCutIn||!this.videoId)return"";let n="";if(!ke.validUrl(this.videoUrl))return"";{let e=this.videoUrl.split("list=");e[1]&&(n=encodeURI(e[1].split(/[\&\#\/]/)[0]))}return n.replace(/[\<\>\/\:\s\r\n]/g,"")}get isValidAudio(){return 0==this.audioFileName.length||0==this.audioIdentifier.length||!!un.instance.get(this.audioIdentifier)}get postfixes(){return null==this.value||""==(this.value+"").trim()?[]:Array.from(new Set(this.value.split(/[\r\n]+/g).map(n=>null!=n?n.trimRight():""))).filter(n=>""!=n)}get isPlayingNow(){return _C.nowShowingIdentifiers().includes(this.identifier)}};var Tl;He([ct()],Pr.prototype,"name",void 0),He([ct()],Pr.prototype,"tag",void 0),He([ct()],Pr.prototype,"duration",void 0),He([ct()],Pr.prototype,"width",void 0),He([ct()],Pr.prototype,"height",void 0),He([ct()],Pr.prototype,"posX",void 0),He([ct()],Pr.prototype,"posY",void 0),He([ct()],Pr.prototype,"zIndex",void 0),He([ct()],Pr.prototype,"objectFitType",void 0),He([ct()],Pr.prototype,"animationType",void 0),He([ct()],Pr.prototype,"borderStyle",void 0),He([ct()],Pr.prototype,"isFrontOfStand",void 0),He([ct()],Pr.prototype,"isPreventOutBounds",void 0),He([ct()],Pr.prototype,"imageIdentifier",void 0),He([ct()],Pr.prototype,"isVideoCutIn",void 0),He([ct()],Pr.prototype,"videoUrl",void 0),He([ct()],Pr.prototype,"audioFileName",void 0),He([ct()],Pr.prototype,"audioIdentifier",void 0),He([ct()],Pr.prototype,"isLoop",void 0),Pr=He([ir("cut-in")],Pr);let tc=class extends xr{static#e=Tl=this;static get instance(){return Tl._instance||(Tl._instance=new Tl("CutInList"),Tl._instance.initialize()),Tl._instance}get cutIns(){return this.children}addCutIn(...n){let e=null;if(n[0]instanceof Pr)e=n[0];else{let i=n[0];e=new Pr(n[1]),e.name=i,e.initialize()}return this.appendChild(e)}parseInnerXml(n){for(let i of Tl.instance.children)i.destroy();let e=Tl.instance.toContext();e.syncData=this.toContext().syncData,Tl.instance.apply(e),Tl.instance.update(),super.parseInnerXml.apply(Tl.instance,[n]),this.destroy()}matchCutInInfo(n){let e="",i=new Map;const r=[];for(const a of this.cutIns.map(c=>[Math.random(),c]).sort((c,u)=>c[0]-u[0]).map(c=>c[1])){if(!a)continue;let c=!1;for(const u of a.postfixes)ke.toHalfWidth(n.replaceAll("\uff1e","\u2192")).toUpperCase().trimRight().endsWith(ke.toHalfWidth(u.replaceAll("\uff1e","\u2192")).toUpperCase().trimRight())&&(c=!0,("@"==u.slice(0,1)||"\uff20"==u.slice(0,1))&&e.length<u.length&&(e=u));if(c){const u=a.tag;null!=u&&u.trim().length>0?i.set(ke.toHalfWidth(u).toUpperCase().trim(),a):r.push(a)}}r.push(...i.values());const s=r.map(a=>[Math.random(),a]).sort((a,c)=>a[0]-c[0]);return{names:s.map(a=>a[1].name),identifiers:s.map(a=>a[1].identifier),matchMostLongText:e}}};var pi;tc=Tl=He([ir("cut-in-list")],tc);let bC,dX=function hX(){let t=new AR("DiceBotQueue");return t.add((0,L.A)(function*(){bC=new((yield me.e(4402).then(me.bind(me,8914))).default),Zi.diceBotInfos=bC.listAvailableGameSystems().filter(i=>"DiceBot"!=i.id).sort((i,r)=>{const o=i.sortKey,s=r.sortKey;return o<s?-1:o>s?1:0}).map(i=>{const r=/.+\:(.+)/.exec(i.id);let o;return r&&r[1]&&(o="ChineseTraditional"==r[1]?"\u6b63\u9ad4\u4e2d\u6587":"Korean"==r[1]?"\ud55c\uad6d\uc5b4":"English"==r[1]?"English":"SimplifiedChinese"==r[1]?"\u7b80\u4f53\u4e2d\u6587":"Other"),{id:i.id,game:i.name,lang:o,sort_key:i.sortKey}}),Zi.diceBotInfos.forEach(i=>{let r=i.sort_key.normalize("NFKD");for(let o of Zi.replaceData)o[2]&&i.game===o[0]&&(r=o[1],i.game=o[2]),r=r.split(o[0].normalize("NFKD")).join(o[1].normalize("NFKD"));r=r.replace(/[\u3041-\u3096]/g,o=>String.fromCharCode(o.charCodeAt(0)+96)).replace(/\u7b2c(.+?)\u7248/g,"\u30bf\u30a4$1\u30cf\u30f3").replace(/[\u30fb!?\uff01\uff1f\s\u3000:\uff1a=\uff1d\/\uff0f\uff08\uff09\(\)]+/g,"").replace(/([\u30a2\u30ab\u30b5\u30bf\u30ca\u30cf\u30de\u30e4\u30e9\u30ef])\u30fc+/g,"$1\u30a2").replace(/([\u30a4\u30ad\u30b7\u30c1\u30cb\u30d2\u30df\u30ea])\u30fc+/g,"$1\u30a4").replace(/([\u30a6\u30af\u30b9\u30c4\u30cc\u30d5\u30e0\u30e6\u30eb])\u30fc+/g,"$1\u30a6").replace(/([\u30a8\u30b1\u30bb\u30c6\u30cd\u30d8\u30e1\u30ec])\u30fc+/g,"$1\u30a8").replace(/([\u30aa\u30b3\u30bd\u30c8\u30ce\u30db\u30e2\u30e8\u30ed])\u30fc+/g,"$1\u30aa").replace(/\u30f3+\u30fc+/g,"\u30f3").replace(/\u30f3+/g,"\u30f3"),i.sort_key=i.lang?i.lang:r.normalize("NFKD")}),Zi.diceBotInfos.sort((i,r)=>"Other"==i.sort_key&&"Other"==r.sort_key?0:"Other"==i.sort_key?1:"Other"==r.sort_key?-1:i.sort_key==r.sort_key?0:i.sort_key<r.sort_key?-1:1);let n=Zi.diceBotInfos[0].sort_key[0],e={index:n,infos:[]};for(let i of Zi.diceBotInfos)"Other"==i.lang&&(i.lang="\u7b80\u4f53\u4e2d\u6587"),(i.lang?i.lang:i.sort_key[0])!==n&&(n=i.lang?i.lang:i.sort_key[0],Zi.diceBotInfosIndexed.push(e),e={index:n,infos:[]}),e.infos.push({id:i.id,game:i.game});Zi.diceBotInfosIndexed.push(e),Zi.diceBotInfosIndexed.sort((i,r)=>i.index==r.index?0:i.index<r.index?-1:1)})),t}(),Zi=class extends eh{static#e=pi=this;static#t=this.apiUrl=null;static#n=this.apiVersion=2;static#i=this.adminUrl=null;static#r=this.diceBotInfos=[];static#o=this.diceBotInfosIndexed=[];static#s=this.replaceData=[["\u65b0\u30af\u30c8\u30a5\u30eb\u30d5","\u30b7\u30f3\u30af\u30c8\u30a6\u30eb\u30d5\u30b7\u30f3\u30efTRPG","\u65b0\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG"],["\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG","\u30af\u30c8\u30a6\u30eb\u30d5\u30b7\u30f3\u30efTRPG","(\u65e7) \u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG"],["\ud06c\ud234\ub8e8","\ud06c\ud234\ub8e8\uc758 \ubd80\ub984 6\ud310","\ud06c\ud234\ub8e8\uc758 \ubd80\ub984 6\ud310"],["\u514b\u8607\u9b6f\u795e\u8a71","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c\u516d\u7248","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c\u516d\u7248"],["\u514b\u8607\u9b6f\u795e\u8a71\u7b2c7\u7248","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c7\u7248","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c\u4e03\u7248"],["\u30c0\u30d6\u30eb\u30af\u30ed\u30b92nd,3rd","\u30bf\u30d5\u30eb\u30af\u30ed\u30b9 The 2nd Edition/The 3rd Edtion","\u30c0\u30d6\u30eb\u30af\u30ed\u30b9 The 2nd Edition, The 3rd Edtion"],["\ub354\ube14\ud06c\ub85c\uc2a42nd,3rd","\ub354\ube14\ud06c\ub85c\uc2a4 The 2nd Edition/The 3rd Edtion","\ub354\ube14\ud06c\ub85c\uc2a4 The 2nd Edition, The 3rd Edtion"],["\u30c8\u30fc\u30b0","\u30c8\u30aa\u30af","\u30c8\u30fc\u30b0\uff08TORG\uff09"],["\u30ef\u30fc\u30d7\u30b9","\u30ef\u30a2\u30d5\u30b9","WARPS"],["\u30c8\u30fc\u30b01.5\u7248","\u30c8\u30aa\u30af1.5\u30cf\u30f3","\u30c8\u30fc\u30b0\uff08TORG\uff09 1.5\u7248"],["\u30c8\u30fc\u30b0 \u30a8\u30bf\u30cb\u30c6\u30a3","\u30c8\u30aa\u30af\u30a8\u30bf\u30cb\u30c6\u30a4","\u30c8\u30fc\u30b0\uff08TORG\uff09 \u30a8\u30bf\u30cb\u30c6\u30a3"],["\u5fc3\u885d\u60f3\u6a5fTRPG\u30a2\u30eb\u30c8\u30ec\u30a4\u30ba","\u30b7\u30f3\u30b7\u30e8\u30a6\u30bd\u30a6\u30adTRPG\u30a2\u30eb\u30c8\u30ec\u30a4\u30b9","\u5fc3\u885d\u60f3\u6a5fTRPG \u30a2\u30eb\u30c8\u30ec\u30a4\u30ba"],["\u30d1\u30e9\u30b5\u30a4\u30c8\u30d6\u30e9\u30c3\u30c9RPG","\u30cf\u30e9\u30b5\u30a4\u30c8\u30d5\u30e9\u30c4\u30c8","\u30d1\u30e9\u30b5\u30a4\u30c8\u30d6\u30e9\u30c3\u30c9"],["\u72af\u7f6a\u6d3b\u5287RPG\u30d0\u30c3\u30c9\u30e9\u30a4\u30d5","\u30cf\u30f3\u30b5\u30a4\u30ab\u30c4\u30b1\u30adRPG\u30cf\u30c4\u30c8\u30e9\u30a4\u30d5","\u72af\u7f6a\u6d3b\u5287RPG\u30d0\u30c3\u30c9\u30e9\u30a4\u30d5"],["\u6643\u5929\u306e\u30a4\u30eb\u30fc\u30b8\u30aa","\u30b3\u30a6\u30c6\u30f3\u30ce\u30a4\u30eb\u30a6\u30b7\u30aa","\u6643\u5929\u306e\u30a4\u30eb\u30fc\u30b8\u30aa"],["\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb","\u30cf\u30af\u30eb\u30de\u30ce\u30c8\u30a6\u30ce\u30b9\u30ab\u30a4\u30ce\u30aa\u30c4","\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb"],["\u5728\u308a\u3066\u904d\u304f\u30aa\u30eb\u30ac\u30ec\u30a4\u30f3","\u30a2\u30ea\u30c6\u30a2\u30de\u30cd\u30af\u30aa\u30eb\u30ab\u30ec\u30a4\u30f3","\u5728\u308a\u3066\u904d\u304f\u30aa\u30eb\u30ac\u30ec\u30a4\u30f3"],["Pathfinder","\u30cf\u30b9\u30d5\u30a2\u30a4\u30f3\u30bf\u30a2RPG","\u30d1\u30b9\u30d5\u30a1\u30a4\u30f3\u30c0\u30fcRPG"],["\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG\u3000\u899a\u9192\u7de8","\u30b7\u30f3\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4TRPG\u30ab\u30af\u30bb\u30a4\u30d8\u30f3","\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG \u899a\u9192\u7bc7"],["\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG\u3000\u899a\u9192\u7bc7","\u30b7\u30f3\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4TRPG\u30ab\u30af\u30bb\u30a4\u30d8\u30f3","\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG \u899a\u9192\u7bc7"],["YearZeroEngine","\u30a4\u30e4\u30a2\u30bb\u30ed\u30a8\u30f3\u30b7\u30f3","Year Zero Engine"],["Year Zero Engine","\u30a4\u30e4\u30a2\u30bb\u30ed\u30a8\u30f3\u30b7\u30f3","Year Zero Engine"],["ADVANCED FIGHTING FANTASY 2nd Edition","\u30a2\u30c8\u30cf\u30f3\u30b9\u30c8\u30d5\u30a1\u30a4\u30c6\u30a4\u30f3\u30af\u30d5\u30a1\u30f3\u30bf\u30b7\u30a4\u30bf\u30a42\u30cf\u30f3","\u30a2\u30c9\u30d0\u30f3\u30b9\u30c8\u30fb\u30d5\u30a1\u30a4\u30c6\u30a3\u30f3\u30b0\u30fb\u30d5\u30a1\u30f3\u30bf\u30b8\u30fc \u7b2c2\u7248"],["\u30ef\u30fc\u30eb\u30c9\u30aa\u30d6\u30c0\u30fc\u30af\u30cd\u30b9","\u30ef\u30a2\u30eb\u30c8\u30aa\u30d5\u30bf\u30a2\u30af\u30cd\u30b9","\u30ef\u30fc\u30eb\u30c9\u30fb\u30aa\u30d6\u30fb\u30c0\u30fc\u30af\u30cd\u30b9"],["\u30e2\u30ce\u30c8\u30fc\u30f3\u30fb\u30df\u30e5\u30fc\u30b8\u30a2\u30e0","\u30e2\u30ce\u30c8\u30aa\u30f3\u30df\u30e6\u30a6\u30b7\u30a2\u30e0","\u30e2\u30ce\u30c8\u30fc\u30f3\u30df\u30e5\u30fc\u30b8\u30a2\u30e0"],["\u5263\u306e\u8857\u306e\u7570\u90a6\u4ebaTRPG","\u30c4\u30eb\u30ad\u30ce\u30de\u30c1\u30ce\u30a4\u30db\u30a6\u30b7\u30f3TRPG"],["\u58ca\u308c\u305f\u4e16\u754c\u306e\u30dd\u30b9\u30c8\u30de\u30f3","\u30b3\u30ef\u30ec\u30bf\u30bb\u30ab\u30a4\u30ce\u30db\u30b9\u30c8\u30de\u30f3","\u58ca\u308c\u305f\u4e16\u754c\u306e\u30dd\u30b9\u30c8\u30de\u30f3"],["\u7d2b\u7e1e\u306e\u30ea\u30f4\u30e9\u30c9\u30fc\u30eb","\u30b7\u30b7\u30de\u30ce\u30ea\u30d5\u30e9\u30c8\u30aa\u30eb","\u7d2b\u7e1e\u306e\u30ea\u30f4\u30e9\u30c9\u30fc\u30eb"],["SRS\u6c4e\u7528(\u6539\u9020\u7248)","\u30b9\u30bf\u30f3\u30bf\u30a2\u30c8RPG\u30b7\u30b9\u30c6\u30e0\u30aa\u30eb\u30bf\u30ca\u30c6\u30a4\u30d5\u30cf\u30f3","SRS\u6c4e\u7528 \u30aa\u30eb\u30bf\u30ca\u30c6\u30a3\u30f4"],["Standard RPG System","\u30b9\u30bf\u30f3\u30bf\u30a2\u30c8RPG\u30b7\u30b9\u30c6\u30e0","\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0\uff08SRS\uff09"],["\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0","\u30b9\u30bf\u30f3\u30bf\u30a2\u30c8RPG\u30b7\u30b9\u30c6\u30e0","\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0\uff08SRS\uff09"],["NJSLYRBATTLE","\u30cb\u30f3\u30b7\u30e4\u30b9\u30ec\u30a4\u30e4\u30a2\u30cf\u30c8\u30eb"],["Record of Steam","\u30ec\u30b3\u30aa\u30c8\u30aa\u30d5\u30b9\u30c1\u30a4\u30e0","\u30ec\u30b3\u30fc\u30c9\u30fb\u30aa\u30d6\u30fb\u30b9\u30c1\u30fc\u30e0"],["\u8a69\u7247\u306e\u30a2\u30eb\u30bb\u30c3\u30c8","\u30a6\u30bf\u30ab\u30bf\u30ce\u30a2\u30eb\u30bb\u30c4\u30c8"],["Shared\u2020Fantasia","\u30b7\u30a8\u30a2\u30a2\u30c8\u30d5\u30a2\u30f3\u30bf\u30b7\u30a2"],["\u771f\u30fb\u5973\u795e\u8ee2\u751f","\u30b7\u30f3\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4"],["\u5973\u795e\u8ee2\u751f","\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4"],["\u899a\u9192\u7bc7","\u30ab\u30af\u30bb\u30a4\u30d8\u30f3"],["Chill","\u30c1\u30eb"],["BBNTRPG","\u30d2\u30a4\u30d2\u30a4\u30a8\u30ccTRPG","BBNTRPG (\u30d6\u30e9\u30c3\u30af\u30fb\u30d6\u30e9\u30c3\u30af\u30fb\u30cd\u30c3\u30c8\u30ef\u30fc\u30afTRPG)"],["TORG Eternity","\u30c8\u30aa\u30af\u30a8\u30bf\u30a2\u30cb\u30c6\u30a4"],["\u30ac\u30fc\u30d7\u30b9","\u30ab\u30a2\u30d5\u30b9","\u30ac\u30fc\u30d7\u30b9\uff08GURPS\uff09"],["\u30ac\u30fc\u30d7\u30b9\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba","\u30ab\u30a2\u30d5\u30b9\u30d5\u30a4\u30eb\u30c8\u30a6\u30a4\u30b9","\u30ac\u30fc\u30d7\u30b9\uff08GURPS\uff09 \u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba"],["\u7d76\u5bfe\u96b7\u5974","\u30bb\u30c4\u30bf\u30a4\u30ec\u30a4\u30c8"],["\u30bb\u30e9\u30d5\u30a3\u30b6\u30a4\u30f3","\u30bb\u30a4\u30b7\u30e6\u30f3\u30b7\u30c4\u30ab\u30f3TRPG\u30bb\u30e9\u30d5\u30a4\u30b5\u30a4\u30f3","\u9752\u6625\u75be\u60a3TRPG \u30bb\u30e9\u30d5\u30a3\u30b6\u30a4\u30f3"],["RuneQuest\uff1aRoleplaying in Glorantha","\u30eb\u30a6\u30f3\u30af\u30a8\u30b9\u30c84","RuneQuest: Roleplaying in Glorantha"],["\u8266\u3053\u308c","\u30ab\u30f3\u30b3\u30ec"],["\u795e\u6211\u72e9","\u30ab\u30df\u30ab\u30ab\u30ea"],["\u9d7a\u93e1","\u30cc\u30a8\u30ab\u30ab\u30df"],["\u30c8\u30fc\u30ad\u30e7\u30fc","\u30c8\u30aa\u30ad\u30e8\u30a6"],["\uff2e\u25ce\uff36\uff21","\u30ce\u30a6\u30a2"],["\u521d\u97f3\u30df\u30af","\u30cf\u30c4\u30cd\u30df\u30af"],["\u6731\u306e\u5b64\u5854","\u30a2\u30b1\u30ce\u30b3\u30c8\u30a6"],["\u5728\u308a\u3066\u904d\u304f","\u30a2\u30ea\u30c6\u30a2\u30de\u30cd\u30af"],["\u592e\u83ef\u5c01\u795e","\u30aa\u30a6\u30ab\u30db\u30a6\u30b7\u30f3"],["\u5fc3\u885d\u60f3\u6a5f","\u30b7\u30f3\u30b7\u30e8\u30a6\u30bd\u30a6\u30ad"],["\u80ce\u3088\u308a\u60f3\u3048","\u30cf\u30e9\u30e8\u30ea\u30aa\u30e2\u30a8"],["\u5c55\u721b\u4f1a","\u30c6\u30f3\u30e9\u30f3\u30ab\u30a4"],["\u58ca\u308c\u305f","\u30b3\u30ef\u30ec\u30bf"],["\u6bd4\u53e1\u5c71","\u30d2\u30a8\u30a4\u30b5\u30f3"],["\u4e16\u754c\u6a39","\u30bb\u30ab\u30a4\u30b7\u30e6"],["\u7570\u90a6\u4eba","\u30a4\u30db\u30a6\u30b7\u30f3"],["\u8ee2\u653b\u751f","\u30c6\u30f3\u30b3\u30a6\u30bb\u30a4"],["\u63a2\u7a7a\u58eb","\u30b9\u30ab\u30a4\u30ce\u30aa\u30c4"],["\u5263\u306e\u8857","\u30c4\u30eb\u30ad\u30ce\u30de\u30c1"],["\u9ed2\u7d62","\u30b3\u30c4\u30b1\u30f3"],["\u7d2b\u7e1e","\u30b7\u30b7\u30de"],["\u7834\u754c","\u30cf\u30ab\u30a4"],["\u9280\u5263","\u30ad\u30f3\u30b1\u30f3"],["\u6771\u4eac","\u30c8\u30a6\u30ad\u30e8\u30a6"],["\u7247\u9053","\u30ab\u30bf\u30df\u30c1"],["\u52c7\u8005","\u30e6\u30a6\u30b7\u30e4"],["\u5c11\u5973","\u30b7\u30e8\u30a6\u30b7\u30e8"],["\u771f\u7a7a","\u30b7\u30f3\u30af\u30a6"],["\u5b66\u5712","\u30ab\u30af\u30a8\u30f3"],["\u4e16\u754c","\u30bb\u30ab\u30a4"],["\u9752\u6625","\u30bb\u30a4\u30b7\u30e6\u30f3"],["\u75be\u60a3","\u30b7\u30c4\u30ab\u30f3"],["\u8ff7\u5bae","\u30e1\u30a4\u30ad\u30e6\u30a6"],["\u6b6f\u8eca","\u30cf\u30af\u30eb\u30de"],["\u84bc\u5929","\u30bd\u30a6\u30c6\u30f3"],["\u589c\u843d","\u30c4\u30a4\u30e9\u30af"],["\u7279\u547d","\u30c8\u30af\u30e1\u30a4"],["\u6643\u5929","\u30b3\u30a6\u30c6\u30f3"],["\u53db\u9006","\u30cf\u30f3\u30ad\u30e4\u30af"],["\u72af\u7f6a","\u30cf\u30f3\u30b5\u30a4"],["\u6d3b\u5287","\u30ab\u30c4\u30b1\u30ad"],["\u78a7\u7a7a","\u30d8\u30ad\u30af\u30a6"],["\u84ec\u83b1","\u30db\u30a6\u30e9\u30a4"],["\u5192\u967a","\u30db\u30a6\u30b1\u30f3"],["\u516d\u9580","\u30ed\u30af\u30e2\u30f3"],["\u708e\u4e0a","\u30a8\u30f3\u30b7\u30e8\u30a6"],["\u7121\u9650","\u30e0\u30b1\u30f3"],["\u5854","\u30c8\u30a6"],["\u7363","\u30b1\u30e2\u30ce"],["\u7378","\u30b1\u30e2\u30ce"],["\u68ee","\u30e2\u30ea"],["&","\u30a2\u30f3\u30c8"],["\uff06","\u30a2\u30f3\u30c8"],["\u30f4\u30a1","\u30cf"],["\u30f4\u30a3","\u30d2"],["\u30f4\u30a7","\u30d8"],["\u30f4\u30a9","\u30db"],["\u30f4","\u30d5"],["\u30a1","\u30a2"],["\u30a3","\u30a4"],["\u30a5","\u30a6"],["\u30a7","\u30a8"],["\u30a9","\u30aa"],["\u30e3","\u30e4"],["\u30e5","\u30e6"],["\u30e7","\u30e8"],["\u30c3","\u30c4"],["\u30f2","\u30aa"],["\u30ac","\u30ab"],["\u30ae","\u30ad"],["\u30b0","\u30af"],["\u30b2","\u30b1"],["\u30b4","\u30b3"],["\u30b6","\u30b5"],["\u30b8","\u30b7"],["\u30ba","\u30b9"],["\u30bc","\u30bb"],["\u30be","\u30bd"],["\u30c0","\u30bf"],["\u30c2","\u30c1"],["\u30c5","\u30c4"],["\u30c7","\u30c6"],["\u30c9","\u30c8"],["\u30d0","\u30cf"],["\u30d3","\u30d2"],["\u30d6","\u30d5"],["\u30d9","\u30d8"],["\u30dc","\u30db"],["\u30d1","\u30cf"],["\u30d4","\u30d2"],["\u30d7","\u30d5"],["\u30da","\u30d8"],["\u30dd","\u30db"]];constructor(n,e=null){super(n),this.chatMessageService=e}static rollCommandAsync(n,e="DiceBot",i=!1){var r=this;return(0,L.A)(function*(){const o=n.replace("\u200b",""),s=/^(([s\uff33\uff53][r\uff32\uff52][e\uff25\uff45][p\uff30\uff50][e\uff25\uff45][a\uff21\uff41][t\uff34\uff54]|[r\uff32\uff52][e\uff25\uff45][p\uff30\uff50][e\uff25\uff45][a\uff21\uff41][t\uff34\uff54]|[s\uff33\uff53][r\uff32\uff52][e\uff25\uff45][p\uff30\uff50]|[r\uff32\uff52][e\uff25\uff45][p\uff30\uff50]|[s\uff33\uff53][x\uff38\uff58]|[x\uff38\uff58])?([\d\uff10-\uff19]+)?[ \u3000]+)?([^\n]*)?/gi.exec(o),a=ke.toHalfWidth(s[2]),c=a&&0===ke.toHalfWidth(a).toUpperCase().indexOf("S"),u=null!=s[3]?Number(ke.toHalfWidth(s[3])):1;let f=null!=s[4]?s[4]:o,b={id:"DiceBot",result:"",isSecret:!1,isDiceRollTable:!1,isEmptyDice:!0,isSuccess:!1,isFailure:!0,isCritical:!1,isFumble:!1};if(!f||u<=0)return b;let C=!1;for(const x of Jl.instance.diceRollTables){if(null==x.command)continue;let M=!1,U=0,W="",K=!1;const $=ke.toHalfWidth(x.command.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).trim().toUpperCase(),ge=ke.toHalfWidth(f.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).trim().toUpperCase();if(!ge.startsWith("S"+$)||ge[("S"+$).length]&&!/[ \=\+\-]/.test(ge.charAt(("S"+$).length))?ge.startsWith($)&&(!ge[$.length]||/[ \=\+\-]/.test(ge.charAt($.length)))&&(C=!0,ge[$.length]&&" "!=ge[$.length]&&(W=ge.substring($.length))):(C=!0,M=!0,ge[("S"+$).length]&&" "!=ge[("S"+$).length]&&(W=ge.substring(("S"+$).length))),W)if(W=W.split(" ")[0],/^[\+\-]\d+$/.test(W))U=+W,W=` (\u4fee\u6b63${W})`;else{if(!/^\=\-?\d+$/.test(W)){C=!1;continue}K=!0}if(C){b.isFailure=!1,b.isDiceRollTable=!0,b.tableName=x.name&&x.name.length>0?x.name:"(\u7121\u540d\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868)",b.isSecret=M||c;const ye=x.parseText();for(let lt=0;lt<u&&lt<32;lt++){let Ee=null,Be=yield pi.diceRollAsync(K?`C(${W.substring(1)})`:ke.toHalfWidth(x.dice).trim().replace(/[\u216e\xd0]/g,"D").replace(/\\xd7/g,"*").replace(/\\xf7/g,"/").replace(/[\u2015\u30fc\u2014\u2010]/g,"-"),"DiceBot",1);b.isEmptyDice=b.isEmptyDice&&Be.isEmptyDice;let ft=null;Be.result.length>0&&(ft=Be.result.match(/\s\uff1e\s(?:\u6210\u529f\u6570|\u8a08\u7b97\u7d50\u679c)?(\-?\d+)$/))&&(Ee=+ft[1]),Be.result&&i&&(Be.result=r.formatRollResult(Be.result));let rt=!1;if(null!=Ee)for(const ht of ye)if((null===ht.range.start||ht.range.start<=Ee+U)&&(null===ht.range.end||Ee+U<=ht.range.end)){i?b.result+=K?"\u6307\u5b9a="+Ee+"\n"+ke.cr(ht.result):Be.result+W+(W?` \u2192 ${Ee+U}`:"")+"\n"+ke.cr(ht.result):b.result=(K?"\u6307\u5b9a=":"")+Ee+(K?"":W)+" \uff1e "+ht.result,rt=!0;break}rt||(null==Ee?(b.isFailure=!0,b.result+="\uff08\u30a8\u30e9\u30fc\uff1a\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u304b\u3089\u6570\u5b57\u304c\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\uff09\n(\u7d50\u679c\u306a\u3057)"):b.result+=K?"\u6307\u5b9a="+Ee+"\n(\u7d50\u679c\u306a\u3057)":Be.result+W+(W?` \u2192 ${Ee+U}`:"")+"\n(\u7d50\u679c\u306a\u3057)"),1<u&&(b.result+=` #${lt+1}`),lt<u-1&&(b.result+="\n")}break}}if(!C){let M,x=!1;if(M=/^([s\uff33\uff53]?[c\uff23\uff43][h\uff28\uff48][o\uff2f\uff4f][i\uff29\uff49][c\uff23\uff43][e\uff25\uff45][\d\uff10-\uff19]*)([ \u3000]+|[\\\uffe5][s\uff53])([^\n]*)/gi.exec(f.trim())){if(f=ke.toHalfWidth(M[1]+ke.cr(M[2])),null!=M[2]){const U=null!=M[3]?M[3]:"";/^\d+\-\d+|[a-z]\-[a-z]$/i.test(ke.toHalfWidth(U.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).trim())?f+=ke.toHalfWidth(U.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).trim():f+=(""===ke.toHalfWidth(U).trim()?U:ke.cr(U)).trim().replace(/[\u3000\s]+/g," ")}x=!0}if(!x&&((M=/^([s\uff33\uff53]?[c\uff23\uff43][h\uff28\uff48][o\uff2f\uff4f][i\uff29\uff49][c\uff23\uff43][e\uff25\uff45][\d\uff10-\uff19]*[\[\uff3b])([^\]\uff3d]+)([\]\uff3d])/gi.exec(f.trim()))||(M=/^([s\uff33\uff53]?[c\uff23\uff43][h\uff28\uff48][o\uff2f\uff4f][i\uff29\uff49][c\uff23\uff43][e\uff25\uff45][\d\uff10-\uff19]*[\(\uff08])([^\)\uff09]+)([\)\uff09])/gi.exec(f.trim())))){const U=null!=M[2]?M[2]:"";f=/^\d+\-\d+|[a-z]\-[a-z]$/i.test(ke.toHalfWidth(U.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).trim())?ke.toHalfWidth(M[1])+ke.toHalfWidth(U.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).trim()+ke.toHalfWidth(M[3]):ke.toHalfWidth(M[1])+U.replace(/\uff0c/g,",")+ke.toHalfWidth(M[3]),x=!0}if(x||(f=ke.toHalfWidth(f).trim().split(/\s+/)[0].replace(/[\u216e\xd0]/g,"D").replace(/\\xd7/g,"*").replace(/\\xf7/g,"/").replace(/[\u2015\u30fc\u2014\u2010]/g,"-")),pi.apiUrl){if(!x&&!/^[a-zA-Z0-9!-/:-@\xa5[-`{-~\}]+$/.test(f))return;b=yield pi.diceRollAsync(f,e,u),b.isSecret=b.isSecret||c}else{if(!(yield pi.loadGameSystemAsync(e)).COMMAND_PATTERN.test(f))return;for(let W=0;W<u&&W<32;W++){let K=yield pi.diceRollAsync(f,e,u);if(K.result.length<1)break;b.id=K.id,b.result+=K.result,b.isSecret=b.isSecret||K.isSecret||c,b.isEmptyDice=b.isEmptyDice&&K.isEmptyDice,b.isSuccess=b.isSuccess||K.isSuccess,b.isFailure=b.isFailure&&K.isFailure,b.isCritical=b.isCritical||K.isCritical,b.isFumble=b.isFumble||K.isFumble,1<u&&(b.result+=` #${W+1}\n`)}}}return b.result&&(b.result=b.result.trimRight()),b})()}onStoreAdded(){var n=this;super.onStoreAdded(),ne.register(this).on("SEND_MESSAGE",function(){var e=(0,L.A)(function*(i){const r=bt.instance.get(i.data.messageIdentifier);if(!r||!r.isSendFromSelf||r.isSystem||r.isOperationLog)return;let o=r.tag.replace("noface","").trim();o=o||"DiceBot";try{const s=yield pi.rollCommandAsync(r.text,o,!0);if(!s||!s.result)return;n.sendResultMessage(s,r)}catch(s){console.error(s)}});return function(i){return e.apply(this,arguments)}}())}onStoreRemoved(){super.onStoreRemoved(),ne.unregister(this)}sendResultMessage(n,e){let i=n.id.split(":")[0],r=n.result;const o=n.isSecret;if(r.length<1)return;let b="system";o&&(b+=" secret"),n.isEmptyDice&&(b+=" empty"),n.isSuccess&&(b+=" success"),n.isFailure&&(b+=" failure"),n.isCritical&&(b+=" critical"),n.isFumble&&(b+=" fumble");let C={identifier:"",tabIdentifier:e.tabIdentifier,originFrom:e.from,from:n.isDiceRollTable?"Dice-Roll Table":pi.apiUrl?`BCDice-API(${pi.apiUrl})`:"System-BCDice",timestamp:e.timestamp+1,imageIdentifier:"",tag:b,name:`${n.isDiceRollTable?n.tableName:i} : ${e.name}${o?" (Secret)":""}`,text:r,color:e.color,isUseStandImage:e.isUseStandImage},x="";const M=bt.instance.get(e.characterIdentifier);if(M instanceof gn){const K=M.standList.matchStandInfo(r,e.imageIdentifier);if(!o&&!e.standName&&e.isUseStandImage)if(K.farewell){const $={characterIdentifier:M.identifier};if(e.to){const ge=Fe.findByUserId(e.to);ge&&(ge.peerId!=Fe.myCursor.peerId&&ne.call("FAREWELL_STAND_IMAGE",$,ge.peerId),ne.call("FAREWELL_STAND_IMAGE",$,Fe.myCursor.peerId))}else ne.call("FAREWELL_STAND_IMAGE",$)}else if(K&&K.standElementIdentifier){const $=bt.instance.get(K.standElementIdentifier);if($&&$.getFirstElementByName("conditionType")){const ge=+$.getFirstElementByName("conditionType").value;if(ge==mo.Postfix||ge==mo.PostfixOrImage||ge==mo.PostfixAndImage){const ye={characterIdentifier:M.identifier,standIdentifier:K.standElementIdentifier,color:e.color,secret:!!e.to};if(ye.secret){const lt=Fe.findByUserId(e.to);lt&&(lt.peerId!=Fe.myCursor.peerId&&ne.call("POPUP_STAND_IMAGE",ye,lt.peerId),ne.call("POPUP_STAND_IMAGE",ye,Fe.myCursor.peerId))}else ne.call("POPUP_STAND_IMAGE",ye)}}}x=K.matchMostLongText}const U=bt.instance.get(e.tabIdentifier),W=tc.instance.matchCutInInfo(r);if(!o&&U.isUseStandImage&&W){for(const K of W.identifiers){const $={identifier:K,secret:!!e.to,sender:Fe.myCursor.peerId};if($.secret){const ge=Fe.findByUserId(e.to);ge&&(ge.peerId!=Fe.myCursor.peerId&&ne.call("PLAY_CUT_IN",$,ge.peerId),ne.call("PLAY_CUT_IN",$,Fe.myCursor.peerId))}else ne.call("PLAY_CUT_IN",$)}if(W.names&&W.names.length&&!e.to&&this.chatMessageService){const K=new Map;for(const ge of W.names){let ye=K.get(ge)||0;ye+=1,K.set(""==ge?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":ge,ye)}const $=`${[...K.keys()].map(ge=>K.get(ge)>1?`${ge}\xd7${K.get(ge)}`:ge).join("\u3001")}`;this.chatMessageService.sendOperationLog($+" \u304c\u8d77\u52d5\u3057\u305f")}}x.length<W.matchMostLongText.length&&(x=W.matchMostLongText),x&&C.text&&(C.text=C.text.slice(0,C.text.length-x.length)),n.isDiceRollTable||(C.text=pi.formatRollResult(C.text,i)),null!=e.to&&0<e.to.length&&(C.to=e.to,e.to.indexOf(e.from)<0&&(C.to+=" "+e.from)),U&&U.addMessage(C)}static diceRollAsync(n,e,i=1){return(0,L.A)(function*(){if(e=e||"DiceBot",pi.apiUrl){const r=1==pi.apiVersion?pi.apiUrl+"/v1/diceroll?system="+(e?encodeURIComponent(e):"DiceBot")+"&command="+encodeURIComponent(n):`${pi.apiUrl}/v2/game_system/${e?encodeURIComponent(e):"DiceBot"}/roll?command=${encodeURIComponent(n)}`,o=[];for(let s=1;s<=i;s++)o.push(fetch(r,{mode:"cors"}).then(a=>{if(a.ok)return a.json();throw new Error(a.statusText)}).then(a=>({id:e,result:(1==pi.apiVersion?a.result:a.text)+(i>1?` #${s}\n`:""),isSecret:a.secret,isEmptyDice:1==pi.apiVersion?a.dices&&0==a.dices.length:a.rands&&0==a.rands.length,isSuccess:a.success,isFailure:a.failure,isCritical:a.critical,isFumble:a.fumble})).catch(a=>({id:e,result:"",isSecret:!1,isEmptyDice:!0})));return Promise.all(o).then(s=>s.reduce((a,c)=>({id:e,result:a.result+c.result,isSecret:a.isSecret||c.isSecret,isEmptyDice:a.isEmptyDice&&c.isEmptyDice,isSuccess:a.isSuccess||c.isSuccess,isFailure:a.isFailure&&c.isFailure,isCritical:a.isCritical||c.isCritical,isFumble:a.isFumble||c.isFumble}),{id:e,result:"",isSecret:!1,isEmptyDice:!0,isSuccess:!1,isFailure:!0,isCritical:!1,isFumble:!1}))}try{let r=yield pi.loadGameSystemAsync(e);const o=r.eval(n);return o?(console.log("diceRoll!!!",o),console.log("isSecret!!!",o.secret),console.log("isEmptyDice!!!",!o.rands||0==o.rands.length),{id:r.ID,result:o.text,isSecret:o.secret,isEmptyDice:!o.rands||0==o.rands.length,isSuccess:o.success,isFailure:o.failure,isCritical:o.critical,isFumble:o.fumble}):{id:e,result:"",isSecret:!1,isEmptyDice:!0}}catch(r){console.error(r)}return{id:e,result:"",isSecret:!1,isEmptyDice:!0}})()}static getHelpMessage(n){return(0,L.A)(function*(){if(n=n||"DiceBot",pi.apiUrl){const e=[fetch(1==pi.apiVersion?pi.apiUrl+"/v1/systeminfo?system=DiceBot":`${pi.apiUrl}/v2/game_system/DiceBot`,{mode:"cors"}).then(i=>i.json())];return n&&"DiceBot"!=n&&e.push(fetch(1==pi.apiVersion?pi.apiUrl+"/v1/systeminfo?system="+encodeURIComponent(n):`${pi.apiUrl}/v2/game_system/${encodeURIComponent(n)}`,{mode:"cors"}).then(i=>i.json())),Promise.all(e).then(i=>i.map(r=>1==pi.apiVersion&&r.systeminfo&&r.systeminfo.info?r.systeminfo.info.replace("\u90e8\u5c4b\u306e\u30b7\u30b9\u30c6\u30e0\u540d","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306a\u3069\u306e\u30b7\u30b9\u30c6\u30e0\u540d"):r.help_message?r.help_message.replace("\u90e8\u5c4b\u306e\u30b7\u30b9\u30c6\u30e0\u540d","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306a\u3069\u306e\u30b7\u30b9\u30c6\u30e0\u540d"):"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u60c5\u5831\u304c\u3042\u308a\u307e\u305b\u3093\u3002"))}{let e=[""];try{if(e=[(yield pi.loadGameSystemAsync("DiceBot")).HELP_MESSAGE],n&&""!=n&&"DiceBot"!=n){let i=yield pi.loadGameSystemAsync(n);e.push(i&&"DiceBot"!=i.ID&&i.HELP_MESSAGE?i.HELP_MESSAGE.replace("\u90e8\u5c4b\u306e\u30b7\u30b9\u30c6\u30e0\u540d","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306a\u3069\u306e\u30b7\u30b9\u30c6\u30e0\u540d"):"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u60c5\u5831\u304c\u3042\u308a\u307e\u305b\u3093\u3002")}}catch(i){console.error(i)}return e}})()}static loadGameSystemAsync(n){var e=this;return(0,L.A)(function*(){return yield dX.add(()=>{const i=e.diceBotInfos.some(r=>r.id===n)?n:"DiceBot";try{return bC.getGameSystemClass(i)}catch{return bC.dynamicLoad(i)}})})()}static formatRollResult(n,e="DiceBot"){if(null==n)return"";let i=0,r=0;return n.split("\n").map(o=>{let s=[],a=[],c=[],u=[];return"Cthulhu7th"===e&&/^\d+(:?\u56de\u76ee|\u6b21|\ubc88\uc9f8): \uff1e/.test(o)&&(i+=1,o="\u{1f3b2}"+o),o.split(/\s\uff1e\s/).map((f,b,C)=>{let x=null;if("Cthulhu7th"===e&&(x=/(?:\u30dc\u30fc\u30ca\u30b9\u30fb\u30da\u30ca\u30eb\u30c6\u30a3\u30c0\u30a4\u30b9|\u734e\u52f5\u3001\u61f2\u7f70\u9ab0\u5024|\ubcf4\ub108\uc2a4, \ud328\ub110\ud2f0 \uc8fc\uc0ac\uc704)\[(?<bonusDice>\-?\d+)\]/.exec(f))&&x&&x.groups&&(r=+x.groups.bonusDice),1===C.length)return f;if(0==b){if("Cthulhu"===e&&/\d\) (?:\u6545\u969c\u30ca\u30f3\u30d0\u30fc|\u6545\u969c\u7387|\uace0\uc7a5\ub118\ubc84)\[\-?\d+\]/.test(f)||"Cthulhu7th"===e&&/\d\) (?:\u30dc\u30fc\u30ca\u30b9\u30fb\u30da\u30ca\u30eb\u30c6\u30a3\u30c0\u30a4\u30b9|\u734e\u52f5\u3001\u61f2\u7f70\u9ab0\u5024|\ubcf4\ub108\uc2a4, \ud328\ub110\ud2f0 \uc8fc\uc0ac\uc704)\[\-?\d+\]/.test(f))return"\u{1f3b2}"+f.replace(/\((1D100<=\d+)\) /i,"$1 ");const U=pi.apiUrl&&1==pi.apiVersion?/^(?:\: )\((CHOICE(?:\d+)?[\[\( ].+)\)$/i:/^\((CHOICE(?:\d+)?[\[\( ].+)\)$/i,W=f.match(pi.apiUrl&&1==pi.apiVersion?/^(?:\: )\(([A-Z\d\+\-\*\/=\(\),\[\]\<\>@#\$\?]+)\)$/i:/^\(([A-Z\d\+\-\*\/=\(\),\[\]\<\>@#\$\?]+)\)$/i)||f.match(U);return W&&!W[1].toUpperCase().startsWith("CHOICE")&&(s=[...f.matchAll(/(?<diceCount>\d+)D\d+(?:(?<keepDrop>[KD][HL])(?<keepDropCount>\d+))?/gi)],s.length||(a=[...f.matchAll(/\d+B\d+(?:\+\d+B\d+)*(?:\[6\]Limit\[\d+\])?(?<sign><=|>=|<>|==|!=|<|>|=)(?<criteria>\d+)/gi)],a.length||(c=[...f.matchAll(/\d+R\d+(?:\+\d+R\d+)*\[(?<rerollSign><=|>=|<>|==|!=|<|>|=)?(?<rerollCriteria>\d+)\](?:(?<sign><=|>=|<>|==|!=|<|>|=)(?<criteria>\d+))?/gi)],c.length||(u=[...f.matchAll(/\d+U\d+(?:\+\d+U\d+)*\[(?<rerollCriteria>\d+)\](?<modifier>[\-+]\d+)?(?:(?<sign><=|>=|<>|==|!=|<|>|=)(?<criteria>\d+))?/gi)])))),W?"\u{1f3b2}"+W[1]:f}if(b==C.length-1)return f;if(1==b&&(s.length||a.length||c.length||u.length))try{let M=f;const W=[...f.matchAll(s.length?/(?<total>\d+)\[(?<diceArrayString>\d+(?:,\d+)*)?\]/gi:u.length?/(?:(?<total>\d+)\[(?<diceArrayString>\d+(?:,\d+)*)?\])|(?<modifier2>[\-+]\d+)|(?<dieString>\d+)/gi:/(?<diceArrayString>\d+(?:,\d+)*)/gi)];if(W.length){let $,K=0;W.forEach((ge,ye)=>{if($=ge[0],s.length){const{diceCount:Ee,keepDrop:Be,keepDropCount:ft}=s[ye].groups,{total:rt,diceArrayString:ht}=ge.groups;if(Be){const xt=null!=ht?ht.split(",").sort((ln,Mn)=>+ln-+Mn):[],pt=Be.startsWith("K")?ft:Ee-ft;("KH"===Be||"DL"===Be)&&xt.reverse();const Qt=xt.map((ln,Mn)=>Mn+1<=pt?`${ln}`:`~~~${ln}~~~`);("DH"===Be||"DL"===Be)&&Qt.reverse(),$=`${rt}[${Qt.join(",")}]`}}else if(a.length){const{sign:Ee,criteria:Be}=a[0].groups,{diceArrayString:ft}=ge.groups;$=ft.split(",").map(rt=>pi.isPass(rt,Ee,Be)?`${rt}`:`~~~${rt}~~~`).join(",")}else if(c.length){let{rerollSign:Ee,rerollCriteria:Be,sign:ft,criteria:rt}=c[0].groups;Ee||(Ee=ft),Be||(Be=rt);const{diceArrayString:ht}=ge.groups;$=ht.split(",").map(xt=>pi.isPass(xt,Ee,Be)?`###${xt}###`:xt).map(xt=>pi.isPass(xt,ft,rt,!1)?xt:`~~~${xt}~~~`).join(",")}else if(u.length){const{rerollCriteria:Ee,modifier:Be,sign:ft,criteria:rt}=u[0].groups,{total:ht,diceArrayString:xt,modifier2:pt,dieString:Qt}=ge.groups;if(console.log(u[0],ge),pt)$=` (${pt})`;else if(ht)$=ht+"["+xt.split(",").map(ln=>pi.isPass(ln,">=",Ee)?`###${ln}###`:ln).join(",")+"]",pi.isPass(+ht+(Be?+Be:0),ft,rt)||($=`~~~${$}~~~`);else{let ln=$;$=pi.isPass(Qt,">=",Ee)?`###${Qt}###`:Qt,pi.isPass(+ln+(Be?+Be:0),ft,rt)||($=`~~~${$}~~~`)}}const lt=M.indexOf(ge[0],K);$!=ge[0]&&(M=M.substring(0,lt)+$+M.substring(lt+ge[0].length)),K=lt+$.length})}f=M}catch(M){console.error(M)}else if("BladeOfArcana"!=e||1!=b&&2!=b)if("Cthulhu7th"!=e||1!=b&&2!=b){if("DoubleCross"==e&&1==b)f=f.split("+").map(M=>{const U=M.match(/(?<result>\d{1,2})\[(?<diceArrayString>\d{1,2}(?:,\d{1,2})*)\]/);if(U){const W=C[0].match(/\(\d+DX(?<critical>\d+)/i);if(W){const{result:K,diceArrayString:$}=U.groups,{critical:ge}=W.groups;let ye=!1;const lt=$.split(",").map((Ee,Be,ft)=>parseInt(Ee)>=parseInt(ge)?(ye=!0,`###${Ee}###`):Be===ft.length-1?`${Ee}`:`~~~${Ee}~~~`).join(",");return`${ye?`###${K}###`:K}[${lt}]`}}return M}).join("+");else if("DungeonsAndDragons5"==e&&1==b&&(C[0].startsWith("(AT")||C[0].startsWith("(AR"))){const M=C[0].startsWith("(AT"),U=C[0].endsWith("A)"),W=C[0].endsWith("D)");if(U||W){const K=f.match(/\[(?<diceArrayString>\d+(?:,\d+)*)?\](?<modifier>[\-+]\d+)?/i);if(!K)return f;const{diceArrayString:$,modifier:ge}=K.groups,ye=$.split(",").map(Be=>parseInt(Be)),lt=U?Math.max(...ye):Math.min(...ye);let Ee=!1;f="["+ye.map(Be=>{let ft=!M||20!==Be&&1!==Be?Be.toString():`###${Be}###`;return Ee||Be!==lt?ft=`~~~${ft}~~~`:Ee=!0,ft}).join(",")+"]"+(ge||"")}else if(M){const K=f.match(/(?<diceString>\d+)?(?<modifier>[\-+]\d+)?/i);if(K){const{diceString:$,modifier:ge}=K.groups;$&&(20===parseInt($)||1===parseInt($))&&(f=`###${$}###${ge||""}`)}}}}else console.log(f),f=f.replace(/(?:\d+, )*\d+/,M=>{const U=r-(i>0?i-1:0)>=0;let W=U?101:-1;const K=M.split(",").map(ge=>{let ye=+ge.trim();return U&&W>ye&&(W=ye),!U&&W<ye&&(W=ye),ye});let $=!0;return K.map(ge=>{let ye=1==ge?`###${ge}###`:ge.toString();return K.length>1&&($&&ge==W?$=!1:ye=`~~~${ye}~~~`),ye}).join(", ")});else{const M=C[0].match(/^\(\d+A(?<deficult>\d+)C(?<critical>\d+)F(?<fumble>\d+)\)$/i);if(M){const{deficult:U,critical:W,fumble:K}=M.groups;f=f.split(",").map($=>{let ge=parseInt($.trim());return 1===ge?`###${ge}###`:ge>=parseInt(K)?`~~~###${ge}###~~~`:ge<=parseInt(W)?`###${ge}###`:ge>parseInt(U)?`~~~${ge}~~~`:$}).join(",")}}return f}).join(" \uff1e ").replace(/(\s|^)\uff1e\s/g,"$1\u2192 ").replace(/\((\d+)(D)(\d+)\uff1e(\d)/gi,"(\u{1f3b2}$1$2$3\u2192$4")}).join("\n")}static isPass(n,e,i,r=!0){if(null==n)return r;let o=n.toString().match(/(\d+)/);o&&(n=o[1]);let s=r;switch(e){case"==":case"=":s=+n==+i;break;case"!=":case"<>":s=+n!=+i;break;case">=":s=+n>=+i;break;case"<=":s=+n<=+i;break;case"<":s=+n<+i;break;case">":s=+n>+i}return s}};function UR(t,n){if(Array.prototype.indexOf)return t.indexOf(n);for(var e=0,i=t.length;e<i;e++)if(t[e]===n)return e;return-1}function Mf(t,n){for(var e=t.length-1;e>=0;e--)!0===n(t[e])&&t.splice(e,1)}function eS(t){throw new Error("Unhandled case for value: '".concat(t,"'"))}Zi=pi=He([ir("dice-bot")],Zi);var e,tS=function(){function t(n){void 0===n&&(n={}),this.tagName="",this.attrs={},this.innerHTML="",this.whitespaceRegex=/\s+/,this.tagName=n.tagName||"",this.attrs=n.attrs||{},this.innerHTML=n.innerHtml||n.innerHTML||""}return t.prototype.setTagName=function(n){return this.tagName=n,this},t.prototype.getTagName=function(){return this.tagName||""},t.prototype.setAttr=function(n,e){return this.getAttrs()[n]=e,this},t.prototype.getAttr=function(n){return this.getAttrs()[n]},t.prototype.setAttrs=function(n){return Object.assign(this.getAttrs(),n),this},t.prototype.getAttrs=function(){return this.attrs||(this.attrs={})},t.prototype.setClass=function(n){return this.setAttr("class",n)},t.prototype.addClass=function(n){for(var s,e=this.getClass(),i=this.whitespaceRegex,r=e?e.split(i):[],o=n.split(i);s=o.shift();)-1===UR(r,s)&&r.push(s);return this.getAttrs().class=r.join(" "),this},t.prototype.removeClass=function(n){for(var s,e=this.getClass(),i=this.whitespaceRegex,r=e?e.split(i):[],o=n.split(i);r.length&&(s=o.shift());){var a=UR(r,s);-1!==a&&r.splice(a,1)}return this.getAttrs().class=r.join(" "),this},t.prototype.getClass=function(){return this.getAttrs().class||""},t.prototype.hasClass=function(n){return-1!==(" "+this.getClass()+" ").indexOf(" "+n+" ")},t.prototype.setInnerHTML=function(n){return this.innerHTML=n,this},t.prototype.setInnerHtml=function(n){return this.setInnerHTML(n)},t.prototype.getInnerHTML=function(){return this.innerHTML||""},t.prototype.getInnerHtml=function(){return this.getInnerHTML()},t.prototype.toAnchorString=function(){var n=this.getTagName(),e=this.buildAttrsStr();return["<",n,e=e?" "+e:"",">",this.getInnerHtml(),"</",n,">"].join("")},t.prototype.buildAttrsStr=function(){if(!this.attrs)return"";var n=this.getAttrs(),e=[];for(var i in n)n.hasOwnProperty(i)&&e.push(i+'="'+n[i]+'"');return e.join(" ")},t}(),zR=function(){function t(n){void 0===n&&(n={}),this.newWindow=!1,this.truncate={},this.className="",this.newWindow=n.newWindow||!1,this.truncate=n.truncate||{},this.className=n.className||""}return t.prototype.build=function(n){return new tS({tagName:"a",attrs:this.createAttrs(n),innerHtml:this.processAnchorText(n.getAnchorText())})},t.prototype.createAttrs=function(n){var e={href:n.getAnchorHref()},i=this.createCssClass(n);return i&&(e.class=i),this.newWindow&&(e.target="_blank",e.rel="noopener noreferrer"),this.truncate&&this.truncate.length&&this.truncate.length<n.getAnchorText().length&&(e.title=n.getAnchorHref()),e},t.prototype.createCssClass=function(n){var e=this.className;if(e){for(var i=[e],r=n.getCssClassSuffixes(),o=0,s=r.length;o<s;o++)i.push(e+"-"+r[o]);return i.join(" ")}return""},t.prototype.processAnchorText=function(n){return this.doTruncate(n)},t.prototype.doTruncate=function(n){var e=this.truncate;if(!e||!e.length)return n;var i=e.length,r=e.location;return"smart"===r?function _X(t,n,e){var i,r;null==e?(e="&hellip;",r=3,i=8):(r=e.length,i=e.length);var s=function($){var ge="";return $.scheme&&$.host&&(ge+=$.scheme+"://"),$.host&&(ge+=$.host),$.path&&(ge+="/"+$.path),$.query&&(ge+="?"+$.query),$.fragment&&(ge+="#"+$.fragment),ge},a=function($,ge){var ye=ge/2,lt=Math.ceil(ye),Ee=-1*Math.floor(ye),Be="";return Ee<0&&(Be=$.substr(Ee)),$.substr(0,lt)+e+Be};if(t.length<=n)return t;var ge,ye,lt,c=n-r,u=(ge={},(lt=(ye=t).match(/^([a-z]+):\/\//i))&&(ge.scheme=lt[1],ye=ye.substr(lt[0].length)),(lt=ye.match(/^(.*?)(?=(\?|#|\/|$))/i))&&(ge.host=lt[1],ye=ye.substr(lt[0].length)),(lt=ye.match(/^\/(.*?)(?=(\?|#|$))/i))&&(ge.path=lt[1],ye=ye.substr(lt[0].length)),(lt=ye.match(/^\?(.*?)(?=(#|$))/i))&&(ge.query=lt[1],ye=ye.substr(lt[0].length)),(lt=ye.match(/^#(.*?)$/i))&&(ge.fragment=lt[1]),ge);if(u.query){var f=u.query.match(/^(.*?)(?=(\?|\#))(.*?)$/i);f&&(u.query=u.query.substr(0,f[1].length),t=s(u))}if(t.length<=n||(u.host&&(u.host=u.host.replace(/^www\./,""),t=s(u)),t.length<=n))return t;var b="";if(u.host&&(b+=u.host),b.length>=c)return u.host.length==n?(u.host.substr(0,n-r)+e).substr(0,c+i):a(b,c).substr(0,c+i);var C="";if(u.path&&(C+="/"+u.path),u.query&&(C+="?"+u.query),C){if((b+C).length>=c)return(b+C).length==n?(b+C).substr(0,n):(b+a(C,c-b.length)).substr(0,c+i);b+=C}if(u.fragment){var M="#"+u.fragment;if((b+M).length>=c)return(b+M).length==n?(b+M).substr(0,n):(b+a(M,c-b.length)).substr(0,c+i);b+=M}if(u.scheme&&u.host){var W=u.scheme+"://";if((b+W).length<c)return(W+b).substr(0,n)}if(b.length<=n)return b;var K="";return c>0&&(K=b.substr(-1*Math.floor(c/2))),(b.substr(0,Math.ceil(c/2))+e+K).substr(0,c+i)}(n,i):"middle"===r?function bX(t,n,e){if(t.length<=n)return t;var i,r;null==e?(e="&hellip;",i=8,r=3):(i=e.length,r=e.length);var o=n-r,s="";return o>0&&(s=t.substr(-1*Math.floor(o/2))),(t.substr(0,Math.ceil(o/2))+e+s).substr(0,o+i)}(n,i):function vX(t,n,e){return function gX(t,n,e){var i;return t.length>n&&(null==e?(e="&hellip;",i=3):i=e.length,t=t.substring(0,n-i)+e),t}(t,n,e)}(n,i)},t}(),Yg=function(){function t(n){this.__jsduckDummyDocProp=null,this.matchedText="",this.offset=0,this.tagBuilder=n.tagBuilder,this.matchedText=n.matchedText,this.offset=n.offset}return t.prototype.getMatchedText=function(){return this.matchedText},t.prototype.setOffset=function(n){this.offset=n},t.prototype.getOffset=function(){return this.offset},t.prototype.getCssClassSuffixes=function(){return[this.getType()]},t.prototype.buildTag=function(){return this.tagBuilder.build(this)},t}(),HR=function(t){function n(e){var i=t.call(this,e)||this;return i.email="",i.email=e.email,i}return Xl(n,t),n.prototype.getType=function(){return"email"},n.prototype.getEmail=function(){return this.email},n.prototype.getAnchorHref=function(){return"mailto:"+this.email},n.prototype.getAnchorText=function(){return this.email},n}(Yg),VR=function(t){function n(e){var i=t.call(this,e)||this;return i.serviceName="",i.hashtag="",i.serviceName=e.serviceName,i.hashtag=e.hashtag,i}return Xl(n,t),n.prototype.getType=function(){return"hashtag"},n.prototype.getServiceName=function(){return this.serviceName},n.prototype.getHashtag=function(){return this.hashtag},n.prototype.getAnchorHref=function(){var e=this.serviceName,i=this.hashtag;switch(e){case"twitter":return"https://twitter.com/hashtag/"+i;case"facebook":return"https://www.facebook.com/hashtag/"+i;case"instagram":return"https://instagram.com/explore/tags/"+i;case"tiktok":return"https://www.tiktok.com/tag/"+i;default:throw new Error("Unknown service name to point hashtag to: "+e)}},n.prototype.getAnchorText=function(){return"#"+this.hashtag},n}(Yg),jR=function(t){function n(e){var i=t.call(this,e)||this;return i.serviceName="twitter",i.mention="",i.mention=e.mention,i.serviceName=e.serviceName,i}return Xl(n,t),n.prototype.getType=function(){return"mention"},n.prototype.getMention=function(){return this.mention},n.prototype.getServiceName=function(){return this.serviceName},n.prototype.getAnchorHref=function(){switch(this.serviceName){case"twitter":return"https://twitter.com/"+this.mention;case"instagram":return"https://instagram.com/"+this.mention;case"soundcloud":return"https://soundcloud.com/"+this.mention;case"tiktok":return"https://www.tiktok.com/@"+this.mention;default:throw new Error("Unknown service name to point mention to: "+this.serviceName)}},n.prototype.getAnchorText=function(){return"@"+this.mention},n.prototype.getCssClassSuffixes=function(){var e=t.prototype.getCssClassSuffixes.call(this),i=this.getServiceName();return i&&e.push(i),e},n}(Yg),GR=function(t){function n(e){var i=t.call(this,e)||this;return i.number="",i.plusSign=!1,i.number=e.number,i.plusSign=e.plusSign,i}return Xl(n,t),n.prototype.getType=function(){return"phone"},n.prototype.getPhoneNumber=function(){return this.number},n.prototype.getNumber=function(){return this.getPhoneNumber()},n.prototype.getAnchorHref=function(){return"tel:"+(this.plusSign?"+":"")+this.number},n.prototype.getAnchorText=function(){return this.matchedText},n}(Yg),WR=function(t){function n(e){var i=t.call(this,e)||this;return i.url="",i.urlMatchType="scheme",i.protocolUrlMatch=!1,i.protocolRelativeMatch=!1,i.stripPrefix={scheme:!0,www:!0},i.stripTrailingSlash=!0,i.decodePercentEncoding=!0,i.schemePrefixRegex=/^(https?:\/\/)?/i,i.wwwPrefixRegex=/^(https?:\/\/)?(www\.)?/i,i.protocolRelativeRegex=/^\/\//,i.protocolPrepended=!1,i.urlMatchType=e.urlMatchType,i.url=e.url,i.protocolUrlMatch=e.protocolUrlMatch,i.protocolRelativeMatch=e.protocolRelativeMatch,i.stripPrefix=e.stripPrefix,i.stripTrailingSlash=e.stripTrailingSlash,i.decodePercentEncoding=e.decodePercentEncoding,i}return Xl(n,t),n.prototype.getType=function(){return"url"},n.prototype.getUrlMatchType=function(){return this.urlMatchType},n.prototype.getUrl=function(){var e=this.url;return!this.protocolRelativeMatch&&!this.protocolUrlMatch&&!this.protocolPrepended&&(e=this.url="http://"+e,this.protocolPrepended=!0),e},n.prototype.getAnchorHref=function(){return this.getUrl().replace(/&amp;/g,"&")},n.prototype.getAnchorText=function(){var e=this.getMatchedText();return this.protocolRelativeMatch&&(e=this.stripProtocolRelativePrefix(e)),this.stripPrefix.scheme&&(e=this.stripSchemePrefix(e)),this.stripPrefix.www&&(e=this.stripWwwPrefix(e)),this.stripTrailingSlash&&(e=this.removeTrailingSlash(e)),this.decodePercentEncoding&&(e=this.removePercentEncoding(e)),e},n.prototype.stripSchemePrefix=function(e){return e.replace(this.schemePrefixRegex,"")},n.prototype.stripWwwPrefix=function(e){return e.replace(this.wwwPrefixRegex,"$1")},n.prototype.stripProtocolRelativePrefix=function(e){return e.replace(this.protocolRelativeRegex,"")},n.prototype.removeTrailingSlash=function(e){return"/"===e.charAt(e.length-1)&&(e=e.slice(0,-1)),e},n.prototype.removePercentEncoding=function(e){var i=e.replace(/%22/gi,"&quot;").replace(/%26/gi,"&amp;").replace(/%27/gi,"&#39;").replace(/%3C/gi,"&lt;").replace(/%3E/gi,"&gt;");try{return decodeURIComponent(i)}catch{return i}},n}(Yg),Zg=function(){return function t(n){this.__jsduckDummyDocProp=null,this.tagBuilder=n.tagBuilder}}(),nS=/[A-Za-z]/,yX=/[\d]/,CX=/[\D]/,Df=/\s/,iS=/['"]/,xX=/[\x00-\x1F\x7F]/,$R=/A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC/.source,YR=$R+/\u2700-\u27bf\udde6-\uddff\ud800-\udbff\udc00-\udfff\ufe0e\ufe0f\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0\ud83c\udffb-\udfff\u200d\u3299\u3297\u303d\u3030\u24c2\ud83c\udd70-\udd71\udd7e-\udd7f\udd8e\udd91-\udd9a\udde6-\uddff\ude01-\ude02\ude1a\ude2f\ude32-\ude3a\ude50-\ude51\u203c\u2049\u25aa-\u25ab\u25b6\u25c0\u25fb-\u25fe\u00a9\u00ae\u2122\u2139\udc04\u2600-\u26FF\u2b05\u2b06\u2b07\u2b1b\u2b1c\u2b50\u2b55\u231a\u231b\u2328\u23cf\u23e9-\u23f3\u23f8-\u23fa\udccf\u2935\u2934\u2190-\u21ff/.source+/\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D4-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D01-\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF8\u1CF9\u1DC0-\u1DF5\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F/.source,vC=/0-9\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19/.source,IX=YR+vC,Ur=YR+vC,hb=new RegExp("[".concat(Ur,"]")),TX="(?:["+vC+"]{1,3}\\.){3}["+vC+"]{1,3}",SX="["+Ur+"](?:["+Ur+"\\-_]{0,61}["+Ur+"])?",ZR=function(t){return"(?=("+SX+"))\\"+t},rS=function(t){return"(?:"+ZR(t)+"(?:\\."+ZR(t+1)+"){0,126}|"+TX+")"},yC=(new RegExp("["+Ur+".\\-]*["+Ur+"\\-]"),hb),qR=/(?:xn--vermgensberatung-pwb|xn--vermgensberater-ctb|xn--clchc0ea0b2g2a9gcd|xn--w4r85el8fhu5dnra|northwesternmutual|travelersinsurance|verm\xf6gensberatung|xn--5su34j936bgsg|xn--bck1b9a5dre4c|xn--mgbah1a3hjkrd|xn--mgbai9azgqp6j|xn--mgberp4a5d4ar|xn--xkc2dl3a5ee0h|verm\xf6gensberater|xn--fzys8d69uvgm|xn--mgba7c0bbn0a|xn--mgbcpq6gpa1a|xn--xkc2al3hye2a|americanexpress|kerryproperties|sandvikcoromant|xn--i1b6b1a6a2e|xn--kcrx77d1x4a|xn--lgbbat1ad8j|xn--mgba3a4f16a|xn--mgbaakc7dvf|xn--mgbc0a9azcg|xn--nqv7fs00ema|americanfamily|bananarepublic|cancerresearch|cookingchannel|kerrylogistics|weatherchannel|xn--54b7fta0cc|xn--6qq986b3xl|xn--80aqecdr1a|xn--b4w605ferd|xn--fiq228c5hs|xn--h2breg3eve|xn--jlq480n2rg|xn--jlq61u9w7b|xn--mgba3a3ejt|xn--mgbaam7a8h|xn--mgbayh7gpa|xn--mgbbh1a71e|xn--mgbca7dzdo|xn--mgbi4ecexp|xn--mgbx4cd0ab|xn--rvc1e0am3e|international|lifeinsurance|travelchannel|wolterskluwer|xn--cckwcxetd|xn--eckvdtc9d|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--h2brj9c8c|xn--tiq49xqyj|xn--yfro4i67o|xn--ygbi2ammx|construction|lplfinancial|scholarships|versicherung|xn--3e0b707e|xn--45br5cyl|xn--4dbrk0ce|xn--80adxhks|xn--80asehdb|xn--8y0a063a|xn--gckr3f0f|xn--mgb9awbf|xn--mgbab2bd|xn--mgbgu82a|xn--mgbpl2fh|xn--mgbt3dhd|xn--mk1bu44c|xn--ngbc5azd|xn--ngbe9e0a|xn--ogbpf8fl|xn--qcka1pmc|accountants|barclaycard|blackfriday|blockbuster|bridgestone|calvinklein|contractors|creditunion|engineering|enterprises|foodnetwork|investments|kerryhotels|lamborghini|motorcycles|olayangroup|photography|playstation|productions|progressive|redumbrella|williamhill|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--3bst00m|xn--3ds443g|xn--3hcrj9c|xn--42c2d9a|xn--45brj9c|xn--55qw42g|xn--6frz82g|xn--80ao21a|xn--9krt00a|xn--cck2b3b|xn--czr694b|xn--d1acj3b|xn--efvy88h|xn--fct429k|xn--fjq720a|xn--flw351e|xn--g2xx48c|xn--gecrj9c|xn--gk3at1e|xn--h2brj9c|xn--hxt814e|xn--imr513n|xn--j6w193g|xn--jvr189m|xn--kprw13d|xn--kpry57d|xn--mgbbh1a|xn--mgbtx2b|xn--mix891f|xn--nyqy26a|xn--otu796d|xn--pgbs0dh|xn--q9jyb4c|xn--rhqv96g|xn--rovu88b|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--vuq861b|xn--w4rs40l|xn--xhq521b|xn--zfr164b|\u0b9a\u0bbf\u0b99\u0bcd\u0b95\u0baa\u0bcd\u0baa\u0bc2\u0bb0\u0bcd|accountant|apartments|associates|basketball|bnpparibas|boehringer|capitalone|consulting|creditcard|cuisinella|eurovision|extraspace|foundation|healthcare|immobilien|industries|management|mitsubishi|nextdirect|properties|protection|prudential|realestate|republican|restaurant|schaeffler|tatamotors|technology|university|vlaanderen|volkswagen|xn--30rr7y|xn--3pxu8k|xn--45q11c|xn--4gbrim|xn--55qx5d|xn--5tzm5g|xn--80aswg|xn--90a3ac|xn--9dbq2a|xn--9et52u|xn--c2br7g|xn--cg4bki|xn--czrs0t|xn--czru2d|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--io0a7i|xn--kput3i|xn--mxtq1m|xn--o3cw4h|xn--pssy2u|xn--q7ce6a|xn--unup4y|xn--wgbh1c|xn--wgbl6a|xn--y9a3aq|accenture|alfaromeo|allfinanz|amsterdam|analytics|aquarelle|barcelona|bloomberg|christmas|community|directory|education|equipment|fairwinds|financial|firestone|fresenius|frontdoor|furniture|goldpoint|hisamitsu|homedepot|homegoods|homesense|institute|insurance|kuokgroup|lancaster|landrover|lifestyle|marketing|marshalls|melbourne|microsoft|panasonic|passagens|pramerica|richardli|shangrila|solutions|statebank|statefarm|stockholm|travelers|vacations|xn--90ais|xn--c1avg|xn--d1alf|xn--e1a4c|xn--fhbei|xn--j1aef|xn--j1amh|xn--l1acc|xn--ngbrx|xn--nqv7f|xn--p1acf|xn--qxa6a|xn--tckwe|xn--vhquv|yodobashi|\u0645\u0648\u0631\u064a\u062a\u0627\u0646\u064a\u0627|abudhabi|airforce|allstate|attorney|barclays|barefoot|bargains|baseball|boutique|bradesco|broadway|brussels|builders|business|capetown|catering|catholic|cipriani|cityeats|cleaning|clinique|clothing|commbank|computer|delivery|deloitte|democrat|diamonds|discount|discover|download|engineer|ericsson|etisalat|exchange|feedback|fidelity|firmdale|football|frontier|goodyear|grainger|graphics|guardian|hdfcbank|helsinki|holdings|hospital|infiniti|ipiranga|istanbul|jpmorgan|lighting|lundbeck|marriott|maserati|mckinsey|memorial|merckmsd|mortgage|observer|partners|pharmacy|pictures|plumbing|property|redstone|reliance|saarland|samsclub|security|services|shopping|showtime|softbank|software|stcgroup|supplies|training|vanguard|ventures|verisign|woodside|xn--90ae|xn--node|xn--p1ai|xn--qxam|yokohama|\u0627\u0644\u0633\u0639\u0648\u062f\u064a\u0629|abogado|academy|agakhan|alibaba|android|athleta|auction|audible|auspost|avianca|banamex|bauhaus|bentley|bestbuy|booking|brother|bugatti|capital|caravan|careers|channel|charity|chintai|citadel|clubmed|college|cologne|comcast|company|compare|contact|cooking|corsica|country|coupons|courses|cricket|cruises|dentist|digital|domains|exposed|express|farmers|fashion|ferrari|ferrero|finance|fishing|fitness|flights|florist|flowers|forsale|frogans|fujitsu|gallery|genting|godaddy|grocery|guitars|hamburg|hangout|hitachi|holiday|hosting|hoteles|hotmail|hyundai|ismaili|jewelry|juniper|kitchen|komatsu|lacaixa|lanxess|lasalle|latrobe|leclerc|limited|lincoln|markets|monster|netbank|netflix|network|neustar|okinawa|oldnavy|organic|origins|philips|pioneer|politie|realtor|recipes|rentals|reviews|rexroth|samsung|sandvik|schmidt|schwarz|science|shiksha|singles|staples|storage|support|surgery|systems|temasek|theater|theatre|tickets|tiffany|toshiba|trading|walmart|wanggou|watches|weather|website|wedding|whoswho|windows|winners|xfinity|yamaxun|youtube|zuerich|\u043a\u0430\u0442\u043e\u043b\u0438\u043a|\u0627\u062a\u0635\u0627\u0644\u0627\u062a|\u0627\u0644\u0628\u062d\u0631\u064a\u0646|\u0627\u0644\u062c\u0632\u0627\u0626\u0631|\u0627\u0644\u0639\u0644\u064a\u0627\u0646|\u067e\u0627\u06a9\u0633\u062a\u0627\u0646|\u0643\u0627\u062b\u0648\u0644\u064a\u0643|\u0b87\u0ba8\u0bcd\u0ba4\u0bbf\u0baf\u0bbe|abarth|abbott|abbvie|africa|agency|airbus|airtel|alipay|alsace|alstom|amazon|anquan|aramco|author|bayern|beauty|berlin|bharti|bostik|boston|broker|camera|career|casino|center|chanel|chrome|church|circle|claims|clinic|coffee|comsec|condos|coupon|credit|cruise|dating|datsun|dealer|degree|dental|design|direct|doctor|dunlop|dupont|durban|emerck|energy|estate|events|expert|family|flickr|futbol|gallup|garden|george|giving|global|google|gratis|health|hermes|hiphop|hockey|hotels|hughes|imamat|insure|intuit|jaguar|joburg|juegos|kaufen|kinder|kindle|kosher|lancia|latino|lawyer|lefrak|living|locker|london|luxury|madrid|maison|makeup|market|mattel|mobile|monash|mormon|moscow|museum|mutual|nagoya|natura|nissan|nissay|norton|nowruz|office|olayan|online|oracle|orange|otsuka|pfizer|photos|physio|pictet|quebec|racing|realty|reisen|repair|report|review|rocher|rogers|ryukyu|safety|sakura|sanofi|school|schule|search|secure|select|shouji|soccer|social|stream|studio|supply|suzuki|swatch|sydney|taipei|taobao|target|tattoo|tennis|tienda|tjmaxx|tkmaxx|toyota|travel|unicom|viajes|viking|villas|virgin|vision|voting|voyage|vuelos|walter|webcam|xihuan|yachts|yandex|zappos|\u043c\u043e\u0441\u043a\u0432\u0430|\u043e\u043d\u043b\u0430\u0439\u043d|\u0627\u0628\u0648\u0638\u0628\u064a|\u0627\u0631\u0627\u0645\u0643\u0648|\u0627\u0644\u0627\u0631\u062f\u0646|\u0627\u0644\u0645\u063a\u0631\u0628|\u0627\u0645\u0627\u0631\u0627\u062a|\u0641\u0644\u0633\u0637\u064a\u0646|\u0645\u0644\u064a\u0633\u064a\u0627|\u092d\u093e\u0930\u0924\u092e\u094d|\u0b87\u0bb2\u0b99\u0bcd\u0b95\u0bc8|\u30d5\u30a1\u30c3\u30b7\u30e7\u30f3|actor|adult|aetna|amfam|amica|apple|archi|audio|autos|azure|baidu|beats|bible|bingo|black|boats|bosch|build|canon|cards|chase|cheap|cisco|citic|click|cloud|coach|codes|crown|cymru|dabur|dance|deals|delta|drive|dubai|earth|edeka|email|epson|faith|fedex|final|forex|forum|gallo|games|gifts|gives|glass|globo|gmail|green|gripe|group|gucci|guide|homes|honda|horse|house|hyatt|ikano|irish|jetzt|koeln|kyoto|lamer|lease|legal|lexus|lilly|linde|lipsy|loans|locus|lotte|lotto|macys|mango|media|miami|money|movie|music|nexus|nikon|ninja|nokia|nowtv|omega|osaka|paris|parts|party|phone|photo|pizza|place|poker|praxi|press|prime|promo|quest|radio|rehab|reise|ricoh|rocks|rodeo|rugby|salon|sener|seven|sharp|shell|shoes|skype|sling|smart|smile|solar|space|sport|stada|store|study|style|sucks|swiss|tatar|tires|tirol|tmall|today|tokyo|tools|toray|total|tours|trade|trust|tunes|tushu|ubank|vegas|video|vodka|volvo|wales|watch|weber|weibo|works|world|xerox|yahoo|\u05d9\u05e9\u05e8\u05d0\u05dc|\u0627\u06cc\u0631\u0627\u0646|\u0628\u0627\u0632\u0627\u0631|\u0628\u06be\u0627\u0631\u062a|\u0633\u0648\u062f\u0627\u0646|\u0633\u0648\u0631\u064a\u0629|\u0647\u0645\u0631\u0627\u0647|\u092d\u093e\u0930\u094b\u0924|\u0938\u0902\u0917\u0920\u0928|\u09ac\u09be\u0982\u09b2\u09be|\u0c2d\u0c3e\u0c30\u0c24\u0c4d|\u0d2d\u0d3e\u0d30\u0d24\u0d02|\u5609\u91cc\u5927\u9152\u5e97|aarp|able|adac|aero|akdn|ally|amex|arab|army|arpa|arte|asda|asia|audi|auto|baby|band|bank|bbva|beer|best|bike|bing|blog|blue|bofa|bond|book|buzz|cafe|call|camp|care|cars|casa|case|cash|cbre|cern|chat|citi|city|club|cool|coop|cyou|data|date|dclk|deal|dell|desi|diet|dish|docs|dvag|erni|fage|fail|fans|farm|fast|fiat|fido|film|fire|fish|flir|food|ford|free|fund|game|gbiz|gent|ggee|gift|gmbh|gold|golf|goog|guge|guru|hair|haus|hdfc|help|here|hgtv|host|hsbc|icbc|ieee|imdb|immo|info|itau|java|jeep|jobs|jprs|kddi|kids|kiwi|kpmg|kred|land|lego|lgbt|lidl|life|like|limo|link|live|loan|loft|love|ltda|luxe|maif|meet|meme|menu|mini|mint|mobi|moda|moto|name|navy|news|next|nico|nike|ollo|open|page|pars|pccw|pics|ping|pink|play|plus|pohl|porn|post|prod|prof|qpon|read|reit|rent|rest|rich|room|rsvp|ruhr|safe|sale|sarl|save|saxo|scot|seat|seek|sexy|shaw|shia|shop|show|silk|sina|site|skin|sncf|sohu|song|sony|spot|star|surf|talk|taxi|team|tech|teva|tiaa|tips|town|toys|tube|vana|visa|viva|vivo|vote|voto|wang|weir|wien|wiki|wine|work|xbox|yoga|zara|zero|zone|\u0434\u0435\u0442\u0438|\u0441\u0430\u0439\u0442|\u0628\u0627\u0631\u062a|\u0628\u064a\u062a\u0643|\u0680\u0627\u0631\u062a|\u062a\u0648\u0646\u0633|\u0634\u0628\u0643\u0629|\u0639\u0631\u0627\u0642|\u0639\u0645\u0627\u0646|\u0645\u0648\u0642\u0639|\u092d\u093e\u0930\u0924|\u09ad\u09be\u09b0\u09a4|\u09ad\u09be\u09f0\u09a4|\u0a2d\u0a3e\u0a30\u0a24|\u0aad\u0abe\u0ab0\u0aa4|\u0b2d\u0b3e\u0b30\u0b24|\u0cad\u0cbe\u0cb0\u0ca4|\u0dbd\u0d82\u0d9a\u0dcf|\u30a2\u30de\u30be\u30f3|\u30b0\u30fc\u30b0\u30eb|\u30af\u30e9\u30a6\u30c9|\u30dd\u30a4\u30f3\u30c8|\u7ec4\u7ec7\u673a\u6784|\u96fb\u8a0a\u76c8\u79d1|\u9999\u683c\u91cc\u62c9|aaa|abb|abc|aco|ads|aeg|afl|aig|anz|aol|app|art|aws|axa|bar|bbc|bbt|bcg|bcn|bet|bid|bio|biz|bms|bmw|bom|boo|bot|box|buy|bzh|cab|cal|cam|car|cat|cba|cbn|cbs|ceo|cfa|cfd|com|cpa|crs|dad|day|dds|dev|dhl|diy|dnp|dog|dot|dtv|dvr|eat|eco|edu|esq|eus|fan|fit|fly|foo|fox|frl|ftr|fun|fyi|gal|gap|gay|gdn|gea|gle|gmo|gmx|goo|gop|got|gov|hbo|hiv|hkt|hot|how|ibm|ice|icu|ifm|inc|ing|ink|int|ist|itv|jcb|jio|jll|jmp|jnj|jot|joy|kfh|kia|kim|kpn|krd|lat|law|lds|llc|llp|lol|lpl|ltd|man|map|mba|med|men|mil|mit|mlb|mls|mma|moe|moi|mom|mov|msd|mtn|mtr|nab|nba|nec|net|new|nfl|ngo|nhk|now|nra|nrw|ntt|nyc|obi|one|ong|onl|ooo|org|ott|ovh|pay|pet|phd|pid|pin|pnc|pro|pru|pub|pwc|red|ren|ril|rio|rip|run|rwe|sap|sas|sbi|sbs|sca|scb|ses|sew|sex|sfr|ski|sky|soy|spa|srl|stc|tab|tax|tci|tdk|tel|thd|tjx|top|trv|tui|tvs|ubs|uno|uol|ups|vet|vig|vin|vip|wed|win|wme|wow|wtc|wtf|xin|xxx|xyz|you|yun|zip|\u0431\u0435\u043b|\u043a\u043e\u043c|\u049b\u0430\u0437|\u043c\u043a\u0434|\u043c\u043e\u043d|\u043e\u0440\u0433|\u0440\u0443\u0441|\u0441\u0440\u0431|\u0443\u043a\u0440|\u0570\u0561\u0575|\u05e7\u05d5\u05dd|\u0639\u0631\u0628|\u0642\u0637\u0631|\u0643\u0648\u0645|\u0645\u0635\u0631|\u0915\u0949\u092e|\u0928\u0947\u091f|\u0e04\u0e2d\u0e21|\u0e44\u0e17\u0e22|\u0ea5\u0eb2\u0ea7|\u30b9\u30c8\u30a2|\u30bb\u30fc\u30eb|\u307f\u3093\u306a|\u4e2d\u6587\u7f51|\u4e9a\u9a6c\u900a|\u5929\u4e3b\u6559|\u6211\u7231\u4f60|\u65b0\u52a0\u5761|\u6de1\u9a6c\u9521|\u8bfa\u57fa\u4e9a|\u98de\u5229\u6d66|ac|ad|ae|af|ag|ai|al|am|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|\u03b5\u03bb|\u03b5\u03c5|\u0431\u0433|\u0435\u044e|\u0440\u0444|\u10d2\u10d4|\ub2f7\ub137|\ub2f7\ucef4|\uc0bc\uc131|\ud55c\uad6d|\u30b3\u30e0|\u4e16\u754c|\u4e2d\u4fe1|\u4e2d\u56fd|\u4e2d\u570b|\u4f01\u4e1a|\u4f5b\u5c71|\u4fe1\u606f|\u5065\u5eb7|\u516b\u5366|\u516c\u53f8|\u516c\u76ca|\u53f0\u6e7e|\u53f0\u7063|\u5546\u57ce|\u5546\u5e97|\u5546\u6807|\u5609\u91cc|\u5728\u7ebf|\u5927\u62ff|\u5a31\u4e50|\u5bb6\u96fb|\u5e7f\u4e1c|\u5fae\u535a|\u6148\u5584|\u624b\u673a|\u62db\u8058|\u653f\u52a1|\u653f\u5e9c|\u65b0\u95fb|\u65f6\u5c1a|\u66f8\u7c4d|\u673a\u6784|\u6e38\u620f|\u6fb3\u9580|\u70b9\u770b|\u79fb\u52a8|\u7f51\u5740|\u7f51\u5e97|\u7f51\u7ad9|\u7f51\u7edc|\u8054\u901a|\u8c37\u6b4c|\u8d2d\u7269|\u901a\u8ca9|\u96c6\u56e2|\u98df\u54c1|\u9910\u5385|\u9999\u6e2f)/,MX=new RegExp("[".concat(Ur,"!#$%&'*+/=?^_`{|}~-]")),DX=new RegExp("^".concat(qR.source,"$")),XR=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.localPartCharRegex=MX,e.strictTldRegex=DX,e}return Xl(n,t),n.prototype.parseMatches=function(e){for(var i=this.tagBuilder,r=this.localPartCharRegex,o=this.strictTldRegex,s=[],a=e.length,c=new CC,u={m:"a",a:"i",i:"l",l:"t",t:"o",o:":"},f=0,b=0,C=c;f<a;){var x=e.charAt(f);switch(b){case 0:"m"===(rt=x)?Ee(1):r.test(rt)&&Ee();break;case 1:U(e.charAt(f-1),x);break;case 2:W(x);break;case 3:K(x);break;case 4:$(x);break;case 5:ge(x);break;case 6:ye(x);break;case 7:lt(x);break;default:eS(b)}f++}var rt;return ft(),s;function U(rt,ht){":"===rt?r.test(ht)?(b=2,C=new CC(qr(qr({},C),{hasMailtoPrefix:!0}))):Be():u[rt]===ht||(r.test(ht)?b=2:"."===ht?b=3:"@"===ht?b=4:Be())}function W(rt){"."===rt?b=3:"@"===rt?b=4:r.test(rt)||Be()}function K(rt){"."===rt||"@"===rt?Be():r.test(rt)?b=2:Be()}function $(rt){yC.test(rt)?b=5:Be()}function ge(rt){"."===rt?b=7:"-"===rt?b=6:yC.test(rt)||ft()}function ye(rt){"-"===rt||"."===rt?ft():yC.test(rt)?b=5:ft()}function lt(rt){"."===rt||"-"===rt?ft():yC.test(rt)?(b=5,C=new CC(qr(qr({},C),{hasDomainDot:!0}))):ft()}function Ee(rt){void 0===rt&&(rt=2),b=rt,C=new CC({idx:f})}function Be(){b=0,C=c}function ft(){if(C.hasDomainDot){var rt=e.slice(C.idx,f);/[-.]$/.test(rt)&&(rt=rt.slice(0,-1));var ht=C.hasMailtoPrefix?rt.slice(7):rt;(function xt(pt){var ln=(pt.split(".").pop()||"").toLowerCase();return o.test(ln)})(ht)&&s.push(new HR({tagBuilder:i,matchedText:rt,offset:C.idx,email:ht}))}Be()}},n}(Zg),CC=function(){return function t(n){void 0===n&&(n={}),this.idx=void 0!==n.idx?n.idx:-1,this.hasMailtoPrefix=!!n.hasMailtoPrefix,this.hasDomainDot=!!n.hasDomainDot}}(),kX=function(){function t(){}return t.isValid=function(n,e){return!(e&&!this.isValidUriScheme(e)||this.urlMatchDoesNotHaveProtocolOrDot(n,e)||this.urlMatchDoesNotHaveAtLeastOneWordChar(n,e)&&!this.isValidIpAddress(n)||this.containsMultipleDots(n))},t.isValidIpAddress=function(n){var e=new RegExp(this.hasFullProtocolRegex.source+this.ipRegex.source);return null!==n.match(e)},t.containsMultipleDots=function(n){var e=n;return this.hasFullProtocolRegex.test(n)&&(e=n.split("://")[1]),e.split("/")[0].indexOf("..")>-1},t.isValidUriScheme=function(n){var e=n.match(this.uriSchemeRegex),i=e&&e[0].toLowerCase();return"javascript:"!==i&&"vbscript:"!==i},t.urlMatchDoesNotHaveProtocolOrDot=function(n,e){return!(!n||e&&this.hasFullProtocolRegex.test(e)||-1!==n.indexOf("."))},t.urlMatchDoesNotHaveAtLeastOneWordChar=function(n,e){return!(!n||!e||this.hasFullProtocolRegex.test(e)||this.hasWordCharAfterProtocolRegex.test(n))},t.hasFullProtocolRegex=/^[A-Za-z][-.+A-Za-z0-9]*:\/\//,t.uriSchemeRegex=/^[A-Za-z][-.+A-Za-z0-9]*:/,t.hasWordCharAfterProtocolRegex=new RegExp(":[^\\s]*?["+$R+"]"),t.ipRegex=/[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?(:[0-9]*)?\/?$/,t}(),OX=(e=new RegExp("[/?#](?:["+Ur+"\\-+&@#/%=~_()|'$*\\[\\]{}?!:,.;^\u2713]*["+Ur+"\\-+&@#/%=~_()|'$*\\[\\]{}\u2713])?"),new RegExp(["(?:","(",/(?:[A-Za-z][-.+A-Za-z0-9]{0,63}:(?![A-Za-z][-.+A-Za-z0-9]{0,63}:\/\/)(?!\d+\/?)(?:\/\/)?)/.source,rS(2),")","|","(","(//)?",/(?:www\.)/.source,rS(6),")","|","(","(//)?",rS(10)+"\\.",qR.source,"(?![-"+IX+"])",")",")","(?::[0-9]+)?","(?:"+e.source+")?"].join(""),"gi")),AX=new RegExp("["+Ur+"]"),KR=function(t){function n(e){var i=t.call(this,e)||this;return i.stripPrefix={scheme:!0,www:!0},i.stripTrailingSlash=!0,i.decodePercentEncoding=!0,i.matcherRegex=OX,i.wordCharRegExp=AX,i.stripPrefix=e.stripPrefix,i.stripTrailingSlash=e.stripTrailingSlash,i.decodePercentEncoding=e.decodePercentEncoding,i}return Xl(n,t),n.prototype.parseMatches=function(e){for(var u,i=this.matcherRegex,r=this.stripPrefix,o=this.stripTrailingSlash,s=this.decodePercentEncoding,a=this.tagBuilder,c=[],f=function(){var C=u[0],x=u[1],M=u[4],K=u.index,$=u[5]||u[9],ge=e.charAt(K-1);if(!kX.isValid(C,x)||K>0&&"@"===ge||K>0&&$&&b.wordCharRegExp.test(ge))return"continue";if(/\?$/.test(C)&&(C=C.substr(0,C.length-1)),b.matchHasUnbalancedClosingParen(C))C=C.substr(0,C.length-1);else{var ye=b.matchHasInvalidCharAfterTld(C,x);ye>-1&&(C=C.substr(0,ye))}var lt=["http://","https://"].find(function(rt){return!!x&&-1!==x.indexOf(rt)});if(lt){var Ee=C.indexOf(lt);C=C.substr(Ee),x=x.substr(Ee),K+=Ee}c.push(new WR({tagBuilder:a,matchedText:C,offset:K,urlMatchType:x?"scheme":M?"www":"tld",url:C,protocolUrlMatch:!!x,protocolRelativeMatch:!!$,stripPrefix:r,stripTrailingSlash:o,decodePercentEncoding:s}))},b=this;null!==(u=i.exec(e));)f();return c},n.prototype.matchHasUnbalancedClosingParen=function(e){var r,i=e.charAt(e.length-1);if(")"===i)r="(";else if("]"===i)r="[";else{if("}"!==i)return!1;r="{"}for(var o=0,s=0,a=e.length-1;s<a;s++){var c=e.charAt(s);c===r?o++:c===i&&(o=Math.max(o-1,0))}return 0===o},n.prototype.matchHasInvalidCharAfterTld=function(e,i){if(!e)return-1;var r=0;i&&(r=e.indexOf(":"),e=e.slice(r));var s=new RegExp("^((.?//)?[-."+Ur+"]*[-"+Ur+"]\\.[-"+Ur+"]+)").exec(e);return null===s?-1:(r+=s[1].length,e=e.slice(s[1].length),/^[^-.A-Za-z0-9:\/?#]/.test(e)?r:-1)},n}(Zg),QR=new RegExp("[_".concat(Ur,"]")),JR=function(t){function n(e){var i=t.call(this,e)||this;return i.serviceName="twitter",i.serviceName=e.serviceName,i}return Xl(n,t),n.prototype.parseMatches=function(e){for(var i=this.tagBuilder,r=this.serviceName,o=[],s=e.length,a=0,c=-1,u=0;a<s;){var f=e.charAt(a);switch(u){case 0:"#"===(W=f)?(u=2,c=a):hb.test(W)&&(u=1);break;case 1:C(f);break;case 2:x(f);break;case 3:M(f);break;default:eS(u)}a++}var W;return U(),o;function C(W){hb.test(W)||(u=0)}function x(W){u=QR.test(W)?3:hb.test(W)?1:0}function M(W){QR.test(W)||(U(),c=-1,u=hb.test(W)?1:0)}function U(){if(c>-1&&a-c<=140){var W=e.slice(c,a),K=new VR({tagBuilder:i,matchedText:W,offset:c,serviceName:r,hashtag:W.slice(1)});o.push(K)}}},n}(Zg),PX=["twitter","facebook","instagram","tiktok"],RX=new RegExp("".concat(/(?:(?:(?:(\+)?\d{1,3}[-\040.]?)?\(?\d{3}\)?[-\040.]?\d{3}[-\040.]?\d{4})|(?:(\+)(?:9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)[-\040.]?(?:\d[-\040.]?){6,12}\d+))([,;]+[0-9]+#?)*/.source,"|").concat(/(0([1-9]{1}-?[1-9]\d{3}|[1-9]{2}-?\d{3}|[1-9]{2}\d{1}-?\d{2}|[1-9]{2}\d{2}-?\d{1})-?\d{4}|0[789]0-?\d{4}-?\d{4}|050-?\d{4}-?\d{4})/.source),"g"),e4=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.matcherRegex=RX,e}return Xl(n,t),n.prototype.parseMatches=function(e){for(var s,i=this.matcherRegex,r=this.tagBuilder,o=[];null!==(s=i.exec(e));){var a=s[0],c=a.replace(/[^0-9,;#]/g,""),u=!(!s[1]&&!s[2]),f=0==s.index?"":e.substr(s.index-1,1),b=e.substr(s.index+a.length,1),C=!f.match(/\d/)&&!b.match(/\d/);this.testMatch(s[3])&&this.testMatch(a)&&C&&o.push(new GR({tagBuilder:r,matchedText:a,offset:s.index,number:c,plusSign:u}))}return o},n.prototype.testMatch=function(e){return CX.test(e)},n}(Zg),LX=new RegExp("@[_".concat(Ur,"]{1,50}(?![_").concat(Ur,"])"),"g"),BX=new RegExp("@[_.".concat(Ur,"]{1,30}(?![_").concat(Ur,"])"),"g"),UX=new RegExp("@[-_.".concat(Ur,"]{1,50}(?![-_").concat(Ur,"])"),"g"),zX=new RegExp("@[_.".concat(Ur,"]{1,23}[_").concat(Ur,"](?![_").concat(Ur,"])"),"g"),HX=new RegExp("[^"+Ur+"]"),t4=function(t){function n(e){var i=t.call(this,e)||this;return i.serviceName="twitter",i.matcherRegexes={twitter:LX,instagram:BX,soundcloud:UX,tiktok:zX},i.nonWordCharRegex=HX,i.serviceName=e.serviceName,i}return Xl(n,t),n.prototype.parseMatches=function(e){var c,i=this.serviceName,r=this.matcherRegexes[this.serviceName],o=this.nonWordCharRegex,s=this.tagBuilder,a=[];if(!r)return a;for(;null!==(c=r.exec(e));){var u=c.index,f=e.charAt(u-1);if(0===u||o.test(f)){var b=c[0].replace(/\.+$/g,""),C=b.slice(1);a.push(new jR({tagBuilder:s,matchedText:b,offset:u,serviceName:i,mention:C}))}}return a},n}(Zg);var Uc=function(){return function t(n){void 0===n&&(n={}),this.idx=void 0!==n.idx?n.idx:-1,this.type=n.type||"tag",this.name=n.name||"",this.isOpening=!!n.isOpening,this.isClosing=!!n.isClosing}}(),jX=function(){function t(n){void 0===n&&(n={}),this.version=t.version,this.urls={},this.email=!0,this.phone=!0,this.hashtag=!1,this.mention=!1,this.newWindow=!0,this.stripPrefix={scheme:!0,www:!0},this.stripTrailingSlash=!0,this.decodePercentEncoding=!0,this.truncate={length:0,location:"end"},this.className="",this.replaceFn=null,this.context=void 0,this.sanitizeHtml=!1,this.matchers=null,this.tagBuilder=null,this.urls=this.normalizeUrlsCfg(n.urls),this.email="boolean"==typeof n.email?n.email:this.email,this.phone="boolean"==typeof n.phone?n.phone:this.phone,this.hashtag=n.hashtag||this.hashtag,this.mention=n.mention||this.mention,this.newWindow="boolean"==typeof n.newWindow?n.newWindow:this.newWindow,this.stripPrefix=this.normalizeStripPrefixCfg(n.stripPrefix),this.stripTrailingSlash="boolean"==typeof n.stripTrailingSlash?n.stripTrailingSlash:this.stripTrailingSlash,this.decodePercentEncoding="boolean"==typeof n.decodePercentEncoding?n.decodePercentEncoding:this.decodePercentEncoding,this.sanitizeHtml=n.sanitizeHtml||!1;var e=this.mention;if(!1!==e&&-1===["twitter","instagram","soundcloud","tiktok"].indexOf(e))throw new Error("invalid `mention` cfg '".concat(e,"' - see docs"));var i=this.hashtag;if(!1!==i&&-1===PX.indexOf(i))throw new Error("invalid `hashtag` cfg '".concat(i,"' - see docs"));this.truncate=this.normalizeTruncateCfg(n.truncate),this.className=n.className||this.className,this.replaceFn=n.replaceFn||this.replaceFn,this.context=n.context||this}return t.link=function(n,e){return new t(e).link(n)},t.parse=function(n,e){return new t(e).parse(n)},t.prototype.normalizeUrlsCfg=function(n){return null==n&&(n=!0),"boolean"==typeof n?{schemeMatches:n,wwwMatches:n,tldMatches:n}:{schemeMatches:"boolean"!=typeof n.schemeMatches||n.schemeMatches,wwwMatches:"boolean"!=typeof n.wwwMatches||n.wwwMatches,tldMatches:"boolean"!=typeof n.tldMatches||n.tldMatches}},t.prototype.normalizeStripPrefixCfg=function(n){return null==n&&(n=!0),"boolean"==typeof n?{scheme:n,www:n}:{scheme:"boolean"!=typeof n.scheme||n.scheme,www:"boolean"!=typeof n.www||n.www}},t.prototype.normalizeTruncateCfg=function(n){return"number"==typeof n?{length:n,location:"end"}:function pX(t,n){for(var e in n)n.hasOwnProperty(e)&&void 0===t[e]&&(t[e]=n[e]);return t}(n||{},{length:Number.POSITIVE_INFINITY,location:"end"})},t.prototype.parse=function(n){var e=this,i=["a","style","script"],r=0,o=[];return function VX(t,n){for(var e=n.onOpenTag,i=n.onCloseTag,r=n.onText,o=n.onComment,s=n.onDoctype,a=new Uc,c=0,u=t.length,f=0,b=0,C=a;c<u;){var x=t.charAt(c);switch(f){case 0:"<"===x&&yn();break;case 1:"!"===(Nt=x)?f=13:"/"===Nt?(f=2,C=new Uc(qr(qr({},C),{isClosing:!0}))):"<"===Nt?yn():nS.test(Nt)?(f=3,C=new Uc(qr(qr({},C),{isOpening:!0}))):(f=0,C=a);break;case 2:K(x);break;case 3:W(x);break;case 4:$(x);break;case 5:ge(x);break;case 6:ye(x);break;case 7:lt(x);break;case 8:Ee(x);break;case 9:Be(x);break;case 10:ft(x);break;case 11:rt(x);break;case 12:ht(x);break;case 13:"--"===t.substr(c,2)?(c+=2,C=new Uc(qr(qr({},C),{type:"comment"})),f=14):"DOCTYPE"===t.substr(c,7).toUpperCase()?(c+=7,C=new Uc(qr(qr({},C),{type:"doctype"})),f=20):St();break;case 14:pt(x);break;case 15:Qt(x);break;case 16:ln(x);break;case 17:Mn(x);break;case 18:gt(x);break;case 19:Wt(x);break;case 20:Gt(x);break;default:eS(f)}c++}var Nt;function W(Nt){Df.test(Nt)?(C=new Uc(qr(qr({},C),{name:Ir()})),f=4):"<"===Nt?yn():"/"===Nt?(C=new Uc(qr(qr({},C),{name:Ir()})),f=12):">"===Nt?(C=new Uc(qr(qr({},C),{name:Ir()})),Di()):!nS.test(Nt)&&!yX.test(Nt)&&":"!==Nt&&St()}function K(Nt){">"===Nt?St():nS.test(Nt)?f=3:St()}function $(Nt){Df.test(Nt)||("/"===Nt?f=12:">"===Nt?Di():"<"===Nt?yn():"="===Nt||iS.test(Nt)||xX.test(Nt)?St():f=5)}function ge(Nt){Df.test(Nt)?f=6:"/"===Nt?f=12:"="===Nt?f=7:">"===Nt?Di():"<"===Nt?yn():iS.test(Nt)&&St()}function ye(Nt){Df.test(Nt)||("/"===Nt?f=12:"="===Nt?f=7:">"===Nt?Di():"<"===Nt?yn():iS.test(Nt)?St():f=5)}function lt(Nt){Df.test(Nt)||('"'===Nt?f=8:"'"===Nt?f=9:/[>=`]/.test(Nt)?St():"<"===Nt?yn():f=10)}function Ee(Nt){'"'===Nt&&(f=11)}function Be(Nt){"'"===Nt&&(f=11)}function ft(Nt){Df.test(Nt)?f=4:">"===Nt?Di():"<"===Nt&&yn()}function rt(Nt){Df.test(Nt)?f=4:"/"===Nt?f=12:">"===Nt?Di():"<"===Nt?yn():(f=4,function gi(){c--}())}function ht(Nt){">"===Nt?(C=new Uc(qr(qr({},C),{isClosing:!0})),Di()):f=4}function pt(Nt){"-"===Nt?f=15:">"===Nt?St():f=16}function Qt(Nt){"-"===Nt?f=18:">"===Nt?St():f=16}function ln(Nt){"-"===Nt&&(f=17)}function Mn(Nt){f="-"===Nt?18:16}function gt(Nt){">"===Nt?Di():"!"===Nt?f=19:"-"===Nt||(f=16)}function Wt(Nt){"-"===Nt?f=17:">"===Nt?Di():f=16}function Gt(Nt){">"===Nt?Di():"<"===Nt&&yn()}function St(){f=0,C=a}function yn(){f=1,C=new Uc({idx:c})}function Di(){var Nt=t.slice(b,C.idx);Nt&&r(Nt,b),"comment"===C.type?o(C.idx):"doctype"===C.type?s(C.idx):(C.isOpening&&e(C.name,C.idx),C.isClosing&&i(C.name,C.idx)),St(),b=c+1}function Ir(){return t.slice(C.idx+(C.isClosing?2:1),c).toLowerCase()}b<c&&function Li(){var Nt=t.slice(b,c);r(Nt,b),b=c+1}()}(n,{onOpenTag:function(s){i.indexOf(s)>=0&&r++},onText:function(s,a){if(0===r){var u=function mX(t,n){if(!n.global)throw new Error("`splitRegex` must have the 'g' flag set");for(var r,e=[],i=0;r=n.exec(t);)e.push(t.substring(i,r.index)),e.push(r[0]),i=r.index+r[0].length;return e.push(t.substring(i)),e}(s,/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi),f=a;u.forEach(function(b,C){if(C%2==0){var x=e.parseText(b,f);o.push.apply(o,x)}f+=b.length})}},onCloseTag:function(s){i.indexOf(s)>=0&&(r=Math.max(r-1,0))},onComment:function(s){},onDoctype:function(s){}}),o=this.compactMatches(o),o=this.removeUnwantedMatches(o)},t.prototype.compactMatches=function(n){n.sort(function(c,u){return c.getOffset()-u.getOffset()});for(var e=0;e<n.length-1;){var i=n[e],r=i.getOffset(),o=i.getMatchedText().length,s=r+o;if(e+1<n.length){if(n[e+1].getOffset()===r){var a=n[e+1].getMatchedText().length>o?e:e+1;n.splice(a,1);continue}if(n[e+1].getOffset()<s){n.splice(e+1,1);continue}}e++}return n},t.prototype.removeUnwantedMatches=function(n){return this.hashtag||Mf(n,function(e){return"hashtag"===e.getType()}),this.email||Mf(n,function(e){return"email"===e.getType()}),this.phone||Mf(n,function(e){return"phone"===e.getType()}),this.mention||Mf(n,function(e){return"mention"===e.getType()}),this.urls.schemeMatches||Mf(n,function(e){return"url"===e.getType()&&"scheme"===e.getUrlMatchType()}),this.urls.wwwMatches||Mf(n,function(e){return"url"===e.getType()&&"www"===e.getUrlMatchType()}),this.urls.tldMatches||Mf(n,function(e){return"url"===e.getType()&&"tld"===e.getUrlMatchType()}),n},t.prototype.parseText=function(n,e){void 0===e&&(e=0),e=e||0;for(var i=this.getMatchers(),r=[],o=0,s=i.length;o<s;o++){for(var a=i[o].parseMatches(n),c=0,u=a.length;c<u;c++)a[c].setOffset(e+a[c].getOffset());r.push.apply(r,a)}return r},t.prototype.link=function(n){if(!n)return"";this.sanitizeHtml&&(n=n.replace(/</g,"&lt;").replace(/>/g,"&gt;"));for(var e=this.parse(n),i=[],r=0,o=0,s=e.length;o<s;o++){var a=e[o];i.push(n.substring(r,a.getOffset())),i.push(this.createMatchReturnVal(a)),r=a.getOffset()+a.getMatchedText().length}return i.push(n.substring(r)),i.join("")},t.prototype.createMatchReturnVal=function(n){var e;return this.replaceFn&&(e=this.replaceFn.call(this.context,n)),"string"==typeof e?e:!1===e?n.getMatchedText():e instanceof tS?e.toAnchorString():n.buildTag().toAnchorString()},t.prototype.getMatchers=function(){if(this.matchers)return this.matchers;var n=this.getTagBuilder(),e=[new JR({tagBuilder:n,serviceName:this.hashtag}),new XR({tagBuilder:n}),new e4({tagBuilder:n}),new t4({tagBuilder:n,serviceName:this.mention}),new KR({tagBuilder:n,stripPrefix:this.stripPrefix,stripTrailingSlash:this.stripTrailingSlash,decodePercentEncoding:this.decodePercentEncoding})];return this.matchers=e},t.prototype.getTagBuilder=function(){var n=this.tagBuilder;return n||(n=this.tagBuilder=new zR({newWindow:this.newWindow,truncate:this.truncate,className:this.className})),n},t.version="3.16.2",t.AnchorTagBuilder=zR,t.HtmlTag=tS,t.matcher={Email:XR,Hashtag:JR,Matcher:Zg,Mention:t4,Phone:e4,Url:KR},t.match={Email:HR,Hashtag:VR,Match:Yg,Mention:jR,Phone:GR,Url:WR},t}();const n4=jX,i4=n4;let yi=(()=>{class t{constructor(){this.title="\u7121\u540d\u306e\u30d1\u30cd\u30eb",this.left=0,this.top=0,this.width=100,this.height=100,this.isAbleMinimizeButton=!0,this.isAbleFullScreenButton=!0,this.isAbleCloseButton=!0,this.isAbleRotateButton=!1,this.scrollablePanel=null}static#e=this.UIPanelComponentClass=null;get isShow(){return!!this.panelComponentRef}open(e,i,r){r||(r=t.defaultParentViewContainerRef);let s=r.createComponent(t.UIPanelComponentClass,{index:r.length,injector:r.injector}),a=s.instance.content.createComponent(e);const c=s.injector.get(t);c.panelComponentRef=s,i&&(i.title&&(c.title=i.title),i.top&&(c.top=i.top),i.left&&(c.left=i.left),i.width&&(c.width=i.width),i.height&&(c.height=i.height)),s.onDestroy(()=>{c.panelComponentRef=null,s=null}),a.onDestroy(()=>{a=null});let u=s.instance,f=a.instance;return(null!=u?.ngOnChanges||null!=f?.ngOnChanges)&&queueMicrotask(()=>{a&&null!=f?.ngOnChanges&&f?.ngOnChanges({}),s&&null!=u?.ngOnChanges&&u?.ngOnChanges({})}),a.instance}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}static#t=this.\u0275fac=function(i){return new(i||t)};static#n=this.\u0275prov=nn({token:t,factory:t.\u0275fac})}return t})();class GX{constructor(n,e,i){this._resolve=n,this._reject=e,this.option=i}resolve(n){this._resolve(n),this._resolve=null}reject(n){this._reject(n),this._reject=null}}let Ei=(()=>{class t{constructor(){this.modalContext=null,this.count=0,this.title="\u7121\u540d\u306e\u30e2\u30fc\u30c0\u30eb"}static#e=this.ModalComponentClass=null;get option(){return this.modalContext?this.modalContext.option:null}get isShow(){return this.count>0}open(e,i,r){return r||(r=t.defaultParentViewContainerRef),new Promise((o,s)=>{const u=new t;u.modalContext=new GX(W=>{C&&(C.destroy(),o(W),this.count--)},W=>{C&&(C.destroy(),s(W),this.count--)},i);const b=hs.create({providers:[{provide:t,useValue:u}],parent:r.injector});let C=r.createComponent(t.ModalComponentClass,{index:r.length,injector:b}),x=C.instance.content.createComponent(e);C.onDestroy(()=>{C=null,this.count--}),x.onDestroy(()=>{x=null,this.count--}),this.count++;let M=C.instance,U=x.instance;(null!=M?.ngOnChanges||null!=U?.ngOnChanges)&&queueMicrotask(()=>{x&&U?.ngOnChanges({}),C&&M?.ngOnChanges({})})})}resolve(e){this.modalContext&&(this.modalContext.resolve(e),this.modalContext=null)}reject(e){this.modalContext&&(this.modalContext.reject(e),this.modalContext=null)}static#t=this.\u0275fac=function(i){return new(i||t)};static#n=this.\u0275prov=nn({token:t,factory:t.\u0275fac})}return t})();const WX=t=>({outer:t});function $X(t,n){if(1&t&&(p(0,"div",5)(1,"small")(2,"small"),y(3),g()(),p(4,"span",6),y(5),g(),p(6,"small"),y(7),p(8,"span",7),y(9),g()()()),2&t){const e=v();h(3),Si("",e.urlObj.protocol,"//"),h(),m("ngClass",Ke(6,WX,e.isOuter)),h(),Xe(e.urlObj.host),h(2),Xe(e.urlObj.pathname),h(2),Bd("",e.urlObj.search,"",e.urlObj.hash,"")}}function YX(t,n){if(1&t&&(p(0,"div",5),y(1),g()),2&t){const e=v();h(),Xe(e.url)}}function ZX(t,n){1&t&&(p(0,"div"),y(1,"\u3053\u306eURL\u3092\u958b\u304d\u307e\u3059\u304b\uff1f\uff08\u5225\u30a6\u30a3\u30f3\u30c9\u30a6\u3067\u958b\u304d\u307e\u3059\u3001\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u3092\u8a31\u53ef\u3057\u3066\u304f\u3060\u3055\u3044\uff09"),g())}function qX(t,n){1&t&&(p(0,"div"),y(1,"\u26a0\ufe0fURL\u304c\u4e0d\u6b63\u3067\u3059\u3002"),g())}let sa=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.url="",this.title="",this.subTitle="",this.url=i.option.url?i.option.url:"",this.title=i.option.title?i.option.title:"",this.subTitle=i.option.subTitle?i.option.subTitle:"",this.urlObj=this.isValid?new URL(this.url):null}get isValid(){return ke.validUrl(this.url.trim())}get isOuter(){return!!this.isValid&&window.location.origin!=this.urlObj.origin}ngOnInit(){Promise.resolve().then(()=>{let e="\u5916\u90e8URL\u3092\u958b\u304f";this.title?e+="\u3008"+this.title+(this.subTitle?`\uff1a${this.subTitle}`:"")+"\u3009":this.subTitle&&(e+=`\u3008${this.subTitle}\u3009`),this.modalService.title=this.panelService.title=e}),ne.register(this)}ngOnDestroy(){ne.unregister(this)}openUrl(){window.open(this.url.trim(),"_blank","noreferrer"),this.modalService.resolve(!0)}cancel(){this.modalService.resolve(!1)}static#e=this.\u0275fac=function(i){return new(i||t)(Y(yi),Y(Ei))};static#t=this.\u0275cmp=In({type:t,selectors:[["open-url"]],decls:11,vars:5,consts:[["class","url",4,"ngIf"],[1,"help"],[4,"ngIf"],["type","submit",3,"click","disabled"],["type","button",3,"click"],[1,"url"],[3,"ngClass"],[1,"opt"]],template:function(i,r){1&i&&(p(0,"div"),q(1,$X,10,8,"div",0)(2,YX,2,1,"div",0),Ge(3,"hr"),p(4,"div",1),q(5,ZX,2,0,"div",2)(6,qX,2,0,"div",2),g()(),p(7,"button",3),he("click",function(){return r.openUrl()}),y(8,"\u958b\u304f"),g(),p(9,"button",4),he("click",function(){return r.cancel()}),y(10,"\u30ad\u30e3\u30f3\u30bb\u30eb"),g()),2&i&&(h(),m("ngIf",r.isValid),h(),m("ngIf",!r.isValid),h(3),m("ngIf",r.isValid),h(),m("ngIf",!r.isValid),h(),m("disabled",!r.isValid))},dependencies:[Ni,ri],styles:[".url[_ngcontent-%COMP%]{word-break:break-all;font-size:larger}.url[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]{font-weight:700}.opt[_ngcontent-%COMP%]{color:gray;font-size:smaller}.help[_ngcontent-%COMP%]{font-size:smaller}"]})}return t})();const XX=["message"];function KX(t,n){if(1&t&&(p(0,"span")(1,"pre",2),y(2),g()()),2&t){const e=v();h(2),Xe(e.text)}}function QX(t,n){1&t&&Ge(0,"hr")}function JX(t,n){if(1&t){const e=Le();p(0,"pre",2)(1,"span",4,0),Ut(3,"safe"),he("click",function(r){return V(e),H(v(2).onLinkClick(r))}),g(),q(4,QX,1,0,"hr",1),g()}if(2&t){const e=n.$implicit,i=n.last,r=v(2);h(),m("innerHTML",zt(3,2,r.textShadwing(r.htmlEscapeLinking(e)),"html"),$r),h(3),m("ngIf",!i)}}function eK(t,n){if(1&t&&(p(0,"span"),q(1,JX,5,5,"pre",3),g()),2&t){const e=v();h(),m("ngForOf",e.text)}}let kf=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.text="",this.title="",this.shadowing="",this.stringUtil=ke}ngOnInit(){Promise.resolve().then(()=>{this.panelService.title=this.title,this.modalService.option&&null!=this.modalService.option.title&&(this.modalService.title=this.modalService.option.title?this.modalService.option.title:"",this.text=this.modalService.option.text?this.modalService.option.text:"")})}htmlEscapeLinking(e,i=!1){return i4.link(ke.escapeHtml(e),{urls:{schemeMatches:!0,wwwMatches:!0,tldMatches:!1},truncate:{length:96,location:"end"},decodePercentEncoding:i,stripPrefix:i,stripTrailingSlash:i,email:!1,phone:!1,replaceFn:function(r){if("url"==r.getType()&&ke.validUrl(r.getAnchorHref())){if(ke.sameOrigin(r.getAnchorHref()))return!0;{const o=r.buildTag();return o.setAttr("rel","noreferrer"),o.addClass("outer-link"),o}}return!1}})}textShadwing(e){if(null==e)return"";if(null==this.shadowing||""===this.shadowing)return e;const i=new RegExp(`[${this.shadowing}]`,"g");return e.replace(i,'<span style="text-shadow: #111 0 0 1px">$&</span>')}isObj(e){return"object"==typeof e}onLinkClick(e){if(e&&"A"==e.target.tagName){const i=e.target.getAttribute("href");if(!ke.sameOrigin(i))return e.preventDefault(),this.modalService.open(sa,{url:e.target.getAttribute("href")}),!1}return!0}static#e=this.\u0275fac=function(i){return new(i||t)(Y(yi),Y(Ei))};static#t=this.\u0275cmp=In({type:t,selectors:[["text-view"]],viewQuery:function(i,r){if(1&i&&Ln(XX,5),2&i){let o;Bn(o=Un())&&(r.messageElm=o.first)}},inputs:{text:"text",title:"title",shadowing:"shadowing"},decls:2,vars:2,consts:[["message",""],[4,"ngIf"],[1,"text"],["class","text",4,"ngFor","ngForOf"],[3,"click","innerHTML"]],template:function(i,r){1&i&&q(0,KX,3,1,"span",1)(1,eK,2,1,"span",1),2&i&&(m("ngIf",!r.isObj(r.text)),h(),m("ngIf",r.isObj(r.text)))},dependencies:[nr,ri,cr],styles:["[_nghost-%COMP%]{display:block}.text[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;font-size:12px;white-space:pre-wrap;margin:0;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}"]})}return t})();var Of;let Te=(()=>{class t{static#e=this.dicePick="";static#t=this.dicePut="";static#n=this.diceRoll1="";static#i=this.diceRoll2="";static#r=this.cardDraw="";static#o=this.cardPick="";static#s=this.cardPut="";static#a=this.cardShuffle="";static#l=this.piecePick="";static#c=this.piecePut="";static#u=this.blockPick="";static#d=this.blockPut="";static#h=this.lock="";static#f=this.unlock="";static#p=this.sweep="";static#g=this.puyon="";static#m=this.surprise="";static#_=this.coinToss="";static#b=this.selectionStart=""}return t})(),tt=Of=class extends eh{onStoreAdded(){super.onStoreAdded(),ne.register(this).on("SOUND_EFFECT",n=>{Je.playSoundEffect(un.instance.get(n.data))}).on("SEND_MESSAGE",n=>{let e=bt.instance.get(n.data.messageIdentifier);!e||!e.isSendFromSelf||e.isEmptyDice||(Math.random()<.5?Of.play(Te.diceRoll1):Of.play(Te.diceRoll2))})}onStoreRemoved(){super.onStoreRemoved(),ne.unregister(this)}play(n){Of.play(n)}static play(n){let e="";e="string"==typeof n?n:n.identifier,Of._play(e)}static _play(n){ne.call("SOUND_EFFECT",n)}static playLocal(n){let e="";e="string"==typeof n?n:n.identifier,Of._playLocal(e)}static _playLocal(n){ne.trigger("SOUND_EFFECT",n)}};var fb;tt=Of=He([ir("sound-effect")],tt);let ui=fb=class extends xr{constructor(){super(...arguments),this.imageIdentifier="",this.tag="",this.hide=!1}get words(){return(null==this.tag||""==this.tag.trim())&&(this.tag=""),""===this.tag.trim()?[]:(this.tag=ke.toHalfWidth(this.tag).toLowerCase(),this.tag.trim().split(/\s+/))}containsWords(n,e=!0){if("string"==typeof n&&(n=n.trim().split(/\s+/)),0==n.length)return!1;if(n=n.concat(),e){for(const i of n)if(` ${this.tag} `.indexOf(` ${ke.toHalfWidth(i).toLowerCase()} `)>=0)return!0;return!1}for(const i of n)if(` ${this.tag} `.indexOf(` ${ke.toHalfWidth(i).toLowerCase()} `)<0)return!1;return!0}addWords(n){"string"==typeof n&&(n=n.trim().split(/\s+/)),n=n.concat();const e=Array.from(new Set(n.map(i=>ke.toHalfWidth(i).toLowerCase())));return this.tag=Array.from(new Set(e.concat(this.words))).sort().join(" "),ne.call("OPERATE_IMAGE_TAGS",this.identifier),e}removeWords(n){"string"==typeof n&&(n=n.trim().split(/\s+/)),n=n.concat();const e=Array.from(new Set(n.map(i=>ke.toHalfWidth(i).toLowerCase())));return this.tag=this.words.filter(i=>!e.includes(ke.toHalfWidth(i).toLowerCase())).sort().join(" "),ne.call("OPERATE_IMAGE_TAGS",this.identifier),e}static get(n){return bt.instance.get(`imagetag_${n}`)}static create(n){const e=new fb(`imagetag_${n}`);return e.imageIdentifier=n,e.initialize(),e}parseInnerXml(n){let e=fb.get(this.imageIdentifier);e||(e=fb.create(this.imageIdentifier));const i=e.toContext();i.syncData=this.toContext().syncData,e.apply(i),e.update(),this.destroy()}};var Af;He([ct()],ui.prototype,"imageIdentifier",void 0),He([ct()],ui.prototype,"tag",void 0),He([ct()],ui.prototype,"hide",void 0),ui=fb=He([ir("image-tag")],ui);let Rs=Af=class extends xr{constructor(){super(...arguments),this.identifiers=[]}static searchImages(n,e,i,r){"string"==typeof n&&(n=n.trim().split(/\s+/));const o=Af.allImagesOwnWords(r);return n=n.filter(a=>o.includes(a)),this.allImages(r).filter(a=>{const c=ui.get(a.identifier);return e&&(i||0===n.length)&&(!c||null==c.tag||""===c.tag.trim())||(!e||i)&&c&&c.containsWords(n,i)})}static allImages(n){return on.instance.images.filter(i=>{if(n)return!0;const r=ui.get(i.identifier);return!r||!r.hide})}static allImagesOwnWords(n){return Af.imagesOwnWords(this.allImages(n))}static imagesOwnWords(n,e=!1){if(e){if(0===n.length)return[];const i=n.map(o=>ui.get(o.identifier));if(!i[0])return[];let r=i[0].words;for(let o=1;o<i.length;o++){if(!i[o])return[];if(r=r.filter(s=>i[o].words.includes(s)),0===r.length)return r}return r.sort()}{const i=[];for(const r of n){const o=ui.get(r.identifier);o&&i.push(...o.words)}return Array.from(new Set(i)).sort()}}static countAllImagesHasWord(n,e){let i=0;if(null!=n&&""===n.trim())return i;for(const r of Af.allImages(e)){const o=ui.get(r.identifier);null==n?(!o||null==o.tag||""==o.tag.trim())&&i++:o&&o.containsWords(n.trim(),!1)&&i++}return i}static imagesIsHidden(n){for(const e of n){const i=ui.get(e.identifier);if(!i||!i.hide)return!1}return!0}static sortImagesByWords(n,e){const i=n.map(r=>{const o=ui.get(r.identifier);return{image:r,tag:o&&null!=o.tag?o.tag:""}});return i.sort((r,o)=>{let s=0;return e.some(a=>(s=Af._sortByWordCriteria(r,o,a),!!s)),s}),i.map(r=>r.image)}static _sortByWordCriteria(n,e,i){if(null==i)return""==n.tag&&""==e.tag?0:""==n.tag?-1:""==e.tag?1:0;const r=` ${n.tag} `.indexOf(` ${i} `),o=` ${e.tag} `.indexOf(` ${i} `);return-1==r&&-1==o?0:r>=0&&-1==o?-1:-1==r&&o>=0?1:0}onStoreAdded(){super.onStoreAdded(),bt.instance.remove(this)}innerXml(){return Array.from(new Set(this.identifiers)).map(n=>ui.get(n)).filter(n=>n).map(n=>n.toXml()).join("")}static create(n){const e=new Af;return e.identifiers=n.map(i=>i.identifier),e}};Rs=Af=He([ir("image-tag-list")],Rs);var Pf,r4=me(2578),o4=me(7247);!function(t){const n={avif:"image/avif",gif:"image/gif",jpg:"image/jpeg",jpeg:"image/jpeg",jpe:"image/jpeg",jfif:"image/jpeg",pjpeg:"image/jpeg",pjp:"image/jpeg",png:"image/png",apng:"image/apng",webp:"image/webp",svg:"image/svg+xml",svgz:"image/svg+xml",ico:"image/x-icon",cur:"image/x-icon",bmp:"image/bmp",html:"text/html",htm:"text/html",shtml:"text/html",xml:"text/xml",yml:"text/yaml",yaml:"text/yaml",json:"application/json",map:"application/json",zip:"application/zip",mp3:"audio/mp3",wav:"audio/wav",m4a:"audio/aac",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",mp4:"video/mp4",webm:"video/webm"};t.type=function e(r){let o=r.replace(/.*[\.\/\\]/,"").toLowerCase();return n[o]?n[o]:""},t.extension=function i(r){for(let o in n)if(n[o]===r)return o;return r.split("/")[1]}}(Pf||(Pf={}));class zc{static get instance(){return zc._instance||(zc._instance=new zc),zc._instance}constructor(){this.maxImageSize=2097152,this.maxAudioeSize=10485760,console.log("FileArchiver ready...")}initialize(){this.destroy(),this.addEventListeners()}destroy(){this.removeEventListeners()}addEventListeners(){this.removeEventListeners(),this.callbackOnDragEnter=n=>this.onDragEnter(n),this.callbackOnDragOver=n=>this.onDragOver(n),this.callbackOnDrop=n=>this.onDrop(n),document.body.addEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.addEventListener("dragover",this.callbackOnDragOver,!1),document.body.addEventListener("drop",this.callbackOnDrop,!1)}removeEventListeners(){document.body.removeEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.removeEventListener("dragover",this.callbackOnDragOver,!1),document.body.removeEventListener("drop",this.callbackOnDrop,!1),this.callbackOnDragEnter=null,this.callbackOnDragOver=null,this.callbackOnDrop=null}onDragEnter(n){n.preventDefault()}onDragOver(n){n.preventDefault()}onDrop(n){n.preventDefault(),console.log("onDrop",n.dataTransfer),this.load(n.dataTransfer.files)}load(n){var e=this;return(0,L.A)(function*(){if(!n)return;let i=n instanceof FileList?a4(n):n;for(let r of i)yield e.handleImage(r),yield e.handleAudio(r),yield e.handleText(r),yield e.handleZip(r),ne.trigger("FILE_LOADED",{file:r})})()}handleImage(n){var e=this;return(0,L.A)(function*(){if(!(n.type.indexOf("image/")<0)){if(e.maxImageSize<n.size)return void console.warn(`File size limit exceeded. -> ${n.name} (${(n.size/1024/1024).toFixed(2)}MB)`);console.log(n.name+" type:"+n.type),yield on.instance.addAsync(n)}})()}handleAudio(n){var e=this;return(0,L.A)(function*(){if(!(n.type.indexOf("audio/")<0)){if(e.maxAudioeSize<n.size)return void console.warn(`File size limit exceeded. -> ${n.name} (${(n.size/1024/1024).toFixed(2)}MB)`);console.log(n.name+" type:"+n.type),yield un.instance.addAsync(n)}})()}handleText(n){return(0,L.A)(function*(){if(!(n.type.indexOf("text/")<0)){console.log(n.name+" type:"+n.type);try{let e=Lu.xml2element(yield Ql.readAsTextAsync(n));e&&ne.trigger("XML_LOADED",{xmlElement:e})}catch(e){console.warn(e)}}})()}handleZip(n){var e=this;return(0,L.A)(function*(){if(!(0<=n.type.indexOf("application/")||n.type.length<1))return;let i=new o4;try{i=yield i.loadAsync(n)}catch(o){return void console.warn(o)}let r=[];i.forEach((o,s)=>r.push(s));for(let o of r)try{let s=yield o.async("arraybuffer");console.log(o.name+" \u89e3\u51cd..."),yield e.load([new File([s],o.name,{type:Pf.type(o.name)})])}catch(s){console.warn(s)}})()}saveAsync(n,e,i){return(0,L.A)(function*(){if(!n)return;let r=n instanceof FileList?a4(n):n,o=new o4;for(let a of r)o.file(a.name,a);let s=yield o.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}},i);(0,r4.saveAs)(s,e+".zip")})()}}function a4(t){let n=[],e=t.length;for(let i=0;i<e;i++)n.push(t[i]);return n}function tK(t,n){if(1&t&&(p(0,"i",6),y(1),g()),2&t){const e=v();h(),Xe(e.materialIcon)}}function nK(t,n){if(1&t&&(p(0,"div",7),y(1),g()),2&t){const e=v();h(),Xe(e.help)}}function iK(t,n){1&t&&(Ge(0,"div",8),Ut(1,"safe")),2&t&&m("innerHTML",zt(1,1,v().helpHtml,"html"),$r)}function rK(t,n){if(1&t){const e=Le();p(0,"button",9),he("click",function(){return V(e),H(v().cancel())}),y(1,"\u30ad\u30e3\u30f3\u30bb\u30eb"),g()}}let Fr=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.title="",this.subTitle="",this.text="",this.help="",this.helpHtml="",this.materialIcon="",this.type=ur.OK,this.action=null,this.cancelAction=null,this.title=i.option.title?i.option.title:"",this.subTitle=i.option.subTitle?i.option.subTitle:"",this.text=i.option.text?i.option.text:"",this.help=i.option.help?i.option.help:"",this.helpHtml=i.option.helpHtml?i.option.helpHtml:"",this.materialIcon=i.option.materialIcon?i.option.materialIcon:"",this.type=i.option.type?i.option.type:ur.OK,this.action=i.option.action?i.option.action:null,this.cancelAction=i.option.cancelAction?i.option.cancelAction:null}ngOnInit(){Promise.resolve().then(()=>{let e="\u78ba\u8a8d";this.title?e+="\u3008"+this.title+(this.subTitle?`\uff1a${this.subTitle}`:"")+"\u3009":this.subTitle&&(e+=`\u3008${this.subTitle}\u3009`),this.modalService.title=this.panelService.title=e}),ne.register(this)}ngOnDestroy(){ne.unregister(this)}ok(){this.modalService.resolve(!0),this.action&&this.action()}cancel(){this.modalService.resolve(!1),this.cancelAction&&this.cancelAction()}static#e=this.\u0275fac=function(i){return new(i||t)(Y(yi),Y(Ei))};static#t=this.\u0275cmp=In({type:t,selectors:[["app-confirmation"]],decls:9,vars:5,consts:[[1,"text"],["class","material-icons icon",4,"ngIf"],["class","help",4,"ngIf"],["class","help",3,"innerHTML",4,"ngIf"],["type","submit",3,"click"],["type","button",3,"click",4,"ngIf"],[1,"material-icons","icon"],[1,"help"],[1,"help",3,"innerHTML"],["type","button",3,"click"]],template:function(i,r){1&i&&(p(0,"div",0),q(1,tK,2,1,"i",1),y(2),g(),Ge(3,"hr"),q(4,nK,2,1,"div",2)(5,iK,2,4,"div",3),p(6,"button",4),he("click",function(){return r.ok()}),y(7,"\uff2f\uff2b"),g(),q(8,rK,2,0,"button",5)),2&i&&(h(),m("ngIf",r.materialIcon),h(),Xe(r.text),h(2),m("ngIf",r.help&&!r.helpHtml),h(),m("ngIf",r.helpHtml),h(3),m("ngIf",r.type>1))},dependencies:[ri,cr],styles:[".text[_ngcontent-%COMP%]{font-weight:bolder;white-space:pre-wrap;word-break:break-all}.icon[_ngcontent-%COMP%]{display:inline-block;font-size:2.5rem;vertical-align:middle;margin-right:4px;padding:2px;text-shadow:2px 2px 2px #555}.help[_ngcontent-%COMP%]{font-size:smaller;white-space:pre-wrap;word-break:break-all;margin-bottom:3px}"]})}return t})();var oS,ur=function(t){return t[t.OK=1]="OK",t[t.OK_CANCEL=2]="OK_CANCEL",t}(ur||{});let Ki=oS=class extends xr{constructor(){super(...arguments),this.toName="",this.toImageIdentifier="",this.toColor="",this.aura=-1,this.lastUpdate=0,this.isAnimated=!1,this._sendTo=[],this._tags=[],this.locale="en-US"}get tabIdentifier(){return this.parent.identifier}get text(){return this.value}set text(n){this.value=n??""}get timestamp(){let n=this.getAttribute("timestamp"),e=n?+n:0;return Number.isNaN(e)?1:e}get sendTo(){return"undefined"===this.to?(""!==this._to&&(this._to="",this._sendTo=[]),this._sendTo):(this._to!==this.to&&(this._to=this.to,this._sendTo=null!=this.to&&0<this.to.trim().length?this.to.trim().split(/\s+/):[]),this._sendTo)}get isEdited(){return this.lastUpdate>0}get tags(){return this._tag!==this.tag&&(this._tag=this.tag,this._tags=null!=this.tag&&0<this.tag.trim().length?this.tag.trim().split(/\s+/):[]),this._tags}get image(){return on.instance.get(this.imageIdentifier)}get toImage(){return on.instance.get(this.toImageIdentifier)}get index(){return this.minorIndex+this.timestamp}get isDirect(){return 0<this.sendTo.length||-1<this.tags.indexOf("direct")}get isSendFromSelf(){return this.from===jt.peer.userId||this.originFrom===jt.peer.userId||-1<this.tags.indexOf("mine")}get isSendToMe(){return-1<this.sendTo.indexOf(jt.peer.userId)}get isRelatedToMe(){return this.isSendToMe||this.isSendFromSelf||this.isGMMode}get isDisplayable(){return!this.isDirect||this.isRelatedToMe}get isSystem(){return-1<this.tags.indexOf("system")}get isDicebot(){return this.isSystem&&this.from.indexOf("Dice")>=0&&!/^C\(.+\) \u2192/i.test(this.text)}get isCalculate(){return this.isSystem&&this.from.indexOf("Dice")>=0&&/^C\(.+\) \u2192/i.test(this.text)}get isSecret(){return-1<this.tags.indexOf("secret")}get isEmptyDice(){return!this.isDicebot||-1<this.tags.indexOf("empty")}get isSpecialColor(){return this.isDirect||this.isSecret||this.isSystem||this.isOperationLog||this.isDicebot||this.isCalculate}get isEditable(){return!this.isSystem&&!this.isOperationLog&&this.from===jt.peer.userId}get isFaceIcon(){return!this.isSystem&&(!this.characterIdentifier||this.tags.indexOf("noface")<0)}get isOperationLog(){return-1<this.tags.indexOf("opelog")}get isSuccess(){return this.isDicebot&&-1<this.tags.indexOf("success")}get isFailure(){return this.isDicebot&&-1<this.tags.indexOf("failure")}get isCritical(){return this.isDicebot&&-1<this.tags.indexOf("critical")}get isFumble(){return this.isDicebot&&-1<this.tags.indexOf("fumble")}get isGMMode(){return!!Fe.myCursor&&Fe.myCursor.isGMMode}plainText(){if(this.isSecret&&!this.isSendFromSelf)return"\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09";let n=ke.rubyToText(this.text);return this.isDicebot&&(n=n.replace(/###(.+?)###/g,"*$1").replace(/\~\~\~(.+?)\~\~\~/g,"~$1")),n}logFragment(n,e=null,i="HH:mm",r=!0){return 0==n?this.logFragmentText(e,i):this.logFragmentHtml(e,i,2!=n)}logFragmentText(n=null,e="HH:mm"){n=n&&""!=n.trim()?`[${n}] `:"";const i=""==e?"":T0(new Date(this.timestamp),e,this.locale)+"\uff1a",r=this.isEdited?""==e?" (\u7de8\u96c6\u6e08)":` (\u7de8\u96c6\u6e08 ${T0(new Date(this.lastUpdate),e,this.locale)})`:"";let o=ke.rubyToText(this.text);return this.isDicebot&&(o=o.replace(/###(.+?)###/g,"*$1").replace(/\~\~\~(.+?)\~\~\~/g,"~$1")),o.lastIndexOf("\n")==o.length-1&&!r&&(o+="\n"),`${n}${i}${this.name}${this.toColor?" \u27a1 "+this.toName:""}\uff1a${this.isSecret&&!this.isSendFromSelf?"\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09":o+r}`}logFragmentHtml(n=null,e="HH:mm",i=!0){const r=ke.escapeHtml(this.color?this.color:Fe.CHAT_DEFAULT_COLOR),o=` style="color: ${r}"`,s=this.toColor?ke.escapeHtml(this.toColor):"",a=this.toColor?` style="color: ${s}"`:"",c=this.isDirect||this.isSecret?' class="grow"':"",u=n&&""!=n.trim()?`<span class="tab-name">${ke.escapeHtml(n)}</span> `:"",f=new Date(this.timestamp),b=""==e?"":`<time datetime="${f.toISOString()}">${ke.escapeHtml(T0(f,e,this.locale))}</time>\uff1a`,C=`<span${c}${o}>${ke.escapeHtml(this.name)}</span>`+(this.toColor?` \u27a1 <span${c}${a}>${ke.escapeHtml(this.toName)}</span>`:"");let x=["message"];(this.isDirect||this.isSecret)&&x.push("direct-message"),this.isSystem&&x.push("system-message"),(this.isDicebot||this.isCalculate)&&x.push("dicebot-message"),this.isOperationLog&&x.push("operation-log");let M=["msg-text"];(!this.isSecret||this.isSendFromSelf)&&(this.isSuccess&&M.push("is-success"),this.isFailure&&M.push("is-failure"),this.isCritical&&M.push("is-critical"),this.isFumble&&M.push("is-fumble"));let U=this.isSecret&&!this.isSendFromSelf?"<s>\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09</s>":n4.link(this.isOperationLog?ke.escapeHtml(this.text):ke.rubyToHtml(ke.escapeHtml(this.text)),{urls:{schemeMatches:!0,wwwMatches:!0,tldMatches:!1},truncate:{length:96,location:"end"},decodePercentEncoding:!1,stripPrefix:!1,stripTrailingSlash:!1,email:!1,phone:!1,className:"outer-link",replaceFn:function(K){return"url"==K.getType()&&ke.validUrl(K.getAnchorHref())}});this.isDicebot&&(U=oS.decorationDiceResult(U));let W="";if(this.isEdited)if(""==e)W='<span class="is-edited">\u7de8\u96c6\u6e08</span>';else{const K=new Date(this.lastUpdate);W=`<span class="is-edited"><b>\u7de8\u96c6\u6e08</b> <time datetime="${K.toISOString()}">${ke.escapeHtml(T0(K,e,this.locale))}</time></span>`}return U.lastIndexOf("\n")==U.length-1&&!W&&(U+="\n"),`<div class="${x.join(" ")}" style="border-left-color: ${r}">\n  <div class="msg-header">${u}${b}<span class="msg-name">${C}</span>\uff1a</div>\n  <div class="${M.join(" ")}"><span${this.isSpecialColor?"":o}>${U}</span>${W}</div>\n</div>`}static logCss(n=!0){return"body {\n  color: #444;\n  background-color: #FFF;\n}\n.message {\n  display: flex;\n  width: 100%;\n  word-wrap: break-word;\n  overflow-wrap: anywhere;\n  word-break: break-word;\n  border-left: 4px solid transparent;\n  margin-top: 1px;\n}\n.direct-message {\n  background-color: #555;\n  color: #CCC;\n}\n.dicebot-message .msg-text {\n  color: #11F;\n}\n.direct-message.dicebot-message .msg-text {\n  color: #CCF;\n}\n.dicebot-message .msg-text.is-success {\n  color: #17f;\n}\n.dicebot-message .msg-text.is-failure {\n  color: #F05;\n}\n.direct-message.dicebot-message .msg-text.is-success {\n  color: #adF;\n}\n.direct-message.dicebot-message .msg-text.is-failure {\n  color: #F66;\n}\n.operation-log {\n  color: #666;\n  background-color: #CCCCCCAA;\n}\n.dicebot-message .msg-name,\n.dicebot-message .msg-text,\n.operation-log .msg-name,\n.operation-log .msg-text {\n  font-style: oblique;\n}\n.tab-name {\n  display: inline-block;\n}\n.tab-name::before {\n  content: '[';\n}\n.tab-name::after {\n  content: ']';\n}\n.msg-header {\n  white-space: nowrap;\n  border-left: 1px solid #FFF;\n  padding-left: 2px;\n}\n.msg-name {\n  font-weight: bolder;\n}\n.msg-text {\n  white-space: pre-wrap;\n  width: 100%\n}\n.is-edited {\n  margin-left: 2px;\n  font-size: 8px;\n}\n.is-edited::before {\n  content: '(';\n}\n.is-edited::after {\n  content: ')';\n}\na[target=_blank] {\n  text-decoration: none;\n  word-break: break-all;\n}\na[target=_blank]:hover {\n  text-decoration: underline;\n}\na.outer-link::after {\n  margin-right: 2px;\n  margin-left: 2px;\n  font-family: 'Material Icons';\n  content: '\\e89e';\n  font-weight: bolder;\n  text-decoration: none;\n  display: inline-block;\n  font-size: smaller;\n  vertical-align: 25%;\n}\n.direct-message a[href] {\n  color: #CCF;\n}\n.direct-message a[href]:visited {\n  color: #99D;\n}\nruby {\n  ruby-align: space-between;\n}\ns.drop-dice .dropped {\n  color: #999;\n}\n.grow {\n  text-shadow: \n       1px  0px 1px #ffffff,\n       0px  1px 1px #ffffff,\n      -1px  0px 1px #ffffff,\n       0px -1px 1px #ffffff; \n}"}static decorationDiceResult(n){return n.replace(/###(.+?)###/g,'<b class="special-dice">$1</b>').replace(/\~\~\~(.+?)\~\~\~/g,'<s class="drop-dice"><span class="dropped">$1</span></s>')}};He([ct()],Ki.prototype,"originFrom",void 0),He([ct()],Ki.prototype,"from",void 0),He([ct()],Ki.prototype,"to",void 0),He([ct()],Ki.prototype,"name",void 0),He([ct()],Ki.prototype,"toName",void 0),He([ct()],Ki.prototype,"tag",void 0),He([ct()],Ki.prototype,"dicebot",void 0),He([ct()],Ki.prototype,"imageIdentifier",void 0),He([ct()],Ki.prototype,"toImageIdentifier",void 0),He([ct()],Ki.prototype,"color",void 0),He([ct()],Ki.prototype,"toColor",void 0),He([ct()],Ki.prototype,"isInverseIcon",void 0),He([ct()],Ki.prototype,"isHollowIcon",void 0),He([ct()],Ki.prototype,"isBlackPaint",void 0),He([ct()],Ki.prototype,"aura",void 0),He([ct()],Ki.prototype,"characterIdentifier",void 0),He([ct()],Ki.prototype,"standIdentifier",void 0),He([ct()],Ki.prototype,"standName",void 0),He([ct()],Ki.prototype,"isUseStandImage",void 0),He([ct()],Ki.prototype,"lastUpdate",void 0),Ki=oS=He([ir("chat")],Ki);let ih=class extends xr{constructor(){super(...arguments),this.name="\u30bf\u30d6",this.isUseStandImage=!0,this.recieveOperationLogLevel=0,this._unreadLength=0}get chatMessages(){return this.children}get unreadLength(){return this._unreadLength}get hasUnread(){return 0<this.unreadLength}get latestTimeStamp(){let n=this.chatMessages.length-1;return n<0?0:this.chatMessages[n].timestamp}onChildAdded(n){super.onChildAdded(n),n.parent===this&&n instanceof Ki&&n.isDisplayable&&(this._unreadLength++,ne.trigger("MESSAGE_ADDED",{tabIdentifier:this.identifier,messageIdentifier:n.identifier}),!n.isSendFromSelf&&!n.isOperationLog&&!n.isSystem&&ne.trigger("MESSAGE_NORTIFICATION",{tabIdentifier:this.identifier,messageIdentifier:n.identifier,isDirect:n.isDirect}))}addMessage(n){n.tabIdentifier=this.identifier;let e=new Ki;for(let i in n)if("identifier"!==i&&"tabIdentifier"!==i){if("text"===i){e.value=n[i];continue}null==n[i]||""===n[i]||e.setAttribute(i,n[i])}return e.initialize(),ne.trigger("SEND_MESSAGE",{tabIdentifier:this.identifier,messageIdentifier:e.identifier}),this.appendChild(e),e}markForRead(){this._unreadLength=0}innerXml(){let n="";for(let e of this.children)e instanceof Ki&&!e.isDisplayable||(n+=ar.instance.toXml(e));return n}parseInnerXml(n){return super.parseInnerXml(n)}log(n,e,i=!0){const r=this.chatMessages.filter(o=>o.isDisplayable&&(i||!o.isOperationLog)).sort((o,s)=>o.index-s.index).map(o=>o.logFragment(n,null,e)).join("\n");return 0==n?r:`<!DOCTYPE html>\n<html lang="ja-JP">\n<head>\n<meta charset="UTF-8">\n<title>Udonarium with Fly\uff1a\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0\uff1a${ke.escapeHtml(""==this.name?"(\u7121\u540d\u306e\u30bf\u30d6)":this.name)}</title>\n<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">\n<style>\n${Ki.logCss()}\n</style>\n</head>\n<body>\n${r}\n</body>\n</html>`}};var Sl;He([ct()],ih.prototype,"name",void 0),He([ct()],ih.prototype,"isUseStandImage",void 0),He([ct()],ih.prototype,"recieveOperationLogLevel",void 0),ih=He([ir("chat-tab")],ih);let nc=class extends xr{static#e=Sl=this;static get instance(){return Sl._instance||(Sl._instance=new Sl("ChatTabList"),Sl._instance.initialize()),Sl._instance}get chatTabs(){return this.children}addChatTab(...n){let e=null;if(n[0]instanceof ih)e=n[0];else{let i=n[0];e=new ih(n[1]),e.name=i,e.initialize()}return this.appendChild(e)}parseInnerXml(n){for(let i of Sl.instance.children)i.destroy();let e=Sl.instance.toContext();e.syncData=this.toContext().syncData,Sl.instance.apply(e),Sl.instance.update(),super.parseInnerXml.apply(Sl.instance,[n]),this.destroy()}log(n,e,i=!0){if(!this.chatTabs)return"";const r=this.chatTabs.reduce((o,s)=>(s&&o.push(...s.chatMessages.filter(a=>a.isDisplayable&&(i||!a.isOperationLog)).map(a=>({index:a.index,tabName:s.name,chatMessage:a}))),o),[]).sort((o,s)=>o.index-s.index).map(o=>o.chatMessage.logFragment(n,o.tabName,e)).join("\n");return 0==n?r:`<!DOCTYPE html>\n<html lang="ja-JP">\n<head>\n<meta charset="UTF-8">\n<title>Udonarium with Fly\uff1a\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0\uff1a\u5168\u3066\u306e\u30bf\u30d6</title>\n<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">\n<style>\n${Ki.logCss()}\n</style>\n</head>\n<body>\n${r}\n</body>\n</html>`}};nc=Sl=He([ir("chat-tab-list")],nc);class Ff{constructor(n,e,i){this.chanks=[],this.chankSize=32768,this.chankReceiveCount=0,this.sentChankIndex=0,this.bufferingChankRange=4,this.completedChankIndex=0,this.startTime=0,this.isCanceled=!1,this.identifier=n,this.sendTo=e,this.data=i}static createSendTask(n,e,i){let r=new Ff(n,e,i);return r.onstart=()=>r.initializeSend(),r}static createReceiveTask(n){let e=new Ff(n);return e.onstart=()=>e.initializeReceive(),e}start(n){this.onstart?(this.data=n,this.onstart(),this.onstart=null):console.warn("\u518d\u8d77\u52d5\u3059\u308b\u4ed5\u69d8\u306a\u3069\u7121\u3044\u3002")}progress(n,e){this.onprogress&&this.onprogress(this,n,e)}finish(){this.isCanceled||(this.isCanceled=!0,this.onfinish&&this.onfinish(this,this.data),this.dispose())}timeout(){this.isCanceled||(this.isCanceled=!0,this.ontimeout&&this.ontimeout(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}cancel(){this.isCanceled||(null!=this.sendTo&&ne.call("CANCEL_TASK_"+this.identifier,null,this.sendTo),this._cancel())}_cancel(){this.isCanceled||(this.isCanceled=!0,this.oncancel&&this.oncancel(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}dispose(){ne.unregister(this),this.sendChankTimer&&function E$(t){G0.delete(t)}(this.sendChankTimer),this.timeoutTimer&&this.timeoutTimer.clear(),this.sendChankTimer=null,this.timeoutTimer=null,this.onprogress=this.onfinish=this.ontimeout=this.oncancel=null}initializeSend(){this.uint8Array=sl.encode(this.data);let n=Math.ceil(this.uint8Array.byteLength/this.chankSize);this.chanks=new Array(n),console.log("\u30c1\u30e3\u30f3\u30af\u5206\u5272 "+this.identifier,this.chanks.length),ne.register(this).on("FILE_MORE_CHANK_"+this.identifier,e=>{this.sendTo===e.sendFrom&&(this.completedChankIndex=e.data,null==this.sendChankTimer&&this.sentChankIndex+1<this.chanks.length&&this.sendChank(this.sentChankIndex+1),this.resetTimeout())}).on("DISCONNECT_PEER",e=>{e.data.peerId===this.sendTo&&(console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,e.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,e=>{console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,e.sendFrom),this._cancel()}),this.sentChankIndex=this.completedChankIndex=0,this.startTime=performance.now(),Ns(()=>this.sendChank(0))}sendChank(n){let e=this.uint8Array.slice(n*this.chankSize,(n+1)*this.chankSize);ne.call("FILE_SEND_CHANK_"+this.identifier,{index:n,length:this.chanks.length,chank:e},this.sendTo),this.sentChankIndex=n,this.sendChankTimer=null,this.chanks.length<=n+1?(console.log("\u30d0\u30c3\u30d5\u30a1\u9001\u4fe1\u5b8c\u4e86",this.identifier),this.outputTransferRate(this.uint8Array.byteLength),Ns(()=>this.finish())):this.completedChankIndex+this.bufferingChankRange<=n?this.resetTimeout():this.sendChankTimer=Ns(()=>{this.sendChank(this.sentChankIndex+1)})}initializeReceive(){this.resetTimeout(),this.startTime=performance.now(),this.chankReceiveCount=0,ne.register(this).on("FILE_SEND_CHANK_"+this.identifier,n=>{this.chanks.length<1&&(this.chanks=new Array(n.data.length)),null==this.chanks[n.data.index]?(this.chankReceiveCount++,this.chanks[n.data.index]=n.data.chank,this.progress(n.data.index,n.data.length),this.chanks.length<=this.chankReceiveCount?this.finishReceive():(this.resetTimeout(),ne.call("FILE_MORE_CHANK_"+this.identifier,n.data.index,n.sendFrom))):console.log(`already received. [${n.data.index}] <${this.identifier}>`)}).on("DISCONNECT_PEER",n=>{n.data.peerId===this.sendTo&&(console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,n.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,n=>{console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,n.sendFrom),this._cancel()})}finishReceive(){console.log("\u30d0\u30c3\u30d5\u30a1\u53d7\u4fe1\u5b8c\u4e86",this.identifier);let n=0;for(let r of this.chanks)n+=r.byteLength;this.outputTransferRate(n);let e=new Uint8Array(n),i=0;for(let r of this.chanks)e.set(r,i),i+=r.byteLength;this.data=sl.decode(e),this.finish()}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new Nc(()=>this.timeout(),1e4)),this.timeoutTimer.reset()}outputTransferRate(n){let e=performance.now()-this.startTime,i=n/1024/1024/(e/1e3);console.log(`${(n/1024).toFixed(2)}KB ${(e/1e3).toFixed(2)}\u79d2 \u8ee2\u9001\u901f\u5ea6: ${i.toFixed(2)}MB/s`)}}class qg{static get instance(){return qg._instance||(qg._instance=new qg),qg._instance}constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4}initialize(){console.log("AudioSharingSystem ready..."),this.destroy(),ne.register(this).on("CONNECT_PEER",-1,n=>{n.isSendFromSelf&&(console.log("CONNECT_PEER AudioStorageService !!!",n.data.peerId),un.instance.synchronize())}).on("SYNCHRONIZE_AUDIO_LIST",n=>{if(n.isSendFromSelf)return;console.log("SYNCHRONIZE_AUDIO_LIST "+n.sendFrom);let e=n.data,i=[];console.log("SYNCHRONIZE_AUDIO_LIST active tasks ",this.sendTaskMap.size+this.receiveTaskMap.size);for(let o of e){let s=un.instance.get(o.identifier);null===s&&(s=al.createEmpty(o.identifier),un.instance.add(s)),s.state<Sa.COMPLETE&&!this.receiveTaskMap.has(o.identifier)&&i.push({identifier:o.identifier,state:s.state})}if(i.length<1&&!this.hasActiveTask()&&e.length<un.instance.getCatalog().length&&un.instance.synchronize(n.sendFrom),i.length<1||this.isLimitReceiveTask())return;let r=Math.floor(Math.random()*i.length);this.request([i[r]],n.sendFrom)}).on("REQUEST_AUDIO_RESOURE",n=>{if(n.isSendFromSelf)return;let e=n.data.identifiers,i=[];for(let r of e){let o=un.instance.get(r.identifier);o&&r.state<o.state&&i.push({identifier:r.identifier,state:r.state})}if(!1===this.isLimitSendTask()&&0<i.length&&!this.existsSendTask(n.data.receiver)){console.log("REQUEST_AUDIO_RESOURE Send!!! "+n.data.receiver+" -> "+i);let r=Math.floor(Math.random()*i.length),s=un.instance.get(i[r].identifier);this.startSendTask(s,n.data.receiver)}else{let r=n.data.candidatePeers,o=r.indexOf(jt.peerId);-1<o&&r.splice(o,1);for(let s of r)return console.log("REQUEST_AUDIO_RESOURE AudioStorageService Relay!!! "+s+" -> "+n.data.identifiers),void ne.call(n,s);console.log("REQUEST_FILE_RESOURE AudioStorageService \u3042\u3076\u308c\u305f..."+n.data.receiver,i.length)}}).on("UPDATE_AUDIO_RESOURE",1e3,n=>{let e=n.data;console.log("UPDATE_AUDIO_RESOURE AudioStorageService "+n.sendFrom+" -> ",e);for(let i of e)i.blob&&(i.blob=new Blob([i.blob],{type:i.type})),un.instance.add(i)}).on("START_AUDIO_TRANSMISSION",n=>{console.log("START_AUDIO_TRANSMISSION "+n.data.fileIdentifier);let e=n.data.fileIdentifier,i=un.instance.get(e);this.receiveTaskMap.has(e)||i&&Sa.COMPLETE<=i.state?(console.warn("CANCEL_TASK_ "+e),ne.call("CANCEL_TASK_"+e,null,n.sendFrom)):this.startReceiveTask(e)})}destroy(){ne.unregister(this)}startSendTask(n,e){var i=this;return(0,L.A)(function*(){let r=Ff.createSendTask(n.identifier,e);i.sendTaskMap.set(n.identifier,r),ne.call("START_AUDIO_TRANSMISSION",{fileIdentifier:n.identifier},e);let o={identifier:n.identifier,name:n.name,blob:null,type:"",url:null};n.state===Sa.URL?o.url=n.url:(o.blob=yield Ql.readAsArrayBufferAsync(n.blob),o.type=n.blob.type),r.onfinish=()=>{i.stopSendTask(r.identifier),un.instance.synchronize()},r.start(o)})()}startReceiveTask(n){let e=un.instance.get(n),i=Ff.createReceiveTask(n);this.receiveTaskMap.set(n,i),i.onprogress=(r,o,s)=>{let a=e.toContext();a.name=(100*o/s).toFixed(1)+"%",e.apply(a)},i.onfinish=(r,o)=>{this.stopReceiveTask(r.identifier),o&&ne.trigger("UPDATE_AUDIO_RESOURE",[o]),un.instance.synchronize()},i.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(n){let e=this.sendTaskMap.get(n);e&&e.cancel(),this.sendTaskMap.delete(n),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(n){let e=this.receiveTaskMap.get(n);e&&e.cancel(),this.receiveTaskMap.delete(n),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(n,e){console.log("requestFile() "+e),ne.call("REQUEST_AUDIO_RESOURE",{identifiers:n,receiver:jt.peerId,candidatePeers:jt.peerIds},e)}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(n){for(let e of this.sendTaskMap.values())if(e&&e.sendTo===n)return!0;return!1}}class Xg{static get instance(){return Xg._instance||(Xg._instance=new Xg),Xg._instance}constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4,console.log("FileSharingSystem ready...")}initialize(){var n=this;ne.register(this).on("CONNECT_PEER",1,e=>{e.isSendFromSelf&&(console.log("CONNECT_PEER ImageStorageService !!!",e.data.peerId),on.instance.synchronize())}).on("XML_LOADED",e=>{!function oK(t){let n=[],e=t.querySelectorAll('*[type="image"]');for(let i=0;i<e.length;i++){let r=e[i].innerHTML;!on.instance.get(r)&&0<Pf.type(r).length&&n.push(r)}e=t.querySelectorAll("*[imageIdentifier]");for(let i=0;i<e.length;i++){let r=e[i].getAttribute("imageIdentifier");!on.instance.get(r)&&0<Pf.type(r).length&&n.push(r)}for(let i of n)on.instance.add(i)}(e.data.xmlElement)}).on("SYNCHRONIZE_FILE_LIST",e=>{if(e.isSendFromSelf)return;console.log("SYNCHRONIZE_FILE_LIST ImageStorageService "+e.sendFrom);let i=e.data,r=[];for(let o of i){let s=on.instance.get(o.identifier);null===s&&(s=vn.createEmpty(o.identifier),on.instance.add(s)),s.state<Ri.COMPLETE&&!this.receiveTaskMap.has(o.identifier)&&r.push({identifier:o.identifier,state:s.state})}r.length<1&&!this.hasActiveTask()&&i.length<on.instance.getCatalog().length&&on.instance.synchronize(e.sendFrom),!(r.length<1||this.isLimitReceiveTask())&&this.request(r,e.sendFrom)}).on("REQUEST_FILE_RESOURE",function(){var e=(0,L.A)(function*(i){if(i.isSendFromSelf)return;let r=i.data.identifiers,o=[];for(let s of r){let a=on.instance.get(s.identifier);a&&s.state<a.state&&o.push({identifier:s.identifier,state:s.state})}if(!1===n.isLimitSendTask()&&0<o.length&&!n.existsSendTask(i.data.receiver)){let s=n.makeSendUpdateImages(o);console.log("REQUEST_FILE_RESOURE ImageStorageService Send!!! "+i.data.receiver+" -> "+s.length),n.startSendTask(s,i.data.receiver)}else{let s=i.data.candidatePeers,a=s.indexOf(jt.peerId);-1<a&&s.splice(a,1);for(let c of s)return console.log("REQUEST_FILE_RESOURE ImageStorageService Relay!!! "+c+" -> "+i.data.identifiers),void ne.call(i,c);console.log("REQUEST_FILE_RESOURE ImageStorageService \u3042\u3076\u308c\u305f..."+i.data.receiver,o.length)}});return function(i){return e.apply(this,arguments)}}()).on("UPDATE_FILE_RESOURE",1e3,e=>{let i=e.data.updateImages;console.log("UPDATE_FILE_RESOURE ImageStorageService "+e.sendFrom+" -> ",i);for(let r of i)r.blob&&(r.blob=new Blob([r.blob],{type:r.type})),r.thumbnail.blob&&(r.thumbnail.blob=new Blob([r.thumbnail.blob],{type:r.thumbnail.type})),on.instance.add(r)}).on("START_FILE_TRANSMISSION",e=>{console.log("START_FILE_TRANSMISSION "+e.data.taskIdentifier);let i=e.data.taskIdentifier,r=on.instance.get(i);this.receiveTaskMap.has(i)||r&&Ri.COMPLETE<=r.state?(console.warn("CANCEL_TASK_ "+i),ne.call("CANCEL_TASK_"+i,null,e.sendFrom)):this.startReceiveTask(i)})}destroy(){ne.unregister(this)}startSendTask(n,e){var i=this;return(0,L.A)(function*(){let r=1===n.length?n[0].identifier:oa.generateUuid(),o=Ff.createSendTask(r,e);i.sendTaskMap.set(o.identifier,o),ne.call("START_FILE_TRANSMISSION",{taskIdentifier:r},e);for(let s of n)s.thumbnail.blob?s.thumbnail.blob=yield Ql.readAsArrayBufferAsync(s.thumbnail.blob):s.blob&&(s.blob=yield Ql.readAsArrayBufferAsync(s.blob));o.onfinish=(s,a)=>{i.stopSendTask(s.identifier),on.instance.synchronize()},o.start(n)})()}startReceiveTask(n){let e=Ff.createReceiveTask(n);this.receiveTaskMap.set(n,e),e.onfinish=(i,r)=>{this.stopReceiveTask(i.identifier),r&&ne.trigger("UPDATE_FILE_RESOURE",{identifier:i.identifier,updateImages:r}),on.instance.synchronize()},e.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(n){let e=this.sendTaskMap.get(n);e&&e.cancel(),this.sendTaskMap.delete(n),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(n){let e=this.receiveTaskMap.get(n);e&&e.cancel(),this.receiveTaskMap.delete(n),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(n,e){console.log("requestFile() "+e),ne.call("REQUEST_FILE_RESOURE",{identifiers:n,receiver:jt.peerId,candidatePeers:jt.peerIds},e)}makeSendUpdateImages(n,e=524288){let i=[],r=0;for(let o=n.length-1;0<=o;o--){let s=Math.floor(Math.random()*(o+1));[n[o],n[s]]=[n[s],n[o]]}n.sort((o,s)=>o.state<s.state?-1:o.state>s.state?1:0);for(let o=0;o<n.length;o++){let s=n[o],a=on.instance.get(s.identifier),c={identifier:a.identifier,name:a.name,type:"",blob:null,url:null,thumbnail:{type:"",blob:null,url:null}};a.state===Ri.URL?c.url=a.url:s.state===Ri.NULL?(c.thumbnail.blob=a.thumbnail.blob,c.thumbnail.type=a.thumbnail.type):(c.blob=a.blob,c.type=a.blob.type);let u=c.blob?c.blob.size:c.thumbnail.blob?c.thumbnail.blob.size:100;if(i.push(c),r+=u,e<r)break}return i}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(n){for(let e of this.sendTaskMap.values())if(e&&e.sendTo===n)return!0;return!1}}class Uo{static#e=this.key={};static#t=this.tasksMap=new Map;constructor(n){this.peerId=n,this.requestMap=new Map}static create(n,e){Uo.tasksMap.size<1&&ne.register(Uo.key).on("DISCONNECT_PEER",r=>{Uo.onDisconnect(r.data.peerId)}).on("UPDATE_GAME_OBJECT",r=>{r.isSendFromSelf||Uo.onUpdate(r.data.identifier)}).on("DELETE_GAME_OBJECT",r=>{r.isSendFromSelf||Uo.onUpdate(r.data.identifier)});let i=new Uo(n);return i.initialize(e),i}cancel(){this.timeoutTimer&&this.timeoutTimer.clear(),this.timeoutTimer=null,this.onsynchronize=this.onfinish=this.ontimeout=null;for(let n of this.requestMap.values())this.deleteTasksMap(n.identifier);this.requestMap.clear()}initialize(n){for(let e of n){e.ttl--,this.requestMap.set(e.identifier,e);let i=Uo.tasksMap.get(e.identifier);null==i&&(i=[]),i.push(this),Uo.tasksMap.set(e.identifier,i);let r=null!=this.peerId&&e.holderIds.includes(this.peerId)?this.peerId:null;ne.call("REQUEST_GAME_OBJECT",e.identifier,r)}this.requestMap.size<1?setTimeout(()=>this.finish()):this.resetTimeout()}finish(){this.onfinish&&this.onfinish(this),this.cancel()}timeout(){this.ontimeout&&this.ontimeout(this,Array.from(this.requestMap.values()).filter(n=>0<=n.ttl)),this.finish()}static onDisconnect(n){for(let e of Uo.tasksMap.values())for(let i of e.concat())i.peerId===n&&i.timeout();Uo.tasksMap.size<1&&ne.unregister(Uo.key)}static onUpdate(n){if(!Uo.tasksMap.has(n))return;let e=Uo.tasksMap.get(n);for(let i of e.concat())i.onUpdate(n);Uo.tasksMap.size<1&&ne.unregister(Uo.key)}onUpdate(n){this.requestMap.delete(n),this.onsynchronize&&this.onsynchronize(this,n),this.requestMap.size<1?this.finish():this.resetTimeout()}deleteTasksMap(n){let e=Uo.tasksMap.get(n),i=e.indexOf(this);-1<i&&e.splice(i,1),e.length<1&&Uo.tasksMap.delete(n)}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new Nc(()=>this.timeout(),3e4)),this.timeoutTimer.reset()}}class Kg{static get instance(){return Kg._instance||(Kg._instance=new Kg),Kg._instance}constructor(){this.requestMap=new Map,this.peerMap=new Map,this.tasks=[]}initialize(){this.destroy(),console.log("ObjectSynchronizer ready..."),ne.register(this).on("CONNECT_PEER",2,n=>{n.isSendFromSelf&&(console.log("CONNECT_PEER GameRoomService !!!",n.data.peerId),this.sendCatalog(n.data.peerId))}).on("DISCONNECT_PEER",n=>{this.removePeerMap(n.data.peerId)}).on("SYNCHRONIZE_GAME_OBJECT",n=>{if(n.isSendFromSelf)return;console.log("SYNCHRONIZE_GAME_OBJECT "+n.sendFrom);let e=n.data;for(let i of e)bt.instance.isDeleted(i.identifier)?ne.call("DELETE_GAME_OBJECT",{aliasName:"",identifier:i.identifier},n.sendFrom):this.addRequestMap(i,n.sendFrom);this.synchronize()}).on("REQUEST_GAME_OBJECT",n=>{if(!n.isSendFromSelf)if(bt.instance.isDeleted(n.data))ne.call("DELETE_GAME_OBJECT",{aliasName:"",identifier:n.data},n.sendFrom);else{let e=bt.instance.get(n.data);e&&ne.call("UPDATE_GAME_OBJECT",e.toContext(),n.sendFrom)}}).on("UPDATE_GAME_OBJECT",1e3,n=>{let e=n.data,i=bt.instance.get(e.identifier);i?(n.isSendFromSelf||(i=this.updateObject(i,e)),kR(i,n.sendFrom)):bt.instance.isDeleted(e.identifier)?ne.call("DELETE_GAME_OBJECT",{aliasName:e.aliasName,identifier:e.identifier},n.sendFrom):(i=this.createObject(e),kR(i,n.sendFrom))}).on("DELETE_GAME_OBJECT",1e3,n=>{bt.instance.delete(n.data.identifier,!1)})}destroy(){ne.unregister(this)}updateObject(n,e){return e.majorVersion+e.minorVersion>n.version&&n.apply(e),n}createObject(n){let e=Lc.instance.create(n.aliasName,n.identifier);if(e)return bt.instance.add(e,!1),e.apply(n),e;console.warn(n.aliasName+" is Unknown...?",n)}sendCatalog(n){let e=bt.instance.getCatalog(),i=setInterval(()=>{ne.call("SYNCHRONIZE_GAME_OBJECT",e.splice(0,e.length<2048?e.length:2048),n),e.length<1&&clearInterval(i)})}addRequestMap(n,e){let i=this.requestMap.get(n.identifier);i&&i.version===n.version?(i.holderIds.push(e),this.addPeerMap(e)):(!i||i.version<n.version)&&(this.requestMap.set(n.identifier,{identifier:n.identifier,version:n.version,holderIds:[e],ttl:2}),this.addPeerMap(e))}addPeerMap(n){this.peerMap.has(n)||this.peerMap.set(n,[])}removePeerMap(n){this.peerMap.delete(n)}synchronize(){let n=!0;for(;0<this.requestMap.size&&this.tasks.length<32&&n;)n=this.runSynchronizeTask()}runSynchronizeTask(){let n=this.getTargetPeerId();if(n.length<1)return!1;let e=this.makeRequestList(n);if(e.length<1)return this.removePeerMap(n),0<this.peerMap.size;let i=Uo.create(n,e);this.tasks.push(i);let r=this.peerMap.get(n);return r&&r.push(i),i.onfinish=o=>{this.tasks.splice(this.tasks.indexOf(o),1);let s=this.peerMap.get(n);s&&s.splice(s.indexOf(o),1),this.synchronize()},i.ontimeout=(o,s)=>{console.log("GameObject synchronize \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8"),s.forEach(a=>this.requestMap.set(a.identifier,a))},!0}makeRequestList(n,e=32){let i=[];for(let[r,o]of this.requestMap){if(e<=i.length)break;if(!o.holderIds.includes(n))continue;let s=bt.instance.get(o.identifier);(!s||s.version<o.version)&&i.push(o),this.requestMap.delete(r)}return i}getTargetPeerId(){let n=9999,e="",i=jt.peers;for(let r=i.length-1;0<=r;r--){let o=Math.floor(Math.random()*(r+1));[i[r],i[o]]=[i[o],i[r]]}for(let r of i){let o=this.peerMap.get(r.peerId);r.isOpen&&o&&o.length<n&&(n=o.length,e=r.peerId)}return e}}var Hc,sS=function(t){return t.ASC="ASC",t.DESC="DESC",t}(sS||{});let Vc=class extends eh{constructor(){super(...arguments),this.sortTag="name",this.sortOrder=sS.ASC,this.dataTag="HP MP \u654f\u6377\u5ea6 \u751f\u547d\u529b \u7cbe\u795e\u529b"}static#e=Hc=this;static get instance(){return Hc._instance||(Hc._instance=new Hc("DataSummarySetting"),Hc._instance.initialize()),Hc._instance}get dataTags(){return this._dataTag!==this.dataTag&&(this._dataTag=this.dataTag,this._dataTags=null!=this.dataTag&&0<this.dataTag.trim().length?this.dataTag.trim().split(/[\u3000\s]+/):[]),this._dataTags}innerXml(){return""}parseInnerXml(n){let e=Hc.instance.toContext();e.syncData=this.toContext().syncData,Hc.instance.apply(e),Hc.instance.update(),this.destroy()}};He([ct()],Vc.prototype,"sortTag",void 0),He([ct()],Vc.prototype,"sortOrder",void 0),He([ct()],Vc.prototype,"dataTag",void 0),Vc=Hc=He([ir("summary-setting")],Vc);let Nf=class extends eh{constructor(){super(...arguments),this.audioIdentifier="",this.startTime=0,this.isLoop=!1,this.isPlaying=!1,this.audioPlayer=new Je}get audio(){return un.instance.get(this.audioIdentifier)}onStoreAdded(){super.onStoreAdded(),this.unlockAfterUserInteraction()}onStoreRemoved(){super.onStoreRemoved(),this._stop()}play(n,e=!1){let i=un.instance.get(n);!i||!i.isReady||(this.audioIdentifier=n,this.isPlaying=!0,this.isLoop=e,this._play())}_play(){this._stop(),this.audio&&this.audio.isReady?(this.audioPlayer.loop=!0,this.audioPlayer.play(this.audio)):this.playAfterFileUpdate()}stop(){this.audioIdentifier="",this.isPlaying=!1,this._stop()}_stop(){this.unregisterEvent(),this.audioPlayer.stop()}playAfterFileUpdate(){ne.register(this).on("UPDATE_AUDIO_RESOURE",n=>{this._play()})}unlockAfterUserInteraction(){let n=()=>{document.body.removeEventListener("touchstart",n,!0),document.body.removeEventListener("mousedown",n,!0),this.audioPlayer.stop(),this.isPlaying&&this._play()};document.body.addEventListener("touchstart",n,!0),document.body.addEventListener("mousedown",n,!0)}unregisterEvent(){ne.unregister(this,"UPDATE_AUDIO_RESOURE")}apply(n){let e=this.audioIdentifier,i=this.isPlaying;super.apply(n),e===this.audioIdentifier&&i||!this.isPlaying?i!==this.isPlaying&&!this.isPlaying&&this._stop():this._play()}};var xC;He([ct()],Nf.prototype,"audioIdentifier",void 0),He([ct()],Nf.prototype,"startTime",void 0),He([ct()],Nf.prototype,"isLoop",void 0),He([ct()],Nf.prototype,"isPlaying",void 0),Nf=He([ir("jukebox")],Nf);let zo=xC=class extends wr{constructor(){super(...arguments),this.isLock=!1,this.blendType=0,this.isTransparentOnGMMode=!1,this.owner="",this.scratchingGrids="",this.scratchedGrids="",this.isScratchPreviewOnGMMode=!1,this.isPreview=!1,this.borderType=1}get name(){return this.getCommonValue("name","")}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get opacity(){let n=this.getElement("opacity",this.commonDataElement),e=n?n.currentValue/n.value:1;return Number.isNaN(e)?1:e}get fontsize(){let n=this.getElement("fontsize",this.commonDataElement);return n?+n.value:18}set fontsize(n){this.setCommonValue("fontsize",n)}get text(){let n=this.getElement("text",this.commonDataElement);return n?n.value+"":""}set text(n){this.setCommonValue("text",n)}get color(){let n=this.getElement("color",this.commonDataElement);return n?n.value+"":"#555555"}set color(n){this.setCommonValue("color",n)}get bgcolor(){let n=this.getElement("color",this.commonDataElement);return n?n.currentValue+"":"#0a0a0a"}set bgcolor(n){let e=this.getElement("color",this.commonDataElement);e&&(e.currentValue=n)}get ownerName(){let n=Fe.findByUserId(this.owner);return n?n.name:""}get ownerColor(){let n=Fe.findByUserId(this.owner);return n?n.color:"#444444"}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return this.hasOwner&&(this.isMine||jt.peers.some(n=>n.userId===this.owner&&n.isOpen))}get isMine(){return jt.peer.userId===this.owner}complement(){let n=this.getElement("fontsize",this.commonDataElement);!n&&this.commonDataElement&&this.commonDataElement.appendChild(wt.create("fontsize",18,{},"fontsize_"+this.identifier)),n=this.getElement("text",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.appendChild(wt.create("text","",{type:"note",currentValue:""},"text_"+this.identifier)),n=this.getElement("color",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.appendChild(wt.create("color","#555555",{type:"colors",currentValue:"#0a0a0a"},"color_"+this.identifier)),n=this.getElement("altitude",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.appendChild(wt.create("altitude",0,{},"altitude_"+this.identifier))}static create(n,e,i,r,o){let s=null;return s=o?new xC(o):new xC,s.createDataElements(),s.commonDataElement.appendChild(wt.create("name",n,{},"name_"+s.identifier)),s.commonDataElement.appendChild(wt.create("width",e,{},"width_"+s.identifier)),s.commonDataElement.appendChild(wt.create("height",i,{},"height_"+s.identifier)),s.commonDataElement.appendChild(wt.create("opacity",r,{type:"numberResource",currentValue:r},"opacity_"+s.identifier)),s.commonDataElement.appendChild(wt.create("fontsize",18,{},"fontsize_"+s.identifier)),s.commonDataElement.appendChild(wt.create("text","",{type:"note",currentValue:""},"text_"+s.identifier)),s.commonDataElement.appendChild(wt.create("color","#555555",{type:"colors",currentValue:"#0a0a0a"},"ccolor_"+s.identifier)),s.commonDataElement.appendChild(wt.create("altitude",0,{},"altitude_"+s.identifier)),s.initialize(),s}};He([ct()],zo.prototype,"isLock",void 0),He([ct()],zo.prototype,"blendType",void 0),He([ct()],zo.prototype,"isTransparentOnGMMode",void 0),He([ct()],zo.prototype,"owner",void 0),He([ct()],zo.prototype,"scratchingGrids",void 0),He([ct()],zo.prototype,"scratchedGrids",void 0),He([ct()],zo.prototype,"isScratchPreviewOnGMMode",void 0),He([ct()],zo.prototype,"isPreview",void 0),He([ct()],zo.prototype,"borderType",void 0),zo=xC=He([ir("table-mask")],zo);var wC,Rf=function(t){return t[t.NULL=0]="NULL",t[t.FLOOR=1]="FLOOR",t[t.WALL=2]="WALL",t[t.ALL=3]="ALL",t}(Rf||{}),Er=function(t){return t[t.NONE=0]="NONE",t[t.TOP=1]="TOP",t[t.BOTTOM=2]="BOTTOM",t[t.LEFT=3]="LEFT",t[t.RIGHT=4]="RIGHT",t}(Er||{});let es=wC=class extends wr{constructor(){super(...arguments),this.isLocked=!1,this.mode=Rf.ALL,this.rotate=0,this.isDropShadow=!0,this.isSurfaceShading=!0,this.isInteract=!0,this.isSlope=!1,this.slopeDirection=Er.NONE}get width(){return this.getCommonValue("width",1)}set width(n){this.setCommonValue("width",n)}get height(){return this.getCommonValue("height",1)}set height(n){this.setCommonValue("height",n)}get depth(){return this.getCommonValue("depth",1)}set depth(n){this.setCommonValue("depth",n)}get name(){return this.getCommonValue("name","")}set name(n){this.setCommonValue("name",n)}get wallImage(){return this.getImageFile("wall")}get floorImage(){return this.getImageFile("floor")}get hasWall(){return!!(this.mode&Rf.WALL)}get hasFloor(){return!!(this.mode&Rf.FLOOR)}complement(){!this.getElement("altitude",this.commonDataElement)&&this.commonDataElement&&this.commonDataElement.appendChild(wt.create("altitude",0,{},"altitude_"+this.identifier))}static create(n,e,i,r,o,s,a){let c=null;return c=a?new wC(a):new wC,c.createDataElements(),c.commonDataElement.appendChild(wt.create("name",n,{},"name_"+c.identifier)),c.commonDataElement.appendChild(wt.create("width",e,{},"width_"+c.identifier)),c.commonDataElement.appendChild(wt.create("height",r,{},"height_"+c.identifier)),c.commonDataElement.appendChild(wt.create("depth",i,{},"depth_"+c.identifier)),c.commonDataElement.appendChild(wt.create("altitude",0,{},"altitude_"+c.identifier)),c.imageDataElement.appendChild(wt.create("wall",o,{type:"image"},"wall_"+c.identifier)),c.imageDataElement.appendChild(wt.create("floor",s,{type:"image"},"floor_"+c.identifier)),c.initialize(),c}};He([ct()],es.prototype,"isLocked",void 0),He([ct()],es.prototype,"mode",void 0),He([ct()],es.prototype,"rotate",void 0),He([ct()],es.prototype,"isDropShadow",void 0),He([ct()],es.prototype,"isSurfaceShading",void 0),He([ct()],es.prototype,"isInteract",void 0),He([ct()],es.prototype,"isSlope",void 0),He([ct()],es.prototype,"slopeDirection",void 0),es=wC=He([ir("terrain")],es);var jc=function(t){return t[t.NONE=-1]="NONE",t[t.SQUARE=0]="SQUARE",t[t.HEX_VERTICAL=1]="HEX_VERTICAL",t[t.HEX_HORIZONTAL=2]="HEX_HORIZONTAL",t}(jc||{}),l4=function(t){return t.NONE="",t.WHITE="white",t.BLACK="black",t}(l4||{});let bo=class extends xr{constructor(){super(...arguments),this.name="\u30c6\u30fc\u30d6\u30eb",this.width=20,this.height=20,this.gridSize=50,this.imageIdentifier="imageIdentifier",this.backgroundImageIdentifier="imageIdentifier",this.backgroundImageIdentifier2="imageIdentifier",this.backgroundFilterType=l4.NONE,this.selected=!1,this.gridType=jc.SQUARE,this.gridColor="#000000e6",this.isShowNumber=!0,this.gridHeight=0,this.gridClipRect=null}get terrains(){let n=[];return this.children.forEach(e=>{e instanceof es&&n.push(e)}),n}get masks(){let n=[];return this.children.forEach(e=>{e instanceof zo&&n.push(e)}),n}onStoreAdded(){super.onStoreAdded(),this.selected&&ne.trigger("SELECT_GAME_TABLE",{identifier:this.identifier})}};var Lf;He([ct()],bo.prototype,"name",void 0),He([ct()],bo.prototype,"width",void 0),He([ct()],bo.prototype,"height",void 0),He([ct()],bo.prototype,"gridSize",void 0),He([ct()],bo.prototype,"imageIdentifier",void 0),He([ct()],bo.prototype,"backgroundImageIdentifier",void 0),He([ct()],bo.prototype,"backgroundImageIdentifier2",void 0),He([ct()],bo.prototype,"backgroundFilterType",void 0),He([ct()],bo.prototype,"selected",void 0),He([ct()],bo.prototype,"gridType",void 0),He([ct()],bo.prototype,"gridColor",void 0),He([ct()],bo.prototype,"isShowNumber",void 0),bo=He([ir("game-table")],bo);let Ho=class extends eh{constructor(){super(...arguments),this.viewTableIdentifier="",this.gridShow=!1,this.gridSnap=!0}static#e=Lf=this;static get instance(){return Lf._instance||(Lf._instance=new Lf("TableSelecter"),Lf._instance.initialize()),Lf._instance}onStoreAdded(){super.onStoreAdded(),ne.register(this).on("SELECT_GAME_TABLE",n=>{console.log("SELECT_GAME_TABLE "+this.identifier),this.viewTable&&(this.viewTable.selected=!1),this.viewTableIdentifier=n.data.identifier,this.viewTable&&(this.viewTable.selected=!0)})}onStoreRemoved(){super.onStoreRemoved(),ne.unregister(this)}get viewTable(){let n=bt.instance.get(this.viewTableIdentifier);return n||(n=bt.instance.getObjects(bo)[0],n&&(this.viewTableIdentifier.length<1||bt.instance.isDeleted(this.viewTableIdentifier))&&(this.viewTableIdentifier=n.identifier,ne.trigger("SELECT_GAME_TABLE",{identifier:n.identifier}))),n}};He([ct()],Ho.prototype,"viewTableIdentifier",void 0),Ho=Lf=He([ir("TableSelecter")],Ho);let vo=(()=>{class t{constructor(){this.intervalTimer=null,this.timeOffset=Date.now(),this.performanceOffset=performance.now(),this.ntpApiUrls=["https://worldtimeapi.org/api/ip"],this.gameType=""}get chatTabs(){return nc.instance.chatTabs}calibrateTimeOffset(){if(null!=this.intervalTimer)return void console.log("calibrateTimeOffset was canceled.");let e=Math.floor(Math.random()*this.ntpApiUrls.length),i=this.ntpApiUrls[e],r=performance.now();fetch(i).then(o=>{if(o.ok)return o.json();throw new Error("Network response was not ok.")}).then(o=>{let s=performance.now(),a=(s-r)/2,u=new Date(o.utc_datetime).getTime();this.timeOffset=u+a,this.performanceOffset=s,console.log("latency: "+a+"ms"),console.log("st: "+u),console.log("timeOffset: "+this.timeOffset),console.log("performanceOffset: "+this.performanceOffset),this.setIntervalTimer()}).catch(o=>{console.warn("There has been a problem with your fetch operation: ",o.message),this.setIntervalTimer()}),this.setIntervalTimer()}setIntervalTimer(){null!=this.intervalTimer&&clearTimeout(this.intervalTimer),this.intervalTimer=setTimeout(()=>{this.intervalTimer=null,this.calibrateTimeOffset()},216e5)}getTime(){return Math.floor(this.timeOffset+(performance.now()-this.performanceOffset))}sendMessage(e,i,r,o,s,a,c,u,f,b,C,x,M,U,W){let K=!(C&&this.findFaceIconIdentifier(o)),$={from:jt.peer.userId,to:t.findId(s),name:this.findObjectName(o),toName:s?this.findObjectName(s):"",imageIdentifier:this.findImageIdentifier(o,C),toImageIdentifier:s?this.findImageIdentifier(s):"",timestamp:this.calcTimeStamp(e),tag:K?`${r} noface`:r,text:ke.cr(i),color:a,toColor:s?this.findObjectColor(s):"",isInverseIcon:K&&c?1:0,isHollowIcon:K&&u?1:0,isBlackPaint:K&&f?1:0,aura:K?b:-1,characterIdentifier:x,standIdentifier:M,standName:U,isUseStandImage:W};return e.addMessage($)}sendOperationLog(e,i=1){for(const r of this.chatTabs){if(r.recieveOperationLogLevel<i)continue;let o={from:jt.peer.userId,name:Fe.myCursor.name,imageIdentifier:Fe.myCursor.imageIdentifier,timestamp:this.calcTimeStamp(r),tag:"opelog",text:e,color:Fe.myCursor.color};r.addMessage(o)}}static findId(e){let i=bt.instance.get(e);return i instanceof gn?i.identifier:i instanceof Fe?i.userId:null}findObjectName(e){let i=bt.instance.get(e);return i instanceof gn?i.name&&i.name.length?i.name:"\uff08\u7121\u540d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\uff09":i instanceof Fe?i.name&&i.name.length?i.name:"\uff08\u7121\u540d\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\uff09":e}findObjectColor(e){let i=bt.instance.get(e);return i instanceof gn?i.chatPalette.color:i instanceof Fe?i.color:null}makeMessageName(e,i){let r=this.findObjectName(e);return null==i||i.length<1?r:r+" \u27a1 "+this.findObjectName(i)}findImageIdentifier(e,i=!1){let r=bt.instance.get(e);return r instanceof gn?i&&r.faceIcon&&0<r.faceIcon.url.length?r.faceIcon.identifier:r.imageFile?r.imageFile.identifier:"":r instanceof Fe?r.imageIdentifier:e}findFaceIconIdentifier(e){let i=bt.instance.get(e);return i instanceof gn&&i.faceIcon&&0<i.faceIcon.url.length?i.faceIcon.identifier:""}calcTimeStamp(e){let i=this.getTime(),r=e.latestTimeStamp;return i<=r?r+1:i}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac})}return t})();function EC(t,n=[]){let e=u4(t.aliasName,n),i=-1,r=!1;for(let o=0;o<e.length;o++)i===e[o].zindex?r=!0:i<e[o].zindex&&(i=e[o].zindex,r=!1);if((i!==t.zindex||r)&&(t.zindex=i+1,!(t.zindex<e.length+256))){e.sort((o,s)=>o.zindex-s.zindex);for(let o=0;o<e.length;o++)e[o].zindex=o}}function c4(t,n=[]){let e=u4(t.aliasName,n),i=Number.MAX_SAFE_INTEGER,r=!1;for(let o=0;o<e.length;o++)i===e[o].zindex?r=!0:e[o].zindex<i&&(i=e[o].zindex,r=!1);if((i!==t.zindex||r)&&(t.zindex=i-1,!(0<=t.zindex))){e.sort((o,s)=>o.zindex-s.zindex);for(let o=0;o<e.length;o++)e[o].zindex=o}}function u4(t,n){let e=bt.instance.getObjects(t);return n.forEach(i=>e=e.concat(bt.instance.getObjects(i))),e=e.filter(i=>i.isVisibleOnTable),e}var IC,bs=function(t){return t[t.FRONT=0]="FRONT",t[t.BACK=1]="BACK",t}(bs||{});let Ci=IC=class extends wr{constructor(){super(...arguments),this.state=bs.FRONT,this.rotate=0,this.owner="",this.zindex=0,this.isLocked=!1}get isVisibleOnTable(){return"table"===this.location.name&&(!this.parentIsAssigned||this.parentIsDestroyed)}get name(){return this.getCommonValue("name","")}get size(){return this.getCommonValue("size",2)}set size(n){this.setCommonValue("size",n)}get frontImage(){return this.getImageFile("front")}get backImage(){return this.getImageFile("back")}get imageFile(){return this.isVisible?this.frontImage:this.backImage}get fontsize(){let n=this.getElement("fontsize",this.commonDataElement);return n?+n.value:18}set fontsize(n){this.setCommonValue("fontsize",n)}get text(){let n=this.getElement("text",this.commonDataElement);return n?n.value+"":""}set text(n){this.setCommonValue("text",n)}get color(){return this.getCommonValue("color","#555555")}set color(n){this.setCommonValue("color",n)}get ownerName(){let n=Fe.findByUserId(this.owner);return n?n.name:""}get ownerColor(){let n=Fe.findByUserId(this.owner);return n?n.color:"#444444"}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return this.hasOwner&&(this.isHand||jt.peers.some(n=>n.userId===this.owner&&n.isOpen))}get isHand(){return jt.peer.userId===this.owner}get isFront(){return this.state===bs.FRONT}get isVisible(){return this.isHand||this.isFront}complement(){let n=this.getElement("fontsize",this.commonDataElement);!n&&this.commonDataElement&&this.commonDataElement.appendChild(wt.create("fontsize",18,{},"fontsize_"+this.identifier)),n=this.getElement("text",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.appendChild(wt.create("text","",{type:"note",currentValue:""},"text_"+this.identifier)),n=this.getElement("color",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.appendChild(wt.create("color","#555555",{type:"color"},"color_"+this.identifier))}faceUp(){this.state=bs.FRONT,this.owner=""}faceDown(){this.state=bs.BACK,this.owner=""}toTopmost(){EC(this,["card-stack"])}toBackmost(){c4(this,["card-stack"])}static create(n,e,i,r=2,o){let s=null;return s=o?new IC(o):new IC,s.createDataElements(),s.commonDataElement.appendChild(wt.create("name",n,{},"name_"+s.identifier)),s.commonDataElement.appendChild(wt.create("size",r,{},"size_"+s.identifier)),s.imageDataElement.appendChild(wt.create("front",e,{type:"image"},"front_"+s.identifier)),s.imageDataElement.appendChild(wt.create("back",i,{type:"image"},"back_"+s.identifier)),s.commonDataElement.appendChild(wt.create("fontsize",18,{},"fontsize_"+s.identifier)),s.commonDataElement.appendChild(wt.create("text","",{type:"note",currentValue:""},"text_"+s.identifier)),s.commonDataElement.appendChild(wt.create("color","#555555",{type:"color"},"ccolor_"+s.identifier)),s.initialize(),s}};var TC;He([ct()],Ci.prototype,"state",void 0),He([ct()],Ci.prototype,"rotate",void 0),He([ct()],Ci.prototype,"owner",void 0),He([ct()],Ci.prototype,"zindex",void 0),He([ct()],Ci.prototype,"isLocked",void 0),Ci=IC=He([ir("card")],Ci);let Vi=TC=class extends wr{constructor(){super(...arguments),this.rotate=0,this.zindex=0,this.owner="",this.isShowTotal=!0,this.isLocked=!1}get name(){return this.getCommonValue("name","")}get ownerName(){let n=Fe.findByUserId(this.owner);return n?n.name:""}get ownerColor(){let n=Fe.findByUserId(this.owner);return n?n.color:"#444444"}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return this.hasOwner&&jt.peers.some(n=>n.userId===this.owner&&n.isOpen)}get cardRoot(){for(let n of this.children)if("cardRoot"===n.getAttribute("name"))return n;return null}get cards(){return this.cardRoot?this.cardRoot.children:[]}get topCard(){return this.isEmpty?null:this.cards[0]}get isEmpty(){return this.cards.length<1}get imageFile(){return this.topCard?this.topCard.imageFile:null}complement(){this.cards.forEach(n=>n.complement())}onChildRemoved(n){super.onChildRemoved(n),n instanceof Ci&&ne.trigger("CARD_STACK_DECREASED",{cardStackIdentifier:this.identifier,cardIdentifier:n.identifier})}shuffle(){if(!this.cardRoot)return;let n=this.cardRoot.children.length;for(let e of this.cards)e.index=Math.random()*n,e.rotate=180*Math.floor(2*Math.random()),this.setSamePositionFor(e);return this.cards}drawCard(){let n=this.topCard?this.cardRoot.removeChild(this.topCard):null;return n&&(n.rotate+=this.rotate,360<n.rotate&&(n.rotate-=360),this.setSamePositionFor(n),n.toTopmost()),n}drawCardAll(){let n=this.cards;for(let e of n)this.cardRoot.removeChild(e),e.rotate+=this.rotate,this.setSamePositionFor(e),360<e.rotate&&(e.rotate-=360);return n}faceUp(){this.topCard&&(this.topCard.faceUp(),this.setSamePositionFor(this.topCard))}faceDown(){this.topCard&&(this.topCard.faceDown(),this.setSamePositionFor(this.topCard))}faceUpAll(){for(let n of this.cards)n.faceUp(),this.setSamePositionFor(n)}faceDownAll(){for(let n of this.cards)n.faceDown(),this.setSamePositionFor(n)}uprightAll(){for(let n of this.cards)n.rotate=0,this.setSamePositionFor(n)}inverse(){const n=[];for(;;){let e=this.topCard?this.cardRoot.removeChild(this.topCard):null;if(null==e)break;n.unshift(e),e.state=e.state==bs.FRONT?bs.BACK:bs.FRONT}for(let e of n)this.putOnBottom(e)}unifyCardsSize(n){for(const e of this.cards)e.size!==n&&(e.size=n)}putOnTop(n){if(!this.cardRoot)return null;if(!this.topCard)return this.putOnBottom(n);n.owner="",n.zindex=0;let e=Math.abs(n.rotate-this.rotate);return 180<e&&(e=360-e),n.rotate=e<=90?0:180,this.setSamePositionFor(n),this.cardRoot.prependChild(n)}putOnBottom(n){if(!this.cardRoot)return null;n.owner="",n.zindex=0;let e=Math.abs(n.rotate-this.rotate);return 180<e&&(e=360-e),n.rotate=e<=90?0:180,this.setSamePositionFor(n),this.cardRoot.appendChild(n)}toTopmost(){EC(this,["card"])}toBackmost(){c4(this,["card"])}setLocation(n){super.setLocation(n);let e=this.cards;for(let i of e)i.setLocation(n)}setSamePositionFor(n){n.location.name=this.location.name,n.location.x=this.location.x,n.location.y=this.location.y,n.posZ=this.posZ}static create(n,e){let i=null;i=e?new TC(e):new TC,i.createDataElements(),i.commonDataElement.appendChild(wt.create("name",n,{},"name_"+i.identifier));let r=new xr("cardRoot_"+i.identifier);return r.setAttribute("name","cardRoot"),r.initialize(),i.appendChild(r),i.initialize(),i}};He([ct()],Vi.prototype,"rotate",void 0),He([ct()],Vi.prototype,"zindex",void 0),He([ct()],Vi.prototype,"owner",void 0),He([ct()],Vi.prototype,"isShowTotal",void 0),He([ct()],Vi.prototype,"isLocked",void 0),Vi=TC=He([ir("card-stack")],Vi);var SC,Do=function(t){return t[t.D2=0]="D2",t[t.D4=1]="D4",t[t.D6=2]="D6",t[t.D8=3]="D8",t[t.D10=4]="D10",t[t.D10_10TIMES=5]="D10_10TIMES",t[t.D12=6]="D12",t[t.D20=7]="D20",t}(Do||{});let ts=SC=class extends wr{constructor(){super(...arguments),this.face="0",this.owner="",this.rotate=0,this.isDropShadow=!0,this.isLock=!1}get name(){return this.getCommonValue("name","")}set name(n){this.setCommonValue("name",n)}get size(){return this.getCommonValue("size",1)}set size(n){this.setCommonValue("size",n)}get faces(){return this.imageDataElement?this.imageDataElement.children.filter(n=>"nothing"!=n.currentValue).map(n=>n.name):[]}get imageFile(){return this.isVisible?this.getImageFile(this.face):this.faces.length?this.getImageFile(this.faces[0]):null}get backFaceImageFile(){return this.isCoin?this.getImageFile(this.isVisible?"\u8868"==this.face?"\u88cf":"\u8868":this.faces[1]):this.imageFile}get nothingFaces(){return this.imageDataElement.children.filter(n=>"nothing"==n.currentValue).map(n=>n.name)}get ownerName(){let n=Fe.findByUserId(this.owner);return n?n.name:""}get ownerColor(){let n=Fe.findByUserId(this.owner);return n?n.color:"#444444"}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return this.hasOwner&&jt.peers.some(n=>n.userId===this.owner&&n.isOpen)}get isMine(){return jt.peer.userId===this.owner}get isVisible(){return!this.hasOwner||this.isMine||this.isGMMode}get isCoin(){return 2===this.faces.length}diceRoll(){let n=this.faces;return this.face=0<n.length?n[Math.floor(Math.random()*n.length)]:"",this.face}setDicetype(n){this.makeDiceFace(n)}makeDiceFace(n,e){let i=1,r=[],o=s=>s+1+"";switch(n){case Do.D2:i=2,o=a=>0===a?"\u8868":"\u88cf";break;case Do.D4:i=4;break;case Do.D6:i=6,r.push(wt.create("\u306a\u3057","",{type:"image",currentValue:"nothing"},null!=e?"nothing_"+e:null));break;case Do.D8:i=8;break;case Do.D10_10TIMES:o=a=>a+1+"0";case Do.D10:i=10;break;case Do.D12:i=12;break;case Do.D20:i=20;break;default:i=2}for(let s=0;s<i;s++){let a=o(s);r.push(wt.create(a,"",{type:"image"},null!=e?a+"_"+e:null))}return this.imageDataElement.children.forEach(s=>s.destroy()),r.forEach(s=>this.imageDataElement.appendChild(s)),this.face=this.faces[0],r}static create(n,e,i,r){let o=r?new SC(r):new SC;return o.createDataElements(),o.commonDataElement.appendChild(wt.create("name",n,{},"name_"+o.identifier)),o.commonDataElement.appendChild(wt.create("size",i,{},"size_"+o.identifier)),o.makeDiceFace(e,o.identifier),o.initialize(),o}};var MC;He([ct()],ts.prototype,"face",void 0),He([ct()],ts.prototype,"owner",void 0),He([ct()],ts.prototype,"rotate",void 0),He([ct()],ts.prototype,"isDropShadow",void 0),He([ct()],ts.prototype,"isLock",void 0),ts=SC=He([ir("dice-symbol")],ts);let rr=MC=class extends wr{constructor(n=oa.generateUuid()){super(n),this.isLocked=!1,this.rotate=0,this.zindex=0,this.followingCharctorIdentifier=null,this.followingCounterDummy=0,this.offSetX=!1,this.offSetY=!1,this.type="CORN",this.subDivisionSnapPolygonal=!0,this.fillType=1,this.isExpandByFollowing=!1,this.isFollowAltitude=!1,this.followingCharactorCache=null,this.gridSize=50,this.isAltitudeIndicate=!0,this.followingCharctorIdentifier=null}get name(){return this.getCommonValue("name","")}get length(){return this.getCommonValue("length",1)}get width(){return this.getCommonValue("width",1)}get opacity(){let n=this.getElement("opacity",this.commonDataElement),e=n?n.currentValue/n.value:1;return Number.isNaN(e)?1:e}get rangeColor(){let n=this.getElement("color",this.commonDataElement);return n?n.value+"":"#ff0000"}set rangeColor(n){this.setCommonValue("color",n)}get gridColor(){let n=this.getElement("color",this.commonDataElement);return n?n.currentValue+"":"#ffff00"}set gridColor(n){let e=this.getElement("color",this.commonDataElement);e&&(e.currentValue=n)}get isApplyWidth(){return"LINE"===this.type||"CORN"===this.type}get followingCharactor(){if(this.followingCharctorIdentifier){if(!this.followingCharactorCache||this.followingCharactorCache.identifier!==this.followingCharctorIdentifier){let n=bt.instance.get(this.followingCharctorIdentifier);n&&n instanceof gn?this.followingCharactorCache=n:(this.followingCharctorIdentifier=null,this.followingCharactorCache=null)}}else this.followingCharactorCache=null;return this.followingCharactorCache}set followingCharactor(n){n?(this.followingCharactorCache=n,this.followingCharctorIdentifier=n.identifier):(this.followingCharactorCache=null,this.followingCharctorIdentifier=null)}followingCounterDummyCount(){this.followingCounterDummy++,this.followingCounterDummy>=50&&(this.followingCounterDummy=0)}following(){this.followingCharactor&&!this.followingCharactor.isHideIn?(this.location.x=this.followingCharactor.location.x+this.gridSize*this.followingCharactor.size/2,this.location.y=this.followingCharactor.location.y+this.gridSize*this.followingCharactor.size/2,this.isFollowAltitude&&(this.altitude=this.followingCharactor.altitude,this.posZ=this.followingCharactor.posZ),this.followingCounterDummyCount()):this.followingCharactor=null}toTopmost(){EC(this)}static create(n,e,i,r,o){let s=null;return s=o?new MC(o):new MC,s.createDataElements(),s.commonDataElement.appendChild(wt.create("name",n,{},"name_"+s.identifier)),s.commonDataElement.appendChild(wt.create("length",i,{},"length_"+s.identifier)),s.commonDataElement.appendChild(wt.create("width",e,{},"width_"+s.identifier)),s.commonDataElement.appendChild(wt.create("opacity",r,{type:"numberResource",currentValue:r},"opacity_"+s.identifier)),s.commonDataElement.appendChild(wt.create("color","#ff0000",{type:"colors",currentValue:"#ffff00"},"ccolor_"+s.identifier)),s.commonDataElement.appendChild(wt.create("altitude",0,{},"altitude_"+s.identifier)),s.initialize(),s}};var DC;He([ct()],rr.prototype,"isLocked",void 0),He([ct()],rr.prototype,"rotate",void 0),He([ct()],rr.prototype,"zindex",void 0),He([ct()],rr.prototype,"followingCharctorIdentifier",void 0),He([ct()],rr.prototype,"followingCounterDummy",void 0),He([ct()],rr.prototype,"offSetX",void 0),He([ct()],rr.prototype,"offSetY",void 0),He([ct()],rr.prototype,"type",void 0),He([ct()],rr.prototype,"subDivisionSnapPolygonal",void 0),He([ct()],rr.prototype,"fillType",void 0),He([ct()],rr.prototype,"isExpandByFollowing",void 0),He([ct()],rr.prototype,"isFollowAltitude",void 0),rr=MC=He([ir("range")],rr);let vs=DC=class extends wr{constructor(){super(...arguments),this.rotate=0,this.zindex=0,this.password="",this.isUpright=!0,this.isLocked=!1,this.isWhiteOut=!1,this.isShowTitle=!0}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get fontSize(){return this.getCommonValue("fontsize",1)}get title(){return this.getCommonValue("title","")}get text(){return this.getCommonValue("text","")}set text(n){this.setCommonValue("text",n)}get color(){return this.getCommonValue("color","#444444")}set color(n){this.setCommonValue("color",n)}complement(){let n=this.getElement("color",this.commonDataElement);!n&&this.commonDataElement&&this.commonDataElement.appendChild(wt.create("color","#555555",{type:"color"},"color_"+this.identifier)),n=this.getElement("altitude",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.appendChild(wt.create("altitude",0,{},"altitude_"+this.identifier))}toTopmost(){EC(this)}static create(n,e,i=16,r=1,o=1,s){let a=s?new DC(s):new DC;return a.createDataElements(),a.commonDataElement.appendChild(wt.create("width",r,{},"width_"+a.identifier)),a.commonDataElement.appendChild(wt.create("height",o,{},"height_"+a.identifier)),a.commonDataElement.appendChild(wt.create("fontsize",i,{},"fontsize_"+a.identifier)),a.commonDataElement.appendChild(wt.create("title",n,{},"title_"+a.identifier)),a.commonDataElement.appendChild(wt.create("text",e,{type:"note",currentValue:e},"text_"+a.identifier)),a.commonDataElement.appendChild(wt.create("color","#444444",{type:"color"},"ccolor_"+a.identifier)),a.commonDataElement.appendChild(wt.create("altitude",0,{},"altitude_"+a.identifier)),a.initialize(),a}};He([ct()],vs.prototype,"rotate",void 0),He([ct()],vs.prototype,"zindex",void 0),He([ct()],vs.prototype,"password",void 0),He([ct()],vs.prototype,"isUpright",void 0),He([ct()],vs.prototype,"isLocked",void 0),He([ct()],vs.prototype,"isWhiteOut",void 0),He([ct()],vs.prototype,"isShowTitle",void 0),vs=DC=He([ir("text-note")],vs);let aS=class extends eh{onStoreAdded(){super.onStoreAdded(),bt.instance.remove(this)}innerXml(){let n="",e=[];e=e.concat(bt.instance.getObjects(bo)),e=e.concat(bt.instance.getObjects(gn)),e=e.concat(bt.instance.getObjects(rr)),e=e.concat(bt.instance.getObjects(vs)),e=e.concat(bt.instance.getObjects(Vi)),e=e.concat(bt.instance.getObjects(Ci).filter(i=>null===i.parent)),e=e.concat(bt.instance.getObjects(ts));for(let i of e)n+=i.toXml();return n}parseInnerXml(n){let e=[];e=e.concat(bt.instance.getObjects(bo)),e=e.concat(bt.instance.getObjects(zo)),e=e.concat(bt.instance.getObjects(es)),e=e.concat(bt.instance.getObjects(gn)),e=e.concat(bt.instance.getObjects(rr)),e=e.concat(bt.instance.getObjects(vs)),e=e.concat(bt.instance.getObjects(Vi)),e=e.concat(bt.instance.getObjects(Ci)),e=e.concat(bt.instance.getObjects(ts));for(let i of e)i.destroy();for(let i=0;i<n.children.length;i++)ar.instance.parseXml(n.children[i])}};aS=He([ir("room")],aS);var aK=me(9822);class ll{static#e=this.queue=new AR("SaveDataServiceQueue");constructor(n,e){this.ngZone=n,this.chatMessageService=e}saveRoomAsync(n="fly_\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",e){return this.chatMessageService.sendOperationLog(`\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf ${n}.zip \u3092\u4fdd\u5b58`),ll.queue.add((i,r)=>i(this._saveRoomAsync(n,e)))}_saveRoomAsync(n="fly_\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",e){let i=[],r=this.convertToXml(new aS),o=this.convertToXml(nc.instance),s=this.convertToXml(Jl.instance),a=this.convertToXml(tc.instance),c=this.convertToXml(Vc.instance);i.push(new File([r],"fly_data.xml",{type:"text/plain"})),i.push(new File([o],"fly_chat.xml",{type:"text/plain"})),i.push(new File([s],"fly_rollTable.xml",{type:"text/plain"})),i.push(new File([a],"fly_cutIn.xml",{type:"text/plain"})),i.push(new File([c],"summary.xml",{type:"text/plain"}));let u=[];u=u.concat(this.searchImageFiles(r)),u=u.concat(this.searchImageFiles(o)),u=u.concat(this.searchImageFiles(a));for(const b of u)b.state===Ri.COMPLETE&&i.push(new File([b.blob],b.identifier+"."+Pf.extension(b.blob.type),{type:b.blob.type}));let f=this.convertToXml(Rs.create(u));return i.push(new File([f],"fly_imageTag.xml",{type:"text/plain"})),this.saveAsync(i,this.appendTimestamp(n),e)}saveGameObjectAsync(n,e="fly_xml_data",i){return this.chatMessageService.sendOperationLog(`${ke.aliasNameToClassName(n.aliasName)}\u306e\u30c7\u30fc\u30bf ${e}.zip \u3092\u4fdd\u5b58`),ll.queue.add((r,o)=>r(this._saveGameObjectAsync(n,e,i)))}_saveGameObjectAsync(n,e="fly_xml_data",i){let r=[],o=this.convertToXml(n);r.push(new File([o],"fly_data.xml",{type:"text/plain"}));let s=[];s=s.concat(this.searchImageFiles(o));for(const c of s)c.state===Ri.COMPLETE&&r.push(new File([c.blob],c.identifier+"."+Pf.extension(c.blob.type),{type:c.blob.type}));let a=this.convertToXml(Rs.create(s));return r.push(new File([a],"fly_imageTag.xml",{type:"text/plain"})),this.saveAsync(r,this.appendTimestamp(e),i)}saveAsync(n,e,i){let r=-1;return zc.instance.saveAsync(n,e,o=>{let s=0|o.percent;s<=r||(r=s,this.ngZone.run(()=>i(r)))})}convertToXml(n){return'<?xml version="1.0" encoding="UTF-8"?>\n'+aK.xml(n.toXml(),2)}searchImageFiles(n){let e=Lu.xml2element(n),i=[];if(!e)return i;let r={},o=e.ownerDocument.querySelectorAll('*[type="image"]');for(let s=0;s<o.length;s++){let a=o[s].innerHTML;r[a]=on.instance.get(a);let c=o[s].getAttribute("currentValue");c&&(r[c]=on.instance.get(c))}o=e.ownerDocument.querySelectorAll("*[imageIdentifier], *[toImageIdentifier], *[backgroundImageIdentifier], *[backgroundImageIdentifier2]");for(let s=0;s<o.length;s++){let a=o[s].getAttribute("imageIdentifier");a&&(r[a]=on.instance.get(a));let c=o[s].getAttribute("toImageIdentifier");c&&(r[a]=on.instance.get(c));let u=o[s].getAttribute("backgroundImageIdentifier");u&&(r[u]=on.instance.get(u));let f=o[s].getAttribute("backgroundImageIdentifier2");f&&(r[f]=on.instance.get(f))}for(let s in r){let a=r[s];a&&i.push(a)}return i}appendTimestamp(n){let e=new Date;return n+`_${e.getFullYear()}-${("00"+(e.getMonth()+1)).slice(-2)}-${("00"+e.getDate()).slice(-2)}_${("00"+e.getHours()).slice(-2)}${("00"+e.getMinutes()).slice(-2)}`}saveChatLog(n,e,i=null,r="HH:mm",o=!0){const s=0==n?"text/plain":"text/html",a=0==n?".txt":".html",c="fly_"+this.appendTimestamp(e)+a;this.chatMessageService.sendOperationLog(`\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0 ${c} \u3092\u4fdd\u5b58`),r4(new Blob([i?i.log(n,r,o):nc.instance.log(n,r,o)],{type:`${s};charset=utf-8`}),c)}static#t=this.\u0275fac=function(e){return new(e||ll)(Nn(Pn),Nn(vo))};static#n=this.\u0275prov=nn({token:ll,factory:ll.\u0275fac,providedIn:"root"})}function lK(t,n){if(1&t&&(p(0,"option",7),y(1),g()),2&t){const e=n.$implicit;Et("value",e.identifier),h(),Xe(e.name)}}function cK(t,n){if(1&t){const e=Le();Ue(0),p(1,"div",8)(2,"div"),y(3," \u30bf\u30d6"),p(4,"sup",9),y(5,"*"),g(),y(6,"\uff1a "),p(7,"label")(8,"input",10),at("ngModelChange",function(r){V(e);const o=v();return it(o.isAllTabs,r)||(o.isAllTabs=r),H(r)}),g(),y(9,"\u9078\u629e\u3057\u305f\u30bf\u30d6"),g(),p(10,"label")(11,"input",10),at("ngModelChange",function(r){V(e);const o=v();return it(o.isAllTabs,r)||(o.isAllTabs=r),H(r)}),g(),y(12,"\u5168\u3066\u306e\u30bf\u30d6"),g()(),p(13,"div"),y(14," \u5f62\u5f0f"),p(15,"sup",9),y(16,"*"),g(),y(17,"\uff1a "),p(18,"label")(19,"input",10),at("ngModelChange",function(r){V(e);const o=v();return it(o.logFormat,r)||(o.logFormat=r),H(r)}),g(),y(20,"\u30c6\u30ad\u30b9\u30c8"),g(),p(21,"label")(22,"input",10),at("ngModelChange",function(r){V(e);const o=v();return it(o.logFormat,r)||(o.logFormat=r),H(r)}),g(),y(23,"HTML"),g()(),p(24,"div"),y(25," \u6642\u523b"),p(26,"sup",9),y(27,"*"),g(),y(28,"\uff1a "),p(29,"label")(30,"input",10),at("ngModelChange",function(r){V(e);const o=v();return it(o.dateFormat,r)||(o.dateFormat=r),H(r)}),g(),y(31,"\u306a\u3057"),g(),p(32,"label")(33,"input",10),at("ngModelChange",function(r){V(e);const o=v();return it(o.dateFormat,r)||(o.dateFormat=r),H(r)}),g(),y(34,"\u6642\uff1a\u5206"),g(),p(35,"label")(36,"input",10),at("ngModelChange",function(r){V(e);const o=v();return it(o.dateFormat,r)||(o.dateFormat=r),H(r)}),g(),y(37,"\u65e5\u4ed8\u6642\u523b"),g()()(),Ge(38,"hr"),p(39,"div",11)(40,"div")(41,"label",12)(42,"input",13),at("ngModelChange",function(r){V(e);const o=v();return it(o.isWriteOerationLog,r)||(o.isWriteOerationLog=r),H(r)}),g(),y(43,"\u64cd\u4f5c\u30ed\u30b0\u3092\u542b\u3081\u308b"),p(44,"sup",9),y(45,"*"),g()()(),p(46,"div",14)(47,"button",15),he("click",function(){return V(e),H(v().saveLog())}),y(48,"\u30ed\u30b0\u51fa\u529b"),g()()(),ze()}if(2&t){const e=v();h(8),go("name","",e.panelId,"-log-output-tab"),st("ngModel",e.isAllTabs),m("checked",!e.isAllTabs)("value",!1),h(3),go("name","",e.panelId,"-log-output-tab"),st("ngModel",e.isAllTabs),m("checked",e.isAllTabs)("value",!0),h(8),go("name","",e.panelId,"-log-output-format"),st("ngModel",e.logFormat),m("checked",0==e.logFormat)("value",0),h(3),go("name","",e.panelId,"-log-output-format"),st("ngModel",e.logFormat),m("checked",1==e.logFormat)("value",1),h(8),go("name","",e.panelId,"-log-output-timestamp-type"),st("ngModel",e.dateFormat),m("checked",""==e.dateFormat)("value",""),h(3),go("name","",e.panelId,"-log-output-timestamp-type"),st("ngModel",e.dateFormat),m("checked","HH:mm"==e.dateFormat)("value","HH:mm"),h(3),go("name","",e.panelId,"-log-output-timestamp-type"),st("ngModel",e.dateFormat),m("checked","yyyy/MM/dd HH:mm"==e.dateFormat)("value","yyyy/MM/dd HH:mm"),h(6),Et("checked",e.isWriteOerationLog?"checked":""),st("ngModel",e.isWriteOerationLog),h(5),m("disabled",e.isDiable)}}function uK(t,n){1&t&&(Ue(0),p(1,"div",16),y(2,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002"),g(),ze())}let d4=(()=>{class t{static#e=this.isAllTabs=!1;static#t=this.logFormat=1;static#n=this.dateFormat="HH:mm";static#i=this.isWriteOerationLog=!0;get isAllTabs(){return t.isAllTabs}set isAllTabs(e){t.isAllTabs=e}get logFormat(){return t.logFormat}set logFormat(e){t.logFormat=e}get dateFormat(){return t.dateFormat}set dateFormat(e){t.dateFormat=e}get isWriteOerationLog(){return t.isWriteOerationLog}set isWriteOerationLog(e){t.isWriteOerationLog=e}get tabName(){return this.selectedTab.name}set tabName(e){this.selectedTab.name=e}get chatTabs(){return this.chatMessageService.chatTabs}get isEmpty(){return this.chatMessageService.chatTabs.length<1}get isDeleted(){return!!this.selectedTab&&null==bt.instance.get(this.selectedTab.identifier)}get isDiable(){return this.isEmpty||!this.isAllTabs&&(!this.selectedTab||this.isDeleted)}get roomName(){return jt.peer&&0<jt.peer.roomName.length?jt.peer.roomName:"\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf"}constructor(e,i,r,o){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.saveDataService=o,this.selectedTab=null}ngOnInit(){Promise.resolve().then(()=>{this.modalService.title=this.panelService.title="\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0\u51fa\u529b",this.panelService.isAbleFullScreenButton=!1}),ne.register(this).on("DELETE_GAME_OBJECT",1e3,e=>{this.selectedTab&&e.data.identifier===this.selectedTab.identifier&&bt.instance.get(e.data.identifier)}),this.panelId=oa.generateUuid()}ngOnDestroy(){ne.unregister(this)}onChangeSelectTab(e){this.selectedTab=bt.instance.get(e)}saveLog(){this.isDiable||this.saveDataService.saveChatLog(this.logFormat,this.roomName+"_chatLog_"+(this.isAllTabs?"\u5168\u3066\u306e\u30bf\u30d6":this.selectedTab.name),this.isAllTabs?null:this.selectedTab,this.dateFormat,this.isWriteOerationLog)}static#r=this.\u0275fac=function(i){return new(i||t)(Y(Ei),Y(yi),Y(vo),Y(ll))};static#o=this.\u0275cmp=In({type:t,selectors:[["app-chat-log-output"]],decls:8,vars:5,consts:[["select",""],[1,"flex-container"],[1,"flex-item","no-grow"],["size","10",2,"width","140px",3,"change","ngModel","disabled"],[3,"value",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[3,"value"],[2,"font-weight","bolder","font-size","smaller","padding-top","3px"],[1,"self-only"],["type","radio",3,"ngModelChange","name","ngModel","checked","value"],[2,"width","100%","display","flex"],[2,"font-weight","bolder","font-size","smaller","padding-top","3px","padding-right","1em"],["type","checkbox",3,"ngModelChange","ngModel","checked"],[2,"flex-grow","1","text-align","right"],[2,"font-size","smaller",3,"click","disabled"],[2,"font-size","12px"]],template:function(i,r){if(1&i){const o=Le();p(0,"div",1)(1,"div",2)(2,"select",3,0),he("change",function(){V(o);const a=pn(3);return H(r.onChangeSelectTab(a.value))}),q(4,lK,2,2,"option",4),g()(),p(5,"div",5),q(6,cK,49,38,"ng-container",6),g()(),q(7,uK,3,0,"ng-container",6)}2&i&&(h(2),m("ngModel",null==r.selectedTab?null:r.selectedTab.identifier)("disabled",r.isAllTabs),h(2),m("ngForOf",r.chatTabs),h(2),m("ngIf",!r.isEmpty),h(),m("ngIf",r.isEmpty))},dependencies:[nr,ri,na,ia,kr,Ea,Ia,Yd,Or,Cr],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}label[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]{margin-left:.5em}.self-only[_ngcontent-%COMP%]{color:red}.log-sample-text[_ngcontent-%COMP%], .log-sample-html[_ngcontent-%COMP%]{background-color:#fff;font-size:smaller;overflow-y:hidden;width:100%;min-height:1.6em}select[_ngcontent-%COMP%]:disabled   option[_ngcontent-%COMP%]{color:HighlightText;background-color:Highlight}"]})}return t})();const dK=t=>({"is-hidden":t});function hK(t,n){if(1&t&&(p(0,"option",8),y(1),g()),2&t){const e=n.$implicit;je("color",""==e.name?"gray":""),Et("value",e.identifier),Et("title",e.name),h(),Xe(""==e.name?"(\u7121\u540d\u306e\u30bf\u30d6)":e.name)}}function fK(t,n){if(1&t&&(p(0,"div",22),y(1),g()),2&t){const e=v(3);h(),Si("",e.progresPercent,"%")}}function pK(t,n){if(1&t){const e=Le();Ue(0),p(1,"button",14),he("click",function(){return V(e),H(v(2).upTabIndex())}),y(2,"\u2191"),g(),p(3,"button",14),he("click",function(){return V(e),H(v(2).downTabIndex())}),y(4,"\u2193"),g(),p(5,"div",15)(6,"button",14),he("click",function(){return V(e),H(v(2).showLogOutput())}),p(7,"i",16),y(8,"history_edu"),g(),y(9,"\u30ed\u30b0"),g(),p(10,"button",17),he("click",function(){return V(e),H(v(2).save())}),p(11,"div",18)(12,"div",19),y(13,"\u4fdd\u5b58"),g(),q(14,fK,2,1,"div",20),g()(),p(15,"button",21),he("click",function(){return V(e),H(v(2).delete())}),y(16,"\u524a\u9664"),g()(),ze()}if(2&t){const e=v(2);h(10),m("disabled",e.isSaveing),h(2),m("ngClass",Ke(4,dK,e.isSaveing)),h(2),m("ngIf",e.isSaveing),h(),en("disabled",e.chatTabs.length<=1?"":null)}}function gK(t,n){if(1&t){const e=Le();Ue(0),p(1,"button",14),he("click",function(){return V(e),H(v(2).restore())}),y(2,"\u5143\u306b\u623b\u3059"),g(),ze()}}function mK(t,n){if(1&t){const e=Le();Ue(0),p(1,"div")(2,"b",9),y(3,"\u30bf\u30d6\u540d: "),g(),p(4,"input",10),at("ngModelChange",function(r){V(e);const o=v();return it(o.tabName,r)||(o.tabName=r),H(r)}),g()(),p(5,"div",11)(6,"label")(7,"input",12),at("ngModelChange",function(r){V(e);const o=v();return it(o.isUseStandImage,r)||(o.isUseStandImage=r),H(r)}),he("change",function(){V(e);const r=v();return H(r.isUseStandImage=!!r.isUseStandImage)}),g(),p(8,"span",13),y(9,"\u{1f4ad}"),g(),y(10,"\u3001\u30ab\u30c3\u30c8\u30a4\u30f3\u3001\u30b9\u30bf\u30f3\u30c9\u6709\u52b9 "),g()(),p(11,"div",11)(12,"label")(13,"input",12),at("ngModelChange",function(r){V(e);const o=v();return it(o.recieveOperationLogLevel,r)||(o.recieveOperationLogLevel=r),H(r)}),he("change",function(){V(e);const r=v();return H(r.recieveOperationLogLevel=r.recieveOperationLogLevel>0?1:0)}),g(),y(14," \u64cd\u4f5c\u30ed\u30b0\u3092\u53d7\u4fe1\u3059\u308b "),g()(),Ge(15,"hr"),p(16,"div"),q(17,pK,17,6,"ng-container",7)(18,gK,3,0,"ng-container",7),g(),ze()}if(2&t){const e=v();h(4),st("ngModel",e.tabName),en("disabled",e.isEditable?null:""),h(2),je("cursor",e.isEditable?"pointer":"default"),h(),Et("checked",e.isUseStandImage?"checked":""),st("ngModel",e.isUseStandImage),en("disabled",e.isEditable?null:""),h(5),je("cursor",e.isEditable?"pointer":"default"),h(),Et("checked",e.recieveOperationLogLevel>0?"checked":""),st("ngModel",e.recieveOperationLogLevel),en("disabled",e.isEditable?null:""),h(4),m("ngIf",!e.isDeleted),h(),m("ngIf",e.isDeleted)}}function _K(t,n){1&t&&(Ue(0),p(1,"div",23),y(2,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b\u300d\u304b\u3089\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),g(),ze())}let bK=(()=>{class t{get tabName(){return this.selectedTab.name}set tabName(e){this.isEditable&&(this.selectedTab.name=e)}get isUseStandImage(){return this.selectedTab.isUseStandImage}set isUseStandImage(e){this.isEditable&&(this.selectedTab.isUseStandImage=e)}get recieveOperationLogLevel(){return this.selectedTab.recieveOperationLogLevel}set recieveOperationLogLevel(e){this.isEditable&&(this.selectedTab.recieveOperationLogLevel=e)}get chatTabs(){return this.chatMessageService.chatTabs}get isEmpty(){return this.chatMessageService.chatTabs.length<1}get isDeleted(){return!!this.selectedTab&&null==bt.instance.get(this.selectedTab.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}get roomName(){return jt.peer&&0<jt.peer.roomName.length?jt.peer.roomName:"\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf"}constructor(e,i,r,o,s){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.saveDataService=o,this.pointerDeviceService=s,this.selectedTab=null,this.selectedTabXml="",this.isSaveing=!1,this.progresPercent=0}ngOnInit(){Promise.resolve().then(()=>{this.modalService.title=this.panelService.title="\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u8a2d\u5b9a",this.panelService.isAbleFullScreenButton=!1}),ne.register(this).on("DELETE_GAME_OBJECT",2e3,e=>{if(!this.selectedTab||e.data.identifier!==this.selectedTab.identifier)return;let i=bt.instance.get(e.data.identifier);null!==i&&(this.selectedTabXml=i.toXml())})}ngOnDestroy(){ne.unregister(this)}onChangeSelectTab(e){this.selectedTab=bt.instance.get(e),this.selectedTabXml=""}create(){nc.instance.addChatTab("\u30bf\u30d6")}save(){var e=this;return(0,L.A)(function*(){if(!e.selectedTab||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i="fly_chat_"+e.selectedTab.name;yield e.saveDataService.saveGameObjectAsync(e.selectedTab,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}delete(){!this.isEmpty&&this.selectedTab&&(this.selectedTabXml=this.selectedTab.toXml(),this.selectedTab.destroy())}restore(){if(this.selectedTab&&this.selectedTabXml){let e=ar.instance.parseXml(this.selectedTabXml);nc.instance.addChatTab(e),this.selectedTabXml=""}}upTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,i=e.children.indexOf(this.selectedTab);0<i&&e.insertBefore(this.selectedTab,e.children[i-1])}downTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,i=e.children.indexOf(this.selectedTab);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.selectedTab)}showLogOutput(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(d4,{left:e.x-250,top:e.y-175,width:450,height:300}).selectedTab=this.selectedTab}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Ei),Y(yi),Y(vo),Y(ll),Y(lr))};static#t=this.\u0275cmp=In({type:t,selectors:[["app-chat-tab-setting"]],decls:11,vars:4,consts:[["select",""],[1,"flex-container"],[1,"flex-item","no-grow"],[2,"margin","0px 0px 2px 0px","font-size","smaller",3,"click"],["size","10",2,"width","100%","max-width","140px",3,"change","ngModel"],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[3,"value","title"],[2,"font-size","smaller"],["placeholder","Name",2,"width","200px",3,"ngModelChange","ngModel"],[2,"font-weight","bolder","font-size","smaller","padding-top","3px"],["type","checkbox",3,"ngModelChange","change","ngModel","checked"],[2,"text-shadow","#111 0 0 1px"],[3,"click"],[2,"float","right"],[1,"material-icons","small-font"],[3,"click","disabled"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(i,r){if(1&i){const o=Le();p(0,"div",1)(1,"div",2)(2,"div")(3,"button",3),he("click",function(){return V(o),H(r.create())}),y(4,"\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b"),g()(),p(5,"select",4,0),he("change",function(){V(o);const a=pn(6);return H(r.onChangeSelectTab(a.value))}),q(7,hK,2,5,"option",5),g()(),p(8,"div",6),q(9,mK,19,14,"ng-container",7),g()(),q(10,_K,3,0,"ng-container",7)}2&i&&(h(5),m("ngModel",null==r.selectedTab?null:r.selectedTab.identifier),h(2),m("ngForOf",r.chatTabs),h(2),m("ngIf",!r.isEmpty&&r.selectedTab),h(),m("ngIf",r.isEmpty))},dependencies:[Ni,nr,ri,na,ia,kr,Ea,Ia,Or,Cr],styles:["[_nghost-%COMP%]{display:block}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}.small-font[_ngcontent-%COMP%]{font-size:16px;vertical-align:middle}"]})}return t})();const vK=["chatTabComponemt"],h4=t=>({"is-active":t});function yK(t,n){if(1&t){const e=Le();p(0,"chat-tab",16,0),he("onAddMessage",function(){return V(e),H(v().scrollToBottom())}),g()}if(2&t){const e=v();m("chatTab",e.chatTab)("compact",e.isCompact)}}function CK(t,n){1&t&&(p(0,"div"),y(1,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u306e\u5185\u5bb9\u304c\u66f4\u65b0\u3055\u308c\u307e\u3057\u305f\u3002\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u9078\u629e\u3057\u306a\u304a\u3059\u304b\u3001\u3053\u306e\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u958b\u304d\u306a\u304a\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),g())}function xK(t,n){1&t&&(p(0,"i",9),y(1,"how_to_reg"),g())}function wK(t,n){1&t&&(p(0,"i",9),y(1,"history_edu"),g())}function EK(t,n){1&t&&Ge(0,"badge",21),2&t&&m("count",v().$implicit.unreadLength)}function IK(t,n){if(1&t){const e=Le();p(0,"label",17)(1,"input",18),at("ngModelChange",function(r){V(e);const o=v();return it(o.chatTabidentifier,r)||(o.chatTabidentifier=r),H(r)}),g(),p(2,"div")(3,"span"),y(4),g(),q(5,xK,2,0,"i",19)(6,wK,2,0,"i",19)(7,EK,1,1,"badge",20),g()()}if(2&t){const e=n.$implicit,i=v();h(),Et("value",e.identifier),st("ngModel",i.chatTabidentifier),h(2),je("cursor",i.chatTabidentifier!=e.identifier?"pointer":"")("color",""==e.name&&i.chatTabidentifier!=e.identifier?"gray":""),h(),Xe(""==e.name?"(\u7121\u540d\u306e\u30bf\u30d6)":e.name),h(),m("ngIf",e.isUseStandImage),h(),m("ngIf",e.recieveOperationLogLevel>0),h(),m("ngIf",e.hasUnread)}}let Bf=(()=>{class t{static#e=this.isNoticeOn=!1;get isNoticeOn(){return t.isNoticeOn}set isNoticeOn(e){t.isNoticeOn=e}get isCompact(){return this._isCompact}set isCompact(e){this._isCompact=e,this.chatTabComponemt.onScroll()}get gameType(){return this.chatMessageService.gameType?this.chatMessageService.gameType:"DiceBot"}set gameType(e){this.chatMessageService.gameType=e}get chatTabidentifier(){return this._chatTabidentifier}set chatTabidentifier(e){let i=this._chatTabidentifier!==e;this._chatTabidentifier=e,this.updatePanelTitle(),i&&this.scrollToBottom(!0)}get chatTab(){return bt.instance.get(this.chatTabidentifier)}constructor(e,i,r){this.chatMessageService=e,this.panelService=i,this.pointerDeviceService=r,this.sendFrom="Guest",this._isCompact=!1,this._chatTabidentifier="",this.isAutoScroll=!0,this.scrollToBottomTimer=null}ngOnInit(){this.sendFrom=Fe.myCursor.identifier,this._chatTabidentifier=0<this.chatMessageService.chatTabs.length?this.chatMessageService.chatTabs[0].identifier:"",ne.register(this).on("MESSAGE_ADDED",e=>{if(e.data.tabIdentifier!==this.chatTabidentifier)return;let i=bt.instance.get(e.data.messageIdentifier);i&&i.isSendFromSelf?this.isAutoScroll=!0:this.checkAutoScroll(),this.isAutoScroll&&this.chatTab&&this.chatTab.markForRead()}),Promise.resolve().then(()=>this.updatePanelTitle())}ngAfterViewInit(){queueMicrotask(()=>this.scrollToBottom(!0))}ngOnDestroy(){ne.unregister(this)}scrollToBottom(e=!1){if(e&&(this.isAutoScroll=!0),!this.isAutoScroll)return;let i=new CustomEvent("scrolltobottom",{});this.panelService.scrollablePanel.dispatchEvent(i),null==this.scrollToBottomTimer&&(this.scrollToBottomTimer=setTimeout(()=>{this.chatTab&&this.chatTab.markForRead(),this.scrollToBottomTimer=null,this.isAutoScroll=!1,this.panelService.scrollablePanel&&(this.panelService.scrollablePanel.scrollTop=this.panelService.scrollablePanel.scrollHeight)},0))}checkAutoScroll(){this.panelService.scrollablePanel&&(this.isAutoScroll=this.panelService.scrollablePanel.scrollHeight-this.panelService.scrollablePanel.clientHeight-150<=this.panelService.scrollablePanel.scrollTop)}updatePanelTitle(){this.panelService.title=this.chatTab&&""!==this.chatTab.name?"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6 - "+this.chatTab.name:"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6"}onSelectedTab(e){this.updatePanelTitle()}showTabSetting(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(bK,{left:e.x-250,top:e.y-175,width:460,height:330}).selectedTab=this.chatTab}showLogOutput(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(d4,{left:e.x-250,top:e.y-175,width:460,height:300}).selectedTab=this.chatTab}sendChat(e){this.chatTab&&this.chatMessageService.sendMessage(this.chatTab,e.text,e.gameType,e.sendFrom,e.sendTo,e.color,e.isInverse,e.isHollow,e.isBlackPaint,e.aura,e.isUseFaceIcon,e.characterIdentifier,e.standIdentifier,e.standName,e.isUseStandImage)}trackByChatTab(e,i){return i.identifier}static#t=this.\u0275fac=function(i){return new(i||t)(Y(vo),Y(yi),Y(lr))};static#n=this.\u0275cmp=In({type:t,selectors:[["chat-window"]],viewQuery:function(i,r){if(1&i&&Ln(vK,5),2&i){let o;Bn(o=Un())&&(r.chatTabComponemt=o.first)}},decls:28,vars:15,consts:[["chatTabComponemt",""],[1,"component"],[1,"log"],[3,"chatTab","compact","onAddMessage",4,"ngIf"],[4,"ngIf"],[1,"sticky-bottom"],[1,"chat-tab"],["class","tab",4,"ngFor","ngForOf","ngForTrackBy"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[2,"float","right","padding","1px 4px 1px 2px","margin-left","2px","height","24px","box-sizing","border-box"],["title","\u53d7\u4fe1\u6642\u306b\u97f3\u3067\u901a\u77e5",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"click","ngClass"],[1,"material-icons",2,"font-size","1em"],[2,"color","red"],["title","\u7c21\u6613\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"click","ngClass"],[3,"gameTypeChange","sendFromChange","chat","chatTabidentifier","gameType","sendFrom"],[3,"onAddMessage","chatTab","compact"],[1,"tab"],["name","chat-tab","type","radio","ng-control","options",3,"ngModelChange","value","ngModel"],["class","material-icons small-font",4,"ngIf"],["class","badge",3,"count",4,"ngIf"],[1,"badge",3,"count"]],template:function(i,r){1&i&&(p(0,"div",1)(1,"div",2),q(2,yK,2,2,"chat-tab",3)(3,CK,2,0,"div",4),g(),p(4,"div",5)(5,"form")(6,"div",6),q(7,IK,8,10,"label",7),p(8,"button",8),he("click",function(){return r.showTabSetting()}),p(9,"i",9),y(10,"settings"),g(),y(11,"\u30bf\u30d6"),g(),p(12,"button",8),he("click",function(){return r.showLogOutput()}),p(13,"i",9),y(14,"history_edu"),g(),y(15,"\u30ed\u30b0"),g(),p(16,"div",10)(17,"button",11),he("click",function(){return r.isNoticeOn=!r.isNoticeOn}),p(18,"i",12),y(19),g(),p(20,"sup",13),y(21,"*"),g()(),p(22,"button",14),he("click",function(){return r.isCompact=!r.isCompact}),p(23,"i",12),y(24),g(),p(25,"sup",13),y(26,"*"),g()()()()(),p(27,"chat-input",15),at("gameTypeChange",function(s){return it(r.gameType,s)||(r.gameType=s),s})("sendFromChange",function(s){return it(r.sendFrom,s)||(r.sendFrom=s),s}),he("chat",function(s){return r.sendChat(s)}),g()()()),2&i&&(h(2),m("ngIf",r.chatTab),h(),m("ngIf",!r.chatTab),h(4),m("ngForOf",r.chatMessageService.chatTabs)("ngForTrackBy",r.trackByChatTab),h(10),m("ngClass",Ke(11,h4,r.isNoticeOn)),h(2),Xe(r.isNoticeOn?"notifications_active":"notifications_off"),h(3),m("ngClass",Ke(13,h4,r.isCompact)),h(2),Xe(r.isCompact?"list":"forum"),h(3),m("chatTabidentifier",r.chatTabidentifier),st("gameType",r.gameType)("sendFrom",r.sendFrom))},styles:["[_nghost-%COMP%]{display:block;height:100%}.loop-anime[_ngcontent-%COMP%]{animation:anime1 1.3s infinite ease-in-out}.component[_ngcontent-%COMP%]{min-height:100%;display:flex;flex-direction:column;justify-content:space-between;align-content:space-between}.sticky-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;width:100%;background-color:#f0dabdcc;border-top:1px dotted #666;margin-bottom:0}.chat-tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 4px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}label.compact[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.tab[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{vertical-align:top;font-size:.8rem}button.indicate[_ngcontent-%COMP%]{margin:0 0 0 1px}button.indicate[_ngcontent-%COMP%]:disabled{border-color:transparent}button.indicate[_ngcontent-%COMP%]:disabled   .material-icons[_ngcontent-%COMP%]{color:#000}button.indicate[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:.5}button.indicate.is-active[_ngcontent-%COMP%]{background-color:#fff}button.indicate.is-active[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:1}button.indicate[_ngcontent-%COMP%]   sup[_ngcontent-%COMP%]{display:inline-block;top:2px;position:relative}"]})}return t})();const TK=["root"],SK=["altitudeSlider"],MK=(t,n,e,i)=>({"icons-panel":t,"submenu-panel":n,"is-max-limit":e,"pointer-events-none":i}),DK=t=>({action:t}),kK=(t,n,e)=>({"has-color":t,hasHighlight:n,disabled:e}),OK=(t,n)=>({"icon-menu":t,default:n});function AK(t,n){if(1&t){const e=Le();p(0,"span",13),y(1," (\u9ad8\u5ea6 "),p(2,"input",14),at("ngModelChange",function(r){V(e);const o=v(2);return it(o.altitudeHande.altitude,r)||(o.altitudeHande.altitude=r),H(r)}),g(),y(3,")"),g()}if(2&t){const e=v(2);h(2),st("ngModel",e.altitudeHande.altitude),m("disabled",!e.altitudeHande.isHaveAltitude||e.isAltitudeDisabled)}}function PK(t,n){if(1&t&&(p(0,"div")(1,"div",11),y(2),q(3,AK,4,2,"span",12),g()()),2&t){const e=v();h(),je("color",e.titleColor)("font-weight",e.titleBold?"bolder":"normal"),h(),Xe(e.title),h(),m("ngIf",e.altitudeHande)}}function FK(t,n){1&t&&(p(0,"div",15)(1,"div",16),y(2,"\u9ad8"),g(),p(3,"div",17),y(4,"0"),g(),p(5,"div",18),y(6,"\u4f4e"),g()())}function NK(t,n){if(1&t){const e=Le();p(0,"div",19)(1,"input",20,3),at("ngModelChange",function(r){V(e);const o=v();return it(o.altitudeHande.altitude,r)||(o.altitudeHande.altitude=r),H(r)}),g()()}if(2&t){const e=v();h(),Et("title",e.altitudeHande.altitude),st("ngModel",e.altitudeHande.altitude),m("disabled",!e.altitudeHande.isHaveAltitude||e.isAltitudeDisabled)}}function RK(t,n){1&t&&ii(0)}function LK(t,n){if(1&t&&(Ue(0),q(1,RK,1,0,"ng-container",21),ze()),2&t){const e=v().$implicit;v();const i=pn(10),r=pn(12);h(),m("ngTemplateOutlet","separator"===(null==e?null:e.type)?r:i)("ngTemplateOutletContext",Ke(2,DK,e))}}function BK(t,n){if(1&t&&(Ue(0),q(1,LK,2,4,"ng-container",5),ze()),2&t){const e=n.$implicit;h(),m("ngIf",e)}}function UK(t,n){1&t&&(p(0,"span",45),y(1,"\u26a0\ufe0f"),g()),2&t&&Et("title",v().action.error)}function zK(t,n){1&t&&Ge(0,"input",46),2&t&&m("disabled",v().action.disabled)}function HK(t,n){1&t&&Ge(0,"input",47),2&t&&m("disabled",v().action.disabled)}function VK(t,n){1&t&&Ge(0,"input",48),2&t&&m("disabled",v().action.disabled)}function jK(t,n){1&t&&Ge(0,"input",49),2&t&&m("disabled",v().action.disabled)}function GK(t,n){1&t&&(p(0,"span",50),y(1,"\u25a0"),g())}function WK(t,n){1&t&&(p(0,"span",51),y(1,"\u25a0"),g())}function $K(t,n){1&t&&(p(0,"span",52),y(1,"\u25a0"),g())}function YK(t,n){1&t&&(p(0,"span",53),y(1,"\u25a0"),g())}function ZK(t,n){1&t&&(p(0,"span",54),y(1,"\u25a0"),g())}function qK(t,n){1&t&&(p(0,"span",55),y(1,"\u25a0"),g())}function XK(t,n){1&t&&(p(0,"span",56),y(1,"\u25a0"),g())}function KK(t,n){1&t&&(p(0,"span",57),y(1,"\u25a0"),g())}function QK(t,n){if(1&t&&(p(0,"span",58)(1,"i",59),y(2),g()()),2&t){const e=v().action;h(2),Xe(e.materialIcon)}}function JK(t,n){1&t&&(p(0,"sup",60),y(1,"*"),g())}function eQ(t,n){1&t&&Ge(0,"span",61),2&t&&m("innerHtml",v().action.hotkey,$r)}function tQ(t,n){if(1&t&&(p(0,"span",62),Ge(1,"img",63),Ut(2,"safe"),g()),2&t){const e=v().action;h(),m("src",zt(2,1,e.icon.url,"resourceUrl"),bn)}}function nQ(t,n){1&t&&(p(0,"i",64),y(1,"open_in_new"),g())}function iQ(t,n){1&t&&(p(0,"div",65)(1,"i",66),y(2,"arrow_forward_ios"),g()())}function rQ(t,n){if(1&t&&Ge(0,"context-menu",67),2&t){const e=v().action,i=v();m("title",e.name)("actions",i.subMenu)("isSubmenu",!0)}}function oQ(t,n){if(1&t){const e=Le();p(0,"li",22),he("click",function(){const r=V(e).action,o=v();return H(!(r.disabled||r.altitudeHande&&0==r.altitudeHande.altitude)&&o.doAction(r))})("mouseenter",function(){const r=V(e).action,o=v();return H(!(r.disabled||r.altitudeHande&&0==r.altitudeHande.altitude)&&o.showSubMenu(r))}),p(1,"div",23),q(2,UK,2,1,"span",24)(3,zK,1,1,"input",25)(4,HK,1,1,"input",26)(5,VK,1,1,"input",27)(6,jK,1,1,"input",28)(7,GK,2,0,"span",29)(8,WK,2,0,"span",30)(9,$K,2,0,"span",31)(10,YK,2,0,"span",32)(11,ZK,2,0,"span",33)(12,qK,2,0,"span",34)(13,XK,2,0,"span",35)(14,KK,2,0,"span",36)(15,QK,3,1,"span",37),Ge(16,"span",38),Ut(17,"safe"),q(18,JK,2,0,"sup",39)(19,eQ,1,1,"span",40)(20,tQ,3,4,"span",41)(21,nQ,2,0,"i",42),g(),q(22,iQ,3,0,"div",43)(23,rQ,1,3,"context-menu",44),g()}if(2&t){const e=n.action,i=v();je("padding-left",e.icon?0:(e.level?e.level+1.5:1.5)-(i.altitudeHande?.5:0),"em")("color",e.color?e.color:"")("text-align",e.center?"center":""),m("ngClass",Qs(32,kK,e.color,!(e.disabled||e.icon||e.altitudeHande&&0==e.altitudeHande.altitude),e.disabled||e.altitudeHande&&0==e.altitudeHande.altitude)),h(),m("ngClass",Tn(36,OK,e.icon,e.default)),h(),m("ngIf",e.error),h(),m("ngIf",e.name&&"check"==e.checkBox&&0==e.name.indexOf("\u2611")),h(),m("ngIf",e.name&&"check"==e.checkBox&&0==e.name.indexOf("\u2610")),h(),m("ngIf",e.name&&"radio"==e.checkBox&&0==e.name.indexOf("\u25c9")),h(),m("ngIf",e.name&&"radio"==e.checkBox&&0==e.name.indexOf("\u25cb")),h(),m("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30d6\u30e9\u30c3\u30af")),h(),m("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30d6\u30eb\u30fc")),h(),m("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30b0\u30ea\u30fc\u30f3")),h(),m("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30b7\u30a2\u30f3")),h(),m("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30ec\u30c3\u30c9")),h(),m("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30de\u30bc\u30f3\u30bf")),h(),m("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30a4\u30a8\u30ed\u30fc")),h(),m("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30db\u30ef\u30a4\u30c8")),h(),m("ngIf",e.materialIcon),h(),m("innerHTML",zt(17,29,i.actionNameHtmlEscape(e.name,e.checkBox),"html"),$r),h(2),m("ngIf",e.selfOnly),h(),m("ngIf",""!=e.hotkey),h(),m("ngIf",e.icon&&0<(null==e.icon?null:e.icon.url.length)),h(),m("ngIf",e.isOuterLink),h(),m("ngIf",e.subActions&&!e.disabled),h(),m("ngIf",i.subMenu&&i.parentMenu===e)}}function sQ(t,n){1&t&&(p(0,"li"),Ge(1,"hr",68),g())}let aQ=(()=>{class t{get altitudeHande(){for(let e of this.actions)if(e&&e.altitudeHande)return e.altitudeHande;return null}get isAltitudeDisabled(){return this.actions.some(e=>e&&e.altitudeDisabled)}get isIconsMenu(){for(let e of this.actions)if(!e||!e.icon)return!1;return!0}get isPointerDragging(){return this.pointerDeviceService.isDragging||this.pointerDeviceService.isTablePickGesture}constructor(e,i,r){this.elementRef=e,this.contextMenuService=i,this.pointerDeviceService=r,this.title="",this.actions=[],this.titleColor=Fe.CHAT_DEFAULT_COLOR,this.titleBold=!1,this.isSubmenu=!1,this.callbackOnOutsideClick=o=>this.onOutsideClick(o)}ngOnInit(){this.isSubmenu||(this.title=this.contextMenuService.title,this.actions=this.contextMenuService.actions,this.titleColor=this.contextMenuService.titleColor,this.titleBold=this.contextMenuService.titleBold)}ngAfterViewInit(){this.isSubmenu?this.adjustPositionSub():(this.adjustPositionRoot(),document.addEventListener("touchstart",this.callbackOnOutsideClick,!0),document.addEventListener("mousedown",this.callbackOnOutsideClick,!0))}ngOnDestroy(){document.removeEventListener("touchstart",this.callbackOnOutsideClick,!0),document.removeEventListener("mousedown",this.callbackOnOutsideClick,!0)}onOutsideClick(e){!1===this.rootElementRef.nativeElement.contains(e.target)&&this.close()}onContextMenu(e){e.stopPropagation(),e.preventDefault()}adjustPositionRoot(){let e=this.rootElementRef.nativeElement;e.style.left=this.contextMenuService.position.x+"px",e.style.top=this.contextMenuService.position.y+"px";let i=e.getBoundingClientRect(),r=0,o=0;window.innerWidth<i.right+r&&(r+=window.innerWidth-(i.right+r)),i.left+r<0&&(r+=0-(i.left+r)),window.innerHeight<i.bottom+o&&(o+=window.innerHeight-(i.bottom+o)),i.top+o<0&&(o+=0-(i.top+o)),e.style.left=e.offsetLeft+r+"px",e.style.top=e.offsetTop+o+"px",this.altitudeSlider&&(this.altitudeSlider.nativeElement.style.height=e.clientHeight-72+"px")}adjustPositionSub(){let i=this.rootElementRef.nativeElement,r=this.elementRef.nativeElement.parentElement.getBoundingClientRect(),o=i.getBoundingClientRect(),s=0,a=0;window.innerWidth<o.right+s&&(s-=r.width+o.width,s+=8),o.left+s<0&&(s+=0-(o.left+s)),window.innerHeight<o.bottom+a&&(a+=window.innerHeight-(o.bottom+a)),o.top+a<0&&(a+=0-(o.top+a)),i.style.left=i.offsetLeft+s+"px",i.style.top=i.offsetTop+a+"px"}doAction(e){this.showSubMenu(e),null!=e.action&&(e.action(),this.close())}showSubMenu(e){this.hideSubMenu(),clearTimeout(this.showSubMenuTimer),!(null==e.subActions||e.subActions.length<1)&&(this.showSubMenuTimer=setTimeout(()=>{this.parentMenu=e,this.subMenu=e.subActions,clearTimeout(this.hideSubMenuTimer)},250))}hideSubMenu(){clearTimeout(this.hideSubMenuTimer),this.hideSubMenuTimer=setTimeout(()=>{this.subMenu=null},1200)}close(){this.contextMenuService&&this.contextMenuService.close()}actionNameHtmlEscape(e,i=null){return null==e?"":("check"==i&&(e=e.replace(/^[\u2611\u2610]/,"")),"radio"==i&&(e=e.replace(/^[\u25c9\u25cb]/,"")),ke.escapeHtml(e).replace(/\ud83d\udcad/g,'<span style="text-shadow: #111 0 0 1px">\u{1f4ad}</span>'))}static#e=this.\u0275fac=function(i){return new(i||t)(Y(fr),Y(Bo),Y(lr))};static#t=this.\u0275cmp=In({type:t,selectors:[["context-menu"]],viewQuery:function(i,r){if(1&i&&(Ln(TK,7),Ln(SK,5)),2&i){let o;Bn(o=Un())&&(r.rootElementRef=o.first),Bn(o=Un())&&(r.altitudeSlider=o.first)}},hostBindings:function(i,r){1&i&&he("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{title:"title",actions:"actions",titleColor:"titleColor",titleBold:"titleBold",isSubmenu:"isSubmenu"},decls:13,vars:10,consts:[["root",""],["actionMenu",""],["separator",""],["altitudeSlider",""],[1,"component",2,"display","flex","flex-direction","column",3,"mouseleave","ngClass"],[4,"ngIf"],[2,"display","flex","align-items","center"],["class","altitude ruler","style","display: flex; align-self: stretch; flex-direction: column; align-content: center",4,"ngIf"],["class","altitude",4,"ngIf"],[2,"flex-grow","1"],[4,"ngFor","ngForOf"],[1,"title"],["style","font-size: small;",4,"ngIf"],[2,"font-size","small"],["type","number","step","0.1",2,"font-size","small","width","3.6em","text-align","right",3,"ngModelChange","ngModel","disabled"],[1,"altitude","ruler",2,"display","flex","align-self","stretch","flex-direction","column","align-content","center"],[2,"margin-top","2em"],[2,"align-self","center","margin-top","auto","margin-bottom","auto"],[2,"margin-bottom","2em"],[1,"altitude"],["type","range","max","12","min","-12","step","0.5","orient","vertical",1,"altitude",3,"ngModelChange","title","ngModel","disabled"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"click","mouseenter","ngClass"],[1,"menu-title",2,"width","100%",3,"ngClass"],[3,"title",4,"ngIf"],["type","checkbox","checked","",3,"disabled",4,"ngIf"],["type","checkbox",3,"disabled",4,"ngIf"],["type","radio","checked","",3,"disabled",4,"ngIf"],["type","radio",3,"disabled",4,"ngIf"],["class","color-indicator","style","color: #000",4,"ngIf"],["class","color-indicator","style","color: #00f",4,"ngIf"],["class","color-indicator","style","color: #0f0",4,"ngIf"],["class","color-indicator","style","color: #0ff",4,"ngIf"],["class","color-indicator","style","color: #f00",4,"ngIf"],["class","color-indicator","style","color: #f0f",4,"ngIf"],["class","color-indicator","style","color: #ff0",4,"ngIf"],["class","color-indicator","style","color: #fff",4,"ngIf"],["style","vertical-align: top",4,"ngIf"],[3,"innerHTML"],["class","self-only",4,"ngIf"],["class","hotkey",3,"innerHtml",4,"ngIf"],["class","imagebox",4,"ngIf"],["class","material-icons","style","font-size: 1rem",4,"ngIf"],["class","sub-menu-arrow",4,"ngIf"],[3,"title","actions","isSubmenu",4,"ngIf"],[3,"title"],["type","checkbox","checked","",3,"disabled"],["type","checkbox",3,"disabled"],["type","radio","checked","",3,"disabled"],["type","radio",3,"disabled"],[1,"color-indicator",2,"color","#000"],[1,"color-indicator",2,"color","#00f"],[1,"color-indicator",2,"color","#0f0"],[1,"color-indicator",2,"color","#0ff"],[1,"color-indicator",2,"color","#f00"],[1,"color-indicator",2,"color","#f0f"],[1,"color-indicator",2,"color","#ff0"],[1,"color-indicator",2,"color","#fff"],[2,"vertical-align","top"],[1,"material-icons",2,"font-size","150%","padding-left","2px"],[1,"self-only"],[1,"hotkey",3,"innerHtml"],[1,"imagebox"],[1,"image",3,"src"],[1,"material-icons",2,"font-size","1rem"],[1,"sub-menu-arrow"],[1,"material-icons",2,"font-size","1em","vertical-align","bottom"],[3,"title","actions","isSubmenu"],[1,"separator"]],template:function(i,r){if(1&i){const o=Le();p(0,"div",4,0),he("mouseleave",function(){return V(o),H(r.hideSubMenu())}),q(2,PK,4,6,"div",5),p(3,"div",6),q(4,FK,7,0,"div",7)(5,NK,3,3,"div",8),p(6,"div",9)(7,"ul"),q(8,BK,2,1,"ng-container",10),g()()()(),q(9,oQ,24,39,"ng-template",null,1,Ai)(11,sQ,2,0,"ng-template",null,2,Ai)}2&i&&(m("ngClass",Ja(5,MK,r.isIconsMenu,r.isSubmenu,!r.isSubmenu,r.isPointerDragging)),h(2),m("ngIf",!r.isIconsMenu&&0<r.title.length||r.altitudeHande),h(2),m("ngIf",r.altitudeHande),h(),m("ngIf",r.altitudeHande),h(3),m("ngForOf",r.actions))},dependencies:[Ni,nr,ri,uf,kr,yl,Cl,Or,Cr,t,cr],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;background:linear-gradient(-30deg,#f0dabde6,#fff4e8e6);border:solid 1px #999;padding:0;white-space:nowrap;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;z-index:2000000}.submenu-panel[_ngcontent-%COMP%]{position:absolute;left:calc(100% - 4px);top:-16px}.icons-panel[_ngcontent-%COMP%]{padding-bottom:2px}.icons-panel[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{width:54px;padding:1px}.icons-panel[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{padding:1px 0}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-max-limit[_ngcontent-%COMP%]{max-height:100%;max-width:100%}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em;font-size:12px;text-align:center;padding:4px 16px;margin:0 2px;color:#444;border-bottom:1px solid #AAA}.menu-title[_ngcontent-%COMP%]{display:inline-block}hr.separator[_ngcontent-%COMP%]{margin:.1em -12px;height:1px;border:0;background-color:#aaa}.sub-menu-arrow[_ngcontent-%COMP%]{display:inline-block;position:absolute;top:2px;bottom:0;right:1px}ul[_ngcontent-%COMP%]{list-style:none;padding:2px 0;margin:0}ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:relative;cursor:-moz-default;cursor:-webkit-default;cursor:default;padding:2px 20px;font-size:12px;color:#444}ul[_ngcontent-%COMP%] > li.hasHighlight[_ngcontent-%COMP%]:hover{color:#ccc;background-color:#1e1e1ecc}ul[_ngcontent-%COMP%] > li.has-color.hasHighlight[_ngcontent-%COMP%]:hover{text-shadow:1px 0px 1px #ffffff,0px 1px 1px #ffffff,-1px 0px 1px #ffffff,0px -1px 1px #ffffff}.menu-title[_ngcontent-%COMP%]:not(.icon-menu){overflow:hidden;max-width:16.5em;text-overflow:ellipsis}td.altitude[_ngcontent-%COMP%]{vertical-align:middle}input.altitude[_ngcontent-%COMP%]{writing-mode:bt-lr;-webkit-appearance:slider-vertical;appearance:slider-vertical;width:8px;height:100%;padding:3px}.disabled[_ngcontent-%COMP%]   .menu-title[_ngcontent-%COMP%], .disabled[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{color:gray}.altitude-view[_ngcontent-%COMP%]{color:#000;vertical-align:top;width:3em;text-align:right}.ruler[_ngcontent-%COMP%]{color:#444;font-size:small;padding-left:4px;padding-right:2px}.default[_ngcontent-%COMP%]{font-weight:bolder}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:50px;height:50px;max-width:50px;max-height:50px;vertical-align:top;margin-left:auto;margin-right:auto;text-align:center}.image[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:middle;object-fit:cover;object-position:50% 0%;border-radius:.5rem}.icon-menu[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none}.icon-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid transparent;z-index:400}.icon-menu[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{border:2px dotted rgba(255,0,0,40);z-index:600}.icon-menu.default[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid red;z-index:500}.color-indicator[_ngcontent-%COMP%]{font-size:larger;text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff;margin-right:-.2rem}.self-only[_ngcontent-%COMP%]{color:red}.hotkey[_ngcontent-%COMP%]{float:right;font-size:smaller}"]})}return t})();const lQ=["chatInput"],cQ=["chatPlette"];function uQ(t,n){1&t&&(p(0,"i",15),y(1,"how_to_reg"),g())}function dQ(t,n){1&t&&(p(0,"i",15),y(1,"history_edu"),g())}function hQ(t,n){1&t&&Ge(0,"badge",16),2&t&&m("count",v().$implicit.unreadLength)}function fQ(t,n){if(1&t){const e=Le();p(0,"label")(1,"input",12),at("ngModelChange",function(r){V(e);const o=v();return it(o.chatTabidentifier,r)||(o.chatTabidentifier=r),H(r)}),g(),p(2,"div")(3,"span"),y(4),g(),q(5,uQ,2,0,"i",13)(6,dQ,2,0,"i",13)(7,hQ,1,1,"badge",14),g()()}if(2&t){const e=n.$implicit,i=v();h(),Et("value",e.identifier),st("ngModel",i.chatTabidentifier),h(2),je("cursor",i.chatTabidentifier!=e.identifier?"pointer":"")("color",""==e.name&&i.chatTabidentifier!=e.identifier?"gray":""),h(),Xe(""==e.name?"(\u7121\u540d\u306e\u30bf\u30d6)":e.name),h(),m("ngIf",e.isUseStandImage),h(),m("ngIf",e.recieveOperationLogLevel>0),h(),m("ngIf",e.hasUnread)}}function pQ(t,n){if(1&t){const e=Le();p(0,"div",17)(1,"div",18)(2,"i",19),y(3,"info_outline"),g(),y(4," \u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u7de8\u96c6\u4e2d"),g(),p(5,"div",20)(6,"button",21),he("click",function(){return V(e),H(v().helpChatPallet())}),y(7,"?"),g()()()}}function gQ(t,n){if(1&t&&(p(0,"option",25),y(1),g()),2&t){const e=v().$implicit;je("color",v(3).color),Et("value",e),h(),Xe(e)}}function mQ(t,n){if(1&t&&(Ue(0),q(1,gQ,2,4,"option",24),ze()),2&t){const e=n.$implicit,i=v(3);h(),m("ngIf",i.filter(e))}}function _Q(t,n){if(1&t&&(Ue(0),q(1,mQ,2,1,"ng-container",5),ze()),2&t){const e=v(2);h(),m("ngForOf",e.filteredPaletteStrings)}}function bQ(t,n){if(1&t){const e=Le();p(0,"div",22)(1,"select",23,1),he("focus",function(){return V(e),H(v().arrowPalette())})("keydown.arrowUp",function(r){return V(e),H(v().moveToInput(r))})("keyup.arrowUp",function(){return V(e),H(v().arrowPalette())})("keyup.arrowDown",function(){return V(e),H(v().arrowPalette())})("keydown.enter",function(r){V(e);const o=pn(2);return H(v().enterPalette(o.value,r))})("click",function(){V(e);const r=pn(2);return H(v().clickPalette(r.value))}),q(3,_Q,2,1,"ng-container",11),g()()}if(2&t){const e=v();h(3),m("ngIf",e.palette)}}function vQ(t,n){if(1&t){const e=Le();p(0,"div",22)(1,"textarea",26),at("ngModelChange",function(r){V(e);const o=v();return it(o.editPalette,r)||(o.editPalette=r),H(r)}),g()()}if(2&t){const e=v();h(),st("ngModel",e.editPalette)}}function yQ(t,n){1&t&&(p(0,"span"),y(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u7de8\u96c6"),g())}function CQ(t,n){1&t&&(p(0,"span"),y(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u78ba\u5b9a"),g())}let Qg=(()=>{class t{get palette(){return this.character.chatPalette}get filteredPaletteStrings(){return this.ngZone.run(()=>{this.paletteRenewInterval&&(this.paletteRenewInterval=!1,this.paletteCache=this.character.chatPalette.getPalette().filter(e=>this.filter(e)))}),this.paletteCache}get color(){return this.chatInputComponent.color}get gameType(){return this._gameType?this._gameType:"DiceBot"}set gameType(e){this._gameType=e,this.character.chatPalette&&(this.character.chatPalette.dicebot=e)}get sendFrom(){return this.character.identifier}set sendFrom(e){this.onSelectedCharacter(e)}get diceBotInfos(){return Zi.diceBotInfos}get chatTab(){return bt.instance.get(this.chatTabidentifier)}get myPeer(){return Fe.myCursor}get otherPeers(){return bt.instance.getObjects(Fe)}constructor(e,i,r,o){this.chatMessageService=e,this.panelService=i,this.pointerDeviceService=r,this.ngZone=o,this.character=null,this.paletteCache=[],this.paletteRenewInterval=!0,this.paletteRenewIntervalId=setInterval(()=>{this.paletteRenewInterval=!0},200),this._gameType="",this.chatTabidentifier="",this.text="",this.sendTo="",this.isEdit=!1,this.editPalette="",this.filterText="",this.doubleClickTimer=null,this.selectedPaletteIndex=-1}ngOnInit(){Promise.resolve().then(()=>this.updatePanelTitle()),this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"",this.gameType=this.character.chatPalette?this.character.chatPalette.dicebot:"",ne.register(this).on("DELETE_GAME_OBJECT",e=>{this.character&&this.character.identifier===e.data.identifier&&this.panelService.close(),this.chatTabidentifier===e.data.identifier&&(this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"")})}ngOnDestroy(){ne.unregister(this),clearInterval(this.paletteRenewIntervalId),this.isEdit&&this.toggleEditMode()}updatePanelTitle(){this.panelService.title=this.character.name+" \u306e\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8"}onSelectedCharacter(e){this.isEdit&&this.toggleEditMode();let i=bt.instance.get(e);if(i instanceof gn){this.character=i;let r=this.character.chatPalette?this.character.chatPalette.dicebot:"";0<r.length&&(this.gameType=r)}this.updatePanelTitle()}clickPalette(e){if(!this.chatPletteElementRef.nativeElement)return;const i=this.palette.evaluate(e,this.character.rootDataElement);this.doubleClickTimer&&this.selectedPaletteIndex===this.chatPletteElementRef.nativeElement.selectedIndex?(clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.chatInputComponent.sendChat(null)):(this.selectedPaletteIndex=this.chatPletteElementRef.nativeElement.selectedIndex,this.text=i,this.chatInputComponent.textAreaElementRef.nativeElement.value=this.text,this.doubleClickTimer=setTimeout(()=>{this.doubleClickTimer=null},400))}moveToInput(e){this.chatPletteElementRef.nativeElement&&this.chatPletteElementRef.nativeElement.selectedIndex<=0&&(this.text=this._tempText,this.chatInputComponent.textAreaElementRef.nativeElement.value=this._tempText,this.chatInputComponent.textAreaElementRef.nativeElement.focus(),e.preventDefault())}arrowPalette(){this.chatPletteElementRef.nativeElement&&(this.selectedPaletteIndex=this.chatPletteElementRef.nativeElement.selectedIndex,this.selectedPaletteIndex>=0&&this.chatPletteElementRef.nativeElement.options[this.selectedPaletteIndex]&&this.ngZone.run(()=>{this.text=this.palette.evaluate(this.chatPletteElementRef.nativeElement.options[this.selectedPaletteIndex].value,this.character.rootDataElement),this.chatInputComponent.textAreaElementRef.nativeElement.value=this.text}))}enterPalette(e,i=null){this.chatPletteElementRef.nativeElement&&(this.text=this.palette.evaluate(e,this.character.rootDataElement),this.chatInputComponent.focusInput(),i&&i.preventDefault())}moveToPalette(e){this._tempText=e,this.chatPletteElementRef.nativeElement&&(this.chatPletteElementRef.nativeElement.options.length<=0||(this.chatPletteElementRef.nativeElement.selectedIndex<=0&&(this.chatPletteElementRef.nativeElement.options[0].selected=!0),this.chatPletteElementRef.nativeElement.focus()))}sendChat(e){if(this.chatTab){let i=this.palette.evaluate(e.text,this.character.rootDataElement);this.chatMessageService.sendMessage(this.chatTab,i,e.gameType,e.sendFrom,e.sendTo,e.color,e.isInverse,e.isHollow,e.isBlackPaint,e.aura,e.isUseFaceIcon,e.characterIdentifier,e.standIdentifier,e.standName,e.isUseStandImage),this.filterText=""}}resetPletteSelect(){this.chatPletteElementRef.nativeElement&&(this.chatPletteElementRef.nativeElement.selectedIndex=-1)}toggleEditMode(){this.isEdit=!this.isEdit,this.isEdit?this.editPalette=this.palette.value+"":this.palette.setPalette(this.editPalette)}filter(e){if(null==this.filterText||""==this.filterText.trim())return!0;const i=ke.toHalfWidth(this.filterText.replace(/[\u2015\u30fc\u2014\u2010]/g,"-").replace(/[\u3041-\u3096]/g,s=>String.fromCharCode(s.charCodeAt(0)+96))).replace(/[\r\n\s]+/," ").toUpperCase().trim();return ke.toHalfWidth(e.replace(/[\u2015\u30fc\u2014\u2010]/g,"-").replace(/[\u3041-\u3096]/g,s=>String.fromCharCode(s.charCodeAt(0)+96))).replace(/[\r\n\s]+/," ").toUpperCase().trim().indexOf(i)>=0||ke.toHalfWidth(/[{\uff5b]/.test(e)?this.palette.evaluate(e,this.character.rootDataElement).replace(/[\u2015\u30fc\u2014\u2010]/g,"-").replace(/[\u3041-\u3096]/g,s=>String.fromCharCode(s.charCodeAt(0)+96)):e).replace(/[\r\n\s]+/," ").toUpperCase().trim().indexOf(i)>=0}helpChatPallet(){let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(kf,{left:e.x,top:e.y,width:560,height:620});r.title="\u30c1\u30e3\u30c3\u30c8\u8a18\u6cd5\u3068\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u4f7f\u3044\u65b9",r.shadowing="\u{1f4ad}",r.text=["\u3000\u30d1\u30e9\u30e1\u30fc\u30bf\u64cd\u4f5c\u30b3\u30de\u30f3\u30c9\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\u306f\u5168\u89d2\u3068\u534a\u89d2\u3092\u533a\u5225\u3057\u307e\u305b\u3093\u3001\u307e\u305f\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\u3084\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u540d\u524d\u306f\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u306e\u5927\u6587\u5b57\u3068\u5c0f\u6587\u5b57\u3092\u533a\u5225\u3057\u307e\u305b\u3093\u3002\u4e0b\u8a18\u3092\u4f75\u7528\u3059\u308b\u5834\u5408\u3001\u30b9\u30da\u30fc\u30b9\u3067\u533a\u5207\u3063\u3066\u30d1\u30e9\u30e1\u30fc\u30bf\u64cd\u4f5c\u30b3\u30de\u30f3\u30c9\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\u3001\u30c1\u30e3\u30c3\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u9806\u306b\u8a18\u8ff0\u3057\u307e\u3059\u3001\u305d\u308c\u305e\u308c\u7701\u7565\u304c\u53ef\u80fd\u3067\u3059\u3002\n\n\u3000\u30c1\u30e3\u30c3\u30c8\u5185\u5bb9\u3092\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306b\u6e96\u5099\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u5404\u884c\u306b\u4e00\u3064\u306e\u5185\u5bb9\u3092\u8a18\u8ff0\u3057\u3001\u884c\u3092\u30b7\u30f3\u30b0\u30eb\u30af\u30ea\u30c3\u30af\u3067\u30c1\u30e3\u30c3\u30c8\u6b04\u306b\u547c\u3073\u51fa\u3057\u3001\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af\u3067\u9001\u4fe1\u3057\u307e\u3059\u3002\n\n\u30fb\u30d1\u30e9\u30e1\u30fc\u30bf\u64cd\u4f5c\u30b3\u30de\u30f3\u30c9\n\u3000\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304b\u3089\u306e\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u3001\u5148\u982d\u306b : \u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u540d\u3001\u64cd\u4f5c\uff08\u5897\u52a0 + \u3001\u6e1b\u5c11 -\u3001\u4ee3\u5165 =\uff09\u3001\u64cd\u4f5c\u5185\u5bb9\u306e\u9806\u306b\u8a18\u8ff0\u3057\u3066\u3001\u30c1\u30e3\u30c3\u30c8\u304b\u3089\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u64cd\u4f5c\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u64cd\u4f5c\u5185\u5bb9\u306b\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\u3092\u8a18\u8f09\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u7d50\u679c\u3067\u64cd\u4f5c\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff08\u30ea\u30bd\u30fc\u30b9\u3084\u6570\u5024\u3001\u80fd\u529b\u5024\u3092\u64cd\u4f5c\u3059\u308b\u5834\u5408\u3001\u6700\u5f8c\u306b\u4e00\u3064\u306e\u6570\u5b57\u3092\u8fd4\u3059\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\uff09\u3002\n\u3000\u307e\u305f\u3001\u64cd\u4f5c\u3068\u3057\u3066 > \u3092\u4f7f\u7528\u3059\u308c\u3070\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\u3092\uff08\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u3092\u884c\u308f\u305a\uff09\u76f4\u63a5\u30d1\u30e9\u30e1\u30fc\u30bf\u306b\u4ee3\u5165\u3067\u304d\u307e\u3059\uff08\u73fe\u72b6 name\u3001size\u3001height\u3001altitude \u306f\u64cd\u4f5c\u3067\u304d\u307e\u305b\u3093\uff09\u3002\u3055\u3089\u306b : \u3067\u533a\u5207\u3063\u3066\u8907\u6570\u306e\u64cd\u4f5c\u3092\u8a18\u8ff0\u3067\u304d\u307e\u3059\u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u64cd\u4f5c\u30b3\u30de\u30f3\u30c9\u306f\u30c1\u30e3\u30c3\u30c8\u306b\u8868\u793a\u3055\u308c\u307e\u305b\u3093\u3002\n\n\u30d1\u30e9\u30e1\u30fc\u30bf\u64cd\u4f5c\u30b3\u30de\u30f3\u30c9\u306e\u4f8b\uff09\n\u3000:HP+2d6:MP-4\u3000 HP\u30922d6\u56de\u5fa9\u3057\u3001MP\u30924\u70b9\u6d88\u8cbb\u3057\u307e\u3059\u3002\n\u3000:\u6d78\u98df\u7387+1D10\u3000 \u767b\u5834\uff01\n\n\u30ea\u30bd\u30fc\u30b9\u306e\u64cd\u4f5c\u306f\u6700\u5927\u5024\u304c\u9069\u7528\u3055\u308c\u307e\u3059\u3001\u30b3\u30de\u30f3\u30c9\u306b\u3088\u308b\u64cd\u4f5c\u3067\u306f\u6700\u5927\u5024\u3092\u8d85\u3048\u305a\u3001\u3059\u3067\u306b\u6700\u5927\u5024\u3092\u8d85\u3048\u3066\u3044\u308c\u3070\u305d\u308c\u4ee5\u4e0a\u5897\u52a0\u3057\u307e\u305b\u3093\u3002\n\n\u3000\u30c1\u30a7\u30c3\u30af\u30dc\u30c3\u30af\u30b9\u306f\u64cd\u4f5c\u304c + \u306e\u5834\u5408\u306f\u64cd\u4f5c\u5185\u5bb9\u306b\u95a2\u308f\u3089\u305a\u30aa\u30f3\u3001- \u306e\u5834\u5408\u306f\u30aa\u30d5\u306b\u306a\u308a\u307e\u3059\u3002\u307e\u305f\u7a7a\u6587\u5b57\u30010\u3001off\u3001\u2610\uff08\u7a7a\u306e\u30c1\u30a7\u30c3\u30af\u30dc\u30c3\u30af\u30b9\uff09\u3092\u4ee3\u5165\uff08 = \u307e\u305f\u306f > \uff09\u3057\u305f\u5834\u5408\u30aa\u30d5\u3001\u305d\u308c\u4ee5\u5916\u306e\u4ee3\u5165\u306f\u30aa\u30f3\u306b\u306a\u308a\u307e\u3059\u3001\u3055\u3089\u306b\u6210\u529f/\u5931\u6557\u3092\u8fd4\u3059\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u7d50\u679c\u3092\u4ee3\u5165\uff08 = \uff09\u3057\u305f\u5834\u5408\u3001\u6210\u529f\u306f\u30aa\u30f3\u3001\u5931\u6557\u306f\u30aa\u30d5\u3068\u306a\u308a\u307e\u3059\u3002\n\n\u30fb\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\n\u3000\u30c1\u30e3\u30c3\u30c8\u304b\u3089\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\u3092\u9001\u4fe1\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u3084\u8868\u306e\u53c2\u7167\u304c\u53ef\u80fd\u3067\u3059\u3002\u5b9f\u969b\u306e\u30b3\u30de\u30f3\u30c9\u306f\u30b2\u30fc\u30e0\u30b7\u30b9\u30c6\u30e0\u3054\u3068\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u306e\u30d8\u30eb\u30d7\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u307e\u305f\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u6a5f\u80fd\u306b\u3088\u308a\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\u3092\u62e1\u5f35\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30fb\u30d1\u30e9\u30e1\u30fc\u30bf\u53c2\u7167\n\u3000{ \u3068 } \u3067\u56f2\u3093\u3067\u30d1\u30e9\u30e1\u30fc\u30bf\u540d\u3092\u8a18\u8f09\u3059\u308b\u3068\u3001\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u304b\u3089\u9078\u629e\u3057\u305f\u969b\u3068\u30c1\u30e3\u30c3\u30c8\u3092\u9001\u4fe1\u3057\u305f\u969b\u306b\u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u5185\u5bb9\u306b\u7f6e\u304d\u63db\u3048\u3089\u308c\u307e\u3059\u3002\u307e\u305f\u30d1\u30e9\u30e1\u30fc\u30bf\u540d\u306e\u5148\u982d\u306b $ \u3092\u4ed8\u8a18\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u524d\u8ff0\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u64cd\u4f5c\u30b3\u30de\u30f3\u30c9\u3092\u9069\u7528\u5f8c\u306e\u5024\u3092\u53c2\u7167\u3057\u307e\u3059\u3002\n\u3000\u3055\u3089\u306b $\u6570\u5024 \u3092\u53c2\u7167\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u64cd\u4f5c\u306b\u3088\u308b\u5b9f\u969b\u306e\u5909\u5316\u91cf\uff08\u30ea\u30bd\u30fc\u30b9\u3001\u6570\u5024\u3001\u80fd\u529b\u5024\u306e\u307f\u3001\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u7d50\u679c\u3084\u6700\u5927\u5024\u306b\u3088\u308b\u5207\u308a\u6368\u3066\u3092\u8003\u616e\uff09\u3092\u53c2\u7167\u3057\u307e\u3059\u3002\u6570\u5024\u306f1\u304b\u3089\u958b\u59cb\u30671\u3067\u30d1\u30e9\u30e1\u30fc\u30bf\u64cd\u4f5c\u30b3\u30de\u30f3\u30c9\u306e\u6700\u521d\u306e\u64cd\u4f5c\u7d50\u679c\u30012\u30672\u756a\u76ee\u306e\u7d50\u679c\u2026\u3068\u306a\u308a\u307e\u3059\u3002\n\n\u30d1\u30e9\u30e1\u30fc\u30bf\u53c2\u7167\u306e\u4f8b\uff09\n\u3000:HP-2d6\u30002d6+{\u7b4b\u529b}+2\u3000 HP{$1}\u3001\u7b4b\u529b\u306b+2\u3057\u3066\u5224\u5b9a\uff08\u73fe\u5728HP {$HP}\uff09\n\n\u30fb\u8ffd\u52a0\u306e\u5024\n\u3000\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u884c\u306b //\u540d\u524d=\u5024 \u306e\u5f62\u3067\u8a18\u8ff0\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u540c\u69d8\u306b\u30c1\u30e3\u30c3\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u304b\u3089\u53c2\u7167\u3067\u304d\u308b\u5024\u3092\u8a2d\u5b9a\u3067\u304d\u307e\u3059\uff08\u30b3\u30de\u30f3\u30c9\u3067\u64cd\u4f5c\u306f\u3067\u304d\u307e\u305b\u3093\uff09\u3002\n\n\u8ffd\u52a0\u306e\u5024\u306e\u4f8b\uff09\n\u3000//\u4eca\u306e\u5929\u6c17=\u96e8\n\n\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u3044\u305a\u308c\u304b\u306e\u884c\u306b\u4e0a\u8a18\u306e\u4f8b\u306e\u3088\u3046\u306b\u8a18\u8ff0\u3055\u308c\u3066\u3044\u308c\u3070\u3001\u305d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304b\u3089\u9001\u4fe1\u3059\u308b\u30b3\u30de\u30f3\u30c9\u3084\u30c1\u30e3\u30c3\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u4e2d\u306e {\u4eca\u306e\u5929\u6c17} \u304c \u96e8 \u306b\u7f6e\u304d\u63db\u308f\u308a\u307e\u3059\u3002\n\n\u30fb\u6539\u884c\u3001\u7a7a\u767d\n\u3000\u30c1\u30e3\u30c3\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u4e2d\u306b \\n \u3068\u8a18\u8ff0\u3057\u305f\u5834\u5408\u305d\u3053\u3067\u6539\u884c\u3055\u308c\u307e\u3059\uff08n\u306f\u5c0f\u6587\u5b57\u3001\\n\u306f\u8868\u793a\u3055\u308c\u307e\u305b\u3093\uff09\u3001\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306f1\u884c\u306b\u4e00\u3064\u306e\u9001\u4fe1\u5185\u5bb9\u3092\u8a18\u8ff0\u3057\u3001\u6539\u884c\u3092\u76f4\u63a5\u8a18\u8ff0\u3067\u304d\u307e\u305b\u3093\u306e\u3067\u3001\u3053\u308c\u3092\u5229\u7528\u3057\u3066\u6539\u884c\u3057\u307e\u3059\u3002\n\u3000\\s \uff08s\u304c\u534a\u89d2\uff09\u3068\u8a18\u8ff0\u3057\u305f\u5834\u5408\u534a\u89d2\u30b9\u30da\u30fc\u30b9\u3001\\\uff53 \uff08\uff53\u304c\u5168\u89d2\uff09\u3068\u8a18\u8ff0\u3057\u305f\u5834\u5408\u5168\u89d2\u30b9\u30da\u30fc\u30b9\u3068\u306a\u308a\u307e\u3059\uff08\u5168\u89d2\u534a\u89d2\u3092\u533a\u5225\u3059\u308b\u4f8b\u5916\u3067\u3059\uff09\u3001\u30b3\u30de\u30f3\u30c9\u4e2d\u306b\u30b9\u30da\u30fc\u30b9\u306f\u8a18\u8ff0\u3067\u304d\u307e\u305b\u3093\u306e\u3067\u3001\u5fc5\u8981\u306a\u3089\u3053\u3061\u3089\u3092\u5229\u7528\u3057\u307e\u3059\u3002\u4f8b\u5916\u3068\u3057\u3066\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u30b3\u30de\u30f3\u30c9 CHOICE \u306e\u30b9\u30da\u30fc\u30b9\u533a\u5207\u308a\u3067\u306e\u8a18\u8ff0\u3067\u306f\u3001\u30b9\u30da\u30fc\u30b9\u3092\u8a18\u8ff0\u3067\u304d\u307e\u3059\u304c\u3001\u305d\u306e\u5834\u5408\u30c1\u30e3\u30c3\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8a18\u8ff0\u3067\u304d\u307e\u305b\u3093\uff08\u30b9\u30da\u30fc\u30b9\u533a\u5207\u308a\u306e\u6700\u5f8c\u3082CHOICE\u30b3\u30de\u30f3\u30c9\u306e\u4e00\u90e8\u3068\u307f\u306a\u3055\u308c\u307e\u3059\uff09\u3002\n\n\u30fb\u30eb\u30d3\uff08\u30d5\u30ea\u30ac\u30ca\uff09\n\u3000\u30c1\u30e3\u30c3\u30c8\u5185\u5bb9\u306e\u30d5\u30ea\u30ac\u30ca\u3092\u632f\u308a\u305f\u3044\u90e8\u5206\u306e\u958b\u59cb\u306b | \uff08\u30d1\u30a4\u30d7\uff09\u3001\u7d42\u4e86\u306b \u300a \u3068 \u300b \u3067\u56f2\u3093\u3067\u30d5\u30ea\u30ac\u30ca\u306e\u5185\u5bb9\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\n\u30eb\u30d3\u306e\u4f8b\uff09\n\u3000\u53d7\u3051\u308b\u304c\u826f\u3044\uff01\uff5c\u7d04\u675f\u3055\u308c\u305f\u52dd\u5229\u306e\u5263\u300a\u30a8\u30af\u30b9\u30ab\u30ea\u30d0\u30fc\u300b\uff01\n\n\u30fb\u{1f4ad}\n\u3000\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304b\u3089\u306e\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u3001 \u300c \u3068 \u300d \u3067\u56f2\u3093\u3060\u5185\u5bb9\u3092\u{1f4ad}\u3067\u8868\u793a\u3057\u307e\u3059\u3002"]}static#e=this.\u0275fac=function(i){return new(i||t)(Y(vo),Y(yi),Y(lr),Y(Pn))};static#t=this.\u0275cmp=In({type:t,selectors:[["chat-palette"]],viewQuery:function(i,r){if(1&i&&(Ln(lQ,7),Ln(cQ,5)),2&i){let o;Bn(o=Un())&&(r.chatInputComponent=o.first),Bn(o=Un())&&(r.chatPletteElementRef=o.first)}},inputs:{character:"character"},decls:14,vars:12,consts:[["chatInput",""],["chatPlette",""],[1,"flex-container"],[2,"flex-grow","0"],[1,"chat-tab"],[4,"ngFor","ngForOf"],[3,"moveToPalette","gameTypeChange","sendFromChange","textChange","filterTextChange","chat","onlyCharacters","chatTabidentifier","gameType","sendFrom","text","filterText"],["class","edit-info","style","display: flex",4,"ngIf"],["style","flex-grow: 1; height: 0; min-height: 100px;",4,"ngIf"],[2,"flex-grow","0","padding-left","0px","padding-top","1px"],["type","submit",2,"margin","0px",3,"click"],[4,"ngIf"],["name","chat-tab","type","radio","ng-control","options",3,"ngModelChange","value","ngModel"],["class","material-icons small-font",4,"ngIf"],["class","badge",3,"count",4,"ngIf"],[1,"material-icons","small-font"],[1,"badge",3,"count"],[1,"edit-info",2,"display","flex"],[2,"width","calc(100% - 1.6em)","text-align","center"],[1,"material-icons",2,"vertical-align","middle","font-size","1.05rem"],[2,"width","1.6em","text-align","right"],[2,"padding","2px 6px","vertical-align","baseline","font-size","x-small","height","1.24rem","cursor","help",3,"click"],[2,"flex-grow","1","height","0","min-height","100px"],["size","5",1,"palette",2,"overflow-y","auto",3,"focus","keydown.arrowUp","keyup.arrowUp","keyup.arrowDown","keydown.enter","click"],[3,"value","color",4,"ngIf"],[3,"value"],["placeholder","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8",1,"palette",2,"resize","none",3,"ngModelChange","ngModel"]],template:function(i,r){if(1&i){const o=Le();p(0,"div",2)(1,"div",3)(2,"form")(3,"div",4),q(4,fQ,8,10,"label",5),g()(),p(5,"chat-input",6,0),he("moveToPalette",function(a){return V(o),H(r.moveToPalette(a))}),at("gameTypeChange",function(a){return V(o),it(r.gameType,a)||(r.gameType=a),H(a)})("sendFromChange",function(a){return V(o),it(r.sendFrom,a)||(r.sendFrom=a),H(a)})("textChange",function(a){return V(o),it(r.text,a)||(r.text=a),H(a)})("filterTextChange",function(a){return V(o),it(r.filterText,a)||(r.filterText=a),H(a)}),he("chat",function(a){return V(o),H(r.sendChat(a))}),g(),q(7,pQ,8,0,"div",7),g(),q(8,bQ,4,1,"div",8)(9,vQ,2,1,"div",8),p(10,"div",9)(11,"button",10),he("click",function(){return V(o),H(r.toggleEditMode())}),q(12,yQ,2,0,"span",11)(13,CQ,2,0,"span",11),g()()()}2&i&&(h(4),m("ngForOf",r.chatMessageService.chatTabs),h(),m("onlyCharacters",!0)("chatTabidentifier",r.chatTabidentifier),st("gameType",r.gameType)("sendFrom",r.sendFrom)("text",r.text)("filterText",r.filterText),h(2),m("ngIf",r.isEdit),h(),m("ngIf",!r.isEdit),h(),m("ngIf",r.isEdit),h(3),m("ngIf",!r.isEdit),h(),m("ngIf",r.isEdit))},styles:["[_nghost-%COMP%]{display:block;height:100%}.edit-info[_ngcontent-%COMP%]{width:100%;text-align:center;color:#ccc;background-color:#1e1e1ecc}.palette[_ngcontent-%COMP%]{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;width:100%;height:100%}.flex-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.chat-tab[_ngcontent-%COMP%]{padding:0 5px 5px;-webkit-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:8px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:top;font-size:.6rem}"]})}return t})();const xQ=t=>({transform:t}),wQ=t=>({inverse:t}),EQ=(t,n,e,i,r,o,s,a)=>({black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}),IQ=(t,n)=>({"black-paint":t,hollow:n}),TQ=t=>({"disabled-text":t}),SQ=t=>({"current-icon":t});function MQ(t,n){if(1&t&&(p(0,"div",11),y(1),g()),2&t){const e=v(2);h(),Xe(e.isSpeaking?"\u{1f603}":"\u{1f910}")}}function DQ(t,n){if(1&t){const e=Le();Ue(0),p(1,"div")(2,"div",5)(3,"div",6)(4,"div",7)(5,"img",8),Ut(6,"safe"),he("dblclick",function(){return V(e),H(v().openModal())}),g()()()(),p(7,"button",9),he("click",function(){return V(e),H(v().openModal())}),p(8,"b"),y(9),g()(),q(10,MQ,2,1,"div",10),g(),ze()}if(2&t){const e=v();h(2),m("ngStyle",Ke(10,xQ,e.isApplyRoll?"rotate("+e.gameCharacter.roll+"deg)":"")),h(),m("ngClass",Ke(12,wQ,e.isApplyImageEffect&&e.gameCharacter.isInverse)),h(),m("ngClass",Yl(14,EQ,e.isApplyImageEffect&&0==e.gameCharacter.aura,e.isApplyImageEffect&&1==e.gameCharacter.aura,e.isApplyImageEffect&&2==e.gameCharacter.aura,e.isApplyImageEffect&&3==e.gameCharacter.aura,e.isApplyImageEffect&&4==e.gameCharacter.aura,e.isApplyImageEffect&&5==e.gameCharacter.aura,e.isApplyImageEffect&&6==e.gameCharacter.aura,e.isApplyImageEffect&&7==e.gameCharacter.aura)),h(),m("src",zt(6,7,e.standImage.url,"resourceUrl"),bn)("ngClass",Tn(23,IQ,e.isApplyImageEffect&&e.gameCharacter.isBlackPaint,e.isApplyImageEffect&&e.gameCharacter.isHollow)),h(4),Si("",e.isSpeakable?"\u901a\u5e38":"","\u753b\u50cf\u5909\u66f4"),h(),m("ngIf",e.isSpeakable)}}function kQ(t,n){if(1&t){const e=Le();Ue(0),p(1,"span",12)(2,"input",13),at("ngModelChange",function(r){V(e);const o=v();return it(o.nameElement.value,r)||(o.nameElement.value=r),H(r)}),g()(),ze()}if(2&t){const e=v();h(2),st("ngModel",e.nameElement.value)}}function OQ(t,n){if(1&t){const e=Le();Ue(0),p(1,"b",12),y(2,"\u3000Cond: "),g(),p(3,"select",14),at("ngModelChange",function(r){V(e);const o=v();return it(o.conditionTypeElement.value,r)||(o.conditionTypeElement.value=r),H(r)}),p(4,"option",15),y(5,"\u30c7\u30d5\u30a9\u30eb\u30c8"),g(),p(6,"option",15),y(7,"\u6307\u5b9a\u753b\u50cf"),g(),p(8,"option",15),y(9,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e"),g(),p(10,"option",15),y(11,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e \u307e\u305f\u306f \u6307\u5b9a\u753b\u50cf"),g(),p(12,"option",15),y(13,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e \u304b\u3064 \u6307\u5b9a\u753b\u50cf"),g(),p(14,"option",15),y(15,"\u9078\u629e\u6642\u306e\u307f"),g()(),ze()}if(2&t){const e=v();h(3),st("ngModel",e.conditionTypeElement.value),h(),Et("value",e.standConditionType.Default),h(2),Et("value",e.standConditionType.Image),h(2),Et("value",e.standConditionType.Postfix),h(2),Et("value",e.standConditionType.PostfixOrImage),h(2),Et("value",e.standConditionType.PostfixAndImage),h(2),Et("value",e.standConditionType.NotConditionStandUp)}}function AQ(t,n){if(1&t){const e=Le();Ue(0),p(1,"div",16)(2,"b",17),y(3,"Tag: "),g(),p(4,"input",18),at("ngModelChange",function(r){V(e);const o=v();return it(o.nameElement.currentValue,r)||(o.nameElement.currentValue=r),H(r)}),g()(),ze()}if(2&t){const e=v();h(4),st("ngModel",e.nameElement.currentValue)}}function PQ(t,n){if(1&t){const e=Le();Ue(0),p(1,"label",19)(2,"input",20),at("ngModelChange",function(r){V(e);const o=v();return it(o.showNameElement.value,r)||(o.showNameElement.value=r),H(r)}),he("change",function(){V(e);const r=v();return H(r.showNameElement.value=r.showNameElement.value?"showName":"")}),g(),p(3,"b",12),y(4,"\u30cd\u30fc\u30e0\u30bf\u30b0"),g()(),ze()}if(2&t){const e=v();h(2),Et("checked",e.showNameElement.value?"checked":""),st("ngModel",e.showNameElement.value)}}function FQ(t,n){if(1&t){const e=Le();Ue(0),p(1,"label",19)(2,"input",20),at("ngModelChange",function(r){V(e);const o=v();return it(o.applyImageEffectElement.value,r)||(o.applyImageEffectElement.value=r),H(r)}),he("change",function(){V(e);const r=v();return H(r.applyImageEffectElement.value=r.applyImageEffectElement.value?"applyImageEffect":"")}),g(),p(3,"b",12),y(4,"\u753b\u50cf\u52b9\u679c\u53cd\u6620"),g()(),ze()}if(2&t){const e=v();h(2),Et("checked",e.applyImageEffectElement.value?"checked":""),st("ngModel",e.applyImageEffectElement.value)}}function NQ(t,n){if(1&t){const e=Le();Ue(0),p(1,"label",19)(2,"input",20),at("ngModelChange",function(r){V(e);const o=v();return it(o.applyRollElement.value,r)||(o.applyRollElement.value=r),H(r)}),he("change",function(){V(e);const r=v();return H(r.applyRollElement.value=r.applyRollElement.value?"applyRoll":"")}),g(),p(3,"b",12),y(4,"\u56de\u8ee2\u53cd\u6620"),g()(),ze()}if(2&t){const e=v();h(2),Et("checked",e.applyRollElement.value?"checked":""),st("ngModel",e.applyRollElement.value)}}function RQ(t,n){if(1&t){const e=Le();Ue(0),p(1,"label",21)(2,"input",20),at("ngModelChange",function(r){V(e);const o=v();return it(o.applyDialogElement.value,r)||(o.applyDialogElement.value=r),H(r)}),he("change",function(){V(e);const r=v();return H(r.applyDialogElement.value=r.applyDialogElement.value?"applyDialog":"")}),g(),p(3,"b",22),y(4,"\u{1f4ad}"),g()(),ze()}if(2&t){const e=v();h(2),Et("checked",e.applyDialogElement.value?"checked":""),st("ngModel",e.applyDialogElement.value)}}function LQ(t,n){if(1&t){const e=Le();Ue(0),Ge(1,"br"),p(2,"button",23),he("click",function(){return V(e),H(v().testStandUp())}),p(3,"b"),y(4,"\u30c6\u30b9\u30c8 (\u81ea\u5206\u3060\u3051\u898b\u308b)"),p(5,"sup",24),y(6,"*"),g()()(),p(7,"label",25)(8,"input",20),at("ngModelChange",function(r){V(e);const o=v();return it(o.positionElement.currentValue,r)||(o.positionElement.currentValue=r),H(r)}),he("change",function(){V(e);const r=v();return H(r.positionElement.currentValue=r.positionElement.currentValue?"posSpecialize":"")}),g(),p(9,"b",12),y(10,"Pos\u500b\u5225\u6307\u5b9a: "),g()(),p(11,"span",26)(12,"input",27),at("ngModelChange",function(r){V(e);const o=v();return it(o.positionElement.value,r)||(o.positionElement.value=r),H(r)}),g(),p(13,"input",28),at("ngModelChange",function(r){V(e);const o=v();return it(o.positionElement.value,r)||(o.positionElement.value=r),H(r)}),g(),p(14,"b",29),y(15,"%"),g()(),ze()}if(2&t){const e=v();h(8),Et("checked",e.positionElement.currentValue?"checked":""),st("ngModel",e.positionElement.currentValue),h(4),m("title",e.positionElement.value+"%"),st("ngModel",e.positionElement.value),m("disabled",!e.positionElement.currentValue),h(),st("ngModel",e.positionElement.value),m("disabled",!e.positionElement.currentValue),h(),m("ngClass",Ke(8,TQ,!e.positionElement.currentValue))}}function BQ(t,n){if(1&t){const e=Le();Ue(0),Ge(1,"br"),p(2,"div",30)(3,"b",31),y(4,"Height (0=\u6307\u5b9a\u306a\u3057): "),g(),p(5,"input",32),at("ngModelChange",function(r){V(e);const o=v();return it(o.heightElement.value,r)||(o.heightElement.value=r),H(r)}),g(),p(6,"input",33),at("ngModelChange",function(r){V(e);const o=v();return it(o.heightElement.value,r)||(o.heightElement.value=r),H(r)}),g(),p(7,"b",34),y(8,"%"),g()(),p(9,"div",35)(10,"b",31),y(11,"AdjY: "),g(),p(12,"input",36),at("ngModelChange",function(r){V(e);const o=v();return it(o.heightElement.currentValue,r)||(o.heightElement.currentValue=r),H(r)}),g(),p(13,"b",34),y(14,"%"),g()(),ze()}if(2&t){const e=v();h(5),m("title",e.heightElement.value?e.heightElement.value+"%":"\u6307\u5b9a\u306a\u3057"),st("ngModel",e.heightElement.value),h(),st("ngModel",e.heightElement.value),h(6),st("ngModel",e.heightElement.currentValue)}}function UQ(t,n){if(1&t){const e=Le();p(0,"div")(1,"textarea",37),at("ngModelChange",function(r){V(e);const o=v();return it(o.postfixElement.value,r)||(o.postfixElement.value=r),H(r)}),g()()}if(2&t){const e=v();h(),st("ngModel",e.postfixElement.value)}}function zQ(t,n){if(1&t){const e=Le();p(0,"span",42)(1,"img",43),Ut(2,"safe"),he("click",function(){V(e);const r=v().$implicit;return H(v(3).selectImage(r.identifier))}),g()()}if(2&t){const e=v().$implicit,i=v(3);m("ngClass",Ke(6,SQ,i.isSelectedImage(e.identifier))),h(),m("src",zt(2,3,e.url,"resourceUrl"),bn)("alt",e.name)}}function HQ(t,n){if(1&t&&(Ue(0),q(1,zQ,3,8,"span",41),ze()),2&t){const e=n.$implicit;h(),m("ngIf",0<e.url.length)}}function VQ(t,n){if(1&t&&(p(0,"div",39),q(1,HQ,2,1,"ng-container",40),g()),2&t){const e=v(2);h(),m("ngForOf",e.imageList)}}function jQ(t,n){1&t&&(p(0,"div")(1,"b",44),y(2,"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u753b\u50cf\u3001\u9854IC\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),g()())}function GQ(t,n){if(1&t&&(p(0,"div"),q(1,VQ,2,1,"div",38)(2,jQ,3,0,"div",2),g()),2&t){const e=v();h(),m("ngIf",e.imageList&&e.imageList.length>0),h(),m("ngIf",!e.imageList||0==e.imageList.length)}}let f4=(()=>{class t{constructor(e){this.modalService=e,this.standElement=null,this.imageList=[],this.gameCharacter=null,this.isSpeaking=!1,this._imageFile=vn.Empty,this.standConditionType=mo}ngOnInit(){}get standImage(){if(!this.standElement)return this._imageFile;let e=null;if(this.isSpeaking&&(e=this.standElement.getFirstElementByName("speakingImageIdentifier"),e||(e=this.standElement.appendChild(wt.create("speakingImageIdentifier",vn.Empty.identifier,{type:"image"},"speakingImageIdentifier_"+this.standElement.identifier)))),(!e||!e.value||e.value==vn.Empty.identifier)&&(e=this.standElement.getFirstElementByName("imageIdentifier")),e){if(this._imageFile.identifier!==e.value){let i=on.instance.get(e.value);this._imageFile=i||vn.Empty}}else{let i=vn.createEmpty("stand_no_image").toContext();i.url="./assets/images/nc96424.png",this._imageFile=on.instance.add(i),this.standElement.appendChild(wt.create("imageIdentifier",this._imageFile.identifier,{type:"image"},"imageIdentifier_"+this.standElement.identifier))}return this._imageFile}get nameElement(){return this.standElement?this.standElement.getFirstElementByName("name")||this.standElement.appendChild(wt.create("name","",{},"name_"+this.standElement.identifier)):null}get heightElement(){return this.standElement?this.standElement.getFirstElementByName("height")||this.standElement.appendChild(wt.create("height",0,{currentValue:0},"height_"+this.standElement.identifier)):null}get conditionTypeElement(){return this.standElement?this.standElement.getFirstElementByName("conditionType")||this.standElement.appendChild(wt.create("conditionType",mo.Default,{},"conditionType_"+this.standElement.identifier)):null}get postfixElement(){return this.standElement?this.standElement.getFirstElementByName("postfix")||this.standElement.appendChild(wt.create("postfix","",{},"postfix_"+this.standElement.identifier)):null}get applyImageEffectElement(){return this.standElement?this.standElement.getFirstElementByName("applyImageEffect")||this.standElement.appendChild(wt.create("applyImageEffect","",{},"applyImageEffect_"+this.standElement.identifier)):null}get applyRollElement(){return this.standElement?this.standElement.getFirstElementByName("applyRoll")||this.standElement.appendChild(wt.create("applyRoll","",{},"applyRoll_"+this.standElement.identifier)):null}get applyDialogElement(){return this.standElement?this.standElement.getFirstElementByName("applyDialog")||this.standElement.appendChild(wt.create("applyDialog","applyDialog",{},"applyDialog_"+this.standElement.identifier)):null}get showNameElement(){return this.standElement?this.standElement.getFirstElementByName("showName")||this.standElement.appendChild(wt.create("showName","showName",{},"showName_"+this.standElement.identifier)):null}get positionElement(){return this.standElement?this.standElement.getFirstElementByName("position")||this.standElement.appendChild(wt.create("position",0,{currentValue:""},"position_"+this.standElement.identifier)):null}get isApplyImageEffect(){let e=this.applyImageEffectElement;return!(!e||!e.value)}get isApplyRoll(){let e=this.applyRollElement;return!(!e||!e.value)}get isApplyDialog(){let e=this.applyDialogElement;return!(!e||!e.value)}get isShowName(){let e=this.showNameElement;return!(!e||!e.value)}get isSpeakable(){if(!this.standElement)return!1;const e=this.standElement.getFirstElementByName("speakingImageIdentifier");return e&&e.value&&e.value!==vn.Empty.identifier}openModal(e="imageIdentifier",i=!1){if(!this.standElement)return;let r=[],o=this.standElement.getFirstElementByName(e);o?r=[o.value+""]:o=this.standElement.appendChild(wt.create(e,"",{type:"image"},e+"_"+this.standElement.identifier)),this.modalService.open(Yc,{isAllowedEmpty:i,currentImageIdentifires:r}).then(s=>{s&&(o.value=s)})}openSpeakingModal(){this.openModal("speakingImageIdentifier",!0)}remove(){this.standElement&&this.standElement.parent.removeChild(this.standElement)}selectImage(e){if(!this.standElement)return;let i=!1;for(let r of this.standElement.getElementsByName("targetImageIdentifier")){let o=!0;for(let s of this.imageList)if(s.identifier==r.value){o=!1;break}o?this.standElement.removeChild(r):r.value==e&&(i=!0,this.standElement.removeChild(r))}i||this.standElement.appendChild(wt.create("targetImageIdentifier",e,{},"targetImageIdentifier_"+oa.generateUuid()))}isSelectedImage(e){let i=this.standElement.getElementsByName("targetImageIdentifier");for(let r of i)if(r.value==e)return!0;return!1}testStandUp(){ne.trigger("POPUP_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier,standIdentifier:this.standElement.identifier,color:this.gameCharacter.chatPalette?this.gameCharacter.chatPalette.color:null}),ne.trigger("POPUP_CHAT_BALLOON",{characterIdentifier:this.gameCharacter.identifier,text:"\u3053\u308c\u306f\u30c6\u30b9\u30c8\u3067\u3059\u3001\u3042\u306a\u305f\u306b\u3060\u3051\u898b\u3048\u3066\u3044\u307e\u3059\u3002\u30b9\u30bf\u30f3\u30c9\u306e\u8a2d\u5b9a\u3092\u884c\u3046\u969b\u306f\u3001\u30e1\u30cb\u30e5\u30fc\u306e\u300c\u500b\u4eba\u8a2d\u5b9a\u300d\u304b\u3089\u300c\u900f\u660e\u5316\u3001\u81ea\u52d5\u9000\u53bb\u300d\u3092\u30aa\u30d5\u306b\u3059\u308b\u3068\u5fae\u8abf\u6574\u304c\u884c\u3044\u3084\u3059\u304f\u306a\u308a\u307e\u3059\u3002",color:this.gameCharacter.chatPalette?this.gameCharacter.chatPalette.color:null,dialogTest:!0})}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Ei))};static#t=this.\u0275cmp=In({type:t,selectors:[["stand-element"]],inputs:{standElement:"standElement",imageList:"imageList",gameCharacter:"gameCharacter",isSpeaking:"isSpeaking"},decls:20,vars:14,consts:[[1,"stand-container"],[1,"stand-image-container"],[4,"ngIf"],[2,"display","flex","flex-direction","column","padding-left","3px","width","100%"],[2,"font-size","9px",3,"click"],[3,"ngStyle"],[1,"inverser",3,"ngClass"],[1,"aura",2,"display","inline",3,"ngClass"],["draggable","false",1,"stand-image",3,"dblclick","src","ngClass"],[1,"stand-image-button",2,"font-size","smaller","padding","2px 3px",3,"click"],["style","position: absolute; margin-top: -26px; margin-left: 120px; font-size: 22px; filter: grayscale(100%); opacity: 0.5; cursor: default;",4,"ngIf"],[2,"position","absolute","margin-top","-26px","margin-left","120px","font-size","22px","filter","grayscale(100%)","opacity","0.5","cursor","default"],[2,"font-size","smaller"],["type","text","placeholder","Name",2,"width","7em",3,"ngModelChange","ngModel"],[2,"width","15.5em",3,"ngModelChange","ngModel"],[3,"value"],[2,"display","inline","font-size","smaller"],[2,"margin-left","1em"],["type","text","placeholder","Tag",2,"width","3em",3,"ngModelChange","ngModel"],[2,"margin-right","0.6em"],["type","checkbox",3,"ngModelChange","change","ngModel","checked"],[2,"margin-right","0.2em"],[2,"font-size","smaller","text-shadow","#111 0 0 1px"],[2,"font-size","9px","margin-right","1em",3,"click"],[1,"self-only"],[2,"margin-right","0.3em"],[2,"white-space","nowrap","font-size","smaller"],["type","range","min","0","max","100",2,"width","140px",3,"ngModelChange","title","ngModel","disabled"],["type","number","min","0","max","100",2,"width","3em","text-align","right",3,"ngModelChange","ngModel","disabled"],[2,"display","inline-block","font-size","smaller","margin-left","3px",3,"ngClass"],[2,"display","inline","white-space","nowrap","font-size","smaller"],[2,"display","inline-block","margin-left","3px"],["type","range","min","0","max","100",2,"width","130px",3,"ngModelChange","title","ngModel"],["type","number","min","0","max","200",2,"width","3em","text-align","right",3,"ngModelChange","ngModel"],[2,"display","inline-block","font-size","smaller","margin-left","3px"],[2,"display","inline","white-space","nowrap","margin-left","0.8em","font-size","smaller"],["type","number","min","-100","max","100",2,"width","3.4em","text-align","right",3,"ngModelChange","ngModel"],["placeholder","1\u884c\u306b\u4e00\u3064\u3001\u5192\u982d@\u3092\u4ed8\u3051\u308b\u3068\u30de\u30c3\u30c1\u6642\u306b\u30c6\u30ad\u30b9\u30c8\u304b\u3089\u5207\u308a\u53d6\u308a\r\n@\u6012\u308a\r\n@\u5fc5\u6bba\u6280",2,"width","100%","margin-top","3px","height","2.4rem",3,"ngModelChange","ngModel"],["style","display: flex; flex-wrap: wrap; margin-right: -30px;",4,"ngIf"],[2,"display","flex","flex-wrap","wrap","margin-right","-30px"],[4,"ngFor","ngForOf"],["style","display: block","class","icon-image-box",3,"ngClass",4,"ngIf"],[1,"icon-image-box",2,"display","block",3,"ngClass"],["draggable","false","draggable","false",2,"cursor","pointer",3,"click","src","alt"],[2,"font-size","smaller","color","red"]],template:function(i,r){1&i&&(p(0,"div")(1,"div",0)(2,"div",1),q(3,DQ,11,26,"ng-container",2),g(),p(4,"div",3)(5,"div"),q(6,kQ,3,1,"ng-container",2)(7,OQ,16,7,"ng-container",2)(8,AQ,5,1,"ng-container",2),g(),p(9,"div"),q(10,PQ,5,2,"ng-container",2)(11,FQ,5,2,"ng-container",2)(12,NQ,5,2,"ng-container",2)(13,RQ,5,2,"ng-container",2),p(14,"button",4),he("click",function(){return r.openSpeakingModal()}),y(15,"\u53e3\u30d1\u30af\u753b\u50cf (APNG\u306a\u3069)"),g(),q(16,LQ,16,10,"ng-container",2)(17,BQ,15,4,"ng-container",2),g(),q(18,UQ,2,1,"div",2)(19,GQ,3,2,"div",2),g()()()),2&i&&(h(3),m("ngIf",r.standImage),h(3),m("ngIf",r.nameElement),h(),m("ngIf",r.conditionTypeElement),h(),m("ngIf",r.nameElement),h(2),m("ngIf",r.showNameElement),h(),m("ngIf",r.applyImageEffectElement),h(),m("ngIf",r.applyRollElement),h(),m("ngIf",r.applyDialogElement),h(),je("font-weight",r.isSpeakable?"bolder":"normal"),h(2),m("ngIf",r.positionElement),h(),m("ngIf",r.heightElement),h(),m("ngIf",r.postfixElement&&(r.conditionTypeElement.value==r.standConditionType.Postfix||r.conditionTypeElement.value==r.standConditionType.PostfixOrImage||r.conditionTypeElement.value==r.standConditionType.PostfixAndImage)),h(),m("ngIf",r.conditionTypeElement.value==r.standConditionType.Image||r.conditionTypeElement.value==r.standConditionType.PostfixOrImage||r.conditionTypeElement.value==r.standConditionType.PostfixAndImage))},dependencies:[Ni,nr,ri,Lo,na,ia,kr,yl,Cl,Ea,Ia,Or,ku,Du,Cr,cr],styles:[".stand-container[_ngcontent-%COMP%]{display:flex;flex-direction:row}.stand-image-container[_ngcontent-%COMP%]{width:150px;height:150px}.stand-image[_ngcontent-%COMP%]{width:150px;height:150px;object-fit:contain;transform-origin:bottom;z-index:5}.stand-image-button[_ngcontent-%COMP%]{display:block;margin-top:-154px;margin-left:-4px;position:relative;z-index:10}.postfix-text[_ngcontent-%COMP%]{width:8em}.position-indicate[_ngcontent-%COMP%]{display:inline-block;font-size:smaller;width:3em}.remove-button[_ngcontent-%COMP%]{font-weight:bolder;color:red;background-color:transparent}.remove-button[_ngcontent-%COMP%]:hover{background-color:#eee}.icon-image-box[_ngcontent-%COMP%]{position:relative;width:50px;height:50px;max-width:50px;max-height:50px;border-radius:.5rem;color:#000;z-index:100;margin-top:1px;margin-bottom:1px;margin-left:2px}.icon-image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%;border-radius:.5rem;border:2px solid transparent}.icon-image-box[_ngcontent-%COMP%]:hover{z-index:600}.icon-image-box[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{border:2px dotted rgba(255,0,0,40)}.icon-image-box.current-icon[_ngcontent-%COMP%]{z-index:500}.icon-image-box.current-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid red}.icon-image-box[_ngcontent-%COMP%]:not(.current-icon){z-index:400}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #fff)}.disabled-text[_ngcontent-%COMP%]{color:gray}.self-only[_ngcontent-%COMP%]{color:red}"]})}return t})();function WQ(t,n){if(1&t){const e=Le();p(0,"div",18)(1,"div",19)(2,"div",20)(3,"input",21),he("click",function(){const r=V(e).index;return H(v().overviewIndex=r)}),g()(),p(4,"div",22),Ge(5,"stand-element",23,0),g(),p(7,"div",24)(8,"button",25),he("click",function(){const r=V(e),o=r.$implicit,s=r.index;return H(v().delele(o,s))}),y(9,"\xd7"),g(),p(10,"button",26),he("click",function(){const r=V(e).$implicit;return H(v().upStandIndex(r))}),y(11,"\u2191"),g(),p(12,"button",27),he("click",function(){const r=V(e).$implicit;return H(v().downStandIndex(r))}),y(13,"\u2193"),g()()(),Ge(14,"hr"),g()}if(2&t){const e=n.$implicit,i=n.index,r=v();h(),je("border-color",r.overviewIndex==i?"red":"transparent"),h(2),go("name","",r.panelId,"_overviewIndex"),Et("value",i),m("checked",r.overviewIndex==i),h(2),m("standElement",e)("imageList",r.imageList)("gameCharacter",r.character)}}function $Q(t,n){if(1&t){const e=Le();p(0,"button",16),he("click",function(){return V(e),H(v().restore())}),y(1,"\u76f4\u524d\u306b\u524a\u9664\u3057\u305f\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u3092\u623b\u3059"),g()}}let pb=(()=>{class t{constructor(e,i,r){this.panelService=e,this.pointerDeviceService=i,this.modalService=r,this.character=null,this.standSettingXML="",this.isSpeaking=!1}get standElements(){return this.character.standList.standElements}get imageList(){if(!this.character)return[];let e=[],i={};const o=this.character.imageDataElement.getElementsByName("imageIdentifier").concat(this.character.imageDataElement.getElementsByName("faceIcon"));for(let s of o){if(i[s.value])continue;let a=this.imageElementToFile(s);a&&(i[s.value]=!0,e.push(a))}return e}get position(){return this.character&&this.character.standList?this.character.standList.position:0}set position(e){!this.character||!this.character.standList||(this.character.standList.position=e)}get height(){return this.character&&this.character.standList?this.character.standList.height:0}set height(e){!this.character||!this.character.standList||(this.character.standList.height=e)}get overviewIndex(){return this.character&&this.character.standList?this.character.standList.overviewIndex:-1}set overviewIndex(e){!this.character||!this.character.standList||(this.character.standList.overviewIndex=e)}set isSortNameList(e){!this.character||!this.character.standList||(this.character.standList.isSortNameList=e)}get isSortNameList(){return!this.character||!this.character.standList||this.character.standList.isSortNameList}ngOnInit(){Promise.resolve().then(()=>this.updatePanelTitle()),ne.register(this).on("DELETE_GAME_OBJECT",-1e3,e=>{this.character&&this.character.identifier===e.data.identifier&&this.panelService.close()}),this.panelId=oa.generateUuid()}ngAfterViewInit(){this._intervalId=setInterval(()=>{this.isSpeaking=!this.isSpeaking,this.standElementComponents.forEach(e=>{e.isSpeaking=this.isSpeaking})},3600)}ngOnDestroy(){clearInterval(this._intervalId),ne.unregister(this)}updatePanelTitle(){this.panelService.title=this.character.name+" \u306e\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a"}add(){this.character.standList.add(this.character.imageFile.identifier),this.standSettingXML=""}delele(e,i){ne.call("DELETE_STAND_IMAGE",{characterIdentifier:this.character.identifier,identifier:e.identifier}),this.character&&this.character.standList&&this.modalService.open(Fr,{title:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u306e\u524a\u9664",text:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u3092\u524a\u9664\u3057\u307e\u3059\u304b\uff1f",type:ur.OK_CANCEL,materialIcon:"person_off",action:()=>{this.standSettingXML=e.toXml(),this.character.standList.removeChild(e)&&(this.character.standList.overviewIndex==i?this.character.standList.overviewIndex=-1:this.character.standList.overviewIndex>i&&(this.character.standList.overviewIndex-=1))}})}restore(){if(!this.standSettingXML)return;let e=ar.instance.parseXml(this.standSettingXML);this.character.standList.appendChild(e),this.standSettingXML=""}upStandIndex(e){this.standSettingXML="";let i=this.character.standList,r=i.children.indexOf(e);0<r&&(i.insertBefore(e,i.children[r-1]),this.character.standList.overviewIndex==r?this.character.standList.overviewIndex-=1:this.character.standList.overviewIndex==r-1&&(this.character.standList.overviewIndex+=1))}downStandIndex(e){this.standSettingXML="";let i=this.character.standList,r=i.children.indexOf(e);r<i.children.length-1&&(i.insertBefore(i.children[r+1],e),this.character.standList.overviewIndex==r?this.character.standList.overviewIndex+=1:this.character.standList.overviewIndex==r+1&&(this.character.standList.overviewIndex-=1))}helpStandSeteing(){let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(kf,{left:e.x,top:e.y,width:600,height:620});r.title="\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u30d8\u30eb\u30d7",r.text='\u3000\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306e\u30b9\u30bf\u30f3\u30c9\u306e\u540d\u524d\u3001\u4f4d\u7f6e\u3068\u753b\u50cf\u306e\u9ad8\u3055\uff08\u305d\u308c\u305e\u308c\u753b\u9762\u30b5\u30a4\u30ba\u306b\u5bfe\u3059\u308b\u76f8\u5bfe\u6307\u5b9a\uff09\u3001\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u306b\u30b9\u30bf\u30f3\u30c9\u304c\u8868\u793a\u3055\u308c\u308b\u6761\u4ef6\u3092\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\n\n\u3000\u30b9\u30bf\u30f3\u30c9\u306b\u540d\u524d\u3092\u8a2d\u5b9a\u3057\u305f\u5834\u5408\u3001\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3001\u30c1\u30e3\u30c3\u30c8\u30d1\u30cd\u30eb\u306e\u30ea\u30b9\u30c8\u306b\u8868\u793a\u3055\u308c\u3001\u9078\u629e\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\u307e\u305f\u3001\u30bf\u30b0\u3092\u8a2d\u5b9a\u3057\u305f\u5834\u5408\u3001\u7570\u306a\u308b\u30bf\u30b0\u3067\u306f\u540c\u3058\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3067\u3042\u3063\u3066\u3082\u767b\u5834\u3001\u9000\u53bb\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u304c\u884c\u308f\u308c\u307e\u3059\u3002\n\n\u3000\u753b\u50cf\u306e\u4f4d\u7f6e\u3068\u9ad8\u3055\u306f\u500b\u5225\u6307\u5b9a\u3082\u53ef\u80fd\u3067\u3059\u3001\u4f4d\u7f6e\u306e\u500b\u5225\u6307\u5b9a\u306f\u30c1\u30a7\u30c3\u30af\u306a\u3057\u3001\u9ad8\u3055\u306f0\u3068\u3057\u305f\u5834\u5408\u306b\u5168\u4f53\u306e\u8a2d\u5b9a\u304c\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002\u7e26\u4f4d\u7f6e\u8abf\u6574(AdjY)\u306f\u3001\u30b9\u30bf\u30f3\u30c9\u753b\u50cf\u306e\u9ad8\u3055\u306b\u5bfe\u3059\u308b\u76f8\u5bfe\u6307\u5b9a\u3068\u306a\u308a\u307e\u3059\uff08\u4f8b\u3048\u3070\u3001-50%\u3068\u3059\u308b\u3068\u753b\u50cf\u306e\u4e0b\u534a\u5206\u304c\u753b\u9762\u7aef\u3088\u308a\u4e0b\u306b\u96a0\u308c\u307e\u3059\uff09\u3002\n\n\u3000\u6761\u4ef6\u306e\u300c\u6307\u5b9a\u753b\u50cf\u300d\u306f\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u753b\u50cf\u3042\u308b\u3044\u306f\u9854IC\u3067\u3059\u3002\u307e\u305f\u3001\u7279\u5225\u306a\u6761\u4ef6\u3068\u3057\u3066\u5e38\u306b\u3001\u30c1\u30e3\u30c3\u30c8\u30c6\u30ad\u30b9\u30c8\u306e\u672b\u5c3e\u304c"@\u9000\u53bb"\u307e\u305f\u306f"@farewell"\u306e\u5834\u5408\u306f\u3001\u305d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306e\u30b9\u30bf\u30f3\u30c9\u3092\u9000\u53bb\u3055\u305b\u307e\u3059\u3002\n\n\u3000\u512a\u5148\u9806\u4f4d\u306f\u9ad8\u3044\u3082\u306e\u304b\u3089\n\n\u3000\u3000\uff11. "@\u9000\u53bb"\u3001"@farewell"\u306b\u3088\u308b\u9000\u53bb\n\u3000\u3000\uff12. \u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3001\u30c1\u30e3\u30c3\u30c8\u30d1\u30cd\u30eb\u306e\u30ea\u30b9\u30c8\u3067\u9078\u629e\u3057\u305f\u540d\u524d\n\u3000\u3000\uff13. \u300c\u6307\u5b9a\u753b\u50cf \u304b\u3064 \u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u300d\n\u3000\u3000\uff14. \u300c\u6307\u5b9a\u753b\u50cf \u307e\u305f\u306f \u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u300d\n\u3000\u3000\uff15. \u300c\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u300d\n\u3000\u3000\uff16. \u300c\u6307\u5b9a\u753b\u50cf\u300d\n\n\u3000\u3069\u306e\u6761\u4ef6\u3082\u6e80\u305f\u3055\u306a\u3044\u5834\u5408\u300c\u30c7\u30d5\u30a9\u30eb\u30c8\u300d\u306e\u3082\u306e\u304c\u4f7f\u7528\u3055\u308c\u3001\u540c\u3058\u512a\u5148\u9806\u4f4d\u306e\u6761\u4ef6\u304c\u8907\u6570\u3042\u308b\u5834\u5408\u306f\u30e9\u30f3\u30c0\u30e0\u30671\u3064\u304c\u9078\u629e\u3055\u308c\u307e\u3059\u3002\n\n\u3000\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u4e00\u81f4\u3092\u5224\u5b9a\u3059\u308b\u969b\u3001\u5168\u89d2\u534a\u89d2\u3001\u30a2\u30eb\u30d5\u30a1\u3079\u30c3\u30c8\u306e\u5927\u6587\u5b57\u5c0f\u6587\u5b57\u306f\u533a\u5225\u3055\u308c\u307e\u305b\u3093\u3002\u307e\u305f\u3001\u4ed6\u306eBCDice\u3092\u5229\u7528\u3059\u308b\u30aa\u30f3\u30e9\u30a4\u30f3\u30bb\u30c3\u30b7\u30e7\u30f3\u30c4\u30fc\u30eb\u3068\u306e\u4e92\u63db\u6027\u306e\u305f\u3081\u3001\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u4e00\u81f4\u3092\u5224\u5b9a\u3059\u308b\u969b\u3001\u4e21\u5074\u306b\u30b9\u30da\u30fc\u30b9\u304c\u5165\u3063\u305f \u201c \uff1e \u201d \u3068 \u201c \u2192 \u201d \u3092\u540c\u5024\u3068\u307f\u306a\u3057\u307e\u3059\u3002\n\u3000\u307e\u305f\u3001"@\u9000\u53bb"\u3001"@farewell"\u306b\u3088\u308b\u9000\u53bb\u6642\u3001\u3042\u308b\u3044\u306f"@\u7b11\u3044"\u306e\u3088\u3046\u306b\u5148\u982d\u304c"@"\u3067\u59cb\u307e\u308b\u6761\u4ef6\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u5834\u5408\u3001\uff08\u30b9\u30bf\u30f3\u30c9\u306e\u6709\u52b9\u7121\u52b9\u3001\u6761\u4ef6\u3092\u6e80\u305f\u3059\u304b\u306b\u95a2\u308f\u3089\u305a\uff09\u305d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3067\u306e\u9001\u4fe1\u6642\u306b\u3001\u6761\u4ef6\u306b\u4e00\u81f4\u3059\u308b\u30c1\u30e3\u30c3\u30c8\u30c6\u30ad\u30b9\u30c8\u672b\u5c3e\u306e@\u4ee5\u4e0b\u306f\u5207\u308a\u843d\u3068\u3055\u308c\u307e\u3059\u3002'}imageElementToFile(e){return e?on.instance.get(e.value):null}static#e=this.\u0275fac=function(i){return new(i||t)(Y(yi),Y(lr),Y(Ei))};static#t=this.\u0275cmp=In({type:t,selectors:[["app-stand-setting"]],viewQuery:function(i,r){if(1&i&&Ln(f4,5),2&i){let o;Bn(o=Un())&&(r.standElementComponents=o)}},inputs:{character:"character"},decls:31,vars:15,consts:[["standElementComponent",""],[2,"margin-bottom","4px"],[2,"float","right","cursor","help",3,"click"],[1,"position-indicate"],["type","range","min","0","max","100",2,"width","350px",3,"ngModelChange","title","ngModel"],["type","number","min","0","max","100",2,"width","3em","text-align","right","margin-right","3px",3,"ngModelChange","ngModel"],["sytle","margin-left: 3px; margin-right: 1em "],[2,"margin-left","1em","white-space","nowrap"],["type","checkbox",3,"ngModelChange","change","ngModel","checked"],[2,"font-size","smaller"],["type","number","min","0","max","200",2,"width","3em","text-align","right","margin-right","3px",3,"ngModelChange","ngModel"],[1,"overview-selecter",2,"padding","0px","width","695px"],[2,"font-size","smaller","font-weight","bolder"],["type","radio","value","-1",2,"cursor","pointer",3,"click","name","checked"],[2,"display","flex","flex-direction","row","flex-wrap","wrap"],["style","width: 700px",4,"ngFor","ngForOf"],[3,"click"],[3,"click",4,"ngIf"],[2,"width","700px"],[1,"overview-selecter",2,"display","flex","flex-direction","row","justify-content","space-between"],[2,"display","flex","align-items","center","justify-content","center"],["type","radio",2,"cursor","pointer",3,"click","name","value","checked"],[2,"margin-left","-1em","margin-right","-1em"],[3,"standElement","imageList","gameCharacter"],[2,"text-align","right","width","3em"],[1,"remove-button","danger",3,"click"],[1,"remove-button",2,"margin-top","5px",3,"click"],[1,"remove-button",2,"margin-top","2px",3,"click"]],template:function(i,r){1&i&&(p(0,"div",1)(1,"button",2),he("click",function(){return r.helpStandSeteing()}),y(2,"?"),g(),p(3,"div",3)(4,"b"),y(5,"Pos: "),g(),p(6,"input",4),at("ngModelChange",function(s){return it(r.position,s)||(r.position=s),s}),g(),p(7,"input",5),at("ngModelChange",function(s){return it(r.position,s)||(r.position=s),s}),g(),p(8,"b",6),y(9,"\uff05\u3000"),g(),p(10,"label",7)(11,"input",8),at("ngModelChange",function(s){return it(r.isSortNameList,s)||(r.isSortNameList=s),s}),he("change",function(){return r.isSortNameList=!!r.isSortNameList}),g(),p(12,"b",9),y(13,"\u30c1\u30e3\u30c3\u30c8\u5165\u529b\u3067\u540d\u524d\u3092\u30bd\u30fc\u30c8"),g()()(),p(14,"div",3)(15,"b"),y(16,"Height (0=\u5143\u753b\u50cf\u306e\u307e\u307e): "),g(),p(17,"input",4),at("ngModelChange",function(s){return it(r.height,s)||(r.height=s),s}),g(),p(18,"input",10),at("ngModelChange",function(s){return it(r.height,s)||(r.height=s),s}),g(),p(19,"b",6),y(20,"\uff05"),g()()(),p(21,"div",11)(22,"label",12)(23,"input",13),he("click",function(){return r.overviewIndex=-1}),g(),y(24," \u30b9\u30bf\u30f3\u30c9\u753b\u50cf\u3092\u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u4f7f\u7528\u3057\u306a\u3044"),g()(),Ge(25,"hr"),p(26,"div",14),q(27,WQ,15,9,"div",15),g(),p(28,"button",16),he("click",function(){return r.add()}),y(29,"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u306e\u8ffd\u52a0"),g(),q(30,$Q,2,0,"button",17)),2&i&&(h(6),m("title",r.position+"%"),st("ngModel",r.position),h(),st("ngModel",r.position),h(4),Et("checked",r.isSortNameList?"checked":""),st("ngModel",r.isSortNameList),h(6),m("title",r.height?r.height+"%":"\u5143\u753b\u50cf\u306e\u307e\u307e"),st("ngModel",r.height),h(),st("ngModel",r.height),h(3),je("border-color",-1==r.overviewIndex?"red":"transparent"),h(2),go("name","",r.panelId,"_overviewIndex"),m("checked",-1==r.overviewIndex),h(4),m("ngForOf",r.standElements),h(3),m("ngIf",r.standSettingXML))},styles:[".position-indicate[_ngcontent-%COMP%]{display:inline-block;font-size:smaller}.description[_ngcontent-%COMP%]{font-size:smaller}.remove-button[_ngcontent-%COMP%]{display:inline-block;font-weight:bolder;font-size:smaller;margin-top:-4px;margin-right:-1px}.overview-selecter[_ngcontent-%COMP%]{border:2px solid red;border-radius:8px;padding-top:1px;padding-bottom:4px}input[type=radio][_ngcontent-%COMP%]{width:1.5em;height:1.5em}"]})}return t})(),kC=(()=>{class t{constructor(e){this.ngZone=e,this.batchTask=new Map,this.batchTaskTimer=null,this.needsChangeDetection=!1}add(e,i={}){this.batchTask.set(i,e),this.startTimer()}remove(e={}){this.batchTask.delete(e)}requireChangeDetection(){this.needsChangeDetection=!0,this.startTimer()}startTimer(){null==this.batchTaskTimer&&this.ngZone.runOutsideAngular(()=>{Ns(()=>this.execBatch()),this.batchTaskTimer=setInterval(()=>{0<this.batchTask.size?this.execBatch():(clearInterval(this.batchTaskTimer),this.batchTaskTimer=null)},66)})}execBatch(){this.batchTask.forEach(e=>e()),this.batchTask.clear(),this.needsChangeDetection&&(this.needsChangeDetection=!1,this.ngZone.run(()=>{}))}static#e=this.\u0275fac=function(i){return new(i||t)(Nn(Pn))};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class ns{constructor(){this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1}static create(n,e=null,i=new ns){return n&&n.ownerDocument?i.setCSS((e||window.getComputedStyle(n)).transform):i.identity()}setData(n){if(null==n)return;let e=n.length;return 16==e?(this.m11=n[0],this.m12=n[1],this.m13=n[2],this.m14=n[3],this.m21=n[4],this.m22=n[5],this.m23=n[6],this.m24=n[7],this.m31=n[8],this.m32=n[9],this.m33=n[10],this.m34=n[11],this.m41=n[12],this.m42=n[13],this.m43=n[14],this.m44=n[15]):6==e?(this.m11=n[0],this.m12=n[1],this.m13=0,this.m14=0,this.m21=n[2],this.m22=n[3],this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=n[4],this.m42=n[5],this.m43=0,this.m44=1):9==e&&(this.m11=n[0],this.m12=n[1],this.m13=0,this.m14=n[2],this.m21=n[3],this.m22=n[4],this.m23=0,this.m24=n[5],this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=n[6],this.m42=n[7],this.m43=0,this.m44=n[8]),this}identity(){return this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1,this}scalar(n){return this.m11*=n,this.m12*=n,this.m13*=n,this.m14*=n,this.m21*=n,this.m22*=n,this.m23*=n,this.m24*=n,this.m31*=n,this.m32*=n,this.m33*=n,this.m34*=n,this.m41*=n,this.m42*=n,this.m43*=n,this.m44*=n,this}unproject(n,e={x:0,y:0,z:0,w:1}){let i=n.x*this.m11+n.y*this.m21+this.m41,r=n.x*this.m12+n.y*this.m22+this.m42,o=n.x*this.m13+n.y*this.m23+this.m43,s=n.x*this.m14+n.y*this.m24+this.m44,a=i+this.m31,c=r+this.m32,u=o+this.m33,f=s+this.m34;0==s&&(s=1e-4),i/=s,r/=s,o/=s,0==f&&(f=1e-4),a/=f,c/=f,u/=f;let b=u-o;if(0==b)return e.x=i,e.y=r,e.z=o,e.w=o,e;let C=-o/b;return i+=C*(a-i),r+=C*(c-r),e.x=i,e.y=r,e.z=o,e.w=o,e}project(n,e={x:0,y:0,z:0,w:1}){let i=n.z,r=n.x*this.m14+n.y*this.m24+i*this.m34+this.m44,o=n.x*this.m11+n.y*this.m21+i*this.m31+this.m41,s=n.x*this.m12+n.y*this.m22+i*this.m32+this.m42;return 0==r&&(r=1e-4),o/=r,s/=r,r<0&&(o-=this.m41,s-=this.m42,o*=1/r,s*=1/r,o+=this.m41,s+=this.m42),e.x=o,e.y=s,e.z=i,e.w=i,e}append(n){return ns.multiply(this,n,this)}setPosition(n){return this.m41=n.x,this.m42=n.y,this.m43=n.z,this}getPosition(n={x:0,y:0,z:0,w:1}){return n.x=this.m41,n.y=this.m42,n.z=this.m43,n}static makePosition(n,e=new ns){return e.identity(),e.setPosition(n),e}appendPosition(...n){let e;return e=1===n.length?n[0]:{x:n[0],y:n[1],z:n[2],w:1},this.append(ns.makePosition(e,ns.MATRIX3D))}static makePerspective(n,e=new ns){return e.identity(),e.m34=n?-1/n:0,e}appendPerspective(n){return n?this.append(ns.makePerspective(n,ns.MATRIX3D)):this}invert(n){n=n||this;let e=[],i=this.m11,r=this.m12,o=this.m13,s=this.m14,a=this.m21,c=this.m22,u=this.m23,f=this.m24,b=this.m31,C=this.m32,x=this.m33,M=this.m34,U=this.m41,W=this.m42,K=this.m43,$=this.m44;e[0]=u*M*W-f*x*W+f*C*K-c*M*K-u*C*$+c*x*$,e[1]=s*x*W-o*M*W-s*C*K+r*M*K+o*C*$-r*x*$,e[2]=o*f*W-s*u*W+s*c*K-r*f*K-o*c*$+r*u*$,e[3]=s*u*C-o*f*C-s*c*x+r*f*x+o*c*M-r*u*M;let ge=i*e[0]+a*e[1]+b*e[2]+U*e[3];return 0==ge?(console.warn("Can not invert matrix, determinant is 0"),this):(e[4]=f*x*U-u*M*U-f*b*K+a*M*K+u*b*$-a*x*$,e[5]=o*M*U-s*x*U+s*b*K-i*M*K-o*b*$+i*x*$,e[6]=s*u*U-o*f*U-s*a*K+i*f*K+o*a*$-i*u*$,e[7]=o*f*b-s*u*b+s*a*x-i*f*x-o*a*M+i*u*M,e[8]=c*M*U-f*C*U+f*b*W-a*M*W-c*b*$+a*C*$,e[9]=s*C*U-r*M*U-s*b*W+i*M*W+r*b*$-i*C*$,e[10]=r*f*U-s*c*U+s*a*W-i*f*W-r*a*$+i*c*$,e[11]=s*c*b-r*f*b-s*a*C+i*f*C+r*a*M-i*c*M,e[12]=u*C*U-c*x*U-u*b*W+a*x*W+c*b*K-a*C*K,e[13]=r*x*U-o*C*U+o*b*W-i*x*W-r*b*K+i*C*K,e[14]=o*c*U-r*u*U-o*a*W+i*u*W+r*a*K-i*c*K,e[15]=r*u*b-o*c*b+o*a*C-i*u*C-r*a*x+i*c*x,n.setData(e),n.scalar(1/ge),n)}setCSS(n){if(!n||"none"==n)return this.identity();let e=n.replace("matrix3d(","").replace("matrix(","").replace(")","").split(","),i=e.length;for(let r=0;r<i;++r)e[r]=_o.parse(e[r]);return this.setData(e)}appendCSS(n,e=!1){return n&&"none"!=n?e&&n.indexOf("matrix3d")>=0?this.append(ns.MATRIX3D.setCSS(n).flatten()):this.append(ns.MATRIX3D.setCSS(n)):this}flatten(){return this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m44=1,this.m14=0,this.m24=0,this.m43=0,this}static multiply(n,e,i=new ns){let o=n.m11*e.m12+n.m12*e.m22+n.m13*e.m32+n.m14*e.m42,s=n.m11*e.m13+n.m12*e.m23+n.m13*e.m33+n.m14*e.m43,a=n.m11*e.m14+n.m12*e.m24+n.m13*e.m34+n.m14*e.m44,c=n.m21*e.m11+n.m22*e.m21+n.m23*e.m31+n.m24*e.m41,u=n.m21*e.m12+n.m22*e.m22+n.m23*e.m32+n.m24*e.m42,f=n.m21*e.m13+n.m22*e.m23+n.m23*e.m33+n.m24*e.m43,b=n.m21*e.m14+n.m22*e.m24+n.m23*e.m34+n.m24*e.m44,C=n.m31*e.m11+n.m32*e.m21+n.m33*e.m31+n.m34*e.m41,x=n.m31*e.m12+n.m32*e.m22+n.m33*e.m32+n.m34*e.m42,M=n.m31*e.m13+n.m32*e.m23+n.m33*e.m33+n.m34*e.m43,U=n.m31*e.m14+n.m32*e.m24+n.m33*e.m34+n.m34*e.m44,W=n.m41*e.m11+n.m42*e.m21+n.m43*e.m31+n.m44*e.m41,K=n.m41*e.m12+n.m42*e.m22+n.m43*e.m32+n.m44*e.m42,$=n.m41*e.m13+n.m42*e.m23+n.m43*e.m33+n.m44*e.m43,ge=n.m41*e.m14+n.m42*e.m24+n.m43*e.m34+n.m44*e.m44;return i.m11=n.m11*e.m11+n.m12*e.m21+n.m13*e.m31+n.m14*e.m41,i.m12=o,i.m13=s,i.m14=a,i.m21=c,i.m22=u,i.m23=f,i.m24=b,i.m31=C,i.m32=x,i.m33=M,i.m34=U,i.m41=W,i.m42=K,i.m43=$,i.m44=ge,i}toString(n=3){return"m11="+this.m11.toFixed(n)+"\tm21="+this.m21.toFixed(n)+"\tm31="+this.m31.toFixed(n)+"\tm41="+this.m41.toFixed(n)+"\nm12="+this.m12.toFixed(n)+"\tm22="+this.m22.toFixed(n)+"\tm32="+this.m32.toFixed(n)+"\tm42="+this.m42.toFixed(n)+"\nm13="+this.m13.toFixed(n)+"\tm23="+this.m23.toFixed(n)+"\tm33="+this.m33.toFixed(n)+"\tm43="+this.m43.toFixed(n)+"\nm14="+this.m14.toFixed(n)+"\tm24="+this.m24.toFixed(n)+"\tm34="+this.m34.toFixed(n)+"\tm44="+this.m44.toFixed(n)}static#e=this.MATRIX3D=new ns}class gb{constructor(n){this.matrix=new ns,this.sceneTransform=new ns,this.inverseSceneTransform=new ns,this.initialize(n)}clear(){return this.element=null,this.matrix.identity(),this}initialize(n){if(!n)return;this.element=n;let e=window.getComputedStyle(n),i=0,r=0;return this.element.parentElement?(i=this.element.parentElement.clientWidth,r=this.element.parentElement.clientHeight):(i=window.innerWidth,r=window.innerHeight),this.paddingLeft=_o.relation(e.paddingTop,i),this.paddingTop=_o.relation(e.paddingTop,r),this.marginLeft=_o.relation(e.marginLeft,i),this.marginTop=_o.relation(e.marginTop,r),this.borderLeft=_o.relation(e.borderLeft,i),this.borderTop=_o.relation(e.borderTop,r),this.matrix.setCSS(e.transform),this.sceneTransform.identity(),this.extract(this,this.sceneTransform),this.sceneTransform.invert(this.inverseSceneTransform),this}globalToLocal(n,e,i=0){let r={x:n,y:e,z:i,w:1};return this.inverseSceneTransform.unproject(r,r),this.fromBorderBox(r),r}localToGlobal(n,e,i=0){let r={x:n,y:e,z:i,w:1};return this.sceneTransform.project(r,r),this.fromBorderBox(r),r}localToLocal(n,e,i,r){let o_x=n,o_y=e,o_z=i,s=new gb(r),a=ns.multiply(this.sceneTransform,s.inverseSceneTransform),c={x:0,y:0,z:0,w:1};return c.x=o_x*a.m11+o_y*a.m21+o_z*a.m31+1*a.m41,c.y=o_x*a.m12+o_y*a.m22+o_z*a.m32+1*a.m42,c.z=o_x*a.m13+o_y*a.m23+o_z*a.m33+1*a.m43,c.w=o_x*a.m14+o_y*a.m24+o_z*a.m34+1*a.m44,s.clear(),this.toBorderBox(c),c}extract(n,e){let r=n.element;for(;r;)this.extractMatrix(r,e),r&&"fixed"===r.style.position&&(console.warn("fixed\u9818\u57df\u306f\u8a08\u7b97\u304c\u4e0d\u6b63\u78ba"),e.appendPosition(window.pageXOffset,window.pageYOffset,0)),r=r.parentElement}extractMatrix(n,e=null){if(e||(e=new ns),!n)return e;let i=n,r=window.getComputedStyle(n);if("none"!=r.transform){let a=r.transformOrigin?r.transformOrigin.split(" "):[],c=_o.relation(a[0],i.offsetWidth,.5*i.offsetWidth),u=_o.relation(a[1],i.offsetHeight,.5*i.offsetHeight),f=_o.relation(a[2],0,0);e.appendPosition(-c,-u,-f),e.appendCSS(r.transform),e.appendPosition(c,u,f)}let o=this.getPosition(n);e.appendPosition(o.x,o.y,0);let s=0;if(n.parentElement){let a=window.getComputedStyle(n.parentElement);s=_o.parse(a.perspective)}if(n.parentElement&&s){let c=window.getComputedStyle(n.parentElement).perspectiveOrigin.split(" "),u=_o.relation(c[0],i.parentElement.offsetWidth),f=_o.relation(c[1],i.parentElement.offsetHeight);e.appendPosition(-u,-f,0),e.appendPerspective(s),e.appendPosition(u,f,0)}return e}getPosition(n){let e={x:0,y:0};return e.x=n.offsetParent?n.parentElement===n.offsetParent?n.offsetLeft:n.parentElement.offsetParent===n.offsetParent?n.offsetLeft-n.parentElement.offsetLeft:0:n.offsetLeft,e.y=n.offsetParent?n.parentElement===n.offsetParent?n.offsetTop:n.parentElement.offsetParent===n.offsetParent?n.offsetTop-n.parentElement.offsetTop:0:n.offsetTop,e.x+=n.offsetParent?n.offsetParent.clientLeft:0,e.y+=n.offsetParent?n.offsetParent.clientTop:0,e}fromBorderBox(n){n.x+=this.paddingLeft,n.y+=this.paddingTop,n.x-=this.marginLeft,n.y-=this.marginTop,n.x-=this.borderLeft,n.y-=this.borderTop}toBorderBox(n){n.x-=this.paddingLeft,n.y-=this.paddingTop,n.x+=this.marginLeft,n.y+=this.marginTop,n.x+=this.borderLeft,n.y+=this.borderTop}}let rh=(()=>{class t{constructor(e){this.pointerDeviceService=e,this.tabletopOriginElement=document.body}convertToLocal(e,i=document.body){let r=new gb(i),o=r.globalToLocal(e.x,e.y,e.z?e.z:0);return r.clear(),{x:o.x,y:o.y,z:o.z}}convertToGlobal(e,i=document.body){let r=new gb(i),o=r.localToGlobal(e.x,e.y,e.z?e.z:0);return r.clear(),{x:o.x,y:o.y,z:o.z}}convertLocalToLocal(e,i,r){let o=new gb(i),s=o.globalToLocal(e.x,e.y,e.z?e.z:0),a=o.localToLocal(s.x,s.y,0,r);return o.clear(),{x:a.x,y:a.y,z:a.z}}calcTabletopLocalCoordinate(e={x:this.pointerDeviceService.pointers[0].x,y:this.pointerDeviceService.pointers[0].y,z:0},i=this.pointerDeviceService.targetElement){return i.contains(this.tabletopOriginElement)?(e=this.convertToLocal(e,this.tabletopOriginElement)).z=0:e=this.convertLocalToLocal(e,i,this.tabletopOriginElement),{x:e.x,y:e.y,z:0<e.z?e.z:0}}static#e=this.\u0275fac=function(i){return new(i||t)(Nn(lr))};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Jg=(()=>{class t{get tableSelecter(){return Ho.instance}get currentTable(){return this.tableSelecter.viewTable||this._emptyTable}get characters(){return this.characterCache.objects}get cards(){return this.cardCache.objects}get cardStacks(){return this.cardStackCache.objects}get tableMasks(){return this.tableMaskCache.objects}get ranges(){return this.rangeCache.objects}get terrains(){return this.terrainCache.objects}get textNotes(){return this.textNoteCache.objects}get diceSymbols(){return this.diceSymbolCache.objects}get peerCursors(){return bt.instance.getObjects(Fe)}constructor(e){this.coordinateService=e,this._emptyTable=new bo(""),this.locationMap=new Map,this.parentMap=new Map,this.indexMap=new Map,this.characterCache=new oh(()=>bt.instance.getObjects(gn).filter(i=>i.isVisibleOnTable)),this.cardCache=new oh(()=>bt.instance.getObjects(Ci).filter(i=>i.isVisibleOnTable)),this.cardStackCache=new oh(()=>bt.instance.getObjects(Vi).filter(i=>i.isVisibleOnTable)),this.tableMaskCache=new oh(()=>{let i=this.tableSelecter.viewTable;return i?i.masks:[]}),this.rangeCache=new oh(()=>bt.instance.getObjects(rr).filter(i=>i.isVisibleOnTable)),this.terrainCache=new oh(()=>{let i=this.tableSelecter.viewTable;return i?i.terrains:[]}),this.textNoteCache=new oh(()=>bt.instance.getObjects(vs)),this.diceSymbolCache=new oh(()=>bt.instance.getObjects(ts)),this.initialize()}initialize(){this.refreshCacheAll(),ne.register(this).on("UPDATE_GAME_OBJECT",e=>{if(e.data.identifier===this.currentTable.identifier||e.data.identifier===this.tableSelecter.identifier)return this.refreshCache(zo.aliasName),void this.refreshCache(es.aliasName);let i=bt.instance.get(e.data.identifier);i&&i instanceof wr?this.shouldRefreshCache(i)&&(this.refreshCache(e.data.aliasName),this.updateMap(i)):this.refreshCache(e.data.aliasName)}).on("DELETE_GAME_OBJECT",e=>{let i=e.data.aliasName;i?this.refreshCache(i):this.refreshCacheAll()}).on("XML_LOADED",e=>{let r=ar.instance.parseXml(e.data.xmlElement);if(r instanceof wr){let o=this.coordinateService.calcTabletopLocalCoordinate();r.location.x=o.x-25,r.location.y=o.y-25,r.posZ=o.z,this.placeToTabletop(r),tt.play(Te.piecePut)}else r instanceof ih?nc.instance.addChatTab(r):r instanceof Uu?Jl.instance.addDiceRollTable(r):r instanceof Pr&&tc.instance.addCutIn(r)})}findCache(e){switch(e){case gn.aliasName:return this.characterCache;case Ci.aliasName:return this.cardCache;case Vi.aliasName:return this.cardStackCache;case zo.aliasName:return this.tableMaskCache;case es.aliasName:return this.terrainCache;case vs.aliasName:return this.textNoteCache;case ts.aliasName:return this.diceSymbolCache;case rr.aliasName:return this.rangeCache;default:return null}}refreshCache(e){let i=this.findCache(e);i&&i.refresh()}refreshCacheAll(){this.characterCache.refresh(),this.cardCache.refresh(),this.cardStackCache.refresh(),this.tableMaskCache.refresh(),this.terrainCache.refresh(),this.textNoteCache.refresh(),this.diceSymbolCache.refresh(),this.rangeCache.refresh(),this.clearMap()}shouldRefreshCache(e){return this.locationMap.get(e.identifier)!==e.location.name||this.parentMap.get(e.identifier)!==e.parentId||e.isVisibleOnTable&&this.indexMap.get(e.identifier)!==e.index}updateMap(e){this.locationMap.set(e.identifier,e.location.name),this.parentMap.set(e.identifier,e.parentId),this.indexMap.set(e.identifier,e.index)}clearMap(){this.locationMap.clear(),this.parentMap.clear(),this.indexMap.clear()}placeToTabletop(e){switch(e.aliasName){case zo.aliasName:e instanceof zo&&(e.isLock=!1,e.isPreview=!1);case es.aliasName:if(e instanceof es&&(e.isLocked=!1),!this.tableSelecter||!this.tableSelecter.viewTable)return;this.tableSelecter.viewTable.appendChild(e);break;case Ci.aliasName:case Vi.aliasName:case rr.aliasName:case vs.aliasName:(e instanceof Ci||e instanceof Vi||e instanceof rr||e instanceof vs)&&(e.isLocked=!1),e instanceof rr&&(e.followingCharctorIdentifier=null);default:e.setLocation("table")}}static#e=this.\u0275fac=function(i){return new(i||t)(Nn(rh))};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac})}return t})();class oh{get objects(){return this.needsRefresh&&(this._objects=this.refreshCollector(),this._objects=this._objects?this._objects:[],this.needsRefresh=!1),this._objects}constructor(n){this.refreshCollector=n,this.needsRefresh=!0,this._objects=[]}refresh(){this.needsRefresh=!0}}class is{static#e=this.layerMap=new Map;get tabletopObject(){return this._tabletopObject}get layerName(){return this._layerName}get colideLayers(){return this._colideLayers}get transformCssOffset(){return this._transformCssOffset}set option(n){this.unregister(),this.synchronizer.unregister(),this._tabletopObject=n.tabletopObject??null,this._layerName=n.layerName??"",this._colideLayers=n.colideLayers??[],this._transformCssOffset=n.transformCssOffset??"",this._layerName.length<1&&this._tabletopObject&&(this._layerName=this._tabletopObject.aliasName),this.register(),this.synchronizer.register()}get nativeElement(){return this.elementRef.nativeElement}get posX(){return this._posX}set posX(n){this._posX=n,this.setUpdateBatching()}get posY(){return this._posY}set posY(n){this._posY=n,this.setUpdateBatching()}get posZ(){return this._posZ}set posZ(n){this._posZ=n,this.setUpdateBatching()}get magnitude(){return this.input.magnitude}get isPointerMoved(){return this.input.isPointerMoved}get state(){return this.selectionService.state(this.tabletopObject)}set state(n){this.selectionService.add(this.tabletopObject,n)}get isGridSnap(){return Ho.instance.gridSnap}constructor(n,e,i,r,o,s,a){this.ngZone=n,this.elementRef=e,this.batchService=i,this.pointerDeviceService=r,this.coordinateService=o,this.tabletopService=s,this.selectionService=a,this._layerName="",this._colideLayers=[],this._transformCssOffset="",this.isDisable=!1,this.isInteract=!0,this.onstart=new ei,this.ondragstart=new ei,this.ondrag=new ei,this.ondragend=new ei,this.onend=new ei,this._posX=0,this._posY=0,this._posZ=0,this.pointerOffset2d={x:0,y:0,z:0},this.pointerStart3d={x:0,y:0,z:0},this.height=-1,this.width=-1,this.ratio=1,this.isUpdateBatching=!1,this.collidableElements=[],this.input=new Bc(this.nativeElement,!1),this.synchronizer=new zu(this,this.selectionService,this.pointerDeviceService)}ngAfterViewInit(){this.batchService.add(()=>this.initialize(),this.onstart)}ngOnChanges(){this.dispose(),ne.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.tabletopObject?.identifier}`,n=>{n.isSendFromSelf&&(this.input.isGrabbing||this.state!==$n.NONE)||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.state=$n.NONE,this.stopTransition(),this.setPosition(this.tabletopObject)},this)}),this.isDisable&&this.state!==$n.NONE&&(this.state=$n.NONE),this.setPosition(this.tabletopObject)}ngOnDestroy(){this.unregister(),this.dispose(),this.synchronizer.destroy(),this.input.destroy(),this.batchService.remove(this.onstart)}initialize(){this.synchronizer.initialize(),this.input.initialize(),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),this.findCollidableElements()}cancel(){this.input.cancel(),this.setPointerEvents(!0),this.setAnimatedTransition(!0),this.setCollidableLayer(!1),this.tabletopService.tableSelecter.viewTable&&(this.tabletopService.tableSelecter.viewTable.gridHeight=0)}dispose(){ne.unregister(this),this.batchService.remove(this)}onInputStart(n){if(this.callSelectedEvent(),this.collidableElements.length<1&&this.findCollidableElements(),this.isDisable||n instanceof MouseEvent&&(0!==n.button||n.ctrlKey||n.shiftKey))return void this.cancel();this.onstart.emit(n),this.setPointerEvents(!1),this.setAnimatedTransition(!1),this.setCollidableLayer(this.isInteract),this.width=this.nativeElement.clientWidth,this.height=this.nativeElement.clientHeight;let e={x:this.posX+this.width/2,y:this.posY+this.height/2,z:this.posZ},i=this.coordinateService.convertToGlobal(e,this.coordinateService.tabletopOriginElement);this.setPointerEvents(!0),this.pointerOffset2d.x=i.x-this.input.pointer.x,this.pointerOffset2d.y=i.y-this.input.pointer.y,this.pointerOffset2d.z=i.z-this.input.pointer.z,this.pointerStart3d.x=e.x,this.pointerStart3d.y=e.y,this.pointerStart3d.z=e.z,this.targetStartRect=this.nativeElement.getBoundingClientRect(),this.ratio=1;const r=Ho.instance.viewTable;r.gridClipRect=null,r.gridHeight=this.posZ+.5,this.synchronizer.prepareMove()}onInputMove(n){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();n.cancelable&&n.preventDefault(),this.input.isDragging||this.setPointerEvents(!1);let e={x:this.input.pointer.x+this.pointerOffset2d.x*this.ratio,y:this.input.pointer.y+this.pointerOffset2d.y*this.ratio,z:0};e.x=Math.min(window.innerWidth-.1,Math.max(e.x,.1)),e.y=Math.min(window.innerHeight-.1,Math.max(e.y,.1));let i=document.elementFromPoint(e.x,e.y);if(null==i)return;let r=this.coordinateService.calcTabletopLocalCoordinate(e,i);if(r.x-=this.width/2,r.y-=this.height/2,this.posX===r.x&&this.posY===r.y&&this.posZ===r.z)return;this.input.isDragging||this.ondragstart.emit(n),this.ondrag.emit(n);let s=this.nativeElement.getBoundingClientRect().width/this.targetStartRect.width;s<this.ratio&&(this.ratio+=.1*(s-this.ratio));const a=Ho.instance.viewTable;a.gridClipRect=null,a.gridHeight=this.posZ+.5;let c={x:r.x-this.posX,y:r.y-this.posY,z:r.z-this.posZ};this.posX=r.x,this.posY=r.y,this.posZ=r.z,this.synchronizer.updateMove(c)}onInputEnd(n){if(this.isDisable)return this.cancel();this.input.isDragging&&this.ondragend.emit(n);let e_x=this.posX,e_y=this.posY,e_z=this.posZ;this.isGridSnap&&this.input.isDragging&&this.snapToGrid(),this.synchronizer.finishMove({x:this.posX-e_x,y:this.posY-e_y,z:this.posZ-e_z}),this.cancel(),this.onend.emit(n)}onContextMenu(n){if(this.isDisable)return this.cancel();n.cancelable&&n.preventDefault(),this.isGridSnap&&this.input.isDragging&&this.snapToGrid();let e=this.input.isGrabbing&&n.isTrusted;if(this.cancel(),e){n.stopPropagation();let i=new MouseEvent(n.type,n);this.ngZone.run(()=>this.nativeElement.dispatchEvent(i))}}callSelectedEvent(){this.tabletopObject&&ne.trigger("SELECT_TABLETOP_OBJECT",{identifier:this.tabletopObject.identifier,className:this.tabletopObject.aliasName})}snapToGrid(n=25){this.posX=this.calcSnapNum(this.posX,n),this.posY=this.calcSnapNum(this.posY,n)}calcSnapNum(n,e){return e<=0?n:(n=n<0?n-e/2:n+e/2)-n%e}setPosition(n){this._posX=n.location.x,this._posY=n.location.y,this._posZ=n.posZ,this.updateTransformCss()}setUpdateBatching(){!this.isUpdateBatching&&this.tabletopObject&&(this.isUpdateBatching=!0,this.batchService.add(()=>{this.tabletopObject.location.x=this.posX,this.tabletopObject.location.y=this.posY,this.tabletopObject.posZ=this.posZ,this.isUpdateBatching=!1})),this.updateTransformCss()}findCollidableElements(){this.collidableElements=[],"none"===getComputedStyle(this.nativeElement).pointerEvents?this.findNestedCollidableElements(this.nativeElement):this.collidableElements=[this.nativeElement]}findNestedCollidableElements(n){let e=n.children;for(let i=0;i<e.length;i++){let r=e[i];r instanceof HTMLElement&&"none"!==getComputedStyle(r).pointerEvents&&this.collidableElements.push(r)}if(this.collidableElements.length<1)for(let i=0;i<e.length;i++){let r=e[i];r instanceof HTMLElement&&this.findNestedCollidableElements(r)}}setPointerEvents(n){let e=n?"auto":"none";this.collidableElements.forEach(i=>i.style.pointerEvents=e)}setAnimatedTransition(n){this.nativeElement.style.transition=n?"transform 132ms linear":""}shouldTransition(n){return n.location.x!==this.posX||n.location.y!==this.posY||n.posZ!==this.posZ}stopTransition(){this.nativeElement.style.transform=window.getComputedStyle(this.nativeElement).transform}updateTransformCss(){let n=`${this.transformCssOffset} translate3d(${this.posX.toFixed(4)}px, ${this.posY.toFixed(4)}px, ${this.posZ.toFixed(4)}px)`;this.nativeElement.style.transform=n}setCollidableLayer(n){let e=n;for(let i of is.layerMap.keys())e=this.colideLayers.includes(i)?"character"==i?!this.input.isGrabbing||n&&!this.tabletopObject.isNotRide:!this.input.isGrabbing||n:!n,is.layerMap.get(i).forEach(r=>{r===this||r.input?.isGrabbing||r.setPointerEvents(e)})}register(){let n=is.layerMap.get(this.layerName)??new Set;n.add(this),is.layerMap.set(this.layerName,n)}unregister(){let n=is.layerMap.get(this.layerName);n&&(n.delete(this),n.size<1&&is.layerMap.delete(this.layerName))}static#t=this.\u0275fac=function(e){return new(e||is)(Y(Pn),Y(fr),Y(kC),Y(lr),Y(rh),Y(Jg),Y(Ml))};static#n=this.\u0275dir=Sn({type:is,selectors:[["","appMovable",""]],inputs:{option:[Ce.None,"movable.option","option"],isDisable:[Ce.None,"movable.disable","isDisable"],isInteract:[Ce.None,"movable.interact","isInteract"]},outputs:{onstart:"movable.onstart",ondragstart:"movable.ondragstart",ondrag:"movable.ondrag",ondragend:"movable.ondragend",onend:"movable.onend"},features:[hr]})}class zu{static#e=this.objectMap=new Map;get selectedMovables(){let n=new Set;for(let e of this.selection.objects)zu.objectMap.get(e)?.forEach(i=>n.add(i));return n}get isDestroyed(){return this._isDestroyed}constructor(n,e,i){this.movable=n,this.selection=e,this.pointerDevice=i,this.callbackOnPickStart=this.onPickStart.bind(this),this.callbackOnPickObject=this.onPickObject.bind(this),this.callbackOnPickRegion=this.onPickRegion.bind(this),this._isDestroyed=!1}initialize(){this.register(),this.addEventListeners()}destroy(){this.unregister(),this._isDestroyed=!0,this.removeEventListeners(),this.movable=null}onPickStart(n){null==this.movable.tabletopObject||this.movable.isDisable||(this.movable.state=n.detail.isMagnetic?$n.MAGNETIC:$n.SELECTED,this.prepareMove())}onPickObject(n){this.selection.excludeElement!==this.movable.nativeElement&&(this.pointerDevice.isDragging||this.movable.isDisable||(null==this.selection.excludeElement?(this.toggleState(),this.selection.excludeElement=this.movable.nativeElement):this.movable.state=$n.SELECTED))}onPickRegion(n){if(this.pointerDevice.isDragging||this.movable.isDisable)return;let e=n.detail.x,i=n.detail.y,r=n.detail.width,o=n.detail.height,s=this.movable.nativeElement.getBoundingClientRect();s.x<=e+r&&e<=s.x+s.width&&s.y<=i+o&&i<=s.y+s.height&&(this.movable.state=$n.SELECTED)}toggleState(){this.movable.state=this.movable.state===$n.SELECTED?$n.NONE:$n.SELECTED}prepareMove(){if(this.shouldSynchronize())for(let n of this.selectedMovables)n!==this.movable&&(n.isDisable?n.state=$n.NONE:(n.state=$n.SELECTED,n.setPointerEvents(!1),n.setAnimatedTransition(!1)))}updateMove(n){if(this.shouldSynchronize()){if(this.movable.state===$n.MAGNETIC){let e=is.layerMap.get(this.movable.layerName);if(e)for(let i of e)i!==this.movable&&!i.isDisable&&i.state===$n.NONE&&(i.width<0&&(i.width=i.nativeElement.clientWidth),i.height<0&&(i.height=i.nativeElement.clientHeight),this.isProximity(i)&&(i.state=$n.MAGNETIC,i.setPointerEvents(!1),i.setAnimatedTransition(!1)))}for(let e of this.selectedMovables)e!==this.movable&&(e.posX+=n.x,e.posY+=n.y,e.posZ+=n.z,e.state===$n.MAGNETIC&&(e.posX=.02*(this.movable.posX+(this.movable.width-e.width)/2)+.98*e.posX,e.posY=.02*(this.movable.posY+(this.movable.height-e.height)/2)+.98*e.posY,e.posZ=.02*this.movable.posZ+.98*e.posZ),e.posZ<0&&(e.posZ=0))}else this.movable.isPointerMoved&&this.selection.clear()}finishMove(n){if(!this.shouldSynchronize())return void this.selection.clear();for(let a of this.selectedMovables)a!==this.movable&&(a.posX+=n.x,a.posY+=n.y,a.posZ+=n.z);let e=Array.from(this.selectedMovables).sort((a,c)=>{let u=a.tabletopObject.zindex,f=c.tabletopObject.zindex;return null==u||null==f?0:u-f}).filter(a=>a.state===$n.MAGNETIC&&a!==this.movable),i=360/e.length,r=360*Math.random(),o=Math.min(Math.max((this.movable.width+this.movable.height)/2,50),75),s_x=this.movable.posX+this.movable.width/2,s_y=this.movable.posY+this.movable.height/2;for(let a of e){if(a===this.movable)continue;r+=i;let c=Hi.radians(r);a.posX=s_x+o*Math.sin(c)-a.width/2,a.posY=s_y+o*Math.cos(c)-a.height/2}this.movable.state===$n.MAGNETIC&&this.selection.size<=1?this.selection.clear():this.refreshState()}shouldSynchronize(){return this.movable.state!==$n.NONE}refreshState(){for(let n of this.selectedMovables)n.state=$n.SELECTED,n!==this.movable&&(n.setPointerEvents(!0),n.setAnimatedTransition(!0),n.width=n.height=-1)}isProximity(n,e=this.movable){let i=Math.max(.95*((n.width+e.width)/4+(n.height+e.height)/4),25)**2;return Hi.sqrMagnitude({x:n.posX+n.width/2,y:n.posY+n.height/2,z:n.posZ},{x:e.posX+e.width/2,y:e.posY+e.height/2,z:e.posZ})<i}addEventListeners(){this.movable.nativeElement.addEventListener("pickstart",this.callbackOnPickStart),this.movable.nativeElement.addEventListener("pickobject",this.callbackOnPickObject),this.movable.nativeElement.ownerDocument.addEventListener("pickregion",this.callbackOnPickRegion)}removeEventListeners(){this.movable.nativeElement.removeEventListener("pickstart",this.callbackOnPickStart),this.movable.nativeElement.removeEventListener("pickobject",this.callbackOnPickObject),this.movable.nativeElement.ownerDocument.removeEventListener("pickregion",this.callbackOnPickRegion)}register(){let n=zu.objectMap.get(this.movable.tabletopObject)??new Set;n.add(this.movable),zu.objectMap.set(this.movable.tabletopObject,n)}unregister(){let n=zu.objectMap.get(this.movable.tabletopObject);n&&(n.delete(this.movable),n.size<1&&zu.objectMap.delete(this.movable.tabletopObject))}static congregate(n,e){let i=e.sort((a,c)=>{let u=a.zindex,f=c.zindex;return null==u||null==f?0:u-f}),r=360/i.length,o=360*Math.random(),s=Math.min(Math.max(9*i.length,5),75);for(let a of i){let c=zu.objectMap.get(a);if(null!=c)for(let u of c){u.setAnimatedTransition(!0),u.stopTransition(),u.width<0&&(u.width=u.nativeElement.clientWidth),u.height<0&&(u.height=u.nativeElement.clientHeight),o+=r;let f=Hi.radians(o);u.posX=n.x+s*Math.sin(f)-u.width/2,u.posY=n.y+s*Math.cos(f)-u.height/2,u.posZ=n.z}}}}var $n=function(t){return t[t.NONE=0]="NONE",t[t.SELECTED=1]="SELECTED",t[t.MAGNETIC=2]="MAGNETIC",t}($n||{});let Ml=(()=>{class t{get size(){return this.selectionMap.size}get objects(){return Array.from(this.selectionMap.keys())}constructor(){this.selectionMap=new Map,this.previus=new Set,this.excludeElement=null,this.isUdpateCssBatching=!1}state(e){return this.selectionMap.get(e)??$n.NONE}add(e,i=$n.SELECTED){if(i===$n.NONE)return this.remove(e);let r=this.objects;this.selectionMap.set(e,i),this.updateHighlight(r)}remove(e){if(!this.selectionMap.has(e))return;let i=this.objects;this.selectionMap.delete(e),this.updateHighlight(i)}clear(){let e=this.objects;this.selectionMap.clear(),this.updateHighlight(e)}congregate(e){zu.congregate(e,this.objects)}updateHighlight(e=[]){e.forEach(i=>this.previus.add(i)),!this.isUdpateCssBatching&&(queueMicrotask(()=>{this.isUdpateCssBatching=!1,this.selectionMap.forEach((r,o)=>this.previus.add(o));let i=Array.from(this.previus);this.previus.clear(),0<i.length&&ne.trigger("UPDATE_SELECTION",{changed:i});for(let r of i)ne.trigger(`UPDATE_SELECTION/identifier/${r.identifier}`,{changed:i});ne.trigger("UPDATE_INVENTORY",null)}),this.isUdpateCssBatching=!0)}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),lS=(()=>{class t{get summarySetting(){return Vc.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(e){this.summarySetting.sortTag=e}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(e){this.summarySetting.sortOrder=e}get dataTag(){return this.summarySetting.dataTag}set dataTag(e){this.summarySetting.dataTag=e}get dataTags(){return this.summarySetting.dataTags}get sortStop(){return this._sortStop}set sortStop(e){const i=this._sortStop;this._sortStop=e,i&&!this._sortStop&&this.refresh()}constructor(){this.tableInventory=new OC(e=>"table"===e.location.name),this.commonInventory=new OC(e=>!this.isAnyLocation(e.location.name)),this.privateInventory=new OC(e=>e.location.name===jt.peerId),this.graveyardInventory=new OC(e=>"graveyard"===e.location.name),this.indicateAll=!1,this._sortStop=!1,this.locationMap=new Map,this.tagNameMap=new Map,this.newLineStrings="/\uff0f",this.newLineDataElement=wt.create(this.newLineStrings),this.initialize()}initialize(){ne.register(this).on("OPEN_NETWORK",e=>{this.refresh()}).on("CONNECT_PEER",e=>{this.refresh()}).on("DISCONNECT_PEER",e=>{this.refresh()}).on("UPDATE_GAME_OBJECT",e=>{let i=bt.instance.get(e.data.identifier);if(i)if(i instanceof gn){let r=this.locationMap.get(i.identifier);i.location.name!==r&&(this.locationMap.set(i.identifier,i.location.name),this.refresh())}else if(i instanceof wt){if(!this.containsInGameCharacter(i))return;let r=this.tagNameMap.get(i.identifier);(this.dataTags.includes(r)||this.dataTags.includes(i.name))&&i.name!==r&&(this.tagNameMap.set(i.identifier,i.name),this.refreshDataElements()),0<i.children.length&&this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate()}else i instanceof Vc&&(this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate())}).on("DELETE_GAME_OBJECT",e=>{this.locationMap.delete(e.data.identifier),this.tagNameMap.delete(e.data.identifier),this.refresh()}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.callInventoryUpdate()})}containsInGameCharacter(e){let i=e.parent,r=gn.aliasName;for(;i;){if(i.aliasName===r)return!0;i=i.parent}return!1}refresh(){this.refreshObjects(),this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate()}refreshObjects(){this.tableInventory.refreshObjects(),this.commonInventory.refreshObjects(),this.privateInventory.refreshObjects(),this.graveyardInventory.refreshObjects()}refreshDataElements(){this.tableInventory.refreshDataElements(),this.commonInventory.refreshDataElements(),this.privateInventory.refreshDataElements(),this.graveyardInventory.refreshDataElements()}refreshSort(){this.sortStop||(this.tableInventory.refreshSort(),this.commonInventory.refreshSort(),this.privateInventory.refreshSort(),this.graveyardInventory.refreshSort())}callInventoryUpdate(){ne.trigger("UPDATE_INVENTORY",null)}isAnyLocation(e){if("table"===e||e===jt.peerId||"graveyard"===e)return!0;for(let i of jt.peers)if(i.isOpen&&e===i.peerId)return!0;return!1}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class OC{get summarySetting(){return Vc.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(n){this.summarySetting.sortTag=n}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(n){this.summarySetting.sortOrder=n}get dataTag(){return this.summarySetting.dataTag}set dataTag(n){this.summarySetting.dataTag=n}get dataTags(){return this.summarySetting.dataTags}get tabletopObjects(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this.needsSort&&(this._tabletopObjects=this.sortTabletopObjects(this._tabletopObjects),this.needsSort=!1),this._tabletopObjects}get length(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this._tabletopObjects.length}get dataElementMap(){if(this.needsRefreshElements){this._dataElementMap.clear();let n=this.tabletopObjects;for(let e of n){if(!e.detailDataElement)continue;let i=this.dataTags.map(r=>this.newLineStrings.includes(r)?this.newLineDataElement:e.detailDataElement.getFirstElementByNameUnsensitive(r));this._dataElementMap.set(e.identifier,i)}this.needsRefreshElements=!1}return this._dataElementMap}constructor(n){this.classifier=n,this.newLineStrings="/\uff0f",this.newLineDataElement=wt.create(this.newLineStrings),this._tabletopObjects=[],this._dataElementMap=new Map,this.needsRefreshObjects=!0,this.needsRefreshElements=!0,this.needsSort=!0}refreshObjects(){this.needsRefreshObjects=!0}refreshDataElements(){this.needsRefreshElements=!0}refreshSort(){this.needsSort=!0}searchTabletopObjects(){let n=bt.instance.getObjects(gn),e=[];for(let i of n)this.classifier(i)&&e.push(i);return e}sortTabletopObjects(n){let e=this.sortTag.length?this.sortTag.trim():"",i="ASC"===this.sortOrder?-1:1;return e.length<1||n.sort((r,o)=>{let s=r.rootDataElement?.getFirstElementByNameUnsensitive(e),a=o.rootDataElement?.getFirstElementByNameUnsensitive(e);if(!s&&!a)return 0;if(!a)return-1;if(!s)return 1;let c=this.convertToSortableValue(s,r),u=this.convertToSortableValue(a,o);return c<u?i:c>u?-1*i:0}),n}convertToSortableValue(n,e=null){let i=this.evaluate(n,e),r=ke.toHalfWidth((i+"").replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).toLowerCase().trim(),o=+r;return Number.isNaN(o)?r:o}evaluate(n,e=null){let i;if(n.isCheckProperty){let r=n.currentValue.toString().split(/[|\uff5c]/,2);if(r.length<=1)return null==n.value||""==n.value?"":n.currentValue.toString();i=null==n.value||""==n.value?r[1]:r[0]}else i=n.isAbilityScore?n.calcAbilityScore:n.isNumberResource?n.currentValue:n.value;return null!=i&&e instanceof gn&&e.chatPalette&&(i=e.chatPalette.evaluate(i+"",e.rootDataElement)),i}}class Hu{static#e=this.LoggingValueMap=new Map;ngAfterViewInit(){let n=this.dataElement;for(;(n=n.parent)&&(n instanceof Ci&&(this.type="\u30ab\u30fc\u30c9"),n instanceof Vi&&(this.type="\u5c71\u672d"),n instanceof ts&&(this.type=n.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9"),n instanceof gn&&(this.type="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc"),n instanceof zo&&(this.type="\u30de\u30c3\u30d7\u30de\u30b9\u30af"),n instanceof es&&(this.type="\u5730\u5f62"),n instanceof vs&&(this.type="\u5171\u6709\u30e1\u30e2"),n instanceof rr&&(this.type="\u5c04\u7a0b\u30fb\u7bc4\u56f2"),n.parentIsAssigned&&!n.parentIsUnknown););const e=Hu.LoggingValueMap,i=this.dataElement.identifier,r=this.elementRef.nativeElement;e.set(i,{oldValue:this.dataElement.loggingValue}),r.addEventListener("input",()=>{e.get(i).timerId&&clearTimeout(e.get(i).timerId),e.get(i).timerId=setTimeout(()=>{this.doLogging()},this.timeout)}),this.dataElement.changeObserver=()=>{e.get(i).timerId&&clearTimeout(e.get(i).timerId),e.get(i).timerId=setTimeout(()=>{this.doLogging&&this.doLogging(!1)},0)}}ngOnDestroy(){const n=Hu.LoggingValueMap,e=this.dataElement.identifier;n.get(e)&&n.get(e).timerId&&this.doLogging()}doLogging(n=!0){const e=Hu.LoggingValueMap,i=this.dataElement.identifier;e.get(i).timerId&&(clearTimeout(e.get(i).timerId),e.get(i).timerId=null);const r=e.get(i).oldValue,o=this.dataElement.loggingValue,s=this.dataElement;if(n&&!this.isDisable&&o!=r){let a=`${""==this.name?`(\u7121\u540d\u306e${this.type})`:this.name} \u306e ${""==s.name?"(\u7121\u540d\u306e\u5909\u6570)":s.name} \u3092\u5909\u66f4`;this.showValue&&(s.isSimpleNumber||s.isNumberResource||s.isAbilityScore)?a+=` ${r} \u2192 ${o}`:s.isCheckProperty&&(a+=` ${o}`),this.chatMessageService.sendOperationLog(a)}e.get(i).oldValue=o}constructor(n,e){this.elementRef=n,this.chatMessageService=e,this.isDisable=!1,this.timeout=666,this.showValue=!0,this.type="\u30aa\u30d6\u30b8\u30a7\u30af\u30c8"}static#t=this.\u0275fac=function(e){return new(e||Hu)(Y(fr),Y(vo))};static#n=this.\u0275dir=Sn({type:Hu,selectors:[["","appLogging",""]],inputs:{isDisable:[Ce.None,"logging.disable","isDisable"],timeout:[Ce.None,"logging.timeout","timeout"],name:[Ce.None,"logging.name","name"],dataElement:[Ce.None,"logging.dataElement","dataElement"],showValue:[Ce.None,"logging.loggingValue","showValue"]}})}const YQ=(t,n,e,i)=>({box:!0,selected:t,"muluti-selected":n,"is-hide-in":e,"is-inventory-no-indicate":i}),ZQ=t=>({gameObject:t}),em=t=>({"is-active":t}),p4=t=>({"is-hide-in":t}),qQ=(t,n,e,i,r,o,s,a)=>({black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}),XQ=t=>({opacity:t}),KQ=(t,n,e,i)=>({inverse:t,hollow:n,"is-hide-in":e,"black-paint":i}),QQ=(t,n)=>({dataElm:t,name:n}),JQ=()=>({"background-color":"green"}),eJ=(t,n)=>({"outer-link":t,invalid:n});function tJ(t,n){1&t&&ii(0)}function nJ(t,n){1&t&&ii(0)}function iJ(t,n){if(1&t&&(p(0,"div")(1,"small")(2,"b"),y(3),g(),y(4,"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306f\u7a7a\u3067\u3059"),g()()),2&t){const e=v();h(3),Xe(e.getTabTitle(e.selectTab))}}function rJ(t,n){if(1&t&&(p(0,"div",14),y(1),g()),2&t){const e=v().$implicit;je("background-color",e.ownerColor),h(),Xe(e.ownerName?e.ownerName:"\uff08\u7121\u540d\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\uff09")}}function oJ(t,n){1&t&&ii(0)}function sJ(t,n){if(1&t){const e=Le();p(0,"div",11),he("contextmenu",function(r){const o=V(e).$implicit;return H(v().onContextMenu(r,o))})("click",function(r){const o=V(e).$implicit;return H(v().selectGameObject(o,r))})("dblclick",function(r){const o=V(e).$implicit;return H(v().focusGameObject(o,r))}),q(1,rJ,2,3,"div",12)(2,oJ,1,0,"ng-container",13),g()}if(2&t){const e=n.$implicit,i=v(),r=pn(11);m("ngClass",Ja(4,YQ,i.selectedIdentifier===e.identifier,i.checkSelected(e),e.isHideIn,!e.isInventoryIndicate)),h(),m("ngIf",e.isHideIn&&null!=e.ownerName),h(),m("ngTemplateOutlet",r)("ngTemplateOutletContext",Ke(9,ZQ,e))}}function aJ(t,n){if(1&t){const e=Le();p(0,"div",15)(1,"button",16),he("click",function(){return V(e),H(v().cleanInventory())}),y(2,"\u5893\u5834\u3092\u7a7a\u306b\u3059\u308b"),g()()}if(2&t){const e=v();h(),en("disabled",e.getGameObjects(e.selectTab).length<1?"":null)}}function lJ(t,n){if(1&t){const e=Le();p(0,"label")(1,"input",20),at("ngModelChange",function(r){V(e);const o=v(2);return it(o.selectTab,r)||(o.selectTab=r),H(r)}),g(),p(2,"div"),y(3),g()()}if(2&t){const e=n.$implicit,i=v(2);h(),Et("value",e),st("ngModel",i.selectTab),h(2),Bd("",i.getTabTitle(e)," (",i.getGameObjects(e).length,")")}}function cJ(t,n){if(1&t&&(p(0,"form",17)(1,"div",18),q(2,lJ,4,4,"label",19),g()()),2&t){const e=v();h(2),m("ngForOf",e.inventoryTypes)}}function uJ(t,n){if(1&t){const e=Le();Ue(0),p(1,"div")(2,"div",21)(3,"b"),y(4,"\u4e26\u3073\u9806: "),g()(),p(5,"input",22),at("ngModelChange",function(r){V(e);const o=v(2);return it(o.sortTag,r)||(o.sortTag=r),H(r)}),g(),p(6,"select",23),at("ngModelChange",function(r){V(e);const o=v(2);return it(o.sortOrder,r)||(o.sortOrder=r),H(r)}),p(7,"option",24),y(8,"\u6607\u9806"),g(),p(9,"option",25),y(10,"\u964d\u9806"),g()()(),p(11,"div",26)(12,"b"),y(13,"\u8868\u793a\u9805\u76ee: "),g()(),p(14,"input",27),at("ngModelChange",function(r){V(e);const o=v(2);return it(o.dataTag,r)||(o.dataTag=r),H(r)}),g(),p(15,"div",15)(16,"button",28),he("click",function(){return V(e),H(v(2).toggleEdit())}),p(17,"i",29),y(18,"settings"),g(),y(19,"\u5b8c\u4e86"),g()(),ze()}if(2&t){const e=v(2);h(5),st("ngModel",e.sortTag),h(),st("ngModel",e.sortOrder),h(8),st("ngModel",e.dataTag)}}function dJ(t,n){if(1&t&&(Ue(0),p(1,"span"),y(2),g(),ze()),2&t){const e=v(3);h(2),Bd("",e.sortTag," (",e.sortOrderName,")")}}function hJ(t,n){1&t&&(Ue(0),y(1,"-"),ze())}function fJ(t,n){if(1&t){const e=Le();p(0,"label",36)(1,"input",37),at("ngModelChange",function(r){V(e);const o=v(3);return it(o.indicateAll,r)||(o.indicateAll=r),H(r)}),g(),p(2,"b"),y(3,"\u3059\u3079\u3066\u8868\u793a"),p(4,"sup",38),y(5,"*"),g()()()}if(2&t){const e=v(3);h(),st("ngModel",e.indicateAll)}}function pJ(t,n){if(1&t){const e=Le();Ue(0),p(1,"table",30)(2,"tr")(3,"th",31),y(4,"\u4e26\u3073\u9806:"),g(),p(5,"td",31),q(6,dJ,3,2,"ng-container",8)(7,hJ,2,0,"ng-container",8),g(),p(8,"td",32)(9,"button",28),he("click",function(){return V(e),H(v(2).toggleEdit())}),p(10,"i",29),y(11,"settings"),g(),y(12,"\u8a2d\u5b9a"),g(),q(13,fJ,6,1,"label",33),p(14,"span",34)(15,"small")(16,"kbd",35),y(17,"Ctrl"),g(),y(18,"+\u30af\u30ea\u30c3\u30af\u3067\u8907\u6570\u9078\u629e"),g()()()()(),ze()}if(2&t){const e=v(2);h(6),m("ngIf",0<e.sortTag.length),h(),m("ngIf",e.sortTag.length<1),h(6),m("ngIf","table"===e.selectTab)}}function gJ(t,n){if(1&t&&q(0,uJ,20,3,"ng-container",8)(1,pJ,19,3,"ng-container",8),2&t){const e=v();m("ngIf",e.isEdit),h(),m("ngIf",!e.isEdit)}}function mJ(t,n){if(1&t&&(p(0,"i",58),Ge(1,"img",59),Ut(2,"safe"),g()),2&t){const e=v().gameObject;h(),m("src",zt(2,1,e.faceIcon.url,"resourceUrl"),bn)}}function _J(t,n){1&t&&(p(0,"i",45),y(1,"emoji_emotions"),g())}function bJ(t,n){if(1&t&&(p(0,"i",58),Ge(1,"img",60),Ut(2,"safe"),g()),2&t){const e=v().gameObject;h(),m("ngStyle",Ke(5,XQ,e.isDropShadow?.7:.3))("src",zt(2,2,e.shadowImageFile.url,"resourceUrl"),bn)}}function vJ(t,n){if(1&t&&(p(0,"i",45),y(1),g()),2&t){const e=v().gameObject;h(),Xe(e.isDropShadow?"star_half":"star_border")}}function yJ(t,n){if(1&t){const e=Le();p(0,"button",61),he("click",function(r){V(e);const o=v().gameObject;return H(v().onContextMenu(r,o))}),p(1,"i",62),y(2,"settings"),g()()}}function CJ(t,n){if(1&t&&(Ge(0,"img",63),Ut(1,"safe")),2&t){const e=v().gameObject;m("src",zt(1,2,e.imageFile.url,"resourceUrl"),bn)("ngClass",Ja(5,KQ,e.isInverse,e.isHollow,e.isHideIn,e.isBlackPaint))}}function xJ(t,n){1&t&&ii(0)}function wJ(t,n){if(1&t&&(Ue(0),q(1,xJ,1,0,"ng-container",13),ze()),2&t){const e=n.$implicit,i=v(2).gameObject;v();const r=pn(13);h(),m("ngTemplateOutlet",r)("ngTemplateOutletContext",Tn(2,QQ,e,i.name))}}function EJ(t,n){if(1&t&&(p(0,"div"),q(1,wJ,2,5,"ng-container",64),g()),2&t){const e=v().gameObject,i=v();h(),m("ngForOf",i.getInventoryTags(e))("ngForTrackBy",i.trackByGameObject)}}function IJ(t,n){if(1&t){const e=Le();p(0,"div",39)(1,"div",40)(2,"button",41),he("click",function(){const r=V(e).gameObject;return H(r.isUseIconToOverviewImage=!r.isUseIconToOverviewImage)}),q(3,mJ,3,4,"i",42)(4,_J,2,0,"ng-template",null,4,Ai),g(),p(6,"span",43),y(7),g(),p(8,"button",44),he("click",function(){const r=V(e).gameObject;return H(r.isShowChatBubble=!r.isShowChatBubble)}),p(9,"i",45),y(10),g()(),p(11,"button",46),he("click",function(){const r=V(e).gameObject;return H(r.isDropShadow=!r.isDropShadow)}),q(12,bJ,3,7,"i",42)(13,vJ,2,1,"ng-template",null,5,Ai),g(),p(15,"button",47),he("click",function(){const r=V(e).gameObject;return H(r.isNotRide=!r.isNotRide)}),p(16,"i",45),y(17),g()(),p(18,"button",48),he("click",function(){const r=V(e).gameObject;return H(r.isAltitudeIndicate=!r.isAltitudeIndicate)}),p(19,"i",49),y(20,"straighten"),g(),p(21,"span",50),y(22),g()(),p(23,"button",51),he("click",function(){const r=V(e).gameObject;return H(r.isInventoryIndicate=!r.isInventoryIndicate)}),p(24,"i",45),y(25,"all_inbox"),g()(),q(26,yJ,3,0,"button",52),g(),p(27,"div",53)(28,"div",54)(29,"span",55),q(30,CJ,2,10,"img",56),g()(),p(31,"div",57),q(32,EJ,2,2,"div",8),g()()()}if(2&t){const e=n.gameObject,i=pn(5),r=pn(14),o=v();h(2),m("disabled",o.selectedIdentifier!==e.identifier)("ngClass",Ke(26,em,e.isUseIconToOverviewImage)),h(),m("ngIf",e.faceIcon&&0<(null==e.faceIcon?null:e.faceIcon.url.length))("ngIfElse",i),h(4),Xe(e.name),h(),m("disabled",o.selectedIdentifier!==e.identifier)("ngClass",Ke(28,em,e.isShowChatBubble)),h(2),Xe(e.isShowChatBubble?"textsms":"speaker_notes_off"),h(),m("disabled",o.selectedIdentifier!==e.identifier)("ngClass",Ke(30,em,e.isDropShadow)),h(),m("ngIf",e.shadowImageFile&&0<e.shadowImageFile.url.length)("ngIfElse",r),h(3),m("disabled",o.selectedIdentifier!==e.identifier)("ngClass",Ke(32,em,!e.isNotRide)),h(2),Xe(e.isNotRide?"directions_run":"directions_bike"),h(),m("disabled",o.selectedIdentifier!==e.identifier)("ngClass",Ke(34,em,e.isAltitudeIndicate)),h(4),Xe(e.altitude),h(),m("disabled",o.selectedIdentifier!==e.identifier)("ngClass",Ke(36,em,e.isInventoryIndicate)),h(3),m("ngIf",o.selectedIdentifier===e.identifier),h(),m("ngClass",Ke(38,p4,e.isHideIn)),h(),m("ngClass",Ke(40,p4,e.isHideIn)),h(),m("ngClass",Yl(42,qQ,0==e.aura,1==e.aura,2==e.aura,3==e.aura,4==e.aura,5==e.aura,6==e.aura,7==e.aura)),h(),m("ngIf",e.imageFile.url),h(2),m("ngIf",e.rootDataElement)}}function TJ(t,n){1&t&&(Ue(0),Ge(1,"br"),ze())}function SJ(t,n){if(1&t){const e=Le();Ue(0),p(1,"div",70)(2,"span"),y(3),g()(),p(4,"div",71)(5,"div",72)(6,"div",73)(7,"div",74),y(8),g(),p(9,"input",75),at("ngModelChange",function(r){V(e);const o=v(2).dataElm;return it(o.value,r)||(o.value=r),H(r)}),g()()()(),ze()}if(2&t){const e=v(2),i=e.dataElm,r=e.name;h(3),Xe(i.name),h(5),Xe(i.value),h(),Et("type",i.value&&i.value==+i.value?"number":"text"),m("logging.name",r)("logging.dataElement",i),st("ngModel",i.value)}}function MJ(t,n){if(1&t){const e=Le();Ue(0),p(1,"div",76)(2,"div",77)(3,"span"),y(4),g()(),p(5,"input",78),at("ngModelChange",function(r){V(e);const o=v(2).dataElm;return it(o.currentValue,r)||(o.currentValue=r),H(r)}),g()(),p(6,"div",76)(7,"input",79),Ut(8,"safe"),at("ngModelChange",function(r){V(e);const o=v(2).dataElm;return it(o.currentValue,r)||(o.currentValue=r),H(r)}),g()(),ze()}if(2&t){const e=v(2),i=e.dataElm,r=e.name;h(4),Xe(i.name),h(),m("logging.name",r)("logging.dataElement",i),st("ngModel",i.currentValue),en("data-init-value",i.currentValue),h(2),ms(zt(8,14,"font-size: 0.8em; min-width: 1em; width:"+(i.name.length+4.5)+"em; --min: 0; --max: "+i.value+"; --val:"+i.currentValue+";","style")),Et("title",i.currentValue),Et("max",+i.value?i.value:1e3),m("logging.name",r)("logging.dataElement",i)("ngStyle",wu(17,JQ)),st("ngModel",i.currentValue),en("data-init-value",i.currentValue)}}function DJ(t,n){if(1&t){const e=Le();Ue(0),p(1,"div",70)(2,"span"),y(3),g()(),p(4,"div",71)(5,"div",72)(6,"div",73)(7,"input",80),at("ngModelChange",function(r){V(e);const o=v(2).dataElm;return it(o.value,r)||(o.value=r),H(r)}),he("change",function(){V(e);const r=v(2).dataElm;return H(r.value=r.value?r.name:"")}),g()()()(),ze()}if(2&t){const e=v(2),i=e.dataElm,r=e.name;h(),je("text-decoration",i.value?"none":"line-through"),h(2),Xe(i.name),h(4),Et("checked",i.value?"checked":""),m("logging.name",r)("logging.dataElement",i),st("ngModel",i.value)}}function kJ(t,n){if(1&t&&(p(0,"span",82),y(1),g()),2&t){const e=v(3).dataElm;h(),Si("(",(e.calcAbilityScore()>=0?"+":"")+e.calcAbilityScore(),")")}}function OJ(t,n){if(1&t){const e=Le();Ue(0),p(1,"div",70)(2,"span"),y(3),g()(),p(4,"div",71)(5,"div",72)(6,"div",73)(7,"div",74),y(8),g(),p(9,"input",75),at("ngModelChange",function(r){V(e);const o=v(2).dataElm;return it(o.value,r)||(o.value=r),H(r)}),g(),q(10,kJ,2,1,"span",81),g()()(),ze()}if(2&t){const e=v(2),i=e.dataElm,r=e.name;h(3),Xe(i.name),h(5),Xe(i.value),h(),Et("type",i.value&&i.value==+i.value?"number":"text"),m("logging.name",r)("logging.dataElement",i),st("ngModel",i.value),h(),m("ngIf",i.currentValue)}}function AJ(t,n){1&t&&(p(0,"span",86),y(1,"\u26a0\ufe0f"),g())}function PJ(t,n){if(1&t){const e=Le();Ue(0),p(1,"div",70),q(2,AJ,2,0,"span",83),p(3,"a",84),Ut(4,"safe"),he("click",function(){V(e);const r=v(2),o=r.dataElm,s=r.name,a=v();return H(!!a.stringUtil.validUrl(o.value)&&a.openUrl(o.value,s,o.name))}),p(5,"span",85),y(6),g()()(),ze()}if(2&t){const e=v(2).dataElm,i=v();h(2),m("ngIf",!i.stringUtil.validUrl(e.value)),h(),m("ngClass",Tn(9,eJ,!i.stringUtil.sameOrigin(e.value)&&i.stringUtil.validUrl(e.value),!i.stringUtil.validUrl(e.value))),en("title",e.value)("href",zt(4,6,i.stringUtil.validUrl(e.value)?e.value:"","url"),bn)("disabled",i.stringUtil.validUrl(e.value)?null:""),h(3),Xe(e.name)}}function FJ(t,n){1&t&&ii(0)}function NJ(t,n){1&t&&ii(0)}function RJ(t,n){1&t&&ii(0)}function LJ(t,n){if(1&t){const e=Le();Ue(0),p(1,"div",70)(2,"span"),y(3),g()(),p(4,"div",71)(5,"div",72)(6,"div",73)(7,"div",74),y(8),g(),p(9,"input",87),at("ngModelChange",function(r){V(e);const o=v(3).dataElm;return it(o.value,r)||(o.value=r),H(r)}),g()()()(),ze()}if(2&t){const e=v(3).dataElm;h(3),Xe(e.name),h(5),Xe(e.value),h(),Et("type","size"===e.name||"altitude"===e.name?"number":"text"),Et("min","size"===e.name?"0":""),st("ngModel",e.value)}}function BJ(t,n){if(1&t&&(Ue(0),q(1,LJ,10,5,"ng-container",8),ze()),2&t){const e=v(2).dataElm;h(),m("ngIf",0==e.children.length)}}function UJ(t,n){if(1&t&&(p(0,"div",66),Ue(1,67),q(2,SJ,10,6,"ng-container",68)(3,MJ,9,18,"ng-container",68)(4,DJ,8,7,"ng-container",68)(5,OJ,11,7,"ng-container",68)(6,PJ,7,12,"ng-container",68)(7,FJ,1,0,"ng-container",68)(8,NJ,1,0,"ng-container",68)(9,RJ,1,0,"ng-container",68)(10,BJ,2,1,"ng-container",69),ze(),g()),2&t){const e=v().dataElm;h(),m("ngSwitch",e.attributes.type),h(),m("ngSwitchCase","simpleNumber"),h(),m("ngSwitchCase","numberResource"),h(),m("ngSwitchCase","checkProperty"),h(),m("ngSwitchCase","abilityScore"),h(),m("ngSwitchCase","url"),h(),m("ngSwitchCase","colors"),h(),m("ngSwitchCase","color"),h(),m("ngSwitchCase","note")}}function zJ(t,n){if(1&t&&q(0,TJ,2,0,"ng-container",8)(1,UJ,11,9,"div",65),2&t){const e=n.dataElm,i=v();m("ngIf",e&&i.newLineStrings.includes(e.name)),h(),m("ngIf",e&&!i.newLineStrings.includes(e.name))}}let HJ=(()=>{class t{get selectTab(){return this._selectTab}set selectTab(e){this._selectTab=e,this.selectionService.clear()}get sortTag(){return this.inventoryService.sortTag}set sortTag(e){this.inventoryService.sortTag=e}get sortOrder(){return this.inventoryService.sortOrder}set sortOrder(e){this.inventoryService.sortOrder=e}get dataTag(){return this.inventoryService.dataTag}set dataTag(e){this.inventoryService.dataTag=e}get dataTags(){return this.inventoryService.dataTags}get indicateAll(){return this.inventoryService.indicateAll}set indicateAll(e){this.inventoryService.indicateAll=e}get sortOrderName(){return this.sortOrder===sS.ASC?"\u6607\u9806":"\u964d\u9806"}get newLineStrings(){return this.inventoryService.newLineStrings}get isGMMode(){return!!Fe.myCursor&&Fe.myCursor.isGMMode}selectionState(e){return this.selectionService.state(e)}checkSelected(e){return this.selectionState(e)!==$n.NONE}checkMagnetic(e){return this.selectionState(e)===$n.MAGNETIC}constructor(e,i,r,o,s,a,c){this.changeDetector=e,this.panelService=i,this.inventoryService=r,this.contextMenuService=o,this.pointerDeviceService=s,this.modalService=a,this.selectionService=c,this.inventoryTypes=["table","common","graveyard"],this._selectTab="table",this.selectedIdentifier="",this.isEdit=!1,this.stringUtil=ke,this.sortStopTimerId=null}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),ne.register(this).on("SELECT_TABLETOP_OBJECT",e=>{bt.instance.get(e.data.identifier)instanceof wr&&(this.selectedIdentifier=e.data.identifier,this.changeDetector.markForCheck())}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("UPDATE_INVENTORY",e=>{(e.isSendFromSelf||e.data)&&this.changeDetector.markForCheck()}).on("OPEN_NETWORK",e=>{this.inventoryTypes=["table","common",jt.peerId,"graveyard"],this.inventoryTypes.includes(this.selectTab)||(this.selectTab=jt.peerId)}),this.inventoryTypes=["table","common",jt.peerId,"graveyard"]}ngOnDestroy(){ne.unregister(this),this.sortStopTimerId&&clearTimeout(this.sortStopTimerId)}getTabTitle(e){switch(e){case"table":return"\u30c6\u30fc\u30d6\u30eb";case jt.peerId:return"\u500b\u4eba";case"graveyard":return"\u5893\u5834";default:return"\u5171\u6709"}}getInventory(e){switch(e){case"table":return this.inventoryService.tableInventory;case jt.peerId:return this.inventoryService.privateInventory;case"graveyard":return this.inventoryService.graveyardInventory;default:return this.inventoryService.commonInventory}}getGameObjects(e){return this.getInventory(e).tabletopObjects.filter(i=>"table"!=e||this.indicateAll||i.isInventoryIndicate)}getInventoryTags(e){return this.getInventory(e.location.name).dataElementMap.get(e.identifier)}onContextMenu(e,i){if(document.activeElement instanceof HTMLInputElement&&"range"!==document.activeElement.getAttribute("type")||(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;this.selectGameObject(i);const r=e.target;let o;if(r&&"BUTTON"===r.tagName){const c=r.getBoundingClientRect();o={x:window.pageXOffset+c.left+r.clientWidth,y:window.pageYOffset+c.top}}else o=this.pointerDeviceService.pointers[0];let s=[];if(this.checkSelected(i)){let c=()=>this.selectionService.objects.filter(f=>f.aliasName===i.aliasName),u=[];"table"!=this.selectTab&&u.push({name:"\u3059\u3079\u3066\u30c6\u30fc\u30d6\u30eb\u306b\u79fb\u52d5",action:()=>{c().forEach(f=>{ne.call("FAREWELL_STAND_IMAGE",{characterIdentifier:f.identifier});let b=gn.isStealthMode;f.setLocation("table"),this.selectionService.remove(f),f.isHideIn&&f.isVisible&&!b&&!Fe.myCursor.isGMMode&&this.modalService.open(Fr,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:ur.OK,materialIcon:"disabled_visible"})}),tt.play(Te.piecePut),ne.call("UPDATE_INVENTORY",!0)}}),"common"!=this.selectTab&&u.push({name:"\u3059\u3079\u3066\u5171\u6709\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5",action:()=>{c().forEach(f=>{f.setLocation("common"),this.selectionService.remove(f)}),tt.play(Te.piecePut),ne.call("UPDATE_INVENTORY",!0)}}),("table"===this.selectTab||"common"===this.selectTab||"graveyard"===this.selectTab)&&u.push({name:"\u3059\u3079\u3066\u500b\u4eba\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5",action:()=>{c().forEach(f=>{f.setLocation(jt.peerId),this.selectionService.remove(f)}),tt.play(Te.piecePut),ne.call("UPDATE_INVENTORY",!0)}}),"graveyard"!=this.selectTab&&u.push({name:"\u3059\u3079\u3066\u5893\u5834\u306b\u79fb\u52d5",action:()=>{c().forEach(f=>{f.setLocation("graveyard"),this.selectionService.remove(f)}),tt.play(Te.sweep),ne.call("UPDATE_INVENTORY",!0)}}),s.push({name:"\u9078\u629e\u3057\u305f\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",action:null,subActions:u}),s.push(Zt)}"table"===i.location.name&&(this.isGMMode||i.isVisible)&&s.push({name:"\u30c6\u30fc\u30d6\u30eb\u4e0a\u304b\u3089\u63a2\u3059",action:()=>{"table"===i.location.name&&ne.trigger("FOCUS_TABLETOP_OBJECT",{x:i.location.x,y:i.location.y,z:i.posZ+(i.altitude>0?50*i.altitude:0)})},default:"table"===i.location.name,disabled:"table"!==i.location.name,selfOnly:!0}),"table"!=i.location.name&&(this.isGMMode||i.isVisible)&&s.push({name:"\u30c6\u30fc\u30d6\u30eb\u3078\u79fb\u52d5",action:()=>{let c=gn.isStealthMode;ne.call("FAREWELL_STAND_IMAGE",{characterIdentifier:i.identifier}),i.setLocation("table"),this.selectionService.remove(i),i.isHideIn&&i.isVisible&&!c&&!Fe.myCursor.isGMMode&&this.modalService.open(Fr,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:ur.OK,materialIcon:"disabled_visible"}),tt.play(Te.piecePut),ne.call("UPDATE_INVENTORY",!0)}}),i.isHideIn&&s.push({name:"\u4f4d\u7f6e\u3092\u516c\u958b\u3059\u308b",action:()=>{i.owner="",tt.play(Te.piecePut),ne.trigger("UPDATE_INVENTORY",null)}}),(!i.isHideIn||!i.isVisible)&&s.push({name:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u308b\uff08\u30b9\u30c6\u30eb\u30b9\uff09",action:()=>{"table"===i.location.name&&!gn.isStealthMode&&!Fe.myCursor.isGMMode&&this.modalService.open(Fr,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:ur.OK,materialIcon:"disabled_visible"}),i.owner=jt.peer.userId,tt.play(Te.sweep),ne.call("UPDATE_INVENTORY",!0)}}),s.push(Zt),i.imageFiles.length>1&&(s.push({name:"\u753b\u50cf\u5207\u308a\u66ff\u3048",action:null,subActions:i.imageFiles.map((c,u)=>({name:i.currntImageIndex==u?"\u25c9":"\u25cb",action:()=>{i.currntImageIndex=u,tt.play(Te.surprise),ne.trigger("UPDATE_INVENTORY",null)},default:i.currntImageIndex==u,icon:c,checkBox:"radio"}))}),s.push(Zt)),s.push(i.isUseIconToOverviewImage?{name:"\u2611 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{i.isUseIconToOverviewImage=!1,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{i.isUseIconToOverviewImage=!0,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}),s.push(i.isShowChatBubble?{name:"\u2611 \u{1f4ad}\u306e\u8868\u793a",action:()=>{i.isShowChatBubble=!1,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u{1f4ad}\u306e\u8868\u793a",action:()=>{i.isShowChatBubble=!0,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}),s.push(i.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{i.isDropShadow=!1,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{i.isDropShadow=!0,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}),s.push({name:"\u753b\u50cf\u52b9\u679c",action:null,subActions:[i.isInverse?{name:"\u2611 \u53cd\u8ee2",action:()=>{i.isInverse=!1,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u53cd\u8ee2",action:()=>{i.isInverse=!0,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},i.isHollow?{name:"\u2611 \u307c\u304b\u3057",action:()=>{i.isHollow=!1,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u307c\u304b\u3057",action:()=>{i.isHollow=!0,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},i.isBlackPaint?{name:"\u2611 \u9ed2\u5857\u308a",action:()=>{i.isBlackPaint=!1,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u9ed2\u5857\u308a",action:()=>{i.isBlackPaint=!0,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},{name:"\u30aa\u30fc\u30e9",action:null,subActions:[{name:(-1==i.aura?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{i.aura=-1,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"radio"},Zt].concat(["\u30d6\u30e9\u30c3\u30af","\u30d6\u30eb\u30fc","\u30b0\u30ea\u30fc\u30f3","\u30b7\u30a2\u30f3","\u30ec\u30c3\u30c9","\u30de\u30bc\u30f3\u30bf","\u30a4\u30a8\u30ed\u30fc","\u30db\u30ef\u30a4\u30c8"].map((c,u)=>({name:`${i.aura==u?"\u25c9":"\u25cb"} ${c}`,action:()=>{i.aura=u,ne.trigger("UPDATE_INVENTORY",null)},colorSample:!0,checkBox:"radio"})))},Zt,{name:"\u30ea\u30bb\u30c3\u30c8",action:()=>{i.isInverse=!1,i.isHollow=!1,i.isBlackPaint=!1,i.aura=-1,ne.trigger("UPDATE_INVENTORY",null)},disabled:!i.isInverse&&!i.isHollow&&!i.isBlackPaint&&-1==i.aura}]}),s.push(Zt),s.push(i.isNotRide?{name:"\u2610 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{i.isNotRide=!1,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2611 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{i.isNotRide=!0,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}),s.push(i.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{i.isAltitudeIndicate=!1,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{i.isAltitudeIndicate=!0,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}),s.push({name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=i.altitude&&(i.altitude=0,"table"===i.location.name&&tt.play(Te.sweep))},altitudeHande:i}),s.push(Zt),s.push({name:"\u8a73\u7d30\u3092\u8868\u793a...",action:()=>{this.showDetail(i)}}),s.push({name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a...",action:()=>{this.showChatPalette(i)},disabled:"graveyard"===i.location.name}),s.push({name:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a...",action:()=>{this.showStandSetting(i)}}),s.push(Zt),s.push({name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:i.getUrls().map(c=>{const u=c.value.toString();return{name:c.name?c.name:u,action:()=>{ke.sameOrigin(u)?window.open(u.trim(),"_blank","noopener"):this.modalService.open(sa,{url:u,title:i.name,subTitle:c.name})},disabled:!ke.validUrl(u),error:ke.validUrl(u)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:ke.validUrl(u)&&!ke.sameOrigin(u)}}),disabled:i.getUrls().length<=0}),s.push(Zt),s.push(i.isInventoryIndicate?{name:"\u2611 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{i.isInventoryIndicate=!1,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{i.isInventoryIndicate=!0,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"});let a=[{name:"table",alias:"\u30c6\u30fc\u30d6\u30eb"},{name:"common",alias:"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"},{name:jt.peerId,alias:"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"},{name:"graveyard",alias:"\u5893\u5834"}];s.push({name:`${(a.find(c=>c.name==i.location.name)||a[1]).alias}\u304b\u3089\u79fb\u52d5`,action:null,subActions:a.filter((c,u)=>!(i.location.name==c.name||1==u&&!a.map(f=>f.name).includes(i.location.name))).map(c=>({name:`${c.alias}`,action:()=>{let u=gn.isStealthMode;ne.call("FAREWELL_STAND_IMAGE",{characterIdentifier:i.identifier}),i.setLocation(c.name),this.selectionService.remove(i),"table"===c.name&&i.isHideIn&&i.isVisible&&!u&&!Fe.myCursor.isGMMode&&this.modalService.open(Fr,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:ur.OK,materialIcon:"disabled_visible"}),tt.play("graveyard"==c.name?Te.sweep:Te.piecePut),ne.call("UPDATE_INVENTORY",!0)}})),disabled:!i.isVisible&&!this.isGMMode}),s.push(Zt),s.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{this.cloneGameObject(i),tt.play(Te.piecePut)},disabled:!i.isVisible&&!this.isGMMode}),s.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b\uff08\u81ea\u52d5\u63a1\u756a\uff09",action:()=>{const c=i.clone(),u=c.name.split("_");let f;f=u.length>1&&/\d+/.test(u[u.length-1])?u.slice(0,u.length-1).join("_"):u.join("_");let b=0;for(const C of bt.instance.getObjects(gn)){if(!C.name.startsWith(f))continue;let x=C.name.match(/_(\d+)$/)?+RegExp.$1:0;x>b&&(b=x)}c.name=f+"_"+(b+1),c.update(),tt.play(Te.piecePut)},disabled:!i.isVisible&&!this.isGMMode}),"graveyard"===i.location.name?(s.push(Zt),s.push({name:"\u524a\u9664\u3059\u308b\uff08\u5b8c\u5168\u306b\u524a\u9664\uff09",action:()=>{this.selectionService.remove(i),this.deleteGameObject(i),tt.play(Te.sweep)}})):(s.push(Zt),s.push({name:"\u524a\u9664\u3059\u308b\uff08\u5893\u5834\u3078\u79fb\u52d5\uff09",action:()=>{ne.call("FAREWELL_STAND_IMAGE",{characterIdentifier:i.identifier}),this.selectionService.remove(i),i.setLocation("graveyard"),tt.play(Te.sweep)}})),this.contextMenuService.open(o,s,i.name)}toggleEdit(){this.isEdit=!this.isEdit}cleanInventory(){let e=this.getTabTitle(this.selectTab),i=this.getGameObjects(this.selectTab);this.modalService.open(Fr,{title:"\u5893\u5834\u3092\u7a7a\u306b\u3059\u308b",text:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u5b8c\u5168\u306b\u524a\u9664\u3057\u307e\u3059\u304b\uff1f",helpHtml:`<b>${ke.escapeHtml(e)}</b>\u306b\u5b58\u5728\u3059\u308b <b>${i.length}</b> \u4f53\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u5b8c\u5168\u306b\u524a\u9664\u3057\u307e\u3059\u3002`,type:ur.OK_CANCEL,materialIcon:"delete_forever",action:()=>{for(const r of i)this.deleteGameObject(r);tt.play(Te.sweep)}})}cloneGameObject(e){e.clone()}showDetail(e){ne.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(r+=" - "+e.name),this.panelService.open(kl,{title:r,left:i.x-800,top:i.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(Qg,{left:i.x-250,top:i.y-175,width:620,height:350}).character=e}selectGameObject(e,i=null){e instanceof wr&&(i&&i instanceof MouseEvent&&i.ctrlKey?(tt.playLocal(Te.selectionStart),this.checkSelected(e)?this.selectionService.remove(e):(ne.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName,highlighting:!0}),this.selectionService.add(e))):(ne.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName,highlighting:!0}),this.checkSelected(e)||this.selectionService.clear()))}focusGameObject(e,i){i.target instanceof HTMLElement&&(new Set(["input","button"]).has(i.target.tagName.toLowerCase())||i instanceof MouseEvent&&i.ctrlKey||"table"!==e.location.name||!e.isVisible&&!this.isGMMode||ne.trigger("FOCUS_TABLETOP_OBJECT",{x:e.location.x+50*e.size/2,y:e.location.y+50*e.size/2,z:e.posZ+(e.altitude>0?50*e.altitude:0)}))}deleteGameObject(e){e.destroy(),this.changeDetector.markForCheck()}showStandSetting(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(pb,{left:i.x-400,top:i.y-175,width:730,height:572}).character=e}trackByGameObject(e,i){return i?i.identifier:e}openUrl(e,i=null,r=null){return ke.sameOrigin(e)?window.open(e.trim(),"_blank","noopener"):this.modalService.open(sa,{url:e,title:i,subTitle:r}),!1}onInput(){this.inventoryService.sortStop=!0,this.sortStopTimerId&&clearTimeout(this.sortStopTimerId),this.sortStopTimerId=setTimeout(()=>{this.inventoryService.sortStop=!1},666)}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Zr),Y(yi),Y(lS),Y(Bo),Y(lr),Y(Ei),Y(Ml))};static#t=this.\u0275cmp=In({type:t,selectors:[["game-object-inventory"]],decls:14,vars:6,consts:[["inventoryTab",""],["inventoryViewSetting",""],["gameObjectTags",""],["dataElmTag",""],["altImage",""],["altShadow",""],[1,"component",3,"input"],[4,"ngTemplateOutlet"],[4,"ngIf"],["class","object-container",3,"ngClass","contextmenu","click","dblclick",4,"ngFor","ngForOf","ngForTrackBy"],["style","padding-top: 6px;",4,"ngIf"],[1,"object-container",3,"contextmenu","click","dblclick","ngClass"],["class","owner-tag",3,"background-color",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"owner-tag"],[2,"padding-top","6px"],[1,"danger",3,"click"],[1,"is-sticky-top"],[1,"tab"],[4,"ngFor","ngForOf"],["name","tab","type","radio","ng-control","options",3,"ngModelChange","value","ngModel"],[2,"font-size","12px"],["placeholder","\u30bf\u30b0\u540d",1,"order-control",3,"ngModelChange","ngModel"],[1,"order-control",3,"ngModelChange","ngModel"],["value","ASC"],["value","DESC"],[2,"font-size","12px","padding-top","6px"],["placeholder","\u30b9\u30da\u30fc\u30b9\u533a\u5207\u308a\u3067\u30bf\u30b0\u540d \u30b9\u30e9\u30c3\u30b7\u30e5\u3067\u6539\u884c ex.\u300cHP MP / \u30e1\u30e2\u300d",2,"width","100%","box-sizing","border-box",3,"ngModelChange","ngModel"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[2,"font-size","0.8em"],["nowrap","",2,"vertical-align","middle"],["width","100%","nowrap","",2,"vertical-align","middle"],["style","float: right; font-size: smaller",4,"ngIf"],[2,"float","right","margin","2px"],[2,"border-radius","3px","border","1px outset #ccc","padding","1px","background-color","#eee"],[2,"float","right","font-size","smaller"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"self_only"],[1,"inventory-object"],[1,"object-name"],["title","\u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854\u30a2\u30a4\u30b3\u30f3\u3092\u4f7f\u7528",1,"indicate",2,"font-size","0.8em","padding","1px","width","24px","height","16px","margin-bottom","1px",3,"click","disabled","ngClass"],["class","face-icon",4,"ngIf","ngIfElse"],[1,"game-object-name",2,"margin-left","3px","margin-right","3px"],["title","\u{1f4ad}\u306e\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"click","disabled","ngClass"],[1,"material-icons",2,"font-size","1em"],["title","\u5f71\u306e\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","1px","width","24px","height","16px","margin-bottom","1px",3,"click","disabled","ngClass"],["title","\u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"click","disabled","ngClass"],["title","\u9ad8\u5ea6\u306e\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"click","disabled","ngClass"],[1,"material-icons","rotate",2,"font-size","1em"],[2,"display","inline-block","text-align","center","font-size","xx-small","color","gray","min-width","2em"],["title","\u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"click","disabled","ngClass"],["style","font-size: 0.8em; padding: 2px 5px;","title","\u30e1\u30cb\u30e5\u30fc",3,"click",4,"ngIf"],[1,"object-tags-box",3,"ngClass"],[1,"table-cell","image-box",3,"ngClass"],[1,"aura",3,"ngClass"],["class","inverser","draggable","false",3,"src","ngClass",4,"ngIf"],[1,"table-cell"],[1,"face-icon"],["alt","",3,"src"],["alt","",2,"filter","brightness(0)",3,"ngStyle","src"],["title","\u30e1\u30cb\u30e5\u30fc",2,"font-size","0.8em","padding","2px 5px",3,"click"],[1,"material-icons",2,"font-size","1em","pointer-events","none"],["draggable","false",1,"inverser",3,"src","ngClass"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","object-tag",4,"ngIf"],[1,"object-tag"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"tag-name"],[2,"text-align","center"],[2,"display","inline-block"],[1,"tag-value-box"],[1,"hidden-spacer",2,"font-weight","bold"],["appLogging","","size","1","placeholder","",1,"input","tag-value",3,"ngModelChange","logging.name","logging.dataElement","type","ngModel"],[1,"resource-tag"],[2,"font-size","0.8em","display","inline-block","margin-right","0.5em"],["appLogging","","type","number","size","1","placeholder","Value",1,"input","resource-value",3,"ngModelChange","logging.name","logging.dataElement","ngModel"],["appLogging","","type","range","min","0",3,"ngModelChange","logging.name","logging.dataElement","title","max","ngStyle","ngModel"],["appLogging","","type","checkbox",3,"ngModelChange","change","logging.name","logging.dataElement","ngModel","checked"],["style","font-size: smaller;",4,"ngIf"],[2,"font-size","smaller"],["title","URL\u304c\u4e0d\u6b63\u3067\u3059",4,"ngIf"],["draggable","false","target","_blank",3,"click","ngClass"],[1,"url-link"],["title","URL\u304c\u4e0d\u6b63\u3067\u3059"],["size","1",1,"input","tag-value",2,"min-width","4em",3,"ngModelChange","type","min","ngModel"]],template:function(i,r){if(1&i){const o=Le();p(0,"div",6),he("input",function(){return V(o),H(r.onInput())}),q(1,tJ,1,0,"ng-container",7)(2,nJ,1,0,"ng-container",7)(3,iJ,5,1,"div",8)(4,sJ,3,11,"div",9)(5,aJ,3,1,"div",10),g(),q(6,cJ,3,1,"ng-template",null,0,Ai)(8,gJ,2,2,"ng-template",null,1,Ai)(10,IJ,33,51,"ng-template",null,2,Ai)(12,zJ,2,2,"ng-template",null,3,Ai)}if(2&i){const o=pn(7),s=pn(9);h(),m("ngTemplateOutlet",o),h(),m("ngTemplateOutlet",s),h(),m("ngIf",r.getGameObjects(r.selectTab).length<1),h(),m("ngForOf",r.getGameObjects(r.selectTab))("ngForTrackBy",r.trackByGameObject),h(),m("ngIf","graveyard"===r.selectTab)}},dependencies:[Ni,nr,ri,uf,Lo,Hd,Dg,M0,ff,na,ia,kr,yl,Cl,Ea,Ia,Yd,Or,hf,Cr,Mu,Hu,cr],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{width:100%}.box[_ngcontent-%COMP%]{border:transparent 2px solid;border-left:transparent 6px solid;margin-top:2px;padding:2px 2px 3px;box-sizing:border-box;border-bottom:1px dotted #666}.selected[_ngcontent-%COMP%]{padding:2px;border:2px dotted #666;border-left:6px solid #EFBC70}.selected.is-inventory-no-indicate[_ngcontent-%COMP%]{border-left-color:#80ccee}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;font-size:1em;min-width:1em;max-width:12em;overflow:hidden;padding:0 2px;box-sizing:border-box;white-space:nowrap}.input[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;padding:2px;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#eee}.input[_ngcontent-%COMP%]:focus{background:#fff}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.tab[_ngcontent-%COMP%]{padding:0;border:solid 1px #555;border-radius:.3em;overflow:hidden;display:flex;flex-flow:row nowrap;justify-content:space-around;align-items:stretch;text-align:center;margin:0;max-width:500px;background-color:#f0dabde6}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;flex:1 0 auto;flex-grow:1}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:checked{background:#555;color:#ccc}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{vertical-align:middle;outline:0;font-size:.6em;background-color:transparent;color:#444;box-sizing:border-box;margin:0;padding:2px 8px;cursor:pointer}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.is-sticky-top[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10000}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.table-cell[_ngcontent-%COMP%]{display:table-cell}.image-box[_ngcontent-%COMP%]{padding:0;width:32px;height:32px;display:table-cell;vertical-align:top}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.inventory-object[_ngcontent-%COMP%]{font-size:14px;display:inline-block;vertical-align:text-top}.object-name[_ngcontent-%COMP%]{font-size:.8em;font-weight:700;padding:0 .25em}.object-tags-box[_ngcontent-%COMP%]{display:table;table-layout:fixed}.object-tag[_ngcontent-%COMP%]{display:inline-block;padding:0 .25em;vertical-align:middle}.resource-tag[_ngcontent-%COMP%]{text-align:center;vertical-align:bottom;overflow:hidden;white-space:nowrap}.resource-value[_ngcontent-%COMP%]{font-weight:700;width:4em;text-align:right;font-family:inherit}.tag-name[_ngcontent-%COMP%]{font-size:.8em;text-align:left;vertical-align:bottom;min-width:1em;max-width:12em;overflow:hidden;white-space:nowrap}.tag-value-box[_ngcontent-%COMP%]{display:table-cell;width:10px}.tag-value[_ngcontent-%COMP%]{font-size:1em;font-weight:700;width:100%;min-width:1em;max-width:12em;text-align:center;font-family:inherit}.tag-value[type=number][_ngcontent-%COMP%]{min-width:3.4em;text-align:right}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.5}.inverser.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.inverser.is-hide-in[_ngcontent-%COMP%]{filter:invert(100%)}.inverser.black-paint.is-hide-in[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out;pointer-events:none}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #00f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 3px #aaa) drop-shadow(0 -2px 2px #fff)}.material-icons.rotate[_ngcontent-%COMP%]{transform:rotate(90deg)}button.indicate[_ngcontent-%COMP%]:disabled{border-color:transparent}button.indicate[_ngcontent-%COMP%]:disabled   .material-icons[_ngcontent-%COMP%]{color:#000}button.indicate[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:.5}button.is-active[_ngcontent-%COMP%]{background-color:#fff}button.is-active[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:1}button.link[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}button.link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button.link[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}button.link[_ngcontent-%COMP%]:disabled{color:gray}button.link[_ngcontent-%COMP%]:disabled:hover{background-color:transparent}.face-icon[_ngcontent-%COMP%]{display:inline-block;width:12px;height:12px;max-width:12px;max-height:12px;vertical-align:middle;overflow:hidden}.face-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;object-position:50% 0%;border-radius:.2rem}.self_only[_ngcontent-%COMP%]{color:red}.order-control[_ngcontent-%COMP%]{box-sizing:border-box;height:1.6em}.object-container.is-hide-in[_ngcontent-%COMP%]{background-color:#34549966}.object-container.is-hide-in[_ngcontent-%COMP%]   .game-object-name[_ngcontent-%COMP%], .object-tags-box.is-hide-in[_ngcontent-%COMP%]{color:#ddd;filter:invert(85%)}.image-box.is-hide-in[_ngcontent-%COMP%]{filter:invert(100%)}.object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:#ddd}.object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active, .object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{color:#222}.object-container[_ngcontent-%COMP%]{position:relative}.owner-tag[_ngcontent-%COMP%]{position:absolute;font-size:8px;width:min-content;max-width:100%;overflow:hidden;color:#f5f5f5;background-color:#1e1e1e;box-sizing:border-box;padding:2px 6px;border-radius:6px;white-space:nowrap;text-overflow:ellipsis;opacity:.9;top:1px;right:1px;pointer-events:none}.url-link[_ngcontent-%COMP%]{cursor:inherit}.muluti-selected[_ngcontent-%COMP%]{border-top:2px dotted #666;border-bottom:2px dotted #666;border-right:5px solid hsla(200,100%,75%,.6)}.muluti-selected[_ngcontent-%COMP%]:not(.selected){padding-left:6px;border-left:2px dotted #666}"],changeDetection:0})}return t})();const VJ=vn.create("./assets/images/skeleton.png");let tm=(()=>{class t{constructor(){}getSkeletonOr(e){let i=e instanceof vn?e:on.instance.get(e);return i&&!i.isEmpty?i:VJ}getEmptyOr(e){let i=e instanceof vn?e:on.instance.get(e);return i&&!i.isEmpty?i:vn.Empty}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const jJ=t=>({"red-eye":t}),cS=t=>({blackout:t}),GJ=t=>({disabled:t}),WJ=t=>({"is-hidden":t});function $J(t,n){if(1&t&&(p(0,"option",12),y(1),g()),2&t){const e=n.$implicit;je("color",""==e.name?"gray":""),Et("value",e.identifier),Et("title",e.name),h(),Xe(""==e.name?"(\u7121\u540d\u306e\u30c6\u30fc\u30d6\u30eb)":e.name)}}function YJ(t,n){if(1&t&&(p(0,"span",54)(1,"i",55),y(2),g()()),2&t){const e=v(2);h(),yg(e.isShowHideImages?"red-eye":"grow"),h(),Xe(e.isShowHideImages?"visibility":"visibility_off")}}function ZJ(t,n){if(1&t){const e=Le();p(0,"div")(1,"button",56),he("click",function(){return V(e),H(v(2).openDistanceViewImageModal())}),y(2,"\u80cc\u666f\u753b\u50cf\uff11\u3092\u8ffd\u52a0"),g()()}if(2&t){const e=v(2);h(),m("disabled",!e.isEditable)}}function qJ(t,n){if(1&t&&(p(0,"span",54)(1,"i",55),y(2),g()()),2&t){const e=v(3);h(),yg(e.isShowHideImages?"red-eye":"grow"),h(),Xe(e.isShowHideImages?"visibility":"visibility_off")}}function XJ(t,n){if(1&t){const e=Le();p(0,"span",14),he("click",function(){return V(e),H(v(2).openDistanceViewImageModal())}),q(1,qJ,3,3,"span",15),Ge(2,"img",16),Ut(3,"safe"),g()}if(2&t){const e=v(2);je("cursor",e.isEditable&&-1!=e.tableGridType?"pointer":"default"),h(),m("ngIf",e.getHidden(e.tableDistanceviewImage)),h(),m("ngClass",Ke(8,cS,!e.isShowHideImages&&e.getHidden(e.tableDistanceviewImage)))("src",zt(3,5,e.tableDistanceviewImage.url,"resourceUrl"),bn)}}function KJ(t,n){if(1&t){const e=Le();p(0,"div")(1,"button",57),he("click",function(){return V(e),H(v(2).openDistanceViewImageModal2())}),y(2,"\u80cc\u666f\u753b\u50cf\uff12\u3092\u8ffd\u52a0"),g()()}if(2&t){const e=v(2);h(),m("disabled",!e.isEditable)}}function QJ(t,n){if(1&t&&(p(0,"span",54)(1,"i",55),y(2),g()()),2&t){const e=v(3);h(),yg(e.isShowHideImages?"red-eye":"grow"),h(),Xe(e.isShowHideImages?"visibility":"visibility_off")}}function JJ(t,n){if(1&t){const e=Le();p(0,"span",14),he("click",function(){return V(e),H(v(2).openDistanceViewImageModal2())}),q(1,QJ,3,3,"span",15),Ge(2,"img",16),Ut(3,"safe"),g()}if(2&t){const e=v(2);je("cursor",e.isEditable&&-1!=e.tableGridType?"pointer":"default"),h(),m("ngIf",e.getHidden(e.tableDistanceviewImage2)),h(),m("ngClass",Ke(8,cS,!e.isShowHideImages&&e.getHidden(e.tableDistanceviewImage2)))("src",zt(3,5,e.tableDistanceviewImage2.url,"resourceUrl"),bn)}}function eee(t,n){if(1&t&&(p(0,"div",62),y(1),g()),2&t){const e=v(3);h(),Si("",e.progresPercent,"%")}}function tee(t,n){if(1&t){const e=Le();Ue(0),p(1,"button",58),he("click",function(){return V(e),H(v(2).save())}),p(2,"div",59)(3,"div",45),y(4,"\u4fdd\u5b58"),g(),q(5,eee,2,1,"div",60),g()(),p(6,"button",61),he("click",function(){return V(e),H(v(2).delete())}),y(7,"\u524a\u9664"),g(),ze()}if(2&t){const e=v(2);h(),m("disabled",e.isSaveing),h(2),m("ngClass",Ke(4,WJ,e.isSaveing)),h(2),m("ngIf",e.isSaveing),h(),m("disabled",e.getGameTables().length<=1)}}function nee(t,n){if(1&t){const e=Le();Ue(0),p(1,"button",63),he("click",function(){return V(e),H(v(2).restore())}),y(2,"\u5143\u306b\u623b\u3059"),g(),ze()}}function iee(t,n){if(1&t){const e=Le();Ue(0),p(1,"div",13)(2,"div")(3,"b"),y(4,"\u753b\u50cf"),g(),p(5,"span",14),he("click",function(){return V(e),H(v().openBgImageModal())}),q(6,YJ,3,3,"span",15),Ge(7,"img",16),Ut(8,"safe"),g()()(),p(9,"div",13)(10,"div")(11,"b"),y(12,"\u80cc\u666f\uff11\uff08\u524d\u9762\uff09"),g(),q(13,ZJ,3,1,"div",11)(14,XJ,4,10,"span",17),g(),p(15,"div")(16,"b"),y(17,"\u80cc\u666f\uff12\uff08\u80cc\u9762\uff09"),g(),q(18,KJ,3,1,"div",11)(19,JJ,4,10,"span",17),g()(),p(20,"div")(21,"div",18),y(22,"Name\uff1a"),p(23,"input",19),at("ngModelChange",function(r){V(e);const o=v();return it(o.tableName,r)||(o.tableName=r),H(r)}),g()()(),p(24,"div",20)(25,"div",21)(26,"div",22)(27,"div",18),y(28,"Width\uff1a"),g()(),p(29,"div",23)(30,"input",24),at("ngModelChange",function(r){V(e);const o=v();return it(o.tableWidth,r)||(o.tableWidth=r),H(r)}),g()(),p(31,"div",25)(32,"input",26),at("ngModelChange",function(r){V(e);const o=v();return it(o.tableWidth,r)||(o.tableWidth=r),H(r)}),g()()(),p(33,"div",21)(34,"div",22)(35,"div",18),y(36,"Height\uff1a"),g()(),p(37,"div",23)(38,"input",27),at("ngModelChange",function(r){V(e);const o=v();return it(o.tableHeight,r)||(o.tableHeight=r),H(r)}),g()(),p(39,"div",25)(40,"input",26),at("ngModelChange",function(r){V(e);const o=v();return it(o.tableHeight,r)||(o.tableHeight=r),H(r)}),g()()()(),p(41,"div")(42,"div",18),y(43,"\u30b0\u30ea\u30c3\u30c9\uff1a "),p(44,"select",28),at("ngModelChange",function(r){V(e);const o=v();return it(o.tableGridType,r)||(o.tableGridType=r),H(r)}),p(45,"option",29),y(46,"\u306a\u3057"),g(),p(47,"option",30),y(48,"\u30b9\u30af\u30a8\u30a2"),g(),p(49,"option",31),y(50,"\u30d8\u30af\u30b9\uff08\u7e26\u63c3\u3048\uff09"),g(),p(51,"option",32),y(52,"\u30d8\u30af\u30b9\uff08\u6a2a\u63c3\u3048\uff09"),g()()(),p(53,"div",33),y(54,"\u8272\uff1a "),p(55,"select",34),at("ngModelChange",function(r){V(e);const o=v();return it(o.tableGridColor,r)||(o.tableGridColor=r),H(r)}),p(56,"option",35),y(57,"\u9ed2"),g(),p(58,"option",36),y(59,"\u9752"),g(),p(60,"option",37),y(61,"\u7dd1"),g(),p(62,"option",38),y(63,"\u6c34\u8272"),g(),p(64,"option",39),y(65,"\u8d64"),g(),p(66,"option",40),y(67,"\u7d2b"),g(),p(68,"option",41),y(69,"\u9ec4"),g(),p(70,"option",42),y(71,"\u767d"),g()()()(),p(72,"div")(73,"label",43)(74,"input",44),at("ngModelChange",function(r){V(e);const o=v();return it(o.tableGridNumberShow,r)||(o.tableGridNumberShow=r),H(r)}),g(),p(75,"span",45),y(76,"\u30b0\u30ea\u30c3\u30c9\u306e\u5ea7\u6a19\u756a\u53f7\u3092\u8868\u793a"),g()()(),p(77,"div")(78,"div",18),y(79,"\u80cc\u666f\u30d5\u30a3\u30eb\u30bf\uff1a "),p(80,"select",46),at("ngModelChange",function(r){V(e);const o=v();return it(o.tableDistanceviewFilter,r)||(o.tableDistanceviewFilter=r),H(r)}),p(81,"option",47),y(82,"\u306a\u3057"),g(),p(83,"option",48),y(84,"\u30db\u30ef\u30a4\u30c8"),g(),p(85,"option",49),y(86,"\u30d6\u30e9\u30c3\u30af"),g()()()(),Ge(87,"hr"),p(88,"div")(89,"label",43)(90,"input",50),at("ngModelChange",function(r){V(e);const o=v();return it(o.tableGridShow,r)||(o.tableGridShow=r),H(r)}),g(),y(91," \u30b0\u30ea\u30c3\u30c9\u3092\u5e38\u306b\u8868\u793a"),p(92,"sup",51),y(93,"*"),g()(),p(94,"label",52)(95,"input",53),at("ngModelChange",function(r){V(e);const o=v();return it(o.tableGridSnap,r)||(o.tableGridSnap=r),H(r)}),g(),y(96," \u30b9\u30ca\u30c3\u30d7"),p(97,"sup",51),y(98,"*"),g()(),q(99,tee,8,6,"ng-container",11)(100,nee,3,0,"ng-container",11),g(),ze()}if(2&t){const e=v();h(5),je("cursor",e.isEditable&&-1!=e.tableGridType?"pointer":"default"),h(),m("ngIf",e.getHidden(e.tableBackgroundImage)),h(),m("ngClass",Ke(47,cS,!e.isShowHideImages&&e.getHidden(e.tableBackgroundImage)))("src",zt(8,44,e.tableBackgroundImage.url,"resourceUrl"),bn),h(6),m("ngIf",!e.tableDistanceviewImage.url),h(),m("ngIf",e.tableDistanceviewImage.url),h(4),m("ngIf",!e.tableDistanceviewImage2.url),h(),m("ngIf",e.tableDistanceviewImage2.url),h(4),st("ngModel",e.tableName),m("disabled",!e.isEditable),h(7),Et("title",e.tableWidth),Et("min",e.minSize),Et("max",e.maxSize),st("ngModel",e.tableWidth),m("disabled",!e.isEditable),h(2),Et("min",e.minSize),Et("max",e.maxSize),st("ngModel",e.tableWidth),m("disabled",!e.isEditable),h(6),Et("title",e.tableHeight),Et("min",e.minSize),Et("max",e.maxSize),st("ngModel",e.tableHeight),m("disabled",!e.isEditable),h(2),Et("min",e.minSize),Et("max",e.maxSize),st("ngModel",e.tableHeight),m("disabled",!e.isEditable),h(4),st("ngModel",e.tableGridType),m("disabled",!e.isEditable),h(11),st("ngModel",e.tableGridColor),m("disabled",!e.isEditable||-1==e.tableGridType),h(19),st("ngModel",e.tableGridNumberShow),m("disabled",!e.isEditable||-1==e.tableGridType),h(),je("cursor",e.isEditable&&-1!=e.tableGridType?"pointer":"default"),m("ngClass",Ke(49,GJ,!e.isEditable||-1==e.tableGridType)),h(5),st("ngModel",e.tableDistanceviewFilter),m("disabled",!e.isEditable),h(10),st("ngModel",e.tableGridShow),h(5),st("ngModel",e.tableGridSnap),h(4),m("ngIf",!e.isDeleted),h(),m("ngIf",e.isDeleted)}}function ree(t,n){1&t&&(Ue(0),p(1,"div",64),y(2,"\u203b\u30c6\u30fc\u30d6\u30eb\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b\u300d\u304b\u3089\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),g(),ze())}let g4=(()=>{class t{get tableBackgroundImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.imageIdentifier:null)}get tableDistanceviewImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.backgroundImageIdentifier:null)}get tableDistanceviewImage2(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.backgroundImageIdentifier2:null)}get tableName(){return this.selectedTable.name}set tableName(e){this.isEditable&&(this.selectedTable.name=e)}get tableWidth(){return this.selectedTable.width}set tableWidth(e){this.isEditable&&(this.selectedTable.width=e)}get tableHeight(){return this.selectedTable.height}set tableHeight(e){this.isEditable&&(this.selectedTable.height=e)}get tableGridColor(){return this.selectedTable.gridColor}set tableGridColor(e){this.isEditable&&(this.selectedTable.gridColor=e)}get tableGridShow(){return this.tableSelecter.gridShow}set tableGridShow(e){this.tableSelecter.gridShow=e,e&&(this.tableSelecter.viewTable.gridClipRect=null),ne.trigger("UPDATE_GAME_OBJECT",this.tableSelecter.toContext())}get tableGridSnap(){return this.tableSelecter.gridSnap}set tableGridSnap(e){this.tableSelecter.gridSnap=e}get tableGridType(){return this.selectedTable.gridType}set tableGridType(e){this.isEditable&&(this.selectedTable.gridType=Number(e))}get tableGridNumberShow(){return this.selectedTable.isShowNumber}set tableGridNumberShow(e){this.selectedTable.isShowNumber=e,ne.trigger("UPDATE_GAME_OBJECT",this.tableSelecter.toContext())}get tableDistanceviewFilter(){return this.selectedTable.backgroundFilterType}set tableDistanceviewFilter(e){this.isEditable&&(this.selectedTable.backgroundFilterType=e)}get tableSelecter(){return Ho.instance}get isEmpty(){return!this.tableSelecter||!this.tableSelecter.viewTable}get isDeleted(){return!this.selectedTable||null==bt.instance.get(this.selectedTable.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}constructor(e,i,r,o,s,a){this.changeDetector=e,this.modalService=i,this.saveDataService=r,this.imageService=o,this.panelService=s,this.chatMessageService=a,this.minSize=1,this.maxSize=100,this.isShowHideImages=!1,this.selectedTable=null,this.selectedTableXml="",this.isSaveing=!1,this.progresPercent=0}ngOnInit(){Promise.resolve().then(()=>{this.modalService.title=this.panelService.title="\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a"}),this.selectedTable=this.tableSelecter.viewTable,ne.register(this).on("DELETE_GAME_OBJECT",2e3,e=>{if(!this.selectedTable||e.data.identifier!==this.selectedTable.identifier)return;let i=bt.instance.get(e.data.identifier);null!==i&&(this.selectedTableXml=i.toXml())})}ngOnDestroy(){ne.unregister(this)}selectGameTable(e){ne.call("SELECT_GAME_TABLE",{identifier:e},jt.peerId),this.selectedTable=bt.instance.get(e),this.selectedTableXml=""}getGameTables(){return bt.instance.getObjects(bo)}createGameTable(){let e=new bo;e.name="\u767d\u7d19\u306e\u30c6\u30fc\u30d6\u30eb",e.imageIdentifier="testTableBackgroundImage_image",e.initialize(),this.selectGameTable(e.identifier)}save(){var e=this;return(0,L.A)(function*(){!e.selectedTable||e.isSaveing||(e.isSaveing=!0,e.progresPercent=0,e.selectedTable.selected=!0,yield e.saveDataService.saveGameObjectAsync(e.selectedTable,"fly_map_"+e.selectedTable.name,i=>{e.progresPercent=i}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500))})()}delete(){!this.isEmpty&&this.selectedTable&&(this.selectedTableXml=this.selectedTable.toXml(),this.selectedTable.destroy())}restore(){if(this.selectedTable&&this.selectedTableXml){let e=ar.instance.parseXml(this.selectedTableXml);this.selectGameTable(e.identifier),this.selectedTableXml=""}}getHidden(e){const i=ui.get(e.identifier);return!!i&&i.hide}openBgImageModal(){if(this.isDeleted)return;let e=[];this.selectedTable&&this.selectedTable.imageIdentifier&&(e=[this.selectedTable.imageIdentifier]),this.modalService.open(Yc,{currentImageIdentifires:e}).then(i=>{!this.selectedTable||!i||(this.selectedTable.imageIdentifier=i)})}openDistanceViewImageModal(){if(this.isDeleted)return;let e=[];this.selectedTable&&this.selectedTable.backgroundImageIdentifier&&(e=[this.selectedTable.backgroundImageIdentifier]),this.modalService.open(Yc,{isAllowedEmpty:!0,currentImageIdentifires:e}).then(i=>{!this.selectedTable||!i||(this.selectedTable.backgroundImageIdentifier=i)})}openDistanceViewImageModal2(){if(this.isDeleted)return;let e=[];this.selectedTable&&this.selectedTable.backgroundImageIdentifier2&&(e=[this.selectedTable.backgroundImageIdentifier2]),this.modalService.open(Yc,{isAllowedEmpty:!0,currentImageIdentifires:e}).then(i=>{!this.selectedTable||!i||(this.selectedTable.backgroundImageIdentifier2=i)})}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(Fr,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:ur.OK_CANCEL,materialIcon:"visibility",action:()=>{this.chatMessageService.sendOperationLog("\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a \u304b\u3089\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u305f"),this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Zr),Y(Ei),Y(ll),Y(tm),Y(yi),Y(vo))};static#t=this.\u0275cmp=In({type:t,selectors:[["game-table-setting"]],decls:16,vars:9,consts:[["select",""],[1,"flex-container"],[1,"flex-item","no-grow"],[2,"margin","0px 0px 2px 0px","font-size","smaller",3,"click"],["size","19",2,"width","100%","max-width","155px",3,"change","ngModel"],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[2,"float","right","margin-top","3px","margin-right","3px"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"click","checked"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[4,"ngIf"],[3,"value","title"],[1,"images-select"],[2,"display","block","position","relative","overflow","hidden",3,"click"],["style","display: block; position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["height","120","draggable","false",3,"ngClass","src"],["style","display: block; position: relative; overflow: hidden",3,"cursor","click",4,"ngIf"],[1,"self-setting",2,"display","inline"],["placeholder","Name",3,"ngModelChange","ngModel","disabled"],[2,"display","table","width","90%"],[2,"display","table-row"],[2,"display","table-cell","width","4em"],[2,"display","table-cell"],["type","range","name","tableWidth",2,"width","calc(100% - 4px)",3,"ngModelChange","ngModel","title","min","max","disabled"],[2,"display","table-cell","width","5em"],["type","number",2,"width","5em",3,"ngModelChange","ngModel","min","max","disabled"],["type","range","name","tableHeight",2,"width","calc(100% - 4px)",3,"ngModelChange","ngModel","title","min","max","disabled"],["name","tableGridType",3,"ngModelChange","ngModel","disabled"],["value","-1"],["value","0"],["value","1"],["value","2"],[1,"self-setting",2,"display","inline","margin-left","1.2em"],["name","tableGridColor",3,"ngModelChange","ngModel","disabled"],["value","#000000e6"],["value","#0000dde6"],["value","#00dd00e6"],["value","#00dddde6"],["value","#dd0000e6"],["value","#dd00dde6"],["value","#dddd00e6"],["value","#dddddde6"],[1,"self-setting"],["type","checkbox","name","tableGridNumberShow",3,"ngModelChange","ngModel","disabled"],[3,"ngClass"],["name","tableDistanceviewFilter",3,"ngModelChange","ngModel","disabled"],["value",""],["value","white"],["value","black"],["type","checkbox","name","tableGridShow",3,"ngModelChange","ngModel"],[1,"self-only"],[1,"self-setting",2,"margin-left","1em"],["type","checkbox","name","tableGridSnap",3,"ngModelChange","ngModel"],[2,"display","block","position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons",2,"margin-right","2px","font-size","16px","display","block"],[2,"height","120px","margin","0px 1px 2px 0px",3,"click","disabled"],[2,"height","120px","margin","0px 0px 2px 0px",3,"click","disabled"],[2,"margin-left","2em",3,"click","disabled"],[2,"position","relative"],["class","progress",4,"ngIf"],[1,"danger",3,"click","disabled"],[1,"progress"],[3,"click"],[2,"font-size","12px"]],template:function(i,r){if(1&i){const o=Le();p(0,"div",1)(1,"div",2)(2,"div")(3,"button",3),he("click",function(){return V(o),H(r.createGameTable())}),y(4,"\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b"),g()(),p(5,"select",4,0),he("change",function(){V(o);const a=pn(6);return H(r.selectGameTable(a.value))}),q(7,$J,2,5,"option",5),g()(),p(8,"div",6)(9,"div",7)(10,"label",8)(11,"input",9),he("click",function(a){return V(o),H(r.onShowHiddenImages(a))}),g(),p(12,"i",10),y(13),g()()(),q(14,iee,101,51,"ng-container",11),g()(),q(15,ree,3,0,"ng-container",11)}2&i&&(h(5),m("ngModel",null==r.selectedTable?null:r.selectedTable.identifier),h(2),m("ngForOf",r.getGameTables()),h(4),Et("checked",r.isShowHideImages?"checked":""),h(),m("ngClass",Ke(7,jJ,r.isShowHideImages)),h(),Xe(r.isShowHideImages?"visibility":"visibility_off"),h(),m("ngIf",!r.isEmpty||r.selectedTable),h(),m("ngIf",r.isEmpty))},dependencies:[Ni,nr,ri,na,ia,kr,yl,Cl,Ea,Ia,Or,ku,Du,Cr,cr],styles:["[_nghost-%COMP%]{display:block}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.images-select[_ngcontent-%COMP%]{display:flex}input[type=number][_ngcontent-%COMP%]{text-align:right}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.blackout[_ngcontent-%COMP%]{filter:blur(12px) grayscale(70%)}.self-only[_ngcontent-%COMP%]{color:red}img[_ngcontent-%COMP%]{transition:all .1s 0s ease}.self-setting[_ngcontent-%COMP%]{font-weight:bolder;font-size:smaller}.disabled[_ngcontent-%COMP%]{color:gray;font-weight:400}"]})}return t})();const oee=t=>({last:t});function see(t,n){if(1&t){const e=Le();p(0,"button",33),he("click",function(){V(e);const r=v().$implicit;return H(v().play(r))}),p(1,"i",34),y(2,"play_arrow"),g(),y(3,"\u8a66\u8074"),p(4,"sup",27),y(5,"*"),g()()}2&t&&m("disabled",!v().$implicit.isReady)}function aee(t,n){if(1&t){const e=Le();p(0,"button",33),he("click",function(){return V(e),H(v(2).stop())}),p(1,"i",34),y(2,"stop"),g(),y(3,"\u8a66\u8074"),p(4,"sup",27),y(5,"*"),g()()}2&t&&m("disabled",!v().$implicit.isReady)}function lee(t,n){if(1&t){const e=Le();p(0,"button",33),he("click",function(){V(e);const r=v().$implicit;return H(v().playBGM(r))}),p(1,"i",34),y(2,"loop"),g(),y(3,"\uff22\uff27\uff2d"),g()}2&t&&m("disabled",!v().$implicit.isReady)}function cee(t,n){if(1&t){const e=Le();p(0,"button",33),he("click",function(){V(e);const r=v().$implicit;return H(v().stopBGM(r))}),p(1,"i",34),y(2,"stop"),g(),y(3,"\uff22\uff27\uff2d"),g()}2&t&&m("disabled",!v().$implicit.isReady)}function uee(t,n){1&t&&(p(0,"span",32)(1,"b"),y(2,"\u3010\u8a66\u8074\u4e2d\u3011"),g()())}function dee(t,n){1&t&&(p(0,"span",32)(1,"i",35),y(2,"volume_up"),g()())}function hee(t,n){1&t&&(p(0,"span",32)(1,"i",35),y(2,"volume_up"),g(),p(3,"b"),y(4,"\u3010\u8a66\u8074\u4e2d\u3011"),g()())}function fee(t,n){if(1&t&&(Ue(0),q(1,dee,3,0,"span",30)(2,hee,5,0,"span",30),ze()),2&t){const e=v().$implicit,i=v();h(),m("ngIf",e!=(null==i.auditionPlayer?null:i.auditionPlayer.audio)||e==(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&(null==i.auditionPlayer?null:i.auditionPlayer.paused)),h(),m("ngIf",e===(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&!(null!=i.auditionPlayer&&i.auditionPlayer.paused))}}function pee(t,n){if(1&t&&(p(0,"div",28),q(1,see,6,1,"button",29)(2,aee,6,1,"button",29)(3,lee,4,1,"button",29)(4,cee,4,1,"button",29)(5,uee,3,0,"span",30)(6,fee,3,2,"ng-container",31),p(7,"span",32),y(8),g()()),2&t){const e=n.$implicit,i=n.last,r=v();m("ngClass",Ke(10,oee,i)),h(),m("ngIf",e!==(null==r.auditionPlayer?null:r.auditionPlayer.audio)||(null==r.auditionPlayer?null:r.auditionPlayer.paused)),h(),m("ngIf",e===(null==r.auditionPlayer?null:r.auditionPlayer.audio)&&!(null!=r.auditionPlayer&&r.auditionPlayer.paused)),h(),m("ngIf",e!==(null==r.jukebox?null:r.jukebox.audio)),h(),m("ngIf",e===(null==r.jukebox?null:r.jukebox.audio)),h(),m("ngIf",e===(null==r.auditionPlayer?null:r.auditionPlayer.audio)&&!(null!=r.auditionPlayer&&r.auditionPlayer.paused)&&e!=(null==r.jukebox?null:r.jukebox.audio)),h(),m("ngIf",e===(null==r.jukebox?null:r.jukebox.audio)),h(),je("font-weight",e===(null==r.jukebox?null:r.jukebox.audio)?"bolder":"normal"),h(),Xe(e.name)}}function gee(t,n){1&t&&(p(0,"div",36)(1,"small")(2,"b"),y(3,"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u3053\u3053\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002"),g()()())}let mee=(()=>{class t{get isMute(){return Je.isMute}set isMute(e){Je.isMute=e,ne.trigger("CHANGE_JUKEBOX_VOLUME",null),e?Jn.setItem(Je.MAIN_IS_MUTE_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i)):Jn.removeItem(Je.MAIN_IS_MUTE_LOCAL_STORAGE_KEY).catch(i=>console.log(i))}get volume(){return Je.volume}set volume(e){this.isMute=0==e,Je.volume=e,ne.trigger("CHANGE_JUKEBOX_VOLUME",null),.5==Je.volume?Jn.removeItem(Je.MAIN_VOLUME_LOCAL_STORAGE_KEY).catch(i=>console.log(i)):Jn.setItem(Je.MAIN_VOLUME_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i))}get isAuditionMute(){return Je.isAuditionMute}set isAuditionMute(e){Je.isAuditionMute=e,ne.trigger("CHANGE_JUKEBOX_VOLUME",null),e?Jn.setItem(Je.AUDITION_IS_MUTE_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i)):Jn.removeItem(Je.AUDITION_IS_MUTE_LOCAL_STORAGE_KEY).catch(i=>console.log(i))}get auditionVolume(){return Je.auditionVolume}set auditionVolume(e){this.isAuditionMute=0==e,Je.auditionVolume=e,ne.trigger("CHANGE_JUKEBOX_VOLUME",null),.5==Je.auditionVolume?Jn.removeItem(Je.AUDITION_VOLUME_LOCAL_STORAGE_KEY).catch(i=>console.log(i)):Jn.setItem(Je.AUDITION_VOLUME_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i))}get isSoundEffectMute(){return Je.isSoundEffectMute}set isSoundEffectMute(e){Je.isSoundEffectMute=e,e?Jn.setItem(Je.SOUND_EFFECT_IS_MUTE_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i)):Jn.removeItem(Je.SOUND_EFFECT_IS_MUTE_LOCAL_STORAGE_KEY).catch(i=>console.log(i))}get soundEffectVolume(){return Je.soundEffectVolume}set soundEffectVolume(e){this.isSoundEffectMute=0==e,Je.soundEffectVolume=e,.5==Je.soundEffectVolume?Jn.removeItem(Je.SOUND_EFFECT_VOLUME_LOCAL_STORAGE_KEY).catch(i=>console.log(i)):Jn.setItem(Je.SOUND_EFFECT_VOLUME_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i))}get isNoticeMute(){return Je.isNoticeMute}set isNoticeMute(e){Je.isNoticeMute=e,e?Jn.setItem(Je.NOTICE_IS_MUTE_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i)):Jn.removeItem(Je.NOTICE_IS_MUTE_LOCAL_STORAGE_KEY).catch(i=>console.log(i))}get noticeVolume(){return Je.noticeVolume}set noticeVolume(e){this.isNoticeMute=0==e,Je.noticeVolume=e,.5==Je.noticeVolume?Jn.removeItem(Je.NOTICE_VOLUME_LOCAL_STORAGE_KEY).catch(i=>console.log(i)):Jn.setItem(Je.NOTICE_VOLUME_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i))}get audios(){return un.instance.audios.filter(e=>!e.isHidden)}get jukebox(){return bt.instance.get("Jukebox")}get percentVolume(){return Math.floor(100*this.volume)}set percentVolume(e){this.volume=e/100}get percentAuditionVolume(){return Math.floor(100*this.auditionVolume)}set percentAuditionVolume(e){this.auditionVolume=e/100}get percentSoundEffectVolume(){return Math.floor(100*this.soundEffectVolume)}set percentSoundEffectVolume(e){this.soundEffectVolume=e/100}get percentNoticeVolume(){return Math.floor(100*this.noticeVolume)}set percentNoticeVolume(e){this.noticeVolume=e/100}constructor(e,i,r,o){this.modalService=e,this.panelService=i,this.ngZone=r,this.contextMenuService=o,this.auditionPlayer=new Je,this.lazyUpdateTimer=null,this.soundTestPlayer=new Je,this.noticeTestPlayer=new Je,this.soundTestPlayer.volumeType=ec.SOUND_EFFECT,this.noticeTestPlayer.volumeType=ec.NOTICE}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30b8\u30e5\u30fc\u30af\u30dc\u30c3\u30af\u30b9"),this.auditionPlayer.volumeType=ec.AUDITION,ne.register(this).on("*",e=>{e.eventName.startsWith("FILE_")&&this.lazyNgZoneUpdate()})}ngOnDestroy(){ne.unregister(this),this.stop()}play(e){this.auditionPlayer.play(e)}stop(){this.auditionPlayer.stop()}playBGM(e){this.jukebox.play(e.identifier,!0)}stopBGM(e){this.jukebox.audio===e&&this.jukebox.stop()}handleFileSelect(e){let i=e.target,r=i.files;r.length&&zc.instance.load(r),i.value=""}noticeTest(e=Te.puyon){const i=un.instance.get(e);i&&i.isReady&&this.noticeTestPlayer.play(i)}soundTest(e){const i=e.target,r=i.getBoundingClientRect(),o={x:window.pageXOffset+r.left+i.clientWidth,y:window.pageYOffset+r.top};this.contextMenuService.open(o,[{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30fb\u5730\u5f62",subActions:[{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306e\u79fb\u52d5\u958b\u59cb",action:()=>{this.playSETest(Te.piecePick)}},{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u7f6e\u304f",action:()=>{this.playSETest(Te.piecePut)}},{name:"\u5730\u5f62\u306e\u79fb\u52d5\u958b\u59cb\uff0f\u7d42\u4e86",action:()=>{this.playSETest(Te.blockPick)}}]},{name:"\u30c0\u30a4\u30b9\u30fb\u30b3\u30a4\u30f3",subActions:[{name:"\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u3092\u53d6\u308b",action:()=>{this.playSETest(Te.dicePick)}},{name:"\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u3092\u7f6e\u304f",action:()=>{this.playSETest(Te.dicePut)}},{name:"\u30c0\u30a4\u30b9\u3092\u632f\u308b\uff11",action:()=>{this.playSETest(Te.diceRoll1)}},{name:"\u30c0\u30a4\u30b9\u3092\u632f\u308b\uff12",action:()=>{this.playSETest(Te.diceRoll2)}},{name:"\u30b3\u30a4\u30f3\u30c8\u30b9",action:()=>{this.playSETest(Te.coinToss)}}]},{name:"\u30ab\u30fc\u30c9\u30fb\u5c71\u672d",subActions:[{name:"\u30ab\u30fc\u30c9\u3092\u5f15\u304f\uff0f\u88cf\u8fd4\u3059",action:()=>{this.playSETest(Te.cardDraw)}},{name:"\u30ab\u30fc\u30c9\u30fb\u5c71\u672d\u3092\u53d6\u308b",action:()=>{this.playSETest(Te.cardPick)}},{name:"\u30ab\u30fc\u30c9\u30fb\u5c71\u672d\u3092\u7f6e\u304f",action:()=>{this.playSETest(Te.cardPut)}},{name:"\u5c71\u672d\u3092\u30b7\u30e3\u30c3\u30d5\u30eb",action:()=>{this.playSETest(Te.cardShuffle)}}]},{name:"\u305d\u306e\u4ed6",subActions:[{name:"\u56fa\u5b9a\u30fb\u30ed\u30c3\u30af\uff0f\u89e3\u9664",action:()=>{this.playSETest(Te.lock)}},{name:"\u843d\u4e0b\uff0f\u53d6\u308a\u9664\u304f\uff0f\u524a\u9664",action:()=>{this.playSETest(Te.sweep)}},{name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u9078\u629e",action:()=>{this.playSETest(Te.selectionStart)}},{name:"\u5909\u8eab\uff01",action:()=>{this.playSETest(Te.surprise)}}]}],"SE\u30c6\u30b9\u30c8")}playSETest(e){const i=un.instance.get(e);i&&i.isReady?(ne.unregister(this,"UPDATE_AUDIO_RESOURE"),this.isSoundEffectMute||this.soundTestPlayer.play(i)):ne.register(this).on("UPDATE_AUDIO_RESOURE",-100,r=>{this.playSETest(e)})}lazyNgZoneUpdate(){null===this.lazyUpdateTimer&&(this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,this.ngZone.run(()=>{})},100))}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Ei),Y(yi),Y(Pn),Y(Bo))};static#t=this.\u0275cmp=In({type:t,selectors:[["app-jukebox"]],decls:118,vars:22,consts:[[2,"margin-bottom","2px","min-height","4em"],["class","box","style","white-space: nowrap; text-overflow: ellipsis; overflow: hidden",3,"ngClass",4,"ngFor","ngForOf"],["style","padding: 1em 0px; text-align: center",4,"ngIf"],[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","audio/*",2,"display","none",3,"change"],[2,"font-size","12px","margin-top","3px"],[1,"self-only"],[2,"font-size","12px"],[2,"font-size","12px","margin-bottom","8px"],[1,"footer",2,"position","sticky","bottom","0px","padding","2px 0px 0px 3px"],[2,"display","flex"],[2,"flex-basis","auto"],[2,"white-space","nowrap"],[1,"button-mute",3,"click","title"],[1,"material-icons",2,"font-size","22px"],[2,"flex-basis","100%","max-width","250px"],["type","range","min","0","max","1","step","0.01",2,"width","100%",3,"ngModelChange","ngModel","title"],[2,"flex-basis","auto","padding-right","1em"],[2,"white-space","nowrap","padding-left","4px"],["type","number","min","0","max","100","step","1",2,"width","3.2em",3,"ngModelChange","ngModel"],[2,"font-size","smaller","padding-left","3px"],["type","range","min","0","max","1","step","0.01",2,"width","100%",3,"ngModelChange","change","ngModel","title"],["type","number","min","0","max","100","step","1",2,"width","3.2em",3,"change","ngModelChange","ngModel"],[2,"display","flex","justify-content","space-between","padding-bottom","2px"],[2,"font-size","xx-small","font-weight","bolder","margin-right","2em","white-space","nowrap",3,"click"],[1,"self-only",2,"font-size","larger"],[1,"box",2,"white-space","nowrap","text-overflow","ellipsis","overflow","hidden",3,"ngClass"],[3,"disabled","click",4,"ngIf"],["style","padding-left: 2px",4,"ngIf"],[4,"ngIf"],[2,"padding-left","2px"],[3,"click","disabled"],[1,"material-icons"],[1,"material-icons",2,"font-size","16px","vertical-align","middle"],[2,"padding","1em 0px","text-align","center"]],template:function(i,r){1&i&&(p(0,"div",0),q(1,pee,9,12,"div",1)(2,gee,4,0,"div",2),g(),p(3,"label")(4,"span",3)(5,"span")(6,"i",4),y(7,"playlist_add"),g()(),p(8,"span"),y(9,"\u3053\u3053\u306b\u97f3\u697d\u3092\u30c9\u30ed\u30c3\u30d7"),g(),p(10,"span",5),y(11,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),g(),p(12,"input",6),he("change",function(s){return r.handleFileSelect(s)}),g(),p(13,"span",5),Ge(14,"br"),y(15,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d10MB\u307e\u3067"),g()()(),p(16,"div",7),y(17,"\u203b "),p(18,"b"),y(19,"\u8a66\u8074"),p(20,"sup",8),y(21,"*"),g()(),y(22,"\u3001"),p(23,"b"),y(24,"SE\u30c6\u30b9\u30c8"),p(25,"sup",8),y(26,"*"),g()(),y(27," \u306f\u81ea\u5206\u306e\u74b0\u5883\u3067\u97f3\u697d\u30921\u56de\u518d\u751f\u3057\u307e\u3059\u3002"),g(),p(28,"div",9),y(29,"\u203b "),p(30,"b"),y(31,"BGM"),g(),y(32," \u306f\u30eb\u30fc\u30e0\u5185\u306e\u5168\u54e1\u30671\u3064\u306e\u97f3\u697d\u3092\u30eb\u30fc\u30d7\u518d\u751f\u3057\u307e\u3059\u3002"),g(),p(33,"div",10),y(34,"\u203b\u73fe\u884c\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u306b\u306f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u542b\u307e\u308c\u307e\u305b\u3093\u3002\uff08\u6bce\u56de\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u304c\u5fc5\u8981\u3067\u3059\uff09"),g(),p(35,"div",11)(36,"div",12)(37,"div",13)(38,"b",14),y(39,"\u8a66\u8074\u97f3\u91cf"),p(40,"sup",8),y(41,"*"),g(),y(42,"\uff1a"),g()(),p(43,"div",13)(44,"button",15),he("click",function(){return r.isAuditionMute=!r.isAuditionMute}),p(45,"i",16),y(46),g()()(),p(47,"div",17)(48,"input",18),at("ngModelChange",function(s){return it(r.auditionVolume,s)||(r.auditionVolume=s),s}),g()(),p(49,"div",19)(50,"span",20)(51,"input",21),at("ngModelChange",function(s){return it(r.percentAuditionVolume,s)||(r.percentAuditionVolume=s),s}),g(),p(52,"b",22),y(53,"%"),g()()()(),p(54,"div",12)(55,"div",13)(56,"b",14),y(57,"\u518d\u751f\u97f3\u91cf"),p(58,"sup",8),y(59,"*"),g(),y(60,"\uff1a"),g()(),p(61,"div",13)(62,"button",15),he("click",function(){return r.isMute=!r.isMute}),p(63,"i",16),y(64),g()()(),p(65,"div",17)(66,"input",18),at("ngModelChange",function(s){return it(r.volume,s)||(r.volume=s),s}),g()(),p(67,"div",19)(68,"span",20)(69,"input",21),at("ngModelChange",function(s){return it(r.percentVolume,s)||(r.percentVolume=s),s}),g(),p(70,"b",22),y(71,"%"),g()()()(),Ge(72,"hr"),p(73,"div",12)(74,"div",13)(75,"b",14),y(76,"\u901a\u77e5\u97f3\u91cf"),p(77,"sup",8),y(78,"*"),g(),y(79,"\uff1a"),g()(),p(80,"div",13)(81,"button",15),he("click",function(){return r.isNoticeMute=!r.isNoticeMute}),p(82,"i",16),y(83),g()()(),p(84,"div",17)(85,"input",23),at("ngModelChange",function(s){return it(r.noticeVolume,s)||(r.noticeVolume=s),s}),he("change",function(){return r.noticeTest()}),g()(),p(86,"div",19)(87,"span",20)(88,"input",24),he("change",function(){return r.noticeTest()}),at("ngModelChange",function(s){return it(r.percentNoticeVolume,s)||(r.percentNoticeVolume=s),s}),g(),p(89,"b",22),y(90,"%"),g()()()(),p(91,"div",12)(92,"div",13)(93,"b",14),y(94,"\uff33\uff25\u97f3\u91cf"),p(95,"sup",8),y(96,"*"),g(),y(97,"\uff1a"),g()(),p(98,"div",13)(99,"button",15),he("click",function(){return r.isSoundEffectMute=!r.isSoundEffectMute}),p(100,"i",16),y(101),g()()(),p(102,"div",17)(103,"input",18),at("ngModelChange",function(s){return it(r.soundEffectVolume,s)||(r.soundEffectVolume=s),s}),g()(),p(104,"div",19)(105,"span",20)(106,"input",21),at("ngModelChange",function(s){return it(r.percentSoundEffectVolume,s)||(r.percentSoundEffectVolume=s),s}),g(),p(107,"b",22),y(108,"%"),g()()()(),p(109,"div",25)(110,"div")(111,"small"),y(112,"\u203b\u8a2d\u5b9a\u3057\u305f\u97f3\u91cf\u306f\u30d6\u30e9\u30a6\u30b6\u306b\u4fdd\u5b58\u3055\u308c\u307e\u3059\u3002"),g()(),p(113,"div")(114,"button",26),he("click",function(s){return r.soundTest(s)}),y(115,"\uff33\uff25\u30c6\u30b9\u30c8"),p(116,"sup",27),y(117,"*"),g()()()()()),2&i&&(h(),m("ngForOf",r.audios),h(),m("ngIf",r.audios.length<1),h(42),m("title",r.isAuditionMute?"\u30df\u30e5\u30fc\u30c8\u89e3\u9664":"\u30df\u30e5\u30fc\u30c8"),h(2),Xe(r.isAuditionMute?"volume_off":0==r.auditionVolume?"volume_mute":r.auditionVolume<=.5?"volume_down":"volume_up"),h(2),st("ngModel",r.auditionVolume),m("title",r.isAuditionMute?"":r.percentAuditionVolume+"%"),h(3),st("ngModel",r.percentAuditionVolume),h(11),m("title",r.isMute?"\u30df\u30e5\u30fc\u30c8\u89e3\u9664":"\u30df\u30e5\u30fc\u30c8"),h(2),Xe(r.isMute?"volume_off":0==r.volume?"volume_mute":r.volume<=.5?"volume_down":"volume_up"),h(2),st("ngModel",r.volume),m("title",r.isMute?"":r.percentVolume+"%"),h(3),st("ngModel",r.percentVolume),h(12),m("title",r.isNoticeMute?"\u30df\u30e5\u30fc\u30c8\u89e3\u9664":"\u30df\u30e5\u30fc\u30c8"),h(2),Xe(r.isNoticeMute?"volume_off":0==r.noticeVolume?"volume_mute":r.noticeVolume<=.5?"volume_down":"volume_up"),h(2),st("ngModel",r.noticeVolume),m("title",r.isNoticeMute?"":r.percentNoticeVolume+"%"),h(3),st("ngModel",r.percentNoticeVolume),h(11),m("title",r.isSoundEffectMute?"\u30df\u30e5\u30fc\u30c8\u89e3\u9664":"\u30df\u30e5\u30fc\u30c8"),h(2),Xe(r.isSoundEffectMute?"volume_off":0==r.soundEffectVolume?"volume_mute":r.soundEffectVolume<=.5?"volume_down":"volume_up"),h(2),st("ngModel",r.soundEffectVolume),m("title",r.isSoundEffectMute?"":r.percentSoundEffectVolume+"%"),h(3),st("ngModel",r.percentSoundEffectVolume))},dependencies:[Ni,nr,ri,kr,yl,Cl,Or,ku,Du,Cr],styles:['[_nghost-%COMP%]{display:block;height:100%}.drop-zone[_ngcontent-%COMP%]{display:block;-webkit-user-select:none;user-select:none;border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer}.drop-zone[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.box[_ngcontent-%COMP%]{font-size:smaller;border-bottom:1px dotted #888;vertical-align:baseline}.box.last[_ngcontent-%COMP%]{border-bottom:0px none transparent}.volume[_ngcontent-%COMP%]{display:inline-block;width:3em;text-align:right}input[type=number][_ngcontent-%COMP%]{text-align:right}.self-only[_ngcontent-%COMP%]{color:red}button[_ngcontent-%COMP%]   .self-only[_ngcontent-%COMP%]{vertical-align:text-top}.box[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:12px;height:26px;width:5.6em;margin-left:0;margin-right:0}button[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:12px}.footer[_ngcontent-%COMP%]{background:linear-gradient(-30deg,#f0dabde6,#fff4e8e6);border-top:dotted 1px #888}.button-mute[_ngcontent-%COMP%]{box-sizing:border-box;width:25px;height:25px;padding:1px;display:inline-block;background-color:transparent;border-color:transparent}.button-mute[_ngcontent-%COMP%]:hover, .button-mute[_ngcontent-%COMP%]:active, .button-mute[_ngcontent-%COMP%]::selection{background-color:#666;border-color:#ccc;color:snow}']})}return t})();const _ee=["content"],bee=["*"];let vee=(()=>{class t{constructor(e){this.modalService=e}clickBackground(e){e.target===e.currentTarget&&this.resolve()}resolve(){this.modalService.resolve(null)}reject(){this.modalService.reject()}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Ei))};static#t=this.\u0275cmp=In({type:t,selectors:[["modal"]],viewQuery:function(i,r){if(1&i&&Ln(_ee,7,xa),2&i){let o;Bn(o=Un())&&(r.content=o.first)}},ngContentSelectors:bee,decls:13,vars:3,consts:[["content",""],[1,"component"],[1,"modal-background",3,"click"],[1,"modal-panel"],[1,"title"],[1,"title-button"],[3,"click"],[1,"material-icons",2,"font-size","14px"],[1,"scrollable-panel"]],template:function(i,r){if(1&i){const o=Le();h2(),p(0,"div",1)(1,"div",2),he("click",function(a){return V(o),H(r.clickBackground(a))}),g(),p(2,"div",3)(3,"div",4)(4,"div",5)(5,"button",6),he("click",function(){return V(o),H(r.resolve())}),p(6,"i",7),y(7,"close"),g()()(),y(8),g(),p(9,"div",8),f2(10),Ge(11,"div",null,0),g()()()}2&i&&(h(),m("@bgInOut","in"),h(),m("@flyInOut","in"),h(6),Si(" ",r.modalService.title," "))},styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;inset:0;z-index:1899999;display:flex;align-items:center;justify-content:center;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.modal-background[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;color:#ccc;background-color:#1e1e1e4d;inset:0;z-index:-1}.modal-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:hidden;color:#444;background:linear-gradient(-30deg,#f0dabde6,#fff4e8e6);border:solid 1px #999;height:auto;max-height:calc(100% - 10px);width:800px;max-width:100%}.title[_ngcontent-%COMP%]{position:relative;overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;padding:2px 5px;width:100%;background-color:#ccc;color:#444}.title-button[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#444}.header[_ngcontent-%COMP%], .content[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]{padding:10px}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;max-height:calc(100vh - 41px);width:100%;padding:8px}"],data:{animation:[Xn("flyInOut",[an("void => *",[rn("100ms ease-out",En([We({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),We({transform:"scale(1.0, 1.0)",opacity:"1.0",offset:1})]))]),an("* => void",[rn(100,We({transform:"scale(0, 0)"}))])]),Xn("bgInOut",[RI("in",We({"background-color":"rgba(30, 30, 30, 0.4)"})),an("void => *",[We({"background-color":"rgba(30, 30, 30, 0.0)"}),rn(200)]),an("* => void",[rn(200,We({"background-color":"rgba(30, 30, 30, 0.0)"}))])])]}})}return t})();const yee=["passwordInput"],Cee=()=>({standalone:!0});let xee=(()=>{class t{get peerId(){return jt.peerId}get isConnected(){return 0<jt.peerIds.length}constructor(e,i){this.panelService=e,this.modalService=i,this.password="",this.help="",this.targetPeers=[],this.title="",this.targetPeers=i.option.peers??[],this.title=i.option.title?i.option.title:""}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title=`\u30d1\u30b9\u30ef\u30fc\u30c9\u3008${this.title}\u3009`),ne.register(this)}ngAfterViewInit(){this.passwordInputElementRef.nativeElement.focus()}ngOnDestroy(){ne.unregister(this)}onInputChange(e){this.help=""}submit(){this.targetPeers.find(e=>e.verifyPassword(this.password))&&this.modalService.resolve(this.password),this.help="\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u9055\u3044\u307e\u3059"}static#e=this.\u0275fac=function(i){return new(i||t)(Y(yi),Y(Ei))};static#t=this.\u0275cmp=In({type:t,selectors:[["password-check"]],viewQuery:function(i,r){if(1&i&&Ln(yee,7),2&i){let o;Bn(o=Un())&&(r.passwordInputElementRef=o.first)}},decls:12,vars:4,consts:[["passwordForm","ngForm"],["input","","passwordInput",""],["placeholder","\u30d1\u30b9\u30ef\u30fc\u30c9",3,"ngModelChange","input","keypress.enter","ngModel","ngModelOptions"],["type","submit",3,"click"],[2,"font-size","12px"]],template:function(i,r){if(1&i){const o=Le();p(0,"form",null,0)(2,"div"),y(3,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),p(4,"input",2,1),at("ngModelChange",function(a){return V(o),it(r.password,a)||(r.password=a),H(a)}),he("input",function(){V(o);const a=pn(5);return H(r.onInputChange(a.value))})("keypress.enter",function(){return V(o),H(r.submit())}),g()(),p(7,"button",3),he("click",function(){return V(o),H(r.submit())}),y(8,"\u5165\u5ba4"),g()(),p(9,"div")(10,"span",4),y(11),g()()}2&i&&(h(4),st("ngModel",r.password),m("ngModelOptions",wu(3,Cee)),h(7),Xe(r.help))},dependencies:[ff,kr,Or,hf,Cr,Mu],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}"]})}return t})();function wee(t,n){if(1&t&&(p(0,"div")(1,"div",9),y(2," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),g(),p(3,"div",9),y(4," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),g(),p(5,"div",9),y(6," \u30eb\u30fc\u30e0\u540d\u524d\u306e\u9577\u3055\u306f128\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),g()()),2&t){v();const e=pn(5);h(),m("hidden",!e.errors.required),h(2),m("hidden",!e.errors.minlength),h(2),m("hidden",!e.errors.maxlength)}}function Eee(t,n){if(1&t&&(p(0,"div")(1,"div",9),y(2," \u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u306f12\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),g()()),2&t){v();const e=pn(10);h(),m("hidden",!e.errors.maxlength)}}function Iee(t,n){1&t&&(p(0,"div"),y(1," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5408\u8a08\u304c\u9577\u3059\u304e\u308b\u3088\u3046\u3067\u3059\u3002\u3069\u3061\u3089\u304b\u3092\u5c11\u3057\u77ed\u304f\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002 "),g())}function Tee(t,n){if(1&t){const e=Le();p(0,"div")(1,"div"),y(2,"\u30eb\u30fc\u30e0\u540d : "),p(3,"input",5,1),he("input",function(){V(e);const r=pn(4),o=v();return H(o.calcPeerId(r.value,o.password))}),at("ngModelChange",function(r){V(e);const o=v();return it(o.roomName,r)||(o.roomName=r),H(r)}),g()(),p(6,"div"),y(7,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),p(8,"input",6,2),he("input",function(){V(e);const r=pn(4),o=v();return H(o.calcPeerId(o.roomName,r.value))}),at("ngModelChange",function(r){V(e);const o=v();return it(o.password,r)||(o.password=r),H(r)}),g()(),Ge(11,"hr"),q(12,wee,7,3,"div",7)(13,Eee,3,1,"div",7)(14,Iee,2,0,"div",7),p(15,"div")(16,"button",8),he("click",function(){return V(e),H(v().createRoom())}),y(17,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210"),g()()()}if(2&t){const e=pn(5),i=pn(10),r=v();h(3),st("ngModel",r.roomName),h(5),st("ngModel",r.password),h(4),m("ngIf",e.errors&&(e.dirty||e.touched)),h(),m("ngIf",i.errors&&(i.dirty||i.touched)),h(),m("ngIf",!r.validateLength),h(2),m("disabled",!e.valid||!i.valid||!r.validateLength)}}function See(t,n){1&t&&(p(0,"span",4),y(1,"\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u63a5\u7d9a\u3057\u305f\u307e\u307e\u3067\u306f\u30eb\u30fc\u30e0\u4f5c\u6210\u3092\u884c\u3048\u307e\u305b\u3093\u3002"),Ge(2,"br"),y(3,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),Ge(4,"br"),y(5,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),g())}let Mee=(()=>{class t{get peerId(){return jt.peerId}get isConnected(){return 0<jt.peerIds.length}constructor(e,i){this.panelService=e,this.modalService=i,this.peers=[],this.isReloading=!1,this.roomName="\u3075\u3064\u3046\u306e\u90e8\u5c4b",this.password="",this.isPrivate=!1,this.validateLength=!1}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30eb\u30fc\u30e0\u4f5c\u6210"),ne.register(this),this.calcPeerId(this.roomName,this.password)}ngOnDestroy(){ne.unregister(this)}calcPeerId(e,i){let o=Ar.create(jt.peer.userId,Ar.generateId("***"),e,i);this.validateLength=o.peerId.length<64}createRoom(){jt.open(jt.peer.userId,Ar.generateId("***"),this.roomName,this.password),Fe.myCursor.peerId=jt.peerId,this.modalService.resolve()}static#e=this.\u0275fac=function(i){return new(i||t)(Y(yi),Y(Ei))};static#t=this.\u0275cmp=In({type:t,selectors:[["room-setting"]],decls:6,vars:2,consts:[["other_content",""],["input","","roomNameValidation","ngModel"],["input","","passwordValidation","ngModel"],[4,"ngIf","ngIfElse"],[2,"font-size","12px"],["required","","minlength","1","maxlength","128","placeholder","\u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808",1,"input",3,"input","ngModelChange","ngModel"],["maxlength","12","placeholder","\u7a7a\u306a\u3089\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u3057",1,"input",3,"input","ngModelChange","ngModel"],[4,"ngIf"],[3,"click","disabled"],[3,"hidden"]],template:function(i,r){if(1&i&&(q(0,Tee,18,6,"div",3),p(1,"div")(2,"span",4),y(3,"\u203b\u4f5c\u6210\u3057\u305f\u30eb\u30fc\u30e0\u306f\u53c2\u52a0\u8005\u304c0\u4eba\u306b\u306a\u3063\u305f\u6642\u70b9\u3067\u89e3\u6563\u3057\u307e\u3059\u3002\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),g()(),q(4,See,6,0,"ng-template",null,0,Ai)),2&i){const o=pn(5);m("ngIf",!r.isConnected)("ngIfElse",o)}},dependencies:[ri,kr,Or,Hy,FI,NI,Cr],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.input[_ngcontent-%COMP%]{width:100%}"]})}return t})();function Dee(t,n){1&t&&(p(0,"td")(1,"i",11),y(2,"lock"),g()())}function kee(t,n){1&t&&(p(0,"td"),y(1,"-"),g())}function Oee(t,n){if(1&t){const e=Le();p(0,"button",12),he("click",function(){V(e);const r=v().$implicit;return H(v(3).connect(r))}),y(1,"\u63a5\u7d9a"),g()}if(2&t){const e=v().$implicit,i=v(3);m("disabled",e.id===i.currentRoom)}}function Aee(t,n){if(1&t&&(Ue(0),p(1,"tr")(2,"td",9),y(3),g(),p(4,"td",7),y(5),g(),q(6,Dee,3,0,"td",4)(7,kee,2,0,"td",4),p(8,"td"),y(9),g(),p(10,"td"),q(11,Oee,2,1,"button",10),g()(),ze()),2&t){const e=n.$implicit;h(3),Xe(e.id),h(2),Xe(e.name),h(),m("ngIf",e.hasPassword),h(),m("ngIf",!e.hasPassword),h(2),Si("",e.peers.length,"\u4eba"),h(2),m("ngIf",0<e.id.length)}}function Pee(t,n){if(1&t&&(Ue(0),p(1,"table",6)(2,"tr")(3,"th"),y(4,"\u30eb\u30fc\u30e0ID"),g(),p(5,"th",7),y(6,"\u30eb\u30fc\u30e0\u540d"),g(),p(7,"th"),y(8,"\u30d1\u30b9\u30ef\u30fc\u30c9"),g(),p(9,"th"),y(10,"\u53c2\u52a0\u8005"),g(),Ge(11,"th"),g(),q(12,Aee,12,6,"ng-container",8),g(),ze()),2&t){const e=v(2);h(12),m("ngForOf",e.rooms)}}function Fee(t,n){if(1&t&&(p(0,"span",13),y(1),g()),2&t){const e=v(2);h(),Xe(e.help)}}function Nee(t,n){if(1&t){const e=Le();p(0,"div")(1,"button",2),he("click",function(){return V(e),H(v().reload())}),y(2,"\u4e00\u89a7\u3092\u66f4\u65b0"),g(),p(3,"button",3),he("click",function(){return V(e),H(v().showRoomSetting())}),y(4,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b"),g(),Ge(5,"hr"),q(6,Pee,13,1,"ng-container",4)(7,Fee,2,1,"span",5),g()}if(2&t){const e=v();h(),m("disabled",e.isReloading),h(5),m("ngIf",e.rooms.length),h(),m("ngIf",e.rooms.length<1)}}function Ree(t,n){1&t&&(p(0,"span",13),y(1,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),Ge(2,"br"),y(3,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),g())}let Lee=(()=>{class t{get currentRoom(){return jt.peer.roomId}get peerId(){return jt.peerId}get isConnected(){return 0<jt.peerIds.length}constructor(e,i){this.panelService=e,this.modalService=i,this.rooms=[],this.isReloading=!1,this.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"}ngOnInit(){Promise.resolve().then(()=>this.changeTitle()),ne.register(this).on("OPEN_NETWORK",e=>{this.changeTitle()}).on("CONNECT_PEER",e=>{this.changeTitle()}),this.reload()}changeTitle(){this.modalService.title=this.panelService.title="\u30ed\u30d3\u30fc",jt.peer.roomName.length&&(this.modalService.title=this.panelService.title="\u3008"+jt.peer.roomName+"/"+jt.peer.roomId+"\u3009")}ngOnDestroy(){ne.unregister(this)}reload(){var e=this;return(0,L.A)(function*(){e.isReloading=!0,e.help="\u691c\u7d22\u4e2d...",e.rooms=yield jt.listAllRooms(),e.help="\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u300c\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b\u300d\u3067\u65b0\u898f\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002",e.isReloading=!1})()}connect(e){var i=this;return(0,L.A)(function*(){let r="";e.hasPassword&&(r=yield i.modalService.open(xee,{peers:e.peers,title:`${e.name}/${e.id}`}),null==r&&(r=""));let o=e.filterByPassword(r);if(o.length<1)return;jt.open(jt.peer.userId,e.id,e.name,r),Fe.myCursor.peerId=jt.peerId;let a=[],c=()=>!(a.length<o.length||(i.resetNetwork(),ne.unregister(a),i.closeIfConnected(),0)),f=b=>(console.warn("\u63a5\u7d9a\u5931\u6557",b),a.push(b),console.warn("\u63a5\u7d9a\u5931\u6557 "+a.length+"/"+o.length),c());ne.register(a).on("OPEN_NETWORK",b=>{console.log("LobbyComponent OPEN_PEER",b.data.peerId),ne.unregister(a),bt.instance.clearDeleteHistory();for(let C of o)if(!jt.connect(C)&&f(C.peerId))return;ne.register(a).on("CONNECT_PEER",C=>(b=>(console.log("\u63a5\u7d9a\u6210\u529f\uff01",b),a.push(b),console.log("\u63a5\u7d9a\u6210\u529f "+a.length+"/"+o.length),c()))(C.data.peerId)).on("DISCONNECT_PEER",C=>f(C.data.peerId))})})()}resetNetwork(){jt.peers.length<1&&(jt.open(),Fe.myCursor.peerId=jt.peerId)}closeIfConnected(){0<jt.peers.length&&this.modalService.resolve()}showRoomSetting(){var e=this;return(0,L.A)(function*(){yield e.modalService.open(Mee,{width:700,height:400,left:0,top:400}),e.modalService.resolve(),e.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"})()}static#e=this.\u0275fac=function(i){return new(i||t)(Y(yi),Y(Ei))};static#t=this.\u0275cmp=In({type:t,selectors:[["lobby"]],decls:3,vars:2,consts:[["other_content",""],[4,"ngIf","ngIfElse"],[3,"click","disabled"],[3,"click"],[4,"ngIf"],["style","font-size: 12px;",4,"ngIf"],[1,"room-list"],[1,"room-name"],[4,"ngFor","ngForOf"],[1,"is-small-font"],["type","submit",3,"disabled","click",4,"ngIf"],[1,"material-icons",2,"vertical-align","middle","font-size","0.9rem"],["type","submit",3,"click","disabled"],[2,"font-size","12px"]],template:function(i,r){if(1&i&&q(0,Nee,8,3,"div",1)(1,Ree,4,0,"ng-template",null,0,Ai),2&i){const o=pn(2);m("ngIf",!r.isConnected)("ngIfElse",o)}},dependencies:[nr,ri],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.room-list[_ngcontent-%COMP%]{font-size:12px;border:0;border-spacing:0;padding:0;width:100%;max-width:100%;white-space:nowrap}.room-list[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:1px .5em;text-align:center}.room-name[_ngcontent-%COMP%]{white-space:normal;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;min-width:50%}.is-small-font[_ngcontent-%COMP%]{font-size:10px}"]})}return t})();function m4(t){return typeof t>"u"||null===t}var Vo={isNothing:m4,isObject:function Bee(t){return"object"==typeof t&&null!==t},toArray:function Uee(t){return Array.isArray(t)?t:m4(t)?[]:[t]},repeat:function Hee(t,n){var i,e="";for(i=0;i<n;i+=1)e+=t;return e},isNegativeZero:function Vee(t){return 0===t&&Number.NEGATIVE_INFINITY===1/t},extend:function zee(t,n){var e,i,r,o;if(n)for(e=0,i=(o=Object.keys(n)).length;e<i;e+=1)t[r=o[e]]=n[r];return t}};function _4(t,n){var e="",i=t.reason||"(unknown reason)";return t.mark?(t.mark.name&&(e+='in "'+t.mark.name+'" '),e+="("+(t.mark.line+1)+":"+(t.mark.column+1)+")",!n&&t.mark.snippet&&(e+="\n\n"+t.mark.snippet),i+" "+e):i}function mb(t,n){Error.call(this),this.name="YAMLException",this.reason=t,this.mark=n,this.message=_4(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}(mb.prototype=Object.create(Error.prototype)).constructor=mb,mb.prototype.toString=function(n){return this.name+": "+_4(this,n)};var aa=mb;function uS(t,n,e,i,r){var o="",s="",a=Math.floor(r/2)-1;return i-n>a&&(n=i-a+(o=" ... ").length),e-i>a&&(e=i+a-(s=" ...").length),{str:o+t.slice(n,e).replace(/\t/g,"\u2192")+s,pos:i-n+o.length}}function dS(t,n){return Vo.repeat(" ",n-t.length)+t}var Xee=function qee(t,n){if(n=Object.create(n||null),!t.buffer)return null;n.maxLength||(n.maxLength=79),"number"!=typeof n.indent&&(n.indent=1),"number"!=typeof n.linesBefore&&(n.linesBefore=3),"number"!=typeof n.linesAfter&&(n.linesAfter=2);for(var o,e=/\r?\n|\r|\0/g,i=[0],r=[],s=-1;o=e.exec(t.buffer);)r.push(o.index),i.push(o.index+o[0].length),t.position<=o.index&&s<0&&(s=i.length-2);s<0&&(s=i.length-1);var c,u,a="",f=Math.min(t.line+n.linesAfter,r.length).toString().length,b=n.maxLength-(n.indent+f+3);for(c=1;c<=n.linesBefore&&!(s-c<0);c++)u=uS(t.buffer,i[s-c],r[s-c],t.position-(i[s]-i[s-c]),b),a=Vo.repeat(" ",n.indent)+dS((t.line-c+1).toString(),f)+" | "+u.str+"\n"+a;for(u=uS(t.buffer,i[s],r[s],t.position,b),a+=Vo.repeat(" ",n.indent)+dS((t.line+1).toString(),f)+" | "+u.str+"\n",a+=Vo.repeat("-",n.indent+f+3+u.pos)+"^\n",c=1;c<=n.linesAfter&&!(s+c>=r.length);c++)u=uS(t.buffer,i[s+c],r[s+c],t.position-(i[s]-i[s+c]),b),a+=Vo.repeat(" ",n.indent)+dS((t.line+c+1).toString(),f)+" | "+u.str+"\n";return a.replace(/\n$/,"")},Kee=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],Qee=["scalar","sequence","mapping"],ys=function ete(t,n){if(n=n||{},Object.keys(n).forEach(function(e){if(-1===Kee.indexOf(e))throw new aa('Unknown option "'+e+'" is met in definition of "'+t+'" YAML type.')}),this.options=n,this.tag=t,this.kind=n.kind||null,this.resolve=n.resolve||function(){return!0},this.construct=n.construct||function(e){return e},this.instanceOf=n.instanceOf||null,this.predicate=n.predicate||null,this.represent=n.represent||null,this.representName=n.representName||null,this.defaultStyle=n.defaultStyle||null,this.multi=n.multi||!1,this.styleAliases=function Jee(t){var n={};return null!==t&&Object.keys(t).forEach(function(e){t[e].forEach(function(i){n[String(i)]=e})}),n}(n.styleAliases||null),-1===Qee.indexOf(this.kind))throw new aa('Unknown kind "'+this.kind+'" is specified for "'+t+'" YAML type.')};function b4(t,n){var e=[];return t[n].forEach(function(i){var r=e.length;e.forEach(function(o,s){o.tag===i.tag&&o.kind===i.kind&&o.multi===i.multi&&(r=s)}),e[r]=i}),e}function hS(t){return this.extend(t)}hS.prototype.extend=function(n){var e=[],i=[];if(n instanceof ys)i.push(n);else if(Array.isArray(n))i=i.concat(n);else{if(!n||!Array.isArray(n.implicit)&&!Array.isArray(n.explicit))throw new aa("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");n.implicit&&(e=e.concat(n.implicit)),n.explicit&&(i=i.concat(n.explicit))}e.forEach(function(o){if(!(o instanceof ys))throw new aa("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(o.loadKind&&"scalar"!==o.loadKind)throw new aa("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(o.multi)throw new aa("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),i.forEach(function(o){if(!(o instanceof ys))throw new aa("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var r=Object.create(hS.prototype);return r.implicit=(this.implicit||[]).concat(e),r.explicit=(this.explicit||[]).concat(i),r.compiledImplicit=b4(r,"implicit"),r.compiledExplicit=b4(r,"explicit"),r.compiledTypeMap=function tte(){var n,e,t={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function i(r){r.multi?(t.multi[r.kind].push(r),t.multi.fallback.push(r)):t[r.kind][r.tag]=t.fallback[r.tag]=r}for(n=0,e=arguments.length;n<e;n+=1)arguments[n].forEach(i);return t}(r.compiledImplicit,r.compiledExplicit),r};var v4=hS,y4=new ys("tag:yaml.org,2002:str",{kind:"scalar",construct:function(t){return null!==t?t:""}}),C4=new ys("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(t){return null!==t?t:[]}}),x4=new ys("tag:yaml.org,2002:map",{kind:"mapping",construct:function(t){return null!==t?t:{}}}),w4=new v4({explicit:[y4,C4,x4]}),E4=new ys("tag:yaml.org,2002:null",{kind:"scalar",resolve:function nte(t){if(null===t)return!0;var n=t.length;return 1===n&&"~"===t||4===n&&("null"===t||"Null"===t||"NULL"===t)},construct:function ite(){return null},predicate:function rte(t){return null===t},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"}),I4=new ys("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function ote(t){if(null===t)return!1;var n=t.length;return 4===n&&("true"===t||"True"===t||"TRUE"===t)||5===n&&("false"===t||"False"===t||"FALSE"===t)},construct:function ste(t){return"true"===t||"True"===t||"TRUE"===t},predicate:function ate(t){return"[object Boolean]"===Object.prototype.toString.call(t)},represent:{lowercase:function(t){return t?"true":"false"},uppercase:function(t){return t?"TRUE":"FALSE"},camelcase:function(t){return t?"True":"False"}},defaultStyle:"lowercase"});function lte(t){return 48<=t&&t<=57||65<=t&&t<=70||97<=t&&t<=102}function cte(t){return 48<=t&&t<=55}function ute(t){return 48<=t&&t<=57}var T4=new ys("tag:yaml.org,2002:int",{kind:"scalar",resolve:function dte(t){if(null===t)return!1;var r,n=t.length,e=0,i=!1;if(!n)return!1;if(("-"===(r=t[e])||"+"===r)&&(r=t[++e]),"0"===r){if(e+1===n)return!0;if("b"===(r=t[++e])){for(e++;e<n;e++)if("_"!==(r=t[e])){if("0"!==r&&"1"!==r)return!1;i=!0}return i&&"_"!==r}if("x"===r){for(e++;e<n;e++)if("_"!==(r=t[e])){if(!lte(t.charCodeAt(e)))return!1;i=!0}return i&&"_"!==r}if("o"===r){for(e++;e<n;e++)if("_"!==(r=t[e])){if(!cte(t.charCodeAt(e)))return!1;i=!0}return i&&"_"!==r}}if("_"===r)return!1;for(;e<n;e++)if("_"!==(r=t[e])){if(!ute(t.charCodeAt(e)))return!1;i=!0}return!(!i||"_"===r)},construct:function hte(t){var i,n=t,e=1;if(-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),("-"===(i=n[0])||"+"===i)&&("-"===i&&(e=-1),i=(n=n.slice(1))[0]),"0"===n)return 0;if("0"===i){if("b"===n[1])return e*parseInt(n.slice(2),2);if("x"===n[1])return e*parseInt(n.slice(2),16);if("o"===n[1])return e*parseInt(n.slice(2),8)}return e*parseInt(n,10)},predicate:function fte(t){return"[object Number]"===Object.prototype.toString.call(t)&&t%1==0&&!Vo.isNegativeZero(t)},represent:{binary:function(t){return t>=0?"0b"+t.toString(2):"-0b"+t.toString(2).slice(1)},octal:function(t){return t>=0?"0o"+t.toString(8):"-0o"+t.toString(8).slice(1)},decimal:function(t){return t.toString(10)},hexadecimal:function(t){return t>=0?"0x"+t.toString(16).toUpperCase():"-0x"+t.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),pte=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),_te=/^[-+]?[0-9]+e/,S4=new ys("tag:yaml.org,2002:float",{kind:"scalar",resolve:function gte(t){return!(null===t||!pte.test(t)||"_"===t[t.length-1])},construct:function mte(t){var n,e;return e="-"===(n=t.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(n[0])>=0&&(n=n.slice(1)),".inf"===n?1===e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===n?NaN:e*parseFloat(n,10)},predicate:function vte(t){return"[object Number]"===Object.prototype.toString.call(t)&&(t%1!=0||Vo.isNegativeZero(t))},represent:function bte(t,n){var e;if(isNaN(t))switch(n){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===t)switch(n){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===t)switch(n){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(Vo.isNegativeZero(t))return"-0.0";return e=t.toString(10),_te.test(e)?e.replace("e",".e"):e},defaultStyle:"lowercase"}),D4=w4.extend({implicit:[E4,I4,T4,S4]}),k4=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),O4=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$"),A4=new ys("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function yte(t){return null!==t&&(null!==k4.exec(t)||null!==O4.exec(t))},construct:function Cte(t){var n,e,i,r,o,s,a,C,c=0,u=null;if(null===(n=k4.exec(t))&&(n=O4.exec(t)),null===n)throw new Error("Date resolve error");if(e=+n[1],i=+n[2]-1,r=+n[3],!n[4])return new Date(Date.UTC(e,i,r));if(o=+n[4],s=+n[5],a=+n[6],n[7]){for(c=n[7].slice(0,3);c.length<3;)c+="0";c=+c}return n[9]&&(u=6e4*(60*+n[10]+ +(n[11]||0)),"-"===n[9]&&(u=-u)),C=new Date(Date.UTC(e,i,r,o,s,a,c)),u&&C.setTime(C.getTime()-u),C},instanceOf:Date,represent:function xte(t){return t.toISOString()}}),P4=new ys("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function wte(t){return"<<"===t||null===t}}),fS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r",F4=new ys("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function Ete(t){if(null===t)return!1;var n,e,i=0,r=t.length,o=fS;for(e=0;e<r;e++)if(!((n=o.indexOf(t.charAt(e)))>64)){if(n<0)return!1;i+=6}return i%8==0},construct:function Ite(t){var n,e,i=t.replace(/[\r\n=]/g,""),r=i.length,o=fS,s=0,a=[];for(n=0;n<r;n++)n%4==0&&n&&(a.push(s>>16&255),a.push(s>>8&255),a.push(255&s)),s=s<<6|o.indexOf(i.charAt(n));return 0==(e=r%4*6)?(a.push(s>>16&255),a.push(s>>8&255),a.push(255&s)):18===e?(a.push(s>>10&255),a.push(s>>2&255)):12===e&&a.push(s>>4&255),new Uint8Array(a)},predicate:function Ste(t){return"[object Uint8Array]"===Object.prototype.toString.call(t)},represent:function Tte(t){var i,r,n="",e=0,o=t.length,s=fS;for(i=0;i<o;i++)i%3==0&&i&&(n+=s[e>>18&63],n+=s[e>>12&63],n+=s[e>>6&63],n+=s[63&e]),e=(e<<8)+t[i];return 0==(r=o%3)?(n+=s[e>>18&63],n+=s[e>>12&63],n+=s[e>>6&63],n+=s[63&e]):2===r?(n+=s[e>>10&63],n+=s[e>>4&63],n+=s[e<<2&63],n+=s[64]):1===r&&(n+=s[e>>2&63],n+=s[e<<4&63],n+=s[64],n+=s[64]),n}}),Mte=Object.prototype.hasOwnProperty,Dte=Object.prototype.toString,N4=new ys("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function kte(t){if(null===t)return!0;var e,i,r,o,s,n=[],a=t;for(e=0,i=a.length;e<i;e+=1){if(s=!1,"[object Object]"!==Dte.call(r=a[e]))return!1;for(o in r)if(Mte.call(r,o)){if(s)return!1;s=!0}if(!s)return!1;if(-1!==n.indexOf(o))return!1;n.push(o)}return!0},construct:function Ote(t){return null!==t?t:[]}}),Ate=Object.prototype.toString,R4=new ys("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function Pte(t){if(null===t)return!0;var n,e,i,r,o,s=t;for(o=new Array(s.length),n=0,e=s.length;n<e;n+=1){if("[object Object]"!==Ate.call(i=s[n])||1!==(r=Object.keys(i)).length)return!1;o[n]=[r[0],i[r[0]]]}return!0},construct:function Fte(t){if(null===t)return[];var n,e,i,r,o,s=t;for(o=new Array(s.length),n=0,e=s.length;n<e;n+=1)i=s[n],r=Object.keys(i),o[n]=[r[0],i[r[0]]];return o}}),Nte=Object.prototype.hasOwnProperty,L4=new ys("tag:yaml.org,2002:set",{kind:"mapping",resolve:function Rte(t){if(null===t)return!0;var n,e=t;for(n in e)if(Nte.call(e,n)&&null!==e[n])return!1;return!0},construct:function Lte(t){return null!==t?t:{}}}),pS=D4.extend({implicit:[A4,P4],explicit:[F4,N4,R4,L4]}),sh=Object.prototype.hasOwnProperty,AC=1,B4=2,U4=3,PC=4,gS=1,Bte=2,z4=3,Ute=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,zte=/[\x85\u2028\u2029]/,Hte=/[,\[\]\{\}]/,H4=/^(?:!|!!|![a-z\-]+!)$/i,V4=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function j4(t){return Object.prototype.toString.call(t)}function Gc(t){return 10===t||13===t}function Uf(t){return 9===t||32===t}function Ma(t){return 9===t||32===t||10===t||13===t}function nm(t){return 44===t||91===t||93===t||123===t||125===t}function Vte(t){var n;return 48<=t&&t<=57?t-48:97<=(n=32|t)&&n<=102?n-97+10:-1}function jte(t){return 120===t?2:117===t?4:85===t?8:0}function Gte(t){return 48<=t&&t<=57?t-48:-1}function G4(t){return 48===t?"\0":97===t?"\x07":98===t?"\b":116===t||9===t?"\t":110===t?"\n":118===t?"\v":102===t?"\f":114===t?"\r":101===t?"\x1b":32===t?" ":34===t?'"':47===t?"/":92===t?"\\":78===t?"\x85":95===t?"\xa0":76===t?"\u2028":80===t?"\u2029":""}function Wte(t){return t<=65535?String.fromCharCode(t):String.fromCharCode(55296+(t-65536>>10),56320+(t-65536&1023))}for(var W4=new Array(256),$4=new Array(256),im=0;im<256;im++)W4[im]=G4(im)?1:0,$4[im]=G4(im);function $te(t,n){this.input=t,this.filename=n.filename||null,this.schema=n.schema||pS,this.onWarning=n.onWarning||null,this.legacy=n.legacy||!1,this.json=n.json||!1,this.listener=n.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=t.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function Y4(t,n){var e={name:t.filename,buffer:t.input.slice(0,-1),position:t.position,line:t.line,column:t.position-t.lineStart};return e.snippet=Xee(e),new aa(n,e)}function wn(t,n){throw Y4(t,n)}function FC(t,n){t.onWarning&&t.onWarning.call(null,Y4(t,n))}var Z4={YAML:function(n,e,i){var r,o,s;null!==n.version&&wn(n,"duplication of %YAML directive"),1!==i.length&&wn(n,"YAML directive accepts exactly one argument"),null===(r=/^([0-9]+)\.([0-9]+)$/.exec(i[0]))&&wn(n,"ill-formed argument of the YAML directive"),o=parseInt(r[1],10),s=parseInt(r[2],10),1!==o&&wn(n,"unacceptable YAML version of the document"),n.version=i[0],n.checkLineBreaks=s<2,1!==s&&2!==s&&FC(n,"unsupported YAML version of the document")},TAG:function(n,e,i){var r,o;2!==i.length&&wn(n,"TAG directive accepts exactly two arguments"),o=i[1],H4.test(r=i[0])||wn(n,"ill-formed tag handle (first argument) of the TAG directive"),sh.call(n.tagMap,r)&&wn(n,'there is a previously declared suffix for "'+r+'" tag handle'),V4.test(o)||wn(n,"ill-formed tag prefix (second argument) of the TAG directive");try{o=decodeURIComponent(o)}catch{wn(n,"tag prefix is malformed: "+o)}n.tagMap[r]=o}};function ah(t,n,e,i){var r,o,s,a;if(n<e){if(a=t.input.slice(n,e),i)for(r=0,o=a.length;r<o;r+=1)9===(s=a.charCodeAt(r))||32<=s&&s<=1114111||wn(t,"expected valid JSON character");else Ute.test(a)&&wn(t,"the stream contains non-printable characters");t.result+=a}}function q4(t,n,e,i){var r,o,s,a;for(Vo.isObject(e)||wn(t,"cannot merge mappings; the provided source object is unacceptable"),s=0,a=(r=Object.keys(e)).length;s<a;s+=1)sh.call(n,o=r[s])||(n[o]=e[o],i[o]=!0)}function rm(t,n,e,i,r,o,s,a,c){var u,f;if(Array.isArray(r))for(u=0,f=(r=Array.prototype.slice.call(r)).length;u<f;u+=1)Array.isArray(r[u])&&wn(t,"nested arrays are not supported inside keys"),"object"==typeof r&&"[object Object]"===j4(r[u])&&(r[u]="[object Object]");if("object"==typeof r&&"[object Object]"===j4(r)&&(r="[object Object]"),r=String(r),null===n&&(n={}),"tag:yaml.org,2002:merge"===i)if(Array.isArray(o))for(u=0,f=o.length;u<f;u+=1)q4(t,n,o[u],e);else q4(t,n,o,e);else!t.json&&!sh.call(e,r)&&sh.call(n,r)&&(t.line=s||t.line,t.lineStart=a||t.lineStart,t.position=c||t.position,wn(t,"duplicated mapping key")),"__proto__"===r?Object.defineProperty(n,r,{configurable:!0,enumerable:!0,writable:!0,value:o}):n[r]=o,delete e[r];return n}function mS(t){var n;10===(n=t.input.charCodeAt(t.position))?t.position++:13===n?(t.position++,10===t.input.charCodeAt(t.position)&&t.position++):wn(t,"a line break is expected"),t.line+=1,t.lineStart=t.position,t.firstTabInLine=-1}function ko(t,n,e){for(var i=0,r=t.input.charCodeAt(t.position);0!==r;){for(;Uf(r);)9===r&&-1===t.firstTabInLine&&(t.firstTabInLine=t.position),r=t.input.charCodeAt(++t.position);if(n&&35===r)do{r=t.input.charCodeAt(++t.position)}while(10!==r&&13!==r&&0!==r);if(!Gc(r))break;for(mS(t),r=t.input.charCodeAt(t.position),i++,t.lineIndent=0;32===r;)t.lineIndent++,r=t.input.charCodeAt(++t.position)}return-1!==e&&0!==i&&t.lineIndent<e&&FC(t,"deficient indentation"),i}function NC(t){var e,n=t.position;return!(45!==(e=t.input.charCodeAt(n))&&46!==e||e!==t.input.charCodeAt(n+1)||e!==t.input.charCodeAt(n+2)||(n+=3,e=t.input.charCodeAt(n),0!==e&&!Ma(e)))}function _S(t,n){1===n?t.result+=" ":n>1&&(t.result+=Vo.repeat("\n",n-1))}function X4(t,n){var e,c,i=t.tag,r=t.anchor,o=[],a=!1;if(-1!==t.firstTabInLine)return!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=o),c=t.input.charCodeAt(t.position);0!==c&&(-1!==t.firstTabInLine&&(t.position=t.firstTabInLine,wn(t,"tab characters must not be used in indentation")),45===c&&Ma(t.input.charCodeAt(t.position+1)));)if(a=!0,t.position++,ko(t,!0,-1)&&t.lineIndent<=n)o.push(null),c=t.input.charCodeAt(t.position);else if(e=t.line,om(t,n,U4,!1,!0),o.push(t.result),ko(t,!0,-1),c=t.input.charCodeAt(t.position),(t.line===e||t.lineIndent>n)&&0!==c)wn(t,"bad indentation of a sequence entry");else if(t.lineIndent<n)break;return!!a&&(t.tag=i,t.anchor=r,t.kind="sequence",t.result=o,!0)}function Jte(t){var n,r,o,s,e=!1,i=!1;if(33!==(s=t.input.charCodeAt(t.position)))return!1;if(null!==t.tag&&wn(t,"duplication of a tag property"),60===(s=t.input.charCodeAt(++t.position))?(e=!0,s=t.input.charCodeAt(++t.position)):33===s?(i=!0,r="!!",s=t.input.charCodeAt(++t.position)):r="!",n=t.position,e){do{s=t.input.charCodeAt(++t.position)}while(0!==s&&62!==s);t.position<t.length?(o=t.input.slice(n,t.position),s=t.input.charCodeAt(++t.position)):wn(t,"unexpected end of the stream within a verbatim tag")}else{for(;0!==s&&!Ma(s);)33===s&&(i?wn(t,"tag suffix cannot contain exclamation marks"):(r=t.input.slice(n-1,t.position+1),H4.test(r)||wn(t,"named tag handle cannot contain such characters"),i=!0,n=t.position+1)),s=t.input.charCodeAt(++t.position);o=t.input.slice(n,t.position),Hte.test(o)&&wn(t,"tag suffix cannot contain flow indicator characters")}o&&!V4.test(o)&&wn(t,"tag name cannot contain such characters: "+o);try{o=decodeURIComponent(o)}catch{wn(t,"tag name is malformed: "+o)}return e?t.tag=o:sh.call(t.tagMap,r)?t.tag=t.tagMap[r]+o:"!"===r?t.tag="!"+o:"!!"===r?t.tag="tag:yaml.org,2002:"+o:wn(t,'undeclared tag handle "'+r+'"'),!0}function ene(t){var n,e;if(38!==(e=t.input.charCodeAt(t.position)))return!1;for(null!==t.anchor&&wn(t,"duplication of an anchor property"),e=t.input.charCodeAt(++t.position),n=t.position;0!==e&&!Ma(e)&&!nm(e);)e=t.input.charCodeAt(++t.position);return t.position===n&&wn(t,"name of an anchor node must contain at least one character"),t.anchor=t.input.slice(n,t.position),!0}function om(t,n,e,i,r){var o,s,a,b,C,x,M,U,W,c=1,u=!1,f=!1;if(null!==t.listener&&t.listener("open",t),t.tag=null,t.anchor=null,t.kind=null,t.result=null,o=s=a=PC===e||U4===e,i&&ko(t,!0,-1)&&(u=!0,t.lineIndent>n?c=1:t.lineIndent===n?c=0:t.lineIndent<n&&(c=-1)),1===c)for(;Jte(t)||ene(t);)ko(t,!0,-1)?(u=!0,a=o,t.lineIndent>n?c=1:t.lineIndent===n?c=0:t.lineIndent<n&&(c=-1)):a=!1;if(a&&(a=u||r),(1===c||PC===e)&&(U=AC===e||B4===e?n:n+1,W=t.position-t.lineStart,1===c?a&&(X4(t,W)||function Qte(t,n,e){var i,r,o,s,a,c,$,u=t.tag,f=t.anchor,b={},C=Object.create(null),x=null,M=null,U=null,W=!1,K=!1;if(-1!==t.firstTabInLine)return!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=b),$=t.input.charCodeAt(t.position);0!==$;){if(!W&&-1!==t.firstTabInLine&&(t.position=t.firstTabInLine,wn(t,"tab characters must not be used in indentation")),i=t.input.charCodeAt(t.position+1),o=t.line,63!==$&&58!==$||!Ma(i)){if(s=t.line,a=t.lineStart,c=t.position,!om(t,e,B4,!1,!0))break;if(t.line===o){for($=t.input.charCodeAt(t.position);Uf($);)$=t.input.charCodeAt(++t.position);if(58===$)Ma($=t.input.charCodeAt(++t.position))||wn(t,"a whitespace character is expected after the key-value separator within a block mapping"),W&&(rm(t,b,C,x,M,null,s,a,c),x=M=U=null),K=!0,W=!1,r=!1,x=t.tag,M=t.result;else{if(!K)return t.tag=u,t.anchor=f,!0;wn(t,"can not read an implicit mapping pair; a colon is missed")}}else{if(!K)return t.tag=u,t.anchor=f,!0;wn(t,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===$?(W&&(rm(t,b,C,x,M,null,s,a,c),x=M=U=null),K=!0,W=!0,r=!0):W?(W=!1,r=!0):wn(t,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),t.position+=1,$=i;if((t.line===o||t.lineIndent>n)&&(W&&(s=t.line,a=t.lineStart,c=t.position),om(t,n,PC,!0,r)&&(W?M=t.result:U=t.result),W||(rm(t,b,C,x,M,U,s,a,c),x=M=U=null),ko(t,!0,-1),$=t.input.charCodeAt(t.position)),(t.line===o||t.lineIndent>n)&&0!==$)wn(t,"bad indentation of a mapping entry");else if(t.lineIndent<n)break}return W&&rm(t,b,C,x,M,null,s,a,c),K&&(t.tag=u,t.anchor=f,t.kind="mapping",t.result=b),K}(t,W,U))||function Xte(t,n){var i,r,o,a,f,b,C,x,U,W,K,$,e=!0,s=t.tag,c=t.anchor,M=Object.create(null);if(91===($=t.input.charCodeAt(t.position)))f=93,x=!1,a=[];else{if(123!==$)return!1;f=125,x=!0,a={}}for(null!==t.anchor&&(t.anchorMap[t.anchor]=a),$=t.input.charCodeAt(++t.position);0!==$;){if(ko(t,!0,n),($=t.input.charCodeAt(t.position))===f)return t.position++,t.tag=s,t.anchor=c,t.kind=x?"mapping":"sequence",t.result=a,!0;e?44===$&&wn(t,"expected the node content, but found ','"):wn(t,"missed comma between flow collection entries"),K=null,b=C=!1,63===$&&Ma(t.input.charCodeAt(t.position+1))&&(b=C=!0,t.position++,ko(t,!0,n)),i=t.line,r=t.lineStart,o=t.position,om(t,n,AC,!1,!0),W=t.tag,U=t.result,ko(t,!0,n),$=t.input.charCodeAt(t.position),(C||t.line===i)&&58===$&&(b=!0,$=t.input.charCodeAt(++t.position),ko(t,!0,n),om(t,n,AC,!1,!0),K=t.result),x?rm(t,a,M,W,U,K,i,r,o):a.push(b?rm(t,null,M,W,U,K,i,r,o):U),ko(t,!0,n),44===($=t.input.charCodeAt(t.position))?(e=!0,$=t.input.charCodeAt(++t.position)):e=!1}wn(t,"unexpected end of the stream within a flow collection")}(t,U)?f=!0:(s&&function Kte(t,n){var e,i,f,b,r=gS,o=!1,s=!1,a=n,c=0,u=!1;if(124===(b=t.input.charCodeAt(t.position)))i=!1;else{if(62!==b)return!1;i=!0}for(t.kind="scalar",t.result="";0!==b;)if(43===(b=t.input.charCodeAt(++t.position))||45===b)gS===r?r=43===b?z4:Bte:wn(t,"repeat of a chomping mode identifier");else{if(!((f=Gte(b))>=0))break;0===f?wn(t,"bad explicit indentation width of a block scalar; it cannot be less than one"):s?wn(t,"repeat of an indentation width identifier"):(a=n+f-1,s=!0)}if(Uf(b)){do{b=t.input.charCodeAt(++t.position)}while(Uf(b));if(35===b)do{b=t.input.charCodeAt(++t.position)}while(!Gc(b)&&0!==b)}for(;0!==b;){for(mS(t),t.lineIndent=0,b=t.input.charCodeAt(t.position);(!s||t.lineIndent<a)&&32===b;)t.lineIndent++,b=t.input.charCodeAt(++t.position);if(!s&&t.lineIndent>a&&(a=t.lineIndent),Gc(b))c++;else{if(t.lineIndent<a){r===z4?t.result+=Vo.repeat("\n",o?1+c:c):r===gS&&o&&(t.result+="\n");break}for(i?Uf(b)?(u=!0,t.result+=Vo.repeat("\n",o?1+c:c)):u?(u=!1,t.result+=Vo.repeat("\n",c+1)):0===c?o&&(t.result+=" "):t.result+=Vo.repeat("\n",c):t.result+=Vo.repeat("\n",o?1+c:c),o=!0,s=!0,c=0,e=t.position;!Gc(b)&&0!==b;)b=t.input.charCodeAt(++t.position);ah(t,e,t.position,!1)}}return!0}(t,U)||function Zte(t,n){var e,i,r;if(39!==(e=t.input.charCodeAt(t.position)))return!1;for(t.kind="scalar",t.result="",t.position++,i=r=t.position;0!==(e=t.input.charCodeAt(t.position));)if(39===e){if(ah(t,i,t.position,!0),39!==(e=t.input.charCodeAt(++t.position)))return!0;i=t.position,t.position++,r=t.position}else Gc(e)?(ah(t,i,r,!0),_S(t,ko(t,!1,n)),i=r=t.position):t.position===t.lineStart&&NC(t)?wn(t,"unexpected end of the document within a single quoted scalar"):(t.position++,r=t.position);wn(t,"unexpected end of the stream within a single quoted scalar")}(t,U)||function qte(t,n){var e,i,r,o,s,a;if(34!==(a=t.input.charCodeAt(t.position)))return!1;for(t.kind="scalar",t.result="",t.position++,e=i=t.position;0!==(a=t.input.charCodeAt(t.position));){if(34===a)return ah(t,e,t.position,!0),t.position++,!0;if(92===a){if(ah(t,e,t.position,!0),Gc(a=t.input.charCodeAt(++t.position)))ko(t,!1,n);else if(a<256&&W4[a])t.result+=$4[a],t.position++;else if((s=jte(a))>0){for(r=s,o=0;r>0;r--)(s=Vte(a=t.input.charCodeAt(++t.position)))>=0?o=(o<<4)+s:wn(t,"expected hexadecimal character");t.result+=Wte(o),t.position++}else wn(t,"unknown escape sequence");e=i=t.position}else Gc(a)?(ah(t,e,i,!0),_S(t,ko(t,!1,n)),e=i=t.position):t.position===t.lineStart&&NC(t)?wn(t,"unexpected end of the document within a double quoted scalar"):(t.position++,i=t.position)}wn(t,"unexpected end of the stream within a double quoted scalar")}(t,U)?f=!0:function tne(t){var n,e,i;if(42!==(i=t.input.charCodeAt(t.position)))return!1;for(i=t.input.charCodeAt(++t.position),n=t.position;0!==i&&!Ma(i)&&!nm(i);)i=t.input.charCodeAt(++t.position);return t.position===n&&wn(t,"name of an alias node must contain at least one character"),e=t.input.slice(n,t.position),sh.call(t.anchorMap,e)||wn(t,'unidentified alias "'+e+'"'),t.result=t.anchorMap[e],ko(t,!0,-1),!0}(t)?(f=!0,(null!==t.tag||null!==t.anchor)&&wn(t,"alias node should not have any properties")):function Yte(t,n,e){var r,o,s,a,c,u,f,x,b=t.kind,C=t.result;if(Ma(x=t.input.charCodeAt(t.position))||nm(x)||35===x||38===x||42===x||33===x||124===x||62===x||39===x||34===x||37===x||64===x||96===x||(63===x||45===x)&&(Ma(r=t.input.charCodeAt(t.position+1))||e&&nm(r)))return!1;for(t.kind="scalar",t.result="",o=s=t.position,a=!1;0!==x;){if(58===x){if(Ma(r=t.input.charCodeAt(t.position+1))||e&&nm(r))break}else if(35===x){if(Ma(t.input.charCodeAt(t.position-1)))break}else{if(t.position===t.lineStart&&NC(t)||e&&nm(x))break;if(Gc(x)){if(c=t.line,u=t.lineStart,f=t.lineIndent,ko(t,!1,-1),t.lineIndent>=n){a=!0,x=t.input.charCodeAt(t.position);continue}t.position=s,t.line=c,t.lineStart=u,t.lineIndent=f;break}}a&&(ah(t,o,s,!1),_S(t,t.line-c),o=s=t.position,a=!1),Uf(x)||(s=t.position+1),x=t.input.charCodeAt(++t.position)}return ah(t,o,s,!1),!!t.result||(t.kind=b,t.result=C,!1)}(t,U,AC===e)&&(f=!0,null===t.tag&&(t.tag="?")),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):0===c&&(f=a&&X4(t,W))),null===t.tag)null!==t.anchor&&(t.anchorMap[t.anchor]=t.result);else if("?"===t.tag){for(null!==t.result&&"scalar"!==t.kind&&wn(t,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+t.kind+'"'),b=0,C=t.implicitTypes.length;b<C;b+=1)if((M=t.implicitTypes[b]).resolve(t.result)){t.result=M.construct(t.result),t.tag=M.tag,null!==t.anchor&&(t.anchorMap[t.anchor]=t.result);break}}else if("!"!==t.tag){if(sh.call(t.typeMap[t.kind||"fallback"],t.tag))M=t.typeMap[t.kind||"fallback"][t.tag];else for(M=null,b=0,C=(x=t.typeMap.multi[t.kind||"fallback"]).length;b<C;b+=1)if(t.tag.slice(0,x[b].tag.length)===x[b].tag){M=x[b];break}M||wn(t,"unknown tag !<"+t.tag+">"),null!==t.result&&M.kind!==t.kind&&wn(t,"unacceptable node kind for !<"+t.tag+'> tag; it should be "'+M.kind+'", not "'+t.kind+'"'),M.resolve(t.result,t.tag)?(t.result=M.construct(t.result,t.tag),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):wn(t,"cannot resolve a node with !<"+t.tag+"> explicit tag")}return null!==t.listener&&t.listener("close",t),null!==t.tag||null!==t.anchor||f}function nne(t){var e,i,r,s,n=t.position,o=!1;for(t.version=null,t.checkLineBreaks=t.legacy,t.tagMap=Object.create(null),t.anchorMap=Object.create(null);0!==(s=t.input.charCodeAt(t.position))&&(ko(t,!0,-1),s=t.input.charCodeAt(t.position),!(t.lineIndent>0||37!==s));){for(o=!0,s=t.input.charCodeAt(++t.position),e=t.position;0!==s&&!Ma(s);)s=t.input.charCodeAt(++t.position);for(r=[],(i=t.input.slice(e,t.position)).length<1&&wn(t,"directive name must not be less than one character in length");0!==s;){for(;Uf(s);)s=t.input.charCodeAt(++t.position);if(35===s){do{s=t.input.charCodeAt(++t.position)}while(0!==s&&!Gc(s));break}if(Gc(s))break;for(e=t.position;0!==s&&!Ma(s);)s=t.input.charCodeAt(++t.position);r.push(t.input.slice(e,t.position))}0!==s&&mS(t),sh.call(Z4,i)?Z4[i](t,i,r):FC(t,'unknown document directive "'+i+'"')}ko(t,!0,-1),0===t.lineIndent&&45===t.input.charCodeAt(t.position)&&45===t.input.charCodeAt(t.position+1)&&45===t.input.charCodeAt(t.position+2)?(t.position+=3,ko(t,!0,-1)):o&&wn(t,"directives end mark is expected"),om(t,t.lineIndent-1,PC,!1,!0),ko(t,!0,-1),t.checkLineBreaks&&zte.test(t.input.slice(n,t.position))&&FC(t,"non-ASCII line breaks are interpreted as content"),t.documents.push(t.result),t.position===t.lineStart&&NC(t)?46===t.input.charCodeAt(t.position)&&(t.position+=3,ko(t,!0,-1)):t.position<t.length-1&&wn(t,"end of the stream or a document separator is expected")}function K4(t,n){n=n||{},0!==(t=String(t)).length&&(10!==t.charCodeAt(t.length-1)&&13!==t.charCodeAt(t.length-1)&&(t+="\n"),65279===t.charCodeAt(0)&&(t=t.slice(1)));var e=new $te(t,n),i=t.indexOf("\0");for(-1!==i&&(e.position=i,wn(e,"null byte is not allowed in input")),e.input+="\0";32===e.input.charCodeAt(e.position);)e.lineIndent+=1,e.position+=1;for(;e.position<e.length-1;)nne(e);return e.documents}var Q4_load=function rne(t,n){var e=K4(t,n);if(0!==e.length){if(1===e.length)return e[0];throw new aa("expected a single document in the stream, but found more")}};function wS(t,n){return function(){throw new Error("Function yaml."+t+" is removed in js-yaml 4. Use yaml."+n+" instead, which is now safe by default.")}}var b5=Q4_load;wS("safeLoad","load"),wS("safeLoadAll","loadAll"),wS("safeDump","dump");const v5=Object.getOwnPropertyNames(Object.prototype),nie=Object.getOwnPropertyNames(Array.prototype);let ES=(()=>{class t{constructor(){this.peerHistory=[],this.isOpen=!1}static#e=this.appConfig={webrtc:{key:""},app:{title:"",mode:""},dice:{url:"",api:2}};initialize(){this.initAppConfig()}initAppConfig(){var e=this;return(0,L.A)(function*(){try{console.log("YAML\u8aad\u307f\u8fbc\u307f...");let i=yield e.loadYaml(),r=b5(i);t.applyConfig(r)}catch(i){console.warn(i)}ne.trigger("LOAD_CONFIG",t.appConfig)})()}loadYaml(){return(0,L.A)(function*(){let e=document.querySelector('script[type$="yaml"]');if(!e)return console.warn("loadYaml element not found."),"";let i=e.getAttribute("src");return null==i?(console.warn("loadYaml url undefined."),e.textContent):(yield fetch(i)).text()})()}static applyConfig(e,i=t.appConfig){if(null==e)return i;let r=Object.getOwnPropertyNames(e);for(let o of r)(Array.isArray(e)||Array.isArray(i)?v5.concat(nie):v5).includes(o)?console.log(`skip invalid key (${o})`):null!=e[o]&&"object"==typeof e[o]?(null==i[o]&&(i[o]=Array.isArray(e[o])?[]:{}),t.applyConfig(e[o],i[o])):"function"!=typeof e[o]&&"function"!=typeof i[o]&&(i[o]=e[o]);return i}static#t=this.\u0275fac=function(i){return new(i||t)};static#n=this.\u0275prov=nn({token:t,factory:t.\u0275fac})}return t})();const iie=t=>({"i-am-gm":t}),rie=t=>({"red-eye":t}),oie=t=>({"is-gm-mode":t});function sie(t,n){if(1&t){const e=Le();p(0,"span",12),Ut(1,"safe"),he("click",function(){return V(e),H(v(2).changeIcon())}),g()}2&t&&je("background-image",zt(1,2,"url("+v(2).myPeer.image.url+")","style"))}function aie(t,n){if(1&t){const e=Le();p(0,"div")(1,"div",3),q(2,sie,2,5,"span",4),p(3,"div")(4,"label",5)(5,"b",6)(6,"input",7),he("click",function(r){return V(e),H(v().onGMMode(r))}),g(),y(7),g()(),Ge(8,"br"),p(9,"button",8),he("click",function(){return V(e),H(v().changeIcon())}),y(10,"\u30d7\u30ec\u30a4\u30e4\u30fc\u30a2\u30a4\u30b3\u30f3\u5909\u66f4"),g()()(),p(11,"div"),y(12," \u3042\u306a\u305f\u306e\u8272\u3068\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\uff1a"),p(13,"input",9),at("ngModelChange",function(r){V(e);const o=v();return it(o.myPeerColor,r)||(o.myPeerColor=r),H(r)}),g(),p(14,"input",10),at("ngModelChange",function(r){V(e);const o=v();return it(o.myPeerName,r)||(o.myPeerName=r),H(r)}),g(),Ge(15,"br"),p(16,"small"),y(17,"\u203b\u6700\u5f8c\u306b\u4f7f\u3063\u305f"),p(18,"b"),y(19,"\u30a2\u30a4\u30b3\u30f3"),g(),y(20,"\u3001"),p(21,"b"),y(22,"\u8272"),g(),y(23,"\u3001"),p(24,"b"),y(25,"\u30cb\u30c3\u30af\u30cd\u30fc\u30e0"),g(),y(26,"\u3092\u30d6\u30e9\u30a6\u30b6\u306b\u4fdd\u5b58\u3057\u307e\u3059\u3002"),g(),Ge(27,"br"),p(28,"span",11),y(29,"\u8272\u3092\u521d\u671f\u5024\u306b\u623b\u3059\u969b\u306f\u767d(255,255,255)\u3092\u9078\u629e\u3002"),g()()()}if(2&t){const e=v();h(2),m("ngIf",e.myPeer.image),h(2),m("ngClass",Ke(8,iie,e.isGMMode||e.isGMHold)),h(2),Et("checked",e.isGMMode||e.isGMHold?"checked":""),h(),Xe(e.isGMMode?"\u73fe\u5728GM\u30e2\u30fc\u30c9\u3067\u3059":e.isGMHold?"GM\u30e2\u30fc\u30c9\u4fdd\u7559\u4e2d":"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b"),h(6),st("ngModel",e.myPeerColor),h(),je("color",e.myPeerColor),st("ngModel",e.myPeerName)}}function lie(t,n){if(1&t){const e=Le();p(0,"button",18),he("click",function(){return V(e),H(v(2).copyPeerId())}),p(1,"b",19),y(2,"content_copy"),g()()}2&t&&m("disabled",v(2).isCopied)}function cie(t,n){if(1&t&&(Ue(0),p(1,"span",13)(2,"span",14),y(3),g(),Ge(4,"input",15),g(),q(5,lie,3,1,"button",16),p(6,"span",17),y(7),g(),ze()),2&t){const e=v();h(3),Xe(e.networkService.peer.userId),h(),Et("value",e.networkService.peer.userId),h(),m("ngIf",e.isAbleClipboardCopy),h(),je("color",e.myPeerColor),m("@fadeInOut",e.isCopied),h(),Si(" ",e.isCopied?"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002":"","")}}function uie(t,n){1&t&&(p(0,"span",20),y(1,"???"),g())}function die(t,n){if(1&t){const e=Le();p(0,"button",18),he("click",function(){return V(e),H(v(3).copyRoomName())}),p(1,"b",19),y(2,"content_copy"),g()()}2&t&&m("disabled",v(3).isRoomNameCopied)}function hie(t,n){if(1&t&&(Ue(0),p(1,"span",13)(2,"span",21),y(3),g(),Ge(4,"input",22),g(),q(5,die,3,1,"button",16),p(6,"span",17),y(7),g(),ze()),2&t){const e=v(2);h(3),Bd("",e.networkService.peer.roomName,"/",e.networkService.peer.roomId,""),h(),Et("value",e.networkService.peer.roomName+"/"+e.networkService.peer.roomId),h(),m("ngIf",e.isAbleClipboardCopy),h(),je("color",e.myPeerColor),m("@fadeInOut",e.isRoomNameCopied),h(),Si(" ",e.isRoomNameCopied?"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002":"","")}}function fie(t,n){if(1&t&&(p(0,"span",13)(1,"span",21),y(2),g(),Ge(3,"input",22),g()),2&t){const e=v(3);h(2),Xe(e.networkService.peer.password),h(),Et("value",e.networkService.peer.password)}}function pie(t,n){if(1&t&&(p(0,"div",30),y(1),g()),2&t){const e=v(3);h(),Xe(e.maskedPassword)}}function gie(t,n){if(1&t){const e=Le();p(0,"button",18),he("click",function(){return V(e),H(v(3).copyPassword())}),p(1,"b",19),y(2,"content_copy"),g()()}if(2&t){const e=v(3);m("disabled",e.isPasswordCopied||e.isRoomInfoCopied)}}function mie(t,n){if(1&t){const e=Le();p(0,"button",31),he("click",function(){return V(e),H(v(3).copyRoomInfo())}),p(1,"b",32),y(2,"content_copy"),g(),p(3,"b",33),y(4,"\u30eb\u30fc\u30e0\u60c5\u5831\u3092\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc"),g()()}if(2&t){const e=v(3);m("disabled",e.isPasswordCopied||e.isRoomInfoCopied)}}function _ie(t,n){if(1&t){const e=Le();Ue(0),p(1,"div"),y(2," \u30d1\u30b9\u30ef\u30fc\u30c9 "),p(3,"label",23)(4,"input",24),he("click",function(r){return V(e),H(v(2).onPasswordOpen(r))}),g(),p(5,"b",25),y(6),g(),y(7,"\uff1a "),g(),p(8,"div",26),q(9,fie,4,2,"span",27)(10,pie,2,1,"div",28)(11,gie,3,1,"button",16),p(12,"span",17),y(13),g(),Ge(14,"br"),q(15,mie,5,1,"button",29),p(16,"span",17),y(17),g()()(),ze()}if(2&t){const e=v(2);h(4),Et("checked",e.isPasswordOpen?"checked":""),h(),m("ngClass",Ke(15,rie,e.isPasswordOpen)),h(),Xe(e.isPasswordOpen?"visibility":"visibility_off"),h(3),m("ngIf",e.isPasswordOpen),h(),m("ngIf",!e.isPasswordOpen),h(),m("ngIf",e.isAbleClipboardCopy),h(),je("color",e.myPeerColor),m("@fadeInOut",e.isPasswordCopied),h(),Si(" ",e.isPasswordCopied?"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002":"",""),h(2),m("ngIf",e.isAbleClipboardCopy),h(),je("color",e.myPeerColor),m("@fadeInOut",e.isRoomInfoCopied),h(),Si(" ",e.isRoomInfoCopied?"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002":"","")}}function bie(t,n){if(1&t&&(Ue(0),Ge(1,"hr"),p(2,"div"),y(3,"\u30eb\u30fc\u30e0\u540d\uff1a "),p(4,"span"),q(5,hie,8,8,"ng-container",0),g()(),q(6,_ie,18,17,"ng-container",0),ze()),2&t){const e=v();h(5),m("ngIf",e.networkService.isOpen),h(),m("ngIf",e.networkService.peer.password)}}function vie(t,n){1&t&&(p(0,"div",20),y(1,"\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u63a5\u7d9a\u72b6\u614b"),p(2,"span",40),y(3,"\uff08\u826f\u597d "),g(),p(4,"i",41),y(5,"sentiment_very_satisfied"),g(),p(6,"span",40),y(7," \uff1e "),g(),p(8,"i",42),y(9,"sentiment_dissatisfied"),g(),p(10,"span",40),y(11," \uff1e "),g(),p(12,"i",43),y(13,"mood_bad"),g(),p(14,"span",40),y(15," \uff1e "),g(),p(16,"i",44),y(17,"sentiment_very_dissatisfied"),g(),p(18,"span",40),y(19," \u4e0d\u826f\uff09"),g(),y(20,"\uff1a"),g())}function yie(t,n){1&t&&(p(0,"span"),y(1,"[\u63a5\u7d9a\u4e2d]"),g())}function Cie(t,n){if(1&t&&(Ge(0,"span",45),Ut(1,"safe")),2&t){const e=v().$implicit;je("background-image",zt(1,2,"url("+v().findPeerImageUrl(e.peerId)+")","style"))}}function xie(t,n){if(1&t&&(p(0,"div"),q(1,vie,21,0,"div",1),p(2,"div",34),q(3,yie,2,0,"span",0),p(4,"span")(5,"span",35)(6,"i",36),y(7),g(),p(8,"span",37),y(9),g(),y(10," ["),q(11,Cie,2,5,"span",38),p(12,"span")(13,"b"),y(14),g()(),y(15,"] "),g()(),p(16,"div",39)(17,"span"),y(18),g()()()()),2&t){const e=n.$implicit,i=n.index,r=v();h(),m("ngIf",0==i),h(2),m("ngIf",!e.isOpen),h(2),m("ngClass",Ke(19,oie,r.findPeerIsGMMode(e.peerId))),h(),yg("material-icons health "+r.healthClass(e.session.health)),h(),Xe(r.healthIcon(e.session.health)),h(2),Xe(r.findUserId(e.peerId)),h(2),m("ngIf",r.findPeerImageUrl(e.peerId)),h(2),je("color",r.findPeerColor(e.peerId)),h(),Xe(r.findPeerName(e.peerId)),h(2),je("border-left-color",r.findPeerColor(e.peerId)),h(2),p2("\u63a5\u7d9a\u72b6\u614b Grade:",r.stringFromSessionGrade(e.session.grade)," (",e.session.description,") Health:",(100*e.session.health).toFixed(0),"% Speed:",(100*e.session.speed).toFixed(0),"% Ping:",e.session.ping.toFixed(1),"ms")}}function wie(t,n){if(1&t){const e=Le();Ue(0),p(1,"input",47),at("ngModelChange",function(r){V(e);const o=v(2);return it(o.targetUserId,r)||(o.targetUserId=r),H(r)}),g(),p(2,"button",48),he("click",function(){return V(e),H(v(2).connectPeer())}),y(3,"\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a"),g(),Ge(4,"br"),ze()}if(2&t){const e=v(2);h(),st("ngModel",e.targetUserId),m("disabled",e.isDisableConnect),h(),m("disabled",!e.networkService.isOpen||null==e.targetUserId||""==e.targetUserId||e.isDisableConnect)}}function Eie(t,n){if(1&t){const e=Le();p(0,"button",49),he("click",function(){return V(e),H(v(2).showLobby())}),y(1,"\u30ed\u30d3\u30fc\uff08\u30eb\u30fc\u30e0\u4e00\u89a7\uff09\u3092\u8868\u793a"),g()}if(2&t){const e=v(2);m("disabled",!e.networkService.isOpen||e.isDisableConnect)}}function Iie(t,n){if(1&t&&(p(0,"div"),q(1,wie,5,3,"ng-container",0)(2,Eie,2,1,"button",46),g()),2&t){const e=v();h(),m("ngIf",!e.networkService.peer.isRoom),h(),m("ngIf",e.networkService.peerIds.length<=1)}}function Tie(t,n){1&t&&(p(0,"div",51),y(1,"\u203b\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306f\u3001\u304a\u4e92\u3044\u306eID\u3092\u30e6\u30c9\u30ca\u30ea\u30a6\u30e0\u5916\u3067\u5171\u6709\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),g())}function Sie(t,n){1&t&&(p(0,"div",51),y(1,"\u203b\u4e00\u4eba\u3067\u52d5\u4f5c\u78ba\u8a8d\u3092\u884c\u3044\u305f\u3044\u5834\u5408\u306f\u30d6\u30e9\u30a6\u30b6\u30922\u3064\u958b\u304f\u3068\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u3002"),g())}function Mie(t,n){if(1&t&&(Ue(0),q(1,Tie,2,0,"div",50)(2,Sie,2,0,"div",50),ze()),2&t){const e=v(2);h(),m("ngIf",e.networkService.peers.length<1),h(),m("ngIf",e.networkService.peers.length<1)}}function Die(t,n){1&t&&(Ue(0),p(1,"div",51),y(2,"\u203b\u30eb\u30fc\u30e0\u6a5f\u80fd\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u6642\u306f\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002"),g(),ze())}function kie(t,n){if(1&t&&(Ue(0),q(1,Mie,3,2,"ng-container",0)(2,Die,3,0,"ng-container",0),ze()),2&t){const e=v();h(),m("ngIf",!e.networkService.peer.isRoom),h(),m("ngIf",e.networkService.peer.isRoom)}}function Oie(t,n){1&t&&(Ue(0),p(1,"div",51),y(2,"\u203bGM\u30e2\u30fc\u30c9\u4e2d\uff08\u4fdd\u7559\u4e2d\u542b\u3080\uff09\u306f\u81ea\u5206\u304b\u3089\u63a5\u7d9a\u3092\u884c\u3048\u307e\u305b\u3093\u3002"),g(),ze())}let IS=(()=>{class t{get myPeer(){return Fe.myCursor}get myPeerName(){return Fe.myCursor?Fe.myCursor.name:null}set myPeerName(e){Fe.myCursor&&(Fe.myCursor.name=e,Fe.myCursor.name===Fe.CHAT_DEFAULT_NAME?Jn.removeItem(Fe.CHAT_MY_NAME_LOCAL_STORAGE_KEY).catch(i=>console.log(i)):Jn.setItem(Fe.CHAT_MY_NAME_LOCAL_STORAGE_KEY,Fe.myCursor.name).catch(i=>console.log(i)))}get myPeerColor(){return Fe.myCursor?Fe.myCursor.color:Fe.CHAT_DEFAULT_COLOR}set myPeerColor(e){if(e&&Fe.myCursor){if(e=e.trim().toLowerCase(),!/^\#[0-9a-f]{6}$/.test(e))return;Fe.myCursor.color=e==Fe.CHAT_TRANSPARENT_COLOR?Fe.CHAT_DEFAULT_COLOR:e,Fe.myCursor.color===Fe.CHAT_DEFAULT_COLOR?Jn.removeItem(Fe.CHAT_MY_COLOR_LOCAL_STORAGE_KEY).catch(i=>console.log(i)):Jn.setItem(Fe.CHAT_MY_COLOR_LOCAL_STORAGE_KEY,Fe.myCursor.color).catch(i=>console.log(i))}}get isGMMode(){return!!Fe.myCursor&&Fe.myCursor.isGMMode}set isGMMode(e){Fe.myCursor&&(Fe.myCursor.isGMMode=e)}get isGMHold(){return Fe.isGMHold}get isDisableConnect(){return this.isGMHold||this.isGMMode}get maskedPassword(){return"\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf"}constructor(e,i,r,o,s){this.ngZone=e,this.modalService=i,this.panelService=r,this.chatMessageService=o,this.appConfigService=s,this.targetUserId="",this.networkService=jt,this.gameRoomService=bt.instance,this.isCopied=!1,this.isRoomNameCopied=!1,this.isPasswordCopied=!1,this.isPasswordOpen=!1,this.isRoomInfoCopied=!1,this.help=""}ngOnInit(){Promise.resolve().then(()=>{this.panelService.title="\u63a5\u7d9a\u60c5\u5831",this.panelService.isAbleFullScreenButton=!1})}ngAfterViewInit(){ne.register(this).on("OPEN_NETWORK",e=>{this.ngZone.run(()=>{})}),this.interval=setInterval(()=>{},1e3)}ngOnDestroy(){clearTimeout(this._timeOutId),clearTimeout(this._timeOutId2),clearTimeout(this._timeOutId3),clearTimeout(this._timeOutId4),ne.unregister(this),clearInterval(this.interval)}changeIcon(){let e=[];this.myPeer&&this.myPeer.imageIdentifier&&(e=[this.myPeer.imageIdentifier]),this.modalService.open(Yc,{currentImageIdentifires:e}).then(i=>{if(!this.myPeer||!i)return;this.myPeer.imageIdentifier=i;let r=on.instance.get(i);r&&(r.state===Ri.COMPLETE?Jn.setItem(Fe.CHAT_MY_ICON_LOCAL_STORAGE_KEY,r.blob).catch(o=>console.log(o)):"none_icon"===i?Jn.removeItem(Fe.CHAT_MY_ICON_LOCAL_STORAGE_KEY).catch(o=>console.log(o)):Jn.setItem(Fe.CHAT_MY_ICON_LOCAL_STORAGE_KEY,i).catch(o=>console.log(o)))})}connectPeer(){let e=this.targetUserId;if(this.targetUserId="",e.length<1)return;this.help="";let i=Ar.create(e);i.isRoom||(bt.instance.clearDeleteHistory(),jt.connect(i),(Fe.isGMHold||this.isGMMode)&&(Fe.isGMHold=!1,this.isGMMode=!1,this.isGMMode&&(this.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664"),ne.trigger("CHANGE_GM_MODE",null))))}showLobby(){(Fe.isGMHold||this.isGMMode)&&(Fe.isGMHold=!1,this.isGMMode=!1,this.isGMMode&&(this.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664"),ne.trigger("CHANGE_GM_MODE",null))),this.modalService.open(Lee,{width:700,height:400,left:0,top:400})}stringFromSessionGrade(e){return Pu[e]??Pu[Pu.UNSPECIFIED]}findUserId(e){const i=Fe.findByPeerId(e);return i?i.userId:""}findPeerName(e){const i=Fe.findByPeerId(e);return i?i.name:""}findPeerColor(e){const i=Fe.findByPeerId(e);return i?i.color:""}findPeerImageUrl(e){const i=Fe.findByPeerId(e);return i?i.image.url:""}findPeerIsGMMode(e){const i=Fe.findByPeerId(e);return!!i&&i.isGMMode}copyPeerId(){navigator.clipboard&&(navigator.clipboard.writeText(this.networkService.peer.userId),this.isCopied=!0,clearTimeout(this._timeOutId),this._timeOutId=setTimeout(()=>{this.isCopied=!1},1e3))}copyRoomName(){navigator.clipboard&&(navigator.clipboard.writeText(this.networkService.peer.roomName+"/"+this.networkService.peer.roomId),this.isRoomNameCopied=!0,clearTimeout(this._timeOutId2),this._timeOutId2=setTimeout(()=>{this.isRoomNameCopied=!1},1e3))}copyPassword(){navigator.clipboard&&(this.modalService.open(Fr,{title:"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u30b3\u30d4\u30fc",text:"\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3059\u304b\uff1f",helpHtml:"\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5171\u6709\u3059\u308b\u969b\u306b\u306f\u3001SNS\u306e\u516c\u958b\u30a2\u30ab\u30a6\u30f3\u30c8\u306a\u3069\u3067<b>\u4e0d\u7279\u5b9a\u591a\u6570\u306b\u516c\u958b\u3059\u308b\u3053\u3068\u306f\u907f\u3051\u3066</b>\u304f\u3060\u3055\u3044\u3002",type:ur.OK_CANCEL,materialIcon:"content_copy",action:()=>{navigator.clipboard.writeText(this.networkService.peer.password),this.isPasswordCopied=!0,clearTimeout(this._timeOutId3),this._timeOutId3=setTimeout(()=>{this.isPasswordCopied=!1},1e3)}}),this.isPasswordOpen=!1)}copyRoomInfo(){navigator.clipboard&&(this.modalService.open(Fr,{title:"\u30eb\u30fc\u30e0\u60c5\u5831\u306e\u30b3\u30d4\u30fc",text:"\u30eb\u30fc\u30e0\u60c5\u5831\uff08\u30eb\u30fc\u30e0\u540d/\u30eb\u30fc\u30e0ID\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\uff09\u3092\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3059\u304b\uff1f",helpHtml:"\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5171\u6709\u3059\u308b\u969b\u306b\u306f\u3001SNS\u306e\u516c\u958b\u30a2\u30ab\u30a6\u30f3\u30c8\u306a\u3069\u3067<b>\u4e0d\u7279\u5b9a\u591a\u6570\u306b\u516c\u958b\u3059\u308b\u3053\u3068\u306f\u907f\u3051\u3066</b>\u304f\u3060\u3055\u3044\u3002",type:ur.OK_CANCEL,materialIcon:"content_copy",action:()=>{navigator.clipboard.writeText("\u30eb\u30fc\u30e0\u540d\uff1a"+this.networkService.peer.roomName+"/"+this.networkService.peer.roomId+"  \u30d1\u30b9\u30ef\u30fc\u30c9\uff1a"+this.networkService.peer.password),this.isRoomInfoCopied=!0,clearTimeout(this._timeOutId4),this._timeOutId4=setTimeout(()=>{this.isRoomInfoCopied=!1},1e3)}}),this.isPasswordOpen=!1)}isAbleClipboardCopy(){return!!navigator.clipboard}onPasswordOpen(e){this.isPasswordOpen?this.isPasswordOpen=!1:(e.preventDefault(),this.modalService.open(Fr,{title:"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u8868\u793a",text:"\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",helpHtml:"\u30d7\u30ec\u30a4\u914d\u4fe1\u4e2d\u306a\u3069\u306b\u8aa4\u3063\u3066\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8868\u793a\u3057\u306a\u3044\u3088\u3046\u306b\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002<br>\u307e\u305f\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5171\u6709\u3059\u308b\u969b\u306b\u306f\u3001SNS\u306e\u516c\u958b\u30a2\u30ab\u30a6\u30f3\u30c8\u306a\u3069\u3067<b>\u4e0d\u7279\u5b9a\u591a\u6570\u306b\u516c\u958b\u3059\u308b\u3053\u3068\u306f\u907f\u3051\u3066</b>\u304f\u3060\u3055\u3044\u3002",type:ur.OK_CANCEL,materialIcon:"visibility",action:()=>{this.isPasswordOpen=!0,e.target.checked=!0}}))}onGMMode(e){Fe.isGMHold||this.isGMMode?this.isGMMode?(e.preventDefault(),this.modalService.open(Fr,{title:"GM\u30e2\u30fc\u30c9\u89e3\u9664",text:"GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664\u3057\u307e\u3059\u304b\uff1f",type:ur.OK_CANCEL,materialIcon:"person_remove",action:()=>{Fe.isGMHold=!1,this.isGMMode=!1,e.target.checked=!1,this.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664"),ne.trigger("CHANGE_GM_MODE",null),gn.isStealthMode&&this.modalService.open(Fr,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:ur.OK,materialIcon:"disabled_visible"})}})):(Fe.isGMHold=!1,this.isGMMode=!1):(e.preventDefault(),this.modalService.open(Fr,{title:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b",text:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u304b\uff1f\nGM\u30e2\u30fc\u30c9\u4e2d\uff08\u4fdd\u7559\u4e2d\u542b\u3080\uff09\u306f\u3042\u306a\u305f\u304b\u3089\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3001\u30eb\u30fc\u30e0\u3078\u306e\u63a5\u7d9a\u306f\u884c\u3048\u307e\u305b\u3093\u3002",helpHtml:"GM\u30e2\u30fc\u30c9\u3067\u306f\u3001<b>\u79d8\u8a71</b>\u3001\u88cf\u5411\u304d\u306e<b>\u30ab\u30fc\u30c9</b>\u3001\u516c\u958b\u3055\u308c\u3066\u3044\u306a\u3044<b>\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb</b>\u3001<b>\u30ad\u30e3\u30e9\u30af\u30bf\u30fc</b>\u4f4d\u7f6e\u3001<b>\u30ab\u30fc\u30bd\u30eb</b>\u4f4d\u7f6e\u3092\u3059\u3079\u3066\u898b\u308b\u3053\u3068\u304c\u3067\u304d\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u3089\u306a\u304f\u306a\u308a\u307e\u3059\u3002\n\n<b><big>\u2014With great power comes great responsibility.</big></b>",type:ur.OK_CANCEL,materialIcon:"person_add",action:()=>{Fe.isGMHold=!0,this.isGMMode=!1,e.target.checked=!0,this.modalService.open(Fr,{title:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b",text:"\u307e\u3060GM\u30e2\u30fc\u30c9\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002",helpHtml:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b\u306b\u306f\u3001\u30c1\u30e3\u30c3\u30c8\u304b\u3089 <b>GM\u306b\u306a\u308b</b> \u307e\u305f\u306f <b>GM\u306b\u306a\u308a\u307e\u3059</b> \u3092\u542b\u3080\u6587\u3092\u9001\u4fe1\u3057\u307e\u3059\u3002",type:ur.OK,materialIcon:"person_add"})}}))}healthIcon(e){return e>=.99?"sentiment_very_satisfied":e>.97?"sentiment_dissatisfied":e>.95?"mood_bad":"sentiment_very_dissatisfied"}healthClass(e){return e>=.99?"health-blue":e>.97?"health-green":e>.95?"health-yellow":"health-red"}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Pn),Y(Ei),Y(yi),Y(vo),Y(ES))};static#t=this.\u0275cmp=In({type:t,selectors:[["peer-menu"]],decls:13,vars:8,consts:[[4,"ngIf"],["style","font-weight: bold",4,"ngIf"],[4,"ngFor","ngForOf"],[2,"display","flex","align-items","flex-end","margin-bottom","4px"],["class","image cover","style","cursor: pointer",3,"background-image","click",4,"ngIf"],[2,"display","inline-block","margin-bottom","2px",3,"ngClass"],[2,"font-size","smaller"],["type","checkbox","name","i-am-gamemaster","value","I'm Gamemaster",3,"click","checked"],[3,"click"],["type","color",2,"width","1em","margin-right","0.5em",3,"ngModelChange","ngModel"],["placeholder","\u30cb\u30c3\u30af\u30cd\u30fc\u30e0",2,"font-weight","bolder",3,"ngModelChange","ngModel"],[2,"font-size","smaller","margin-left","1em"],[1,"image","cover",2,"cursor","pointer",3,"click"],[1,"id-input-container"],[1,"id-spacer"],["type","text","readonly","",1,"id-input",3,"value"],["title","\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc",3,"disabled","click",4,"ngIf"],[1,"copied"],["title","\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc",3,"click","disabled"],[1,"material-icons",2,"font-size","1em","vertical-align","bottom"],[2,"font-weight","bold"],[1,"id-spacer","room-data"],["type","text","readonly","",1,"id-input","room-data",3,"value"],["sytle","white-space: nowrap"],["name","show-hide-password","type","checkbox","value","Show Hides",3,"click","checked"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[2,"display","inline"],["class","id-input-container",4,"ngIf"],["style","display: inline","class","masked-password","draggable","false",4,"ngIf"],["style","margin-top: 2px; margin-left: 0px",3,"disabled","click",4,"ngIf"],["draggable","false",1,"masked-password",2,"display","inline"],[2,"margin-top","2px","margin-left","0px",3,"click","disabled"],[1,"material-icons",2,"font-size","1em","vertical-align","middle"],[2,"margin-left","2px","display","inline-block","font-size","smaller"],[1,"peer-info"],[3,"ngClass"],[2,"margin-right","2px"],[2,"margin-right","3px"],["class","cover mini-icon",3,"background-image",4,"ngIf"],[1,"session-info"],[1,"health"],[1,"material-icons","health","health-blue"],[1,"material-icons","health","health-green"],[1,"material-icons","health","health-yellow"],[1,"material-icons","health","health-red"],[1,"cover","mini-icon"],["style","margin-left: 0px",3,"disabled","click",4,"ngIf"],["placeholder","\u63a5\u7d9a\u3057\u305f\u3044\u76f8\u624b\u306eID","name","targetUserId",3,"ngModelChange","ngModel","disabled"],[3,"click","disabled"],[2,"margin-left","0px",3,"click","disabled"],["style","font-size: 12px",4,"ngIf"],[2,"font-size","12px"]],template:function(i,r){1&i&&(q(0,aie,30,10,"div",0),p(1,"div")(2,"div"),y(3,"\u3042\u306a\u305f\u306eID\uff1a "),p(4,"span"),q(5,cie,8,7,"ng-container",0),g(),q(6,uie,2,0,"span",1),g()(),q(7,bie,7,2,"ng-container",0),Ge(8,"hr"),q(9,xie,19,21,"div",2)(10,Iie,3,2,"div",0)(11,kie,3,2,"ng-container",0)(12,Oie,3,0,"ng-container",0)),2&i&&(m("ngIf",r.myPeer),h(5),m("ngIf",r.networkService.isOpen),h(),m("ngIf",!r.networkService.isOpen),h(),m("ngIf",r.networkService.peer.isRoom),h(2),m("ngForOf",r.networkService.peers),h(),m("ngIf",!r.isGMMode&&!r.isGMHold),h(),m("ngIf",!r.isGMMode&&!r.isGMHold),h(),m("ngIf",r.isGMMode||r.isGMHold))},dependencies:[Ni,nr,ri,kr,Or,Cr,cr],styles:['[_nghost-%COMP%]{display:block}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:table-cell;vertical-align:top;border-radius:.6rem}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto;height:auto;max-width:100%;max-height:100%;vertical-align:bottom}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}.id-input-container[_ngcontent-%COMP%]{display:inline-block;position:relative}.id-spacer[_ngcontent-%COMP%]{visibility:hidden;display:inline-block;pointer-events:none;padding:0 3px;box-sizing:border-box;border-color:transparent;border-radius:3px;border-width:2px;border-style:solid;font-family:Cambria,Georgia;font-size:larger;font-weight:bolder}.id-input[_ngcontent-%COMP%]{top:0;left:-4px;width:100%;position:absolute;background:none;border:none;outline:none;color:#444;font-family:Cambria,Georgia;font-size:larger;padding:2px;box-sizing:border-box;border-color:transparent;border-radius:3px;border-width:2px;border-style:solid;font-weight:bolder}.room-data[_ngcontent-%COMP%]{font-size:medium}.masked-password[_ngcontent-%COMP%]{font-weight:bolder;color:#444;font-family:Cambria,Georgia;-webkit-user-select:none;user-select:none;display:inline-block}.id-input[_ngcontent-%COMP%]:active, .id-input[_ngcontent-%COMP%]:hover{border-color:#444}.copied[_ngcontent-%COMP%]{font-size:smaller;opacity:0;white-space:nowrap}.health[_ngcontent-%COMP%]{font-size:14px;font-weight:400}.health-blue[_ngcontent-%COMP%]{color:#00f;filter:drop-shadow(0px 0px 2px skyblue)}.health-green[_ngcontent-%COMP%]{color:green;filter:drop-shadow(0px 0px 1px greenyellow)}.health-yellow[_ngcontent-%COMP%]{color:#757532;filter:drop-shadow(0px 0px 1px yellow)}.health-red[_ngcontent-%COMP%]{color:#8b0000;filter:drop-shadow(0px 0px 2px red)}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}.mini-icon[_ngcontent-%COMP%]{display:inline-block;padding:0;width:16px;height:16px;vertical-align:middle;border-radius:.2rem;margin-right:2px}.is-gm-mode[_ngcontent-%COMP%]:after{content:"\\3010GM\\3011";color:red}.i-am-gm[_ngcontent-%COMP%]{color:red;text-shadow:1px 1px 0px #eee,-1px 1px 0px #eee,1px -1px 0px #eee,-1px -1px 0px #eee,1px 0px 0px #eee,0px 1px 0px #eee,-1px 0px 0px #eee,0px -1px 0px #eee,0px 0px 2px crimson}.peer-info[_ngcontent-%COMP%]{position:relative}.session-info[_ngcontent-%COMP%]{visibility:hidden;pointer-events:none;position:absolute;top:-110%;padding:.2rem .4rem;font-size:12px;color:#444;background:linear-gradient(-30deg,#f0dabd,#fff4e8);border:solid 1px #999;border-left:solid 4px #555}.peer-info[_ngcontent-%COMP%]:hover   .session-info[_ngcontent-%COMP%]{visibility:visible}'],data:{animation:[Xn("fadeInOut",[an("false => true",[rn("50ms ease-in-out",We({opacity:1})),rn("900ms ease-in-out",We({opacity:0}))])])]}})}return t})();var di=function(t){return t.N="n",t.E="e",t.W="w",t.S="s",t.NE="ne",t.NW="nw",t.SE="se",t.SW="sw",t}(di||{});class Aie{constructor(n,e){this.target=n,this.type=e,this.input=null,this.handle=null,this.width=12,this.initialize()}initialize(){this.handle=this.target.ownerDocument.createElement("div"),this.handle.classList.add("ui-resize-handler-"+this.type),this.input=new Bc(this.handle),this.target.appendChild(this.handle);let n=this.handle.style;switch(n.position="absolute",n.zIndex="1",n.backgroundColor="transparent",this.type){case di.N:n.top=3*-this.width/4+"px",n.left="0px",n.right="0px",n.height=`${this.width}px`;break;case di.E:n.top="0px",n.bottom="0px",n.right=3*-this.width/4+"px",n.width=`${this.width}px`;break;case di.W:n.top="0px",n.bottom="0px",n.left=3*-this.width/4+"px",n.width=`${this.width}px`;break;case di.S:n.bottom=3*-this.width/4+"px",n.left="0px",n.right="0px",n.height=`${this.width}px`;break;case di.NE:n.top=3*-this.width/4+"px",n.right=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.zIndex="2";break;case di.NW:n.top=3*-this.width/4+"px",n.left=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.zIndex="2";break;case di.SE:n.bottom=3*-this.width/4+"px",n.right=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.zIndex="2";break;case di.SW:n.bottom=3*-this.width/4+"px",n.left=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.zIndex="2"}this.cursor(!0)}destroy(){this.handle.remove(),this.input.destroy()}cursor(n){let e=this.handle.style;if(n)switch(this.type){case di.N:e.cursor="ns-resize";break;case di.E:case di.W:e.cursor="ew-resize";break;case di.S:e.cursor="ns-resize";break;case di.NE:e.cursor="nesw-resize";break;case di.NW:case di.SE:e.cursor="nwse-resize";break;case di.SW:e.cursor="nesw-resize"}else e.cursor="default"}}let Pie=(()=>{class t{set isDisable(e){this._isDisable=e,this.initialize()}set align(e){this._align=e,this.initialize()}get handleTypes(){return this._isDisable||"none"===this._align?[]:"horizontal"===this._align?[di.E,di.W]:"vertical"===this._align?[di.N,di.S]:[di.N,di.E,di.W,di.S,di.NE,di.NW,di.SE,di.SW]}constructor(e,i){this.ngZone=e,this.elementRef=i,this.boundsSelector="body",this.stackSelector="",this.minWidth=100,this.minHeight=100,this.ostart=new ei,this.onmove=new ei,this.onend=new ei,this.handleMap=new Map,this._isDisable=!1,this._align="normal",this.startPosition={left:0,top:0,width:0,height:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={left:0,top:0,width:0,height:0}}ngAfterViewInit(){this.initialize(),this.setForeground()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.handleMap.forEach(e=>e.destroy()),this.handleMap.clear(),this.handleTypes.forEach(e=>{let i=new Aie(this.elementRef.nativeElement,e);this.handleMap.set(e,i),i.input.onStart=r=>this.onResizeStart(r,i),i.input.onMove=r=>this.onResizeMove(r,i),i.input.onEnd=r=>this.onResizeEnd(r,i),i.input.onContextMenu=r=>this.onContextMenu(r,i)})})}cancel(){this.handleMap.forEach(e=>e.input.cancel())}destroy(){this.handleMap.forEach(e=>e.destroy()),this.handleMap.clear()}onResizeStart(e,i){if(this._isDisable||1===e.button||2===e.button)return this.cancel();this.setForeground(),this.handleMap.forEach(r=>{r!==i&&r.input.cancel()}),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=i.input.pointer,this.prevTrans={left:0,top:0,width:0,height:0},e.stopPropagation()}onResizeMove(e,i){let r={left:0,top:0,width:i.input.pointer.x-this.startPointer.x,height:i.input.pointer.y-this.startPointer.y};switch(i.type){case di.N:case di.S:r.width=0;break;case di.E:case di.W:r.height=0}switch(i.type){case di.SW:r.left=r.width,r.width*=-1;break;case di.NE:r.top=r.height,r.height*=-1;break;case di.E:case di.S:case di.SE:break;case di.N:case di.W:case di.NW:r.left=r.width,r.top=r.height,r.width*=-1,r.height*=-1}r.width+this.startPosition.width<this.minWidth&&(r.width=this.minWidth-this.startPosition.width,r.left=0!==r.left?-r.width:r.left),r.height+this.startPosition.height<this.minHeight&&(r.height=this.minHeight-this.startPosition.height,r.top=0!==r.top?-r.height:r.top);let s=this.calcCorrectionPosition({left:r.left-this.prevTrans.left,top:r.top-this.prevTrans.top,width:r.width-this.prevTrans.width,height:r.height-this.prevTrans.height});r.left+=s.left,r.top+=s.top,r.width+=s.width,r.height+=s.height,this.elementRef.nativeElement.style.left=r.left+this.startPosition.left+"px",this.elementRef.nativeElement.style.top=r.top+this.startPosition.top+"px",this.elementRef.nativeElement.style.width=r.width+this.startPosition.width+"px",this.elementRef.nativeElement.style.height=r.height+this.startPosition.height+"px",this.prevTrans=r,e.cancelable&&e.preventDefault(),e.stopPropagation()}onResizeEnd(e,i){i.input.isDragging&&e.cancelable&&e.preventDefault(),e.stopPropagation()}onContextMenu(e,i){e.stopPropagation()}calcCorrectionPosition(e={left:0,top:0,width:0,height:0}){let i={left:0,top:0,width:0,height:0},r=this.elementRef.nativeElement.getBoundingClientRect(),o=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();return o.right<r.right+e.left+e.width&&(i.width+=o.right-(r.right+e.left+e.width)),r.left+e.left<o.left&&(i.left+=o.left-(r.left+e.left),i.width-=i.left),o.bottom<r.bottom+e.top+e.height&&(i.height+=o.bottom-(r.bottom+e.top+e.height)),r.top+e.top<o.top&&(i.top+=o.top-(r.top+e.top),i.height-=i.top),i}calcElementPosition(e){let i=window.getComputedStyle(e);return{left:_o.relation(i.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),top:_o.relation(i.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),width:_o.relation(i.width,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),height:_o.relation(i.height,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight)}}setForeground(){if(this.stackSelector.length<1)return;let e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),i=0,r=99999;e.forEach(o=>{let s=parseInt(o.style.zIndex);i<s&&(i=s),s<r&&(r=s)}),!(i<=parseInt(this.elementRef.nativeElement.style.zIndex))&&(e.forEach(o=>{o.style.zIndex=parseInt(o.style.zIndex)-r+""}),this.elementRef.nativeElement.style.zIndex=i+1+"")}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Pn),Y(fr))};static#t=this.\u0275dir=Sn({type:t,selectors:[["","appResizable",""]],inputs:{boundsSelector:[Ce.None,"resizable.bounds","boundsSelector"],stackSelector:[Ce.None,"resizable.stack","stackSelector"],minWidth:[Ce.None,"resizable.minWidth","minWidth"],minHeight:[Ce.None,"resizable.minHeight","minHeight"],isDisable:[Ce.None,"resizable.disable","isDisable"],align:[Ce.None,"resizable.align","align"]},outputs:{ostart:"resizable.start",onmove:"resizable.move",onend:"resizable.end"}})}return t})();const Fie=["draggablePanel"],Nie=["scrollablePanel"],Rie=["content"],Lie=["titleBar"],Bie=["*"],Uie=(t,n,e,i)=>({"pointer-events-none":t,"is-full-screen":n,"is-minimized":e,"i-am-gm":i}),zie=t=>({rotateble:t}),Hie=(t,n)=>({overlay:t,horizontal:n});function Vie(t,n){if(1&t){const e=Le();p(0,"button",11),he("dblclick",function(r){return V(e),H(v().notOperaion(r))})("click",function(r){return V(e),H(v().toggleRotate(r))}),p(1,"i",12),y(2,"pivot_table_chart"),g()()}}function jie(t,n){if(1&t){const e=Le();p(0,"button",13),he("dblclick",function(r){return V(e),H(v().notOperaion(r))})("click",function(r){return V(e),H(v().toggleMinimize(r))}),p(1,"i",14),y(2),g()()}if(2&t){const e=v();h(),je("font-size",e.isMinimized?12:14,"px"),h(),Xe(e.isMinimized?"crop_din":"minimize")}}function Gie(t,n){if(1&t){const e=Le();p(0,"button",13),he("dblclick",function(r){return V(e),H(v().notOperaion(r))})("click",function(r){return V(e),H(v().toggleFullScreen(r))}),p(1,"i",14),y(2),g()()}if(2&t){const e=v();h(),je("font-size",e.isFullScreen&&!e.isMinimized?12:14,"px"),h(),Xe(e.isFullScreen?e.isMinimized?"minimize":"crop_din":"fullscreen")}}function Wie(t,n){if(1&t){const e=Le();p(0,"button",13),he("dblclick",function(r){return V(e),H(v().notOperaion(r))})("click",function(r){return V(e),H(v().close(r))}),p(1,"i",12),y(2,"close"),g()()}}let y5=(()=>{class t{set title(e){this.panelService.title=e}set left(e){this.panelService.left=e}set top(e){this.panelService.top=e}set width(e){this.panelService.width=e}set height(e){this.panelService.height=e}set isAbleMinimizeButton(e){this.panelService.isAbleMinimizeButton=e}set isAbleFullScreenButton(e){this.panelService.isAbleFullScreenButton=e}set isAbleCloseButton(e){this.panelService.isAbleCloseButton=e}set isAbleRotateButton(e){this.panelService.isAbleRotateButton=e}get title(){return this.panelService.title}get left(){return this.panelService.left}get top(){return this.panelService.top}get width(){return this.panelService.width}get height(){return this.panelService.height}get isAbleMinimizeButton(){return this.panelService.isAbleMinimizeButton}get isAbleFullScreenButton(){return this.panelService.isAbleFullScreenButton}get isAbleCloseButton(){return this.panelService.isAbleCloseButton}get isAbleRotateButton(){return this.panelService.isAbleRotateButton}get isGMMode(){return!!Fe.myCursor&&Fe.myCursor.isGMMode}get isPointerDragging(){return this.pointerDeviceService.isDragging||this.pointerDeviceService.isTablePickGesture}constructor(e,i){this.panelService=e,this.pointerDeviceService=i,this.rotateEvent=new ei,this.showTitleButtons=!0,this.preLeft=0,this.preTop=0,this.preWidth=100,this.preHeight=100,this.horizontalWidth=1032,this.horizontalHeight=100,this.verticalWidth=0,this.verticalHeight=0,this.isMinimized=!1,this.isFullScreen=!1,this.isHorizontal=!1}ngOnInit(){this.panelService.scrollablePanel=this.scrollablePanel.nativeElement}toggleMinimize(e=null){e&&(e.stopPropagation(),e.preventDefault());const i=this.draggablePanel.nativeElement,r=this.scrollablePanel.nativeElement;if(i.style.transition="width 0.1s ease-in-out, height 0.1s ease-in-out",r.style.overflowY="hidden",setTimeout(()=>{i.style.transition=null,r.style.overflowY=null},100),!this.isMinimized&&!this.isFullScreen){const o=i.offsetWidth,s=i.offsetHeight;this.isHorizontal?(this.horizontalWidth=o,this.horizontalHeight=s):(this.verticalWidth=o,this.verticalHeight=s)}this.isMinimized=!this.isMinimized,this.isFullScreen=!1}toggleFullScreen(e=null){e&&(e.stopPropagation(),e.preventDefault());const i=this.draggablePanel.nativeElement,r=this.scrollablePanel.nativeElement;if(i.style.transition="width 0.1s ease-in-out, height 0.1s ease-in-out",r.style.overflowY="hidden",setTimeout(()=>{i.style.transition=null,r.style.overflowY=null},100),!this.isMinimized&&!this.isFullScreen){const o=i.offsetWidth,s=i.offsetHeight;this.isHorizontal?(this.horizontalWidth=o,this.horizontalHeight=s):(this.verticalWidth=o,this.verticalHeight=s)}this.isFullScreen=!this.isFullScreen}toggleRotate(e=null){e&&(e.stopPropagation(),e.preventDefault());const i=this.draggablePanel.nativeElement,r=this.scrollablePanel.nativeElement;i.style.transition="width 0.1s ease-in-out, height 0.1s ease-in-out",r.style.overflowY="hidden",setTimeout(()=>{i.style.transition=null,r.style.overflowY=null},500);const o=i.offsetWidth,s=i.offsetHeight;return this.isHorizontal?(this.isHorizontal=!1,i.style.width=(this.verticalWidth<100?100:this.verticalWidth)+"px",i.style.height=(this.verticalHeight<100?100:this.verticalHeight)+"px",!this.isMinimized&&!this.isFullScreen&&(this.horizontalWidth=o,this.horizontalHeight=s)):(this.isHorizontal=!0,i.style.width=(this.horizontalWidth<100?100:this.horizontalWidth)+"px",i.style.height=(this.horizontalHeight<100?100:this.horizontalHeight)+"px",!this.isMinimized&&!this.isFullScreen&&(this.verticalWidth=o,this.verticalHeight=s)),this.isMinimized=!1,this.isFullScreen=!1,this.rotateEvent.emit(this.isHorizontal),!1}close(e=null){e&&(e.stopPropagation(),e.preventDefault()),this.panelService&&this.panelService.close()}notOperaion(e=null){return e&&(e.stopPropagation(),e.preventDefault()),!1}static#e=this.\u0275fac=function(i){return new(i||t)(Y(yi),Y(lr))};static#t=this.\u0275cmp=In({type:t,selectors:[["ui-panel"]],viewQuery:function(i,r){if(1&i&&(Ln(Fie,7),Ln(Nie,7),Ln(Rie,7,xa),Ln(Lie,7)),2&i){let o;Bn(o=Un())&&(r.draggablePanel=o.first),Bn(o=Un())&&(r.scrollablePanel=o.first),Bn(o=Un())&&(r.content=o.first),Bn(o=Un())&&(r.titleBar=o.first)}},inputs:{title:"title",left:"left",top:"top",width:"width",height:"height",isAbleMinimizeButton:"isAbleMinimizeButton",isAbleFullScreenButton:"isAbleFullScreenButton",isAbleCloseButton:"isAbleCloseButton",isAbleRotateButton:"isAbleRotateButton",showTitleButtons:"showTitleButtons"},outputs:{rotateEvent:"rotateEvent"},features:[br([yi])],ngContentSelectors:Bie,decls:16,vars:34,consts:[["draggablePanel",""],["titleBar",""],["scrollablePanel",""],["content",""],["appDraggable","","appResizable","",1,"draggable-panel",3,"ngClass","resizable.disable","resizable.align","draggable.disable","draggable.stack","resizable.stack"],[1,"title",3,"dblclick"],["style","padding: 0px; height: 14px; margin-top: 3px; margin-left: 1px",3,"dblclick","click",4,"ngIf"],[3,"ngClass"],[1,"title-button"],[3,"dblclick","click",4,"ngIf"],[1,"scrollable-panel",3,"ngClass"],[2,"padding","0px","height","14px","margin-top","3px","margin-left","1px",3,"dblclick","click"],[1,"material-icons",2,"font-size","14px"],[3,"dblclick","click"],[1,"material-icons"]],template:function(i,r){if(1&i){const o=Le();h2(),p(0,"div",4,0)(2,"div",5,1),he("dblclick",function(a){return V(o),H(r.isFullScreen?r.toggleFullScreen(a):r.toggleMinimize(a))}),q(4,Vie,3,0,"button",6),p(5,"div",7),y(6),g(),p(7,"div",8),q(8,jie,3,3,"button",9)(9,Gie,3,3,"button",9)(10,Wie,3,0,"button",9),g()(),p(11,"div",10,2),f2(13),Ge(14,"div",null,3),g()()}2&i&&(je("left",r.left,"px")("top",r.top,"px")("width",r.width,"px")("height",r.height,"px"),m("@flyInOut","in")("ngClass",Ja(24,Uie,r.isPointerDragging,r.isFullScreen,r.isMinimized&&!r.isFullScreen,r.isGMMode))("resizable.disable",r.isMinimized||r.isFullScreen)("resizable.align",r.isAbleRotateButton?r.isHorizontal?"horizontal":"vertical":"normal")("draggable.disable",r.isFullScreen)("draggable.stack",".draggable-panel")("resizable.stack",".draggable-panel"),h(4),m("ngIf",r.isAbleRotateButton),h(),m("ngClass",Ke(29,zie,r.isAbleRotateButton)),h(),Xe(r.panelService.title),h(2),m("ngIf",r.isAbleMinimizeButton),h(),m("ngIf",r.isAbleFullScreenButton),h(),m("ngIf",r.isAbleCloseButton),h(),je("display",r.isMinimized&&!r.isFullScreen?"none":null),m("ngClass",Tn(31,Hie,r.isAbleRotateButton,r.isHorizontal)))},dependencies:[Ni,ri,JT,Pie],styles:["[_nghost-%COMP%]{display:block}.draggable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;color:#444;background:linear-gradient(-30deg,#f0dabde6,#fff4e8e6);border:solid 1px #999;padding:0;top:200px;height:200px;width:300px;max-height:100%;max-width:100%;cursor:grab}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;position:absolute;top:25px;bottom:0;width:100%;padding:8px;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;padding:2px 5px;width:100%;background-color:#555;color:#ccc;-webkit-user-select:none;user-select:none}.title-button[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#ccc}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}@media screen and (-webkit-min-device-pixel-ratio: 0){.scrollable-panel.overlay[_ngcontent-%COMP%]{overflow:overlay}}.scrollable-panel.horizontal[_ngcontent-%COMP%]{overflow-x:auto;overflow-y:hidden}.rotateble[_ngcontent-%COMP%]{display:inline;top:-3px;position:relative}.is-minimized[_ngcontent-%COMP%]{height:27px!important}.is-full-screen[_ngcontent-%COMP%]{left:0!important;top:0!important;width:100vw!important;height:100vh!important;cursor:default}.draggable-panel.is-full-screen[_ngcontent-%COMP%]{border:0px none}.draggable-panel.i-am-gm[_ngcontent-%COMP%]{background:linear-gradient(-30deg,#f0d0d0e6,#ffecece6)}"],data:{animation:[Xn("flyInOut",[an("void => *",[rn("100ms ease-out",En([We({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),We({transform:"scale(1.0, 1.0)",opacity:"1",offset:1})]))]),an("* => void",[rn(100,We({transform:"scale(0, 0)"}))])])]}})}return t})();const $ie=["standImageElement"],Yie=["dialogElement"],Zie=(t,n,e,i)=>({"is-can-be-gone":t,"is-ghostly":n,backyard:e,secret:i}),qie=t=>({transform:t}),Xie=t=>({inverse:t}),Kie=(t,n,e,i,r,o,s,a)=>({black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}),C5=(t,n)=>({"black-paint":t,hollow:n}),Qie=t=>({"emote-secret":t}),Jie=(t,n,e)=>({"is-can-be-gone":t,"is-ghostly":n,backyard:e}),ere=(t,n,e)=>({left:t,right:n,"transform-origin":e}),tre=(t,n,e,i,r,o)=>({"is-can-be-gone":t,"is-ghostly":n,backyard:e,"dialog-secret":i,"is-position-right":r,"is-position-left":o});function nre(t,n){if(1&t&&(p(0,"div",14),y(1),g()),2&t){const e=v(3);je("visibility",e.isShowStand&&e.isApplyDialog?"visible":"hidden")("width",e.imageWidth,"px")("font-size",e.imageWidth/4.5>16?e.imageWidth/4.5:16,"px")("color",e.color?e.color:"#444")("bottom",e.emoteCssBottom,"px"),m("@fadeAndScaleInOut",void 0)("ngClass",Ke(13,Qie,e.isSecret)),h(),Xe(e.gameCharacter.text)}}function ire(t,n){if(1&t){const e=Le();Ue(0),q(1,nre,2,15,"div",7),p(2,"div",8)(3,"div",9)(4,"div",10)(5,"div",11)(6,"img",12,0),Ut(8,"safe"),he("load",function(){return V(e),H(v(2).onImageLoad())}),g(),Ge(9,"img",13),Ut(10,"safe"),g()()()(),ze()}if(2&t){const e=v(2);h(),m("ngIf",!e.isBackyard&&e.isImageLoaded&&e.gameCharacter.isEmote),h(),m("ngStyle",Ke(22,qie,e.isApplyRoll?"rotate("+e.gameCharacter.roll+"deg)":"")),h(),m("ngClass",Ke(24,Xie,e.isApplyImageEffect&&e.gameCharacter.isInverse)),h(),m("ngClass",Yl(26,Kie,e.isApplyImageEffect&&0==e.gameCharacter.aura,e.isApplyImageEffect&&1==e.gameCharacter.aura,e.isApplyImageEffect&&2==e.gameCharacter.aura,e.isApplyImageEffect&&3==e.gameCharacter.aura,e.isApplyImageEffect&&4==e.gameCharacter.aura,e.isApplyImageEffect&&5==e.gameCharacter.aura,e.isApplyImageEffect&&6==e.gameCharacter.aura,e.isApplyImageEffect&&7==e.gameCharacter.aura)),h(2),je("display",e.isSpeakable&&e.isSpeaking?"none":"inline-block")("height",e.height>0?e.height+"vh":"auto"),m("src",zt(8,16,e.imageUrl,"resourceUrl"),bn)("ngClass",Tn(35,C5,e.isApplyImageEffect&&e.gameCharacter.isBlackPaint,e.isApplyImageEffect&&e.gameCharacter.isHollow)),h(3),je("display",e.isSpeakable&&e.isSpeaking?"inline-block":"none")("height",e.height>0?e.height+"vh":"auto"),m("src",zt(10,19,e.speakingImageUrl,"resourceUrl"),bn)("ngClass",Tn(38,C5,e.isApplyImageEffect&&e.gameCharacter.isBlackPaint,e.isApplyImageEffect&&e.gameCharacter.isHollow))}}function rre(t,n){if(1&t){const e=Le();p(0,"div",5),he("@standInOut.start",function(){return V(e),H(v().refleshImageUrls(!0))})("click",function(){V(e);const r=v();return r.toGhostly(),H(r.toBackyard())}),q(1,ire,11,41,"ng-container",6),g()}if(2&t){const e=v();je("left",e.position+"%")("height",0==e.height?"":e.height+"vh")("margin-left",-e.imageWidth/2,"px")("margin-bottom",e.adjustY,"px"),m("@standInOut",e.groupValue)("ngClass",Ja(11,Zie,e.isCanBeGone,e.isGhostly,e.isBackyard,e.isSecret)),h(),m("ngIf",e.gameCharacter&&e.imageUrl&&e.imageUrl.length>0)}}function ore(t,n){if(1&t&&(p(0,"span",15)(1,"b"),y(2),g()()),2&t){const e=v();je("color",e.color?e.color:"#444")("left",e.position+"%")("margin-bottom",e.adjustY>0?e.adjustY:0,"px")("border-color",e.color?e.color:"#444")("margin-left",e.nameTagCSSMarginLeft,"px"),m("ngClass",Qs(12,Jie,e.isCanBeGone,e.isGhostly,e.isBackyard)),h(2),Xe(e.gameCharacter.name)}}function sre(t,n){if(1&t&&(p(0,"span",20),Ge(1,"img",21),Ut(2,"safe"),g()),2&t){const e=v(2);h(),je("border-color",e.color),m("src",zt(2,3,e.dialogFaceIcon.url,"resourceUrl"),bn)}}function are(t,n){if(1&t){const e=Le();p(0,"div",16,1),he("click",function(){V(e);const r=v();return r.toGhostly(),H(r.toBackyard())}),p(2,"p",17),he("@dialogShake.start",function(r){return V(e),H(v().onSpeaking(r))}),q(3,sre,3,6,"span",18),Ge(4,"span",19),Ut(5,"safe"),g()()}if(2&t){const e=v();je("visibility",e.isShowStand&&e.isApplyDialog?"visible":"hidden")("color",e.isSecret?"#ccc":e.color?e.color:"#444")("left",e.dialogBoxCSSLeft,"px")("bottom",e.dialogBoxCssBottom>12?e.dialogBoxCssBottom:12,"px")("max-width",e.dialogBoxCSSMaxWidth,"px")("border-color",e.color?e.color:"#444"),m("@fadeAndScaleInOut",void 0)("ngStyle",Qs(21,ere,e.position<=50?e.dialogBoxCSSLeft+"px":"auto",e.position>50?e.dialogBoxCSSRight+"px":"auto",e.position<=50?"12px calc(100% + 12px)":"calc(100% - 12px) calc(100% + 12px)"))("ngClass",y2(25,tre,e.isCanBeGone,e.isGhostly,e.isBackyard,e.isSecret,e.position<=50,e.position>50)),h(2),m("@dialogShake",e.math.floor(e.dialogText.length/2)),h(),m("ngIf",!e.gameCharacter.isEmote&&e.isUseFaceIcon&&0<(null==e.dialogFaceIcon?null:e.dialogFaceIcon.url.length)),h(),m("innerHTML",zt(5,18,e.dialogText,"html"),$r)}}let Wc=(()=>{class t{static#e=this.isShowStand=!0;static#t=this.isShowNameTag=!0;static#n=this.isCanBeGone=!0;constructor(e){this.ngZone=e,this.isFarewell=!1,this.isGhostly=!1,this.isBackyard=!1,this.isVisible=!1,this.isSecret=!1,this.isImageLoaded=!1,this.naturalWidth=0,this.naturalHeight=0,this.isSpeaking=!1,this.math=Math,this._imageUrl=vn.Empty.url}onSpeaking(e){this.gameCharacter&&this.gameCharacter.text&&(this.isApplyDialog||this.isSpeakable||this.gameCharacter.isShowChatBubble)&&(clearTimeout(this._timeoutId),this._timeoutId=setTimeout(()=>{this.ngZone.run(()=>{this.isVisible=!1})},12e3)),this.isSpeakable&&!this.gameCharacter.isEmote&&(clearTimeout(this._dialogTimeoutId),this.gameCharacter&&this.gameCharacter.text&&(this.isSpeaking||this.refleshSpeakingImageUrl(),this.isSpeaking=!0),this._dialogTimeoutId=setTimeout(()=>{this.ngZone.run(()=>{this.isSpeaking=!1})},300))}get imageUrl(){return this._imageUrl}get speakingImageUrl(){return this._speakingImageUrl?this._speakingImageUrl:this._imageUrl}get isShowStand(){return t.isShowStand}get isShowNameTag(){return t.isShowNameTag&&this.isShowName}get isCanBeGone(){return t.isCanBeGone}set dialog(e){if(!this.gameCharacter||"table"===this.gameCharacter.location.name&&!this.gameCharacter.isHideIn||"graveyard"===this.gameCharacter.location.name)return;clearTimeout(this._dialogTimeoutId);let i=ke.cr(e.text);const r=ke.isEmote(i),o=[],s=/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g;let a,c=0,u=0;if(!r)for(i=i.replace(/[\u3002\u3001]{3}/g,"\u2026").replace(/[\u3002\u3001]{2}/g,"\u2025").replace(/(\u3002|[\r\n]{2,})/g,"$1                            ").trimEnd();null!==(a=s.exec(i));){let K=a.index-3*c;o.push({base:a[1],ruby:a[2],start:K-u,end:K+a[1].length-u-1}),c++,u+=a[2].length}let f=1e3/Array.from(i).length>36?1e3/Array.from(i).length:36;f>200&&(f=200),this._dialogTimeoutId=setTimeout(()=>{this.gameCharacter.dialog=null,this.gameCharacter.text="",this.gameCharacter.isEmote=!1},Array.from(i).length*f+6e3),this.gameCharacter.dialog=e,this.gameCharacter.isEmote=r,c=0;let b=0,C=0,x="",M=o.shift(),U="",W=!1;if(r)this.gameCharacter.text=i;else{const K=Array.from(i.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a.+?\u300b/g,"$1"));this._chatIntervalId=setInterval(()=>{let $=K[c],ge=$.length>1;if($){if(!W&&M&&b>=M.start&&(x+="<ruby>",W=!0,C=0),x+=ke.escapeHtml($),W){C+=1;let ye=M.ruby;U="<rt>"+ke.escapeHtml(Array.from(ye).slice(0,Math.ceil(Array.from(ye).length*(C/Array.from(M.base).length))).join(""))+"</rt>"}W&&M&&b>=M.end-(ge?1:0)&&(x+=U+"</ruby>",W=!1,M=o.shift()),b+=$.length}c+=1,this.gameCharacter.text=x+(W?U+"</ruby>":""),c>=K.length&&clearInterval(this._chatIntervalId)},f)}}get dialog(){return this.gameCharacter?this.gameCharacter.dialog:null}get dialogText(){return this.gameCharacter&&this.gameCharacter.text?this.gameCharacter.text.replace(/[\r\n]{2,}/g,"\n\n").replace(/                            /g,"").trim():""}get isSpeakable(){if(!this.standElement)return!1;let e=this.standElement.getFirstElementByName("speakingImageIdentifier");return e&&e.value&&e.value!==vn.Empty.identifier}get dialogFaceIcon(){return this.dialog&&this.dialog.faceIconIdentifier?on.instance.get(this.dialog.faceIconIdentifier):null}get isUseFaceIcon(){return this.dialog&&this.dialog.faceIconIdentifier}get isRubied(){return!(!this.gameCharacter||!this.gameCharacter.text)&&-1<this.dialogText.indexOf("<ruby>")}ngOnInit(){ne.register(this).on("POPUP_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&this.ngZone.run(()=>{this.dialog=e.data})}).on("FAREWELL_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&(this.ngZone.run(()=>{this.dialog=null,this.gameCharacter.text="",this.gameCharacter.isEmote=!1}),clearTimeout(this._dialogTimeoutId),clearInterval(this._chatIntervalId))}),this.refleshImageUrls()}refleshImageUrls(e=!1){const i=this.standElement.getFirstElementByName("imageIdentifier");if(e||!i||this._imageIdentifier!==i.value){e=!0;const r=this._imageUrl;if(i){const o=on.instance.get(i.value);this._imageUrl=o?o.state===Ri.COMPLETE?URL.createObjectURL(o.blob):o.url:vn.Empty.url}else this._imageUrl=vn.Empty.url;URL.revokeObjectURL(r),this._imageIdentifier=i&&i.value?i.value.toString():null}this.refleshSpeakingImageUrl(e)}refleshSpeakingImageUrl(e=!0){const i=this.standElement.getFirstElementByName("speakingImageIdentifier");if(e||!i||this._speakingImageIdentifier!==i.value){const r=this._speakingImageUrl;if(i){const o=on.instance.get(i.value);this._speakingImageUrl=o?o.state===Ri.COMPLETE?URL.createObjectURL(o.blob):o.url:null}else this._speakingImageUrl=null;URL.revokeObjectURL(r),this._speakingImageIdentifier=i&&i.value?i.value.toString():null}}ngOnDestroy(){clearTimeout(this._timeoutId),clearInterval(this._chatIntervalId),URL.revokeObjectURL(this._speakingImageUrl),URL.revokeObjectURL(this._imageUrl)}get group(){if(!this.gameCharacter)return"";let e=this.standElement.getFirstElementByName("name");return e.currentValue&&e.currentValue.toString().length>0?e.currentValue.toString():""}get groupValue(){let e=0;const i=this.group;for(let r=0;r<i.length;r++)e=(e<<5)-e+i.charCodeAt(r),e|=0;return e}get position(){if(!this.gameCharacter)return 0;let e=this.standElement.getFirstElementByName("position");return e&&e.currentValue?+e.value:this.gameCharacter.standList.position}get adjustY(){if(!this.gameCharacter)return 0;let e=this.standElement.getFirstElementByName("height");return this.imageHeight*(e&&e.currentValue?+e.currentValue:0)/100}get height(){if(!this.gameCharacter||!this.standElement)return 0;let e=this.standElement.getFirstElementByName("height");return e&&0!=+e.value||!this.gameCharacter.standList?e?+e.value:0:this.gameCharacter.standList.height}get imageHeight(){return 0==this.height?this.naturalHeight:document.documentElement.offsetHeight*this.height/100}get imageWidth(){return this.imageHeight*this.naturalWidth/this.naturalHeight}get dialogBoxCSSLeft(){return this.imageWidth*(this.position>50?.33:.66)-this.imageWidth/2-12+this.position*document.documentElement.clientWidth/100-(this.position>50?this.dialogBoxCSSMaxWidth:0)}get dialogBoxCSSRight(){return document.documentElement.clientWidth-this.dialogBoxCSSLeft-this.dialogBoxCSSMaxWidth}get dialogBoxCSSMaxWidth(){let e=this.imageWidth/document.documentElement.clientWidth;return e/=2,e<.14&&(e=.14),e*document.documentElement.clientWidth}get dialogBoxCssBottom(){let e=.66*this.imageHeight+this.adjustY;return e<48&&(e=48),this.dialogElement&&e>document.documentElement.offsetHeight-this.dialogElement.nativeElement.clientHeight&&(e=document.documentElement.offsetHeight-this.dialogElement.nativeElement.clientHeight),e}get emoteCssBottom(){let e=.66*this.imageHeight+(this.imageWidth/4.5>16?this.imageWidth/4.5:16);return e<0&&(e=0),e}get nameTagCSSMarginLeft(){let e=this.imageWidth/2-this.position*document.documentElement.clientWidth/100;return e<32&&(e=32),-this.imageWidth/2+e}get isApplyImageEffect(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("applyImageEffect");return!(!e||!e.value)}get isApplyRoll(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("applyRoll");return!(!e||!e.value)}get isApplyDialog(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("applyDialog");return!(!e||!e.value)}get isShowName(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("showName");return!(!e||!e.value)}toGhostly(){this.ngZone.run(()=>{this.isGhostly=!0})}toBackyard(){this.ngZone.run(()=>{this.isBackyard=!0})}toFront(){this.ngZone.run(()=>{this.isFarewell=!1,this.isGhostly=!1,this.isBackyard=!1,this.isVisible=!0}),clearTimeout(this._timeoutId),this._timeoutId=setTimeout(()=>{this.ngZone.run(()=>{this.isVisible=!1})},12e3)}toFarewell(){this.ngZone.run(()=>{this.isFarewell=!0,this.isVisible=!1}),clearTimeout(this._timeoutId),clearInterval(this._chatIntervalId)}onImageLoad(){this.naturalWidth=this.standImageElement.nativeElement.naturalWidth,this.naturalHeight=this.standImageElement.nativeElement.naturalHeight,this.isImageLoaded=!0}static#i=this.\u0275fac=function(i){return new(i||t)(Y(Pn))};static#r=this.\u0275cmp=In({type:t,selectors:[["stand-image"]],viewQuery:function(i,r){if(1&i&&(Ln($ie,5),Ln(Yie,5)),2&i){let o;Bn(o=Un())&&(r.standImageElement=o.first),Bn(o=Un())&&(r.dialogElement=o.first)}},inputs:{gameCharacter:"gameCharacter",standElement:"standElement",color:"color"},decls:4,vars:7,consts:[["standImageElement",""],["dialogElement",""],["class","stand-image-container",3,"left","height","margin-left","margin-bottom","ngClass","click",4,"ngIf"],["class","name-tag","style","pointer-events: none;",3,"color","ngClass","left","margin-bottom","border-color","margin-left",4,"ngIf"],["class","name-tag dialog chat-bubble-buyo","style","margin-left: 12px; min-width: 5em; white-space: pre-wrap; font-size: 14px; pointer-events: none;",3,"visibility","color","left","bottom","max-width","ngStyle","ngClass","border-color","click",4,"ngIf"],[1,"stand-image-container",3,"click","ngClass"],[4,"ngIf"],["class","emote chat-bubble-buyo","style","position: absolute; pointer-events: none; text-align: center; margin-top: -1em",3,"visibility","width","font-size","color","bottom","ngClass",4,"ngIf"],[2,"transform-origin","center 66%",3,"ngStyle"],[1,"inverser",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"color-filter"],["draggable","false",1,"stand-image",3,"load","src","ngClass"],["draggable","false",1,"stand-image",3,"src","ngClass"],[1,"emote","chat-bubble-buyo",2,"position","absolute","pointer-events","none","text-align","center","margin-top","-1em",3,"ngClass"],[1,"name-tag",2,"pointer-events","none",3,"ngClass"],[1,"name-tag","dialog","chat-bubble-buyo",2,"margin-left","12px","min-width","5em","white-space","pre-wrap","font-size","14px","pointer-events","none",3,"click","ngStyle","ngClass"],[2,"width","100%"],["class","face-icon-box is-3d",4,"ngIf"],[3,"innerHTML"],[1,"face-icon-box","is-3d"],[1,"face-icon","is-3d",3,"src"]],template:function(i,r){1&i&&(p(0,"div"),q(1,rre,2,16,"div",2)(2,ore,3,16,"span",3)(3,are,6,32,"div",4),g()),2&i&&(je("visibility",r.isShowStand&&r.isImageLoaded?"visible":"hidden")("pointer-events",r.isShowStand?"auto":"none"),h(),m("ngIf",!r.isFarewell&&(r.isVisible||!r.isCanBeGone)),h(),m("ngIf",r.isShowStand&&r.isImageLoaded&&!r.isFarewell&&(r.isVisible||!r.isCanBeGone)&&r.isShowNameTag&&r.gameCharacter&&r.gameCharacter.name),h(),m("ngIf",!r.isFarewell&&r.isImageLoaded&&r.isVisible&&!r.isBackyard&&r.gameCharacter&&r.gameCharacter.text&&!r.gameCharacter.isEmote))},dependencies:[Ni,ri,Lo,cr],styles:['.stand-image-container[_ngcontent-%COMP%]{position:absolute;display:inline-block;bottom:-.1%;z-index:1000000;transition:opacity .1s ease-in}.is-ghostly[_ngcontent-%COMP%]{z-index:900000}.is-can-be-gone.is-ghostly[_ngcontent-%COMP%]{opacity:.5;filter:brightness(.5)}.backyard[_ngcontent-%COMP%]{pointer-events:none;z-index:0}.name-tag[_ngcontent-%COMP%]{color:#444;background-color:#f5f5f5;border:2px solid #444;border-radius:24px;padding:4px 12px;bottom:2px;display:inline-block;white-space:nowrap;position:absolute;font-size:16px;opacity:.9;z-index:1000005}.name-tag.is-ghostly[_ngcontent-%COMP%]{z-index:900005}.is-can-be-gone.name-tag.is-ghostly[_ngcontent-%COMP%]{opacity:.5}.name-tag.backyard[_ngcontent-%COMP%]{z-index:1}.is-can-be-gone.is-ghostly.backyard[_ngcontent-%COMP%]{opacity:.25}.secret[_ngcontent-%COMP%]   .color-filter[_ngcontent-%COMP%]{filter:grayscale(80%)}.name-tag.dialog[_ngcontent-%COMP%]{border-radius:24px 24px 24px 12px}.name-tag.dialog-secret[_ngcontent-%COMP%]{border-radius:24px 12px;background:#555555e6}.name-tag.dialog.is-position-left[_ngcontent-%COMP%]{border-radius:24px 24px 12px}.name-tag.dialog.dialog-secret.is-position-left[_ngcontent-%COMP%]{border-radius:12px 24px}.emote[_ngcontent-%COMP%]{text-align:center;font-size:48px;font-weight:700;border:none;background:none;-webkit-text-stroke:2px whitesmoke;white-space:pre-wrap;word-break:break-word}.emote.emote-secret[_ngcontent-%COMP%]{-webkit-text-stroke:2px #555}.emote.emote-secret.is-ghostly[_ngcontent-%COMP%]{z-index:900005}.emote[_ngcontent-%COMP%]{z-index:1000005}.emote.is-ghostly[_ngcontent-%COMP%]{z-index:900005}.dialog[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{overflow-wrap:anywhere;word-break:break-word;display:inline-block;margin-top:.5em;margin-bottom:.5em}.dialog.is-position-right[_ngcontent-%COMP%]:after{box-sizing:border-box;content:"";position:absolute;padding:0;line-height:1;vertical-align:baseline;bottom:-25px;border:12px solid transparent;border-top-color:inherit;left:17px;margin:0 0 0 -12px}.dialog.is-position-left[_ngcontent-%COMP%]:before{box-sizing:border-box;content:"";position:absolute;margin:0 -12px 0 0;padding:0;line-height:1;vertical-align:baseline;bottom:-25px;border:12px solid transparent;border-top-color:inherit;right:17px}.chat-bubble-buyo[_ngcontent-%COMP%]{transition:transform .2s ease;animation:_ngcontent-%COMP%_chat-bubble-buyo 1.2s ease-in-out .1s infinite alternate;transform:scale3d(.9,.9,.9)}.chat-bubble-buyo.emote[_ngcontent-%COMP%]{animation-duration:.6s;transform-origin:center bottom}@keyframes _ngcontent-%COMP%_chat-bubble-buyo{0%{transform:scale3d(.9,.9,.9)}to{transform:scaleZ(1)}}.face-icon-box[_ngcontent-%COMP%]{display:block;position:relative;border:0px none;width:50px;height:50px;max-width:50px;max-height:50px;overflow:hidden;left:-24px;top:-32px;margin-right:-16px;margin-bottom:-32px;float:left}.face-icon-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%;border-radius:.5rem}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #fff)}'],data:{animation:[Xn("standInOut",[an("void => *,:increment,:decrement",[rn("132ms cubic-bezier(.21,.97,.75,1.25)",En([We({opacity:.6,transform:"translateY(48px) scale(0.9)",offset:0}),We({opacity:1,transform:"translateY(0px) scale(1.0)",offset:1})]))]),an("* => void,:increment,:decrement",[rn("132ms ease-out",En([We({transform:"translateY(0px) scale(1.0)",offset:0}),We({opacity:0,transform:"translateY(96px) scale(0.9)",offset:1})]))])]),Xn("dialogShake",[an(":increment",[rn("19ms ease",En([We({transform:"translateX(1px)"})])),rn("19ms ease",En([We({transform:"translateX(-1px)"})]))])]),Xn("fadeAndScaleInOut",[an("void => *, true => false",[rn("200ms ease-in-out",En([We({transform:"scale3d(0, 0, 0)",opacity:0}),We({transform:"scale3d(0.9, 0.9, 0.9)",opacity:.9})]))]),an("* => void, true => false",[rn("100ms ease-in-out",We({transform:"scale3d(0, 0, 0)",opacity:0}))])])]}})}return t})();class Bs{static#e=this.currentStandImageShowing=new Map;constructor(){}show(n,e,i=null,r=!1){let o=!0;for(const s of Bs.currentStandImageShowing){const a=s[0],c=s[1];if(!c)continue;const u=c.instance;u.isVisible&&n.identifier!=a?u.toGhostly():n.identifier==a&&"graveyard"!=n.location.name?(u.standElement=e,u.color=i||n.chatPalette.color,u.isSecret=r,u.refleshImageUrls(),u.toFront(),o=!1):(u.isFarewell||Wc.isCanBeGone)&&(c.destroy(),Bs.currentStandImageShowing.delete(a))}if(o&&"graveyard"!=n.location.name){const s=Bs.defaultParentViewContainerRef.createComponent(Wc);s.instance.gameCharacter=n,s.instance.standElement=e,s.instance.color=i||n.chatPalette.color,s.instance.isSecret=r,s.instance.refleshImageUrls(),s.instance.toFront(),Bs.currentStandImageShowing.set(n.identifier,s)}}farewell(n){n instanceof gn&&(n=n.identifier);const e=Bs.currentStandImageShowing.get(n);e&&e.instance&&e.instance.toFarewell()}destroy(n,e){n instanceof gn&&(n=n.identifier),e instanceof wt&&(e=e.identifier);for(const i of Bs.currentStandImageShowing){const r=i[1];r&&(!r.instance||!r.instance.standElement||r.instance.standElement.identifier==e)&&(r.destroy(),Bs.currentStandImageShowing.delete(n))}}destroyAll(){for(const n of Bs.currentStandImageShowing){const e=n[0],i=n[1];i&&(i.destroy(),Bs.currentStandImageShowing.delete(e))}}static#t=this.\u0275fac=function(e){return new(e||Bs)};static#n=this.\u0275prov=nn({token:Bs,factory:Bs.\u0275fac,providedIn:"root"})}const lre=["diceRollTableSelecter"],cre=t=>({"is-hidden":t});function ure(t,n){if(1&t&&(p(0,"option",9),y(1),g()),2&t){const e=n.$implicit;je("color",""==e.name?"gray":""),Et("value",e.identifier),Et("title",e.name),h(),Xe(""==e.name?"(\u7121\u540d\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868)":e.name)}}function dre(t,n){if(1&t&&(p(0,"div",25),y(1),g()),2&t){const e=v(3);h(),Si("",e.progresPercent,"%")}}function hre(t,n){if(1&t){const e=Le();Ue(0),p(1,"button",18),he("click",function(){return V(e),H(v(2).upTabIndex())}),y(2,"\u2191"),g(),p(3,"button",18),he("click",function(){return V(e),H(v(2).downTabIndex())}),y(4,"\u2193"),g(),p(5,"div",19)(6,"button",20),he("click",function(){return V(e),H(v(2).save())}),p(7,"div",21)(8,"div",22),y(9,"\u4fdd\u5b58"),g(),q(10,dre,2,1,"div",23),g()(),p(11,"button",24),he("click",function(){return V(e),H(v(2).delete())}),y(12,"\u524a\u9664"),g()(),ze()}if(2&t){const e=v(2);h(6),m("disabled",e.isSaveing),h(2),m("ngClass",Ke(3,cre,e.isSaveing)),h(2),m("ngIf",e.isSaveing)}}function fre(t,n){if(1&t){const e=Le();Ue(0),p(1,"button",18),he("click",function(){return V(e),H(v(2).restore())}),y(2,"\u5143\u306b\u623b\u3059"),g(),ze()}}function pre(t,n){if(1&t){const e=Le();Ue(0),p(1,"div",10)(2,"div",11)(3,"b"),y(4,"name: "),g(),p(5,"input",12),at("ngModelChange",function(r){V(e);const o=v();return it(o.diceRollTableName,r)||(o.diceRollTableName=r),H(r)}),g()(),p(6,"div")(7,"span",13)(8,"b"),y(9,"command: "),g(),p(10,"input",14),at("ngModelChange",function(r){V(e);const o=v();return it(o.diceRollTableCommand,r)||(o.diceRollTableCommand=r),H(r)}),g()(),p(11,"span",15)(12,"b"),y(13,"dice: "),g(),p(14,"input",16),at("ngModelChange",function(r){V(e);const o=v();return it(o.diceRollTableDice,r)||(o.diceRollTableDice=r),H(r)}),g()()()(),p(15,"div")(16,"textarea",17),at("ngModelChange",function(r){V(e);const o=v();return it(o.diceRollTableText,r)||(o.diceRollTableText=r),H(r)}),g()(),Ge(17,"hr"),p(18,"div"),q(19,hre,13,5,"ng-container",8)(20,fre,3,0,"ng-container",8),g(),ze()}if(2&t){const e=v();h(5),st("ngModel",e.diceRollTableName),en("disabled",e.isEditable?null:""),h(5),st("ngModel",e.diceRollTableCommand),en("disabled",e.isEditable?null:""),h(4),st("ngModel",e.diceRollTableDice),en("disabled",e.isEditable?null:""),h(2),st("ngModel",e.diceRollTableText),en("disabled",e.isEditable?null:""),h(3),m("ngIf",!e.isDeleted),h(),m("ngIf",e.isDeleted&&e.selectedDiceRollTableXml)}}function gre(t,n){if(1&t){const e=Le();Ue(0),p(1,"button",18),he("click",function(){return V(e),H(v(2).restore())}),y(2,"\u5143\u306b\u623b\u3059"),g(),ze()}}function mre(t,n){if(1&t&&(Ue(0),p(1,"div",26),y(2," \u203b\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u304c\u3042\u308a\u307e\u305b\u3093\u3002 "),q(3,gre,3,0,"ng-container",8),g(),ze()),2&t){const e=v();h(3),m("ngIf",e.isDeleted&&e.selectedDiceRollTableXml)}}let _re=(()=>{class t{get diceRollTableName(){return this.selectedDiceRollTable.name}set diceRollTableName(e){this.isEditable&&(this.selectedDiceRollTable.name=e)}get diceRollTableDice(){return this.selectedDiceRollTable.dice}set diceRollTableDice(e){this.isEditable&&(this.selectedDiceRollTable.dice=e)}get diceRollTableCommand(){return this.selectedDiceRollTable.command}set diceRollTableCommand(e){this.isEditable&&(this.selectedDiceRollTable.command=e)}get diceRollTableText(){return this.selectedDiceRollTable.value}set diceRollTableText(e){this.isEditable&&(this.selectedDiceRollTable.value=e)}get diceRollTables(){return Jl.instance.children}get isEmpty(){return this.diceRollTables.length<1}get isDeleted(){return!!this.selectedDiceRollTable&&null==bt.instance.get(this.selectedDiceRollTable.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}constructor(e,i,r,o){this.pointerDeviceService=e,this.modalService=i,this.panelService=r,this.saveDataService=o,this.selectedDiceRollTable=null,this.selectedDiceRollTableXml="",this.isSaveing=!1,this.progresPercent=0}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u8a2d\u5b9a"),ne.register(this).on("DELETE_GAME_OBJECT",1e3,e=>{if(!this.selectedDiceRollTable||e.data.identifier!==this.selectedDiceRollTable.identifier)return;let i=bt.instance.get(e.data.identifier);null!==i&&(this.selectedDiceRollTableXml=i.toXml())})}ngAfterViewInit(){this.diceRollTables.length>0&&queueMicrotask(()=>{this.onChangeDiceRollTable(this.diceRollTables[0].identifier),this.diceRollTableSelecter.nativeElement.selectedIndex=0})}ngOnDestroy(){ne.unregister(this)}onChangeDiceRollTable(e){this.selectedDiceRollTable=bt.instance.get(e),this.selectedDiceRollTableXml=""}create(e="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868"){return Jl.instance.addDiceRollTable(e)}add(){const e=this.create();queueMicrotask(()=>{this.onChangeDiceRollTable(e.identifier),this.diceRollTableSelecter.nativeElement.value=e.identifier})}save(){var e=this;return(0,L.A)(function*(){if(!e.selectedDiceRollTable||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i="fly_rollTable_"+e.selectedDiceRollTable.name;yield e.saveDataService.saveGameObjectAsync(e.selectedDiceRollTable,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}saveAll(){var e=this;return(0,L.A)(function*(){e.isSaveing||(e.isSaveing=!0,e.progresPercent=0,yield e.saveDataService.saveGameObjectAsync(Jl.instance,"fly_rollTable_All",i=>{e.progresPercent=i}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500))})()}delete(){!this.isEmpty&&this.selectedDiceRollTable&&(this.selectedDiceRollTableXml=this.selectedDiceRollTable.toXml(),this.selectedDiceRollTable.destroy())}restore(){if(this.selectedDiceRollTable&&this.selectedDiceRollTableXml){let e=ar.instance.parseXml(this.selectedDiceRollTableXml);Jl.instance.addDiceRollTable(e),this.selectedDiceRollTableXml="",queueMicrotask(()=>{const i=this.diceRollTables;this.onChangeDiceRollTable(i[i.length-1].identifier),this.diceRollTableSelecter.nativeElement.selectedIndex=i.length-1})}}upTabIndex(){if(!this.selectedDiceRollTable)return;let e=this.selectedDiceRollTable.parent,i=e.children.indexOf(this.selectedDiceRollTable);0<i&&e.insertBefore(this.selectedDiceRollTable,e.children[i-1])}downTabIndex(){if(!this.selectedDiceRollTable)return;let e=this.selectedDiceRollTable.parent,i=e.children.indexOf(this.selectedDiceRollTable);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.selectedDiceRollTable)}helpDiceRollTable(){let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(kf,{left:e.x,top:e.y,width:600,height:788});r.title="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u30d8\u30eb\u30d7",r.text="\u3000\u540d\u524d\u3001\u30b3\u30de\u30f3\u30c9\u3001\u632f\u308b\u30c0\u30a4\u30b9\u3092\u8a2d\u5b9a\u3057\u3001\u30c0\u30a4\u30b9\u306e\u6570\u5b57\u3067\u8868\u3092\u53c2\u7167\u3057\u3001\u8868\u793a\u3057\u307e\u3059\u3002\n\u3000\u30c1\u30e3\u30c3\u30c8\u3067\u30b3\u30de\u30f3\u30c9\u3092\u9001\u4fe1\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3068\u540c\u69d8\u306b\u7d50\u679c\u304c\u9001\u4fe1\u3055\u308c\u307e\u3059\u3002\n\u3000\u8868\u306f1\u884c\u3054\u3068\u306b\u6570\u5b57\u3068\u7d50\u679c\u3092:\uff08\u30b3\u30ed\u30f3\uff09\u3067\u533a\u5207\u308a\u300c\u6570\u5b57:\u7d50\u679c\u300d\u306e\u5f62\u3067\u8a18\u8ff0\u3057\u307e\u3059\uff08\u3088\u3063\u3066\u3001\u30c0\u30a4\u30b9\u306f\u6700\u5f8c\u306b\u4e00\u3064\u306e\u6570\u5b57\u3092\u8fd4\u3059\u3082\u306e\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3001\u30d0\u30e9\u30d0\u30e9\u30c0\u30a4\u30b9 nBm\u3001\u500b\u6570\u632f\u308a\u8db3\u3057\u30c0\u30a4\u30b9 nRm\u3001\u4e0a\u65b9\u7121\u9650\u30ed\u30fc\u30eb nUm \u306e\u6210\u529f\u6570\u306b\u3082\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\uff09\u3002\n\u3000\n\u3000-\uff08\u30cf\u30a4\u30d5\u30f3\uff09\u307e\u305f\u306f\uff5e\u3067\u533a\u5207\u3063\u3066\u6570\u5b57\u306e\u7bc4\u56f2\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\u3000\u8868\u306b \\n \u3068\u66f8\u304f\u3068\u3001\u305d\u3053\u3067\u6539\u884c\u3057\u307e\u3059\uff08\\n\u306f\u8868\u793a\u3055\u308c\u307e\u305b\u3093\uff09\u3002\n\n\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u4f8b\uff09\n\u3000name: \u906d\u9047\u8266\u7a2e\u3000\n\u3000command: ShipType\u3000\u3000dice: 1d6\n\n\u3000\u30001:\u6226\u8266\n\u3000\u30002:\u7a7a\u6bcd\n\u3000\u30003:\u91cd\u5de1\u6d0b\u8266\n\u3000\u30004:\u8efd\u5de1\u6d0b\u8266\n\u3000\u30005-6:\u99c6\u9010\u8266\n\n\u3000\u8868\u3092\u53c2\u7167\u3059\u308b\u969b\u306f\u5148\u306b\u3042\u308b\u3082\u306e\u304c\u512a\u5148\u3055\u308c\u307e\u3059\u3001\u4e0a\u8a18\u306e\u4f8b\u3067\u306f\u6700\u5f8c\u306e\u884c\u3092\u300c1-6:\u99c6\u9010\u8266\u300d\u306a\u3069\u3068\u3057\u3066\u3082\u540c\u3058\u7d50\u679c\u306b\u306a\u308a\u307e\u3059\uff08\u304c\u3001\u5206\u304b\u308a\u3084\u3059\u3044\u8a18\u8ff0\u3092\u304a\u52e7\u3081\u3057\u307e\u3059\uff09\u3002\n\u3000\u30c7\u30d5\u30a9\u30eb\u30c8\u306e D66 \u306f\u30bd\u30fc\u30c8\u3055\u308c\u307e\u305b\u3093\u306e\u3067\u3001\u5fc5\u8981\u306a\u5834\u5408\uff08\u30b5\u30a4\u30b3\u30ed\u30fb\u30d5\u30a3\u30af\u30b7\u30e7\u30f3\u306e\u540d\u524d\u8868\u306a\u3069\uff09\u306f\u3001 D66S \u3068\u3057\u3066\u30bd\u30fc\u30c8\u3057\u305f\u6570\u5b57\u3092\u5f97\u3066\u304f\u3060\u3055\u3044\u3002\n\u3000\u6570\u5b57\u306e\u8a18\u8ff0\u306e\u969b *\uff08\u30a2\u30b9\u30bf\u30ea\u30b9\u30af\uff09\u3092\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\uff08\u4efb\u610f\u306e\u6570\u5b57\uff09\u3068\u3057\u3066\u4f7f\u7528\u53ef\u80fd\u3067\u3059\u3001\u4f8b\u3048\u3070 *-1 \u3068\u3059\u308c\u30701\u4ee5\u4e0b\u30016-* \u3068\u3059\u308c\u30706\u4ee5\u4e0a\u306e\u4efb\u610f\u306e\u6570\u5b57\u3067\u3059\uff08*\u5358\u72ec\u306f\u3059\u3079\u3066\u306e\u6570\u5b57\u3068\u306a\u308a\u3001\u5148\u306b\u3042\u308b\u3082\u306e\u304b\u3089\u53c2\u7167\u3055\u308c\u307e\u3059\u306e\u3067\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u9014\u4e2d\u306e\u884c\u306b\u66f8\u3044\u305f\u5834\u5408\u305d\u308c\u3088\u308a\u5148\u306e\u884c\u304c\u53c2\u7167\u3055\u308c\u306a\u304f\u306a\u308a\u307e\u3059\uff09\u3002\u5f8c\u8ff0\u306e\u4fee\u6b63\u306b\u3088\u308a\u8868\u304b\u3089\u306f\u307f\u51fa\u3057\u3066\u3082\u7d50\u679c\u3092\u5f97\u3089\u308c\u308b\u3088\u3046\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u3000\u30c1\u30e3\u30c3\u30c8\u304b\u3089\u306e\u30b3\u30de\u30f3\u30c9\u306e\u969b\u3001\u5168\u89d2\u534a\u89d2\u3001\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u306e\u5927\u6587\u5b57\u5c0f\u6587\u5b57\u306f\u7121\u8996\u3055\u308c\u307e\u3059\u3002\u307e\u305f\u30c0\u30a4\u30b9\u306b\u4fee\u6b63\u3092\u8db3\u3057\u5f15\u304d\u3059\u308b\u3001\u3042\u308b\u3044\u306f\u4efb\u610f\u306e\u6570\u5b57\u3067\u53c2\u7167\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\u30b3\u30de\u30f3\u30c9\u306e\u5f8c\u306b +\u4fee\u6b63\u5024 \u307e\u305f\u306f -\u4fee\u6b63\u5024 \u3092\u8a18\u8ff0\u3059\u308b\u3053\u3068\u3067\u632f\u3089\u308c\u305f\u30c0\u30a4\u30b9\u306e\u6570\u5b57\u3092\u4fee\u6b63\u3057\u307e\u3059\u3002\u307e\u305f =\u6307\u5b9a\u5024 \u3068\u8a18\u8f09\u3059\u308b\u3053\u3068\u3067\u3001\u305d\u306e\u6570\u5b57\u3067\u30b3\u30de\u30f3\u30c9\u306b\u5bfe\u5fdc\u3059\u308b\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u3092\u53c2\u7167\u3057\u307e\u3059\u3002\u4fee\u6b63\u5024\u3001\u6307\u5b9a\u5024\u306f\u4efb\u610f\u306e\u6574\u6570\u3067\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\u306e\u4f8b\uff09\n\u3000ShipType=3\n\u3000\u524d\u8ff0\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u4f8b\u300c\u906d\u9047\u8266\u7a2e\u300d\u3092\u6570\u5b573\u6307\u5b9a\u3067\u53c2\u7167\u3057\u307e\u3059\u3001\u7d50\u679c\u300c\u91cd\u5de1\u6d0b\u8266\u300d\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\u3082\u3057\u30011\u672a\u6e80\u30846\u3092\u8d85\u3048\u308b\u6570\u5b57\u3092\u6307\u5b9a\u3057\u305f\u5834\u5408\u300c\uff08\u7d50\u679c\u306a\u3057\uff09\u300d\u3068\u306a\u308b\u3067\u3057\u3087\u3046\u3002\n\n\u3000ShipType+2\n\u3000\u524d\u8ff0\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u4f8b\u300c\u906d\u9047\u8266\u7a2e\u300d\u30921d6\u306e\u7d50\u679c\u306b+2\u3057\u305f\u6570\u5b57\u3067\u53c2\u7167\u3057\u307e\u3059\u3002\u300c\u906d\u9047\u8266\u7a2e\u300d\u306b\u306f7\u4ee5\u964d\u306e\u8a18\u8f09\u304c\u3042\u308a\u307e\u305b\u3093\u3001\u305d\u306e\u5834\u5408\u300c\uff08\u7d50\u679c\u306a\u3057\uff09\u300d\u3068\u306a\u308b\u3067\u3057\u3087\u3046\u3001\u305d\u308c\u3092\u907f\u3051\u305f\u3044\u5834\u5408\u306f\u524d\u8ff0\u306e\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9 * \u3092\u4f7f\u7528\u3057\u307e\u3059\u3002"}static#e=this.\u0275fac=function(i){return new(i||t)(Y(lr),Y(Ei),Y(yi),Y(ll))};static#t=this.\u0275cmp=In({type:t,selectors:[["dice-roll-table-setting"]],viewQuery:function(i,r){if(1&i&&Ln(lre,5),2&i){let o;Bn(o=Un())&&(r.diceRollTableSelecter=o.first)}},decls:13,vars:3,consts:[["diceRollTableSelecter",""],[1,"flex-container"],[1,"flex-item","no-grow"],[2,"margin","0px 0px 2px 0px","font-size","smaller",3,"click"],["size","15",2,"width","14em",3,"change"],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[2,"float","right","cursor","help",3,"click"],[4,"ngIf"],[3,"value","title"],[2,"font-size","smaller"],[2,"margin-bottom","3px"],["placeholder","Name",2,"width","60%","min-width","5em",3,"ngModelChange","ngModel"],[2,"white-space","nowrap"],["placeholder","Command",2,"width","7em",3,"ngModelChange","ngModel"],[2,"white-space","nowrap","margin-left","1em"],["placeholder","Dice",2,"width","3.3em","text-align","center",3,"ngModelChange","ngModel"],["placeholder","1:\u6570\u5b57\u3068\u7d50\u679c\u3092:\uff08\u30b3\u30ed\u30f3\uff09\u3067\u533a\u5207\u3063\u3066\u8a18\u8ff0\r\n2:\u7d50\u679c\uff12\r\n3:\u7d50\u679c\uff13\r\n4:\u2026",2,"width","100%","height","20em","margin-top","3px","resize","vertical",3,"ngModelChange","ngModel"],[3,"click"],[2,"float","right"],[3,"click","disabled"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(i,r){if(1&i){const o=Le();p(0,"div",1)(1,"div",2)(2,"div")(3,"button",3),he("click",function(){return V(o),H(r.add())}),y(4,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u8ffd\u52a0"),g()(),p(5,"select",4,0),he("change",function(){V(o);const a=pn(6);return H(r.onChangeDiceRollTable(a.value))}),q(7,ure,2,5,"option",5),g()(),p(8,"div",6)(9,"button",7),he("click",function(){return V(o),H(r.helpDiceRollTable())}),y(10,"?"),g(),q(11,pre,21,10,"ng-container",8),g()(),q(12,mre,4,1,"ng-container",8)}2&i&&(h(7),m("ngForOf",r.diceRollTables),h(4),m("ngIf",!r.isEmpty&&r.selectedDiceRollTable),h(),m("ngIf",r.isEmpty))},dependencies:[Ni,nr,ri,na,ia,kr,Or,Cr],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}"]})}return t})();const bre=["cutInSelecter"],vre=t=>({blackout:t}),yre=t=>({"red-eye":t}),x5=t=>({"not-specified":t}),Cre=(t,n)=>({color:t,"font-weight":n}),xre=t=>({"is-hidden":t});function wre(t,n){if(1&t&&(p(0,"option",11),y(1),g()),2&t){const e=n.$implicit;je("color",e.isValidAudio?""==e.name?"gray":"":"red"),Et("value",e.identifier),Et("title",e.name),h(),Xe((e.isPlayingNow?"\u25b6 ":"\u25a0 ")+(e.isValidAudio?"":"\u26a0\ufe0f")+(""==e.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":e.name))}}function Ere(t,n){if(1&t&&(p(0,"div",78)(1,"i",79),y(2),g()()),2&t){const e=v(2);h(),yg(e.isShowHideImages?"red-eye":"grow"),h(),Xe(e.isShowHideImages?"visibility":"visibility_off")}}function Ire(t,n){if(1&t){const e=Le();p(0,"button",38),he("click",function(){return V(e),H(v(3).openModal())}),p(1,"b"),y(2,"\u753b\u50cf\u5909\u66f4"),g()()}}function Tre(t,n){if(1&t&&(p(0,"div",80),q(1,Ire,3,0,"button",81),g()),2&t){const e=v(2);h(),m("ngIf",!e.cutInVideoId||e.cutInisSoundOnly)}}function Sre(t,n){if(1&t&&(p(0,"div",82)(1,"i",83),y(2),g()()),2&t){const e=v(2);h(2),Xe(e.cutInPlayListId?"featured_play_list":"movie")}}function Mre(t,n){1&t&&(Ue(0),y(1,"\uff08\u3042\u306a\u305f\uff09"),ze())}function Dre(t,n){if(1&t&&(p(0,"option",84),y(1),q(2,Mre,2,0,"ng-container",10),g()),2&t){const e=n.$implicit,i=v(2);je("color",e.color),Et("value",e.identifier),h(),Si("",e.name," "),h(),m("ngIf",e===i.myPeer)}}function kre(t,n){if(1&t&&(p(0,"option",85),y(1),g()),2&t){const e=n.$implicit;Et("value",e.identifier),h(),Xe(e.name)}}function Ore(t,n){1&t&&(p(0,"span",50)(1,"i",88),y(2,"check"),g(),p(3,"span",89),y(4,"Link OK"),g()())}function Are(t,n){if(1&t&&(p(0,"span",90),Ge(1,"i",91),p(2,"span",92),y(3,"\u26a0\ufe0fLink NG:"),g(),y(4),g()),2&t){const e=v(3);h(4),Si(" ",e.cutInAudioFileName,"")}}function Pre(t,n){if(1&t&&(Ue(0),q(1,Ore,5,0,"span",86)(2,Are,5,1,"span",87),ze()),2&t){const e=v(2);h(),m("ngIf",e.isValidAudio),h(),m("ngIf",!e.isValidAudio)}}function Fre(t,n){if(1&t&&(p(0,"div",98),y(1),g()),2&t){const e=v(3);h(),Si("",e.progresPercent,"%")}}function Nre(t,n){if(1&t){const e=Le();Ue(0),p(1,"button",38),he("click",function(){return V(e),H(v(2).upTabIndex())}),y(2,"\u2191"),g(),p(3,"button",38),he("click",function(){return V(e),H(v(2).downTabIndex())}),y(4,"\u2193"),g(),p(5,"div",20)(6,"button",93),he("click",function(){return V(e),H(v(2).save())}),p(7,"div",94)(8,"div",95),y(9,"\u4fdd\u5b58"),g(),q(10,Fre,2,1,"div",96),g()(),p(11,"button",97),he("click",function(){return V(e),H(v(2).delete())}),y(12,"\u524a\u9664"),g()(),ze()}if(2&t){const e=v(2);h(6),m("disabled",e.isSaveing),h(2),m("ngClass",Ke(3,xre,e.isSaveing)),h(2),m("ngIf",e.isSaveing)}}function Rre(t,n){if(1&t){const e=Le();Ue(0),p(1,"button",38),he("click",function(){return V(e),H(v(2).restore())}),y(2,"\u5143\u306b\u623b\u3059"),g(),ze()}}function Lre(t,n){if(1&t){const e=Le();Ue(0),p(1,"div",12)(2,"div")(3,"div",13),he("dblclick",function(){V(e);const r=v();return H(!(!r.isEditable||r.cutInVideoId&&!r.cutInisSoundOnly)&&r.openModal())}),q(4,Ere,3,3,"div",14)(5,Tre,2,1,"div",15)(6,Sre,3,1,"div",16),Ge(7,"img",17),Ut(8,"safe"),g()(),p(9,"div",18)(10,"div",19)(11,"div",20)(12,"label",21)(13,"input",22),he("click",function(r){return V(e),H(v().onShowHiddenImages(r))}),g(),p(14,"i",23),y(15),g()()()(),p(16,"div",24)(17,"b",25),y(18,"Name: "),g(),p(19,"input",26),at("ngModelChange",function(r){V(e);const o=v();return it(o.cutInName,r)||(o.cutInName=r),H(r)}),g(),p(20,"b",27),y(21,"Tag: "),g(),p(22,"input",28),at("ngModelChange",function(r){V(e);const o=v();return it(o.cutInTag,r)||(o.cutInTag=r),H(r)}),g()(),p(23,"div",29)(24,"b",25),y(25,"Duration (0=\u7121\u5236\u9650): "),g(),p(26,"input",30),at("ngModelChange",function(r){V(e);const o=v();return it(o.cutInDuration,r)||(o.cutInDuration=r),H(r)}),g(),p(27,"b",31),y(28,"sec."),g()(),p(29,"div",24)(30,"b",25),y(31,"Cut In: "),g(),p(32,"select",32),at("ngModelChange",function(r){V(e);const o=v();return it(o.cutInType,r)||(o.cutInType=r),H(r)}),p(33,"option",33),y(34,"\u5373\u6642\u51fa\u73fe"),g(),p(35,"option",33),y(36,"\u6d6e\u304d\u51fa\u308b"),g(),p(37,"option",33),y(38,"\u98db\u3073\u51fa\u3059"),g(),p(39,"option",33),y(40,"\u958b\u304f\uff08\u5de6\u53f3\uff09"),g(),p(41,"option",33),y(42,"\u958b\u304f\uff08\u4e0a\u4e0b\uff09"),g()(),p(43,"label",34)(44,"input",35),he("click",function(){V(e);const r=v();return H(r.borderStyle=0==r.borderStyle?1:0)}),g(),p(45,"b"),y(46,"\u67a0\u3042\u308a"),g()()(),p(47,"div",24)(48,"b",25),y(49,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e: "),g(),Ge(50,"br"),p(51,"textarea",36),at("ngModelChange",function(r){V(e);const o=v();return it(o.cutInCond,r)||(o.cutInCond=r),H(r)}),g()()()(),p(52,"div",37)(53,"div")(54,"button",38),he("click",function(){return V(e),H(v().testCutIn())}),p(55,"b"),y(56,"\u30c6\u30b9\u30c8 (\u81ea\u5206\u3060\u3051\u898b\u308b)"),p(57,"sup",39),y(58,"*"),g()()(),p(59,"span",40)(60,"button",41),he("click",function(){return V(e),H(v().playCutIn())}),p(61,"b")(62,"i",42),y(63,"play_arrow"),g(),y(64,"\u518d\u751f"),g()(),p(65,"button",43),he("click",function(){return V(e),H(v().stopCutIn())}),p(66,"b")(67,"i",42),y(68,"stop"),g(),y(69,"\u505c\u6b62"),g()(),p(70,"span",44),y(71," \u27a1 "),p(72,"select",45),at("ngModelChange",function(r){V(e);const o=v();return it(o.sendTo,r)||(o.sendTo=r),H(r)}),p(73,"option",46),y(74,"\u5168\u54e1"),g(),q(75,Dre,3,5,"option",47),g()()()(),p(76,"div",48)(77,"div")(78,"b",49),y(79,"\u4f4d\u7f6e"),g(),p(80,"label",50)(81,"input",51),at("ngModelChange",function(r){V(e);const o=v();return it(o.cutInIsPreventOutBounds,r)||(o.cutInIsPreventOutBounds=r),H(r)}),g(),p(82,"b"),y(83,"\u898b\u5207\u308c\u9632\u6b62"),g()()(),p(84,"div",52)(85,"div",53)(86,"div",54)(87,"b"),y(88,"PosX: "),g()(),p(89,"div",55)(90,"input",56),at("ngModelChange",function(r){V(e);const o=v();return it(o.cutInPosX,r)||(o.cutInPosX=r),H(r)}),g()(),p(91,"div",57)(92,"input",58),at("ngModelChange",function(r){V(e);const o=v();return it(o.cutInPosX,r)||(o.cutInPosX=r),H(r)}),g(),p(93,"b",24),y(94,"%"),g()()(),p(95,"div",53)(96,"div",54)(97,"b"),y(98,"PosY: "),g()(),p(99,"div",55)(100,"input",59),at("ngModelChange",function(r){V(e);const o=v();return it(o.cutInPosY,r)||(o.cutInPosY=r),H(r)}),g()(),p(101,"div",57)(102,"input",58),at("ngModelChange",function(r){V(e);const o=v();return it(o.cutInPosY,r)||(o.cutInPosY=r),H(r)}),g(),p(103,"b",24),y(104,"%"),g()()()(),p(105,"div",60)(106,"b"),y(107,"Z-Index (\u5927\u304d\u3044\u3082\u306e\u304c\u524d): "),g(),p(108,"input",58),at("ngModelChange",function(r){V(e);const o=v();return it(o.cutInZIndex,r)||(o.cutInZIndex=r),H(r)}),g(),p(109,"label",50)(110,"input",61),at("ngModelChange",function(r){V(e);const o=v();return it(o.cutInIsFrontOfStand,r)||(o.cutInIsFrontOfStand=r),H(r)}),g(),p(111,"b"),y(112,"\u30b9\u30bf\u30f3\u30c9\u306e\u524d\u9762\u306b\u8868\u793a"),g()()()(),p(113,"div",48)(114,"div")(115,"b",49),y(116,"\u30b5\u30a4\u30ba\uff08\u5e45\u3001\u9ad8\u3055\u5171\u306b0\u306e\u5834\u5408\u306f\u5143\u753b\u50cf\u306e\u307e\u307e\uff09"),g()(),p(117,"div",62)(118,"div",53)(119,"div",63)(120,"b"),y(121,"Width (0=\u6307\u5b9a\u306a\u3057): "),g()(),p(122,"div",64)(123,"input",65),at("ngModelChange",function(r){V(e);const o=v();return it(o.cutInWidth,r)||(o.cutInWidth=r),H(r)}),g()(),p(124,"div",57)(125,"input",58),at("ngModelChange",function(r){V(e);const o=v();return it(o.cutInWidth,r)||(o.cutInWidth=r),H(r)}),g(),p(126,"b",24),y(127,"%"),g()()(),p(128,"div",53)(129,"div",63)(130,"b"),y(131,"Height (0=\u6307\u5b9a\u306a\u3057): "),g()(),p(132,"div",64)(133,"input",66),at("ngModelChange",function(r){V(e);const o=v();return it(o.cutInHeight,r)||(o.cutInHeight=r),H(r)}),g()(),p(134,"div",57)(135,"input",58),at("ngModelChange",function(r){V(e);const o=v();return it(o.cutInHeight,r)||(o.cutInHeight=r),H(r)}),g(),p(136,"b",24),y(137,"%"),g()()()(),p(138,"div",60)(139,"b"),y(140,"\u5143\u753b\u50cf\u3068\u7e26\u6a2a\u6bd4\u304c\u7570\u306a\u308b\u5834\u5408: "),g(),p(141,"select",67),at("ngModelChange",function(r){V(e);const o=v();return it(o.objectFitType,r)||(o.objectFitType=r),H(r)}),p(142,"option",33),y(143,"\u4f38\u7e2e\u3059\u308b"),g(),p(144,"option",33),y(145,"\u5207\u308a\u53d6\u308b"),g()()()(),p(146,"div",48)(147,"div")(148,"b",49),y(149,"\u52b9\u679c\u97f3\u30fb\u52d5\u753b"),g(),p(150,"label",50)(151,"input",68),at("ngModelChange",function(r){V(e);const o=v();return it(o.cutInSEIsLoop,r)||(o.cutInSEIsLoop=r),H(r)}),g(),p(152,"b"),y(153,"\u7e70\u308a\u8fd4\u3057"),g()()(),p(154,"div",69)(155,"input",70),at("ngModelChange",function(r){V(e);const o=v();return it(o.cutInIsVideo,r)||(o.cutInIsVideo=r),H(r)}),g(),p(156,"label",71)(157,"b"),y(158,"\u97f3\u697d\u30d5\u30a1\u30a4\u30eb: "),g()(),p(159,"select",72,1),at("ngModelChange",function(r){V(e);const o=v();return it(o.cutInAudioIdentifier,r)||(o.cutInAudioIdentifier=r),H(r)}),he("change",function(){V(e);const r=pn(160);return H(v().onAudioFileChange(r.value))}),p(161,"option",46),y(162,"\u52b9\u679c\u97f3\u306a\u3057"),g(),q(163,kre,2,2,"option",73),g(),q(164,Pre,3,2,"ng-container",10),g(),p(165,"div",69)(166,"input",74),at("ngModelChange",function(r){V(e);const o=v();return it(o.cutInIsVideo,r)||(o.cutInIsVideo=r),H(r)}),g(),p(167,"label",71)(168,"b"),y(169,"\u52d5\u753bURL: "),g()(),p(170,"input",75),at("ngModelChange",function(r){V(e);const o=v();return it(o.cutInVideoURL,r)||(o.cutInVideoURL=r),H(r)}),g()(),p(171,"div",76)(172,"a",77),he("click",function(){return V(e),H(v().openYouTubeTerms())}),y(173,"YouTube \u5229\u7528\u898f\u7d04"),g()()()(),Ge(174,"hr"),p(175,"div"),q(176,Nre,13,5,"ng-container",10)(177,Rre,3,0,"ng-container",10),g(),ze()}if(2&t){const e=v();h(4),m("ngIf",(!e.cutInVideoId||e.cutInisSoundOnly)&&e.getHidden(e.cutInImage)),h(),m("ngIf",e.isEditable),h(),m("ngIf",e.cutInVideoId&&!e.cutInisSoundOnly),h(),m("ngClass",Ke(141,vre,(!e.cutInVideoId||e.cutInisSoundOnly)&&!e.isShowHideImages&&e.getHidden(e.cutInImage)))("src",zt(8,138,e.cutInImageUrl,"resourceUrl"),bn),h(6),Et("checked",e.isShowHideImages?"checked":""),h(),m("ngClass",Ke(143,yre,e.isShowHideImages)),h(),Xe(e.isShowHideImages?"visibility":"visibility_off"),h(4),st("ngModel",e.cutInName),en("disabled",e.isEditable?null:""),h(3),st("ngModel",e.cutInTag),en("disabled",e.isEditable?null:""),h(4),st("ngModel",e.cutInDuration),en("disabled",!e.isEditable||e.isPlaying?"":null),h(6),st("ngModel",e.cutInType),en("disabled",e.isEditable?null:""),h(),m("value",-1)("selected",-1==e.cutInType),h(2),m("value",0)("selected",0==e.cutInType),h(2),m("value",1)("selected",1==e.cutInType),h(2),m("value",2)("selected",2==e.cutInType),h(2),m("value",3)("selected",3==e.cutInType),h(2),je("cursor",e.isEditable?"pointer":"default"),h(),m("checked",1==e.borderStyle),en("disabled",e.isEditable?null:""),h(7),st("ngModel",e.cutInCond),en("disabled",e.isEditable?null:""),h(3),en("disabled",e.isEditable?null:""),h(6),en("disabled",e.isEditable?null:""),h(5),en("disabled",e.isEditable?null:""),h(7),st("ngModel",e.sendTo),m("ngClass",Ke(145,x5,""==e.sendTo))("ngStyle",Tn(147,Cre,""==e.sendTo?null:e.sendToColor,""==e.sendTo?"normal":"bolder")),h(3),m("ngForOf",e.otherPeers),h(5),je("cursor",e.isEditable?"pointer":"default"),h(),st("ngModel",e.cutInIsPreventOutBounds),m("checked",e.cutInIsPreventOutBounds)("value",!0),en("disabled",!e.isEditable||e.cutInVideoId?"":null),h(9),Et("min",e.minSize),Et("max",e.maxSize),st("ngModel",e.cutInPosX),m("title",e.cutInPosX+"%"),en("disabled",e.isEditable?null:""),h(2),Et("min",e.minSize),Et("max",e.maxSize),st("ngModel",e.cutInPosX),en("disabled",e.isEditable?null:""),h(8),Et("min",e.minSize),Et("max",e.maxSize),st("ngModel",e.cutInPosY),m("title",e.cutInPosY+"%"),en("disabled",e.isEditable?null:""),h(2),Et("min",e.minSize),Et("max",e.maxSize),st("ngModel",e.cutInPosY),en("disabled",e.isEditable?null:""),h(6),Et("min",-e.maxSize),Et("max",e.maxSize),st("ngModel",e.cutInZIndex),en("disabled",!e.isEditable||e.cutInVideoId?"":null),h(2),st("ngModel",e.cutInIsFrontOfStand),m("checked",e.cutInIsFrontOfStand)("value",!0),en("disabled",!e.isEditable||e.cutInVideoId?"":null),h(13),Et("min",e.minSize),Et("max",e.maxSize),st("ngModel",e.cutInWidth),m("title",e.cutInWidth?e.cutInWidth+"%":"\u6307\u5b9a\u306a\u3057"),en("disabled",e.isEditable?null:""),h(2),Et("min",e.minSize),Et("max",2*e.maxSize),st("ngModel",e.cutInWidth),en("disabled",e.isEditable?null:""),h(8),Et("min",e.minSize),Et("max",e.maxSize),st("ngModel",e.cutInHeight),m("title",e.cutInHeight?e.cutInHeight+"%":"\u6307\u5b9a\u306a\u3057"),en("disabled",e.isEditable?null:""),h(2),Et("min",e.minSize),Et("max",2*e.maxSize),st("ngModel",e.cutInHeight),en("disabled",e.isEditable?null:""),h(6),st("ngModel",e.objectFitType),en("disabled",e.cutInVideoId&&!e.cutInisSoundOnly||!e.isEditable?"":null),h(),m("value",0)("selected",0==e.objectFitType),h(2),m("value",1)("selected",1==e.objectFitType),h(6),je("cursor",e.isEditable?"pointer":"default"),h(),st("ngModel",e.cutInSEIsLoop),m("checked",e.cutInSEIsLoop)("value",!0),en("disabled",!e.isEditable||e.isPlaying?"":null),h(4),go("name","",e.panelId,"-media"),go("id","",e.panelId,"-media-sound"),st("ngModel",e.cutInIsVideo),m("checked",!e.cutInIsVideo)("value",!1),en("disabled",!e.isEditable||e.isPlaying?"":null),h(),je("cursor",e.isEditable?"pointer":"default"),go("for","",e.panelId,"-media-sound"),h(3),je("min-width",e.isValidAudio?10:5,"em")("max-width",e.isValidAudio?20:5,"em"),st("ngModel",e.cutInAudioIdentifier),m("ngClass",Ke(150,x5,""==e.cutInAudioIdentifier)),en("disabled",e.cutInIsVideo||!e.isEditable||e.isPlaying?"":null),h(4),m("ngForOf",e.audios),h(),m("ngIf",e.isEditable&&e.cutInAudioFileName.length>0),h(2),go("name","",e.panelId,"-media"),go("id","",e.panelId,"-media-video"),st("ngModel",e.cutInIsVideo),m("checked",e.cutInIsVideo)("value",!0)("disabled",!e.isEditable||e.isPlaying?"":null),h(),je("cursor",e.isEditable?"pointer":"default"),go("for","",e.panelId,"-media-video"),h(3),st("ngModel",e.cutInVideoURL),m("disabled",e.cutInIsVideo&&e.isEditable&&!e.isPlaying?null:""),h(6),m("ngIf",!e.isDeleted),h(),m("ngIf",e.isDeleted&&e.selectedCutInXml)}}function Bre(t,n){if(1&t){const e=Le();Ue(0),p(1,"button",38),he("click",function(){return V(e),H(v(2).restore())}),y(2,"\u5143\u306b\u623b\u3059"),g(),ze()}}function Ure(t,n){if(1&t&&(Ue(0),p(1,"div",99),y(2," \u203b\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u3042\u308a\u307e\u305b\u3093\u3002 "),q(3,Bre,3,0,"ng-container",10),g(),ze()),2&t){const e=v();h(3),m("ngIf",e.isDeleted&&e.selectedCutInXml)}}let zre=(()=>{class t{get cutIns(){return tc.instance.cutIns}get cutInName(){return this.selectedCutIn.name}set cutInName(e){this.isEditable&&(this.selectedCutIn.name=e)}get cutInTag(){return this.selectedCutIn.tag}set cutInTag(e){this.isEditable&&(this.selectedCutIn.tag=e)}get cutInDuration(){return this.selectedCutIn.duration}set cutInDuration(e){this.isEditable&&(this.selectedCutIn.duration=e)}get cutInCond(){return this.selectedCutIn.value+""}set cutInCond(e){this.isEditable&&(this.selectedCutIn.value=e)}get cutInIsPreventOutBounds(){return this.selectedCutIn.isPreventOutBounds}set cutInIsPreventOutBounds(e){this.isEditable&&(this.selectedCutIn.isPreventOutBounds=e)}get cutInWidth(){return this.selectedCutIn.width}set cutInWidth(e){this.isEditable&&(this.selectedCutIn.width=e)}get cutInHeight(){return this.selectedCutIn.height}set cutInHeight(e){this.isEditable&&(this.selectedCutIn.height=e)}get objectFitType(){return this.selectedCutIn.objectFitType}set objectFitType(e){this.isEditable&&(this.selectedCutIn.objectFitType=e)}get cutInPosX(){return this.selectedCutIn.posX}set cutInPosX(e){this.isEditable&&(this.selectedCutIn.posX=e)}get cutInPosY(){return this.selectedCutIn.posY}set cutInPosY(e){this.isEditable&&(this.selectedCutIn.posY=e)}get cutInZIndex(){return this.selectedCutIn.zIndex}set cutInZIndex(e){this.isEditable&&(this.selectedCutIn.zIndex=e)}get cutInIsFrontOfStand(){return this.selectedCutIn.isFrontOfStand}set cutInIsFrontOfStand(e){this.isEditable&&(this.selectedCutIn.isFrontOfStand=e)}get cutInAudioIdentifier(){return this.selectedCutIn.audioIdentifier}set cutInAudioIdentifier(e){this.isEditable&&(this.selectedCutIn.audioIdentifier=e)}get cutInAudioFileName(){return this.selectedCutIn.audioFileName}set cutInAudioFileName(e){this.isEditable&&(this.selectedCutIn.audioFileName=e)}get cutInSEIsLoop(){return this.selectedCutIn.isLoop}set cutInSEIsLoop(e){this.isEditable&&(this.selectedCutIn.isLoop=e)}get cutInType(){return this.selectedCutIn.animationType}set cutInType(e){this.isEditable&&(this.selectedCutIn.animationType=e)}get borderStyle(){return this.selectedCutIn.borderStyle}set borderStyle(e){this.isEditable&&(this.selectedCutIn.borderStyle=e)}get isEmpty(){return this.cutIns.length<1}get isDeleted(){return!!this.selectedCutIn&&null==bt.instance.get(this.selectedCutIn.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}get cutInIsVideo(){return this.selectedCutIn.isVideoCutIn}set cutInIsVideo(e){this.isEditable&&(this.selectedCutIn.isVideoCutIn=e)}get cutInVideoURL(){return this.selectedCutIn.videoUrl}set cutInVideoURL(e){this.isEditable&&(this.selectedCutIn.videoUrl=e)}get cutInisSoundOnly(){return this.selectedCutIn.isSoundOnly}set cutInisSoundOnly(e){this.isEditable&&(this.selectedCutIn.isSoundOnly=e)}get cutInVideoId(){return this.selectedCutIn?this.selectedCutIn.videoId:""}get cutInPlayListId(){return this.cutInVideoId?this.selectedCutIn.playListId:""}get cutInImage(){return this.selectedCutIn&&on.instance.get(this.selectedCutIn.imageIdentifier)||vn.Empty}get cutInImageUrl(){return this.selectedCutIn?!this.selectedCutIn.videoId||this.cutInisSoundOnly?this.cutInImage.url:`https://img.youtube.com/vi/${this.selectedCutIn.videoId}/hqdefault.jpg`:vn.Empty.url}get isPlaying(){return!!this.selectedCutIn&&_C.nowShowingIdentifiers().includes(this.selectedCutIn.identifier)}get isValidAudio(){return!this.selectedCutIn||this.selectedCutIn.isValidAudio}get myPeer(){return Fe.myCursor}get otherPeers(){return bt.instance.getObjects(Fe)}get myColor(){return Fe.myCursor&&Fe.myCursor.color&&Fe.myCursor.color!=Fe.CHAT_TRANSPARENT_COLOR?Fe.myCursor.color:Fe.CHAT_DEFAULT_COLOR}get sendToColor(){let e=bt.instance.get(this.sendTo);return e instanceof Fe?e.color:Fe.CHAT_DEFAULT_COLOR}get audios(){return un.instance.audios.filter(e=>!e.isHidden)}constructor(e,i,r,o,s,a){this.changeDetector=e,this.pointerDeviceService=i,this.modalService=r,this.panelService=o,this.saveDataService=s,this.chatMessageService=a,this.minSize=0,this.maxSize=100,this.isShowHideImages=!1,this.selectedCutIn=null,this.selectedCutInXml="",this.sendTo="",this.isSaveing=!1,this.progresPercent=0}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30ab\u30c3\u30c8\u30a4\u30f3\u8a2d\u5b9a"),ne.register(this).on("SYNCHRONIZE_AUDIO_LIST",-1e3,e=>{this.onAudioFileChange()}),this.panelId=oa.generateUuid()}ngAfterViewInit(){queueMicrotask(()=>{this.cutIns.length>0&&(this.onChangeCutIn(this.cutIns[0].identifier),this.cutInSelecter.nativeElement.selectedIndex=0)})}ngOnDestroy(){ne.unregister(this)}onChangeCutIn(e){this.selectedCutIn=bt.instance.get(e),this.selectedCutInXml=""}create(e="\u30ab\u30c3\u30c8\u30a4\u30f3"){return tc.instance.addCutIn(e)}add(){const e=this.create();e.imageIdentifier="stand_no_image",queueMicrotask(()=>{this.onChangeCutIn(e.identifier),this.cutInSelecter.nativeElement.value=e.identifier})}save(){var e=this;return(0,L.A)(function*(){if(!e.selectedCutIn||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i="fly_cutIn_"+e.selectedCutIn.name;yield e.saveDataService.saveGameObjectAsync(e.selectedCutIn,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}delete(){this.selectedCutIn&&(ne.call("STOP_CUT_IN",{identifier:this.selectedCutIn.identifier}),this.isEmpty||(this.selectedCutInXml=this.selectedCutIn.toXml(),this.selectedCutIn.destroy()))}restore(){if(this.selectedCutIn&&this.selectedCutInXml){let e=ar.instance.parseXml(this.selectedCutInXml);tc.instance.addCutIn(e),this.selectedCutInXml="",queueMicrotask(()=>{const i=this.cutIns;this.onChangeCutIn(i[i.length-1].identifier),this.cutInSelecter.nativeElement.selectedIndex=i.length-1})}}getHidden(e){const i=ui.get(e.identifier);return!!i&&i.hide}upTabIndex(){if(!this.selectedCutIn)return;let e=this.selectedCutIn.parent,i=e.children.indexOf(this.selectedCutIn);0<i&&e.insertBefore(this.selectedCutIn,e.children[i-1])}downTabIndex(){if(!this.selectedCutIn)return;let e=this.selectedCutIn.parent,i=e.children.indexOf(this.selectedCutIn);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.selectedCutIn)}openModal(){if(this.isDeleted)return;let e=[];this.selectedCutIn&&this.selectedCutIn.imageIdentifier&&(e=[this.selectedCutIn.imageIdentifier]),this.modalService.open(Yc,{currentImageIdentifires:e}).then(i=>{!this.selectedCutIn||!i||(this.selectedCutIn.imageIdentifier=i)})}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(Fr,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:ur.OK_CANCEL,materialIcon:"visibility",action:()=>{this.chatMessageService.sendOperationLog("\u30ab\u30c3\u30c8\u30a4\u30f3\u8a2d\u5b9a \u304b\u3089\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u305f"),this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}playCutIn(){const e=this.selectedCutIn;if(!e)return;const i={identifier:e.identifier,secret:!!this.sendTo,sender:Fe.myCursor.peerId};if(i.secret){const r=bt.instance.get(this.sendTo);r&&(r.peerId!=Fe.myCursor.peerId&&ne.call("PLAY_CUT_IN",i,r.peerId),ne.call("PLAY_CUT_IN",i,Fe.myCursor.peerId))}else ne.call("PLAY_CUT_IN",i),this.chatMessageService.sendOperationLog((""==e.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":e.name)+" \u3092\u518d\u751f\u3057\u305f")}stopCutIn(){if(!this.selectedCutIn)return;const e={identifier:this.selectedCutIn.identifier,secret:!!this.sendTo,sender:Fe.myCursor.peerId};if(e.secret){const i=bt.instance.get(this.sendTo);i&&(i.peerId!=Fe.myCursor.peerId&&ne.call("STOP_CUT_IN",e,i.peerId),ne.call("STOP_CUT_IN",e,Fe.myCursor.peerId))}else ne.call("STOP_CUT_IN",e)}testCutIn(){this.selectedCutIn&&queueMicrotask(()=>{ne.trigger("PLAY_CUT_IN",{identifier:this.selectedCutIn.identifier,test:!0})})}onAudioFileChange(e=""){if(!e&&this.selectedCutIn&&(e=this.selectedCutIn.audioIdentifier),""==e)return void(this.cutInAudioFileName="");const i=un.instance.get(e);this.cutInAudioFileName=i?i.name:""}openYouTubeTerms(){return this.modalService.open(sa,{url:"https://www.youtube.com/terms",title:"YouTube \u5229\u7528\u898f\u7d04"}),!1}helpCutIn(){let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(kf,{left:e.x,top:e.y,width:600,height:680});r.title="\u30ab\u30c3\u30c8\u30a4\u30f3\u30d8\u30eb\u30d7",r.text=`\u3000\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u540d\u524d\u3001\u8868\u793a\u6642\u9593\u3001\u4f4d\u7f6e\u3068\u5e45\u3068\u9ad8\u3055\uff08\u305d\u308c\u305e\u308c\u753b\u9762\u30b5\u30a4\u30ba\u306b\u5bfe\u3059\u308b\u76f8\u5bfe\u6307\u5b9a\uff09\u3001\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u306b\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u8868\u793a\u3055\u308c\u308b\u6761\u4ef6\u3092\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\u307e\u305f\u3001\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u5834\u5408\u304a\u3088\u3073\u300c\u898b\u5207\u308c\u9632\u6b62\u300d\u306b\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u305f\u5834\u5408\u3001\u753b\u9762\u5185\u306b\u53ce\u307e\u308b\u3088\u3046\u306b\u4f4d\u7f6e\u3068\u30b5\u30a4\u30ba\u304c\u8abf\u6574\u3055\u308c\u307e\u3059\u3002\n\n\u3000\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u4e00\u81f4\u3092\u5224\u5b9a\u3059\u308b\u969b\u3001\u5168\u89d2\u534a\u89d2\u3001\u30a2\u30eb\u30d5\u30a1\u3079\u30c3\u30c8\u306e\u5927\u6587\u5b57\u5c0f\u6587\u5b57\u306f\u533a\u5225\u3055\u308c\u307e\u305b\u3093\u3002\u307e\u305f\u3001\u4ed6\u306eBCDice\u3092\u5229\u7528\u3059\u308b\u30aa\u30f3\u30e9\u30a4\u30f3\u30bb\u30c3\u30b7\u30e7\u30f3\u30c4\u30fc\u30eb\u3068\u306e\u4e92\u63db\u6027\u306e\u305f\u3081\u3001\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u4e00\u81f4\u3092\u5224\u5b9a\u3059\u308b\u969b\u3001\u4e21\u5074\u306b\u30b9\u30da\u30fc\u30b9\u304c\u5165\u3063\u305f \u201c \uff1e \u201d \u3068 \u201c \u2192 \u201d \u3092\u540c\u5024\u3068\u307f\u306a\u3057\u307e\u3059\u3002\n\u3000\n\u3000\u6a2a\u4f4d\u7f6e\uff08PosX\uff09\u3068\u7e26\u4f4d\u7f6e\uff08PosY\uff09\u306f\u3001\u753b\u9762\u306e\u5de6\u4e0a\u9685\u304b\u3089\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u4e2d\u5fc3\u4f4d\u7f6e\u307e\u3067\u306e\u8ddd\u96e2\u3068\u306a\u308a\u307e\u3059\u3002\u30b5\u30a4\u30ba\u306e\u5e45\uff08Width\uff09\u3068\u9ad8\u3055\uff08Height\uff09\u306e\u3069\u3061\u3089\u304b\u30920\u3068\u3057\u305f\u5834\u5408\u3001\u5143\u753b\u50cf\u306e\u7e26\u6a2a\u6bd4\u3092\u4fdd\u3063\u3066\u62e1\u5927\u7e2e\u5c0f\u3057\u307e\u3059\uff08\u305f\u3060\u3057\u3001\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u6700\u5c0f\u5e45\u3001\u9ad8\u3055\u306f${BR.MIN_SIZE}\u30d4\u30af\u30bb\u30eb\u3068\u306a\u308a\u307e\u3059\uff09\u3002\n\u3000\n\u3000\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u5fc5\u305a\u524d\u9762\u3001\u305d\u306e\u4ed6\u306f\u5f8c\u304b\u3089\u8868\u793a\u3055\u308c\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u753b\u50cf\u304c\u3088\u308a\u524d\u9762\u306b\u306a\u308a\u307e\u3059\u304c\u3001\u91cd\u306a\u308a\u9806\uff08Z-Index\uff09\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3067\u5236\u5fa1\u53ef\u80fd\u3067\u3059\u3002\u540c\u3058\u30ab\u30c3\u30c8\u30a4\u30f3\u3001\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u3001\u540c\u3058\u30bf\u30b0\u304c\u6307\u5b9a\u3055\u308c\u305f\u30ab\u30c3\u30c8\u30a4\u30f3\u3092\u518d\u751f\u3059\u308b\u5834\u5408\u306f\u3001\u4ee5\u524d\u306e\u3082\u306e\u306f\u505c\u6b62\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u6761\u4ef6\u3092\u6e80\u305f\u3059\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u8907\u6570\u3042\u308b\u5834\u5408\u3001\n\n\u3000\u3000\u30fb\u30bf\u30b0\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3082\u306e\u306f\u3059\u3079\u3066\n\u3000\u3000\u30fb\u30bf\u30b0\u304c\u8a2d\u5b9a\u3055\u308c\u305f\u3082\u306e\u306f\u3001\u540c\u3058\u30bf\u30b0\u306e\u3082\u306e\u306e\u4e2d\u304b\u3089\u30e9\u30f3\u30c0\u30e0\u306b1\u3064\n\u3000\u3000\u30fb\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u4e0a\u8a18\u306e\u4e2d\u304b\u3089\u30e9\u30f3\u30c0\u30e0\u306b1\u3064\u3092\u9078\u629e\n\n\u3068\u306a\u308a\u307e\u3059\u3002\n\n\u3000\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u30c9\u30e9\u30c3\u30b0\u306b\u3088\u3063\u3066\u79fb\u52d5\u53ef\u80fd\u3067\u3059\uff08\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u7aef\u3092\u30c9\u30e9\u30c3\u30b0\uff09\u3002\u307e\u305f\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af\u3067\u9589\u3058\u308b\uff08\u81ea\u5206\u3060\u3051\u505c\u6b62\uff09\u3001\u53f3\u30af\u30ea\u30c3\u30af\u3067\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u64cd\u4f5c\u304c\u53ef\u80fd\u3067\u3059\uff08\u300c\u9589\u3058\u308b\u300d\u300c\u30a6\u30a3\u30f3\u30c9\u30a6\u306e\u80cc\u9762\u306b\u8868\u793a\u300d\u300c\u6700\u5c0f\u5316\u300d\u304c\u53ef\u80fd\u3001\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u7aef\u3067\u53d7\u4ed8\uff09\u3002\n\n\u3000\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u3092\u30ab\u30c3\u30c8\u30a4\u30f3\u8868\u793a\u6642\u306e\u52b9\u679c\u97f3\u3068\u3057\u3066\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\u97f3\u91cf\u306b\u306f\u30b8\u30e5\u30fc\u30af\u30dc\u30c3\u30af\u30b9\u306e\u8a2d\u5b9a\uff08\u300c\u30c6\u30b9\u30c8 (\u81ea\u5206\u3060\u3051\u898b\u308b)\u300d\u306e\u5834\u5408\u306f\u8a66\u8074\u97f3\u91cf\uff09\u304c\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002\u8868\u793a\u6642\u9593\u3084\u624b\u52d5\u64cd\u4f5c\u306b\u3088\u3063\u3066\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u505c\u6b62\u3057\u305f\u969b\u306b\u306f\u3001\u9014\u4e2d\u3067\u3042\u3063\u3066\u3082\u97f3\u58f0\u3082\u505c\u6b62\u3057\u307e\u3059\u3002\u30ab\u30c3\u30c8\u30a4\u30f3\u3084\u90e8\u5c4b\u306e\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u306b\u306f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u542b\u307e\u308c\u307e\u305b\u3093\u306e\u3067\u3001\u5fc5\u8981\u3067\u3057\u305f\u3089\u5225\u9014\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u304f\u3060\u3055\u3044\uff08\u30ab\u30c3\u30c8\u30a4\u30f3\u3068\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306e\u30ea\u30f3\u30af\u306f\u30d5\u30a1\u30a4\u30eb\u306e\u5185\u5bb9\u306b\u3088\u308a\u307e\u3059\u3001\u540c\u540d\u306e\u5225\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u3082\u518d\u30ea\u30f3\u30af\u3055\u308c\u307e\u305b\u3093\uff09\u3002\n\n\u3000\u30ab\u30c3\u30c8\u30a4\u30f3\u306b\u52d5\u753b\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u3001URL\u306f\u73fe\u5728YouTube\u306e\u3082\u306e\u306e\u307f\u6709\u52b9\u3067\u3059\u3002\u52d5\u753b\u3092\u5229\u7528\u3059\u308b\u969b\u306f\u6a29\u5229\u8005\u304a\u3088\u3073YouTube\u306e\u5b9a\u3081\u305f\u5229\u7528\u898f\u7d04\u3092\u53c2\u7167\u3057\u3001\u9806\u5b88\u3057\u3066\u304f\u3060\u3055\u3044\u3002`}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Zr),Y(lr),Y(Ei),Y(yi),Y(ll),Y(vo))};static#t=this.\u0275cmp=In({type:t,selectors:[["app-cut-in-setting"]],viewQuery:function(i,r){if(1&i&&Ln(bre,5),2&i){let o;Bn(o=Un())&&(r.cutInSelecter=o.first)}},decls:14,vars:3,consts:[["cutInSelecter",""],["audioSelect",""],[1,"flex-container"],[1,"flex-item","no-grow"],[2,"margin","0px 0px 2px 0px","font-size","smaller",3,"click"],["size","15",2,"width","12em",3,"change"],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[2,"float","right","margin-top","3px","margin-right","3px"],[2,"cursor","help",3,"click"],[4,"ngIf"],[3,"value","title"],[2,"display","flex"],[2,"position","relative","overflow","hidden",3,"dblclick"],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["style","position: absolute; top: 1px; left: -1px; z-index: 5",4,"ngIf"],["class","grow","style","opacity: 0.8; position: absolute; bottom: 1px; right: -1px; z-index: 5",4,"ngIf"],["draggable","false",2,"width","160px","height","160px","object-fit","contain",3,"ngClass","src"],[2,"display","flex","flex-direction","column","width","100%"],[2,"padding-bottom","2px"],[2,"float","right"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"click","checked"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[2,"padding-left","2px"],[2,"font-size","smaller"],["type","text","placeholder","Name",2,"width","8em",3,"ngModelChange","ngModel"],[2,"font-size","smaller","margin-left","1em"],["type","text","placeholder","Tag",2,"width","3em",3,"ngModelChange","ngModel"],[2,"padding-left","2px","padding-top","2px"],["type","number","min","0","max","1000",2,"width","3.5em",3,"ngModelChange","ngModel"],[2,"font-size","smaller","padding-left","2px"],[2,"min-width","8em",3,"ngModelChange","ngModel"],[3,"value","selected"],[2,"margin-left","1em","font-size","smaller"],["name","borderStyle","type","checkbox",3,"click","checked"],["placeholder","1\u884c\u306b\u4e00\u3064\u3001\u5192\u982d@\u3067\u30de\u30c3\u30c1\u6642\u306b\u30c6\u30ad\u30b9\u30c8\u304b\u3089\u5207\u308a\u53d6\u308a\r\n@\u8857\u4e26\u307f",2,"width","100%","height","3em",3,"ngModelChange","ngModel"],[2,"font-size","smaller","display","flex","flex-direction","column","width","100%"],[3,"click"],[1,"self-only"],[2,"margin-left","2em"],[2,"margin-right","0px",3,"click"],[1,"material-icons",2,"font-size","smaller"],[2,"margin-left","0px",3,"click"],[2,"white-space","nowrap"],[2,"max-width","10em",3,"ngModelChange","ngModel","ngClass","ngStyle"],["value","",1,"not-specified"],["style","font-weight: bolder;",3,"value","color",4,"ngFor","ngForOf"],[1,"section"],[1,"header"],[2,"margin-left","0.6em"],["name","cutInIsPreventOutBounds","type","checkbox",3,"ngModelChange","ngModel","checked","value"],[2,"margin-left","1em","display","table","width","65%"],[2,"display","table-row"],[2,"display","table-cell","width","3.5em"],[2,"display","table-cell","width","calc(100% - 9.5em)"],["type","range","name","cutInPosX",2,"width","100%",3,"ngModelChange","ngModel","title","min","max"],[2,"display","table-cell","width","6em","text-align","right"],["type","number",2,"width","3.5em",3,"ngModelChange","ngModel","min","max"],["type","range","name","cutInPosY",2,"width","100%",3,"ngModelChange","ngModel","title","min","max"],[2,"margin-left","1em"],["name","cutInIsFrontOfStand","type","checkbox",3,"ngModelChange","ngModel","checked","value"],[2,"margin-left","1em","display","table","width","90%"],[2,"display","table-cell","width","11.5em"],[2,"display","table-cell","width","calc(100% - 15.5em)"],["type","range","name","cutInWidth",2,"width","100%",3,"ngModelChange","ngModel","title","min","max"],["type","range","name","cutIHeight",2,"width","100%",3,"ngModelChange","ngModel","title","min","max"],[3,"ngModelChange","ngModel"],["name","cutInSEIsLoop","type","checkbox",3,"ngModelChange","ngModel","checked","value"],[2,"padding-left","1em"],["type","radio",3,"ngModelChange","name","id","ngModel","checked","value"],[3,"for"],[3,"ngModelChange","change","ngModel","ngClass"],["style","color: black",3,"value",4,"ngFor","ngForOf"],["type","radio",3,"ngModelChange","name","id","ngModel","checked","value","disabled"],["type","text",2,"width","24em",3,"ngModelChange","ngModel","disabled"],[2,"padding-left","2.5em"],["href","https://www.youtube.com/terms","target","_blank",1,"outer-link",3,"click"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons",2,"margin-right","2px","font-size","16px","display","block"],[2,"position","absolute","top","1px","left","-1px","z-index","5"],[3,"click",4,"ngIf"],[1,"grow",2,"opacity","0.8","position","absolute","bottom","1px","right","-1px","z-index","5"],[1,"material-icons",2,"font-size","32px"],[2,"font-weight","bolder",3,"value"],[2,"color","black",3,"value"],["style","margin-left: 0.6em",4,"ngIf"],["style","margin-left: 0.6em; color: red; display:inline-block; white-space: nowrap; max-width: 20em; overflow: hidden; text-overflow: ellipsis",4,"ngIf"],[1,"material-icons",2,"font-size","14px"],[2,"color","blue"],[2,"margin-left","0.6em","color","red","display","inline-block","white-space","nowrap","max-width","20em","overflow","hidden","text-overflow","ellipsis"],[1,"material-icons"],[2,"font-weight","bolder"],[3,"click","disabled"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(i,r){if(1&i){const o=Le();p(0,"div",2)(1,"div",3)(2,"div")(3,"button",4),he("click",function(){return V(o),H(r.add())}),y(4,"\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u8ffd\u52a0"),g()(),p(5,"select",5,0),he("change",function(){V(o);const a=pn(6);return H(r.onChangeCutIn(a.value))}),q(7,wre,2,5,"option",6),g()(),p(8,"div",7)(9,"div",8)(10,"button",9),he("click",function(){return V(o),H(r.helpCutIn())}),y(11,"?"),g()(),q(12,Lre,178,152,"ng-container",10),g()(),q(13,Ure,4,1,"ng-container",10)}2&i&&(h(7),m("ngForOf",r.cutIns),h(5),m("ngIf",!r.isEmpty&&r.selectedCutIn),h(),m("ngIf",r.isEmpty))},dependencies:[Ni,nr,ri,Lo,na,ia,kr,yl,Cl,Ea,Ia,Yd,Or,ku,Du,Cr,cr],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.header[_ngcontent-%COMP%]{margin-top:3px}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.blackout[_ngcontent-%COMP%]{filter:blur(12px) grayscale(70%)}.self-only[_ngcontent-%COMP%]{color:red}img[_ngcontent-%COMP%]{transition:all .1s 0s ease}.self-setting[_ngcontent-%COMP%]{font-weight:bolder;font-size:smaller}input[type=number][_ngcontent-%COMP%]{text-align:right}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.not-specified[_ngcontent-%COMP%]{color:gray}.self-only[_ngcontent-%COMP%]{color:red;vertical-align:text-top}.section[_ngcontent-%COMP%]{margin-top:.4em}"]})}return t})();function w5(t){return new qi(n=>{tl(t()).subscribe(n)})}function BC(t,n,e=1/0){return Ae(n)?BC((i,r)=>Oo((o,s)=>n(i,o,r,s))(tl(t(i,r))),e):("number"==typeof n&&(e=n),xo((i,r)=>function Vre(t,n,e,i,r,o,s,a){const c=[];let u=0,f=0,b=!1;const C=()=>{b&&!c.length&&!u&&n.complete()},x=U=>u<i?M(U):c.push(U),M=U=>{o&&n.next(U),u++;let W=!1;tl(e(U,f++)).subscribe(oo(n,K=>{r?.(K),o?x(K):n.next(K)},()=>{W=!0},void 0,()=>{if(W)try{for(u--;c.length&&u<i;){const K=c.shift();s?jd(n,s,()=>M(K)):M(K)}C()}catch(K){n.error(K)}}))};return t.subscribe(oo(n,x,()=>{b=!0,C()})),()=>{a?.()}}(i,r,t,e)))}const jre=["addListener","removeListener"],Gre=["addEventListener","removeEventListener"],Wre=["on","off"];function UC(t,n,e,i){if(Ae(e)&&(i=e,e=void 0),i)return UC(t,n,e).pipe(mI(i));const[r,o]=function Zre(t){return Ae(t.addEventListener)&&Ae(t.removeEventListener)}(t)?Gre.map(s=>a=>t[s](n,a,e)):function $re(t){return Ae(t.addListener)&&Ae(t.removeListener)}(t)?jre.map(E5(t,n)):function Yre(t){return Ae(t.on)&&Ae(t.off)}(t)?Wre.map(E5(t,n)):[];if(!r&&fI(t))return BC(s=>UC(s,n,e))(tl(t));if(!r)throw new TypeError("Invalid event target");return new qi(s=>{const a=(...c)=>s.next(1<c.length?c:c[0]);return r(a),()=>o(a)})}function E5(t,n){return e=>i=>t[e](n,i)}function I5(t=1/0){return BC(oc,t)}function T5(...t){return function qre(){return I5(1)}()(ky(t,gI(t)))}const am=new qi(hn),TS=new qi(t=>t.complete());function S5(...t){const n=gI(t),e=function Aj(t,n){return"number"==typeof pI(t)?t.pop():n}(t,1/0),i=t;return i.length?1===i.length?tl(i[0]):I5(e)(ky(i,n)):TS}function Cb(t,n){return xo((e,i)=>{let r=0;e.subscribe(oo(i,o=>t.call(n,o,r++)&&i.next(o)))})}class Qre extends qi{constructor(n,e){super(),this.source=n,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,Ol(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){const n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:n}=this;this._subject=this._connection=null,n?.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new Ie;const e=this.getSubject();n.add(this.source.subscribe(oo(e,void 0,()=>{this._teardown(),e.complete()},i=>{this._teardown(),e.error(i)},()=>this._teardown()))),n.closed&&(this._connection=null,n=Ie.EMPTY)}return n}refCount(){return function Kre(){return xo((t,n)=>{let e=null;t._refCount++;const i=oo(n,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount)return void(e=null);const r=t._connection,o=e;e=null,r&&(!o||r===o)&&r.unsubscribe(),n.unsubscribe()});t.subscribe(i),i.closed||(e=t.connect())})}()(this)}}const eoe={connector:()=>new zs};function M5(t,n=eoe){const{connector:e}=n;return xo((i,r)=>{const o=e();tl(t(function Jre(t){return new qi(n=>t.subscribe(n))}(o))).subscribe(r),r.add(i.subscribe(o))})}function lh(t){return t<=0?()=>TS:xo((n,e)=>{let i=0;n.subscribe(oo(e,r=>{++i<=t&&(e.next(r),t<=i&&e.complete())}))})}class roe extends Ie{constructor(n,e){super()}schedule(n,e=0){return this}}const zC={setInterval(t,n,...e){const{delegate:i}=zC;return i?.setInterval?i.setInterval(t,n,...e):setInterval(t,n,...e)},clearInterval(t){const{delegate:n}=zC;return(n?.clearInterval||clearInterval)(t)},delegate:void 0},D5={now:()=>(D5.delegate||Date).now(),delegate:void 0};class xb{constructor(n,e=xb.now){this.schedulerActionCtor=n,this.now=e}schedule(n,e=0,i){return new this.schedulerActionCtor(this,n).schedule(i,e)}}xb.now=D5.now;const k5=new class soe extends xb{constructor(n,e=xb.now){super(n,e),this.actions=[],this._active=!1}flush(n){const{actions:e}=this;if(this._active)return void e.push(n);let i;this._active=!0;do{if(i=n.execute(n.state,n.delay))break}while(n=e.shift());if(this._active=!1,i){for(;n=e.shift();)n.unsubscribe();throw i}}}(class ooe extends roe{constructor(n,e){super(n,e),this.scheduler=n,this.work=e,this.pending=!1}schedule(n,e=0){var i;if(this.closed)return this;this.state=n;const r=this.id,o=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(o,r,e)),this.pending=!0,this.delay=e,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(o,this.id,e),this}requestAsyncId(n,e,i=0){return zC.setInterval(n.flush.bind(n,this),i)}recycleAsyncId(n,e,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return e;null!=e&&zC.clearInterval(e)}execute(n,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(n,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,e){let r,i=!1;try{this.work(n)}catch(o){i=!0,r=o||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:n,scheduler:e}=this,{actions:i}=e;this.work=this.state=this.scheduler=null,this.pending=!1,se(i,this),null!=n&&(this.id=this.recycleAsyncId(e,n,null)),this.delay=null,super.unsubscribe()}}}),aoe=k5;function O5(t,n){return n?e=>T5(n.pipe(lh(1),function loe(){return xo((t,n)=>{t.subscribe(oo(n,hn))})}()),e.pipe(O5(t))):BC((e,i)=>tl(t(e,i)).pipe(lh(1),function coe(t){return Oo(()=>t)}(e)))}const wb="Service workers are disabled or not supported by this browser";class HC{constructor(n){if(this.serviceWorker=n,n){const i=UC(n,"controllerchange").pipe(Oo(()=>n.controller)),o=T5(w5(()=>gC(n.controller)),i);this.worker=o.pipe(Cb(f=>!!f)),this.registration=this.worker.pipe(cb(()=>n.getRegistration()));const u=UC(n,"message").pipe(Oo(f=>f.data)).pipe(Cb(f=>f&&f.type)).pipe(function noe(t){return t?n=>M5(t)(n):n=>function toe(t,n){const e=Ae(t)?t:()=>t;return Ae(n)?M5(n,{connector:e}):i=>new Qre(i,e)}(new zs)(n)}());u.connect(),this.events=u}else this.worker=this.events=this.registration=function foe(t){return w5(()=>function Hre(t,n){const e=Ae(t)?t:()=>t,i=r=>r.error(e());return new qi(n?r=>n.schedule(i,0,r):i)}(new Error(t)))}(wb)}postMessage(n,e){return this.worker.pipe(lh(1),function ioe(t,n,e){const i=Ae(t)||n||e?{next:t,error:n,complete:e}:t;return i?xo((r,o)=>{var s;null===(s=i.subscribe)||void 0===s||s.call(i);let a=!0;r.subscribe(oo(o,c=>{var u;null===(u=i.next)||void 0===u||u.call(i,c),o.next(c)},()=>{var c;a=!1,null===(c=i.complete)||void 0===c||c.call(i),o.complete()},c=>{var u;a=!1,null===(u=i.error)||void 0===u||u.call(i,c),o.error(c)},()=>{var c,u;a&&(null===(c=i.unsubscribe)||void 0===c||c.call(i)),null===(u=i.finalize)||void 0===u||u.call(i)}))}):oc}(i=>{i.postMessage({action:n,...e})})).toPromise().then(()=>{})}postMessageWithOperation(n,e,i){const r=this.waitForOperationCompleted(i),o=this.postMessage(n,e);return Promise.all([o,r]).then(([,s])=>s)}generateNonce(){return Math.round(1e7*Math.random())}eventsOfType(n){let e;return e="string"==typeof n?i=>i.type===n:i=>n.includes(i.type),this.events.pipe(Cb(e))}nextEventOfType(n){return this.eventsOfType(n).pipe(lh(1))}waitForOperationCompleted(n){return this.eventsOfType("OPERATION_COMPLETED").pipe(Cb(e=>e.nonce===n),lh(1),Oo(e=>{if(void 0!==e.result)return e.result;throw new Error(e.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}}let A5=(()=>{class t{get isEnabled(){return this.sw.isEnabled}constructor(e){if(this.sw=e,this.pushManager=null,this.subscriptionChanges=new zs,!e.isEnabled)return this.messages=am,this.notificationClicks=am,void(this.subscription=am);this.messages=this.sw.eventsOfType("PUSH").pipe(Oo(r=>r.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(Oo(r=>r.data)),this.pushManager=this.sw.registration.pipe(Oo(r=>r.pushManager));const i=this.pushManager.pipe(cb(r=>r.getSubscription()));this.subscription=S5(i,this.subscriptionChanges)}requestSubscription(e){if(!this.sw.isEnabled||null===this.pushManager)return Promise.reject(new Error(wb));const i={userVisibleOnly:!0};let r=this.decodeBase64(e.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),o=new Uint8Array(new ArrayBuffer(r.length));for(let s=0;s<r.length;s++)o[s]=r.charCodeAt(s);return i.applicationServerKey=o,this.pushManager.pipe(cb(s=>s.subscribe(i)),lh(1)).toPromise().then(s=>(this.subscriptionChanges.next(s),s))}unsubscribe(){return this.sw.isEnabled?this.subscription.pipe(lh(1),cb(i=>{if(null===i)throw new Error("Not subscribed to push notifications.");return i.unsubscribe().then(r=>{if(!r)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})})).toPromise():Promise.reject(new Error(wb))}decodeBase64(e){return atob(e)}static#e=this.\u0275fac=function(i){return new(i||t)(Nn(HC))};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac})}return t})(),SS=(()=>{class t{get isEnabled(){return this.sw.isEnabled}constructor(e){if(this.sw=e,!e.isEnabled)return this.versionUpdates=am,void(this.unrecoverable=am);this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(wb));const e=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:e},e)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(wb));const e=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:e},e)}static#e=this.\u0275fac=function(i){return new(i||t)(Nn(HC))};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac})}return t})();const P5=new mn("");function poe(t,n,e,i){return()=>{if(!eI(i)||!("serviceWorker"in navigator)||!1===e.enabled)return;let r;if(navigator.serviceWorker.addEventListener("controllerchange",()=>{null!==navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({action:"INITIALIZE"})}),"function"==typeof e.registrationStrategy)r=e.registrationStrategy();else{const[s,...a]=(e.registrationStrategy||"registerWhenStable:30000").split(":");switch(s){case"registerImmediately":r=gC(null);break;case"registerWithDelay":r=F5(+a[0]||0);break;case"registerWhenStable":r=a[0]?S5(N5(t),F5(+a[0])):N5(t);break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${e.registrationStrategy}`)}}t.get(Pn).runOutsideAngular(()=>r.pipe(lh(1)).subscribe(()=>navigator.serviceWorker.register(n,{scope:e.scope}).catch(s=>console.error("Service worker registration failed with:",s))))}}function F5(t){return gC(null).pipe(function hoe(t,n=k5){const e=function doe(t=0,n,e=aoe){let i=-1;return null!=n&&(mP(n)?e=n:i=n),new qi(r=>{let o=function uoe(t){return t instanceof Date&&!isNaN(t)}(t)?+t-e.now():t;o<0&&(o=0);let s=0;return e.schedule(function(){r.closed||(r.next(s++),0<=i?this.schedule(void 0,i):r.complete())},o)})}(t,n);return O5(()=>e)}(t))}function N5(t){return t.get(Ud).isStable.pipe(Cb(e=>e))}function goe(t,n){return new HC(eI(n)&&!1!==t.enabled?navigator.serviceWorker:void 0)}class MS{}function moe(t,n={}){return function ru(t){return{\u0275providers:t}}([A5,SS,{provide:P5,useValue:t},{provide:MS,useValue:n},{provide:HC,useFactory:goe,deps:[MS,Za]},{provide:vO,useFactory:poe,deps:[hs,P5,MS,Za],multi:!0}])}let _oe=(()=>{class t{static register(e,i={}){return{ngModule:t,providers:[moe(e,i)]}}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ga({type:t});static#n=this.\u0275inj=ha({providers:[A5,SS]})}return t})();const boe=["modalLayer"],voe=t=>({horizontal:t});function yoe(t,n){if(1&t){const e=Le();p(0,"li",4),he("click",function(){return V(e),H(v().save())}),p(1,"a",5)(2,"div")(3,"i",7),y(4,"sd_storage"),g()(),p(5,"div"),y(6,"\u4fdd\u5b58"),g()()()}}function Coe(t,n){if(1&t&&(p(0,"li",16)(1,"a")(2,"div")(3,"i",17),y(4,"sd_storage"),g()(),p(5,"div"),y(6),g()()()),2&t){const e=v();h(6),Si("",e.progresPercent,"%")}}function xoe(t,n){if(1&t){const e=Le();p(0,"div",18),he("click",function(){return V(e),H(v().closeImagePreview())}),p(1,"div",19)(2,"i",7),y(3,"close"),g()(),Ge(4,"img",20),Ut(5,"safe"),g()}if(2&t){const e=v();m("@fadeInOut","in"),h(4),m("src",zt(5,2,e.imageUrl,"resourceUrl"),bn)}}let $c=(()=>{class t{static#e=this.imageUrl="";get imageUrl(){return t.imageUrl}get otherPeers(){return bt.instance.getObjects(Fe)}static get noticePlayer(){return t._noticePlayer||(t._noticePlayer=new Je,t._noticePlayer.volumeType=ec.NOTICE),t._noticePlayer}notice(e=Te.puyon){const i=un.instance.get(e);i&&i.isReady?(ne.unregister(this,"UPDATE_AUDIO_RESOURE"),t.noticePlayer.play(i)):ne.register(this).on("UPDATE_AUDIO_RESOURE",-100,r=>{this.notice(e)})}constructor(e,i,r,o,s,a,c,u,f,b,C){var x=this;this.swUpdate=e,this.modalService=i,this.panelService=r,this.pointerDeviceService=o,this.chatMessageService=s,this.appConfigService=a,this.saveDataService=c,this.ngZone=u,this.contextMenuService=f,this.standImageService=b,this.cutInService=C,this.immediateUpdateTimer=null,this.lazyUpdateTimer=null,this.openPanelCount=0,this.isSaveing=!1,this.progresPercent=0,this.isHorizontal=!1,this.isLoggedin=!1,this.isUpdateCanceled=!1,this.noticeIntervalTimer=null,this.ngZone.runOutsideAngular(()=>{zc.instance.initialize(),Xg.instance.initialize(),qg.instance.initialize(),Kg.instance.initialize()}),this.appConfigService.initialize(),this.pointerDeviceService.initialize(),Ho.instance.initialize(),nc.instance.initialize(),Vc.instance.initialize(),new Zi("DiceBot",this.chatMessageService).initialize(),Zi.getHelpMessage("").then(()=>this.lazyNgZoneUpdate(!0)),new Nf("Jukebox").initialize(),new tt("SoundEffect").initialize(),nc.instance.addChatTab("\u30e1\u30a4\u30f3\u30bf\u30d6","MainTab"),nc.instance.addChatTab("\u30b5\u30d6\u30bf\u30d6","SubTab").recieveOperationLogLevel=1,tc.instance.initialize();let $=new Uu("SampleDiceRollTable");$.initialize(),$.name="\u30b5\u30f3\u30d7\u30eb\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868",$.command="SAMPLE",$.dice="1d6",$.value="1:\u3053\u308c\u306f\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u30b5\u30f3\u30d7\u30eb\u3067\u3059\n2:\u6570\u5b57\u3068\u5bfe\u5fdc\u3059\u308b\u7d50\u679c\u30921\u884c\u306b1\u3064\u3065\u3064:\uff08\u30b3\u30ed\u30f3\uff09\u3067\u533a\u5207\u308a\n3:\u6570\u5b57:\u7d50\u679c\u306e\u3088\u3046\u306b\u8a18\u8ff0\u3057\u307e\u3059\n4:\\\\n  \\n\u3067\u6539\u884c\u3057\u307e\u3059\n5-6:\u307e\u305f\u3001-\uff08\u30cf\u30a4\u30d5\u30f3\uff09\u3067\u533a\u5207\u3063\u3066\u6570\u5b57\u306e\u7bc4\u56f2\u3092\u6307\u5b9a\u53ef\u80fd\u3067\u3059",Jl.instance.addDiceRollTable($);let ge=vn.createEmpty("none_icon").toContext();ge.url="./assets/images/ic_account_circle_black_24dp_2x.png";let ye=on.instance.add(ge);ui.create(ye.identifier).tag="*default \u30a2\u30a4\u30b3\u30f3",ge=vn.createEmpty("stand_no_image").toContext(),ge.url="./assets/images/nc96424.png";let lt=on.instance.add(ge);ui.create(lt.identifier).tag="*default \u30b9\u30bf\u30f3\u30c9";try{Jn.getItem(Je.MAIN_VOLUME_LOCAL_STORAGE_KEY).then(Ee=>{"number"==typeof Ee&&0<=Ee&&Ee<=1&&(Je.volume=Ee)}),Jn.getItem(Je.AUDITION_VOLUME_LOCAL_STORAGE_KEY).then(Ee=>{"number"==typeof Ee&&0<=Ee&&Ee<=1&&(Je.auditionVolume=Ee)}),Jn.getItem(Je.SOUND_EFFECT_VOLUME_LOCAL_STORAGE_KEY).then(Ee=>{"number"==typeof Ee&&0<=Ee&&Ee<=1&&(Je.soundEffectVolume=Ee)}),Jn.getItem(Je.NOTICE_VOLUME_LOCAL_STORAGE_KEY).then(Ee=>{"number"==typeof Ee&&0<=Ee&&Ee<=1&&(Je.noticeVolume=Ee)}),Jn.getItem(Je.MAIN_IS_MUTE_LOCAL_STORAGE_KEY).then(Ee=>Je.isMute=!!Ee),Jn.getItem(Je.AUDITION_IS_MUTE_LOCAL_STORAGE_KEY).then(Ee=>Je.isAuditionMute=!!Ee),Jn.getItem(Je.SOUND_EFFECT_IS_MUTE_LOCAL_STORAGE_KEY).then(Ee=>Je.isSoundEffectMute=!!Ee),Jn.getItem(Je.NOTICE_IS_MUTE_LOCAL_STORAGE_KEY).then(Ee=>Je.isNoticeMute=!!Ee)}catch(Ee){console.log(Ee)}Je.resumeAudioContext(),Te.dicePick=un.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,Te.dicePut=un.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,Te.diceRoll1=un.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu01.mp3").identifier,Te.diceRoll2=un.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu02.mp3").identifier,Te.cardDraw=un.instance.add("./assets/sounds/soundeffect-lab/card-turn-over1.mp3").identifier,Te.cardPick=un.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,Te.cardPut=un.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,Te.cardShuffle=un.instance.add("./assets/sounds/soundeffect-lab/card-open1.mp3").identifier,Te.piecePick=un.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,Te.piecePut=un.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,Te.blockPick=un.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,Te.blockPut=un.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,Te.lock=un.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,Te.unlock=un.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,Te.sweep=un.instance.add("./assets/sounds/tm2/tm2_swing003.wav").identifier,Te.puyon=un.instance.add("./assets/sounds/soundeffect-lab/puyon1.mp3").identifier,Te.surprise=un.instance.add("./assets/sounds/otologic/Onmtp-Surprise02-1.mp3").identifier,Te.coinToss=un.instance.add("./assets/sounds/niconicomons/nc146227.mp3").identifier,Te.selectionStart=un.instance.add("./assets/sounds/soundeffect-lab/decision50.mp3").identifier,un.instance.get(Te.dicePick).isHidden=!0,un.instance.get(Te.dicePut).isHidden=!0,un.instance.get(Te.diceRoll1).isHidden=!0,un.instance.get(Te.diceRoll2).isHidden=!0,un.instance.get(Te.cardDraw).isHidden=!0,un.instance.get(Te.cardPick).isHidden=!0,un.instance.get(Te.cardPut).isHidden=!0,un.instance.get(Te.cardShuffle).isHidden=!0,un.instance.get(Te.piecePick).isHidden=!0,un.instance.get(Te.piecePut).isHidden=!0,un.instance.get(Te.blockPick).isHidden=!0,un.instance.get(Te.blockPut).isHidden=!0,un.instance.get(Te.lock).isHidden=!0,un.instance.get(Te.unlock).isHidden=!0,un.instance.get(Te.sweep).isHidden=!0,un.instance.get(Te.puyon).isHidden=!0,un.instance.get(Te.surprise).isHidden=!0,un.instance.get(Te.coinToss).isHidden=!0,un.instance.get(Te.sweep).isHidden=!0,un.instance.get(Te.selectionStart).isHidden=!0,Fe.createMyCursor().then(()=>{(null==Fe.myCursor.name||""===Fe.myCursor.name)&&(Fe.myCursor.name=Fe.CHAT_DEFAULT_NAME),Fe.myCursor.imageIdentifier||(Fe.myCursor.imageIdentifier=ye.identifier)}),ne.register(this).on("UPDATE_GAME_OBJECT",Ee=>{this.lazyNgZoneUpdate(Ee.isSendFromSelf)}).on("DELETE_GAME_OBJECT",Ee=>{this.lazyNgZoneUpdate(Ee.isSendFromSelf)}).on("UPDATE_SELECTION",Ee=>{this.lazyNgZoneUpdate(Ee.isSendFromSelf)}).on("SYNCHRONIZE_AUDIO_LIST",Ee=>{Ee.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("SYNCHRONIZE_FILE_LIST",Ee=>{Ee.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("LOAD_CONFIG",Ee=>{if(console.log("LOAD_CONFIG !!!",Ee.data),Ee.data.dice&&Ee.data.dice.url){const Be=Ee.data.dice.api;fetch(Ee.data.dice.url+(1==Be?"/v1/names":"/v2/game_system"),{mode:"cors"}).then(ft=>ft.json()).then(ft=>{let rt=Ee.data.dice.url;Zi.apiUrl=rt.endsWith("/")?rt.substring(0,rt.length-1):rt,Zi.apiVersion=Be,Zi.diceBotInfos=[];let ht=(1==Be?ft.names:ft.game_system).filter(xt=>"DiceBot"!=(1==Be?xt.system:xt.id)).map(xt=>{let pt=xt.sort_key&&xt.sort_key.indexOf("\u56fd\u969b\u5316")<0?xt.sort_key:xt.name.normalize("NFKD");for(let Qt of Zi.replaceData)Qt[2]&&xt.name===Qt[0]&&(pt=Qt[1],xt.name=Qt[2]),pt=pt.split(Qt[0].normalize("NFKD")).join(Qt[1].normalize("NFKD"));return xt.normalize=pt.replace(/[\u3041-\u3096]/g,Qt=>String.fromCharCode(Qt.charCodeAt(0)+96)).replace(/\u7b2c(.+?)\u7248/g,"\u30bf\u30a4$1\u30cf\u30f3").replace(/[\u30fb!?\uff01\uff1f\s\u3000:\uff1a=\uff1d\/\uff0f\uff08\uff09\(\)]+/g,"").replace(/([\u30a2\u30ab\u30b5\u30bf\u30ca\u30cf\u30de\u30e4\u30e9\u30ef])\u30fc+/g,"$1\u30a2").replace(/([\u30a4\u30ad\u30b7\u30c1\u30cb\u30d2\u30df\u30ea])\u30fc+/g,"$1\u30a4").replace(/([\u30a6\u30af\u30b9\u30c4\u30cc\u30d5\u30e0\u30e6\u30eb])\u30fc+/g,"$1\u30a6").replace(/([\u30a8\u30b1\u30bb\u30c6\u30cd\u30d8\u30e1\u30ec])\u30fc+/g,"$1\u30a8").replace(/([\u30aa\u30b3\u30bd\u30c8\u30ce\u30db\u30e2\u30e8\u30ed])\u30fc+/g,"$1\u30aa").replace(/\u30f3+\u30fc+/g,"\u30f3").replace(/\u30f3+/g,"\u30f3"),xt}).map(xt=>{const pt=/.+\:(.+)/.exec(1==Be?xt.system:xt.id);return xt.lang=pt?pt[1]:"A",xt}).sort((xt,pt)=>xt.lang<pt.lang?-1:xt.lang>pt.lang?1:xt.normalize==pt.normalize?0:xt.normalize<pt.normalize?-1:1);if(Zi.diceBotInfos=[],Zi.diceBotInfosIndexed=[],Zi.diceBotInfos.push(...ht.map(xt=>({id:1==Be?xt.system:xt.id,game:xt.name}))),ht.length>0){let xt=ht[0].normalize.substring(0,1),pt={index:ht[0].normalize.substring(0,1),infos:[]};for(let Qt of ht){let ln="Other"==Qt.lang?"\u305d\u306e\u4ed6":"ChineseTraditional"==Qt.lang?"\u6b63\u9ad4\u4e2d\u6587":"Korean"==Qt.lang?"\ud55c\uad6d\uc5b4":"English"==Qt.lang?"English":"SimplifiedChinese"==Qt.lang?"\u7b80\u4f53\u4e2d\u6587":Qt.normalize.substring(0,1);ln!==xt&&(xt=ln,Zi.diceBotInfosIndexed.push(pt),pt={index:ln,infos:[]}),pt.infos.push({id:1==Be?Qt.system:Qt.id,game:Qt.name})}Zi.diceBotInfosIndexed.push(pt),Zi.diceBotInfosIndexed.sort((Qt,ln)=>Qt.index==ln.index?0:Qt.index<ln.index?-1:1)}})}jt.setApiKey(Ee.data.webrtc.key),jt.open()}).on("FILE_LOADED",Ee=>{this.lazyNgZoneUpdate(!1)}).on("OPEN_NETWORK",Ee=>{console.log("OPEN_NETWORK",Ee.data.peerId),Fe.myCursor.peerId=jt.peer.peerId,Fe.myCursor.userId=jt.peer.userId,this.isLoggedin=!1}).on("NETWORK_ERROR",Ee=>{console.log("NETWORK_ERROR",Ee.data.peerId);let Be=Ee.data.errorType,ft=Ee.data.errorMessage;this.ngZone.run((0,L.A)(function*(){["peer-unavailable"].includes(Be)||(yield x.modalService.open(kf,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:ft}),["disconnected","socket-error","unavailable-id","authentication","server-error"].includes(Be)&&(yield x.modalService.open(kf,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:"\u3053\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b\u3068\u518d\u63a5\u7d9a\u3092\u8a66\u307f\u307e\u3059\u3002"}),jt.open(),x.isLoggedin=!1))}))}).on("CONNECT_PEER",Ee=>{Ee.isSendFromSelf&&(this.chatMessageService.calibrateTimeOffset(),this.isLoggedin||(this.isLoggedin=!0,s.sendOperationLog((jt.peer.isRoom?jt.peer.roomName+" \u306b":"\u4ed6\u8005\u3068")+"\u63a5\u7d9a\u3057\u305f"))),this.lazyNgZoneUpdate(Ee.isSendFromSelf)}).on("DISCONNECT_PEER",Ee=>{this.lazyNgZoneUpdate(Ee.isSendFromSelf),Ee.isSendFromSelf&&(this.isLoggedin=!1)}).on("MESSAGE_NORTIFICATION",Ee=>{Bf.isNoticeOn?(Ee.data?.isDirect||!this.noticeIntervalTimer)&&(clearTimeout(this.noticeIntervalTimer),this.noticeIntervalTimer=setTimeout(()=>{clearTimeout(this.noticeIntervalTimer),this.noticeIntervalTimer=null},100),this.notice()):this.noticeIntervalTimer&&(clearTimeout(this.noticeIntervalTimer),this.noticeIntervalTimer=null)}).on("PLAY_CUT_IN",-1e3,Ee=>{let Be=bt.instance.get(Ee.data.identifier);this.cutInService.play(Be,!!Ee.data.secret&&Ee.data.secret,!!Ee.data.test&&Ee.data.test,Ee.data.sender)}).on("STOP_CUT_IN",-1e3,Ee=>{this.cutInService.stop(Ee.data.identifier)}).on("POPUP_STAND_IMAGE",-1e3,Ee=>{let Be=bt.instance.get(Ee.data.standIdentifier),ft=bt.instance.get(Ee.data.characterIdentifier);this.standImageService.show(ft,Be,Ee.data.color?Ee.data.color:null,Ee.data.secret)}).on("FAREWELL_STAND_IMAGE",-1e3,Ee=>{this.standImageService.farewell(Ee.data.characterIdentifier)}).on("DELETE_STAND_IMAGE",-1e3,Ee=>{this.standImageService.destroy(Ee.data.characterIdentifier,Ee.data.identifier)}).on("DESTORY_STAND_IMAGE_ALL",-1e3,Ee=>{this.standImageService.destroyAll()}),function woe(){let t=window.navigator.userAgent.toLowerCase();if(t.indexOf("iphone")>-1||t.indexOf("ipad")>-1||t.indexOf("macintosh")>-1&&"ontouchend"in document){let e=document.createElement("style");e.innerHTML="\n      .chrome-smooth-image-trick {\n        transform-style: flat;\n      }\n      ",document.body.appendChild(e)}}()}static#t=this.beforeUnloadProc=e=>{e.preventDefault(),e.returnValue=""};ngOnInit(){window.addEventListener("beforeunload",t.beforeUnloadProc)}ngAfterViewInit(){let e;yi.defaultParentViewContainerRef=Ei.defaultParentViewContainerRef=Bo.defaultParentViewContainerRef=Bs.defaultParentViewContainerRef=_C.defaultParentViewContainerRef=this.modalLayerViewContainerRef,queueMicrotask(()=>{this.panelService.open(IS,{width:520,height:450,left:100}),this.panelService.open(Bf,{width:700,height:400,left:100,top:450})}),this.swUpdate.versionUpdates.subscribe(i=>{switch(i.type){case"VERSION_DETECTED":console.log(`Downloading new app version: ${i.version.hash}`),Notification.requestPermission().then(r=>{"granted"===r&&(e=new Notification("Udonarium with Fly",{body:"Udonarium with Fly \u306e\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u4e2d\u3067\u3059\u3002",icon:"card.png"}),e.addEventListener("click",function(o){return o.preventDefault(),o.stopPropagation(),e&&(e.close(),e=null),!1}))});break;case"VERSION_READY":console.log(`Current app version: ${i.currentVersion.hash}`),console.log(`New app version ready for use: ${i.latestVersion.hash}`),this.isUpdateCanceled||this.modalService.open(Fr,{title:"Udonarium with Fly \u306e\u66f4\u65b0",text:"Udonarium with Fly \u306e\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3057\u305f\u3002\u66f4\u65b0\u3092\u884c\u3044\u307e\u3059\u304b\uff1f",helpHtml:'<b style="color: red">\u66f4\u65b0\u306e\u969b\u306b\u30da\u30fc\u30b8\u3092\u518d\u8aad\u307f\u8fbc\u307f\u3057\u307e\u3059\u3002</b>\u624b\u52d5\u3067\u518d\u8aad\u307f\u8fbc\u307f\u3092\u884c\u3046\u3053\u3068\u3067\u3082\u66f4\u65b0\u53ef\u80fd\u3067\u3059\u3002',type:ur.OK_CANCEL,materialIcon:"browser_updated",action:()=>{this.swUpdate.activateUpdate().then(()=>{window.removeEventListener("beforeunload",t.beforeUnloadProc),document.location.reload()})},cancelAction:()=>{this.isUpdateCanceled=!0}});break;case"VERSION_INSTALLATION_FAILED":console.log(`Failed to install app version '${i.version.hash}': ${i.error}`)}})}ngOnDestroy(){ne.unregister(this),this.noticeIntervalTimer&&clearTimeout(this.noticeIntervalTimer)}open(e){let i=null,r={width:450,height:600,left:100};switch(e){case"PeerMenuComponent":r.width=520,i=IS;break;case"ChatWindowComponent":i=Bf,r.width=700;break;case"GameTableSettingComponent":i=g4,r={width:610,height:540,left:100};break;case"FileStorageComponent":i=Dl,r.width=700;break;case"GameCharacterSheetComponent":i=kl;break;case"JukeboxComponent":i=mee,r.height=540;break;case"GameObjectInventoryComponent":i=HJ;break;case"DiceRollTableSettingComponent":i=_re,r={width:645,height:475};break;case"CutInSettingComponent":i=zre,r={width:700,height:600}}i&&(r.top=20*(this.openPanelCount%10+1),r.left=100+5*(this.openPanelCount%20+1),this.openPanelCount=this.openPanelCount+1,this.panelService.open(i,r))}save(){var e=this;return(0,L.A)(function*(){if(e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i=0<jt.peer.roomName.length?jt.peer.roomName:"fly_\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf";yield e.saveDataService.saveRoomAsync(i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}handleFileSelect(e){let i=e.target,r=i.files;r.length&&zc.instance.load(r),i.value=""}lazyNgZoneUpdate(e){if(e){if(null!==this.immediateUpdateTimer)return;this.immediateUpdateTimer=setTimeout(()=>{this.immediateUpdateTimer=null,null!=this.lazyUpdateTimer&&(clearTimeout(this.lazyUpdateTimer),this.lazyUpdateTimer=null),this.ngZone.run(()=>{})},0)}else{if(null!==this.lazyUpdateTimer)return;this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,null!=this.immediateUpdateTimer&&(clearTimeout(this.immediateUpdateTimer),this.immediateUpdateTimer=null),this.ngZone.run(()=>{})},100)}}toolBox(e){const i=e.target,r=i.getBoundingClientRect(),o={x:window.pageXOffset+r.left+(this.isHorizontal?0:.9*i.clientWidth),y:window.pageYOffset+r.top+(this.isHorizontal?.9*i.clientHeight:0)},s=[],a=tc.instance.cutIns;s.push({name:"\u30ab\u30c3\u30c8\u30a4\u30f3\u518d\u751f",materialIcon:"play_arrow",action:null,subActions:0===a.length?[{name:"(\u30ab\u30c3\u30c8\u30a4\u30f3\u306a\u3057)",disabled:!0,center:!0}]:a.map(c=>({name:`${c.isValidAudio?"":"\u26a0\ufe0f"}${""==c.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":c.name}`,subActions:[{name:"\u5168\u54e1",action:()=>{ne.call("PLAY_CUT_IN",{identifier:c.identifier,secret:!1,sender:Fe.myCursor.peerId}),this.chatMessageService.sendOperationLog((""==c.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":c.name)+" \u3092\u518d\u751f\u3057\u305f")}},Zt,...this.otherPeers.map(u=>({name:u.name+(u===Fe.myCursor?" (\u3042\u306a\u305f)":""),color:u.color,default:!0,action:()=>{u!==Fe.myCursor&&ne.call("PLAY_CUT_IN",{identifier:c.identifier,secret:!0,sender:Fe.myCursor.peerId},u.peerId),ne.call("PLAY_CUT_IN",{identifier:c.identifier,secret:!0,sender:Fe.myCursor.peerId},Fe.myCursor.peerId)}}))]}))}),s.push(Zt),s.push({name:"\u30ab\u30c3\u30c8\u30a4\u30f3\u8a2d\u5b9a...",materialIcon:"movie_creation",action:()=>this.open("CutInSettingComponent")}),s.push({name:"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u8a2d\u5b9a...",materialIcon:"table_rows",action:()=>this.open("DiceRollTableSettingComponent")}),this.contextMenuService.open(o,s,"\u30c4\u30fc\u30eb\u30dc\u30c3\u30af\u30b9")}resetPointOfView(e){const i=e.target,r=i.getBoundingClientRect(),o={x:window.pageXOffset+r.left+(this.isHorizontal?0:.9*i.clientWidth),y:window.pageYOffset+r.top+(this.isHorizontal?.9*i.clientHeight:0)};this.contextMenuService.open(o,[{name:"\u521d\u671f\u8996\u70b9\u306b\u623b\u3059",action:()=>ne.trigger("RESET_POINT_OF_VIEW",null)},{name:"\u771f\u4e0a\u304b\u3089\u8996\u308b",action:()=>ne.trigger("RESET_POINT_OF_VIEW","top")}],"\u8996\u70b9\u30ea\u30bb\u30c3\u30c8")}standSetteings(e){const i=e.target,r=i.getBoundingClientRect(),o={x:window.pageXOffset+r.left+(this.isHorizontal?0:.9*i.clientWidth),y:window.pageYOffset+r.top+(this.isHorizontal?.9*i.clientHeight:0)},s=Wc.isShowStand,a=Wc.isShowNameTag,c=Wc.isCanBeGone;this.contextMenuService.open(o,[{name:(Ho.instance.gridShow?"\u2611":"\u2610")+"\u30c6\u30fc\u30d6\u30eb\u30b0\u30ea\u30c3\u30c9\u3092\u5e38\u306b\u8868\u793a",action:()=>{Ho.instance.gridShow=!Ho.instance.gridShow,ne.trigger("UPDATE_GAME_OBJECT",Ho.instance.toContext())},checkBox:"check"},{name:(Ho.instance.gridSnap?"\u2611":"\u2610")+"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u79fb\u52d5\u6642\u306b\u30b9\u30ca\u30c3\u30d7",action:()=>{Ho.instance.gridSnap=!Ho.instance.gridSnap},checkBox:"check"},Zt,{name:(Bf.isNoticeOn?"\u2611":"\u2610")+"\u30c1\u30e3\u30c3\u30c8\u53d7\u4fe1\u6642\u306b\u97f3\u3067\u901a\u77e5",action:()=>{Bf.isNoticeOn=!Bf.isNoticeOn},checkBox:"check"},Zt,{name:(s?"\u2611":"\u2610")+"\u30b9\u30bf\u30f3\u30c9\u8868\u793a",action:()=>{Wc.isShowStand=!s},checkBox:"check"},{name:(a?"\u2611":"\u2610")+"\u30cd\u30fc\u30e0\u30bf\u30b0\u8868\u793a",action:()=>{Wc.isShowNameTag=!a},level:1,disabled:!Wc.isShowStand,checkBox:"check"},{name:(c?"\u2611":"\u2610")+"\u900f\u660e\u5316\u3001\u81ea\u52d5\u9000\u53bb",action:()=>{Wc.isCanBeGone=!c},level:1,disabled:!Wc.isShowStand,checkBox:"check"},Zt,{name:"\u8868\u793a\u30b9\u30bf\u30f3\u30c9\u5168\u6d88\u53bb",action:()=>ne.trigger("DESTORY_STAND_IMAGE_ALL",null)}],"\u500b\u4eba\u8a2d\u5b9a")}diceAllOpne(){this.modalService.open(Fr,{title:"\u30c0\u30a4\u30b9\u4e00\u6589\u516c\u958b",text:"\u30c6\u30fc\u30d6\u30eb\u4e0a\u306e\u30c0\u30a4\u30b9\u3001\u30b3\u30a4\u30f3\u3092\u516c\u958b\u3057\u307e\u3059\u304b\uff1f",help:"\u300c\u4e00\u6589\u516c\u958b\u3057\u306a\u3044\u300d\u8a2d\u5b9a\u306e\u3082\u306e\u306f\u516c\u958b\u3055\u308c\u307e\u305b\u3093\u3002",type:ur.OK_CANCEL,materialIcon:"all_out",action:()=>{ne.trigger("DICE_ALL_OPEN",null)}})}deleteGameObject(e){throw new Error("Method not implemented.")}rotateChange(e){this.isHorizontal=e}closeImagePreview(){URL.revokeObjectURL(t.imageUrl),t.imageUrl=""}static#n=this.\u0275fac=function(i){return new(i||t)(Y(SS),Y(Ei),Y(yi),Y(lr),Y(vo),Y(ES),Y(ll),Y(Pn),Y(Bo),Y(Bs),Y(_C))};static#i=this.\u0275cmp=In({type:t,selectors:[["app-root"]],viewQuery:function(i,r){if(1&i&&Ln(boe,7,xa),2&i){let o;Bn(o=Un())&&(r.modalLayerViewContainerRef=o.first)}},decls:99,vars:14,consts:[["modalLayer",""],["id","app-table-layer",2,"position","absolute","width","100%","height","100%","overflow","hidden"],[3,"rotateEvent","top","left","width","height","title","isAbleFullScreenButton","isAbleCloseButton","isAbleRotateButton"],[3,"ngClass"],[3,"click"],["routerLink","/","routerLinkActive","active"],[1,"material-icons","icon-size"],[1,"material-icons"],["routerLink","/","routerLinkActive","active",2,"pointer-events","none"],[1,"self-only"],["type","file","multiple","","accept","application/xml,text/xml,application/zip",2,"display","none",3,"change"],[3,"click",4,"ngIf"],["style","pointer-events: none;",4,"ngIf"],[1,"self-only-indicater",2,"font-size","8px","text-align","center"],[1,"networkIndicator"],["class","image-view-background is-fill",3,"click",4,"ngIf"],[2,"pointer-events","none"],[1,"material-icons","vibration-amine"],[1,"image-view-background","is-fill",3,"click"],[1,"close-button","is-pointer-events-none",2,"z-index","10"],["draggable","false",1,"contain-image",3,"src"]],template:function(i,r){if(1&i){const o=Le();p(0,"div",1),Ge(1,"game-table"),g(),p(2,"ui-panel",2),he("rotateEvent",function(a){return V(o),H(r.rotateChange(a))}),p(3,"nav",3)(4,"ul")(5,"li",4),he("click",function(){return V(o),H(r.open("PeerMenuComponent"))}),p(6,"a",5)(7,"div")(8,"i",6),y(9,"people"),g()(),p(10,"div"),y(11,"\u63a5\u7d9a"),g()()(),p(12,"li",4),he("click",function(){return V(o),H(r.open("ChatWindowComponent"))}),p(13,"a",5)(14,"div")(15,"i",6),y(16,"speaker_notes"),g()(),p(17,"div"),y(18,"\u30c1\u30e3\u30c3\u30c8\u753b\u9762"),g()()(),p(19,"li",4),he("click",function(){return V(o),H(r.open("GameTableSettingComponent"))}),p(20,"a",5)(21,"div")(22,"i",6),y(23,"layers"),g()(),p(24,"div"),y(25,"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a"),g()()(),p(26,"li",4),he("click",function(){return V(o),H(r.open("FileStorageComponent"))}),p(27,"a",5)(28,"div")(29,"i",6),y(30,"photo_library"),g()(),p(31,"div"),y(32,"\u753b\u50cf"),g()()(),p(33,"li",4),he("click",function(){return V(o),H(r.open("JukeboxComponent"))}),p(34,"a",5)(35,"div")(36,"i",7),y(37,"queue_music"),g()(),p(38,"div"),y(39,"\u97f3\u697d"),g()()(),p(40,"li",4),he("click",function(a){return V(o),H(r.toolBox(a))}),p(41,"a",8)(42,"div")(43,"i",7),y(44,"build"),g()(),p(45,"div"),y(46,"\u30c4\u30fc\u30eb\u30dc\u30c3\u30af\u30b9"),g()()(),p(47,"li",4),he("click",function(){return V(o),H(r.open("GameObjectInventoryComponent"))}),p(48,"a",5)(49,"div")(50,"i",6),y(51,"folder_shared"),g()(),p(52,"div"),y(53,"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),g()()(),p(54,"li",4),he("click",function(){return V(o),H(r.diceAllOpne())}),p(55,"a",5)(56,"div")(57,"i",6),y(58,"all_out"),g()(),p(59,"div"),y(60,"\u30c0\u30a4\u30b9\u4e00\u6589\u516c\u958b"),g()()(),p(61,"li",4),he("click",function(a){return V(o),H(r.standSetteings(a))}),p(62,"a",8)(63,"div")(64,"i",6),y(65,"how_to_reg"),g()(),p(66,"div"),y(67,"\u500b\u4eba\u8a2d\u5b9a"),p(68,"sup",9),y(69,"*"),g()()()(),p(70,"li",4),he("click",function(a){return V(o),H(r.resetPointOfView(a))}),p(71,"a",8)(72,"div")(73,"i",6),y(74,"remove_red_eye"),g()(),p(75,"div"),y(76,"\u8996\u70b9\u30ea\u30bb\u30c3\u30c8"),p(77,"sup",9),y(78,"*"),g()()()(),p(79,"li")(80,"a",5)(81,"label")(82,"div")(83,"i",7),y(84,"open_in_browser"),g()(),p(85,"div"),y(86,"ZIP\u8aad\u8fbc"),g(),p(87,"input",10),he("change",function(a){return V(o),H(r.handleFileSelect(a))}),g()()()(),q(88,yoe,7,0,"li",11)(89,Coe,7,1,"li",12),g(),p(90,"div",13)(91,"b")(92,"sup",9),y(93,"*"),g(),y(94,"\u306f\u81ea\u5206\u306e\u307f"),g()()()(),Ge(95,"div",null,0)(97,"network-indicator",14),q(98,xoe,6,5,"div",15)}2&i&&(h(2),m("top",0)("left",0)("width",100)("height",710)("title","\u30e1\u30cb\u30e5\u30fc")("isAbleFullScreenButton",!1)("isAbleCloseButton",!1)("isAbleRotateButton",!0),h(),m("ngClass",Ke(12,voe,r.isHorizontal)),h(85),m("ngIf",!r.isSaveing),h(),m("ngIf",r.isSaveing),h(9),m("ngIf",r.imageUrl))},styles:["[_nghost-%COMP%]{display:block}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{text-align:center;padding:5px;color:#ccc;color:#444;cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer;white-space:nowrap}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:hover{color:#ccc;background-color:#1e1e1ecc}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{height:128px;width:128px;font-size:8px;-webkit-user-select:none;user-select:none}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:24px}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{text-decoration:none}.icon-size[_ngcontent-%COMP%]{font-size:40px}.side-menu[_ngcontent-%COMP%]{top:0;left:0;box-sizing:border-box;overflow:auto;position:absolute;color:#ccc;background-color:#1e1e1ecc;border:solid 1px #999;padding:0;height:100%;width:300px}.networkIndicator[_ngcontent-%COMP%]{display:none;z-index:9999;pointer-events:none;position:absolute;top:3px;right:3px;height:30px;width:30px}.vibration-amine[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_vibration .2s infinite}@keyframes _ngcontent-%COMP%_vibration{0%{transform:scale(1) translate(0)}50%{transform:scale(1.02,.95) translateY(5%)}to{transform:scale(1) translate(0)}}.self-only[_ngcontent-%COMP%]{color:red}.horizontal[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap}.horizontal[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{display:inline-block;width:74px}[_ngcontent-%COMP%]:not(.horizontal)   .self-only-indicater[_ngcontent-%COMP%]{margin-top:2em}.horizontal[_ngcontent-%COMP%]   .self-only-indicater[_ngcontent-%COMP%]{display:none}.image-view-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1e4d;z-index:100000000000;position:absolute;inset:0;width:100%;height:100%;box-sizing:border-box;overflow:visible;overscroll-behavior:contain;-webkit-overflow-scrolling:touch;display:flex;justify-content:center;align-items:center}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{position:absolute;right:16px;top:16px}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:36px}.contain-image[_ngcontent-%COMP%]{display:block;max-width:calc(100% - 32px);max-height:calc(100% - 32px);min-width:100px;min-height:120px;box-sizing:border-box;object-fit:contain}"],data:{animation:[Xn("fadeInOut",[an("void => *",[rn("100ms ease-out",En([We({opacity:0,offset:0}),We({opacity:1,offset:1})]))]),an("* => void",[rn("100ms ease-in",En([We({opacity:1,offset:0}),We({opacity:0,offset:1})]))])])]}})}return t})();yi.UIPanelComponentClass=y5,Bo.ContextMenuComponentClass=aQ,Ei.ModalComponentClass=vee;const R5=t=>({"red-eye":t}),Eoe=t=>({selecter:t}),Ioe=t=>({selected:t});function Toe(t,n){1&t&&Ge(0,"badge",14),2&t&&m("count",v(2).countImagesHasWord(null))("@.disabled",!0)}function Soe(t,n){if(1&t){const e=Le();p(0,"label")(1,"input",27),at("ngModelChange",function(r){V(e);const o=v();return it(o.searchNoTagImage,r)||(o.searchNoTagImage=r),H(r)}),he("change",function(){V(e);const r=v();return H(r.searchNoTagImage=!!r.searchNoTagImage)}),g(),p(2,"div",28)(3,"s"),y(4,"No Tag"),g(),q(5,Toe,1,2,"badge",29),g()()}if(2&t){const e=v();h(),Et("checked",e.searchNoTagImage?"checked":""),st("ngModel",e.searchNoTagImage),h(4),m("ngIf",e.countImagesHasWord(null)>0)}}function Moe(t,n){if(1&t&&Ge(0,"badge",14),2&t){const e=v().$implicit;m("count",v().countImagesHasWord(e))("@.disabled",!0)}}function Doe(t,n){if(1&t){const e=Le();p(0,"label")(1,"input",30),he("change",function(){const r=V(e).$implicit;return H(v().onSelectedWord(r))}),g(),p(2,"div"),y(3),q(4,Moe,1,2,"badge",29),g()()}if(2&t){const e=n.$implicit,i=v();h(),Et("value",e),m("checked",i.searchWords.includes(e)),h(2),Xe(e),h(),m("ngIf",i.countImagesHasWord(e)>0)}}function koe(t,n){1&t&&ii(0)}function Ooe(t,n){if(1&t&&(p(0,"label",44),y(1),g()),2&t){const e=v().$implicit;h(),Xe(e)}}function Aoe(t,n){1&t&&(p(0,"span",45),y(1,"\u2026"),g())}function Poe(t,n){if(1&t&&(Ue(0),q(1,Ooe,2,1,"label",42)(2,Aoe,2,0,"span",43),ze()),2&t){const e=n.index;h(),m("ngIf",e<6),h(),m("ngIf",6==e)}}function Foe(t,n){if(1&t&&(p(0,"div",41),q(1,Poe,3,2,"ng-container",16),g()),2&t){const e=v().$implicit,i=v();h(),m("ngForOf",i.getTagWords(e))}}function Noe(t,n){1&t&&(p(0,"div",41)(1,"s",46),y(2,"No Tag"),g()())}function Roe(t,n){1&t&&(p(0,"div",47)(1,"i",48),y(2,"visibility"),g()())}function Loe(t,n){if(1&t){const e=Le();p(0,"img",49),Ut(1,"safe"),he("click",function(){V(e);const r=v().$implicit;return H(v().onSelectedFile(r))}),g()}if(2&t){const e=v().$implicit;m("src",zt(1,2,e.url,"resourceUrl"),bn)("alt",e.name)}}function Boe(t,n){1&t&&Ge(0,"img",50),2&t&&Et("alt",v().$implicit.name)}function Uoe(t,n){if(1&t){const e=Le();p(0,"div",31)(1,"div",32),q(2,koe,1,0,"ng-container",33)(3,Foe,2,1,"ng-template",null,0,Ai)(5,Noe,3,0,"ng-template",null,1,Ai),p(7,"div",34)(8,"button",35),he("click",function(){const r=V(e).$implicit;return H(v().chanageImageView(r))}),p(9,"i",36),y(10,"zoom_in"),g()()()(),q(11,Roe,3,0,"div",37),p(12,"span",38),q(13,Loe,2,5,"img",39)(14,Boe,1,1,"img",40),g()()}if(2&t){const e=n.$implicit,i=pn(4),r=pn(6),o=v();m("@scaleInOut",void 0)("ngClass",Ke(8,Ioe,o.selected(e))),h(2),m("ngIf",o.getTagWords(e).length>0)("ngIfThen",i)("ngIfElse",r),h(9),m("ngIf",o.getHidden(e)),h(2),m("ngIf",0<e.url.length),h(),m("ngIf",e.url.length<=0)}}function zoe(t,n){if(1&t){const e=Le();p(0,"label",61),he("click",function(){const r=V(e).$implicit;return H(v(3).removeTagWord(r))}),y(1),p(2,"sup",62),y(3,"\xd7"),g()()}if(2&t){const e=n.$implicit;h(),Xe(e)}}function Hoe(t,n){if(1&t&&(Ue(0),p(1,"span",59),q(2,zoe,4,1,"label",60),g(),ze()),2&t){const e=v(2);h(2),m("ngForOf",e.selectedImagesOwnWords())}}function Voe(t,n){1&t&&(Ue(0),p(1,"span",63)(2,"s"),y(3,"No Tag"),g()(),ze())}function joe(t,n){if(1&t&&(p(0,"option",64),y(1),g()),2&t){const e=n.$implicit;Et("value",e),h(),Xe(e)}}function Goe(t,n){if(1&t){const e=Le();p(0,"div",51)(1,"div")(2,"div",52)(3,"button",53),he("click",function(){V(e);const r=v();return H(r.setectedImagesToHidden(!r.selectedImagesIsHidden))}),p(4,"i",10),y(5),g()()(),p(6,"button",54),he("click",function(){return V(e),H(v().onUnselect())}),y(7),g(),p(8,"input",55),at("ngModelChange",function(r){V(e);const o=v();return it(o.addingTagWord,r)||(o.addingTagWord=r),H(r)}),g(),p(9,"button",56),he("click",function(){return V(e),H(v().addTagWord())}),y(10,"\u30bf\u30b0\u8ffd\u52a0 \u27a1"),g(),q(11,Hoe,3,1,"ng-container",15)(12,Voe,4,0,"ng-container",15),g(),p(13,"datalist",57),q(14,joe,2,2,"option",58),g()()}if(2&t){const e=v();m("@fadeAndUpInOut",void 0),h(3),en("title",e.selectedImagesIsHidden?"\u9078\u629e\u753b\u50cf\u3092\u8868\u793a\u8a2d\u5b9a\u306b\u3059\u308b":"\u9078\u629e\u753b\u50cf\u3092\u975e\u8868\u793a\u8a2d\u5b9a\u306b\u3059\u308b"),h(),m("ngClass",Ke(14,R5,e.selectedImagesIsHidden)),h(),Xe(e.selectedImagesIsHidden?"visibility":"visibility_off"),h(2),Si("\u9078\u629e\u89e3\u9664 (",e.selectedImageFiles.length," \u9078\u629e\u4e2d)"),h(),JE("list","",e.panelId,"_suggest"),st("ngModel",e.addingTagWord),h(),m("disabled",null==e.addingTagWord||""===e.addingTagWord.trim()),h(2),m("ngIf",e.selectedImagesOwnWords().length>0),h(),m("ngIf",0==e.selectedImagesOwnWords().length),h(),go("id","",e.panelId,"_suggest"),h(),m("ngForOf",e.suggestWords())}}let Dl=(()=>{class t{static#e=this.sortOrder=[];get images(){const e=Rs.searchImages(this.searchWords,this.searchNoTagImage&&this.countAllImagesHasWord(null)>0,this.serchCondIsOr,this.isShowHideImages),i=e.map(r=>r.identifier);return this.selectedImageFiles=this.selectedImageFiles.filter(r=>i.includes(r.identifier)),this.isSort?Rs.sortImagesByWords(e,t.sortOrder):e}get searchNoTagImage(){return this._searchNoTagImage}set searchNoTagImage(e){e?t.sortOrder.unshift(null):t.sortOrder=t.sortOrder.filter(i=>null!=i),t.sortOrder=Array.from(new Set(t.sortOrder)),this._searchNoTagImage=e,ne.trigger("CHANGE_SORT_ORDER",null)}get searchAllImage(){if(!this.searchNoTagImage&&this.countAllImagesHasWord(null)>0)return!1;for(const e of this.allImagesOwnWords)if(!this.searchWords.includes(e))return!1;return!0}get isSelected(){let e=this.selectedImageFiles.length>0;return e||(this.addingTagWord=""),e}get selectedImagesIsHidden(){return Rs.imagesIsHidden(this.selectedImageFiles)}get allImagesOwnWords(){return Rs.allImagesOwnWords(this.isShowHideImages)}constructor(e,i,r,o){this.changeDetector=e,this.panelService=i,this.modalService=r,this.chatMessageService=o,this._searchNoTagImage=!0,this.serchCondIsOr=!0,this.addingTagWord="",this.searchWords=[],this.deletedWords=[],this.selectedImageFiles=[],this.isSort=!0,this.isShowHideImages=!1}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7"),this.searchWords=this.allImagesOwnWords,this.panelId=oa.generateUuid()}ngAfterViewInit(){ne.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("OPERATE_IMAGE_TAGS",e=>{this.changeDetector.markForCheck()}).on("CHANGE_SORT_ORDER",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){ne.unregister(this)}allImages(){return Rs.allImages(this.isShowHideImages)}countAllImagesHasWord(e){return Rs.countAllImagesHasWord(e,this.isShowHideImages)}countImagesHasWord(e){let i=0;if(null!=e&&""===e.trim())return i;for(const r of this.images){const o=ui.get(r.identifier);null==e?(!o||null==o.tag||""==o.tag.trim())&&i++:o&&o.containsWords(e.trim(),!1)&&i++}return i}handleFileSelect(e){let i=e.target,r=i.files;r.length&&zc.instance.load(r),i.value=""}selected(e){return this.selectedImageFiles.map(i=>i.identifier).includes(e.identifier)}selectedImagesOwnWords(e=!1){return Rs.imagesOwnWords(this.selectedImageFiles,e)}onSelectedWord(e){null==e||""===e.trim()||(this.searchWords.includes(e)?(this.searchWords=this.searchWords.filter(i=>e!==i),t.sortOrder=t.sortOrder.filter(i=>e!==i)):(this.searchWords.push(e),t.sortOrder.unshift(e)),t.sortOrder=Array.from(new Set(t.sortOrder)),ne.trigger("CHANGE_SORT_ORDER",e))}onSelectedFile(e){this.selected(e)?this.selectedImageFiles=this.selectedImageFiles.filter(i=>i.identifier!==e.identifier):this.selectedImageFiles.push(e)}getTagWords(e){const i=ui.get(e.identifier);return i?i.words:[]}getHidden(e){const i=ui.get(e.identifier);return!!i&&i.hide}onSearchAllImage(){this.searchAllImage?(this.searchWords=[],this._searchNoTagImage=!1):(this.searchWords=this.allImagesOwnWords,this._searchNoTagImage=!0)}onUnselect(){this.selectedImageFiles=[]}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(Fr,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:ur.OK_CANCEL,materialIcon:"visibility",action:()=>{this.chatMessageService.sendOperationLog("\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7 \u304b\u3089\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u305f"),this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}setectedImagesToHidden(e){this.modalService.open(Fr,{title:e?"\u975e\u8868\u793a\u306b\u8a2d\u5b9a":"\u975e\u8868\u793a\u8a2d\u5b9a\u3092\u89e3\u9664",text:`\u753b\u50cf${e?"\u3092\u975e\u8868\u793a\u306b\u8a2d\u5b9a":"\u306e\u975e\u8868\u793a\u8a2d\u5b9a\u3092\u89e3\u9664"}\u3057\u307e\u3059\u304b\uff1f`,help:e?"\u9078\u629e\u3057\u305f\u753b\u50cf\u3092\u975e\u8868\u793a\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u3053\u308c\u306f\u300c\u610f\u56f3\u305b\u305a\u306b\u30cd\u30bf\u30d0\u30ec\u3092\u898b\u3066\u3057\u307e\u3046\u300d\u3053\u3068\u306a\u3069\u3092\u9632\u3050\u3082\u306e\u3067\u3042\u308a\u3001\u4ed6\u8005\u304b\u3089\u5b8c\u5168\u306b\u96a0\u3059\u3082\u306e\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002":"\u9078\u629e\u3057\u305f\u753b\u50cf\u306e\u975e\u8868\u793a\u8a2d\u5b9a\u3092\u89e3\u9664\u3057\u307e\u3059\u3002",type:ur.OK_CANCEL,materialIcon:e?"visibility_off":"visibility",action:()=>{for(const i of this.selectedImageFiles){const r=ui.get(i.identifier)||ui.create(i.identifier);r.hide=e,ne.call("OPERATE_IMAGE_TAGS",r.identifier)}}})}addTagWord(){if(null==this.addingTagWord||""==this.addingTagWord.trim())return;const e=this.addingTagWord.trim().split(/\s+/);this.modalService.open(Fr,{title:"\u753b\u50cf\u306b\u30bf\u30b0\u3092\u8ffd\u52a0",text:"\u753b\u50cf\u306b\u30bf\u30b0\u3092\u8ffd\u52a0\u3057\u307e\u3059\u304b\uff1f",helpHtml:"\u9078\u629e\u3057\u305f\u753b\u50cf\u306b "+e.map(i=>`<b class="word-tag">${ke.escapeHtml(i)}</b>`).join(" ")+" \u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002",type:ur.OK_CANCEL,materialIcon:"sell",action:()=>{let i=null;for(const r of this.selectedImageFiles)i=(ui.get(r.identifier)||ui.create(r.identifier)).addWords(e);i&&(this.serchCondIsOr&&this.searchWords.push(...i),t.sortOrder.unshift(...i)),this.serchCondIsOr&&(this.searchWords=Array.from(new Set(this.searchWords)).sort()),t.sortOrder=Array.from(new Set(t.sortOrder)),ne.trigger("CHANGE_SORT_ORDER",i),this.addingTagWord=""}})}removeTagWord(e){this.modalService.open(Fr,{title:"\u753b\u50cf\u304b\u3089\u30bf\u30b0\u3092\u524a\u9664",text:"\u753b\u50cf\u304b\u3089\u30bf\u30b0\u3092\u524a\u9664\u3057\u307e\u3059\u304b\uff1f",helpHtml:`\u9078\u629e\u3057\u305f\u753b\u50cf\u304b\u3089 <b class="word-tag">${ke.escapeHtml(e)}</b> \u3092\u524a\u9664\u3057\u307e\u3059\u3002`,type:ur.OK_CANCEL,materialIcon:"sell",action:()=>{if(null==e||""==e.trim())return;for(const r of this.selectedImageFiles){let o=ui.get(r.identifier);o&&o.removeWords(e)}const i=this.allImagesOwnWords;this.searchWords=this.searchWords.filter(r=>i.includes(r)),this.deletedWords.push(e),this.deletedWords=Array.from(new Set(this.deletedWords)),ne.trigger("CHANGE_SORT_ORDER",this.deletedWords)}})}identify(e,i){return i.identifier}suggestWords(){const e=this.selectedImagesOwnWords(!0);return Array.from(new Set(this.allImagesOwnWords.concat(this.deletedWords))).filter(i=>0!==i.indexOf("*")&&!e.includes(i))}chanageImageView(e){e.state===Ri.COMPLETE?($c.imageUrl&&URL.revokeObjectURL($c.imageUrl),$c.imageUrl=URL.createObjectURL(e.blob)):$c.imageUrl=e.url}static#t=this.\u0275fac=function(i){return new(i||t)(Y(Zr),Y(yi),Y(Ei),Y(vo))};static#n=this.\u0275cmp=In({type:t,selectors:[["file-storage"]],decls:41,vars:19,consts:[["tagsBlock",""],["noTagBlock",""],[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","image/*",2,"display","none",3,"change"],[1,"sticky-top"],[2,"float","right","margin-top","3px","margin-right","3px"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"click","checked"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[1,"word-selecter"],["name","word-selecter","type","checkbox","value","ALL",3,"click","checked"],[1,"all-tags"],[1,"badge",3,"count"],[4,"ngIf"],[4,"ngFor","ngForOf"],[2,"white-space","nowrap"],[2,"margin-left","3px",3,"ngModelChange","ngModel"],["value","true"],["value",""],["sytle","white-space: nowrap","title","\u6700\u8fd1\u4f7f\u3063\u305f\u30bf\u30b0\u306e\u753b\u50cf\u3092\u524d\u306b"],["name","is-sort","value","Sort","type","checkbox",3,"ngModelChange","change","ngModel","checked"],[2,"font-size","smaller","margin-right","3px"],["id","file-list",2,"padding-top","3px",3,"ngClass"],["class","image","style","text-align: center; min-width: 100px; height: 120px; position: relative;",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["class","sticky-bottom",4,"ngIf"],["name","word-selecter","type","checkbox","value","No Tag",3,"ngModelChange","change","ngModel","checked"],[1,"no-tag"],["class","badge",3,"count",4,"ngIf"],["name","word-selecter","type","checkbox",3,"change","value","checked"],[1,"image",2,"text-align","center","min-width","100px","height","120px","position","relative",3,"ngClass"],[2,"position","absolute","font-size","xx-small","text-align","left","bottom","0px","width","100%","height","100%","overflow","hidden","pointer-events","none"],[4,"ngIf","ngIfThen","ngIfElse"],[1,"zoom-in",2,"z-index","10","position","absolute","right","0px","bottom","2px"],[1,"zoom-button",3,"click"],[1,"material-icons"],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],[2,"cursor","pointer"],["height","120","draggable","false",3,"src","alt","click",4,"ngIf"],["src","assets/images/loading.gif","draggable","false",3,"alt",4,"ngIf"],[2,"position","absolute","bottom","0px","z-index","5"],["class","word-tag grow","style","display: block; width: 88px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],["class","grow","style","display: block; width: 88px; overflow: hidden; padding-left: 2px; font-weight: bold; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],[1,"word-tag","grow",2,"display","block","width","88px","overflow","hidden","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"display","block","width","88px","overflow","hidden","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"color","gray","display","block","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons","red-eye",2,"margin-right","2px","font-size","16px","display","block"],["height","120","draggable","false",3,"click","src","alt"],["src","assets/images/loading.gif","draggable","false",3,"alt"],[1,"sticky-bottom"],[2,"margin-left","3px","float","right"],[2,"padding","2px 0.5em",3,"click"],[2,"font-size","x-small","margin-right","2em",3,"click"],["type","text","placeholder","\u30b9\u30da\u30fc\u30b9 \u533a\u5207\u308a\u3067 \u8907\u6570\u53ef\u80fd",2,"width","14em",3,"ngModelChange","ngModel"],[2,"font-size","x-small",3,"click","disabled"],[3,"id"],[3,"value",4,"ngFor","ngForOf"],[2,"user-select","none"],["class","word-tag","style","cursor: pointer; font-size: smaller",3,"click",4,"ngFor","ngForOf"],[1,"word-tag",2,"cursor","pointer","font-size","smaller",3,"click"],[2,"font-size","xx-small","color","red"],[2,"font-size","smaller","font-weight","bolder","margin-left","3px","color","gray"],[3,"value"]],template:function(i,r){1&i&&(p(0,"label")(1,"span",2)(2,"span")(3,"i",3),y(4,"add_photo_alternate"),g()(),p(5,"span"),y(6,"\u3053\u3053\u306b\u753b\u50cf\u3092\u30c9\u30ed\u30c3\u30d7"),g(),p(7,"span",4),y(8,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),g(),p(9,"input",5),he("change",function(s){return r.handleFileSelect(s)}),g(),p(10,"span",4),Ge(11,"br"),y(12,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d2MB\u307e\u3067"),g()()(),p(13,"div",6)(14,"div",7)(15,"label",8)(16,"input",9),he("click",function(s){return r.onShowHiddenImages(s)}),g(),p(17,"i",10),y(18),g()()(),p(19,"span",11)(20,"label")(21,"input",12),he("click",function(){return r.onSearchAllImage()}),g(),p(22,"div",13)(23,"b"),y(24,"ALL"),g(),Ge(25,"badge",14),g()(),q(26,Soe,6,3,"label",15)(27,Doe,5,4,"label",16),g(),p(28,"span",17)(29,"select",18),at("ngModelChange",function(s){return it(r.serchCondIsOr,s)||(r.serchCondIsOr=s),s}),p(30,"option",19),y(31,"\u3044\u305a\u308c\u304b (OR)"),g(),p(32,"option",20),y(33,"\u3059\u3079\u3066 (AND)"),g()(),p(34,"label",21)(35,"input",22),at("ngModelChange",function(s){return it(r.isSort,s)||(r.isSort=s),s}),he("change",function(){return r.isSort=!!r.isSort}),g(),p(36,"b",23),y(37,"\u30bd\u30fc\u30c8"),g()()()(),p(38,"div",24),q(39,Uoe,15,10,"div",25),g(),q(40,Goe,15,16,"div",26)),2&i&&(h(16),Et("checked",r.isShowHideImages?"checked":""),h(),m("ngClass",Ke(15,R5,r.isShowHideImages)),h(),Xe(r.isShowHideImages?"visibility":"visibility_off"),h(3),Et("checked",r.searchAllImage?"checked":""),h(4),m("count",r.images.length)("@.disabled",!0),h(),m("ngIf",r.countAllImagesHasWord(null)>0),h(),m("ngForOf",r.allImagesOwnWords),h(2),st("ngModel",r.serchCondIsOr),h(6),Et("checked",r.isSort?"checked":""),st("ngModel",r.isSort),h(3),m("ngClass",Ke(17,Eoe,r.isSelected)),h(),m("ngForOf",r.images)("ngForTrackBy",r.identify),h(),m("ngIf",r.isSelected))},dependencies:[Ni,nr,ri,na,ia,kr,Ea,Ia,Or,Cr,j0,cr],styles:['[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;max-height:100%;max-width:100%;box-sizing:border-box;overflow:visible;color:#444;z-index:9000;overscroll-behavior:contain;-webkit-overflow-scrolling:touch;cursor:grab}.drop-zone[_ngcontent-%COMP%]{display:block;-webkit-user-select:none;user-select:none;border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer}.drop-zone[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.image[_ngcontent-%COMP%]{font-size:0;display:inline-block;border:2px solid transparent;margin-right:-2px;cursor:pointer}.image[_ngcontent-%COMP%]:hover{border:2px dotted red;transform:scale(1.08);z-index:150;transition-duration:60ms}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom}.image.selected[_ngcontent-%COMP%]{border:2px solid red}.selecter[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]:not(.selected)   img[_ngcontent-%COMP%]{filter:saturate(40%) opacity(90%) blur(2px)}.image[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(1px);backdrop-filter:blur(1px);filter:none!important}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.sticky-top[_ngcontent-%COMP%]{position:sticky;top:0;background-color:#f0dabde6;border-bottom:1px dotted #666;z-index:100}.sticky-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;background-color:#f0dabde6;border-top:1px dotted #666;z-index:200}.word-tag[_ngcontent-%COMP%]{margin-right:3px;display:inline-block;color:#000;font-weight:bolder}.word-tag[_ngcontent-%COMP%]:hover{color:red}.word-selecter[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.word-selecter[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{display:none}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div.all-tags[_ngcontent-%COMP%]{background-color:#eee;color:#008b8b}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}.zoom-button[_ngcontent-%COMP%]{width:24px;height:24px;border-radius:100px;padding:1px;pointer-events:auto;cursor:zoom-in}.zoom-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{display:inline-block;font-size:16px;vertical-align:bottom}'],data:{animation:[Xn("scaleInOut",[an("void => *",[rn("200ms ease",En([We({transform:"scale3d(0, 0, 0)",offset:0}),We({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),an("* => void",[rn("180ms ease",We({transform:"scale3d(0, 0, 0)"}))])]),Xn("fadeAndUpInOut",[an("void => *",[rn("100ms ease-in-out",En([We({"transform-origin":"center bottom",transform:"translateY(8px) scaleY(0)",opacity:.6}),We({"transform-origin":"center bottom",transform:"translateY(0px) scaleY(1.0)",opacity:1})]))]),an("* => void",[rn("100ms ease-in-out",We({"transform-origin":"center bottom",transform:"translateY(0px) scaleY(1.0)",opacity:1})),rn("100ms ease-in-out",We({"transform-origin":"center bottom",transform:"translateY(8px) scaleY(0)",opacity:.6}))])])]},changeDetection:0})}return t})();const Woe=t=>({"red-eye":t}),$oe=t=>({"current-images":t});function Yoe(t,n){1&t&&Ge(0,"badge",10),2&t&&m("count",v(2).countImagesHasWord(null))("@.disabled",!0)}function Zoe(t,n){if(1&t){const e=Le();p(0,"label")(1,"input",23),at("ngModelChange",function(r){V(e);const o=v();return it(o.searchNoTagImage,r)||(o.searchNoTagImage=r),H(r)}),he("change",function(){V(e);const r=v();return H(r.searchNoTagImage=!!r.searchNoTagImage)}),g(),p(2,"div",24)(3,"s"),y(4,"No Tag"),g(),q(5,Yoe,1,2,"badge",25),g()()}if(2&t){const e=v();h(),Et("checked",e.searchNoTagImage?"checked":""),st("ngModel",e.searchNoTagImage),h(4),m("ngIf",e.countImagesHasWord(null)>0)}}function qoe(t,n){if(1&t&&Ge(0,"badge",10),2&t){const e=v().$implicit;m("count",v().countImagesHasWord(e))("@.disabled",!0)}}function Xoe(t,n){if(1&t){const e=Le();p(0,"label")(1,"input",26),he("change",function(){const r=V(e).$implicit;return H(v().onSelectedWord(r))}),g(),p(2,"div"),y(3),q(4,qoe,1,2,"badge",25),g()()}if(2&t){const e=n.$implicit,i=v();h(),Et("value",e),m("checked",i.searchWords.includes(e)),h(2),Xe(e),h(),m("ngIf",i.countImagesHasWord(e)>0)}}function Koe(t,n){if(1&t){const e=Le();p(0,"span",27)(1,"button",28),he("click",function(){V(e);const r=v();return H(r.onSelectedFile(r.empty))}),y(2,"\u753b\u50cf\u306a\u3057"),Ge(3,"br"),y(4,"/\u8a2d\u5b9a\u89e3\u9664"),g()()}}function Qoe(t,n){1&t&&ii(0)}function Joe(t,n){if(1&t&&(p(0,"label",42),y(1),g()),2&t){const e=v().$implicit;h(),Xe(e)}}function ese(t,n){1&t&&(p(0,"span",43),y(1,"\u2026"),g())}function tse(t,n){if(1&t&&(Ue(0),q(1,Joe,2,1,"label",40)(2,ese,2,0,"span",41),ze()),2&t){const e=n.index;h(),m("ngIf",e<6),h(),m("ngIf",6==e)}}function nse(t,n){if(1&t&&(p(0,"div",39),q(1,tse,3,2,"ng-container",12),g()),2&t){const e=v().$implicit,i=v();h(),m("ngForOf",i.getTagWords(e))}}function ise(t,n){1&t&&(p(0,"div",39)(1,"s",44),y(2,"No Tag"),g()())}function rse(t,n){1&t&&(p(0,"div",45)(1,"i",46),y(2,"visibility"),g()())}function ose(t,n){1&t&&(p(0,"div",47)(1,"b",48),y(2,"\u8a2d\u5b9a\u4e2d"),g()())}function sse(t,n){if(1&t){const e=Le();p(0,"img",49),Ut(1,"safe"),he("click",function(){V(e);const r=v().$implicit,o=v();return H(!o.getCurrent(r)&&o.onSelectedFile(r))}),g()}if(2&t){const e=v().$implicit;m("src",zt(1,2,e.url,"resourceUrl"),bn)("alt",e.name)}}function ase(t,n){1&t&&Ge(0,"img",50),2&t&&Et("alt",v().$implicit.name)}function lse(t,n){if(1&t){const e=Le();p(0,"div",29)(1,"div",30),q(2,Qoe,1,0,"ng-container",31)(3,nse,2,1,"ng-template",null,0,Ai)(5,ise,3,0,"ng-template",null,1,Ai),p(7,"div",32)(8,"button",33),he("click",function(){const r=V(e).$implicit;return H(v().chanageImageView(r))}),p(9,"i",34),y(10,"zoom_in"),g()()()(),q(11,rse,3,0,"div",35)(12,ose,3,0,"div",36)(13,sse,2,5,"img",37)(14,ase,1,1,"img",38),g()}if(2&t){const e=n.$implicit,i=pn(4),r=pn(6),o=v();m("@scaleInOut",void 0)("ngClass",Ke(9,$oe,o.getCurrent(e))),h(2),m("ngIf",o.getTagWords(e).length>0)("ngIfThen",i)("ngIfElse",r),h(9),m("ngIf",o.getHidden(e)),h(),m("ngIf",o.getCurrent(e)),h(),m("ngIf",0<e.url.length),h(),m("ngIf",e.url.length<=0)}}let Yc=(()=>{class t{get images(){const e=Rs.searchImages(this.searchWords,this.searchNoTagImage&&this.countAllImagesHasWord(null)>0,this.serchCondIsOr,this.isShowHideImages);return this.isSort?Rs.sortImagesByWords(e,Dl.sortOrder).sort((i,r)=>this.getCurrent(i)?this.getCurrent(r)?0:-1:this.getCurrent(r)?1:0):e}get empty(){return vn.Empty}get searchNoTagImage(){return this._searchNoTagImage}set searchNoTagImage(e){e?Dl.sortOrder.unshift(null):Dl.sortOrder=Dl.sortOrder.filter(i=>null!=i),Dl.sortOrder=Array.from(new Set(Dl.sortOrder)),this._searchNoTagImage=e,ne.trigger("CHANGE_SORT_ORDER",null)}get searchAllImage(){if(!this.searchNoTagImage&&this.countAllImagesHasWord(null)>0)return!1;for(const e of this.allImagesOwnWords)if(!this.searchWords.includes(e))return!1;return!0}get allImagesOwnWords(){return Rs.allImagesOwnWords(this.isShowHideImages)}constructor(e,i,r,o){this.changeDetector=e,this.panelService=i,this.modalService=r,this.chatMessageService=o,this.isAllowedEmpty=!1,this.currentImageIdentifires=[],this._searchNoTagImage=!0,this.serchCondIsOr=!0,this.addingTagWord="",this.searchWords=[],this.isSort=!0,this.isShowHideImages=!1,this.isAllowedEmpty=!(!this.modalService.option||!this.modalService.option.isAllowedEmpty),this.modalService.option&&this.modalService.option.currentImageIdentifires&&(this.currentImageIdentifires=this.modalService.option.currentImageIdentifires)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7"),this.searchWords=this.allImagesOwnWords}ngAfterViewInit(){ne.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("OPERATE_IMAGE_TAGS",e=>{this.changeDetector.markForCheck()}).on("CHANGE_SORT_ORDER",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){ne.unregister(this)}allImages(){return Rs.allImages(this.isShowHideImages)}countAllImagesHasWord(e){return Rs.countAllImagesHasWord(e,this.isShowHideImages)}countImagesHasWord(e){let i=0;if(null!=e&&""===e.trim())return i;for(const r of this.images){const o=ui.get(r.identifier);null==e?(!o||null==o.tag||""==o.tag.trim())&&i++:o&&o.containsWords(e.trim(),!1)&&i++}return i}getTagWords(e){const i=ui.get(e.identifier);return i?i.words:[]}getHidden(e){const i=ui.get(e.identifier);return!!i&&i.hide}getCurrent(e){return!!this.currentImageIdentifires&&this.currentImageIdentifires.includes(e.identifier)}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(Fr,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:ur.OK_CANCEL,materialIcon:"visibility",action:()=>{this.chatMessageService.sendOperationLog("\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7 \u304b\u3089\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u305f"),this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}onSelectedFile(e){this.modalService.resolve(e.identifier)}onSearchAllImage(){this.searchAllImage?(this.searchWords=[],this._searchNoTagImage=!1):(this.searchWords=this.allImagesOwnWords,this._searchNoTagImage=!0)}onSelectedWord(e){null==e||""===e.trim()||(this.searchWords.includes(e)?(this.searchWords=this.searchWords.filter(i=>e!==i),Dl.sortOrder=Dl.sortOrder.filter(i=>e!==i)):(this.searchWords.push(e),Dl.sortOrder.unshift(e)),Dl.sortOrder=Array.from(new Set(Dl.sortOrder)),ne.trigger("CHANGE_SORT_ORDER",e))}cancel(){this.modalService.resolve(!1)}identify(e,i){return i.identifier}chanageImageView(e){e.state===Ri.COMPLETE?($c.imageUrl&&URL.revokeObjectURL($c.imageUrl),$c.imageUrl=URL.createObjectURL(e.blob)):$c.imageUrl=e.url}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Zr),Y(yi),Y(Ei),Y(vo))};static#t=this.\u0275cmp=In({type:t,selectors:[["file-selector"]],inputs:{isAllowedEmpty:"isAllowedEmpty",currentImageIdentifires:"currentImageIdentifires"},decls:28,vars:16,consts:[["tagsBlock",""],["noTagBlock",""],[1,"sticky-top"],[2,"float","right","margin-top","3px","margin-right","3px"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"click","checked"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[1,"word-selecter"],["name","word-selecter","type","checkbox","value","ALL",3,"click","checked"],[1,"all-tags"],[1,"badge",3,"count"],[4,"ngIf"],[4,"ngFor","ngForOf"],[2,"white-space","nowrap"],[2,"margin-left","3px",3,"ngModelChange","ngModel"],["value","true"],["value",""],["sytle","white-space: nowrap","title","\u6700\u8fd1\u4f7f\u3063\u305f\u30bf\u30b0\u306e\u753b\u50cf\u3092\u524d\u306b"],["name","is-sort","value","Sort","type","checkbox",3,"ngModelChange","change","ngModel","checked"],[2,"font-size","smaller","margin-right","3px"],["id","file-list",2,"min-height","250px","margin-left","1px","padding-top","3px"],["class","empty","style","display: inline-block;",4,"ngIf"],["class","image","style","text-align: center; min-width: 100px; height: 120px; position: relative",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["name","word-selecter","type","checkbox","value","No Tag",3,"ngModelChange","change","ngModel","checked"],[1,"no-tag"],["class","badge",3,"count",4,"ngIf"],["name","word-selecter","type","checkbox",3,"change","value","checked"],[1,"empty",2,"display","inline-block"],[2,"min-width","100px","margin-left","-1px","margin-right","3px",3,"click"],[1,"image",2,"text-align","center","min-width","100px","height","120px","position","relative",3,"ngClass"],[2,"position","absolute","font-size","xx-small","text-align","left","bottom","0px","width","100%","height","100%","overflow","hidden","pointer-events","none"],[4,"ngIf","ngIfThen","ngIfElse"],[1,"zoom-in",2,"z-index","10","position","absolute","right","0px","bottom","2px"],[1,"zoom-button",3,"click"],[1,"material-icons"],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["style","position: absolute; top: 0px; left: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["height","120","draggable","false",3,"src","alt","click",4,"ngIf"],["src","assets/images/loading.gif","draggable","false",3,"alt",4,"ngIf"],[2,"position","absolute","bottom","0px","z-index","5"],["class","word-tag grow","style","display: block; width: 88px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],["class","grow","style","display: block; width: 88px; overflow: hidden; padding-left: 2px; font-weight: bold; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],[1,"word-tag","grow",2,"display","block","width","88px","overflow","hidden","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"display","block","width","88px","overflow","hidden","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"color","gray","display","block","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons","red-eye",2,"z-index","5","margin-right","2px","font-size","16px","display","block"],[2,"position","absolute","top","0px","left","0px","pointer-events","none","z-index","5"],[1,"grow",2,"font-size","13px","color","red","padding-left","2px"],["height","120","draggable","false",3,"click","src","alt"],["src","assets/images/loading.gif","draggable","false",3,"alt"]],template:function(i,r){1&i&&(p(0,"div",2)(1,"div",3)(2,"label",4)(3,"input",5),he("click",function(s){return r.onShowHiddenImages(s)}),g(),p(4,"i",6),y(5),g()()(),p(6,"span",7)(7,"label")(8,"input",8),he("click",function(){return r.onSearchAllImage()}),g(),p(9,"div",9)(10,"b"),y(11,"ALL"),g(),Ge(12,"badge",10),g()(),q(13,Zoe,6,3,"label",11)(14,Xoe,5,4,"label",12),g(),p(15,"span",13)(16,"select",14),at("ngModelChange",function(s){return it(r.serchCondIsOr,s)||(r.serchCondIsOr=s),s}),p(17,"option",15),y(18,"\u3044\u305a\u308c\u304b (OR)"),g(),p(19,"option",16),y(20,"\u3059\u3079\u3066 (AND)"),g()(),p(21,"label",17)(22,"input",18),at("ngModelChange",function(s){return it(r.isSort,s)||(r.isSort=s),s}),he("change",function(){return r.isSort=!!r.isSort}),g(),p(23,"b",19),y(24,"\u30bd\u30fc\u30c8"),g()()()(),p(25,"div",20),q(26,Koe,5,0,"span",21)(27,lse,15,11,"div",22),g()),2&i&&(h(3),Et("checked",r.isShowHideImages?"checked":""),h(),m("ngClass",Ke(14,Woe,r.isShowHideImages)),h(),Xe(r.isShowHideImages?"visibility":"visibility_off"),h(3),Et("checked",r.searchAllImage?"checked":""),h(4),m("count",r.images.length)("@.disabled",!0),h(),m("ngIf",r.countAllImagesHasWord(null)>0),h(),m("ngForOf",r.allImagesOwnWords),h(2),st("ngModel",r.serchCondIsOr),h(6),Et("checked",r.isSort?"checked":""),st("ngModel",r.isSort),h(4),m("ngIf",r.isAllowedEmpty),h(),m("ngForOf",r.images)("ngForTrackBy",r.identify))},dependencies:[Ni,nr,ri,na,ia,Ea,Ia,Or,Cr,j0,cr],styles:["[_nghost-%COMP%]{display:block}.image[_ngcontent-%COMP%]{font-size:0;display:inline-block;border:2px solid transparent;margin-left:-2px}.image[_ngcontent-%COMP%]:not(.current-images){cursor:pointer}.image[_ngcontent-%COMP%]:not(.current-images):hover{border:2px dotted red;transform:scale(1.08);z-index:200;transition-duration:60ms}.current-images[_ngcontent-%COMP%]{border:2px solid red}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom}.image[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(1px);backdrop-filter:blur(1px);filter:none!important}.empty[_ngcontent-%COMP%]{line-height:120px;vertical-align:top}.empty[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:120px;margin:1px;box-sizing:border-box;vertical-align:top}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.sticky-top[_ngcontent-%COMP%]{position:sticky;top:0;background-color:#f0dabde6;border-top:1px dotted #666;border-bottom:1px dotted #666;z-index:100}.word-tag[_ngcontent-%COMP%]{margin-right:3px;display:inline-block;color:#000;font-weight:bolder}.word-tag[_ngcontent-%COMP%]:hover{color:red}.word-selecter[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.word-selecter[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{display:none}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div.all-tags[_ngcontent-%COMP%]{background-color:#eee;color:#008b8b}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}.zoom-button[_ngcontent-%COMP%]{width:24px;height:24px;border-radius:100px;padding:1px;pointer-events:auto;cursor:zoom-in}.zoom-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{display:inline-block;font-size:16px;vertical-align:bottom}"],data:{animation:[Xn("scaleInOut",[an("void => *",[rn("200ms ease",En([We({transform:"scale3d(0, 0, 0)",offset:0}),We({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),an("* => void",[rn("180ms ease",We({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0})}return t})();function cse(t,n){1&t&&ii(0)}function use(t,n){if(1&t){const e=Le();p(0,"div",4),q(1,cse,1,0,"ng-container",6),p(2,"select",7,1),he("change",function(){V(e);const r=pn(3);return H(v(3).setElementType(r.value))}),p(4,"option",8),y(5,"\u901a\u5e38"),g(),p(6,"option",9),y(7,"\u6570\u5024"),g(),p(8,"option",10),y(9,"\u30ea\u30bd\u30fc\u30b9"),g(),p(10,"option",11),y(11,"\u80fd\u529b\u5024"),g(),p(12,"option",12),y(13,"\u30c1\u30a7\u30c3\u30af"),g(),p(14,"option",13),y(15,"\u30ce\u30fc\u30c8"),g(),p(16,"option",14),y(17,"\u53c2\u7167URL"),g()()()}if(2&t){let e;const i=v(3),r=pn(2);h(),m("ngTemplateOutlet",r),h(),m("ngModel",null!==(e=i.gameDataElement.type)&&void 0!==e?e:"")}}function dse(t,n){1&t&&(Ue(0),Ge(1,"br"),p(2,"span",16),y(3,"0=\u753b\u50cf\u4f9d\u5b58"),g(),ze())}function hse(t,n){if(1&t&&(Ue(0),p(1,"span",15),y(2),g(),q(3,dse,4,0,"ng-container",2),ze()),2&t){const e=v(3);h(2),Xe(e.name),h(),m("ngIf","character"===e.descriptionType&&"height"===e.name)}}function fse(t,n){if(1&t){const e=Le();Ue(0),p(1,"div",17),y(2),g(),p(3,"input",18),at("ngModelChange",function(r){V(e);const o=v(3);return it(o.name,r)||(o.name=r),H(r)}),g(),ze()}if(2&t){const e=v(3);h(2),Xe(e.name),h(),st("ngModel",e.name)}}function pse(t,n){if(1&t){const e=Le();Ue(0),p(1,"input",22),Ut(2,"safe"),at("ngModelChange",function(r){V(e);const o=v(4);return it(o.currentValue,r)||(o.currentValue=r),H(r)}),g(),Ge(3,"br"),p(4,"input",23),at("ngModelChange",function(r){V(e);const o=v(4);return it(o.currentValue,r)||(o.currentValue=r),H(r)}),g(),p(5,"b",24),y(6,"%"),g(),ze()}if(2&t){const e=v(4);h(),ms(zt(2,6,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),go("title","",e.currentValue,"%"),st("ngModel",e.currentValue),h(3),st("ngModel",e.currentValue)}}function gse(t,n){if(1&t){const e=Le();Ue(0),p(1,"label",25)(2,"input",26),at("ngModelChange",function(r){V(e);const o=v(5);return it(o.value,r)||(o.value=r),H(r)}),g(),p(3,"div",27),y(4),g()(),p(5,"label",28)(6,"input",26),at("ngModelChange",function(r){V(e);const o=v(5);return it(o.currentValue,r)||(o.currentValue=r),H(r)}),g(),p(7,"div",27),y(8),g()(),ze()}if(2&t){const e=v(5);h(),je("color",e.value)("background-color",e.currentValue)("text-shadow",e.colorSampleTextShadowCss),h(),st("ngModel",e.value),h(2),Xe(e.value),h(),je("color",e.value)("background-color",e.currentValue)("text-shadow",e.colorSampleTextShadowCss),h(),st("ngModel",e.currentValue),h(2),Si("(",e.currentValue,")")}}function mse(t,n){if(1&t){const e=Le();Ue(0),p(1,"label",25)(2,"input",26),at("ngModelChange",function(r){V(e);const o=v(5);return it(o.value,r)||(o.value=r),H(r)}),g(),y(3),g(),ze()}if(2&t){const e=v(5);h(),je("color",e.value)("text-shadow",e.colorSampleTextShadowCss),h(),st("ngModel",e.value),h(),Si(" ",e.value,"")}}function _se(t,n){if(1&t&&(Ue(0),q(1,gse,9,16,"ng-container",2)(2,mse,4,6,"ng-container",2),ze()),2&t){const e=v(4);h(),m("ngIf","colors"===e.gameDataElement.type),h(),m("ngIf","color"===e.gameDataElement.type)}}function bse(t,n){if(1&t){const e=Le();p(0,"div",32)(1,"label"),y(2,"\xd7 size"),p(3,"input",33),at("ngModelChange",function(r){V(e);const o=v(5);return it(o.currentValue,r)||(o.currentValue=r),H(r)}),he("change",function(){V(e);const r=v(5);return H(r.currentValue=r.currentValue?r.name:"")}),g()()()}if(2&t){const e=v(5);h(),je("text-decoration",e.currentValue?"none":"line-through"),h(2),Et("checked",e.currentValue?"checked":""),st("ngModel",e.currentValue)}}function vse(t,n){if(1&t){const e=Le();Ue(0),p(1,"input",29),Ut(2,"safe"),at("ngModelChange",function(r){V(e);const o=v(4);return it(o.value,r)||(o.value=r),H(r)}),g(),Ge(3,"br"),p(4,"input",30),at("ngModelChange",function(r){V(e);const o=v(4);return it(o.value,r)||(o.value=r),H(r)}),g(),q(5,bse,4,4,"div",31),ze()}if(2&t){const e=v(4);h(),ms(zt(2,11,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),Et("title",e.value),Et("min","altitude"===e.name?-12:"fontsize"===e.name||"length"===e.name?1:0),Et("max","fontsize"===e.name?128:12),Et("step","fontsize"===e.name?1:.5),st("ngModel",e.value),h(3),Et("min","altitude"===e.name?-24:"fontsize"===e.name||"length"===e.name?1:0),Et("step","fontsize"===e.name?1:.1),st("ngModel",e.value),h(),m("ngIf","character"===e.descriptionType&&"height"===e.name)}}function yse(t,n){if(1&t&&(Ue(0)(1,19),q(2,pse,7,9,"ng-container",20)(3,_se,3,2,"ng-container",20)(4,vse,6,14,"ng-container",21),ze()()),2&t){const e=v(3);h(),m("ngSwitch",e.gameDataElement.name),h(),m("ngSwitchCase","opacity"),h(),m("ngSwitchCase","color")}}function Cse(t,n){if(1&t){const e=Le();Ue(0),p(1,"div",34),y(2),g(),p(3,"input",35),at("ngModelChange",function(r){V(e);const o=v(4);return it(o.value,r)||(o.value=r),H(r)}),g(),ze()}if(2&t){const e=v(4);h(2),Xe(e.value),h(),Et("type",e.isNum(e.value)?"number":"text"),m("logging.name",e.tabletopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging),st("ngModel",e.value)}}function xse(t,n){if(1&t){const e=Le();Ue(0),p(1,"input",36),Ut(2,"safe"),at("ngModelChange",function(r){V(e);const o=v(4);return it(o.currentValue,r)||(o.currentValue=r),H(r)}),g(),Ge(3,"br"),p(4,"input",37),at("ngModelChange",function(r){V(e);const o=v(4);return it(o.currentValue,r)||(o.currentValue=r),H(r)}),g(),y(5," / "),p(6,"input",38),at("ngModelChange",function(r){V(e);const o=v(4);return it(o.value,r)||(o.value=r),H(r)}),g(),ze()}if(2&t){const e=v(4);h(),ms(zt(2,16,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),Et("title",e.currentValue),Et("max",e.isNum(e.value)?e.value:1e3),m("logging.name",e.tabletopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging),st("ngModel",e.currentValue),h(3),m("logging.name",e.tabletopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging),st("ngModel",e.currentValue),h(2),m("logging.name",e.tabletopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging),st("ngModel",e.value)}}function wse(t,n){if(1&t){const e=Le();Ue(0),p(1,"select",40),at("ngModelChange",function(r){V(e);const o=v(5);return it(o.currentValue,r)||(o.currentValue=r),H(r)}),p(2,"option",8),y(3,"\u306a\u3057"),g(),p(4,"option",41),y(5,"\xf72"),g(),p(6,"option",42),y(7,"\xf73 SRS,LHZ"),g(),p(8,"option",43),y(9,"\xf74"),g(),p(10,"option",44),y(11,"\xf75"),g(),p(12,"option",45),y(13,"\xf76 SW"),g(),p(14,"option",46),y(15,"\xf710"),g(),p(16,"option",47),y(17,"D&D 3e\uff5e"),g()(),ze()}if(2&t){const e=v(5);h(),st("ngModel",e.currentValue)}}function Ese(t,n){if(1&t&&(Ue(0),p(1,"span",48),y(2),g(),ze()),2&t){const e=v(5);h(2),Xe("("+(e.abilityScore>=0?"+":"")+e.abilityScore+")")}}function Ise(t,n){if(1&t){const e=Le();Ue(0),p(1,"input",39),at("ngModelChange",function(r){V(e);const o=v(4);return it(o.value,r)||(o.value=r),H(r)}),g(),q(2,wse,18,1,"ng-container",2)(3,Ese,3,1,"ng-container",2),ze()}if(2&t){const e=v(4);h(),Et("type",e.isNum(e.value)?"number":"text"),m("logging.name",e.tabletopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging),st("ngModel",e.value),h(),m("ngIf",e.isEdit),h(),m("ngIf",!e.isEdit&&e.currentValue)}}function Tse(t,n){if(1&t){const e=Le();p(0,"input",52),at("ngModelChange",function(r){V(e);const o=v(5);return it(o.currentValue,r)||(o.currentValue=r),H(r)}),g()}2&t&&st("ngModel",v(5).currentValue)}function Sse(t,n){if(1&t&&(p(0,"span",53),y(1),g()),2&t){const e=v(5);h(),Xe(e.checkValue)}}function Mse(t,n){if(1&t){const e=Le();Ue(0),p(1,"input",49),at("ngModelChange",function(r){V(e);const o=v(4);return it(o.value,r)||(o.value=r),H(r)}),he("change",function(){V(e);const r=v(4);return H(r.value=r.value?r.name:"")}),g(),q(2,Tse,1,1,"input",50)(3,Sse,2,1,"span",51),ze()}if(2&t){const e=v(4);h(),Et("checked",e.value?"checked":""),m("logging.name",e.tabletopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging),st("ngModel",e.value),h(),m("ngIf",e.isEdit),h(),m("ngIf",!e.isEdit)}}function Dse(t,n){if(1&t){const e=Le();Ue(0),p(1,"textarea",54),at("ngModelChange",function(r){V(e);const o=v(4);return it(o.value,r)||(o.value=r),H(r)}),g(),ze()}if(2&t){const e=v(4);h(),st("ngModel",e.value)}}function kse(t,n){if(1&t){const e=Le();Ue(0),p(1,"div",34),y(2),g(),p(3,"span",55)(4,"input",56),at("ngModelChange",function(r){V(e);const o=v(4);return it(o.value,r)||(o.value=r),H(r)}),g(),p(5,"button",57),he("click",function(){V(e);const r=v(4);return H(!!r.stringUtil.validUrl(r.value.toString())&&r.openUrl(r.value))}),p(6,"i",58),y(7),g()()(),ze()}if(2&t){const e=v(4);h(2),Xe(e.value),h(2),st("ngModel",e.value),h(),en("disabled",e.stringUtil.validUrl(e.value.toString())?null:""),h(2),Xe(e.stringUtil.validUrl(e.value.toString())?e.stringUtil.sameOrigin(e.value.toString())?"link":"open_in_new":"link_off")}}function Ose(t,n){if(1&t){const e=Le();p(0,"input",61),at("ngModelChange",function(r){V(e);const o=v(5);return it(o.value,r)||(o.value=r),H(r)}),g()}2&t&&st("ngModel",v(5).value)}function Ase(t,n){1&t&&(p(0,"span",62),y(1,"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09"),g())}function Pse(t,n){if(1&t&&(Ue(0),p(1,"div",34),y(2),g(),q(3,Ose,1,1,"input",59)(4,Ase,2,0,"span",60),ze()),2&t){const e=v(4);h(2),Xe(e.value),h(),m("ngIf",!(e.isHideText&&e.isTabletopObjectName)),h(),m("ngIf",e.isHideText&&e.isTabletopObjectName)}}function Fse(t,n){if(1&t&&(Ue(0)(1,19),q(2,Cse,4,6,"ng-container",20)(3,xse,7,19,"ng-container",20)(4,Ise,4,7,"ng-container",20)(5,Mse,4,7,"ng-container",20)(6,Dse,2,1,"ng-container",20)(7,kse,8,4,"ng-container",20)(8,Pse,5,3,"ng-container",21),ze()()),2&t){const e=v(3);h(),m("ngSwitch",e.gameDataElement.type),h(),m("ngSwitchCase","simpleNumber"),h(),m("ngSwitchCase","numberResource"),h(),m("ngSwitchCase","abilityScore"),h(),m("ngSwitchCase","checkProperty"),h(),m("ngSwitchCase","note"),h(),m("ngSwitchCase","url")}}function Nse(t,n){if(1&t&&(Ue(0),q(1,use,18,2,"div",3),p(2,"div",4),q(3,hse,4,2,"ng-container",2)(4,fse,4,2,"ng-container",2),g(),p(5,"div",5),q(6,yse,5,3,"ng-container",2)(7,Fse,9,7,"ng-container",2),g(),ze()),2&t){const e=v(2);h(),m("ngIf",e.isEdit),h(2),m("ngIf",e.isTagLocked),h(),m("ngIf",!e.isTagLocked),h(2),m("ngIf",e.isCommonValue),h(),m("ngIf",!e.isCommonValue)}}function Rse(t,n){1&t&&ii(0)}function Lse(t,n){if(1&t&&(p(0,"div",68),q(1,Rse,1,0,"ng-container",6),g()),2&t){v(3);const e=pn(2);h(),m("ngTemplateOutlet",e)}}function Bse(t,n){if(1&t&&(Ue(0),p(1,"div",69),y(2),g(),ze()),2&t){const e=v(3);h(2),Xe(e.name)}}function Use(t,n){if(1&t){const e=Le();Ue(0),p(1,"input",70),at("ngModelChange",function(r){V(e);const o=v(3);return it(o.name,r)||(o.name=r),H(r)}),g(),ze()}if(2&t){const e=v(3);h(),st("ngModel",e.name)}}function zse(t,n){if(1&t&&Ge(0,"div",73),2&t){const e=n.$implicit,i=v(4);m("gameDataElement",e)("tabletopObject",i.tabletopObject)("isEdit",i.isEdit)("isTagLocked",i.isTagLocked)("isHideText",i.isHideText)("isNoLogging",i.isNoLogging)("descriptionType",i.descriptionType)}}function Hse(t,n){if(1&t&&(p(0,"div",71),q(1,zse,1,7,"div",72),g()),2&t){const e=v(3);h(),m("ngForOf",e.gameDataElement.children)}}function Vse(t,n){if(1&t&&(Ue(0),q(1,Lse,2,1,"div",63),Ge(2,"div",64),p(3,"div",65)(4,"div",66),q(5,Bse,3,1,"ng-container",2)(6,Use,2,1,"ng-container",2),g(),q(7,Hse,2,1,"div",67),g(),ze()),2&t){const e=v(2);h(),m("ngIf",e.isEdit),h(3),je("border-color",e.isTagLocked&&"common"===e.name?"transparent":""),h(),m("ngIf",e.isTagLocked&&"common"!=e.name),h(),m("ngIf",!e.isTagLocked),h(),m("ngIf",0<e.gameDataElement.children.length)}}function jse(t,n){if(1&t&&(Ue(0),q(1,Nse,8,5,"ng-container",2)(2,Vse,8,6,"ng-container",2),ze()),2&t){const e=v();h(),m("ngIf",e.gameDataElement.children.length<1),h(),m("ngIf",0<e.gameDataElement.children.length)}}function Gse(t,n){if(1&t){const e=Le();p(0,"button",74),he("click",function(){return V(e),H(v().addElement())}),p(1,"i",75),y(2,"add_circle"),g()(),p(3,"button",74),he("click",function(){return V(e),H(v().upElement())}),p(4,"i",75),y(5,"arrow_upward"),g()(),Ge(6,"br"),p(7,"button",74),he("click",function(){return V(e),H(v().deleteElement())}),p(8,"i",75),y(9,"remove_circle_outline"),g()(),p(10,"button",74),he("click",function(){return V(e),H(v().downElement())}),p(11,"i",75),y(12,"arrow_downward"),g()()}}let Wse=(()=>{class t{get name(){return this._name}set name(e){this._name=e,this.setUpdateTimer()}get value(){return this._value}set value(e){this._value=e,this.setUpdateTimer()}get currentValue(){return null==this._currentValue?"":this._currentValue}set currentValue(e){this._currentValue=e,this.setUpdateTimer()}get abilityScore(){return this.gameDataElement.calcAbilityScore()}get isTabletopObjectName(){return this.isTagLocked&&"name"===this.gameDataElement.name}get tabletopObjectName(){let e=this.tabletopObject.commonDataElement.getFirstElementByName("name")||this.tabletopObject.commonDataElement.getFirstElementByName("title");return e?e.value:""}get checkValue(){if(null==this.currentValue)return"";let e=this.currentValue.toString().split(/[|\uff5c]/,2);if(e.length<=1)return null==this.value||""==this.value?"":this.currentValue.toString();let i=null==this.value||""==this.value?e[1]:e[0];return this.tabletopObject instanceof gn&&this.tabletopObject.chatPalette&&(i=this.tabletopObject.chatPalette.evaluate(i,this.tabletopObject.rootDataElement)),i}get isCommonValue(){return!!this.gameDataElement&&this.isTagLocked&&("size"===this.gameDataElement.name||"width"===this.gameDataElement.name||"height"===this.gameDataElement.name||"depth"===this.gameDataElement.name||"length"===this.gameDataElement.name||"fontsize"===this.gameDataElement.name||"opacity"===this.gameDataElement.name||"altitude"===this.gameDataElement.name||"color"===this.gameDataElement.name)}get isNotApplicable(){return this.isCommonValue&&"range-not-width"===this.descriptionType&&"width"===this.gameDataElement.name}get colorSampleTextShadowCss(){const e=ke.textShadowColor(this.value.toString());return`${e} -1px -1px 0px, \n      ${e} 0px -1px 0px, \n      ${e} 1px -1px 0px, \n      ${e} -1px 0px 0px, \n      ${e} 1px 0px 0px,\n      ${e} -1px 1px 0px,\n      ${e} 0px 1px 0px,\n      ${e} 1px 1px 0px`}get identifier(){return this.gameDataElement.identifier}constructor(e,i){this.changeDetector=e,this.modalService=i,this.tabletopObject=null,this.gameDataElement=null,this.isEdit=!1,this.isTagLocked=!1,this.isValueLocked=!1,this.isHideText=!1,this.isNoLogging=!1,this.stringUtil=ke,this._name="",this._value=0,this._currentValue=0,this.updateTimer=null}ngOnInit(){this.gameDataElement&&this.setValues(this.gameDataElement)}ngOnChanges(){ne.unregister(this),ne.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=!1;this.gameDataElement&&e.data.identifier===this.gameDataElement.identifier?(this.setValues(this.gameDataElement),i=!0):this.tabletopObject&&this.tabletopObject.contains(this.gameDataElement)&&(i=!0),i&&this.changeDetector.markForCheck()}).on(`UPDATE_GAME_OBJECT/identifier/${this.gameDataElement?.identifier}`,e=>{this.setValues(this.gameDataElement),this.changeDetector.markForCheck()}).on("DELETE_GAME_OBJECT",e=>{this.gameDataElement&&this.gameDataElement.identifier===e.data.identifier&&this.changeDetector.markForCheck()})}ngOnDestroy(){ne.unregister(this)}addElement(){this.gameDataElement.appendChild(wt.create("\u30bf\u30b0","",{}))}deleteElement(){this.gameDataElement.destroy()}upElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);0<i&&e.insertBefore(this.gameDataElement,e.children[i-1])}downElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.gameDataElement)}setElementType(e){this.gameDataElement.setAttribute("type",e)}isNum(e){return isFinite(e)}openUrl(e){ke.sameOrigin(e)?window.open(e.trim(),"_blank","noopener"):this.modalService.open(sa,{url:e,title:this.tabletopObjectName,subTitle:this.name})}setValues(e){this._name=e.name,this._currentValue=e.currentValue,this._value=e.value}setUpdateTimer(){clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>{this.gameDataElement.name!==this.name&&(this.gameDataElement.name=this.name),this.gameDataElement.currentValue!==this.currentValue&&(this.gameDataElement.currentValue=this.currentValue),this.gameDataElement.value!==this.value&&(this.gameDataElement.value=this.value),this.updateTimer=null},66)}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Zr),Y(Ei))};static#t=this.\u0275cmp=In({type:t,selectors:[["game-data-element"],["","game-data-element",""]],inputs:{tabletopObject:"tabletopObject",gameDataElement:"gameDataElement",isEdit:"isEdit",isTagLocked:"isTagLocked",isValueLocked:"isValueLocked",isHideText:"isHideText",isNoLogging:"isNoLogging",descriptionType:"descriptionType"},features:[hr],decls:3,vars:1,consts:[["editButtons",""],["select",""],[4,"ngIf"],["class","table-cell table-cell_solid",4,"ngIf"],[1,"table-cell","table-cell_solid"],[1,"table-cell"],[4,"ngTemplateOutlet"],[3,"change","ngModel"],["value",""],["value","simpleNumber"],["value","numberResource"],["value","abilityScore"],["value","checkProperty"],["value","note"],["value","url"],[2,"font-family","Cambria, Georgia","font-size","0.9rem"],[2,"font-size","0.4rem"],[1,"hidden-spacer",2,"font-family","Cambria, Georgia","font-size","0.9rem"],["size","1","placeholder","Value",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","0.9rem",3,"ngModelChange","ngModel"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["type","range","min","0","max","100","step","1",2,"width","90%",3,"ngModelChange","ngModel","title"],["type","number","min","0","max","100","step","1","size","1","placeholder","Opacity",2,"margin-left","3.5em","width","4em","text-align","right",3,"ngModelChange","ngModel"],[1,"move",2,"font-size","small"],[1,"color-sample",2,"padding","0px 2px 0px 0xp","width","6.5em"],["type","color",2,"width","1em",3,"ngModelChange","ngModel"],[2,"display","inline-block","box-sizing","border-box","width","calc(100% - 1em)","text-align","center"],[1,"color-sample",2,"padding","0px 2px 0px 0xp","width","7.5em"],["type","range",2,"width","90%",3,"ngModelChange","ngModel","title","min","max","step"],["type","number","size","1","placeholder","Value",2,"width","35%","max-width","4em","text-align","right",3,"ngModelChange","min","step","ngModel"],["style","color: #444; font-family: Cambria, Georgia; font-size: 0.9rem; display: inline-block; margin-left: 3px",4,"ngIf"],[2,"color","#444","font-family","Cambria, Georgia","font-size","0.9rem","display","inline-block","margin-left","3px"],["type","checkbox",3,"ngModelChange","change","ngModel","checked"],[1,"hidden-spacer",2,"font-size","1.0em","font-family","Cambria, Georgia"],["appLogging","","size","1","placeholder","Number",2,"width","40%","min-width","3em","max-width","8em","text-align","right",3,"ngModelChange","logging.name","logging.dataElement","logging.disable","type","ngModel"],["appLogging","","type","range","min","0",3,"ngModelChange","logging.name","logging.dataElement","logging.disable","ngModel","title","max"],["appLogging","","size","1","type","number","placeholder","Value",2,"width","5em","text-align","right",3,"ngModelChange","logging.name","logging.dataElement","logging.disable","ngModel"],["appLogging","","size","1","type","number","placeholder","Value",2,"width","5em",3,"ngModelChange","logging.name","logging.dataElement","logging.disable","ngModel"],["appLogging","","size","1","placeholder","Value",2,"width","40%","max-width","5em","text-align","right",3,"ngModelChange","logging.name","logging.dataElement","logging.disable","type","ngModel"],[1,"modeifire-type",2,"width","40%","max-width","5em",3,"ngModelChange","ngModel"],["value","div2"],["value","div3"],["value","div4"],["value","div5"],["value","div6"],["value","div10"],["value","DnD3"],[2,"font-size","smaller"],["appLogging","","type","checkbox",2,"width","30%","max-width","4em",3,"ngModelChange","change","logging.name","logging.dataElement","logging.disable","ngModel","checked"],["style","width:50%; max-width:4em","type","text","size","1","placeholder","Option",3,"ngModel","ngModelChange",4,"ngIf"],["style","font-size: 1.0em; font-family: Cambria, Georgia; color: #555",4,"ngIf"],["type","text","size","1","placeholder","Option",2,"width","50%","max-width","4em",3,"ngModelChange","ngModel"],[2,"font-size","1.0em","font-family","Cambria, Georgia","color","#555"],["placeholder","Note",2,"width","100%","height","5em","min-width","50px","resize","bose","font-size","0.8em",3,"ngModelChange","ngModel"],[2,"white-space","nowrap"],["type","url","size","1","placeholder","https://www.example.com",2,"width","calc(100% - 1.6rem)","min-width","10px",3,"ngModelChange","ngModel"],[2,"width","1.6rem",3,"click"],[1,"material-icons",2,"font-size","1.0rem"],["style","width:100%; min-width:10px;","size","1","placeholder","",3,"ngModel","ngModelChange",4,"ngIf"],["style","color: gray; font-size: 1.0em; font-family: Cambria, Georgia;",4,"ngIf"],["size","1","placeholder","",2,"width","100%","min-width","10px",3,"ngModelChange","ngModel"],[2,"color","gray","font-size","1.0em","font-family","Cambria, Georgia"],["class","table-cell table-cell_solid","style","vertical-align: top;",4,"ngIf"],[1,"table-cell","table-cell_inner-table",2,"padding","0","width","0"],[1,"table-cell_inner-table"],[1,"table-cell_inner-table-title"],["class","table",4,"ngIf"],[1,"table-cell","table-cell_solid",2,"vertical-align","top"],[2,"padding","2px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold"],["size","1","placeholder","Value",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold",3,"ngModelChange","ngModel"],[1,"table"],["game-data-element","","class","table-row",3,"gameDataElement","tabletopObject","isEdit","isTagLocked","isHideText","isNoLogging","descriptionType",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","tabletopObject","isEdit","isTagLocked","isHideText","isNoLogging","descriptionType"],[3,"click"],[1,"material-icons"]],template:function(i,r){1&i&&q(0,jse,3,2,"ng-container",2)(1,Gse,13,0,"ng-template",null,0,Ai),2&i&&m("ngIf",r.gameDataElement&&!r.isNotApplicable&&!(r.isHideText&&("text"==r.name||"fontsize"==r.name||"color"==r.name)))},dependencies:[nr,ri,uf,Hd,Dg,M0,na,ia,kr,yl,Cl,Ea,Ia,Or,ku,Du,Cr,t,Hu,cr],styles:[".game-data-element[_ngcontent-%COMP%]{margin-left:10px}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{padding-top:10px;display:table-row;box-sizing:border-box}.table-cell[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.5em 0 .1em .5em;border-bottom:1px dotted #888;box-sizing:border-box}.table-cell_solid[_ngcontent-%COMP%]{width:10px;white-space:nowrap}.table-cell_inner-table[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.2em 0 .1em .5em;border:none;box-sizing:border-box}.table-cell_inner-table-title[_ngcontent-%COMP%]{border-bottom:1px solid #444;border-left:8px solid #444;padding-left:8px}.box[_ngcontent-%COMP%]{display:inline-block;margin:10px}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;max-width:20em;overflow:hidden;padding:0 3px;box-sizing:border-box}input[_ngcontent-%COMP%], button[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}input[_ngcontent-%COMP%]:hover, textarea[_ngcontent-%COMP%]:hover, select[_ngcontent-%COMP%]:hover{background:#eee}input[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{background:#fff}button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}.table-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.5rem}button[_ngcontent-%COMP%]:disabled{color:gray}button[_ngcontent-%COMP%]:disabled:hover{background-color:transparent}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.modeifire-type[_ngcontent-%COMP%]{font-size:smaller}input[type=color][_ngcontent-%COMP%]:hover, input[type=color][_ngcontent-%COMP%]:not(:hover){-webkit-appearance:auto;appearance:auto;width:44px;height:22px;background-color:#efefef;cursor:default;color:#000;border-width:1px;border-style:solid;border-color:#767676;border-image:initial;padding:1px 2px}@media (prefers-color-scheme: dark){input[type=color][_ngcontent-%COMP%]:hover, input[type=color][_ngcontent-%COMP%]:not(:hover){background-color:#3b3b3b;color:#fff;border-color:#858585}}.color-sample[_ngcontent-%COMP%]{display:inline-block;font-weight:bolder;width:6em;text-shadow:#eee -1px -1px 0px,#eee 0px -1px 0px,#eee 1px -1px 0px,#eee -1px 0px 0px,#eee 1px 0px 0px,#eee -1px 1px 0px,#eee 0px 1px 0px,#eee 1px 1px 0px}input[_ngcontent-%COMP%] + .move[_ngcontent-%COMP%]{display:inline-block;transform:translate(-1em);transition:transform 18ms}input[_ngcontent-%COMP%]:hover + .move[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:active + .move[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:focus + .move[_ngcontent-%COMP%]{display:inline-block;transform:translate(0);transition:transform 18ms}@supports (-moz-user-select: -moz-none){input[_ngcontent-%COMP%] + .move[_ngcontent-%COMP%]{transform:translate(0)}}"],changeDetection:0})}return t})();const $se=["mainImage"],Yse=t=>({"is-hidden":t}),Zse=t=>({inverse:t}),qse=(t,n,e,i,r,o,s,a)=>({black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}),Xse=(t,n,e)=>({"black-paint":t,hollow:n,small:e}),Kse=t=>({"current-icon":t}),Qse=t=>({hide:t}),Jse=t=>({transform:t});function eae(t,n){1&t&&ii(0)}function tae(t,n){if(1&t){const e=Le();Ue(0),p(1,"button",6),he("click",function(){return V(e),H(v().openModal("front"))}),y(2,"\u8868\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),g(),p(3,"button",2),he("click",function(){return V(e),H(v().openModal("back"))}),y(4,"\u88cf\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),g(),ze()}if(2&t){const e=v();h(),m("disabled",!e.isVisible)}}function nae(t,n){if(1&t){const e=Le();Ue(0),p(1,"button",2),he("click",function(){return V(e),H(v().openModalChangeAllCardImages())}),y(2,"\u5168\u30ab\u30fc\u30c9\u306e\u88cf\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),g(),ze()}}function iae(t,n){if(1&t){const e=Le();Ue(0),p(1,"button",2),he("click",function(){return V(e),H(v().openModal("floor"))}),y(2,"\u5e8a\u306e\u753b\u50cf\u3092\u5909\u66f4"),g(),p(3,"button",2),he("click",function(){return V(e),H(v().openModal("wall"))}),y(4,"\u58c1\u306e\u753b\u50cf\u3092\u5909\u66f4"),g(),ze()}}function rae(t,n){if(1&t){const e=Le();Ue(0),p(1,"button",6),he("click",function(){V(e);const r=v();return H(r.openModal(r.tabletopObject.face))}),y(2,"\u30c0\u30a4\u30b9\u76ee\u306e\u753b\u50cf\u3092\u5909\u66f4"),g(),ze()}if(2&t){const e=v();h(),m("disabled",!e.isVisible)}}function oae(t,n){if(1&t){const e=Le();Ue(0),p(1,"button",2),he("click",function(){V(e);const r=v();return H(r.openModalReplaceImage(r.tabletopObject.imageFiles.length>1||0<(null==r.tabletopObject.imageFile?null:r.tabletopObject.imageFile.url.length)))}),y(2),g(),p(3,"button",6),he("click",function(){return V(e),H(v().openModal("faceIcon"))}),y(4),g(),ze()}if(2&t){const e=v();h(2),Si("\u753b\u50cf",(null==e.tabletopObject.imageFiles?null:e.tabletopObject.imageFiles.length)>1?"\u7f6e\u63db/\u524a\u9664":"\u8a2d\u5b9a",""),h(),m("disabled",(null==e.tabletopObject.faceIcons?null:e.tabletopObject.faceIcons.length)>=e.MAX_IMAGE_ICON_COUNT),h(),Si("\u9854IC",(null==e.tabletopObject.faceIcons?null:e.tabletopObject.faceIcons.length)>0?"\u8ffd\u52a0":"\u8a2d\u5b9a","")}}function sae(t,n){if(1&t){const e=Le();Ue(0),p(1,"button",2),he("click",function(){V(e);const r=v(2);return H(r.openModal("imageIdentifier",r.tabletopObject.imageFile&&r.tabletopObject.imageFile.url.length>0))}),y(2,"\u753b\u50cf\u5909\u66f4"),g(),ze()}}function aae(t,n){if(1&t&&(Ue(0),q(1,sae,3,0,"ng-container",10),ze()),2&t){const e=v();h(),m("ngIf","range"!==e.tabletopObject.aliasName)}}function lae(t,n){if(1&t&&(p(0,"div",12),y(1),g()),2&t){const e=v();h(),Si("",e.progresPercent,"%")}}function cae(t,n){if(1&t){const e=Le();p(0,"select",14,0),he("change",function(){V(e);const r=pn(1);return H(v(2).setLocation(r.value))}),p(2,"option",15),y(3,"\u30c6\u30fc\u30d6\u30eb"),g(),p(4,"option",16),y(5,"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),g(),p(6,"option",17),y(7,"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),g(),p(8,"option",18),y(9,"\u5893\u5730"),g()()}if(2&t){const e=v(2);m("ngModel",e.tabletopObject.location.name),h(6),Et("value",e.networkService.peerId)}}function uae(t,n){if(1&t){const e=Le();Ue(0),q(1,cae,10,2,"select",13),p(2,"button",6),he("click",function(){V(e);const r=v();return H(r.openModal("shadowImageIdentifier",r.tabletopObject.shadowImageFile.url.length>0))}),y(3,"\u753b\u50cf\u306e\u5f71\u306e\u5909\u66f4"),g(),ze()}if(2&t){const e=v();h(),m("ngIf",e.tabletopObject),h(),m("disabled",!e.tabletopObject.imageElement||"null"==e.tabletopObject.imageElement.value)}}function dae(t,n){if(1&t){const e=Le();p(0,"button",36),he("click",function(){V(e);const r=v(2),o=r.$implicit,s=r.index;return H(v(3).deleteIcon(s,o.identifier))}),p(1,"b",37),y(2,"close"),g()()}}function hae(t,n){if(1&t){const e=Le();p(0,"span",33)(1,"img",34),Ut(2,"safe"),he("click",function(){V(e);const r=v().index;return H(v(3).selectIcon(r))}),g(),q(3,dae,3,0,"button",35),g()}if(2&t){const e=v(),i=e.$implicit,r=e.index,o=v(3);m("@bounceInOut",void 0)("ngClass",Ke(10,Kse,o.tabletopObject.currntIconIndex==r)),h(),je("cursor",o.tabletopObject.currntIconIndex==r?"auto":"pointer"),m("src",zt(2,7,i.url,"resourceUrl"),bn)("alt",i.name),h(2),m("ngIf",o.tabletopObject.currntIconIndex==r)}}function fae(t,n){if(1&t&&(p(0,"div",7),q(1,hae,4,12,"span",32),g()),2&t){const e=n.$implicit,i=n.index;je("top",-v(3).showIconOffset(i),"px"),h(),m("ngIf",0<e.url.length)}}function pae(t,n){if(1&t){const e=Le();p(0,"span",38)(1,"img",39),Ut(2,"safe"),he("click",function(){const r=V(e).index;return H(v(3).selectImage(r))}),g()()}if(2&t){const e=n.$implicit,i=n.index,r=v(3);je("left",50*(r.tabletopObject.currntImageIndex<=i?i-1:i)-r.showCaseOffset(i),"px"),m("ngClass",Ke(9,Qse,r.tabletopObject.currntImageIndex==i)),h(),m("@bounceInOut",void 0)("src",zt(2,6,e.url,"resourceUrl"),bn)("alt",e.name)}}function gae(t,n){if(1&t){const e=Le();p(0,"button",40),he("click",function(){return V(e),H(v(3).openModalAddImage())}),y(1),g()}if(2&t){const e=v(3);je("left",e.tabletopObject.imageFiles.length<0?-5:45*(e.tabletopObject.imageFiles.length-1)-5-e.showCaseOffset(e.tabletopObject.imageFiles.length-2),"px"),h(),Xe(e.tabletopObject.imageFiles.length<2?"\u5207\u308a\u66ff\u3048\u753b\u50cf\u8a2d\u5b9a":"\uff0b")}}function mae(t,n){if(1&t&&(p(0,"div",41),Ge(1,"div",42),Ut(2,"safe"),g()),2&t){const e=v(3);je("width",e.imageAreaRreact.width,"px")("height",e.imageAreaRreact.height,"px"),m("ngStyle",Ke(15,Jse,"scale("+e.imageAreaRreact.scale+")")),h(),je("font-size",e.cardFontSize,"px")("color",e.cardColor)("text-shadow",e.cardTextShadowCss),m("innerHTML",zt(2,12,e.cardText,"html"),$r)}}function _ae(t,n){if(1&t){const e=Le();p(0,"div",22)(1,"div",23),q(2,fae,2,3,"div",24),g(),p(3,"div",25),q(4,pae,3,11,"span",26)(5,gae,2,3,"button",27),g(),q(6,mae,3,17,"div",28),p(7,"div",29)(8,"div",30)(9,"img",31,1),Ut(11,"safe"),he("dblclick",function(){return V(e),H(v(2).openMainImageModal())})("load",function(){return V(e),H(v(2).onMainImageLoad())}),g()()()()}if(2&t){const e=v(2);h(2),m("ngForOf",e.tabletopObject.faceIcons)("ngForTrackBy",e.identify),h(2),m("ngForOf",e.tabletopObject.imageFiles),h(),m("ngIf","character"==e.tabletopObject.aliasName&&e.tabletopObject.imageFiles.length<e.MAX_IMAGE_ICON_COUNT&&(e.tabletopObject.imageFiles.length>1||0<(null==e.tabletopObject.imageFile?null:e.tabletopObject.imageFile.url.length))),h(),m("ngIf","card"==e.tabletopObject.aliasName&&(e.tabletopObject.isFront||e.tabletopObject.isHand||e.isVisible)||"card-stack"==e.tabletopObject.aliasName&&e.tabletopObject.topCard.isFront),h(),m("ngClass",Ke(14,Zse,e.tabletopObject.isInverse)),h(),m("ngClass",Yl(16,qse,0==e.tabletopObject.aura,1==e.tabletopObject.aura,2==e.tabletopObject.aura,3==e.tabletopObject.aura,4==e.tabletopObject.aura,5==e.tabletopObject.aura,6==e.tabletopObject.aura,7==e.tabletopObject.aura)),h(),m("src",zt(11,11,e.imageFile.url,"resourceUrl"),bn)("alt",e.imageFile.name)("ngClass",Qs(25,Xse,e.isBlackPaint,e.tabletopObject.isHollow,""==e.tabletopObject.aliasName))("@switchImage",e.tabletopObject.currntImageIndex)}}function bae(t,n){if(1&t){const e=Le();p(0,"div",47)(1,"button",48),he("click",function(){return V(e),H(v(3).showChatPalette())}),y(2,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a"),g(),p(3,"button",48),he("click",function(){return V(e),H(v(3).showStandSetting())}),y(4,"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a"),g()()}}function vae(t,n){if(1&t&&(Ue(0),p(1,"div",43)(2,"div",44),Ge(3,"div",45),g(),q(4,bae,5,0,"div",46),g(),ze()),2&t){const e=v(2);h(3),m("gameDataElement",e.tabletopObject.commonDataElement)("tabletopObject",e.tabletopObject)("isTagLocked",!0)("isHideText","card"===e.tabletopObject.aliasName&&!e.tabletopObject.isFront&&!e.tabletopObject.isHand&&!e.tabletopObject.isGMMode)("isNoLogging",e.isNoLogging)("descriptionType",e.descriptionType),h(),m("ngIf","character"===e.tabletopObject.aliasName)}}function yae(t,n){if(1&t&&(p(0,"div",43)(1,"div",44),Ge(2,"div",50),g()()),2&t){const e=n.$implicit,i=v(3);h(2),m("gameDataElement",e)("tabletopObject",i.tabletopObject)("isEdit",i.isEdit)("isNoLogging",i.isNoLogging)}}function Cae(t,n){if(1&t&&(Ue(0),q(1,yae,3,4,"div",49),ze()),2&t){const e=v(2);h(),m("ngForOf",e.tabletopObject.detailDataElement.children)}}function xae(t,n){if(1&t){const e=Le();Ue(0),p(1,"div",43)(2,"button",51),he("click",function(){return V(e),H(v(2).addDataElement())}),y(3,"\u65b0\u3057\u3044\u9805\u76ee\u3092\u8ffd\u52a0"),g()(),ze()}}function wae(t,n){if(1&t){const e=Le();p(0,"div",19)(1,"span")(2,"img",20),Ut(3,"safe"),he("click",function(){return V(e),H(v().openModal("shadowImageIdentifier",!0))}),g()(),q(4,_ae,12,29,"div",21)(5,vae,5,7,"ng-container",10)(6,Cae,2,1,"ng-container",10)(7,xae,4,0,"ng-container",10),g()}if(2&t){const e=v();h(2),m("src",zt(3,6,e.tabletopObject.shadowImageFile.url,"resourceUrl"),bn)("alt",e.tabletopObject.shadowImageFile.name),h(2),m("ngIf",(0<(null==e.tabletopObject.imageFile?null:e.tabletopObject.imageFile.url.length)||0<(null==e.tabletopObject.faceIcons?null:e.tabletopObject.faceIcons.length))&&"table-mask"!=e.tabletopObject.aliasName),h(),m("ngIf",e.tabletopObject.commonDataElement),h(),m("ngIf",e.tabletopObject.detailDataElement),h(),m("ngIf",e.isEdit)}}let kl=(()=>{class t{constructor(e,i,r,o,s){this.saveDataService=e,this.panelService=i,this.modalService=r,this.pointerDeviceService=o,this.chatMessageService=s,this.tabletopObject=null,this.isEdit=!1,this.networkService=jt,this.MAX_IMAGE_ICON_COUNT=8,this.isSaveing=!1,this.progresPercent=0,this.gridSize=50,this.naturalWidth=0,this.naturalHeight=0,this.mainImageWidth=0,this.mainImageHeight=0}ngOnInit(){ne.register(this).on("DELETE_GAME_OBJECT",e=>{this.tabletopObject&&this.tabletopObject.identifier===e.data.identifier&&this.panelService.close()}).on("UPDATE_GAME_OBJECT",-1e3,e=>{if(this.tabletopObject&&this.tabletopObject.identifier===e.data.identifier)switch(this.tabletopObject.aliasName){case"terrain":this.panelService.title=`\u5730\u5f62\u8a2d\u5b9a - ${this.tabletopObjectName}`;break;case"card":const i=this.tabletopObject;i instanceof Ci&&(this.panelService.title=`\u30ab\u30fc\u30c9\u8a2d\u5b9a - ${i.isFront?this.tabletopObjectName:"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09"}`);break;case"card-stack":this.panelService.title=`\u5c71\u672d\u8a2d\u5b9a - ${this.tabletopObjectName}`;break;case"table-mask":this.panelService.title=`\u30de\u30c3\u30d7\u30de\u30b9\u30af\u8a2d\u5b9a - ${this.tabletopObjectName}`;break;case"text-note":this.panelService.title=`\u5171\u6709\u30e1\u30e2\u8a2d\u5b9a - ${this.tabletopObjectName}`;break;case"dice-symbol":this.panelService.title=`\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u8a2d\u5b9a - ${this.tabletopObjectName}`;break;case"character":this.panelService.title=`\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8 - ${this.tabletopObjectName}`;break;case"range":this.panelService.title=`\u5c04\u7a0b\u30fb\u7bc4\u56f2\u8a2d\u5b9a - ${this.tabletopObjectName}`}})}ngAfterViewInit(){queueMicrotask(()=>{this.chatMessageService.sendOperationLog(`${this.tabletopObject instanceof Ci&&!this.tabletopObject.isFront?"\u30ab\u30fc\u30c9\u8a2d\u5b9a - \u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09":this.panelService.title} \u3092\u958b\u3044\u305f`)})}ngOnDestroy(){ne.unregister(this)}toggleEditMode(){this.isEdit=!this.isEdit}addDataElement(){if(this.tabletopObject.detailDataElement){let e=wt.create("\u898b\u51fa\u3057","",{}),i=wt.create("\u30bf\u30b0","",{});e.appendChild(i),this.tabletopObject.detailDataElement.appendChild(e)}}clone(){let e=this.tabletopObject.clone();switch(e.location.x+=50,e.location.y+=50,this.tabletopObject.parent&&this.tabletopObject.parent.appendChild(e),e.update(),this.tabletopObject.aliasName){case"terrain":tt.play(Te.blockPut),e.isLocked=!1;break;case"card":case"card-stack":e.owner="",e.toTopmost();case"table-mask":e.isLock=!1,e.isPreview=!1,tt.play(Te.cardPut);break;case"text-note":e.toTopmost(),tt.play(Te.cardPut);break;case"dice-symbol":tt.play(Te.dicePut);default:tt.play(Te.piecePut)}}get tabletopObjectName(){let e=this.tabletopObject.commonDataElement.getFirstElementByName("name")||this.tabletopObject.commonDataElement.getFirstElementByName("title");return e?e.value:""}get imageFile(){const e=this.tabletopObject;return e?e instanceof Ci&&this.isVisible?e.frontImage:e.imageFile:vn.Empty}get descriptionType(){return this.tabletopObject instanceof rr&&!this.tabletopObject.isApplyWidth?"range-not-width":this.tabletopObject.aliasName}saveToXML(){var e=this;return(0,L.A)(function*(){if(!e.tabletopObject||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;const i=e.tabletopObject instanceof Ci&&!e.tabletopObject.isFront?"\u30ab\u30fc\u30c9":e.tabletopObjectName;yield e.saveDataService.saveGameObjectAsync(e.tabletopObject,"fly_xml_"+i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}setLocation(e){ne.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.tabletopObject.identifier}),tt.play("graveyard"==e?Te.sweep:Te.piecePut),this.tabletopObject.setLocation(e)}openModal(e="",i=!1){let r=[];if("shadowImageIdentifier"==e){const o=this.tabletopObject.imageElement;o&&"null"!=o.value&&o.currentValue&&(r=[o.currentValue+""])}else{const o=this.tabletopObject.imageDataElement.getElementsByName(e);o&&o.length>0&&(r=o.map(s=>s.value+""))}this.modalService.open(Yc,{isAllowedEmpty:i,currentImageIdentifires:r}).then(o=>{if(this.tabletopObject&&this.tabletopObject.imageDataElement&&o)if("shadowImageIdentifier"==e){const s=this.tabletopObject.imageElement;if(s){"null"!=s.value&&(s.currentValue=o);const a=this.tabletopObject.imageDataElement.getElementsByName("shadowImageIdentifier");for(const c of a)this.tabletopObject.imageDataElement.removeChild(c)}}else if("faceIcon"===e){let s=this.tabletopObject.imageDataElement.getElementsByName(e);if(s.length>=this.MAX_IMAGE_ICON_COUNT){for(let a=this.MAX_IMAGE_ICON_COUNT;a<s.length;a++)this.deleteIcon(a);s[this.MAX_IMAGE_ICON_COUNT-1].value=o}else this.tabletopObject.imageDataElement.appendChild(wt.create(e,o,{type:"image"},e+oa.generateUuid()));this.tabletopObject.currntIconIndex<0&&(this.tabletopObject.currntIconIndex=0)}else{let s=this.tabletopObject.imageDataElement.getFirstElementByName(e);if(!s)return;s.value=o}})}openModalAddImage(){let e=[];const i=this.tabletopObject.imageDataElement.getElementsByName("imageIdentifier");i.length>0&&(e=i.map(r=>r.value+"")),this.modalService.open(Yc,{currentImageIdentifires:e}).then(r=>{if(!this.tabletopObject||!this.tabletopObject.imageDataElement||!r)return;let o=this.tabletopObject.imageDataElement.getElementsByName("imageIdentifier");if(o.length>=this.MAX_IMAGE_ICON_COUNT){for(let s=this.MAX_IMAGE_ICON_COUNT;s<o.length;s++)this.deleteImage(s);o[this.MAX_IMAGE_ICON_COUNT-1].value=r}else this.tabletopObject.imageDataElement.appendChild(wt.create("imageIdentifier",r,{type:"image"},name+oa.generateUuid()));this.tabletopObject.currntImageIndex<0&&(this.tabletopObject.currntImageIndex=0)})}openModalReplaceImage(e=!1){let i=[];const r=this.tabletopObject.imageDataElement.getElementsByName("imageIdentifier");r.length>0&&(i=r.map(o=>o.value+"")),this.modalService.open(Yc,{isAllowedEmpty:e,currentImageIdentifires:i}).then(o=>{!this.tabletopObject||!this.tabletopObject.imageDataElement||!o||("null"==o?this.tabletopObject.imageElement&&1==this.tabletopObject.imageFiles.length?(this.tabletopObject.imageElement.value=o,this.tabletopObject.imageElement.currentValue=o):this.deleteImage(this.tabletopObject.currntImageIndex):this.tabletopObject.imageElement&&(this.tabletopObject.imageElement.value=o))})}openModalChangeAllCardImages(){this.modalService.open(Yc,{isAllowedEmpty:!1}).then(e=>{!this.tabletopObject||!this.tabletopObject||!(this.tabletopObject instanceof Vi)||!e||this.tabletopObject.cards.forEach(i=>{let r=i.imageDataElement.getFirstElementByName("back");r&&(r.value=e)})})}selectImage(e,i="imageIdentifier"){this.tabletopObject.currntImageIndex!=e&&(this.tabletopObject.currntImageIndex=e,tt.play(Te.surprise),ne.trigger("UPDATE_INVENTORY",null))}selectIcon(e){this.tabletopObject.currntIconIndex!=e&&(this.tabletopObject.currntIconIndex=e)}deleteImage(e=0,i="imageIdentifier"){if(!this.tabletopObject||!this.tabletopObject.imageDataElement)return;let r=this.tabletopObject.imageDataElement.getElementsByName(i);r&&0<r.length&&e<r.length&&(this.tabletopObject.currntImageIndex>e&&(this.tabletopObject.currntImageIndex-=1),this.tabletopObject.imageDataElement.removeChild(r[e]),this.tabletopObject.currntImageIndex>=r.length-1&&(this.tabletopObject.currntImageIndex=r.length-2),this.tabletopObject.currntImageIndex<0&&(this.tabletopObject.currntImageIndex=0))}deleteIcon(e=0,i=""){if(!this.tabletopObject||!this.tabletopObject.imageDataElement)return;let r=this.tabletopObject.imageDataElement.getElementsByName("faceIcon");r&&0<r.length&&e<r.length&&(!i||r[e].value===i)&&(this.tabletopObject.currntIconIndex>e&&(this.tabletopObject.currntIconIndex-=1),this.tabletopObject.imageDataElement.removeChild(r[e]),this.tabletopObject.currntIconIndex>=r.length-1&&(this.tabletopObject.currntIconIndex=r.length-2),this.tabletopObject.currntIconIndex<0&&(this.tabletopObject.currntIconIndex=0))}openMainImageModal(){this.tabletopObject instanceof Vi||(this.tabletopObject instanceof Ci?this.openModal(this.tabletopObject.isVisible?"front":"back"):this.tabletopObject instanceof ts?this.openModal(this.tabletopObject.face):this.tabletopObject instanceof gn?this.openModalReplaceImage(this.tabletopObject.imageFiles.length>1||0<this.tabletopObject.imageFile?.url.length):this.openModal("imageIdentifier",this.tabletopObject.imageFile&&this.tabletopObject.imageFile.url.length>0))}showChatPalette(){if(!(this.tabletopObject instanceof gn))return;let e=this.pointerDeviceService.pointers[0];this.panelService.open(Qg,{left:e.x-250,top:e.y-175,width:620,height:350}).character=this.tabletopObject}showStandSetting(){if(!(this.tabletopObject instanceof gn))return;let e=this.pointerDeviceService.pointers[0];this.panelService.open(pb,{left:e.x-400,top:e.y-175,width:720,height:572}).character=this.tabletopObject}onMainImageLoad(){this.mainImageElement&&(this.mainImageWidth=this.mainImageElement.nativeElement.clientWidth,this.mainImageHeight=this.mainImageElement.nativeElement.clientHeight,this.naturalWidth=this.mainImageElement.nativeElement.naturalWidth,this.naturalHeight=this.mainImageElement.nativeElement.naturalHeight)}identify(e,i){return i.identifier}get imageAreaRreact(){return this.calcImageAreaRect(this.mainImageWidth,this.mainImageHeight,0)}calcImageAreaRect(e,i,r){const o={width:0,height:0,top:r,left:r,scale:1};if(0==this.naturalWidth||0==this.naturalHeight)return o;const s=e-2*r,a=i-2*r;this.naturalHeight*s/this.naturalWidth>a?(o.width=this.naturalWidth*a/this.naturalHeight,o.height=a,o.left=r+(s-o.width)/2):(o.width=s,o.height=this.naturalHeight*s/this.naturalWidth,o.top=r+(a-o.height)/2);let c=null;return this.tabletopObject instanceof Vi?c=this.tabletopObject.topCard:this.tabletopObject instanceof Ci&&(c=this.tabletopObject),c&&(o.scale=o.width/(c.size*this.gridSize),o.width=c.size*this.gridSize,o.height=o.width*this.naturalHeight/this.naturalWidth),o}get cardColor(){let e=null;return this.tabletopObject instanceof Vi?e=this.tabletopObject.topCard:this.tabletopObject instanceof Ci&&(e=this.tabletopObject),e?e.color:"#555555"}get cardFontSize(){let e=null;return this.tabletopObject instanceof Vi?e=this.tabletopObject.topCard:this.tabletopObject instanceof Ci&&(e=this.tabletopObject),e?e.fontsize+9:18}get cardText(){let e=null;return this.tabletopObject instanceof Vi?e=this.tabletopObject.topCard:this.tabletopObject instanceof Ci&&(e=this.tabletopObject),e?ke.rubyToHtml(ke.escapeHtml(e.text)):""}get cardTextShadowCss(){const e=ke.textShadowColor(this.cardColor);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}get isVisible(){return!!this.tabletopObject&&(!(!Fe.myCursor||!Fe.myCursor.isGMMode)||(this.tabletopObject instanceof Ci?this.tabletopObject.isFront||this.tabletopObject.isHand:!(this.tabletopObject instanceof ts)||this.tabletopObject.isVisible))}get isBlackPaint(){return this.tabletopObject instanceof gn?this.tabletopObject.isBlackPaint:this.tabletopObject instanceof ts&&!this.isVisible}get isNoLogging(){return this.tabletopObject instanceof Ci?!this.tabletopObject.isFront:this.tabletopObject instanceof ts&&this.tabletopObject.hasOwner}showCaseOffset(e){let i=this.tabletopObject.imageFiles.length;return i<=5?0:(50-160/(i-2))*(this.tabletopObject.currntImageIndex<=e?e-1:e)}showIconOffset(e){let i=this.tabletopObject.faceIcons.length;return i<=5?0:(50-200/(i-1))*e+2}static#e=this.\u0275fac=function(i){return new(i||t)(Y(ll),Y(yi),Y(Ei),Y(lr),Y(vo))};static#t=this.\u0275cmp=In({type:t,selectors:[["game-character-sheet"]],viewQuery:function(i,r){if(1&i&&Ln($se,5),2&i){let o;Bn(o=Un())&&(r.mainImageElement=o.first)}},inputs:{tabletopObject:"tabletopObject"},decls:19,vars:14,consts:[["select",""],["mainImage",""],[3,"click"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"click","disabled"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[4,"ngIf"],["class","flex-container",4,"ngIf"],[1,"progress"],[3,"ngModel","change",4,"ngIf"],[3,"change","ngModel"],["value","table"],["value","common"],[3,"value"],["value","graveyard"],[1,"flex-container"],["draggable","false",1,"shadow-image",2,"cursor","pointer",3,"click","src","alt"],["class","box main-image-box",4,"ngIf"],[1,"box","main-image-box"],[1,"icons-box"],["style","position: relative",3,"top",4,"ngFor","ngForOf","ngForTrackBy"],[1,"image-showcase",2,"position","absolute","height","50px","top","300px"],["class","image-thumbnail","style","position: absolute;",3,"ngClass","left",4,"ngFor","ngForOf"],["style","position: relative; bottom: 30px; z-index: 700;",3,"left","click",4,"ngIf"],["class","text",3,"width","height","ngStyle",4,"ngIf"],[1,"inverser",2,"display","inline-block",3,"ngClass"],[1,"aura",2,"display","inline-block",3,"ngClass"],["draggable","false",1,"main-image",3,"dblclick","load","src","alt","ngClass"],["class","icon-image-box","style","display: block",3,"ngClass",4,"ngIf"],[1,"icon-image-box",2,"display","block",3,"ngClass"],["draggable","false",3,"click","src","alt"],["class","button-delete-icon","title","\u9854IC\u524a\u9664",3,"click",4,"ngIf"],["title","\u9854IC\u524a\u9664",1,"button-delete-icon",3,"click"],[1,"material-icons",2,"font-size","1rem"],[1,"image-thumbnail",2,"position","absolute",3,"ngClass"],["draggable","false",2,"cursor","pointer",3,"click","src","alt"],[2,"position","relative","bottom","30px","z-index","700",3,"click"],[1,"text",3,"ngStyle"],[3,"innerHTML"],[1,"flex-item"],[1,"table"],["game-data-element","",1,"table-row",3,"gameDataElement","tabletopObject","isTagLocked","isHideText","isNoLogging","descriptionType"],["style","margin-top: 3px; text-align: right",4,"ngIf"],[2,"margin-top","3px","text-align","right"],[2,"font-size","11px","color","#444",3,"click"],["class","flex-item",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","tabletopObject","isEdit","isNoLogging"],[2,"width","100%","color","#555",3,"click"]],template:function(i,r){1&i&&(p(0,"button",2),he("click",function(){return r.toggleEditMode()}),y(1,"\u7de8\u96c6\u5207\u308a\u66ff\u3048"),g(),Ue(2,3),q(3,eae,1,0,"ng-container",4)(4,tae,5,1,"ng-container",4)(5,nae,3,0,"ng-container",4)(6,iae,5,0,"ng-container",4)(7,rae,3,1,"ng-container",4)(8,oae,5,3,"ng-container",4)(9,aae,2,1,"ng-container",5),ze(),p(10,"button",2),he("click",function(){return r.clone()}),y(11,"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b"),g(),p(12,"button",6),he("click",function(){return r.saveToXML()}),p(13,"div",7)(14,"div",8),y(15,"\u4fdd\u5b58"),g(),q(16,lae,2,1,"div",9),g()(),q(17,uae,4,2,"ng-container",10)(18,wae,8,9,"div",11)),2&i&&(h(2),m("ngSwitch",r.tabletopObject.aliasName),h(),m("ngSwitchCase","numberResource"),h(),m("ngSwitchCase","card"),h(),m("ngSwitchCase","card-stack"),h(),m("ngSwitchCase","terrain"),h(),m("ngSwitchCase","dice-symbol"),h(),m("ngSwitchCase","character"),h(4),m("disabled",r.isSaveing),h(2),m("ngClass",Ke(12,Yse,r.isSaveing)),h(2),m("ngIf",r.isSaveing),h(),m("ngIf","character"===r.tabletopObject.aliasName),h(),m("ngIf",r.tabletopObject))},dependencies:[Ni,nr,ri,Lo,Hd,Dg,M0,na,ia,Ia,Or,Cr,Wse,cr],styles:["[_nghost-%COMP%]{display:block}.main-image-box[_ngcontent-%COMP%]{width:250px;height:250px;z-index:0}.main-image[_ngcontent-%COMP%]{width:250px;object-position:center bottom}.image-showcase[_ngcontent-%COMP%]{vertical-align:top;text-align:left;position:absolute;display:inline-block;vertical-align:bottom;transform-origin:center bottom}.image-thumbnail[_ngcontent-%COMP%]{color:#000;filter:drop-shadow(1px 1px 0px rgb(255,244,232)) drop-shadow(-1px 1px 0px rgb(255,244,232)) drop-shadow(-1px -1px 0px rgb(255,244,232)) drop-shadow(1px -1px 0px rgb(255,244,232));z-index:100;vertical-align:bottom;transform-origin:center bottom;transition:all 132ms ease-in-out}.image-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;max-height:100px;position:absolute;left:0;right:0;bottom:0;margin:auto;object-fit:contain;object-position:center bottom;transform-origin:center bottom}.image-thumbnail[_ngcontent-%COMP%]:hover{z-index:600}.image-thumbnail[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{width:75px;max-height:150px;left:-12px;transition:all 132ms ease-in-out}.image-thumbnail.hide[_ngcontent-%COMP%]{transform:scale3d(0,0,0)}.icons-box[_ngcontent-%COMP%]{vertical-align:top;text-align:center;position:absolute;left:216px;z-index:2}.icon-image-box[_ngcontent-%COMP%]{position:relative;width:50px;height:50px;max-width:50px;max-height:50px;border-radius:.5rem;color:#000;filter:drop-shadow(1px 1px 0px rgb(255,244,232)) drop-shadow(-1px 1px 0px rgb(255,244,232)) drop-shadow(-1px -1px 0px rgb(255,244,232)) drop-shadow(1px -1px 0px rgb(255,244,232));z-index:100;margin-top:1px;margin-left:-3px}.icon-image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%;border-radius:.5rem;border:2px solid transparent}.icon-image-box[_ngcontent-%COMP%]:hover{z-index:600}.icon-image-box[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{border:2px dotted rgba(255,0,0,40)}.icon-image-box.current-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid red}.icon-image-box[_ngcontent-%COMP%]{z-index:400}.shadow-image[_ngcontent-%COMP%]{position:absolute;width:50px;filter:brightness(0) blur(1px) drop-shadow(0px 0px 1px #fff);opacity:.7;margin-top:6px;margin-left:6px;z-index:5}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{display:table-row;box-sizing:border-box}.table-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:table-cell;border:1px solid #FFF;vertical-align:top;box-sizing:border-box}.box[_ngcontent-%COMP%]{display:inline-block;margin:5px;box-sizing:border-box}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px 0;padding:10px;flex:1 0 auto;box-sizing:border-box;min-width:25px;background-color:#eac99dcc;background-color:#f0dabdcc;color:#444;z-index:1}.flex-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{color:#ccc}.button-delete-icon[_ngcontent-%COMP%]{display:inline-block;position:absolute;margin:0;padding:2px 0 0;background-color:transparent;right:-3px;top:1px;height:18px;width:18px;font-size:8px;color:red}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #fff)}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}.text[_ngcontent-%COMP%]{transform-origin:left top;position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}"],data:{animation:[Xn("switchImage",[an(":increment, :decrement",[rn("200ms ease",En([We({transform:"scale3d(0, 0, 0)"}),We({transform:"scale3d(0, 1.2, 1.2)"}),We({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),Xn("showcase",[an(":increment, :decrement",[rn("200ms 200ms ease-in",En([We({transform:"scale3d(0, 1.0, 1.0)"}),We({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),Xn("showcaseItem",[an(":enter",[rn("200ms ease",En([We({transform:"scale3d(0, 0, 0)"}),We({transform:"scale3d(1.0, 1.0, 1.0)"})]))]),an(":leave",[rn("200ms ease",En([We({transform:"scale3d(1.0, 1.0, 1.0)"}),We({transform:"scale3d(0, 0, 0)"})]))])]),Xn("bounceInOut",[an("void => *",[rn("600ms ease",En([We({transform:"scale3d(0, 0, 0)",offset:0}),We({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),We({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),We({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),We({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),an("* => void",[rn(100,We({transform:"scale3d(0, 0, 0)"}))])])]}})}return t})();const Eae=["textArea"],Iae=t=>({"direct-message":t}),L5=(t,n)=>({color:t,"font-weight":n}),VC=t=>({"not-specified":t}),Eb=()=>({standalone:!0}),Tae=(t,n)=>({inverse:t,hollow:n}),Sae=(t,n,e,i,r,o,s,a)=>({black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}),Mae=t=>({"black-paint":t}),Dae=t=>({"disabled-stand":t});function kae(t,n){1&t&&(Ge(0,"img",29),Ut(1,"safe")),2&t&&m("src",zt(1,1,v(2).imageFile.url,"resourceUrl"),bn)}function Oae(t,n){if(1&t&&(p(0,"div",27),q(1,kae,2,4,"img",28),g()),2&t){const e=v();h(),m("ngIf",0<e.imageFile.url.length)}}function Aae(t,n){if(1&t&&(p(0,"div",27),Ge(1,"img",29),Ut(2,"safe"),g()),2&t){const e=v(2);h(),m("src",zt(2,1,null==e.character.faceIcon?null:e.character.faceIcon.url,"resourceUrl"),bn)}}function Pae(t,n){if(1&t&&(p(0,"div",31)(1,"span",32),Ge(2,"img",33),Ut(3,"safe"),g()()),2&t){const e=v(3);m("ngClass",Tn(7,Tae,e.character.isInverse,e.character.isHollow)),h(),m("ngClass",Yl(10,Sae,0==e.character.aura,1==e.character.aura,2==e.character.aura,3==e.character.aura,4==e.character.aura,5==e.character.aura,6==e.character.aura,7==e.character.aura)),h(),m("src",zt(3,4,e.character.imageFile.url,"resourceUrl"),bn)("ngClass",Ke(19,Mae,e.character.isBlackPaint))}}function Fae(t,n){if(1&t&&q(0,Pae,4,21,"div",30),2&t){const e=v(2);m("ngIf",e.character&&null!=e.character.imageFile&&0<e.character.imageFile.url.length)}}function Nae(t,n){if(1&t&&q(0,Aae,3,4,"div",6)(1,Fae,1,1,"ng-template",null,2,Ai),2&t){const e=pn(2),i=v();m("ngIf",i.isUseFaceIcon&&i.character&&null!=i.character.faceIcon&&0<(null==i.character.faceIcon||null==i.character.faceIcon.url?null:i.character.faceIcon.url.length))("ngIfElse",e)}}function Rae(t,n){if(1&t){const e=Le();p(0,"input",34),at("ngModelChange",function(r){V(e);const o=v();return it(o.isUseFaceIcon,r)||(o.isUseFaceIcon=r),H(r)}),he("change",function(){V(e);const r=v();return H(r.isUseFaceIcon=!!r.isUseFaceIcon)}),g()}if(2&t){const e=v();Et("checked",e.isUseFaceIcon?"checked":""),st("ngModel",e.isUseFaceIcon)}}function Lae(t,n){1&t&&(p(0,"b",35),y(1,"\u9854IC"),g())}function Bae(t,n){if(1&t&&(p(0,"option",36),y(1),g()),2&t){const e=v();je("color",e.myColor),Et("value",null==e.myPeer?null:e.myPeer.identifier),h(),Si("",null==e.myPeer?null:e.myPeer.name,"\uff08\u3042\u306a\u305f\uff09")}}function Uae(t,n){if(1&t&&(p(0,"option",37),y(1),g()),2&t){const e=n.$implicit;je("color",e.chatPalette&&e.chatPalette.color&&"#ffffff"!=e.chatPalette.color?e.chatPalette.color:"#444"),Et("value",e.identifier),h(),Xe(e.name)}}function zae(t,n){1&t&&(Ue(0),y(1,"\uff08\u3042\u306a\u305f\uff09"),ze())}function Hae(t,n){if(1&t&&(p(0,"option",36),y(1),q(2,zae,2,0,"ng-container",26),g()),2&t){const e=n.$implicit,i=v();je("color",e.color),Et("value",e.identifier),h(),Si("",e.name," "),h(),m("ngIf",e===i.myPeer)}}function Vae(t,n){if(1&t&&(p(0,"option",43),y(1),g()),2&t){const e=n.$implicit;Et("value",e.id),h(),Xe(e.game)}}function jae(t,n){if(1&t&&(p(0,"optgroup",41),q(1,Vae,2,2,"option",42),g()),2&t){const e=n.$implicit;Et("label",e.index),h(),m("ngForOf",e.infos)}}function Gae(t,n){if(1&t){const e=Le();p(0,"select",38,3),he("change",function(){V(e);const r=pn(1);return H(v().loadDiceBot(r.value))}),at("ngModelChange",function(r){V(e);const o=v();return it(o.gameType,r)||(o.gameType=r),H(r)}),p(2,"option",39),y(3,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u6307\u5b9a\u306a\u3057"),g(),q(4,jae,2,2,"optgroup",40),g()}if(2&t){const e=v();st("ngModel",e.gameType),m("ngModelOptions",wu(4,Eb))("ngClass",Ke(5,VC,"DiceBot"==e.gameType||""==e.gameType)),h(4),m("ngForOf",e.diceBotInfosIndexed)}}function Wae(t,n){if(1&t){const e=Le();p(0,"select",44,3),he("change",function(){V(e);const r=pn(1);return H(v().loadDiceBot(r.value))}),at("ngModelChange",function(r){V(e);const o=v();return it(o.gameType,r)||(o.gameType=r),H(r)}),p(2,"option",39),y(3,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8aad\u8fbc\u4e2d\u2026"),g()()}if(2&t){const e=v();st("ngModel",e.gameType),m("ngModelOptions",wu(3,Eb))("ngClass",Ke(4,VC,"DiceBot"==e.gameType||""==e.gameType))}}function $ae(t,n){if(1&t&&(p(0,"option",43),y(1),g()),2&t){const e=n.$implicit;Et("value",e),h(),Xe(e)}}function Yae(t,n){if(1&t){const e=Le();p(0,"div",45)(1,"label",46)(2,"input",34),at("ngModelChange",function(r){V(e);const o=v();return it(o.isUseStandImage,r)||(o.isUseStandImage=r),H(r)}),he("change",function(){V(e);const r=v();return H(r.isUseStandImage=!!r.isUseStandImage)}),g(),p(3,"b",35),y(4,"Stand: "),g()(),p(5,"select",47),he("change",function(){return V(e),H(v().isUseStandImage=!0)}),at("ngModelChange",function(r){V(e);const o=v();return it(o.standName,r)||(o.standName=r),H(r)}),p(6,"option",16),y(7,"\u672a\u9078\u629e"),g(),q(8,$ae,2,2,"option",42),g(),p(9,"span",48)(10,"b",35),y(11,"Pos: "),g(),p(12,"input",49),he("change",function(){return V(e),H(v().isUseStandImage=!0)}),at("ngModelChange",function(r){V(e);const o=v();return it(o.character.standList.position,r)||(o.character.standList.position=r),H(r)}),g(),p(13,"input",50),he("change",function(){return V(e),H(v().isUseStandImage=!0)}),at("ngModelChange",function(r){V(e);const o=v();return it(o.character.standList.position,r)||(o.character.standList.position=r),H(r)}),g(),p(14,"b",35),y(15,"\uff05"),g()(),p(16,"button",51),he("click",function(){return V(e),H(v().farewellStand())}),y(17,"\u9000\u53bb"),g()()}if(2&t){const e=v();m("ngClass",Ke(14,Dae,!e.isUseStandImageOnChatTab)),h(2),Et("checked",e.isUseStandImage?"checked":""),st("ngModel",e.isUseStandImage),en("disabled",e.isUseStandImageOnChatTab?null:""),h(3),st("ngModel",e.standName),m("ngModelOptions",wu(16,Eb))("ngClass",Ke(17,VC,""==e.standName)),en("disabled",e.isUseStandImageOnChatTab?null:""),h(3),m("ngForOf",e.standNameList),h(4),st("ngModel",e.character.standList.position),en("disabled",e.isUseStandImageOnChatTab?null:""),h(),st("ngModel",e.character.standList.position),en("disabled",e.isUseStandImageOnChatTab?null:""),h(3),en("disabled",e.isUseStandImageOnChatTab?null:"")}}function Zae(t,n){if(1&t){const e=Le();p(0,"input",52),at("ngModelChange",function(r){V(e);const o=v();return it(o.paletteColor,r)||(o.paletteColor=r),H(r)}),g()}2&t&&(st("ngModel",v().paletteColor),m("ngModelOptions",wu(2,Eb)))}function qae(t,n){1&t&&(Ge(0,"div",59),Ut(1,"safe")),2&t&&je("background-image",zt(1,2,"url("+v().$implicit.imageUrl+")","style"))}function Xae(t,n){1&t&&(p(0,"span",60),y(1,", "),g())}function Kae(t,n){if(1&t&&(p(0,"div",54),q(1,qae,2,5,"div",55),p(2,"div",56)(3,"span",57),Ut(4,"safe"),y(5),g(),q(6,Xae,2,0,"span",58),g()()),2&t){const e=n.$implicit,i=n.index,r=v(2);h(),m("ngIf",e.imageUrl),h(2),je("color",zt(4,5,e.color,"style")),h(2),Xe(e.name),h(),m("ngIf",r.writingPeerNameAndColors.length!==i+1)}}function Qae(t,n){if(1&t&&(Ue(0),q(1,Kae,7,8,"div",53),y(2," \u304c\u5165\u529b\u4e2d... "),ze()),2&t){const e=v();h(),m("ngForOf",e.writingPeerNameAndColors)}}class la{get isUseStandImageOnChatTab(){const n=bt.instance.get(this.chatTabidentifier);return n&&n.isUseStandImage}get gameType(){return this._gameType}set gameType(n){this._gameType=n,this.gameTypeChange.emit(n)}get sendFrom(){return this._sendFrom}set sendFrom(n){this._sendFrom=n,this.sendFromChange.emit(n)}get sendTo(){return this._sendTo}set sendTo(n){this._sendTo=n,this.sendToChange.emit(n)}get text(){return this._text}set text(n){this._text=n,this.textChange.emit(n),null!=n&&this.isFilterTextUpdate&&(this.filterText=n)}get filterText(){return this._filterText}set filterText(n){this._filterText=n,this.filterTextChange.emit(n)}get isDirect(){return!(null==this.sendTo||!this.sendTo.length)}static#e=this.history=new Array;static#t=this.MAX_HISTORY_NUM=1e3;get character(){let n=bt.instance.get(this.sendFrom);return n instanceof gn?n:null}get hasStand(){return!(!this.character||!this.character.standList)&&this.character.standList.standElements.length>0}get standNameList(){if(!this.hasStand)return[];let n=[];for(let e of this.character.standList.standElements){let i=e.getFirstElementByName("name");i&&null!=i.value&&""!=i.value.toString().trim()&&n.indexOf(i.value.toString())<0&&n.push(i.value.toString())}return this.character.standList.isSortNameList?n.sort():n}get standListNoGroup(){return[]}get standListWithGroup(){if(!this.hasStand)return[];let n={};const e=this.character.standList.standElements.map(i=>i.getFirstElementByName("name")).filter(i=>i);e.sort((i,r)=>i.currentValue===r.currentValue?0:i.currentValue>r.currentValue?-1:1);for(const i of e)if(i&&i.value){const r=i.currentValue&&i.currentValue.toString().length>0?i.currentValue.toString():"";r&&(n[r]||(n[r]=[]),n[r].indexOf(i.value.toString())<0&&n[r].push(i.value.toString()))}return Object.keys(n).sort().map(i=>({name:i,stands:n[i].sort()})).filter(i=>i.stands.length>0)}get imageFile(){let n=bt.instance.get(this.sendFrom),e=null;return n instanceof gn?e=n.imageFile:n instanceof Fe&&(e=n.image),e||vn.Empty}get paletteColor(){return this.character&&this.character.chatPalette&&this.character.chatPalette.paletteColor?this.character.chatPalette.paletteColor:Fe.CHAT_TRANSPARENT_COLOR}set paletteColor(n){this.character.chatPalette.color=n||Fe.CHAT_TRANSPARENT_COLOR}get myColor(){return Fe.myCursor&&Fe.myCursor.color&&Fe.myCursor.color!=Fe.CHAT_TRANSPARENT_COLOR?Fe.myCursor.color:Fe.CHAT_DEFAULT_COLOR}get color(){return this.paletteColor&&this.paletteColor!=Fe.CHAT_TRANSPARENT_COLOR?this.paletteColor:this.myColor}get sendToColor(){let n=bt.instance.get(this.sendTo);return n instanceof Fe?n.color:Fe.CHAT_DEFAULT_COLOR}get gameCharacters(){return this.shouldUpdateCharacterList&&(this.shouldUpdateCharacterList=!1,this._gameCharacters=bt.instance.getObjects(gn).filter(n=>this.allowsChat(n))),this._gameCharacters}get diceBotInfos(){return Zi.diceBotInfos}get myPeer(){return Fe.myCursor}get otherPeers(){return bt.instance.getObjects(Fe)}get diceBotInfosIndexed(){return Zi.diceBotInfosIndexed}constructor(n,e,i,r,o,s){this.ngZone=n,this.chatMessageService=e,this.batchService=i,this.panelService=r,this.pointerDeviceService=o,this.contextMenuService=s,this.onlyCharacters=!1,this.chatTabidentifier="",this._gameType="",this.gameTypeChange=new ei,this._sendFrom=this.myPeer?this.myPeer.identifier:"",this.sendFromChange=new ei,this._sendTo="",this.sendToChange=new ei,this._text="",this.textChange=new ei,this.isFilterTextUpdate=!1,this._filterText="",this.filterTextChange=new ei,this.moveToPalette=new ei,this.chat=new ei,this.gameHelp="",this.isUseFaceIcon=!0,this.isUseStandImage=!0,this.currentHistoryIndex=-1,this.standName="",this.shouldUpdateCharacterList=!0,this._gameCharacters=[],this.writingEventInterval=null,this.previousWritingLength=0,this.writingPeers=new Map,this.writingPeerNameAndColors=[]}ngOnInit(){ne.register(this).on("MESSAGE_ADDED",n=>{if(n.data.tabIdentifier!==this.chatTabidentifier)return;let e=bt.instance.get(n.data.messageIdentifier),i=bt.instance.getObjects(Fe).find(o=>o.userId===e.from),r=i?i.peerId:"?";this.writingPeers.has(r)&&(this.writingPeers.get(r).stop(),this.writingPeers.delete(r),this.updateWritingPeerNameAndColors())}).on(`UPDATE_GAME_OBJECT/aliasName/${gn.aliasName}`,n=>{if(this.shouldUpdateCharacterList=!0,n.data.identifier!==this.sendFrom)return;let e=bt.instance.get(n.data.identifier);e&&!this.allowsChat(e)&&(this.sendFrom=0<this.gameCharacters.length&&this.onlyCharacters?this.gameCharacters[0].identifier:this.myPeer.identifier)}).on("DISCONNECT_PEER",n=>{let e=bt.instance.get(this.sendTo);e instanceof Fe&&e.peerId===n.data.peerId&&(this.sendTo="")}).on("WRITING_A_MESSAGE",n=>{n.isSendFromSelf||n.data!==this.chatTabidentifier||(this.writingPeers.has(n.sendFrom)||this.writingPeers.set(n.sendFrom,new Nc(()=>{this.writingPeers.delete(n.sendFrom),this.updateWritingPeerNameAndColors(),this.ngZone.run(()=>{})},2e3)),this.writingPeers.get(n.sendFrom).reset(),this.updateWritingPeerNameAndColors(),this.batchService.requireChangeDetection())})}ngOnDestroy(){ne.unregister(this),this.batchService.remove(this)}updateWritingPeerNameAndColors(){this.writingPeerNameAndColors=Array.from(this.writingPeers.keys()).map(n=>{let e=Fe.findByPeerId(n);return{name:e?e.name:"",color:e?e.color:Fe.CHAT_TRANSPARENT_COLOR,imageUrl:e?e.image.url:""}})}onInput(){if(null===this.writingEventInterval&&this.previousWritingLength<=this.text.length){let n=null;if(this.isDirect){let e=bt.instance.get(this.sendTo);if(e instanceof Fe){let i=Ar.parse(e.peerId);i&&(n=i.peerId)}}ne.call("WRITING_A_MESSAGE",this.chatTabidentifier,n),this.writingEventInterval=setTimeout(()=>{this.writingEventInterval=null},200)}this.previousWritingLength=this.text.length,this.calcFitHeight()}moveHistory(n,e){if(n&&n.preventDefault(),this.currentHistoryIndex<0&&(this.tmpText=this.text),e<0&&this.currentHistoryIndex<0)this.currentHistoryIndex=-1;else{if(e>0&&this.currentHistoryIndex>=la.history.length-1)return void(this.currentHistoryIndex=la.history.length-1);this.currentHistoryIndex=this.currentHistoryIndex+e}let i;this.currentHistoryIndex<0?(this.currentHistoryIndex=-1,i=this.tmpText&&this.tmpText.length?this.tmpText:""):i=la.history[this.currentHistoryIndex],this.text=i,this.previousWritingLength=this.text.length,this.textAreaElementRef.nativeElement.value=i,this.calcFitHeight()}moveTo(n){this.textAreaElementRef&&this.textAreaElementRef.nativeElement.selectionStart==this.textAreaElementRef.nativeElement.selectionEnd&&this.textAreaElementRef.nativeElement.selectionStart===this.textAreaElementRef.nativeElement.value.length&&(this.moveToPalette.emit(this.text),n.preventDefault())}focusInput(){this.textAreaElementRef&&this.textAreaElementRef.nativeElement.focus()}sendChat(n){var e=this;if(n&&n.preventDefault(),n&&13!==n.keyCode)return;this.sendFrom.length||(this.sendFrom=this.myPeer.identifier);let i=this.text,r=this.character;const o=this.gameType,s=this.sendFrom,a=this.sendTo,c=this.color,u=this.isUseFaceIcon,f=this.standName,b=this.isUseStandImage,C=this.isUseStandImageOnChatTab;""!=this.text&&(la.history=la.history.filter(M=>M!==this.text),la.history.unshift(this.text),la.history.length>=la.MAX_HISTORY_NUM&&la.history.pop(),this.currentHistoryIndex=-1,this.tmpText=null),this.text="",this.previousWritingLength=this.text.length;const x=this.textAreaElementRef.nativeElement;x&&(x.value=""),this.calcFitHeight(),ne.trigger("MESSAGE_EDITING_START",null),(0,L.A)(function*(){let M="",U=null;const W=[];if(""!=i&&/^[\\\uffe5]+[:\uff1a]/.test(i))i=i.replace(/[\\\uffe5]([:\uff1a])/,"$1");else if(""!=i&&ke.toHalfWidth(i).startsWith(":"))if(r){const $=ke.parseCommands(r.chatPalette.evaluate(i.substring(1),r.rootDataElement));if(i=$.endString,$.commands.length){const ge=[`${""==r.name?"(\u7121\u540d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc)":r.name} \u3078\u306e\u30b3\u30de\u30f3\u30c9\uff1a${$.commandString}`];let ye=!1;for(let lt=0;lt<$.commands.length;lt++){let Ee=null;try{const Be=$.commands[lt];if(Be.isIncomplete)throw"\u2192 \u30b3\u30de\u30f3\u30c9\u30a8\u30e9\u30fc\uff1a\u30b3\u30de\u30f3\u30c9\u4e0d\u5b8c\u5168\uff1a"+Be.targetName;const ft=r.chatPalette.evaluate(Be.targetName,r.rootDataElement,W),rt=ke.toHalfWidth(Be.operator),ht=r.chatPalette.evaluate(Be.value,r.rootDataElement,W);let xt,pt,Qt,ln=!1,Mn=!1;if((pt=r.detailDataElement.getFirstElementByNameUnsensitive(ft))?(pt.isNumberResource||pt.isSimpleNumber||pt.isAbilityScore)&&(ln=!0):(pt=r.detailDataElement.getFirstElementByNameUnsensitive(ft,/^\u6700\u5927/)||r.detailDataElement.getFirstElementByNameUnsensitive(ft,/^Max[\:\_\-\s]*/i)||r.detailDataElement.getFirstElementByNameUnsensitive(ft,/^\u521d\u671f/)||r.detailDataElement.getFirstElementByNameUnsensitive(ft,/\u521d\u671f\u5024$/)||r.detailDataElement.getFirstElementByNameUnsensitive(ft,/\u6700\u5927\u5024$/)||r.detailDataElement.getFirstElementByNameUnsensitive(ft,/^\u57fa\u672c/)||r.detailDataElement.getFirstElementByNameUnsensitive(ft,/^\u539f/)||r.detailDataElement.getFirstElementByNameUnsensitive(ft,/\^$/)||r.detailDataElement.getFirstElementByNameUnsensitive(ft,/\u57fa\u672c\u5024$/)||r.detailDataElement.getFirstElementByNameUnsensitive(ft,/\u539f\u70b9$/))&&(pt.isNumberResource||pt.isAbilityScore?(ln=!0,Mn=!0):pt=null),!pt)throw`\u2192 \u30b3\u30de\u30f3\u30c9\u30a8\u30e9\u30fc\uff1a${""==ke.cr(ft).trim()?"(\u7121\u540d\u306e\u5909\u6570)":ke.cr(ft).trim()} \u306f\u898b\u3064\u304b\u3089\u306a\u304b\u3063\u305f`;xt=pt.loggingValue;let gt=null;if(Be.isEscapeRoll||">"===rt)gt=ht;else{const St=ke.toHalfWidth(ht.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).trim();if(""==ke.cr(St))gt="";else if(/^[\+\-]?\d+$/.test(St)?gt=parseInt(St):/^[\d\+\-\*\/\(\)]+$/.test(St.replace(/[\u216e\xd0]/g,"D").replace(/\\xd7/g,"*").replace(/\\xf7/g,"/"))?Ee=yield Zi.rollCommandAsync(`C(${St.replace(/[\u216e\xd0]/g,"D").replace(/\\xd7/g,"*").replace(/\\xf7/g,"/")})`,o||"DiceBot"):/^[c\uff23\uff43][h\uff28\uff48][o\uff2f\uff4f][i\uff29\uff49][c\uff23\uff43][e\uff25\uff45]/i.test(ht)||/^[a-zA-Z0-9!-/:-@\xa5[-`{-~\}]+$/.test(St.replace(/[\u216e\xd0]/g,"D").replace(/\\xd7/g,"*").replace(/\\xf7/g,"/"))||Jl.instance.diceRollTables.some(yn=>null!=yn.command&&new RegExp("^"+ke.toHalfWidth(yn.command.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).toUpperCase().trim()+"([=+\\-]\\d*)?$").test(St.toUpperCase()))?Ee=yield Zi.rollCommandAsync(ht,o||"DiceBot"):gt=ht,Ee){let yn=null;ln&&Ee.result.length>0&&(yn=Ee.result.match(/\s\uff1e\s(?:\u6210\u529f\u6570|\u8a08\u7b97\u7d50\u679c)?(\-?\d+)$/))?gt=yn[1]:pt.isCheckProperty&&(Ee.isSuccess||Ee.isFailure)?gt=Ee.isSuccess?"1":"0":Ee.result.length>0&&(gt=Ee.isDiceRollTable?Ee.result.split(/\s\uff1e\s/).slice(1).join(""):Ee.result.split(/\s\uff1e\s/).slice(-1)[0])}else ln||(gt=ht)}if(null==gt||Ee&&Ee.isDiceRollTable&&Ee.isFailure||ln&&""!==gt&&isNaN(gt))throw`\u2192 ${""==pt.name?"(\u7121\u540d\u306e\u5909\u6570)":pt.name} \u3092\u64cd\u4f5c \u2192 \u30b3\u30de\u30f3\u30c9\u30a8\u30e9\u30fc\uff1a`+Be.operator+Be.value;if(pt.isUrl&&!ke.validUrl(ke.cr(gt)))throw`\u2192 ${""==pt.name?"(\u7121\u540d\u306e\u5909\u6570)":pt.name} \u3092\u64cd\u4f5c \u2192 URL\u4e0d\u6b63\uff1a`+Be.value;if(">"===rt)if(ln)if(""!=gt)if(pt.isNumberResource&&!Mn){const St=parseInt(pt.currentValue+"");pt.currentValue=parseInt(gt),Qt=(parseInt(gt)-St).toString()}else{const St=null==pt.value?0:parseInt(pt.value+"");pt.value=parseInt(gt),Qt=(parseInt(gt)-St).toString()}else Qt="0";else pt.value=pt.isCheckProperty?""==gt||0==parseInt(gt)||"off"===ke.toHalfWidth(gt).toLowerCase()||"\u2610"===ke.toHalfWidth(gt).toLowerCase()?"":pt.name:pt.isNote||pt.isUrl?ke.cr(gt):ke.cr(gt).replace(/(:?\r\n|\r|\n)/g," ");else if(pt.isNumberResource&&!Mn)if(null!=gt&&""!=gt.toString()){const St=parseInt(pt.currentValue+""),yn=parseInt(pt.currentValue&&"="!==rt?pt.currentValue.toString():"0")+parseInt(gt)*("-"===rt?-1:1);yn<=parseInt(pt.currentValue+"")?pt.currentValue=yn:yn>parseInt(pt.value+"")&&parseInt(pt.currentValue+"")<parseInt(pt.value+"")&&0!=parseInt(pt.value+"")?pt.currentValue=pt.value:(yn<=parseInt(pt.value+"")||0==parseInt(pt.value+""))&&(pt.currentValue=yn),Qt=(parseInt(pt.currentValue+"")-St).toString()}else Qt="0";else if(ln){const St=null==pt.currentValue?0:parseInt(pt.value.toString());null!=gt&&""!=gt.toString()&&(pt.value=parseInt(pt.value&&"="!==rt?pt.value+"":"0")+parseInt(gt)*("-"===rt?-1:1)),Qt=(parseInt(pt.value+"")-St).toString()}else if(pt.isCheckProperty)switch(rt){case"=":pt.value=""===gt||0===parseInt(gt)||"off"===ke.toHalfWidth(gt).toLowerCase()||"\u2610"===ke.toHalfWidth(gt).toLowerCase()?"":pt.name;break;case"+":pt.value=pt.name;break;case"-":pt.value=""}else{if("="!==rt)throw`\u2192 ${""===pt.name?"(\u7121\u540d\u306e\u5909\u6570)":pt.name} \u3092\u64cd\u4f5c \u2192 \u30b3\u30de\u30f3\u30c9\u30a8\u30e9\u30fc\uff1a`+Be.operator+Be.value;pt.value=pt.isNote||pt.isUrl?isNaN(gt)||""===gt||pt.isUrl?ke.cr(gt):parseInt(gt):isNaN(gt)||""===gt?ke.cr(gt).replace(/(:?\r\n|\r|\n)/g," "):parseInt(gt)}const Wt=pt.loggingValue;let Gt=`\u2192 ${""===pt.name?"(\u7121\u540d\u306e\u5909\u6570)":pt.name} \u3092\u64cd\u4f5c`;Gt+=ln?` ${xt} \u2192 ${xt===Wt?"\u5909\u66f4\u306a\u3057":Wt}`:pt.isCheckProperty?`${xt===Wt?" \u5909\u66f4\u306a\u3057":Wt}`:` "${xt}" \u2192 ${xt===Wt?"\u5909\u66f4\u306a\u3057":'"'+Wt+'"'}`,Ee&&(Gt+=Ee.isDiceRollTable?` (${Ee.tableName}\uff1a${Ee.isEmptyDice?"":"\u{1f3b2}"}${Ee.result.split(/\s\uff1e\s/)[0]})`:` (${Ee.result.split(/\s\uff1e\s/g).map((St,yn)=>0==yn?Ee.isEmptyDice?"\u8a08\u7b97\u7d50\u679c":"\u{1f3b2}"+o+"\uff1a"+St.replace(/^c?\(/i,"").replace(/\)$/,""):St).join(" \u2192 ")})`,Ee.isEmptyDice||(ye=!0)),ge.push(Gt),W.push(Qt??"")}catch(Be){if(Be instanceof Error)throw Be;ge.push(Be),W.push("");continue}}ge.length&&e.chatMessageService.sendOperationLog(ge.join("\n")),ye&&(Math.random()<.5?tt.play(Te.diceRoll1):tt.play(Te.diceRoll2))}}else e.chatMessageService.sendOperationLog("\u30b3\u30de\u30f3\u30c9\u30a8\u30e9\u30fc\uff1a\u5bfe\u8c61\u304c\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3067\u306f\u306a\u3044");if(r&&(i=r.chatPalette.evaluate(i,r.rootDataElement,W),(ke.cr(i).trim()||f)&&r.standList)){let $=null;$=u&&r.faceIcon?r.faceIcon.identifier:r.imageFile?r.imageFile.identifier:null;const ge=r.standList.matchStandInfo(i,$,f);if(b&&C)if(ge.farewell)e.farewellStand(r);else if(ge.standElementIdentifier){U=ge.standElementIdentifier;const ye={characterIdentifier:r.identifier,standIdentifier:ge.standElementIdentifier,color:r.chatPalette?r.chatPalette.color:Fe.CHAT_DEFAULT_COLOR,secret:!!a};if(ye.secret){const lt=bt.instance.get(a);lt&&(lt.peerId!=Fe.myCursor.peerId&&ne.call("POPUP_STAND_IMAGE",ye,lt.peerId),ne.call("POPUP_STAND_IMAGE",ye,Fe.myCursor.peerId))}else ne.call("POPUP_STAND_IMAGE",ye)}M=ge.matchMostLongText}const K=tc.instance.matchCutInInfo(i);if(C&&K){for(const $ of K.identifiers){const ge={identifier:$,secret:!!a,sender:Fe.myCursor.peerId};if(ge.secret){const ye=bt.instance.get(a);ye&&(ye.peerId!=Fe.myCursor.peerId&&ne.call("PLAY_CUT_IN",ge,ye.peerId),ne.call("PLAY_CUT_IN",ge,Fe.myCursor.peerId))}else ne.call("PLAY_CUT_IN",ge)}if(K.names&&K.names.length&&!a){const $=new Map;for(const ye of K.names){let lt=$.get(ye)||0;lt+=1,$.set(""==ye?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":ye,lt)}const ge=`${[...$.keys()].map(ye=>$.get(ye)>1?`${ye}\xd7${$.get(ye)}`:ye).join("\u3001")}`;e.chatMessageService.sendOperationLog(ge+" \u304c\u8d77\u52d5\u3057\u305f")}}if(M.length<K.matchMostLongText.length&&(M=K.matchMostLongText),i=i.slice(0,i.length-M.length),C&&r&&ke.cr(i).trim()){const $=/^(([s\uff33\uff53][r\uff32\uff52][e\uff25\uff45][p\uff30\uff50][e\uff25\uff45][a\uff21\uff41][t\uff34\uff54]|[r\uff32\uff52][e\uff25\uff45][p\uff30\uff50][e\uff25\uff45][a\uff21\uff41][t\uff34\uff54]|[s\uff33\uff53][r\uff32\uff52][e\uff25\uff45][p\uff30\uff50]|[r\uff32\uff52][e\uff25\uff45][p\uff30\uff50]|[s\uff33\uff53][x\uff38\uff58]|[x\uff38\uff58])?([\d\uff10-\uff19]+)?[ \u3000]+)?([\s\S]*)?/gim.exec(i);let ye,ge=null!=$[4]?$[4].trim():i.trim();/^([s\uff33\uff53]?[c\uff23\uff43][h\uff28\uff48][o\uff2f\uff4f][i\uff29\uff49][c\uff23\uff43][e\uff25\uff45][\d\uff10-\uff19]*)[ \u3000]+([^ \u3000]*)/gi.test(ge)?ge="":((ye=/^([s\uff33\uff53]?[c\uff23\uff43][h\uff28\uff48][o\uff2f\uff4f][i\uff29\uff49][c\uff23\uff43][e\uff25\uff45][\d\uff10-\uff19]*[\[\uff3b][^\]\uff3d]+[\]\uff3d])/gi.exec(ge))||(ye=/^([s\uff33\uff53]?[c\uff23\uff43][h\uff28\uff48][o\uff2f\uff4f][i\uff29\uff49][c\uff23\uff43][e\uff25\uff45][\d\uff10-\uff19]*[\(\uff08][^\)\uff09]+[\)\uff09])/gi.exec(ge)))&&(ge=ge.slice(ye[1].length));let Ee,Be=[];if(null!==(Ee=/\u300c+([\s\S]+?)\u300d/gm.exec(ge))&&Be.push(Ee[1]),0===Be.length){const ft=ge.split(/[\s\u3000]/).slice(-1)[0];ke.isEmote(ft)&&Be.push(ft)}if(Be.length>0){const ft={characterIdentifier:r.identifier,text:Be.join("\n\n"),faceIconIdentifier:u&&r.faceIcon?r.faceIcon.identifier:null,color:c,secret:!!a};if(ft.secret){const rt=bt.instance.get(a);rt&&(rt.peerId!=Fe.myCursor.peerId&&ne.call("POPUP_CHAT_BALLOON",ft,rt.peerId),ne.call("POPUP_CHAT_BALLOON",ft,Fe.myCursor.peerId))}else ne.call("POPUP_CHAT_BALLOON",ft)}else ke.cr(i).trim()&&r.text&&ne.call("FAREWELL_CHAT_BALLOON",{characterIdentifier:r.identifier})}Fe.isGMHold&&!a&&!Fe.myCursor.isGMMode&&/GM(?:\u30e2\u30fc\u30c9)?\u306b\u306a(?:\u308a\u307e\u3059|\u308b)/i.test(ke.toHalfWidth(i))&&(Fe.myCursor.isGMMode=!0,e.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u306b\u306a\u3063\u305f"),ne.trigger("CHANGE_GM_MODE",null)),ke.cr(i).trim()&&e.chat.emit({text:i,gameType:o,sendFrom:s,sendTo:a,color:c,isInverse:!!r&&r.isInverse,isHollow:!!r&&r.isHollow,isBlackPaint:!!r&&r.isBlackPaint,aura:r?r.aura:-1,isUseFaceIcon:u,characterIdentifier:r?r.identifier:null,standIdentifier:U,standName:f,isUseStandImage:b&&C})})()}calcFitHeight(){let n=this.textAreaElementRef.nativeElement;n.style.height="",n.scrollHeight>=n.offsetHeight&&(n.style.height=n.scrollHeight+"px")}loadDiceBot(n){console.log("onChangeGameType ready"),Zi.getHelpMessage(n).then(e=>{console.log("onChangeGameType done\n"+e)})}showDicebotHelp(){Zi.getHelpMessage(this.gameType).then(n=>{this.gameHelp=n;let e="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8";for(let s of Zi.diceBotInfos)s.id===this.gameType&&(e="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3008"+s.game+"\u3009");e+="\u4f7f\u7528\u6cd5";let i=this.pointerDeviceService.pointers[0],o=this.panelService.open(kf,{left:i.x,top:i.y,width:600,height:500});o.title=e,o.text=this.gameHelp})}onContextMenu(n){if(n.stopPropagation(),n.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let e=this.pointerDeviceService.pointers[0];if(!this.character)return void this.contextMenuService.open(e,[{name:"\u63a5\u7d9a\u60c5\u5831...",action:()=>{this.panelService.open(IS,{width:520,height:600,top:e.y-100,left:e.x-100})}}],Fe.myCursor.name,null,Fe.myCursor.color,!0);let i=[{name:"\u300c\u300d\u3092\u5165\u529b",action:()=>{let r=this.textAreaElementRef.nativeElement,o=this.text.trim();"\u300c"!=o.slice(0,1)&&(o="\u300c"+o),"\u300d"!=o.slice(-1)&&(o+="\u300d"),this.text=o,r.value=this.text,r.selectionStart=this.text.length-1,r.selectionEnd=this.text.length-1,r.focus()}}];this.character&&(this.isUseFaceIcon&&this.character.faceIcon?(i.push(Zt),i.push({name:"\u9854\u30a2\u30a4\u30b3\u30f3\u306e\u5207\u308a\u66ff\u3048",action:null,subActions:this.character.faceIcons.map((r,o)=>({name:this.character.currntIconIndex==o?"\u25c9":"\u25cb",action:()=>{this.character.currntIconIndex!=o&&(this.character.currntIconIndex=o)},default:this.character.currntIconIndex==o,icon:r,checkBox:"radio"})),disabled:this.character.faceIcons.length<=1})):(this.character.imageFiles.length>1&&(i.push(Zt),i.push({name:"\u753b\u50cf\u5207\u308a\u66ff\u3048",action:null,subActions:this.character.imageFiles.map((r,o)=>({name:this.character.currntImageIndex==o?"\u25c9":"\u25cb",action:()=>{this.character.currntImageIndex=o,tt.play(Te.surprise),ne.trigger("UPDATE_INVENTORY",null)},default:this.character.currntImageIndex==o,icon:r,checkBox:"radio"}))})),i.push(Zt),i.push({name:"\u753b\u50cf\u52b9\u679c",action:null,subActions:[this.character.isInverse?{name:"\u2611 \u53cd\u8ee2",action:()=>{this.character.isInverse=!1,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u53cd\u8ee2",action:()=>{this.character.isInverse=!0,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},this.character.isHollow?{name:"\u2611 \u307c\u304b\u3057",action:()=>{this.character.isHollow=!1,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u307c\u304b\u3057",action:()=>{this.character.isHollow=!0,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},this.character.isBlackPaint?{name:"\u2611 \u9ed2\u5857\u308a",action:()=>{this.character.isBlackPaint=!1,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u9ed2\u5857\u308a",action:()=>{this.character.isBlackPaint=!0,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},{name:"\u30aa\u30fc\u30e9",action:null,subActions:[{name:(-1==this.character.aura?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{this.character.aura=-1,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"radio"},Zt].concat(["\u30d6\u30e9\u30c3\u30af","\u30d6\u30eb\u30fc","\u30b0\u30ea\u30fc\u30f3","\u30b7\u30a2\u30f3","\u30ec\u30c3\u30c9","\u30de\u30bc\u30f3\u30bf","\u30a4\u30a8\u30ed\u30fc","\u30db\u30ef\u30a4\u30c8"].map((r,o)=>({name:`${this.character.aura==o?"\u25c9":"\u25cb"} ${r}`,action:()=>{this.character.aura=o,ne.trigger("UPDATE_INVENTORY",null)},colorSample:!0,checkBox:"radio"})))},Zt,{name:"\u30ea\u30bb\u30c3\u30c8",action:()=>{this.character.isInverse=!1,this.character.isHollow=!1,this.character.isBlackPaint=!1,this.character.aura=-1,ne.trigger("UPDATE_INVENTORY",null)},disabled:!this.character.isInverse&&!this.character.isHollow&&!this.character.isBlackPaint&&-1==this.character.aura}]})),i.push(Zt),i.push({name:"\u8a73\u7d30\u3092\u8868\u793a...",action:()=>{this.showDetail(this.character)}}),this.onlyCharacters||i.push({name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a...",action:()=>{this.showChatPalette(this.character)}}),i.push({name:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a...",action:()=>{this.showStandSetting(this.character)}})),this.contextMenuService.open(e,i,this.character.name)}farewellStand(n=null){if(n||(n=this.character),this.character){const e={characterIdentifier:this.character.identifier};if(this.sendTo){const i=bt.instance.get(this.sendTo);i&&(i.peerId!=Fe.myCursor.peerId&&ne.call("FAREWELL_STAND_IMAGE",e,i.peerId),ne.call("FAREWELL_STAND_IMAGE",e,Fe.myCursor.peerId))}else ne.call("FAREWELL_STAND_IMAGE",e)}}showDetail(n){let e=this.pointerDeviceService.pointers[0],i="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";n.name.length&&(i+=" - "+n.name),this.panelService.open(kl,{title:i,left:e.x-400,top:e.y-300,width:800,height:600}).tabletopObject=n}showChatPalette(n){let e=this.pointerDeviceService.pointers[0];this.panelService.open(Qg,{left:e.x-250,top:e.y-175,width:620,height:350}).character=n}showStandSetting(n){let e=this.pointerDeviceService.pointers[0];this.panelService.open(pb,{left:e.x-400,top:e.y-175,width:730,height:572}).character=n}allowsChat(n){switch(n.location.name){case"table":case this.myPeer.peerId:return!0;case"graveyard":return!1;default:for(const e of jt.peers)if(e.isOpen&&n.location.name===e.peerId)return!1;return!0}}static#n=this.\u0275fac=function(e){return new(e||la)(Y(Pn),Y(vo),Y(kC),Y(yi),Y(lr),Y(Bo))};static#i=this.\u0275cmp=In({type:la,selectors:[["chat-input"]],viewQuery:function(e,i){if(1&e&&Ln(Eae,7),2&e){let r;Bn(r=Un())&&(i.textAreaElementRef=r.first)}},inputs:{onlyCharacters:"onlyCharacters",chatTabidentifier:"chatTabidentifier",_gameType:[Ce.None,"gameType","_gameType"],_sendFrom:[Ce.None,"sendFrom","_sendFrom"],_sendTo:[Ce.None,"sendTo","_sendTo"],_text:[Ce.None,"text","_text"],_filterText:[Ce.None,"filterText","_filterText"]},outputs:{gameTypeChange:"gameTypeChange",sendFromChange:"sendFromChange",sendToChange:"sendToChange",textChange:"textChange",filterTextChange:"filterTextChange",moveToPalette:"moveToPalette",chat:"chat"},decls:35,vars:34,consts:[["isCharacter",""],["textArea",""],["noFaceIcon",""],["select",""],[1,"table",3,"ngClass"],[1,"table-cell","imagebox",2,"cursor","context-menu","padding-left","4px","padding-right","2px",3,"contextmenu"],["class","imagebox",4,"ngIf","ngIfElse"],[1,"table-cell"],[2,"margin-right","3px"],["type","checkbox",3,"ngModel","checked","ngModelChange","change",4,"ngIf"],["style","font-size: smaller;",4,"ngIf"],[3,"ngModelChange","change","ngModel","ngStyle"],["style","font-weight: bolder;",3,"value","color",4,"ngIf"],["style","font-weight: normal;",3,"color","value",4,"ngFor","ngForOf"],[2,"white-space","nowrap"],[2,"max-width","9.5em",3,"ngModelChange","ngModel","ngClass","ngStyle"],["value","",1,"not-specified"],["style","font-weight: bolder;",3,"value","color",4,"ngFor","ngForOf"],["style","width: 12em;",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange",4,"ngIf"],["style","width: 12em;","disabled","",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange",4,"ngIf"],[2,"cursor","help",3,"click"],["style","font-size: smaller",3,"ngClass",4,"ngIf"],["type","color","style","width:1em; margin-left: 3px",3,"ngModel","ngModelOptions","ngModelChange",4,"ngIf"],[1,"chat-input",3,"ngModelChange","input","keydown.enter","focus","blur","keydown.control.arrowup","keydown.control.arrowdown","keydown.arrowdown","placeholder","ngModel","ngModelOptions"],["type","submit",3,"click"],[1,"writing-info"],[4,"ngIf"],[1,"imagebox"],["class","image face-icon",3,"src",4,"ngIf"],[1,"image","face-icon",3,"src"],["class","inverser",3,"ngClass",4,"ngIf"],[1,"inverser",3,"ngClass"],[1,"aura","imagebox",3,"ngClass"],[1,"image",3,"src","ngClass"],["type","checkbox",3,"ngModelChange","change","ngModel","checked"],[2,"font-size","smaller"],[2,"font-weight","bolder",3,"value"],[2,"font-weight","normal",3,"value"],[2,"width","12em",3,"change","ngModelChange","ngModel","ngModelOptions","ngClass"],["value","DiceBot",1,"not-specified"],["class","dice-bot-group",3,"label",4,"ngFor","ngForOf"],[1,"dice-bot-group",3,"label"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["disabled","",2,"width","12em",3,"change","ngModelChange","ngModel","ngModelOptions","ngClass"],[2,"font-size","smaller",3,"ngClass"],[2,"margin-right","2px"],[2,"width","8em","margin-right","6px",3,"change","ngModelChange","ngModel","ngModelOptions","ngClass"],[2,"white-space","nowrap","margin-left","1em","display","inline-block"],["type","range","min","0","max","100",2,"width","186px",3,"change","ngModelChange","ngModel"],["type","number","min","0","max","100",2,"width","3em","text-align","right","margin-right","3px",3,"change","ngModelChange","ngModel"],["type","button",2,"margin-left","1.3em","font-size","smaller",3,"click"],["type","color",2,"width","1em","margin-left","3px",3,"ngModelChange","ngModel","ngModelOptions"],["style","display: inline; white-space: pre",4,"ngFor","ngForOf"],[2,"display","inline","white-space","pre"],["class","cover mini-icon",3,"background-image",4,"ngIf"],[2,"display","inline"],[1,"peer-name",2,"font-weight","bold"],["style","user-select: none",4,"ngIf"],[1,"cover","mini-icon"],[2,"user-select","none"]],template:function(e,i){if(1&e){const r=Le();p(0,"div",4)(1,"div",5),he("contextmenu",function(s){return V(r),H(i.onContextMenu(s))}),q(2,Oae,2,1,"div",6)(3,Nae,3,2,"ng-template",null,0,Ai),g(),p(5,"div",7)(6,"div")(7,"label",8),q(8,Rae,1,2,"input",9)(9,Lae,2,0,"b",10),g(),p(10,"select",11),at("ngModelChange",function(s){return V(r),it(i.sendFrom,s)||(i.sendFrom=s),H(s)}),he("change",function(){return V(r),H(i.standName="")}),q(11,Bae,2,4,"option",12)(12,Uae,2,4,"option",13),g(),p(13,"span",14),y(14," \u27a1 "),p(15,"select",15),at("ngModelChange",function(s){return V(r),it(i.sendTo,s)||(i.sendTo=s),H(s)}),p(16,"option",16),y(17,"\u5168\u54e1"),g(),q(18,Hae,3,5,"option",17),g()(),p(19,"span",14),q(20,Gae,5,7,"select",18)(21,Wae,4,6,"select",19),p(22,"button",20),he("click",function(){return V(r),H(i.showDicebotHelp())}),y(23,"?"),g()()(),q(24,Yae,18,19,"div",21),p(25,"div")(26,"form"),q(27,Zae,1,3,"input",22),p(28,"textarea",23,1),at("ngModelChange",function(s){return V(r),it(i.text,s)||(i.text=s),H(s)}),he("input",function(){return V(r),H(i.onInput())})("keydown.enter",function(s){return V(r),H(i.sendChat(s))})("focus",function(){return V(r),H(i.isFilterTextUpdate=!0)})("blur",function(){return V(r),H(i.isFilterTextUpdate=!1)})("keydown.control.arrowup",function(s){return V(r),H(i.moveHistory(s,1))})("keydown.control.arrowdown",function(s){return V(r),H(i.moveHistory(s,-1))})("keydown.arrowdown",function(s){return V(r),H(i.moveTo(s))}),g(),p(30,"button",24),he("click",function(){return V(r),H(i.sendChat(null))}),p(31,"b"),y(32,"SEND"),g()()()(),p(33,"div",25),q(34,Qae,3,1,"ng-container",26),g()()()}if(2&e){const r=pn(4);m("ngClass",Ke(23,Iae,i.isDirect)),h(2),m("ngIf",!i.character)("ngIfElse",r),h(6),m("ngIf",i.character),h(),m("ngIf",i.character),h(),je("max-width",i.character?"9.5em":"13em"),st("ngModel",i.sendFrom),m("ngStyle",Tn(25,L5,i.color,i.sendFrom!=(null==i.myPeer?null:i.myPeer.identifier)?"normal":"bolder")),h(),m("ngIf",!i.onlyCharacters),h(),m("ngForOf",i.gameCharacters),h(3),st("ngModel",i.sendTo),m("ngClass",Ke(28,VC,""==i.sendTo))("ngStyle",Tn(30,L5,""==i.sendTo?null:i.sendToColor,""==i.sendTo?"normal":"bolder")),h(3),m("ngForOf",i.otherPeers),h(2),m("ngIf",i.diceBotInfosIndexed.length>0),h(),m("ngIf",i.diceBotInfosIndexed.length<1),h(3),m("ngIf",i.hasStand),h(3),m("ngIf",i.onlyCharacters),h(),m("placeholder",i.onlyCharacters?"Ctrl+\u21c5:\u5c65\u6b74 \u23ce:\u9001\u4fe1 Shift+\u23ce:\u6539\u884c\u3000\u767d(255,255,255):\u3042\u306a\u305f\u306e\u8272":"Ctrl+\u21c5:\u5c65\u6b74 \u23ce:\u9001\u4fe1 Shift+\u23ce:\u6539\u884c\u3000\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u8272\u3092\u512a\u5148"),st("ngModel",i.text),m("ngModelOptions",wu(33,Eb)),h(6),m("ngIf",0<i.writingPeerNameAndColors.length)}},dependencies:[Ni,nr,ri,Lo,ff,na,ia,kr,yl,Cl,Ea,Ia,Or,hf,ku,Du,Cr,Mu,cr],styles:['[_nghost-%COMP%]{display:block}.table[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px;display:table;width:100%}.table[_ngcontent-%COMP%]   .table-cell[_ngcontent-%COMP%]{display:table-cell}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:50px;height:50px;max-width:50px;max-height:50px;vertical-align:top;text-align:center}.image[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.image.face-icon[_ngcontent-%COMP%]{border-radius:.5rem}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out;pointer-events:none}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #00f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 6px #ccc) drop-shadow(0 -4px 4px #fff)}.chat-input[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,"M+ 1p",sans-serif;line-height:1.3;font-size:13px;width:calc(100% - 100px);height:calc(1em + 4px);min-height:calc(1em + 7px);max-height:calc(6em + 7px);overflow-y:auto;padding:1px;margin:5px;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;vertical-align:bottom}.writing-info[_ngcontent-%COMP%]{font-size:8px;height:1.3em;margin-bottom:1px}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.not-specified[_ngcontent-%COMP%]{color:gray}.dice-bot-group[_ngcontent-%COMP%]{color:#f5f5f5;background-color:#555}option[_ngcontent-%COMP%]{color:#000;background-color:#fff}.disabled-stand[_ngcontent-%COMP%]{color:gray}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}.direct-message[_ngcontent-%COMP%]   .writing-info[_ngcontent-%COMP%]{color:#eee}.mini-icon[_ngcontent-%COMP%]{display:inline-block;padding:0;width:.9rem;height:.9rem;vertical-align:middle;border-radius:.2rem;margin-right:1px;object-fit:cover}.direct-message[_ngcontent-%COMP%]   .mini-icon[_ngcontent-%COMP%]{filter:drop-shadow(1px 1px 1px #ffffff) drop-shadow(-1px -1px 1px #ffffff)}.direct-message[_ngcontent-%COMP%]   .peer-name[_ngcontent-%COMP%]{text-shadow:1px 0px 1px #ffffff,0px 1px 1px #ffffff,-1px 0px 1px #ffffff,0px -1px 1px #ffffff}']})}const Jae=["edit"],ele=(t,n)=>({compact:t,editing:n}),tle=(t,n,e,i,r,o)=>({"is-mine":t,"is-others":n,"direct-message":e,"system-message":i,"dicebot-message":r,"operation-log":o}),nle=(t,n,e,i)=>({"is-success":t,"is-failure":n,"is-critical":e,"is-fumble":i}),ile=(t,n)=>({inverse:t,hollow:n}),rle=(t,n,e,i,r,o,s,a)=>({black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}),ole=(t,n)=>({"black-paint":t,"face-icon":n}),DS=t=>({grow:t});function sle(t,n){1&t&&ii(0)}function ale(t,n){if(1&t&&(Ue(0),q(1,sle,1,0,"ng-container",12),ze()),2&t){v();const e=pn(11);h(),m("ngTemplateOutlet",e)}}function lle(t,n){1&t&&ii(0)}function cle(t,n){if(1&t&&(Ue(0),q(1,lle,1,0,"ng-container",12),ze()),2&t){v();const e=pn(13);h(),m("ngTemplateOutlet",e)}}function ule(t,n){1&t&&ii(0)}function dle(t,n){1&t&&ii(0)}function hle(t,n){if(1&t&&(p(0,"div"),q(1,dle,1,0,"ng-container",12),g()),2&t){v();const e=pn(19);h(),m("ngTemplateOutlet",e)}}function fle(t,n){1&t&&ii(0)}function ple(t,n){if(1&t&&(Ue(0),q(1,fle,1,0,"ng-container",12),ze()),2&t){v();const e=pn(13);h(),m("ngTemplateOutlet",e)}}function gle(t,n){1&t&&ii(0)}function mle(t,n){if(1&t&&(Ue(0),q(1,gle,1,0,"ng-container",12),ze()),2&t){v();const e=pn(11);h(),m("ngTemplateOutlet",e)}}function _le(t,n){if(1&t&&(Ge(0,"img",16),Ut(1,"safe")),2&t){const e=v(2);m("src",zt(1,2,null==e.imageFile?null:e.imageFile.url,"resourceUrl"),bn)("ngClass",Tn(5,ole,1==e.chatMessage.isBlackPaint,e.chatMessage.isFaceIcon))}}function ble(t,n){if(1&t&&(p(0,"div",13)(1,"span",14),q(2,_le,2,8,"img",15),g()()),2&t){const e=v();m("ngClass",Tn(3,ile,1==e.chatMessage.isInverseIcon,1==e.chatMessage.isHollowIcon)),h(),m("ngClass",Yl(6,rle,0==e.chatMessage.aura,1==e.chatMessage.aura,2==e.chatMessage.aura,3==e.chatMessage.aura,4==e.chatMessage.aura,5==e.chatMessage.aura,6==e.chatMessage.aura,7==e.chatMessage.aura)),h(),m("ngIf",0<(null==e.imageFile||null==e.imageFile.url?null:e.imageFile.url.length))}}function vle(t,n){if(1&t&&(Ue(0),p(1,"span",20),y(2),Ut(3,"date"),g(),ze()),2&t){const e=v(2);h(2),Xe(zt(3,1,e.chatMessage.timestamp,"H:mm"))}}function yle(t,n){if(1&t&&(Ge(0,"img",23),Ut(1,"safe")),2&t){const e=v(3);m("src",zt(1,1,null==e.toImageFile?null:e.toImageFile.url,"resourceUrl"),bn)}}function Cle(t,n){1&t&&(Ue(0),y(1,"\uff08\u3042\u306a\u305f\uff09"),ze())}function xle(t,n){if(1&t&&(Ue(0),q(1,yle,2,4,"img",21),p(2,"span",19),y(3),q(4,Cle,2,0,"ng-container",8),g(),p(5,"span",22),y(6,"\u27a1"),g(),ze()),2&t){const e=v(2);h(),m("ngIf",0<(null==e.toImageFile||null==e.toImageFile.url?null:e.toImageFile.url.length)),h(),je("color",e.chatMessage.toColor&&"#ffffff"!=e.chatMessage.toColor?e.chatMessage.toColor:""),m("ngClass",Ke(6,DS,e.chatMessage.isDirect||e.chatMessage.isSecret)),h(),Xe(e.chatMessage.toName),h(),m("ngIf",e.chatMessage.isSendToMe)}}function wle(t,n){if(1&t&&(Ge(0,"img",23),Ut(1,"safe")),2&t){const e=v(3);m("src",zt(1,1,null==e.toImageFile?null:e.toImageFile.url,"resourceUrl"),bn)}}function Ele(t,n){1&t&&(Ue(0),y(1,"\uff08\u3042\u306a\u305f\uff09"),ze())}function Ile(t,n){if(1&t&&(Ue(0),p(1,"span",24),y(2,"\u27a1"),g(),q(3,wle,2,4,"img",21),p(4,"span",19),y(5),q(6,Ele,2,0,"ng-container",8),g(),ze()),2&t){const e=v(2);h(3),m("ngIf",0<(null==e.toImageFile||null==e.toImageFile.url?null:e.toImageFile.url.length)),h(),je("color",e.chatMessage.toColor&&"#ffffff"!=e.chatMessage.toColor?e.chatMessage.toColor:""),m("ngClass",Ke(6,DS,e.chatMessage.isDirect||e.chatMessage.isSecret)),h(),Xe(e.chatMessage.toName),h(),m("ngIf",e.chatMessage.isSendToMe)}}function Tle(t,n){if(1&t){const e=Le();p(0,"span",28),Ut(1,"safe"),he("click",function(r){return V(e),H(v(3).onLinkClick(r))}),g()}2&t&&m("innerHTML",zt(1,1,v(3).htmlEscapedFrom,"html"),$r)}function Sle(t,n){if(1&t&&(p(0,"span",20),y(1),Ut(2,"date"),g()),2&t){const e=v(3);h(),Xe(zt(2,1,e.chatMessage.timestamp,"y/M/d H:mm"))}}function Mle(t,n){if(1&t&&(p(0,"span",20),y(1),Ut(2,"date"),g()),2&t){const e=v(3);h(),Xe(zt(2,1,e.chatMessage.timestamp,"H:mm"))}}function Dle(t,n){1&t&&ii(0)}function kle(t,n){if(1&t&&(Ue(0),q(1,Tle,2,4,"span",25)(2,Sle,3,4,"span",26)(3,Mle,3,4,"span",26)(4,Dle,1,0,"ng-container",27),ze()),2&t){const e=v(2),i=pn(19);h(),m("ngIf",!e.isCompact),h(),m("ngIf",!e.isCompact&&e.chatMessage.timestamp),h(),m("ngIf",e.isCompact&&e.chatMessage.timestamp),h(),m("ngIf",!(e.isEditable&&!e.isCompact))("ngIfElse",i)}}function Ole(t,n){if(1&t&&(p(0,"div",17),q(1,vle,4,4,"ng-container",8),p(2,"span",18),q(3,xle,7,8,"ng-container",8),p(4,"span",19),y(5),g(),q(6,Ile,7,8,"ng-container",8),g(),q(7,kle,5,5,"ng-container",8),g()),2&t){const e=v();h(),m("ngIf",e.isCompact&&!e.isMine&&e.chatMessage.timestamp),h(2),m("ngIf",!e.isMine&&e.chatMessage.toColor&&e.isGMMode),h(),je("color",e.chatMessage.color&&"#ffffff"!=e.chatMessage.color?e.chatMessage.color:""),m("ngClass",Ke(8,DS,e.chatMessage.isDirect||e.chatMessage.isSecret)),h(),Xe(e.chatMessage.name),h(),m("ngIf",e.isMine&&e.chatMessage.toColor),h(),m("ngIf",!e.isCompact||e.isMine)}}function Ale(t,n){if(1&t){const e=Le();p(0,"div",34)(1,"span",35),y(2),g(),p(3,"textarea",36,5),at("ngModelChange",function(r){V(e);const o=v(2);return it(o.editingText,r)||(o.editingText=r),H(r)}),he("keydown.enter",function(r){return V(e),H(v(2).editEnd(r))})("keydown.escape",function(){return V(e),H(v(2).editCancel())}),g()()}if(2&t){const e=v(2);h(2),Xe(e.lastNewLineAdjust(e.editingText)),h(),st("ngModel",e.editingText)}}function Ple(t,n){if(1&t&&(p(0,"span",37)(1,"b",38),y(2,"\u7de8\u96c6\u6e08"),g(),y(3),Ut(4,"date"),g()),2&t){const e=v(2);h(3),Si(" ",zt(4,1,e.chatMessage.lastUpdate,"M/d H:mm"),"")}}function Fle(t,n){if(1&t){const e=Le();p(0,"button",39),he("click",function(){return V(e),H(v(2).discloseMessage())}),y(1,"\u7d50\u679c\u3092\u516c\u958b"),g()}}function Nle(t,n){if(1&t){const e=Le();q(0,Ale,5,2,"div",29),p(1,"div")(2,"span",30)(3,"span",31),Ut(4,"safe"),he("click",function(r){return V(e),H(v().onLinkClick(r))}),g(),q(5,Ple,5,4,"span",32)(6,Fle,2,0,"button",33),g()()}if(2&t){const e=v();m("ngIf",e.isEditing),h(),je("display",e.isEditing?"none":"block"),h(2),je("color",!e.chatMessage.isSpecialColor&&e.chatMessage.color&&"#ffffff"!=e.chatMessage.color?e.chatMessage.color:""),m("innerHTML",zt(4,8,e.htmlEscapedText,"html"),$r),h(2),m("ngIf",!e.isEditing&&e.chatMessage.isEdited),h(),m("ngIf",e.chatMessage.isSecret)}}function Rle(t,n){1&t&&(p(0,"span")(1,"s"),y(2,"\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09"),g()())}function Lle(t,n){if(1&t){const e=Le();p(0,"button",45),he("click",function(){return V(e),H(v(2).editStart())}),p(1,"i",46),y(2,"edit"),g()()}}function Ble(t,n){1&t&&(p(0,"button",47)(1,"i",46),y(2,"clear"),g()())}function Ule(t,n){if(1&t){const e=Le();p(0,"button",48),he("click",function(){return V(e),H(v(2).editEnd())}),p(1,"i",46),y(2,"done"),g()()}2&t&&m("disabled",0==v(2).editingText.trim().length)}function zle(t,n){if(1&t){const e=Le();p(0,"button",49),he("click",function(){return V(e),H(v(2).editCancel())}),p(1,"i",46),y(2,"clear"),g()()}}function Hle(t,n){if(1&t&&(p(0,"span",40),q(1,Lle,3,0,"button",41)(2,Ble,3,0,"button",42)(3,Ule,3,1,"button",43)(4,zle,3,0,"button",44),g()),2&t){const e=v();h(),m("ngIf",!e.isEditing),h(),m("ngIf",!e.isEditing),h(),m("ngIf",e.isEditing),h(),m("ngIf",e.isEditing)}}let Vle=(()=>{class t{get isGMMode(){return this.chatMessage.isGMMode}constructor(e,i,r){this.chatMessageService=e,this.modalService=i,this.changeDetector=r,this.compact=!1,this.imageFile=vn.Empty,this.animeState="inactive",this.isEditing=!1,this.editingText="",this.stringUtil=ke}ngOnInit(){ne.register(this).on("MESSAGE_EDITING_START",-1e3,r=>{r.isSendFromSelf&&(!r.data||r.data.messageIdentifier!==this.chatMessage.identifier)&&this.editCancel()}).on("CHANGE_GM_MODE",r=>{this.changeDetector.markForCheck()});let e=this.chatMessage.image;e&&(this.imageFile=e),e=this.chatMessage.toImage,e&&(this.toImageFile=e),this.chatMessageService.getTime()-1e4<this.chatMessage.timestamp&&(this.animeState="active")}ngAfterViewInit(){this.chatMessage.isAnimated=!0}get isMine(){return this.chatMessage.isSendFromSelf}get isEditable(){return this.chatMessage.isEditable}get isCompact(){return this.compact||this.chatMessage.isOperationLog}get htmlEscapedFrom(){return this._htmlEscapeLinking(this.chatMessage.from,!0)}get htmlEscapedText(){let e=this._htmlEscapeLinking(this.chatMessage.text,!1,!this.chatMessage.isOperationLog);return this.chatMessage.isDicebot&&(e=Ki.decorationDiceResult(e)),e}_htmlEscapeLinking(e,i=!1,r=!1){return e=ke.escapeHtml(e),r&&(e=ke.rubyToHtml(e)),i4.link(this.lastNewLineAdjust(e),{urls:{schemeMatches:!0,wwwMatches:!0,tldMatches:!1},truncate:{length:48,location:"end"},decodePercentEncoding:i,stripPrefix:i,stripTrailingSlash:i,email:!1,phone:!1,replaceFn:function(o){if("url"==o.getType()&&ke.validUrl(o.getAnchorHref())){if(ke.sameOrigin(o.getAnchorHref()))return!0;{const s=o.buildTag();return s.setAttr("rel","noreferrer"),s.addClass("outer-link"),s}}return!1}})}discloseMessage(){this.chatMessage.tag=this.chatMessage.tag.replace("secret","")}editStart(){ne.trigger("MESSAGE_EDITING_START",{messageIdentifier:this.chatMessage.identifier}),this.editingText=this.chatMessage.text,this.isEditing=!0,setTimeout(()=>{this.editElm.nativeElement&&this.editElm.nativeElement.focus()})}editEnd(e=null){e&&e.preventDefault(),(!e||13===e.keyCode)&&(this.isEditable&&this.editingText.trim().length>0&&this.chatMessage.text!=this.editingText?(this.chatMessage.isSecret||(this.chatMessage.lastUpdate=Date.now()),this.chatMessage.text=this.editingText,this.isEditing=!1):this.editCancel())}editCancel(){this.isEditing=!1}lastNewLineAdjust(e){return null==e?"":!this.isEditing&&(this.chatMessage.isEdited||this.chatMessage.isSecret)||e.lastIndexOf("\n")!=e.length-1?e:e+"\n"}onLinkClick(e){if(e&&"A"==e.target.tagName){const i=e.target.getAttribute("href");if(!ke.sameOrigin(i))return e.preventDefault(),this.modalService.open(sa,{url:e.target.getAttribute("href")}),!1}return!0}static#e=this.\u0275fac=function(i){return new(i||t)(Y(vo),Y(Ei),Y(Zr))};static#t=this.\u0275cmp=In({type:t,selectors:[["chat-message"]],viewQuery:function(i,r){if(1&i&&Ln(Jae,5),2&i){let o;Bn(o=Un())&&(r.editElm=o.first)}},inputs:{chatMessage:"chatMessage",compact:"compact"},features:[br([{provide:bP,useValue:!1}])],decls:20,vars:36,consts:[["image",""],["title",""],["visible",""],["secret",""],["editor",""],["edit",""],[1,"container",3,"ngClass"],[1,"message",3,"ngClass"],[4,"ngIf"],[1,"body"],[1,"text","msg-text",3,"ngClass"],[4,"ngIf","ngIfThen","ngIfElse"],[4,"ngTemplateOutlet"],[1,"image",3,"ngClass"],[1,"aura",3,"ngClass"],["draggable","false",3,"src","ngClass",4,"ngIf"],["draggable","false",3,"src","ngClass"],[1,"title"],[1,"msg-name"],[3,"ngClass"],[1,"tip","msg-timestamp"],["draggable","false","class","mini-icon",3,"src",4,"ngIf"],[2,"display","inline-block","margin","0px 6px","user-select","none","transform","rotateY(180deg)"],["draggable","false",1,"mini-icon",3,"src"],[2,"display","inline-block","margin","0px 6px","user-select","none"],["class","tip msg-from",3,"innerHTML","click",4,"ngIf"],["class","tip msg-timestamp",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"tip","msg-from",3,"click","innerHTML"],["style","position: relative",4,"ngIf"],[2,"display","inline-block"],[3,"click","innerHTML"],["class","is-edited",4,"ngIf"],["style","padding-top: 1px; padding-bottom: 1px; margin-left: 3px;",3,"click",4,"ngIf"],[2,"position","relative"],["aria-hidden","true",2,"visibility","hidden","display","inline-block"],[2,"position","absolute","top","0px","left","0px","width","100%","height","100%",3,"ngModelChange","keydown.enter","keydown.escape","ngModel"],[1,"is-edited"],[2,"white-space","nowrap"],[2,"padding-top","1px","padding-bottom","1px","margin-left","3px",3,"click"],[1,"edit-buttons",2,"margin-left","4px","white-space","nowrap"],["class","edit-button","title","\u7de8\u96c6",3,"click",4,"ngIf"],["class","edit-button","aria-hidden","true","style","visibility: hidden",4,"ngIf"],["class","edit-button","title","\u78ba\u5b9a",3,"disabled","click",4,"ngIf"],["class","edit-button","title","\u30ad\u30e3\u30f3\u30bb\u30eb",3,"click",4,"ngIf"],["title","\u7de8\u96c6",1,"edit-button",3,"click"],[1,"material-icons","small-font"],["aria-hidden","true",1,"edit-button",2,"visibility","hidden"],["title","\u78ba\u5b9a",1,"edit-button",3,"click","disabled"],["title","\u30ad\u30e3\u30f3\u30bb\u30eb",1,"edit-button",3,"click"]],template:function(i,r){if(1&i&&(p(0,"div",6)(1,"div",7),q(2,ale,2,1,"ng-container",8),p(3,"div",9),q(4,cle,2,1,"ng-container",8),p(5,"div",10),q(6,ule,1,0,"ng-container",11),g(),q(7,hle,2,1,"div",8)(8,ple,2,1,"ng-container",8),g(),q(9,mle,2,1,"ng-container",8),g()(),q(10,ble,3,15,"ng-template",null,0,Ai)(12,Ole,8,10,"ng-template",null,1,Ai)(14,Nle,7,11,"ng-template",null,2,Ai)(16,Rle,3,0,"ng-template",null,3,Ai)(18,Hle,5,4,"ng-template",null,4,Ai)),2&i){const o=pn(15),s=pn(17);m("ngClass",Tn(21,ele,r.isCompact,r.isEditing)),h(),je("border-left-color",!r.chatMessage.isSystem||r.chatMessage.isDicebot||r.chatMessage.isCalculate?r.chatMessage.color:"#444444")("border-right-color",!r.chatMessage.isSystem||r.chatMessage.isDicebot||r.chatMessage.isCalculate?r.chatMessage.color:"#444444"),m("ngClass",y2(24,tle,r.isMine,!r.isMine,r.chatMessage.isDirect||r.chatMessage.isSecret,r.chatMessage.isSystem,r.chatMessage.isDicebot||r.chatMessage.isCalculate,r.chatMessage.isOperationLog))("@flyInOut",r.isMine?null:"active")("@flyInOutMe",r.isMine?"active":null),h(),m("ngIf",r.isMine&&!r.isCompact),h(),je("justify-content",r.isCompact&&!r.isMine?"flex-end":"flex-start"),h(),m("ngIf",!r.isCompact||r.isMine),h(),je("flex-grow",r.isCompact&&!r.isEditing?0:1),m("ngClass",Ja(31,nle,(!r.chatMessage.isSecret||r.chatMessage.isSendFromSelf)&&r.chatMessage.isSuccess,(!r.chatMessage.isSecret||r.chatMessage.isSendFromSelf)&&r.chatMessage.isFailure,(!r.chatMessage.isSecret||r.chatMessage.isSendFromSelf)&&r.chatMessage.isCritical,(!r.chatMessage.isSecret||r.chatMessage.isSendFromSelf)&&r.chatMessage.isFumble)),h(),m("ngIf",!r.chatMessage.isSecret||r.chatMessage.isSendFromSelf||r.isGMMode)("ngIfThen",o)("ngIfElse",s),h(),m("ngIf",r.isEditable&&r.isCompact),h(),m("ngIf",r.isCompact&&!r.isMine),h(),m("ngIf",!r.isMine&&!r.isCompact)}},dependencies:[Ni,ri,uf,kr,Or,Cr,EA,cr],styles:['[_nghost-%COMP%]{display:block}.container[_ngcontent-%COMP%]{width:100%;overflow-x:hidden;box-sizing:border-box}.message[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;box-sizing:border-box;padding:5px;width:100%;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;border-bottom:1px dotted #999}.is-mine.message[_ngcontent-%COMP%]{border-left:4px solid #555}.is-others.message[_ngcontent-%COMP%]{border-right:4px solid #555}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc;border-bottom:1px dotted #CCC}.is-mine.direct-message[_ngcontent-%COMP%]{border-left:4px solid #555}.is-others.direct-message[_ngcontent-%COMP%]{border-right:4px solid #555}.operation-log[_ngcontent-%COMP%]{color:#666;background-color:#cccc}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{padding:0;width:50px;height:50px;flex-shrink:0;vertical-align:top;pointer-events:none}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img.face-icon[_ngcontent-%COMP%]{border-radius:.5rem}.message[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{flex-grow:1}.message[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{vertical-align:top;font-size:14px;padding-left:12px;padding-right:12px}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.message[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{vertical-align:top;padding:2px 12px 0;font-size:14px}.message[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{font-size:8px;padding-left:12px}.msg-name[_ngcontent-%COMP%]{font-weight:700}.msg-text[_ngcontent-%COMP%]{white-space:pre-wrap}.dicebot-message[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%]{font-size:8px}.dicebot-message[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{color:#11f}.direct-message.dicebot-message[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{color:#ccf}.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-success[_ngcontent-%COMP%]{color:#17f}.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-failure[_ngcontent-%COMP%]{color:#f05}.direct-message.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-success[_ngcontent-%COMP%]{color:#adf}.direct-message.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-failure[_ngcontent-%COMP%]{color:#f66}.dicebot-message[_ngcontent-%COMP%]{border-left:4px transparent}.dicebot-message[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%], .dicebot-message[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%], .operation-log[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%], .operation-log[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{font-style:oblique}.is-others[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .is-others[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{text-align:right}.is-others[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-align:left;max-width:100%}.is-edited[_ngcontent-%COMP%]{margin-left:2px;font-size:8px;vertical-align:bottom}.is-edited[_ngcontent-%COMP%]:before{content:"("}.is-edited[_ngcontent-%COMP%]:after{content:")"}.edit-button[_ngcontent-%COMP%]{padding:0 6px;vertical-align:10%;margin:0 1px 0 0}.edit-buttons[_ngcontent-%COMP%]{visibility:hidden;display:none}.container[_ngcontent-%COMP%]:hover   .edit-buttons[_ngcontent-%COMP%], .editing[_ngcontent-%COMP%]   .edit-buttons[_ngcontent-%COMP%]{visibility:visible;display:inline-block}textarea[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,"M+ 1p",sans-serif;margin:-3px;font-size:14px;resize:none}.small-font[_ngcontent-%COMP%]{font-size:14px;vertical-align:bottom}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #00f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 6px #ccc) drop-shadow(0 -4px 4px #fff)}.msg-timestamp[_ngcontent-%COMP%]{white-space:nowrap}.container.compact[_ngcontent-%COMP%]{overflow:hidden}.container.compact.editing[_ngcontent-%COMP%]{padding-top:1px}.container.compact[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{padding:2px!important}.container.compact[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap}.container.compact[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{min-width:6em}.container.compact[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .container.compact[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .container.compact[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{padding:0 3px;text-align:left}.container.compact[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%]{flex-grow:0}.container.compact[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{flex-grow:1}.container.compact[_ngcontent-%COMP%]   .edit-buttons[_ngcontent-%COMP%]{display:none}.container.compact[_ngcontent-%COMP%]:hover   .edit-buttons[_ngcontent-%COMP%], .container.compact.editing[_ngcontent-%COMP%]   .edit-buttons[_ngcontent-%COMP%]{display:inline-block}.container.compact[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{margin:-3px}.grow[_ngcontent-%COMP%]{text-shadow:1px 0px 1px #ffffff,0px 1px 1px #ffffff,-1px 0px 1px #ffffff,0px -1px 1px #ffffff}.mini-icon[_ngcontent-%COMP%]{display:inline-block;padding:0;width:1rem;height:1rem;vertical-align:middle;border-radius:.2rem;object-fit:cover;margin-right:2px;filter:drop-shadow(1px 1px 1px #ffffff) drop-shadow(-1px -1px 1px #ffffff)}'],data:{animation:[Xn("flyInOut",[an("* => active",[rn("200ms ease-out",En([We({transform:"translateX(100px)",opacity:"0",offset:0}),We({transform:"translateX(0)",opacity:"1",offset:1})]))]),an("void => *",[rn("200ms ease-out",En([We({opacity:"0",offset:0}),We({opacity:"1",offset:1})]))])]),Xn("flyInOutMe",[an("* => active",[rn("200ms ease-out",En([We({transform:"translateX(-100px)",opacity:"0",offset:0}),We({transform:"translateX(0)",opacity:"1",offset:1})]))]),an("void => *",[rn("200ms ease-out",En([We({opacity:"0",offset:0}),We({opacity:"1",offset:1})]))])])]}})}return t})();const jle=["logContainer"],Gle=["messageContainer"];function Wle(t,n){if(1&t&&Ge(0,"chat-message",7),2&t){const e=v().$implicit,i=v(2);m("chatMessage",e)("compact",i.compact)("@.disabled",i.compact||e.isAnimated)}}function $le(t,n){if(1&t&&(Ue(0),q(1,Wle,1,3,"chat-message",6),ze()),2&t){const e=n.$implicit;h(),m("ngIf",e.isDisplayable)}}function Yle(t,n){if(1&t&&(Ue(0),q(1,$le,2,1,"ng-container",5),ze()),2&t){const e=v();h(),m("ngForOf",e.chatMessages)("ngForTrackBy",e.trackByChatMessage)}}function Zle(t,n){if(1&t&&Ge(0,"chat-message",7),2&t){const e=n.$implicit,i=v(2);m("chatMessage",e)("compact",i.compact)("@.disabled",i.compact||e.isAnimated)}}function qle(t,n){if(1&t&&(Ue(0),q(1,Zle,1,3,"chat-message",8),ze()),2&t){const e=v();h(),m("ngForOf",e.sampleMessages)}}const kS=window.navigator.userAgent.toLowerCase(),B5=kS.indexOf("iphone")>-1||kS.indexOf("ipad")>-1||kS.indexOf("macintosh")>-1&&"ontouchend"in document;let Xle=(()=>{class t{get minMessageHeight(){if(this.compact)return 26;let e=this.chatTab.chatMessages[this.chatTab.chatMessages.length-1];return e&&e.isOperationLog?26:61}get chatMessages(){if(!this.chatTab)return[];if(this.needUpdate){this.needUpdate=!1;let e=this.chatTab?this.chatTab.chatMessages:[];this.adjustIndex(),this._chatMessages=e.slice(this.topIndex,this.bottomIndex+1),this.topTimestamp=0<this._chatMessages.length?this._chatMessages[0].timestamp:0,this.botomTimestamp=0<this._chatMessages.length?this._chatMessages[this._chatMessages.length-1].timestamp:0}return this._chatMessages}get minScrollHeight(){return this.chatTab.chatMessages.reduce((e,i)=>e+(i.isDisplayable?this.compact||i.isOperationLog?26:61:0),0)}get topSpace(){return this.minScrollHeight-this.bottomSpace}get bottomSpace(){return 0<this.chatMessages.length?(this.chatTab.chatMessages.length-this.bottomIndex-1)*this.minMessageHeight:0}get isEmpty(){return this.chatTab.chatMessages.every(e=>!e.isDisplayable)}constructor(e,i,r){this.ngZone=e,this.changeDetector=i,this.panelService=r,this.compact=!1,this.sampleMessages=[this.makeSampleMessage("System",null,"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\uff1a\u306f\u3058\u3081\u306b",null,"\u30e6\u30c9\u30ca\u30ea\u30a6\u30e0\u306f\u30b5\u30fc\u30d0\u30fc\u3092\u4f7f\u7528\u3057\u306a\u3044TRPG\u30aa\u30f3\u30bb\u30c4\u30fc\u30eb\u3067\u3059\u3002\u53c2\u52a0\u8005\u540c\u58eb\u3067\u63a5\u7d9a\u3057\u3001\u30b3\u30de\u3084\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u306a\u3069\u3092\u540c\u671f\u3057\u307e\u3059\u3002"),this.makeSampleMessage("System",null,"\u30c6\u30fc\u30d6\u30eb\u3068\u30b3\u30de\u306e\u57fa\u672c\u64cd\u4f5c",null,"\uff1c\u30c6\u30fc\u30d6\u30eb\u306e\u64cd\u4f5c\uff1e\n\u30c6\u30fc\u30d6\u30eb\u3092\u5de6\u30c9\u30e9\u30c3\u30b0 : \u8996\u70b9\u5909\u66f4\n\u30c6\u30fc\u30d6\u30eb\u3092\u53f3\u30c9\u30e9\u30c3\u30b0 : \u8996\u70b9\u56de\u8ee2\n\u30c6\u30fc\u30d6\u30eb\u3092\u53f3\u30af\u30ea\u30c3\u30af : \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30e1\u30cb\u30e5\u30fc\u3092\u8868\u793a\n\n\uff1c\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u64cd\u4f5c\uff1e\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u30c9\u30e9\u30c3\u30b0\u64cd\u4f5c : \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u79fb\u52d5\u3084\u56de\u8ee2\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u53f3\u30af\u30ea\u30c3\u30af : \u500b\u5225\u306e\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30e1\u30cb\u30e5\u30fc\u3092\u8868\u793a\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u5de6\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af : \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u56fa\u6709\u306e\u52d5\u4f5c"),this.makeSampleMessage("System",null,"\u7bc4\u56f2\u9078\u629e",null,"<\u7528\u8a9e>\n\u7bc4\u56f2\u9078\u629e\u30e2\u30fc\u30c9 : \u9078\u629e\u9818\u57df\u306e\u5185\u5074\u306b\u898b\u3048\u3066\u3044\u308b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u9078\u629e\u72b6\u614b\u306b\u3059\u308b\n\u78c1\u77f3\u30e2\u30fc\u30c9 : \u540c\u3058\u7a2e\u985e\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u5dfb\u304d\u8fbc\u307f\u306a\u304c\u3089\u79fb\u52d5\u3055\u305b\u308b\n\n<\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u9078\u629e>\n\u30c6\u30fc\u30d6\u30eb\u3092\u30de\u30a6\u30b9\u5de6\u30dc\u30bf\u30f3\u9577\u62bc\u3057+\u30c9\u30e9\u30c3\u30b0\u64cd\u4f5c : \u9577\u62bc\u3057\u3067\u7bc4\u56f2\u9078\u629e\u30e2\u30fc\u30c9\u3092\u958b\u59cb\u3057\u3001\u30c9\u30e9\u30c3\u30b0\u3067\u7bc4\u56f2\u9818\u57df\u3092\u6307\u5b9a\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u5de6\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af\u9577\u62bc\u3057+\u30c9\u30e9\u30c3\u30b0\u64cd\u4f5c : \u9577\u62bc\u3057\u3067\u78c1\u77f3\u30e2\u30fc\u30c9\u3092\u958b\u59cb\u3057\u3001\u30c9\u30e9\u30c3\u30b0\u3067\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u79fb\u52d5\nShift+\u30de\u30a6\u30b9\u5de6\u30dc\u30bf\u30f3+\u30c9\u30e9\u30c3\u30b0\u64cd\u4f5c : \u5373\u6642\u306b\u7bc4\u56f2\u9078\u629e\u30e2\u30fc\u30c9\u3092\u958b\u59cb\u3057\u3001\u30c9\u30e9\u30c3\u30b0\u3067\u7bc4\u56f2\u9818\u57df\u3092\u6307\u5b9a\nCtrl+\u30de\u30a6\u30b9\u5de6\u30dc\u30bf\u30f3 : \u30af\u30ea\u30c3\u30af\u3057\u305f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u9078\u629e\u72b6\u614b\u3092\u5207\u308a\u66ff\u3048\u308b\nCtrl+\u30de\u30a6\u30b9\u5de6\u30dc\u30bf\u30f3+\u30c9\u30e9\u30c3\u30b0\u64cd\u4f5c : \u30de\u30a6\u30b9\u30ab\u30fc\u30bd\u30eb\u306e\u89e6\u308c\u305f\u5bfe\u8c61\u3092\u9078\u629e\u72b6\u614b\u306b\u3059\u308b\n\n<\u9078\u629e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u64cd\u4f5c>\n\u9078\u629e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u79fb\u52d5 : \u9078\u629e\u72b6\u614b\u306e\u5168\u3066\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u540c\u671f\u3057\u3066\u79fb\u52d5\n\u9078\u629e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u56de\u8ee2 : \u9078\u629e\u72b6\u614b\u306e\u540c\u3058\u7a2e\u985e\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u540c\u671f\u3057\u3066\u56de\u8ee2\n\n<\u9078\u629e\u89e3\u9664>\n\u4efb\u610f\u306e\u5834\u6240\u3092\u30af\u30ea\u30c3\u30af : \u5168\u3066\u306e\u9078\u629e\u72b6\u614b\u3092\u89e3\u9664"),this.makeSampleMessage("System",null,"\u753b\u50cf\u3068\u97f3\u697d",null,"\u30d5\u30a1\u30a4\u30eb\u3092\u30d6\u30e9\u30a6\u30b6\u753b\u9762\u306b\u30c9\u30e9\u30c3\u30b0&\u30c9\u30ed\u30c3\u30d7\u3059\u308b\u3053\u3068\u3067\u30e6\u30c9\u30ca\u30ea\u30a6\u30e0\u306b\u53d6\u308a\u8fbc\u3081\u307e\u3059\u3002"),this.makeSampleMessage("System",null,"\u30c7\u30fc\u30bf\u306e\u4fdd\u5b58",null,"\u5168\u3066\u306e\u30c7\u30fc\u30bf\u304c\u5404\u53c2\u52a0\u8005\u306e\u30d6\u30e9\u30a6\u30b6\u5185\u306b\u306e\u307f\u5b58\u5728\u3059\u308b\u305f\u3081\u3001\u5168\u54e1\u304c\u30eb\u30fc\u30e0\u304b\u3089\u96e2\u8131\u3059\u308b\u3068\u30c7\u30fc\u30bf\u304c\u6d88\u5931\u3057\u307e\u3059\u3002\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u30bb\u30c3\u30b7\u30e7\u30f3\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3092\u5b9f\u884c\u3057\u3066\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u3092\u751f\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u4fdd\u5b58\u3057\u305fzip\u306e\u8aad\u307f\u8fbc\u307f\u306f\u30d6\u30e9\u30a6\u30b6\u753b\u9762\u3078\u306e\u30d5\u30a1\u30a4\u30eb\u30c9\u30ed\u30c3\u30d7\u3067\u884c\u3048\u307e\u3059\u3002"),this.makeSampleMessage("System","???","\u30d7\u30ec\u30a4\u30e4\u30fc","\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8","\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\uff08\u79d8\u5bc6\u4f1a\u8a71\uff09\u306f\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\u306b\u8a18\u9332\u3055\u308c\u307e\u305b\u3093\u3002"),this.makeSampleMessage("System","???","\u30d7\u30ec\u30a4\u30e4\u30fc","\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8","\u307e\u305f\u3001\u904e\u53bb\u306e\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u3042\u306a\u305f\u306eID\u304c\u66f4\u65b0\u3055\u308c\u308b\u3068\u540c\u3058\u30eb\u30fc\u30e0\u5185\u3067\u3042\u3063\u3066\u3082\u898b\u3048\u306a\u304f\u306a\u308a\u307e\u3059\u3002\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),this.makeSampleMessage("System",null,"\u52d5\u4f5c\u74b0\u5883",null,"\u52d5\u4f5c\u63a8\u5968\u74b0\u5883\u306f\u30c7\u30b9\u30af\u30c8\u30c3\u30d7\u7248 Google Chrome \u3067\u3059\u3002\u4eca\u306e\u3068\u3053\u308d\u3001\u30b9\u30de\u30db\u304b\u3089\u3060\u3068\u64cd\u4f5c\u6027\u306b\u96e3\u304c\u3042\u308a\u307e\u3059\u3002"),this.makeSampleMessage("System",null,"\u52d5\u4f5c\u304c\u4e0d\u5b89\u5b9a\u306a\u6642\u306f",null,"\u5229\u7528\u74b0\u5883\u306e\u8a2d\u5b9a\u5909\u66f4\u3067\u6539\u5584\u3067\u304d\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\u6b21\u306e\u4e8b\u3092\u8a66\u3057\u3066\u307f\u3066\u4e0b\u3055\u3044\u3002\n\u30fb\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2 \u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u30aa\u30f3\u306b\u3059\u308b\n\u30fb\u30d6\u30e9\u30a6\u30b6\u62e1\u5f35\u6a5f\u80fd\uff08\u30a2\u30c9\u30aa\u30f3\uff0f\u30d7\u30e9\u30b0\u30a4\u30f3\uff09\u3092\u5168\u3066\u30aa\u30d5\u306b\u3059\u308b\n\u30fbChrome \u21d4 Firefox\u306a\u3069\u9055\u3046\u30d6\u30e9\u30a6\u30b6\u3092\u4f7f\u7528\u3059\u308b"),this.makeSampleMessage("System",null,"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\uff1a\u304a\u308f\u308a\u306b",null,"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u4ee5\u4e0a\u3067\u3059\u3002\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u6700\u521d\u306e\u30c1\u30e3\u30c3\u30c8\u3092\u5165\u529b\u3059\u308b\u3068\u975e\u8868\u793a\u306b\u306a\u308a\u307e\u3059\u3002")],this.topTimestamp=0,this.botomTimestamp=0,this.needUpdate=!0,this.topElm=null,this.bottomElm=null,this.topElmBox=null,this.bottomElmBox=null,this.topIndex=0,this.bottomIndex=0,this.preScrollTop=0,this.scrollSpeed=0,this._chatMessages=[],this.scrollEventShortTimer=null,this.scrollEventLongTimer=null,this.addMessageEventTimer=null,this.callbackOnScroll=()=>this.onScroll(),this.callbackOnScrollToBottom=()=>this.resetMessages(),this.onAddMessage=new ei}ngOnInit(){ne.register(this).on("MESSAGE_ADDED",e=>{let i=bt.instance.get(e.data.messageIdentifier);!i||!this.chatTab.contains(i)||this.topTimestamp<=i.timestamp&&(this.changeDetector.markForCheck(),this.needUpdate=!0,this.onMessageInit())}).on(`UPDATE_GAME_OBJECT/aliasName/${Ki.aliasName}`,e=>{let i=bt.instance.get(e.data.identifier);i&&this.topTimestamp<=i.timestamp&&i.timestamp<=this.botomTimestamp&&this.chatTab.contains(i)&&this.changeDetector.markForCheck()})}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.scrollEventShortTimer=new Nc(()=>this.lazyScrollUpdate(),33),this.scrollEventLongTimer=new Nc(()=>this.lazyScrollUpdate(!1),66),this.onScroll(),this.panelService.scrollablePanel.addEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.addEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1)})}ngOnDestroy(){ne.unregister(this),this.panelService.scrollablePanel.removeEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.removeEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1),this.scrollEventShortTimer.clear(),this.scrollEventLongTimer.clear(),this.addMessageEventTimer&&clearTimeout(this.addMessageEventTimer),this.addMessageEventTimer=null}ngOnChanges(){Promise.resolve().then(()=>this.resetMessages())}ngAfterViewChecked(){!this.topElm||!this.bottomElm||this.ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>this.adjustScrollPosition())})}onMessageInit(){null==this.addMessageEventTimer&&this.ngZone.runOutsideAngular(()=>{this.addMessageEventTimer=setTimeout(()=>{this.addMessageEventTimer=null,this.ngZone.run(()=>this.onAddMessage.emit())},0)})}resetMessages(){let e=this.chatTab.chatMessages.length-1;this.topIndex=e-Math.floor(this.panelService.scrollablePanel.clientHeight/this.minMessageHeight),this.bottomIndex=e,this.needUpdate=!0,this.preScrollTop=-1,this.scrollSpeed=0,this.topElm=this.bottomElm=null,this.adjustIndex(),this.changeDetector.markForCheck()}trackByChatMessage(e,i){return i.identifier}adjustIndex(){let e=this.chatTab?this.chatTab.chatMessages:[],i=0<e.length?e.length-1:0;this.topIndex<0&&(this.topIndex=0),i<this.bottomIndex&&(this.bottomIndex=i),this.topIndex<0&&(this.topIndex=0),this.bottomIndex<0&&(this.bottomIndex=0),i<this.topIndex&&(this.topIndex=i),i<this.bottomIndex&&(this.bottomIndex=i)}getScrollPosition(){let e=this.panelService.scrollablePanel.scrollTop,i=this.panelService.scrollablePanel.clientHeight,r=this.panelService.scrollablePanel.scrollHeight;return e<0&&(e=0),r-i<e&&(e=r-i),{top:e,bottom:e+i,clientHeight:i,scrollHeight:r}}adjustScrollPosition(){if(!this.topElm||!this.bottomElm)return;let e=this.logContainerRef.nativeElement.contains(this.topElm),i=this.logContainerRef.nativeElement.contains(this.bottomElm),{hasTopBlank:r,hasBotomBlank:o}=this.checkBlank(e,i);this.topElm=this.bottomElm=null,(r||o||!e&&!i)&&Ns(()=>this.lazyScrollUpdate())}checkBlank(e,i){let r=!e,o=!i;if(!e&&!i)return{hasTopBlank:r,hasBotomBlank:o};let s=null,a=null,c=null,u=0;i?(s=this.bottomElm,a=this.bottomElmBox):e&&(s=this.topElm,a=this.topElmBox),c=s.getBoundingClientRect(),u=a.top-c.top-this.scrollSpeed,(!r||!o)&&.25<u**2&&(this.panelService.scrollablePanel.scrollTop-=u);let f=this.logContainerRef.nativeElement.getBoundingClientRect(),b=this.messageContainerRef.nativeElement.getBoundingClientRect(),C=b.top-f.top,x=C+b.height,M=this.getScrollPosition();return r=M.top<C,o=x<M.bottom&&M.bottom<M.scrollHeight,{hasTopBlank:r,hasBotomBlank:o}}markForReadIfNeeded(){if(!this.chatTab.hasUnread)return;let e=this.getScrollPosition();e.scrollHeight<=e.bottom+100&&Ns(()=>{this.chatTab.markForRead(),this.changeDetector.markForCheck(),this.ngZone.run(()=>{})})}onScroll(){this.scrollEventShortTimer.reset(),this.scrollEventLongTimer.isActive||this.scrollEventLongTimer.reset()}lazyScrollUpdate(e=!0){this.scrollEventShortTimer.stop(),this.scrollEventLongTimer.stop();let i=this.messageContainerRef.nativeElement.querySelectorAll("chat-message"),r=this.messageContainerRef.nativeElement.offsetTop,o=r+this.messageContainerRef.nativeElement.clientHeight,s=this.topIndex,a=this.bottomIndex,c=this.getScrollPosition();this.scrollSpeed=c.top-this.preScrollTop,this.preScrollTop=c.top;let u=c.top<r,f=o<c.bottom&&c.bottom<c.scrollHeight;if(e||this.scrollEventShortTimer.reset(),!e&&!u&&!f)return;let b=c.top-(!e&&u?100:1200),C=c.bottom+(!e&&f?100:1200);this.markForReadIfNeeded(),this.calcItemIndexRange(r,o,b,C,c,i),(this.topIndex!=s||this.bottomIndex!=a)&&(this.needUpdate=!0,this.topElm=i[0],this.bottomElm=i[i.length-1],this.topElmBox=this.topElm.getBoundingClientRect(),this.bottomElmBox=this.bottomElm.getBoundingClientRect(),Ns(()=>{let M=this.getScrollPosition();this.scrollSpeed=M.top-this.preScrollTop,this.preScrollTop=M.top,this.changeDetector.markForCheck(),this.ngZone.run(()=>{})}))}calcElementMaxHeight(e){let i=this.minMessageHeight;for(let r=e.length-1;0<=r;r--){let o=e[r].clientHeight;i<o&&(i=o)}return i}calcItemIndexRange(e,i,r,o,s,a){if(r>=i||e>=o)this.bottomIndex=this.chatTab.chatMessages.length-1-Math.floor((s.scrollHeight-s.top-s.clientHeight)/this.minMessageHeight),this.topIndex=this.bottomIndex-Math.floor(s.clientHeight/this.minMessageHeight),this.bottomIndex+=1,this.topIndex-=1;else{let c=this.calcElementMaxHeight(a);r<e?this.topIndex-=Math.floor((e-r)/c)+1:r>e&&(B5||(this.topIndex+=Math.floor((r-e)/c))),i>o?B5||(this.bottomIndex-=Math.floor((i-o)/c)):i<o&&(this.bottomIndex+=Math.floor((o-i)/c)+1)}this.adjustIndex()}makeSampleMessage(e,i,r,o,s,a="mine"){let c=new Ki;return c.from=e,c.to=i,c.name=r,c.toName=o,c.color="#444444",c.toColor=o?"#444444":null,c.tag=a,c.value=s,c}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Pn),Y(Zr),Y(yi))};static#t=this.\u0275cmp=In({type:t,selectors:[["chat-tab"]],viewQuery:function(i,r){if(1&i&&(Ln(jle,7),Ln(Gle,7)),2&i){let o;Bn(o=Un())&&(r.logContainerRef=o.first),Bn(o=Un())&&(r.messageContainerRef=o.first)}},inputs:{compact:"compact",chatTab:"chatTab"},outputs:{onAddMessage:"onAddMessage"},features:[hr],decls:6,vars:6,consts:[["logContainer",""],["messageContainer",""],[1,"log"],[1,"virtual-scroll-container"],[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"chatMessage","compact",4,"ngIf"],[3,"chatMessage","compact"],[3,"chatMessage","compact",4,"ngFor","ngForOf"]],template:function(i,r){1&i&&(p(0,"div",2,0)(2,"div",3,1),q(4,Yle,2,2,"ng-container",4)(5,qle,2,1,"ng-container",4),g()()),2&i&&(je("min-height",r.minScrollHeight,"px"),h(2),je("margin-bottom",r.bottomSpace,"px"),h(2),m("ngIf",!r.isEmpty),h(),m("ngIf",r.isEmpty))},dependencies:[nr,ri,Vle],styles:["[_nghost-%COMP%]{display:block}.log[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:flex-end;align-items:flex-end;width:100%;height:100%}.virtual-scroll-container[_ngcontent-%COMP%]{flex-shrink:0;width:100%}"],changeDetection:0})}return t})();class Kle{constructor(n){this.canvasElement=n}makeBrush(n,e,i){n.strokeStyle=i,n.fillStyle=n.strokeStyle,n.lineWidth=1;let r=Math.floor(e/5);return n.font=`bold ${r}px sans-serif`,n.textBaseline="top",n.textAlign="center",n}render(n,e,i=50,r=jc.SQUARE,o="#000000e6",s=!0){this.canvasElement.width=n*i,this.canvasElement.height=e*i;let a=this.canvasElement.getContext("2d");if(r<0)return;let c=this.generateCalcGridPositionFunc(r);this.makeBrush(a,i,o);for(let u=0;u<=e;u++)for(let f=0;f<=n;f++){let{gx:b,gy:C}=c(f,u,i);this.strokeSquare(a,b,C,i),s&&a.fillText((f+1).toString()+"-"+(u+1).toString(),b+i/2,C+i/2)}}generateCalcGridPositionFunc(n){switch(n){case jc.HEX_VERTICAL:return(e,i,r)=>e%2==1?{gx:e*r,gy:i*r}:{gx:e*r,gy:i*r+r/2};case jc.HEX_HORIZONTAL:return(e,i,r)=>i%2==1?{gx:e*r,gy:i*r}:{gx:e*r+r/2,gy:i*r};default:return(e,i,r)=>({gx:e*r,gy:i*r})}}strokeSquare(n,e,i,r){n.beginPath(),n.strokeRect(e,i,r,r)}strokeHex(n,e,i,r,o){let s=o===jc.HEX_HORIZONTAL?-30:0,a=r/Math.sqrt(3),c=e+r/2,u=i+r/2;n.beginPath();for(let f=0;f<6;f++){s+=60;let b=Hi.radians(s),C=Math.cos(b)*a+c,x=Math.sin(b)*a+u;n.lineTo(C,x)}n.closePath(),n.stroke()}}var Ib=function(t){return t.DRAG="drag",t.ZOOM="zoom",t.ROTATE="rotate",t.KEYBOARD="keyboard",t}(Ib||{}),Zc=function(t){return t.ArrowLeft="ArrowLeft",t.ArrowUp="ArrowUp",t.ArrowRight="ArrowRight",t.ArrowDown="ArrowDown",t}(Zc||{});class Qle{get isGrabbing(){return this.input.isGrabbing}get isDragging(){return this.input.isDragging}constructor(n){this.targetElement=n,this.currentPositionX=0,this.currentPositionY=0,this.buttonCode=0,this.input=null,this.callbackOnWheel=e=>this.onWheel(e),this.callbackOnKeydown=e=>this.onKeydown(e),this.onstart=null,this.onend=null,this.ontransform=null,this.initialize()}initialize(){this.input=new Bc(this.targetElement,{capture:!0}),this.addEventListeners(),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this)}cancel(){this.input.cancel()}destroy(){this.input.destroy(),this.removeEventListeners()}onInputStart(n){this.currentPositionX=this.input.pointer.x,this.currentPositionY=this.input.pointer.y,this.buttonCode=n.button,this.onstart&&this.onstart(n)}onInputEnd(n){this.onend&&this.onend(n)}onInputMove(n){let e=this.input.pointer.x,i=this.input.pointer.y,r=e-this.currentPositionX,o=i-this.currentPositionY,s=0,a=0,u=0,b=0,C=Ib.DRAG;2===this.buttonCode?(C=Ib.ROTATE,b=-r/5,u=-o/5):(s=r,a=o),this.currentPositionX=e,this.currentPositionY=i,this.ontransform&&this.ontransform(s,a,0,u,0,b,C,n)}onWheel(n){let e=0;switch(n.deltaMode){case WheelEvent.DOM_DELTA_LINE:e=16*n.deltaY;break;case WheelEvent.DOM_DELTA_PAGE:e=n.deltaY*window.innerHeight;break;default:e=n.deltaY}let o=0;o=-1.5*e,9e4<o**2&&(o=Math.min(Math.max(o,-300),300)),this.ontransform&&this.ontransform(0,0,o,0,0,0,Ib.ZOOM,n)}onKeydown(n){let e=0,i=0,r=0,o=0,a=0,c=this.getKeyName(n);switch(c){case Zc.ArrowLeft:n.shiftKey?a=-2:e=10;break;case Zc.ArrowUp:n.shiftKey?o=-2:n.ctrlKey?r=150:i=10;break;case Zc.ArrowRight:n.shiftKey?a=2:e=-10;break;case Zc.ArrowDown:n.shiftKey?o=2:n.ctrlKey?r=-150:i=-10}null!=Zc[c]&&this.ontransform&&this.ontransform(e,i,r,o,0,a,Ib.KEYBOARD,n)}getKeyName(n){if(n.key)return n.key;switch(n.keyCode){case 37:return Zc.ArrowLeft;case 38:return Zc.ArrowUp;case 39:return Zc.ArrowRight;case 40:return Zc.ArrowDown;default:return""}}addEventListeners(){this.targetElement.addEventListener("wheel",this.callbackOnWheel,!1),document.body.addEventListener("keydown",this.callbackOnKeydown,!1)}removeEventListeners(){this.targetElement.removeEventListener("wheel",this.callbackOnWheel,!1),document.body.removeEventListener("keydown",this.callbackOnKeydown,!1)}}class Jle{get isActive(){return this.pointerDevice.isTablePickGesture}set isActive(n){this.pointerDevice.isTablePickGesture=n}constructor(n,e,i,r,o,s){this.targetElement=n,this.gameObjectsElement=e,this.pointerDevice=o,this.selection=s,this.pickCursorScale=1,this.input=null,this.activateTimer=null,this.keydownTimer=null,this.tappedTimer=null,this.tappedPointer={x:0,y:0,z:0},this.isPickObjectMode=!1,this.isPickRegionMode=!1,this.isMagneticMode=!1,this.isStrokeMode=!1,this.isKeepSelection=!1,this.isObjectDragging=!1,this.isPointerMoved=!1,this.target=null,this.callbackOnKeydown=a=>this.onKeydown(a),this.onstart=null,this.onend=null,this.oncancelifneeded=null,this.onpick=null,this.pickCursor=new ece(i),this.pickArea=new tce(r),this.initialize()}initialize(){this.input=new Bc(this.targetElement),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onTap=this.onInputTap.bind(this)}cancel(){this.input.cancel(),this.clearActivateTimer(),this.pickCursor.deactive(),this.isPickObjectMode=!1,this.isPickRegionMode=!1,this.isMagneticMode=!1,this.isStrokeMode=!1,this.isActive=!1,this.isKeepSelection=!1,this.isObjectDragging=!1,this.isPointerMoved=!1,this.target=null,this.clearKeyDownTimer(),this.clearTappedTimer()}destroy(){this.cancel(),this.input.destroy(),this.clearKeyDownTimer(),this.clearTappedTimer()}onInputStart(n){if(this.target=null,this.isPickObjectMode=!1,this.isPickRegionMode=!1,this.isMagneticMode=!1,this.isStrokeMode=!1,this.isPointerMoved=!1,this.isObjectDragging=!1,this.isKeepSelection=!1,this.clearActivateTimer(),this.pickCursor.update(this.input.pointer),!(n instanceof MouseEvent&&0===n.button||n.touches))return this.cancel();this.isStrokeMode=n instanceof MouseEvent&&0===n.button&&n.ctrlKey;let i=n instanceof MouseEvent&&0===n.button&&n.shiftKey;this.isStrokeMode||i?this.startQuickCursor(n):this.startLongPressCursor(n)}onInputMove(n){let e=1<n.touches?.length,i=(n instanceof MouseEvent?3:12)**2;this.isObjectDragging=this.pointerDevice.isDragging,this.isPointerMoved=this.isPointerMoved||i<this.input.magnitude,this.isKeepSelection=this.isKeepSelection||this.isPointerMoved||this.isObjectDragging,null==this.keydownTimer&&((e||null!=this.target&&this.isObjectDragging&&this.isPointerMoved&&!this.isMagneticMode||null!=this.activateTimer&&this.isPointerMoved)&&this.cancel(),this.isActive&&(null==this.oncancelifneeded||!this.oncancelifneeded())&&(this.pickCursor.update(this.input.pointer),this.pickCursor.scale(0),this.isPickObjectMode&&n instanceof MouseEvent&&n.ctrlKey?this.pickObject(n):this.isPointerMoved&&this.isPickRegionMode&&this.pickRegion(n),this.onpick&&this.onpick()))}onInputEnd(n){let e=(n instanceof MouseEvent?3:12)**2;this.isObjectDragging=this.pointerDevice.isDragging,this.isPointerMoved=this.isPointerMoved||e<this.input.magnitude,this.isKeepSelection=this.isKeepSelection||this.isPointerMoved||this.isObjectDragging,this.onend&&this.onend(),this.cancel()}onInputTap(n){this.setTappedTimer(),this.tappedPointer=this.input.pointer}onKeydown(n){if(!this.isActive||this.input.isGrabbing)switch(n.key){case"Control":this.isStrokeMode=!0;case"Shift":this.clearActivateTimer(),this.clearKeyDownTimer(),this.target=null,this.isPointerMoved=!1,this.isObjectDragging=!1,this.isKeepSelection=!1,this.isActive=!0,this.pickCursor.update(this.input.pointer),this.pickCursor.active(),this.pickCursor.disableAnimation(),this.pickCursor.scale(.6),requestAnimationFrame(()=>this.pickCursor.scale(0)),this.pointerDevice.isDragging=!1,this.pickStart()}}startQuickCursor(n){this.isActive=!0,this.pickCursor.active(),this.pickCursor.disableAnimation(),this.pickCursor.scale(1),requestAnimationFrame(()=>this.pickCursor.scale(.6)),this.isMagneticMode=!1,this.isPickObjectMode=this.isStrokeMode,this.isPickRegionMode=!this.isStrokeMode,this.pointerDevice.isDragging=!1,this.pickStart(),this.isPickObjectMode&&(this.selection.excludeElement=null,this.pickObject(n))}startLongPressCursor(n){let e=n.target;e.contains(this.gameObjectsElement)||(this.target=e),this.isMagneticMode=null!=this.target&&this.pointerDevice.isDragging&&null!=this.tappedTimer&&Hi.sqrMagnitude(this.tappedPointer,this.input.pointer)<625,this.isPickObjectMode=null!=this.target&&this.pointerDevice.isDragging&&!this.isMagneticMode,this.isPickRegionMode=null==this.target||!this.isPickObjectMode&&!this.isMagneticMode,!this.isPickObjectMode&&(this.setActivateTimer(),this.setKeyDownTimer(),this.pickCursorScale=n.touches?4.5:1,this.pickCursor.active(),this.pickCursor.scale(this.pickCursorScale),this.isMagneticMode&&this.pickCursor.color(OS.MAGNETIC,OS.MAGNETIC_FILL))}pickStart(){let n=new CustomEvent("pickstart",{detail:{isMagnetic:this.isMagneticMode,isPickRegion:this.isPickRegionMode,isPickObject:this.isPickObjectMode},bubbles:!0});this.target?this.target.dispatchEvent(n):document.dispatchEvent(n),this.onstart&&this.onstart()}pickObject(n){let e=n.target;if(e.contains(this.gameObjectsElement))this.selection.excludeElement=document.body;else{this.isKeepSelection=!0;let i=new CustomEvent("pickobject",{detail:{srcEvent:n,first:this.input.startPointer,last:this.input.pointer},bubbles:!0});e.dispatchEvent(i)}}pickRegion(n){let e=this.input.startPointer,i=this.input.pointer,r=Math.min(e.x,i.x),o=Math.min(e.y,i.y),s=Math.abs(e.x-i.x),a=Math.abs(e.y-i.y);this.pickArea.update(r,o,s,a),this.selection.clear();let c=new CustomEvent("pickregion",{detail:{srcEvent:n,x:r,y:o,width:s,height:a},bubbles:!0});document.dispatchEvent(c)}setActivateTimer(){this.clearActivateTimer(),this.activateTimer=setTimeout(()=>{this.activateTimer=null,this.pickCursor.scale(.6*this.pickCursorScale),this.isActive=!0,this.isKeepSelection=this.isPickObjectMode||this.isMagneticMode,this.pickStart()},850)}clearActivateTimer(){this.isActive=!1,null!=this.activateTimer&&(clearTimeout(this.activateTimer),this.activateTimer=null),this.pickArea.deactive()}setKeyDownTimer(){this.clearKeyDownTimer(),this.keydownTimer=setTimeout(()=>{this.keydownTimer=null},66),document.body.addEventListener("keydown",this.callbackOnKeydown,!1)}clearKeyDownTimer(){null!=this.keydownTimer&&(clearTimeout(this.keydownTimer),this.keydownTimer=null),document.body.removeEventListener("keydown",this.callbackOnKeydown,!1)}setTappedTimer(){this.clearTappedTimer(),this.tappedTimer=setTimeout(()=>{this.tappedTimer=null},300)}clearTappedTimer(){null!=this.tappedTimer&&(clearTimeout(this.tappedTimer),this.tappedTimer=null)}}var OS=function(t){return t.SELECTED="hsl(200, 100%, 50%)",t.MAGNETIC="hsl(45, 100%, 50%)",t.SELECTED_FILL="hsla(200, 100%, 95%, .7)",t.MAGNETIC_FILL="hsla(45, 100%, 95%, .7)",t}(OS||{});class ece{constructor(n){this.targetElement=n,this.width=0,this.height=0,this.circleElement=this.targetElement.querySelector("circle"),this.active();let e=this.targetElement.getBoundingClientRect();this.width=e.width,this.height=e.height,this.deactive()}active(){this.deactive(),this.targetElement.style.display="block"}deactive(){this.targetElement.style.display=null,this.targetElement.style.stroke=null,this.targetElement.style.scale=null,this.circleElement.style.animation=null,this.circleElement.style.fill=null}scale(n){this.targetElement.style.scale=n+""}color(n,e){this.targetElement.style.stroke=n,this.circleElement.style.fill=e}disableAnimation(){this.circleElement.style.animation="none"}update(n){this.targetElement.style.left=n.x-this.width/2+"px",this.targetElement.style.top=n.y-this.height/2+"px"}}class tce{constructor(n){this.targetElement=n}update(n,e,i,r){this.targetElement.style.left=n+"px",this.targetElement.style.top=e+"px",this.targetElement.style.width=i+"px",this.targetElement.style.height=r+"px",this.targetElement.style.display="block"}deactive(){this.targetElement.style.width="0px",this.targetElement.style.height="0px",this.targetElement.style.display=null}}var lm=function(t){return t.PAN="pan",t.TAP_PINCH="tappinch",t.PINCH="pinch",t.ROTATE="rotate",t}(lm||{});class nce{constructor(n,e){this.targetElement=n,this.ngZone=e,this.hammer=null,this.deltaHammerDeltaX=0,this.deltaHammerDeltaY=1,this.deltaHammerScale=1,this.deltaHammerRotation=0,this.prevHammerDeltaX=0,this.prevHammerDeltaY=0,this.prevHammerScale=0,this.prevHammerRotation=0,this.tappedPanTimer=null,this.tappedPanCenter={x:0,y:0},this.onstart=null,this.onend=null,this.ongesture=null,this.ontransform=null,this.initializeHammer()}destroy(){this.clearTappedPanTimer(),this.hammer.destroy()}initializeHammer(){this.hammer=new Hammer.Manager(this.targetElement,{inputClass:Hammer.TouchInput});let n=new Hammer.Tap,e=new Hammer.Pan({event:"pan1p",pointers:1,threshold:0}),i=new Hammer.Pan({event:"pan2p",pointers:2,threshold:0}),r=new Hammer.Pinch,o=new Hammer.Rotate;e.recognizeWith(i),e.recognizeWith(o),e.recognizeWith(r),i.recognizeWith(r),i.recognizeWith(o),r.recognizeWith(o),this.hammer.add([n,e,i,r,o]),this.hammer.on("hammer.input",this.onHammer.bind(this)),this.hammer.on("tap",this.onTap.bind(this)),this.hammer.on("pan1pstart",this.onTappedPanStart.bind(this)),this.hammer.on("pan1pmove",this.onTappedPanMove.bind(this)),this.hammer.on("pan1pend",this.onTappedPanEnd.bind(this)),this.hammer.on("pan1pcancel",this.onTappedPanEnd.bind(this)),this.hammer.on("pan2pmove",this.onPanMove.bind(this)),this.hammer.on("pinchmove",this.onPinchMove.bind(this)),this.hammer.on("rotatemove",this.onRotateMove.bind(this));let s=window.navigator.userAgent.toLowerCase();(s.indexOf("iphone")>-1||s.indexOf("ipad")>-1||s.indexOf("macintosh")>-1&&"ontouchend"in document)&&(this.hammer.add(new Hammer.Press({time:251})),this.hammer.on("press",c=>{let u=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,clientX:c.center.x,clientY:c.center.y});this.ngZone.run(()=>c.srcEvent.target.dispatchEvent(u))}))}onHammer(n){n.isFirst?(this.deltaHammerScale=n.scale,this.deltaHammerRotation=n.rotation,this.deltaHammerDeltaX=n.deltaX,this.deltaHammerDeltaY=n.deltaY,this.onstart&&this.onstart(n.srcEvent)):n.isFinal?this.onend&&this.onend(n.srcEvent):(this.deltaHammerScale=n.scale-this.prevHammerScale,this.deltaHammerRotation=n.rotation-this.prevHammerRotation,this.deltaHammerDeltaX=n.deltaX-this.prevHammerDeltaX,this.deltaHammerDeltaY=n.deltaY-this.prevHammerDeltaY),this.prevHammerScale=n.scale,this.prevHammerRotation=n.rotation,this.prevHammerDeltaX=n.deltaX,this.prevHammerDeltaY=n.deltaY,null!=this.tappedPanTimer&&n.eventType==Hammer.INPUT_START&&2500<Hi.sqrMagnitude(this.tappedPanCenter,n.center)&&this.clearTappedPanTimer()}onTap(n){this.tappedPanCenter=n.center,this.tappedPanTimer=setTimeout(()=>{this.tappedPanTimer=null},400),this.ongesture&&this.ongesture(n.srcEvent)}onTappedPanStart(n){null!=this.tappedPanTimer&&(this.clearTappedPanTimer(!1),this.ongesture&&this.ongesture(n.srcEvent))}onTappedPanEnd(n){this.clearTappedPanTimer()}onTappedPanMove(n){if(null==this.tappedPanTimer)this.ontransform&&this.ontransform(this.deltaHammerDeltaX,this.deltaHammerDeltaY,0,0,0,0,lm.PAN,n.srcEvent);else{this.clearTappedPanTimer(!1);let i=7.5*this.deltaHammerDeltaY;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,i,0,0,0,lm.TAP_PINCH,n.srcEvent)}}onPanMove(n){this.clearTappedPanTimer();let e=-this.deltaHammerDeltaY/window.innerHeight*100;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,0,e,0,0,lm.ROTATE,n.srcEvent)}onPinchMove(n){this.clearTappedPanTimer();let e=500*this.deltaHammerScale;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,e,0,0,0,lm.PINCH,n.srcEvent)}onRotateMove(n){this.clearTappedPanTimer();let e=this.deltaHammerRotation;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,0,0,0,e,lm.ROTATE,n.srcEvent)}clearTappedPanTimer(n=!0){clearTimeout(this.tappedPanTimer),n&&(this.tappedPanTimer=null)}}let jC=(()=>{class t{constructor(){}createGameCharacter(e){let i=gn.create("\u65b0\u3057\u3044\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",1,"");return i.location.x=e.x-25,i.location.y=e.y-25,i.posZ=e.z,i}createGameTableMask(e){let i=this.getViewTable();if(!i)return;let r=zo.create("\u30de\u30c3\u30d7\u30de\u30b9\u30af",5,5,100);return r.location.x=e.x-25,r.location.y=e.y-25,r.posZ=e.z,i.appendChild(r),r}createTerrain(e){let i="./assets/images/tex.jpg",r=on.instance.get(i);r||(r=on.instance.add(i),ui.create(r.identifier).tag="*default \u5730\u5f62");let o=this.getViewTable();if(!o)return;let s=es.create("\u5730\u5f62",2,2,2,r.identifier,r.identifier);return s.location.x=e.x-50,s.location.y=e.y-50,s.posZ=e.z,o.appendChild(s),s}createTextNote(e){let i=vs.create("\u5171\u6709\u30e1\u30e2","\u30c6\u30ad\u30b9\u30c8\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044",5,4,3);return i.location.x=e.x,i.location.y=e.y,i.posZ=e.z,i}createDiceSymbol(e,i,r,o){let s=ts.create(i,r,1),a=null;return s.nothingFaces.forEach(c=>{let u=`./assets/images/dice/${o}/${o}[0].png`;a=on.instance.get(u),a||(a=on.instance.add(u),ui.create(a.identifier).tag="*default "+(r===Do.D2?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")),s.imageDataElement.getFirstElementByName(c).value=a.identifier}),s.faces.forEach(c=>{let u=`./assets/images/dice/${o}/${o}[${c}].png`;a=on.instance.get(u),a||(a=on.instance.add(u),ui.create(a.identifier).tag="*default "+(r===Do.D2?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")),s.imageDataElement.getFirstElementByName(c).value=a.identifier}),s.location.x=e.x-25,s.location.y=e.y-25,s.posZ=e.z,s}createBlankCard(e){const i="./assets/images/trump/blank_card.png",r="./assets/images/trump/z01.gif";let o,s;o=on.instance.get(i),o||(o=on.instance.add(i),ui.create(o.identifier).tag="*default \u30ab\u30fc\u30c9"),s=on.instance.get(r),s||(s=on.instance.add(r),ui.create(s.identifier).tag="*default \u30ab\u30fc\u30c9");let a=Ci.create("\u30ab\u30fc\u30c9",o.identifier,s.identifier);return a.location.x=e.x-25,a.location.y=e.y-25,a.posZ=e.z,a}cardName(e){let i="";const r=e.slice(0,1),o=parseInt(e.substring(1,3));switch(r){case"c":i="\u30af\u30e9\u30d6";break;case"d":i="\u30c0\u30a4\u30e4";break;case"h":i="\u30cf\u30fc\u30c8";break;case"s":i="\u30b9\u30da\u30fc\u30c9";break;case"x":i="\u30b8\u30e7\u30fc\u30ab\u30fc"}return i+="x"==r?`\uff08${1==o?"\u8d64":"\u9ed2"}\uff09`:`\u306e${1==o?"\u30a8\u30fc\u30b9":o>=11?["\u30b8\u30e3\u30c3\u30af","\u30af\u30a4\u30fc\u30f3","\u30ad\u30f3\u30b0"][o-11]:o}`,i}createTrump(e){let i=Vi.create("\u30c8\u30e9\u30f3\u30d7\u5c71\u672d");i.location.x=e.x-25,i.location.y=e.y-25,i.posZ=e.z;let r="./assets/images/trump/z02.gif";if(!on.instance.get(r)){const a=on.instance.add(r);ui.create(a.identifier).tag="*default \u30ab\u30fc\u30c9"}let o=["c","d","h","s"],s=[];for(let a of o)for(let c=1;c<=13;c++)s.push(a+("00"+c).slice(-2));s.push("x01"),s.push("x02");for(let a of s){let c="./assets/images/trump/"+a+".gif";if(!on.instance.get(c)){const f=on.instance.add(c);ui.create(f.identifier).tag="*default \u30ab\u30fc\u30c9"}let u=Ci.create(this.cardName(a),c,r);i.putOnBottom(u)}return i}createRangeArea(e,i){let r;switch(i){case"LINE":r=rr.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u76f4\u7dda)",1,6,100);break;case"CIRCLE":r=rr.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u5186)",3,3,100);break;case"SQUARE":r=rr.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u6b63\u65b9\u5f62)",3,3,100);break;case"DIAMOND":r=rr.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u30c0\u30a4\u30e4)",3,3,100);break;default:r=rr.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u9310\u5f62)",6,6,100)}return r.location.x=e.x,r.location.y=e.y,r.posZ=e.z,r.type=i,r.commonDataElement.getFirstElementByName("opacity").currentValue=60,r}makeDefaultTable(){let e=new bo("gameTable"),i=null,r=vn.createEmpty("testTableBackgroundImage_image").toContext();r.url="./assets/images/BG10a_80.jpg",i=on.instance.add(r),ui.create(i.identifier).tag="*default \u30c6\u30fc\u30d6\u30eb",e.name="\u6700\u521d\u306e\u30c6\u30fc\u30d6\u30eb",e.imageIdentifier=i.identifier,e.width=20,e.height=15,e.initialize(),Ho.instance.viewTableIdentifier=e.identifier}makeDefaultTabletopObjects(){let e=null,i=null,r=null;e=new gn("testCharacter_1"),r=vn.createEmpty("testCharacter_1_image").toContext(),r.url="./assets/images/mon_052.gif",i=on.instance.add(r),ui.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=250,e.location.y=450,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcA",1,i.identifier),e=new gn("testCharacter_2"),e.location.x=400,e.location.y=400,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcB",1,i.identifier),e=new gn("testCharacter_3"),r=vn.createEmpty("testCharacter_3_image").toContext(),r.url="./assets/images/mon_128.gif",i=on.instance.add(r),ui.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=200,e.location.y=100,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcC",3,i.identifier),e=new gn("testCharacter_4"),r=vn.createEmpty("testCharacter_4_image").toContext(),r.url="./assets/images/mon_150.gif",i=on.instance.add(r),ui.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=300,e.location.y=550,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcA",1,i.identifier),e=new gn("testCharacter_5"),r=vn.createEmpty("testCharacter_5_image").toContext(),r.url="./assets/images/mon_211.gif",i=on.instance.add(r),ui.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=600,e.location.y=600,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcB",1,i.identifier),e=new gn("testCharacter_6"),r=vn.createEmpty("testCharacter_6_image").toContext(),r.url="./assets/images/mon_135.gif",i=on.instance.add(r),ui.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.initialize(),e.location.x=250,e.location.y=650,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcC",1,i.identifier)}makeDefaultContextMenuActions(e){return[this.getCreateCharacterMenu(e),this.getCreateTableMaskMenu(e),this.getCreateTerrainMenu(e),this.getCreateTextNoteMenu(e),this.getCreateBlankCardMenu(e),this.getCreateTrumpMenu(e),this.getCreateDiceSymbolMenu(e),this.getCreateRangeMenu(e)]}getCreateCharacterMenu(e){return{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u4f5c\u6210",action:()=>{let i=this.createGameCharacter(e);ne.trigger("SELECT_TABLETOP_OBJECT",{identifier:i.identifier,className:i.aliasName}),tt.play(Te.piecePut)}}}getCreateTableMaskMenu(e){return{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u4f5c\u6210",action:()=>{this.createGameTableMask(e),tt.play(Te.cardPut)}}}getCreateTerrainMenu(e){return{name:"\u5730\u5f62\u3092\u4f5c\u6210",action:()=>{this.createTerrain(e),tt.play(Te.blockPut)}}}getCreateTextNoteMenu(e){return{name:"\u5171\u6709\u30e1\u30e2\u3092\u4f5c\u6210",action:()=>{this.createTextNote(e),tt.play(Te.cardPut)}}}getCreateBlankCardMenu(e){return{name:"\u30d6\u30e9\u30f3\u30af\u30ab\u30fc\u30c9\u3092\u4f5c\u6210",action:()=>{this.createBlankCard(e),tt.play(Te.cardPut)}}}getCreateTrumpMenu(e){return{name:"\u30c8\u30e9\u30f3\u30d7\u306e\u5c71\u672d\u3092\u4f5c\u6210",action:()=>{this.createTrump(e),tt.play(Te.cardPut)}}}getCreateDiceSymbolMenu(e){let r=[];return[{menuName:"\u30b3\u30a4\u30f3 (\u8868/\u88cf)",diceName:"\u30b3\u30a4\u30f3",type:Do.D2,imagePathPrefix:"2_coin"},{menuName:"D4",diceName:"D4",type:Do.D4,imagePathPrefix:"4_dice"},{menuName:"D6",diceName:"D6",type:Do.D6,imagePathPrefix:"6_dice"},{menuName:"D6 (Black)",diceName:"D6",type:Do.D6,imagePathPrefix:"6_dice_black"},{menuName:"D8",diceName:"D8",type:Do.D8,imagePathPrefix:"8_dice"},{menuName:"D10",diceName:"D10",type:Do.D10,imagePathPrefix:"10_dice"},{menuName:"D10 (00-90)",diceName:"D10",type:Do.D10_10TIMES,imagePathPrefix:"100_dice"},{menuName:"D12",diceName:"D12",type:Do.D12,imagePathPrefix:"12_dice"},{menuName:"D20",diceName:"D20",type:Do.D20,imagePathPrefix:"20_dice"}].forEach(o=>{r.push({name:o.menuName,action:()=>{this.createDiceSymbol(e,o.diceName,o.type,o.imagePathPrefix),tt.play(Te.dicePut)}})}),{name:"\u30b3\u30a4\u30f3\uff0f\u30c0\u30a4\u30b9\u3092\u4f5c\u6210",action:null,subActions:r}}getCreateRangeMenu(e){let r=[];return[{menuName:"\u9310\u5f62",typeName:"CORN"},{menuName:"\u76f4\u7dda",typeName:"LINE"},{menuName:"\u5186",typeName:"CIRCLE"},{menuName:"\u6b63\u65b9\u5f62",typeName:"SQUARE"},{menuName:"\u30c0\u30a4\u30e4\u30e2\u30f3\u30c9",typeName:"DIAMOND"}].forEach(o=>{r.push({name:o.menuName,action:()=>{this.createRangeArea(e,o.typeName),tt.play(Te.dicePut)}})}),{name:"\u5c04\u7a0b\u30fb\u7bc4\u56f2\u3092\u4f5c\u6210",action:null,subActions:r}}getViewTable(){return Ho.instance.viewTable}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=nn({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class AS{constructor(n){this.targetElement=n,this.hammer=new Hammer.Manager(this.targetElement,{inputClass:Hammer.TouchMouseInput}),this.isEnable=!0,this.onstart=null,this.oninteract=null,this.initializeHammer()}cancel(){this.isEnable=!1}destroy(){this.hammer.destroy()}initializeHammer(){let n=new Hammer.Tap({event:"tap2",taps:2});this.hammer.add([n]),this.hammer.on("hammer.input",this.onHammer.bind(this)),this.hammer.on("tap2",this.onInteract.bind(this))}onHammer(n){if(!n.isFirst)return;let e=n.srcEvent instanceof MouseEvent&&(0!==n.srcEvent.button||n.srcEvent.ctrlKey||n.srcEvent.shiftKey);this.isEnable=!e,this.isEnable&&this.onstart&&this.onstart(n.srcEvent)}onInteract(n){this.isEnable&&this.oninteract&&this.oninteract(n.srcEvent)}}class zf{static#e=this.rotablesMap=new Map;get selectedRotables(){let n=new Set;for(let e of this.selection.objects)zf.rotablesMap.get(e)?.forEach(i=>n.add(i));return n}get isDestroyed(){return this._isDestroyed}constructor(n,e){this.rotable=n,this.selection=e,this._isDestroyed=!1}initialize(){this.register()}destroy(){this.unregister(),this._isDestroyed=!0,this.rotable=null}prepareRotate(){if(1<this.selection.size&&this.rotable.state!==$n.NONE)for(let n of this.selectedRotables)n!==this.rotable&&(n.isDisable||n.setAnimatedTransition(!1));else this.selection.clear()}updateRotate(){if(!(this.selection.size<=1||this.rotable.state===$n.NONE))for(let n of this.selectedRotables)n!==this.rotable&&!n.isDisable&&n.tabletopObject.aliasName===this.rotable.tabletopObject.aliasName&&n.targetPropertyName===this.rotable.targetPropertyName&&(n.rotate=this.rotable.rotate)}finishRotate(){if(!(this.selection.size<=1||this.rotable.state===$n.NONE))for(let n of this.selectedRotables)n!==this.rotable&&!n.isDisable&&n.tabletopObject.aliasName===this.rotable.tabletopObject.aliasName&&n.targetPropertyName===this.rotable.targetPropertyName&&(n.setAnimatedTransition(!0),n.rotate=this.rotable.rotate)}register(){let n=zf.rotablesMap.get(this.rotable.tabletopObject)??new Set;n.add(this.rotable),zf.rotablesMap.set(this.rotable.tabletopObject,n)}unregister(){let n=zf.rotablesMap.get(this.rotable.tabletopObject);n&&(n.delete(this.rotable),n.size<1&&zf.rotablesMap.delete(this.rotable.tabletopObject))}}let Hf=(()=>{class t{get tabletopObject(){return this._tabletopObject}get targetPropertyName(){return this._targetPropertyName}get targetProperty(){return this.tabletopObject[this.targetPropertyName]}set targetProperty(e){this.targetPropertyName in this.tabletopObject&&(this.tabletopObject[this.targetPropertyName]=e)}get transformCssOffset(){return this._transformCssOffset}get grabbingSelecter(){return this._grabbingSelecter}set option(e){this.synchronizer.unregister(),this._tabletopObject=e.tabletopObject,this._targetPropertyName=e.targetPropertyName??"",this._grabbingSelecter=e.grabbingSelecter??".rotate-grab",this._transformCssOffset=e.transformCssOffset??"",this._targetPropertyName.length<1&&this._tabletopObject&&(this._targetPropertyName="rotate"),this.synchronizer.register()}get nativeElement(){return this.elementRef.nativeElement}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.setUpdateBatching()}get isAllowedToRotate(){if(!this.grabbingElement||!this.nativeElement)return!1;if(this.grabbingSelecter.length<1)return!0;let e=this.nativeElement.querySelectorAll(this.grabbingSelecter),i=!1;for(let r=0;r<e.length;r++)if(i=e[r].contains(this.grabbingElement),i)return!0;return!1}get state(){return this.selectionService.state(this.tabletopObject)}constructor(e,i,r,o,s,a){this.elementRef=e,this.batchService=i,this.pointerDeviceService=r,this.coordinateService=o,this.tabletopService=s,this.selectionService=a,this._targetPropertyName="",this._transformCssOffset="",this._grabbingSelecter=".rotate-grab",this.isDisable=!1,this.polygonal=24,this.onstart=new ei,this.ondragstart=new ei,this.ondrag=new ei,this.ondragend=new ei,this.onend=new ei,this.cssRotate=0,this._rotate=0,this.rotateOffset=0,this.isUpdateBatching=!1,this.grabbingElement=null,this.input=new Bc(this.nativeElement,!1),this.synchronizer=new zf(this,this.selectionService)}ngAfterViewInit(){this.batchService.add(()=>this.initialize(),this.onstart)}ngOnChanges(){this.dispose(),ne.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.tabletopObject?.identifier}`,e=>{e.isSendFromSelf&&(this.input.isGrabbing||this.state!==$n.NONE)||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.stopTransition(this.targetProperty),this.setRotate(this.tabletopObject)},this)}),this.setRotate(this.tabletopObject)}ngOnDestroy(){this.dispose(),this.synchronizer.destroy(),this.input.destroy(),this.batchService.remove(this.onstart)}initialize(){this.synchronizer.initialize(),this.input.initialize(),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),this.setAnimatedTransition(!0)}cancel(){this.input.cancel(),this.grabbingElement=null,this.setAnimatedTransition(!0),this.tabletopService.tableSelecter.viewTable&&(this.tabletopService.tableSelecter.viewTable.gridHeight=0)}dispose(){ne.unregister(this),this.batchService.remove(this)}onInputStart(e){if(this.grabbingElement=e.target,this.isDisable||!this.isAllowedToRotate||e instanceof MouseEvent&&(0!==e.button||e.ctrlKey||e.shiftKey))return void this.cancel();e.stopPropagation(),this.onstart.emit(e);let i=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.nativeElement.parentElement);this.rotateOffset=this.calcRotate(i,this.rotate),this.setAnimatedTransition(!1),this.tabletopObject&&(this.tabletopService.tableSelecter.viewTable.gridHeight=this.tabletopObject.posZ+.5),this.synchronizer.prepareRotate()}onInputMove(e){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();e.cancelable&&e.preventDefault(),e.stopPropagation();let i=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.nativeElement.parentElement),r=this.calcRotate(i,this.rotateOffset);this.input.isDragging||this.ondragstart.emit(e),this.ondrag.emit(e),this.rotate=r,this.synchronizer.updateRotate()}onInputEnd(e){if(this.isDisable)return this.cancel();e.stopPropagation(),this.input.isDragging&&this.ondragend.emit(e),this.cancel(),this.snapToPolygonal(this.polygonal),this.synchronizer.finishRotate(),this.onend.emit(e)}onContextMenu(e){if(this.isDisable)return this.cancel();e.cancelable&&e.preventDefault(),this.cancel(),this.snapToPolygonal(this.polygonal)}calcRotate(e,i){let c=Math.atan2(e.y-this.nativeElement.clientHeight/2,e.x-this.nativeElement.clientWidth/2),u=(Hi.degrees(c)-i+720)%360;return u<180?u:u-360}radianFromMatrix(e,i,r,o,s,a){let c=0;if(0!==e||0!==i){let u=Math.sqrt(e*e+i*i);c=i>0?Math.acos(e/u):-Math.acos(e/u)}else if(0!==r||0!==o){let u=Math.sqrt(r*r+o*o);c=.5*Math.PI-(o>0?Math.acos(-r/u):-Math.acos(r/u))}return c}snapToPolygonal(e=24){e<=1||(this.rotate=this.rotate<0?this.rotate-180/e:this.rotate+180/e,this.rotate-=this.rotate%(360/e))}setUpdateBatching(){this.isUpdateBatching||(this.isUpdateBatching=!0,this.batchService.add(()=>{this.targetProperty=this.rotate,this.isUpdateBatching=!1})),this.updateTransformCss()}setRotate(e){e&&this.targetPropertyName in e&&(this._rotate=e[this.targetPropertyName]),this.updateTransformCss()}setAnimatedTransition(e){this.nativeElement.style.transition=e?"transform 132ms linear":""}shouldTransition(e){return this.targetProperty!==this.rotate}stopTransition(e=this.rotate){let i=window.getComputedStyle(this.nativeElement).transform;if(Math.abs(e-this.cssRotate)<180)return;let r=/matrix\(([^,]+),([^,]+),([^,]+),([^,]+),([^,]+),([^,]+)\)/gi.exec(i);if(!r)return;let o=this.radianFromMatrix(Number(r[1]),Number(r[2]),Number(r[3]),Number(r[4]),Number(r[5]),Number(r[6])),s=Hi.degrees(o),a_x=Math.cos(o),a_y=Math.sin(o),c=Hi.radians(e),u_x=Math.cos(c),f=a_x*Math.sin(c)-u_x*a_y,b=Math.abs(e-s);180<b&&(b=360-b);let C=e+(0<f?-b:b);if(C===s)return;let x=this.nativeElement.style.transition;this.nativeElement.style.transition="",this.cssRotate=C,this.nativeElement.style.transform=`${this.transformCssOffset} rotateZ(${C.toFixed(4)}deg)`,this.nativeElement.style.transform=window.getComputedStyle(this.nativeElement).transform,this.nativeElement.style.transition=x}updateTransformCss(){this.cssRotate=this.rotate;let e=`${this.transformCssOffset} rotateZ(${this.rotate.toFixed(4)}deg)`;this.nativeElement.style.transform=e}static#e=this.\u0275fac=function(i){return new(i||t)(Y(fr),Y(kC),Y(lr),Y(rh),Y(Jg),Y(Ml))};static#t=this.\u0275dir=Sn({type:t,selectors:[["","appRotable",""]],inputs:{option:[Ce.None,"rotable.option","option"],isDisable:[Ce.None,"rotable.disable","isDisable"],polygonal:[Ce.None,"rotable.polygonal","polygonal"]},outputs:{onstart:"rotable.onstart",ondragstart:"rotable.ondragstart",ondrag:"rotable.ondrag",ondragend:"rotable.ondragend",onend:"rotable.onend"},features:[hr]})}return t})();const ice=["cardImage"],rce=["translucentImage"],oce=t=>({"is-grab":t}),Tb=t=>({"is-inverse":t}),sce=(t,n)=>({"background-color":t,transform:n}),ace=t=>({"is-magnetic":t});function lce(t,n){if(1&t){const e=Le();p(0,"img",11,0),Ut(2,"safe"),he("load",function(){return V(e),H(v().onImageLoad())}),g()}if(2&t){const e=v();m("@inverse",e.state)("src",zt(2,2,e.isFront?e.frontImage.url:e.backImage.url,"resourceUrl"),bn)}}function cce(t,n){if(1&t){const e=Le();p(0,"img",11,1),Ut(2,"safe"),he("load",function(){return V(e),H(v().onImageLoad())}),g()}if(2&t){const e=v();m("@flipOpen",void 0)("src",zt(2,2,e.frontImage.url,"resourceUrl"),bn)}}function uce(t,n){if(1&t&&(p(0,"div",12),Ge(1,"div",13),Ut(2,"safe"),g()),2&t){const e=v();m("@flipOpen",void 0),h(),je("font-size",e.fontSize+9,"px")("color",e.color)("text-shadow",e.textShadowCss),m("@inverse",e.state)("innerHTML",zt(2,9,e.rubiedText,"html"),$r)}}function dce(t,n){if(1&t&&(Ue(0),p(1,"div",14)(2,"i",15),y(3),g()(),p(4,"div",16)(5,"i",15),y(6),g()(),p(7,"div",17)(8,"i",15),y(9),g()(),p(10,"div",18)(11,"i",15),y(12),g()(),Ge(13,"div",19),ze()),2&t){const e=v();h(2),m("ngClass",Ke(8,Tb,e.isInverse)),h(),Xe(e.isLocked?"lock":"autorenew"),h(2),m("ngClass",Ke(10,Tb,e.isInverse)),h(),Xe(e.isLocked?"lock":"autorenew"),h(2),m("ngClass",Ke(12,Tb,e.isInverse)),h(),Xe(e.isLocked?"lock":"autorenew"),h(2),m("ngClass",Ke(14,Tb,e.isInverse)),h(),Xe(e.isLocked?"lock":"autorenew")}}function hce(t,n){if(1&t&&(p(0,"div",20)(1,"span",21)(2,"b"),y(3),g()()()),2&t){const e=v();m("ngStyle",Tn(3,sce,e.ownerColor,"translateY("+(e.isHand?"calc("+-e.backImageClientHeight/2+"px - 75%)":"-50%")+") translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),h(),m("ngClass",Ke(6,Tb,e.isInverse)),h(2),Xe(e.ownerName)}}function fce(t,n){if(1&t&&Ge(0,"div",22),2&t){const e=v();m("ngClass",Ke(1,ace,e.isMagnetic))}}let pce=(()=>{class t{get name(){return this.card.name}get state(){return this.card.state}set state(e){this.card.state=e}get rotate(){return this.card.rotate}set rotate(e){this.card.rotate=e}get owner(){return this.card.owner}set owner(e){this.card.owner=e}get zindex(){return this.card.zindex}get size(){return Hi.clampMin(this.card.size)}get fontSize(){return this.card.fontsize}set fontSize(e){this.card.fontsize=e}get text(){return this.card.text}set text(e){this.card.text=e}get color(){return this.card.color}set color(e){this.card.color=e}get textShadowCss(){const e=ke.textShadowColor(this.color);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}get isHand(){return this.card.isHand}get isFront(){return this.card.isFront}get isVisible(){return this.card.isVisible}get hasOwner(){return this.card.hasOwner}get ownerIsOnline(){return this.card.ownerIsOnline}get ownerName(){return this.card.ownerName}get ownerColor(){return this.card.ownerColor}get isGMMode(){return this.card.isGMMode}get imageFile(){return this.imageService.getSkeletonOr(this.card.imageFile)}get frontImage(){return this.imageService.getSkeletonOr(this.card.frontImage)}get backImage(){return this.imageService.getSkeletonOr(this.card.backImage)}get selectionState(){return this.selectionService.state(this.card)}get isSelected(){return this.selectionState!==$n.NONE}get isMagnetic(){return this.selectionState===$n.MAGNETIC}get isIconHidden(){return null!=this.iconHiddenTimer}get rubiedText(){return ke.rubyToHtml(ke.escapeHtml(this.text))}get isLocked(){return!!this.card&&this.card.isLocked}set isLocked(e){this.card&&(this.card.isLocked=e)}get isInverse(){const e=Math.abs(this.viewRotateZ+this.rotate)%360;return 90<e&&e<270}get textDivTopPixcel(){return this.isFront?0:(this.backImageClientHeight-this.frontImageClientHeight)/2}get textDivHeightCss(){return this.isFront||!this.frontImageClientHeight?"100%":this.frontImageClientHeight+"px"}constructor(e,i,r,o,s,a,c,u,f,b,C){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.elementRef=o,this.changeDetector=s,this.tabletopService=a,this.selectionService=c,this.imageService=u,this.pointerDeviceService=f,this.modalService=b,this.chatMessageService=C,this.card=null,this.is3D=!1,this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.viewRotateZ=10,this.frontImageClientHeight=0,this.backImageClientHeight=0,this.interactGesture=null}ngOnChanges(){ne.unregister(this),ne.register(this).on(`UPDATE_GAME_OBJECT/aliasName/${Fe.aliasName}`,e=>{let i=bt.instance.get(e.data.identifier);this.card&&i&&i.userId===this.card.owner&&this.changeDetector.markForCheck()}).on(`UPDATE_GAME_OBJECT/identifier/${this.card?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.card?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.card?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=Fe.findByPeerId(e.data.peerId);(!i||this.card.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.card,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain","text-note"]},this.rotableOption={tabletopObject:this.card}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.interactGesture=new AS(this.elementRef.nativeElement)}),this.interactGesture.onstart=this.onInputStart.bind(this),this.interactGesture.oninteract=this.onDoubleClick.bind(this)}ngOnDestroy(){this.interactGesture.destroy(),ne.unregister(this)}onCardDrop(e){if(this.card!==e.detail&&(e.detail instanceof Ci||e.detail instanceof Vi)&&(e.stopPropagation(),e.preventDefault(),e.detail instanceof Vi)){if(this.isLocked)return;let i=e.detail;this.card.calcSqrDistance(i)<625&&(i.location.x=this.card.location.x,i.location.y=this.card.location.y,i.posZ=this.card.posZ,i.putOnBottom(this.card),this.isLocked=!1)}}onDoubleClick(){this.isLocked||this.ownerIsOnline&&!this.isHand||this.ngZone.run(()=>{this.state=this.isVisible&&!this.isHand?bs.BACK:bs.FRONT,this.owner="",this.state===bs.FRONT&&this.chatMessageService.sendOperationLog((""==this.card.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.card.name)+" \u3092\u516c\u958b"),tt.play(Te.cardDraw)})}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.ngZone.run(()=>{this.card.toTopmost()}),this.startIconHiddenTimer(),this.isLocked&&ne.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.isVisible?this.name:"\u30ab\u30fc\u30c9")}onMove(){this.contextMenuService.close(),tt.play(Te.cardPick)}onMoved(){tt.play(Te.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}onImageLoad(){this.isFront?(this.cardImageElement&&(this.frontImageClientHeight=this.cardImageElement.nativeElement.clientHeight),this.backImageClientHeight||(this.backImageClientHeight=this.frontImageClientHeight)):(this.cardImageElement&&(this.backImageClientHeight=this.cardImageElement.nativeElement.clientHeight),this.frontImageClientHeight||(this.frontImageClientHeight=this.backImageClientHeight),this.translucentImageElement&&(this.frontImageClientHeight=this.translucentImageElement.nativeElement.clientHeight))}createStack(){let e=Vi.create("\u5c71\u672d");e.location.x=this.card.location.x,e.location.y=this.card.location.y,e.posZ=this.card.posZ,e.location.name=this.card.location.name,e.rotate=this.rotate,e.zindex=this.card.zindex;let i=this.tabletopService.cards.filter(r=>this.card.calcSqrDistance(r)<1e4);i.sort((r,o)=>r.zindex<o.zindex?1:r.zindex>o.zindex?-1:0);for(let r of i)e.putOnBottom(r)}dispatchCardDropEvent(){let r=this.elementRef.nativeElement.parentElement.children,o=new CustomEvent("carddrop",{detail:this.card,bubbles:!0});for(let s=0;s<r.length;s++)r[s].dispatchEvent(o)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i={x:this.card.location.x+this.card.size*this.gridSize/2,y:this.card.location.y+this.card.size*this.gridSize/2,z:this.card.posZ};if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),this.isSelected){let r=()=>this.selectionService.objects.filter(o=>o.aliasName===this.card.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u30ab\u30fc\u30c9",action:null,subActions:[{name:"\u3059\u3079\u3066\u8868\u306b\u3059\u308b\uff08\u516c\u958b\u3059\u308b\uff09",action:()=>{const o=new Map;r().forEach(s=>{if(s.hasOwner||!s.isFront){const a=""==s.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":s.name;let c=o.get(a)||0;c+=1,o.set(a,c)}s.faceUp()}),this.chatMessageService.sendOperationLog([...o.keys()].map(s=>s+(o.get(s)<=1?"":` \xd7${o.get(s)}\u679a`)).join("\u3001")+" \u3092\u516c\u958b"),tt.play(Te.cardDraw)}},{name:"\u3059\u3079\u3066\u88cf\u306b\u3059\u308b",action:()=>{r().forEach(o=>o.faceDown()),tt.play(Te.cardDraw)}},{name:"\u3059\u3079\u3066\u81ea\u5206\u3060\u3051\u898b\u308b\uff08\u624b\u672d\u306b\u3059\u308b\uff09",action:()=>{const o=new Map;let s=0;r().forEach(c=>{if(!c.isHand)if(c.isFront){const u=""==c.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":c.name;let f=o.get(u)||0;f+=1,o.set(u,f)}else s+=1;c.faceDown(),c.owner=jt.peer.userId});const a=[...o.keys()].map(c=>c+(o.get(c)<=1?"":` \xd7${o.get(c)}\u679a`));s&&a.push(`(\u4f0f\u305b\u305f\u30ab\u30fc\u30c9)\xd7${s}\u679a`),this.chatMessageService.sendOperationLog(a.join("\u3001")+" \u3092\u81ea\u5206\u3060\u3051\u898b\u305f"),tt.play(Te.cardDraw)}}]})}return e.push(Zt),e}makeContextMenu(){let e=[];return e.push(this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,tt.play(Te.unlock)},checkBox:"check"}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,tt.play(Te.lock)},checkBox:"check"}),e.push(Zt),e.push(!this.isVisible||this.isHand?{name:this.isHand?"\u8868\u5411\u304d\u3067\u51fa\u3059\uff08\u516c\u958b\u3059\u308b\uff09":this.ownerIsOnline?"\u8868\u306b\u3059\u308b\uff08\u516c\u958b\u3059\u308b\uff09":"\u8868\u306b\u3059\u308b",action:()=>{this.card.faceUp(),this.chatMessageService.sendOperationLog((""==this.card.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.card.name)+" \u3092\u516c\u958b"),tt.play(Te.cardDraw)},default:!this.isLocked&&(!this.ownerIsOnline||this.isHand)}:{name:"\u88cf\u306b\u3059\u308b",action:()=>{this.card.faceDown(),tt.play(Te.cardDraw)},default:!this.card.isLocked&&(!this.ownerIsOnline||this.isHand)}),e.push(this.isHand?{name:"\u88cf\u5411\u304d\u3067\u51fa\u3059",action:()=>{this.card.faceDown(),tt.play(Te.cardDraw)}}:{name:"\u81ea\u5206\u3060\u3051\u898b\u308b\uff08\u624b\u672d\u306b\u3059\u308b\uff09",action:()=>{tt.play(Te.cardDraw),this.chatMessageService.sendOperationLog(`${this.card.isFront?""==this.card.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.card.name:"(\u4f0f\u305b\u305f\u30ab\u30fc\u30c9)"} \u3092\u81ea\u5206\u3060\u3051\u898b\u305f`),this.card.faceDown(),this.owner=jt.peer.userId}}),e.push(Zt),e.push({name:"\u53f3\u56de\u8ee2",action:()=>{this.turnRight()},materialIcon:"turn_right",hotkey:"R",disabled:this.isLocked},{name:"\u5de6\u56de\u8ee2",action:()=>{this.turnLeft()},materialIcon:"turn_left",hotkey:"Shift+R",disabled:this.isLocked}),this.card.isVisible&&e.push(Zt,{name:"\u6b63\u4f4d\u7f6e(0\xb0)\u306b\u3059\u308b",action:()=>{this.vertical()},hotkey:"U",disabled:!this.card.isVisible||this.isLocked||0==this.card.rotate},{name:"\u6a2a\u5411\u304d(90\xb0)\u306b\u3059\u308b",action:()=>{this.horizontal()},hotkey:"T",disabled:!this.card.isVisible||this.isLocked||90==this.card.rotate}),e.push(Zt),e.push({name:"\u91cd\u306a\u3063\u305f\u30ab\u30fc\u30c9\u3067\u5c71\u672d\u3092\u4f5c\u308b",action:()=>{this.createStack(),tt.play(Te.cardPut)},disabled:this.isLocked}),e.push(Zt),e.push({name:"\u30ab\u30fc\u30c9\u3092\u7de8\u96c6...",action:()=>{this.showDetail(this.card)}}),this.isVisible&&this.card.getUrls().length>0&&(e.push({name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.card.getUrls().map(i=>{const r=i.value.toString();return{name:i.name?i.name:r,action:()=>{ke.sameOrigin(r)?window.open(r.trim(),"_blank","noopener"):this.modalService.open(sa,{url:r,title:this.card.name,subTitle:i.name})},disabled:!ke.validUrl(r),error:ke.validUrl(r)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:ke.validUrl(r)&&!ke.sameOrigin(r)}})}),e.push(Zt)),e.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let i=this.card.clone();i.location.x+=this.gridSize,i.location.y+=this.gridSize,i.toTopmost(),i.isLocked=!1,tt.play(Te.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.card.destroy(),tt.play(Te.sweep)}}),e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}vertical(){!this.card.isVisible||0==this.card.rotate||(this.card.rotate=0,tt.play(Te.cardPut))}horizontal(){!this.card.isVisible||90==this.card.rotate||(this.card.rotate=90,tt.play(Te.cardPut))}turnRight(){this.card.rotate+=45,tt.play(Te.cardPut)}turnLeft(){this.card.rotate-=45,tt.play(Te.cardPut)}showDetail(e){ne.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(r+=" - "+(this.isVisible?e.name:"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09")),this.panelService.open(kl,{title:r,left:i.x-300,top:i.y-300,width:600,height:490}).tabletopObject=e}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Pn),Y(Bo),Y(yi),Y(fr),Y(Zr),Y(Jg),Y(Ml),Y(tm),Y(lr),Y(Ei),Y(vo))};static#t=this.\u0275cmp=In({type:t,selectors:[["card"]],viewQuery:function(i,r){if(1&i&&(Ln(ice,5),Ln(rce,5)),2&i){let o;Bn(o=Un())&&(r.cardImageElement=o.first),Bn(o=Un())&&(r.translucentImageElement=o.first)}},hostBindings:function(i,r){1&i&&he("carddrop",function(s){return r.onCardDrop(s)})("dragstart",function(s){return r.onDragstart(s)})("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{card:"card",is3D:"is3D"},features:[hr],decls:10,vars:27,consts:[["cardImage",""],["translucentImage",""],["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.ondragstart","movable.ondragend","keyup.t","keyup.r","keyup.u","keyup.shift.r","ngClass","movable.option","movable.disable"],[1,"is-3d"],["appRotable","",1,"component-content","is-pointer-events-auto","is-3d",3,"rotable.ondragstart","rotable.ondragend","rotable.option","rotable.disable"],["class","card-image is-3d chrome-smooth-image-trick",3,"src","load",4,"ngIf"],[1,"is-3d","is-pointer-events-none",2,"position","absolute"],["style","position: absolute","class","card-image text is-3d",4,"ngIf"],[4,"ngIf"],["class","name-tag is-nowrap has-length-limit is-pointer-events-none is-black-background is-3d",3,"ngStyle",4,"ngIf"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"card-image","is-3d","chrome-smooth-image-trick",3,"load","src"],[1,"card-image","text","is-3d",2,"position","absolute"],[1,"is-3d",3,"innerHTML"],[1,"rotate-grab","of-left-top","is-3d"],[1,"material-icons",2,"display","inline-block",3,"ngClass"],[1,"rotate-grab","of-left-bottom","is-3d"],[1,"rotate-grab","of-right-bottom","is-3d"],[1,"rotate-grab","of-right-top","is-3d"],[1,"border-bg","is-pointer-events-none","is-3d"],[1,"name-tag","is-nowrap","has-length-limit","is-pointer-events-none","is-black-background","is-3d",3,"ngStyle"],[1,"is-3d",2,"display","inline-block",3,"ngClass"],[1,"selected-highlight",3,"ngClass"]],template:function(i,r){1&i&&(p(0,"div",2),he("movable.ondragstart",function(){return r.onMove()})("movable.ondragend",function(){return r.onMoved()})("keyup.t",function(){return r.horizontal()})("keyup.r",function(){return r.turnRight()})("keyup.u",function(){return r.vertical()})("keyup.shift.r",function(){return r.turnLeft()}),p(1,"div",3)(2,"div",4),he("rotable.ondragstart",function(){return r.onMove()})("rotable.ondragend",function(){return r.onMoved()}),q(3,lce,3,5,"img",5),p(4,"div",6),q(5,cce,3,5,"img",5)(6,uce,3,12,"div",7),g(),q(7,dce,14,16,"ng-container",8)(8,hce,4,8,"div",9)(9,fce,1,3,"div",10),g()()()),2&i&&(je("width",r.size*r.gridSize,"px"),m("ngClass",Ke(25,oce,!r.isLocked))("movable.option",r.movableOption)("movable.disable",r.isLocked),en("tabindex",r.isLocked?null:-1),h(),m("@slidInOut",void 0),h(),m("rotable.option",r.rotableOption)("rotable.disable",r.isLocked),h(),m("ngIf",r.imageFile),h(),je("opacity",r.isFront?1:.8)("transform",r.isFront?"":"scale(0.9)")("top",r.textDivTopPixcel,"px")("width",r.size*r.gridSize,"px")("height",r.textDivHeightCss),h(),m("ngIf",!r.isFront&&(r.isHand||r.isGMMode)&&r.frontImage),h(),m("ngIf",r.isFront||r.isHand||r.isGMMode),h(),m("ngIf",!r.isIconHidden),h(),m("ngIf",!r.isFront&&r.ownerIsOnline&&0<r.ownerName.length),h(),m("ngIf",r.isSelected))},dependencies:[Ni,ri,Lo,is,Hf,cr],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:auto;width:auto;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;min-width:25px;min-height:25px}.component-content[_ngcontent-%COMP%]{backface-visibility:hidden;height:100%;width:100%;box-sizing:border-box}.card-image[_ngcontent-%COMP%]{display:block;inset:0;margin:auto;height:auto;width:100%;backface-visibility:hidden}.thumbnail-transform[_ngcontent-%COMP%]{position:absolute;transform:scale(.9)}.is-translucent[_ngcontent-%COMP%]{filter:opacity(.8);z-index:2}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;z-index:11}.rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5;transform-style:preserve-3d;transform:translateZ(.01px)}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-10px;left:-10px;border-radius:14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-10px;left:-10px;border-radius:14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-10px;right:-10px;border-radius:14px}.of-right-top[_ngcontent-%COMP%]{top:-10px;right:-10px;border-radius:14px}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;position:absolute;box-sizing:border-box;border-radius:3px;background-color:#80d4ff99;inset:0}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.border-bg[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;border-radius:8px;background-color:#cccccc80;inset:-2px;z-index:-1}.border-bg[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .border-bg[_ngcontent-%COMP%]{display:block}.component[_ngcontent-%COMP%]:active   .border-bg[_ngcontent-%COMP%]{display:none}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:50%;color:#f5f5f5!important;opacity:.9;z-index:10;backface-visibility:hidden}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.text[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;backface-visibility:hidden;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.is-inverse[_ngcontent-%COMP%]{transform:rotate(180deg)}.component[_ngcontent-%COMP%]:hover   .name-tag[_ngcontent-%COMP%]{visibility:hidden}"],data:{animation:[Xn("inverse",[RI("inverse",We({transform:""})),an(":increment, :decrement",[rn("200ms ease",En([We({transform:"scale3d(1.0, 1.0, 1.0)",offset:0}),We({transform:"scale3d(0.6, 1.2, 1.2)",offset:.5}),We({transform:"scale3d(0, 0.75, 0.75)",offset:.75}),We({transform:"scale3d(0.5, 1.125, 1.125)",offset:.875}),We({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])]),Xn("flipOpen",[an(":enter",[rn("200ms ease",En([We({transform:"scale3d(0, 1.0, 1.0)",offset:0}),We({transform:"scale3d(0, 1.2, 1.2)",offset:.5}),We({transform:"scale3d(0, 0.75, 0.75)",offset:.75}),We({transform:"scale3d(0.5, 1.125, 1.125)",offset:.875}),We({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])]),Xn("slidInOut",[an("void => *",[rn("200ms ease",En([We({"transform-origin":"left center",transform:"scale3d(0, 1.0, 1.0)",offset:0}),We({"transform-origin":"left center",transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),an("* => void",[rn(100,We({"transform-origin":"left center",transform:"scale3d(0, 1.0, 1.0)"}))])])]},changeDetection:0})}return t})();const gce=["draggablePanel"],mce=["cardImage"],_ce=["fullCardImage"],bce=["textArea"],U5=t=>({card:t}),vce=t=>({note:t}),yce=t=>({character:t}),Cce=t=>({dice:t}),xce=t=>({range:t}),wce=t=>({object:t}),Us=(t,n)=>({"is-pointer-events-auto":t,"pointer-events-none":n}),z5=t=>({"with-button-marign":t}),H5=t=>({transform:t}),cm=(t,n)=>({dataElm:t,name:n}),Ece=t=>({"hide-text-area":t}),Ice=t=>({"hide-area":t}),Tce=(t,n,e)=>({"has-icon":t,"is-pointer-events-auto":n,"pointer-events-none":e}),Sce=t=>({transform:t}),V5=(t,n)=>({inverse:t,hollow:n}),j5=(t,n,e,i,r,o,s,a)=>({black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}),G5=t=>({"black-paint":t}),Mce=(t,n)=>({"is-black-mask":t,"is-harf-black-mask":n}),Dce=(t,n)=>({"outer-link":t,invalid:n}),kce=t=>({"min-width":t});function Oce(t,n){1&t&&ii(0)}function Ace(t,n){1&t&&ii(0)}function Pce(t,n){if(1&t&&(Ue(0),q(1,Ace,1,0,"ng-container",19),ze()),2&t){const e=v(),i=pn(13);h(),m("ngTemplateOutlet",i)("ngTemplateOutletContext",Ke(2,U5,e.tabletopObject))}}function Fce(t,n){1&t&&ii(0)}function Nce(t,n){if(1&t&&(Ue(0),q(1,Fce,1,0,"ng-container",19),ze()),2&t){const e=v(),i=pn(13);h(),m("ngTemplateOutlet",i)("ngTemplateOutletContext",Ke(2,U5,e.tabletopObject))}}function Rce(t,n){1&t&&ii(0)}function Lce(t,n){if(1&t&&(Ue(0),q(1,Rce,1,0,"ng-container",19),ze()),2&t){const e=v(),i=pn(15);h(),m("ngTemplateOutlet",i)("ngTemplateOutletContext",Ke(2,vce,e.tabletopObject))}}function Bce(t,n){1&t&&ii(0)}function Uce(t,n){if(1&t&&(Ue(0),q(1,Bce,1,0,"ng-container",19),ze()),2&t){const e=v(),i=pn(17);h(),m("ngTemplateOutlet",i)("ngTemplateOutletContext",Ke(2,yce,e.tabletopObject))}}function zce(t,n){1&t&&ii(0)}function Hce(t,n){if(1&t&&(Ue(0),q(1,zce,1,0,"ng-container",19),ze()),2&t){const e=v(),i=pn(19);h(),m("ngTemplateOutlet",i)("ngTemplateOutletContext",Ke(2,Cce,e.tabletopObject))}}function Vce(t,n){1&t&&ii(0)}function jce(t,n){if(1&t&&(Ue(0),q(1,Vce,1,0,"ng-container",19),ze()),2&t){const e=v(),i=pn(21);h(),m("ngTemplateOutlet",i)("ngTemplateOutletContext",Ke(2,xce,e.tabletopObject))}}function Gce(t,n){1&t&&ii(0)}function Wce(t,n){if(1&t&&(Ue(0),q(1,Gce,1,0,"ng-container",19),ze()),2&t){const e=v(),i=pn(23);h(),m("ngTemplateOutlet",i)("ngTemplateOutletContext",Ke(2,wce,e.tabletopObject))}}function $ce(t,n){1&t&&ii(0)}function Yce(t,n){if(1&t&&(Ue(0),q(1,$ce,1,0,"ng-container",20),ze()),2&t){v();const e=pn(27);h(),m("ngTemplateOutlet",e)}}function Zce(t,n){if(1&t&&(p(0,"div",32),Ge(1,"div",33),Ut(2,"safe"),g()),2&t){const e=v(3);je("width",e.imageAreaRect.width,"px")("height",e.imageAreaRect.height,"px")("left",e.imageAreaRect.left,"px"),m("ngStyle",Ke(17,H5,"scale("+e.imageAreaRect.scale+")")),h(),je("font-size",e.cardFontSize,"px")("color",e.cardColor)("text-shadow",e.cardTextShadowCss),m("innerHTML",zt(2,14,e.cardText,"html"),$r)}}function qce(t,n){if(1&t&&(p(0,"div",34)(1,"div",35),y(2),g()()),2&t){const e=v(2).card,i=v();m("ngClass",Ke(4,z5,i.hasImage)),h(),je("background-color",e.ownerColor),h(),Xe(e.ownerName)}}function Xce(t,n){if(1&t){const e=Le();p(0,"div",26),q(1,Zce,3,19,"div",27),p(2,"img",28,9),Ut(4,"safe"),he("load",function(){return V(e),H(v(2).onCardImageLoad())}),g(),p(5,"button",29),he("click",function(){return V(e),H(v(2).chanageImageView(!0))}),p(6,"i",30),y(7,"zoom_in"),g()(),q(8,qce,3,6,"div",31),g()}if(2&t){const e=v().card,i=v();h(),m("ngIf","card"==e.aliasName&&i.cardState!==i.CardStateBack&&(i.cardState==i.CardStateFront||e.isFront||e.isHand||e.isGMMode)||"card-stack"==e.aliasName&&e.topCard.isFront),h(),m("src",zt(4,3,i.imageUrl,"resourceUrl"),bn),h(6),m("ngIf",e.ownerIsOnline&&0<e.ownerName.length)}}function Kce(t,n){if(1&t&&(Ue(0),y(1),ze()),2&t){const e=v().card;h(),Xe(e.name)}}function Qce(t,n){1&t&&(Ue(0),y(1," \u306e\u30c8\u30c3\u30d7"),ze())}function Jce(t,n){1&t&&(Ue(0),y(1,"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09"),ze())}function eue(t,n){1&t&&ii(0)}function tue(t,n){if(1&t&&(Ue(0),q(1,eue,1,0,"ng-container",19),ze()),2&t){const e=n.$implicit,i=v(2).card;v();const r=pn(25);h(),m("ngTemplateOutlet",r)("ngTemplateOutletContext",Tn(2,cm,e,i.name))}}function nue(t,n){if(1&t&&(p(0,"div",36)(1,"div",37),q(2,tue,2,5,"ng-container",38),g()()),2&t){const e=v(2);h(2),m("ngForOf",e.dataElms)}}function iue(t,n){if(1&t&&(p(0,"div",21),q(1,Xce,9,6,"div",22),p(2,"div",23),q(3,Kce,2,1,"ng-container",18)(4,Qce,2,0,"ng-container",18)(5,Jce,2,0,"ng-container",18),g(),p(6,"div",24),q(7,nue,3,1,"div",25),g()()),2&t){const e=n.card,i=v();m("ngClass",Tn(7,Us,!i.isPointerDragging,i.isPointerDragging)),h(),m("ngIf",i.hasImage),h(),m("ngClass",Ke(10,z5,i.hasImage)),h(),m("ngIf",i.cardState!==i.CardStateBack&&(i.cardState===i.CardStateFront||null==e.isVisible||e.isVisible||e.isGMMode)),h(),m("ngIf","card-stack"==e.aliasName&&!e.isEmpty),h(),m("ngIf",i.cardState!==i.CardStateFront&&(i.cardState===i.CardStateBack||null!=e.isVisible&&!e.isVisible&&!e.isGMMode)),h(2),m("ngIf",i.hasDataElms&&(e.isVisible||e.isGMMode))}}function rue(t,n){if(1&t){const e=Le();p(0,"div",39)(1,"div",40),y(2),g(),p(3,"div",41)(4,"div",42),he("mousedown",function(){return V(e),H(v().textAreaActivate())}),p(5,"div",43)(6,"textarea",44,10),at("ngModelChange",function(r){const o=V(e).note;return it(o.text,r)||(o.text=r),H(r)}),g()(),Ge(8,"div",45),Ut(9,"safe"),Ge(10,"div",46),Ut(11,"safe"),g()()()}if(2&t){const e=n.note,i=v();m("ngClass",Tn(13,Us,!i.isPointerDragging,i.isPointerDragging)),h(2),Xe(e.title),h(4),st("ngModel",e.text),m("ngClass",Ke(16,Ece,!i.isSelected)),h(2),m("innerHTML",zt(9,7,i.adjustedRubiedNote(e.text),"html"),$r)("ngClass",Ke(18,Ice,i.isSelected)),h(2),m("innerHTML",zt(11,10,i.adjustedRubiedNote(e.text,!i.isSelected),"html"),$r)}}function oue(t,n){if(1&t&&(Ue(0),p(1,"div",54)(2,"div",55)(3,"span",56),Ge(4,"img",57),Ut(5,"safe"),g()()(),ze()),2&t){const e=v(3);h(),m("ngStyle",Ke(8,Sce,"rotate("+e.roll+"deg)")),h(),m("ngClass",Tn(10,V5,e.isInverse,e.isHollow)),h(),m("ngClass",Yl(13,j5,0==e.aura,1==e.aura,2==e.aura,3==e.aura,4==e.aura,5==e.aura,6==e.aura,7==e.aura)),h(),m("ngClass",Ke(22,G5,e.isBlackPaint))("src",zt(5,5,e.imageUrl,"resourceUrl"),bn)}}function sue(t,n){if(1&t&&(Ue(0),Ge(1,"img",58),Ut(2,"safe"),ze()),2&t){const e=v(3);h(),m("src",zt(2,1,e.imageUrl,"resourceUrl"),bn)}}function aue(t,n){if(1&t&&(p(0,"div",53),q(1,oue,6,24,"ng-container",18)(2,sue,3,4,"ng-container",18),g()),2&t){const e=v(2);m("ngClass",Qs(3,Tce,e.isUseIcon,!e.isPointerDragging,e.isPointerDragging)),h(),m("ngIf",!e.isUseIcon),h(),m("ngIf",e.isUseIcon)}}function lue(t,n){1&t&&ii(0)}function cue(t,n){if(1&t&&(Ue(0),p(1,"div",37),q(2,lue,1,0,"ng-container",19),g(),ze()),2&t){const e=v().$implicit,i=v(2).character;v();const r=pn(25);h(2),m("ngTemplateOutlet",r)("ngTemplateOutletContext",Tn(2,cm,e,i.name))}}function uue(t,n){if(1&t&&(Ue(0),q(1,cue,3,5,"ng-container",18),ze()),2&t){const e=n.$implicit,i=v(3);h(),m("ngIf",e&&!i.newLineStrings.includes(e.name))}}function due(t,n){if(1&t&&(p(0,"div",36),q(1,uue,2,1,"ng-container",38),g()),2&t){const e=v(2);h(),m("ngForOf",e.inventoryDataElms)}}function hue(t,n){if(1&t&&(p(0,"div",47),Ge(1,"div",48),q(2,aue,3,7,"div",49),p(3,"div",50),y(4),g(),Ge(5,"div",51),p(6,"div",52),q(7,due,2,1,"div",25),g()()),2&t){const e=n.character,i=v();h(),m("ngClass",Tn(6,Us,!i.isPointerDragging,i.isPointerDragging)),h(),m("ngIf",i.hasImage),h(),m("ngClass",Tn(9,Us,!i.isPointerDragging,i.isPointerDragging)),h(),Xe(e.name),h(2),m("ngClass",Tn(12,Us,!i.isPointerDragging,i.isPointerDragging)),h(),m("ngIf",i.hasDataElms)}}function fue(t,n){if(1&t&&(Ue(0),y(1),ze()),2&t){const e=v().dice;h(),Si("",e.name,":")}}function pue(t,n){if(1&t&&(Ue(0),y(1),ze()),2&t){const e=v().dice;h(),Xe(e.face)}}function gue(t,n){1&t&&(Ue(0),y(1,"???"),ze())}function mue(t,n){if(1&t&&(p(0,"div",60)(1,"div",35),y(2),g()()),2&t){const e=v().dice,i=v();m("ngClass",Tn(4,Us,!i.isPointerDragging,i.isPointerDragging)),h(),je("background-color",e.ownerColor),h(),Si("",e.ownerName," ")}}function _ue(t,n){if(1&t&&(p(0,"div",53),Ge(1,"img",61),Ut(2,"safe"),g()),2&t){const e=v().dice,i=v();m("ngClass",Tn(6,Us,!i.isPointerDragging,i.isPointerDragging)),h(),m("ngClass",Tn(9,Mce,!e.isVisible,e.isMine||e.isGMMode&&e.hasOwner))("src",zt(2,3,i.imageUrl,"resourceUrl"),bn)}}function bue(t,n){1&t&&ii(0)}function vue(t,n){if(1&t&&(Ue(0),q(1,bue,1,0,"ng-container",19),ze()),2&t){const e=v().$implicit,i=v(2).dice;v();const r=pn(25);h(),m("ngTemplateOutlet",r)("ngTemplateOutletContext",Tn(2,cm,e,i.name))}}function yue(t,n){if(1&t&&(Ue(0),q(1,vue,2,5,"ng-container",18),ze()),2&t){const e=n.$implicit,i=v(3);h(),m("ngIf",e&&!i.newLineStrings.includes(e.name))}}function Cue(t,n){if(1&t&&(p(0,"div",36)(1,"div",37),q(2,yue,2,1,"ng-container",38),g()()),2&t){const e=v(2);h(2),m("ngForOf",e.dataElms)}}function xue(t,n){if(1&t&&(p(0,"div",47),Ge(1,"div",48),p(2,"div",50),q(3,fue,2,1,"ng-container",18)(4,pue,2,1,"ng-container",18)(5,gue,2,0,"ng-container",18),g(),q(6,mue,3,7,"div",59)(7,_ue,3,12,"div",49),Ge(8,"div",51),p(9,"div",52),q(10,Cue,3,1,"div",25),g()()),2&t){const e=n.dice,i=v();h(),m("ngClass",Tn(9,Us,!i.isPointerDragging,i.isPointerDragging)),h(),m("ngClass",Tn(12,Us,!i.isPointerDragging,i.isPointerDragging)),h(),m("ngIf",0<(null==e||null==e.name?null:e.name.length)),h(),m("ngIf",e.isVisible),h(),m("ngIf",!e.isVisible),h(),m("ngIf",e.hasOwner&&0<e.ownerName.length),h(),m("ngIf",i.hasImage),h(2),m("ngClass",Tn(15,Us,!i.isPointerDragging,i.isPointerDragging)),h(),m("ngIf",i.hasDataElms&&e.isVisible)}}function wue(t,n){if(1&t){const e=Le();Ue(0),p(1,"div",63),y(2),g(),p(3,"div",64)(4,"div",65)(5,"div",66),y(6),g(),p(7,"input",67),at("ngModelChange",function(r){V(e);const o=v().$implicit;return it(o.value,r)||(o.value=r),H(r)}),g()()(),p(8,"div",68)(9,"input",69),Ut(10,"safe"),at("ngModelChange",function(r){V(e);const o=v().$implicit;return it(o.value,r)||(o.value=r),H(r)}),g()(),ze()}if(2&t){const e=v().$implicit;h(),en("title",e.name),h(),Xe(e.name),h(4),Xe(e.value),h(),st("ngModel",e.value),h(2),ms(zt(10,9,"font-size: 0.8em; width: 100%; --min: 0; --max:"+e.value+"; --val:"+e.currentValue+";","style")),Et("title",e.value),m("min","length"==e.name?1:0),st("ngModel",e.value)}}function Eue(t,n){if(1&t){const e=Le();Ue(0),p(1,"div",63),y(2),g(),p(3,"div",64)(4,"div",65)(5,"div",66),y(6),g(),p(7,"input",70),at("ngModelChange",function(r){V(e);const o=v().$implicit;return it(o.currentValue,r)||(o.currentValue=r),H(r)}),g(),p(8,"b",71),y(9,"%"),g()()(),p(10,"div",68)(11,"input",72),Ut(12,"safe"),at("ngModelChange",function(r){V(e);const o=v().$implicit;return it(o.currentValue,r)||(o.currentValue=r),H(r)}),g()(),ze()}if(2&t){const e=v().$implicit;h(),en("title",e.name),h(),Xe(e.name),h(4),Xe(e.currentValue),h(),st("ngModel",e.currentValue),h(4),ms(zt(12,9,"font-size: 0.8em; width: 100%; --min: 0; --max:"+e.value+"; --val:"+e.currentValue+";","style")),go("title","",e.currentValue,"%"),st("ngModel",e.currentValue)}}function Iue(t,n){if(1&t&&(Ue(0),q(1,wue,11,12,"ng-container",18)(2,Eue,13,12,"ng-container",18),ze()),2&t){const e=n.$implicit;h(),m("ngIf","length"==e.name||"width"==e.name),h(),m("ngIf","opacity"==e.name)}}function Tue(t,n){if(1&t&&(Ue(0),p(1,"div",73),y(2),g(),p(3,"div",74)(4,"div",75)(5,"span",76),Ge(6,"img",77),Ut(7,"safe"),g()()(),ze()),2&t){const e=v(2).range;h(2),Si("\u27a1 ",e.followingCharactor.name,""),h(2),m("ngClass",Tn(8,V5,e.followingCharactor.isInverse,e.followingCharactor.isHollow)),h(),m("ngClass",Yl(11,j5,0==e.followingCharactor.aura,1==e.followingCharactor.aura,2==e.followingCharactor.aura,3==e.followingCharactor.aura,4==e.followingCharactor.aura,5==e.followingCharactor.aura,6==e.followingCharactor.aura,7==e.followingCharactor.aura)),h(),m("ngClass",Ke(20,G5,e.followingCharactor.isBlackPaint))("src",zt(7,5,e.followingCharactor.imageFile.url,"resourceUrl"),bn)}}function Sue(t,n){1&t&&Ge(0,"div",78)}function Mue(t,n){1&t&&ii(0)}function Due(t,n){if(1&t&&(Ue(0),q(1,Mue,1,0,"ng-container",19),ze()),2&t){const e=v().$implicit,i=v(2).range;v();const r=pn(25);h(),m("ngTemplateOutlet",r)("ngTemplateOutletContext",Tn(2,cm,e,i.name))}}function kue(t,n){if(1&t&&(Ue(0),q(1,Due,2,5,"ng-container",18),ze()),2&t){const e=n.$implicit,i=v(3);h(),m("ngIf",e&&!i.newLineStrings.includes(e.name))}}function Oue(t,n){if(1&t&&(p(0,"div",36)(1,"div",37),q(2,Iue,3,2,"ng-container",38)(3,Tue,8,22,"ng-container",18)(4,Sue,1,0,"div",62)(5,kue,2,1,"ng-container",38),g()()),2&t){const e=v().range,i=v();h(2),m("ngForOf",i.rangeElms),h(),m("ngIf",e.followingCharactor),h(),m("ngIf",i.dataElms.length>0),h(),m("ngForOf",i.dataElms)}}function Aue(t,n){if(1&t&&(p(0,"div",47),Ge(1,"div",48),p(2,"div",50),y(3),g(),Ge(4,"div",51),p(5,"div",52),q(6,Oue,6,4,"div",25),g()()),2&t){const e=n.range,i=v();h(),m("ngClass",Tn(5,Us,!i.isPointerDragging,i.isPointerDragging)),h(),m("ngClass",Tn(8,Us,!i.isPointerDragging,i.isPointerDragging)),h(),Xe(e.name),h(2),m("ngClass",Tn(11,Us,!i.isPointerDragging,i.isPointerDragging)),h(),m("ngIf",i.rangeElms.length>0)}}function Pue(t,n){1&t&&ii(0)}function Fue(t,n){if(1&t&&(Ue(0),q(1,Pue,1,0,"ng-container",19),ze()),2&t){const e=v().$implicit,i=v().object;v();const r=pn(25);h(),m("ngTemplateOutlet",r)("ngTemplateOutletContext",Tn(2,cm,e,i.name))}}function Nue(t,n){if(1&t&&(Ue(0),q(1,Fue,2,5,"ng-container",18),ze()),2&t){const e=n.$implicit,i=v(2);h(),m("ngIf",e&&!i.newLineStrings.includes(e.name))}}function Rue(t,n){if(1&t&&(p(0,"div",47),Ge(1,"div",48),p(2,"div",50),y(3),g(),Ge(4,"div",51),p(5,"div",52)(6,"div",36)(7,"div",37),q(8,Nue,2,1,"ng-container",38),g()()()()),2&t){const e=n.object,i=v();h(),m("ngClass",Tn(5,Us,!i.isPointerDragging,i.isPointerDragging)),h(),m("ngClass",Tn(8,Us,!i.isPointerDragging,i.isPointerDragging)),h(),Xe(e.name),h(2),m("ngClass",Tn(11,Us,!i.isPointerDragging,i.isPointerDragging)),h(3),m("ngForOf",i.dataElms)}}function Lue(t,n){1&t&&ii(0)}function Bue(t,n){if(1&t&&(p(0,"div",83),y(1),g()),2&t){const e=v(2).dataElm;en("title",e.name),h(),Xe(e.name)}}function Uue(t,n){1&t&&ii(0)}function zue(t,n){if(1&t&&(Ue(0),q(1,Uue,1,0,"ng-container",19),ze()),2&t){const e=n.$implicit,i=v(2).name;v();const r=pn(25);h(),m("ngTemplateOutlet",r)("ngTemplateOutletContext",Tn(2,cm,e,i))}}function Hue(t,n){if(1&t&&(p(0,"div",80),q(1,Bue,2,2,"div",81),p(2,"div",82),q(3,zue,2,5,"ng-container",38),g()()),2&t){const e=v().dataElm;h(),m("ngIf",0<e.name.trim().length),h(2),m("ngForOf",e.children)}}function Vue(t,n){if(1&t){const e=Le();Ue(0),p(1,"div",85)(2,"div"),y(3),g(),p(4,"div",86)(5,"div",43)(6,"textarea",87),at("ngModelChange",function(r){V(e);const o=v(2).dataElm;return it(o.value,r)||(o.value=r),H(r)}),g()(),p(7,"div",88),y(8),g()()(),ze()}if(2&t){const e=v(2).dataElm;h(2),en("title",e.name),h(),Xe(e.name),h(3),st("ngModel",e.value),h(2),Xe(e.value)}}function jue(t,n){if(1&t){const e=Le();Ue(0),p(1,"div",73),y(2),g(),p(3,"div",64)(4,"div",89),y(5),g(),p(6,"input",90),at("ngModelChange",function(r){V(e);const o=v(2).dataElm;return it(o.value,r)||(o.value=r),H(r)}),g()(),ze()}if(2&t){const e=v(2),i=e.dataElm,r=e.name,o=v();h(),en("title",i.name),h(),Xe(i.name),h(3),Xe(i.value),h(),Et("type",i.value&&i.value==+i.value?"number":"text"),m("logging.name",r)("logging.dataElement",i)("logging.disable",o.isNoLogging),st("ngModel",i.value)}}function Gue(t,n){if(1&t){const e=Le();Ue(0),p(1,"div",63),y(2),g(),p(3,"div",64)(4,"div",65)(5,"div",66),y(6),g(),p(7,"input",91),at("ngModelChange",function(r){V(e);const o=v(2).dataElm;return it(o.currentValue,r)||(o.currentValue=r),H(r)}),g()(),p(8,"div",92),y(9),g()(),p(10,"div",68)(11,"input",93),Ut(12,"safe"),at("ngModelChange",function(r){V(e);const o=v(2).dataElm;return it(o.currentValue,r)||(o.currentValue=r),H(r)}),g()(),ze()}if(2&t){const e=v(2),i=e.dataElm,r=e.name,o=v();h(),en("title",i.name),h(),Xe(i.name),h(4),Xe(i.currentValue),h(),m("logging.name",r)("logging.dataElement",i)("logging.disable",o.isNoLogging),st("ngModel",i.currentValue),h(2),Si(" / ",+i.value?i.value:"???",""),h(2),ms(zt(12,16,"font-size: 0.8em; width: 100%; --min: 0; --max:"+i.value+"; --val:"+i.currentValue+";","style")),Et("title",i.currentValue),Et("max",+i.value?i.value:1e3),m("logging.name",r)("logging.dataElement",i)("logging.disable",o.isNoLogging),st("ngModel",i.currentValue)}}function Wue(t,n){if(1&t){const e=Le();Ue(0),p(1,"div",73)(2,"span"),y(3),g(),y(4),g(),p(5,"div",64)(6,"input",94),at("ngModelChange",function(r){V(e);const o=v(2).dataElm;return it(o.value,r)||(o.value=r),H(r)}),he("change",function(){V(e);const r=v(2).dataElm;return H(r.value=r.value?r.name:"")}),g()(),ze()}if(2&t){const e=v(2),i=e.dataElm,r=e.name,o=v();h(),en("title",i.name),h(),je("text-decoration",i.value?"none":"line-through"),h(),Xe(i.name),h(),Si(" ",o.checkValue(i),""),h(2),Et("checked",i.value?"checked":""),m("logging.name",r)("logging.dataElement",i)("logging.disable",o.isNoLogging),st("ngModel",i.value)}}function $ue(t,n){if(1&t&&(p(0,"span",96),y(1),g()),2&t){const e=v(3).dataElm;h(),Si("(",(e.calcAbilityScore()>=0?"+":"")+e.calcAbilityScore(),")")}}function Yue(t,n){if(1&t){const e=Le();Ue(0),p(1,"div",73),y(2),g(),p(3,"div",64)(4,"div",89),y(5),g(),p(6,"input",90),at("ngModelChange",function(r){V(e);const o=v(2).dataElm;return it(o.value,r)||(o.value=r),H(r)}),g(),q(7,$ue,2,1,"span",95),g(),ze()}if(2&t){const e=v(2),i=e.dataElm,r=e.name,o=v();h(),en("title",i.name),h(),Xe(i.name),h(3),Xe(i.value),h(),Et("type",i.value&&i.value==+i.value?"number":"text"),m("logging.name",r)("logging.dataElement",i)("logging.disable",o.isNoLogging),st("ngModel",i.value),h(),m("ngIf",i.currentValue)}}function Zue(t,n){1&t&&(p(0,"span",100),y(1,"\u26a0\ufe0f"),g())}function que(t,n){if(1&t){const e=Le();Ue(0),p(1,"div",73),q(2,Zue,2,0,"span",97),p(3,"a",98),Ut(4,"safe"),he("click",function(){V(e);const r=v(2),o=r.dataElm,s=r.name,a=v();return H(!!a.stringUtil.validUrl(o.value)&&a.openUrl(o.value,s,o.name))}),p(5,"span",99),y(6),g()()(),ze()}if(2&t){const e=v(2).dataElm,i=v();h(2),m("ngIf",!i.stringUtil.validUrl(e.value)),h(),m("ngClass",Tn(9,Dce,!i.stringUtil.sameOrigin(e.value)&&i.stringUtil.validUrl(e.value),!i.stringUtil.validUrl(e.value))),en("title",e.value)("href",zt(4,6,i.stringUtil.validUrl(e.value)?e.value:"","url"),bn)("disabled",i.stringUtil.validUrl(e.value)?null:""),h(3),Xe(e.name)}}function Xue(t,n){if(1&t&&(p(0,"div",73),y(1),g()),2&t){const e=v(3).dataElm;en("title",e.name),h(),Xe(e.name)}}function Kue(t,n){if(1&t&&(p(0,"div",89),y(1),g()),2&t){const e=v(3).dataElm;h(),Xe(e.value)}}function Que(t,n){if(1&t){const e=Le();Ue(0),q(1,Xue,2,2,"div",101),p(2,"div",64),q(3,Kue,2,1,"div",102),p(4,"input",103),at("ngModelChange",function(r){V(e);const o=v(2).dataElm;return it(o.value,r)||(o.value=r),H(r)}),g()(),ze()}if(2&t){const e=v(2).dataElm;h(),m("ngIf",e.name),h(2),m("ngIf",e.name),h(),Et("type","size"===e.name||"altitude"===e.name?"number":"text"),Et("min","size"===e.name?"0":""),m("ngStyle",Ke(6,kce,e.name?"8em":"100%")),st("ngModel",e.value)}}function Jue(t,n){1&t&&(Ue(0,15),q(1,Vue,9,4,"ng-container",16)(2,jue,7,8,"ng-container",16)(3,Gue,13,19,"ng-container",16)(4,Wue,7,10,"ng-container",16)(5,Yue,8,9,"ng-container",16)(6,que,7,12,"ng-container",16)(7,Que,5,8,"ng-container",17),ze(),Ge(8,"div",84)),2&t&&(m("ngSwitch",v().dataElm.type),h(),m("ngSwitchCase","note"),h(),m("ngSwitchCase","simpleNumber"),h(),m("ngSwitchCase","numberResource"),h(),m("ngSwitchCase","checkProperty"),h(),m("ngSwitchCase","abilityScore"),h(),m("ngSwitchCase","url"))}function ede(t,n){if(1&t&&q(0,Lue,1,0,"ng-container",79)(1,Hue,4,2,"ng-template",null,11,Ai)(3,Jue,9,7,"ng-template",null,12,Ai),2&t){const e=n.dataElm,i=pn(2),r=pn(4);m("ngIf",0<e.children.length)("ngIfThen",i)("ngIfElse",r)}}function tde(t,n){if(1&t&&(p(0,"div",108),Ge(1,"div",33),Ut(2,"safe"),g()),2&t){const e=v(2);je("width",e.fullImageAreaRect.width,"px")("height",e.fullImageAreaRect.height,"px")("left",e.fullImageAreaRect.left,"px")("top",e.fullImageAreaRect.top,"px"),m("ngStyle",Ke(19,H5,"scale("+e.fullImageAreaRect.scale+")")),h(),je("font-size",e.cardFontSize,"px")("color",e.cardColor)("text-shadow",e.cardTextShadowCss),m("innerHTML",zt(2,16,e.cardText,"html"),$r)}}function nde(t,n){if(1&t){const e=Le();p(0,"div",104),he("click",function(){return V(e),H(v().chanageImageView(!1))}),q(1,tde,3,21,"div",105),p(2,"div",106)(3,"i",30),y(4,"close"),g()(),Ge(5,"img",107,13),Ut(7,"safe"),g()}if(2&t){const e=v();m("@fadeInOut","in"),h(),m("ngIf","card"==e.tabletopObject.aliasName&&e.cardState!==e.CardStateBack&&(e.cardState==e.CardStateFront||e.tabletopObject.isFront||e.tabletopObject.isHand||e.tabletopObject.isGMMode)||"card-stack"==e.tabletopObject.aliasName&&e.tabletopObject.topCard.isFront),h(4),m("src",zt(7,3,e.imageUrl,"resourceUrl"),bn)}}let ide=(()=>{class t{get imageUrl(){if(!this.tabletopObject)return"";if(this.isUseIcon)return this.tabletopObject.faceIcon.url;if(this.tabletopObject instanceof gn&&this.tabletopObject.standList&&this.tabletopObject.standList.overviewIndex>-1){const e=this.tabletopObject.standList.standElements[this.tabletopObject.standList.overviewIndex];if(!e)return"";try{const i=e.getFirstElementByName("imageIdentifier");if(!i)return"";if(this._imageFile.identifier!=i.value){const r=on.instance.get(i.value);this._imageFile=r||vn.Empty}}catch(i){console.log(i)}return this._imageFile.url}if(this.tabletopObject instanceof Ci){if(null!==this.cardState){if(this.cardState===this.CardStateFront)return this.tabletopObject.frontImage?this.tabletopObject.frontImage.url:"";if(this.cardState===this.CardStateBack)return this.tabletopObject.backImage?this.tabletopObject.backImage.url:""}if(this.tabletopObject.isGMMode)return this.tabletopObject.frontImage?this.tabletopObject.frontImage.url:""}return this.tabletopObject.imageFile?this.tabletopObject.imageFile.url:""}get hasImage(){return 0<this.imageUrl.length}get isUseIcon(){return this.tabletopObject instanceof gn&&this.tabletopObject.isUseIconToOverviewImage&&this.tabletopObject.faceIcon&&0<this.tabletopObject.faceIcon.url.length}get roll(){if(this.tabletopObject instanceof gn){if(this.tabletopObject.standList&&this.tabletopObject.standList.overviewIndex>-1){const e=this.tabletopObject.standList.standElements[this.tabletopObject.standList.overviewIndex];if(!e)return 0;try{const i=e.getFirstElementByName("applyRoll");return i&&i.value?this.tabletopObject.roll:0}catch(i){console.log(i)}}return this.tabletopObject.roll}return 0}get applyImageEffect(){if(this.tabletopObject instanceof gn){if(this.tabletopObject.standList&&this.tabletopObject.standList.overviewIndex>-1){const e=this.tabletopObject.standList.standElements[this.tabletopObject.standList.overviewIndex];if(!e)return!1;try{const i=e.getFirstElementByName("applyImageEffect");return!(!i||!i.value)}catch(i){console.log(i)}}return!0}return!1}get isInverse(){return!!(this.tabletopObject instanceof gn&&this.applyImageEffect)&&this.tabletopObject.isInverse}get isHollow(){return!!(this.tabletopObject instanceof gn&&this.applyImageEffect)&&this.tabletopObject.isHollow}get isBlackPaint(){return!!(this.tabletopObject instanceof gn&&this.applyImageEffect)&&this.tabletopObject.isBlackPaint}get aura(){return this.tabletopObject instanceof gn&&this.applyImageEffect?this.tabletopObject.aura:-1}get inventoryDataElms(){return this.tabletopObject?this.getInventoryTags(this.tabletopObject):[]}get dataElms(){return this.tabletopObject&&this.tabletopObject.detailDataElement?this.tabletopObject.detailDataElement.children:[]}get hasDataElms(){return 0<this.dataElms.length}get newLineStrings(){return this.inventoryService.newLineStrings}get isPointerDragging(){return this.pointerDeviceService.isDragging||this.pointerDeviceService.isTablePickGesture}get pointerEventsStyle(){return{"is-pointer-events-auto":!this.isPointerDragging,"pointer-events-none":this.isPointerDragging}}checkValue(e){if(!e||null==e.currentValue)return"";let i=e.currentValue.toString().split(/[|\uff5c]/,2);if(i.length<=1)return null==e.value||""==e.value?"":e.currentValue.toString();let r=null==e.value||""==e.value?i[1]:i[0];return this.tabletopObject instanceof gn&&this.tabletopObject.chatPalette&&(r=this.tabletopObject.chatPalette.evaluate(r,this.tabletopObject.rootDataElement)),r}constructor(e,i,r,o){this.inventoryService=e,this.changeDetector=i,this.pointerDeviceService=r,this.modalService=o,this.tabletopObject=null,this.left=0,this.top=0,this.cardState=null,this.CardStateFront=bs.FRONT,this.CardStateBack=bs.BACK,this.gridSize=50,this.naturalWidth=0,this.naturalHeight=0,this.stringUtil=ke,this._imageFile=vn.Empty,this.isOpenImageView=!1}ngOnChanges(){ne.unregister(this),ne.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.tabletopObject?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.tabletopObject?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()})}ngAfterViewInit(){this.initPanelPosition(),setTimeout(()=>{this.adjustPositionRoot()},16)}ngOnDestroy(){ne.unregister(this)}onChangeDragging(e){this.changeDetector.markForCheck()}initPanelPosition(){let e=this.draggablePanel.nativeElement,i=e.offsetWidth,o=this.left+100,s=this.top-e.offsetHeight-50,a=!1;window.innerWidth<o+i&&(o=window.innerWidth-i,a=!0),s<=0&&(s=0),a&&(o=this.left-i-100),o<0&&(o=0),s<0&&(s=0),e.style.left=o+"px",e.style.top=s+"px"}adjustPositionRoot(){let e=this.draggablePanel.nativeElement,i=e.getBoundingClientRect(),r=0,o=0;window.innerWidth<i.right+r&&(r+=window.innerWidth-(i.right+r)),i.left+r<0&&(r+=0-(i.left+r)),window.innerHeight<i.bottom+o&&(o+=window.innerHeight-(i.bottom+o)),i.top+o<0&&(o+=0-(i.top+o)),e.style.left=e.offsetLeft+r+"px",e.style.top=e.offsetTop+o+"px"}chanageImageView(e){this.isOpenImageView=e}openUrl(e,i=null,r=null){ke.sameOrigin(e)?window.open(e.trim(),"_blank","noopener"):this.modalService.open(sa,{url:e,title:i,subTitle:r})}getInventoryTags(e){return this.inventoryService.tableInventory.dataElementMap.get(e.identifier)}onCardImageLoad(){this.cardImageElement&&(this.naturalWidth=this.cardImageElement.nativeElement.naturalWidth,this.naturalHeight=this.cardImageElement.nativeElement.naturalHeight)}onFullCardImageLoad(){this.cardImageElement&&(this.naturalWidth=this.cardImageElement.nativeElement.naturalWidth,this.naturalHeight=this.cardImageElement.nativeElement.naturalHeight)}get imageAreaRect(){return this.calcImageAreaRect(250,330,8)}get fullImageAreaRect(){return this.calcImageAreaRect(document.documentElement.clientWidth,document.documentElement.offsetHeight,16)}calcImageAreaRect(e,i,r){const o={width:0,height:0,top:r,left:r,scale:1};if(0==this.naturalWidth||0==this.naturalHeight)return o;const s=e-2*r,a=i-2*r;this.naturalHeight*s/this.naturalWidth>a?(o.width=this.naturalWidth*a/this.naturalHeight,o.height=a,o.left=r+(s-o.width)/2):(o.width=s,o.height=this.naturalHeight*s/this.naturalWidth,o.top=r+(a-o.height)/2);let c=null;return this.tabletopObject instanceof Vi?c=this.tabletopObject.topCard:this.tabletopObject instanceof Ci&&(c=this.tabletopObject),c&&(o.scale=o.width/(c.size*this.gridSize),o.width=c.size*this.gridSize,o.height=o.width*this.naturalHeight/this.naturalWidth),o}get cardColor(){let e=null;return this.tabletopObject instanceof Vi?e=this.tabletopObject.topCard:this.tabletopObject instanceof Ci&&(e=this.tabletopObject),e?e.color:"#555555"}get cardFontSize(){let e=null;return this.tabletopObject instanceof Vi?e=this.tabletopObject.topCard:this.tabletopObject instanceof Ci&&(e=this.tabletopObject),e?e.fontsize+9:18}get cardText(){let e=null;return this.tabletopObject instanceof Vi?e=this.tabletopObject.topCard:this.tabletopObject instanceof Ci&&(e=this.tabletopObject),e?ke.rubyToHtml(ke.escapeHtml(e.text)):""}get cardTextShadowCss(){const e=ke.textShadowColor(this.cardColor);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}get rangeElms(){let e=[];return!this.tabletopObject||!(this.tabletopObject instanceof rr)||!this.tabletopObject.commonDataElement||(this.tabletopObject.commonDataElement.getFirstElementByName("length")&&e.push(this.tabletopObject.commonDataElement.getFirstElementByName("length")),("CORN"===this.tabletopObject.type||"LINE"===this.tabletopObject.type)&&this.tabletopObject.commonDataElement.getFirstElementByName("width")&&e.push(this.tabletopObject.commonDataElement.getFirstElementByName("width")),this.tabletopObject.commonDataElement.getFirstElementByName("opacity")&&e.push(this.tabletopObject.commonDataElement.getFirstElementByName("opacity"))),e}get isNoLogging(){return this.tabletopObject instanceof Ci?!this.tabletopObject.isFront:this.tabletopObject instanceof ts&&this.tabletopObject.hasOwner}get isSelected(){return this.textAreaElementRef&&document.activeElement===this.textAreaElementRef.nativeElement}adjustedRubiedNote(e,i=!0){if(!e)return"";let r=ke.escapeHtml(e);return i&&(r=ke.rubyToHtml(r)),r.lastIndexOf("\n")==r.length-1?r+"\n":r}textAreaActivate(){this.textAreaElementRef&&this.textAreaElementRef.nativeElement&&this.textAreaElementRef.nativeElement.focus()}static#e=this.\u0275fac=function(i){return new(i||t)(Y(lS),Y(Zr),Y(lr),Y(Ei))};static#t=this.\u0275cmp=In({type:t,selectors:[["overview-panel"]],viewQuery:function(i,r){if(1&i&&(Ln(gce,7),Ln(mce,5),Ln(_ce,5),Ln(bce,5)),2&i){let o;Bn(o=Un())&&(r.draggablePanel=o.first),Bn(o=Un())&&(r.cardImageElement=o.first),Bn(o=Un())&&(r.fullCardImageElement=o.first),Bn(o=Un())&&(r.textAreaElementRef=o.first)}},hostBindings:function(i,r){1&i&&he("draggingstate",function(s){return r.onChangeDragging(s)},0,Yh)},inputs:{tabletopObject:"tabletopObject",left:"left",top:"top",cardState:"cardState"},features:[hr],decls:28,vars:10,consts:[["draggablePanel",""],["overviewCard",""],["overviewNote",""],["overviewCharacter",""],["overviewDiceSymbol",""],["overviewRange",""],["overviewTabletop",""],["dataElement",""],["imageView",""],["cardImage",""],["textArea",""],["thenBlock",""],["elseBlock",""],["fullCardImage",""],["appDraggable","",1,"component","is-pointer-events-none"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngTemplateOutlet"],[1,"component-content","is-small-size",3,"ngClass"],["style","position: relative;",4,"ngIf"],[1,"component-title","title-background",3,"ngClass"],[1,"component-background"],["class","grid-container-root",4,"ngIf"],[2,"position","relative"],["class","text","style","z-index: 5; top: 8px",3,"width","height","left","ngStyle",4,"ngIf"],["draggable","false",1,"card-image",3,"load","src"],[1,"zoom-button",2,"z-index","10",3,"click"],[1,"material-icons"],["class","component-owner position-right-bottom","style","z-index: 10",3,"ngClass",4,"ngIf"],[1,"text",2,"z-index","5","top","8px",3,"ngStyle"],[3,"innerHTML"],[1,"component-owner","position-right-bottom",2,"z-index","10",3,"ngClass"],[1,"owner-tag"],[1,"grid-container-root"],[1,"grid-container"],[4,"ngFor","ngForOf"],[1,"component-content","is-large-size",3,"ngClass"],[1,"component-title","title-background"],[1,"component-background","text-note-container"],[2,"position","relative",3,"mousedown"],[1,"is-fill"],["spellcheck","false",1,"textarea",2,"resize","none",3,"ngModelChange","ngModel","ngClass"],[1,"note-text",2,"pointer-events","none","position","absolute",3,"innerHTML","ngClass"],[1,"textarea-spacer",2,"pointer-events","none",3,"innerHTML"],[1,"component-content","character-grid-container","is-middle-size"],[1,"title-bg-area","title-background",3,"ngClass"],["class","image-area character-image-box",3,"ngClass",4,"ngIf"],[1,"title-area","component-title",3,"ngClass"],[1,"void-area","is-pointer-events-none"],[1,"dataElm-area","component-background",3,"ngClass"],[1,"image-area","character-image-box",3,"ngClass"],[3,"ngStyle"],[1,"inverser",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"character-image",2,"pointer-events","none",3,"ngClass","src"],[1,"character-image",2,"pointer-events","none",3,"src"],["class","owner-name-area component-owner",3,"ngClass",4,"ngIf"],[1,"owner-name-area","component-owner",3,"ngClass"],["draggable","false",1,"character-image",3,"ngClass","src"],["class","section border","style","padding-top: 2px",4,"ngIf"],[1,"tag",2,"min-width","100px"],[1,"value"],[2,"display","inline-block","width","min-content"],[1,"hidden-spacer",2,"margin-right","2em"],["type","number","step","0.1","size","1",1,"input",2,"width","4em",3,"ngModelChange","ngModel"],[1,"section",2,"line-height","1em"],["type","range","max","12","step","0.5",3,"ngModelChange","title","min","ngModel"],["type","number","size","1",1,"input",2,"width","4em",3,"ngModelChange","ngModel"],[1,"move",2,"font-size","small"],["type","range","min","0","max","100",3,"ngModelChange","title","ngModel"],[1,"tag"],[1,"value",2,"margin-top","3px","pointer-events","none"],[1,"inverser",2,"min-width","32px","min-height","32px","max-width","32px","max-height","32px","margin-left","auto","margin-right","0px",3,"ngClass"],[1,"aura-following",3,"ngClass"],["draggable","false",1,"character-image",2,"pointer-events","none",3,"ngClass","src"],[1,"section","border",2,"padding-top","2px"],[4,"ngIf","ngIfThen","ngIfElse"],[1,"section",2,"padding-top","0.5em"],["class","section-text",4,"ngIf"],[1,"grid-container","indetnt"],[1,"section-text"],[1,"section","border"],[1,"section"],[1,"note",2,"position","relative"],["spellcheck","false",1,"textarea",3,"ngModelChange","ngModel"],[1,"textarea-spacer"],[1,"hidden-spacer"],["appLogging","","size","1",1,"input",2,"width","4em",3,"ngModelChange","logging.name","logging.dataElement","logging.disable","type","ngModel"],["appLogging","","type","number","size","1",1,"input",2,"width","4em",3,"ngModelChange","logging.name","logging.dataElement","logging.disable","ngModel"],[2,"display","inline"],["appLogging","","type","range","min","0",3,"ngModelChange","logging.name","logging.dataElement","logging.disable","title","max","ngModel"],["appLogging","","type","checkbox",2,"width","2em","margin-right","1em",3,"ngModelChange","change","logging.name","logging.dataElement","logging.disable","ngModel","checked"],["style","font-size: smaller",4,"ngIf"],[2,"font-size","smaller"],["title","URL\u304c\u4e0d\u6b63\u3067\u3059",4,"ngIf"],["draggable","false","target","_blank",3,"click","ngClass"],[1,"url-link"],["title","URL\u304c\u4e0d\u6b63\u3067\u3059"],["class","tag",4,"ngIf"],["class","hidden-spacer",4,"ngIf"],["size","1",1,"input",3,"ngModelChange","ngStyle","type","min","ngModel"],[1,"image-view-background","is-fill",3,"click"],["class","text","style","z-index: 5",3,"width","height","left","top","ngStyle",4,"ngIf"],[1,"close-button","is-pointer-events-none",2,"z-index","10"],["draggable","false",1,"contain-image",3,"src"],[1,"text",2,"z-index","5",3,"ngStyle"]],template:function(i,r){1&i&&(p(0,"div",14,0),Ue(2,15),q(3,Oce,1,0,"ng-container",16)(4,Pce,2,4,"ng-container",16)(5,Nce,2,4,"ng-container",16)(6,Lce,2,4,"ng-container",16)(7,Uce,2,4,"ng-container",16)(8,Hce,2,4,"ng-container",16)(9,jce,2,4,"ng-container",16)(10,Wce,2,4,"ng-container",17),ze(),g(),q(11,Yce,2,1,"ng-container",18)(12,iue,8,12,"ng-template",null,1,Ai)(14,rue,12,20,"ng-template",null,2,Ai)(16,hue,8,15,"ng-template",null,3,Ai)(18,xue,11,18,"ng-template",null,4,Ai)(20,Aue,7,14,"ng-template",null,5,Ai)(22,Rue,9,14,"ng-template",null,6,Ai)(24,ede,5,3,"ng-template",null,7,Ai)(26,nde,8,6,"ng-template",null,8,Ai)),2&i&&(m("@fadeInOut","in"),h(2),m("ngSwitch",r.tabletopObject.aliasName),h(),m("ngSwitchCase","numberResource"),h(),m("ngSwitchCase","card"),h(),m("ngSwitchCase","card-stack"),h(),m("ngSwitchCase","text-note"),h(),m("ngSwitchCase","character"),h(),m("ngSwitchCase","dice-symbol"),h(),m("ngSwitchCase","range"),h(2),m("ngIf",r.isOpenImageView))},dependencies:[Ni,nr,ri,uf,Lo,Hd,Dg,M0,kr,yl,Cl,Ea,Or,Cr,JT,Hu,cr],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;max-height:100%;max-width:100%;box-sizing:border-box;overflow:visible;color:#444;z-index:9000;overscroll-behavior:contain;-webkit-overflow-scrolling:touch;cursor:grab}.component-content[_ngcontent-%COMP%]{font-size:12px}.is-large-size[_ngcontent-%COMP%]{max-width:350px}.is-middle-size[_ngcontent-%COMP%]{max-width:270px}.is-small-size[_ngcontent-%COMP%]{max-width:250px}.is-middle-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:270px}.is-small-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:250px}.component-background[_ngcontent-%COMP%]{background:linear-gradient(-30deg,#f0dabde6,#fff4e8e6);border-bottom:solid 1px #999}.component-title[_ngcontent-%COMP%]{color:#ccc;font-size:1em;text-align:right;vertical-align:middle;height:32px;line-height:32px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 1em}.title-background[_ngcontent-%COMP%]{background-color:#555;border-top:solid 1px #999;border-left:solid 1px #999;border-right:solid 1px #999}.component-owner[_ngcontent-%COMP%]{font-size:.8em;color:#ccc;vertical-align:middle;overflow:hidden;text-align:right;padding:2px 1em;max-width:100%;box-sizing:border-box}.owner-tag[_ngcontent-%COMP%]{width:min-content;max-width:100%;margin-left:auto;margin-right:0;overflow:hidden;color:#f5f5f5;background-color:#1e1e1e;box-sizing:border-box;padding:3px 9px;border-radius:6px;white-space:nowrap;text-overflow:ellipsis;opacity:.9}.card-image[_ngcontent-%COMP%]{width:250px;max-height:330px;padding:8px;vertical-align:bottom;object-fit:contain;box-sizing:border-box;background-color:#cccccc80}.zoom-button[_ngcontent-%COMP%]{position:absolute;left:8px;bottom:-21px;width:42px;height:42px;border-radius:100px;padding:4px;cursor:zoom-in}.zoom-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:24px;vertical-align:bottom}.position-right-bottom[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0}.image-view-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1e4d;z-index:9900}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{position:absolute;right:16px;top:16px}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:36px}.contain-image[_ngcontent-%COMP%]{width:100%;height:100%;box-sizing:border-box;padding:16px;vertical-align:bottom;object-fit:contain}.text-note-container[_ngcontent-%COMP%]{width:100%;max-height:400px;padding:.6em 1.2em;box-sizing:border-box;overflow:hidden auto;line-height:1.8;border-left:solid 1px #999;border-right:solid 1px #999}.character-image-box[_ngcontent-%COMP%]{width:100px;vertical-align:bottom;margin-left:.5em;margin-bottom:-6px;z-index:1;overflow:visible}.character-image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:150px;vertical-align:bottom;object-fit:contain;object-position:bottom center}.character-image-box.has-icon[_ngcontent-%COMP%]{width:100px;height:100px;max-width:100px;max-height:100px;transform:translateY(-16px);margin-top:16px}.character-image-box.has-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;object-position:50% 0%;border-radius:1em}.character-image[_ngcontent-%COMP%]{padding:0;width:100%;vertical-align:bottom}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.character-grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:min-content auto;grid-template-rows:1fr auto auto auto}.title-bg-area[_ngcontent-%COMP%]{grid-area:3 / 1 / 4 / 3}.title-area[_ngcontent-%COMP%]{grid-area:3 / 2 / 4 / 3}.owner-name-area[_ngcontent-%COMP%]{grid-area:2 / 2 / 3 / 3}.image-area[_ngcontent-%COMP%]{grid-area:1 / 1 / 4 / 2}.void-area[_ngcontent-%COMP%]{grid-area:1 / 2 / 3 / 3}.dataElm-area[_ngcontent-%COMP%]{grid-area:4 / 1 / 5 / 3}.grid-container-root[_ngcontent-%COMP%]{padding:.5em 1.2em;max-height:250px;overflow:hidden auto;box-sizing:border-box;border-left:solid 1px #999;border-right:solid 1px #999}.grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr fit-content(80%)}.grid-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{box-sizing:border-box;line-height:24px}.indetnt[_ngcontent-%COMP%]{padding-left:.5em}.section[_ngcontent-%COMP%]{max-width:100%;grid-column:1 / span 2}.section-text[_ngcontent-%COMP%]{font-size:1.1em;font-weight:700;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.note[_ngcontent-%COMP%]{margin-left:.5em;font-size:1em;line-height:1.8}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box;resize:none;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.textarea[_ngcontent-%COMP%]:hover{background:#eee}.textarea[_ngcontent-%COMP%]:focus{background:#fff}.tag[_ngcontent-%COMP%]{padding-right:1em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;min-width:7em}.value[_ngcontent-%COMP%]{font-size:1.2em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;text-align:right}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0px;min-width:3em;overflow:hidden;white-space:pre-wrap}.textarea-spacer[_ngcontent-%COMP%]{visibility:hidden;min-width:3em;height:auto;min-height:24px;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.input[_ngcontent-%COMP%]{min-width:3em;text-align:right;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#eee}.input[_ngcontent-%COMP%]:focus{background:#fff}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}.border[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.separator[_ngcontent-%COMP%]{padding:2px 0;border-bottom:1px solid #888}.with-button-marign[_ngcontent-%COMP%]{padding-left:60px}.is-fill[_ngcontent-%COMP%]{position:absolute;inset:0}.is-bold[_ngcontent-%COMP%]{font-weight:700}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #fff)}.aura-following.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px black)}.aura-following.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #33f)}.aura-following.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3f3)}.aura-following.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3ff)}.aura-following.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f00)}.aura-following.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f0f)}.aura-following.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #ff3)}.aura-following.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #fff)}button.link[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}button.link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button.link[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}button.link[_ngcontent-%COMP%]:disabled{color:gray}button.link[_ngcontent-%COMP%]:disabled:hover{background-color:transparent}.text[_ngcontent-%COMP%]{transform-origin:left top;position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.hide-area[_ngcontent-%COMP%]{overflow:hidden!important;font-size:0pt!important;width:0px!important;height:0px!important;margin:0!important;padding:0!important;border:0px none!important}.note-text[_ngcontent-%COMP%]{color:#444;min-width:3em;height:auto;min-height:24px;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.hide-text-area[_ngcontent-%COMP%]{color:transparent}input[_ngcontent-%COMP%] + .move[_ngcontent-%COMP%]{display:inline-block;transform:translate(-1em);transition:transform 18ms}input[_ngcontent-%COMP%]:hover + .move[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:active + .move[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:focus + .move[_ngcontent-%COMP%]{display:inline-block;transform:translate(0);transition:transform 18ms}.url-link[_ngcontent-%COMP%]{cursor:inherit}@supports (-moz-user-select: -moz-none){input[_ngcontent-%COMP%] + .move[_ngcontent-%COMP%]{transform:translate(0)}}"],data:{animation:[Xn("fadeInOut",[an("void => *",[rn("100ms ease-out",En([We({opacity:0,offset:0}),We({opacity:1,offset:1})]))]),an("* => void",[rn("100ms ease-in",En([We({opacity:1,offset:0}),We({opacity:0,offset:1})]))])])]},changeDetection:0})}return t})(),W5=(()=>{class t{static#e=this.activeTooltips=[];constructor(e,i,r){this.ngZone=e,this.viewContainerRef=i,this.pointerDeviceService=r,this.callbackOnMouseEnter=o=>this.onMouseEnter(o),this.callbackOnMouseLeave=o=>this.onMouseLeave(o),this.callbackOnMouseDown=o=>this.onMouseDown(o),this.callbackOnPick=o=>this.ngZone.run(()=>this.closeAll())}ngAfterViewInit(){this.addEventListeners(this.viewContainerRef.element.nativeElement)}ngOnDestroy(){this.removeEventListeners(this.viewContainerRef.element.nativeElement),this.clearTimer(),this.close()}onMouseEnter(e){this.clearTimer(),this.tooltipComponentRef||this.startOpenTimer()}onMouseLeave(e){this.clearTimer(),this.tooltipComponentRef&&this.startCloseTimer()}onMouseDown(e){this.tooltipComponentRef&&!this.tooltipComponentRef.location.nativeElement.contains(e.target)&&!this.viewContainerRef.element.nativeElement.contains(e.target)&&this.ngZone.run(()=>this.closeAll())}startOpenTimer(){let e=this.pointerDeviceService.pointer;this.openTooltipTimer=setTimeout(()=>{this.openTooltipTimer=null,4<Hi.sqrMagnitude(e,this.pointerDeviceService.pointer)?this.startOpenTimer():this.ngZone.run(()=>this.open())},100)}startCloseTimer(){this.closeTooltipTimer=setTimeout(()=>{this.closeTooltipTimer=null,this.tooltipComponentRef&&this.tooltipComponentRef.location.nativeElement.contains(document.activeElement)?this.startCloseTimer():this.ngZone.run(()=>this.closeAll())},400)}clearTimer(){this.closeTooltipTimer&&clearTimeout(this.closeTooltipTimer),this.openTooltipTimer&&clearTimeout(this.openTooltipTimer),this.closeTooltipTimer=this.openTooltipTimer=null}open(){if(this.closeAll(),this.pointerDeviceService.isDragging||this.pointerDeviceService.isTablePickGesture)return;let e=Bo.defaultParentViewContainerRef;this.tooltipComponentRef=e.createComponent(ide,{index:e.length,injector:e.injector}),this.tooltipComponentRef.instance.tabletopObject=this.tabletopObject,this.tooltipComponentRef.instance.left=this.pointerDeviceService.pointerX,this.tooltipComponentRef.instance.top=this.pointerDeviceService.pointerY,this.tooltipComponentRef.instance.cardState=this.cardState,this.addEventListeners(this.tooltipComponentRef.location.nativeElement),this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.addEventListener("mousedown",this.callbackOnMouseDown,!0),document.addEventListener("pickstart",this.callbackOnPick,!0),document.addEventListener("pickobject",this.callbackOnPick,!0),document.addEventListener("pickregion",this.callbackOnPick,!0)}),ne.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.tabletopObject.identifier}`,o=>{this.pointerDeviceService.isDragging&&this.ngZone.run(()=>this.closeAll())}).on("UPDATE_SELECTION",o=>{this.pointerDeviceService.isDragging&&this.ngZone.run(()=>this.closeAll())}).on("DELETE_GAME_OBJECT",o=>{this.tabletopObject&&this.tabletopObject.identifier===o.data.identifier&&this.closeAll()}),this.tooltipComponentRef.onDestroy(()=>{this.removeEventListeners(this.tooltipComponentRef.location.nativeElement),document.body.removeEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.removeEventListener("mousedown",this.callbackOnMouseDown,!0),document.removeEventListener("pickstart",this.callbackOnPick,!0),document.removeEventListener("pickobject",this.callbackOnPick,!0),document.removeEventListener("pickregion",this.callbackOnPick,!0),this.clearTimer(),this.tooltipComponentRef=null,ne.unregister(this)}),t.activeTooltips.push(this.tooltipComponentRef);let r=this.tooltipComponentRef.instance;null!=r?.ngOnChanges&&queueMicrotask(()=>{this.tooltipComponentRef.instance&&r?.ngOnChanges({})})}close(){if(!this.tooltipComponentRef)return;let e=t.activeTooltips.indexOf(this.tooltipComponentRef);0<=e&&t.activeTooltips.splice(e,1),this.tooltipComponentRef.destroy(),this.tooltipComponentRef=null}closeAll(){t.activeTooltips.forEach(e=>e.destroy()),t.activeTooltips=[],this.close()}addEventListeners(e){this.ngZone.runOutsideAngular(()=>{e.addEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.addEventListener("mouseleave",this.callbackOnMouseLeave,!1)})}removeEventListeners(e){e.removeEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.removeEventListener("mouseleave",this.callbackOnMouseLeave,!1)}static#t=this.\u0275fac=function(i){return new(i||t)(Y(Pn),Y(xa),Y(lr))};static#n=this.\u0275dir=Sn({type:t,selectors:[["","appTooltip",""]],inputs:{tabletopObject:[Ce.None,"appTooltip","tabletopObject"],cardState:"cardState"}})}return t})();const rde=["cardImage"],$5=t=>({downside:t}),Y5=t=>({reverse:t}),ode=t=>({transform:t});function sde(t,n){1&t&&(p(0,"i",10),y(1,"face-"),Ge(2,"br"),p(3,"span",11),y(4,"U"),g(),y(5,"p"),g())}function ade(t,n){1&t&&(p(0,"i",10)(1,"span",12),y(2,"face-"),g(),Ge(3,"br"),p(4,"span",11),y(5,"D"),g(),y(6,"own"),g())}let lde=(()=>{class t{constructor(){this.card=null,this.CardStateFront=bs.FRONT,this.CardStateBack=bs.BACK,this.gridSize=50,this.naturalWidth=0,this.naturalHeight=0}ngOnInit(){}onCardImageLoad(){this.cardImageElement&&(this.naturalWidth=this.cardImageElement.nativeElement.naturalWidth,this.naturalHeight=this.cardImageElement.nativeElement.naturalHeight)}get rubiedText(){return this.card?ke.rubyToHtml(ke.escapeHtml(this.card.text)):""}get imageAreaRect(){return this.calcImageAreaRect(64,64,0)}calcImageAreaRect(e,i,r){const o={width:0,height:0,top:r,left:r,scale:1};if(0==this.naturalWidth||0==this.naturalHeight)return o;const s=e-2*r,a=i-2*r;return this.naturalHeight*s/this.naturalWidth>a?(o.width=this.naturalWidth*a/this.naturalHeight,o.height=a,o.left=r+(s-o.width)/2):(o.width=s,o.height=this.naturalHeight*s/this.naturalWidth,o.top=r+(a-o.height)/2),this.card&&(o.scale=o.width/(this.card.size*this.gridSize),o.width=this.card.size*this.gridSize,o.height=o.width*this.naturalHeight/this.naturalWidth),o}get cardColor(){return this.card?this.card.color:"#555555"}get cardFontSize(){return this.card?this.card.fontsize+9:18}get cardText(){return this.card?this.card.text:""}get textShadowCss(){const e=ke.textShadowColor(this.cardColor);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275cmp=In({type:t,selectors:[["card-list-image"]],viewQuery:function(i,r){if(1&i&&Ln(rde,7),2&i){let o;Bn(o=Un())&&(r.cardImageElement=o.first)}},inputs:{card:"card"},decls:15,vars:48,consts:[["cardImage",""],[1,"image-box",2,"position","relative",3,"appTooltip","cardState"],[1,"image",3,"ngClass"],[1,"image",2,"position","relative",3,"ngClass"],["draggable","false",2,"position","absolute",3,"load","src"],[1,"text",2,"z-index","5","position","absolute",3,"ngStyle"],[3,"innerHTML"],["class","indicate-text",4,"ngIf"],[1,"image",2,"position","relative"],["draggable","false",2,"position","absolute",3,"src","ngClass"],[1,"indicate-text"],[1,"initial",2,"padding-left","3px"],[2,"font-size","smaller"]],template:function(i,r){if(1&i){const o=Le();p(0,"div",1)(1,"div",2)(2,"div",3)(3,"img",4,0),Ut(5,"safe"),he("load",function(){return V(o),H(r.onCardImageLoad())}),g(),p(6,"div",5),Ge(7,"div",6),Ut(8,"safe"),g()(),q(9,sde,6,0,"i",7),g(),p(10,"div",8)(11,"div",2),Ge(12,"img",9),Ut(13,"safe"),q(14,ade,7,0,"i",7),g()()()}2&i&&(m("appTooltip",r.card)("cardState",r.CardStateFront)("@flipCard",null!=r.card&&r.card.isFront?0:1),h(),m("ngClass",Ke(38,$5,r.card&&!r.card.isFront)),h(),m("ngClass",Ke(40,Y5,r.card&&180==r.card.rotate))("@reverseCard",r.card.rotate),h(),m("src",zt(5,29,null==r.card||null==r.card.frontImage?null:r.card.frontImage.url,"resourceUrl"),bn),h(3),je("width",r.imageAreaRect.width,"px")("height",r.imageAreaRect.height,"px")("left",r.imageAreaRect.left,"px")("top",r.imageAreaRect.top,"px"),m("ngStyle",Ke(42,ode,"scale("+r.imageAreaRect.scale+")")),h(),je("font-size",r.cardFontSize,"px")("color",r.cardColor)("text-shadow",r.textShadowCss),m("innerHTML",zt(8,32,r.rubiedText,"html"),$r),h(2),m("ngIf",null==r.card?null:r.card.isFront),h(2),m("ngClass",Ke(44,$5,r.card&&r.card.isFront)),h(),m("src",zt(13,35,null==r.card||null==r.card.backImage?null:r.card.backImage.url,"resourceUrl"),bn)("ngClass",Ke(46,Y5,r.card&&180==r.card.rotate))("@reverseCard",r.card.rotate),h(2),m("ngIf",!(null!=r.card&&r.card.isFront)))},dependencies:[Ni,ri,Lo,W5,cr],styles:[".image-box[_ngcontent-%COMP%]{display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:64px;height:64px;object-fit:contain}.text[_ngcontent-%COMP%]{transform-origin:left top;position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.downside[_ngcontent-%COMP%]{background-color:#555}.indicate-text[_ngcontent-%COMP%]{font-size:xx-small;display:inline-block;position:absolute;opacity:80%;bottom:1px;left:1px;color:#000;pointer-events:none;text-shadow:#fff 0px 0px 1px,#fff 0px 0px 1px,#fff 0px 0px 1px,#fff 0px 0px 1px,#fff 0px 0px 1px,#fff 0px 0px 1px,#fff 0px 0px 1px,#fff 0px 0px 1px}.indicate-text[_ngcontent-%COMP%]   .initial[_ngcontent-%COMP%]{font-weight:700;color:#fff;text-shadow:#000 0px 0px 1px,#000 0px 0px 1px,#000 0px 0px 1px,#000 0px 0px 1px,#000 0px 0px 1px,#000 0px 0px 1px,#000 0px 0px 1px,#000 0px 0px 1px}.reverse[_ngcontent-%COMP%]{transform:rotate(180deg)}"],data:{animation:[Xn("reverseCard",[an(":increment",[rn("132ms ease-in-out",En([We({transform:"rotateZ(0deg)",offset:0}),We({transform:"rotateZ(90deg)",offset:.5}),We({transform:"rotateZ(180deg)",offset:1})]))]),an(":decrement",[rn("132ms ease-in-out",En([We({transform:"rotateZ(180deg)",offset:0}),We({transform:"rotateZ(270deg)",offset:.5}),We({transform:"rotateZ(360deg)",offset:1})]))])]),Xn("flipCard",[an(":increment,:decrement",[rn("132ms ease-in-out",En([We({transform:"scaleX(1.0)",offset:0}),We({transform:"scaleX(0.1)",offset:.5}),We({transform:"scaleX(1.0)",offset:1})]))])])]}})}return t})();function cde(t,n){if(1&t){const e=Le();p(0,"div",2),Ge(1,"card-list-image",3),p(2,"div",4)(3,"button",5),he("click",function(){const r=V(e).$implicit;return H(v().drawCard(r))}),y(4,"\u5c71\u672d\u304b\u3089\u51fa\u3059"),g(),p(5,"button",0),he("click",function(){const r=V(e).$implicit;return H(v().showDetail(r))}),p(6,"i",6),y(7,"settings"),g(),y(8," \u7de8\u96c6"),g(),Ge(9,"br"),p(10,"button",0),he("click",function(){const r=V(e).$implicit;return H(v().up(r))}),y(11,"\u2191"),g(),p(12,"button",0),he("click",function(){const r=V(e).$implicit;return H(v().down(r))}),y(13,"\u2193"),g(),p(14,"button",7),he("click",function(){const r=V(e).$implicit;return H(r.rotate=180==r.rotate?0:180)}),y(15,"\u56de\u8ee2\u3059\u308b"),g(),p(16,"button",0),he("click",function(){const r=V(e).$implicit,o=v();return H(r.state=r.state==o.CardStateFront?o.CardStateBack:o.CardStateFront)}),y(17,"\u88cf\u8fd4\u3059"),g(),Ge(18,"br"),g()()}if(2&t){const e=n.$implicit;h(),m("card",e)}}let ude=(()=>{class t{constructor(e,i,r){this.panelService=e,this.changeDetector=i,this.chatMessageService=r,this.cardStack=null,this.owner=jt.peer.userId,this.CardStateFront=bs.FRONT,this.CardStateBack=bs.BACK}ngOnChanges(){Promise.resolve().then(()=>this.panelService.title=this.cardStack.name+" \u306e\u30ab\u30fc\u30c9\u4e00\u89a7"),ne.unregister(this),ne.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.cardStack?.identifier}`,e=>{this.changeDetector.markForCheck(),this.cardStack.owner!==this.owner&&this.panelService.close()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.cardStack?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("DELETE_GAME_OBJECT",e=>{this.cardStack&&this.cardStack.identifier===e.data.identifier&&this.panelService.close()})}ngOnDestroy(){ne.unregister(this),this.cardStack.owner===this.owner&&(this.cardStack.owner="")}drawCard(e){e.parent.removeChild(e),e.location.x=this.cardStack.location.x+100+50*Math.random(),e.location.y=this.cardStack.location.y+25+50*Math.random(),e.location.name=this.cardStack.location.name,e.rotate+=this.cardStack.rotate,360<e.rotate&&(e.rotate-=360),e.toTopmost(),tt.play(Te.cardDraw),this.chatMessageService.sendOperationLog(e.isFront?`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${""==e.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":e.name} \u3092\u53d6\u308a\u51fa\u3057\u305f`:`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 1\u679a\u53d6\u308a\u51fa\u3057\u3066\u4f0f\u305b\u305f`)}up(e){let i=e.parent,r=i.children.indexOf(e);0<r&&i.insertBefore(e,i.children[r-1])}down(e){let i=e.parent,r=i.children.indexOf(e);r<i.children.length-1&&i.insertBefore(i.children[r+1],e)}close(e=!1){e&&(this.cardStack.shuffle(),ne.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier}),tt.play(Te.cardShuffle)),this.panelService.close()}showDetail(e){let r="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(kl,{title:r,left:this.panelService.left+10,top:this.panelService.top+20,width:600,height:600}).tabletopObject=e}trackByCard(e,i){return i.identifier}static#e=this.\u0275fac=function(i){return new(i||t)(Y(yi),Y(Zr),Y(vo))};static#t=this.\u0275cmp=In({type:t,selectors:[["card-stack-list"]],inputs:{cardStack:"cardStack"},features:[hr],decls:5,vars:2,consts:[[3,"click"],["class","box",4,"ngFor","ngForOf","ngForTrackBy"],[1,"box"],[3,"card"],[2,"display","inline-block","margin-left","2px"],["type","submit",3,"click"],[1,"material-icons",2,"font-size","1.1em","vertical-align","text-bottom"],[2,"margin-left","5px",3,"click"]],template:function(i,r){1&i&&(p(0,"div")(1,"button",0),he("click",function(){return r.close(!0)}),y(2,"\u30b7\u30e3\u30c3\u30d5\u30eb\u3057\u3066\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b"),g(),Ge(3,"hr"),q(4,cde,19,1,"div",1),g()),2&i&&(h(4),m("ngForOf",r.cardStack.cards)("ngForTrackBy",r.trackByCard))},dependencies:[nr,lde],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image-box[_ngcontent-%COMP%]{display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}button[_ngcontent-%COMP%]{font-size:smaller;height:2.2em;padding:0 8px;min-width:2.2em;margin:1px;vertical-align:baseline}"],changeDetection:0})}return t})();const dde=t=>({"is-empty":t}),hde=t=>({"is-grab":t}),PS=t=>({transform:t}),um=t=>({"is-inverse":t}),fde=(t,n)=>({"background-color":t,transform:n}),pde=t=>({"is-magnetic":t});function gde(t,n){if(1&t&&(p(0,"div",10),Ge(1,"div",11),Ut(2,"safe"),g()),2&t){const e=v(2);m("ngStyle",Ke(11,PS,"rotateZ("+e.topCard.rotate+"deg)")),h(),je("font-size",e.topCard.fontsize+9,"px")("color",e.topCard.color)("text-shadow",e.textShadowCss(e.topCard.color)),m("innerHTML",zt(2,8,e.rubiedText,"html"),$r)}}function mde(t,n){if(1&t){const e=Le();p(0,"div",7),he("@shuffle.start",function(r){return V(e),H(v().animationShuffleStarted(r))})("@shuffle.done",function(r){return V(e),H(v().animationShuffleDone(r))}),q(1,gde,3,13,"div",8),Ge(2,"img",9),Ut(3,"safe"),g()}if(2&t){const e=v();m("@bounceInOut",void 0)("@shuffle",e.animeState),h(),m("ngIf",e.topCard.isFront),h(),m("ngStyle",Ke(8,PS,"rotateZ("+e.topCard.rotate+"deg)"))("src",zt(3,5,e.imageFile.url,"resourceUrl"),bn)}}function _de(t,n){if(1&t&&(Ue(0),p(1,"div",12)(2,"i",13),y(3),g()(),p(4,"div",14)(5,"i",13),y(6),g()(),p(7,"div",15)(8,"i",13),y(9),g()(),p(10,"div",16)(11,"i",13),y(12),g()(),ze()),2&t){const e=v();h(2),m("ngClass",Ke(8,um,e.isInverse)),h(),Xe(e.isLocked?"lock":"autorenew"),h(2),m("ngClass",Ke(10,um,e.isInverse)),h(),Xe(e.isLocked?"lock":"autorenew"),h(2),m("ngClass",Ke(12,um,e.isInverse)),h(),Xe(e.isLocked?"lock":"autorenew"),h(2),m("ngClass",Ke(14,um,e.isInverse)),h(),Xe(e.isLocked?"lock":"autorenew")}}function bde(t,n){if(1&t&&(p(0,"div",17)(1,"span",18),y(2),g()()),2&t){const e=v();m("ngStyle",Ke(3,PS,"translateY(-50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateZ("+(e.isInverse?180:0)+"deg)")),h(),m("ngClass",Ke(5,um,e.isInverse)),h(),Si("",e.cards.length,"\u679a")}}function vde(t,n){if(1&t&&(p(0,"div",19)(1,"span",18)(2,"b"),y(3),g(),y(4," \u304c\u78ba\u8a8d\u4e2d"),g()()),2&t){const e=v();m("ngStyle",Tn(3,fde,e.ownerColor,"translateY(50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateZ("+(e.isInverse?180:0)+"deg)")),h(),m("ngClass",Ke(6,um,e.isInverse)),h(2),Xe(e.ownerName)}}function yde(t,n){if(1&t&&Ge(0,"div",20),2&t){const e=v();m("ngClass",Ke(1,pde,e.isMagnetic))}}let Cde=(()=>{class t{get name(){return this.cardStack.name}get rotate(){return this.cardStack.rotate}set rotate(e){this.cardStack.rotate=e}get zindex(){return this.cardStack.zindex}get isShowTotal(){return this.cardStack.isShowTotal}get cards(){return this.cardStack.cards}get isEmpty(){return this.cardStack.isEmpty}get size(){let e=this.cardStack.topCard;return e?Hi.clampMin(e.size):2}get hasOwner(){return this.cardStack.hasOwner}get ownerIsOnline(){return this.cardStack.ownerIsOnline}get ownerName(){return this.cardStack.ownerName}get ownerColor(){return this.cardStack.ownerColor}get topCard(){return this.cardStack.topCard}get imageFile(){return this.imageService.getSkeletonOr(this.cardStack.imageFile)}get selectionState(){return this.selectionService.state(this.cardStack)}get isSelected(){return this.selectionState!==$n.NONE}get isMagnetic(){return this.selectionState===$n.MAGNETIC}get isIconHidden(){return null!=this.iconHiddenTimer}get rubiedText(){return ke.rubyToHtml(ke.escapeHtml(this.topCard.text))}get isLocked(){return!!this.cardStack&&this.cardStack.isLocked}set isLocked(e){this.cardStack&&(this.cardStack.isLocked=e)}get isInverse(){const e=Math.abs(this.viewRotateZ+this.rotate)%360;return 90<e&&e<270}constructor(e,i,r,o,s,a,c,u,f,b){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.elementRef=o,this.changeDetector=s,this.selectionService=a,this.imageService=c,this.pointerDeviceService=u,this.modalService=f,this.chatMessageService=b,this.cardStack=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.viewRotateZ=10,this.interactGesture=null}ngOnChanges(){ne.unregister(this),ne.register(this).on("SHUFFLE_CARD_STACK",e=>{e.data.identifier===this.cardStack.identifier&&(this.animeState="active",this.changeDetector.markForCheck())}).on("INVERSE_CARD_STACK",e=>{e.data.identifier===this.cardStack.identifier&&(this.animeState="inverse",this.changeDetector.markForCheck())}).on("UPDATE_GAME_OBJECT",e=>{let i=bt.instance.get(e.data.identifier);!this.cardStack||!i||(this.cardStack===i||i instanceof xr&&this.cardStack.contains(i)||i instanceof Fe&&i.userId===this.cardStack.owner)&&this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on("CARD_STACK_DECREASED",e=>{e.data.cardStackIdentifier===this.cardStack.identifier&&this.cardStack&&this.changeDetector.markForCheck()}).on(`UPDATE_GAME_OBJECT/aliasName/${Fe.aliasName}`,e=>{let i=bt.instance.get(e.data.identifier);this.cardStack&&i&&i.userId===this.cardStack.owner&&this.changeDetector.markForCheck()}).on(`UPDATE_GAME_OBJECT/identifier/${this.cardStack?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.cardStack?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.cardStack?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=Fe.findByPeerId(e.data.peerId);(!i||this.cardStack.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.cardStack,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain","text-note"]},this.rotableOption={tabletopObject:this.cardStack}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.interactGesture=new AS(this.elementRef.nativeElement)}),this.interactGesture.onstart=this.onInputStart.bind(this),this.interactGesture.oninteract=this.onDoubleClick.bind(this)}ngOnDestroy(){this.interactGesture.destroy(),ne.unregister(this)}animationShuffleStarted(e){}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onCardDrop(e){if(this.cardStack!==e.detail&&(e.detail instanceof Ci||e.detail instanceof Vi))if(e.stopPropagation(),e.preventDefault(),e.detail instanceof Ci){let i=e.detail;this.cardStack.calcSqrDistance(i)<2500&&(this.chatMessageService.sendOperationLog(`${i.isFront?""==i.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":i.name:"\u4f0f\u305b\u305f\u30ab\u30fc\u30c9"} \u3092 ${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306b\u4e57\u305b\u305f`),this.cardStack.putOnTop(i))}else if(e.detail instanceof Vi){let i=e.detail;this.cardStack.calcSqrDistance(i)<625&&(this.chatMessageService.sendOperationLog(`${""==i.name?"(\u7121\u540d\u306e\u5c71\u672d)":i.name} \u3092\u5168\u3066 ${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306b\u4e57\u305b\u305f`),this.concatStack(i))}}onDoubleClick(){this.ngZone.run(()=>{const e=this.drawCard();if(e){let i;tt.play(Te.cardDraw),i=e.isFront?`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${""==e.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":e.name} \u3092\u5f15\u3044\u305f`:`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 1\u679a\u5f15\u3044\u3066\u4f0f\u305b\u305f`,this.chatMessageService.sendOperationLog(i)}})}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){if(this.isLocked)return this.cardStack.toTopmost(),void ne.trigger("DRAG_LOCKED_OBJECT",{});ne.trigger("SELECT_TABLETOP_OBJECT",{identifier:this.cardStack.identifier,className:"GameCharacter"}),this.ngZone.run(()=>{this.cardStack.toTopmost(),this.startIconHiddenTimer()})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.name)}onMove(){this.contextMenuService.close(),tt.play(Te.cardPick)}onMoved(){tt.play(Te.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}drawCard(){let e=this.cardStack.drawCard();return e&&(e.location.x+=100+50*Math.random(),e.location.y+=25+50*Math.random(),e.setLocation(this.cardStack.location.name)),e}textShadowCss(e){const i=ke.textShadowColor(e);return`${i} 0px 0px 2px, \n    ${i} 0px 0px 2px, \n    ${i} 0px 0px 2px, \n    ${i} 0px 0px 2px, \n    ${i} 0px 0px 2px, \n    ${i} 0px 0px 2px,\n    ${i} 0px 0px 2px,\n    ${i} 0px 0px 2px`}breakStack(){let e=this.cardStack.drawCardAll().reverse();for(let i of e)i.location.x+=25-50*Math.random(),i.location.y+=25-50*Math.random(),i.toTopmost(),i.setLocation(this.cardStack.location.name);this.cardStack.setLocation("graveyard"),this.cardStack.destroy()}splitStack(e){if(e<2)return;let i=[];for(let a=0;a<e;a++){let c=Vi.create(`${this.cardStack.name}_${("0"+(a+1).toString()).slice(-2)}`);c.location.x=this.cardStack.location.x+50-100*Math.random(),c.location.y=this.cardStack.location.y+50-100*Math.random(),c.posZ=this.cardStack.posZ,c.location.name=this.cardStack.location.name,c.rotate=this.rotate,c.toTopmost(),i.push(c)}let r=this.cardStack.drawCardAll();this.cardStack.setLocation("graveyard"),this.cardStack.destroy();let o=0,s=r.length/e*(o+1);for(let a=0;a<r.length;a++)i[o].putOnBottom(r[a]),s<=a+1&&(o++,s=r.length/e*(o+1))}concatStack(e,i=this.cardStack){let r=Vi.create(i.name);r.location.name=i.location.name,r.location.x=i.location.x,r.location.y=i.location.y,r.posZ=i.posZ,r.zindex=e.zindex,r.rotate=i.rotate;let o=i.drawCardAll(),s=e.drawCardAll();for(let a of s.concat(o))r.putOnBottom(a);i.setLocation(""),i.destroy(),e.setLocation(""),e.destroy()}dispatchCardDropEvent(){let r=this.elementRef.nativeElement.parentElement.children,o=new CustomEvent("carddrop",{detail:this.cardStack,bubbles:!0});for(let s=0;s<r.length;s++)r[s].dispatchEvent(o)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i=this.cardStack.topCard?.size??2,r={x:this.cardStack.location.x+i*this.gridSize/2,y:this.cardStack.location.y+i*this.gridSize/2,z:this.cardStack.posZ};if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(r)}),this.isSelected){let o=()=>this.selectionService.objects.filter(s=>s.aliasName===this.cardStack.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u5c71\u672d",action:null,subActions:[{name:"\u3059\u3079\u3066\u8868\u306b\u3059\u308b",action:()=>{o().forEach(s=>s.faceUpAll()),tt.play(Te.cardDraw)}},{name:"\u3059\u3079\u3066\u88cf\u306b\u3059\u308b",action:()=>{o().forEach(s=>s.faceDownAll()),tt.play(Te.cardDraw)}},{name:"\u3059\u3079\u3066\u6b63\u4f4d\u7f6e\u306b\u3059\u308b",action:()=>{o().forEach(s=>s.uprightAll()),tt.play(Te.cardDraw)}},Zt,{name:"\u3059\u3079\u3066\u30b7\u30e3\u30c3\u30d5\u30eb",action:()=>{tt.play(Te.cardShuffle),o().forEach(s=>{s.shuffle(),ne.call("SHUFFLE_CARD_STACK",{identifier:s.identifier})})}}]})}return e.push(Zt),e}makeContextMenu(){return[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,tt.play(Te.unlock)},checkBox:"check"}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,tt.play(Te.lock)},checkBox:"check"},Zt,{name:"\u30ab\u30fc\u30c9\u3092\uff11\u679a\u5f15\u304f",action:()=>{const i=this.drawCard();if(i){let r;tt.play(Te.cardDraw),r=i.isFront?`${this.cardStack.name} \u304b\u3089 ${""==i.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":i.name} \u3092\u5f15\u3044\u305f`:`${this.cardStack.name} \u304b\u3089 1\u679a\u5f15\u3044\u3066\u4f0f\u305b\u305f`,this.chatMessageService.sendOperationLog(r)}},default:this.cards.length>0,disabled:0==this.cards.length},{name:"\u30ab\u30fc\u30c9\u3092\u5f15\u304f",action:null,subActions:[2,3,4,5,10].map(i=>({name:`${i}\u679a`,action:()=>{const r=[];for(let o=0;o<i;o++){const s=this.drawCard();s&&(r.push(s),(0==o||3==o||9==o)&&tt.play(Te.cardDraw))}if(r.length>0){const o=r.filter(s=>s.isFront);if(0==o.length)this.chatMessageService.sendOperationLog(`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${r.length}\u679a\u5f15\u3044\u3066\u4f0f\u305b\u305f`);else{const s=new Map;for(const c of o){const u=""==c.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":c.name;let f=s.get(u)||0;f+=1,s.set(u,f)}let a=`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${[...s.keys()].map(c=>c+(s.get(c)<=1?"":` \xd7${s.get(c)}\u679a`)).join("\u3001")}`;a+=o.length===r.length?" \u3092\u5f15\u3044\u305f":` \u3092\u5f15\u304d\u3001${r.length-o.length}\u679a\u3092\u4f0f\u305b\u305f`,this.chatMessageService.sendOperationLog(a)}}}})),disabled:0==this.cards.length},Zt,0!=this.cards.length&&this.cardStack.topCard.isFront?{name:"\u4e00\u756a\u4e0a\u3092\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDown(),tt.play(Te.cardDraw)},disabled:0==this.cards.length}:{name:"\u4e00\u756a\u4e0a\u3092\u8868\u306b\u3059\u308b",action:()=>{this.cardStack.topCard&&(this.cardStack.topCard.isFront||this.chatMessageService.sendOperationLog(`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306e\u4e00\u756a\u4e0a\u306e ${""==this.cardStack.topCard.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.cardStack.topCard.name} \u3092\u516c\u958b\u3057\u305f`),this.cardStack.faceUp(),tt.play(Te.cardDraw))},disabled:0==this.cards.length},Zt,{name:"\u3059\u3079\u3066\u8868\u306b\u3059\u308b",action:()=>{this.cardStack.faceUpAll(),tt.play(Te.cardDraw)},disabled:0==this.cards.length},{name:"\u3059\u3079\u3066\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDownAll(),tt.play(Te.cardDraw)},disabled:0==this.cards.length},{name:"\u3059\u3079\u3066\u6b63\u4f4d\u7f6e\u306b\u3059\u308b",action:()=>{this.cardStack.uprightAll(),tt.play(Te.cardDraw)},disabled:0==this.cards.length},Zt,{name:"\u30b7\u30e3\u30c3\u30d5\u30eb",action:()=>{this.cardStack.shuffle(),tt.play(Te.cardShuffle),ne.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier})},disabled:0==this.cards.length},{name:"\u30ab\u30fc\u30c9\u4e00\u89a7\u3092\u898b\u308b...",action:()=>{this.showStackList(this.cardStack),this.chatMessageService.sendOperationLog(`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306e\u30ab\u30fc\u30c9\u4e00\u89a7\u3092\u898b\u305f`)},disabled:0==this.cards.length},Zt,this.isShowTotal?{name:"\u2611 \u679a\u6570\u3092\u8868\u793a",action:()=>{this.cardStack.isShowTotal=!1},checkBox:"check"}:{name:"\u2610 \u679a\u6570\u3092\u8868\u793a",action:()=>{this.cardStack.isShowTotal=!0},checkBox:"check"},{name:"\u30ab\u30fc\u30c9\u30b5\u30a4\u30ba\u3092\u63c3\u3048\u308b",action:()=>{this.cardStack.topCard&&this.cardStack.unifyCardsSize(this.cardStack.topCard.size)},disabled:0==this.cards.length},Zt,{name:"\u5c71\u672d\u3092\u5206\u5272\u3059\u308b",subActions:[{name:"\u4eba\u6570\u3067\u5206\u5272",action:()=>{this.splitStack(jt.peerIds.length),tt.play(Te.cardDraw)}},Zt,...[2,3,4,5,6].map(i=>({name:`${i}\u3064\u306b\u5206\u5272`,action:()=>{this.splitStack(i),tt.play(Te.cardDraw)}}))],disabled:0==this.cards.length},{name:"\u5c71\u672d\u3092\u5d29\u3059",action:()=>{this.breakStack(),tt.play(Te.cardShuffle)},disabled:0==this.cards.length},{name:"\u5c71\u672d\u5168\u4f53\u3092\u88cf\u8fd4\u3059",action:()=>{this.cardStack.inverse(),tt.play(Te.cardDraw),tt.play(Te.cardDraw),ne.call("INVERSE_CARD_STACK",{identifier:this.cardStack.identifier})},disabled:0==this.cards.length},Zt,{name:"\u8a73\u7d30\u3092\u8868\u793a...",action:()=>{this.showDetail(this.cardStack)}},this.cardStack.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.cardStack.getUrls().map(i=>{const r=i.value.toString();return{name:i.name?i.name:r,action:()=>{ke.sameOrigin(r)?window.open(r.trim(),"_blank","noopener"):this.modalService.open(sa,{url:r,title:this.cardStack.name,subTitle:i.name})},disabled:!ke.validUrl(r),error:ke.validUrl(r)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:ke.validUrl(r)&&!ke.sameOrigin(r)}})},this.cardStack.getUrls().length<=0?null:Zt,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let i=this.cardStack.clone();i.location.x+=this.gridSize,i.location.y+=this.gridSize,i.owner="",i.isLocked=!1,i.toTopmost(),tt.play(Te.cardPut)}},{name:"\u5c71\u672d\u3092\u524a\u9664\u3059\u308b",action:()=>{this.cardStack.setLocation("graveyard"),this.cardStack.destroy(),tt.play(Te.sweep)}}]}showDetail(e){ne.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5c71\u672d\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(kl,{title:r,left:i.x-300,top:i.y-300,width:600,height:490}).tabletopObject=e}showStackList(e){ne.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r={left:i.x-200,top:i.y-300,width:400,height:600};this.cardStack.owner=jt.peer.userId,this.panelService.open(ude,r).cardStack=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Pn),Y(Bo),Y(yi),Y(fr),Y(Zr),Y(Ml),Y(tm),Y(lr),Y(Ei),Y(vo))};static#t=this.\u0275cmp=In({type:t,selectors:[["card-stack"]],hostBindings:function(i,r){1&i&&he("carddrop",function(s){return r.onCardDrop(s)})("dragstart",function(s){return r.onDragstart(s)})("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{cardStack:"cardStack",is3D:"is3D"},features:[hr],decls:7,vars:17,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.ondragstart","movable.ondragend","ngClass","movable.option","movable.disable"],["appRotable","",1,"component-content","is-pointer-events-auto","is-3d",3,"rotable.ondragstart","rotable.ondragend","ngClass","rotable.option","rotable.disable"],["class","is-3d",4,"ngIf"],[4,"ngIf"],["class","name-tag is-nowrap is-black-background is-3d number-of-cards is-pointer-events-none","style","z-index: 10",3,"ngStyle",4,"ngIf"],["class","name-tag has-length-limit is-nowrap is-black-background is-3d","style","z-index: 10; color: whitesmoke",3,"ngStyle",4,"ngIf"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"is-3d"],["class","text is-3d","style","width: 100%; height: 100%",3,"ngStyle",4,"ngIf"],[1,"card-image","chrome-smooth-image-trick",3,"ngStyle","src"],[1,"text","is-3d",2,"width","100%","height","100%",3,"ngStyle"],[1,"is-3d",3,"innerHTML"],[1,"rotate-grab","of-left-top","is-3d"],[1,"material-icons",2,"display","inline-block",3,"ngClass"],[1,"rotate-grab","of-left-bottom","is-3d"],[1,"rotate-grab","of-right-bottom","is-3d"],[1,"rotate-grab","of-right-top","is-3d"],[1,"name-tag","is-nowrap","is-black-background","is-3d","number-of-cards","is-pointer-events-none",2,"z-index","10",3,"ngStyle"],[3,"ngClass"],[1,"name-tag","has-length-limit","is-nowrap","is-black-background","is-3d",2,"z-index","10","color","whitesmoke",3,"ngStyle"],[1,"selected-highlight",3,"ngClass"]],template:function(i,r){1&i&&(p(0,"div",0),he("movable.ondragstart",function(){return r.onMove()})("movable.ondragend",function(){return r.onMoved()}),p(1,"div",1),he("rotable.ondragstart",function(){return r.onMove()})("rotable.ondragend",function(){return r.onMoved()}),q(2,mde,4,10,"div",2)(3,_de,13,16,"ng-container",3)(4,bde,3,7,"div",4)(5,vde,5,8,"div",5)(6,yde,1,3,"div",6),g()()),2&i&&(je("width",r.size*r.gridSize,"px"),m("ngClass",Ke(13,dde,r.isEmpty))("movable.option",r.movableOption)("movable.disable",r.isLocked),h(),m("ngClass",Ke(15,hde,!r.isLocked))("rotable.option",r.rotableOption)("rotable.disable",r.isLocked),h(),m("ngIf",r.topCard&&r.imageFile),h(),m("ngIf",!r.isIconHidden),h(),m("ngIf",r.isShowTotal),h(),m("ngIf",r.hasOwner),h(),m("ngIf",r.isSelected))},dependencies:[Ni,ri,Lo,is,Hf,cr],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.is-empty[_ngcontent-%COMP%]{height:100px;width:100px}.is-backface-hidden[_ngcontent-%COMP%]{backface-visibility:hidden}.component[_ngcontent-%COMP%]{position:absolute;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;margin-top:-5px;margin-left:-5px;border:solid 5px #CCCCCC;border-radius:5px;background-color:#ccc;backface-visibility:hidden}.card-image[_ngcontent-%COMP%]{display:block;inset:0;margin:auto;height:auto;width:100%;backface-visibility:hidden}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;position:absolute;box-sizing:border-box;border-radius:5px;background-color:#80d4ff99;inset:-5px}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.rotate-grab[_ngcontent-%COMP%]{display:none;z-index:11}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5;transform-style:preserve-3d;transform:translateZ(.01px)}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:50%;opacity:.9;backface-visibility:hidden}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.text[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.component[_ngcontent-%COMP%]:not(.is-empty):hover   .number-of-cards[_ngcontent-%COMP%]{visibility:hidden}.is-inverse[_ngcontent-%COMP%]{transform:rotate(180deg)}"],data:{animation:[Xn("shuffle",[an("* => active",[rn("800ms ease",En([We({transform:"scale3d(0, 0, 0) rotateZ(0deg)",offset:0}),We({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(360deg)",offset:.5}),We({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(520deg)",offset:.75}),We({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(630deg)",offset:.875}),We({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(720deg)",offset:1})]))]),an("* => inverse",[rn("200ms ease",En([We({transform:"scale3d(1.0, 1.0, 1.0)",offset:0}),We({transform:"scale3d(0.6, 1.2, 1.2)",offset:.5}),We({transform:"scale3d(0, 0.75, 0.75)",offset:.75}),We({transform:"scale3d(0.5, 1.125, 1.125)",offset:.875}),We({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])]),Xn("bounceInOut",[an("void => *",[rn("600ms ease",En([We({transform:"scale3d(0, 0, 0)",offset:0}),We({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),We({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),We({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),We({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),an("* => void",[rn(100,We({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0})}return t})();const xde=["characterImage"],wde=["chatBubble"],Ede=(t,n,e)=>({selected:t,"not-inventory":n,"is-hide-in-pedestal":e}),Z5=(t,n,e,i,r,o,s,a)=>({black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}),Sb=t=>({transform:t}),Ide=t=>({fall:t}),Tde=(t,n,e)=>({inverse:t,"black-paint":n,hollow:e}),Sde=(t,n,e)=>({bottom:t,transform:n,visibility:e}),Mde=t=>({"is-magnetic":t}),Dde=t=>({opacity:t}),kde=(t,n)=>({"background-color":t,transform:n}),Ode=t=>({"is-hide-in-tag":t}),Ade=t=>({"is-hide-in":t}),q5=(t,n,e)=>({emote:t,rubied:n,"is-whisper":e}),X5=t=>({transform:t});function Pde(t,n){if(1&t&&Ge(0,"div",33),2&t){const e=v();m("ngClass",Ke(1,Mde,e.isMagnetic))}}function Fde(t,n){if(1&t&&(Ge(0,"img",34),Ut(1,"safe")),2&t){const e=v();je("height",e.characterShadowImageHeight,"px")("filter","brightness(0) blur(1px)"+(e.isHideIn?" invert(85%)":"")),m("src",zt(1,7,0<e.shadowImageFile.url.length?e.shadowImageFile.url:e.imageFile.url,"resourceUrl"),bn)("ngStyle",Ke(10,Dde,(e.isHollow?.5:.7)*(e.isHideIn?.85:1)))("@switchImageShadow",e.gameCharacter.currntImageIndex)}}function Nde(t,n){if(1&t&&(p(0,"div",35)(1,"div",36)(2,"b"),y(3),g()(),p(4,"div",37)(5,"b"),y(6),g()()()),2&t){const e=v();m("ngStyle",Tn(3,kde,e.ownerColor+"dd","translateX(-50%) translateX("+e.size*e.gridSize/2+"px) translateY(6px) rotateX("+e.nameTagRotate+"deg)")),h(3),Xe(e.ownerName),h(3),Xe(e.ownerName)}}function Rde(t,n){if(1&t&&(p(0,"div",38)(1,"div",39),y(2),g(),p(3,"div",40),y(4),g()()),2&t){const e=v();m("ngClass",Ke(4,Ode,e.isHideIn))("ngStyle",Ke(6,Sb,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateX("+e.nameTagRotate+"deg)")),h(2),Xe(e.name),h(2),Xe(e.name)}}function Lde(t,n){if(1&t){const e=Le();p(0,"img",41,1),Ut(2,"safe"),he("load",function(){return V(e),H(v().onImageLoad())}),g()}if(2&t){const e=v();je("height",e.characterImageHeight,"px"),m("src",zt(2,4,e.imageFile.url,"resourceUrl"),bn)("ngClass",Ke(7,Ade,e.isHideIn))}}function Bde(t,n){if(1&t&&(p(0,"span",48),Ge(1,"img",49),Ut(2,"safe"),g()),2&t){const e=v(2);h(),je("border-color",e.dialogColor),m("src",zt(2,3,e.dialogFaceIcon.url,"resourceUrl"),bn)}}function Ude(t,n){if(1&t&&(p(0,"span",48),Ge(1,"img",49),Ut(2,"safe"),g()),2&t){const e=v(2);h(),je("border-color",e.dialogColor),m("src",zt(2,3,e.dialogFaceIcon.url,"resourceUrl"),bn)}}function zde(t,n){if(1&t&&(p(0,"div",42)(1,"div",43)(2,"p",44),q(3,Bde,3,6,"span",45),Ge(4,"span",46),Ut(5,"safe"),g(),p(6,"p",47),q(7,Ude,3,6,"span",45),Ge(8,"span",46),Ut(9,"safe"),g()()()),2&t){const e=v();je("color",!e.isEmote&&e.isWhisper?"#ccc":e.dialogColor),m("@fadeAndScaleInOut",e.isEmote),h(2),je("min-width",e.dialogChatBubbleMinWidth,"px")("border-color",e.dialogColor),m("ngClass",Qs(23,q5,e.isEmote,e.isRubied,e.isWhisper)),h(),m("ngIf",!e.isEmote&&e.isUseFaceIcon&&0<(null==e.dialogFaceIcon?null:e.dialogFaceIcon.url.length)),h(),m("innerHTML",zt(5,17,e.dialogText,"html"),$r),h(2),je("min-width",e.dialogChatBubbleMinWidth,"px")("border-color",e.dialogColor),m("ngClass",Qs(27,q5,e.isEmote,e.isRubied,e.isWhisper)),h(),m("ngIf",!e.isEmote&&e.isUseFaceIcon&&0<(null==e.dialogFaceIcon?null:e.dialogFaceIcon.url.length)),h(),m("innerHTML",zt(9,20,e.dialogText,"html"),$r)}}function Hde(t,n){if(1&t&&(p(0,"div",50)(1,"div",43)(2,"span",51)(3,"i"),y(4),g()(),p(5,"span",52)(6,"i"),y(7),g()()(),p(8,"div",43)(9,"span",53),y(10),g(),p(11,"span",54),y(12),g()(),p(13,"div",55)(14,"span",51)(15,"i"),y(16),g()(),p(17,"span",52)(18,"i"),y(19),g()()()()),2&t){const e=v();je("height",e.math.abs(e.altitude*e.gridSize)-(e.altitude>0?0:e.chatBubbleAltitude+4),"px"),m("ngStyle",Ke(14,X5,"translateX("+e.size*e.gridSize/2+"px) translateY("+-e.size*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),h(),je("visibility",e.altitude>0?"visible":"hidden"),h(3),Xe(e.elevation),h(3),Xe(e.elevation),h(3),Xe(e.math.abs(e.altitude)),h(2),Xe(e.math.abs(e.altitude)),h(),je("visibility",e.altitude<0?"visible":"hidden"),m("ngStyle",Ke(16,X5,"translateY("+(e.chatBubbleAltitude+4)+"px)")),h(3),Xe(e.elevation),h(3),Xe(e.elevation)}}let Vde=(()=>{class t{get name(){return this.gameCharacter.name}get size(){return Hi.clampMin(this.gameCharacter.size)}get altitude(){return this.gameCharacter.altitude}set altitude(e){this.gameCharacter.altitude=e}get height(){return Hi.clampMin(this.gameCharacter.height)}get imageFile(){return this.gameCharacter.imageFile}get rotate(){return this.gameCharacter.rotate}set rotate(e){this.gameCharacter.rotate=e}get roll(){return this.gameCharacter.roll}set roll(e){this.gameCharacter.roll=e}get isDropShadow(){return this.gameCharacter.isDropShadow}set isDropShadow(e){this.gameCharacter.isDropShadow=e}get isAltitudeIndicate(){return this.gameCharacter.isAltitudeIndicate}set isAltitudeIndicate(e){this.gameCharacter.isAltitudeIndicate=e}get isInverse(){return this.gameCharacter.isInverse}set isInverse(e){this.gameCharacter.isInverse=e}get isHollow(){return this.gameCharacter.isHollow}set isHollow(e){this.gameCharacter.isHollow=e}get isBlackPaint(){return this.gameCharacter.isBlackPaint}set isBlackPaint(e){this.gameCharacter.isBlackPaint=e}get aura(){return this.gameCharacter.aura}set aura(e){this.gameCharacter.aura=e}get isNotRide(){return this.gameCharacter.isNotRide}set isNotRide(e){this.gameCharacter.isNotRide=e}get isUseIconToOverviewImage(){return this.gameCharacter.isUseIconToOverviewImage}set isUseIconToOverviewImage(e){this.gameCharacter.isUseIconToOverviewImage=e}get ownerName(){return this.gameCharacter.ownerName}get ownerColor(){return this.gameCharacter.ownerColor}get isHideIn(){return!!this.gameCharacter.owner}get isVisible(){return this.gameCharacter.isVisible}get isGMMode(){return!!Fe.myCursor&&Fe.myCursor.isGMMode}get faceIcon(){return this.gameCharacter.faceIcon}get dialogFaceIcon(){return this.dialog&&this.dialog.faceIconIdentifier?on.instance.get(this.dialog.faceIconIdentifier):null}get shadowImageFile(){return this.gameCharacter.shadowImageFile}get elevation(){return+((this.gameCharacter.posZ+this.altitude*this.gridSize)/this.gridSize).toFixed(1)}get selectionState(){return this.selectionService.state(this.gameCharacter)}get isSelected(){return this.selectionState!==$n.NONE}get isMagnetic(){return this.selectionState===$n.MAGNETIC}set dialog(e){if(!this.gameCharacter||this.gameCharacter.isHideIn)return;clearTimeout(this.dialogTimeOutId),clearInterval(this.chatIntervalId);let i=ke.cr(e.text);const r=ke.isEmote(i),o=[],s=/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g;let a,c=0,u=0;if(!r)for(i=i.replace(/[\u3002\u3001]{3}/g,"\u2026").replace(/[\u3002\u3001]{2}/g,"\u2025").replace(/(\u3002|[\r\n]{2,})/g,"$1                            ").trimEnd();null!==(a=s.exec(i));){let K=a.index-3*c;o.push({base:a[1],ruby:a[2],start:K-u,end:K+a[1].length-u-1}),c++,u+=a[2].length}let f=1e3/Array.from(i).length>36?1e3/Array.from(i).length:36;f>200&&(f=200),this.dialogTimeOutId=setTimeout(()=>{this.gameCharacter.dialog=null,this.gameCharacter.text="",this.gameCharacter.isEmote=!1,this.changeDetector.markForCheck()},Array.from(i).length*f+6e3),this.gameCharacter.dialog=e,this.gameCharacter.isEmote=r,c=0;let b=0,C=0,x="",M=o.shift(),U="",W=!1;if(r)this.gameCharacter.text=i,this.changeDetector.markForCheck();else{const K=Array.from(i.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a.+?\u300b/g,"$1"));this.chatIntervalId=setInterval(()=>{let $=K[c],ge=$.length>1;if($){if(!W&&M&&b>=M.start&&(x+="<ruby>",W=!0,C=0),x+=ke.escapeHtml($),W){C+=1;let ye=M.ruby;U="<rt>"+ke.escapeHtml(Array.from(ye).slice(0,Math.ceil(Array.from(ye).length*(C/Array.from(M.base).length))).join(""))+"</rt>"}W&&M&&b>=M.end-(ge?1:0)&&(x+=U+"</ruby>",W=!1,M=o.shift()),b+=$.length}c+=1,this.gameCharacter.text=x+(W?U+"</ruby>":""),this.changeDetector.markForCheck(),c>=K.length&&clearInterval(this.chatIntervalId)},f)}}get dialogText(){if(!this.gameCharacter||!this.gameCharacter.text)return"";const e=this.gameCharacter.text.replace(/\u3002/g,"\u3002\n\n").split(/[\r\n]{2,}/g).filter(i=>i.trim());return e.length>0?e.reverse()[0].trim():""}get isRubied(){return!(!this.gameCharacter||!this.gameCharacter.text)&&-1<this.dialogText.indexOf("<ruby>")}get dialogChatBubbleMinWidth(){const e=this.characterImageWidth+2.1*this.gridSize,i=this.isUseFaceIcon&&this.dialogFaceIcon&&this.dialogFaceIcon.url,r=11*Array.from(this.dialogText).length+52+(i?32:0);return e<r?e:r}get dialog(){return this.gameCharacter.dialog}get chatBubbleXDeg(){let e=90-this.viewRotateX;return e<0&&(e=360+e),e%=360,e>180&&(e=-(180-(e-180))),e>90&&(e=90),e<-90&&(e=-90),e/1.5}get characterImageHeight(){if(!this.characterImage||!this.naturalImageHeight)return 0;if(this.height>0)return this.gridSize*this.height;let e=this.naturaHeightWidthRatio;return e>this.heightWidthRatio&&(e=this.heightWidthRatio),e*this.gridSize*this.size}get characterImageWidth(){if(!this.characterImage||!this.naturalImageWidth)return 0;if(this.height<=0)return this.gridSize*this.size;let e=this.naturaHeightWidthRatio;return e>this.heightWidthRatio&&(e=this.heightWidthRatio),this.gridSize*this.height/e}get characterShadowImageHeight(){return this.characterImageHeight}get characterShadowImageWidth(){return this.characterImageWidth}get characterShadowOffset(){let e=0;return.2<this.height&&this.height<=.3?e=.09:.1<this.height&&this.height<=.2?e=.19:0<this.height&&this.height<=.1&&(e=.29),this.gridSize*this.size/2-.99*this.characterShadowImageHeight-this.gridSize*e}get chatBubbleAltitude(){let e=Math.cos(this.roll*Math.PI/180),i=Math.abs(Math.sin(this.roll*Math.PI/180));e<.5&&(e=.5),i<.5&&(i=.5);const r=(this.characterImageHeight+(""!=this.name?24:0))*e+4,o=this.characterImageWidth/2*i+4+this.characterImageWidth/2;let s=r>o?r:o;return this.gameCharacter.chatBubbleAltitude=s,s}get nameTagRotate(){let e=this.viewRotateX%360-90,i=(this.viewRotateZ+this.rotate)%360,r=this.roll%360;return i=i>0?i:360+i,r=r>0?r:360+r,(e>0?e:360+e)*(90<i&&i<270?1:-1)*(90<=r&&r<=270?-1:1)}get isListen(){return this.dialog&&this.dialog.text&&!this.dialog.dialogTest&&this.dialog.text.trim().length>0}get isWhisper(){return this.dialog&&this.dialog.secret}get isEmote(){return this.gameCharacter.isEmote}get isUseFaceIcon(){return this.dialog&&this.dialog.faceIconIdentifier}get dialogColor(){return this.dialog&&this.dialog.color?this.dialog.color:Fe.CHAT_DEFAULT_COLOR}constructor(e,i,r,o,s,a,c){this.contextMenuService=e,this.panelService=i,this.changeDetector=r,this.pointerDeviceService=o,this.ngZone=s,this.modalService=a,this.selectionService=c,this.gameCharacter=null,this.is3D=!1,this.gridSize=50,this.math=Math,this.stringUtil=ke,this.viewRotateX=50,this.viewRotateZ=10,this.heightWidthRatio=1.5,this.selected=!1,this.dialogTimeOutId=null,this.chatIntervalId=null,this.naturalImageWidth=0,this.naturalImageHeight=0,this.naturaHeightWidthRatio=1,this.movableOption={},this.rotableOption={},this.rollOption={}}ngOnChanges(){ne.unregister(this),ne.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.gameCharacter?.identifier}`,e=>{this.gameCharacter.imageFiles.length<=0&&(this.naturalImageHeight=0,this.naturalImageWidth=0,this.naturaHeightWidthRatio=1),this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.gameCharacter?.identifier}`,e=>{this.gameCharacter.imageFiles.length<=0&&(this.naturalImageHeight=0,this.naturalImageWidth=0,this.naturaHeightWidthRatio=1),this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateX=e.data.x,this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on("SELECT_TABLETOP_OBJECT",-1e3,e=>{this.ngZone.run(()=>{this.selected=!(!e.data.highlighting||e.data.identifier!==this.gameCharacter.identifier),this.changeDetector.markForCheck()})}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on("POPUP_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&this.ngZone.run(()=>{this.dialog=e.data,this.changeDetector.markForCheck()})}).on("FAREWELL_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&(this.ngZone.run(()=>{this.gameCharacter.dialog=null,this.gameCharacter.text="",this.gameCharacter.isEmote=!1,this.changeDetector.markForCheck()}),clearTimeout(this.dialogTimeOutId),clearInterval(this.chatIntervalId))}).on(`UPDATE_SELECTION/identifier/${this.gameCharacter?.identifier}`,e=>{this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.gameCharacter,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain","text-note","character"]},this.rotableOption={tabletopObject:this.gameCharacter},this.rollOption={tabletopObject:this.gameCharacter,targetPropertyName:"roll"}}ngAfterViewInit(){queueMicrotask(()=>{this.gameCharacter.isLoaded=!0})}ngOnDestroy(){clearTimeout(this.dialogTimeOutId),clearInterval(this.chatIntervalId),this.gameCharacter&&(this.gameCharacter.text="",this.gameCharacter.isEmote=!1),ne.unregister(this)}onDragstart(e){console.log("Dragstart Cancel !!!!"),e.stopPropagation(),e.preventDefault()}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.name)}onMove(){this.contextMenuService.close(),this.isHideIn||tt.play(Te.piecePick)}onMoved(){this.gameCharacter&&this.gameCharacter.text&&ne.call("FAREWELL_CHAT_BALLOON",{characterIdentifier:this.gameCharacter.identifier}),this.isHideIn||tt.play(Te.piecePut),this.selected=!1}onImageLoad(){this.naturalImageWidth=this.characterImage.nativeElement.naturalWidth,this.naturalImageHeight=this.characterImage.nativeElement.naturalHeight,this.naturaHeightWidthRatio=this.naturalImageWidth&&this.naturalImageHeight?this.naturalImageHeight/this.naturalImageWidth:1}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i={x:this.gameCharacter.location.x+this.gameCharacter.size*this.gridSize/2,y:this.gameCharacter.location.y+this.gameCharacter.size*this.gridSize/2,z:this.gameCharacter.posZ};if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),this.isSelected){let r=()=>this.selectionService.objects.filter(o=>o.aliasName===this.gameCharacter.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",action:null,subActions:[{name:"\u3059\u3079\u3066\u5171\u6709\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5",action:()=>{r().forEach(o=>{o.setLocation("common"),this.selectionService.remove(o)}),tt.play(Te.piecePut)}},{name:"\u3059\u3079\u3066\u500b\u4eba\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5",action:()=>{r().forEach(o=>{o.setLocation(jt.peerId),this.selectionService.remove(o)}),tt.play(Te.piecePut)}},{name:"\u3059\u3079\u3066\u5893\u5834\u306b\u79fb\u52d5",action:()=>{r().forEach(o=>{o.setLocation("graveyard"),this.selectionService.remove(o)}),tt.play(Te.sweep)}}]})}return e.push(Zt),e}makeContextMenu(){return[{name:this.isHideIn?"\u4f4d\u7f6e\u3092\u516c\u958b\u3059\u308b":"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u308b\uff08\u30b9\u30c6\u30eb\u30b9\uff09",action:()=>{this.isHideIn?(this.gameCharacter.owner="",tt.play(Te.piecePut)):(!gn.isStealthMode&&!Fe.myCursor.isGMMode&&this.modalService.open(Fr,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:ur.OK,materialIcon:"disabled_visible"}),this.gameCharacter.owner=jt.peer.userId,tt.play(Te.sweep),ne.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier})),ne.call("UPDATE_INVENTORY",!0)}},Zt,this.gameCharacter.imageFiles.length<=1?null:{name:"\u753b\u50cf\u5207\u308a\u66ff\u3048",action:null,subActions:this.gameCharacter.imageFiles.map((i,r)=>({name:this.gameCharacter.currntImageIndex==r?"\u25c9":"\u25cb",action:()=>{this.changeImage(r)},default:this.gameCharacter.currntImageIndex==r,icon:i,checkBox:"radio"}))},this.gameCharacter.imageFiles.length<=1?null:Zt,this.isUseIconToOverviewImage?{name:"\u2611 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{this.isUseIconToOverviewImage=!1,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{this.isUseIconToOverviewImage=!0,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},this.gameCharacter.isShowChatBubble?{name:"\u2611 \u{1f4ad}\u306e\u8868\u793a",action:()=>{this.gameCharacter.isShowChatBubble=!1,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u{1f4ad}\u306e\u8868\u793a",action:()=>{this.gameCharacter.isShowChatBubble=!0,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},this.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!1,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!0,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},{name:"\u753b\u50cf\u52b9\u679c",action:null,subActions:[this.isInverse?{name:"\u2611 \u53cd\u8ee2",action:()=>{this.isInverse=!1,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u53cd\u8ee2",action:()=>{this.isInverse=!0,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},this.isHollow?{name:"\u2611 \u307c\u304b\u3057",action:()=>{this.isHollow=!1,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u307c\u304b\u3057",action:()=>{this.isHollow=!0,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},this.isBlackPaint?{name:"\u2611 \u9ed2\u5857\u308a",action:()=>{this.isBlackPaint=!1,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u9ed2\u5857\u308a",action:()=>{this.isBlackPaint=!0,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},{name:"\u30aa\u30fc\u30e9",action:null,subActions:[{name:(-1==this.aura?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{this.aura=-1,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"radio"},Zt].concat(["\u30d6\u30e9\u30c3\u30af","\u30d6\u30eb\u30fc","\u30b0\u30ea\u30fc\u30f3","\u30b7\u30a2\u30f3","\u30ec\u30c3\u30c9","\u30de\u30bc\u30f3\u30bf","\u30a4\u30a8\u30ed\u30fc","\u30db\u30ef\u30a4\u30c8"].map((i,r)=>({name:`${this.aura==r?"\u25c9":"\u25cb"} ${i}`,colorSample:!0,action:()=>{this.aura=r,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"radio"})))},Zt,{name:"\u30ea\u30bb\u30c3\u30c8",action:()=>{this.isInverse=!1,this.isHollow=!1,this.isBlackPaint=!1,this.aura=-1,ne.trigger("UPDATE_INVENTORY",null)},disabled:!this.isInverse&&!this.isHollow&&!this.isBlackPaint&&-1==this.aura}]},Zt,this.isNotRide?{name:"\u2610 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{this.isNotRide=!1,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2611 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{this.isNotRide=!0,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,this.isHideIn||tt.play(Te.sweep))},altitudeHande:this.gameCharacter},Zt,{name:"\u8a73\u7d30\u3092\u8868\u793a...",action:()=>{this.showDetail(this.gameCharacter)}},{name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a...",action:()=>{this.showChatPalette(this.gameCharacter)}},{name:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a...",action:()=>{this.showStandSetting(this.gameCharacter)}},Zt,{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.gameCharacter.getUrls().map(i=>{const r=i.value.toString();return{name:i.name?i.name:r,action:()=>{ke.sameOrigin(r)?window.open(r.trim(),"_blank","noopener"):this.modalService.open(sa,{url:r,title:this.gameCharacter.name,subTitle:i.name})},disabled:!ke.validUrl(r),error:ke.validUrl(r)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:ke.validUrl(r)&&!ke.sameOrigin(r)}}),disabled:this.gameCharacter.getUrls().length<=0},Zt,this.gameCharacter.isInventoryIndicate?{name:"\u2611 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{this.gameCharacter.isInventoryIndicate=!1,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{this.gameCharacter.isInventoryIndicate=!0,ne.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},{name:"\u30c6\u30fc\u30d6\u30eb\u304b\u3089\u79fb\u52d5",action:null,subActions:[{name:"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea",action:()=>{ne.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation("common"),this.selectionService.remove(this.gameCharacter),tt.play(Te.piecePut)}},{name:"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea",action:()=>{ne.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation(jt.peerId),this.selectionService.remove(this.gameCharacter),tt.play(Te.piecePut)}},{name:"\u5893\u5834",action:()=>{ne.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation("graveyard"),this.selectionService.remove(this.gameCharacter),tt.play(Te.sweep)}}]},Zt,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let i=this.gameCharacter.clone();i.location.x+=this.gridSize,i.location.y+=this.gridSize,i.update(),tt.play(Te.piecePut)}},{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b\uff08\u81ea\u52d5\u63a1\u756a\uff09",action:()=>{const i=this.gameCharacter.clone(),r=i.name.split("_");let o;o=r.length>1&&/\d+/.test(r[r.length-1])?r.slice(0,r.length-1).join("_"):r.join("_");let s=0;for(const a of bt.instance.getObjects(gn)){if(!a.name.startsWith(o))continue;let c=a.name.match(/_(\d+)$/)?+RegExp.$1:0;c>s&&(s=c)}i.name=o+"_"+(s+1),i.location.x+=this.gridSize,i.location.y+=this.gridSize,i.update(),tt.play(Te.piecePut)}},Zt,{name:"\u524a\u9664\u3059\u308b\uff08\u5893\u5834\u3078\u79fb\u52d5\uff09",action:()=>{ne.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation("graveyard"),this.selectionService.remove(this.gameCharacter),tt.play(Te.sweep)}}]}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(r+=" - "+e.name),this.panelService.open(kl,{title:r,left:i.x-400,top:i.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(Qg,{left:i.x-250,top:i.y-175,width:620,height:350}).character=e}showStandSetting(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(pb,{left:i.x-400,top:i.y-175,width:730,height:572}).character=e}changeImage(e){this.gameCharacter.currntImageIndex!=e&&(this.gameCharacter.currntImageIndex=e,this.isHideIn||tt.play(Te.surprise),ne.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),ne.trigger("UPDATE_INVENTORY",null))}nextImage(){this.gameCharacter.imageFiles.length<=1||this.changeImage(this.gameCharacter.currntImageIndex+1>=this.gameCharacter.imageFiles.length?0:this.gameCharacter.currntImageIndex+1)}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Bo),Y(yi),Y(Zr),Y(lr),Y(Pn),Y(Ei),Y(Ml))};static#t=this.\u0275cmp=In({type:t,selectors:[["game-character"]],viewQuery:function(i,r){if(1&i&&(Ln(xde,5),Ln(wde,5)),2&i){let o;Bn(o=Un())&&(r.characterImage=o.first),Bn(o=Un())&&(r.chatBubble=o.first)}},hostBindings:function(i,r){1&i&&he("dragstart",function(s){return r.onDragstart(s)})("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{gameCharacter:"gameCharacter",is3D:"is3D"},features:[hr],decls:37,vars:86,consts:[["chatBubble",""],["characterImage",""],["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.ondragstart","movable.ondragend","movable.option"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.ondragstart","rotable.ondragend","rotable.option"],[1,"pedestal-grab","rotate-grab"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"pedestal-inner",3,"ngClass"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"pedestal-outer"],[1,"is-pointer-events-none","is-3d",2,"transform-origin","center bottom"],[1,"image-box","is-3d",2,"transform-origin","center 66%"],[1,"aura","is-3d",2,"pointer-events","none",3,"ngClass"],[1,"is-3d",2,"pointer-events","none","transition","transform 132ms 0s ease",3,"ngStyle"],["class","image drop-shadow is-3d chrome-smooth-image-trick","style","pointer-events: none",3,"height","src","filter","ngStyle",4,"ngIf"],[1,"upright-transform","is-fit-width","is-3d",3,"dblclick","ngClass","ngStyle"],["appRotable","",1,"rotate-frame","is-3d",2,"position","absolute",3,"rotable.ondragstart","rotable.ondragend","rotable.option"],[1,"rotate-inner","is-3d"],["class","owner-tag is-nowrap is-black-background is-3d",3,"ngStyle",4,"ngIf"],["class","name-tag is-nowrap is-black-background is-3d",3,"ngClass","ngStyle",4,"ngIf"],[1,"is-pointer-events-none","is-3d","aura",3,"ngClass"],[1,"inverser","is-3d",3,"ngClass"],[1,"image-box","is-3d"],["class","image is-3d chrome-smooth-image-trick",3,"src","ngClass","height","load",4,"ngIf"],[1,"grab-group","is-3d"],[1,"rotate-grab","rotate-grab-icon","of-top","is-3d",3,"ngStyle"],[1,"material-icons"],[1,"rotate-grab","rotate-grab-icon","of-bottom","is-3d",3,"ngStyle"],[1,"chat-bubble","is-3d",3,"ngStyle"],["class","is-3d","style","transform-origin: center bottom;",3,"color",4,"ngIf"],["class","is-3d","style","display: flex; flex-flow: column nowrap; justify-content: space-between; border-left: 2px dashed black; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],[1,"selected-highlight",3,"ngClass"],[1,"image","drop-shadow","is-3d","chrome-smooth-image-trick",2,"pointer-events","none",3,"src","ngStyle"],[1,"owner-tag","is-nowrap","is-black-background","is-3d",3,"ngStyle"],[1,"fornt-tag","is-3d",2,"color","whitesmoke"],[1,"back-tag","is-3d",2,"color","whitesmoke"],[1,"name-tag","is-nowrap","is-black-background","is-3d",3,"ngClass","ngStyle"],[1,"fornt-tag","has-length-limit","is-3d"],[1,"back-tag","has-length-limit","is-3d"],[1,"image","is-3d","chrome-smooth-image-trick",3,"load","src","ngClass"],[1,"is-3d",2,"transform-origin","center bottom"],[1,"is-3d"],[1,"is-3d","chat-bubble-buyo",2,"position","absolute","backface-visibility","hidden",3,"ngClass"],["class","face-icon-box is-3d",4,"ngIf"],[3,"innerHTML"],[1,"is-3d","chat-bubble-buyo","back",2,"backface-visibility","hidden","transform","rotateY(-180deg)",3,"ngClass"],[1,"face-icon-box","is-3d"],[1,"face-icon","is-3d",3,"src"],[1,"is-3d",2,"display","flex","flex-flow","column nowrap","justify-content","space-between","border-left","2px dashed black","transform-origin","top left",3,"ngStyle"],[1,"elevation-indicator","is-3d",2,"position","absolute"],[1,"elevation-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"is-3d",3,"ngStyle"]],template:function(i,r){if(1&i){const o=Le();p(0,"div",2),he("movable.ondragstart",function(){return V(o),H(r.onMove())})("movable.ondragend",function(){return V(o),H(r.onMoved())}),p(1,"div",3)(2,"div",4),he("rotable.ondragstart",function(){return V(o),H(r.onMove())})("rotable.ondragend",function(){return V(o),H(r.onMoved())}),p(3,"div",5)(4,"div",6)(5,"div",7),y(6,"autorenew"),g(),p(7,"div",8),y(8,"autorenew"),g()()(),Ge(9,"div",9),q(10,Pde,1,3,"div",10),Ge(11,"div",11),p(12,"div",12)(13,"div",13)(14,"div",14)(15,"div",15),q(16,Fde,2,12,"img",16),g()()()(),p(17,"div",17),he("dblclick",function(){return V(o),H(r.nextImage())}),p(18,"div",18),he("rotable.ondragstart",function(){return V(o),H(r.onMove())})("rotable.ondragend",function(){return V(o),H(r.onMoved())}),p(19,"div",19),q(20,Nde,7,6,"div",20)(21,Rde,5,8,"div",21),p(22,"div",22)(23,"div",23)(24,"span",24),q(25,Lde,3,9,"img",25),g()()(),p(26,"div",26)(27,"div",27)(28,"i",28),y(29,"autorenew"),g()(),p(30,"div",29)(31,"i",28),y(32,"autorenew"),g()()()()(),p(33,"div",30,0),q(35,zde,10,31,"div",31),g()()(),q(36,Hde,20,18,"div",32),g()()}2&i&&(je("width",r.size*r.gridSize,"px")("height",r.size*r.gridSize,"px"),m("movable.option",r.movableOption),h(),m("@bounceInOut","in"),h(),m("rotable.option",r.rotableOption),h(7),m("@switchImagePedestal",r.gameCharacter.currntImageIndex)("ngClass",Qs(46,Ede,r.selected,!r.gameCharacter.isInventoryIndicate,r.isHideIn)),h(),m("ngIf",r.isSelected),h(),m("@switchImagePedestal",r.gameCharacter.currntImageIndex),h(),je("transform","translateX("+(r.size*r.gridSize-r.characterShadowImageWidth)/2+"px) translateY("+r.characterShadowOffset+"px) scale(1.0, 0.66)"),h(),je("width",r.characterShadowImageWidth,"px")("height",r.characterShadowImageHeight,"px")("transform","rotateZ("+r.roll+"deg)"),h(),m("ngClass",Yl(50,Z5,0==r.aura,1==r.aura,2==r.aura,3==r.aura,4==r.aura,5==r.aura,6==r.aura,7==r.aura)),h(),m("ngStyle",Ke(59,Sb,"scaleX("+(r.isInverse?"-1":"1")+")")),h(),m("ngIf",r.isDropShadow&&(0<r.imageFile.url.length||0<r.shadowImageFile.url.length)),h(),m("ngClass",Ke(61,Ide,0==r.altitude))("ngStyle",Ke(63,Sb,"rotateY(90deg) rotateZ(-90deg) rotateY(-90deg) translateY(-50%) translateY("+-r.altitude*r.gridSize+"px)")),h(),je("transform-origin","center "+.333*-r.characterImageHeight+"px"),m("rotable.option",r.rollOption),h(),je("transform","translateZ("+-r.size*r.gridSize/2+"px)"),h(),m("ngIf",r.isGMMode&&r.isHideIn&&0<r.ownerName.length),h(),m("ngIf",0<r.name.length),h(),m("@switchImage",r.gameCharacter.currntImageIndex)("ngClass",Yl(65,Z5,0==r.aura,1==r.aura,2==r.aura,3==r.aura,4==r.aura,5==r.aura,6==r.aura,7==r.aura)),h(),m("ngClass",Qs(74,Tde,r.isInverse,r.isBlackPaint,r.isHollow)),h(),je("width",r.characterImageWidth,"px")("height",r.characterImageHeight,"px")("transform","translateX("+(r.size*r.gridSize-r.characterImageWidth)/2+"px)"),h(),m("ngIf",0<r.imageFile.url.length),h(2),m("ngStyle",Ke(78,Sb,"translateX(-50%) translateX("+r.size*r.gridSize/2+"px) translateY("+(-r.characterImageHeight-(r.isGMMode&&r.isHideIn?20:0))+"px)")),h(3),m("ngStyle",Ke(80,Sb,"translateX(-50%) translateX("+r.size*r.gridSize/2+"px")),h(3),m("ngStyle",Qs(82,Sde,r.chatBubbleAltitude-(r.isEmote?r.gridSize/2:0)-4+"px","translateZ("+-r.size*r.gridSize/2+"px) translateX(-50%) translateX("+r.size*r.gridSize/2+"px) rotateY("+(r.rotate+r.viewRotateZ)+"deg) rotateX("+r.chatBubbleXDeg+"deg)",r.gameCharacter.isShowChatBubble?"visible":"hidden")),h(2),m("ngIf",r.isListen),h(),m("ngIf",r.isAltitudeIndicate&&(r.altitude<=-.5||.5<=r.altitude)))},dependencies:[Ni,ri,Lo,is,Hf,cr],styles:['[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.upright-transform.fall[_ngcontent-%COMP%]{transition:transform 132ms cubic-bezier(.21,.97,.75,1.25)}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;backface-visibility:hidden}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:100%;box-sizing:border-box;border-top:solid 28px #999;border-left:solid 12px #999;border-right:solid 12px #CCC;border-bottom:solid 28px #CCC;border-radius:37px}.pedestal-inner[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 6px #FFCC80;border-radius:25px}.pedestal-inner.not-inventory[_ngcontent-%COMP%]{border-color:#80ccee}.pedestal-outer[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 2px #212121;border-radius:25px}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border-radius:25px;background-color:#80d4ff99}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{bottom:0;left:0;right:0;margin:auto;width:100%;height:auto;vertical-align:bottom}.image-box[_ngcontent-%COMP%]{display:inline-block;text-align:center}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:contain;object-position:50% 100%;margin-bottom:0;margin-top:auto;image-rendering:-webkit-optimize-contrast;image-rendering:crisp-edges}.inverse[_ngcontent-%COMP%]{transform:rotateY(-180deg)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #fff)}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:13px;padding:2px 8px;border-radius:12px;position:absolute;top:-26px;transform-origin:center bottom}.owner-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:11px;padding:2px 9px;border-radius:6px;position:absolute;top:-55px;transform-origin:center bottom}.rotate-frame[_ngcontent-%COMP%]{bottom:0;left:0;right:0;overflow:visible}.rotate-inner[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;width:100%;height:auto;overflow:visible}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.is-black-background.is-hide-in-tag[_ngcontent-%COMP%]{color:#1e1e1e;background-color:#e9e9e9cc}.fornt-tag[_ngcontent-%COMP%]{backface-visibility:hidden}.back-tag[_ngcontent-%COMP%]{position:absolute;top:3px;backface-visibility:hidden;transform:rotateY(-180deg)}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:24em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;bottom:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{position:absolute;width:24px;top:0;left:0;right:0;margin:auto;color:#444}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .pedestal-outer[_ngcontent-%COMP%]{transform-style:preserve-3d;transform:translateZ(.01px)}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.altitude-indicator[_ngcontent-%COMP%]{font-size:10px}.elevation-indicator[_ngcontent-%COMP%], .altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;color:#000;text-shadow:#f5f5f5 0px 0px 3px;backface-visibility:hidden}.elevation-indicator[_ngcontent-%COMP%]{font-weight:bolder;font-size:12px}.chat-bubble[_ngcontent-%COMP%]{position:absolute;pointer-events:none;transform-origin:center calc(100% + 12px)}.chat-bubble[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{box-sizing:border-box;display:inline-block;max-width:100%;min-width:130px;font-size:13px;background:linear-gradient(-30deg,#f0dabde6,#fff4e8e6);border:1px solid;border-radius:24px;margin:0;padding:6px 12px;white-space:pre-wrap;word-break:break-word;overflow-wrap:anywhere;text-align:center}.chat-bubble[_ngcontent-%COMP%]   p.rubied[_ngcontent-%COMP%]{padding-top:12px}.chat-bubble[_ngcontent-%COMP%]   p.emote[_ngcontent-%COMP%]{text-align:center;font-size:38px;font-weight:700;border:none;background:none;min-width:300px;-webkit-text-stroke:1px rgb(240,218,189);letter-spacing:-2px;white-space:pre}.chat-bubble[_ngcontent-%COMP%]   p.is-whisper[_ngcontent-%COMP%]{border-radius:24px 12px;font-size:13px;background:#555c;box-shadow:0 0 2px #ccc}.chat-bubble[_ngcontent-%COMP%]   p.is-whisper.emote[_ngcontent-%COMP%]{font-size:38px;font-weight:700;border:none;background:none;min-width:200px;-webkit-text-stroke:2px #555;box-shadow:none}.chat-bubble[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:after{box-sizing:border-box;content:"";position:absolute;padding:0;line-height:1;vertical-align:baseline;left:50%;margin:0 0 0 -8px;bottom:-17px;border:8px solid transparent;border-top-color:inherit}.chat-bubble[_ngcontent-%COMP%]   p.emote[_ngcontent-%COMP%]:after{border:0px none transparent}.chat-bubble[_ngcontent-%COMP%]   p.is-whisper.emote[_ngcontent-%COMP%]:after{content:none}.chat-bubble-buyo[_ngcontent-%COMP%]{transform-origin:center calc(100% + 8px);transition:all .2s ease;animation:_ngcontent-%COMP%_chat-bubble-buyo 1.2s ease-in-out .1s infinite alternate;transform:scale3d(.9,.9,.9)}.chat-bubble-buyo.back[_ngcontent-%COMP%]{transform-origin:center calc(100% + 8px);transition:all .2s ease;animation:_ngcontent-%COMP%_chat-bubble-buyo-back 1.2s ease-in-out .1s infinite alternate;transform:rotateY(-180deg) scale3d(.9,.9,.9)}.chat-bubble-buyo.emote[_ngcontent-%COMP%]{animation-duration:.6s}@keyframes _ngcontent-%COMP%_chat-bubble-buyo{0%{transform:scale3d(.9,.9,.9)}to{transform:scaleZ(1)}}@keyframes _ngcontent-%COMP%_chat-bubble-buyo-back{0%{transform:rotateY(-180deg) scale3d(.9,.9,.9)}to{transform:rotateY(-180deg) scaleZ(1)}}.drop-shadow[_ngcontent-%COMP%]{pointer-events:none}.face-icon-box[_ngcontent-%COMP%]{display:block;position:relative;border:0px none;width:36px;height:36px;max-width:36px;max-height:36px;overflow:hidden;left:-20px;top:-18px;margin-right:-16px;margin-bottom:-22px;float:left;backface-visibility:hidden}p.rubied[_ngcontent-%COMP%]   .face-icon-box[_ngcontent-%COMP%]{top:-21px}.face-icon-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%;border-radius:.4em}.selected[_ngcontent-%COMP%]{filter:drop-shadow(0px 0px 8px yellow) drop-shadow(0px 0px 4px yellow);transition:all .2s ease-in}.is-hide-in-pedestal[_ngcontent-%COMP%]{filter:grayscale(70%)}.is-hide-in-pedestal.selected[_ngcontent-%COMP%]{filter:grayscale(70%) drop-shadow(0px 0px 8px yellow) drop-shadow(0px 0px 4px yellow)}.is-hide-in[_ngcontent-%COMP%]{filter:invert(85%) opacity(85%)}'],data:{animation:[Xn("switchImage",[an(":increment, :decrement",[rn("400ms ease",En([We({transform:"scale3d(0.8, 0.8, 0.8) rotateY(0deg)"}),We({transform:"scale3d(1.2, 1.2, 1.2) rotateY(180deg)"}),We({transform:"scale3d(1.0, 1.0, 1.0) rotateY(360deg)"})]))])]),Xn("switchImageShadow",[an(":increment, :decrement",[rn("400ms ease",En([We({transform:"scale3d(0.8, 0.8, 0.8)"}),We({transform:"scale3d(0, 1.2, 1.2)"}),We({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),Xn("switchImagePedestal",[an(":increment, :decrement",[rn("400ms ease",En([We({transform:"scale3d(0, 0, 0)"}),We({transform:"scale3d(1.2, 1.2, 1.2)"}),We({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),Xn("bounceInOut",[an("void => *",[rn("600ms ease",En([We({transform:"scale3d(0, 0, 0)",offset:0}),We({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),We({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),We({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),We({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),an("* => void",[rn(100,We({transform:"scale3d(0, 0, 0)"}))])]),Xn("fadeAndScaleInOut",[an("void => *, true => false",[rn("200ms ease-in-out",En([We({transform:"scale3d(0, 0, 0)",opacity:0}),We({transform:"scale3d(1.0, 1.0, 1.0)",opacity:.8})]))]),an("* => void, true => false",[rn("100ms ease-in-out",We({transform:"scale3d(0, 0, 0)",opacity:0}))])])]},changeDetection:0})}return t})();var jde=me(7376);const Gde=(t,n,e)=>({"is-grab":t,"is-scratching":n,"is-border":e}),Wde=t=>({fall:t}),$de=t=>({transform:t}),Yde=(t,n,e,i)=>({opacity:t,"background-color":n,"-webkit-mask":e,mask:i}),Zde=t=>({image:t}),GC=t=>({"is-inverse":t}),qde=t=>({"is-magnetic":t}),Xde=t=>({"is-mine":t}),Kde=t=>({"background-color":t}),Qde=t=>({transform:t});function Jde(t,n){if(1&t&&(p(0,"div",13),Ge(1,"div",14),g()),2&t){const e=v();je("width",e.width*e.gridSize-4,"px")("height",e.height*e.gridSize-4,"px"),h(),je("font-size",e.fontSize+9,"px")("color",e.color)("text-shadow",e.textShadowCss),m("ngClass",Ke(12,GC,e.isInverse))("innerHtml",e.rubiedText,$r)}}function ehe(t,n){if(1&t&&(Ge(0,"img",15),Ut(1,"safe")),2&t){const e=v();je("mix-blend-mode",1==e.blendType?null:"hard-light"),m("src",zt(1,3,e.imageFileUrl,"resourceUrl"),bn)}}function the(t,n){if(1&t&&(mc(),Ue(0),Ge(1,"rect",19)(2,"rect",20),ze()),2&t){const e=v().$implicit,i=v(2);h(),en("x",e.x*i.gridSize+5)("y",e.y*i.gridSize+5)("width",i.gridSize-10)("height",i.gridSize-10),h(),en("x",e.x*i.gridSize+5)("y",e.y*i.gridSize+5)("width",i.gridSize-10)("height",i.gridSize-10)}}function nhe(t,n){if(1&t&&(mc(),Ue(0),Ge(1,"line",21)(2,"line",21)(3,"line",22)(4,"line",22),ze()),2&t){const e=v().$implicit,i=v(2);h(),en("x1",e.x*i.gridSize+5)("y1",e.y*i.gridSize+5)("x2",e.x*i.gridSize+(i.gridSize-5))("y2",e.y*i.gridSize+(i.gridSize-5)),h(),en("x1",e.x*i.gridSize+(i.gridSize-5))("y1",e.y*i.gridSize+5)("x2",e.x*i.gridSize+5)("y2",e.y*i.gridSize+(i.gridSize-5)),h(),en("x1",e.x*i.gridSize+5)("y1",e.y*i.gridSize+5)("x2",e.x*i.gridSize+(i.gridSize-5))("y2",e.y*i.gridSize+(i.gridSize-5)),h(),en("x1",e.x*i.gridSize+(i.gridSize-5))("y1",e.y*i.gridSize+5)("x2",e.x*i.gridSize+5)("y2",e.y*i.gridSize+(i.gridSize-5))}}function ihe(t,n){if(1&t&&(mc(),Ue(0),Ge(1,"rect",23)(2,"line",21)(3,"line",21)(4,"rect",24)(5,"line",25)(6,"line",25),ze()),2&t){const e=v().$implicit,i=v(2);h(),en("x",e.x*i.gridSize+5)("y",e.y*i.gridSize+5)("width",i.gridSize-10)("height",i.gridSize-10),h(),en("x1",e.x*i.gridSize+15)("y1",e.y*i.gridSize+25)("x2",e.x*i.gridSize+35)("y2",e.y*i.gridSize+25),h(),en("x1",e.x*i.gridSize+25)("y1",e.y*i.gridSize+15)("x2",e.x*i.gridSize+25)("y2",e.y*i.gridSize+35),h(),en("x",e.x*i.gridSize+5)("y",e.y*i.gridSize+5)("width",i.gridSize-10)("height",i.gridSize-10),h(),en("x1",e.x*i.gridSize+15)("y1",e.y*i.gridSize+25)("x2",e.x*i.gridSize+35)("y2",e.y*i.gridSize+25),h(),en("x1",e.x*i.gridSize+25)("y1",e.y*i.gridSize+15)("x2",e.x*i.gridSize+25)("y2",e.y*i.gridSize+35)}}function rhe(t,n){if(1&t&&(mc(),p(0,"g")(1,"desc"),y(2),g(),Ue(3,17),q(4,the,3,8,"ng-container",18)(5,nhe,5,16,"ng-container",18)(6,ihe,7,24,"ng-container",18),ze(),g()),2&t){const e=n.$implicit,i=v(2);je("transform-origin",(e.x+.5)*i.gridSize+"px "+(e.y+.5)*i.gridSize+"px"),m("@rotateInOut",e.state),h(2),Xe(e.state),h(),m("ngSwitch",e.state),h(),m("ngSwitchCase","scrached"),h(),m("ngSwitchCase","scraching"),h(),m("ngSwitchCase","restore")}}function ohe(t,n){if(1&t&&(mc(),p(0,"svg"),q(1,rhe,7,8,"g",16),g()),2&t){const e=v();m("@fadeInOut",void 0),en("width",e.width*e.gridSize)("height",e.height*e.gridSize)("viewBox","0, 0, "+e.width*e.gridSize+", "+e.height*e.gridSize),h(),m("ngForOf",e.scratchingGridInfos)("ngForTrackBy",e.identify)}}function she(t,n){if(1&t&&Ge(0,"div",26),2&t){const e=v();m("ngClass",Ke(1,qde,e.isMagnetic))}}function ahe(t,n){if(1&t&&(p(0,"div",27)(1,"i",28),y(2),g()()),2&t){const e=v();h(),m("ngClass",Ke(2,GC,e.isInverse)),h(),Xe(e.isLock?"lock":"open_with")}}function lhe(t,n){if(1&t&&(p(0,"div",29)(1,"i",28),y(2),g()()),2&t){const e=v();m("ngClass",Ke(3,Xde,e.gameTableMask.isMine)),h(),m("ngClass",Ke(5,GC,e.isInverse)),h(),Xe(e.isPreviewMode?"visibility":"draw")}}function che(t,n){1&t&&(p(0,"i",36),y(1,"visibility"),g())}function uhe(t,n){if(1&t){const e=Le();p(0,"button",37),he("pointerdown",function(r){return V(e),H(v(2).prevent(r))})("mousedown",function(r){return V(e),H(v(2).prevent(r))})("click",function(r){return V(e),H(v(2).scratchDone(r))}),p(1,"i",38),y(2,"done"),g()()}2&t&&m("title",v(2).gameTableMask.scratchingGrids?"\u78ba\u5b9a":"\u7d42\u4e86")}function dhe(t,n){if(1&t){const e=Le();p(0,"button",39),he("pointerdown",function(r){return V(e),H(v(2).prevent(r))})("mousedown",function(r){return V(e),H(v(2).prevent(r))})("click",function(r){return V(e),H(v(2).scratchCancel(r))}),p(1,"i",38),y(2,"clear"),g()()}}function hhe(t,n){if(1&t&&(p(0,"div",30)(1,"div",31)(2,"span",32),q(3,che,2,0,"i",33),p(4,"b"),y(5),g(),y(6," \u304c\u64cd\u4f5c\u4e2d "),q(7,uhe,3,1,"button",34)(8,dhe,3,0,"button",35),g()()()),2&t){const e=v();h(),m("ngStyle",Ke(6,Kde,e.ownerColor+"E6")),h(),m("ngClass",Ke(8,GC,e.isInverse)),h(),m("ngIf",e.isPreview),h(2),Xe(e.ownerName),h(2),m("ngIf",e.gameTableMask.isMine),h(),m("ngIf",e.gameTableMask.isMine)}}function fhe(t,n){if(1&t&&(p(0,"div",40)(1,"div",41)(2,"span",42),y(3),g(),p(4,"span",43),y(5),g()()()),2&t){const e=v();je("height",e.math.abs(e.gameTableMaskAltitude*e.gridSize),"px"),m("ngStyle",Ke(5,Qde,"translateX("+e.width*e.gridSize/2+"px) translateY("+-e.height*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),h(3),Xe(e.math.abs(e.gameTableMaskAltitude)),h(2),Xe(e.gameTableMaskAltitude)}}let phe=(()=>{class t{get name(){return this.gameTableMask.name}get width(){return Hi.clampMin(this.gameTableMask.width)}get height(){return Hi.clampMin(this.gameTableMask.height)}get opacity(){return this.gameTableMask.opacity}get imageFile(){return this.gameTableMask.imageFile}get isLock(){return this.gameTableMask.isLock}set isLock(e){this.gameTableMask.isLock=e}get blendType(){return this.gameTableMask.blendType}set blendType(e){this.gameTableMask.blendType=e}get borderType(){return this.gameTableMask.borderType}set borderType(e){this.gameTableMask.borderType=e}get fontSize(){return this.gameTableMask.fontsize}set fontSize(e){this.gameTableMask.fontsize=e}get text(){return this.gameTableMask.text}set text(e){this.gameTableMask.text=e}get color(){return this.gameTableMask.color}set color(e){this.gameTableMask.color=e}get bgcolor(){return this.gameTableMask.bgcolor}set bgcolor(e){this.gameTableMask.bgcolor=e}get isPreview(){return this.gameTableMask.isPreview}set isPreview(e){this.gameTableMask.isPreview=e}get isPreviewMode(){return!!this.gameTableMask&&(this.isGMMode&&this.gameTableMask.isScratchPreviewOnGMMode||this.isPreview&&this.gameTableMask.isMine)}get textShadowCss(){const e=ke.textShadowColor(this.color);return`${e} 0px 0px 2px, \n      ${e} 0px 0px 2px, \n      ${e} 0px 0px 2px, \n      ${e} 0px 0px 2px, \n      ${e} 0px 0px 2px, \n      ${e} 0px 0px 2px,\n      ${e} 0px 0px 2px,\n      ${e} 0px 0px 2px`}get scratchedGrids(){return this.gameTableMask.scratchedGrids}set scratchedGrids(e){this.gameTableMask.scratchedGrids=e}get scratchingGrids(){return this.gameTableMask.scratchingGrids}set scratchingGrids(e){this.gameTableMask.scratchingGrids=e}get isNonScratched(){return!this.gameTableMask.scratchedGrids}get isNonScratching(){return!(this.gameTableMask.scratchingGrids||this._currentScratchingSet)}get masksCss(){if(!this.isPreviewMode&&this.isNonScratched)return"";const e=[],i=new Set(this.scratchedGrids.split(/,/g)),r=this._currentScratchingSet?this._currentScratchingSet:new Set(this.scratchingGrids.split(/,/g));for(let o=0;o<this.width;o++)for(let s=0;s<this.height;s++){const a=`${o}:${s}`;if(this.isPreviewMode){if(i.has(a)&&!r.has(a)||r.has(a)&&!i.has(a))continue}else if(i.has(a))continue;e.push(`radial-gradient(#000, #000) ${o*this.gridSize-1}px ${s*this.gridSize-1}px / ${this.gridSize+2}px ${this.gridSize+2}px no-repeat`)}return e.length?e.join(","):"radial-gradient(#000, #000) 0px 0px / 0px 0px no-repeat"}get scratchingGridInfos(){const e=[];if(!this.gameTableMask||this.isNonScratching&&this.isNonScratched)return e;const i=this._currentScratchingSet?this._currentScratchingSet:new Set(this.scratchingGrids.split(/,/g)),r=new Set(this.scratchedGrids.split(/,/g));for(let o=0;o<Math.ceil(this.width);o++)for(let s=0;s<Math.ceil(this.height);s++){const a=`${o}:${s}`;(i.has(a)||r.has(a))&&e.push({x:o,y:s,state:i.has(a)?r.has(a)?"restore":"scraching":"scrached"})}return e}get operateOpacity(){const e=this.opacity*(this.isGMMode&&this.gameTableMask.isTransparentOnGMMode||this.isPreview&&this.gameTableMask.isMine?.6:1);return e<.4&&this.isScratching?.4:e}get altitude(){return this.gameTableMask.altitude}set altitude(e){this.gameTableMask.altitude=e}get isAltitudeIndicate(){return this.gameTableMask.isAltitudeIndicate}set isAltitudeIndicate(e){this.gameTableMask.isAltitudeIndicate=e}get gameTableMaskAltitude(){return+this.altitude.toFixed(1)}get rubiedText(){return ke.rubyToHtml(ke.escapeHtml(this.text))}get isInverse(){return 90<Math.abs(this.viewRotateZ)%360&&Math.abs(this.viewRotateZ)%360<270}get isGMMode(){return this.gameTableMask.isGMMode}get isScratching(){return!!this.gameTableMask.owner}get hasOwner(){return this.gameTableMask.hasOwner}get ownerIsOnline(){return this.gameTableMask.ownerIsOnline}get ownerName(){return this.gameTableMask.ownerName}get ownerColor(){return this.gameTableMask.ownerColor}get selectionState(){return this.selectionService.state(this.gameTableMask)}get isSelected(){return this.selectionState!==$n.NONE}get isMagnetic(){return this.selectionState===$n.MAGNETIC}get imageFileUrl(){let e="";return this.imageFile&&(this.imageFile.identifier!=this._currentimageFile?.identifier||this.imageFile.state!=this._currentImageFileState)&&(this._currentimageFile=this.imageFile,this._currentimageFile.state===Ri.THUMBNAIL||this._currentimageFile.state===Ri.COMPLETE?(this._currentImageFileState=this._currentimageFile.state,this._currentImageFileUrl&&(e=this._currentImageFileUrl),this._currentImageFileUrl=URL.createObjectURL(this._currentimageFile.blob)):this._currentImageFileUrl=this._currentimageFile.url),e&&queueMicrotask(()=>URL.revokeObjectURL(e)),this._currentImageFileUrl}constructor(e,i,r,o,s,a,c,u,f,b,C){this.ngZone=e,this.tabletopActionService=i,this.contextMenuService=r,this.elementRef=o,this.panelService=s,this.changeDetector=a,this.selectionService=c,this.pointerDeviceService=u,this.modalService=f,this.coordinateService=b,this.chatMessageService=C,this.gameTableMask=null,this.is3D=!1,this.gridSize=50,this.math=Math,this.viewRotateZ=10,this.movableOption={},this.input=null,this._currentImageFileUrl="",this._currentImageFileState=0,this._scratchingGridX=-1,this._scratchingGridY=-1}ngOnChanges(){ne.unregister(this),ne.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.gameTableMask?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.gameTableMask?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on(`UPDATE_SELECTION/identifier/${this.gameTableMask?.identifier}`,e=>{this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.gameTableMask,transformCssOffset:"translateZ(0.10px)",colideLayers:["terrain"]},this.panelId=oa.generateUuid()}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new Bc(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this)}ngOnDestroy(){this.input.destroy(),ne.unregister(this),clearTimeout(this._scratchingTimerId),this._currentImageFileUrl&&URL.revokeObjectURL(this._currentImageFileUrl)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.isScratching&&this.gameTableMask.isMine?!window.PointerEvent&&e.button<2&&e.buttons<2&&this.scratching(!0):this.input.cancel(),(this.isLock&&!this.isScratching||this.isScratching&&!this.gameTableMask.isMine)&&ne.trigger("DRAG_LOCKED_OBJECT",{srcEvent:e})}onInputStartPointer(e){!this.isScratching||!this.gameTableMask.isMine||e.button<2&&e.buttons<2&&this.scratching(!0,{offsetX:e.offsetX,offsetY:e.offsetY})}onInputMove(e){!window.PointerEvent&&this.isScratching&&this.gameTableMask.isMine&&this.input.isDragging&&this.scratching(!1)}onInputMovePointer(e){this.isScratching&&this.gameTableMask.isMine&&this.input.isDragging&&e.buttons<2&&this.scratching(!1,{offsetX:e.offsetX,offsetY:e.offsetY})}scratching(e,i=null){if(!this.gameTableMask.isMine)return;const r=Ho.instance;let o,s;if(r.gridShow||(r.viewTable.gridClipRect={top:0,right:0,bottom:0,left:0}),i)o=i.offsetX,s=i.offsetY;else{const f=this.coordinateService.calcTabletopLocalCoordinate(this.pointerDeviceService.pointers[0],this.elementRef.nativeElement);o=f.x-this.gameTableMask.location.x,s=f.y-this.gameTableMask.location.y}if(o<0||this.gameTableMask.width*this.gridSize<=o||s<0||this.gameTableMask.height*this.gridSize<=s)return;const a=Math.floor(o/this.gridSize),c=Math.floor(s/this.gridSize);if(!e&&this._scratchingGridX===a&&this._scratchingGridY===c)return;const u=`${a}:${c}`;this._scratchingGridX=a,this._scratchingGridY=c,this._currentScratchingSet||(this._currentScratchingSet=new Set(this.scratchingGrids.split(/,/g))),this._currentScratchingSet.has(u)?this._currentScratchingSet.delete(u):this._currentScratchingSet.add(u),clearTimeout(this._scratchingTimerId),this._scratchingTimerId=setTimeout(()=>{this.scratchingGrids=Array.from(this._currentScratchingSet).filter(f=>f&&/^\d+:\d+$/.test(f)).sort().join(","),this._currentScratchingSet=null},250)}scratched(){const e=this.scratchedGrids.split(/,/g);this._currentScratchingSet&&(clearTimeout(this._scratchingTimerId),this.scratchingGrids=Array.from(this._currentScratchingSet).filter(r=>r&&/^\d+:\d+$/.test(r)).sort().join(","),this._currentScratchingSet=null);const i=this.scratchingGrids.split(/,/g);this.scratchedGrids=(0,jde.xor)(e,i).filter(r=>r&&/^\d+:\d+$/.test(r)).sort().join(",")}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.name)}onMove(){this.contextMenuService.close(),tt.play(Te.cardPick)}onMoved(){tt.play(Te.cardPut)}scratchDone(e=null){return e&&(e.preventDefault(),e.stopPropagation()),this.gameTableMask.isMine&&(this.ngZone.run(()=>{this.scratched(),this.gameTableMask.owner="",this.scratchingGrids="",this.isPreview=!1}),this._scratchingGridX=-1,this._scratchingGridY=-1,tt.play(Te.cardPut),this.chatMessageService.sendOperationLog(`${""==this.gameTableMask.name?"(\u7121\u540d\u306e\u30de\u30c3\u30d7\u30de\u30b9\u30af)":this.gameTableMask.name} \u306e\u30b9\u30af\u30e9\u30c3\u30c1\u3092\u7d42\u4e86\u3057\u305f`)),!1}scratchCancel(e=null){return e&&(e.preventDefault(),e.stopPropagation()),!this.gameTableMask.isMine&&this.ownerIsOnline||(this.ngZone.run(()=>{this.gameTableMask.owner="",this.scratchingGrids="",this.isPreview=!1}),this._scratchingGridX=-1,this._scratchingGridY=-1,tt.play(Te.unlock),this.chatMessageService.sendOperationLog(`${""==this.gameTableMask.name?"(\u7121\u540d\u306e\u30de\u30c3\u30d7\u30de\u30b9\u30af)":this.gameTableMask.name} \u306e\u30b9\u30af\u30e9\u30c3\u30c1\u3092\u7d42\u4e86\u3057\u305f`)),!1}prevent(e){e.preventDefault(),e.stopPropagation()}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i=this.coordinateService.calcTabletopLocalCoordinate();if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),this.isSelected){let r=()=>this.selectionService.objects.filter(o=>o.aliasName===this.gameTableMask.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u30de\u30c3\u30d7\u30de\u30b9\u30af",action:null,subActions:[{name:"\u3059\u3079\u3066\u56fa\u5b9a\u3059\u308b",action:()=>{r().forEach(o=>o.isLock=!0),tt.play(Te.lock)}},{name:"\u3059\u3079\u3066\u306e\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{r().forEach(o=>{let s=o.clone();s.location.x+=this.gridSize,s.location.y+=this.gridSize,s.isLock=!1,o.parent&&o.parent.appendChild(s)}),tt.play(Te.cardPut)}}]})}return e.push(Zt),e}makeContextMenu(){let e=this.coordinateService.calcTabletopLocalCoordinate();return[this.isGMMode?this.gameTableMask.isTransparentOnGMMode?{name:"\u2611 GM\u6642\u900f\u904e\u8868\u793a",action:()=>{this.gameTableMask.isTransparentOnGMMode=!1},checkBox:"check"}:{name:"\u2610 GM\u6642\u900f\u904e\u8868\u793a",action:()=>{this.gameTableMask.isTransparentOnGMMode=!0},checkBox:"check"}:null,this.isGMMode?this.gameTableMask.isScratchPreviewOnGMMode?{name:"\u2611 GM\u6642\u30b9\u30af\u30e9\u30c3\u30c1\u30d7\u30ec\u30d3\u30e5\u30fc",action:()=>{this.gameTableMask.isScratchPreviewOnGMMode=!1},checkBox:"check"}:{name:"\u2610 GM\u6642\u30b9\u30af\u30e9\u30c3\u30c1\u30d7\u30ec\u30d3\u30e5\u30fc",action:()=>{this.gameTableMask.isScratchPreviewOnGMMode=!0},checkBox:"check"}:null,this.isGMMode?Zt:null,this.isLock?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLock=!1,tt.play(Te.unlock)},disabled:this.isScratching,checkBox:"check"}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLock=!0,tt.play(Te.lock)},disabled:this.isScratching,checkBox:"check"},this.isLock?null:{name:"\u91cd\u306a\u308a\u9806",action:null,subActions:[{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u306e\u4e00\u756a\u4e0a\u306b",action:()=>{if(!this.isLock){const r=this.gameTableMask.parent;r&&r.appendChild(this.gameTableMask)}},disabled:this.isLock},{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u306e\u4e00\u756a\u4e0b\u306b",action:()=>{if(!this.isLock){const r=this.gameTableMask.parent;r&&r.prependChild(this.gameTableMask)}},disabled:this.isLock}],disabled:this.isLock},Zt,this.gameTableMask.isMine?{name:"\u30b9\u30af\u30e9\u30c3\u30c1"+(this.isNonScratching?"\u7d42\u4e86":"\u78ba\u5b9a"),action:()=>{this.scratchDone()}}:{name:"\u30b9\u30af\u30e9\u30c3\u30c1\u958b\u59cb",action:()=>{let r=!1;if(""!=this.gameTableMask.owner){this.isPreview=!1,clearTimeout(this._scratchingTimerId),this._currentScratchingSet=null;const o=Fe.findByUserId(this.gameTableMask.owner);o&&(this.chatMessageService.sendOperationLog(`${""==this.gameTableMask.name?"(\u7121\u540d\u306e\u30de\u30c3\u30d7\u30de\u30b9\u30af)":this.gameTableMask.name} \u306e\u30b9\u30af\u30e9\u30c3\u30c1\u3092 ${""==o.name?"(\u7121\u540d\u306e\u30d7\u30ec\u30a4\u30e4\u30fc)":o.name} \u304b\u3089\u5f15\u304d\u7d99\u3044\u3060`),r=!0)}this.gameTableMask.owner=jt.peer.userId,this._scratchingGridX=-1,this._scratchingGridY=-1,tt.play(Te.lock),r||this.chatMessageService.sendOperationLog(`${""==this.gameTableMask.name?"(\u7121\u540d\u306e\u30de\u30c3\u30d7\u30de\u30b9\u30af)":this.gameTableMask.name} \u306e\u30b9\u30af\u30e9\u30c3\u30c1\u3092\u958b\u59cb\u3057\u305f`)}},{name:"\u30b9\u30af\u30e9\u30c3\u30c1\u30ad\u30e3\u30f3\u30bb\u30eb",action:()=>{this.scratchCancel()},disabled:!this.isScratching||!this.gameTableMask.isMine&&this.ownerIsOnline},{name:"\u30b9\u30af\u30e9\u30c3\u30c1\u64cd\u4f5c",subActions:[{name:"\u9069\u7528\u3057\u3066\u7d9a\u3051\u308b",action:()=>{this.gameTableMask.isMine&&(this.ngZone.run(()=>{this.scratched(),this.scratchingGrids=""}),this._scratchingGridX=-1,this._scratchingGridY=-1,tt.play(Te.cardDraw))},disabled:!this.gameTableMask.isMine||this.isNonScratching},{name:"\u7834\u68c4\u3057\u3066\u7d9a\u3051\u308b",action:()=>{this.gameTableMask.isMine&&(this.ngZone.run(()=>{this.scratchingGrids="",clearTimeout(this._scratchingTimerId),this._currentScratchingSet=null}),this._scratchingGridX=-1,this._scratchingGridY=-1,tt.play(Te.sweep))},disabled:!this.gameTableMask.isMine||this.isNonScratching},Zt,this.isPreview?{name:"\u30d7\u30ec\u30d3\u30e5\u30fc\u30e2\u30fc\u30c9\u89e3\u9664",action:()=>{this.gameTableMask.isMine&&(this.ngZone.run(()=>{this.isPreview=!1}),tt.play(Te.lock))},selfOnly:!0,disabled:!this.gameTableMask.isMine}:{name:"\u30d7\u30ec\u30d3\u30e5\u30fc\u30e2\u30fc\u30c9\u958b\u59cb",action:()=>{this.gameTableMask.isMine&&this.modalService.open(Fr,{title:"\u30b9\u30af\u30e9\u30c3\u30c1\u30d7\u30ec\u30d3\u30e5\u30fc\u30e2\u30fc\u30c9",text:"\u30b9\u30af\u30e9\u30c3\u30c1\u4e2d\u306b\u9069\u7528\u5f8c\u306e\u72b6\u614b\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",helpHtml:"\u81ea\u5206\u306e\u307f\u3001<b>\u3053\u306e\u30b9\u30af\u30e9\u30c3\u30c1\u3092\u78ba\u5b9a/\u30ad\u30e3\u30f3\u30bb\u30eb\u3059\u308b\u307e\u3067</b>\u30de\u30c3\u30d7\u30de\u30b9\u30af\u306f\u900f\u904e\u8868\u793a\u306b\u306a\u308a\u3001\u307e\u305f\u30b9\u30af\u30e9\u30c3\u30c1\u9069\u7528\u5f8c\u306e\u72b6\u614b\u3092\u8868\u793a\u3057\u307e\u3059\u3002",type:ur.OK_CANCEL,materialIcon:"visibility",action:()=>{this.ngZone.run(()=>{this.isPreview=!0}),tt.play(Te.unlock),this.chatMessageService.sendOperationLog(`${""==this.gameTableMask.name?"(\u7121\u540d\u306e\u30de\u30c3\u30d7\u30de\u30b9\u30af)":this.gameTableMask.name} \u306e\u30b9\u30af\u30e9\u30c3\u30c1\u3092\u30d7\u30ec\u30d3\u30e5\u30fc\u30e2\u30fc\u30c9\u306b\u3057\u305f`)}})},selfOnly:!0,disabled:!this.gameTableMask.isMine},{name:"\u30b9\u30af\u30e9\u30c3\u30c1\u521d\u671f\u5316",action:()=>{this.gameTableMask.isMine&&this.modalService.open(Fr,{title:"\u30b9\u30af\u30e9\u30c3\u30c1\u521d\u671f\u5316",text:"\u30b9\u30af\u30e9\u30c3\u30c1\u3092\u521d\u671f\u5316\u3057\u307e\u3059\u304b\uff1f",help:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u306f\u30b9\u30af\u30e9\u30c3\u30c1\u3055\u308c\u3066\u3044\u306a\u3044\u72b6\u614b\u306b\u306a\u308a\u3001\u64cd\u4f5c\u3092\u7d42\u4e86\u3057\u307e\u3059\u3002",type:ur.OK_CANCEL,materialIcon:"draw",action:()=>{this.ngZone.run(()=>{this.gameTableMask.owner="",this.scratchedGrids="",this.scratchingGrids="",this._currentScratchingSet=null,clearTimeout(this._scratchingTimerId)}),this._scratchingGridX=-1,this._scratchingGridY=-1,tt.play(Te.sweep),this.chatMessageService.sendOperationLog(`${""==this.gameTableMask.name?"(\u7121\u540d\u306e\u30de\u30c3\u30d7\u30de\u30b9\u30af)":this.gameTableMask.name} \u306e\u30b9\u30af\u30e9\u30c3\u30c1\u3092\u521d\u671f\u5316\u3057\u305f`)}})},disabled:!this.gameTableMask.isMine||this.isNonScratched}],disabled:!this.gameTableMask.isMine},Zt,{name:"\u30dc\u30fc\u30c0\u30fc\u30e9\u30a4\u30f3\u306e\u8868\u793a",subActions:[{name:(0==this.borderType?"\u25c9":"\u25cb")+" \u64cd\u4f5c\u6642\u306e\u307f\u8868\u793a",action:()=>{this.borderType=0},checkBox:"radio"},{name:(1==this.borderType?"\u25c9":"\u25cb")+" \u64cd\u4f5c\u6642\u3001\u975e\u56fa\u5b9a",action:()=>{this.borderType=1},checkBox:"radio"},{name:(2==this.borderType?"\u25c9":"\u25cb")+" \u5e38\u306b\u8868\u793a",action:()=>{this.borderType=2},checkBox:"radio"}],disabled:this.isScratching},{name:"\u753b\u50cf\u3068\u8272\u306e\u8868\u793a",subActions:[{name:(0==this.blendType?"\u25c9":"\u25cb")+" \u753b\u50cf\u306e\u307f",action:()=>{this.blendType=0,tt.play(Te.cardDraw)},checkBox:"radio"},{name:(1==this.blendType?"\u25c9":"\u25cb")+" \u80cc\u666f\u8272\u3068\u91cd\u306d\u308b",action:()=>{this.blendType=1,tt.play(Te.cardDraw)},checkBox:"radio"},{name:(2==this.blendType?"\u25c9":"\u25cb")+" \u80cc\u666f\u8272\u3068\u6df7\u305c\u308b",action:()=>{this.blendType=2,tt.play(Te.cardDraw)},checkBox:"radio"},Zt,{name:"\u8272\u306e\u521d\u671f\u5316",action:()=>{this.color="#555555",this.bgcolor="#0a0a0a",tt.play(Te.cardDraw)}}],disabled:this.isScratching},Zt,this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1},checkBox:"check"}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0},checkBox:"check"},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,tt.play(Te.sweep))},disabled:this.isScratching,altitudeHande:this.gameTableMask,altitudeDisabled:this.isScratching},Zt,{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u7de8\u96c6...",action:()=>{this.showDetail(this.gameTableMask)}},this.gameTableMask.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.gameTableMask.getUrls().map(r=>{const o=r.value.toString();return{name:r.name?r.name:o,action:()=>{ke.sameOrigin(o)?window.open(o.trim(),"_blank","noopener"):this.modalService.open(sa,{url:o,title:this.gameTableMask.name,subTitle:r.name})},disabled:!ke.validUrl(o),error:ke.validUrl(o)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:ke.validUrl(o)&&!ke.sameOrigin(o)}})},this.gameTableMask.getUrls().length<=0?null:Zt,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.gameTableMask.clone();console.log("\u30b3\u30d4\u30fc",r),r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.isLock=!1,r.isPreview=!1,this.gameTableMask.parent&&this.gameTableMask.parent.appendChild(r),tt.play(Te.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.chatMessageService.sendOperationLog(`${""==this.gameTableMask.name?"(\u7121\u540d\u306e\u30de\u30c3\u30d7\u30de\u30b9\u30af)":this.gameTableMask.name} \u3092\u524a\u9664\u3057\u305f`),this.gameTableMask.destroy(),tt.play(Te.sweep)}},Zt,{name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(e)}]}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u30de\u30c3\u30d7\u30de\u30b9\u30af\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(kl,{title:r,left:i.x-200,top:i.y-150,width:400,height:530}).tabletopObject=e}identify(e,i){return`${this.panelId}:${i.x}:${i.y}`}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Pn),Y(jC),Y(Bo),Y(fr),Y(yi),Y(Zr),Y(Ml),Y(lr),Y(Ei),Y(rh),Y(vo))};static#t=this.\u0275cmp=In({type:t,selectors:[["game-table-mask"]],hostBindings:function(i,r){1&i&&he("dragstart",function(s){return r.onDragstart(s)})("pointerdown",function(s){return r.onInputStartPointer(s)})("pointermove",function(s){return r.onInputMovePointer(s)})("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{gameTableMask:"gameTableMask",is3D:"is3D"},features:[hr],decls:13,vars:34,consts:[["appMovable","",1,"component","is-3d",2,"pointer-events","none",3,"movable.ondragstart","movable.ondragend","ngClass","movable.option","movable.disable"],[1,"is-fit-full","is-3d",2,"pointer-events","none",3,"ngClass","ngStyle"],["class","is-3d text","style","left: 2px; top: 2px; backface-visibility: hidden",3,"width","height",4,"ngIf"],[1,"is-fit-full","is-3d"],[1,"is-fit-full","is-3d","chrome-smooth-image-trick",2,"pointer-events","auto","position","absolute","backface-visibility","hidden",3,"ngStyle","ngClass"],["class","is-fit-full is-3d chrome-smooth-image-trick","style","pointer-events: none; position: absolute;",3,"mix-blend-mode","src",4,"ngIf"],[1,"is-fit-full","is-3d","scratching-area","border",2,"pointer-events","none","backface-visibility","hidden"],[4,"ngIf"],["class","selected-highlight border",3,"ngClass",4,"ngIf"],["class","lock-icon is-center is-3d","style","pointer-events: none; z-index: 10; backface-visibility: hidden",4,"ngIf"],["class","draw-icon is-center is-3d","style","pointer-events: none; z-index: 10; backface-visibility: hidden",3,"ngClass",4,"ngIf"],["class","scratching is-center is-3d","style","pointer-events: none; z-index: 10; top: -10px; left: 1px; backface-visibility: hidden",4,"ngIf"],["class","is-3d","style","display: flex; align-items: center; border-left: 2px dashed blanchedalmond; transform-origin: top left; pointer-events: none",3,"height","ngStyle",4,"ngIf"],[1,"is-3d","text",2,"left","2px","top","2px","backface-visibility","hidden"],[1,"is-3d",2,"z-index","5","pointer-events","none",3,"ngClass","innerHtml"],[1,"is-fit-full","is-3d","chrome-smooth-image-trick",2,"pointer-events","none","position","absolute",3,"src"],[3,"transform-origin",4,"ngFor","ngForOf","ngForTrackBy"],[3,"ngSwitch"],[4,"ngSwitchCase"],["fill","none","stroke","#22222288","stroke-width","5","stroke-linejoin","round"],["fill","none","stroke","#ff3e3e","stroke-width","4","stroke-linejoin","round"],["stroke","#22222288","stroke-width","6","stroke-linecap","round"],["stroke","#ff3e3e","stroke-width","4","stroke-linecap","round"],["fill","none","stroke","#22222288","stroke-width","6","stroke-linejoin","round"],["fill","none","stroke","#8098ff","stroke-width","4","stroke-linejoin","round"],["stroke","#8098ff","stroke-width","4","stroke-linecap","round"],[1,"selected-highlight","border",3,"ngClass"],[1,"lock-icon","is-center","is-3d",2,"pointer-events","none","z-index","10","backface-visibility","hidden"],[1,"material-icons",2,"pointer-events","none","backface-visibility","hidden","display","inline-block",3,"ngClass"],[1,"draw-icon","is-center","is-3d",2,"pointer-events","none","z-index","10","backface-visibility","hidden",3,"ngClass"],[1,"scratching","is-center","is-3d",2,"pointer-events","none","z-index","10","top","-10px","left","1px","backface-visibility","hidden"],[1,"name-tag","has-length-limit","is-nowrap","is-black-background",2,"color","whitesmoke",3,"ngStyle"],[2,"display","inline-block",3,"ngClass"],["style","margin-right: 2px","class","material-icons",4,"ngIf"],["class","edit-button",3,"title","pointerdown","mousedown","click",4,"ngIf"],["class","edit-button","title","\u30ad\u30e3\u30f3\u30bb\u30eb",3,"pointerdown","mousedown","click",4,"ngIf"],[1,"material-icons",2,"margin-right","2px"],[1,"edit-button",3,"pointerdown","mousedown","click","title"],[1,"material-icons","small-font"],["title","\u30ad\u30e3\u30f3\u30bb\u30eb",1,"edit-button",3,"pointerdown","mousedown","click"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","transform-origin","top left","pointer-events","none",3,"ngStyle"],[1,"is-3d",2,"pointer-events","none"],[1,"altitude-indicator","is-3d",2,"position","absolute","pointer-events","none"],[1,"altitude-indicator","is-3d",2,"position","absolute","pointer-events","none","transform","rotateY(-180deg)"]],template:function(i,r){1&i&&(p(0,"div",0),he("movable.ondragstart",function(){return r.onMove()})("movable.ondragend",function(){return r.onMoved()}),p(1,"div",1),q(2,Jde,2,14,"div",2),p(3,"div",3)(4,"div",4),q(5,ehe,2,6,"img",5),g(),p(6,"div",6),q(7,ohe,2,6,"svg",7),g(),q(8,she,1,3,"div",8),g(),q(9,ahe,3,4,"div",9)(10,lhe,3,7,"div",10)(11,hhe,9,10,"div",11),g(),q(12,fhe,6,7,"div",12),g()),2&i&&(je("width",r.width*r.gridSize,"px")("height",r.height*r.gridSize,"px"),m("ngClass",Qs(19,Gde,!r.isLock&&!r.isScratching,r.isScratching&&r.gameTableMask.isMine,r.isScratching||!r.isLock&&r.borderType>=1||r.borderType>=2))("movable.option",r.movableOption)("movable.disable",r.isLock||r.isScratching),h(),m("ngClass",Ke(23,Wde,0==r.altitude))("ngStyle",Ke(25,$de,"translateZ("+r.altitude*r.gridSize+"px)")),h(),m("ngIf",!r.isScratching),h(2),m("ngStyle",Ja(27,Yde,r.operateOpacity,r.imageFileUrl.length<1||r.blendType>0?r.bgcolor:null,r.masksCss,r.masksCss))("ngClass",Ke(32,Zde,r.imageFileUrl.length>=1)),h(),m("ngIf",r.imageFileUrl.length>=1),h(2),m("ngIf",r.isScratching),h(),m("ngIf",r.isSelected),h(),m("ngIf",!r.isScratching),h(),m("ngIf",r.isScratching),h(),m("ngIf",r.isScratching&&r.ownerIsOnline),h(),m("ngIf",r.isAltitudeIndicate&&r.math.abs(r.gameTableMaskAltitude)>=.5))},dependencies:[Ni,nr,ri,Lo,Hd,Dg,is,cr],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-scratching[_ngcontent-%COMP%]{cursor:pointer}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.image[_ngcontent-%COMP%]{display:block;box-sizing:border-box}.lock-icon[_ngcontent-%COMP%], .draw-icon[_ngcontent-%COMP%]{background-color:#ccc;border-radius:100%;color:#444;width:25px;height:25px}.lock-icon[_ngcontent-%COMP%]{visibility:hidden}.component[_ngcontent-%COMP%]:hover   .lock-icon[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .lock-icon[_ngcontent-%COMP%], .scratching[_ngcontent-%COMP%], .draw-icon[_ngcontent-%COMP%]{visibility:visible}.component[_ngcontent-%COMP%]:hover   .scratching.is-mine[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .scratching.is-mine[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:hover   .draw-icon.is-mine[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .draw-icon.is-mine[_ngcontent-%COMP%]{visibility:hidden}.is-center[_ngcontent-%COMP%]{position:absolute;inset:0;margin:auto}.image.border[_ngcontent-%COMP%]{border-width:0px}.component[_ngcontent-%COMP%]:hover   .border[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .border[_ngcontent-%COMP%], .is-border[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{outline:2px solid #CCC!important;outline-offset:-2px}.is-fit-full[_ngcontent-%COMP%]{height:100%;width:100%}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0px 0px 3px;backface-visibility:hidden}.fall[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.text[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.is-inverse[_ngcontent-%COMP%]{transform:rotate(180deg)}.scratching-area[_ngcontent-%COMP%]{overflow:hidden}.name-tag[_ngcontent-%COMP%]{font-size:15px;padding:3px 9px;border-radius:24px;pointer-events:none;display:inline-block}.component[_ngcontent-%COMP%]:hover   .is-mine[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .is-mine[_ngcontent-%COMP%]{visibility:hidden}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.name-tag[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:16px;display:inline-block;position:relative;vertical-align:text-bottom}.small-font[_ngcontent-%COMP%]{font-size:14px;vertical-align:bottom}.edit-button[_ngcontent-%COMP%]{padding:0 4px;vertical-align:10%;margin:0 1px 0 0;pointer-events:auto}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;background-color:#80d4ff99;inset:0}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}"],data:{animation:[Xn("fadeInOut",[an("void => *",[rn("132ms ease-out",En([We({opacity:0,offset:0}),We({opacity:1,offset:1})]))]),an("* => void",[rn("132ms ease-in",En([We({opacity:1,offset:0}),We({opacity:0,offset:1})]))])]),Xn("rotateInOut",[an("scrached<=>restore",[rn("132ms ease-in-out",En([We({transform:"rotateY(0deg)",offset:0}),We({transform:"rotateY(-90deg)",offset:1})]))])])]},changeDetection:0})}return t})();const ghe=t=>({"is-grab":t}),mhe=(t,n)=>({"upright-transform":t,fall:n}),K5=t=>({transform:t}),Q5=t=>({"blinking-animation":t}),dm=t=>({"is-magnetic":t}),_he=(t,n,e)=>({"backface-visibility":t,transform:n,filter:e}),WC=(t,n,e,i)=>({"blinking-animation":t,"no-shadow":n,"is-slope":e,"is-inverse-slope":i});function bhe(t,n){if(1&t&&(Ge(0,"div",7),Ut(1,"safe")),2&t){const e=v(2);je("background-image",zt(1,3,"url("+e.floorImageUrl+")","style")),m("ngClass",Ke(6,Q5,!e.isLocked))}}function vhe(t,n){if(1&t&&Ge(0,"div",8),2&t){const e=v(2);m("ngClass",Ke(1,dm,e.isMagnetic))}}function yhe(t,n){if(1&t&&(Ue(0),q(1,bhe,2,8,"div",5)(2,vhe,1,3,"div",6),ze()),2&t){const e=v();h(),m("ngIf",e.isDropShadow&&(0!=e.terreinAltitude||e.isSlope&&!e.hasWall)),h(),m("ngIf",e.isSelected&&e.isDropShadow&&(0!=e.terreinAltitude||e.isSlope&&!e.hasWall))}}function Che(t,n){if(1&t&&Ge(0,"div",8),2&t){const e=v(2);m("ngClass",Ke(1,dm,e.isMagnetic))}}function xhe(t,n){if(1&t&&(Ue(0),p(1,"div",9),Ut(2,"safe"),q(3,Che,1,3,"div",6),g(),ze()),2&t){const e=v();h(),je("background-image",zt(2,5,"url("+e.floorImageUrl+")","style")),m("ngClass",Ke(8,Q5,!e.isLocked))("ngStyle",Qs(10,_he,e.isSlope?"visible":"hidden","translateZ("+e.height/(e.isSlope?2:1)*e.gridSize+"px)"+e.floorModCss,"brightness("+e.floorBrightness+")")),h(2),m("ngIf",e.isSelected)}}function whe(t,n){if(1&t&&Ge(0,"div",8),2&t){const e=v(4);m("ngClass",Ke(1,dm,e.isMagnetic))}}function Ehe(t,n){if(1&t&&(p(0,"div",11),Ut(1,"safe"),q(2,whe,1,3,"div",6),g()),2&t){const e=v(3);je("background-image",zt(1,8,"url("+e.wallImageUrl+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),m("ngClass",Ja(11,WC,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.LEFT,e.slopeDirection==e.slopeDirectionState.RIGHT)),h(2),m("ngIf",e.isSelected)}}function Ihe(t,n){if(1&t&&(Ue(0),q(1,Ehe,3,16,"div",10),ze()),2&t){const e=v(2);h(),m("ngIf",e.isVisibleWallTopBottom)}}function The(t,n){if(1&t&&Ge(0,"div",8),2&t){const e=v(4);m("ngClass",Ke(1,dm,e.isMagnetic))}}function She(t,n){if(1&t&&(p(0,"div",13),Ut(1,"safe"),q(2,The,1,3,"div",6),g()),2&t){const e=v(3);je("background-image",zt(1,8,"url("+e.wallImageUrl+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),m("ngClass",Ja(11,WC,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.LEFT,e.slopeDirection==e.slopeDirectionState.RIGHT)),h(2),m("ngIf",e.isSelected)}}function Mhe(t,n){if(1&t&&(Ue(0),q(1,She,3,16,"div",12),ze()),2&t){const e=v(2);h(),m("ngIf",e.isVisibleWallTopBottom)}}function Dhe(t,n){if(1&t&&Ge(0,"div",8),2&t){const e=v(4);m("ngClass",Ke(1,dm,e.isMagnetic))}}function khe(t,n){if(1&t&&(p(0,"div",15),Ut(1,"safe"),q(2,Dhe,1,3,"div",6),g()),2&t){const e=v(3);je("background-image",zt(1,8,"url("+e.wallImageUrl+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),m("ngClass",Ja(11,WC,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.BOTTOM,e.slopeDirection==e.slopeDirectionState.TOP)),h(2),m("ngIf",e.isSelected)}}function Ohe(t,n){if(1&t&&(Ue(0),q(1,khe,3,16,"div",14),ze()),2&t){const e=v(2);h(),m("ngIf",e.isVisibleWallLeftRight)}}function Ahe(t,n){if(1&t&&Ge(0,"div",8),2&t){const e=v(4);m("ngClass",Ke(1,dm,e.isMagnetic))}}function Phe(t,n){if(1&t&&(p(0,"div",17),Ut(1,"safe"),q(2,Ahe,1,3,"div",6),g()),2&t){const e=v(3);je("background-image",zt(1,8,"url("+e.wallImageUrl+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),m("ngClass",Ja(11,WC,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.BOTTOM,e.slopeDirection==e.slopeDirectionState.TOP)),h(2),m("ngIf",e.isSelected)}}function Fhe(t,n){if(1&t&&(Ue(0),q(1,Phe,3,16,"div",16),ze()),2&t){const e=v(2);h(),m("ngIf",e.isVisibleWallLeftRight)}}function Nhe(t,n){if(1&t&&(Ue(0),q(1,Ihe,2,1,"ng-container",2)(2,Mhe,2,1,"ng-container",2)(3,Ohe,2,1,"ng-container",2)(4,Fhe,2,1,"ng-container",2),ze()),2&t){const e=v();h(),m("ngIf",e.slopeDirection!=e.slopeDirectionState.TOP),h(),m("ngIf",e.slopeDirection!=e.slopeDirectionState.BOTTOM),h(),m("ngIf",e.slopeDirection!=e.slopeDirectionState.LEFT),h(),m("ngIf",e.slopeDirection!=e.slopeDirectionState.RIGHT)}}function Rhe(t,n){if(1&t&&(Ue(0),p(1,"div",18),Ge(2,"div",19),p(3,"div",20)(4,"i",21),y(5,"autorenew"),g()(),p(6,"div",22)(7,"i",21),y(8,"autorenew"),g()(),p(9,"div",23)(10,"i",21),y(11,"autorenew"),g()(),p(12,"div",24)(13,"i",21),y(14,"autorenew"),g()()(),ze()),2&t){const e=v();h(),je("opacity",e.isInteract?"1.0":"0.5")("height",e.depth*e.gridSize,"px")}}function Lhe(t,n){if(1&t&&(p(0,"div",25)(1,"div",26),y(2),g(),p(3,"div",27),y(4),g()()),2&t){const e=v();je("height",e.math.abs(e.terreinAltitude*e.gridSize),"px"),m("ngStyle",Ke(5,K5,"translateX("+e.width*e.gridSize/2+"px) translateY("+-e.depth*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.terreinAltitude>0?-(e.altitude+(e.isSlope||e.isWallExist?0:e.height))*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),h(2),Xe(e.math.abs(e.terreinAltitude)),h(2),Xe(e.math.abs(e.terreinAltitude))}}let Bhe=(()=>{class t{get name(){return this.terrain.name}get mode(){return this.terrain.mode}set mode(e){this.terrain.mode=e}get isLocked(){return this.terrain.isLocked}set isLocked(e){this.terrain.isLocked=e}get hasWall(){return this.terrain.hasWall}get hasFloor(){return this.terrain.hasFloor}get wallImage(){return this.imageService.getSkeletonOr(this.terrain.wallImage)}get floorImage(){return this.imageService.getSkeletonOr(this.terrain.floorImage)}get height(){return Hi.clampMin(this.terrain.height)}get width(){return Hi.clampMin(this.terrain.width)}get depth(){return Hi.clampMin(this.terrain.depth)}get altitude(){return this.terrain.altitude}set altitude(e){this.terrain.altitude=e}get isDropShadow(){return this.terrain.isDropShadow}set isDropShadow(e){this.terrain.isDropShadow=e}get isSurfaceShading(){return this.terrain.isSurfaceShading}set isSurfaceShading(e){this.terrain.isSurfaceShading=e}get isInteract(){return this.terrain.isInteract}set isInteract(e){this.terrain.isInteract=e}get isSlope(){return this.terrain.isSlope}set isSlope(e){this.terrain.isSlope=e,e||(this.terrain.slopeDirection=Er.NONE)}get slopeDirection(){return this.terrain.isSlope?this.terrain.isSlope&&this.terrain.slopeDirection===Er.NONE?Er.BOTTOM:this.terrain.slopeDirection:Er.NONE}set slopeDirection(e){this.terrain.isSlope=e!=Er.NONE,this.terrain.slopeDirection=e}get isAltitudeIndicate(){return this.terrain.isAltitudeIndicate}set isAltitudeIndicate(e){this.terrain.isAltitudeIndicate=e}get isVisibleFloor(){return 0<this.width*this.depth}get isVisibleWallTopBottom(){return 0<this.width*this.height}get isVisibleWallLeftRight(){return 0<this.depth*this.height}get selectionState(){return this.selectionService.state(this.terrain)}get isSelected(){return this.selectionState!==$n.NONE}get isMagnetic(){return this.selectionState===$n.MAGNETIC}get isWallExist(){return this.hasWall&&this.wallImage&&this.wallImage.url&&this.wallImage.url.length>0}get terreinAltitude(){let e=this.altitude;return(this.altitude<0||!this.isSlope&&!this.isWallExist)&&(e+=this.height),e}_tmpUrl(e){const i=[this.floorImage,this.wallImage];let r="";return(this._tmpImages[e]?.identifier!=i[e].identifier||this._tmpImageState[e]!=i[e].state)&&(this._tmpImages[e]=i[e],this._tmpImages[e].state===Ri.THUMBNAIL||this._tmpImages[e].state===Ri.COMPLETE?(this._tmpImageState[e]=this._tmpImages[e].state,this._tmpImageUrls[e]&&(r=this._tmpImageUrls[e]),this._tmpImageUrls[e]=URL.createObjectURL(this._tmpImages[e].blob)):this._tmpImageUrls[e]=this._tmpImages[e].url),r&&queueMicrotask(()=>URL.revokeObjectURL(r)),this._tmpImageUrls[e]}get wallImageUrl(){return this._tmpUrl(1)}get floorImageUrl(){return this._tmpUrl(0)}constructor(e,i,r,o,s,a,c,u,f,b,C){this.ngZone=e,this.imageService=i,this.tabletopActionService=r,this.contextMenuService=o,this.elementRef=s,this.panelService=a,this.changeDetector=c,this.selectionService=u,this.pointerDeviceService=f,this.modalService=b,this.coordinateService=C,this.terrain=null,this.is3D=!1,this.gridSize=50,this._tmpImages=[],this._tmpImageUrls=["",""],this._tmpImageState=[0,0],this.movableOption={},this.rotableOption={},this.math=Math,this.slopeDirectionState=Er,this.input=null,this.viewRotateZ=10}ngOnChanges(){ne.unregister(this),ne.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.terrain?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.terrain?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on(`UPDATE_SELECTION/identifier/${this.terrain?.identifier}`,e=>{this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.terrain,colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.terrain}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new Bc(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this.input.destroy(),ne.unregister(this);for(const e of this._tmpImageUrls)e&&URL.revokeObjectURL(e)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLocked&&ne.trigger("DRAG_LOCKED_OBJECT",{srcEvent:e})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.name)}onMove(){this.contextMenuService.close(),tt.play(Te.blockPick)}onMoved(){tt.play(Te.blockPut)}get floorModCss(){let e="",i=0;switch(this.slopeDirection){case Er.TOP:i=Math.atan(this.height/this.depth),e=" rotateX("+i+"rad) scaleY("+1/Math.cos(i)+")";break;case Er.BOTTOM:i=Math.atan(this.height/this.depth),e=" rotateX("+-i+"rad) scaleY("+1/Math.cos(i)+")";break;case Er.LEFT:i=Math.atan(this.height/this.width),e=" rotateY("+-i+"rad) scaleX("+1/Math.cos(i)+")";break;case Er.RIGHT:i=Math.atan(this.height/this.width),e=" rotateY("+i+"rad) scaleX("+1/Math.cos(i)+")"}return e}get floorBrightness(){let e=1;if(!this.isSurfaceShading)return e;switch(this.slopeDirection){case Er.TOP:e=.4;break;case Er.BOTTOM:e=1;break;case Er.LEFT:e=.6;break;case Er.RIGHT:e=.9}return e}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i=this.coordinateService.calcTabletopLocalCoordinate();if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),this.isSelected){let r=()=>this.selectionService.objects.filter(o=>o.aliasName===this.terrain.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u5730\u5f62",action:null,subActions:[{name:"\u3059\u3079\u3066\u56fa\u5b9a\u3059\u308b",action:()=>{r().forEach(o=>o.isLocked=!0),tt.play(Te.lock)}},{name:"\u3059\u3079\u3066\u306e\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{r().forEach(o=>{let s=o.clone();s.location.x+=this.gridSize,s.location.y+=this.gridSize,s.isLocked=!1,o.parent&&o.parent.appendChild(s)}),tt.play(Te.blockPut)}}]})}return e.push(Zt),e}makeContextMenu(){let e=this.coordinateService.calcTabletopLocalCoordinate();return[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,tt.play(Te.unlock)},checkBox:"check"}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,tt.play(Te.lock)},checkBox:"check"},this.isLocked?null:{name:"\u91cd\u306a\u308a\u9806 "+(0===this.height?"":" (\u5e73\u9762\u5730\u5f62\u306e\u307f)"),action:null,subActions:[{name:"\u5e73\u9762\u5730\u5f62\u306e\u4e00\u756a\u4e0a\u306b",action:()=>{if(!this.isLocked){const r=this.terrain.parent;r&&r.appendChild(this.terrain)}},disabled:this.isLocked},{name:"\u5e73\u9762\u5730\u5f62\u306e\u4e00\u756a\u4e0b\u306b",action:()=>{if(!this.isLocked){const r=this.terrain.parent;r&&r.prependChild(this.terrain)}},disabled:this.isLocked}],disabled:this.isLocked||0!=this.height},Zt,{name:"\u50be\u659c",action:null,subActions:[{name:(this.slopeDirection==Er.NONE?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{this.slopeDirection=Er.NONE},checkBox:"radio"},Zt,{name:(this.slopeDirection==Er.TOP?"\u25c9":"\u25cb")+" \u4e0a\uff08\u5317\uff09",action:()=>{this.slopeDirection=Er.TOP},checkBox:"radio"},{name:(this.slopeDirection==Er.BOTTOM?"\u25c9":"\u25cb")+" \u4e0b\uff08\u5357\uff09",action:()=>{this.slopeDirection=Er.BOTTOM},checkBox:"radio"},{name:(this.slopeDirection==Er.LEFT?"\u25c9":"\u25cb")+" \u5de6\uff08\u897f\uff09",action:()=>{this.slopeDirection=Er.LEFT},checkBox:"radio"},{name:(this.slopeDirection==Er.RIGHT?"\u25c9":"\u25cb")+" \u53f3\uff08\u6771\uff09",action:()=>{this.slopeDirection=Er.RIGHT},checkBox:"radio"}]},{name:"\u58c1\u306e\u8868\u793a",action:null,subActions:[{name:(this.hasWall&&this.isSurfaceShading?"\u25c9":"\u25cb")+" \u901a\u5e38",action:()=>{this.mode=Rf.ALL,this.isSurfaceShading=!0},checkBox:"radio"},{name:(this.hasWall&&!this.isSurfaceShading?"\u25c9":"\u25cb")+" \u9670\u5f71\u306a\u3057",action:()=>{this.mode=Rf.ALL,this.isSurfaceShading=!1},checkBox:"radio"},{name:(this.hasWall?"\u25cb":"\u25c9")+" \u975e\u8868\u793a",action:()=>{this.mode=Rf.FLOOR,this.depth*this.width==0&&(this.terrain.width=this.width<=0?1:this.width,this.terrain.depth=this.depth<=0?1:this.depth)},checkBox:"radio"}]},Zt,this.isDropShadow?{name:"\u2611 \u5f71\u3092\u843d\u3068\u3059",action:()=>{this.isDropShadow=!1},checkBox:"check"}:{name:"\u2610 \u5f71\u3092\u843d\u3068\u3059",action:()=>{this.isDropShadow=!0},checkBox:"check"},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1},checkBox:"check"}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0},checkBox:"check"},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,tt.play(Te.sweep))},altitudeHande:this.terrain},Zt,{name:"\u5730\u5f62\u8a2d\u5b9a\u3092\u7de8\u96c6...",action:()=>{this.showDetail(this.terrain)}},this.terrain.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.terrain.getUrls().map(r=>{const o=r.value.toString();return{name:r.name?r.name:o,action:()=>{ke.sameOrigin(o)?window.open(o.trim(),"_blank","noopener"):this.modalService.open(sa,{url:o,title:this.terrain.name,subTitle:r.name})},disabled:!ke.validUrl(o),error:ke.validUrl(o)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:ke.validUrl(o)&&!ke.sameOrigin(o)}})},this.terrain.getUrls().length<=0?null:Zt,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.terrain.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.isLocked=!1,this.terrain.parent&&this.terrain.parent.appendChild(r),tt.play(Te.blockPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.terrain.destroy(),tt.play(Te.sweep)}},Zt,{name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(e)}]}showDetail(e){ne.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5730\u5f62\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(kl,{title:r,left:i.x-250,top:i.y-150,width:550,height:380}).tabletopObject=e}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Pn),Y(tm),Y(jC),Y(Bo),Y(fr),Y(yi),Y(Zr),Y(Ml),Y(lr),Y(Ei),Y(rh))};static#t=this.\u0275cmp=In({type:t,selectors:[["terrain"]],hostBindings:function(i,r){1&i&&he("dragstart",function(s){return r.onDragstart(s)})("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{terrain:"terrain",is3D:"is3D"},features:[hr],decls:8,vars:24,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.ondragstart","movable.ondragend","movable.option","movable.disable","movable.interact"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.ondragstart","rotable.ondragend","ngClass","rotable.option","rotable.disable"],[4,"ngIf"],[1,"is-3d","texture",2,"z-index","1",3,"ngClass","ngStyle"],["class","is-3d","style","display:flex; align-items: center; border-left: 2px dashed blanchedalmond; position: absolute; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],["style","opacity: 0.7; filter: brightness(0) blur(1px); transform: translateZ(0.3px) scale(0.98); backface-visibility: visible","class","is-3d texture chrome-smooth-image-trick",3,"ngClass","background-image",4,"ngIf"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"is-3d","texture","chrome-smooth-image-trick",2,"opacity","0.7","filter","brightness(0) blur(1px)","transform","translateZ(0.3px) scale(0.98)","backface-visibility","visible",3,"ngClass"],[1,"selected-highlight",3,"ngClass"],[1,"is-3d","texture","chrome-smooth-image-trick",3,"ngClass","ngStyle"],["class","is-3d texture of-wall-top chrome-smooth-image-trick","style","transform: translateY(-100%) rotateX(90deg) rotateZ(180deg) scaleX(-1.0)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-top","chrome-smooth-image-trick",2,"transform","translateY(-100%) rotateX(90deg) rotateZ(180deg) scaleX(-1.0)",3,"ngClass"],["class","is-3d texture of-wall-bottom chrome-smooth-image-trick","style","transform: rotateX(-90deg)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-bottom","chrome-smooth-image-trick",2,"transform","rotateX(-90deg)",3,"ngClass"],["class","is-3d texture of-wall-left chrome-smooth-image-trick","style","transform: rotateZ(90deg) rotateX(-90deg) scaleX(-1.0) translateX(-100%) translateY(-100%)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-left","chrome-smooth-image-trick",2,"transform","rotateZ(90deg) rotateX(-90deg) scaleX(-1.0) translateX(-100%) translateY(-100%)",3,"ngClass"],["class","is-3d texture of-wall-right chrome-smooth-image-trick","style","transform: rotateZ(-90deg) rotateX(-90deg) translateY(-100%)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-right","chrome-smooth-image-trick",2,"transform","rotateZ(-90deg) rotateX(-90deg) translateY(-100%)",3,"ngClass"],[1,"is-3d",2,"z-index","0"],[1,"pedestal-grab","rotate-grab","is-3d"],[1,"rotate-grab","of-left-top","rotate-grab-icon","is-3d"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","rotate-grab-icon","is-3d"],[1,"rotate-grab","of-right-bottom","rotate-grab-icon","is-3d"],[1,"rotate-grab","of-right-top","rotate-grab-icon","is-3d"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","position","absolute","transform-origin","top left",3,"ngStyle"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"]],template:function(i,r){1&i&&(p(0,"div",0),he("movable.ondragstart",function(){return r.onMove()})("movable.ondragend",function(){return r.onMoved()}),p(1,"div",1),he("rotable.ondragstart",function(){return r.onMove()})("rotable.ondragend",function(){return r.onMoved()}),q(2,yhe,3,2,"ng-container",2),p(3,"div",3),q(4,xhe,4,14,"ng-container",2)(5,Nhe,5,4,"ng-container",2),g(),q(6,Rhe,15,4,"ng-container",2),g(),q(7,Lhe,5,7,"div",4),g()),2&i&&(je("width",r.width*r.gridSize,"px")("height",r.depth*r.gridSize,"px"),m("movable.option",r.movableOption)("movable.disable",r.isLocked)("movable.interact",r.isInteract),h(),m("ngClass",Ke(17,ghe,!r.isLocked))("rotable.option",r.rotableOption)("rotable.disable",r.isLocked),h(),m("ngIf",r.hasFloor&&r.isVisibleFloor&&0<r.floorImageUrl.length),h(),m("ngClass",Tn(19,mhe,r.height<.5&&0==r.altitude,r.height>=.5&&0==r.altitude))("ngStyle",Ke(22,K5,"translateZ("+r.altitude*r.gridSize+"px)")),h(),m("ngIf",r.hasFloor&&r.isVisibleFloor&&0<r.floorImageUrl.length),h(),m("ngIf",r.isWallExist),h(),m("ngIf",!r.isLocked),h(),m("ngIf",r.isAltitudeIndicate&&!((r.isSlope||r.isWallExist)&&-r.height<r.altitude&&r.altitude<0)&&(r.terreinAltitude<=-.5||.5<=r.terreinAltitude)))},dependencies:[Ni,ri,Lo,is,Hf,cr],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{height:100%;width:100%}.texture[_ngcontent-%COMP%]{position:absolute;backface-visibility:hidden;background-repeat:no-repeat;background-size:100% 100%;height:100%;width:100%}.of-wall-top[_ngcontent-%COMP%]{top:0;left:0;transform-origin:50% 100%;transform:translateY(-100%) rotateX(90deg) rotate(180deg) scaleX(-1);filter:brightness(.3)}.of-wall-bottom[_ngcontent-%COMP%]{bottom:0;left:0;transform-origin:50% 100%;transform:rotateX(-90deg)}.of-wall-left[_ngcontent-%COMP%]{top:0;left:0;transform-origin:0% 0%;transform:rotate(90deg) rotateX(-90deg) scaleX(-1) translate(-100%) translateY(-100%);filter:brightness(.5)}.of-wall-right[_ngcontent-%COMP%]{top:0;right:0;transform-origin:100% 0%;transform:rotate(-90deg) rotateX(-90deg) translateY(-100%);filter:brightness(.8)}.of-wall-top.is-slope[_ngcontent-%COMP%], .of-wall-bottom.is-slope[_ngcontent-%COMP%], .of-wall-left.is-slope[_ngcontent-%COMP%], .of-wall-right.is-slope[_ngcontent-%COMP%]{clip-path:polygon(100% 0%,0% 100%,100% 100%)}.of-wall-top.is-inverse-slope[_ngcontent-%COMP%], .of-wall-bottom.is-inverse-slope[_ngcontent-%COMP%], .of-wall-left.is-inverse-slope[_ngcontent-%COMP%], .of-wall-right.is-inverse-slope[_ngcontent-%COMP%]{clip-path:polygon(0% 0%,100% 100%,0% 100%)}.of-wall-top.no-shadow[_ngcontent-%COMP%], .of-wall-left.no-shadow[_ngcontent-%COMP%], .of-wall-right.no-shadow[_ngcontent-%COMP%]{filter:brightness(1)}.selected-highlight[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;height:100%;width:100%;background-color:#80d4ff99}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.pedestal-grab[_ngcontent-%COMP%]{position:absolute;inset:-14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;border:solid 2px #CCCCCC;cursor:-moz-default;cursor:-webkit-default;cursor:default;padding:0;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;transform-style:preserve-3d;transform:translateZ(.1px)}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px;border-radius:14px 7px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px;border-radius:7px 14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px;border-radius:14px 7px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px;border-radius:7px 14px}.blinking-animation[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_blink 1s linear infinite alternate}@keyframes _ngcontent-%COMP%_blink{0%{opacity:.9}to{opacity:.5}}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0px 0px 3px;backface-visibility:hidden}.upright-transform[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.fall[_ngcontent-%COMP%]{transition:transform 132ms cubic-bezier(.21,.97,.75,1.25)}"],changeDetection:0})}return t})();const Uhe=["cursor"],zhe=["rotate"],Hhe=["opacity"],Vhe=()=>["is-front","is-back"];function jhe(t,n){if(1&t&&(p(0,"div",8,2)(2,"div",9),Ut(3,"safe"),p(4,"div",10)(5,"span",11),y(6),g()()()()),2&t){const e=n.$implicit,i=v(2);je("background-image","radial-gradient(circle, transparent 17px, "+i.color+" 18px), radial-gradient(circle, transparent 16px, rgba(240, 218, 189) 17px)"),m("ngClass",e),h(2),je("background-image",zt(3,8,"url("+i.iconUrl+")","style")),h(2),je("background-color",i.color),h(2),Xe(i.name)}}function Ghe(t,n){1&t&&(Ue(0),p(1,"div",4,0)(3,"div",5,1)(5,"div",6),q(6,jhe,7,11,"div",7),g()()(),ze()),2&t&&(h(6),m("ngForOf",wu(1,Vhe)))}class ic{get iconUrl(){return this.cursor.image.url}get name(){return this.cursor.name}get isMine(){return this.cursor.isMine}get color(){return this.cursor.color&&"#ffffff"!=this.cursor.color?this.cursor.color:"#f0dabd"}static#e=this.viewRotateX=50;static#t=this.viewRotateZ=10;get rotateZ(){return ic.viewRotateZ}get nameTagRotate(){let n=ic.viewRotateX%360-90;return-(n>0?n:360+n)}get delayMs(){let n=16.6*(jt.peerIds.length+1);return n<100?100:n}constructor(n,e,i,r){this.changeDetector=n,this.batchService=e,this.coordinateService=i,this.ngZone=r,this.cursor=Fe.myCursor,this.cursorElement=null,this.opacityElements=[],this.rotateElement=null,this.fadeOutTimer=null,this.updateInterval=null,this.callcack=o=>this.onMouseMove(o),this._x=0,this._y=0}static#n=this.ctor=(()=>{ne.register(ic).on("TABLE_VIEW_ROTATE",-1e3,n=>{ic.viewRotateX=n.data.x,ic.viewRotateZ=n.data.z})})();ngOnInit(){this.isMine||ne.register(this).on("CURSOR_MOVE",n=>{n.sendFrom===this.cursor.peerId&&this.batchService.add(()=>{this.stopTransition(),this.setAnimatedTransition(),this.setPosition(n.data[0],n.data[1],n.data[2]),this.setRotate(),this.resetFadeOut(),this.changeDetector.markForCheck()},this)}).on("TABLE_VIEW_ROTATE",-1e3,n=>{this.ngZone.run(()=>{ic.viewRotateX=n.data.x,ic.viewRotateZ=n.data.z,this.rotateElement&&this.setRotate(),this.changeDetector.markForCheck()})})}ngAfterViewInit(){this.isMine?this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousemove",this.callcack),document.body.addEventListener("touchmove",this.callcack)}):(this.cursorElement=this.cursorElementRef.nativeElement,this.opacityElements=this.opacityElementRefs.map(n=>n.nativeElement),this.rotateElement=this.rotateElementRef.nativeElement,this.setAnimatedTransition(),this.setPosition(0,0,0),this.rotateElement&&this.setRotate(),this.resetFadeOut())}ngOnDestroy(){document.body.removeEventListener("mousemove",this.callcack),document.body.removeEventListener("touchmove",this.callcack),ne.unregister(this),this.batchService.remove(this),this.fadeOutTimer&&this.fadeOutTimer.clear()}onMouseMove(n){let e=n.touches?n.changedTouches[0].pageX:n.pageX,i=n.touches?n.changedTouches[0].pageY:n.pageY;e===this._x&&i===this._y||(this._x=e,this._y=i,this._target=n.target,this.updateInterval||(this.updateInterval=setTimeout(()=>{this.updateInterval=null,this.calcLocalCoordinate(this._x,this._y,this._target)},this.delayMs)))}calcLocalCoordinate(n,e,i){if(!document.getElementById("app-table-layer").contains(i))return;let r={x:n,y:e,z:0};r=this.coordinateService.calcTabletopLocalCoordinate(r,i),ne.call("CURSOR_MOVE",[r.x,r.y,r.z])}resetFadeOut(){this.opacityElements.forEach(n=>{n.style.opacity="0.9"}),null==this.fadeOutTimer&&(this.fadeOutTimer=new Nc(()=>{this.opacityElements.forEach(n=>{n.style.opacity="0.0"})},3e3)),this.fadeOutTimer.reset()}stopTransition(){this.cursorElement.style.transform=window.getComputedStyle(this.cursorElement).transform}setAnimatedTransition(){this.cursorElement.style.transition=`transform ${this.delayMs+33}ms linear, opacity 0.5s ease-out`}setPosition(n,e,i){this.cursorElement.style.transform=`translateX(${n.toFixed(4)}px) translateY(${e.toFixed(4)}px) translateZ(${i.toFixed(4)}px)`}setRotate(){this.rotateElement.style.transform=`rotateZ(${-this.rotateZ}deg) rotateX(${this.nameTagRotate}deg)`}static#i=this.\u0275fac=function(e){return new(e||ic)(Y(Zr),Y(kC),Y(rh),Y(Pn))};static#r=this.\u0275cmp=In({type:ic,selectors:[["peer-cursor"],["","peer-cursor",""]],viewQuery:function(e,i){if(1&e&&(Ln(Uhe,5),Ln(zhe,5),Ln(Hhe,5)),2&e){let r;Bn(r=Un())&&(i.cursorElementRef=r.first),Bn(r=Un())&&(i.rotateElementRef=r.first),Bn(r=Un())&&(i.opacityElementRefs=r)}},inputs:{cursor:"cursor"},decls:1,vars:1,consts:[["cursor",""],["rotate",""],["opacity",""],[4,"ngIf"],[1,"component","is-3d","is-transition","is-pointer-events-none"],[1,"is-3d"],[1,"upright-transform","is-3d"],["class","peer-cursor is-3d is-opacity-transition",3,"ngClass","background-image",4,"ngFor","ngForOf"],[1,"peer-cursor","is-3d","is-opacity-transition",3,"ngClass"],[1,"icon","is-3d"],[1,"name","is-center","is-3d"],[1,"is-3d",2,"white-space","nowrap","color","whitesmoke"]],template:function(e,i){1&e&&q(0,Ghe,7,2,"ng-container",3),2&e&&m("ngIf",!i.isMine)},dependencies:[Ni,nr,ri,cr],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;overflow:visible;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.is-transition[_ngcontent-%COMP%]{transition:transform 133ms linear}.is-opacity-transition[_ngcontent-%COMP%]{transition:opacity .5s ease-out}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg)}.peer-cursor[_ngcontent-%COMP%]{height:45px;width:45px;position:absolute;left:0;top:0;box-sizing:border-box;border:solid 1px rgba(240,218,189);border-radius:50% 50% 5%;transform-origin:100% 100%;backface-visibility:hidden}.is-front[_ngcontent-%COMP%]{transform:translate(-100%) translateY(-100%) rotate(45deg)}.is-back[_ngcontent-%COMP%]{transform:translate(-100%) translateY(-100%) rotateY(180deg) rotate(45deg)}.icon[_ngcontent-%COMP%]{overflow:visible;height:100%;width:100%;border-radius:100%;background-position:top,center;background-repeat:no-repeat;background-size:cover;background-color:transparent;transform:rotate(-45deg) scale(.85)}.name[_ngcontent-%COMP%]{box-sizing:border-box;font-size:7px;padding:2px 5px;border-radius:14px;color:#ccc;background-color:#1e1e1ecc;transform-origin:center}.is-center[_ngcontent-%COMP%]{position:absolute;left:50%;top:-26px;transform:translate(-50%)}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}"]})}const Whe=["textArea"],J5=t=>({"is-grab":t}),$he=(t,n)=>({fall:t,softy:n}),$C=t=>({transform:t}),Yhe=t=>({"is-bg-filter":t}),Zhe=(t,n,e)=>({"is-pointer-events-none":t,"is-pointer-events-auto":n,"hide-area":e}),qhe=t=>({"hide-area":t}),YC=t=>({"is-inverse":t}),eL=t=>({"is-magnetic":t}),Xhe=t=>({transform:t});function Khe(t,n){if(1&t&&(p(0,"div",22),y(1),g()),2&t){const e=v();h(),Xe(e.title)}}function Qhe(t,n){if(1&t&&Ge(0,"div",23),2&t){const e=v();m("ngClass",Ke(1,eL,e.isMagnetic))}}function Jhe(t,n){if(1&t&&Ge(0,"div",23),2&t){const e=v();m("ngClass",Ke(1,eL,e.isMagnetic))}}function efe(t,n){if(1&t&&(p(0,"div",22),y(1),g()),2&t){const e=v();h(),Xe(e.title)}}function tfe(t,n){if(1&t&&Ge(0,"div",24),2&t){const e=v();je("width",(e.width-1)*e.gridSize,"px")("min-height",e.gridSize/2,"px"),m("ngClass",Ke(6,J5,!e.isLocked))("ngStyle",Ke(8,$C,"translateX("+e.gridSize/2+"px) translateY("+-e.gridSize/4+"px)"))}}function nfe(t,n){if(1&t&&(p(0,"div")(1,"div",17)(2,"i",18),y(3,"autorenew"),g()(),p(4,"div",19)(5,"i",18),y(6,"autorenew"),g()()()),2&t){const e=v();h(2),m("ngClass",Ke(2,YC,e.isInverse)),h(3),m("ngClass",Ke(4,YC,e.isInverse))}}function ife(t,n){if(1&t&&(p(0,"div",25)(1,"div",26)(2,"span",27),y(3),g(),p(4,"span",28),y(5),g()()()),2&t){const e=v();je("height",e.math.abs(e.textNoteAltitude*e.gridSize),"px"),m("ngStyle",Ke(5,Xhe,"rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),h(3),Xe(e.math.abs(e.textNoteAltitude)),h(2),Xe(e.textNoteAltitude)}}let rfe=(()=>{class t{get title(){return this.textNote.title}get text(){return this.calcFitHeightIfNeeded(),this.textNote.text}set text(e){this.calcFitHeightIfNeeded(),this.textNote.text=e}get color(){return this.textNote.color}set color(e){this.textNote.color=e}get textShadowCss(){const e=ke.textShadowColor(this.color,"#f2f2f2","#000000");return`${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px,\n    ${e} 0px 0px 0.5px,\n    ${e} 0px 0px 0.5px`}get fontSize(){return this.calcFitHeightIfNeeded(),this.textNote.fontSize}get imageFile(){return this.textNote.imageFile}get rotate(){return this.textNote.rotate}set rotate(e){this.textNote.rotate=e}get height(){return Hi.clampMin(this.textNote.height)}get width(){return Hi.clampMin(this.textNote.width)}get altitude(){return this.textNote.altitude}set altitude(e){this.textNote.altitude=e}get textNoteAltitude(){let e=this.altitude;if(this.isUpright&&this.altitude<0){if(-this.height<=this.altitude)return 0;e+=this.height}return+e.toFixed(1)}get isUpright(){return this.textNote.isUpright}set isUpright(e){this.textNote.isUpright=e}get isAltitudeIndicate(){return this.textNote.isAltitudeIndicate}set isAltitudeIndicate(e){this.textNote.isAltitudeIndicate=e}get isLocked(){return this.textNote.isLocked}set isLocked(e){this.textNote.isLocked=e}get isShowTitle(){return this.textNote.isShowTitle}set isShowTitle(e){this.textNote.isShowTitle=e}get isWhiteOut(){return this.textNote.isWhiteOut}set isWhiteOut(e){this.textNote.isWhiteOut=e}get isEditorSelected(){return document.activeElement===this.textAreaElementRef.nativeElement}get isActive(){return document.activeElement===this.textAreaElementRef.nativeElement}get selectionState(){return this.selectionService.state(this.textNote)}get isSelected(){return this.selectionState!==$n.NONE}get isMagnetic(){return this.selectionState===$n.MAGNETIC}get rubiedText(){return ke.rubyToHtml(ke.escapeHtml(this.text))}constructor(e,i,r,o,s,a,c,u){this.ngZone=e,this.contextMenuService=i,this.elementRef=r,this.panelService=o,this.changeDetector=s,this.pointerDeviceService=a,this.modalService=c,this.selectionService=u,this.textNote=null,this.is3D=!1,this.callbackOnMouseUp=f=>this.onMouseUp(f),this.gridSize=50,this.math=Math,this.calcFitHeightTimer=null,this.movableOption={},this.rotableOption={},this.viewRotateZ=10,this.input=null}get isInverse(){const e=Math.abs(this.viewRotateZ+this.rotate)%360;return 90<e&&e<270}ngOnChanges(){ne.unregister(this),ne.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.textNote?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.textNote?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on(`UPDATE_SELECTION/identifier/${this.textNote?.identifier}`,e=>{this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.textNote,transformCssOffset:"translateZ(0.17px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.textNote}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new Bc(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){ne.unregister(this),this.input.destroy()}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLocked&&ne.trigger("DRAG_LOCKED_OBJECT",{srcEvent:e})}onMouseDown(e){if(!this.isActive&&!this.isLocked){if(e.preventDefault(),this.textNote.toTopmost(),2===e.button)return void ne.trigger("DRAG_LOCKED_OBJECT",{srcEvent:e});this.addMouseEventListeners()}}onMouseUp(e){if(this.pointerDeviceService.isAllowedToOpenContextMenu){let i=window.getSelection();i.isCollapsed||i.removeAllRanges(),this.textAreaElementRef.nativeElement.focus()}this.removeMouseEventListeners(),e.preventDefault()}onRotateMouseDown(e){e.stopPropagation(),e.preventDefault()}onContextMenu(e){if(this.removeMouseEventListeners(),this.isActive||(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.title)}onMove(){this.contextMenuService.close(),tt.play(Te.cardPick)}onMoved(){tt.play(Te.cardPut)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i={x:this.textNote.location.x,y:this.textNote.location.y,z:this.textNote.posZ};return e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),e.push(Zt),e}makeContextMenu(){return[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,tt.play(Te.unlock)},checkBox:"check"}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,tt.play(Te.lock)},checkBox:"check"},Zt,this.isUpright?{name:"\u2611 \u76f4\u7acb",action:()=>{this.isUpright=!1},checkBox:"check"}:{name:"\u2610 \u76f4\u7acb",action:()=>{this.isUpright=!0},checkBox:"check"},this.isShowTitle?{name:"\u2611 \u30bf\u30a4\u30c8\u30eb\u30d0\u30fc\u306e\u8868\u793a",action:()=>{this.isShowTitle=!1},checkBox:"check"}:{name:"\u2610 \u30bf\u30a4\u30c8\u30eb\u30d0\u30fc\u306e\u8868\u793a",action:()=>{this.isShowTitle=!0},checkBox:"check"},this.isWhiteOut?{name:"\u2611 \u80cc\u666f\u306e\u8272\u629c\u304d",action:()=>{this.isWhiteOut=!1},checkBox:"check"}:{name:"\u2610 \u80cc\u666f\u306e\u8272\u629c\u304d",action:()=>{this.isWhiteOut=!0},checkBox:"check"},Zt,this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1},checkBox:"check"}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0},checkBox:"check"},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,tt.play(Te.sweep))},altitudeHande:this.textNote},Zt,{name:"\u30e1\u30e2\u3092\u7de8\u96c6...",action:()=>{this.showDetail(this.textNote)}},this.textNote.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.textNote.getUrls().map(i=>{const r=i.value.toString();return{name:i.name?i.name:r,action:()=>{ke.sameOrigin(r)?window.open(r.trim(),"_blank","noopener"):this.modalService.open(sa,{url:r,title:this.textNote.title,subTitle:i.name})},disabled:!ke.validUrl(r),error:ke.validUrl(r)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:ke.validUrl(r)&&!ke.sameOrigin(r)}})},this.textNote.getUrls().length<=0?null:Zt,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let i=this.textNote.clone();i.isLocked=!1,i.location.x+=this.gridSize,i.location.y+=this.gridSize,i.toTopmost(),tt.play(Te.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.textNote.destroy(),tt.play(Te.sweep)}}]}calcFitHeightIfNeeded(){this.calcFitHeightTimer||this.ngZone.runOutsideAngular(()=>{this.calcFitHeightTimer=setTimeout(()=>{this.calcFitHeight(),this.calcFitHeightTimer=null},0)})}calcFitHeight(){let e=this.textAreaElementRef.nativeElement;e.style.height="0",e.scrollHeight>e.offsetHeight&&(e.style.height=e.scrollHeight+"px")}lastNewLineAdjust(e){return null==e?"":this.isSelected||e.lastIndexOf("\n")!=e.length-1?e:e+"\n"}addMouseEventListeners(){document.body.addEventListener("mouseup",this.callbackOnMouseUp,!1)}removeMouseEventListeners(){document.body.removeEventListener("mouseup",this.callbackOnMouseUp,!1)}showDetail(e){ne.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5171\u6709\u30e1\u30e2\u8a2d\u5b9a";e.title.length&&(r+=" - "+e.title),this.panelService.open(kl,{title:r,left:i.x-350,top:i.y-200,width:560,height:470}).tabletopObject=e}activate(){this.isLocked||this.textAreaElementRef.nativeElement.focus()}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Pn),Y(Bo),Y(fr),Y(yi),Y(Zr),Y(lr),Y(Ei),Y(Ml))};static#t=this.\u0275cmp=In({type:t,selectors:[["text-note"]],viewQuery:function(i,r){if(1&i&&Ln(Whe,7),2&i){let o;Bn(o=Un())&&(r.textAreaElementRef=o.first)}},hostBindings:function(i,r){1&i&&he("dragstart",function(s){return r.onDragstart(s)})("mousedown",function(s){return r.onMouseDown(s)})("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{textNote:"textNote",is3D:"is3D"},features:[hr],decls:31,vars:88,consts:[["textArea",""],["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.ondragstart","movable.ondragend","ngClass","movable.option","movable.disable"],["appRotable","",1,"is-3d",3,"rotable.ondragstart","rotable.ondragend","rotable.option","rotable.disable"],[1,"component-content","is-3d","is-pointer-events-auto"],[1,"is-3d",3,"ngClass","ngStyle"],[1,"is-3d","is-transition",3,"ngStyle"],[1,"upright-transform","is-3d","is-bg-color","is-front","is-bg-texture","chrome-smooth-image-trick",3,"ngClass"],["class","title is-3d is-black-background is-pointer-events-none",4,"ngIf"],["spellcheck","false",1,"textarea","is-3d",3,"input","ngModelChange","ngClass","ngModel"],[1,"is-3d","is-outline-text","note-text",2,"margin-top","-18px",3,"click","ngClass","innerHTML"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"upright-transform","is-3d","is-back","is-bg-color","is-bg-texture","chrome-smooth-image-trick"],[1,"is-3d","is-pointer-events-none",2,"visibility","hidden"],["spellcheck","false","readonly","",1,"textarea","is-3d","hide-area","is-pointer-events-none",3,"ngModelChange","ngModel"],[1,"is-3d","is-outline-text","note-text","is-pointer-events-none",2,"margin-top","-18px",3,"innerHTML"],["class","grand-grabing-area","style","position: absolute",3,"ngClass","ngStyle","width","min-height",4,"ngIf"],[3,"ngStyle"],[1,"rotate-grab","of-left-top"],[1,"material-icons",2,"display","inline-block",3,"ngClass"],[1,"rotate-grab","of-right-top"],[4,"ngIf"],["class","is-3d","style","display: flex; align-items: center; border-left: 2px dashed blanchedalmond; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],[1,"title","is-3d","is-black-background","is-pointer-events-none"],[1,"selected-highlight",3,"ngClass"],[1,"grand-grabing-area",2,"position","absolute",3,"ngClass","ngStyle"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","transform-origin","top left",3,"ngStyle"],[1,"is-3d"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"]],template:function(i,r){if(1&i){const o=Le();p(0,"div",1),he("movable.ondragstart",function(){return V(o),H(r.onMove())})("movable.ondragend",function(){return V(o),H(r.onMoved())}),p(1,"div",2),he("rotable.ondragstart",function(){return V(o),H(r.onMove())})("rotable.ondragend",function(){return V(o),H(r.onMoved())}),p(2,"div",3)(3,"div",4)(4,"div",5)(5,"div",6),Ut(6,"safe"),q(7,Khe,2,1,"div",7),p(8,"textarea",8,0),he("input",function(){return V(o),H(r.calcFitHeight())}),at("ngModelChange",function(a){return V(o),it(r.text,a)||(r.text=a),H(a)}),g(),p(10,"div",9),Ut(11,"safe"),he("click",function(){return V(o),H(r.activate())}),g(),q(12,Qhe,1,3,"div",10),g(),p(13,"div",11),Ut(14,"safe"),q(15,Jhe,1,3,"div",10),p(16,"div",12),q(17,efe,2,1,"div",7),p(18,"textarea",13),at("ngModelChange",function(a){return V(o),it(r.text,a)||(r.text=a),H(a)}),g(),Ge(19,"div",14),Ut(20,"safe"),g()()()(),q(21,tfe,1,10,"div",15),p(22,"div",16)(23,"div",17)(24,"i",18),y(25),g()(),p(26,"div",19)(27,"i",18),y(28),g()()(),q(29,nfe,7,6,"div",20),g()(),q(30,ife,6,7,"div",21),g()}2&i&&(m("ngClass",Ke(65,J5,!r.isLocked))("movable.option",r.movableOption)("movable.disable",r.isEditorSelected||r.isLocked),h(),m("rotable.option",r.rotableOption)("rotable.disable",r.isLocked),h(),je("width",r.width*r.gridSize,"px"),h(),m("ngClass",Tn(67,$he,0==r.altitude,!r.isUpright))("ngStyle",Ke(70,$C,"translateZ("+r.altitude*r.gridSize+"px) rotateY(90deg)")),h(),m("ngStyle",Ke(72,$C,"rotateZ("+(r.isUpright?0:90)+"deg) rotateY(-90deg)")),h(),je("background-image",zt(6,53,"url("+(null==r.imageFile?null:r.imageFile.url)+")","style"))("width",r.width*r.gridSize,"px")("min-height",r.height*r.gridSize,"px"),m("ngClass",Ke(74,Yhe,r.isWhiteOut)),h(2),m("ngIf",r.isShowTitle&&r.title.length),h(),je("font-size",r.fontSize+9,"px"),m("ngClass",Qs(76,Zhe,!r.isEditorSelected,r.isEditorSelected,!r.isEditorSelected)),st("ngModel",r.text),h(2),je("font-size",r.fontSize+9,"px")("color",r.color)("text-shadow",r.textShadowCss),m("ngClass",Ke(80,qhe,r.isEditorSelected))("innerHTML",zt(11,56,r.lastNewLineAdjust(r.rubiedText),"html"),$r),h(2),m("ngIf",r.isSelected),h(),je("background-image",zt(14,59,"url("+(null==r.imageFile?null:r.imageFile.url)+")","style"))("width",r.width*r.gridSize,"px")("min-height",r.height*r.gridSize,"px"),h(2),m("ngIf",r.isSelected),h(2),m("ngIf",r.isShowTitle&&r.title.length),h(),je("font-size",r.fontSize+9,"px"),st("ngModel",r.text),h(),je("font-size",r.fontSize+9,"px"),m("innerHTML",zt(20,62,r.lastNewLineAdjust(r.rubiedText),"html"),$r),h(2),m("ngIf",!r.isLocked),h(),m("ngStyle",Ke(82,$C,"translateZ("+r.altitude*r.gridSize+"px)")),h(2),m("ngClass",Ke(84,YC,r.isInverse)),h(),Xe(r.isLocked?"lock":"autorenew"),h(2),m("ngClass",Ke(86,YC,r.isInverse)),h(),Xe(r.isLocked?"lock":"autorenew"),h(),m("ngIf",!r.isLocked),h(),m("ngIf",r.isAltitudeIndicate&&r.math.abs(r.textNoteAltitude)>=.5))},dependencies:[Ni,ri,Lo,kr,Or,Cr,is,Hf,cr],styles:['[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;width:1px;height:0}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;transform:translate(-50%)}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;backface-visibility:hidden}.is-front[_ngcontent-%COMP%]{transform-origin:50% 100%;transform:rotateX(-90deg)}.is-back[_ngcontent-%COMP%]{transform-origin:50% 100%;transform:rotateX(-90deg) rotateY(180deg)}.is-bg-texture[_ngcontent-%COMP%]{background-repeat:no-repeat;background-size:100% 100%}.is-bg-filter[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:#ffffffb3;transition:background-color .2s}.is-bg-color[_ngcontent-%COMP%]{box-sizing:border-box;color:#444;background-color:#f0dabde6;border:solid 1px #999}.title[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;backface-visibility:hidden}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;resize:none;overflow:hidden;box-sizing:border-box;background:none;border:none;border-radius:0;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1rem;padding:2px;margin:0;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;backface-visibility:hidden}.textarea[_ngcontent-%COMP%]:focus{background:#ffffffbf}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.is-outline-text[_ngcontent-%COMP%]{font-size:24px;color:#444;text-shadow:#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;backface-visibility:hidden;position:absolute;box-sizing:border-box;height:100%;width:100%;top:0;left:0;background-color:#80d4ff99}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:42px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;text-align:center;padding:2px;background-color:#ccc;border-radius:28px;color:#444;font-size:8px}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-21px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-21px}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0px 0px 3px;backface-visibility:hidden}.fall[_ngcontent-%COMP%]{transition:transform 132ms cubic-bezier(.21,.97,.75,1.25)}.fall.softy[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.hide-area[_ngcontent-%COMP%]{overflow:hidden!important;font-size:0pt!important;width:0px!important;height:0px!important;margin:0!important;padding:0!important;border:0px none!important}.note-text[_ngcontent-%COMP%]{font-family:Cambria,Georgia;padding:2px;white-space:pre-wrap;backface-visibility:hidden;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.is-inverse[_ngcontent-%COMP%]{transform:rotate(180deg)}'],changeDetection:0})}return t})();const ofe=t=>({"is-gray-border":t}),sfe=t=>({transform:t}),afe=t=>({"is-magnetic":t}),lfe=(t,n)=>({"background-color":t,transform:n}),tL=(t,n)=>({"is-black-mask":t,"is-harf-black-mask":n});function cfe(t,n){1&t&&(Ue(0),p(1,"div",21)(2,"div",22)(3,"div",23),y(4,"autorenew"),g(),p(5,"div",24),y(6,"autorenew"),g()()(),ze())}function ufe(t,n){if(1&t&&Ge(0,"div",25),2&t){const e=v();m("ngClass",Ke(1,afe,e.isMagnetic))}}function dfe(t,n){1&t&&(p(0,"i",26),y(1,"lock"),g())}function hfe(t,n){1&t&&(p(0,"span"),y(1,"\uff1a"),g())}function ffe(t,n){if(1&t&&(p(0,"span"),y(1),g()),2&t){const e=v();h(),Xe(e.face)}}function pfe(t,n){1&t&&(p(0,"span"),y(1,"???"),g())}function gfe(t,n){1&t&&(p(0,"i",26),y(1,"lock"),g())}function mfe(t,n){1&t&&(p(0,"span"),y(1,"\uff1a"),g())}function _fe(t,n){if(1&t&&(p(0,"span"),y(1),g()),2&t){const e=v();h(),Xe(e.face)}}function bfe(t,n){1&t&&(p(0,"span"),y(1,"???"),g())}function vfe(t,n){if(1&t&&(p(0,"div",27)(1,"div",28)(2,"b"),y(3),g()(),p(4,"div",29)(5,"b"),y(6),g()()()),2&t){const e=v();m("ngStyle",Tn(3,lfe,e.ownerColor+"dd","translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateX("+e.nameTagRotate+"deg)")),h(3),Xe(e.ownerName),h(3),Xe(e.ownerName)}}function yfe(t,n){if(1&t&&(Ge(0,"img",30),Ut(1,"safe")),2&t){const e=v();m("src",zt(1,2,e.imageFile.url,"resourceUrl"),bn)("ngClass",Tn(5,tL,!e.isVisible,e.isMine||e.isGMMode&&e.hasOwner))}}function Cfe(t,n){if(1&t&&(Ge(0,"img",31),Ut(1,"safe")),2&t){const e=v();m("src",zt(1,2,e.backFaceImageFile.url,"resourceUrl"),bn)("ngClass",Tn(5,tL,!e.isVisible,e.isMine||e.isGMMode&&e.hasOwner||e.isVisible&&e.isCoin))}}function xfe(t,n){1&t&&(Ge(0,"img",32),Ut(1,"safe")),2&t&&m("src",zt(1,1,v().imageFile.url,"resourceUrl"),bn)}function wfe(t,n){if(1&t&&(Ge(0,"img",32),Ut(1,"safe")),2&t){const e=v();je("transform",e.isCoin?"scaleX(-1)":"scaleX(-1) scaleY(-1)"),m("src",zt(1,3,e.backFaceImageFile.url,"resourceUrl"),bn)}}let Efe=(()=>{class t{get face(){return this.diceSymbol.face}set face(e){this.diceSymbol.face=e}get owner(){return this.diceSymbol.owner}set owner(e){this.diceSymbol.owner=e}get rotate(){return this.diceSymbol.rotate}set rotate(e){this.diceSymbol.rotate=e}get name(){return this.diceSymbol.name}set name(e){this.diceSymbol.name=e}get size(){return Hi.clampMin(this.diceSymbol.size)}get faces(){return this.diceSymbol.faces}get nothingFaces(){return this.diceSymbol.nothingFaces}get imageFile(){return this.imageService.getEmptyOr(this.diceSymbol.imageFile)}get backFaceImageFile(){return this.imageService.getEmptyOr(this.diceSymbol.backFaceImageFile)}get isGMMode(){return this.diceSymbol.isGMMode}get isMine(){return this.diceSymbol.isMine}get hasOwner(){return this.diceSymbol.hasOwner}get ownerName(){return this.diceSymbol.ownerName}get ownerColor(){return this.diceSymbol.ownerColor}get isVisible(){return this.diceSymbol.isVisible}get isDropShadow(){return this.diceSymbol.isDropShadow}set isDropShadow(e){this.diceSymbol.isDropShadow=e}get isLock(){return this.diceSymbol.isLock}set isLock(e){this.diceSymbol.isLock=e}get isCoin(){return this.diceSymbol.isCoin}get selectionState(){return this.selectionService.state(this.diceSymbol)}get isSelected(){return this.selectionState!==$n.NONE}get isMagnetic(){return this.selectionState===$n.MAGNETIC}get isIconHidden(){return null!=this.iconHiddenTimer}get nameTagRotate(){let e=this.viewRotateX%360-90,i=(this.viewRotateZ+this.rotate)%360;return i=i>0?i:360+i,(e>0?e:360+e)*(this.isFlip?1:-1)}get isFlip(){let e=(this.viewRotateZ+this.rotate)%360;return e=e>0?e:360+e,90<e&&e<270}constructor(e,i,r,o,s,a,c,u,f,b){this.ngZone=e,this.panelService=i,this.contextMenuService=r,this.elementRef=o,this.changeDetector=s,this.pointerDeviceService=a,this.selectionService=c,this.imageService=u,this.modalService=f,this.chatMessageService=b,this.diceSymbol=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.interactGesture=null,this.viewRotateX=50,this.viewRotateZ=10}ngOnChanges(){ne.register(this).on("ROLL_DICE_SYMBOL",e=>{e.data.identifier===this.diceSymbol.identifier&&this.ngZone.run(()=>{this.animeState="inactive",this.changeDetector.markForCheck(),queueMicrotask(()=>{this.animeState="active",this.changeDetector.markForCheck()})})}).on(`UPDATE_GAME_OBJECT/aliasName/${Fe.aliasName}`,e=>{let i=bt.instance.get(e.data.identifier);this.diceSymbol&&i&&i.userId===this.diceSymbol.owner&&this.changeDetector.markForCheck()}).on("DICE_ALL_OPEN",e=>{this.owner&&!this.isLock&&(this.owner="",tt.play(Te.unlock),this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u306e${this.isCoin?"\u8868\uff0f\u88cf":"\u76ee"}\u3092\u516c\u958b \u2192 ${this.face}`))}).on("TABLE_VIEW_ROTATE",e=>{this.ngZone.run(()=>{this.viewRotateX=e.data.x,this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on(`UPDATE_GAME_OBJECT/identifier/${this.diceSymbol?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.diceSymbol?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.diceSymbol?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=Fe.findByPeerId(e.data.peerId);(!i||this.diceSymbol.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.diceSymbol,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain","text-note","character"]},this.rotableOption={tabletopObject:this.diceSymbol}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.interactGesture=new AS(this.elementRef.nativeElement)}),this.interactGesture.onstart=this.onInputStart.bind(this),this.interactGesture.oninteract=this.onDoubleClick.bind(this)}ngOnDestroy(){this.interactGesture.destroy(),ne.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onInputStart(e){this.ngZone.run(()=>this.startIconHiddenTimer())}onDoubleClick(){this.isVisible&&this.ngZone.run(()=>this.diceRoll())}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.name)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i={x:this.diceSymbol.location.x+this.diceSymbol.size*this.gridSize/2,y:this.diceSymbol.location.y+this.diceSymbol.size*this.gridSize/2,z:this.diceSymbol.posZ};if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),this.isSelected){let r=()=>this.selectionService.objects.filter(a=>a.aliasName===this.diceSymbol.aliasName);const o=r().some(a=>a.isCoin),s=r().some(a=>!a.isCoin);e.push({name:`\u9078\u629e\u3057\u305f${o?"\u30b3\u30a4\u30f3":""}${o&&s?"\uff0f":""}${s?"\u30c0\u30a4\u30b9":""}`,action:null,subActions:[{name:`\u3059\u3079\u3066${o?"\u30c8\u30b9":""}${o&&s?"\uff0f":""}${s?"\u632f\u308b":""}`,action:()=>{let a=!1,c=!1,u=!1;const f=[];r().forEach(b=>{if(b.isVisible){a=!0,c=c||b.isCoin,u=u||!b.isCoin,ne.call("ROLL_DICE_SYMBOL",{identifier:b.identifier});let C=b.diceRoll(),x=`${""==b.name?"(\u7121\u540d\u306e"+(b.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":b.name} \u3092${b.isCoin?"\u30c8\u30b9\u3057\u305f":"\u632f\u3063\u305f"}`;""===b.owner&&(x+=` \u2192 ${C}`),f.push(x)}}),f.length&&this.chatMessageService.sendOperationLog(f.join("\u3001")),a&&(c&&tt.play(Te.coinToss),u&&tt.play(Te.diceRoll1))}},{name:"\u3059\u3079\u3066\u516c\u958b",action:()=>{const a=[];r().forEach(c=>{""!=c.owner&&a.push(`${""==c.name?"(\u7121\u540d\u306e"+(c.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":c.name} \u306e${c.isCoin?"\u8868\uff0f\u88cf":"\u76ee"}\u3092\u516c\u958b \u2192 ${c.face}`),c.owner=""}),a.length&&this.chatMessageService.sendOperationLog(a.join("\u3001")),tt.play(Te.unlock)},disabled:!r().some(a=>""!=a.owner)},{name:"\u3059\u3079\u3066\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{const a=[];r().forEach(c=>{c.owner!=jt.peer.userId&&a.push(""==c.name?"(\u7121\u540d\u306e"+(c.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":c.name),c.owner=jt.peer.userId}),a.length&&this.chatMessageService.sendOperationLog(a.join("\u3001")+" \u3092\u81ea\u5206\u3060\u3051\u898b\u305f"),tt.play(Te.lock)},disabled:!r().some(a=>a.owner!=jt.peer.userId)}]})}return e.push(Zt),e}makeContextMenu(){let e=[];if(e.push({name:this.isCoin?"\u30b3\u30a4\u30f3\u30c8\u30b9":"\u30c0\u30a4\u30b9\u3092\u632f\u308b",action:()=>{this.diceRoll()},disabled:!this.isVisible,default:this.isVisible}),e.push(Zt),(this.isMine||this.hasOwner)&&e.push({name:(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+"\u3092\u516c\u958b",action:()=>{this.owner="",tt.play(Te.unlock),this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u306e${this.isCoin?"\u8868\uff0f\u88cf":"\u76ee"}\u3092\u516c\u958b \u2192 ${this.face}`)}}),this.isMine||e.push({name:"\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{this.owner=jt.peer.userId,this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u3092\u81ea\u5206\u3060\u3051\u898b\u305f`),tt.play(Te.lock)}}),e.push(this.isLock?{name:"\u2611 \u4e00\u6589\u516c\u958b\u3057\u306a\u3044",action:()=>{this.isLock=!1,tt.play(Te.unlock)},disabled:this.hasOwner&&!this.isVisible,checkBox:"check"}:{name:"\u2610 \u4e00\u6589\u516c\u958b\u3057\u306a\u3044",action:()=>{this.isLock=!0,tt.play(Te.lock)},disabled:this.hasOwner&&!this.isVisible,checkBox:"check"}),this.isVisible){let i=[],r=this.nothingFaces;r.length>0&&(r.forEach(o=>{i.push({name:`${this.face==o?"\u25c9":"\u25cb"} ${o}\u3000`,action:()=>{tt.play(Te.dicePut),this.face=o},checkBox:"radio"})}),i.push(Zt)),this.faces.forEach(o=>{i.push({name:`${this.face==o?"\u25c9":"\u25cb"} ${o}\u3000`,action:()=>{""===this.owner&&tt.play(Te.dicePut),""===this.owner&&this.face!=o&&this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u306e${this.isCoin?"\u8868\uff0f\u88cf":"\u76ee"}\u3092\u5909\u66f4 \u2192 ${o}`),this.face=o},checkBox:"radio"})}),e.push({name:this.isCoin?"\u8868\uff0f\u88cf":"\u30c0\u30a4\u30b9\u76ee",action:null,subActions:i})}return e.push(Zt),e.push(this.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!1},checkBox:"check"}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!0},checkBox:"check"}),e.push(Zt),e.push({name:"\u8a73\u7d30\u3092\u8868\u793a...",action:()=>{this.showDetail(this.diceSymbol)}}),this.diceSymbol.getUrls().length>0&&(e.push({name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.diceSymbol.getUrls().map(i=>{const r=i.value.toString();return{name:i.name?i.name:r,action:()=>{ke.sameOrigin(r)?window.open(r.trim(),"_blank","noopener"):this.modalService.open(sa,{url:r,title:this.diceSymbol.name,subTitle:i.name})},disabled:!ke.validUrl(r),error:ke.validUrl(r)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:ke.validUrl(r)&&!ke.sameOrigin(r)}})}),e.push(Zt)),e.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let i=this.diceSymbol.clone();i.location.x+=this.gridSize,i.location.y+=this.gridSize,i.update(),tt.play(Te.dicePut)}}),e.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.diceSymbol.destroy(),tt.play(Te.sweep)}}),e}onMove(){this.contextMenuService.close(),tt.play(Te.dicePick)}onMoved(){tt.play(Te.dicePut)}diceRoll(){ne.call("ROLL_DICE_SYMBOL",{identifier:this.diceSymbol.identifier}),tt.play(this.isCoin?Te.coinToss:Te.diceRoll1);let e=this.diceSymbol.diceRoll(),i=`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u3092${this.isCoin?"\u30c8\u30b9\u3057\u305f":"\u632f\u3063\u305f"}`;return""===this.owner&&(i+=` \u2192 ${e}`),this.chatMessageService.sendOperationLog(i),e}showDetail(e){ne.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(kl,{title:r,left:i.x-300,top:i.y-300,width:600,height:490}).tabletopObject=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Pn),Y(yi),Y(Bo),Y(fr),Y(Zr),Y(lr),Y(Ml),Y(tm),Y(Ei),Y(vo))};static#t=this.\u0275cmp=In({type:t,selectors:[["dice-symbol"]],hostBindings:function(i,r){1&i&&he("dragstart",function(s){return r.onDragstart(s)})("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{diceSymbol:"diceSymbol",is3D:"is3D"},features:[hr],decls:32,vars:49,consts:[["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.ondragstart","movable.ondragend","movable.option"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.ondragstart","rotable.ondragend","rotable.option"],[4,"ngIf"],[1,"pedestal-inner",3,"ngClass"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"pedestal-outer"],[1,"upright-transform","is-fit-width","is-3d"],[1,"rotate-frame","is-3d"],[1,"rotate-inner","is-3d"],[1,"is-3d",3,"ngStyle"],[1,"name-tag","is-nowrap","is-black-background","is-3d",2,"transform","translateX(-50%)"],[1,"fornt-tag","is-3d"],["class","material-icons lock-icon",4,"ngIf"],[1,"back-tag","is-3d"],["class","owner-tag is-nowrap is-black-background is-3d",3,"ngStyle",4,"ngIf"],["class","image front-face is-3d chrome-smooth-image-trick",3,"src","ngClass",4,"ngIf"],["class","image back-face is-3d chrome-smooth-image-trick","style","transform: rotateY(-180deg)",3,"src","ngClass",4,"ngIf"],[1,"is-3d",2,"position","relative","top","-20%"],["class","image shadow is-3d","style","opacity: 0.7; filter: brightness(0) blur(1px)",3,"src",4,"ngIf"],["class","image shadow is-3d","style","opacity: 0.7; filter: brightness(0) blur(1px)",3,"src","transform",4,"ngIf"],[1,"pedestal-grab","rotate-grab","is-3d"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"selected-highlight",3,"ngClass"],[1,"material-icons","lock-icon"],[1,"owner-tag","is-nowrap","is-black-background","is-3d",3,"ngStyle"],[1,"fornt-tag","is-3d",2,"color","whitesmoke"],[1,"back-tag","is-3d",2,"color","whitesmoke"],[1,"image","front-face","is-3d","chrome-smooth-image-trick",3,"src","ngClass"],[1,"image","back-face","is-3d","chrome-smooth-image-trick",2,"transform","rotateY(-180deg)",3,"src","ngClass"],[1,"image","shadow","is-3d",2,"opacity","0.7","filter","brightness(0) blur(1px)",3,"src"]],template:function(i,r){1&i&&(p(0,"div",0),he("movable.ondragstart",function(){return r.onMove()})("movable.ondragend",function(){return r.onMoved()}),p(1,"div",1)(2,"div",2),he("rotable.ondragstart",function(){return r.onMove()})("rotable.ondragend",function(){return r.onMoved()}),q(3,cfe,7,0,"ng-container",3),Ge(4,"div",4),q(5,ufe,1,3,"div",5),Ge(6,"div",6),p(7,"div",1)(8,"div",7)(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11),he("@diceRollNameTag.done",function(s){return r.animationShuffleDone(s)}),p(13,"div",12),q(14,dfe,2,0,"i",13),y(15),q(16,hfe,2,0,"span",3)(17,ffe,2,1,"span",3)(18,pfe,2,0,"span",3),g(),p(19,"div",14),q(20,gfe,2,0,"i",13),y(21),q(22,mfe,2,0,"span",3)(23,_fe,2,1,"span",3)(24,bfe,2,0,"span",3),g()()(),q(25,vfe,7,6,"div",15),p(26,"div",1),he("@diceRoll.done",function(s){return r.animationShuffleDone(s)})("@coinFlip.done",function(s){return r.animationShuffleDone(s)}),q(27,yfe,2,8,"img",16)(28,Cfe,2,8,"img",17),g()()()(),p(29,"div",18),he("@diceRoll.done",function(s){return r.animationShuffleDone(s)}),q(30,xfe,2,4,"img",19)(31,wfe,2,6,"img",20),g()()()()()),2&i&&(je("width",r.size*r.gridSize,"px")("height",r.size*r.gridSize,"px"),m("movable.option",r.movableOption),h(),m("@bounceInOut","in"),h(),m("rotable.option",r.rotableOption),h(),m("ngIf",!r.isIconHidden),h(),m("ngClass",Ke(45,ofe,r.hasOwner)),h(),m("ngIf",r.isSelected),h(4),je("width",r.size*r.gridSize,"px")("height",r.size*r.gridSize,"px"),h(2),m("ngStyle",Ke(47,sfe,"translateX("+r.size*r.gridSize/2+"px) rotateX("+r.nameTagRotate+"deg)")),h(),m("@changeFaceNameTag",r.isVisible?r.face:null)("@diceRollNameTag",r.animeState),h(2),m("ngIf",r.isLock&&r.hasOwner),h(),Xe(r.name),h(),m("ngIf",0<r.name.length),h(),m("ngIf",r.isVisible),h(),m("ngIf",!r.isVisible),h(2),m("ngIf",r.isLock&&r.hasOwner),h(),Xe(r.name),h(),m("ngIf",0<r.name.length),h(),m("ngIf",r.isVisible),h(),m("ngIf",!r.isVisible),h(),m("ngIf",r.hasOwner&&0<r.ownerName.length),h(),je("transform",r.isCoin?"rotateX(30deg)":""),m("@changeFace",!r.isCoin&&r.isVisible?r.face:null)("@changeFaceCoin",r.isCoin&&r.isVisible?"\u88cf"==r.face?0:1:null)("@diceRoll",!r.isCoin&&r.animeState)("@coinFlip",r.isCoin&&r.animeState),h(),m("ngIf",0<r.imageFile.url.length),h(),m("ngIf",0<r.backFaceImageFile.url.length),h(),je("width",r.size*r.gridSize,"px")("height",r.size*r.gridSize,"px"),m("@changeFace",!r.isCoin&&r.isVisible?r.face:null)("@changeFaceCoin",r.isCoin&&r.isVisible?"\u8868"==r.face?1:2:null)("@diceRoll",r.animeState),h(),m("ngIf",!r.isFlip&&r.isDropShadow&&0<r.imageFile.url.length),h(),m("ngIf",r.isFlip&&r.isDropShadow&&0<r.backFaceImageFile.url.length))},dependencies:[Ni,ri,Lo,is,Hf,cr],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;backface-visibility:hidden}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:100%;box-sizing:border-box;border-top:solid 28px #999;border-left:solid 12px #999;border-right:solid 12px #CCC;border-bottom:solid 28px #CCC;border-radius:22px}.pedestal-inner[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 6px rgb(216,139,75);border-radius:5px}.is-gray-border[_ngcontent-%COMP%]{border-color:#999}.pedestal-outer[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 2px #212121;border-radius:5px}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border-radius:5px;background-color:#80d4ff99}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{bottom:0;left:0;right:0;margin:auto;width:100%;height:auto;vertical-align:bottom}.image.shadow[_ngcontent-%COMP%]{width:100%;height:100%}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:6px;position:absolute;top:-30px;transform-origin:center bottom}.owner-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:12px;padding:3px 9px;border-radius:6px;position:absolute;top:-55px;transform-origin:center bottom}.rotate-frame[_ngcontent-%COMP%]{bottom:0;left:0;right:0}.rotate-inner[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;width:100%;height:auto}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.fornt-tag[_ngcontent-%COMP%]{backface-visibility:hidden}.back-tag[_ngcontent-%COMP%]{position:absolute;top:3px;backface-visibility:hidden;transform:rotateY(-180deg)}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;bottom:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{position:absolute;width:24px;top:0;left:0;right:0;margin:auto;color:#444}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .pedestal-outer[_ngcontent-%COMP%]{transform-style:preserve-3d;transform:translateZ(.01px)}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.material-icons.lock-icon[_ngcontent-%COMP%]{display:inline-block;font-size:smaller;margin-right:2px}.front-face[_ngcontent-%COMP%]{backface-visibility:hidden}.back-face[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;transform:rotateY(-180deg)}"],data:{animation:[Xn("diceRoll",[an("* => active",[rn("800ms ease",En([We({transform:"scale3d(0.8, 0.8, 0.8) rotateZ(-0deg)",offset:0}),We({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(-360deg)",offset:.5}),We({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(-520deg)",offset:.75}),We({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(-630deg)",offset:.875}),We({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(-720deg)",offset:1})]))])]),Xn("coinFlip",[an("* => active",[rn("800ms ease-out",En([We({transform:"scale3d(0.8, 0.8, 0.8) translateY(0%) rotateX(60deg) rotateX(-0deg) rotateY(-0deg)",offset:0}),We({transform:"scale3d(1.2, 1.2, 1.2)  translateY(-28%) rotateX(60deg) rotateX(-360deg) rotateY(-360deg)",offset:.5}),We({transform:"scale3d(0.75, 0.75, 0.75) translateY(-40%) rotateX(60deg) rotateX(-520deg) rotateY(-520deg)",offset:.75}),We({transform:"scale3d(1.125, 1.125, 1.125) translateY(-28%) rotateX(60deg) rotateX(-630deg) rotateY(-630deg)",offset:.875}),We({transform:"scale3d(1.0, 1.0, 1.0) translateY(0%) rotateX(60deg) rotateX(-720deg) rotateY(-720deg)",offset:1})]))])]),Xn("diceRollNameTag",[an("* => active",[rn("800ms ease",En([We({transform:"translateX(-50%) scale3d(0.8, 0.8, 0.8) rotateY(0deg)",offset:0}),We({transform:"translateX(-50%) scale3d(1.2, 1.2, 1.2) rotateY(360deg)",offset:.5}),We({transform:"translateX(-50%) scale3d(0.75, 0.75, 0.75) rotateY(520deg)",offset:.75}),We({transform:"translateX(-50%) scale3d(1.125, 1.125, 1.125) rotateY(630deg)",offset:.875}),We({transform:"translateX(-50%) scale3d(1.0, 1.0, 1.0) rotateY(720deg)",offset:1})]))])]),Xn("changeFace",[an(":increment,:decrement",[rn("200ms ease",En([We({transform:"scale3d(0.8, 0.8, 0.8) rotateZ(0deg)",offset:0}),We({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(-360deg)",offset:1})]))])]),Xn("changeFaceCoin",[an(":increment,:decrement",[rn("200ms ease",En([We({transform:"scale3d(0.8, 0.8, 0.8) rotateX(0deg)",offset:0}),We({transform:"scale3d(1.0, 1.0, 1.0) rotateX(-720deg)",offset:1})]))])]),Xn("changeFaceNameTag",[an(":increment,:decrement",[rn("200ms ease",En([We({transform:"translateX(-50%) scale3d(0.8, 0.8, 0.8) rotateY(0deg)",offset:0}),We({transform:"translateX(-50%) scale3d(1.0, 1.0, 1.0) rotateY(360deg)",offset:1})]))])]),Xn("bounceInOut",[an("void => *",[rn("600ms ease",En([We({transform:"scale3d(0, 0, 0)",offset:0}),We({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),We({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),We({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),We({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),an("* => void",[rn(100,We({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0})}return t})();class Mb{constructor(n,e,i){this.canvasElement=n,this.canvasElementRange=e,this.canvasElementCenter=i}makeBrush(n,e,i){n.strokeStyle=i,n.fillStyle=n.strokeStyle,n.lineWidth=1;let r=Math.floor(e/5);return n.font=`bold ${r}px sans-serif`,n.textBaseline="top",n.textAlign="center",n}chkOuterProduct(n,e,i,r,o,s){return(i-n)*(s-e)-(r-e)*(o-n)>=-.01}chkInCircle(n,e,i){return n*n>=e*e+i*i}renderCircle(n){let e=n.gridSize,i=n.areaWidth*e/2,r=n.areaHeight*e/2,s=(Math,-n.centerX%e),a=-n.centerY%e;s>0&&(s-=e),a>0&&(a-=e),n.offSetX&&(s<-.5?s+=e/2:s-=e/2),n.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=n.areaWidth*e,this.canvasElement.height=n.areaHeight*e;let c=this.canvasElement.getContext("2d"),u=0,f=0,b=this.generateCalcGridPositionFunc(n.gridType,n.centerX,n.centerY,n.areaWidth,n.areaHeight);if(0==n.fillType)this.makeBrush(c,e,n.gridColor),c.beginPath(),c.arc(i,r,n.range*e,0,2*Math.PI,!0),c.fill();else{this.makeBrush(c,e,n.gridColor);for(let C=0;C<=n.areaHeight+1;C++)for(let x=0;x<=n.areaWidth+1;x++){let{gx:M,gy:U}=b(x,C,e);if(1==n.fillType)u=M+s+e/2-i,f=U+a+e/2-r,this.chkInCircle(n.range*e,u,f)&&this.fillSquare(c,M+s,U+a,e);else{let W=0;for(let K=0;K<e;K++)for(let $=0;$<e;$++)u=M+s+K-i+.5,f=U+a+$-r+.5,this.chkInCircle(n.range*e,u,f)&&W++;(2==n.fillType&&W>=1||3==n.fillType&&W>=e*e/2||4==n.fillType&&W>=e*e)&&this.fillSquare(c,M+s,U+a,e)}}}this.canvasElementRange.width=n.areaWidth*e,this.canvasElementRange.height=n.areaHeight*e,c=this.canvasElementRange.getContext("2d"),this.makeBrush(c,e,n.rangeColor),c.beginPath(),c.lineWidth=2,c.arc(i,r,n.range*e,0,2*Math.PI,!0),c.stroke(),n.isDocking?(c.beginPath(),c.strokeRect(i-6,r-6,12,12)):(c.beginPath(),c.arc(i,i,5,0,2*Math.PI,!0),c.fill()),this.canvasElementCenter.width=n.areaWidth*e,this.canvasElementCenter.height=n.areaHeight*e,c=this.canvasElementCenter.getContext("2d"),this.makeBrush(c,e,n.rangeColor),n.isDocking?(c.beginPath(),c.strokeRect(i-6,r-6,12,12)):(c.beginPath(),c.arc(i,i,5,0,2*Math.PI,!0),c.fill())}renderLine(n){let e=n.gridSize,i=n.areaWidth*e/2,r=n.areaHeight*e/2,o=Math.PI/180*n.degree,s=-n.centerX%e,a=-n.centerY%e;s>0&&(s-=e),a>0&&(a-=e),n.offSetX&&(s<-.5?s+=e/2:s-=e/2),n.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=n.areaWidth*e,this.canvasElement.height=n.areaHeight*e;let c=this.canvasElement.getContext("2d"),f=.5*n.width*e,C=-.5*n.width*e,x=n.range*e,M=-.5*n.width*e,U=n.range*e,W=.5*n.width*e,K=0-e*Math.sqrt(2),$=f+e*Math.sqrt(2),ge=0-e*Math.sqrt(2),ye=C-e*Math.sqrt(2),lt=x+e*Math.sqrt(2),Ee=M-e*Math.sqrt(2),Be=U+e*Math.sqrt(2),ft=W+e*Math.sqrt(2),rt=0*Math.cos(o)-f*Math.sin(o),ht=0*Math.sin(o)+f*Math.cos(o),xt=0*Math.cos(o)-C*Math.sin(o),pt=0*Math.sin(o)+C*Math.cos(o),Qt=x*Math.cos(o)-M*Math.sin(o),ln=x*Math.sin(o)+M*Math.cos(o),Mn=U*Math.cos(o)-W*Math.sin(o),gt=U*Math.sin(o)+W*Math.cos(o),Wt={clip01x:K*Math.cos(o)-$*Math.sin(o),clip01y:K*Math.sin(o)+$*Math.cos(o),clip02x:ge*Math.cos(o)-ye*Math.sin(o),clip02y:ge*Math.sin(o)+ye*Math.cos(o),clip03x:lt*Math.cos(o)-Ee*Math.sin(o),clip03y:lt*Math.sin(o)+Ee*Math.cos(o),clip04x:Be*Math.cos(o)-ft*Math.sin(o),clip04y:Be*Math.sin(o)+ft*Math.cos(o)},Gt=0,St=0,yn=this.generateCalcGridPositionFunc(n.gridType,n.centerX,n.centerY,n.areaWidth,n.areaHeight);if(this.makeBrush(c,e,n.gridColor),0==n.fillType)this.makeBrush(c,e,n.gridColor),c.beginPath(),c.moveTo(rt+i,ht+r),c.lineTo(xt+i,pt+r),c.lineTo(Qt+i,ln+r),c.lineTo(Mn+i,gt+r),c.lineTo(rt+i,ht+r),c.fill();else{this.makeBrush(c,e,n.gridColor);for(let Di=0;Di<=n.areaHeight+1;Di++)for(let Li=0;Li<=n.areaWidth+1;Li++){let{gx:Ir,gy:gi}=yn(Li,Di,e);if(1==n.fillType)Gt=Ir+s+e/2-i,St=gi+a+e/2-r,this.chkOuterProduct(rt,ht,xt,pt,Gt,St)&&this.chkOuterProduct(xt,pt,Qt,ln,Gt,St)&&this.chkOuterProduct(Qt,ln,Mn,gt,Gt,St)&&this.chkOuterProduct(Mn,gt,rt,ht,Gt,St)&&this.fillSquare(c,Ir+s,gi+a,e);else{let Nt=0;for(let Vf=0;Vf<e;Vf++)for(let zr=0;zr<e;zr++)Gt=Ir+s+Vf-i+.5,St=gi+a+zr-r+.5,this.chkOuterProduct(rt,ht,xt,pt,Gt,St)&&this.chkOuterProduct(xt,pt,Qt,ln,Gt,St)&&this.chkOuterProduct(Qt,ln,Mn,gt,Gt,St)&&this.chkOuterProduct(Mn,gt,rt,ht,Gt,St)&&Nt++;(2==n.fillType&&Nt>=1||3==n.fillType&&Nt>=e*e/2||4==n.fillType&&Nt>=e*e)&&this.fillSquare(c,Ir+s,gi+a,e)}}}return this.canvasElementRange.width=n.areaWidth*e,this.canvasElementRange.height=n.areaHeight*e,c=this.canvasElementRange.getContext("2d"),this.makeBrush(c,e,n.rangeColor),c.beginPath(),c.lineWidth=2,c.moveTo(rt+i,ht+r),c.lineTo(xt+i,pt+r),c.lineTo(Qt+i,ln+r),c.lineTo(Mn+i,gt+r),c.lineTo(rt+i,ht+r),c.stroke(),c.beginPath(),c.arc(i,i,5,0,2*Math.PI,!0),c.fill(),this.canvasElementCenter.width=n.areaWidth*e,this.canvasElementCenter.height=n.areaHeight*e,c=this.canvasElementCenter.getContext("2d"),this.makeBrush(c,e,n.rangeColor),c.beginPath(),c.arc(i,i,5,0,2*Math.PI,!0),c.fill(),Wt}static gripAreaPathLine(n){let e=n.gridSize,i=Math.PI/180*n.degree,x=.5*n.width*e,U=-.5*n.width*e,W=n.range*e,K=-.5*n.width*e,$=n.range*e,ge=.5*n.width*e;return{clip01x:0*Math.cos(i)-x*Math.sin(i),clip01y:0*Math.sin(i)+x*Math.cos(i),clip02x:0*Math.cos(i)-U*Math.sin(i),clip02y:0*Math.sin(i)+U*Math.cos(i),clip03x:W*Math.cos(i)-K*Math.sin(i),clip03y:W*Math.sin(i)+K*Math.cos(i),clip04x:$*Math.cos(i)-ge*Math.sin(i),clip04y:$*Math.sin(i)+ge*Math.cos(i)}}renderSquare(n){let e=n.gridSize,i=n.areaWidth*e/2,r=n.areaHeight*e/2,s=(Math,-n.centerX%e),a=-n.centerY%e;s>0&&(s-=e),a>0&&(a-=e),n.offSetX&&(s<-.5?s+=e/2:s-=e/2),n.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=n.areaWidth*e,this.canvasElement.height=n.areaHeight*e;let c=this.canvasElement.getContext("2d"),u=-n.range*e,f=n.range*e,b=-n.range*e,C=-n.range*e,x=n.range*e,M=-n.range*e,U=n.range*e,W=n.range*e,rt={clip01x:u-1*e,clip01y:f+1*e,clip02x:b-1*e,clip02y:C-1*e,clip03x:x+1*e,clip03y:M-1*e,clip04x:U+1*e,clip04y:W+1*e},ht=0,xt=0,pt=this.generateCalcGridPositionFunc(n.gridType,n.centerX,n.centerY,n.areaWidth,n.areaHeight);if(this.makeBrush(c,e,n.gridColor),0==n.fillType)this.makeBrush(c,e,n.gridColor),c.beginPath(),c.moveTo(u+i,f+r),c.lineTo(b+i,C+r),c.lineTo(x+i,M+r),c.lineTo(U+i,W+r),c.lineTo(u+i,f+r),c.fill();else{this.makeBrush(c,e,n.gridColor);for(let Qt=0;Qt<=n.areaHeight+1;Qt++)for(let ln=0;ln<=n.areaWidth+1;ln++){let{gx:Mn,gy:gt}=pt(ln,Qt,e);if(1==n.fillType)ht=Mn+s+e/2-i,xt=gt+a+e/2-r,this.chkOuterProduct(u,f,b,C,ht,xt)&&this.chkOuterProduct(b,C,x,M,ht,xt)&&this.chkOuterProduct(x,M,U,W,ht,xt)&&this.chkOuterProduct(U,W,u,f,ht,xt)&&this.fillSquare(c,Mn+s,gt+a,e);else{let Wt=0;for(let Gt=0;Gt<e;Gt++)for(let St=0;St<e;St++)ht=Mn+s+Gt-i+.5,xt=gt+a+St-r+.5,this.chkOuterProduct(u,f,b,C,ht,xt)&&this.chkOuterProduct(b,C,x,M,ht,xt)&&this.chkOuterProduct(x,M,U,W,ht,xt)&&this.chkOuterProduct(U,W,u,f,ht,xt)&&Wt++;(2==n.fillType&&Wt>=1||3==n.fillType&&Wt>=e*e/2||4==n.fillType&&Wt>=e*e)&&this.fillSquare(c,Mn+s,gt+a,e)}}}return this.canvasElementRange.width=n.areaWidth*e,this.canvasElementRange.height=n.areaHeight*e,c=this.canvasElementRange.getContext("2d"),this.makeBrush(c,e,n.rangeColor),c.beginPath(),c.lineWidth=2,c.moveTo(u+i,f+r),c.lineTo(b+i,C+r),c.lineTo(x+i,M+r),c.lineTo(U+i,W+r),c.lineTo(u+i,f+r),c.stroke(),n.isDocking?(c.beginPath(),c.strokeRect(i-6,r-6,12,12)):(c.beginPath(),c.arc(i,i,5,0,2*Math.PI,!0),c.fill()),this.canvasElementCenter.width=n.areaWidth*e,this.canvasElementCenter.height=n.areaHeight*e,c=this.canvasElementCenter.getContext("2d"),this.makeBrush(c,e,n.rangeColor),n.isDocking?(c.beginPath(),c.strokeRect(i-6,r-6,12,12)):(c.beginPath(),c.arc(i,i,5,0,2*Math.PI,!0),c.fill()),rt}static gripAreaPathSquare(n){let e=n.gridSize;return Math,{clip01x:-n.range*e,clip01y:n.range*e,clip02x:-n.range*e,clip02y:-n.range*e,clip03x:n.range*e,clip03y:-n.range*e,clip04x:n.range*e,clip04y:n.range*e}}renderDiamond(n){let e=n.gridSize,i=n.areaWidth*e/2,r=n.areaHeight*e/2,o=-n.centerX%e,s=-n.centerY%e;o>0&&(o-=e),s>0&&(s-=e),n.offSetX&&(o<-.5?o+=e/2:o-=e/2),n.offSetY&&(s<-.5?s+=e/2:s-=e/2),this.canvasElement.width=n.areaWidth*e,this.canvasElement.height=n.areaHeight*e;let a=this.canvasElement.getContext("2d"),c=-n.range*e,b=-n.range*e,C=n.range*e,U=n.range*e,ft={clip01x:c-2*e,clip01y:0,clip02x:0,clip02y:b-2*e,clip03x:C+2*e,clip03y:0,clip04x:0,clip04y:U+2*e},rt=0,ht=0,xt=this.generateCalcGridPositionFunc(n.gridType,n.centerX,n.centerY,n.areaWidth,n.areaHeight);if(this.makeBrush(a,e,n.gridColor),0==n.fillType)this.makeBrush(a,e,n.gridColor),a.beginPath(),a.moveTo(c+i,0+r),a.lineTo(0+i,b+r),a.lineTo(C+i,0+r),a.lineTo(0+i,U+r),a.lineTo(c+i,0+r),a.fill();else{this.makeBrush(a,e,n.gridColor);for(let pt=0;pt<=n.areaHeight+1;pt++)for(let Qt=0;Qt<=n.areaWidth+1;Qt++){let{gx:ln,gy:Mn}=xt(Qt,pt,e);if(1==n.fillType)rt=ln+o+e/2-i,ht=Mn+s+e/2-r,this.chkOuterProduct(c,0,0,b,rt,ht)&&this.chkOuterProduct(0,b,C,0,rt,ht)&&this.chkOuterProduct(C,0,0,U,rt,ht)&&this.chkOuterProduct(0,U,c,0,rt,ht)&&this.fillSquare(a,ln+o,Mn+s,e);else{let gt=0;for(let Wt=0;Wt<e;Wt++)for(let Gt=0;Gt<e;Gt++)rt=ln+o+Wt-i+.5,ht=Mn+s+Gt-r+.5,this.chkOuterProduct(c,0,0,b,rt,ht)&&this.chkOuterProduct(0,b,C,0,rt,ht)&&this.chkOuterProduct(C,0,0,U,rt,ht)&&this.chkOuterProduct(0,U,c,0,rt,ht)&&gt++;(2==n.fillType&&gt>=1||3==n.fillType&&gt>=e*e/2||4==n.fillType&&gt>=e*e)&&this.fillSquare(a,ln+o,Mn+s,e)}}}return this.canvasElementRange.width=n.areaWidth*e,this.canvasElementRange.height=n.areaHeight*e,a=this.canvasElementRange.getContext("2d"),this.makeBrush(a,e,n.rangeColor),a.beginPath(),a.lineWidth=2,a.moveTo(c+i,0+r),a.lineTo(0+i,b+r),a.lineTo(C+i,0+r),a.lineTo(0+i,U+r),a.lineTo(c+i,0+r),a.stroke(),n.isDocking?(a.beginPath(),a.strokeRect(i-6,r-6,12,12)):(a.beginPath(),a.arc(i,i,5,0,2*Math.PI,!0),a.fill()),this.canvasElementCenter.width=n.areaWidth*e,this.canvasElementCenter.height=n.areaHeight*e,a=this.canvasElementCenter.getContext("2d"),this.makeBrush(a,e,n.rangeColor),n.isDocking?(a.beginPath(),a.strokeRect(i-6,r-6,12,12)):(a.beginPath(),a.arc(i,i,5,0,2*Math.PI,!0),a.fill()),ft}static gripAreaPathDiamond(n){let e=n.gridSize;return{clip01x:-n.range*e,clip01y:0,clip02x:0,clip02y:-n.range*e,clip03x:n.range*e,clip03y:0,clip04x:0,clip04y:n.range*e}}renderCorn(n){let e=n.gridSize,i=n.areaWidth*e/2,r=n.areaHeight*e/2,o=Math.PI/180*n.degree,s=-n.centerX%e,a=-n.centerY%e;s>0&&(s-=e),a>0&&(a-=e),n.offSetX&&(s<-.5?s+=e/2:s-=e/2),n.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=n.areaWidth*e,this.canvasElement.height=n.areaHeight*e;let c=this.canvasElement.getContext("2d"),b=n.range*e,C=-.5*n.width*e,x=n.range*e,M=.5*n.width*e,U=0-e*Math.sqrt(2),K=0-e*Math.sqrt(2),$=0-e*Math.sqrt(2),ge=b-e*Math.sqrt(2),ye=C-e*Math.sqrt(2),lt=b,Ee=C-e*Math.sqrt(2),Be=b+e*Math.sqrt(2),ft=C-e*Math.sqrt(2),rt=Be,ht=-ft,xt=lt,pt=-Ee,Qt=ge,ln=-ye,Mn=K,gt=-$,St=b*Math.cos(o)-C*Math.sin(o),yn=b*Math.sin(o)+C*Math.cos(o),Di=x*Math.cos(o)-M*Math.sin(o),Li=x*Math.sin(o)+M*Math.cos(o),Ir={clip01x:U*Math.cos(o)-0*Math.sin(o),clip01y:U*Math.sin(o)+0*Math.cos(o),clip02x:K*Math.cos(o)-$*Math.sin(o),clip02y:K*Math.sin(o)+$*Math.cos(o),clip03x:ge*Math.cos(o)-ye*Math.sin(o),clip03y:ge*Math.sin(o)+ye*Math.cos(o),clip04x:lt*Math.cos(o)-Ee*Math.sin(o),clip04y:lt*Math.sin(o)+Ee*Math.cos(o),clip05x:Be*Math.cos(o)-ft*Math.sin(o),clip05y:Be*Math.sin(o)+ft*Math.cos(o),clip06x:rt*Math.cos(o)-ht*Math.sin(o),clip06y:rt*Math.sin(o)+ht*Math.cos(o),clip07x:xt*Math.cos(o)-pt*Math.sin(o),clip07y:xt*Math.sin(o)+pt*Math.cos(o),clip08x:Qt*Math.cos(o)-ln*Math.sin(o),clip08y:Qt*Math.sin(o)+ln*Math.cos(o),clip09x:Mn*Math.cos(o)-gt*Math.sin(o),clip09y:Mn*Math.sin(o)+gt*Math.cos(o)},gi=0,Nt=0,Vf=this.generateCalcGridPositionFunc(n.gridType,n.centerX,n.centerY,n.areaWidth,n.areaHeight);if(0==n.fillType)this.makeBrush(c,e,n.gridColor),c.beginPath(),c.moveTo(0+i,0+r),c.lineTo(St+i,yn+r),c.lineTo(Di+i,Li+r),c.lineTo(0+i,0+r),c.fill();else{this.makeBrush(c,e,n.gridColor);for(let zr=0;zr<=n.areaHeight+1;zr++)for(let rc=0;rc<=n.areaWidth+1;rc++){let{gx:Cs,gy:ju}=Vf(rc,zr,e);if(1==n.fillType)gi=Cs+s+e/2-i,Nt=ju+a+e/2-r,this.chkOuterProduct(0,0,St,yn,gi,Nt)&&this.chkOuterProduct(St,yn,Di,Li,gi,Nt)&&this.chkOuterProduct(Di,Li,0,0,gi,Nt)&&this.fillSquare(c,Cs+s,ju+a,e);else{let ch=0;for(let FS=0;FS<e;FS++)for(let NS=0;NS<e;NS++)gi=Cs+s+FS-i+.5,Nt=ju+a+NS-r+.5,this.chkOuterProduct(0,0,St,yn,gi,Nt)&&this.chkOuterProduct(St,yn,Di,Li,gi,Nt)&&this.chkOuterProduct(Di,Li,0,0,gi,Nt)&&ch++;(2==n.fillType&&ch>=1||3==n.fillType&&ch>=e*e/2||4==n.fillType&&ch>=e*e)&&this.fillSquare(c,Cs+s,ju+a,e)}}}return this.canvasElementRange.width=n.areaWidth*e,this.canvasElementRange.height=n.areaHeight*e,c=this.canvasElementRange.getContext("2d"),this.makeBrush(c,e,n.rangeColor),c.beginPath(),c.lineWidth=2,c.moveTo(0+i,0+r),c.lineTo(St+i,yn+r),c.lineTo(Di+i,Li+r),c.lineTo(0+i,0+r),c.stroke(),c.beginPath(),c.arc(i,i,5,0,2*Math.PI,!0),c.fill(),this.canvasElementCenter.width=n.areaWidth*e,this.canvasElementCenter.height=n.areaHeight*e,c=this.canvasElementCenter.getContext("2d"),this.makeBrush(c,e,n.rangeColor),c.beginPath(),c.arc(i,i,5,0,2*Math.PI,!0),c.fill(),Ir}static gripAreaPathCorn(n){let e=n.gridSize,i=Math.PI/180*n.degree,s=n.range*e,a=-.5*n.width*e,C=s,x=a,M=s,U=a,W=s,K=a,$=W,ge=-K,ye=M,lt=-U,Ee=C,Be=-x;return{clip01x:0*Math.cos(i)-0*Math.sin(i),clip01y:0*Math.sin(i)+0*Math.cos(i),clip02x:0*Math.cos(i)-0*Math.sin(i),clip02y:0*Math.sin(i)+0*Math.cos(i),clip03x:C*Math.cos(i)-x*Math.sin(i),clip03y:C*Math.sin(i)+x*Math.cos(i),clip04x:M*Math.cos(i)-U*Math.sin(i),clip04y:M*Math.sin(i)+U*Math.cos(i),clip05x:W*Math.cos(i)-K*Math.sin(i),clip05y:W*Math.sin(i)+K*Math.cos(i),clip06x:$*Math.cos(i)-ge*Math.sin(i),clip06y:$*Math.sin(i)+ge*Math.cos(i),clip07x:ye*Math.cos(i)-lt*Math.sin(i),clip07y:ye*Math.sin(i)+lt*Math.cos(i),clip08x:Ee*Math.cos(i)-Be*Math.sin(i),clip08y:Ee*Math.sin(i)+Be*Math.cos(i),clip09x:0*Math.cos(i)- -0*Math.sin(i),clip09y:0*Math.sin(i)+-0*Math.cos(i)}}generateCalcGridPositionFunc(n,e,i,r,o){switch(n){case jc.HEX_VERTICAL:return(s,a,c)=>(s+(e%(2*c)<c?1:0)+(r%4==0?1:0))%2==1?{gx:s*c,gy:a*c}:{gx:s*c,gy:a*c+c/2};case jc.HEX_HORIZONTAL:return(s,a,c)=>(a+(i%(2*c)<c?1:0)+(o%4==0?1:0))%2==1?{gx:s*c,gy:a*c}:{gx:s*c+c/2,gy:a*c};default:return(s,a,c)=>({gx:s*c,gy:a*c})}}fillSquare(n,e,i,r){n.beginPath(),n.fillRect(e,i,r,r)}strokeSquare(n,e,i,r){n.beginPath(),n.strokeStyle="#55555533",n.strokeRect(e,i,r,r)}strokeHex(n,e,i,r,o){let s=o===jc.HEX_HORIZONTAL?-30:0,a=r/Math.sqrt(3),c=e+r/2,u=i+r/2;n.beginPath();for(let f=0;f<6;f++){s+=60;let b=Math.PI/180*s,C=Math.cos(b)*a+c,x=Math.sin(b)*a+u;n.lineTo(C,x)}n.closePath(),n.stroke()}}const Ife=["gridCanvas"],Tfe=["rangeCanvas"],Sfe=["centerPunch"],Mfe=["rotate"],Dfe=t=>({"is-grab":t}),kfe=t=>({fall:t}),Ofe=t=>({"is-magnetic":t}),ZC=t=>({"is-inverse":t}),nL=t=>({transform:t});function Afe(t,n){if(1&t&&Ge(0,"div",16),2&t){const e=v();m("ngClass",Ke(1,Ofe,e.isMagnetic))}}function Pfe(t,n){if(1&t&&(p(0,"div",17)(1,"i",18),y(2),g()()),2&t){const e=v();h(),m("ngClass",Ke(2,ZC,e.isInverse)),h(),Xe(e.isLocked?"lock":"open_with")}}function Ffe(t,n){if(1&t&&(Ue(0),p(1,"div",23)(2,"i",18),y(3),g()(),ze()),2&t){const e=n.$implicit,i=v(2);h(),je("left",i.math.ceil((e-.3)*i.gridSize),"px"),h(),m("ngClass",Ke(4,ZC,i.isInverse)),h(),Xe(i.isLocked?"lock":"autorenew")}}function Nfe(t,n){if(1&t&&(Ue(0),p(1,"div",19),q(2,Ffe,4,6,"ng-container",20),p(3,"div",21)(4,"i",18),y(5),g()(),p(6,"div",22)(7,"i",18),y(8),g()()(),ze()),2&t){const e=v();h(2),m("ngForOf",e.rotateHandlesLeftPos),h(2),m("ngClass",Ke(5,ZC,e.isInverse)),h(),Xe(e.isLocked?"lock":"autorenew"),h(2),m("ngClass",Ke(7,ZC,e.isInverse)),h(),Xe(e.isLocked?"lock":"autorenew")}}function Rfe(t,n){if(1&t&&(p(0,"div",24)(1,"div",25)(2,"span",26)(3,"i"),y(4),g()(),p(5,"span",27)(6,"i"),y(7),g()()(),p(8,"div",25)(9,"span",28),y(10),g(),p(11,"span",29),y(12),g()(),p(13,"div",30)(14,"span",26)(15,"i"),y(16),g()(),p(17,"span",27)(18,"i"),y(19),g()()()()),2&t){const e=v();je("border-left-color",e.range.rangeColor)("height",e.math.abs(e.altitude*e.gridSize)-(e.altitude>0||!e.isFollowed?0:e.followingCharactor.chatBubbleAltitude+4),"px"),m("ngStyle",Ke(40,nL,"rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),h(),je("visibility",e.altitude>0?"visible":"hidden"),h(),je("color",e.range.rangeColor)("text-shadow",e.textShadowCss),h(2),Xe(e.elevation),h(),je("color",e.range.rangeColor)("text-shadow",e.textShadowCss),h(2),Xe(e.elevation),h(2),je("color",e.range.rangeColor)("text-shadow",e.textShadowCss),h(),Xe(e.math.abs(e.altitude)),h(),je("color",e.range.rangeColor)("text-shadow",e.textShadowCss),h(),Xe(e.math.abs(e.altitude)),h(),je("visibility",e.altitude<0?"visible":"hidden"),m("ngStyle",Ke(42,nL,"translateY("+(e.isFollowed?e.followingCharactor.chatBubbleAltitude+4:0)+"px)")),h(),je("color",e.range.rangeColor)("text-shadow",e.textShadowCss),h(2),Xe(e.elevation),h(),je("color",e.range.rangeColor)("text-shadow",e.textShadowCss),h(2),Xe(e.elevation)}}let Lfe=(()=>{class t{get clipPathText(){let e="";switch(this.range.type){case"LINE":e=this.clipLine;break;case"CIRCLE":e=this.clipCircle;break;case"SQUARE":e=this.clipSquare;break;case"DIAMOND":e=this.clipDiamond;break;default:e=this.clipCorn}return e}get gripPathText(){let e="";switch(this.range.type){case"LINE":e=this.gripLine;break;case"CIRCLE":e=this.gripCircle;break;case"SQUARE":e=this.gripSquare;break;case"DIAMOND":e=this.gripDiamond;break;default:e=this.gripCorn}return e}get clipCircle(){return"circle("+(this.rangeLength+1.5)*this.gridSize+"px)"}get gripCircle(){return"circle("+(this.rangeLength>1?this.rangeLength:1)*this.gridSize+"px)"}get clipCorn(){return this.clipCornPath(this.clipAreaCorn)}get gripCorn(){return this.clipCornPath(this.gripAreaCorn)}clipCornPath(e){let i="polygon("+e.clip01x+"px "+e.clip01y+"px, ";return i+=e.clip02x+"px "+e.clip02y+"px, ",i+=e.clip03x+"px "+e.clip03y+"px, ",i+=e.clip04x+"px "+e.clip04y+"px, ",i+=e.clip05x+"px "+e.clip05y+"px, ",i+=e.clip06x+"px "+e.clip06y+"px, ",i+=e.clip07x+"px "+e.clip07y+"px, ",i+=e.clip08x+"px "+e.clip08y+"px, ",i+=e.clip09x+"px "+e.clip09y+"px)",i}get clipLine(){return this.clipLinePath(this.clipAreaLine)}get gripLine(){return this.clipLinePath(this.gripAreaLine)}clipLinePath(e){let i="polygon("+e.clip01x+"px "+e.clip01y+"px, ";return i+=e.clip02x+"px "+e.clip02y+"px, ",i+=e.clip03x+"px "+e.clip03y+"px, ",i+=e.clip04x+"px "+e.clip04y+"px)",i}get clipSquare(){return this.clipSquarePath(this.clipAreaSquare)}get gripSquare(){return this.clipSquarePath(this.gripAreaSquare)}clipSquarePath(e){let i="polygon("+e.clip01x+"px "+e.clip01y+"px, ";return i+=e.clip02x+"px "+e.clip02y+"px, ",i+=e.clip03x+"px "+e.clip03y+"px, ",i+=e.clip04x+"px "+e.clip04y+"px)",i}get clipDiamond(){return this.clipDiamondPath(this.clipAreaDiamond)}get gripDiamond(){return this.clipDiamondPath(this.gripAreaDiamond)}clipDiamondPath(e){let i="polygon("+e.clip01x+"px "+e.clip01y+"px, ";return i+=e.clip02x+"px "+e.clip02y+"px, ",i+=e.clip03x+"px "+e.clip03y+"px, ",i+=e.clip04x+"px "+e.clip04y+"px)",i}get gripLength(){return this.rangeLength>1?this.rangeLength:1}get gripWidth(){return"CIRCLE"==this.range.type||"SQUARE"==this.range.type||"DIAMOND"==this.range.type?this.gripLength:this.range.width>this.gripLength?this.range.width:this.gripLength}get tableSelecter(){return this.tabletopService.tableSelecter}get currentTable(){return this.tabletopService.currentTable}get name(){return this.range.name}get width(){return this.adjustMinBounds(this.range.width)}get length(){return this.adjustMinBounds(this.range.length)}get opacity(){return this.range.opacity}get imageFile(){return this.range.imageFile}get isLocked(){return this.range.isLocked}set isLocked(e){this.range.isLocked=e}get selectionState(){return this.selectionService.state(this.range)}get isSelected(){return this.selectionState!==$n.NONE}get isMagnetic(){return this.selectionState===$n.MAGNETIC}get areaQuadrantSize(){let e=this.width<1?1:this.width,i=this.rangeLength<1?1:this.rangeLength;return Math.ceil(Math.sqrt(e*e+i*i))+1}get rotateDeg(){let e="0.0";return this.rotate&&this.rotate.nativeElement&&this.rotate.nativeElement.style&&this.rotate.nativeElement.style.transform?(e=this.rotate.nativeElement.style.transform.replace(/[^0-9\.\-]/g,""),e||(e="0.0"),parseFloat(e)):0}get altitude(){return this.range.altitude}set altitude(e){this.range.altitude=e}get elevation(){return+((this.range.posZ+this.altitude*this.gridSize)/this.gridSize).toFixed(1)}get isAltitudeIndicate(){return this.range.isAltitudeIndicate}set isAltitudeIndicate(e){this.range.isAltitudeIndicate=e}get textShadowCss(){return`${ke.textShadowColor(this.range.rangeColor,"#f5f5f5")} 0px 0px 3px`}get followingCharactor(){return this.range.followingCharactor}set followingCharactor(e){this.range.followingCharactor=e}get isFollowed(){return this.followingCharactor&&this.followingCharactor.location.x<=this.range.location.x&&this.range.location.x<=this.followingCharactor.location.x+this.followingCharactor.size*this.gridSize&&this.followingCharactor.location.y<=this.range.location.y&&this.range.location.y<=this.followingCharactor.location.y+this.followingCharactor.size*this.gridSize&&this.followingCharactor.altitude+this.followingCharactor.posZ-.5<=this.range.altitude+this.range.posZ&&this.range.altitude+this.range.posZ<=this.followingCharactor.altitude+this.followingCharactor.posZ+.5}get dockableCharacters(){let e=this.tabletopService.characters.filter(i=>"table"===i.location.name&&!i.isHideIn&&[{x:0,y:0},{x:i.size*this.gridSize,y:0},{x:0,y:i.size*this.gridSize},{x:i.size*this.gridSize,y:i.size*this.gridSize}].some(r=>this.range.location.x-this.rangeLength*this.gridSize<=i.location.x+r.x&&i.location.x+r.x<=this.range.location.x+this.rangeLength*this.gridSize&&this.range.location.y-this.rangeLength*this.gridSize<=i.location.y+r.y&&i.location.y+r.y<=this.range.location.y+this.rangeLength*this.gridSize));return this.followingCharactor&&!e.some(i=>i===this.followingCharactor)&&e.push(this.followingCharactor),e.sort((i,r)=>i.name.localeCompare(r.name,"ja"))}get rangeLength(){let e=this.length<1?1:this.length;return this.followingCharactor&&this.range.isExpandByFollowing&&(e+=this.followingCharactor.size/2),e}get rotateHandlesLeftPos(){let e=[];for(let i=1;i<Math.ceil(this.rangeLength/6);i++)e.push(this.rangeLength*i/Math.ceil(this.rangeLength/6));return e.push(this.rangeLength),e}get isInverse(){const e=Math.abs(this.viewRotateZ+this.rotateDeg)%360;return 90<e&&e<270}constructor(e,i,r,o,s,a,c,u,f,b,C){this.ngZone=e,this.tabletopActionService=i,this.contextMenuService=r,this.elementRef=o,this.panelService=s,this.changeDetector=a,this.pointerDeviceService=c,this.coordinateService=u,this.selectionService=f,this.tabletopService=b,this.modalService=C,this.range=null,this.is3D=!1,this.clipAreaCorn={clip01x:0,clip01y:0,clip02x:100,clip02y:0,clip03x:100,clip03y:100,clip04x:0,clip04y:100,clip05x:0,clip05y:0,clip06x:0,clip06y:0,clip07x:0,clip07y:0,clip08x:0,clip08y:0,clip09x:0,clip09y:0},this.gripAreaCorn={clip01x:0,clip01y:0,clip02x:100,clip02y:0,clip03x:100,clip03y:100,clip04x:0,clip04y:100,clip05x:0,clip05y:0,clip06x:0,clip06y:0,clip07x:0,clip07y:0,clip08x:0,clip08y:0,clip09x:0,clip09y:0},this.clipAreaLine={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.gripAreaLine={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.clipAreaSquare={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.gripAreaSquare={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.clipAreaDiamond={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.gripAreaDiamond={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.gridSize=50,this.movableOption={},this.rotableOption={},this.viewRotateZ=10,this.isMoving=!1,this.math=Math,this.input=null}ngOnChanges(){ne.unregister(this),ne.register(this).on("UPDATE_GAME_OBJECT",-1e3,e=>{let i=bt.instance.get(e.data.identifier);if(!this.range||!i)return;let r=!1;(this.range===i||i instanceof xr&&this.range.contains(i))&&(this.ngZone.run(()=>{this.setRange()}),r=!0),this.followingCharactor&&(i.identifier===this.followingCharactor.identifier||i instanceof xr&&this.followingCharactor.contains(i))&&(this.ngZone.run(()=>{this.range.following(),this.setRange()}),r=!0),r&&this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.range?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",-1e3,e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.range,transformCssOffset:"translateZ(0.25px)",colideLayers:["terrain","text-note"]},this.rotableOption={tabletopObject:this.range},this.setRange()}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new Bc(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this),this.setRange(),queueMicrotask(()=>{this.changeDetector.markForCheck()})}ngOnDestroy(){this.input.destroy(),ne.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.range.toTopmost(),this.isLocked&&ne.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate(),o=[];if(this.selectionService.objects.length&&(o.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(r)}),o.push(Zt)),o.push(this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,tt.play(Te.unlock)},checkBox:"check"}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,tt.play(Te.lock)},checkBox:"check"}),o.push({name:"\u5f71\u97ff\u30b0\u30ea\u30c3\u30c9\u306e\u5224\u5b9a\u65b9\u6cd5",action:null,subActions:[{name:(0==this.range.fillType?"\u25c9":"\u25cb")+" \u5224\u5b9a\u306a\u3057 (\u8f2a\u90ed\u5185\u3092\u5857\u308a\u3064\u3076\u3059)",action:()=>{this.range.fillType=0},checkBox:"radio"},Zt,{name:(1==this.range.fillType?"\u25c9":"\u25cb")+" \u30b0\u30ea\u30c3\u30c9\u306e\u4e2d\u5fc3\u3092\u8986\u3046",action:()=>{this.range.fillType=1},checkBox:"radio"},{name:(2==this.range.fillType?"\u25c9":"\u25cb")+" \u30b0\u30ea\u30c3\u30c9\u306e\u4e00\u90e8\u3067\u3082\u8986\u3046",action:()=>{this.range.fillType=2},checkBox:"radio"},{name:(3==this.range.fillType?"\u25c9":"\u25cb")+" \u30b0\u30ea\u30c3\u30c9\u306e\u534a\u5206\u4ee5\u4e0a\u3092\u8986\u3046",action:()=>{this.range.fillType=3},checkBox:"radio"},{name:(4==this.range.fillType?"\u25c9":"\u25cb")+" \u30b0\u30ea\u30c3\u30c9\u5168\u4f53\u3092\u8986\u3046",action:()=>{this.range.fillType=4},checkBox:"radio"}]}),o.push(Zt),"CIRCLE"==this.range.type||"SQUARE"==this.range.type||"DIAMOND"==this.range.type){let s=this.dockableCharacters.length<=0?this.followingCharactor?[]:[{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c\u3044\u307e\u305b\u3093",action:null,disabled:!0,center:!0}]:this.dockableCharacters.map(a=>({name:`${this.followingCharactor&&this.followingCharactor.identifier===a.identifier?"\u25c9":"\u25cb"} ${a.name}`,action:()=>{this.followingCharactor=a,this.ngZone.run(()=>{this.range.following()}),tt.play(Te.lock)},checkBox:"radio"}));0!=s.length&&s.push(Zt),s.push({name:"\u8ffd\u5f93\u3092\u89e3\u9664\u3059\u308b",action:()=>{tt.play(Te.unlock),this.followingCharactor=null},disabled:!this.followingCharactor}),o.push({name:"\u4ed8\u8fd1\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u8ffd\u5f93",action:null,subActions:s}),o.push(this.range.isExpandByFollowing?{name:"\u2611 \u8ffd\u5f93\u6642\u30b5\u30a4\u30ba\u306b\u5408\u308f\u305b\u3066\u62e1\u5927",action:()=>{this.range.isExpandByFollowing=!1},checkBox:"check"}:{name:"\u2610 \u8ffd\u5f93\u6642\u30b5\u30a4\u30ba\u306b\u5408\u308f\u305b\u3066\u62e1\u5927",action:()=>{this.range.isExpandByFollowing=!0},checkBox:"check"}),o.push(this.range.isFollowAltitude?{name:"\u2611 \u9ad8\u3055\u30fb\u9ad8\u5ea6\u306b\u3082\u8ffd\u5f93",action:()=>{this.range.isFollowAltitude=!1},checkBox:"check"}:{name:"\u2610 \u9ad8\u3055\u30fb\u9ad8\u5ea6\u306b\u3082\u8ffd\u5f93",action:()=>{this.range.isFollowAltitude=!0,this.followingCharactor&&this.range.following()},checkBox:"check"})}else o.push(this.range.subDivisionSnapPolygonal?{name:"\u2611 \u7d30\u304b\u3044\u89d2\u5ea6\u3067\u56de\u8ee2",action:()=>{this.range.subDivisionSnapPolygonal=!1},checkBox:"check"}:{name:"\u2610 \u7d30\u304b\u3044\u89d2\u5ea6\u3067\u56de\u8ee2",action:()=>{this.range.subDivisionSnapPolygonal=!0},checkBox:"check"});o.push(Zt),o.push(this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1},checkBox:"check"}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0},checkBox:"check"}),o.push({name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,tt.play(Te.sweep))},altitudeHande:this.range}),o.push(Zt),o.push({name:"\u5c04\u7a0b\u30fb\u7bc4\u56f2\u3092\u7de8\u96c6...",action:()=>{this.showDetail(this.range)}}),this.range.getUrls().length>0&&(o.push({name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.range.getUrls().map(s=>{const a=s.value.toString();return{name:s.name?s.name:a,action:()=>{ke.sameOrigin(a)?window.open(a.trim(),"_blank","noopener"):this.modalService.open(sa,{url:a,title:this.range.name,subTitle:s.name})},disabled:!ke.validUrl(a),error:ke.validUrl(a)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:ke.validUrl(a)&&!ke.sameOrigin(a)}})}),o.push(Zt)),o.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let s=this.range.clone();s.location.x+=this.gridSize,s.location.y+=this.gridSize,s.toTopmost(),s.isLocked=!1,s.followingCharctorIdentifier=null,this.range.parent&&this.range.parent.appendChild(s),tt.play(Te.cardPut)}}),o.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.range.destroy(),tt.play(Te.sweep)}}),o.push(Zt),o.push({name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(r)}),this.contextMenuService.open(i,o,this.name)}onMove(){this.isMoving=!0,tt.play(Te.cardPick)}onMoved(){this.isMoving=!1,tt.play(Te.cardPut)}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u5c04\u7a0b\u30fb\u7bc4\u56f2\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(kl,{title:r,left:i.x-200,top:i.y-150,width:400,height:390}).tabletopObject=e}setRange(){let e=new Mb(this.gridCanvas.nativeElement,this.rangeCanvas.nativeElement,this.centerPunch.nativeElement),i={areaWidth:2*this.areaQuadrantSize,areaHeight:2*this.areaQuadrantSize,range:this.rangeLength,width:this.width<.1?.1:this.width,centerX:this.range.location.x,centerY:this.range.location.y,gridSize:this.gridSize,type:this.range.type,gridColor:this.range.gridColor,rangeColor:this.range.rangeColor,fanDegree:0,degree:this.rotateDeg,offSetX:this.range.offSetX,offSetY:this.range.offSetY,gridType:this.currentTable.gridType,isDocking:!!this.followingCharactor,fillType:this.range.fillType};switch(this.range.type){case"LINE":this.clipAreaLine=e.renderLine(i),this.gripAreaLine=Mb.gripAreaPathLine(i);break;case"CIRCLE":e.renderCircle(i);break;case"SQUARE":this.clipAreaSquare=e.renderSquare(i),this.gripAreaSquare=Mb.gripAreaPathSquare(i);break;case"DIAMOND":this.clipAreaDiamond=e.renderDiamond(i),this.gripAreaDiamond=Mb.gripAreaPathDiamond(i);break;default:this.clipAreaCorn=e.renderCorn(i),this.gripAreaCorn=Mb.gripAreaPathCorn(i)}this.gridCanvas.nativeElement.style.opacity=this.range.opacity+""}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Pn),Y(jC),Y(Bo),Y(fr),Y(yi),Y(Zr),Y(lr),Y(rh),Y(Ml),Y(Jg),Y(Ei))};static#t=this.\u0275cmp=In({type:t,selectors:[["range"]],viewQuery:function(i,r){if(1&i&&(Ln(Ife,7),Ln(Tfe,7),Ln(Sfe,7),Ln(Mfe,5)),2&i){let o;Bn(o=Un())&&(r.gridCanvas=o.first),Bn(o=Un())&&(r.rangeCanvas=o.first),Bn(o=Un())&&(r.centerPunch=o.first),Bn(o=Un())&&(r.rotate=o.first)}},hostBindings:function(i,r){1&i&&he("dragstart",function(s){return r.onDragstart(s)})("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{range:"range",is3D:"is3D"},features:[hr],decls:20,vars:49,consts:[["gridCanvas",""],["rangeCanvas",""],["rotate",""],["centerPunch",""],["appMovable","",1,"component","is-3d",2,"pointer-events","none",3,"movable.ondragstart","movable.ondragend","ngClass","movable.option","movable.disable"],[1,"is-3d",3,"ngClass"],[1,"is-3d",2,"position","absolute"],[1,"is-fill",2,"position","absolute","pointer-events","auto","top","-100%"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"is-3d",2,"position","absolute","pointer-events","none"],[1,"is-3d",2,"position","absolute","z-index","0"],[1,"is-fill","is-3d"],["appRotable","",1,"component-content","is-3d",2,"transform","rotateZ(0deg)",3,"rotable.ondragstart","rotable.ondragend","rotable.option","rotable.polygonal","rotable.disable"],["class","lock-icon is-center",4,"ngIf"],[4,"ngIf"],["class","is-3d","style","display: flex; flex-flow: column nowrap; justify-content: space-between; border-left: 2px dashed black; transform-origin: top left",3,"border-left-color","height","ngStyle",4,"ngIf"],[1,"selected-highlight",3,"ngClass"],[1,"lock-icon","is-center"],[1,"material-icons",2,"display","inline-block",3,"ngClass"],[1,"is-3d",2,"position","absolute","width","28px","pointer-events","auto"],[4,"ngFor","ngForOf"],[1,"rotate-grab","of-corn-bottom","rotate-grab-icon","is-3d","will-change"],[1,"rotate-grab","of-corn-top","rotate-grab-icon","is-3d","will-change"],[1,"rotate-grab","of-corn-tip","rotate-grab-icon","is-3d","will-change",2,"position","absolute"],[1,"is-3d",2,"display","flex","flex-flow","column nowrap","justify-content","space-between","border-left","2px dashed black","transform-origin","top left",3,"ngStyle"],[1,"is-3d"],[1,"elevation-indicator","is-3d",2,"position","absolute"],[1,"elevation-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"is-3d",3,"ngStyle"]],template:function(i,r){if(1&i){const o=Le();p(0,"div",4),he("movable.ondragstart",function(){return V(o),H(r.onMove())})("movable.ondragend",function(){return V(o),H(r.onMoved())}),p(1,"div",5)(2,"div",6)(3,"div",7),q(4,Afe,1,3,"div",8),g()(),p(5,"div",9)(6,"div",10),Ge(7,"canvas",11,0),g(),p(9,"div",6),Ge(10,"canvas",11,1),g(),p(12,"div",12,2),he("rotable.ondragstart",function(){return V(o),H(r.onMove())})("rotable.ondragend",function(){return V(o),H(r.onMoved())}),q(14,Pfe,3,4,"div",13)(15,Nfe,9,9,"ng-container",14),g()()(),q(16,Rfe,20,44,"div",15),p(17,"div",10),Ge(18,"canvas",11,3),g()()}2&i&&(m("ngClass",Ke(45,Dfe,!r.isLocked))("movable.option",r.movableOption)("movable.disable",r.isLocked),h(),je("transform","translateZ("+r.altitude*r.gridSize+"px)"),m("ngClass",Ke(47,kfe,0==r.altitude)),h(),je("clip-path",r.gripPathText),h(),je("left",1.5*-r.gripLength*r.gridSize,"px")("width",3*r.gripLength*r.gridSize,"px")("height",3*r.gripWidth*r.gridSize,"px"),h(),m("ngIf",r.isSelected),h(),je("width",0,"px")("height",0,"px")("clip-path",r.clipPathText),h(),je("top",0,"px")("left",-1*r.areaQuadrantSize*r.gridSize,"px"),h(3),je("z-index",r.isMoving?5:0)("top",0,"px")("left",-1*r.areaQuadrantSize*r.gridSize,"px"),h(3),je("opacity",r.isMoving?.7:1),m("rotable.option",r.rotableOption)("rotable.polygonal",r.range.subDivisionSnapPolygonal?360:24)("rotable.disable",r.isLocked||"CIRCLE"==r.range.type||"SQUARE"==r.range.type||"DIAMOND"==r.range.type),h(2),m("ngIf","CIRCLE"==r.range.type||"SQUARE"==r.range.type||"DIAMOND"==r.range.type),h(),m("ngIf","CIRCLE"!=r.range.type&&"SQUARE"!=r.range.type&&"DIAMOND"!=r.range.type),h(),m("ngIf",r.isAltitudeIndicate&&(r.altitude<=-.5||.5<=r.altitude)),h(),je("visibility",0!=r.altitude?"visible":"hidden")("top",0,"px")("left",-1*r.areaQuadrantSize*r.gridSize,"px"))},dependencies:[Ni,nr,ri,Lo,is,Hf],styles:[".is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.image[_ngcontent-%COMP%]{display:block}.lock-icon[_ngcontent-%COMP%]{background-color:#ccc;border-radius:100%;color:#444;width:25px;height:25px;visibility:hidden}.component[_ngcontent-%COMP%]:hover   .lock-icon[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .lock-icon[_ngcontent-%COMP%]{visibility:visible}.is-center[_ngcontent-%COMP%]{position:absolute;top:-12.5px;left:-12.5px;margin:auto}.border[_ngcontent-%COMP%]{box-sizing:border-box;border:solid 2px #CCCCCC}.is-fit-full[_ngcontent-%COMP%]{height:100%;width:100%}.pedestal-grab-corn[_ngcontent-%COMP%]{z-index:-1;position:absolute;inset:-14px 14px -14px -14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;position:absolute;inset:-14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:1}.rotate-grab[_ngcontent-%COMP%]{opacity:0;z-index:-1}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:30px;height:30px;box-sizing:border-box;border:solid 2px #CCCCCC;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:0;background-color:#ccc;border-radius:100%;color:#444;font-size:24px;transform-style:preserve-3d;transform:translateZ(.1px)}.will-change[_ngcontent-%COMP%]{will-change:opacity}.of-corn-top[_ngcontent-%COMP%]{top:-30px;left:-15px;border-radius:15px 15px 0 0}.of-corn-bottom[_ngcontent-%COMP%]{bottom:-30px;left:-15px;border-radius:0 0 15px 15px}.of-corn-tip[_ngcontent-%COMP%]{top:-15px;left:-15px;border-radius:15px}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px;border-radius:14px 7px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px;border-radius:7px 14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px;border-radius:14px 7px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px;border-radius:7px 14px}.is-fill[_ngcontent-%COMP%]{display:block;position:absolute;inset:0;margin:auto}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.fall[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.altitude-indicator[_ngcontent-%COMP%]{font-size:10px}.elevation-indicator[_ngcontent-%COMP%], .altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;color:#000;text-shadow:whitesmoke 0px 0px 3px;backface-visibility:hidden}.elevation-indicator[_ngcontent-%COMP%]{font-weight:bolder;font-size:12px}.selected-highlight[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;height:100%;width:100%;background-color:#80d4ff99}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.is-inverse[_ngcontent-%COMP%]{transform:rotate(180deg)}"],changeDetection:0})}return t})();const Bfe=["root"],Ufe=["gameTable"],zfe=["gameObjects"],Hfe=["gridCanvas"],Vfe=["pickArea"],jfe=["pickCursor"],Gfe=(t,n,e)=>[t,n,e],Wfe=t=>({"is-grabbing":t}),$fe=(t,n)=>({transform:t,clip:n}),qC=(t,n)=>({"z-index":t,transform:n});function Yfe(t,n){if(1&t&&(Ue(0),Ge(1,"terrain",24),ze()),2&t){const e=v(),i=e.$implicit,r=e.index;h(),je("z-index",r+(i.height>0?0:1e4)),m("terrain",i)("appTooltip",i)}}function Zfe(t,n){if(1&t&&(Ue(0),Ge(1,"terrain",25),ze()),2&t){const e=v(),i=e.$implicit,r=e.index;h(),je("z-index",r+(i.height>0?0:1e4)),m("terrain",i)}}function qfe(t,n){if(1&t&&(Ue(0),q(1,Yfe,2,4,"ng-container",23)(2,Zfe,2,3,"ng-container",23),ze()),2&t){const e=n.$implicit;h(),m("ngIf",e.detailDataElement&&0<e.detailDataElement.children.length),h(),m("ngIf",!e.detailDataElement||e.detailDataElement.children.length<=0)}}function Xfe(t,n){if(1&t&&(Ue(0),Ge(1,"game-table-mask",26),ze()),2&t){const e=v(),i=e.$implicit,r=e.index;h(),m("gameTableMask",i)("appTooltip",i)("ngStyle",Tn(3,qC,r,"translateZ("+1e-4*r+"px)"))}}function Kfe(t,n){if(1&t&&(Ue(0),Ge(1,"game-table-mask",27),ze()),2&t){const e=v(),i=e.$implicit,r=e.index;h(),m("gameTableMask",i)("ngStyle",Tn(2,qC,r,"translateZ("+1e-4*r+"px)"))}}function Qfe(t,n){if(1&t&&(Ue(0),q(1,Xfe,2,6,"ng-container",23)(2,Kfe,2,5,"ng-container",23),ze()),2&t){const e=n.$implicit;h(),m("ngIf",e.detailDataElement&&0<e.detailDataElement.children.length),h(),m("ngIf",!e.detailDataElement||e.detailDataElement.children.length<=0)}}function Jfe(t,n){if(1&t&&Ge(0,"text-note",30),2&t){const e=v().$implicit;je("z-index",e.zindex),m("textNote",e)("appTooltip",e)}}function epe(t,n){if(1&t&&Ge(0,"text-note",31),2&t){const e=v().$implicit;je("z-index",e.zindex),m("textNote",e)}}function tpe(t,n){if(1&t&&(Ue(0),q(1,Jfe,1,4,"text-note",28)(2,epe,1,3,"text-note",29),ze()),2&t){const e=n.$implicit;h(),m("ngIf",null!=e.text&&""!=e.text.trim()),h(),m("ngIf",null==e.text||""===e.text.trim())}}function npe(t,n){if(1&t&&Ge(0,"card-stack",32),2&t){const e=n.$implicit;m("cardStack",e)("appTooltip",e)("ngStyle",Tn(3,qC,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function ipe(t,n){if(1&t&&Ge(0,"card",33),2&t){const e=n.$implicit;m("card",e)("appTooltip",e)("ngStyle",Tn(3,qC,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function rpe(t,n){if(1&t&&Ge(0,"range",34),2&t){const e=n.$implicit;je("z-index",e.zindex),m("range",e)("appTooltip",e)}}function ope(t,n){if(1&t&&Ge(0,"dice-symbol",35),2&t){const e=n.$implicit;m("diceSymbol",e)("appTooltip",e)}}function spe(t,n){if(1&t&&(Ue(0),Ge(1,"game-character",36),ze()),2&t){const e=v().$implicit;h(),je("display",e.isLoaded?"":"none"),m("gameCharacter",e)("appTooltip",e)}}function ape(t,n){if(1&t&&(Ue(0),q(1,spe,2,4,"ng-container",23),ze()),2&t){const e=n.$implicit,i=v();h(),m("ngIf",e&&(e.isVisible||i.isGMMode))}}function lpe(t,n){if(1&t&&Ge(0,"peer-cursor",37),2&t){const e=n.$implicit,i=v();je("display",i.isCursorHidIn(e)&&!i.isGMMode?"none":""),m("cursor",e)}}let cpe=(()=>{class t{get tableSelecter(){return this.tabletopService.tableSelecter}get currentTable(){return this.tabletopService.currentTable}get gridHeight(){return this.tabletopService.currentTable.gridHeight}get tableImage(){return this.imageService.getSkeletonOr(this.currentTable.imageIdentifier)}get backgroundImage(){return this.imageService.getEmptyOr(this.currentTable.backgroundImageIdentifier)}get backgroundImage2(){return this.imageService.getEmptyOr(this.currentTable.backgroundImageIdentifier2)}get backgroundFilterType(){return this.currentTable.backgroundFilterType}get isPointerDragging(){return this.pointerDeviceService.isDragging}get characters(){return this.tabletopService.characters}get tableMasks(){return this.tabletopService.tableMasks}get cards(){return this.tabletopService.cards}get cardStacks(){return this.tabletopService.cardStacks}get ranges(){return this.tabletopService.ranges}get terrains(){return this.tabletopService.terrains}get textNotes(){return this.tabletopService.textNotes}get diceSymbols(){return this.tabletopService.diceSymbols}get peerCursors(){return this.tabletopService.peerCursors}get isStealthMode(){return gn.isStealthMode}get isGMMode(){return Fe.myCursor&&Fe.myCursor.isGMMode}get clipCss(){const e=this.currentTable.gridClipRect;return e?`rect(${e.top}px, ${e.right}px, ${e.bottom}px, ${e.left}px)`:"auto"}get tableImageUrls(){let e="",i="",r="";const o=this.currentTable?.identifier!=this._currentTable?.identifier;return this._currentTable=this.currentTable,(o||this._currentTableImage?.identifier!=this.tableImage.identifier||this._currentTableImageState!=this.tableImage.state)&&(this._currentTableImage=this.tableImage,this.tableImage.state===Ri.THUMBNAIL||this.tableImage.state===Ri.COMPLETE?(this._currentTableImageState=this.tableImage.state,this._currentTableImageUrl&&(e=this._currentTableImageUrl),this._currentTableImageUrl=URL.createObjectURL(this.tableImage.blob)):this._currentTableImageUrl=this.tableImage.url),(o||this._currentBackgroundImage?.identifier!=this.backgroundImage.identifier||this._currentBackgroundImageState!=this.backgroundImage.state)&&(this._currentBackgroundImage=this.backgroundImage,this.backgroundImage.state===Ri.THUMBNAIL||this.backgroundImage.state===Ri.COMPLETE?(this._currentBackgroundImageState=this.backgroundImage.state,this._currentBackgroundImageUrl&&(i=this._currentBackgroundImageUrl),this.isBackgroundImageLoaded=!1,this._currentBackgroundImageUrl=URL.createObjectURL(this.backgroundImage.blob)):this._currentBackgroundImageUrl=this.backgroundImage.url),(o||this._currentBackgroundImage2?.identifier!=this.backgroundImage2.identifier||this._currentBackgroundImageState2!=this.backgroundImage2.state)&&(this._currentBackgroundImage2=this.backgroundImage2,this.backgroundImage2.state===Ri.THUMBNAIL||this.backgroundImage2.state===Ri.COMPLETE?(this._currentBackgroundImageState2=this.backgroundImage2.state,this._currentBackgroundImageUrl2&&(r=this._currentBackgroundImageUrl2),this.isBackgroundImageLoaded2=!1,this._currentBackgroundImageUrl2=URL.createObjectURL(this.backgroundImage2.blob)):this._currentBackgroundImageUrl2=this.backgroundImage2.url),(e||i||r)&&queueMicrotask(()=>{e&&URL.revokeObjectURL(e),i&&URL.revokeObjectURL(i),r&&URL.revokeObjectURL(r)}),[this._currentTableImageUrl,this._currentBackgroundImageUrl,this._currentBackgroundImageUrl2]}get tableImageUrl(){return this.tableImageUrls[0]}get backgroundImageUrl(){return this.tableImageUrls[1]}get backgroundImageUrl2(){return this.tableImageUrls[2]}get backgroundImageCss(){if(this._currentBackgroundImageCss&&(this.backgroundImageUrl&&!this.isBackgroundImageLoaded||this.backgroundImageUrl2&&!this.isBackgroundImageLoaded2))return this._currentBackgroundImageCss;let e=[];return this.backgroundImageUrl&&e.push(`url(${this.backgroundImageUrl})`),this.backgroundImageUrl2&&(!this.backgroundImageUrl||this.backgroundImageUrl&&this.isBackgroundImageLoaded)&&e.push(`url(${this.backgroundImageUrl2})`),this._currentBackgroundImageCss=e.join(","),this._currentBackgroundImageCss}constructor(e,i,r,o,s,a,c,u,f){this.ngZone=e,this.contextMenuService=i,this.pointerDeviceService=r,this.coordinateService=o,this.imageService=s,this.tabletopService=a,this.tabletopActionService=c,this.selectionService=u,this.modalService=f,this.isTableTransformMode=!1,this.isTableTransformed=!1,this.viewPotisonX=100,this.viewPotisonY=0,this.viewPotisonZ=0,this.viewRotateX=50,this.viewRotateY=0,this.viewRotateZ=10,this.mouseGesture=null,this.touchGesture=null,this.pickGesture=null,this._currentTableImageUrl="",this._currentTableImageState=0,this._currentBackgroundImageUrl="",this._currentBackgroundImageState=0,this._currentBackgroundImageUrl2="",this._currentBackgroundImageState2=0,this.isBackgroundImageLoaded=!1,this.isBackgroundImageLoaded2=!1,this._currentBackgroundImageCss=""}ngOnInit(){ne.register(this).on("UPDATE_GAME_OBJECT",e=>{e.data.identifier!==this.currentTable.identifier&&e.data.identifier!==this.tableSelecter.identifier||(console.log("UPDATE_GAME_OBJECT GameTableComponent "+this.currentTable.identifier),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor,this.currentTable.isShowNumber))}).on("DRAG_LOCKED_OBJECT",e=>{this.isTableTransformMode=!0,this.pointerDeviceService.isDragging=!1,this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}).on("RESET_POINT_OF_VIEW",e=>{this.isTableTransformMode=!1,this.pointerDeviceService.isDragging=!1,this.setTransform(this.viewPotisonX,this.viewPotisonY,this.viewPotisonZ,this._rightRotate(this.viewRotateX),this._rightRotate(this.viewRotateY,!0),this._rightRotate(this.viewRotateZ),!0),setTimeout(()=>{this.gridCanvas.nativeElement.style.opacity="0.0",this.gameTable.nativeElement.style.transition="0.1s ease-out",setTimeout(()=>{this.gameTable.nativeElement.style.transition=null},100),e&&"top"==e.data?this.setTransform(0,0,0,0,0,0,!0):this.setTransform(100,0,0,50,0,10,!0)},50),this.removeFocus()}).on("FOCUS_TABLETOP_OBJECT",e=>{setTimeout(()=>{this.gameTable.nativeElement.style.transition="0.1s ease-out",setTimeout(()=>{this.gameTable.nativeElement.style.transition=null},100);let o=e.data.x-this.gridCanvas.nativeElement.clientWidth/2,s=e.data.y-this.gridCanvas.nativeElement.clientHeight/2,a=e.data.z,c=this.viewRotateZ/180*Math.PI,u=o*Math.cos(c)-s*Math.sin(c),f=o*Math.sin(c)+s*Math.cos(c),b=this.viewRotateX/180*Math.PI,C=f*Math.cos(b),x=f*Math.sin(b)+a;this.setTransform(100-u-this.viewPotisonX,-C-this.viewPotisonY,-x-this.viewPotisonZ,0,0,0)},50)}),this.tabletopActionService.makeDefaultTable(),this.tabletopActionService.makeDefaultTabletopObjects()}_rightRotate(e,i=!1){let r=e%360;return i||(r>180?r-=360:r<-180&&(r+=360)),r}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.initializeTableTouchGesture(),this.initializeTableMouseGesture(),this.initializeTablePickGesture()}),this.cancelInput(),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor),this.setTransform(0,0,0,0,0,0),this.coordinateService.tabletopOriginElement=this.gameObjects.nativeElement}ngOnDestroy(){ne.unregister(this),this.mouseGesture.destroy(),this.touchGesture.destroy(),this.pickGesture.destroy(),this._currentTableImageUrl&&URL.revokeObjectURL(this._currentTableImageUrl),this._currentBackgroundImageUrl&&URL.revokeObjectURL(this._currentBackgroundImageUrl),this._currentBackgroundImageUrl2&&URL.revokeObjectURL(this._currentBackgroundImageUrl2)}initializeTableTouchGesture(){this.touchGesture=new nce(this.rootElementRef.nativeElement,this.ngZone),this.touchGesture.onstart=this.onTableTouchStart.bind(this),this.touchGesture.onend=this.onTableTouchEnd.bind(this),this.touchGesture.ongesture=this.onTableTouchGesture.bind(this),this.touchGesture.ontransform=this.onTableTouchTransform.bind(this)}initializeTableMouseGesture(){this.mouseGesture=new Qle(this.rootElementRef.nativeElement),this.mouseGesture.onstart=this.onTableMouseStart.bind(this),this.mouseGesture.onend=this.onTableMouseEnd.bind(this),this.mouseGesture.ontransform=this.onTableMouseTransform.bind(this)}initializeTablePickGesture(){this.pickGesture=new Jle(this.rootElementRef.nativeElement,this.gameObjects.nativeElement,this.pickCursor.nativeElement,this.pickArea.nativeElement,this.pointerDeviceService,this.selectionService),this.pickGesture.onstart=this.onTablePickStart.bind(this),this.pickGesture.onend=this.onTablePickEnd.bind(this),this.pickGesture.oncancelifneeded=this.onTablePickCancelIfNeeded.bind(this),this.pickGesture.onpick=this.onTablePick.bind(this)}onTableTouchStart(){this.mouseGesture.cancel()}onTableTouchEnd(){this.cancelInput()}onTableTouchGesture(){this.cancelInput()}onTableTouchTransform(e,i,r,o,s,a,c,u){if(!this.isTableTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),u.cancelable&&u.preventDefault();let f=(1e3+Math.abs(this.viewPotisonZ))/1e3;80<o+this.viewRotateX&&(o+=80-(o+this.viewRotateX)),o+this.viewRotateX<0&&(o+=0-(o+this.viewRotateX)),750<r+this.viewPotisonZ&&(r+=750-(r+this.viewPotisonZ)),this.setTransform(e*=f,i*=f,r,o,s,a),this.isTableTransformed=!0}onTableMouseStart(e){e.target.contains(this.gameObjects.nativeElement)||1===e.button||2===e.button?this.isTableTransformMode=!0:(this.isTableTransformMode=!1,this.pointerDeviceService.isDragging=!0,this.gridCanvas.nativeElement.style.opacity="1"),document.activeElement.contains(e.target)||(this.removeSelectionRanges(),this.removeFocus())}onTableMouseEnd(e){this.cancelInput()}onTableMouseTransform(e,i,r,o,s,a,c,u){if(!this.isTableTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),u.cancelable&&u.preventDefault();let f=(1e3+Math.abs(this.viewPotisonZ))/1e3;this.setTransform(e*=f,i*=f,r,o,s,a),this.isTableTransformed=!0}onTablePickStart(){this.isTableTransformMode=!1,tt.playLocal(Te.selectionStart),this.pickGesture.isMagneticMode||(this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+"")}onTablePickEnd(){this.pickGesture.isKeepSelection||requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.contextMenuService.isShow||this.selectionService.clear()})})}onTablePickCancelIfNeeded(){return this.isTableTransformMode}onTablePick(){!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close())}cancelInput(){this.mouseGesture.cancel(),this.isTableTransformMode=!0,this.pointerDeviceService.isDragging=!1,this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}onContextMenu(e){if(!document.activeElement.contains(this.gameObjects.nativeElement)||(e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate(),o=[];0<this.selectionService.size&&(o.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>{this.selectionService.congregate(r)},disabled:0<this.selectionService.size}),o.push(Zt)),Array.prototype.push.apply(o,this.tabletopActionService.makeDefaultContextMenuActions(r)),o.push(Zt),o.push({name:"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a...",action:()=>{this.modalService.open(g4)}}),this.contextMenuService.open(i,o,this.currentTable.name)}onDocumentMouseDown(e){this.isTableTransformed=!1}onDocumentTouchStart(e){this.isTableTransformed=!1}onDocumentContextMenu(e){this.isTableTransformed&&!this.pointerDeviceService.isAllowedToOpenContextMenu&&e.preventDefault()}setTransform(e,i,r,o,s,a,c=!1){c?(this.viewRotateX=o,this.viewRotateY=s,this.viewRotateZ=a,this.viewPotisonX=e,this.viewPotisonY=i,this.viewPotisonZ=r):(this.viewRotateX+=o,this.viewRotateY+=s,this.viewRotateZ+=a,this.viewPotisonX+=e,this.viewPotisonY+=i,this.viewPotisonZ+=r),(c||0!=o||0!=s||0!=o)&&this.ngZone.run(()=>{ne.trigger("TABLE_VIEW_ROTATE",{x:this.viewRotateX,y:this.viewRotateY,z:this.viewRotateZ})}),this.gameTable.nativeElement.style.transform=`translateZ(${this.viewPotisonZ.toFixed(4)}px) translateY(${this.viewPotisonY.toFixed(4)}px) translateX(${this.viewPotisonX.toFixed(4)}px) rotateY(${this.viewRotateY.toFixed(4)}deg) rotateX(${this.viewRotateX.toFixed(4)+"deg) rotateZ("+this.viewRotateZ.toFixed(4)}deg)`}setGameTableGrid(e,i,r=50,o=jc.SQUARE,s="#000000e6",a=!0){this.gameTable.nativeElement.style.width=e*r+"px",this.gameTable.nativeElement.style.height=i*r+"px",new Kle(this.gridCanvas.nativeElement).render(e,i,r,o,s,a),this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}removeSelectionRanges(){let e=window.getSelection();e.isCollapsed||e.removeAllRanges()}removeFocus(){document.activeElement instanceof HTMLElement&&document.activeElement.blur()}trackByGameObject(e,i){return i.identifier}isCursorHidIn(e){if(e.isGMMode)return!0;for(let i of this.characters)if(i.isHideIn&&"table"===i.location.name&&i.owner===e.userId)return!0;return!1}static#e=this.\u0275fac=function(i){return new(i||t)(Y(Pn),Y(Bo),Y(lr),Y(rh),Y(tm),Y(Jg),Y(jC),Y(Ml),Y(Ei))};static#t=this.\u0275cmp=In({type:t,selectors:[["game-table"]],viewQuery:function(i,r){if(1&i&&(Ln(Bfe,7),Ln(Ufe,7),Ln(zfe,7),Ln(Hfe,7),Ln(Vfe,7),Ln(jfe,7)),2&i){let o;Bn(o=Un())&&(r.rootElementRef=o.first),Bn(o=Un())&&(r.gameTable=o.first),Bn(o=Un())&&(r.gameObjects=o.first),Bn(o=Un())&&(r.gridCanvas=o.first),Bn(o=Un())&&(r.pickArea=o.first),Bn(o=Un())&&(r.pickCursor=o.first)}},hostBindings:function(i,r){1&i&&he("contextmenu",function(s){return r.onContextMenu(s)})("mousedown",function(s){return r.onDocumentMouseDown(s)},!1,Yh)("touchstart",function(s){return r.onDocumentTouchStart(s)},!1,Yh)("contextmenu",function(s){return r.onDocumentContextMenu(s)},!1,Yh)},decls:32,vars:48,consts:[["root",""],["gameTable",""],["gameObjects",""],["gridCanvas",""],["pickArea",""],["pickCursor",""],[2,"visibility","hidden","pointer-events","none","position","absolute",3,"load","src"],[1,"background-image","is-pointer-events-none",3,"ngClass"],[1,"component","is-fill","is-perspective",3,"ngClass"],[1,"component-content","is-fill","is-3d"],["id","app-game-table",1,"game-table","table-image","is-3d"],[1,"grid-canvas","is-fill","is-pointer-events-none",3,"ngStyle"],[1,"is-fill","is-3d","is-pointer-events-none"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"cardStack","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"card","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"range","z-index","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"diceSymbol","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"cursor","display",4,"ngFor","ngForOf","ngForTrackBy"],[1,"pick-area"],[1,"pick-cursor"],["xmlns","http://www.w3.org/2000/svg","width","100","height","100","viewBox","0 0 100 100"],["cx","50","cy","50","r","15"],[4,"ngIf"],[1,"is-3d",3,"terrain","appTooltip"],[1,"is-3d",3,"terrain"],[1,"is-3d",3,"gameTableMask","appTooltip","ngStyle"],[1,"is-3d",3,"gameTableMask","ngStyle"],["class","is-3d",3,"textNote","appTooltip","z-index",4,"ngIf"],["class","is-3d",3,"textNote","z-index",4,"ngIf"],[1,"is-3d",3,"textNote","appTooltip"],[1,"is-3d",3,"textNote"],[1,"is-3d",3,"cardStack","appTooltip","ngStyle"],[1,"is-3d",3,"card","appTooltip","ngStyle"],[1,"is-3d",3,"range","appTooltip"],[1,"is-3d",3,"diceSymbol","appTooltip"],[1,"is-3d",3,"gameCharacter","appTooltip"],[1,"is-3d",3,"cursor"]],template:function(i,r){if(1&i){const o=Le();p(0,"img",6),Ut(1,"safe"),he("load",function(){return V(o),H(r.isBackgroundImageLoaded=!0)}),g(),p(2,"img",6),Ut(3,"safe"),he("load",function(){return V(o),H(r.isBackgroundImageLoaded2=!0)}),g(),Ge(4,"div",7),Ut(5,"safe"),p(6,"div",8,0)(8,"div",9,1)(10,"div",10,2),Ut(12,"safe"),Ge(13,"canvas",11,3),p(15,"div",12),q(16,qfe,3,2,"ng-container",13),g(),p(17,"div",12),q(18,Qfe,3,2,"ng-container",13),g(),q(19,tpe,3,2,"ng-container",13)(20,npe,1,6,"card-stack",14)(21,ipe,1,6,"card",15)(22,rpe,1,4,"range",16)(23,ope,1,2,"dice-symbol",17)(24,ape,2,1,"ng-container",13)(25,lpe,1,3,"peer-cursor",18),g()()(),Ge(26,"div",19,4),p(28,"div",20,5),mc(),p(30,"svg",21),Ge(31,"circle",22),g()()}2&i&&(m("src",zt(1,27,r.backgroundImageUrl,"resourceUrl"),bn),h(2),m("src",zt(3,30,r.backgroundImageUrl2,"resourceUrl"),bn),h(2),je("background-image",zt(5,33,r.backgroundImageCss,"style")),m("ngClass",Qs(39,Gfe,r.backgroundFilterType?"is-filter":"",r.isStealthMode&&!r.isGMMode?"is-hide-in":"",r.backgroundFilterType)),h(2),m("ngClass",Ke(43,Wfe,r.isPointerDragging)),h(4),je("background-image",zt(12,36,"url("+r.tableImageUrl+")","style")),h(3),m("ngStyle",Tn(45,$fe,"translateZ("+(r.gridHeight+.1)+"px)",r.clipCss)),h(3),m("ngForOf",r.terrains)("ngForTrackBy",r.trackByGameObject),h(2),m("ngForOf",r.tableMasks)("ngForTrackBy",r.trackByGameObject),h(),m("ngForOf",r.textNotes)("ngForTrackBy",r.trackByGameObject),h(),m("ngForOf",r.cardStacks)("ngForTrackBy",r.trackByGameObject),h(),m("ngForOf",r.cards)("ngForTrackBy",r.trackByGameObject),h(),m("ngForOf",r.ranges)("ngForTrackBy",r.trackByGameObject),h(),m("ngForOf",r.diceSymbols)("ngForTrackBy",r.trackByGameObject),h(),m("ngForOf",r.characters)("ngForTrackBy",r.trackByGameObject),h(),m("ngForOf",r.peerCursors)("ngForTrackBy",r.trackByGameObject))},dependencies:[Ni,nr,ri,Lo,pce,Cde,Vde,phe,Bhe,ic,rfe,Efe,W5,Lfe,cr],styles:['[_nghost-%COMP%]{display:block}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-perspective[_ngcontent-%COMP%]{perspective:1000px}.is-fill[_ngcontent-%COMP%]{display:block;position:absolute;inset:0;margin:auto}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d;backface-visibility:hidden;position:absolute}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.component[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;touch-action:none;height:100%;width:100%;overflow:hidden}.component-content[_ngcontent-%COMP%]{height:2000px;width:2000px}.grid-canvas[_ngcontent-%COMP%]{opacity:0;transform:translateZ(.15px);transition:.1s ease-out;backface-visibility:hidden}.game-table[_ngcontent-%COMP%]{height:100%;width:100%}.table-image[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;height:100%;width:100%;background-repeat:no-repeat;background-size:100% 100%}.background-image[_ngcontent-%COMP%]{position:absolute;inset:0;margin:-5px;background-repeat:no-repeat;background-position:center;background-size:cover;transition:filter .2s ease-in-out}.background-image.is-filter[_ngcontent-%COMP%]{will-change:filter}.background-image.is-filter.white[_ngcontent-%COMP%], .background-image.is-filter.black[_ngcontent-%COMP%]{filter:blur(5px)}.background-image.is-filter[_ngcontent-%COMP%]:after{display:block;content:"";width:100%;height:100%}.background-image.is-filter.white[_ngcontent-%COMP%]:after{background-color:#f7f7f7;filter:opacity(.2)}.background-image.is-filter.black[_ngcontent-%COMP%]:after{background-color:#1a1a1a;filter:opacity(.3)}.background-image.is-filter.is-hide-in.white[_ngcontent-%COMP%]:after{background-color:#1a1a1a;filter:opacity(.3)}.background-image.is-filter.is-hide-in.black[_ngcontent-%COMP%]:after{background-color:#f7f7f7;filter:opacity(.2)}.background-image.is-filter.is-hide-in[_ngcontent-%COMP%]{filter:invert(85%) blur(5px);-webkit-backdrop-filter:invert(85%);backdrop-filter:invert(85%)}.background-image.is-hide-in[_ngcontent-%COMP%]{filter:invert(85%);-webkit-backdrop-filter:invert(85%);backdrop-filter:invert(85%);background-color:#ffcc80}.pick-area[_ngcontent-%COMP%]{position:absolute;display:none;background-color:#00a8ff1a;border:1px solid hsl(200,100%,50%);pointer-events:none}.pick-cursor[_ngcontent-%COMP%]{position:absolute;display:none;scale:1;transition:scale .2s ease-out;stroke:#0af;pointer-events:none}.pick-cursor[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{transform:rotate(-90deg)}.pick-cursor[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%]{fill:#e5f6ffb3;stroke:inherit;stroke-width:4;animation-name:_ngcontent-%COMP%_circle-animation,_ngcontent-%COMP%_circle-fill;animation-timing-function:linear,ease-out;animation-duration:.85s,.85s}@keyframes _ngcontent-%COMP%_circle-animation{0%{stroke-dasharray:0 94.3}55%{stroke-dasharray:0 94.3}99.9%,to{stroke-dasharray:94.3 94.3}}@keyframes _ngcontent-%COMP%_circle-fill{0%{opacity:0}45%{opacity:0}99.9%,to{opacity:1}}']})}return t})(),upe=(()=>{class t{constructor(e){this.elementRef=e,this.timer=null,this.needRepeat=!1}ngAfterViewInit(){let e=()=>{this.needRepeat?(this.timer=setTimeout(e,650),this.needRepeat=!1):(this.timer=null,this.elementRef.nativeElement.style.display="none")};ne.register(this).on("*",i=>{this.needRepeat||jt.bandwidthUsage<3072||(null===this.timer?(this.elementRef.nativeElement.style.display="block",this.timer=setTimeout(e,650)):this.needRepeat=!0)})}ngOnDestroy(){ne.unregister(this)}static#e=this.\u0275fac=function(i){return new(i||t)(Y(fr))};static#t=this.\u0275cmp=In({type:t,selectors:[["network-indicator"]],decls:12,vars:0,consts:[[1,"sk-cube-grid"],[1,"sk-cube","sk-cube1"],[1,"sk-cube","sk-cube2"],[1,"sk-cube","sk-cube3"],[1,"sk-cube","sk-cube4"],[1,"sk-cube","sk-cube5"],[1,"sk-cube","sk-cube6"],[1,"sk-cube","sk-cube7"],[1,"sk-cube","sk-cube8"],[1,"sk-cube","sk-cube9"],[1,"sk-title"]],template:function(i,r){1&i&&(p(0,"div",0),Ge(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9),p(10,"div",10),y(11,"sync"),g()())},styles:["[_nghost-%COMP%]{display:block}.sk-cube-grid[_ngcontent-%COMP%]{font-size:8px;color:#444;height:100%;width:100%;background-color:#f7f7f799}.sk-cube[_ngcontent-%COMP%]{background-color:#555}.sk-title[_ngcontent-%COMP%]{padding:2px 0;background-color:#f7f7f799}"]})}return t})();let hpe=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=ga({type:t}),t.\u0275inj=ha({}),t})(),fpe=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=ga({type:t,bootstrap:[$c]});static#n=this.\u0275inj=ha({providers:[ES,vo,Bo,Ei,lS,yi,lr,Jg,Bs],imports:[qA,w$,TA,DG,hpe,Bq,_oe.register("ngsw-worker.js",{enabled:true})]})}return t})();wg($c,function(){return[Ni,ri,cpe,y5,upe]},function(){return[cr]}),wg(Qg,function(){return[nr,ri,ff,na,ia,kr,Yd,Or,hf,Cr,Mu,j0,la]},[]),wg(Bf,function(){return[Ni,nr,ri,ff,kr,Yd,Or,hf,Cr,Mu,j0,Xle,la]},[]),wg(Qg,function(){return[nr,ri,ff,na,ia,kr,Yd,Or,hf,Cr,Mu,j0,la]},[]),wg(pb,function(){return[nr,ri,kr,yl,Cl,Ea,Or,ku,Du,Cr,f4]},[]),HV().bootstrapModule(fpe).catch(t=>console.error(t))},7385:Kt=>{"use strict";Kt.exports=function X(me){if(me.length>=255)throw new TypeError("Alphabet too long");for(var L=new Uint8Array(256),w=0;w<L.length;w++)L[w]=255;for(var B=0;B<me.length;B++){var T=me.charAt(B),S=T.charCodeAt(0);if(255!==L[S])throw new TypeError(T+" is ambiguous");L[S]=B}var P=me.length,O=me.charAt(0),j=Math.log(P)/Math.log(256),A=Math.log(256)/Math.log(P);function D(z){if("string"!=typeof z)throw new TypeError("Expected String");if(0===z.length)return new Uint8Array;for(var N=0,Q=0,de=0;z[N]===O;)Q++,N++;for(var we=(z.length-N)*j+1>>>0,J=new Uint8Array(we);z[N];){var ae=L[z.charCodeAt(N)];if(255===ae)return;for(var te=0,ce=we-1;(0!==ae||te<de)&&-1!==ce;ce--,te++)J[ce]=(ae+=P*J[ce]>>>0)%256>>>0,ae=ae/256>>>0;if(0!==ae)throw new Error("Non-zero carry");de=te,N++}for(var _e=we-de;_e!==we&&0===J[_e];)_e++;for(var ue=new Uint8Array(Q+(we-_e)),Qe=Q;_e!==we;)ue[Qe++]=J[_e++];return ue}return{encode:function E(z){if(z instanceof Uint8Array||(ArrayBuffer.isView(z)?z=new Uint8Array(z.buffer,z.byteOffset,z.byteLength):Array.isArray(z)&&(z=Uint8Array.from(z))),!(z instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===z.length)return"";for(var N=0,Q=0,de=0,we=z.length;de!==we&&0===z[de];)de++,N++;for(var J=(we-de)*A+1>>>0,ae=new Uint8Array(J);de!==we;){for(var te=z[de],ce=0,_e=J-1;(0!==te||ce<Q)&&-1!==_e;_e--,ce++)ae[_e]=(te+=256*ae[_e]>>>0)%P>>>0,te=te/P>>>0;if(0!==te)throw new Error("Non-zero carry");Q=ce,de++}for(var ue=J-Q;ue!==J&&0===ae[ue];)ue++;for(var Qe=O.repeat(N);ue<J;++ue)Qe+=me.charAt(ae[ue]);return Qe},decodeUnsafe:D,decode:function k(z){var N=D(z);if(N)return N;throw new Error("Non-base"+P+" character")}}}},7656:function(Kt,X,me){var L;Kt.exports=(L=L||function(w,B){var T;if(typeof window<"u"&&window.crypto&&(T=window.crypto),typeof self<"u"&&self.crypto&&(T=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(T=globalThis.crypto),!T&&typeof window<"u"&&window.msCrypto&&(T=window.msCrypto),!T&&typeof global<"u"&&global.crypto&&(T=global.crypto),!T)try{T=me(477)}catch{}var S=function(){if(T){if("function"==typeof T.getRandomValues)try{return T.getRandomValues(new Uint32Array(1))[0]}catch{}if("function"==typeof T.randomBytes)try{return T.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},P=Object.create||function(){function J(){}return function(ae){var te;return J.prototype=ae,te=new J,J.prototype=null,te}}(),O={},j=O.lib={},A=j.Base=function(){return{extend:function(J){var ae=P(this);return J&&ae.mixIn(J),(!ae.hasOwnProperty("init")||this.init===ae.init)&&(ae.init=function(){ae.$super.init.apply(this,arguments)}),ae.init.prototype=ae,ae.$super=this,ae},create:function(){var J=this.extend();return J.init.apply(J,arguments),J},init:function(){},mixIn:function(J){for(var ae in J)J.hasOwnProperty(ae)&&(this[ae]=J[ae]);J.hasOwnProperty("toString")&&(this.toString=J.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),E=j.WordArray=A.extend({init:function(J,ae){J=this.words=J||[],this.sigBytes=null!=ae?ae:4*J.length},toString:function(J){return(J||k).stringify(this)},concat:function(J){var ae=this.words,te=J.words,ce=this.sigBytes,_e=J.sigBytes;if(this.clamp(),ce%4)for(var ue=0;ue<_e;ue++)ae[ce+ue>>>2]|=(te[ue>>>2]>>>24-ue%4*8&255)<<24-(ce+ue)%4*8;else for(var pe=0;pe<_e;pe+=4)ae[ce+pe>>>2]=te[pe>>>2];return this.sigBytes+=_e,this},clamp:function(){var J=this.words,ae=this.sigBytes;J[ae>>>2]&=4294967295<<32-ae%4*8,J.length=w.ceil(ae/4)},clone:function(){var J=A.clone.call(this);return J.words=this.words.slice(0),J},random:function(J){for(var ae=[],te=0;te<J;te+=4)ae.push(S());return new E.init(ae,J)}}),D=O.enc={},k=D.Hex={stringify:function(J){for(var ae=J.words,te=J.sigBytes,ce=[],_e=0;_e<te;_e++){var ue=ae[_e>>>2]>>>24-_e%4*8&255;ce.push((ue>>>4).toString(16)),ce.push((15&ue).toString(16))}return ce.join("")},parse:function(J){for(var ae=J.length,te=[],ce=0;ce<ae;ce+=2)te[ce>>>3]|=parseInt(J.substr(ce,2),16)<<24-ce%8*4;return new E.init(te,ae/2)}},z=D.Latin1={stringify:function(J){for(var ae=J.words,te=J.sigBytes,ce=[],_e=0;_e<te;_e++)ce.push(String.fromCharCode(ae[_e>>>2]>>>24-_e%4*8&255));return ce.join("")},parse:function(J){for(var ae=J.length,te=[],ce=0;ce<ae;ce++)te[ce>>>2]|=(255&J.charCodeAt(ce))<<24-ce%4*8;return new E.init(te,ae)}},N=D.Utf8={stringify:function(J){try{return decodeURIComponent(escape(z.stringify(J)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(J){return z.parse(unescape(encodeURIComponent(J)))}},Q=j.BufferedBlockAlgorithm=A.extend({reset:function(){this._data=new E.init,this._nDataBytes=0},_append:function(J){"string"==typeof J&&(J=N.parse(J)),this._data.concat(J),this._nDataBytes+=J.sigBytes},_process:function(J){var ae,te=this._data,ce=te.words,_e=te.sigBytes,ue=this.blockSize,pe=_e/(4*ue),Se=(pe=J?w.ceil(pe):w.max((0|pe)-this._minBufferSize,0))*ue,R=w.min(4*Se,_e);if(Se){for(var Ye=0;Ye<Se;Ye+=ue)this._doProcessBlock(ce,Ye);ae=ce.splice(0,Se),te.sigBytes-=R}return new E.init(ae,R)},clone:function(){var J=A.clone.call(this);return J._data=this._data.clone(),J},_minBufferSize:0}),we=(j.Hasher=Q.extend({cfg:A.extend(),init:function(J){this.cfg=this.cfg.extend(J),this.reset()},reset:function(){Q.reset.call(this),this._doReset()},update:function(J){return this._append(J),this._process(),this},finalize:function(J){return J&&this._append(J),this._doFinalize()},blockSize:16,_createHelper:function(J){return function(ae,te){return new J.init(te).finalize(ae)}},_createHmacHelper:function(J){return function(ae,te){return new we.HMAC.init(J,te).finalize(ae)}}}),O.algo={});return O}(Math),L)},8823:function(Kt,X,me){var L;Kt.exports=(L=me(7656),function(){if("function"==typeof ArrayBuffer){var T=L.lib.WordArray,S=T.init,P=T.init=function(O){if(O instanceof ArrayBuffer&&(O=new Uint8Array(O)),(O instanceof Int8Array||typeof Uint8ClampedArray<"u"&&O instanceof Uint8ClampedArray||O instanceof Int16Array||O instanceof Uint16Array||O instanceof Int32Array||O instanceof Uint32Array||O instanceof Float32Array||O instanceof Float64Array)&&(O=new Uint8Array(O.buffer,O.byteOffset,O.byteLength)),O instanceof Uint8Array){for(var j=O.byteLength,A=[],E=0;E<j;E++)A[E>>>2]|=O[E]<<24-E%4*8;S.call(this,A,j)}else S.apply(this,arguments)};P.prototype=T}}(),L.lib.WordArray)},5168:function(Kt,X,me){var L;Kt.exports=(L=me(7656),function(w){var B=L,T=B.lib,S=T.WordArray,P=T.Hasher,O=B.algo,j=[],A=[];!function(){function k(de){for(var we=w.sqrt(de),J=2;J<=we;J++)if(!(de%J))return!1;return!0}function z(de){return 4294967296*(de-(0|de))|0}for(var N=2,Q=0;Q<64;)k(N)&&(Q<8&&(j[Q]=z(w.pow(N,.5))),A[Q]=z(w.pow(N,1/3)),Q++),N++}();var E=[],D=O.SHA256=P.extend({_doReset:function(){this._hash=new S.init(j.slice(0))},_doProcessBlock:function(k,z){for(var N=this._hash.words,Q=N[0],de=N[1],we=N[2],J=N[3],ae=N[4],te=N[5],ce=N[6],_e=N[7],ue=0;ue<64;ue++){if(ue<16)E[ue]=0|k[z+ue];else{var Qe=E[ue-15],Se=E[ue-2];E[ue]=((Qe<<25|Qe>>>7)^(Qe<<14|Qe>>>18)^Qe>>>3)+E[ue-7]+((Se<<15|Se>>>17)^(Se<<13|Se>>>19)^Se>>>10)+E[ue-16]}var Bt=Q&de^Q&we^de&we,ot=_e+((ae<<26|ae>>>6)^(ae<<21|ae>>>11)^(ae<<7|ae>>>25))+(ae&te^~ae&ce)+A[ue]+E[ue];_e=ce,ce=te,te=ae,ae=J+ot|0,J=we,we=de,de=Q,Q=ot+(((Q<<30|Q>>>2)^(Q<<19|Q>>>13)^(Q<<10|Q>>>22))+Bt)|0}N[0]=N[0]+Q|0,N[1]=N[1]+de|0,N[2]=N[2]+we|0,N[3]=N[3]+J|0,N[4]=N[4]+ae|0,N[5]=N[5]+te|0,N[6]=N[6]+ce|0,N[7]=N[7]+_e|0},_doFinalize:function(){var k=this._data,z=k.words,N=8*this._nDataBytes,Q=8*k.sigBytes;return z[Q>>>5]|=128<<24-Q%32,z[14+(Q+64>>>9<<4)]=w.floor(N/4294967296),z[15+(Q+64>>>9<<4)]=N,k.sigBytes=4*z.length,this._process(),this._hash},clone:function(){var k=P.clone.call(this);return k._hash=this._hash.clone(),k}});B.SHA256=P._createHelper(D),B.HmacSHA256=P._createHmacHelper(D)}(Math),L.SHA256)},8004:Kt=>{!function(me){Kt.exports=me;var L="listeners",w={on:function T(A,E){return j(this,A).push(E),this},once:function S(A,E){var D=this;return k.originalListener=E,j(D,A).push(k),D;function k(){P.call(D,A,k),E.apply(this,arguments)}},off:P,emit:function O(A,E){var D=this,k=j(D,A,!0);if(!k)return!1;var z=arguments.length;if(1===z)k.forEach(function Q(J){J.call(D)});else if(2===z)k.forEach(function de(J){J.call(D,E)});else{var N=Array.prototype.slice.call(arguments,1);k.forEach(function we(J){J.apply(D,N)})}return!!k.length}};function B(A){for(var E in w)A[E]=w[E];return A}function P(A,E){var k,D=this;if(arguments.length){if(E){if(k=j(D,A,!0)){if(!(k=k.filter(function z(N){return N!==E&&N.originalListener!==E})).length)return P.call(D,A);D[L][A]=k}}else if((k=D[L])&&(delete k[A],!Object.keys(k).length))return P.call(D)}else delete D[L];return D}function j(A,E,D){if(!D||A[L]){var k=A[L]||(A[L]={});return k[E]||(k[E]=[])}}B(me.prototype),me.mixin=B}(function X(){if(!(this instanceof X))return new X})},4356:Kt=>{"use strict";var L,X="object"==typeof Reflect?Reflect:null,me=X&&"function"==typeof X.apply?X.apply:function(te,ce,_e){return Function.prototype.apply.call(te,ce,_e)};L=X&&"function"==typeof X.ownKeys?X.ownKeys:Object.getOwnPropertySymbols?function(te){return Object.getOwnPropertyNames(te).concat(Object.getOwnPropertySymbols(te))}:function(te){return Object.getOwnPropertyNames(te)};var B=Number.isNaN||function(te){return te!=te};function T(){T.init.call(this)}Kt.exports=T,Kt.exports.once=function de(ae,te){return new Promise(function(ce,_e){function ue(pe){ae.removeListener(te,Qe),_e(pe)}function Qe(){"function"==typeof ae.removeListener&&ae.removeListener("error",ue),ce([].slice.call(arguments))}J(ae,te,Qe,{once:!0}),"error"!==te&&function we(ae,te,ce){"function"==typeof ae.on&&J(ae,"error",te,ce)}(ae,ue,{once:!0})})},T.EventEmitter=T,T.prototype._events=void 0,T.prototype._eventsCount=0,T.prototype._maxListeners=void 0;var S=10;function P(ae){if("function"!=typeof ae)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof ae)}function O(ae){return void 0===ae._maxListeners?T.defaultMaxListeners:ae._maxListeners}function j(ae,te,ce,_e){var ue,Qe,pe;if(P(ce),void 0===(Qe=ae._events)?(Qe=ae._events=Object.create(null),ae._eventsCount=0):(void 0!==Qe.newListener&&(ae.emit("newListener",te,ce.listener?ce.listener:ce),Qe=ae._events),pe=Qe[te]),void 0===pe)pe=Qe[te]=ce,++ae._eventsCount;else if("function"==typeof pe?pe=Qe[te]=_e?[ce,pe]:[pe,ce]:_e?pe.unshift(ce):pe.push(ce),(ue=O(ae))>0&&pe.length>ue&&!pe.warned){pe.warned=!0;var Se=new Error("Possible EventEmitter memory leak detected. "+pe.length+" "+String(te)+" listeners added. Use emitter.setMaxListeners() to increase limit");Se.name="MaxListenersExceededWarning",Se.emitter=ae,Se.type=te,Se.count=pe.length,function w(ae){console&&console.warn&&console.warn(ae)}(Se)}return ae}function A(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function E(ae,te,ce){var _e={fired:!1,wrapFn:void 0,target:ae,type:te,listener:ce},ue=A.bind(_e);return ue.listener=ce,_e.wrapFn=ue,ue}function D(ae,te,ce){var _e=ae._events;if(void 0===_e)return[];var ue=_e[te];return void 0===ue?[]:"function"==typeof ue?ce?[ue.listener||ue]:[ue]:ce?function Q(ae){for(var te=new Array(ae.length),ce=0;ce<te.length;++ce)te[ce]=ae[ce].listener||ae[ce];return te}(ue):z(ue,ue.length)}function k(ae){var te=this._events;if(void 0!==te){var ce=te[ae];if("function"==typeof ce)return 1;if(void 0!==ce)return ce.length}return 0}function z(ae,te){for(var ce=new Array(te),_e=0;_e<te;++_e)ce[_e]=ae[_e];return ce}function J(ae,te,ce,_e){if("function"==typeof ae.on)_e.once?ae.once(te,ce):ae.on(te,ce);else{if("function"!=typeof ae.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof ae);ae.addEventListener(te,function ue(Qe){_e.once&&ae.removeEventListener(te,ue),ce(Qe)})}}Object.defineProperty(T,"defaultMaxListeners",{enumerable:!0,get:function(){return S},set:function(ae){if("number"!=typeof ae||ae<0||B(ae))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+ae+".");S=ae}}),T.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},T.prototype.setMaxListeners=function(te){if("number"!=typeof te||te<0||B(te))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+te+".");return this._maxListeners=te,this},T.prototype.getMaxListeners=function(){return O(this)},T.prototype.emit=function(te){for(var ce=[],_e=1;_e<arguments.length;_e++)ce.push(arguments[_e]);var ue="error"===te,Qe=this._events;if(void 0!==Qe)ue=ue&&void 0===Qe.error;else if(!ue)return!1;if(ue){var pe;if(ce.length>0&&(pe=ce[0]),pe instanceof Error)throw pe;var Se=new Error("Unhandled error."+(pe?" ("+pe.message+")":""));throw Se.context=pe,Se}var R=Qe[te];if(void 0===R)return!1;if("function"==typeof R)me(R,this,ce);else{var Ye=R.length,Bt=z(R,Ye);for(_e=0;_e<Ye;++_e)me(Bt[_e],this,ce)}return!0},T.prototype.on=T.prototype.addListener=function(te,ce){return j(this,te,ce,!1)},T.prototype.prependListener=function(te,ce){return j(this,te,ce,!0)},T.prototype.once=function(te,ce){return P(ce),this.on(te,E(this,te,ce)),this},T.prototype.prependOnceListener=function(te,ce){return P(ce),this.prependListener(te,E(this,te,ce)),this},T.prototype.off=T.prototype.removeListener=function(te,ce){var _e,ue,Qe,pe,Se;if(P(ce),void 0===(ue=this._events))return this;if(void 0===(_e=ue[te]))return this;if(_e===ce||_e.listener===ce)0==--this._eventsCount?this._events=Object.create(null):(delete ue[te],ue.removeListener&&this.emit("removeListener",te,_e.listener||ce));else if("function"!=typeof _e){for(Qe=-1,pe=_e.length-1;pe>=0;pe--)if(_e[pe]===ce||_e[pe].listener===ce){Se=_e[pe].listener,Qe=pe;break}if(Qe<0)return this;0===Qe?_e.shift():function N(ae,te){for(;te+1<ae.length;te++)ae[te]=ae[te+1];ae.pop()}(_e,Qe),1===_e.length&&(ue[te]=_e[0]),void 0!==ue.removeListener&&this.emit("removeListener",te,Se||ce)}return this},T.prototype.removeAllListeners=function(te){var ce,_e,ue;if(void 0===(_e=this._events))return this;if(void 0===_e.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==_e[te]&&(0==--this._eventsCount?this._events=Object.create(null):delete _e[te]),this;if(0===arguments.length){var pe,Qe=Object.keys(_e);for(ue=0;ue<Qe.length;++ue)"removeListener"!==(pe=Qe[ue])&&this.removeAllListeners(pe);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(ce=_e[te]))this.removeListener(te,ce);else if(void 0!==ce)for(ue=ce.length-1;ue>=0;ue--)this.removeListener(te,ce[ue]);return this},T.prototype.listeners=function(te){return D(this,te,!0)},T.prototype.rawListeners=function(te){return D(this,te,!1)},T.listenerCount=function(ae,te){return"function"==typeof ae.listenerCount?ae.listenerCount(te):k.call(ae,te)},T.prototype.listenerCount=k,T.prototype.eventNames=function(){return this._eventsCount>0?L(this._events):[]}},2578:function(Kt,X){var me,w;void 0!==(w="function"==typeof(me=function(){"use strict";function T(E,D,k){var z=new XMLHttpRequest;z.open("GET",E),z.responseType="blob",z.onload=function(){A(z.response,D,k)},z.onerror=function(){console.error("could not download file")},z.send()}function S(E){var D=new XMLHttpRequest;D.open("HEAD",E,!1);try{D.send()}catch{}return 200<=D.status&&299>=D.status}function P(E){try{E.dispatchEvent(new MouseEvent("click"))}catch{var D=document.createEvent("MouseEvents");D.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),E.dispatchEvent(D)}}var O="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,j=O.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),A=O.saveAs||("object"!=typeof window||window!==O?function(){}:"download"in HTMLAnchorElement.prototype&&!j?function(E,D,k){var z=O.URL||O.webkitURL,N=document.createElement("a");N.download=D=D||E.name||"download",N.rel="noopener","string"==typeof E?(N.href=E,N.origin===location.origin?P(N):S(N.href)?T(E,D,k):P(N,N.target="_blank")):(N.href=z.createObjectURL(E),setTimeout(function(){z.revokeObjectURL(N.href)},4e4),setTimeout(function(){P(N)},0))}:"msSaveOrOpenBlob"in navigator?function(E,D,k){if(D=D||E.name||"download","string"!=typeof E)navigator.msSaveOrOpenBlob(function B(E,D){return typeof D>"u"?D={autoBom:!1}:"object"!=typeof D&&(console.warn("Deprecated: Expected third argument to be a object"),D={autoBom:!D}),D.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(E.type)?new Blob(["\ufeff",E],{type:E.type}):E}(E,k),D);else if(S(E))T(E,D,k);else{var z=document.createElement("a");z.href=E,z.target="_blank",setTimeout(function(){P(z)})}}:function(E,D,k,z){if((z=z||open("","_blank"))&&(z.document.title=z.document.body.innerText="downloading..."),"string"==typeof E)return T(E,D,k);var N="application/octet-stream"===E.type,Q=/constructor/i.test(O.HTMLElement)||O.safari,de=/CriOS\/[\d]+/.test(navigator.userAgent);if((de||N&&Q||j)&&typeof FileReader<"u"){var we=new FileReader;we.onloadend=function(){var te=we.result;te=de?te:te.replace(/^data:[^;]*;/,"data:attachment/file;"),z?z.location.href=te:location=te,z=null},we.readAsDataURL(E)}else{var J=O.URL||O.webkitURL,ae=J.createObjectURL(E);z?z.location=ae:location.href=ae,z=null,setTimeout(function(){J.revokeObjectURL(ae)},4e4)}});O.saveAs=A.saveAs=A,Kt.exports=A})?me.apply(X,[]):me)&&(Kt.exports=w)},4511:(Kt,X,me)=>{var L;!function(w,B,T,S){"use strict";var de,P=["","webkit","Moz","MS","ms","o"],O=B.createElement("div"),j="function",A=Math.round,E=Math.abs,D=Date.now;function k(Z,oe,ve){return setTimeout(te(Z,ve),oe)}function z(Z,oe,ve){return!!Array.isArray(Z)&&(N(Z,ve[oe],ve),!0)}function N(Z,oe,ve){var De;if(Z)if(Z.forEach)Z.forEach(oe,ve);else if(Z.length!==S)for(De=0;De<Z.length;)oe.call(ve,Z[De],De,Z),De++;else for(De in Z)Z.hasOwnProperty(De)&&oe.call(ve,Z[De],De,Z)}function Q(Z,oe,ve){var De="DEPRECATED METHOD: "+oe+"\n"+ve+" AT \n";return function(){var Ft=new Error("get-stack-trace"),sn=Ft&&Ft.stack?Ft.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Yn=w.console&&(w.console.warn||w.console.log);return Yn&&Yn.call(w.console,De,sn),Z.apply(this,arguments)}}de="function"!=typeof Object.assign?function(oe){if(oe===S||null===oe)throw new TypeError("Cannot convert undefined or null to object");for(var ve=Object(oe),De=1;De<arguments.length;De++){var Ft=arguments[De];if(Ft!==S&&null!==Ft)for(var sn in Ft)Ft.hasOwnProperty(sn)&&(ve[sn]=Ft[sn])}return ve}:Object.assign;var we=Q(function(oe,ve,De){for(var Ft=Object.keys(ve),sn=0;sn<Ft.length;)(!De||De&&oe[Ft[sn]]===S)&&(oe[Ft[sn]]=ve[Ft[sn]]),sn++;return oe},"extend","Use `assign`."),J=Q(function(oe,ve){return we(oe,ve,!0)},"merge","Use `assign`.");function ae(Z,oe,ve){var Ft,De=oe.prototype;(Ft=Z.prototype=Object.create(De)).constructor=Z,Ft._super=De,ve&&de(Ft,ve)}function te(Z,oe){return function(){return Z.apply(oe,arguments)}}function ce(Z,oe){return typeof Z==j?Z.apply(oe&&oe[0]||S,oe):Z}function _e(Z,oe){return Z===S?oe:Z}function ue(Z,oe,ve){N(R(oe),function(De){Z.addEventListener(De,ve,!1)})}function Qe(Z,oe,ve){N(R(oe),function(De){Z.removeEventListener(De,ve,!1)})}function pe(Z,oe){for(;Z;){if(Z==oe)return!0;Z=Z.parentNode}return!1}function Se(Z,oe){return Z.indexOf(oe)>-1}function R(Z){return Z.trim().split(/\s+/g)}function Ye(Z,oe,ve){if(Z.indexOf&&!ve)return Z.indexOf(oe);for(var De=0;De<Z.length;){if(ve&&Z[De][ve]==oe||!ve&&Z[De]===oe)return De;De++}return-1}function Bt(Z){return Array.prototype.slice.call(Z,0)}function Ve(Z,oe,ve){for(var De=[],Ft=[],sn=0;sn<Z.length;){var Yn=oe?Z[sn][oe]:Z[sn];Ye(Ft,Yn)<0&&De.push(Z[sn]),Ft[sn]=Yn,sn++}return ve&&(De=oe?De.sort(function(Vr,nn){return Vr[oe]>nn[oe]}):De.sort()),De}function Ot(Z,oe){for(var ve,De,Ft=oe[0].toUpperCase()+oe.slice(1),sn=0;sn<P.length;){if((De=(ve=P[sn])?ve+Ft:oe)in Z)return De;sn++}return S}var ot=1;function Ze(Z){var oe=Z.ownerDocument||Z;return oe.defaultView||oe.parentWindow||w}var tn="ontouchstart"in w,Rt=Ot(w,"PointerEvent")!==S,qt=tn&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),mi="touch",At="mouse",Cn=25,fn=1,Dn=4,F=8,Ae=1,Re=2,fe=4,se=8,Ie=16,dt=Re|fe,vt=se|Ie,qe=dt|vt,Mt=["x","y"],Ht=["clientX","clientY"];function Dt(Z,oe){var ve=this;this.manager=Z,this.callback=oe,this.element=Z.element,this.target=Z.options.inputTarget,this.domHandler=function(De){ce(Z.options.enable,[Z])&&ve.handler(De)},this.init()}function Ii(Z,oe,ve){var De=ve.pointers.length,Ft=ve.changedPointers.length,sn=oe&fn&&De-Ft==0,Yn=oe&(Dn|F)&&De-Ft==0;ve.isFirst=!!sn,ve.isFinal=!!Yn,sn&&(Z.session={}),ve.eventType=oe,function jn(Z,oe){var ve=Z.session,De=oe.pointers,Ft=De.length;ve.firstInput||(ve.firstInput=ji(oe)),Ft>1&&!ve.firstMultiple?ve.firstMultiple=ji(oe):1===Ft&&(ve.firstMultiple=!1);var sn=ve.firstInput,Yn=ve.firstMultiple,Hr=Yn?Yn.center:sn.center,Vr=oe.center=Co(De);oe.timeStamp=D(),oe.deltaTime=oe.timeStamp-sn.timeStamp,oe.angle=Nr(Hr,Vr),oe.distance=rs(Hr,Vr),function io(Z,oe){var ve=oe.center,De=Z.offsetDelta||{},Ft=Z.prevDelta||{},sn=Z.prevInput||{};(oe.eventType===fn||sn.eventType===Dn)&&(Ft=Z.prevDelta={x:sn.deltaX||0,y:sn.deltaY||0},De=Z.offsetDelta={x:ve.x,y:ve.y}),oe.deltaX=Ft.x+(ve.x-De.x),oe.deltaY=Ft.y+(ve.y-De.y)}(ve,oe),oe.offsetDirection=jo(oe.deltaX,oe.deltaY);var nn=Pi(oe.deltaTime,oe.deltaX,oe.deltaY);oe.overallVelocityX=nn.x,oe.overallVelocityY=nn.y,oe.overallVelocity=E(nn.x)>E(nn.y)?nn.x:nn.y,oe.scale=Yn?function Da(Z,oe){return rs(oe[0],oe[1],Ht)/rs(Z[0],Z[1],Ht)}(Yn.pointers,De):1,oe.rotation=Yn?function ca(Z,oe){return Nr(oe[1],oe[0],Ht)+Nr(Z[1],Z[0],Ht)}(Yn.pointers,De):0,oe.maxPointers=ve.prevInput?oe.pointers.length>ve.prevInput.maxPointers?oe.pointers.length:ve.prevInput.maxPointers:oe.pointers.length,function yo(Z,oe){var Ft,sn,Yn,Hr,ve=Z.lastInterval||oe,De=oe.timeStamp-ve.timeStamp;if(oe.eventType!=F&&(De>Cn||ve.velocity===S)){var Vr=oe.deltaX-ve.deltaX,nn=oe.deltaY-ve.deltaY,Ss=Pi(De,Vr,nn);sn=Ss.x,Yn=Ss.y,Ft=E(Ss.x)>E(Ss.y)?Ss.x:Ss.y,Hr=jo(Vr,nn),Z.lastInterval=oe}else Ft=ve.velocity,sn=ve.velocityX,Yn=ve.velocityY,Hr=ve.direction;oe.velocity=Ft,oe.velocityX=sn,oe.velocityY=Yn,oe.direction=Hr}(ve,oe);var Ss=Z.element;pe(oe.srcEvent.target,Ss)&&(Ss=oe.srcEvent.target),oe.target=Ss}(Z,ve),Z.emit("hammer.input",ve),Z.recognize(ve),Z.session.prevInput=ve}function ji(Z){for(var oe=[],ve=0;ve<Z.pointers.length;)oe[ve]={clientX:A(Z.pointers[ve].clientX),clientY:A(Z.pointers[ve].clientY)},ve++;return{timeStamp:D(),pointers:oe,center:Co(oe),deltaX:Z.deltaX,deltaY:Z.deltaY}}function Co(Z){var oe=Z.length;if(1===oe)return{x:A(Z[0].clientX),y:A(Z[0].clientY)};for(var ve=0,De=0,Ft=0;Ft<oe;)ve+=Z[Ft].clientX,De+=Z[Ft].clientY,Ft++;return{x:A(ve/oe),y:A(De/oe)}}function Pi(Z,oe,ve){return{x:oe/Z||0,y:ve/Z||0}}function jo(Z,oe){return Z===oe?Ae:E(Z)>=E(oe)?Z<0?Re:fe:oe<0?se:Ie}function rs(Z,oe,ve){ve||(ve=Mt);var De=oe[ve[0]]-Z[ve[0]],Ft=oe[ve[1]]-Z[ve[1]];return Math.sqrt(De*De+Ft*Ft)}function Nr(Z,oe,ve){return ve||(ve=Mt),180*Math.atan2(oe[ve[1]]-Z[ve[1]],oe[ve[0]]-Z[ve[0]])/Math.PI}Dt.prototype={handler:function(){},init:function(){this.evEl&&ue(this.element,this.evEl,this.domHandler),this.evTarget&&ue(this.target,this.evTarget,this.domHandler),this.evWin&&ue(Ze(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&Qe(this.element,this.evEl,this.domHandler),this.evTarget&&Qe(this.target,this.evTarget,this.domHandler),this.evWin&&Qe(Ze(this.element),this.evWin,this.domHandler)}};var ua={mousedown:fn,mousemove:2,mouseup:Dn},ka="mousedown",Oa="mousemove mouseup";function xs(){this.evEl=ka,this.evWin=Oa,this.pressed=!1,Dt.apply(this,arguments)}ae(xs,Dt,{handler:function(oe){var ve=ua[oe.type];ve&fn&&0===oe.button&&(this.pressed=!0),2&ve&&1!==oe.which&&(ve=Dn),this.pressed&&(ve&Dn&&(this.pressed=!1),this.callback(this.manager,ve,{pointers:[oe],changedPointers:[oe],pointerType:At,srcEvent:oe}))}});var ro={pointerdown:fn,pointermove:2,pointerup:Dn,pointercancel:F,pointerout:F},oc={2:mi,3:"pen",4:At,5:"kinect"},Gu="pointerdown",sc="pointermove pointerup pointercancel";function qi(){this.evEl=Gu,this.evWin=sc,Dt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}w.MSPointerEvent&&!w.PointerEvent&&(Gu="MSPointerDown",sc="MSPointerMove MSPointerUp MSPointerCancel"),ae(qi,Dt,{handler:function(oe){var ve=this.store,De=!1,Ft=oe.type.toLowerCase().replace("ms",""),sn=ro[Ft],Yn=oc[oe.pointerType]||oe.pointerType,Hr=Yn==mi,Vr=Ye(ve,oe.pointerId,"pointerId");sn&fn&&(0===oe.button||Hr)?Vr<0&&(ve.push(oe),Vr=ve.length-1):sn&(Dn|F)&&(De=!0),!(Vr<0)&&(ve[Vr]=oe,this.callback(this.manager,sn,{pointers:ve,changedPointers:[oe],pointerType:Yn,srcEvent:oe}),De&&ve.splice(Vr,1))}});var Wu={touchstart:fn,touchmove:2,touchend:Dn,touchcancel:F};function Yu(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,Dt.apply(this,arguments)}function zs(Z,oe){var ve=Bt(Z.touches),De=Bt(Z.changedTouches);return oe&(Dn|F)&&(ve=Ve(ve.concat(De),"identifier",!0)),[ve,De]}ae(Yu,Dt,{handler:function(oe){var ve=Wu[oe.type];if(ve===fn&&(this.started=!0),this.started){var De=zs.call(this,oe,ve);ve&(Dn|F)&&De[0].length-De[1].length==0&&(this.started=!1),this.callback(this.manager,ve,{pointers:De[0],changedPointers:De[1],pointerType:mi,srcEvent:oe})}}});var Zu={touchstart:fn,touchmove:2,touchend:Dn,touchcancel:F},ac="touchstart touchmove touchend touchcancel";function Ol(){this.evTarget=ac,this.targetIds={},Dt.apply(this,arguments)}function xo(Z,oe){var ve=Bt(Z.touches),De=this.targetIds;if(oe&(2|fn)&&1===ve.length)return De[ve[0].identifier]=!0,[ve,ve];var Ft,sn,Yn=Bt(Z.changedTouches),Hr=[],Vr=this.target;if(sn=ve.filter(function(nn){return pe(nn.target,Vr)}),oe===fn)for(Ft=0;Ft<sn.length;)De[sn[Ft].identifier]=!0,Ft++;for(Ft=0;Ft<Yn.length;)De[Yn[Ft].identifier]&&Hr.push(Yn[Ft]),oe&(Dn|F)&&delete De[Yn[Ft].identifier],Ft++;return Hr.length?[Ve(sn.concat(Hr),"identifier",!0),Hr]:void 0}ae(Ol,Dt,{handler:function(oe){var ve=Zu[oe.type],De=xo.call(this,oe,ve);De&&this.callback(this.manager,ve,{pointers:De[0],changedPointers:De[1],pointerType:mi,srcEvent:oe})}});var oo=2500;function Oo(){Dt.apply(this,arguments);var Z=te(this.handler,this);this.touch=new Ol(this.manager,Z),this.mouse=new xs(this.manager,Z),this.primaryTouch=null,this.lastTouches=[]}function jf(Z,oe){Z&fn?(this.primaryTouch=oe.changedPointers[0].identifier,qc.call(this,oe)):Z&(Dn|F)&&qc.call(this,oe)}function qc(Z){var oe=Z.changedPointers[0];if(oe.identifier===this.primaryTouch){var ve={x:oe.clientX,y:oe.clientY};this.lastTouches.push(ve);var De=this.lastTouches;setTimeout(function(){var sn=De.indexOf(ve);sn>-1&&De.splice(sn,1)},oo)}}function mt(Z){for(var oe=Z.srcEvent.clientX,ve=Z.srcEvent.clientY,De=0;De<this.lastTouches.length;De++){var Ft=this.lastTouches[De],sn=Math.abs(oe-Ft.x),Yn=Math.abs(ve-Ft.y);if(sn<=25&&Yn<=25)return!0}return!1}ae(Oo,Dt,{handler:function(oe,ve,De){var sn=De.pointerType==At;if(!(sn&&De.sourceCapabilities&&De.sourceCapabilities.firesTouchEvents)){if(De.pointerType==mi)jf.call(this,ve,De);else if(sn&&mt.call(this,De))return;this.callback(oe,ve,De)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Aa=Ot(O.style,"touchAction"),Al=Aa!==S,lc="compute",Xu="manipulation",da="none",Ao="pan-x",ws="pan-y",Hs=function Es(){if(!Al)return!1;var Z={},oe=w.CSS&&w.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(ve){Z[ve]=!oe||w.CSS.supports("touch-action",ve)}),Z}();function os(Z,oe){this.manager=Z,this.set(oe)}os.prototype={set:function(Z){Z==lc&&(Z=this.compute()),Al&&this.manager.element.style&&Hs[Z]&&(this.manager.element.style[Aa]=Z),this.actions=Z.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Z=[];return N(this.manager.recognizers,function(oe){ce(oe.options.enable,[oe])&&(Z=Z.concat(oe.getTouchAction()))}),function Xc(Z){if(Se(Z,da))return da;var oe=Se(Z,Ao),ve=Se(Z,ws);return oe&&ve?da:oe||ve?oe?Ao:ws:Se(Z,Xu)?Xu:"auto"}(Z.join(" "))},preventDefaults:function(Z){var oe=Z.srcEvent,ve=Z.offsetDirection;if(!this.manager.session.prevented){var De=this.actions,Ft=Se(De,da)&&!Hs[da],sn=Se(De,ws)&&!Hs[ws],Yn=Se(De,Ao)&&!Hs[Ao];if(Ft&&1===Z.pointers.length&&Z.distance<2&&Z.deltaTime<250)return;return Yn&&sn||!(Ft||sn&&ve&dt||Yn&&ve&vt)?void 0:this.preventSrc(oe)}oe.preventDefault()},preventSrc:function(Z){this.manager.session.prevented=!0,Z.preventDefault()}};var Is=1;function Ti(Z){this.options=de({},this.defaults,Z||{}),this.id=function Tt(){return ot++}(),this.manager=null,this.options.enable=_e(this.options.enable,!0),this.state=Is,this.simultaneous={},this.requireFail=[]}function cc(Z){return 16&Z?"cancel":8&Z?"end":4&Z?"move":2&Z?"start":""}function hh(Z){return Z==Ie?"down":Z==se?"up":Z==Re?"left":Z==fe?"right":""}function re(Z,oe){var ve=oe.manager;return ve?ve.get(Z):Z}function be(){Ti.apply(this,arguments)}function ie(){be.apply(this,arguments),this.pX=null,this.pY=null}function Pe(){be.apply(this,arguments)}function Ne(){Ti.apply(this,arguments),this._timer=null,this._input=null}function Oe(){be.apply(this,arguments)}function yt(){be.apply(this,arguments)}function Pt(){Ti.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function kt(Z,oe){return(oe=oe||{}).recognizers=_e(oe.recognizers,kt.defaults.preset),new dn(Z,oe)}function dn(Z,oe){this.options=de({},kt.defaults,oe||{}),this.options.inputTarget=this.options.inputTarget||Z,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Z,this.input=function hn(Z){return new(Z.options.inputClass||(Rt?qi:qt?Ol:tn?Oo:xs))(Z,Ii)}(this),this.touchAction=new os(this,this.options.touchAction),Kn(this,!0),N(this.options.recognizers,function(ve){var De=this.add(new ve[0](ve[1]));ve[2]&&De.recognizeWith(ve[2]),ve[3]&&De.requireFailure(ve[3])},this)}function Kn(Z,oe){var De,ve=Z.element;ve.style&&(N(Z.options.cssProps,function(Ft,sn){De=Ot(ve.style,sn),oe?(Z.oldCssProps[De]=ve.style[De],ve.style[De]=Ft):ve.style[De]=Z.oldCssProps[De]||""}),oe||(Z.oldCssProps={}))}Ti.prototype={defaults:{},set:function(Z){return de(this.options,Z),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Z){if(z(Z,"recognizeWith",this))return this;var oe=this.simultaneous;return oe[(Z=re(Z,this)).id]||(oe[Z.id]=Z,Z.recognizeWith(this)),this},dropRecognizeWith:function(Z){return z(Z,"dropRecognizeWith",this)||(Z=re(Z,this),delete this.simultaneous[Z.id]),this},requireFailure:function(Z){if(z(Z,"requireFailure",this))return this;var oe=this.requireFail;return-1===Ye(oe,Z=re(Z,this))&&(oe.push(Z),Z.requireFailure(this)),this},dropRequireFailure:function(Z){if(z(Z,"dropRequireFailure",this))return this;Z=re(Z,this);var oe=Ye(this.requireFail,Z);return oe>-1&&this.requireFail.splice(oe,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Z){return!!this.simultaneous[Z.id]},emit:function(Z){var oe=this,ve=this.state;function De(Ft){oe.manager.emit(Ft,Z)}ve<8&&De(oe.options.event+cc(ve)),De(oe.options.event),Z.additionalEvent&&De(Z.additionalEvent),ve>=8&&De(oe.options.event+cc(ve))},tryEmit:function(Z){if(this.canEmit())return this.emit(Z);this.state=32},canEmit:function(){for(var Z=0;Z<this.requireFail.length;){if(!(this.requireFail[Z].state&(32|Is)))return!1;Z++}return!0},recognize:function(Z){var oe=de({},Z);if(!ce(this.options.enable,[this,oe]))return this.reset(),void(this.state=32);56&this.state&&(this.state=Is),this.state=this.process(oe),30&this.state&&this.tryEmit(oe)},process:function(Z){},getTouchAction:function(){},reset:function(){}},ae(be,Ti,{defaults:{pointers:1},attrTest:function(Z){var oe=this.options.pointers;return 0===oe||Z.pointers.length===oe},process:function(Z){var oe=this.state,ve=Z.eventType,De=6&oe,Ft=this.attrTest(Z);return De&&(ve&F||!Ft)?16|oe:De||Ft?ve&Dn?8|oe:2&oe?4|oe:2:32}}),ae(ie,be,{defaults:{event:"pan",threshold:10,pointers:1,direction:qe},getTouchAction:function(){var Z=this.options.direction,oe=[];return Z&dt&&oe.push(ws),Z&vt&&oe.push(Ao),oe},directionTest:function(Z){var oe=this.options,ve=!0,De=Z.distance,Ft=Z.direction,sn=Z.deltaX,Yn=Z.deltaY;return Ft&oe.direction||(oe.direction&dt?(Ft=0===sn?Ae:sn<0?Re:fe,ve=sn!=this.pX,De=Math.abs(Z.deltaX)):(Ft=0===Yn?Ae:Yn<0?se:Ie,ve=Yn!=this.pY,De=Math.abs(Z.deltaY))),Z.direction=Ft,ve&&De>oe.threshold&&Ft&oe.direction},attrTest:function(Z){return be.prototype.attrTest.call(this,Z)&&(2&this.state||!(2&this.state)&&this.directionTest(Z))},emit:function(Z){this.pX=Z.deltaX,this.pY=Z.deltaY;var oe=hh(Z.direction);oe&&(Z.additionalEvent=this.options.event+oe),this._super.emit.call(this,Z)}}),ae(Pe,be,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[da]},attrTest:function(Z){return this._super.attrTest.call(this,Z)&&(Math.abs(Z.scale-1)>this.options.threshold||2&this.state)},emit:function(Z){1!==Z.scale&&(Z.additionalEvent=this.options.event+(Z.scale<1?"in":"out")),this._super.emit.call(this,Z)}}),ae(Ne,Ti,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(Z){var oe=this.options,ve=Z.pointers.length===oe.pointers,De=Z.distance<oe.threshold,Ft=Z.deltaTime>oe.time;if(this._input=Z,!De||!ve||Z.eventType&(Dn|F)&&!Ft)this.reset();else if(Z.eventType&fn)this.reset(),this._timer=k(function(){this.state=8,this.tryEmit()},oe.time,this);else if(Z.eventType&Dn)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(Z){8===this.state&&(Z&&Z.eventType&Dn?this.manager.emit(this.options.event+"up",Z):(this._input.timeStamp=D(),this.manager.emit(this.options.event,this._input)))}}),ae(Oe,be,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[da]},attrTest:function(Z){return this._super.attrTest.call(this,Z)&&(Math.abs(Z.rotation)>this.options.threshold||2&this.state)}}),ae(yt,be,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:dt|vt,pointers:1},getTouchAction:function(){return ie.prototype.getTouchAction.call(this)},attrTest:function(Z){var ve,oe=this.options.direction;return oe&(dt|vt)?ve=Z.overallVelocity:oe&dt?ve=Z.overallVelocityX:oe&vt&&(ve=Z.overallVelocityY),this._super.attrTest.call(this,Z)&&oe&Z.offsetDirection&&Z.distance>this.options.threshold&&Z.maxPointers==this.options.pointers&&E(ve)>this.options.velocity&&Z.eventType&Dn},emit:function(Z){var oe=hh(Z.offsetDirection);oe&&this.manager.emit(this.options.event+oe,Z),this.manager.emit(this.options.event,Z)}}),ae(Pt,Ti,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Xu]},process:function(Z){var oe=this.options,ve=Z.pointers.length===oe.pointers,De=Z.distance<oe.threshold,Ft=Z.deltaTime<oe.time;if(this.reset(),Z.eventType&fn&&0===this.count)return this.failTimeout();if(De&&Ft&&ve){if(Z.eventType!=Dn)return this.failTimeout();var sn=!this.pTime||Z.timeStamp-this.pTime<oe.interval,Yn=!this.pCenter||rs(this.pCenter,Z.center)<oe.posThreshold;if(this.pTime=Z.timeStamp,this.pCenter=Z.center,Yn&&sn?this.count+=1:this.count=1,this._input=Z,0==this.count%oe.taps)return this.hasRequireFailures()?(this._timer=k(function(){this.state=8,this.tryEmit()},oe.interval,this),2):8}return 32},failTimeout:function(){return this._timer=k(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),kt.VERSION="2.0.7",kt.defaults={domEvents:!1,touchAction:lc,enable:!0,inputTarget:null,inputClass:null,preset:[[Oe,{enable:!1}],[Pe,{enable:!1},["rotate"]],[yt,{direction:dt}],[ie,{direction:dt},["swipe"]],[Pt],[Pt,{event:"doubletap",taps:2},["tap"]],[Ne]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},dn.prototype={set:function(Z){return de(this.options,Z),Z.touchAction&&this.touchAction.update(),Z.inputTarget&&(this.input.destroy(),this.input.target=Z.inputTarget,this.input.init()),this},stop:function(Z){this.session.stopped=Z?2:1},recognize:function(Z){var oe=this.session;if(!oe.stopped){this.touchAction.preventDefaults(Z);var ve,De=this.recognizers,Ft=oe.curRecognizer;(!Ft||Ft&&8&Ft.state)&&(Ft=oe.curRecognizer=null);for(var sn=0;sn<De.length;)ve=De[sn],2===oe.stopped||Ft&&ve!=Ft&&!ve.canRecognizeWith(Ft)?ve.reset():ve.recognize(Z),!Ft&&14&ve.state&&(Ft=oe.curRecognizer=ve),sn++}},get:function(Z){if(Z instanceof Ti)return Z;for(var oe=this.recognizers,ve=0;ve<oe.length;ve++)if(oe[ve].options.event==Z)return oe[ve];return null},add:function(Z){if(z(Z,"add",this))return this;var oe=this.get(Z.options.event);return oe&&this.remove(oe),this.recognizers.push(Z),Z.manager=this,this.touchAction.update(),Z},remove:function(Z){if(z(Z,"remove",this))return this;if(Z=this.get(Z)){var oe=this.recognizers,ve=Ye(oe,Z);-1!==ve&&(oe.splice(ve,1),this.touchAction.update())}return this},on:function(Z,oe){if(Z!==S&&oe!==S){var ve=this.handlers;return N(R(Z),function(De){ve[De]=ve[De]||[],ve[De].push(oe)}),this}},off:function(Z,oe){if(Z!==S){var ve=this.handlers;return N(R(Z),function(De){oe?ve[De]&&ve[De].splice(Ye(ve[De],oe),1):delete ve[De]}),this}},emit:function(Z,oe){this.options.domEvents&&function _i(Z,oe){var ve=B.createEvent("Event");ve.initEvent(Z,!0,!0),ve.gesture=oe,oe.target.dispatchEvent(ve)}(Z,oe);var ve=this.handlers[Z]&&this.handlers[Z].slice();if(ve&&ve.length){oe.type=Z,oe.preventDefault=function(){oe.srcEvent.preventDefault()};for(var De=0;De<ve.length;)ve[De](oe),De++}},destroy:function(){this.element&&Kn(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},de(kt,{INPUT_START:fn,INPUT_MOVE:2,INPUT_END:Dn,INPUT_CANCEL:F,STATE_POSSIBLE:Is,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:Ae,DIRECTION_LEFT:Re,DIRECTION_RIGHT:fe,DIRECTION_UP:se,DIRECTION_DOWN:Ie,DIRECTION_HORIZONTAL:dt,DIRECTION_VERTICAL:vt,DIRECTION_ALL:qe,Manager:dn,Input:Dt,TouchAction:os,TouchInput:Ol,MouseInput:xs,PointerEventInput:qi,TouchMouseInput:Oo,SingleTouchInput:Yu,Recognizer:Ti,AttrRecognizer:be,Tap:Pt,Pan:ie,Swipe:yt,Pinch:Pe,Rotate:Oe,Press:Ne,on:ue,off:Qe,each:N,merge:J,extend:we,assign:de,inherit:ae,bindFn:te,prefixed:Ot}),(typeof w<"u"?w:typeof self<"u"?self:{}).Hammer=kt,(L=function(){return kt}.call(X,me,X,Kt))!==S&&(Kt.exports=L)}(window,document)},2020:(Kt,X)=>{X.read=function(me,L,w,B,T){var S,P,O=8*T-B-1,j=(1<<O)-1,A=j>>1,E=-7,D=w?T-1:0,k=w?-1:1,z=me[L+D];for(D+=k,S=z&(1<<-E)-1,z>>=-E,E+=O;E>0;S=256*S+me[L+D],D+=k,E-=8);for(P=S&(1<<-E)-1,S>>=-E,E+=B;E>0;P=256*P+me[L+D],D+=k,E-=8);if(0===S)S=1-A;else{if(S===j)return P?NaN:1/0*(z?-1:1);P+=Math.pow(2,B),S-=A}return(z?-1:1)*P*Math.pow(2,S-B)},X.write=function(me,L,w,B,T,S){var P,O,j,A=8*S-T-1,E=(1<<A)-1,D=E>>1,k=23===T?Math.pow(2,-24)-Math.pow(2,-77):0,z=B?0:S-1,N=B?1:-1,Q=L<0||0===L&&1/L<0?1:0;for(L=Math.abs(L),isNaN(L)||L===1/0?(O=isNaN(L)?1:0,P=E):(P=Math.floor(Math.log(L)/Math.LN2),L*(j=Math.pow(2,-P))<1&&(P--,j*=2),(L+=P+D>=1?k/j:k*Math.pow(2,1-D))*j>=2&&(P++,j/=2),P+D>=E?(O=0,P=E):P+D>=1?(O=(L*j-1)*Math.pow(2,T),P+=D):(O=L*Math.pow(2,D-1)*Math.pow(2,T),P=0));T>=8;me[w+z]=255&O,z+=N,O/=256,T-=8);for(P=P<<T|O,A+=T;A>0;me[w+z]=255&P,z+=N,P/=256,A-=8);me[w+z-N]|=128*Q}},8590:function(Kt,X){!function(T){var z,S="undefined",P=S!==typeof Buffer&&Buffer,O=S!==typeof Uint8Array&&Uint8Array,j=S!==typeof ArrayBuffer&&ArrayBuffer,A=[0,0,0,0,0,0,0,0],E=Array.isArray||function pe(Se){return!!Se&&"[object Array]"==Object.prototype.toString.call(Se)},D=4294967296;function N(Se,R,Ye){var Bt=R?0:4,Ve=R?4:0,Ot=R?0:3,ot=R?1:2,Tt=R?2:1,Ze=R?3:0,et=R?ce:ue,tn=R?_e:Qe,Rt=$t.prototype,qt="is"+Se,mi="_"+qt;return Rt.buffer=void 0,Rt.offset=0,Rt[mi]=!0,Rt.toNumber=fn,Rt.toString=function oi(Ae){var Re=this.buffer,fe=this.offset,se=F(Re,fe+Bt),Ie=F(Re,fe+Ve),dt="",vt=!Ye&&2147483648&se;for(vt&&(se=~se,Ie=D-Ie),Ae=Ae||10;;){var qe=se%Ae*D+Ie;if(se=Math.floor(se/Ae),Ie=Math.floor(qe/Ae),dt=(qe%Ae).toString(Ae)+dt,!se&&!Ie)break}return vt&&(dt="-"+dt),dt},Rt.toJSON=fn,Rt.toArray=Q,P&&(Rt.toBuffer=de),O&&(Rt.toArrayBuffer=we),$t[qt]=function At(Ae){return!(!Ae||!Ae[mi])},T[Se]=$t,$t;function $t(Ae,Re,fe,se){return this instanceof $t?function Lt(Ae,Re,fe,se,Ie){O&&j&&(Re instanceof j&&(Re=new O(Re)),se instanceof j&&(se=new O(se))),Re||fe||se||z?(J(Re,fe)||(Ie=fe,se=Re,fe=0,Re=new(z||Array)(8)),Ae.buffer=Re,Ae.offset=fe|=0,S!==typeof se&&("string"==typeof se?function Cn(Ae,Re,fe,se){var Ie=0,dt=fe.length,vt=0,qe=0;"-"===fe[0]&&Ie++;for(var Mt=Ie;Ie<dt;){var Ht=parseInt(fe[Ie++],se);if(!(Ht>=0))break;qe=qe*se+Ht,vt=vt*se+Math.floor(qe/D),qe%=D}Mt&&(vt=~vt,qe?qe=D-qe:vt++),Dn(Ae,Re+Bt,vt),Dn(Ae,Re+Ve,qe)}(Re,fe,se,Ie||10):J(se,Ie)?ae(Re,fe,se,Ie):"number"==typeof Ie?(Dn(Re,fe+Bt,se),Dn(Re,fe+Ve,Ie)):se>0?et(Re,fe,se):se<0?tn(Re,fe,se):ae(Re,fe,A,0))):Ae.buffer=te(A,0)}(this,Ae,Re,fe,se):new $t(Ae,Re,fe,se)}function fn(){var Ae=this.buffer,Re=this.offset,fe=F(Ae,Re+Bt),se=F(Ae,Re+Ve);return Ye||(fe|=0),fe?fe*D+se:se}function Dn(Ae,Re,fe){Ae[Re+Ze]=255&fe,Ae[Re+Tt]=255&(fe>>=8),Ae[Re+ot]=255&(fe>>=8),Ae[Re+Ot]=255&(fe>>=8)}function F(Ae,Re){return 16777216*Ae[Re+Ot]+(Ae[Re+ot]<<16)+(Ae[Re+Tt]<<8)+Ae[Re+Ze]}}function Q(Se){var R=this.buffer,Ye=this.offset;return z=null,!1!==Se&&0===Ye&&8===R.length&&E(R)?R:te(R,Ye)}function de(Se){var R=this.buffer,Ye=this.offset;if(z=P,!1!==Se&&0===Ye&&8===R.length&&Buffer.isBuffer(R))return R;var Bt=new P(8);return ae(Bt,0,R,Ye),Bt}function we(Se){var R=this.buffer,Ye=this.offset,Bt=R.buffer;if(z=O,!1!==Se&&0===Ye&&Bt instanceof j&&8===Bt.byteLength)return Bt;var Ve=new O(8);return ae(Ve,0,R,Ye),Ve.buffer}function J(Se,R){var Ye=Se&&Se.length;return R|=0,Ye&&R+8<=Ye&&"string"!=typeof Se[R]}function ae(Se,R,Ye,Bt){R|=0,Bt|=0;for(var Ve=0;Ve<8;Ve++)Se[R++]=255&Ye[Bt++]}function te(Se,R){return Array.prototype.slice.call(Se,R,R+8)}function ce(Se,R,Ye){for(var Bt=R+8;Bt>R;)Se[--Bt]=255&Ye,Ye/=256}function _e(Se,R,Ye){var Bt=R+8;for(Ye++;Bt>R;)Se[--Bt]=255&-Ye^255,Ye/=256}function ue(Se,R,Ye){for(var Bt=R+8;R<Bt;)Se[R++]=255&Ye,Ye/=256}function Qe(Se,R,Ye){var Bt=R+8;for(Ye++;R<Bt;)Se[R++]=255&-Ye^255,Ye/=256}N("Uint64BE",!0,!0),N("Int64BE",!0,!1),N("Uint64LE",!1,!0),N("Int64LE",!1,!1)}("string"!=typeof X.nodeName?X:this||{})},53:Kt=>{var X={}.toString;Kt.exports=Array.isArray||function(me){return"[object Array]"==X.call(me)}},7247:Kt=>{Kt.exports=function X(me,L,w){function B(P,O){if(!L[P]){if(!me[P]){if(T)return T(P,!0);var A=new Error("Cannot find module '"+P+"'");throw A.code="MODULE_NOT_FOUND",A}var E=L[P]={exports:{}};me[P][0].call(E.exports,function(D){return B(me[P][1][D]||D)},E,E.exports,X,me,L,w)}return L[P].exports}for(var T=void 0,S=0;S<w.length;S++)B(w[S]);return B}({1:[function(X,me,L){"use strict";var w=X("./utils"),B=X("./support"),T="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";L.encode=function(S){for(var P,O,j,E,D,k,z=[],N=0,Q=S.length,de=Q,we="string"!==w.getTypeOf(S);N<S.length;)de=Q-N,j=we?(P=S[N++],O=N<Q?S[N++]:0,N<Q?S[N++]:0):(P=S.charCodeAt(N++),O=N<Q?S.charCodeAt(N++):0,N<Q?S.charCodeAt(N++):0),E=(3&P)<<4|O>>4,D=1<de?(15&O)<<2|j>>6:64,k=2<de?63&j:64,z.push(T.charAt(P>>2)+T.charAt(E)+T.charAt(D)+T.charAt(k));return z.join("")},L.decode=function(S){var P,O,j,A,E,D,k=0,z=0,N="data:";if(S.substr(0,5)===N)throw new Error("Invalid base64 input, it looks like a data url.");var Q,de=3*(S=S.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(S.charAt(S.length-1)===T.charAt(64)&&de--,S.charAt(S.length-2)===T.charAt(64)&&de--,de%1!=0)throw new Error("Invalid base64 input, bad content length.");for(Q=B.uint8array?new Uint8Array(0|de):new Array(0|de);k<S.length;)P=T.indexOf(S.charAt(k++))<<2|(A=T.indexOf(S.charAt(k++)))>>4,O=(15&A)<<4|(E=T.indexOf(S.charAt(k++)))>>2,j=(3&E)<<6|(D=T.indexOf(S.charAt(k++))),Q[z++]=P,64!==E&&(Q[z++]=O),64!==D&&(Q[z++]=j);return Q}},{"./support":30,"./utils":32}],2:[function(X,me,L){"use strict";var w=X("./external"),B=X("./stream/DataWorker"),T=X("./stream/Crc32Probe"),S=X("./stream/DataLengthProbe");function P(O,j,A,E,D){this.compressedSize=O,this.uncompressedSize=j,this.crc32=A,this.compression=E,this.compressedContent=D}P.prototype={getContentWorker:function(){var O=new B(w.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new S("data_length")),j=this;return O.on("end",function(){if(this.streamInfo.data_length!==j.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),O},getCompressedWorker:function(){return new B(w.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},P.createWorkerFrom=function(O,j,A){return O.pipe(new T).pipe(new S("uncompressedSize")).pipe(j.compressWorker(A)).pipe(new S("compressedSize")).withStreamInfo("compression",j)},me.exports=P},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(X,me,L){"use strict";var w=X("./stream/GenericWorker");L.STORE={magic:"\0\0",compressWorker:function(){return new w("STORE compression")},uncompressWorker:function(){return new w("STORE decompression")}},L.DEFLATE=X("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(X,me,L){"use strict";var w=X("./utils"),B=function(){for(var T,S=[],P=0;P<256;P++){T=P;for(var O=0;O<8;O++)T=1&T?3988292384^T>>>1:T>>>1;S[P]=T}return S}();me.exports=function(T,S){return void 0!==T&&T.length?"string"!==w.getTypeOf(T)?function(P,O,j,A){var E=B,D=0+j;P^=-1;for(var k=0;k<D;k++)P=P>>>8^E[255&(P^O[k])];return~P}(0|S,T,T.length):function(P,O,j,A){var E=B,D=0+j;P^=-1;for(var k=0;k<D;k++)P=P>>>8^E[255&(P^O.charCodeAt(k))];return~P}(0|S,T,T.length):0}},{"./utils":32}],5:[function(X,me,L){"use strict";L.base64=!1,L.binary=!1,L.dir=!1,L.createFolders=!0,L.date=null,L.compression=null,L.compressionOptions=null,L.comment=null,L.unixPermissions=null,L.dosPermissions=null},{}],6:[function(X,me,L){"use strict";var w;w=typeof Promise<"u"?Promise:X("lie"),me.exports={Promise:w}},{lie:37}],7:[function(X,me,L){"use strict";var w=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",B=X("pako"),T=X("./utils"),S=X("./stream/GenericWorker"),P=w?"uint8array":"array";function O(j,A){S.call(this,"FlateWorker/"+j),this._pako=null,this._pakoAction=j,this._pakoOptions=A,this.meta={}}L.magic="\b\0",T.inherits(O,S),O.prototype.processChunk=function(j){this.meta=j.meta,null===this._pako&&this._createPako(),this._pako.push(T.transformTo(P,j.data),!1)},O.prototype.flush=function(){S.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},O.prototype.cleanUp=function(){S.prototype.cleanUp.call(this),this._pako=null},O.prototype._createPako=function(){this._pako=new B[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var j=this;this._pako.onData=function(A){j.push({data:A,meta:j.meta})}},L.compressWorker=function(j){return new O("Deflate",j)},L.uncompressWorker=function(){return new O("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(X,me,L){"use strict";function w(E,D){var k,z="";for(k=0;k<D;k++)z+=String.fromCharCode(255&E),E>>>=8;return z}function B(E,D,k,z,N,Q){var de,we,J=E.file,ae=E.compression,te=Q!==P.utf8encode,ce=T.transformTo("string",Q(J.name)),_e=T.transformTo("string",P.utf8encode(J.name)),ue=J.comment,Qe=T.transformTo("string",Q(ue)),pe=T.transformTo("string",P.utf8encode(ue)),Se=_e.length!==J.name.length,R=pe.length!==ue.length,Ye="",Bt="",Ve="",Ot=J.dir,ot=J.date,Tt={crc32:0,compressedSize:0,uncompressedSize:0};D&&!k||(Tt.crc32=E.crc32,Tt.compressedSize=E.compressedSize,Tt.uncompressedSize=E.uncompressedSize);var Ze=0;D&&(Ze|=8),te||!Se&&!R||(Ze|=2048);var qt,$t,et=0,tn=0;Ot&&(et|=16),"UNIX"===N?(tn=798,et|=($t=qt=J.unixPermissions,qt||($t=Ot?16893:33204),(65535&$t)<<16)):(tn=20,et|=function(qt){return 63&(qt||0)}(J.dosPermissions)),de=ot.getUTCHours(),de<<=6,de|=ot.getUTCMinutes(),de<<=5,de|=ot.getUTCSeconds()/2,we=ot.getUTCFullYear()-1980,we<<=4,we|=ot.getUTCMonth()+1,we<<=5,we|=ot.getUTCDate(),Se&&(Bt=w(1,1)+w(O(ce),4)+_e,Ye+="up"+w(Bt.length,2)+Bt),R&&(Ve=w(1,1)+w(O(Qe),4)+pe,Ye+="uc"+w(Ve.length,2)+Ve);var Rt="";return Rt+="\n\0",Rt+=w(Ze,2),Rt+=ae.magic,Rt+=w(de,2),Rt+=w(we,2),Rt+=w(Tt.crc32,4),Rt+=w(Tt.compressedSize,4),Rt+=w(Tt.uncompressedSize,4),Rt+=w(ce.length,2),Rt+=w(Ye.length,2),{fileRecord:j.LOCAL_FILE_HEADER+Rt+ce+Ye,dirRecord:j.CENTRAL_FILE_HEADER+w(tn,2)+Rt+w(Qe.length,2)+"\0\0\0\0"+w(et,4)+w(z,4)+ce+Ye+Qe}}var T=X("../utils"),S=X("../stream/GenericWorker"),P=X("../utf8"),O=X("../crc32"),j=X("../signature");function A(E,D,k,z){S.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=D,this.zipPlatform=k,this.encodeFileName=z,this.streamFiles=E,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}T.inherits(A,S),A.prototype.push=function(E){var D=E.meta.percent||0,k=this.entriesCount,z=this._sources.length;this.accumulate?this.contentBuffer.push(E):(this.bytesWritten+=E.data.length,S.prototype.push.call(this,{data:E.data,meta:{currentFile:this.currentFile,percent:k?(D+100*(k-z-1))/k:100}}))},A.prototype.openedSource=function(E){this.currentSourceOffset=this.bytesWritten,this.currentFile=E.file.name;var D=this.streamFiles&&!E.file.dir;if(D){var k=B(E,D,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:k.fileRecord,meta:{percent:0}})}else this.accumulate=!0},A.prototype.closedSource=function(E){this.accumulate=!1;var z,D=this.streamFiles&&!E.file.dir,k=B(E,D,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(k.dirRecord),D)this.push({data:(z=E,j.DATA_DESCRIPTOR+w(z.crc32,4)+w(z.compressedSize,4)+w(z.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:k.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},A.prototype.flush=function(){for(var E=this.bytesWritten,D=0;D<this.dirRecords.length;D++)this.push({data:this.dirRecords[D],meta:{percent:100}});var N,Q,de,ae,z=(N=this.dirRecords.length,Q=this.bytesWritten-E,de=E,ae=T.transformTo("string",(0,this.encodeFileName)(this.zipComment)),j.CENTRAL_DIRECTORY_END+"\0\0\0\0"+w(N,2)+w(N,2)+w(Q,4)+w(de,4)+w(ae.length,2)+ae);this.push({data:z,meta:{percent:100}})},A.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},A.prototype.registerPrevious=function(E){this._sources.push(E);var D=this;return E.on("data",function(k){D.processChunk(k)}),E.on("end",function(){D.closedSource(D.previous.streamInfo),D._sources.length?D.prepareNextSource():D.end()}),E.on("error",function(k){D.error(k)}),this},A.prototype.resume=function(){return!!S.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},A.prototype.error=function(E){var D=this._sources;if(!S.prototype.error.call(this,E))return!1;for(var k=0;k<D.length;k++)try{D[k].error(E)}catch{}return!0},A.prototype.lock=function(){S.prototype.lock.call(this);for(var E=this._sources,D=0;D<E.length;D++)E[D].lock()},me.exports=A},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(X,me,L){"use strict";var w=X("../compressions"),B=X("./ZipFileWorker");L.generateWorker=function(T,S,P){var O=new B(S.streamFiles,P,S.platform,S.encodeFileName),j=0;try{T.forEach(function(A,E){j++;var D=function(Q,de){var we=Q||de,J=w[we];if(!J)throw new Error(we+" is not a valid compression method !");return J}(E.options.compression,S.compression),z=E.dir,N=E.date;E._compressWorker(D,E.options.compressionOptions||S.compressionOptions||{}).withStreamInfo("file",{name:A,dir:z,date:N,comment:E.comment||"",unixPermissions:E.unixPermissions,dosPermissions:E.dosPermissions}).pipe(O)}),O.entriesCount=j}catch(A){O.error(A)}return O}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(X,me,L){"use strict";function w(){if(!(this instanceof w))return new w;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var B=new w;for(var T in this)"function"!=typeof this[T]&&(B[T]=this[T]);return B}}(w.prototype=X("./object")).loadAsync=X("./load"),w.support=X("./support"),w.defaults=X("./defaults"),w.version="3.10.1",w.loadAsync=function(B,T){return(new w).loadAsync(B,T)},w.external=X("./external"),me.exports=w},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(X,me,L){"use strict";var w=X("./utils"),B=X("./external"),T=X("./utf8"),S=X("./zipEntries"),P=X("./stream/Crc32Probe"),O=X("./nodejsUtils");function j(A){return new B.Promise(function(E,D){var k=A.decompressed.getContentWorker().pipe(new P);k.on("error",function(z){D(z)}).on("end",function(){k.streamInfo.crc32!==A.decompressed.crc32?D(new Error("Corrupted zip : CRC32 mismatch")):E()}).resume()})}me.exports=function(A,E){var D=this;return E=w.extend(E||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:T.utf8decode}),O.isNode&&O.isStream(A)?B.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):w.prepareContent("the loaded zip file",A,!0,E.optimizedBinaryString,E.base64).then(function(k){var z=new S(E);return z.load(k),z}).then(function(k){var z=[B.Promise.resolve(k)],N=k.files;if(E.checkCRC32)for(var Q=0;Q<N.length;Q++)z.push(j(N[Q]));return B.Promise.all(z)}).then(function(k){for(var z=k.shift(),N=z.files,Q=0;Q<N.length;Q++){var de=N[Q],we=de.fileNameStr,J=w.resolve(de.fileNameStr);D.file(J,de.decompressed,{binary:!0,optimizedBinaryString:!0,date:de.date,dir:de.dir,comment:de.fileCommentStr.length?de.fileCommentStr:null,unixPermissions:de.unixPermissions,dosPermissions:de.dosPermissions,createFolders:E.createFolders}),de.dir||(D.file(J).unsafeOriginalName=we)}return z.zipComment.length&&(D.comment=z.zipComment),D})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(X,me,L){"use strict";var w=X("../utils"),B=X("../stream/GenericWorker");function T(S,P){B.call(this,"Nodejs stream input adapter for "+S),this._upstreamEnded=!1,this._bindStream(P)}w.inherits(T,B),T.prototype._bindStream=function(S){var P=this;(this._stream=S).pause(),S.on("data",function(O){P.push({data:O,meta:{percent:0}})}).on("error",function(O){P.isPaused?this.generatedError=O:P.error(O)}).on("end",function(){P.isPaused?P._upstreamEnded=!0:P.end()})},T.prototype.pause=function(){return!!B.prototype.pause.call(this)&&(this._stream.pause(),!0)},T.prototype.resume=function(){return!!B.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},me.exports=T},{"../stream/GenericWorker":28,"../utils":32}],13:[function(X,me,L){"use strict";var w=X("readable-stream").Readable;function B(T,S,P){w.call(this,S),this._helper=T;var O=this;T.on("data",function(j,A){O.push(j)||O._helper.pause(),P&&P(A)}).on("error",function(j){O.emit("error",j)}).on("end",function(){O.push(null)})}X("../utils").inherits(B,w),B.prototype._read=function(){this._helper.resume()},me.exports=B},{"../utils":32,"readable-stream":16}],14:[function(X,me,L){"use strict";me.exports={isNode:typeof Buffer<"u",newBufferFrom:function(w,B){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(w,B);if("number"==typeof w)throw new Error('The "data" argument must not be a number');return new Buffer(w,B)},allocBuffer:function(w){if(Buffer.alloc)return Buffer.alloc(w);var B=new Buffer(w);return B.fill(0),B},isBuffer:function(w){return Buffer.isBuffer(w)},isStream:function(w){return w&&"function"==typeof w.on&&"function"==typeof w.pause&&"function"==typeof w.resume}}},{}],15:[function(X,me,L){"use strict";function w(J,ae,te){var ce,_e=T.getTypeOf(ae),ue=T.extend(te||{},O);ue.date=ue.date||new Date,null!==ue.compression&&(ue.compression=ue.compression.toUpperCase()),"string"==typeof ue.unixPermissions&&(ue.unixPermissions=parseInt(ue.unixPermissions,8)),ue.unixPermissions&&16384&ue.unixPermissions&&(ue.dir=!0),ue.dosPermissions&&16&ue.dosPermissions&&(ue.dir=!0),ue.dir&&(J=N(J)),ue.createFolders&&(ce=z(J))&&Q.call(this,ce,!0),te&&void 0!==te.binary||(ue.binary=!("string"===_e&&!1===ue.binary&&!1===ue.base64)),(ae instanceof j&&0===ae.uncompressedSize||ue.dir||!ae||0===ae.length)&&(ue.base64=!1,ue.binary=!0,ae="",ue.compression="STORE",_e="string");var pe;pe=ae instanceof j||ae instanceof S?ae:D.isNode&&D.isStream(ae)?new k(J,ae):T.prepareContent(J,ae,ue.binary,ue.optimizedBinaryString,ue.base64);var Se=new A(J,pe,ue);this.files[J]=Se}var B=X("./utf8"),T=X("./utils"),S=X("./stream/GenericWorker"),P=X("./stream/StreamHelper"),O=X("./defaults"),j=X("./compressedObject"),A=X("./zipObject"),E=X("./generate"),D=X("./nodejsUtils"),k=X("./nodejs/NodejsStreamInputAdapter"),z=function(J){"/"===J.slice(-1)&&(J=J.substring(0,J.length-1));var ae=J.lastIndexOf("/");return 0<ae?J.substring(0,ae):""},N=function(J){return"/"!==J.slice(-1)&&(J+="/"),J},Q=function(J,ae){return ae=void 0!==ae?ae:O.createFolders,J=N(J),this.files[J]||w.call(this,J,null,{dir:!0,createFolders:ae}),this.files[J]};function de(J){return"[object RegExp]"===Object.prototype.toString.call(J)}var we={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(J){var ae,te,ce;for(ae in this.files)ce=this.files[ae],(te=ae.slice(this.root.length,ae.length))&&ae.slice(0,this.root.length)===this.root&&J(te,ce)},filter:function(J){var ae=[];return this.forEach(function(te,ce){J(te,ce)&&ae.push(ce)}),ae},file:function(J,ae,te){if(1!==arguments.length)return w.call(this,J=this.root+J,ae,te),this;if(de(J)){var ce=J;return this.filter(function(ue,Qe){return!Qe.dir&&ce.test(ue)})}var _e=this.files[this.root+J];return _e&&!_e.dir?_e:null},folder:function(J){if(!J)return this;if(de(J))return this.filter(function(_e,ue){return ue.dir&&J.test(_e)});var te=Q.call(this,this.root+J),ce=this.clone();return ce.root=te.name,ce},remove:function(J){var ae=this.files[J=this.root+J];if(ae||("/"!==J.slice(-1)&&(J+="/"),ae=this.files[J]),ae&&!ae.dir)delete this.files[J];else for(var te=this.filter(function(_e,ue){return ue.name.slice(0,J.length)===J}),ce=0;ce<te.length;ce++)delete this.files[te[ce].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(J){var ae,te={};try{if((te=T.extend(J||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:B.utf8encode})).type=te.type.toLowerCase(),te.compression=te.compression.toUpperCase(),"binarystring"===te.type&&(te.type="string"),!te.type)throw new Error("No output type specified.");T.checkSupport(te.type),"darwin"!==te.platform&&"freebsd"!==te.platform&&"linux"!==te.platform&&"sunos"!==te.platform||(te.platform="UNIX"),"win32"===te.platform&&(te.platform="DOS"),ae=E.generateWorker(this,te,te.comment||this.comment||"")}catch(_e){(ae=new S("error")).error(_e)}return new P(ae,te.type||"string",te.mimeType)},generateAsync:function(J,ae){return this.generateInternalStream(J).accumulate(ae)},generateNodeStream:function(J,ae){return(J=J||{}).type||(J.type="nodebuffer"),this.generateInternalStream(J).toNodejsStream(ae)}};me.exports=we},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(X,me,L){"use strict";me.exports=X("stream")},{stream:void 0}],17:[function(X,me,L){"use strict";var w=X("./DataReader");function B(T){w.call(this,T);for(var S=0;S<this.data.length;S++)T[S]=255&T[S]}X("../utils").inherits(B,w),B.prototype.byteAt=function(T){return this.data[this.zero+T]},B.prototype.lastIndexOfSignature=function(T){for(var S=T.charCodeAt(0),P=T.charCodeAt(1),O=T.charCodeAt(2),j=T.charCodeAt(3),A=this.length-4;0<=A;--A)if(this.data[A]===S&&this.data[A+1]===P&&this.data[A+2]===O&&this.data[A+3]===j)return A-this.zero;return-1},B.prototype.readAndCheckSignature=function(T){var S=T.charCodeAt(0),P=T.charCodeAt(1),O=T.charCodeAt(2),j=T.charCodeAt(3),A=this.readData(4);return S===A[0]&&P===A[1]&&O===A[2]&&j===A[3]},B.prototype.readData=function(T){if(this.checkOffset(T),0===T)return[];var S=this.data.slice(this.zero+this.index,this.zero+this.index+T);return this.index+=T,S},me.exports=B},{"../utils":32,"./DataReader":18}],18:[function(X,me,L){"use strict";var w=X("../utils");function B(T){this.data=T,this.length=T.length,this.index=0,this.zero=0}B.prototype={checkOffset:function(T){this.checkIndex(this.index+T)},checkIndex:function(T){if(this.length<this.zero+T||T<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+T+"). Corrupted zip ?")},setIndex:function(T){this.checkIndex(T),this.index=T},skip:function(T){this.setIndex(this.index+T)},byteAt:function(){},readInt:function(T){var S,P=0;for(this.checkOffset(T),S=this.index+T-1;S>=this.index;S--)P=(P<<8)+this.byteAt(S);return this.index+=T,P},readString:function(T){return w.transformTo("string",this.readData(T))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var T=this.readInt(4);return new Date(Date.UTC(1980+(T>>25&127),(T>>21&15)-1,T>>16&31,T>>11&31,T>>5&63,(31&T)<<1))}},me.exports=B},{"../utils":32}],19:[function(X,me,L){"use strict";var w=X("./Uint8ArrayReader");function B(T){w.call(this,T)}X("../utils").inherits(B,w),B.prototype.readData=function(T){this.checkOffset(T);var S=this.data.slice(this.zero+this.index,this.zero+this.index+T);return this.index+=T,S},me.exports=B},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(X,me,L){"use strict";var w=X("./DataReader");function B(T){w.call(this,T)}X("../utils").inherits(B,w),B.prototype.byteAt=function(T){return this.data.charCodeAt(this.zero+T)},B.prototype.lastIndexOfSignature=function(T){return this.data.lastIndexOf(T)-this.zero},B.prototype.readAndCheckSignature=function(T){return T===this.readData(4)},B.prototype.readData=function(T){this.checkOffset(T);var S=this.data.slice(this.zero+this.index,this.zero+this.index+T);return this.index+=T,S},me.exports=B},{"../utils":32,"./DataReader":18}],21:[function(X,me,L){"use strict";var w=X("./ArrayReader");function B(T){w.call(this,T)}X("../utils").inherits(B,w),B.prototype.readData=function(T){if(this.checkOffset(T),0===T)return new Uint8Array(0);var S=this.data.subarray(this.zero+this.index,this.zero+this.index+T);return this.index+=T,S},me.exports=B},{"../utils":32,"./ArrayReader":17}],22:[function(X,me,L){"use strict";var w=X("../utils"),B=X("../support"),T=X("./ArrayReader"),S=X("./StringReader"),P=X("./NodeBufferReader"),O=X("./Uint8ArrayReader");me.exports=function(j){var A=w.getTypeOf(j);return w.checkSupport(A),"string"!==A||B.uint8array?"nodebuffer"===A?new P(j):B.uint8array?new O(w.transformTo("uint8array",j)):new T(w.transformTo("array",j)):new S(j)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(X,me,L){"use strict";L.LOCAL_FILE_HEADER="PK\x03\x04",L.CENTRAL_FILE_HEADER="PK\x01\x02",L.CENTRAL_DIRECTORY_END="PK\x05\x06",L.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",L.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",L.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(X,me,L){"use strict";var w=X("./GenericWorker"),B=X("../utils");function T(S){w.call(this,"ConvertWorker to "+S),this.destType=S}B.inherits(T,w),T.prototype.processChunk=function(S){this.push({data:B.transformTo(this.destType,S.data),meta:S.meta})},me.exports=T},{"../utils":32,"./GenericWorker":28}],25:[function(X,me,L){"use strict";var w=X("./GenericWorker"),B=X("../crc32");function T(){w.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}X("../utils").inherits(T,w),T.prototype.processChunk=function(S){this.streamInfo.crc32=B(S.data,this.streamInfo.crc32||0),this.push(S)},me.exports=T},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(X,me,L){"use strict";var w=X("../utils"),B=X("./GenericWorker");function T(S){B.call(this,"DataLengthProbe for "+S),this.propName=S,this.withStreamInfo(S,0)}w.inherits(T,B),T.prototype.processChunk=function(S){S&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+S.data.length),B.prototype.processChunk.call(this,S)},me.exports=T},{"../utils":32,"./GenericWorker":28}],27:[function(X,me,L){"use strict";var w=X("../utils"),B=X("./GenericWorker");function T(S){B.call(this,"DataWorker");var P=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,S.then(function(O){P.dataIsReady=!0,P.data=O,P.max=O&&O.length||0,P.type=w.getTypeOf(O),P.isPaused||P._tickAndRepeat()},function(O){P.error(O)})}w.inherits(T,B),T.prototype.cleanUp=function(){B.prototype.cleanUp.call(this),this.data=null},T.prototype.resume=function(){return!!B.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,w.delay(this._tickAndRepeat,[],this)),!0)},T.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(w.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},T.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var S=null,P=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":S=this.data.substring(this.index,P);break;case"uint8array":S=this.data.subarray(this.index,P);break;case"array":case"nodebuffer":S=this.data.slice(this.index,P)}return this.index=P,this.push({data:S,meta:{percent:this.max?this.index/this.max*100:0}})},me.exports=T},{"../utils":32,"./GenericWorker":28}],28:[function(X,me,L){"use strict";function w(B){this.name=B||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}w.prototype={push:function(B){this.emit("data",B)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(B){this.emit("error",B)}return!0},error:function(B){return!this.isFinished&&(this.isPaused?this.generatedError=B:(this.isFinished=!0,this.emit("error",B),this.previous&&this.previous.error(B),this.cleanUp()),!0)},on:function(B,T){return this._listeners[B].push(T),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(B,T){if(this._listeners[B])for(var S=0;S<this._listeners[B].length;S++)this._listeners[B][S].call(this,T)},pipe:function(B){return B.registerPrevious(this)},registerPrevious:function(B){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=B.streamInfo,this.mergeStreamInfo(),this.previous=B;var T=this;return B.on("data",function(S){T.processChunk(S)}),B.on("end",function(){T.end()}),B.on("error",function(S){T.error(S)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var B=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),B=!0),this.previous&&this.previous.resume(),!B},flush:function(){},processChunk:function(B){this.push(B)},withStreamInfo:function(B,T){return this.extraStreamInfo[B]=T,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var B in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,B)&&(this.streamInfo[B]=this.extraStreamInfo[B])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var B="Worker "+this.name;return this.previous?this.previous+" -> "+B:B}},me.exports=w},{}],29:[function(X,me,L){"use strict";var w=X("../utils"),B=X("./ConvertWorker"),T=X("./GenericWorker"),S=X("../base64"),P=X("../support"),O=X("../external"),j=null;if(P.nodestream)try{j=X("../nodejs/NodejsStreamOutputAdapter")}catch{}function E(D,k,z){var N=k;switch(k){case"blob":case"arraybuffer":N="uint8array";break;case"base64":N="string"}try{this._internalType=N,this._outputType=k,this._mimeType=z,w.checkSupport(N),this._worker=D.pipe(new B(N)),D.lock()}catch(Q){this._worker=new T("error"),this._worker.error(Q)}}E.prototype={accumulate:function(D){return function A(D,k){return new O.Promise(function(z,N){var Q=[],de=D._internalType,we=D._outputType,J=D._mimeType;D.on("data",function(ae,te){Q.push(ae),k&&k(te)}).on("error",function(ae){Q=[],N(ae)}).on("end",function(){try{var ae=function(te,ce,_e){switch(te){case"blob":return w.newBlob(w.transformTo("arraybuffer",ce),_e);case"base64":return S.encode(ce);default:return w.transformTo(te,ce)}}(we,function(te,ce){var _e,ue=0,Qe=null,pe=0;for(_e=0;_e<ce.length;_e++)pe+=ce[_e].length;switch(te){case"string":return ce.join("");case"array":return Array.prototype.concat.apply([],ce);case"uint8array":for(Qe=new Uint8Array(pe),_e=0;_e<ce.length;_e++)Qe.set(ce[_e],ue),ue+=ce[_e].length;return Qe;case"nodebuffer":return Buffer.concat(ce);default:throw new Error("concat : unsupported type '"+te+"'")}}(de,Q),J);z(ae)}catch(te){N(te)}Q=[]}).resume()})}(this,D)},on:function(D,k){var z=this;return this._worker.on(D,"data"===D?function(N){k.call(z,N.data,N.meta)}:function(){w.delay(k,arguments,z)}),this},resume:function(){return w.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(D){if(w.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new j(this,{objectMode:"nodebuffer"!==this._outputType},D)}},me.exports=E},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(X,me,L){"use strict";if(L.base64=!0,L.array=!0,L.string=!0,L.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",L.nodebuffer=typeof Buffer<"u",L.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")L.blob=!1;else{var w=new ArrayBuffer(0);try{L.blob=0===new Blob([w],{type:"application/zip"}).size}catch{try{var B=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);B.append(w),L.blob=0===B.getBlob("application/zip").size}catch{L.blob=!1}}}try{L.nodestream=!!X("readable-stream").Readable}catch{L.nodestream=!1}},{"readable-stream":16}],31:[function(X,me,L){"use strict";for(var w=X("./utils"),B=X("./support"),T=X("./nodejsUtils"),S=X("./stream/GenericWorker"),P=new Array(256),O=0;O<256;O++)P[O]=252<=O?6:248<=O?5:240<=O?4:224<=O?3:192<=O?2:1;function j(){S.call(this,"utf-8 decode"),this.leftOver=null}function A(){S.call(this,"utf-8 encode")}P[254]=P[254]=1,L.utf8encode=function(E){return B.nodebuffer?T.newBufferFrom(E,"utf-8"):function(D){var k,z,N,Q,de,we=D.length,J=0;for(Q=0;Q<we;Q++)55296==(64512&(z=D.charCodeAt(Q)))&&Q+1<we&&56320==(64512&(N=D.charCodeAt(Q+1)))&&(z=65536+(z-55296<<10)+(N-56320),Q++),J+=z<128?1:z<2048?2:z<65536?3:4;for(k=B.uint8array?new Uint8Array(J):new Array(J),Q=de=0;de<J;Q++)55296==(64512&(z=D.charCodeAt(Q)))&&Q+1<we&&56320==(64512&(N=D.charCodeAt(Q+1)))&&(z=65536+(z-55296<<10)+(N-56320),Q++),z<128?k[de++]=z:(z<2048?k[de++]=192|z>>>6:(z<65536?k[de++]=224|z>>>12:(k[de++]=240|z>>>18,k[de++]=128|z>>>12&63),k[de++]=128|z>>>6&63),k[de++]=128|63&z);return k}(E)},L.utf8decode=function(E){return B.nodebuffer?w.transformTo("nodebuffer",E).toString("utf-8"):function(D){var k,z,N,Q,de=D.length,we=new Array(2*de);for(k=z=0;k<de;)if((N=D[k++])<128)we[z++]=N;else if(4<(Q=P[N]))we[z++]=65533,k+=Q-1;else{for(N&=2===Q?31:3===Q?15:7;1<Q&&k<de;)N=N<<6|63&D[k++],Q--;1<Q?we[z++]=65533:N<65536?we[z++]=N:(we[z++]=55296|(N-=65536)>>10&1023,we[z++]=56320|1023&N)}return we.length!==z&&(we.subarray?we=we.subarray(0,z):we.length=z),w.applyFromCharCode(we)}(E=w.transformTo(B.uint8array?"uint8array":"array",E))},w.inherits(j,S),j.prototype.processChunk=function(E){var D=w.transformTo(B.uint8array?"uint8array":"array",E.data);if(this.leftOver&&this.leftOver.length){if(B.uint8array){var k=D;(D=new Uint8Array(k.length+this.leftOver.length)).set(this.leftOver,0),D.set(k,this.leftOver.length)}else D=this.leftOver.concat(D);this.leftOver=null}var z=function(Q,de){var we;for((de=de||Q.length)>Q.length&&(de=Q.length),we=de-1;0<=we&&128==(192&Q[we]);)we--;return we<0||0===we?de:we+P[Q[we]]>de?we:de}(D),N=D;z!==D.length&&(B.uint8array?(N=D.subarray(0,z),this.leftOver=D.subarray(z,D.length)):(N=D.slice(0,z),this.leftOver=D.slice(z,D.length))),this.push({data:L.utf8decode(N),meta:E.meta})},j.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:L.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},L.Utf8DecodeWorker=j,w.inherits(A,S),A.prototype.processChunk=function(E){this.push({data:L.utf8encode(E.data),meta:E.meta})},L.Utf8EncodeWorker=A},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(X,me,L){"use strict";var w=X("./support"),B=X("./base64"),T=X("./nodejsUtils"),S=X("./external");function P(k){return k}function O(k,z){for(var N=0;N<k.length;++N)z[N]=255&k.charCodeAt(N);return z}X("setimmediate"),L.newBlob=function(k,z){L.checkSupport("blob");try{return new Blob([k],{type:z})}catch{try{var N=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return N.append(k),N.getBlob(z)}catch{throw new Error("Bug : can't construct the Blob.")}}};var j={stringifyByChunk:function(k,z,N){var Q=[],de=0,we=k.length;if(we<=N)return String.fromCharCode.apply(null,k);for(;de<we;)Q.push(String.fromCharCode.apply(null,"array"===z||"nodebuffer"===z?k.slice(de,Math.min(de+N,we)):k.subarray(de,Math.min(de+N,we)))),de+=N;return Q.join("")},stringifyByChar:function(k){for(var z="",N=0;N<k.length;N++)z+=String.fromCharCode(k[N]);return z},applyCanBeUsed:{uint8array:function(){try{return w.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch{return!1}}(),nodebuffer:function(){try{return w.nodebuffer&&1===String.fromCharCode.apply(null,T.allocBuffer(1)).length}catch{return!1}}()}};function A(k){var z=65536,N=L.getTypeOf(k),Q=!0;if("uint8array"===N?Q=j.applyCanBeUsed.uint8array:"nodebuffer"===N&&(Q=j.applyCanBeUsed.nodebuffer),Q)for(;1<z;)try{return j.stringifyByChunk(k,N,z)}catch{z=Math.floor(z/2)}return j.stringifyByChar(k)}function E(k,z){for(var N=0;N<k.length;N++)z[N]=k[N];return z}L.applyFromCharCode=A;var D={};D.string={string:P,array:function(k){return O(k,new Array(k.length))},arraybuffer:function(k){return D.string.uint8array(k).buffer},uint8array:function(k){return O(k,new Uint8Array(k.length))},nodebuffer:function(k){return O(k,T.allocBuffer(k.length))}},D.array={string:A,array:P,arraybuffer:function(k){return new Uint8Array(k).buffer},uint8array:function(k){return new Uint8Array(k)},nodebuffer:function(k){return T.newBufferFrom(k)}},D.arraybuffer={string:function(k){return A(new Uint8Array(k))},array:function(k){return E(new Uint8Array(k),new Array(k.byteLength))},arraybuffer:P,uint8array:function(k){return new Uint8Array(k)},nodebuffer:function(k){return T.newBufferFrom(new Uint8Array(k))}},D.uint8array={string:A,array:function(k){return E(k,new Array(k.length))},arraybuffer:function(k){return k.buffer},uint8array:P,nodebuffer:function(k){return T.newBufferFrom(k)}},D.nodebuffer={string:A,array:function(k){return E(k,new Array(k.length))},arraybuffer:function(k){return D.nodebuffer.uint8array(k).buffer},uint8array:function(k){return E(k,new Uint8Array(k.length))},nodebuffer:P},L.transformTo=function(k,z){if(z=z||"",!k)return z;L.checkSupport(k);var N=L.getTypeOf(z);return D[N][k](z)},L.resolve=function(k){for(var z=k.split("/"),N=[],Q=0;Q<z.length;Q++){var de=z[Q];"."===de||""===de&&0!==Q&&Q!==z.length-1||(".."===de?N.pop():N.push(de))}return N.join("/")},L.getTypeOf=function(k){return"string"==typeof k?"string":"[object Array]"===Object.prototype.toString.call(k)?"array":w.nodebuffer&&T.isBuffer(k)?"nodebuffer":w.uint8array&&k instanceof Uint8Array?"uint8array":w.arraybuffer&&k instanceof ArrayBuffer?"arraybuffer":void 0},L.checkSupport=function(k){if(!w[k.toLowerCase()])throw new Error(k+" is not supported by this platform")},L.MAX_VALUE_16BITS=65535,L.MAX_VALUE_32BITS=-1,L.pretty=function(k){var z,N,Q="";for(N=0;N<(k||"").length;N++)Q+="\\x"+((z=k.charCodeAt(N))<16?"0":"")+z.toString(16).toUpperCase();return Q},L.delay=function(k,z,N){setImmediate(function(){k.apply(N||null,z||[])})},L.inherits=function(k,z){function N(){}N.prototype=z.prototype,k.prototype=new N},L.extend=function(){var k,z,N={};for(k=0;k<arguments.length;k++)for(z in arguments[k])Object.prototype.hasOwnProperty.call(arguments[k],z)&&void 0===N[z]&&(N[z]=arguments[k][z]);return N},L.prepareContent=function(k,z,N,Q,de){return S.Promise.resolve(z).then(function(we){return w.blob&&(we instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(we)))&&typeof FileReader<"u"?new S.Promise(function(J,ae){var te=new FileReader;te.onload=function(ce){J(ce.target.result)},te.onerror=function(ce){ae(ce.target.error)},te.readAsArrayBuffer(we)}):we}).then(function(we){var ae,J=L.getTypeOf(we);return J?("arraybuffer"===J?we=L.transformTo("uint8array",we):"string"===J&&(de?we=B.decode(we):N&&!0!==Q&&(we=O(ae=we,w.uint8array?new Uint8Array(ae.length):new Array(ae.length)))),we):S.Promise.reject(new Error("Can't read the data of '"+k+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(X,me,L){"use strict";var w=X("./reader/readerFor"),B=X("./utils"),T=X("./signature"),S=X("./zipEntry"),P=X("./support");function O(j){this.files=[],this.loadOptions=j}O.prototype={checkSignature:function(j){if(!this.reader.readAndCheckSignature(j)){this.reader.index-=4;var A=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+B.pretty(A)+", expected "+B.pretty(j)+")")}},isSignature:function(j,A){var E=this.reader.index;this.reader.setIndex(j);var D=this.reader.readString(4)===A;return this.reader.setIndex(E),D},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var j=this.reader.readData(this.zipCommentLength),E=B.transformTo(P.uint8array?"uint8array":"array",j);this.zipComment=this.loadOptions.decodeFileName(E)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var j,A,E,D=this.zip64EndOfCentralSize-44;0<D;)j=this.reader.readInt(2),A=this.reader.readInt(4),E=this.reader.readData(A),this.zip64ExtensibleData[j]={id:j,length:A,value:E}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var j,A;for(j=0;j<this.files.length;j++)this.reader.setIndex((A=this.files[j]).localHeaderOffset),this.checkSignature(T.LOCAL_FILE_HEADER),A.readLocalPart(this.reader),A.handleUTF8(),A.processAttributes()},readCentralDir:function(){var j;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(T.CENTRAL_FILE_HEADER);)(j=new S({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(j);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var j=this.reader.lastIndexOfSignature(T.CENTRAL_DIRECTORY_END);if(j<0)throw this.isSignature(0,T.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(j);var A=j;if(this.checkSignature(T.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===B.MAX_VALUE_16BITS||this.diskWithCentralDirStart===B.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===B.MAX_VALUE_16BITS||this.centralDirRecords===B.MAX_VALUE_16BITS||this.centralDirSize===B.MAX_VALUE_32BITS||this.centralDirOffset===B.MAX_VALUE_32BITS){if(this.zip64=!0,(j=this.reader.lastIndexOfSignature(T.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(j),this.checkSignature(T.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,T.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(T.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(T.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var E=this.centralDirOffset+this.centralDirSize;this.zip64&&(E+=20,E+=12+this.zip64EndOfCentralSize);var D=A-E;if(0<D)this.isSignature(A,T.CENTRAL_FILE_HEADER)||(this.reader.zero=D);else if(D<0)throw new Error("Corrupted zip: missing "+Math.abs(D)+" bytes.")},prepareReader:function(j){this.reader=w(j)},load:function(j){this.prepareReader(j),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},me.exports=O},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(X,me,L){"use strict";var w=X("./reader/readerFor"),B=X("./utils"),T=X("./compressedObject"),S=X("./crc32"),P=X("./utf8"),O=X("./compressions"),j=X("./support");function A(E,D){this.options=E,this.loadOptions=D}A.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},readLocalPart:function(E){var D,k;if(E.skip(22),this.fileNameLength=E.readInt(2),k=E.readInt(2),this.fileName=E.readData(this.fileNameLength),E.skip(k),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(D=function(z){for(var N in O)if(Object.prototype.hasOwnProperty.call(O,N)&&O[N].magic===z)return O[N];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+B.pretty(this.compressionMethod)+" unknown (inner file : "+B.transformTo("string",this.fileName)+")");this.decompressed=new T(this.compressedSize,this.uncompressedSize,this.crc32,D,E.readData(this.compressedSize))},readCentralPart:function(E){this.versionMadeBy=E.readInt(2),E.skip(2),this.bitFlag=E.readInt(2),this.compressionMethod=E.readString(2),this.date=E.readDate(),this.crc32=E.readInt(4),this.compressedSize=E.readInt(4),this.uncompressedSize=E.readInt(4);var D=E.readInt(2);if(this.extraFieldsLength=E.readInt(2),this.fileCommentLength=E.readInt(2),this.diskNumberStart=E.readInt(2),this.internalFileAttributes=E.readInt(2),this.externalFileAttributes=E.readInt(4),this.localHeaderOffset=E.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");E.skip(D),this.readExtraFields(E),this.parseZIP64ExtraField(E),this.fileComment=E.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var E=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==E&&(this.dosPermissions=63&this.externalFileAttributes),3==E&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var E=w(this.extraFields[1].value);this.uncompressedSize===B.MAX_VALUE_32BITS&&(this.uncompressedSize=E.readInt(8)),this.compressedSize===B.MAX_VALUE_32BITS&&(this.compressedSize=E.readInt(8)),this.localHeaderOffset===B.MAX_VALUE_32BITS&&(this.localHeaderOffset=E.readInt(8)),this.diskNumberStart===B.MAX_VALUE_32BITS&&(this.diskNumberStart=E.readInt(4))}},readExtraFields:function(E){var D,k,z,N=E.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});E.index+4<N;)D=E.readInt(2),k=E.readInt(2),z=E.readData(k),this.extraFields[D]={id:D,length:k,value:z};E.setIndex(N)},handleUTF8:function(){var E=j.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=P.utf8decode(this.fileName),this.fileCommentStr=P.utf8decode(this.fileComment);else{var D=this.findExtraFieldUnicodePath();if(null!==D)this.fileNameStr=D;else{var k=B.transformTo(E,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(k)}var z=this.findExtraFieldUnicodeComment();if(null!==z)this.fileCommentStr=z;else{var N=B.transformTo(E,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(N)}}},findExtraFieldUnicodePath:function(){var E=this.extraFields[28789];if(E){var D=w(E.value);return 1!==D.readInt(1)||S(this.fileName)!==D.readInt(4)?null:P.utf8decode(D.readData(E.length-5))}return null},findExtraFieldUnicodeComment:function(){var E=this.extraFields[25461];if(E){var D=w(E.value);return 1!==D.readInt(1)||S(this.fileComment)!==D.readInt(4)?null:P.utf8decode(D.readData(E.length-5))}return null}},me.exports=A},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(X,me,L){"use strict";function w(D,k,z){this.name=D,this.dir=z.dir,this.date=z.date,this.comment=z.comment,this.unixPermissions=z.unixPermissions,this.dosPermissions=z.dosPermissions,this._data=k,this._dataBinary=z.binary,this.options={compression:z.compression,compressionOptions:z.compressionOptions}}var B=X("./stream/StreamHelper"),T=X("./stream/DataWorker"),S=X("./utf8"),P=X("./compressedObject"),O=X("./stream/GenericWorker");w.prototype={internalStream:function(D){var k=null,z="string";try{if(!D)throw new Error("No output type specified.");var N="string"===(z=D.toLowerCase())||"text"===z;"binarystring"!==z&&"text"!==z||(z="string"),k=this._decompressWorker();var Q=!this._dataBinary;Q&&!N&&(k=k.pipe(new S.Utf8EncodeWorker)),!Q&&N&&(k=k.pipe(new S.Utf8DecodeWorker))}catch(de){(k=new O("error")).error(de)}return new B(k,z,"")},async:function(D,k){return this.internalStream(D).accumulate(k)},nodeStream:function(D,k){return this.internalStream(D||"nodebuffer").toNodejsStream(k)},_compressWorker:function(D,k){if(this._data instanceof P&&this._data.compression.magic===D.magic)return this._data.getCompressedWorker();var z=this._decompressWorker();return this._dataBinary||(z=z.pipe(new S.Utf8EncodeWorker)),P.createWorkerFrom(z,D,k)},_decompressWorker:function(){return this._data instanceof P?this._data.getContentWorker():this._data instanceof O?this._data:new T(this._data)}};for(var j=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],A=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},E=0;E<j.length;E++)w.prototype[j[E]]=A;me.exports=w},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(X,me,L){(function(w){"use strict";var B,T,S=w.MutationObserver||w.WebKitMutationObserver;if(S){var P=0,O=new S(D),j=w.document.createTextNode("");O.observe(j,{characterData:!0}),B=function(){j.data=P=++P%2}}else if(w.setImmediate||void 0===w.MessageChannel)B="document"in w&&"onreadystatechange"in w.document.createElement("script")?function(){var k=w.document.createElement("script");k.onreadystatechange=function(){D(),k.onreadystatechange=null,k.parentNode.removeChild(k),k=null},w.document.documentElement.appendChild(k)}:function(){setTimeout(D,0)};else{var A=new w.MessageChannel;A.port1.onmessage=D,B=function(){A.port2.postMessage(0)}}var E=[];function D(){var k,z;T=!0;for(var N=E.length;N;){for(z=E,E=[],k=-1;++k<N;)z[k]();N=E.length}T=!1}me.exports=function(k){1!==E.push(k)||T||B()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(X,me,L){"use strict";var w=X("immediate");function B(){}var T={},S=["REJECTED"],P=["FULFILLED"],O=["PENDING"];function j(N){if("function"!=typeof N)throw new TypeError("resolver must be a function");this.state=O,this.queue=[],this.outcome=void 0,N!==B&&k(this,N)}function A(N,Q,de){this.promise=N,"function"==typeof Q&&(this.onFulfilled=Q,this.callFulfilled=this.otherCallFulfilled),"function"==typeof de&&(this.onRejected=de,this.callRejected=this.otherCallRejected)}function E(N,Q,de){w(function(){var we;try{we=Q(de)}catch(J){return T.reject(N,J)}we===N?T.reject(N,new TypeError("Cannot resolve promise with itself")):T.resolve(N,we)})}function D(N){var Q=N&&N.then;if(N&&("object"==typeof N||"function"==typeof N)&&"function"==typeof Q)return function(){Q.apply(N,arguments)}}function k(N,Q){var de=!1;function we(te){de||(de=!0,T.reject(N,te))}function J(te){de||(de=!0,T.resolve(N,te))}var ae=z(function(){Q(J,we)});"error"===ae.status&&we(ae.value)}function z(N,Q){var de={};try{de.value=N(Q),de.status="success"}catch(we){de.status="error",de.value=we}return de}(me.exports=j).prototype.finally=function(N){if("function"!=typeof N)return this;var Q=this.constructor;return this.then(function(de){return Q.resolve(N()).then(function(){return de})},function(de){return Q.resolve(N()).then(function(){throw de})})},j.prototype.catch=function(N){return this.then(null,N)},j.prototype.then=function(N,Q){if("function"!=typeof N&&this.state===P||"function"!=typeof Q&&this.state===S)return this;var de=new this.constructor(B);return this.state!==O?E(de,this.state===P?N:Q,this.outcome):this.queue.push(new A(de,N,Q)),de},A.prototype.callFulfilled=function(N){T.resolve(this.promise,N)},A.prototype.otherCallFulfilled=function(N){E(this.promise,this.onFulfilled,N)},A.prototype.callRejected=function(N){T.reject(this.promise,N)},A.prototype.otherCallRejected=function(N){E(this.promise,this.onRejected,N)},T.resolve=function(N,Q){var de=z(D,Q);if("error"===de.status)return T.reject(N,de.value);var we=de.value;if(we)k(N,we);else{N.state=P,N.outcome=Q;for(var J=-1,ae=N.queue.length;++J<ae;)N.queue[J].callFulfilled(Q)}return N},T.reject=function(N,Q){N.state=S,N.outcome=Q;for(var de=-1,we=N.queue.length;++de<we;)N.queue[de].callRejected(Q);return N},j.resolve=function(N){return N instanceof this?N:T.resolve(new this(B),N)},j.reject=function(N){var Q=new this(B);return T.reject(Q,N)},j.all=function(N){var Q=this;if("[object Array]"!==Object.prototype.toString.call(N))return this.reject(new TypeError("must be an array"));var de=N.length,we=!1;if(!de)return this.resolve([]);for(var J=new Array(de),ae=0,te=-1,ce=new this(B);++te<de;)_e(N[te],te);return ce;function _e(ue,Qe){Q.resolve(ue).then(function(pe){J[Qe]=pe,++ae!==de||we||(we=!0,T.resolve(ce,J))},function(pe){we||(we=!0,T.reject(ce,pe))})}},j.race=function(N){if("[object Array]"!==Object.prototype.toString.call(N))return this.reject(new TypeError("must be an array"));var de=N.length,we=!1;if(!de)return this.resolve([]);for(var J=-1,ae=new this(B);++J<de;)this.resolve(N[J]).then(function(ce){we||(we=!0,T.resolve(ae,ce))},function(ce){we||(we=!0,T.reject(ae,ce))});return ae}},{immediate:36}],38:[function(X,me,L){"use strict";var w={};(0,X("./lib/utils/common").assign)(w,X("./lib/deflate"),X("./lib/inflate"),X("./lib/zlib/constants")),me.exports=w},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(X,me,L){"use strict";var w=X("./zlib/deflate"),B=X("./utils/common"),T=X("./utils/strings"),S=X("./zlib/messages"),P=X("./zlib/zstream"),O=Object.prototype.toString,j=0,A=-1,E=0,D=8;function k(N){if(!(this instanceof k))return new k(N);this.options=B.assign({level:A,method:D,chunkSize:16384,windowBits:15,memLevel:8,strategy:E,to:""},N||{});var Q=this.options;Q.raw&&0<Q.windowBits?Q.windowBits=-Q.windowBits:Q.gzip&&0<Q.windowBits&&Q.windowBits<16&&(Q.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new P,this.strm.avail_out=0;var de=w.deflateInit2(this.strm,Q.level,Q.method,Q.windowBits,Q.memLevel,Q.strategy);if(de!==j)throw new Error(S[de]);if(Q.header&&w.deflateSetHeader(this.strm,Q.header),Q.dictionary){var we;if(we="string"==typeof Q.dictionary?T.string2buf(Q.dictionary):"[object ArrayBuffer]"===O.call(Q.dictionary)?new Uint8Array(Q.dictionary):Q.dictionary,(de=w.deflateSetDictionary(this.strm,we))!==j)throw new Error(S[de]);this._dict_set=!0}}function z(N,Q){var de=new k(Q);if(de.push(N,!0),de.err)throw de.msg||S[de.err];return de.result}k.prototype.push=function(N,Q){var de,we,J=this.strm,ae=this.options.chunkSize;if(this.ended)return!1;we=Q===~~Q?Q:!0===Q?4:0,J.input="string"==typeof N?T.string2buf(N):"[object ArrayBuffer]"===O.call(N)?new Uint8Array(N):N,J.next_in=0,J.avail_in=J.input.length;do{if(0===J.avail_out&&(J.output=new B.Buf8(ae),J.next_out=0,J.avail_out=ae),1!==(de=w.deflate(J,we))&&de!==j)return this.onEnd(de),!(this.ended=!0);0!==J.avail_out&&(0!==J.avail_in||4!==we&&2!==we)||this.onData("string"===this.options.to?T.buf2binstring(B.shrinkBuf(J.output,J.next_out)):B.shrinkBuf(J.output,J.next_out))}while((0<J.avail_in||0===J.avail_out)&&1!==de);return 4===we?(de=w.deflateEnd(this.strm),this.onEnd(de),this.ended=!0,de===j):2!==we||(this.onEnd(j),!(J.avail_out=0))},k.prototype.onData=function(N){this.chunks.push(N)},k.prototype.onEnd=function(N){N===j&&(this.result="string"===this.options.to?this.chunks.join(""):B.flattenChunks(this.chunks)),this.chunks=[],this.err=N,this.msg=this.strm.msg},L.Deflate=k,L.deflate=z,L.deflateRaw=function(N,Q){return(Q=Q||{}).raw=!0,z(N,Q)},L.gzip=function(N,Q){return(Q=Q||{}).gzip=!0,z(N,Q)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(X,me,L){"use strict";var w=X("./zlib/inflate"),B=X("./utils/common"),T=X("./utils/strings"),S=X("./zlib/constants"),P=X("./zlib/messages"),O=X("./zlib/zstream"),j=X("./zlib/gzheader"),A=Object.prototype.toString;function E(k){if(!(this instanceof E))return new E(k);this.options=B.assign({chunkSize:16384,windowBits:0,to:""},k||{});var z=this.options;z.raw&&0<=z.windowBits&&z.windowBits<16&&(z.windowBits=-z.windowBits,0===z.windowBits&&(z.windowBits=-15)),!(0<=z.windowBits&&z.windowBits<16)||k&&k.windowBits||(z.windowBits+=32),15<z.windowBits&&z.windowBits<48&&!(15&z.windowBits)&&(z.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new O,this.strm.avail_out=0;var N=w.inflateInit2(this.strm,z.windowBits);if(N!==S.Z_OK)throw new Error(P[N]);this.header=new j,w.inflateGetHeader(this.strm,this.header)}function D(k,z){var N=new E(z);if(N.push(k,!0),N.err)throw N.msg||P[N.err];return N.result}E.prototype.push=function(k,z){var N,Q,de,we,J,ae,te=this.strm,ce=this.options.chunkSize,_e=this.options.dictionary,ue=!1;if(this.ended)return!1;Q=z===~~z?z:!0===z?S.Z_FINISH:S.Z_NO_FLUSH,te.input="string"==typeof k?T.binstring2buf(k):"[object ArrayBuffer]"===A.call(k)?new Uint8Array(k):k,te.next_in=0,te.avail_in=te.input.length;do{if(0===te.avail_out&&(te.output=new B.Buf8(ce),te.next_out=0,te.avail_out=ce),(N=w.inflate(te,S.Z_NO_FLUSH))===S.Z_NEED_DICT&&_e&&(ae="string"==typeof _e?T.string2buf(_e):"[object ArrayBuffer]"===A.call(_e)?new Uint8Array(_e):_e,N=w.inflateSetDictionary(this.strm,ae)),N===S.Z_BUF_ERROR&&!0===ue&&(N=S.Z_OK,ue=!1),N!==S.Z_STREAM_END&&N!==S.Z_OK)return this.onEnd(N),!(this.ended=!0);te.next_out&&(0!==te.avail_out&&N!==S.Z_STREAM_END&&(0!==te.avail_in||Q!==S.Z_FINISH&&Q!==S.Z_SYNC_FLUSH)||("string"===this.options.to?(de=T.utf8border(te.output,te.next_out),we=te.next_out-de,J=T.buf2string(te.output,de),te.next_out=we,te.avail_out=ce-we,we&&B.arraySet(te.output,te.output,de,we,0),this.onData(J)):this.onData(B.shrinkBuf(te.output,te.next_out)))),0===te.avail_in&&0===te.avail_out&&(ue=!0)}while((0<te.avail_in||0===te.avail_out)&&N!==S.Z_STREAM_END);return N===S.Z_STREAM_END&&(Q=S.Z_FINISH),Q===S.Z_FINISH?(N=w.inflateEnd(this.strm),this.onEnd(N),this.ended=!0,N===S.Z_OK):Q!==S.Z_SYNC_FLUSH||(this.onEnd(S.Z_OK),!(te.avail_out=0))},E.prototype.onData=function(k){this.chunks.push(k)},E.prototype.onEnd=function(k){k===S.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):B.flattenChunks(this.chunks)),this.chunks=[],this.err=k,this.msg=this.strm.msg},L.Inflate=E,L.inflate=D,L.inflateRaw=function(k,z){return(z=z||{}).raw=!0,D(k,z)},L.ungzip=D},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(X,me,L){"use strict";var w=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";L.assign=function(S){for(var P=Array.prototype.slice.call(arguments,1);P.length;){var O=P.shift();if(O){if("object"!=typeof O)throw new TypeError(O+"must be non-object");for(var j in O)O.hasOwnProperty(j)&&(S[j]=O[j])}}return S},L.shrinkBuf=function(S,P){return S.length===P?S:S.subarray?S.subarray(0,P):(S.length=P,S)};var B={arraySet:function(S,P,O,j,A){if(P.subarray&&S.subarray)S.set(P.subarray(O,O+j),A);else for(var E=0;E<j;E++)S[A+E]=P[O+E]},flattenChunks:function(S){var P,O,j,A,E,D;for(P=j=0,O=S.length;P<O;P++)j+=S[P].length;for(D=new Uint8Array(j),P=A=0,O=S.length;P<O;P++)D.set(E=S[P],A),A+=E.length;return D}},T={arraySet:function(S,P,O,j,A){for(var E=0;E<j;E++)S[A+E]=P[O+E]},flattenChunks:function(S){return[].concat.apply([],S)}};L.setTyped=function(S){S?(L.Buf8=Uint8Array,L.Buf16=Uint16Array,L.Buf32=Int32Array,L.assign(L,B)):(L.Buf8=Array,L.Buf16=Array,L.Buf32=Array,L.assign(L,T))},L.setTyped(w)},{}],42:[function(X,me,L){"use strict";var w=X("./common"),B=!0,T=!0;try{String.fromCharCode.apply(null,[0])}catch{B=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{T=!1}for(var S=new w.Buf8(256),P=0;P<256;P++)S[P]=252<=P?6:248<=P?5:240<=P?4:224<=P?3:192<=P?2:1;function O(j,A){if(A<65537&&(j.subarray&&T||!j.subarray&&B))return String.fromCharCode.apply(null,w.shrinkBuf(j,A));for(var E="",D=0;D<A;D++)E+=String.fromCharCode(j[D]);return E}S[254]=S[254]=1,L.string2buf=function(j){var A,E,D,k,z,N=j.length,Q=0;for(k=0;k<N;k++)55296==(64512&(E=j.charCodeAt(k)))&&k+1<N&&56320==(64512&(D=j.charCodeAt(k+1)))&&(E=65536+(E-55296<<10)+(D-56320),k++),Q+=E<128?1:E<2048?2:E<65536?3:4;for(A=new w.Buf8(Q),k=z=0;z<Q;k++)55296==(64512&(E=j.charCodeAt(k)))&&k+1<N&&56320==(64512&(D=j.charCodeAt(k+1)))&&(E=65536+(E-55296<<10)+(D-56320),k++),E<128?A[z++]=E:(E<2048?A[z++]=192|E>>>6:(E<65536?A[z++]=224|E>>>12:(A[z++]=240|E>>>18,A[z++]=128|E>>>12&63),A[z++]=128|E>>>6&63),A[z++]=128|63&E);return A},L.buf2binstring=function(j){return O(j,j.length)},L.binstring2buf=function(j){for(var A=new w.Buf8(j.length),E=0,D=A.length;E<D;E++)A[E]=j.charCodeAt(E);return A},L.buf2string=function(j,A){var E,D,k,z,N=A||j.length,Q=new Array(2*N);for(E=D=0;E<N;)if((k=j[E++])<128)Q[D++]=k;else if(4<(z=S[k]))Q[D++]=65533,E+=z-1;else{for(k&=2===z?31:3===z?15:7;1<z&&E<N;)k=k<<6|63&j[E++],z--;1<z?Q[D++]=65533:k<65536?Q[D++]=k:(Q[D++]=55296|(k-=65536)>>10&1023,Q[D++]=56320|1023&k)}return O(Q,D)},L.utf8border=function(j,A){var E;for((A=A||j.length)>j.length&&(A=j.length),E=A-1;0<=E&&128==(192&j[E]);)E--;return E<0||0===E?A:E+S[j[E]]>A?E:A}},{"./common":41}],43:[function(X,me,L){"use strict";me.exports=function(w,B,T,S){for(var P=65535&w,O=w>>>16&65535,j=0;0!==T;){for(T-=j=2e3<T?2e3:T;O=O+(P=P+B[S++]|0)|0,--j;);P%=65521,O%=65521}return P|O<<16}},{}],44:[function(X,me,L){"use strict";me.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(X,me,L){"use strict";var w=function(){for(var B,T=[],S=0;S<256;S++){B=S;for(var P=0;P<8;P++)B=1&B?3988292384^B>>>1:B>>>1;T[S]=B}return T}();me.exports=function(B,T,S,P){var O=w,j=P+S;B^=-1;for(var A=P;A<j;A++)B=B>>>8^O[255&(B^T[A])];return~B}},{}],46:[function(X,me,L){"use strict";var w,B=X("../utils/common"),T=X("./trees"),S=X("./adler32"),P=X("./crc32"),O=X("./messages"),j=0,E=0,D=-2,N=2,Q=8,we=286,J=30,ae=19,te=2*we+1,ce=15,_e=3,ue=258,Qe=ue+_e+1,pe=42,Se=113;function Ot(F,Ae){return F.msg=O[Ae],Ae}function ot(F){return(F<<1)-(4<F?9:0)}function Tt(F){for(var Ae=F.length;0<=--Ae;)F[Ae]=0}function Ze(F){var Ae=F.state,Re=Ae.pending;Re>F.avail_out&&(Re=F.avail_out),0!==Re&&(B.arraySet(F.output,Ae.pending_buf,Ae.pending_out,Re,F.next_out),F.next_out+=Re,Ae.pending_out+=Re,F.total_out+=Re,F.avail_out-=Re,Ae.pending-=Re,0===Ae.pending&&(Ae.pending_out=0))}function et(F,Ae){T._tr_flush_block(F,0<=F.block_start?F.block_start:-1,F.strstart-F.block_start,Ae),F.block_start=F.strstart,Ze(F.strm)}function tn(F,Ae){F.pending_buf[F.pending++]=Ae}function Rt(F,Ae){F.pending_buf[F.pending++]=Ae>>>8&255,F.pending_buf[F.pending++]=255&Ae}function qt(F,Ae){var Re,fe,se=F.max_chain_length,Ie=F.strstart,dt=F.prev_length,vt=F.nice_match,qe=F.strstart>F.w_size-Qe?F.strstart-(F.w_size-Qe):0,Mt=F.window,Ht=F.w_mask,Dt=F.prev,hn=F.strstart+ue,Ii=Mt[Ie+dt-1],jn=Mt[Ie+dt];F.prev_length>=F.good_match&&(se>>=2),vt>F.lookahead&&(vt=F.lookahead);do{if(Mt[(Re=Ae)+dt]===jn&&Mt[Re+dt-1]===Ii&&Mt[Re]===Mt[Ie]&&Mt[++Re]===Mt[Ie+1]){Ie+=2,Re++;do{}while(Mt[++Ie]===Mt[++Re]&&Mt[++Ie]===Mt[++Re]&&Mt[++Ie]===Mt[++Re]&&Mt[++Ie]===Mt[++Re]&&Mt[++Ie]===Mt[++Re]&&Mt[++Ie]===Mt[++Re]&&Mt[++Ie]===Mt[++Re]&&Mt[++Ie]===Mt[++Re]&&Ie<hn);if(fe=ue-(hn-Ie),Ie=hn-ue,dt<fe){if(F.match_start=Ae,vt<=(dt=fe))break;Ii=Mt[Ie+dt-1],jn=Mt[Ie+dt]}}}while((Ae=Dt[Ae&Ht])>qe&&0!=--se);return dt<=F.lookahead?dt:F.lookahead}function mi(F){var Ae,Re,fe,se,Ie,dt,vt,qe,Mt,Ht,Dt=F.w_size;do{if(se=F.window_size-F.lookahead-F.strstart,F.strstart>=Dt+(Dt-Qe)){for(B.arraySet(F.window,F.window,Dt,Dt,0),F.match_start-=Dt,F.strstart-=Dt,F.block_start-=Dt,Ae=Re=F.hash_size;fe=F.head[--Ae],F.head[Ae]=Dt<=fe?fe-Dt:0,--Re;);for(Ae=Re=Dt;fe=F.prev[--Ae],F.prev[Ae]=Dt<=fe?fe-Dt:0,--Re;);se+=Dt}if(0===F.strm.avail_in)break;if(vt=F.window,qe=F.strstart+F.lookahead,Ht=void 0,(Mt=se)<(Ht=(dt=F.strm).avail_in)&&(Ht=Mt),Re=0===Ht?0:(dt.avail_in-=Ht,B.arraySet(vt,dt.input,dt.next_in,Ht,qe),1===dt.state.wrap?dt.adler=S(dt.adler,vt,Ht,qe):2===dt.state.wrap&&(dt.adler=P(dt.adler,vt,Ht,qe)),dt.next_in+=Ht,dt.total_in+=Ht,Ht),F.lookahead+=Re,F.lookahead+F.insert>=_e)for(F.ins_h=F.window[Ie=F.strstart-F.insert],F.ins_h=(F.ins_h<<F.hash_shift^F.window[Ie+1])&F.hash_mask;F.insert&&(F.ins_h=(F.ins_h<<F.hash_shift^F.window[Ie+_e-1])&F.hash_mask,F.prev[Ie&F.w_mask]=F.head[F.ins_h],F.head[F.ins_h]=Ie,Ie++,F.insert--,!(F.lookahead+F.insert<_e)););}while(F.lookahead<Qe&&0!==F.strm.avail_in)}function $t(F,Ae){for(var Re,fe;;){if(F.lookahead<Qe){if(mi(F),F.lookahead<Qe&&Ae===j)return 1;if(0===F.lookahead)break}if(Re=0,F.lookahead>=_e&&(F.ins_h=(F.ins_h<<F.hash_shift^F.window[F.strstart+_e-1])&F.hash_mask,Re=F.prev[F.strstart&F.w_mask]=F.head[F.ins_h],F.head[F.ins_h]=F.strstart),0!==Re&&F.strstart-Re<=F.w_size-Qe&&(F.match_length=qt(F,Re)),F.match_length>=_e)if(fe=T._tr_tally(F,F.strstart-F.match_start,F.match_length-_e),F.lookahead-=F.match_length,F.match_length<=F.max_lazy_match&&F.lookahead>=_e){for(F.match_length--;F.strstart++,F.ins_h=(F.ins_h<<F.hash_shift^F.window[F.strstart+_e-1])&F.hash_mask,Re=F.prev[F.strstart&F.w_mask]=F.head[F.ins_h],F.head[F.ins_h]=F.strstart,0!=--F.match_length;);F.strstart++}else F.strstart+=F.match_length,F.match_length=0,F.ins_h=F.window[F.strstart],F.ins_h=(F.ins_h<<F.hash_shift^F.window[F.strstart+1])&F.hash_mask;else fe=T._tr_tally(F,0,F.window[F.strstart]),F.lookahead--,F.strstart++;if(fe&&(et(F,!1),0===F.strm.avail_out))return 1}return F.insert=F.strstart<_e-1?F.strstart:_e-1,4===Ae?(et(F,!0),0===F.strm.avail_out?3:4):F.last_lit&&(et(F,!1),0===F.strm.avail_out)?1:2}function At(F,Ae){for(var Re,fe,se;;){if(F.lookahead<Qe){if(mi(F),F.lookahead<Qe&&Ae===j)return 1;if(0===F.lookahead)break}if(Re=0,F.lookahead>=_e&&(F.ins_h=(F.ins_h<<F.hash_shift^F.window[F.strstart+_e-1])&F.hash_mask,Re=F.prev[F.strstart&F.w_mask]=F.head[F.ins_h],F.head[F.ins_h]=F.strstart),F.prev_length=F.match_length,F.prev_match=F.match_start,F.match_length=_e-1,0!==Re&&F.prev_length<F.max_lazy_match&&F.strstart-Re<=F.w_size-Qe&&(F.match_length=qt(F,Re),F.match_length<=5&&(1===F.strategy||F.match_length===_e&&4096<F.strstart-F.match_start)&&(F.match_length=_e-1)),F.prev_length>=_e&&F.match_length<=F.prev_length){for(se=F.strstart+F.lookahead-_e,fe=T._tr_tally(F,F.strstart-1-F.prev_match,F.prev_length-_e),F.lookahead-=F.prev_length-1,F.prev_length-=2;++F.strstart<=se&&(F.ins_h=(F.ins_h<<F.hash_shift^F.window[F.strstart+_e-1])&F.hash_mask,Re=F.prev[F.strstart&F.w_mask]=F.head[F.ins_h],F.head[F.ins_h]=F.strstart),0!=--F.prev_length;);if(F.match_available=0,F.match_length=_e-1,F.strstart++,fe&&(et(F,!1),0===F.strm.avail_out))return 1}else if(F.match_available){if((fe=T._tr_tally(F,0,F.window[F.strstart-1]))&&et(F,!1),F.strstart++,F.lookahead--,0===F.strm.avail_out)return 1}else F.match_available=1,F.strstart++,F.lookahead--}return F.match_available&&(fe=T._tr_tally(F,0,F.window[F.strstart-1]),F.match_available=0),F.insert=F.strstart<_e-1?F.strstart:_e-1,4===Ae?(et(F,!0),0===F.strm.avail_out?3:4):F.last_lit&&(et(F,!1),0===F.strm.avail_out)?1:2}function Lt(F,Ae,Re,fe,se){this.good_length=F,this.max_lazy=Ae,this.nice_length=Re,this.max_chain=fe,this.func=se}function Cn(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Q,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new B.Buf16(2*te),this.dyn_dtree=new B.Buf16(2*(2*J+1)),this.bl_tree=new B.Buf16(2*(2*ae+1)),Tt(this.dyn_ltree),Tt(this.dyn_dtree),Tt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new B.Buf16(ce+1),this.heap=new B.Buf16(2*we+1),Tt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new B.Buf16(2*we+1),Tt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function fn(F){var Ae;return F&&F.state?(F.total_in=F.total_out=0,F.data_type=N,(Ae=F.state).pending=0,Ae.pending_out=0,Ae.wrap<0&&(Ae.wrap=-Ae.wrap),Ae.status=Ae.wrap?pe:Se,F.adler=2===Ae.wrap?0:1,Ae.last_flush=j,T._tr_init(Ae),E):Ot(F,D)}function oi(F){var Re,Ae=fn(F);return Ae===E&&((Re=F.state).window_size=2*Re.w_size,Tt(Re.head),Re.max_lazy_match=w[Re.level].max_lazy,Re.good_match=w[Re.level].good_length,Re.nice_match=w[Re.level].nice_length,Re.max_chain_length=w[Re.level].max_chain,Re.strstart=0,Re.block_start=0,Re.lookahead=0,Re.insert=0,Re.match_length=Re.prev_length=_e-1,Re.match_available=0,Re.ins_h=0),Ae}function Dn(F,Ae,Re,fe,se,Ie){if(!F)return D;var dt=1;if(-1===Ae&&(Ae=6),fe<0?(dt=0,fe=-fe):15<fe&&(dt=2,fe-=16),se<1||9<se||Re!==Q||fe<8||15<fe||Ae<0||9<Ae||Ie<0||4<Ie)return Ot(F,D);8===fe&&(fe=9);var vt=new Cn;return(F.state=vt).strm=F,vt.wrap=dt,vt.gzhead=null,vt.w_bits=fe,vt.w_size=1<<vt.w_bits,vt.w_mask=vt.w_size-1,vt.hash_bits=se+7,vt.hash_size=1<<vt.hash_bits,vt.hash_mask=vt.hash_size-1,vt.hash_shift=~~((vt.hash_bits+_e-1)/_e),vt.window=new B.Buf8(2*vt.w_size),vt.head=new B.Buf16(vt.hash_size),vt.prev=new B.Buf16(vt.w_size),vt.lit_bufsize=1<<se+6,vt.pending_buf_size=4*vt.lit_bufsize,vt.pending_buf=new B.Buf8(vt.pending_buf_size),vt.d_buf=1*vt.lit_bufsize,vt.l_buf=3*vt.lit_bufsize,vt.level=Ae,vt.strategy=Ie,vt.method=Re,oi(F)}w=[new Lt(0,0,0,0,function(F,Ae){var Re=65535;for(Re>F.pending_buf_size-5&&(Re=F.pending_buf_size-5);;){if(F.lookahead<=1){if(mi(F),0===F.lookahead&&Ae===j)return 1;if(0===F.lookahead)break}F.strstart+=F.lookahead,F.lookahead=0;var fe=F.block_start+Re;if((0===F.strstart||F.strstart>=fe)&&(F.lookahead=F.strstart-fe,F.strstart=fe,et(F,!1),0===F.strm.avail_out)||F.strstart-F.block_start>=F.w_size-Qe&&(et(F,!1),0===F.strm.avail_out))return 1}return F.insert=0,4===Ae?(et(F,!0),0===F.strm.avail_out?3:4):(F.strstart>F.block_start&&et(F,!1),1)}),new Lt(4,4,8,4,$t),new Lt(4,5,16,8,$t),new Lt(4,6,32,32,$t),new Lt(4,4,16,16,At),new Lt(8,16,32,32,At),new Lt(8,16,128,128,At),new Lt(8,32,128,256,At),new Lt(32,128,258,1024,At),new Lt(32,258,258,4096,At)],L.deflateInit=function(F,Ae){return Dn(F,Ae,Q,15,8,0)},L.deflateInit2=Dn,L.deflateReset=oi,L.deflateResetKeep=fn,L.deflateSetHeader=function(F,Ae){return F&&F.state?2!==F.state.wrap?D:(F.state.gzhead=Ae,E):D},L.deflate=function(F,Ae){var Re,fe,se,Ie;if(!F||!F.state||5<Ae||Ae<0)return F?Ot(F,D):D;if(fe=F.state,!F.output||!F.input&&0!==F.avail_in||666===fe.status&&4!==Ae)return Ot(F,0===F.avail_out?-5:D);if(fe.strm=F,Re=fe.last_flush,fe.last_flush=Ae,fe.status===pe)if(2===fe.wrap)F.adler=0,tn(fe,31),tn(fe,139),tn(fe,8),fe.gzhead?(tn(fe,(fe.gzhead.text?1:0)+(fe.gzhead.hcrc?2:0)+(fe.gzhead.extra?4:0)+(fe.gzhead.name?8:0)+(fe.gzhead.comment?16:0)),tn(fe,255&fe.gzhead.time),tn(fe,fe.gzhead.time>>8&255),tn(fe,fe.gzhead.time>>16&255),tn(fe,fe.gzhead.time>>24&255),tn(fe,9===fe.level?2:2<=fe.strategy||fe.level<2?4:0),tn(fe,255&fe.gzhead.os),fe.gzhead.extra&&fe.gzhead.extra.length&&(tn(fe,255&fe.gzhead.extra.length),tn(fe,fe.gzhead.extra.length>>8&255)),fe.gzhead.hcrc&&(F.adler=P(F.adler,fe.pending_buf,fe.pending,0)),fe.gzindex=0,fe.status=69):(tn(fe,0),tn(fe,0),tn(fe,0),tn(fe,0),tn(fe,0),tn(fe,9===fe.level?2:2<=fe.strategy||fe.level<2?4:0),tn(fe,3),fe.status=Se);else{var dt=Q+(fe.w_bits-8<<4)<<8;dt|=(2<=fe.strategy||fe.level<2?0:fe.level<6?1:6===fe.level?2:3)<<6,0!==fe.strstart&&(dt|=32),dt+=31-dt%31,fe.status=Se,Rt(fe,dt),0!==fe.strstart&&(Rt(fe,F.adler>>>16),Rt(fe,65535&F.adler)),F.adler=1}if(69===fe.status)if(fe.gzhead.extra){for(se=fe.pending;fe.gzindex<(65535&fe.gzhead.extra.length)&&(fe.pending!==fe.pending_buf_size||(fe.gzhead.hcrc&&fe.pending>se&&(F.adler=P(F.adler,fe.pending_buf,fe.pending-se,se)),Ze(F),se=fe.pending,fe.pending!==fe.pending_buf_size));)tn(fe,255&fe.gzhead.extra[fe.gzindex]),fe.gzindex++;fe.gzhead.hcrc&&fe.pending>se&&(F.adler=P(F.adler,fe.pending_buf,fe.pending-se,se)),fe.gzindex===fe.gzhead.extra.length&&(fe.gzindex=0,fe.status=73)}else fe.status=73;if(73===fe.status)if(fe.gzhead.name){se=fe.pending;do{if(fe.pending===fe.pending_buf_size&&(fe.gzhead.hcrc&&fe.pending>se&&(F.adler=P(F.adler,fe.pending_buf,fe.pending-se,se)),Ze(F),se=fe.pending,fe.pending===fe.pending_buf_size)){Ie=1;break}Ie=fe.gzindex<fe.gzhead.name.length?255&fe.gzhead.name.charCodeAt(fe.gzindex++):0,tn(fe,Ie)}while(0!==Ie);fe.gzhead.hcrc&&fe.pending>se&&(F.adler=P(F.adler,fe.pending_buf,fe.pending-se,se)),0===Ie&&(fe.gzindex=0,fe.status=91)}else fe.status=91;if(91===fe.status)if(fe.gzhead.comment){se=fe.pending;do{if(fe.pending===fe.pending_buf_size&&(fe.gzhead.hcrc&&fe.pending>se&&(F.adler=P(F.adler,fe.pending_buf,fe.pending-se,se)),Ze(F),se=fe.pending,fe.pending===fe.pending_buf_size)){Ie=1;break}Ie=fe.gzindex<fe.gzhead.comment.length?255&fe.gzhead.comment.charCodeAt(fe.gzindex++):0,tn(fe,Ie)}while(0!==Ie);fe.gzhead.hcrc&&fe.pending>se&&(F.adler=P(F.adler,fe.pending_buf,fe.pending-se,se)),0===Ie&&(fe.status=103)}else fe.status=103;if(103===fe.status&&(fe.gzhead.hcrc?(fe.pending+2>fe.pending_buf_size&&Ze(F),fe.pending+2<=fe.pending_buf_size&&(tn(fe,255&F.adler),tn(fe,F.adler>>8&255),F.adler=0,fe.status=Se)):fe.status=Se),0!==fe.pending){if(Ze(F),0===F.avail_out)return fe.last_flush=-1,E}else if(0===F.avail_in&&ot(Ae)<=ot(Re)&&4!==Ae)return Ot(F,-5);if(666===fe.status&&0!==F.avail_in)return Ot(F,-5);if(0!==F.avail_in||0!==fe.lookahead||Ae!==j&&666!==fe.status){var vt=2===fe.strategy?function(qe,Mt){for(var Ht;;){if(0===qe.lookahead&&(mi(qe),0===qe.lookahead)){if(Mt===j)return 1;break}if(qe.match_length=0,Ht=T._tr_tally(qe,0,qe.window[qe.strstart]),qe.lookahead--,qe.strstart++,Ht&&(et(qe,!1),0===qe.strm.avail_out))return 1}return qe.insert=0,4===Mt?(et(qe,!0),0===qe.strm.avail_out?3:4):qe.last_lit&&(et(qe,!1),0===qe.strm.avail_out)?1:2}(fe,Ae):3===fe.strategy?function(qe,Mt){for(var Ht,Dt,hn,Ii,jn=qe.window;;){if(qe.lookahead<=ue){if(mi(qe),qe.lookahead<=ue&&Mt===j)return 1;if(0===qe.lookahead)break}if(qe.match_length=0,qe.lookahead>=_e&&0<qe.strstart&&(Dt=jn[hn=qe.strstart-1])===jn[++hn]&&Dt===jn[++hn]&&Dt===jn[++hn]){Ii=qe.strstart+ue;do{}while(Dt===jn[++hn]&&Dt===jn[++hn]&&Dt===jn[++hn]&&Dt===jn[++hn]&&Dt===jn[++hn]&&Dt===jn[++hn]&&Dt===jn[++hn]&&Dt===jn[++hn]&&hn<Ii);qe.match_length=ue-(Ii-hn),qe.match_length>qe.lookahead&&(qe.match_length=qe.lookahead)}if(qe.match_length>=_e?(Ht=T._tr_tally(qe,1,qe.match_length-_e),qe.lookahead-=qe.match_length,qe.strstart+=qe.match_length,qe.match_length=0):(Ht=T._tr_tally(qe,0,qe.window[qe.strstart]),qe.lookahead--,qe.strstart++),Ht&&(et(qe,!1),0===qe.strm.avail_out))return 1}return qe.insert=0,4===Mt?(et(qe,!0),0===qe.strm.avail_out?3:4):qe.last_lit&&(et(qe,!1),0===qe.strm.avail_out)?1:2}(fe,Ae):w[fe.level].func(fe,Ae);if(3!==vt&&4!==vt||(fe.status=666),1===vt||3===vt)return 0===F.avail_out&&(fe.last_flush=-1),E;if(2===vt&&(1===Ae?T._tr_align(fe):5!==Ae&&(T._tr_stored_block(fe,0,0,!1),3===Ae&&(Tt(fe.head),0===fe.lookahead&&(fe.strstart=0,fe.block_start=0,fe.insert=0))),Ze(F),0===F.avail_out))return fe.last_flush=-1,E}return 4!==Ae?E:fe.wrap<=0?1:(2===fe.wrap?(tn(fe,255&F.adler),tn(fe,F.adler>>8&255),tn(fe,F.adler>>16&255),tn(fe,F.adler>>24&255),tn(fe,255&F.total_in),tn(fe,F.total_in>>8&255),tn(fe,F.total_in>>16&255),tn(fe,F.total_in>>24&255)):(Rt(fe,F.adler>>>16),Rt(fe,65535&F.adler)),Ze(F),0<fe.wrap&&(fe.wrap=-fe.wrap),0!==fe.pending?E:1)},L.deflateEnd=function(F){var Ae;return F&&F.state?(Ae=F.state.status)!==pe&&69!==Ae&&73!==Ae&&91!==Ae&&103!==Ae&&Ae!==Se&&666!==Ae?Ot(F,D):(F.state=null,Ae===Se?Ot(F,-3):E):D},L.deflateSetDictionary=function(F,Ae){var Re,fe,se,Ie,dt,vt,qe,Mt,Ht=Ae.length;if(!F||!F.state||2===(Ie=(Re=F.state).wrap)||1===Ie&&Re.status!==pe||Re.lookahead)return D;for(1===Ie&&(F.adler=S(F.adler,Ae,Ht,0)),Re.wrap=0,Ht>=Re.w_size&&(0===Ie&&(Tt(Re.head),Re.strstart=0,Re.block_start=0,Re.insert=0),Mt=new B.Buf8(Re.w_size),B.arraySet(Mt,Ae,Ht-Re.w_size,Re.w_size,0),Ae=Mt,Ht=Re.w_size),dt=F.avail_in,vt=F.next_in,qe=F.input,F.avail_in=Ht,F.next_in=0,F.input=Ae,mi(Re);Re.lookahead>=_e;){for(fe=Re.strstart,se=Re.lookahead-(_e-1);Re.ins_h=(Re.ins_h<<Re.hash_shift^Re.window[fe+_e-1])&Re.hash_mask,Re.prev[fe&Re.w_mask]=Re.head[Re.ins_h],Re.head[Re.ins_h]=fe,fe++,--se;);Re.strstart=fe,Re.lookahead=_e-1,mi(Re)}return Re.strstart+=Re.lookahead,Re.block_start=Re.strstart,Re.insert=Re.lookahead,Re.lookahead=0,Re.match_length=Re.prev_length=_e-1,Re.match_available=0,F.next_in=vt,F.input=qe,F.avail_in=dt,Re.wrap=Ie,E},L.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(X,me,L){"use strict";me.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(X,me,L){"use strict";me.exports=function(w,B){var T,S,P,O,j,A,E,D,k,z,N,Q,de,we,J,ae,te,ce,_e,ue,Qe,pe,Se,R,Ye;R=w.input,P=(S=w.next_in)+(w.avail_in-5),Ye=w.output,j=(O=w.next_out)-(B-w.avail_out),A=O+(w.avail_out-257),E=(T=w.state).dmax,D=T.wsize,k=T.whave,z=T.wnext,N=T.window,Q=T.hold,de=T.bits,we=T.lencode,J=T.distcode,ae=(1<<T.lenbits)-1,te=(1<<T.distbits)-1;e:do{de<15&&(Q+=R[S++]<<de,Q+=R[S++]<<(de+=8),de+=8),ce=we[Q&ae];t:for(;;){if(Q>>>=_e=ce>>>24,de-=_e,0==(_e=ce>>>16&255))Ye[O++]=65535&ce;else{if(!(16&_e)){if(!(64&_e)){ce=we[(65535&ce)+(Q&(1<<_e)-1)];continue t}if(32&_e){T.mode=12;break e}w.msg="invalid literal/length code",T.mode=30;break e}ue=65535&ce,(_e&=15)&&(de<_e&&(Q+=R[S++]<<de,de+=8),ue+=Q&(1<<_e)-1,Q>>>=_e,de-=_e),de<15&&(Q+=R[S++]<<de,Q+=R[S++]<<(de+=8),de+=8),ce=J[Q&te];n:for(;;){if(Q>>>=_e=ce>>>24,de-=_e,!(16&(_e=ce>>>16&255))){if(!(64&_e)){ce=J[(65535&ce)+(Q&(1<<_e)-1)];continue n}w.msg="invalid distance code",T.mode=30;break e}if(Qe=65535&ce,de<(_e&=15)&&(Q+=R[S++]<<de,(de+=8)<_e&&(Q+=R[S++]<<de,de+=8)),E<(Qe+=Q&(1<<_e)-1)){w.msg="invalid distance too far back",T.mode=30;break e}if(Q>>>=_e,de-=_e,(_e=O-j)<Qe){if(k<(_e=Qe-_e)&&T.sane){w.msg="invalid distance too far back",T.mode=30;break e}if(Se=N,(pe=0)===z){if(pe+=D-_e,_e<ue){for(ue-=_e;Ye[O++]=N[pe++],--_e;);pe=O-Qe,Se=Ye}}else if(z<_e){if(pe+=D+z-_e,(_e-=z)<ue){for(ue-=_e;Ye[O++]=N[pe++],--_e;);if(pe=0,z<ue){for(ue-=_e=z;Ye[O++]=N[pe++],--_e;);pe=O-Qe,Se=Ye}}}else if(pe+=z-_e,_e<ue){for(ue-=_e;Ye[O++]=N[pe++],--_e;);pe=O-Qe,Se=Ye}for(;2<ue;)Ye[O++]=Se[pe++],Ye[O++]=Se[pe++],Ye[O++]=Se[pe++],ue-=3;ue&&(Ye[O++]=Se[pe++],1<ue&&(Ye[O++]=Se[pe++]))}else{for(pe=O-Qe;Ye[O++]=Ye[pe++],Ye[O++]=Ye[pe++],Ye[O++]=Ye[pe++],2<(ue-=3););ue&&(Ye[O++]=Ye[pe++],1<ue&&(Ye[O++]=Ye[pe++]))}break}}break}}while(S<P&&O<A);S-=ue=de>>3,Q&=(1<<(de-=ue<<3))-1,w.next_in=S,w.next_out=O,w.avail_in=S<P?P-S+5:5-(S-P),w.avail_out=O<A?A-O+257:257-(O-A),T.hold=Q,T.bits=de}},{}],49:[function(X,me,L){"use strict";var w=X("../utils/common"),B=X("./adler32"),T=X("./crc32"),S=X("./inffast"),P=X("./inftrees"),A=0,E=-2,D=1,k=852,z=592;function N(pe){return(pe>>>24&255)+(pe>>>8&65280)+((65280&pe)<<8)+((255&pe)<<24)}function Q(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new w.Buf16(320),this.work=new w.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function de(pe){var Se;return pe&&pe.state?(pe.total_in=pe.total_out=(Se=pe.state).total=0,pe.msg="",Se.wrap&&(pe.adler=1&Se.wrap),Se.mode=D,Se.last=0,Se.havedict=0,Se.dmax=32768,Se.head=null,Se.hold=0,Se.bits=0,Se.lencode=Se.lendyn=new w.Buf32(k),Se.distcode=Se.distdyn=new w.Buf32(z),Se.sane=1,Se.back=-1,A):E}function we(pe){var Se;return pe&&pe.state?((Se=pe.state).wsize=0,Se.whave=0,Se.wnext=0,de(pe)):E}function J(pe,Se){var R,Ye;return pe&&pe.state?(Ye=pe.state,Se<0?(R=0,Se=-Se):(R=1+(Se>>4),Se<48&&(Se&=15)),Se&&(Se<8||15<Se)?E:(null!==Ye.window&&Ye.wbits!==Se&&(Ye.window=null),Ye.wrap=R,Ye.wbits=Se,we(pe))):E}function ae(pe,Se){var R,Ye;return pe?(Ye=new Q,(pe.state=Ye).window=null,(R=J(pe,Se))!==A&&(pe.state=null),R):E}var te,ce,_e=!0;function ue(pe){if(_e){var Se;for(te=new w.Buf32(512),ce=new w.Buf32(32),Se=0;Se<144;)pe.lens[Se++]=8;for(;Se<256;)pe.lens[Se++]=9;for(;Se<280;)pe.lens[Se++]=7;for(;Se<288;)pe.lens[Se++]=8;for(P(1,pe.lens,0,288,te,0,pe.work,{bits:9}),Se=0;Se<32;)pe.lens[Se++]=5;P(2,pe.lens,0,32,ce,0,pe.work,{bits:5}),_e=!1}pe.lencode=te,pe.lenbits=9,pe.distcode=ce,pe.distbits=5}function Qe(pe,Se,R,Ye){var Bt,Ve=pe.state;return null===Ve.window&&(Ve.wsize=1<<Ve.wbits,Ve.wnext=0,Ve.whave=0,Ve.window=new w.Buf8(Ve.wsize)),Ye>=Ve.wsize?(w.arraySet(Ve.window,Se,R-Ve.wsize,Ve.wsize,0),Ve.wnext=0,Ve.whave=Ve.wsize):(Ye<(Bt=Ve.wsize-Ve.wnext)&&(Bt=Ye),w.arraySet(Ve.window,Se,R-Ye,Bt,Ve.wnext),(Ye-=Bt)?(w.arraySet(Ve.window,Se,R-Ye,Ye,0),Ve.wnext=Ye,Ve.whave=Ve.wsize):(Ve.wnext+=Bt,Ve.wnext===Ve.wsize&&(Ve.wnext=0),Ve.whave<Ve.wsize&&(Ve.whave+=Bt))),0}L.inflateReset=we,L.inflateReset2=J,L.inflateResetKeep=de,L.inflateInit=function(pe){return ae(pe,15)},L.inflateInit2=ae,L.inflate=function(pe,Se){var R,Ye,Bt,Ve,Ot,ot,Tt,Ze,et,tn,Rt,qt,mi,$t,At,Lt,Cn,fn,oi,Dn,F,Ae,Re,fe,se=0,Ie=new w.Buf8(4),dt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!pe||!pe.state||!pe.output||!pe.input&&0!==pe.avail_in)return E;12===(R=pe.state).mode&&(R.mode=13),Ot=pe.next_out,Bt=pe.output,Ve=pe.next_in,Ye=pe.input,Ze=R.hold,et=R.bits,tn=ot=pe.avail_in,Rt=Tt=pe.avail_out,Ae=A;e:for(;;)switch(R.mode){case D:if(0===R.wrap){R.mode=13;break}for(;et<16;){if(0===ot)break e;ot--,Ze+=Ye[Ve++]<<et,et+=8}if(2&R.wrap&&35615===Ze){Ie[R.check=0]=255&Ze,Ie[1]=Ze>>>8&255,R.check=T(R.check,Ie,2,0),et=Ze=0,R.mode=2;break}if(R.flags=0,R.head&&(R.head.done=!1),!(1&R.wrap)||(((255&Ze)<<8)+(Ze>>8))%31){pe.msg="incorrect header check",R.mode=30;break}if(8!=(15&Ze)){pe.msg="unknown compression method",R.mode=30;break}if(et-=4,F=8+(15&(Ze>>>=4)),0===R.wbits)R.wbits=F;else if(F>R.wbits){pe.msg="invalid window size",R.mode=30;break}R.dmax=1<<F,pe.adler=R.check=1,R.mode=512&Ze?10:12,et=Ze=0;break;case 2:for(;et<16;){if(0===ot)break e;ot--,Ze+=Ye[Ve++]<<et,et+=8}if(R.flags=Ze,8!=(255&R.flags)){pe.msg="unknown compression method",R.mode=30;break}if(57344&R.flags){pe.msg="unknown header flags set",R.mode=30;break}R.head&&(R.head.text=Ze>>8&1),512&R.flags&&(Ie[0]=255&Ze,Ie[1]=Ze>>>8&255,R.check=T(R.check,Ie,2,0)),et=Ze=0,R.mode=3;case 3:for(;et<32;){if(0===ot)break e;ot--,Ze+=Ye[Ve++]<<et,et+=8}R.head&&(R.head.time=Ze),512&R.flags&&(Ie[0]=255&Ze,Ie[1]=Ze>>>8&255,Ie[2]=Ze>>>16&255,Ie[3]=Ze>>>24&255,R.check=T(R.check,Ie,4,0)),et=Ze=0,R.mode=4;case 4:for(;et<16;){if(0===ot)break e;ot--,Ze+=Ye[Ve++]<<et,et+=8}R.head&&(R.head.xflags=255&Ze,R.head.os=Ze>>8),512&R.flags&&(Ie[0]=255&Ze,Ie[1]=Ze>>>8&255,R.check=T(R.check,Ie,2,0)),et=Ze=0,R.mode=5;case 5:if(1024&R.flags){for(;et<16;){if(0===ot)break e;ot--,Ze+=Ye[Ve++]<<et,et+=8}R.length=Ze,R.head&&(R.head.extra_len=Ze),512&R.flags&&(Ie[0]=255&Ze,Ie[1]=Ze>>>8&255,R.check=T(R.check,Ie,2,0)),et=Ze=0}else R.head&&(R.head.extra=null);R.mode=6;case 6:if(1024&R.flags&&(ot<(qt=R.length)&&(qt=ot),qt&&(R.head&&(F=R.head.extra_len-R.length,R.head.extra||(R.head.extra=new Array(R.head.extra_len)),w.arraySet(R.head.extra,Ye,Ve,qt,F)),512&R.flags&&(R.check=T(R.check,Ye,qt,Ve)),ot-=qt,Ve+=qt,R.length-=qt),R.length))break e;R.length=0,R.mode=7;case 7:if(2048&R.flags){if(0===ot)break e;for(qt=0;F=Ye[Ve+qt++],R.head&&F&&R.length<65536&&(R.head.name+=String.fromCharCode(F)),F&&qt<ot;);if(512&R.flags&&(R.check=T(R.check,Ye,qt,Ve)),ot-=qt,Ve+=qt,F)break e}else R.head&&(R.head.name=null);R.length=0,R.mode=8;case 8:if(4096&R.flags){if(0===ot)break e;for(qt=0;F=Ye[Ve+qt++],R.head&&F&&R.length<65536&&(R.head.comment+=String.fromCharCode(F)),F&&qt<ot;);if(512&R.flags&&(R.check=T(R.check,Ye,qt,Ve)),ot-=qt,Ve+=qt,F)break e}else R.head&&(R.head.comment=null);R.mode=9;case 9:if(512&R.flags){for(;et<16;){if(0===ot)break e;ot--,Ze+=Ye[Ve++]<<et,et+=8}if(Ze!==(65535&R.check)){pe.msg="header crc mismatch",R.mode=30;break}et=Ze=0}R.head&&(R.head.hcrc=R.flags>>9&1,R.head.done=!0),pe.adler=R.check=0,R.mode=12;break;case 10:for(;et<32;){if(0===ot)break e;ot--,Ze+=Ye[Ve++]<<et,et+=8}pe.adler=R.check=N(Ze),et=Ze=0,R.mode=11;case 11:if(0===R.havedict)return pe.next_out=Ot,pe.avail_out=Tt,pe.next_in=Ve,pe.avail_in=ot,R.hold=Ze,R.bits=et,2;pe.adler=R.check=1,R.mode=12;case 12:if(5===Se||6===Se)break e;case 13:if(R.last){Ze>>>=7&et,et-=7&et,R.mode=27;break}for(;et<3;){if(0===ot)break e;ot--,Ze+=Ye[Ve++]<<et,et+=8}switch(R.last=1&Ze,et-=1,3&(Ze>>>=1)){case 0:R.mode=14;break;case 1:if(ue(R),R.mode=20,6!==Se)break;Ze>>>=2,et-=2;break e;case 2:R.mode=17;break;case 3:pe.msg="invalid block type",R.mode=30}Ze>>>=2,et-=2;break;case 14:for(Ze>>>=7&et,et-=7&et;et<32;){if(0===ot)break e;ot--,Ze+=Ye[Ve++]<<et,et+=8}if((65535&Ze)!=(Ze>>>16^65535)){pe.msg="invalid stored block lengths",R.mode=30;break}if(R.length=65535&Ze,et=Ze=0,R.mode=15,6===Se)break e;case 15:R.mode=16;case 16:if(qt=R.length){if(ot<qt&&(qt=ot),Tt<qt&&(qt=Tt),0===qt)break e;w.arraySet(Bt,Ye,Ve,qt,Ot),ot-=qt,Ve+=qt,Tt-=qt,Ot+=qt,R.length-=qt;break}R.mode=12;break;case 17:for(;et<14;){if(0===ot)break e;ot--,Ze+=Ye[Ve++]<<et,et+=8}if(R.nlen=257+(31&Ze),et-=5,R.ndist=1+(31&(Ze>>>=5)),et-=5,R.ncode=4+(15&(Ze>>>=5)),Ze>>>=4,et-=4,286<R.nlen||30<R.ndist){pe.msg="too many length or distance symbols",R.mode=30;break}R.have=0,R.mode=18;case 18:for(;R.have<R.ncode;){for(;et<3;){if(0===ot)break e;ot--,Ze+=Ye[Ve++]<<et,et+=8}R.lens[dt[R.have++]]=7&Ze,Ze>>>=3,et-=3}for(;R.have<19;)R.lens[dt[R.have++]]=0;if(R.lencode=R.lendyn,R.lenbits=7,Ae=P(0,R.lens,0,19,R.lencode,0,R.work,Re={bits:R.lenbits}),R.lenbits=Re.bits,Ae){pe.msg="invalid code lengths set",R.mode=30;break}R.have=0,R.mode=19;case 19:for(;R.have<R.nlen+R.ndist;){for(;Lt=(se=R.lencode[Ze&(1<<R.lenbits)-1])>>>16&255,Cn=65535&se,!((At=se>>>24)<=et);){if(0===ot)break e;ot--,Ze+=Ye[Ve++]<<et,et+=8}if(Cn<16)Ze>>>=At,et-=At,R.lens[R.have++]=Cn;else{if(16===Cn){for(fe=At+2;et<fe;){if(0===ot)break e;ot--,Ze+=Ye[Ve++]<<et,et+=8}if(Ze>>>=At,et-=At,0===R.have){pe.msg="invalid bit length repeat",R.mode=30;break}F=R.lens[R.have-1],qt=3+(3&Ze),Ze>>>=2,et-=2}else if(17===Cn){for(fe=At+3;et<fe;){if(0===ot)break e;ot--,Ze+=Ye[Ve++]<<et,et+=8}et-=At,F=0,qt=3+(7&(Ze>>>=At)),Ze>>>=3,et-=3}else{for(fe=At+7;et<fe;){if(0===ot)break e;ot--,Ze+=Ye[Ve++]<<et,et+=8}et-=At,F=0,qt=11+(127&(Ze>>>=At)),Ze>>>=7,et-=7}if(R.have+qt>R.nlen+R.ndist){pe.msg="invalid bit length repeat",R.mode=30;break}for(;qt--;)R.lens[R.have++]=F}}if(30===R.mode)break;if(0===R.lens[256]){pe.msg="invalid code -- missing end-of-block",R.mode=30;break}if(R.lenbits=9,Ae=P(1,R.lens,0,R.nlen,R.lencode,0,R.work,Re={bits:R.lenbits}),R.lenbits=Re.bits,Ae){pe.msg="invalid literal/lengths set",R.mode=30;break}if(R.distbits=6,R.distcode=R.distdyn,Ae=P(2,R.lens,R.nlen,R.ndist,R.distcode,0,R.work,Re={bits:R.distbits}),R.distbits=Re.bits,Ae){pe.msg="invalid distances set",R.mode=30;break}if(R.mode=20,6===Se)break e;case 20:R.mode=21;case 21:if(6<=ot&&258<=Tt){pe.next_out=Ot,pe.avail_out=Tt,pe.next_in=Ve,pe.avail_in=ot,R.hold=Ze,R.bits=et,S(pe,Rt),Ot=pe.next_out,Bt=pe.output,Tt=pe.avail_out,Ve=pe.next_in,Ye=pe.input,ot=pe.avail_in,Ze=R.hold,et=R.bits,12===R.mode&&(R.back=-1);break}for(R.back=0;Lt=(se=R.lencode[Ze&(1<<R.lenbits)-1])>>>16&255,Cn=65535&se,!((At=se>>>24)<=et);){if(0===ot)break e;ot--,Ze+=Ye[Ve++]<<et,et+=8}if(Lt&&!(240&Lt)){for(fn=At,oi=Lt,Dn=Cn;Lt=(se=R.lencode[Dn+((Ze&(1<<fn+oi)-1)>>fn)])>>>16&255,Cn=65535&se,!(fn+(At=se>>>24)<=et);){if(0===ot)break e;ot--,Ze+=Ye[Ve++]<<et,et+=8}Ze>>>=fn,et-=fn,R.back+=fn}if(Ze>>>=At,et-=At,R.back+=At,R.length=Cn,0===Lt){R.mode=26;break}if(32&Lt){R.back=-1,R.mode=12;break}if(64&Lt){pe.msg="invalid literal/length code",R.mode=30;break}R.extra=15&Lt,R.mode=22;case 22:if(R.extra){for(fe=R.extra;et<fe;){if(0===ot)break e;ot--,Ze+=Ye[Ve++]<<et,et+=8}R.length+=Ze&(1<<R.extra)-1,Ze>>>=R.extra,et-=R.extra,R.back+=R.extra}R.was=R.length,R.mode=23;case 23:for(;Lt=(se=R.distcode[Ze&(1<<R.distbits)-1])>>>16&255,Cn=65535&se,!((At=se>>>24)<=et);){if(0===ot)break e;ot--,Ze+=Ye[Ve++]<<et,et+=8}if(!(240&Lt)){for(fn=At,oi=Lt,Dn=Cn;Lt=(se=R.distcode[Dn+((Ze&(1<<fn+oi)-1)>>fn)])>>>16&255,Cn=65535&se,!(fn+(At=se>>>24)<=et);){if(0===ot)break e;ot--,Ze+=Ye[Ve++]<<et,et+=8}Ze>>>=fn,et-=fn,R.back+=fn}if(Ze>>>=At,et-=At,R.back+=At,64&Lt){pe.msg="invalid distance code",R.mode=30;break}R.offset=Cn,R.extra=15&Lt,R.mode=24;case 24:if(R.extra){for(fe=R.extra;et<fe;){if(0===ot)break e;ot--,Ze+=Ye[Ve++]<<et,et+=8}R.offset+=Ze&(1<<R.extra)-1,Ze>>>=R.extra,et-=R.extra,R.back+=R.extra}if(R.offset>R.dmax){pe.msg="invalid distance too far back",R.mode=30;break}R.mode=25;case 25:if(0===Tt)break e;if(R.offset>(qt=Rt-Tt)){if((qt=R.offset-qt)>R.whave&&R.sane){pe.msg="invalid distance too far back",R.mode=30;break}mi=qt>R.wnext?R.wsize-(qt-=R.wnext):R.wnext-qt,qt>R.length&&(qt=R.length),$t=R.window}else $t=Bt,mi=Ot-R.offset,qt=R.length;for(Tt<qt&&(qt=Tt),Tt-=qt,R.length-=qt;Bt[Ot++]=$t[mi++],--qt;);0===R.length&&(R.mode=21);break;case 26:if(0===Tt)break e;Bt[Ot++]=R.length,Tt--,R.mode=21;break;case 27:if(R.wrap){for(;et<32;){if(0===ot)break e;ot--,Ze|=Ye[Ve++]<<et,et+=8}if(pe.total_out+=Rt-=Tt,R.total+=Rt,Rt&&(pe.adler=R.check=R.flags?T(R.check,Bt,Rt,Ot-Rt):B(R.check,Bt,Rt,Ot-Rt)),Rt=Tt,(R.flags?Ze:N(Ze))!==R.check){pe.msg="incorrect data check",R.mode=30;break}et=Ze=0}R.mode=28;case 28:if(R.wrap&&R.flags){for(;et<32;){if(0===ot)break e;ot--,Ze+=Ye[Ve++]<<et,et+=8}if(Ze!==(4294967295&R.total)){pe.msg="incorrect length check",R.mode=30;break}et=Ze=0}R.mode=29;case 29:Ae=1;break e;case 30:Ae=-3;break e;case 31:return-4;default:return E}return pe.next_out=Ot,pe.avail_out=Tt,pe.next_in=Ve,pe.avail_in=ot,R.hold=Ze,R.bits=et,(R.wsize||Rt!==pe.avail_out&&R.mode<30&&(R.mode<27||4!==Se))&&Qe(pe,pe.output,pe.next_out,Rt-pe.avail_out)?(R.mode=31,-4):(Rt-=pe.avail_out,pe.total_in+=tn-=pe.avail_in,pe.total_out+=Rt,R.total+=Rt,R.wrap&&Rt&&(pe.adler=R.check=R.flags?T(R.check,Bt,Rt,pe.next_out-Rt):B(R.check,Bt,Rt,pe.next_out-Rt)),pe.data_type=R.bits+(R.last?64:0)+(12===R.mode?128:0)+(20===R.mode||15===R.mode?256:0),(0==tn&&0===Rt||4===Se)&&Ae===A&&(Ae=-5),Ae)},L.inflateEnd=function(pe){if(!pe||!pe.state)return E;var Se=pe.state;return Se.window&&(Se.window=null),pe.state=null,A},L.inflateGetHeader=function(pe,Se){var R;return pe&&pe.state&&2&(R=pe.state).wrap?((R.head=Se).done=!1,A):E},L.inflateSetDictionary=function(pe,Se){var R,Ye=Se.length;return pe&&pe.state?0!==(R=pe.state).wrap&&11!==R.mode?E:11===R.mode&&B(1,Se,Ye,0)!==R.check?-3:Qe(pe,Se,Ye,Ye)?(R.mode=31,-4):(R.havedict=1,A):E},L.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(X,me,L){"use strict";var w=X("../utils/common"),B=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],T=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],S=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],P=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];me.exports=function(O,j,A,E,D,k,z,N){var Q,de,we,J,ae,te,ce,_e,ue,Qe=N.bits,pe=0,Se=0,R=0,Ye=0,Bt=0,Ve=0,Ot=0,ot=0,Tt=0,Ze=0,et=null,tn=0,Rt=new w.Buf16(16),qt=new w.Buf16(16),mi=null,$t=0;for(pe=0;pe<=15;pe++)Rt[pe]=0;for(Se=0;Se<E;Se++)Rt[j[A+Se]]++;for(Bt=Qe,Ye=15;1<=Ye&&0===Rt[Ye];Ye--);if(Ye<Bt&&(Bt=Ye),0===Ye)return D[k++]=20971520,D[k++]=20971520,N.bits=1,0;for(R=1;R<Ye&&0===Rt[R];R++);for(Bt<R&&(Bt=R),pe=ot=1;pe<=15;pe++)if(ot<<=1,(ot-=Rt[pe])<0)return-1;if(0<ot&&(0===O||1!==Ye))return-1;for(qt[1]=0,pe=1;pe<15;pe++)qt[pe+1]=qt[pe]+Rt[pe];for(Se=0;Se<E;Se++)0!==j[A+Se]&&(z[qt[j[A+Se]]++]=Se);if(te=0===O?(et=mi=z,19):1===O?(et=B,tn-=257,mi=T,$t-=257,256):(et=S,mi=P,-1),pe=R,ae=k,Ot=Se=Ze=0,we=-1,J=(Tt=1<<(Ve=Bt))-1,1===O&&852<Tt||2===O&&592<Tt)return 1;for(;;){for(ce=pe-Ot,ue=z[Se]<te?(_e=0,z[Se]):z[Se]>te?(_e=mi[$t+z[Se]],et[tn+z[Se]]):(_e=96,0),Q=1<<pe-Ot,R=de=1<<Ve;D[ae+(Ze>>Ot)+(de-=Q)]=ce<<24|_e<<16|ue,0!==de;);for(Q=1<<pe-1;Ze&Q;)Q>>=1;if(0!==Q?(Ze&=Q-1,Ze+=Q):Ze=0,Se++,0==--Rt[pe]){if(pe===Ye)break;pe=j[A+z[Se]]}if(Bt<pe&&(Ze&J)!==we){for(0===Ot&&(Ot=Bt),ae+=R,ot=1<<(Ve=pe-Ot);Ve+Ot<Ye&&!((ot-=Rt[Ve+Ot])<=0);)Ve++,ot<<=1;if(Tt+=1<<Ve,1===O&&852<Tt||2===O&&592<Tt)return 1;D[we=Ze&J]=Bt<<24|Ve<<16|ae-k}}return 0!==Ze&&(D[ae+Ze]=pe-Ot<<24|64<<16),N.bits=Bt,0}},{"../utils/common":41}],51:[function(X,me,L){"use strict";me.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(X,me,L){"use strict";var w=X("../utils/common");function S(se){for(var Ie=se.length;0<=--Ie;)se[Ie]=0}var j=256,A=286,E=30,z=15,N=16,te=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ce=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],_e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ue=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Qe=new Array(576);S(Qe);var pe=new Array(60);S(pe);var Se=new Array(512);S(Se);var R=new Array(256);S(R);var Ye=new Array(29);S(Ye);var Bt,Ve,Ot,ot=new Array(E);function Tt(se,Ie,dt,vt,qe){this.static_tree=se,this.extra_bits=Ie,this.extra_base=dt,this.elems=vt,this.max_length=qe,this.has_stree=se&&se.length}function Ze(se,Ie){this.dyn_tree=se,this.max_code=0,this.stat_desc=Ie}function et(se){return se<256?Se[se]:Se[256+(se>>>7)]}function tn(se,Ie){se.pending_buf[se.pending++]=255&Ie,se.pending_buf[se.pending++]=Ie>>>8&255}function Rt(se,Ie,dt){se.bi_valid>N-dt?(se.bi_buf|=Ie<<se.bi_valid&65535,tn(se,se.bi_buf),se.bi_buf=Ie>>N-se.bi_valid,se.bi_valid+=dt-N):(se.bi_buf|=Ie<<se.bi_valid&65535,se.bi_valid+=dt)}function qt(se,Ie,dt){Rt(se,dt[2*Ie],dt[2*Ie+1])}function mi(se,Ie){for(var dt=0;dt|=1&se,se>>>=1,dt<<=1,0<--Ie;);return dt>>>1}function $t(se,Ie,dt){var vt,qe,Mt=new Array(z+1),Ht=0;for(vt=1;vt<=z;vt++)Mt[vt]=Ht=Ht+dt[vt-1]<<1;for(qe=0;qe<=Ie;qe++){var Dt=se[2*qe+1];0!==Dt&&(se[2*qe]=mi(Mt[Dt]++,Dt))}}function At(se){var Ie;for(Ie=0;Ie<A;Ie++)se.dyn_ltree[2*Ie]=0;for(Ie=0;Ie<E;Ie++)se.dyn_dtree[2*Ie]=0;for(Ie=0;Ie<19;Ie++)se.bl_tree[2*Ie]=0;se.dyn_ltree[512]=1,se.opt_len=se.static_len=0,se.last_lit=se.matches=0}function Lt(se){8<se.bi_valid?tn(se,se.bi_buf):0<se.bi_valid&&(se.pending_buf[se.pending++]=se.bi_buf),se.bi_buf=0,se.bi_valid=0}function Cn(se,Ie,dt,vt){var qe=2*Ie,Mt=2*dt;return se[qe]<se[Mt]||se[qe]===se[Mt]&&vt[Ie]<=vt[dt]}function fn(se,Ie,dt){for(var vt=se.heap[dt],qe=dt<<1;qe<=se.heap_len&&(qe<se.heap_len&&Cn(Ie,se.heap[qe+1],se.heap[qe],se.depth)&&qe++,!Cn(Ie,vt,se.heap[qe],se.depth));)se.heap[dt]=se.heap[qe],dt=qe,qe<<=1;se.heap[dt]=vt}function oi(se,Ie,dt){var vt,qe,Mt,Ht,Dt=0;if(0!==se.last_lit)for(;vt=se.pending_buf[se.d_buf+2*Dt]<<8|se.pending_buf[se.d_buf+2*Dt+1],qe=se.pending_buf[se.l_buf+Dt],Dt++,0===vt?qt(se,qe,Ie):(qt(se,(Mt=R[qe])+j+1,Ie),0!==(Ht=te[Mt])&&Rt(se,qe-=Ye[Mt],Ht),qt(se,Mt=et(--vt),dt),0!==(Ht=ce[Mt])&&Rt(se,vt-=ot[Mt],Ht)),Dt<se.last_lit;);qt(se,256,Ie)}function Dn(se,Ie){var dt,vt,qe,Mt=Ie.dyn_tree,Ht=Ie.stat_desc.static_tree,Dt=Ie.stat_desc.has_stree,hn=Ie.stat_desc.elems,Ii=-1;for(se.heap_len=0,se.heap_max=573,dt=0;dt<hn;dt++)0!==Mt[2*dt]?(se.heap[++se.heap_len]=Ii=dt,se.depth[dt]=0):Mt[2*dt+1]=0;for(;se.heap_len<2;)Mt[2*(qe=se.heap[++se.heap_len]=Ii<2?++Ii:0)]=1,se.depth[qe]=0,se.opt_len--,Dt&&(se.static_len-=Ht[2*qe+1]);for(Ie.max_code=Ii,dt=se.heap_len>>1;1<=dt;dt--)fn(se,Mt,dt);for(qe=hn;dt=se.heap[1],se.heap[1]=se.heap[se.heap_len--],fn(se,Mt,1),vt=se.heap[1],se.heap[--se.heap_max]=dt,se.heap[--se.heap_max]=vt,Mt[2*qe]=Mt[2*dt]+Mt[2*vt],se.depth[qe]=(se.depth[dt]>=se.depth[vt]?se.depth[dt]:se.depth[vt])+1,Mt[2*dt+1]=Mt[2*vt+1]=qe,se.heap[1]=qe++,fn(se,Mt,1),2<=se.heap_len;);se.heap[--se.heap_max]=se.heap[1],function(jn,io){var yo,ji,Co,Pi,jo,rs,Nr=io.dyn_tree,ca=io.max_code,Da=io.stat_desc.static_tree,ua=io.stat_desc.has_stree,ka=io.stat_desc.extra_bits,Oa=io.stat_desc.extra_base,xs=io.stat_desc.max_length,ro=0;for(Pi=0;Pi<=z;Pi++)jn.bl_count[Pi]=0;for(Nr[2*jn.heap[jn.heap_max]+1]=0,yo=jn.heap_max+1;yo<573;yo++)xs<(Pi=Nr[2*Nr[2*(ji=jn.heap[yo])+1]+1]+1)&&(Pi=xs,ro++),Nr[2*ji+1]=Pi,ca<ji||(jn.bl_count[Pi]++,jo=0,Oa<=ji&&(jo=ka[ji-Oa]),jn.opt_len+=(rs=Nr[2*ji])*(Pi+jo),ua&&(jn.static_len+=rs*(Da[2*ji+1]+jo)));if(0!==ro){do{for(Pi=xs-1;0===jn.bl_count[Pi];)Pi--;jn.bl_count[Pi]--,jn.bl_count[Pi+1]+=2,jn.bl_count[xs]--,ro-=2}while(0<ro);for(Pi=xs;0!==Pi;Pi--)for(ji=jn.bl_count[Pi];0!==ji;)ca<(Co=jn.heap[--yo])||(Nr[2*Co+1]!==Pi&&(jn.opt_len+=(Pi-Nr[2*Co+1])*Nr[2*Co],Nr[2*Co+1]=Pi),ji--)}}(se,Ie),$t(Mt,Ii,se.bl_count)}function F(se,Ie,dt){var vt,qe,Mt=-1,Ht=Ie[1],Dt=0,hn=7,Ii=4;for(0===Ht&&(hn=138,Ii=3),Ie[2*(dt+1)+1]=65535,vt=0;vt<=dt;vt++)qe=Ht,Ht=Ie[2*(vt+1)+1],++Dt<hn&&qe===Ht||(Dt<Ii?se.bl_tree[2*qe]+=Dt:0!==qe?(qe!==Mt&&se.bl_tree[2*qe]++,se.bl_tree[32]++):Dt<=10?se.bl_tree[34]++:se.bl_tree[36]++,Mt=qe,Ii=(Dt=0)===Ht?(hn=138,3):qe===Ht?(hn=6,3):(hn=7,4))}function Ae(se,Ie,dt){var vt,qe,Mt=-1,Ht=Ie[1],Dt=0,hn=7,Ii=4;for(0===Ht&&(hn=138,Ii=3),vt=0;vt<=dt;vt++)if(qe=Ht,Ht=Ie[2*(vt+1)+1],!(++Dt<hn&&qe===Ht)){if(Dt<Ii)for(;qt(se,qe,se.bl_tree),0!=--Dt;);else 0!==qe?(qe!==Mt&&(qt(se,qe,se.bl_tree),Dt--),qt(se,16,se.bl_tree),Rt(se,Dt-3,2)):Dt<=10?(qt(se,17,se.bl_tree),Rt(se,Dt-3,3)):(qt(se,18,se.bl_tree),Rt(se,Dt-11,7));Mt=qe,Ii=(Dt=0)===Ht?(hn=138,3):qe===Ht?(hn=6,3):(hn=7,4)}}S(ot);var Re=!1;function fe(se,Ie,dt,vt){var qe,Mt,Ht;Rt(se,0+(vt?1:0),3),Mt=Ie,Ht=dt,Lt(qe=se),tn(qe,Ht),tn(qe,~Ht),w.arraySet(qe.pending_buf,qe.window,Mt,Ht,qe.pending),qe.pending+=Ht}L._tr_init=function(se){Re||(function(){var Ie,dt,vt,qe,Mt,Ht=new Array(z+1);for(qe=vt=0;qe<28;qe++)for(Ye[qe]=vt,Ie=0;Ie<1<<te[qe];Ie++)R[vt++]=qe;for(R[vt-1]=qe,qe=Mt=0;qe<16;qe++)for(ot[qe]=Mt,Ie=0;Ie<1<<ce[qe];Ie++)Se[Mt++]=qe;for(Mt>>=7;qe<E;qe++)for(ot[qe]=Mt<<7,Ie=0;Ie<1<<ce[qe]-7;Ie++)Se[256+Mt++]=qe;for(dt=0;dt<=z;dt++)Ht[dt]=0;for(Ie=0;Ie<=143;)Qe[2*Ie+1]=8,Ie++,Ht[8]++;for(;Ie<=255;)Qe[2*Ie+1]=9,Ie++,Ht[9]++;for(;Ie<=279;)Qe[2*Ie+1]=7,Ie++,Ht[7]++;for(;Ie<=287;)Qe[2*Ie+1]=8,Ie++,Ht[8]++;for($t(Qe,287,Ht),Ie=0;Ie<E;Ie++)pe[2*Ie+1]=5,pe[2*Ie]=mi(Ie,5);Bt=new Tt(Qe,te,257,A,z),Ve=new Tt(pe,ce,0,E,z),Ot=new Tt(new Array(0),_e,0,19,7)}(),Re=!0),se.l_desc=new Ze(se.dyn_ltree,Bt),se.d_desc=new Ze(se.dyn_dtree,Ve),se.bl_desc=new Ze(se.bl_tree,Ot),se.bi_buf=0,se.bi_valid=0,At(se)},L._tr_stored_block=fe,L._tr_flush_block=function(se,Ie,dt,vt){var qe,Mt,Ht=0;0<se.level?(2===se.strm.data_type&&(se.strm.data_type=function(Dt){var hn,Ii=4093624447;for(hn=0;hn<=31;hn++,Ii>>>=1)if(1&Ii&&0!==Dt.dyn_ltree[2*hn])return 0;if(0!==Dt.dyn_ltree[18]||0!==Dt.dyn_ltree[20]||0!==Dt.dyn_ltree[26])return 1;for(hn=32;hn<j;hn++)if(0!==Dt.dyn_ltree[2*hn])return 1;return 0}(se)),Dn(se,se.l_desc),Dn(se,se.d_desc),Ht=function(Dt){var hn;for(F(Dt,Dt.dyn_ltree,Dt.l_desc.max_code),F(Dt,Dt.dyn_dtree,Dt.d_desc.max_code),Dn(Dt,Dt.bl_desc),hn=18;3<=hn&&0===Dt.bl_tree[2*ue[hn]+1];hn--);return Dt.opt_len+=3*(hn+1)+5+5+4,hn}(se),(Mt=se.static_len+3+7>>>3)<=(qe=se.opt_len+3+7>>>3)&&(qe=Mt)):qe=Mt=dt+5,dt+4<=qe&&-1!==Ie?fe(se,Ie,dt,vt):4===se.strategy||Mt===qe?(Rt(se,2+(vt?1:0),3),oi(se,Qe,pe)):(Rt(se,4+(vt?1:0),3),function(Dt,hn,Ii,jn){var io;for(Rt(Dt,hn-257,5),Rt(Dt,Ii-1,5),Rt(Dt,jn-4,4),io=0;io<jn;io++)Rt(Dt,Dt.bl_tree[2*ue[io]+1],3);Ae(Dt,Dt.dyn_ltree,hn-1),Ae(Dt,Dt.dyn_dtree,Ii-1)}(se,se.l_desc.max_code+1,se.d_desc.max_code+1,Ht+1),oi(se,se.dyn_ltree,se.dyn_dtree)),At(se),vt&&Lt(se)},L._tr_tally=function(se,Ie,dt){return se.pending_buf[se.d_buf+2*se.last_lit]=Ie>>>8&255,se.pending_buf[se.d_buf+2*se.last_lit+1]=255&Ie,se.pending_buf[se.l_buf+se.last_lit]=255&dt,se.last_lit++,0===Ie?se.dyn_ltree[2*dt]++:(se.matches++,Ie--,se.dyn_ltree[2*(R[dt]+j+1)]++,se.dyn_dtree[2*et(Ie)]++),se.last_lit===se.lit_bufsize-1},L._tr_align=function(se){var Ie;Rt(se,2,3),qt(se,256,Qe),16===(Ie=se).bi_valid?(tn(Ie,Ie.bi_buf),Ie.bi_buf=0,Ie.bi_valid=0):8<=Ie.bi_valid&&(Ie.pending_buf[Ie.pending++]=255&Ie.bi_buf,Ie.bi_buf>>=8,Ie.bi_valid-=8)}},{"../utils/common":41}],53:[function(X,me,L){"use strict";me.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(X,me,L){(function(w){!function(B,T){"use strict";if(!B.setImmediate){var S,P,O,j,A=1,E={},D=!1,k=B.document,z=Object.getPrototypeOf&&Object.getPrototypeOf(B);z=z&&z.setTimeout?z:B,S="[object process]"==={}.toString.call(B.process)?function(we){process.nextTick(function(){Q(we)})}:function(){if(B.postMessage&&!B.importScripts){var we=!0,J=B.onmessage;return B.onmessage=function(){we=!1},B.postMessage("","*"),B.onmessage=J,we}}()?(j="setImmediate$"+Math.random()+"$",B.addEventListener?B.addEventListener("message",de,!1):B.attachEvent("onmessage",de),function(we){B.postMessage(j+we,"*")}):B.MessageChannel?((O=new MessageChannel).port1.onmessage=function(we){Q(we.data)},function(we){O.port2.postMessage(we)}):k&&"onreadystatechange"in k.createElement("script")?(P=k.documentElement,function(we){var J=k.createElement("script");J.onreadystatechange=function(){Q(we),J.onreadystatechange=null,P.removeChild(J),J=null},P.appendChild(J)}):function(we){setTimeout(Q,0,we)},z.setImmediate=function(we){"function"!=typeof we&&(we=new Function(""+we));for(var J=new Array(arguments.length-1),ae=0;ae<J.length;ae++)J[ae]=arguments[ae+1];return E[A]={callback:we,args:J},S(A),A++},z.clearImmediate=N}function N(we){delete E[we]}function Q(we){if(D)setTimeout(Q,0,we);else{var J=E[we];if(J){D=!0;try{!function(ae){var te=ae.callback,ce=ae.args;switch(ce.length){case 0:te();break;case 1:te(ce[0]);break;case 2:te(ce[0],ce[1]);break;case 3:te(ce[0],ce[1],ce[2]);break;default:te.apply(T,ce)}}(J)}finally{N(we),D=!1}}}}function de(we){we.source===B&&"string"==typeof we.data&&0===we.data.indexOf(j)&&Q(+we.data.slice(j.length))}}(typeof self>"u"?void 0===w?this:w:self)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)},119:Kt=>{Kt.exports=function w(B,T,S){function P(A,E){if(!T[A]){if(!B[A]){if(O)return O(A,!0);var k=new Error("Cannot find module '"+A+"'");throw k.code="MODULE_NOT_FOUND",k}var z=T[A]={exports:{}};B[A][0].call(z.exports,function(N){return P(B[A][1][N]||N)},z,z.exports,w,B,T,S)}return T[A].exports}for(var O=void 0,j=0;j<S.length;j++)P(S[j]);return P}({1:[function(w,B,T){(function(S){"use strict";var O,P=S.MutationObserver||S.WebKitMutationObserver;if(P){var j=0,A=new P(N),E=S.document.createTextNode("");A.observe(E,{characterData:!0}),O=function(){E.data=j=++j%2}}else if(!S.setImmediate&&typeof S.MessageChannel<"u"){var D=new S.MessageChannel;D.port1.onmessage=N,O=function(){D.port2.postMessage(0)}}else O="document"in S&&"onreadystatechange"in S.document.createElement("script")?function(){var de=S.document.createElement("script");de.onreadystatechange=function(){N(),de.onreadystatechange=null,de.parentNode.removeChild(de),de=null},S.document.documentElement.appendChild(de)}:function(){setTimeout(N,0)};var k,z=[];function N(){k=!0;for(var de,we,J=z.length;J;){for(we=z,z=[],de=-1;++de<J;)we[de]();J=z.length}k=!1}B.exports=function Q(de){1===z.push(de)&&!k&&O()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(w,B,T){"use strict";var S=w(1);function P(){}var O={},j=["REJECTED"],A=["FULFILLED"],E=["PENDING"];function D(ce){if("function"!=typeof ce)throw new TypeError("resolver must be a function");this.state=E,this.queue=[],this.outcome=void 0,ce!==P&&Q(this,ce)}function k(ce,_e,ue){this.promise=ce,"function"==typeof _e&&(this.onFulfilled=_e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof ue&&(this.onRejected=ue,this.callRejected=this.otherCallRejected)}function z(ce,_e,ue){S(function(){var Qe;try{Qe=_e(ue)}catch(pe){return O.reject(ce,pe)}Qe===ce?O.reject(ce,new TypeError("Cannot resolve promise with itself")):O.resolve(ce,Qe)})}function N(ce){var _e=ce&&ce.then;if(ce&&("object"==typeof ce||"function"==typeof ce)&&"function"==typeof _e)return function(){_e.apply(ce,arguments)}}function Q(ce,_e){var ue=!1;function Qe(Ye){ue||(ue=!0,O.reject(ce,Ye))}function pe(Ye){ue||(ue=!0,O.resolve(ce,Ye))}var R=de(function Se(){_e(pe,Qe)});"error"===R.status&&Qe(R.value)}function de(ce,_e){var ue={};try{ue.value=ce(_e),ue.status="success"}catch(Qe){ue.status="error",ue.value=Qe}return ue}B.exports=D,D.prototype.catch=function(ce){return this.then(null,ce)},D.prototype.then=function(ce,_e){if("function"!=typeof ce&&this.state===A||"function"!=typeof _e&&this.state===j)return this;var ue=new this.constructor(P);return this.state!==E?z(ue,this.state===A?ce:_e,this.outcome):this.queue.push(new k(ue,ce,_e)),ue},k.prototype.callFulfilled=function(ce){O.resolve(this.promise,ce)},k.prototype.otherCallFulfilled=function(ce){z(this.promise,this.onFulfilled,ce)},k.prototype.callRejected=function(ce){O.reject(this.promise,ce)},k.prototype.otherCallRejected=function(ce){z(this.promise,this.onRejected,ce)},O.resolve=function(ce,_e){var ue=de(N,_e);if("error"===ue.status)return O.reject(ce,ue.value);var Qe=ue.value;if(Qe)Q(ce,Qe);else{ce.state=A,ce.outcome=_e;for(var pe=-1,Se=ce.queue.length;++pe<Se;)ce.queue[pe].callFulfilled(_e)}return ce},O.reject=function(ce,_e){ce.state=j,ce.outcome=_e;for(var ue=-1,Qe=ce.queue.length;++ue<Qe;)ce.queue[ue].callRejected(_e);return ce},D.resolve=function we(ce){return ce instanceof this?ce:O.resolve(new this(P),ce)},D.reject=function J(ce){var _e=new this(P);return O.reject(_e,ce)},D.all=function ae(ce){var _e=this;if("[object Array]"!==Object.prototype.toString.call(ce))return this.reject(new TypeError("must be an array"));var ue=ce.length,Qe=!1;if(!ue)return this.resolve([]);for(var pe=new Array(ue),Se=0,R=-1,Ye=new this(P);++R<ue;)Bt(ce[R],R);return Ye;function Bt(Ve,Ot){_e.resolve(Ve).then(function ot(Tt){pe[Ot]=Tt,++Se===ue&&!Qe&&(Qe=!0,O.resolve(Ye,pe))},function(Tt){Qe||(Qe=!0,O.reject(Ye,Tt))})}},D.race=function te(ce){var _e=this;if("[object Array]"!==Object.prototype.toString.call(ce))return this.reject(new TypeError("must be an array"));var ue=ce.length,Qe=!1;if(!ue)return this.resolve([]);for(var pe=-1,Se=new this(P);++pe<ue;)_e.resolve(ce[pe]).then(function(Bt){Qe||(Qe=!0,O.resolve(Se,Bt))},function(Bt){Qe||(Qe=!0,O.reject(Se,Bt))});return Se}},{1:1}],3:[function(w,B,T){(function(S){"use strict";"function"!=typeof S.Promise&&(S.Promise=w(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(w,B,T){"use strict";var S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(re){return typeof re}:function(re){return re&&"function"==typeof Symbol&&re.constructor===Symbol&&re!==Symbol.prototype?"symbol":typeof re};var j=function O(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}();function E(re,be){re=re||[],be=be||{};try{return new Blob(re,be)}catch(Oe){if("TypeError"!==Oe.name)throw Oe;for(var Pe=new(typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder),Ne=0;Ne<re.length;Ne+=1)Pe.append(re[Ne]);return Pe.getBlob(be.type)}}typeof Promise>"u"&&w(3);var D=Promise;function k(re,be){be&&re.then(function(ie){be(null,ie)},function(ie){be(ie)})}function z(re,be,ie){"function"==typeof be&&re.then(be),"function"==typeof ie&&re.catch(ie)}function N(re){return"string"!=typeof re&&(console.warn(re+" used as a key, but it is not a string."),re=String(re)),re}function Q(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var de="local-forage-detect-blob-support",we=void 0,J={},ae=Object.prototype.toString,te="readonly",ce="readwrite";function _e(re){for(var be=re.length,ie=new ArrayBuffer(be),Pe=new Uint8Array(ie),Ne=0;Ne<be;Ne++)Pe[Ne]=re.charCodeAt(Ne);return ie}function Qe(re){return"boolean"==typeof we?D.resolve(we):function ue(re){return new D(function(be){var ie=re.transaction(de,ce),Pe=E([""]);ie.objectStore(de).put(Pe,"key"),ie.onabort=function(Ne){Ne.preventDefault(),Ne.stopPropagation(),be(!1)},ie.oncomplete=function(){var Ne=navigator.userAgent.match(/Chrome\/(\d+)/),Oe=navigator.userAgent.match(/Edge\//);be(Oe||!Ne||parseInt(Ne[1],10)>=43)}}).catch(function(){return!1})}(re).then(function(be){return we=be})}function pe(re){var be=J[re.name],ie={};ie.promise=new D(function(Pe,Ne){ie.resolve=Pe,ie.reject=Ne}),be.deferredOperations.push(ie),be.dbReady=be.dbReady?be.dbReady.then(function(){return ie.promise}):ie.promise}function Se(re){var ie=J[re.name].deferredOperations.pop();if(ie)return ie.resolve(),ie.promise}function R(re,be){var Pe=J[re.name].deferredOperations.pop();if(Pe)return Pe.reject(be),Pe.promise}function Ye(re,be){return new D(function(ie,Pe){if(J[re.name]=J[re.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},re.db){if(!be)return ie(re.db);pe(re),re.db.close()}var Ne=[re.name];be&&Ne.push(re.version);var Oe=j.open.apply(j,Ne);be&&(Oe.onupgradeneeded=function(yt){var Pt=Oe.result;try{Pt.createObjectStore(re.storeName),yt.oldVersion<=1&&Pt.createObjectStore(de)}catch(kt){if("ConstraintError"!==kt.name)throw kt;console.warn('The database "'+re.name+'" has been upgraded from version '+yt.oldVersion+" to version "+yt.newVersion+', but the storage "'+re.storeName+'" already exists.')}}),Oe.onerror=function(yt){yt.preventDefault(),Pe(Oe.error)},Oe.onsuccess=function(){var yt=Oe.result;yt.onversionchange=function(Pt){Pt.target.close()},ie(yt),Se(re)}})}function Bt(re){return Ye(re,!1)}function Ve(re){return Ye(re,!0)}function Ot(re,be){if(!re.db)return!0;var ie=!re.db.objectStoreNames.contains(re.storeName),Ne=re.version>re.db.version;if(re.version<re.db.version&&(re.version!==be&&console.warn('The database "'+re.name+"\" can't be downgraded from version "+re.db.version+" to version "+re.version+"."),re.version=re.db.version),Ne||ie){if(ie){var Oe=re.db.version+1;Oe>re.version&&(re.version=Oe)}return!0}return!1}function Tt(re){return E([_e(atob(re.data))],{type:re.type})}function Ze(re){return re&&re.__local_forage_encoded_blob}function et(re){var be=this,ie=be._initReady().then(function(){var Pe=J[be._dbInfo.name];if(Pe&&Pe.dbReady)return Pe.dbReady});return z(ie,re,re),ie}function Rt(re,be,ie,Pe){void 0===Pe&&(Pe=1);try{var Ne=re.db.transaction(re.storeName,be);ie(null,Ne)}catch(Oe){if(Pe>0&&(!re.db||"InvalidStateError"===Oe.name||"NotFoundError"===Oe.name))return D.resolve().then(function(){if(!re.db||"NotFoundError"===Oe.name&&!re.db.objectStoreNames.contains(re.storeName)&&re.version<=re.db.version)return re.db&&(re.version=re.db.version+1),Ve(re)}).then(function(){return function tn(re){pe(re);for(var be=J[re.name],ie=be.forages,Pe=0;Pe<ie.length;Pe++){var Ne=ie[Pe];Ne._dbInfo.db&&(Ne._dbInfo.db.close(),Ne._dbInfo.db=null)}return re.db=null,Bt(re).then(function(Oe){return re.db=Oe,Ot(re)?Ve(re):Oe}).then(function(Oe){re.db=be.db=Oe;for(var yt=0;yt<ie.length;yt++)ie[yt]._dbInfo.db=Oe}).catch(function(Oe){throw R(re,Oe),Oe})}(re).then(function(){Rt(re,be,ie,Pe-1)})}).catch(ie);ie(Oe)}}var Re={_driver:"asyncStorage",_initStorage:function mi(re){var be=this,ie={db:null};if(re)for(var Pe in re)ie[Pe]=re[Pe];var Ne=J[ie.name];Ne||(J[ie.name]=Ne={forages:[],db:null,dbReady:null,deferredOperations:[]}),Ne.forages.push(be),be._initReady||(be._initReady=be.ready,be.ready=et);var Oe=[];function yt(){return D.resolve()}for(var Pt=0;Pt<Ne.forages.length;Pt++){var kt=Ne.forages[Pt];kt!==be&&Oe.push(kt._initReady().catch(yt))}var Vt=Ne.forages.slice(0);return D.all(Oe).then(function(){return ie.db=Ne.db,Bt(ie)}).then(function(Xt){return ie.db=Xt,Ot(ie,be._defaultConfig.version)?Ve(ie):Xt}).then(function(Xt){ie.db=Ne.db=Xt,be._dbInfo=ie;for(var dn=0;dn<Vt.length;dn++){var Kn=Vt[dn];Kn!==be&&(Kn._dbInfo.db=ie.db,Kn._dbInfo.version=ie.version)}})},_support:function A(){try{if(!j||!j.open)return!1;var re=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),be="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!re||be)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}(),iterate:function At(re,be){var ie=this,Pe=new D(function(Ne,Oe){ie.ready().then(function(){Rt(ie._dbInfo,te,function(yt,Pt){if(yt)return Oe(yt);try{var Vt=Pt.objectStore(ie._dbInfo.storeName).openCursor(),Xt=1;Vt.onsuccess=function(){var dn=Vt.result;if(dn){var Kn=dn.value;Ze(Kn)&&(Kn=Tt(Kn));var _i=re(Kn,dn.key,Xt++);void 0!==_i?Ne(_i):dn.continue()}else Ne()},Vt.onerror=function(){Oe(Vt.error)}}catch(dn){Oe(dn)}})}).catch(Oe)});return k(Pe,be),Pe},getItem:function $t(re,be){var ie=this;re=N(re);var Pe=new D(function(Ne,Oe){ie.ready().then(function(){Rt(ie._dbInfo,te,function(yt,Pt){if(yt)return Oe(yt);try{var Vt=Pt.objectStore(ie._dbInfo.storeName).get(re);Vt.onsuccess=function(){var Xt=Vt.result;void 0===Xt&&(Xt=null),Ze(Xt)&&(Xt=Tt(Xt)),Ne(Xt)},Vt.onerror=function(){Oe(Vt.error)}}catch(Xt){Oe(Xt)}})}).catch(Oe)});return k(Pe,be),Pe},setItem:function Lt(re,be,ie){var Pe=this;re=N(re);var Ne=new D(function(Oe,yt){var Pt;Pe.ready().then(function(){return Pt=Pe._dbInfo,"[object Blob]"===ae.call(be)?Qe(Pt.db).then(function(kt){return kt?be:function ot(re){return new D(function(be,ie){var Pe=new FileReader;Pe.onerror=ie,Pe.onloadend=function(Ne){var Oe=btoa(Ne.target.result||"");be({__local_forage_encoded_blob:!0,data:Oe,type:re.type})},Pe.readAsBinaryString(re)})}(be)}):be}).then(function(kt){Rt(Pe._dbInfo,ce,function(Vt,Xt){if(Vt)return yt(Vt);try{var dn=Xt.objectStore(Pe._dbInfo.storeName);null===kt&&(kt=void 0);var Kn=dn.put(kt,re);Xt.oncomplete=function(){void 0===kt&&(kt=null),Oe(kt)},Xt.onabort=Xt.onerror=function(){yt(Kn.error?Kn.error:Kn.transaction.error)}}catch(_i){yt(_i)}})}).catch(yt)});return k(Ne,ie),Ne},removeItem:function Cn(re,be){var ie=this;re=N(re);var Pe=new D(function(Ne,Oe){ie.ready().then(function(){Rt(ie._dbInfo,ce,function(yt,Pt){if(yt)return Oe(yt);try{var Vt=Pt.objectStore(ie._dbInfo.storeName).delete(re);Pt.oncomplete=function(){Ne()},Pt.onerror=function(){Oe(Vt.error)},Pt.onabort=function(){Oe(Vt.error?Vt.error:Vt.transaction.error)}}catch(Xt){Oe(Xt)}})}).catch(Oe)});return k(Pe,be),Pe},clear:function fn(re){var be=this,ie=new D(function(Pe,Ne){be.ready().then(function(){Rt(be._dbInfo,ce,function(Oe,yt){if(Oe)return Ne(Oe);try{var kt=yt.objectStore(be._dbInfo.storeName).clear();yt.oncomplete=function(){Pe()},yt.onabort=yt.onerror=function(){Ne(kt.error?kt.error:kt.transaction.error)}}catch(Vt){Ne(Vt)}})}).catch(Ne)});return k(ie,re),ie},length:function oi(re){var be=this,ie=new D(function(Pe,Ne){be.ready().then(function(){Rt(be._dbInfo,te,function(Oe,yt){if(Oe)return Ne(Oe);try{var kt=yt.objectStore(be._dbInfo.storeName).count();kt.onsuccess=function(){Pe(kt.result)},kt.onerror=function(){Ne(kt.error)}}catch(Vt){Ne(Vt)}})}).catch(Ne)});return k(ie,re),ie},key:function Dn(re,be){var ie=this,Pe=new D(function(Ne,Oe){re<0?Ne(null):ie.ready().then(function(){Rt(ie._dbInfo,te,function(yt,Pt){if(yt)return Oe(yt);try{var kt=Pt.objectStore(ie._dbInfo.storeName),Vt=!1,Xt=kt.openKeyCursor();Xt.onsuccess=function(){var dn=Xt.result;dn?0===re||Vt?Ne(dn.key):(Vt=!0,dn.advance(re)):Ne(null)},Xt.onerror=function(){Oe(Xt.error)}}catch(dn){Oe(dn)}})}).catch(Oe)});return k(Pe,be),Pe},keys:function F(re){var be=this,ie=new D(function(Pe,Ne){be.ready().then(function(){Rt(be._dbInfo,te,function(Oe,yt){if(Oe)return Ne(Oe);try{var kt=yt.objectStore(be._dbInfo.storeName).openKeyCursor(),Vt=[];kt.onsuccess=function(){var Xt=kt.result;Xt?(Vt.push(Xt.key),Xt.continue()):Pe(Vt)},kt.onerror=function(){Ne(kt.error)}}catch(Xt){Ne(Xt)}})}).catch(Ne)});return k(ie,re),ie},dropInstance:function Ae(re,be){be=Q.apply(this,arguments);var Ne,ie=this.config();return(re="function"!=typeof re&&re||{}).name||(re.name=re.name||ie.name,re.storeName=re.storeName||ie.storeName),k(Ne=re.name?(re.name===ie.name&&this._dbInfo.db?D.resolve(this._dbInfo.db):Bt(re).then(function(Pt){var kt=J[re.name],Vt=kt.forages;kt.db=Pt;for(var Xt=0;Xt<Vt.length;Xt++)Vt[Xt]._dbInfo.db=Pt;return Pt})).then(re.storeName?function(Pt){if(Pt.objectStoreNames.contains(re.storeName)){var kt=Pt.version+1;pe(re);var Vt=J[re.name],Xt=Vt.forages;Pt.close();for(var dn=0;dn<Xt.length;dn++){var Kn=Xt[dn];Kn._dbInfo.db=null,Kn._dbInfo.version=kt}return new D(function(xi,Z){var oe=j.open(re.name,kt);oe.onerror=function(ve){oe.result.close(),Z(ve)},oe.onupgradeneeded=function(){oe.result.deleteObjectStore(re.storeName)},oe.onsuccess=function(){var ve=oe.result;ve.close(),xi(ve)}}).then(function(xi){Vt.db=xi;for(var Z=0;Z<Xt.length;Z++){var oe=Xt[Z];oe._dbInfo.db=xi,Se(oe._dbInfo)}}).catch(function(xi){throw(R(re,xi)||D.resolve()).catch(function(){}),xi})}}:function(Pt){pe(re);var kt=J[re.name],Vt=kt.forages;Pt.close();for(var Xt=0;Xt<Vt.length;Xt++)Vt[Xt]._dbInfo.db=null;return new D(function(_i,xi){var Z=j.deleteDatabase(re.name);Z.onerror=function(){var oe=Z.result;oe&&oe.close(),xi(Z.error)},Z.onblocked=function(){console.warn('dropInstance blocked for database "'+re.name+'" until all open connections are closed')},Z.onsuccess=function(){var oe=Z.result;oe&&oe.close(),_i(oe)}}).then(function(_i){kt.db=_i;for(var xi=0;xi<Vt.length;xi++)Se(Vt[xi]._dbInfo)}).catch(function(_i){throw(R(re,_i)||D.resolve()).catch(function(){}),_i})}):D.reject("Invalid arguments"),be),Ne}};var se="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",dt=/^~~local_forage_type~([^~]+)~/,vt="__lfsc__:",Mt="arbf",Ht="blob",rs=Object.prototype.toString;function Nr(re){var Pe,Oe,yt,Pt,kt,be=.75*re.length,ie=re.length,Ne=0;"="===re[re.length-1]&&(be--,"="===re[re.length-2]&&be--);var Vt=new ArrayBuffer(be),Xt=new Uint8Array(Vt);for(Pe=0;Pe<ie;Pe+=4)Oe=se.indexOf(re[Pe]),yt=se.indexOf(re[Pe+1]),Pt=se.indexOf(re[Pe+2]),kt=se.indexOf(re[Pe+3]),Xt[Ne++]=Oe<<2|yt>>4,Xt[Ne++]=(15&yt)<<4|Pt>>2,Xt[Ne++]=(3&Pt)<<6|63&kt;return Vt}function ca(re){var Pe,be=new Uint8Array(re),ie="";for(Pe=0;Pe<be.length;Pe+=3)ie+=se[be[Pe]>>2],ie+=se[(3&be[Pe])<<4|be[Pe+1]>>4],ie+=se[(15&be[Pe+1])<<2|be[Pe+2]>>6],ie+=se[63&be[Pe+2]];return be.length%3==2?ie=ie.substring(0,ie.length-1)+"=":be.length%3==1&&(ie=ie.substring(0,ie.length-2)+"=="),ie}var ka={serialize:function Da(re,be){var ie="";if(re&&(ie=rs.call(re)),re&&("[object ArrayBuffer]"===ie||re.buffer&&"[object ArrayBuffer]"===rs.call(re.buffer))){var Pe,Ne=vt;re instanceof ArrayBuffer?(Pe=re,Ne+=Mt):(Pe=re.buffer,"[object Int8Array]"===ie?Ne+="si08":"[object Uint8Array]"===ie?Ne+="ui08":"[object Uint8ClampedArray]"===ie?Ne+="uic8":"[object Int16Array]"===ie?Ne+="si16":"[object Uint16Array]"===ie?Ne+="ur16":"[object Int32Array]"===ie?Ne+="si32":"[object Uint32Array]"===ie?Ne+="ui32":"[object Float32Array]"===ie?Ne+="fl32":"[object Float64Array]"===ie?Ne+="fl64":be(new Error("Failed to get type for BinaryArray"))),be(Ne+ca(Pe))}else if("[object Blob]"===ie){var Oe=new FileReader;Oe.onload=function(){var yt="~~local_forage_type~"+re.type+"~"+ca(this.result);be(vt+Ht+yt)},Oe.readAsArrayBuffer(re)}else try{be(JSON.stringify(re))}catch(yt){console.error("Couldn't convert value into a JSON string: ",re),be(null,yt)}},deserialize:function ua(re){if(re.substring(0,9)!==vt)return JSON.parse(re);var Pe,be=re.substring(13),ie=re.substring(9,13);if(ie===Ht&&dt.test(be)){var Ne=be.match(dt);Pe=Ne[1],be=be.substring(Ne[0].length)}var Oe=Nr(be);switch(ie){case Mt:return Oe;case Ht:return E([Oe],{type:Pe});case"si08":return new Int8Array(Oe);case"ui08":return new Uint8Array(Oe);case"uic8":return new Uint8ClampedArray(Oe);case"si16":return new Int16Array(Oe);case"ur16":return new Uint16Array(Oe);case"si32":return new Int32Array(Oe);case"ui32":return new Uint32Array(Oe);case"fl32":return new Float32Array(Oe);case"fl64":return new Float64Array(Oe);default:throw new Error("Unkown type: "+ie)}},stringToBuffer:Nr,bufferToString:ca};function Oa(re,be,ie,Pe){re.executeSql("CREATE TABLE IF NOT EXISTS "+be.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],ie,Pe)}function ro(re,be,ie,Pe,Ne,Oe){re.executeSql(ie,Pe,Ne,function(yt,Pt){Pt.code===Pt.SYNTAX_ERR?yt.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[be.storeName],function(kt,Vt){Vt.rows.length?Oe(kt,Pt):Oa(kt,be,function(){kt.executeSql(ie,Pe,Ne,Oe)},Oe)},Oe):Oe(yt,Pt)},Oe)}function sc(re,be,ie,Pe){var Ne=this;re=N(re);var Oe=new D(function(yt,Pt){Ne.ready().then(function(){void 0===be&&(be=null);var kt=be,Vt=Ne._dbInfo;Vt.serializer.serialize(be,function(Xt,dn){dn?Pt(dn):Vt.db.transaction(function(Kn){ro(Kn,Vt,"INSERT OR REPLACE INTO "+Vt.storeName+" (key, value) VALUES (?, ?)",[re,Xt],function(){yt(kt)},function(_i,xi){Pt(xi)})},function(Kn){if(Kn.code===Kn.QUOTA_ERR){if(Pe>0)return void yt(sc.apply(Ne,[re,kt,ie,Pe-1]));Pt(Kn)}})})}).catch(Pt)});return k(Oe,ie),Oe}var Ol={_driver:"webSQLStorage",_initStorage:function xs(re){var be=this,ie={db:null};if(re)for(var Pe in re)ie[Pe]="string"!=typeof re[Pe]?re[Pe].toString():re[Pe];var Ne=new D(function(Oe,yt){try{ie.db=openDatabase(ie.name,String(ie.version),ie.description,ie.size)}catch(Pt){return yt(Pt)}ie.db.transaction(function(Pt){Oa(Pt,ie,function(){be._dbInfo=ie,Oe()},function(kt,Vt){yt(Vt)})},yt)});return ie.serializer=ka,Ne},_support:function fe(){return"function"==typeof openDatabase}(),iterate:function Gu(re,be){var ie=this,Pe=new D(function(Ne,Oe){ie.ready().then(function(){var yt=ie._dbInfo;yt.db.transaction(function(Pt){ro(Pt,yt,"SELECT * FROM "+yt.storeName,[],function(kt,Vt){for(var Xt=Vt.rows,dn=Xt.length,Kn=0;Kn<dn;Kn++){var _i=Xt.item(Kn),xi=_i.value;if(xi&&(xi=yt.serializer.deserialize(xi)),void 0!==(xi=re(xi,_i.key,Kn+1)))return void Ne(xi)}Ne()},function(kt,Vt){Oe(Vt)})})}).catch(Oe)});return k(Pe,be),Pe},getItem:function oc(re,be){var ie=this;re=N(re);var Pe=new D(function(Ne,Oe){ie.ready().then(function(){var yt=ie._dbInfo;yt.db.transaction(function(Pt){ro(Pt,yt,"SELECT * FROM "+yt.storeName+" WHERE key = ? LIMIT 1",[re],function(kt,Vt){var Xt=Vt.rows.length?Vt.rows.item(0).value:null;Xt&&(Xt=yt.serializer.deserialize(Xt)),Ne(Xt)},function(kt,Vt){Oe(Vt)})})}).catch(Oe)});return k(Pe,be),Pe},setItem:function qi(re,be,ie){return sc.apply(this,[re,be,ie,1])},removeItem:function Wu(re,be){var ie=this;re=N(re);var Pe=new D(function(Ne,Oe){ie.ready().then(function(){var yt=ie._dbInfo;yt.db.transaction(function(Pt){ro(Pt,yt,"DELETE FROM "+yt.storeName+" WHERE key = ?",[re],function(){Ne()},function(kt,Vt){Oe(Vt)})})}).catch(Oe)});return k(Pe,be),Pe},clear:function uh(re){var be=this,ie=new D(function(Pe,Ne){be.ready().then(function(){var Oe=be._dbInfo;Oe.db.transaction(function(yt){ro(yt,Oe,"DELETE FROM "+Oe.storeName,[],function(){Pe()},function(Pt,kt){Ne(kt)})})}).catch(Ne)});return k(ie,re),ie},length:function $u(re){var be=this,ie=new D(function(Pe,Ne){be.ready().then(function(){var Oe=be._dbInfo;Oe.db.transaction(function(yt){ro(yt,Oe,"SELECT COUNT(key) as c FROM "+Oe.storeName,[],function(Pt,kt){var Vt=kt.rows.item(0).c;Pe(Vt)},function(Pt,kt){Ne(kt)})})}).catch(Ne)});return k(ie,re),ie},key:function Yu(re,be){var ie=this,Pe=new D(function(Ne,Oe){ie.ready().then(function(){var yt=ie._dbInfo;yt.db.transaction(function(Pt){ro(Pt,yt,"SELECT key FROM "+yt.storeName+" WHERE id = ? LIMIT 1",[re+1],function(kt,Vt){var Xt=Vt.rows.length?Vt.rows.item(0).key:null;Ne(Xt)},function(kt,Vt){Oe(Vt)})})}).catch(Oe)});return k(Pe,be),Pe},keys:function zs(re){var be=this,ie=new D(function(Pe,Ne){be.ready().then(function(){var Oe=be._dbInfo;Oe.db.transaction(function(yt){ro(yt,Oe,"SELECT key FROM "+Oe.storeName,[],function(Pt,kt){for(var Vt=[],Xt=0;Xt<kt.rows.length;Xt++)Vt.push(kt.rows.item(Xt).key);Pe(Vt)},function(Pt,kt){Ne(kt)})})}).catch(Ne)});return k(ie,re),ie},dropInstance:function ac(re,be){be=Q.apply(this,arguments);var ie=this.config();(re="function"!=typeof re&&re||{}).name||(re.name=re.name||ie.name,re.storeName=re.storeName||ie.storeName);var Ne,Pe=this;return k(Ne=re.name?new D(function(Oe){var yt;yt=re.name===ie.name?Pe._dbInfo.db:openDatabase(re.name,"","",0),Oe(re.storeName?{db:yt,storeNames:[re.storeName]}:function Zu(re){return new D(function(be,ie){re.transaction(function(Pe){Pe.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(Ne,Oe){for(var yt=[],Pt=0;Pt<Oe.rows.length;Pt++)yt.push(Oe.rows.item(Pt).name);be({db:re,storeNames:yt})},function(Ne,Oe){ie(Oe)})},function(Pe){ie(Pe)})})}(yt))}).then(function(Oe){return new D(function(yt,Pt){Oe.db.transaction(function(kt){function Vt(_i){return new D(function(xi,Z){kt.executeSql("DROP TABLE IF EXISTS "+_i,[],function(){xi()},function(oe,ve){Z(ve)})})}for(var Xt=[],dn=0,Kn=Oe.storeNames.length;dn<Kn;dn++)Xt.push(Vt(Oe.storeNames[dn]));D.all(Xt).then(function(){yt()}).catch(function(_i){Pt(_i)})},function(kt){Pt(kt)})})}):D.reject("Invalid arguments"),be),Ne}};function oo(re,be){var ie=re.name+"/";return re.storeName!==be.storeName&&(ie+=re.storeName+"/"),ie}function Oo(){return!function qu(){var re="_localforage_support_test";try{return localStorage.setItem(re,!0),localStorage.removeItem(re),!1}catch{return!0}}()||localStorage.length>0}var ws={_driver:"localStorageWrapper",_initStorage:function jf(re){var ie={};if(re)for(var Pe in re)ie[Pe]=re[Pe];return ie.keyPrefix=oo(re,this._defaultConfig),Oo()?(this._dbInfo=ie,ie.serializer=ka,D.resolve()):D.reject()},_support:function xo(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}(),iterate:function Aa(re,be){var ie=this,Pe=ie.ready().then(function(){for(var Ne=ie._dbInfo,Oe=Ne.keyPrefix,yt=Oe.length,Pt=localStorage.length,kt=1,Vt=0;Vt<Pt;Vt++){var Xt=localStorage.key(Vt);if(0===Xt.indexOf(Oe)){var dn=localStorage.getItem(Xt);if(dn&&(dn=Ne.serializer.deserialize(dn)),void 0!==(dn=re(dn,Xt.substring(yt),kt++)))return dn}}});return k(Pe,be),Pe},getItem:function mt(re,be){var ie=this;re=N(re);var Pe=ie.ready().then(function(){var Ne=ie._dbInfo,Oe=localStorage.getItem(Ne.keyPrefix+re);return Oe&&(Oe=Ne.serializer.deserialize(Oe)),Oe});return k(Pe,be),Pe},setItem:function da(re,be,ie){var Pe=this;re=N(re);var Ne=Pe.ready().then(function(){void 0===be&&(be=null);var Oe=be;return new D(function(yt,Pt){var kt=Pe._dbInfo;kt.serializer.serialize(be,function(Vt,Xt){if(Xt)Pt(Xt);else try{localStorage.setItem(kt.keyPrefix+re,Vt),yt(Oe)}catch(dn){("QuotaExceededError"===dn.name||"NS_ERROR_DOM_QUOTA_REACHED"===dn.name)&&Pt(dn),Pt(dn)}})})});return k(Ne,ie),Ne},removeItem:function Xu(re,be){var ie=this;re=N(re);var Pe=ie.ready().then(function(){localStorage.removeItem(ie._dbInfo.keyPrefix+re)});return k(Pe,be),Pe},clear:function qc(re){var be=this,ie=be.ready().then(function(){for(var Pe=be._dbInfo.keyPrefix,Ne=localStorage.length-1;Ne>=0;Ne--){var Oe=localStorage.key(Ne);0===Oe.indexOf(Pe)&&localStorage.removeItem(Oe)}});return k(ie,re),ie},length:function dh(re){var ie=this.keys().then(function(Pe){return Pe.length});return k(ie,re),ie},key:function Al(re,be){var ie=this,Pe=ie.ready().then(function(){var Oe,Ne=ie._dbInfo;try{Oe=localStorage.key(re)}catch{Oe=null}return Oe&&(Oe=Oe.substring(Ne.keyPrefix.length)),Oe});return k(Pe,be),Pe},keys:function lc(re){var be=this,ie=be.ready().then(function(){for(var Pe=be._dbInfo,Ne=localStorage.length,Oe=[],yt=0;yt<Ne;yt++){var Pt=localStorage.key(yt);0===Pt.indexOf(Pe.keyPrefix)&&Oe.push(Pt.substring(Pe.keyPrefix.length))}return Oe});return k(ie,re),ie},dropInstance:function Ao(re,be){if(be=Q.apply(this,arguments),!(re="function"!=typeof re&&re||{}).name){var ie=this.config();re.name=re.name||ie.name,re.storeName=re.storeName||ie.storeName}var Ne,Pe=this;return k(Ne=re.name?new D(function(Oe){Oe(re.storeName?oo(re,Pe._defaultConfig):re.name+"/")}).then(function(Oe){for(var yt=localStorage.length-1;yt>=0;yt--){var Pt=localStorage.key(yt);0===Pt.indexOf(Oe)&&localStorage.removeItem(Pt)}}):D.reject("Invalid arguments"),be),Ne}},Hs=function(be,ie){return be===ie||"number"==typeof be&&"number"==typeof ie&&isNaN(be)&&isNaN(ie)},os=function(be,ie){for(var Pe=be.length,Ne=0;Ne<Pe;){if(Hs(be[Ne],ie))return!0;Ne++}return!1},Xc=Array.isArray||function(re){return"[object Array]"===Object.prototype.toString.call(re)},Es={},Is={},Xr={INDEXEDDB:Re,WEBSQL:Ol,LOCALSTORAGE:ws},li=[Xr.INDEXEDDB._driver,Xr.WEBSQL._driver,Xr.LOCALSTORAGE._driver],ss=["dropInstance"],as=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ss),hi={description:"",driver:li.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Ts(re,be){re[be]=function(){var ie=arguments;return re.ready().then(function(){return re[be].apply(re,ie)})}}function Ti(){for(var re=1;re<arguments.length;re++){var be=arguments[re];if(be)for(var ie in be)be.hasOwnProperty(ie)&&(arguments[0][ie]=Xc(be[ie])?be[ie].slice():be[ie])}return arguments[0]}var cc=function(){function re(be){for(var ie in function P(re,be){if(!(re instanceof be))throw new TypeError("Cannot call a class as a function")}(this,re),Xr)if(Xr.hasOwnProperty(ie)){var Pe=Xr[ie],Ne=Pe._driver;this[ie]=Ne,Es[Ne]||this.defineDriver(Pe)}this._defaultConfig=Ti({},hi),this._config=Ti({},this._defaultConfig,be),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return re.prototype.config=function(ie){if("object"===(typeof ie>"u"?"undefined":S(ie))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var Pe in ie){if("storeName"===Pe&&(ie[Pe]=ie[Pe].replace(/\W/g,"_")),"version"===Pe&&"number"!=typeof ie[Pe])return new Error("Database version must be a number.");this._config[Pe]=ie[Pe]}return!("driver"in ie)||!ie.driver||this.setDriver(this._config.driver)}return"string"==typeof ie?this._config[ie]:this._config},re.prototype.defineDriver=function(ie,Pe,Ne){var Oe=new D(function(yt,Pt){try{var kt=ie._driver,Vt=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!ie._driver)return void Pt(Vt);for(var Xt=as.concat("_initStorage"),dn=0,Kn=Xt.length;dn<Kn;dn++){var _i=Xt[dn];if((!os(ss,_i)||ie[_i])&&"function"!=typeof ie[_i])return void Pt(Vt)}!function(){for(var De=function(Vr){return function(){var nn=new Error("Method "+Vr+" is not implemented by the current driver"),Ss=D.reject(nn);return k(Ss,arguments[arguments.length-1]),Ss}},Ft=0,sn=ss.length;Ft<sn;Ft++){var Yn=ss[Ft];ie[Yn]||(ie[Yn]=De(Yn))}}();var oe=function(De){Es[kt]&&console.info("Redefining LocalForage driver: "+kt),Es[kt]=ie,Is[kt]=De,yt()};"_support"in ie?ie._support&&"function"==typeof ie._support?ie._support().then(oe,Pt):oe(!!ie._support):oe(!0)}catch(ve){Pt(ve)}});return z(Oe,Pe,Ne),Oe},re.prototype.driver=function(){return this._driver||null},re.prototype.getDriver=function(ie,Pe,Ne){var Oe=Es[ie]?D.resolve(Es[ie]):D.reject(new Error("Driver not found."));return z(Oe,Pe,Ne),Oe},re.prototype.getSerializer=function(ie){var Pe=D.resolve(ka);return z(Pe,ie),Pe},re.prototype.ready=function(ie){var Pe=this,Ne=Pe._driverSet.then(function(){return null===Pe._ready&&(Pe._ready=Pe._initDriver()),Pe._ready});return z(Ne,ie,ie),Ne},re.prototype.setDriver=function(ie,Pe,Ne){var Oe=this;Xc(ie)||(ie=[ie]);var yt=this._getSupportedDrivers(ie);function Pt(){Oe._config.driver=Oe.driver()}function kt(dn){return Oe._extend(dn),Pt(),Oe._ready=Oe._initStorage(Oe._config),Oe._ready}var Xt=null!==this._driverSet?this._driverSet.catch(function(){return D.resolve()}):D.resolve();return this._driverSet=Xt.then(function(){var dn=yt[0];return Oe._dbInfo=null,Oe._ready=null,Oe.getDriver(dn).then(function(Kn){Oe._driver=Kn._driver,Pt(),Oe._wrapLibraryMethodsWithReady(),Oe._initDriver=function Vt(dn){return function(){var Kn=0;return function _i(){for(;Kn<dn.length;){var xi=dn[Kn];return Kn++,Oe._dbInfo=null,Oe._ready=null,Oe.getDriver(xi).then(kt).catch(_i)}Pt();var Z=new Error("No available storage method found.");return Oe._driverSet=D.reject(Z),Oe._driverSet}()}}(yt)})}).catch(function(){Pt();var dn=new Error("No available storage method found.");return Oe._driverSet=D.reject(dn),Oe._driverSet}),z(this._driverSet,Pe,Ne),this._driverSet},re.prototype.supports=function(ie){return!!Is[ie]},re.prototype._extend=function(ie){Ti(this,ie)},re.prototype._getSupportedDrivers=function(ie){for(var Pe=[],Ne=0,Oe=ie.length;Ne<Oe;Ne++){var yt=ie[Ne];this.supports(yt)&&Pe.push(yt)}return Pe},re.prototype._wrapLibraryMethodsWithReady=function(){for(var ie=0,Pe=as.length;ie<Pe;ie++)Ts(this,as[ie])},re.prototype.createInstance=function(ie){return new re(ie)},re}(),hh=new cc;B.exports=hh},{3:3}]},{},[4])(4)},7376:function(Kt,X,me){var L;Kt=me.nmd(Kt),function(){var w,P="Expected a function",j="__lodash_hash_undefined__",E="__lodash_placeholder__",Tt=1/0,Ze=9007199254740991,Rt=4294967295,$t=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],At="[object Arguments]",Lt="[object Array]",fn="[object Boolean]",oi="[object Date]",F="[object Error]",Ae="[object Function]",Re="[object GeneratorFunction]",fe="[object Map]",se="[object Number]",dt="[object Object]",vt="[object Promise]",Mt="[object RegExp]",Ht="[object Set]",Dt="[object String]",hn="[object Symbol]",jn="[object WeakMap]",yo="[object ArrayBuffer]",ji="[object DataView]",Co="[object Float32Array]",Pi="[object Float64Array]",jo="[object Int8Array]",rs="[object Int16Array]",Nr="[object Int32Array]",ca="[object Uint8Array]",Da="[object Uint8ClampedArray]",ua="[object Uint16Array]",ka="[object Uint32Array]",Oa=/\b__p \+= '';/g,xs=/\b(__p \+=) '' \+/g,ro=/(__e\(.*?\)|\b__t\)) \+\n'';/g,oc=/&(?:amp|lt|gt|quot|#39);/g,Gu=/[&<>"']/g,sc=RegExp(oc.source),qi=RegExp(Gu.source),Wu=/<%-([\s\S]+?)%>/g,uh=/<%([\s\S]+?)%>/g,$u=/<%=([\s\S]+?)%>/g,Yu=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,zs=/^\w*$/,Zu=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ac=/[\\^$.*+?()[\]{}|]/g,Ol=RegExp(ac.source),xo=/^\s+/,oo=/\s/,qu=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Oo=/\{\n\/\* \[wrapped with (.+)\] \*/,jf=/,? & /,qc=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,mt=/[()=,{}\[\]\/\s]/,Aa=/\\(\\)?/g,Al=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,lc=/\w*$/,dh=/^[-+]0x[0-9a-f]+$/i,Xu=/^0b[01]+$/i,da=/^\[object .+?Constructor\]$/,Ao=/^0o[0-7]+$/i,ws=/^(?:0|[1-9]\d*)$/,Hs=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,os=/($^)/,Xc=/['\n\r\u2028\u2029\\]/g,Es="\\ud800-\\udfff",ss="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",as="\\u2700-\\u27bf",hi="a-z\\xdf-\\xf6\\xf8-\\xff",re="A-Z\\xc0-\\xd6\\xd8-\\xde",be="\\ufe0e\\ufe0f",ie="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ne="["+Es+"]",Oe="["+ie+"]",yt="["+ss+"]",Pt="\\d+",kt="["+as+"]",Vt="["+hi+"]",Xt="[^"+Es+ie+Pt+as+hi+re+"]",dn="\\ud83c[\\udffb-\\udfff]",_i="[^"+Es+"]",xi="(?:\\ud83c[\\udde6-\\uddff]){2}",Z="[\\ud800-\\udbff][\\udc00-\\udfff]",oe="["+re+"]",De="(?:"+Vt+"|"+Xt+")",Ft="(?:"+oe+"|"+Xt+")",sn="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",Yn="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Hr="(?:"+yt+"|"+dn+")?",Vr="["+be+"]?",fh=Vr+Hr+"(?:\\u200d(?:"+[_i,xi,Z].join("|")+")"+Vr+Hr+")*",RS="(?:"+[kt,xi,Z].join("|")+")"+fh,Db="(?:"+[_i+yt+"?",yt,xi,Z,Ne].join("|")+")",XC=RegExp("['\u2019]","g"),Gf=RegExp(yt,"g"),Ku=RegExp(dn+"(?="+dn+")|"+Db+fh,"g"),hm=RegExp([oe+"?"+Vt+"+"+sn+"(?="+[Oe,oe,"$"].join("|")+")",Ft+"+"+Yn+"(?="+[Oe,oe+De,"$"].join("|")+")",oe+"?"+De+"+"+sn,oe+"+"+Yn,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Pt,RS].join("|"),"g"),kb=RegExp("[\\u200d"+Es+ss+be+"]"),KC=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,mn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],fm=-1,Qi={};Qi[Co]=Qi[Pi]=Qi[jo]=Qi[rs]=Qi[Nr]=Qi[ca]=Qi[Da]=Qi[ua]=Qi[ka]=!0,Qi[At]=Qi[Lt]=Qi[yo]=Qi[fn]=Qi[ji]=Qi[oi]=Qi[F]=Qi[Ae]=Qi[fe]=Qi[se]=Qi[dt]=Qi[Mt]=Qi[Ht]=Qi[Dt]=Qi[jn]=!1;var Ji={};Ji[At]=Ji[Lt]=Ji[yo]=Ji[ji]=Ji[fn]=Ji[oi]=Ji[Co]=Ji[Pi]=Ji[jo]=Ji[rs]=Ji[Nr]=Ji[fe]=Ji[se]=Ji[dt]=Ji[Mt]=Ji[Ht]=Ji[Dt]=Ji[hn]=Ji[ca]=Ji[Da]=Ji[ua]=Ji[ka]=!0,Ji[F]=Ji[Ae]=Ji[jn]=!1;var LS={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},BS=parseFloat,US=parseInt,JC="object"==typeof global&&global&&global.Object===Object&&global,mm="object"==typeof self&&self&&self.Object===Object&&self,jr=JC||mm||Function("return this")(),Wf=X&&!X.nodeType&&X,Kc=Wf&&Kt&&!Kt.nodeType&&Kt,_m=Kc&&Kc.exports===Wf,Pa=_m&&JC.process,Go=function(){try{return Kc&&Kc.require&&Kc.require("util").types||Pa&&Pa.binding&&Pa.binding("util")}catch{}}(),bm=Go&&Go.isArrayBuffer,Hn=Go&&Go.isDate,ki=Go&&Go.isMap,ex=Go&&Go.isRegExp,Ob=Go&&Go.isSet,Ab=Go&&Go.isTypedArray;function fa(Ce,Ct,ut){switch(ut.length){case 0:return Ce.call(Ct);case 1:return Ce.call(Ct,ut[0]);case 2:return Ce.call(Ct,ut[0],ut[1]);case 3:return Ce.call(Ct,ut[0],ut[1],ut[2])}return Ce.apply(Ct,ut)}function tx(Ce,Ct,ut,cn){for(var Gn=-1,vi=null==Ce?0:Ce.length;++Gn<vi;){var Qr=Ce[Gn];Ct(cn,Qr,ut(Qr),Ce)}return cn}function Ms(Ce,Ct){for(var ut=-1,cn=null==Ce?0:Ce.length;++ut<cn&&!1!==Ct(Ce[ut],ut,Ce););return Ce}function bi(Ce,Ct){for(var ut=null==Ce?0:Ce.length;ut--&&!1!==Ct(Ce[ut],ut,Ce););return Ce}function $f(Ce,Ct){for(var ut=-1,cn=null==Ce?0:Ce.length;++ut<cn;)if(!Ct(Ce[ut],ut,Ce))return!1;return!0}function Pl(Ce,Ct){for(var ut=-1,cn=null==Ce?0:Ce.length,Gn=0,vi=[];++ut<cn;){var Qr=Ce[ut];Ct(Qr,ut,Ce)&&(vi[Gn++]=Qr)}return vi}function Po(Ce,Ct){return!(null==Ce||!Ce.length)&&Ju(Ce,Ct,0)>-1}function Yf(Ce,Ct,ut){for(var cn=-1,Gn=null==Ce?0:Ce.length;++cn<Gn;)if(ut(Ct,Ce[cn]))return!0;return!1}function Tr(Ce,Ct){for(var ut=-1,cn=null==Ce?0:Ce.length,Gn=Array(cn);++ut<cn;)Gn[ut]=Ct(Ce[ut],ut,Ce);return Gn}function Qc(Ce,Ct){for(var ut=-1,cn=Ct.length,Gn=Ce.length;++ut<cn;)Ce[Gn+ut]=Ct[ut];return Ce}function Jc(Ce,Ct,ut,cn){var Gn=-1,vi=null==Ce?0:Ce.length;for(cn&&vi&&(ut=Ce[++Gn]);++Gn<vi;)ut=Ct(ut,Ce[Gn],Gn,Ce);return ut}function vm(Ce,Ct,ut,cn){var Gn=null==Ce?0:Ce.length;for(cn&&Gn&&(ut=Ce[--Gn]);Gn--;)ut=Ct(ut,Ce[Gn],Gn,Ce);return ut}function Qu(Ce,Ct){for(var ut=-1,cn=null==Ce?0:Ce.length;++ut<cn;)if(Ct(Ce[ut],ut,Ce))return!0;return!1}var nx=Zf("length");function ym(Ce,Ct,ut){var cn;return ut(Ce,function(Gn,vi,Qr){if(Ct(Gn,vi,Qr))return cn=vi,!1}),cn}function Fl(Ce,Ct,ut,cn){for(var Gn=Ce.length,vi=ut+(cn?1:-1);cn?vi--:++vi<Gn;)if(Ct(Ce[vi],vi,Ce))return vi;return-1}function Ju(Ce,Ct,ut){return Ct==Ct?function td(Ce,Ct,ut){for(var cn=ut-1,Gn=Ce.length;++cn<Gn;)if(Ce[cn]===Ct)return cn;return-1}(Ce,Ct,ut):Fl(Ce,Pb,ut)}function uc(Ce,Ct,ut,cn){for(var Gn=ut-1,vi=Ce.length;++Gn<vi;)if(cn(Ce[Gn],Ct))return Gn;return-1}function Pb(Ce){return Ce!=Ce}function Nn(Ce,Ct){var ut=null==Ce?0:Ce.length;return ut?eu(Ce,Ct)/ut:NaN}function Zf(Ce){return function(Ct){return null==Ct?w:Ct[Ce]}}function kn(Ce){return function(Ct){return null==Ce?w:Ce[Ct]}}function ph(Ce,Ct,ut,cn,Gn){return Gn(Ce,function(vi,Qr,Xi){ut=cn?(cn=!1,vi):Ct(ut,vi,Qr,Xi)}),ut}function eu(Ce,Ct){for(var ut,cn=-1,Gn=Ce.length;++cn<Gn;){var vi=Ct(Ce[cn]);vi!==w&&(ut=ut===w?vi:ut+vi)}return ut}function xm(Ce,Ct){for(var ut=-1,cn=Array(Ce);++ut<Ce;)cn[ut]=Ct(ut);return cn}function Fb(Ce){return Ce&&Ce.slice(0,wi(Ce)+1).replace(xo,"")}function Vs(Ce){return function(Ct){return Ce(Ct)}}function gh(Ce,Ct){return Tr(Ct,function(ut){return Ce[ut]})}function mh(Ce,Ct){return Ce.has(Ct)}function qf(Ce,Ct){for(var ut=-1,cn=Ce.length;++ut<cn&&Ju(Ct,Ce[ut],0)>-1;);return ut}function Nb(Ce,Ct){for(var ut=Ce.length;ut--&&Ju(Ct,Ce[ut],0)>-1;);return ut}var sx=kn({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"}),Ds=kn({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function ed(Ce){return"\\"+LS[Ce]}function Nl(Ce){return kb.test(Ce)}function Lb(Ce){var Ct=-1,ut=Array(Ce.size);return Ce.forEach(function(cn,Gn){ut[++Ct]=[Gn,cn]}),ut}function Em(Ce,Ct){return function(ut){return Ce(Ct(ut))}}function nu(Ce,Ct){for(var ut=-1,cn=Ce.length,Gn=0,vi=[];++ut<cn;){var Qr=Ce[ut];(Qr===Ct||Qr===E)&&(Ce[ut]=E,vi[Gn++]=ut)}return vi}function Wo(Ce){var Ct=-1,ut=Array(Ce.size);return Ce.forEach(function(cn){ut[++Ct]=cn}),ut}function iu(Ce){return Nl(Ce)?function Bb(Ce){for(var Ct=Ku.lastIndex=0;Ku.test(Ce);)++Ct;return Ct}(Ce):nx(Ce)}function Kr(Ce){return Nl(Ce)?function Tm(Ce){return Ce.match(Ku)||[]}(Ce):function ix(Ce){return Ce.split("")}(Ce)}function wi(Ce){for(var Ct=Ce.length;Ct--&&oo.test(Ce.charAt(Ct)););return Ct}var nd=kn({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),ks=function Ce(Ct){var l,ut=(Ct=null==Ct?jr:ks.defaults(jr.Object(),Ct,ks.pick(jr,mn))).Array,cn=Ct.Date,Gn=Ct.Error,vi=Ct.Function,Qr=Ct.Math,Xi=Ct.Object,Sm=Ct.RegExp,Mm=Ct.String,pa=Ct.TypeError,Jf=ut.prototype,id=Xi.prototype,_h=Ct["__core-js_shared__"],ep=vi.prototype.toString,Gi=id.hasOwnProperty,ax=0,Ub=(l=/[^.]+$/.exec(_h&&_h.keys&&_h.keys.IE_PROTO||""))?"Symbol(src)_1."+l:"",bh=id.toString,lx=ep.call(Xi),cx=jr._,ux=Sm("^"+ep.call(Gi).replace(ac,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),In=_m?Ct.Buffer:w,dc=Ct.Symbol,tp=Ct.Uint8Array,ga=In?In.allocUnsafe:w,vh=Em(Xi.getPrototypeOf,Xi),Sn=Xi.create,$o=id.propertyIsEnumerable,Qn=Jf.splice,Jr=dc?dc.isConcatSpreadable:w,Gr=dc?dc.iterator:w,js=dc?dc.toStringTag:w,so=function(){try{var l=_c(Xi,"defineProperty");return l({},"",{}),l}catch{}}(),zb=Ct.clearTimeout!==jr.clearTimeout&&Ct.clearTimeout,Hb=cn&&cn.now!==jr.Date.now&&cn.now,np=Ct.setTimeout!==jr.setTimeout&&Ct.setTimeout,ip=Qr.ceil,rp=Qr.floor,ru=Xi.getOwnPropertySymbols,dx=In?In.isBuffer:w,op=Ct.isFinite,Vb=Jf.join,sp=Em(Xi.keys,Xi),wo=Qr.max,Eo=Qr.min,hx=cn.now,Dm=Ct.parseInt,km=Qr.random,jb=Jf.reverse,Rl=_c(Ct,"DataView"),yh=_c(Ct,"Map"),Ch=_c(Ct,"Promise"),Ll=_c(Ct,"Set"),xh=_c(Ct,"WeakMap"),ou=_c(Xi,"create"),su=xh&&new xh,ls={},rd=bc(Rl),Om=bc(yh),fx=bc(Ch),px=bc(Ll),Gb=bc(xh),Bl=dc?dc.prototype:w,wh=Bl?Bl.valueOf:w,Wb=Bl?Bl.toString:w;function ee(l){if(Mr(l)&&!qn(l)&&!(l instanceof ci)){if(l instanceof Gs)return l;if(Gi.call(l,"__wrapped__"))return _u(l)}return new Gs(l)}var hc=function(){function l(){}return function(d){if(!sr(d))return{};if(Sn)return Sn(d);l.prototype=d;var _=new l;return l.prototype=w,_}}();function Eh(){}function Gs(l,d){this.__wrapped__=l,this.__actions__=[],this.__chain__=!!d,this.__index__=0,this.__values__=w}function ci(l){this.__wrapped__=l,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Rt,this.__views__=[]}function dr(l){var d=-1,_=null==l?0:l.length;for(this.clear();++d<_;){var I=l[d];this.set(I[0],I[1])}}function Ul(l){var d=-1,_=null==l?0:l.length;for(this.clear();++d<_;){var I=l[d];this.set(I[0],I[1])}}function Oi(l){var d=-1,_=null==l?0:l.length;for(this.clear();++d<_;){var I=l[d];this.set(I[0],I[1])}}function ao(l){var d=-1,_=null==l?0:l.length;for(this.__data__=new Oi;++d<_;)this.add(l[d])}function Bi(l){var d=this.__data__=new Ul(l);this.size=d.size}function gr(l,d){var _=qn(l),I=!_&&Cc(l),G=!_&&!I&&xc(l),le=!_&&!I&&!G&&Dd(l),xe=_||I||G||le,Me=xe?xm(l.length,Mm):[],$e=Me.length;for(var It in l)(d||Gi.call(l,It))&&(!xe||!("length"==It||G&&("offset"==It||"parent"==It)||le&&("buffer"==It||"byteLength"==It||"byteOffset"==It)||Zs(It,$e)))&&Me.push(It);return Me}function ld(l){var d=l.length;return d?l[du(0,d-1)]:w}function cd(l,d){return gl(Xo(l),Zo(d,0,l.length))}function zl(l){return gl(Xo(l))}function au(l,d,_){(_!==w&&!qa(l[d],_)||_===w&&!(d in l))&&Ba(l,d,_)}function ud(l,d,_){var I=l[d];(!Gi.call(l,d)||!qa(I,_)||_===w&&!(d in l))&&Ba(l,d,_)}function La(l,d){for(var _=l.length;_--;)if(qa(l[_][0],d))return _;return-1}function lp(l,d,_,I){return Sr(l,function(G,le,xe){d(I,G,_(G),xe)}),I}function fc(l,d){return l&&ma(d,To(d),l)}function Ba(l,d,_){"__proto__"==d&&so?so(l,d,{configurable:!0,enumerable:!0,value:_,writable:!0}):l[d]=_}function lu(l,d){for(var _=-1,I=d.length,G=ut(I),le=null==l;++_<I;)G[_]=le?w:n1(l,d[_]);return G}function Zo(l,d,_){return l==l&&(_!==w&&(l=l<=_?l:_),d!==w&&(l=l>=d?l:d)),l}function cs(l,d,_,I,G,le){var xe,Me=1&d,$e=2&d,It=4&d;if(_&&(xe=G?_(l,I,G,le):_(l)),xe!==w)return xe;if(!sr(l))return l;var nt=qn(l);if(nt){if(xe=function Lx(l){var d=l.length,_=new l.constructor(d);return d&&"string"==typeof l[0]&&Gi.call(l,"index")&&(_.index=l.index,_.input=l.input),_}(l),!Me)return Xo(l,xe)}else{var h=no(l),Jt=h==Ae||h==Re;if(xc(l))return rv(l,Me);if(h==dt||h==At||Jt&&!G){if(xe=$e||Jt?{}:dv(l),!Me)return $e?function qS(l,d){return ma(l,gu(l),d)}(l,function Wn(l,d){return l&&ma(d,fs(d),l)}(xe,l)):function Ax(l,d){return ma(l,Xm(l),d)}(l,fc(xe,l))}else{if(!Ji[h])return G?l:{};xe=function XS(l,d,_){var I=l.constructor;switch(d){case yo:return jm(l);case fn:case oi:return new I(+l);case ji:return function _t(l,d){var _=d?jm(l.buffer):l.buffer;return new l.constructor(_,l.byteOffset,l.byteLength)}(l,_);case Co:case Pi:case jo:case rs:case Nr:case ca:case Da:case ua:case ka:return H(l,_);case fe:return new I;case se:case Dt:return new I(l);case Mt:return function fi(l){var d=new l.constructor(l.source,lc.exec(l));return d.lastIndex=l.lastIndex,d}(l);case Ht:return new I;case hn:return function V(l){return wh?Xi(wh.call(l)):{}}(l)}}(l,h,Me)}}le||(le=new Bi);var Y=le.get(l);if(Y)return Y;le.set(l,xe),I_(l)?l.forEach(function(An){xe.add(cs(An,d,_,An,l,le))}):w_(l)&&l.forEach(function(An,si){xe.set(si,cs(An,d,_,si,l,le))});var ni=nt?w:(It?$e?fu:Ep:$e?fs:To)(l);return Ms(ni||l,function(An,si){ni&&(An=l[si=An]),ud(xe,si,cs(An,d,_,si,l,le))}),xe}function Rr(l,d,_){var I=_.length;if(null==l)return!I;for(l=Xi(l);I--;){var G=_[I],xe=l[G];if(xe===w&&!(G in l)||!(0,d[G])(xe))return!1}return!0}function cp(l,d,_){if("function"!=typeof l)throw new pa(P);return wd(function(){l.apply(w,_)},d)}function eo(l,d,_,I){var G=-1,le=Po,xe=!0,Me=l.length,$e=[],It=d.length;if(!Me)return $e;_&&(d=Tr(d,Vs(_))),I?(le=Yf,xe=!1):d.length>=200&&(le=mh,xe=!1,d=new ao(d));e:for(;++G<Me;){var nt=l[G],h=null==_?nt:_(nt);if(nt=I||0!==nt?nt:0,xe&&h==h){for(var Jt=It;Jt--;)if(d[Jt]===h)continue e;$e.push(nt)}else le(d,h,I)||$e.push(nt)}return $e}ee.templateSettings={escape:Wu,evaluate:uh,interpolate:$u,variable:"",imports:{_:ee}},(ee.prototype=Eh.prototype).constructor=ee,(Gs.prototype=hc(Eh.prototype)).constructor=Gs,(ci.prototype=hc(Eh.prototype)).constructor=ci,dr.prototype.clear=function $b(){this.__data__=ou?ou(null):{},this.size=0},dr.prototype.delete=function _x(l){var d=this.has(l)&&delete this.__data__[l];return this.size-=d?1:0,d},dr.prototype.get=function Ih(l){var d=this.__data__;if(ou){var _=d[l];return _===j?w:_}return Gi.call(d,l)?d[l]:w},dr.prototype.has=function bx(l){var d=this.__data__;return ou?d[l]!==w:Gi.call(d,l)},dr.prototype.set=function vx(l,d){var _=this.__data__;return this.size+=this.has(l)?0:1,_[l]=ou&&d===w?j:d,this},Ul.prototype.clear=function yx(){this.__data__=[],this.size=0},Ul.prototype.delete=function Cx(l){var d=this.__data__,_=La(d,l);return!(_<0||(_==d.length-1?d.pop():Qn.call(d,_,1),--this.size,0))},Ul.prototype.get=function xx(l){var d=this.__data__,_=La(d,l);return _<0?w:d[_][1]},Ul.prototype.has=function Am(l){return La(this.__data__,l)>-1},Ul.prototype.set=function ap(l,d){var _=this.__data__,I=La(_,l);return I<0?(++this.size,_.push([l,d])):_[I][1]=d,this},Oi.prototype.clear=function Yt(){this.size=0,this.__data__={hash:new dr,map:new(yh||Ul),string:new dr}},Oi.prototype.delete=function _n(l){var d=pu(this,l).delete(l);return this.size-=d?1:0,d},Oi.prototype.get=function Wr(l){return pu(this,l).get(l)},Oi.prototype.has=function Na(l){return pu(this,l).has(l)},Oi.prototype.set=function Yo(l,d){var _=pu(this,l),I=_.size;return _.set(l,d),this.size+=_.size==I?0:1,this},ao.prototype.add=ao.prototype.push=function sd(l){return this.__data__.set(l,j),this},ao.prototype.has=function or(l){return this.__data__.has(l)},Bi.prototype.clear=function Ra(){this.__data__=new Ul,this.size=0},Bi.prototype.delete=function Rn(l){var d=this.__data__,_=d.delete(l);return this.size=d.size,_},Bi.prototype.get=function Th(l){return this.__data__.get(l)},Bi.prototype.has=function Yb(l){return this.__data__.has(l)},Bi.prototype.set=function ad(l,d){var _=this.__data__;if(_ instanceof Ul){var I=_.__data__;if(!yh||I.length<199)return I.push([l,d]),this.size=++_.size,this;_=this.__data__=new Oi(I)}return _.set(l,d),this.size=_.size,this};var Sr=hl(za),up=hl(Fm,!0);function cu(l,d){var _=!0;return Sr(l,function(I,G,le){return _=!!d(I,G,le)}),_}function uu(l,d,_){for(var I=-1,G=l.length;++I<G;){var le=l[I],xe=d(le);if(null!=xe&&(Me===w?xe==xe&&!co(xe):_(xe,Me)))var Me=xe,$e=le}return $e}function dp(l,d){var _=[];return Sr(l,function(I,G,le){d(I,G,le)&&_.push(I)}),_}function Fo(l,d,_,I,G){var le=-1,xe=l.length;for(_||(_=Qm),G||(G=[]);++le<xe;){var Me=l[le];d>0&&_(Me)?d>1?Fo(Me,d-1,_,I,G):Qc(G,Me):I||(G[G.length]=Me)}return G}var Pm=Gm(),hp=Gm(!0);function za(l,d){return l&&Pm(l,d,To)}function Fm(l,d){return l&&hp(l,d,To)}function hd(l,d){return Pl(d,function(_){return ml(l[_])})}function fd(l,d){for(var _=0,I=(d=Ys(d,l)).length;null!=l&&_<I;)l=l[Ga(d[_++])];return _&&_==I?l:w}function wx(l,d,_){var I=d(l);return qn(l)?I:Qc(I,_(l))}function Os(l){return null==l?l===w?"[object Undefined]":"[object Null]":js&&js in Xi(l)?function cv(l){var d=Gi.call(l,js),_=l[js];try{l[js]=w;var I=!0}catch{}var G=bh.call(l);return I&&(d?l[js]=_:delete l[js]),G}(l):function pv(l){return bh.call(l)}(l)}function Zb(l,d){return l>d}function HS(l,d){return null!=l&&Gi.call(l,d)}function VS(l,d){return null!=l&&d in Xi(l)}function qb(l,d,_){for(var I=_?Yf:Po,G=l[0].length,le=l.length,xe=le,Me=ut(le),$e=1/0,It=[];xe--;){var nt=l[xe];xe&&d&&(nt=Tr(nt,Vs(d))),$e=Eo(nt.length,$e),Me[xe]=!_&&(d||G>=120&&nt.length>=120)?new ao(xe&&nt):w}nt=l[0];var h=-1,Jt=Me[0];e:for(;++h<G&&It.length<$e;){var Y=nt[h],On=d?d(Y):Y;if(Y=_||0!==Y?Y:0,!(Jt?mh(Jt,On):I(It,On,_))){for(xe=le;--xe;){var ni=Me[xe];if(!(ni?mh(ni,On):I(l[xe],On,_)))continue e}Jt&&Jt.push(On),It.push(Y)}}return It}function fp(l,d,_){var I=null==(l=Sp(l,d=Ys(d,l)))?l:l[Ga(Wa(d))];return null==I?w:fa(I,l,_)}function Ex(l){return Mr(l)&&Os(l)==At}function pd(l,d,_,I,G){return l===d||(null==l||null==d||!Mr(l)&&!Mr(d)?l!=l&&d!=d:function $S(l,d,_,I,G,le){var xe=qn(l),Me=qn(d),$e=xe?Lt:no(l),It=Me?Lt:no(d),nt=($e=$e==At?dt:$e)==dt,h=(It=It==At?dt:It)==dt,Jt=$e==It;if(Jt&&xc(l)){if(!xc(d))return!1;xe=!0,nt=!1}if(Jt&&!nt)return le||(le=new Bi),xe||Dd(l)?lv(l,d,_,I,G,le):function Fx(l,d,_,I,G,le,xe){switch(_){case ji:if(l.byteLength!=d.byteLength||l.byteOffset!=d.byteOffset)return!1;l=l.buffer,d=d.buffer;case yo:return!(l.byteLength!=d.byteLength||!le(new tp(l),new tp(d)));case fn:case oi:case se:return qa(+l,+d);case F:return l.name==d.name&&l.message==d.message;case Mt:case Dt:return l==d+"";case fe:var Me=Lb;case Ht:if(Me||(Me=Wo),l.size!=d.size&&!(1&I))return!1;var It=xe.get(l);if(It)return It==d;I|=2,xe.set(l,d);var nt=lv(Me(l),Me(d),I,G,le,xe);return xe.delete(l),nt;case hn:if(wh)return wh.call(l)==wh.call(d)}return!1}(l,d,$e,_,I,G,le);if(!(1&_)){var Y=nt&&Gi.call(l,"__wrapped__"),On=h&&Gi.call(d,"__wrapped__");if(Y||On){var ni=Y?l.value():l,An=On?d.value():d;return le||(le=new Bi),G(ni,An,_,I,le)}}return!!Jt&&(le||(le=new Bi),function Nx(l,d,_,I,G,le){var xe=1&_,Me=Ep(l),$e=Me.length;if($e!=Ep(d).length&&!xe)return!1;for(var h=$e;h--;){var Jt=Me[h];if(!(xe?Jt in d:Gi.call(d,Jt)))return!1}var Y=le.get(l),On=le.get(d);if(Y&&On)return Y==d&&On==l;var ni=!0;le.set(l,d),le.set(d,l);for(var An=xe;++h<$e;){var si=l[Jt=Me[h]],ai=d[Jt];if(I)var gs=xe?I(ai,si,Jt,d,l,le):I(si,ai,Jt,l,d,le);if(!(gs===w?si===ai||G(si,ai,_,I,le):gs)){ni=!1;break}An||(An="constructor"==Jt)}if(ni&&!An){var uo=l.constructor,Ps=d.constructor;uo!=Ps&&"constructor"in l&&"constructor"in d&&!("function"==typeof uo&&uo instanceof uo&&"function"==typeof Ps&&Ps instanceof Ps)&&(ni=!1)}return le.delete(l),le.delete(d),ni}(l,d,_,I,G,le))}(l,d,_,I,pd,G))}function Kb(l,d,_,I){var G=_.length,le=G,xe=!I;if(null==l)return!le;for(l=Xi(l);G--;){var Me=_[G];if(xe&&Me[2]?Me[1]!==l[Me[0]]:!(Me[0]in l))return!1}for(;++G<le;){var $e=(Me=_[G])[0],It=l[$e],nt=Me[1];if(xe&&Me[2]){if(It===w&&!($e in l))return!1}else{var h=new Bi;if(I)var Jt=I(It,nt,$e,l,d,h);if(!(Jt===w?pd(nt,It,3,I,h):Jt))return!1}}return!0}function Ix(l){return!(!sr(l)||function QS(l){return!!Ub&&Ub in l}(l))&&(ml(l)?ux:da).test(bc(l))}function Nm(l){return"function"==typeof l?l:null==l?Yr:"object"==typeof l?qn(l)?gp(l[0],l[1]):Jb(l):g1(l)}function Rm(l){if(!xd(l))return sp(l);var d=[];for(var _ in Xi(l))Gi.call(l,_)&&"constructor"!=_&&d.push(_);return d}function pp(l,d){return l<d}function Lm(l,d){var _=-1,I=Io(l)?ut(l.length):[];return Sr(l,function(G,le,xe){I[++_]=d(G,le,xe)}),I}function Jb(l){var d=Fh(l);return 1==d.length&&d[0][2]?ja(d[0][0],d[0][1]):function(_){return _===l||Kb(_,l,d)}}function gp(l,d){return mu(l)&&fv(d)?ja(Ga(l),d):function(_){var I=n1(_,l);return I===w&&I===d?M_(_,l):pd(d,I,3)}}function mp(l,d,_,I,G){l!==d&&Pm(d,function(le,xe){if(G||(G=new Bi),sr(le))!function cl(l,d,_,I,G,le,xe){var Me=Mp(l,_),$e=Mp(d,_),It=xe.get($e);if(It)au(l,_,It);else{var nt=le?le(Me,$e,_+"",l,d,xe):w,h=nt===w;if(h){var Jt=qn($e),Y=!Jt&&xc($e),On=!Jt&&!Y&&Dd($e);nt=$e,Jt||Y||On?qn(Me)?nt=Me:Lr(Me)?nt=Xo(Me):Y?(h=!1,nt=rv($e,!0)):On?(h=!1,nt=H($e,!0)):nt=[]:wc($e)||Cc($e)?(nt=Me,Cc(Me)?nt=Kv(Me):(!sr(Me)||ml(Me))&&(nt=dv($e))):h=!1}h&&(xe.set($e,nt),G(nt,$e,I,le,xe),xe.delete($e)),au(l,_,nt)}}(l,d,xe,_,mp,I,G);else{var Me=I?I(Mp(l,xe),le,xe+"",l,d,G):w;Me===w&&(Me=le),au(l,xe,Me)}},fs)}function Bm(l,d){var _=l.length;if(_)return Zs(d+=d<0?_:0,_)?l[d]:w}function Um(l,d,_){d=d.length?Tr(d,function(le){return qn(le)?function(xe){return fd(xe,1===le.length?le[0]:le)}:le}):[Yr];var I=-1;return d=Tr(d,Vs(xn())),function Cm(Ce,Ct){var ut=Ce.length;for(Ce.sort(Ct);ut--;)Ce[ut]=Ce[ut].value;return Ce}(Lm(l,function(le,xe,Me){return{criteria:Tr(d,function(It){return It(le)}),index:++I,value:le}}),function(le,xe){return function ov(l,d,_){for(var I=-1,G=l.criteria,le=d.criteria,xe=G.length,Me=_.length;++I<xe;){var $e=zi(G[I],le[I]);if($e)return I>=Me?$e:$e*("desc"==_[I]?-1:1)}return l.index-d.index}(le,xe,_)})}function tv(l,d,_){for(var I=-1,G=d.length,le={};++I<G;){var xe=d[I],Me=fd(l,xe);_(Me,xe)&&Sh(le,Ys(xe,l),Me)}return le}function Ui(l,d,_,I){var G=I?uc:Ju,le=-1,xe=d.length,Me=l;for(l===d&&(d=Xo(d)),_&&(Me=Tr(l,Vs(_)));++le<xe;)for(var $e=0,It=d[le],nt=_?_(It):It;($e=G(Me,nt,$e,I))>-1;)Me!==l&&Qn.call(Me,$e,1),Qn.call(l,$e,1);return l}function _p(l,d){for(var _=l?d.length:0,I=_-1;_--;){var G=d[_];if(_==I||G!==le){var le=G;Zs(G)?Qn.call(l,G,1):Hl(l,G)}}return l}function du(l,d){return l+rp(km()*(d-l+1))}function zm(l,d){var _="";if(!l||d<1||d>Ze)return _;do{d%2&&(_+=l),(d=rp(d/2))&&(l+=l)}while(d);return _}function Zn(l,d){return Dp(Nh(l,d,Yr),l+"")}function gd(l){return ld(kd(l))}function Ws(l,d){var _=kd(l);return gl(_,Zo(d,0,_.length))}function Sh(l,d,_,I){if(!sr(l))return l;for(var G=-1,le=(d=Ys(d,l)).length,xe=le-1,Me=l;null!=Me&&++G<le;){var $e=Ga(d[G]),It=_;if("__proto__"===$e||"constructor"===$e||"prototype"===$e)return l;if(G!=xe){var nt=Me[$e];(It=I?I(nt,$e,Me):w)===w&&(It=sr(nt)?nt:Zs(d[G+1])?[]:{})}ud(Me,$e,It),Me=Me[$e]}return l}var bp=su?function(l,d){return su.set(l,d),l}:Yr,Mx=so?function(l,d){return so(l,"toString",{configurable:!0,enumerable:!1,value:d1(d),writable:!0})}:Yr;function ul(l){return gl(kd(l))}function $s(l,d,_){var I=-1,G=l.length;d<0&&(d=-d>G?0:G+d),(_=_>G?G:_)<0&&(_+=G),G=d>_?0:_-d>>>0,d>>>=0;for(var le=ut(G);++I<G;)le[I]=l[I+d];return le}function Dx(l,d){var _;return Sr(l,function(I,G,le){return!(_=d(I,G,le))}),!!_}function Mh(l,d,_){var I=0,G=null==l?I:l.length;if("number"==typeof d&&d==d&&G<=2147483647){for(;I<G;){var le=I+G>>>1,xe=l[le];null!==xe&&!co(xe)&&(_?xe<=d:xe<d)?I=le+1:G=le}return G}return Dh(l,d,Yr,_)}function Dh(l,d,_,I){var G=0,le=null==l?0:l.length;if(0===le)return 0;for(var xe=(d=_(d))!=d,Me=null===d,$e=co(d),It=d===w;G<le;){var nt=rp((G+le)/2),h=_(l[nt]),Jt=h!==w,Y=null===h,On=h==h,ni=co(h);if(xe)var An=I||On;else An=It?On&&(I||Jt):Me?On&&Jt&&(I||!Y):$e?On&&Jt&&!Y&&(I||!ni):!Y&&!ni&&(I?h<=d:h<d);An?G=nt+1:le=nt}return Eo(le,4294967294)}function vp(l,d){for(var _=-1,I=l.length,G=0,le=[];++_<I;){var xe=l[_],Me=d?d(xe):xe;if(!_||!qa(Me,$e)){var $e=Me;le[G++]=0===xe?0:xe}}return le}function md(l){return"number"==typeof l?l:co(l)?NaN:+l}function qo(l){if("string"==typeof l)return l;if(qn(l))return Tr(l,qo)+"";if(co(l))return Wb?Wb.call(l):"";var d=l+"";return"0"==d&&1/l==-Tt?"-0":d}function dl(l,d,_){var I=-1,G=Po,le=l.length,xe=!0,Me=[],$e=Me;if(_)xe=!1,G=Yf;else if(le>=200){var It=d?null:qm(l);if(It)return Wo(It);xe=!1,G=mh,$e=new ao}else $e=d?[]:Me;e:for(;++I<le;){var nt=l[I],h=d?d(nt):nt;if(nt=_||0!==nt?nt:0,xe&&h==h){for(var Jt=$e.length;Jt--;)if($e[Jt]===h)continue e;d&&$e.push(h),Me.push(nt)}else G($e,h,_)||($e!==Me&&$e.push(h),Me.push(nt))}return Me}function Hl(l,d){return null==(l=Sp(l,d=Ys(d,l)))||delete l[Ga(Wa(d))]}function Fn(l,d,_,I){return Sh(l,d,_(fd(l,d)),I)}function kh(l,d,_,I){for(var G=l.length,le=I?G:-1;(I?le--:++le<G)&&d(l[le],le,l););return _?$s(l,I?0:le,I?le+1:G):$s(l,I?le+1:0,I?G:le)}function kx(l,d){var _=l;return _ instanceof ci&&(_=_.value()),Jc(d,function(I,G){return G.func.apply(G.thisArg,Qc([I],G.args))},_)}function Hm(l,d,_){var I=l.length;if(I<2)return I?dl(l[0]):[];for(var G=-1,le=ut(I);++G<I;)for(var xe=l[G],Me=-1;++Me<I;)Me!=G&&(le[G]=eo(le[G]||xe,l[Me],d,_));return dl(Fo(le,1),d,_)}function nv(l,d,_){for(var I=-1,G=l.length,le=d.length,xe={};++I<G;)_(xe,l[I],I<le?d[I]:w);return xe}function Vm(l){return Lr(l)?l:[]}function yp(l){return"function"==typeof l?l:Yr}function Ys(l,d){return qn(l)?l:mu(l,d)?[l]:mv(Fi(l))}var Ox=Zn;function pc(l,d,_){var I=l.length;return _=_===w?I:_,!d&&_>=I?l:$s(l,d,_)}var iv=zb||function(l){return jr.clearTimeout(l)};function rv(l,d){if(d)return l.slice();var _=l.length,I=ga?ga(_):new l.constructor(_);return l.copy(I),I}function jm(l){var d=new l.constructor(l.byteLength);return new tp(d).set(new tp(l)),d}function H(l,d){var _=d?jm(l.buffer):l.buffer;return new l.constructor(_,l.byteOffset,l.length)}function zi(l,d){if(l!==d){var _=l!==w,I=null===l,G=l==l,le=co(l),xe=d!==w,Me=null===d,$e=d==d,It=co(d);if(!Me&&!It&&!le&&l>d||le&&xe&&$e&&!Me&&!It||I&&xe&&$e||!_&&$e||!G)return 1;if(!I&&!le&&!It&&l<d||It&&_&&G&&!I&&!le||Me&&_&&G||!xe&&G||!$e)return-1}return 0}function _d(l,d,_,I){for(var G=-1,le=l.length,xe=_.length,Me=-1,$e=d.length,It=wo(le-xe,0),nt=ut($e+It),h=!I;++Me<$e;)nt[Me]=d[Me];for(;++G<xe;)(h||G<le)&&(nt[_[G]]=l[G]);for(;It--;)nt[Me++]=l[G++];return nt}function Ha(l,d,_,I){for(var G=-1,le=l.length,xe=-1,Me=_.length,$e=-1,It=d.length,nt=wo(le-Me,0),h=ut(nt+It),Jt=!I;++G<nt;)h[G]=l[G];for(var Y=G;++$e<It;)h[Y+$e]=d[$e];for(;++xe<Me;)(Jt||G<le)&&(h[Y+_[xe]]=l[G++]);return h}function Xo(l,d){var _=-1,I=l.length;for(d||(d=ut(I));++_<I;)d[_]=l[_];return d}function ma(l,d,_,I){var G=!_;_||(_={});for(var le=-1,xe=d.length;++le<xe;){var Me=d[le],$e=I?I(_[Me],l[Me],Me,_,l):w;$e===w&&($e=l[Me]),G?Ba(_,Me,$e):ud(_,Me,$e)}return _}function Oh(l,d){return function(_,I){var G=qn(_)?tx:lp,le=d?d():{};return G(_,l,xn(I,2),le)}}function to(l){return Zn(function(d,_){var I=-1,G=_.length,le=G>1?_[G-1]:w,xe=G>2?_[2]:w;for(le=l.length>3&&"function"==typeof le?(G--,le):w,xe&&ds(_[0],_[1],xe)&&(le=G<3?w:le,G=1),d=Xi(d);++I<G;){var Me=_[I];Me&&l(d,Me,I,le)}return d})}function hl(l,d){return function(_,I){if(null==_)return _;if(!Io(_))return l(_,I);for(var G=_.length,le=d?G:-1,xe=Xi(_);(d?le--:++le<G)&&!1!==I(xe[le],le,xe););return _}}function Gm(l){return function(d,_,I){for(var G=-1,le=Xi(d),xe=I(d),Me=xe.length;Me--;){var $e=xe[l?Me:++G];if(!1===_(le[$e],$e,le))break}return d}}function fl(l){return function(d){var _=Nl(d=Fi(d))?Kr(d):w,I=_?_[0]:d.charAt(0),G=_?pc(_,1).join(""):d.slice(1);return I[l]()+G}}function bd(l){return function(d){return Jc(ya(A_(d).replace(XC,"")),l,"")}}function vd(l){return function(){var d=arguments;switch(d.length){case 0:return new l;case 1:return new l(d[0]);case 2:return new l(d[0],d[1]);case 3:return new l(d[0],d[1],d[2]);case 4:return new l(d[0],d[1],d[2],d[3]);case 5:return new l(d[0],d[1],d[2],d[3],d[4]);case 6:return new l(d[0],d[1],d[2],d[3],d[4],d[5]);case 7:return new l(d[0],d[1],d[2],d[3],d[4],d[5],d[6])}var _=hc(l.prototype),I=l.apply(_,d);return sr(I)?I:_}}function sv(l){return function(d,_,I){var G=Xi(d);if(!Io(d)){var le=xn(_,3);d=To(d),_=function(Me){return le(G[Me],Me,G)}}var xe=l(d,_,I);return xe>-1?G[le?d[xe]:xe]:w}}function Cp(l){return pl(function(d){var _=d.length,I=_,G=Gs.prototype.thru;for(l&&d.reverse();I--;){var le=d[I];if("function"!=typeof le)throw new pa(P);if(G&&!xe&&"wrapper"==Ip(le))var xe=new Gs([],!0)}for(I=xe?I:_;++I<_;){var Me=Ip(le=d[I]),$e="wrapper"==Me?_a(le):w;xe=$e&&Cd($e[0])&&424==$e[1]&&!$e[4].length&&1==$e[9]?xe[Ip($e[0])].apply(xe,$e[3]):1==le.length&&Cd(le)?xe[Me]():xe.thru(le)}return function(){var It=arguments,nt=It[0];if(xe&&1==It.length&&qn(nt))return xe.plant(nt).value();for(var h=0,Jt=_?d[h].apply(this,It):nt;++h<_;)Jt=d[h].call(this,Jt);return Jt}})}function yd(l,d,_,I,G,le,xe,Me,$e,It){var nt=128&d,h=1&d,Jt=2&d,Y=24&d,On=512&d,ni=Jt?w:vd(l);return function An(){for(var si=arguments.length,ai=ut(si),gs=si;gs--;)ai[gs]=arguments[gs];if(Y)var uo=Vl(An),Ps=function tu(Ce,Ct){for(var ut=Ce.length,cn=0;ut--;)Ce[ut]===Ct&&++cn;return cn}(ai,uo);if(I&&(ai=_d(ai,I,G,Y)),le&&(ai=Ha(ai,le,xe,Y)),si-=Ps,Y&&si<It){var Dr=nu(ai,uo);return Zm(l,d,yd,An.placeholder,_,ai,Dr,Me,$e,It-si)}var Xs=h?_:this,Ka=Jt?Xs[l]:l;return si=ai.length,Me?ai=function Ux(l,d){for(var _=l.length,I=Eo(d.length,_),G=Xo(l);I--;){var le=d[I];l[I]=Zs(le,_)?G[le]:w}return l}(ai,Me):On&&si>1&&ai.reverse(),nt&&$e<si&&(ai.length=$e),this&&this!==jr&&this instanceof An&&(Ka=ni||vd(Ka)),Ka.apply(Xs,ai)}}function xp(l,d){return function(_,I){return function GS(l,d,_,I){return za(l,function(G,le,xe){d(I,_(G),le,xe)}),I}(_,l,d(I),{})}}function hu(l,d){return function(_,I){var G;if(_===w&&I===w)return d;if(_!==w&&(G=_),I!==w){if(G===w)return I;"string"==typeof _||"string"==typeof I?(_=qo(_),I=qo(I)):(_=md(_),I=md(I)),G=l(_,I)}return G}}function Wm(l){return pl(function(d){return d=Tr(d,Vs(xn())),Zn(function(_){var I=this;return l(d,function(G){return fa(G,I,_)})})})}function Ah(l,d){var _=(d=d===w?" ":qo(d)).length;if(_<2)return _?zm(d,l):d;var I=zm(d,ip(l/iu(d)));return Nl(d)?pc(Kr(I),0,l).join(""):I.slice(0,l)}function Ym(l){return function(d,_,I){return I&&"number"!=typeof I&&ds(d,_,I)&&(_=I=w),d=jl(d),_===w?(_=d,d=0):_=jl(_),function us(l,d,_,I){for(var G=-1,le=wo(ip((d-l)/(_||1)),0),xe=ut(le);le--;)xe[I?le:++G]=l,l+=_;return xe}(d,_,I=I===w?d<_?1:-1:jl(I),l)}}function Ph(l){return function(d,_){return"string"==typeof d&&"string"==typeof _||(d=ba(d),_=ba(_)),l(d,_)}}function Zm(l,d,_,I,G,le,xe,Me,$e,It){var nt=8&d;d|=nt?32:64,4&(d&=~(nt?64:32))||(d&=-4);var ni=[l,d,G,nt?le:w,nt?xe:w,nt?w:le,nt?w:xe,Me,$e,It],An=_.apply(w,ni);return Cd(l)&&t_(An,ni),An.placeholder=I,gv(An,l,d)}function wp(l){var d=Qr[l];return function(_,I){if(_=ba(_),(I=null==I?0:Eo(ti(I),292))&&op(_)){var G=(Fi(_)+"e").split("e");return+((G=(Fi(d(G[0]+"e"+(+G[1]+I)))+"e").split("e"))[0]+"e"+(+G[1]-I))}return d(_)}}var qm=Ll&&1/Wo(new Ll([,-0]))[1]==Tt?function(l){return new Ll(l)}:Pd;function av(l){return function(d){var _=no(d);return _==fe?Lb(d):_==Ht?function Im(Ce){var Ct=-1,ut=Array(Ce.size);return Ce.forEach(function(cn){ut[++Ct]=[cn,cn]}),ut}(d):function ox(Ce,Ct){return Tr(Ct,function(ut){return[ut,Ce[ut]]})}(d,l(d))}}function mr(l,d,_,I,G,le,xe,Me){var $e=2&d;if(!$e&&"function"!=typeof l)throw new pa(P);var It=I?I.length:0;if(It||(d&=-97,I=G=w),xe=xe===w?xe:wo(ti(xe),0),Me=Me===w?Me:ti(Me),It-=G?G.length:0,64&d){var nt=I,h=G;I=G=w}var Jt=$e?w:_a(l),Y=[l,d,_,I,G,nt,h,le,xe,Me];if(Jt&&function Tp(l,d){var _=l[1],I=d[1],G=_|I;if(!(G<131)&&!(128==I&&8==_||128==I&&256==_&&l[7].length<=d[8]||384==I&&d[7].length<=d[8]&&8==_))return l;1&I&&(l[2]=d[2],G|=1&_?0:4);var Me=d[3];if(Me){var $e=l[3];l[3]=$e?_d($e,Me,d[4]):Me,l[4]=$e?nu(l[3],E):d[4]}(Me=d[5])&&(l[5]=($e=l[5])?Ha($e,Me,d[6]):Me,l[6]=$e?nu(l[5],E):d[6]),(Me=d[7])&&(l[7]=Me),128&I&&(l[8]=null==l[8]?d[8]:Eo(l[8],d[8])),null==l[9]&&(l[9]=d[9]),l[0]=d[0],l[1]=G}(Y,Jt),l=Y[0],d=Y[1],_=Y[2],I=Y[3],G=Y[4],!(Me=Y[9]=Y[9]===w?$e?0:l.length:wo(Y[9]-It,0))&&24&d&&(d&=-25),d&&1!=d)On=8==d||16==d?function Px(l,d,_){var I=vd(l);return function G(){for(var le=arguments.length,xe=ut(le),Me=le,$e=Vl(G);Me--;)xe[Me]=arguments[Me];var It=le<3&&xe[0]!==$e&&xe[le-1]!==$e?[]:nu(xe,$e);return(le-=It.length)<_?Zm(l,d,yd,G.placeholder,w,xe,It,w,w,_-le):fa(this&&this!==jr&&this instanceof G?I:l,this,xe)}}(l,d,Me):32!=d&&33!=d||G.length?yd.apply(w,Y):function $m(l,d,_,I){var G=1&d,le=vd(l);return function xe(){for(var Me=-1,$e=arguments.length,It=-1,nt=I.length,h=ut(nt+$e),Jt=this&&this!==jr&&this instanceof xe?le:l;++It<nt;)h[It]=I[It];for(;$e--;)h[It++]=arguments[++Me];return fa(Jt,G?_:this,h)}}(l,d,_,I);else var On=function Va(l,d,_){var I=1&d,G=vd(l);return function le(){return(this&&this!==jr&&this instanceof le?G:l).apply(I?_:this,arguments)}}(l,d,_);return gv((Jt?bp:t_)(On,Y),l,d)}function gc(l,d,_,I){return l===w||qa(l,id[_])&&!Gi.call(I,_)?d:l}function er(l,d,_,I,G,le){return sr(l)&&sr(d)&&(le.set(d,l),mp(l,d,w,er,le),le.delete(d)),l}function mc(l){return wc(l)?w:l}function lv(l,d,_,I,G,le){var xe=1&_,Me=l.length,$e=d.length;if(Me!=$e&&!(xe&&$e>Me))return!1;var It=le.get(l),nt=le.get(d);if(It&&nt)return It==d&&nt==l;var h=-1,Jt=!0,Y=2&_?new ao:w;for(le.set(l,d),le.set(d,l);++h<Me;){var On=l[h],ni=d[h];if(I)var An=xe?I(ni,On,h,d,l,le):I(On,ni,h,l,d,le);if(An!==w){if(An)continue;Jt=!1;break}if(Y){if(!Qu(d,function(si,ai){if(!mh(Y,ai)&&(On===si||G(On,si,_,I,le)))return Y.push(ai)})){Jt=!1;break}}else if(On!==ni&&!G(On,ni,_,I,le)){Jt=!1;break}}return le.delete(l),le.delete(d),Jt}function pl(l){return Dp(Nh(l,w,yv),l+"")}function Ep(l){return wx(l,To,Xm)}function fu(l){return wx(l,fs,gu)}var _a=su?function(l){return su.get(l)}:Pd;function Ip(l){for(var d=l.name+"",_=ls[d],I=Gi.call(ls,d)?_.length:0;I--;){var G=_[I],le=G.func;if(null==le||le==l)return G.name}return d}function Vl(l){return(Gi.call(ee,"placeholder")?ee:l).placeholder}function xn(){var l=ee.iteratee||Zh;return l=l===Zh?Nm:l,arguments.length?l(arguments[0],arguments[1]):l}function pu(l,d){var _=l.__data__;return function Jm(l){var d=typeof l;return"string"==d||"number"==d||"symbol"==d||"boolean"==d?"__proto__"!==l:null===l}(d)?_["string"==typeof d?"string":"hash"]:_.map}function Fh(l){for(var d=To(l),_=d.length;_--;){var I=d[_],G=l[I];d[_]=[I,G,fv(G)]}return d}function _c(l,d){var _=function Rb(Ce,Ct){return null==Ce?w:Ce[Ct]}(l,d);return Ix(_)?_:w}var Xm=ru?function(l){return null==l?[]:(l=Xi(l),Pl(ru(l),function(d){return $o.call(l,d)}))}:Fd,gu=ru?function(l){for(var d=[];l;)Qc(d,Xm(l)),l=vh(l);return d}:Fd,no=Os;function uv(l,d,_){for(var I=-1,G=(d=Ys(d,l)).length,le=!1;++I<G;){var xe=Ga(d[I]);if(!(le=null!=l&&_(l,xe)))break;l=l[xe]}return le||++I!=G?le:!!(G=null==l?0:l.length)&&vu(G)&&Zs(xe,G)&&(qn(l)||Cc(l))}function dv(l){return"function"!=typeof l.constructor||xd(l)?{}:hc(vh(l))}function Qm(l){return qn(l)||Cc(l)||!!(Jr&&l&&l[Jr])}function Zs(l,d){var _=typeof l;return!!(d=d??Ze)&&("number"==_||"symbol"!=_&&ws.test(l))&&l>-1&&l%1==0&&l<d}function ds(l,d,_){if(!sr(_))return!1;var I=typeof d;return!!("number"==I?Io(_)&&Zs(d,_.length):"string"==I&&d in _)&&qa(_[d],l)}function mu(l,d){if(qn(l))return!1;var _=typeof l;return!("number"!=_&&"symbol"!=_&&"boolean"!=_&&null!=l&&!co(l))||zs.test(l)||!Yu.test(l)||null!=d&&l in Xi(d)}function Cd(l){var d=Ip(l),_=ee[d];if("function"!=typeof _||!(d in ci.prototype))return!1;if(l===_)return!0;var I=_a(_);return!!I&&l===I[0]}(Rl&&no(new Rl(new ArrayBuffer(1)))!=ji||yh&&no(new yh)!=fe||Ch&&no(Ch.resolve())!=vt||Ll&&no(new Ll)!=Ht||xh&&no(new xh)!=jn)&&(no=function(l){var d=Os(l),_=d==dt?l.constructor:w,I=_?bc(_):"";if(I)switch(I){case rd:return ji;case Om:return fe;case fx:return vt;case px:return Ht;case Gb:return jn}return d});var hv=_h?ml:Xh;function xd(l){var d=l&&l.constructor;return l===("function"==typeof d&&d.prototype||id)}function fv(l){return l==l&&!sr(l)}function ja(l,d){return function(_){return null!=_&&_[l]===d&&(d!==w||l in Xi(_))}}function Nh(l,d,_){return d=wo(d===w?l.length-1:d,0),function(){for(var I=arguments,G=-1,le=wo(I.length-d,0),xe=ut(le);++G<le;)xe[G]=I[d+G];G=-1;for(var Me=ut(d+1);++G<d;)Me[G]=I[G];return Me[d]=_(xe),fa(l,this,Me)}}function Sp(l,d){return d.length<2?l:fd(l,$s(d,0,-1))}function Mp(l,d){if(("constructor"!==d||"function"!=typeof l[d])&&"__proto__"!=d)return l[d]}var t_=Rh(bp),wd=np||function(l,d){return jr.setTimeout(l,d)},Dp=Rh(Mx);function gv(l,d,_){var I=d+"";return Dp(l,function KS(l,d){var _=d.length;if(!_)return l;var I=_-1;return d[I]=(_>1?"& ":"")+d[I],d=d.join(_>2?", ":" "),l.replace(qu,"{\n/* [wrapped with "+d+"] */\n")}(I,function Ed(l,d){return Ms($t,function(_){var I="_."+_[0];d&_[1]&&!Po(l,I)&&l.push(I)}),l.sort()}(function Km(l){var d=l.match(Oo);return d?d[1].split(jf):[]}(I),_)))}function Rh(l){var d=0,_=0;return function(){var I=hx(),G=16-(I-_);if(_=I,G>0){if(++d>=800)return arguments[0]}else d=0;return l.apply(w,arguments)}}function gl(l,d){var _=-1,I=l.length,G=I-1;for(d=d===w?I:d;++_<d;){var le=du(_,G),xe=l[le];l[le]=l[_],l[_]=xe}return l.length=d,l}var mv=function Bx(l){var d=bu(l,function(I){return 500===_.size&&_.clear(),I}),_=d.cache;return d}(function(l){var d=[];return 46===l.charCodeAt(0)&&d.push(""),l.replace(Zu,function(_,I,G,le){d.push(G?le.replace(Aa,"$1"):I||_)}),d});function Ga(l){if("string"==typeof l||co(l))return l;var d=l+"";return"0"==d&&1/l==-Tt?"-0":d}function bc(l){if(null!=l){try{return ep.call(l)}catch{}try{return l+""}catch{}}return""}function _u(l){if(l instanceof ci)return l.clone();var d=new Gs(l.__wrapped__,l.__chain__);return d.__actions__=Xo(l.__actions__),d.__index__=l.__index__,d.__values__=l.__values__,d}var n_=Zn(function(l,d){return Lr(l)?eo(l,Fo(d,1,Lr,!0)):[]}),Hx=Zn(function(l,d){var _=Wa(d);return Lr(_)&&(_=w),Lr(l)?eo(l,Fo(d,1,Lr,!0),xn(_,2)):[]}),_v=Zn(function(l,d){var _=Wa(d);return Lr(_)&&(_=w),Lr(l)?eo(l,Fo(d,1,Lr,!0),w,_):[]});function r_(l,d,_){var I=null==l?0:l.length;if(!I)return-1;var G=null==_?0:ti(_);return G<0&&(G=wo(I+G,0)),Fl(l,xn(d,3),G)}function vv(l,d,_){var I=null==l?0:l.length;if(!I)return-1;var G=I-1;return _!==w&&(G=ti(_),G=_<0?wo(I+G,0):Eo(G,I-1)),Fl(l,xn(d,3),G,!0)}function yv(l){return null!=l&&l.length?Fo(l,1):[]}function o_(l){return l&&l.length?l[0]:w}var JS=Zn(function(l){var d=Tr(l,Vm);return d.length&&d[0]===l[0]?qb(d):[]}),xv=Zn(function(l){var d=Wa(l),_=Tr(l,Vm);return d===Wa(_)?d=w:_.pop(),_.length&&_[0]===l[0]?qb(_,xn(d,2)):[]}),wv=Zn(function(l){var d=Wa(l),_=Tr(l,Vm);return(d="function"==typeof d?d:w)&&_.pop(),_.length&&_[0]===l[0]?qb(_,w,d):[]});function Wa(l){var d=null==l?0:l.length;return d?l[d-1]:w}var s_=Zn($a);function $a(l,d){return l&&l.length&&d&&d.length?Ui(l,d):l}var Yx=pl(function(l,d){var _=null==l?0:l.length,I=lu(l,d);return _p(l,Tr(d,function(G){return Zs(G,_)?+G:G}).sort(zi)),I});function Ap(l){return null==l?l:jb.call(l)}var Lh=Zn(function(l){return dl(Fo(l,1,Lr,!0))}),Qx=Zn(function(l){var d=Wa(l);return Lr(d)&&(d=w),dl(Fo(l,1,Lr,!0),xn(d,2))}),Sv=Zn(function(l){var d=Wa(l);return d="function"==typeof d?d:w,dl(Fo(l,1,Lr,!0),w,d)});function Bh(l){if(!l||!l.length)return[];var d=0;return l=Pl(l,function(_){if(Lr(_))return d=wo(_.length,d),!0}),xm(d,function(_){return Tr(l,Zf(_))})}function Dv(l,d){if(!l||!l.length)return[];var _=Bh(l);return null==d?_:Tr(_,function(I){return fa(d,w,I)})}var Jx=Zn(function(l,d){return Lr(l)?eo(l,d):[]}),ew=Zn(function(l){return Hm(Pl(l,Lr))}),kv=Zn(function(l){var d=Wa(l);return Lr(d)&&(d=w),Hm(Pl(l,Lr),xn(d,2))}),tw=Zn(function(l){var d=Wa(l);return d="function"==typeof d?d:w,Hm(Pl(l,Lr),w,d)}),nw=Zn(Bh),Ov=Zn(function(l){var d=l.length,_=d>1?l[d-1]:w;return _="function"==typeof _?(l.pop(),_):w,Dv(l,_)});function Np(l){var d=ee(l);return d.__chain__=!0,d}function vc(l,d){return d(l)}var Av=pl(function(l){var d=l.length,_=d?l[0]:0,I=this.__wrapped__,G=function(le){return lu(le,l)};return!(d>1||this.__actions__.length)&&I instanceof ci&&Zs(_)?((I=I.slice(_,+_+(d?1:0))).__actions__.push({func:vc,args:[G],thisArg:w}),new Gs(I,this.__chain__).thru(function(le){return d&&!le.length&&le.push(w),le})):this.thru(G)}),sw=Oh(function(l,d,_){Gi.call(l,_)?++l[_]:Ba(l,_,1)}),cw=sv(r_),Lv=sv(vv);function u_(l,d){return(qn(l)?Ms:Sr)(l,xn(d,3))}function d_(l,d){return(qn(l)?bi:up)(l,xn(d,3))}var zv=Oh(function(l,d,_){Gi.call(l,_)?l[_].push(d):Ba(l,_,[d])}),uw=Zn(function(l,d,_){var I=-1,G="function"==typeof d,le=Io(l)?ut(l.length):[];return Sr(l,function(xe){le[++I]=G?fa(d,xe,_):fp(xe,d,_)}),le}),dw=Oh(function(l,d,_){Ba(l,_,d)});function Lp(l,d){return(qn(l)?Tr:Lm)(l,xn(d,3))}var Vv=Oh(function(l,d,_){l[_?0:1].push(d)},function(){return[[],[]]}),mw=Zn(function(l,d){if(null==l)return[];var _=d.length;return _>1&&ds(l,d[0],d[1])?d=[]:_>2&&ds(d[0],d[1],d[2])&&(d=[d[0]]),Um(l,Fo(d,1),[])}),Ya=Hb||function(){return jr.Date.now()};function Wv(l,d,_){return d=_?w:d,mr(l,128,w,w,w,w,d=l&&null==d?l.length:d)}function f_(l,d){var _;if("function"!=typeof d)throw new pa(P);return l=ti(l),function(){return--l>0&&(_=d.apply(this,arguments)),l<=1&&(d=w),_}}var Za=Zn(function(l,d,_){var I=1;if(_.length){var G=nu(_,Vl(Za));I|=32}return mr(l,I,d,_,G)}),_w=Zn(function(l,d,_){var I=3;if(_.length){var G=nu(_,Vl(_w));I|=32}return mr(d,I,l,_,G)});function $v(l,d,_){var I,G,le,xe,Me,$e,It=0,nt=!1,h=!1,Jt=!0;if("function"!=typeof l)throw new pa(P);function Y(Dr){var Xs=I,Ka=G;return I=G=w,It=Dr,xe=l.apply(Ka,Xs)}function An(Dr){var Xs=Dr-$e;return $e===w||Xs>=d||Xs<0||h&&Dr-It>=le}function si(){var Dr=Ya();if(An(Dr))return ai(Dr);Me=wd(si,function ni(Dr){var j_=d-(Dr-$e);return h?Eo(j_,le-(Dr-It)):j_}(Dr))}function ai(Dr){return Me=w,Jt&&I?Y(Dr):(I=G=w,xe)}function Ps(){var Dr=Ya(),Xs=An(Dr);if(I=arguments,G=this,$e=Dr,Xs){if(Me===w)return function On(Dr){return It=Dr,Me=wd(si,d),nt?Y(Dr):xe}($e);if(h)return iv(Me),Me=wd(si,d),Y($e)}return Me===w&&(Me=wd(si,d)),xe}return d=ba(d)||0,sr(_)&&(nt=!!_.leading,le=(h="maxWait"in _)?wo(ba(_.maxWait)||0,d):le,Jt="trailing"in _?!!_.trailing:Jt),Ps.cancel=function gs(){Me!==w&&iv(Me),It=0,I=$e=G=Me=w},Ps.flush=function uo(){return Me===w?xe:ai(Ya())},Ps}var bw=Zn(function(l,d){return cp(l,1,d)}),lM=Zn(function(l,d,_){return cp(l,ba(d)||0,_)});function bu(l,d){if("function"!=typeof l||null!=d&&"function"!=typeof d)throw new pa(P);var _=function(){var I=arguments,G=d?d.apply(this,I):I[0],le=_.cache;if(le.has(G))return le.get(G);var xe=l.apply(this,I);return _.cache=le.set(G,xe)||le,xe};return _.cache=new(bu.Cache||Oi),_}function zp(l){if("function"!=typeof l)throw new pa(P);return function(){var d=arguments;switch(d.length){case 0:return!l.call(this);case 1:return!l.call(this,d[0]);case 2:return!l.call(this,d[0],d[1]);case 3:return!l.call(this,d[0],d[1],d[2])}return!l.apply(this,d)}}bu.Cache=Oi;var m_=Ox(function(l,d){var _=(d=1==d.length&&qn(d[0])?Tr(d[0],Vs(xn())):Tr(Fo(d,1),Vs(xn()))).length;return Zn(function(I){for(var G=-1,le=Eo(I.length,_);++G<le;)I[G]=d[G].call(this,I[G]);return fa(l,this,I)})}),yc=Zn(function(l,d){var _=nu(d,Vl(yc));return mr(l,32,w,d,_)}),Hp=Zn(function(l,d){var _=nu(d,Vl(Hp));return mr(l,64,w,d,_)}),__=pl(function(l,d){return mr(l,256,w,w,w,d)});function qa(l,d){return l===d||l!=l&&d!=d}var yw=Ph(Zb),C_=Ph(function(l,d){return l>=d}),Cc=Ex(function(){return arguments}())?Ex:function(l){return Mr(l)&&Gi.call(l,"callee")&&!$o.call(l,"callee")},qn=ut.isArray,Cw=bm?Vs(bm):function WS(l){return Mr(l)&&Os(l)==yo};function Io(l){return null!=l&&vu(l.length)&&!ml(l)}function Lr(l){return Mr(l)&&Io(l)}var xc=dx||Xh,dM=Hn?Vs(Hn):function Xb(l){return Mr(l)&&Os(l)==oi};function Vh(l){if(!Mr(l))return!1;var d=Os(l);return d==F||"[object DOMException]"==d||"string"==typeof l.message&&"string"==typeof l.name&&!wc(l)}function ml(l){if(!sr(l))return!1;var d=Os(l);return d==Ae||d==Re||"[object AsyncFunction]"==d||"[object Proxy]"==d}function Wp(l){return"number"==typeof l&&l==ti(l)}function vu(l){return"number"==typeof l&&l>-1&&l%1==0&&l<=Ze}function sr(l){var d=typeof l;return null!=l&&("object"==d||"function"==d)}function Mr(l){return null!=l&&"object"==typeof l}var w_=ki?Vs(ki):function YS(l){return Mr(l)&&no(l)==fe};function Tw(l){return"number"==typeof l||Mr(l)&&Os(l)==se}function wc(l){if(!Mr(l)||Os(l)!=dt)return!1;var d=vh(l);if(null===d)return!0;var _=Gi.call(d,"constructor")&&d.constructor;return"function"==typeof _&&_ instanceof _&&ep.call(_)==lx}var jh=ex?Vs(ex):function Tx(l){return Mr(l)&&Os(l)==Mt},I_=Ob?Vs(Ob):function Qb(l){return Mr(l)&&no(l)==Ht};function Gh(l){return"string"==typeof l||!qn(l)&&Mr(l)&&Os(l)==Dt}function co(l){return"symbol"==typeof l||Mr(l)&&Os(l)==hn}var Dd=Ab?Vs(Ab):function hr(l){return Mr(l)&&vu(l.length)&&!!Qi[Os(l)]},kw=Ph(pp),qs=Ph(function(l,d){return l<=d});function Xa(l){if(!l)return[];if(Io(l))return Gh(l)?Kr(l):Xo(l);if(Gr&&l[Gr])return function wm(Ce){for(var Ct,ut=[];!(Ct=Ce.next()).done;)ut.push(Ct.value);return ut}(l[Gr]());var d=no(l);return(d==fe?Lb:d==Ht?Wo:kd)(l)}function jl(l){return l?(l=ba(l))===Tt||l===-Tt?17976931348623157e292*(l<0?-1:1):l==l?l:0:0===l?l:0}function ti(l){var d=jl(l),_=d%1;return d==d?_?d-_:d:0}function Xv(l){return l?Zo(ti(l),0,Rt):0}function ba(l){if("number"==typeof l)return l;if(co(l))return NaN;if(sr(l)){var d="function"==typeof l.valueOf?l.valueOf():l;l=sr(d)?d+"":d}if("string"!=typeof l)return 0===l?l:+l;l=Fb(l);var _=Xu.test(l);return _||Ao.test(l)?US(l.slice(2),_?2:8):dh.test(l)?NaN:+l}function Kv(l){return ma(l,fs(l))}function Fi(l){return null==l?"":qo(l)}var Aw=to(function(l,d){if(xd(d)||Io(d))ma(d,To(d),l);else for(var _ in d)Gi.call(d,_)&&ud(l,_,d[_])}),Qv=to(function(l,d){ma(d,fs(d),l)}),Yp=to(function(l,d,_,I){ma(d,fs(d),l,I)}),Pw=to(function(l,d,_,I){ma(d,To(d),l,I)}),Zp=pl(lu),Wh=Zn(function(l,d){l=Xi(l);var _=-1,I=d.length,G=I>2?d[2]:w;for(G&&ds(d[0],d[1],G)&&(I=1);++_<I;)for(var le=d[_],xe=fs(le),Me=-1,$e=xe.length;++Me<$e;){var It=xe[Me],nt=l[It];(nt===w||qa(nt,id[It])&&!Gi.call(l,It))&&(l[It]=le[It])}return l}),Jv=Zn(function(l){return l.push(w,er),fa(D_,w,l)});function n1(l,d,_){var I=null==l?w:fd(l,d);return I===w?_:I}function M_(l,d){return null!=l&&uv(l,d,VS)}var Fw=xp(function(l,d,_){null!=d&&"function"!=typeof d.toString&&(d=bh.call(d)),l[d]=_},d1(Yr)),Nw=xp(function(l,d,_){null!=d&&"function"!=typeof d.toString&&(d=bh.call(d)),Gi.call(l,d)?l[d].push(_):l[d]=[_]},xn),Rw=Zn(fp);function To(l){return Io(l)?gr(l):Rm(l)}function fs(l){return Io(l)?gr(l,!0):function Sx(l){if(!sr(l))return function e_(l){var d=[];if(null!=l)for(var _ in Xi(l))d.push(_);return d}(l);var d=xd(l),_=[];for(var I in l)"constructor"==I&&(d||!Gi.call(l,I))||_.push(I);return _}(l)}var Bw=to(function(l,d,_){mp(l,d,_)}),D_=to(function(l,d,_,I){mp(l,d,_,I)}),qp=pl(function(l,d){var _={};if(null==l)return _;var I=!1;d=Tr(d,function(le){return le=Ys(le,l),I||(I=le.length>1),le}),ma(l,fu(l),_),I&&(_=cs(_,7,mc));for(var G=d.length;G--;)Hl(_,d[G]);return _}),k_=pl(function(l,d){return null==l?{}:function ev(l,d){return tv(l,d,function(_,I){return M_(l,I)})}(l,d)});function s1(l,d){if(null==l)return{};var _=Tr(fu(l),function(I){return[I]});return d=xn(d),tv(l,_,function(I,G){return d(I,G[0])})}var bn=av(To),O_=av(fs);function kd(l){return null==l?[]:gh(l,To(l))}var Ww=bd(function(l,d,_){return d=d.toLowerCase(),l+(_?a1(d):d)});function a1(l){return ps(Fi(l).toLowerCase())}function A_(l){return(l=Fi(l))&&l.replace(Hs,sx).replace(Gf,"")}var qw=bd(function(l,d,_){return l+(_?"-":"")+d.toLowerCase()}),Xw=bd(function(l,d,_){return l+(_?" ":"")+d.toLowerCase()}),Kw=fl("toLowerCase"),wM=bd(function(l,d,_){return l+(_?"_":"")+d.toLowerCase()}),IM=bd(function(l,d,_){return l+(_?" ":"")+ps(d)}),Od=bd(function(l,d,_){return l+(_?" ":"")+d.toUpperCase()}),ps=fl("toUpperCase");function ya(l,d,_){return l=Fi(l),(d=_?w:d)===w?function Xf(Ce){return KC.test(Ce)}(l)?function Kf(Ce){return Ce.match(hm)||[]}(l):function rx(Ce){return Ce.match(qc)||[]}(l):l.match(d)||[]}var R_=Zn(function(l,d){try{return fa(l,w,d)}catch(_){return Vh(_)?_:new Gn(_)}}),TM=pl(function(l,d){return Ms(d,function(_){_=Ga(_),Ba(l,_,Za(l[_],l))}),l});function d1(l){return function(){return l}}var f1=Cp(),MM=Cp(!0);function Yr(l){return l}function Zh(l){return Nm("function"==typeof l?l:cs(l,1))}var Ad=Zn(function(l,d){return function(_){return fp(_,l,d)}}),B_=Zn(function(l,d){return function(_){return fp(l,_,d)}});function Qp(l,d,_){var I=To(d),G=hd(d,I);null==_&&(!sr(d)||!G.length&&I.length)&&(_=d,d=l,l=this,G=hd(d,To(d)));var le=!(sr(_)&&"chain"in _&&!_.chain),xe=ml(l);return Ms(G,function(Me){var $e=d[Me];l[Me]=$e,xe&&(l.prototype[Me]=function(){var It=this.__chain__;if(le||It){var nt=l(this.__wrapped__);return(nt.__actions__=Xo(this.__actions__)).push({func:$e,args:arguments,thisArg:l}),nt.__chain__=It,nt}return $e.apply(l,Qc([this.value()],arguments))})}),l}function Pd(){}var iE=Wm(Tr),p1=Wm($f),rE=Wm(Qu);function g1(l){return mu(l)?Zf(Ga(l)):function ZS(l){return function(d){return fd(d,l)}}(l)}var m1=Ym(),qh=Ym(!0);function Fd(){return[]}function Xh(){return!1}var v1=hu(function(l,d){return l+d},0),lE=wp("ceil"),DM=hu(function(l,d){return l/d},1),Jp=wp("floor"),eg=hu(function(l,d){return l*d},1),Kh=wp("round"),E1=hu(function(l,d){return l-d},0);return ee.after=function Bp(l,d){if("function"!=typeof d)throw new pa(P);return l=ti(l),function(){if(--l<1)return d.apply(this,arguments)}},ee.ary=Wv,ee.assign=Aw,ee.assignIn=Qv,ee.assignInWith=Yp,ee.assignWith=Pw,ee.at=Zp,ee.before=f_,ee.bind=Za,ee.bindAll=TM,ee.bindKey=_w,ee.castArray=function jp(){if(!arguments.length)return[];var l=arguments[0];return qn(l)?l:[l]},ee.chain=Np,ee.chunk=function lo(l,d,_){d=(_?ds(l,d,_):d===w)?1:wo(ti(d),0);var I=null==l?0:l.length;if(!I||d<1)return[];for(var G=0,le=0,xe=ut(ip(I/d));G<I;)xe[le++]=$s(l,G,G+=d);return xe},ee.compact=function zx(l){for(var d=-1,_=null==l?0:l.length,I=0,G=[];++d<_;){var le=l[d];le&&(G[I++]=le)}return G},ee.concat=function Ko(){var l=arguments.length;if(!l)return[];for(var d=ut(l-1),_=arguments[0],I=l;I--;)d[I-1]=arguments[I];return Qc(qn(_)?Xo(_):[_],Fo(d,1))},ee.cond=function eE(l){var d=null==l?0:l.length,_=xn();return l=d?Tr(l,function(I){if("function"!=typeof I[1])throw new pa(P);return[_(I[0]),I[1]]}):[],Zn(function(I){for(var G=-1;++G<d;){var le=l[G];if(fa(le[0],this,I))return fa(le[1],this,I)}})},ee.conforms=function SM(l){return function dd(l){var d=To(l);return function(_){return Rr(_,l,d)}}(cs(l,1))},ee.constant=d1,ee.countBy=sw,ee.create=function Gl(l,d){var _=hc(l);return null==d?_:fc(_,d)},ee.curry=function p_(l,d,_){var I=mr(l,8,w,w,w,w,w,d=_?w:d);return I.placeholder=p_.placeholder,I},ee.curryRight=function Up(l,d,_){var I=mr(l,16,w,w,w,w,w,d=_?w:d);return I.placeholder=Up.placeholder,I},ee.debounce=$v,ee.defaults=Wh,ee.defaultsDeep=Jv,ee.defer=bw,ee.delay=lM,ee.difference=n_,ee.differenceBy=Hx,ee.differenceWith=_v,ee.drop=function kp(l,d,_){var I=null==l?0:l.length;return I?$s(l,(d=_||d===w?1:ti(d))<0?0:d,I):[]},ee.dropRight=function Vx(l,d,_){var I=null==l?0:l.length;return I?$s(l,0,(d=I-(d=_||d===w?1:ti(d)))<0?0:d):[]},ee.dropRightWhile=function bv(l,d){return l&&l.length?kh(l,xn(d,3),!0,!0):[]},ee.dropWhile=function i_(l,d){return l&&l.length?kh(l,xn(d,3),!0):[]},ee.fill=function Op(l,d,_,I){var G=null==l?0:l.length;return G?(_&&"number"!=typeof _&&ds(l,d,_)&&(_=0,I=G),function Ua(l,d,_,I){var G=l.length;for((_=ti(_))<0&&(_=-_>G?0:G+_),(I=I===w||I>G?G:ti(I))<0&&(I+=G),I=_>I?0:Xv(I);_<I;)l[_++]=d;return l}(l,d,_,I)):[]},ee.filter=function lw(l,d){return(qn(l)?Pl:dp)(l,xn(d,3))},ee.flatMap=function Bv(l,d){return Fo(Lp(l,d),1)},ee.flatMapDeep=function Uv(l,d){return Fo(Lp(l,d),Tt)},ee.flatMapDepth=function Rp(l,d,_){return _=_===w?1:ti(_),Fo(Lp(l,d),_)},ee.flatten=yv,ee.flattenDeep=function jx(l){return null!=l&&l.length?Fo(l,Tt):[]},ee.flattenDepth=function Cv(l,d){return null!=l&&l.length?Fo(l,d=d===w?1:ti(d)):[]},ee.flip=function cM(l){return mr(l,512)},ee.flow=f1,ee.flowRight=MM,ee.fromPairs=function Gx(l){for(var d=-1,_=null==l?0:l.length,I={};++d<_;){var G=l[d];I[G[0]]=G[1]}return I},ee.functions=function S_(l){return null==l?[]:hd(l,To(l))},ee.functionsIn=function mM(l){return null==l?[]:hd(l,fs(l))},ee.groupBy=zv,ee.initial=function $x(l){return null!=l&&l.length?$s(l,0,-1):[]},ee.intersection=JS,ee.intersectionBy=xv,ee.intersectionWith=wv,ee.invert=Fw,ee.invertBy=Nw,ee.invokeMap=uw,ee.iteratee=Zh,ee.keyBy=dw,ee.keys=To,ee.keysIn=fs,ee.map=Lp,ee.mapKeys=function r1(l,d){var _={};return d=xn(d,3),za(l,function(I,G,le){Ba(_,d(I,G,le),I)}),_},ee.mapValues=function Lw(l,d){var _={};return d=xn(d,3),za(l,function(I,G,le){Ba(_,G,d(I,G,le))}),_},ee.matches=function L_(l){return Jb(cs(l,1))},ee.matchesProperty=function tE(l,d){return gp(l,cs(d,1))},ee.memoize=bu,ee.merge=Bw,ee.mergeWith=D_,ee.method=Ad,ee.methodOf=B_,ee.mixin=Qp,ee.negate=zp,ee.nthArg=function nE(l){return l=ti(l),Zn(function(d){return Bm(d,l)})},ee.omit=qp,ee.omitBy=function o1(l,d){return s1(l,zp(xn(d)))},ee.once=function g_(l){return f_(2,l)},ee.orderBy=function hw(l,d,_,I){return null==l?[]:(qn(d)||(d=null==d?[]:[d]),qn(_=I?w:_)||(_=null==_?[]:[_]),Um(l,d,_))},ee.over=iE,ee.overArgs=m_,ee.overEvery=p1,ee.overSome=rE,ee.partial=yc,ee.partialRight=Hp,ee.partition=Vv,ee.pick=k_,ee.pickBy=s1,ee.property=g1,ee.propertyOf=function oE(l){return function(d){return null==l?w:fd(l,d)}},ee.pull=s_,ee.pullAll=$a,ee.pullAllBy=function Iv(l,d,_){return l&&l.length&&d&&d.length?Ui(l,d,xn(_,2)):l},ee.pullAllWith=function Id(l,d,_){return l&&l.length&&d&&d.length?Ui(l,d,w,_):l},ee.pullAt=Yx,ee.range=m1,ee.rangeRight=qh,ee.rearg=__,ee.reject=function fw(l,d){return(qn(l)?Pl:dp)(l,zp(xn(d,3)))},ee.remove=function Zx(l,d){var _=[];if(!l||!l.length)return _;var I=-1,G=[],le=l.length;for(d=xn(d,3);++I<le;){var xe=l[I];d(xe,I,l)&&(_.push(xe),G.push(I))}return _p(l,G),_},ee.rest=function Uh(l,d){if("function"!=typeof l)throw new pa(P);return Zn(l,d=d===w?d:ti(d))},ee.reverse=Ap,ee.sampleSize=function aM(l,d,_){return d=(_?ds(l,d,_):d===w)?1:ti(d),(qn(l)?cd:Ws)(l,d)},ee.set=function $r(l,d,_){return null==l?l:Sh(l,d,_)},ee.setWith=function Uw(l,d,_,I){return I="function"==typeof I?I:w,null==l?l:Sh(l,d,_,I)},ee.shuffle=function gw(l){return(qn(l)?zl:ul)(l)},ee.slice=function tM(l,d,_){var I=null==l?0:l.length;return I?(_&&"number"!=typeof _&&ds(l,d,_)?(d=0,_=I):(d=null==d?0:ti(d),_=_===w?I:ti(_)),$s(l,d,_)):[]},ee.sortBy=mw,ee.sortedUniq=function fr(l){return l&&l.length?vp(l):[]},ee.sortedUniqBy=function Tv(l,d){return l&&l.length?vp(l,xn(d,2)):[]},ee.split=function EM(l,d,_){return _&&"number"!=typeof _&&ds(l,d,_)&&(d=_=w),(_=_===w?Rt:_>>>0)?(l=Fi(l))&&("string"==typeof d||null!=d&&!jh(d))&&!(d=qo(d))&&Nl(l)?pc(Kr(l),0,_):l.split(d,_):[]},ee.spread=function Vp(l,d){if("function"!=typeof l)throw new pa(P);return d=null==d?0:wo(ti(d),0),Zn(function(_){var I=_[d],G=pc(_,0,d);return I&&Qc(G,I),fa(l,this,G)})},ee.tail=function Xx(l){var d=null==l?0:l.length;return d?$s(l,1,d):[]},ee.take=function a_(l,d,_){return l&&l.length?$s(l,0,(d=_||d===w?1:ti(d))<0?0:d):[]},ee.takeRight=function ei(l,d,_){var I=null==l?0:l.length;return I?$s(l,(d=I-(d=_||d===w?1:ti(d)))<0?0:d,I):[]},ee.takeRightWhile=function Kx(l,d){return l&&l.length?kh(l,xn(d,3),!1,!0):[]},ee.takeWhile=function l_(l,d){return l&&l.length?kh(l,xn(d,3)):[]},ee.tap=function Qo(l,d){return d(l),l},ee.throttle=function Sd(l,d,_){var I=!0,G=!0;if("function"!=typeof l)throw new pa(P);return sr(_)&&(I="leading"in _?!!_.leading:I,G="trailing"in _?!!_.trailing:G),$v(l,d,{leading:I,maxWait:d,trailing:G})},ee.thru=vc,ee.toArray=Xa,ee.toPairs=bn,ee.toPairsIn=O_,ee.toPath=function yu(l){return qn(l)?Tr(l,Ga):co(l)?[l]:Xo(mv(Fi(l)))},ee.toPlainObject=Kv,ee.transform=function zw(l,d,_){var I=qn(l),G=I||xc(l)||Dd(l);if(d=xn(d,4),null==_){var le=l&&l.constructor;_=G?I?new le:[]:sr(l)&&ml(le)?hc(vh(l)):{}}return(G?Ms:za)(l,function(xe,Me,$e){return d(_,xe,Me,$e)}),_},ee.unary=function b_(l){return Wv(l,1)},ee.union=Lh,ee.unionBy=Qx,ee.unionWith=Sv,ee.uniq=function Mv(l){return l&&l.length?dl(l):[]},ee.uniqBy=function Pp(l,d){return l&&l.length?dl(l,xn(d,2)):[]},ee.uniqWith=function Fp(l,d){return d="function"==typeof d?d:w,l&&l.length?dl(l,w,d):[]},ee.unset=function Hw(l,d){return null==l||Hl(l,d)},ee.unzip=Bh,ee.unzipWith=Dv,ee.update=function Vw(l,d,_){return null==l?l:Fn(l,d,yp(_))},ee.updateWith=function jw(l,d,_,I){return I="function"==typeof I?I:w,null==l?l:Fn(l,d,yp(_),I)},ee.values=kd,ee.valuesIn=function _M(l){return null==l?[]:gh(l,fs(l))},ee.without=Jx,ee.words=ya,ee.wrap=function v_(l,d){return yc(yp(d),l)},ee.xor=ew,ee.xorBy=kv,ee.xorWith=tw,ee.zip=nw,ee.zipObject=function As(l,d){return nv(l||[],d||[],ud)},ee.zipObjectDeep=function c_(l,d){return nv(l||[],d||[],Sh)},ee.zipWith=Ov,ee.entries=bn,ee.entriesIn=O_,ee.extend=Qv,ee.extendWith=Yp,Qp(ee,ee),ee.add=v1,ee.attempt=R_,ee.camelCase=Ww,ee.capitalize=a1,ee.ceil=lE,ee.clamp=function bM(l,d,_){return _===w&&(_=d,d=w),_!==w&&(_=(_=ba(_))==_?_:0),d!==w&&(d=(d=ba(d))==d?d:0),Zo(ba(l),d,_)},ee.clone=function uM(l){return cs(l,4)},ee.cloneDeep=function zh(l){return cs(l,5)},ee.cloneDeepWith=function vw(l,d){return cs(l,5,d="function"==typeof d?d:w)},ee.cloneWith=function y_(l,d){return cs(l,4,d="function"==typeof d?d:w)},ee.conformsTo=function Yv(l,d){return null==d||Rr(l,d,To(d))},ee.deburr=A_,ee.defaultTo=function h1(l,d){return null==l||l!=l?d:l},ee.divide=DM,ee.endsWith=function $w(l,d,_){l=Fi(l),d=qo(d);var I=l.length,G=_=_===w?I:Zo(ti(_),0,I);return(_-=d.length)>=0&&l.slice(_,G)==d},ee.eq=qa,ee.escape=function Yw(l){return(l=Fi(l))&&qi.test(l)?l.replace(Gu,Ds):l},ee.escapeRegExp=function Zw(l){return(l=Fi(l))&&Ol.test(l)?l.replace(ac,"\\$&"):l},ee.every=function aw(l,d,_){var I=qn(l)?$f:cu;return _&&ds(l,d,_)&&(d=w),I(l,xn(d,3))},ee.find=cw,ee.findIndex=r_,ee.findKey=function e1(l,d){return ym(l,xn(d,3),za)},ee.findLast=Lv,ee.findLastIndex=vv,ee.findLastKey=function t1(l,d){return ym(l,xn(d,3),Fm)},ee.floor=Jp,ee.forEach=u_,ee.forEachRight=d_,ee.forIn=function fM(l,d){return null==l?l:Pm(l,xn(d,3),fs)},ee.forInRight=function pM(l,d){return null==l?l:hp(l,xn(d,3),fs)},ee.forOwn=function gM(l,d){return l&&za(l,xn(d,3))},ee.forOwnRight=function T_(l,d){return l&&Fm(l,xn(d,3))},ee.get=n1,ee.gt=yw,ee.gte=C_,ee.has=function i1(l,d){return null!=l&&uv(l,d,HS)},ee.hasIn=M_,ee.head=o_,ee.identity=Yr,ee.includes=function Hv(l,d,_,I){l=Io(l)?l:kd(l),_=_&&!I?ti(_):0;var G=l.length;return _<0&&(_=wo(G+_,0)),Gh(l)?_<=G&&l.indexOf(d,_)>-1:!!G&&Ju(l,d,_)>-1},ee.indexOf=function Wx(l,d,_){var I=null==l?0:l.length;if(!I)return-1;var G=null==_?0:ti(_);return G<0&&(G=wo(I+G,0)),Ju(l,d,G)},ee.inRange=function $h(l,d,_){return d=jl(d),_===w?(_=d,d=0):_=jl(_),function jS(l,d,_){return l>=Eo(d,_)&&l<wo(d,_)}(l=ba(l),d,_)},ee.invoke=Rw,ee.isArguments=Cc,ee.isArray=qn,ee.isArrayBuffer=Cw,ee.isArrayLike=Io,ee.isArrayLikeObject=Lr,ee.isBoolean=function x_(l){return!0===l||!1===l||Mr(l)&&Os(l)==fn},ee.isBuffer=xc,ee.isDate=dM,ee.isElement=function hM(l){return Mr(l)&&1===l.nodeType&&!wc(l)},ee.isEmpty=function Hh(l){if(null==l)return!0;if(Io(l)&&(qn(l)||"string"==typeof l||"function"==typeof l.splice||xc(l)||Dd(l)||Cc(l)))return!l.length;var d=no(l);if(d==fe||d==Ht)return!l.size;if(xd(l))return!Rm(l).length;for(var _ in l)if(Gi.call(l,_))return!1;return!0},ee.isEqual=function xw(l,d){return pd(l,d)},ee.isEqualWith=function Gp(l,d,_){var I=(_="function"==typeof _?_:w)?_(l,d):w;return I===w?pd(l,d,w,_):!!I},ee.isError=Vh,ee.isFinite=function ww(l){return"number"==typeof l&&op(l)},ee.isFunction=ml,ee.isInteger=Wp,ee.isLength=vu,ee.isMap=w_,ee.isMatch=function Zv(l,d){return l===d||Kb(l,d,Fh(d))},ee.isMatchWith=function $p(l,d,_){return _="function"==typeof _?_:w,Kb(l,d,Fh(d),_)},ee.isNaN=function E_(l){return Tw(l)&&l!=+l},ee.isNative=function Md(l){if(hv(l))throw new Gn("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Ix(l)},ee.isNil=function Iw(l){return null==l},ee.isNull=function Ew(l){return null===l},ee.isNumber=Tw,ee.isObject=sr,ee.isObjectLike=Mr,ee.isPlainObject=wc,ee.isRegExp=jh,ee.isSafeInteger=function qv(l){return Wp(l)&&l>=-Ze&&l<=Ze},ee.isSet=I_,ee.isString=Gh,ee.isSymbol=co,ee.isTypedArray=Dd,ee.isUndefined=function Sw(l){return l===w},ee.isWeakMap=function Mw(l){return Mr(l)&&no(l)==jn},ee.isWeakSet=function Dw(l){return Mr(l)&&"[object WeakSet]"==Os(l)},ee.join=function hs(l,d){return null==l?"":Vb.call(l,d)},ee.kebabCase=qw,ee.last=Wa,ee.lastIndexOf=function Ev(l,d,_){var I=null==l?0:l.length;if(!I)return-1;var G=I;return _!==w&&(G=(G=ti(_))<0?wo(I+G,0):Eo(G,I-1)),d==d?function zS(Ce,Ct,ut){for(var cn=ut+1;cn--;)if(Ce[cn]===Ct)return cn;return cn}(l,d,G):Fl(l,Pb,G,!0)},ee.lowerCase=Xw,ee.lowerFirst=Kw,ee.lt=kw,ee.lte=qs,ee.max=function cE(l){return l&&l.length?uu(l,Yr,Zb):w},ee.maxBy=function y1(l,d){return l&&l.length?uu(l,xn(d,2),Zb):w},ee.mean=function C1(l){return Nn(l,Yr)},ee.meanBy=function x1(l,d){return Nn(l,xn(d,2))},ee.min=function H_(l){return l&&l.length?uu(l,Yr,pp):w},ee.minBy=function w1(l,d){return l&&l.length?uu(l,xn(d,2),pp):w},ee.stubArray=Fd,ee.stubFalse=Xh,ee.stubObject=function sE(){return{}},ee.stubString=function aE(){return""},ee.stubTrue=function z_(){return!0},ee.multiply=eg,ee.nth=function eM(l,d){return l&&l.length?Bm(l,ti(d)):w},ee.noConflict=function U_(){return jr._===this&&(jr._=cx),this},ee.noop=Pd,ee.now=Ya,ee.pad=function P_(l,d,_){l=Fi(l);var I=(d=ti(d))?iu(l):0;if(!d||I>=d)return l;var G=(d-I)/2;return Ah(rp(G),_)+l+Ah(ip(G),_)},ee.padEnd=function vM(l,d,_){l=Fi(l);var I=(d=ti(d))?iu(l):0;return d&&I<d?l+Ah(d-I,_):l},ee.padStart=function yM(l,d,_){l=Fi(l);var I=(d=ti(d))?iu(l):0;return d&&I<d?Ah(d-I,_)+l:l},ee.parseInt=function F_(l,d,_){return _||null==d?d=0:d&&(d=+d),Dm(Fi(l).replace(xo,""),d||0)},ee.random=function Gw(l,d,_){if(_&&"boolean"!=typeof _&&ds(l,d,_)&&(d=_=w),_===w&&("boolean"==typeof d?(_=d,d=w):"boolean"==typeof l&&(_=l,l=w)),l===w&&d===w?(l=0,d=1):(l=jl(l),d===w?(d=l,l=0):d=jl(d)),l>d){var I=l;l=d,d=I}if(_||l%1||d%1){var G=km();return Eo(l+G*(d-l+BS("1e-"+((G+"").length-1))),d)}return du(l,d)},ee.reduce=function sM(l,d,_){var I=qn(l)?Jc:ph,G=arguments.length<3;return I(l,xn(d,4),_,G,Sr)},ee.reduceRight=function jv(l,d,_){var I=qn(l)?vm:ph,G=arguments.length<3;return I(l,xn(d,4),_,G,up)},ee.repeat=function CM(l,d,_){return d=(_?ds(l,d,_):d===w)?1:ti(d),zm(Fi(l),d)},ee.replace=function xM(){var l=arguments,d=Fi(l[0]);return l.length<3?d:d.replace(l[1],l[2])},ee.result=function va(l,d,_){var I=-1,G=(d=Ys(d,l)).length;for(G||(G=1,l=w);++I<G;){var le=null==l?w:l[Ga(d[I])];le===w&&(I=G,le=_),l=ml(le)?le.call(l):le}return l},ee.round=Kh,ee.runInContext=Ce,ee.sample=function pw(l){return(qn(l)?ld:gd)(l)},ee.size=function Gv(l){if(null==l)return 0;if(Io(l))return Gh(l)?iu(l):l.length;var d=no(l);return d==fe||d==Ht?l.size:Rm(l).length},ee.snakeCase=wM,ee.some=function h_(l,d,_){var I=qn(l)?Qu:Dx;return _&&ds(l,d,_)&&(d=w),I(l,xn(d,3))},ee.sortedIndex=function nM(l,d){return Mh(l,d)},ee.sortedIndexBy=function iM(l,d,_){return Dh(l,d,xn(_,2))},ee.sortedIndexOf=function rM(l,d){var _=null==l?0:l.length;if(_){var I=Mh(l,d);if(I<_&&qa(l[I],d))return I}return-1},ee.sortedLastIndex=function oM(l,d){return Mh(l,d,!0)},ee.sortedLastIndexBy=function qx(l,d,_){return Dh(l,d,xn(_,2),!0)},ee.sortedLastIndexOf=function Td(l,d){if(null!=l&&l.length){var I=Mh(l,d,!0)-1;if(qa(l[I],d))return I}return-1},ee.startCase=IM,ee.startsWith=function Qw(l,d,_){return l=Fi(l),_=null==_?0:Zo(ti(_),0,l.length),d=qo(d),l.slice(_,_+d.length)==d},ee.subtract=E1,ee.sum=function V_(l){return l&&l.length?eu(l,Yr):0},ee.sumBy=function Qh(l,d){return l&&l.length?eu(l,xn(d,2)):0},ee.template=function Xp(l,d,_){var I=ee.templateSettings;_&&ds(l,d,_)&&(d=w),l=Fi(l),d=Yp({},d,I,gc);var Me,$e,G=Yp({},d.imports,I.imports,gc),le=To(G),xe=gh(G,le),It=0,nt=d.interpolate||os,h="__p += '",Jt=Sm((d.escape||os).source+"|"+nt.source+"|"+(nt===$u?Al:os).source+"|"+(d.evaluate||os).source+"|$","g"),Y="//# sourceURL="+(Gi.call(d,"sourceURL")?(d.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++fm+"]")+"\n";l.replace(Jt,function(An,si,ai,gs,uo,Ps){return ai||(ai=gs),h+=l.slice(It,Ps).replace(Xc,ed),si&&(Me=!0,h+="' +\n__e("+si+") +\n'"),uo&&($e=!0,h+="';\n"+uo+";\n__p += '"),ai&&(h+="' +\n((__t = ("+ai+")) == null ? '' : __t) +\n'"),It=Ps+An.length,An}),h+="';\n";var On=Gi.call(d,"variable")&&d.variable;if(On){if(mt.test(On))throw new Gn("Invalid `variable` option passed into `_.template`")}else h="with (obj) {\n"+h+"\n}\n";h=($e?h.replace(Oa,""):h).replace(xs,"$1").replace(ro,"$1;"),h="function("+(On||"obj")+") {\n"+(On?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(Me?", __e = _.escape":"")+($e?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var ni=R_(function(){return vi(le,Y+"return "+h).apply(w,xe)});if(ni.source=h,Vh(ni))throw ni;return ni},ee.times=function _1(l,d){if((l=ti(l))<1||l>Ze)return[];var _=Rt,I=Eo(l,Rt);d=xn(d),l-=Rt;for(var G=xm(I,d);++_<l;)d(_);return G},ee.toFinite=jl,ee.toInteger=ti,ee.toLength=Xv,ee.toLower=function Kp(l){return Fi(l).toLowerCase()},ee.toNumber=ba,ee.toSafeInteger=function Ow(l){return l?Zo(ti(l),-Ze,Ze):0===l?l:0},ee.toString=Fi,ee.toUpper=function N_(l){return Fi(l).toUpperCase()},ee.trim=function l1(l,d,_){if((l=Fi(l))&&(_||d===w))return Fb(l);if(!l||!(d=qo(d)))return l;var I=Kr(l),G=Kr(d);return pc(I,qf(I,G),Nb(I,G)+1).join("")},ee.trimEnd=function c1(l,d,_){if((l=Fi(l))&&(_||d===w))return l.slice(0,wi(l)+1);if(!l||!(d=qo(d)))return l;var I=Kr(l);return pc(I,0,Nb(I,Kr(d))+1).join("")},ee.trimStart=function Jw(l,d,_){if((l=Fi(l))&&(_||d===w))return l.replace(xo,"");if(!l||!(d=qo(d)))return l;var I=Kr(l);return pc(I,qf(I,Kr(d))).join("")},ee.truncate=function Yh(l,d){var _=30,I="...";if(sr(d)){var G="separator"in d?d.separator:G;_="length"in d?ti(d.length):_,I="omission"in d?qo(d.omission):I}var le=(l=Fi(l)).length;if(Nl(l)){var xe=Kr(l);le=xe.length}if(_>=le)return l;var Me=_-iu(I);if(Me<1)return I;var $e=xe?pc(xe,0,Me).join(""):l.slice(0,Me);if(G===w)return $e+I;if(xe&&(Me+=$e.length-Me),jh(G)){if(l.slice(Me).search(G)){var It,nt=$e;for(G.global||(G=Sm(G.source,Fi(lc.exec(G))+"g")),G.lastIndex=0;It=G.exec(nt);)var h=It.index;$e=$e.slice(0,h===w?Me:h)}}else if(l.indexOf(qo(G),Me)!=Me){var Jt=$e.lastIndexOf(G);Jt>-1&&($e=$e.slice(0,Jt))}return $e+I},ee.unescape=function u1(l){return(l=Fi(l))&&sc.test(l)?l.replace(oc,nd):l},ee.uniqueId=function b1(l){var d=++ax;return Fi(l)+d},ee.upperCase=Od,ee.upperFirst=ps,ee.each=u_,ee.eachRight=d_,ee.first=o_,Qp(ee,function(){var l={};return za(ee,function(d,_){Gi.call(ee.prototype,_)||(l[_]=d)}),l}(),{chain:!1}),ee.VERSION="4.17.21",Ms(["bind","bindKey","curry","curryRight","partial","partialRight"],function(l){ee[l].placeholder=ee}),Ms(["drop","take"],function(l,d){ci.prototype[l]=function(_){_=_===w?1:wo(ti(_),0);var I=this.__filtered__&&!d?new ci(this):this.clone();return I.__filtered__?I.__takeCount__=Eo(_,I.__takeCount__):I.__views__.push({size:Eo(_,Rt),type:l+(I.__dir__<0?"Right":"")}),I},ci.prototype[l+"Right"]=function(_){return this.reverse()[l](_).reverse()}}),Ms(["filter","map","takeWhile"],function(l,d){var _=d+1,I=1==_||3==_;ci.prototype[l]=function(G){var le=this.clone();return le.__iteratees__.push({iteratee:xn(G,3),type:_}),le.__filtered__=le.__filtered__||I,le}}),Ms(["head","last"],function(l,d){var _="take"+(d?"Right":"");ci.prototype[l]=function(){return this[_](1).value()[0]}}),Ms(["initial","tail"],function(l,d){var _="drop"+(d?"":"Right");ci.prototype[l]=function(){return this.__filtered__?new ci(this):this[_](1)}}),ci.prototype.compact=function(){return this.filter(Yr)},ci.prototype.find=function(l){return this.filter(l).head()},ci.prototype.findLast=function(l){return this.reverse().find(l)},ci.prototype.invokeMap=Zn(function(l,d){return"function"==typeof l?new ci(this):this.map(function(_){return fp(_,l,d)})}),ci.prototype.reject=function(l){return this.filter(zp(xn(l)))},ci.prototype.slice=function(l,d){l=ti(l);var _=this;return _.__filtered__&&(l>0||d<0)?new ci(_):(l<0?_=_.takeRight(-l):l&&(_=_.drop(l)),d!==w&&(_=(d=ti(d))<0?_.dropRight(-d):_.take(d-l)),_)},ci.prototype.takeRightWhile=function(l){return this.reverse().takeWhile(l).reverse()},ci.prototype.toArray=function(){return this.take(Rt)},za(ci.prototype,function(l,d){var _=/^(?:filter|find|map|reject)|While$/.test(d),I=/^(?:head|last)$/.test(d),G=ee[I?"take"+("last"==d?"Right":""):d],le=I||/^find/.test(d);G&&(ee.prototype[d]=function(){var xe=this.__wrapped__,Me=I?[1]:arguments,$e=xe instanceof ci,It=Me[0],nt=$e||qn(xe),h=function(si){var ai=G.apply(ee,Qc([si],Me));return I&&Jt?ai[0]:ai};nt&&_&&"function"==typeof It&&1!=It.length&&($e=nt=!1);var Jt=this.__chain__,On=le&&!Jt,ni=$e&&!this.__actions__.length;if(!le&&nt){xe=ni?xe:new ci(this);var An=l.apply(xe,Me);return An.__actions__.push({func:vc,args:[h],thisArg:w}),new Gs(An,Jt)}return On&&ni?l.apply(this,Me):(An=this.thru(h),On?I?An.value()[0]:An.value():An)})}),Ms(["pop","push","shift","sort","splice","unshift"],function(l){var d=Jf[l],_=/^(?:push|sort|unshift)$/.test(l)?"tap":"thru",I=/^(?:pop|shift)$/.test(l);ee.prototype[l]=function(){var G=arguments;if(I&&!this.__chain__){var le=this.value();return d.apply(qn(le)?le:[],G)}return this[_](function(xe){return d.apply(qn(xe)?xe:[],G)})}}),za(ci.prototype,function(l,d){var _=ee[d];if(_){var I=_.name+"";Gi.call(ls,I)||(ls[I]=[]),ls[I].push({name:d,func:_})}}),ls[yd(w,2).name]=[{name:"wrapper",func:w}],ci.prototype.clone=function od(){var l=new ci(this.__wrapped__);return l.__actions__=Xo(this.__actions__),l.__dir__=this.__dir__,l.__filtered__=this.__filtered__,l.__iteratees__=Xo(this.__iteratees__),l.__takeCount__=this.__takeCount__,l.__views__=Xo(this.__views__),l},ci.prototype.reverse=function gx(){if(this.__filtered__){var l=new ci(this);l.__dir__=-1,l.__filtered__=!0}else(l=this.clone()).__dir__*=-1;return l},ci.prototype.value=function mx(){var l=this.__wrapped__.value(),d=this.__dir__,_=qn(l),I=d<0,G=_?l.length:0,le=function Rx(l,d,_){for(var I=-1,G=_.length;++I<G;){var le=_[I],xe=le.size;switch(le.type){case"drop":l+=xe;break;case"dropRight":d-=xe;break;case"take":d=Eo(d,l+xe);break;case"takeRight":l=wo(l,d-xe)}}return{start:l,end:d}}(0,G,this.__views__),xe=le.start,Me=le.end,$e=Me-xe,It=I?Me:xe-1,nt=this.__iteratees__,h=nt.length,Jt=0,Y=Eo($e,this.__takeCount__);if(!_||!I&&G==$e&&Y==$e)return kx(l,this.__actions__);var On=[];e:for(;$e--&&Jt<Y;){for(var ni=-1,An=l[It+=d];++ni<h;){var si=nt[ni],gs=si.type,uo=(0,si.iteratee)(An);if(2==gs)An=uo;else if(!uo){if(1==gs)continue e;break e}}On[Jt++]=An}return On},ee.prototype.at=Av,ee.prototype.chain=function Pv(){return Np(this)},ee.prototype.commit=function iw(){return new Gs(this.value(),this.__chain__)},ee.prototype.next=function Fv(){this.__values__===w&&(this.__values__=Xa(this.value()));var l=this.__index__>=this.__values__.length;return{done:l,value:l?w:this.__values__[this.__index__++]}},ee.prototype.plant=function Nv(l){for(var d,_=this;_ instanceof Eh;){var I=_u(_);I.__index__=0,I.__values__=w,d?G.__wrapped__=I:d=I;var G=I;_=_.__wrapped__}return G.__wrapped__=l,d},ee.prototype.reverse=function ow(){var l=this.__wrapped__;if(l instanceof ci){var d=l;return this.__actions__.length&&(d=new ci(this)),(d=d.reverse()).__actions__.push({func:vc,args:[Ap],thisArg:w}),new Gs(d,this.__chain__)}return this.thru(Ap)},ee.prototype.toJSON=ee.prototype.valueOf=ee.prototype.value=function Rv(){return kx(this.__wrapped__,this.__actions__)},ee.prototype.first=ee.prototype.head,Gr&&(ee.prototype[Gr]=function rw(){return this}),ee}();jr._=ks,(L=function(){return ks}.call(X,me,X,Kt))!==w&&(Kt.exports=L)}.call(this)},1741:(Kt,X,me)=>{var L=me(5662),w=me(3192);function B(T){this._init(T)}B.prototype={_init:function(T){T=T||{},this._data=null,this._table=null,this._result=null,this._onDataCallback=T.onData,this._onEndCallback=T.onEnd},_createTable:function(){for(var T=w.createBuffer(8,L.TABLE_LENGTH),S=0;S<L.TABLE_LENGTH;S++)T[S]=L.BASE62TABLE.charCodeAt(S);return T},_onData:function(T,S){var P=w.bufferToString_fast(T,S);this._onDataCallback?this._onDataCallback(P):this._result+=P},_onEnd:function(){this._onEndCallback&&this._onEndCallback(),this._data=this._table=null},_search:function(){var T=2,S=this._data,P=this._offset,O=L.BUFFER_MAX;if(this._dataLen-P<O&&(O=this._dataLen-P),T>O)return!1;var D,k,z,N,Q,j=P-L.WINDOW_BUFFER_MAX,A=S.substring(j,P+O),E=P+T-3-j;do{if(2===T){if(k=S.charAt(P)+S.charAt(P+1),!~(z=A.indexOf(k))||z>E)break}else 3===T?k+=S.charAt(P+2):k=S.substr(P,T);if(!~(N=L.STRING_LASTINDEXOF_BUG?S.substring(j,P+T-1).lastIndexOf(k):A.lastIndexOf(k,E)))break;Q=N,D=j+N;do{if(S.charCodeAt(P+T)!==S.charCodeAt(D+T))break}while(++T<O);if(z===N){T++;break}}while(++T<O);return 2!==T&&(this._index=L.WINDOW_BUFFER_MAX-Q,this._length=T-1,!0)},compress:function(T){if(null==T||0===T.length)return"";var S,P=this._createTable(),O=w.createWindow(),j=w.createBuffer(8,L.COMPRESS_CHUNK_SIZE),A=0;this._result="",this._offset=O.length,this._data=O+T,this._dataLen=this._data.length,O=T=null;for(var k,z,N,Q,de,E=-1,D=-1;this._offset<this._dataLen;)this._search()?(this._index<L.BUFFER_MAX?(z=this._index,N=0):N=(this._index-(z=this._index%L.BUFFER_MAX))/L.BUFFER_MAX,2===this._length?(j[A++]=P[N+L.COMPRESS_FIXED_START],j[A++]=P[z]):(j[A++]=P[N+L.COMPRESS_START],j[A++]=P[z],j[A++]=P[this._length]),this._offset+=this._length,~D&&(D=-1)):(k=this._data.charCodeAt(this._offset++))<L.LATIN_BUFFER_MAX?(k<L.UNICODE_CHAR_MAX?(z=k,N=0,E=L.LATIN_INDEX):E=(N=(k-(z=k%L.UNICODE_CHAR_MAX))/L.UNICODE_CHAR_MAX)+L.LATIN_INDEX,D===E?j[A++]=P[z]:(j[A++]=P[E-L.LATIN_INDEX_START],j[A++]=P[z],D=E)):(k<L.UNICODE_BUFFER_MAX?(z=k,N=0,E=L.UNICODE_INDEX):E=(N=(k-(z=k%L.UNICODE_BUFFER_MAX))/L.UNICODE_BUFFER_MAX)+L.UNICODE_INDEX,z<L.UNICODE_CHAR_MAX?(Q=z,de=0):de=(z-(Q=z%L.UNICODE_CHAR_MAX))/L.UNICODE_CHAR_MAX,D===E?(j[A++]=P[Q],j[A++]=P[de]):(j[A++]=P[L.CHAR_START],j[A++]=P[E-L.TABLE_LENGTH],j[A++]=P[Q],j[A++]=P[de],D=E)),A>=L.COMPRESS_CHUNK_MAX&&(this._onData(j,A),A=0);return A>0&&this._onData(j,A),this._onEnd(),S=this._result,this._result=null,null===S?"":S}},Kt.exports=B},5662:(Kt,X)=>{var me=X.HAS_TYPED=typeof Uint8Array<"u"&&typeof Uint16Array<"u",L=!1,w=!1;try{"a"===String.fromCharCode.apply(null,[97])&&(L=!0)}catch{}if(me)try{"a"===String.fromCharCode.apply(null,new Uint8Array([97]))&&(w=!0)}catch{}X.CAN_CHARCODE_APPLY=L,X.CAN_CHARCODE_APPLY_TYPED=w;var B=X.APPLY_BUFFER_SIZE=65533;X.APPLY_BUFFER_SIZE_OK=null;var T=!1;-1!=="abc\u307b\u3052".lastIndexOf("\u307b\u3052",1)&&(T=!0),X.STRING_LASTINDEXOF_BUG=T;var S=X.BASE62TABLE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",P=X.TABLE_LENGTH=S.length,O=Math.max(P,62)-Math.min(P,62);X.BUFFER_MAX=P-1;var j=X.WINDOW_MAX=1024;X.WINDOW_BUFFER_MAX=304;var A=X.COMPRESS_CHUNK_SIZE=B;X.COMPRESS_CHUNK_MAX=A-P;var E=X.DECOMPRESS_CHUNK_SIZE=B;X.DECOMPRESS_CHUNK_MAX=E+2*j,X.LATIN_BUFFER_MAX=132;var k=X.UNICODE_CHAR_MAX=40;X.UNICODE_BUFFER_MAX=k*(k+1),X.LATIN_INDEX=P+1,X.LATIN_INDEX_START=O+20,X.UNICODE_INDEX=P+5,X.DECODE_MAX=P-O-19;var z=X.LATIN_DECODE_MAX=k+7,N=X.CHAR_START=z+1,Q=X.COMPRESS_START=N+1,de=X.COMPRESS_FIXED_START=Q+5;X.COMPRESS_INDEX=de+5},2062:(Kt,X,me)=>{var L=me(5662),w=me(3192);function B(T){this._init(T)}B.prototype={_init:function(T){T=T||{},this._result=null,this._onDataCallback=T.onData,this._onEndCallback=T.onEnd},_createTable:function(){for(var T={},S=0;S<L.TABLE_LENGTH;S++)T[L.BASE62TABLE.charAt(S)]=S;return T},_onData:function(T){var S;if(this._onDataCallback){if(T)S=this._result,this._result=[];else{var P=L.DECOMPRESS_CHUNK_SIZE-L.WINDOW_MAX;S=this._result.slice(L.WINDOW_MAX,L.WINDOW_MAX+P),this._result=this._result.slice(0,L.WINDOW_MAX).concat(this._result.slice(L.WINDOW_MAX+P))}S.length>0&&this._onDataCallback(w.bufferToString_fast(S))}},_onEnd:function(){this._onEndCallback&&this._onEndCallback()},decompress:function(T){if(null==T||0===T.length)return"";this._result=w.stringToArray(w.createWindow());for(var S,D,k,z,Q,de,we,J,ae,te,P=this._createTable(),O=!1,j=null,A=T.length,E=0;E<A;E++)if(void 0!==(k=P[T.charAt(E)])){if(k<L.DECODE_MAX)Q=O?P[T.charAt(++E)]*L.UNICODE_CHAR_MAX+k+L.UNICODE_BUFFER_MAX*j:j*L.UNICODE_CHAR_MAX+k,this._result[this._result.length]=Q;else if(k<L.LATIN_DECODE_MAX)j=k-L.DECODE_MAX,O=!1;else if(k===L.CHAR_START)j=(z=P[T.charAt(++E)])-5,O=!0;else if(k<L.COMPRESS_INDEX){if(z=P[T.charAt(++E)],k<L.COMPRESS_FIXED_START?(de=(k-L.COMPRESS_START)*L.BUFFER_MAX+z,we=P[T.charAt(++E)]):(de=(k-L.COMPRESS_FIXED_START)*L.BUFFER_MAX+z,we=2),(J=this._result.slice(-de)).length>we&&(J.length=we),ae=J.length,J.length>0)for(te=0;te<we;)for(D=0;D<ae&&(this._result[this._result.length]=J[D],!(++te>=we));D++);j=null}this._result.length>=L.DECOMPRESS_CHUNK_MAX&&this._onData()}return this._result=this._result.slice(L.WINDOW_MAX),this._onData(!0),this._onEnd(),S=w.bufferToString_fast(this._result),this._result=null,S}},Kt.exports=B},1782:(Kt,X,me)=>{var L=me(1741),w=me(2062);me(4469),X.B=function(B,T){return new L(T).compress(B)},X.m=function(B,T){return new w(T).decompress(B)}},3192:(Kt,X,me)=>{var L=me(5662),w=String.fromCharCode;X.createBuffer=function(P,O){if(!L.HAS_TYPED)return new Array(O);switch(P){case 8:return new Uint8Array(O);case 16:return new Uint16Array(O)}};var B=X.truncateBuffer=function(P,O){return P.length===O?P:P.subarray?P.subarray(0,O):(P.length=O,P)};X.bufferToString_fast=function(P,O){if(null==O?O=P.length:P=B(P,O),L.CAN_CHARCODE_APPLY&&L.CAN_CHARCODE_APPLY_TYPED){var j=P.length;if(j<L.APPLY_BUFFER_SIZE&&L.APPLY_BUFFER_SIZE_OK)return w.apply(null,P);if(null===L.APPLY_BUFFER_SIZE_OK)try{var A=w.apply(null,P);return j>L.APPLY_BUFFER_SIZE&&(L.APPLY_BUFFER_SIZE_OK=!0),A}catch{L.APPLY_BUFFER_SIZE_OK=!1}}return T(P)};var T=X.bufferToString_chunked=function(P){for(var E,O="",j=P.length,A=0;A<j;){if(E=P.subarray?P.subarray(A,A+L.APPLY_BUFFER_SIZE):P.slice(A,A+L.APPLY_BUFFER_SIZE),A+=L.APPLY_BUFFER_SIZE,!L.APPLY_BUFFER_SIZE_OK){if(null===L.APPLY_BUFFER_SIZE_OK)try{O+=w.apply(null,E),E.length>L.APPLY_BUFFER_SIZE&&(L.APPLY_BUFFER_SIZE_OK=!0);continue}catch{L.APPLY_BUFFER_SIZE_OK=!1}return S(P)}O+=w.apply(null,E)}return O},S=X.bufferToString_slow=function(P){for(var O="",j=P.length,A=0;A<j;A++)O+=w(P[A]);return O};X.stringToArray=function(P){for(var O=[],j=P&&P.length,A=0;A<j;A++)O[A]=P.charCodeAt(A);return O},X.createWindow=function(){for(var P=L.WINDOW_MAX>>7,O="        ";!(P&L.WINDOW_MAX);)O+=O,P<<=1;return O}},4999:(Kt,X,me)=>{X.encode=me(5013).encode,X.decode=me(2813).decode,me(6951),me(2335),me(2032),me(4197)},7865:function(Kt){function X(me){return me&&me.isBuffer&&me}Kt.exports=X(typeof Buffer<"u"&&Buffer)||X(this.Buffer)||X(typeof window<"u"&&window.Buffer)||this.Buffer},5066:(Kt,X)=>{X.copy=function B(T,S,P,O){var j;P||(P=0),!O&&0!==O&&(O=this.length),S||(S=0);var A=O-P;if(T===this&&P<S&&S<O)for(j=A-1;j>=0;j--)T[j+S]=this[j+P];else for(j=0;j<A;j++)T[j+S]=this[j+P];return A},X.toString=function w(T,S,P){var O=this,j=0|S;P||(P=O.length);for(var A="",E=0;j<P;)(E=O[j++])<128?A+=String.fromCharCode(E):(192==(224&E)?E=(31&E)<<6|63&O[j++]:224==(240&E)?E=(15&E)<<12|(63&O[j++])<<6|63&O[j++]:240==(248&E)&&(E=(7&E)<<18|(63&O[j++])<<12|(63&O[j++])<<6|63&O[j++]),E>=65536?(E-=65536,A+=String.fromCharCode(55296+(E>>>10),56320+(1023&E))):A+=String.fromCharCode(E));return A},X.write=function L(T,S){for(var P=this,O=S||(S|=0),j=T.length,A=0,E=0;E<j;)(A=T.charCodeAt(E++))<128?P[O++]=A:A<2048?(P[O++]=192|A>>>6,P[O++]=128|63&A):A<55296||A>57343?(P[O++]=224|A>>>12,P[O++]=128|A>>>6&63,P[O++]=128|63&A):(A=65536+(A-55296<<10|T.charCodeAt(E++)-56320),P[O++]=240|A>>>18,P[O++]=128|A>>>12&63,P[O++]=128|A>>>6&63,P[O++]=128|63&A);return O-S}},5129:(Kt,X,me)=>{var L=me(2029),w=Kt.exports=B(0);function B(S){return new Array(S)}w.alloc=B,w.concat=L.concat,w.from=function T(S){if(!L.isBuffer(S)&&L.isView(S))S=L.Uint8Array.from(S);else if(L.isArrayBuffer(S))S=new Uint8Array(S);else{if("string"==typeof S)return L.from.call(w,S);if("number"==typeof S)throw new TypeError('"value" argument must not be a number')}return Array.prototype.slice.call(S)}},864:(Kt,X,me)=>{var L=me(2029),w=L.global,B=Kt.exports=L.hasBuffer?T(0):[];function T(P){return new w(P)}B.alloc=L.hasBuffer&&w.alloc||T,B.concat=L.concat,B.from=function S(P){if(!L.isBuffer(P)&&L.isView(P))P=L.Uint8Array.from(P);else if(L.isArrayBuffer(P))P=new Uint8Array(P);else{if("string"==typeof P)return L.from.call(B,P);if("number"==typeof P)throw new TypeError('"value" argument must not be a number')}return w.from&&1!==w.from.length?w.from(P):new w(P)}},1002:(Kt,X,me)=>{var L=me(5066);X.copy=P,X.slice=O,X.toString=function j(E,D,k){return(!T&&w.isBuffer(this)?this.toString:L.toString).apply(this,arguments)},X.write=function A(E){return function D(){return(this[E]||L[E]).apply(this,arguments)}}("write");var w=me(2029),B=w.global,T=w.hasBuffer&&"TYPED_ARRAY_SUPPORT"in B,S=T&&!B.TYPED_ARRAY_SUPPORT;function P(E,D,k,z){var N=w.isBuffer(this),Q=w.isBuffer(E);if(N&&Q)return this.copy(E,D,k,z);if(S||N||Q||!w.isView(this)||!w.isView(E))return L.copy.call(this,E,D,k,z);var de=k||null!=z?O.call(this,k,z):this;return E.set(de,D),de.length}function O(E,D){var k=this.slice||!S&&this.subarray;if(k)return k.call(this,E,D);var z=w.alloc.call(this,D-E);return P.call(this,z,0,E,D),z}},8343:(Kt,X,me)=>{var L=me(2029),w=Kt.exports=L.hasArrayBuffer?B(0):[];function B(S){return new Uint8Array(S)}w.alloc=B,w.concat=L.concat,w.from=function T(S){if(L.isView(S)){var P=S.byteOffset,O=S.byteLength;(S=S.buffer).byteLength!==O&&(S.slice?S=S.slice(P,P+O):(S=new Uint8Array(S)).byteLength!==O&&(S=Array.prototype.slice.call(S,P,P+O)))}else{if("string"==typeof S)return L.from.call(w,S);if("number"==typeof S)throw new TypeError('"value" argument must not be a number')}return new Uint8Array(S)}},2029:(Kt,X,me)=>{var L=X.global=me(7865),w=X.hasBuffer=L&&!!L.isBuffer,B=X.hasArrayBuffer=typeof ArrayBuffer<"u",T=X.isArray=me(53);X.isArrayBuffer=B?function Q(te){return te instanceof ArrayBuffer||N(te)}:J;var S=X.isBuffer=w?L.isBuffer:J,P=X.isView=B?ArrayBuffer.isView||ae("ArrayBuffer","buffer"):J;X.alloc=k,X.concat=function z(te,ce){ce||(ce=0,Array.prototype.forEach.call(te,function pe(R){ce+=R.length}));var ue=k.call(this!==X&&this||te[0],ce),Qe=0;return Array.prototype.forEach.call(te,function Se(R){Qe+=E.copy.call(R,ue,Qe)}),ue},X.from=function D(te){return"string"==typeof te?de.call(this,te):we(this).from(te)};var O=X.Array=me(5129),j=X.Buffer=me(864),A=X.Uint8Array=me(8343),E=X.prototype=me(1002);function k(te){return we(this).alloc(te)}var N=ae("ArrayBuffer");function de(te){var ce=3*te.length,_e=k.call(this,ce),ue=E.write.call(_e,te);return ce!==ue&&(_e=E.slice.call(_e,0,ue)),_e}function we(te){return S(te)?j:P(te)?A:T(te)?O:w?j:B?A:O}function J(){return!1}function ae(te,ce){return te="[object "+te+"]",function(_e){return null!=_e&&{}.toString.call(ce?_e[ce]:_e)===te}}},2199:(Kt,X,me)=>{var L=me(53);X.createCodec=j,X.install=function T(A){for(var E in A)B.prototype[E]=S(B.prototype[E],A[E])},X.filter=function O(A){return L(A)?function P(A){return A=A.slice(),function(D){return A.reduce(E,D)};function E(D,k){return k(D)}}(A):A};var w=me(2029);function B(A){if(!(this instanceof B))return new B(A);this.options=A,this.init()}function S(A,E){return A&&E?function D(){return A.apply(this,arguments),E.apply(this,arguments)}:A||E}function j(A){return new B(A)}B.prototype.init=function(){var A=this.options;return A&&A.uint8array&&(this.bufferish=w.Uint8Array),this},X.preset=j({preset:!0})},4197:(Kt,X,me)=>{me(2415),me(6962),me(2199)},9088:(Kt,X,me)=>{X.n=B;var L=me(2415).preset;function B(T){if(!(this instanceof B))return new B(T);if(T&&(this.options=T,T.codec)){var S=this.codec=T.codec;S.bufferish&&(this.bufferish=S.bufferish)}}me(3351).I.mixin(B.prototype),B.prototype.codec=L,B.prototype.fetch=function(){return this.codec.decode(this)}},2813:(Kt,X,me)=>{X.decode=function w(B,T){var S=new L(T);return S.write(B),S.read()};var L=me(9088).n},2335:(Kt,X,me)=>{var w=me(8004),B=me(9088).n;function T(S){if(!(this instanceof T))return new T(S);B.call(this,S)}T.prototype=new B,w.mixin(T.prototype),T.prototype.decode=function(S){arguments.length&&this.write(S),this.flush()},T.prototype.push=function(S){this.emit("data",S)},T.prototype.end=function(S){this.decode(S),this.emit("end")}},8120:(Kt,X,me)=>{X.D=B;var L=me(6962).preset;function B(T){if(!(this instanceof B))return new B(T);if(T&&(this.options=T,T.codec)){var S=this.codec=T.codec;S.bufferish&&(this.bufferish=S.bufferish)}}me(3351).w.mixin(B.prototype),B.prototype.codec=L,B.prototype.write=function(T){this.codec.encode(this,T)}},5013:(Kt,X,me)=>{X.encode=function w(B,T){var S=new L(T);return S.write(B),S.read()};var L=me(8120).D},6951:(Kt,X,me)=>{var w=me(8004),B=me(8120).D;function T(S){if(!(this instanceof T))return new T(S);B.call(this,S)}T.prototype=new B,w.mixin(T.prototype),T.prototype.encode=function(S){this.write(S),this.emit("data",this.read())},T.prototype.end=function(S){arguments.length&&this.encode(S),this.flush(),this.emit("end")}},7603:(Kt,X,me)=>{X.u=function w(B,T){if(!(this instanceof w))return new w(B,T);this.buffer=L.from(B),this.type=T};var L=me(2029)},5167:(Kt,X,me)=>{X.setExtPackers=function P(D){D.addExtPacker(14,Error,[E,O]),D.addExtPacker(1,EvalError,[E,O]),D.addExtPacker(2,RangeError,[E,O]),D.addExtPacker(3,ReferenceError,[E,O]),D.addExtPacker(4,SyntaxError,[E,O]),D.addExtPacker(5,TypeError,[E,O]),D.addExtPacker(6,URIError,[E,O]),D.addExtPacker(10,RegExp,[A,O]),D.addExtPacker(11,Boolean,[j,O]),D.addExtPacker(12,String,[j,O]),D.addExtPacker(13,Date,[Number,O]),D.addExtPacker(15,Number,[j,O]),typeof Uint8Array<"u"&&(D.addExtPacker(17,Int8Array,B),D.addExtPacker(18,Uint8Array,B),D.addExtPacker(19,Int16Array,B),D.addExtPacker(20,Uint16Array,B),D.addExtPacker(21,Int32Array,B),D.addExtPacker(22,Uint32Array,B),D.addExtPacker(23,Float32Array,B),typeof Float64Array<"u"&&D.addExtPacker(24,Float64Array,B),typeof Uint8ClampedArray<"u"&&D.addExtPacker(25,Uint8ClampedArray,B),D.addExtPacker(26,ArrayBuffer,B),D.addExtPacker(29,DataView,B)),L.hasBuffer&&D.addExtPacker(27,w,L.from)};var T,L=me(2029),w=L.global,B=L.Uint8Array.from,S={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function O(D){return T||(T=me(5013).encode),T(D)}function j(D){return D.valueOf()}function A(D){(D=RegExp.prototype.toString.call(D).split("/")).shift();var k=[D.pop()];return k.unshift(D.join("/")),k}function E(D){var k={};for(var z in S)k[z]=D[z];return k}},1800:(Kt,X,me)=>{X.setExtUnpackers=function S(D){D.addExtUnpacker(14,[P,j(Error)]),D.addExtUnpacker(1,[P,j(EvalError)]),D.addExtUnpacker(2,[P,j(RangeError)]),D.addExtUnpacker(3,[P,j(ReferenceError)]),D.addExtUnpacker(4,[P,j(SyntaxError)]),D.addExtUnpacker(5,[P,j(TypeError)]),D.addExtUnpacker(6,[P,j(URIError)]),D.addExtUnpacker(10,[P,O]),D.addExtUnpacker(11,[P,A(Boolean)]),D.addExtUnpacker(12,[P,A(String)]),D.addExtUnpacker(13,[P,A(Date)]),D.addExtUnpacker(15,[P,A(Number)]),typeof Uint8Array<"u"&&(D.addExtUnpacker(17,A(Int8Array)),D.addExtUnpacker(18,A(Uint8Array)),D.addExtUnpacker(19,[E,A(Int16Array)]),D.addExtUnpacker(20,[E,A(Uint16Array)]),D.addExtUnpacker(21,[E,A(Int32Array)]),D.addExtUnpacker(22,[E,A(Uint32Array)]),D.addExtUnpacker(23,[E,A(Float32Array)]),typeof Float64Array<"u"&&D.addExtUnpacker(24,[E,A(Float64Array)]),typeof Uint8ClampedArray<"u"&&D.addExtUnpacker(25,A(Uint8ClampedArray)),D.addExtUnpacker(26,E),D.addExtUnpacker(29,[E,A(DataView)])),L.hasBuffer&&D.addExtUnpacker(27,A(w))};var B,L=me(2029),w=L.global,T={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function P(D){return B||(B=me(2813).decode),B(D)}function O(D){return RegExp.apply(null,D)}function j(D){return function(k){var z=new D;for(var N in T)z[N]=k[N];return z}}function A(D){return function(k){return new D(k)}}function E(D){return new Uint8Array(D).buffer}},2032:(Kt,X,me)=>{me(2415),me(6962),me(2199)},3351:(Kt,X,me)=>{X.I=S,X.w=P;var L=me(2029),T="BUFFER_SHORTAGE";function S(){if(!(this instanceof S))return new S}function P(){if(!(this instanceof P))return new P}function A(){throw new Error("method not implemented: write()")}function E(){throw new Error("method not implemented: fetch()")}function D(){return this.buffers&&this.buffers.length?(this.flush(),this.pull()):this.fetch()}function k(Q){(this.buffers||(this.buffers=[])).push(Q)}function z(){return(this.buffers||(this.buffers=[])).shift()}function N(Q){return function de(we){for(var J in Q)we[J]=Q[J];return we}}S.mixin=N(function O(){return{bufferish:L,write:function Q(J){var ae=this.offset?L.prototype.slice.call(this.buffer,this.offset):this.buffer;this.buffer=ae?J?this.bufferish.concat([ae,J]):ae:J,this.offset=0},fetch:E,flush:function de(){for(;this.offset<this.buffer.length;){var ae,J=this.offset;try{ae=this.fetch()}catch(te){if(te&&te.message!=T)throw te;this.offset=J;break}this.push(ae)}},push:k,pull:z,read:D,reserve:function we(J){var ae=this.offset,te=ae+J;if(te>this.buffer.length)throw new Error(T);return this.offset=te,ae},offset:0}}()),S.mixin(S.prototype),P.mixin=N(function j(){return{bufferish:L,write:A,fetch:function Q(){var te=this.start;if(te<this.offset){var ce=this.start=this.offset;return L.prototype.slice.call(this.buffer,te,ce)}},flush:function de(){for(;this.start<this.offset;){var te=this.fetch();te&&this.push(te)}},push:k,pull:function we(){var te=this.buffers||(this.buffers=[]),ce=te.length>1?this.bufferish.concat(te):te[0];return te.length=0,ce},read:D,reserve:function J(te){var ce=0|te;if(this.buffer){var _e=this.buffer.length,ue=0|this.offset,Qe=ue+ce;if(Qe<_e)return this.offset=Qe,ue;this.flush(),te=Math.max(te,Math.min(2*_e,this.maxBufferSize))}return te=Math.max(te,this.minBufferSize),this.buffer=this.bufferish.alloc(te),this.start=0,this.offset=ce,0},send:function ae(te){var ce=te.length;if(ce>this.minBufferSize)this.flush(),this.push(te);else{var _e=this.reserve(ce);L.prototype.copy.call(te,this.buffer,_e)}},maxBufferSize:65536,minBufferSize:2048,offset:0,start:0}}()),P.mixin(P.prototype)},2415:(Kt,X,me)=>{var L=me(7603).u,w=me(1800),B=me(6539).readUint8,T=me(3247),S=me(2199);function O(){var E=this.options;return this.decode=function P(E){var D=T.getReadToken(E);return function k(z){var N=B(z),Q=D[N];if(!Q)throw new Error("Invalid type: "+(N&&"0x"+N.toString(16)));return Q(z)}}(E),E&&E.preset&&w.setExtUnpackers(this),this}S.install({addExtUnpacker:function j(E,D){(this.extUnpackers||(this.extUnpackers=[]))[E]=S.filter(D)},getExtUnpacker:function A(E){return(this.extUnpackers||(this.extUnpackers=[]))[E]||function k(z){return new L(z,E)}},init:O}),X.preset=O.call(S.preset)},6539:(Kt,X,me)=>{var L=me(2020),w=me(8590),B=w.Uint64BE,T=w.Int64BE;X.getReadFormat=function A(Ve){var ot=Ve&&Ve.int64;return{map:O&&Ve&&Ve.usemap?D:E,array:k,str:z,bin:S.hasArrayBuffer&&Ve&&Ve.binarraybuffer?Q:N,ext:de,uint8:we,uint16:ae,uint32:ce,uint64:ue(8,ot?Se:Qe),int8:J,int16:te,int32:_e,int64:ue(8,ot?R:pe),float32:ue(4,Ye),float64:ue(8,Bt)}},X.readUint8=we;var S=me(2029),P=me(1002),O=typeof Map<"u",j=!0;function E(Ve,Ot){var Tt,ot={},Ze=new Array(Ot),et=new Array(Ot),tn=Ve.codec.decode;for(Tt=0;Tt<Ot;Tt++)Ze[Tt]=tn(Ve),et[Tt]=tn(Ve);for(Tt=0;Tt<Ot;Tt++)ot[Ze[Tt]]=et[Tt];return ot}function D(Ve,Ot){var Tt,ot=new Map,Ze=new Array(Ot),et=new Array(Ot),tn=Ve.codec.decode;for(Tt=0;Tt<Ot;Tt++)Ze[Tt]=tn(Ve),et[Tt]=tn(Ve);for(Tt=0;Tt<Ot;Tt++)ot.set(Ze[Tt],et[Tt]);return ot}function k(Ve,Ot){for(var ot=new Array(Ot),Tt=Ve.codec.decode,Ze=0;Ze<Ot;Ze++)ot[Ze]=Tt(Ve);return ot}function z(Ve,Ot){var ot=Ve.reserve(Ot);return P.toString.call(Ve.buffer,"utf-8",ot,ot+Ot)}function N(Ve,Ot){var ot=Ve.reserve(Ot),Ze=P.slice.call(Ve.buffer,ot,ot+Ot);return S.from(Ze)}function Q(Ve,Ot){var ot=Ve.reserve(Ot),Ze=P.slice.call(Ve.buffer,ot,ot+Ot);return S.Uint8Array.from(Ze).buffer}function de(Ve,Ot){var ot=Ve.reserve(Ot+1),Tt=Ve.buffer[ot++],Ze=ot+Ot,et=Ve.codec.getExtUnpacker(Tt);if(!et)throw new Error("Invalid ext type: "+(Tt&&"0x"+Tt.toString(16)));return et(P.slice.call(Ve.buffer,ot,Ze))}function we(Ve){var Ot=Ve.reserve(1);return Ve.buffer[Ot]}function J(Ve){var Ot=Ve.reserve(1),ot=Ve.buffer[Ot];return 128&ot?ot-256:ot}function ae(Ve){var Ot=Ve.reserve(2),ot=Ve.buffer;return ot[Ot++]<<8|ot[Ot]}function te(Ve){var Ot=Ve.reserve(2),ot=Ve.buffer,Tt=ot[Ot++]<<8|ot[Ot];return 32768&Tt?Tt-65536:Tt}function ce(Ve){var Ot=Ve.reserve(4),ot=Ve.buffer;return 16777216*ot[Ot++]+(ot[Ot++]<<16)+(ot[Ot++]<<8)+ot[Ot]}function _e(Ve){var Ot=Ve.reserve(4),ot=Ve.buffer;return ot[Ot++]<<24|ot[Ot++]<<16|ot[Ot++]<<8|ot[Ot]}function ue(Ve,Ot){return function(ot){var Tt=ot.reserve(Ve);return Ot.call(ot.buffer,Tt,j)}}function Qe(Ve){return new B(this,Ve).toNumber()}function pe(Ve){return new T(this,Ve).toNumber()}function Se(Ve){return new B(this,Ve)}function R(Ve){return new T(this,Ve)}function Ye(Ve){return L.read(this,Ve,!1,23,4)}function Bt(Ve){return L.read(this,Ve,!1,52,8)}},3247:(Kt,X,me)=>{var L=me(6539);function B(j){var A,E=new Array(256);for(A=0;A<=127;A++)E[A]=S(A);for(A=128;A<=143;A++)E[A]=O(A-128,j.map);for(A=144;A<=159;A++)E[A]=O(A-144,j.array);for(A=160;A<=191;A++)E[A]=O(A-160,j.str);for(E[192]=S(null),E[193]=null,E[194]=S(!1),E[195]=S(!0),E[196]=P(j.uint8,j.bin),E[197]=P(j.uint16,j.bin),E[198]=P(j.uint32,j.bin),E[199]=P(j.uint8,j.ext),E[200]=P(j.uint16,j.ext),E[201]=P(j.uint32,j.ext),E[202]=j.float32,E[203]=j.float64,E[204]=j.uint8,E[205]=j.uint16,E[206]=j.uint32,E[207]=j.uint64,E[208]=j.int8,E[209]=j.int16,E[210]=j.int32,E[211]=j.int64,E[212]=O(1,j.ext),E[213]=O(2,j.ext),E[214]=O(4,j.ext),E[215]=O(8,j.ext),E[216]=O(16,j.ext),E[217]=P(j.uint8,j.str),E[218]=P(j.uint16,j.str),E[219]=P(j.uint32,j.str),E[220]=P(j.uint16,j.array),E[221]=P(j.uint32,j.array),E[222]=P(j.uint16,j.map),E[223]=P(j.uint32,j.map),A=224;A<=255;A++)E[A]=S(A-256);return E}function S(j){return function(){return j}}function P(j,A){return function(E){var D=j(E);return A(E,D)}}function O(j,A){return function(E){return A(E,j)}}X.getReadToken=function w(j){var A=L.getReadFormat(j);return j&&j.useraw?function T(j){var A,E=B(j).slice();for(E[217]=E[196],E[218]=E[197],E[219]=E[198],A=160;A<=191;A++)E[A]=O(A-160,j.bin);return E}(A):B(A)}},6962:(Kt,X,me)=>{var L=me(7603).u,w=me(5167),B=me(5217),T=me(2199);function P(){var A=this.options;return this.encode=function S(A){var E=B.getWriteType(A);return function D(k,z){var N=E[typeof z];if(!N)throw new Error('Unsupported type "'+typeof z+'": '+z);N(k,z)}}(A),A&&A.preset&&w.setExtPackers(this),this}T.install({addExtPacker:function O(A,E,D){D=T.filter(D);var k=E.name;function Q(de){return D&&(de=D(de)),new L(de,A)}k&&"Object"!==k?(this.extPackers||(this.extPackers={}))[k]=Q:(this.extEncoderList||(this.extEncoderList=[])).unshift([E,Q])},getExtPacker:function j(A){var E=this.extPackers||(this.extPackers={}),D=A.constructor,k=D&&D.name&&E[D.name];if(k)return k;for(var z=this.extEncoderList||(this.extEncoderList=[]),N=z.length,Q=0;Q<N;Q++){var de=z[Q];if(D===de[0])return de[1]}},init:P}),X.preset=P.call(T.preset)},4912:(Kt,X,me)=>{var L=me(2020),w=me(8590),B=w.Uint64BE,T=w.Int64BE,S=me(7857).h,P=me(2029),O=P.global,A=P.hasBuffer&&"TYPED_ARRAY_SUPPORT"in O&&!O.TYPED_ARRAY_SUPPORT,E=P.hasBuffer&&O.prototype||{};function z(){var ue=S.slice();return ue[196]=Q(196),ue[197]=de(197),ue[198]=we(198),ue[199]=Q(199),ue[200]=de(200),ue[201]=we(201),ue[202]=J(202,4,E.writeFloatBE||ce,!0),ue[203]=J(203,8,E.writeDoubleBE||_e,!0),ue[204]=Q(204),ue[205]=de(205),ue[206]=we(206),ue[207]=J(207,8,ae),ue[208]=Q(208),ue[209]=de(209),ue[210]=we(210),ue[211]=J(211,8,te),ue[217]=Q(217),ue[218]=de(218),ue[219]=we(219),ue[220]=de(220),ue[221]=we(221),ue[222]=de(222),ue[223]=we(223),ue}function Q(ue){return function(Qe,pe){var Se=Qe.reserve(2),R=Qe.buffer;R[Se++]=ue,R[Se]=pe}}function de(ue){return function(Qe,pe){var Se=Qe.reserve(3),R=Qe.buffer;R[Se++]=ue,R[Se++]=pe>>>8,R[Se]=pe}}function we(ue){return function(Qe,pe){var Se=Qe.reserve(5),R=Qe.buffer;R[Se++]=ue,R[Se++]=pe>>>24,R[Se++]=pe>>>16,R[Se++]=pe>>>8,R[Se]=pe}}function J(ue,Qe,pe,Se){return function(R,Ye){var Bt=R.reserve(Qe+1);R.buffer[Bt++]=ue,pe.call(R.buffer,Ye,Bt,Se)}}function ae(ue,Qe){new B(this,Qe,ue)}function te(ue,Qe){new T(this,Qe,ue)}function ce(ue,Qe){L.write(this,ue,Qe,!1,23,4)}function _e(ue,Qe){L.write(this,ue,Qe,!1,52,8)}X.getWriteToken=function D(ue){return ue&&ue.uint8array?function k(){var ue=z();return ue[202]=J(202,4,ce),ue[203]=J(203,8,_e),ue}():A||P.hasBuffer&&ue&&ue.safe?function N(){var ue=S.slice();return ue[196]=J(196,1,O.prototype.writeUInt8),ue[197]=J(197,2,O.prototype.writeUInt16BE),ue[198]=J(198,4,O.prototype.writeUInt32BE),ue[199]=J(199,1,O.prototype.writeUInt8),ue[200]=J(200,2,O.prototype.writeUInt16BE),ue[201]=J(201,4,O.prototype.writeUInt32BE),ue[202]=J(202,4,O.prototype.writeFloatBE),ue[203]=J(203,8,O.prototype.writeDoubleBE),ue[204]=J(204,1,O.prototype.writeUInt8),ue[205]=J(205,2,O.prototype.writeUInt16BE),ue[206]=J(206,4,O.prototype.writeUInt32BE),ue[207]=J(207,8,ae),ue[208]=J(208,1,O.prototype.writeInt8),ue[209]=J(209,2,O.prototype.writeInt16BE),ue[210]=J(210,4,O.prototype.writeInt32BE),ue[211]=J(211,8,te),ue[217]=J(217,1,O.prototype.writeUInt8),ue[218]=J(218,2,O.prototype.writeUInt16BE),ue[219]=J(219,4,O.prototype.writeUInt32BE),ue[220]=J(220,2,O.prototype.writeUInt16BE),ue[221]=J(221,4,O.prototype.writeUInt32BE),ue[222]=J(222,2,O.prototype.writeUInt16BE),ue[223]=J(223,4,O.prototype.writeUInt32BE),ue}():z()}},5217:(Kt,X,me)=>{var L=me(53),w=me(8590),B=w.Uint64BE,T=w.Int64BE,S=me(2029),P=me(1002),O=me(4912),j=me(7857).h,A=me(7603).u,E=typeof Uint8Array<"u",D=typeof Map<"u",k=[];k[1]=212,k[2]=213,k[4]=214,k[8]=215,k[16]=216,X.getWriteType=function z(N){var Q=O.getWriteToken(N),de=N&&N.useraw,we=E&&N&&N.binarraybuffer,J=we?S.isArrayBuffer:S.isBuffer,ae=we?function et($t,At){Ze($t,new Uint8Array(At))}:Ze,ce=D&&N&&N.usemap?function qt($t,At){if(!(At instanceof Map))return Rt($t,At);var Lt=At.size;Q[Lt<16?128+Lt:Lt<=65535?222:223]($t,Lt);var fn=$t.codec.encode;At.forEach(function(oi,Dn,F){fn($t,Dn),fn($t,oi)})}:Rt;return{boolean:function ue($t,At){Q[At?195:194]($t,At)},function:ot,number:function Qe($t,At){var Lt=0|At;At===Lt?Q[-32<=Lt&&Lt<=127?255&Lt:0<=Lt?Lt<=255?204:Lt<=65535?205:206:-128<=Lt?208:-32768<=Lt?209:210]($t,Lt):Q[203]($t,At)},object:de?function Ot($t,At){if(J(At))return function mi($t,At){var Lt=At.length;Q[Lt<32?160+Lt:Lt<=65535?218:219]($t,Lt),$t.send(At)}($t,At);Ve($t,At)}:Ve,string:function Bt($t){return function At(Lt,Cn){var fn=Cn.length;Lt.offset=Lt.reserve(5+3*fn);var Dn=Lt.buffer,F=$t(fn),Ae=Lt.offset+F;fn=P.write.call(Dn,Cn,Ae);var Re=$t(fn);F!==Re&&P.copy.call(Dn,Dn,Ae+Re-F,Ae,Ae+fn),Q[1===Re?160+fn:Re<=3?215+Re:219](Lt,fn),Lt.offset+=fn}}(de?function Ye($t){return $t<32?1:$t<=65535?3:5}:function R($t){return $t<32?1:$t<=255?2:$t<=65535?3:5}),symbol:ot,undefined:ot};function Ve($t,At){if(null===At)return ot($t,At);if(J(At))return ae($t,At);if(L(At))return function Tt($t,At){var Lt=At.length;Q[Lt<16?144+Lt:Lt<=65535?220:221]($t,Lt);for(var fn=$t.codec.encode,oi=0;oi<Lt;oi++)fn($t,At[oi])}($t,At);if(B.isUint64BE(At))return function pe($t,At){Q[207]($t,At.toArray())}($t,At);if(T.isInt64BE(At))return function Se($t,At){Q[211]($t,At.toArray())}($t,At);var Lt=$t.codec.getExtPacker(At);if(Lt&&(At=Lt(At)),At instanceof A)return function tn($t,At){var Lt=At.buffer,Cn=Lt.length;Q[k[Cn]||(Cn<255?199:Cn<=65535?200:201)]($t,Cn),j[At.type]($t),$t.send(Lt)}($t,At);ce($t,At)}function ot($t,At){Q[192]($t,At)}function Ze($t,At){var Lt=At.length;Q[Lt<255?196:Lt<=65535?197:198]($t,Lt),$t.send(At)}function Rt($t,At){var Lt=Object.keys(At),Cn=Lt.length;Q[Cn<16?128+Cn:Cn<=65535?222:223]($t,Cn);var oi=$t.codec.encode;Lt.forEach(function(Dn){oi($t,Dn),oi($t,At[Dn])})}}},7857:(Kt,X)=>{for(var me=X.h=new Array(256),L=0;L<=255;L++)me[L]=w(L);function w(B){return function(T){var S=T.reserve(1);T.buffer[S]=B}}},9822:Kt=>{function X(B){var T="    ";if(isNaN(parseInt(B)))T=B;else switch(B){case 1:T=" ";break;case 2:T="  ";break;case 3:T="   ";break;case 4:T="    ";break;case 5:T="     ";break;case 6:T="      ";break;case 7:T="       ";break;case 8:T="        ";break;case 9:T="         ";break;case 10:T="          ";break;case 11:T="           ";break;case 12:T="            "}for(var S=["\n"],P=0;P<100;P++)S.push(S[P]+T);return S}function me(){this.step="    ",this.shift=X(this.step)}function L(B,T){return T-(B.replace(/\(/g,"").length-B.replace(/\)/g,"").length)}function w(B,T){return B.replace(/\s{1,}/g," ").replace(/ AND /gi,"~::~"+T+T+"AND ").replace(/ BETWEEN /gi,"~::~"+T+"BETWEEN ").replace(/ CASE /gi,"~::~"+T+"CASE ").replace(/ ELSE /gi,"~::~"+T+"ELSE ").replace(/ END /gi,"~::~"+T+"END ").replace(/ FROM /gi,"~::~FROM ").replace(/ GROUP\s{1,}BY/gi,"~::~GROUP BY ").replace(/ HAVING /gi,"~::~HAVING ").replace(/ IN /gi," IN ").replace(/ JOIN /gi,"~::~JOIN ").replace(/ CROSS~::~{1,}JOIN /gi,"~::~CROSS JOIN ").replace(/ INNER~::~{1,}JOIN /gi,"~::~INNER JOIN ").replace(/ LEFT~::~{1,}JOIN /gi,"~::~LEFT JOIN ").replace(/ RIGHT~::~{1,}JOIN /gi,"~::~RIGHT JOIN ").replace(/ ON /gi,"~::~"+T+"ON ").replace(/ OR /gi,"~::~"+T+T+"OR ").replace(/ ORDER\s{1,}BY/gi,"~::~ORDER BY ").replace(/ OVER /gi,"~::~"+T+"OVER ").replace(/\(\s{0,}SELECT /gi,"~::~(SELECT ").replace(/\)\s{0,}SELECT /gi,")~::~SELECT ").replace(/ THEN /gi," THEN~::~"+T).replace(/ UNION /gi,"~::~UNION~::~").replace(/ USING /gi,"~::~USING ").replace(/ WHEN /gi,"~::~"+T+"WHEN ").replace(/ WHERE /gi,"~::~WHERE ").replace(/ WITH /gi,"~::~WITH ").replace(/ ALL /gi," ALL ").replace(/ AS /gi," AS ").replace(/ ASC /gi," ASC ").replace(/ DESC /gi," DESC ").replace(/ DISTINCT /gi," DISTINCT ").replace(/ EXISTS /gi," EXISTS ").replace(/ NOT /gi," NOT ").replace(/ NULL /gi," NULL ").replace(/ LIKE /gi," LIKE ").replace(/\s{0,}SELECT /gi,"SELECT ").replace(/\s{0,}UPDATE /gi,"UPDATE ").replace(/ SET /gi," SET ").replace(/~::~{1,}/g,"~::~").split("~::~")}me.prototype.xml=function(B,T){var S=B.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").replace(/\s*xmlns\=/g,"~::~xmlns=").split("~::~"),P=S.length,O=!1,j=0,A="",E=0,D=T?X(T):this.shift;for(E=0;E<P;E++)S[E].search(/<!/)>-1?(A+=D[j]+S[E],O=!0,(S[E].search(/-->/)>-1||S[E].search(/\]>/)>-1||S[E].search(/!DOCTYPE/)>-1)&&(O=!1)):S[E].search(/-->/)>-1||S[E].search(/\]>/)>-1?(A+=S[E],O=!1):/^<\w/.exec(S[E-1])&&/^<\/\w/.exec(S[E])&&/^<[\w:\-\.\,]+/.exec(S[E-1])==/^<\/[\w:\-\.\,]+/.exec(S[E])[0].replace("/","")?(A+=S[E],O||j--):S[E].search(/<\w/)>-1&&-1==S[E].search(/<\//)&&-1==S[E].search(/\/>/)?A=A+=O?S[E]:D[j++]+S[E]:S[E].search(/<\w/)>-1&&S[E].search(/<\//)>-1?A=A+=O?S[E]:D[j]+S[E]:S[E].search(/<\//)>-1?A=A+=O?S[E]:D[--j]+S[E]:S[E].search(/\/>/)>-1?A=A+=O?S[E]:D[j]+S[E]:S[E].search(/<\?/)>-1||S[E].search(/xmlns\:/)>-1||S[E].search(/xmlns\=/)>-1?A+=D[j]+S[E]:A+=S[E];return"\n"==A[0]?A.slice(1):A},me.prototype.json=function(B,S){return S=S||this.step,typeof JSON>"u"?B:"string"==typeof B?JSON.stringify(JSON.parse(B),null,S):"object"==typeof B?JSON.stringify(B,null,S):B},me.prototype.css=function(B,T){var S=B.replace(/\s{1,}/g," ").replace(/\{/g,"{~::~").replace(/\}/g,"~::~}~::~").replace(/\;/g,";~::~").replace(/\/\*/g,"~::~/*").replace(/\*\//g,"*/~::~").replace(/~::~\s{0,}~::~/g,"~::~").split("~::~"),P=S.length,O=0,j="",A=0,E=T?X(T):this.shift;for(A=0;A<P;A++)/\{/.exec(S[A])?j+=E[O++]+S[A]:/\}/.exec(S[A])?j+=E[--O]+S[A]:(/\*\\/.exec(S[A]),j+=E[O]+S[A]);return j.replace(/^\n{1,}/,"")},me.prototype.sql=function(B,T){var S=B.replace(/\s{1,}/g," ").replace(/\'/gi,"~::~'").split("~::~"),P=S.length,O=[],j=0,A=this.step,k=0,z="",N=0,Q=T?X(T):this.shift;for(N=0;N<P;N++)O=O.concat(N%2?S[N]:w(S[N],A));for(P=O.length,N=0;N<P;N++)k=L(O[N],k),/\s{0,}\s{0,}SELECT\s{0,}/.exec(O[N])&&(O[N]=O[N].replace(/\,/g,",\n"+A+A)),/\s{0,}\s{0,}SET\s{0,}/.exec(O[N])&&(O[N]=O[N].replace(/\,/g,",\n"+A+A)),/\s{0,}\(\s{0,}SELECT\s{0,}/.exec(O[N])?z+=Q[++j]+O[N]:/\'/.exec(O[N])?(k<1&&j&&j--,z+=O[N]):(z+=Q[j]+O[N],k<1&&j&&j--);return z.replace(/^\n{1,}/,"").replace(/\n{1,}/g,"\n")},me.prototype.xmlmin=function(B,T){return(T?B:B.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"").replace(/[ \r\n\t]{1,}xmlns/g," xmlns")).replace(/>\s{0,}</g,"><")},me.prototype.jsonmin=function(B){return typeof JSON>"u"?B:JSON.stringify(JSON.parse(B),null,0)},me.prototype.cssmin=function(B,T){return(T?B:B.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\//g,"")).replace(/\s{1,}/g," ").replace(/\{\s{1,}/g,"{").replace(/\}\s{1,}/g,"}").replace(/\;\s{1,}/g,";").replace(/\/\*\s{1,}/g,"/*").replace(/\*\/\s{1,}/g,"*/")},me.prototype.sqlmin=function(B){return B.replace(/\s{1,}/g," ").replace(/\s{1,}\(/,"(").replace(/\s{1,}\)/,")")},Kt.exports=new me},477:()=>{},467:(Kt,X,me)=>{"use strict";function L(B,T,S,P,O,j,A){try{var E=B[j](A),D=E.value}catch(k){return void S(k)}E.done?T(D):Promise.resolve(D).then(P,O)}function w(B){return function(){var T=this,S=arguments;return new Promise(function(P,O){var j=B.apply(T,S);function A(D){L(j,P,O,A,E,"next",D)}function E(D){L(j,P,O,A,E,"throw",D)}A(void 0)})}}me.d(X,{A:()=>w})},4469:Kt=>{"use strict";Kt.exports={}}},Kt=>{Kt(Kt.s=1773)}]);