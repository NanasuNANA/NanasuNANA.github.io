(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"+qE3":function(e,t,n){"use strict";var i,r="object"==typeof Reflect?Reflect:null,s=r&&"function"==typeof r.apply?r.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};i=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise(function(n,i){function r(n){e.removeListener(t,s),i(n)}function s(){"function"==typeof e.removeListener&&e.removeListener("error",r),n([].slice.call(arguments))}b(e,t,s,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&b(e,"error",t,{once:!0})}(e,r)})},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var l=10;function c(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function h(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function u(e,t,n,i){var r,s,o;if(c(n),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),o=s[t]),void 0===o)o=s[t]=n,++e._eventsCount;else if("function"==typeof o?o=s[t]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),(r=h(e))>0&&o.length>r&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=o.length,console&&console.warn&&console.warn(a)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=d.bind(i);return r.listener=n,i.wrapFn=r,r}function f(e,t,n){var i=e._events;if(void 0===i)return[];var r=i[t];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):m(r,r.length)}function g(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function m(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function b(e,t,n,i){if("function"==typeof e.on)i.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function r(s){i.once&&e.removeEventListener(t,r),n(s)})}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return h(this)},a.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,r=this._events;if(void 0!==r)i=i&&void 0===r.error;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var l=r[e];if(void 0===l)return!1;if("function"==typeof l)s(l,this,t);else{var c=l.length,h=m(l,c);for(n=0;n<c;++n)s(h[n],this,t)}return!0},a.prototype.on=a.prototype.addListener=function(e,t){return u(this,e,t,!1)},a.prototype.prependListener=function(e,t){return u(this,e,t,!0)},a.prototype.once=function(e,t){return c(t),this.on(e,p(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return c(t),this.prependListener(e,p(this,e,t)),this},a.prototype.off=a.prototype.removeListener=function(e,t){var n,i,r,s,o;if(c(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){o=n[s].listener,r=s;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,o||t)}return this},a.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,s=Object.keys(n);for(i=0;i<s.length;++i)"removeListener"!==(r=s[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},a.prototype.listeners=function(e){return f(this,e,!0)},a.prototype.rawListeners=function(e){return f(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):g.call(e,t)},a.prototype.listenerCount=g,a.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}},0:function(e,t,n){e.exports=n("zUnb")},"19AM":function(e,t,n){t.ExtBuffer=function e(t,n){if(!(this instanceof e))return new e(t,n);this.buffer=i.from(t),this.type=n};var i=n("5ukv")},"1mG5":function(e,t,n){var i=n("19AM").ExtBuffer,r=n("FEcD"),s=n("NDgz").readUint8,o=n("sZbO"),a=n("eHTg");function l(){var e=this.options;return this.decode=function(e){var t=o.getReadToken(e);return function(e){var n=s(e),i=t[n];if(!i)throw new Error("Invalid type: "+(n?"0x"+n.toString(16):n));return i(e)}}(e),e&&e.preset&&r.setExtUnpackers(this),this}a.install({addExtUnpacker:function(e,t){(this.extUnpackers||(this.extUnpackers=[]))[e]=a.filter(t)},getExtUnpacker:function(e){return(this.extUnpackers||(this.extUnpackers=[]))[e]||function(t){return new i(t,e)}},init:l}),t.preset=l.call(a.preset)},"26FE":function(e,t,n){t.encode=function(e,t){var n=new i(t);return n.write(e),n.read()};var i=n("Lcv9").EncodeBuffer},"2f56":function(e,t,n){var i=n("iSaS"),r=String.fromCharCode;t.createBuffer=function(e,t){if(!i.HAS_TYPED)return new Array(t);switch(e){case 8:return new Uint8Array(t);case 16:return new Uint16Array(t)}};var s=t.truncateBuffer=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};t.bufferToString_fast=function(e,t){if(null==t?t=e.length:e=s(e,t),i.CAN_CHARCODE_APPLY&&i.CAN_CHARCODE_APPLY_TYPED){var n=e.length;if(n<i.APPLY_BUFFER_SIZE&&i.APPLY_BUFFER_SIZE_OK)return r.apply(null,e);if(null===i.APPLY_BUFFER_SIZE_OK)try{var a=r.apply(null,e);return n>i.APPLY_BUFFER_SIZE&&(i.APPLY_BUFFER_SIZE_OK=!0),a}catch(l){i.APPLY_BUFFER_SIZE_OK=!1}}return o(e)};var o=t.bufferToString_chunked=function(e){for(var t,n="",s=e.length,o=0;o<s;){if(t=e.subarray?e.subarray(o,o+i.APPLY_BUFFER_SIZE):e.slice(o,o+i.APPLY_BUFFER_SIZE),o+=i.APPLY_BUFFER_SIZE,!i.APPLY_BUFFER_SIZE_OK){if(null===i.APPLY_BUFFER_SIZE_OK)try{n+=r.apply(null,t),t.length>i.APPLY_BUFFER_SIZE&&(i.APPLY_BUFFER_SIZE_OK=!0);continue}catch(l){i.APPLY_BUFFER_SIZE_OK=!1}return a(e)}n+=r.apply(null,t)}return n},a=t.bufferToString_slow=function(e){for(var t="",n=e.length,i=0;i<n;i++)t+=r(e[i]);return t};t.stringToArray=function(e){for(var t=[],n=e&&e.length,i=0;i<n;i++)t[i]=e.charCodeAt(i);return t},t.createWindow=function(){for(var e=i.WINDOW_MAX>>7,t="        ";!(e&i.WINDOW_MAX);)t+=t,e<<=1;return t}},"49sm":function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},"5ukv":function(e,t,n){var i=t.global=n("zTos"),r=t.hasBuffer=i&&!!i.isBuffer,s=t.hasArrayBuffer="undefined"!=typeof ArrayBuffer,o=t.isArray=n("49sm");t.isArrayBuffer=s?function(e){return e instanceof ArrayBuffer||f(e)}:b;var a=t.isBuffer=r?i.isBuffer:b,l=t.isView=s?ArrayBuffer.isView||y("ArrayBuffer","buffer"):b;t.alloc=p,t.concat=function(e,n){n||(n=0,Array.prototype.forEach.call(e,function(e){n+=e.length}));var i=p.call(this!==t&&this||e[0],n),r=0;return Array.prototype.forEach.call(e,function(e){r+=d.copy.call(e,i,r)}),i},t.from=function(e){return"string"==typeof e?g.call(this,e):m(this).from(e)};var c=t.Array=n("t2S5"),h=t.Buffer=n("T4b0"),u=t.Uint8Array=n("BTrk"),d=t.prototype=n("W3Yc");function p(e){return m(this).alloc(e)}var f=y("ArrayBuffer");function g(e){var t=3*e.length,n=p.call(this,t),i=d.write.call(n,e);return t!==i&&(n=d.slice.call(n,0,i)),n}function m(e){return a(e)?h:l(e)?u:o(e)?c:r?h:s?u:c}function b(){return!1}function y(e,t){return e="[object "+e+"]",function(n){return null!=n&&{}.toString.call(t?n[t]:n)===e}}},"7ice":function(e){e.exports=JSON.parse('{"_from":"lzbase62@^2.0.0","_id":"lzbase62@2.0.0","_inBundle":false,"_integrity":"sha512-hq7ZI8T42YVgSxCFHzg/Gt3GUKGZdQXKejvubdLjzxjiF5Tn9xKoWvZLZSY1u0+Orct+bxQMmb8XIcbXzR+2tg==","_location":"/lzbase62","_phantomChildren":{},"_requested":{"type":"range","registry":true,"raw":"lzbase62@^2.0.0","name":"lzbase62","escapedName":"lzbase62","rawSpec":"^2.0.0","saveSpec":null,"fetchSpec":"^2.0.0"},"_requiredBy":["/"],"_resolved":"https://registry.npmjs.org/lzbase62/-/lzbase62-2.0.0.tgz","_shasum":"84f2003c4dbe1505c2679d96d72e9c4365e45980","_spec":"lzbase62@^2.0.0","_where":"C:\\\\Users\\\\keyra\\\\OneDrive\\\\Documents\\\\Prog\\\\UdonariumWithFly","author":{"name":"polygon planet","email":"polygon.planet.aqua@gmail.com"},"browserify":{"transform":["package-json-versionify"]},"bugs":{"url":"https://github.com/polygonplanet/lzbase62/issues"},"bundleDependencies":false,"deprecated":false,"description":"LZ77(LZSS) based compression algorithm in base62 for JavaScript","devDependencies":{"bannerify":"^1.0.1","browserify":"^16.5.0","es6-shim":"^0.35.5","eslint":"^6.8.0","karma":"^4.4.1","karma-browserify":"^6.1.0","karma-chrome-launcher":"^3.1.0","karma-detect-browsers":"^2.3.3","karma-es6-shim":"^1.0.0","karma-firefox-launcher":"^1.3.0","karma-ie-launcher":"^1.0.0","karma-mocha":"^1.3.0","karma-mocha-reporter":"^2.2.5","karma-safari-launcher":"^1.0.0","mocha":"^7.0.0","package-json-versionify":"^1.0.4","power-assert":"^1.6.1","uglify-js":"^3.7.5","uglifyify":"^5.0.2","watchify":"^3.11.1"},"engines":{"node":">=8.10.0"},"files":["dist/*","src/*"],"homepage":"https://github.com/polygonplanet/lzbase62","keywords":["compression","decompression","algorithm","compress","decompress","extract","zip","lz77","lzss","lzw","base64","base62","zip","gzip","zlib","inflate","deflate","string"],"license":"MIT","main":"src/index.js","name":"lzbase62","repository":{"type":"git","url":"git+ssh://git@github.com/polygonplanet/lzbase62.git"},"scripts":{"build":"npm run compile && npm run minify","compile":"browserify src/index.js -o dist/lzbase62.js -s lzbase62 -p [ bannerify --file src/banner.js ] --no-bundle-external --bare","minify":"uglifyjs dist/lzbase62.js -o dist/lzbase62.min.js --comments -c -m -b ascii_only=true,beautify=false","test":"eslint src && npm run build && mocha test/**/*.spec.js --timeout 10000 && karma start karma.conf.js","travis":"npm run build && mocha test/**/*.spec.js --timeout 10000 && karma start karma.conf.js --single-run","watch":"watchify src/index.js -o dist/lzbase62.js -s lzbase62 -p [ bannerify --file src/banner.js ] --no-bundle-external --bare --poll=200 -v"},"version":"2.0.0"}')},BTrk:function(e,t,n){var i=n("5ukv");function r(e){return new Uint8Array(e)}(t=e.exports=i.hasArrayBuffer?r(0):[]).alloc=r,t.concat=i.concat,t.from=function(e){if(i.isView(e)){var n=e.byteOffset,r=e.byteLength;(e=e.buffer).byteLength!==r&&(e.slice?e=e.slice(n,n+r):(e=new Uint8Array(e)).byteLength!==r&&(e=Array.prototype.slice.call(e,n,n+r)))}else{if("string"==typeof e)return i.from.call(t,e);if("number"==typeof e)throw new TypeError('"value" argument must not be a number')}return new Uint8Array(e)}},"BoP+":function(e,t){t.copy=function(e,t,n,i){var r;n||(n=0),i||0===i||(i=this.length),t||(t=0);var s=i-n;if(e===this&&n<t&&t<i)for(r=s-1;r>=0;r--)e[r+t]=this[r+n];else for(r=0;r<s;r++)e[r+t]=this[r+n];return s},t.toString=function(e,t,n){var i=0|t;n||(n=this.length);for(var r="",s=0;i<n;)(s=this[i++])<128?r+=String.fromCharCode(s):(192==(224&s)?s=(31&s)<<6|63&this[i++]:224==(240&s)?s=(15&s)<<12|(63&this[i++])<<6|63&this[i++]:240==(248&s)&&(s=(7&s)<<18|(63&this[i++])<<12|(63&this[i++])<<6|63&this[i++]),s>=65536?(s-=65536,r+=String.fromCharCode(55296+(s>>>10),56320+(1023&s))):r+=String.fromCharCode(s));return r},t.write=function(e,t){for(var n=t||(t|=0),i=e.length,r=0,s=0;s<i;)(r=e.charCodeAt(s++))<128?this[n++]=r:r<2048?(this[n++]=192|r>>>6,this[n++]=128|63&r):r<55296||r>57343?(this[n++]=224|r>>>12,this[n++]=128|r>>>6&63,this[n++]=128|63&r):(r=65536+(r-55296<<10|e.charCodeAt(s++)-56320),this[n++]=240|r>>>18,this[n++]=128|r>>>12&63,this[n++]=128|r>>>6&63,this[n++]=128|63&r);return n-t}},"F+F2":function(e,t,n){var i;e.exports=(i=n("Ib8C"),function(){if("function"==typeof ArrayBuffer){var e=i.lib.WordArray,t=e.init;(e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var n=e.byteLength,i=[],r=0;r<n;r++)i[r>>>2]|=e[r]<<24-r%4*8;t.call(this,i,n)}else t.apply(this,arguments)}).prototype=e}}(),i.lib.WordArray)},FEcD:function(e,t,n){t.setExtUnpackers=function(e){e.addExtUnpacker(14,[a,c(Error)]),e.addExtUnpacker(1,[a,c(EvalError)]),e.addExtUnpacker(2,[a,c(RangeError)]),e.addExtUnpacker(3,[a,c(ReferenceError)]),e.addExtUnpacker(4,[a,c(SyntaxError)]),e.addExtUnpacker(5,[a,c(TypeError)]),e.addExtUnpacker(6,[a,c(URIError)]),e.addExtUnpacker(10,[a,l]),e.addExtUnpacker(11,[a,h(Boolean)]),e.addExtUnpacker(12,[a,h(String)]),e.addExtUnpacker(13,[a,h(Date)]),e.addExtUnpacker(15,[a,h(Number)]),"undefined"!=typeof Uint8Array&&(e.addExtUnpacker(17,h(Int8Array)),e.addExtUnpacker(18,h(Uint8Array)),e.addExtUnpacker(19,[u,h(Int16Array)]),e.addExtUnpacker(20,[u,h(Uint16Array)]),e.addExtUnpacker(21,[u,h(Int32Array)]),e.addExtUnpacker(22,[u,h(Uint32Array)]),e.addExtUnpacker(23,[u,h(Float32Array)]),"undefined"!=typeof Float64Array&&e.addExtUnpacker(24,[u,h(Float64Array)]),"undefined"!=typeof Uint8ClampedArray&&e.addExtUnpacker(25,h(Uint8ClampedArray)),e.addExtUnpacker(26,u),e.addExtUnpacker(29,[u,h(DataView)])),r.hasBuffer&&e.addExtUnpacker(27,h(s))};var i,r=n("5ukv"),s=r.global,o={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function a(e){return i||(i=n("htI/").decode),i(e)}function l(e){return RegExp.apply(null,e)}function c(e){return function(t){var n=new e;for(var i in o)n[i]=t[i];return n}}function h(e){return function(t){return new e(t)}}function u(e){return new Uint8Array(e).buffer}},HlZf:function(e,t,n){t.encode=n("26FE").encode,t.decode=n("htI/").decode,t.Encoder=n("nZiH").Encoder,t.Decoder=n("NMIm").Decoder,t.createCodec=n("RiOb").createCodec,t.codec=n("nZuW").codec},IKIk:function(e,t,n){!function(e){var t,n="undefined"!=typeof Buffer&&Buffer,i="undefined"!=typeof Uint8Array&&Uint8Array,r="undefined"!=typeof ArrayBuffer&&ArrayBuffer,s=[0,0,0,0,0,0,0,0],o=Array.isArray||function(e){return!!e&&"[object Array]"==Object.prototype.toString.call(e)},a=4294967296;function l(o,l,v){var _=l?0:4,w=l?4:0,C=l?0:3,x=l?1:2,E=l?2:1,k=l?3:0,S=l?g:b,T=l?m:y,O=A.prototype,I="is"+o,M="_"+I;return O.buffer=void 0,O.offset=0,O[M]=!0,O.toNumber=P,O.toString=function(e){var t=this.buffer,n=this.offset,i=R(t,n+_),r=R(t,n+w),s="",o=!v&&2147483648&i;for(o&&(i=~i,r=a-r),e=e||10;;){var l=i%e*a+r;if(i=Math.floor(i/e),r=Math.floor(l/e),s=(l%e).toString(e)+s,!i&&!r)break}return o&&(s="-"+s),s},O.toJSON=P,O.toArray=c,n&&(O.toBuffer=h),i&&(O.toArrayBuffer=u),A[I]=function(e){return!(!e||!e[M])},e[o]=A,A;function A(e,n,o,l){return this instanceof A?function(e,n,o,l,c){i&&r&&(n instanceof r&&(n=new i(n)),l instanceof r&&(l=new i(l))),n||o||l||t?(d(n,o)||(c=o,l=n,o=0,n=new(t||Array)(8)),e.buffer=n,e.offset=o|=0,void 0!==l&&("string"==typeof l?function(e,t,n,i){var r=0,s=n.length,o=0,l=0;"-"===n[0]&&r++;for(var c=r;r<s;){var h=parseInt(n[r++],i);if(!(h>=0))break;l=l*i+h,o=o*i+Math.floor(l/a),l%=a}c&&(o=~o,l?l=a-l:o++),D(e,t+_,o),D(e,t+w,l)}(n,o,l,c||10):d(l,c)?p(n,o,l,c):"number"==typeof c?(D(n,o+_,l),D(n,o+w,c)):l>0?S(n,o,l):l<0?T(n,o,l):p(n,o,s,0))):e.buffer=f(s,0)}(this,e,n,o,l):new A(e,n,o,l)}function P(){var e=this.buffer,t=this.offset,n=R(e,t+_),i=R(e,t+w);return v||(n|=0),n?n*a+i:i}function D(e,t,n){e[t+k]=255&n,e[t+E]=255&(n>>=8),e[t+x]=255&(n>>=8),e[t+C]=255&(n>>=8)}function R(e,t){return 16777216*e[t+C]+(e[t+x]<<16)+(e[t+E]<<8)+e[t+k]}}function c(e){var n=this.buffer,i=this.offset;return t=null,!1!==e&&0===i&&8===n.length&&o(n)?n:f(n,i)}function h(e){var i=this.buffer,r=this.offset;if(t=n,!1!==e&&0===r&&8===i.length&&Buffer.isBuffer(i))return i;var s=new n(8);return p(s,0,i,r),s}function u(e){var n=this.buffer,s=this.offset,o=n.buffer;if(t=i,!1!==e&&0===s&&o instanceof r&&8===o.byteLength)return o;var a=new i(8);return p(a,0,n,s),a.buffer}function d(e,t){var n=e&&e.length;return t|=0,n&&t+8<=n&&"string"!=typeof e[t]}function p(e,t,n,i){t|=0,i|=0;for(var r=0;r<8;r++)e[t++]=255&n[i++]}function f(e,t){return Array.prototype.slice.call(e,t,t+8)}function g(e,t,n){for(var i=t+8;i>t;)e[--i]=255&n,n/=256}function m(e,t,n){var i=t+8;for(n++;i>t;)e[--i]=255&-n^255,n/=256}function b(e,t,n){for(var i=t+8;t<i;)e[t++]=255&n,n/=256}function y(e,t,n){var i=t+8;for(n++;t<i;)e[t++]=255&-n^255,n/=256}l("Uint64BE",!0,!0),l("Int64BE",!0,!1),l("Uint64LE",!1,!0),l("Int64LE",!1,!1)}("string"!=typeof t.nodeName?t:this||{})},Iab2:function(e,t,n){var i,r;void 0===(r="function"==typeof(i=function(){"use strict";function t(e,t,n){var i=new XMLHttpRequest;i.open("GET",e),i.responseType="blob",i.onload=function(){o(i.response,t,n)},i.onerror=function(){console.error("could not download file")},i.send()}function n(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function i(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(t){var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(n)}}var r="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,s=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),o=r.saveAs||("object"!=typeof window||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(e,s,o){var a=r.URL||r.webkitURL,l=document.createElement("a");l.download=s=s||e.name||"download",l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?i(l):n(l.href)?t(e,s,o):i(l,l.target="_blank")):(l.href=a.createObjectURL(e),setTimeout(function(){a.revokeObjectURL(l.href)},4e4),setTimeout(function(){i(l)},0))}:"msSaveOrOpenBlob"in navigator?function(e,r,s){if(r=r||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,s),r);else if(n(e))t(e,r,s);else{var o=document.createElement("a");o.href=e,o.target="_blank",setTimeout(function(){i(o)})}}:function(e,n,i,o){if((o=o||open("","_blank"))&&(o.document.title=o.document.body.innerText="downloading..."),"string"==typeof e)return t(e,n,i);var a="application/octet-stream"===e.type,l=/constructor/i.test(r.HTMLElement)||r.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||a&&l||s)&&"undefined"!=typeof FileReader){var h=new FileReader;h.onloadend=function(){var e=h.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=e:location=e,o=null},h.readAsDataURL(e)}else{var u=r.URL||r.webkitURL,d=u.createObjectURL(e);o?o.location=d:location.href=d,o=null,setTimeout(function(){u.revokeObjectURL(d)},4e4)}});r.saveAs=o.saveAs=o,e.exports=o})?i.apply(t,[]):i)||(e.exports=r)},Ib8C:function(e,t,n){var i;e.exports=i=i||function(e,t){var n=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),i={},r=i.lib={},s=r.Base={extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},o=r.WordArray=s.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var t=this.words,n=e.words,i=this.sigBytes,r=e.sigBytes;if(this.clamp(),i%4)for(var s=0;s<r;s++)t[i+s>>>2]|=(n[s>>>2]>>>24-s%4*8&255)<<24-(i+s)%4*8;else for(s=0;s<r;s+=4)t[i+s>>>2]=n[s>>>2];return this.sigBytes+=r,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=s.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n,i=[],r=function(t){t=t;var n=987654321,i=4294967295;return function(){var r=((n=36969*(65535&n)+(n>>16)&i)<<16)+(t=18e3*(65535&t)+(t>>16)&i)&i;return r/=4294967296,(r+=.5)*(e.random()>.5?1:-1)}},s=0;s<t;s+=4){var a=r(4294967296*(n||e.random()));n=987654071*a(),i.push(4294967296*a()|0)}return new o.init(i,t)}}),a=i.enc={},l=a.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r++){var s=t[r>>>2]>>>24-r%4*8&255;i.push((s>>>4).toString(16)),i.push((15&s).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i+=2)n[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new o.init(n,t/2)}},c=a.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r++)i.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i++)n[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new o.init(n,t)}},h=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},u=r.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=h.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,i=n.words,r=n.sigBytes,s=this.blockSize,a=r/(4*s),l=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*s,c=e.min(4*l,r);if(l){for(var h=0;h<l;h+=s)this._doProcessBlock(i,h);var u=i.splice(0,l);n.sigBytes-=c}return new o.init(u,c)},clone:function(){var e=s.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),d=(r.Hasher=u.extend({cfg:s.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new d.HMAC.init(e,n).finalize(t)}}}),i.algo={});return i}(Math)},Lcv9:function(e,t,n){t.EncodeBuffer=r;var i=n("l5sx").preset;function r(e){if(!(this instanceof r))return new r(e);if(e&&(this.options=e,e.codec)){var t=this.codec=e.codec;t.bufferish&&(this.bufferish=t.bufferish)}}n("jZ1Y").FlexEncoder.mixin(r.prototype),r.prototype.codec=i,r.prototype.write=function(e){this.codec.encode(this,e)}},McxJ:function(e,t,n){var i=n("iSaS"),r=n("2f56");function s(e){this._init(e)}s.prototype={_init:function(e){e=e||{},this._result=null,this._onDataCallback=e.onData,this._onEndCallback=e.onEnd},_createTable:function(){for(var e={},t=0;t<i.TABLE_LENGTH;t++)e[i.BASE62TABLE.charAt(t)]=t;return e},_onData:function(e){var t;if(this._onDataCallback){if(e)t=this._result,this._result=[];else{var n=i.DECOMPRESS_CHUNK_SIZE-i.WINDOW_MAX;t=this._result.slice(i.WINDOW_MAX,i.WINDOW_MAX+n),this._result=this._result.slice(0,i.WINDOW_MAX).concat(this._result.slice(i.WINDOW_MAX+n))}t.length>0&&this._onDataCallback(r.bufferToString_fast(t))}},_onEnd:function(){this._onEndCallback&&this._onEndCallback()},decompress:function(e){if(null==e||0===e.length)return"";this._result=r.stringToArray(r.createWindow());for(var t,n,s,o,a,l,c,h,u,d,p=this._createTable(),f=!1,g=null,m=e.length,b=0;b<m;b++)if(void 0!==(s=p[e.charAt(b)])){if(s<i.DECODE_MAX)a=f?p[e.charAt(++b)]*i.UNICODE_CHAR_MAX+s+i.UNICODE_BUFFER_MAX*g:g*i.UNICODE_CHAR_MAX+s,this._result[this._result.length]=a;else if(s<i.LATIN_DECODE_MAX)g=s-i.DECODE_MAX,f=!1;else if(s===i.CHAR_START)g=(o=p[e.charAt(++b)])-5,f=!0;else if(s<i.COMPRESS_INDEX){if(o=p[e.charAt(++b)],s<i.COMPRESS_FIXED_START?(l=(s-i.COMPRESS_START)*i.BUFFER_MAX+o,c=p[e.charAt(++b)]):(l=(s-i.COMPRESS_FIXED_START)*i.BUFFER_MAX+o,c=2),(h=this._result.slice(-l)).length>c&&(h.length=c),u=h.length,h.length>0)for(d=0;d<c;)for(n=0;n<u&&(this._result[this._result.length]=h[n],!(++d>=c));n++);g=null}this._result.length>=i.DECOMPRESS_CHUNK_MAX&&this._onData()}return this._result=this._result.slice(i.WINDOW_MAX),this._onData(!0),this._onEnd(),t=r.bufferToString_fast(this._result),this._result=null,t}},e.exports=s},NDgz:function(e,t,n){var i=n("kVK+"),r=n("IKIk"),s=r.Uint64BE,o=r.Int64BE;t.getReadFormat=function(e){var t=e&&e.int64;return{map:c&&e&&e.usemap?u:h,array:d,str:p,bin:a.hasArrayBuffer&&e&&e.binarraybuffer?g:f,ext:m,uint8:b,uint16:v,uint32:w,uint64:x(8,t?S:E),int8:y,int16:_,int32:C,int64:x(8,t?T:k),float32:x(4,O),float64:x(8,I)}},t.readUint8=b;var a=n("5ukv"),l=n("W3Yc"),c="undefined"!=typeof Map;function h(e,t){var n,i={},r=new Array(t),s=new Array(t),o=e.codec.decode;for(n=0;n<t;n++)r[n]=o(e),s[n]=o(e);for(n=0;n<t;n++)i[r[n]]=s[n];return i}function u(e,t){var n,i=new Map,r=new Array(t),s=new Array(t),o=e.codec.decode;for(n=0;n<t;n++)r[n]=o(e),s[n]=o(e);for(n=0;n<t;n++)i.set(r[n],s[n]);return i}function d(e,t){for(var n=new Array(t),i=e.codec.decode,r=0;r<t;r++)n[r]=i(e);return n}function p(e,t){var n=e.reserve(t);return l.toString.call(e.buffer,"utf-8",n,n+t)}function f(e,t){var n=e.reserve(t),i=l.slice.call(e.buffer,n,n+t);return a.from(i)}function g(e,t){var n=e.reserve(t),i=l.slice.call(e.buffer,n,n+t);return a.Uint8Array.from(i).buffer}function m(e,t){var n=e.reserve(t+1),i=e.buffer[n++],r=n+t,s=e.codec.getExtUnpacker(i);if(!s)throw new Error("Invalid ext type: "+(i?"0x"+i.toString(16):i));return s(l.slice.call(e.buffer,n,r))}function b(e){var t=e.reserve(1);return e.buffer[t]}function y(e){var t=e.reserve(1),n=e.buffer[t];return 128&n?n-256:n}function v(e){var t=e.reserve(2),n=e.buffer;return n[t++]<<8|n[t]}function _(e){var t=e.reserve(2),n=e.buffer,i=n[t++]<<8|n[t];return 32768&i?i-65536:i}function w(e){var t=e.reserve(4),n=e.buffer;return 16777216*n[t++]+(n[t++]<<16)+(n[t++]<<8)+n[t]}function C(e){var t=e.reserve(4),n=e.buffer;return n[t++]<<24|n[t++]<<16|n[t++]<<8|n[t]}function x(e,t){return function(n){var i=n.reserve(e);return t.call(n.buffer,i,!0)}}function E(e){return new s(this,e).toNumber()}function k(e){return new o(this,e).toNumber()}function S(e){return new s(this,e)}function T(e){return new o(this,e)}function O(e){return i.read(this,e,!1,23,4)}function I(e){return i.read(this,e,!1,52,8)}},NH6c:function(e,t){function n(e){var t="    ";if(isNaN(parseInt(e)))t=e;else switch(e){case 1:t=" ";break;case 2:t="  ";break;case 3:t="   ";break;case 4:t="    ";break;case 5:t="     ";break;case 6:t="      ";break;case 7:t="       ";break;case 8:t="        ";break;case 9:t="         ";break;case 10:t="          ";break;case 11:t="           ";break;case 12:t="            "}for(var n=["\n"],i=0;i<100;i++)n.push(n[i]+t);return n}function i(){this.step="    ",this.shift=n(this.step)}function r(e,t){return t-(e.replace(/\(/g,"").length-e.replace(/\)/g,"").length)}function s(e,t){return e.replace(/\s{1,}/g," ").replace(/ AND /gi,"~::~"+t+t+"AND ").replace(/ BETWEEN /gi,"~::~"+t+"BETWEEN ").replace(/ CASE /gi,"~::~"+t+"CASE ").replace(/ ELSE /gi,"~::~"+t+"ELSE ").replace(/ END /gi,"~::~"+t+"END ").replace(/ FROM /gi,"~::~FROM ").replace(/ GROUP\s{1,}BY/gi,"~::~GROUP BY ").replace(/ HAVING /gi,"~::~HAVING ").replace(/ IN /gi," IN ").replace(/ JOIN /gi,"~::~JOIN ").replace(/ CROSS~::~{1,}JOIN /gi,"~::~CROSS JOIN ").replace(/ INNER~::~{1,}JOIN /gi,"~::~INNER JOIN ").replace(/ LEFT~::~{1,}JOIN /gi,"~::~LEFT JOIN ").replace(/ RIGHT~::~{1,}JOIN /gi,"~::~RIGHT JOIN ").replace(/ ON /gi,"~::~"+t+"ON ").replace(/ OR /gi,"~::~"+t+t+"OR ").replace(/ ORDER\s{1,}BY/gi,"~::~ORDER BY ").replace(/ OVER /gi,"~::~"+t+"OVER ").replace(/\(\s{0,}SELECT /gi,"~::~(SELECT ").replace(/\)\s{0,}SELECT /gi,")~::~SELECT ").replace(/ THEN /gi," THEN~::~"+t).replace(/ UNION /gi,"~::~UNION~::~").replace(/ USING /gi,"~::~USING ").replace(/ WHEN /gi,"~::~"+t+"WHEN ").replace(/ WHERE /gi,"~::~WHERE ").replace(/ WITH /gi,"~::~WITH ").replace(/ ALL /gi," ALL ").replace(/ AS /gi," AS ").replace(/ ASC /gi," ASC ").replace(/ DESC /gi," DESC ").replace(/ DISTINCT /gi," DISTINCT ").replace(/ EXISTS /gi," EXISTS ").replace(/ NOT /gi," NOT ").replace(/ NULL /gi," NULL ").replace(/ LIKE /gi," LIKE ").replace(/\s{0,}SELECT /gi,"SELECT ").replace(/\s{0,}UPDATE /gi,"UPDATE ").replace(/ SET /gi," SET ").replace(/~::~{1,}/g,"~::~").split("~::~")}i.prototype.xml=function(e,t){var i=e.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").replace(/\s*xmlns\=/g,"~::~xmlns=").split("~::~"),r=i.length,s=!1,o=0,a="",l=0,c=t?n(t):this.shift;for(l=0;l<r;l++)i[l].search(/<!/)>-1?(a+=c[o]+i[l],s=!0,(i[l].search(/-->/)>-1||i[l].search(/\]>/)>-1||i[l].search(/!DOCTYPE/)>-1)&&(s=!1)):i[l].search(/-->/)>-1||i[l].search(/\]>/)>-1?(a+=i[l],s=!1):/^<\w/.exec(i[l-1])&&/^<\/\w/.exec(i[l])&&/^<[\w:\-\.\,]+/.exec(i[l-1])==/^<\/[\w:\-\.\,]+/.exec(i[l])[0].replace("/","")?(a+=i[l],s||o--):i[l].search(/<\w/)>-1&&-1==i[l].search(/<\//)&&-1==i[l].search(/\/>/)?a=a+=s?i[l]:c[o++]+i[l]:i[l].search(/<\w/)>-1&&i[l].search(/<\//)>-1?a=a+=s?i[l]:c[o]+i[l]:i[l].search(/<\//)>-1?a=a+=s?i[l]:c[--o]+i[l]:i[l].search(/\/>/)>-1?a=a+=s?i[l]:c[o]+i[l]:i[l].search(/<\?/)>-1||i[l].search(/xmlns\:/)>-1||i[l].search(/xmlns\=/)>-1?a+=c[o]+i[l]:a+=i[l];return"\n"==a[0]?a.slice(1):a},i.prototype.json=function(e,t){return t=t||this.step,"undefined"==typeof JSON?e:"string"==typeof e?JSON.stringify(JSON.parse(e),null,t):"object"==typeof e?JSON.stringify(e,null,t):e},i.prototype.css=function(e,t){var i=e.replace(/\s{1,}/g," ").replace(/\{/g,"{~::~").replace(/\}/g,"~::~}~::~").replace(/\;/g,";~::~").replace(/\/\*/g,"~::~/*").replace(/\*\//g,"*/~::~").replace(/~::~\s{0,}~::~/g,"~::~").split("~::~"),r=i.length,s=0,o="",a=0,l=t?n(t):this.shift;for(a=0;a<r;a++)/\{/.exec(i[a])?o+=l[s++]+i[a]:/\}/.exec(i[a])?o+=l[--s]+i[a]:(/\*\\/.exec(i[a]),o+=l[s]+i[a]);return o.replace(/^\n{1,}/,"")},i.prototype.sql=function(e,t){var i=e.replace(/\s{1,}/g," ").replace(/\'/gi,"~::~'").split("~::~"),o=i.length,a=[],l=0,c=this.step,h=0,u="",d=0,p=t?n(t):this.shift;for(d=0;d<o;d++)a=a.concat(d%2?i[d]:s(i[d],c));for(o=a.length,d=0;d<o;d++)h=r(a[d],h),/\s{0,}\s{0,}SELECT\s{0,}/.exec(a[d])&&(a[d]=a[d].replace(/\,/g,",\n"+c+c)),/\s{0,}\s{0,}SET\s{0,}/.exec(a[d])&&(a[d]=a[d].replace(/\,/g,",\n"+c+c)),/\s{0,}\(\s{0,}SELECT\s{0,}/.exec(a[d])?u+=p[++l]+a[d]:/\'/.exec(a[d])?(h<1&&l&&l--,u+=a[d]):(u+=p[l]+a[d],h<1&&l&&l--);return u.replace(/^\n{1,}/,"").replace(/\n{1,}/g,"\n")},i.prototype.xmlmin=function(e,t){return(t?e:e.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"").replace(/[ \r\n\t]{1,}xmlns/g," xmlns")).replace(/>\s{0,}</g,"><")},i.prototype.jsonmin=function(e){return"undefined"==typeof JSON?e:JSON.stringify(JSON.parse(e),null,0)},i.prototype.cssmin=function(e,t){return(t?e:e.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\//g,"")).replace(/\s{1,}/g," ").replace(/\{\s{1,}/g,"{").replace(/\}\s{1,}/g,"}").replace(/\;\s{1,}/g,";").replace(/\/\*\s{1,}/g,"/*").replace(/\*\/\s{1,}/g,"*/")},i.prototype.sqlmin=function(e){return e.replace(/\s{1,}/g," ").replace(/\s{1,}\(/,"(").replace(/\s{1,}\)/,")")},e.exports=new i},NMIm:function(e,t,n){t.Decoder=s;var i=n("VOSt"),r=n("NdQB").DecodeBuffer;function s(e){if(!(this instanceof s))return new s(e);r.call(this,e)}s.prototype=new r,i.mixin(s.prototype),s.prototype.decode=function(e){arguments.length&&this.write(e),this.flush()},s.prototype.push=function(e){this.emit("data",e)},s.prototype.end=function(e){this.decode(e),this.emit("end")}},NdQB:function(e,t,n){t.DecodeBuffer=r;var i=n("1mG5").preset;function r(e){if(!(this instanceof r))return new r(e);if(e&&(this.options=e,e.codec)){var t=this.codec=e.codec;t.bufferish&&(this.bufferish=t.bufferish)}}n("jZ1Y").FlexDecoder.mixin(r.prototype),r.prototype.codec=i,r.prototype.fetch=function(){return this.codec.decode(this)}},RiOb:function(e,t,n){n("1mG5"),n("l5sx"),t.createCodec=n("eHTg").createCodec},T4b0:function(e,t,n){var i=n("5ukv"),r=i.global;function s(e){return new r(e)}(t=e.exports=i.hasBuffer?s(0):[]).alloc=i.hasBuffer&&r.alloc||s,t.concat=i.concat,t.from=function(e){if(!i.isBuffer(e)&&i.isView(e))e=i.Uint8Array.from(e);else if(i.isArrayBuffer(e))e=new Uint8Array(e);else{if("string"==typeof e)return i.from.call(t,e);if("number"==typeof e)throw new TypeError('"value" argument must not be a number')}return r.from&&1!==r.from.length?r.from(e):new r(e)}},VOSt:function(e,t,n){!function(t){e.exports=t;var n={on:function(e,t){return s(this,e).push(t),this},once:function(e,t){var n=this;return i.originalListener=t,s(n,e).push(i),n;function i(){r.call(n,e,i),t.apply(this,arguments)}},off:r,emit:function(e,t){var n=this,i=s(n,e,!0);if(!i)return!1;var r=arguments.length;if(1===r)i.forEach(a);else if(2===r)i.forEach(l);else{var o=Array.prototype.slice.call(arguments,1);i.forEach(c)}return!!i.length;function a(e){e.call(n)}function l(e){e.call(n,t)}function c(e){e.apply(n,o)}}};function i(e){for(var t in n)e[t]=n[t];return e}function r(e,t){var n,i=this;if(arguments.length){if(t){if(n=s(i,e,!0)){if(!(n=n.filter(o)).length)return r.call(i,e);i.listeners[e]=n}}else if((n=i.listeners)&&(delete n[e],!Object.keys(n).length))return r.call(i)}else delete i.listeners;return i;function o(e){return e!==t&&e.originalListener!==t}}function s(e,t,n){if(!n||e.listeners){var i=e.listeners||(e.listeners={});return i[t]||(i[t]=[])}}i(t.prototype),t.mixin=i}(function e(){if(!(this instanceof e))return new e})},W3Yc:function(e,t,n){var i=n("BoP+");t.copy=l,t.slice=c,t.toString=function(e,t,n){var s=!o&&r.isBuffer(this)?this.toString:i.toString;return s.apply(this,arguments)},t.write=function(){return(this.write||i.write).apply(this,arguments)};var r=n("5ukv"),s=r.global,o=r.hasBuffer&&"TYPED_ARRAY_SUPPORT"in s,a=o&&!s.TYPED_ARRAY_SUPPORT;function l(e,t,n,s){var o=r.isBuffer(this),l=r.isBuffer(e);if(o&&l)return this.copy(e,t,n,s);if(a||o||l||!r.isView(this)||!r.isView(e))return i.copy.call(this,e,t,n,s);var h=n||null!=s?c.call(this,n,s):this;return e.set(h,t),h.length}function c(e,t){var n=this.slice||!a&&this.subarray;if(n)return n.call(this,e,t);var i=r.alloc.call(this,t-e);return l.call(this,i,0,e,t),i}},aKC4:function(e,t,n){var i=n("iSaS"),r=n("2f56");function s(e){this._init(e)}s.prototype={_init:function(e){e=e||{},this._data=null,this._table=null,this._result=null,this._onDataCallback=e.onData,this._onEndCallback=e.onEnd},_createTable:function(){for(var e=r.createBuffer(8,i.TABLE_LENGTH),t=0;t<i.TABLE_LENGTH;t++)e[t]=i.BASE62TABLE.charCodeAt(t);return e},_onData:function(e,t){var n=r.bufferToString_fast(e,t);this._onDataCallback?this._onDataCallback(n):this._result+=n},_onEnd:function(){this._onEndCallback&&this._onEndCallback(),this._data=this._table=null},_search:function(){var e=2,t=this._data,n=this._offset,r=i.BUFFER_MAX;if(this._dataLen-n<r&&(r=this._dataLen-n),e>r)return!1;var s,o,a,l,c,h=n-i.WINDOW_BUFFER_MAX,u=t.substring(h,n+r),d=n+e-3-h;do{if(2===e){if(o=t.charAt(n)+t.charAt(n+1),!~(a=u.indexOf(o))||a>d)break}else 3===e?o+=t.charAt(n+2):o=t.substr(n,e);if(!~(l=i.STRING_LASTINDEXOF_BUG?t.substring(h,n+e-1).lastIndexOf(o):u.lastIndexOf(o,d)))break;c=l,s=h+l;do{if(t.charCodeAt(n+e)!==t.charCodeAt(s+e))break}while(++e<r);if(a===l){e++;break}}while(++e<r);return 2!==e&&(this._index=i.WINDOW_BUFFER_MAX-c,this._length=e-1,!0)},compress:function(e){if(null==e||0===e.length)return"";var t,n=this._createTable(),s=r.createWindow(),o=r.createBuffer(8,i.COMPRESS_CHUNK_SIZE),a=0;this._result="",this._offset=s.length,this._data=s+e,this._dataLen=this._data.length,s=e=null;for(var l,c,h,u,d,p=-1,f=-1;this._offset<this._dataLen;)this._search()?(this._index<i.BUFFER_MAX?(c=this._index,h=0):h=(this._index-(c=this._index%i.BUFFER_MAX))/i.BUFFER_MAX,2===this._length?(o[a++]=n[h+i.COMPRESS_FIXED_START],o[a++]=n[c]):(o[a++]=n[h+i.COMPRESS_START],o[a++]=n[c],o[a++]=n[this._length]),this._offset+=this._length,~f&&(f=-1)):(l=this._data.charCodeAt(this._offset++))<i.LATIN_BUFFER_MAX?(l<i.UNICODE_CHAR_MAX?(c=l,h=0,p=i.LATIN_INDEX):p=(h=(l-(c=l%i.UNICODE_CHAR_MAX))/i.UNICODE_CHAR_MAX)+i.LATIN_INDEX,f===p?o[a++]=n[c]:(o[a++]=n[p-i.LATIN_INDEX_START],o[a++]=n[c],f=p)):(l<i.UNICODE_BUFFER_MAX?(c=l,h=0,p=i.UNICODE_INDEX):p=(h=(l-(c=l%i.UNICODE_BUFFER_MAX))/i.UNICODE_BUFFER_MAX)+i.UNICODE_INDEX,c<i.UNICODE_CHAR_MAX?(u=c,d=0):d=(c-(u=c%i.UNICODE_CHAR_MAX))/i.UNICODE_CHAR_MAX,f===p?(o[a++]=n[u],o[a++]=n[d]):(o[a++]=n[i.CHAR_START],o[a++]=n[p-i.TABLE_LENGTH],o[a++]=n[u],o[a++]=n[d],f=p)),a>=i.COMPRESS_CHUNK_MAX&&(this._onData(o,a),a=0);return a>0&&this._onData(o,a),this._onEnd(),t=this._result,this._result=null,null===t?"":t}},e.exports=s},bEZV:function(e,t,n){t.setExtPackers=function(e){e.addExtPacker(14,Error,[u,l]),e.addExtPacker(1,EvalError,[u,l]),e.addExtPacker(2,RangeError,[u,l]),e.addExtPacker(3,ReferenceError,[u,l]),e.addExtPacker(4,SyntaxError,[u,l]),e.addExtPacker(5,TypeError,[u,l]),e.addExtPacker(6,URIError,[u,l]),e.addExtPacker(10,RegExp,[h,l]),e.addExtPacker(11,Boolean,[c,l]),e.addExtPacker(12,String,[c,l]),e.addExtPacker(13,Date,[Number,l]),e.addExtPacker(15,Number,[c,l]),"undefined"!=typeof Uint8Array&&(e.addExtPacker(17,Int8Array,o),e.addExtPacker(18,Uint8Array,o),e.addExtPacker(19,Int16Array,o),e.addExtPacker(20,Uint16Array,o),e.addExtPacker(21,Int32Array,o),e.addExtPacker(22,Uint32Array,o),e.addExtPacker(23,Float32Array,o),"undefined"!=typeof Float64Array&&e.addExtPacker(24,Float64Array,o),"undefined"!=typeof Uint8ClampedArray&&e.addExtPacker(25,Uint8ClampedArray,o),e.addExtPacker(26,ArrayBuffer,o),e.addExtPacker(29,DataView,o)),r.hasBuffer&&e.addExtPacker(27,s,r.from)};var i,r=n("5ukv"),s=r.global,o=r.Uint8Array.from,a={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function l(e){return i||(i=n("26FE").encode),i(e)}function c(e){return e.valueOf()}function h(e){(e=RegExp.prototype.toString.call(e).split("/")).shift();var t=[e.pop()];return t.unshift(e.join("/")),t}function u(e){var t={};for(var n in a)t[n]=e[n];return t}},eHTg:function(e,t,n){var i=n("49sm");t.createCodec=a,t.install=function(e){for(var t in e)s.prototype[t]=o(s.prototype[t],e[t])},t.filter=function(e){return i(e)?function(e){return e=e.slice(),function(n){return e.reduce(t,n)};function t(e,t){return t(e)}}(e):e};var r=n("5ukv");function s(e){if(!(this instanceof s))return new s(e);this.options=e,this.init()}function o(e,t){return e&&t?function(){return e.apply(this,arguments),t.apply(this,arguments)}:e||t}function a(e){return new s(e)}s.prototype.init=function(){var e=this.options;return e&&e.uint8array&&(this.bufferish=r.Uint8Array),this},t.preset=a({preset:!0})},"htI/":function(e,t,n){t.decode=function(e,t){var n=new i(t);return n.write(e),n.read()};var i=n("NdQB").DecodeBuffer},iSaS:function(e,t){var n=t.HAS_TYPED="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array,i=!1,r=!1;try{"a"===String.fromCharCode.apply(null,[97])&&(i=!0)}catch(y){}if(n)try{"a"===String.fromCharCode.apply(null,new Uint8Array([97]))&&(r=!0)}catch(y){}t.CAN_CHARCODE_APPLY=i,t.CAN_CHARCODE_APPLY_TYPED=r;var s=t.APPLY_BUFFER_SIZE=65533;t.APPLY_BUFFER_SIZE_OK=null;var o=!1;-1!=="abc\u307b\u3052".lastIndexOf("\u307b\u3052",1)&&(o=!0),t.STRING_LASTINDEXOF_BUG=o;var a=t.BASE62TABLE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",l=t.TABLE_LENGTH=a.length,c=Math.max(l,62)-Math.min(l,62);t.BUFFER_MAX=l-1;var h=t.WINDOW_MAX=1024;t.WINDOW_BUFFER_MAX=304;var u=t.COMPRESS_CHUNK_SIZE=s;t.COMPRESS_CHUNK_MAX=u-l;var d=t.DECOMPRESS_CHUNK_SIZE=s;t.DECOMPRESS_CHUNK_MAX=d+2*h,t.LATIN_BUFFER_MAX=132;var p=t.UNICODE_CHAR_MAX=40;t.UNICODE_BUFFER_MAX=p*(p+1),t.LATIN_INDEX=l+1,t.LATIN_INDEX_START=c+20,t.UNICODE_INDEX=l+5,t.DECODE_MAX=l-c-19;var f=t.LATIN_DECODE_MAX=p+7,g=t.CHAR_START=f+1,m=t.COMPRESS_START=g+1,b=t.COMPRESS_FIXED_START=m+5;t.COMPRESS_INDEX=b+5},jZ1Y:function(e,t,n){t.FlexDecoder=r,t.FlexEncoder=s;var i=n("5ukv");function r(){if(!(this instanceof r))return new r}function s(){if(!(this instanceof s))return new s}function o(){return this.buffers&&this.buffers.length?(this.flush(),this.pull()):this.fetch()}function a(e){(this.buffers||(this.buffers=[])).push(e)}function l(e){return function(t){for(var n in e)t[n]=e[n];return t}}r.mixin=l({bufferish:i,write:function(e){var t=this.offset?i.prototype.slice.call(this.buffer,this.offset):this.buffer;this.buffer=t?e?this.bufferish.concat([t,e]):t:e,this.offset=0},fetch:function(){throw new Error("method not implemented: fetch()")},flush:function(){for(;this.offset<this.buffer.length;){var e,t=this.offset;try{e=this.fetch()}catch(n){if(n&&"BUFFER_SHORTAGE"!=n.message)throw n;this.offset=t;break}this.push(e)}},push:a,pull:function(){return(this.buffers||(this.buffers=[])).shift()},read:o,reserve:function(e){var t=this.offset,n=t+e;if(n>this.buffer.length)throw new Error("BUFFER_SHORTAGE");return this.offset=n,t},offset:0}),r.mixin(r.prototype),s.mixin=l({bufferish:i,write:function(){throw new Error("method not implemented: write()")},fetch:function(){var e=this.start;if(e<this.offset){var t=this.start=this.offset;return i.prototype.slice.call(this.buffer,e,t)}},flush:function(){for(;this.start<this.offset;){var e=this.fetch();e&&this.push(e)}},push:a,pull:function(){var e=this.buffers||(this.buffers=[]),t=e.length>1?this.bufferish.concat(e):e[0];return e.length=0,t},read:o,reserve:function(e){var t=0|e;if(this.buffer){var n=this.buffer.length,i=0|this.offset,r=i+t;if(r<n)return this.offset=r,i;this.flush(),e=Math.max(e,Math.min(2*n,this.maxBufferSize))}return e=Math.max(e,this.minBufferSize),this.buffer=this.bufferish.alloc(e),this.start=0,this.offset=t,0},send:function(e){var t=e.length;if(t>this.minBufferSize)this.flush(),this.push(e);else{var n=this.reserve(t);i.prototype.copy.call(e,this.buffer,n)}},maxBufferSize:65536,minBufferSize:2048,offset:0,start:0}),s.mixin(s.prototype)},k5sU:function(e,t,n){var i=n("kVK+"),r=n("IKIk"),s=r.Uint64BE,o=r.Int64BE,a=n("ngnX").uint8,l=n("5ukv"),c=l.global,h=l.hasBuffer&&"TYPED_ARRAY_SUPPORT"in c&&!c.TYPED_ARRAY_SUPPORT,u=l.hasBuffer&&c.prototype||{};function d(){var e=a.slice();return e[196]=p(196),e[197]=f(197),e[198]=g(198),e[199]=p(199),e[200]=f(200),e[201]=g(201),e[202]=m(202,4,u.writeFloatBE||v,!0),e[203]=m(203,8,u.writeDoubleBE||_,!0),e[204]=p(204),e[205]=f(205),e[206]=g(206),e[207]=m(207,8,b),e[208]=p(208),e[209]=f(209),e[210]=g(210),e[211]=m(211,8,y),e[217]=p(217),e[218]=f(218),e[219]=g(219),e[220]=f(220),e[221]=g(221),e[222]=f(222),e[223]=g(223),e}function p(e){return function(t,n){var i=t.reserve(2),r=t.buffer;r[i++]=e,r[i]=n}}function f(e){return function(t,n){var i=t.reserve(3),r=t.buffer;r[i++]=e,r[i++]=n>>>8,r[i]=n}}function g(e){return function(t,n){var i=t.reserve(5),r=t.buffer;r[i++]=e,r[i++]=n>>>24,r[i++]=n>>>16,r[i++]=n>>>8,r[i]=n}}function m(e,t,n,i){return function(r,s){var o=r.reserve(t+1);r.buffer[o++]=e,n.call(r.buffer,s,o,i)}}function b(e,t){new s(this,t,e)}function y(e,t){new o(this,t,e)}function v(e,t){i.write(this,e,t,!1,23,4)}function _(e,t){i.write(this,e,t,!1,52,8)}t.getWriteToken=function(e){return e&&e.uint8array?((t=d())[202]=m(202,4,v),t[203]=m(203,8,_),t):h||l.hasBuffer&&e&&e.safe?function(){var e=a.slice();return e[196]=m(196,1,c.prototype.writeUInt8),e[197]=m(197,2,c.prototype.writeUInt16BE),e[198]=m(198,4,c.prototype.writeUInt32BE),e[199]=m(199,1,c.prototype.writeUInt8),e[200]=m(200,2,c.prototype.writeUInt16BE),e[201]=m(201,4,c.prototype.writeUInt32BE),e[202]=m(202,4,c.prototype.writeFloatBE),e[203]=m(203,8,c.prototype.writeDoubleBE),e[204]=m(204,1,c.prototype.writeUInt8),e[205]=m(205,2,c.prototype.writeUInt16BE),e[206]=m(206,4,c.prototype.writeUInt32BE),e[207]=m(207,8,b),e[208]=m(208,1,c.prototype.writeInt8),e[209]=m(209,2,c.prototype.writeInt16BE),e[210]=m(210,4,c.prototype.writeInt32BE),e[211]=m(211,8,y),e[217]=m(217,1,c.prototype.writeUInt8),e[218]=m(218,2,c.prototype.writeUInt16BE),e[219]=m(219,4,c.prototype.writeUInt32BE),e[220]=m(220,2,c.prototype.writeUInt16BE),e[221]=m(221,4,c.prototype.writeUInt32BE),e[222]=m(222,2,c.prototype.writeUInt16BE),e[223]=m(223,4,c.prototype.writeUInt32BE),e}():d();var t}},"kVK+":function(e,t){t.read=function(e,t,n,i,r){var s,o,a=8*r-i-1,l=(1<<a)-1,c=l>>1,h=-7,u=n?r-1:0,d=n?-1:1,p=e[t+u];for(u+=d,s=p&(1<<-h)-1,p>>=-h,h+=a;h>0;s=256*s+e[t+u],u+=d,h-=8);for(o=s&(1<<-h)-1,s>>=-h,h+=i;h>0;o=256*o+e[t+u],u+=d,h-=8);if(0===s)s=1-c;else{if(s===l)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,i),s-=c}return(p?-1:1)*o*Math.pow(2,s-i)},t.write=function(e,t,n,i,r,s){var o,a,l,c=8*s-r-1,h=(1<<c)-1,u=h>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:s-1,f=i?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=h):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),(t+=o+u>=1?d/l:d*Math.pow(2,1-u))*l>=2&&(o++,l/=2),o+u>=h?(a=0,o=h):o+u>=1?(a=(t*l-1)*Math.pow(2,r),o+=u):(a=t*Math.pow(2,u-1)*Math.pow(2,r),o=0));r>=8;e[n+p]=255&a,p+=f,a/=256,r-=8);for(o=o<<r|a,c+=r;c>0;e[n+p]=255&o,p+=f,o/=256,c-=8);e[n+p-f]|=128*g}},l5sx:function(e,t,n){var i=n("19AM").ExtBuffer,r=n("bEZV"),s=n("yeV+"),o=n("eHTg");function a(){var e=this.options;return this.encode=function(e){var t=s.getWriteType(e);return function(e,n){var i=t[typeof n];if(!i)throw new Error('Unsupported type "'+typeof n+'": '+n);i(e,n)}}(e),e&&e.preset&&r.setExtPackers(this),this}o.install({addExtPacker:function(e,t,n){n=o.filter(n);var r=t.name;function s(t){return n&&(t=n(t)),new i(t,e)}r&&"Object"!==r?(this.extPackers||(this.extPackers={}))[r]=s:(this.extEncoderList||(this.extEncoderList=[])).unshift([t,s])},getExtPacker:function(e){var t=this.extPackers||(this.extPackers={}),n=e.constructor,i=n&&n.name&&t[n.name];if(i)return i;for(var r=this.extEncoderList||(this.extEncoderList=[]),s=r.length,o=0;o<s;o++){var a=r[o];if(n===a[0])return a[1]}},init:a}),t.preset=a.call(o.preset)},lPiR:function(e,t,n){var i;e.exports=(i=n("Ib8C"),function(e){var t=i,n=t.lib,r=n.WordArray,s=n.Hasher,o=t.algo,a=[],l=[];!function(){function t(t){for(var n=e.sqrt(t),i=2;i<=n;i++)if(!(t%i))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var i=2,r=0;r<64;)t(i)&&(r<8&&(a[r]=n(e.pow(i,.5))),l[r]=n(e.pow(i,1/3)),r++),i++}();var c=[],h=o.SHA256=s.extend({_doReset:function(){this._hash=new r.init(a.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],r=n[1],s=n[2],o=n[3],a=n[4],h=n[5],u=n[6],d=n[7],p=0;p<64;p++){if(p<16)c[p]=0|e[t+p];else{var f=c[p-15],g=c[p-2];c[p]=((f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3)+c[p-7]+((g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10)+c[p-16]}var m=i&r^i&s^r&s,b=d+((a<<26|a>>>6)^(a<<21|a>>>11)^(a<<7|a>>>25))+(a&h^~a&u)+l[p]+c[p];d=u,u=h,h=a,a=o+b|0,o=s,s=r,r=i,i=b+(((i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22))+m)|0}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+s|0,n[3]=n[3]+o|0,n[4]=n[4]+a|0,n[5]=n[5]+h|0,n[6]=n[6]+u|0,n[7]=n[7]+d|0},_doFinalize:function(){var t=this._data,n=t.words,i=8*this._nDataBytes,r=8*t.sigBytes;return n[r>>>5]|=128<<24-r%32,n[14+(r+64>>>9<<4)]=e.floor(i/4294967296),n[15+(r+64>>>9<<4)]=i,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=s._createHelper(h),t.HmacSHA256=s._createHmacHelper(h)}(Math),i.SHA256)},nZiH:function(e,t,n){t.Encoder=s;var i=n("VOSt"),r=n("Lcv9").EncodeBuffer;function s(e){if(!(this instanceof s))return new s(e);r.call(this,e)}s.prototype=new r,i.mixin(s.prototype),s.prototype.encode=function(e){this.write(e),this.emit("data",this.read())},s.prototype.end=function(e){arguments.length&&this.encode(e),this.flush(),this.emit("end")}},nZuW:function(e,t,n){n("1mG5"),n("l5sx"),t.codec={preset:n("eHTg").preset}},ngnX:function(e,t){for(var n=t.uint8=new Array(256),i=0;i<=255;i++)n[i]=r(i);function r(e){return function(t){var n=t.reserve(1);t.buffer[n]=e}}},sZbO:function(e,t,n){var i=n("NDgz");function r(e){var t,n=new Array(256);for(t=0;t<=127;t++)n[t]=s(t);for(t=128;t<=143;t++)n[t]=a(t-128,e.map);for(t=144;t<=159;t++)n[t]=a(t-144,e.array);for(t=160;t<=191;t++)n[t]=a(t-160,e.str);for(n[192]=s(null),n[193]=null,n[194]=s(!1),n[195]=s(!0),n[196]=o(e.uint8,e.bin),n[197]=o(e.uint16,e.bin),n[198]=o(e.uint32,e.bin),n[199]=o(e.uint8,e.ext),n[200]=o(e.uint16,e.ext),n[201]=o(e.uint32,e.ext),n[202]=e.float32,n[203]=e.float64,n[204]=e.uint8,n[205]=e.uint16,n[206]=e.uint32,n[207]=e.uint64,n[208]=e.int8,n[209]=e.int16,n[210]=e.int32,n[211]=e.int64,n[212]=a(1,e.ext),n[213]=a(2,e.ext),n[214]=a(4,e.ext),n[215]=a(8,e.ext),n[216]=a(16,e.ext),n[217]=o(e.uint8,e.str),n[218]=o(e.uint16,e.str),n[219]=o(e.uint32,e.str),n[220]=o(e.uint16,e.array),n[221]=o(e.uint32,e.array),n[222]=o(e.uint16,e.map),n[223]=o(e.uint32,e.map),t=224;t<=255;t++)n[t]=s(t-256);return n}function s(e){return function(){return e}}function o(e,t){return function(n){var i=e(n);return t(n,i)}}function a(e,t){return function(n){return t(n,e)}}t.getReadToken=function(e){var t=i.getReadFormat(e);return e&&e.useraw?function(e){var t,n=r(e).slice();for(n[217]=n[196],n[218]=n[197],n[219]=n[198],t=160;t<=191;t++)n[t]=a(t-160,e.bin);return n}(t):r(t)}},t2S5:function(e,t,n){var i=n("5ukv");function r(e){return new Array(e)}(t=e.exports=r(0)).alloc=r,t.concat=i.concat,t.from=function(e){if(!i.isBuffer(e)&&i.isView(e))e=i.Uint8Array.from(e);else if(i.isArrayBuffer(e))e=new Uint8Array(e);else{if("string"==typeof e)return i.from.call(t,e);if("number"==typeof e)throw new TypeError('"value" argument must not be a number')}return Array.prototype.slice.call(e)}},xOOu:function(e,t,n){e.exports=function e(t,n,i){function r(o,a){if(!n[o]){if(!t[o]){if(s)return s(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[o]={exports:{}};t[o][0].call(c.exports,function(e){return r(t[o][1][e]||e)},c,c.exports,e,t,n,i)}return n[o].exports}for(var s=!1,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(e,t,n){"use strict";var i=e("./utils"),r=e("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(e){for(var t,n,r,o,a,l,c=[],h=0,u=e.length,d=u,p="string"!==i.getTypeOf(e);h<e.length;)d=u-h,p?(t=e[h++],n=h<u?e[h++]:0,r=h<u?e[h++]:0):(t=e.charCodeAt(h++),n=h<u?e.charCodeAt(h++):0,r=h<u?e.charCodeAt(h++):0),o=(3&t)<<4|n>>4,a=d>1?(15&n)<<2|r>>6:64,l=d>2?63&r:64,c.push(s.charAt(t>>2)+s.charAt(o)+s.charAt(a)+s.charAt(l));return c.join("")},n.decode=function(e){var t,n,i,o,a,l,c=0,h=0,u="data:";if(e.substr(0,u.length)===u)throw new Error("Invalid base64 input, it looks like a data url.");var d,p=3*(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(e.charAt(e.length-1)===s.charAt(64)&&p--,e.charAt(e.length-2)===s.charAt(64)&&p--,p%1!=0)throw new Error("Invalid base64 input, bad content length.");for(d=r.uint8array?new Uint8Array(0|p):new Array(0|p);c<e.length;)i=s.indexOf(e.charAt(c++)),t=(15&(o=s.indexOf(e.charAt(c++))))<<4|(a=s.indexOf(e.charAt(c++)))>>2,n=(3&a)<<6|(l=s.indexOf(e.charAt(c++))),d[h++]=i<<2|o>>4,64!==a&&(d[h++]=t),64!==l&&(d[h++]=n);return d}},{"./support":30,"./utils":32}],2:[function(e,t,n){"use strict";function i(e,t,n,i,r){this.compressedSize=e,this.uncompressedSize=t,this.crc32=n,this.compression=i,this.compressedContent=r}var r=e("./external"),s=e("./stream/DataWorker"),o=e("./stream/DataLengthProbe"),a=e("./stream/Crc32Probe");o=e("./stream/DataLengthProbe"),i.prototype={getContentWorker:function(){var e=new s(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),t=this;return e.on("end",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new s(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},i.createWorkerFrom=function(e,t,n){return e.pipe(new a).pipe(new o("uncompressedSize")).pipe(t.compressWorker(n)).pipe(new o("compressedSize")).withStreamInfo("compression",t)},t.exports=i},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,n){"use strict";var i=e("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(e){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},n.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,n){"use strict";var i=e("./utils"),r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==i.getTypeOf(e)?function(e,t,n,i){var s=r,o=0+n;e^=-1;for(var a=0;a<o;a++)e=e>>>8^s[255&(e^t[a])];return-1^e}(0|t,e,e.length):function(e,t,n,i){var s=r,o=0+n;e^=-1;for(var a=0;a<o;a++)e=e>>>8^s[255&(e^t.charCodeAt(a))];return-1^e}(0|t,e,e.length):0}},{"./utils":32}],5:[function(e,t,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(e,t,n){"use strict";var i;i="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:i}},{lie:58}],7:[function(e,t,n){"use strict";function i(e,t){a.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,s=e("pako"),o=e("./utils"),a=e("./stream/GenericWorker"),l=r?"uint8array":"array";n.magic="\b\0",o.inherits(i,a),i.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(o.transformTo(l,e.data),!1)},i.prototype.flush=function(){a.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},i.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},i.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},n.compressWorker=function(e){return new i("Deflate",e)},n.uncompressWorker=function(){return new i("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:59}],8:[function(e,t,n){"use strict";function i(e,t,n,i){s.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=n,this.encodeFileName=i,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}var r=e("../utils"),s=e("../stream/GenericWorker"),o=e("../utf8"),a=e("../crc32"),l=e("../signature"),c=function(e,t){var n,i="";for(n=0;n<t;n++)i+=String.fromCharCode(255&e),e>>>=8;return i},h=function(e,t,n,i,s,h){var u,d,p=e.file,f=e.compression,g=h!==o.utf8encode,m=r.transformTo("string",h(p.name)),b=r.transformTo("string",o.utf8encode(p.name)),y=p.comment,v=r.transformTo("string",h(y)),_=r.transformTo("string",o.utf8encode(y)),w=b.length!==p.name.length,C=_.length!==y.length,x="",E="",k="",S=p.dir,T=p.date,O={crc32:0,compressedSize:0,uncompressedSize:0};t&&!n||(O.crc32=e.crc32,O.compressedSize=e.compressedSize,O.uncompressedSize=e.uncompressedSize);var I=0;t&&(I|=8),g||!w&&!C||(I|=2048);var M=0,A=0;S&&(M|=16),"UNIX"===s?(A=798,M|=function(e,t){var n=e;return e||(n=t?16893:33204),(65535&n)<<16}(p.unixPermissions,S)):(A=20,M|=function(e,t){return 63&(e||0)}(p.dosPermissions)),u=T.getUTCHours(),u<<=6,u|=T.getUTCMinutes(),u<<=5,u|=T.getUTCSeconds()/2,d=T.getUTCFullYear()-1980,d<<=4,d|=T.getUTCMonth()+1,d<<=5,d|=T.getUTCDate(),w&&(E=c(1,1)+c(a(m),4)+b,x+="up"+c(E.length,2)+E),C&&(k=c(1,1)+c(a(v),4)+_,x+="uc"+c(k.length,2)+k);var P="";return P+="\n\0",P+=c(I,2),P+=f.magic,P+=c(u,2),P+=c(d,2),P+=c(O.crc32,4),P+=c(O.compressedSize,4),P+=c(O.uncompressedSize,4),P+=c(m.length,2),P+=c(x.length,2),{fileRecord:l.LOCAL_FILE_HEADER+P+m+x,dirRecord:l.CENTRAL_FILE_HEADER+c(A,2)+P+c(v.length,2)+"\0\0\0\0"+c(M,4)+c(i,4)+m+x+v}},u=function(e){return l.DATA_DESCRIPTOR+c(e.crc32,4)+c(e.compressedSize,4)+c(e.uncompressedSize,4)};r.inherits(i,s),i.prototype.push=function(e){var t=e.meta.percent||0,n=this.entriesCount,i=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,s.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:n?(t+100*(n-i-1))/n:100}}))},i.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var n=h(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},i.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,n=h(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),t)this.push({data:u(e),meta:{percent:100}});else for(this.push({data:n.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},i.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var n=function(e,t,n,i,s){var o=r.transformTo("string",s(i));return l.CENTRAL_DIRECTORY_END+"\0\0\0\0"+c(e,2)+c(e,2)+c(t,4)+c(n,4)+c(o.length,2)+o}(this.dirRecords.length,this.bytesWritten-e,e,this.zipComment,this.encodeFileName);this.push({data:n,meta:{percent:100}})},i.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},i.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on("error",function(e){t.error(e)}),this},i.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},i.prototype.error=function(e){var t=this._sources;if(!s.prototype.error.call(this,e))return!1;for(var n=0;n<t.length;n++)try{t[n].error(e)}catch(e){}return!0},i.prototype.lock=function(){s.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=i},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,n){"use strict";var i=e("../compressions"),r=e("./ZipFileWorker"),s=function(e,t){var n=e||t,r=i[n];if(!r)throw new Error(n+" is not a valid compression method !");return r};n.generateWorker=function(e,t,n){var i=new r(t.streamFiles,n,t.platform,t.encodeFileName),o=0;try{e.forEach(function(e,n){o++;var r=s(n.options.compression,t.compression),a=n.dir,l=n.date;n._compressWorker(r,n.options.compressionOptions||t.compressionOptions||{}).withStreamInfo("file",{name:e,dir:a,date:l,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(i)}),i.entriesCount=o}catch(a){i.error(a)}return i}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,n){"use strict";function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={},this.comment=null,this.root="",this.clone=function(){var e=new i;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(i.prototype=e("./object")).loadAsync=e("./load"),i.support=e("./support"),i.defaults=e("./defaults"),i.version="3.1.5",i.loadAsync=function(e,t){return(new i).loadAsync(e,t)},i.external=e("./external"),t.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,n){"use strict";function i(e){return new s.Promise(function(t,n){var i=e.decompressed.getContentWorker().pipe(new l);i.on("error",function(e){n(e)}).on("end",function(){i.streamInfo.crc32!==e.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):t()}).resume()})}var r=e("./utils"),s=e("./external"),o=e("./utf8"),a=(r=e("./utils"),e("./zipEntries")),l=e("./stream/Crc32Probe"),c=e("./nodejsUtils");t.exports=function(e,t){var n=this;return t=r.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),c.isNode&&c.isStream(e)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then(function(e){var n=new a(t);return n.load(e),n}).then(function(e){var n=[s.Promise.resolve(e)],r=e.files;if(t.checkCRC32)for(var o=0;o<r.length;o++)n.push(i(r[o]));return s.Promise.all(n)}).then(function(e){for(var i=e.shift(),r=i.files,s=0;s<r.length;s++){var o=r[s];n.file(o.fileNameStr,o.decompressed,{binary:!0,optimizedBinaryString:!0,date:o.date,dir:o.dir,comment:o.fileCommentStr.length?o.fileCommentStr:null,unixPermissions:o.unixPermissions,dosPermissions:o.dosPermissions,createFolders:t.createFolders})}return i.zipComment.length&&(n.comment=i.zipComment),n})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,n){"use strict";function i(e,t){s.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}var r=e("../utils"),s=e("../stream/GenericWorker");r.inherits(i,s),i.prototype._bindStream=function(e){var t=this;this._stream=e,e.pause(),e.on("data",function(e){t.push({data:e,meta:{percent:0}})}).on("error",function(e){t.isPaused?this.generatedError=e:t.error(e)}).on("end",function(){t.isPaused?t._upstreamEnded=!0:t.end()})},i.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},i.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=i},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,n){"use strict";function i(e,t,n){r.call(this,t),this._helper=e;var i=this;e.on("data",function(e,t){i.push(e)||i._helper.pause(),n&&n(t)}).on("error",function(e){i.emit("error",e)}).on("end",function(){i.push(null)})}var r=e("readable-stream").Readable;e("../utils").inherits(i,r),i.prototype._read=function(){this._helper.resume()},t.exports=i},{"../utils":32,"readable-stream":16}],14:[function(e,t,n){"use strict";t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){return new Buffer(e,t)},allocBuffer:function(e){return Buffer.alloc?Buffer.alloc(e):new Buffer(e)},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,n){"use strict";function i(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var r=e("./utf8"),s=e("./utils"),o=e("./stream/GenericWorker"),a=e("./stream/StreamHelper"),l=e("./defaults"),c=e("./compressedObject"),h=e("./zipObject"),u=e("./generate"),d=e("./nodejsUtils"),p=e("./nodejs/NodejsStreamInputAdapter"),f=function(e,t,n){var i,r,a=s.getTypeOf(t),u=s.extend(n||{},l);u.date=u.date||new Date,null!==u.compression&&(u.compression=u.compression.toUpperCase()),"string"==typeof u.unixPermissions&&(u.unixPermissions=parseInt(u.unixPermissions,8)),u.unixPermissions&&16384&u.unixPermissions&&(u.dir=!0),u.dosPermissions&&16&u.dosPermissions&&(u.dir=!0),u.dir&&(e=m(e)),u.createFolders&&(i=g(e))&&b.call(this,i,!0),n&&void 0!==n.binary||(u.binary=!("string"===a&&!1===u.binary&&!1===u.base64)),(t instanceof c&&0===t.uncompressedSize||u.dir||!t||0===t.length)&&(u.base64=!1,u.binary=!0,t="",u.compression="STORE",a="string"),r=t instanceof c||t instanceof o?t:d.isNode&&d.isStream(t)?new p(e,t):s.prepareContent(e,t,u.binary,u.optimizedBinaryString,u.base64);var f=new h(e,r,u);this.files[e]=f},g=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""},m=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},b=function(e,t){return t=void 0!==t?t:l.createFolders,e=m(e),this.files[e]||f.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]},y={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,n,i;for(t in this.files)this.files.hasOwnProperty(t)&&(i=this.files[t],(n=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(n,i))},filter:function(e){var t=[];return this.forEach(function(n,i){e(n,i)&&t.push(i)}),t},file:function(e,t,n){if(1===arguments.length){if(i(e)){var r=e;return this.filter(function(e,t){return!t.dir&&r.test(e)})}var s=this.files[this.root+e];return s&&!s.dir?s:null}return f.call(this,e=this.root+e,t,n),this},folder:function(e){if(!e)return this;if(i(e))return this.filter(function(t,n){return n.dir&&e.test(t)});var t=b.call(this,this.root+e),n=this.clone();return n.root=t.name,n},remove:function(e){var t=this.files[e=this.root+e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var n=this.filter(function(t,n){return n.name.slice(0,e.length)===e}),i=0;i<n.length;i++)delete this.files[n[i].name];return this},generate:function(e){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,n={};try{if((n=s.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:r.utf8encode})).type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),"binarystring"===n.type&&(n.type="string"),!n.type)throw new Error("No output type specified.");s.checkSupport(n.type),"darwin"!==n.platform&&"freebsd"!==n.platform&&"linux"!==n.platform&&"sunos"!==n.platform||(n.platform="UNIX"),"win32"===n.platform&&(n.platform="DOS"),t=u.generateWorker(this,n,n.comment||this.comment||"")}catch(l){(t=new o("error")).error(l)}return new a(t,n.type||"string",n.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=y},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,n){t.exports=e("stream")},{stream:void 0}],17:[function(e,t,n){"use strict";function i(e){r.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}var r=e("./DataReader");e("../utils").inherits(i,r),i.prototype.byteAt=function(e){return this.data[this.zero+e]},i.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),i=e.charCodeAt(2),r=e.charCodeAt(3),s=this.length-4;s>=0;--s)if(this.data[s]===t&&this.data[s+1]===n&&this.data[s+2]===i&&this.data[s+3]===r)return s-this.zero;return-1},i.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1),i=e.charCodeAt(2),r=e.charCodeAt(3),s=this.readData(4);return t===s[0]&&n===s[1]&&i===s[2]&&r===s[3]},i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],18:[function(e,t,n){"use strict";function i(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}var r=e("../utils");i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var t,n=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)n=(n<<8)+this.byteAt(t);return this.index+=e,n},readString:function(e){return r.transformTo("string",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readAndCheckSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=i},{"../utils":32}],19:[function(e,t,n){"use strict";function i(e){r.call(this,e)}var r=e("./Uint8ArrayReader");e("../utils").inherits(i,r),i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,n){"use strict";function i(e){r.call(this,e)}var r=e("./DataReader");e("../utils").inherits(i,r),i.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},i.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],21:[function(e,t,n){"use strict";function i(e){r.call(this,e)}var r=e("./ArrayReader");e("../utils").inherits(i,r),i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,n){"use strict";var i=e("../utils"),r=e("../support"),s=e("./ArrayReader"),o=e("./StringReader"),a=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=i.getTypeOf(e);return i.checkSupport(t),"string"!==t||r.uint8array?"nodebuffer"===t?new a(e):r.uint8array?new l(i.transformTo("uint8array",e)):new s(i.transformTo("array",e)):new o(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,n){"use strict";n.LOCAL_FILE_HEADER="PK\x03\x04",n.CENTRAL_FILE_HEADER="PK\x01\x02",n.CENTRAL_DIRECTORY_END="PK\x05\x06",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",n.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",n.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,t,n){"use strict";function i(e){r.call(this,"ConvertWorker to "+e),this.destType=e}var r=e("./GenericWorker"),s=e("../utils");s.inherits(i,r),i.prototype.processChunk=function(e){this.push({data:s.transformTo(this.destType,e.data),meta:e.meta})},t.exports=i},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,n){"use strict";function i(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}var r=e("./GenericWorker"),s=e("../crc32");e("../utils").inherits(i,r),i.prototype.processChunk=function(e){this.streamInfo.crc32=s(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=i},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,n){"use strict";function i(e){s.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}var r=e("../utils"),s=e("./GenericWorker");r.inherits(i,s),i.prototype.processChunk=function(e){e&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+e.data.length),s.prototype.processChunk.call(this,e)},t.exports=i},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,n){"use strict";function i(e){s.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=r.getTypeOf(e),t.isPaused||t._tickAndRepeat()},function(e){t.error(e)})}var r=e("../utils"),s=e("./GenericWorker");r.inherits(i,s),i.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},i.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},i.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},i.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=i},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,n){"use strict";function i(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){t.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var e=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=i},{}],29:[function(e,t,n){"use strict";function i(e,t,n){switch(e){case"blob":return s.newBlob(s.transformTo("arraybuffer",t),n);case"base64":return l.encode(t);default:return s.transformTo(e,t)}}function r(e,t,n){var i=t;switch(t){case"blob":case"arraybuffer":i="uint8array";break;case"base64":i="string"}try{this._internalType=i,this._outputType=t,this._mimeType=n,s.checkSupport(i),this._worker=e.pipe(new o(i)),e.lock()}catch(r){this._worker=new a("error"),this._worker.error(r)}}var s=e("../utils"),o=e("./ConvertWorker"),a=e("./GenericWorker"),l=e("../base64"),c=e("../support"),h=e("../external"),u=null;if(c.nodestream)try{u=e("../nodejs/NodejsStreamOutputAdapter")}catch(d){}r.prototype={accumulate:function(e){return function(e,t){return new h.Promise(function(n,r){var s=[],o=e._internalType,a=e._outputType,l=e._mimeType;e.on("data",function(e,n){s.push(e),t&&t(n)}).on("error",function(e){s=[],r(e)}).on("end",function(){try{var e=i(a,function(e,t){var n,i=0,r=null,s=0;for(n=0;n<t.length;n++)s+=t[n].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(r=new Uint8Array(s),n=0;n<t.length;n++)r.set(t[n],i),i+=t[n].length;return r;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(o,s),l);n(e)}catch(t){r(t)}s=[]}).resume()})}(this,e)},on:function(e,t){var n=this;return this._worker.on(e,"data"===e?function(e){t.call(n,e.data,e.meta)}:function(){s.delay(t,arguments,n)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(s.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new u(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=r},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,n){"use strict";if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,n.nodebuffer="undefined"!=typeof Buffer,n.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)n.blob=!1;else{var i=new ArrayBuffer(0);try{n.blob=0===new Blob([i],{type:"application/zip"}).size}catch(s){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);r.append(i),n.blob=0===r.getBlob("application/zip").size}catch(s){n.blob=!1}}}try{n.nodestream=!!e("readable-stream").Readable}catch(s){n.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,n){"use strict";function i(){l.call(this,"utf-8 decode"),this.leftOver=null}function r(){l.call(this,"utf-8 encode")}for(var s=e("./utils"),o=e("./support"),a=e("./nodejsUtils"),l=e("./stream/GenericWorker"),c=new Array(256),h=0;h<256;h++)c[h]=h>=252?6:h>=248?5:h>=240?4:h>=224?3:h>=192?2:1;c[254]=c[254]=1,n.utf8encode=function(e){return o.nodebuffer?a.newBufferFrom(e,"utf-8"):function(e){var t,n,i,r,s,a=e.length,l=0;for(r=0;r<a;r++)55296==(64512&(n=e.charCodeAt(r)))&&r+1<a&&56320==(64512&(i=e.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(i-56320),r++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=o.uint8array?new Uint8Array(l):new Array(l),s=0,r=0;s<l;r++)55296==(64512&(n=e.charCodeAt(r)))&&r+1<a&&56320==(64512&(i=e.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(i-56320),r++),n<128?t[s++]=n:n<2048?(t[s++]=192|n>>>6,t[s++]=128|63&n):n<65536?(t[s++]=224|n>>>12,t[s++]=128|n>>>6&63,t[s++]=128|63&n):(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63,t[s++]=128|n>>>6&63,t[s++]=128|63&n);return t}(e)},n.utf8decode=function(e){return o.nodebuffer?s.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,n,i,r,o=e.length,a=new Array(2*o);for(n=0,t=0;t<o;)if((i=e[t++])<128)a[n++]=i;else if((r=c[i])>4)a[n++]=65533,t+=r-1;else{for(i&=2===r?31:3===r?15:7;r>1&&t<o;)i=i<<6|63&e[t++],r--;r>1?a[n++]=65533:i<65536?a[n++]=i:(a[n++]=55296|(i-=65536)>>10&1023,a[n++]=56320|1023&i)}return a.length!==n&&(a.subarray?a=a.subarray(0,n):a.length=n),s.applyFromCharCode(a)}(e=s.transformTo(o.uint8array?"uint8array":"array",e))},s.inherits(i,l),i.prototype.processChunk=function(e){var t=s.transformTo(o.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var i=t;(t=new Uint8Array(i.length+this.leftOver.length)).set(this.leftOver,0),t.set(i,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var r=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+c[e[n]]>t?n:t}(t),a=t;r!==t.length&&(o.uint8array?(a=t.subarray(0,r),this.leftOver=t.subarray(r,t.length)):(a=t.slice(0,r),this.leftOver=t.slice(r,t.length))),this.push({data:n.utf8decode(a),meta:e.meta})},i.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=i,s.inherits(r,l),r.prototype.processChunk=function(e){this.push({data:n.utf8encode(e.data),meta:e.meta})},n.Utf8EncodeWorker=r},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,n){"use strict";function i(e){return s(e,l.uint8array?new Uint8Array(e.length):new Array(e.length))}function r(e){return e}function s(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}function o(e){var t=65536,i=n.getTypeOf(e),r=!0;if("uint8array"===i?r=p.applyCanBeUsed.uint8array:"nodebuffer"===i&&(r=p.applyCanBeUsed.nodebuffer),r)for(;t>1;)try{return p.stringifyByChunk(e,i,t)}catch(s){t=Math.floor(t/2)}return p.stringifyByChar(e)}function a(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}var l=e("./support"),c=e("./base64"),h=e("./nodejsUtils"),u=e("core-js/library/fn/set-immediate"),d=e("./external");n.newBlob=function(e,t){n.checkSupport("blob");try{return new Blob([e],{type:t})}catch(i){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return r.append(e),r.getBlob(t)}catch(i){throw new Error("Bug : can't construct the Blob.")}}};var p={stringifyByChunk:function(e,t,n){var i=[],r=0,s=e.length;if(s<=n)return String.fromCharCode.apply(null,e);for(;r<s;)i.push(String.fromCharCode.apply(null,"array"===t||"nodebuffer"===t?e.slice(r,Math.min(r+n,s)):e.subarray(r,Math.min(r+n,s)))),r+=n;return i.join("")},stringifyByChar:function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},applyCanBeUsed:{uint8array:function(){try{return l.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return l.nodebuffer&&1===String.fromCharCode.apply(null,h.allocBuffer(1)).length}catch(e){return!1}}()}};n.applyFromCharCode=o;var f={};f.string={string:r,array:function(e){return s(e,new Array(e.length))},arraybuffer:function(e){return f.string.uint8array(e).buffer},uint8array:function(e){return s(e,new Uint8Array(e.length))},nodebuffer:function(e){return s(e,h.allocBuffer(e.length))}},f.array={string:o,array:r,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return h.newBufferFrom(e)}},f.arraybuffer={string:function(e){return o(new Uint8Array(e))},array:function(e){return a(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:r,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return h.newBufferFrom(new Uint8Array(e))}},f.uint8array={string:o,array:function(e){return a(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:r,nodebuffer:function(e){return h.newBufferFrom(e)}},f.nodebuffer={string:o,array:function(e){return a(e,new Array(e.length))},arraybuffer:function(e){return f.nodebuffer.uint8array(e).buffer},uint8array:function(e){return a(e,new Uint8Array(e.length))},nodebuffer:r},n.transformTo=function(e,t){if(t||(t=""),!e)return t;n.checkSupport(e);var i=n.getTypeOf(t);return f[i][e](t)},n.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":l.nodebuffer&&h.isBuffer(e)?"nodebuffer":l.uint8array&&e instanceof Uint8Array?"uint8array":l.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(e){if(!l[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(e){var t,n,i="";for(n=0;n<(e||"").length;n++)i+="\\x"+((t=e.charCodeAt(n))<16?"0":"")+t.toString(16).toUpperCase();return i},n.delay=function(e,t,n){u(function(){e.apply(n||null,t||[])})},n.inherits=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n},n.extend=function(){var e,t,n={};for(e=0;e<arguments.length;e++)for(t in arguments[e])arguments[e].hasOwnProperty(t)&&void 0===n[t]&&(n[t]=arguments[e][t]);return n},n.prepareContent=function(e,t,r,s,o){return d.Promise.resolve(t).then(function(e){return l.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new d.Promise(function(t,n){var i=new FileReader;i.onload=function(e){t(e.target.result)},i.onerror=function(e){n(e.target.error)},i.readAsArrayBuffer(e)}):e}).then(function(t){var a=n.getTypeOf(t);return a?("arraybuffer"===a?t=n.transformTo("uint8array",t):"string"===a&&(o?t=c.decode(t):r&&!0!==s&&(t=i(t))),t):d.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"core-js/library/fn/set-immediate":36}],33:[function(e,t,n){"use strict";function i(e){this.files=[],this.loadOptions=e}var r=e("./reader/readerFor"),s=e("./utils"),o=e("./signature"),a=e("./zipEntry"),l=(e("./utf8"),e("./support"));i.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(t)+", expected "+s.pretty(e)+")")}},isSignature:function(e,t){var n=this.reader.index;this.reader.setIndex(e);var i=this.reader.readString(4)===t;return this.reader.setIndex(n),i},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=s.transformTo(l.uint8array?"uint8array":"array",e);this.zipComment=this.loadOptions.decodeFileName(t)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,n,i=this.zip64EndOfCentralSize-44;0<i;)e=this.reader.readInt(2),t=this.reader.readInt(4),n=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)this.reader.setIndex((t=this.files[e]).localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(e=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var i=t-n;if(i>0)this.isSignature(t,o.CENTRAL_FILE_HEADER)||(this.reader.zero=i);else if(i<0)throw new Error("Corrupted zip: missing "+Math.abs(i)+" bytes.")},prepareReader:function(e){this.reader=r(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=i},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(e,t,n){"use strict";function i(e,t){this.options=e,this.loadOptions=t}var r=e("./reader/readerFor"),s=e("./utils"),o=e("./compressedObject"),a=e("./crc32"),l=e("./utf8"),c=e("./compressions"),h=e("./support");i.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t,n;if(e.skip(22),this.fileNameLength=e.readInt(2),n=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(n),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in c)if(c.hasOwnProperty(t)&&c[t].magic===e)return c[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0===e&&(this.dosPermissions=63&this.externalFileAttributes),3===e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(e){if(this.extraFields[1]){var t=r(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(e){var t,n,i,r=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index<r;)t=e.readInt(2),n=e.readInt(2),i=e.readData(n),this.extraFields[t]={id:t,length:n,value:i}},handleUTF8:function(){var e=h.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=l.utf8decode(this.fileName),this.fileCommentStr=l.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var n=s.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var i=this.findExtraFieldUnicodeComment();if(null!==i)this.fileCommentStr=i;else{var r=s.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(r)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=r(e.value);return 1!==t.readInt(1)||a(this.fileName)!==t.readInt(4)?null:l.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=r(e.value);return 1!==t.readInt(1)||a(this.fileComment)!==t.readInt(4)?null:l.utf8decode(t.readData(e.length-5))}return null}},t.exports=i},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,n){"use strict";var i=e("./stream/StreamHelper"),r=e("./stream/DataWorker"),s=e("./utf8"),o=e("./compressedObject"),a=e("./stream/GenericWorker"),l=function(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=t,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}};l.prototype={internalStream:function(e){var t=null,n="string";try{if(!e)throw new Error("No output type specified.");var r="string"===(n=e.toLowerCase())||"text"===n;"binarystring"!==n&&"text"!==n||(n="string"),t=this._decompressWorker();var o=!this._dataBinary;o&&!r&&(t=t.pipe(new s.Utf8EncodeWorker)),!o&&r&&(t=t.pipe(new s.Utf8DecodeWorker))}catch(l){(t=new a("error")).error(l)}return new i(t,n,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof o&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new s.Utf8EncodeWorker)),o.createWorkerFrom(n,e,t)},_decompressWorker:function(){return this._data instanceof o?this._data.getContentWorker():this._data instanceof a?this._data:new r(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},u=0;u<c.length;u++)l.prototype[c[u]]=h;t.exports=l},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,n){e("../modules/web.immediate"),t.exports=e("../modules/_core").setImmediate},{"../modules/_core":40,"../modules/web.immediate":56}],37:[function(e,t,n){t.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},{}],38:[function(e,t,n){var i=e("./_is-object");t.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},{"./_is-object":51}],39:[function(e,t,n){var i={}.toString;t.exports=function(e){return i.call(e).slice(8,-1)}},{}],40:[function(e,t,n){var i=t.exports={version:"2.3.0"};"number"==typeof __e&&(__e=i)},{}],41:[function(e,t,n){var i=e("./_a-function");t.exports=function(e,t,n){if(i(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)}}return function(){return e.apply(t,arguments)}}},{"./_a-function":37}],42:[function(e,t,n){t.exports=!e("./_fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{"./_fails":45}],43:[function(e,t,n){var i=e("./_is-object"),r=e("./_global").document,s=i(r)&&i(r.createElement);t.exports=function(e){return s?r.createElement(e):{}}},{"./_global":46,"./_is-object":51}],44:[function(e,t,n){var i=e("./_global"),r=e("./_core"),s=e("./_ctx"),o=e("./_hide"),a="prototype",l=function(e,t,n){var c,h,u,d=e&l.F,p=e&l.G,f=e&l.S,g=e&l.P,m=e&l.B,b=e&l.W,y=p?r:r[t]||(r[t]={}),v=y[a],_=p?i:f?i[t]:(i[t]||{})[a];for(c in p&&(n=t),n)(h=!d&&_&&void 0!==_[c])&&c in y||(u=h?_[c]:n[c],y[c]=p&&"function"!=typeof _[c]?n[c]:m&&h?s(u,i):b&&_[c]==u?function(e){var t=function(t,n,i){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,i)}return e.apply(this,arguments)};return t[a]=e[a],t}(u):g&&"function"==typeof u?s(Function.call,u):u,g&&((y.virtual||(y.virtual={}))[c]=u,e&l.R&&v&&!v[c]&&o(v,c,u)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},{"./_core":40,"./_ctx":41,"./_global":46,"./_hide":47}],45:[function(e,t,n){t.exports=function(e){try{return!!e()}catch(t){return!0}}},{}],46:[function(e,t,n){var i=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=i)},{}],47:[function(e,t,n){var i=e("./_object-dp"),r=e("./_property-desc");t.exports=e("./_descriptors")?function(e,t,n){return i.f(e,t,r(1,n))}:function(e,t,n){return e[t]=n,e}},{"./_descriptors":42,"./_object-dp":52,"./_property-desc":53}],48:[function(e,t,n){t.exports=e("./_global").document&&document.documentElement},{"./_global":46}],49:[function(e,t,n){t.exports=!e("./_descriptors")&&!e("./_fails")(function(){return 7!=Object.defineProperty(e("./_dom-create")("div"),"a",{get:function(){return 7}}).a})},{"./_descriptors":42,"./_dom-create":43,"./_fails":45}],50:[function(e,t,n){t.exports=function(e,t,n){var i=void 0===n;switch(t.length){case 0:return i?e():e.call(n);case 1:return i?e(t[0]):e.call(n,t[0]);case 2:return i?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return i?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return i?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},{}],51:[function(e,t,n){t.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},{}],52:[function(e,t,n){var i=e("./_an-object"),r=e("./_ie8-dom-define"),s=e("./_to-primitive"),o=Object.defineProperty;n.f=e("./_descriptors")?Object.defineProperty:function(e,t,n){if(i(e),t=s(t,!0),i(n),r)try{return o(e,t,n)}catch(a){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},{"./_an-object":38,"./_descriptors":42,"./_ie8-dom-define":49,"./_to-primitive":55}],53:[function(e,t,n){t.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},{}],54:[function(e,t,n){var i,r,s,o=e("./_ctx"),a=e("./_invoke"),l=e("./_html"),c=e("./_dom-create"),h=e("./_global"),u=h.process,d=h.setImmediate,p=h.clearImmediate,f=h.MessageChannel,g=0,m={},b="onreadystatechange",y=function(){var e=+this;if(m.hasOwnProperty(e)){var t=m[e];delete m[e],t()}},v=function(e){y.call(e.data)};d&&p||(d=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return m[++g]=function(){a("function"==typeof e?e:Function(e),t)},i(g),g},p=function(e){delete m[e]},"process"==e("./_cof")(u)?i=function(e){u.nextTick(o(y,e,1))}:f?(s=(r=new f).port2,r.port1.onmessage=v,i=o(s.postMessage,s,1)):h.addEventListener&&"function"==typeof postMessage&&!h.importScripts?(i=function(e){h.postMessage(e+"","*")},h.addEventListener("message",v,!1)):i=b in c("script")?function(e){l.appendChild(c("script"))[b]=function(){l.removeChild(this),y.call(e)}}:function(e){setTimeout(o(y,e,1),0)}),t.exports={set:d,clear:p}},{"./_cof":39,"./_ctx":41,"./_dom-create":43,"./_global":46,"./_html":48,"./_invoke":50}],55:[function(e,t,n){var i=e("./_is-object");t.exports=function(e,t){if(!i(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!i(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},{"./_is-object":51}],56:[function(e,t,n){var i=e("./_export"),r=e("./_task");i(i.G+i.B,{setImmediate:r.set,clearImmediate:r.clear})},{"./_export":44,"./_task":54}],57:[function(e,t,n){(function(e){"use strict";function n(){c=!0;for(var e,t,n=h.length;n;){for(t=h,h=[],e=-1;++e<n;)t[e]();n=h.length}c=!1}var i,r=e.MutationObserver||e.WebKitMutationObserver;if(r){var s=0,o=new r(n),a=e.document.createTextNode("");o.observe(a,{characterData:!0}),i=function(){a.data=s=++s%2}}else if(e.setImmediate||void 0===e.MessageChannel)i="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){n(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(n,0)};else{var l=new e.MessageChannel;l.port1.onmessage=n,i=function(){l.port2.postMessage(0)}}var c,h=[];t.exports=function(e){1!==h.push(e)||c||i()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],58:[function(e,t,n){"use strict";function i(){}function r(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=f,this.queue=[],this.outcome=void 0,e!==i&&l(this,e)}function s(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function o(e,t,n){h(function(){var i;try{i=t(n)}catch(r){return u.reject(e,r)}i===e?u.reject(e,new TypeError("Cannot resolve promise with itself")):u.resolve(e,i)})}function a(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function l(e,t){function n(t){r||(r=!0,u.reject(e,t))}function i(t){r||(r=!0,u.resolve(e,t))}var r=!1,s=c(function(){t(i,n)});"error"===s.status&&n(s.value)}function c(e,t){var n={};try{n.value=e(t),n.status="success"}catch(i){n.status="error",n.value=i}return n}var h=e("immediate"),u={},d=["REJECTED"],p=["FULFILLED"],f=["PENDING"];t.exports=r,r.prototype.catch=function(e){return this.then(null,e)},r.prototype.then=function(e,t){if("function"!=typeof e&&this.state===p||"function"!=typeof t&&this.state===d)return this;var n=new this.constructor(i);return this.state!==f?o(n,this.state===p?e:t,this.outcome):this.queue.push(new s(n,e,t)),n},s.prototype.callFulfilled=function(e){u.resolve(this.promise,e)},s.prototype.otherCallFulfilled=function(e){o(this.promise,this.onFulfilled,e)},s.prototype.callRejected=function(e){u.reject(this.promise,e)},s.prototype.otherCallRejected=function(e){o(this.promise,this.onRejected,e)},u.resolve=function(e,t){var n=c(a,t);if("error"===n.status)return u.reject(e,n.value);var i=n.value;if(i)l(e,i);else{e.state=p,e.outcome=t;for(var r=-1,s=e.queue.length;++r<s;)e.queue[r].callFulfilled(t)}return e},u.reject=function(e,t){e.state=d,e.outcome=t;for(var n=-1,i=e.queue.length;++n<i;)e.queue[n].callRejected(t);return e},r.resolve=function(e){return e instanceof this?e:u.resolve(new this(i),e)},r.reject=function(e){var t=new this(i);return u.reject(t,e)},r.all=function(e){function t(e,t){n.resolve(e).then(function(e){o[t]=e,++a!==r||s||(s=!0,u.resolve(c,o))},function(e){s||(s=!0,u.reject(c,e))})}var n=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,s=!1;if(!r)return this.resolve([]);for(var o=new Array(r),a=0,l=-1,c=new this(i);++l<r;)t(e[l],l);return c},r.race=function(e){function t(e){n.resolve(e).then(function(e){s||(s=!0,u.resolve(a,e))},function(e){s||(s=!0,u.reject(a,e))})}var n=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,s=!1;if(!r)return this.resolve([]);for(var o=-1,a=new this(i);++o<r;)t(e[o]);return a}},{immediate:57}],59:[function(e,t,n){"use strict";var i={};(0,e("./lib/utils/common").assign)(i,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=i},{"./lib/deflate":60,"./lib/inflate":61,"./lib/utils/common":62,"./lib/zlib/constants":65}],60:[function(e,t,n){"use strict";function i(e){if(!(this instanceof i))return new i(e);this.options=o.assign({level:d,method:f,chunkSize:16384,windowBits:15,memLevel:8,strategy:p,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var n=s.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==u)throw new Error(l[n]);if(t.header&&s.deflateSetHeader(this.strm,t.header),t.dictionary){var r;if(r="string"==typeof t.dictionary?a.string2buf(t.dictionary):"[object ArrayBuffer]"===h.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(n=s.deflateSetDictionary(this.strm,r))!==u)throw new Error(l[n]);this._dict_set=!0}}function r(e,t){var n=new i(t);if(n.push(e,!0),n.err)throw n.msg||l[n.err];return n.result}var s=e("./zlib/deflate"),o=e("./utils/common"),a=e("./utils/strings"),l=e("./zlib/messages"),c=e("./zlib/zstream"),h=Object.prototype.toString,u=0,d=-1,p=0,f=8;i.prototype.push=function(e,t){var n,i,r=this.strm,l=this.options.chunkSize;if(this.ended)return!1;i=t===~~t?t:!0===t?4:0,r.input="string"==typeof e?a.string2buf(e):"[object ArrayBuffer]"===h.call(e)?new Uint8Array(e):e,r.next_in=0,r.avail_in=r.input.length;do{if(0===r.avail_out&&(r.output=new o.Buf8(l),r.next_out=0,r.avail_out=l),1!==(n=s.deflate(r,i))&&n!==u)return this.onEnd(n),this.ended=!0,!1;0!==r.avail_out&&(0!==r.avail_in||4!==i&&2!==i)||this.onData("string"===this.options.to?a.buf2binstring(o.shrinkBuf(r.output,r.next_out)):o.shrinkBuf(r.output,r.next_out))}while((r.avail_in>0||0===r.avail_out)&&1!==n);return 4===i?(n=s.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===u):2!==i||(this.onEnd(u),r.avail_out=0,!0)},i.prototype.onData=function(e){this.chunks.push(e)},i.prototype.onEnd=function(e){e===u&&(this.result="string"===this.options.to?this.chunks.join(""):o.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=i,n.deflate=r,n.deflateRaw=function(e,t){return(t=t||{}).raw=!0,r(e,t)},n.gzip=function(e,t){return(t=t||{}).gzip=!0,r(e,t)}},{"./utils/common":62,"./utils/strings":63,"./zlib/deflate":67,"./zlib/messages":72,"./zlib/zstream":74}],61:[function(e,t,n){"use strict";function i(e){if(!(this instanceof i))return new i(e);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new h,this.strm.avail_out=0;var n=s.inflateInit2(this.strm,t.windowBits);if(n!==l.Z_OK)throw new Error(c[n]);this.header=new u,s.inflateGetHeader(this.strm,this.header)}function r(e,t){var n=new i(t);if(n.push(e,!0),n.err)throw n.msg||c[n.err];return n.result}var s=e("./zlib/inflate"),o=e("./utils/common"),a=e("./utils/strings"),l=e("./zlib/constants"),c=e("./zlib/messages"),h=e("./zlib/zstream"),u=e("./zlib/gzheader"),d=Object.prototype.toString;i.prototype.push=function(e,t){var n,i,r,c,h,u,p=this.strm,f=this.options.chunkSize,g=this.options.dictionary,m=!1;if(this.ended)return!1;i=t===~~t?t:!0===t?l.Z_FINISH:l.Z_NO_FLUSH,p.input="string"==typeof e?a.binstring2buf(e):"[object ArrayBuffer]"===d.call(e)?new Uint8Array(e):e,p.next_in=0,p.avail_in=p.input.length;do{if(0===p.avail_out&&(p.output=new o.Buf8(f),p.next_out=0,p.avail_out=f),(n=s.inflate(p,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&g&&(u="string"==typeof g?a.string2buf(g):"[object ArrayBuffer]"===d.call(g)?new Uint8Array(g):g,n=s.inflateSetDictionary(this.strm,u)),n===l.Z_BUF_ERROR&&!0===m&&(n=l.Z_OK,m=!1),n!==l.Z_STREAM_END&&n!==l.Z_OK)return this.onEnd(n),this.ended=!0,!1;p.next_out&&(0!==p.avail_out&&n!==l.Z_STREAM_END&&(0!==p.avail_in||i!==l.Z_FINISH&&i!==l.Z_SYNC_FLUSH)||("string"===this.options.to?(r=a.utf8border(p.output,p.next_out),c=p.next_out-r,h=a.buf2string(p.output,r),p.next_out=c,p.avail_out=f-c,c&&o.arraySet(p.output,p.output,r,c,0),this.onData(h)):this.onData(o.shrinkBuf(p.output,p.next_out)))),0===p.avail_in&&0===p.avail_out&&(m=!0)}while((p.avail_in>0||0===p.avail_out)&&n!==l.Z_STREAM_END);return n===l.Z_STREAM_END&&(i=l.Z_FINISH),i===l.Z_FINISH?(n=s.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===l.Z_OK):i!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),p.avail_out=0,!0)},i.prototype.onData=function(e){this.chunks.push(e)},i.prototype.onEnd=function(e){e===l.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):o.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=i,n.inflate=r,n.inflateRaw=function(e,t){return(t=t||{}).raw=!0,r(e,t)},n.ungzip=r},{"./utils/common":62,"./utils/strings":63,"./zlib/constants":65,"./zlib/gzheader":68,"./zlib/inflate":70,"./zlib/messages":72,"./zlib/zstream":74}],62:[function(e,t,n){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var r={arraySet:function(e,t,n,i,r){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+i),r);else for(var s=0;s<i;s++)e[r+s]=t[n+s]},flattenChunks:function(e){var t,n,i,r,s,o;for(i=0,t=0,n=e.length;t<n;t++)i+=e[t].length;for(o=new Uint8Array(i),r=0,t=0,n=e.length;t<n;t++)o.set(s=e[t],r),r+=s.length;return o}},s={arraySet:function(e,t,n,i,r){for(var s=0;s<i;s++)e[r+s]=t[n+s]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,r)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,s))},n.setTyped(i)},{}],63:[function(e,t,n){"use strict";function i(e,t){if(t<65537&&(e.subarray&&o||!e.subarray&&s))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var n="",i=0;i<t;i++)n+=String.fromCharCode(e[i]);return n}var r=e("./common"),s=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(c){s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(c){o=!1}for(var a=new r.Buf8(256),l=0;l<256;l++)a[l]=l>=252?6:l>=248?5:l>=240?4:l>=224?3:l>=192?2:1;a[254]=a[254]=1,n.string2buf=function(e){var t,n,i,s,o,a=e.length,l=0;for(s=0;s<a;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(i=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(i-56320),s++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=new r.Buf8(l),o=0,s=0;o<l;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<a&&56320==(64512&(i=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(i-56320),s++),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t},n.buf2binstring=function(e){return i(e,e.length)},n.binstring2buf=function(e){for(var t=new r.Buf8(e.length),n=0,i=t.length;n<i;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,r,s,o,l=t||e.length,c=new Array(2*l);for(r=0,n=0;n<l;)if((s=e[n++])<128)c[r++]=s;else if((o=a[s])>4)c[r++]=65533,n+=o-1;else{for(s&=2===o?31:3===o?15:7;o>1&&n<l;)s=s<<6|63&e[n++],o--;o>1?c[r++]=65533:s<65536?c[r++]=s:(c[r++]=55296|(s-=65536)>>10&1023,c[r++]=56320|1023&s)}return i(c,r)},n.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+a[e[n]]>t?n:t}},{"./common":62}],64:[function(e,t,n){"use strict";t.exports=function(e,t,n,i){for(var r=65535&e|0,s=e>>>16&65535|0,o=0;0!==n;){n-=o=n>2e3?2e3:n;do{s=s+(r=r+t[i++]|0)|0}while(--o);r%=65521,s%=65521}return r|s<<16|0}},{}],65:[function(e,t,n){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],66:[function(e,t,n){"use strict";var i=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t,n,r){var s=i,o=r+n;e^=-1;for(var a=r;a<o;a++)e=e>>>8^s[255&(e^t[a])];return-1^e}},{}],67:[function(e,t,n){"use strict";function i(e,t){return e.msg=T[t],t}function r(e){return(e<<1)-(e>4?9:0)}function s(e){for(var t=e.length;--t>=0;)e[t]=0}function o(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(x.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function a(e,t){E._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,o(e.strm)}function l(e,t){e.pending_buf[e.pending++]=t}function c(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function h(e,t,n,i){var r=e.avail_in;return r>i&&(r=i),0===r?0:(e.avail_in-=r,x.arraySet(t,e.input,e.next_in,r,n),1===e.state.wrap?e.adler=k(e.adler,t,r,n):2===e.state.wrap&&(e.adler=S(e.adler,t,r,n)),e.next_in+=r,e.total_in+=r,r)}function u(e,t){var n,i,r=e.max_chain_length,s=e.strstart,o=e.prev_length,a=e.nice_match,l=e.strstart>e.w_size-Z?e.strstart-(e.w_size-Z):0,c=e.window,h=e.w_mask,u=e.prev,d=e.strstart+G,p=c[s+o-1],f=c[s+o];e.prev_length>=e.good_match&&(r>>=2),a>e.lookahead&&(a=e.lookahead);do{if(c[(n=t)+o]===f&&c[n+o-1]===p&&c[n]===c[s]&&c[++n]===c[s+1]){s+=2,n++;do{}while(c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&s<d);if(i=G-(d-s),s=d-G,i>o){if(e.match_start=t,o=i,i>=a)break;p=c[s+o-1],f=c[s+o]}}}while((t=u[t&h])>l&&0!=--r);return o<=e.lookahead?o:e.lookahead}function d(e){var t,n,i,r,s,o=e.w_size;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=o+(o-Z)){x.arraySet(e.window,e.window,o,o,0),e.match_start-=o,e.strstart-=o,e.block_start-=o,t=n=e.hash_size;do{i=e.head[--t],e.head[t]=i>=o?i-o:0}while(--n);t=n=o;do{i=e.prev[--t],e.prev[t]=i>=o?i-o:0}while(--n);r+=o}if(0===e.strm.avail_in)break;if(n=h(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=V)for(e.ins_h=e.window[s=e.strstart-e.insert],e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+V-1])&e.hash_mask,e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<V)););}while(e.lookahead<Z&&0!==e.strm.avail_in)}function p(e,t){for(var n,i;;){if(e.lookahead<Z){if(d(e),e.lookahead<Z&&t===O)return q;if(0===e.lookahead)break}if(n=0,e.lookahead>=V&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+V-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-Z&&(e.match_length=u(e,n)),e.match_length>=V)if(i=E._tr_tally(e,e.strstart-e.match_start,e.match_length-V),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=V){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+V-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=E._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(a(e,!1),0===e.strm.avail_out))return q}return e.insert=e.strstart<V-1?e.strstart:V-1,t===I?(a(e,!0),0===e.strm.avail_out?X:K):e.last_lit&&(a(e,!1),0===e.strm.avail_out)?q:$}function f(e,t){for(var n,i,r;;){if(e.lookahead<Z){if(d(e),e.lookahead<Z&&t===O)return q;if(0===e.lookahead)break}if(n=0,e.lookahead>=V&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+V-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=V-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-Z&&(e.match_length=u(e,n),e.match_length<=5&&(e.strategy===D||e.match_length===V&&e.strstart-e.match_start>4096)&&(e.match_length=V-1)),e.prev_length>=V&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-V,i=E._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-V),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=r&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+V-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=V-1,e.strstart++,i&&(a(e,!1),0===e.strm.avail_out))return q}else if(e.match_available){if((i=E._tr_tally(e,0,e.window[e.strstart-1]))&&a(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return q}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=E._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<V-1?e.strstart:V-1,t===I?(a(e,!0),0===e.strm.avail_out?X:K):e.last_lit&&(a(e,!1),0===e.strm.avail_out)?q:$}function g(e,t){for(var n,i,r,s,o=e.window;;){if(e.lookahead<=G){if(d(e),e.lookahead<=G&&t===O)return q;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=V&&e.strstart>0&&(i=o[r=e.strstart-1])===o[++r]&&i===o[++r]&&i===o[++r]){s=e.strstart+G;do{}while(i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&r<s);e.match_length=G-(s-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=V?(n=E._tr_tally(e,1,e.match_length-V),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=E._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(a(e,!1),0===e.strm.avail_out))return q}return e.insert=0,t===I?(a(e,!0),0===e.strm.avail_out?X:K):e.last_lit&&(a(e,!1),0===e.strm.avail_out)?q:$}function m(e,t){for(var n;;){if(0===e.lookahead&&(d(e),0===e.lookahead)){if(t===O)return q;break}if(e.match_length=0,n=E._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(a(e,!1),0===e.strm.avail_out))return q}return e.insert=0,t===I?(a(e,!0),0===e.strm.avail_out?X:K):e.last_lit&&(a(e,!1),0===e.strm.avail_out)?q:$}function b(e,t,n,i,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=r}function y(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=N,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new x.Buf16(2*U),this.dyn_dtree=new x.Buf16(2*(2*B+1)),this.bl_tree=new x.Buf16(2*(2*j+1)),s(this.dyn_ltree),s(this.dyn_dtree),s(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new x.Buf16(H+1),this.heap=new x.Buf16(2*L+1),s(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new x.Buf16(2*L+1),s(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function v(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=F,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?W:Y,e.adler=2===t.wrap?0:1,t.last_flush=O,E._tr_init(t),M):i(e,A)}function _(e){var t=v(e);return t===M&&function(e){e.window_size=2*e.w_size,s(e.head),e.max_lazy_match=C[e.level].max_lazy,e.good_match=C[e.level].good_length,e.nice_match=C[e.level].nice_length,e.max_chain_length=C[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=V-1,e.match_available=0,e.ins_h=0}(e.state),t}function w(e,t,n,r,s,o){if(!e)return A;var a=1;if(t===P&&(t=6),r<0?(a=0,r=-r):r>15&&(a=2,r-=16),s<1||s>z||n!==N||r<8||r>15||t<0||t>9||o<0||o>R)return i(e,A);8===r&&(r=9);var l=new y;return e.state=l,l.strm=e,l.wrap=a,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=s+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+V-1)/V),l.window=new x.Buf8(2*l.w_size),l.head=new x.Buf16(l.hash_size),l.prev=new x.Buf16(l.w_size),l.lit_bufsize=1<<s+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new x.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=o,l.method=n,_(e)}var C,x=e("../utils/common"),E=e("./trees"),k=e("./adler32"),S=e("./crc32"),T=e("./messages"),O=0,I=4,M=0,A=-2,P=-1,D=1,R=4,F=2,N=8,z=9,L=286,B=30,j=19,U=2*L+1,H=15,V=3,G=258,Z=G+V+1,W=42,Y=113,q=1,$=2,X=3,K=4;C=[new b(0,0,0,0,function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(d(e),0===e.lookahead&&t===O)return q;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+n;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,a(e,!1),0===e.strm.avail_out))return q;if(e.strstart-e.block_start>=e.w_size-Z&&(a(e,!1),0===e.strm.avail_out))return q}return e.insert=0,t===I?(a(e,!0),0===e.strm.avail_out?X:K):(e.strstart>e.block_start&&a(e,!1),q)}),new b(4,4,8,4,p),new b(4,5,16,8,p),new b(4,6,32,32,p),new b(4,4,16,16,f),new b(8,16,32,32,f),new b(8,16,128,128,f),new b(8,32,128,256,f),new b(32,128,258,1024,f),new b(32,258,258,4096,f)],n.deflateInit=function(e,t){return w(e,t,N,15,8,0)},n.deflateInit2=w,n.deflateReset=_,n.deflateResetKeep=v,n.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?A:(e.state.gzhead=t,M):A},n.deflate=function(e,t){var n,a,h,u;if(!e||!e.state||t>5||t<0)return e?i(e,A):A;if(a=e.state,!e.output||!e.input&&0!==e.avail_in||666===a.status&&t!==I)return i(e,0===e.avail_out?-5:A);if(a.strm=e,n=a.last_flush,a.last_flush=t,a.status===W)if(2===a.wrap)e.adler=0,l(a,31),l(a,139),l(a,8),a.gzhead?(l(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),l(a,255&a.gzhead.time),l(a,a.gzhead.time>>8&255),l(a,a.gzhead.time>>16&255),l(a,a.gzhead.time>>24&255),l(a,9===a.level?2:a.strategy>=2||a.level<2?4:0),l(a,255&a.gzhead.os),a.gzhead.extra&&a.gzhead.extra.length&&(l(a,255&a.gzhead.extra.length),l(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(e.adler=S(e.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=69):(l(a,0),l(a,0),l(a,0),l(a,0),l(a,0),l(a,9===a.level?2:a.strategy>=2||a.level<2?4:0),l(a,3),a.status=Y);else{var d=N+(a.w_bits-8<<4)<<8;d|=(a.strategy>=2||a.level<2?0:a.level<6?1:6===a.level?2:3)<<6,0!==a.strstart&&(d|=32),d+=31-d%31,a.status=Y,c(a,d),0!==a.strstart&&(c(a,e.adler>>>16),c(a,65535&e.adler)),e.adler=1}if(69===a.status)if(a.gzhead.extra){for(h=a.pending;a.gzindex<(65535&a.gzhead.extra.length)&&(a.pending!==a.pending_buf_size||(a.gzhead.hcrc&&a.pending>h&&(e.adler=S(e.adler,a.pending_buf,a.pending-h,h)),o(e),h=a.pending,a.pending!==a.pending_buf_size));)l(a,255&a.gzhead.extra[a.gzindex]),a.gzindex++;a.gzhead.hcrc&&a.pending>h&&(e.adler=S(e.adler,a.pending_buf,a.pending-h,h)),a.gzindex===a.gzhead.extra.length&&(a.gzindex=0,a.status=73)}else a.status=73;if(73===a.status)if(a.gzhead.name){h=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>h&&(e.adler=S(e.adler,a.pending_buf,a.pending-h,h)),o(e),h=a.pending,a.pending===a.pending_buf_size)){u=1;break}u=a.gzindex<a.gzhead.name.length?255&a.gzhead.name.charCodeAt(a.gzindex++):0,l(a,u)}while(0!==u);a.gzhead.hcrc&&a.pending>h&&(e.adler=S(e.adler,a.pending_buf,a.pending-h,h)),0===u&&(a.gzindex=0,a.status=91)}else a.status=91;if(91===a.status)if(a.gzhead.comment){h=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>h&&(e.adler=S(e.adler,a.pending_buf,a.pending-h,h)),o(e),h=a.pending,a.pending===a.pending_buf_size)){u=1;break}u=a.gzindex<a.gzhead.comment.length?255&a.gzhead.comment.charCodeAt(a.gzindex++):0,l(a,u)}while(0!==u);a.gzhead.hcrc&&a.pending>h&&(e.adler=S(e.adler,a.pending_buf,a.pending-h,h)),0===u&&(a.status=103)}else a.status=103;if(103===a.status&&(a.gzhead.hcrc?(a.pending+2>a.pending_buf_size&&o(e),a.pending+2<=a.pending_buf_size&&(l(a,255&e.adler),l(a,e.adler>>8&255),e.adler=0,a.status=Y)):a.status=Y),0!==a.pending){if(o(e),0===e.avail_out)return a.last_flush=-1,M}else if(0===e.avail_in&&r(t)<=r(n)&&t!==I)return i(e,-5);if(666===a.status&&0!==e.avail_in)return i(e,-5);if(0!==e.avail_in||0!==a.lookahead||t!==O&&666!==a.status){var p=2===a.strategy?m(a,t):3===a.strategy?g(a,t):C[a.level].func(a,t);if(p!==X&&p!==K||(a.status=666),p===q||p===X)return 0===e.avail_out&&(a.last_flush=-1),M;if(p===$&&(1===t?E._tr_align(a):5!==t&&(E._tr_stored_block(a,0,0,!1),3===t&&(s(a.head),0===a.lookahead&&(a.strstart=0,a.block_start=0,a.insert=0))),o(e),0===e.avail_out))return a.last_flush=-1,M}return t!==I?M:a.wrap<=0?1:(2===a.wrap?(l(a,255&e.adler),l(a,e.adler>>8&255),l(a,e.adler>>16&255),l(a,e.adler>>24&255),l(a,255&e.total_in),l(a,e.total_in>>8&255),l(a,e.total_in>>16&255),l(a,e.total_in>>24&255)):(c(a,e.adler>>>16),c(a,65535&e.adler)),o(e),a.wrap>0&&(a.wrap=-a.wrap),0!==a.pending?M:1)},n.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==W&&69!==t&&73!==t&&91!==t&&103!==t&&t!==Y&&666!==t?i(e,A):(e.state=null,t===Y?i(e,-3):M):A},n.deflateSetDictionary=function(e,t){var n,i,r,o,a,l,c,h,u=t.length;if(!e||!e.state)return A;if(2===(o=(n=e.state).wrap)||1===o&&n.status!==W||n.lookahead)return A;for(1===o&&(e.adler=k(e.adler,t,u,0)),n.wrap=0,u>=n.w_size&&(0===o&&(s(n.head),n.strstart=0,n.block_start=0,n.insert=0),h=new x.Buf8(n.w_size),x.arraySet(h,t,u-n.w_size,n.w_size,0),t=h,u=n.w_size),a=e.avail_in,l=e.next_in,c=e.input,e.avail_in=u,e.next_in=0,e.input=t,d(n);n.lookahead>=V;){i=n.strstart,r=n.lookahead-(V-1);do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[i+V-1])&n.hash_mask,n.prev[i&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=i,i++}while(--r);n.strstart=i,n.lookahead=V-1,d(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=V-1,n.match_available=0,e.next_in=l,e.input=c,e.avail_in=a,n.wrap=o,M},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":62,"./adler32":64,"./crc32":66,"./messages":72,"./trees":73}],68:[function(e,t,n){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],69:[function(e,t,n){"use strict";t.exports=function(e,t){var n,i,r,s,o,a,l,c,h,u,d,p,f,g,m,b,y,v,_,w,C,x,E,k,S;k=e.input,r=(i=e.next_in)+(e.avail_in-5),S=e.output,o=(s=e.next_out)-(t-e.avail_out),a=s+(e.avail_out-257),l=(n=e.state).dmax,c=n.wsize,h=n.whave,u=n.wnext,d=n.window,p=n.hold,f=n.bits,g=n.lencode,m=n.distcode,b=(1<<n.lenbits)-1,y=(1<<n.distbits)-1;e:do{f<15&&(p+=k[i++]<<f,p+=k[i++]<<(f+=8),f+=8),v=g[p&b];t:for(;;){if(p>>>=_=v>>>24,f-=_,0==(_=v>>>16&255))S[s++]=65535&v;else{if(!(16&_)){if(0==(64&_)){v=g[(65535&v)+(p&(1<<_)-1)];continue t}if(32&_){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}w=65535&v,(_&=15)&&(f<_&&(p+=k[i++]<<f,f+=8),w+=p&(1<<_)-1,p>>>=_,f-=_),f<15&&(p+=k[i++]<<f,p+=k[i++]<<(f+=8),f+=8),v=m[p&y];n:for(;;){if(p>>>=_=v>>>24,f-=_,!(16&(_=v>>>16&255))){if(0==(64&_)){v=m[(65535&v)+(p&(1<<_)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(C=65535&v,f<(_&=15)&&(p+=k[i++]<<f,(f+=8)<_&&(p+=k[i++]<<f,f+=8)),(C+=p&(1<<_)-1)>l){e.msg="invalid distance too far back",n.mode=30;break e}if(p>>>=_,f-=_,C>(_=s-o)){if((_=C-_)>h&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(x=0,E=d,0===u){if(x+=c-_,_<w){w-=_;do{S[s++]=d[x++]}while(--_);x=s-C,E=S}}else if(u<_){if(x+=c+u-_,(_-=u)<w){w-=_;do{S[s++]=d[x++]}while(--_);if(x=0,u<w){w-=_=u;do{S[s++]=d[x++]}while(--_);x=s-C,E=S}}}else if(x+=u-_,_<w){w-=_;do{S[s++]=d[x++]}while(--_);x=s-C,E=S}for(;w>2;)S[s++]=E[x++],S[s++]=E[x++],S[s++]=E[x++],w-=3;w&&(S[s++]=E[x++],w>1&&(S[s++]=E[x++]))}else{x=s-C;do{S[s++]=S[x++],S[s++]=S[x++],S[s++]=S[x++],w-=3}while(w>2);w&&(S[s++]=S[x++],w>1&&(S[s++]=S[x++]))}break}}break}}while(i<r&&s<a);p&=(1<<(f-=(w=f>>3)<<3))-1,e.next_in=i-=w,e.next_out=s,e.avail_in=i<r?r-i+5:5-(i-r),e.avail_out=s<a?a-s+257:257-(s-a),n.hold=p,n.bits=f}},{}],70:[function(e,t,n){"use strict";function i(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function r(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new p.Buf16(320),this.work=new p.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function s(e){var t;return e&&e.state?(e.total_in=e.total_out=(t=e.state).total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=C,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new p.Buf32(E),t.distcode=t.distdyn=new p.Buf32(k),t.sane=1,t.back=-1,_):w}function o(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,s(e)):w}function a(e,t){var n,i;return e&&e.state?(i=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?w:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,o(e))):w}function l(e,t){var n,i;return e?(i=new r,e.state=i,i.window=null,(n=a(e,t))!==_&&(e.state=null),n):w}function c(e){if(S){var t;for(u=new p.Buf32(512),d=new p.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(b(y,e.lens,0,288,u,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;b(v,e.lens,0,32,d,0,e.work,{bits:5}),S=!1}e.lencode=u,e.lenbits=9,e.distcode=d,e.distbits=5}function h(e,t,n,i){var r,s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new p.Buf8(s.wsize)),i>=s.wsize?(p.arraySet(s.window,t,n-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):((r=s.wsize-s.wnext)>i&&(r=i),p.arraySet(s.window,t,n-i,r,s.wnext),(i-=r)?(p.arraySet(s.window,t,n-i,i,0),s.wnext=i,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0}var u,d,p=e("../utils/common"),f=e("./adler32"),g=e("./crc32"),m=e("./inffast"),b=e("./inftrees"),y=1,v=2,_=0,w=-2,C=1,x=12,E=852,k=592,S=!0;n.inflateReset=o,n.inflateReset2=a,n.inflateResetKeep=s,n.inflateInit=function(e){return l(e,15)},n.inflateInit2=l,n.inflate=function(e,t){var n,r,s,o,a,l,u,d,E,k,S,T,O,I,M,A,P,D,R,F,N,z,L,B,j=0,U=new p.Buf8(4),H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return w;(n=e.state).mode===x&&(n.mode=13),a=e.next_out,s=e.output,o=e.next_in,r=e.input,d=n.hold,E=n.bits,k=l=e.avail_in,S=u=e.avail_out,z=_;e:for(;;)switch(n.mode){case C:if(0===n.wrap){n.mode=13;break}for(;E<16;){if(0===l)break e;l--,d+=r[o++]<<E,E+=8}if(2&n.wrap&&35615===d){n.check=0,U[0]=255&d,U[1]=d>>>8&255,n.check=g(n.check,U,2,0),d=0,E=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&d)<<8)+(d>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&d)){e.msg="unknown compression method",n.mode=30;break}if(E-=4,N=8+(15&(d>>>=4)),0===n.wbits)n.wbits=N;else if(N>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<N,e.adler=n.check=1,n.mode=512&d?10:x,d=0,E=0;break;case 2:for(;E<16;){if(0===l)break e;l--,d+=r[o++]<<E,E+=8}if(n.flags=d,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=d>>8&1),512&n.flags&&(U[0]=255&d,U[1]=d>>>8&255,n.check=g(n.check,U,2,0)),d=0,E=0,n.mode=3;case 3:for(;E<32;){if(0===l)break e;l--,d+=r[o++]<<E,E+=8}n.head&&(n.head.time=d),512&n.flags&&(U[0]=255&d,U[1]=d>>>8&255,U[2]=d>>>16&255,U[3]=d>>>24&255,n.check=g(n.check,U,4,0)),d=0,E=0,n.mode=4;case 4:for(;E<16;){if(0===l)break e;l--,d+=r[o++]<<E,E+=8}n.head&&(n.head.xflags=255&d,n.head.os=d>>8),512&n.flags&&(U[0]=255&d,U[1]=d>>>8&255,n.check=g(n.check,U,2,0)),d=0,E=0,n.mode=5;case 5:if(1024&n.flags){for(;E<16;){if(0===l)break e;l--,d+=r[o++]<<E,E+=8}n.length=d,n.head&&(n.head.extra_len=d),512&n.flags&&(U[0]=255&d,U[1]=d>>>8&255,n.check=g(n.check,U,2,0)),d=0,E=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((T=n.length)>l&&(T=l),T&&(n.head&&(N=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),p.arraySet(n.head.extra,r,o,T,N)),512&n.flags&&(n.check=g(n.check,r,T,o)),l-=T,o+=T,n.length-=T),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===l)break e;T=0;do{N=r[o+T++],n.head&&N&&n.length<65536&&(n.head.name+=String.fromCharCode(N))}while(N&&T<l);if(512&n.flags&&(n.check=g(n.check,r,T,o)),l-=T,o+=T,N)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===l)break e;T=0;do{N=r[o+T++],n.head&&N&&n.length<65536&&(n.head.comment+=String.fromCharCode(N))}while(N&&T<l);if(512&n.flags&&(n.check=g(n.check,r,T,o)),l-=T,o+=T,N)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;E<16;){if(0===l)break e;l--,d+=r[o++]<<E,E+=8}if(d!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}d=0,E=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=x;break;case 10:for(;E<32;){if(0===l)break e;l--,d+=r[o++]<<E,E+=8}e.adler=n.check=i(d),d=0,E=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=a,e.avail_out=u,e.next_in=o,e.avail_in=l,n.hold=d,n.bits=E,2;e.adler=n.check=1,n.mode=x;case x:if(5===t||6===t)break e;case 13:if(n.last){d>>>=7&E,E-=7&E,n.mode=27;break}for(;E<3;){if(0===l)break e;l--,d+=r[o++]<<E,E+=8}switch(n.last=1&d,E-=1,3&(d>>>=1)){case 0:n.mode=14;break;case 1:if(c(n),n.mode=20,6===t){d>>>=2,E-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}d>>>=2,E-=2;break;case 14:for(d>>>=7&E,E-=7&E;E<32;){if(0===l)break e;l--,d+=r[o++]<<E,E+=8}if((65535&d)!=(d>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&d,d=0,E=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(T=n.length){if(T>l&&(T=l),T>u&&(T=u),0===T)break e;p.arraySet(s,r,o,T,a),l-=T,o+=T,u-=T,a+=T,n.length-=T;break}n.mode=x;break;case 17:for(;E<14;){if(0===l)break e;l--,d+=r[o++]<<E,E+=8}if(n.nlen=257+(31&d),E-=5,n.ndist=1+(31&(d>>>=5)),E-=5,n.ncode=4+(15&(d>>>=5)),d>>>=4,E-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;E<3;){if(0===l)break e;l--,d+=r[o++]<<E,E+=8}n.lens[H[n.have++]]=7&d,d>>>=3,E-=3}for(;n.have<19;)n.lens[H[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,z=b(0,n.lens,0,19,n.lencode,0,n.work,L={bits:n.lenbits}),n.lenbits=L.bits,z){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;A=(j=n.lencode[d&(1<<n.lenbits)-1])>>>16&255,P=65535&j,!((M=j>>>24)<=E);){if(0===l)break e;l--,d+=r[o++]<<E,E+=8}if(P<16)d>>>=M,E-=M,n.lens[n.have++]=P;else{if(16===P){for(B=M+2;E<B;){if(0===l)break e;l--,d+=r[o++]<<E,E+=8}if(d>>>=M,E-=M,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}N=n.lens[n.have-1],T=3+(3&d),d>>>=2,E-=2}else if(17===P){for(B=M+3;E<B;){if(0===l)break e;l--,d+=r[o++]<<E,E+=8}E-=M,N=0,T=3+(7&(d>>>=M)),d>>>=3,E-=3}else{for(B=M+7;E<B;){if(0===l)break e;l--,d+=r[o++]<<E,E+=8}E-=M,N=0,T=11+(127&(d>>>=M)),d>>>=7,E-=7}if(n.have+T>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;T--;)n.lens[n.have++]=N}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,z=b(y,n.lens,0,n.nlen,n.lencode,0,n.work,L={bits:n.lenbits}),n.lenbits=L.bits,z){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,z=b(v,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,L={bits:n.distbits}),n.distbits=L.bits,z){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(l>=6&&u>=258){e.next_out=a,e.avail_out=u,e.next_in=o,e.avail_in=l,n.hold=d,n.bits=E,m(e,S),a=e.next_out,s=e.output,u=e.avail_out,o=e.next_in,r=e.input,l=e.avail_in,d=n.hold,E=n.bits,n.mode===x&&(n.back=-1);break}for(n.back=0;A=(j=n.lencode[d&(1<<n.lenbits)-1])>>>16&255,P=65535&j,!((M=j>>>24)<=E);){if(0===l)break e;l--,d+=r[o++]<<E,E+=8}if(A&&0==(240&A)){for(D=M,R=A,F=P;A=(j=n.lencode[F+((d&(1<<D+R)-1)>>D)])>>>16&255,P=65535&j,!(D+(M=j>>>24)<=E);){if(0===l)break e;l--,d+=r[o++]<<E,E+=8}d>>>=D,E-=D,n.back+=D}if(d>>>=M,E-=M,n.back+=M,n.length=P,0===A){n.mode=26;break}if(32&A){n.back=-1,n.mode=x;break}if(64&A){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&A,n.mode=22;case 22:if(n.extra){for(B=n.extra;E<B;){if(0===l)break e;l--,d+=r[o++]<<E,E+=8}n.length+=d&(1<<n.extra)-1,d>>>=n.extra,E-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;A=(j=n.distcode[d&(1<<n.distbits)-1])>>>16&255,P=65535&j,!((M=j>>>24)<=E);){if(0===l)break e;l--,d+=r[o++]<<E,E+=8}if(0==(240&A)){for(D=M,R=A,F=P;A=(j=n.distcode[F+((d&(1<<D+R)-1)>>D)])>>>16&255,P=65535&j,!(D+(M=j>>>24)<=E);){if(0===l)break e;l--,d+=r[o++]<<E,E+=8}d>>>=D,E-=D,n.back+=D}if(d>>>=M,E-=M,n.back+=M,64&A){e.msg="invalid distance code",n.mode=30;break}n.offset=P,n.extra=15&A,n.mode=24;case 24:if(n.extra){for(B=n.extra;E<B;){if(0===l)break e;l--,d+=r[o++]<<E,E+=8}n.offset+=d&(1<<n.extra)-1,d>>>=n.extra,E-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===u)break e;if(n.offset>(T=S-u)){if((T=n.offset-T)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}O=T>n.wnext?n.wsize-(T-=n.wnext):n.wnext-T,T>n.length&&(T=n.length),I=n.window}else I=s,O=a-n.offset,T=n.length;T>u&&(T=u),u-=T,n.length-=T;do{s[a++]=I[O++]}while(--T);0===n.length&&(n.mode=21);break;case 26:if(0===u)break e;s[a++]=n.length,u--,n.mode=21;break;case 27:if(n.wrap){for(;E<32;){if(0===l)break e;l--,d|=r[o++]<<E,E+=8}if(e.total_out+=S-=u,n.total+=S,S&&(e.adler=n.check=n.flags?g(n.check,s,S,a-S):f(n.check,s,S,a-S)),S=u,(n.flags?d:i(d))!==n.check){e.msg="incorrect data check",n.mode=30;break}d=0,E=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;E<32;){if(0===l)break e;l--,d+=r[o++]<<E,E+=8}if(d!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}d=0,E=0}n.mode=29;case 29:z=1;break e;case 30:z=-3;break e;case 31:return-4;case 32:default:return w}return e.next_out=a,e.avail_out=u,e.next_in=o,e.avail_in=l,n.hold=d,n.bits=E,(n.wsize||S!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&h(e,e.output,e.next_out,S-e.avail_out)?(n.mode=31,-4):(S-=e.avail_out,e.total_in+=k-=e.avail_in,e.total_out+=S,n.total+=S,n.wrap&&S&&(e.adler=n.check=n.flags?g(n.check,s,S,e.next_out-S):f(n.check,s,S,e.next_out-S)),e.data_type=n.bits+(n.last?64:0)+(n.mode===x?128:0)+(20===n.mode||15===n.mode?256:0),(0===k&&0===S||4===t)&&z===_&&(z=-5),z)},n.inflateEnd=function(e){if(!e||!e.state)return w;var t=e.state;return t.window&&(t.window=null),e.state=null,_},n.inflateGetHeader=function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?w:(n.head=t,t.done=!1,_):w},n.inflateSetDictionary=function(e,t){var n,i=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?w:11===n.mode&&f(1,t,i,0)!==n.check?-3:h(e,t,i,i)?(n.mode=31,-4):(n.havedict=1,_):w},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":62,"./adler32":64,"./crc32":66,"./inffast":69,"./inftrees":71}],71:[function(e,t,n){"use strict";var i=e("../utils/common"),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,l,c,h,u,d){var p,f,g,m,b,y,v,_,w,C=d.bits,x=0,E=0,k=0,S=0,T=0,O=0,I=0,M=0,A=0,P=0,D=null,R=0,F=new i.Buf16(16),N=new i.Buf16(16),z=null,L=0;for(x=0;x<=15;x++)F[x]=0;for(E=0;E<l;E++)F[t[n+E]]++;for(T=C,S=15;S>=1&&0===F[S];S--);if(T>S&&(T=S),0===S)return c[h++]=20971520,c[h++]=20971520,d.bits=1,0;for(k=1;k<S&&0===F[k];k++);for(T<k&&(T=k),M=1,x=1;x<=15;x++)if(M<<=1,(M-=F[x])<0)return-1;if(M>0&&(0===e||1!==S))return-1;for(N[1]=0,x=1;x<15;x++)N[x+1]=N[x]+F[x];for(E=0;E<l;E++)0!==t[n+E]&&(u[N[t[n+E]]++]=E);if(0===e?(D=z=u,y=19):1===e?(D=r,R-=257,z=s,L-=257,y=256):(D=o,z=a,y=-1),P=0,E=0,x=k,b=h,O=T,I=0,g=-1,m=(A=1<<T)-1,1===e&&A>852||2===e&&A>592)return 1;for(;;){v=x-I,u[E]<y?(_=0,w=u[E]):u[E]>y?(_=z[L+u[E]],w=D[R+u[E]]):(_=96,w=0),p=1<<x-I,k=f=1<<O;do{c[b+(P>>I)+(f-=p)]=v<<24|_<<16|w|0}while(0!==f);for(p=1<<x-1;P&p;)p>>=1;if(0!==p?(P&=p-1,P+=p):P=0,E++,0==--F[x]){if(x===S)break;x=t[n+u[E]]}if(x>T&&(P&m)!==g){for(0===I&&(I=T),b+=k,M=1<<(O=x-I);O+I<S&&!((M-=F[O+I])<=0);)O++,M<<=1;if(A+=1<<O,1===e&&A>852||2===e&&A>592)return 1;c[g=P&m]=T<<24|O<<16|b-h|0}}return 0!==P&&(c[b+P]=x-I<<24|64<<16|0),d.bits=T,0}},{"../utils/common":62}],72:[function(e,t,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],73:[function(e,t,n){"use strict";function i(e){for(var t=e.length;--t>=0;)e[t]=0}function r(e,t,n,i,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=e&&e.length}function s(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function o(e){return e<256?j[e]:j[256+(e>>>7)]}function a(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function l(e,t,n){e.bi_valid>I-n?(e.bi_buf|=t<<e.bi_valid&65535,a(e,e.bi_buf),e.bi_buf=t>>I-e.bi_valid,e.bi_valid+=n-I):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function c(e,t,n){l(e,n[2*t],n[2*t+1])}function h(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function u(e,t,n){var i,r,s=new Array(O+1),o=0;for(i=1;i<=O;i++)s[i]=o=o+n[i-1]<<1;for(r=0;r<=t;r++){var a=e[2*r+1];0!==a&&(e[2*r]=h(s[a]++,a))}}function d(e){var t;for(t=0;t<E;t++)e.dyn_ltree[2*t]=0;for(t=0;t<k;t++)e.dyn_dtree[2*t]=0;for(t=0;t<S;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*M]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function p(e){e.bi_valid>8?a(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function f(e,t,n,i){var r=2*t,s=2*n;return e[r]<e[s]||e[r]===e[s]&&i[t]<=i[n]}function g(e,t,n){for(var i=e.heap[n],r=n<<1;r<=e.heap_len&&(r<e.heap_len&&f(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!f(t,i,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=i}function m(e,t,n){var i,r,s,a,h=0;if(0!==e.last_lit)do{i=e.pending_buf[e.d_buf+2*h]<<8|e.pending_buf[e.d_buf+2*h+1],r=e.pending_buf[e.l_buf+h],h++,0===i?c(e,r,t):(c(e,(s=U[r])+x+1,t),0!==(a=R[s])&&l(e,r-=H[s],a),c(e,s=o(--i),n),0!==(a=F[s])&&l(e,i-=V[s],a))}while(h<e.last_lit);c(e,M,t)}function b(e,t){var n,i,r,s=t.dyn_tree,o=t.stat_desc.static_tree,a=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=T,n=0;n<l;n++)0!==s[2*n]?(e.heap[++e.heap_len]=c=n,e.depth[n]=0):s[2*n+1]=0;for(;e.heap_len<2;)s[2*(r=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[r]=0,e.opt_len--,a&&(e.static_len-=o[2*r+1]);for(t.max_code=c,n=e.heap_len>>1;n>=1;n--)g(e,s,n);r=l;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],g(e,s,1),i=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=i,s[2*r]=s[2*n]+s[2*i],e.depth[r]=(e.depth[n]>=e.depth[i]?e.depth[n]:e.depth[i])+1,s[2*n+1]=s[2*i+1]=r,e.heap[1]=r++,g(e,s,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,i,r,s,o,a,l=t.dyn_tree,c=t.max_code,h=t.stat_desc.static_tree,u=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,f=t.stat_desc.max_length,g=0;for(s=0;s<=O;s++)e.bl_count[s]=0;for(l[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<T;n++)(s=l[2*l[2*(i=e.heap[n])+1]+1]+1)>f&&(s=f,g++),l[2*i+1]=s,i>c||(e.bl_count[s]++,o=0,i>=p&&(o=d[i-p]),e.opt_len+=(a=l[2*i])*(s+o),u&&(e.static_len+=a*(h[2*i+1]+o)));if(0!==g){do{for(s=f-1;0===e.bl_count[s];)s--;e.bl_count[s]--,e.bl_count[s+1]+=2,e.bl_count[f]--,g-=2}while(g>0);for(s=f;0!==s;s--)for(i=e.bl_count[s];0!==i;)(r=e.heap[--n])>c||(l[2*r+1]!==s&&(e.opt_len+=(s-l[2*r+1])*l[2*r],l[2*r+1]=s),i--)}}(e,t),u(s,c,e.bl_count)}function y(e,t,n){var i,r,s=-1,o=t[1],a=0,l=7,c=4;for(0===o&&(l=138,c=3),t[2*(n+1)+1]=65535,i=0;i<=n;i++)r=o,o=t[2*(i+1)+1],++a<l&&r===o||(a<c?e.bl_tree[2*r]+=a:0!==r?(r!==s&&e.bl_tree[2*r]++,e.bl_tree[2*A]++):a<=10?e.bl_tree[2*P]++:e.bl_tree[2*D]++,a=0,s=r,0===o?(l=138,c=3):r===o?(l=6,c=3):(l=7,c=4))}function v(e,t,n){var i,r,s=-1,o=t[1],a=0,h=7,u=4;for(0===o&&(h=138,u=3),i=0;i<=n;i++)if(r=o,o=t[2*(i+1)+1],!(++a<h&&r===o)){if(a<u)do{c(e,r,e.bl_tree)}while(0!=--a);else 0!==r?(r!==s&&(c(e,r,e.bl_tree),a--),c(e,A,e.bl_tree),l(e,a-3,2)):a<=10?(c(e,P,e.bl_tree),l(e,a-3,3)):(c(e,D,e.bl_tree),l(e,a-11,7));a=0,s=r,0===o?(h=138,u=3):r===o?(h=6,u=3):(h=7,u=4)}}function _(e,t,n,i){l(e,(C<<1)+(i?1:0),3),function(e,t,n,i){p(e),a(e,n),a(e,~n),w.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n)}var w=e("../utils/common"),C=0,x=256,E=x+1+29,k=30,S=19,T=2*E+1,O=15,I=16,M=256,A=16,P=17,D=18,R=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],F=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],N=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],L=new Array(2*(E+2));i(L);var B=new Array(2*k);i(B);var j=new Array(512);i(j);var U=new Array(256);i(U);var H=new Array(29);i(H);var V=new Array(k);i(V);var G,Z,W,Y=!1;n._tr_init=function(e){Y||(function(){var e,t,n,i,s,o=new Array(O+1);for(n=0,i=0;i<28;i++)for(H[i]=n,e=0;e<1<<R[i];e++)U[n++]=i;for(U[n-1]=i,s=0,i=0;i<16;i++)for(V[i]=s,e=0;e<1<<F[i];e++)j[s++]=i;for(s>>=7;i<k;i++)for(V[i]=s<<7,e=0;e<1<<F[i]-7;e++)j[256+s++]=i;for(t=0;t<=O;t++)o[t]=0;for(e=0;e<=143;)L[2*e+1]=8,e++,o[8]++;for(;e<=255;)L[2*e+1]=9,e++,o[9]++;for(;e<=279;)L[2*e+1]=7,e++,o[7]++;for(;e<=287;)L[2*e+1]=8,e++,o[8]++;for(u(L,E+1,o),e=0;e<k;e++)B[2*e+1]=5,B[2*e]=h(e,5);G=new r(L,R,x+1,E,O),Z=new r(B,F,0,k,O),W=new r(new Array(0),N,0,S,7)}(),Y=!0),e.l_desc=new s(e.dyn_ltree,G),e.d_desc=new s(e.dyn_dtree,Z),e.bl_desc=new s(e.bl_tree,W),e.bi_buf=0,e.bi_valid=0,d(e)},n._tr_stored_block=_,n._tr_flush_block=function(e,t,n,i){var r,s,o=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<x;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),b(e,e.l_desc),b(e,e.d_desc),o=function(e){var t;for(y(e,e.dyn_ltree,e.l_desc.max_code),y(e,e.dyn_dtree,e.d_desc.max_code),b(e,e.bl_desc),t=S-1;t>=3&&0===e.bl_tree[2*z[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),(s=e.static_len+3+7>>>3)<=(r=e.opt_len+3+7>>>3)&&(r=s)):r=s=n+5,n+4<=r&&-1!==t?_(e,t,n,i):4===e.strategy||s===r?(l(e,2+(i?1:0),3),m(e,L,B)):(l(e,4+(i?1:0),3),function(e,t,n,i){var r;for(l(e,t-257,5),l(e,n-1,5),l(e,i-4,4),r=0;r<i;r++)l(e,e.bl_tree[2*z[r]+1],3);v(e,e.dyn_ltree,t-1),v(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),m(e,e.dyn_ltree,e.dyn_dtree)),d(e),i&&p(e)},n._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(U[n]+x+1)]++,e.dyn_dtree[2*o(t)]++),e.last_lit===e.lit_bufsize-1},n._tr_align=function(e){l(e,2,3),c(e,M,L),function(e){16===e.bi_valid?(a(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":62}],74:[function(e,t,n){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}]},{},[10])(10)},yLV6:function(e,t,n){var i;!function(r,s,o,a){"use strict";var l,c=["","webkit","Moz","MS","ms","o"],h=s.createElement("div"),u=Math.round,d=Math.abs,p=Date.now;function f(e,t,n){return setTimeout(w(e,n),t)}function g(e,t,n){return!!Array.isArray(e)&&(m(e,n[t],n),!0)}function m(e,t,n){var i;if(e)if(e.forEach)e.forEach(t,n);else if(void 0!==e.length)for(i=0;i<e.length;)t.call(n,e[i],i,e),i++;else for(i in e)e.hasOwnProperty(i)&&t.call(n,e[i],i,e)}function b(e,t,n){var i="DEPRECATED METHOD: "+t+"\n"+n+" AT \n";return function(){var t=new Error("get-stack-trace"),n=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",s=r.console&&(r.console.warn||r.console.log);return s&&s.call(r.console,i,n),e.apply(this,arguments)}}l="function"!=typeof Object.assign?function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(null!=i)for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])}return t}:Object.assign;var y=b(function(e,t,n){for(var i=Object.keys(t),r=0;r<i.length;)(!n||n&&void 0===e[i[r]])&&(e[i[r]]=t[i[r]]),r++;return e},"extend","Use `assign`."),v=b(function(e,t){return y(e,t,!0)},"merge","Use `assign`.");function _(e,t,n){var i,r=t.prototype;(i=e.prototype=Object.create(r)).constructor=e,i._super=r,n&&l(i,n)}function w(e,t){return function(){return e.apply(t,arguments)}}function C(e,t){return"function"==typeof e?e.apply(t&&t[0]||void 0,t):e}function x(e,t){return void 0===e?t:e}function E(e,t,n){m(O(t),function(t){e.addEventListener(t,n,!1)})}function k(e,t,n){m(O(t),function(t){e.removeEventListener(t,n,!1)})}function S(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function T(e,t){return e.indexOf(t)>-1}function O(e){return e.trim().split(/\s+/g)}function I(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var i=0;i<e.length;){if(n&&e[i][n]==t||!n&&e[i]===t)return i;i++}return-1}function M(e){return Array.prototype.slice.call(e,0)}function A(e,t,n){for(var i=[],r=[],s=0;s<e.length;){var o=t?e[s][t]:e[s];I(r,o)<0&&i.push(e[s]),r[s]=o,s++}return n&&(i=t?i.sort(function(e,n){return e[t]>n[t]}):i.sort()),i}function P(e,t){for(var n,i,r=t[0].toUpperCase()+t.slice(1),s=0;s<c.length;){if((i=(n=c[s])?n+r:t)in e)return i;s++}}var D=1;function R(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||r}var F="ontouchstart"in r,N=void 0!==P(r,"PointerEvent"),z=F&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),L=["x","y"],B=["clientX","clientY"];function j(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){C(e.options.enable,[e])&&n.handler(t)},this.init()}function U(e,t,n){var i=n.pointers.length,r=n.changedPointers.length,s=1&t&&i-r==0,o=12&t&&i-r==0;n.isFirst=!!s,n.isFinal=!!o,s&&(e.session={}),n.eventType=t,function(e,t){var n=e.session,i=t.pointers,r=i.length;n.firstInput||(n.firstInput=H(t)),r>1&&!n.firstMultiple?n.firstMultiple=H(t):1===r&&(n.firstMultiple=!1);var s=n.firstInput,o=n.firstMultiple,a=o?o.center:s.center,l=t.center=V(i);t.timeStamp=p(),t.deltaTime=t.timeStamp-s.timeStamp,t.angle=Y(a,l),t.distance=W(a,l),function(e,t){var n=t.center,i=e.offsetDelta||{},r=e.prevDelta||{},s=e.prevInput||{};1!==t.eventType&&4!==s.eventType||(r=e.prevDelta={x:s.deltaX||0,y:s.deltaY||0},i=e.offsetDelta={x:n.x,y:n.y}),t.deltaX=r.x+(n.x-i.x),t.deltaY=r.y+(n.y-i.y)}(n,t),t.offsetDirection=Z(t.deltaX,t.deltaY);var c,h,u=G(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=u.x,t.overallVelocityY=u.y,t.overallVelocity=d(u.x)>d(u.y)?u.x:u.y,t.scale=o?(c=o.pointers,W((h=i)[0],h[1],B)/W(c[0],c[1],B)):1,t.rotation=o?function(e,t){return Y(t[1],t[0],B)+Y(e[1],e[0],B)}(o.pointers,i):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,function(e,t){var n,i,r,s,o=e.lastInterval||t,a=t.timeStamp-o.timeStamp;if(8!=t.eventType&&(a>25||void 0===o.velocity)){var l=t.deltaX-o.deltaX,c=t.deltaY-o.deltaY,h=G(a,l,c);i=h.x,r=h.y,n=d(h.x)>d(h.y)?h.x:h.y,s=Z(l,c),e.lastInterval=t}else n=o.velocity,i=o.velocityX,r=o.velocityY,s=o.direction;t.velocity=n,t.velocityX=i,t.velocityY=r,t.direction=s}(n,t);var f=e.element;S(t.srcEvent.target,f)&&(f=t.srcEvent.target),t.target=f}(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function H(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:u(e.pointers[n].clientX),clientY:u(e.pointers[n].clientY)},n++;return{timeStamp:p(),pointers:t,center:V(t),deltaX:e.deltaX,deltaY:e.deltaY}}function V(e){var t=e.length;if(1===t)return{x:u(e[0].clientX),y:u(e[0].clientY)};for(var n=0,i=0,r=0;r<t;)n+=e[r].clientX,i+=e[r].clientY,r++;return{x:u(n/t),y:u(i/t)}}function G(e,t,n){return{x:t/e||0,y:n/e||0}}function Z(e,t){return e===t?1:d(e)>=d(t)?e<0?2:4:t<0?8:16}function W(e,t,n){n||(n=L);var i=t[n[0]]-e[n[0]],r=t[n[1]]-e[n[1]];return Math.sqrt(i*i+r*r)}function Y(e,t,n){return n||(n=L),180*Math.atan2(t[n[1]]-e[n[1]],t[n[0]]-e[n[0]])/Math.PI}j.prototype={handler:function(){},init:function(){this.evEl&&E(this.element,this.evEl,this.domHandler),this.evTarget&&E(this.target,this.evTarget,this.domHandler),this.evWin&&E(R(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&k(this.element,this.evEl,this.domHandler),this.evTarget&&k(this.target,this.evTarget,this.domHandler),this.evWin&&k(R(this.element),this.evWin,this.domHandler)}};var q={mousedown:1,mousemove:2,mouseup:4};function $(){this.evEl="mousedown",this.evWin="mousemove mouseup",this.pressed=!1,j.apply(this,arguments)}_($,j,{handler:function(e){var t=q[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))}});var X={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},K={2:"touch",3:"pen",4:"mouse",5:"kinect"},Q="pointerdown",J="pointermove pointerup pointercancel";function ee(){this.evEl=Q,this.evWin=J,j.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}r.MSPointerEvent&&!r.PointerEvent&&(Q="MSPointerDown",J="MSPointerMove MSPointerUp MSPointerCancel"),_(ee,j,{handler:function(e){var t=this.store,n=!1,i=e.type.toLowerCase().replace("ms",""),r=X[i],s=K[e.pointerType]||e.pointerType,o="touch"==s,a=I(t,e.pointerId,"pointerId");1&r&&(0===e.button||o)?a<0&&(t.push(e),a=t.length-1):12&r&&(n=!0),a<0||(t[a]=e,this.callback(this.manager,r,{pointers:t,changedPointers:[e],pointerType:s,srcEvent:e}),n&&t.splice(a,1))}});var te={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function ne(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,j.apply(this,arguments)}function ie(e,t){var n=M(e.touches),i=M(e.changedTouches);return 12&t&&(n=A(n.concat(i),"identifier",!0)),[n,i]}_(ne,j,{handler:function(e){var t=te[e.type];if(1===t&&(this.started=!0),this.started){var n=ie.call(this,e,t);12&t&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:e})}}});var re={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function se(){this.evTarget="touchstart touchmove touchend touchcancel",this.targetIds={},j.apply(this,arguments)}function oe(e,t){var n=M(e.touches),i=this.targetIds;if(3&t&&1===n.length)return i[n[0].identifier]=!0,[n,n];var r,s,o=M(e.changedTouches),a=[],l=this.target;if(s=n.filter(function(e){return S(e.target,l)}),1===t)for(r=0;r<s.length;)i[s[r].identifier]=!0,r++;for(r=0;r<o.length;)i[o[r].identifier]&&a.push(o[r]),12&t&&delete i[o[r].identifier],r++;return a.length?[A(s.concat(a),"identifier",!0),a]:void 0}function ae(){j.apply(this,arguments);var e=w(this.handler,this);this.touch=new se(this.manager,e),this.mouse=new $(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function le(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,ce.call(this,t)):12&e&&ce.call(this,t)}function ce(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var i=this.lastTouches;setTimeout(function(){var e=i.indexOf(n);e>-1&&i.splice(e,1)},2500)}}function he(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var r=this.lastTouches[i],s=Math.abs(t-r.x),o=Math.abs(n-r.y);if(s<=25&&o<=25)return!0}return!1}_(se,j,{handler:function(e){var t=re[e.type],n=oe.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:e})}}),_(ae,j,{handler:function(e,t,n){var i="mouse"==n.pointerType;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if("touch"==n.pointerType)le.call(this,t,n);else if(i&&he.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ue=P(h.style,"touchAction"),de=void 0!==ue,pe=function(){if(!de)return!1;var e={},t=r.CSS&&r.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(n){e[n]=!t||r.CSS.supports("touch-action",n)}),e}();function fe(e,t){this.manager=e,this.set(t)}function ge(e){this.options=l({},this.defaults,e||{}),this.id=D++,this.manager=null,this.options.enable=x(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function me(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function be(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function ye(e,t){var n=t.manager;return n?n.get(e):e}function ve(){ge.apply(this,arguments)}function _e(){ve.apply(this,arguments),this.pX=null,this.pY=null}function we(){ve.apply(this,arguments)}function Ce(){ge.apply(this,arguments),this._timer=null,this._input=null}function xe(){ve.apply(this,arguments)}function Ee(){ve.apply(this,arguments)}function ke(){ge.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Se(e,t){return(t=t||{}).recognizers=x(t.recognizers,Se.defaults.preset),new Te(e,t)}function Te(e,t){this.options=l({},Se.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new(this.options.inputClass||(N?ee:z?se:F?ae:$))(this,U),this.touchAction=new fe(this,this.options.touchAction),Oe(this,!0),m(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function Oe(e,t){var n,i=e.element;i.style&&(m(e.options.cssProps,function(r,s){n=P(i.style,s),t?(e.oldCssProps[n]=i.style[n],i.style[n]=r):i.style[n]=e.oldCssProps[n]||""}),t||(e.oldCssProps={}))}fe.prototype={set:function(e){"compute"==e&&(e=this.compute()),de&&this.manager.element.style&&pe[e]&&(this.manager.element.style[ue]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return m(this.manager.recognizers,function(t){C(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),function(e){if(T(e,"none"))return"none";var t=T(e,"pan-x"),n=T(e,"pan-y");return t&&n?"none":t||n?t?"pan-x":"pan-y":T(e,"manipulation")?"manipulation":"auto"}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var i=this.actions,r=T(i,"none")&&!pe.none,s=T(i,"pan-y")&&!pe["pan-y"],o=T(i,"pan-x")&&!pe["pan-x"];if(r&&1===e.pointers.length&&e.distance<2&&e.deltaTime<250)return;if(!o||!s)return r||s&&6&n||o&&24&n?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}},ge.prototype={defaults:{},set:function(e){return l(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(g(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=ye(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return g(e,"dropRecognizeWith",this)||(e=ye(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(g(e,"requireFailure",this))return this;var t=this.requireFail;return-1===I(t,e=ye(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(g(e,"dropRequireFailure",this))return this;e=ye(e,this);var t=I(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,n=this.state;function i(n){t.manager.emit(n,e)}n<8&&i(t.options.event+me(n)),i(t.options.event),e.additionalEvent&&i(e.additionalEvent),n>=8&&i(t.options.event+me(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=32},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=l({},e);if(!C(this.options.enable,[this,t]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},_(ve,ge,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,i=6&t,r=this.attrTest(e);return i&&(8&n||!r)?16|t:i||r?4&n?8|t:2&t?4|t:2:32}}),_(_e,ve,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push("pan-y"),24&e&&t.push("pan-x"),t},directionTest:function(e){var t=this.options,n=!0,i=e.distance,r=e.direction,s=e.deltaX,o=e.deltaY;return r&t.direction||(6&t.direction?(r=0===s?1:s<0?2:4,n=s!=this.pX,i=Math.abs(e.deltaX)):(r=0===o?1:o<0?8:16,n=o!=this.pY,i=Math.abs(e.deltaY))),e.direction=r,n&&i>t.threshold&&r&t.direction},attrTest:function(e){return ve.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=be(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),_(we,ve,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){1!==e.scale&&(e.additionalEvent=this.options.event+(e.scale<1?"in":"out")),this._super.emit.call(this,e)}}),_(Ce,ge,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,i=e.distance<t.threshold,r=e.deltaTime>t.time;if(this._input=e,!i||!n||12&e.eventType&&!r)this.reset();else if(1&e.eventType)this.reset(),this._timer=f(function(){this.state=8,this.tryEmit()},t.time,this);else if(4&e.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}}),_(xe,ve,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),_(Ee,ve,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return _e.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return 30&n?t=e.overallVelocity:6&n?t=e.overallVelocityX:24&n&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&d(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=be(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),_(ke,ge,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return["manipulation"]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,i=e.distance<t.threshold,r=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(i&&r&&n){if(4!=e.eventType)return this.failTimeout();var s=!this.pTime||e.timeStamp-this.pTime<t.interval,o=!this.pCenter||W(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,o&&s?this.count+=1:this.count=1,this._input=e,0==this.count%t.taps)return this.hasRequireFailures()?(this._timer=f(function(){this.state=8,this.tryEmit()},t.interval,this),2):8}return 32},failTimeout:function(){return this._timer=f(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Se.VERSION="2.0.7",Se.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[xe,{enable:!1}],[we,{enable:!1},["rotate"]],[Ee,{direction:6}],[_e,{direction:6},["swipe"]],[ke],[ke,{event:"doubletap",taps:2},["tap"]],[Ce]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Te.prototype={set:function(e){return l(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var n;this.touchAction.preventDefaults(e);var i=this.recognizers,r=t.curRecognizer;(!r||r&&8&r.state)&&(r=t.curRecognizer=null);for(var s=0;s<i.length;)n=i[s],2===t.stopped||r&&n!=r&&!n.canRecognizeWith(r)?n.reset():n.recognize(e),!r&&14&n.state&&(r=t.curRecognizer=n),s++}},get:function(e){if(e instanceof ge)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(g(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(g(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=I(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(void 0!==e&&void 0!==t){var n=this.handlers;return m(O(e),function(e){n[e]=n[e]||[],n[e].push(t)}),this}},off:function(e,t){if(void 0!==e){var n=this.handlers;return m(O(e),function(e){t?n[e]&&n[e].splice(I(n[e],t),1):delete n[e]}),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var n=s.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t,t.target.dispatchEvent(n)}(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var i=0;i<n.length;)n[i](t),i++}},destroy:function(){this.element&&Oe(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},l(Se,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Te,Input:j,TouchAction:fe,TouchInput:se,MouseInput:$,PointerEventInput:ee,TouchMouseInput:ae,SingleTouchInput:ne,Recognizer:ge,AttrRecognizer:ve,Tap:ke,Pan:_e,Swipe:Ee,Pinch:we,Rotate:xe,Press:Ce,on:E,off:k,each:m,merge:v,extend:y,assign:l,inherit:_,bindFn:w,prefixed:P}),(void 0!==r?r:"undefined"!=typeof self?self:{}).Hammer=Se,void 0===(i=(function(){return Se}).call(t,n,t,e))||(e.exports=i)}(window,document)},"yeV+":function(e,t,n){var i=n("49sm"),r=n("IKIk"),s=r.Uint64BE,o=r.Int64BE,a=n("5ukv"),l=n("W3Yc"),c=n("k5sU"),h=n("ngnX").uint8,u=n("19AM").ExtBuffer,d="undefined"!=typeof Uint8Array,p="undefined"!=typeof Map,f=[];f[1]=212,f[2]=213,f[4]=214,f[8]=215,f[16]=216,t.getWriteType=function(e){var t,n=c.getWriteToken(e),r=e&&e.useraw,g=d&&e&&e.binarraybuffer,m=g?a.isArrayBuffer:a.isBuffer,b=g?function(e,t){w(e,new Uint8Array(t))}:w,y=p&&e&&e.usemap?function(e,t){if(!(t instanceof Map))return C(e,t);var i=t.size;n[i<16?128+i:i<=65535?222:223](e,i);var r=e.codec.encode;t.forEach(function(t,n,i){r(e,n),r(e,t)})}:C;return{boolean:function(e,t){n[t?195:194](e,t)},function:_,number:function(e,t){var i=0|t;t===i?n[-32<=i&&i<=127?255&i:0<=i?i<=255?204:i<=65535?205:206:-128<=i?208:-32768<=i?209:210](e,i):n[203](e,t)},object:r?function(e,t){if(m(t))return function(e,t){var i=t.length;n[i<32?160+i:i<=65535?218:219](e,i),e.send(t)}(e,t);v(e,t)}:v,string:(t=r?function(e){return e<32?1:e<=65535?3:5}:function(e){return e<32?1:e<=255?2:e<=65535?3:5},function(e,i){var r=i.length;e.offset=e.reserve(5+3*r);var s=e.buffer,o=t(r),a=e.offset+o;r=l.write.call(s,i,a);var c=t(r);o!==c&&l.copy.call(s,s,a+c-o,a,a+r),n[1===c?160+r:c<=3?215+c:219](e,r),e.offset+=r}),symbol:_,undefined:_};function v(e,t){if(null===t)return _(e,t);if(m(t))return b(e,t);if(i(t))return function(e,t){var i=t.length;n[i<16?144+i:i<=65535?220:221](e,i);for(var r=e.codec.encode,s=0;s<i;s++)r(e,t[s])}(e,t);if(s.isUint64BE(t))return function(e,t){n[207](e,t.toArray())}(e,t);if(o.isInt64BE(t))return function(e,t){n[211](e,t.toArray())}(e,t);var r=e.codec.getExtPacker(t);if(r&&(t=r(t)),t instanceof u)return function(e,t){var i=t.buffer,r=i.length;n[f[r]||(r<255?199:r<=65535?200:201)](e,r),h[t.type](e),e.send(i)}(e,t);y(e,t)}function _(e,t){n[192](e,t)}function w(e,t){var i=t.length;n[i<255?196:i<=65535?197:198](e,i),e.send(t)}function C(e,t){var i=Object.keys(t),r=i.length;n[r<16?128+r:r<=65535?222:223](e,r);var s=e.codec.encode;i.forEach(function(n){s(e,n),s(e,t[n])})}}},zTos:function(e,t){function n(e){return e&&e.isBuffer&&e}e.exports=n("undefined"!=typeof Buffer&&Buffer)||n(this.Buffer)||n("undefined"!=typeof window&&window.Buffer)||this.Buffer},zUnb:function(e,t,n){"use strict";function i(e){return"function"==typeof e}n.r(t);let r=!1;const s={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e){const e=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+e.stack)}else r&&console.log("RxJS: Back to a better error behavior. Thank you. <3");r=e},get useDeprecatedSynchronousErrorHandling(){return r}};function o(e){setTimeout(()=>{throw e},0)}const a={closed:!0,next(e){},error(e){if(s.useDeprecatedSynchronousErrorHandling)throw e;o(e)},complete(){}},l=(()=>Array.isArray||(e=>e&&"number"==typeof e.length))();function c(e){return null!==e&&"object"==typeof e}const h=(()=>{function e(e){return Error.call(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((e,t)=>`${t+1}) ${e.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e})();let u=(()=>{class e{constructor(e){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,e&&(this._ctorUnsubscribe=!0,this._unsubscribe=e)}unsubscribe(){let t;if(this.closed)return;let{_parentOrParents:n,_ctorUnsubscribe:r,_unsubscribe:s,_subscriptions:o}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof e)n.remove(this);else if(null!==n)for(let e=0;e<n.length;++e)n[e].remove(this);if(i(s)){r&&(this._unsubscribe=void 0);try{s.call(this)}catch(a){t=a instanceof h?d(a.errors):[a]}}if(l(o)){let e=-1,n=o.length;for(;++e<n;){const n=o[e];if(c(n))try{n.unsubscribe()}catch(a){t=t||[],a instanceof h?t=t.concat(d(a.errors)):t.push(a)}}}if(t)throw new h(t)}add(t){let n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){const t=n;n=new e,n._subscriptions=[t]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}let{_parentOrParents:i}=n;if(null===i)n._parentOrParents=this;else if(i instanceof e){if(i===this)return n;n._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return n;i.push(this)}const r=this._subscriptions;return null===r?this._subscriptions=[n]:r.push(n),n}remove(e){const t=this._subscriptions;if(t){const n=t.indexOf(e);-1!==n&&t.splice(n,1)}}}return e.EMPTY=function(e){return e.closed=!0,e}(new e),e})();function d(e){return e.reduce((e,t)=>e.concat(t instanceof h?t.errors:t),[])}const p=(()=>"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random())();class f extends u{constructor(e,t,n){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=a;break;case 1:if(!e){this.destination=a;break}if("object"==typeof e){e instanceof f?(this.syncErrorThrowable=e.syncErrorThrowable,this.destination=e,e.add(this)):(this.syncErrorThrowable=!0,this.destination=new g(this,e));break}default:this.syncErrorThrowable=!0,this.destination=new g(this,e,t,n)}}[p](){return this}static create(e,t,n){const i=new f(e,t,n);return i.syncErrorThrowable=!1,i}next(e){this.isStopped||this._next(e)}error(e){this.isStopped||(this.isStopped=!0,this._error(e))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(e){this.destination.next(e)}_error(e){this.destination.error(e),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:e}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}class g extends f{constructor(e,t,n,r){let s;super(),this._parentSubscriber=e;let o=this;i(t)?s=t:t&&(s=t.next,n=t.error,r=t.complete,t!==a&&(o=Object.create(t),i(o.unsubscribe)&&this.add(o.unsubscribe.bind(o)),o.unsubscribe=this.unsubscribe.bind(this))),this._context=o,this._next=s,this._error=n,this._complete=r}next(e){if(!this.isStopped&&this._next){const{_parentSubscriber:t}=this;s.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}error(e){if(!this.isStopped){const{_parentSubscriber:t}=this,{useDeprecatedSynchronousErrorHandling:n}=s;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):o(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;o(e)}}}complete(){if(!this.isStopped){const{_parentSubscriber:e}=this;if(this._complete){const t=()=>this._complete.call(this._context);s.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,t),this.unsubscribe()):(this.__tryOrUnsub(t),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(e,t){try{e.call(this._context,t)}catch(n){if(this.unsubscribe(),s.useDeprecatedSynchronousErrorHandling)throw n;o(n)}}__tryOrSetError(e,t,n){if(!s.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(i){return s.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=i,e.syncErrorThrown=!0,!0):(o(i),!0)}return!1}_unsubscribe(){const{_parentSubscriber:e}=this;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}const m=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")();function b(e){return e}let y=(()=>{class e{constructor(e){this._isScalar=!1,e&&(this._subscribe=e)}lift(t){const n=new e;return n.source=this,n.operator=t,n}subscribe(e,t,n){const{operator:i}=this,r=function(e,t,n){if(e){if(e instanceof f)return e;if(e[p])return e[p]()}return e||t||n?new f(e,t,n):new f(a)}(e,t,n);if(r.add(i?i.call(r,this.source):this.source||s.useDeprecatedSynchronousErrorHandling&&!r.syncErrorThrowable?this._subscribe(r):this._trySubscribe(r)),s.useDeprecatedSynchronousErrorHandling&&r.syncErrorThrowable&&(r.syncErrorThrowable=!1,r.syncErrorThrown))throw r.syncErrorValue;return r}_trySubscribe(e){try{return this._subscribe(e)}catch(t){s.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){const{closed:t,destination:n,isStopped:i}=e;if(t||i)return!1;e=n&&n instanceof f?n:null}return!0}(e)?e.error(t):console.warn(t)}}forEach(e,t){return new(t=v(t))((t,n)=>{let i;i=this.subscribe(t=>{try{e(t)}catch(r){n(r),i&&i.unsubscribe()}},n,t)})}_subscribe(e){const{source:t}=this;return t&&t.subscribe(e)}[m](){return this}pipe(...e){return 0===e.length?this:(0===(t=e).length?b:1===t.length?t[0]:function(e){return t.reduce((e,t)=>t(e),e)})(this);var t}toPromise(e){return new(e=v(e))((e,t)=>{let n;this.subscribe(e=>n=e,e=>t(e),()=>e(n))})}}return e.create=t=>new e(t),e})();function v(e){if(e||(e=s.Promise||Promise),!e)throw new Error("no Promise impl found");return e}const _=(()=>{function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e})();class w extends u{constructor(e,t){super(),this.subject=e,this.subscriber=t,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const e=this.subject,t=e.observers;if(this.subject=null,!t||0===t.length||e.isStopped||e.closed)return;const n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}class C extends f{constructor(e){super(e),this.destination=e}}let x=(()=>{class e extends y{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[p](){return new C(this)}lift(e){const t=new E(this,this);return t.operator=e,t}next(e){if(this.closed)throw new _;if(!this.isStopped){const{observers:t}=this,n=t.length,i=t.slice();for(let r=0;r<n;r++)i[r].next(e)}}error(e){if(this.closed)throw new _;this.hasError=!0,this.thrownError=e,this.isStopped=!0;const{observers:t}=this,n=t.length,i=t.slice();for(let r=0;r<n;r++)i[r].error(e);this.observers.length=0}complete(){if(this.closed)throw new _;this.isStopped=!0;const{observers:e}=this,t=e.length,n=e.slice();for(let i=0;i<t;i++)n[i].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(e){if(this.closed)throw new _;return super._trySubscribe(e)}_subscribe(e){if(this.closed)throw new _;return this.hasError?(e.error(this.thrownError),u.EMPTY):this.isStopped?(e.complete(),u.EMPTY):(this.observers.push(e),new w(this,e))}asObservable(){const e=new y;return e.source=this,e}}return e.create=(e,t)=>new E(e,t),e})();class E extends x{constructor(e,t){super(),this.destination=e,this.source=t}next(e){const{destination:t}=this;t&&t.next&&t.next(e)}error(e){const{destination:t}=this;t&&t.error&&this.destination.error(e)}complete(){const{destination:e}=this;e&&e.complete&&this.destination.complete()}_subscribe(e){const{source:t}=this;return t?this.source.subscribe(e):u.EMPTY}}function k(e){return e&&"function"==typeof e.schedule}function S(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new T(e,t))}}class T{constructor(e,t){this.project=e,this.thisArg=t}call(e,t){return t.subscribe(new O(e,this.project,this.thisArg))}}class O extends f{constructor(e,t,n){super(e),this.project=t,this.count=0,this.thisArg=n||this}_next(e){let t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(t)}}const I=e=>t=>{for(let n=0,i=e.length;n<i&&!t.closed;n++)t.next(e[n]);t.complete()};function M(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}const A=M(),P=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function D(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}const R=e=>{if(e&&"function"==typeof e[m])return i=e,e=>{const t=i[m]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if(P(e))return I(e);if(D(e))return n=e,e=>(n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,o),e);if(e&&"function"==typeof e[A])return t=e,e=>{const n=t[A]();for(;;){let t;try{t=n.next()}catch(i){return e.error(i),e}if(t.done){e.complete();break}if(e.next(t.value),e.closed)break}return"function"==typeof n.return&&e.add(()=>{n.return&&n.return()}),e};{const t=c(e)?"an invalid object":`'${e}'`;throw new TypeError(`You provided ${t} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`)}var t,n,i};function F(e,t){return new y(n=>{const i=new u;let r=0;return i.add(t.schedule(function(){r!==e.length?(n.next(e[r++]),n.closed||i.add(this.schedule())):n.complete()})),i})}function N(e,t){return t?function(e,t){if(null!=e){if(function(e){return e&&"function"==typeof e[m]}(e))return function(e,t){return new y(n=>{const i=new u;return i.add(t.schedule(()=>{const r=e[m]();i.add(r.subscribe({next(e){i.add(t.schedule(()=>n.next(e)))},error(e){i.add(t.schedule(()=>n.error(e)))},complete(){i.add(t.schedule(()=>n.complete()))}}))})),i})}(e,t);if(D(e))return function(e,t){return new y(n=>{const i=new u;return i.add(t.schedule(()=>e.then(e=>{i.add(t.schedule(()=>{n.next(e),i.add(t.schedule(()=>n.complete()))}))},e=>{i.add(t.schedule(()=>n.error(e)))}))),i})}(e,t);if(P(e))return F(e,t);if(function(e){return e&&"function"==typeof e[A]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new y(n=>{const i=new u;let r;return i.add(()=>{r&&"function"==typeof r.return&&r.return()}),i.add(t.schedule(()=>{r=e[A](),i.add(t.schedule(function(){if(n.closed)return;let e,t;try{const n=r.next();e=n.value,t=n.done}catch(i){return void n.error(i)}t?n.complete():(n.next(e),this.schedule())}))})),i})}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}(e,t):e instanceof y?e:new y(R(e))}class z extends f{constructor(e){super(),this.parent=e}_next(e){this.parent.notifyNext(e)}_error(e){this.parent.notifyError(e),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class L extends f{notifyNext(e){this.destination.next(e)}notifyError(e){this.destination.error(e)}notifyComplete(){this.destination.complete()}}function B(e,t){if(t.closed)return;if(e instanceof y)return e.subscribe(t);let n;try{n=R(e)(t)}catch(i){t.error(i)}return n}function j(e,t,n=Number.POSITIVE_INFINITY){return"function"==typeof t?i=>i.pipe(j((n,i)=>N(e(n,i)).pipe(S((e,r)=>t(n,e,i,r))),n)):("number"==typeof t&&(n=t),t=>t.lift(new U(e,n)))}class U{constructor(e,t=Number.POSITIVE_INFINITY){this.project=e,this.concurrent=t}call(e,t){return t.subscribe(new H(e,this.project,this.concurrent))}}class H extends L{constructor(e,t,n=Number.POSITIVE_INFINITY){super(e),this.project=t,this.concurrent=n,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}_tryNext(e){let t;const n=this.index++;try{t=this.project(e,n)}catch(i){return void this.destination.error(i)}this.active++,this._innerSub(t)}_innerSub(e){const t=new z(this),n=this.destination;n.add(t);const i=B(e,t);i!==t&&n.add(i)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(e){this.destination.next(e)}notifyComplete(){const e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function V(e=Number.POSITIVE_INFINITY){return j(b,e)}function G(e,t){return t?F(e,t):new y(I(e))}function Z(...e){let t=Number.POSITIVE_INFINITY,n=null,i=e[e.length-1];return k(i)?(n=e.pop(),e.length>1&&"number"==typeof e[e.length-1]&&(t=e.pop())):"number"==typeof i&&(t=e.pop()),null===n&&1===e.length&&e[0]instanceof y?e[0]:V(t)(G(e,n))}function W(){return function(e){return e.lift(new Y(e))}}class Y{constructor(e){this.connectable=e}call(e,t){const{connectable:n}=this;n._refCount++;const i=new q(e,n),r=t.subscribe(i);return i.closed||(i.connection=n.connect()),r}}class q extends f{constructor(e,t){super(e),this.connectable=t}_unsubscribe(){const{connectable:e}=this;if(!e)return void(this.connection=null);this.connectable=null;const t=e._refCount;if(t<=0)return void(this.connection=null);if(e._refCount=t-1,t>1)return void(this.connection=null);const{connection:n}=this,i=e._connection;this.connection=null,!i||n&&i!==n||i.unsubscribe()}}class $ extends y{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._refCount=0,this._isComplete=!1}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject}connect(){let e=this._connection;return e||(this._isComplete=!1,e=this._connection=new u,e.add(this.source.subscribe(new K(this.getSubject(),this))),e.closed&&(this._connection=null,e=u.EMPTY)),e}refCount(){return W()(this)}}const X=(()=>{const e=$.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:e._subscribe},_isComplete:{value:e._isComplete,writable:!0},getSubject:{value:e.getSubject},connect:{value:e.connect},refCount:{value:e.refCount}}})();class K extends C{constructor(e,t){super(e),this.connectable=t}_error(e){this._unsubscribe(),super._error(e)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const e=this.connectable;if(e){this.connectable=null;const t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}function Q(e,t){return function(n){let i;if(i="function"==typeof e?e:function(){return e},"function"==typeof t)return n.lift(new J(i,t));const r=Object.create(n,X);return r.source=n,r.subjectFactory=i,r}}class J{constructor(e,t){this.subjectFactory=e,this.selector=t}call(e,t){const{selector:n}=this,i=this.subjectFactory(),r=n(i).subscribe(e);return r.add(t.subscribe(i)),r}}function ee(){return new x}function te(e){for(let t in e)if(e[t]===te)return t;throw Error("Could not find renamed property on target object.")}function ne(e,t){for(const n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function ie(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(ie).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const t=e.toString();if(null==t)return""+t;const n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function re(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}const se=te({__forward_ref__:te});function oe(e){return e.__forward_ref__=oe,e.toString=function(){return ie(this())},e}function ae(e){return le(e)?e():e}function le(e){return"function"==typeof e&&e.hasOwnProperty(se)&&e.__forward_ref__===oe}class ce extends Error{constructor(e,t){super(function(e,t){return`${e?`NG0${e}: `:""}${t}`}(e,t)),this.code=e}}function he(e){return"string"==typeof e?e:null==e?"":String(e)}function ue(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():he(e)}function de(e,t){const n=t?` in ${t}`:"";throw new ce("201",`No provider for ${ue(e)} found${n}`)}function pe(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function fe(e){return{providers:e.providers||[],imports:e.imports||[]}}function ge(e){return me(e,ye)||me(e,_e)}function me(e,t){return e.hasOwnProperty(t)?e[t]:null}function be(e){return e&&(e.hasOwnProperty(ve)||e.hasOwnProperty(we))?e[ve]:null}const ye=te({"\u0275prov":te}),ve=te({"\u0275inj":te}),_e=te({ngInjectableDef:te}),we=te({ngInjectorDef:te});var Ce=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}({});let xe;function Ee(e){const t=xe;return xe=e,t}function ke(e,t,n){const i=ge(e);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:n&Ce.Optional?null:void 0!==t?t:void de(ie(e),"Injector")}function Se(e){return{toString:e}.toString()}var Te=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}({}),Oe=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e}({});const Ie="undefined"!=typeof globalThis&&globalThis,Me="undefined"!=typeof window&&window,Ae="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Pe="undefined"!=typeof global&&global,De=Ie||Pe||Me||Ae,Re={},Fe=[],Ne=[],ze=te({"\u0275cmp":te}),Le=te({"\u0275dir":te}),Be=te({"\u0275pipe":te}),je=te({"\u0275mod":te}),Ue=te({"\u0275loc":te}),He=te({"\u0275fac":te}),Ve=te({__NG_ELEMENT_ID__:te});let Ge=0;function Ze(e){return Se(()=>{const t={},n={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===Te.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||Ne,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||Oe.Emulated,id:"c",styles:e.styles||Ne,_:null,setInput:null,schemas:e.schemas||null,tView:null},i=e.directives,r=e.features,s=e.pipes;return n.id+=Ge++,n.inputs=Ke(e.inputs,t),n.outputs=Ke(e.outputs),r&&r.forEach(e=>e(n)),n.directiveDefs=i?()=>("function"==typeof i?i():i).map(Ye):null,n.pipeDefs=s?()=>("function"==typeof s?s():s).map(qe):null,n})}function We(e,t,n){const i=e.\u0275cmp;i.directiveDefs=()=>t.map(Ye),i.pipeDefs=()=>n.map(qe)}function Ye(e){return et(e)||function(e){return e[Le]||null}(e)}function qe(e){return function(e){return e[Be]||null}(e)}const $e={};function Xe(e){const t={type:e.type,bootstrap:e.bootstrap||Ne,declarations:e.declarations||Ne,imports:e.imports||Ne,exports:e.exports||Ne,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&Se(()=>{$e[e.id]=e.type}),t}function Ke(e,t){if(null==e)return Re;const n={};for(const i in e)if(e.hasOwnProperty(i)){let r=e[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),n[r]=i,t&&(t[r]=s)}return n}const Qe=Ze;function Je(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,onDestroy:e.type.prototype.ngOnDestroy||null}}function et(e){return e[ze]||null}function tt(e,t){const n=e[je]||null;if(!n&&!0===t)throw new Error(`Type ${ie(e)} does not have '\u0275mod' property.`);return n}function nt(e){return Array.isArray(e)&&"object"==typeof e[1]}function it(e){return Array.isArray(e)&&!0===e[1]}function rt(e){return 0!=(8&e.flags)}function st(e){return 2==(2&e.flags)}function ot(e){return 1==(1&e.flags)}function at(e){return null!==e.template}function lt(e,t){return e.hasOwnProperty(He)?e[He]:null}class ct{constructor(e,t,n){this.previousValue=e,this.currentValue=t,this.firstChange=n}isFirstChange(){return this.firstChange}}function ht(){return ut}function ut(e){return e.type.prototype.ngOnChanges&&(e.setInput=pt),dt}function dt(){const e=ft(this),t=null==e?void 0:e.current;if(t){const n=e.previous;if(n===Re)e.previous=t;else for(let e in t)n[e]=t[e];e.current=null,this.ngOnChanges(t)}}function pt(e,t,n,i){const r=ft(e)||function(e,t){return e.__ngSimpleChanges__=t}(e,{previous:Re,current:null}),s=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[n],l=o[a];s[a]=new ct(l&&l.currentValue,t,o===Re),e[i]=t}function ft(e){return e.__ngSimpleChanges__||null}let gt;function mt(){return void 0!==gt?gt:"undefined"!=typeof document?document:void 0}function bt(e){return!!e.listen}ht.ngInherit=!0;const yt={createRenderer:(e,t)=>mt()};function vt(e){for(;Array.isArray(e);)e=e[0];return e}function _t(e,t){return vt(t[e])}function wt(e,t){return vt(t[e.index])}function Ct(e,t){return e.data[t]}function xt(e,t){return e[t]}function Et(e,t){const n=t[e];return nt(n)?n:n[0]}function kt(e){const t=function(e){return e.__ngContext__||null}(e);return t?Array.isArray(t)?t:t.lView:null}function St(e){return 4==(4&e[2])}function Tt(e){return 128==(128&e[2])}function Ot(e,t){return null==t?null:e[t]}function It(e){e[18]=0}function Mt(e,t){e[5]+=t;let n=e,i=e[3];for(;null!==i&&(1===t&&1===n[5]||-1===t&&0===n[5]);)i[5]+=t,n=i,i=i[3]}const At={lFrame:tn(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Pt(){return At.bindingsEnabled}function Dt(){return At.lFrame.lView}function Rt(){return At.lFrame.tView}function Ft(e){At.lFrame.contextLView=e}function Nt(){let e=zt();for(;null!==e&&64===e.type;)e=e.parent;return e}function zt(){return At.lFrame.currentTNode}function Lt(e,t){const n=At.lFrame;n.currentTNode=e,n.isParent=t}function Bt(){return At.lFrame.isParent}function jt(){At.lFrame.isParent=!1}function Ut(){return At.isInCheckNoChangesMode}function Ht(e){At.isInCheckNoChangesMode=e}function Vt(){const e=At.lFrame;let t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function Gt(){return At.lFrame.bindingIndex}function Zt(){return At.lFrame.bindingIndex++}function Wt(e){const t=At.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}function Yt(e,t){const n=At.lFrame;n.bindingIndex=n.bindingRootIndex=e,qt(t)}function qt(e){At.lFrame.currentDirectiveIndex=e}function $t(){return At.lFrame.currentQueryIndex}function Xt(e){At.lFrame.currentQueryIndex=e}function Kt(e){const t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function Qt(e,t,n){if(n&Ce.SkipSelf){let i=t,r=e;for(;i=i.parent,!(null!==i||n&Ce.Host||(i=Kt(r),null===i)||(r=r[15],10&i.type)););if(null===i)return!1;t=i,e=r}const i=At.lFrame=en();return i.currentTNode=t,i.lView=e,!0}function Jt(e){const t=en(),n=e[1];At.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function en(){const e=At.lFrame,t=null===e?null:e.child;return null===t?tn(e):t}function tn(e){const t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function nn(){const e=At.lFrame;return At.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const rn=nn;function sn(){const e=nn();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function on(){return At.lFrame.selectedIndex}function an(e){At.lFrame.selectedIndex=e}function ln(){const e=At.lFrame;return Ct(e.tView,e.selectedIndex)}function cn(e,t){for(let n=t.directiveStart,i=t.directiveEnd;n<i;n++){const t=e.data[n].type.prototype,{ngAfterContentInit:i,ngAfterContentChecked:r,ngAfterViewInit:s,ngAfterViewChecked:o,ngOnDestroy:a}=t;i&&(e.contentHooks||(e.contentHooks=[])).push(-n,i),r&&((e.contentHooks||(e.contentHooks=[])).push(n,r),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,r)),s&&(e.viewHooks||(e.viewHooks=[])).push(-n,s),o&&((e.viewHooks||(e.viewHooks=[])).push(n,o),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,o)),null!=a&&(e.destroyHooks||(e.destroyHooks=[])).push(n,a)}}function hn(e,t,n){pn(e,t,3,n)}function un(e,t,n,i){(3&e[2])===n&&pn(e,t,n,i)}function dn(e,t){let n=e[2];(3&n)===t&&(n&=2047,n+=1,e[2]=n)}function pn(e,t,n,i){const r=null!=i?i:-1,s=t.length-1;let o=0;for(let a=void 0!==i?65535&e[18]:0;a<s;a++)if("number"==typeof t[a+1]){if(o=t[a],null!=i&&o>=i)break}else t[a]<0&&(e[18]+=65536),(o<r||-1==r)&&(fn(e,n,t,a),e[18]=(4294901760&e[18])+a+2),a++}function fn(e,t,n,i){const r=n[i]<0,s=n[i+1],o=e[r?-n[i]:n[i]];if(r){if(e[2]>>11<e[18]>>16&&(3&e[2])===t){e[2]+=2048;try{s.call(o)}finally{}}}else try{s.call(o)}finally{}}class gn{constructor(e,t,n){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=n}}function mn(e,t,n){const i=bt(e);let r=0;for(;r<n.length;){const s=n[r];if("number"==typeof s){if(0!==s)break;r++;const o=n[r++],a=n[r++],l=n[r++];i?e.setAttribute(t,a,l,o):t.setAttributeNS(o,a,l)}else{const o=s,a=n[++r];bn(o)?i&&e.setProperty(t,o,a):i?e.setAttribute(t,o,a):t.setAttribute(o,a),r++}}return r}function bn(e){return 64===e.charCodeAt(0)}function yn(e,t){if(null===t||0===t.length);else if(null===e||0===e.length)e=t.slice();else{let n=-1;for(let i=0;i<t.length;i++){const r=t[i];"number"==typeof r?n=r:0===n||vn(e,n,r,null,-1===n||2===n?t[++i]:null)}}return e}function vn(e,t,n,i,r){let s=0,o=e.length;if(-1===t)o=-1;else for(;s<e.length;){const n=e[s++];if("number"==typeof n){if(n===t){o=-1;break}if(n>t){o=s-1;break}}}for(;s<e.length;){const t=e[s];if("number"==typeof t)break;if(t===n){if(null===i)return void(null!==r&&(e[s+1]=r));if(i===e[s+1])return void(e[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(e.splice(o,0,t),s=o+1),e.splice(s++,0,n),null!==i&&e.splice(s++,0,i),null!==r&&e.splice(s++,0,r)}function _n(e){return-1!==e}function wn(e){return 32767&e}function Cn(e,t){let n=e>>16,i=t;for(;n>0;)i=i[15],n--;return i}let xn=!0;function En(e){const t=xn;return xn=e,t}let kn=0;function Sn(e,t){const n=On(e,t);if(-1!==n)return n;const i=t[1];i.firstCreatePass&&(e.injectorIndex=t.length,Tn(i.data,e),Tn(t,null),Tn(i.blueprint,null));const r=In(e,t),s=e.injectorIndex;if(_n(r)){const e=wn(r),n=Cn(r,t),i=n[1].data;for(let r=0;r<8;r++)t[s+r]=n[e+r]|i[e+r]}return t[s+8]=r,s}function Tn(e,t){e.push(0,0,0,0,0,0,0,0,t)}function On(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function In(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let n=0,i=null,r=t;for(;null!==r;){const e=r[1],t=e.type;if(i=2===t?e.declTNode:1===t?r[6]:null,null===i)return-1;if(n++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|n<<16}return-1}function Mn(e,t,n){!function(e,t,n){let i;"string"==typeof n?i=n.charCodeAt(0)||0:n.hasOwnProperty(Ve)&&(i=n[Ve]),null==i&&(i=n[Ve]=kn++);const r=255&i;t.data[e+(r>>5)]|=1<<r}(e,t,n)}function An(e,t,n){if(n&Ce.Optional)return e;de(t,"NodeInjector")}function Pn(e,t,n,i){if(n&Ce.Optional&&void 0===i&&(i=null),0==(n&(Ce.Self|Ce.Host))){const r=e[9],s=Ee(void 0);try{return r?r.get(t,i,n&Ce.Optional):ke(t,i,n&Ce.Optional)}finally{Ee(s)}}return An(i,t,n)}function Dn(e,t,n,i=Ce.Default,r){if(null!==e){const s=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;const t=e.hasOwnProperty(Ve)?e[Ve]:void 0;return"number"==typeof t?t>=0?255&t:Fn:t}(n);if("function"==typeof s){if(!Qt(t,e,i))return i&Ce.Host?An(r,n,i):Pn(t,n,i,r);try{const e=s();if(null!=e||i&Ce.Optional)return e;de(n)}finally{rn()}}else if("number"==typeof s){let r=null,o=On(e,t),a=-1,l=i&Ce.Host?t[16][6]:null;for((-1===o||i&Ce.SkipSelf)&&(a=-1===o?In(e,t):t[o+8],-1!==a&&jn(i,!1)?(r=t[1],o=wn(a),t=Cn(a,t)):o=-1);-1!==o;){const e=t[1];if(Bn(s,o,e.data)){const e=Nn(o,t,n,r,i,l);if(e!==Rn)return e}a=t[o+8],-1!==a&&jn(i,t[1].data[o+8]===l)&&Bn(s,o,t)?(r=e,o=wn(a),t=Cn(a,t)):o=-1}}}return Pn(t,n,i,r)}const Rn={};function Fn(){return new Un(Nt(),Dt())}function Nn(e,t,n,i,r,s){const o=t[1],a=o.data[e+8],l=zn(a,o,n,null==i?st(a)&&xn:i!=o&&0!=(3&a.type),r&Ce.Host&&s===a);return null!==l?Ln(t,o,l,a):Rn}function zn(e,t,n,i,r){const s=e.providerIndexes,o=t.data,a=1048575&s,l=e.directiveStart,c=s>>20,h=r?a+c:e.directiveEnd;for(let u=i?a:a+c;u<h;u++){const e=o[u];if(u<l&&n===e||u>=l&&e.type===n)return u}if(r){const e=o[l];if(e&&at(e)&&e.type===n)return l}return null}function Ln(e,t,n,i){let r=e[n];const s=t.data;if(r instanceof gn){const o=r;o.resolving&&function(e,t){throw new ce("200",`Circular dependency in DI detected for ${e}`)}(ue(s[n]));const a=En(o.canSeeViewProviders);o.resolving=!0;const l=o.injectImpl?Ee(o.injectImpl):null;Qt(e,i,Ce.Default);try{r=e[n]=o.factory(void 0,s,e,i),t.firstCreatePass&&n>=i.directiveStart&&function(e,t,n){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=t.type.prototype;if(i){const i=ut(t);(n.preOrderHooks||(n.preOrderHooks=[])).push(e,i),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,i)}r&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-e,r),s&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,s))}(n,s[n],t)}finally{null!==l&&Ee(l),En(a),o.resolving=!1,rn()}}return r}function Bn(e,t,n){return!!(n[t+(e>>5)]&1<<e)}function jn(e,t){return!(e&Ce.Self||e&Ce.Host&&t)}class Un{constructor(e,t){this._tNode=e,this._lView=t}get(e,t){return Dn(this._tNode,this._lView,e,void 0,t)}}function Hn(e){return Se(()=>{const t=e.prototype.constructor,n=t[He]||Vn(t),i=Object.prototype;let r=Object.getPrototypeOf(e.prototype).constructor;for(;r&&r!==i;){const e=r[He]||Vn(r);if(e&&e!==n)return e;r=Object.getPrototypeOf(r)}return e=>new e})}function Vn(e){return le(e)?()=>{const t=Vn(ae(e));return t&&t()}:lt(e)}function Gn(e,t,n){return Se(()=>{const i=function(e){return function(...t){if(e){const n=e(...t);for(const e in n)this[e]=n[e]}}}(t);function r(...e){if(this instanceof r)return i.apply(this,e),this;const t=new r(...e);return n.annotation=t,n;function n(e,n,i){const r=e.hasOwnProperty("__parameters__")?e.__parameters__:Object.defineProperty(e,"__parameters__",{value:[]}).__parameters__;for(;r.length<=i;)r.push(null);return(r[i]=r[i]||[]).push(t),e}}return n&&(r.prototype=Object.create(n.prototype)),r.prototype.ngMetadataName=e,r.annotationCls=r,r})}class Zn{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=pe({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}toString(){return`InjectionToken ${this._desc}`}}function Wn(e,t){void 0===t&&(t=e);for(let n=0;n<e.length;n++){let i=e[n];Array.isArray(i)?(t===e&&(t=e.slice(0,n)),Wn(i,t)):t!==e&&t.push(i)}return t}function Yn(e,t){e.forEach(e=>Array.isArray(e)?Yn(e,t):t(e))}function qn(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function $n(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function Xn(e,t){const n=[];for(let i=0;i<e;i++)n.push(t);return n}function Kn(e,t,n){let i=Jn(e,t);return i>=0?e[1|i]=n:(i=~i,function(e,t,n,i){let r=e.length;if(r==t)e.push(n,i);else if(1===r)e.push(i,e[0]),e[0]=n;else{for(r--,e.push(e[r-1],e[r]);r>t;)e[r]=e[r-2],r--;e[t]=n,e[t+1]=i}}(e,i,t,n)),i}function Qn(e,t){const n=Jn(e,t);if(n>=0)return e[1|n]}function Jn(e,t){return function(e,t,n){let i=0,r=e.length>>1;for(;r!==i;){const n=i+(r-i>>1),s=e[n<<1];if(t===s)return n<<1;s>t?r=n:i=n+1}return~(r<<1)}(e,t)}const ei={},ti=/\n/gm,ni=te({provide:String,useValue:te});let ii;function ri(e){const t=ii;return ii=e,t}function si(e,t=Ce.Default){if(void 0===ii)throw new Error("inject() must be called from an injection context");return null===ii?ke(e,void 0,t):ii.get(e,t&Ce.Optional?null:void 0,t)}function oi(e,t=Ce.Default){return(xe||si)(ae(e),t)}function ai(e){const t=[];for(let n=0;n<e.length;n++){const i=ae(e[n]);if(Array.isArray(i)){if(0===i.length)throw new Error("Arguments array must have arguments.");let e,n=Ce.Default;for(let t=0;t<i.length;t++){const r=i[t],s=r.__NG_DI_FLAG__;"number"==typeof s?-1===s?e=r.token:n|=s:e=r}t.push(oi(e,n))}else t.push(oi(i))}return t}function li(e,t){return e.__NG_DI_FLAG__=t,e.prototype.__NG_DI_FLAG__=t,e}const ci=li(Gn("Inject",e=>({token:e})),-1),hi=li(Gn("Optional"),8),ui=li(Gn("SkipSelf"),4);let di,pi;function fi(e){var t;return(null===(t=function(){if(void 0===di&&(di=null,De.trustedTypes))try{di=De.trustedTypes.createPolicy("angular",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch(t){}return di}())||void 0===t?void 0:t.createHTML(e))||e}function gi(e){var t;return(null===(t=function(){if(void 0===pi&&(pi=null,De.trustedTypes))try{pi=De.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch(t){}return pi}())||void 0===t?void 0:t.createHTML(e))||e}class mi{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class bi extends mi{getTypeName(){return"HTML"}}class yi extends mi{getTypeName(){return"Style"}}class vi extends mi{getTypeName(){return"Script"}}class _i extends mi{getTypeName(){return"URL"}}class wi extends mi{getTypeName(){return"ResourceURL"}}function Ci(e){return e instanceof mi?e.changingThisBreaksApplicationSecurity:e}function xi(e,t){const n=Ei(e);if(null!=n&&n!==t){if("ResourceURL"===n&&"URL"===t)return!0;throw new Error(`Required a safe ${t}, got a ${n} (see https://g.co/ng/security#xss)`)}return n===t}function Ei(e){return e instanceof mi&&e.getTypeName()||null}class ki{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(fi(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch(t){return null}}}class Si{constructor(e){if(this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e);const t=this.inertDocument.createElement("body");e.appendChild(t)}}getInertBodyElement(e){const t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=fi(e),t;const n=this.inertDocument.createElement("body");return n.innerHTML=fi(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}stripCustomNsAttrs(e){const t=e.attributes;for(let i=t.length-1;0<i;i--){const n=t.item(i).name;"xmlns:ns1"!==n&&0!==n.indexOf("ns1:")||e.removeAttribute(n)}let n=e.firstChild;for(;n;)n.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(n),n=n.nextSibling}}const Ti=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Oi=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Ii(e){return(e=String(e)).match(Ti)||e.match(Oi)?e:"unsafe:"+e}function Mi(e){const t={};for(const n of e.split(","))t[n]=!0;return t}function Ai(...e){const t={};for(const n of e)for(const e in n)n.hasOwnProperty(e)&&(t[e]=!0);return t}const Pi=Mi("area,br,col,hr,img,wbr"),Di=Mi("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Ri=Mi("rp,rt"),Fi=Ai(Ri,Di),Ni=Ai(Pi,Ai(Di,Mi("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Ai(Ri,Mi("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Fi),zi=Mi("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Li=Mi("srcset"),Bi=Ai(zi,Li,Mi("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Mi("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),ji=Mi("script,style,template");class Ui{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,n=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let e=this.checkClobberedElement(t,t.nextSibling);if(e){t=e;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!Ni.hasOwnProperty(t))return this.sanitizedSomething=!0,!ji.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const n=e.attributes;for(let r=0;r<n.length;r++){const e=n.item(r),t=e.name,s=t.toLowerCase();if(!Bi.hasOwnProperty(s)){this.sanitizedSomething=!0;continue}let o=e.value;zi[s]&&(o=Ii(o)),Li[s]&&(i=o,o=(i=String(i)).split(",").map(e=>Ii(e.trim())).join(", ")),this.buf.push(" ",t,'="',Gi(o),'"')}var i;return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();Ni.hasOwnProperty(t)&&!Pi.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(Gi(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const Hi=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Vi=/([^\#-~ |!])/g;function Gi(e){return e.replace(/&/g,"&amp;").replace(Hi,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(Vi,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Zi;function Wi(e,t){let n=null;try{Zi=Zi||function(e){const t=new Si(e);return function(){try{return!!(new window.DOMParser).parseFromString(fi(""),"text/html")}catch(e){return!1}}()?new ki(t):t}(e);let i=t?String(t):"";n=Zi.getInertBodyElement(i);let r=5,s=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=s,s=n.innerHTML,n=Zi.getInertBodyElement(i)}while(i!==s);return fi((new Ui).sanitizeChildren(Yi(n)||n))}finally{if(n){const e=Yi(n)||n;for(;e.firstChild;)e.removeChild(e.firstChild)}}}function Yi(e){return"content"in e&&function(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var qi=function(e){return e[e.NONE=0]="NONE",e[e.HTML=1]="HTML",e[e.STYLE=2]="STYLE",e[e.SCRIPT=3]="SCRIPT",e[e.URL=4]="URL",e[e.RESOURCE_URL=5]="RESOURCE_URL",e}({});function $i(e){const t=Ki();return t?gi(t.sanitize(qi.HTML,e)||""):xi(e,"HTML")?gi(Ci(e)):Wi(mt(),he(e))}function Xi(e){const t=Ki();return t?t.sanitize(qi.URL,e)||"":xi(e,"URL")?Ci(e):Ii(he(e))}function Ki(){const e=Dt();return e&&e[12]}function Qi(e){return e.ngDebugContext}function Ji(e){return e.ngOriginalError}function er(e,...t){e.error(...t)}class tr{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e),n=this._findContext(e),i=function(e){return e.ngErrorLogger||er}(e);i(this._console,"ERROR",e),t&&i(this._console,"ORIGINAL ERROR",t),n&&i(this._console,"ERROR CONTEXT",n)}_findContext(e){return e?Qi(e)?Qi(e):this._findContext(Ji(e)):null}_findOriginalError(e){let t=Ji(e);for(;t&&Ji(t);)t=Ji(t);return t}}function nr(e,t){e.__ngContext__=t}const ir=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(De))();function rr(e){return e instanceof Function?e():e}var sr=function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e}({});function or(e,t){return(void 0)(e,t)}function ar(e){const t=e[3];return it(t)?t[3]:t}function lr(e){return hr(e[13])}function cr(e){return hr(e[4])}function hr(e){for(;null!==e&&!it(e);)e=e[4];return e}function ur(e,t,n,i,r){if(null!=i){let s,o=!1;it(i)?s=i:nt(i)&&(o=!0,i=i[0]);const a=vt(i);0===e&&null!==n?null==r?vr(t,n,a):yr(t,n,a,r||null,!0):1===e&&null!==n?yr(t,n,a,r||null,!0):2===e?function(e,t,n){const i=wr(e,t);i&&function(e,t,n,i){bt(e)?e.removeChild(t,n,i):t.removeChild(n)}(e,i,t,n)}(t,a,o):3===e&&t.destroyNode(a),null!=s&&function(e,t,n,i,r){const s=n[7];s!==vt(n)&&ur(t,e,i,s,r);for(let o=10;o<n.length;o++){const r=n[o];Ir(r[1],r,e,t,i,s)}}(t,e,s,n,r)}}function dr(e,t,n){return bt(e)?e.createElement(t,n):null===n?e.createElement(t):e.createElementNS(n,t)}function pr(e,t){const n=e[9],i=n.indexOf(t),r=t[3];1024&t[2]&&(t[2]&=-1025,Mt(r,-1)),n.splice(i,1)}function fr(e,t){if(e.length<=10)return;const n=10+t,i=e[n];if(i){const s=i[17];null!==s&&s!==e&&pr(s,i),t>0&&(e[n-1][4]=i[4]);const o=$n(e,10+t);Ir(i[1],r=i,r[11],2,null,null),r[0]=null,r[6]=null;const a=o[19];null!==a&&a.detachView(o[1]),i[3]=null,i[4]=null,i[2]&=-129}var r;return i}function gr(e,t){if(!(256&t[2])){const n=t[11];bt(n)&&n.destroyNode&&Ir(e,t,n,3,null,null),function(e){let t=e[13];if(!t)return mr(e[1],e);for(;t;){let n=null;if(nt(t))n=t[13];else{const e=t[10];e&&(n=e)}if(!n){for(;t&&!t[4]&&t!==e;)nt(t)&&mr(t[1],t),t=t[3];null===t&&(t=e),nt(t)&&mr(t[1],t),n=t&&t[4]}t=n}}(t)}}function mr(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){let n;if(null!=e&&null!=(n=e.destroyHooks))for(let i=0;i<n.length;i+=2){const e=t[n[i]];if(!(e instanceof gn)){const t=n[i+1];if(Array.isArray(t))for(let n=0;n<t.length;n+=2)t[n+1].call(e[t[n]]);else t.call(e)}}}(e,t),function(e,t){const n=e.cleanup,i=t[7];let r=-1;if(null!==n)for(let s=0;s<n.length-1;s+=2)if("string"==typeof n[s]){const e=n[s+1],o="function"==typeof e?e(t):vt(t[e]),a=i[r=n[s+2]],l=n[s+3];"boolean"==typeof l?o.removeEventListener(n[s],a,l):l>=0?i[r=l]():i[r=-l].unsubscribe(),s+=2}else{const e=i[r=n[s+1]];n[s].call(e)}if(null!==i){for(let e=r+1;e<i.length;e++)(0,i[e])();t[7]=null}}(e,t),1===t[1].type&&bt(t[11])&&t[11].destroy();const n=t[17];if(null!==n&&it(t[3])){n!==t[3]&&pr(n,t);const i=t[19];null!==i&&i.detachView(e)}}}function br(e,t,n){return function(e,t,n){let i=t;for(;null!==i&&40&i.type;)i=(t=i).parent;if(null===i)return n[0];if(2&i.flags){const t=e.data[i.directiveStart].encapsulation;if(t===Oe.None||t===Oe.Emulated)return null}return wt(i,n)}(e,t.parent,n)}function yr(e,t,n,i,r){bt(e)?e.insertBefore(t,n,i,r):t.insertBefore(n,i,r)}function vr(e,t,n){bt(e)?e.appendChild(t,n):t.appendChild(n)}function _r(e,t,n,i,r){null!==i?yr(e,t,n,i,r):vr(e,t,n)}function wr(e,t){return bt(e)?e.parentNode(t):t.parentNode}function Cr(e,t,n){return xr(e,t,n)}let xr=function(e,t,n){return 40&e.type?wt(e,n):null};function Er(e,t,n,i){const r=br(e,i,t),s=t[11],o=Cr(i.parent||t[6],i,t);if(null!=r)if(Array.isArray(n))for(let a=0;a<n.length;a++)_r(s,r,n[a],o,!1);else _r(s,r,n,o,!1)}function kr(e,t){if(null!==t){const n=t.type;if(3&n)return wt(t,e);if(4&n)return Tr(-1,e[t.index]);if(8&n){const n=t.child;if(null!==n)return kr(e,n);{const n=e[t.index];return it(n)?Tr(-1,n):vt(n)}}if(32&n)return or(t,e)()||vt(e[t.index]);{const n=Sr(e,t);return null!==n?Array.isArray(n)?n[0]:kr(ar(e[16]),n):kr(e,t.next)}}return null}function Sr(e,t){return null!==t?e[16][6].projection[t.projection]:null}function Tr(e,t){const n=10+e+1;if(n<t.length){const e=t[n],i=e[1].firstChild;if(null!==i)return kr(e,i)}return t[7]}function Or(e,t,n,i,r,s,o){for(;null!=n;){const a=i[n.index],l=n.type;if(o&&0===t&&(a&&nr(vt(a),i),n.flags|=4),64!=(64&n.flags))if(8&l)Or(e,t,n.child,i,r,s,!1),ur(t,e,r,a,s);else if(32&l){const o=or(n,i);let l;for(;l=o();)ur(t,e,r,l,s);ur(t,e,r,a,s)}else 16&l?Mr(e,t,i,n,r,s):ur(t,e,r,a,s);n=o?n.projectionNext:n.next}}function Ir(e,t,n,i,r,s){Or(n,i,e.firstChild,t,r,s,!1)}function Mr(e,t,n,i,r,s){const o=n[16],a=o[6].projection[i.projection];if(Array.isArray(a))for(let l=0;l<a.length;l++)ur(t,e,r,a[l],s);else Or(e,t,a,o[3],r,s,!0)}function Ar(e,t,n){bt(e)?e.setAttribute(t,"style",n):t.style.cssText=n}function Pr(e,t,n){bt(e)?""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n):t.className=n}function Dr(e,t,n){let i=e.length;for(;;){const r=e.indexOf(t,n);if(-1===r)return r;if(0===r||e.charCodeAt(r-1)<=32){const n=t.length;if(r+n===i||e.charCodeAt(r+n)<=32)return r}n=r+1}}function Rr(e,t,n){let i=0;for(;i<e.length;){let r=e[i++];if(n&&"class"===r){if(r=e[i],-1!==Dr(r.toLowerCase(),t,0))return!0}else if(1===r){for(;i<e.length&&"string"==typeof(r=e[i++]);)if(r.toLowerCase()===t)return!0;return!1}}return!1}function Fr(e){return 4===e.type&&"ng-template"!==e.value}function Nr(e,t,n){return t===(4!==e.type||n?e.value:"ng-template")}function zr(e,t,n){let i=4;const r=e.attrs||[],s=function(e){for(let n=0;n<e.length;n++)if(3===(t=e[n])||4===t||6===t)return n;var t;return e.length}(r);let o=!1;for(let a=0;a<t.length;a++){const l=t[a];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!Nr(e,l,n)||""===l&&1===t.length){if(Lr(i))return!1;o=!0}}else{const c=8&i?l:t[++a];if(8&i&&null!==e.attrs){if(!Rr(e.attrs,c,n)){if(Lr(i))return!1;o=!0}continue}const h=Br(8&i?"class":l,r,Fr(e),n);if(-1===h){if(Lr(i))return!1;o=!0;continue}if(""!==c){let e;e=h>s?"":r[h+1].toLowerCase();const t=8&i?e:null;if(t&&-1!==Dr(t,c,0)||2&i&&c!==e){if(Lr(i))return!1;o=!0}}}}else{if(!o&&!Lr(i)&&!Lr(l))return!1;if(o&&Lr(l))continue;o=!1,i=l|1&i}}return Lr(i)||o}function Lr(e){return 0==(1&e)}function Br(e,t,n,i){if(null===t)return-1;let r=0;if(i||!n){let n=!1;for(;r<t.length;){const i=t[r];if(i===e)return r;if(3===i||6===i)n=!0;else{if(1===i||2===i){let e=t[++r];for(;"string"==typeof e;)e=t[++r];continue}if(4===i)break;if(0===i){r+=4;continue}}r+=n?1:2}return-1}return function(e,t){let n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){const i=e[n];if("number"==typeof i)return-1;if(i===t)return n;n++}return-1}(t,e)}function jr(e,t,n=!1){for(let i=0;i<t.length;i++)if(zr(e,t[i],n))return!0;return!1}function Ur(e,t){e:for(let n=0;n<t.length;n++){const i=t[n];if(e.length===i.length){for(let t=0;t<e.length;t++)if(e[t]!==i[t])continue e;return!0}}return!1}function Hr(e,t){return e?":not("+t.trim()+")":t}function Vr(e){let t=e[0],n=1,i=2,r="",s=!1;for(;n<e.length;){let o=e[n];if("string"==typeof o)if(2&i){const t=e[++n];r+="["+o+(t.length>0?'="'+t+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""===r||Lr(o)||(t+=Hr(s,r),r=""),i=o,s=s||!Lr(i);n++}return""!==r&&(t+=Hr(s,r)),t}const Gr={};function Zr(e){Wr(Rt(),Dt(),on()+e,Ut())}function Wr(e,t,n,i){if(!i)if(3==(3&t[2])){const i=e.preOrderCheckHooks;null!==i&&hn(t,i,n)}else{const i=e.preOrderHooks;null!==i&&un(t,i,0,n)}an(n)}function Yr(e,t){return e<<17|t<<2}function qr(e){return e>>17&32767}function $r(e){return 2|e}function Xr(e){return(131068&e)>>2}function Kr(e,t){return-131069&e|t<<2}function Qr(e){return 1|e}function Jr(e,t){const n=e.contentQueries;if(null!==n)for(let i=0;i<n.length;i+=2){const r=n[i],s=n[i+1];if(-1!==s){const n=e.data[s];Xt(r),n.contentQueries(2,t[s],s)}}}function es(e,t,n,i,r,s,o,a,l,c){const h=t.blueprint.slice();return h[0]=r,h[2]=140|i,It(h),h[3]=h[15]=e,h[8]=n,h[10]=o||e&&e[10],h[11]=a||e&&e[11],h[12]=l||e&&e[12]||null,h[9]=c||e&&e[9]||null,h[6]=s,h[16]=2==t.type?e[16]:h,h}function ts(e,t,n,i,r){let s=e.data[t];if(null===s)s=function(e,t,n,i,r){const s=zt(),o=Bt(),a=e.data[t]=function(e,t,n,i,r,s){return{type:n,index:i,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,n,t,i,r);return null===e.firstChild&&(e.firstChild=a),null!==s&&(o?null==s.child&&null!==a.parent&&(s.child=a):null===s.next&&(s.next=a)),a}(e,t,n,i,r),At.lFrame.inI18n&&(s.flags|=64);else if(64&s.type){s.type=n,s.value=i,s.attrs=r;const e=function(){const e=At.lFrame,t=e.currentTNode;return e.isParent?t:t.parent}();s.injectorIndex=null===e?-1:e.injectorIndex}return Lt(s,!0),s}function ns(e,t,n,i){if(0===n)return-1;const r=t.length;for(let s=0;s<n;s++)t.push(i),e.blueprint.push(i),e.data.push(null);return r}function is(e,t,n){Jt(t);try{const i=e.viewQuery;null!==i&&Ds(1,i,n);const r=e.template;null!==r&&os(e,t,r,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&Jr(e,t),e.staticViewQueries&&Ds(2,e.viewQuery,n);const s=e.components;null!==s&&function(e,t){for(let n=0;n<t.length;n++)Os(e,t[n])}(t,s)}catch(i){throw e.firstCreatePass&&(e.incompleteFirstPass=!0),i}finally{t[2]&=-5,sn()}}function rs(e,t,n,i){const r=t[2];if(256==(256&r))return;Jt(t);const s=Ut();try{It(t),At.lFrame.bindingIndex=e.bindingStartIndex,null!==n&&os(e,t,n,2,i);const o=3==(3&r);if(!s)if(o){const n=e.preOrderCheckHooks;null!==n&&hn(t,n,null)}else{const n=e.preOrderHooks;null!==n&&un(t,n,0,null),dn(t,0)}if(function(e){for(let t=lr(e);null!==t;t=cr(t)){if(!t[2])continue;const e=t[9];for(let t=0;t<e.length;t++){const n=e[t],i=n[3];0==(1024&n[2])&&Mt(i,1),n[2]|=1024}}}(t),function(e){for(let t=lr(e);null!==t;t=cr(t))for(let e=10;e<t.length;e++){const n=t[e],i=n[1];Tt(n)&&rs(i,n,i.template,n[8])}}(t),null!==e.contentQueries&&Jr(e,t),!s)if(o){const n=e.contentCheckHooks;null!==n&&hn(t,n)}else{const n=e.contentHooks;null!==n&&un(t,n,1),dn(t,1)}!function(e,t){const n=e.hostBindingOpCodes;if(null!==n)try{for(let e=0;e<n.length;e++){const i=n[e];if(i<0)an(~i);else{const r=i,s=n[++e],o=n[++e];Yt(s,r),o(2,t[r])}}}finally{an(-1)}}(e,t);const a=e.components;null!==a&&function(e,t){for(let n=0;n<t.length;n++)Ss(e,t[n])}(t,a);const l=e.viewQuery;if(null!==l&&Ds(2,l,i),!s)if(o){const n=e.viewCheckHooks;null!==n&&hn(t,n)}else{const n=e.viewHooks;null!==n&&un(t,n,2),dn(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),s||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,Mt(t[3],-1))}finally{sn()}}function ss(e,t,n,i){const r=t[10],s=!Ut(),o=St(t);try{s&&!o&&r.begin&&r.begin(),o&&is(e,t,i),rs(e,t,n,i)}finally{s&&!o&&r.end&&r.end()}}function os(e,t,n,i,r){const s=on(),o=2&i;try{an(-1),o&&t.length>20&&Wr(e,t,20,Ut()),n(i,r)}finally{an(s)}}function as(e,t,n){if(rt(t)){const i=t.directiveEnd;for(let r=t.directiveStart;r<i;r++){const t=e.data[r];t.contentQueries&&t.contentQueries(1,n[r],r)}}}function ls(e,t,n){Pt()&&(function(e,t,n,i){const r=n.directiveStart,s=n.directiveEnd;e.firstCreatePass||Sn(n,t),nr(i,t);const o=n.initialInputs;for(let a=r;a<s;a++){const i=e.data[a],s=at(i);s&&Cs(t,n,i);const l=Ln(t,e,a,n);nr(l,t),null!==o&&xs(0,a-r,l,i,0,o),s&&(Et(n.index,t)[8]=l)}}(e,t,n,wt(n,t)),128==(128&n.flags)&&function(e,t,n){const i=n.directiveStart,r=n.directiveEnd,s=n.index,o=At.lFrame.currentDirectiveIndex;try{an(s);for(let n=i;n<r;n++){const i=e.data[n],r=t[n];qt(n),null===i.hostBindings&&0===i.hostVars&&null===i.hostAttrs||bs(i,r)}}finally{an(-1),qt(o)}}(e,t,n))}function cs(e,t,n=wt){const i=t.localNames;if(null!==i){let r=t.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?n(t,e):e[o];e[r++]=a}}}function hs(e){const t=e.tView;return null===t||t.incompleteFirstPass?e.tView=us(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function us(e,t,n,i,r,s,o,a,l,c){const h=20+i,u=h+r,d=function(e,t){const n=[];for(let i=0;i<t;i++)n.push(i<e?null:Gr);return n}(h,u),p="function"==typeof c?c():c;return d[1]={type:e,blueprint:d,template:n,queries:null,viewQuery:a,declTNode:t,data:d.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:u,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:p,incompleteFirstPass:!1}}function ds(e,t,n,i){const r=Fs(t);null===n?r.push(i):(r.push(n),e.firstCreatePass&&Ns(e).push(i,r.length-1))}function ps(e,t,n){for(let i in e)if(e.hasOwnProperty(i)){const r=e[i];(n=null===n?{}:n).hasOwnProperty(i)?n[i].push(t,r):n[i]=[t,r]}return n}function fs(e,t,n,i,r,s,o,a){const l=wt(t,n);let c,h=t.inputs;!a&&null!=h&&(c=h[i])?(Ls(e,n,c,i,r),st(t)&&function(e,t){const n=Et(t,e);16&n[2]||(n[2]|=64)}(n,t.index)):3&t.type&&(i=function(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(i),r=null!=o?o(r,t.value||"",i):r,bt(s)?s.setProperty(l,i,r):bn(i)||(l.setProperty?l.setProperty(i,r):l[i]=r))}function gs(e,t,n,i){let r=!1;if(Pt()){const s=function(e,t,n){const i=e.directiveRegistry;let r=null;if(i)for(let s=0;s<i.length;s++){const o=i[s];jr(n,o.selectors,!1)&&(r||(r=[]),Mn(Sn(n,t),e,o.type),at(o)?(ys(e,n),r.unshift(o)):r.push(o))}return r}(e,t,n),o=null===i?null:{"":-1};if(null!==s){r=!0,_s(n,e.data.length,s.length);for(let e=0;e<s.length;e++){const t=s[e];t.providersResolver&&t.providersResolver(t)}let i=!1,a=!1,l=ns(e,t,s.length,null);for(let r=0;r<s.length;r++){const c=s[r];n.mergedAttrs=yn(n.mergedAttrs,c.hostAttrs),ws(e,n,t,l,c),vs(l,c,o),null!==c.contentQueries&&(n.flags|=8),null===c.hostBindings&&null===c.hostAttrs&&0===c.hostVars||(n.flags|=128);const h=c.type.prototype;!i&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index),i=!0),a||!h.ngOnChanges&&!h.ngDoCheck||((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index),a=!0),l++}!function(e,t){const n=t.directiveEnd,i=e.data,r=t.attrs,s=[];let o=null,a=null;for(let l=t.directiveStart;l<n;l++){const e=i[l],n=e.inputs,c=null===r||Fr(t)?null:Es(n,r);s.push(c),o=ps(n,l,o),a=ps(e.outputs,l,a)}null!==o&&(o.hasOwnProperty("class")&&(t.flags|=16),o.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=s,t.inputs=o,t.outputs=a}(e,n)}o&&function(e,t,n){if(t){const i=e.localNames=[];for(let e=0;e<t.length;e+=2){const r=n[t[e+1]];if(null==r)throw new ce("301",`Export of name '${t[e+1]}' not found!`);i.push(t[e],r)}}}(n,i,o)}return n.mergedAttrs=yn(n.mergedAttrs,n.attrs),r}function ms(e,t,n,i,r,s){const o=s.hostBindings;if(o){let n=e.hostBindingOpCodes;null===n&&(n=e.hostBindingOpCodes=[]);const s=~t.index;(function(e){let t=e.length;for(;t>0;){const n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(n)!=s&&n.push(s),n.push(i,r,o)}}function bs(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function ys(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function vs(e,t,n){if(n){if(t.exportAs)for(let i=0;i<t.exportAs.length;i++)n[t.exportAs[i]]=e;at(t)&&(n[""]=e)}}function _s(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function ws(e,t,n,i,r){e.data[i]=r;const s=r.factory||(r.factory=lt(r.type)),o=new gn(s,at(r),null);e.blueprint[i]=o,n[i]=o,ms(e,t,0,i,ns(e,n,r.hostVars,Gr),r)}function Cs(e,t,n){const i=wt(t,e),r=hs(n),s=e[10],o=Is(e,es(e,r,null,n.onPush?64:16,i,t,s,s.createRenderer(i,n),null,null));e[t.index]=o}function xs(e,t,n,i,r,s){const o=s[t];if(null!==o){const e=i.setInput;for(let t=0;t<o.length;){const r=o[t++],s=o[t++],a=o[t++];null!==e?i.setInput(n,a,r,s):n[s]=a}}}function Es(e,t){let n=null,i=0;for(;i<t.length;){const r=t[i];if(0!==r)if(5!==r){if("number"==typeof r)break;e.hasOwnProperty(r)&&(null===n&&(n=[]),n.push(r,e[r],t[i+1])),i+=2}else i+=2;else i+=4}return n}function ks(e,t,n,i){return new Array(e,!0,!1,t,null,0,i,n,null,null)}function Ss(e,t){const n=Et(t,e);if(Tt(n)){const e=n[1];80&n[2]?rs(e,n,e.template,n[8]):n[5]>0&&Ts(n)}}function Ts(e){for(let n=lr(e);null!==n;n=cr(n))for(let e=10;e<n.length;e++){const t=n[e];if(1024&t[2]){const e=t[1];rs(e,t,e.template,t[8])}else t[5]>0&&Ts(t)}const t=e[1].components;if(null!==t)for(let n=0;n<t.length;n++){const i=Et(t[n],e);Tt(i)&&i[5]>0&&Ts(i)}}function Os(e,t){const n=Et(t,e),i=n[1];!function(e,t){for(let n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])}(i,n),is(i,n,n[8])}function Is(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function Ms(e){for(;e;){e[2]|=64;const t=ar(e);if(0!=(512&e[2])&&!t)return e;e=t}return null}function As(e,t,n){const i=t[10];i.begin&&i.begin();try{rs(e,t,e.template,n)}catch(r){throw zs(t,r),r}finally{i.end&&i.end()}}function Ps(e){!function(e){for(let t=0;t<e.components.length;t++){const n=e.components[t],i=kt(n),r=i[1];ss(r,i,r.template,n)}}(e[8])}function Ds(e,t,n){Xt(0),t(e,n)}const Rs=(()=>Promise.resolve(null))();function Fs(e){return e[7]||(e[7]=[])}function Ns(e){return e.cleanup||(e.cleanup=[])}function zs(e,t){const n=e[9],i=n?n.get(tr,null):null;i&&i.handleError(t)}function Ls(e,t,n,i,r){for(let s=0;s<n.length;){const o=n[s++],a=n[s++],l=t[o],c=e.data[o];null!==c.setInput?c.setInput(l,r,i,a):l[a]=r}}function Bs(e,t,n){const i=_t(t,e);!function(e,t,n){bt(e)?e.setValue(t,n):t.textContent=n}(e[11],i,n)}function js(e,t,n){let i=n?e.styles:null,r=n?e.classes:null,s=0;if(null!==t)for(let o=0;o<t.length;o++){const e=t[o];"number"==typeof e?s=e:1==s?r=re(r,e):2==s&&(i=re(i,e+": "+t[++o]+";"))}n?e.styles=i:e.stylesWithoutHost=i,n?e.classes=r:e.classesWithoutHost=r}const Us=new Zn("INJECTOR",-1);class Hs{get(e,t=ei){if(t===ei){const t=new Error(`NullInjectorError: No provider for ${ie(e)}!`);throw t.name="NullInjectorError",t}return t}}const Vs=new Zn("Set Injector scope."),Gs={},Zs={},Ws=[];let Ys;function qs(){return void 0===Ys&&(Ys=new Hs),Ys}function $s(e,t=null,n=null,i){return new Xs(e,n,t||qs(),i)}class Xs{constructor(e,t,n,i=null){this.parent=n,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const r=[];t&&Yn(t,n=>this.processProvider(n,e,t)),Yn([e],e=>this.processInjectorType(e,[],r)),this.records.set(Us,Js(void 0,this));const s=this.records.get(Vs);this.scope=null!=s?s.value:null,this.source=i||("object"==typeof e?null:ie(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,t=ei,n=Ce.Default){this.assertNotDestroyed();const i=ri(this);try{if(!(n&Ce.SkipSelf)){let t=this.records.get(e);if(void 0===t){const n=("function"==typeof(r=e)||"object"==typeof r&&r instanceof Zn)&&ge(e);t=n&&this.injectableDefInScope(n)?Js(Ks(e),Gs):null,this.records.set(e,t)}if(null!=t)return this.hydrate(e,t)}return(n&Ce.Self?qs():this.parent).get(e,t=n&Ce.Optional&&t===ei?null:t)}catch(s){if("NullInjectorError"===s.name){if((s.ngTempTokenPath=s.ngTempTokenPath||[]).unshift(ie(e)),i)throw s;return function(e,t,n,i){const r=e.ngTempTokenPath;throw t.__source&&r.unshift(t.__source),e.message=function(e,t,n,i=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;let r=ie(t);if(Array.isArray(t))r=t.map(ie).join(" -> ");else if("object"==typeof t){let e=[];for(let n in t)if(t.hasOwnProperty(n)){let i=t[n];e.push(n+":"+("string"==typeof i?JSON.stringify(i):ie(i)))}r=`{${e.join(", ")}}`}return`${n}${i?"("+i+")":""}[${r}]: ${e.replace(ti,"\n  ")}`}("\n"+e.message,r,n,i),e.ngTokenPath=r,e.ngTempTokenPath=null,e}(s,e,"R3InjectorError",this.source)}throw s}finally{ri(i)}var r}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((t,n)=>e.push(ie(n))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(e,t,n){if(!(e=ae(e)))return!1;let i=be(e);const r=null==i&&e.ngModule||void 0,s=void 0===r?e:r,o=-1!==n.indexOf(s);if(void 0!==r&&(i=be(r)),null==i)return!1;if(null!=i.imports&&!o){let e;n.push(s);try{Yn(i.imports,i=>{this.processInjectorType(i,t,n)&&(void 0===e&&(e=[]),e.push(i))})}finally{}if(void 0!==e)for(let t=0;t<e.length;t++){const{ngModule:n,providers:i}=e[t];Yn(i,e=>this.processProvider(e,n,i||Ws))}}this.injectorDefTypes.add(s);const a=lt(s)||(()=>new s);this.records.set(s,Js(a,Gs));const l=i.providers;if(null!=l&&!o){const t=e;Yn(l,e=>this.processProvider(e,t,l))}return void 0!==r&&void 0!==e.providers}processProvider(e,t,n){let i=to(e=ae(e))?e:ae(e&&e.provide);const r=function(e,t,n){return eo(e)?Js(void 0,e.useValue):Js(Qs(e),Gs)}(e);if(to(e)||!0!==e.multi)this.records.get(i);else{let t=this.records.get(i);t||(t=Js(void 0,Gs,!0),t.factory=()=>ai(t.multi),this.records.set(i,t)),i=e,t.multi.push(e)}this.records.set(i,r)}hydrate(e,t){var n;return t.value===Gs&&(t.value=Zs,t.value=t.factory()),"object"==typeof t.value&&t.value&&null!==(n=t.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(t.value),t.value}injectableDefInScope(e){return!!e.providedIn&&("string"==typeof e.providedIn?"any"===e.providedIn||e.providedIn===this.scope:this.injectorDefTypes.has(e.providedIn))}}function Ks(e){const t=ge(e),n=null!==t?t.factory:lt(e);if(null!==n)return n;if(e instanceof Zn)throw new Error(`Token ${ie(e)} is missing a \u0275prov definition.`);if(e instanceof Function)return function(e){const t=e.length;if(t>0){const n=Xn(t,"?");throw new Error(`Can't resolve all parameters for ${ie(e)}: (${n.join(", ")}).`)}const n=function(e){const t=e&&(e[ye]||e[_e]);if(t){const n=function(e){if(e.hasOwnProperty("name"))return e.name;const t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn(`DEPRECATED: DI is instantiating a token "${n}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${n}" class.`),t}return null}(e);return null!==n?()=>n.factory(e):()=>new e}(e);throw new Error("unreachable")}function Qs(e,t,n){let i;if(to(e)){const t=ae(e);return lt(t)||Ks(t)}if(eo(e))i=()=>ae(e.useValue);else if((r=e)&&r.useFactory)i=()=>e.useFactory(...ai(e.deps||[]));else if(function(e){return!(!e||!e.useExisting)}(e))i=()=>oi(ae(e.useExisting));else{const t=ae(e&&(e.useClass||e.provide));if(!function(e){return!!e.deps}(e))return lt(t)||Ks(t);i=()=>new t(...ai(e.deps))}var r;return i}function Js(e,t,n=!1){return{factory:e,value:t,multi:n?[]:void 0}}function eo(e){return null!==e&&"object"==typeof e&&ni in e}function to(e){return"function"==typeof e}const no=function(e,t,n){return function(e,t=null,n=null,i){const r=$s(e,t,n,i);return r._resolveInjectorDefTypes(),r}({name:n},t,e,n)};let io=(()=>{class e{static create(e,t){return Array.isArray(e)?no(e,t,""):no(e.providers,e.parent,e.name||"")}}return e.THROW_IF_NOT_FOUND=ei,e.NULL=new Hs,e.\u0275prov=pe({token:e,providedIn:"any",factory:()=>oi(Us)}),e.__NG_ELEMENT_ID__=-1,e})();function ro(e,t){cn(kt(e)[1],Nt())}function so(e){let t=Object.getPrototypeOf(e.type.prototype).constructor,n=!0;const i=[e];for(;t;){let r;if(at(e))r=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");r=t.\u0275dir}if(r){if(n){i.push(r);const t=e;t.inputs=oo(e.inputs),t.declaredInputs=oo(e.declaredInputs),t.outputs=oo(e.outputs);const n=r.hostBindings;n&&co(e,n);const s=r.viewQuery,o=r.contentQueries;if(s&&ao(e,s),o&&lo(e,o),ne(e.inputs,r.inputs),ne(e.declaredInputs,r.declaredInputs),ne(e.outputs,r.outputs),at(r)&&r.data.animation){const t=e.data;t.animation=(t.animation||[]).concat(r.data.animation)}}const t=r.features;if(t)for(let i=0;i<t.length;i++){const r=t[i];r&&r.ngInherit&&r(e),r===so&&(n=!1)}}t=Object.getPrototypeOf(t)}!function(e){let t=0,n=null;for(let i=e.length-1;i>=0;i--){const r=e[i];r.hostVars=t+=r.hostVars,r.hostAttrs=yn(r.hostAttrs,n=yn(n,r.hostAttrs))}}(i)}function oo(e){return e===Re?{}:e===Ne?[]:e}function ao(e,t){const n=e.viewQuery;e.viewQuery=n?(e,i)=>{t(e,i),n(e,i)}:t}function lo(e,t){const n=e.contentQueries;e.contentQueries=n?(e,i,r)=>{t(e,i,r),n(e,i,r)}:t}function co(e,t){const n=e.hostBindings;e.hostBindings=n?(e,i)=>{t(e,i),n(e,i)}:t}let ho=null;function uo(){if(!ho){const e=De.Symbol;if(e&&e.iterator)ho=e.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const n=e[t];"entries"!==n&&"size"!==n&&Map.prototype[n]===Map.prototype.entries&&(ho=n)}}}return ho}class po{constructor(e){this.wrapped=e}static wrap(e){return new po(e)}static unwrap(e){return po.isWrapped(e)?e.wrapped:e}static isWrapped(e){return e instanceof po}}function fo(e){return!!go(e)&&(Array.isArray(e)||!(e instanceof Map)&&uo()in e)}function go(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function mo(e,t,n){return e[t]=n}function bo(e,t){return e[t]}function yo(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function vo(e,t,n,i){const r=yo(e,t,n);return yo(e,t+1,i)||r}function _o(e,t,n,i,r){const s=vo(e,t,n,i);return yo(e,t+2,r)||s}function wo(e,t,n,i,r,s){const o=vo(e,t,n,i);return vo(e,t+2,r,s)||o}function Co(e,t,n,i){const r=Dt();return yo(r,Zt(),t)&&(Rt(),function(e,t,n,i,r,s){const o=wt(e,t);!function(e,t,n,i,r,s,o){if(null==s)bt(e)?e.removeAttribute(t,r,n):t.removeAttribute(r);else{const a=null==o?he(s):o(s,i||"",r);bt(e)?e.setAttribute(t,r,a,n):n?t.setAttributeNS(n,r,a):t.setAttribute(r,a)}}(t[11],o,s,e.value,n,i,r)}(ln(),r,e,t,n,i)),Co}function xo(e,t,n,i){return yo(e,Zt(),n)?t+he(n)+i:Gr}function Eo(e,t,n,i,r,s,o,a){const l=Dt(),c=Rt(),h=e+20,u=c.firstCreatePass?function(e,t,n,i,r,s,o,a,l){const c=t.consts,h=ts(t,e,4,o||null,Ot(c,a));gs(t,n,h,Ot(c,l)),cn(t,h);const u=h.tViews=us(2,h,i,r,s,t.directiveRegistry,t.pipeRegistry,null,t.schemas,c);return null!==t.queries&&(t.queries.template(t,h),u.queries=t.queries.embeddedTView(h)),h}(h,c,l,t,n,i,r,s,o):c.data[h];Lt(u,!1);const d=l[11].createComment("");Er(c,l,d,u),nr(d,l),Is(l,l[h]=ks(d,l,d,u)),ot(u)&&ls(c,l,u),null!=o&&cs(l,u,a)}function ko(e){return xt(At.lFrame.contextLView,20+e)}function So(e,t=Ce.Default){const n=Dt();return null===n?oi(e,t):Dn(Nt(),n,ae(e),t)}function To(e,t,n){const i=Dt();return yo(i,Zt(),t)&&fs(Rt(),ln(),i,e,t,i[11],n,!1),To}function Oo(e,t,n,i,r){const s=r?"class":"style";Ls(e,n,t.inputs[s],s,i)}function Io(e,t,n,i){const r=Dt(),s=Rt(),o=20+e,a=r[11],l=r[o]=dr(a,t,At.lFrame.currentNamespace),c=s.firstCreatePass?function(e,t,n,i,r,s,o){const a=t.consts,l=ts(t,e,2,r,Ot(a,s));return gs(t,n,l,Ot(a,o)),null!==l.attrs&&js(l,l.attrs,!1),null!==l.mergedAttrs&&js(l,l.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,l),l}(o,s,r,0,t,n,i):s.data[o];Lt(c,!0);const h=c.mergedAttrs;null!==h&&mn(a,l,h);const u=c.classes;null!==u&&Pr(a,l,u);const d=c.styles;null!==d&&Ar(a,l,d),64!=(64&c.flags)&&Er(s,r,l,c),0===At.lFrame.elementDepthCount&&nr(l,r),At.lFrame.elementDepthCount++,ot(c)&&(ls(s,r,c),as(s,c,r)),null!==i&&cs(r,c)}function Mo(){let e=Nt();Bt()?jt():(e=e.parent,Lt(e,!1));const t=e;At.lFrame.elementDepthCount--;const n=Rt();n.firstCreatePass&&(cn(n,e),rt(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function(e){return 0!=(16&e.flags)}(t)&&Oo(n,t,Dt(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function(e){return 0!=(32&e.flags)}(t)&&Oo(n,t,Dt(),t.stylesWithoutHost,!1)}function Ao(e,t,n,i){Io(e,t,n,i),Mo()}function Po(e,t,n){const i=Dt(),r=Rt(),s=e+20,o=r.firstCreatePass?function(e,t,n,i,r){const s=t.consts,o=Ot(s,i),a=ts(t,e,8,"ng-container",o);return null!==o&&js(a,o,!0),gs(t,n,a,Ot(s,r)),null!==t.queries&&t.queries.elementStart(t,a),a}(s,r,i,t,n):r.data[s];Lt(o,!0);const a=i[s]=i[11].createComment("");Er(r,i,a,o),nr(a,i),ot(o)&&(ls(r,i,o),as(r,o,i)),null!=n&&cs(i,o)}function Do(){let e=Nt();const t=Rt();Bt()?jt():(e=e.parent,Lt(e,!1)),t.firstCreatePass&&(cn(t,e),rt(e)&&t.queries.elementEnd(e))}function Ro(e,t,n){Po(e,t,n),Do()}function Fo(){return Dt()}function No(e){return!!e&&"function"==typeof e.then}function zo(e,t,n=!1,i){const r=Dt(),s=Rt(),o=Nt();return function(e,t,n,i,r,s,o=!1,a){const l=ot(i),c=e.firstCreatePass&&Ns(e),h=Fs(t);let u=!0;if(3&i.type){const d=wt(i,t),p=a?a(d):Re,f=p.target||d,g=h.length,m=a?e=>a(vt(e[i.index])).target:i.index;if(bt(n)){let o=null;if(!a&&l&&(o=function(e,t,n,i){const r=e.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const e=r[s];if(e===n&&r[s+1]===i){const e=t[7],n=r[s+2];return e.length>n?e[n]:null}"string"==typeof e&&(s+=2)}return null}(e,t,r,i.index)),null!==o)(o.__ngLastListenerFn__||o).__ngNextListenerFn__=s,o.__ngLastListenerFn__=s,u=!1;else{s=Bo(i,t,0,s,!1);const e=n.listen(p.name||f,r,s);h.push(s,e),c&&c.push(r,m,g,g+1)}}else s=Bo(i,t,0,s,!0),f.addEventListener(r,s,o),h.push(s),c&&c.push(r,m,g,o)}else s=Bo(i,t,0,s,!1);const d=i.outputs;let p;if(u&&null!==d&&(p=d[r])){const e=p.length;if(e)for(let n=0;n<e;n+=2){const e=t[p[n]][p[n+1]].subscribe(s),o=h.length;h.push(s,e),c&&c.push(r,i.index,o,-(o+1))}}}(s,r,r[11],o,e,t,n,i),zo}function Lo(e,t,n,i){try{return!1!==n(i)}catch(r){return zs(e,r),!1}}function Bo(e,t,n,i,r){return function n(s){if(s===Function)return i;const o=2&e.flags?Et(e.index,t):t;0==(32&t[2])&&Ms(o);let a=Lo(t,0,i,s),l=n.__ngNextListenerFn__;for(;l;)a=Lo(t,0,l,s)&&a,l=l.__ngNextListenerFn__;return r&&!1===a&&(s.preventDefault(),s.returnValue=!1),a}}function jo(e=1){return function(e){return(At.lFrame.contextLView=function(e,t){for(;e>0;)t=t[15],e--;return t}(e,At.lFrame.contextLView))[8]}(e)}function Uo(e,t){let n=null;const i=function(e){const t=e.attrs;if(null!=t){const e=t.indexOf(5);if(0==(1&e))return t[e+1]}return null}(e);for(let r=0;r<t.length;r++){const s=t[r];if("*"!==s){if(null===i?jr(e,s,!0):Ur(i,s))return r}else n=r}return n}function Ho(e){const t=Dt()[16][6];if(!t.projection){const n=t.projection=Xn(e?e.length:1,null),i=n.slice();let r=t.child;for(;null!==r;){const t=e?Uo(r,e):0;null!==t&&(i[t]?i[t].projectionNext=r:n[t]=r,i[t]=r),r=r.next}}}function Vo(e,t=0,n){const i=Dt(),r=Rt(),s=ts(r,20+e,16,null,n||null);null===s.projection&&(s.projection=t),jt(),64!=(64&s.flags)&&function(e,t,n){Mr(t[11],0,t,n,br(e,n,t),Cr(n.parent||t[6],n,t))}(r,i,s)}function Go(e,t,n){return Zo(e,"",t,"",n),Go}function Zo(e,t,n,i,r){const s=Dt(),o=xo(s,t,n,i);return o!==Gr&&fs(Rt(),ln(),s,e,o,s[11],r,!1),Zo}function Wo(e,t,n,i,r){const s=e[n+1],o=null===t;let a=i?qr(s):Xr(s),l=!1;for(;0!==a&&(!1===l||o);){const n=e[a+1];Yo(e[a],t)&&(l=!0,e[a+1]=i?Qr(n):$r(n)),a=i?qr(n):Xr(n)}l&&(e[n+1]=i?$r(s):Qr(s))}function Yo(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&Jn(e,t)>=0}const qo={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function $o(e){return e.substring(qo.key,qo.keyEnd)}function Xo(e){return e.substring(qo.value,qo.valueEnd)}function Ko(e,t){const n=qo.textEnd;let i=qo.key=Qo(e,t,n);return n===i?-1:(i=qo.keyEnd=function(e,t,n){let i;for(;t<n&&(45===(i=e.charCodeAt(t))||95===i||(-33&i)>=65&&(-33&i)<=90||i>=48&&i<=57);)t++;return t}(e,i,n),i=Jo(e,i,n),i=qo.value=Qo(e,i,n),i=qo.valueEnd=function(e,t,n){let i=-1,r=-1,s=-1,o=t,a=o;for(;o<n;){const l=e.charCodeAt(o++);if(59===l)return a;34===l||39===l?a=o=ea(e,l,o,n):t===o-4&&85===s&&82===r&&76===i&&40===l?a=o=ea(e,41,o,n):l>32&&(a=o),s=r,r=i,i=-33&l}return a}(e,i,n),Jo(e,i,n))}function Qo(e,t,n){for(;t<n&&e.charCodeAt(t)<=32;)t++;return t}function Jo(e,t,n,i){return(t=Qo(e,t,n))<n&&t++,t}function ea(e,t,n,i){let r=-1,s=n;for(;s<i;){const n=e.charCodeAt(s++);if(n==t&&92!==r)return s;r=92==n&&92===r?0:n}throw new Error}function ta(e,t,n){return sa(e,t,n,!1),ta}function na(e,t){return sa(e,t,null,!0),na}function ia(e){!function(e,t,n,i){const r=Rt(),s=Wt(2);r.firstUpdatePass&&aa(r,null,s,false);const o=Dt();if(n!==Gr&&yo(o,s,n)){const i=r.data[on()];if(fa(i,false)&&!oa(r,s)){let e=i.stylesWithoutHost;null!==e&&(n=re(e,n||"")),Oo(r,i,o,n,false)}else!function(e,t,n,i,r,s,o,a){r===Gr&&(r=Fe);let l=0,c=0,h=0<r.length?r[0]:null,u=0<s.length?s[0]:null;for(;null!==h||null!==u;){const o=l<r.length?r[l+1]:void 0,d=c<s.length?s[c+1]:void 0;let p,f=null;h===u?(l+=2,c+=2,o!==d&&(f=u,p=d)):null===u||null!==h&&h<u?(l+=2,f=h):(c+=2,f=u,p=d),null!==f&&ua(e,t,n,i,f,p,false,a),h=l<r.length?r[l]:null,u=c<s.length?s[c]:null}}(r,i,o,o[11],o[s+1],o[s+1]=function(e,t,n){if(null==n||""===n)return Fe;const i=[],r=Ci(n);if(Array.isArray(r))for(let s=0;s<r.length;s++)e(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&e(i,s,r[s]);else"string"==typeof r&&t(i,r);return i}(e,t,n),0,s)}}(ha,ra,e)}function ra(e,t){for(let n=function(e){return function(e){qo.key=0,qo.keyEnd=0,qo.value=0,qo.valueEnd=0,qo.textEnd=e.length}(e),Ko(e,Qo(e,0,qo.textEnd))}(t);n>=0;n=Ko(t,n))ha(e,$o(t),Xo(t))}function sa(e,t,n,i){const r=Dt(),s=Rt(),o=Wt(2);s.firstUpdatePass&&aa(s,e,o,i),t!==Gr&&yo(r,o,t)&&ua(s,s.data[on()],r,r[11],e,r[o+1]=function(e,t){return null==e||("string"==typeof t?e+=t:"object"==typeof e&&(e=ie(Ci(e)))),e}(t,n),i,o)}function oa(e,t){return t>=e.expandoStartIndex}function aa(e,t,n,i){const r=e.data;if(null===r[n+1]){const s=r[on()],o=oa(e,n);fa(s,i)&&null===t&&!o&&(t=!1),t=function(e,t,n,i){const r=function(e){const t=At.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e);let s=i?t.residualClasses:t.residualStyles;if(null===r)0===(i?t.classBindings:t.styleBindings)&&(n=ca(n=la(null,e,t,n,i),t.attrs,i),s=null);else{const o=t.directiveStylingLast;if(-1===o||e[o]!==r)if(n=la(r,e,t,n,i),null===s){let n=function(e,t,n){const i=n?t.classBindings:t.styleBindings;if(0!==Xr(i))return e[qr(i)]}(e,t,i);void 0!==n&&Array.isArray(n)&&(n=la(null,e,t,n[1],i),n=ca(n,t.attrs,i),function(e,t,n,i){e[qr(n?t.classBindings:t.styleBindings)]=i}(e,t,i,n))}else s=function(e,t,n){let i;const r=t.directiveEnd;for(let s=1+t.directiveStylingLast;s<r;s++)i=ca(i,e[s].hostAttrs,n);return ca(i,t.attrs,n)}(e,t,i)}return void 0!==s&&(i?t.residualClasses=s:t.residualStyles=s),n}(r,s,t,i),function(e,t,n,i,r,s){let o=s?t.classBindings:t.styleBindings,a=qr(o),l=Xr(o);e[i]=n;let c,h=!1;if(Array.isArray(n)){const e=n;c=e[1],(null===c||Jn(e,c)>0)&&(h=!0)}else c=n;if(r)if(0!==l){const t=qr(e[a+1]);e[i+1]=Yr(t,a),0!==t&&(e[t+1]=Kr(e[t+1],i)),e[a+1]=131071&e[a+1]|i<<17}else e[i+1]=Yr(a,0),0!==a&&(e[a+1]=Kr(e[a+1],i)),a=i;else e[i+1]=Yr(l,0),0===a?a=i:e[l+1]=Kr(e[l+1],i),l=i;h&&(e[i+1]=$r(e[i+1])),Wo(e,c,i,!0),Wo(e,c,i,!1),function(e,t,n,i,r){const s=r?e.residualClasses:e.residualStyles;null!=s&&"string"==typeof t&&Jn(s,t)>=0&&(n[i+1]=Qr(n[i+1]))}(t,c,e,i,s),o=Yr(a,l),s?t.classBindings=o:t.styleBindings=o}(r,s,t,n,o,i)}}function la(e,t,n,i,r){let s=null;const o=n.directiveEnd;let a=n.directiveStylingLast;for(-1===a?a=n.directiveStart:a++;a<o&&(s=t[a],i=ca(i,s.hostAttrs,r),s!==e);)a++;return null!==e&&(n.directiveStylingLast=a),i}function ca(e,t,n){const i=n?1:2;let r=-1;if(null!==t)for(let s=0;s<t.length;s++){const o=t[s];"number"==typeof o?r=o:r===i&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),Kn(e,o,!!n||t[++s]))}return void 0===e?null:e}function ha(e,t,n){Kn(e,t,Ci(n))}function ua(e,t,n,i,r,s,o,a){if(!(3&t.type))return;const l=e.data,c=l[a+1];pa(1==(1&c)?da(l,t,n,r,Xr(c),o):void 0)||(pa(s)||2==(2&c)&&(s=da(l,null,n,r,a,o)),function(e,t,n,i,r){const s=bt(e);if(t)r?s?e.addClass(n,i):n.classList.add(i):s?e.removeClass(n,i):n.classList.remove(i);else{let t=-1===i.indexOf("-")?void 0:sr.DashCase;if(null==r)s?e.removeStyle(n,i,t):n.style.removeProperty(i);else{const o="string"==typeof r&&r.endsWith("!important");o&&(r=r.slice(0,-10),t|=sr.Important),s?e.setStyle(n,i,r,t):n.style.setProperty(i,r,o?"important":"")}}}(i,o,_t(on(),n),r,s))}function da(e,t,n,i,r,s){const o=null===t;let a;for(;r>0;){const t=e[r],s=Array.isArray(t),l=s?t[1]:t,c=null===l;let h=n[r+1];h===Gr&&(h=c?Fe:void 0);let u=c?Qn(h,i):l===i?h:void 0;if(s&&!pa(u)&&(u=Qn(t,i)),pa(u)&&(a=u,o))return a;const d=e[r+1];r=o?qr(d):Xr(d)}if(null!==t){let e=s?t.residualClasses:t.residualStyles;null!=e&&(a=Qn(e,i))}return a}function pa(e){return void 0!==e}function fa(e,t){return 0!=(e.flags&(t?16:32))}function ga(e,t=""){const n=Dt(),i=Rt(),r=e+20,s=i.firstCreatePass?ts(i,r,1,t,null):i.data[r],o=n[r]=function(e,t){return bt(e)?e.createText(t):e.createTextNode(t)}(n[11],t);Er(i,n,o,s),Lt(s,!1)}function ma(e){return ba("",e,""),ma}function ba(e,t,n){const i=Dt(),r=xo(i,e,t,n);return r!==Gr&&Bs(i,on(),r),ba}function ya(e,t,n,i,r){const s=Dt(),o=function(e,t,n,i,r,s){const o=vo(e,Gt(),n,r);return Wt(2),o?t+he(n)+i+he(r)+s:Gr}(s,e,t,n,i,r);return o!==Gr&&Bs(s,on(),o),ya}function va(e,t,n,i,r,s,o){const a=Dt(),l=function(e,t,n,i,r,s,o,a){const l=_o(e,Gt(),n,r,o);return Wt(3),l?t+he(n)+i+he(r)+s+he(o)+a:Gr}(a,e,t,n,i,r,s,o);return l!==Gr&&Bs(a,on(),l),va}const _a=void 0;var wa=["en",[["a","p"],["AM","PM"],_a],[["AM","PM"],_a,_a],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],_a,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],_a,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",_a,"{1} 'at' {0}",_a],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(e){let t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}];let Ca={};function xa(e){const t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e);let n=Ea(t);if(n)return n;const i=t.split("-")[0];if(n=Ea(i),n)return n;if("en"===i)return wa;throw new Error(`Missing locale data for the locale "${e}".`)}function Ea(e){return e in Ca||(Ca[e]=De.ng&&De.ng.common&&De.ng.common.locales&&De.ng.common.locales[e]),Ca[e]}var ka=function(e){return e[e.LocaleId=0]="LocaleId",e[e.DayPeriodsFormat=1]="DayPeriodsFormat",e[e.DayPeriodsStandalone=2]="DayPeriodsStandalone",e[e.DaysFormat=3]="DaysFormat",e[e.DaysStandalone=4]="DaysStandalone",e[e.MonthsFormat=5]="MonthsFormat",e[e.MonthsStandalone=6]="MonthsStandalone",e[e.Eras=7]="Eras",e[e.FirstDayOfWeek=8]="FirstDayOfWeek",e[e.WeekendRange=9]="WeekendRange",e[e.DateFormat=10]="DateFormat",e[e.TimeFormat=11]="TimeFormat",e[e.DateTimeFormat=12]="DateTimeFormat",e[e.NumberSymbols=13]="NumberSymbols",e[e.NumberFormats=14]="NumberFormats",e[e.CurrencyCode=15]="CurrencyCode",e[e.CurrencySymbol=16]="CurrencySymbol",e[e.CurrencyName=17]="CurrencyName",e[e.Currencies=18]="Currencies",e[e.Directionality=19]="Directionality",e[e.PluralCase=20]="PluralCase",e[e.ExtraData=21]="ExtraData",e}({});let Sa="en-US";function Ta(e){var t,n;n="Expected localeId to be defined",null==(t=e)&&function(e,t,n,i){throw new Error(`ASSERTION ERROR: ${e} [Expected=> null != ${t} <=Actual]`)}(n,t),"string"==typeof e&&(Sa=e.toLowerCase().replace(/_/g,"-"))}function Oa(e,t,n,i,r){if(e=ae(e),Array.isArray(e))for(let s=0;s<e.length;s++)Oa(e[s],t,n,i,r);else{const s=Rt(),o=Dt();let a=to(e)?e:ae(e.provide),l=Qs(e);const c=Nt(),h=1048575&c.providerIndexes,u=c.directiveStart,d=c.providerIndexes>>20;if(to(e)||!e.multi){const i=new gn(l,r,So),p=Aa(a,t,r?h:h+d,u);-1===p?(Mn(Sn(c,o),s,a),Ia(s,e,t.length),t.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),n.push(i),o.push(i)):(n[p]=i,o[p]=i)}else{const p=Aa(a,t,h+d,u),f=Aa(a,t,h,h+d),g=p>=0&&n[p],m=f>=0&&n[f];if(r&&!m||!r&&!g){Mn(Sn(c,o),s,a);const h=function(e,t,n,i,r){const s=new gn(e,n,So);return s.multi=[],s.index=t,s.componentProviders=0,Ma(s,r,i&&!n),s}(r?Da:Pa,n.length,r,i,l);!r&&m&&(n[f].providerFactory=h),Ia(s,e,t.length,0),t.push(a),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),n.push(h),o.push(h)}else Ia(s,e,p>-1?p:f,Ma(n[r?f:p],l,!r&&i));!r&&i&&m&&n[f].componentProviders++}}}function Ia(e,t,n,i){const r=to(t);if(r||t.useClass){const s=(t.useClass||t).prototype.ngOnDestroy;if(s){const o=e.destroyHooks||(e.destroyHooks=[]);if(!r&&t.multi){const e=o.indexOf(n);-1===e?o.push(n,[i,s]):o[e+1].push(i,s)}else o.push(n,s)}}}function Ma(e,t,n){return n&&e.componentProviders++,e.multi.push(t)-1}function Aa(e,t,n,i){for(let r=n;r<i;r++)if(t[r]===e)return r;return-1}function Pa(e,t,n,i){return Ra(this.multi,[])}function Da(e,t,n,i){const r=this.multi;let s;if(this.providerFactory){const e=this.providerFactory.componentProviders,t=Ln(n,n[1],this.providerFactory.index,i);s=t.slice(0,e),Ra(r,s);for(let n=e;n<t.length;n++)s.push(t[n])}else s=[],Ra(r,s);return s}function Ra(e,t){for(let n=0;n<e.length;n++)t.push((0,e[n])());return t}function Fa(e,t=[]){return n=>{n.providersResolver=(n,i)=>function(e,t,n){const i=Rt();if(i.firstCreatePass){const r=at(e);Oa(n,i.data,i.blueprint,r,!0),Oa(t,i.data,i.blueprint,r,!1)}}(n,i?i(e):e,t)}}class Na{}class za{resolveComponentFactory(e){throw function(e){const t=Error(`No component factory found for ${ie(e)}. Did you add it to @NgModule.entryComponents?`);return t.ngComponent=e,t}(e)}}let La=(()=>{class e{}return e.NULL=new za,e})();function Ba(...e){}function ja(e,t){return new Ha(wt(e,t))}const Ua=function(){return ja(Nt(),Dt())};let Ha=(()=>{class e{constructor(e){this.nativeElement=e}}return e.__NG_ELEMENT_ID__=Ua,e})();function Va(e){return e instanceof Ha?e.nativeElement:e}class Ga{}let Za=(()=>{class e{}return e.__NG_ELEMENT_ID__=()=>Wa(),e})();const Wa=function(){const e=Dt(),t=Et(Nt().index,e);return function(e){return e[11]}(nt(t)?t:e)};let Ya=(()=>{class e{}return e.\u0275prov=pe({token:e,providedIn:"root",factory:()=>null}),e})();class qa{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const $a=new qa("11.2.9");class Xa{constructor(){}supports(e){return fo(e)}create(e){return new Qa(e)}}const Ka=(e,t)=>t;class Qa{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||Ka}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,n=this._removalsHead,i=0,r=null;for(;t||n;){const s=!n||t&&t.currentIndex<nl(n,i,r)?t:n,o=nl(s,i,r),a=s.currentIndex;if(s===n)i--,n=n._nextRemoved;else if(t=t._next,null==s.previousIndex)i++;else{r||(r=[]);const e=o-i,t=a-i;if(e!=t){for(let n=0;n<e;n++){const i=n<r.length?r[n]:r[n]=0,s=i+n;t<=s&&s<e&&(r[n]=i+1)}r[s.previousIndex]=t-e}}o!==a&&e(s,o,a)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!fo(e))throw new Error(`Error trying to diff '${ie(e)}'. Only arrays and iterables are allowed`);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t,n,i,r=this._itHead,s=!1;if(Array.isArray(e)){this.length=e.length;for(let t=0;t<this.length;t++)n=e[t],i=this._trackByFn(t,n),null!==r&&Object.is(r.trackById,i)?(s&&(r=this._verifyReinsertion(r,n,i,t)),Object.is(r.item,n)||this._addIdentityChange(r,n)):(r=this._mismatch(r,n,i,t),s=!0),r=r._next}else t=0,function(e,t){if(Array.isArray(e))for(let n=0;n<e.length;n++)t(e[n]);else{const n=e[uo()]();let i;for(;!(i=n.next()).done;)t(i.value)}}(e,e=>{i=this._trackByFn(t,e),null!==r&&Object.is(r.trackById,i)?(s&&(r=this._verifyReinsertion(r,e,i,t)),Object.is(r.item,e)||this._addIdentityChange(r,e)):(r=this._mismatch(r,e,i,t),s=!0),r=r._next,t++}),this.length=t;return this._truncate(r),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,n,i){let r;return null===e?r=this._itTail:(r=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,r,i)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,i))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,r,i)):e=this._addAfter(new Ja(t,n),r,i),e}_verifyReinsertion(e,t,n,i){let r=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==r?e=this._reinsertAfter(r,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const i=e._prevRemoved,r=e._nextRemoved;return null===i?this._removalsHead=r:i._nextRemoved=r,null===r?this._removalsTail=i:r._prevRemoved=i,this._insertAfter(e,t,n),this._addToMoves(e,n),e}_moveAfter(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}_addAfter(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,n){const i=null===t?this._itHead:t._next;return e._next=i,e._prev=t,null===i?this._itTail=e:i._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new tl),this._linkedRecords.put(e),e.currentIndex=n,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new tl),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class Ja{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class el{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}remove(e){const t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}class tl{constructor(){this.map=new Map}put(e){const t=e.trackById;let n=this.map.get(t);n||(n=new el,this.map.set(t,n)),n.add(e)}get(e,t){const n=this.map.get(e);return n?n.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function nl(e,t,n){const i=e.previousIndex;if(null===i)return i;let r=0;return n&&i<n.length&&(r=n[i]),i+t+r}class il{constructor(){}supports(e){return e instanceof Map||go(e)}create(){return new rl}}class rl{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||go(e)))throw new Error(`Error trying to diff '${ie(e)}'. Only maps and objects are allowed`)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(e,n)=>{if(t&&t.key===n)this._maybeAddToChanges(t,e),this._appendAfter=t,t=t._next;else{const i=this._getOrCreateRecordForKey(n,e);t=this._insertBeforeOrAppend(t,i)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let e=t;null!==e;e=e._nextRemoved)e===this._mapHead&&(this._mapHead=null),this._records.delete(e.key),e._nextRemoved=e._next,e.previousValue=e.currentValue,e.currentValue=null,e._prev=null,e._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const n=this._records.get(e);this._maybeAddToChanges(n,t);const i=n._prev,r=n._next;return i&&(i._next=r),r&&(r._prev=i),n._next=null,n._prev=null,n}const n=new sl(e);return this._records.set(e,n),n.currentValue=t,this._addToAdditions(n),n}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(n=>t(e[n],n))}}class sl{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function ol(){return new al([new Xa])}let al=(()=>{class e{constructor(e){this.factories=e}static create(t,n){if(null!=n){const e=n.factories.slice();t=t.concat(e)}return new e(t)}static extend(t){return{provide:e,useFactory:n=>e.create(t,n||ol()),deps:[[e,new ui,new hi]]}}find(e){const t=this.factories.find(t=>t.supports(e));if(null!=t)return t;throw new Error(`Cannot find a differ supporting object '${e}' of type '${n=e,n.name||typeof n}'`);var n}}return e.\u0275prov=pe({token:e,providedIn:"root",factory:ol}),e})();function ll(){return new cl([new il])}let cl=(()=>{class e{constructor(e){this.factories=e}static create(t,n){if(n){const e=n.factories.slice();t=t.concat(e)}return new e(t)}static extend(t){return{provide:e,useFactory:n=>e.create(t,n||ll()),deps:[[e,new ui,new hi]]}}find(e){const t=this.factories.find(t=>t.supports(e));if(t)return t;throw new Error(`Cannot find a differ supporting object '${e}'`)}}return e.\u0275prov=pe({token:e,providedIn:"root",factory:ll}),e})();function hl(e,t,n,i,r=!1){for(;null!==n;){const s=t[n.index];if(null!==s&&i.push(vt(s)),it(s))for(let e=10;e<s.length;e++){const t=s[e],n=t[1].firstChild;null!==n&&hl(t[1],t,n,i)}const o=n.type;if(8&o)hl(e,t,n.child,i);else if(32&o){const e=or(n,t);let r;for(;r=e();)i.push(r)}else if(16&o){const e=Sr(t,n);if(Array.isArray(e))i.push(...e);else{const n=ar(t[16]);hl(n[1],n,e,i,!0)}}n=r?n.projectionNext:n.next}return i}class ul{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return hl(t,e,t.firstChild,[])}get context(){return this._lView[8]}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(it(e)){const t=e[8],n=t?t.indexOf(this):-1;n>-1&&(fr(e,n),$n(t,n))}this._attachedToViewContainer=!1}gr(this._lView[1],this._lView)}onDestroy(e){ds(this._lView[1],this._lView,null,e)}markForCheck(){Ms(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){As(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(e,t,n){Ht(!0);try{As(e,t,n)}finally{Ht(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){var e;this._appRef=null,Ir(this._lView[1],e=this._lView,e[11],2,null,null)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}class dl extends ul{constructor(e){super(e),this._view=e}detectChanges(){Ps(this._view)}checkNoChanges(){!function(e){Ht(!0);try{Ps(e)}finally{Ht(!1)}}(this._view)}get context(){return null}}const pl=function(e=!1){return function(e,t,n){if(!n&&st(e)){const n=Et(e.index,t);return new ul(n,n)}return 47&e.type?new ul(t[16],t):null}(Nt(),Dt(),e)};let fl=(()=>{class e{}return e.__NG_ELEMENT_ID__=pl,e.__ChangeDetectorRef__=!0,e})();const gl=[new il],ml=new al([new Xa]),bl=new cl(gl),yl=function(){return Cl(Nt(),Dt())};let vl=(()=>{class e{}return e.__NG_ELEMENT_ID__=yl,e})();const _l=vl,wl=class extends _l{constructor(e,t,n){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=n}createEmbeddedView(e){const t=this._declarationTContainer.tViews,n=es(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];const i=this._declarationLView[19];return null!==i&&(n[19]=i.createEmbeddedView(t)),is(t,n,e),new ul(n)}};function Cl(e,t){return 4&e.type?new wl(t,e,ja(e,t)):null}class xl{}const El=function(){return Ml(Nt(),Dt())};let kl=(()=>{class e{}return e.__NG_ELEMENT_ID__=El,e})();const Sl=kl,Tl=class extends Sl{constructor(e,t,n){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=n}get element(){return ja(this._hostTNode,this._hostLView)}get injector(){return new Un(this._hostTNode,this._hostLView)}get parentInjector(){const e=In(this._hostTNode,this._hostLView);if(_n(e)){const t=Cn(e,this._hostLView),n=wn(e);return new Un(t[1].data[n+8],t)}return new Un(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=Ol(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,n){const i=e.createEmbeddedView(t||{});return this.insert(i,n),i}createComponent(e,t,n,i,r){const s=n||this.parentInjector;if(!r&&null==e.ngModule&&s){const e=s.get(xl,null);e&&(r=e)}const o=e.create(s,i,void 0,r);return this.insert(o.hostView,t),o}insert(e,t){const n=e._lView,i=n[1];if(it(n[3])){const t=this.indexOf(e);if(-1!==t)this.detach(t);else{const t=n[3],i=new Tl(t,t[6],t[3]);i.detach(i.indexOf(e))}}const r=this._adjustIndex(t),s=this._lContainer;!function(e,t,n,i){const r=10+i,s=n.length;i>0&&(n[r-1][4]=t),i<s-10?(t[4]=n[r],qn(n,10+i,t)):(n.push(t),t[4]=null),t[3]=n;const o=t[17];null!==o&&n!==o&&function(e,t){const n=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===n?e[9]=[t]:n.push(t)}(o,t);const a=t[19];null!==a&&a.insertView(e),t[2]|=128}(i,n,s,r);const o=Tr(r,s),a=n[11],l=wr(a,s[7]);return null!==l&&function(e,t,n,i,r,s){i[0]=r,i[6]=t,Ir(e,i,n,1,r,s)}(i,s[6],a,n,l,o),e.attachToViewContainerRef(),qn(Il(s),r,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=Ol(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),n=fr(this._lContainer,t);n&&($n(Il(this._lContainer),t),gr(n[1],n))}detach(e){const t=this._adjustIndex(e,-1),n=fr(this._lContainer,t);return n&&null!=$n(Il(this._lContainer),t)?new ul(n):null}_adjustIndex(e,t=0){return null==e?this.length+t:e}};function Ol(e){return e[8]}function Il(e){return e[8]||(e[8]=[])}function Ml(e,t){let n;const i=t[e.index];if(it(i))n=i;else{let r;if(8&e.type)r=vt(i);else{const n=t[11];r=n.createComment("");const i=wt(e,t);yr(n,wr(n,i),r,function(e,t){return bt(e)?e.nextSibling(t):t.nextSibling}(n,i),!1)}t[e.index]=n=ks(i,t,r,e),Is(t,n)}return new Tl(n,e,t)}const Al={};class Pl extends La{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=et(e);return new Fl(t,this.ngModule)}}function Dl(e){const t=[];for(let n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}const Rl=new Zn("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>ir});class Fl extends Na{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=e.selectors.map(Vr).join(","),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return Dl(this.componentDef.inputs)}get outputs(){return Dl(this.componentDef.outputs)}create(e,t,n,i){const r=(i=i||this.ngModule)?function(e,t){return{get:(n,i,r)=>{const s=e.get(n,Al,r);return s!==Al||i===Al?s:t.get(n,i,r)}}}(e,i.injector):e,s=r.get(Ga,yt),o=r.get(Ya,null),a=s.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",c=n?function(e,t,n){if(bt(e))return e.selectRootElement(t,n===Oe.ShadowDom);let i="string"==typeof t?e.querySelector(t):t;return i.textContent="",i}(a,n,this.componentDef.encapsulation):dr(s.createRenderer(null,this.componentDef),l,function(e){const t=e.toLowerCase();return"svg"===t?"http://www.w3.org/2000/svg":"math"===t?"http://www.w3.org/1998/MathML/":null}(l)),h=this.componentDef.onPush?576:528,u={components:[],scheduler:ir,clean:Rs,playerHandler:null,flags:0},d=us(0,null,null,1,0,null,null,null,null,null),p=es(null,d,u,h,null,null,s,a,o,r);let f,g;Jt(p);try{const e=function(e,t,n,i,r,s){const o=n[1];n[20]=e;const a=ts(o,20,2,"#host",null),l=a.mergedAttrs=t.hostAttrs;null!==l&&(js(a,l,!0),null!==e&&(mn(r,e,l),null!==a.classes&&Pr(r,e,a.classes),null!==a.styles&&Ar(r,e,a.styles)));const c=i.createRenderer(e,t),h=es(n,hs(t),null,t.onPush?64:16,n[20],a,i,c,null,null);return o.firstCreatePass&&(Mn(Sn(a,n),o,t.type),ys(o,a),_s(a,n.length,1)),Is(n,h),n[20]=h}(c,this.componentDef,p,s,a);if(c)if(n)mn(a,c,["ng-version",$a.full]);else{const{attrs:e,classes:t}=function(e){const t=[],n=[];let i=1,r=2;for(;i<e.length;){let s=e[i];if("string"==typeof s)2===r?""!==s&&t.push(s,e[++i]):8===r&&n.push(s);else{if(!Lr(r))break;r=s}i++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]);e&&mn(a,c,e),t&&t.length>0&&Pr(a,c,t.join(" "))}if(g=Ct(d,20),void 0!==t){const e=g.projection=[];for(let n=0;n<this.ngContentSelectors.length;n++){const i=t[n];e.push(null!=i?Array.from(i):null)}}f=function(e,t,n,i,r){const s=n[1],o=function(e,t,n){const i=Nt();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),ws(e,i,t,ns(e,t,1,null),n));const r=Ln(t,e,i.directiveStart,i);nr(r,t);const s=wt(i,t);return s&&nr(s,t),r}(s,n,t);if(i.components.push(o),e[8]=o,r&&r.forEach(e=>e(o,t)),t.contentQueries){const e=Nt();t.contentQueries(1,o,e.directiveStart)}const a=Nt();return!s.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(an(a.index),ms(n[1],a,0,a.directiveStart,a.directiveEnd,t),bs(t,o)),o}(e,this.componentDef,p,u,[ro]),is(d,p,null)}finally{sn()}return new Nl(this.componentType,f,ja(g,p),p,g)}}class Nl extends class{}{constructor(e,t,n,i,r){super(),this.location=n,this._rootLView=i,this._tNode=r,this.instance=t,this.hostView=this.changeDetectorRef=new dl(i),this.componentType=e}get injector(){return new Un(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}const zl=new Map;class Ll extends xl{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new Pl(this);const n=tt(e),i=e[Ue]||null;i&&Ta(i),this._bootstrapComponents=rr(n.bootstrap),this._r3Injector=$s(e,t,[{provide:xl,useValue:this},{provide:La,useValue:this.componentFactoryResolver}],ie(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,t=io.THROW_IF_NOT_FOUND,n=Ce.Default){return e===io||e===xl||e===Us?this:this._r3Injector.get(e,t,n)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class Bl extends class{}{constructor(e){super(),this.moduleType=e,null!==tt(e)&&function(e){const t=new Set;!function e(n){const i=tt(n,!0),r=i.id;null!==r&&(function(e,t,n){if(t&&t!==n)throw new Error(`Duplicate module registered for ${e} - ${ie(t)} vs ${ie(t.name)}`)}(r,zl.get(r),n),zl.set(r,n));const s=rr(i.imports);for(const o of s)t.has(o)||(t.add(o),e(o))}(e)}(e)}create(e){return new Ll(this.moduleType,e)}}function jl(e,t,n){const i=Vt()+e,r=Dt();return r[i]===Gr?mo(r,i,n?t.call(n):t()):bo(r,i)}function Ul(e,t,n,i){return function(e,t,n,i,r,s){const o=t+n;return yo(e,o,r)?mo(e,o+1,s?i.call(s,r):i(r)):Wl(e,o+1)}(Dt(),Vt(),e,t,n,i)}function Hl(e,t,n,i,r){return Yl(Dt(),Vt(),e,t,n,i,r)}function Vl(e,t,n,i,r,s){return function(e,t,n,i,r,s,o,a){const l=t+n;return _o(e,l,r,s,o)?mo(e,l+3,a?i.call(a,r,s,o):i(r,s,o)):Wl(e,l+3)}(Dt(),Vt(),e,t,n,i,r,s)}function Gl(e,t,n,i,r,s,o){return function(e,t,n,i,r,s,o,a,l){const c=t+n;return wo(e,c,r,s,o,a)?mo(e,c+4,l?i.call(l,r,s,o,a):i(r,s,o,a)):Wl(e,c+4)}(Dt(),Vt(),e,t,n,i,r,s,o)}function Zl(e,t,n,i,r,s,o,a,l,c,h){const u=Vt()+e,d=Dt(),p=wo(d,u,n,i,r,s);return wo(d,u+4,o,a,l,c)||p?mo(d,u+8,h?t.call(h,n,i,r,s,o,a,l,c):t(n,i,r,s,o,a,l,c)):bo(d,u+8)}function Wl(e,t){const n=e[t];return n===Gr?void 0:n}function Yl(e,t,n,i,r,s,o){const a=t+n;return vo(e,a,r,s)?mo(e,a+2,o?i.call(o,r,s):i(r,s)):Wl(e,a+2)}function ql(e,t){const n=Rt();let i;const r=e+20;n.firstCreatePass?(i=function(e,t){if(t)for(let n=t.length-1;n>=0;n--){const i=t[n];if(e===i.name)return i}throw new ce("302",`The pipe '${e}' could not be found!`)}(t,n.pipeRegistry),n.data[r]=i,i.onDestroy&&(n.destroyHooks||(n.destroyHooks=[])).push(r,i.onDestroy)):i=n.data[r];const s=i.factory||(i.factory=lt(i.type)),o=Ee(So);try{const e=En(!1),t=s();return En(e),function(e,t,n,i){n>=e.data.length&&(e.data[n]=null,e.blueprint[n]=null),t[n]=i}(n,Dt(),r,t),t}finally{Ee(o)}}function $l(e,t,n,i){const r=e+20,s=Dt(),o=xt(s,r);return function(e,t){return po.isWrapped(t)&&(t=po.unwrap(t),e[Gt()]=Gr),t}(s,function(e,t){return e[1].data[t].pure}(s,r)?Yl(s,Vt(),t,o.transform,n,i,o):o.transform(n,i))}const Xl=class extends x{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,n){let i,r=e=>null,s=()=>null;e&&"object"==typeof e?(i=this.__isAsync?t=>{setTimeout(()=>e.next(t))}:t=>{e.next(t)},e.error&&(r=this.__isAsync?t=>{setTimeout(()=>e.error(t))}:t=>{e.error(t)}),e.complete&&(s=this.__isAsync?()=>{setTimeout(()=>e.complete())}:()=>{e.complete()})):(i=this.__isAsync?t=>{setTimeout(()=>e(t))}:t=>{e(t)},t&&(r=this.__isAsync?e=>{setTimeout(()=>t(e))}:e=>{t(e)}),n&&(s=this.__isAsync?()=>{setTimeout(()=>n())}:()=>{n()}));const o=super.subscribe(i,r,s);return e instanceof u&&e.add(o),o}};function Kl(){return this._results[uo()]()}class Ql{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=uo(),n=Ql.prototype;n[t]||(n[t]=Kl)}get changes(){return this._changes||(this._changes=new Xl)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){this.dirty=!1;const n=Wn(e);(this._changesDetected=!function(e,t,n){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++){let r=e[i],s=t[i];if(n&&(r=n(r),s=n(s)),s!==r)return!1}return!0}(this._results,n,t))&&(this._results=n,this.length=n.length,this.last=n[this.length-1],this.first=n[0])}notifyOnChanges(){!this._changes||!this._changesDetected&&this._emitDistinctChangesOnly||this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}class Jl{constructor(e){this.queryList=e,this.matches=null}clone(){return new Jl(this.queryList)}setDirty(){this.queryList.setDirty()}}class ec{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const n=null!==e.contentQueries?e.contentQueries[0]:t.length,i=[];for(let e=0;e<n;e++){const n=t.getByIndex(e);i.push(this.queries[n.indexInDeclarationView].clone())}return new ec(i)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==uc(e,t).matches&&this.queries[t].setDirty()}}class tc{constructor(e,t,n=null){this.predicate=e,this.flags=t,this.read=n}}class nc{constructor(e=[]){this.queries=e}elementStart(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let n=0;n<this.length;n++){const i=null!==t?t.length:0,r=this.getByIndex(n).embeddedTView(e,i);r&&(r.indexInDeclarationView=n,null!==t?t.push(r):t=[r])}return null!==t?new nc(t):null}template(e,t){for(let n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class ic{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new ic(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let n=e.parent;for(;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const n=this.metadata.predicate;if(Array.isArray(n))for(let i=0;i<n.length;i++){const r=n[i];this.matchTNodeWithReadOption(e,t,rc(t,r)),this.matchTNodeWithReadOption(e,t,zn(t,e,r,!1,!1))}else n===vl?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,zn(t,e,n,!1,!1))}matchTNodeWithReadOption(e,t,n){if(null!==n){const i=this.metadata.read;if(null!==i)if(i===Ha||i===kl||i===vl&&4&t.type)this.addMatch(t.index,-2);else{const n=zn(t,e,i,!1,!1);null!==n&&this.addMatch(t.index,n)}else this.addMatch(t.index,n)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function rc(e,t){const n=e.localNames;if(null!==n)for(let i=0;i<n.length;i+=2)if(n[i]===t)return n[i+1];return null}function sc(e,t,n,i){return-1===n?function(e,t){return 11&e.type?ja(e,t):4&e.type?Cl(e,t):null}(t,e):-2===n?function(e,t,n){return n===Ha?ja(t,e):n===vl?Cl(t,e):n===kl?Ml(t,e):void 0}(e,t,i):Ln(e,e[1],n,t)}function oc(e,t,n,i){const r=t[19].queries[i];if(null===r.matches){const i=e.data,s=n.matches,o=[];for(let e=0;e<s.length;e+=2){const r=s[e];o.push(r<0?null:sc(t,i[r],s[e+1],n.metadata.read))}r.matches=o}return r.matches}function ac(e,t,n,i){const r=e.queries.getByIndex(n),s=r.matches;if(null!==s){const o=oc(e,t,r,n);for(let e=0;e<s.length;e+=2){const n=s[e];if(n>0)i.push(o[e/2]);else{const r=s[e+1],o=t[-n];for(let e=10;e<o.length;e++){const t=o[e];t[17]===t[3]&&ac(t[1],t,r,i)}if(null!==o[9]){const e=o[9];for(let t=0;t<e.length;t++){const n=e[t];ac(n[1],n,r,i)}}}}}return i}function lc(e){const t=Dt(),n=Rt(),i=$t();Xt(i+1);const r=uc(n,i);if(e.dirty&&St(t)===(2==(2&r.metadata.flags))){if(null===r.matches)e.reset([]);else{const s=r.crossesNgTemplate?ac(n,t,i,[]):oc(n,t,r,i);e.reset(s,Va),e.notifyOnChanges()}return!0}return!1}function cc(e,t,n){const i=Rt();i.firstCreatePass&&(function(e,t,n){null===e.queries&&(e.queries=new nc),e.queries.track(new ic(t,-1))}(i,new tc(e,t,n)),2==(2&t)&&(i.staticViewQueries=!0)),function(e,t,n){const i=new Ql(4==(4&n));ds(e,t,i,i.destroy),null===t[19]&&(t[19]=new ec),t[19].queries.push(new Jl(i))}(i,Dt(),t)}function hc(){return e=Dt(),t=$t(),e[19].queries[t].queryList;var e,t}function uc(e,t){return e.queries.getByIndex(t)}function dc(e,t){return Cl(e,t)}const pc=new Zn("Application Initializer");let fc=(()=>{class e{constructor(e){this.appInits=e,this.resolve=Ba,this.reject=Ba,this.initialized=!1,this.done=!1,this.donePromise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}runInitializers(){if(this.initialized)return;const e=[],t=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let n=0;n<this.appInits.length;n++){const t=this.appInits[n]();No(t)&&e.push(t)}Promise.all(e).then(()=>{t()}).catch(e=>{this.reject(e)}),0===e.length&&t(),this.initialized=!0}}return e.\u0275fac=function(t){return new(t||e)(oi(pc,8))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();const gc=new Zn("AppId"),mc={provide:gc,useFactory:function(){return`${bc()}${bc()}${bc()}`},deps:[]};function bc(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const yc=new Zn("Platform Initializer"),vc=new Zn("Platform ID"),_c=new Zn("appBootstrapListener");let wc=(()=>{class e{log(e){console.log(e)}warn(e){console.warn(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();const Cc=new Zn("LocaleId"),xc=new Zn("DefaultCurrencyCode");class Ec{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}const kc=function(e){return new Bl(e)},Sc=kc,Tc=function(e){return Promise.resolve(kc(e))},Oc=function(e){const t=kc(e),n=rr(tt(e).declarations).reduce((e,t)=>{const n=et(t);return n&&e.push(new Fl(n)),e},[]);return new Ec(t,n)},Ic=Oc,Mc=function(e){return Promise.resolve(Oc(e))};let Ac=(()=>{class e{constructor(){this.compileModuleSync=Sc,this.compileModuleAsync=Tc,this.compileModuleAndAllComponentsSync=Ic,this.compileModuleAndAllComponentsAsync=Mc}clearCache(){}clearCacheFor(e){}getModuleId(e){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();const Pc=(()=>Promise.resolve(0))();function Dc(e){"undefined"==typeof Zone?Pc.then(()=>{e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}class Rc{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:n=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Xl(!1),this.onMicrotaskEmpty=new Xl(!1),this.onStable=new Xl(!1),this.onError=new Xl(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),this.shouldCoalesceEventChangeDetection=!n&&t,this.shouldCoalesceRunChangeDetection=n,this.lastRequestAnimationFrameId=-1,this.nativeRequestAnimationFrame=function(){let e=De.requestAnimationFrame,t=De.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){const n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function(e){const t=()=>{!function(e){-1===e.lastRequestAnimationFrameId&&(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(De,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,zc(e),Nc(e)},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),zc(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,i,r,s,o,a)=>{try{return Lc(e),n.invokeTask(r,s,o,a)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||e.shouldCoalesceRunChangeDetection)&&t(),Bc(e)}},onInvoke:(n,i,r,s,o,a,l)=>{try{return Lc(e),n.invoke(r,s,o,a,l)}finally{e.shouldCoalesceRunChangeDetection&&t(),Bc(e)}},onHasTask:(t,n,i,r)=>{t.hasTask(i,r),n===i&&("microTask"==r.change?(e._hasPendingMicrotasks=r.microTask,zc(e),Nc(e)):"macroTask"==r.change&&(e.hasPendingMacrotasks=r.macroTask))},onHandleError:(t,n,i,r)=>(t.handleError(i,r),e.runOutsideAngular(()=>e.onError.emit(r)),!1)})}(this)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Rc.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Rc.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,t,n){return this._inner.run(e,t,n)}runTask(e,t,n,i){const r=this._inner,s=r.scheduleEventTask("NgZoneEvent: "+i,e,Fc,Ba,Ba);try{return r.runTask(s,t,n)}finally{r.cancelTask(s)}}runGuarded(e,t,n){return this._inner.runGuarded(e,t,n)}runOutsideAngular(e){return this._outer.run(e)}}const Fc={};function Nc(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function zc(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function Lc(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function Bc(e){e._nesting--,Nc(e)}class jc{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Xl,this.onMicrotaskEmpty=new Xl,this.onStable=new Xl,this.onError=new Xl}run(e,t,n){return e.apply(t,n)}runGuarded(e,t,n){return e.apply(t,n)}runOutsideAngular(e){return e()}runTask(e,t,n,i){return e.apply(t,n)}}let Uc=(()=>{class e{constructor(e){this._ngZone=e,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Rc.assertNotInAngularZone(),Dc(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Dc(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(t=>!t.updateCb||!t.updateCb(e)||(clearTimeout(t.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,t,n){let i=-1;t&&t>0&&(i=setTimeout(()=>{this._callbacks=this._callbacks.filter(e=>e.timeoutId!==i),e(this._didWork,this.getPendingTasks())},t)),this._callbacks.push({doneCb:e,timeoutId:i,updateCb:n})}whenStable(e,t,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(e,t,n),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(e,t,n){return[]}}return e.\u0275fac=function(t){return new(t||e)(oi(Rc))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})(),Hc=(()=>{class e{constructor(){this._applications=new Map,Zc.addToWindow(this)}registerApplication(e,t){this._applications.set(e,t)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,t=!0){return Zc.findTestabilityInTree(this,e,t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();class Vc{addToWindow(e){}findTestabilityInTree(e,t,n){return null}}let Gc,Zc=new Vc,Wc=!0,Yc=!1;const qc=new Zn("AllowMultipleToken");function $c(e,t,n=[]){const i=`Platform: ${t}`,r=new Zn(i);return(t=[])=>{let s=Xc();if(!s||s.injector.get(qc,!1))if(e)e(n.concat(t).concat({provide:r,useValue:!0}));else{const e=n.concat(t).concat({provide:r,useValue:!0},{provide:Vs,useValue:"platform"});!function(e){if(Gc&&!Gc.destroyed&&!Gc.injector.get(qc,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Gc=e.get(Kc);const t=e.get(yc,null);t&&t.forEach(e=>e())}(io.create({providers:e,name:i}))}return function(e){const t=Xc();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(r)}}function Xc(){return Gc&&!Gc.destroyed?Gc:null}let Kc=(()=>{class e{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,t){const n=function(e,t){let n;return n="noop"===e?new jc:("zone.js"===e?void 0:e)||new Rc({enableLongStackTrace:(Yc=!0,Wc),shouldCoalesceEventChangeDetection:!!(null==t?void 0:t.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==t?void 0:t.ngZoneRunCoalescing)}),n}(t?t.ngZone:void 0,{ngZoneEventCoalescing:t&&t.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:t&&t.ngZoneRunCoalescing||!1}),i=[{provide:Rc,useValue:n}];return n.run(()=>{const t=io.create({providers:i,parent:this.injector,name:e.moduleType.name}),r=e.create(t),s=r.injector.get(tr,null);if(!s)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return n.runOutsideAngular(()=>{const e=n.onError.subscribe({next:e=>{s.handleError(e)}});r.onDestroy(()=>{eh(this._modules,r),e.unsubscribe()})}),function(e,t,n){try{const i=n();return No(i)?i.catch(n=>{throw t.runOutsideAngular(()=>e.handleError(n)),n}):i}catch(i){throw t.runOutsideAngular(()=>e.handleError(i)),i}}(s,n,()=>{const e=r.injector.get(fc);return e.runInitializers(),e.donePromise.then(()=>(Ta(r.injector.get(Cc,"en-US")||"en-US"),this._moduleDoBootstrap(r),r))})})}bootstrapModule(e,t=[]){const n=Qc({},t);return function(e,t,n){const i=new Bl(n);return Promise.resolve(i)}(0,0,e).then(e=>this.bootstrapModuleFactory(e,n))}_moduleDoBootstrap(e){const t=e.injector.get(Jc);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(e=>t.bootstrap(e));else{if(!e.instance.ngDoBootstrap)throw new Error(`The module ${ie(e.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);e.instance.ngDoBootstrap(t)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(e=>e.destroy()),this._destroyListeners.forEach(e=>e()),this._destroyed=!0}get destroyed(){return this._destroyed}}return e.\u0275fac=function(t){return new(t||e)(oi(io))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();function Qc(e,t){return Array.isArray(t)?t.reduce(Qc,e):Object.assign(Object.assign({},e),t)}let Jc=(()=>{class e{constructor(e,t,n,i,r){this._zone=e,this._injector=t,this._exceptionHandler=n,this._componentFactoryResolver=i,this._initStatus=r,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const s=new y(e=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{e.next(this._stable),e.complete()})}),o=new y(e=>{let t;this._zone.runOutsideAngular(()=>{t=this._zone.onStable.subscribe(()=>{Rc.assertNotInAngularZone(),Dc(()=>{this._stable||this._zone.hasPendingMacrotasks||this._zone.hasPendingMicrotasks||(this._stable=!0,e.next(!0))})})});const n=this._zone.onUnstable.subscribe(()=>{Rc.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{e.next(!1)}))});return()=>{t.unsubscribe(),n.unsubscribe()}});this.isStable=Z(s,o.pipe(e=>W()(Q(ee)(e))))}bootstrap(e,t){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let n;n=e instanceof Na?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(n.componentType);const i=n.isBoundToModule?void 0:this._injector.get(xl),r=n.create(io.NULL,[],t||n.selector,i),s=r.location.nativeElement,o=r.injector.get(Uc,null),a=o&&r.injector.get(Hc);return o&&a&&a.registerApplication(s,o),r.onDestroy(()=>{this.detachView(r.hostView),eh(this.components,r),a&&a.unregisterApplication(s)}),this._loadComponent(r),r}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const t=e;this._views.push(t),t.attachToAppRef(this)}detachView(e){const t=e;eh(this._views,t),t.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(_c,[]).concat(this._bootstrapListeners).forEach(t=>t(e))}ngOnDestroy(){this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return e.\u0275fac=function(t){return new(t||e)(oi(Rc),oi(io),oi(tr),oi(La),oi(fc))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();function eh(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}const th=$c(null,"core",[{provide:vc,useValue:"unknown"},{provide:Kc,deps:[io]},{provide:Hc,deps:[]},{provide:wc,deps:[]}]),nh=[{provide:Jc,useClass:Jc,deps:[Rc,io,tr,La,fc]},{provide:Rl,deps:[Rc],useFactory:function(e){let t=[];return e.onStable.subscribe(()=>{for(;t.length;)t.pop()()}),function(e){t.push(e)}}},{provide:fc,useClass:fc,deps:[[new hi,pc]]},{provide:Ac,useClass:Ac,deps:[]},mc,{provide:al,useFactory:function(){return ml},deps:[]},{provide:cl,useFactory:function(){return bl},deps:[]},{provide:Cc,useFactory:function(e){return Ta(e=e||"undefined"!=typeof $localize&&$localize.locale||"en-US"),e},deps:[[new ci(Cc),new hi,new ui]]},{provide:xc,useValue:"USD"}];let ih=(()=>{class e{constructor(e){}}return e.\u0275fac=function(t){return new(t||e)(oi(Jc))},e.\u0275mod=Xe({type:e}),e.\u0275inj=fe({providers:nh}),e})(),rh=null;function sh(){return rh}const oh=new Zn("DocumentToken");var ah=function(e){return e[e.Zero=0]="Zero",e[e.One=1]="One",e[e.Two=2]="Two",e[e.Few=3]="Few",e[e.Many=4]="Many",e[e.Other=5]="Other",e}({}),lh=function(e){return e[e.Format=0]="Format",e[e.Standalone=1]="Standalone",e}({}),ch=function(e){return e[e.Narrow=0]="Narrow",e[e.Abbreviated=1]="Abbreviated",e[e.Wide=2]="Wide",e[e.Short=3]="Short",e}({}),hh=function(e){return e[e.Short=0]="Short",e[e.Medium=1]="Medium",e[e.Long=2]="Long",e[e.Full=3]="Full",e}({}),uh=function(e){return e[e.Decimal=0]="Decimal",e[e.Group=1]="Group",e[e.List=2]="List",e[e.PercentSign=3]="PercentSign",e[e.PlusSign=4]="PlusSign",e[e.MinusSign=5]="MinusSign",e[e.Exponential=6]="Exponential",e[e.SuperscriptingExponent=7]="SuperscriptingExponent",e[e.PerMille=8]="PerMille",e[e[1/0]=9]="Infinity",e[e.NaN=10]="NaN",e[e.TimeSeparator=11]="TimeSeparator",e[e.CurrencyDecimal=12]="CurrencyDecimal",e[e.CurrencyGroup=13]="CurrencyGroup",e}({});function dh(e,t){return bh(xa(e)[ka.DateFormat],t)}function ph(e,t){return bh(xa(e)[ka.TimeFormat],t)}function fh(e,t){return bh(xa(e)[ka.DateTimeFormat],t)}function gh(e,t){const n=xa(e),i=n[ka.NumberSymbols][t];if(void 0===i){if(t===uh.CurrencyDecimal)return n[ka.NumberSymbols][uh.Decimal];if(t===uh.CurrencyGroup)return n[ka.NumberSymbols][uh.Group]}return i}function mh(e){if(!e[ka.ExtraData])throw new Error(`Missing extra locale data for the locale "${e[ka.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function bh(e,t){for(let n=t;n>-1;n--)if(void 0!==e[n])return e[n];throw new Error("Locale data API: locale data undefined")}function yh(e){const[t,n]=e.split(":");return{hours:+t,minutes:+n}}const vh=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,_h={},wh=/((?:[^GyYMLwWdEabBhHmsSzZO']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Ch=function(e){return e[e.Short=0]="Short",e[e.ShortGMT=1]="ShortGMT",e[e.Long=2]="Long",e[e.Extended=3]="Extended",e}({}),xh=function(e){return e[e.FullYear=0]="FullYear",e[e.Month=1]="Month",e[e.Date=2]="Date",e[e.Hours=3]="Hours",e[e.Minutes=4]="Minutes",e[e.Seconds=5]="Seconds",e[e.FractionalSeconds=6]="FractionalSeconds",e[e.Day=7]="Day",e}({}),Eh=function(e){return e[e.DayPeriods=0]="DayPeriods",e[e.Days=1]="Days",e[e.Months=2]="Months",e[e.Eras=3]="Eras",e}({});function kh(e,t,n,i){let r=function(e){if(Lh(e))return e;if("number"==typeof e&&!isNaN(e))return new Date(e);if("string"==typeof e){if(e=e.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(e)){const[t,n=1,i=1]=e.split("-").map(e=>+e);return Sh(t,n-1,i)}const t=parseFloat(e);if(!isNaN(e-t))return new Date(t);let n;if(n=e.match(vh))return function(e){const t=new Date(0);let n=0,i=0;const r=e[8]?t.setUTCFullYear:t.setFullYear,s=e[8]?t.setUTCHours:t.setHours;e[9]&&(n=Number(e[9]+e[10]),i=Number(e[9]+e[11])),r.call(t,Number(e[1]),Number(e[2])-1,Number(e[3]));const o=Number(e[4]||0)-n,a=Number(e[5]||0)-i,l=Number(e[6]||0),c=Math.floor(1e3*parseFloat("0."+(e[7]||0)));return s.call(t,o,a,l,c),t}(n)}const t=new Date(e);if(!Lh(t))throw new Error(`Unable to convert "${e}" into a date`);return t}(e);t=Th(n,t)||t;let s,o=[];for(;t;){if(s=wh.exec(t),!s){o.push(t);break}{o=o.concat(s.slice(1));const e=o.pop();if(!e)break;t=e}}let a=r.getTimezoneOffset();i&&(a=zh(i,a),r=function(e,t,n){const i=e.getTimezoneOffset();return function(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}(e,-1*(zh(t,i)-i))}(r,i));let l="";return o.forEach(e=>{const t=function(e){if(Nh[e])return Nh[e];let t;switch(e){case"G":case"GG":case"GGG":t=Ah(Eh.Eras,ch.Abbreviated);break;case"GGGG":t=Ah(Eh.Eras,ch.Wide);break;case"GGGGG":t=Ah(Eh.Eras,ch.Narrow);break;case"y":t=Mh(xh.FullYear,1,0,!1,!0);break;case"yy":t=Mh(xh.FullYear,2,0,!0,!0);break;case"yyy":t=Mh(xh.FullYear,3,0,!1,!0);break;case"yyyy":t=Mh(xh.FullYear,4,0,!1,!0);break;case"Y":t=Fh(1);break;case"YY":t=Fh(2,!0);break;case"YYY":t=Fh(3);break;case"YYYY":t=Fh(4);break;case"M":case"L":t=Mh(xh.Month,1,1);break;case"MM":case"LL":t=Mh(xh.Month,2,1);break;case"MMM":t=Ah(Eh.Months,ch.Abbreviated);break;case"MMMM":t=Ah(Eh.Months,ch.Wide);break;case"MMMMM":t=Ah(Eh.Months,ch.Narrow);break;case"LLL":t=Ah(Eh.Months,ch.Abbreviated,lh.Standalone);break;case"LLLL":t=Ah(Eh.Months,ch.Wide,lh.Standalone);break;case"LLLLL":t=Ah(Eh.Months,ch.Narrow,lh.Standalone);break;case"w":t=Rh(1);break;case"ww":t=Rh(2);break;case"W":t=Rh(1,!0);break;case"d":t=Mh(xh.Date,1);break;case"dd":t=Mh(xh.Date,2);break;case"E":case"EE":case"EEE":t=Ah(Eh.Days,ch.Abbreviated);break;case"EEEE":t=Ah(Eh.Days,ch.Wide);break;case"EEEEE":t=Ah(Eh.Days,ch.Narrow);break;case"EEEEEE":t=Ah(Eh.Days,ch.Short);break;case"a":case"aa":case"aaa":t=Ah(Eh.DayPeriods,ch.Abbreviated);break;case"aaaa":t=Ah(Eh.DayPeriods,ch.Wide);break;case"aaaaa":t=Ah(Eh.DayPeriods,ch.Narrow);break;case"b":case"bb":case"bbb":t=Ah(Eh.DayPeriods,ch.Abbreviated,lh.Standalone,!0);break;case"bbbb":t=Ah(Eh.DayPeriods,ch.Wide,lh.Standalone,!0);break;case"bbbbb":t=Ah(Eh.DayPeriods,ch.Narrow,lh.Standalone,!0);break;case"B":case"BB":case"BBB":t=Ah(Eh.DayPeriods,ch.Abbreviated,lh.Format,!0);break;case"BBBB":t=Ah(Eh.DayPeriods,ch.Wide,lh.Format,!0);break;case"BBBBB":t=Ah(Eh.DayPeriods,ch.Narrow,lh.Format,!0);break;case"h":t=Mh(xh.Hours,1,-12);break;case"hh":t=Mh(xh.Hours,2,-12);break;case"H":t=Mh(xh.Hours,1);break;case"HH":t=Mh(xh.Hours,2);break;case"m":t=Mh(xh.Minutes,1);break;case"mm":t=Mh(xh.Minutes,2);break;case"s":t=Mh(xh.Seconds,1);break;case"ss":t=Mh(xh.Seconds,2);break;case"S":t=Mh(xh.FractionalSeconds,1);break;case"SS":t=Mh(xh.FractionalSeconds,2);break;case"SSS":t=Mh(xh.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=Ph(Ch.Short);break;case"ZZZZZ":t=Ph(Ch.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=Ph(Ch.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=Ph(Ch.Long);break;default:return null}return Nh[e]=t,t}(e);l+=t?t(r,n,a):"''"===e?"'":e.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),l}function Sh(e,t,n){const i=new Date(0);return i.setFullYear(e,t,n),i.setHours(0,0,0),i}function Th(e,t){const n=function(e){return xa(e)[ka.LocaleId]}(e);if(_h[n]=_h[n]||{},_h[n][t])return _h[n][t];let i="";switch(t){case"shortDate":i=dh(e,hh.Short);break;case"mediumDate":i=dh(e,hh.Medium);break;case"longDate":i=dh(e,hh.Long);break;case"fullDate":i=dh(e,hh.Full);break;case"shortTime":i=ph(e,hh.Short);break;case"mediumTime":i=ph(e,hh.Medium);break;case"longTime":i=ph(e,hh.Long);break;case"fullTime":i=ph(e,hh.Full);break;case"short":const t=Th(e,"shortTime"),n=Th(e,"shortDate");i=Oh(fh(e,hh.Short),[t,n]);break;case"medium":const r=Th(e,"mediumTime"),s=Th(e,"mediumDate");i=Oh(fh(e,hh.Medium),[r,s]);break;case"long":const o=Th(e,"longTime"),a=Th(e,"longDate");i=Oh(fh(e,hh.Long),[o,a]);break;case"full":const l=Th(e,"fullTime"),c=Th(e,"fullDate");i=Oh(fh(e,hh.Full),[l,c])}return i&&(_h[n][t]=i),i}function Oh(e,t){return t&&(e=e.replace(/\{([^}]+)}/g,function(e,n){return null!=t&&n in t?t[n]:e})),e}function Ih(e,t,n="-",i,r){let s="";(e<0||r&&e<=0)&&(r?e=1-e:(e=-e,s=n));let o=String(e);for(;o.length<t;)o="0"+o;return i&&(o=o.substr(o.length-t)),s+o}function Mh(e,t,n=0,i=!1,r=!1){return function(s,o){let a=function(e,t){switch(e){case xh.FullYear:return t.getFullYear();case xh.Month:return t.getMonth();case xh.Date:return t.getDate();case xh.Hours:return t.getHours();case xh.Minutes:return t.getMinutes();case xh.Seconds:return t.getSeconds();case xh.FractionalSeconds:return t.getMilliseconds();case xh.Day:return t.getDay();default:throw new Error(`Unknown DateType value "${e}".`)}}(e,s);if((n>0||a>-n)&&(a+=n),e===xh.Hours)0===a&&-12===n&&(a=12);else if(e===xh.FractionalSeconds)return l=t,Ih(a,3).substr(0,l);var l;const c=gh(o,uh.MinusSign);return Ih(a,t,c,i,r)}}function Ah(e,t,n=lh.Format,i=!1){return function(r,s){return function(e,t,n,i,r,s){switch(n){case Eh.Months:return function(e,t,n){const i=xa(e),r=bh([i[ka.MonthsFormat],i[ka.MonthsStandalone]],t);return bh(r,n)}(t,r,i)[e.getMonth()];case Eh.Days:return function(e,t,n){const i=xa(e),r=bh([i[ka.DaysFormat],i[ka.DaysStandalone]],t);return bh(r,n)}(t,r,i)[e.getDay()];case Eh.DayPeriods:const o=e.getHours(),a=e.getMinutes();if(s){const e=function(e){const t=xa(e);return mh(t),(t[ka.ExtraData][2]||[]).map(e=>"string"==typeof e?yh(e):[yh(e[0]),yh(e[1])])}(t),n=function(e,t,n){const i=xa(e);mh(i);const r=bh([i[ka.ExtraData][0],i[ka.ExtraData][1]],t)||[];return bh(r,n)||[]}(t,r,i),s=e.findIndex(e=>{if(Array.isArray(e)){const[t,n]=e,i=o>=t.hours&&a>=t.minutes,r=o<n.hours||o===n.hours&&a<n.minutes;if(t.hours<n.hours){if(i&&r)return!0}else if(i||r)return!0}else if(e.hours===o&&e.minutes===a)return!0;return!1});if(-1!==s)return n[s]}return function(e,t,n){const i=xa(e),r=bh([i[ka.DayPeriodsFormat],i[ka.DayPeriodsStandalone]],t);return bh(r,n)}(t,r,i)[o<12?0:1];case Eh.Eras:return function(e,t){return bh(xa(e)[ka.Eras],t)}(t,i)[e.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${n}`)}}(r,s,e,t,n,i)}}function Ph(e){return function(t,n,i){const r=-1*i,s=gh(n,uh.MinusSign),o=r>0?Math.floor(r/60):Math.ceil(r/60);switch(e){case Ch.Short:return(r>=0?"+":"")+Ih(o,2,s)+Ih(Math.abs(r%60),2,s);case Ch.ShortGMT:return"GMT"+(r>=0?"+":"")+Ih(o,1,s);case Ch.Long:return"GMT"+(r>=0?"+":"")+Ih(o,2,s)+":"+Ih(Math.abs(r%60),2,s);case Ch.Extended:return 0===i?"Z":(r>=0?"+":"")+Ih(o,2,s)+":"+Ih(Math.abs(r%60),2,s);default:throw new Error(`Unknown zone width "${e}"`)}}}function Dh(e){return Sh(e.getFullYear(),e.getMonth(),e.getDate()+(4-e.getDay()))}function Rh(e,t=!1){return function(n,i){let r;if(t){const e=new Date(n.getFullYear(),n.getMonth(),1).getDay()-1,t=n.getDate();r=1+Math.floor((t+e)/7)}else{const e=Dh(n),t=function(e){const t=Sh(e,0,1).getDay();return Sh(e,0,1+(t<=4?4:11)-t)}(e.getFullYear()),i=e.getTime()-t.getTime();r=1+Math.round(i/6048e5)}return Ih(r,e,gh(i,uh.MinusSign))}}function Fh(e,t=!1){return function(n,i){return Ih(Dh(n).getFullYear(),e,gh(i,uh.MinusSign),t)}}const Nh={};function zh(e,t){e=e.replace(/:/g,"");const n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(n)?t:n}function Lh(e){return e instanceof Date&&!isNaN(e.valueOf())}class Bh{}let jh=(()=>{class e extends Bh{constructor(e){super(),this.locale=e}getPluralCategory(e,t){switch(function(e){return xa(e)[ka.PluralCase]}(t||this.locale)(e)){case ah.Zero:return"zero";case ah.One:return"one";case ah.Two:return"two";case ah.Few:return"few";case ah.Many:return"many";default:return"other"}}}return e.\u0275fac=function(t){return new(t||e)(oi(Cc))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})(),Uh=(()=>{class e{constructor(e,t,n,i){this._iterableDiffers=e,this._keyValueDiffers=t,this._ngEl=n,this._renderer=i,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(fo(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(e=>this._toggleClass(e.key,e.currentValue)),e.forEachChangedItem(e=>this._toggleClass(e.key,e.currentValue)),e.forEachRemovedItem(e=>{e.previousValue&&this._toggleClass(e.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(e=>{if("string"!=typeof e.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${ie(e.item)}`);this._toggleClass(e.item,!0)}),e.forEachRemovedItem(e=>this._toggleClass(e.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(e=>this._toggleClass(e,!0)):Object.keys(e).forEach(t=>this._toggleClass(t,!!e[t])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(e=>this._toggleClass(e,!1)):Object.keys(e).forEach(e=>this._toggleClass(e,!1)))}_toggleClass(e,t){(e=e.trim())&&e.split(/\s+/g).forEach(e=>{t?this._renderer.addClass(this._ngEl.nativeElement,e):this._renderer.removeClass(this._ngEl.nativeElement,e)})}}return e.\u0275fac=function(t){return new(t||e)(So(al),So(cl),So(Ha),So(Za))},e.\u0275dir=Qe({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),e})();class Hh{constructor(e,t,n,i){this.$implicit=e,this.ngForOf=t,this.index=n,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Vh=(()=>{class e{constructor(e,t,n){this._viewContainer=e,this._template=t,this._differs=n,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const n=this._ngForOf;if(!this._differ&&n)try{this._differ=this._differs.find(n).create(this.ngForTrackBy)}catch(t){throw new Error(`Cannot find a differ supporting object '${n}' of type '${e=n,e.name||typeof e}'. NgFor only supports binding to Iterables such as Arrays.`)}}var e;if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const t=[];e.forEachOperation((e,n,i)=>{if(null==e.previousIndex){const n=this._viewContainer.createEmbeddedView(this._template,new Hh(null,this._ngForOf,-1,-1),null===i?void 0:i),r=new Gh(e,n);t.push(r)}else if(null==i)this._viewContainer.remove(null===n?void 0:n);else if(null!==n){const r=this._viewContainer.get(n);this._viewContainer.move(r,i);const s=new Gh(e,r);t.push(s)}});for(let n=0;n<t.length;n++)this._perViewChange(t[n].view,t[n].record);for(let n=0,i=this._viewContainer.length;n<i;n++){const e=this._viewContainer.get(n);e.context.index=n,e.context.count=i,e.context.ngForOf=this._ngForOf}e.forEachIdentityChange(e=>{this._viewContainer.get(e.currentIndex).context.$implicit=e.item})}_perViewChange(e,t){e.context.$implicit=t.item}static ngTemplateContextGuard(e,t){return!0}}return e.\u0275fac=function(t){return new(t||e)(So(kl),So(vl),So(al))},e.\u0275dir=Qe({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),e})();class Gh{constructor(e,t){this.record=e,this.view=t}}let Zh=(()=>{class e{constructor(e,t){this._viewContainer=e,this._context=new Wh,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=t}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){Yh("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){Yh("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,t){return!0}}return e.\u0275fac=function(t){return new(t||e)(So(kl),So(vl))},e.\u0275dir=Qe({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),e})();class Wh{constructor(){this.$implicit=null,this.ngIf=null}}function Yh(e,t){if(t&&!t.createEmbeddedView)throw new Error(`${e} must be a TemplateRef, but received '${ie(t)}'.`)}class qh{constructor(e,t){this._viewContainerRef=e,this._templateRef=t,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(e){e&&!this._created?this.create():!e&&this._created&&this.destroy()}}let $h=(()=>{class e{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(e)}_matchCase(e){const t=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||t,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),t}_updateDefaultCases(e){if(this._defaultViews&&e!==this._defaultUsed){this._defaultUsed=e;for(let t=0;t<this._defaultViews.length;t++)this._defaultViews[t].enforceState(e)}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Qe({type:e,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),e})(),Xh=(()=>{class e{constructor(e,t,n){this.ngSwitch=n,n._addCase(),this._view=new qh(e,t)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return e.\u0275fac=function(t){return new(t||e)(So(kl),So(vl),So($h,1))},e.\u0275dir=Qe({type:e,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),e})(),Kh=(()=>{class e{constructor(e,t,n){n._addDefault(new qh(e,t))}}return e.\u0275fac=function(t){return new(t||e)(So(kl),So(vl),So($h,1))},e.\u0275dir=Qe({type:e,selectors:[["","ngSwitchDefault",""]]}),e})(),Qh=(()=>{class e{constructor(e,t,n){this._ngEl=e,this._differs=t,this._renderer=n,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,t){const[n,i]=e.split(".");null!=(t=null!=t&&i?`${t}${i}`:t)?this._renderer.setStyle(this._ngEl.nativeElement,n,t):this._renderer.removeStyle(this._ngEl.nativeElement,n)}_applyChanges(e){e.forEachRemovedItem(e=>this._setStyle(e.key,null)),e.forEachAddedItem(e=>this._setStyle(e.key,e.currentValue)),e.forEachChangedItem(e=>this._setStyle(e.key,e.currentValue))}}return e.\u0275fac=function(t){return new(t||e)(So(Ha),So(cl),So(Za))},e.\u0275dir=Qe({type:e,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}}),e})(),Jh=(()=>{class e{constructor(e){this._viewContainerRef=e,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null}ngOnChanges(e){if(this._shouldRecreateView(e)){const e=this._viewContainerRef;this._viewRef&&e.remove(e.indexOf(this._viewRef)),this._viewRef=this.ngTemplateOutlet?e.createEmbeddedView(this.ngTemplateOutlet,this.ngTemplateOutletContext):null}else this._viewRef&&this.ngTemplateOutletContext&&this._updateExistingContext(this.ngTemplateOutletContext)}_shouldRecreateView(e){const t=e.ngTemplateOutletContext;return!!e.ngTemplateOutlet||t&&this._hasContextShapeChanged(t)}_hasContextShapeChanged(e){const t=Object.keys(e.previousValue||{}),n=Object.keys(e.currentValue||{});if(t.length===n.length){for(let e of n)if(-1===t.indexOf(e))return!0;return!1}return!0}_updateExistingContext(e){for(let t of Object.keys(e))this._viewRef.context[t]=this.ngTemplateOutletContext[t]}}return e.\u0275fac=function(t){return new(t||e)(So(kl))},e.\u0275dir=Qe({type:e,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet"},features:[ht]}),e})(),eu=(()=>{class e{constructor(e){this.locale=e}transform(t,n="mediumDate",i,r){if(null==t||""===t||t!=t)return null;try{return kh(t,n,r||this.locale,i)}catch(s){throw function(e,t){return Error(`InvalidPipeArgument: '${t}' for pipe '${ie(e)}'`)}(e,s.message)}}}return e.\u0275fac=function(t){return new(t||e)(So(Cc))},e.\u0275pipe=Je({name:"date",type:e,pure:!0}),e})(),tu=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Xe({type:e}),e.\u0275inj=fe({providers:[{provide:Bh,useClass:jh}]}),e})();function nu(e){return"browser"===e}class iu extends class extends class{}{constructor(){super()}supportsDOMEvents(){return!0}}{static makeCurrent(){var e;e=new iu,rh||(rh=e)}getProperty(e,t){return e[t]}log(e){window.console&&window.console.log&&window.console.log(e)}logGroup(e){window.console&&window.console.group&&window.console.group(e)}logGroupEnd(){window.console&&window.console.groupEnd&&window.console.groupEnd()}onAndCancel(e,t,n){return e.addEventListener(t,n,!1),()=>{e.removeEventListener(t,n,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){return e.parentNode&&e.parentNode.removeChild(e),e}getValue(e){return e.value}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getHistory(){return window.history}getLocation(){return window.location}getBaseHref(e){const t=su||(su=document.querySelector("base"),su)?su.getAttribute("href"):null;return null==t?null:(n=t,ru||(ru=document.createElement("a")),ru.setAttribute("href",n),"/"===ru.pathname.charAt(0)?ru.pathname:"/"+ru.pathname);var n}resetBaseElement(){su=null}getUserAgent(){return window.navigator.userAgent}performanceNow(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}supportsCookies(){return!0}getCookie(e){return function(e,t){t=encodeURIComponent(t);for(const n of e.split(";")){const e=n.indexOf("="),[i,r]=-1==e?[n,""]:[n.slice(0,e),n.slice(e+1)];if(i.trim()===t)return decodeURIComponent(r)}return null}(document.cookie,e)}}let ru,su=null;const ou=new Zn("TRANSITION_ID"),au=[{provide:pc,useFactory:function(e,t,n){return()=>{n.get(fc).donePromise.then(()=>{const n=sh();Array.prototype.slice.apply(t.querySelectorAll("style[ng-transition]")).filter(t=>t.getAttribute("ng-transition")===e).forEach(e=>n.remove(e))})}},deps:[ou,oh,io],multi:!0}];class lu{static init(){var e;e=new lu,Zc=e}addToWindow(e){De.getAngularTestability=(t,n=!0)=>{const i=e.findTestabilityInTree(t,n);if(null==i)throw new Error("Could not find testability for element.");return i},De.getAllAngularTestabilities=()=>e.getAllTestabilities(),De.getAllAngularRootElements=()=>e.getAllRootElements(),De.frameworkStabilizers||(De.frameworkStabilizers=[]),De.frameworkStabilizers.push(e=>{const t=De.getAllAngularTestabilities();let n=t.length,i=!1;const r=function(t){i=i||t,n--,0==n&&e(i)};t.forEach(function(e){e.whenStable(r)})})}findTestabilityInTree(e,t,n){if(null==t)return null;const i=e.getTestability(t);return null!=i?i:n?sh().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}const cu=new Zn("EventManagerPlugins");let hu=(()=>{class e{constructor(e,t){this._zone=t,this._eventNameToPlugin=new Map,e.forEach(e=>e.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,t,n){return this._findPluginFor(t).addEventListener(e,t,n)}addGlobalEventListener(e,t,n){return this._findPluginFor(t).addGlobalEventListener(e,t,n)}getZone(){return this._zone}_findPluginFor(e){const t=this._eventNameToPlugin.get(e);if(t)return t;const n=this._plugins;for(let i=0;i<n.length;i++){const t=n[i];if(t.supports(e))return this._eventNameToPlugin.set(e,t),t}throw new Error(`No event manager plugin found for event ${e}`)}}return e.\u0275fac=function(t){return new(t||e)(oi(cu),oi(Rc))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();class uu{constructor(e){this._doc=e}addGlobalEventListener(e,t,n){const i=sh().getGlobalEventTarget(this._doc,e);if(!i)throw new Error(`Unsupported event target ${i} for event ${t}`);return this.addEventListener(i,t,n)}}let du=(()=>{class e{constructor(){this._stylesSet=new Set}addStyles(e){const t=new Set;e.forEach(e=>{this._stylesSet.has(e)||(this._stylesSet.add(e),t.add(e))}),this.onStylesAdded(t)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})(),pu=(()=>{class e extends du{constructor(e){super(),this._doc=e,this._hostNodes=new Set,this._styleNodes=new Set,this._hostNodes.add(e.head)}_addStylesToHost(e,t){e.forEach(e=>{const n=this._doc.createElement("style");n.textContent=e,this._styleNodes.add(t.appendChild(n))})}addHost(e){this._addStylesToHost(this._stylesSet,e),this._hostNodes.add(e)}removeHost(e){this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach(t=>this._addStylesToHost(e,t))}ngOnDestroy(){this._styleNodes.forEach(e=>sh().remove(e))}}return e.\u0275fac=function(t){return new(t||e)(oi(oh))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();const fu={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},gu=/%COMP%/g;function mu(e,t,n){for(let i=0;i<t.length;i++){let r=t[i];Array.isArray(r)?mu(e,r,n):(r=r.replace(gu,e),n.push(r))}return n}function bu(e){return t=>{if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}let yu=(()=>{class e{constructor(e,t,n){this.eventManager=e,this.sharedStylesHost=t,this.appId=n,this.rendererByCompId=new Map,this.defaultRenderer=new vu(e)}createRenderer(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case Oe.Emulated:{let n=this.rendererByCompId.get(t.id);return n||(n=new _u(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,n)),n.applyToHost(e),n}case 1:case Oe.ShadowDom:return new wu(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){const e=mu(t.id,t.styles,[]);this.sharedStylesHost.addStyles(e),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return e.\u0275fac=function(t){return new(t||e)(oi(hu),oi(pu),oi(gc))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();class vu{constructor(e){this.eventManager=e,this.data=Object.create(null)}destroy(){}createElement(e,t){return t?document.createElementNS(fu[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){e.appendChild(t)}insertBefore(e,t,n){e&&e.insertBefore(t,n)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error(`The selector "${e}" did not match any elements`);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,i){if(i){t=i+":"+t;const r=fu[i];r?e.setAttributeNS(r,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){const i=fu[n];i?e.removeAttributeNS(i,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,i){i&(sr.DashCase|sr.Important)?e.style.setProperty(t,n,i&sr.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&sr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e[t]=n}setValue(e,t){e.nodeValue=t}listen(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,bu(n)):this.eventManager.addEventListener(e,t,bu(n))}}class _u extends vu{constructor(e,t,n,i){super(e),this.component=n;const r=mu(i+"-"+n.id,n.styles,[]);t.addStyles(r),this.contentAttr="_ngcontent-%COMP%".replace(gu,i+"-"+n.id),this.hostAttr="_nghost-%COMP%".replace(gu,i+"-"+n.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}}class wu extends vu{constructor(e,t,n,i){super(e),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const r=mu(i.id,i.styles,[]);for(let s=0;s<r.length;s++){const e=document.createElement("style");e.textContent=r[s],this.shadowRoot.appendChild(e)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let Cu=(()=>{class e extends uu{constructor(e){super(e)}supports(e){return!0}addEventListener(e,t,n){return e.addEventListener(t,n,!1),()=>this.removeEventListener(e,t,n)}removeEventListener(e,t,n){return e.removeEventListener(t,n)}}return e.\u0275fac=function(t){return new(t||e)(oi(oh))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();const xu=["alt","control","meta","shift"],Eu={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},ku={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Su={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let Tu=(()=>{class e extends uu{constructor(e){super(e)}supports(t){return null!=e.parseEventName(t)}addEventListener(t,n,i){const r=e.parseEventName(n),s=e.eventCallback(r.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>sh().onAndCancel(t,r.domEventName,s))}static parseEventName(t){const n=t.toLowerCase().split("."),i=n.shift();if(0===n.length||"keydown"!==i&&"keyup"!==i)return null;const r=e._normalizeKey(n.pop());let s="";if(xu.forEach(e=>{const t=n.indexOf(e);t>-1&&(n.splice(t,1),s+=e+".")}),s+=r,0!=n.length||0===r.length)return null;const o={};return o.domEventName=i,o.fullKey=s,o}static getEventFullKey(e){let t="",n=function(e){let t=e.key;if(null==t){if(t=e.keyIdentifier,null==t)return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&ku.hasOwnProperty(t)&&(t=ku[t]))}return Eu[t]||t}(e);return n=n.toLowerCase()," "===n?n="space":"."===n&&(n="dot"),xu.forEach(i=>{i!=n&&(0,Su[i])(e)&&(t+=i+".")}),t+=n,t}static eventCallback(t,n,i){return r=>{e.getEventFullKey(r)===t&&i.runGuarded(()=>n(r))}}static _normalizeKey(e){switch(e){case"esc":return"escape";default:return e}}}return e.\u0275fac=function(t){return new(t||e)(oi(oh))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})(),Ou=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=pe({factory:function(){return oi(Iu)},token:e,providedIn:"root"}),e})(),Iu=(()=>{class e extends Ou{constructor(e){super(),this._doc=e}sanitize(e,t){if(null==t)return null;switch(e){case qi.NONE:return t;case qi.HTML:return xi(t,"HTML")?Ci(t):Wi(this._doc,String(t)).toString();case qi.STYLE:return xi(t,"Style")?Ci(t):t;case qi.SCRIPT:if(xi(t,"Script"))return Ci(t);throw new Error("unsafe value used in a script context");case qi.URL:return Ei(t),xi(t,"URL")?Ci(t):Ii(String(t));case qi.RESOURCE_URL:if(xi(t,"ResourceURL"))return Ci(t);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${e} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(e){return new bi(e)}bypassSecurityTrustStyle(e){return new yi(e)}bypassSecurityTrustScript(e){return new vi(e)}bypassSecurityTrustUrl(e){return new _i(e)}bypassSecurityTrustResourceUrl(e){return new wi(e)}}return e.\u0275fac=function(t){return new(t||e)(oi(oh))},e.\u0275prov=pe({factory:function(){return e=oi(Us),new Iu(e.get(oh));var e},token:e,providedIn:"root"}),e})();const Mu=$c(th,"browser",[{provide:vc,useValue:"browser"},{provide:yc,useValue:function(){iu.makeCurrent(),lu.init()},multi:!0},{provide:oh,useFactory:function(){return function(e){gt=e}(document),document},deps:[]}]),Au=[[],{provide:Vs,useValue:"root"},{provide:tr,useFactory:function(){return new tr},deps:[]},{provide:cu,useClass:Cu,multi:!0,deps:[oh,Rc,vc]},{provide:cu,useClass:Tu,multi:!0,deps:[oh]},[],{provide:yu,useClass:yu,deps:[hu,pu,gc]},{provide:Ga,useExisting:yu},{provide:du,useExisting:pu},{provide:pu,useClass:pu,deps:[oh]},{provide:Uc,useClass:Uc,deps:[Rc]},{provide:hu,useClass:hu,deps:[cu,Rc]},[]];let Pu=(()=>{class e{constructor(e){if(e)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(t){return{ngModule:e,providers:[{provide:gc,useValue:t.appId},{provide:ou,useExisting:gc},au]}}}return e.\u0275fac=function(t){return new(t||e)(oi(e,12))},e.\u0275mod=Xe({type:e}),e.\u0275inj=fe({providers:Au,imports:[tu,ih]}),e})();function Du(e,t){return new y(n=>{const i=e.length;if(0===i)return void n.complete();const r=new Array(i);let s=0,o=0;for(let a=0;a<i;a++){const l=N(e[a]);let c=!1;n.add(l.subscribe({next:e=>{c||(c=!0,o++),r[a]=e},error:e=>n.error(e),complete:()=>{s++,s!==i&&c||(o===i&&n.next(t?t.reduce((e,t,n)=>(e[t]=r[n],e),{}):r),n.complete())}}))}})}"undefined"!=typeof window&&window,n("yLV6");class Ru{}const Fu=new Zn("NgValueAccessor"),Nu={provide:Fu,useExisting:oe(()=>zu),multi:!0};let zu=(()=>{class e extends Ru{constructor(e,t){super(),this._renderer=e,this._elementRef=t,this.onChange=e=>{},this.onTouched=()=>{}}writeValue(e){this._renderer.setProperty(this._elementRef.nativeElement,"checked",e)}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}}return e.\u0275fac=function(t){return new(t||e)(So(Za),So(Ha))},e.\u0275dir=Qe({type:e,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(e,t){1&e&&zo("change",function(e){return t.onChange(e.target.checked)})("blur",function(){return t.onTouched()})},features:[Fa([Nu]),so]}),e})();const Lu={provide:Fu,useExisting:oe(()=>ju),multi:!0},Bu=new Zn("CompositionEventMode");let ju=(()=>{class e{constructor(e,t,n){this._renderer=e,this._elementRef=t,this._compositionMode=n,this.onChange=e=>{},this.onTouched=()=>{},this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const e=sh()?sh().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}())}writeValue(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==e?"":e)}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return e.\u0275fac=function(t){return new(t||e)(So(Za),So(Ha),So(Bu,8))},e.\u0275dir=Qe({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,t){1&e&&zo("input",function(e){return t._handleInput(e.target.value)})("blur",function(){return t.onTouched()})("compositionstart",function(){return t._compositionStart()})("compositionend",function(e){return t._compositionEnd(e.target.value)})},features:[Fa([Lu])]}),e})();function Uu(e){return null==e||0===e.length}function Hu(e){return null!=e&&"number"==typeof e.length}const Vu=new Zn("NgValidators"),Gu=new Zn("NgAsyncValidators");function Zu(e){return null}function Wu(e){return null!=e}function Yu(e){const t=No(e)?N(e):e;return t,t}function qu(e){let t={};return e.forEach(e=>{t=null!=e?Object.assign(Object.assign({},t),e):t}),0===Object.keys(t).length?null:t}function $u(e,t){return t.map(t=>t(e))}function Xu(e){return e.map(e=>function(e){return!e.validate}(e)?e:t=>e.validate(t))}function Ku(e){return null!=e?function(e){if(!e)return null;const t=e.filter(Wu);return 0==t.length?null:function(e){return qu($u(e,t))}}(Xu(e)):null}function Qu(e){return null!=e?function(e){if(!e)return null;const t=e.filter(Wu);return 0==t.length?null:function(e){return function(...e){if(1===e.length){const t=e[0];if(l(t))return Du(t,null);if(c(t)&&Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);return Du(e.map(e=>t[e]),e)}}if("function"==typeof e[e.length-1]){const t=e.pop();return Du(e=1===e.length&&l(e[0])?e[0]:e,null).pipe(S(e=>t(...e)))}return Du(e,null)}($u(e,t).map(Yu)).pipe(S(qu))}}(Xu(e)):null}function Ju(e,t){return null===e?[t]:Array.isArray(e)?[...e,t]:[e,t]}let ed=(()=>{class e{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Ku(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Qu(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Qe({type:e}),e})(),td=(()=>{class e extends ed{get formDirective(){return null}get path(){return null}}return e.\u0275fac=function(t){return nd(t||e)},e.\u0275dir=Qe({type:e,features:[so]}),e})();const nd=Hn(td);class id extends ed{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class rd{constructor(e){this._cd=e}is(e){var t,n;return!!(null===(n=null===(t=this._cd)||void 0===t?void 0:t.control)||void 0===n?void 0:n[e])}}let sd=(()=>{class e extends rd{constructor(e){super(e)}}return e.\u0275fac=function(t){return new(t||e)(So(id,2))},e.\u0275dir=Qe({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,t){2&e&&na("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))},features:[so]}),e})(),od=(()=>{class e extends rd{constructor(e){super(e)}}return e.\u0275fac=function(t){return new(t||e)(So(td,10))},e.\u0275dir=Qe({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:14,hostBindings:function(e,t){2&e&&na("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))},features:[so]}),e})();function ad(e,t){cd(e,t,!0),t.valueAccessor.writeValue(e.value),function(e,t){t.valueAccessor.registerOnChange(n=>{e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&hd(e,t)})}(e,t),function(e,t){const n=(e,n)=>{t.valueAccessor.writeValue(e),n&&t.viewToModelUpdate(e)};e.registerOnChange(n),t._registerOnDestroy(()=>{e._unregisterOnChange(n)})}(e,t),function(e,t){t.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&hd(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),function(e,t){if(t.valueAccessor.setDisabledState){const n=e=>{t.valueAccessor.setDisabledState(e)};e.registerOnDisabledChange(n),t._registerOnDestroy(()=>{e._unregisterOnDisabledChange(n)})}}(e,t)}function ld(e,t){e.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function cd(e,t,n){const i=function(e){return e._rawValidators}(e);null!==t.validator?e.setValidators(Ju(i,t.validator)):"function"==typeof i&&e.setValidators([i]);const r=function(e){return e._rawAsyncValidators}(e);if(null!==t.asyncValidator?e.setAsyncValidators(Ju(r,t.asyncValidator)):"function"==typeof r&&e.setAsyncValidators([r]),n){const n=()=>e.updateValueAndValidity();ld(t._rawValidators,n),ld(t._rawAsyncValidators,n)}}function hd(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function ud(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}function dd(e){return(md(e)?e.validators:e)||null}function pd(e){return Array.isArray(e)?Ku(e):e||null}function fd(e,t){return(md(t)?t.asyncValidators:e)||null}function gd(e){return Array.isArray(e)?Qu(e):e||null}function md(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}class bd{constructor(e,t){this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=e,this._rawAsyncValidators=t,this._composedValidatorFn=pd(this._rawValidators),this._composedAsyncValidatorFn=gd(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return"VALID"===this.status}get invalid(){return"INVALID"===this.status}get pending(){return"PENDING"==this.status}get disabled(){return"DISABLED"===this.status}get enabled(){return"DISABLED"!==this.status}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._rawValidators=e,this._composedValidatorFn=pd(e)}setAsyncValidators(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=gd(e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status="PENDING",!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status="DISABLED",this.errors=null,this._forEachChild(t=>{t.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(e=>e(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status="VALID",this._forEachChild(t=>{t.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(e=>e(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),"VALID"!==this.status&&"PENDING"!==this.status||this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?"DISABLED":"VALID"}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status="PENDING",this._hasOwnPendingAsyncValidator=!0;const t=Yu(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(t=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(t,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){return function(e,t,n){if(null==t)return null;if(Array.isArray(t)||(t=t.split(".")),Array.isArray(t)&&0===t.length)return null;let i=e;return t.forEach(e=>{i=i instanceof vd?i.controls.hasOwnProperty(e)?i.controls[e]:null:i instanceof _d&&i.at(e)||null}),i}(this,e)}getError(e,t){const n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new Xl,this.statusChanges=new Xl}_calculateStatus(){return this._allControlsDisabled()?"DISABLED":this.errors?"INVALID":this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus("PENDING")?"PENDING":this._anyControlsHaveStatus("INVALID")?"INVALID":"VALID"}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_isBoxedValue(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){md(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class yd extends bd{constructor(e=null,t,n){super(dd(t),fd(n,t)),this._onChange=[],this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!n})}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(e=>e(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=null,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){ud(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){ud(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}class vd extends bd{constructor(e,t,n){super(dd(t),fd(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!n})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t){this.registerControl(e,t),this.updateValueAndValidity(),this._onCollectionChange()}removeControl(e){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity(),this._onCollectionChange()}setControl(e,t){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity(),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){this._checkAllValuesPresent(e),Object.keys(e).forEach(n=>{this._throwIfControlMissing(n),this.controls[n].setValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(n=>{this.controls[n]&&this.controls[n].patchValue(e[n],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((n,i)=>{n.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,n)=>(e[n]=t instanceof yd?t.value:t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(e,t)=>!!t._syncPendingControls()||e);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_throwIfControlMissing(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error(`Cannot find form control with name: ${e}.`)}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const n=this.controls[t];n&&e(n,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const t of Object.keys(this.controls)){const n=this.controls[t];if(this.contains(t)&&e(n))return!0}return!1}_reduceValue(){return this._reduceChildren({},(e,t,n)=>((t.enabled||this.disabled)&&(e[n]=t.value),e))}_reduceChildren(e,t){let n=e;return this._forEachChild((e,i)=>{n=t(n,e,i)}),n}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(e){this._forEachChild((t,n)=>{if(void 0===e[n])throw new Error(`Must supply a value for form control with name: '${n}'.`)})}}class _d extends bd{constructor(e,t,n){super(dd(t),fd(n,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!n})}at(e){return this.controls[e]}push(e){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity(),this._onCollectionChange()}insert(e,t){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity()}removeAt(e){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),this.updateValueAndValidity()}setControl(e,t){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity(),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,t={}){this._checkAllValuesPresent(e),e.forEach((e,n)=>{this._throwIfControlMissing(n),this.at(n).setValue(e,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(e.forEach((e,n)=>{this.at(n)&&this.at(n).patchValue(e,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e=[],t={}){this._forEachChild((n,i)=>{n.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(e=>e instanceof yd?e.value:e.getRawValue())}clear(){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity())}_syncPendingControls(){let e=this.controls.reduce((e,t)=>!!t._syncPendingControls()||e,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_throwIfControlMissing(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error(`Cannot find form control at index ${e}`)}_forEachChild(e){this.controls.forEach((t,n)=>{e(t,n)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(t=>t.enabled&&e(t))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_checkAllValuesPresent(e){this._forEachChild((t,n)=>{if(void 0===e[n])throw new Error(`Must supply a value for form control at index: ${n}.`)})}_allControlsDisabled(){for(const e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}const wd={provide:td,useExisting:oe(()=>xd)},Cd=(()=>Promise.resolve(null))();let xd=(()=>{class e extends td{constructor(e,t){super(),this.submitted=!1,this._directives=[],this.ngSubmit=new Xl,this.form=new vd({},Ku(e),Qu(t))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){Cd.then(()=>{const t=this._findContainer(e.path);e.control=t.registerControl(e.name,e.control),ad(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.push(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){Cd.then(()=>{const t=this._findContainer(e.path);t&&t.removeControl(e.name),ud(this._directives,e)})}addFormGroup(e){Cd.then(()=>{const t=this._findContainer(e.path),n=new vd({});(function(e,t){cd(e,t,!1)})(n,e),t.registerControl(e.name,n),n.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){Cd.then(()=>{const t=this._findContainer(e.path);t&&t.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,t){Cd.then(()=>{this.form.get(e.path).setValue(t)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,t=this._directives,this.form._syncPendingControls(),t.forEach(e=>{const t=e.control;"submit"===t.updateOn&&t._pendingChange&&(e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1)}),this.ngSubmit.emit(e),!1;var t}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return e.\u0275fac=function(t){return new(t||e)(So(Vu,10),So(Gu,10))},e.\u0275dir=Qe({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,t){1&e&&zo("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Fa([wd]),so]}),e})();const Ed={provide:id,useExisting:oe(()=>Sd)},kd=(()=>Promise.resolve(null))();let Sd=(()=>{class e extends id{constructor(e,t,n,i){super(),this.control=new yd,this._registered=!1,this.update=new Xl,this._parent=e,this._setValidators(t),this._setAsyncValidators(n),this.valueAccessor=function(e,t){if(!t)return null;let n,i,r;return Array.isArray(t),t.forEach(e=>{e.constructor===ju?n=e:Object.getPrototypeOf(e.constructor)===Ru?i=e:r=e}),r||i||n||null}(0,i)}ngOnChanges(e){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in e&&this._updateDisabled(e),function(e,t){if(!e.hasOwnProperty("model"))return!1;const n=e.model;return!!n.isFirstChange()||!Object.is(t,n.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?function(e,t){return[...t.path,e]}(this.name,this._parent):[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){ad(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){kd.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1})})}_updateDisabled(e){const t=e.isDisabled.currentValue,n=""===t||t&&"false"!==t;kd.then(()=>{n&&!this.control.disabled?this.control.disable():!n&&this.control.disabled&&this.control.enable()})}}return e.\u0275fac=function(t){return new(t||e)(So(td,9),So(Vu,10),So(Gu,10),So(Fu,10))},e.\u0275dir=Qe({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Fa([Ed]),so,ht]}),e})(),Td=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Qe({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),e})();const Od={provide:Fu,useExisting:oe(()=>Id),multi:!0};let Id=(()=>{class e extends Ru{constructor(e,t){super(),this._renderer=e,this._elementRef=t,this.onChange=e=>{},this.onTouched=()=>{}}writeValue(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==e?"":e)}registerOnChange(e){this.onChange=t=>{e(""==t?null:parseFloat(t))}}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}}return e.\u0275fac=function(t){return new(t||e)(So(Za),So(Ha))},e.\u0275dir=Qe({type:e,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(e,t){1&e&&zo("input",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},features:[Fa([Od]),so]}),e})();const Md={provide:Fu,useExisting:oe(()=>Dd),multi:!0};let Ad=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Xe({type:e}),e.\u0275inj=fe({}),e})(),Pd=(()=>{class e{constructor(){this._accessors=[]}add(e,t){this._accessors.push([e,t])}remove(e){for(let t=this._accessors.length-1;t>=0;--t)if(this._accessors[t][1]===e)return void this._accessors.splice(t,1)}select(e){this._accessors.forEach(t=>{this._isSameGroup(t,e)&&t[1]!==e&&t[1].fireUncheck(e.value)})}_isSameGroup(e,t){return!!e[0].control&&e[0]._parent===t._control._parent&&e[1].name===t.name}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=pe({factory:function(){return new e},token:e,providedIn:Ad}),e})(),Dd=(()=>{class e extends Ru{constructor(e,t,n,i){super(),this._renderer=e,this._elementRef=t,this._registry=n,this._injector=i,this.onChange=()=>{},this.onTouched=()=>{}}ngOnInit(){this._control=this._injector.get(id),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(e){this._state=e===this.value,this._renderer.setProperty(this._elementRef.nativeElement,"checked",this._state)}registerOnChange(e){this._fn=e,this.onChange=()=>{e(this.value),this._registry.select(this)}}fireUncheck(e){this.writeValue(e)}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}}return e.\u0275fac=function(t){return new(t||e)(So(Za),So(Ha),So(Pd),So(io))},e.\u0275dir=Qe({type:e,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(e,t){1&e&&zo("change",function(){return t.onChange()})("blur",function(){return t.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[Fa([Md]),so]}),e})();const Rd={provide:Fu,useExisting:oe(()=>Fd),multi:!0};let Fd=(()=>{class e extends Ru{constructor(e,t){super(),this._renderer=e,this._elementRef=t,this.onChange=e=>{},this.onTouched=()=>{}}writeValue(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",parseFloat(e))}registerOnChange(e){this.onChange=t=>{e(""==t?null:parseFloat(t))}}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}}return e.\u0275fac=function(t){return new(t||e)(So(Za),So(Ha))},e.\u0275dir=Qe({type:e,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,t){1&e&&zo("change",function(e){return t.onChange(e.target.value)})("input",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},features:[Fa([Rd]),so]}),e})();const Nd={provide:Fu,useExisting:oe(()=>Ld),multi:!0};function zd(e,t){return null==e?`${t}`:(t&&"object"==typeof t&&(t="Object"),`${e}: ${t}`.slice(0,50))}let Ld=(()=>{class e extends Ru{constructor(e,t){super(),this._renderer=e,this._elementRef=t,this._optionMap=new Map,this._idCounter=0,this.onChange=e=>{},this.onTouched=()=>{},this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const t=this._getOptionId(e);null==t&&this._renderer.setProperty(this._elementRef.nativeElement,"selectedIndex",-1);const n=zd(t,e);this._renderer.setProperty(this._elementRef.nativeElement,"value",n)}registerOnChange(e){this.onChange=t=>{this.value=this._getOptionValue(t),e(this.value)}}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const t of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(t),e))return t;return null}_getOptionValue(e){const t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t):e}}return e.\u0275fac=function(t){return new(t||e)(So(Za),So(Ha))},e.\u0275dir=Qe({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,t){1&e&&zo("change",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[Fa([Nd]),so]}),e})(),Bd=(()=>{class e{constructor(e,t,n){this._element=e,this._renderer=t,this._select=n,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(zd(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return e.\u0275fac=function(t){return new(t||e)(So(Ha),So(Za),So(Ld,9))},e.\u0275dir=Qe({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})();const jd={provide:Fu,useExisting:oe(()=>Hd),multi:!0};function Ud(e,t){return null==e?`${t}`:("string"==typeof t&&(t=`'${t}'`),t&&"object"==typeof t&&(t="Object"),`${e}: ${t}`.slice(0,50))}let Hd=(()=>{class e extends Ru{constructor(e,t){super(),this._renderer=e,this._elementRef=t,this._optionMap=new Map,this._idCounter=0,this.onChange=e=>{},this.onTouched=()=>{},this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let t;if(this.value=e,Array.isArray(e)){const n=e.map(e=>this._getOptionId(e));t=(e,t)=>{e._setSelected(n.indexOf(t.toString())>-1)}}else t=(e,t)=>{e._setSelected(!1)};this._optionMap.forEach(t)}registerOnChange(e){this.onChange=t=>{const n=[];if(void 0!==t.selectedOptions){const e=t.selectedOptions;for(let t=0;t<e.length;t++){const i=e.item(t),r=this._getOptionValue(i.value);n.push(r)}}else{const e=t.options;for(let t=0;t<e.length;t++){const i=e.item(t);if(i.selected){const e=this._getOptionValue(i.value);n.push(e)}}}this.value=n,e(n)}}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}_registerOption(e){const t=(this._idCounter++).toString();return this._optionMap.set(t,e),t}_getOptionId(e){for(const t of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(t)._value,e))return t;return null}_getOptionValue(e){const t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t)._value:e}}return e.\u0275fac=function(t){return new(t||e)(So(Za),So(Ha))},e.\u0275dir=Qe({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,t){1&e&&zo("change",function(e){return t.onChange(e.target)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[Fa([jd]),so]}),e})(),Vd=(()=>{class e{constructor(e,t,n){this._element=e,this._renderer=t,this._select=n,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(Ud(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(Ud(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return e.\u0275fac=function(t){return new(t||e)(So(Ha),So(Za),So(Hd,9))},e.\u0275dir=Qe({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})();const Gd={provide:Vu,useExisting:oe(()=>Zd),multi:!0};let Zd=(()=>{class e{constructor(){this._required=!1}get required(){return this._required}set required(e){this._required=null!=e&&!1!==e&&"false"!=`${e}`,this._onChange&&this._onChange()}validate(e){return this.required?function(e){return Uu(e.value)?{required:!0}:null}(e):null}registerOnValidatorChange(e){this._onChange=e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Qe({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,t){2&e&&Co("required",t.required?"":null)},inputs:{required:"required"},features:[Fa([Gd])]}),e})();const Wd={provide:Vu,useExisting:oe(()=>Yd),multi:!0};let Yd=(()=>{class e{constructor(){this._validator=Zu}ngOnChanges(e){"minlength"in e&&(this._createValidator(),this._onChange&&this._onChange())}validate(e){return null==this.minlength?null:this._validator(e)}registerOnValidatorChange(e){this._onChange=e}_createValidator(){var e;this._validator=(e="number"==typeof this.minlength?this.minlength:parseInt(this.minlength,10),t=>Uu(t.value)||!Hu(t.value)?null:t.value.length<e?{minlength:{requiredLength:e,actualLength:t.value.length}}:null)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Qe({type:e,selectors:[["","minlength","","formControlName",""],["","minlength","","formControl",""],["","minlength","","ngModel",""]],hostVars:1,hostBindings:function(e,t){2&e&&Co("minlength",t.minlength?t.minlength:null)},inputs:{minlength:"minlength"},features:[Fa([Wd]),ht]}),e})();const qd={provide:Vu,useExisting:oe(()=>$d),multi:!0};let $d=(()=>{class e{constructor(){this._validator=Zu}ngOnChanges(e){"maxlength"in e&&(this._createValidator(),this._onChange&&this._onChange())}validate(e){return null!=this.maxlength?this._validator(e):null}registerOnValidatorChange(e){this._onChange=e}_createValidator(){var e;this._validator=(e="number"==typeof this.maxlength?this.maxlength:parseInt(this.maxlength,10),t=>Hu(t.value)&&t.value.length>e?{maxlength:{requiredLength:e,actualLength:t.value.length}}:null)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Qe({type:e,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,t){2&e&&Co("maxlength",t.maxlength?t.maxlength:null)},inputs:{maxlength:"maxlength"},features:[Fa([qd]),ht]}),e})(),Xd=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Xe({type:e}),e.\u0275inj=fe({imports:[[Ad]]}),e})(),Kd=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Xe({type:e}),e.\u0275inj=fe({imports:[Xd]}),e})();class Qd{}function Jd(e,t){return{type:7,name:e,definitions:t,options:{}}}function ep(e,t=null){return{type:4,styles:t,timings:e}}function tp(e,t=null){return{type:2,steps:e,options:t}}function np(e){return{type:6,styles:e,offset:null}}function ip(e,t,n){return{type:0,name:e,styles:t,options:n}}function rp(e){return{type:5,steps:e}}function sp(e,t,n=null){return{type:1,expr:e,animation:t,options:n}}function op(e){Promise.resolve(null).then(e)}class ap{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){op(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(e=>e()),t.length=0}}class lp{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,n=0,i=0;const r=this.players.length;0==r?op(()=>this._onFinish()):this.players.forEach(e=>{e.onDone(()=>{++t==r&&this._onFinish()}),e.onDestroy(()=>{++n==r&&this._onDestroy()}),e.onStart(()=>{++i==r&&this._onStart()})}),this.totalTime=this.players.reduce((e,t)=>Math.max(e,t.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(e=>{const n=e.totalTime?Math.min(1,t/e.totalTime):1;e.setPosition(n)})}getPosition(){const e=this.players.reduce((e,t)=>null===e||t.totalTime>e.totalTime?t:e,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(e=>e()),t.length=0}}function cp(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function hp(e){switch(e.length){case 0:return new ap;case 1:return e[0];default:return new lp(e)}}function up(e,t,n,i,r={},s={}){const o=[],a=[];let l=-1,c=null;if(i.forEach(e=>{const n=e.offset,i=n==l,h=i&&c||{};Object.keys(e).forEach(n=>{let i=n,a=e[n];if("offset"!==n)switch(i=t.normalizePropertyName(i,o),a){case"!":a=r[n];break;case"*":a=s[n];break;default:a=t.normalizeStyleValue(n,i,a,o)}h[i]=a}),i||a.push(h),c=h,l=n}),o.length){const e="\n - ";throw new Error(`Unable to animate due to the following errors:${e}${o.join(e)}`)}return a}function dp(e,t,n,i){switch(t){case"start":e.onStart(()=>i(n&&pp(n,"start",e)));break;case"done":e.onDone(()=>i(n&&pp(n,"done",e)));break;case"destroy":e.onDestroy(()=>i(n&&pp(n,"destroy",e)))}}function pp(e,t,n){const i=n.totalTime,r=fp(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,null==i?e.totalTime:i,!!n.disabled),s=e._data;return null!=s&&(r._data=s),r}function fp(e,t,n,i,r="",s=0,o){return{element:e,triggerName:t,fromState:n,toState:i,phaseName:r,totalTime:s,disabled:!!o}}function gp(e,t,n){let i;return e instanceof Map?(i=e.get(t),i||e.set(t,i=n)):(i=e[t],i||(i=e[t]=n)),i}function mp(e){const t=e.indexOf(":");return[e.substring(1,t),e.substr(t+1)]}let bp=(e,t)=>!1,yp=(e,t)=>!1,vp=(e,t,n)=>[];const _p=cp();(_p||"undefined"!=typeof Element)&&(bp=(e,t)=>e.contains(t),yp=(()=>{if(_p||Element.prototype.matches)return(e,t)=>e.matches(t);{const e=Element.prototype,t=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;return t?(e,n)=>t.apply(e,[n]):yp}})(),vp=(e,t,n)=>{let i=[];if(n){const n=e.querySelectorAll(t);for(let e=0;e<n.length;e++)i.push(n[e])}else{const n=e.querySelector(t);n&&i.push(n)}return i});let wp=null,Cp=!1;function xp(e){wp||(wp=("undefined"!=typeof document?document.body:null)||{},Cp=!!wp.style&&"WebkitAppearance"in wp.style);let t=!0;return wp.style&&!function(e){return"ebkit"==e.substring(1,6)}(e)&&(t=e in wp.style,!t&&Cp)&&(t="Webkit"+e.charAt(0).toUpperCase()+e.substr(1)in wp.style),t}const Ep=yp,kp=bp,Sp=vp;function Tp(e){const t={};return Object.keys(e).forEach(n=>{const i=n.replace(/([a-z])([A-Z])/g,"$1-$2");t[i]=e[n]}),t}let Op=(()=>{class e{validateStyleProperty(e){return xp(e)}matchesElement(e,t){return Ep(e,t)}containsElement(e,t){return kp(e,t)}query(e,t,n){return Sp(e,t,n)}computeStyle(e,t,n){return n||""}animate(e,t,n,i,r,s=[],o){return new ap(n,i)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})(),Ip=(()=>{class e{}return e.NOOP=new Op,e})();function Mp(e){if("number"==typeof e)return e;const t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:Ap(parseFloat(t[1]),t[2])}function Ap(e,t){switch(t){case"s":return 1e3*e;default:return e}}function Pp(e,t,n){return e.hasOwnProperty("duration")?e:function(e,t,n){let i,r=0,s="";if("string"==typeof e){const n=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===n)return t.push(`The provided timing value "${e}" is invalid.`),{duration:0,delay:0,easing:""};i=Ap(parseFloat(n[1]),n[2]);const o=n[3];null!=o&&(r=Ap(parseFloat(o),n[4]));const a=n[5];a&&(s=a)}else i=e;if(!n){let n=!1,s=t.length;i<0&&(t.push("Duration values below 0 are not allowed for this animation step."),n=!0),r<0&&(t.push("Delay values below 0 are not allowed for this animation step."),n=!0),n&&t.splice(s,0,`The provided timing value "${e}" is invalid.`)}return{duration:i,delay:r,easing:s}}(e,t,n)}function Dp(e,t={}){return Object.keys(e).forEach(n=>{t[n]=e[n]}),t}function Rp(e,t,n={}){if(t)for(let i in e)n[i]=e[i];else Dp(e,n);return n}function Fp(e,t,n){return n?t+":"+n+";":""}function Np(e){let t="";for(let n=0;n<e.style.length;n++){const i=e.style.item(n);t+=Fp(0,i,e.style.getPropertyValue(i))}for(const n in e.style)e.style.hasOwnProperty(n)&&!n.startsWith("_")&&(t+=Fp(0,n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),e.style[n]));e.setAttribute("style",t)}function zp(e,t,n){e.style&&(Object.keys(t).forEach(i=>{const r=Zp(i);n&&!n.hasOwnProperty(i)&&(n[i]=e.style[r]),e.style[r]=t[i]}),cp()&&Np(e))}function Lp(e,t){e.style&&(Object.keys(t).forEach(t=>{const n=Zp(t);e.style[n]=""}),cp()&&Np(e))}function Bp(e){return Array.isArray(e)?1==e.length?e[0]:tp(e):e}const jp=new RegExp("{{\\s*(.+?)\\s*}}","g");function Up(e){let t=[];if("string"==typeof e){let n;for(;n=jp.exec(e);)t.push(n[1]);jp.lastIndex=0}return t}function Hp(e,t,n){const i=e.toString(),r=i.replace(jp,(e,i)=>{let r=t[i];return t.hasOwnProperty(i)||(n.push(`Please provide a value for the animation param ${i}`),r=""),r.toString()});return r==i?e:r}function Vp(e){const t=[];let n=e.next();for(;!n.done;)t.push(n.value),n=e.next();return t}const Gp=/-+([a-z0-9])/g;function Zp(e){return e.replace(Gp,(...e)=>e[1].toUpperCase())}function Wp(e,t){return 0===e||0===t}function Yp(e,t,n){const i=Object.keys(n);if(i.length&&t.length){let s=t[0],o=[];if(i.forEach(e=>{s.hasOwnProperty(e)||o.push(e),s[e]=n[e]}),o.length)for(var r=1;r<t.length;r++){let n=t[r];o.forEach(function(t){n[t]=$p(e,t)})}}return t}function qp(e,t,n){switch(t.type){case 7:return e.visitTrigger(t,n);case 0:return e.visitState(t,n);case 1:return e.visitTransition(t,n);case 2:return e.visitSequence(t,n);case 3:return e.visitGroup(t,n);case 4:return e.visitAnimate(t,n);case 5:return e.visitKeyframes(t,n);case 6:return e.visitStyle(t,n);case 8:return e.visitReference(t,n);case 9:return e.visitAnimateChild(t,n);case 10:return e.visitAnimateRef(t,n);case 11:return e.visitQuery(t,n);case 12:return e.visitStagger(t,n);default:throw new Error(`Unable to resolve animation metadata node #${t.type}`)}}function $p(e,t){return window.getComputedStyle(e)[t]}function Xp(e,t){const n=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(e=>function(e,t,n){if(":"==e[0]){const i=function(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,t)=>parseFloat(t)>parseFloat(e);case":decrement":return(e,t)=>parseFloat(t)<parseFloat(e);default:return t.push(`The transition alias value "${e}" is not supported`),"* => *"}}(e,n);if("function"==typeof i)return void t.push(i);e=i}const i=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return n.push(`The provided transition expression "${e}" is not supported`),t;const r=i[1],s=i[2],o=i[3];t.push(Jp(r,o)),"<"!=s[0]||"*"==r&&"*"==o||t.push(Jp(o,r))}(e,n,t)):n.push(e),n}const Kp=new Set(["true","1"]),Qp=new Set(["false","0"]);function Jp(e,t){const n=Kp.has(e)||Qp.has(e),i=Kp.has(t)||Qp.has(t);return(r,s)=>{let o="*"==e||e==r,a="*"==t||t==s;return!o&&n&&"boolean"==typeof r&&(o=r?Kp.has(e):Qp.has(e)),!a&&i&&"boolean"==typeof s&&(a=s?Kp.has(t):Qp.has(t)),o&&a}}const ef=new RegExp("s*:selfs*,?","g");function tf(e,t,n){return new nf(e).build(t,n)}class nf{constructor(e){this._driver=e}build(e,t){const n=new rf(t);return this._resetContextStyleTimingState(n),qp(this,Bp(e),n)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}visitTrigger(e,t){let n=t.queryCount=0,i=t.depCount=0;const r=[],s=[];return"@"==e.name.charAt(0)&&t.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),e.definitions.forEach(e=>{if(this._resetContextStyleTimingState(t),0==e.type){const n=e,i=n.name;i.toString().split(/\s*,\s*/).forEach(e=>{n.name=e,r.push(this.visitState(n,t))}),n.name=i}else if(1==e.type){const r=this.visitTransition(e,t);n+=r.queryCount,i+=r.depCount,s.push(r)}else t.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:e.name,states:r,transitions:s,queryCount:n,depCount:i,options:null}}visitState(e,t){const n=this.visitStyle(e.styles,t),i=e.options&&e.options.params||null;if(n.containsDynamicStyles){const r=new Set,s=i||{};if(n.styles.forEach(e=>{if(sf(e)){const t=e;Object.keys(t).forEach(e=>{Up(t[e]).forEach(e=>{s.hasOwnProperty(e)||r.add(e)})})}}),r.size){const n=Vp(r.values());t.errors.push(`state("${e.name}", ...) must define default values for all the following style substitutions: ${n.join(", ")}`)}}return{type:0,name:e.name,style:n,options:i?{params:i}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const n=qp(this,Bp(e.animation),t);return{type:1,matchers:Xp(e.expr,t.errors),animation:n,queryCount:t.queryCount,depCount:t.depCount,options:of(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(e=>qp(this,e,t)),options:of(e.options)}}visitGroup(e,t){const n=t.currentTime;let i=0;const r=e.steps.map(e=>{t.currentTime=n;const r=qp(this,e,t);return i=Math.max(i,t.currentTime),r});return t.currentTime=i,{type:3,steps:r,options:of(e.options)}}visitAnimate(e,t){const n=function(e,t){let n=null;if(e.hasOwnProperty("duration"))n=e;else if("number"==typeof e)return af(Pp(e,t).duration,0,"");const i=e;if(i.split(/\s+/).some(e=>"{"==e.charAt(0)&&"{"==e.charAt(1))){const e=af(0,0,"");return e.dynamic=!0,e.strValue=i,e}return n=n||Pp(i,t),af(n.duration,n.delay,n.easing)}(e.timings,t.errors);let i;t.currentAnimateTimings=n;let r=e.styles?e.styles:np({});if(5==r.type)i=this.visitKeyframes(r,t);else{let r=e.styles,s=!1;if(!r){s=!0;const e={};n.easing&&(e.easing=n.easing),r=np(e)}t.currentTime+=n.duration+n.delay;const o=this.visitStyle(r,t);o.isEmptyStep=s,i=o}return t.currentAnimateTimings=null,{type:4,timings:n,style:i,options:null}}visitStyle(e,t){const n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}_makeStyleAst(e,t){const n=[];Array.isArray(e.styles)?e.styles.forEach(e=>{"string"==typeof e?"*"==e?n.push(e):t.errors.push(`The provided style string value ${e} is not allowed.`):n.push(e)}):n.push(e.styles);let i=!1,r=null;return n.forEach(e=>{if(sf(e)){const t=e,n=t.easing;if(n&&(r=n,delete t.easing),!i)for(let e in t)if(t[e].toString().indexOf("{{")>=0){i=!0;break}}}),{type:6,styles:n,easing:r,offset:e.offset,containsDynamicStyles:i,options:null}}_validateStyleAst(e,t){const n=t.currentAnimateTimings;let i=t.currentTime,r=t.currentTime;n&&r>0&&(r-=n.duration+n.delay),e.styles.forEach(e=>{"string"!=typeof e&&Object.keys(e).forEach(n=>{if(!this._driver.validateStyleProperty(n))return void t.errors.push(`The provided animation property "${n}" is not a supported CSS property for animations`);const s=t.collectedStyles[t.currentQuerySelector],o=s[n];let a=!0;o&&(r!=i&&r>=o.startTime&&i<=o.endTime&&(t.errors.push(`The CSS property "${n}" that exists between the times of "${o.startTime}ms" and "${o.endTime}ms" is also being animated in a parallel animation between the times of "${r}ms" and "${i}ms"`),a=!1),r=o.startTime),a&&(s[n]={startTime:r,endTime:i}),t.options&&function(e,t,n){const i=t.params||{},r=Up(e);r.length&&r.forEach(e=>{i.hasOwnProperty(e)||n.push(`Unable to resolve the local animation param ${e} in the given list of values`)})}(e[n],t.options,t.errors)})})}visitKeyframes(e,t){const n={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push("keyframes() must be placed inside of a call to animate()"),n;let i=0;const r=[];let s=!1,o=!1,a=0;const l=e.steps.map(e=>{const n=this._makeStyleAst(e,t);let l=null!=n.offset?n.offset:function(e){if("string"==typeof e)return null;let t=null;if(Array.isArray(e))e.forEach(e=>{if(sf(e)&&e.hasOwnProperty("offset")){const n=e;t=parseFloat(n.offset),delete n.offset}});else if(sf(e)&&e.hasOwnProperty("offset")){const n=e;t=parseFloat(n.offset),delete n.offset}return t}(n.styles),c=0;return null!=l&&(i++,c=n.offset=l),o=o||c<0||c>1,s=s||c<a,a=c,r.push(c),n});o&&t.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),s&&t.errors.push("Please ensure that all keyframe offsets are in order");const c=e.steps.length;let h=0;i>0&&i<c?t.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==i&&(h=1/(c-1));const u=c-1,d=t.currentTime,p=t.currentAnimateTimings,f=p.duration;return l.forEach((e,i)=>{const s=h>0?i==u?1:h*i:r[i],o=s*f;t.currentTime=d+p.delay+o,p.duration=o,this._validateStyleAst(e,t),e.offset=s,n.styles.push(e)}),n}visitReference(e,t){return{type:8,animation:qp(this,Bp(e.animation),t),options:of(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:of(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:of(e.options)}}visitQuery(e,t){const n=t.currentQuerySelector,i=e.options||{};t.queryCount++,t.currentQuery=e;const[r,s]=function(e){const t=!!e.split(/\s*,\s*/).find(e=>":self"==e);return t&&(e=e.replace(ef,"")),[e=e.replace(/@\*/g,".ng-trigger").replace(/@\w+/g,e=>".ng-trigger-"+e.substr(1)).replace(/:animating/g,".ng-animating"),t]}(e.selector);t.currentQuerySelector=n.length?n+" "+r:r,gp(t.collectedStyles,t.currentQuerySelector,{});const o=qp(this,Bp(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:11,selector:r,limit:i.limit||0,optional:!!i.optional,includeSelf:s,animation:o,originalSelector:e.selector,options:of(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push("stagger() can only be used inside of query()");const n="full"===e.timings?{duration:0,delay:0,easing:"full"}:Pp(e.timings,t.errors,!0);return{type:12,animation:qp(this,Bp(e.animation),t),timings:n,options:null}}}class rf{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null}}function sf(e){return!Array.isArray(e)&&"object"==typeof e}function of(e){var t;return e?(e=Dp(e)).params&&(e.params=(t=e.params)?Dp(t):null):e={},e}function af(e,t,n){return{duration:e,delay:t,easing:n}}function lf(e,t,n,i,r,s,o=null,a=!1){return{type:1,element:e,keyframes:t,preStyleProps:n,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:a}}class cf{constructor(){this._map=new Map}consume(e){let t=this._map.get(e);return t?this._map.delete(e):t=[],t}append(e,t){let n=this._map.get(e);n||this._map.set(e,n=[]),n.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const hf=new RegExp(":enter","g"),uf=new RegExp(":leave","g");function df(e,t,n,i,r,s={},o={},a,l,c=[]){return(new pf).buildKeyframes(e,t,n,i,r,s,o,a,l,c)}class pf{buildKeyframes(e,t,n,i,r,s,o,a,l,c=[]){l=l||new cf;const h=new gf(e,t,l,i,r,c,[]);h.options=a,h.currentTimeline.setStyles([s],null,h.errors,a),qp(this,n,h);const u=h.timelines.filter(e=>e.containsAnimation());if(u.length&&Object.keys(o).length){const e=u[u.length-1];e.allowOnlyTimelineStyles()||e.setStyles([o],null,h.errors,a)}return u.length?u.map(e=>e.buildKeyframes()):[lf(t,[],[],[],0,0,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const n=t.subInstructions.consume(t.element);if(n){const i=t.createSubContext(e.options),r=t.currentTimeline.currentTime,s=this._visitSubInstructions(n,i,i.options);r!=s&&t.transformIntoNewTimeline(s)}t.previousNode=e}visitAnimateRef(e,t){const n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}_visitSubInstructions(e,t,n){let i=t.currentTimeline.currentTime;const r=null!=n.duration?Mp(n.duration):null,s=null!=n.delay?Mp(n.delay):null;return 0!==r&&e.forEach(e=>{const n=t.appendInstructionToTimeline(e,r,s);i=Math.max(i,n.duration+n.delay)}),i}visitReference(e,t){t.updateOptions(e.options,!0),qp(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const n=t.subContextCount;let i=t;const r=e.options;if(r&&(r.params||r.delay)&&(i=t.createSubContext(r),i.transformIntoNewTimeline(),null!=r.delay)){6==i.previousNode.type&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=ff);const e=Mp(r.delay);i.delayNextStep(e)}e.steps.length&&(e.steps.forEach(e=>qp(this,e,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>n&&i.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const n=[];let i=t.currentTimeline.currentTime;const r=e.options&&e.options.delay?Mp(e.options.delay):0;e.steps.forEach(s=>{const o=t.createSubContext(e.options);r&&o.delayNextStep(r),qp(this,s,o),i=Math.max(i,o.currentTimeline.currentTime),n.push(o.currentTimeline)}),n.forEach(e=>t.currentTimeline.mergeTimelineCollectedStyles(e)),t.transformIntoNewTimeline(i),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const n=e.strValue;return Pp(t.params?Hp(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const n=t.currentAnimateTimings=this._visitTiming(e.timings,t),i=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),i.snapshotCurrentStyles());const r=e.style;5==r.type?this.visitKeyframes(r,t):(t.incrementTime(n.duration),this.visitStyle(r,t),i.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const n=t.currentTimeline,i=t.currentAnimateTimings;!i&&n.getCurrentStyleProperties().length&&n.forwardFrame();const r=i&&i.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(r):n.setStyles(e.styles,r,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const n=t.currentAnimateTimings,i=t.currentTimeline.duration,r=n.duration,s=t.createSubContext().currentTimeline;s.easing=n.easing,e.styles.forEach(e=>{s.forwardTime((e.offset||0)*r),s.setStyles(e.styles,e.easing,t.errors,t.options),s.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(s),t.transformIntoNewTimeline(i+r),t.previousNode=e}visitQuery(e,t){const n=t.currentTimeline.currentTime,i=e.options||{},r=i.delay?Mp(i.delay):0;r&&(6===t.previousNode.type||0==n&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=ff);let s=n;const o=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,t.errors);t.currentQueryTotal=o.length;let a=null;o.forEach((n,i)=>{t.currentQueryIndex=i;const o=t.createSubContext(e.options,n);r&&o.delayNextStep(r),n===t.element&&(a=o.currentTimeline),qp(this,e.animation,o),o.currentTimeline.applyStylesToKeyframe(),s=Math.max(s,o.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(s),a&&(t.currentTimeline.mergeTimelineCollectedStyles(a),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const n=t.parentContext,i=t.currentTimeline,r=e.timings,s=Math.abs(r.duration),o=s*(t.currentQueryTotal-1);let a=s*t.currentQueryIndex;switch(r.duration<0?"reverse":r.easing){case"reverse":a=o-a;break;case"full":a=n.currentStaggerTime}const l=t.currentTimeline;a&&l.delayNextStep(a);const c=l.currentTime;qp(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=i.currentTime-c+(i.startTime-n.currentTimeline.startTime)}}const ff={};class gf{constructor(e,t,n,i,r,s,o,a){this._driver=e,this.element=t,this.subInstructions=n,this._enterClassName=i,this._leaveClassName=r,this.errors=s,this.timelines=o,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=ff,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=a||new mf(this._driver,t,0),o.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const n=e;let i=this.options;null!=n.duration&&(i.duration=Mp(n.duration)),null!=n.delay&&(i.delay=Mp(n.delay));const r=n.params;if(r){let e=i.params;e||(e=this.options.params={}),Object.keys(r).forEach(n=>{t&&e.hasOwnProperty(n)||(e[n]=Hp(r[n],e,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const n=e.params={};Object.keys(t).forEach(e=>{n[e]=t[e]})}}return e}createSubContext(e=null,t,n){const i=t||this.element,r=new gf(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,n||0));return r.previousNode=this.previousNode,r.currentAnimateTimings=this.currentAnimateTimings,r.options=this._copyOptions(),r.updateOptions(e),r.currentQueryIndex=this.currentQueryIndex,r.currentQueryTotal=this.currentQueryTotal,r.parentContext=this,this.subContextCount++,r}transformIntoNewTimeline(e){return this.previousNode=ff,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,n){const i={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+e.delay,easing:""},r=new bf(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,i,e.stretchStartingKeyframe);return this.timelines.push(r),i}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,n,i,r,s){let o=[];if(i&&o.push(this.element),e.length>0){e=(e=e.replace(hf,"."+this._enterClassName)).replace(uf,"."+this._leaveClassName);let t=this._driver.query(this.element,e,1!=n);0!==n&&(t=n<0?t.slice(t.length+n,t.length):t.slice(0,n)),o.push(...t)}return r||0!=o.length||s.push(`\`query("${t}")\` returned zero elements. (Use \`query("${t}", { optional: true })\` if you wish to allow this.)`),o}}class mf{constructor(e,t,n,i){this._driver=e,this.element=t,this.startTime=n,this._elementTimelineStylesLookup=i,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new mf(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(e=>{this._backFill[e]=this._globalTimelineStyles[e]||"*",this._currentKeyframe[e]="*"}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,n,i){t&&(this._previousKeyframe.easing=t);const r=i&&i.params||{},s=function(e,t){const n={};let i;return e.forEach(e=>{"*"===e?(i=i||Object.keys(t),i.forEach(e=>{n[e]="*"})):Rp(e,!1,n)}),n}(e,this._globalTimelineStyles);Object.keys(s).forEach(e=>{const t=Hp(s[e],r,n);this._pendingStyles[e]=t,this._localTimelineStyles.hasOwnProperty(e)||(this._backFill[e]=this._globalTimelineStyles.hasOwnProperty(e)?this._globalTimelineStyles[e]:"*"),this._updateStyle(e,t)})}applyStylesToKeyframe(){const e=this._pendingStyles,t=Object.keys(e);0!=t.length&&(this._pendingStyles={},t.forEach(t=>{this._currentKeyframe[t]=e[t]}),Object.keys(this._localTimelineStyles).forEach(e=>{this._currentKeyframe.hasOwnProperty(e)||(this._currentKeyframe[e]=this._localTimelineStyles[e])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(e=>{const t=this._localTimelineStyles[e];this._pendingStyles[e]=t,this._updateStyle(e,t)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){Object.keys(e._styleSummary).forEach(t=>{const n=this._styleSummary[t],i=e._styleSummary[t];(!n||i.time>n.time)&&this._updateStyle(t,i.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,n=1===this._keyframes.size&&0===this.duration;let i=[];this._keyframes.forEach((r,s)=>{const o=Rp(r,!0);Object.keys(o).forEach(n=>{const i=o[n];"!"==i?e.add(n):"*"==i&&t.add(n)}),n||(o.offset=s/this.duration),i.push(o)});const r=e.size?Vp(e.values()):[],s=t.size?Vp(t.values()):[];if(n){const e=i[0],t=Dp(e);e.offset=0,t.offset=1,i=[e,t]}return lf(this.element,i,r,s,this.duration,this.startTime,this.easing,!1)}}class bf extends mf{constructor(e,t,n,i,r,s,o=!1){super(e,t,s.delay),this.element=t,this.keyframes=n,this.preStyleProps=i,this.postStyleProps=r,this._stretchStartingKeyframe=o,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:n,easing:i}=this.timings;if(this._stretchStartingKeyframe&&t){const r=[],s=n+t,o=t/s,a=Rp(e[0],!1);a.offset=0,r.push(a);const l=Rp(e[0],!1);l.offset=yf(o),r.push(l);const c=e.length-1;for(let i=1;i<=c;i++){let o=Rp(e[i],!1);o.offset=yf((t+o.offset*n)/s),r.push(o)}n=s,t=0,i="",e=r}return lf(this.element,e,this.preStyleProps,this.postStyleProps,n,t,i,!0)}}function yf(e,t=3){const n=Math.pow(10,t-1);return Math.round(e*n)/n}class vf{}class _f extends vf{normalizePropertyName(e,t){return Zp(e)}normalizeStyleValue(e,t,n,i){let r="";const s=n.toString().trim();if(wf[t]&&0!==n&&"0"!==n)if("number"==typeof n)r="px";else{const t=n.match(/^[+-]?[\d\.]+([a-z]*)$/);t&&0==t[1].length&&i.push(`Please provide a CSS unit value for ${e}:${n}`)}return s+r}}const wf=(()=>function(e){const t={};return e.forEach(e=>t[e]=!0),t}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function Cf(e,t,n,i,r,s,o,a,l,c,h,u,d){return{type:0,element:e,triggerName:t,isRemovalTransition:r,fromState:n,fromStyles:s,toState:i,toStyles:o,timelines:a,queriedElements:l,preStyleProps:c,postStyleProps:h,totalTime:u,errors:d}}const xf={};class Ef{constructor(e,t,n){this._triggerName=e,this.ast=t,this._stateStyles=n}match(e,t,n,i){return function(e,t,n,i,r){return e.some(e=>e(t,n,i,r))}(this.ast.matchers,e,t,n,i)}buildStyles(e,t,n){const i=this._stateStyles["*"],r=this._stateStyles[e],s=i?i.buildStyles(t,n):{};return r?r.buildStyles(t,n):s}build(e,t,n,i,r,s,o,a,l,c){const h=[],u=this.ast.options&&this.ast.options.params||xf,d=this.buildStyles(n,o&&o.params||xf,h),p=a&&a.params||xf,f=this.buildStyles(i,p,h),g=new Set,m=new Map,b=new Map,y="void"===i,v={params:Object.assign(Object.assign({},u),p)},_=c?[]:df(e,t,this.ast.animation,r,s,d,f,v,l,h);let w=0;if(_.forEach(e=>{w=Math.max(e.duration+e.delay,w)}),h.length)return Cf(t,this._triggerName,n,i,y,d,f,[],[],m,b,w,h);_.forEach(e=>{const n=e.element,i=gp(m,n,{});e.preStyleProps.forEach(e=>i[e]=!0);const r=gp(b,n,{});e.postStyleProps.forEach(e=>r[e]=!0),n!==t&&g.add(n)});const C=Vp(g.values());return Cf(t,this._triggerName,n,i,y,d,f,_,C,m,b,w)}}class kf{constructor(e,t){this.styles=e,this.defaultParams=t}buildStyles(e,t){const n={},i=Dp(this.defaultParams);return Object.keys(e).forEach(t=>{const n=e[t];null!=n&&(i[t]=n)}),this.styles.styles.forEach(e=>{if("string"!=typeof e){const r=e;Object.keys(r).forEach(e=>{let s=r[e];s.length>1&&(s=Hp(s,i,t)),n[e]=s})}}),n}}class Sf{constructor(e,t){this.name=e,this.ast=t,this.transitionFactories=[],this.states={},t.states.forEach(e=>{this.states[e.name]=new kf(e.style,e.options&&e.options.params||{})}),Tf(this.states,"true","1"),Tf(this.states,"false","0"),t.transitions.forEach(t=>{this.transitionFactories.push(new Ef(e,t,this.states))}),this.fallbackTransition=new Ef(e,{type:1,animation:{type:2,steps:[],options:null},matchers:[(e,t)=>!0],options:null,queryCount:0,depCount:0},this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,n,i){return this.transitionFactories.find(r=>r.match(e,t,n,i))||null}matchStyles(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}function Tf(e,t,n){e.hasOwnProperty(t)?e.hasOwnProperty(n)||(e[n]=e[t]):e.hasOwnProperty(n)&&(e[t]=e[n])}const Of=new cf;class If{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._animations={},this._playersById={},this.players=[]}register(e,t){const n=[],i=tf(this._driver,t,n);if(n.length)throw new Error(`Unable to build the animation due to the following errors: ${n.join("\n")}`);this._animations[e]=i}_buildPlayer(e,t,n){const i=e.element,r=up(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(i,r,e.duration,e.delay,e.easing,[],!0)}create(e,t,n={}){const i=[],r=this._animations[e];let s;const o=new Map;if(r?(s=df(this._driver,t,r,"ng-enter","ng-leave",{},{},n,Of,i),s.forEach(e=>{const t=gp(o,e.element,{});e.postStyleProps.forEach(e=>t[e]=null)})):(i.push("The requested animation doesn't exist or has already been destroyed"),s=[]),i.length)throw new Error(`Unable to create the animation due to the following errors: ${i.join("\n")}`);o.forEach((e,t)=>{Object.keys(e).forEach(n=>{e[n]=this._driver.computeStyle(t,n,"*")})});const a=hp(s.map(e=>{const t=o.get(e.element);return this._buildPlayer(e,{},t)}));return this._playersById[e]=a,a.onDestroy(()=>this.destroy(e)),this.players.push(a),a}destroy(e){const t=this._getPlayer(e);t.destroy(),delete this._playersById[e];const n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}_getPlayer(e){const t=this._playersById[e];if(!t)throw new Error(`Unable to find the timeline player referenced by ${e}`);return t}listen(e,t,n,i){const r=fp(t,"","","");return dp(this._getPlayer(e),n,r,i),()=>{}}command(e,t,n,i){if("register"==n)return void this.register(e,i[0]);if("create"==n)return void this.create(e,t,i[0]||{});const r=this._getPlayer(e);switch(n){case"play":r.play();break;case"pause":r.pause();break;case"reset":r.reset();break;case"restart":r.restart();break;case"finish":r.finish();break;case"init":r.init();break;case"setPosition":r.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(e)}}}const Mf=[],Af={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Pf={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0};class Df{constructor(e,t=""){this.namespaceId=t;const n=e&&e.hasOwnProperty("value");if(this.value=null!=(i=n?e.value:e)?i:null,n){const t=Dp(e);delete t.value,this.options=t}else this.options={};var i;this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(e){const t=e.params;if(t){const e=this.options.params;Object.keys(t).forEach(n=>{null==e[n]&&(e[n]=t[n])})}}}const Rf=new Df("void");class Ff{constructor(e,t,n){this.id=e,this.hostElement=t,this._engine=n,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,Hf(t,this._hostClassName)}listen(e,t,n,i){if(!this._triggers.hasOwnProperty(t))throw new Error(`Unable to listen on the animation trigger event "${n}" because the animation trigger "${t}" doesn't exist!`);if(null==n||0==n.length)throw new Error(`Unable to listen on the animation trigger "${t}" because the provided event is undefined!`);if("start"!=(r=n)&&"done"!=r)throw new Error(`The provided animation trigger event "${n}" for the animation trigger "${t}" is not supported!`);var r;const s=gp(this._elementListeners,e,[]),o={name:t,phase:n,callback:i};s.push(o);const a=gp(this._engine.statesByElement,e,{});return a.hasOwnProperty(t)||(Hf(e,"ng-trigger"),Hf(e,"ng-trigger-"+t),a[t]=Rf),()=>{this._engine.afterFlush(()=>{const e=s.indexOf(o);e>=0&&s.splice(e,1),this._triggers[t]||delete a[t]})}}register(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}_getTrigger(e){const t=this._triggers[e];if(!t)throw new Error(`The provided animation trigger "${e}" has not been registered!`);return t}trigger(e,t,n,i=!0){const r=this._getTrigger(t),s=new zf(this.id,t,e);let o=this._engine.statesByElement.get(e);o||(Hf(e,"ng-trigger"),Hf(e,"ng-trigger-"+t),this._engine.statesByElement.set(e,o={}));let a=o[t];const l=new Df(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&a&&l.absorbOptions(a.options),o[t]=l,a||(a=Rf),"void"!==l.value&&a.value===l.value){if(!function(e,t){const n=Object.keys(e),i=Object.keys(t);if(n.length!=i.length)return!1;for(let r=0;r<n.length;r++){const i=n[r];if(!t.hasOwnProperty(i)||e[i]!==t[i])return!1}return!0}(a.params,l.params)){const t=[],n=r.matchStyles(a.value,a.params,t),i=r.matchStyles(l.value,l.params,t);t.length?this._engine.reportError(t):this._engine.afterFlush(()=>{Lp(e,n),zp(e,i)})}return}const c=gp(this._engine.playersByElement,e,[]);c.forEach(e=>{e.namespaceId==this.id&&e.triggerName==t&&e.queued&&e.destroy()});let h=r.matchTransition(a.value,l.value,e,l.params),u=!1;if(!h){if(!i)return;h=r.fallbackTransition,u=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:h,fromState:a,toState:l,player:s,isFallbackTransition:u}),u||(Hf(e,"ng-animate-queued"),s.onStart(()=>{Vf(e,"ng-animate-queued")})),s.onDone(()=>{let t=this.players.indexOf(s);t>=0&&this.players.splice(t,1);const n=this._engine.playersByElement.get(e);if(n){let e=n.indexOf(s);e>=0&&n.splice(e,1)}}),this.players.push(s),c.push(s),s}deregister(e){delete this._triggers[e],this._engine.statesByElement.forEach((t,n)=>{delete t[e]}),this._elementListeners.forEach((t,n)=>{this._elementListeners.set(n,t.filter(t=>t.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(e=>e.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const n=this._engine.driver.query(e,".ng-trigger",!0);n.forEach(e=>{if(e.__ng_removed)return;const n=this._engine.fetchNamespacesByElement(e);n.size?n.forEach(n=>n.triggerLeaveAnimation(e,t,!1,!0)):this.clearElementCache(e)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(e=>this.clearElementCache(e)))}triggerLeaveAnimation(e,t,n,i){const r=this._engine.statesByElement.get(e);if(r){const s=[];if(Object.keys(r).forEach(t=>{if(this._triggers[t]){const n=this.trigger(e,t,"void",i);n&&s.push(n)}}),s.length)return this._engine.markElementAsRemoved(this.id,e,!0,t),n&&hp(s).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(t&&n){const i=new Set;t.forEach(t=>{const r=t.name;if(i.has(r))return;i.add(r);const s=this._triggers[r].fallbackTransition,o=n[r]||Rf,a=new Df("void"),l=new zf(this.id,r,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:r,transition:s,fromState:o,toState:a,player:l,isFallbackTransition:!0})})}}removeNode(e,t){const n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let i=!1;if(n.totalAnimations){const t=n.players.length?n.playersByQueriedElement.get(e):[];if(t&&t.length)i=!0;else{let t=e;for(;t=t.parentNode;)if(n.statesByElement.get(t)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(e),i)n.markElementAsRemoved(this.id,e,!1,t);else{const i=e.__ng_removed;i&&i!==Af||(n.afterFlush(()=>this.clearElementCache(e)),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}insertNode(e,t){Hf(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(n=>{const i=n.player;if(i.destroyed)return;const r=n.element,s=this._elementListeners.get(r);s&&s.forEach(t=>{if(t.name==n.triggerName){const i=fp(r,n.triggerName,n.fromState.value,n.toState.value);i._data=e,dp(n.player,t.phase,i,t.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):t.push(n)}),this._queue=[],t.sort((e,t)=>{const n=e.transition.ast.depCount,i=t.transition.ast.depCount;return 0==n||0==i?n-i:this._engine.driver.containsElement(e.element,t.element)?1:-1})}destroy(e){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(t=>t.element===e)||t,t}}class Nf{constructor(e,t,n){this.bodyNode=e,this.driver=t,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(e,t)=>{}}_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(t=>{t.queued&&e.push(t)})}),e}createNamespace(e,t){const n=new Ff(e,t,this);return t.parentNode?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}_balanceNamespaceList(e,t){const n=this._namespaceList.length-1;if(n>=0){let i=!1;for(let r=n;r>=0;r--)if(this.driver.containsElement(this._namespaceList[r].hostElement,t)){this._namespaceList.splice(r+1,0,e),i=!0;break}i||this._namespaceList.splice(0,0,e)}else this._namespaceList.push(e);return this.namespacesByHostElement.set(t,e),e}register(e,t){let n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}registerTrigger(e,t,n){let i=this._namespaceLookup[e];i&&i.register(t,n)&&this.totalAnimations++}destroy(e,t){if(!e)return;const n=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(n.hostElement),delete this._namespaceLookup[e];const t=this._namespaceList.indexOf(n);t>=0&&this._namespaceList.splice(t,1)}),this.afterFlushAnimationsDone(()=>n.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,n=this.statesByElement.get(e);if(n){const e=Object.keys(n);for(let i=0;i<e.length;i++){const r=n[e[i]].namespaceId;if(r){const e=this._fetchNamespace(r);e&&t.add(e)}}}return t}trigger(e,t,n,i){if(Lf(t)){const r=this._fetchNamespace(e);if(r)return r.trigger(t,n,i),!0}return!1}insertNode(e,t,n,i){if(!Lf(t))return;const r=t.__ng_removed;if(r&&r.setForRemoval){r.setForRemoval=!1,r.setForMove=!0;const e=this.collectedLeaveElements.indexOf(t);e>=0&&this.collectedLeaveElements.splice(e,1)}if(e){const i=this._fetchNamespace(e);i&&i.insertNode(t,n)}i&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),Hf(e,"ng-animate-disabled")):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),Vf(e,"ng-animate-disabled"))}removeNode(e,t,n,i){if(Lf(t)){const r=e?this._fetchNamespace(e):null;if(r?r.removeNode(t,i):this.markElementAsRemoved(e,t,!1,i),n){const n=this.namespacesByHostElement.get(t);n&&n.id!==e&&n.removeNode(t,i)}}else this._onRemovalComplete(t,i)}markElementAsRemoved(e,t,n,i){this.collectedLeaveElements.push(t),t.__ng_removed={namespaceId:e,setForRemoval:i,hasAnimation:n,removedBeforeQueried:!1}}listen(e,t,n,i,r){return Lf(t)?this._fetchNamespace(e).listen(t,n,i,r):()=>{}}_buildInstruction(e,t,n,i,r){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,i,e.fromState.options,e.toState.options,t,r)}destroyInnerAnimations(e){let t=this.driver.query(e,".ng-trigger",!0);t.forEach(e=>this.destroyActiveAnimationsForElement(e)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,".ng-animating",!0),t.forEach(e=>this.finishActiveQueriedAnimationOnElement(e)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(e=>{e.queued?e.markedForDestroy=!0:e.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(e=>e.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return hp(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e.__ng_removed;if(t&&t.setForRemoval){if(e.__ng_removed=Af,t.namespaceId){this.destroyInnerAnimations(e);const n=this._fetchNamespace(t.namespaceId);n&&n.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}this.driver.matchesElement(e,".ng-animate-disabled")&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(e=>{this.markElementAsDisabled(e,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((e,t)=>this._balanceNamespaceList(e,t)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++)Hf(this.collectedEnterElements[n],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const n=[];try{t=this._flushAnimations(n,e)}finally{for(let e=0;e<n.length;e++)n[e]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++)this.processLeaveNode(this.collectedLeaveElements[n]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(e=>e()),this._flushFns=[],this._whenQuietFns.length){const e=this._whenQuietFns;this._whenQuietFns=[],t.length?hp(t).onDone(()=>{e.forEach(e=>e())}):e.forEach(e=>e())}}reportError(e){throw new Error(`Unable to process animations due to the following failed trigger transitions\n ${e.join("\n")}`)}_flushAnimations(e,t){const n=new cf,i=[],r=new Map,s=[],o=new Map,a=new Map,l=new Map,c=new Set;this.disabledNodes.forEach(e=>{c.add(e);const t=this.driver.query(e,".ng-animate-queued",!0);for(let n=0;n<t.length;n++)c.add(t[n])});const h=this.bodyNode,u=Array.from(this.statesByElement.keys()),d=Uf(u,this.collectedEnterElements),p=new Map;let f=0;d.forEach((e,t)=>{const n="ng-enter"+f++;p.set(t,n),e.forEach(e=>Hf(e,n))});const g=[],m=new Set,b=new Set;for(let M=0;M<this.collectedLeaveElements.length;M++){const e=this.collectedLeaveElements[M],t=e.__ng_removed;t&&t.setForRemoval&&(g.push(e),m.add(e),t.hasAnimation?this.driver.query(e,".ng-star-inserted",!0).forEach(e=>m.add(e)):b.add(e))}const y=new Map,v=Uf(u,Array.from(m));v.forEach((e,t)=>{const n="ng-leave"+f++;y.set(t,n),e.forEach(e=>Hf(e,n))}),e.push(()=>{d.forEach((e,t)=>{const n=p.get(t);e.forEach(e=>Vf(e,n))}),v.forEach((e,t)=>{const n=y.get(t);e.forEach(e=>Vf(e,n))}),g.forEach(e=>{this.processLeaveNode(e)})});const _=[],w=[];for(let M=this._namespaceList.length-1;M>=0;M--)this._namespaceList[M].drainQueuedTransitions(t).forEach(e=>{const t=e.player,r=e.element;if(_.push(t),this.collectedEnterElements.length){const e=r.__ng_removed;if(e&&e.setForMove)return void t.destroy()}const c=!h||!this.driver.containsElement(h,r),u=y.get(r),d=p.get(r),f=this._buildInstruction(e,n,d,u,c);if(f.errors&&f.errors.length)w.push(f);else{if(c)return t.onStart(()=>Lp(r,f.fromStyles)),t.onDestroy(()=>zp(r,f.toStyles)),void i.push(t);if(e.isFallbackTransition)return t.onStart(()=>Lp(r,f.fromStyles)),t.onDestroy(()=>zp(r,f.toStyles)),void i.push(t);f.timelines.forEach(e=>e.stretchStartingKeyframe=!0),n.append(r,f.timelines),s.push({instruction:f,player:t,element:r}),f.queriedElements.forEach(e=>gp(o,e,[]).push(t)),f.preStyleProps.forEach((e,t)=>{const n=Object.keys(e);if(n.length){let e=a.get(t);e||a.set(t,e=new Set),n.forEach(t=>e.add(t))}}),f.postStyleProps.forEach((e,t)=>{const n=Object.keys(e);let i=l.get(t);i||l.set(t,i=new Set),n.forEach(e=>i.add(e))})}});if(w.length){const e=[];w.forEach(t=>{e.push(`@${t.triggerName} has failed due to:\n`),t.errors.forEach(t=>e.push(`- ${t}\n`))}),_.forEach(e=>e.destroy()),this.reportError(e)}const C=new Map,x=new Map;s.forEach(e=>{const t=e.element;n.has(t)&&(x.set(t,t),this._beforeAnimationBuild(e.player.namespaceId,e.instruction,C))}),i.forEach(e=>{const t=e.element;this._getPreviousPlayers(t,!1,e.namespaceId,e.triggerName,null).forEach(e=>{gp(C,t,[]).push(e),e.destroy()})});const E=g.filter(e=>Wf(e,a,l)),k=new Map;jf(k,this.driver,b,l,"*").forEach(e=>{Wf(e,a,l)&&E.push(e)});const S=new Map;d.forEach((e,t)=>{jf(S,this.driver,new Set(e),a,"!")}),E.forEach(e=>{const t=k.get(e),n=S.get(e);k.set(e,Object.assign(Object.assign({},t),n))});const T=[],O=[],I={};s.forEach(e=>{const{element:t,player:s,instruction:o}=e;if(n.has(t)){if(c.has(t))return s.onDestroy(()=>zp(t,o.toStyles)),s.disabled=!0,s.overrideTotalTime(o.totalTime),void i.push(s);let e=I;if(x.size>1){let n=t;const i=[];for(;n=n.parentNode;){const t=x.get(n);if(t){e=t;break}i.push(n)}i.forEach(t=>x.set(t,e))}const n=this._buildAnimation(s.namespaceId,o,C,r,S,k);if(s.setRealPlayer(n),e===I)T.push(s);else{const t=this.playersByElement.get(e);t&&t.length&&(s.parentPlayer=hp(t)),i.push(s)}}else Lp(t,o.fromStyles),s.onDestroy(()=>zp(t,o.toStyles)),O.push(s),c.has(t)&&i.push(s)}),O.forEach(e=>{const t=r.get(e.element);if(t&&t.length){const n=hp(t);e.setRealPlayer(n)}}),i.forEach(e=>{e.parentPlayer?e.syncPlayerEvents(e.parentPlayer):e.destroy()});for(let M=0;M<g.length;M++){const e=g[M],t=e.__ng_removed;if(Vf(e,"ng-leave"),t&&t.hasAnimation)continue;let n=[];if(o.size){let t=o.get(e);t&&t.length&&n.push(...t);let i=this.driver.query(e,".ng-animating",!0);for(let e=0;e<i.length;e++){let t=o.get(i[e]);t&&t.length&&n.push(...t)}}const i=n.filter(e=>!e.destroyed);i.length?Gf(this,e,i):this.processLeaveNode(e)}return g.length=0,T.forEach(e=>{this.players.push(e),e.onDone(()=>{e.destroy();const t=this.players.indexOf(e);this.players.splice(t,1)}),e.play()}),T}elementContainsData(e,t){let n=!1;const i=t.__ng_removed;return i&&i.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,n,i,r){let s=[];if(t){const t=this.playersByQueriedElement.get(e);t&&(s=t)}else{const t=this.playersByElement.get(e);if(t){const e=!r||"void"==r;t.forEach(t=>{t.queued||(e||t.triggerName==i)&&s.push(t)})}}return(n||i)&&(s=s.filter(e=>!(n&&n!=e.namespaceId||i&&i!=e.triggerName))),s}_beforeAnimationBuild(e,t,n){const i=t.element,r=t.isRemovalTransition?void 0:e,s=t.isRemovalTransition?void 0:t.triggerName;for(const o of t.timelines){const e=o.element,a=e!==i,l=gp(n,e,[]);this._getPreviousPlayers(e,a,r,s,t.toState).forEach(e=>{const t=e.getRealPlayer();t.beforeDestroy&&t.beforeDestroy(),e.destroy(),l.push(e)})}Lp(i,t.fromStyles)}_buildAnimation(e,t,n,i,r,s){const o=t.triggerName,a=t.element,l=[],c=new Set,h=new Set,u=t.timelines.map(t=>{const u=t.element;c.add(u);const d=u.__ng_removed;if(d&&d.removedBeforeQueried)return new ap(t.duration,t.delay);const p=u!==a,f=function(e){const t=[];return Zf(e,t),t}((n.get(u)||Mf).map(e=>e.getRealPlayer())).filter(e=>!!e.element&&e.element===u),g=r.get(u),m=s.get(u),b=up(0,this._normalizer,0,t.keyframes,g,m),y=this._buildPlayer(t,b,f);if(t.subTimeline&&i&&h.add(u),p){const t=new zf(e,o,u);t.setRealPlayer(y),l.push(t)}return y});l.forEach(e=>{gp(this.playersByQueriedElement,e.element,[]).push(e),e.onDone(()=>function(e,t,n){let i;if(e instanceof Map){if(i=e.get(t),i){if(i.length){const e=i.indexOf(n);i.splice(e,1)}0==i.length&&e.delete(t)}}else if(i=e[t],i){if(i.length){const e=i.indexOf(n);i.splice(e,1)}0==i.length&&delete e[t]}return i}(this.playersByQueriedElement,e.element,e))}),c.forEach(e=>Hf(e,"ng-animating"));const d=hp(u);return d.onDestroy(()=>{c.forEach(e=>Vf(e,"ng-animating")),zp(a,t.toStyles)}),h.forEach(e=>{gp(i,e,[]).push(d)}),d}_buildPlayer(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new ap(e.duration,e.delay)}}class zf{constructor(e,t,n){this.namespaceId=e,this.triggerName=t,this.element=n,this._player=new ap,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(t=>{this._queuedCallbacks[t].forEach(n=>dp(e,t,void 0,n))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){gp(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function Lf(e){return e&&1===e.nodeType}function Bf(e,t){const n=e.style.display;return e.style.display=null!=t?t:"none",n}function jf(e,t,n,i,r){const s=[];n.forEach(e=>s.push(Bf(e)));const o=[];i.forEach((n,i)=>{const s={};n.forEach(e=>{const n=s[e]=t.computeStyle(i,e,r);n&&0!=n.length||(i.__ng_removed=Pf,o.push(i))}),e.set(i,s)});let a=0;return n.forEach(e=>Bf(e,s[a++])),o}function Uf(e,t){const n=new Map;if(e.forEach(e=>n.set(e,[])),0==t.length)return n;const i=new Set(t),r=new Map;function s(e){if(!e)return 1;let t=r.get(e);if(t)return t;const o=e.parentNode;return t=n.has(o)?o:i.has(o)?1:s(o),r.set(e,t),t}return t.forEach(e=>{const t=s(e);1!==t&&n.get(t).push(e)}),n}function Hf(e,t){if(e.classList)e.classList.add(t);else{let n=e.$$classes;n||(n=e.$$classes={}),n[t]=!0}}function Vf(e,t){if(e.classList)e.classList.remove(t);else{let n=e.$$classes;n&&delete n[t]}}function Gf(e,t,n){hp(n).onDone(()=>e.processLeaveNode(t))}function Zf(e,t){for(let n=0;n<e.length;n++){const i=e[n];i instanceof lp?Zf(i.players,t):t.push(i)}}function Wf(e,t,n){const i=n.get(e);if(!i)return!1;let r=t.get(e);return r?i.forEach(e=>r.add(e)):t.set(e,i),n.delete(e),!0}class Yf{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._triggerCache={},this.onRemovalComplete=(e,t)=>{},this._transitionEngine=new Nf(e,t,n),this._timelineEngine=new If(e,t,n),this._transitionEngine.onRemovalComplete=(e,t)=>this.onRemovalComplete(e,t)}registerTrigger(e,t,n,i,r){const s=e+"-"+i;let o=this._triggerCache[s];if(!o){const e=[],t=tf(this._driver,r,e);if(e.length)throw new Error(`The animation trigger "${i}" has failed to build due to the following errors:\n - ${e.join("\n - ")}`);o=function(e,t){return new Sf(e,t)}(i,t),this._triggerCache[s]=o}this._transitionEngine.registerTrigger(t,i,o)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,n,i){this._transitionEngine.insertNode(e,t,n,i)}onRemove(e,t,n,i){this._transitionEngine.removeNode(e,t,i||!1,n)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,n,i){if("@"==n.charAt(0)){const[e,r]=mp(n);this._timelineEngine.command(e,t,r,i)}else this._transitionEngine.trigger(e,t,n,i)}listen(e,t,n,i,r){if("@"==n.charAt(0)){const[e,i]=mp(n);return this._timelineEngine.listen(e,t,i,r)}return this._transitionEngine.listen(e,t,n,i,r)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}function qf(e,t){let n=null,i=null;return Array.isArray(t)&&t.length?(n=Xf(t[0]),t.length>1&&(i=Xf(t[t.length-1]))):t&&(n=Xf(t)),n||i?new $f(e,n,i):null}let $f=(()=>{class e{constructor(t,n,i){this._element=t,this._startStyles=n,this._endStyles=i,this._state=0;let r=e.initialStylesByElement.get(t);r||e.initialStylesByElement.set(t,r={}),this._initialStyles=r}start(){this._state<1&&(this._startStyles&&zp(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(zp(this._element,this._initialStyles),this._endStyles&&(zp(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(Lp(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Lp(this._element,this._endStyles),this._endStyles=null),zp(this._element,this._initialStyles),this._state=3)}}return e.initialStylesByElement=new WeakMap,e})();function Xf(e){let t=null;const n=Object.keys(e);for(let i=0;i<n.length;i++){const r=n[i];Kf(r)&&(t=t||{},t[r]=e[r])}return t}function Kf(e){return"display"===e||"position"===e}class Qf{constructor(e,t,n,i,r,s,o){this._element=e,this._name=t,this._duration=n,this._delay=i,this._easing=r,this._fillMode=s,this._onDoneFn=o,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=e=>this._handleCallback(e)}apply(){!function(e,t){const n=rg(e,"").trim();n.length&&(function(e,t){let n=0;for(let i=0;i<e.length;i++)","===e.charAt(i)&&n++}(n),t=`${n}, ${t}`),ig(e,"",t)}(this._element,`${this._duration}ms ${this._easing} ${this._delay}ms 1 normal ${this._fillMode} ${this._name}`),ng(this._element,this._eventFn,!1),this._startTime=Date.now()}pause(){Jf(this._element,this._name,"paused")}resume(){Jf(this._element,this._name,"running")}setPosition(e){const t=eg(this._element,this._name);this._position=e*this._duration,ig(this._element,"Delay",`-${this._position}ms`,t)}getPosition(){return this._position}_handleCallback(e){const t=e._ngTestManualTimestamp||Date.now(),n=1e3*parseFloat(e.elapsedTime.toFixed(3));e.animationName==this._name&&Math.max(t-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}finish(){this._finished||(this._finished=!0,this._onDoneFn(),ng(this._element,this._eventFn,!0))}destroy(){this._destroyed||(this._destroyed=!0,this.finish(),function(e,t){const n=rg(e,"").split(","),i=tg(n,t);i>=0&&(n.splice(i,1),ig(e,"",n.join(",")))}(this._element,this._name))}}function Jf(e,t,n){ig(e,"PlayState",n,eg(e,t))}function eg(e,t){const n=rg(e,"");return n.indexOf(",")>0?tg(n.split(","),t):tg([n],t)}function tg(e,t){for(let n=0;n<e.length;n++)if(e[n].indexOf(t)>=0)return n;return-1}function ng(e,t,n){n?e.removeEventListener("animationend",t):e.addEventListener("animationend",t)}function ig(e,t,n,i){const r="animation"+t;if(null!=i){const t=e.style[r];if(t.length){const e=t.split(",");e[i]=n,n=e.join(",")}}e.style[r]=n}function rg(e,t){return e.style["animation"+t]||""}class sg{constructor(e,t,n,i,r,s,o,a){this.element=e,this.keyframes=t,this.animationName=n,this._duration=i,this._delay=r,this._finalStyles=o,this._specialStyles=a,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this.currentSnapshot={},this._state=0,this.easing=s||"linear",this.totalTime=i+r,this._buildStyler()}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}destroy(){this.init(),this._state>=4||(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}_flushDoneFns(){this._onDoneFns.forEach(e=>e()),this._onDoneFns=[]}_flushStartFns(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}finish(){this.init(),this._state>=3||(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}setPosition(e){this._styler.setPosition(e)}getPosition(){return this._styler.getPosition()}hasStarted(){return this._state>=2}init(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}play(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}pause(){this.init(),this._styler.pause()}restart(){this.reset(),this.play()}reset(){this._styler.destroy(),this._buildStyler(),this._styler.apply()}_buildStyler(){this._styler=new Qf(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",()=>this.finish())}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(e=>e()),t.length=0}beforeDestroy(){this.init();const e={};if(this.hasStarted()){const t=this._state>=3;Object.keys(this._finalStyles).forEach(n=>{"offset"!=n&&(e[n]=t?this._finalStyles[n]:$p(this.element,n))})}this.currentSnapshot=e}}class og extends ap{constructor(e,t){super(),this.element=e,this._startingStyles={},this.__initialized=!1,this._styles=Tp(t)}init(){!this.__initialized&&this._startingStyles&&(this.__initialized=!0,Object.keys(this._styles).forEach(e=>{this._startingStyles[e]=this.element.style[e]}),super.init())}play(){this._startingStyles&&(this.init(),Object.keys(this._styles).forEach(e=>this.element.style.setProperty(e,this._styles[e])),super.play())}destroy(){this._startingStyles&&(Object.keys(this._startingStyles).forEach(e=>{const t=this._startingStyles[e];t?this.element.style.setProperty(e,t):this.element.style.removeProperty(e)}),this._startingStyles=null,super.destroy())}}class ag{constructor(){this._count=0,this._head=document.querySelector("head")}validateStyleProperty(e){return xp(e)}matchesElement(e,t){return Ep(e,t)}containsElement(e,t){return kp(e,t)}query(e,t,n){return Sp(e,t,n)}computeStyle(e,t,n){return window.getComputedStyle(e)[t]}buildKeyframeElement(e,t,n){n=n.map(e=>Tp(e));let i=`@keyframes ${t} {\n`,r="";n.forEach(e=>{r=" ";const t=parseFloat(e.offset);i+=`${r}${100*t}% {\n`,r+=" ",Object.keys(e).forEach(t=>{const n=e[t];switch(t){case"offset":return;case"easing":return void(n&&(i+=`${r}animation-timing-function: ${n};\n`));default:return void(i+=`${r}${t}: ${n};\n`)}}),i+=`${r}}\n`}),i+="}\n";const s=document.createElement("style");return s.textContent=i,s}animate(e,t,n,i,r,s=[],o){const a=s.filter(e=>e instanceof sg),l={};Wp(n,i)&&a.forEach(e=>{let t=e.currentSnapshot;Object.keys(t).forEach(e=>l[e]=t[e])});const c=function(e){let t={};return e&&(Array.isArray(e)?e:[e]).forEach(e=>{Object.keys(e).forEach(n=>{"offset"!=n&&"easing"!=n&&(t[n]=e[n])})}),t}(t=Yp(e,t,l));if(0==n)return new og(e,c);const h="gen_css_kf_"+this._count++,u=this.buildKeyframeElement(e,h,t);document.querySelector("head").appendChild(u);const d=qf(e,t),p=new sg(e,t,h,n,i,r,c,d);return p.onDestroy(()=>{var e;(e=u).parentNode.removeChild(e)}),p}}class lg{constructor(e,t,n,i){this.element=e,this.keyframes=t,this.options=n,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(e,t,n){return e.animate(t,n)}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(t=>{"offset"!=t&&(e[t]=this._finished?this._finalKeyframe[t]:$p(this.element,t))}),this.currentSnapshot=e}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(e=>e()),t.length=0}}class cg{constructor(){this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(hg().toString()),this._cssKeyframesDriver=new ag}validateStyleProperty(e){return xp(e)}matchesElement(e,t){return Ep(e,t)}containsElement(e,t){return kp(e,t)}query(e,t,n){return Sp(e,t,n)}computeStyle(e,t,n){return window.getComputedStyle(e)[t]}overrideWebAnimationsSupport(e){this._isNativeImpl=e}animate(e,t,n,i,r,s=[],o){if(!o&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(e,t,n,i,r,s);const a={duration:n,delay:i,fill:0==i?"both":"forwards"};r&&(a.easing=r);const l={},c=s.filter(e=>e instanceof lg);Wp(n,i)&&c.forEach(e=>{let t=e.currentSnapshot;Object.keys(t).forEach(e=>l[e]=t[e])});const h=qf(e,t=Yp(e,t=t.map(e=>Rp(e,!1)),l));return new lg(e,t,a,h)}}function hg(){return"undefined"!=typeof window&&void 0!==window.document&&Element.prototype.animate||{}}let ug=(()=>{class e extends Qd{constructor(e,t){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(t.body,{id:"0",encapsulation:Oe.None,styles:[],data:{animation:[]}})}build(e){const t=this._nextAnimationId.toString();this._nextAnimationId++;const n=Array.isArray(e)?tp(e):e;return fg(this._renderer,null,t,"register",[n]),new dg(t,this._renderer)}}return e.\u0275fac=function(t){return new(t||e)(oi(Ga),oi(oh))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();class dg extends class{}{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new pg(this._id,e,t||{},this._renderer)}}class pg{constructor(e,t,n,i){this.id=e,this.element=t,this._renderer=i,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",n)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return fg(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset")}setPosition(e){this._command("setPosition",e)}getPosition(){var e,t;return null!==(t=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==t?t:0}}function fg(e,t,n,i,r){return e.setProperty(t,`@@${n}:${i}`,r)}let gg=(()=>{class e{constructor(e,t,n){this.delegate=e,this.engine=t,this._zone=n,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),t.onRemovalComplete=(e,t)=>{t&&t.parentNode(e)&&t.removeChild(e.parentNode,e)}}createRenderer(e,t){const n=this.delegate.createRenderer(e,t);if(!(e&&t&&t.data&&t.data.animation)){let e=this._rendererCache.get(n);return e||(e=new mg("",n,this.engine),this._rendererCache.set(n,e)),e}const i=t.id,r=t.id+"-"+this._currentId;this._currentId++,this.engine.register(r,e);const s=t=>{Array.isArray(t)?t.forEach(s):this.engine.registerTrigger(i,r,e,t.name,t)};return t.data.animation.forEach(s),new bg(this,r,n,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,t,n){e>=0&&e<this._microtaskId?this._zone.run(()=>t(n)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(e=>{const[t,n]=e;t(n)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([t,n]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return e.\u0275fac=function(t){return new(t||e)(oi(Ga),oi(Yf),oi(Rc))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();class mg{constructor(e,t,n){this.namespaceId=e,this.delegate=t,this.engine=n,this.destroyNode=this.delegate.destroyNode?e=>t.destroyNode(e):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,n,i=!0){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,i)}removeChild(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,i){this.delegate.setAttribute(e,t,n,i)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,i){this.delegate.setStyle(e,t,n,i)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){"@"==t.charAt(0)&&"@.disabled"==t?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.delegate.listen(e,t,n)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class bg extends mg{constructor(e,t,n,i){super(t,n,i),this.factory=e,this.namespaceId=t}setProperty(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&"@.disabled"==t?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.substr(1),n):this.delegate.setProperty(e,t,n)}listen(e,t,n){if("@"==t.charAt(0)){const i=function(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(e);let r=t.substr(1),s="";return"@"!=r.charAt(0)&&([r,s]=function(e){const t=e.indexOf(".");return[e.substring(0,t),e.substr(t+1)]}(r)),this.engine.listen(this.namespaceId,i,r,s,e=>{this.factory.scheduleListenerCallback(e._data||-1,n,e)})}return this.delegate.listen(e,t,n)}}let yg=(()=>{class e extends Yf{constructor(e,t,n){super(e.body,t,n)}}return e.\u0275fac=function(t){return new(t||e)(oi(oh),oi(Ip),oi(vf))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();const vg=[{provide:Ip,useFactory:function(){return"function"==typeof hg()?new cg:new ag}},{provide:new Zn("AnimationModuleType"),useValue:"BrowserAnimations"},{provide:Qd,useClass:ug},{provide:vf,useFactory:function(){return new _f}},{provide:Yf,useClass:yg},{provide:Ga,useFactory:function(e,t,n){return new gg(e,t,n)},deps:[yu,Yf,Rc]}];let _g=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Xe({type:e}),e.\u0275inj=fe({providers:vg,imports:[Pu]}),e})(),wg=(()=>{class e{constructor(){this.count=0,this.animeState="active"}ngOnChanges(){this.animeState="inactive",setTimeout(()=>{this.animeState="active"})}animationShuffleDone(e){this.animeState="inactive"}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=Ze({type:e,selectors:[["badge"]],inputs:{count:"count"},features:[ht],decls:2,vars:2,consts:[[1,"badge"]],template:function(e,t){1&e&&(Io(0,"div",0),ga(1),Mo()),2&e&&(To("@bounce",t.animeState),Zr(1),ma(t.count))},styles:[".badge[_ngcontent-%COMP%]{min-width:8px;min-height:8px;font-size:8px;padding:2px 4px;border-radius:100px;text-align:center;color:#eee;background-color:#cf5252}"],data:{animation:[Jd("bounce",[ip("active",np({transform:""})),sp("* => active",[ep("600ms ease",rp([np({transform:"scale3d(0.5, 0.5, 0.5)",offset:0}),np({transform:"scale3d(2, 2, 2)",offset:.5}),np({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),np({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),np({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])])]}}),e})();function Cg(e,t,n,i){var r,s=arguments.length,o=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(o=(s<3?r(o):s>3?r(t,n,o):r(t,n))||o);return s>3&&o&&Object.defineProperty(t,n,o),o}function xg(e,t,n,i){return new(n||(n=Promise))(function(r,s){function o(e){try{l(i.next(e))}catch(t){s(t)}}function a(e){try{l(i.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,a)}l((i=i.apply(e,t||[])).next())})}var Eg;!function(e){e.resize=function(e,t,n,i){let r=e.width,s=e.height,o=r/(t=Math.round(t)),a=s/(n=Math.round(n)),l=Math.ceil(o/2),c=Math.ceil(a/2),h=e.getContext("2d"),u=h.getImageData(0,0,r,s),d=h.createImageData(t,n),p=u.data,f=d.data;for(let g=0;g<n;g++)for(let e=0;e<t;e++){let n=4*(e+g*t),i=0,s=0,h=0,u=0,d=0,m=0,b=0,y=(g+.5)*a,v=Math.floor(g*a),_=Math.ceil((g+1)*a);for(let t=v;t<_;t++){let n=Math.abs(y-(t+.5))/c,a=(e+.5)*o,f=n*n,g=Math.floor(e*o),v=Math.ceil((e+1)*o);for(let e=g;e<v;e++){let n=Math.abs(a-(e+.5))/l,o=Math.sqrt(f+n*n);if(o>=1)continue;i=2*o*o*o-3*o*o+1;let c=4*(e+t*r);b+=i*p[c+3],h+=i,p[c+3]<255&&(i=i*p[c+3]/250),u+=i*p[c],d+=i*p[c+1],m+=i*p[c+2],s+=i}}f[n]=u/s,f[n+1]=d/s,f[n+2]=m/s,f[n+3]=b/h}!0===i?(e.width=t,e.height=n):h.clearRect(0,0,r,s),h.putImageData(d,0,0)}}(Eg||(Eg={}));var kg,Sg=n("F+F2"),Tg=n("lPiR");!function(e){function t(e){let t=Sg.create(e);return Tg(t).toString()}e.readAsArrayBufferAsync=function(e){return new Promise((t,n)=>{let i=new FileReader;i.onload=e=>{t(i.result)},i.onabort=i.onerror=e=>{n(e)},i.readAsArrayBuffer(e)})},e.readAsTextAsync=function(e){return new Promise((t,n)=>{let i=new FileReader;i.onload=e=>{t(i.result)},i.onabort=i.onerror=e=>{n(e)},i.readAsText(e)})},e.calcSHA256Async=function(n){return xg(this,void 0,void 0,function*(){return n instanceof Blob?function(n){return xg(this,void 0,void 0,function*(){return t(yield e.readAsArrayBufferAsync(n))})}(n):t(n)})}}(kg||(kg={}));var Og=function(e){return e[e.NULL=0]="NULL",e[e.THUMBNAIL=1]="THUMBNAIL",e[e.COMPLETE=2]="COMPLETE",e[e.URL=1e3]="URL",e}({});let Ig=(()=>{class e{constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:"",thumbnail:{blob:null,type:"",url:""}}}get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob?this.context.blob:this.context.thumbnail.blob}get url(){return this.context.url?this.context.url:this.context.thumbnail.url}get thumbnail(){return this.context.thumbnail}get state(){return this.url||this.blob?this.url&&!this.blob?Og.URL:this.blob===this.thumbnail.blob?Og.THUMBNAIL:Og.COMPLETE:Og.NULL}get isEmpty(){return this.state<=Og.NULL}static createEmpty(t){let n=new e;return n.context.identifier=t,n}static create(t){if("string"==typeof t){let n=new e;return n.context.identifier=t,n.context.name=t,n.context.url=t,n}{let n=new e;return n.apply(t),n}}static createAsync(t){return xg(this,void 0,void 0,function*(){return t instanceof File?yield e._createAsync(t,t.name):t instanceof Blob?yield e._createAsync(t):void 0})}static _createAsync(t,n){return xg(this,void 0,void 0,function*(){let i=yield kg.readAsArrayBufferAsync(t),r=new e;r.context.identifier=yield kg.calcSHA256Async(i),r.context.name=n,r.context.blob=new Blob([i],{type:t.type}),r.context.url=window.URL.createObjectURL(r.context.blob);try{r.context.thumbnail=yield e.createThumbnailAsync(r.context)}catch(s){throw s}return null!=r.context.name&&(r.context.name=r.context.identifier),r})}destroy(){this.revokeURLs()}apply(e){!this.context.identifier&&e.identifier&&(this.context.identifier=e.identifier),!this.context.name&&e.name&&(this.context.name=e.name),!this.context.blob&&e.blob&&(this.context.blob=e.blob),!this.context.type&&e.type&&(this.context.type=e.type),!this.context.url&&e.url&&(this.state!==Og.URL&&window.URL.revokeObjectURL(this.context.url),this.context.url=e.url),!this.context.thumbnail.blob&&e.thumbnail.blob&&(this.context.thumbnail.blob=e.thumbnail.blob),!this.context.thumbnail.type&&e.thumbnail.type&&(this.context.thumbnail.type=e.thumbnail.type),!this.context.thumbnail.url&&e.thumbnail.url&&(this.state!==Og.URL&&window.URL.revokeObjectURL(this.context.thumbnail.url),this.context.thumbnail.url=e.thumbnail.url),this.createURLs()}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url,thumbnail:{blob:this.context.thumbnail.blob,type:this.context.thumbnail.type,url:this.context.thumbnail.url}}}createURLs(){this.state!==Og.URL&&(this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob)),this.context.thumbnail.blob&&""===this.context.thumbnail.url&&(this.context.thumbnail.url=window.URL.createObjectURL(this.context.thumbnail.blob)))}revokeURLs(){this.state!==Og.URL&&(window.URL.revokeObjectURL(this.context.url),window.URL.revokeObjectURL(this.context.thumbnail.url))}static createThumbnailAsync(e){return new Promise((t,n)=>{let i=document.createElement("canvas"),r=i.getContext("2d"),s=new Image;s.onload=n=>{let o=128/(s.width<s.height?s.height:s.width);o=o<1?o:1;var a=s.width*o,l=s.height*o;i.width=s.width,i.height=s.height,r.drawImage(s,0,0),Eg.resize(i,a,l,!0),i.toBlob(e=>{let n={type:e.type,blob:e,url:window.URL.createObjectURL(e)};t(n)},e.blob.type)},s.onabort=s.onerror=()=>{n()},s.src=e.url})}}return e.Empty=e.createEmpty("null"),e})(),Mg=0;const Ag=new Map,Pg=new MessageChannel;function Dg(e){if(4294967296===Mg&&(Mg=0),++Mg in Ag)throw new Error("setZeroTimeout queue overflow.");return Ag.set(Mg,e),Pg.port2.postMessage(Mg),Mg}Pg.port1.onmessage=function(e){const t=Ag.get(e.data);Ag.delete(e.data),t&&t()},Pg.port1.start(),Pg.port2.start();class Rg{}var Fg=n("zqaK");const Ng=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");const t=new Uint8Array(256);for(let a=0;a<t.length;a++)t[a]=255;for(let a=0;a<e.length;a++){const n=e.charAt(a),i=n.charCodeAt(0);if(255!==t[i])throw new TypeError(n+" is ambiguous");t[i]=a}const n=e.length,i=e.charAt(0),r=Math.log(n)/Math.log(256),s=Math.log(256)/Math.log(n);function o(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;let s=0;if(" "===e[s])return;let o=0,a=0;for(;e[s]===i;)o++,s++;const l=(e.length-s)*r+1>>>0,c=new Uint8Array(l);for(;e[s];){let i=t[e.charCodeAt(s)];if(255===i)return;let r=0;for(let e=l-1;(0!==i||r<a)&&-1!==e;e--,r++)i+=n*c[e]>>>0,c[e]=i%256>>>0,i=i/256>>>0;if(0!==i)throw new Error("Non-zero carry");a=r,s++}if(" "===e[s])return;let h=l-a;for(;h!==l&&0===c[h];)h++;const u=new Uint8Array(o+(l-h));let d=o;for(;h!==l;)u[d++]=c[h++];return u}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";let r=0,o=0,a=0;const l=t.length;for(;a!==l&&0===t[a];)a++,r++;const c=(l-a)*s+1>>>0,h=new Uint8Array(c);for(;a!==l;){let e=t[a],i=0;for(let t=c-1;(0!==e||i<o)&&-1!==t;t--,i++)e+=256*h[t]>>>0,h[t]=e%n>>>0,e=e/n>>>0;if(0!==e)throw new Error("Non-zero carry");o=i,a++}let u=c-o;for(;u!==c&&0===h[u];)u++;let d=i.repeat(r);for(;u<c;++u)d+=e.charAt(h[u]);return d},decodeUnsafe:o,decode:function(e){const t=o(e);if(t)return t;throw new Error("Non-base"+n+" character")}}}("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),zg=/^(\w{6})(\w{3})(\w*)-(\w*)/i;class Lg{constructor(e){this.peerId="",this.userId="",this.roomId="",this.roomName="",this.password="",this.digestUserId="",this.digestPassword="",this.isOpen=!1,this.parse(e)}get isRoom(){return 0<this.roomId.length}get hasPassword(){return 0<this.password.length+this.digestPassword.length}parse(e){try{this.peerId=e;let t=zg.exec(e);if(null!=t)return this.digestUserId=t[1],this.roomId=t[2],this.roomName=Fg.decompress(t[3]),void(this.digestPassword=t[4])}catch(t){console.warn(t)}this.digestUserId=e}verifyPassword(e){return Bg(this.roomId,e)===this.digestPassword}static parse(e){return new Lg(e)}static create(...e){return e.length<=1?Lg._create.apply(this,e):Lg._createRoom.apply(this,e)}static _create(e=""){let t=function(e){return null==e?"":jg(e)}(e),n=new Lg(t);return n.userId=e,n}static _createRoom(e="",t="",n="",i=""){let r=this.generateId("******"),s=Bg(t,i),o=`${r}${t}${Fg.compress(n)}-${s}`,a=new Lg(o);return a.userId=e,a.password=i,a}static generateId(e="********"){const t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";let n=e;return n=e.replace(/\*/g,e=>t[Math.floor(Math.random()*t.length)]),n}}function Bg(e,t){return null==e||null==t?"":0<t.length?jg(e+t,7):""}function jg(e,t=-1){if(null==e)return"";let n=Tg(e),i=new Uint8Array(Uint32Array.from(n.words).buffer),r=Ng.encode(i);return t<0&&(t=r.length),r.length<t&&(t=r.length),r=r.slice(0,t),r}var Ug=n("HlZf");function Hg(e){let t=e.length;for(;--t>=0;)e[t]=0}const Vg=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Gg=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Zg=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Wg=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Yg=new Array(576);Hg(Yg);const qg=new Array(60);Hg(qg);const $g=new Array(512);Hg($g);const Xg=new Array(256);Hg(Xg);const Kg=new Array(29);Hg(Kg);const Qg=new Array(30);function Jg(e,t,n,i,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=e&&e.length}let em,tm,nm;function im(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}Hg(Qg);const rm=e=>e<256?$g[e]:$g[256+(e>>>7)],sm=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},om=(e,t,n)=>{e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,sm(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},am=(e,t,n)=>{om(e,n[2*t],n[2*t+1])},lm=(e,t)=>{let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},cm=(e,t,n)=>{const i=new Array(16);let r,s,o=0;for(r=1;r<=15;r++)i[r]=o=o+n[r-1]<<1;for(s=0;s<=t;s++){let t=e[2*s+1];0!==t&&(e[2*s]=lm(i[t]++,t))}},hm=e=>{let t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0},um=e=>{e.bi_valid>8?sm(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},dm=(e,t,n,i)=>{const r=2*t,s=2*n;return e[r]<e[s]||e[r]===e[s]&&i[t]<=i[n]},pm=(e,t,n)=>{const i=e.heap[n];let r=n<<1;for(;r<=e.heap_len&&(r<e.heap_len&&dm(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!dm(t,i,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=i},fm=(e,t,n)=>{let i,r,s,o,a=0;if(0!==e.last_lit)do{i=e.pending_buf[e.d_buf+2*a]<<8|e.pending_buf[e.d_buf+2*a+1],r=e.pending_buf[e.l_buf+a],a++,0===i?am(e,r,t):(s=Xg[r],am(e,s+256+1,t),o=Vg[s],0!==o&&(r-=Kg[s],om(e,r,o)),i--,s=rm(i),am(e,s,n),o=Gg[s],0!==o&&(i-=Qg[s],om(e,i,o)))}while(a<e.last_lit);am(e,256,t)},gm=(e,t)=>{const n=t.dyn_tree,i=t.stat_desc.static_tree,r=t.stat_desc.has_stree,s=t.stat_desc.elems;let o,a,l,c=-1;for(e.heap_len=0,e.heap_max=573,o=0;o<s;o++)0!==n[2*o]?(e.heap[++e.heap_len]=c=o,e.depth[o]=0):n[2*o+1]=0;for(;e.heap_len<2;)l=e.heap[++e.heap_len]=c<2?++c:0,n[2*l]=1,e.depth[l]=0,e.opt_len--,r&&(e.static_len-=i[2*l+1]);for(t.max_code=c,o=e.heap_len>>1;o>=1;o--)pm(e,n,o);l=s;do{o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],pm(e,n,1),a=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=a,n[2*l]=n[2*o]+n[2*a],e.depth[l]=(e.depth[o]>=e.depth[a]?e.depth[o]:e.depth[a])+1,n[2*o+1]=n[2*a+1]=l,e.heap[1]=l++,pm(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const n=t.dyn_tree,i=t.max_code,r=t.stat_desc.static_tree,s=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,l=t.stat_desc.max_length;let c,h,u,d,p,f,g=0;for(d=0;d<=15;d++)e.bl_count[d]=0;for(n[2*e.heap[e.heap_max]+1]=0,c=e.heap_max+1;c<573;c++)h=e.heap[c],d=n[2*n[2*h+1]+1]+1,d>l&&(d=l,g++),n[2*h+1]=d,h>i||(e.bl_count[d]++,p=0,h>=a&&(p=o[h-a]),f=n[2*h],e.opt_len+=f*(d+p),s&&(e.static_len+=f*(r[2*h+1]+p)));if(0!==g){do{for(d=l-1;0===e.bl_count[d];)d--;e.bl_count[d]--,e.bl_count[d+1]+=2,e.bl_count[l]--,g-=2}while(g>0);for(d=l;0!==d;d--)for(h=e.bl_count[d];0!==h;)u=e.heap[--c],u>i||(n[2*u+1]!==d&&(e.opt_len+=(d-n[2*u+1])*n[2*u],n[2*u+1]=d),h--)}})(e,t),cm(n,c,e.bl_count)},mm=(e,t,n)=>{let i,r,s=-1,o=t[1],a=0,l=7,c=4;for(0===o&&(l=138,c=3),t[2*(n+1)+1]=65535,i=0;i<=n;i++)r=o,o=t[2*(i+1)+1],++a<l&&r===o||(a<c?e.bl_tree[2*r]+=a:0!==r?(r!==s&&e.bl_tree[2*r]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,s=r,0===o?(l=138,c=3):r===o?(l=6,c=3):(l=7,c=4))},bm=(e,t,n)=>{let i,r,s=-1,o=t[1],a=0,l=7,c=4;for(0===o&&(l=138,c=3),i=0;i<=n;i++)if(r=o,o=t[2*(i+1)+1],!(++a<l&&r===o)){if(a<c)do{am(e,r,e.bl_tree)}while(0!=--a);else 0!==r?(r!==s&&(am(e,r,e.bl_tree),a--),am(e,16,e.bl_tree),om(e,a-3,2)):a<=10?(am(e,17,e.bl_tree),om(e,a-3,3)):(am(e,18,e.bl_tree),om(e,a-11,7));a=0,s=r,0===o?(l=138,c=3):r===o?(l=6,c=3):(l=7,c=4)}};let ym=!1;const vm=(e,t,n,i)=>{om(e,0+(i?1:0),3),((e,t,n,i)=>{um(e),sm(e,n),sm(e,~n),e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n})(e,t,n)};var _m={_tr_init:e=>{ym||((()=>{let e,t,n,i,r;const s=new Array(16);for(n=0,i=0;i<28;i++)for(Kg[i]=n,e=0;e<1<<Vg[i];e++)Xg[n++]=i;for(Xg[n-1]=i,r=0,i=0;i<16;i++)for(Qg[i]=r,e=0;e<1<<Gg[i];e++)$g[r++]=i;for(r>>=7;i<30;i++)for(Qg[i]=r<<7,e=0;e<1<<Gg[i]-7;e++)$g[256+r++]=i;for(t=0;t<=15;t++)s[t]=0;for(e=0;e<=143;)Yg[2*e+1]=8,e++,s[8]++;for(;e<=255;)Yg[2*e+1]=9,e++,s[9]++;for(;e<=279;)Yg[2*e+1]=7,e++,s[7]++;for(;e<=287;)Yg[2*e+1]=8,e++,s[8]++;for(cm(Yg,287,s),e=0;e<30;e++)qg[2*e+1]=5,qg[2*e]=lm(e,5);em=new Jg(Yg,Vg,257,286,15),tm=new Jg(qg,Gg,0,30,15),nm=new Jg(new Array(0),Zg,0,19,7)})(),ym=!0),e.l_desc=new im(e.dyn_ltree,em),e.d_desc=new im(e.dyn_dtree,tm),e.bl_desc=new im(e.bl_tree,nm),e.bi_buf=0,e.bi_valid=0,hm(e)},_tr_stored_block:vm,_tr_flush_block:(e,t,n,i)=>{let r,s,o=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),gm(e,e.l_desc),gm(e,e.d_desc),o=(e=>{let t;for(mm(e,e.dyn_ltree,e.l_desc.max_code),mm(e,e.dyn_dtree,e.d_desc.max_code),gm(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*Wg[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),r=e.opt_len+3+7>>>3,s=e.static_len+3+7>>>3,s<=r&&(r=s)):r=s=n+5,n+4<=r&&-1!==t?vm(e,t,n,i):4===e.strategy||s===r?(om(e,2+(i?1:0),3),fm(e,Yg,qg)):(om(e,4+(i?1:0),3),((e,t,n,i)=>{let r;for(om(e,t-257,5),om(e,n-1,5),om(e,i-4,4),r=0;r<i;r++)om(e,e.bl_tree[2*Wg[r]+1],3);bm(e,e.dyn_ltree,t-1),bm(e,e.dyn_dtree,n-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),fm(e,e.dyn_ltree,e.dyn_dtree)),hm(e),i&&um(e)},_tr_tally:(e,t,n)=>(e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(Xg[n]+256+1)]++,e.dyn_dtree[2*rm(t)]++),e.last_lit===e.lit_bufsize-1),_tr_align:e=>{om(e,2,3),am(e,256,Yg),(e=>{16===e.bi_valid?(sm(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}},wm=(e,t,n,i)=>{let r=65535&e|0,s=e>>>16&65535|0,o=0;for(;0!==n;){o=n>2e3?2e3:n,n-=o;do{r=r+t[i++]|0,s=s+r|0}while(--o);r%=65521,s%=65521}return r|s<<16|0};const Cm=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})());var xm=(e,t,n,i)=>{const r=Cm,s=i+n;e^=-1;for(let o=i;o<s;o++)e=e>>>8^r[255&(e^t[o])];return-1^e},Em={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},km={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Sm,_tr_stored_block:Tm,_tr_flush_block:Om,_tr_tally:Im,_tr_align:Mm}=_m,{Z_NO_FLUSH:Am,Z_PARTIAL_FLUSH:Pm,Z_FULL_FLUSH:Dm,Z_FINISH:Rm,Z_BLOCK:Fm,Z_OK:Nm,Z_STREAM_END:zm,Z_STREAM_ERROR:Lm,Z_DATA_ERROR:Bm,Z_BUF_ERROR:jm,Z_DEFAULT_COMPRESSION:Um,Z_FILTERED:Hm,Z_HUFFMAN_ONLY:Vm,Z_RLE:Gm,Z_FIXED:Zm,Z_UNKNOWN:Wm,Z_DEFLATED:Ym}=km,qm=(e,t)=>(e.msg=Em[t],t),$m=e=>(e<<1)-(e>4?9:0),Xm=e=>{let t=e.length;for(;--t>=0;)e[t]=0};let Km=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask;const Qm=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},Jm=(e,t)=>{Om(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Qm(e.strm)},eb=(e,t)=>{e.pending_buf[e.pending++]=t},tb=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},nb=(e,t,n,i)=>{let r=e.avail_in;return r>i&&(r=i),0===r?0:(e.avail_in-=r,t.set(e.input.subarray(e.next_in,e.next_in+r),n),1===e.state.wrap?e.adler=wm(e.adler,t,r,n):2===e.state.wrap&&(e.adler=xm(e.adler,t,r,n)),e.next_in+=r,e.total_in+=r,r)},ib=(e,t)=>{let n,i,r=e.max_chain_length,s=e.strstart,o=e.prev_length,a=e.nice_match;const l=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,c=e.window,h=e.w_mask,u=e.prev,d=e.strstart+258;let p=c[s+o-1],f=c[s+o];e.prev_length>=e.good_match&&(r>>=2),a>e.lookahead&&(a=e.lookahead);do{if(n=t,c[n+o]===f&&c[n+o-1]===p&&c[n]===c[s]&&c[++n]===c[s+1]){s+=2,n++;do{}while(c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&s<d);if(i=258-(d-s),s=d-258,i>o){if(e.match_start=t,o=i,i>=a)break;p=c[s+o-1],f=c[s+o]}}}while((t=u[t&h])>l&&0!=--r);return o<=e.lookahead?o:e.lookahead},rb=e=>{const t=e.w_size;let n,i,r,s,o;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-262)){e.window.set(e.window.subarray(t,t+t),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,i=e.hash_size,n=i;do{r=e.head[--n],e.head[n]=r>=t?r-t:0}while(--i);i=t,n=i;do{r=e.prev[--n],e.prev[n]=r>=t?r-t:0}while(--i);s+=t}if(0===e.strm.avail_in)break;if(i=nb(e.strm,e.window,e.strstart+e.lookahead,s),e.lookahead+=i,e.lookahead+e.insert>=3)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=Km(e,e.ins_h,e.window[o+1]);e.insert&&(e.ins_h=Km(e,e.ins_h,e.window[o+3-1]),e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&0!==e.strm.avail_in)},sb=(e,t)=>{let n,i;for(;;){if(e.lookahead<262){if(rb(e),e.lookahead<262&&t===Am)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=Km(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-262&&(e.match_length=ib(e,n)),e.match_length>=3)if(i=Im(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=Km(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Km(e,e.ins_h,e.window[e.strstart+1]);else i=Im(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(Jm(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===Rm?(Jm(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(Jm(e,!1),0===e.strm.avail_out)?1:2},ob=(e,t)=>{let n,i,r;for(;;){if(e.lookahead<262){if(rb(e),e.lookahead<262&&t===Am)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=Km(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-262&&(e.match_length=ib(e,n),e.match_length<=5&&(e.strategy===Hm||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-3,i=Im(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=r&&(e.ins_h=Km(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(Jm(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(i=Im(e,0,e.window[e.strstart-1]),i&&Jm(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=Im(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===Rm?(Jm(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(Jm(e,!1),0===e.strm.avail_out)?1:2};function ab(e,t,n,i,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=r}const lb=[new ab(0,0,0,0,(e,t)=>{let n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(rb(e),0===e.lookahead&&t===Am)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;const i=e.block_start+n;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,Jm(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-262&&(Jm(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Rm?(Jm(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&Jm(e,!1),1)}),new ab(4,4,8,4,sb),new ab(4,5,16,8,sb),new ab(4,6,32,32,sb),new ab(4,4,16,16,ob),new ab(8,16,32,32,ob),new ab(8,16,128,128,ob),new ab(8,32,128,256,ob),new ab(32,128,258,1024,ob),new ab(32,258,258,4096,ob)];function cb(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Ym,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Xm(this.dyn_ltree),Xm(this.dyn_dtree),Xm(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Xm(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Xm(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const hb=e=>{const t=(e=>{if(!e||!e.state)return qm(e,Lm);e.total_in=e.total_out=0,e.data_type=Wm;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:113,e.adler=2===t.wrap?0:1,t.last_flush=Am,Sm(t),Nm})(e);var n;return t===Nm&&((n=e.state).window_size=2*n.w_size,Xm(n.head),n.max_lazy_match=lb[n.level].max_lazy,n.good_match=lb[n.level].good_length,n.nice_match=lb[n.level].nice_length,n.max_chain_length=lb[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),t};var ub=(e,t,n,i,r,s)=>{if(!e)return Lm;let o=1;if(t===Um&&(t=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),r<1||r>9||n!==Ym||i<8||i>15||t<0||t>9||s<0||s>Zm)return qm(e,Lm);8===i&&(i=9);const a=new cb;return e.state=a,a.strm=e,a.wrap=o,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=r+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<r+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=t,a.strategy=s,a.method=n,hb(e)},db=(e,t)=>{let n,i;if(!e||!e.state||t>Fm||t<0)return e?qm(e,Lm):Lm;const r=e.state;if(!e.output||!e.input&&0!==e.avail_in||666===r.status&&t!==Rm)return qm(e,0===e.avail_out?jm:Lm);r.strm=e;const s=r.last_flush;if(r.last_flush=t,42===r.status)if(2===r.wrap)e.adler=0,eb(r,31),eb(r,139),eb(r,8),r.gzhead?(eb(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),eb(r,255&r.gzhead.time),eb(r,r.gzhead.time>>8&255),eb(r,r.gzhead.time>>16&255),eb(r,r.gzhead.time>>24&255),eb(r,9===r.level?2:r.strategy>=Vm||r.level<2?4:0),eb(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(eb(r,255&r.gzhead.extra.length),eb(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=xm(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(eb(r,0),eb(r,0),eb(r,0),eb(r,0),eb(r,0),eb(r,9===r.level?2:r.strategy>=Vm||r.level<2?4:0),eb(r,3),r.status=113);else{let t=Ym+(r.w_bits-8<<4)<<8,n=-1;n=r.strategy>=Vm||r.level<2?0:r.level<6?1:6===r.level?2:3,t|=n<<6,0!==r.strstart&&(t|=32),t+=31-t%31,r.status=113,tb(r,t),0!==r.strstart&&(tb(r,e.adler>>>16),tb(r,65535&e.adler)),e.adler=1}if(69===r.status)if(r.gzhead.extra){for(n=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>n&&(e.adler=xm(e.adler,r.pending_buf,r.pending-n,n)),Qm(e),n=r.pending,r.pending!==r.pending_buf_size));)eb(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>n&&(e.adler=xm(e.adler,r.pending_buf,r.pending-n,n)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){n=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>n&&(e.adler=xm(e.adler,r.pending_buf,r.pending-n,n)),Qm(e),n=r.pending,r.pending===r.pending_buf_size)){i=1;break}i=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,eb(r,i)}while(0!==i);r.gzhead.hcrc&&r.pending>n&&(e.adler=xm(e.adler,r.pending_buf,r.pending-n,n)),0===i&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){n=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>n&&(e.adler=xm(e.adler,r.pending_buf,r.pending-n,n)),Qm(e),n=r.pending,r.pending===r.pending_buf_size)){i=1;break}i=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,eb(r,i)}while(0!==i);r.gzhead.hcrc&&r.pending>n&&(e.adler=xm(e.adler,r.pending_buf,r.pending-n,n)),0===i&&(r.status=103)}else r.status=103;if(103===r.status&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&Qm(e),r.pending+2<=r.pending_buf_size&&(eb(r,255&e.adler),eb(r,e.adler>>8&255),e.adler=0,r.status=113)):r.status=113),0!==r.pending){if(Qm(e),0===e.avail_out)return r.last_flush=-1,Nm}else if(0===e.avail_in&&$m(t)<=$m(s)&&t!==Rm)return qm(e,jm);if(666===r.status&&0!==e.avail_in)return qm(e,jm);if(0!==e.avail_in||0!==r.lookahead||t!==Am&&666!==r.status){let n=r.strategy===Vm?((e,t)=>{let n;for(;;){if(0===e.lookahead&&(rb(e),0===e.lookahead)){if(t===Am)return 1;break}if(e.match_length=0,n=Im(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(Jm(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Rm?(Jm(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(Jm(e,!1),0===e.strm.avail_out)?1:2})(r,t):r.strategy===Gm?((e,t)=>{let n,i,r,s;const o=e.window;for(;;){if(e.lookahead<=258){if(rb(e),e.lookahead<=258&&t===Am)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(r=e.strstart-1,i=o[r],i===o[++r]&&i===o[++r]&&i===o[++r])){s=e.strstart+258;do{}while(i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&r<s);e.match_length=258-(s-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=Im(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=Im(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(Jm(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Rm?(Jm(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(Jm(e,!1),0===e.strm.avail_out)?1:2})(r,t):lb[r.level].func(r,t);if(3!==n&&4!==n||(r.status=666),1===n||3===n)return 0===e.avail_out&&(r.last_flush=-1),Nm;if(2===n&&(t===Pm?Mm(r):t!==Fm&&(Tm(r,0,0,!1),t===Dm&&(Xm(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),Qm(e),0===e.avail_out))return r.last_flush=-1,Nm}return t!==Rm?Nm:r.wrap<=0?zm:(2===r.wrap?(eb(r,255&e.adler),eb(r,e.adler>>8&255),eb(r,e.adler>>16&255),eb(r,e.adler>>24&255),eb(r,255&e.total_in),eb(r,e.total_in>>8&255),eb(r,e.total_in>>16&255),eb(r,e.total_in>>24&255)):(tb(r,e.adler>>>16),tb(r,65535&e.adler)),Qm(e),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?Nm:zm)},pb=e=>{if(!e||!e.state)return Lm;const t=e.state.status;return 42!==t&&69!==t&&73!==t&&91!==t&&103!==t&&113!==t&&666!==t?qm(e,Lm):(e.state=null,113===t?qm(e,Bm):Nm)};const fb=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var gb=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const t in n)fb(n,t)&&(e[t]=n[t])}}return e},mb=e=>{let t=0;for(let i=0,r=e.length;i<r;i++)t+=e[i].length;const n=new Uint8Array(t);for(let i=0,r=0,s=e.length;i<s;i++){let t=e[i];n.set(t,r),r+=t.length}return n};let bb=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(pR){bb=!1}const yb=new Uint8Array(256);for(let fR=0;fR<256;fR++)yb[fR]=fR>=252?6:fR>=248?5:fR>=240?4:fR>=224?3:fR>=192?2:1;yb[254]=yb[254]=1;var vb=e=>{let t,n,i,r,s,o=e.length,a=0;for(r=0;r<o;r++)n=e.charCodeAt(r),55296==(64512&n)&&r+1<o&&(i=e.charCodeAt(r+1),56320==(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),r++)),a+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(a),s=0,r=0;s<a;r++)n=e.charCodeAt(r),55296==(64512&n)&&r+1<o&&(i=e.charCodeAt(r+1),56320==(64512&i)&&(n=65536+(n-55296<<10)+(i-56320),r++)),n<128?t[s++]=n:n<2048?(t[s++]=192|n>>>6,t[s++]=128|63&n):n<65536?(t[s++]=224|n>>>12,t[s++]=128|n>>>6&63,t[s++]=128|63&n):(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63,t[s++]=128|n>>>6&63,t[s++]=128|63&n);return t},_b=(e,t)=>{let n,i;const r=t||e.length,s=new Array(2*r);for(i=0,n=0;n<r;){let t=e[n++];if(t<128){s[i++]=t;continue}let o=yb[t];if(o>4)s[i++]=65533,n+=o-1;else{for(t&=2===o?31:3===o?15:7;o>1&&n<r;)t=t<<6|63&e[n++],o--;o>1?s[i++]=65533:t<65536?s[i++]=t:(t-=65536,s[i++]=55296|t>>10&1023,s[i++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&bb)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let i=0;i<t;i++)n+=String.fromCharCode(e[i]);return n})(s,i)},wb=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+yb[e[n]]>t?n:t},Cb=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const xb=Object.prototype.toString,{Z_NO_FLUSH:Eb,Z_SYNC_FLUSH:kb,Z_FULL_FLUSH:Sb,Z_FINISH:Tb,Z_OK:Ob,Z_STREAM_END:Ib,Z_DEFAULT_COMPRESSION:Mb,Z_DEFAULT_STRATEGY:Ab,Z_DEFLATED:Pb}=km;function Db(e){this.options=gb({level:Mb,method:Pb,chunkSize:16384,windowBits:15,memLevel:8,strategy:Ab},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Cb,this.strm.avail_out=0;let n=ub(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==Ob)throw new Error(Em[n]);if(t.header&&(r=t.header,(i=this.strm)&&i.state&&(2!==i.state.wrap||(i.state.gzhead=r))),t.dictionary){let e;if(e="string"==typeof t.dictionary?vb(t.dictionary):"[object ArrayBuffer]"===xb.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=((e,t)=>{let n=t.length;if(!e||!e.state)return Lm;const i=e.state,r=i.wrap;if(2===r||1===r&&42!==i.status||i.lookahead)return Lm;if(1===r&&(e.adler=wm(e.adler,t,n,0)),i.wrap=0,n>=i.w_size){0===r&&(Xm(i.head),i.strstart=0,i.block_start=0,i.insert=0);let e=new Uint8Array(i.w_size);e.set(t.subarray(n-i.w_size,n),0),t=e,n=i.w_size}const s=e.avail_in,o=e.next_in,a=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,rb(i);i.lookahead>=3;){let e=i.strstart,t=i.lookahead-2;do{i.ins_h=Km(i,i.ins_h,i.window[e+3-1]),i.prev[e&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=e,e++}while(--t);i.strstart=e,i.lookahead=2,rb(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,e.next_in=o,e.input=a,e.avail_in=s,i.wrap=r,Nm})(this.strm,e),n!==Ob)throw new Error(Em[n]);this._dict_set=!0}var i,r}function Rb(e,t){const n=new Db(t);if(n.push(e,!0),n.err)throw n.msg||Em[n.err];return n.result}Db.prototype.push=function(e,t){const n=this.strm,i=this.options.chunkSize;let r,s;if(this.ended)return!1;for(s=t===~~t?t:!0===t?Tb:Eb,n.input="string"==typeof e?vb(e):"[object ArrayBuffer]"===xb.call(e)?new Uint8Array(e):e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),(s===kb||s===Sb)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(r=db(n,s),r===Ib)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),r=pb(this.strm),this.onEnd(r),this.ended=!0,r===Ob;if(0!==n.avail_out){if(s>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},Db.prototype.onData=function(e){this.chunks.push(e)},Db.prototype.onEnd=function(e){e===Ob&&(this.result=mb(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Fb={Deflate:Db,deflate:Rb,deflateRaw:function(e,t){return(t=t||{}).raw=!0,Rb(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,Rb(e,t)},constants:km},Nb=function(e,t){let n,i,r,s,o,a,l,c,h,u,d,p,f,g,m,b,y,v,_,w,C,x,E,k;const S=e.state;n=e.next_in,E=e.input,i=n+(e.avail_in-5),r=e.next_out,k=e.output,s=r-(t-e.avail_out),o=r+(e.avail_out-257),a=S.dmax,l=S.wsize,c=S.whave,h=S.wnext,u=S.window,d=S.hold,p=S.bits,f=S.lencode,g=S.distcode,m=(1<<S.lenbits)-1,b=(1<<S.distbits)-1;e:do{p<15&&(d+=E[n++]<<p,p+=8,d+=E[n++]<<p,p+=8),y=f[d&m];t:for(;;){if(v=y>>>24,d>>>=v,p-=v,v=y>>>16&255,0===v)k[r++]=65535&y;else{if(!(16&v)){if(0==(64&v)){y=f[(65535&y)+(d&(1<<v)-1)];continue t}if(32&v){S.mode=12;break e}e.msg="invalid literal/length code",S.mode=30;break e}_=65535&y,v&=15,v&&(p<v&&(d+=E[n++]<<p,p+=8),_+=d&(1<<v)-1,d>>>=v,p-=v),p<15&&(d+=E[n++]<<p,p+=8,d+=E[n++]<<p,p+=8),y=g[d&b];n:for(;;){if(v=y>>>24,d>>>=v,p-=v,v=y>>>16&255,!(16&v)){if(0==(64&v)){y=g[(65535&y)+(d&(1<<v)-1)];continue n}e.msg="invalid distance code",S.mode=30;break e}if(w=65535&y,v&=15,p<v&&(d+=E[n++]<<p,p+=8,p<v&&(d+=E[n++]<<p,p+=8)),w+=d&(1<<v)-1,w>a){e.msg="invalid distance too far back",S.mode=30;break e}if(d>>>=v,p-=v,v=r-s,w>v){if(v=w-v,v>c&&S.sane){e.msg="invalid distance too far back",S.mode=30;break e}if(C=0,x=u,0===h){if(C+=l-v,v<_){_-=v;do{k[r++]=u[C++]}while(--v);C=r-w,x=k}}else if(h<v){if(C+=l+h-v,v-=h,v<_){_-=v;do{k[r++]=u[C++]}while(--v);if(C=0,h<_){v=h,_-=v;do{k[r++]=u[C++]}while(--v);C=r-w,x=k}}}else if(C+=h-v,v<_){_-=v;do{k[r++]=u[C++]}while(--v);C=r-w,x=k}for(;_>2;)k[r++]=x[C++],k[r++]=x[C++],k[r++]=x[C++],_-=3;_&&(k[r++]=x[C++],_>1&&(k[r++]=x[C++]))}else{C=r-w;do{k[r++]=k[C++],k[r++]=k[C++],k[r++]=k[C++],_-=3}while(_>2);_&&(k[r++]=k[C++],_>1&&(k[r++]=k[C++]))}break}}break}}while(n<i&&r<o);_=p>>3,n-=_,p-=_<<3,d&=(1<<p)-1,e.next_in=n,e.next_out=r,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=r<o?o-r+257:257-(r-o),S.hold=d,S.bits=p};const zb=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Lb=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Bb=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),jb=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Ub=(e,t,n,i,r,s,o,a)=>{const l=a.bits;let c,h,u,d,p,f,g=0,m=0,b=0,y=0,v=0,_=0,w=0,C=0,x=0,E=0,k=null,S=0;const T=new Uint16Array(16),O=new Uint16Array(16);let I,M,A,P=null,D=0;for(g=0;g<=15;g++)T[g]=0;for(m=0;m<i;m++)T[t[n+m]]++;for(v=l,y=15;y>=1&&0===T[y];y--);if(v>y&&(v=y),0===y)return r[s++]=20971520,r[s++]=20971520,a.bits=1,0;for(b=1;b<y&&0===T[b];b++);for(v<b&&(v=b),C=1,g=1;g<=15;g++)if(C<<=1,C-=T[g],C<0)return-1;if(C>0&&(0===e||1!==y))return-1;for(O[1]=0,g=1;g<15;g++)O[g+1]=O[g]+T[g];for(m=0;m<i;m++)0!==t[n+m]&&(o[O[t[n+m]]++]=m);if(0===e?(k=P=o,f=19):1===e?(k=zb,S-=257,P=Lb,D-=257,f=256):(k=Bb,P=jb,f=-1),E=0,m=0,g=b,p=s,_=v,w=0,u=-1,x=1<<v,d=x-1,1===e&&x>852||2===e&&x>592)return 1;for(;;){I=g-w,o[m]<f?(M=0,A=o[m]):o[m]>f?(M=P[D+o[m]],A=k[S+o[m]]):(M=96,A=0),c=1<<g-w,h=1<<_,b=h;do{h-=c,r[p+(E>>w)+h]=I<<24|M<<16|A|0}while(0!==h);for(c=1<<g-1;E&c;)c>>=1;if(0!==c?(E&=c-1,E+=c):E=0,m++,0==--T[g]){if(g===y)break;g=t[n+o[m]]}if(g>v&&(E&d)!==u){for(0===w&&(w=v),p+=b,_=g-w,C=1<<_;_+w<y&&(C-=T[_+w],!(C<=0));)_++,C<<=1;if(x+=1<<_,1===e&&x>852||2===e&&x>592)return 1;u=E&d,r[u]=v<<24|_<<16|p-s|0}}return 0!==E&&(r[p+E]=g-w<<24|64<<16|0),a.bits=v,0};const{Z_FINISH:Hb,Z_BLOCK:Vb,Z_TREES:Gb,Z_OK:Zb,Z_STREAM_END:Wb,Z_NEED_DICT:Yb,Z_STREAM_ERROR:qb,Z_DATA_ERROR:$b,Z_MEM_ERROR:Xb,Z_BUF_ERROR:Kb,Z_DEFLATED:Qb}=km,Jb=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function ey(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const ty=e=>{if(!e||!e.state)return qb;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,(e=>{if(!e||!e.state)return qb;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,Zb})(e)};let ny,iy,ry=!0;const sy=e=>{if(ry){ny=new Int32Array(512),iy=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Ub(1,e.lens,0,288,ny,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Ub(2,e.lens,0,32,iy,0,e.work,{bits:5}),ry=!1}e.lencode=ny,e.lenbits=9,e.distcode=iy,e.distbits=5},oy=(e,t,n,i)=>{let r;const s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),i>=s.wsize?(s.window.set(t.subarray(n-s.wsize,n),0),s.wnext=0,s.whave=s.wsize):(r=s.wsize-s.wnext,r>i&&(r=i),s.window.set(t.subarray(n-i,n-i+r),s.wnext),(i-=r)?(s.window.set(t.subarray(n-i,n),0),s.wnext=i,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0};var ay=ty,ly=(e,t)=>{if(!e)return qb;const n=new ey;e.state=n,n.window=null;const i=((e,t)=>{let n;if(!e||!e.state)return qb;const i=e.state;return t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?qb:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,ty(e))})(e,t);return i!==Zb&&(e.state=null),i},cy=(e,t)=>{let n,i,r,s,o,a,l,c,h,u,d,p,f,g,m,b,y,v,_,w,C,x,E=0;const k=new Uint8Array(4);let S,T;const O=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return qb;n=e.state,12===n.mode&&(n.mode=13),o=e.next_out,r=e.output,l=e.avail_out,s=e.next_in,i=e.input,a=e.avail_in,c=n.hold,h=n.bits,u=a,d=l,x=Zb;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;h<16;){if(0===a)break e;a--,c+=i[s++]<<h,h+=8}if(2&n.wrap&&35615===c){n.check=0,k[0]=255&c,k[1]=c>>>8&255,n.check=xm(n.check,k,2,0),c=0,h=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",n.mode=30;break}if((15&c)!==Qb){e.msg="unknown compression method",n.mode=30;break}if(c>>>=4,h-=4,C=8+(15&c),0===n.wbits)n.wbits=C;else if(C>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<n.wbits,e.adler=n.check=1,n.mode=512&c?10:12,c=0,h=0;break;case 2:for(;h<16;){if(0===a)break e;a--,c+=i[s++]<<h,h+=8}if(n.flags=c,(255&n.flags)!==Qb){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=c>>8&1),512&n.flags&&(k[0]=255&c,k[1]=c>>>8&255,n.check=xm(n.check,k,2,0)),c=0,h=0,n.mode=3;case 3:for(;h<32;){if(0===a)break e;a--,c+=i[s++]<<h,h+=8}n.head&&(n.head.time=c),512&n.flags&&(k[0]=255&c,k[1]=c>>>8&255,k[2]=c>>>16&255,k[3]=c>>>24&255,n.check=xm(n.check,k,4,0)),c=0,h=0,n.mode=4;case 4:for(;h<16;){if(0===a)break e;a--,c+=i[s++]<<h,h+=8}n.head&&(n.head.xflags=255&c,n.head.os=c>>8),512&n.flags&&(k[0]=255&c,k[1]=c>>>8&255,n.check=xm(n.check,k,2,0)),c=0,h=0,n.mode=5;case 5:if(1024&n.flags){for(;h<16;){if(0===a)break e;a--,c+=i[s++]<<h,h+=8}n.length=c,n.head&&(n.head.extra_len=c),512&n.flags&&(k[0]=255&c,k[1]=c>>>8&255,n.check=xm(n.check,k,2,0)),c=0,h=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(p=n.length,p>a&&(p=a),p&&(n.head&&(C=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(i.subarray(s,s+p),C)),512&n.flags&&(n.check=xm(n.check,i,p,s)),a-=p,s+=p,n.length-=p),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===a)break e;p=0;do{C=i[s+p++],n.head&&C&&n.length<65536&&(n.head.name+=String.fromCharCode(C))}while(C&&p<a);if(512&n.flags&&(n.check=xm(n.check,i,p,s)),a-=p,s+=p,C)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===a)break e;p=0;do{C=i[s+p++],n.head&&C&&n.length<65536&&(n.head.comment+=String.fromCharCode(C))}while(C&&p<a);if(512&n.flags&&(n.check=xm(n.check,i,p,s)),a-=p,s+=p,C)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;h<16;){if(0===a)break e;a--,c+=i[s++]<<h,h+=8}if(c!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}c=0,h=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;h<32;){if(0===a)break e;a--,c+=i[s++]<<h,h+=8}e.adler=n.check=Jb(c),c=0,h=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=o,e.avail_out=l,e.next_in=s,e.avail_in=a,n.hold=c,n.bits=h,Yb;e.adler=n.check=1,n.mode=12;case 12:if(t===Vb||t===Gb)break e;case 13:if(n.last){c>>>=7&h,h-=7&h,n.mode=27;break}for(;h<3;){if(0===a)break e;a--,c+=i[s++]<<h,h+=8}switch(n.last=1&c,c>>>=1,h-=1,3&c){case 0:n.mode=14;break;case 1:if(sy(n),n.mode=20,t===Gb){c>>>=2,h-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}c>>>=2,h-=2;break;case 14:for(c>>>=7&h,h-=7&h;h<32;){if(0===a)break e;a--,c+=i[s++]<<h,h+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&c,c=0,h=0,n.mode=15,t===Gb)break e;case 15:n.mode=16;case 16:if(p=n.length,p){if(p>a&&(p=a),p>l&&(p=l),0===p)break e;r.set(i.subarray(s,s+p),o),a-=p,s+=p,l-=p,o+=p,n.length-=p;break}n.mode=12;break;case 17:for(;h<14;){if(0===a)break e;a--,c+=i[s++]<<h,h+=8}if(n.nlen=257+(31&c),c>>>=5,h-=5,n.ndist=1+(31&c),c>>>=5,h-=5,n.ncode=4+(15&c),c>>>=4,h-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;h<3;){if(0===a)break e;a--,c+=i[s++]<<h,h+=8}n.lens[O[n.have++]]=7&c,c>>>=3,h-=3}for(;n.have<19;)n.lens[O[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,S={bits:n.lenbits},x=Ub(0,n.lens,0,19,n.lencode,0,n.work,S),n.lenbits=S.bits,x){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;E=n.lencode[c&(1<<n.lenbits)-1],m=E>>>24,b=E>>>16&255,y=65535&E,!(m<=h);){if(0===a)break e;a--,c+=i[s++]<<h,h+=8}if(y<16)c>>>=m,h-=m,n.lens[n.have++]=y;else{if(16===y){for(T=m+2;h<T;){if(0===a)break e;a--,c+=i[s++]<<h,h+=8}if(c>>>=m,h-=m,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}C=n.lens[n.have-1],p=3+(3&c),c>>>=2,h-=2}else if(17===y){for(T=m+3;h<T;){if(0===a)break e;a--,c+=i[s++]<<h,h+=8}c>>>=m,h-=m,C=0,p=3+(7&c),c>>>=3,h-=3}else{for(T=m+7;h<T;){if(0===a)break e;a--,c+=i[s++]<<h,h+=8}c>>>=m,h-=m,C=0,p=11+(127&c),c>>>=7,h-=7}if(n.have+p>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;p--;)n.lens[n.have++]=C}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,S={bits:n.lenbits},x=Ub(1,n.lens,0,n.nlen,n.lencode,0,n.work,S),n.lenbits=S.bits,x){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,S={bits:n.distbits},x=Ub(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,S),n.distbits=S.bits,x){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,t===Gb)break e;case 20:n.mode=21;case 21:if(a>=6&&l>=258){e.next_out=o,e.avail_out=l,e.next_in=s,e.avail_in=a,n.hold=c,n.bits=h,Nb(e,d),o=e.next_out,r=e.output,l=e.avail_out,s=e.next_in,i=e.input,a=e.avail_in,c=n.hold,h=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;E=n.lencode[c&(1<<n.lenbits)-1],m=E>>>24,b=E>>>16&255,y=65535&E,!(m<=h);){if(0===a)break e;a--,c+=i[s++]<<h,h+=8}if(b&&0==(240&b)){for(v=m,_=b,w=y;E=n.lencode[w+((c&(1<<v+_)-1)>>v)],m=E>>>24,b=E>>>16&255,y=65535&E,!(v+m<=h);){if(0===a)break e;a--,c+=i[s++]<<h,h+=8}c>>>=v,h-=v,n.back+=v}if(c>>>=m,h-=m,n.back+=m,n.length=y,0===b){n.mode=26;break}if(32&b){n.back=-1,n.mode=12;break}if(64&b){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&b,n.mode=22;case 22:if(n.extra){for(T=n.extra;h<T;){if(0===a)break e;a--,c+=i[s++]<<h,h+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,h-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;E=n.distcode[c&(1<<n.distbits)-1],m=E>>>24,b=E>>>16&255,y=65535&E,!(m<=h);){if(0===a)break e;a--,c+=i[s++]<<h,h+=8}if(0==(240&b)){for(v=m,_=b,w=y;E=n.distcode[w+((c&(1<<v+_)-1)>>v)],m=E>>>24,b=E>>>16&255,y=65535&E,!(v+m<=h);){if(0===a)break e;a--,c+=i[s++]<<h,h+=8}c>>>=v,h-=v,n.back+=v}if(c>>>=m,h-=m,n.back+=m,64&b){e.msg="invalid distance code",n.mode=30;break}n.offset=y,n.extra=15&b,n.mode=24;case 24:if(n.extra){for(T=n.extra;h<T;){if(0===a)break e;a--,c+=i[s++]<<h,h+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,h-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===l)break e;if(p=d-l,n.offset>p){if(p=n.offset-p,p>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}p>n.wnext?(p-=n.wnext,f=n.wsize-p):f=n.wnext-p,p>n.length&&(p=n.length),g=n.window}else g=r,f=o-n.offset,p=n.length;p>l&&(p=l),l-=p,n.length-=p;do{r[o++]=g[f++]}while(--p);0===n.length&&(n.mode=21);break;case 26:if(0===l)break e;r[o++]=n.length,l--,n.mode=21;break;case 27:if(n.wrap){for(;h<32;){if(0===a)break e;a--,c|=i[s++]<<h,h+=8}if(d-=l,e.total_out+=d,n.total+=d,d&&(e.adler=n.check=n.flags?xm(n.check,r,d,o-d):wm(n.check,r,d,o-d)),d=l,(n.flags?c:Jb(c))!==n.check){e.msg="incorrect data check",n.mode=30;break}c=0,h=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;h<32;){if(0===a)break e;a--,c+=i[s++]<<h,h+=8}if(c!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}c=0,h=0}n.mode=29;case 29:x=Wb;break e;case 30:x=$b;break e;case 31:return Xb;case 32:default:return qb}return e.next_out=o,e.avail_out=l,e.next_in=s,e.avail_in=a,n.hold=c,n.bits=h,(n.wsize||d!==e.avail_out&&n.mode<30&&(n.mode<27||t!==Hb))&&oy(e,e.output,e.next_out,d-e.avail_out),u-=e.avail_in,d-=e.avail_out,e.total_in+=u,e.total_out+=d,n.total+=d,n.wrap&&d&&(e.adler=n.check=n.flags?xm(n.check,r,d,e.next_out-d):wm(n.check,r,d,e.next_out-d)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0===u&&0===d||t===Hb)&&x===Zb&&(x=Kb),x},hy=e=>{if(!e||!e.state)return qb;let t=e.state;return t.window&&(t.window=null),e.state=null,Zb},uy=(e,t)=>{const n=t.length;let i,r,s;return e&&e.state?(i=e.state,0!==i.wrap&&11!==i.mode?qb:11===i.mode&&(r=1,r=wm(r,t,n,0),r!==i.check)?$b:(s=oy(e,t,n,n),s?(i.mode=31,Xb):(i.havedict=1,Zb))):qb},dy=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const py=Object.prototype.toString,{Z_NO_FLUSH:fy,Z_FINISH:gy,Z_OK:my,Z_STREAM_END:by,Z_NEED_DICT:yy,Z_STREAM_ERROR:vy,Z_DATA_ERROR:_y,Z_MEM_ERROR:wy}=km;function Cy(e){this.options=gb({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Cb,this.strm.avail_out=0;let n=ly(this.strm,t.windowBits);if(n!==my)throw new Error(Em[n]);if(this.header=new dy,((e,t)=>{if(!e||!e.state)return qb;const n=e.state;0==(2&n.wrap)||(n.head=t,t.done=!1)})(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=vb(t.dictionary):"[object ArrayBuffer]"===py.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=uy(this.strm,t.dictionary),n!==my)))throw new Error(Em[n])}function xy(e,t){const n=new Cy(t);if(n.push(e),n.err)throw n.msg||Em[n.err];return n.result}Cy.prototype.push=function(e,t){const n=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let s,o,a;if(this.ended)return!1;for(o=t===~~t?t:!0===t?gy:fy,n.input="[object ArrayBuffer]"===py.call(e)?new Uint8Array(e):e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(i),n.next_out=0,n.avail_out=i),s=cy(n,o),s===yy&&r&&(s=uy(n,r),s===my?s=cy(n,o):s===_y&&(s=yy));n.avail_in>0&&s===by&&n.state.wrap>0&&0!==e[n.next_in];)ay(n),s=cy(n,o);switch(s){case vy:case _y:case yy:case wy:return this.onEnd(s),this.ended=!0,!1}if(a=n.avail_out,n.next_out&&(0===n.avail_out||s===by))if("string"===this.options.to){let e=wb(n.output,n.next_out),t=n.next_out-e,r=_b(n.output,e);n.next_out=t,n.avail_out=i-t,t&&n.output.set(n.output.subarray(e,e+t),0),this.onData(r)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(s!==my||0!==a){if(s===by)return s=hy(this.strm),this.onEnd(s),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},Cy.prototype.onData=function(e){this.chunks.push(e)},Cy.prototype.onEnd=function(e){e===my&&(this.result="string"===this.options.to?this.chunks.join(""):mb(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Ey={Inflate:Cy,inflate:xy,inflateRaw:function(e,t){return(t=t||{}).raw=!0,xy(e,t)},ungzip:xy,constants:km};const{Deflate:ky}=Fb,{Inflate:Sy}=Ey;var Ty=ky,Oy=Sy;function Iy(e,t,n=16384){return xg(this,void 0,void 0,function*(){let i=Math.ceil(t.byteLength/n),r=null;for(let s=0;s<i;s++)yield new Promise(e=>Dg(e)),r=t.slice(s*n,(s+1)*n),e.push(r,i<=s+1);if(e.err)throw new Error(`error: ${e.err}`);return e})}var My,Ay=n("+qE3");!function(e){let t=[];for(let n=0;n<256;n++)t[n]=(n<16?"0":"")+n.toString(16);e.generateUuid=function(){const e=new Uint32Array(4);window.crypto.getRandomValues(e);const n=e[0],i=e[1],r=e[2],s=e[3];return t[255&n]+t[n>>8&255]+t[n>>16&255]+t[n>>24&255]+"-"+t[255&i]+t[i>>8&255]+"-"+t[i>>16&15|64]+t[i>>24&255]+"-"+t[63&r|128]+t[r>>8&255]+"-"+t[r>>16&255]+t[r>>24&255]+t[255&s]+t[s>>8&255]+t[s>>16&255]+t[s>>24&255]}}(My||(My={}));class Py extends Ay.EventEmitter{constructor(e){super(),this.conn=e,this.chunkSize=15872,this.receivedMap=new Map,this.timeoutTimer=null,e.on("data",e=>this.onData(e)),e.on("open",()=>{this.clearTimeoutTimer(),function(e){e._dc&&e._sendBuffer&&(e._startSendLoop=Dy)}(e),this.emit("open")}),e.on("close",()=>{this.clearTimeoutTimer(),this.emit("close")}),e.on("error",e=>{this.clearTimeoutTimer(),this.emit("error",e)}),this.setTimeoutTimer()}get open(){return this.conn.open}get remoteId(){return this.conn.remoteId}get metadata(){return this.conn.metadata}close(){this.clearTimeoutTimer(),this.conn.close()}send(e){let t=Ug.encode(e),n=Math.ceil(t.byteLength/this.chunkSize);if(n<=1)return void this.conn.send(t);let i=My.generateUuid(),r=null,s=null;for(let o=0;o<n;o++)r=t.slice(o*this.chunkSize,(o+1)*this.chunkSize),s={id:i,data:r,index:o,total:n},this.conn.send(Ug.encode(s))}onData(e){let t=Ug.decode(new Uint8Array(e));if(null==t.id)return void this.emit("data",t);let n=this.receivedMap.get(t.id);if(null==n&&(n={id:t.id,chanks:new Array(t.total),length:0,byteLength:0},this.receivedMap.set(t.id,n)),null!=n.chanks[t.index])return;if(n.length++,n.byteLength+=t.data.byteLength,n.chanks[t.index]=t.data,n.length<t.total)return;this.receivedMap.delete(t.id);let i=new Uint8Array(n.byteLength),r=0;for(let o of n.chanks)i.set(o,r),r+=o.byteLength;let s=Ug.decode(i);this.emit("data",s)}setTimeoutTimer(){this.clearTimeoutTimer(),this.timeoutTimer=setTimeout(()=>{console.warn(`timeout ${this.conn.remoteId}`),this.timeoutTimer=null,this.emit("close")},15e3)}clearTimeoutTimer(){null!=this.timeoutTimer&&(clearTimeout(this.timeoutTimer),this.timeoutTimer=null)}}function Dy(){this.sendInterval||(this.sendInterval=Dg(Ry.bind(this)))}function Ry(){const e=this._sendBuffer.shift();try{this._dc.send(e)}catch(t){this._sendBuffer.push(e)}this.sendInterval=0===this._sendBuffer.length?void 0:Dg(Ry.bind(this))}class Fy{constructor(){this._peerIds=[],this.peerContexts=[],this.callback=new Rg,this.bandwidthUsage=0,this.key="",this.connections=[],this.listAllPeersCache=[],this.httpRequestInterval=performance.now()+500,this.queue=Promise.resolve(),this.relayingPeerIds=new Map,this.maybeUnavailablePeerIds=new Set}get peerId(){return this.peerContext?this.peerContext.peerId:"???"}get peerIds(){return this._peerIds}open(...e){console.log("open",e),this.peerContext=0===e.length?Lg.create(Lg.generateId()):1===e.length?Lg.create(e[0]):Lg.create(e[0],e[1],e[2],e[3]),this.openPeer()}close(){this.peer&&this.peer.destroy(),this.disconnectAll(),this.peer=null,this.peerContext=null}connect(e){if(!this.shouldConnect(e))return!1;let t=new Py(this.peer.connect(e,{serialization:"none",metadata:{sendFrom:this.peerId}}));return this.openDataConnection(t),!0}shouldConnect(e){return this.peerContext&&this.peer&&this.peerId?this.peerId===e?(console.log("connect() is Fail. "+e+" is me."),!1):this.findDataConnection(e)?(console.log("connect() is Fail. <"+e+"> is already connecting."),!1):!(!e||!e.length||e===this.peerId):(console.log("connect() is Fail. ID\u304c\u5272\u308a\u632f\u3089\u308c\u308b\u307e\u3067\u5f85\u3066\u3084"),!1)}disconnect(e){let t=this.findDataConnection(e);return!!t&&(this.closeDataConnection(t),!0)}disconnectAll(){console.log("<closeAllDataConnection()>");for(let e of this.connections.concat())this.closeDataConnection(e)}send(e,t){if(this.connections.length<1)return;let n={data:Ug.encode(e),ttl:1},i=n.data.byteLength;this.bandwidthUsage+=i,this.queue=this.queue.then(()=>new Promise((e,r)=>{Dg(()=>xg(this,void 0,void 0,function*(){if(1024<n.data.byteLength){let e=yield function(e,t){return xg(this,void 0,void 0,function*(){const t=new Ty({level:2,gzip:!0});try{return yield Iy(t,e,void 0),t.result}catch(n){console.error(n)}return null})}(n.data);e.byteLength<n.data.byteLength&&(n.data=e,n.isCompressed=!0)}return t?this.sendUnicast(n,t):this.sendBroadcast(n),this.bandwidthUsage-=i,e()}))}))}sendUnicast(e,t){e.ttl=0;let n=this.findDataConnection(t);n&&n.open&&n.send(e)}sendBroadcast(e){for(let t of this.connections)t.open&&t.send(e)}setApiKey(e){this.key!==e&&console.log("Key Change"),this.key=e}listAllPeers(){return new Promise((e,t)=>{if(!this.peer)return e([]);let n=performance.now();if(n<this.httpRequestInterval)return console.warn("httpRequestInterval... "+(this.httpRequestInterval-n)),void e(this.listAllPeersCache.concat());this.httpRequestInterval=n+6e3,this.peer.listAllPeers(t=>{this.listAllPeersCache=t.concat(),e(t)})})}openPeer(){this.peer&&(console.warn("It is already opened."),this.close());let e=new Peer(this.peerContext.peerId,{key:this.key});e.on("open",e=>{console.log("My peer ID is: "+e),this.peerContext&&this.peerContext.peerId===e||(this.peerContext=Lg.parse(e)),this.peerContext.isOpen=!0,console.log("My peer Context",this.peerContext),this.callback.onOpen&&this.callback.onOpen(this.peerId)}),e.on("connection",e=>{this.openDataConnection(new Py(e))}),e.on("error",e=>{console.error("<"+this.peerId+"> "+e.type+" => "+e.message);let t=this.getSkyWayErrorMessage(e.type);switch(t+=": "+e.message,e.type){case"peer-unavailable":case"invalid-id":case"invalid-key":case"list-error":case"server-error":break;case"disconnected":case"socket-error":default:this.peerContext&&this.peerContext.isOpen&&this.callback.onClose&&this.callback.onClose(this.peerId)}this.callback.onError&&this.callback.onError(this.peerId,t)}),this.peer=e}openDataConnection(e){if(!1===this.addDataConnection(e))return;let t=this.connections.indexOf(e),n=null;0<=t&&(n=this.peerContexts[t]),this.maybeUnavailablePeerIds.add(e.remoteId),e.on("data",t=>{this.onData(e,t)}),e.on("open",()=>{this.maybeUnavailablePeerIds.delete(e.remoteId),n&&(n.isOpen=!0),this.updatePeerList(),this.callback.onConnect&&this.callback.onConnect(e.remoteId)}),e.on("close",()=>{this.closeDataConnection(e),this.callback.onDisconnect&&this.callback.onDisconnect(e.remoteId)}),e.on("error",t=>{this.closeDataConnection(e),this.callback.onError&&this.callback.onError(e.remoteId,t)})}closeDataConnection(e){e.close();let t=this.connections.indexOf(e);0<=t&&(console.log(e.remoteId+" is \u3048\u3093\u3044\u30fcindex:"+t+" length:"+this.connections.length),this.connections.splice(t,1),this.peerContexts.splice(t,1)),this.relayingPeerIds.delete(e.remoteId),this.relayingPeerIds.forEach(t=>{let n=t.indexOf(e.remoteId);0<=n&&t.splice(n,1)}),console.log("<close()> Peer:"+e.remoteId+" length:"+this.connections.length+":"+this.peerContexts.length),this.updatePeerList()}addDataConnection(e){let t=this.findDataConnection(e.remoteId);if(null!==t){if(console.log("add() is Fail. "+e.remoteId+" is already connecting."),t!==e){if(!(t.metadata.sendFrom<e.metadata.sendFrom))return this.closeDataConnection(t),this.addDataConnection(e),!0;this.closeDataConnection(e)}return!1}return this.connections.push(e),this.peerContexts.push(Lg.parse(e.remoteId)),console.log("<add()> Peer:"+e.remoteId+" length:"+this.connections.length),!0}findDataConnection(e){for(let t of this.connections)if(t.remoteId===e)return t;return null}onData(e,t){if(t.peers&&0<t.peers.length&&this.onUpdatePeerList(e,t),0<t.ttl&&this.onRelay(e,t),this.callback.onData){let n=t.data.byteLength;this.bandwidthUsage+=n,this.queue=this.queue.then(()=>new Promise((i,r)=>{Dg(()=>xg(this,void 0,void 0,function*(){let r=t.isCompressed?yield function(e,t){return xg(this,void 0,void 0,function*(){const t=new Oy;try{return yield Iy(t,e,void 0),t.result}catch(n){console.error(n)}return null})}(t.data):t.data;return this.callback.onData(e.remoteId,Ug.decode(r)),this.bandwidthUsage-=n,i()}))}))}}onRelay(e,t){t.ttl--;let n=this.relayingPeerIds.get(e.remoteId);if(null!=n)for(let i of n){let e=this.findDataConnection(i);e&&e.open&&(console.log("<"+i+"> \u8ee2\u9001\u3057\u306a\u304d\u3083\u30fb\u30fb\u30fb"),e.send(t))}}onUpdatePeerList(e,t){let n=[],i=[],r=function(e,t){let n=[],i=[],r=!1,s=!1;for(let o of e.concat(t))r=e.includes(o),s=t.includes(o),r&&!s?n.push(o):!r&&s&&i.push(o);return{diff1:n,diff2:i}}(this._peerIds,t.peers);if(n=r.diff1,i=r.diff2,this.relayingPeerIds.set(e.remoteId,n),t.peers=t.peers.concat(n),i.length)for(let s of i)!this.maybeUnavailablePeerIds.has(s)&&this.connect(s)&&console.log("auto connect to unknown Peer <"+s+">")}updatePeerList(){let e=[];for(let t of this.connections)t.open&&e.push(t.remoteId);return e.push(this.peerId),e.sort(function(e,t){return e>t?1:e<t?-1:0}),this._peerIds=e,console.log("<update()>",e),this.notifyPeerList(),e}notifyPeerList(){if(this.connections.length<1)return;let e={data:Ug.encode([]),peers:this._peerIds,ttl:1};this.sendBroadcast(e)}getSkyWayErrorMessage(e){switch(e){case"peer-unavailable":return"\u305d\u306ePeer ID\u306f\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002";case"invalid-id":return"Peer ID\u304c\u4e0d\u6b63\u3067\u3059\u3002";case"invalid-key":return"SkyWay API\u30ad\u30fc\u304c\u7121\u52b9\u3067\u3059\u3002";case"list-error":return"SkyWay API\u30ad\u30fc\u306eREST API\u304c\u8a31\u53ef\u3055\u308c\u3066\u307e\u305b\u3093\u3002";case"server-error":return"SkyWay\u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u304b\u3089Peer\u4e00\u89a7\u3092\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002";case"disconnected":return"SkyWay\u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u306b\u63a5\u7d9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002";case"socket-error":return"SkyWay\u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u3068\u306e\u63a5\u7d9a\u304c\u5931\u308f\u308c\u307e\u3057\u305f\u3002";default:return"SkyWay\u306b\u95a2\u3059\u308b\u4e0d\u660e\u306a\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f("+e+")"}}}const Ny=Lg.parse("???");class zy{constructor(){this.callback=new Rg,this.key="",this.queue=new Set,this.sendInterval=null,this.sendCallback=()=>{this.sendQueue()},this.callbackUnload=e=>{this.close()},console.log("Network ready...")}static get instance(){return zy._instance||(zy._instance=new zy),zy._instance}get peerId(){return this.connection?this.connection.peerId:Ny.peerId}get peerIds(){return this.connection?this.connection.peerIds.concat():[]}get peerContexts(){return this.connection?this.connection.peerContexts.concat():[]}get peerContext(){return this.connection?this.connection.peerContext:Ny}get isOpen(){return!(!this.connection||!this.connection.peerContext)&&this.connection.peerContext.isOpen}get bandwidthUsage(){return this.connection?this.connection.bandwidthUsage:0}open(...e){this.connection&&this.connection.peerContext&&(console.warn("It is already opened."),this.close()),console.log("Network open...",e),this.connection=this.initializeConnection(),this.connection.open.apply(this.connection,e),window.addEventListener("unload",this.callbackUnload,!1)}close(){this.connection&&this.connection.close(),this.connection=null,window.removeEventListener("unload",this.callbackUnload,!1),console.log("Network close...")}connect(e){return!!this.connection&&this.connection.connect(e)}disconnect(e){this.connection&&this.connection.disconnect(e)&&(console.log("<disconnectPeer()> Peer:"+e),this.disconnect(e))}send(e,t){this.queue.add({data:e,sendTo:t}),null===this.sendInterval&&(this.sendInterval=Dg(this.sendCallback))}sendQueue(){let e=[],t={},n=[],i=this.queue.size<128?this.queue.size:128;for(let r of this.queue){if(i<=0)break;i--,this.queue.delete(r),null==r.sendTo?e.push(r.data):r.sendTo===this.peerId?n.push(r.data):(r.sendTo in t||(t[r.sendTo]=[]),t[r.sendTo].push(r.data))}if(this.connection){e.length&&this.connection.send(e);for(let e in t)this.connection.send(t[e],e)}this.callback.onData&&(this.callback.onData(null,e),this.callback.onData(this.peerId,n)),this.sendInterval=0<this.queue.size?Dg(this.sendCallback):null}setApiKey(e){this.key!==e&&console.log("Key Change"),this.key=e}listAllPeers(){return this.connection?this.connection.listAllPeers():Promise.resolve([])}initializeConnection(){let e=new Fy;return e.setApiKey(this.key),e.callback.onOpen=e=>{this.callback.onOpen&&this.callback.onOpen(e)},e.callback.onClose=e=>{this.callback.onClose&&this.callback.onClose(e)},e.callback.onConnect=e=>{this.callback.onConnect&&this.callback.onConnect(e)},e.callback.onDisconnect=e=>{this.callback.onDisconnect&&this.callback.onDisconnect(e)},e.callback.onData=(e,t)=>{this.callback.onData&&this.callback.onData(e,t)},e.callback.onError=(e,t)=>{this.callback.onError&&this.callback.onError(e,t)},0<this.queue.size&&null===this.sendInterval&&(this.sendInterval=Dg(this.sendCallback)),e}}class Ly{constructor(e,t,n=zy.instance.peerId){this.eventName=e,this.data=t,this.sendFrom=n,this.isSendFromSelf=!1,this.isSendFromSelf=this.sendFrom===zy.instance.peerId}toContext(){return{sendFrom:this.sendFrom,eventName:this.eventName,data:this.data}}}class By{constructor(e,t){this._priority=0,this._isRegistered=!1,this._subject=e,this._key=t}get subject(){return this._subject}get key(){return this._key}get eventName(){return this._eventName}get priority(){return this._priority}get callback(){return this._callback}get isOnlyOnce(){return this._isOnlyOnce}get isRegistered(){return this._isRegistered}on(...e){return this._isOnlyOnce=!1,2===e.length?this.register(e[0],0,e[1]):this.register(e[0],e[1],e[2])}once(...e){let t=this.on.apply(this,e);return this._isOnlyOnce=!0,t}register(e,t,n){return this.isRegistered&&this.unregister(),this._eventName=e||"*",this._priority=t,this._callback=n,this.subject.registerListener(this),this._isRegistered=!0,new By(this.subject,this.key)}unregister(){return this.subject.unregisterListener(this),this._callback=null,this._isRegistered=!1,this}trigger(e){this.callback&&this.isRegistered&&(this.callback.apply(this.key,[e,this]),this.isOnlyOnce&&this.unregister())}isEqual(e,t,n){return!(null!=e&&e!==this.key||null!=t&&t!==this.eventName||null!=n&&n!==this.callback)}}class jy{constructor(){this.listenerMap=new Map,console.log("EventSystem ready...")}static get instance(){return jy._instance||(jy._instance=new jy,jy._instance.initializeNetworkEvent()),jy._instance}register(e){return new By(this,e)}unregister(...e){1===e.length?this._unregister(e[0],null,null):2===e.length?"string"==typeof e[1]?this._unregister(e[0],e[1],null):this._unregister(e[0],null,e[1]):this._unregister(e[0],e[1],e[2])}_unregister(e=this,t,n){let i=this.listenerMap.values();for(let r of i)for(let i of r.concat())i.isEqual(e,t,n)&&i.unregister()}registerListener(e){let t=this.getListeners(e.eventName);return t.push(e),t.sort((e,t)=>t.priority-e.priority),this.listenerMap.set(e.eventName,t),e}unregisterListener(e){let t=this.getListeners(e.eventName),n=t.indexOf(e);return n<0?null:(t.splice(n,1),e.unregister(),t.length<1&&this.listenerMap.delete(e.eventName),e)}call(...e){"string"==typeof e[0]?this._call(new Ly(e[0],e[1]),e[2]):this._call(e[0],e[1])}_call(e,t){let n=e.toContext();zy.instance.send(n,t)}trigger(...e){if(2!==e.length)return this._trigger(e[0]instanceof Ly?e[0]:new Ly(e[0].eventName,e[0].data,e[0].sendFrom));this._trigger(new Ly(e[0],e[1]))}_trigger(e){let t=this.getListeners(e.eventName).concat(this.getListeners("*"));for(let n of t)n.trigger(e);return e}getListeners(e){return this.listenerMap.has(e)?this.listenerMap.get(e):[]}initializeNetworkEvent(){let e=zy.instance.callback;e.onOpen=e=>{this.trigger("OPEN_NETWORK",{peerId:e})},e.onClose=e=>{this.trigger("CLOSE_NETWORK",{peerId:e})},e.onConnect=e=>{this.sendSystemMessage("<"+e+"> connect <DataConnection>"),this.trigger("CONNECT_PEER",{peerId:e})},e.onDisconnect=e=>{this.sendSystemMessage("<"+e+"> disconnect <DataConnection>"),this.trigger("DISCONNECT_PEER",{peerId:e})},e.onData=(e,t)=>{for(let n of t)this.trigger(n)},e.onError=(e,t)=>{this.sendSystemMessage("<"+e+"> "+t)}}sendSystemMessage(e){console.log(e)}}const Uy=jy.instance,Hy=zy.instance;class Vy{constructor(){this.identifierMap=new Map,this.aliasNameMap=new Map,this.garbageMap=new Map,this.queueMap=new Map,this.updateInterval=null,this.garbageCollectionInterval=null,this.updateCallback=()=>{this.updateQueue()},console.log("ObjectStore ready...")}static get instance(){return Vy._instance||(Vy._instance=new Vy),Vy._instance}add(e,t=!0){return null!=this.get(e.identifier)||this.isDeleted(e.identifier)?null:(this.identifierMap.set(e.identifier,e),(this.aliasNameMap.has(e.aliasName)?this.aliasNameMap.get(e.aliasName):this.aliasNameMap.set(e.aliasName,new Map).get(e.aliasName)).set(e.identifier,e),e.onStoreAdded(),t&&this.update(e.toContext()),e)}remove(e){if(!this.identifierMap.has(e.identifier))return null;this.identifierMap.delete(e.identifier);let t=this.aliasNameMap.get(e.aliasName);return t&&t.delete(e.identifier),e.onStoreRemoved(),e}delete(e,t=!0){let n=null,i=null;return"string"==typeof e?(n=this.get(e),i=e):(n=e,i=e.identifier),this.markForDelete(i),null==n?null:this._delete(n,t)}_delete(e,t){return null===this.remove(e)?null:(t&&Uy.call("DELETE_GAME_OBJECT",{identifier:e.identifier}),e)}markForDelete(e){this.garbageMap.set(e,performance.now()),this.garbageCollection(6e5)}get(e){return this.identifierMap.has(e)?this.identifierMap.get(e):null}getObjects(e){if(null==e)return Array.from(this.identifierMap.values());let t="";return t="string"==typeof e?e:e.aliasName,this.aliasNameMap.has(t)?Array.from(this.aliasNameMap.get(t).values()):[]}update(e){let t=null;if("string"==typeof e){let n=this.get(e);n&&(t=n.toContext())}else t=e;if(t)if(this.queueMap.has(t.identifier)){let e=this.queueMap.get(t.identifier);for(let n in t)e[n]=t[n]}else Uy.call("UPDATE_GAME_OBJECT",t),this.queueMap.set(t.identifier,t),null===this.updateInterval&&(this.updateInterval=Dg(this.updateCallback))}updateQueue(){this.queueMap.clear(),this.updateInterval=null}isDeleted(e){return null!=this.garbageMap.get(e)}getCatalog(){let e=[];for(let t of this.identifierMap.values())e.push({identifier:t.identifier,version:t.version});return e}clearDeleteHistory(){this.garbageMap.clear()}garbageCollection(e){"number"==typeof e?null===this.garbageCollectionInterval&&(this.garbageCollectionInterval=setTimeout(()=>{this.garbageCollectionInterval=null},1e3),this._garbageCollection(e)):this.garbageMap.delete(e.identifier)}_garbageCollection(e){let t=performance.now(),n=this.garbageMap.size-1e5;if(n<1)return;let i=this.garbageMap.entries();for(;n<1;){n--;let r=i.next();if(r.done)break;let s=r.value[0];r.value[1]+e<t||this.garbageMap.delete(s)}}}class Gy{constructor(e,t){this.timerMilliSecond=0,this.timeoutDate=0,this.isStopped=!1,this.callback=e,this.timerMilliSecond=t,this.reset()}get isActive(){return null!=this.timeoutTimer}stop(){this.isStopped=!0}clear(){this.callback=null,this.timerMilliSecond=0,this.timeoutDate=0,this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.isStopped=!1}reset(...e){1===e.length?this.timerMilliSecond=e[0]:1<e.length&&(this.callback=e[0],this.timerMilliSecond=e[1]),this.isStopped=!1;let t=this.timeoutDate;this.timeoutDate=performance.now()+this.timerMilliSecond,this.timeoutTimer&&t<=this.timeoutDate||this.setTimeout()}setTimeout(){this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.callback&&(this.timeoutTimer=setTimeout(()=>{this.timeoutTimer=null,this.isStopped||(performance.now()<this.timeoutDate?this.setTimeout():this.callback&&this.callback())},this.timeoutDate-performance.now()))}}class Zy{constructor(){this.constructorMap=new Map,this.aliasMap=new Map,console.log("ObjectFactory ready...")}static get instance(){return Zy._instance||(Zy._instance=new Zy),Zy._instance}register(e,t){t||(t=e.name||e.toString().match(/function\s*([^(]*)\(/)[1]),this.constructorMap.has(t)?console.error("\u305d\u306e alias<"+t+"> \u306f\u3059\u3067\u306b\u5272\u308a\u5f53\u3066\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f"):this.aliasMap.has(e)?console.error("\u305d\u306e constructor \u306f\u3059\u3067\u306b\u767b\u9332\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f",e):(console.log("addGameObjectFactory -> "+t),this.constructorMap.set(t,e),this.aliasMap.set(e,t))}create(e,t){let n=this.constructorMap.get(e);return n?new n(t):(console.error(e+"\u3068\u3044\u3046\u540d\u306eGameObject\u30af\u30e9\u30b9\u306f\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),null)}getAlias(e){return this.aliasMap.get(e)}}function Wy(e){return t=>{Zy.instance.register(t,e)}}function Yy(){return(e,t)=>{Object.defineProperty(e,t,{get:function(){return this.context.syncData[t]},set:function(e){this.context.syncData[t]=e,this.update()},enumerable:!0,configurable:!0})}}var qy;!function(e){const t=/&|<|>|"|'/g,n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"},i=/&amp;|&lt;|&gt;|&quot;|&apos;/g,r={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'"},s=/((?:[\0-\x08\x0B\f\x0E-\x1F\uFFFD\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))/g;function o(e){return n[e]}function a(e){return r[e]}e.xml2element=function(e){let t=new DOMParser,n=null;try{e=function(e){return e.replace(s,"").trim()}(e),n=t.parseFromString(e,"application/xml"),n.getElementsByTagName("parsererror").length&&(console.error("XML\u306e\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3057\u305f",n.documentElement),n=null)}catch(i){console.error(i)}return n?n.documentElement:null},e.encodeEntityReference=function(e){return e.replace(t,o)},e.decodeEntityReference=function(e){return e.replace(i,a)}}(qy||(qy={}));const $y=Object.getOwnPropertyNames(Object.prototype);Object.getOwnPropertyNames(Array.prototype);class Xy{constructor(){console.log("ObjectSerializer ready...")}static get instance(){return Xy._instance||(Xy._instance=new Xy),Xy._instance}toXml(e){let t="",n="toAttributes"in e?e.toAttributes():Xy.toAttributes(e.toContext().syncData),i=e.aliasName,r="";for(let s in n){let e=qy.encodeEntityReference(n[s]+"");null!=e&&(r+=" "+s+'="'+e+'"')}return t+=`<${i+r}>`,t+="innerXml"in e?e.innerXml():"",t+=`</${i}>`,t}static toAttributes(e){let t={};for(let n in e){let i=Xy.make2Attributes(e[n],n);for(let e in i)t[e]=i[e]}return t}static make2Attributes(e,t){let n={};if(Array.isArray(e)){let i=Xy.array2attributes(e,t);for(let e in i)n[e]=i[e]}else if("object"==typeof e){let i=Xy.object2attributes(e,t);for(let e in i)n[e]=i[e]}else n[t]=e;return n}static object2attributes(e,t){let n={};for(let i in e){let r=Xy.make2Attributes(e[i],t+"."+i);for(let e in r)n[e]=r[e]}return n}static array2attributes(e,t){let n={},i=e.length;for(let r=0;r<i;r++){let i=Xy.make2Attributes(e[r],t+"."+r);for(let e in i)n[e]=i[e]}return n}parseXml(e){let t=null;if(t="string"==typeof e?qy.xml2element(e):e,!t)return console.error("xmlElement\u304c\u7a7a\u3067\u3059"),null;let n=Zy.instance.create(t.tagName);if(!n)return null;if("parseAttributes"in n)n.parseAttributes(t.attributes);else{let e=n.toContext();Xy.parseAttributes(e.syncData,t.attributes),n.apply(e)}return n.initialize(),"parseInnerXml"in n&&n.parseInnerXml(t),n}static parseAttributes(e,t){let n=t.length;for(let i=0;i<n;i++){let n=t[i].value;n=qy.decodeEntityReference(n);let r=t[i].name.split("."),s=r[0],o=e,a=r.find(e=>$y.includes(e));null==a?1<r.length&&(({obj:o,key:s}=Xy.attributes2object(r,o,s)),null==s)||("string"!=typeof o[s]&&null!=o[s]&&(n=JSON.parse(n)),o[s]=n):console.log(`skip invalid key (${a})`)}return e}static attributes2object(e,t,n){let i=null,r=e.length;for(let s=0;s<r;s++){let o=parseInt(e[s]);if(i&&!Number.isNaN(o)&&!Array.isArray(t)&&Object.keys(i).length&&(i[n]=[],t=i[n]),n=Number.isNaN(o)?e[s]:o,Array.isArray(t)&&"number"!=typeof n)return console.warn("Array\u306b\u306findex\u306e\u633f\u5165\u3057\u304b\u8a31\u53ef\u3057\u306a\u3044"),{obj:t,key:null};s+1<r&&(null==t[n]&&(t[n]="number"==typeof n?[]:{}),i=t,t=t[n])}return{obj:t,key:n}}static parseInnerXml(e){return null}}class Ky{constructor(e=My.generateUuid()){this.context={aliasName:this.constructor.aliasName,identifier:"",majorVersion:0,minorVersion:0,syncData:{}},this.context.identifier=e}static get aliasName(){return Zy.instance.getAlias(this)}get aliasName(){return this.context.aliasName}get identifier(){return this.context.identifier}get version(){return this.context.majorVersion+this.context.minorVersion}initialize(){Vy.instance.add(this)}destroy(){Vy.instance.delete(this)}onStoreAdded(){}onStoreRemoved(){}update(){this.versionUp(),Vy.instance.update(this.identifier)}versionUp(){this.context.majorVersion+=1,this.context.minorVersion=Math.random()}apply(e){null!==e&&this.identifier===e.identifier&&(this.context.majorVersion=e.majorVersion,this.context.minorVersion=e.minorVersion,this.context.syncData=e.syncData)}clone(){let e=this.toXml();return Xy.instance.parseXml(e)}toContext(){return{aliasName:this.context.aliasName,identifier:this.context.identifier,majorVersion:this.context.majorVersion,minorVersion:this.context.minorVersion,syncData:Qy(this.context.syncData)}}toXml(){return Xy.instance.toXml(this)}}function Qy(e){if(null==e)return e;let t=Array.isArray(e)?[]:{},n=Object.getOwnPropertyNames(e);for(let i of n){let n=typeof e[i];null!=e[i]&&"object"===n?t[i]=Qy(e[i]):"function"!==n&&(t[i]=e[i])}return t}var Jy;let ev=(()=>{let e=Jy=class extends Ky{constructor(){super(...arguments),this.value="",this.attributes={},this.parentIdentifier="",this.majorIndex=0,this.minorIndex=Math.random(),this._children=[],this.needsSort=!0}get index(){return this.majorIndex+this.minorIndex}set index(e){this.majorIndex=0|e,this.minorIndex=e-this.majorIndex,this.parent&&(this.parent.needsSort=!0)}get parent(){return Vy.instance.get(this.parentIdentifier)}get parentId(){return this.parentIdentifier}get parentIsAssigned(){return 0<this.parentIdentifier.length}get parentIsUnknown(){return this.parentIsAssigned&&null==Vy.instance.get(this.parentIdentifier)}get parentIsDestroyed(){return this.parentIsAssigned&&Vy.instance.isDeleted(this.parentIdentifier)}get children(){return this.needsSort&&(this.needsSort=!1,this._children.sort((e,t)=>e.index-t.index)),this._children.concat()}destroy(){super.destroy();for(let e of this._children.concat())e.destroy();this._children=[]}onStoreAdded(){super.onStoreAdded(),this.initializeChildren()}onStoreRemoved(){super.onStoreRemoved(),this.parent&&this.parent.removeChild(this)}onChildAdded(e){}onChildRemoved(e){}_onChildAdded(e){let t=this;for(;t&&(t.onChildAdded(e),t=t.parent,t!==this););}_onChildRemoved(e){let t=this;for(;t&&(t.onChildRemoved(e),t=t.parent,t!==this););}initializeChildren(){if(null==Jy.unknownNodes[this.identifier])return;let e=Jy.unknownNodes[this.identifier];for(let t of e)t.parent===this&&this.updateChildren(t);Jy.unknownNodes[this.identifier]&&delete Jy.unknownNodes[this.identifier]}updateChildren(e=this){let t=this._children.indexOf(e),n=!1,i=e.parent===this;if(t<0&&i)this._children.push(e),t=this._children.length-1,n=!0;else{if(0<=t&&!i)return this._children.splice(t,1),void this._onChildRemoved(e);if(t<0&&!i)return}let r=this._children.length;r&&((this._children[t-1<0?0:t-1].index>e.index||e.index>this._children[r-1<t+1?r-1:t+1].index)&&(this.needsSort=!0),n&&this._onChildAdded(e))}updateIndexs(){let e=this.children;for(let t=0;t<e.length;t++)e[t].majorIndex=t,e[t].minorIndex=Math.random()}appendChild(e){if(e.contains(this))return null;e.parent&&e.parent!==this&&e.parent.removeChild(e);let t=0<this.children.length?this.children[this.children.length-1].majorIndex+1:0;return e.parentIdentifier=this.identifier,e.majorIndex=t,e.minorIndex=Math.random(),this.updateChildren(e),e}insertBefore(e,t){if(e.contains(this))return null;if(e===t&&e.parent===this)return e;e.parent&&e.parent!==this&&e.parent.removeChild(e);let n=this.children.indexOf(t);if(n<0)return this.appendChild(e);e.parentIdentifier=this.identifier;let i=0<n?this.children[n-1].index:0,r=t.index-i,s=i+r*(.45+.1*Math.random());return e.majorIndex=0|s,e.minorIndex=s-e.majorIndex,this.updateChildren(e),r<1e-7&&this.updateIndexs(),e}removeChild(e){return this.children.indexOf(e)<0?null:(e.parentIdentifier="",e.majorIndex=0,e.minorIndex=Math.random(),this.updateChildren(e),e)}contains(e){let t=e.parent;for(;t;){if(t===e)return console.error("\u3042 \u3084\u3063\u3079\u3001\u5faa\u74b0\u53c2\u7167",e),!1;if(t===this)return!0;t=t.parent}return!1}setAttribute(e,t){this.attributes[e]=t,this.update()}getAttribute(e){return null==this.attributes[e]?"":this.attributes[e]}removeAttribute(e){delete this.attributes[e],this.update()}toAttributes(){return Xy.toAttributes(this.attributes)}parseAttributes(e){Xy.parseAttributes(this.attributes,e)}innerXml(){let e="";e+=qy.encodeEntityReference(this.value+"");for(let t of this.children)e+=Xy.instance.toXml(t);return e}parseInnerXml(e){let t=e.children,n=t.length;if(0<n)for(let i=0;i<n;i++){let e=Xy.instance.parseXml(t[i]);e instanceof Jy&&this.appendChild(e)}else this.value=qy.decodeEntityReference(e.innerHTML)}apply(e){let t=this.parent;super.apply(e),t&&this.parent!==t&&t.updateChildren(this),this.parent?this.parent.updateChildren(this):this.parentIsAssigned&&(this.parentIdentifier in Jy.unknownNodes||(Jy.unknownNodes[this.parentIdentifier]=[]),Jy.unknownNodes[this.parentIdentifier].push(this))}};return e.unknownNodes={},Cg([Yy()],e.prototype,"value",void 0),Cg([Yy()],e.prototype,"attributes",void 0),Cg([Yy()],e.prototype,"parentIdentifier",void 0),Cg([Yy()],e.prototype,"majorIndex",void 0),Cg([Yy()],e.prototype,"minorIndex",void 0),e=Jy=Cg([Wy("node")],e),e})();function tv(e){return t=>{Wy(e)(t)}}function nv(){return(e,t)=>{e instanceof ev?((e,t)=>{Object.defineProperty(e,t,{get:function(){return this.getAttribute(t)},set:function(e){this.setAttribute(t,e)},enumerable:!0,configurable:!0})})(e,t):Yy()(e,t)}}class iv{constructor(e="Queue"){this.name=e,this.queue=Promise.resolve(),this._length=0}get length(){return this._length}add(e){this._length++,console.log(`${this.name} add: ${this._length}`),this.queue=this.queue.then("function"==typeof e.then?()=>e:0<e.length?()=>new Promise(e):e);let t=this.queue;return this.queue=this.queue.catch(e=>{console.error(e)}),this.queue=this.queue.then(()=>{this._length--,console.log(`${this.name} done: ${this._length}`)}),t}}var rv,sv;!function(e){const t=new RegExp(["\ud83c[\udf00-\udfff]","\ud83d[\udc00-\ude4f]","\ud83d[\ude80-\udeff]","\ud7c9[\ude00-\udeff]","[\u2600-\u27bf]"].join("|"));e.toHalfWidth=function(e){return e.replace(/[\uff01-\uff5e]/g,e=>String.fromCharCode(e.charCodeAt(0)-65248))},e.isEmote=function(e){return!!e&&(e=this.cr(e).replace(/[\r\n]/g,"")).length<=3&&(t.test(e)||/[$\uff04\\\uffe5\uff01\uff1f\u2755\u2762\u203d\u203c/!/?\u2665\u266a\u266c\u2669\u266b\u263a]/.test(e))},e.cr=function(e){if(!e)return"";let t="",n="";return[...e].forEach(e=>{if(n){switch(e){case"n":case"\uff4e":t+="\n";break;case"\\":case"\uffe5":t+=e;break;default:t+=n+e}n=""}else"\\"==e||"\uffe5"==e?n=e:t+=e}),t},e.validUrl=function(e){if(!e)return!1;try{new URL(e.trim())}catch(t){return!1}return/^https?\:\/\//.test(e.trim())},e.escapeHtml=function(e){return"string"!=typeof e?e.toString():e.replace(/[&'`"<>]/g,function(e){return{"&":"&amp;","'":"&#x27;","`":"&#x60;",'"':"&quot;","<":"&lt;",">":"&gt;"}[e]})}}(rv||(rv={}));class ov{constructor(){this.imageHash={},console.log("ImageStorage ready...")}static get instance(){return ov._instance||(ov._instance=new ov),ov._instance}get images(){let e=[];for(let t in this.imageHash)e.push(this.imageHash[t]);return e}destroy(){for(let e in this.imageHash)this.delete(e)}addAsync(e){return xg(this,void 0,void 0,function*(){let t=yield Ig.createAsync(e);return this._add(t)})}add(e){let t;if("string"==typeof e)t=Ig.create(e);else if(e instanceof Ig)t=e;else{if(this.update(e))return this.imageHash[e.identifier];t=Ig.create(e)}return this._add(t)}_add(e){return Og.COMPLETE<=e.state&&this.lazySynchronize(100),this.update(e)?this.imageHash[e.identifier]:(this.imageHash[e.identifier]=e,console.log("add Image: "+e.identifier),e)}update(e){let t;t=e instanceof Ig?e.toContext():e;let n=this.imageHash[e.identifier];return!!n&&(n.apply(e),!0)}delete(e){let t=this.imageHash[e];return!!t&&(t.destroy(),delete this.imageHash[e],!0)}get(e){return this.imageHash[e]||null}synchronize(e){this.lazyTimer&&this.lazyTimer.stop(),Uy.call("SYNCHRONIZE_FILE_LIST",this.getCatalog(),e)}lazySynchronize(e,t){null==this.lazyTimer&&(this.lazyTimer=new Gy(()=>this.synchronize(t),e)),this.lazyTimer.reset(e)}getCatalog(){let e=[];for(let t of this.images)Og.COMPLETE<=t.state&&e.push({identifier:t.identifier,state:t.state});return e}}let av=(()=>{let e=sv=class extends Ky{constructor(){super(...arguments),this.userId="",this.peerId="",this.name="",this.imageIdentifier="",this.color=sv.CHAT_DEFAULT_COLOR}get isMine(){return sv.myCursor&&sv.myCursor===this}get image(){return ov.instance.get(this.imageIdentifier)}onStoreAdded(){super.onStoreAdded(),this.isMine||Uy.register(this).on("DISCONNECT_PEER",-1e3,e=>{e.data.peerId===this.peerId&&(sv.userIdMap.delete(this.userId),sv.peerIdMap.delete(this.peerId),Vy.instance.remove(this))})}onStoreRemoved(){super.onStoreRemoved(),Uy.unregister(this),sv.userIdMap.delete(this.userId),sv.peerIdMap.delete(this.peerId)}static findByUserId(e){return this.find(sv.userIdMap,e,!0)}static findByPeerId(e){return this.find(sv.peerIdMap,e,!1)}static find(e,t,n){let i=e.get(t);if(null!=i&&Vy.instance.get(i))return Vy.instance.get(i);let r=Vy.instance.getObjects(sv);for(let s of r){let i=n?s.userId:s.peerId;if(i===t)return e.set(i,s.identifier),s}return null}static createMyCursor(){return sv.myCursor?(console.warn("It is already created."),sv.myCursor):(sv.myCursor=new sv,sv.myCursor.peerId=Hy.peerId,sv.myCursor.initialize(),window.localStorage&&localStorage.getItem(sv.CHAT_MY_NAME_LOCAL_STORAGE_KEY)&&(sv.myCursor.name=localStorage.getItem(sv.CHAT_MY_NAME_LOCAL_STORAGE_KEY)),window.localStorage&&localStorage.getItem(sv.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)&&(sv.myCursor.color=localStorage.getItem(sv.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)),sv.myCursor)}apply(e){let t=e.syncData.userId,n=e.syncData.peerId;t!==this.userId&&(sv.userIdMap.set(t,this.identifier),sv.userIdMap.delete(this.userId)),n!==this.peerId&&(sv.peerIdMap.set(n,this.identifier),sv.peerIdMap.delete(this.peerId)),super.apply(e)}isPeerAUdon(){return null!=/u.*d.*o.*n/gi.exec(this.peerId)}};return e.CHAT_MY_NAME_LOCAL_STORAGE_KEY="udonanaumu-chat-my-name-local-storage",e.CHAT_MY_COLOR_LOCAL_STORAGE_KEY="udonanaumu-chat-my-color-local-storage",e.CHAT_DEFAULT_COLOR="#444444",e.CHAT_TRANSPARENT_COLOR="#ffffff",e.myCursor=null,e.userIdMap=new Map,e.peerIdMap=new Map,Cg([nv()],e.prototype,"userId",void 0),Cg([nv()],e.prototype,"peerId",void 0),Cg([nv()],e.prototype,"name",void 0),Cg([nv()],e.prototype,"imageIdentifier",void 0),Cg([nv()],e.prototype,"color",void 0),e=sv=Cg([tv("PeerCursor")],e),e})(),lv=(()=>{let e=class extends ev{constructor(){super(...arguments),this.dicebot="",this.paletteColor="",this._palettes=[],this._paletteLines=[],this._paletteVariables=[],this.isAnalized=!1}get color(){return this.paletteColor&&"#ffffff"!=this.paletteColor?this.paletteColor:window.localStorage&&localStorage.getItem(av.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)&&"#ffffff"!=localStorage.getItem(av.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)?localStorage.getItem(av.CHAT_MY_COLOR_LOCAL_STORAGE_KEY):av.CHAT_DEFAULT_COLOR}set color(e){this.paletteColor=e}get paletteLines(){return this.isAnalized||this.parse(this.value),this._paletteLines}get paletteVariables(){return this.isAnalized||this.parse(this.value),this._paletteVariables}getPalette(){return this.isAnalized||this.parse(this.value),this._palettes}setPalette(e){this.value=e,this.isAnalized=!1}evaluate(e,t){let n="";n="string"==typeof e?e:e.palette,console.log(n);let i=0,r=!0;for(;r;)i++,r=!1,n=n.replace(/[{\uff5b]\s*([^{}\uff5b\uff5d]+)\s*[}\uff5d]/g,(e,n)=>{n=rv.toHalfWidth(n),console.log(n),r=!0;let i="";for(let t of this.paletteVariables)t.name==n&&(i=t.value);if(t){let e=t.getFirstElementByName(n);return e?(i=e.isNumberResource?e.currentValue:e.isCheckProperty?(e.currentValue+"").split(/[|\uff5c]/g)[e.value?0:1]:e.isAbilityScore?e.calcAbilityScore():e.value,null==i&&(i="")):((e=t.getFirstElementByName(n.replace(/^\u6700\u5927/,""))||t.getFirstElementByName(n.replace(/^Max[\:\_\-\s]?/i,""))||t.getFirstElementByName(n.replace(/^\u57fa\u672c/,""))||t.getFirstElementByName(n.replace(/^\u521d\u671f/,""))||t.getFirstElementByName(n.replace(/^\u539f/,""))||t.getFirstElementByName(n.replace(/\u57fa\u672c\u5024$/,""))||t.getFirstElementByName(n.replace(/\u521d\u671f\u5024$/,""))||t.getFirstElementByName(n.replace(/\u539f\u70b9$/,"")))&&(e.isNumberResource||e.isAbilityScore)&&(i=e.value),(e=t.getFirstElementByName(n.replace(/\u4fee\u6b63\u5024?$/,""))||t.getFirstElementByName(n.replace(/\s*Mod(ifier|\.)?$/i,""))||t.getFirstElementByName(n.replace(/\u30dc\u30fc\u30ca\u30b9$/,"")))&&e.isAbilityScore&&(i=e.calcAbilityScore())),i+""}return""}),128<i&&(r=!1);return n}parse(e){this._palettes=e.split("\n"),this._paletteLines=[],this._paletteVariables=[];for(let t of this._palettes){let e=this.parseVariable(t);e?this._paletteVariables.push(e):this._paletteLines.push({palette:t})}this.isAnalized=!0}parseVariable(e){let t=/^\s*[/\uff0f]{2}([^=\uff1d{}\uff5b\uff5d\s]+)\s*[=\uff1d]\s*(.+)\s*/gi.exec(e);return t?{name:rv.toHalfWidth(t[1]),value:t[2]}:null}apply(e){super.apply(e),this.isAnalized=!1}};return Cg([nv()],e.prototype,"dicebot",void 0),Cg([nv()],e.prototype,"paletteColor",void 0),e=Cg([tv("chat-palette")],e),e})();var cv;let hv=(()=>{let e=cv=class extends ev{get isSimpleNumber(){return null!=this.type&&"simpleNumber"===this.type}get isNumberResource(){return null!=this.type&&"numberResource"===this.type}get isCheckProperty(){return null!=this.type&&"checkProperty"===this.type}get isNote(){return null!=this.type&&"note"===this.type}get isAbilityScore(){return null!=this.type&&"abilityScore"===this.type}get isUrl(){return null!=this.type&&"url"===this.type}static create(e,t="",n={},i=""){let r;return r=i&&0<i.length?new cv(i):new cv,r.attributes=n,r.name=e,r.value=t,r.initialize(),r}getElementsByName(e){let t=[];for(let n of this.children)n instanceof cv&&(n.getAttribute("name")===e&&t.push(n),Array.prototype.push.apply(t,n.getElementsByName(e)));return t}getElementsByType(e){let t=[];for(let n of this.children)n instanceof cv&&(n.getAttribute("type")===e&&t.push(n),Array.prototype.push.apply(t,n.getElementsByType(e)));return t}getFirstElementByName(e){for(let t of this.children)if(t instanceof cv){if(t.getAttribute("name")===e)return t;let n=t.getFirstElementByName(e);if(n)return n}return null}calcAbilityScore(){if(!this.isAbilityScore||!this.currentValue)return 0;let e;return(e=this.currentValue.toString().match(/^div(\d+)$/))?Math.floor(+this.value/+e[1]):(e=this.currentValue.toString().match(/^DnD/))?Math.floor((+this.value-10)/2):0}};return Cg([nv()],e.prototype,"name",void 0),Cg([nv()],e.prototype,"type",void 0),Cg([nv()],e.prototype,"currentValue",void 0),e=cv=Cg([tv("data")],e),e})(),uv=(()=>{let e=class extends ev{constructor(){super(...arguments),this.location={name:"table",x:0,y:0},this.posZ=0,this._imageFile=Ig.Empty,this._shadowImageFile=Ig.Empty,this._dataElements={},this.currntImageIndex=0,this.isUseIconToOverviewImage=!1,this.currntIconIndex=0,this.isAltitudeIndicate=!1,this.isInverse=!1,this.isHollow=!1,this.isBlackPaint=!1,this.aura=-1,this.isNotRide=!0,this.isInventoryIndicate=!0}get isVisibleOnTable(){return"table"===this.location.name}get rootDataElement(){for(let e of this.children)if(e.getAttribute("name")===this.aliasName)return e;return null}get imageDataElement(){return this.getElement("image")}get commonDataElement(){return this.getElement("common")}get detailDataElement(){return this.getElement("detail")}get imageElement(){if(!this.imageDataElement)return null;let e=this.imageDataElement.getElementsByName("imageIdentifier");return e[this.currntImageIndex<0?0:this.currntImageIndex>=e.length?e.length-1:this.currntImageIndex]}get imageFile(){if(!this.imageDataElement)return this._imageFile;let e=this.imageElement;if(e&&this._imageFile.identifier!==e.value){let t=ov.instance.get(e.value);this._imageFile=t||Ig.Empty}return this._imageFile}get imageFiles(){return this.imageDataElement.getElementsByName("imageIdentifier").map(e=>ov.instance.get(e.value)||null).filter(e=>null!=e)}get faceIcon(){if(!this.imageDataElement)return null;let e=this.imageDataElement.getElementsByName("faceIcon");if(e){let t=e[this.currntIconIndex];return this.currntIconIndex<0&&(this.currntIconIndex=0),t?ov.instance.get(t.value):null}return null}get faceIcons(){return this.imageDataElement.getElementsByName("faceIcon").map(e=>ov.instance.get(e.value)||null).filter(e=>null!=e)}get shadowImageFile(){if(!this.imageDataElement)return this._shadowImageFile;let e=this.imageDataElement.getFirstElementByName("shadowImageIdentifier");if(e&&this._shadowImageFile.identifier!==e.value){let t=ov.instance.get(e.value);this._shadowImageFile=t||Ig.Empty}else{let e=this.imageElement;if(e&&this._shadowImageFile.identifier!==e.currentValue){let t=ov.instance.get(e.currentValue);this._shadowImageFile=t||Ig.Empty}}return this._shadowImageFile}get altitude(){let e=this.getElement("altitude",this.commonDataElement);!e&&this.commonDataElement&&this.commonDataElement.appendChild(hv.create("altitude",0,{},"altitude_"+this.identifier));let t=e?+e.value:0;return Number.isNaN(t)?0:t}set altitude(e){let t=this.getElement("altitude",this.commonDataElement);t&&(t.value=e)}createDataElements(){this.initialize();let e=this.aliasName;if(!this.rootDataElement){let t=hv.create(e,"",{},e+"_"+this.identifier);this.appendChild(t)}this.imageDataElement||(this.rootDataElement.appendChild(hv.create("image","",{},"image_"+this.identifier)),this.imageDataElement.appendChild(hv.create("imageIdentifier","",{type:"image"},"imageIdentifier_"+this.identifier))),this.commonDataElement||this.rootDataElement.appendChild(hv.create("common","",{},"common_"+this.identifier)),this.detailDataElement||this.rootDataElement.appendChild(hv.create("detail","",{},"detail_"+this.identifier))}getElement(e,t=this.rootDataElement){if(!t)return null;let n=this._dataElements[e]?Vy.instance.get(this._dataElements[e]):null;return n&&t.contains(n)||(n=t.getFirstElementByName(e),this._dataElements[e]=n?n.identifier:null),n}getCommonValue(e,t){let n=this.getElement(e,this.commonDataElement);if(!n)return t;if("number"==typeof t){let e=+n.value;return Number.isNaN(e)?t:e}return n.value+""}getUrls(){return this.rootDataElement.getElementsByType("url")}setCommonValue(e,t){let n=this.getElement(e,this.commonDataElement);n&&(n.value=t)}getImageFile(e){if(!this.imageDataElement)return null;let t=this.getElement(e,this.imageDataElement);return t?ov.instance.get(t.value):null}setImageFile(e,t){let n=t?this.getElement(e,this.imageDataElement):null;n&&(n.value=t.identifier)}setLocation(e){this.location.name=e,this.update()}};return Cg([nv()],e.prototype,"location",void 0),Cg([nv()],e.prototype,"posZ",void 0),Cg([nv()],e.prototype,"currntImageIndex",void 0),Cg([nv()],e.prototype,"isUseIconToOverviewImage",void 0),Cg([nv()],e.prototype,"currntIconIndex",void 0),Cg([nv()],e.prototype,"isAltitudeIndicate",void 0),Cg([nv()],e.prototype,"isInverse",void 0),Cg([nv()],e.prototype,"isHollow",void 0),Cg([nv()],e.prototype,"isBlackPaint",void 0),Cg([nv()],e.prototype,"aura",void 0),Cg([nv()],e.prototype,"isNotRide",void 0),Cg([nv()],e.prototype,"isInventoryIndicate",void 0),e=Cg([tv("TabletopObject")],e),e})();var dv=function(e){return e[e.Default=1]="Default",e[e.Image=2]="Image",e[e.Postfix=3]="Postfix",e[e.PostfixOrImage=4]="PostfixOrImage",e[e.PostfixAndImage=5]="PostfixAndImage",e[e.NotConditionStandUp=6]="NotConditionStandUp",e}({});let pv=(()=>{let e=class extends hv{constructor(){super(...arguments),this.position=5,this.height=35,this.overviewIndex=-1}get standElements(){return this.getElementsByName("stand")}add(e){let t=this.getFirstElementByName("stand")?dv.NotConditionStandUp:dv.Default,n=hv.create("stand");n.appendChild(hv.create("name","",{},"name_"+n.identifier)),n.appendChild(hv.create("imageIdentifier",e&&e!=Ig.Empty.identifier?e:"stand_no_image",{type:"image"},"imageIdentifier_"+n.identifier)),n.appendChild(hv.create("conditionType",t,{},"conditionType_"+n.identifier)),n.appendChild(hv.create("height",0,{currentValue:0},"height_"+n.identifier)),n.appendChild(hv.create("applyImageEffect","",{},"applyImageEffect_"+n.identifier)),n.appendChild(hv.create("applyRoll","",{},"applyRoll_"+n.identifier)),n.appendChild(hv.create("applyDialog","applyDialog",{},"applyDialog_"+n.identifier)),n.appendChild(hv.create("postfix","",{},"postfix_"+n.identifier)),n.appendChild(hv.create("position",0,{currentValue:""},"position_"+n.identifier)),n.appendChild(hv.create("speakingImageIdentifier","",{type:"image"},"speakingImageIdentifier_"+n.identifier)),this.appendChild(n)}remove(e){this.removeChild(e)}matchStandInfo(e,t,n=null){const i=t instanceof Ig?t.identifier:t;let r="",s=!1,o=[];["\uff20\u9000\u53bb","@farewell"].forEach(t=>{rv.toHalfWidth(e).toUpperCase().endsWith(rv.toHalfWidth(t).toUpperCase())&&(("@"==t.slice(0,1)||"\uff20"==t.slice(0,1))&&r.length<t.length&&(r=t),s=!0)});for(const d of this.standElements){const e=d.getFirstElementByName("name");e&&e.value.toString()==n&&o.push(d)}let a=1,l=!0,c=[],h=[];for(const d of this.standElements){if(!d.getFirstElementByName("imageIdentifier")||!d.getFirstElementByName("conditionType"))continue;const t=d.getFirstElementByName("conditionType").value;if(t!=dv.NotConditionStandUp)if(t==dv.Default)c.push(d);else{const n=d.getFirstElementByName("postfix")?d.getFirstElementByName("postfix").value.toString():null,s=d.getFirstElementByName("targetImageIdentifier")?d.getElementsByName("targetImageIdentifier").map(e=>e.value):[];let o=!1,c=!1;if(n&&(t==dv.Postfix||t==dv.PostfixOrImage||t==dv.PostfixAndImage))for(let t of n.split(/[\r\n]+/g))t&&0!=t.length&&rv.toHalfWidth(e).toUpperCase().endsWith(rv.toHalfWidth(t).toUpperCase())&&(("@"==t.slice(0,1)||"\uff20"==t.slice(0,1))&&r.length<t.length&&(r=t),o=!0);s.length>0&&(t==dv.Image||t==dv.PostfixOrImage||t==dv.PostfixAndImage)&&(c=i&&s.indexOf(i)>=0),(o&&(t==dv.Postfix||t==dv.PostfixOrImage)||c&&(t==dv.Image||t==dv.PostfixOrImage)||o&&c&&t==dv.PostfixAndImage)&&(l=!1,h.push(d),a<+t&&(a=+t))}}n||(o=l?c:h.filter(e=>+e.getFirstElementByName("conditionType").value==a));let u={standElementIdentifier:null,matchMostLongText:r,farewell:s};return o&&o.length>0&&(u.standElementIdentifier=o[Math.floor(Math.random()*o.length)].identifier),u}};return Cg([nv()],e.prototype,"position",void 0),Cg([nv()],e.prototype,"height",void 0),Cg([nv()],e.prototype,"overviewIndex",void 0),e=Cg([tv("stand-list")],e),e})();var fv;let gv=(()=>{let e=fv=class extends uv{constructor(e=My.generateUuid()){super(e),this.rotate=0,this.roll=0,this.isDropShadow=!0,this.isShowChatBubble=!0,this.text="",this.isEmote=!1,this.isAltitudeIndicate=!0}get name(){return this.getCommonValue("name","")}get size(){return this.getCommonValue("size",1)}get chatPalette(){for(let e of this.children)if(e instanceof lv)return e;return null}get standList(){for(let t of this.children)if(t instanceof pv)return t;let e=new pv("StandList_"+this.identifier);return e.initialize(),this.appendChild(e),e}static create(e,t,n){let i=new fv;return i.createDataElements(),i.initialize(),i.createTestGameDataElement(e,t,n),i}createTestGameDataElement(e,t,n){this.createDataElements();let i=hv.create("name",e,{},"name_"+this.identifier),r=hv.create("size",t,{},"size_"+this.identifier),s=hv.create("altitude",0,{},"altitude_"+this.identifier);this.imageDataElement.getFirstElementByName("imageIdentifier")&&(this.imageDataElement.getFirstElementByName("imageIdentifier").value=n);let o=hv.create("\u30ea\u30bd\u30fc\u30b9","",{},"\u30ea\u30bd\u30fc\u30b9"+this.identifier),a=hv.create("HP",200,{type:"numberResource",currentValue:"200"},"HP_"+this.identifier),l=hv.create("MP",100,{type:"numberResource",currentValue:"100"},"MP_"+this.identifier);this.commonDataElement.appendChild(i),this.commonDataElement.appendChild(r),this.commonDataElement.appendChild(s),this.detailDataElement.appendChild(o),o.appendChild(a),o.appendChild(l);let c=hv.create("\u60c5\u5831","",{},"\u60c5\u5831"+this.identifier);this.detailDataElement.appendChild(c),c.appendChild(hv.create("\u8aac\u660e","\u3053\u3053\u306b\u8aac\u660e\u3092\u66f8\u304f\n\u3042\u3044\u3046\u3048\u304a",{type:"note"},"\u8aac\u660e"+this.identifier)),c.appendChild(hv.create("\u30e1\u30e2","\u4efb\u610f\u306e\u6587\u5b57\u5217\n\uff11\n\uff12\n\uff13\n\uff14\n\uff15",{type:"note"},"\u30e1\u30e2"+this.identifier)),c.appendChild(hv.create("\u53c2\u7167URL","https://www.example.com",{type:"url"},"\u53c2\u7167URL"+this.identifier)),c=hv.create("\u80fd\u529b","",{},"\u80fd\u529b"+this.identifier),this.detailDataElement.appendChild(c),c.appendChild(hv.create("\u5668\u7528\u5ea6",24,{type:"abilityScore",currentValue:"div6"},"\u5668\u7528\u5ea6"+this.identifier)),c.appendChild(hv.create("\u654f\u6377\u5ea6",24,{type:"abilityScore",currentValue:"div6"},"\u654f\u6377\u5ea6"+this.identifier)),c.appendChild(hv.create("\u7b4b\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u7b4b\u529b"+this.identifier)),c.appendChild(hv.create("\u751f\u547d\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u751f\u547d\u529b"+this.identifier)),c.appendChild(hv.create("\u77e5\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u77e5\u529b"+this.identifier)),c.appendChild(hv.create("\u7cbe\u795e\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u7cbe\u795e\u529b"+this.identifier)),c=hv.create("\u6226\u95d8\u7279\u6280","",{},"\u6226\u95d8\u7279\u6280"+this.identifier),this.detailDataElement.appendChild(c),c.appendChild(hv.create("Lv1","\u5168\u529b\u653b\u6483",{},"Lv1"+this.identifier)),c.appendChild(hv.create("Lv3","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9",{},"Lv3"+this.identifier)),c.appendChild(hv.create("Lv5","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9\u2161",{},"Lv5"+this.identifier)),c.appendChild(hv.create("Lv7","\u9811\u5f37",{},"Lv7"+this.identifier)),c.appendChild(hv.create("Lv9","\u8599\u304e\u6255\u3044",{},"Lv9"+this.identifier)),c.appendChild(hv.create("\u81ea\u52d5","\u6cbb\u7652\u9069\u6b63",{},"\u81ea\u52d5"+this.identifier)),(new DOMParser).parseFromString(this.rootDataElement.toXml(),"application/xml");let h=new lv("ChatPalette_"+this.identifier);h.setPalette("\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u5165\u529b\u4f8b\uff1a\n2d6+1 \u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\n\uff11\uff44\uff12\uff10\uff0b{\u654f\u6377}\uff0b\uff5b\u683c\u95d8\uff5d\u3000{name}\u306e\u683c\u95d8\uff01\n//\u654f\u6377=10+{\u654f\u6377A}\n//\u654f\u6377A=10\n//\u683c\u95d8\uff1d\uff11"),h.initialize(),this.appendChild(h);let u=new pv("StandList_"+this.identifier);u.initialize(),this.appendChild(u)}};return Cg([nv()],e.prototype,"rotate",void 0),Cg([nv()],e.prototype,"roll",void 0),Cg([nv()],e.prototype,"isDropShadow",void 0),Cg([nv()],e.prototype,"isShowChatBubble",void 0),e=fv=Cg([tv("character")],e),e})(),mv=(()=>{let e=class extends ev{constructor(){super(...arguments),this.name="",this.command="",this.dice=""}parseText(){return this.value?this.value.split(/[\r\n]+/).map(e=>{let t=null;if(t=(e=e.trim()).match(/([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[\-\u2015\uff0d~\uff5e][\s\u3000]*([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[:\uff1a](.+)/)){const e=+rv.toHalfWidth(t[1].replace(/[\-\uff0d\u2010]/,"-")),n=+rv.toHalfWidth(t[2].replace(/[\-\uff0d\u2010]/,"-"));return e<=n?{range:{start:e,end:n},result:t[3]}:{range:{start:n,end:e},result:t[3]}}if(t=e.match(/([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[\-\u2015\uff0d~\uff5e][\s\u3000]*[\*\uff0a][\s\u3000]*[:\uff1a](.+)/))return{range:{start:+rv.toHalfWidth(t[1].replace(/[\-\uff0d\u2010]/,"-")),end:null},result:t[2]};if(t=e.match(/[\*\uff0a][\s\u3000]*[\-\u2015\uff0d~\uff5e][\s\u3000]*([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[:\uff1a](.+)/))return{range:{start:null,end:+rv.toHalfWidth(t[1].replace(/[\-\uff0d\u2010]/,"-"))},result:t[2]};if(t=e.match(/([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[:\uff1a](.+)/)){const e=+rv.toHalfWidth(t[1].replace(/[\-\uff0d\u2010]/,"-"));return{range:{start:e,end:e},result:t[2]}}return(t=e.match(/[\*\uff0a][\s\u3000]*[\-\u2015\uff0d~\uff5e][\*\uff0a][\s\u3000]*[:\uff1a](.+)/))||(t=e.match(/[\*\uff0a][\s\u3000]*[:\uff1a](.+)/))?{range:{start:null,end:null},result:t[1]}:null}).filter(e=>e):[]}};return Cg([nv()],e.prototype,"name",void 0),Cg([nv()],e.prototype,"command",void 0),Cg([nv()],e.prototype,"dice",void 0),e=Cg([tv("dice-roll-table")],e),e})();var bv;let yv=(()=>{let e=bv=class extends ev{static get instance(){return bv._instance||(bv._instance=new bv("DiceRollTableList"),bv._instance.initialize()),bv._instance}get diceRollTables(){return this.children}addDiceRollTable(...e){let t=null;if(e[0]instanceof mv)t=e[0];else{let n=e[0];t=new mv(e[1]),t.name=n,t.initialize()}return this.appendChild(t)}parseInnerXml(e){for(let n of bv.instance.children)n.destroy();let t=bv.instance.toContext();t.syncData=this.toContext().syncData,bv.instance.apply(t),bv.instance.update(),super.parseInnerXml.apply(bv.instance,[e]),this.destroy()}};return e=bv=Cg([tv("dice-roll-table-list")],e),e})();var vv;let _v=(()=>{let e=vv=class extends Ky{onStoreAdded(){super.onStoreAdded(),vv.queue.add(vv.loadScriptAsync("./assets/cgiDiceBot.js")),Uy.register(this).on("SEND_MESSAGE",e=>xg(this,void 0,void 0,function*(){let t=Vy.instance.get(e.data.messageIdentifier);if(!t||!t.isSendFromSelf||t.isSystem)return;let n=rv.toHalfWidth(t.text),i=t.tag;try{let e=/^((?:repeat|rep|x)?(\d+)?\s+)?([^\s]*)?/gi.exec(n),r=null!=e[2]?Number(e[2]):1,s=null!=e[3]?e[3]:n;if(!s||r<1||!(/choice\[.*\]/i.test(s)||/choice\(.*\)/i.test(s)||/^[a-zA-Z0-9!-/:-@\xa5[-`{-~\}]+$/.test(s)))return;let o={result:"",isSecret:!1,isDiceRollTable:!1},a=!1;for(const t of yv.instance.diceRollTables){let e=!1;if(t.command&&s.trim().toUpperCase()==="S"+t.command.trim().toUpperCase()?(a=!0,e=!0):t.command&&s.trim().toUpperCase()===t.command.trim().toUpperCase()&&(a=!0),a){o.isDiceRollTable=!0,o.tableName=t.name&&t.name.length>0?t.name:"(\u7121\u540d\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868)",o.isSecret=e;const n=t.parseText();for(let e=0;e<r&&e<32;e++){let i=yield vv.diceRollAsync(rv.toHalfWidth(t.dice),"DiceBot",1);i.result&&(i.result=i.result.replace("DiceBot : ","").replace(/[\uff1e]/g,e=>"\u2192").trim());let s=0,a=null;i.result.length>0&&(a=i.result.match(/\s\u2192\s(?:\u6210\u529f\u6570)?(\-?\d+)$/))&&(s=+a[1]);let l=!1;for(const e of n)if((null===e.range.start||e.range.start<=s)&&(null===e.range.end||s<=e.range.end)){o.result+="\ud83c\udfb2 "+i.result+"\n"+rv.cr(e.result),l=!0;break}l||(o.result+="\ud83c\udfb2 "+i.result+"\n(\u7d50\u679c\u306a\u3057)"),1<r&&(o.result+=` #${e+1}\n`)}break}}if(!a)if(vv.apiUrl)o=yield vv.diceRollAsync(s,i,r);else for(let t=0;t<r&&t<32;t++){let e=yield vv.diceRollAsync(s,i,r);if(e.result.length<1)break;o.result+=e.result,o.isSecret=o.isSecret||e.isSecret,1<r&&(o.result+=` #${t+1}`)}this.sendResultMessage(o,t)}catch(r){console.error(r)}}))}onStoreRemoved(){super.onStoreRemoved(),Uy.unregister(this)}sendResultMessage(e,t){let n=e.result,i=e.isSecret;if(n.length<1)return;e.isDiceRollTable||(n=n.replace(/[\uff1e]/g,e=>"\u2192").trim());let r={identifier:"",tabIdentifier:t.tabIdentifier,originFrom:t.from,from:e.isDiceRollTable?"Dice-Roll Table":vv.apiUrl?`BCDice-API(${vv.apiUrl})`:"System-BCDice",timestamp:t.timestamp+1,imageIdentifier:"",tag:i?"system secret":"system",name:e.isDiceRollTable?i?"<"+e.tableName+" (Secret)\uff1a"+t.name+">":"<"+e.tableName+"\uff1a"+t.name+">":i?"<Secret-BCDice\uff1a"+t.name+">":"<BCDice\uff1a"+t.name+">",text:n,color:t.color,isUseStandImage:t.isUseStandImage};if(!i&&!t.standName&&t.isUseStandImage){const e=Vy.instance.get(t.characterIdentifier);if(e instanceof gv){const i=e.standList.matchStandInfo(n,t.imageIdentifier);if(i.farewell){const n={characterIdentifier:e.identifier};if(t.to){const e=av.findByUserId(t.to);e&&(e.peerId!=av.myCursor.peerId&&Uy.call("FAREWELL_STAND_IMAGE",n,e.peerId),Uy.call("FAREWELL_STAND_IMAGE",n,av.myCursor.peerId))}else Uy.call("FAREWELL_STAND_IMAGE",n)}else if(i&&i.standElementIdentifier){const n=Vy.instance.get(i.standElementIdentifier);if(n&&n.getFirstElementByName("conditionType")){const r=+n.getFirstElementByName("conditionType").value;if(r==dv.Postfix||r==dv.PostfixOrImage||r==dv.PostfixAndImage){const n={characterIdentifier:e.identifier,standIdentifier:i.standElementIdentifier,color:t.color,secret:!!t.to};if(n.secret){const e=av.findByUserId(t.to);e&&(e.peerId!=av.myCursor.peerId&&Uy.call("POPUP_STAND_IMAGE",n,e.peerId),Uy.call("POPUP_STAND_IMAGE",n,av.myCursor.peerId))}else Uy.call("POPUP_STAND_IMAGE",n)}}}i.matchMostLongText&&r.text&&(r.text=r.text.slice(0,r.text.length-i.matchMostLongText.length))}}null!=t.to&&0<t.to.length&&(r.to=t.to,t.to.indexOf(t.from)<0&&(r.to+=" "+t.from));let s=Vy.instance.get(t.tabIdentifier);s&&s.addMessage(r)}static diceRollAsync(e,t,n=1){if(vv.apiUrl){const i=vv.apiUrl+"/v1/diceroll?system="+(t?encodeURIComponent(t):"DiceBot")+"&command="+encodeURIComponent(e),r=[];for(let e=1;e<=n;e++)r.push(fetch(i,{mode:"cors"}).then(e=>{if(e.ok)return e.json();throw new Error(e.statusText)}).then(i=>({result:(t||"DiceBot")+i.result+(n>1?` #${e}\n`:""),isSecret:i.secret})).catch(e=>({result:"",isSecret:!1})));return vv.queue.add(Promise.all(r).then(e=>e.reduce((e,t)=>({result:e.result+t.result,isSecret:e.isSecret||t.isSecret}),{result:"",isSecret:!1})))}return vv.queue.add(vv.loadDiceBotAsync(t)),vv.queue.add(()=>{if("Opal"in window==0)return console.warn("Opal is not loaded..."),{result:"",isSecret:!1};let n=[],i=[];try{Opal.gvars.isDebug=!1;let r=Opal.CgiDiceBot.$new();return n=r.$roll(e,t,i,"diceBotTable_",!0),console.log("diceRoll!!!",n),console.log("isSecret!!!",r.isSecret),{result:n[0],isSecret:r.isSecret}}catch(r){console.error(r)}return{result:"",isSecret:!1}})}static getHelpMessage(e){if(vv.apiUrl){const t=[fetch(vv.apiUrl+"/v1/systeminfo?system=DiceBot",{mode:"cors"}).then(e=>e.json())];return e&&"DiceBot"!=e&&t.push(fetch(vv.apiUrl+"/v1/systeminfo?system="+encodeURIComponent(e),{mode:"cors"}).then(e=>e.json())),Promise.all(t).then(e=>e.map(e=>e.systeminfo&&e.systeminfo.info?e.systeminfo.info.replace("\u3053\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u306f\u90e8\u5c4b\u306e\u30b7\u30b9\u30c6\u30e0\u540d\u8868\u793a\u7528\u3068\u306a\u308a\u307e\u3059","\u3053\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u306f\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306a\u3069\u306e\u30b7\u30b9\u30c6\u30e0\u540d\u8868\u793a\u7528\u3068\u306a\u308a\u307e\u3059"):"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u60c5\u5831\u304c\u3042\u308a\u307e\u305b\u3093\u3002"))}return vv.queue.add(vv.loadDiceBotAsync(e)),vv.queue.add(()=>{if("Opal"in window==0)return console.warn("Opal is not loaded..."),"";let t=["\u3010\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3011\u30c1\u30e3\u30c3\u30c8\u306b\u30c0\u30a4\u30b9\u7528\u306e\u6587\u5b57\u3092\u5165\u529b\u3059\u308b\u3068\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u304c\u53ef\u80fd\n\u5165\u529b\u4f8b\uff09\uff12\uff44\uff16\uff0b\uff11\u3000\u653b\u6483\uff01\n\u51fa\u529b\u4f8b\uff092d6+1\u3000\u653b\u6483\uff01\n\u3000\u3000\u3000\u3000  diceBot: (2d6) \u2192 7\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u30c0\u30a4\u30b9\u6587\u5b57\u306e\u5f8c\u308d\u306b\u7a7a\u767d\u3092\u5165\u308c\u3066\u767a\u8a00\u3059\u308b\u4e8b\u3082\u53ef\u80fd\u3002\n\u4ee5\u4e0b\u3001\u4f7f\u7528\u4f8b\n\u30003D6+1>=9 \uff1a3d6+1\u3067\u76ee\u6a19\u50249\u4ee5\u4e0a\u304b\u306e\u5224\u5b9a\n\u30001D100<=50 \uff1aD100\u306750\uff05\u76ee\u6a19\u306e\u4e0b\u65b9\u30ed\u30fc\u30eb\u306e\u4f8b\n\u30003U6[5] \uff1a3d6\u306e\u30c0\u30a4\u30b9\u76ee\u304c5\u4ee5\u4e0a\u306e\u5834\u5408\u306b\u632f\u308a\u8db3\u3057\u3057\u3066\u5408\u8a08\u3059\u308b(\u4e0a\u65b9\u7121\u9650)\n\u30003B6 \uff1a3d6\u306e\u30c0\u30a4\u30b9\u76ee\u3092\u30d0\u30e9\u30d0\u30e9\u306e\u307e\u307e\u51fa\u529b\u3059\u308b\uff08\u5408\u8a08\u3057\u306a\u3044\uff09\n\u300010B6>=4 \uff1a10d6\u3092\u632f\u308a4\u4ee5\u4e0a\u306e\u30c0\u30a4\u30b9\u76ee\u306e\u500b\u6570\u3092\u6570\u3048\u308b\n\u3000(8/2)D(4+6)<=(5*3)\uff1a\u500b\u6570\u30fb\u30c0\u30a4\u30b9\u30fb\u9054\u6210\u5024\u306b\u306f\u56db\u5247\u6f14\u7b97\u3082\u4f7f\u7528\u53ef\u80fd\n\u3000C(10-4*3/2+2)\uff1aC(\u8a08\u7b97\u5f0f\uff09\u3067\u8a08\u7b97\u3060\u3051\u306e\u5b9f\u884c\u3082\u53ef\u80fd\n\u3000choice[a,b,c]\uff1a\u5217\u6319\u3057\u305f\u8981\u7d20\u304b\u3089\u4e00\u3064\u3092\u9078\u629e\u8868\u793a\u3002\u30e9\u30f3\u30c0\u30e0\u653b\u6483\u5bfe\u8c61\u6c7a\u5b9a\u306a\u3069\u306b\n\u3000S3d6 \uff1a \u5404\u30b3\u30de\u30f3\u30c9\u306e\u5148\u982d\u306b\u300cS\u300d\u3092\u4ed8\u3051\u308b\u3068\u4ed6\u4eba\u306b\u7d50\u679c\u306e\u898b\u3048\u306a\u3044\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ed\u30fc\u30eb\n\u30003d6/2 \uff1a \u30c0\u30a4\u30b9\u51fa\u76ee\u3092\u5272\u308a\u7b97\uff08\u5207\u308a\u6368\u3066\uff09\u3002\u5207\u308a\u4e0a\u3052\u306f /2U\u3001\u56db\u6368\u4e94\u5165\u306f /2R\u3002\n\u3000D66 \uff1a D66\u30c0\u30a4\u30b9\u3002\u9806\u5e8f\u306f\u30b2\u30fc\u30e0\u306b\u4f9d\u5b58\u3002D66N\uff1a\u305d\u306e\u307e\u307e\u3001D66S\uff1a\u6607\u9806\u3002"];try{let n=Opal.CgiDiceBot.$new().$newBcDice();n.$setGameByTitle(e);const i=n.diceBot.$getHelpMessage();i&&t.push(i)}catch(n){console.error(n)}return t})}static loadDiceBotAsync(e){return new Promise((t,n)=>{if(console.log("loadDiceBotAsync"),!(e=e.replace(/\./g,e=>"_"))&&e.length<1||vv.loadedDiceBots[e])return console.log(e+" is loaded"),void t();vv.loadedDiceBots[e]=!1;let i=[];i.push(vv.loadScriptAsync("./assets/dicebot/"+e+".js"));for(let r of vv.extratablesTables)r.indexOf(e)||i.push(vv.loadExtratablesAsync("./assets/extratables/"+r,r));Promise.all(i).then(()=>{vv.loadedDiceBots[e]=!0,t()})})}static loadScriptAsync(e){return new Promise((t,n)=>{let i=document.head,r=document.createElement("script");r.src=e,i.appendChild(r),r.onload=n=>{i&&r.parentNode&&i.removeChild(r),console.log(e+" is loading OK!!!"),t()},r.onabort=r.onerror=e=>{i&&r.parentNode&&i.removeChild(r),console.error(e),t()}})}static loadExtratablesAsync(e,t){return new Promise((n,i)=>{fetch(e).then(e=>{if(e.ok)return e.text();throw new Error("Network response was not ok.")}).then(e=>{let i=/((.+)_(.+)).txt$/gi.exec(t);Opal.TableFileData.$setVirtualTableData(i[1],i[2],i[3],e),console.log(t+" is loading OK!!!"),n()}).catch(e=>{console.warn("There has been a problem with your fetch operation: ",e.message),n()})})}};return e.loadedDiceBots={},e.queue=new iv("DiceBotQueue"),e.apiUrl=null,e.adminUrl=null,e.diceBotInfos=[{script:"EarthDawn",game:"\u30a2\u30fc\u30b9\u30c9\u30fc\u30f3"},{script:"EarthDawn3",game:"\u30a2\u30fc\u30b9\u30c9\u30fc\u30f33\u7248"},{script:"EarthDawn4",game:"\u30a2\u30fc\u30b9\u30c9\u30fc\u30f34\u7248"},{script:"Airgetlamh",game:"\u6731\u306e\u5b64\u5854\u306e\u30a8\u30a2\u30b2\u30c8\u30e9\u30e0"},{script:"AFF2e",game:"ADVANCED FIGHTING FANTASY 2nd Edition"},{script:"AnimaAnimus",game:"\u30a2\u30cb\u30de\u30a2\u30cb\u30e0\u30b9"},{script:"Amadeus",game:"\u30a2\u30de\u30c7\u30a6\u30b9"},{script:"Arianrhod",game:"\u30a2\u30ea\u30a2\u30f3\u30ed\u30c3\u30c9RPG"},{script:"OrgaRain",game:"\u5728\u308a\u3066\u904d\u304f\u30aa\u30eb\u30ac\u30ec\u30a4\u30f3"},{script:"Alshard",game:"\u30a2\u30eb\u30b7\u30e3\u30fc\u30c9"},{script:"ArsMagica",game:"\u30a2\u30eb\u30b9\u30de\u30ae\u30ab"},{script:"AlterRaise",game:"\u30a2\u30eb\u30c8\u30ec\u30a4\u30ba"},{script:"IthaWenUa",game:"\u30a4\u30b5\u30fc\u30fb\u30a6\u30a7\u30f3\uff1d\u30a2\u30fc"},{script:"YearZeroEngine",game:"YearZeroEngine"},{script:"Insane",game:"\u30a4\u30f3\u30bb\u30a4\u30f3"},{script:"VampireTheMasquerade5th",game:"Vampire: The Masquerade 5th Edition"},{script:"WitchQuest",game:"\u30a6\u30a3\u30c3\u30c1\u30af\u30a8\u30b9\u30c8"},{script:"Warhammer",game:"\u30a6\u30a9\u30fc\u30cf\u30f3\u30de\u30fc"},{script:"Utakaze",game:"\u30a6\u30bf\u30ab\u30bc"},{script:"Alsetto",game:"\u8a69\u7247\u306e\u30a2\u30eb\u30bb\u30c3\u30c8"},{script:"AceKillerGene",game:"\u30a8\u30fc\u30b9\u30ad\u30e9\u30fc\u30b8\u30fc\u30f3"},{script:"EclipsePhase",game:"\u30a8\u30af\u30ea\u30d7\u30b9\u30fb\u30d5\u30a7\u30a4\u30ba"},{script:"EmbryoMachine",game:"\u30a8\u30e0\u30d6\u30ea\u30aa\u30de\u30b7\u30f3RPG"},{script:"Elysion",game:"\u30a8\u30ea\u30e5\u30b7\u30aa\u30f3"},{script:"Elric",game:"\u30a8\u30eb\u30ea\u30c3\u30af\uff01"},{script:"EndBreaker",game:"\u30a8\u30f3\u30c9\u30d6\u30ec\u30a4\u30ab\u30fc\uff01"},{script:"Oukahoushin3rd",game:"\u592e\u83ef\u5c01\u795eRPG \u7b2c\u4e09\u7248"},{script:"OracleEngine",game:"\u30aa\u30e9\u30af\u30eb\u30a8\u30f3\u30b8\u30f3"},{script:"GardenOrder",game:"\u30ac\u30fc\u30c7\u30f3\u30aa\u30fc\u30c0\u30fc"},{script:"CardRanker",game:"\u30ab\u30fc\u30c9\u30e9\u30f3\u30ab\u30fc"},{script:"Gurps",game:"\u30ac\u30fc\u30d7\u30b9"},{script:"GurpsFW",game:"\u30ac\u30fc\u30d7\u30b9\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba"},{script:"ChaosFlare",game:"\u30ab\u30aa\u30b9\u30d5\u30ec\u30a2"},{script:"OneWayHeroics",game:"\u7247\u9053\u52c7\u8005TRPG"},{script:"Kamigakari",game:"\u795e\u6211\u72e9"},{script:"Garako",game:"\u30ac\u30e9\u30b3\u3068\u7834\u754c\u306e\u5854"},{script:"KanColle",game:"\u8266\u3053\u308cRPG"},{script:"Gundog",game:"\u30ac\u30f3\u30c9\u30c3\u30b0"},{script:"GundogZero",game:"\u30ac\u30f3\u30c9\u30c3\u30b0\u30bc\u30ed"},{script:"GundogRevised",game:"\u30ac\u30f3\u30c9\u30c3\u30b0\u30fb\u30ea\u30f4\u30a1\u30a4\u30ba\u30c9"},{script:"KillDeathBusiness",game:"\u30ad\u30eb\u30c7\u30b9\u30d3\u30b8\u30cd\u30b9"},{script:"StellarKnights",game:"\u9280\u5263\u306e\u30b9\u30c6\u30e9\u30ca\u30a4\u30c4"},{script:"Cthulhu",game:"\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG"},{script:"CthulhuTech",game:"\u30af\u30c8\u30a5\u30eb\u30d5\u30c6\u30c3\u30af"},{script:"KurayamiCrying",game:"\u30af\u30e9\u30e4\u30df\u30af\u30e9\u30a4\u30f3"},{script:"GranCrest",game:"\u30b0\u30e9\u30f3\u30af\u30ec\u30b9\u30c8RPG"},{script:"GeishaGirlwithKatana",game:"\u30b2\u30a4\u30b7\u30e3\u30fb\u30ac\u30fc\u30eb\u30fb\u30a6\u30a3\u30ba\u30fb\u30ab\u30bf\u30ca"},{script:"GehennaAn",game:"\u30b2\u30d8\u30ca\u30fb\u30a2\u30ca\u30b9\u30bf\u30b7\u30b9"},{script:"KemonoNoMori",game:"\u7378\u30ce\u68ee"},{script:"Illusio",game:"\u6643\u5929\u306e\u30a4\u30eb\u30fc\u30b8\u30aa"},{script:"CodeLayerd",game:"\u30b3\u30fc\u30c9\uff1a\u30ec\u30a4\u30e4\u30fc\u30c9"},{script:"Avandner",game:"\u9ed2\u7d62\u306e\u30a2\u30f4\u30a1\u30f3\u30c9\u30ca\u30fc"},{script:"GoblinSlayer",game:"\u30b4\u30d6\u30ea\u30f3\u30b9\u30ec\u30a4\u30e4\u30fcTRPG"},{script:"Gorilla",game:"\u30b4\u30ea\u30e9TRPG"},{script:"ColossalHunter",game:"\u30b3\u30ed\u30c3\u30b5\u30eb\u30cf\u30f3\u30bf\u30fc"},{script:"Postman",game:"\u58ca\u308c\u305f\u4e16\u754c\u306e\u30dd\u30b9\u30c8\u30de\u30f3"},{script:"Satasupe",game:"\u30b5\u30bf\u30b9\u30da"},{script:"SamsaraBallad",game:"\u30b5\u30f3\u30b5\u30fc\u30e9\u30fb\u30d0\u30e9\u30c3\u30c9"},{script:"SharedFantasia",game:"Shared\u2020Fantasia"},{script:"JamesBond",game:"\u30b8\u30a7\u30fc\u30e0\u30ba\u30fb\u30dc\u30f3\u30c9007"},{script:"LiveraDoll",game:"\u7d2b\u7e1e\u306e\u30ea\u30f4\u30e9\u30c9\u30fc\u30eb"},{script:"ShinobiGami",game:"\u30b7\u30ce\u30d3\u30ac\u30df"},{script:"ShadowRun",game:"\u30b7\u30e3\u30c9\u30a6\u30e9\u30f3"},{script:"ShadowRun4",game:"\u30b7\u30e3\u30c9\u30a6\u30e9\u30f3 4th Edition"},{script:"ShadowRun5",game:"\u30b7\u30e3\u30c9\u30a6\u30e9\u30f3 5th Edition"},{script:"ShoujoTenrankai",game:"\u5c11\u5973\u5c55\u721b\u4f1aTRPG"},{script:"ShinkuuGakuen",game:"\u771f\u7a7a\u5b66\u5712"},{script:"Cthulhu7th",game:"\u65b0\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG"},{script:"ShinMegamiTenseiKakuseihen",game:"\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG \u899a\u9192\u7bc7"},{script:"Skynauts",game:"\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb"},{script:"ScreamHighSchool",game:"\u30b9\u30af\u30ea\u30fc\u30e0\u30cf\u30a4\u30b9\u30af\u30fc\u30eb"},{script:"SRS",game:"\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0"},{script:"SteamPunkers",game:"\u30b9\u30c1\u30fc\u30e0\u30d1\u30f3\u30ab\u30fc\u30ba"},{script:"SterileLife",game:"\u30b9\u30c6\u30e9\u30fc\u30e9\u30a4\u30d5TRPG"},{script:"StratoShout",game:"\u30b9\u30c8\u30e9\u30c8\u30b7\u30e3\u30a6\u30c8"},{script:"TherapieSein",game:"\u30bb\u30e9\u30d5\u30a3\u30b6\u30a4\u30f3"},{script:"EtrianOdysseySRS",game:"\u4e16\u754c\u6a39\u306e\u8ff7\u5baeSRS"},{script:"ZettaiReido",game:"\u7d76\u5bfe\u96b7\u5974"},{script:"SevenFortressMobius",game:"\u30bb\u30d6\u30f3\uff1d\u30d5\u30a9\u30fc\u30c8\u30ec\u30b9 \u30e1\u30d3\u30a6\u30b9"},{script:"Villaciel",game:"\u84bc\u5929\u306e\u30f4\u30a3\u30e9\u30b7\u30a8\u30eb"},{script:"SwordWorld",game:"\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c9RPG"},{script:"SwordWorld2_0",game:"\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.0"},{script:"SwordWorld2_5",game:"\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.5"},{script:"DarkSouls",game:"\u30c0\u30fc\u30af\u30bd\u30a6\u30ebTRPG"},{script:"DarkDaysDrive",game:"\u30c0\u30fc\u30af\u30c7\u30a4\u30ba\u30c9\u30e9\u30a4\u30d6"},{script:"DarkBlaze",game:"\u30c0\u30fc\u30af\u30d6\u30ec\u30a4\u30ba"},{script:"DiceOfTheDead",game:"\u30c0\u30a4\u30b9\u30fb\u30aa\u30d6\u30fb\u30b6\u30fb\u30c7\u30c3\u30c9"},{script:"DoubleCross",game:"\u30c0\u30d6\u30eb\u30af\u30ed\u30b92nd, 3rd"},{script:"DungeonsAndDragons",game:"\u30c0\u30f3\u30b8\u30e7\u30f3\u30ba\uff06\u30c9\u30e9\u30b4\u30f3\u30ba"},{script:"Paradiso",game:"\u30c1\u30a7\u30ec\u30b9\u30c6\u8272\u306e\u30d1\u30e9\u30c7\u30a3\u30fc\u30be"},{script:"StrangerOfSwordCity",game:"\u5263\u306e\u8857\u306e\u7570\u90a6\u4ebaTRPG"},{script:"Chill",game:"Chill"},{script:"Chill3",game:"Chill 3rd Edition"},{script:"CrashWorld",game:"\u589c\u843d\u4e16\u754c"},{script:"DetatokoSaga",game:"\u3067\u305f\u3068\u3053\u30b5\u30fc\u30ac"},{script:"DeadlineHeroes",game:"\u30c7\u30c3\u30c9\u30e9\u30a4\u30f3\u30d2\u30fc\u30ed\u30fc\u30baRPG"},{script:"DemonParasite",game:"\u30c7\u30e2\u30f3\u30d1\u30e9\u30b5\u30a4\u30c8"},{script:"TokyoGhostResearch",game:"\u6771\u4eac\u30b4\u30fc\u30b9\u30c8\u30ea\u30b5\u30fc\u30c1"},{script:"TokyoNova",game:"\u30c8\u30fc\u30ad\u30e7\u30fcN\u25ceVA"},{script:"Torg",game:"\u30c8\u30fc\u30b0"},{script:"Torg1_5",game:"\u30c8\u30fc\u30b01.5\u7248"},{script:"TorgEternity",game:"TORG Eternity"},{script:"TokumeiTenkousei",game:"\u7279\u547d\u8ee2\u653b\u751f"},{script:"Dracurouge",game:"\u30c9\u30e9\u30af\u30eb\u30fc\u30b8\u30e5"},{script:"TrinitySeven",game:"\u30c8\u30ea\u30cb\u30c6\u30a3\u30bb\u30d6\u30f3RPG"},{script:"TwilightGunsmoke",game:"\u30c8\u30ef\u30a4\u30e9\u30a4\u30c8\u30ac\u30f3\u30b9\u30e2\u30fc\u30af"},{script:"TunnelsAndTrolls",game:"\u30c8\u30f3\u30cd\u30eb\u30ba\uff06\u30c8\u30ed\u30fc\u30eb\u30ba"},{script:"NightWizard",game:"\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 2nd Edition"},{script:"NightWizard3rd",game:"\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 3rd Edition"},{script:"NightmareHunterDeep",game:"\u30ca\u30a4\u30c8\u30e1\u30a2\u30cf\u30f3\u30bf\u30fc\uff1d\u30c7\u30a3\u30fc\u30d7"},{script:"NinjaSlayer",game:"\u30cb\u30f3\u30b8\u30e3\u30b9\u30ec\u30a4\u30e4\u30fcTRPG"},{script:"NjslyrBattle",game:"NJSLYRBATTLE"},{script:"Nuekagami",game:"\u9d7a\u93e1"},{script:"Nechronica",game:"\u30cd\u30af\u30ed\u30cb\u30ab"},{script:"NeverCloud",game:"\u30cd\u30d0\u30fc\u30af\u30e9\u30a6\u30c9TRPG"},{script:"HarnMaster",game:"\u30cf\u30fc\u30f3\u30de\u30b9\u30bf\u30fc"},{script:"Pathfinder",game:"Pathfinder"},{script:"BadLife",game:"\u30d0\u30c3\u30c9\u30e9\u30a4\u30d5"},{script:"HatsuneMiku",game:"\u521d\u97f3\u30df\u30afTRPG \u30b3\u30b3\u30ed\u30c0\u30f3\u30b8\u30e7\u30f3"},{script:"BattleTech",game:"\u30d0\u30c8\u30eb\u30c6\u30c3\u30af"},{script:"ParasiteBlood",game:"\u30d1\u30e9\u30b5\u30a4\u30c8\u30d6\u30e9\u30c3\u30c9RPG"},{script:"Paranoia",game:"\u30d1\u30e9\u30ce\u30a4\u30a2"},{script:"ParanoiaRebooted",game:"\u30d1\u30e9\u30ce\u30a4\u30a2 \u30ea\u30d6\u30fc\u30c6\u30c3\u30c9"},{script:"BarnaKronika",game:"\u30d0\u30eb\u30ca\u30fb\u30af\u30ed\u30cb\u30ab"},{script:"PulpCthulhu",game:"\u30d1\u30eb\u30d7\u30fb\u30af\u30c8\u30a5\u30eb\u30d5"},{script:"Raisondetre",game:"\u53db\u9006\u30ec\u30be\u30f3\u30c7\u30fc\u30c8\u30eb"},{script:"HuntersMoon",game:"\u30cf\u30f3\u30bf\u30fc\u30ba\u30fb\u30e0\u30fc\u30f3"},{script:"Peekaboo",game:"\u30d4\u30fc\u30ab\u30fc\u30d6\u30fc"},{script:"BeastBindTrinity",game:"\u30d3\u30fc\u30b9\u30c8\u30d0\u30a4\u30f3\u30c9 \u30c8\u30ea\u30cb\u30c6\u30a3"},{script:"BBN",game:"BBNTRPG"},{script:"Hieizan",game:"\u6bd4\u53e1\u5c71\u708e\u4e0a"},{script:"BeginningIdol",game:"\u30d3\u30ae\u30cb\u30f3\u30b0\u30a2\u30a4\u30c9\u30eb"},{script:"PhantasmAdventure",game:"\u30d5\u30a1\u30f3\u30bf\u30ba\u30e0\u30fb\u30a2\u30c9\u30d9\u30f3\u30c1\u30e3\u30fc"},{script:"Fiasco",game:"\u30d5\u30a3\u30a2\u30b9\u30b3"},{script:"FilledWith",game:"\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba"},{script:"FutariSousa",game:"\u30d5\u30bf\u30ea\u30bd\u30a6\u30b5"},{script:"BlindMythos",game:"\u30d6\u30e9\u30a4\u30f3\u30c9\u30fb\u30df\u30c8\u30b9RPG"},{script:"BloodCrusade",game:"\u30d6\u30e9\u30c3\u30c9\u30fb\u30af\u30eb\u30bb\u30a4\u30c9"},{script:"BloodMoon",game:"\u30d6\u30e9\u30c3\u30c9\u30fb\u30e0\u30fc\u30f3"},{script:"FullMetalPanic",game:"\u30d5\u30eb\u30e1\u30bf\u30eb\u30fb\u30d1\u30cb\u30c3\u30af\uff01RPG"},{script:"BladeOfArcana",game:"\u30d6\u30ec\u30a4\u30c9\u30fb\u30aa\u30d6\u30fb\u30a2\u30eb\u30ab\u30ca"},{script:"Strave",game:"\u78a7\u7a7a\u306e\u30b9\u30c8\u30ec\u30a4\u30f4"},{script:"Pendragon",game:"\u30da\u30f3\u30c9\u30e9\u30b4\u30f3"},{script:"HouraiGakuen",game:"\u84ec\u83b1\u5b66\u5712\u306e\u5192\u967a!!"},{script:"MagicaLogia",game:"\u30de\u30ae\u30ab\u30ed\u30ae\u30a2"},{script:"InfiniteFantasia",game:"\u7121\u9650\u306e\u30d5\u30a1\u30f3\u30bf\u30b8\u30a2"},{script:"MeikyuKingdom",game:"\u8ff7\u5bae\u30ad\u30f3\u30b0\u30c0\u30e0"},{script:"MeikyuKingdomBasic",game:"\u8ff7\u5bae\u30ad\u30f3\u30b0\u30c0\u30e0 \u57fa\u672c\u30eb\u30fc\u30eb\u30d6\u30c3\u30af"},{script:"MeikyuDays",game:"\u8ff7\u5bae\u30c7\u30a4\u30ba"},{script:"MetallicGuardian",game:"\u30e1\u30bf\u30ea\u30c3\u30af\u30ac\u30fc\u30c7\u30a3\u30a2\u30f3RPG"},{script:"MetalHead",game:"\u30e1\u30bf\u30eb\u30d8\u30c3\u30c9"},{script:"MetalHeadExtream",game:"\u30e1\u30bf\u30eb\u30d8\u30c3\u30c9\u30a8\u30af\u30b9\u30c8\u30ea\u30fc\u30e0"},{script:"MonotoneMuseum",game:"\u30e2\u30ce\u30c8\u30fc\u30f3\u30df\u30e5\u30fc\u30b8\u30a2\u30e0RPG"},{script:"YankeeYogSothoth",game:"\u30e4\u30f3\u30ad\u30fc\uff06\u30e8\u30b0\uff1d\u30bd\u30c8\u30fc\u30b9"},{script:"GoldenSkyStories",game:"\u3086\u3046\u3084\u3051\u3053\u3084\u3051"},{script:"Ryutama",game:"\u308a\u3085\u3046\u305f\u307e"},{script:"RyuTuber",game:"\u30ea\u30e5\u30fc\u30c1\u30e5\u30fc\u30d0\u30fc\u3068\u3061\u3044\u3055\u306a\u5947\u8de1"},{script:"RuneQuest",game:"\u30eb\u30fc\u30f3\u30af\u30a8\u30b9\u30c8"},{script:"RecordOfSteam",game:"Record of Steam"},{script:"RecordOfLodossWar",game:"\u30ed\u30fc\u30c9\u30b9\u5cf6\u6226\u8a18RPG"},{script:"RoleMaster",game:"\u30ed\u30fc\u30eb\u30de\u30b9\u30bf\u30fc"},{script:"LogHorizon",game:"\u30ed\u30b0\u30fb\u30db\u30e9\u30a4\u30ba\u30f3TRPG"},{script:"RokumonSekai2",game:"\u516d\u9580\u4e16\u754cRPG \u30bb\u30ab\u30f3\u30c9\u30a8\u30c7\u30a3\u30b7\u30e7\u30f3"},{script:"LostRecord",game:"\u30ed\u30b9\u30c8\u30ec\u30b3\u30fc\u30c9"},{script:"LostRoyal",game:"\u30ed\u30b9\u30c8\u30ed\u30a4\u30e4\u30eb"},{script:"WaresBlade",game:"\u30ef\u30fc\u30b9\u30d6\u30ec\u30a4\u30c9"},{script:"WARPS",game:"\u30ef\u30fc\u30d7\u30b9"},{script:"WorldOfDarkness",game:"\u30ef\u30fc\u30eb\u30c9\u30fb\u30aa\u30d6\u30fb\u30c0\u30fc\u30af\u30cd\u30b9"},{script:"Cthulhu_ChineseTraditional",game:"\u514b\u8607\u9b6f\u7684\u547c\u559a",lang:"\u6b63\u9ad4\u4e2d\u6587"},{script:"Cthulhu7th_ChineseTraditional",game:"\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c\u4e03\u7248",lang:"\u6b63\u9ad4\u4e2d\u6587"},{script:"KillDeathBusiness_Korean",game:"Kill Death Business (\ud55c\uad6d\uc5b4)",lang:"\ud55c\uad6d\uc5b4"},{script:"Nechronica_Korean",game:"\ub124\ud06c\ub85c\ub2c8\uce74",lang:"\ud55c\uad6d\uc5b4"},{script:"DoubleCross_Korean",game:"\ub354\ube14\ud06c\ub85c\uc2a42nd, 3rd",lang:"\ud55c\uad6d\uc5b4"},{script:"DetatokoSaga_Korean",game:"\ub370\ud0c0\ud1a0\ucf54 \uc0ac\uac00",lang:"\ud55c\uad6d\uc5b4"},{script:"FutariSousa_Korean",game:"\ub458\uc774\uc11c \uc218\uc0ac(\ud6c4\ud0c0\ub9ac\uc18c\uc6b0\uc0ac)",lang:"\ud55c\uad6d\uc5b4"},{script:"Dracurouge_Korean",game:"\ub4dc\ub77c\ud06c\ub8e8\uc8fc",lang:"\ud55c\uad6d\uc5b4"},{script:"LogHorizon_Korean",game:"\ub85c\uadf8 \ud638\ub77c\uc774\uc98c",lang:"\ud55c\uad6d\uc5b4"},{script:"MonotoneMuseum_Korean",game:"\ubaa8\ub178\ud1a4 \ubba4\uc9c0\uc5c4",lang:"\ud55c\uad6d\uc5b4"},{script:"BeginningIdol_Korean",game:"\ube44\uae30\ub2dd \uc544\uc774\ub3cc",lang:"\ud55c\uad6d\uc5b4"},{script:"StratoShout_Korean",game:"\uc2a4\ud2b8\ub77c\ud1a0 \uc0e4\uc6b0\ud2b8",lang:"\ud55c\uad6d\uc5b4"},{script:"Amadeus_Korean",game:"\uc544\ub9c8\ub370\uc6b0\uc2a4",lang:"\ud55c\uad6d\uc5b4"},{script:"Insane_Korean",game:"\uc778\uc138\uc778",lang:"\ud55c\uad6d\uc5b4"},{script:"Kamigakari_Korean",game:"\uce74\ubbf8\uac00\uce74\ub9ac",lang:"\ud55c\uad6d\uc5b4"},{script:"Cthulhu7th_Korean",game:"\ud06c\ud234\ub8e8\uc758 \ubd80\ub984 7\ud310",lang:"\ud55c\uad6d\uc5b4"},{script:"Cthulhu_Korean",game:"\ud06c\ud234\ub8e8",lang:"\ud55c\uad6d\uc5b4"},{script:"Fiasco_Korean",game:"\ud53c\uc544\uc2a4\ucf54",lang:"\ud55c\uad6d\uc5b4"}],e.diceBotInfosIndexed=[],e.extratablesTables=["BloodCrusade_TD2T.txt","BloodCrusade_TD3T.txt","BloodCrusade_TD4T.txt","BloodCrusade_TD5T.txt","BloodCrusade_TD6T.txt","BloodCrusade_TDHT.txt","BloodMoon_ID2T.txt","BloodMoon_IDT.txt","BloodMoon_RAT.txt","CardRanker_BFT.txt","CardRanker_CDT.txt","CardRanker_CST.txt","CardRanker_DT.txt","CardRanker_GDT.txt","CardRanker_OST.txt","CardRanker_SST.txt","CardRanker_ST.txt","CardRanker_TDT.txt","CardRanker_WT.txt","Elysion_EBT.txt","Elysion_GIT.txt","Elysion_HBT.txt","Elysion_HT.txt","Elysion_IT.txt","Elysion_JH.txt","Elysion_KT.txt","Elysion_NA.txt","Elysion_NT.txt","Elysion_OJ1.txt","Elysion_OJ2.txt","Elysion_TBT.txt","Elysion_UBT.txt","Elysion_UT1.txt","Elysion_UT2.txt","Elysion_UT3.txt","Elysion_UT4.txt","HuntersMoon_DS1ET.txt","HuntersMoon_DS2ET.txt","HuntersMoon_DS3ET.txt","HuntersMoon_EE1ET.txt","HuntersMoon_EE2ET.txt","HuntersMoon_EE3ET.txt","HuntersMoon_ERT.txt","HuntersMoon_ET1ET.txt","HuntersMoon_ET2ET.txt","HuntersMoon_ET3ET.txt","HuntersMoon_MST.txt","HuntersMoon_TK1ET.txt","HuntersMoon_TK2ET.txt","HuntersMoon_TK3ET.txt","Kamigakari_ET.txt","Kamigakari_KT.txt","Kamigakari_NT.txt","KanColle_BT2.txt","KanColle_BT3.txt","KanColle_BT4.txt","KanColle_BT5.txt","KanColle_BT6.txt","KanColle_BT7.txt","KanColle_BT8.txt","KanColle_BT9.txt","KanColle_BT10.txt","KanColle_BT11.txt","KanColle_BT12.txt","KanColle_ETIT.txt","KanColle_LFDT.txt","KanColle_LFVT.txt","KanColle_LSFT.txt","KanColle_WPCN.txt","KanColle_WPFA.txt","KanColle_WPMC.txt","KanColle_WPMCN.txt","KillDeathBusiness_ANSPT.txt","KillDeathBusiness_MASPT.txt","KillDeathBusiness_MOSPT.txt","KillDeathBusiness_PASPT.txt","KillDeathBusiness_POSPT.txt","KillDeathBusiness_UMSPT.txt","Oukahoushin3rd_BKT.txt","Oukahoushin3rd_KKT.txt","Oukahoushin3rd_NHT.txt","Oukahoushin3rd_SDT.txt","Oukahoushin3rd_SKT.txt","Oukahoushin3rd_STT.txt","Oukahoushin3rd_UKT.txt","ShinobiGami_AKST.txt","ShinobiGami_CLST.txt","ShinobiGami_DXST.txt","ShinobiGami_HC.txt","ShinobiGami_HK.txt","ShinobiGami_HLST.txt","ShinobiGami_HM.txt","ShinobiGami_HO.txt","ShinobiGami_HR.txt","ShinobiGami_HS.txt","ShinobiGami_HT.txt","ShinobiGami_HY.txt","ShinobiGami_NTST.txt","ShinobiGami_OTKRT.txt","ShinobiGami_PLST.txt","BloodCrusade_BDST.txt","BloodCrusade_CYST.txt","BloodCrusade_DMST.txt","BloodCrusade_MNST.txt","BloodCrusade_SLST.txt","BloodCrusade_TD1T.txt"],e.replaceData=[["\u65b0\u30af\u30c8\u30a5\u30eb\u30d5","\u30b7\u30f3\u30af\u30c8\u30a6\u30eb\u30d5\u30b7\u30f3\u30efTRPG","\u65b0\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG"],["\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG","\u30af\u30c8\u30a6\u30eb\u30d5\u30b7\u30f3\u30efTRPG","(\u65e7) \u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG"],["\u514b\u8607\u9b6f\u795e\u8a71","\u514b\u8607\u9b6f\u7684\u547c\u559a","\u514b\u8607\u9b6f\u7684\u547c\u559a"],["\u514b\u8607\u9b6f\u795e\u8a71\u7b2c7\u7248","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c\u4e03\u7248","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c\u4e03\u7248"],["\u30c8\u30fc\u30b0","\u30c8\u30aa\u30af","TORG"],["\u30ef\u30fc\u30d7\u30b9","\u30ef\u30a2\u30d5\u30b9","WARPS"],["\u30c8\u30fc\u30b01.5\u7248","\u30c8\u30aa\u30af1.5\u30cf\u30f3","TORG 1.5\u7248"],["\u5fc3\u885d\u60f3\u6a5fTRPG\u30a2\u30eb\u30c8\u30ec\u30a4\u30ba","\u30b7\u30f3\u30b7\u30e8\u30a6\u30bd\u30a6\u30adTRPG\u30a2\u30eb\u30c8\u30ec\u30a4\u30b9","\u5fc3\u885d\u60f3\u6a5fTRPG \u30a2\u30eb\u30c8\u30ec\u30a4\u30ba"],["\u72af\u7f6a\u6d3b\u5287RPG\u30d0\u30c3\u30c9\u30e9\u30a4\u30d5","\u30cf\u30f3\u30b5\u30a4\u30ab\u30c4\u30b1\u30adRPG\u30cf\u30c4\u30c8\u30e9\u30a4\u30d5","\u72af\u7f6a\u6d3b\u5287RPG\u30d0\u30c3\u30c9\u30e9\u30a4\u30d5"],["\u6643\u5929\u306e\u30a4\u30eb\u30fc\u30b8\u30aa","\u30b3\u30a6\u30c6\u30f3\u30ce\u30a4\u30eb\u30a6\u30b7\u30aa","\u6643\u5929\u306e\u30a4\u30eb\u30fc\u30b8\u30aa"],["\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb","\u30cf\u30af\u30eb\u30de\u30ce\u30c8\u30a6\u30ce\u30b9\u30ab\u30a4\u30ce\u30aa\u30c4","\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb"],["\u5728\u308a\u3066\u904d\u304f\u30aa\u30eb\u30ac\u30ec\u30a4\u30f3","\u30a2\u30ea\u30c6\u30a2\u30de\u30cd\u30af\u30aa\u30eb\u30ab\u30ec\u30a4\u30f3","\u5728\u308a\u3066\u904d\u304f\u30aa\u30eb\u30ac\u30ec\u30a4\u30f3"],["Pathfinder","\u30cf\u30b9\u30d5\u30a2\u30a4\u30f3\u30bf\u30a2RPG","\u30d1\u30b9\u30d5\u30a1\u30a4\u30f3\u30c0\u30fcRPG"],["\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG\u3000\u899a\u9192\u7de8","\u30b7\u30f3\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4TRPG\u30ab\u30af\u30bb\u30a4\u30d8\u30f3","\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG \u899a\u9192\u7bc7"],["\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG\u3000\u899a\u9192\u7bc7","\u30b7\u30f3\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4TRPG\u30ab\u30af\u30bb\u30a4\u30d8\u30f3","\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG \u899a\u9192\u7bc7"],["YearZeroEngine","\u30a4\u30e4\u30a2\u30bb\u30ed\u30a8\u30f3\u30b7\u30f3","Year Zero Engine"],["Year Zero Engine","\u30a4\u30e4\u30a2\u30bb\u30ed\u30a8\u30f3\u30b7\u30f3","Year Zero Engine"],["ADVANCED FIGHTING FANTASY 2nd Edition","\u30a2\u30c8\u30cf\u30f3\u30b9\u30c8\u30d5\u30a1\u30a4\u30c6\u30a4\u30f3\u30af\u30d5\u30a1\u30f3\u30bf\u30b7\u30a4\u30bf\u30a42\u30cf\u30f3","\u30a2\u30c9\u30d0\u30f3\u30b9\u30c8\u30fb\u30d5\u30a1\u30a4\u30c6\u30a3\u30f3\u30b0\u30fb\u30d5\u30a1\u30f3\u30bf\u30b8\u30fc \u7b2c2\u7248"],["Vampire: The Masquerade 5th Edition","\u30a6\u30a2\u30f3\u30cf\u30a4\u30a2\u30b5\u30de\u30b9\u30ab\u30ec\u30a8\u30c8\u30bf\u30a45\u30cf\u30f3","\u30f4\u30a1\u30f3\u30d1\u30a4\u30a2\uff1a\u30b6\u30fb\u30de\u30b9\u30ab\u30ec\u30fc\u30c9 \u7b2c5\u7248"],["\u30ef\u30fc\u30eb\u30c9\u30aa\u30d6\u30c0\u30fc\u30af\u30cd\u30b9","\u30ef\u30a2\u30eb\u30c8\u30aa\u30d5\u30bf\u30a2\u30af\u30cd\u30b9","\u30ef\u30fc\u30eb\u30c9\u30fb\u30aa\u30d6\u30fb\u30c0\u30fc\u30af\u30cd\u30b9"],["\u30e2\u30ce\u30c8\u30fc\u30f3\u30fb\u30df\u30e5\u30fc\u30b8\u30a2\u30e0","\u30e2\u30ce\u30c8\u30aa\u30f3\u30df\u30e6\u30a6\u30b7\u30a2\u30e0","\u30e2\u30ce\u30c8\u30fc\u30f3\u30df\u30e5\u30fc\u30b8\u30a2\u30e0"],["\u5263\u306e\u8857\u306e\u7570\u90a6\u4ebaTRPG","\u30c4\u30eb\u30ad\u30ce\u30de\u30c1\u30ce\u30a4\u30db\u30a6\u30b7\u30f3TRPG"],["\u58ca\u308c\u305f\u4e16\u754c\u306e\u30dd\u30b9\u30c8\u30de\u30f3","\u30b3\u30ef\u30ec\u30bf\u30bb\u30ab\u30a4\u30ce\u30db\u30b9\u30c8\u30de\u30f3","\u58ca\u308c\u305f\u4e16\u754c\u306e\u30dd\u30b9\u30c8\u30de\u30f3"],["\u7d2b\u7e1e\u306e\u30ea\u30f4\u30e9\u30c9\u30fc\u30eb","\u30b7\u30b7\u30de\u30ce\u30ea\u30d5\u30e9\u30c8\u30aa\u30eb","\u7d2b\u7e1e\u306e\u30ea\u30f4\u30e9\u30c9\u30fc\u30eb"],["SRS\u6c4e\u7528(\u6539\u9020\u7248)","\u30b9\u30bf\u30f3\u30bf\u30a2\u30c8RPG\u30b7\u30b9\u30c6\u30e0\u30aa\u30eb\u30bf\u30ca\u30c6\u30a4\u30d5\u30cf\u30f3","SRS\u6c4e\u7528 \u30aa\u30eb\u30bf\u30ca\u30c6\u30a3\u30f4"],["Standard RPG System","\u30b9\u30bf\u30f3\u30bf\u30a2\u30c8RPG\u30b7\u30b9\u30c6\u30e0","\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0\uff08SRS\uff09"],["\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0","\u30b9\u30bf\u30f3\u30bf\u30a2\u30c8RPG\u30b7\u30b9\u30c6\u30e0","\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0\uff08SRS\uff09"],["NJSLYRBATTLE","\u30cb\u30f3\u30b7\u30e4\u30b9\u30ec\u30a4\u30e4\u30a2\u30cf\u30c8\u30eb"],["Record of Steam","\u30ec\u30b3\u30aa\u30c8\u30aa\u30d5\u30b9\u30c1\u30a4\u30e0"],["\u8a69\u7247\u306e\u30a2\u30eb\u30bb\u30c3\u30c8","\u30a6\u30bf\u30ab\u30bf\u30ce\u30a2\u30eb\u30bb\u30c4\u30c8"],["Shared\u2020Fantasia","\u30b7\u30a8\u30a2\u30a2\u30c8\u30d5\u30a2\u30f3\u30bf\u30b7\u30a2"],["\u771f\u30fb\u5973\u795e\u8ee2\u751f","\u30b7\u30f3\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4"],["\u5973\u795e\u8ee2\u751f","\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4"],["\u899a\u9192\u7bc7","\u30ab\u30af\u30bb\u30a4\u30d8\u30f3"],["Chill","\u30c1\u30eb"],["BBNTRPG","\u30d2\u30a4\u30d2\u30a4\u30a8\u30ccTRPG","BBNTRPG (Black Black Network TRPG)"],["TORG Eternity","\u30c8\u30aa\u30af\u30a8\u30bf\u30a2\u30cb\u30c6\u30a4"],["\u30ac\u30fc\u30d7\u30b9","\u30ab\u30a2\u30d5\u30b9","GURPS"],["\u30ac\u30fc\u30d7\u30b9\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba","\u30ab\u30a2\u30d5\u30b9\u30d5\u30a4\u30eb\u30c8\u30a6\u30a4\u30b9","GURPS\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba"],["\u7d76\u5bfe\u96b7\u5974","\u30bb\u30c4\u30bf\u30a4\u30ec\u30a4\u30c8"],["\u30bb\u30e9\u30d5\u30a3\u30b6\u30a4\u30f3","\u30bb\u30a4\u30b7\u30e6\u30f3\u30b7\u30c4\u30ab\u30f3TRPG\u30bb\u30e9\u30d5\u30a3\u30b5\u30a4\u30f3","\u9752\u6625\u75be\u60a3TRPG \u30bb\u30e9\u30d5\u30a3\u30b6\u30a4\u30f3"],["\u8266\u3053\u308c","\u30ab\u30f3\u30b3\u30ec"],["\u795e\u6211\u72e9","\u30ab\u30df\u30ab\u30ab\u30ea"],["\u9d7a\u93e1","\u30cc\u30a8\u30ab\u30ab\u30df"],["\u30c8\u30fc\u30ad\u30e7\u30fc","\u30c8\u30aa\u30ad\u30e8\u30a6"],["\uff2e\u25ce\uff36\uff21","\u30ce\u30a6\u30a2"],["\u521d\u97f3\u30df\u30af","\u30cf\u30c4\u30cd\u30df\u30af"],["\u6731\u306e\u5b64\u5854","\u30a2\u30b1\u30ce\u30b3\u30c8\u30a6"],["\u5728\u308a\u3066\u904d\u304f","\u30a2\u30ea\u30c6\u30a2\u30de\u30cd\u30af"],["\u592e\u83ef\u5c01\u795e","\u30aa\u30a6\u30ab\u30db\u30a6\u30b7\u30f3"],["\u5fc3\u885d\u60f3\u6a5f","\u30b7\u30f3\u30b7\u30e8\u30a6\u30bd\u30a6\u30ad"],["\u80ce\u3088\u308a\u60f3\u3048","\u30cf\u30e9\u30e8\u30ea\u30aa\u30e2\u30a8"],["\u5c55\u721b\u4f1a","\u30c6\u30f3\u30e9\u30f3\u30ab\u30a4"],["\u58ca\u308c\u305f","\u30b3\u30ef\u30ec\u30bf"],["\u6bd4\u53e1\u5c71","\u30d2\u30a8\u30a4\u30b5\u30f3"],["\u4e16\u754c\u6a39","\u30bb\u30ab\u30a4\u30b7\u30e6"],["\u7570\u90a6\u4eba","\u30a4\u30db\u30a6\u30b7\u30f3"],["\u8ee2\u653b\u751f","\u30c6\u30f3\u30b3\u30a6\u30bb\u30a4"],["\u63a2\u7a7a\u58eb","\u30b9\u30ab\u30a4\u30ce\u30aa\u30c4"],["\u5263\u306e\u8857","\u30c4\u30eb\u30ad\u30ce\u30de\u30c1"],["\u9ed2\u7d62","\u30b3\u30c4\u30b1\u30f3"],["\u7d2b\u7e1e","\u30b7\u30b7\u30de"],["\u7834\u754c","\u30cf\u30ab\u30a4"],["\u9280\u5263","\u30ad\u30f3\u30b1\u30f3"],["\u6771\u4eac","\u30c8\u30a6\u30ad\u30e8\u30a6"],["\u7247\u9053","\u30ab\u30bf\u30df\u30c1"],["\u52c7\u8005","\u30e6\u30a6\u30b7\u30e4"],["\u5c11\u5973","\u30b7\u30e8\u30a6\u30b7\u30e8"],["\u771f\u7a7a","\u30b7\u30f3\u30af\u30a6"],["\u5b66\u5712","\u30ab\u30af\u30a8\u30f3"],["\u4e16\u754c","\u30bb\u30ab\u30a4"],["\u9752\u6625","\u30bb\u30a4\u30b7\u30e6\u30f3"],["\u75be\u60a3","\u30b7\u30c4\u30ab\u30f3"],["\u8ff7\u5bae","\u30e1\u30a4\u30ad\u30e6\u30a6"],["\u6b6f\u8eca","\u30cf\u30af\u30eb\u30de"],["\u84bc\u5929","\u30bd\u30a6\u30c6\u30f3"],["\u589c\u843d","\u30c4\u30a4\u30e9\u30af"],["\u7279\u547d","\u30c8\u30af\u30e1\u30a4"],["\u6643\u5929","\u30b3\u30a6\u30c6\u30f3"],["\u53db\u9006","\u30cf\u30f3\u30ad\u30e4\u30af"],["\u72af\u7f6a","\u30cf\u30f3\u30b5\u30a4"],["\u6d3b\u5287","\u30ab\u30c4\u30b1\u30ad"],["\u78a7\u7a7a","\u30d8\u30ad\u30af\u30a6"],["\u84ec\u83b1","\u30db\u30a6\u30e9\u30a4"],["\u5192\u967a","\u30db\u30a6\u30b1\u30f3"],["\u516d\u9580","\u30ed\u30af\u30e2\u30f3"],["\u708e\u4e0a","\u30a8\u30f3\u30b7\u30e8\u30a6"],["\u7121\u9650","\u30e0\u30b1\u30f3"],["\u5854","\u30c8\u30a6"],["\u7363","\u30b1\u30e2\u30ce"],["\u7378","\u30b1\u30e2\u30ce"],["\u68ee","\u30e2\u30ea"],["&","\u30a2\u30f3\u30c8"],["\uff06","\u30a2\u30f3\u30c8"],["\u30f4\u30a1","\u30cf"],["\u30f4\u30a3","\u30d2"],["\u30f4\u30a7","\u30d8"],["\u30f4\u30a9","\u30db"],["\u30f4","\u30d5"],["\u30a1","\u30a2"],["\u30a3","\u30a4"],["\u30a5","\u30a6"],["\u30a7","\u30a8"],["\u30a9","\u30aa"],["\u30e3","\u30e4"],["\u30e5","\u30e6"],["\u30e7","\u30e8"],["\u30c3","\u30c4"],["\u30f2","\u30aa"],["\u30ac","\u30ab"],["\u30ae","\u30ad"],["\u30b0","\u30af"],["\u30b2","\u30b1"],["\u30b4","\u30b3"],["\u30b6","\u30b5"],["\u30b8","\u30b7"],["\u30ba","\u30b9"],["\u30bc","\u30bb"],["\u30be","\u30bd"],["\u30c0","\u30bf"],["\u30c2","\u30c1"],["\u30c5","\u30c4"],["\u30c7","\u30c6"],["\u30c9","\u30c8"],["\u30d0","\u30cf"],["\u30d3","\u30d2"],["\u30d6","\u30d5"],["\u30d9","\u30d8"],["\u30dc","\u30db"],["\u30d1","\u30cf"],["\u30d4","\u30d2"],["\u30d7","\u30d5"],["\u30da","\u30d8"],["\u30dd","\u30db"]],e=vv=Cg([tv("dice-bot")],e),e})(),wv=(()=>{class e{constructor(e){this.componentFactoryResolver=e,this.title="\u7121\u540d\u306e\u30d1\u30cd\u30eb",this.left=0,this.top=0,this.width=100,this.height=100,this.isAbleFullScreenButton=!0,this.isAbleCloseButton=!0,this.scrollablePanel=null}get isShow(){return!!this.panelComponentRef}open(t,n,i){let r;i||(i=e.defaultParentViewContainerRef);const s=i.injector,o=this.componentFactoryResolver.resolveComponentFactory(e.UIPanelComponentClass),a=this.componentFactoryResolver.resolveComponentFactory(t);r=i.createComponent(o,i.length,s);let l=r.instance.content.createComponent(a);const c=r.injector.get(e);return c.panelComponentRef=r,n&&(n.title&&(c.title=n.title),n.top&&(c.top=n.top),n.left&&(c.left=n.left),n.width&&(c.width=n.width),n.height&&(c.height=n.height)),r.onDestroy(()=>{c.panelComponentRef=null}),l.instance}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}}return e.UIPanelComponentClass=null,e.\u0275fac=function(t){return new(t||e)(oi(La))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();class Cv{constructor(e,t,n){this._resolve=e,this._reject=t,this.option=n}resolve(e){this._resolve(e),this._resolve=null}reject(e){this._reject(e),this._reject=null}}let xv=(()=>{class e{constructor(e){this.componentFactoryResolver=e,this.modalContext=null,this.count=0,this.title="\u7121\u540d\u306e\u30e2\u30fc\u30c0\u30eb"}get option(){return this.modalContext?this.modalContext.option:null}get isShow(){return this.count>0}open(t,n,i){let r;return i||(i=e.defaultParentViewContainerRef),new Promise((s,o)=>{const a=new e(this.componentFactoryResolver);a.modalContext=new Cv(e=>{r&&(r.destroy(),s(e),this.count--)},e=>{r&&(r.destroy(),o(e),this.count--)},n);const l=io.create([{provide:e,useValue:a}],i.injector),c=this.componentFactoryResolver.resolveComponentFactory(e.ModalComponentClass),h=this.componentFactoryResolver.resolveComponentFactory(t);r=i.createComponent(c,i.length,l),r.instance.content.createComponent(h),r.onDestroy(()=>{this.count--}),this.count++})}resolve(e){this.modalContext&&(this.modalContext.resolve(e),this.modalContext=null)}reject(e){this.modalContext&&(this.modalContext.reject(e),this.modalContext=null)}}return e.ModalComponentClass=null,e.\u0275fac=function(t){return new(t||e)(oi(La))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();const Ev=function(e){return{outer:e}};function kv(e,t){if(1&e&&(Io(0,"div",5),ga(1),Io(2,"span",6),ga(3),Mo(),ga(4),Mo()),2&e){const e=jo();Zr(1),ba("",e.urlObj.protocol,"//"),Zr(1),To("ngClass",Ul(6,Ev,e.isOuter)),Zr(1),ma(e.urlObj.host),Zr(1),va("",e.urlObj.pathname,"",e.urlObj.search,"",e.urlObj.hash,"")}}function Sv(e,t){if(1&e&&(Io(0,"div",5),ga(1),Mo()),2&e){const e=jo();Zr(1),ma(e.url)}}function Tv(e,t){1&e&&(Io(0,"div"),ga(1,"\u3053\u306eURL\u3092\u958b\u304d\u307e\u3059\u304b\uff1f\uff08\u5225\u30a6\u30a3\u30f3\u30c9\u30a6\u3067\u958b\u304d\u307e\u3059\u3001\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u3092\u8a31\u53ef\u3057\u3066\u304f\u3060\u3055\u3044\uff09"),Mo())}function Ov(e,t){1&e&&(Io(0,"div"),ga(1,"\u26a0\ufe0fURL\u304c\u4e0d\u6b63\u3067\u3059\u3002"),Mo())}let Iv=(()=>{class e{constructor(e,t){this.panelService=e,this.modalService=t,this.url="",this.title="",this.subTitle="",this.url=t.option.url?t.option.url:"",this.title=t.option.title?t.option.title:"",this.subTitle=t.option.subTitle?t.option.subTitle:"",this.urlObj=this.isValid?new URL(this.url):null}get isValid(){return rv.validUrl(this.url.trim())}get isOuter(){return!!this.isValid&&window.location.origin!=this.urlObj.origin}ngOnInit(){Promise.resolve().then(()=>{let e="URL\u3092\u958b\u304f";this.title?e+="\u3008"+this.title+(this.subTitle?`\uff1a${this.subTitle}`:"")+"\u3009":this.subTitle&&(e+=`\u3008${this.subTitle}\u3009`),this.modalService.title=this.panelService.title=e}),Uy.register(this)}ngOnDestroy(){Uy.unregister(this)}openUrl(){window.open(this.url.trim(),"_blank","noopener"),this.modalService.resolve(!0)}cancel(){this.modalService.resolve(!1)}}return e.\u0275fac=function(t){return new(t||e)(So(wv),So(xv))},e.\u0275cmp=Ze({type:e,selectors:[["open-url"]],decls:11,vars:5,consts:[["class","url",4,"ngIf"],[1,"help"],[4,"ngIf"],["type","submit",3,"disabled","click"],["type","button",3,"click"],[1,"url"],[3,"ngClass"]],template:function(e,t){1&e&&(Io(0,"div"),Eo(1,kv,5,8,"div",0),Eo(2,Sv,2,1,"div",0),Ao(3,"hr"),Io(4,"div",1),Eo(5,Tv,2,0,"div",2),Eo(6,Ov,2,0,"div",2),Mo(),Mo(),Io(7,"button",3),zo("click",function(){return t.openUrl()}),ga(8,"\u958b\u304f"),Mo(),Io(9,"button",4),zo("click",function(){return t.cancel()}),ga(10,"\u30ad\u30e3\u30f3\u30bb\u30eb"),Mo()),2&e&&(Zr(1),To("ngIf",t.isValid),Zr(1),To("ngIf",!t.isValid),Zr(3),To("ngIf",t.isValid),Zr(1),To("ngIf",!t.isValid),Zr(1),To("disabled",!t.isValid))},directives:[Zh,Uh],styles:[".url[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]{font-weight:700}.help[_ngcontent-%COMP%]{font-size:smaller}"]}),e})();function Mv(e,t){if(Array.prototype.indexOf)return e.indexOf(t);for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1}function Av(e,t){for(var n=e.length-1;n>=0;n--)!0===t(e[n])&&e.splice(n,1)}function Pv(e){throw new Error("Unhandled case for value: '"+e+"'")}var Dv=function(){function e(e){void 0===e&&(e={}),this.tagName="",this.attrs={},this.innerHTML="",this.whitespaceRegex=/\s+/,this.tagName=e.tagName||"",this.attrs=e.attrs||{},this.innerHTML=e.innerHtml||e.innerHTML||""}return e.prototype.setTagName=function(e){return this.tagName=e,this},e.prototype.getTagName=function(){return this.tagName||""},e.prototype.setAttr=function(e,t){return this.getAttrs()[e]=t,this},e.prototype.getAttr=function(e){return this.getAttrs()[e]},e.prototype.setAttrs=function(e){return Object.assign(this.getAttrs(),e),this},e.prototype.getAttrs=function(){return this.attrs||(this.attrs={})},e.prototype.setClass=function(e){return this.setAttr("class",e)},e.prototype.addClass=function(e){for(var t,n=this.getClass(),i=this.whitespaceRegex,r=n?n.split(i):[],s=e.split(i);t=s.shift();)-1===Mv(r,t)&&r.push(t);return this.getAttrs().class=r.join(" "),this},e.prototype.removeClass=function(e){for(var t,n=this.getClass(),i=this.whitespaceRegex,r=n?n.split(i):[],s=e.split(i);r.length&&(t=s.shift());){var o=Mv(r,t);-1!==o&&r.splice(o,1)}return this.getAttrs().class=r.join(" "),this},e.prototype.getClass=function(){return this.getAttrs().class||""},e.prototype.hasClass=function(e){return-1!==(" "+this.getClass()+" ").indexOf(" "+e+" ")},e.prototype.setInnerHTML=function(e){return this.innerHTML=e,this},e.prototype.setInnerHtml=function(e){return this.setInnerHTML(e)},e.prototype.getInnerHTML=function(){return this.innerHTML||""},e.prototype.getInnerHtml=function(){return this.getInnerHTML()},e.prototype.toAnchorString=function(){var e=this.getTagName(),t=this.buildAttrsStr();return["<",e,t=t?" "+t:"",">",this.getInnerHtml(),"</",e,">"].join("")},e.prototype.buildAttrsStr=function(){if(!this.attrs)return"";var e=this.getAttrs(),t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n+'="'+e[n]+'"');return t.join(" ")},e}(),Rv=function(){function e(e){void 0===e&&(e={}),this.newWindow=!1,this.truncate={},this.className="",this.newWindow=e.newWindow||!1,this.truncate=e.truncate||{},this.className=e.className||""}return e.prototype.build=function(e){return new Dv({tagName:"a",attrs:this.createAttrs(e),innerHtml:this.processAnchorText(e.getAnchorText())})},e.prototype.createAttrs=function(e){var t={href:e.getAnchorHref()},n=this.createCssClass(e);return n&&(t.class=n),this.newWindow&&(t.target="_blank",t.rel="noopener noreferrer"),this.truncate&&this.truncate.length&&this.truncate.length<e.getAnchorText().length&&(t.title=e.getAnchorHref()),t},e.prototype.createCssClass=function(e){var t=this.className;if(t){for(var n=[t],i=e.getCssClassSuffixes(),r=0,s=i.length;r<s;r++)n.push(t+"-"+i[r]);return n.join(" ")}return""},e.prototype.processAnchorText=function(e){return this.doTruncate(e)},e.prototype.doTruncate=function(e){var t=this.truncate;if(!t||!t.length)return e;var n=t.length,i=t.location;return"smart"===i?function(e,t,n){var i,r;null==n?(n="&hellip;",r=3,i=8):(r=n.length,i=n.length);var s=function(e){var t="";return e.scheme&&e.host&&(t+=e.scheme+"://"),e.host&&(t+=e.host),e.path&&(t+="/"+e.path),e.query&&(t+="?"+e.query),e.fragment&&(t+="#"+e.fragment),t},o=function(e,t){var i=t/2,r=Math.ceil(i),s=-1*Math.floor(i),o="";return s<0&&(o=e.substr(s)),e.substr(0,r)+n+o};if(e.length<=t)return e;var a=t-r,l=function(e){var t={},n=e,i=n.match(/^([a-z]+):\/\//i);return i&&(t.scheme=i[1],n=n.substr(i[0].length)),(i=n.match(/^(.*?)(?=(\?|#|\/|$))/i))&&(t.host=i[1],n=n.substr(i[0].length)),(i=n.match(/^\/(.*?)(?=(\?|#|$))/i))&&(t.path=i[1],n=n.substr(i[0].length)),(i=n.match(/^\?(.*?)(?=(#|$))/i))&&(t.query=i[1],n=n.substr(i[0].length)),(i=n.match(/^#(.*?)$/i))&&(t.fragment=i[1]),t}(e);if(l.query){var c=l.query.match(/^(.*?)(?=(\?|\#))(.*?)$/i);c&&(l.query=l.query.substr(0,c[1].length),e=s(l))}if(e.length<=t)return e;if(l.host&&(l.host=l.host.replace(/^www\./,""),e=s(l)),e.length<=t)return e;var h="";if(l.host&&(h+=l.host),h.length>=a)return l.host.length==t?(l.host.substr(0,t-r)+n).substr(0,a+i):o(h,a).substr(0,a+i);var u="";if(l.path&&(u+="/"+l.path),l.query&&(u+="?"+l.query),u){if((h+u).length>=a)return(h+u).length==t?(h+u).substr(0,t):(h+o(u,a-h.length)).substr(0,a+i);h+=u}if(l.fragment){var d="#"+l.fragment;if((h+d).length>=a)return(h+d).length==t?(h+d).substr(0,t):(h+o(d,a-h.length)).substr(0,a+i);h+=d}if(l.scheme&&l.host){var p=l.scheme+"://";if((h+p).length<a)return(p+h).substr(0,t)}if(h.length<=t)return h;var f="";return a>0&&(f=h.substr(-1*Math.floor(a/2))),(h.substr(0,Math.ceil(a/2))+n+f).substr(0,a+i)}(e,n):"middle"===i?function(e,t,n){if(e.length<=t)return e;var i,r;null==n?(n="&hellip;",i=8,r=3):(i=n.length,r=n.length);var s=t-r,o="";return s>0&&(o=e.substr(-1*Math.floor(s/2))),(e.substr(0,Math.ceil(s/2))+n+o).substr(0,s+i)}(e,n):function(e,t,n){return function(e,t,n){var i;return e.length>t&&(null==n?(n="&hellip;",i=3):i=n.length,e=e.substring(0,t-i)+n),e}(e,t,void 0)}(e,n)},e}(),Fv=function(){function e(e){this.__jsduckDummyDocProp=null,this.matchedText="",this.offset=0,this.tagBuilder=e.tagBuilder,this.matchedText=e.matchedText,this.offset=e.offset}return e.prototype.getMatchedText=function(){return this.matchedText},e.prototype.setOffset=function(e){this.offset=e},e.prototype.getOffset=function(){return this.offset},e.prototype.getCssClassSuffixes=function(){return[this.getType()]},e.prototype.buildTag=function(){return this.tagBuilder.build(this)},e}(),Nv=function(e,t){return(Nv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function zv(e,t){function n(){this.constructor=e}Nv(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var Lv,Bv=function(){return(Bv=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},jv=function(e){function t(t){var n=e.call(this,t)||this;return n.email="",n.email=t.email,n}return zv(t,e),t.prototype.getType=function(){return"email"},t.prototype.getEmail=function(){return this.email},t.prototype.getAnchorHref=function(){return"mailto:"+this.email},t.prototype.getAnchorText=function(){return this.email},t}(Fv),Uv=function(e){function t(t){var n=e.call(this,t)||this;return n.serviceName="",n.hashtag="",n.serviceName=t.serviceName,n.hashtag=t.hashtag,n}return zv(t,e),t.prototype.getType=function(){return"hashtag"},t.prototype.getServiceName=function(){return this.serviceName},t.prototype.getHashtag=function(){return this.hashtag},t.prototype.getAnchorHref=function(){var e=this.serviceName,t=this.hashtag;switch(e){case"twitter":return"https://twitter.com/hashtag/"+t;case"facebook":return"https://www.facebook.com/hashtag/"+t;case"instagram":return"https://instagram.com/explore/tags/"+t;default:throw new Error("Unknown service name to point hashtag to: "+e)}},t.prototype.getAnchorText=function(){return"#"+this.hashtag},t}(Fv),Hv=function(e){function t(t){var n=e.call(this,t)||this;return n.serviceName="twitter",n.mention="",n.mention=t.mention,n.serviceName=t.serviceName,n}return zv(t,e),t.prototype.getType=function(){return"mention"},t.prototype.getMention=function(){return this.mention},t.prototype.getServiceName=function(){return this.serviceName},t.prototype.getAnchorHref=function(){switch(this.serviceName){case"twitter":return"https://twitter.com/"+this.mention;case"instagram":return"https://instagram.com/"+this.mention;case"soundcloud":return"https://soundcloud.com/"+this.mention;default:throw new Error("Unknown service name to point mention to: "+this.serviceName)}},t.prototype.getAnchorText=function(){return"@"+this.mention},t.prototype.getCssClassSuffixes=function(){var t=e.prototype.getCssClassSuffixes.call(this),n=this.getServiceName();return n&&t.push(n),t},t}(Fv),Vv=function(e){function t(t){var n=e.call(this,t)||this;return n.number="",n.plusSign=!1,n.number=t.number,n.plusSign=t.plusSign,n}return zv(t,e),t.prototype.getType=function(){return"phone"},t.prototype.getPhoneNumber=function(){return this.number},t.prototype.getNumber=function(){return this.getPhoneNumber()},t.prototype.getAnchorHref=function(){return"tel:"+(this.plusSign?"+":"")+this.number},t.prototype.getAnchorText=function(){return this.matchedText},t}(Fv),Gv=function(e){function t(t){var n=e.call(this,t)||this;return n.url="",n.urlMatchType="scheme",n.protocolUrlMatch=!1,n.protocolRelativeMatch=!1,n.stripPrefix={scheme:!0,www:!0},n.stripTrailingSlash=!0,n.decodePercentEncoding=!0,n.schemePrefixRegex=/^(https?:\/\/)?/i,n.wwwPrefixRegex=/^(https?:\/\/)?(www\.)?/i,n.protocolRelativeRegex=/^\/\//,n.protocolPrepended=!1,n.urlMatchType=t.urlMatchType,n.url=t.url,n.protocolUrlMatch=t.protocolUrlMatch,n.protocolRelativeMatch=t.protocolRelativeMatch,n.stripPrefix=t.stripPrefix,n.stripTrailingSlash=t.stripTrailingSlash,n.decodePercentEncoding=t.decodePercentEncoding,n}return zv(t,e),t.prototype.getType=function(){return"url"},t.prototype.getUrlMatchType=function(){return this.urlMatchType},t.prototype.getUrl=function(){var e=this.url;return this.protocolRelativeMatch||this.protocolUrlMatch||this.protocolPrepended||(e=this.url="http://"+e,this.protocolPrepended=!0),e},t.prototype.getAnchorHref=function(){return this.getUrl().replace(/&amp;/g,"&")},t.prototype.getAnchorText=function(){var e=this.getMatchedText();return this.protocolRelativeMatch&&(e=this.stripProtocolRelativePrefix(e)),this.stripPrefix.scheme&&(e=this.stripSchemePrefix(e)),this.stripPrefix.www&&(e=this.stripWwwPrefix(e)),this.stripTrailingSlash&&(e=this.removeTrailingSlash(e)),this.decodePercentEncoding&&(e=this.removePercentEncoding(e)),e},t.prototype.stripSchemePrefix=function(e){return e.replace(this.schemePrefixRegex,"")},t.prototype.stripWwwPrefix=function(e){return e.replace(this.wwwPrefixRegex,"$1")},t.prototype.stripProtocolRelativePrefix=function(e){return e.replace(this.protocolRelativeRegex,"")},t.prototype.removeTrailingSlash=function(e){return"/"===e.charAt(e.length-1)&&(e=e.slice(0,-1)),e},t.prototype.removePercentEncoding=function(e){var t=e.replace(/%22/gi,"&quot;").replace(/%26/gi,"&amp;").replace(/%27/gi,"&#39;").replace(/%3C/gi,"&lt;").replace(/%3E/gi,"&gt;");try{return decodeURIComponent(t)}catch(n){return t}},t}(Fv),Zv=function(){return function(e){this.__jsduckDummyDocProp=null,this.tagBuilder=e.tagBuilder}}(),Wv=/[A-Za-z]/,Yv=/[\d]/,qv=/[\D]/,$v=/\s/,Xv=/['"]/,Kv=/[\x00-\x1F\x7F]/,Qv=/A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC/.source,Jv=Qv+/\u2700-\u27bf\udde6-\uddff\ud800-\udbff\udc00-\udfff\ufe0e\ufe0f\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0\ud83c\udffb-\udfff\u200d\u3299\u3297\u303d\u3030\u24c2\ud83c\udd70-\udd71\udd7e-\udd7f\udd8e\udd91-\udd9a\udde6-\uddff\ude01-\ude02\ude1a\ude2f\ude32-\ude3a\ude50-\ude51\u203c\u2049\u25aa-\u25ab\u25b6\u25c0\u25fb-\u25fe\u00a9\u00ae\u2122\u2139\udc04\u2600-\u26FF\u2b05\u2b06\u2b07\u2b1b\u2b1c\u2b50\u2b55\u231a\u231b\u2328\u23cf\u23e9-\u23f3\u23f8-\u23fa\udccf\u2935\u2934\u2190-\u21ff/.source+/\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D4-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D01-\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF8\u1CF9\u1DC0-\u1DF5\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F/.source,e_=/0-9\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19/.source,t_=Jv+e_,n_=Jv+e_,i_="(?:["+e_+"]{1,3}\\.){3}["+e_+"]{1,3}",r_="["+n_+"](?:["+n_+"\\-]{0,61}["+n_+"])?",s_=function(e){return"(?=("+r_+"))\\"+e},o_=function(e){return"(?:"+s_(e)+"(?:\\."+s_(e+1)+"){0,126}|"+i_+")"},a_=(new RegExp("["+n_+".\\-]*["+n_+"\\-]"),new RegExp("["+n_+"]")),l_=/(?:xn--vermgensberatung-pwb|xn--vermgensberater-ctb|xn--clchc0ea0b2g2a9gcd|xn--w4r85el8fhu5dnra|northwesternmutual|travelersinsurance|verm\xf6gensberatung|xn--3oq18vl8pn36a|xn--5su34j936bgsg|xn--bck1b9a5dre4c|xn--mgbai9azgqp6j|xn--mgberp4a5d4ar|xn--xkc2dl3a5ee0h|verm\xf6gensberater|xn--fzys8d69uvgm|xn--mgba7c0bbn0a|xn--xkc2al3hye2a|americanexpress|kerryproperties|sandvikcoromant|xn--i1b6b1a6a2e|xn--kcrx77d1x4a|xn--lgbbat1ad8j|xn--mgba3a4f16a|xn--mgbaakc7dvf|xn--mgbc0a9azcg|xn--nqv7fs00ema|afamilycompany|americanfamily|bananarepublic|cancerresearch|cookingchannel|kerrylogistics|weatherchannel|xn--54b7fta0cc|xn--6qq986b3xl|xn--80aqecdr1a|xn--b4w605ferd|xn--fiq228c5hs|xn--h2breg3eve|xn--jlq61u9w7b|xn--mgba3a3ejt|xn--mgbaam7a8h|xn--mgbayh7gpa|xn--mgbb9fbpob|xn--mgbbh1a71e|xn--mgbca7dzdo|xn--mgbi4ecexp|xn--mgbx4cd0ab|xn--rvc1e0am3e|international|lifeinsurance|spreadbetting|travelchannel|wolterskluwer|xn--eckvdtc9d|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--h2brj9c8c|xn--tiq49xqyj|xn--yfro4i67o|xn--ygbi2ammx|construction|lplfinancial|scholarships|versicherung|xn--3e0b707e|xn--45br5cyl|xn--80adxhks|xn--80asehdb|xn--8y0a063a|xn--gckr3f0f|xn--mgb9awbf|xn--mgbab2bd|xn--mgbgu82a|xn--mgbpl2fh|xn--mgbt3dhd|xn--mk1bu44c|xn--ngbc5azd|xn--ngbe9e0a|xn--ogbpf8fl|xn--qcka1pmc|accountants|barclaycard|blackfriday|blockbuster|bridgestone|calvinklein|contractors|creditunion|engineering|enterprises|foodnetwork|investments|kerryhotels|lamborghini|motorcycles|olayangroup|photography|playstation|productions|progressive|redumbrella|rightathome|williamhill|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--3bst00m|xn--3ds443g|xn--3hcrj9c|xn--42c2d9a|xn--45brj9c|xn--55qw42g|xn--6frz82g|xn--80ao21a|xn--9krt00a|xn--cck2b3b|xn--czr694b|xn--d1acj3b|xn--efvy88h|xn--estv75g|xn--fct429k|xn--fjq720a|xn--flw351e|xn--g2xx48c|xn--gecrj9c|xn--gk3at1e|xn--h2brj9c|xn--hxt814e|xn--imr513n|xn--j6w193g|xn--jvr189m|xn--kprw13d|xn--kpry57d|xn--kpu716f|xn--mgbbh1a|xn--mgbtx2b|xn--mix891f|xn--nyqy26a|xn--otu796d|xn--pbt977c|xn--pgbs0dh|xn--q9jyb4c|xn--rhqv96g|xn--rovu88b|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--vuq861b|xn--w4rs40l|xn--xhq521b|xn--zfr164b|\u0b9a\u0bbf\u0b99\u0bcd\u0b95\u0baa\u0bcd\u0baa\u0bc2\u0bb0\u0bcd|accountant|apartments|associates|basketball|bnpparibas|boehringer|capitalone|consulting|creditcard|cuisinella|eurovision|extraspace|foundation|healthcare|immobilien|industries|management|mitsubishi|nationwide|newholland|nextdirect|onyourside|properties|protection|prudential|realestate|republican|restaurant|schaeffler|swiftcover|tatamotors|technology|telefonica|university|vistaprint|vlaanderen|volkswagen|xn--30rr7y|xn--3pxu8k|xn--45q11c|xn--4gbrim|xn--55qx5d|xn--5tzm5g|xn--80aswg|xn--90a3ac|xn--9dbq2a|xn--9et52u|xn--c2br7g|xn--cg4bki|xn--czrs0t|xn--czru2d|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--io0a7i|xn--kput3i|xn--mxtq1m|xn--o3cw4h|xn--pssy2u|xn--unup4y|xn--wgbh1c|xn--wgbl6a|xn--y9a3aq|accenture|alfaromeo|allfinanz|amsterdam|analytics|aquarelle|barcelona|bloomberg|christmas|community|directory|education|equipment|fairwinds|financial|firestone|fresenius|frontdoor|fujixerox|furniture|goldpoint|hisamitsu|homedepot|homegoods|homesense|honeywell|institute|insurance|kuokgroup|ladbrokes|lancaster|landrover|lifestyle|marketing|marshalls|melbourne|microsoft|panasonic|passagens|pramerica|richardli|scjohnson|shangrila|solutions|statebank|statefarm|stockholm|travelers|vacations|xn--90ais|xn--c1avg|xn--d1alf|xn--e1a4c|xn--fhbei|xn--j1aef|xn--j1amh|xn--l1acc|xn--ngbrx|xn--nqv7f|xn--p1acf|xn--tckwe|xn--vhquv|yodobashi|abudhabi|airforce|allstate|attorney|barclays|barefoot|bargains|baseball|boutique|bradesco|broadway|brussels|budapest|builders|business|capetown|catering|catholic|chrysler|cipriani|cityeats|cleaning|clinique|clothing|commbank|computer|delivery|deloitte|democrat|diamonds|discount|discover|download|engineer|ericsson|esurance|etisalat|everbank|exchange|feedback|fidelity|firmdale|football|frontier|goodyear|grainger|graphics|guardian|hdfcbank|helsinki|holdings|hospital|infiniti|ipiranga|istanbul|jpmorgan|lighting|lundbeck|marriott|maserati|mckinsey|memorial|merckmsd|mortgage|movistar|observer|partners|pharmacy|pictures|plumbing|property|redstone|reliance|saarland|samsclub|security|services|shopping|showtime|softbank|software|stcgroup|supplies|symantec|training|uconnect|vanguard|ventures|verisign|woodside|xn--90ae|xn--node|xn--p1ai|xn--qxam|yokohama|\u0627\u0644\u0633\u0639\u0648\u062f\u064a\u0629|abogado|academy|agakhan|alibaba|android|athleta|auction|audible|auspost|avianca|banamex|bauhaus|bentley|bestbuy|booking|brother|bugatti|capital|caravan|careers|cartier|channel|charity|chintai|citadel|clubmed|college|cologne|comcast|company|compare|contact|cooking|corsica|country|coupons|courses|cricket|cruises|dentist|digital|domains|exposed|express|farmers|fashion|ferrari|ferrero|finance|fishing|fitness|flights|florist|flowers|forsale|frogans|fujitsu|gallery|genting|godaddy|grocery|guitars|hamburg|hangout|hitachi|holiday|hosting|hoteles|hotmail|hyundai|iselect|ismaili|jewelry|juniper|kitchen|komatsu|lacaixa|lancome|lanxess|lasalle|latrobe|leclerc|liaison|limited|lincoln|markets|metlife|monster|netbank|netflix|network|neustar|okinawa|oldnavy|organic|origins|philips|pioneer|politie|realtor|recipes|rentals|reviews|rexroth|samsung|sandvik|schmidt|schwarz|science|shiksha|shriram|singles|staples|starhub|storage|support|surgery|systems|temasek|theater|theatre|tickets|tiffany|toshiba|trading|walmart|wanggou|watches|weather|website|wedding|whoswho|windows|winners|xfinity|yamaxun|youtube|zuerich|\u043a\u0430\u0442\u043e\u043b\u0438\u043a|\u0627\u062a\u0635\u0627\u0644\u0627\u062a|\u0627\u0644\u062c\u0632\u0627\u0626\u0631|\u0627\u0644\u0639\u0644\u064a\u0627\u0646|\u067e\u0627\u06a9\u0633\u062a\u0627\u0646|\u0643\u0627\u062b\u0648\u0644\u064a\u0643|\u0645\u0648\u0628\u0627\u064a\u0644\u064a|\u0b87\u0ba8\u0bcd\u0ba4\u0bbf\u0baf\u0bbe|abarth|abbott|abbvie|active|africa|agency|airbus|airtel|alipay|alsace|alstom|anquan|aramco|author|bayern|beauty|berlin|bharti|blanco|bostik|boston|broker|camera|career|caseih|casino|center|chanel|chrome|church|circle|claims|clinic|coffee|comsec|condos|coupon|credit|cruise|dating|datsun|dealer|degree|dental|design|direct|doctor|dunlop|dupont|durban|emerck|energy|estate|events|expert|family|flickr|futbol|gallup|garden|george|giving|global|google|gratis|health|hermes|hiphop|hockey|hotels|hughes|imamat|insure|intuit|jaguar|joburg|juegos|kaufen|kinder|kindle|kosher|lancia|latino|lawyer|lefrak|living|locker|london|luxury|madrid|maison|makeup|market|mattel|mobile|mobily|monash|mormon|moscow|museum|mutual|nagoya|natura|nissan|nissay|norton|nowruz|office|olayan|online|oracle|orange|otsuka|pfizer|photos|physio|piaget|pictet|quebec|racing|realty|reisen|repair|report|review|rocher|rogers|ryukyu|safety|sakura|sanofi|school|schule|search|secure|select|shouji|soccer|social|stream|studio|supply|suzuki|swatch|sydney|taipei|taobao|target|tattoo|tennis|tienda|tjmaxx|tkmaxx|toyota|travel|unicom|viajes|viking|villas|virgin|vision|voting|voyage|vuelos|walter|warman|webcam|xihuan|yachts|yandex|zappos|\u043c\u043e\u0441\u043a\u0432\u0430|\u043e\u043d\u043b\u0430\u0439\u043d|\u0627\u0628\u0648\u0638\u0628\u064a|\u0627\u0631\u0627\u0645\u0643\u0648|\u0627\u0644\u0627\u0631\u062f\u0646|\u0627\u0644\u0645\u063a\u0631\u0628|\u0627\u0645\u0627\u0631\u0627\u062a|\u0641\u0644\u0633\u0637\u064a\u0646|\u0645\u0644\u064a\u0633\u064a\u0627|\u092d\u093e\u0930\u0924\u092e\u094d|\u0b87\u0bb2\u0b99\u0bcd\u0b95\u0bc8|\u30d5\u30a1\u30c3\u30b7\u30e7\u30f3|actor|adult|aetna|amfam|amica|apple|archi|audio|autos|azure|baidu|beats|bible|bingo|black|boats|bosch|build|canon|cards|chase|cheap|cisco|citic|click|cloud|coach|codes|crown|cymru|dabur|dance|deals|delta|dodge|drive|dubai|earth|edeka|email|epost|epson|faith|fedex|final|forex|forum|gallo|games|gifts|gives|glade|glass|globo|gmail|green|gripe|group|gucci|guide|homes|honda|horse|house|hyatt|ikano|intel|irish|iveco|jetzt|koeln|kyoto|lamer|lease|legal|lexus|lilly|linde|lipsy|lixil|loans|locus|lotte|lotto|lupin|macys|mango|media|miami|money|mopar|movie|nadex|nexus|nikon|ninja|nokia|nowtv|omega|osaka|paris|parts|party|phone|photo|pizza|place|poker|praxi|press|prime|promo|quest|radio|rehab|reise|ricoh|rocks|rodeo|rugby|salon|sener|seven|sharp|shell|shoes|skype|sling|smart|smile|solar|space|sport|stada|store|study|style|sucks|swiss|tatar|tires|tirol|tmall|today|tokyo|tools|toray|total|tours|trade|trust|tunes|tushu|ubank|vegas|video|vodka|volvo|wales|watch|weber|weibo|works|world|xerox|yahoo|zippo|\u0627\u06cc\u0631\u0627\u0646|\u0628\u0627\u0632\u0627\u0631|\u0628\u06be\u0627\u0631\u062a|\u0633\u0648\u062f\u0627\u0646|\u0633\u0648\u0631\u064a\u0629|\u0647\u0645\u0631\u0627\u0647|\u092d\u093e\u0930\u094b\u0924|\u0938\u0902\u0917\u0920\u0928|\u09ac\u09be\u0982\u09b2\u09be|\u0c2d\u0c3e\u0c30\u0c24\u0c4d|\u0d2d\u0d3e\u0d30\u0d24\u0d02|\u5609\u91cc\u5927\u9152\u5e97|aarp|able|adac|aero|aigo|akdn|ally|amex|arab|army|arpa|arte|asda|asia|audi|auto|baby|band|bank|bbva|beer|best|bike|bing|blog|blue|bofa|bond|book|buzz|cafe|call|camp|care|cars|casa|case|cash|cbre|cern|chat|citi|city|club|cool|coop|cyou|data|date|dclk|deal|dell|desi|diet|dish|docs|doha|duck|duns|dvag|erni|fage|fail|fans|farm|fast|fiat|fido|film|fire|fish|flir|food|ford|free|fund|game|gbiz|gent|ggee|gift|gmbh|gold|golf|goog|guge|guru|hair|haus|hdfc|help|here|hgtv|host|hsbc|icbc|ieee|imdb|immo|info|itau|java|jeep|jobs|jprs|kddi|kiwi|kpmg|kred|land|lego|lgbt|lidl|life|like|limo|link|live|loan|loft|love|ltda|luxe|maif|meet|meme|menu|mini|mint|mobi|moda|moto|name|navy|news|next|nico|nike|ollo|open|page|pars|pccw|pics|ping|pink|play|plus|pohl|porn|post|prod|prof|qpon|raid|read|reit|rent|rest|rich|rmit|room|rsvp|ruhr|safe|sale|sarl|save|saxo|scor|scot|seat|seek|sexy|shaw|shia|shop|show|silk|sina|site|skin|sncf|sohu|song|sony|spot|star|surf|talk|taxi|team|tech|teva|tiaa|tips|town|toys|tube|vana|visa|viva|vivo|vote|voto|wang|weir|wien|wiki|wine|work|xbox|yoga|zara|zero|zone|\u0434\u0435\u0442\u0438|\u0441\u0430\u0439\u0442|\u0628\u0627\u0631\u062a|\u0628\u064a\u062a\u0643|\u0680\u0627\u0631\u062a|\u062a\u0648\u0646\u0633|\u0634\u0628\u0643\u0629|\u0639\u0631\u0627\u0642|\u0639\u0645\u0627\u0646|\u0645\u0648\u0642\u0639|\u092d\u093e\u0930\u0924|\u09ad\u09be\u09b0\u09a4|\u09ad\u09be\u09f0\u09a4|\u0a2d\u0a3e\u0a30\u0a24|\u0aad\u0abe\u0ab0\u0aa4|\u0b2d\u0b3e\u0b30\u0b24|\u0cad\u0cbe\u0cb0\u0ca4|\u0dbd\u0d82\u0d9a\u0dcf|\u30b0\u30fc\u30b0\u30eb|\u30af\u30e9\u30a6\u30c9|\u30dd\u30a4\u30f3\u30c8|\u5927\u4f17\u6c7d\u8f66|\u7ec4\u7ec7\u673a\u6784|\u96fb\u8a0a\u76c8\u79d1|\u9999\u683c\u91cc\u62c9|aaa|abb|abc|aco|ads|aeg|afl|aig|anz|aol|app|art|aws|axa|bar|bbc|bbt|bcg|bcn|bet|bid|bio|biz|bms|bmw|bnl|bom|boo|bot|box|buy|bzh|cab|cal|cam|car|cat|cba|cbn|cbs|ceb|ceo|cfa|cfd|com|crs|csc|dad|day|dds|dev|dhl|diy|dnp|dog|dot|dtv|dvr|eat|eco|edu|esq|eus|fan|fit|fly|foo|fox|frl|ftr|fun|fyi|gal|gap|gdn|gea|gle|gmo|gmx|goo|gop|got|gov|hbo|hiv|hkt|hot|how|ibm|ice|icu|ifm|inc|ing|ink|int|ist|itv|jcb|jcp|jio|jll|jmp|jnj|jot|joy|kfh|kia|kim|kpn|krd|lat|law|lds|llc|lol|lpl|ltd|man|map|mba|med|men|mil|mit|mlb|mls|mma|moe|moi|mom|mov|msd|mtn|mtr|nab|nba|nec|net|new|nfl|ngo|nhk|now|nra|nrw|ntt|nyc|obi|off|one|ong|onl|ooo|org|ott|ovh|pay|pet|phd|pid|pin|pnc|pro|pru|pub|pwc|qvc|red|ren|ril|rio|rip|run|rwe|sap|sas|sbi|sbs|sca|scb|ses|sew|sex|sfr|ski|sky|soy|srl|srt|stc|tab|tax|tci|tdk|tel|thd|tjx|top|trv|tui|tvs|ubs|uno|uol|ups|vet|vig|vin|vip|wed|win|wme|wow|wtc|wtf|xin|xxx|xyz|you|yun|zip|\u0431\u0435\u043b|\u043a\u043e\u043c|\u049b\u0430\u0437|\u043c\u043a\u0434|\u043c\u043e\u043d|\u043e\u0440\u0433|\u0440\u0443\u0441|\u0441\u0440\u0431|\u0443\u043a\u0440|\u0570\u0561\u0575|\u05e7\u05d5\u05dd|\u0639\u0631\u0628|\u0642\u0637\u0631|\u0643\u0648\u0645|\u0645\u0635\u0631|\u0915\u0949\u092e|\u0928\u0947\u091f|\u0e04\u0e2d\u0e21|\u0e44\u0e17\u0e22|\u30b9\u30c8\u30a2|\u30bb\u30fc\u30eb|\u307f\u3093\u306a|\u4e2d\u6587\u7f51|\u5929\u4e3b\u6559|\u6211\u7231\u4f60|\u65b0\u52a0\u5761|\u6de1\u9a6c\u9521|\u8bfa\u57fa\u4e9a|\u98de\u5229\u6d66|ac|ad|ae|af|ag|ai|al|am|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|\u03b5\u03bb|\u0431\u0433|\u0435\u044e|\u0440\u0444|\u10d2\u10d4|\ub2f7\ub137|\ub2f7\ucef4|\uc0bc\uc131|\ud55c\uad6d|\u30b3\u30e0|\u4e16\u754c|\u4e2d\u4fe1|\u4e2d\u56fd|\u4e2d\u570b|\u4f01\u4e1a|\u4f5b\u5c71|\u4fe1\u606f|\u5065\u5eb7|\u516b\u5366|\u516c\u53f8|\u516c\u76ca|\u53f0\u6e7e|\u53f0\u7063|\u5546\u57ce|\u5546\u5e97|\u5546\u6807|\u5609\u91cc|\u5728\u7ebf|\u5927\u62ff|\u5a31\u4e50|\u5bb6\u96fb|\u5de5\u884c|\u5e7f\u4e1c|\u5fae\u535a|\u6148\u5584|\u624b\u673a|\u624b\u8868|\u62db\u8058|\u653f\u52a1|\u653f\u5e9c|\u65b0\u95fb|\u65f6\u5c1a|\u66f8\u7c4d|\u673a\u6784|\u6e38\u620f|\u6fb3\u9580|\u70b9\u770b|\u73e0\u5b9d|\u79fb\u52a8|\u7f51\u5740|\u7f51\u5e97|\u7f51\u7ad9|\u7f51\u7edc|\u8054\u901a|\u8c37\u6b4c|\u8d2d\u7269|\u901a\u8ca9|\u96c6\u56e2|\u98df\u54c1|\u9910\u5385|\u9999\u6e2f)/,c_=new RegExp("["+n_+"!#$%&'*+/=?^_`{|}~-]"),h_=new RegExp("^"+l_.source+"$"),u_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.localPartCharRegex=c_,t.strictTldRegex=h_,t}return zv(t,e),t.prototype.parseMatches=function(e){for(var t=this.tagBuilder,n=this.localPartCharRegex,i=this.strictTldRegex,r=[],s=e.length,o=new d_,a={m:"a",a:"i",i:"l",l:"t",t:"o",o:":"},l=0,c=0,h=o;l<s;){var u=e.charAt(l);switch(c){case 0:d(u);break;case 1:p(e.charAt(l-1),u);break;case 2:f(u);break;case 3:g(u);break;case 4:m(u);break;case 5:b(u);break;case 6:y(u);break;case 7:v(u);break;default:Pv(c)}l++}return C(),r;function d(e){"m"===e?_(1):n.test(e)&&_()}function p(e,t){":"===e?n.test(t)?(c=2,h=new d_(Bv(Bv({},h),{hasMailtoPrefix:!0}))):w():a[e]===t||(n.test(t)?c=2:"."===t?c=3:"@"===t?c=4:w())}function f(e){"."===e?c=3:"@"===e?c=4:n.test(e)||w()}function g(e){"."===e||"@"===e?w():n.test(e)?c=2:w()}function m(e){a_.test(e)?c=5:w()}function b(e){"."===e?c=7:"-"===e?c=6:a_.test(e)||C()}function y(e){"-"===e||"."===e?C():a_.test(e)?c=5:C()}function v(e){"."===e||"-"===e?C():a_.test(e)?(c=5,h=new d_(Bv(Bv({},h),{hasDomainDot:!0}))):C()}function _(e){void 0===e&&(e=2),c=e,h=new d_({idx:l})}function w(){c=0,h=o}function C(){if(h.hasDomainDot){var n=e.slice(h.idx,l);/[-.]$/.test(n)&&(n=n.slice(0,-1));var s=h.hasMailtoPrefix?n.slice("mailto:".length):n;(function(e){var t=(e.split(".").pop()||"").toLowerCase();return i.test(t)})(s)&&r.push(new jv({tagBuilder:t,matchedText:n,offset:h.idx,email:s}))}w()}},t}(Zv),d_=function(){return function(e){void 0===e&&(e={}),this.idx=void 0!==e.idx?e.idx:-1,this.hasMailtoPrefix=!!e.hasMailtoPrefix,this.hasDomainDot=!!e.hasDomainDot}}(),p_=function(){function e(){}return e.isValid=function(e,t){return!(t&&!this.isValidUriScheme(t)||this.urlMatchDoesNotHaveProtocolOrDot(e,t)||this.urlMatchDoesNotHaveAtLeastOneWordChar(e,t)&&!this.isValidIpAddress(e)||this.containsMultipleDots(e))},e.isValidIpAddress=function(e){var t=new RegExp(this.hasFullProtocolRegex.source+this.ipRegex.source);return null!==e.match(t)},e.containsMultipleDots=function(e){var t=e;return this.hasFullProtocolRegex.test(e)&&(t=e.split("://")[1]),t.split("/")[0].indexOf("..")>-1},e.isValidUriScheme=function(e){var t=e.match(this.uriSchemeRegex),n=t&&t[0].toLowerCase();return"javascript:"!==n&&"vbscript:"!==n},e.urlMatchDoesNotHaveProtocolOrDot=function(e,t){return!(!e||t&&this.hasFullProtocolRegex.test(t)||-1!==e.indexOf("."))},e.urlMatchDoesNotHaveAtLeastOneWordChar=function(e,t){return!(!e||!t||this.hasFullProtocolRegex.test(t)||this.hasWordCharAfterProtocolRegex.test(e))},e.hasFullProtocolRegex=/^[A-Za-z][-.+A-Za-z0-9]*:\/\//,e.uriSchemeRegex=/^[A-Za-z][-.+A-Za-z0-9]*:/,e.hasWordCharAfterProtocolRegex=new RegExp(":[^\\s]*?["+Qv+"]"),e.ipRegex=/[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?(:[0-9]*)?\/?$/,e}(),f_=(Lv=new RegExp("[/?#](?:["+n_+"\\-+&@#/%=~_()|'$*\\[\\]{}?!:,.;^\u2713]*["+n_+"\\-+&@#/%=~_()|'$*\\[\\]{}\u2713])?"),new RegExp(["(?:","(",/(?:[A-Za-z][-.+A-Za-z0-9]{0,63}:(?![A-Za-z][-.+A-Za-z0-9]{0,63}:\/\/)(?!\d+\/?)(?:\/\/)?)/.source,o_(2),")","|","(","(//)?",/(?:www\.)/.source,o_(6),")","|","(","(//)?",o_(10)+"\\.",l_.source,"(?![-"+t_+"])",")",")","(?::[0-9]+)?","(?:"+Lv.source+")?"].join(""),"gi")),g_=new RegExp("["+n_+"]"),m_=function(e){function t(t){var n=e.call(this,t)||this;return n.stripPrefix={scheme:!0,www:!0},n.stripTrailingSlash=!0,n.decodePercentEncoding=!0,n.matcherRegex=f_,n.wordCharRegExp=g_,n.stripPrefix=t.stripPrefix,n.stripTrailingSlash=t.stripTrailingSlash,n.decodePercentEncoding=t.decodePercentEncoding,n}return zv(t,e),t.prototype.parseMatches=function(e){for(var t,n=this.matcherRegex,i=this.stripPrefix,r=this.stripTrailingSlash,s=this.decodePercentEncoding,o=this.tagBuilder,a=[],l=function(){var n=t[0],l=t[1],h=t[4],u=t.index,d=t[5]||t[9],p=e.charAt(u-1);if(!p_.isValid(n,l))return"continue";if(u>0&&"@"===p)return"continue";if(u>0&&d&&c.wordCharRegExp.test(p))return"continue";if(/\?$/.test(n)&&(n=n.substr(0,n.length-1)),c.matchHasUnbalancedClosingParen(n))n=n.substr(0,n.length-1);else{var f=c.matchHasInvalidCharAfterTld(n,l);f>-1&&(n=n.substr(0,f))}var g=["http://","https://"].find(function(e){return!!l&&-1!==l.indexOf(e)});if(g){var m=n.indexOf(g);n=n.substr(m),l=l.substr(m),u+=m}a.push(new Gv({tagBuilder:o,matchedText:n,offset:u,urlMatchType:l?"scheme":h?"www":"tld",url:n,protocolUrlMatch:!!l,protocolRelativeMatch:!!d,stripPrefix:i,stripTrailingSlash:r,decodePercentEncoding:s}))},c=this;null!==(t=n.exec(e));)l();return a},t.prototype.matchHasUnbalancedClosingParen=function(e){var t,n=e.charAt(e.length-1);if(")"===n)t="(";else if("]"===n)t="[";else{if("}"!==n)return!1;t="{"}for(var i=0,r=0,s=e.length-1;r<s;r++){var o=e.charAt(r);o===t?i++:o===n&&(i=Math.max(i-1,0))}return 0===i},t.prototype.matchHasInvalidCharAfterTld=function(e,t){if(!e)return-1;var n=0;t&&(n=e.indexOf(":"),e=e.slice(n));var i=new RegExp("^((.?//)?[-."+n_+"]*[-"+n_+"]\\.[-"+n_+"]+)").exec(e);return null===i?-1:(n+=i[1].length,e=e.slice(i[1].length),/^[^-.A-Za-z0-9:\/?#]/.test(e)?n:-1)},t}(Zv),b_=new RegExp("#[_"+n_+"]{1,139}(?![_"+n_+"])","g"),y_=new RegExp("[^"+n_+"]"),v_=function(e){function t(t){var n=e.call(this,t)||this;return n.serviceName="twitter",n.matcherRegex=b_,n.nonWordCharRegex=y_,n.serviceName=t.serviceName,n}return zv(t,e),t.prototype.parseMatches=function(e){for(var t,n=this.matcherRegex,i=this.nonWordCharRegex,r=this.serviceName,s=this.tagBuilder,o=[];null!==(t=n.exec(e));){var a=t.index,l=e.charAt(a-1);if(0===a||i.test(l)){var c=t[0],h=t[0].slice(1);o.push(new Uv({tagBuilder:s,matchedText:c,offset:a,serviceName:r,hashtag:h}))}}return o},t}(Zv),__=new RegExp(/(?:(?:(?:(\+)?\d{1,3}[-\040.]?)?\(?\d{3}\)?[-\040.]?\d{3}[-\040.]?\d{4})|(?:(\+)(?:9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)[-\040.]?(?:\d[-\040.]?){6,12}\d+))([,;]+[0-9]+#?)*/.source+"|"+/(0([1-9]{1}-?[1-9]\d{3}|[1-9]{2}-?\d{3}|[1-9]{2}\d{1}-?\d{2}|[1-9]{2}\d{2}-?\d{1})-?\d{4}|0[789]0-?\d{4}-?\d{4}|050-?\d{4}-?\d{4})/.source,"g"),w_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.matcherRegex=__,t}return zv(t,e),t.prototype.parseMatches=function(e){for(var t,n=this.matcherRegex,i=this.tagBuilder,r=[];null!==(t=n.exec(e));){var s=t[0],o=s.replace(/[^0-9,;#]/g,""),a=!(!t[1]&&!t[2]),l=0==t.index?"":e.substr(t.index-1,1),c=e.substr(t.index+s.length,1),h=!l.match(/\d/)&&!c.match(/\d/);this.testMatch(t[3])&&this.testMatch(s)&&h&&r.push(new Vv({tagBuilder:i,matchedText:s,offset:t.index,number:o,plusSign:a}))}return r},t.prototype.testMatch=function(e){return qv.test(e)},t}(Zv),C_=new RegExp("@[_"+n_+"]{1,50}(?![_"+n_+"])","g"),x_=new RegExp("@[_."+n_+"]{1,30}(?![_"+n_+"])","g"),E_=new RegExp("@[-_."+n_+"]{1,50}(?![-_"+n_+"])","g"),k_=new RegExp("[^"+n_+"]"),S_=function(e){function t(t){var n=e.call(this,t)||this;return n.serviceName="twitter",n.matcherRegexes={twitter:C_,instagram:x_,soundcloud:E_},n.nonWordCharRegex=k_,n.serviceName=t.serviceName,n}return zv(t,e),t.prototype.parseMatches=function(e){var t,n=this.serviceName,i=this.matcherRegexes[this.serviceName],r=this.nonWordCharRegex,s=this.tagBuilder,o=[];if(!i)return o;for(;null!==(t=i.exec(e));){var a=t.index,l=e.charAt(a-1);if(0===a||r.test(l)){var c=t[0].replace(/\.+$/g,""),h=c.slice(1);o.push(new Hv({tagBuilder:s,matchedText:c,offset:a,serviceName:n,mention:h}))}}return o},t}(Zv),T_=function(){return function(e){void 0===e&&(e={}),this.idx=void 0!==e.idx?e.idx:-1,this.type=e.type||"tag",this.name=e.name||"",this.isOpening=!!e.isOpening,this.isClosing=!!e.isClosing}}(),O_=function(){function e(t){void 0===t&&(t={}),this.version=e.version,this.urls={},this.email=!0,this.phone=!0,this.hashtag=!1,this.mention=!1,this.newWindow=!0,this.stripPrefix={scheme:!0,www:!0},this.stripTrailingSlash=!0,this.decodePercentEncoding=!0,this.truncate={length:0,location:"end"},this.className="",this.replaceFn=null,this.context=void 0,this.sanitizeHtml=!1,this.matchers=null,this.tagBuilder=null,this.urls=this.normalizeUrlsCfg(t.urls),this.email="boolean"==typeof t.email?t.email:this.email,this.phone="boolean"==typeof t.phone?t.phone:this.phone,this.hashtag=t.hashtag||this.hashtag,this.mention=t.mention||this.mention,this.newWindow="boolean"==typeof t.newWindow?t.newWindow:this.newWindow,this.stripPrefix=this.normalizeStripPrefixCfg(t.stripPrefix),this.stripTrailingSlash="boolean"==typeof t.stripTrailingSlash?t.stripTrailingSlash:this.stripTrailingSlash,this.decodePercentEncoding="boolean"==typeof t.decodePercentEncoding?t.decodePercentEncoding:this.decodePercentEncoding,this.sanitizeHtml=t.sanitizeHtml||!1;var n=this.mention;if(!1!==n&&"twitter"!==n&&"instagram"!==n&&"soundcloud"!==n)throw new Error("invalid `mention` cfg - see docs");var i=this.hashtag;if(!1!==i&&"twitter"!==i&&"facebook"!==i&&"instagram"!==i)throw new Error("invalid `hashtag` cfg - see docs");this.truncate=this.normalizeTruncateCfg(t.truncate),this.className=t.className||this.className,this.replaceFn=t.replaceFn||this.replaceFn,this.context=t.context||this}return e.link=function(t,n){return new e(n).link(t)},e.parse=function(t,n){return new e(n).parse(t)},e.prototype.normalizeUrlsCfg=function(e){return null==e&&(e=!0),"boolean"==typeof e?{schemeMatches:e,wwwMatches:e,tldMatches:e}:{schemeMatches:"boolean"!=typeof e.schemeMatches||e.schemeMatches,wwwMatches:"boolean"!=typeof e.wwwMatches||e.wwwMatches,tldMatches:"boolean"!=typeof e.tldMatches||e.tldMatches}},e.prototype.normalizeStripPrefixCfg=function(e){return null==e&&(e=!0),"boolean"==typeof e?{scheme:e,www:e}:{scheme:"boolean"!=typeof e.scheme||e.scheme,www:"boolean"!=typeof e.www||e.www}},e.prototype.normalizeTruncateCfg=function(e){return"number"==typeof e?{length:e,location:"end"}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&void 0===e[n]&&(e[n]=t[n]);return e}(e||{},{length:Number.POSITIVE_INFINITY,location:"end"})},e.prototype.parse=function(e){var t=this,n=["a","style","script"],i=0,r=[];return function(e,t){for(var n,i=t.onOpenTag,r=t.onCloseTag,s=t.onText,o=t.onComment,a=t.onDoctype,l=new T_,c=0,h=e.length,u=0,d=0,p=l;c<h;){var f=e.charAt(c);switch(u){case 0:g(f);break;case 1:m(f);break;case 2:y(f);break;case 3:b(f);break;case 4:v(f);break;case 5:_(f);break;case 6:w(f);break;case 7:C(f);break;case 8:x(f);break;case 9:E(f);break;case 10:k(f);break;case 11:S(f);break;case 12:T(f);break;case 13:"--"===e.substr(c,2)?(c+=2,p=new T_(Bv(Bv({},p),{type:"comment"})),u=14):"DOCTYPE"===e.substr(c,7).toUpperCase()?(c+=7,p=new T_(Bv(Bv({},p),{type:"doctype"})),u=20):F();break;case 14:O(f);break;case 15:I(f);break;case 16:M(f);break;case 17:A(f);break;case 18:P(f);break;case 19:D(f);break;case 20:R(f);break;default:Pv(u)}c++}function g(e){"<"===e&&N()}function m(e){"!"===e?u=13:"/"===e?(u=2,p=new T_(Bv(Bv({},p),{isClosing:!0}))):"<"===e?N():Wv.test(e)?(u=3,p=new T_(Bv(Bv({},p),{isOpening:!0}))):(u=0,p=l)}function b(e){$v.test(e)?(p=new T_(Bv(Bv({},p),{name:L()})),u=4):"<"===e?N():"/"===e?(p=new T_(Bv(Bv({},p),{name:L()})),u=12):">"===e?(p=new T_(Bv(Bv({},p),{name:L()})),z()):Wv.test(e)||Yv.test(e)||":"===e||F()}function y(e){">"===e?F():Wv.test(e)?u=3:F()}function v(e){$v.test(e)||("/"===e?u=12:">"===e?z():"<"===e?N():"="===e||Xv.test(e)||Kv.test(e)?F():u=5)}function _(e){$v.test(e)?u=6:"/"===e?u=12:"="===e?u=7:">"===e?z():"<"===e?N():Xv.test(e)&&F()}function w(e){$v.test(e)||("/"===e?u=12:"="===e?u=7:">"===e?z():"<"===e?N():Xv.test(e)?F():u=5)}function C(e){$v.test(e)||('"'===e?u=8:"'"===e?u=9:/[>=`]/.test(e)?F():"<"===e?N():u=10)}function x(e){'"'===e&&(u=11)}function E(e){"'"===e&&(u=11)}function k(e){$v.test(e)?u=4:">"===e?z():"<"===e&&N()}function S(e){$v.test(e)?u=4:"/"===e?u=12:">"===e?z():"<"===e?N():(u=4,c--)}function T(e){">"===e?(p=new T_(Bv(Bv({},p),{isClosing:!0})),z()):u=4}function O(e){"-"===e?u=15:">"===e?F():u=16}function I(e){"-"===e?u=18:">"===e?F():u=16}function M(e){"-"===e&&(u=17)}function A(e){u="-"===e?18:16}function P(e){">"===e?z():"!"===e?u=19:"-"===e||(u=16)}function D(e){"-"===e?u=17:">"===e?z():u=16}function R(e){">"===e?z():"<"===e&&N()}function F(){u=0,p=l}function N(){u=1,p=new T_({idx:c})}function z(){var t=e.slice(d,p.idx);t&&s(t,d),"comment"===p.type?o(p.idx):"doctype"===p.type?a(p.idx):(p.isOpening&&i(p.name,p.idx),p.isClosing&&r(p.name,p.idx)),F(),d=c+1}function L(){return e.slice(p.idx+(p.isClosing?2:1),c).toLowerCase()}d<c&&(n=e.slice(d,c),s(n,d),d=c+1)}(e,{onOpenTag:function(e){n.indexOf(e)>=0&&i++},onText:function(e,n){if(0===i){var s=function(e,t){if(!t.global)throw new Error("`splitRegex` must have the 'g' flag set");for(var n,i=[],r=0;n=t.exec(e);)i.push(e.substring(r,n.index)),i.push(n[0]),r=n.index+n[0].length;return i.push(e.substring(r)),i}(e,/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi),o=n;s.forEach(function(e,n){if(n%2==0){var i=t.parseText(e,o);r.push.apply(r,i)}o+=e.length})}},onCloseTag:function(e){n.indexOf(e)>=0&&(i=Math.max(i-1,0))},onComment:function(e){},onDoctype:function(e){}}),r=this.compactMatches(r),r=this.removeUnwantedMatches(r)},e.prototype.compactMatches=function(e){e.sort(function(e,t){return e.getOffset()-t.getOffset()});for(var t=0;t<e.length-1;t++){var n=e[t],i=n.getOffset(),r=n.getMatchedText().length,s=i+r;if(t+1<e.length){if(e[t+1].getOffset()===i){var o=e[t+1].getMatchedText().length>r?t:t+1;e.splice(o,1);continue}e[t+1].getOffset()<s&&e.splice(t+1,1)}}return e},e.prototype.removeUnwantedMatches=function(e){return this.hashtag||Av(e,function(e){return"hashtag"===e.getType()}),this.email||Av(e,function(e){return"email"===e.getType()}),this.phone||Av(e,function(e){return"phone"===e.getType()}),this.mention||Av(e,function(e){return"mention"===e.getType()}),this.urls.schemeMatches||Av(e,function(e){return"url"===e.getType()&&"scheme"===e.getUrlMatchType()}),this.urls.wwwMatches||Av(e,function(e){return"url"===e.getType()&&"www"===e.getUrlMatchType()}),this.urls.tldMatches||Av(e,function(e){return"url"===e.getType()&&"tld"===e.getUrlMatchType()}),e},e.prototype.parseText=function(e,t){void 0===t&&(t=0),t=t||0;for(var n=this.getMatchers(),i=[],r=0,s=n.length;r<s;r++){for(var o=n[r].parseMatches(e),a=0,l=o.length;a<l;a++)o[a].setOffset(t+o[a].getOffset());i.push.apply(i,o)}return i},e.prototype.link=function(e){if(!e)return"";this.sanitizeHtml&&(e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;"));for(var t=this.parse(e),n=[],i=0,r=0,s=t.length;r<s;r++){var o=t[r];n.push(e.substring(i,o.getOffset())),n.push(this.createMatchReturnVal(o)),i=o.getOffset()+o.getMatchedText().length}return n.push(e.substring(i)),n.join("")},e.prototype.createMatchReturnVal=function(e){var t;return this.replaceFn&&(t=this.replaceFn.call(this.context,e)),"string"==typeof t?t:!1===t?e.getMatchedText():t instanceof Dv?t.toAnchorString():e.buildTag().toAnchorString()},e.prototype.getMatchers=function(){if(this.matchers)return this.matchers;var e=this.getTagBuilder(),t=[new v_({tagBuilder:e,serviceName:this.hashtag}),new u_({tagBuilder:e}),new w_({tagBuilder:e}),new S_({tagBuilder:e,serviceName:this.mention}),new m_({tagBuilder:e,stripPrefix:this.stripPrefix,stripTrailingSlash:this.stripTrailingSlash,decodePercentEncoding:this.decodePercentEncoding})];return this.matchers=t},e.prototype.getTagBuilder=function(){var e=this.tagBuilder;return e||(e=this.tagBuilder=new Rv({newWindow:this.newWindow,truncate:this.truncate,className:this.className})),e},e.version="3.14.3",e.AnchorTagBuilder=Rv,e.HtmlTag=Dv,e.matcher={Email:u_,Hashtag:v_,Matcher:Zv,Mention:S_,Phone:w_,Url:m_},e.match={Email:jv,Hashtag:Uv,Match:Fv,Mention:Hv,Phone:Vv,Url:Gv},e}();let I_=(()=>{class e{transform(e,t){return O_.link(e,t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=Je({name:"linky",type:e,pure:!0}),e})(),M_=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Xe({type:e}),e.\u0275inj=fe({}),e})();const A_=["message"];function P_(e,t){if(1&e&&(Io(0,"span"),Io(1,"pre",1),ga(2),Mo(),Mo()),2&e){const e=jo();Zr(2),ma(e.text)}}function D_(e,t){1&e&&Ao(0,"hr")}const R_=function(){return{schemeMatches:!0,wwwMatches:!0,tldMatches:!1}},F_=function(e){return{urls:e,decodePercentEncoding:!1,stripPrefix:!1,email:!1,phone:!1}};function N_(e,t){if(1&e&&(Io(0,"pre",1),Ao(1,"span",3,4),ql(3,"linky"),Eo(4,D_,1,0,"hr",0),Mo()),2&e){const e=t.$implicit,n=t.last,i=jo(2);Zr(1),To("innerHTML",$l(3,2,i.stringUtil.escapeHtml(e),Ul(6,F_,jl(5,R_))),$i),Zr(3),To("ngIf",!n)}}function z_(e,t){if(1&e&&(Io(0,"span"),Eo(1,N_,5,8,"pre",2),Mo()),2&e){const e=jo();Zr(1),To("ngForOf",e.text)}}let L_=(()=>{class e{constructor(e,t){this.panelService=e,this.modalService=t,this.text="",this.title="",this.stringUtil=rv}ngOnInit(){Promise.resolve().then(()=>{this.panelService.title=this.title,this.modalService.option&&null!=this.modalService.option.title&&(this.modalService.title=this.modalService.option.title?this.modalService.option.title:"",this.text=this.modalService.option.text?this.modalService.option.text:"")})}ngAfterViewInit(){this.messageElm&&this.messageElm.nativeElement.querySelectorAll("A[href]").forEach(e=>{const t=e.getAttribute("href");rv.validUrl(t)?e.addEventListener("click",e=>{e.stopPropagation(),e.preventDefault(),this.modalService.open(Iv,{url:t})},!0):(e.removeAttribute("href"),e.removeAttribute("target"))})}isObj(e){return"object"==typeof e}}return e.\u0275fac=function(t){return new(t||e)(So(wv),So(xv))},e.\u0275cmp=Ze({type:e,selectors:[["text-view"]],viewQuery:function(e,t){if(1&e&&cc(A_,1),2&e){let e;lc(e=hc())&&(t.messageElm=e.first)}},inputs:{text:"text",title:"title"},decls:2,vars:2,consts:[[4,"ngIf"],[1,"text"],["class","text",4,"ngFor","ngForOf"],[3,"innerHTML"],["message",""]],template:function(e,t){1&e&&(Eo(0,P_,3,1,"span",0),Eo(1,z_,2,1,"span",0)),2&e&&(To("ngIf",!t.isObj(t.text)),Zr(1),To("ngIf",t.isObj(t.text)))},directives:[Zh,Vh],pipes:[I_],styles:[".text[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;font-size:12px;white-space:pre-wrap;margin:0}"]}),e})();const B_={name:"",disabled:!0,type:function(e){return e.ACTION="action",e.SEPARATOR="separator",e}({}).SEPARATOR};let j_=(()=>{class e{constructor(e){this.componentFactoryResolver=e,this.title="",this.actions=[],this.position={x:0,y:0},this.titleColor=av.CHAT_DEFAULT_COLOR,this.titleBold=!1}get isShow(){return!!this.panelComponentRef}open(t,n,i,r,s,o){let a;this.close(),r||(r=e.defaultParentViewContainerRef,console.log("Context Open"));const l=r.injector,c=this.componentFactoryResolver.resolveComponentFactory(e.ContextMenuComponentClass);a=r.createComponent(c,r.length,l);const h=a.injector.get(e);h.panelComponentRef=a,n&&(h.actions=n),t&&(h.position.x=t.x,h.position.y=t.y),h.titleColor=s||av.CHAT_DEFAULT_COLOR,h.titleBold=o,h.title=null!=i?i:"",a.onDestroy(()=>{h.panelComponentRef=null})}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}}return e.ContextMenuComponentClass=null,e.\u0275fac=function(t){return new(t||e)(oi(La))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();var U_=function(e){return e[e.NULL=0]="NULL",e[e.THUMBNAIL=1]="THUMBNAIL",e[e.COMPLETE=2]="COMPLETE",e[e.URL=1e3]="URL",e}({});class H_{constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:""},this.isHidden=!1}get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob}get url(){return this.context.url}get isReady(){return U_.NULL<this.state}get state(){return this.url||this.blob?this.url&&!this.blob?U_.URL:U_.COMPLETE:U_.NULL}static createEmpty(e){let t=new H_;return t.context.identifier=e,t}static create(e){if("string"==typeof e){let t=new H_;return t.context.identifier=e,t.context.name=e,t.context.url=e,t}{let t=new H_;return t.apply(e),t}}static createAsync(e){return xg(this,void 0,void 0,function*(){return e instanceof File?yield H_._createAsync(e,e.name):e instanceof Blob?yield H_._createAsync(e):void 0})}static _createAsync(e,t){return xg(this,void 0,void 0,function*(){let n=yield kg.readAsArrayBufferAsync(e),i=new H_;return i.context.identifier=yield kg.calcSHA256Async(n),i.context.name=t,i.context.blob=new Blob([n],{type:e.type}),i.context.type=i.context.blob.type,i.context.url=window.URL.createObjectURL(i.context.blob),i.context.name||(i.context.name=i.context.identifier),i})}destroy(){this.revokeURLs()}apply(e){!this.context.identifier&&e.identifier&&(this.context.identifier=e.identifier),e.name&&(this.context.name=e.name),!this.context.blob&&e.blob&&(this.context.blob=e.blob),!this.context.type&&e.type&&(this.context.type=e.type),!this.context.url&&e.url&&(this.state!==U_.URL&&window.URL.revokeObjectURL(this.context.url),this.context.url=e.url),this.createURLs()}createURLs(){this.state!==U_.URL&&this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob))}revokeURLs(){this.state!==U_.URL&&window.URL.revokeObjectURL(this.context.url)}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url}}}var V_=function(e){return e[e.MASTER=0]="MASTER",e[e.AUDITION=1]="AUDITION",e}({});let G_=(()=>{class e{constructor(e){this.volumeType=V_.MASTER,this.audio=e}static get audioContext(){return e._audioContext||(e._audioContext=new(window.AudioContext||window.webkitAudioContext)),e._audioContext}static get volume(){return e._volume}static set volume(t){e._volume=t,e.masterGainNode.gain.setTargetAtTime(e._volume,e.audioContext.currentTime,.01)}static get auditionVolume(){return e._auditionVolume}static set auditionVolume(t){e._auditionVolume=t,e.auditionGainNode.gain.setTargetAtTime(e._auditionVolume,e.audioContext.currentTime,.01)}static get masterGainNode(){if(!e._masterGainNode){let t=e.audioContext.createGain();t.gain.setValueAtTime(e._volume,e.audioContext.currentTime),t.connect(e.audioContext.destination),e._masterGainNode=t}return e._masterGainNode}static get auditionGainNode(){if(!e._auditionGainNode){let t=e.audioContext.createGain();t.gain.setValueAtTime(e._auditionVolume,e.audioContext.currentTime),t.connect(e.audioContext.destination),e._auditionGainNode=t}return e._auditionGainNode}static get rootNode(){return e.masterGainNode}static get auditionNode(){return e.auditionGainNode}get audioElm(){return this._audioElm||(this._audioElm=new Audio,this._audioElm.onplay=()=>{},this._audioElm.onpause=()=>{this.mediaElementSource.disconnect()},this._audioElm.onended=()=>{this.mediaElementSource.disconnect()}),this._audioElm}get mediaElementSource(){return this._mediaElementSource||(this._mediaElementSource=e.audioContext.createMediaElementSource(this.audioElm)),this._mediaElementSource}get volume(){return this.audioElm.volume}set volume(e){this.audioElm.volume=e}get loop(){return this.audioElm.loop}set loop(e){this.audioElm.loop=e}get paused(){return this.audioElm.paused}static play(e,t=1){this.playBufferAsync(e,t)}play(t=this.audio){if(this.stop(),this.audio=t,!this.audio)return;let n=this.audio.url;t.state===U_.URL&&(e.cacheMap.has(t.identifier)?n=e.cacheMap.get(t.identifier).url:e.createCacheAsync(t)),this.mediaElementSource.connect(this.getConnectingAudioNode()),this.audioElm.src=n,this.audioElm.load(),this.audioElm.play().catch(e=>{console.warn(e)})}pause(){this.audioElm.pause()}stop(){this.audioElm&&(this.pause(),this.audioElm.currentTime=0,this.audioElm.src="",this.audioElm.load(),this.mediaElementSource.disconnect())}getConnectingAudioNode(){switch(this.volumeType){case V_.AUDITION:return e.auditionNode;default:return e.rootNode}}static playBufferAsync(t,n=1){return xg(this,void 0,void 0,function*(){let i=yield e.createBufferSourceAsync(t);if(!i)return;let r=e.audioContext.createGain();r.gain.setValueAtTime(n,e.audioContext.currentTime),r.connect(e.rootNode),i.connect(r),i.onended=()=>{i.stop(),i.disconnect(),r.disconnect(),i.buffer=null},i.start()})}static createBufferSourceAsync(t){return xg(this,void 0,void 0,function*(){if(!t)return null;try{let n=t.blob;if(t.state===U_.URL)if(e.cacheMap.has(t.identifier))n=e.cacheMap.get(t.identifier).blob;else{let i=yield e.createCacheAsync(t);n=i&&i.blob?i.blob:null}if(!n)return null;let i=yield this.decodeAudioDataAsync(n),r=e.audioContext.createBufferSource();return r.buffer=i,r}catch(n){return console.warn(n),null}})}static decodeAudioDataAsync(t){return new Promise((n,i)=>xg(this,void 0,void 0,function*(){e.audioContext.decodeAudioData(yield kg.readAsArrayBufferAsync(t),e=>n(e),e=>i(e))}))}static getBlobAsync(e){return xg(this,void 0,void 0,function*(){if(e.blob)return e.blob;if(e.url.length<1)throw new Error("\u3048\u3063 \u306a\u306b\u305d\u308c\u6016\u3044");try{let t=yield fetch(e.url);if(!t.ok)throw new Error("Network response was not ok.");return yield t.blob()}catch(t){throw console.warn("There has been a problem with your fetch operation: ",t.message),t}})}static createCacheAsync(t){return xg(this,void 0,void 0,function*(){let n={url:t.url,blob:null};try{n.blob=yield e.getBlobAsync(t)}catch(i){return console.error(i),n}return e.cacheMap.has(t.identifier)?e.cacheMap.get(t.identifier):(n.url=URL.createObjectURL(n.blob),e.cacheMap.set(t.identifier,n),n)})}static resumeAudioContext(){e.audioContext.resume();let t=()=>{e.audioContext.resume(),document.removeEventListener("touchstart",t,!0),document.removeEventListener("mousedown",t,!0),console.log("resumeAudioContext")};document.addEventListener("touchstart",t,!0),document.addEventListener("mousedown",t,!0)}}return e._volume=.5,e._auditionVolume=.5,e.cacheMap=new Map,e})();class Z_{constructor(){this.hash={},console.log("AudioStorage ready...")}static get instance(){return Z_._instance||(Z_._instance=new Z_),Z_._instance}get audios(){let e=[];for(let t in this.hash)e.push(this.hash[t]);return e}destroy(){for(let e in this.hash)this.delete(e)}addAsync(e){return xg(this,void 0,void 0,function*(){let t=yield H_.createAsync(e);return this._add(t)})}add(e){let t;if("string"==typeof e)t=H_.create(e);else if(e instanceof H_)t=e;else{if(this.update(e))return this.hash[e.identifier];t=H_.create(e)}return this._add(t)}_add(e){return U_.COMPLETE<=e.state&&this.lazySynchronize(100),this.update(e)?this.hash[e.identifier]:(this.hash[e.identifier]=e,console.log("add Audio: "+e.identifier),e)}update(e){let t;t=e instanceof H_?e.toContext():e;let n=this.hash[e.identifier];return!!n&&(n.apply(e),!0)}delete(e){let t=this.hash[e];return!!t&&(t.destroy(),delete this.hash[e],!0)}get(e){return this.hash[e]||null}synchronize(e){this.lazyTimer&&this.lazyTimer.stop(),Uy.call("SYNCHRONIZE_AUDIO_LIST",this.getCatalog(),e)}lazySynchronize(e,t){null==this.lazyTimer&&(this.lazyTimer=new Gy(()=>this.synchronize(t),e)),this.lazyTimer.reset(e)}getCatalog(){let e=[];for(let t of Z_.instance.audios)U_.COMPLETE<=t.state&&e.push({identifier:t.identifier,state:t.state});return e}}var W_;let Y_=(()=>{class e{}return e.dicePick="",e.dicePut="",e.diceRoll1="",e.diceRoll2="",e.cardDraw="",e.cardPick="",e.cardPut="",e.cardShuffle="",e.piecePick="",e.piecePut="",e.blockPick="",e.blockPut="",e.lock="",e.unlock="",e.sweep="",e.puyon="",e.surprise="",e})(),q_=(()=>{let e=W_=class extends Ky{onStoreAdded(){super.onStoreAdded(),Uy.register(this).on("SOUND_EFFECT",e=>{G_.play(Z_.instance.get(e.data),.5)}).on("SEND_MESSAGE",e=>{let t=Vy.instance.get(e.data.messageIdentifier);t&&t.isSendFromSelf&&t.isDicebot&&(Math.random()<.5?W_.play(Y_.diceRoll1):W_.play(Y_.diceRoll2))})}onStoreRemoved(){super.onStoreRemoved(),Uy.unregister(this)}play(e){W_.play(e)}static play(e){let t="";t="string"==typeof e?e:e.identifier,W_._play(t)}static _play(e){Uy.call("SOUND_EFFECT",e)}};return e=W_=Cg([tv("sound-effect")],e),e})(),$_=(()=>{class e{constructor(e){this._sanitizer=e}transform(e,t="html"){switch(t){case"html":return this._sanitizer.bypassSecurityTrustHtml(e);case"style":return this._sanitizer.bypassSecurityTrustStyle(e);case"script":return this._sanitizer.bypassSecurityTrustScript(e);case"url":return this._sanitizer.bypassSecurityTrustUrl(e);case"resourceUrl":return this._sanitizer.bypassSecurityTrustResourceUrl(e);default:throw new Error(`Invalid safe type specified: ${t}`)}}}return e.\u0275fac=function(t){return new(t||e)(So(Ou))},e.\u0275pipe=Je({name:"safe",type:e,pure:!0}),e})();function X_(e,t){if(1&e){const e=Fo();Io(0,"span",3),Io(1,"button",4),zo("click",function(){Ft(e);const t=jo();return t.onSelectedFile(t.empty)}),ga(2,"\u753b\u50cf\u306a\u3057"),Mo(),Mo()}}function K_(e,t){if(1&e){const e=Fo();Io(0,"img",8),zo("click",function(){Ft(e);const t=jo().$implicit;return jo().onSelectedFile(t)}),ql(1,"safe"),Mo()}if(2&e){const e=jo().$implicit;To("src",$l(1,2,e.url,"resourceUrl"),Xi)("alt",e.name)}}function Q_(e,t){1&e&&Ao(0,"img",9),2&e&&Go("alt",jo().$implicit.name)}function J_(e,t){if(1&e&&(Io(0,"span",5),Eo(1,K_,2,5,"img",6),Eo(2,Q_,1,1,"img",7),Mo()),2&e){const e=t.$implicit;Zr(1),To("ngIf",0<e.url.length),Zr(1),To("ngIf",e.url.length<=0)}}let ew=(()=>{class e{constructor(e,t,n){this.changeDetector=e,this.panelService=t,this.modalService=n,this.isAllowedEmpty=!1,this.isAllowedEmpty=!(!this.modalService.option||!this.modalService.option.isAllowedEmpty)}get images(){return ov.instance.images}get empty(){return Ig.Empty}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7")}ngAfterViewInit(){Uy.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){Uy.unregister(this)}onSelectedFile(e){Uy.call("SELECT_FILE",{fileIdentifier:e.identifier},Hy.peerId),this.modalService.resolve(e.identifier)}}return e.\u0275fac=function(t){return new(t||e)(So(fl),So(wv),So(xv))},e.\u0275cmp=Ze({type:e,selectors:[["file-selector"]],inputs:{isAllowedEmpty:"isAllowedEmpty"},decls:3,vars:2,consts:[["id","file-list"],["class","empty",4,"ngIf"],["class","image",4,"ngFor","ngForOf"],[1,"empty"],[3,"click"],[1,"image"],["height","120",3,"src","alt","click",4,"ngIf"],["src","./assets/images/loading.gif",3,"alt",4,"ngIf"],["height","120",3,"src","alt","click"],["src","./assets/images/loading.gif",3,"alt"]],template:function(e,t){1&e&&(Io(0,"div",0),Eo(1,X_,3,0,"span",1),Eo(2,J_,3,2,"span",2),Mo()),2&e&&(Zr(1),To("ngIf",t.isAllowedEmpty),Zr(1),To("ngForOf",t.images))},directives:[Zh,Vh],pipes:[$_],styles:[".image[_ngcontent-%COMP%]{font-size:0}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom}.empty[_ngcontent-%COMP%]{line-height:120px;vertical-align:middle}.empty[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:100px}"],changeDetection:0}),e})();function tw(e,t=[]){let n=Vy.instance.getObjects(e.aliasName);t.forEach(e=>n=n.concat(Vy.instance.getObjects(e))),n=n.filter(e=>e.isVisibleOnTable);let i=-1,r=!1;for(let s=0;s<n.length;s++)i===n[s].zindex?r=!0:i<n[s].zindex&&(i=n[s].zindex,r=!1);if((i!==e.zindex||r)&&(e.zindex=i+1,!(e.zindex<n.length+256))){n.sort((e,t)=>e.zindex-t.zindex);for(let e=0;e<n.length;e++)n[e].zindex=e}}var nw,iw=function(e){return e[e.FRONT=0]="FRONT",e[e.BACK=1]="BACK",e}({});let rw=(()=>{let e=nw=class extends uv{constructor(){super(...arguments),this.state=iw.FRONT,this.rotate=0,this.owner="",this.zindex=0}get isVisibleOnTable(){return"table"===this.location.name&&(!this.parentIsAssigned||this.parentIsDestroyed)}get name(){return this.getCommonValue("name","")}get size(){return this.getCommonValue("size",2)}set size(e){this.setCommonValue("size",e)}get frontImage(){return this.getImageFile("front")}get backImage(){return this.getImageFile("back")}get imageFile(){return this.isVisible?this.frontImage:this.backImage}get ownerName(){let e=av.findByUserId(this.owner);return e?e.name:""}get ownerColor(){let e=av.findByUserId(this.owner);return e?e.color:"#444444"}get hasOwner(){return 0<this.owner.length}get isHand(){return Hy.peerContext.userId===this.owner}get isFront(){return this.state===iw.FRONT}get isVisible(){return this.isHand||this.isFront}faceUp(){this.state=iw.FRONT,this.owner=""}faceDown(){this.state=iw.BACK,this.owner=""}toTopmost(){tw(this,["card-stack"])}static create(e,t,n,i=2,r){let s=null;return s=r?new nw(r):new nw,s.createDataElements(),s.commonDataElement.appendChild(hv.create("name",e,{},"name_"+s.identifier)),s.commonDataElement.appendChild(hv.create("size",i,{},"size_"+s.identifier)),s.imageDataElement.appendChild(hv.create("front",t,{type:"image"},"front_"+s.identifier)),s.imageDataElement.appendChild(hv.create("back",n,{type:"image"},"back_"+s.identifier)),s.initialize(),s}};return Cg([nv()],e.prototype,"state",void 0),Cg([nv()],e.prototype,"rotate",void 0),Cg([nv()],e.prototype,"owner",void 0),Cg([nv()],e.prototype,"zindex",void 0),e=nw=Cg([tv("card")],e),e})();var sw;let ow=(()=>{let e=sw=class extends uv{constructor(){super(...arguments),this.rotate=0,this.zindex=0,this.owner="",this.isShowTotal=!0}get name(){return this.getCommonValue("name","")}get ownerName(){let e=av.findByUserId(this.owner);return e?e.name:""}get ownerColor(){let e=av.findByUserId(this.owner);return e?e.color:"#444444"}get hasOwner(){return 0<this.owner.length}get cardRoot(){for(let e of this.children)if("cardRoot"===e.getAttribute("name"))return e;return null}get cards(){return this.cardRoot?this.cardRoot.children:[]}get topCard(){return this.isEmpty?null:this.cards[0]}get isEmpty(){return this.cards.length<1}get imageFile(){return this.topCard?this.topCard.imageFile:null}onChildRemoved(e){super.onChildRemoved(e),e instanceof rw&&Uy.trigger("CARD_STACK_DECREASED",{cardStackIdentifier:this.identifier,cardIdentifier:e.identifier})}shuffle(){if(!this.cardRoot)return;let e=this.cardRoot.children.length;for(let t of this.cards)t.index=Math.random()*e,t.rotate=180*Math.floor(2*Math.random()),this.setSamePositionFor(t);return this.cards}drawCard(){let e=this.topCard?this.cardRoot.removeChild(this.topCard):null;return e&&(e.rotate+=this.rotate,360<e.rotate&&(e.rotate-=360),this.setSamePositionFor(e),e.toTopmost()),e}drawCardAll(){let e=this.cards;for(let t of e)this.cardRoot.removeChild(t),t.rotate+=this.rotate,this.setSamePositionFor(t),360<t.rotate&&(t.rotate-=360);return e}faceUp(){this.topCard&&(this.topCard.faceUp(),this.setSamePositionFor(this.topCard))}faceDown(){this.topCard&&(this.topCard.faceDown(),this.setSamePositionFor(this.topCard))}faceUpAll(){for(let e of this.cards)e.faceUp(),this.setSamePositionFor(e)}faceDownAll(){for(let e of this.cards)e.faceDown(),this.setSamePositionFor(e)}uprightAll(){for(let e of this.cards)e.rotate=0,this.setSamePositionFor(e)}inverse(){const e=[];for(;;){let t=this.topCard?this.cardRoot.removeChild(this.topCard):null;if(null==t)break;e.unshift(t),t.state=t.state==iw.FRONT?iw.BACK:iw.FRONT}for(let t of e)this.putOnBottom(t)}unifyCardsSize(e){for(const t of this.cards)t.size!==e&&(t.size=e)}putOnTop(e){if(!this.cardRoot)return null;if(!this.topCard)return this.putOnBottom(e);e.owner="",e.zindex=0;let t=Math.abs(e.rotate-this.rotate);return 180<t&&(t=360-t),e.rotate=t<=90?0:180,this.setSamePositionFor(e),this.cardRoot.insertBefore(e,this.topCard)}putOnBottom(e){if(!this.cardRoot)return null;e.owner="",e.zindex=0;let t=Math.abs(e.rotate-this.rotate);return 180<t&&(t=360-t),e.rotate=t<=90?0:180,this.setSamePositionFor(e),this.cardRoot.appendChild(e)}toTopmost(){tw(this,["card"])}setLocation(e){super.setLocation(e);let t=this.cards;for(let n of t)n.setLocation(e)}setSamePositionFor(e){e.location.name=this.location.name,e.location.x=this.location.x,e.location.y=this.location.y,e.posZ=this.posZ}static create(e,t){let n=null;n=t?new sw(t):new sw,n.createDataElements(),n.commonDataElement.appendChild(hv.create("name",e,{},"name_"+n.identifier));let i=new ev("cardRoot_"+n.identifier);return i.setAttribute("name","cardRoot"),i.initialize(),n.appendChild(i),n.initialize(),n}};return Cg([nv()],e.prototype,"rotate",void 0),Cg([nv()],e.prototype,"zindex",void 0),Cg([nv()],e.prototype,"owner",void 0),Cg([nv()],e.prototype,"isShowTotal",void 0),e=sw=Cg([tv("card-stack")],e),e})();var aw,lw=function(e){return e[e.D2=0]="D2",e[e.D4=1]="D4",e[e.D6=2]="D6",e[e.D8=3]="D8",e[e.D10=4]="D10",e[e.D10_10TIMES=5]="D10_10TIMES",e[e.D12=6]="D12",e[e.D20=7]="D20",e}({});let cw=(()=>{let e=aw=class extends uv{constructor(){super(...arguments),this.face="0",this.owner="",this.rotate=0,this.isDropShadow=!0,this.isLock=!1}get name(){return this.getCommonValue("name","")}set name(e){this.setCommonValue("name",e)}get size(){return this.getCommonValue("size",1)}set size(e){this.setCommonValue("size",e)}get faces(){return this.imageDataElement.children.filter(e=>"nothing"!=e.currentValue).map(e=>e.name)}get imageFile(){return this.isVisible?this.getImageFile(this.face):this.faces.length?this.getImageFile(this.faces[0]):null}get nothingFaces(){return this.imageDataElement.children.filter(e=>"nothing"==e.currentValue).map(e=>e.name)}get ownerName(){let e=av.findByUserId(this.owner);return e?e.name:""}get ownerColor(){let e=av.findByUserId(this.owner);return e?e.color:"#444444"}get hasOwner(){return 0<this.owner.length}get isMine(){return Hy.peerContext.userId===this.owner}get isVisible(){return!this.hasOwner||this.isMine}diceRoll(){let e=this.faces;return this.face=0<e.length?e[Math.floor(Math.random()*e.length)]:"",this.face}setDicetype(e){this.makeDiceFace(e)}makeDiceFace(e,t){let n=1,i=[],r=e=>e+1+"";switch(e){case lw.D2:n=2;break;case lw.D4:n=4;break;case lw.D6:n=6,i.push(hv.create("\u306a\u3057","",{type:"image",currentValue:"nothing"},null!=t?"nothing_"+t:null));break;case lw.D8:n=8;break;case lw.D10_10TIMES:r=e=>e+1+"0";case lw.D10:n=10;break;case lw.D12:n=12;break;case lw.D20:n=20;break;default:n=2}for(let s=0;s<n;s++){let e=r(s);i.push(hv.create(e,"",{type:"image"},null!=t?e+"_"+t:null))}return this.imageDataElement.children.forEach(e=>e.destroy()),i.forEach(e=>this.imageDataElement.appendChild(e)),this.face=this.faces[0],i}static create(e,t,n,i){let r=i?new aw(i):new aw;return r.createDataElements(),r.commonDataElement.appendChild(hv.create("name",e,{},"name_"+r.identifier)),r.commonDataElement.appendChild(hv.create("size",n,{},"size_"+r.identifier)),r.makeDiceFace(t,r.identifier),r.initialize(),r}};return Cg([nv()],e.prototype,"face",void 0),Cg([nv()],e.prototype,"owner",void 0),Cg([nv()],e.prototype,"rotate",void 0),Cg([nv()],e.prototype,"isDropShadow",void 0),Cg([nv()],e.prototype,"isLock",void 0),e=aw=Cg([tv("dice-symbol")],e),e})(),hw=(()=>{let e=class extends ev{constructor(){super(...arguments),this.aura=-1,this._sendTo=[],this._tags=[]}get tabIdentifier(){return this.parent.identifier}get text(){return this.value}get timestamp(){let e=this.getAttribute("timestamp"),t=e?+e:0;return Number.isNaN(t)?1:t}get sendTo(){return this._to!==this.to&&(this._to=this.to,this._sendTo=null!=this.to&&0<this.to.trim().length?this.to.trim().split(/\s+/):[]),this._sendTo}get tags(){return this._tag!==this.tag&&(this._tag=this.tag,this._tags=null!=this.tag&&0<this.tag.trim().length?this.tag.trim().split(/\s+/):[]),this._tags}get image(){return ov.instance.get(this.imageIdentifier)}get index(){return this.minorIndex+this.timestamp}get isDirect(){return 0<this.sendTo.length}get isSendFromSelf(){return this.from===Hy.peerContext.userId||this.originFrom===Hy.peerContext.userId}get isRelatedToMe(){return!!(-1<this.sendTo.indexOf(Hy.peerContext.userId)||this.isSendFromSelf)}get isDisplayable(){return!this.isDirect||this.isRelatedToMe}get isSystem(){return-1<this.tags.indexOf("system")}get isDicebot(){return!!(this.isSystem&&this.from.indexOf("Dice")>=0&&this.text.indexOf(": \u8a08\u7b97\u7d50\u679c \u2192")<0)}get isCalculate(){return!!(this.isSystem&&this.from.indexOf("Dice")>=0&&this.text.indexOf(": \u8a08\u7b97\u7d50\u679c \u2192")>-1)}get isSecret(){return-1<this.tags.indexOf("secret")}get isSpecialColor(){return this.isDirect||this.isSecret||this.isSystem||this.isDicebot||this.isCalculate}};return Cg([nv()],e.prototype,"originFrom",void 0),Cg([nv()],e.prototype,"from",void 0),Cg([nv()],e.prototype,"to",void 0),Cg([nv()],e.prototype,"name",void 0),Cg([nv()],e.prototype,"tag",void 0),Cg([nv()],e.prototype,"dicebot",void 0),Cg([nv()],e.prototype,"imageIdentifier",void 0),Cg([nv()],e.prototype,"color",void 0),Cg([nv()],e.prototype,"isInverseIcon",void 0),Cg([nv()],e.prototype,"isHollowIcon",void 0),Cg([nv()],e.prototype,"isBlackPaint",void 0),Cg([nv()],e.prototype,"aura",void 0),Cg([nv()],e.prototype,"characterIdentifier",void 0),Cg([nv()],e.prototype,"standIdentifier",void 0),Cg([nv()],e.prototype,"standName",void 0),Cg([nv()],e.prototype,"isUseStandImage",void 0),e=Cg([tv("chat")],e),e})(),uw=(()=>{let e=class extends ev{constructor(){super(...arguments),this.name="\u30bf\u30d6",this.isUseStandImage=!0,this._unreadLength=0}get chatMessages(){return this.children}get unreadLength(){return this._unreadLength}get hasUnread(){return 0<this.unreadLength}get latestTimeStamp(){let e=this.chatMessages.length-1;return e<0?0:this.chatMessages[e].timestamp}onChildAdded(e){super.onChildAdded(e),e.parent===this&&e instanceof hw&&e.isDisplayable&&(this._unreadLength++,Uy.trigger("MESSAGE_ADDED",{tabIdentifier:this.identifier,messageIdentifier:e.identifier}))}addMessage(e){e.tabIdentifier=this.identifier;let t=new hw;for(let n in e)"identifier"!==n&&"tabIdentifier"!==n&&("text"!==n?null!=e[n]&&""!==e[n]&&t.setAttribute(n,e[n]):t.value=e[n]);return t.initialize(),Uy.trigger("SEND_MESSAGE",{tabIdentifier:this.identifier,messageIdentifier:t.identifier}),this.appendChild(t),t}markForRead(){this._unreadLength=0}innerXml(){let e="";for(let t of this.children)t instanceof hw&&!t.isDisplayable||(e+=Xy.instance.toXml(t));return e}parseInnerXml(e){return super.parseInnerXml(e)}};return Cg([nv()],e.prototype,"name",void 0),Cg([nv()],e.prototype,"isUseStandImage",void 0),e=Cg([tv("chat-tab")],e),e})();var dw;let pw=(()=>{let e=dw=class extends ev{static get instance(){return dw._instance||(dw._instance=new dw("ChatTabList"),dw._instance.initialize()),dw._instance}get chatTabs(){return this.children}addChatTab(...e){let t=null;if(e[0]instanceof uw)t=e[0];else{let n=e[0];t=new uw(e[1]),t.name=n,t.initialize()}return this.appendChild(t)}parseInnerXml(e){for(let n of dw.instance.children)n.destroy();let t=dw.instance.toContext();t.syncData=this.toContext().syncData,dw.instance.apply(t),dw.instance.update(),super.parseInnerXml.apply(dw.instance,[e]),this.destroy()}};return e=dw=Cg([tv("chat-tab-list")],e),e})(),fw=(()=>{class e{constructor(){this.intervalTimer=null,this.timeOffset=Date.now(),this.performanceOffset=performance.now(),this.ntpApiUrls=["https://ntp-a1.nict.go.jp/cgi-bin/json","https://ntp-b1.nict.go.jp/cgi-bin/json"],this.gameType=""}get chatTabs(){return pw.instance.chatTabs}calibrateTimeOffset(){if(null!=this.intervalTimer)return void console.log("calibrateTimeOffset was canceled.");let e=Math.floor(Math.random()*this.ntpApiUrls.length),t=this.ntpApiUrls[e],n=performance.now();fetch(t).then(e=>{if(e.ok)return e.json();throw new Error("Network response was not ok.")}).then(e=>{let t=performance.now(),i=(t-n)/2,r=1e3*e.st;this.timeOffset=r+i,this.performanceOffset=t,console.log("latency: "+i+"ms"),console.log("st: "+r),console.log("timeOffset: "+this.timeOffset),console.log("performanceOffset: "+this.performanceOffset),this.setIntervalTimer()}).catch(e=>{console.warn("There has been a problem with your fetch operation: ",e.message),this.setIntervalTimer()}),this.setIntervalTimer()}setIntervalTimer(){null!=this.intervalTimer&&clearTimeout(this.intervalTimer),this.intervalTimer=setTimeout(()=>{this.intervalTimer=null,this.calibrateTimeOffset()},216e5)}getTime(){return Math.floor(this.timeOffset+(performance.now()-this.performanceOffset))}sendMessage(t,n,i,r,s,o,a,l,c,h,u,d,p,f,g){let m=!(u&&this.findFaceIconIdentifier(r)),b={from:Hy.peerContext.userId,to:e.findId(s),name:this.makeMessageName(r,s),imageIdentifier:this.findImageIdentifier(r,u),timestamp:this.calcTimeStamp(t),tag:i,text:rv.cr(n),color:o,isInverseIcon:m&&a?1:0,isHollowIcon:m&&l?1:0,isBlackPaint:m&&c?1:0,aura:m?h:-1,characterIdentifier:d,standIdentifier:p,standName:f,isUseStandImage:g};return t.addMessage(b)}static findId(e){let t=Vy.instance.get(e);return t instanceof gv?t.identifier:t instanceof av?t.userId:null}findObjectName(e){let t=Vy.instance.get(e);return t instanceof gv||t instanceof av?t.name:e}makeMessageName(e,t){let n=this.findObjectName(e);return null==t||t.length<1?n:n+" \u27a1 "+this.findObjectName(t)}findImageIdentifier(e,t=!1){let n=Vy.instance.get(e);return n instanceof gv?t&&n.faceIcon&&0<n.faceIcon.url.length?n.faceIcon.identifier:n.imageFile?n.imageFile.identifier:"":n instanceof av?n.imageIdentifier:e}findFaceIconIdentifier(e){let t=Vy.instance.get(e);return t instanceof gv&&t.faceIcon&&0<t.faceIcon.url.length?t.faceIcon.identifier:""}calcTimeStamp(e){let t=this.getTime(),n=e.latestTimeStamp;return t<=n?n+1:t}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();const gw=["chatInput"],mw=["chatPlette"];function bw(e,t){1&e&&Ao(0,"badge",12),2&e&&To("count",jo().$implicit.unreadLength)}function yw(e,t){if(1&e){const e=Fo();Io(0,"label"),Io(1,"input",10),zo("ngModelChange",function(t){return Ft(e),jo().chatTabidentifier=t}),Mo(),Io(2,"div"),ga(3),Eo(4,bw,1,1,"badge",11),Mo(),Mo()}if(2&e){const e=t.$implicit,n=jo();Zr(1),Go("value",e.identifier),To("ngModel",n.chatTabidentifier),Zr(2),ma(e.name),Zr(1),To("ngIf",e.hasUnread)}}function vw(e,t){1&e&&(Io(0,"div",13),Io(1,"i",14),ga(2,"info_outline"),Mo(),ga(3," \u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u7de8\u96c6\u4e2d\u3067\u3059"),Mo())}function _w(e,t){if(1&e&&(Io(0,"option",19),ga(1),Mo()),2&e){const e=jo().$implicit;ta("color",jo(3).color),Go("value",e),Zr(1),ma(e)}}function ww(e,t){if(1&e&&(Po(0),Eo(1,_w,2,4,"option",18),Do()),2&e){const e=t.$implicit,n=jo(3);Zr(1),To("ngIf",n.filter(e))}}function Cw(e,t){if(1&e&&(Po(0),Eo(1,ww,2,1,"ng-container",3),Do()),2&e){const e=jo(2);Zr(1),To("ngForOf",e.palette.getPalette())}}function xw(e,t){if(1&e){const e=Fo();Io(0,"div",15),Io(1,"select",16,17),zo("input",function(t){return Ft(e),jo().selectPalette(t.target.value)})("click",function(t){return Ft(e),jo().clickPalette(t.target.value)}),Eo(3,Cw,2,1,"ng-container",9),Mo(),Mo()}if(2&e){const e=jo();Zr(3),To("ngIf",e.palette)}}function Ew(e,t){if(1&e){const e=Fo();Io(0,"div",15),Io(1,"textarea",20),zo("ngModelChange",function(t){return Ft(e),jo().editPalette=t}),Mo(),Mo()}if(2&e){const e=jo();Zr(1),To("ngModel",e.editPalette)}}function kw(e,t){1&e&&(Io(0,"span"),ga(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u7de8\u96c6"),Mo())}function Sw(e,t){1&e&&(Io(0,"span"),ga(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u78ba\u5b9a"),Mo())}let Tw=(()=>{class e{constructor(e,t){this.chatMessageService=e,this.panelService=t,this.character=null,this._gameType="",this.chatTabidentifier="",this.text="",this.sendTo="",this.isEdit=!1,this.editPalette="",this.filterText="",this.doubleClickTimer=null,this.selectedPaletteIndex=-1}get palette(){return this.character.chatPalette}get color(){return this.chatInputComponent.color}get gameType(){return this._gameType}set gameType(e){this._gameType=e,this.character.chatPalette&&(this.character.chatPalette.dicebot=e)}get sendFrom(){return this.character.identifier}set sendFrom(e){this.onSelectedCharacter(e)}get diceBotInfos(){return _v.diceBotInfos}get chatTab(){return Vy.instance.get(this.chatTabidentifier)}get myPeer(){return av.myCursor}get otherPeers(){return Vy.instance.getObjects(av)}ngOnInit(){Promise.resolve().then(()=>this.updatePanelTitle()),this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"",this.gameType=this.character.chatPalette?this.character.chatPalette.dicebot:"",Uy.register(this).on("DELETE_GAME_OBJECT",-1e3,e=>{this.character&&this.character.identifier===e.data.identifier&&this.panelService.close(),this.chatTabidentifier===e.data.identifier&&(this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"")})}ngOnDestroy(){Uy.unregister(this),this.isEdit&&this.toggleEditMode()}updatePanelTitle(){this.panelService.title=this.character.name+" \u306e\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8"}onSelectedCharacter(e){this.isEdit&&this.toggleEditMode();let t=Vy.instance.get(e);if(t instanceof gv){this.character=t;let e=this.character.chatPalette?this.character.chatPalette.dicebot:"";0<e.length&&(this.gameType=e)}this.updatePanelTitle()}selectPalette(e){this.text=e}clickPalette(e){if(!this.chatPletteElementRef.nativeElement)return;const t=this.palette.evaluate(e,this.character.rootDataElement);this.doubleClickTimer&&this.selectedPaletteIndex===this.chatPletteElementRef.nativeElement.selectedIndex?(clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.chatInputComponent.sendChat(null)):(this.selectedPaletteIndex=this.chatPletteElementRef.nativeElement.selectedIndex,this.text=t,this.chatInputComponent.textAreaElementRef.nativeElement.value=this.text,this.doubleClickTimer=setTimeout(()=>{this.doubleClickTimer=null},400))}sendChat(e){if(this.chatTab){let t=this.palette.evaluate(e.text,this.character.rootDataElement);this.chatMessageService.sendMessage(this.chatTab,t,e.gameType,e.sendFrom,e.sendTo,e.color,e.isInverse,e.isHollow,e.isBlackPaint,e.aura,e.isUseFaceIcon,e.characterIdentifier,e.standIdentifier,e.standName,e.isUseStandImage),this.filterText=""}}resetPletteSelect(){this.chatPletteElementRef.nativeElement&&(this.chatPletteElementRef.nativeElement.selectedIndex=-1)}toggleEditMode(){this.isEdit=!this.isEdit,this.isEdit?this.editPalette=this.palette.value+"":this.palette.setPalette(this.editPalette)}filter(e){return null==this.filterText||""==this.filterText.trim()||e.search(this.filterText)>=0}}return e.\u0275fac=function(t){return new(t||e)(So(fw),So(wv))},e.\u0275cmp=Ze({type:e,selectors:[["chat-palette"]],viewQuery:function(e,t){if(1&e&&(cc(gw,3),cc(mw,1)),2&e){let e;lc(e=hc())&&(t.chatInputComponent=e.first),lc(e=hc())&&(t.chatPletteElementRef=e.first)}},inputs:{character:"character"},decls:14,vars:11,consts:[[1,"flex-container"],[2,"flex-grow","0"],[1,"chat-tab"],[4,"ngFor","ngForOf"],[3,"onlyCharacters","chatTabidentifier","gameType","sendFrom","text","gameTypeChange","sendFromChange","textChange","chat"],["chatInput",""],["class","edit-info",4,"ngIf"],["style","flex-grow: 1; height: 0; min-height: 100px;",4,"ngIf"],["type","submit",3,"click"],[4,"ngIf"],["name","chat-tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],["class","badge",3,"count",4,"ngIf"],[1,"badge",3,"count"],[1,"edit-info"],[1,"material-icons",2,"vertical-align","bottom","size","0.8rem"],[2,"flex-grow","1","height","0","min-height","100px"],["size","5",1,"palette",2,"overflow-y","auto",3,"input","click"],["chatPlette",""],[3,"value","color",4,"ngIf"],[3,"value"],["placeholder","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8",1,"palette",2,"resize","none",3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(Io(0,"div",0),Io(1,"div",1),Io(2,"form"),Io(3,"div",2),Eo(4,yw,5,4,"label",3),Mo(),Mo(),Io(5,"chat-input",4,5),zo("gameTypeChange",function(e){return t.gameType=e})("sendFromChange",function(e){return t.sendFrom=e})("textChange",function(e){return t.text=e})("chat",function(e){return t.sendChat(e)}),Mo(),Eo(7,vw,4,0,"div",6),Mo(),Eo(8,xw,4,1,"div",7),Eo(9,Ew,2,1,"div",7),Io(10,"div",1),Io(11,"button",8),zo("click",function(){return t.toggleEditMode()}),Eo(12,kw,2,0,"span",9),Eo(13,Sw,2,0,"span",9),Mo(),Mo(),Mo()),2&e&&(Zr(4),To("ngForOf",t.chatMessageService.chatTabs),Zr(1),To("onlyCharacters",!0)("chatTabidentifier",t.chatTabidentifier)("gameType",t.gameType)("sendFrom",t.sendFrom)("text",t.text),Zr(2),To("ngIf",t.isEdit),Zr(1),To("ngIf",!t.isEdit),Zr(1),To("ngIf",t.isEdit),Zr(3),To("ngIf",!t.isEdit),Zr(1),To("ngIf",t.isEdit))},styles:[".edit-info[_ngcontent-%COMP%]{width:100%;text-align:center;color:#ccc;background-color:rgba(30,30,30,.8)}.palette[_ngcontent-%COMP%]{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;width:100%;height:100%}.flex-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.chat-tab[_ngcontent-%COMP%]{padding:0 5px 5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:8px;background-color:transparent;color:#444;border:1px solid #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:1px solid #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}"]}),e})();function Ow(e,t){if(1&e&&(Io(0,"div",11),ga(1),Mo()),2&e){const e=jo(2);Zr(1),ma(e.isSpeaking?"\ud83d\ude03":"\ud83e\udd10")}}const Iw=function(e){return{transform:e}},Mw=function(e){return{inverse:e}},Aw=function(e,t,n,i,r,s,o,a){return{black:e,blue:t,green:n,cyan:i,red:r,magenta:s,yellow:o,white:a}},Pw=function(e,t){return{"black-paint":e,hollow:t}};function Dw(e,t){if(1&e){const e=Fo();Po(0),Io(1,"div"),Io(2,"div",5),Io(3,"div",6),Io(4,"span",7),Io(5,"img",8),zo("dblclick",function(){return Ft(e),jo().openModal()}),ql(6,"safe"),Mo(),Mo(),Mo(),Mo(),Io(7,"button",9),zo("click",function(){return Ft(e),jo().openModal()}),Io(8,"b"),ga(9),Mo(),Mo(),Eo(10,Ow,2,1,"div",10),Mo(),Do()}if(2&e){const e=jo();Zr(2),To("ngStyle",Ul(10,Iw,e.isApplyRoll?"rotate("+e.gameCharacter.roll+"deg)":"")),Zr(1),To("ngClass",Ul(12,Mw,e.isApplyImageEffect&&e.gameCharacter.isInverse)),Zr(1),To("ngClass",Zl(14,Aw,e.isApplyImageEffect&&0==e.gameCharacter.aura,e.isApplyImageEffect&&1==e.gameCharacter.aura,e.isApplyImageEffect&&2==e.gameCharacter.aura,e.isApplyImageEffect&&3==e.gameCharacter.aura,e.isApplyImageEffect&&4==e.gameCharacter.aura,e.isApplyImageEffect&&5==e.gameCharacter.aura,e.isApplyImageEffect&&6==e.gameCharacter.aura,e.isApplyImageEffect&&7==e.gameCharacter.aura)),Zr(1),To("src",$l(6,7,e.standImage.url,"resourceUrl"),Xi)("ngClass",Hl(23,Pw,e.isApplyImageEffect&&e.gameCharacter.isBlackPaint,e.isApplyImageEffect&&e.gameCharacter.isHollow)),Zr(4),ba("",e.isSpeakable?"\u901a\u5e38":"","\u753b\u50cf\u5909\u66f4"),Zr(1),To("ngIf",e.isSpeakable)}}function Rw(e,t){if(1&e){const e=Fo();Po(0),Io(1,"span",12),Io(2,"input",13),zo("ngModelChange",function(t){return Ft(e),jo().nameElement.value=t}),Mo(),Mo(),Do()}if(2&e){const e=jo();Zr(2),To("ngModel",e.nameElement.value)}}function Fw(e,t){if(1&e){const e=Fo();Po(0),Io(1,"b",12),ga(2,"\u3000Cond: "),Mo(),Io(3,"select",14),zo("ngModelChange",function(t){return Ft(e),jo().conditionTypeElement.value=t}),Io(4,"option",15),ga(5,"\u30c7\u30d5\u30a9\u30eb\u30c8"),Mo(),Io(6,"option",15),ga(7,"\u6307\u5b9a\u753b\u50cf"),Mo(),Io(8,"option",15),ga(9,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e"),Mo(),Io(10,"option",15),ga(11,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e \u307e\u305f\u306f \u6307\u5b9a\u753b\u50cf"),Mo(),Io(12,"option",15),ga(13,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e \u304b\u3064 \u6307\u5b9a\u753b\u50cf"),Mo(),Io(14,"option",15),ga(15,"\u9078\u629e\u6642\u306e\u307f"),Mo(),Mo(),Do()}if(2&e){const e=jo();Zr(3),To("ngModel",e.conditionTypeElement.value),Zr(1),Go("value",e.standConditionType.Default),Zr(2),Go("value",e.standConditionType.Image),Zr(2),Go("value",e.standConditionType.Postfix),Zr(2),Go("value",e.standConditionType.PostfixOrImage),Zr(2),Go("value",e.standConditionType.PostfixAndImage),Zr(2),Go("value",e.standConditionType.NotConditionStandUp)}}function Nw(e,t){if(1&e){const e=Fo();Po(0),Io(1,"span",12),Io(2,"b",16),ga(3,"Tag: "),Mo(),Io(4,"input",17),zo("ngModelChange",function(t){return Ft(e),jo().nameElement.currentValue=t}),Mo(),Mo(),Do()}if(2&e){const e=jo();Zr(4),To("ngModel",e.nameElement.currentValue)}}function zw(e,t){if(1&e){const e=Fo();Po(0),Io(1,"label",18),Io(2,"input",19),zo("ngModelChange",function(t){return Ft(e),jo().applyImageEffectElement.value=t})("change",function(){Ft(e);const t=jo();return t.applyImageEffectElement.value=t.applyImageEffectElement.value?"applyImageEffect":""}),Mo(),Io(3,"b",12),ga(4,"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u753b\u50cf\u52b9\u679c\u3092\u53cd\u6620"),Mo(),Mo(),Do()}if(2&e){const e=jo();Zr(2),Go("checked",e.applyImageEffectElement.value?"checked":""),To("ngModel",e.applyImageEffectElement.value)}}function Lw(e,t){if(1&e){const e=Fo();Po(0),Io(1,"label",18),Io(2,"input",19),zo("ngModelChange",function(t){return Ft(e),jo().applyRollElement.value=t})("change",function(){Ft(e);const t=jo();return t.applyRollElement.value=t.applyRollElement.value?"applyRoll":""}),Mo(),Io(3,"b",12),ga(4,"\u56de\u8ee2\u3092\u53cd\u6620"),Mo(),Mo(),Do()}if(2&e){const e=jo();Zr(2),Go("checked",e.applyRollElement.value?"checked":""),To("ngModel",e.applyRollElement.value)}}function Bw(e,t){if(1&e){const e=Fo();Po(0),Io(1,"label",20),Io(2,"input",19),zo("ngModelChange",function(t){return Ft(e),jo().applyDialogElement.value=t})("change",function(){Ft(e);const t=jo();return t.applyDialogElement.value=t.applyDialogElement.value?"applyDialog":""}),Mo(),Io(3,"b",12),ga(4,"\ud83d\udcad"),Mo(),Mo(),Do()}if(2&e){const e=jo();Zr(2),Go("checked",e.applyDialogElement.value?"checked":""),To("ngModel",e.applyDialogElement.value)}}const jw=function(e){return{"disabled-text":e}};function Uw(e,t){if(1&e){const e=Fo();Po(0),Ao(1,"br"),Io(2,"button",21),zo("click",function(){return Ft(e),jo().testStandUp()}),Io(3,"b"),ga(4,"\u30c6\u30b9\u30c8 (\u81ea\u5206\u3060\u3051\u898b\u308b)"),Mo(),Mo(),Io(5,"label",20),Io(6,"input",19),zo("ngModelChange",function(t){return Ft(e),jo().positionElement.currentValue=t})("change",function(){Ft(e);const t=jo();return t.positionElement.currentValue=t.positionElement.currentValue?"posSpecialize":""}),Mo(),Io(7,"b",12),ga(8,"Pos\u500b\u5225\u6307\u5b9a: "),Mo(),Mo(),Io(9,"span",22),Io(10,"input",23),zo("ngModelChange",function(t){return Ft(e),jo().positionElement.value=t}),Mo(),Io(11,"input",24),zo("ngModelChange",function(t){return Ft(e),jo().positionElement.value=t}),Mo(),Io(12,"b",25),ga(13,"%"),Mo(),Mo(),Do()}if(2&e){const e=jo();Zr(6),Go("checked",e.positionElement.currentValue?"checked":""),To("ngModel",e.positionElement.currentValue),Zr(4),To("ngModel",e.positionElement.value)("disabled",!e.positionElement.currentValue),Zr(1),To("ngModel",e.positionElement.value)("disabled",!e.positionElement.currentValue),Zr(1),To("ngClass",Ul(7,jw,!e.positionElement.currentValue))}}function Hw(e,t){if(1&e){const e=Fo();Po(0),Ao(1,"br"),Io(2,"span",22),Io(3,"b",26),ga(4,"Height (0=\u6307\u5b9a\u306a\u3057): "),Mo(),Io(5,"input",27),zo("ngModelChange",function(t){return Ft(e),jo().heightElement.value=t}),Mo(),Io(6,"input",28),zo("ngModelChange",function(t){return Ft(e),jo().heightElement.value=t}),Mo(),Io(7,"b",29),ga(8,"%"),Mo(),Mo(),Io(9,"span",30),Io(10,"b",26),ga(11,"AdjY: "),Mo(),Io(12,"input",31),zo("ngModelChange",function(t){return Ft(e),jo().heightElement.currentValue=t}),Mo(),Io(13,"b",29),ga(14,"%"),Mo(),Mo(),Do()}if(2&e){const e=jo();Zr(5),To("ngModel",e.heightElement.value),Zr(1),To("ngModel",e.heightElement.value),Zr(6),To("ngModel",e.heightElement.currentValue)}}function Vw(e,t){if(1&e){const e=Fo();Io(0,"div"),Io(1,"textarea",32),zo("ngModelChange",function(t){return Ft(e),jo().postfixElement.value=t}),Mo(),Mo()}if(2&e){const e=jo();Zr(1),To("ngModel",e.postfixElement.value)}}const Gw=function(e){return{"current-icon":e}};function Zw(e,t){if(1&e){const e=Fo();Io(0,"div",37),Io(1,"img",38),zo("click",function(){Ft(e);const t=jo().$implicit;return jo(3).selectImage(t.identifier)}),ql(2,"safe"),Mo(),Mo()}if(2&e){const e=jo().$implicit,t=jo(3);To("ngClass",Ul(6,Gw,t.isSelectedImage(e.identifier))),Zr(1),To("src",$l(2,3,e.url,"resourceUrl"),Xi)("alt",e.name)}}function Ww(e,t){if(1&e&&(Po(0),Eo(1,Zw,3,8,"div",36),Do()),2&e){const e=t.$implicit;Zr(1),To("ngIf",0<e.url.length)}}function Yw(e,t){if(1&e&&(Io(0,"div",34),Eo(1,Ww,2,1,"ng-container",35),Mo()),2&e){const e=jo(2);Zr(1),To("ngForOf",e.imageList)}}function qw(e,t){1&e&&(Io(0,"div"),ga(1,"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u753b\u50cf\u3001\u9854IC\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),Mo())}function $w(e,t){if(1&e&&(Io(0,"div"),Eo(1,Yw,2,1,"div",33),Eo(2,qw,2,0,"div",2),Mo()),2&e){const e=jo();Zr(1),To("ngIf",e.imageList&&e.imageList.length>0),Zr(1),To("ngIf",!e.imageList||0==e.imageList.length)}}let Xw=(()=>{class e{constructor(e){this.modalService=e,this.standElement=null,this.imageList=[],this.gameCharacter=null,this.isSpeaking=!1,this._imageFile=Ig.Empty,this.standConditionType=dv}ngOnInit(){}get standImage(){if(!this.standElement)return this._imageFile;let e=null;if(this.isSpeaking&&(e=this.standElement.getFirstElementByName("speakingImageIdentifier"),e||(e=this.standElement.appendChild(hv.create("speakingImageIdentifier",Ig.Empty.identifier,{type:"image"},"speakingImageIdentifier_"+this.standElement.identifier)))),e&&e.value&&e.value!=Ig.Empty.identifier||(e=this.standElement.getFirstElementByName("imageIdentifier")),e){if(this._imageFile.identifier!==e.value){let t=ov.instance.get(e.value);this._imageFile=t||Ig.Empty}}else{let e=Ig.createEmpty("stand_no_image").toContext();e.url="./assets/images/nc96424.png",this._imageFile=ov.instance.add(e),this.standElement.appendChild(hv.create("imageIdentifier",this._imageFile.identifier,{type:"image"},"imageIdentifier_"+this.standElement.identifier))}return this._imageFile}get nameElement(){return this.standElement?this.standElement.getFirstElementByName("name")||this.standElement.appendChild(hv.create("name","",{},"name_"+this.standElement.identifier)):null}get heightElement(){return this.standElement?this.standElement.getFirstElementByName("height")||this.standElement.appendChild(hv.create("height",0,{currentValue:0},"height_"+this.standElement.identifier)):null}get conditionTypeElement(){return this.standElement?this.standElement.getFirstElementByName("conditionType")||this.standElement.appendChild(hv.create("conditionType",dv.Default,{},"conditionType_"+this.standElement.identifier)):null}get postfixElement(){return this.standElement?this.standElement.getFirstElementByName("postfix")||this.standElement.appendChild(hv.create("postfix","",{},"postfix_"+this.standElement.identifier)):null}get applyImageEffectElement(){return this.standElement?this.standElement.getFirstElementByName("applyImageEffect")||this.standElement.appendChild(hv.create("applyImageEffect","",{},"applyImageEffect_"+this.standElement.identifier)):null}get applyRollElement(){return this.standElement?this.standElement.getFirstElementByName("applyRoll")||this.standElement.appendChild(hv.create("applyRoll","",{},"applyRoll_"+this.standElement.identifier)):null}get applyDialogElement(){return this.standElement?this.standElement.getFirstElementByName("applyDialog")||this.standElement.appendChild(hv.create("applyDialog","applyDialog",{},"applyDialog_"+this.standElement.identifier)):null}get positionElement(){return this.standElement?this.standElement.getFirstElementByName("position")||this.standElement.appendChild(hv.create("position",0,{currentValue:""},"position_"+this.standElement.identifier)):null}get isApplyImageEffect(){let e=this.applyImageEffectElement;return!(!e||!e.value)}get isApplyRoll(){let e=this.applyRollElement;return!(!e||!e.value)}get isApplyDialog(){let e=this.applyDialogElement;return!(!e||!e.value)}get isSpeakable(){if(!this.standElement)return!1;const e=this.standElement.getFirstElementByName("speakingImageIdentifier");return e&&e.value&&e.value!==Ig.Empty.identifier}openModal(e="imageIdentifier",t=!1){if(!this.standElement)return;let n=this.standElement.getFirstElementByName(e);n||(n=this.standElement.appendChild(hv.create(e,"",{type:"image"},e+"_"+this.standElement.identifier))),this.modalService.open(ew,{isAllowedEmpty:t}).then(e=>{e&&(n.value=e)})}openSpeakingModal(){this.openModal("speakingImageIdentifier",!0)}remove(){this.standElement&&this.standElement.parent.removeChild(this.standElement)}selectImage(e){if(!this.standElement)return;let t=!1;for(let n of this.standElement.getElementsByName("targetImageIdentifier")){let i=!0;for(let e of this.imageList)if(e.identifier==n.value){i=!1;break}i?this.standElement.removeChild(n):n.value==e&&(t=!0,this.standElement.removeChild(n))}t||this.standElement.appendChild(hv.create("targetImageIdentifier",e,{},"targetImageIdentifier_"+My.generateUuid()))}isSelectedImage(e){let t=this.standElement.getElementsByName("targetImageIdentifier");for(let n of t)if(n.value==e)return!0;return!1}testStandUp(){Uy.trigger("POPUP_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier,standIdentifier:this.standElement.identifier,color:this.gameCharacter.chatPalette?this.gameCharacter.chatPalette.color:null}),Uy.trigger("POPUP_CHAT_BALLOON",{characterIdentifier:this.gameCharacter.identifier,text:"\u30c6\u30b9\u30c8\u30c6\u30b9\u30c8\u30c6\u30b9\u30c8\u30c6\u30b9\u30c8\u30c6\u30b9\u30c8\u30c6\u30b9\u30c8\u30c6\u30b9\u30c8\u30c6\u30b9\u30c8\u30c6\u30b9\u30c8\u30c6\u30b9\u30c8\u30c6\u30b9\u30c8\u30c6\u30b9\u30c8\u30c6\u30b9\u30c8\u30c6\u30b9\u30c8",color:this.gameCharacter.chatPalette?this.gameCharacter.chatPalette.color:null,dialogTest:!0})}}return e.\u0275fac=function(t){return new(t||e)(So(xv))},e.\u0275cmp=Ze({type:e,selectors:[["stand-element"]],inputs:{standElement:"standElement",imageList:"imageList",gameCharacter:"gameCharacter",isSpeaking:"isSpeaking"},decls:19,vars:13,consts:[[1,"stand-container"],[1,"stand-image-container"],[4,"ngIf"],[2,"display","flex","flex-direction","column","padding-left","3px","width","100%"],[2,"font-size","9px",3,"click"],[3,"ngStyle"],[1,"inverser",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"stand-image",3,"src","ngClass","dblclick"],[1,"stand-image-button",2,"font-size","smaller","padding","2px 3px",3,"click"],["style","position: absolute; margin-top: -26px; margin-left: 120px; font-size: 22px; filter: grayscale(100%); opacity: 0.5; cursor: default;",4,"ngIf"],[2,"position","absolute","margin-top","-26px","margin-left","120px","font-size","22px","filter","grayscale(100%)","opacity","0.5","cursor","default"],[2,"font-size","smaller"],["type","text","placeholder","Name",2,"width","7em",3,"ngModel","ngModelChange"],[2,"width","15.5em",3,"ngModel","ngModelChange"],[3,"value"],[2,"margin-left","1em"],["type","text","placeholder","Tag",2,"width","3em",3,"ngModel","ngModelChange"],[2,"margin-right","0.6em"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"margin-right","0.3em"],[2,"font-size","9px","margin-right","1em",3,"click"],[2,"white-space","nowrap","font-size","smaller"],["type","range","min","0","max","100",2,"width","140px",3,"ngModel","disabled","ngModelChange"],["type","number","min","0","max","100",2,"width","3em","text-align","right",3,"ngModel","disabled","ngModelChange"],[2,"display","inline-block","font-size","smaller","margin-left","3px",3,"ngClass"],[2,"display","inline-block","margin-left","3px"],["type","range","min","0","max","100",2,"width","130px",3,"ngModel","ngModelChange"],["type","number","min","0","max","100",2,"width","3em","text-align","right",3,"ngModel","ngModelChange"],[2,"display","inline-block","font-size","smaller","margin-left","3px"],[2,"white-space","nowrap","margin-left","0.8em","font-size","smaller"],["type","number","min","-100","max","100",2,"width","3.4em","text-align","right",3,"ngModel","ngModelChange"],["placeholder","1\u884c\u306b\u4e00\u3064\u3001\u5192\u982d@\u3092\u4ed8\u3051\u308b\u3068\u30de\u30c3\u30c1\u6642\u306b\u30c6\u30ad\u30b9\u30c8\u304b\u3089\u5207\u308a\u53d6\u308a\n@\u6012\u308a\n@\u5fc5\u6bba\u6280",2,"width","100%","margin-top","3px","height","2.4rem",3,"ngModel","ngModelChange"],["style","display: flex; flex-wrap: wrap; margin-right: -30px;",4,"ngIf"],[2,"display","flex","flex-wrap","wrap","margin-right","-30px"],[4,"ngFor","ngForOf"],["class","icon-image-box",3,"ngClass",4,"ngIf"],[1,"icon-image-box",3,"ngClass"],[3,"src","alt","click"]],template:function(e,t){1&e&&(Io(0,"div"),Io(1,"div",0),Io(2,"div",1),Eo(3,Dw,11,26,"ng-container",2),Mo(),Io(4,"div",3),Io(5,"div"),Eo(6,Rw,3,1,"ng-container",2),Eo(7,Fw,16,7,"ng-container",2),Eo(8,Nw,5,1,"ng-container",2),Mo(),Io(9,"div"),Eo(10,zw,5,2,"ng-container",2),Eo(11,Lw,5,2,"ng-container",2),Eo(12,Bw,5,2,"ng-container",2),Io(13,"button",4),zo("click",function(){return t.openSpeakingModal()}),ga(14,"\u53e3\u30d1\u30af\u30a2\u30cb\u30e1 (APNG\u306a\u3069)"),Mo(),Eo(15,Uw,14,9,"ng-container",2),Eo(16,Hw,15,3,"ng-container",2),Mo(),Eo(17,Vw,2,1,"div",2),Eo(18,$w,3,2,"div",2),Mo(),Mo(),Mo()),2&e&&(Zr(3),To("ngIf",t.standImage),Zr(3),To("ngIf",t.nameElement),Zr(1),To("ngIf",t.conditionTypeElement),Zr(1),To("ngIf",t.nameElement),Zr(2),To("ngIf",t.applyImageEffectElement),Zr(1),To("ngIf",t.applyRollElement),Zr(1),To("ngIf",t.applyDialogElement),Zr(1),ta("font-weight",t.isSpeakable?"bolder":"normal"),Zr(2),To("ngIf",t.positionElement),Zr(1),To("ngIf",t.heightElement),Zr(1),To("ngIf",t.postfixElement&&(t.conditionTypeElement.value==t.standConditionType.Postfix||t.conditionTypeElement.value==t.standConditionType.PostfixOrImage||t.conditionTypeElement.value==t.standConditionType.PostfixAndImage)),Zr(1),To("ngIf",t.conditionTypeElement.value==t.standConditionType.Image||t.conditionTypeElement.value==t.standConditionType.PostfixOrImage||t.conditionTypeElement.value==t.standConditionType.PostfixAndImage))},directives:[Zh,Qh,Uh,ju,sd,Sd,Ld,Bd,Vd,zu,Fd,Id,Vh],pipes:[$_],styles:[".stand-container[_ngcontent-%COMP%]{display:flex;flex-direction:row}.stand-image[_ngcontent-%COMP%], .stand-image-container[_ngcontent-%COMP%]{width:150px;height:150px}.stand-image[_ngcontent-%COMP%]{-o-object-fit:contain;object-fit:contain;transform-origin:bottom;z-index:5}.stand-image-button[_ngcontent-%COMP%]{display:block;margin-top:-154px;margin-left:-4px;position:relative;z-index:10}.postfix-text[_ngcontent-%COMP%]{width:8em}.position-indicate[_ngcontent-%COMP%]{display:inline-block;font-size:smaller;width:3em}.remove-button[_ngcontent-%COMP%]{font-weight:bolder;color:red;background-color:transparent}.remove-button[_ngcontent-%COMP%]:hover{background-color:#eee}.icon-image-box[_ngcontent-%COMP%]{position:relative;width:50px;height:50px;max-width:50px;max-height:50px;border-radius:.5rem;color:#000;z-index:100;margin-top:1px;margin-bottom:1px;margin-left:2px}.icon-image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0;object-position:50% 0;border-radius:.5rem;border:2px solid transparent}.icon-image-box[_ngcontent-%COMP%]:hover{z-index:600}.icon-image-box[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{border:2px dotted red}.icon-image-box.current-icon[_ngcontent-%COMP%]{z-index:500}.icon-image-box.current-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid red}.icon-image-box[_ngcontent-%COMP%]:not(.current-icon){z-index:400}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms ease 0s}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #fff)}.disabled-text[_ngcontent-%COMP%]{color:grey}"]}),e})(),Kw=(()=>{class e{constructor(e){this.ngZone=e,this.callbackOnPointerDown=e=>this.onPointerDown(e),this.callbackOnPointerMove=e=>this.onPointerMove(e),this.callbackOnPointerUp=e=>this.onPointerUp(e),this.callbackOnContextMenu=e=>this.onContextMenu(e),this._isAllowedToOpenContextMenu=!1,this.pointers=[{x:0,y:0,z:0,identifier:-1}],this.startPostion=this.pointers[0],this.primaryPointer=this.pointers[0],this._isDragging=!1}get isAllowedToOpenContextMenu(){return this._isAllowedToOpenContextMenu}get pointer(){return this.primaryPointer}get pointerX(){return this.primaryPointer.x}get pointerY(){return this.primaryPointer.y}get isDragging(){return this._isDragging}set isDragging(e){e!==this._isDragging&&this.ngZone.run(()=>this._isDragging=e)}initialize(){this.addEventListeners()}destroy(){this.removeEventListeners()}onPointerDown(e){this.onPointerMove(e),this._isAllowedToOpenContextMenu=!0,this.startPostion=this.pointers[0]}onPointerMove(e){e.touches?this.onTouchMove(e):this.onMouseMove(e),this.targetElement=e.target}onPointerUp(e){this.onPointerMove(e)}onMouseMove(e){let t={x:e.pageX,y:e.pageY,z:0,identifier:-9999};this.isSyntheticEvent(t)||(this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(t),this.pointers=[t],this.primaryPointer=t)}onTouchMove(e){let t=e.touches.length;if(!(t<1)){this.pointers=[];for(let n=0;n<t;n++){let t=e.touches[n],i={x:t.pageX,y:t.pageY,z:0,identifier:t.identifier};this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(i),this.pointers.push(i)}this.primaryPointer=this.pointers[0]}}onContextMenu(e){this._isAllowedToOpenContextMenu=!0,this.onPointerUp(e)}preventContextMenuIfNeeded(e,t=3){let n=Math.pow(e.x-this.startPostion.x,2)+Math.pow(e.y-this.startPostion.y,2);Math.pow(t,2)<n&&(this._isAllowedToOpenContextMenu=!1)}isSyntheticEvent(e,t=15){for(let n of this.pointers)if(n.identifier!==e.identifier&&Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2)<Math.pow(t,2))return!0;return!1}addEventListeners(){this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.addEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.addEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.addEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.addEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.addEventListener("touchend",this.callbackOnPointerUp,!0),document.body.addEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.addEventListener("drop",this.callbackOnPointerUp,!0),document.body.addEventListener("contextmenu",this.callbackOnContextMenu,!0)})}removeEventListeners(){document.body.removeEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.removeEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.removeEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.removeEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.removeEventListener("touchend",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.removeEventListener("drop",this.callbackOnPointerUp,!0),document.body.removeEventListener("contextmenu",this.callbackOnContextMenu,!0)}}return e.\u0275fac=function(t){return new(t||e)(oi(Rc))},e.\u0275prov=pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Qw(e,t){if(1&e){const e=Fo();Io(0,"div",12),Io(1,"div",13),Io(2,"div",14),Io(3,"input",15),zo("click",function(){Ft(e);const n=t.index;return jo().overviewIndex=n}),Mo(),Mo(),Io(4,"div",16),Ao(5,"stand-element",17,18),Mo(),Io(7,"div",19),Io(8,"button",20),zo("click",function(){Ft(e);const n=t.$implicit,i=t.index;return jo().delele(n,i)}),ga(9,"\xd7"),Mo(),Io(10,"button",21),zo("click",function(){Ft(e);const n=t.$implicit;return jo().upStandIndex(n)}),ga(11,"\u2191"),Mo(),Io(12,"button",22),zo("click",function(){Ft(e);const n=t.$implicit;return jo().downStandIndex(n)}),ga(13,"\u2193"),Mo(),Mo(),Mo(),Ao(14,"hr"),Mo()}if(2&e){const e=t.$implicit,n=t.index,i=jo();Zr(1),ta("border-color",i.overviewIndex==n?"red":"transparent"),Zr(2),Zo("name","",i.panelId,"_overviewIndex"),Go("value",n),To("checked",i.overviewIndex==n),Zr(2),To("standElement",e)("imageList",i.imageList)("gameCharacter",i.character)}}let Jw=(()=>{class e{constructor(e,t){this.panelService=e,this.pointerDeviceService=t,this.character=null,this.isSpeaking=!1}get standElements(){return this.character.standList.standElements}get imageList(){if(!this.character)return[];let e=[],t={};const n=this.character.imageDataElement.getElementsByName("imageIdentifier").concat(this.character.imageDataElement.getElementsByName("faceIcon"));for(let i of n){if(t[i.value])continue;let n=this.imageElementToFile(i);n&&(t[i.value]=!0,e.push(n))}return e}get position(){return this.character&&this.character.standList?this.character.standList.position:0}set position(e){this.character&&this.character.standList&&(this.character.standList.position=e)}get height(){return this.character&&this.character.standList?this.character.standList.height:0}set height(e){this.character&&this.character.standList&&(this.character.standList.height=e)}get overviewIndex(){return this.character&&this.character.standList?this.character.standList.overviewIndex:-1}set overviewIndex(e){this.character&&this.character.standList&&(this.character.standList.overviewIndex=e)}ngOnInit(){Promise.resolve().then(()=>this.updatePanelTitle()),Uy.register(this).on("DELETE_GAME_OBJECT",-1e3,e=>{this.character&&this.character.identifier===e.data.identifier&&this.panelService.close()}),this.panelId=My.generateUuid()}ngAfterViewInit(){this._intervalId=setInterval(()=>{this.isSpeaking=!this.isSpeaking,this.standElementComponents.forEach(e=>{e.isSpeaking=this.isSpeaking})},3600)}ngOnDestroy(){clearInterval(this._intervalId),Uy.unregister(this)}updatePanelTitle(){this.panelService.title=this.character.name+" \u306e\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a"}add(){this.character.standList.add(this.character.imageFile.identifier)}delele(e,t){this.character&&this.character.standList&&window.confirm("\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u3092\u524a\u9664\u3057\u307e\u3059\u304b\uff1f")&&this.character.standList.removeChild(e)&&(this.character.standList.overviewIndex==t?this.character.standList.overviewIndex=-1:this.character.standList.overviewIndex>t&&(this.character.standList.overviewIndex-=1))}upStandIndex(e){let t=this.character.standList,n=t.children.indexOf(e);0<n&&(t.insertBefore(e,t.children[n-1]),this.character.standList.overviewIndex==n?this.character.standList.overviewIndex-=1:this.character.standList.overviewIndex==n-1&&(this.character.standList.overviewIndex+=1))}downStandIndex(e){let t=this.character.standList,n=t.children.indexOf(e);n<t.children.length-1&&(t.insertBefore(t.children[n+1],e),this.character.standList.overviewIndex==n?this.character.standList.overviewIndex+=1:this.character.standList.overviewIndex==n+1&&(this.character.standList.overviewIndex-=1))}helpStandSeteing(){let e=this.pointerDeviceService.pointers[0],t=this.panelService.open(L_,{left:e.x,top:e.y,width:600,height:590});t.title="\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u30d8\u30eb\u30d7",t.text='\u3000\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306e\u30b9\u30bf\u30f3\u30c9\u306e\u540d\u524d\u3001\u4f4d\u7f6e\u3068\u753b\u50cf\u306e\u9ad8\u3055\uff08\u305d\u308c\u305e\u308c\u753b\u9762\u30b5\u30a4\u30ba\u306b\u5bfe\u3059\u308b\u76f8\u5bfe\u6307\u5b9a\uff09\u3001\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u306b\u30b9\u30bf\u30f3\u30c9\u304c\u8868\u793a\u3055\u308c\u308b\u6761\u4ef6\u3092\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\n\n\u3000\u30b9\u30bf\u30f3\u30c9\u306b\u540d\u524d\u3092\u8a2d\u5b9a\u3057\u305f\u5834\u5408\u3001\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3001\u30c1\u30e3\u30c3\u30c8\u30d1\u30cd\u30eb\u306e\u30ea\u30b9\u30c8\u306b\u8868\u793a\u3055\u308c\u3001\u9078\u629e\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\u307e\u305f\u3001\u30bf\u30b0\u3092\u8a2d\u5b9a\u3057\u305f\u5834\u5408\u3001\u7570\u306a\u308b\u30bf\u30b0\u3067\u306f\u540c\u3058\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3067\u3042\u3063\u3066\u3082\u767b\u5834\u3001\u9000\u53bb\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u304c\u884c\u308f\u308c\u307e\u3059\u3002\n\n\u3000\u753b\u50cf\u306e\u4f4d\u7f6e\u3068\u9ad8\u3055\u306f\u500b\u5225\u6307\u5b9a\u3082\u53ef\u80fd\u3067\u3059\u3001\u4f4d\u7f6e\u306e\u500b\u5225\u6307\u5b9a\u306f\u30c1\u30a7\u30c3\u30af\u306a\u3057\u3001\u9ad8\u3055\u306f0\u3068\u3057\u305f\u5834\u5408\u306b\u5168\u4f53\u306e\u8a2d\u5b9a\u304c\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002\u7e26\u4f4d\u7f6e\u8abf\u6574(AdjY)\u306f\u3001\u30b9\u30bf\u30f3\u30c9\u753b\u50cf\u306e\u9ad8\u3055\u306b\u5bfe\u3059\u308b\u76f8\u5bfe\u6307\u5b9a\u3068\u306a\u308a\u307e\u3059\uff08\u4f8b\u3048\u3070\u3001-50%\u3068\u3059\u308b\u3068\u753b\u50cf\u306e\u4e0b\u534a\u5206\u304c\u753b\u9762\u7aef\u3088\u308a\u4e0b\u306b\u96a0\u308c\u307e\u3059\uff09\u3002\n\n\u3000\u6761\u4ef6\u306e\u300c\u6307\u5b9a\u753b\u50cf\u300d\u306f\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u753b\u50cf\u3042\u308b\u3044\u306f\u9854IC\u3067\u3059\u3002\u307e\u305f\u3001\u7279\u5225\u306a\u6761\u4ef6\u3068\u3057\u3066\u5e38\u306b\u3001\u30c1\u30e3\u30c3\u30c8\u30c6\u30ad\u30b9\u30c8\u306e\u672b\u5c3e\u304c"@\u9000\u53bb"\u307e\u305f\u306f"@farewell"\u306e\u5834\u5408\u306f\u3001\u305d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306e\u30b9\u30bf\u30f3\u30c9\u3092\u9000\u53bb\u3055\u305b\u307e\u3059\u3002\n\n\u3000\u512a\u5148\u9806\u4f4d\u306f\u9ad8\u3044\u3082\u306e\u304b\u3089\n\n\u3000\u3000\uff11. "@\u9000\u53bb"\u3001"@farewell"\u306b\u3088\u308b\u9000\u53bb\n\u3000\u3000\uff12. \u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3001\u30c1\u30e3\u30c3\u30c8\u30d1\u30cd\u30eb\u306e\u30ea\u30b9\u30c8\u3067\u9078\u629e\u3057\u305f\u540d\u524d\n\u3000\u3000\uff13. \u300c\u6307\u5b9a\u753b\u50cf \u304b\u3064 \u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u300d\n\u3000\u3000\uff14. \u300c\u6307\u5b9a\u753b\u50cf \u307e\u305f\u306f \u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u300d\n\u3000\u3000\uff15. \u300c\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u300d\n\u3000\u3000\uff16. \u300c\u6307\u5b9a\u753b\u50cf\u300d\n\n\u3000\u3069\u306e\u6761\u4ef6\u3082\u6e80\u305f\u3055\u306a\u3044\u5834\u5408\u300c\u30c7\u30d5\u30a9\u30eb\u30c8\u300d\u306e\u3082\u306e\u304c\u4f7f\u7528\u3055\u308c\u3001\u540c\u3058\u512a\u5148\u9806\u4f4d\u306e\u6761\u4ef6\u304c\u8907\u6570\u3042\u308b\u5834\u5408\u306f\u30e9\u30f3\u30c0\u30e0\u30671\u3064\u304c\u9078\u629e\u3055\u308c\u307e\u3059\u3002\n\n\u3000\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u4e00\u81f4\u3092\u5224\u5b9a\u3059\u308b\u969b\u3001\u5168\u89d2\u534a\u89d2\u3001\u30a2\u30eb\u30d5\u30a1\u3079\u30c3\u30c8\u306e\u5927\u6587\u5b57\u5c0f\u6587\u5b57\u306f\u533a\u5225\u3055\u308c\u307e\u305b\u3093\u3002\n\u3000\u307e\u305f\u3001"@\u9000\u53bb"\u3001"@farewell"\u306b\u3088\u308b\u9000\u53bb\u6642\u3001\u3042\u308b\u3044\u306f"@\u7b11\u3044"\u306e\u3088\u3046\u306b\u5148\u982d\u304c"@"\u3067\u59cb\u307e\u308b\u6761\u4ef6\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u5834\u5408\u3001\u305d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3067\u306e\u9001\u4fe1\u6642\u306b\u3001\u6761\u4ef6\u306b\u4e00\u81f4\u3059\u308b\u30c1\u30e3\u30c3\u30c8\u30c6\u30ad\u30b9\u30c8\u672b\u5c3e\u306e@\u4ee5\u4e0b\u306f\u5207\u308a\u843d\u3068\u3055\u308c\u307e\u3059\u3002'}imageElementToFile(e){return e?ov.instance.get(e.value):null}}return e.\u0275fac=function(t){return new(t||e)(So(wv),So(Kw))},e.\u0275cmp=Ze({type:e,selectors:[["app-stand-setting"]],viewQuery:function(e,t){if(1&e&&cc(Xw,1),2&e){let e;lc(e=hc())&&(t.standElementComponents=e)}},inputs:{character:"character"},decls:26,vars:9,consts:[[2,"margin-bottom","4px"],[2,"float","right",3,"click"],[1,"position-indicate"],["type","range","min","0","max","100",2,"width","350px",3,"ngModel","ngModelChange"],["type","number","min","0","max","100",2,"width","3em","text-align","right","margin-right","3px",3,"ngModel","ngModelChange"],["sytle","margin-left: 3px; margin-right: 1em "],[1,"overview-selecter",2,"padding","0px","width","695px"],[2,"font-size","smaller","font-weight","bolder"],["type","radio","value","-1",3,"name","checked","click"],[2,"display","flex","flex-direction","row","flex-wrap","wrap"],["style","width: 700px",4,"ngFor","ngForOf"],[3,"click"],[2,"width","700px"],[1,"overview-selecter",2,"display","flex","flex-direction","row","justify-content","space-between"],[2,"display","flex","align-items","center","justify-content","center"],["type","radio",2,"z-index","10",3,"name","value","checked","click"],[2,"margin-left","-1em","margin-right","-1em"],[3,"standElement","imageList","gameCharacter"],["standElementComponent",""],[2,"text-align","right","width","3em"],[1,"remove-button","danger",3,"click"],[1,"remove-button",2,"margin-top","5px",3,"click"],[1,"remove-button",2,"margin-top","2px",3,"click"]],template:function(e,t){1&e&&(Io(0,"div",0),Io(1,"button",1),zo("click",function(){return t.helpStandSeteing()}),ga(2,"?"),Mo(),Io(3,"div",2),Io(4,"b"),ga(5,"Pos: "),Mo(),Io(6,"input",3),zo("ngModelChange",function(e){return t.position=e}),Mo(),Io(7,"input",4),zo("ngModelChange",function(e){return t.position=e}),Mo(),Io(8,"b",5),ga(9,"\uff05\u3000"),Mo(),Mo(),Io(10,"div",2),Io(11,"b"),ga(12,"Height (0=\u5143\u753b\u50cf\u306e\u307e\u307e): "),Mo(),Io(13,"input",3),zo("ngModelChange",function(e){return t.height=e}),Mo(),Io(14,"input",4),zo("ngModelChange",function(e){return t.height=e}),Mo(),Io(15,"b",5),ga(16,"\uff05"),Mo(),Mo(),Mo(),Io(17,"div",6),Io(18,"label",7),Io(19,"input",8),zo("click",function(){return t.overviewIndex=-1}),Mo(),ga(20," \u30b9\u30bf\u30f3\u30c9\u753b\u50cf\u3092\u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u4f7f\u7528\u3057\u306a\u3044"),Mo(),Mo(),Ao(21,"hr"),Io(22,"div",9),Eo(23,Qw,15,8,"div",10),Mo(),Io(24,"button",11),zo("click",function(){return t.add()}),ga(25,"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u306e\u8ffd\u52a0"),Mo()),2&e&&(Zr(6),To("ngModel",t.position),Zr(1),To("ngModel",t.position),Zr(6),To("ngModel",t.height),Zr(1),To("ngModel",t.height),Zr(3),ta("border-color",-1==t.overviewIndex?"red":"transparent"),Zr(2),Zo("name","",t.panelId,"_overviewIndex"),To("checked",-1==t.overviewIndex),Zr(4),To("ngForOf",t.standElements))},directives:[Fd,ju,sd,Sd,Id,Vh,Xw],styles:[".position-indicate[_ngcontent-%COMP%]{display:inline-block;font-size:smaller}.description[_ngcontent-%COMP%], .remove-button[_ngcontent-%COMP%]{font-size:smaller}.remove-button[_ngcontent-%COMP%]{display:inline-block;font-weight:bolder;margin-top:-4px;margin-right:-1px}.overview-selecter[_ngcontent-%COMP%]{border:2px solid red;border-radius:8px;padding-top:1px;padding-bottom:4px}input[type=radio][_ngcontent-%COMP%]{width:1.5em;height:1.5em}"]}),e})();var eC,tC=n("Iab2"),nC=n("xOOu");!function(e){const t={gif:"image/gif",jpg:"image/jpeg",jpeg:"image/jpeg",jpe:"image/jpeg",png:"image/png",apng:"image/apng",webp:"image/webp",svg:"image/svg+xml",svgz:"image/svg+xml",ico:"image/x-icon",cur:"image/x-icon",bmp:"image/bmp",html:"text/html",htm:"text/html",shtml:"text/html",xml:"text/xml",yml:"text/yaml",yaml:"text/yaml",json:"application/json",map:"application/json",zip:"application/zip",mp3:"audio/mp3",wav:"audio/wav",m4a:"audio/aac",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",mp4:"video/mp4",webm:"video/webm"};e.type=function(e){let n=e.replace(/.*[\.\/\\]/,"").toLowerCase();return t[n]?t[n]:""},e.extension=function(e){for(let n in t)if(t[n]===e)return n;return e.split("/")[1]}}(eC||(eC={}));class iC{constructor(){this.maxImageSize=2097152,this.maxAudioeSize=10485760,console.log("FileArchiver ready...")}static get instance(){return iC._instance||(iC._instance=new iC),iC._instance}initialize(){this.destroy(),this.addEventListeners()}destroy(){this.removeEventListeners()}addEventListeners(){this.removeEventListeners(),this.callbackOnDragEnter=e=>this.onDragEnter(e),this.callbackOnDragOver=e=>this.onDragOver(e),this.callbackOnDrop=e=>this.onDrop(e),document.body.addEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.addEventListener("dragover",this.callbackOnDragOver,!1),document.body.addEventListener("drop",this.callbackOnDrop,!1)}removeEventListeners(){document.body.removeEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.removeEventListener("dragover",this.callbackOnDragOver,!1),document.body.removeEventListener("drop",this.callbackOnDrop,!1),this.callbackOnDragEnter=null,this.callbackOnDragOver=null,this.callbackOnDrop=null}onDragEnter(e){e.preventDefault()}onDragOver(e){e.preventDefault()}onDrop(e){e.preventDefault(),console.log("onDrop",e.dataTransfer),this.load(e.dataTransfer.files)}load(e){return xg(this,void 0,void 0,function*(){if(!e)return;let t=e instanceof FileList?rC(e):e;for(let e of t)yield this.handleImage(e),yield this.handleAudio(e),yield this.handleText(e),yield this.handleZip(e),Uy.trigger("FILE_LOADED",{file:e})})}handleImage(e){return xg(this,void 0,void 0,function*(){e.type.indexOf("image/")<0||(this.maxImageSize<e.size?console.warn(`File size limit exceeded. -> ${e.name} (${(e.size/1024/1024).toFixed(2)}MB)`):(console.log(e.name+" type:"+e.type),yield ov.instance.addAsync(e)))})}handleAudio(e){return xg(this,void 0,void 0,function*(){e.type.indexOf("audio/")<0||(this.maxAudioeSize<e.size?console.warn(`File size limit exceeded. -> ${e.name} (${(e.size/1024/1024).toFixed(2)}MB)`):(console.log(e.name+" type:"+e.type),yield Z_.instance.addAsync(e)))})}handleText(e){return xg(this,void 0,void 0,function*(){if(!(e.type.indexOf("text/")<0)){console.log(e.name+" type:"+e.type);try{let t=qy.xml2element(yield kg.readAsTextAsync(e));t&&Uy.trigger("XML_LOADED",{xmlElement:t})}catch(t){console.warn(t)}}})}handleZip(e){return xg(this,void 0,void 0,function*(){if(!(0<=e.type.indexOf("application/")||e.type.length<1))return;let t=new nC;try{t=yield t.loadAsync(e)}catch(i){return void console.warn(i)}let n=[];t.forEach((e,t)=>n.push(t));for(let e of n)try{let t=yield e.async("arraybuffer");console.log(e.name+" \u89e3\u51cd..."),yield this.load([new File([t],e.name,{type:eC.type(e.name)})])}catch(i){console.warn(i)}})}saveAsync(e,t,n){return xg(this,void 0,void 0,function*(){if(!e)return;let i=e instanceof FileList?rC(e):e,r=new nC;for(let e of i)r.file(e.name,e);let s=yield r.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}},n);Object(tC.saveAs)(s,t+".zip")})}}function rC(e){let t=[],n=e.length;for(let i=0;i<n;i++)t.push(e[i]);return t}var sC,oC=function(e){return e.ASC="ASC",e.DESC="DESC",e}({});let aC=(()=>{let e=sC=class extends Ky{constructor(){super(...arguments),this.sortTag="name",this.sortOrder=oC.ASC,this.dataTag="HP MP \u654f\u6377\u5ea6 \u751f\u547d\u529b \u7cbe\u795e\u529b"}static get instance(){return sC._instance||(sC._instance=new sC("DataSummarySetting"),sC._instance.initialize()),sC._instance}get dataTags(){return this._dataTag!==this.dataTag&&(this._dataTag=this.dataTag,this._dataTags=null!=this.dataTag&&0<this.dataTag.trim().length?this.dataTag.trim().split(/\s+/):[]),this._dataTags}innerXml(){return""}parseInnerXml(e){let t=sC.instance.toContext();t.syncData=this.toContext().syncData,sC.instance.apply(t),sC.instance.update(),this.destroy()}};return Cg([nv()],e.prototype,"sortTag",void 0),Cg([nv()],e.prototype,"sortOrder",void 0),Cg([nv()],e.prototype,"dataTag",void 0),e=sC=Cg([tv("summary-setting")],e),e})();var lC;let cC=(()=>{let e=lC=class extends uv{constructor(){super(...arguments),this.isLock=!1}get name(){return this.getCommonValue("name","")}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get opacity(){let e=this.getElement("opacity",this.commonDataElement),t=e?e.currentValue/e.value:1;return Number.isNaN(t)?1:t}static create(e,t,n,i,r){let s=null;return s=r?new lC(r):new lC,s.createDataElements(),s.commonDataElement.appendChild(hv.create("name",e,{},"name_"+s.identifier)),s.commonDataElement.appendChild(hv.create("width",t,{},"width_"+s.identifier)),s.commonDataElement.appendChild(hv.create("height",n,{},"height_"+s.identifier)),s.commonDataElement.appendChild(hv.create("opacity",i,{type:"numberResource",currentValue:i},"opacity_"+s.identifier)),s.initialize(),s}};return Cg([nv()],e.prototype,"isLock",void 0),e=lC=Cg([tv("table-mask")],e),e})();var hC,uC=function(e){return e[e.NULL=0]="NULL",e[e.FLOOR=1]="FLOOR",e[e.WALL=2]="WALL",e[e.ALL=3]="ALL",e}({});let dC=(()=>{let e=hC=class extends uv{constructor(){super(...arguments),this.isLocked=!1,this.mode=uC.ALL,this.rotate=0,this.isDropShadow=!0,this.isSurfaceShading=!0,this.isInteract=!0,this.isSlope=!1}get width(){return this.getCommonValue("width",1)}set width(e){this.setCommonValue("width",e)}get height(){return this.getCommonValue("height",1)}set height(e){this.setCommonValue("height",e)}get depth(){return this.getCommonValue("depth",1)}set depth(e){this.setCommonValue("depth",e)}get name(){return this.getCommonValue("name","")}set name(e){this.setCommonValue("name",e)}get wallImage(){return this.getImageFile("wall")}get floorImage(){return this.getImageFile("floor")}get hasWall(){return!!(this.mode&uC.WALL)}get hasFloor(){return!!(this.mode&uC.FLOOR)}static create(e,t,n,i,r,s,o){let a=null;return a=o?new hC(o):new hC,a.createDataElements(),a.commonDataElement.appendChild(hv.create("name",e,{},"name_"+a.identifier)),a.commonDataElement.appendChild(hv.create("width",t,{},"width_"+a.identifier)),a.commonDataElement.appendChild(hv.create("height",i,{},"height_"+a.identifier)),a.commonDataElement.appendChild(hv.create("depth",n,{},"depth_"+a.identifier)),a.commonDataElement.appendChild(hv.create("altitude",0,{},"altitude_"+a.identifier)),a.imageDataElement.appendChild(hv.create("wall",r,{type:"image"},"wall_"+a.identifier)),a.imageDataElement.appendChild(hv.create("floor",s,{type:"image"},"floor_"+a.identifier)),a.initialize(),a}};return Cg([nv()],e.prototype,"isLocked",void 0),Cg([nv()],e.prototype,"mode",void 0),Cg([nv()],e.prototype,"rotate",void 0),Cg([nv()],e.prototype,"isDropShadow",void 0),Cg([nv()],e.prototype,"isSurfaceShading",void 0),Cg([nv()],e.prototype,"isInteract",void 0),Cg([nv()],e.prototype,"isSlope",void 0),e=hC=Cg([tv("terrain")],e),e})();var pC=function(e){return e[e.NONE=-1]="NONE",e[e.SQUARE=0]="SQUARE",e[e.HEX_VERTICAL=1]="HEX_VERTICAL",e[e.HEX_HORIZONTAL=2]="HEX_HORIZONTAL",e}({}),fC=function(e){return e.NONE="",e.WHITE="white",e.BLACK="black",e}({});let gC=(()=>{let e=class extends ev{constructor(){super(...arguments),this.name="\u30c6\u30fc\u30d6\u30eb",this.width=20,this.height=20,this.gridSize=50,this.imageIdentifier="imageIdentifier",this.backgroundImageIdentifier="imageIdentifier",this.backgroundFilterType=fC.NONE,this.selected=!1,this.gridType=pC.SQUARE,this.gridColor="#000000e6",this.gridHeight=0}get terrains(){let e=[];return this.children.forEach(t=>{t instanceof dC&&e.push(t)}),e}get masks(){let e=[];return this.children.forEach(t=>{t instanceof cC&&e.push(t)}),e}onStoreAdded(){super.onStoreAdded(),this.selected&&Uy.trigger("SELECT_GAME_TABLE",{identifier:this.identifier})}};return Cg([nv()],e.prototype,"name",void 0),Cg([nv()],e.prototype,"width",void 0),Cg([nv()],e.prototype,"height",void 0),Cg([nv()],e.prototype,"gridSize",void 0),Cg([nv()],e.prototype,"imageIdentifier",void 0),Cg([nv()],e.prototype,"backgroundImageIdentifier",void 0),Cg([nv()],e.prototype,"backgroundFilterType",void 0),Cg([nv()],e.prototype,"selected",void 0),Cg([nv()],e.prototype,"gridType",void 0),Cg([nv()],e.prototype,"gridColor",void 0),e=Cg([tv("game-table")],e),e})();var mC;let bC=(()=>{let e=mC=class extends uv{constructor(){super(...arguments),this.rotate=0,this.zindex=0,this.password="",this.isUpright=!0,this.isLocked=!1}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get fontSize(){return this.getCommonValue("fontsize",1)}get title(){return this.getCommonValue("title","")}get text(){return this.getCommonValue("text","")}set text(e){this.setCommonValue("text",e)}toTopmost(){tw(this)}static create(e,t,n=16,i=1,r=1,s){let o=s?new mC(s):new mC;return o.createDataElements(),o.commonDataElement.appendChild(hv.create("width",i,{},"width_"+o.identifier)),o.commonDataElement.appendChild(hv.create("height",r,{},"height_"+o.identifier)),o.commonDataElement.appendChild(hv.create("fontsize",n,{},"fontsize_"+o.identifier)),o.commonDataElement.appendChild(hv.create("title",e,{},"title_"+o.identifier)),o.commonDataElement.appendChild(hv.create("text",t,{type:"note",currentValue:t},"text_"+o.identifier)),o.commonDataElement.appendChild(hv.create("altitude",0,{},"altitude_"+o.identifier)),o.initialize(),o}};return Cg([nv()],e.prototype,"rotate",void 0),Cg([nv()],e.prototype,"zindex",void 0),Cg([nv()],e.prototype,"password",void 0),Cg([nv()],e.prototype,"isUpright",void 0),Cg([nv()],e.prototype,"isLocked",void 0),e=mC=Cg([tv("text-note")],e),e})(),yC=(()=>{let e=class extends Ky{onStoreAdded(){super.onStoreAdded(),Vy.instance.remove(this)}innerXml(){let e="",t=[];t=t.concat(Vy.instance.getObjects(gC)),t=t.concat(Vy.instance.getObjects(gv)),t=t.concat(Vy.instance.getObjects(bC)),t=t.concat(Vy.instance.getObjects(ow)),t=t.concat(Vy.instance.getObjects(rw).filter(e=>null===e.parent)),t=t.concat(Vy.instance.getObjects(cw));for(let n of t)e+=n.toXml();return e}parseInnerXml(e){let t=[];t=t.concat(Vy.instance.getObjects(gC)),t=t.concat(Vy.instance.getObjects(cC)),t=t.concat(Vy.instance.getObjects(dC)),t=t.concat(Vy.instance.getObjects(gv)),t=t.concat(Vy.instance.getObjects(bC)),t=t.concat(Vy.instance.getObjects(ow)),t=t.concat(Vy.instance.getObjects(rw)),t=t.concat(Vy.instance.getObjects(cw));for(let n of t)n.destroy();for(let n=0;n<e.children.length;n++)Xy.instance.parseXml(e.children[n])}};return e=Cg([tv("room")],e),e})();var vC=n("NH6c");let _C=(()=>{class e{constructor(e){this.ngZone=e}saveRoomAsync(t="\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",n){return e.queue.add((e,i)=>e(this._saveRoomAsync(t,n)))}_saveRoomAsync(e="\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",t){let n=[],i=this.convertToXml(new yC),r=this.convertToXml(pw.instance),s=this.convertToXml(yv.instance),o=this.convertToXml(aC.instance);return n.push(new File([i],"data.xml",{type:"text/plain"})),n.push(new File([r],"chat.xml",{type:"text/plain"})),n.push(new File([s],"rollTable.xml",{type:"text/plain"})),n.push(new File([o],"summary.xml",{type:"text/plain"})),n=n.concat(this.searchImageFiles(i)),n=n.concat(this.searchImageFiles(r)),this.saveAsync(n,this.appendTimestamp(e),t)}saveGameObjectAsync(t,n="xml_data",i){return e.queue.add((e,r)=>e(this._saveGameObjectAsync(t,n,i)))}_saveGameObjectAsync(e,t="xml_data",n){let i=[],r=this.convertToXml(e);return i.push(new File([r],"data.xml",{type:"text/plain"})),i=i.concat(this.searchImageFiles(r)),this.saveAsync(i,this.appendTimestamp(t),n)}saveAsync(e,t,n){let i=-1;return iC.instance.saveAsync(e,t,e=>{let t=0|e.percent;t<=i||(i=t,this.ngZone.run(()=>n(i)))})}convertToXml(e){return'<?xml version="1.0" encoding="UTF-8"?>\n'+vC.xml(e.toXml(),2)}searchImageFiles(e){let t=qy.xml2element(e),n=[];if(!t)return n;let i={},r=t.ownerDocument.querySelectorAll('*[type="image"]');for(let s=0;s<r.length;s++){let e=r[s].innerHTML;i[e]=ov.instance.get(e);let t=r[s].getAttribute("currentValue");t&&(i[t]=ov.instance.get(t))}r=t.ownerDocument.querySelectorAll("*[imageIdentifier], *[backgroundImageIdentifier]");for(let s=0;s<r.length;s++){let e=r[s].getAttribute("imageIdentifier");e&&(i[e]=ov.instance.get(e));let t=r[s].getAttribute("backgroundImageIdentifier");t&&(i[t]=ov.instance.get(t))}for(let s in i){let e=i[s];e&&e.state===Og.COMPLETE&&n.push(new File([e.blob],e.identifier+"."+eC.extension(e.blob.type),{type:e.blob.type}))}return n}appendTimestamp(e){let t=new Date;return e+`_${t.getFullYear()}-${("00"+(t.getMonth()+1)).slice(-2)}-${("00"+t.getDate()).slice(-2)}_${("00"+t.getHours()).slice(-2)}${("00"+t.getMinutes()).slice(-2)}`}}return e.queue=new iv("SaveDataServiceQueue"),e.\u0275fac=function(t){return new(t||e)(oi(Rc))},e.\u0275prov=pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function wC(e,t){1&e&&Ro(0)}function CC(e,t){if(1&e){const e=Fo();Io(0,"div",3),Eo(1,wC,1,0,"ng-container",5),Io(2,"select",6),zo("change",function(t){return Ft(e),jo(3).setElementType(t.target.value)}),Io(3,"option",7),ga(4,"\u901a\u5e38"),Mo(),Io(5,"option",8),ga(6,"\u6570\u5024"),Mo(),Io(7,"option",9),ga(8,"\u30ea\u30bd\u30fc\u30b9"),Mo(),Io(9,"option",10),ga(10,"\u80fd\u529b\u5024"),Mo(),Io(11,"option",11),ga(12,"\u30c1\u30a7\u30c3\u30af"),Mo(),Io(13,"option",12),ga(14,"\u30ce\u30fc\u30c8"),Mo(),Io(15,"option",13),ga(16,"\u53c2\u7167URL"),Mo(),Mo(),Mo()}if(2&e){const e=jo(3),t=ko(2);Zr(1),To("ngTemplateOutlet",t),Zr(1),To("ngModel",e.gameDataElement.type)}}function xC(e,t){if(1&e&&(Po(0),Io(1,"div",14),ga(2),Mo(),Do()),2&e){const e=jo(3);Zr(2),ma(e.name)}}function EC(e,t){if(1&e){const e=Fo();Po(0),Io(1,"div",15),ga(2),Mo(),Io(3,"input",16),zo("ngModelChange",function(t){return Ft(e),jo(3).name=t}),Mo(),Do()}if(2&e){const e=jo(3);Zr(2),ma(e.name),Zr(1),To("ngModel",e.name)}}function kC(e,t){if(1&e){const e=Fo();Po(0),Io(1,"input",17),zo("ngModelChange",function(t){return Ft(e),jo(3).value=t}),ql(2,"safe"),Mo(),Ao(3,"br"),Io(4,"input",18),zo("ngModelChange",function(t){return Ft(e),jo(3).value=t}),Mo(),Do()}if(2&e){const e=jo(3);Zr(1),ia($l(2,10,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),Go("title",e.value),Go("min","altitude"===e.name?-12:"fontsize"===e.name?1:0),Go("max","fontsize"===e.name?128:12),Go("step","fontsize"===e.name?1:.5),To("ngModel",e.value),Zr(3),Go("min","altitude"===e.name?-24:"fontsize"===e.name?1:0),Go("step","fontsize"===e.name?1:.1),To("ngModel",e.value)}}function SC(e,t){if(1&e){const e=Fo();Po(0),Io(1,"div",22),ga(2),Mo(),Io(3,"input",23),zo("ngModelChange",function(t){return Ft(e),jo(4).value=t}),Mo(),Do()}if(2&e){const e=jo(4);Zr(2),ma(e.value),Zr(1),Go("type",e.isNum(e.value)?"number":"text"),To("ngModel",e.value)}}function TC(e,t){if(1&e){const e=Fo();Po(0),Io(1,"input",24),zo("ngModelChange",function(t){return Ft(e),jo(4).currentValue=t}),ql(2,"safe"),Mo(),Ao(3,"br"),Io(4,"input",25),zo("ngModelChange",function(t){return Ft(e),jo(4).currentValue=t}),Mo(),ga(5," / "),Io(6,"input",26),zo("ngModelChange",function(t){return Ft(e),jo(4).value=t}),Mo(),Do()}if(2&e){const e=jo(4);Zr(1),ia($l(2,7,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),Go("title",e.currentValue),Go("max",e.isNum(e.value)?e.value:1e3),To("ngModel",e.currentValue),Zr(3),To("ngModel",e.currentValue),Zr(2),To("ngModel",e.value)}}function OC(e,t){if(1&e){const e=Fo();Po(0),Io(1,"select",28),zo("ngModelChange",function(t){return Ft(e),jo(5).currentValue=t}),Io(2,"option",7),ga(3,"\u306a\u3057"),Mo(),Io(4,"option",29),ga(5,"\xf72"),Mo(),Io(6,"option",30),ga(7,"\xf73 SRS,LHZ"),Mo(),Io(8,"option",31),ga(9,"\xf74"),Mo(),Io(10,"option",32),ga(11,"\xf75"),Mo(),Io(12,"option",33),ga(13,"\xf76 SW"),Mo(),Io(14,"option",34),ga(15,"\xf710"),Mo(),Io(16,"option",35),ga(17,"D&D 3e\uff5e"),Mo(),Mo(),Do()}if(2&e){const e=jo(5);Zr(1),To("ngModel",e.currentValue)}}function IC(e,t){if(1&e&&(Po(0),Io(1,"span",36),ga(2),Mo(),Do()),2&e){const e=jo(5);Zr(2),ma("("+(e.abilityScore>=0?"+":"")+e.abilityScore+")")}}function MC(e,t){if(1&e){const e=Fo();Po(0),Io(1,"input",27),zo("ngModelChange",function(t){return Ft(e),jo(4).value=t}),Mo(),Eo(2,OC,18,1,"ng-container",0),Eo(3,IC,3,1,"ng-container",0),Do()}if(2&e){const e=jo(4);Zr(1),Go("type",e.isNum(e.value)?"number":"text"),To("ngModel",e.value),Zr(1),To("ngIf",e.isEdit),Zr(1),To("ngIf",!e.isEdit)}}function AC(e,t){if(1&e){const e=Fo();Po(0),Io(1,"input",37),zo("ngModelChange",function(t){return Ft(e),jo(4).currentValue=t}),Mo(),Io(2,"input",38),zo("ngModelChange",function(t){return Ft(e),jo(4).value=t})("change",function(){Ft(e);const t=jo(4);return t.value=t.value?t.name:""}),Mo(),Do()}if(2&e){const e=jo(4);Zr(1),To("ngModel",e.currentValue),Zr(1),Go("checked",e.value?"checked":""),To("ngModel",e.value)}}function PC(e,t){if(1&e){const e=Fo();Po(0),Io(1,"textarea",39),zo("ngModelChange",function(t){return Ft(e),jo(4).value=t}),Mo(),Do()}if(2&e){const e=jo(4);Zr(1),To("ngModel",e.value)}}function DC(e,t){if(1&e){const e=Fo();Po(0),Io(1,"div",22),ga(2),Mo(),Io(3,"input",40),zo("ngModelChange",function(t){return Ft(e),jo(4).value=t}),Mo(),Do()}if(2&e){const e=jo(4);Zr(2),ma(e.value),Zr(1),To("ngModel",e.value)}}function RC(e,t){if(1&e){const e=Fo();Po(0),Io(1,"div",22),ga(2),Mo(),Io(3,"input",41),zo("ngModelChange",function(t){return Ft(e),jo(4).value=t}),Mo(),Do()}if(2&e){const e=jo(4);Zr(2),ma(e.value),Zr(1),To("ngModel",e.value)}}function FC(e,t){if(1&e&&(Po(0),Po(1,19),Eo(2,SC,4,3,"ng-container",20),Eo(3,TC,7,10,"ng-container",20),Eo(4,MC,4,4,"ng-container",20),Eo(5,AC,3,3,"ng-container",20),Eo(6,PC,2,1,"ng-container",20),Eo(7,DC,4,2,"ng-container",20),Eo(8,RC,4,2,"ng-container",21),Do(),Do()),2&e){const e=jo(3);Zr(1),To("ngSwitch",e.gameDataElement.type),Zr(1),To("ngSwitchCase","simpleNumber"),Zr(1),To("ngSwitchCase","numberResource"),Zr(1),To("ngSwitchCase","abilityScore"),Zr(1),To("ngSwitchCase","checkProperty"),Zr(1),To("ngSwitchCase","note"),Zr(1),To("ngSwitchCase","url")}}function NC(e,t){if(1&e&&(Po(0),Eo(1,CC,17,2,"div",2),Io(2,"div",3),Eo(3,xC,3,1,"ng-container",0),Eo(4,EC,4,2,"ng-container",0),Mo(),Io(5,"div",4),Eo(6,kC,5,13,"ng-container",0),Eo(7,FC,9,7,"ng-container",0),Mo(),Do()),2&e){const e=jo(2);Zr(1),To("ngIf",e.isEdit),Zr(2),To("ngIf",e.isTagLocked),Zr(1),To("ngIf",!e.isTagLocked),Zr(2),To("ngIf",e.isCommonValue),Zr(1),To("ngIf",!e.isCommonValue)}}function zC(e,t){1&e&&Ro(0)}function LC(e,t){if(1&e&&(Io(0,"div",47),Eo(1,zC,1,0,"ng-container",5),Mo()),2&e){jo(3);const e=ko(2);Zr(1),To("ngTemplateOutlet",e)}}function BC(e,t){if(1&e&&(Po(0),Io(1,"div",48),ga(2),Mo(),Do()),2&e){const e=jo(3);Zr(2),ma(e.name)}}function jC(e,t){if(1&e){const e=Fo();Po(0),Io(1,"input",49),zo("ngModelChange",function(t){return Ft(e),jo(3).name=t}),Mo(),Do()}if(2&e){const e=jo(3);Zr(1),To("ngModel",e.name)}}function UC(e,t){if(1&e&&Ao(0,"div",52),2&e){const e=t.$implicit,n=jo(4);To("gameDataElement",e)("isEdit",n.isEdit)("isTagLocked",n.isTagLocked)}}function HC(e,t){if(1&e&&(Io(0,"div",50),Eo(1,UC,1,3,"div",51),Mo()),2&e){const e=jo(3);Zr(1),To("ngForOf",e.gameDataElement.children)}}function VC(e,t){if(1&e&&(Po(0),Eo(1,LC,2,1,"div",42),Ao(2,"div",43),Io(3,"div",44),Io(4,"div",45),Eo(5,BC,3,1,"ng-container",0),Eo(6,jC,2,1,"ng-container",0),Mo(),Eo(7,HC,2,1,"div",46),Mo(),Do()),2&e){const e=jo(2);Zr(1),To("ngIf",e.isEdit),Zr(4),To("ngIf",e.isTagLocked),Zr(1),To("ngIf",!e.isTagLocked),Zr(1),To("ngIf",0<e.gameDataElement.children.length)}}function GC(e,t){if(1&e&&(Po(0),Eo(1,NC,8,5,"ng-container",0),Eo(2,VC,8,4,"ng-container",0),Do()),2&e){const e=jo();Zr(1),To("ngIf",e.gameDataElement.children.length<1),Zr(1),To("ngIf",0<e.gameDataElement.children.length)}}function ZC(e,t){if(1&e){const e=Fo();Io(0,"button",53),zo("click",function(){return Ft(e),jo().addElement()}),Io(1,"i",54),ga(2,"add_circle"),Mo(),Mo(),Io(3,"button",53),zo("click",function(){return Ft(e),jo().upElement()}),Io(4,"i",54),ga(5,"arrow_upward"),Mo(),Mo(),Ao(6,"br"),Io(7,"button",53),zo("click",function(){return Ft(e),jo().deleteElement()}),Io(8,"i",54),ga(9,"remove_circle_outline"),Mo(),Mo(),Io(10,"button",53),zo("click",function(){return Ft(e),jo().downElement()}),Io(11,"i",54),ga(12,"arrow_downward"),Mo(),Mo()}}let WC=(()=>{class e{constructor(e){this.changeDetector=e,this.gameDataElement=null,this.isEdit=!1,this.isTagLocked=!1,this.isValueLocked=!1,this._name="",this._value=0,this._currentValue=0,this.updateTimer=null}get name(){return this._name}set name(e){this._name=e,this.setUpdateTimer()}get value(){return this._value}set value(e){this._value=e,this.setUpdateTimer()}get currentValue(){return this._currentValue}set currentValue(e){this._currentValue=e,this.setUpdateTimer()}get abilityScore(){return this.gameDataElement.calcAbilityScore()}get isCommonValue(){return!!this.gameDataElement&&this.isTagLocked&&("size"===this.gameDataElement.name||"width"===this.gameDataElement.name||"height"===this.gameDataElement.name||"depth"===this.gameDataElement.name||"fontsize"===this.gameDataElement.name||"altitude"===this.gameDataElement.name)}ngOnInit(){this.gameDataElement&&this.setValues(this.gameDataElement),Uy.register(this).on("UPDATE_GAME_OBJECT",-1e3,e=>{this.gameDataElement&&e.data.identifier===this.gameDataElement.identifier&&(this.setValues(this.gameDataElement),this.changeDetector.markForCheck())}).on("DELETE_GAME_OBJECT",-1e3,e=>{this.gameDataElement&&this.gameDataElement.identifier===e.data.identifier&&this.changeDetector.markForCheck()})}ngOnDestroy(){Uy.unregister(this)}ngAfterViewInit(){}addElement(){this.gameDataElement.appendChild(hv.create("\u30bf\u30b0","",{}))}deleteElement(){this.gameDataElement.destroy()}upElement(){let e=this.gameDataElement.parent,t=e.children.indexOf(this.gameDataElement);0<t&&e.insertBefore(this.gameDataElement,e.children[t-1])}downElement(){let e=this.gameDataElement.parent,t=e.children.indexOf(this.gameDataElement);t<e.children.length-1&&e.insertBefore(e.children[t+1],this.gameDataElement)}setElementType(e){this.gameDataElement.setAttribute("type",e)}isNum(e){return isFinite(e)}setValues(e){this._name=e.name,this._currentValue=e.currentValue,this._value=e.value}setUpdateTimer(){clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>{this.gameDataElement.name!==this.name&&(this.gameDataElement.name=this.name),this.gameDataElement.currentValue!==this.currentValue&&(this.gameDataElement.currentValue=this.currentValue),this.gameDataElement.value!==this.value&&(this.gameDataElement.value=this.value),this.updateTimer=null},66)}}return e.\u0275fac=function(t){return new(t||e)(So(fl))},e.\u0275cmp=Ze({type:e,selectors:[["game-data-element"],["","game-data-element",""]],inputs:{gameDataElement:"gameDataElement",isEdit:"isEdit",isTagLocked:"isTagLocked",isValueLocked:"isValueLocked"},decls:3,vars:1,consts:[[4,"ngIf"],["editButtons",""],["class","table-cell table-cell_solid",4,"ngIf"],[1,"table-cell","table-cell_solid"],[1,"table-cell"],[4,"ngTemplateOutlet"],[3,"ngModel","change"],["value",""],["value","simpleNumber"],["value","numberResource"],["value","abilityScore"],["value","checkProperty"],["value","note"],["value","url"],[2,"font-family","Cambria, Georgia","font-size","0.9rem"],[1,"hidden-spacer",2,"font-family","Cambria, Georgia","font-size","0.9rem"],["size","1","placeholder","Value",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","0.9rem",3,"ngModel","ngModelChange"],["type","range",2,"width","90%",3,"ngModel","title","min","max","step","ngModelChange"],["type","number","size","1","placeholder","Value",2,"width","40%","max-width","8em","text-align","right",3,"min","step","ngModel","ngModelChange"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"hidden-spacer",2,"font-size","1.0em","font-family","Cambria, Georgia"],["size","1","placeholder","Number",2,"width","40%","min-width","3em","max-width","8em","text-align","right",3,"type","ngModel","ngModelChange"],["type","range","min","0",3,"ngModel","title","max","ngModelChange"],["size","1","type","number","placeholder","Value",2,"width","5em","text-align","right",3,"ngModel","ngModelChange"],["size","1","type","number","placeholder","Value",2,"width","5em",3,"ngModel","ngModelChange"],["size","1","placeholder","Value",2,"width","40%","max-width","5em","text-align","right",3,"type","ngModel","ngModelChange"],[1,"modeifire-type",2,"width","40%","max-width","5em",3,"ngModel","ngModelChange"],["value","div2"],["value","div3"],["value","div4"],["value","div5"],["value","div6"],["value","div10"],["value","DnD3"],[2,"font-size","smaller"],["type","text","size","1","placeholder","Option",2,"width","50%","max-width","4em",3,"ngModel","ngModelChange"],["type","checkbox",2,"width","30%","max-width","4em",3,"ngModel","checked","ngModelChange","change"],["placeholder","Note",2,"width","100%","height","5em","min-width","50px","resize","bose","font-size","0.8em",3,"ngModel","ngModelChange"],["type","url","size","1","placeholder","https://www.example.com",2,"width","100%","min-width","10px",3,"ngModel","ngModelChange"],["size","1","placeholder","Value",2,"width","100%","min-width","10px",3,"ngModel","ngModelChange"],["class","table-cell table-cell_solid","style","vertical-align: top;",4,"ngIf"],[1,"table-cell","table-cell_inner-table",2,"padding","0","width","0"],[1,"table-cell_inner-table"],[1,"table-cell_inner-table-title"],["class","table",4,"ngIf"],[1,"table-cell","table-cell_solid",2,"vertical-align","top"],[2,"padding","2px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold"],["size","1","placeholder","Value",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold",3,"ngModel","ngModelChange"],[1,"table"],["game-data-element","","class","table-row",3,"gameDataElement","isEdit","isTagLocked",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","isEdit","isTagLocked"],[3,"click"],[1,"material-icons"]],template:function(e,t){1&e&&(Eo(0,GC,3,2,"ng-container",0),Eo(1,ZC,13,0,"ng-template",null,1,dc)),2&e&&To("ngIf",t.gameDataElement)},directives:[Zh,Jh,Ld,sd,Sd,Bd,Vd,ju,Fd,Id,$h,Xh,Kh,zu,Vh,e],pipes:[$_],styles:[".game-data-element[_ngcontent-%COMP%]{margin-left:10px}.table[_ngcontent-%COMP%]{display:table;width:100%}.table[_ngcontent-%COMP%], .table-row[_ngcontent-%COMP%]{box-sizing:border-box}.table-row[_ngcontent-%COMP%]{padding-top:10px;display:table-row}.table-cell[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.5em 0 .1em .5em;border-bottom:1px dotted #888;box-sizing:border-box}.table-cell_solid[_ngcontent-%COMP%]{width:10px;white-space:nowrap}.table-cell_inner-table[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.2em 0 .1em .5em;border:none;box-sizing:border-box}.table-cell_inner-table-title[_ngcontent-%COMP%]{border-bottom:1px solid #444;border-left:8px solid #444;padding-left:8px}.box[_ngcontent-%COMP%]{display:inline-block;margin:10px}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;max-width:20em;overflow:hidden;padding:0 3px;box-sizing:border-box}button[_ngcontent-%COMP%], input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}input[_ngcontent-%COMP%]:hover, select[_ngcontent-%COMP%]:hover, textarea[_ngcontent-%COMP%]:hover{background:#eee}input[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus{background:#fff}button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}.table-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.5rem}input[type=range][_ngcontent-%COMP%]{--slider-track-color:transparent;--slider-fill-color:#555;--slider-border-color:#777;--slider-height:0.8em;--slider-thumb-size:1.0em;--range:calc(var(--max) - var(--min));--ratio:calc((var(--val) - var(--min))/var(--range));--sx:calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:1px solid var(--slider-border-color);border-bottom:1px solid var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color);background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.modeifire-type[_ngcontent-%COMP%]{font-size:smaller}"],changeDetection:0}),e})();function YC(e,t){1&e&&Ro(0)}function qC(e,t){if(1&e){const e=Fo();Po(0),Io(1,"button",0),zo("click",function(){return Ft(e),jo().openModal("front")}),ga(2,"\u8868\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),Mo(),Io(3,"button",0),zo("click",function(){return Ft(e),jo().openModal("back")}),ga(4,"\u88cf\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),Mo(),Do()}}function $C(e,t){1&e&&Ro(0)}function XC(e,t){if(1&e){const e=Fo();Po(0),Io(1,"button",0),zo("click",function(){return Ft(e),jo().openModal("floor")}),ga(2,"\u5e8a\u306e\u753b\u50cf\u3092\u5909\u66f4"),Mo(),Io(3,"button",0),zo("click",function(){return Ft(e),jo().openModal("wall")}),ga(4,"\u58c1\u306e\u753b\u50cf\u3092\u5909\u66f4"),Mo(),Do()}}function KC(e,t){if(1&e){const e=Fo();Po(0),Io(1,"button",4),zo("click",function(){Ft(e);const t=jo();return t.openModal(t.tabletopObject.face)}),ga(2,"\u30c0\u30a4\u30b9\u76ee\u306e\u753b\u50cf\u3092\u5909\u66f4"),Mo(),Do()}if(2&e){const e=jo();Zr(1),To("disabled",!e.tabletopObject.isVisible)}}function QC(e,t){if(1&e){const e=Fo();Po(0),Io(1,"button",0),zo("click",function(){Ft(e);const t=jo();return t.openModalReplaceImage(t.tabletopObject.imageFiles.length>1||0<(null==t.tabletopObject.imageFile?null:t.tabletopObject.imageFile.url.length))}),ga(2),Mo(),Io(3,"button",4),zo("click",function(){return Ft(e),jo().openModal("faceIcon")}),ga(4),Mo(),Do()}if(2&e){const e=jo();Zr(2),ba("\u753b\u50cf",(null==e.tabletopObject.imageFiles?null:e.tabletopObject.imageFiles.length)>1?"\u7f6e\u63db/\u524a\u9664":"\u8a2d\u5b9a",""),Zr(1),To("disabled",(null==e.tabletopObject.faceIcons?null:e.tabletopObject.faceIcons.length)>=e.MAX_IMAGE_ICON_COUNT),Zr(1),ba("\u9854IC",(null==e.tabletopObject.faceIcons?null:e.tabletopObject.faceIcons.length)>0?"\u8ffd\u52a0":"\u8a2d\u5b9a","")}}function JC(e,t){if(1&e){const e=Fo();Po(0),Io(1,"button",0),zo("click",function(){Ft(e);const t=jo();return t.openModal("imageIdentifier",t.tabletopObject.imageFile&&t.tabletopObject.imageFile.url.length>0)}),ga(2,"\u753b\u50cf\u5909\u66f4"),Mo(),Do()}}function ex(e,t){if(1&e&&(Io(0,"div",10),ga(1),Mo()),2&e){const e=jo();Zr(1),ba("",e.progresPercent,"%")}}function tx(e,t){if(1&e){const e=Fo();Io(0,"select",12),zo("change",function(t){return Ft(e),jo(2).setLocation(t.target.value)}),Io(1,"option",13),ga(2,"\u30c6\u30fc\u30d6\u30eb"),Mo(),Io(3,"option",14),ga(4,"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),Mo(),Io(5,"option",15),ga(6,"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),Mo(),Io(7,"option",16),ga(8,"\u5893\u5730"),Mo(),Mo()}if(2&e){const e=jo(2);To("ngModel",e.tabletopObject.location.name),Zr(5),Go("value",e.networkService.peerId)}}function nx(e,t){if(1&e){const e=Fo();Po(0),Eo(1,tx,9,2,"select",11),Io(2,"button",4),zo("click",function(){Ft(e);const t=jo();return t.openModal("shadowImageIdentifier",t.tabletopObject.shadowImageFile.url.length>0)}),ga(3,"\u753b\u50cf\u306e\u5f71\u306e\u5909\u66f4"),Mo(),Do()}if(2&e){const e=jo();Zr(1),To("ngIf",e.tabletopObject),Zr(1),To("disabled",!e.tabletopObject.imageElement||"null"==e.tabletopObject.imageElement.value)}}function ix(e,t){if(1&e){const e=Fo();Io(0,"button",33),zo("click",function(){Ft(e);const t=jo(2).index;return jo(3).deleteIcon(t)}),Io(1,"b",34),ga(2,"close"),Mo(),Mo()}}const rx=function(e){return{"current-icon":e}};function sx(e,t){if(1&e){const e=Fo();Io(0,"div",30),Io(1,"img",31),zo("click",function(){Ft(e);const t=jo().index;return jo(3).selectIcon(t)}),ql(2,"safe"),Mo(),Eo(3,ix,3,0,"button",32),Mo()}if(2&e){const e=jo(),t=e.index,n=e.$implicit,i=jo(3);To("@bounceInOut",void 0)("ngClass",Ul(8,rx,i.tabletopObject.currntIconIndex==t)),Zr(1),To("src",$l(2,5,n.url,"resourceUrl"),Xi)("alt",n.name),Zr(2),To("ngIf",i.tabletopObject.currntIconIndex==t)}}function ox(e,t){if(1&e&&(Po(0),Eo(1,sx,4,10,"div",29),Do()),2&e){const e=t.$implicit;Zr(1),To("ngIf",0<e.url.length)}}const ax=function(e){return{hide:e}};function lx(e,t){if(1&e){const e=Fo();Io(0,"span",35),Io(1,"img",31),zo("click",function(){Ft(e);const n=t.index;return jo(3).selectImage(n)}),ql(2,"safe"),Mo(),Mo()}if(2&e){const e=t.$implicit,n=t.index,i=jo(3);ta("left",50*(i.tabletopObject.currntImageIndex<=n?n-1:n),"px"),To("ngClass",Ul(9,ax,i.tabletopObject.currntImageIndex==n)),Zr(1),To("@bounceInOut",void 0)("src",$l(2,6,e.url,"resourceUrl"),Xi)("alt",e.name)}}function cx(e,t){if(1&e){const e=Fo();Io(0,"button",36),zo("click",function(){return Ft(e),jo(3).openModalAddImage()}),ga(1),Mo()}if(2&e){const e=jo(3);ta("left",e.tabletopObject.imageFiles.length<0?-5:50*(e.tabletopObject.imageFiles.length-1)-5,"px"),Zr(1),ma(e.tabletopObject.imageFiles.length<2?"\u5207\u308a\u66ff\u3048\u753b\u50cf\u8a2d\u5b9a":"\uff0b")}}const hx=function(e){return{inverse:e}},ux=function(e,t,n,i,r,s,o,a){return{black:e,blue:t,green:n,cyan:i,red:r,magenta:s,yellow:o,white:a}},dx=function(e,t){return{"black-paint":e,hollow:t}};function px(e,t){if(1&e){const e=Fo();Io(0,"div",20),Io(1,"div",21),Eo(2,ox,2,1,"ng-container",22),Mo(),Io(3,"div",23),Eo(4,lx,3,11,"span",24),Eo(5,cx,2,3,"button",25),Mo(),Io(6,"span",26),Io(7,"span",27),Io(8,"img",28),zo("dblclick",function(){return Ft(e),jo(2).openMainImageModal()}),ql(9,"safe"),Mo(),Mo(),Mo(),Mo()}if(2&e){const e=jo(2);Zr(2),To("ngForOf",e.tabletopObject.faceIcons),Zr(2),To("ngForOf",e.tabletopObject.imageFiles),Zr(1),To("ngIf","character"==e.tabletopObject.aliasName&&e.tabletopObject.imageFiles.length<e.MAX_IMAGE_ICON_COUNT&&(e.tabletopObject.imageFiles.length>1||0<(null==e.tabletopObject.imageFile?null:e.tabletopObject.imageFile.url.length))),Zr(1),To("ngClass",Ul(12,hx,e.tabletopObject.isInverse)),Zr(1),To("ngClass",Zl(14,ux,0==e.tabletopObject.aura,1==e.tabletopObject.aura,2==e.tabletopObject.aura,3==e.tabletopObject.aura,4==e.tabletopObject.aura,5==e.tabletopObject.aura,6==e.tabletopObject.aura,7==e.tabletopObject.aura)),Zr(1),To("src",$l(9,9,e.tabletopObject.imageFile.url,"resourceUrl"),Xi)("alt",e.tabletopObject.imageFile.name)("ngClass",Hl(23,dx,e.tabletopObject.isBlackPaint,e.tabletopObject.isHollow))("@switchImage",e.tabletopObject.currntImageIndex)}}function fx(e,t){if(1&e){const e=Fo();Io(0,"div",41),Io(1,"button",42),zo("click",function(){return Ft(e),jo(3).showChatPalette()}),ga(2,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a"),Mo(),Io(3,"button",42),zo("click",function(){return Ft(e),jo(3).showStandSetting()}),ga(4,"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a"),Mo(),Mo()}}function gx(e,t){if(1&e&&(Po(0),Io(1,"div",37),Io(2,"div",38),Ao(3,"div",39),Mo(),Eo(4,fx,5,0,"div",40),Mo(),Do()),2&e){const e=jo(2);Zr(3),To("gameDataElement",e.tabletopObject.commonDataElement)("isTagLocked",!0),Zr(1),To("ngIf","character"===e.tabletopObject.aliasName)}}function mx(e,t){if(1&e&&(Io(0,"div",37),Io(1,"div",38),Ao(2,"div",44),Mo(),Mo()),2&e){const e=t.$implicit,n=jo(3);Zr(2),To("gameDataElement",e)("isEdit",n.isEdit)}}function bx(e,t){if(1&e&&(Po(0),Eo(1,mx,3,2,"div",43),Do()),2&e){const e=jo(2);Zr(1),To("ngForOf",e.tabletopObject.detailDataElement.children)}}function yx(e,t){if(1&e){const e=Fo();Po(0),Io(1,"div",37),Io(2,"button",45),zo("click",function(){return Ft(e),jo(2).addDataElement()}),ga(3,"\u65b0\u3057\u3044\u9805\u76ee\u3092\u8ffd\u52a0"),Mo(),Mo(),Do()}}function vx(e,t){if(1&e){const e=Fo();Io(0,"div",17),Io(1,"img",18),zo("click",function(){return Ft(e),jo().openModal("shadowImageIdentifier",!0)}),ql(2,"safe"),Mo(),Eo(3,px,10,26,"div",19),Eo(4,gx,5,3,"ng-container",8),Eo(5,bx,2,1,"ng-container",8),Eo(6,yx,4,0,"ng-container",8),Mo()}if(2&e){const e=jo();Zr(1),To("src",$l(2,6,e.tabletopObject.shadowImageFile.url,"resourceUrl"),Xi)("alt",e.tabletopObject.shadowImageFile.name),Zr(2),To("ngIf",0<(null==e.tabletopObject.imageFile?null:e.tabletopObject.imageFile.url.length)||0<(null==e.tabletopObject.faceIcons?null:e.tabletopObject.faceIcons.length)),Zr(1),To("ngIf",e.tabletopObject.commonDataElement),Zr(1),To("ngIf",e.tabletopObject.detailDataElement),Zr(1),To("ngIf",e.isEdit)}}const _x=function(e){return{"is-hidden":e}};let wx=(()=>{class e{constructor(e,t,n,i){this.saveDataService=e,this.panelService=t,this.modalService=n,this.pointerDeviceService=i,this.tabletopObject=null,this.isEdit=!1,this.networkService=Hy,this.MAX_IMAGE_ICON_COUNT=5,this.isSaveing=!1,this.progresPercent=0}ngOnInit(){Uy.register(this).on("DELETE_GAME_OBJECT",-1e3,e=>{this.tabletopObject&&this.tabletopObject.identifier===e.data.identifier&&this.panelService.close()})}ngAfterViewInit(){}ngOnDestroy(){Uy.unregister(this)}toggleEditMode(){this.isEdit=!this.isEdit}addDataElement(){if(this.tabletopObject.detailDataElement){let e=hv.create("\u898b\u51fa\u3057","",{}),t=hv.create("\u30bf\u30b0","",{});e.appendChild(t),this.tabletopObject.detailDataElement.appendChild(e)}}clone(){let e=this.tabletopObject.clone();switch(e.location.x+=50,e.location.y+=50,this.tabletopObject.parent&&this.tabletopObject.parent.appendChild(e),e.update(),this.tabletopObject.aliasName){case"terrain":q_.play(Y_.blockPut),e.isLocked=!1;break;case"card":case"card-stack":e.owner="",e.toTopmost();case"table-mask":e.isLock=!1,q_.play(Y_.cardPut);break;case"text-note":e.toTopmost(),q_.play(Y_.cardPut);break;case"dice-symbol":q_.play(Y_.dicePut);default:q_.play(Y_.piecePut)}}saveToXML(){return xg(this,void 0,void 0,function*(){if(!this.tabletopObject||this.isSaveing)return;this.isSaveing=!0,this.progresPercent=0;let e=this.tabletopObject.commonDataElement.getFirstElementByName("name"),t=e?e.value:"";yield this.saveDataService.saveGameObjectAsync(this.tabletopObject,"xml_"+t,e=>{this.progresPercent=e}),setTimeout(()=>{this.isSaveing=!1,this.progresPercent=0},500)})}setLocation(e){Uy.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.tabletopObject.identifier}),q_.play("graveyard"==e?Y_.sweep:Y_.piecePut),this.tabletopObject.setLocation(e)}openModal(e="",t=!1){this.modalService.open(ew,{isAllowedEmpty:t}).then(t=>{if(this.tabletopObject&&this.tabletopObject.imageDataElement&&t)if("shadowImageIdentifier"==e){const e=this.tabletopObject.imageElement;if(e){"null"!=e.value&&(e.currentValue=t);const n=this.tabletopObject.imageDataElement.getElementsByName("shadowImageIdentifier");for(const e of n)this.tabletopObject.imageDataElement.removeChild(e)}}else if("faceIcon"===e){let n=this.tabletopObject.imageDataElement.getElementsByName(e);if(n.length>=this.MAX_IMAGE_ICON_COUNT){for(let e=this.MAX_IMAGE_ICON_COUNT;e<n.length;e++)this.deleteIcon(e);n[this.MAX_IMAGE_ICON_COUNT-1].value=t}else this.tabletopObject.imageDataElement.appendChild(hv.create(e,t,{type:"image"},e+My.generateUuid()));this.tabletopObject.currntIconIndex<0&&(this.tabletopObject.currntIconIndex=0)}else{let n=this.tabletopObject.imageDataElement.getFirstElementByName(e);if(!n)return;n.value=t}}),Uy.trigger("UPDATE_GAME_OBJECT",this.tabletopObject)}openModalAddImage(){this.modalService.open(ew).then(e=>{if(!this.tabletopObject||!this.tabletopObject.imageDataElement||!e)return;let t=this.tabletopObject.imageDataElement.getElementsByName("imageIdentifier");if(t.length>=this.MAX_IMAGE_ICON_COUNT){for(let e=this.MAX_IMAGE_ICON_COUNT;e<t.length;e++)this.deleteImage(e);t[this.MAX_IMAGE_ICON_COUNT-1].value=e}else this.tabletopObject.imageDataElement.appendChild(hv.create("imageIdentifier",e,{type:"image"},name+My.generateUuid()));this.tabletopObject.currntImageIndex<0&&(this.tabletopObject.currntImageIndex=0)})}openModalReplaceImage(e=!1){this.modalService.open(ew,{isAllowedEmpty:e}).then(e=>{this.tabletopObject&&this.tabletopObject.imageDataElement&&e&&("null"==e?this.tabletopObject.imageElement&&1==this.tabletopObject.imageFiles.length?(this.tabletopObject.imageElement.value=e,this.tabletopObject.imageElement.currentValue=e):this.deleteImage(this.tabletopObject.currntImageIndex):this.tabletopObject.imageElement&&(this.tabletopObject.imageElement.value=e))})}selectImage(e,t="imageIdentifier"){this.tabletopObject.currntImageIndex!=e&&(this.tabletopObject.currntImageIndex=e,q_.play(Y_.surprise),Uy.trigger("UPDATE_INVENTORY",null))}selectIcon(e){this.tabletopObject.currntIconIndex!=e&&(this.tabletopObject.currntIconIndex=e)}deleteImage(e=0,t="imageIdentifier"){if(!this.tabletopObject||!this.tabletopObject.imageDataElement)return;let n=this.tabletopObject.imageDataElement.getElementsByName(t);n&&0<n.length&&e<n.length&&(this.tabletopObject.currntImageIndex>=e&&(this.tabletopObject.currntImageIndex-=1),this.tabletopObject.currntImageIndex<0&&(this.tabletopObject.currntImageIndex=0),this.tabletopObject.imageDataElement.removeChild(n[e]))}deleteIcon(e=0){if(!this.tabletopObject||!this.tabletopObject.imageDataElement)return;let t=this.tabletopObject.imageDataElement.getElementsByName("faceIcon");t&&0<t.length&&e<t.length&&(this.tabletopObject.currntIconIndex>=e&&(this.tabletopObject.currntIconIndex-=1),this.tabletopObject.currntIconIndex<0&&(this.tabletopObject.currntIconIndex=0),this.tabletopObject.imageDataElement.removeChild(t[e]))}openMainImageModal(){var e;this.tabletopObject instanceof ow||(this.tabletopObject instanceof rw?this.openModal(this.tabletopObject.isVisible?"front":"back"):this.tabletopObject instanceof cw?this.openModal(this.tabletopObject.face):this.tabletopObject instanceof gv?this.openModalReplaceImage(this.tabletopObject.imageFiles.length>1||0<(null===(e=this.tabletopObject.imageFile)||void 0===e?void 0:e.url.length)):this.openModal("imageIdentifier",this.tabletopObject.imageFile&&this.tabletopObject.imageFile.url.length>0))}showChatPalette(){if(!(this.tabletopObject instanceof gv))return;let e=this.pointerDeviceService.pointers[0];this.panelService.open(Tw,{left:e.x-250,top:e.y-175,width:620,height:350}).character=this.tabletopObject}showStandSetting(){if(!(this.tabletopObject instanceof gv))return;let e=this.pointerDeviceService.pointers[0];this.panelService.open(Jw,{left:e.x-400,top:e.y-175,width:720,height:572}).character=this.tabletopObject}}return e.\u0275fac=function(t){return new(t||e)(So(_C),So(wv),So(xv),So(Kw))},e.\u0275cmp=Ze({type:e,selectors:[["game-character-sheet"]],inputs:{tabletopObject:"tabletopObject"},decls:19,vars:14,consts:[[3,"click"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[4,"ngIf"],["class","flex-container",4,"ngIf"],[1,"progress"],[3,"ngModel","change",4,"ngIf"],[3,"ngModel","change"],["value","table"],["value","common"],[3,"value"],["value","graveyard"],[1,"flex-container"],[1,"shadow-image",3,"src","alt","click"],["class","box main-image-box",4,"ngIf"],[1,"box","main-image-box"],[1,"icons-box"],[4,"ngFor","ngForOf"],[1,"image-showcase",2,"position","absolute","height","50px","top","300px"],["class","image-thumbnail","style","position: absolute;",3,"ngClass","left",4,"ngFor","ngForOf"],["style","position: relative; bottom: 30px; z-index: 700;",3,"left","click",4,"ngIf"],[1,"inverser",2,"display","inline-block",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"main-image",3,"src","alt","ngClass","dblclick"],["class","icon-image-box",3,"ngClass",4,"ngIf"],[1,"icon-image-box",3,"ngClass"],[3,"src","alt","click"],["class","button-delete-icon","title","\u9854IC\u524a\u9664",3,"click",4,"ngIf"],["title","\u9854IC\u524a\u9664",1,"button-delete-icon",3,"click"],[1,"material-icons",2,"font-size","1rem"],[1,"image-thumbnail",2,"position","absolute",3,"ngClass"],[2,"position","relative","bottom","30px","z-index","700",3,"click"],[1,"flex-item"],[1,"table"],["game-data-element","",1,"table-row",3,"gameDataElement","isTagLocked"],["style","text-align: right; margin-top: 3px;",4,"ngIf"],[2,"text-align","right","margin-top","3px"],[2,"font-size","11px","color","#444",3,"click"],["class","flex-item",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","isEdit"],[2,"width","100%","color","#555",3,"click"]],template:function(e,t){1&e&&(Io(0,"button",0),zo("click",function(){return t.toggleEditMode()}),ga(1,"\u7de8\u96c6\u5207\u308a\u66ff\u3048"),Mo(),Po(2,1),Eo(3,YC,1,0,"ng-container",2),Eo(4,qC,5,0,"ng-container",2),Eo(5,$C,1,0,"ng-container",2),Eo(6,XC,5,0,"ng-container",2),Eo(7,KC,3,1,"ng-container",2),Eo(8,QC,5,3,"ng-container",2),Eo(9,JC,3,0,"ng-container",3),Do(),Io(10,"button",0),zo("click",function(){return t.clone()}),ga(11,"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b"),Mo(),Io(12,"button",4),zo("click",function(){return t.saveToXML()}),Io(13,"div",5),Io(14,"div",6),ga(15,"\u4fdd\u5b58"),Mo(),Eo(16,ex,2,1,"div",7),Mo(),Mo(),Eo(17,nx,4,2,"ng-container",8),Eo(18,vx,7,9,"div",9)),2&e&&(Zr(2),To("ngSwitch",t.tabletopObject.aliasName),Zr(1),To("ngSwitchCase","numberResource"),Zr(1),To("ngSwitchCase","card"),Zr(1),To("ngSwitchCase","card-stack"),Zr(1),To("ngSwitchCase","terrain"),Zr(1),To("ngSwitchCase","dice-symbol"),Zr(1),To("ngSwitchCase","character"),Zr(4),To("disabled",t.isSaveing),Zr(2),To("ngClass",Ul(12,_x,t.isSaveing)),Zr(2),To("ngIf",t.isSaveing),Zr(1),To("ngIf","character"===t.tabletopObject.aliasName),Zr(1),To("ngIf",t.tabletopObject))},directives:[$h,Xh,Kh,Uh,Zh,Ld,sd,Sd,Bd,Vd,Vh,WC],pipes:[$_],styles:[".main-image-box[_ngcontent-%COMP%]{width:250px;height:250px;z-index:0}.main-image[_ngcontent-%COMP%]{width:250px;-o-object-position:center bottom;object-position:center bottom}.image-showcase[_ngcontent-%COMP%]{vertical-align:top;text-align:left;position:absolute;display:inline-block}.image-showcase[_ngcontent-%COMP%], .image-thumbnail[_ngcontent-%COMP%]{vertical-align:bottom;transform-origin:center bottom}.image-thumbnail[_ngcontent-%COMP%]{color:#000;filter:drop-shadow(1px 1px 0 rgb(255,244,232)) drop-shadow(-1px 1px 0 rgb(255,244,232)) drop-shadow(-1px -1px 0 rgb(255,244,232)) drop-shadow(1px -1px 0 rgb(255,244,232));z-index:100;transition:all 132ms ease-in-out}.image-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;max-height:100px;position:absolute;left:0;right:0;bottom:0;margin:auto;-o-object-fit:contain;object-fit:contain;-o-object-position:center bottom;object-position:center bottom;transform-origin:center bottom}.image-thumbnail[_ngcontent-%COMP%]:hover{z-index:600}.image-thumbnail[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{width:75px;max-height:150px;left:-12px;transition:all 132ms ease-in-out}.image-thumbnail.hide[_ngcontent-%COMP%]{transform:scale3d(0,0,0)}.icons-box[_ngcontent-%COMP%]{vertical-align:top;text-align:center;position:absolute;left:216px;z-index:2}.icon-image-box[_ngcontent-%COMP%]{position:relative;width:50px;height:50px;max-width:50px;max-height:50px;border-radius:.5rem;color:#000;filter:drop-shadow(1px 1px 0 rgb(255,244,232)) drop-shadow(-1px 1px 0 rgb(255,244,232)) drop-shadow(-1px -1px 0 rgb(255,244,232)) drop-shadow(1px -1px 0 rgb(255,244,232));z-index:100;margin-top:1px;margin-left:-3px}.icon-image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0;object-position:50% 0;border-radius:.5rem;border:2px solid transparent}.icon-image-box[_ngcontent-%COMP%]:hover{z-index:600}.icon-image-box[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{border:2px dotted red}.icon-image-box.current-icon[_ngcontent-%COMP%]{z-index:500}.icon-image-box.current-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid red}.icon-image-box[_ngcontent-%COMP%]:not(.current-icon){z-index:400}.shadow-image[_ngcontent-%COMP%]{position:absolute;width:50px;filter:brightness(0) blur(1px);opacity:.7;margin-top:2px;margin-left:5px}.table[_ngcontent-%COMP%]{display:table;width:100%}.table[_ngcontent-%COMP%], .table-row[_ngcontent-%COMP%]{box-sizing:border-box}.table-row[_ngcontent-%COMP%]{display:table-row}.table-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:table-cell;border:1px solid #fff;vertical-align:top}.box[_ngcontent-%COMP%], .table-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{box-sizing:border-box}.box[_ngcontent-%COMP%]{display:inline-block;margin:5px}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px 0;padding:10px;flex:1 0 auto;box-sizing:border-box;min-width:25px;background-color:rgba(234,201,157,.8);background-color:rgba(240,218,189,.8);color:#444;z-index:1}.flex-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{color:#ccc}.button-delete-icon[_ngcontent-%COMP%]{display:inline-block;position:absolute;margin:0;padding:2px 0 0;background-color:transparent;right:-3px;top:1px;height:18px;width:18px;font-size:8px;color:red}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms ease 0s}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #fff)}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;font-size:.9em}"],data:{animation:[Jd("switchImage",[sp(":increment, :decrement",[ep("200ms ease",rp([np({transform:"scale3d(0, 0, 0)"}),np({transform:"scale3d(0, 1.2, 1.2)"}),np({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),Jd("showcase",[sp(":increment, :decrement",[ep("200ms 200ms ease-in",rp([np({transform:"scale3d(0, 1.0, 1.0)"}),np({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),Jd("showcaseItem",[sp(":enter",[ep("200ms ease",rp([np({transform:"scale3d(0, 0, 0)"}),np({transform:"scale3d(1.0, 1.0, 1.0)"})]))]),sp(":leave",[ep("200ms ease",rp([np({transform:"scale3d(1.0, 1.0, 1.0)"}),np({transform:"scale3d(0, 0, 0)"})]))])]),Jd("bounceInOut",[sp("void => *",[ep("600ms ease",rp([np({transform:"scale3d(0, 0, 0)",offset:0}),np({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),np({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),np({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),np({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),sp("* => void",[ep(100,np({transform:"scale3d(0, 0, 0)"}))])])]}}),e})();const Cx=function(){return{standalone:!0}};let xx=(()=>{class e{constructor(e,t){this.panelService=e,this.modalService=t,this.password="",this.help="",this.targetPeerContext=null,this.title="",this.targetPeerContext=Lg.parse(t.option.peerId?t.option.peerId:"???"),this.title=t.option.title?t.option.title:""}get peerId(){return Hy.peerId}get isConnected(){return!(Hy.peerIds.length<=1)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title=`\u30d1\u30b9\u30ef\u30fc\u30c9\u3008${this.title}\u3009`),Uy.register(this)}ngOnDestroy(){Uy.unregister(this)}onInputChange(e){this.help=""}submit(){this.targetPeerContext.verifyPassword(this.password)&&this.modalService.resolve(this.password),this.help="\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u9055\u3044\u307e\u3059"}}return e.\u0275fac=function(t){return new(t||e)(So(wv),So(xv))},e.\u0275cmp=Ze({type:e,selectors:[["password-check"]],decls:10,vars:4,consts:[["passwordForm","ngForm"],["placeholder","\u30d1\u30b9\u30ef\u30fc\u30c9",3,"ngModel","ngModelOptions","ngModelChange","input"],["type","submit",3,"click"],[2,"font-size","12px"]],template:function(e,t){1&e&&(Io(0,"form",null,0),Io(2,"div"),ga(3,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),Io(4,"input",1),zo("ngModelChange",function(e){return t.password=e})("input",function(e){return t.onInputChange(e.target.value)}),Mo(),Mo(),Io(5,"button",2),zo("click",function(){return t.submit()}),ga(6,"\u5165\u5ba4"),Mo(),Mo(),Io(7,"div"),Io(8,"span",3),ga(9),Mo(),Mo()),2&e&&(Zr(4),To("ngModel",t.password)("ngModelOptions",jl(3,Cx)),Zr(5),ma(t.help))},directives:[Td,od,xd,ju,sd,Sd],styles:[".box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:50%;background-repeat:no-repeat;background-size:contain}"]}),e})();function Ex(e,t){if(1&e&&(Io(0,"div"),Io(1,"div",9),ga(2," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),Mo(),Io(3,"div",9),ga(4," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),Mo(),Io(5,"div",9),ga(6," \u30eb\u30fc\u30e0\u540d\u524d\u306e\u9577\u3055\u306f128\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),Mo(),Mo()),2&e){jo();const e=ko(4);Zr(1),To("hidden",!e.errors.required),Zr(2),To("hidden",!e.errors.minlength),Zr(2),To("hidden",!e.errors.maxlength)}}function kx(e,t){if(1&e&&(Io(0,"div"),Io(1,"div",9),ga(2," \u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u306f12\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),Mo(),Mo()),2&e){jo();const e=ko(8);Zr(1),To("hidden",!e.errors.maxlength)}}function Sx(e,t){1&e&&(Io(0,"div"),ga(1," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5408\u8a08\u304c\u9577\u3059\u304e\u308b\u3088\u3046\u3067\u3059\u3002\u3069\u3061\u3089\u304b\u3092\u5c11\u3057\u77ed\u304f\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002 "),Mo())}function Tx(e,t){if(1&e){const e=Fo();Io(0,"div"),Io(1,"div"),ga(2,"\u30eb\u30fc\u30e0\u540d : "),Io(3,"input",3,4),zo("input",function(t){Ft(e);const n=jo();return n.calcPeerId(t.target.value,n.password)})("ngModelChange",function(t){return Ft(e),jo().roomName=t}),Mo(),Mo(),Io(5,"div"),ga(6,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),Io(7,"input",5,6),zo("input",function(t){Ft(e);const n=jo();return n.calcPeerId(n.roomName,t.target.value)})("ngModelChange",function(t){return Ft(e),jo().password=t}),Mo(),Mo(),Ao(9,"hr"),Eo(10,Ex,7,3,"div",7),Eo(11,kx,3,1,"div",7),Eo(12,Sx,2,0,"div",7),Io(13,"div"),Io(14,"button",8),zo("click",function(){return Ft(e),jo().createRoom()}),ga(15,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210"),Mo(),Mo(),Mo()}if(2&e){const e=ko(4),t=ko(8),n=jo();Zr(3),To("ngModel",n.roomName),Zr(4),To("ngModel",n.password),Zr(3),To("ngIf",e.errors&&(e.dirty||e.touched)),Zr(1),To("ngIf",t.errors&&(t.dirty||t.touched)),Zr(1),To("ngIf",!n.validateLength),Zr(2),To("disabled",!e.valid||!t.valid||!n.validateLength)}}function Ox(e,t){1&e&&(Io(0,"span",1),ga(1,"\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u63a5\u7d9a\u3057\u305f\u307e\u307e\u3067\u306f\u30eb\u30fc\u30e0\u4f5c\u6210\u3092\u884c\u3048\u307e\u305b\u3093\u3002"),Ao(2,"br"),ga(3,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),Ao(4,"br"),ga(5,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),Mo())}let Ix=(()=>{class e{constructor(e,t){this.panelService=e,this.modalService=t,this.peers=[],this.isReloading=!1,this.roomName="\u3075\u3064\u3046\u306e\u90e8\u5c4b",this.password="",this.isPrivate=!1,this.validateLength=!1}get peerId(){return Hy.peerId}get isConnected(){return!(Hy.peerIds.length<=1)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30eb\u30fc\u30e0\u4f5c\u6210"),Uy.register(this),this.calcPeerId(this.roomName,this.password)}ngOnDestroy(){Uy.unregister(this)}calcPeerId(e,t){let n=Hy.peerContext?Hy.peerContext.userId:Lg.generateId(),i=Lg.create(n,Lg.generateId("***"),e,t);this.validateLength=i.peerId.length<64}createRoom(){let e=Hy.peerContext?Hy.peerContext.userId:Lg.generateId();Hy.open(e,Lg.generateId("***"),this.roomName,this.password),av.myCursor.peerId=Hy.peerId,this.modalService.resolve()}}return e.\u0275fac=function(t){return new(t||e)(So(wv),So(xv))},e.\u0275cmp=Ze({type:e,selectors:[["room-setting"]],decls:6,vars:2,consts:[[4,"ngIf","ngIfElse"],[2,"font-size","12px"],["other_content",""],["required","","minlength","1","maxlength","128","placeholder","\u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808",1,"input",3,"ngModel","input","ngModelChange"],["roomNameValidation","ngModel"],["maxlength","12","placeholder","\u7a7a\u306a\u3089\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u3057",1,"input",3,"ngModel","input","ngModelChange"],["passwordValidation","ngModel"],[4,"ngIf"],[3,"disabled","click"],[3,"hidden"]],template:function(e,t){if(1&e&&(Eo(0,Tx,16,6,"div",0),Io(1,"div"),Io(2,"span",1),ga(3,"\u203b\u4f5c\u6210\u3057\u305f\u30eb\u30fc\u30e0\u306f\u53c2\u52a0\u8005\u304c0\u4eba\u306b\u306a\u3063\u305f\u6642\u70b9\u3067\u89e3\u6563\u3057\u307e\u3059\u3002\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),Mo(),Mo(),Eo(4,Ox,6,0,"ng-template",null,2,dc)),2&e){const e=ko(5);To("ngIf",!t.isConnected)("ngIfElse",e)}},directives:[Zh,ju,Zd,Yd,$d,sd,Sd],styles:[".box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:50%;background-repeat:no-repeat;background-size:contain}.input[_ngcontent-%COMP%]{width:100%}"]}),e})();function Mx(e,t){1&e&&(Io(0,"td"),Io(1,"i",11),ga(2,"lock"),Mo(),Mo())}function Ax(e,t){1&e&&(Io(0,"td"),ga(1,"-"),Mo())}function Px(e,t){if(1&e){const e=Fo();Io(0,"button",12),zo("click",function(){Ft(e);const t=jo().$implicit;return jo(3).connect(t.peerContexts)}),ga(1,"\u63a5\u7d9a"),Mo()}if(2&e){const e=jo().$implicit,t=jo(3);To("disabled",(null==e.peerContexts[0]?null:e.peerContexts[0].roomId)===t.currentRoom)}}function Dx(e,t){if(1&e&&(Po(0),Io(1,"tr"),Io(2,"td",9),ga(3),Mo(),Io(4,"td",7),ga(5),Mo(),Eo(6,Mx,3,0,"td",4),Eo(7,Ax,2,0,"td",4),Io(8,"td"),ga(9),Mo(),Io(10,"td"),Eo(11,Px,2,1,"button",10),Mo(),Mo(),Do()),2&e){const e=t.$implicit;Zr(3),ma(null==e.peerContexts[0]?null:e.peerContexts[0].roomId),Zr(2),ma(e.roomName),Zr(1),To("ngIf",e.peerContexts[0].hasPassword),Zr(1),To("ngIf",!e.peerContexts[0].hasPassword),Zr(2),ba("",e.peerContexts.length,"\u4eba"),Zr(2),To("ngIf",0<e.alias.length)}}function Rx(e,t){if(1&e&&(Po(0),Io(1,"table",6),Io(2,"tr"),Io(3,"th"),ga(4,"\u30eb\u30fc\u30e0ID"),Mo(),Io(5,"th",7),ga(6,"\u30eb\u30fc\u30e0\u540d"),Mo(),Io(7,"th"),ga(8,"\u30d1\u30b9\u30ef\u30fc\u30c9"),Mo(),Io(9,"th"),ga(10,"\u53c2\u52a0\u8005"),Mo(),Ao(11,"th"),Mo(),Eo(12,Dx,12,6,"ng-container",8),Mo(),Do()),2&e){const e=jo(2);Zr(12),To("ngForOf",e.rooms)}}function Fx(e,t){if(1&e&&(Io(0,"span",13),ga(1),Mo()),2&e){const e=jo(2);Zr(1),ma(e.help)}}function Nx(e,t){if(1&e){const e=Fo();Io(0,"div"),Io(1,"button",2),zo("click",function(){return Ft(e),jo().reload()}),ga(2,"\u4e00\u89a7\u3092\u66f4\u65b0"),Mo(),Io(3,"button",3),zo("click",function(){return Ft(e),jo().showRoomSetting()}),ga(4,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b"),Mo(),Ao(5,"hr"),Eo(6,Rx,13,1,"ng-container",4),Eo(7,Fx,2,1,"span",5),Mo()}if(2&e){const e=jo();Zr(1),To("disabled",e.isReloading),Zr(5),To("ngIf",e.rooms.length),Zr(1),To("ngIf",e.rooms.length<1)}}function zx(e,t){1&e&&(Io(0,"span",13),ga(1,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),Ao(2,"br"),ga(3,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),Mo())}let Lx=(()=>{class e{constructor(e,t){this.panelService=e,this.modalService=t,this.rooms=[],this.isReloading=!1,this.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"}get currentRoom(){return Hy.peerContext.roomId}get peerId(){return Hy.peerId}get isConnected(){return!(Hy.peerIds.length<=1)}ngOnInit(){Promise.resolve().then(()=>this.changeTitle()),Uy.register(this).on("OPEN_NETWORK",e=>{this.changeTitle()}).on("CONNECT_PEER",e=>{this.changeTitle()}),this.reload()}changeTitle(){this.modalService.title=this.panelService.title="\u30ed\u30d3\u30fc",Hy.peerContext.roomName.length&&(this.modalService.title=this.panelService.title="\u3008"+Hy.peerContext.roomName+"/"+Hy.peerContext.roomId+"\u3009")}ngOnDestroy(){Uy.unregister(this)}reload(){return xg(this,void 0,void 0,function*(){this.isReloading=!0,this.help="\u691c\u7d22\u4e2d...",this.rooms=[];let e={},t=yield Hy.listAllPeers();for(let n of t){let t=Lg.parse(n);if(t.isRoom){let n=t.roomId+t.roomName;n in e||(e[n]=[]),e[n].push(t)}}for(let n in e)this.rooms.push({alias:n,roomName:e[n][0].roomName,peerContexts:e[n]});this.rooms.sort((e,t)=>e.alias<t.alias?-1:e.alias>t.alias?1:0),this.help="\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u300c\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b\u300d\u3067\u65b0\u898f\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002",this.isReloading=!1})}connect(e){return xg(this,void 0,void 0,function*(){let t=e[0],n="";if(t.hasPassword&&(n=yield this.modalService.open(xx,{peerId:t.peerId,title:`${t.roomName}/${t.roomId}`}),null==n&&(n="")),!t.verifyPassword(n))return;let i=Hy.peerContext?Hy.peerContext.userId:Lg.generateId();Hy.open(i,t.roomId,t.roomName,n),av.myCursor.peerId=Hy.peerId;let r=[];Uy.register(r).on("OPEN_NETWORK",t=>{console.log("LobbyComponent OPEN_PEER",t.data.peerId),Uy.unregister(r),Vy.instance.clearDeleteHistory();for(let n of e)Hy.connect(n.peerId);Uy.register(r).on("CONNECT_PEER",t=>{console.log("\u63a5\u7d9a\u6210\u529f\uff01",t.data.peerId),r.push(t.data.peerId),console.log("\u63a5\u7d9a\u6210\u529f "+r.length+"/"+e.length),e.length<=r.length&&(this.resetNetwork(),Uy.unregister(r))}).on("DISCONNECT_PEER",t=>{console.warn("\u63a5\u7d9a\u5931\u6557",t.data.peerId),r.push(t.data.peerId),console.warn("\u63a5\u7d9a\u5931\u6557 "+r.length+"/"+e.length),e.length<=r.length&&(this.resetNetwork(),Uy.unregister(r))})})})}resetNetwork(){Hy.peerContexts.length<1&&(Hy.open(),av.myCursor.peerId=Hy.peerId)}showRoomSetting(){return xg(this,void 0,void 0,function*(){yield this.modalService.open(Ix,{width:700,height:400,left:0,top:400}),this.reload(),this.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"})}}return e.\u0275fac=function(t){return new(t||e)(So(wv),So(xv))},e.\u0275cmp=Ze({type:e,selectors:[["lobby"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["other_content",""],[3,"disabled","click"],[3,"click"],[4,"ngIf"],["style","font-size: 12px;",4,"ngIf"],[1,"room-list"],[1,"room-name"],[4,"ngFor","ngForOf"],[1,"is-small-font"],["type","submit",3,"disabled","click",4,"ngIf"],[1,"material-icons",2,"vertical-align","middle","font-size","0.9rem"],["type","submit",3,"disabled","click"],[2,"font-size","12px"]],template:function(e,t){if(1&e&&(Eo(0,Nx,8,3,"div",0),Eo(1,zx,4,0,"ng-template",null,1,dc)),2&e){const e=ko(2);To("ngIf",!t.isConnected)("ngIfElse",e)}},directives:[Zh,Vh],styles:[".box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:50%;background-repeat:no-repeat;background-size:contain}.room-list[_ngcontent-%COMP%]{font-size:12px;border:0;border-spacing:0;padding:0;width:100%;max-width:100%;white-space:nowrap}.room-list[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:1px .5em;text-align:center}.room-name[_ngcontent-%COMP%]{white-space:normal;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;min-width:50%}.is-small-font[_ngcontent-%COMP%]{font-size:10px}"]}),e})(),Bx=(()=>{class e{constructor(){this.queue=new iv("DatabaseQueue"),this.openDB(e.DB_NAME,e.VERSION)}openDB(e,t){return this.queue.add((n,i)=>{console.log("openDB");let r=indexedDB.open(e,t);r.onerror=i=>{console.error(r.error,i),"VersionError"===r.error.name&&(indexedDB.deleteDatabase(e),this.openDB(e,t)),n()},r.onblocked=e=>{console.warn("openDB onblocked"),alert("\u3053\u306e\u30b5\u30a4\u30c8\u3092\u958b\u3044\u3066\u3044\u308b\u4ed6\u306e\u30bf\u30d6\u3092\u3059\u3079\u3066\u9589\u3058\u3066\u304f\u3060\u3055\u3044!")},r.onupgradeneeded=e=>{console.log("openDB onupgradeneeded"),this.initializeDB(r.result),this.createStores()},r.onsuccess=e=>{console.log("openDB onsuccess"),this.initializeDB(r.result),n()}})}createStores(){console.log("createStores"),this.db.objectStoreNames.contains("PeerHistory")&&this.db.deleteObjectStore("PeerHistory");let e=this.db.createObjectStore("PeerHistory",{keyPath:"peerId"});e.createIndex("timestamp","timestamp",{unique:!1}),e.transaction.oncomplete=e=>{console.log("createStores oncomplete")}}initializeDB(e){console.log("initializeDB"),e.onversionchange=t=>{console.warn("db.onversionchange."),e.close(),alert("\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u30da\u30fc\u30b8\u304c\u4f7f\u7528\u53ef\u80fd\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u518d\u8aad\u307f\u8fbc\u307f\u3057\u3066\u304f\u3060\u3055\u3044!")},e.onabort=e=>{console.error(e)},e.onerror=e=>{console.error(e)},this.db=e}addPeerHistory(e,t){this.queue.add((n,i)=>{console.log("addPeerHistory");let r=this.db.transaction(["PeerHistory"],"readwrite"),s=r.objectStore("PeerHistory");r.oncomplete=e=>{console.log("addPeerHistory done.","readwrite"),n()},r.onerror=e=>{console.error(e),n()};let o={peerId:e,timestamp:Date.now(),history:t};s.put(o)})}deletePeerHistory(e){this.queue.add((t,n)=>{let i=this.db.transaction(["PeerHistory"],"readwrite"),r=i.objectStore("PeerHistory");i.oncomplete=e=>{console.log("addPeerHistory done.","readwrite"),t()},i.onerror=e=>{console.error(e),t()},r.delete(e)})}getPeerHistory(){return this.queue.add((e,t)=>{console.log("getPeerHistory");let n=this.db.transaction(["PeerHistory"],"readonly"),i=n.objectStore("PeerHistory").openCursor(),r=[];n.oncomplete=t=>{console.log("getPeerHistory done."),e(r)},n.onerror=t=>{console.error(t),e(r)},i.onerror=t=>{console.error(t),e(r)},i.onsuccess=e=>{let t=i.result;t?(console.log("id:"+t.key+" value:",t.value),r.push(t.value),t.continue()):console.log("Entries all displayed.")}})}}return e.DB_NAME="UdonariumDataBase",e.VERSION=1,e})();var jx=function(e,t){var n,i="";for(n=0;n<t;n+=1)i+=e;return i},Ux=function(e){return 0===e&&Number.NEGATIVE_INFINITY===1/e};function Hx(e,t){var n="",i=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+="\n\n"+e.mark.snippet),i+" "+n):i}function Vx(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=Hx(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}(Vx.prototype=Object.create(Error.prototype)).constructor=Vx,Vx.prototype.toString=function(e){return this.name+": "+Hx(this,e)};var Gx=Vx;function Zx(e,t,n,i,r){var s="",o="",a=Math.floor(r/2)-1;return i-t>a&&(t=i-a+(s=" ... ").length),n-i>a&&(n=i+a-(o=" ...").length),{str:s+e.slice(t,n).replace(/\t/g,"\u2192")+o,pos:i-t+s.length}}function Wx(e,t){return jx(" ",t-e.length)+e}var Yx=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],qx=["scalar","sequence","mapping"],$x=function(e,t){var n,i;if(t=t||{},Object.keys(t).forEach(function(t){if(-1===Yx.indexOf(t))throw new Gx('Unknown option "'+t+'" is met in definition of "'+e+'" YAML type.')}),this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(e){return e},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=(i={},null!==(n=t.styleAliases||null)&&Object.keys(n).forEach(function(e){n[e].forEach(function(t){i[String(t)]=e})}),i),-1===qx.indexOf(this.kind))throw new Gx('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')};function Xx(e,t,n){var i=[];return e[t].forEach(function(e){n.forEach(function(t,n){t.tag===e.tag&&t.kind===e.kind&&t.multi===e.multi&&i.push(n)}),n.push(e)}),n.filter(function(e,t){return-1===i.indexOf(t)})}function Kx(e){return this.extend(e)}Kx.prototype.extend=function(e){var t=[],n=[];if(e instanceof $x)n.push(e);else if(Array.isArray(e))n=n.concat(e);else{if(!e||!Array.isArray(e.implicit)&&!Array.isArray(e.explicit))throw new Gx("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");e.implicit&&(t=t.concat(e.implicit)),e.explicit&&(n=n.concat(e.explicit))}t.forEach(function(e){if(!(e instanceof $x))throw new Gx("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(e.loadKind&&"scalar"!==e.loadKind)throw new Gx("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(e.multi)throw new Gx("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),n.forEach(function(e){if(!(e instanceof $x))throw new Gx("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var i=Object.create(Kx.prototype);return i.implicit=(this.implicit||[]).concat(t),i.explicit=(this.explicit||[]).concat(n),i.compiledImplicit=Xx(i,"implicit",[]),i.compiledExplicit=Xx(i,"explicit",[]),i.compiledTypeMap=function(){var e,t,n={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function i(e){e.multi?(n.multi[e.kind].push(e),n.multi.fallback.push(e)):n[e.kind][e.tag]=n.fallback[e.tag]=e}for(e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(i);return n}(i.compiledImplicit,i.compiledExplicit),i};var Qx=new Kx({explicit:[new $x("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return null!==e?e:""}}),new $x("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return null!==e?e:[]}}),new $x("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return null!==e?e:{}}})]}),Jx=new $x("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(e){if(null===e)return!0;var t=e.length;return 1===t&&"~"===e||4===t&&("null"===e||"Null"===e||"NULL"===e)},construct:function(){return null},predicate:function(e){return null===e},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"}),eE=new $x("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t=e.length;return 4===t&&("true"===e||"True"===e||"TRUE"===e)||5===t&&("false"===e||"False"===e||"FALSE"===e)},construct:function(e){return"true"===e||"True"===e||"TRUE"===e},predicate:function(e){return"[object Boolean]"===Object.prototype.toString.call(e)},represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function tE(e){return 48<=e&&e<=55}function nE(e){return 48<=e&&e<=57}var iE=new $x("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n,i=e.length,r=0,s=!1;if(!i)return!1;if("-"!==(t=e[r])&&"+"!==t||(t=e[++r]),"0"===t){if(r+1===i)return!0;if("b"===(t=e[++r])){for(r++;r<i;r++)if("_"!==(t=e[r])){if("0"!==t&&"1"!==t)return!1;s=!0}return s&&"_"!==t}if("x"===t){for(r++;r<i;r++)if("_"!==(t=e[r])){if(!(48<=(n=e.charCodeAt(r))&&n<=57||65<=n&&n<=70||97<=n&&n<=102))return!1;s=!0}return s&&"_"!==t}if("o"===t){for(r++;r<i;r++)if("_"!==(t=e[r])){if(!tE(e.charCodeAt(r)))return!1;s=!0}return s&&"_"!==t}}if("_"===t)return!1;for(;r<i;r++)if("_"!==(t=e[r])){if(!nE(e.charCodeAt(r)))return!1;s=!0}return!(!s||"_"===t)},construct:function(e){var t,n=e,i=1;if(-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),"-"!==(t=n[0])&&"+"!==t||("-"===t&&(i=-1),t=(n=n.slice(1))[0]),"0"===n)return 0;if("0"===t){if("b"===n[1])return i*parseInt(n.slice(2),2);if("x"===n[1])return i*parseInt(n.slice(2),16);if("o"===n[1])return i*parseInt(n.slice(2),8)}return i*parseInt(n,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&e%1==0&&!Ux(e)},represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),rE=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),sE=/^[-+]?[0-9]+e/,oE=new $x("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(e){return null!==e&&!(!rE.test(e)||"_"===e[e.length-1])},construct:function(e){var t,n;return n="-"===(t=e.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),".inf"===t?1===n?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===t?NaN:n*parseFloat(t,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&(e%1!=0||Ux(e))},represent:function(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(Ux(e))return"-0.0";return n=e.toString(10),sE.test(n)?n.replace("e",".e"):n},defaultStyle:"lowercase"}),aE=Qx.extend({implicit:[Jx,eE,iE,oE]}),lE=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),cE=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$"),hE=new $x("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(e){return null!==e&&(null!==lE.exec(e)||null!==cE.exec(e))},construct:function(e){var t,n,i,r,s,o,a,l,c=0,h=null;if(null===(t=lE.exec(e))&&(t=cE.exec(e)),null===t)throw new Error("Date resolve error");if(n=+t[1],i=+t[2]-1,r=+t[3],!t[4])return new Date(Date.UTC(n,i,r));if(s=+t[4],o=+t[5],a=+t[6],t[7]){for(c=t[7].slice(0,3);c.length<3;)c+="0";c=+c}return t[9]&&(h=6e4*(60*+t[10]+ +(t[11]||0)),"-"===t[9]&&(h=-h)),l=new Date(Date.UTC(n,i,r,s,o,a,c)),h&&l.setTime(l.getTime()-h),l},instanceOf:Date,represent:function(e){return e.toISOString()}}),uE=new $x("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(e){return"<<"===e||null===e}}),dE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r",pE=new $x("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n,i=0,r=e.length,s=dE;for(n=0;n<r;n++)if(!((t=s.indexOf(e.charAt(n)))>64)){if(t<0)return!1;i+=6}return i%8==0},construct:function(e){var t,n,i=e.replace(/[\r\n=]/g,""),r=i.length,s=dE,o=0,a=[];for(t=0;t<r;t++)t%4==0&&t&&(a.push(o>>16&255),a.push(o>>8&255),a.push(255&o)),o=o<<6|s.indexOf(i.charAt(t));return 0==(n=r%4*6)?(a.push(o>>16&255),a.push(o>>8&255),a.push(255&o)):18===n?(a.push(o>>10&255),a.push(o>>2&255)):12===n&&a.push(o>>4&255),new Uint8Array(a)},predicate:function(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)},represent:function(e){var t,n,i="",r=0,s=e.length,o=dE;for(t=0;t<s;t++)t%3==0&&t&&(i+=o[r>>18&63],i+=o[r>>12&63],i+=o[r>>6&63],i+=o[63&r]),r=(r<<8)+e[t];return 0==(n=s%3)?(i+=o[r>>18&63],i+=o[r>>12&63],i+=o[r>>6&63],i+=o[63&r]):2===n?(i+=o[r>>10&63],i+=o[r>>4&63],i+=o[r<<2&63],i+=o[64]):1===n&&(i+=o[r>>2&63],i+=o[r<<4&63],i+=o[64],i+=o[64]),i}}),fE=Object.prototype.hasOwnProperty,gE=Object.prototype.toString,mE=new $x("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,i,r,s,o=[],a=e;for(t=0,n=a.length;t<n;t+=1){if(s=!1,"[object Object]"!==gE.call(i=a[t]))return!1;for(r in i)if(fE.call(i,r)){if(s)return!1;s=!0}if(!s)return!1;if(-1!==o.indexOf(r))return!1;o.push(r)}return!0},construct:function(e){return null!==e?e:[]}}),bE=Object.prototype.toString,yE=new $x("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,i,r,s,o=e;for(s=new Array(o.length),t=0,n=o.length;t<n;t+=1){if("[object Object]"!==bE.call(i=o[t]))return!1;if(1!==(r=Object.keys(i)).length)return!1;s[t]=[r[0],i[r[0]]]}return!0},construct:function(e){if(null===e)return[];var t,n,i,r,s,o=e;for(s=new Array(o.length),t=0,n=o.length;t<n;t+=1)i=o[t],r=Object.keys(i),s[t]=[r[0],i[r[0]]];return s}}),vE=Object.prototype.hasOwnProperty,_E=new $x("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(e){if(null===e)return!0;var t,n=e;for(t in n)if(vE.call(n,t)&&null!==n[t])return!1;return!0},construct:function(e){return null!==e?e:{}}}),wE=aE.extend({implicit:[hE,uE],explicit:[pE,mE,yE,_E]}),CE=Object.prototype.hasOwnProperty,xE=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,EE=/[\x85\u2028\u2029]/,kE=/[,\[\]\{\}]/,SE=/^(?:!|!!|![a-z\-]+!)$/i,TE=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function OE(e){return Object.prototype.toString.call(e)}function IE(e){return 10===e||13===e}function ME(e){return 9===e||32===e}function AE(e){return 9===e||32===e||10===e||13===e}function PE(e){return 44===e||91===e||93===e||123===e||125===e}function DE(e){var t;return 48<=e&&e<=57?e-48:97<=(t=32|e)&&t<=102?t-97+10:-1}function RE(e){return 48===e?"\0":97===e?"\x07":98===e?"\b":116===e||9===e?"\t":110===e?"\n":118===e?"\v":102===e?"\f":114===e?"\r":101===e?"\x1b":32===e?" ":34===e?'"':47===e?"/":92===e?"\\":78===e?"\x85":95===e?"\xa0":76===e?"\u2028":80===e?"\u2029":""}function FE(e){return e<=65535?String.fromCharCode(e):String.fromCharCode(55296+(e-65536>>10),56320+(e-65536&1023))}for(var NE=new Array(256),zE=new Array(256),LE=0;LE<256;LE++)NE[LE]=RE(LE)?1:0,zE[LE]=RE(LE);function BE(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||wE,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function jE(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=function(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),"number"!=typeof t.indent&&(t.indent=1),"number"!=typeof t.linesBefore&&(t.linesBefore=3),"number"!=typeof t.linesAfter&&(t.linesAfter=2);for(var n,i=/\r?\n|\r|\0/g,r=[0],s=[],o=-1;n=i.exec(e.buffer);)s.push(n.index),r.push(n.index+n[0].length),e.position<=n.index&&o<0&&(o=r.length-2);o<0&&(o=r.length-1);var a,l,c="",h=Math.min(e.line+t.linesAfter,s.length).toString().length,u=t.maxLength-(t.indent+h+3);for(a=1;a<=t.linesBefore&&!(o-a<0);a++)l=Zx(e.buffer,r[o-a],s[o-a],e.position-(r[o]-r[o-a]),u),c=jx(" ",t.indent)+Wx((e.line-a+1).toString(),h)+" | "+l.str+"\n"+c;for(l=Zx(e.buffer,r[o],s[o],e.position,u),c+=jx(" ",t.indent)+Wx((e.line+1).toString(),h)+" | "+l.str+"\n",c+=jx("-",t.indent+h+3+l.pos)+"^\n",a=1;a<=t.linesAfter&&!(o+a>=s.length);a++)l=Zx(e.buffer,r[o+a],s[o+a],e.position-(r[o]-r[o+a]),u),c+=jx(" ",t.indent)+Wx((e.line+a+1).toString(),h)+" | "+l.str+"\n";return c.replace(/\n$/,"")}(n),new Gx(t,n)}function UE(e,t){throw jE(e,t)}function HE(e,t){e.onWarning&&e.onWarning.call(null,jE(e,t))}var VE={YAML:function(e,t,n){var i,r,s;null!==e.version&&UE(e,"duplication of %YAML directive"),1!==n.length&&UE(e,"YAML directive accepts exactly one argument"),null===(i=/^([0-9]+)\.([0-9]+)$/.exec(n[0]))&&UE(e,"ill-formed argument of the YAML directive"),r=parseInt(i[1],10),s=parseInt(i[2],10),1!==r&&UE(e,"unacceptable YAML version of the document"),e.version=n[0],e.checkLineBreaks=s<2,1!==s&&2!==s&&HE(e,"unsupported YAML version of the document")},TAG:function(e,t,n){var i,r;2!==n.length&&UE(e,"TAG directive accepts exactly two arguments"),r=n[1],SE.test(i=n[0])||UE(e,"ill-formed tag handle (first argument) of the TAG directive"),CE.call(e.tagMap,i)&&UE(e,'there is a previously declared suffix for "'+i+'" tag handle'),TE.test(r)||UE(e,"ill-formed tag prefix (second argument) of the TAG directive");try{r=decodeURIComponent(r)}catch(s){UE(e,"tag prefix is malformed: "+r)}e.tagMap[i]=r}};function GE(e,t,n,i){var r,s,o,a;if(t<n){if(a=e.input.slice(t,n),i)for(r=0,s=a.length;r<s;r+=1)9===(o=a.charCodeAt(r))||32<=o&&o<=1114111||UE(e,"expected valid JSON character");else xE.test(a)&&UE(e,"the stream contains non-printable characters");e.result+=a}}function ZE(e,t,n,i){var r,s,o,a,l;for("object"==typeof(l=n)&&null!==l||UE(e,"cannot merge mappings; the provided source object is unacceptable"),o=0,a=(r=Object.keys(n)).length;o<a;o+=1)CE.call(t,s=r[o])||(t[s]=n[s],i[s]=!0)}function WE(e,t,n,i,r,s,o,a,l){var c,h;if(Array.isArray(r))for(c=0,h=(r=Array.prototype.slice.call(r)).length;c<h;c+=1)Array.isArray(r[c])&&UE(e,"nested arrays are not supported inside keys"),"object"==typeof r&&"[object Object]"===OE(r[c])&&(r[c]="[object Object]");if("object"==typeof r&&"[object Object]"===OE(r)&&(r="[object Object]"),r=String(r),null===t&&(t={}),"tag:yaml.org,2002:merge"===i)if(Array.isArray(s))for(c=0,h=s.length;c<h;c+=1)ZE(e,t,s[c],n);else ZE(e,t,s,n);else e.json||CE.call(n,r)||!CE.call(t,r)||(e.line=o||e.line,e.lineStart=a||e.lineStart,e.position=l||e.position,UE(e,"duplicated mapping key")),"__proto__"===r?Object.defineProperty(t,r,{configurable:!0,enumerable:!0,writable:!0,value:s}):t[r]=s,delete n[r];return t}function YE(e){var t;10===(t=e.input.charCodeAt(e.position))?e.position++:13===t?(e.position++,10===e.input.charCodeAt(e.position)&&e.position++):UE(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function qE(e,t,n){for(var i=0,r=e.input.charCodeAt(e.position);0!==r;){for(;ME(r);)9===r&&-1===e.firstTabInLine&&(e.firstTabInLine=e.position),r=e.input.charCodeAt(++e.position);if(t&&35===r)do{r=e.input.charCodeAt(++e.position)}while(10!==r&&13!==r&&0!==r);if(!IE(r))break;for(YE(e),r=e.input.charCodeAt(e.position),i++,e.lineIndent=0;32===r;)e.lineIndent++,r=e.input.charCodeAt(++e.position)}return-1!==n&&0!==i&&e.lineIndent<n&&HE(e,"deficient indentation"),i}function $E(e){var t,n=e.position;return!(45!==(t=e.input.charCodeAt(n))&&46!==t||t!==e.input.charCodeAt(n+1)||t!==e.input.charCodeAt(n+2)||0!==(t=e.input.charCodeAt(n+=3))&&!AE(t))}function XE(e,t){1===t?e.result+=" ":t>1&&(e.result+=jx("\n",t-1))}function KE(e,t){var n,i,r=e.tag,s=e.anchor,o=[],a=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=o),i=e.input.charCodeAt(e.position);0!==i&&(-1!==e.firstTabInLine&&(e.position=e.firstTabInLine,UE(e,"tab characters must not be used in indentation")),45===i)&&AE(e.input.charCodeAt(e.position+1));)if(a=!0,e.position++,qE(e,!0,-1)&&e.lineIndent<=t)o.push(null),i=e.input.charCodeAt(e.position);else if(n=e.line,ek(e,t,3,!1,!0),o.push(e.result),qE(e,!0,-1),i=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&0!==i)UE(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break;return!!a&&(e.tag=r,e.anchor=s,e.kind="sequence",e.result=o,!0)}function QE(e){var t,n,i,r,s=!1,o=!1;if(33!==(r=e.input.charCodeAt(e.position)))return!1;if(null!==e.tag&&UE(e,"duplication of a tag property"),60===(r=e.input.charCodeAt(++e.position))?(s=!0,r=e.input.charCodeAt(++e.position)):33===r?(o=!0,n="!!",r=e.input.charCodeAt(++e.position)):n="!",t=e.position,s){do{r=e.input.charCodeAt(++e.position)}while(0!==r&&62!==r);e.position<e.length?(i=e.input.slice(t,e.position),r=e.input.charCodeAt(++e.position)):UE(e,"unexpected end of the stream within a verbatim tag")}else{for(;0!==r&&!AE(r);)33===r&&(o?UE(e,"tag suffix cannot contain exclamation marks"):(n=e.input.slice(t-1,e.position+1),SE.test(n)||UE(e,"named tag handle cannot contain such characters"),o=!0,t=e.position+1)),r=e.input.charCodeAt(++e.position);i=e.input.slice(t,e.position),kE.test(i)&&UE(e,"tag suffix cannot contain flow indicator characters")}i&&!TE.test(i)&&UE(e,"tag name cannot contain such characters: "+i);try{i=decodeURIComponent(i)}catch(a){UE(e,"tag name is malformed: "+i)}return s?e.tag=i:CE.call(e.tagMap,n)?e.tag=e.tagMap[n]+i:"!"===n?e.tag="!"+i:"!!"===n?e.tag="tag:yaml.org,2002:"+i:UE(e,'undeclared tag handle "'+n+'"'),!0}function JE(e){var t,n;if(38!==(n=e.input.charCodeAt(e.position)))return!1;for(null!==e.anchor&&UE(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;0!==n&&!AE(n)&&!PE(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&UE(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function ek(e,t,n,i,r){var s,o,a,l,c,h,u,d,p,f=1,g=!1,m=!1;if(null!==e.listener&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,s=o=a=4===n||3===n,i&&qE(e,!0,-1)&&(g=!0,e.lineIndent>t?f=1:e.lineIndent===t?f=0:e.lineIndent<t&&(f=-1)),1===f)for(;QE(e)||JE(e);)qE(e,!0,-1)?(g=!0,a=s,e.lineIndent>t?f=1:e.lineIndent===t?f=0:e.lineIndent<t&&(f=-1)):a=!1;if(a&&(a=g||r),1!==f&&4!==n||(d=1===n||2===n?t:t+1,p=e.position-e.lineStart,1===f?a&&(KE(e,p)||function(e,t,n){var i,r,s,o,a,l,c,h=e.tag,u=e.anchor,d={},p=Object.create(null),f=null,g=null,m=null,b=!1,y=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=d),c=e.input.charCodeAt(e.position);0!==c;){if(b||-1===e.firstTabInLine||(e.position=e.firstTabInLine,UE(e,"tab characters must not be used in indentation")),i=e.input.charCodeAt(e.position+1),s=e.line,63!==c&&58!==c||!AE(i)){if(o=e.line,a=e.lineStart,l=e.position,!ek(e,n,2,!1,!0))break;if(e.line===s){for(c=e.input.charCodeAt(e.position);ME(c);)c=e.input.charCodeAt(++e.position);if(58===c)AE(c=e.input.charCodeAt(++e.position))||UE(e,"a whitespace character is expected after the key-value separator within a block mapping"),b&&(WE(e,d,p,f,g,null,o,a,l),f=g=m=null),y=!0,b=!1,r=!1,f=e.tag,g=e.result;else{if(!y)return e.tag=h,e.anchor=u,!0;UE(e,"can not read an implicit mapping pair; a colon is missed")}}else{if(!y)return e.tag=h,e.anchor=u,!0;UE(e,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===c?(b&&(WE(e,d,p,f,g,null,o,a,l),f=g=m=null),y=!0,b=!0,r=!0):b?(b=!1,r=!0):UE(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,c=i;if((e.line===s||e.lineIndent>t)&&(b&&(o=e.line,a=e.lineStart,l=e.position),ek(e,t,4,!0,r)&&(b?g=e.result:m=e.result),b||(WE(e,d,p,f,g,m,o,a,l),f=g=m=null),qE(e,!0,-1),c=e.input.charCodeAt(e.position)),(e.line===s||e.lineIndent>t)&&0!==c)UE(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return b&&WE(e,d,p,f,g,null,o,a,l),y&&(e.tag=h,e.anchor=u,e.kind="mapping",e.result=d),y}(e,p,d))||function(e,t){var n,i,r,s,o,a,l,c,h,u,d,p,f=!0,g=e.tag,m=e.anchor,b=Object.create(null);if(91===(p=e.input.charCodeAt(e.position)))o=93,c=!1,s=[];else{if(123!==p)return!1;o=125,c=!0,s={}}for(null!==e.anchor&&(e.anchorMap[e.anchor]=s),p=e.input.charCodeAt(++e.position);0!==p;){if(qE(e,!0,t),(p=e.input.charCodeAt(e.position))===o)return e.position++,e.tag=g,e.anchor=m,e.kind=c?"mapping":"sequence",e.result=s,!0;f?44===p&&UE(e,"expected the node content, but found ','"):UE(e,"missed comma between flow collection entries"),d=null,a=l=!1,63===p&&AE(e.input.charCodeAt(e.position+1))&&(a=l=!0,e.position++,qE(e,!0,t)),n=e.line,i=e.lineStart,r=e.position,ek(e,t,1,!1,!0),u=e.tag,h=e.result,qE(e,!0,t),p=e.input.charCodeAt(e.position),!l&&e.line!==n||58!==p||(a=!0,p=e.input.charCodeAt(++e.position),qE(e,!0,t),ek(e,t,1,!1,!0),d=e.result),c?WE(e,s,b,u,h,d,n,i,r):s.push(a?WE(e,null,b,u,h,d,n,i,r):h),qE(e,!0,t),44===(p=e.input.charCodeAt(e.position))?(f=!0,p=e.input.charCodeAt(++e.position)):f=!1}UE(e,"unexpected end of the stream within a flow collection")}(e,d)?m=!0:(o&&function(e,t){var n,i,r,s,o,a=1,l=!1,c=!1,h=t,u=0,d=!1;if(124===(s=e.input.charCodeAt(e.position)))i=!1;else{if(62!==s)return!1;i=!0}for(e.kind="scalar",e.result="";0!==s;)if(43===(s=e.input.charCodeAt(++e.position))||45===s)1===a?a=43===s?3:2:UE(e,"repeat of a chomping mode identifier");else{if(!((r=48<=(o=s)&&o<=57?o-48:-1)>=0))break;0===r?UE(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):c?UE(e,"repeat of an indentation width identifier"):(h=t+r-1,c=!0)}if(ME(s)){do{s=e.input.charCodeAt(++e.position)}while(ME(s));if(35===s)do{s=e.input.charCodeAt(++e.position)}while(!IE(s)&&0!==s)}for(;0!==s;){for(YE(e),e.lineIndent=0,s=e.input.charCodeAt(e.position);(!c||e.lineIndent<h)&&32===s;)e.lineIndent++,s=e.input.charCodeAt(++e.position);if(!c&&e.lineIndent>h&&(h=e.lineIndent),IE(s))u++;else{if(e.lineIndent<h){3===a?e.result+=jx("\n",l?1+u:u):1===a&&l&&(e.result+="\n");break}for(i?ME(s)?(d=!0,e.result+=jx("\n",l?1+u:u)):d?(d=!1,e.result+=jx("\n",u+1)):0===u?l&&(e.result+=" "):e.result+=jx("\n",u):e.result+=jx("\n",l?1+u:u),l=!0,c=!0,u=0,n=e.position;!IE(s)&&0!==s;)s=e.input.charCodeAt(++e.position);GE(e,n,e.position,!1)}}return!0}(e,d)||function(e,t){var n,i,r;if(39!==(n=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,i=r=e.position;0!==(n=e.input.charCodeAt(e.position));)if(39===n){if(GE(e,i,e.position,!0),39!==(n=e.input.charCodeAt(++e.position)))return!0;i=e.position,e.position++,r=e.position}else IE(n)?(GE(e,i,r,!0),XE(e,qE(e,!1,t)),i=r=e.position):e.position===e.lineStart&&$E(e)?UE(e,"unexpected end of the document within a single quoted scalar"):(e.position++,r=e.position);UE(e,"unexpected end of the stream within a single quoted scalar")}(e,d)||function(e,t){var n,i,r,s,o,a,l;if(34!==(a=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,n=i=e.position;0!==(a=e.input.charCodeAt(e.position));){if(34===a)return GE(e,n,e.position,!0),e.position++,!0;if(92===a){if(GE(e,n,e.position,!0),IE(a=e.input.charCodeAt(++e.position)))qE(e,!1,t);else if(a<256&&NE[a])e.result+=zE[a],e.position++;else if((o=120===(l=a)?2:117===l?4:85===l?8:0)>0){for(r=o,s=0;r>0;r--)(o=DE(a=e.input.charCodeAt(++e.position)))>=0?s=(s<<4)+o:UE(e,"expected hexadecimal character");e.result+=FE(s),e.position++}else UE(e,"unknown escape sequence");n=i=e.position}else IE(a)?(GE(e,n,i,!0),XE(e,qE(e,!1,t)),n=i=e.position):e.position===e.lineStart&&$E(e)?UE(e,"unexpected end of the document within a double quoted scalar"):(e.position++,i=e.position)}UE(e,"unexpected end of the stream within a double quoted scalar")}(e,d)?m=!0:function(e){var t,n,i;if(42!==(i=e.input.charCodeAt(e.position)))return!1;for(i=e.input.charCodeAt(++e.position),t=e.position;0!==i&&!AE(i)&&!PE(i);)i=e.input.charCodeAt(++e.position);return e.position===t&&UE(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),CE.call(e.anchorMap,n)||UE(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],qE(e,!0,-1),!0}(e)?(m=!0,null===e.tag&&null===e.anchor||UE(e,"alias node should not have any properties")):function(e,t,n){var i,r,s,o,a,l,c,h,u=e.kind,d=e.result;if(AE(h=e.input.charCodeAt(e.position))||PE(h)||35===h||38===h||42===h||33===h||124===h||62===h||39===h||34===h||37===h||64===h||96===h)return!1;if((63===h||45===h)&&(AE(i=e.input.charCodeAt(e.position+1))||n&&PE(i)))return!1;for(e.kind="scalar",e.result="",r=s=e.position,o=!1;0!==h;){if(58===h){if(AE(i=e.input.charCodeAt(e.position+1))||n&&PE(i))break}else if(35===h){if(AE(e.input.charCodeAt(e.position-1)))break}else{if(e.position===e.lineStart&&$E(e)||n&&PE(h))break;if(IE(h)){if(a=e.line,l=e.lineStart,c=e.lineIndent,qE(e,!1,-1),e.lineIndent>=t){o=!0,h=e.input.charCodeAt(e.position);continue}e.position=s,e.line=a,e.lineStart=l,e.lineIndent=c;break}}o&&(GE(e,r,s,!1),XE(e,e.line-a),r=s=e.position,o=!1),ME(h)||(s=e.position+1),h=e.input.charCodeAt(++e.position)}return GE(e,r,s,!1),!!e.result||(e.kind=u,e.result=d,!1)}(e,d,1===n)&&(m=!0,null===e.tag&&(e.tag="?")),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):0===f&&(m=a&&KE(e,p))),null===e.tag)null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);else if("?"===e.tag){for(null!==e.result&&"scalar"!==e.kind&&UE(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),l=0,c=e.implicitTypes.length;l<c;l+=1)if((u=e.implicitTypes[l]).resolve(e.result)){e.result=u.construct(e.result),e.tag=u.tag,null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);break}}else if("!"!==e.tag){if(CE.call(e.typeMap[e.kind||"fallback"],e.tag))u=e.typeMap[e.kind||"fallback"][e.tag];else for(u=null,l=0,c=(h=e.typeMap.multi[e.kind||"fallback"]).length;l<c;l+=1)if(e.tag.slice(0,h[l].tag.length)===h[l].tag){u=h[l];break}u||UE(e,"unknown tag !<"+e.tag+">"),null!==e.result&&u.kind!==e.kind&&UE(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+u.kind+'", not "'+e.kind+'"'),u.resolve(e.result,e.tag)?(e.result=u.construct(e.result,e.tag),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):UE(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return null!==e.listener&&e.listener("close",e),null!==e.tag||null!==e.anchor||m}function tk(e){var t,n,i,r,s=e.position,o=!1;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);0!==(r=e.input.charCodeAt(e.position))&&(qE(e,!0,-1),r=e.input.charCodeAt(e.position),!(e.lineIndent>0||37!==r));){for(o=!0,r=e.input.charCodeAt(++e.position),t=e.position;0!==r&&!AE(r);)r=e.input.charCodeAt(++e.position);for(i=[],(n=e.input.slice(t,e.position)).length<1&&UE(e,"directive name must not be less than one character in length");0!==r;){for(;ME(r);)r=e.input.charCodeAt(++e.position);if(35===r){do{r=e.input.charCodeAt(++e.position)}while(0!==r&&!IE(r));break}if(IE(r))break;for(t=e.position;0!==r&&!AE(r);)r=e.input.charCodeAt(++e.position);i.push(e.input.slice(t,e.position))}0!==r&&YE(e),CE.call(VE,n)?VE[n](e,n,i):HE(e,'unknown document directive "'+n+'"')}qE(e,!0,-1),0===e.lineIndent&&45===e.input.charCodeAt(e.position)&&45===e.input.charCodeAt(e.position+1)&&45===e.input.charCodeAt(e.position+2)?(e.position+=3,qE(e,!0,-1)):o&&UE(e,"directives end mark is expected"),ek(e,e.lineIndent-1,4,!1,!0),qE(e,!0,-1),e.checkLineBreaks&&EE.test(e.input.slice(s,e.position))&&HE(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&$E(e)?46===e.input.charCodeAt(e.position)&&(e.position+=3,qE(e,!0,-1)):e.position<e.length-1&&UE(e,"end of the stream or a document separator is expected")}function nk(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var ik=function(e,t){var n=function(e,t){t=t||{},0!==(e=String(e)).length&&(10!==e.charCodeAt(e.length-1)&&13!==e.charCodeAt(e.length-1)&&(e+="\n"),65279===e.charCodeAt(0)&&(e=e.slice(1)));var n=new BE(e,t),i=e.indexOf("\0");for(-1!==i&&(n.position=i,UE(n,"null byte is not allowed in input")),n.input+="\0";32===n.input.charCodeAt(n.position);)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)tk(n);return n.documents}(e,t);if(0!==n.length){if(1===n.length)return n[0];throw new Gx("expected a single document in the stream, but found more")}};nk("safeLoad","load"),nk("safeLoadAll","loadAll"),nk("safeDump","dump");const rk=Object.getOwnPropertyNames(Object.prototype),sk=Object.getOwnPropertyNames(Array.prototype);let ok=(()=>{class e{constructor(){this.peerHistory=[],this.isOpen=!1}initialize(){this.initAppConfig(),this.initDatabase()}initDatabase(){return xg(this,void 0,void 0,function*(){if(console.log("initDatabase..."),!window.indexedDB)return void console.warn("\u3053\u306e\u30d6\u30e9\u30a6\u30b6\u306f\u5b89\u5b9a\u677f\u306e IndexedDB \u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u305b\u3093\u3002IndexedDB \u306e\u6a5f\u80fd\u306f\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002");let e=new Bx,t=yield e.getPeerHistory();t.sort((e,t)=>e.timestamp<t.timestamp?1:e.timestamp>t.timestamp?-1:0);for(let n=1;n<t.length;n++)e.deletePeerHistory(t[n].peerId);if(console.log("\u5c65\u6b74: ",t),this.peerHistory=[],t.length)for(let n of t[0].history)n!==t[0].peerId&&this.peerHistory.push(n);console.log("\u6700\u7d42\u5c65\u6b74: ",this.peerHistory),Uy.register(this).on("CONNECT_PEER",-1e3,()=>{console.log("AppConfigService CONNECT_PEER",Hy.peerIds),this.isOpen||(this.isOpen=!0),e.addPeerHistory(Hy.peerId,Hy.peerIds)}).on("DISCONNECT_PEER",-1e3,()=>{console.log("AppConfigService DISCONNECT_PEER",Hy.peerIds)})})}initAppConfig(){return xg(this,void 0,void 0,function*(){try{console.log("YAML\u8aad\u307f\u8fbc\u307f...");let t=yield this.loadYaml(),n=ik(t);e.applyConfig(n)}catch(t){console.warn(t)}Uy.trigger("LOAD_CONFIG",e.appConfig)})}loadYaml(){return new Promise((e,t)=>{let n=document.querySelector('script[type$="yaml"]');if(!n)return console.warn("loadYaml element not found."),void e("");let i=n.textContent,r=n.getAttribute("src");if(null==r)return console.warn("loadYaml url undefined."),void e(i);let s=new XMLHttpRequest;s.open("get",r,!0),s.onerror=t=>{console.error(t),e(i)},s.onreadystatechange=t=>{4===s.readyState&&(200===s.status?(console.log("loadYaml success!"),i=s.responseText):console.warn("loadYaml fail...? status:"+s.status),e(i))},console.log("loadYaml start"),s.send(null)})}static applyConfig(t,n=e.appConfig){if(null==t)return n;let i=Object.getOwnPropertyNames(t);for(let r of i)(Array.isArray(t)||Array.isArray(n)?rk.concat(sk):rk).includes(r)?console.log(`skip invalid key (${r})`):null!=t[r]&&"object"==typeof t[r]?(null==n[r]&&(n[r]=Array.isArray(t[r])?[]:{}),e.applyConfig(t[r],n[r])):"function"!=typeof t[r]&&"function"!=typeof n[r]&&(n[r]=t[r]);return n}}return e.appConfig={webrtc:{key:""},app:{title:"",mode:""},dice:{url:""}},e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();const ak=["idInput"],lk=["idSpacer"];function ck(e,t){if(1&e){const e=Fo();Io(0,"div",9),zo("click",function(){return Ft(e),jo(2).changeIcon()}),ql(1,"safe"),Mo()}2&e&&ta("background-image",$l(1,2,"url("+jo(2).myPeer.image.url+")","style"))}function hk(e,t){if(1&e){const e=Fo();Io(0,"div"),Io(1,"button",5),zo("click",function(){return Ft(e),jo().changeIcon()}),ga(2,"\u30a2\u30a4\u30b3\u30f3\u3092\u5909\u66f4\u3059\u308b"),Mo(),Eo(3,ck,2,5,"div",6),Io(4,"span"),ga(5,"\u3042\u306a\u305f\u306e\u8272\u3068\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\uff1a"),Io(6,"input",7),zo("ngModelChange",function(t){return Ft(e),jo().myPeerColor=t}),Mo(),Io(7,"input",8),zo("ngModelChange",function(t){return Ft(e),jo().myPeerName=t}),Mo(),Ao(8,"br"),ga(9,"\u203b\u6700\u5f8c\u306b\u4f7f\u3063\u305f\u8272\u3068\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\u3092\u30d6\u30e9\u30a6\u30b6\u306b\u4fdd\u5b58\u3001"),Ao(10,"br"),ga(11,"\u3000\u8272\u3092\u521d\u671f\u5024\u306b\u623b\u3059\u969b\u306f\u767d(255,255,255)\u3092\u9078\u629e\u3002"),Mo(),Mo()}if(2&e){const e=jo();Zr(3),To("ngIf",e.myPeer.image),Zr(3),To("ngModel",e.myPeerColor),Zr(1),ta("color",e.myPeerColor),To("ngModel",e.myPeerName)}}function uk(e,t){if(1&e){const e=Fo();Io(0,"button",16),zo("click",function(){return Ft(e),jo(2).copyPeerId()}),Io(1,"b",17),ga(2,"content_copy"),Mo(),Mo()}2&e&&To("disabled",jo(2).isCopied)}function dk(e,t){if(1&e&&(Po(0),Io(1,"span",10),Io(2,"span",11,12),ga(4),Mo(),Ao(5,"input",13,14),Mo(),Eo(7,uk,3,1,"button",3),Io(8,"span",15),ga(9),Mo(),Do()),2&e){const e=jo();Zr(4),ma(e.networkService.peerContext.userId),Zr(1),Go("value",e.networkService.peerContext.userId),Zr(2),To("ngIf",e.isAbleClipboardCopy),Zr(1),ta("color",e.myPeerColor),To("@fadeInOut",e.isCopied),Zr(1),ba(" ",e.isCopied?"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002":"","")}}function pk(e,t){1&e&&(Io(0,"span",18),ga(1,"???"),Mo())}function fk(e,t){if(1&e&&(Io(0,"span",18),ga(1),Mo()),2&e){const e=jo(2);Zr(1),ya("",e.networkService.peerContext.roomName,"/",e.networkService.peerContext.roomId,"")}}function gk(e,t){if(1&e&&(Io(0,"span",18),ga(1),Mo()),2&e){const e=jo(2);Zr(1),ma(e.networkService.peerContext.password)}}function mk(e,t){if(1&e&&(Po(0),Ao(1,"hr"),Io(2,"div"),Io(3,"span"),ga(4,"\u30eb\u30fc\u30e0\u540d\uff1a"),Eo(5,fk,2,2,"span",1),Mo(),Mo(),Io(6,"div"),Io(7,"span"),ga(8,"\u30d1\u30b9\u30ef\u30fc\u30c9\uff1a"),Eo(9,gk,2,1,"span",1),Mo(),Mo(),Do()),2&e){const e=jo();Zr(5),To("ngIf",e.networkService.isOpen),Zr(4),To("ngIf",e.networkService.isOpen)}}function bk(e,t){1&e&&(Io(0,"span"),ga(1,"[\u63a5\u7d9a\u4e2d]"),Mo())}function yk(e,t){if(1&e&&(Io(0,"div"),Io(1,"div"),Eo(2,bk,2,0,"span",0),Io(3,"span"),ga(4),Io(5,"b"),ga(6),Mo(),ga(7,"]"),Mo(),Mo(),Mo()),2&e){const e=t.$implicit,n=jo();Zr(2),To("ngIf",!e.isOpen),Zr(2),ba("\u4ed6\u306e\u53c2\u52a0\u8005\uff1a",n.findUserId(e.peerId)," ["),Zr(1),ta("color",n.findPeerColor(e.peerId)),Zr(1),ma(n.findPeerName(e.peerId))}}function vk(e,t){if(1&e){const e=Fo();Po(0),Io(1,"input",19),zo("ngModelChange",function(t){return Ft(e),jo().targetUserId=t}),Mo(),Io(2,"button",16),zo("click",function(){return Ft(e),jo().connectPeer()}),ga(3,"\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a"),Mo(),Ao(4,"br"),Do()}if(2&e){const e=jo();Zr(1),To("ngModel",e.targetUserId),Zr(1),To("disabled",!e.networkService.isOpen)}}function _k(e,t){if(1&e){const e=Fo();Io(0,"button",16),zo("click",function(){return Ft(e),jo().showLobby()}),ga(1,"\u30ed\u30d3\u30fc\uff08\u30eb\u30fc\u30e0\u4e00\u89a7\uff09\u3092\u8868\u793a"),Mo()}2&e&&To("disabled",!jo().networkService.isOpen)}function wk(e,t){1&e&&(Io(0,"div",4),ga(1,"\u203b\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306f\u3001\u304a\u4e92\u3044\u306eID\u3092\u30e6\u30c9\u30ca\u30ea\u30a6\u30e0\u5916\u3067\u5171\u6709\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),Mo())}function Ck(e,t){1&e&&(Io(0,"div",4),ga(1,"\u203b\u4e00\u4eba\u3067\u52d5\u4f5c\u78ba\u8a8d\u3092\u884c\u3044\u305f\u3044\u5834\u5408\u306f\u30d6\u30e9\u30a6\u30b6\u30922\u3064\u958b\u304f\u3068\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u3002"),Mo())}function xk(e,t){if(1&e&&(Po(0),Eo(1,wk,2,0,"div",20),Eo(2,Ck,2,0,"div",20),Do()),2&e){const e=jo();Zr(1),To("ngIf",e.networkService.peerContexts.length<1),Zr(1),To("ngIf",e.networkService.peerContexts.length<1)}}function Ek(e,t){1&e&&(Po(0),Io(1,"div",4),ga(2,"\u203b\u30eb\u30fc\u30e0\u6a5f\u80fd\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u6642\u306f\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002"),Mo(),Do())}let kk=(()=>{class e{constructor(e,t,n,i){this.ngZone=e,this.modalService=t,this.panelService=n,this.appConfigService=i,this.targetUserId="",this.networkService=Hy,this.gameRoomService=Vy.instance,this.help="",this.isCopied=!1}get myPeer(){return av.myCursor}get myPeerName(){return av.myCursor?av.myCursor.name:null}set myPeerName(e){window.localStorage&&localStorage.setItem(av.CHAT_MY_NAME_LOCAL_STORAGE_KEY,e),av.myCursor&&(av.myCursor.name=e)}get myPeerColor(){return av.myCursor?av.myCursor.color:av.CHAT_DEFAULT_COLOR}set myPeerColor(e){av.myCursor&&(av.myCursor.color=e==av.CHAT_TRANSPARENT_COLOR?av.CHAT_DEFAULT_COLOR:e),window.localStorage&&localStorage.setItem(av.CHAT_MY_COLOR_LOCAL_STORAGE_KEY,av.myCursor.color)}ngOnInit(){Promise.resolve().then(()=>{this.panelService.title="\u63a5\u7d9a\u60c5\u5831",this.panelService.isAbleFullScreenButton=!1})}ngAfterViewInit(){Uy.register(this).on("OPEN_NETWORK",e=>{this.ngZone.run(()=>{}),this.idInput&&this.idInput.nativeElement&&(this.idInput.nativeElement.style.width=this.idSpacer.nativeElement.getBoundingClientRect().width+"px")}),this.idInput&&this.idInput.nativeElement&&(this.idInput.nativeElement.style.width=this.idSpacer.nativeElement.getBoundingClientRect().width+"px")}ngOnDestroy(){clearTimeout(this._timeOutId),Uy.unregister(this)}changeIcon(){this.modalService.open(ew).then(e=>{this.myPeer&&e&&(this.myPeer.imageIdentifier=e)})}resetPeerIfNeeded(){Hy.peerContexts.length<1&&(Hy.open(),av.myCursor.peerId=Hy.peerId)}connectPeer(){this.help="";let e=Lg.create(this.targetUserId);e.isRoom||(Vy.instance.clearDeleteHistory(),Hy.connect(e.peerId))}connectPeerHistory(){return xg(this,void 0,void 0,function*(){this.help="";let e=[],t="";for(let i of this.appConfigService.peerHistory){let n=Lg.parse(i);n.isRoom?(t!==n.roomId&&(e=[]),t=n.roomId,e.push(n)):(t!==n.roomId&&(e=[]),e.push(n))}if(t.length){console.warn("connectPeerRoom <"+t+">");let e=[],n=yield Hy.listAllPeers();for(let i of n){console.log(i);let n=Lg.parse(i);n.roomId===t&&e.push(n)}if(e.length<1)return this.help="\u524d\u56de\u63a5\u7d9a\u3057\u3066\u3044\u305f\u30eb\u30fc\u30e0\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u65e2\u306b\u89e3\u6563\u3057\u3066\u3044\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002",void console.warn("Room is already closed...");Hy.open(Lg.generateId(),e[0].roomId,e[0].roomName,e[0].password)}else console.warn("connectPeers "+e.length),Hy.open();av.myCursor.peerId=Hy.peerId;let n=Uy.register(this);n.on("OPEN_NETWORK",t=>{console.log("OPEN_NETWORK",t.data.peerId),Uy.unregisterListener(n),Vy.instance.clearDeleteHistory();for(let n of e)Hy.connect(n.peerId)})})}showLobby(){this.modalService.open(Lx,{width:700,height:400,left:0,top:400})}findUserId(e){const t=av.findByPeerId(e);return t?t.userId:""}findPeerName(e){const t=av.findByPeerId(e);return t?t.name:""}findPeerColor(e){const t=av.findByPeerId(e);return t?t.color:""}copyPeerId(){navigator.clipboard&&(navigator.clipboard.writeText(this.networkService.peerContext.userId),this.isCopied=!0,clearTimeout(this._timeOutId),this._timeOutId=setTimeout(()=>{this.isCopied=!1},1e3))}isAbleClipboardCopy(){return!!navigator.clipboard}}return e.\u0275fac=function(t){return new(t||e)(So(Rc),So(xv),So(wv),So(ok))},e.\u0275cmp=Ze({type:e,selectors:[["peer-menu"]],viewQuery:function(e,t){if(1&e&&(cc(ak,1),cc(lk,1)),2&e){let e;lc(e=hc())&&(t.idInput=e.first),lc(e=hc())&&(t.idSpacer=e.first)}},decls:18,vars:10,consts:[[4,"ngIf"],["style","font-weight: bold;",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"disabled","click",4,"ngIf"],[2,"font-size","12px"],[3,"click"],["class","image cover",3,"background-image","click",4,"ngIf"],["type","color",2,"width","1em","margin-right","0.5em",3,"ngModel","ngModelChange"],["placeholder","\u30cb\u30c3\u30af\u30cd\u30fc\u30e0",2,"font-weight","bolder",3,"ngModel","ngModelChange"],[1,"image","cover",3,"click"],[2,"display","inline-block"],[1,"id-spacer"],["idSpacer",""],["type","text","readonly","",1,"id-input",3,"value"],["idInput",""],[1,"copied"],[3,"disabled","click"],[1,"material-icons",2,"font-size","1em","vertical-align","bottom"],[2,"font-weight","bold"],["placeholder","\u63a5\u7d9a\u3057\u305f\u3044\u76f8\u624b\u306eID","name","targetUserId",3,"ngModel","ngModelChange"],["style","font-size: 12px;",4,"ngIf"]],template:function(e,t){1&e&&(Eo(0,hk,12,5,"div",0),Io(1,"div"),Io(2,"span"),ga(3,"\u3042\u306a\u305f\u306eID\uff1a"),Io(4,"span"),Eo(5,dk,10,7,"ng-container",0),Mo(),Eo(6,pk,2,0,"span",1),Mo(),Mo(),Eo(7,mk,10,2,"ng-container",0),Ao(8,"hr"),Eo(9,yk,8,5,"div",2),Io(10,"div"),Eo(11,vk,5,2,"ng-container",0),Eo(12,_k,2,1,"button",3),Mo(),Io(13,"div"),Io(14,"span",4),ga(15),Mo(),Mo(),Eo(16,xk,3,2,"ng-container",0),Eo(17,Ek,3,0,"ng-container",0)),2&e&&(To("ngIf",t.myPeer),Zr(5),To("ngIf",t.networkService.isOpen),Zr(1),To("ngIf",!t.networkService.isOpen),Zr(1),To("ngIf",t.networkService.peerContext.isRoom),Zr(2),To("ngForOf",t.networkService.peerContexts),Zr(2),To("ngIf",!t.networkService.peerContext.isRoom),Zr(1),To("ngIf",t.networkService.peerIds.length<=1),Zr(3),ma(t.help),Zr(1),To("ngIf",!t.networkService.peerContext.isRoom),Zr(1),To("ngIf",t.networkService.peerContext.isRoom))},directives:[Zh,Vh,ju,sd,Sd],pipes:[$_],styles:[".image[_ngcontent-%COMP%]{padding:0;width:128px;height:128px;display:table-cell;vertical-align:top}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto;height:auto;max-width:100%;max-height:100%;vertical-align:bottom}.cover[_ngcontent-%COMP%]{background-position:top;background-repeat:no-repeat;background-size:cover}.id-spacer[_ngcontent-%COMP%]{position:absolute;visibility:hidden;pointer-events:none;height:0;padding:0 3px;border-radius:3px;border:2px solid transparent}.id-input[_ngcontent-%COMP%], .id-spacer[_ngcontent-%COMP%]{box-sizing:border-box;font-family:Cambria,Georgia;font-size:larger;font-weight:bolder}.id-input[_ngcontent-%COMP%]{width:100%;background:none;border-radius:2px;outline:none;color:#444;padding:2px;border-radius:3px;border:2px solid transparent}.id-input[_ngcontent-%COMP%]:active, .id-input[_ngcontent-%COMP%]:hover{border-color:#444}.copied[_ngcontent-%COMP%]{font-size:smaller;opacity:0}"],data:{animation:[Jd("fadeInOut",[sp("false => true",[ep("50ms ease-in-out",np({opacity:1})),ep("900ms ease-in-out",np({opacity:0}))])])]}}),e})(),Sk=(()=>{class e{constructor(){this.batchTask=new Map,this.batchTaskTimer=null}add(e,t={}){this.batchTask.set(t,e),null==this.batchTaskTimer&&(this.execBatch(),this.batchTaskTimer=setInterval(()=>{0<this.batchTask.size?this.execBatch():(clearInterval(this.batchTaskTimer),this.batchTaskTimer=null)},66))}remove(e={}){this.batchTask.delete(e)}execBatch(){this.batchTask.forEach(e=>e()),this.batchTask.clear()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const Tk=["textArea"];function Ok(e,t){1&e&&(Ao(0,"img",26),ql(1,"safe")),2&e&&To("src",$l(1,1,jo(2).imageFile.url,"resourceUrl"),Xi)}function Ik(e,t){if(1&e&&(Io(0,"div",24),Eo(1,Ok,2,4,"img",25),Mo()),2&e){const e=jo();Zr(1),To("ngIf",0<e.imageFile.url.length)}}function Mk(e,t){if(1&e&&(Io(0,"div",24),Ao(1,"img",26),ql(2,"safe"),Mo()),2&e){const e=jo(2);Zr(1),To("src",$l(2,1,null==e.character.faceIcon?null:e.character.faceIcon.url,"resourceUrl"),Xi)}}const Ak=function(e,t){return{inverse:e,hollow:t}},Pk=function(e,t,n,i,r,s,o,a){return{black:e,blue:t,green:n,cyan:i,red:r,magenta:s,yellow:o,white:a}},Dk=function(e){return{"black-paint":e}};function Rk(e,t){if(1&e&&(Io(0,"div",29),Io(1,"span",30),Ao(2,"img",31),ql(3,"safe"),Mo(),Mo()),2&e){const e=jo(3);To("ngClass",Hl(7,Ak,e.character.isInverse,e.character.isHollow)),Zr(1),To("ngClass",Zl(10,Pk,0==e.character.aura,1==e.character.aura,2==e.character.aura,3==e.character.aura,4==e.character.aura,5==e.character.aura,6==e.character.aura,7==e.character.aura)),Zr(1),To("src",$l(3,4,e.character.imageFile.url,"resourceUrl"),Xi)("ngClass",Ul(19,Dk,e.character.isBlackPaint))}}function Fk(e,t){if(1&e&&Eo(0,Rk,4,21,"div",28),2&e){const e=jo(2);To("ngIf",e.character&&null!=e.character.imageFile&&0<e.character.imageFile.url.length)}}function Nk(e,t){if(1&e&&(Eo(0,Mk,3,4,"div",2),Eo(1,Fk,1,1,"ng-template",null,27,dc)),2&e){const e=ko(2),t=jo();To("ngIf",t.isUseFaceIcon&&t.character&&null!=t.character.faceIcon&&0<(null==t.character.faceIcon||null==t.character.faceIcon.url?null:t.character.faceIcon.url.length))("ngIfElse",e)}}function zk(e,t){if(1&e&&(Io(0,"option",32),ga(1),Mo()),2&e){const e=jo();ta("color",e.myColor),Go("value",null==e.myPeer?null:e.myPeer.identifier),Zr(1),ba("",null==e.myPeer?null:e.myPeer.name,"\uff08\u3042\u306a\u305f\uff09")}}function Lk(e,t){if(1&e&&(Io(0,"option",33),ga(1),Mo()),2&e){const e=t.$implicit;ta("color",e.chatPalette&&e.chatPalette.color&&"#ffffff"!=e.chatPalette.color?e.chatPalette.color:"#444"),Go("value",e.identifier),Zr(1),ma(e.name)}}function Bk(e,t){1&e&&(Po(0),ga(1,"\uff08\u3042\u306a\u305f\uff09"),Do())}function jk(e,t){if(1&e&&(Io(0,"option",32),ga(1),Eo(2,Bk,2,0,"ng-container",23),Mo()),2&e){const e=t.$implicit,n=jo();ta("color",e.color),Go("value",e.identifier),Zr(1),ba("",e.name," "),Zr(1),To("ngIf",e===n.myPeer)}}function Uk(e,t){if(1&e&&(Io(0,"option",36),ga(1),Mo()),2&e){const e=t.$implicit;Go("value",e.script),Zr(1),ma(e.game)}}const Hk=function(){return{standalone:!0}},Vk=function(e){return{"not-specified":e}};function Gk(e,t){if(1&e){const e=Fo();Io(0,"select",34),zo("change",function(t){return Ft(e),jo().loadDiceBot(t.target.value)})("ngModelChange",function(t){return Ft(e),jo().gameType=t}),Io(1,"option",13),ga(2,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u6307\u5b9a\u306a\u3057"),Mo(),Eo(3,Uk,2,2,"option",35),Mo()}if(2&e){const e=jo();To("ngModel",e.gameType)("ngModelOptions",jl(4,Hk))("ngClass",Ul(5,Vk,""==e.gameType)),Zr(3),To("ngForOf",e.diceBotInfos)}}function Zk(e,t){if(1&e&&(Io(0,"option",36),ga(1),Mo()),2&e){const e=t.$implicit;Go("value",e.script),Zr(1),ma(e.game)}}function Wk(e,t){if(1&e&&(Io(0,"optgroup",38),Eo(1,Zk,2,2,"option",35),Mo()),2&e){const e=t.$implicit;Go("label",e.index),Zr(1),To("ngForOf",e.infos)}}function Yk(e,t){if(1&e){const e=Fo();Io(0,"select",34),zo("change",function(t){return Ft(e),jo().loadDiceBot(t.target.value)})("ngModelChange",function(t){return Ft(e),jo().gameType=t}),Io(1,"option",13),ga(2,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u6307\u5b9a\u306a\u3057"),Mo(),Eo(3,Wk,2,2,"optgroup",37),Mo()}if(2&e){const e=jo();To("ngModel",e.gameType)("ngModelOptions",jl(4,Hk))("ngClass",Ul(5,Vk,""==e.gameType)),Zr(3),To("ngForOf",e.diceBotInfosIndexed)}}function qk(e,t){if(1&e&&(Io(0,"option",36),ga(1),Mo()),2&e){const e=t.$implicit;Go("value",e),Zr(1),ma(e)}}const $k=function(e){return{"disabled-stand":e}};function Xk(e,t){if(1&e){const e=Fo();Io(0,"div",39),Io(1,"label",5),Io(2,"input",6),zo("ngModelChange",function(t){return Ft(e),jo().isUseStandImage=t})("change",function(){Ft(e);const t=jo();return t.isUseStandImage=!!t.isUseStandImage}),Mo(),Io(3,"b",7),ga(4,"Stand: "),Mo(),Mo(),Io(5,"select",40),zo("change",function(){return Ft(e),jo().isUseStandImage=!0})("ngModelChange",function(t){return Ft(e),jo().standName=t}),Io(6,"option",13),ga(7,"\u672a\u9078\u629e"),Mo(),Eo(8,qk,2,2,"option",35),Mo(),Io(9,"span",41),Io(10,"b",7),ga(11,"Pos: "),Mo(),Io(12,"input",42),zo("change",function(){return Ft(e),jo().isUseStandImage=!0})("ngModelChange",function(t){return Ft(e),jo().character.standList.position=t}),Mo(),Io(13,"input",43),zo("change",function(){return Ft(e),jo().isUseStandImage=!0})("ngModelChange",function(t){return Ft(e),jo().character.standList.position=t}),Mo(),Io(14,"b",7),ga(15,"\uff05"),Mo(),Mo(),Io(16,"button",44),zo("click",function(){return Ft(e),jo().farewellStand()}),ga(17,"\u9000\u53bb"),Mo(),Mo()}if(2&e){const e=jo();To("ngClass",Ul(14,$k,!e.isUseStandImageOnChatTab)),Zr(2),Go("checked",e.isUseStandImage?"checked":""),To("ngModel",e.isUseStandImage),Co("disabled",e.isUseStandImageOnChatTab?null:""),Zr(3),To("ngModel",e.standName)("ngModelOptions",jl(16,Hk))("ngClass",Ul(17,Vk,""==e.standName)),Co("disabled",e.isUseStandImageOnChatTab?null:""),Zr(3),To("ngForOf",e.standNameList),Zr(4),To("ngModel",e.character.standList.position),Co("disabled",e.isUseStandImageOnChatTab?null:""),Zr(1),To("ngModel",e.character.standList.position),Co("disabled",e.isUseStandImageOnChatTab?null:""),Zr(3),Co("disabled",e.isUseStandImageOnChatTab?null:"")}}function Kk(e,t){if(1&e){const e=Fo();Io(0,"input",45),zo("ngModelChange",function(t){return Ft(e),jo().paletteColor=t}),Mo()}2&e&&To("ngModel",jo().paletteColor)("ngModelOptions",jl(2,Hk))}function Qk(e,t){1&e&&(Io(0,"span"),ga(1,", "),Mo())}function Jk(e,t){if(1&e&&(Io(0,"span",47),ga(1),Eo(2,Qk,2,0,"span",23),Mo()),2&e){const e=t.$implicit,n=t.index,i=jo(2);ta("color",e.color),Zr(1),ma(e.name),Zr(1),To("ngIf",i.writingPeerNameAndColors.length!==n+1)}}function eS(e,t){if(1&e&&(Po(0),Eo(1,Jk,3,4,"span",46),Io(2,"span"),ga(3," \u304c\u5165\u529b\u4e2d..."),Mo(),Do()),2&e){const e=jo();Zr(1),To("ngForOf",e.writingPeerNameAndColors)}}const tS=function(e){return{"direct-message":e}},nS=function(e,t){return{color:e,"font-weight":t}};let iS=(()=>{class e{constructor(e,t,n,i,r,s){this.ngZone=e,this.chatMessageService=t,this.batchService=n,this.panelService=i,this.pointerDeviceService=r,this.contextMenuService=s,this.onlyCharacters=!1,this.chatTabidentifier="",this._gameType="",this.gameTypeChange=new Xl,this._sendFrom=this.myPeer?this.myPeer.identifier:"",this.sendFromChange=new Xl,this._sendTo="",this.sendToChange=new Xl,this._text="",this.textChange=new Xl,this.chat=new Xl,this.gameHelp="",this.isUseFaceIcon=!0,this.isUseStandImage=!0,this.standName="",this.shouldUpdateCharacterList=!0,this._gameCharacters=[],this.writingEventInterval=null,this.previousWritingLength=0,this.writingPeers=new Map,this.writingPeerNameAndColors=[]}get isUseStandImageOnChatTab(){const e=Vy.instance.get(this.chatTabidentifier);return e&&e.isUseStandImage}get gameType(){return this._gameType}set gameType(e){this._gameType=e,this.gameTypeChange.emit(e)}get sendFrom(){return this._sendFrom}set sendFrom(e){this._sendFrom=e,this.sendFromChange.emit(e)}get sendTo(){return this._sendTo}set sendTo(e){this._sendTo=e,this.sendToChange.emit(e)}get text(){return this._text}set text(e){this._text=e,this.textChange.emit(e)}get isDirect(){return!(null==this.sendTo||!this.sendTo.length)}get character(){let e=Vy.instance.get(this.sendFrom);return e instanceof gv?e:null}get hasStand(){return!(!this.character||!this.character.standList)&&this.character.standList.standElements.length>0}get standNameList(){if(!this.hasStand)return[];let e=[];for(let t of this.character.standList.standElements){let n=t.getFirstElementByName("name");n&&n.value&&e.indexOf(n.value.toString())<0&&e.push(n.value.toString())}return e.sort()}get standListNoGroup(){return[]}get standListWithGroup(){if(!this.hasStand)return[];let e={};const t=this.character.standList.standElements.map(e=>e.getFirstElementByName("name")).filter(e=>e);t.sort((e,t)=>e.currentValue===t.currentValue?0:e.currentValue>t.currentValue?-1:1);for(const n of t)if(n&&n.value){const t=n.currentValue&&n.currentValue.toString().length>0?n.currentValue.toString():"";t&&(e[t]||(e[t]=[]),e[t].indexOf(n.value.toString())<0&&e[t].push(n.value.toString()))}return Object.keys(e).sort().map(t=>({name:t,stands:e[t].sort()})).filter(e=>e.stands.length>0)}get imageFile(){let e=Vy.instance.get(this.sendFrom),t=null;return e instanceof gv?t=e.imageFile:e instanceof av&&(t=e.image),t||Ig.Empty}get paletteColor(){return this.character&&this.character.chatPalette&&this.character.chatPalette.paletteColor?this.character.chatPalette.paletteColor:av.CHAT_TRANSPARENT_COLOR}set paletteColor(e){this.character.chatPalette.color=e||av.CHAT_TRANSPARENT_COLOR}get myColor(){return av.myCursor&&av.myCursor.color&&av.myCursor.color!=av.CHAT_TRANSPARENT_COLOR?av.myCursor.color:av.CHAT_DEFAULT_COLOR}get color(){return this.paletteColor&&this.paletteColor!=av.CHAT_TRANSPARENT_COLOR?this.paletteColor:this.myColor}get sendToColor(){let e=Vy.instance.get(this.sendTo);return e instanceof av?e.color:av.CHAT_DEFAULT_COLOR}get gameCharacters(){return this.shouldUpdateCharacterList&&(this.shouldUpdateCharacterList=!1,this._gameCharacters=Vy.instance.getObjects(gv).filter(e=>this.allowsChat(e))),this._gameCharacters}get diceBotInfos(){return _v.diceBotInfos}get myPeer(){return av.myCursor}get otherPeers(){return Vy.instance.getObjects(av)}get diceBotInfosIndexed(){return _v.diceBotInfosIndexed}ngOnInit(){Uy.register(this).on("MESSAGE_ADDED",e=>{if(e.data.tabIdentifier!==this.chatTabidentifier)return;let t=Vy.instance.get(e.data.messageIdentifier),n=Vy.instance.getObjects(av).find(e=>e.userId===t.from),i=n?n.peerId:"?";this.writingPeers.has(i)&&(this.writingPeers.get(i).stop(),this.writingPeers.delete(i),this.updateWritingPeerNameAndColors())}).on("UPDATE_GAME_OBJECT",-1e3,e=>{if(e.data.aliasName!==gv.aliasName)return;if(this.shouldUpdateCharacterList=!0,e.data.identifier!==this.sendFrom)return;let t=Vy.instance.get(e.data.identifier);t&&!this.allowsChat(t)&&(this.sendFrom=0<this.gameCharacters.length&&this.onlyCharacters?this.gameCharacters[0].identifier:this.myPeer.identifier)}).on("DISCONNECT_PEER",e=>{let t=Vy.instance.get(this.sendTo);t instanceof av&&t.peerId===e.data.peerId&&(this.sendTo="")}).on("WRITING_A_MESSAGE",e=>{e.isSendFromSelf||e.data!==this.chatTabidentifier||(this.writingPeers.has(e.sendFrom)||this.writingPeers.set(e.sendFrom,new Gy(()=>{this.writingPeers.delete(e.sendFrom),this.updateWritingPeerNameAndColors(),this.ngZone.run(()=>{})},2e3)),this.writingPeers.get(e.sendFrom).reset(),this.updateWritingPeerNameAndColors(),this.batchService.add(()=>this.ngZone.run(()=>{}),this))})}ngOnDestroy(){Uy.unregister(this),this.batchService.remove(this)}updateWritingPeerNameAndColors(){this.writingPeerNameAndColors=Array.from(this.writingPeers.keys()).map(e=>{let t=av.findByPeerId(e);return{name:t?t.name:"",color:t?t.color:av.CHAT_TRANSPARENT_COLOR}})}onInput(){if(null===this.writingEventInterval&&this.previousWritingLength<=this.text.length){let e=null;if(this.isDirect){let t=Vy.instance.get(this.sendTo);if(t instanceof av){let n=Lg.parse(t.peerId);n&&(e=n.peerId)}}Uy.call("WRITING_A_MESSAGE",this.chatTabidentifier,e),this.writingEventInterval=setTimeout(()=>{this.writingEventInterval=null},200)}this.previousWritingLength=this.text.length,this.calcFitHeight()}sendChat(e){if(e&&e.preventDefault(),e&&13!==e.keyCode)return;this.sendFrom.length||(this.sendFrom=this.myPeer.identifier);let t=this.text,n=null;if(this.character&&(rv.cr(t).trim()||this.standName)){if(t=this.character.chatPalette.evaluate(this.text,this.character.rootDataElement),this.character.standList){let e=null;e=this.isUseFaceIcon&&this.character.faceIcon?this.character.faceIcon.identifier:this.character.imageFile?this.character.imageFile.identifier:null;const i=this.character.standList.matchStandInfo(t,e,this.standName);if(i.farewell)this.farewellStand();else if(this.isUseStandImage&&this.isUseStandImageOnChatTab&&i.standElementIdentifier){n=i.standElementIdentifier;const e={characterIdentifier:this.character.identifier,standIdentifier:i.standElementIdentifier,color:this.character.chatPalette?this.character.chatPalette.color:av.CHAT_DEFAULT_COLOR,secret:!!this.sendTo};if(e.secret){const t=Vy.instance.get(this.sendTo);t&&(t.peerId!=av.myCursor.peerId&&Uy.call("POPUP_STAND_IMAGE",e,t.peerId),Uy.call("POPUP_STAND_IMAGE",e,av.myCursor.peerId))}else Uy.call("POPUP_STAND_IMAGE",e)}i.matchMostLongText&&(t=t.slice(0,t.length-i.matchMostLongText.length))}const e=/\u300c([\s\S]+?)\u300d/gm;let i,r=[];for(;null!==(i=e.exec(t));)r.push(i[1]);if(r.length>0){const e={characterIdentifier:this.character.identifier,text:r.join("\n\n"),faceIconIdentifier:this.isUseFaceIcon&&this.character.faceIcon?this.character.faceIcon.identifier:null,color:this.color,secret:!!this.sendTo};if(e.secret){const t=Vy.instance.get(this.sendTo);t&&(t.peerId!=av.myCursor.peerId&&Uy.call("POPUP_CHAT_BALLOON",e,t.peerId),Uy.call("POPUP_CHAT_BALLOON",e,av.myCursor.peerId))}else Uy.call("POPUP_CHAT_BALLOON",e)}else rv.cr(t).trim()&&this.character.text&&Uy.call("FAREWELL_CHAT_BALLOON",{characterIdentifier:this.character.identifier})}rv.cr(t).trim()&&this.chat.emit({text:t,gameType:this.gameType,sendFrom:this.sendFrom,sendTo:this.sendTo,color:this.color,isInverse:!!this.character&&this.character.isInverse,isHollow:!!this.character&&this.character.isHollow,isBlackPaint:!!this.character&&this.character.isBlackPaint,aura:this.character?this.character.aura:-1,isUseFaceIcon:this.isUseFaceIcon,characterIdentifier:this.character?this.character.identifier:null,standIdentifier:n,standName:this.standName,isUseStandImage:this.isUseStandImage&&this.isUseStandImageOnChatTab}),this.text="",this.previousWritingLength=this.text.length,this.textAreaElementRef.nativeElement.value="",this.calcFitHeight()}calcFitHeight(){let e=this.textAreaElementRef.nativeElement;e.style.height="",e.scrollHeight>=e.offsetHeight&&(e.style.height=e.scrollHeight+"px")}loadDiceBot(e){console.log("onChangeGameType ready"),_v.getHelpMessage(e).then(e=>{console.log("onChangeGameType done\n"+e)})}showDicebotHelp(){_v.getHelpMessage(this.gameType).then(e=>{this.gameHelp=e;let t="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8";for(let r of _v.diceBotInfos)r.script===this.gameType&&(t="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3008"+r.game+"\u3009");t+="\u4f7f\u7528\u6cd5";let n=this.pointerDeviceService.pointers[0],i=this.panelService.open(L_,{left:n.x,top:n.y,width:600,height:500});i.title=t,i.text=this.gameHelp})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let t=this.pointerDeviceService.pointers[0];if(!this.character)return void this.contextMenuService.open(t,[{name:"\u63a5\u7d9a\u60c5\u5831",action:()=>{this.panelService.open(kk,{width:520,height:600,top:t.y-100,left:t.x-100})}}],av.myCursor.name,null,av.myCursor.color,!0);let n=[{name:"\u300c\u300d\u3092\u5165\u529b",action:()=>{let e=this.textAreaElementRef.nativeElement,t=this.text.trim();"\u300c"!=t.slice(0,1)&&(t="\u300c"+t),"\u300d"!=t.slice(-1)&&(t+="\u300d"),this.text=t,e.value=this.text,e.selectionStart=this.text.length-1,e.selectionEnd=this.text.length-1,e.focus()}}];this.character&&(this.isUseFaceIcon&&this.character.faceIcon?(n.push(B_),n.push({name:"\u9854\u30a2\u30a4\u30b3\u30f3\u306e\u5909\u66f4",action:null,subActions:this.character.faceIcons.map((e,t)=>({name:this.character.currntIconIndex==t?"\u25c9":"\u25cb",action:()=>{this.character.currntIconIndex!=t&&(this.character.currntIconIndex=t)},default:this.character.currntIconIndex==t,icon:e})),disabled:this.character.faceIcons.length<=1})):(this.character.imageFiles.length>1&&(n.push(B_),n.push({name:"\u753b\u50cf\u5207\u308a\u66ff\u3048",action:null,subActions:this.character.imageFiles.map((e,t)=>({name:this.character.currntImageIndex==t?"\u25c9":"\u25cb",action:()=>{this.character.currntImageIndex=t,q_.play(Y_.surprise),Uy.trigger("UPDATE_INVENTORY",null)},default:this.character.currntImageIndex==t,icon:e}))})),n.push(B_),n.push({name:"\u753b\u50cf\u52b9\u679c",action:null,subActions:[this.character.isInverse?{name:"\u2611 \u53cd\u8ee2",action:()=>{this.character.isInverse=!1,Uy.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u53cd\u8ee2",action:()=>{this.character.isInverse=!0,Uy.trigger("UPDATE_INVENTORY",null)}},this.character.isHollow?{name:"\u2611 \u307c\u304b\u3057",action:()=>{this.character.isHollow=!1,Uy.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u307c\u304b\u3057",action:()=>{this.character.isHollow=!0,Uy.trigger("UPDATE_INVENTORY",null)}},this.character.isBlackPaint?{name:"\u2611 \u9ed2\u5857\u308a",action:()=>{this.character.isBlackPaint=!1,Uy.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ed2\u5857\u308a",action:()=>{this.character.isBlackPaint=!0,Uy.trigger("UPDATE_INVENTORY",null)}},{name:"\u30aa\u30fc\u30e9",action:null,subActions:[{name:(-1==this.character.aura?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{this.character.aura=-1,Uy.trigger("UPDATE_INVENTORY",null)}},B_].concat(["\u30d6\u30e9\u30c3\u30af","\u30d6\u30eb\u30fc","\u30b0\u30ea\u30fc\u30f3","\u30b7\u30a2\u30f3","\u30ec\u30c3\u30c9","\u30de\u30bc\u30f3\u30bf","\u30a4\u30a8\u30ed\u30fc","\u30db\u30ef\u30a4\u30c8"].map((e,t)=>({name:`${this.character.aura==t?"\u25c9":"\u25cb"} ${e}`,action:()=>{this.character.aura=t,Uy.trigger("UPDATE_INVENTORY",null)}})))},B_,{name:"\u30ea\u30bb\u30c3\u30c8",action:()=>{this.character.isInverse=!1,this.character.isHollow=!1,this.character.isBlackPaint=!1,this.character.aura=-1,Uy.trigger("UPDATE_INVENTORY",null)},disabled:!this.character.isInverse&&!this.character.isHollow&&!this.character.isBlackPaint&&-1==this.character.aura}]})),n.push(B_),n.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.character)}}),this.onlyCharacters||n.push({name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a",action:()=>{this.showChatPalette(this.character)}}),n.push({name:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a",action:()=>{this.showStandSetting(this.character)}})),this.contextMenuService.open(t,n,this.character.name)}farewellStand(){if(this.character){const e={characterIdentifier:this.character.identifier};if(this.sendTo){const t=Vy.instance.get(this.sendTo);t&&(t.peerId!=av.myCursor.peerId&&Uy.call("FAREWELL_STAND_IMAGE",e,t.peerId),Uy.call("FAREWELL_STAND_IMAGE",e,av.myCursor.peerId))}else Uy.call("FAREWELL_STAND_IMAGE",e)}}showDetail(e){let t=this.pointerDeviceService.pointers[0],n="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(n+=" - "+e.name),this.panelService.open(wx,{title:n,left:t.x-400,top:t.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let t=this.pointerDeviceService.pointers[0];this.panelService.open(Tw,{left:t.x-250,top:t.y-175,width:620,height:350}).character=e}showStandSetting(e){let t=this.pointerDeviceService.pointers[0];this.panelService.open(Jw,{left:t.x-400,top:t.y-175,width:730,height:572}).character=e}allowsChat(e){switch(e.location.name){case"table":case this.myPeer.peerId:return!0;case"graveyard":return!1;default:for(const t of Hy.peerContexts)if(t.isOpen&&e.location.name===t.peerId)return!1;return!0}}}return e.\u0275fac=function(t){return new(t||e)(So(Rc),So(fw),So(Sk),So(wv),So(Kw),So(j_))},e.\u0275cmp=Ze({type:e,selectors:[["chat-input"]],viewQuery:function(e,t){if(1&e&&cc(Tk,3),2&e){let e;lc(e=hc())&&(t.textAreaElementRef=e.first)}},inputs:{onlyCharacters:"onlyCharacters",chatTabidentifier:"chatTabidentifier",_gameType:["gameType","_gameType"],_sendFrom:["sendFrom","_sendFrom"],_sendTo:["sendTo","_sendTo"],_text:["text","_text"]},outputs:{gameTypeChange:"gameTypeChange",sendFromChange:"sendFromChange",sendToChange:"sendToChange",textChange:"textChange",chat:"chat"},decls:36,vars:32,consts:[[1,"table",3,"ngClass"],[1,"table-cell","imagebox",2,"cursor","context-menu",3,"contextmenu"],["class","imagebox",4,"ngIf","ngIfElse"],["isCharacter",""],[1,"table-cell"],[2,"margin-right","2px"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"font-size","smaller"],[2,"max-width","10em",3,"ngModel","ngStyle","ngModelChange","change"],["style","font-weight: bolder;",3,"value","color",4,"ngIf"],["style","font-weight: normal;",3,"color","value",4,"ngFor","ngForOf"],[2,"white-space","nowrap"],[2,"max-width","10em",3,"ngModel","ngClass","ngStyle","ngModelChange"],["value","",1,"not-specified"],["style","font-weight: bolder;",3,"value","color",4,"ngFor","ngForOf"],["style","width: 12em;",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange",4,"ngIf"],[3,"click"],["style","font-size: smaller;",3,"ngClass",4,"ngIf"],["type","color","style","width:1em; margin-left: 3px",3,"ngModel","ngModelOptions","ngModelChange",4,"ngIf"],[1,"chat-input",3,"placeholder","ngModel","ngModelOptions","ngModelChange","input","keydown.enter"],["textArea",""],["type","submit",3,"click"],[1,"writing-info"],[4,"ngIf"],[1,"imagebox"],["class","image",3,"src",4,"ngIf"],[1,"image",3,"src"],["noFaceIcon",""],["class","inverser",3,"ngClass",4,"ngIf"],[1,"inverser",3,"ngClass"],[1,"aura","imagebox",3,"ngClass"],[1,"image",3,"src","ngClass"],[2,"font-weight","bolder",3,"value"],[2,"font-weight","normal",3,"value"],[2,"width","12em",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["class","dice-bot-group",3,"label",4,"ngFor","ngForOf"],[1,"dice-bot-group",3,"label"],[2,"font-size","smaller",3,"ngClass"],[2,"width","8em","margin-right","6px",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange"],[2,"white-space","nowrap","margin-left","1em","display","inline-block"],["type","range","min","0","max","100",2,"width","186px",3,"ngModel","change","ngModelChange"],["type","number","min","0","max","100",2,"width","3em","text-align","right","margin-right","3px",3,"ngModel","change","ngModelChange"],["type","button",2,"margin-left","1.3em","font-size","smaller",3,"click"],["type","color",2,"width","1em","margin-left","3px",3,"ngModel","ngModelOptions","ngModelChange"],["style","font-weight: bold;",3,"color",4,"ngFor","ngForOf"],[2,"font-weight","bold"]],template:function(e,t){if(1&e&&(Io(0,"div",0),Io(1,"div",1),zo("contextmenu",function(e){return t.onContextMenu(e)}),Eo(2,Ik,2,1,"div",2),Eo(3,Nk,3,2,"ng-template",null,3,dc),Mo(),Io(5,"div",4),Io(6,"div"),Io(7,"label",5),Io(8,"input",6),zo("ngModelChange",function(e){return t.isUseFaceIcon=e})("change",function(){return t.isUseFaceIcon=!!t.isUseFaceIcon}),Mo(),Io(9,"b",7),ga(10,"\u9854IC"),Mo(),Mo(),Io(11,"select",8),zo("ngModelChange",function(e){return t.sendFrom=e})("change",function(){return t.standName=""}),Eo(12,zk,2,4,"option",9),Eo(13,Lk,2,4,"option",10),Mo(),Io(14,"span",11),ga(15," \u27a1 "),Io(16,"select",12),zo("ngModelChange",function(e){return t.sendTo=e}),Io(17,"option",13),ga(18,"\u5168\u54e1"),Mo(),Eo(19,jk,3,5,"option",14),Mo(),Mo(),Io(20,"span",11),Eo(21,Gk,4,7,"select",15),Eo(22,Yk,4,7,"select",15),Io(23,"button",16),zo("click",function(){return t.showDicebotHelp()}),ga(24,"?"),Mo(),Mo(),Mo(),Eo(25,Xk,18,19,"div",17),Io(26,"div"),Io(27,"form"),Eo(28,Kk,1,3,"input",18),Io(29,"textarea",19,20),zo("ngModelChange",function(e){return t.text=e})("input",function(){return t.onInput()})("keydown.enter",function(e){return t.sendChat(e)}),Mo(),Io(31,"button",21),zo("click",function(){return t.sendChat(null)}),Io(32,"b"),ga(33,"SEND"),Mo(),Mo(),Mo(),Mo(),Io(34,"div",22),Eo(35,eS,4,1,"ng-container",23),Mo(),Mo(),Mo()),2&e){const e=ko(4);To("ngClass",Ul(21,tS,t.isDirect)),Zr(2),To("ngIf",!t.character)("ngIfElse",e),Zr(6),Go("checked",t.isUseFaceIcon?"checked":""),To("ngModel",t.isUseFaceIcon),Zr(3),To("ngModel",t.sendFrom)("ngStyle",Hl(23,nS,t.color,t.sendFrom!=(null==t.myPeer?null:t.myPeer.identifier)?"normal":"bolder")),Zr(1),To("ngIf",!t.onlyCharacters),Zr(1),To("ngForOf",t.gameCharacters),Zr(3),To("ngModel",t.sendTo)("ngClass",Ul(26,Vk,""==t.sendTo))("ngStyle",Hl(28,nS,""==t.sendTo?null:t.sendToColor,""==t.sendTo?"normal":"bolder")),Zr(3),To("ngForOf",t.otherPeers),Zr(2),To("ngIf",t.diceBotInfosIndexed.length<1),Zr(1),To("ngIf",t.diceBotInfosIndexed.length>0),Zr(3),To("ngIf",t.hasStand),Zr(3),To("ngIf",t.onlyCharacters),Zr(1),To("placeholder",t.onlyCharacters?"Enter\u3067\u9001\u4fe1\u3000Shift+Enter\u3067\u6539\u884c\u3000\u767d(255,255,255)\u306e\u5834\u5408\u3042\u306a\u305f\u306e\u8272":"Enter\u3067\u9001\u4fe1\u3000Shift+Enter\u3067\u6539\u884c\u3000\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u8272\u3092\u512a\u5148")("ngModel",t.text)("ngModelOptions",jl(31,Hk)),Zr(6),To("ngIf",0<t.writingPeerNameAndColors.length)}},directives:[Uh,Zh,zu,sd,Sd,Ld,Qh,Vh,Bd,Vd,Td,od,xd,ju,Fd,Id],pipes:[$_],styles:[".table[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px;display:table;width:100%}.table[_ngcontent-%COMP%]   .table-cell[_ngcontent-%COMP%]{display:table-cell}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:50px;height:50px;max-width:50px;max-height:50px;vertical-align:top;text-align:center}.image[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0;object-position:50% 0;border-radius:.5rem}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #00f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 6px #ccc) drop-shadow(0 -4px 4px #fff)}.chat-input[_ngcontent-%COMP%]{font-family:Arial;font-size:13px;width:calc(100% - 100px);height:calc(1em + 4px);min-height:calc(1em + 7px);max-height:calc(6em + 7px);overflow-y:auto;padding:1px;margin:5px;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;vertical-align:bottom}.writing-info[_ngcontent-%COMP%]{font-size:8px;height:1.3em}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.not-specified[_ngcontent-%COMP%]{color:grey}.dice-bot-group[_ngcontent-%COMP%]{color:#f5f5f5;background-color:#555}option[_ngcontent-%COMP%]{color:#000;background-color:#fff}.disabled-stand[_ngcontent-%COMP%]{color:grey}"]}),e})(),rS=(()=>{class e{constructor(){this.tableInventory=new sS(e=>"table"===e.location.name),this.commonInventory=new sS(e=>!this.isAnyLocation(e.location.name)),this.privateInventory=new sS(e=>e.location.name===Hy.peerId),this.graveyardInventory=new sS(e=>"graveyard"===e.location.name),this.indicateAll=!1,this.locationMap=new Map,this.tagNameMap=new Map,this.newLineString="/",this.newLineDataElement=hv.create(this.newLineString),this.initialize()}get summarySetting(){return aC.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(e){this.summarySetting.sortTag=e}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(e){this.summarySetting.sortOrder=e}get dataTag(){return this.summarySetting.dataTag}set dataTag(e){this.summarySetting.dataTag=e}get dataTags(){return this.summarySetting.dataTags}initialize(){Uy.register(this).on("OPEN_NETWORK",e=>{this.refresh()}).on("CONNECT_PEER",e=>{this.refresh()}).on("DISCONNECT_PEER",e=>{this.refresh()}).on("UPDATE_GAME_OBJECT",-1e3,e=>{let t=Vy.instance.get(e.data.identifier);if(t)if(t instanceof gv){let e=this.locationMap.get(t.identifier);t.location.name!==e&&(this.locationMap.set(t.identifier,t.location.name),this.refresh())}else if(t instanceof hv){if(!this.containsInGameCharacter(t))return;let e=this.tagNameMap.get(t.identifier);(this.dataTags.includes(e)||this.dataTags.includes(t.name))&&t.name!==e&&(this.tagNameMap.set(t.identifier,t.name),this.refreshDataElements()),this.sortTag===t.name&&this.refreshSort(),0<t.children.length&&(this.refreshDataElements(),this.refreshSort()),this.callInventoryUpdate()}else t instanceof aC&&(this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate())}).on("DELETE_GAME_OBJECT",1e3,e=>{this.locationMap.delete(e.data.identifier),this.tagNameMap.delete(e.data.identifier),this.refresh()}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.callInventoryUpdate()})}containsInGameCharacter(e){let t=e.parent,n=gv.aliasName;for(;t;){if(t.aliasName===n)return!0;t=t.parent}return!1}refresh(){this.refreshObjects(),this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate()}refreshObjects(){this.tableInventory.refreshObjects(),this.commonInventory.refreshObjects(),this.privateInventory.refreshObjects(),this.graveyardInventory.refreshObjects()}refreshDataElements(){this.tableInventory.refreshDataElements(),this.commonInventory.refreshDataElements(),this.privateInventory.refreshDataElements(),this.graveyardInventory.refreshDataElements()}refreshSort(){this.tableInventory.refreshSort(),this.commonInventory.refreshSort(),this.privateInventory.refreshSort(),this.graveyardInventory.refreshSort()}callInventoryUpdate(){Uy.trigger("UPDATE_INVENTORY",null)}isAnyLocation(e){if("table"===e||e===Hy.peerId||"graveyard"===e)return!0;for(let t of Hy.peerContexts)if(t.isOpen&&e===t.peerId)return!0;return!1}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class sS{constructor(e){this.classifier=e,this.newLineString="/",this.newLineDataElement=hv.create(this.newLineString),this._tabletopObjects=[],this._dataElementMap=new Map,this.needsRefreshObjects=!0,this.needsRefreshElements=!0,this.needsSort=!0}get summarySetting(){return aC.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(e){this.summarySetting.sortTag=e}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(e){this.summarySetting.sortOrder=e}get dataTag(){return this.summarySetting.dataTag}set dataTag(e){this.summarySetting.dataTag=e}get dataTags(){return this.summarySetting.dataTags}get tabletopObjects(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this.needsSort&&(this._tabletopObjects=this.sortTabletopObjects(this._tabletopObjects),this.needsSort=!1),this._tabletopObjects}get length(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this._tabletopObjects.length}get dataElementMap(){if(this.needsRefreshElements){this._dataElementMap.clear();let e=this.tabletopObjects;for(let t of e){if(!t.rootDataElement)continue;let e=this.dataTags.map(e=>e===this.newLineString?this.newLineDataElement:t.rootDataElement.getFirstElementByName(e));this._dataElementMap.set(t.identifier,e)}this.needsRefreshElements=!1}return this._dataElementMap}refreshObjects(){this.needsRefreshObjects=!0}refreshDataElements(){this.needsRefreshElements=!0}refreshSort(){this.needsSort=!0}searchTabletopObjects(){let e=Vy.instance.getObjects(gv),t=[];for(let n of e)this.classifier(n)&&t.push(n);return t}sortTabletopObjects(e){let t=this.sortTag.length?this.sortTag.trim():"",n="ASC"===this.sortOrder?-1:1;return t.length<1||e.sort((e,i)=>{let r=e.rootDataElement.getFirstElementByName(t),s=i.rootDataElement.getFirstElementByName(t);if(!r&&!s)return 0;if(!s)return-1;if(!r)return 1;let o=this.convertToSortableValue(r),a=this.convertToSortableValue(s);return o<a?n:o>a?-1*n:0}),e}convertToSortableValue(e){let t=rv.toHalfWidth(((e.isNumberResource?e.currentValue:e.value)+"").trim()),n=+t;return Number.isNaN(n)?t:n}}var oS;!function(e){function t(e,t=0){return e=parseFloat(e),isNaN(e)?t:e}e.relation=function(e,n,i=0){return"number"==typeof e?e:"string"==typeof e?(e=e.trim().toLowerCase()).indexOf("%")>0?t(e.replace("%",""),i)/100*n:e.indexOf("px")>0||e.indexOf("pt")>0?t(e.replace("px",""),i):e.indexOf("vw")>0?t(e.replace("vw",""),i)/100*window.innerWidth:e.indexOf("vh")>0?t(e.replace("vh",""),i)/100*window.innerHeight:e.indexOf("vm")>0?t(e.replace("vm",""),i)/100*Math.min(window.innerWidth,window.innerHeight):e.indexOf("em")>0?t(e.replace("em",""),i):"top"===e||"left"===e?0:"center"===e||"middle"===e?.5*n:"bottom"===e||"right"===e?n:i:i},e.parse=t}(oS||(oS={}));let aS=(()=>{class e{constructor(){this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1}static create(t,n=null,i=new e){return t&&t.ownerDocument?i.setCSS((n||window.getComputedStyle(t)).transform):i.identity()}setData(e){if(null==e)return;let t=e.length;return 16==t?(this.m11=e[0],this.m12=e[1],this.m13=e[2],this.m14=e[3],this.m21=e[4],this.m22=e[5],this.m23=e[6],this.m24=e[7],this.m31=e[8],this.m32=e[9],this.m33=e[10],this.m34=e[11],this.m41=e[12],this.m42=e[13],this.m43=e[14],this.m44=e[15]):6==t?(this.m11=e[0],this.m12=e[1],this.m13=0,this.m14=0,this.m21=e[2],this.m22=e[3],this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=e[4],this.m42=e[5],this.m43=0,this.m44=1):9==t&&(this.m11=e[0],this.m12=e[1],this.m13=0,this.m14=e[2],this.m21=e[3],this.m22=e[4],this.m23=0,this.m24=e[5],this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=e[6],this.m42=e[7],this.m43=0,this.m44=e[8]),this}identity(){return this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1,this}scalar(e){return this.m11*=e,this.m12*=e,this.m13*=e,this.m14*=e,this.m21*=e,this.m22*=e,this.m23*=e,this.m24*=e,this.m31*=e,this.m32*=e,this.m33*=e,this.m34*=e,this.m41*=e,this.m42*=e,this.m43*=e,this.m44*=e,this}unproject(e,t={x:0,y:0,z:0,w:1}){let n=e.x*this.m11+e.y*this.m21+this.m41,i=e.x*this.m12+e.y*this.m22+this.m42,r=e.x*this.m13+e.y*this.m23+this.m43,s=e.x*this.m14+e.y*this.m24+this.m44,o=n+this.m31,a=i+this.m32,l=r+this.m33,c=s+this.m34;0==s&&(s=1e-4),n/=s,i/=s,r/=s,0==c&&(c=1e-4),o/=c,a/=c,l/=c;let h=l-r;if(0==h)return t.x=n,t.y=i,t.z=r,t.w=r,t;let u=-r/h;return n+=u*(o-n),i+=u*(a-i),t.x=n,t.y=i,t.z=r,t.w=r,t}project(e,t={x:0,y:0,z:0,w:1}){let n=e.z,i=e.x*this.m14+e.y*this.m24+n*this.m34+this.m44,r=e.x*this.m11+e.y*this.m21+n*this.m31+this.m41,s=e.x*this.m12+e.y*this.m22+n*this.m32+this.m42;return 0==i&&(i=1e-4),r/=i,s/=i,i<0&&(r-=this.m41,s-=this.m42,r*=1/i,s*=1/i,r+=this.m41,s+=this.m42),t.x=r,t.y=s,t.z=n,t.w=n,t}append(t){return e.multiply(this,t,this)}setPosition(e){return this.m41=e.x,this.m42=e.y,this.m43=e.z,this}getPosition(e={x:0,y:0,z:0,w:1}){return e.x=this.m41,e.y=this.m42,e.z=this.m43,e}static makePosition(t,n=new e){return n.identity(),n.setPosition(t),n}appendPosition(...t){let n;return n=1===t.length?t[0]:{x:t[0],y:t[1],z:t[2],w:1},this.append(e.makePosition(n,e.MATRIX3D))}static makePerspective(t,n=new e){return n.identity(),n.m34=t?-1/t:0,n}appendPerspective(t){return t?this.append(e.makePerspective(t,e.MATRIX3D)):this}invert(e){e=e||this;let t=[],n=this.m11,i=this.m12,r=this.m13,s=this.m14,o=this.m21,a=this.m22,l=this.m23,c=this.m24,h=this.m31,u=this.m32,d=this.m33,p=this.m34,f=this.m41,g=this.m42,m=this.m43,b=this.m44;t[0]=l*p*g-c*d*g+c*u*m-a*p*m-l*u*b+a*d*b,t[1]=s*d*g-r*p*g-s*u*m+i*p*m+r*u*b-i*d*b,t[2]=r*c*g-s*l*g+s*a*m-i*c*m-r*a*b+i*l*b,t[3]=s*l*u-r*c*u-s*a*d+i*c*d+r*a*p-i*l*p;let y=n*t[0]+o*t[1]+h*t[2]+f*t[3];return 0==y?(console.warn("Can not invert matrix, determinant is 0"),this):(t[4]=c*d*f-l*p*f-c*h*m+o*p*m+l*h*b-o*d*b,t[5]=r*p*f-s*d*f+s*h*m-n*p*m-r*h*b+n*d*b,t[6]=s*l*f-r*c*f-s*o*m+n*c*m+r*o*b-n*l*b,t[7]=r*c*h-s*l*h+s*o*d-n*c*d-r*o*p+n*l*p,t[8]=a*p*f-c*u*f+c*h*g-o*p*g-a*h*b+o*u*b,t[9]=s*u*f-i*p*f-s*h*g+n*p*g+i*h*b-n*u*b,t[10]=i*c*f-s*a*f+s*o*g-n*c*g-i*o*b+n*a*b,t[11]=s*a*h-i*c*h-s*o*u+n*c*u+i*o*p-n*a*p,t[12]=l*u*f-a*d*f-l*h*g+o*d*g+a*h*m-o*u*m,t[13]=i*d*f-r*u*f+r*h*g-n*d*g-i*h*m+n*u*m,t[14]=r*a*f-i*l*f-r*o*g+n*l*g+i*o*m-n*a*m,t[15]=i*l*h-r*a*h+r*o*u-n*l*u-i*o*d+n*a*d,e.setData(t),e.scalar(1/y),e)}setCSS(e){if(!e||"none"==e)return this.identity();let t=e.replace("matrix3d(","").replace("matrix(","").replace(")","").split(","),n=t.length;for(let i=0;i<n;++i)t[i]=oS.parse(t[i]);return this.setData(t)}appendCSS(t,n=!1){return t&&"none"!=t?n&&t.indexOf("matrix3d")>=0?this.append(e.MATRIX3D.setCSS(t).flatten()):this.append(e.MATRIX3D.setCSS(t)):this}flatten(){return this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m44=1,this.m14=0,this.m24=0,this.m43=0,this}static multiply(t,n,i=new e){let r=t.m11*n.m12+t.m12*n.m22+t.m13*n.m32+t.m14*n.m42,s=t.m11*n.m13+t.m12*n.m23+t.m13*n.m33+t.m14*n.m43,o=t.m11*n.m14+t.m12*n.m24+t.m13*n.m34+t.m14*n.m44,a=t.m21*n.m11+t.m22*n.m21+t.m23*n.m31+t.m24*n.m41,l=t.m21*n.m12+t.m22*n.m22+t.m23*n.m32+t.m24*n.m42,c=t.m21*n.m13+t.m22*n.m23+t.m23*n.m33+t.m24*n.m43,h=t.m21*n.m14+t.m22*n.m24+t.m23*n.m34+t.m24*n.m44,u=t.m31*n.m11+t.m32*n.m21+t.m33*n.m31+t.m34*n.m41,d=t.m31*n.m12+t.m32*n.m22+t.m33*n.m32+t.m34*n.m42,p=t.m31*n.m13+t.m32*n.m23+t.m33*n.m33+t.m34*n.m43,f=t.m31*n.m14+t.m32*n.m24+t.m33*n.m34+t.m34*n.m44,g=t.m41*n.m11+t.m42*n.m21+t.m43*n.m31+t.m44*n.m41,m=t.m41*n.m12+t.m42*n.m22+t.m43*n.m32+t.m44*n.m42,b=t.m41*n.m13+t.m42*n.m23+t.m43*n.m33+t.m44*n.m43,y=t.m41*n.m14+t.m42*n.m24+t.m43*n.m34+t.m44*n.m44;return i.m11=t.m11*n.m11+t.m12*n.m21+t.m13*n.m31+t.m14*n.m41,i.m12=r,i.m13=s,i.m14=o,i.m21=a,i.m22=l,i.m23=c,i.m24=h,i.m31=u,i.m32=d,i.m33=p,i.m34=f,i.m41=g,i.m42=m,i.m43=b,i.m44=y,i}toString(e=3){return"m11="+this.m11.toFixed(e)+"\tm21="+this.m21.toFixed(e)+"\tm31="+this.m31.toFixed(e)+"\tm41="+this.m41.toFixed(e)+"\nm12="+this.m12.toFixed(e)+"\tm22="+this.m22.toFixed(e)+"\tm32="+this.m32.toFixed(e)+"\tm42="+this.m42.toFixed(e)+"\nm13="+this.m13.toFixed(e)+"\tm23="+this.m23.toFixed(e)+"\tm33="+this.m33.toFixed(e)+"\tm43="+this.m43.toFixed(e)+"\nm14="+this.m14.toFixed(e)+"\tm24="+this.m24.toFixed(e)+"\tm34="+this.m34.toFixed(e)+"\tm44="+this.m44.toFixed(e)}}return e.MATRIX3D=new e,e})();class lS{constructor(e){this.matrix=new aS,this.sceneTransform=new aS,this.inverseSceneTransform=new aS,this.initialize(e)}clear(){return this.element=null,this.matrix.identity(),this}initialize(e){if(!e)return;this.element=e;let t=window.getComputedStyle(e),n=0,i=0;return this.element.parentElement?(n=this.element.parentElement.clientWidth,i=this.element.parentElement.clientHeight):(n=window.innerWidth,i=window.innerHeight),this.paddingLeft=oS.relation(t.paddingTop,n),this.paddingTop=oS.relation(t.paddingTop,i),this.marginLeft=oS.relation(t.marginLeft,n),this.marginTop=oS.relation(t.marginTop,i),this.borderLeft=oS.relation(t.borderLeft,n),this.borderTop=oS.relation(t.borderTop,i),this.matrix.setCSS(t.transform),this.sceneTransform.identity(),this.extract(this,this.sceneTransform),this.sceneTransform.invert(this.inverseSceneTransform),this}globalToLocal(e,t,n=0){let i={x:e,y:t,z:n,w:1};return this.inverseSceneTransform.unproject(i,i),this.fromBorderBox(i),i}localToGlobal(e,t,n=0){let i={x:e,y:t,z:n,w:1};return this.sceneTransform.project(i,i),this.fromBorderBox(i),i}localToLocal(e,t,n,i){let r=e,s=t,o=n,a=new lS(i),l=aS.multiply(this.sceneTransform,a.inverseSceneTransform),c={x:0,y:0,z:0,w:1};return c.x=r*l.m11+s*l.m21+o*l.m31+1*l.m41,c.y=r*l.m12+s*l.m22+o*l.m32+1*l.m42,c.z=r*l.m13+s*l.m23+o*l.m33+1*l.m43,c.w=r*l.m14+s*l.m24+o*l.m34+1*l.m44,a.clear(),this.toBorderBox(c),c}extract(e,t){let n=e.element;for(;n;)this.extractMatrix(n,t),n&&"fixed"===n.style.position&&(console.warn("fixed\u9818\u57df\u306f\u8a08\u7b97\u304c\u4e0d\u6b63\u78ba"),t.appendPosition(window.pageXOffset,window.pageYOffset,0)),n=n.parentElement}extractMatrix(e,t=null){if(t||(t=new aS),!e)return t;let n=e,i=window.getComputedStyle(e);if("none"!=i.transform){let e=i.transformOrigin?i.transformOrigin.split(" "):[],r=oS.relation(e[0],n.offsetWidth,.5*n.offsetWidth),s=oS.relation(e[1],n.offsetHeight,.5*n.offsetHeight),o=oS.relation(e[2],0,0);t.appendPosition(-r,-s,-o),t.appendCSS(i.transform),t.appendPosition(r,s,o)}let r=this.getPosition(e);t.appendPosition(r.x,r.y,0);let s=0;if(e.parentElement){let t=window.getComputedStyle(e.parentElement);s=oS.parse(t.perspective)}if(e.parentElement&&s){let i=window.getComputedStyle(e.parentElement).perspectiveOrigin.split(" "),r=oS.relation(i[0],n.parentElement.offsetWidth),o=oS.relation(i[1],n.parentElement.offsetHeight);t.appendPosition(-r,-o,0),t.appendPerspective(s),t.appendPosition(r,o,0)}return t}getPosition(e){let t={x:0,y:0};return t.x=e.offsetParent?e.parentElement===e.offsetParent?e.offsetLeft:e.parentElement.offsetParent===e.offsetParent?e.offsetLeft-e.parentElement.offsetLeft:0:e.offsetLeft,t.y=e.offsetParent?e.parentElement===e.offsetParent?e.offsetTop:e.parentElement.offsetParent===e.offsetParent?e.offsetTop-e.parentElement.offsetTop:0:e.offsetTop,t.x+=e.offsetParent?e.offsetParent.clientLeft:0,t.y+=e.offsetParent?e.offsetParent.clientTop:0,t}fromBorderBox(e){e.x+=this.paddingLeft,e.y+=this.paddingTop,e.x+=this.marginLeft,e.y+=this.marginTop,e.x-=this.borderLeft,e.y-=this.borderTop}toBorderBox(e){e.x-=this.paddingLeft,e.y-=this.paddingTop,e.x-=this.marginLeft,e.y-=this.marginTop,e.x+=this.borderLeft,e.y+=this.borderTop}}let cS=(()=>{class e{constructor(e){this.pointerDeviceService=e,this.tabletopOriginElement=document.body}convertToLocal(e,t=document.body){let n=new lS(t),i=n.globalToLocal(e.x,e.y,e.z?e.z:0);return n.clear(),{x:i.x,y:i.y,z:i.z}}convertToGlobal(e,t=document.body){let n=new lS(t),i=n.localToGlobal(e.x,e.y,e.z?e.z:0);return n.clear(),{x:i.x,y:i.y,z:i.z}}convertLocalToLocal(e,t,n){let i=new lS(t),r=i.globalToLocal(e.x,e.y,e.z?e.z:0),s=i.localToLocal(r.x,r.y,0,n);return i.clear(),{x:s.x,y:s.y,z:s.z}}calcTabletopLocalCoordinate(e={x:this.pointerDeviceService.pointers[0].x,y:this.pointerDeviceService.pointers[0].y,z:0},t=this.pointerDeviceService.targetElement){return t.contains(this.tabletopOriginElement)?(e=this.convertToLocal(e,this.tabletopOriginElement)).z=0:e=this.convertLocalToLocal(e,t,this.tabletopOriginElement),{x:e.x,y:e.y,z:0<e.z?e.z:0}}}return e.\u0275fac=function(t){return new(t||e)(oi(Kw))},e.\u0275prov=pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),hS=(()=>{class e{constructor(e){this.coordinateService=e,this._emptyTable=new gC(""),this.locationMap=new Map,this.parentMap=new Map,this.characterCache=new uS(()=>Vy.instance.getObjects(gv).filter(e=>e.isVisibleOnTable)),this.cardCache=new uS(()=>Vy.instance.getObjects(rw).filter(e=>e.isVisibleOnTable)),this.cardStackCache=new uS(()=>Vy.instance.getObjects(ow).filter(e=>e.isVisibleOnTable)),this.tableMaskCache=new uS(()=>{let e=this.tableSelecter.viewTable;return e?e.masks:[]}),this.terrainCache=new uS(()=>{let e=this.tableSelecter.viewTable;return e?e.terrains:[]}),this.textNoteCache=new uS(()=>Vy.instance.getObjects(bC)),this.diceSymbolCache=new uS(()=>Vy.instance.getObjects(cw)),this.initialize()}get tableSelecter(){return Vy.instance.get("tableSelecter")}get currentTable(){return this.tableSelecter.viewTable||this._emptyTable}get characters(){return this.characterCache.objects}get cards(){return this.cardCache.objects}get cardStacks(){return this.cardStackCache.objects}get tableMasks(){return this.tableMaskCache.objects}get terrains(){return this.terrainCache.objects}get textNotes(){return this.textNoteCache.objects}get diceSymbols(){return this.diceSymbolCache.objects}get peerCursors(){return Vy.instance.getObjects(av)}initialize(){this.refreshCacheAll(),Uy.register(this).on("UPDATE_GAME_OBJECT",-1e3,e=>{if(e.data.identifier===this.currentTable.identifier||e.data.identifier===this.tableSelecter.identifier)return this.refreshCache(cC.aliasName),void this.refreshCache(dC.aliasName);let t=Vy.instance.get(e.data.identifier);t&&t instanceof uv?this.shouldRefreshCache(t)&&(this.refreshCache(e.data.aliasName),this.updateMap(t)):this.refreshCache(e.data.aliasName)}).on("DELETE_GAME_OBJECT",-1e3,e=>{let t=Vy.instance.get(e.data.identifier);null==t||t.aliasName.length<1?this.refreshCacheAll():this.refreshCache(t.aliasName)}).on("XML_LOADED",e=>{let t=Xy.instance.parseXml(e.data.xmlElement);if(t instanceof uv){let e=this.coordinateService.calcTabletopLocalCoordinate();t.location.x=e.x-25,t.location.y=e.y-25,t.posZ=e.z,this.placeToTabletop(t),q_.play(Y_.piecePut)}else t instanceof uw?pw.instance.addChatTab(t):t instanceof mv&&yv.instance.addDiceRollTable(t)})}findCache(e){switch(e){case gv.aliasName:return this.characterCache;case rw.aliasName:return this.cardCache;case ow.aliasName:return this.cardStackCache;case cC.aliasName:return this.tableMaskCache;case dC.aliasName:return this.terrainCache;case bC.aliasName:return this.textNoteCache;case cw.aliasName:return this.diceSymbolCache;default:return null}}refreshCache(e){let t=this.findCache(e);t&&t.refresh()}refreshCacheAll(){this.characterCache.refresh(),this.cardCache.refresh(),this.cardStackCache.refresh(),this.tableMaskCache.refresh(),this.terrainCache.refresh(),this.textNoteCache.refresh(),this.diceSymbolCache.refresh(),this.clearMap()}shouldRefreshCache(e){return this.locationMap.get(e.identifier)!==e.location.name||this.parentMap.get(e.identifier)!==e.parentId}updateMap(e){this.locationMap.set(e.identifier,e.location.name),this.parentMap.set(e.identifier,e.parentId)}clearMap(){this.locationMap.clear(),this.parentMap.clear()}placeToTabletop(e){switch(e.aliasName){case cC.aliasName:e instanceof cC&&(e.isLock=!1);case dC.aliasName:if(e instanceof dC&&(e.isLocked=!1),!this.tableSelecter||!this.tableSelecter.viewTable)return;this.tableSelecter.viewTable.appendChild(e);break;default:e.setLocation("table")}}}return e.\u0275fac=function(t){return new(t||e)(oi(cS))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();class uS{constructor(e){this.refreshCollector=e,this.needsRefresh=!0,this._objects=[]}get objects(){return this.needsRefresh&&(this._objects=this.refreshCollector(),this._objects=this._objects?this._objects:[],this.needsRefresh=!1),this._objects}refresh(){this.needsRefresh=!0}}class dS{constructor(e,t,n){this.chanks=[],this.chankSize=32768,this.chankReceiveCount=0,this.sentChankIndex=0,this.completedChankIndex=0,this.startTime=0,this.isCanceled=!1,this.identifier=e,this.sendTo=t,this.data=n}static createSendTask(e,t,n){let i=new dS(e,t,n);return i.onstart=()=>i.initializeSend(),i}static createReceiveTask(e){let t=new dS(e);return t.onstart=()=>t.initializeReceive(),t}start(e){this.onstart?(this.data=e,this.onstart(),this.onstart=null):console.warn("\u518d\u8d77\u52d5\u3059\u308b\u4ed5\u69d8\u306a\u3069\u7121\u3044\u3002")}progress(e,t){this.onprogress&&this.onprogress(this,e,t)}finish(){this.isCanceled||(this.isCanceled=!0,this.onfinish&&this.onfinish(this,this.data),this.dispose())}timeout(){this.isCanceled||(this.isCanceled=!0,this.ontimeout&&this.ontimeout(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}cancel(){this.isCanceled||(null!=this.sendTo&&Uy.call("CANCEL_TASK_"+this.identifier,null,this.sendTo),this._cancel())}_cancel(){this.isCanceled||(this.isCanceled=!0,this.oncancel&&this.oncancel(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}dispose(){Uy.unregister(this),this.sendChankTimer&&Ag.delete(this.sendChankTimer),this.timeoutTimer&&this.timeoutTimer.clear(),this.sendChankTimer=null,this.timeoutTimer=null,this.onprogress=this.onfinish=this.ontimeout=this.oncancel=null}initializeSend(){this.uint8Array=Ug.encode(this.data);let e=Math.ceil(this.uint8Array.byteLength/this.chankSize);this.chanks=new Array(e),console.log("\u30c1\u30e3\u30f3\u30af\u5206\u5272 "+this.identifier,this.chanks.length),Uy.register(this).on("FILE_MORE_CHANK_"+this.identifier,e=>{this.sendTo===e.sendFrom&&(this.completedChankIndex=e.data,null==this.sendChankTimer&&(this.resetTimeout(),this.sendChank(this.sentChankIndex+1)))}).on("DISCONNECT_PEER",e=>{e.data.peerId===this.sendTo&&(console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,e.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,e=>{console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,e.sendFrom),this._cancel()}),this.sentChankIndex=this.completedChankIndex=0,Dg(()=>this.sendChank(0))}sendChank(e){let t=this.uint8Array.slice(e*this.chankSize,(e+1)*this.chankSize);Uy.call("FILE_SEND_CHANK_"+this.identifier,{index:e,length:this.chanks.length,chank:t},this.sendTo),this.sentChankIndex=e,this.sendChankTimer=null,this.chanks.length<=e+1?(console.log("\u30d0\u30c3\u30d5\u30a1\u9001\u4fe1\u5b8c\u4e86",this.identifier),Dg(()=>this.finish())):this.completedChankIndex+4<=e?this.resetTimeout():this.sendChankTimer=Dg(()=>{this.sendChank(this.sentChankIndex+1)})}initializeReceive(){this.resetTimeout(),this.startTime=performance.now(),this.chankReceiveCount=0,Uy.register(this).on("FILE_SEND_CHANK_"+this.identifier,e=>{this.chanks.length<1&&(this.chanks=new Array(e.data.length)),null==this.chanks[e.data.index]?(this.chankReceiveCount++,this.chanks[e.data.index]=e.data.chank,this.progress(e.data.index,e.data.length),this.chanks.length<=this.chankReceiveCount?this.finishReceive():(this.resetTimeout(),Uy.call("FILE_MORE_CHANK_"+this.identifier,e.data.index,e.sendFrom))):console.log(`already received. [${e.data.index}] <${this.identifier}>`)}).on("DISCONNECT_PEER",e=>{e.data.peerId===this.sendTo&&(console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,e.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,e=>{console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,e.sendFrom),this._cancel()})}finishReceive(){console.log("\u30d0\u30c3\u30d5\u30a1\u53d7\u4fe1\u5b8c\u4e86",this.identifier);let e=0;for(let s of this.chanks)e+=s.byteLength;let t=performance.now()-this.startTime,n=e/1024/1024/(t/1e3);console.log(`${(e/1024).toFixed(2)}KB ${(t/1e3).toFixed(2)}\u79d2 \u8ee2\u9001\u901f\u5ea6: ${n.toFixed(2)}MB/s`);let i=new Uint8Array(e),r=0;for(let s of this.chanks)i.set(s,r),r+=s.byteLength;this.data=Ug.decode(i),this.finish()}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new Gy(()=>this.timeout(),3e4)),this.timeoutTimer.reset()}}class pS{constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4}static get instance(){return pS._instance||(pS._instance=new pS),pS._instance}initialize(){console.log("AudioSharingSystem ready..."),this.destroy(),Uy.register(this).on("CONNECT_PEER",-1,e=>{e.isSendFromSelf&&(console.log("CONNECT_PEER AudioStorageService !!!",e.data.peerId),Z_.instance.synchronize())}).on("SYNCHRONIZE_AUDIO_LIST",e=>{if(e.isSendFromSelf)return;console.log("SYNCHRONIZE_AUDIO_LIST "+e.sendFrom);let t=e.data,n=[];console.log("SYNCHRONIZE_AUDIO_LIST active tasks ",this.sendTaskMap.size+this.receiveTaskMap.size);for(let r of t){let e=Z_.instance.get(r.identifier);null===e&&(e=H_.createEmpty(r.identifier),Z_.instance.add(e)),e.state<U_.COMPLETE&&!this.receiveTaskMap.has(r.identifier)&&n.push({identifier:r.identifier,state:e.state})}if(n.length<1&&!this.hasActiveTask()&&t.length<Z_.instance.getCatalog().length&&Z_.instance.synchronize(e.sendFrom),n.length<1||this.isLimitReceiveTask())return;let i=Math.floor(Math.random()*n.length);this.request([n[i]],e.sendFrom)}).on("REQUEST_AUDIO_RESOURE",e=>{if(e.isSendFromSelf)return;let t=e.data.identifiers,n=[];for(let i of t){let e=Z_.instance.get(i.identifier);e&&i.state<e.state&&n.push({identifier:i.identifier,state:i.state})}if(!1===this.isLimitSendTask()&&0<n.length&&!this.existsSendTask(e.data.receiver)){console.log("REQUEST_AUDIO_RESOURE Send!!! "+e.data.receiver+" -> "+n);let t=Math.floor(Math.random()*n.length),i=Z_.instance.get(n[t].identifier);this.startSendTask(i,e.data.receiver)}else{let t=e.data.candidatePeers,i=t.indexOf(Hy.peerId);-1<i&&t.splice(i,1);for(let n of t)return console.log("REQUEST_AUDIO_RESOURE AudioStorageService Relay!!! "+n+" -> "+e.data.identifiers),void Uy.call(e,n);console.log("REQUEST_FILE_RESOURE AudioStorageService \u3042\u3076\u308c\u305f..."+e.data.receiver,n.length)}}).on("UPDATE_AUDIO_RESOURE",e=>{let t=e.data;console.log("UPDATE_AUDIO_RESOURE AudioStorageService "+e.sendFrom+" -> ",t);for(let n of t)n.blob&&(n.blob=new Blob([n.blob],{type:n.type})),Z_.instance.add(n)}).on("START_AUDIO_TRANSMISSION",e=>{console.log("START_AUDIO_TRANSMISSION "+e.data.fileIdentifier);let t=e.data.fileIdentifier,n=Z_.instance.get(t);this.receiveTaskMap.has(t)||n&&U_.COMPLETE<=n.state?(console.warn("CANCEL_TASK_ "+t),Uy.call("CANCEL_TASK_"+t,null,e.sendFrom)):this.startReceiveTask(t)})}destroy(){Uy.unregister(this)}startSendTask(e,t){return xg(this,void 0,void 0,function*(){let n=dS.createSendTask(e.identifier,t);this.sendTaskMap.set(e.identifier,n),Uy.call("START_AUDIO_TRANSMISSION",{fileIdentifier:e.identifier},t);let i={identifier:e.identifier,name:e.name,blob:null,type:"",url:null};e.state===U_.URL?i.url=e.url:(i.blob=yield kg.readAsArrayBufferAsync(e.blob),i.type=e.blob.type),n.onfinish=()=>{this.stopSendTask(n.identifier),Z_.instance.synchronize()},n.start(i)})}startReceiveTask(e){let t=Z_.instance.get(e),n=dS.createReceiveTask(e);this.receiveTaskMap.set(e,n),n.onprogress=(e,n,i)=>{let r=t.toContext();r.name=(100*n/i).toFixed(1)+"%",t.apply(r)},n.onfinish=(e,t)=>{this.stopReceiveTask(e.identifier),t&&Uy.trigger("UPDATE_AUDIO_RESOURE",[t]),Z_.instance.synchronize()},n.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(e){let t=this.sendTaskMap.get(e);t&&t.cancel(),this.sendTaskMap.delete(e),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(e){let t=this.receiveTaskMap.get(e);t&&t.cancel(),this.receiveTaskMap.delete(e),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(e,t){console.log("requestFile() "+t);let n=Hy.peerIds;n.splice(n.indexOf(Hy.peerId),1),Uy.call("REQUEST_AUDIO_RESOURE",{identifiers:e,receiver:Hy.peerId,candidatePeers:n},t)}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(e){for(let t of this.sendTaskMap.values())if(t&&t.sendTo===e)return!0;return!1}}class fS{constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4,console.log("FileSharingSystem ready...")}static get instance(){return fS._instance||(fS._instance=new fS),fS._instance}initialize(){Uy.register(this).on("CONNECT_PEER",1,e=>{e.isSendFromSelf&&(console.log("CONNECT_PEER ImageStorageService !!!",e.data.peerId),ov.instance.synchronize())}).on("XML_LOADED",e=>{!function(e){let t=[],n=e.querySelectorAll('*[type="image"]');for(let i=0;i<n.length;i++){let e=n[i].innerHTML;!ov.instance.get(e)&&0<eC.type(e).length&&t.push(e)}n=e.querySelectorAll("*[imageIdentifier]");for(let i=0;i<n.length;i++){let e=n[i].getAttribute("imageIdentifier");!ov.instance.get(e)&&0<eC.type(e).length&&t.push(e)}for(let i of t)ov.instance.add(i)}(e.data.xmlElement)}).on("SYNCHRONIZE_FILE_LIST",e=>{if(e.isSendFromSelf)return;console.log("SYNCHRONIZE_FILE_LIST ImageStorageService "+e.sendFrom);let t=e.data,n=[];for(let i of t){let e=ov.instance.get(i.identifier);null===e&&(e=Ig.createEmpty(i.identifier),ov.instance.add(e)),e.state<Og.COMPLETE&&!this.receiveTaskMap.has(i.identifier)&&n.push({identifier:i.identifier,state:e.state})}n.length<1&&!this.hasActiveTask()&&t.length<ov.instance.getCatalog().length&&ov.instance.synchronize(e.sendFrom),n.length<1||this.isLimitReceiveTask()||this.request(n,e.sendFrom)}).on("REQUEST_FILE_RESOURE",e=>xg(this,void 0,void 0,function*(){if(e.isSendFromSelf)return;let t=e.data.identifiers,n=[];for(let e of t){let t=ov.instance.get(e.identifier);t&&e.state<t.state&&n.push({identifier:e.identifier,state:e.state})}if(!1===this.isLimitSendTask()&&0<n.length&&!this.existsSendTask(e.data.receiver)){let t=this.makeSendUpdateImages(n);console.log("REQUEST_FILE_RESOURE ImageStorageService Send!!! "+e.data.receiver+" -> "+t.length),this.startSendTask(t,e.data.receiver)}else{let t=e.data.candidatePeers,i=t.indexOf(Hy.peerId);-1<i&&t.splice(i,1);for(let n of t)return console.log("REQUEST_FILE_RESOURE ImageStorageService Relay!!! "+n+" -> "+e.data.identifiers),void Uy.call(e,n);console.log("REQUEST_FILE_RESOURE ImageStorageService \u3042\u3076\u308c\u305f..."+e.data.receiver,n.length)}})).on("UPDATE_FILE_RESOURE",e=>{let t=e.data.updateImages;console.log("UPDATE_FILE_RESOURE ImageStorageService "+e.sendFrom+" -> ",t);for(let n of t)n.blob&&(n.blob=new Blob([n.blob],{type:n.type})),n.thumbnail.blob&&(n.thumbnail.blob=new Blob([n.thumbnail.blob],{type:n.thumbnail.type})),ov.instance.add(n)}).on("START_FILE_TRANSMISSION",e=>{console.log("START_FILE_TRANSMISSION "+e.data.taskIdentifier);let t=e.data.taskIdentifier,n=ov.instance.get(t);this.receiveTaskMap.has(t)||n&&Og.COMPLETE<=n.state?(console.warn("CANCEL_TASK_ "+t),Uy.call("CANCEL_TASK_"+t,null,e.sendFrom)):this.startReceiveTask(t)})}destroy(){Uy.unregister(this)}startSendTask(e,t){return xg(this,void 0,void 0,function*(){let n=1===e.length?e[0].identifier:My.generateUuid(),i=dS.createSendTask(n,t);this.sendTaskMap.set(i.identifier,i),Uy.call("START_FILE_TRANSMISSION",{taskIdentifier:n},t);for(let t of e)t.thumbnail.blob?t.thumbnail.blob=yield kg.readAsArrayBufferAsync(t.thumbnail.blob):t.blob&&(t.blob=yield kg.readAsArrayBufferAsync(t.blob));i.onfinish=(e,t)=>{this.stopSendTask(e.identifier),ov.instance.synchronize()},i.start(e)})}startReceiveTask(e){let t=dS.createReceiveTask(e);this.receiveTaskMap.set(e,t),t.onfinish=(e,t)=>{this.stopReceiveTask(e.identifier),t&&Uy.trigger("UPDATE_FILE_RESOURE",{identifier:e.identifier,updateImages:t}),ov.instance.synchronize()},t.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(e){let t=this.sendTaskMap.get(e);t&&t.cancel(),this.sendTaskMap.delete(e),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(e){let t=this.receiveTaskMap.get(e);t&&t.cancel(),this.receiveTaskMap.delete(e),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(e,t){console.log("requestFile() "+t);let n=Hy.peerIds;n.splice(n.indexOf(Hy.peerId),1),Uy.call("REQUEST_FILE_RESOURE",{identifiers:e,receiver:Hy.peerId,candidatePeers:n},t)}makeSendUpdateImages(e,t=524288){let n=[],i=0;for(let r=e.length-1;0<=r;r--){let t=Math.floor(Math.random()*(r+1));[e[r],e[t]]=[e[t],e[r]]}e.sort((e,t)=>e.state<t.state?-1:e.state>t.state?1:0);for(let r=0;r<e.length;r++){let s=e[r],o=ov.instance.get(s.identifier),a={identifier:o.identifier,name:o.name,type:"",blob:null,url:null,thumbnail:{type:"",blob:null,url:null}};o.state===Og.URL?a.url=o.url:s.state===Og.NULL?(a.thumbnail.blob=o.thumbnail.blob,a.thumbnail.type=o.thumbnail.type):(a.blob=o.blob,a.type=o.blob.type);let l=a.blob?a.blob.size:a.thumbnail.blob?a.thumbnail.blob.size:100;if(n.push(a),i+=l,t<i)break}return n}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(e){for(let t of this.sendTaskMap.values())if(t&&t.sendTo===e)return!0;return!1}}let gS=(()=>{class e{constructor(e){this.peerId=e,this.requestMap=new Map}static create(t,n){e.tasksMap.size<1&&Uy.register(e.key).on("DISCONNECT_PEER",t=>{e.onDisconnect(t.data.peerId)}).on("UPDATE_GAME_OBJECT",t=>{t.isSendFromSelf||e.onUpdate(t.data.identifier)}).on("DELETE_GAME_OBJECT",t=>{t.isSendFromSelf||e.onUpdate(t.data.identifier)});let i=new e(t);return i.initialize(n),i}cancel(){this.timeoutTimer&&this.timeoutTimer.clear(),this.timeoutTimer=null,this.onsynchronize=this.onfinish=this.ontimeout=null;for(let e of this.requestMap.values())this.deleteTasksMap(e.identifier);this.requestMap.clear()}initialize(t){for(let n of t){n.ttl--,this.requestMap.set(n.identifier,n);let t=e.tasksMap.get(n.identifier);null==t&&(t=[]),t.push(this),e.tasksMap.set(n.identifier,t);let i=null!=this.peerId&&n.holderIds.includes(this.peerId)?this.peerId:null;Uy.call("REQUEST_GAME_OBJECT",n.identifier,i)}this.requestMap.size<1?setTimeout(()=>this.finish()):this.resetTimeout()}finish(){this.onfinish&&this.onfinish(this),this.cancel()}timeout(){this.ontimeout&&this.ontimeout(this,Array.from(this.requestMap.values()).filter(e=>0<=e.ttl)),this.finish()}static onDisconnect(t){for(let n of e.tasksMap.values())for(let e of n.concat())e.peerId===t&&e.timeout();e.tasksMap.size<1&&Uy.unregister(e.key)}static onUpdate(t){if(!e.tasksMap.has(t))return;let n=e.tasksMap.get(t);for(let e of n.concat())e.onUpdate(t);e.tasksMap.size<1&&Uy.unregister(e.key)}onUpdate(e){this.requestMap.delete(e),this.onsynchronize&&this.onsynchronize(this,e),this.requestMap.size<1?this.finish():this.resetTimeout()}deleteTasksMap(t){let n=e.tasksMap.get(t),i=n.indexOf(this);-1<i&&n.splice(i,1),n.length<1&&e.tasksMap.delete(t)}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new Gy(()=>this.timeout(),3e4)),this.timeoutTimer.reset()}}return e.key={},e.tasksMap=new Map,e})();class mS{constructor(){this.requestMap=new Map,this.peerMap=new Map,this.tasks=[]}static get instance(){return mS._instance||(mS._instance=new mS),mS._instance}initialize(){this.destroy(),console.log("ObjectSynchronizer ready..."),Uy.register(this).on("CONNECT_PEER",2,e=>{e.isSendFromSelf&&(console.log("CONNECT_PEER GameRoomService !!!",e.data.peerId),this.sendCatalog(e.data.peerId))}).on("DISCONNECT_PEER",e=>{this.removePeerMap(e.data.peerId)}).on("SYNCHRONIZE_GAME_OBJECT",e=>{if(e.isSendFromSelf)return;console.log("SYNCHRONIZE_GAME_OBJECT "+e.sendFrom);let t=e.data;for(let n of t)Vy.instance.isDeleted(n.identifier)?Uy.call("DELETE_GAME_OBJECT",{identifier:n.identifier},e.sendFrom):this.addRequestMap(n,e.sendFrom);this.synchronize()}).on("REQUEST_GAME_OBJECT",e=>{if(!e.isSendFromSelf)if(Vy.instance.isDeleted(e.data))Uy.call("DELETE_GAME_OBJECT",{identifier:e.data},e.sendFrom);else{let t=Vy.instance.get(e.data);t&&Uy.call("UPDATE_GAME_OBJECT",t.toContext(),e.sendFrom)}}).on("UPDATE_GAME_OBJECT",e=>{let t=e.data,n=Vy.instance.get(t.identifier);n?e.isSendFromSelf||this.updateObject(n,t):Vy.instance.isDeleted(t.identifier)?Uy.call("DELETE_GAME_OBJECT",{identifier:t.identifier},e.sendFrom):this.createObject(t)}).on("DELETE_GAME_OBJECT",e=>{Vy.instance.delete(e.data.identifier,!1)})}destroy(){Uy.unregister(this)}updateObject(e,t){t.majorVersion+t.minorVersion>e.version&&e.apply(t)}createObject(e){let t=Zy.instance.create(e.aliasName,e.identifier);t?(Vy.instance.add(t,!1),t.apply(e)):console.warn(e.aliasName+" is Unknown...?",e)}sendCatalog(e){let t=Vy.instance.getCatalog(),n=setInterval(()=>{Uy.call("SYNCHRONIZE_GAME_OBJECT",t.splice(0,t.length<2048?t.length:2048),e),t.length<1&&clearInterval(n)})}addRequestMap(e,t){let n=this.requestMap.get(e.identifier);n&&n.version===e.version?(n.holderIds.push(t),this.addPeerMap(t)):(!n||n.version<e.version)&&(this.requestMap.set(e.identifier,{identifier:e.identifier,version:e.version,holderIds:[t],ttl:2}),this.addPeerMap(t))}addPeerMap(e){this.peerMap.has(e)||this.peerMap.set(e,[])}removePeerMap(e){this.peerMap.delete(e)}synchronize(){for(;0<this.requestMap.size&&this.tasks.length<32;)this.runSynchronizeTask()}runSynchronizeTask(){let e=this.getTargetPeerId(),t=this.makeRequestList(e);if(t.length<1)return void this.removePeerMap(e);let n=gS.create(e,t);this.tasks.push(n);let i=this.peerMap.get(e);i&&i.push(n),n.onfinish=t=>{this.tasks.splice(this.tasks.indexOf(t),1);let n=this.peerMap.get(e);n&&n.splice(n.indexOf(t),1),this.synchronize()},n.ontimeout=(e,t)=>{console.log("GameObject synchronize \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8"),t.forEach(e=>this.requestMap.set(e.identifier,e))}}makeRequestList(e,t=32){let n=[];for(let[i,r]of this.requestMap){if(t<=n.length)break;if(!r.holderIds.includes(e))continue;let s=Vy.instance.get(r.identifier);(!s||s.version<r.version)&&n.push(r),this.requestMap.delete(i)}return n}getTargetPeerId(){let e=9999,t=null,n=Hy.peerContexts;for(let i=n.length-1;0<=i;i--){let e=Math.floor(Math.random()*(i+1));[n[i],n[e]]=[n[e],n[i]]}for(let i of n){let n=this.peerMap.get(i.peerId);i.isOpen&&n&&n.length<e&&(e=n.length,t=i.peerId)}return t}}let bS=(()=>{let e=class extends Ky{constructor(){super(...arguments),this.audioIdentifier="",this.startTime=0,this.isLoop=!1,this.isPlaying=!1,this.audioPlayer=new G_}get audio(){return Z_.instance.get(this.audioIdentifier)}onStoreAdded(){super.onStoreAdded(),this.unlockAfterUserInteraction()}onStoreRemoved(){super.onStoreRemoved(),this._stop()}play(e,t=!1){let n=Z_.instance.get(e);n&&n.isReady&&(this.audioIdentifier=e,this.isPlaying=!0,this.isLoop=t,this._play())}_play(){this._stop(),this.audio&&this.audio.isReady?(this.audioPlayer.loop=!0,this.audioPlayer.play(this.audio)):this.playAfterFileUpdate()}stop(){this.audioIdentifier="",this.isPlaying=!1,this._stop()}_stop(){this.unregisterEvent(),this.audioPlayer.stop()}playAfterFileUpdate(){Uy.register(this).on("UPDATE_AUDIO_RESOURE",-100,e=>{this._play()})}unlockAfterUserInteraction(){let e=()=>{document.body.removeEventListener("touchstart",e,!0),document.body.removeEventListener("mousedown",e,!0),this.audioPlayer.stop(),this.isPlaying&&this._play()};document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0)}unregisterEvent(){Uy.unregister(this,"UPDATE_AUDIO_RESOURE")}apply(e){let t=this.audioIdentifier,n=this.isPlaying;super.apply(e),t===this.audioIdentifier&&n||!this.isPlaying?n===this.isPlaying||this.isPlaying||this._stop():this._play()}};return Cg([nv()],e.prototype,"audioIdentifier",void 0),Cg([nv()],e.prototype,"startTime",void 0),Cg([nv()],e.prototype,"isLoop",void 0),Cg([nv()],e.prototype,"isPlaying",void 0),e=Cg([tv("jukebox")],e),e})();function yS(e,t){if(1&e&&(Io(0,"option",7),ga(1),Mo()),2&e){const e=t.$implicit;Go("value",e.identifier),Zr(1),ma(e.name)}}function vS(e,t){if(1&e&&(Io(0,"div",16),ga(1),Mo()),2&e){const e=jo(3);Zr(1),ba("",e.progresPercent,"%")}}const _S=function(e){return{"is-hidden":e}};function wS(e,t){if(1&e){const e=Fo();Po(0),Io(1,"button",2),zo("click",function(){return Ft(e),jo(2).upTabIndex()}),ga(2,"\u2191"),Mo(),Io(3,"button",2),zo("click",function(){return Ft(e),jo(2).downTabIndex()}),ga(4,"\u2193"),Mo(),Io(5,"button",11),zo("click",function(){return Ft(e),jo(2).save()}),Io(6,"div",12),Io(7,"div",13),ga(8,"\u4fdd\u5b58"),Mo(),Eo(9,vS,2,1,"div",14),Mo(),Mo(),Io(10,"button",15),zo("click",function(){return Ft(e),jo(2).delete()}),ga(11,"\u524a\u9664"),Mo(),Do()}if(2&e){const e=jo(2);Zr(5),To("disabled",e.isSaveing),Zr(2),To("ngClass",Ul(4,_S,e.isSaveing)),Zr(2),To("ngIf",e.isSaveing),Zr(1),Co("disabled",e.chatTabs.length<=1?"":null)}}function CS(e,t){if(1&e){const e=Fo();Po(0),Io(1,"button",2),zo("click",function(){return Ft(e),jo(2).restore()}),ga(2,"\u5143\u306b\u623b\u3059"),Mo(),Do()}}function xS(e,t){if(1&e){const e=Fo();Po(0),Io(1,"div"),ga(2,"\u30bf\u30d6\u540d : "),Io(3,"input",8),zo("ngModelChange",function(t){return Ft(e),jo().tabName=t}),Mo(),Mo(),Io(4,"div",9),Io(5,"label"),Io(6,"input",10),zo("ngModelChange",function(t){return Ft(e),jo().isUseStandImage=t})("change",function(){Ft(e);const t=jo();return t.isUseStandImage=!!t.isUseStandImage}),Mo(),ga(7," \u30b9\u30bf\u30f3\u30c9\u6709\u52b9 "),Mo(),Mo(),Ao(8,"hr"),Io(9,"div"),Eo(10,wS,12,6,"ng-container",6),Eo(11,CS,3,0,"ng-container",6),Mo(),Do()}if(2&e){const e=jo();Zr(3),To("ngModel",e.tabName),Co("disabled",e.isEditable?null:""),Zr(3),Go("checked",e.isUseStandImage?"checked":""),To("ngModel",e.isUseStandImage),Co("disabled",e.isEditable?null:""),Zr(4),To("ngIf",!e.isDeleted),Zr(1),To("ngIf",e.isDeleted)}}function ES(e,t){1&e&&(Po(0),Io(1,"div",17),ga(2,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b\u300d\u304b\u3089\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),Mo(),Do())}let kS=(()=>{class e{constructor(e,t,n,i){this.modalService=e,this.panelService=t,this.chatMessageService=n,this.saveDataService=i,this.selectedTab=null,this.selectedTabXml="",this.isSaveing=!1,this.progresPercent=0}get tabName(){return this.selectedTab.name}set tabName(e){this.isEditable&&(this.selectedTab.name=e)}get isUseStandImage(){return this.selectedTab.isUseStandImage}set isUseStandImage(e){this.isEditable&&(this.selectedTab.isUseStandImage=e)}get chatTabs(){return this.chatMessageService.chatTabs}get isEmpty(){return this.chatMessageService.chatTabs.length<1}get isDeleted(){return!!this.selectedTab&&null==Vy.instance.get(this.selectedTab.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u8a2d\u5b9a"),Uy.register(this).on("DELETE_GAME_OBJECT",1e3,e=>{if(!this.selectedTab||e.data.identifier!==this.selectedTab.identifier)return;let t=Vy.instance.get(e.data.identifier);null!==t&&(this.selectedTabXml=t.toXml())})}ngOnDestroy(){Uy.unregister(this)}onChangeSelectTab(e){this.selectedTab=Vy.instance.get(e),this.selectedTabXml=""}create(){pw.instance.addChatTab("\u30bf\u30d6")}save(){return xg(this,void 0,void 0,function*(){if(!this.selectedTab||this.isSaveing)return;this.isSaveing=!0,this.progresPercent=0;let e="chat_"+this.selectedTab.name;yield this.saveDataService.saveGameObjectAsync(this.selectedTab,e,e=>{this.progresPercent=e}),setTimeout(()=>{this.isSaveing=!1,this.progresPercent=0},500)})}delete(){!this.isEmpty&&this.selectedTab&&(this.selectedTabXml=this.selectedTab.toXml(),this.selectedTab.destroy())}restore(){if(this.selectedTab&&this.selectedTabXml){let e=Xy.instance.parseXml(this.selectedTabXml);pw.instance.addChatTab(e),this.selectedTabXml=""}}upTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,t=e.children.indexOf(this.selectedTab);0<t&&e.insertBefore(this.selectedTab,e.children[t-1])}downTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,t=e.children.indexOf(this.selectedTab);t<e.children.length-1&&e.insertBefore(e.children[t+1],this.selectedTab)}}return e.\u0275fac=function(t){return new(t||e)(So(xv),So(wv),So(fw),So(_C))},e.\u0275cmp=Ze({type:e,selectors:[["app-chat-tab-setting"]],decls:10,vars:4,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[3,"click"],["size","10",2,"width","10em",3,"ngModel","change"],[3,"value",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[3,"value"],["placeholder","Name",3,"ngModel","ngModelChange"],[2,"font-weight","bolder","font-size","smaller"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,t){1&e&&(Io(0,"div",0),Io(1,"div",1),Io(2,"div"),Io(3,"button",2),zo("click",function(){return t.create()}),ga(4,"\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b"),Mo(),Mo(),Io(5,"select",3),zo("change",function(e){return t.onChangeSelectTab(e.target.value)}),Eo(6,yS,2,2,"option",4),Mo(),Mo(),Io(7,"div",5),Eo(8,xS,12,7,"ng-container",6),Mo(),Mo(),Eo(9,ES,3,0,"ng-container",6)),2&e&&(Zr(5),To("ngModel",null==t.selectedTab?null:t.selectedTab.identifier),Zr(1),To("ngForOf",t.chatTabs),Zr(2),To("ngIf",!t.isEmpty&&t.selectedTab),Zr(1),To("ngIf",t.isEmpty))},directives:[Ld,sd,Sd,Vh,Zh,Bd,Vd,ju,zu,Uh],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;font-size:.9em}"]}),e})();const SS=["msgFrom"],TS=["message"],OS=function(e){return{"black-paint":e}};function IS(e,t){if(1&e&&(Ao(0,"img",16),ql(1,"safe")),2&e){const e=jo(2);To("src",$l(1,2,null==e.imageFile?null:e.imageFile.url,"resourceUrl"),Xi)("ngClass",Ul(5,OS,1==e.chatMessage.isBlackPaint))}}const MS=function(e,t){return{inverse:e,hollow:t}},AS=function(e,t,n,i,r,s,o,a){return{black:e,blue:t,green:n,cyan:i,red:r,magenta:s,yellow:o,white:a}};function PS(e,t){if(1&e&&(Io(0,"div",13),Io(1,"span",14),Eo(2,IS,2,7,"img",15),Mo(),Mo()),2&e){const e=jo();To("ngClass",Hl(3,MS,1==e.chatMessage.isInverseIcon,1==e.chatMessage.isHollowIcon)),Zr(1),To("ngClass",Zl(6,AS,0==e.chatMessage.aura,1==e.chatMessage.aura,2==e.chatMessage.aura,3==e.chatMessage.aura,4==e.chatMessage.aura,5==e.chatMessage.aura,6==e.chatMessage.aura,7==e.chatMessage.aura)),Zr(1),To("ngIf",0<(null==e.imageFile||null==e.imageFile.url?null:e.imageFile.url.length))}}function DS(e,t){1&e&&Ro(0)}function RS(e,t){if(1&e&&(Ao(0,"img",16),ql(1,"safe")),2&e){const e=jo(2);To("src",$l(1,2,null==e.imageFile?null:e.imageFile.url,"resourceUrl"),Xi)("ngClass",Ul(5,OS,1==e.chatMessage.isBlackPaint))}}function FS(e,t){if(1&e&&(Io(0,"div",13),Io(1,"span",14),Eo(2,RS,2,7,"img",15),Mo(),Mo()),2&e){const e=jo();To("ngClass",Hl(3,MS,1==e.chatMessage.isInverseIcon,1==e.chatMessage.isHollowIcon)),Zr(1),To("ngClass",Zl(6,AS,0==e.chatMessage.aura,1==e.chatMessage.aura,2==e.chatMessage.aura,3==e.chatMessage.aura,4==e.chatMessage.aura,5==e.chatMessage.aura,6==e.chatMessage.aura,7==e.chatMessage.aura)),Zr(1),To("ngIf",0<(null==e.imageFile||null==e.imageFile.url?null:e.imageFile.url.length))}}function NS(e,t){if(1&e){const e=Fo();Io(0,"button",20),zo("click",function(){return Ft(e),jo(2).discloseMessage()}),ga(1,"\u7d50\u679c\u3092\u516c\u958b"),Mo()}}const zS=function(){return{schemeMatches:!0,wwwMatches:!0,tldMatches:!1}},LS=function(e){return{urls:e,decodePercentEncoding:!1,stripPrefix:!1,email:!1,phone:!1}};function BS(e,t){if(1&e&&(Ao(0,"span",17,18),ql(2,"linky"),Eo(3,NS,2,0,"button",19)),2&e){const e=jo();ta("color",!e.chatMessage.isSpecialColor&&e.chatMessage.color&&"#ffffff"!=e.chatMessage.color?e.chatMessage.color:""),To("innerHTML",$l(2,4,e.stringUtil.escapeHtml(e.chatMessage.text),Ul(8,LS,jl(7,zS))),$i),Zr(3),To("ngIf",e.chatMessage.isSecret)}}function jS(e,t){1&e&&(Io(0,"span"),ga(1,"\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09"),Mo())}const US=function(e,t,n,i,r){return{"is-mine":e,"is-others":t,"direct-message":n,"system-message":i,"dicebot-message":r}};let HS=(()=>{class e{constructor(e,t){this.chatMessageService=e,this.modalService=t,this.imageFile=Ig.Empty,this.animeState="inactive",this.stringUtil=rv}ngOnInit(){let e=this.chatMessage.image;e&&(this.imageFile=e),this.chatMessageService.getTime()-1e4<this.chatMessage.timestamp&&(this.animeState="active")}get isMine(){return this.chatMessage.isSendFromSelf}ngAfterViewInit(){if(this.msgFromElm){const e=this.msgFromElm.nativeElement.querySelector("A[href]");if(e){const t=e.getAttribute("href");rv.validUrl(t)?t!=_v.apiUrl+"/"&&t!=_v.apiUrl||!_v.adminUrl||""==_v.adminUrl.trim()?e.addEventListener("click",e=>{e.stopPropagation(),e.preventDefault(),this.modalService.open(Iv,{url:t})},!0):(e.setAttribute("href",_v.adminUrl),e.textContent=_v.adminUrl,e.addEventListener("click",e=>{e.stopPropagation(),e.preventDefault(),this.modalService.open(Iv,{url:_v.adminUrl})},!0)):(e.removeAttribute("href"),e.removeAttribute("target"))}}this.messageElm&&this.messageElm.nativeElement.querySelectorAll("A[href]").forEach(e=>{const t=e.getAttribute("href");rv.validUrl(t)?e.addEventListener("click",e=>{e.stopPropagation(),e.preventDefault(),this.modalService.open(Iv,{url:t})},!0):(e.removeAttribute("href"),e.removeAttribute("target"))})}discloseMessage(){this.chatMessage.tag=this.chatMessage.tag.replace("secret","")}}return e.\u0275fac=function(t){return new(t||e)(So(fw),So(xv))},e.\u0275cmp=Ze({type:e,selectors:[["chat-message"]],viewQuery:function(e,t){if(1&e&&(cc(SS,1),cc(TS,1)),2&e){let e;lc(e=hc())&&(t.msgFromElm=e.first),lc(e=hc())&&(t.messageElm=e.first)}},inputs:{chatMessage:"chatMessage"},decls:20,vars:32,consts:[[1,"container"],[1,"message",3,"ngClass"],["class","image",3,"ngClass",4,"ngIf"],[1,"body"],[1,"title"],[1,"msg-name"],[1,"tip","msg-from",3,"innerHTML"],["msgFrom",""],[1,"tip","msg-timestamp"],[1,"text","msg-text"],[4,"ngIf","ngIfThen","ngIfElse"],["visible",""],["secret",""],[1,"image",3,"ngClass"],[1,"aura",3,"ngClass"],[3,"src","ngClass",4,"ngIf"],[3,"src","ngClass"],[3,"innerHTML"],["message",""],[3,"click",4,"ngIf"],[3,"click"]],template:function(e,t){if(1&e&&(Io(0,"div",0),Io(1,"div",1),Eo(2,PS,3,15,"div",2),Io(3,"div",3),Io(4,"div",4),Io(5,"span",5),ga(6),Mo(),Ao(7,"span",6,7),ql(9,"linky"),Io(10,"span",8),ga(11),ql(12,"date"),Mo(),Mo(),Io(13,"div",9),Eo(14,DS,1,0,"ng-container",10),Mo(),Mo(),Eo(15,FS,3,15,"div",2),Mo(),Mo(),Eo(16,BS,4,10,"ng-template",null,11,dc),Eo(18,jS,2,0,"ng-template",null,12,dc)),2&e){const e=ko(17),n=ko(19);Zr(1),ta("border-left-color",!t.chatMessage.isSystem||t.chatMessage.isDicebot||t.chatMessage.isCalculate?t.chatMessage.color:"#444444")("border-right-color",!t.chatMessage.isSystem||t.chatMessage.isDicebot||t.chatMessage.isCalculate?t.chatMessage.color:"#444444"),To("ngClass",function(e,t,n,i,r,s,o,a){const l=Vt()+23,c=Dt(),h=wo(c,l,n,i,r,s);return yo(c,l+4,o)||h?mo(c,l+5,t(n,i,r,s,o)):bo(c,l+5)}(0,US,t.isMine,!t.isMine,t.chatMessage.isDirect||t.chatMessage.isSecret,t.chatMessage.isSystem,t.chatMessage.isDicebot||t.chatMessage.isCalculate))("@flyInOut",t.isMine?null:"active")("@flyInOutMe",t.isMine?"active":null),Zr(1),To("ngIf",t.isMine),Zr(3),ta("color",!t.chatMessage.isSpecialColor&&t.chatMessage.color&&"#ffffff"!=t.chatMessage.color?t.chatMessage.color:""),Zr(1),ma(t.chatMessage.name),Zr(1),To("innerHTML",$l(9,17,t.stringUtil.escapeHtml("\u3000"+t.chatMessage.from),Ul(30,LS,jl(29,zS))),$i),Zr(4),ba("\u3000",$l(12,20,t.chatMessage.timestamp,"y/M/d H:mm"),""),Zr(3),To("ngIf",!t.chatMessage.isSecret||t.chatMessage.isSendFromSelf)("ngIfThen",e)("ngIfElse",n),Zr(1),To("ngIf",!t.isMine)}},directives:[Uh,Zh],pipes:[I_,eu,$_],styles:["[_nghost-%COMP%]{display:block}.container[_ngcontent-%COMP%]{width:100%;overflow-x:hidden}.message[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;box-sizing:border-box;padding:5px;width:100%;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;border-bottom:1px dotted #999}.is-mine.message[_ngcontent-%COMP%]{border-left:4px solid #555}.is-others.message[_ngcontent-%COMP%]{border-right:4px solid #555}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc;border-bottom:1px dotted #ccc}.is-mine.direct-message[_ngcontent-%COMP%]{border-left:4px solid #555}.is-others.direct-message[_ngcontent-%COMP%]{border-right:4px solid #555}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{padding:0;width:50px;height:50px;flex-shrink:0;vertical-align:top}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0;object-position:50% 0;border-radius:.5rem}.message[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{flex-grow:1}.message[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{vertical-align:top;font-size:14px;padding-left:12px;padding-right:12px}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.message[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{vertical-align:top;padding:2px 12px 0;font-size:14px}.message[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{font-size:8px;padding-left:12px}.msg-name[_ngcontent-%COMP%]{font-weight:700}.msg-text[_ngcontent-%COMP%]{white-space:pre-wrap}.dicebot-message[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%]{font-size:8px}.dicebot-message[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{color:#22f}.direct-message.dicebot-message[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{color:#ccf}.dicebot-message[_ngcontent-%COMP%]{border-left:4px transparent}.is-others[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%], .is-others[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{text-align:right}.is-others[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline-block;text-align:left;max-width:100%}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #00f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 6px #ccc) drop-shadow(0 -4px 4px #fff)}"],data:{animation:[Jd("flyInOut",[sp("* => active",[ep("200ms ease-out",rp([np({transform:"translateX(100px)",opacity:"0",offset:0}),np({transform:"translateX(0)",opacity:"1",offset:1})]))]),sp("void => *",[ep("200ms ease-out",rp([np({opacity:"0",offset:0}),np({opacity:"1",offset:1})]))])]),Jd("flyInOutMe",[sp("* => active",[ep("200ms ease-out",rp([np({transform:"translateX(-100px)",opacity:"0",offset:0}),np({transform:"translateX(0)",opacity:"1",offset:1})]))]),sp("void => *",[ep("200ms ease-out",rp([np({opacity:"0",offset:0}),np({opacity:"1",offset:1})]))])])]}}),e})();const VS=["logContainer"],GS=["messageContainer"];function ZS(e,t){1&e&&Ao(0,"chat-message",7),2&e&&To("chatMessage",jo().$implicit)}function WS(e,t){if(1&e&&(Po(0),Eo(1,ZS,1,1,"chat-message",6),Do()),2&e){const e=t.$implicit;Zr(1),To("ngIf",e.isDisplayable)}}function YS(e,t){if(1&e&&(Po(0),Eo(1,WS,2,1,"ng-container",5),Do()),2&e){const e=jo();Zr(1),To("ngForOf",e.chatMessages)("ngForTrackBy",e.trackByChatMessage)}}function qS(e,t){1&e&&Ao(0,"chat-message",7),2&e&&To("chatMessage",t.$implicit)}function $S(e,t){if(1&e&&(Po(0),Eo(1,qS,1,1,"chat-message",8),Do()),2&e){const e=jo();Zr(1),To("ngForOf",e.sampleMessages)}}const XS=window.navigator.userAgent.toLowerCase(),KS=XS.indexOf("iphone")>-1||XS.indexOf("ipad")>-1||XS.indexOf("macintosh")>-1&&"ontouchend"in document;let QS=(()=>{class e{constructor(e,t,n){this.ngZone=e,this.changeDetector=t,this.panelService=n,this.sampleMessages=[{from:"System",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u30b5\u30fc\u30d0\u30fc\u3092\u4f7f\u7528\u3057\u306a\u3044TRPG\u30aa\u30f3\u30bb\u30c4\u30fc\u30eb\u3067\u3059\u3002\u53c2\u52a0\u8005\u540c\u58eb\u3067\u63a5\u7d9a\u3057\u3001\u30b3\u30de\u3084\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u306a\u3069\u3092\u540c\u671f\u3057\u307e\u3059\u3002"},{from:"System",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u5168\u3066\u306e\u30c7\u30fc\u30bf\u304c\u5404\u53c2\u52a0\u8005\u306e\u30d6\u30e9\u30a6\u30b6\u5185\u306b\u3042\u308b\u305f\u3081\u3001\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3092\u5b9f\u884c\u3057\u3066\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u3092\u751f\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u4fdd\u5b58\u3057\u305fzip\u306e\u8aad\u307f\u8fbc\u307f\u306f\u30d6\u30e9\u30a6\u30b6\u753b\u9762\u3078\u306e\u30d5\u30a1\u30a4\u30eb\u30c9\u30ed\u30c3\u30d7\u3067\u884c\u3048\u307e\u3059\u3002"},{from:"System",to:"???",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb \u27a1 \u30d7\u30ec\u30a4\u30e4\u30fc",text:"\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\uff08\u79d8\u5bc6\u4f1a\u8a71\uff09\u306f\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\u306b\u8a18\u9332\u3055\u308c\u307e\u305b\u3093\u3002"},{from:"System",to:"???",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb \u27a1 \u30d7\u30ec\u30a4\u30e4\u30fc",text:"\u307e\u305f\u3001\u904e\u53bb\u306e\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u3042\u306a\u305f\u306eID\u304c\u66f4\u65b0\u3055\u308c\u308b\u3068\u540c\u3058\u30eb\u30fc\u30e0\u5185\u3067\u3042\u3063\u3066\u3082\u898b\u3048\u306a\u304f\u306a\u308a\u307e\u3059\u3002\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002"},{from:"System",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u52d5\u4f5c\u63a8\u5968\u74b0\u5883\u306f\u30c7\u30b9\u30af\u30c8\u30c3\u30d7Chrome\u3067\u3059\u3002\u4eca\u306e\u3068\u3053\u308d\u3001\u30b9\u30de\u30db\u304b\u3089\u3060\u3068\u4e0a\u624b\u304f\u64cd\u4f5c\u3067\u304d\u307e\u305b\u3093\u3002"},{from:"System",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u4ee5\u4e0a\u3067\u3059\u3002\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u6700\u521d\u306e\u30c1\u30e3\u30c3\u30c8\u3092\u5165\u529b\u3059\u308b\u3068\u975e\u8868\u793a\u306b\u306a\u308a\u307e\u3059\u3002"}],this.topTimestamp=0,this.botomTimestamp=0,this.needUpdate=!0,this.topElm=null,this.bottomElm=null,this.topElmBox=null,this.bottomElmBox=null,this.topIndex=0,this.bottomIndex=0,this.minMessageHeight=61,this.preScrollTop=0,this.scrollSpeed=0,this._chatMessages=[],this.scrollEventShortTimer=null,this.scrollEventLongTimer=null,this.addMessageEventTimer=null,this.callbackOnScroll=()=>this.onScroll(),this.callbackOnScrollToBottom=()=>this.resetMessages(),this.onAddMessage=new Xl}get chatMessages(){if(!this.chatTab)return[];if(this.needUpdate){this.needUpdate=!1;let e=this.chatTab?this.chatTab.chatMessages:[];this.adjustIndex(),this._chatMessages=e.slice(this.topIndex,this.bottomIndex+1),this.topTimestamp=0<this._chatMessages.length?this._chatMessages[0].timestamp:0,this.botomTimestamp=0<this._chatMessages.length?this._chatMessages[this._chatMessages.length-1].timestamp:0}return this._chatMessages}get minScrollHeight(){let e=this.chatTab?this.chatTab.chatMessages.length:this.sampleMessages.length;return(e<1e4?e:1e4)*this.minMessageHeight}get topSpace(){return this.minScrollHeight-this.bottomSpace}get bottomSpace(){return 0<this.chatMessages.length?(this.chatTab.chatMessages.length-this.bottomIndex-1)*this.minMessageHeight:0}ngOnInit(){let e=[];for(let t of this.sampleMessages){let n=new hw;for(let e in t)"identifier"!==e&&"tabIdentifier"!==e&&("text"!==e?null!=t[e]&&""!==t[e]&&n.setAttribute(e,t[e]):n.value=t[e]);e.push(n)}this.sampleMessages=e,Uy.register(this).on("MESSAGE_ADDED",e=>{let t=Vy.instance.get(e.data.messageIdentifier);t&&this.chatTab.contains(t)&&this.topTimestamp<=t.timestamp&&(this.changeDetector.markForCheck(),this.needUpdate=!0,this.onMessageInit())}).on("UPDATE_GAME_OBJECT",e=>{let t=Vy.instance.get(e.data.identifier);t&&t instanceof hw&&this.topTimestamp<=t.timestamp&&t.timestamp<=this.botomTimestamp&&this.chatTab.contains(t)&&this.changeDetector.markForCheck()})}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.scrollEventShortTimer=new Gy(()=>this.lazyScrollUpdate(),33),this.scrollEventLongTimer=new Gy(()=>this.lazyScrollUpdate(!1),66),this.onScroll(),this.panelService.scrollablePanel.addEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.addEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1)})}ngOnDestroy(){Uy.unregister(this),this.panelService.scrollablePanel.removeEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.removeEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1),this.scrollEventShortTimer.clear(),this.scrollEventLongTimer.clear(),this.addMessageEventTimer&&clearTimeout(this.addMessageEventTimer),this.addMessageEventTimer=null}ngOnChanges(){Promise.resolve().then(()=>this.resetMessages())}ngAfterViewChecked(){this.topElm&&this.bottomElm&&this.ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>this.adjustScrollPosition())})}onMessageInit(){null==this.addMessageEventTimer&&this.ngZone.runOutsideAngular(()=>{this.addMessageEventTimer=setTimeout(()=>{this.addMessageEventTimer=null,this.ngZone.run(()=>this.onAddMessage.emit())},0)})}resetMessages(){let e=this.chatTab.chatMessages.length-1;this.topIndex=e-Math.floor(this.panelService.scrollablePanel.clientHeight/this.minMessageHeight),this.bottomIndex=e,this.needUpdate=!0,this.preScrollTop=-1,this.scrollSpeed=0,this.topElm=this.bottomElm=null,this.adjustIndex(),this.changeDetector.markForCheck()}trackByChatMessage(e,t){return t.identifier}adjustIndex(){let e=this.chatTab?this.chatTab.chatMessages:[],t=0<e.length?e.length-1:0;this.topIndex<0&&(this.topIndex=0),t<this.bottomIndex&&(this.bottomIndex=t),this.topIndex<0&&(this.topIndex=0),this.bottomIndex<0&&(this.bottomIndex=0),t<this.topIndex&&(this.topIndex=t),t<this.bottomIndex&&(this.bottomIndex=t)}getScrollPosition(){let e=this.panelService.scrollablePanel.scrollTop,t=this.panelService.scrollablePanel.clientHeight,n=this.panelService.scrollablePanel.scrollHeight;return e<0&&(e=0),n-t<e&&(e=n-t),{top:e,bottom:e+t,clientHeight:t,scrollHeight:n}}adjustScrollPosition(){if(!this.topElm||!this.bottomElm)return;let e=this.logContainerRef.nativeElement.contains(this.topElm),t=this.logContainerRef.nativeElement.contains(this.bottomElm),{hasTopBlank:n,hasBotomBlank:i}=this.checkBlank(e,t);this.topElm=this.bottomElm=null,(n||i||!e&&!t)&&Dg(()=>this.lazyScrollUpdate())}checkBlank(e,t){let n=!e,i=!t;if(!e&&!t)return{hasTopBlank:n,hasBotomBlank:i};let r=null,s=null,o=null,a=0;t?(r=this.bottomElm,s=this.bottomElmBox):e&&(r=this.topElm,s=this.topElmBox),o=r.getBoundingClientRect(),a=s.top-o.top-this.scrollSpeed,n&&i||!(Math.pow(.5,2)<Math.pow(a,2))||(this.panelService.scrollablePanel.scrollTop-=a);let l=this.logContainerRef.nativeElement.getBoundingClientRect(),c=this.messageContainerRef.nativeElement.getBoundingClientRect(),h=c.top-l.top,u=h+c.height,d=this.getScrollPosition();return n=d.top<h,i=u<d.bottom&&d.bottom<d.scrollHeight,{hasTopBlank:n,hasBotomBlank:i}}markForReadIfNeeded(){if(!this.chatTab.hasUnread)return;let e=this.getScrollPosition();e.scrollHeight<=e.bottom+100&&Dg(()=>{this.chatTab.markForRead(),this.changeDetector.markForCheck(),this.ngZone.run(()=>{})})}onScroll(){this.scrollEventShortTimer.reset(),this.scrollEventLongTimer.isActive||this.scrollEventLongTimer.reset()}lazyScrollUpdate(e=!0){this.scrollEventShortTimer.stop(),this.scrollEventLongTimer.stop();let t=this.messageContainerRef.nativeElement.querySelectorAll("chat-message"),n=this.messageContainerRef.nativeElement.offsetTop,i=n+this.messageContainerRef.nativeElement.clientHeight,r=this.topIndex,s=this.bottomIndex,o=this.getScrollPosition();this.scrollSpeed=o.top-this.preScrollTop,this.preScrollTop=o.top;let a=o.top<n,l=i<o.bottom&&o.bottom<o.scrollHeight;if(e||this.scrollEventShortTimer.reset(),!e&&!a&&!l)return;let c=o.top-(!e&&a?100:1200),h=o.bottom+(!e&&l?100:1200);this.markForReadIfNeeded(),this.calcItemIndexRange(n,i,c,h,o,t),(this.topIndex!=r||this.bottomIndex!=s)&&(this.needUpdate=!0,this.topElm=t[0],this.bottomElm=t[t.length-1],this.topElmBox=this.topElm.getBoundingClientRect(),this.bottomElmBox=this.bottomElm.getBoundingClientRect(),Dg(()=>{let e=this.getScrollPosition();this.scrollSpeed=e.top-this.preScrollTop,this.preScrollTop=e.top,this.changeDetector.markForCheck(),this.ngZone.run(()=>{})}))}calcElementMaxHeight(e){let t=this.minMessageHeight;for(let n=e.length-1;0<=n;n--){let i=e[n].clientHeight;t<i&&(t=i)}return t}calcItemIndexRange(e,t,n,i,r,s){if(n>=t||e>=i)this.bottomIndex=this.chatTab.chatMessages.length-1-Math.floor((r.scrollHeight-r.top-r.clientHeight)/this.minMessageHeight),this.topIndex=this.bottomIndex-Math.floor(r.clientHeight/this.minMessageHeight),this.bottomIndex+=1,this.topIndex-=1;else{let r=this.calcElementMaxHeight(s);n<e?this.topIndex-=Math.floor((e-n)/r)+1:n>e&&(KS||(this.topIndex+=Math.floor((n-e)/r))),t>i?KS||(this.bottomIndex-=Math.floor((t-i)/r)):t<i&&(this.bottomIndex+=Math.floor((i-t)/r)+1)}this.adjustIndex()}}return e.\u0275fac=function(t){return new(t||e)(So(Rc),So(fl),So(wv))},e.\u0275cmp=Ze({type:e,selectors:[["chat-tab"]],viewQuery:function(e,t){if(1&e&&(cc(VS,3),cc(GS,3)),2&e){let e;lc(e=hc())&&(t.logContainerRef=e.first),lc(e=hc())&&(t.messageContainerRef=e.first)}},inputs:{chatTab:"chatTab"},outputs:{onAddMessage:"onAddMessage"},features:[ht],decls:6,vars:6,consts:[[1,"log"],["logContainer",""],[1,"virtual-scroll-container"],["messageContainer",""],[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"chatMessage",4,"ngIf"],[3,"chatMessage"],[3,"chatMessage",4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(Io(0,"div",0,1),Io(2,"div",2,3),Eo(4,YS,2,2,"ng-container",4),Eo(5,$S,2,1,"ng-container",4),Mo(),Mo()),2&e&&(ta("min-height",t.minScrollHeight,"px"),Zr(2),ta("margin-bottom",t.bottomSpace,"px"),Zr(2),To("ngIf",0<t.chatMessages.length),Zr(1),To("ngIf",t.chatMessages.length<=0))},directives:[Zh,Vh,HS],styles:[".log[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:flex-end;align-items:flex-end;width:100%;height:100%}.virtual-scroll-container[_ngcontent-%COMP%]{flex-shrink:0;width:100%}"],changeDetection:0}),e})();function JS(e,t){if(1&e){const e=Fo();Io(0,"chat-tab",10),zo("onAddMessage",function(){return Ft(e),jo().scrollToBottom()}),Mo()}2&e&&To("chatTab",jo().chatTab)}function eT(e,t){1&e&&(Io(0,"div"),ga(1,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u306e\u5185\u5bb9\u304c\u66f4\u65b0\u3055\u308c\u307e\u3057\u305f\u3002\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u9078\u629e\u3057\u306a\u304a\u3059\u304b\u3001\u3053\u306e\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u958b\u304d\u306a\u304a\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),Mo())}function tT(e,t){1&e&&Ao(0,"badge",13),2&e&&To("count",jo().$implicit.unreadLength)}function nT(e,t){if(1&e){const e=Fo();Io(0,"label"),Io(1,"input",11),zo("ngModelChange",function(t){return Ft(e),jo().chatTabidentifier=t}),Mo(),Io(2,"div"),ga(3),Eo(4,tT,1,1,"badge",12),Mo(),Mo()}if(2&e){const e=t.$implicit,n=jo();Zr(1),Go("value",e.identifier),To("ngModel",n.chatTabidentifier),Zr(2),ma(e.name),Zr(1),To("ngIf",e.hasUnread)}}let iT=(()=>{class e{constructor(e,t,n){this.chatMessageService=e,this.panelService=t,this.pointerDeviceService=n,this.sendFrom="Guest",this._chatTabidentifier="",this.isAutoScroll=!0,this.scrollToBottomTimer=null}get gameType(){return this.chatMessageService.gameType}set gameType(e){this.chatMessageService.gameType=e}get chatTabidentifier(){return this._chatTabidentifier}set chatTabidentifier(e){let t=this._chatTabidentifier!==e;this._chatTabidentifier=e,this.updatePanelTitle(),t&&this.scrollToBottom(!0)}get chatTab(){return Vy.instance.get(this.chatTabidentifier)}ngOnInit(){this.sendFrom=av.myCursor.identifier,this._chatTabidentifier=0<this.chatMessageService.chatTabs.length?this.chatMessageService.chatTabs[0].identifier:"",Uy.register(this).on("MESSAGE_ADDED",e=>{if(e.data.tabIdentifier!==this.chatTabidentifier)return;let t=Vy.instance.get(e.data.messageIdentifier);t&&t.isSendFromSelf?this.isAutoScroll=!0:this.checkAutoScroll(),this.isAutoScroll&&this.chatTab&&this.chatTab.markForRead()}),Promise.resolve().then(()=>this.updatePanelTitle())}ngAfterViewInit(){this.scrollToBottom(!0)}ngOnDestroy(){Uy.unregister(this)}scrollToBottom(e=!1){e&&(this.isAutoScroll=!0),null==this.scrollToBottomTimer&&this.isAutoScroll&&(this.scrollToBottomTimer=setTimeout(()=>{if(this.chatTab&&this.chatTab.markForRead(),this.scrollToBottomTimer=null,this.isAutoScroll=!1,this.panelService.scrollablePanel){this.panelService.scrollablePanel.scrollTop=this.panelService.scrollablePanel.scrollHeight;let e=new CustomEvent("scrolltobottom",{});this.panelService.scrollablePanel.dispatchEvent(e)}},0))}checkAutoScroll(){this.panelService.scrollablePanel&&(this.isAutoScroll=this.panelService.scrollablePanel.scrollHeight-this.panelService.scrollablePanel.clientHeight-150<=this.panelService.scrollablePanel.scrollTop)}updatePanelTitle(){this.panelService.title=this.chatTab?"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6 - "+this.chatTab.name:"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6"}onSelectedTab(e){this.updatePanelTitle()}showTabSetting(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(kS,{left:e.x-250,top:e.y-175,width:500,height:350}).selectedTab=this.chatTab}sendChat(e){this.chatTab&&this.chatMessageService.sendMessage(this.chatTab,e.text,e.gameType,e.sendFrom,e.sendTo,e.color,e.isInverse,e.isHollow,e.isBlackPaint,e.aura,e.isUseFaceIcon,e.characterIdentifier,e.standIdentifier,e.standName,e.isUseStandImage)}trackByChatTab(e,t){return t.identifier}}return e.\u0275fac=function(t){return new(t||e)(So(fw),So(wv),So(Kw))},e.\u0275cmp=Ze({type:e,selectors:[["chat-window"]],decls:13,vars:7,consts:[[1,"component"],[1,"log"],[3,"chatTab","onAddMessage",4,"ngIf"],[4,"ngIf"],[1,"sticky-bottom"],[1,"chat-tab"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[3,"chatTabidentifier","gameType","sendFrom","gameTypeChange","sendFromChange","chat"],[3,"chatTab","onAddMessage"],["name","chat-tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],["class","badge",3,"count",4,"ngIf"],[1,"badge",3,"count"]],template:function(e,t){1&e&&(Io(0,"div",0),Io(1,"div",1),Eo(2,JS,1,1,"chat-tab",2),Eo(3,eT,2,0,"div",3),Mo(),Io(4,"div",4),Io(5,"form"),Io(6,"div",5),Eo(7,nT,5,4,"label",6),Io(8,"button",7),zo("click",function(){return t.showTabSetting()}),Io(9,"i",8),ga(10,"settings"),Mo(),ga(11,"\u30bf\u30d6\u8a2d\u5b9a"),Mo(),Mo(),Mo(),Io(12,"chat-input",9),zo("gameTypeChange",function(e){return t.gameType=e})("sendFromChange",function(e){return t.sendFrom=e})("chat",function(e){return t.sendChat(e)}),Mo(),Mo(),Mo()),2&e&&(Zr(2),To("ngIf",t.chatTab),Zr(1),To("ngIf",!t.chatTab),Zr(4),To("ngForOf",t.chatMessageService.chatTabs)("ngForTrackBy",t.trackByChatTab),Zr(5),To("chatTabidentifier",t.chatTabidentifier)("gameType",t.gameType)("sendFrom",t.sendFrom))},directives:[Zh,Td,od,xd,Vh,iS,QS,Dd,ju,sd,Sd,wg],styles:[".loop-anime[_ngcontent-%COMP%]{-webkit-animation:anime1 1.3s ease-in-out infinite;animation:anime1 1.3s ease-in-out infinite}.component[_ngcontent-%COMP%]{min-height:100%;display:flex;flex-direction:column;justify-content:space-between;align-content:space-between}.sticky-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;width:100%;background-color:rgba(240,218,189,.8);border-top:1px dotted #666;margin-bottom:0}.chat-tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:1px solid #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:1px solid #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:1px solid #555;padding:2px 4px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:1px solid #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}"]}),e})();const rT=["root"],sT=["altitudeSlider"];function oT(e,t){if(1&e){const e=Fo();Io(0,"span",12),ga(1," (\u9ad8\u5ea6 "),Io(2,"input",13),zo("ngModelChange",function(t){return Ft(e),jo(2).altitudeHande.altitude=t}),Mo(),ga(3,")"),Mo()}if(2&e){const e=jo(2);Zr(2),To("ngModel",e.altitudeHande.altitude)}}function aT(e,t){if(1&e&&(Io(0,"div"),Io(1,"div",10),ga(2),Eo(3,oT,4,1,"span",11),Mo(),Mo()),2&e){const e=jo();Zr(1),ta("color",e.titleColor)("font-weight",e.titleBold?"bolder":"normal"),Zr(1),ma(e.title),Zr(1),To("ngIf",e.altitudeHande)}}function lT(e,t){1&e&&(Io(0,"div",14),Io(1,"div",15),ga(2,"\u9ad8"),Mo(),Io(3,"div",16),ga(4,"0"),Mo(),Io(5,"div",17),ga(6,"\u4f4e"),Mo(),Mo())}function cT(e,t){if(1&e){const e=Fo();Io(0,"div",18),Io(1,"input",19,20),zo("ngModelChange",function(t){return Ft(e),jo().altitudeHande.altitude=t}),Mo(),Mo()}if(2&e){const e=jo();Zr(1),Go("title",e.altitudeHande.altitude),To("ngModel",e.altitudeHande.altitude)}}function hT(e,t){1&e&&Ro(0)}const uT=function(e){return{action:e}};function dT(e,t){if(1&e&&(Po(0),Eo(1,hT,1,0,"ng-container",21),Do()),2&e){const e=jo().$implicit;jo();const t=ko(12),n=ko(10);Zr(1),To("ngTemplateOutlet","separator"===(null==e?null:e.type)?t:n)("ngTemplateOutletContext",Ul(2,uT,e))}}function pT(e,t){if(1&e&&(Po(0),Eo(1,dT,2,4,"ng-container",2),Do()),2&e){const e=t.$implicit;Zr(1),To("ngIf",e)}}function fT(e,t){1&e&&(Io(0,"span",41),ga(1,"\u26a0\ufe0f"),Mo()),2&e&&Go("title",jo().action.error)}function gT(e,t){1&e&&Ao(0,"input",42),2&e&&To("disabled",jo().action.disabled)}function mT(e,t){1&e&&Ao(0,"input",43),2&e&&To("disabled",jo().action.disabled)}function bT(e,t){1&e&&Ao(0,"input",44),2&e&&To("disabled",jo().action.disabled)}function yT(e,t){1&e&&Ao(0,"input",45),2&e&&To("disabled",jo().action.disabled)}function vT(e,t){1&e&&(Io(0,"span",46),ga(1,"\u25a0"),Mo())}function _T(e,t){1&e&&(Io(0,"span",47),ga(1,"\u25a0"),Mo())}function wT(e,t){1&e&&(Io(0,"span",48),ga(1,"\u25a0"),Mo())}function CT(e,t){1&e&&(Io(0,"span",49),ga(1,"\u25a0"),Mo())}function xT(e,t){1&e&&(Io(0,"span",50),ga(1,"\u25a0"),Mo())}function ET(e,t){1&e&&(Io(0,"span",51),ga(1,"\u25a0"),Mo())}function kT(e,t){1&e&&(Io(0,"span",52),ga(1,"\u25a0"),Mo())}function ST(e,t){1&e&&(Io(0,"span",53),ga(1,"\u25a0"),Mo())}function TT(e,t){if(1&e&&(Io(0,"span",54),Io(1,"i",55),ga(2),Mo(),Mo()),2&e){const e=jo().action;Zr(2),ma(e.materialIcon)}}function OT(e,t){if(1&e&&(Io(0,"span",56),Ao(1,"img",57),ql(2,"safe"),Mo()),2&e){const e=jo().action;Zr(1),To("src",$l(2,1,e.icon.url,"resourceUrl"),Xi)}}function IT(e,t){1&e&&(Io(0,"div",58),Io(1,"i",59),ga(2,"arrow_forward_ios"),Mo(),Mo())}function MT(e,t){if(1&e&&Ao(0,"context-menu",60),2&e){const e=jo().action,t=jo();To("title",e.name)("actions",t.subMenu)("isSubmenu",!0)}}const AT=function(e,t){return{hasHighlight:e,disabled:t}},PT=function(e,t){return{"icon-menu":e,default:t}};function DT(e,t){if(1&e){const e=Fo();Io(0,"li",22),zo("click",function(){Ft(e);const n=t.action,i=jo();return!(n.disabled||n.altitudeHande&&0==n.altitudeHande.altitude)&&i.doAction(n)})("mouseenter",function(){Ft(e);const n=t.action,i=jo();return!(n.disabled||n.altitudeHande&&0==n.altitudeHande.altitude)&&i.showSubMenu(n)}),Io(1,"div",23),Eo(2,fT,2,1,"span",24),Eo(3,gT,1,1,"input",25),Eo(4,mT,1,1,"input",26),Eo(5,bT,1,1,"input",27),Eo(6,yT,1,1,"input",28),Eo(7,vT,2,0,"span",29),Eo(8,_T,2,0,"span",30),Eo(9,wT,2,0,"span",31),Eo(10,CT,2,0,"span",32),Eo(11,xT,2,0,"span",33),Eo(12,ET,2,0,"span",34),Eo(13,kT,2,0,"span",35),Eo(14,ST,2,0,"span",36),Eo(15,TT,3,1,"span",37),ga(16),Eo(17,OT,3,4,"span",38),Mo(),Eo(18,IT,3,0,"div",39),Eo(19,MT,1,3,"context-menu",40),Mo()}if(2&e){const e=t.action,n=jo();To("ngClass",Hl(20,AT,!(e.disabled||e.icon||e.altitudeHande&&0==e.altitudeHande.altitude),e.disabled||e.altitudeHande&&0==e.altitudeHande.altitude)),Zr(1),To("ngClass",Hl(23,PT,e.icon,e.default)),Zr(1),To("ngIf",e.error),Zr(1),To("ngIf",e.name&&0==e.name.indexOf("\u2611")),Zr(1),To("ngIf",e.name&&0==e.name.indexOf("\u2610")),Zr(1),To("ngIf",e.name&&0==e.name.indexOf("\u25c9")),Zr(1),To("ngIf",e.name&&0==e.name.indexOf("\u25cb")),Zr(1),To("ngIf",e.name&&2==e.name.indexOf("\u30d6\u30e9\u30c3\u30af")),Zr(1),To("ngIf",e.name&&2==e.name.indexOf("\u30d6\u30eb\u30fc")),Zr(1),To("ngIf",e.name&&2==e.name.indexOf("\u30b0\u30ea\u30fc\u30f3")),Zr(1),To("ngIf",e.name&&2==e.name.indexOf("\u30b7\u30a2\u30f3")),Zr(1),To("ngIf",e.name&&2==e.name.indexOf("\u30ec\u30c3\u30c9")),Zr(1),To("ngIf",e.name&&2==e.name.indexOf("\u30de\u30bc\u30f3\u30bf")),Zr(1),To("ngIf",e.name&&2==e.name.indexOf("\u30a4\u30a8\u30ed\u30fc")),Zr(1),To("ngIf",e.name&&2==e.name.indexOf("\u30db\u30ef\u30a4\u30c8")),Zr(1),To("ngIf",e.materialIcon),Zr(1),ba(" ",e.name.replace("\u2611","").replace("\u2610","").replace("\u25c9","").replace("\u25cb","")," "),Zr(1),To("ngIf",e.icon&&0<(null==e.icon?null:e.icon.url.length)),Zr(1),To("ngIf",e.subActions&&!e.disabled),Zr(1),To("ngIf",n.subMenu&&n.parentMenu===e)}}function RT(e,t){1&e&&(Io(0,"li"),Ao(1,"hr",61),Mo())}const FT=function(e,t,n,i){return{"icons-panel":e,"submenu-panel":t,"is-max-limit":n,"pointer-events-none":i}};let NT=(()=>{class e{constructor(e,t,n){this.elementRef=e,this.contextMenuService=t,this.pointerDeviceService=n,this.title="",this.actions=[],this.titleColor=av.CHAT_DEFAULT_COLOR,this.titleBold=!1,this.isSubmenu=!1,this.callbackOnOutsideClick=e=>this.onOutsideClick(e)}get isPointerDragging(){return this.pointerDeviceService.isDragging}get altitudeHande(){for(let e of this.actions)if(e&&e.altitudeHande)return e.altitudeHande;return null}get isIconsMenu(){for(let e of this.actions)if(!e||!e.icon)return!1;return!0}ngOnInit(){this.isSubmenu||(this.title=this.contextMenuService.title,this.actions=this.contextMenuService.actions,this.titleColor=this.contextMenuService.titleColor,this.titleBold=this.contextMenuService.titleBold)}ngAfterViewInit(){this.isSubmenu?this.adjustPositionSub():(this.adjustPositionRoot(),document.addEventListener("touchstart",this.callbackOnOutsideClick,!0),document.addEventListener("mousedown",this.callbackOnOutsideClick,!0))}ngOnDestroy(){document.removeEventListener("touchstart",this.callbackOnOutsideClick,!0),document.removeEventListener("mousedown",this.callbackOnOutsideClick,!0)}onOutsideClick(e){!1===this.rootElementRef.nativeElement.contains(e.target)&&this.close()}onContextMenu(e){e.stopPropagation(),e.preventDefault()}adjustPositionRoot(){let e=this.rootElementRef.nativeElement;e.style.left=this.contextMenuService.position.x+"px",e.style.top=this.contextMenuService.position.y+"px";let t=e.getBoundingClientRect(),n=0,i=0;window.innerWidth<t.right+n&&(n+=window.innerWidth-(t.right+n)),t.left+n<0&&(n+=0-(t.left+n)),window.innerHeight<t.bottom+i&&(i+=window.innerHeight-(t.bottom+i)),t.top+i<0&&(i+=0-(t.top+i)),e.style.left=e.offsetLeft+n+"px",e.style.top=e.offsetTop+i+"px",this.altitudeSlider&&(this.altitudeSlider.nativeElement.style.height=e.clientHeight-72+"px")}adjustPositionSub(){let e=this.rootElementRef.nativeElement,t=this.elementRef.nativeElement.parentElement.getBoundingClientRect(),n=e.getBoundingClientRect(),i=0,r=0;window.innerWidth<n.right+i&&(i-=t.width+n.width,i+=8),n.left+i<0&&(i+=0-(n.left+i)),window.innerHeight<n.bottom+r&&(r+=window.innerHeight-(n.bottom+r)),n.top+r<0&&(r+=0-(n.top+r)),e.style.left=e.offsetLeft+i+"px",e.style.top=e.offsetTop+r+"px"}doAction(e){this.showSubMenu(e),null!=e.action&&(e.action(),this.close())}showSubMenu(e){this.hideSubMenu(),clearTimeout(this.showSubMenuTimer),null==e.subActions||e.subActions.length<1||(this.showSubMenuTimer=setTimeout(()=>{this.parentMenu=e,this.subMenu=e.subActions,clearTimeout(this.hideSubMenuTimer)},250))}hideSubMenu(){clearTimeout(this.hideSubMenuTimer),this.hideSubMenuTimer=setTimeout(()=>{this.subMenu=null},1200)}close(){this.contextMenuService&&this.contextMenuService.close()}}return e.\u0275fac=function(t){return new(t||e)(So(Ha),So(j_),So(Kw))},e.\u0275cmp=Ze({type:e,selectors:[["context-menu"]],viewQuery:function(e,t){if(1&e&&(cc(rT,3),cc(sT,1)),2&e){let e;lc(e=hc())&&(t.rootElementRef=e.first),lc(e=hc())&&(t.altitudeSlider=e.first)}},hostBindings:function(e,t){1&e&&zo("contextmenu",function(e){return t.onContextMenu(e)})},inputs:{title:"title",actions:"actions",titleColor:"titleColor",titleBold:"titleBold",isSubmenu:"isSubmenu"},decls:13,vars:10,consts:[[1,"component",2,"display","flex","flex-direction","column",3,"ngClass","mouseleave"],["root",""],[4,"ngIf"],[2,"display","flex","align-items","center"],["class","altitude ruler","style","display: flex; align-self: stretch; flex-direction: column; align-content: center",4,"ngIf"],["class","altitude",4,"ngIf"],[2,"flex-grow","1"],[4,"ngFor","ngForOf"],["actionMenu",""],["separator",""],[1,"title"],["style","font-size: small;",4,"ngIf"],[2,"font-size","small"],["type","number","step","0.1",2,"font-size","small","width","3.6em","text-align","right",3,"ngModel","ngModelChange"],[1,"altitude","ruler",2,"display","flex","align-self","stretch","flex-direction","column","align-content","center"],[2,"margin-top","2em"],[2,"align-self","center","margin-top","auto","margin-bottom","auto"],[2,"margin-bottom","2em"],[1,"altitude"],["type","range","max","12","min","-12","step","0.5","orient","vertical",1,"altitude",3,"title","ngModel","ngModelChange"],["altitudeSlider",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngClass","click","mouseenter"],[1,"menu-title",3,"ngClass"],[3,"title",4,"ngIf"],["type","checkbox","checked","",3,"disabled",4,"ngIf"],["type","checkbox",3,"disabled",4,"ngIf"],["type","radio","checked","",3,"disabled",4,"ngIf"],["type","radio",3,"disabled",4,"ngIf"],["class","color-indicator","style","color: #000",4,"ngIf"],["class","color-indicator","style","color: #00f",4,"ngIf"],["class","color-indicator","style","color: #0f0",4,"ngIf"],["class","color-indicator","style","color: #0ff",4,"ngIf"],["class","color-indicator","style","color: #f00",4,"ngIf"],["class","color-indicator","style","color: #f0f",4,"ngIf"],["class","color-indicator","style","color: #ff0",4,"ngIf"],["class","color-indicator","style","color: #fff",4,"ngIf"],["style","vertical-align: top",4,"ngIf"],["class","imagebox",4,"ngIf"],["class","sub-menu-arrow",4,"ngIf"],[3,"title","actions","isSubmenu",4,"ngIf"],[3,"title"],["type","checkbox","checked","",3,"disabled"],["type","checkbox",3,"disabled"],["type","radio","checked","",3,"disabled"],["type","radio",3,"disabled"],[1,"color-indicator",2,"color","#000"],[1,"color-indicator",2,"color","#00f"],[1,"color-indicator",2,"color","#0f0"],[1,"color-indicator",2,"color","#0ff"],[1,"color-indicator",2,"color","#f00"],[1,"color-indicator",2,"color","#f0f"],[1,"color-indicator",2,"color","#ff0"],[1,"color-indicator",2,"color","#fff"],[2,"vertical-align","top"],[1,"material-icons",2,"font-size","150%","padding-left","2px"],[1,"imagebox"],[1,"image",3,"src"],[1,"sub-menu-arrow"],[1,"material-icons",2,"font-size","1em","vertical-align","bottom"],[3,"title","actions","isSubmenu"],[1,"separator"]],template:function(e,t){1&e&&(Io(0,"div",0,1),zo("mouseleave",function(){return t.hideSubMenu()}),Eo(2,aT,4,6,"div",2),Io(3,"div",3),Eo(4,lT,7,0,"div",4),Eo(5,cT,3,2,"div",5),Io(6,"div",6),Io(7,"ul"),Eo(8,pT,2,1,"ng-container",7),Mo(),Mo(),Mo(),Mo(),Eo(9,DT,20,26,"ng-template",null,8,dc),Eo(11,RT,2,0,"ng-template",null,9,dc)),2&e&&(To("ngClass",Gl(5,FT,t.isIconsMenu,t.isSubmenu,!t.isSubmenu,t.isPointerDragging)),Zr(2),To("ngIf",!t.isIconsMenu&&0<t.title.length||t.altitudeHande),Zr(2),To("ngIf",t.altitudeHande),Zr(1),To("ngIf",t.altitudeHande),Zr(3),To("ngForOf",t.actions))},directives:[Uh,Zh,Vh,Id,ju,sd,Sd,Fd,Jh,e],pipes:[$_],styles:[".component[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:1px solid #999;padding:0;white-space:nowrap;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;z-index:9900}.submenu-panel[_ngcontent-%COMP%]{position:absolute;left:calc(100% - 4px);top:-16px}.icons-panel[_ngcontent-%COMP%]{padding-bottom:2px}.icons-panel[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{width:54px;padding:1px}.icons-panel[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{padding:1px 0}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-max-limit[_ngcontent-%COMP%]{max-height:100%;max-width:100%}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em;font-size:12px;text-align:center;padding:4px 16px;margin:0 2px;color:#444;border-bottom:1px solid #aaa}.menu-title[_ngcontent-%COMP%]{display:inline-block}hr.separator[_ngcontent-%COMP%]{margin:.1em -12px;height:1px;border:0;background-color:#aaa}.sub-menu-arrow[_ngcontent-%COMP%]{display:inline-block;position:absolute;top:2px;bottom:0;right:1px}ul[_ngcontent-%COMP%]{list-style:none;padding:2px 0;margin:0}ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:relative;cursor:-moz-default;cursor:-webkit-default;cursor:default;padding:2px 20px;font-size:12px;color:#444}ul[_ngcontent-%COMP%] > li.hasHighlight[_ngcontent-%COMP%]:hover{color:#ccc;background-color:rgba(30,30,30,.8)}.menu-title[_ngcontent-%COMP%]:not(.icon-menu){overflow:hidden;max-width:16.5em;text-overflow:ellipsis}td.altitude[_ngcontent-%COMP%]{vertical-align:middle}input.altitude[_ngcontent-%COMP%]{writing-mode:bt-lr;-webkit-appearance:slider-vertical;-moz-appearance:slider-vertical;appearance:slider-vertical;width:8px;height:100%;padding:3px}.disabled[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%], .disabled[_ngcontent-%COMP%]   .menu-title[_ngcontent-%COMP%]{color:grey}.altitude-view[_ngcontent-%COMP%]{color:#000;vertical-align:top;width:3em;text-align:right}.ruler[_ngcontent-%COMP%]{color:#444;font-size:small;padding-left:4px;padding-right:2px}.default[_ngcontent-%COMP%]{font-weight:bolder}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:50px;height:50px;max-width:50px;max-height:50px;vertical-align:top;margin-left:auto;margin-right:auto;text-align:center}.image[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:middle;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0;object-position:50% 0;border-radius:.5rem}.icon-menu[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none}.icon-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid transparent;z-index:400}.icon-menu[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{border:2px dotted red;z-index:600}.icon-menu.default[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid red;z-index:500}.color-indicator[_ngcontent-%COMP%]{font-size:larger;text-shadow:1px 1px 0 #fff,-1px 1px 0 #fff,1px -1px 0 #fff,-1px -1px 0 #fff,1px 0 0 #fff,0 1px 0 #fff,-1px 0 0 #fff,0 -1px 0 #fff;margin-right:-.2rem}"]}),e})();function zT(e,t){if(1&e){const e=Fo();Io(0,"img",9),zo("click",function(){Ft(e);const t=jo().$implicit;return jo().onSelectedFile(t)}),ql(1,"safe"),Mo()}if(2&e){const e=jo().$implicit;To("src",$l(1,2,e.url,"resourceUrl"),Xi)("alt",e.name)}}function LT(e,t){1&e&&Ao(0,"img",10),2&e&&Go("alt",jo().$implicit.name)}function BT(e,t){if(1&e&&(Io(0,"span",6),Eo(1,zT,2,5,"img",7),Eo(2,LT,1,1,"img",8),Mo()),2&e){const e=t.$implicit;Zr(1),To("ngIf",0<e.url.length),Zr(1),To("ngIf",e.url.length<=0)}}let jT=(()=>{class e{constructor(e,t){this.changeDetector=e,this.panelService=t,this.fileStorageService=ov.instance}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7")}ngAfterViewInit(){Uy.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){Uy.unregister(this)}handleFileSelect(e){let t=e.target,n=t.files;n.length&&iC.instance.load(n),t.value=""}onSelectedFile(e){console.log("onSelectedFile",e),Uy.call("SELECT_FILE",{fileIdentifier:e.identifier},Hy.peerId)}}return e.\u0275fac=function(t){return new(t||e)(So(fl),So(wv))},e.\u0275cmp=Ze({type:e,selectors:[["file-storage"]],decls:15,vars:1,consts:[[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","image/*",2,"display","none",3,"change"],["id","file-list"],["class","image",4,"ngFor","ngForOf"],[1,"image"],["height","120",3,"src","alt","click",4,"ngIf"],["src","assets/images/loading.gif",3,"alt",4,"ngIf"],["height","120",3,"src","alt","click"],["src","assets/images/loading.gif",3,"alt"]],template:function(e,t){1&e&&(Io(0,"label"),Io(1,"div",0),Io(2,"div"),Io(3,"i",1),ga(4,"add_photo_alternate"),Mo(),Mo(),Io(5,"div"),ga(6,"\u3053\u3053\u306b\u753b\u50cf\u3092\u30c9\u30ed\u30c3\u30d7"),Mo(),Io(7,"div",2),ga(8,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),Mo(),Io(9,"input",3),zo("change",function(e){return t.handleFileSelect(e)}),Mo(),Io(10,"div",2),Ao(11,"br"),ga(12,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d2MB\u307e\u3067"),Mo(),Mo(),Mo(),Io(13,"div",4),Eo(14,BT,3,2,"span",5),Mo()),2&e&&(Zr(14),To("ngForOf",t.fileStorageService.images))},directives:[Vh,Zh],pipes:[$_],styles:[".drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold,Vollkorn;color:#444;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.image[_ngcontent-%COMP%]{font-size:0}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom}"],changeDetection:0}),e})(),UT=(()=>{class e{constructor(e,t,n){this.viewContainerRef=e,this.modalService=t,this.panelService=n,this.name="\u30b2\u30fc\u30e0\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",this.size=1,this.xml="",this.minSize=1,this.maxSize=20,this.tableBackgroundImage=Ig.createEmpty("null")}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u30fc"),Uy.register(this).on("SELECT_FILE",e=>{console.log("SELECT_FILE GameCharacterGeneratorComponent "+e.data.fileIdentifier);let t=ov.instance.get(e.data.fileIdentifier);t&&(this.tableBackgroundImage=t)})}ngAfterViewInit(){}ngOnDestroy(){Uy.unregister(this)}createGameCharacter(){gv.create(this.name,this.size,this.tableBackgroundImage.identifier)}createGameTableMask(){let e=Vy.instance.get("tableSelecter").viewTable;if(!e)return;let t=cC.create("\u30de\u30c3\u30d7\u30de\u30b9\u30af",5,5,100);e.appendChild(t)}createGameCharacterForXML(e){Xy.instance.parseXml(e)}openModal(){this.modalService.open(ew)}}return e.\u0275fac=function(t){return new(t||e)(So(kl),So(xv),So(wv))},e.\u0275cmp=Ze({type:e,selectors:[["game-character-generator"]],decls:15,vars:12,consts:[[3,"click"],["height","120",3,"src"],["placeholder","Name","name","name",3,"ngModel","ngModelChange"],["type","range","name","size",3,"ngModel","title","min","max","ngModelChange"],["type","number",3,"ngModel","min","max","ngModelChange"]],template:function(e,t){1&e&&(Io(0,"button",0),zo("click",function(){return t.openModal()}),ga(1,"\u753b\u50cf\u3092\u9078\u3076"),Mo(),Io(2,"div"),Ao(3,"img",1),ql(4,"safe"),Mo(),Io(5,"input",2),zo("ngModelChange",function(e){return t.name=e}),Mo(),Io(6,"div"),Io(7,"div"),Io(8,"input",3),zo("ngModelChange",function(e){return t.size=e}),Mo(),ga(9," Size : "),Io(10,"input",4),zo("ngModelChange",function(e){return t.size=e}),Mo(),Mo(),Io(11,"button",0),zo("click",function(){return t.createGameCharacter()}),ga(12,"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u4f5c\u308b"),Mo(),Io(13,"button",0),zo("click",function(){return t.createGameTableMask()}),ga(14,"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u4f5c\u308b"),Mo(),Mo()),2&e&&(Zr(3),To("src",$l(4,9,t.tableBackgroundImage.url,"resourceUrl"),Xi),Zr(2),To("ngModel",t.name),Zr(3),Go("title",t.size),Go("min",t.minSize),Go("max",t.maxSize),To("ngModel",t.size),Zr(2),Go("min",t.minSize),Go("max",t.maxSize),To("ngModel",t.size))},directives:[ju,sd,Sd,Fd,Id],pipes:[$_],styles:[""]}),e})();function HT(e,t){1&e&&Ro(0)}function VT(e,t){1&e&&Ro(0)}function GT(e,t){if(1&e&&(Io(0,"div"),ga(1),Mo()),2&e){const e=jo();Zr(1),ba("",e.getTabTitle(e.selectTab),"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306f\u7a7a\u3067\u3059")}}function ZT(e,t){1&e&&Ro(0)}const WT=function(e){return{box:!0,selected:e}},YT=function(e){return{gameObject:e}};function qT(e,t){if(1&e){const e=Fo();Io(0,"div",9),zo("contextmenu",function(n){Ft(e);const i=t.$implicit;return jo().onContextMenu(n,i)})("click",function(){Ft(e);const n=t.$implicit;return jo().selectGameObject(n)}),Eo(1,ZT,1,0,"ng-container",10),Mo()}if(2&e){const e=t.$implicit,n=jo(),i=ko(11);To("ngClass",Ul(3,WT,n.selectedIdentifier===e.identifier)),Zr(1),To("ngTemplateOutlet",i)("ngTemplateOutletContext",Ul(5,YT,e))}}function $T(e,t){if(1&e){const e=Fo();Io(0,"div",11),Io(1,"button",12),zo("click",function(){return Ft(e),jo().cleanInventory()}),ga(2,"\u5893\u5834\u3092\u7a7a\u306b\u3059\u308b"),Mo(),Mo()}if(2&e){const e=jo();Zr(1),Co("disabled",e.getGameObjects(e.selectTab).length<1?"":null)}}function XT(e,t){if(1&e){const e=Fo();Io(0,"label"),Io(1,"input",16),zo("ngModelChange",function(t){return Ft(e),jo(2).selectTab=t}),Mo(),Io(2,"div"),ga(3),Mo(),Mo()}if(2&e){const e=t.$implicit,n=jo(2);Zr(1),Go("value",e),To("ngModel",n.selectTab),Zr(2),ya("",n.getTabTitle(e)," (",n.getGameObjects(e).length,")")}}function KT(e,t){if(1&e&&(Io(0,"form",13),Io(1,"div",14),Eo(2,XT,4,4,"label",15),Mo(),Mo()),2&e){const e=jo();Zr(2),To("ngForOf",e.inventoryTypes)}}function QT(e,t){if(1&e){const e=Fo();Po(0),Io(1,"div"),Io(2,"div",17),ga(3,"\u4e26\u3073\u9806"),Mo(),Io(4,"input",18),zo("ngModelChange",function(t){return Ft(e),jo(2).sortTag=t}),Mo(),Io(5,"select",19),zo("ngModelChange",function(t){return Ft(e),jo(2).sortOrder=t}),Io(6,"option",20),ga(7,"\u6607\u9806"),Mo(),Io(8,"option",21),ga(9,"\u964d\u9806"),Mo(),Mo(),Mo(),Io(10,"div",22),ga(11,"\u8868\u793a\u9805\u76ee"),Mo(),Io(12,"input",23),zo("ngModelChange",function(t){return Ft(e),jo(2).dataTag=t}),Mo(),Io(13,"div",11),Io(14,"button",24),zo("click",function(){return Ft(e),jo(2).toggleEdit()}),Io(15,"i",25),ga(16,"settings"),Mo(),ga(17,"\u5b8c\u4e86"),Mo(),Mo(),Do()}if(2&e){const e=jo(2);Zr(4),To("ngModel",e.sortTag),Zr(1),To("ngModel",e.sortOrder),Zr(7),To("ngModel",e.dataTag)}}function JT(e,t){if(1&e&&(Po(0),ga(1),Do()),2&e){const e=jo(3);Zr(1),ya("",e.sortTag," (",e.sortOrderName,")")}}function eO(e,t){1&e&&(Po(0),ga(1,"-"),Do())}function tO(e,t){if(1&e){const e=Fo();Po(0),Io(1,"label"),Io(2,"input",28),zo("ngModelChange",function(t){return Ft(e),jo(3).indicateAll=t}),Mo(),ga(3,"\u3059\u3079\u3066\u8868\u793a"),Mo(),Do()}if(2&e){const e=jo(3);Zr(2),To("ngModel",e.indicateAll)}}function nO(e,t){if(1&e){const e=Fo();Po(0),Io(1,"table",26),Io(2,"tr"),Io(3,"th",27),ga(4,"\u4e26\u3073\u9806:"),Mo(),Io(5,"td",27),Eo(6,JT,2,2,"ng-container",2),Eo(7,eO,2,0,"ng-container",2),Mo(),Io(8,"td"),Eo(9,tO,4,1,"ng-container",2),Io(10,"button",24),zo("click",function(){return Ft(e),jo(2).toggleEdit()}),Io(11,"i",25),ga(12,"settings"),Mo(),ga(13,"\u8a2d\u5b9a"),Mo(),Mo(),Mo(),Mo(),Do()}if(2&e){const e=jo(2);Zr(6),To("ngIf",0<e.sortTag.length),Zr(1),To("ngIf",e.sortTag.length<1),Zr(2),To("ngIf","table"===e.selectTab)}}function iO(e,t){if(1&e&&(Eo(0,QT,18,3,"ng-container",2),Eo(1,nO,14,3,"ng-container",2)),2&e){const e=jo();To("ngIf",e.isEdit),Zr(1),To("ngIf",!e.isEdit)}}function rO(e,t){if(1&e&&(Io(0,"i",48),Ao(1,"img",49),ql(2,"safe"),Mo()),2&e){const e=jo().gameObject;Zr(1),To("src",$l(2,1,e.faceIcon.url,"resourceUrl"),Xi)}}function sO(e,t){1&e&&(Io(0,"i",37),ga(1,"emoji_emotions"),Mo())}const oO=function(e){return{opacity:e}};function aO(e,t){if(1&e&&(Io(0,"i",48),Ao(1,"img",50),ql(2,"safe"),Mo()),2&e){const e=jo().gameObject;Zr(1),To("ngStyle",Ul(5,oO,e.isDropShadow?.7:.3))("src",$l(2,2,e.shadowImageFile.url,"resourceUrl"),Xi)}}function lO(e,t){if(1&e&&(Io(0,"i",37),ga(1),Mo()),2&e){const e=jo().gameObject;Zr(1),ma(e.isDropShadow?"star_half":"star_border")}}function cO(e,t){if(1&e){const e=Fo();Io(0,"button",51),zo("click",function(t){Ft(e);const n=jo().gameObject;return jo().onContextMenu(t,n)}),Io(1,"i",37),ga(2,"settings"),Mo(),Mo()}}const hO=function(e,t,n){return{inverse:e,hollow:t,"black-paint":n}};function uO(e,t){if(1&e&&(Ao(0,"img",52),ql(1,"safe")),2&e){const e=jo().gameObject;To("src",$l(1,2,e.imageFile.url,"resourceUrl"),Xi)("ngClass",Vl(5,hO,e.isInverse,e.isHollow,e.isBlackPaint))}}function dO(e,t){1&e&&Ro(0)}const pO=function(e){return{dataElm:e}};function fO(e,t){if(1&e&&(Po(0),Eo(1,dO,1,0,"ng-container",10),Do()),2&e){const e=t.$implicit;jo(3);const n=ko(13);Zr(1),To("ngTemplateOutlet",n)("ngTemplateOutletContext",Ul(2,pO,e))}}function gO(e,t){if(1&e&&(Io(0,"div"),Eo(1,fO,2,4,"ng-container",53),Mo()),2&e){const e=jo().gameObject,t=jo();Zr(1),To("ngForOf",t.getInventoryTags(e))("ngForTrackBy",t.trackByGameObject)}}const mO=function(e){return{"is-active":e}},bO=function(e,t,n,i,r,s,o,a){return{black:e,blue:t,green:n,cyan:i,red:r,magenta:s,yellow:o,white:a}};function yO(e,t){if(1&e&&(Io(0,"div",29),Io(1,"div",30),Io(2,"button",31),zo("click",function(){const e=t.gameObject;return e.isUseIconToOverviewImage=!e.isUseIconToOverviewImage}),Eo(3,rO,3,4,"i",32),Eo(4,sO,2,0,"ng-template",null,33,dc),Mo(),ga(6),Io(7,"button",34),zo("click",function(){const e=t.gameObject;return e.isDropShadow=!e.isDropShadow}),Eo(8,aO,3,7,"i",32),Eo(9,lO,2,1,"ng-template",null,35,dc),Mo(),Io(11,"button",36),zo("click",function(){const e=t.gameObject;return e.isNotRide=!e.isNotRide}),Io(12,"i",37),ga(13),Mo(),Mo(),Io(14,"button",38),zo("click",function(){const e=t.gameObject;return e.isAltitudeIndicate=!e.isAltitudeIndicate}),Io(15,"i",39),ga(16,"straighten"),Mo(),Io(17,"span",40),ga(18),Mo(),Mo(),Io(19,"button",41),zo("click",function(){const e=t.gameObject;return e.isInventoryIndicate=!e.isInventoryIndicate}),Io(20,"i",37),ga(21,"all_inbox"),Mo(),Mo(),Eo(22,cO,3,0,"button",42),Mo(),Io(23,"div",43),Io(24,"div",44),Io(25,"span",45),Eo(26,uO,2,9,"img",46),Mo(),Mo(),Io(27,"div",47),Eo(28,gO,2,2,"div",2),Mo(),Mo(),Mo()),2&e){const e=t.gameObject,n=ko(5),i=ko(10),r=jo();Zr(2),To("disabled",r.selectedIdentifier!==e.identifier)("ngClass",Ul(21,mO,e.isUseIconToOverviewImage)),Zr(1),To("ngIf",e.faceIcon&&0<(null==e.faceIcon?null:e.faceIcon.url.length))("ngIfElse",n),Zr(3),ba(" ",e.name," "),Zr(1),To("disabled",r.selectedIdentifier!==e.identifier)("ngClass",Ul(23,mO,e.isDropShadow)),Zr(1),To("ngIf",e.shadowImageFile&&0<e.shadowImageFile.url.length)("ngIfElse",i),Zr(3),To("disabled",r.selectedIdentifier!==e.identifier)("ngClass",Ul(25,mO,!e.isNotRide)),Zr(2),ma(e.isNotRide?"directions_run":"directions_bike"),Zr(1),To("disabled",r.selectedIdentifier!==e.identifier)("ngClass",Ul(27,mO,e.isAltitudeIndicate)),Zr(4),ma(e.altitude),Zr(1),To("disabled",r.selectedIdentifier!==e.identifier)("ngClass",Ul(29,mO,e.isInventoryIndicate)),Zr(3),To("ngIf",r.selectedIdentifier===e.identifier),Zr(3),To("ngClass",Zl(31,bO,0==e.aura,1==e.aura,2==e.aura,3==e.aura,4==e.aura,5==e.aura,6==e.aura,7==e.aura)),Zr(1),To("ngIf",e.imageFile.url),Zr(2),To("ngIf",e.rootDataElement)}}function vO(e,t){1&e&&(Po(0),Ao(1,"br"),Do())}function _O(e,t){if(1&e){const e=Fo();Po(0),Io(1,"div",59),ga(2),Mo(),Io(3,"div",60),Io(4,"div",61),Io(5,"div",62),Io(6,"div",63),ga(7),Mo(),Io(8,"input",64),zo("ngModelChange",function(t){return Ft(e),jo(2).dataElm.value=t}),Mo(),Mo(),Mo(),Mo(),Do()}if(2&e){const e=jo(2).dataElm;Zr(2),ma(e.name),Zr(5),ma(e.value),Zr(1),Go("type",e.value&&e.value==+e.value?"number":"text"),To("ngModel",e.value)}}const wO=function(){return{"background-color":"green"}};function CO(e,t){if(1&e){const e=Fo();Po(0),Io(1,"div",65),Io(2,"div",66),ga(3),Mo(),Io(4,"input",67),zo("ngModelChange",function(t){return Ft(e),jo(2).dataElm.currentValue=t}),Mo(),Mo(),Io(5,"div",65),Io(6,"input",68),zo("ngModelChange",function(t){return Ft(e),jo(2).dataElm.currentValue=t}),ql(7,"safe"),Mo(),Mo(),Do()}if(2&e){const e=jo(2).dataElm;Zr(3),ma(e.name),Zr(1),To("ngModel",e.currentValue),Zr(2),ia($l(7,8,"font-size: 0.8em; min-width: 1em; width:"+(e.name.length+4.5)+"em; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),Go("title",e.currentValue),Go("max",+e.value?e.value:1e3),To("ngStyle",jl(11,wO))("ngModel",e.currentValue)}}function xO(e,t){if(1&e){const e=Fo();Po(0),Io(1,"div",59),ga(2),Mo(),Io(3,"div",60),Io(4,"div",61),Io(5,"div",62),Io(6,"input",69),zo("ngModelChange",function(t){return Ft(e),jo(2).dataElm.value=t})("change",function(){Ft(e);const t=jo(2).dataElm;return t.value=t.value?t.name:""}),Mo(),Mo(),Mo(),Mo(),Do()}if(2&e){const e=jo(2).dataElm;Zr(1),ta("text-decoration",e.value?"none":"line-through"),Zr(1),ma(e.name),Zr(4),Go("checked",e.value?"checked":""),To("ngModel",e.value)}}function EO(e,t){if(1&e){const e=Fo();Po(0),Io(1,"div",59),ga(2),Mo(),Io(3,"div",60),Io(4,"div",61),Io(5,"div",62),Io(6,"div",63),ga(7),Mo(),Io(8,"input",64),zo("ngModelChange",function(t){return Ft(e),jo(2).dataElm.value=t}),Mo(),Io(9,"span",70),ga(10),Mo(),Mo(),Mo(),Mo(),Do()}if(2&e){const e=jo(2).dataElm;Zr(2),ma(e.name),Zr(5),ma(e.value),Zr(1),Go("type",e.value&&e.value==+e.value?"number":"text"),To("ngModel",e.value),Zr(2),ba("(",(e.calcAbilityScore()>=0?"+":"")+e.calcAbilityScore(),")")}}function kO(e,t){if(1&e){const e=Fo();Po(0),Io(1,"div",59),ga(2),Mo(),Io(3,"div",60),Io(4,"div",61),Io(5,"div",62),Io(6,"div",63),ga(7),Mo(),Io(8,"input",71),zo("ngModelChange",function(t){return Ft(e),jo(2).dataElm.value=t}),Mo(),Mo(),Mo(),Mo(),Do()}if(2&e){const e=jo(2).dataElm;Zr(2),ma(e.name),Zr(5),ma(e.value),Zr(1),Go("type","size"===e.name||"altitude"===e.name?"number":"text"),Go("min","size"===e.name?"0":""),To("ngModel",e.value)}}function SO(e,t){if(1&e&&(Io(0,"div",55),Po(1,56),Eo(2,_O,9,4,"ng-container",57),Eo(3,CO,8,12,"ng-container",57),Eo(4,xO,7,5,"ng-container",57),Eo(5,EO,11,5,"ng-container",57),Eo(6,kO,9,5,"ng-container",58),Do(),Mo()),2&e){const e=jo().dataElm;Zr(1),To("ngSwitch",e.attributes.type),Zr(1),To("ngSwitchCase","simpleNumber"),Zr(1),To("ngSwitchCase","numberResource"),Zr(1),To("ngSwitchCase","checkProperty"),Zr(1),To("ngSwitchCase","abilityScore")}}function TO(e,t){if(1&e&&(Eo(0,vO,2,0,"ng-container",2),Eo(1,SO,7,5,"div",54)),2&e){const e=t.dataElm,n=jo();To("ngIf",(null==e?null:e.name)===n.newLineString),Zr(1),To("ngIf",e&&e.name!==n.newLineString)}}let OO=(()=>{class e{constructor(e,t,n,i,r,s){this.changeDetector=e,this.panelService=t,this.inventoryService=n,this.contextMenuService=i,this.pointerDeviceService=r,this.modalService=s,this.inventoryTypes=["table","common","graveyard"],this.selectTab="table",this.selectedIdentifier="",this.isEdit=!1}get sortTag(){return this.inventoryService.sortTag}set sortTag(e){this.inventoryService.sortTag=e}get sortOrder(){return this.inventoryService.sortOrder}set sortOrder(e){this.inventoryService.sortOrder=e}get dataTag(){return this.inventoryService.dataTag}set dataTag(e){this.inventoryService.dataTag=e}get dataTags(){return this.inventoryService.dataTags}get indicateAll(){return this.inventoryService.indicateAll}set indicateAll(e){this.inventoryService.indicateAll=e}get sortOrderName(){return this.sortOrder===oC.ASC?"\u6607\u9806":"\u964d\u9806"}get newLineString(){return this.inventoryService.newLineString}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),Uy.register(this).on("SELECT_TABLETOP_OBJECT",-1e3,e=>{Vy.instance.get(e.data.identifier)instanceof uv&&(this.selectedIdentifier=e.data.identifier,this.changeDetector.markForCheck())}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("UPDATE_INVENTORY",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("OPEN_NETWORK",e=>{this.inventoryTypes=["table","common",Hy.peerId,"graveyard"],this.inventoryTypes.includes(this.selectTab)||(this.selectTab=Hy.peerId)}),this.inventoryTypes=["table","common",Hy.peerId,"graveyard"]}ngAfterViewInit(){}ngOnDestroy(){Uy.unregister(this)}getTabTitle(e){switch(e){case"table":return"\u30c6\u30fc\u30d6\u30eb";case Hy.peerId:return"\u500b\u4eba";case"graveyard":return"\u5893\u5834";default:return"\u5171\u6709"}}getInventory(e){switch(e){case"table":return this.inventoryService.tableInventory;case Hy.peerId:return this.inventoryService.privateInventory;case"graveyard":return this.inventoryService.graveyardInventory;default:return this.inventoryService.commonInventory}}getGameObjects(e){return this.getInventory(e).tabletopObjects.filter(t=>"table"!=e||this.indicateAll||t.isInventoryIndicate)}getInventoryTags(e){return this.getInventory(e.location.name).dataElementMap.get(e.identifier)}onContextMenu(e,t){if(document.activeElement instanceof HTMLInputElement&&"range"!==document.activeElement.getAttribute("type"))return;if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;this.selectGameObject(t);let n=this.pointerDeviceService.pointers[0],i=[];t.imageFiles.length>1&&(i.push({name:"\u753b\u50cf\u5207\u308a\u66ff\u3048",action:null,subActions:t.imageFiles.map((e,n)=>({name:t.currntImageIndex==n?"\u25c9":"\u25cb",action:()=>{t.currntImageIndex=n,q_.play(Y_.surprise),Uy.trigger("UPDATE_INVENTORY",null)},default:t.currntImageIndex==n,icon:e}))}),i.push(B_)),i.push(t.isUseIconToOverviewImage?{name:"\u2611 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{t.isUseIconToOverviewImage=!1,Uy.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{t.isUseIconToOverviewImage=!0,Uy.trigger("UPDATE_INVENTORY",null)}}),i.push(t.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{t.isDropShadow=!1,Uy.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{t.isDropShadow=!0,Uy.trigger("UPDATE_INVENTORY",null)}}),i.push({name:"\u753b\u50cf\u52b9\u679c",action:null,subActions:[t.isInverse?{name:"\u2611 \u53cd\u8ee2",action:()=>{t.isInverse=!1,Uy.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u53cd\u8ee2",action:()=>{t.isInverse=!0,Uy.trigger("UPDATE_INVENTORY",null)}},t.isHollow?{name:"\u2611 \u307c\u304b\u3057",action:()=>{t.isHollow=!1,Uy.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u307c\u304b\u3057",action:()=>{t.isHollow=!0,Uy.trigger("UPDATE_INVENTORY",null)}},t.isBlackPaint?{name:"\u2611 \u9ed2\u5857\u308a",action:()=>{t.isBlackPaint=!1,Uy.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ed2\u5857\u308a",action:()=>{t.isBlackPaint=!0,Uy.trigger("UPDATE_INVENTORY",null)}},{name:"\u30aa\u30fc\u30e9",action:null,subActions:[{name:(-1==t.aura?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{t.aura=-1,Uy.trigger("UPDATE_INVENTORY",null)}},B_].concat(["\u30d6\u30e9\u30c3\u30af","\u30d6\u30eb\u30fc","\u30b0\u30ea\u30fc\u30f3","\u30b7\u30a2\u30f3","\u30ec\u30c3\u30c9","\u30de\u30bc\u30f3\u30bf","\u30a4\u30a8\u30ed\u30fc","\u30db\u30ef\u30a4\u30c8"].map((e,n)=>({name:`${t.aura==n?"\u25c9":"\u25cb"} ${e}`,action:()=>{t.aura=n,Uy.trigger("UPDATE_INVENTORY",null)}})))},B_,{name:"\u30ea\u30bb\u30c3\u30c8",action:()=>{t.isInverse=!1,t.isHollow=!1,t.isBlackPaint=!1,t.aura=-1,Uy.trigger("UPDATE_INVENTORY",null)},disabled:!t.isInverse&&!t.isHollow&&!t.isBlackPaint&&-1==t.aura}]}),i.push(B_),i.push(t.isNotRide?{name:"\u2610 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{t.isNotRide=!1,Uy.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2611 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{t.isNotRide=!0,Uy.trigger("UPDATE_INVENTORY",null)}}),i.push(t.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{t.isAltitudeIndicate=!1,Uy.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{t.isAltitudeIndicate=!0,Uy.trigger("UPDATE_INVENTORY",null)}}),i.push({name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=t.altitude&&(t.altitude=0,"table"===t.location.name&&q_.play(Y_.sweep))},altitudeHande:t}),i.push(B_),i.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(t)}}),i.push({name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a",action:()=>{this.showChatPalette(t)},disabled:"graveyard"===t.location.name}),i.push({name:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a",action:()=>{this.showStandSetting(t)}}),i.push(B_),i.push({name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:t.getUrls().map(e=>{const n=e.value.toString();return{name:e.name?e.name:n,action:()=>{this.modalService.open(Iv,{url:n,title:t.name,subTitle:e.name})},disabled:!rv.validUrl(n),error:rv.validUrl(n)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",materialIcon:"open_in_new"}}),disabled:t.getUrls().length<=0}),i.push(B_),i.push(t.isInventoryIndicate?{name:"\u2611 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{t.isInventoryIndicate=!1,Uy.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{t.isInventoryIndicate=!0,Uy.trigger("UPDATE_INVENTORY",null)}});let r=[{name:"table",alias:"\u30c6\u30fc\u30d6\u30eb"},{name:"common",alias:"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"},{name:Hy.peerId,alias:"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"},{name:"graveyard",alias:"\u5893\u5834"}];i.push({name:`${(r.find(e=>e.name==t.location.name)||r[1]).alias}\u304b\u3089\u79fb\u52d5`,action:null,subActions:r.filter((e,n)=>!(t.location.name==e.name||1==n&&!r.map(e=>e.name).includes(t.location.name))).map(e=>({name:`${e.alias}`,action:()=>{Uy.call("FAREWELL_STAND_IMAGE",{characterIdentifier:t.identifier}),t.setLocation(e.name),q_.play("graveyard"==e.name?Y_.sweep:Y_.piecePut)}}))}),i.push(B_),i.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{this.cloneGameObject(t),q_.play(Y_.piecePut)}}),"graveyard"===t.location.name&&i.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.deleteGameObject(t),q_.play(Y_.sweep)}}),this.contextMenuService.open(n,i,t.name)}toggleEdit(){this.isEdit=!this.isEdit}cleanInventory(){let e=this.getTabTitle(this.selectTab),t=this.getGameObjects(this.selectTab);if(confirm(`${e}\u306b\u5b58\u5728\u3059\u308b${t.length}\u500b\u306e\u8981\u7d20\u3092\u5b8c\u5168\u306b\u524a\u9664\u3057\u307e\u3059\u304b\uff1f`)){for(const e of t)this.deleteGameObject(e);q_.play(Y_.sweep)}}cloneGameObject(e){e.clone()}showDetail(e){Uy.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let t=this.pointerDeviceService.pointers[0],n="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(n+=" - "+e.name),this.panelService.open(wx,{title:n,left:t.x-800,top:t.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let t=this.pointerDeviceService.pointers[0];this.panelService.open(Tw,{left:t.x-250,top:t.y-175,width:620,height:350}).character=e}selectGameObject(e){Uy.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName})}deleteGameObject(e){e.destroy(),this.changeDetector.markForCheck()}showStandSetting(e){let t=this.pointerDeviceService.pointers[0];this.panelService.open(Jw,{left:t.x-400,top:t.y-175,width:730,height:572}).character=e}trackByGameObject(e,t){return t?t.identifier:e}}return e.\u0275fac=function(t){return new(t||e)(So(fl),So(wv),So(rS),So(j_),So(Kw),So(xv))},e.\u0275cmp=Ze({type:e,selectors:[["game-object-inventory"]],decls:14,vars:6,consts:[[1,"component"],[4,"ngTemplateOutlet"],[4,"ngIf"],[3,"ngClass","contextmenu","click",4,"ngFor","ngForOf","ngForTrackBy"],["style","padding-top: 6px;",4,"ngIf"],["inventoryTab",""],["inventoryViewSetting",""],["gameObjectTags",""],["dataElmTag",""],[3,"ngClass","contextmenu","click"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[2,"padding-top","6px"],[1,"danger",3,"click"],[1,"is-sticky-top"],[1,"tab"],[4,"ngFor","ngForOf"],["name","tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],[2,"font-size","12px"],["placeholder","\u30bf\u30b0\u540d",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange"],["value","ASC"],["value","DESC"],[2,"font-size","12px","padding-top","6px"],["placeholder","\u30b9\u30da\u30fc\u30b9\u533a\u5207\u308a\u3067\u30bf\u30b0\u540d \u30b9\u30e9\u30c3\u30b7\u30e5\u3067\u6539\u884c ex.\u300cHP MP / \u30e1\u30e2\u300d",2,"width","100%","box-sizing","border-box",3,"ngModel","ngModelChange"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[2,"font-size","0.8em"],[2,"vertical-align","middle"],["type","checkbox",3,"ngModel","ngModelChange"],[1,"inventory-object"],[1,"object-name"],["title","\u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854\u30a2\u30a4\u30b3\u30f3\u3092\u4f7f\u7528",1,"indicate",2,"font-size","0.8em","padding","1px","width","24px","height","16px","margin-bottom","1px",3,"disabled","ngClass","click"],["class","face-icon",4,"ngIf","ngIfElse"],["altImage",""],["title","\u5f71\u306e\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","1px","width","24px","height","16px","margin-bottom","1px",3,"disabled","ngClass","click"],["altShadow",""],["title","\u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"disabled","ngClass","click"],[1,"material-icons",2,"font-size","1em"],["title","\u9ad8\u5ea6\u306e\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"disabled","ngClass","click"],[1,"material-icons","rotate",2,"font-size","1em"],[2,"display","inline-block","text-align","center","font-size","xx-small","color","gray","min-width","2em"],["title","\u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"disabled","ngClass","click"],["style","font-size: 0.8em; padding: 2px 5px;","title","\u30e1\u30cb\u30e5\u30fc",3,"click",4,"ngIf"],[1,"object-tags-box"],[1,"table-cell","image-box"],[1,"aura",3,"ngClass"],["class","inverser",3,"src","ngClass",4,"ngIf"],[1,"table-cell"],[1,"face-icon"],["alt","",3,"src"],["alt","",2,"filter","brightness(0)",3,"ngStyle","src"],["title","\u30e1\u30cb\u30e5\u30fc",2,"font-size","0.8em","padding","2px 5px",3,"click"],[1,"inverser",3,"src","ngClass"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","object-tag",4,"ngIf"],[1,"object-tag"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"tag-name"],[2,"text-align","center"],[2,"display","inline-block"],[1,"tag-value-box"],[1,"hidden-spacer",2,"font-weight","bold"],["size","1","placeholder","",1,"input","tag-value",3,"type","ngModel","ngModelChange"],[1,"resource-tag"],[2,"font-size","0.8em","display","inline-block","margin-right","0.5em"],["type","number","size","1","placeholder","Value",1,"input","resource-value",3,"ngModel","ngModelChange"],["type","range","min","0",3,"title","max","ngStyle","ngModel","ngModelChange"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"font-size","smaller"],["size","1","placeholder","",1,"input","tag-value",3,"type","min","ngModel","ngModelChange"]],template:function(e,t){if(1&e&&(Io(0,"div",0),Eo(1,HT,1,0,"ng-container",1),Eo(2,VT,1,0,"ng-container",1),Eo(3,GT,2,1,"div",2),Eo(4,qT,2,7,"div",3),Eo(5,$T,3,1,"div",4),Mo(),Eo(6,KT,3,1,"ng-template",null,5,dc),Eo(8,iO,2,2,"ng-template",null,6,dc),Eo(10,yO,29,40,"ng-template",null,7,dc),Eo(12,TO,2,2,"ng-template",null,8,dc)),2&e){const e=ko(7),n=ko(9);Zr(1),To("ngTemplateOutlet",e),Zr(1),To("ngTemplateOutlet",n),Zr(1),To("ngIf",t.getGameObjects(t.selectTab).length<1),Zr(1),To("ngForOf",t.getGameObjects(t.selectTab))("ngForTrackBy",t.trackByGameObject),Zr(1),To("ngIf","graveyard"===t.selectTab)}},directives:[Jh,Zh,Vh,Uh,Td,od,xd,Dd,ju,sd,Sd,Ld,Bd,Vd,zu,Qh,$h,Xh,Kh,Id,Fd],pipes:[$_],styles:[".component[_ngcontent-%COMP%]{width:100%}.box[_ngcontent-%COMP%]{border-left:2px solid transparent;border-bottom:2px solid transparent;margin-top:2px;padding:2px 2px 3px;box-sizing:border-box;border-color:transparent transparent #666;border-style:solid solid dotted;border-width:2px 2px 1px 6px}.selected[_ngcontent-%COMP%]{padding:2px;border:2px dotted #666;border-left:6px solid #444}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;font-size:1em;min-width:1em;max-width:12em;overflow:hidden;padding:0 2px;box-sizing:border-box;white-space:nowrap}.input[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;padding:2px;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#eee}.input[_ngcontent-%COMP%]:focus{background:#fff}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:focus, input[type=number][_ngcontent-%COMP%]:hover{-moz-appearance:number-input}input[type=range][_ngcontent-%COMP%]{--slider-track-color:transparent;--slider-fill-color:#555;--slider-border-color:#777;--slider-height:0.8em;--slider-thumb-size:1.0em;--range:calc(var(--max) - var(--min));--ratio:calc((var(--val) - var(--min))/var(--range));--sx:calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:1px solid var(--slider-border-color);border-bottom:1px solid var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color);background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;-moz-user-select:none;user-select:none;padding:0;border:1px solid #555;border-radius:.3em;overflow:hidden;display:flex;flex-flow:row nowrap;justify-content:space-around;align-items:stretch;text-align:center;margin:0;max-width:500px;background-color:rgba(240,218,189,.9)}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;flex:1 0 auto;flex-grow:1}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:checked{background:#555;color:#ccc}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{vertical-align:middle;outline:0;font-size:.6em;background-color:transparent;color:#444;box-sizing:border-box;margin:0;padding:2px 8px;cursor:pointer}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.is-sticky-top[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10000}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:1px solid #555;padding:2px 8px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:1px solid #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.image-box[_ngcontent-%COMP%], .table-cell[_ngcontent-%COMP%]{display:table-cell}.image-box[_ngcontent-%COMP%]{padding:0;width:32px;height:32px;vertical-align:top}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0;object-position:50% 0;border-radius:.3rem}.inventory-object[_ngcontent-%COMP%]{font-size:14px;display:inline-block;vertical-align:text-top}.object-name[_ngcontent-%COMP%]{font-size:.8em;font-weight:700;padding:0 .25em}.object-tags-box[_ngcontent-%COMP%]{display:table;table-layout:fixed}.object-tag[_ngcontent-%COMP%]{display:inline-block;padding:0 .25em;vertical-align:middle}.resource-tag[_ngcontent-%COMP%]{text-align:center;vertical-align:bottom;overflow:hidden;white-space:nowrap}.resource-value[_ngcontent-%COMP%]{font-weight:700;width:4em;text-align:right;font-family:inherit}.tag-name[_ngcontent-%COMP%]{font-size:.8em;text-align:left;vertical-align:bottom;min-width:1em;max-width:12em;overflow:hidden;white-space:nowrap}.tag-value-box[_ngcontent-%COMP%]{display:table-cell;width:10px}.tag-value[_ngcontent-%COMP%]{font-size:1em;font-weight:700;width:100%;min-width:1em;max-width:12em;text-align:center;font-family:inherit}.tag-value[type=number][_ngcontent-%COMP%]{min-width:3.4em;text-align:right}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms ease 0s}.hollow[_ngcontent-%COMP%]{opacity:.5}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #00f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 3px #aaa) drop-shadow(0 -2px 2px #fff)}.material-icons.rotate[_ngcontent-%COMP%]{transform:rotate(90deg)}button.indicate[_ngcontent-%COMP%]:disabled{border-color:transparent}button.indicate[_ngcontent-%COMP%]:disabled   .material-icons[_ngcontent-%COMP%]{color:#000}button.indicate[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:.5}button.is-active[_ngcontent-%COMP%]{background-color:#fff}button.is-active[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:1}.face-icon[_ngcontent-%COMP%]{display:inline-block;width:12px;height:12px;max-width:12px;max-height:12px;vertical-align:middle;overflow:hidden}.face-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0;object-position:50% 0;border-radius:.2rem}"],changeDetection:0}),e})();const IO=Ig.create("./assets/images/skeleton.png");let MO=(()=>{class e{constructor(){}getSkeletonOr(e){let t=e instanceof Ig?e:ov.instance.get(e);return t&&!t.isEmpty?t:IO}getEmptyOr(e){let t=e instanceof Ig?e:ov.instance.get(e);return t&&!t.isEmpty?t:Ig.Empty}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function AO(e,t){if(1&e&&(Io(0,"option",7),ga(1),Mo()),2&e){const e=t.$implicit;Go("value",e.identifier),Zr(1),ma(e.name)}}function PO(e,t){if(1&e){const e=Fo();Io(0,"div"),Io(1,"button",29),zo("click",function(){return Ft(e),jo(2).openDistanceViewImageModal()}),ga(2,"\u80cc\u666f\u753b\u50cf\u3092\u8ffd\u52a0"),Mo(),Mo()}}function DO(e,t){if(1&e){const e=Fo();Io(0,"div",2),zo("click",function(){return Ft(e),jo(2).openDistanceViewImageModal()}),Ao(1,"img",9),ql(2,"safe"),Mo()}if(2&e){const e=jo(2);Zr(1),To("src",$l(2,1,e.tableDistanceviewImage.url,"resourceUrl"),Xi)}}function RO(e,t){if(1&e&&(Io(0,"div",35),ga(1),Mo()),2&e){const e=jo(3);Zr(1),ba("",e.progresPercent,"%")}}const FO=function(e){return{"is-hidden":e}};function NO(e,t){if(1&e){const e=Fo();Po(0),Io(1,"button",30),zo("click",function(){return Ft(e),jo(2).save()}),Io(2,"div",31),Io(3,"div",32),ga(4,"\u4fdd\u5b58"),Mo(),Eo(5,RO,2,1,"div",33),Mo(),Mo(),Io(6,"button",34),zo("click",function(){return Ft(e),jo(2).delete()}),ga(7,"\u524a\u9664"),Mo(),Do()}if(2&e){const e=jo(2);Zr(1),To("disabled",e.isSaveing),Zr(2),To("ngClass",Ul(4,FO,e.isSaveing)),Zr(2),To("ngIf",e.isSaveing),Zr(1),Co("disabled",e.getGameTables().length<=1?"":null)}}function zO(e,t){if(1&e){const e=Fo();Po(0),Io(1,"button",2),zo("click",function(){return Ft(e),jo(2).restore()}),ga(2,"\u5143\u306b\u623b\u3059"),Mo(),Do()}}function LO(e,t){if(1&e){const e=Fo();Po(0),Io(1,"div",8),Io(2,"div"),ga(3," \u753b\u50cf "),Io(4,"div",2),zo("click",function(){return Ft(e),jo().openBgImageModal()}),Ao(5,"img",9),ql(6,"safe"),Mo(),Mo(),Io(7,"div"),ga(8," \u80cc\u666f "),Eo(9,PO,3,0,"div",6),Eo(10,DO,3,4,"div",10),Mo(),Mo(),Io(11,"div"),ga(12,"Name : "),Io(13,"input",11),zo("ngModelChange",function(t){return Ft(e),jo().tableName=t}),Mo(),Mo(),Io(14,"div"),Io(15,"input",12),zo("ngModelChange",function(t){return Ft(e),jo().tableWidth=t}),Mo(),ga(16," Width : "),Io(17,"input",13),zo("ngModelChange",function(t){return Ft(e),jo().tableWidth=t}),Mo(),Mo(),Io(18,"div"),Io(19,"input",14),zo("ngModelChange",function(t){return Ft(e),jo().tableHeight=t}),Mo(),ga(20," Height : "),Io(21,"input",13),zo("ngModelChange",function(t){return Ft(e),jo().tableHeight=t}),Mo(),Mo(),Io(22,"div"),ga(23," \u30b0\u30ea\u30c3\u30c9: "),Io(24,"select",15),zo("ngModelChange",function(t){return Ft(e),jo().tableGridType=t}),Io(25,"option",16),ga(26,"\u306a\u3057"),Mo(),Io(27,"option",17),ga(28,"\u30b9\u30af\u30a8\u30a2"),Mo(),Io(29,"option",18),ga(30,"\u30d8\u30af\u30b9\uff08\u7e26\u63c3\u3048\uff09"),Mo(),Io(31,"option",19),ga(32,"\u30d8\u30af\u30b9\uff08\u6a2a\u63c3\u3048\uff09"),Mo(),Mo(),ga(33," \u8272: "),Io(34,"select",20),zo("ngModelChange",function(t){return Ft(e),jo().tableGridColor=t}),Io(35,"option",21),ga(36,"\u9ed2"),Mo(),Io(37,"option",22),ga(38,"\u767d"),Mo(),Mo(),Mo(),Io(39,"div"),ga(40," \u80cc\u666f\u30d5\u30a3\u30eb\u30bf "),Io(41,"select",23),zo("ngModelChange",function(t){return Ft(e),jo().tableDistanceviewFilter=t}),Io(42,"option",24),ga(43,"\u306a\u3057"),Mo(),Io(44,"option",25),ga(45,"\u30db\u30ef\u30a4\u30c8"),Mo(),Io(46,"option",26),ga(47,"\u30d6\u30e9\u30c3\u30af"),Mo(),Mo(),Mo(),Ao(48,"hr"),Io(49,"div"),Io(50,"label"),ga(51,"\u30b0\u30ea\u30c3\u30c9\u3092\u5e38\u306b\u8868\u793a: "),Io(52,"input",27),zo("ngModelChange",function(t){return Ft(e),jo().tableGridShow=t}),Mo(),Mo(),Io(53,"label"),ga(54,"\u30b9\u30ca\u30c3\u30d7: "),Io(55,"input",28),zo("ngModelChange",function(t){return Ft(e),jo().tableGridSnap=t}),Mo(),Mo(),Eo(56,NO,8,6,"ng-container",6),Eo(57,zO,3,0,"ng-container",6),Mo(),Do()}if(2&e){const e=jo();Zr(5),To("src",$l(6,33,e.tableBackgroundImage.url,"resourceUrl"),Xi),Zr(4),To("ngIf",!e.tableDistanceviewImage.url),Zr(1),To("ngIf",e.tableDistanceviewImage.url),Zr(3),To("ngModel",e.tableName),Co("disabled",e.isEditable?null:""),Zr(2),Go("title",e.tableWidth),Go("min",e.minSize),Go("max",e.maxSize),To("ngModel",e.tableWidth),Co("disabled",e.isEditable?null:""),Zr(2),Go("min",e.minSize),Go("max",e.maxSize),To("ngModel",e.tableWidth),Co("disabled",e.isEditable?null:""),Zr(2),Go("title",e.tableHeight),Go("min",e.minSize),Go("max",e.maxSize),To("ngModel",e.tableHeight),Co("disabled",e.isEditable?null:""),Zr(2),Go("min",e.minSize),Go("max",e.maxSize),To("ngModel",e.tableHeight),Co("disabled",e.isEditable?null:""),Zr(3),To("ngModel",e.tableGridType),Co("disabled",e.isEditable?null:""),Zr(10),To("ngModel",e.tableGridColor),Co("disabled",e.isEditable?null:""),Zr(7),To("ngModel",e.tableDistanceviewFilter),Co("disabled",e.isEditable?null:""),Zr(11),To("ngModel",e.tableGridShow),Zr(3),To("ngModel",e.tableGridSnap),Zr(1),To("ngIf",!e.isDeleted),Zr(1),To("ngIf",e.isDeleted)}}function BO(e,t){1&e&&(Po(0),Io(1,"div",36),ga(2,"\u203b\u30c6\u30fc\u30d6\u30eb\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b\u300d\u304b\u3089\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),Mo(),Do())}let jO=(()=>{class e{constructor(e,t,n,i){this.modalService=e,this.saveDataService=t,this.imageService=n,this.panelService=i,this.minSize=1,this.maxSize=100,this.selectedTable=null,this.selectedTableXml="",this.isSaveing=!1,this.progresPercent=0}get tableBackgroundImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.imageIdentifier:null)}get tableDistanceviewImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.backgroundImageIdentifier:null)}get tableName(){return this.selectedTable.name}set tableName(e){this.isEditable&&(this.selectedTable.name=e)}get tableWidth(){return this.selectedTable.width}set tableWidth(e){this.isEditable&&(this.selectedTable.width=e)}get tableHeight(){return this.selectedTable.height}set tableHeight(e){this.isEditable&&(this.selectedTable.height=e)}get tableGridColor(){return this.selectedTable.gridColor}set tableGridColor(e){this.isEditable&&(this.selectedTable.gridColor=e)}get tableGridShow(){return this.tableSelecter.gridShow}set tableGridShow(e){this.tableSelecter.gridShow=e,Uy.trigger("UPDATE_GAME_OBJECT",this.tableSelecter.toContext())}get tableGridSnap(){return this.tableSelecter.gridSnap}set tableGridSnap(e){this.tableSelecter.gridSnap=e}get tableGridType(){return this.selectedTable.gridType}set tableGridType(e){this.isEditable&&(this.selectedTable.gridType=Number(e))}get tableDistanceviewFilter(){return this.selectedTable.backgroundFilterType}set tableDistanceviewFilter(e){this.isEditable&&(this.selectedTable.backgroundFilterType=e)}get tableSelecter(){return Vy.instance.get("tableSelecter")}get isEmpty(){return!this.tableSelecter||!this.tableSelecter.viewTable}get isDeleted(){return!this.selectedTable||null==Vy.instance.get(this.selectedTable.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}ngOnInit(){Promise.resolve().then(()=>{this.modalService.title=this.panelService.title="\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a",this.panelService.isAbleFullScreenButton=!1}),this.selectedTable=this.tableSelecter.viewTable,Uy.register(this).on("DELETE_GAME_OBJECT",1e3,e=>{if(!this.selectedTable||e.data.identifier!==this.selectedTable.identifier)return;let t=Vy.instance.get(e.data.identifier);null!==t&&(this.selectedTableXml=t.toXml())})}ngAfterViewInit(){}ngOnDestroy(){Uy.unregister(this)}selectGameTable(e){Uy.call("SELECT_GAME_TABLE",{identifier:e},Hy.peerId),this.selectedTable=Vy.instance.get(e),this.selectedTableXml=""}getGameTables(){return Vy.instance.getObjects(gC)}createGameTable(){let e=new gC;e.name="\u767d\u7d19\u306e\u30c6\u30fc\u30d6\u30eb",e.imageIdentifier="testTableBackgroundImage_image",e.initialize(),this.selectGameTable(e.identifier)}save(){return xg(this,void 0,void 0,function*(){this.selectedTable&&!this.isSaveing&&(this.isSaveing=!0,this.progresPercent=0,this.selectedTable.selected=!0,yield this.saveDataService.saveGameObjectAsync(this.selectedTable,"map_"+this.selectedTable.name,e=>{this.progresPercent=e}),setTimeout(()=>{this.isSaveing=!1,this.progresPercent=0},500))})}delete(){!this.isEmpty&&this.selectedTable&&(this.selectedTableXml=this.selectedTable.toXml(),this.selectedTable.destroy())}restore(){if(this.selectedTable&&this.selectedTableXml){let e=Xy.instance.parseXml(this.selectedTableXml);this.selectGameTable(e.identifier),this.selectedTableXml=""}}openBgImageModal(){this.isDeleted||this.modalService.open(ew).then(e=>{this.selectedTable&&e&&(this.selectedTable.imageIdentifier=e)})}openDistanceViewImageModal(){this.isDeleted||this.modalService.open(ew,{isAllowedEmpty:!0}).then(e=>{this.selectedTable&&e&&(this.selectedTable.backgroundImageIdentifier=e)})}}return e.\u0275fac=function(t){return new(t||e)(So(xv),So(_C),So(MO),So(wv))},e.\u0275cmp=Ze({type:e,selectors:[["game-table-setting"]],decls:10,vars:4,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[3,"click"],["size","10",2,"width","10em",3,"ngModel","change"],[3,"value",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[3,"value"],[1,"images-select"],["height","120",3,"src"],[3,"click",4,"ngIf"],["placeholder","Name",3,"ngModel","ngModelChange"],["type","range","name","tableWidth",3,"ngModel","title","min","max","ngModelChange"],["type","number",2,"width","5em",3,"ngModel","min","max","ngModelChange"],["type","range","name","tableHeight",3,"ngModel","title","min","max","ngModelChange"],["name","tableGridType",3,"ngModel","ngModelChange"],["value","-1"],["value","0"],["value","1"],["value","2"],["name","tableGridColor",3,"ngModel","ngModelChange"],["value","#000000e6"],["value","#dddddde6"],["name","tableDistanceviewFilter",3,"ngModel","ngModelChange"],["value",""],["value","white"],["value","black"],["type","checkbox","name","tableGridShow",3,"ngModel","ngModelChange"],["type","checkbox","name","tableGridSnap",3,"ngModel","ngModelChange"],[2,"height","120px",3,"click"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,t){1&e&&(Io(0,"div",0),Io(1,"div",1),Io(2,"div"),Io(3,"button",2),zo("click",function(){return t.createGameTable()}),ga(4,"\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b"),Mo(),Mo(),Io(5,"select",3),zo("change",function(e){return t.selectGameTable(e.target.value)}),Eo(6,AO,2,2,"option",4),Mo(),Mo(),Io(7,"div",5),Eo(8,LO,58,36,"ng-container",6),Mo(),Mo(),Eo(9,BO,3,0,"ng-container",6)),2&e&&(Zr(5),To("ngModel",null==t.selectedTable?null:t.selectedTable.identifier),Zr(1),To("ngForOf",t.getGameTables()),Zr(2),To("ngIf",!t.isEmpty||t.selectedTable),Zr(1),To("ngIf",t.isEmpty))},directives:[Ld,sd,Sd,Vh,Zh,Bd,Vd,ju,Fd,Id,zu,Uh],pipes:[$_],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.images-select[_ngcontent-%COMP%]{display:flex}input[type=number][_ngcontent-%COMP%]{text-align:right}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;font-size:.9em}"]}),e})();function UO(e,t){if(1&e){const e=Fo();Io(0,"button",12),zo("click",function(){Ft(e);const t=jo().$implicit;return jo().play(t)}),ga(1,"\u8a66\u8074/\u518d\u751f"),Mo()}2&e&&To("disabled",!jo().$implicit.isReady)}function HO(e,t){if(1&e){const e=Fo();Io(0,"button",12),zo("click",function(){return Ft(e),jo(2).stop()}),ga(1,"\u8a66\u8074/\u505c\u6b62"),Mo()}2&e&&To("disabled",!jo().$implicit.isReady)}function VO(e,t){if(1&e){const e=Fo();Io(0,"button",12),zo("click",function(){Ft(e);const t=jo().$implicit;return jo().playBGM(t)}),ga(1,"BGM/\u518d\u751f"),Mo()}2&e&&To("disabled",!jo().$implicit.isReady)}function GO(e,t){if(1&e){const e=Fo();Io(0,"button",12),zo("click",function(){Ft(e);const t=jo().$implicit;return jo().stopBGM(t)}),ga(1,"BGM/\u505c\u6b62"),Mo()}2&e&&To("disabled",!jo().$implicit.isReady)}function ZO(e,t){1&e&&(Io(0,"span"),ga(1,"\u3010\u8a66\u8074\u4e2d\u3011"),Mo())}function WO(e,t){1&e&&(Io(0,"span"),ga(1,"\u3010BGM\u3011"),Mo())}function YO(e,t){if(1&e&&(Io(0,"div",10),Eo(1,UO,2,1,"button",11),Eo(2,HO,2,1,"button",11),Eo(3,VO,2,1,"button",11),Eo(4,GO,2,1,"button",11),Eo(5,ZO,2,0,"span",4),Eo(6,WO,2,0,"span",4),Io(7,"span"),ga(8),Mo(),Mo()),2&e){const e=t.$implicit,n=jo();Zr(1),To("ngIf",e!==(null==n.auditionPlayer?null:n.auditionPlayer.audio)||(null==n.auditionPlayer?null:n.auditionPlayer.paused)),Zr(1),To("ngIf",e===(null==n.auditionPlayer?null:n.auditionPlayer.audio)&&!(null!=n.auditionPlayer&&n.auditionPlayer.paused)),Zr(1),To("ngIf",e!==(null==n.jukebox?null:n.jukebox.audio)),Zr(1),To("ngIf",e===(null==n.jukebox?null:n.jukebox.audio)),Zr(1),To("ngIf",e===(null==n.auditionPlayer?null:n.auditionPlayer.audio)&&!(null!=n.auditionPlayer&&n.auditionPlayer.paused)),Zr(1),To("ngIf",e===(null==n.jukebox?null:n.jukebox.audio)),Zr(2),ma(e.name)}}function qO(e,t){1&e&&(Io(0,"div"),ga(1,"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u3053\u3053\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002"),Mo())}let $O=(()=>{class e{constructor(e,t,n){this.modalService=e,this.panelService=t,this.ngZone=n,this.auditionPlayer=new G_,this.lazyUpdateTimer=null,this.math=Math}get volume(){return G_.volume}set volume(e){G_.volume=e}get auditionVolume(){return G_.auditionVolume}set auditionVolume(e){G_.auditionVolume=e}get audios(){return Z_.instance.audios.filter(e=>!e.isHidden)}get jukebox(){return Vy.instance.get("Jukebox")}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30b8\u30e5\u30fc\u30af\u30dc\u30c3\u30af\u30b9"),this.auditionPlayer.volumeType=V_.AUDITION,Uy.register(this).on("*",e=>{e.eventName.startsWith("FILE_")&&this.lazyNgZoneUpdate()})}ngOnDestroy(){Uy.unregister(this),this.stop()}play(e){this.auditionPlayer.play(e)}stop(){this.auditionPlayer.stop()}playBGM(e){this.jukebox.play(e.identifier,!0)}stopBGM(e){this.jukebox.audio===e&&this.jukebox.stop()}handleFileSelect(e){let t=e.target,n=t.files;n.length&&iC.instance.load(n),t.value=""}lazyNgZoneUpdate(){null===this.lazyUpdateTimer&&(this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,this.ngZone.run(()=>{})},100))}}return e.\u0275fac=function(t){return new(t||e)(So(xv),So(wv),So(Rc))},e.\u0275cmp=Ze({type:e,selectors:[["app-jukebox"]],decls:37,vars:10,consts:[[1,"material-icons"],["type","range","min","0","max","1","step","0.01",2,"width","60%",3,"ngModel","title","ngModelChange"],[1,"volume"],["class","box",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","audio/*",2,"display","none",3,"change"],[2,"font-size","12px"],[1,"box"],[3,"disabled","click",4,"ngIf"],[3,"disabled","click"]],template:function(e,t){1&e&&(Io(0,"div"),ga(1,"\u8a66\u8074\u97f3\u91cf\uff1a"),Io(2,"i",0),ga(3),Mo(),Io(4,"input",1),zo("ngModelChange",function(e){return t.auditionVolume=e}),Mo(),Io(5,"span",2),ga(6),Mo(),Mo(),Io(7,"div"),ga(8,"\u518d\u751f\u97f3\u91cf\uff1a"),Io(9,"i",0),ga(10),Mo(),Io(11,"input",1),zo("ngModelChange",function(e){return t.volume=e}),Mo(),Io(12,"span",2),ga(13),Mo(),Mo(),Ao(14,"hr"),Io(15,"div"),Eo(16,YO,9,7,"div",3),Eo(17,qO,2,0,"div",4),Mo(),Io(18,"label"),Io(19,"div",5),Io(20,"div"),Io(21,"i",6),ga(22,"playlist_add"),Mo(),Mo(),Io(23,"div"),ga(24,"\u3053\u3053\u306b\u97f3\u697d\u3092\u30c9\u30ed\u30c3\u30d7"),Mo(),Io(25,"div",7),ga(26,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),Mo(),Io(27,"input",8),zo("change",function(e){return t.handleFileSelect(e)}),Mo(),Io(28,"div",7),Ao(29,"br"),ga(30,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d10MB\u307e\u3067"),Mo(),Mo(),Mo(),Io(31,"div",9),ga(32,"\u203b\u300c\u8a66\u8074\u300d\u306f\u81ea\u5206\u306e\u30b9\u30d4\u30fc\u30ab\u30fc\u3060\u3051\u3067\u97f3\u697d\u30921\u56de\u518d\u751f\u3057\u307e\u3059\u3002"),Mo(),Io(33,"div",9),ga(34,"\u203b\u300cBGM\u300d\u306f\u30eb\u30fc\u30e0\u5185\u306e\u5168\u54e1\u30671\u3064\u306e\u97f3\u697d\u3092\u30eb\u30fc\u30d7\u518d\u751f\u3057\u307e\u3059\u3002"),Mo(),Io(35,"div",9),ga(36,"\u203b\u73fe\u884c\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u306b\u306f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u542b\u307e\u308c\u307e\u305b\u3093\u3002\uff08\u6bce\u56de\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u304c\u5fc5\u8981\u3067\u3059\uff09"),Mo()),2&e&&(Zr(3),ma(0==t.auditionVolume?"volume_off":t.auditionVolume<=.5?"volume_down":"volume_up"),Zr(1),Go("title",t.math.floor(100*t.auditionVolume)+"%"),To("ngModel",t.auditionVolume),Zr(2),ma(t.math.floor(100*t.auditionVolume)+"%"),Zr(4),ma(0==t.volume?"volume_off":t.volume<=.5?"volume_down":"volume_up"),Zr(1),Go("title",t.math.floor(100*t.volume)+"%"),To("ngModel",t.volume),Zr(2),ma(t.math.floor(100*t.volume)+"%"),Zr(3),To("ngForOf",t.audios),Zr(1),To("ngIf",t.audios.length<1))},directives:[Fd,ju,sd,Sd,Vh,Zh],styles:[".drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold,Vollkorn;color:#444;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.volume[_ngcontent-%COMP%]{display:inline-block;width:3em;text-align:right}"]}),e})();const XO=["content"],KO=["*"];let QO=(()=>{class e{constructor(e){this.modalService=e}clickBackground(e){e.target===e.currentTarget&&this.resolve()}resolve(){this.modalService.resolve(null)}reject(){this.modalService.reject()}}return e.\u0275fac=function(t){return new(t||e)(So(xv))},e.\u0275cmp=Ze({type:e,selectors:[["modal"]],viewQuery:function(e,t){if(1&e&&cc(XO,3,kl),2&e){let e;lc(e=hc())&&(t.content=e.first)}},ngContentSelectors:KO,decls:13,vars:3,consts:[[1,"component"],[1,"modal-background",3,"click"],[1,"modal-panel"],[1,"title"],[1,"title-button"],[3,"click"],[1,"material-icons",2,"font-size","14px"],[1,"scrollable-panel"],["content",""]],template:function(e,t){1&e&&(Ho(),Io(0,"div",0),Io(1,"div",1),zo("click",function(e){return t.clickBackground(e)}),Mo(),Io(2,"div",2),Io(3,"div",3),Io(4,"div",4),Io(5,"button",5),zo("click",function(){return t.resolve()}),Io(6,"i",6),ga(7,"close"),Mo(),Mo(),Mo(),ga(8),Mo(),Io(9,"div",7),Vo(10),Ao(11,"div",null,8),Mo(),Mo(),Mo()),2&e&&(Zr(1),To("@bgInOut","in"),Zr(1),To("@flyInOut","in"),Zr(6),ba(" ",t.modalService.title," "))},styles:[".component[_ngcontent-%COMP%]{z-index:9999;display:flex;align-items:center;justify-content:center;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.component[_ngcontent-%COMP%], .modal-background[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;top:0;bottom:0;left:0;right:0}.modal-background[_ngcontent-%COMP%]{color:#ccc;background-color:rgba(30,30,30,.3);z-index:-1}.modal-panel[_ngcontent-%COMP%]{background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:1px solid #999;height:auto;max-height:calc(100% - 10px);width:800px;max-width:100%}.modal-panel[_ngcontent-%COMP%], .title[_ngcontent-%COMP%]{box-sizing:border-box;overflow:hidden;color:#444}.title[_ngcontent-%COMP%]{position:relative;white-space:nowrap;font-size:12px;height:25px;padding:2px 5px;width:100%;background-color:#ccc}.title-button[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#444}.content[_ngcontent-%COMP%], .header[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]{padding:10px}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;max-height:calc(100vh - 41px);width:100%;padding:8px}"],data:{animation:[Jd("flyInOut",[sp("void => *",[ep("100ms ease-out",rp([np({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),np({transform:"scale(1.0, 1.0)",opacity:"1.0",offset:1})]))]),sp("* => void",[ep(100,np({transform:"scale(0, 0)"}))])]),Jd("bgInOut",[ip("in",np({"background-color":"rgba(30, 30, 30, 0.4)"})),sp("void => *",[np({"background-color":"rgba(30, 30, 30, 0.0)"}),ep(200)]),sp("* => void",[ep(200,np({"background-color":"rgba(30, 30, 30, 0.0)"}))])])]}}),e})();class JO{constructor(e,t={capture:!1,passive:!1,always:!1}){this.target=e,this.callbackOnMouse=this.onMouse.bind(this),this.callbackOnTouch=this.onTouch.bind(this),this.callbackOnMenu=this.onMenu.bind(this),this.lastPointers=[],this.primaryPointer={x:0,y:0,z:0,identifier:-9999},this._isDragging=!1,this._isGrabbing=!1,this._isDestroyed=!1,this.option=null,this.option={capture:!0===t.capture,passive:!0===t.passive,always:!0===t.always},this.initialize()}get pointer(){return this.primaryPointer}get isDragging(){return this._isDragging}get isGrabbing(){return this._isGrabbing}get isDestroyed(){return this._isDestroyed}initialize(){this.target.addEventListener("mousedown",this.callbackOnMouse,this.option.capture),this.target.addEventListener("touchstart",this.callbackOnTouch,this.option.capture),this.option.always&&this.addEventListeners()}destroy(){this.cancel(),this._isDestroyed=!0,this.target.removeEventListener("mousedown",this.callbackOnMouse,this.option.capture),this.target.removeEventListener("touchstart",this.callbackOnTouch,this.option.capture),this.removeEventListeners()}cancel(){this._isDragging=this._isGrabbing=!1,this.option.always||this.removeEventListeners()}onMouse(e){let t={x:e.pageX,y:e.pageY,z:0,identifier:-9999};this.isSyntheticEvent(t)||(this.lastPointers=[t],this.primaryPointer=t,this.onPointer(e))}onTouch(e){let t=e.changedTouches.length;if(!(t<1)){this.lastPointers=[];for(let n=0;n<t;n++){let t=e.changedTouches[n];this.lastPointers.push({x:t.pageX,y:t.pageY,z:0,identifier:t.identifier})}if("touchstart"===e.type)this.primaryPointer=this.lastPointers[0];else{let t=Array.from(e.changedTouches).find(e=>e.identifier===this.primaryPointer.identifier);if(null==t)return void(null!=Array.from(e.touches).find(e=>e.identifier===this.primaryPointer.identifier)||(this.onEnd&&this.onEnd(e),this.cancel()));this.primaryPointer={x:t.pageX,y:t.pageY,z:0,identifier:t.identifier}}this.onPointer(e)}}onPointer(e){switch(e.type){case"mousedown":case"touchstart":this._isGrabbing=!0,this._isDragging=!1,this.addEventListeners(),this.onStart&&this.onStart(e);break;case"mousemove":case"touchmove":this.onMove&&this.onMove(e),this._isDragging=this._isGrabbing;break;default:this.onEnd&&this.onEnd(e),this.cancel()}}onMenu(e){this.onContextMenu&&this.onContextMenu(e)}isSyntheticEvent(e,t=15){for(let n of this.lastPointers)if(n.identifier!==e.identifier&&Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2)<Math.pow(t,2))return!0;return!1}addEventListeners(){let e={capture:this.option.capture,passive:this.option.passive};this.target.ownerDocument.addEventListener("mousemove",this.callbackOnMouse,e),this.target.ownerDocument.addEventListener("mouseup",this.callbackOnMouse,e),this.target.ownerDocument.addEventListener("touchmove",this.callbackOnTouch,e),this.target.ownerDocument.addEventListener("touchend",this.callbackOnTouch,e),this.target.ownerDocument.addEventListener("touchcancel",this.callbackOnTouch,e),this.target.ownerDocument.addEventListener("contextmenu",this.callbackOnMenu,e),this.target.ownerDocument.addEventListener("drop",this.callbackOnMouse,e)}removeEventListeners(){let e={capture:this.option.capture};this.target.ownerDocument.removeEventListener("mousemove",this.callbackOnMouse,e),this.target.ownerDocument.removeEventListener("mouseup",this.callbackOnMouse,e),this.target.ownerDocument.removeEventListener("touchmove",this.callbackOnTouch,e),this.target.ownerDocument.removeEventListener("touchend",this.callbackOnTouch,e),this.target.ownerDocument.removeEventListener("touchcancel",this.callbackOnTouch,e),this.target.ownerDocument.removeEventListener("contextmenu",this.callbackOnMenu,e),this.target.ownerDocument.removeEventListener("drop",this.callbackOnMouse,e)}}let eI=(()=>{class e{constructor(e,t){this.ngZone=e,this.elementRef=t,this.isDisable=!1,this.boundsSelector="body",this.handleSelector="",this.unhandleSelector="input,textarea,button,select,option,span",this.stackSelector="",this.opacity=.7,this.onstart=new Xl,this.onmove=new Xl,this.onend=new Xl,this.callbackOnResize=this.adjustPosition.bind(this),this.input=null,this.startPosition={x:0,y:0,z:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={x:0,y:0,z:0}}ngAfterViewInit(){this.initialize(),this.adjustPosition(),this.setForeground()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.input=new JO(this.elementRef.nativeElement),window.addEventListener("resize",this.callbackOnResize,!1)}),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this)}cancel(){this.input.cancel()}destroy(){window.removeEventListener("resize",this.callbackOnResize,!1),this.input.destroy()}onInputStart(e){if(1===e.button||2===e.button)return this.cancel();this.setForeground(),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=this.input.pointer,this.prevTrans={x:0,y:0,z:0};let t=this.isHandleElement(e.target),n=this.isUnhandleElement(e.target),i=null!=e.touches&&this.isScrollableElement(e.target);!t||n||i?this.cancel():e.stopPropagation()}onInputMove(e){let t={x:this.input.pointer.x-this.startPointer.x,y:this.input.pointer.y-this.startPointer.y,z:this.input.pointer.z-this.startPointer.z},n=this.calcCorrectionPosition({x:t.x-this.prevTrans.x,y:t.y-this.prevTrans.y,z:t.z-this.prevTrans.z});t.x+=n.x,t.y+=n.y,t.z+=n.z,0<Math.pow(t.x,2)+Math.pow(t.y,2)+Math.pow(t.z,2)&&(this.elementRef.nativeElement.style.opacity=this.opacity+""),this.elementRef.nativeElement.style.left=t.x+this.startPosition.x+"px",this.elementRef.nativeElement.style.top=t.y+this.startPosition.y+"px",this.prevTrans=t,e.cancelable&&e.preventDefault(),e.stopPropagation()}onInputEnd(e){this.elementRef.nativeElement.style.opacity=null,this.input.isDragging&&e.cancelable&&(this.preventClickIfNeeded(e),e.preventDefault()),e.stopPropagation()}onContextMenu(e){e.stopPropagation()}preventClickIfNeeded(e){if(null!=e.touches)return;let t=this.input.pointer.y-this.startPointer.y,n=this.input.pointer.z-this.startPointer.z,i=Math.pow(this.input.pointer.x-this.startPointer.x,2)+Math.pow(t,2)+Math.pow(n,2);if(Math.pow(15,2)>i)return;let r=e=>{e.cancelable&&e.preventDefault(),e.stopPropagation()};this.elementRef.nativeElement.addEventListener("click",r,!0),setTimeout(()=>this.elementRef.nativeElement.removeEventListener("click",r,!0))}adjustPosition(){let e=this.calcElementPosition(this.elementRef.nativeElement),t=this.calcCorrectionPosition();this.elementRef.nativeElement.style.left=t.x+e.x+"px",this.elementRef.nativeElement.style.top=t.y+e.y+"px"}isHandleElement(e){return this.handleSelector.length<1||this.isContainsElement(e,this.handleSelector)}isUnhandleElement(e){return!(this.unhandleSelector.length<1)&&this.isContainsElement(e,this.unhandleSelector)}isContainsElement(e,t){let n=this.elementRef.nativeElement.querySelectorAll(t);for(let i=0;i<n.length;i++)if(n[i].contains(e))return!0;return!1}isScrollableElement(e){let t=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector),n=e,i=["scroll","auto"],r=["fixed","sticky","-webkit-sticky"];for(;n&&t!==n&&this.elementRef.nativeElement!==n;){let e=window.getComputedStyle(n);if(0<=i.indexOf(e.overflowY)&&n.offsetHeight<n.scrollHeight)return!0;if(0<=r.indexOf(e.position))return!1;n=n.parentElement}return!1}calcCorrectionPosition(e={x:0,y:0,z:0}){let t={x:0,y:0,z:0},n=this.elementRef.nativeElement.getBoundingClientRect(),i=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();return i.right<n.right+e.x&&(t.x+=i.right-(n.right+e.x)),n.left+e.x<i.left&&(t.x+=i.left-(n.left+e.x)),i.bottom<n.bottom+e.y&&(t.y+=i.bottom-(n.bottom+e.y)),n.top+e.y<i.top&&(t.y+=i.top-(n.top+e.y)),t}calcElementPosition(e){let t=window.getComputedStyle(e);return{x:oS.relation(t.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),y:oS.relation(t.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),z:0}}setForeground(){if(this.stackSelector.length<1)return;let e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),t=0,n=99999;e.forEach(e=>{let i=parseInt(e.style.zIndex);t<i&&(t=i),i<n&&(n=i)}),t<=parseInt(this.elementRef.nativeElement.style.zIndex)||(e.forEach(e=>{e.style.zIndex=parseInt(e.style.zIndex)-n+""}),this.elementRef.nativeElement.style.zIndex=t+1+"")}}return e.\u0275fac=function(t){return new(t||e)(So(Rc),So(Ha))},e.\u0275dir=Qe({type:e,selectors:[["","appDraggable",""]],inputs:{isDisable:["draggable.disable","isDisable"],boundsSelector:["draggable.bounds","boundsSelector"],handleSelector:["draggable.handle","handleSelector"],unhandleSelector:["draggable.unhandle","unhandleSelector"],stackSelector:["draggable.stack","stackSelector"],opacity:["draggable.opacity","opacity"]},outputs:{onstart:"draggable.start",onmove:"draggable.move",onend:"draggable.end"}}),e})();var tI=function(e){return e.N="n",e.E="e",e.W="w",e.S="s",e.NE="ne",e.NW="nw",e.SE="se",e.SW="sw",e}({});class nI{constructor(e,t){this.target=e,this.type=t,this.input=null,this.handle=null,this.width=12,this.initialize()}initialize(){this.handle=this.target.ownerDocument.createElement("div"),this.handle.classList.add("ui-resize-handler-"+this.type),this.input=new JO(this.handle),this.target.appendChild(this.handle);let e=this.handle.style;switch(e.position="absolute",e.zIndex="1",e.backgroundColor="transparent",this.type){case tI.N:e.top=3*-this.width/4+"px",e.left="0px",e.right="0px",e.height=`${this.width}px`,e.cursor="ns-resize";break;case tI.E:e.top="0px",e.bottom="0px",e.right=3*-this.width/4+"px",e.width=`${this.width}px`,e.cursor="ew-resize";break;case tI.W:e.top="0px",e.bottom="0px",e.left=3*-this.width/4+"px",e.width=`${this.width}px`,e.cursor="ew-resize";break;case tI.S:e.bottom=3*-this.width/4+"px",e.left="0px",e.right="0px",e.height=`${this.width}px`,e.cursor="ns-resize";break;case tI.NE:e.top=3*-this.width/4+"px",e.right=3*-this.width/4+"px",e.width=3*this.width/2+"px",e.height=3*this.width/2+"px",e.cursor="nesw-resize",e.zIndex="2";break;case tI.NW:e.top=3*-this.width/4+"px",e.left=3*-this.width/4+"px",e.width=3*this.width/2+"px",e.height=3*this.width/2+"px",e.cursor="nwse-resize",e.zIndex="2";break;case tI.SE:e.bottom=3*-this.width/4+"px",e.right=3*-this.width/4+"px",e.width=3*this.width/2+"px",e.height=3*this.width/2+"px",e.cursor="nwse-resize",e.zIndex="2";break;case tI.SW:e.bottom=3*-this.width/4+"px",e.left=3*-this.width/4+"px",e.width=3*this.width/2+"px",e.height=3*this.width/2+"px",e.cursor="nesw-resize",e.zIndex="2"}}destroy(){this.handle.remove(),this.input.destroy()}}let iI=(()=>{class e{constructor(e,t){this.ngZone=e,this.elementRef=t,this.isDisable=!1,this.boundsSelector="body",this.minWidth=100,this.minHeight=100,this.ostart=new Xl,this.onmove=new Xl,this.onend=new Xl,this.handleMap=new Map,this.handleTypes=[tI.N,tI.E,tI.W,tI.S,tI.NE,tI.NW,tI.SE,tI.SW],this.startPosition={left:0,top:0,width:0,height:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={left:0,top:0,width:0,height:0}}ngAfterViewInit(){this.initialize()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.handleTypes.forEach(e=>{let t=new nI(this.elementRef.nativeElement,e);this.handleMap.set(e,t),t.input.onStart=e=>this.onResizeStart(e,t),t.input.onMove=e=>this.onResizeMove(e,t),t.input.onEnd=e=>this.onResizeEnd(e,t),t.input.onContextMenu=e=>this.onContextMenu(e,t)})})}cancel(){this.handleMap.forEach(e=>e.input.cancel())}destroy(){this.handleMap.forEach(e=>e.input.destroy())}onResizeStart(e,t){if(1===e.button||2===e.button)return this.cancel();this.handleMap.forEach(e=>{e!==t&&e.input.cancel()}),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=t.input.pointer,this.prevTrans={left:0,top:0,width:0,height:0},e.stopPropagation()}onResizeMove(e,t){let n={left:0,top:0,width:t.input.pointer.x-this.startPointer.x,height:t.input.pointer.y-this.startPointer.y};switch(t.type){case tI.N:case tI.S:n.width=0;break;case tI.E:case tI.W:n.height=0}switch(t.type){case tI.SW:n.left=n.width,n.width*=-1;break;case tI.NE:n.top=n.height,n.height*=-1;break;case tI.E:case tI.S:case tI.SE:break;case tI.N:case tI.W:case tI.NW:n.left=n.width,n.top=n.height,n.width*=-1,n.height*=-1}n.width+this.startPosition.width<this.minWidth&&(n.width=this.minWidth-this.startPosition.width,n.left=0!==n.left?-n.width:n.left),n.height+this.startPosition.height<this.minHeight&&(n.height=this.minHeight-this.startPosition.height,n.top=0!==n.top?-n.height:n.top);let i=this.calcCorrectionPosition({left:n.left-this.prevTrans.left,top:n.top-this.prevTrans.top,width:n.width-this.prevTrans.width,height:n.height-this.prevTrans.height});n.left+=i.left,n.top+=i.top,n.width+=i.width,n.height+=i.height,this.elementRef.nativeElement.style.left=n.left+this.startPosition.left+"px",this.elementRef.nativeElement.style.top=n.top+this.startPosition.top+"px",this.elementRef.nativeElement.style.width=n.width+this.startPosition.width+"px",this.elementRef.nativeElement.style.height=n.height+this.startPosition.height+"px",this.prevTrans=n,e.cancelable&&e.preventDefault(),e.stopPropagation()}onResizeEnd(e,t){t.input.isDragging&&e.cancelable&&e.preventDefault(),e.stopPropagation()}onContextMenu(e,t){e.stopPropagation()}calcCorrectionPosition(e={left:0,top:0,width:0,height:0}){let t={left:0,top:0,width:0,height:0},n=this.elementRef.nativeElement.getBoundingClientRect(),i=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();return i.right<n.right+e.left+e.width&&(t.width+=i.right-(n.right+e.left+e.width)),n.left+e.left<i.left&&(t.left+=i.left-(n.left+e.left),t.width-=t.left),i.bottom<n.bottom+e.top+e.height&&(t.height+=i.bottom-(n.bottom+e.top+e.height)),n.top+e.top<i.top&&(t.top+=i.top-(n.top+e.top),t.height-=t.top),t}calcElementPosition(e){let t=window.getComputedStyle(e);return{left:oS.relation(t.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),top:oS.relation(t.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),width:oS.relation(t.width,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),height:oS.relation(t.height,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight)}}}return e.\u0275fac=function(t){return new(t||e)(So(Rc),So(Ha))},e.\u0275dir=Qe({type:e,selectors:[["","appResizable",""]],inputs:{isDisable:["resizable.disable","isDisable"],boundsSelector:["resizable.bounds","boundsSelector"],minWidth:["resizable.minWidth","minWidth"],minHeight:["resizable.minHeight","minHeight"]},outputs:{ostart:"resizable.start",onmove:"resizable.move",onend:"resizable.end"}}),e})();const rI=["draggablePanel"],sI=["scrollablePanel"],oI=["content"];function aI(e,t){if(1&e){const e=Fo();Io(0,"button",8),zo("click",function(){return Ft(e),jo().toggleFullScreen()}),Io(1,"i",9),ga(2,"fullscreen"),Mo(),Mo()}}function lI(e,t){if(1&e){const e=Fo();Io(0,"button",8),zo("click",function(){return Ft(e),jo().close()}),Io(1,"i",9),ga(2,"close"),Mo(),Mo()}}const cI=function(e){return{"pointer-events-none":e}},hI=["*"];let uI=(()=>{class e{constructor(e,t){this.panelService=e,this.pointerDeviceService=t,this.preLeft=0,this.preTop=0,this.preWidth=100,this.preHeight=100,this.isFullScreen=!1}set title(e){this.panelService.title=e}set left(e){this.panelService.left=e}set top(e){this.panelService.top=e}set width(e){this.panelService.width=e}set height(e){this.panelService.height=e}set isAbleFullScreenButton(e){this.panelService.isAbleFullScreenButton=e}set isAbleCloseButton(e){this.panelService.isAbleCloseButton=e}get title(){return this.panelService.title}get left(){return this.panelService.left}get top(){return this.panelService.top}get width(){return this.panelService.width}get height(){return this.panelService.height}get isAbleFullScreenButton(){return this.panelService.isAbleFullScreenButton}get isAbleCloseButton(){return this.panelService.isAbleCloseButton}get isPointerDragging(){return this.pointerDeviceService.isDragging}ngOnInit(){this.panelService.scrollablePanel=this.scrollablePanel.nativeElement}toggleFullScreen(){let e=this.draggablePanel.nativeElement;e.style.transition="width 0.1s ease-in-out, height 0.1s ease-in-out",setTimeout(()=>{e.style.transition=null},100),this.isFullScreen=!(e.offsetLeft<=0&&e.offsetTop<=0&&e.offsetWidth>=window.innerWidth&&e.offsetHeight>=window.innerHeight),this.isFullScreen?(this.preLeft=e.offsetLeft,this.preTop=e.offsetTop,this.preWidth=e.offsetWidth,this.preHeight=e.offsetHeight,this.left=0,this.top=0,this.width=window.innerWidth,this.height=window.innerHeight,e.style.left=this.left+"px",e.style.top=this.top+"px",e.style.width=this.width+"px",e.style.height=this.height+"px"):(this.left=this.preLeft,this.top=this.preTop,this.width=this.preWidth,this.height=this.preHeight)}close(){this.panelService&&this.panelService.close()}}return e.\u0275fac=function(t){return new(t||e)(So(wv),So(Kw))},e.\u0275cmp=Ze({type:e,selectors:[["ui-panel"]],viewQuery:function(e,t){if(1&e&&(cc(rI,3),cc(sI,3),cc(oI,3,kl)),2&e){let e;lc(e=hc())&&(t.draggablePanel=e.first),lc(e=hc())&&(t.scrollablePanel=e.first),lc(e=hc())&&(t.content=e.first)}},inputs:{title:"title",left:"left",top:"top",width:"width",height:"height",isAbleFullScreenButton:"isAbleFullScreenButton",isAbleCloseButton:"isAbleCloseButton"},features:[Fa([wv])],ngContentSelectors:hI,decls:12,vars:16,consts:[["appDraggable","","appResizable","",1,"draggable-panel",3,"ngClass","draggable.stack"],["draggablePanel",""],[1,"title"],[1,"title-button"],[3,"click",4,"ngIf"],[1,"scrollable-panel"],["scrollablePanel",""],["content",""],[3,"click"],[1,"material-icons",2,"font-size","14px"]],template:function(e,t){1&e&&(Ho(),Io(0,"div",0,1),Io(2,"div",2),Io(3,"div",3),Eo(4,aI,3,0,"button",4),Eo(5,lI,3,0,"button",4),Mo(),ga(6),Mo(),Io(7,"div",5,6),Vo(9),Ao(10,"div",null,7),Mo(),Mo()),2&e&&(ta("left",t.left,"px")("top",t.top,"px")("width",t.width,"px")("height",t.height,"px"),To("@flyInOut","in")("ngClass",Ul(14,cI,t.isPointerDragging))("draggable.stack",".draggable-panel"),Zr(4),To("ngIf",t.isAbleFullScreenButton),Zr(1),To("ngIf",t.isAbleCloseButton),Zr(1),ba(" ",t.panelService.title," "))},directives:[eI,iI,Uh,Zh],styles:[".draggable-panel[_ngcontent-%COMP%]{overflow:visible;color:#444;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:1px solid #999;padding:0;top:200px;height:200px;width:300px;max-height:100%;max-width:100%}.draggable-panel[_ngcontent-%COMP%], .scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute}.scrollable-panel[_ngcontent-%COMP%]{overflow:auto;top:25px;bottom:0;width:100%;padding:8px;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;padding:2px 5px;width:100%;background-color:#555;color:#ccc;-webkit-user-select:none;-moz-user-select:none;user-select:none}.title-button[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#ccc}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}"],data:{animation:[Jd("flyInOut",[sp("void => *",[ep("100ms ease-out",rp([np({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),np({transform:"scale(1.0, 1.0)",opacity:"1",offset:1})]))]),sp("* => void",[ep(100,np({transform:"scale(0, 0)"}))])])]}}),e})();const dI=["standImageElement"],pI=function(e){return{"emote-secret":e}};function fI(e,t){if(1&e&&(Io(0,"div",12),ga(1),Mo()),2&e){const e=jo(3);ta("visibility",e.isShowStand&&e.isApplyDialog?"visible":"hidden")("width",e.imageWidth,"px")("font-size",e.imageWidth/4.5>16?e.imageWidth/4.5:16,"px")("color",e.color?e.color:"#444"),To("@fadeAndScaleInOut",void 0)("ngClass",Ul(11,pI,e.isSecret)),Zr(1),ma(e.gameCharacter.text)}}const gI=function(e,t){return{"transform-origin":e,transform:t}},mI=function(e){return{inverse:e}},bI=function(e,t,n,i,r,s,o,a){return{black:e,blue:t,green:n,cyan:i,red:r,magenta:s,yellow:o,white:a}},yI=function(e,t){return{"black-paint":e,hollow:t}};function vI(e,t){if(1&e){const e=Fo();Po(0),Eo(1,fI,2,13,"div",5),Io(2,"div",6),Io(3,"div",7),Io(4,"div",8),Io(5,"div",9),Io(6,"img",10,11),zo("load",function(){return Ft(e),jo(2).onImageLoad()}),ql(8,"safe"),Mo(),Mo(),Mo(),Mo(),Mo(),Do()}if(2&e){const e=jo(2);Zr(1),To("ngIf",!e.isBackyard&&e.gameCharacter.isEmote),Zr(1),To("ngStyle",Hl(11,gI,e.standImageTransformOrigin,e.isApplyRoll?"rotate("+e.gameCharacter.roll+"deg)":"")),Zr(1),To("ngClass",Ul(14,mI,e.isApplyImageEffect&&e.gameCharacter.isInverse)),Zr(1),To("ngClass",Zl(16,bI,e.isApplyImageEffect&&0==e.gameCharacter.aura,e.isApplyImageEffect&&1==e.gameCharacter.aura,e.isApplyImageEffect&&2==e.gameCharacter.aura,e.isApplyImageEffect&&3==e.gameCharacter.aura,e.isApplyImageEffect&&4==e.gameCharacter.aura,e.isApplyImageEffect&&5==e.gameCharacter.aura,e.isApplyImageEffect&&6==e.gameCharacter.aura,e.isApplyImageEffect&&7==e.gameCharacter.aura)),Zr(2),ta("height",e.height>0?e.height+"vh":"auto"),To("src",$l(8,8,e.standImage.url,"resourceUrl"),Xi)("ngClass",Hl(25,yI,e.isApplyImageEffect&&e.gameCharacter.isBlackPaint,e.isApplyImageEffect&&e.gameCharacter.isHollow))}}const _I=function(e,t,n,i){return{"is-can-be-gone":e,"is-ghostly":t,backyard:n,secret:i}};function wI(e,t){if(1&e){const e=Fo();Io(0,"div",3),zo("click",function(){Ft(e);const t=jo();return t.toGhostly(),t.toBackyard()}),Eo(1,vI,9,28,"ng-container",4),Mo()}if(2&e){const e=jo();ta("left",e.position+"%")("height",0==e.height?"":e.height+"vh")("margin-left",-e.imageWidth/2,"px")("margin-bottom",e.adjustY,"px"),To("@standInOut",e.groupValue)("ngClass",Gl(11,_I,e.isCanBeGone,e.isGhostly,e.isBackyard,e.isSecret)),Zr(1),To("ngIf",e.gameCharacter&&e.standImage.url&&e.standImage.url.length>0)}}const CI=function(e,t,n){return{"is-can-be-gone":e,"is-ghostly":t,backyard:n}};function xI(e,t){if(1&e&&(Io(0,"span",13),Io(1,"b"),ga(2),Mo(),Mo()),2&e){const e=jo();ta("color",e.color?e.color:"#444")("left",e.position+"%")("margin-bottom",e.adjustY>0?e.adjustY:0,"px")("border-color",e.color?e.color:"#444")("margin-left",e.nameTagCSSMarginLeft,"px"),To("ngClass",Vl(12,CI,e.isCanBeGone,e.isGhostly,e.isBackyard)),Zr(2),ma(e.gameCharacter.name)}}const EI=function(e,t,n){return{left:e,right:t,"transform-origin":n}},kI=function(e,t,n,i,r,s){return{"is-can-be-gone":e,"is-ghostly":t,backyard:n,"dialog-secret":i,"is-position-right":r,"is-position-left":s}};function SI(e,t){if(1&e){const e=Fo();Io(0,"div",14),zo("click",function(){Ft(e);const t=jo();return t.toGhostly(),t.toBackyard()}),Io(1,"div",15),zo("@dialogShake.start",function(t){return Ft(e),jo().onSpeaking(t)}),ga(2),Mo(),Mo()}if(2&e){const e=jo();ta("visibility",e.isShowStand&&e.isApplyDialog?"visible":"hidden")("color",e.isSecret?"#ccc":e.color?e.color:"#444")("left",e.dialogBoxCSSLeft,"px")("bottom",e.dialogBoxCssBottom+e.adjustY>12?e.dialogBoxCssBottom:12,"px")("max-width",e.dialogBoxCSSMaxWidth,"px")("margin-bottom",e.dialogBoxCssBottom+e.adjustY>12?e.adjustY:0,"px")("border-color",e.color?e.color:"#444"),To("@fadeAndScaleInOut",void 0)("ngStyle",Vl(19,EI,e.position<=50?e.dialogBoxCSSLeft+"px":"auto",e.position>50?e.dialogBoxCSSRight+"px":"auto",e.position<=50?"12px calc(100% + 12px)":"calc(100% - 12px) calc(100% + 12px)"))("ngClass",function(e,t,n,i,r,s,o,a,l){const c=Vt()+23,h=Dt(),u=wo(h,c,n,i,r,s);return vo(h,c+4,o,a)||u?mo(h,c+6,t(n,i,r,s,o,a)):bo(h,c+6)}(0,kI,e.isCanBeGone,e.isGhostly,e.isBackyard,e.isSecret,e.position<=50,e.position>50)),Zr(1),To("@dialogShake",e.dialogText.length),Zr(1),ma(e.dialogText)}}let TI=(()=>{class e{constructor(e){this.ngZone=e,this._imageFile=Ig.Empty,this.isFarewell=!1,this.isGhostly=!1,this.isBackyard=!1,this.isVisible=!1,this.isSecret=!1,this.standImageTransformOrigin="center",this.naturalWidth=0,this.naturalHeight=0,this.isSpeaking=!1}onSpeaking(e){this.gameCharacter&&this.gameCharacter.text&&(this.isApplyDialog||this.isSpeakable||this.gameCharacter.isShowChatBubble)&&(clearTimeout(this._timeoutId),this._timeoutId=setTimeout(()=>{this.ngZone.run(()=>{this.isVisible=!1})},12e3)),this.isSpeakable&&(clearTimeout(this._dialogTimeoutId),this.gameCharacter&&this.gameCharacter.text&&(this.isSpeaking=!0),this._dialogTimeoutId=setTimeout(()=>{this.isSpeaking=!1},200))}get isShowStand(){return e.isShowStand}get isShowNameTag(){return e.isShowNameTag}get isCanBeGone(){return e.isCanBeGone}get dialogText(){return this.gameCharacter&&this.gameCharacter.text?this.gameCharacter.text.replace(/[\r\n]{2,}/g,"\n\n").replace(/                            /g,"").trim():""}get standImage(){if(!this.standElement)return this._imageFile;let e=null;if(this.isSpeaking&&(e=this.standElement.getFirstElementByName("speakingImageIdentifier")),e&&e.value&&e.value!=Ig.Empty.identifier||(e=this.standElement.getFirstElementByName("imageIdentifier")),e&&this._imageFile.identifier!==e.value){let t=ov.instance.get(e.value);this._imageFile=t||Ig.Empty}return this._imageFile}get isSpeakable(){if(!this.standElement)return!1;let e=this.standElement.getFirstElementByName("speakingImageIdentifier");return e&&e.value&&e.value!==Ig.Empty.identifier}ngOnInit(){}ngOnDestroy(){clearTimeout(this._timeoutId),clearTimeout(this._dialogTimeoutId)}get group(){if(!this.gameCharacter)return"";let e=this.standElement.getFirstElementByName("name");return e.currentValue&&e.currentValue.toString().length>0?e.currentValue.toString():""}get groupValue(){let e=0;const t=this.group;for(let n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n),e|=0;return e}get position(){if(!this.gameCharacter)return 0;let e=this.standElement.getFirstElementByName("position");return e&&e.currentValue?+e.value:this.gameCharacter.standList.position}get adjustY(){if(!this.gameCharacter)return 0;let e=this.standElement.getFirstElementByName("height");return this.imageHeight*(e&&e.currentValue?+e.currentValue:0)/100}get height(){if(!this.gameCharacter||!this.standElement)return 0;let e=this.standElement.getFirstElementByName("height");return e&&0!=+e.value||!this.gameCharacter.standList?e?+e.value:0:this.gameCharacter.standList.height}get imageHeight(){return 0==this.height?this.naturalHeight:document.documentElement.offsetHeight*this.height/100}get imageWidth(){return this.imageHeight*this.naturalWidth/this.naturalHeight}get dialogBoxCSSLeft(){return this.imageWidth*(this.position>50?.33:.66)-this.imageWidth/2-12+this.position*document.documentElement.clientWidth/100-(this.position>50?this.dialogBoxCSSMaxWidth:0)}get dialogBoxCSSRight(){return document.documentElement.clientWidth-this.dialogBoxCSSLeft-this.dialogBoxCSSMaxWidth}get dialogBoxCSSMaxWidth(){let e=this.imageWidth/document.documentElement.clientWidth;return e/=2,e<.14&&(e=.14),e*document.documentElement.clientWidth}get dialogBoxCssBottom(){let e=.66*this.imageHeight;return e<48&&(e=48),e}get nameTagCSSMarginLeft(){let e=this.imageWidth/2-this.position*document.documentElement.clientWidth/100;return e<32&&(e=32),-this.imageWidth/2+e}get isApplyImageEffect(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("applyImageEffect");return!(!e||!e.value)}get isApplyRoll(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("applyRoll");return!(!e||!e.value)}get isApplyDialog(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("applyDialog");return!(!e||!e.value)}calcStandImageTransformOrigin(){if(!this.standImageElement)return"center";let e=1-this.naturalWidth/(2*this.naturalHeight);return e>.66&&(e=.66),"center "+100*e+"%"}toGhostly(){this.ngZone.run(()=>{this.isGhostly=!0})}toBackyard(){this.ngZone.run(()=>{this.isBackyard=!0})}toFront(){this.ngZone.run(()=>{this.isFarewell=!1,this.isGhostly=!1,this.isBackyard=!1,this.isVisible=!0}),clearTimeout(this._timeoutId),this._timeoutId=setTimeout(()=>{this.ngZone.run(()=>{this.isVisible=!1})},12e3)}toFarewell(){this.ngZone.run(()=>{this.isFarewell=!0,this.isVisible=!1})}onImageLoad(){this.naturalWidth=this.standImageElement.nativeElement.naturalWidth,this.naturalHeight=this.standImageElement.nativeElement.naturalHeight,this.standImageTransformOrigin=this.calcStandImageTransformOrigin()}}return e.isShowStand=!0,e.isShowNameTag=!0,e.isCanBeGone=!0,e.\u0275fac=function(t){return new(t||e)(So(Rc))},e.\u0275cmp=Ze({type:e,selectors:[["stand-image"]],viewQuery:function(e,t){if(1&e&&cc(dI,1),2&e){let e;lc(e=hc())&&(t.standImageElement=e.first)}},inputs:{gameCharacter:"gameCharacter",standElement:"standElement",color:"color"},decls:4,vars:7,consts:[["class","stand-image-container",3,"left","height","margin-left","margin-bottom","ngClass","click",4,"ngIf"],["class","name-tag","style","pointer-events: none;",3,"color","ngClass","left","margin-bottom","border-color","margin-left",4,"ngIf"],["class","name-tag dialog chat-bubble-buyo","style","margin-left: 12px; min-width: 5em; white-space: pre-wrap; font-size: 14px; pointer-events: none;",3,"visibility","color","left","bottom","max-width","margin-bottom","ngStyle","ngClass","border-color","click",4,"ngIf"],[1,"stand-image-container",3,"ngClass","click"],[4,"ngIf"],["class","emote chat-bubble-buyo","style","position: absolute; pointer-events: none; text-align: center; margin-top: -1em",3,"visibility","width","font-size","color","ngClass",4,"ngIf"],[3,"ngStyle"],[1,"inverser",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"color-fillter"],[1,"stand-image",3,"src","ngClass","load"],["standImageElement",""],[1,"emote","chat-bubble-buyo",2,"position","absolute","pointer-events","none","text-align","center","margin-top","-1em",3,"ngClass"],[1,"name-tag",2,"pointer-events","none",3,"ngClass"],[1,"name-tag","dialog","chat-bubble-buyo",2,"margin-left","12px","min-width","5em","white-space","pre-wrap","font-size","14px","pointer-events","none",3,"ngStyle","ngClass","click"],[2,"width","100%"]],template:function(e,t){1&e&&(Io(0,"div"),Eo(1,wI,2,16,"div",0),Eo(2,xI,3,16,"span",1),Eo(3,SI,3,30,"div",2),Mo()),2&e&&(ta("visibility",t.isShowStand?"visible":"hidden")("pointer-events",t.isShowStand?"auto":"none"),Zr(1),To("ngIf",!t.isFarewell&&(t.isVisible||!t.isCanBeGone)),Zr(1),To("ngIf",t.isShowStand&&!t.isFarewell&&(t.isVisible||!t.isCanBeGone)&&t.isShowNameTag&&t.gameCharacter&&t.gameCharacter.name),Zr(1),To("ngIf",!t.isFarewell&&t.isVisible&&!t.isBackyard&&t.gameCharacter&&t.gameCharacter.text&&!t.gameCharacter.isEmote))},directives:[Zh,Uh,Qh],pipes:[$_],styles:['.stand-image-container[_ngcontent-%COMP%]{position:absolute;display:inline-block;bottom:-.1%;z-index:1000000;transition:opacity .1s ease-in}.is-ghostly[_ngcontent-%COMP%]{z-index:900000}.is-can-be-gone.is-ghostly[_ngcontent-%COMP%]{opacity:.5;filter:brightness(.5)}.backyard[_ngcontent-%COMP%]{pointer-events:none;z-index:0}.name-tag[_ngcontent-%COMP%]{color:#444;background-color:#f5f5f5;border:2px solid #444;border-radius:24px 24px 24px 24px;padding:4px 12px;bottom:2px;display:inline-block;white-space:nowrap;position:absolute;font-size:16px;opacity:.9;z-index:1000005}.name-tag.is-ghostly[_ngcontent-%COMP%]{z-index:900005}.is-can-be-gone.name-tag.is-ghostly[_ngcontent-%COMP%]{opacity:.5}.name-tag.backyard[_ngcontent-%COMP%]{z-index:1}.is-can-be-gone.is-ghostly.backyard[_ngcontent-%COMP%]{opacity:.25}.secret[_ngcontent-%COMP%]   .color-fillter[_ngcontent-%COMP%]{filter:grayscale(80%)}.name-tag.dialog[_ngcontent-%COMP%]{border-radius:24px 24px 24px 12px}.name-tag.dialog-secret[_ngcontent-%COMP%]{border-radius:24px 12px 24px 12px;background:rgba(85,85,85,.9)}.name-tag.dialog.is-position-left[_ngcontent-%COMP%]{border-radius:24px 24px 12px 24px}.name-tag.dialog.dialog-secret.is-position-left[_ngcontent-%COMP%]{border-radius:12px 24px 12px 24px}.emote[_ngcontent-%COMP%]{text-align:center;font-size:48px;font-weight:700;border:none;background:none;-webkit-text-stroke:2px #f5f5f5}.emote.emote-secret[_ngcontent-%COMP%]{-webkit-text-stroke:2px #555}.emote.emote-secret.is-ghostly[_ngcontent-%COMP%]{z-index:900005}.emote[_ngcontent-%COMP%]{z-index:1000005}.emote.is-ghostly[_ngcontent-%COMP%]{z-index:900005}.dialog.is-position-right[_ngcontent-%COMP%]:after{left:17px;margin:0 0 0 -12px}.dialog.is-position-left[_ngcontent-%COMP%]:before, .dialog.is-position-right[_ngcontent-%COMP%]:after{box-sizing:border-box;content:"";position:absolute;padding:0;line-height:1;vertical-align:baseline;bottom:-25px;border:12px solid transparent;border-top-color:inherit}.dialog.is-position-left[_ngcontent-%COMP%]:before{right:17px;margin:0 -12px 0 0}@supports (-moz-user-select:-moz-none){.dialog.is-position-left[_ngcontent-%COMP%]:before, .dialog.is-position-right[_ngcontent-%COMP%]:after{bottom:-39px!important}}.chat-bubble-buyo[_ngcontent-%COMP%]{transition:transform .2s ease;-webkit-animation:chat-bubble-buyo 1.2s ease-in-out .1s infinite alternate;animation:chat-bubble-buyo 1.2s ease-in-out .1s infinite alternate;transform:scale3d(.9,.9,.9)}.chat-bubble-buyo.emote[_ngcontent-%COMP%]{-webkit-animation-duration:.6s;animation-duration:.6s;transform-origin:center bottom}@-webkit-keyframes chat-bubble-buyo{0%{transform:scale3d(.9,.9,.9)}to{transform:scaleX(1)}}@keyframes chat-bubble-buyo{0%{transform:scale3d(.9,.9,.9)}to{transform:scaleX(1)}}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms ease 0s}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #fff)}'],data:{animation:[Jd("standInOut",[sp("void => *,:increment,:decrement",[ep("132ms cubic-bezier(.21,.97,.75,1.25)",rp([np({opacity:.6,transform:"translateY(48px) scale(0.9)",offset:0}),np({opacity:1,transform:"translateY(0px) scale(1.0)",offset:1})]))]),sp("* => void,:increment,:decrement",[ep("132ms ease-out",rp([np({transform:"translateY(0px) scale(1.0)",offset:0}),np({opacity:0,transform:"translateY(96px) scale(0.9)",offset:1})]))])]),Jd("dialogShake",[sp(":increment",[ep("19ms ease",rp([np({transform:"translateX(1px)"})])),ep("19ms ease",rp([np({transform:"translateX(-1px)"})]))])]),Jd("fadeAndScaleInOut",[sp("void => *, true => false",[ep("200ms ease-in-out",rp([np({transform:"scale3d(0, 0, 0)",opacity:0}),np({transform:"scale3d(0.9, 0.9, 0.9)",opacity:.9})]))]),sp("* => void, true => false",[ep("100ms ease-in-out",np({transform:"scale3d(0, 0, 0)",opacity:0}))])])]}}),e})(),OI=(()=>{class e{constructor(e){this.componentFactoryResolver=e}show(t,n,i=null,r=!1){let s=!0;for(const o of e.currentStandImageShowing){const a=o[0],l=o[1];if(!l)continue;const c=l.instance;c.isVisible&&t.identifier!=a?c.toGhostly():t.identifier==a&&"graveyard"!=t.location.name?(c.standElement=n,c.color=i||t.chatPalette.color,c.isSecret=r,c.toFront(),s=!1):(c.isFarewell||TI.isCanBeGone)&&(l.destroy(),e.currentStandImageShowing.delete(a))}if(s&&"graveyard"!=t.location.name){const s=e.defaultParentViewContainerRef.createComponent(this.componentFactoryResolver.resolveComponentFactory(TI));s.instance.gameCharacter=t,s.instance.standElement=n,s.instance.color=i||t.chatPalette.color,s.instance.isSecret=r,s.instance.toFront(),e.currentStandImageShowing.set(t.identifier,s)}}farewell(t){t instanceof gv&&(t=t.identifier);const n=e.currentStandImageShowing.get(t);n&&n.instance&&n.instance.toFarewell()}destroyAll(){for(const t of e.currentStandImageShowing){const n=t[0],i=t[1];i&&(i.destroy(),e.currentStandImageShowing.delete(n))}}}return e.currentStandImageShowing=new Map,e.\u0275fac=function(t){return new(t||e)(oi(La))},e.\u0275prov=pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const II=["diceRollTableSelecter"];function MI(e,t){if(1&e&&(Io(0,"option",8),ga(1),Mo()),2&e){const e=t.$implicit;Go("value",e.identifier),Zr(1),ma(e.name)}}function AI(e,t){if(1&e&&(Io(0,"div",24),ga(1),Mo()),2&e){const e=jo(3);Zr(1),ba("",e.progresPercent,"%")}}const PI=function(e){return{"is-hidden":e}};function DI(e,t){if(1&e){const e=Fo();Po(0),Io(1,"button",18),zo("click",function(){return Ft(e),jo(2).upTabIndex()}),ga(2,"\u2191"),Mo(),Io(3,"button",18),zo("click",function(){return Ft(e),jo(2).downTabIndex()}),ga(4,"\u2193"),Mo(),Io(5,"button",19),zo("click",function(){return Ft(e),jo(2).save()}),Io(6,"div",20),Io(7,"div",21),ga(8,"\u4fdd\u5b58"),Mo(),Eo(9,AI,2,1,"div",22),Mo(),Mo(),Io(10,"button",23),zo("click",function(){return Ft(e),jo(2).delete()}),ga(11,"\u524a\u9664"),Mo(),Do()}if(2&e){const e=jo(2);Zr(5),To("disabled",e.isSaveing),Zr(2),To("ngClass",Ul(3,PI,e.isSaveing)),Zr(2),To("ngIf",e.isSaveing)}}function RI(e,t){if(1&e){const e=Fo();Po(0),Io(1,"button",18),zo("click",function(){return Ft(e),jo(2).restore()}),ga(2,"\u5143\u306b\u623b\u3059"),Mo(),Do()}}function FI(e,t){if(1&e){const e=Fo();Po(0),Io(1,"div",9),Io(2,"button",10),zo("click",function(){return Ft(e),jo().helpDiceRollTable()}),ga(3,"?"),Mo(),Io(4,"div",11),Io(5,"b"),ga(6,"name: "),Mo(),Io(7,"input",12),zo("ngModelChange",function(t){return Ft(e),jo().diceRollTableName=t}),Mo(),Mo(),Io(8,"div"),Io(9,"span",13),Io(10,"b"),ga(11,"command: "),Mo(),Io(12,"input",14),zo("ngModelChange",function(t){return Ft(e),jo().diceRollTableCommand=t}),Mo(),Mo(),Io(13,"span",15),Io(14,"b"),ga(15,"dice: "),Mo(),Io(16,"input",16),zo("ngModelChange",function(t){return Ft(e),jo().diceRollTableDice=t}),Mo(),Mo(),Mo(),Mo(),Io(17,"div"),Io(18,"textarea",17),zo("ngModelChange",function(t){return Ft(e),jo().diceRollTableText=t}),Mo(),Mo(),Ao(19,"hr"),Io(20,"div"),Eo(21,DI,12,5,"ng-container",7),Eo(22,RI,3,0,"ng-container",7),Mo(),Do()}if(2&e){const e=jo();Zr(7),To("ngModel",e.diceRollTableName),Co("disabled",e.isEditable?null:""),Zr(5),To("ngModel",e.diceRollTableCommand),Co("disabled",e.isEditable?null:""),Zr(4),To("ngModel",e.diceRollTableDice),Co("disabled",e.isEditable?null:""),Zr(2),To("ngModel",e.diceRollTableText),Zr(3),To("ngIf",!e.isDeleted),Zr(1),To("ngIf",e.isDeleted)}}function NI(e,t){1&e&&(Po(0),Io(1,"div",25),ga(2,"\u203b\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u304c\u3042\u308a\u307e\u305b\u3093\u3002"),Mo(),Do())}let zI=(()=>{class e{constructor(e,t,n,i){this.pointerDeviceService=e,this.modalService=t,this.panelService=n,this.saveDataService=i,this.selectedDiceRollTable=null,this.selectedDiceRollTableXml="",this.isSaveing=!1,this.progresPercent=0}get diceRollTableName(){return this.selectedDiceRollTable.name}set diceRollTableName(e){this.isEditable&&(this.selectedDiceRollTable.name=e)}get diceRollTableDice(){return this.selectedDiceRollTable.dice}set diceRollTableDice(e){this.isEditable&&(this.selectedDiceRollTable.dice=e)}get diceRollTableCommand(){return this.selectedDiceRollTable.command}set diceRollTableCommand(e){this.isEditable&&(this.selectedDiceRollTable.command=e)}get diceRollTableText(){return this.selectedDiceRollTable.value}set diceRollTableText(e){this.isEditable&&(this.selectedDiceRollTable.value=e)}get diceRollTables(){return yv.instance.children}get isEmpty(){return this.diceRollTables.length<1}get isDeleted(){return!!this.selectedDiceRollTable&&null==Vy.instance.get(this.selectedDiceRollTable.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u8a2d\u5b9a"),Uy.register(this).on("DELETE_GAME_OBJECT",1e3,e=>{if(!this.selectedDiceRollTable||e.data.identifier!==this.selectedDiceRollTable.identifier)return;let t=Vy.instance.get(e.data.identifier);null!==t&&(this.selectedDiceRollTableXml=t.toXml())})}ngAfterViewInit(){this.diceRollTables.length>0&&setTimeout(()=>{this.onChangeDiceRollTable(this.diceRollTables[0].identifier),this.diceRollTableSelecter.nativeElement.selectedIndex=0})}ngOnDestroy(){Uy.unregister(this)}onChangeDiceRollTable(e){this.selectedDiceRollTable=Vy.instance.get(e),this.selectedDiceRollTableXml=""}create(e="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868"){return yv.instance.addDiceRollTable(e)}add(){const e=this.create("\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868");setTimeout(()=>{this.onChangeDiceRollTable(e.identifier),this.diceRollTableSelecter.nativeElement.value=e.identifier})}save(){return xg(this,void 0,void 0,function*(){if(!this.selectedDiceRollTable||this.isSaveing)return;this.isSaveing=!0,this.progresPercent=0;let e="rollTable_"+this.selectedDiceRollTable.name;yield this.saveDataService.saveGameObjectAsync(this.selectedDiceRollTable,e,e=>{this.progresPercent=e}),setTimeout(()=>{this.isSaveing=!1,this.progresPercent=0},500)})}delete(){!this.isEmpty&&this.selectedDiceRollTable&&(this.selectedDiceRollTableXml=this.selectedDiceRollTable.toXml(),this.selectedDiceRollTable.destroy())}restore(){if(this.selectedDiceRollTable&&this.selectedDiceRollTableXml){let e=Xy.instance.parseXml(this.selectedDiceRollTableXml);yv.instance.addDiceRollTable(e),this.selectedDiceRollTableXml=""}}upTabIndex(){if(!this.selectedDiceRollTable)return;let e=this.selectedDiceRollTable.parent,t=e.children.indexOf(this.selectedDiceRollTable);0<t&&e.insertBefore(this.selectedDiceRollTable,e.children[t-1])}downTabIndex(){if(!this.selectedDiceRollTable)return;let e=this.selectedDiceRollTable.parent,t=e.children.indexOf(this.selectedDiceRollTable);t<e.children.length-1&&e.insertBefore(e.children[t+1],this.selectedDiceRollTable)}helpDiceRollTable(){let e=this.pointerDeviceService.pointers[0],t=this.panelService.open(L_,{left:e.x,top:e.y,width:600,height:460});t.title="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u30d8\u30eb\u30d7",t.text="\u3000\u540d\u524d\u3001\u30b3\u30de\u30f3\u30c9\u3001\u632f\u308b\u30c0\u30a4\u30b9\u3092\u8a2d\u5b9a\u3057\u3001\u30c0\u30a4\u30b9\u306e\u6570\u5b57\u3067\u8868\u3092\u53c2\u7167\u3057\u3001\u8868\u793a\u3057\u307e\u3059\u3002\n\u3000\u30c1\u30e3\u30c3\u30c8\u3067\u30b3\u30de\u30f3\u30c9\u3092\u9001\u4fe1\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3068\u540c\u69d8\u306b\u7d50\u679c\u304c\u9001\u4fe1\u3055\u308c\u307e\u3059\u3001\u306a\u304a\u30b3\u30de\u30f3\u30c9\u306b\u306f\u82f1\u6570\u3001\u8a18\u53f7\u306e\u307f\u4f7f\u7528\u53ef\u80fd\u3067\u3059\u3002\n\u3000\u8868\u306f1\u884c\u3054\u3068\u306b\u6570\u5b57\u3068\u7d50\u679c\u3092:\uff08\u30b3\u30ed\u30f3\uff09\u3067\u533a\u5207\u308a\u300c\u6570\u5b57:\u7d50\u679c\u300d\u306e\u5f62\u3067\u8a18\u8ff0\u3057\u307e\u3059\uff08\u3088\u3063\u3066\u3001\u30c0\u30a4\u30b9\u306f\u6700\u5f8c\u306b\u4e00\u3064\u306e\u6570\u5b57\u3092\u8fd4\u3059\u3082\u306e\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3001\u30d0\u30e9\u30d0\u30e9\u30ed\u30fc\u30eb nBm \u306e\u6210\u529f\u6570\u306b\u3082\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\uff09\u3002\n\u3000\n\u3000-\uff08\u30cf\u30a4\u30d5\u30f3\uff09\u307e\u305f\u306f\uff5e\u3067\u533a\u5207\u3063\u3066\u6570\u5b57\u306e\u7bc4\u56f2\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\u3000\u8868\u306b\u300c\\n\u300d\u3068\u66f8\u304f\u3068\u3001\u305d\u3053\u3067\u6539\u884c\u3057\u307e\u3059\uff08\\n\u306f\u8868\u793a\u3055\u308c\u307e\u305b\u3093\uff09\u3002\n\n\u4f8b\uff09\n\u3000name: \u906d\u9047\u8266\u7a2e\u3000\n\u3000command: ShipType\u3000\u3000dice: 1d6\n\n\u3000\u30001:\u6226\u8266\n\u3000\u30002:\u7a7a\u6bcd\n\u3000\u30003:\u91cd\u5de1\u6d0b\u8266\n\u3000\u30004:\u8efd\u5de1\u6d0b\u8266\n\u3000\u30005-6:\u99c6\u9010\u8266\n\n\u3000\u8868\u3092\u53c2\u7167\u3059\u308b\u969b\u306f\u5148\u306b\u3042\u308b\u3082\u306e\u304c\u512a\u5148\u3055\u308c\u307e\u3059\u3001\u4e0a\u8a18\u306e\u4f8b\u3067\u306f\u6700\u5f8c\u306e\u884c\u3092\u300c1-6:\u99c6\u9010\u8266\u300d\u306a\u3069\u3068\u3057\u3066\u3082\u540c\u3058\u7d50\u679c\u306b\u306a\u308a\u307e\u3059\uff08\u304c\u3001\u5206\u304b\u308a\u3084\u3059\u3044\u8a18\u8ff0\u3092\u304a\u52e7\u3081\u3057\u307e\u3059\uff09\u3002\n\u3000\u30c7\u30d5\u30a9\u30eb\u30c8\u306e D66 \u306f\u30bd\u30fc\u30c8\u3055\u308c\u307e\u305b\u3093\u306e\u3067\u3001\u5fc5\u8981\u306a\u5834\u5408\uff08\u30b5\u30a4\u30b3\u30ed\u30fb\u30d5\u30a3\u30af\u30b7\u30e7\u30f3\u306e\u540d\u524d\u8868\u306a\u3069\uff09\u306f\u3001 D66S \u3068\u3057\u3066\u30bd\u30fc\u30c8\u3057\u305f\u6570\u5b57\u3092\u5f97\u3066\u304f\u3060\u3055\u3044\u3002"}}return e.\u0275fac=function(t){return new(t||e)(So(Kw),So(xv),So(wv),So(_C))},e.\u0275cmp=Ze({type:e,selectors:[["dice-roll-table-setting"]],viewQuery:function(e,t){if(1&e&&cc(II,1),2&e){let e;lc(e=hc())&&(t.diceRollTableSelecter=e.first)}},decls:11,vars:3,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[2,"font-size","smaller","margin-bottom","3px",3,"click"],["size","15",2,"width","14em",3,"change"],["diceRollTableSelecter",""],[3,"value",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[3,"value"],[2,"font-size","smaller"],[2,"float","right",3,"click"],[2,"margin-bottom","3px"],["placeholder","Name",2,"width","60%","min-width","5em",3,"ngModel","ngModelChange"],[2,"white-space","nowrap"],["placeholder","Command",2,"width","7em",3,"ngModel","ngModelChange"],[2,"white-space","nowrap","margin-left","1em"],["placeholder","Dice",2,"width","3.3em","text-align","center",3,"ngModel","ngModelChange"],["placeholder","1:\u6570\u5b57\u3092\u7d50\u679c\u3092:\uff08\u30b3\u30ed\u30f3\uff09\u3067\u533a\u5207\u3063\u3066\u8a18\u8ff0\n2:\u7d50\u679c\uff12\n3:\u7d50\u679c\uff13\n4:\u2026",2,"width","100%","height","20em","margin-top","3px","resize","vertical",3,"ngModel","ngModelChange"],[3,"click"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,t){1&e&&(Io(0,"div",0),Io(1,"div",1),Io(2,"div"),Io(3,"button",2),zo("click",function(){return t.add()}),ga(4,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u8ffd\u52a0"),Mo(),Mo(),Io(5,"select",3,4),zo("change",function(e){return t.onChangeDiceRollTable(e.target.value)}),Eo(7,MI,2,2,"option",5),Mo(),Mo(),Io(8,"div",6),Eo(9,FI,23,9,"ng-container",7),Mo(),Mo(),Eo(10,NI,3,0,"ng-container",7)),2&e&&(Zr(7),To("ngForOf",t.diceRollTables),Zr(2),To("ngIf",!t.isEmpty&&t.selectedDiceRollTable),Zr(1),To("ngIf",t.isEmpty))},directives:[Vh,Zh,Bd,Vd,ju,sd,Sd,Uh],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;font-size:.9em}"]}),e})();class LI{constructor(e){this.canvasElement=e}makeBrush(e,t,n){e.strokeStyle=n,e.fillStyle=e.strokeStyle,e.lineWidth=1;let i=Math.floor(t/5);return e.font=`bold ${i}px sans-serif`,e.textBaseline="top",e.textAlign="center",e}render(e,t,n=50,i=pC.SQUARE,r="#000000e6"){this.canvasElement.width=e*n,this.canvasElement.height=t*n;let s=this.canvasElement.getContext("2d");if(i<0)return;let o=this.generateCalcGridPositionFunc(i);this.makeBrush(s,n,r);for(let a=0;a<=t;a++)for(let t=0;t<=e;t++){let{gx:e,gy:i}=o(t,a,n);this.strokeSquare(s,e,i,n),s.fillText((t+1).toString()+"-"+(a+1).toString(),e+n/2,i+n/2)}}generateCalcGridPositionFunc(e){switch(e){case pC.HEX_VERTICAL:return(e,t,n)=>e%2==1?{gx:e*n,gy:t*n}:{gx:e*n,gy:t*n+n/2};case pC.HEX_HORIZONTAL:return(e,t,n)=>t%2==1?{gx:e*n,gy:t*n}:{gx:e*n+n/2,gy:t*n};default:return(e,t,n)=>({gx:e*n,gy:t*n})}}strokeSquare(e,t,n,i){e.beginPath(),e.strokeRect(t,n,i,i)}strokeHex(e,t,n,i,r){let s=r===pC.HEX_HORIZONTAL?-30:0,o=i/Math.sqrt(3),a=t+i/2,l=n+i/2;e.beginPath();for(let c=0;c<6;c++){s+=60;let t=Math.PI/180*s,n=Math.cos(t)*o+a,i=Math.sin(t)*o+l;e.lineTo(n,i)}e.closePath(),e.stroke()}}var BI=function(e){return e.DRAG="drag",e.ZOOM="zoom",e.ROTATE="rotate",e.KEYBOARD="keyboard",e}({}),jI=function(e){return e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e}({});class UI{constructor(e){this.targetElement=e,this.currentPositionX=0,this.currentPositionY=0,this.buttonCode=0,this.input=null,this.callbackOnWheel=e=>this.onWheel(e),this.callbackOnKeydown=e=>this.onKeydown(e),this.onstart=null,this.onend=null,this.ontransform=null,this.initialize()}get isGrabbing(){return this.input.isGrabbing}get isDragging(){return this.input.isDragging}initialize(){this.input=new JO(this.targetElement,{capture:!0}),this.addEventListeners(),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this)}cancel(){this.input.cancel()}destroy(){this.input.destroy(),this.removeEventListeners()}onInputStart(e){this.currentPositionX=this.input.pointer.x,this.currentPositionY=this.input.pointer.y,this.buttonCode=e.button,this.onstart&&this.onstart(e)}onInputEnd(e){this.onend&&this.onend(e)}onInputMove(e){let t=this.input.pointer.x,n=this.input.pointer.y,i=t-this.currentPositionX,r=n-this.currentPositionY,s=0,o=0,a=0,l=0,c=BI.DRAG;2===this.buttonCode?(c=BI.ROTATE,l=-i/5,a=-r/5):(s=i,o=r),this.currentPositionX=t,this.currentPositionY=n,this.ontransform&&this.ontransform(s,o,0,a,0,l,c,e)}onWheel(e){let t=0;switch(e.deltaMode){case WheelEvent.DOM_DELTA_LINE:t=16*e.deltaY;break;case WheelEvent.DOM_DELTA_PAGE:t=e.deltaY*window.innerHeight;break;default:t=e.deltaY}let n=0;n=-1.5*t,Math.pow(300,2)<Math.pow(n,2)&&(n=Math.min(Math.max(n,-300),300)),this.ontransform&&this.ontransform(0,0,n,0,0,0,BI.ZOOM,e)}onKeydown(e){let t=0,n=0,i=0,r=0,s=0,o=this.getKeyName(e);switch(o){case jI.ArrowLeft:e.shiftKey?s=-2:t=10;break;case jI.ArrowUp:e.shiftKey?r=-2:e.ctrlKey?i=150:n=10;break;case jI.ArrowRight:e.shiftKey?s=2:t=-10;break;case jI.ArrowDown:e.shiftKey?r=2:e.ctrlKey?i=-150:n=-10}null!=jI[o]&&this.ontransform&&this.ontransform(t,n,i,r,0,s,BI.KEYBOARD,e)}getKeyName(e){if(e.key)return e.key;switch(e.keyCode){case 37:return jI.ArrowLeft;case 38:return jI.ArrowUp;case 39:return jI.ArrowRight;case 40:return jI.ArrowDown;default:return""}}addEventListeners(){this.targetElement.addEventListener("wheel",this.callbackOnWheel,!1),document.body.addEventListener("keydown",this.callbackOnKeydown,!1)}removeEventListeners(){this.targetElement.removeEventListener("wheel",this.callbackOnWheel,!1),document.body.removeEventListener("keydown",this.callbackOnKeydown,!1)}}var HI=function(e){return e.PAN="pan",e.TAP_PINCH="tappinch",e.PINCH="pinch",e.ROTATE="rotate",e}({});class VI{constructor(e,t){this.targetElement=e,this.ngZone=t,this.hammer=null,this.deltaHammerDeltaX=0,this.deltaHammerDeltaY=1,this.deltaHammerScale=1,this.deltaHammerRotation=0,this.prevHammerDeltaX=0,this.prevHammerDeltaY=0,this.prevHammerScale=0,this.prevHammerRotation=0,this.tappedPanTimer=null,this.tappedPanCenter={x:0,y:0},this.onstart=null,this.onend=null,this.ongesture=null,this.ontransform=null,this.initializeHammer()}destroy(){this.clearTappedPanTimer(),this.hammer.destroy()}initializeHammer(){this.hammer=new Hammer.Manager(this.targetElement,{inputClass:Hammer.TouchInput});let e=new Hammer.Tap,t=new Hammer.Pan({event:"pan1p",pointers:1,threshold:0}),n=new Hammer.Pan({event:"pan2p",pointers:2,threshold:0}),i=new Hammer.Pinch,r=new Hammer.Rotate;t.recognizeWith(n),t.recognizeWith(r),t.recognizeWith(i),n.recognizeWith(i),n.recognizeWith(r),i.recognizeWith(r),this.hammer.add([e,t,n,i,r]),this.hammer.on("hammer.input",this.onHammer.bind(this)),this.hammer.on("tap",this.onTap.bind(this)),this.hammer.on("pan1pstart",this.onTappedPanStart.bind(this)),this.hammer.on("pan1pmove",this.onTappedPanMove.bind(this)),this.hammer.on("pan1pend",this.onTappedPanEnd.bind(this)),this.hammer.on("pan1pcancel",this.onTappedPanEnd.bind(this)),this.hammer.on("pan2pmove",this.onPanMove.bind(this)),this.hammer.on("pinchmove",this.onPinchMove.bind(this)),this.hammer.on("rotatemove",this.onRotateMove.bind(this));let s=window.navigator.userAgent.toLowerCase();(s.indexOf("iphone")>-1||s.indexOf("ipad")>-1||s.indexOf("macintosh")>-1&&"ontouchend"in document)&&(this.hammer.add(new Hammer.Press({time:251})),this.hammer.on("press",e=>{let t=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,clientX:e.center.x,clientY:e.center.y});this.ngZone.run(()=>e.srcEvent.target.dispatchEvent(t))}))}onHammer(e){if(e.isFirst?(this.deltaHammerScale=e.scale,this.deltaHammerRotation=e.rotation,this.deltaHammerDeltaX=e.deltaX,this.deltaHammerDeltaY=e.deltaY,this.onstart&&this.onstart(e.srcEvent)):e.isFinal?this.onend&&this.onend(e.srcEvent):(this.deltaHammerScale=e.scale-this.prevHammerScale,this.deltaHammerRotation=e.rotation-this.prevHammerRotation,this.deltaHammerDeltaX=e.deltaX-this.prevHammerDeltaX,this.deltaHammerDeltaY=e.deltaY-this.prevHammerDeltaY),this.prevHammerScale=e.scale,this.prevHammerRotation=e.rotation,this.prevHammerDeltaX=e.deltaX,this.prevHammerDeltaY=e.deltaY,null==this.tappedPanTimer||e.eventType!=Hammer.INPUT_START)return;let t=Math.pow(this.tappedPanCenter.x-e.center.x,2)+Math.pow(this.tappedPanCenter.y-e.center.y,2);Math.pow(50,2)<t&&this.clearTappedPanTimer()}onTap(e){this.tappedPanCenter=e.center,this.tappedPanTimer=setTimeout(()=>{this.tappedPanTimer=null},400),this.ongesture&&this.ongesture(e.srcEvent)}onTappedPanStart(e){null!=this.tappedPanTimer&&(this.clearTappedPanTimer(!1),this.ongesture&&this.ongesture(e.srcEvent))}onTappedPanEnd(e){this.clearTappedPanTimer()}onTappedPanMove(e){if(null==this.tappedPanTimer){let t=this.deltaHammerDeltaX,n=this.deltaHammerDeltaY,i=0;this.ontransform&&this.ontransform(t,n,i,0,0,0,HI.PAN,e.srcEvent)}else{this.clearTappedPanTimer(!1);let t=7.5*this.deltaHammerDeltaY;this.ongesture&&this.ongesture(e.srcEvent),this.ontransform&&this.ontransform(0,0,t,0,0,0,HI.TAP_PINCH,e.srcEvent)}}onPanMove(e){this.clearTappedPanTimer();let t=-this.deltaHammerDeltaY/window.innerHeight*100;this.ongesture&&this.ongesture(e.srcEvent),this.ontransform&&this.ontransform(0,0,0,t,0,0,HI.ROTATE,e.srcEvent)}onPinchMove(e){this.clearTappedPanTimer();let t=500*this.deltaHammerScale;this.ongesture&&this.ongesture(e.srcEvent),this.ontransform&&this.ontransform(0,0,t,0,0,0,HI.PINCH,e.srcEvent)}onRotateMove(e){this.clearTappedPanTimer();let t=this.deltaHammerRotation;this.ongesture&&this.ongesture(e.srcEvent),this.ontransform&&this.ontransform(0,0,0,0,0,t,HI.ROTATE,e.srcEvent)}clearTappedPanTimer(e=!0){clearTimeout(this.tappedPanTimer),e&&(this.tappedPanTimer=null)}}let GI=(()=>{let e=class extends Ky{constructor(){super(...arguments),this.viewTableIdentifier="",this.gridShow=!1,this.gridSnap=!0}onStoreAdded(){super.onStoreAdded(),Uy.register(this).on("SELECT_GAME_TABLE",e=>{console.log("SELECT_GAME_TABLE "+this.identifier),this.viewTable&&(this.viewTable.selected=!1),this.viewTableIdentifier=e.data.identifier,this.viewTable&&(this.viewTable.selected=!0)})}onStoreRemoved(){super.onStoreRemoved(),Uy.unregister(this)}get viewTable(){let e=Vy.instance.get(this.viewTableIdentifier);return e||(e=Vy.instance.getObjects(gC)[0],e&&(this.viewTableIdentifier.length<1||Vy.instance.isDeleted(this.viewTableIdentifier))&&(this.viewTableIdentifier=e.identifier,Uy.trigger("SELECT_GAME_TABLE",{identifier:e.identifier}))),e}};return Cg([nv()],e.prototype,"viewTableIdentifier",void 0),e=Cg([tv("TableSelecter")],e),e})(),ZI=(()=>{class e{constructor(){}createGameCharacter(e){let t=gv.create("\u65b0\u3057\u3044\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",1,"");return t.location.x=e.x-25,t.location.y=e.y-25,t.posZ=e.z,t}createGameTableMask(e){let t=this.getViewTable();if(!t)return;let n=cC.create("\u30de\u30c3\u30d7\u30de\u30b9\u30af",5,5,100);return n.location.x=e.x-25,n.location.y=e.y-25,n.posZ=e.z,t.appendChild(n),n}createTerrain(e){let t="./assets/images/tex.jpg",n=ov.instance.get(t);n||(n=ov.instance.add(t));let i=this.getViewTable();if(!i)return;let r=dC.create("\u5730\u5f62",2,2,2,n.identifier,n.identifier);return r.location.x=e.x-50,r.location.y=e.y-50,r.posZ=e.z,i.appendChild(r),r}createTextNote(e){let t=bC.create("\u5171\u6709\u30e1\u30e2","\u30c6\u30ad\u30b9\u30c8\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044",5,4,3);return t.location.x=e.x,t.location.y=e.y,t.posZ=e.z,t}createDiceSymbol(e,t,n,i){let r=cw.create(t,n,1),s=null;return r.nothingFaces.forEach(e=>{let t=`./assets/images/dice/${i}/${i}[0].png`;s=ov.instance.get(t),s||(s=ov.instance.add(t)),r.imageDataElement.getFirstElementByName(e).value=s.identifier}),r.faces.forEach(e=>{let t=`./assets/images/dice/${i}/${i}[${e}].png`;s=ov.instance.get(t),s||(s=ov.instance.add(t)),r.imageDataElement.getFirstElementByName(e).value=s.identifier}),r.location.x=e.x-25,r.location.y=e.y-25,r.posZ=e.z,r}createTrump(e){let t=ow.create("\u30c8\u30e9\u30f3\u30d7\u5c71\u672d");t.location.x=e.x-25,t.location.y=e.y-25,t.posZ=e.z;let n="./assets/images/trump/z02.gif";ov.instance.get(n)||ov.instance.add(n);let i=["c","d","h","s"],r=[];for(let s of i)for(let e=1;e<=13;e++)r.push(s+("00"+e).slice(-2));r.push("x01"),r.push("x02");for(let s of r){let e="./assets/images/trump/"+s+".gif";ov.instance.get(e)||ov.instance.add(e);let i=rw.create("\u30ab\u30fc\u30c9",e,n);t.putOnBottom(i)}return t}makeDefaultTable(){let e=new GI("tableSelecter");e.initialize();let t=new gC("gameTable"),n=null,i=Ig.createEmpty("testTableBackgroundImage_image").toContext();i.url="./assets/images/BG10a_80.jpg",n=ov.instance.add(i),t.name="\u6700\u521d\u306e\u30c6\u30fc\u30d6\u30eb",t.imageIdentifier=n.identifier,t.width=20,t.height=15,t.initialize(),e.viewTableIdentifier=t.identifier}makeDefaultTabletopObjects(){let e=null,t=null,n=null;e=new gv("testCharacter_1"),n=Ig.createEmpty("testCharacter_1_image").toContext(),n.url="./assets/images/mon_052.gif",t=ov.instance.add(n),e.location.x=250,e.location.y=450,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcA",1,t.identifier),e=new gv("testCharacter_2"),e.location.x=400,e.location.y=400,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcB",1,t.identifier),e=new gv("testCharacter_3"),n=Ig.createEmpty("testCharacter_3_image").toContext(),n.url="./assets/images/mon_128.gif",t=ov.instance.add(n),e.location.x=200,e.location.y=100,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcC",3,t.identifier),e=new gv("testCharacter_4"),n=Ig.createEmpty("testCharacter_4_image").toContext(),n.url="./assets/images/mon_150.gif",t=ov.instance.add(n),e.location.x=300,e.location.y=550,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcA",1,t.identifier),e=new gv("testCharacter_5"),n=Ig.createEmpty("testCharacter_5_image").toContext(),n.url="./assets/images/mon_211.gif",t=ov.instance.add(n),e.location.x=600,e.location.y=600,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcB",1,t.identifier),e=new gv("testCharacter_6"),n=Ig.createEmpty("testCharacter_6_image").toContext(),n.url="./assets/images/mon_135.gif",t=ov.instance.add(n),e.initialize(),e.location.x=250,e.location.y=650,e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcC",1,t.identifier)}makeDefaultContextMenuActions(e){return[this.getCreateCharacterMenu(e),this.getCreateTableMaskMenu(e),this.getCreateTerrainMenu(e),this.getCreateTextNoteMenu(e),this.getCreateTrumpMenu(e),this.getCreateDiceSymbolMenu(e)]}getCreateCharacterMenu(e){return{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u4f5c\u6210",action:()=>{let t=this.createGameCharacter(e);Uy.trigger("SELECT_TABLETOP_OBJECT",{identifier:t.identifier,className:t.aliasName}),q_.play(Y_.piecePut)}}}getCreateTableMaskMenu(e){return{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u4f5c\u6210",action:()=>{this.createGameTableMask(e),q_.play(Y_.cardPut)}}}getCreateTerrainMenu(e){return{name:"\u5730\u5f62\u3092\u4f5c\u6210",action:()=>{this.createTerrain(e),q_.play(Y_.blockPut)}}}getCreateTextNoteMenu(e){return{name:"\u5171\u6709\u30e1\u30e2\u3092\u4f5c\u6210",action:()=>{this.createTextNote(e),q_.play(Y_.cardPut)}}}getCreateTrumpMenu(e){return{name:"\u30c8\u30e9\u30f3\u30d7\u306e\u5c71\u672d\u3092\u4f5c\u6210",action:()=>{this.createTrump(e),q_.play(Y_.cardPut)}}}getCreateDiceSymbolMenu(e){let t=[];return[{menuName:"D4",diceName:"D4",type:lw.D4,imagePathPrefix:"4_dice"},{menuName:"D6",diceName:"D6",type:lw.D6,imagePathPrefix:"6_dice"},{menuName:"D6 (Black)",diceName:"D6",type:lw.D6,imagePathPrefix:"6_dice_black"},{menuName:"D8",diceName:"D8",type:lw.D8,imagePathPrefix:"8_dice"},{menuName:"D10",diceName:"D10",type:lw.D10,imagePathPrefix:"10_dice"},{menuName:"D10 (00-90)",diceName:"D10",type:lw.D10_10TIMES,imagePathPrefix:"100_dice"},{menuName:"D12",diceName:"D12",type:lw.D12,imagePathPrefix:"12_dice"},{menuName:"D20",diceName:"D20",type:lw.D20,imagePathPrefix:"20_dice"}].forEach(n=>{t.push({name:n.menuName,action:()=>{this.createDiceSymbol(e,n.diceName,n.type,n.imagePathPrefix),q_.play(Y_.dicePut)}})}),{name:"\u30c0\u30a4\u30b9\u3092\u4f5c\u6210",action:null,subActions:t}}getViewTable(){let e=Vy.instance.get("tableSelecter");return e?e.viewTable:null}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=pe({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),WI=(()=>{class e{constructor(e,t,n,i,r,s){this.ngZone=e,this.elementRef=t,this.batchService=n,this.pointerDeviceService=i,this.coordinateService=r,this.tabletopService=s,this.layerName="",this.colideLayers=[],this.transformCssOffset="",this.isDisable=!1,this.isInteract=!0,this.onstart=new Xl,this.ondragstart=new Xl,this.ondrag=new Xl,this.ondragend=new Xl,this.onend=new Xl,this._posX=0,this._posY=0,this._posZ=0,this.pointer3d={x:0,y:0,z:0},this.pointerOffset3d={x:0,y:0,z:0},this.pointerStart3d={x:0,y:0,z:0},this.pointerPrev3d={x:0,y:0,z:0},this.height=0,this.width=0,this.ratio=1,this.updateTimer=null,this.collidableElements=[],this.input=null}set option(e){this.tabletopObject=null!=e.tabletopObject?e.tabletopObject:this.tabletopObject,this.layerName=null!=e.layerName?e.layerName:this.layerName,this.colideLayers=null!=e.colideLayers?e.colideLayers:this.colideLayers,this.transformCssOffset=null!=e.transformCssOffset?e.transformCssOffset:this.transformCssOffset}get posX(){return this._posX}set posX(e){this._posX=e,this.setUpdateTimer()}get posY(){return this._posY}set posY(e){this._posY=e,this.setUpdateTimer()}get posZ(){return this._posZ}set posZ(e){this._posZ=e,this.setUpdateTimer()}get isGridSnap(){let e=Vy.instance.get("tableSelecter");return!!e&&e.gridSnap}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new JO(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),Uy.register(this).on("UPDATE_GAME_OBJECT",-1e3,e=>{e.isSendFromSelf&&this.input.isGrabbing||e.data.identifier!==this.tabletopObject.identifier||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.stopTransition(),this.setPosition(this.tabletopObject)},this)}),this.layerName.length<1&&this.tabletopObject&&(this.layerName=this.tabletopObject.aliasName),this.register(),this.findCollidableElements(),this.setPosition(this.tabletopObject)}ngOnDestroy(){this.cancel(),this.input.destroy(),this.unregister(),Uy.unregister(this),this.batchService.remove(this)}cancel(){this.input.cancel(),this.setPointerEvents(!0),this.setAnimatedTransition(!0),this.setCollidableLayer(!1),this.tabletopService.tableSelecter.viewTable.gridHeight=0}onInputStart(e){if(this.callSelectedEvent(),this.collidableElements.length<1&&this.findCollidableElements(),this.isDisable||1===e.button||2===e.button)return this.cancel();this.onstart.emit(e),this.setPointerEvents(!1),this.setAnimatedTransition(!1),this.setCollidableLayer(this.isInteract);let t=document.elementFromPoint(this.input.pointer.x,this.input.pointer.y);this.pointer3d=this.coordinateService.calcTabletopLocalCoordinate(this.input.pointer,t),this.setPointerEvents(!0),this.pointerOffset3d.x=this.posX-this.pointer3d.x,this.pointerOffset3d.y=this.posY-this.pointer3d.y,this.pointerOffset3d.z=this.posZ-this.pointer3d.z,this.pointerStart3d.x=this.pointerPrev3d.x=this.pointer3d.x,this.pointerStart3d.y=this.pointerPrev3d.y=this.pointer3d.y,this.pointerStart3d.z=this.pointerPrev3d.z=this.pointer3d.z,this.ratio=1,this.pointer3d.z!==this.posZ&&(this.ratio/=Math.abs(this.pointer3d.z-this.posZ)/2),this.width=this.input.target.clientWidth,this.height=this.input.target.clientHeight,this.tabletopService.tableSelecter.viewTable.gridHeight=this.posZ+.5,this.setUpdateTimer()}onInputMove(e){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();e.cancelable&&e.preventDefault(),this.input.isDragging||this.setPointerEvents(!1);let t=document.elementFromPoint(this.input.pointer.x,this.input.pointer.y);if(null==t)return;if(this.pointer3d=this.coordinateService.calcTabletopLocalCoordinate(this.input.pointer,t),this.pointerPrev3d.x===this.pointer3d.x&&this.pointerPrev3d.y===this.pointer3d.y&&this.pointerPrev3d.z===this.pointer3d.z)return;this.input.isDragging||this.ondragstart.emit(e),this.ondrag.emit(e);let n=this.calcDistanceRatio(this.pointerStart3d,this.pointer3d);n<this.ratio&&(this.ratio=n),this.pointerPrev3d.x=this.pointer3d.x,this.pointerPrev3d.y=this.pointer3d.y,this.pointerPrev3d.z=this.pointer3d.z,this.posX=this.pointer3d.x+this.pointerOffset3d.x*this.ratio+-this.width/2*(1-this.ratio),this.posY=this.pointer3d.y+this.pointerOffset3d.y*this.ratio+-this.height/2*(1-this.ratio),this.posZ=this.pointer3d.z,Vy.instance.get("tableSelecter").viewTable.gridHeight=this.posZ+.5}onInputEnd(e){if(this.isDisable)return this.cancel();this.input.isDragging&&this.ondragend.emit(e),this.isGridSnap&&this.input.isDragging&&this.snapToGrid(),this.cancel(),this.onend.emit(e)}onContextMenu(e){if(this.isDisable)return this.cancel();e.cancelable&&e.preventDefault(),this.isGridSnap&&this.input.isDragging&&this.snapToGrid();let t=this.input.isGrabbing&&e.isTrusted;if(this.cancel(),t){e.stopPropagation();let t=new MouseEvent(e.type,e);this.ngZone.run(()=>this.input.target.dispatchEvent(t))}}callSelectedEvent(){this.tabletopObject&&Uy.trigger("SELECT_TABLETOP_OBJECT",{identifier:this.tabletopObject.identifier,className:this.tabletopObject.aliasName})}calcDistanceRatio(e,t){let n=this.collidableElements[0].clientWidth,i=this.collidableElements[0].clientHeight,r=Math.sqrt(n*n+i*i);r=r<1?1:3*r;let s=e.x-t.x,o=100*(e.z-t.z);return r/(Math.sqrt(Math.pow(e.y-t.y,2)+Math.pow(s,2)+Math.pow(o,2))+r)}snapToGrid(e=25){this.posX=this.calcSnapNum(this.posX,e),this.posY=this.calcSnapNum(this.posY,e)}calcSnapNum(e,t){return t<=0?e:(e=e<0?e-t/2:e+t/2)-e%t}setPosition(e){this._posX=e.location.x,this._posY=e.location.y,this._posZ=e.posZ,this.updateTransformCss()}setUpdateTimer(){null===this.updateTimer&&this.tabletopObject&&(this.updateTimer=setTimeout(()=>{this.tabletopObject.location.x=this.posX,this.tabletopObject.location.y=this.posY,this.tabletopObject.posZ=this.posZ,this.updateTimer=null},66)),this.updateTransformCss()}findCollidableElements(){this.collidableElements=[],"none"===getComputedStyle(this.input.target).pointerEvents?this.findNestedCollidableElements(this.input.target):this.collidableElements=[this.input.target]}findNestedCollidableElements(e){let t=e.children;for(let n=0;n<t.length;n++){let e=t[n];e instanceof HTMLElement&&"none"!==getComputedStyle(e).pointerEvents&&this.collidableElements.push(e)}if(this.collidableElements.length<1)for(let n=0;n<t.length;n++){let e=t[n];e instanceof HTMLElement&&this.findNestedCollidableElements(e)}}setPointerEvents(e){let t=e?"auto":"none";this.collidableElements.forEach(e=>e.style.pointerEvents=t)}setAnimatedTransition(e){this.input&&(this.input.target.style.transition=e?"transform 132ms linear":"")}shouldTransition(e){return e.location.x!==this.posX||e.location.y!==this.posY||e.posZ!==this.posZ}stopTransition(){this.input.target.style.transform=window.getComputedStyle(this.input.target).transform}updateTransformCss(){this.input&&(this.input.target.style.transform=this.transformCssOffset+" translateX("+this.posX+"px) translateY("+this.posY+"px) translateZ("+this.posZ+"px)")}setCollidableLayer(t){let n=t;for(let i in e.layerHash)n=-1<this.colideLayers.indexOf(i)?"character"==i?!this.input.isGrabbing||t&&!this.tabletopObject.isNotRide:!this.input.isGrabbing||t:!t,e.layerHash[i].forEach(e=>{e===this||e.input.isGrabbing||e.setPointerEvents(n)})}register(){this.layerName in e.layerHash||(e.layerHash[this.layerName]=[]),e.layerHash[this.layerName].indexOf(this)<0&&e.layerHash[this.layerName].push(this)}unregister(){if(!(this.layerName in e.layerHash))return;let t=e.layerHash[this.layerName].indexOf(this);-1<t&&e.layerHash[this.layerName].splice(t,1)}}return e.layerHash={},e.\u0275fac=function(t){return new(t||e)(So(Rc),So(Ha),So(Sk),So(Kw),So(cS),So(hS))},e.\u0275dir=Qe({type:e,selectors:[["","appMovable",""]],inputs:{option:["movable.option","option"],isDisable:["movable.disable","isDisable"],isInteract:["movable.interact","isInteract"]},outputs:{onstart:"movable.onstart",ondragstart:"movable.ondragstart",ondrag:"movable.ondrag",ondragend:"movable.ondragend",onend:"movable.onend"}}),e})(),YI=(()=>{class e{constructor(e,t,n,i,r,s){this.ngZone=e,this.elementRef=t,this.batchService=n,this.pointerDeviceService=i,this.coordinateService=r,this.tabletopService=s,this.transformCssOffset="",this.grabbingSelecter=".rotate-grab",this.isDisable=!1,this.onstart=new Xl,this.ondragstart=new Xl,this.ondrag=new Xl,this.ondragend=new Xl,this.onend=new Xl,this._rotate=0,this.valueChange=new Xl,this.rotateOffset=0,this.updateTimer=null,this.grabbingElement=null,this.input=null}set option(e){this.tabletopObject=null!=e.tabletopObject?e.tabletopObject:this.tabletopObject,this.grabbingSelecter=null!=e.grabbingSelecter?e.grabbingSelecter:this.grabbingSelecter,this.transformCssOffset=null!=e.transformCssOffset?e.transformCssOffset:this.transformCssOffset}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.setUpdateTimer()}set value(e){this._rotate=e,this.updateTransformCss()}get isAllowedToRotate(){if(!this.grabbingElement||!this.input.target)return!1;if(this.grabbingSelecter.length<1)return!0;let e=this.input.target.querySelectorAll(this.grabbingSelecter),t=!1;for(let n=0;n<e.length;n++)if(t=e[n].contains(this.grabbingElement),t)return!0;return!1}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new JO(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),this.tabletopObject?(Uy.register(this).on("UPDATE_GAME_OBJECT",-1e3,e=>{e.isSendFromSelf&&this.input.isGrabbing||e.data.identifier!==this.tabletopObject.identifier||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.stopTransition(),this.setRotate(this.tabletopObject)},this)}),this.setRotate(this.tabletopObject)):this.updateTransformCss()}ngOnDestroy(){this.cancel(),this.input.destroy(),Uy.unregister(this),this.batchService.remove(this)}cancel(){this.input.cancel(),this.grabbingElement=null,this.setAnimatedTransition(!0),this.tabletopService.tableSelecter.viewTable.gridHeight=0}onInputStart(e){if(this.grabbingElement=e.target,this.isDisable||!this.isAllowedToRotate||1===e.button||2===e.button)return this.cancel();e.stopPropagation(),this.onstart.emit(e);let t=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.input.target.parentElement);this.rotateOffset=this.calcRotate(t,this.rotate),this.setAnimatedTransition(!1),this.tabletopObject&&(this.tabletopService.tableSelecter.viewTable.gridHeight=this.tabletopObject.posZ+.5,this.setUpdateTimer())}onInputMove(e){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();e.cancelable&&e.preventDefault(),e.stopPropagation();let t=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.input.target.parentElement),n=this.calcRotate(t,this.rotateOffset);this.input.isDragging||this.ondragstart.emit(e),this.ondrag.emit(e),this.rotate=n}onInputEnd(e){if(this.isDisable)return this.cancel();e.stopPropagation(),this.input.isDragging&&this.ondragend.emit(e),this.cancel(),this.snapToPolygonal(),this.onend.emit(e)}onContextMenu(e){if(this.isDisable)return this.cancel();e.cancelable&&e.preventDefault(),this.cancel(),this.snapToPolygonal()}calcRotate(e,t){return(180*Math.atan2(e.y-this.input.target.clientHeight/2,e.x-this.input.target.clientWidth/2)/Math.PI-t)%360}snapToPolygonal(e=24){e<=1||(this.rotate=this.rotate<0?this.rotate-180/e:this.rotate+180/e,this.rotate-=this.rotate%(360/e))}setUpdateTimer(){null===this.updateTimer&&(this.updateTimer=setTimeout(()=>{this.valueChange.emit(this.rotate),this.tabletopObject&&(this.tabletopObject.rotate=this.rotate),this.updateTimer=null},66)),this.updateTransformCss()}setRotate(e){e&&(this._rotate=e.rotate),this.updateTransformCss()}setAnimatedTransition(e){this.input&&(this.input.target.style.transition=e?"transform 132ms linear":"")}shouldTransition(e){return e.rotate!==this.rotate}stopTransition(){this.input.target.style.transform=window.getComputedStyle(this.input.target).transform}updateTransformCss(){this.input&&(this.input.target.style.transform=this.transformCssOffset+" rotateZ("+this.rotate+"deg)")}}return e.\u0275fac=function(t){return new(t||e)(So(Rc),So(Ha),So(Sk),So(Kw),So(cS),So(hS))},e.\u0275dir=Qe({type:e,selectors:[["","appRotable",""]],inputs:{option:["rotable.option","option"],isDisable:["rotable.disable","isDisable"],value:["rotable.value","value"]},outputs:{onstart:"rotable.onstart",ondragstart:"rotable.ondragstart",ondrag:"rotable.ondrag",ondragend:"rotable.ondragend",onend:"rotable.onend",valueChange:"rotable.valueChange"}}),e})();const qI=function(e){return{"blinking-animation":e}};function $I(e,t){if(1&e&&(Io(0,"div",6),ql(1,"safe"),Mo()),2&e){const e=jo(2);ta("background-image",$l(1,3,"url("+e.floorImage.url+")","style")),To("ngClass",Ul(6,qI,!e.isLocked))}}const XI=function(e,t){return{"backface-visibility":e,transform:t}};function KI(e,t){if(1&e&&(Po(0),Eo(1,$I,2,8,"div",4),Io(2,"div",5),ql(3,"safe"),Mo(),Do()),2&e){const e=jo();Zr(1),To("ngIf",e.isDropShadow&&(0!=e.terreinAltitude||e.isSlope&&!e.hasWall)),Zr(1),ta("background-image",$l(3,5,"url("+e.floorImage.url+")","style")),To("ngClass",Ul(8,qI,!e.isLocked))("ngStyle",Hl(10,XI,e.isSlope?"visible":"hidden","translateZ("+(e.height/(e.isSlope?2:1)+e.altitude)*e.gridSize+"px)"+(e.isSlope?" rotateX("+-e.math.atan(e.height/e.depth)+"rad) scaleY("+1/e.math.cos(e.math.atan(e.height/e.depth))+")":"")))}}const QI=function(e,t){return{"blinking-animation":e,"no-shadow":t}},JI=function(e){return{transform:e}};function eM(e,t){if(1&e&&(Io(0,"div",10),ql(1,"safe"),Mo()),2&e){const e=jo(2);ta("background-image",$l(1,8,"url("+e.wallImage.url+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),To("ngClass",Hl(11,QI,!e.isLocked,!e.isSurfaceShading))("ngStyle",Ul(14,JI,"translateZ("+e.altitude*e.gridSize+"px) translateY(-100%) rotateX(90deg) rotateZ(180deg) scaleX(-1.0)"))}}function tM(e,t){if(1&e&&(Io(0,"div",12),ql(1,"safe"),Mo()),2&e){const e=jo(3);ta("background-image",$l(1,8,"url("+e.wallImage.url+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),To("ngClass",Hl(11,QI,!e.isLocked,!e.isSurfaceShading))("ngStyle",Ul(14,JI,"translateZ("+e.altitude*e.gridSize+"px) rotateX(-90deg)"))}}function nM(e,t){if(1&e&&(Po(0),Eo(1,tM,2,16,"div",11),Do()),2&e){const e=jo(2);Zr(1),To("ngIf",e.isVisibleWallTopBottom)}}const iM=function(e,t,n){return{"blinking-animation":e,"no-shadow":t,"is-slope":n}};function rM(e,t){if(1&e&&(Io(0,"div",13),ql(1,"safe"),Mo()),2&e){const e=jo(2);ta("background-image",$l(1,8,"url("+e.wallImage.url+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),To("ngClass",Vl(11,iM,!e.isLocked,!e.isSurfaceShading,e.isSlope))("ngStyle",Ul(15,JI,"translateZ("+e.altitude*e.gridSize+"px) rotateZ(90deg) rotateX(-90deg) scaleX(-1.0) translateX(-100%) translateY(-100%)"))}}function sM(e,t){if(1&e&&(Io(0,"div",14),ql(1,"safe"),Mo()),2&e){const e=jo(2);ta("background-image",$l(1,8,"url("+e.wallImage.url+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),To("ngClass",Vl(11,iM,!e.isLocked,!e.isSurfaceShading,e.isSlope))("ngStyle",Ul(15,JI,"translateZ("+e.altitude*e.gridSize+"px) rotateZ(-90deg) rotateX(-90deg) translateY(-100%)"))}}function oM(e,t){if(1&e&&(Po(0),Eo(1,eM,2,16,"div",7),Eo(2,nM,2,1,"ng-container",2),Eo(3,rM,2,17,"div",8),Eo(4,sM,2,17,"div",9),Do()),2&e){const e=jo();Zr(1),To("ngIf",e.isVisibleWallTopBottom),Zr(1),To("ngIf",!e.isSlope),Zr(1),To("ngIf",e.isVisibleWallLeftRight),Zr(1),To("ngIf",e.isVisibleWallLeftRight)}}function aM(e,t){if(1&e&&(Po(0),Io(1,"div"),Ao(2,"div",15),Io(3,"div",16),Io(4,"i",17),ga(5,"autorenew"),Mo(),Mo(),Io(6,"div",18),Io(7,"i",17),ga(8,"autorenew"),Mo(),Mo(),Io(9,"div",19),Io(10,"i",17),ga(11,"autorenew"),Mo(),Mo(),Io(12,"div",20),Io(13,"i",17),ga(14,"autorenew"),Mo(),Mo(),Mo(),Do()),2&e){const e=jo();Zr(1),ta("opacity",e.isInteract?"1.0":"0.5")}}const lM=function(e){return{transform:e}};function cM(e,t){if(1&e&&(Io(0,"div",21),Io(1,"div",22),ga(2),Mo(),Io(3,"div",23),ga(4),Mo(),Mo()),2&e){const e=jo();ta("height",e.math.abs(e.terreinAltitude*e.gridSize),"px"),To("ngStyle",Ul(5,lM,"translateX("+e.width*e.gridSize/2+"px) translateY("+-e.depth*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.terreinAltitude>0?-(e.altitude+(e.isSlope||e.isWallExist?0:e.height))*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),Zr(2),ma(e.math.abs(e.terreinAltitude)),Zr(2),ma(e.math.abs(e.terreinAltitude))}}const hM=function(e){return{"is-grab":e}};let uM=(()=>{class e{constructor(e,t,n,i,r,s,o,a,l,c){this.ngZone=e,this.imageService=t,this.tabletopActionService=n,this.contextMenuService=i,this.elementRef=r,this.panelService=s,this.changeDetector=o,this.pointerDeviceService=a,this.modalService=l,this.coordinateService=c,this.terrain=null,this.is3D=!1,this.gridSize=50,this.movableOption={},this.rotableOption={},this.math=Math,this.input=null,this.viewRotateZ=10}get name(){return this.terrain.name}get mode(){return this.terrain.mode}set mode(e){this.terrain.mode=e}get isLocked(){return this.terrain.isLocked}set isLocked(e){this.terrain.isLocked=e}get hasWall(){return this.terrain.hasWall}get hasFloor(){return this.terrain.hasFloor}get wallImage(){return this.imageService.getSkeletonOr(this.terrain.wallImage)}get floorImage(){return this.imageService.getSkeletonOr(this.terrain.floorImage)}get height(){return this.adjustMinBounds(this.terrain.height)}get width(){return this.adjustMinBounds(this.terrain.width)}get depth(){return this.adjustMinBounds(this.terrain.depth)}get altitude(){return this.terrain.altitude}set altitude(e){this.terrain.altitude=e}get isDropShadow(){return this.terrain.isDropShadow}set isDropShadow(e){this.terrain.isDropShadow=e}get isSurfaceShading(){return this.terrain.isSurfaceShading}set isSurfaceShading(e){this.terrain.isSurfaceShading=e}get isInteract(){return this.terrain.isInteract}set isInteract(e){this.terrain.isInteract=e}get isSlope(){return this.terrain.isSlope}set isSlope(e){this.terrain.isSlope=e}get isAltitudeIndicate(){return this.terrain.isAltitudeIndicate}set isAltitudeIndicate(e){this.terrain.isAltitudeIndicate=e}get isVisibleFloor(){return 0<this.width*this.depth}get isVisibleWallTopBottom(){return 0<this.width*this.height}get isVisibleWallLeftRight(){return 0<this.depth*this.height}get isWallExist(){return this.hasWall&&this.wallImage&&this.wallImage.url&&this.wallImage.url.length>0}get terreinAltitude(){let e=this.altitude;return(this.altitude<0||!this.isSlope&&!this.isWallExist)&&(e+=this.height),e}ngOnInit(){Uy.register(this).on("UPDATE_GAME_OBJECT",-1e3,e=>{let t=Vy.instance.get(e.data.identifier);this.terrain&&t&&(this.terrain===t||t instanceof ev&&this.terrain.contains(t))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",-1e3,e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.terrain,colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.terrain}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new JO(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this.input.destroy(),Uy.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLocked&&Uy.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let t=this.pointerDeviceService.pointers[0],n=this.coordinateService.calcTabletopLocalCoordinate();this.contextMenuService.open(t,[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,q_.play(Y_.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,q_.play(Y_.lock)}},B_,this.isSlope?{name:"\u2611 \u50be\u659c",action:()=>{this.isSlope=!1}}:{name:"\u2610 \u50be\u659c",action:()=>{this.isSlope=!0}},{name:"\u58c1\u306e\u8868\u793a",action:null,subActions:[{name:(this.hasWall&&this.isSurfaceShading?"\u25c9":"\u25cb")+" \u901a\u5e38",action:()=>{this.mode=uC.ALL,this.isSurfaceShading=!0}},{name:(this.hasWall&&!this.isSurfaceShading?"\u25c9":"\u25cb")+" \u9670\u5f71\u306a\u3057",action:()=>{this.mode=uC.ALL,this.isSurfaceShading=!1}},{name:(this.hasWall?"\u25cb":"\u25c9")+" \u975e\u8868\u793a",action:()=>{this.mode=uC.FLOOR,this.depth*this.width==0&&(this.terrain.width=this.width<=0?1:this.width,this.terrain.depth=this.depth<=0?1:this.depth)}}]},B_,this.isDropShadow?{name:"\u2611 \u5f71\u3092\u843d\u3068\u3059",action:()=>{this.isDropShadow=!1}}:{name:"\u2610 \u5f71\u3092\u843d\u3068\u3059",action:()=>{this.isDropShadow=!0}},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0}},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,q_.play(Y_.sweep))},altitudeHande:this.terrain},B_,{name:"\u5730\u5f62\u8a2d\u5b9a\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.terrain)}},this.terrain.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.terrain.getUrls().map(e=>{const t=e.value.toString();return{name:e.name?e.name:t,action:()=>{this.modalService.open(Iv,{url:t,title:this.terrain.name,subTitle:e.name})},disabled:!rv.validUrl(t),error:rv.validUrl(t)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",materialIcon:"open_in_new"}})},this.terrain.getUrls().length<=0?null:B_,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let e=this.terrain.clone();e.location.x+=this.gridSize,e.location.y+=this.gridSize,e.isLocked=!1,this.terrain.parent&&this.terrain.parent.appendChild(e),q_.play(Y_.blockPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.terrain.destroy(),q_.play(Y_.sweep)}},B_,{name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(n)}],this.name)}onMove(){q_.play(Y_.blockPick)}onMoved(){q_.play(Y_.blockPut)}adjustMinBounds(e,t=0){return e<t?t:e}showDetail(e){Uy.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let t=this.pointerDeviceService.pointers[0],n="\u5730\u5f62\u8a2d\u5b9a";e.name.length&&(n+=" - "+e.name),this.panelService.open(wx,{title:n,left:t.x-250,top:t.y-150,width:550,height:340}).tabletopObject=e}}return e.\u0275fac=function(t){return new(t||e)(So(Rc),So(MO),So(ZI),So(j_),So(Ha),So(wv),So(fl),So(Kw),So(xv),So(cS))},e.\u0275cmp=Ze({type:e,selectors:[["terrain"]],hostBindings:function(e,t){1&e&&zo("dragstart",function(e){return t.onDragstart(e)})("contextmenu",function(e){return t.onContextMenu(e)})},inputs:{terrain:"terrain",is3D:"is3D"},decls:6,vars:16,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.option","movable.disable","movable.interact","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"ngClass","rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],[4,"ngIf"],["class","is-3d","style","display:flex; align-items: center; border-left: 2px dashed blanchedalmond; position: absolute; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],["style","opacity: 0.7; filter: brightness(0) blur(1px); transform: translateZ(0.3px) scale(0.98); backface-visibility: visible","class","texture",3,"ngClass","background-image",4,"ngIf"],[1,"texture",3,"ngClass","ngStyle"],[1,"texture",2,"opacity","0.7","filter","brightness(0) blur(1px)","transform","translateZ(0.3px) scale(0.98)","backface-visibility","visible",3,"ngClass"],["class","texture of-wall-top",3,"ngClass","background-image","width","height","ngStyle",4,"ngIf"],["class","texture of-wall-left",3,"ngClass","background-image","width","height","ngStyle",4,"ngIf"],["class","texture of-wall-right",3,"ngClass","background-image","width","height","ngStyle",4,"ngIf"],[1,"texture","of-wall-top",3,"ngClass","ngStyle"],["class","texture of-wall-bottom",3,"ngClass","background-image","width","height","ngStyle",4,"ngIf"],[1,"texture","of-wall-bottom",3,"ngClass","ngStyle"],[1,"texture","of-wall-left",3,"ngClass","ngStyle"],[1,"texture","of-wall-right",3,"ngClass","ngStyle"],[1,"pedestal-grab","rotate-grab"],[1,"rotate-grab","of-left-top","rotate-grab-icon"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","rotate-grab-icon"],[1,"rotate-grab","of-right-bottom","rotate-grab-icon"],[1,"rotate-grab","of-right-top","rotate-grab-icon"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","position","absolute","transform-origin","top left",3,"ngStyle"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"]],template:function(e,t){1&e&&(Io(0,"div",0),zo("movable.ondragstart",function(){return t.onMove()})("movable.ondragend",function(){return t.onMoved()}),Io(1,"div",1),zo("rotable.ondragstart",function(){return t.onMove()})("rotable.ondragend",function(){return t.onMoved()}),Eo(2,KI,4,13,"ng-container",2),Eo(3,oM,5,4,"ng-container",2),Eo(4,aM,15,2,"ng-container",2),Mo(),Eo(5,cM,5,7,"div",3),Mo()),2&e&&(ta("width",t.width*t.gridSize,"px")("height",t.depth*t.gridSize,"px"),To("movable.option",t.movableOption)("movable.disable",t.isLocked)("movable.interact",t.isInteract),Zr(1),To("ngClass",Ul(14,hM,!t.isLocked))("rotable.option",t.rotableOption)("rotable.disable",t.isLocked),Zr(1),To("ngIf",t.hasFloor&&t.isVisibleFloor&&0<(null==t.floorImage?null:t.floorImage.url.length)),Zr(1),To("ngIf",t.isWallExist),Zr(1),To("ngIf",!t.isLocked),Zr(1),To("ngIf",t.isAltitudeIndicate&&!((t.isSlope||t.isWallExist)&&-t.height<t.altitude&&t.altitude<0)&&(t.terreinAltitude<=-.5||.5<=t.terreinAltitude)))},directives:[WI,YI,Uh,Zh,Qh],pipes:[$_],styles:[".is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%], .texture[_ngcontent-%COMP%]{height:100%;width:100%}.texture[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;background-repeat:no-repeat;background-size:100% 100%}.of-wall-top[_ngcontent-%COMP%]{top:0;left:0;transform-origin:50% 100%;transform:translateY(-100%) rotateX(90deg) rotate(180deg) scaleX(-1);filter:brightness(.3)}.of-wall-bottom[_ngcontent-%COMP%]{bottom:0;left:0;transform-origin:50% 100%;transform:rotateX(-90deg)}.of-wall-left[_ngcontent-%COMP%]{top:0;left:0;transform-origin:0 0;transform:rotate(90deg) rotateX(-90deg) scaleX(-1) translateX(-100%) translateY(-100%);filter:brightness(.5)}.of-wall-right[_ngcontent-%COMP%]{top:0;right:0;transform-origin:100% 0;transform:rotate(-90deg) rotateX(-90deg) translateY(-100%);filter:brightness(.8)}.of-wall-left.is-slope[_ngcontent-%COMP%], .of-wall-right.is-slope[_ngcontent-%COMP%]{-webkit-clip-path:polygon(100% 0,0 100%,100% 100%);clip-path:polygon(100% 0,0 100%,100% 100%)}.of-wall-left.no-shadow[_ngcontent-%COMP%], .of-wall-right.no-shadow[_ngcontent-%COMP%], .of-wall-top.no-shadow[_ngcontent-%COMP%]{filter:brightness(1)}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;position:absolute;top:-14px;left:-14px;right:-14px;bottom:-14px;cursor:default;box-sizing:border-box;border:7px solid #ccc;border-radius:14px}.rotate-grab[_ngcontent-%COMP%]{opacity:0;z-index:-1}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;border:2px solid #ccc;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:0;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;transform-style:preserve-3d;transform:translateZ(.1px)}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px;border-radius:14px 7px 14px 7px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px;border-radius:7px 14px 7px 14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px;border-radius:14px 7px 14px 7px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px;border-radius:7px 14px 7px 14px}.blinking-animation[_ngcontent-%COMP%]{-webkit-animation:blink 1s linear infinite alternate;animation:blink 1s linear infinite alternate}@-webkit-keyframes blink{0%{opacity:.9}to{opacity:.5}}@keyframes blink{0%{opacity:.9}to{opacity:.5}}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0 0 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}"],changeDetection:0}),e})();function dM(e,t){1&e&&Ao(0,"div")}function pM(e,t){1&e&&Ao(0,"div",5),2&e&&ta("background-color","rgba(10, 10, 10,"+jo().opacity+")")}function fM(e,t){if(1&e&&(Io(0,"div",6),Ao(1,"img",7),ql(2,"safe"),Mo()),2&e){const e=jo();Zr(1),ta("opacity",e.opacity),To("src",$l(2,3,e.imageFile.url,"resourceUrl"),Xi)}}function gM(e,t){1&e&&(Io(0,"div",8),Io(1,"i",9),ga(2,"lock"),Mo(),Mo())}const mM=function(e){return{"is-grab":e}};let bM=(()=>{class e{constructor(e,t,n,i,r,s,o,a,l){this.ngZone=e,this.tabletopActionService=t,this.contextMenuService=n,this.elementRef=i,this.panelService=r,this.changeDetector=s,this.pointerDeviceService=o,this.modalService=a,this.coordinateService=l,this.gameTableMask=null,this.is3D=!1,this.gridSize=50,this.movableOption={},this.input=null}get name(){return this.gameTableMask.name}get width(){return this.adjustMinBounds(this.gameTableMask.width)}get height(){return this.adjustMinBounds(this.gameTableMask.height)}get opacity(){return this.gameTableMask.opacity}get imageFile(){return this.gameTableMask.imageFile}get isLock(){return this.gameTableMask.isLock}set isLock(e){this.gameTableMask.isLock=e}ngOnInit(){Uy.register(this).on("UPDATE_GAME_OBJECT",-1e3,e=>{let t=Vy.instance.get(e.data.identifier);this.gameTableMask&&t&&(this.gameTableMask===t||t instanceof ev&&this.gameTableMask.contains(t))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",-1e3,e=>{this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.gameTableMask,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain","text-note"]}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new JO(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this.input.destroy(),Uy.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLock&&Uy.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let t=this.pointerDeviceService.pointers[0],n=this.coordinateService.calcTabletopLocalCoordinate();this.contextMenuService.open(t,[this.isLock?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLock=!1,q_.play(Y_.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLock=!0,q_.play(Y_.lock)}},B_,{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.gameTableMask)}},this.gameTableMask.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.gameTableMask.getUrls().map(e=>{const t=e.value.toString();return{name:e.name?e.name:t,action:()=>{this.modalService.open(Iv,{url:t,title:this.gameTableMask.name,subTitle:e.name})},disabled:!rv.validUrl(t),error:rv.validUrl(t)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",materialIcon:"open_in_new"}})},this.gameTableMask.getUrls().length<=0?null:B_,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let e=this.gameTableMask.clone();console.log("\u30b3\u30d4\u30fc",e),e.location.x+=this.gridSize,e.location.y+=this.gridSize,e.isLock=!1,this.gameTableMask.parent&&this.gameTableMask.parent.appendChild(e),q_.play(Y_.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.gameTableMask.destroy(),q_.play(Y_.sweep)}},B_,{name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(n)}],this.name)}onMove(){q_.play(Y_.cardPick)}onMoved(){q_.play(Y_.cardPut)}adjustMinBounds(e,t=0){return e<t?t:e}showDetail(e){let t=this.pointerDeviceService.pointers[0],n="\u30de\u30c3\u30d7\u30de\u30b9\u30af\u8a2d\u5b9a";e.name.length&&(n+=" - "+e.name),this.panelService.open(wx,{title:n,left:t.x-200,top:t.y-150,width:400,height:300}).tabletopObject=e}}return e.\u0275fac=function(t){return new(t||e)(So(Rc),So(ZI),So(j_),So(Ha),So(wv),So(fl),So(Kw),So(xv),So(cS))},e.\u0275cmp=Ze({type:e,selectors:[["game-table-mask"]],hostBindings:function(e,t){1&e&&zo("dragstart",function(e){return t.onDragstart(e)})("contextmenu",function(e){return t.onContextMenu(e)})},inputs:{gameTableMask:"gameTableMask",is3D:"is3D"},decls:7,vars:13,consts:[["appMovable","",1,"component",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],[4,"ngIf","ngIfThen","ngIfElse"],["blackMask",""],["imageMask",""],["class","lock-icon is-center",4,"ngIf"],[1,"border","is-fit-full"],[1,"border","image","is-fit-full"],[1,"is-fit-full",2,"display","block",3,"src"],[1,"lock-icon","is-center"],[1,"material-icons"]],template:function(e,t){if(1&e&&(Io(0,"div",0),zo("movable.ondragstart",function(){return t.onMove()})("movable.ondragend",function(){return t.onMoved()}),Eo(1,dM,1,0,"div",1),Eo(2,pM,1,2,"ng-template",null,2,dc),Eo(4,fM,3,6,"ng-template",null,3,dc),Eo(6,gM,3,0,"div",4),Mo()),2&e){const e=ko(3),n=ko(5);ta("width",t.width*t.gridSize,"px")("height",t.height*t.gridSize,"px"),To("ngClass",Ul(11,mM,!t.isLock))("movable.option",t.movableOption)("movable.disable",t.isLock),Zr(1),To("ngIf",t.imageFile.url.length<1)("ngIfThen",e)("ngIfElse",n),Zr(5),To("ngIf",t.isLock)}},directives:[WI,Uh,Zh],pipes:[$_],styles:[".is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.image[_ngcontent-%COMP%]{display:block}.lock-icon[_ngcontent-%COMP%]{background-color:#ccc;border-radius:100%;color:#444;width:25px;height:25px;visibility:hidden}.component[_ngcontent-%COMP%]:active   .lock-icon[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:hover   .lock-icon[_ngcontent-%COMP%]{visibility:visible}.is-center[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0;margin:auto}.border[_ngcontent-%COMP%]{box-sizing:border-box;border:2px solid transparent}.image.border[_ngcontent-%COMP%]{border-width:0}.component[_ngcontent-%COMP%]:active   .border[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:hover   .border[_ngcontent-%COMP%], .is-grab[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{border:2px solid #ccc}.is-fit-full[_ngcontent-%COMP%]{height:100%;width:100%}"],changeDetection:0}),e})();const yM=["textArea"];function vM(e,t){if(1&e&&(Io(0,"div",14),ga(1),Mo()),2&e){const e=jo();Zr(1),ma(e.title)}}const _M=function(e){return{"is-grab":e}},wM=function(e){return{transform:e}};function CM(e,t){if(1&e&&Ao(0,"div",15),2&e){const e=jo();ta("width",(e.width-1)*e.gridSize,"px")("min-height",e.gridSize/2,"px"),To("ngClass",Ul(6,_M,!e.isLocked))("ngStyle",Ul(8,wM,"translateX("+e.gridSize/2+"px) translateY("+-e.gridSize/4+"px)"))}}function xM(e,t){1&e&&(Io(0,"div"),Io(1,"div",9),Io(2,"i",10),ga(3,"autorenew"),Mo(),Mo(),Io(4,"div",11),Io(5,"i",10),ga(6,"autorenew"),Mo(),Mo(),Mo())}const EM=function(e){return{transform:e}};function kM(e,t){if(1&e&&(Io(0,"div",16),Io(1,"div",17),Io(2,"span",18),ga(3),Mo(),Io(4,"span",19),ga(5),Mo(),Mo(),Mo()),2&e){const e=jo();ta("height",e.math.abs(e.textNoteAltitude*e.gridSize),"px"),To("ngStyle",Ul(5,EM,"rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),Zr(3),ma(e.math.abs(e.textNoteAltitude)),Zr(2),ma(e.textNoteAltitude)}}const SM=function(e,t,n){return{"is-pointer-events-none":e,"is-pointer-events-auto":t,"is-outline-text":n}};let TM=(()=>{class e{constructor(e,t,n,i,r,s){this.ngZone=e,this.contextMenuService=t,this.panelService=n,this.changeDetector=i,this.pointerDeviceService=r,this.modalService=s,this.textNote=null,this.is3D=!1,this.callbackOnMouseUp=e=>this.onMouseUp(e),this.gridSize=50,this.math=Math,this.calcFitHeightTimer=null,this.movableOption={},this.rotableOption={},this.viewRotateZ=10}get title(){return this.textNote.title}get text(){return this.calcFitHeightIfNeeded(),this.textNote.text}set text(e){this.calcFitHeightIfNeeded(),this.textNote.text=e}get fontSize(){return this.calcFitHeightIfNeeded(),this.textNote.fontSize}get imageFile(){return this.textNote.imageFile}get rotate(){return this.textNote.rotate}set rotate(e){this.textNote.rotate=e}get height(){return this.adjustMinBounds(this.textNote.height)}get width(){return this.adjustMinBounds(this.textNote.width)}get altitude(){return this.textNote.altitude}set altitude(e){this.textNote.altitude=e}get textNoteAltitude(){let e=this.altitude;if(this.isUpright&&this.altitude<0){if(-this.height<=this.altitude)return 0;e+=this.height}return+e.toFixed(1)}get isUpright(){return this.textNote.isUpright}set isUpright(e){this.textNote.isUpright=e}get isAltitudeIndicate(){return this.textNote.isAltitudeIndicate}set isAltitudeIndicate(e){this.textNote.isAltitudeIndicate=e}get isLocked(){return this.textNote.isLocked}set isLocked(e){this.textNote.isLocked=e}get isSelected(){return document.activeElement===this.textAreaElementRef.nativeElement}ngOnInit(){Uy.register(this).on("UPDATE_GAME_OBJECT",-1e3,e=>{let t=Vy.instance.get(e.data.identifier);this.textNote&&t&&(this.textNote===t||t instanceof ev&&this.textNote.contains(t))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",-1e3,e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.textNote,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.textNote}}ngAfterViewInit(){}ngOnDestroy(){Uy.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onMouseDown(e){this.isSelected||(e.preventDefault(),this.textNote.toTopmost(),2!==e.button?this.addMouseEventListeners():Uy.trigger("DRAG_LOCKED_OBJECT",{}))}onMouseUp(e){if(this.pointerDeviceService.isAllowedToOpenContextMenu){let e=window.getSelection();e.isCollapsed||e.removeAllRanges(),this.textAreaElementRef.nativeElement.focus()}this.removeMouseEventListeners(),e.preventDefault()}onRotateMouseDown(e){e.stopPropagation(),e.preventDefault()}onContextMenu(e){this.removeMouseEventListeners(),this.isSelected||(e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,q_.play(Y_.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,q_.play(Y_.lock)}},B_,this.isUpright?{name:"\u2611 \u76f4\u7acb",action:()=>{this.isUpright=!1}}:{name:"\u2610 \u76f4\u7acb",action:()=>{this.isUpright=!0}},B_,this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0}},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,q_.play(Y_.sweep))},altitudeHande:this.textNote},B_,{name:"\u30e1\u30e2\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.textNote)}},this.textNote.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.textNote.getUrls().map(e=>{const t=e.value.toString();return{name:e.name?e.name:t,action:()=>{this.modalService.open(Iv,{url:t,title:this.textNote.title,subTitle:e.name})},disabled:!rv.validUrl(t),error:rv.validUrl(t)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",materialIcon:"open_in_new"}})},this.textNote.getUrls().length<=0?null:B_,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let e=this.textNote.clone();e.isLocked=!1,console.log("\u30b3\u30d4\u30fc",e),e.location.x+=this.gridSize,e.location.y+=this.gridSize,e.toTopmost(),q_.play(Y_.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.textNote.destroy(),q_.play(Y_.sweep)}}],this.title))}onMove(){q_.play(Y_.cardPick)}onMoved(){q_.play(Y_.cardPut)}calcFitHeightIfNeeded(){this.calcFitHeightTimer||this.ngZone.runOutsideAngular(()=>{this.calcFitHeightTimer=setTimeout(()=>{this.calcFitHeight(),this.calcFitHeightTimer=null},0)})}calcFitHeight(){let e=this.textAreaElementRef.nativeElement;e.style.height="0",e.scrollHeight>e.offsetHeight&&(e.style.height=e.scrollHeight+"px")}adjustMinBounds(e,t=0){return e<t?t:e}addMouseEventListeners(){document.body.addEventListener("mouseup",this.callbackOnMouseUp,!1)}removeMouseEventListeners(){document.body.removeEventListener("mouseup",this.callbackOnMouseUp,!1)}showDetail(e){Uy.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let t=this.pointerDeviceService.pointers[0],n="\u5171\u6709\u30e1\u30e2\u8a2d\u5b9a";e.title.length&&(n+=" - "+e.title),this.panelService.open(wx,{title:n,left:t.x-350,top:t.y-200,width:700,height:400}).tabletopObject=e}}return e.\u0275fac=function(t){return new(t||e)(So(Rc),So(j_),So(wv),So(fl),So(Kw),So(xv))},e.\u0275cmp=Ze({type:e,selectors:[["text-note"]],viewQuery:function(e,t){if(1&e&&cc(yM,3),2&e){let e;lc(e=hc())&&(t.textAreaElementRef=e.first)}},hostBindings:function(e,t){1&e&&zo("dragstart",function(e){return t.onDragstart(e)})("mousedown",function(e){return t.onMouseDown(e)})("contextmenu",function(e){return t.onContextMenu(e)})},inputs:{textNote:"textNote",is3D:"is3D"},decls:18,vars:35,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.option","movable.disable","movable.ondragstart","movable.ondragend"],["appRotable","",1,"is-3d",3,"rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],[1,"component-content","is-3d","is-pointer-events-auto"],[1,"upright-transform","is-3d","is-bg-color","is-bg-texture",3,"ngStyle"],["class","title is-black-background is-pointer-events-none",4,"ngIf"],["spellcheck","false",1,"textarea",3,"ngClass","ngModel","input","ngModelChange"],["textArea",""],["class","grand-grabing-area","style","position: absolute",3,"ngClass","ngStyle","width","min-height",4,"ngIf"],[3,"ngStyle"],[1,"rotate-grab","of-left-top"],[1,"material-icons"],[1,"rotate-grab","of-right-top"],[4,"ngIf"],["class","is-3d","style","display: flex; align-items: center; border-left: 2px dashed blanchedalmond; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],[1,"title","is-black-background","is-pointer-events-none"],[1,"grand-grabing-area",2,"position","absolute",3,"ngClass","ngStyle"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","transform-origin","top left",3,"ngStyle"],[1,"is-3d"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"]],template:function(e,t){1&e&&(Io(0,"div",0),zo("movable.ondragstart",function(){return t.onMove()})("movable.ondragend",function(){return t.onMoved()}),Io(1,"div",1),zo("rotable.ondragstart",function(){return t.onMove()})("rotable.ondragend",function(){return t.onMoved()}),Io(2,"div",2),Io(3,"div",3),ql(4,"safe"),Eo(5,vM,2,1,"div",4),Io(6,"textarea",5,6),zo("input",function(){return t.calcFitHeight()})("ngModelChange",function(e){return t.text=e}),Mo(),Mo(),Eo(8,CM,1,10,"div",7),Io(9,"div",8),Io(10,"div",9),Io(11,"i",10),ga(12),Mo(),Mo(),Io(13,"div",11),Io(14,"i",10),ga(15),Mo(),Mo(),Mo(),Eo(16,xM,7,0,"div",12),Mo(),Mo(),Eo(17,kM,6,7,"div",13),Mo()),2&e&&(To("movable.option",t.movableOption)("movable.disable",t.isSelected||t.isLocked),Zr(1),To("rotable.option",t.rotableOption)("rotable.disable",t.isLocked),Zr(1),ta("width",t.width*t.gridSize,"px"),Zr(1),ta("background-image",$l(4,24,"url("+(null==t.imageFile?null:t.imageFile.url)+")","style"))("width",t.width*t.gridSize,"px")("min-height",t.height*t.gridSize,"px"),To("ngStyle",Ul(27,wM,"translateZ("+t.altitude*t.gridSize+"px) rotateY(90deg) rotateZ("+(t.isUpright?-90:0)+"deg) rotateY(-90deg)")),Zr(2),To("ngIf",t.title.length),Zr(1),ta("font-size",t.fontSize+9,"px"),To("ngClass",Vl(29,SM,!t.isSelected,t.isSelected,!t.isSelected))("ngModel",t.text),Zr(2),To("ngIf",!t.isLocked),Zr(1),To("ngStyle",Ul(33,wM,"translateZ("+t.altitude*t.gridSize+"px)")),Zr(3),ma(t.isLocked?"lock":"autorenew"),Zr(3),ma(t.isLocked?"lock":"autorenew"),Zr(1),To("ngIf",!t.isLocked),Zr(1),To("ngIf",t.isAltitudeIndicate&&t.math.abs(t.textNoteAltitude)>=.5))},directives:[WI,YI,Qh,Zh,ju,Uh,sd,Sd],pipes:[$_],styles:[".is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.upright-transform[_ngcontent-%COMP%]{transition:transform 132ms ease}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;width:0;height:0}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;transform:translateX(-50%)}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform-origin:50% 100%;transform:rotateX(-90deg)}.is-bg-texture[_ngcontent-%COMP%]{background-repeat:no-repeat;background-size:100% 100%}.is-bg-color[_ngcontent-%COMP%]{box-sizing:border-box;color:#444;background-color:rgba(240,218,189,.9);border:1px solid #999}.title[_ngcontent-%COMP%]{font-size:15px;padding:3px 9px;white-space:nowrap;text-overflow:ellipsis}.textarea[_ngcontent-%COMP%], .title[_ngcontent-%COMP%]{box-sizing:border-box;overflow:hidden;-webkit-backface-visibility:hidden;backface-visibility:hidden}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;resize:none;background:none;border:none;border-radius:0;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1rem;padding:2px;margin:0;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.textarea[_ngcontent-%COMP%]:focus{background:hsla(0,0%,100%,.75)}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:rgba(30,30,30,.8)}.is-outline-text[_ngcontent-%COMP%]{font-size:24px;color:#444;text-shadow:#f2f2f2 0 0 .5px,#f2f2f2 0 0 .5px,#f2f2f2 0 0 .5px,#f2f2f2 0 0 .5px,#f2f2f2 0 0 .5px,#f2f2f2 0 0 .5px,#f2f2f2 0 0 .5px,#f2f2f2 0 0 .5px}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:42px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;text-align:center;padding:2px;background-color:#ccc;border-radius:28px;color:#444;font-size:8px}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-21px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-21px}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%]{display:inline}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0 0 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}"],changeDetection:0}),e})();const OM=["draggablePanel"];function IM(e,t){1&e&&Ro(0)}function MM(e,t){1&e&&Ro(0)}const AM=function(e){return{card:e}};function PM(e,t){if(1&e&&(Po(0),Eo(1,MM,1,0,"ng-container",12),Do()),2&e){const e=jo(),t=ko(12);Zr(1),To("ngTemplateOutlet",t)("ngTemplateOutletContext",Ul(2,AM,e.tabletopObject))}}function DM(e,t){1&e&&Ro(0)}function RM(e,t){if(1&e&&(Po(0),Eo(1,DM,1,0,"ng-container",12),Do()),2&e){const e=jo(),t=ko(12);Zr(1),To("ngTemplateOutlet",t)("ngTemplateOutletContext",Ul(2,AM,e.tabletopObject))}}function FM(e,t){1&e&&Ro(0)}const NM=function(e){return{note:e}};function zM(e,t){if(1&e&&(Po(0),Eo(1,FM,1,0,"ng-container",12),Do()),2&e){const e=jo(),t=ko(14);Zr(1),To("ngTemplateOutlet",t)("ngTemplateOutletContext",Ul(2,NM,e.tabletopObject))}}function LM(e,t){1&e&&Ro(0)}const BM=function(e){return{character:e}};function jM(e,t){if(1&e&&(Po(0),Eo(1,LM,1,0,"ng-container",12),Do()),2&e){const e=jo(),t=ko(16);Zr(1),To("ngTemplateOutlet",t)("ngTemplateOutletContext",Ul(2,BM,e.tabletopObject))}}function UM(e,t){1&e&&Ro(0)}const HM=function(e){return{dice:e}};function VM(e,t){if(1&e&&(Po(0),Eo(1,UM,1,0,"ng-container",12),Do()),2&e){const e=jo(),t=ko(18);Zr(1),To("ngTemplateOutlet",t)("ngTemplateOutletContext",Ul(2,HM,e.tabletopObject))}}function GM(e,t){1&e&&Ro(0)}function ZM(e,t){if(1&e&&(Po(0),Eo(1,GM,1,0,"ng-container",12),Do()),2&e){const e=jo(),t=ko(16);Zr(1),To("ngTemplateOutlet",t)("ngTemplateOutletContext",Ul(2,BM,e.tabletopObject))}}function WM(e,t){1&e&&Ro(0)}function YM(e,t){if(1&e&&(Po(0),Eo(1,WM,1,0,"ng-container",13),Do()),2&e){jo();const e=ko(22);Zr(1),To("ngTemplateOutlet",e)}}const qM=function(e){return{"with-button-marign":e}};function $M(e,t){if(1&e&&(Io(0,"div",24),Io(1,"div",25),ga(2),Mo(),Mo()),2&e){const e=jo(2).card,t=jo();To("ngClass",Ul(4,qM,t.hasImage)),Zr(1),ta("background-color",e.ownerColor),Zr(1),ma(e.ownerName)}}function XM(e,t){if(1&e){const e=Fo();Io(0,"div",19),Ao(1,"img",20),ql(2,"safe"),Io(3,"button",21),zo("click",function(){return Ft(e),jo(2).chanageImageView(!0)}),Io(4,"i",22),ga(5,"zoom_in"),Mo(),Mo(),Eo(6,$M,3,6,"div",23),Mo()}if(2&e){const e=jo().card,t=jo();Zr(1),To("src",$l(2,2,t.imageUrl,"resourceUrl"),Xi),Zr(5),To("ngIf",e.hasOwner&&0<e.ownerName.length)}}function KM(e,t){if(1&e&&(Po(0),ga(1),Do()),2&e){const e=jo(2).card;Zr(1),ma(e.name)}}function QM(e,t){1&e&&(Po(0),ga(1,"\u30ab\u30fc\u30c9"),Do())}function JM(e,t){if(1&e&&(Io(0,"div",26),Eo(1,KM,2,1,"ng-container",5),Eo(2,QM,2,0,"ng-container",5),Mo()),2&e){const e=jo().card,t=jo();To("ngClass",Ul(3,qM,t.hasImage)),Zr(1),To("ngIf",null==e.isVisible||e.isVisible),Zr(1),To("ngIf",null!=e.isVisible&&!e.isVisible)}}function eA(e,t){1&e&&Ro(0)}const tA=function(e){return{dataElm:e}};function nA(e,t){if(1&e&&(Po(0),Eo(1,eA,1,0,"ng-container",12),Do()),2&e){const e=t.$implicit;jo(3);const n=ko(20);Zr(1),To("ngTemplateOutlet",n)("ngTemplateOutletContext",Ul(2,tA,e))}}function iA(e,t){if(1&e&&(Io(0,"div",27),Io(1,"div",28),Eo(2,nA,2,4,"ng-container",29),Mo(),Mo()),2&e){const e=jo(2);Zr(2),To("ngForOf",e.dataElms)}}const rA=function(e,t){return{"is-pointer-events-auto":e,"pointer-events-none":t}};function sA(e,t){if(1&e&&(Io(0,"div",14),Eo(1,XM,7,5,"div",15),Eo(2,JM,3,5,"div",16),Io(3,"div",17),Eo(4,iA,3,1,"div",18),Mo(),Mo()),2&e){const e=t.card,n=jo();To("ngClass",Hl(4,rA,!n.isPointerDragging,n.isPointerDragging)),Zr(1),To("ngIf",n.hasImage),Zr(1),To("ngIf",0<(null==e||null==e.name?null:e.name.length)),Zr(2),To("ngIf",n.hasDataElms&&e.isVisible)}}function oA(e,t){if(1&e&&(Io(0,"div",30),Io(1,"div",31),ga(2),Mo(),Io(3,"div",32),Io(4,"div",19),Io(5,"div",33),Io(6,"textarea",34),zo("ngModelChange",function(e){return t.note.text=e}),Mo(),Mo(),Io(7,"div",35),ga(8),Mo(),Mo(),Mo(),Mo()),2&e){const e=t.note,n=jo();To("ngClass",Hl(4,rA,!n.isPointerDragging,n.isPointerDragging)),Zr(2),ma(e.title),Zr(4),To("ngModel",e.text),Zr(2),ma(e.text)}}const aA=function(e){return{transform:e}},lA=function(e,t){return{inverse:e,hollow:t}},cA=function(e,t,n,i,r,s,o,a){return{black:e,blue:t,green:n,cyan:i,red:r,magenta:s,yellow:o,white:a}},hA=function(e){return{"black-paint":e}};function uA(e,t){if(1&e&&(Po(0),Io(1,"div",43),Io(2,"div",44),Io(3,"span",45),Ao(4,"img",46),ql(5,"safe"),Mo(),Mo(),Mo(),Do()),2&e){const e=jo(3);Zr(1),To("ngStyle",Ul(8,aA,"rotate("+e.roll+"deg)")),Zr(1),To("ngClass",Hl(10,lA,e.isInverse,e.isHollow)),Zr(1),To("ngClass",Zl(13,cA,0==e.aura,1==e.aura,2==e.aura,3==e.aura,4==e.aura,5==e.aura,6==e.aura,7==e.aura)),Zr(1),To("ngClass",Ul(22,hA,e.isBlackPaint))("src",$l(5,5,e.imageUrl,"resourceUrl"),Xi)}}function dA(e,t){if(1&e&&(Po(0),Ao(1,"img",47),ql(2,"safe"),Do()),2&e){const e=jo(3);Zr(1),To("src",$l(2,1,e.imageUrl,"resourceUrl"),Xi)}}const pA=function(e,t,n){return{"has-icon":e,"is-pointer-events-auto":t,"pointer-events-none":n}};function fA(e,t){if(1&e&&(Io(0,"div",42),Eo(1,uA,6,24,"ng-container",5),Eo(2,dA,3,4,"ng-container",5),Mo()),2&e){const e=jo(2);To("ngClass",Vl(3,pA,e.isUseIcon,!e.isPointerDragging,e.isPointerDragging)),Zr(1),To("ngIf",!e.isUseIcon),Zr(1),To("ngIf",e.isUseIcon)}}function gA(e,t){1&e&&Ro(0)}function mA(e,t){if(1&e&&(Po(0),Io(1,"div",28),Eo(2,gA,1,0,"ng-container",12),Mo(),Do()),2&e){const e=jo().$implicit;jo(3);const t=ko(20);Zr(2),To("ngTemplateOutlet",t)("ngTemplateOutletContext",Ul(2,tA,e))}}function bA(e,t){if(1&e&&(Po(0),Eo(1,mA,3,4,"ng-container",5),Do()),2&e){const e=t.$implicit,n=jo(3);Zr(1),To("ngIf",e&&e.name!==n.newLineString)}}function yA(e,t){if(1&e&&(Io(0,"div",27),Eo(1,bA,2,1,"ng-container",29),Mo()),2&e){const e=jo(2);Zr(1),To("ngForOf",e.inventoryDataElms)}}function vA(e,t){if(1&e&&(Io(0,"div",36),Ao(1,"div",37),Eo(2,fA,3,7,"div",38),Io(3,"div",39),ga(4),Mo(),Ao(5,"div",40),Io(6,"div",41),Eo(7,yA,2,1,"div",18),Mo(),Mo()),2&e){const e=t.character,n=jo();Zr(1),To("ngClass",Hl(6,rA,!n.isPointerDragging,n.isPointerDragging)),Zr(1),To("ngIf",n.hasImage),Zr(1),To("ngClass",Hl(9,rA,!n.isPointerDragging,n.isPointerDragging)),Zr(1),ma(e.name),Zr(2),To("ngClass",Hl(12,rA,!n.isPointerDragging,n.isPointerDragging)),Zr(1),To("ngIf",n.hasDataElms)}}function _A(e,t){if(1&e&&(Po(0),ga(1),Do()),2&e){const e=jo().dice;Zr(1),ma(e.face)}}function wA(e,t){1&e&&(Po(0),ga(1,"???"),Do())}function CA(e,t){if(1&e&&(Io(0,"div",49),Io(1,"div",25),ga(2),Mo(),Mo()),2&e){const e=jo().dice,t=jo();To("ngClass",Hl(4,rA,!t.isPointerDragging,t.isPointerDragging)),Zr(1),ta("background-color",e.ownerColor),Zr(1),ba("",e.ownerName," ")}}const xA=function(e,t){return{"is-black-mask":e,"is-harf-black-mask":t}};function EA(e,t){if(1&e&&(Io(0,"div",42),Ao(1,"img",46),ql(2,"safe"),Mo()),2&e){const e=jo().dice,t=jo();To("ngClass",Hl(6,rA,!t.isPointerDragging,t.isPointerDragging)),Zr(1),To("ngClass",Hl(9,xA,!e.isVisible,e.isMine))("src",$l(2,3,t.imageUrl,"resourceUrl"),Xi)}}function kA(e,t){1&e&&Ro(0)}function SA(e,t){if(1&e&&(Po(0),Eo(1,kA,1,0,"ng-container",12),Do()),2&e){const e=jo().$implicit;jo(3);const t=ko(20);Zr(1),To("ngTemplateOutlet",t)("ngTemplateOutletContext",Ul(2,tA,e))}}function TA(e,t){if(1&e&&(Po(0),Eo(1,SA,2,4,"ng-container",5),Do()),2&e){const e=t.$implicit,n=jo(3);Zr(1),To("ngIf",e&&e.name!==n.newLineString)}}function OA(e,t){if(1&e&&(Io(0,"div",27),Io(1,"div",28),Eo(2,TA,2,1,"ng-container",29),Mo(),Mo()),2&e){const e=jo(2);Zr(2),To("ngForOf",e.dataElms)}}function IA(e,t){if(1&e&&(Io(0,"div",36),Ao(1,"div",37),Io(2,"div",39),ga(3),Eo(4,_A,2,1,"ng-container",5),Eo(5,wA,2,0,"ng-container",5),Mo(),Eo(6,CA,3,7,"div",48),Eo(7,EA,3,12,"div",38),Ao(8,"div",40),Io(9,"div",41),Eo(10,OA,3,1,"div",18),Mo(),Mo()),2&e){const e=t.dice,n=jo();Zr(1),To("ngClass",Hl(9,rA,!n.isPointerDragging,n.isPointerDragging)),Zr(1),To("ngClass",Hl(12,rA,!n.isPointerDragging,n.isPointerDragging)),Zr(1),ba(" ",e.name,": "),Zr(1),To("ngIf",e.isVisible),Zr(1),To("ngIf",!e.isVisible),Zr(1),To("ngIf",e.hasOwner&&0<e.ownerName.length),Zr(1),To("ngIf",n.hasImage),Zr(2),To("ngClass",Hl(15,rA,!n.isPointerDragging,n.isPointerDragging)),Zr(1),To("ngIf",n.hasDataElms&&e.isVisible)}}function MA(e,t){1&e&&Ro(0)}function AA(e,t){if(1&e&&(Io(0,"div",56),ga(1),Mo()),2&e){const e=jo(2).dataElm;Co("title",e.name),Zr(1),ma(e.name)}}function PA(e,t){1&e&&Ro(0)}function DA(e,t){if(1&e&&(Po(0),Eo(1,PA,1,0,"ng-container",12),Do()),2&e){const e=t.$implicit;jo(3);const n=ko(20);Zr(1),To("ngTemplateOutlet",n)("ngTemplateOutletContext",Ul(2,tA,e))}}function RA(e,t){if(1&e&&(Io(0,"div",53),Eo(1,AA,2,2,"div",54),Io(2,"div",55),Eo(3,DA,2,4,"ng-container",29),Mo(),Mo()),2&e){const e=jo().dataElm;Zr(1),To("ngIf",0<e.name.trim().length),Zr(2),To("ngForOf",e.children)}}function FA(e,t){if(1&e){const e=Fo();Po(0),Io(1,"div",58),Io(2,"div"),ga(3),Mo(),Io(4,"div",59),Io(5,"div",33),Io(6,"textarea",34),zo("ngModelChange",function(t){return Ft(e),jo(2).dataElm.value=t}),Mo(),Mo(),Io(7,"div",35),ga(8),Mo(),Mo(),Mo(),Do()}if(2&e){const e=jo(2).dataElm;Zr(2),Co("title",e.name),Zr(1),ma(e.name),Zr(3),To("ngModel",e.value),Zr(2),ma(e.value)}}function NA(e,t){if(1&e){const e=Fo();Po(0),Io(1,"div",60),ga(2),Mo(),Io(3,"div",61),Io(4,"div",62),ga(5),Mo(),Io(6,"input",63),zo("ngModelChange",function(t){return Ft(e),jo(2).dataElm.value=t}),Mo(),Mo(),Do()}if(2&e){const e=jo(2).dataElm;Zr(1),Co("title",e.name),Zr(1),ma(e.name),Zr(3),ma(e.value),Zr(1),Go("type",e.value&&e.value==+e.value?"number":"text"),To("ngModel",e.value)}}function zA(e,t){if(1&e){const e=Fo();Po(0),Io(1,"div",64),ga(2),Mo(),Io(3,"div",61),Io(4,"div",65),Io(5,"div",66),ga(6),Mo(),Io(7,"input",67),zo("ngModelChange",function(t){return Ft(e),jo(2).dataElm.currentValue=t}),Mo(),Mo(),Io(8,"div",68),ga(9),Mo(),Mo(),Io(10,"div",69),Io(11,"input",70),zo("ngModelChange",function(t){return Ft(e),jo(2).dataElm.currentValue=t}),ql(12,"safe"),Mo(),Mo(),Do()}if(2&e){const e=jo(2).dataElm;Zr(1),Co("title",e.name),Zr(1),ma(e.name),Zr(4),ma(e.currentValue),Zr(1),To("ngModel",e.currentValue),Zr(2),ba(" / ",+e.value?e.value:"???",""),Zr(2),ia($l(12,10,"font-size: 0.8em; width: 100%; --min: 0; --max:"+e.value+"; --val:"+e.currentValue+";","style")),Go("title",e.currentValue),Go("max",+e.value?e.value:1e3),To("ngModel",e.currentValue)}}function LA(e,t){if(1&e){const e=Fo();Po(0),Io(1,"div",60),Io(2,"span"),ga(3),Mo(),ga(4),Mo(),Io(5,"div",61),Io(6,"input",71),zo("ngModelChange",function(t){return Ft(e),jo(2).dataElm.value=t})("change",function(){Ft(e);const t=jo(2).dataElm;return t.value=t.value?t.name:""}),Mo(),Mo(),Do()}if(2&e){const e=jo(2).dataElm,t=jo();Zr(1),Co("title",e.name),Zr(1),ta("text-decoration",e.value?"none":"line-through"),Zr(1),ma(e.name),Zr(1),ba(" ",e.currentValue.split(t.checkRegExp)[e.value?0:1],""),Zr(2),Go("checked",e.value?"checked":""),To("ngModel",e.value)}}function BA(e,t){if(1&e){const e=Fo();Po(0),Io(1,"div",60),ga(2),Mo(),Io(3,"div",61),Io(4,"div",62),ga(5),Mo(),Io(6,"input",63),zo("ngModelChange",function(t){return Ft(e),jo(2).dataElm.value=t}),Mo(),Io(7,"span",72),ga(8),Mo(),Mo(),Do()}if(2&e){const e=jo(2).dataElm;Zr(1),Co("title",e.name),Zr(1),ma(e.name),Zr(3),ma(e.value),Zr(1),Go("type",e.value&&e.value==+e.value?"number":"text"),To("ngModel",e.value),Zr(2),ba("(",(e.calcAbilityScore()>=0?"+":"")+e.calcAbilityScore(),")")}}function jA(e,t){if(1&e&&(Io(0,"div",60),ga(1),Mo()),2&e){const e=jo(3).dataElm;Co("title",e.name),Zr(1),ma(e.name)}}function UA(e,t){if(1&e&&(Io(0,"div",62),ga(1),Mo()),2&e){const e=jo(3).dataElm;Zr(1),ma(e.value)}}const HA=function(e){return{"min-width":e}};function VA(e,t){if(1&e){const e=Fo();Po(0),Eo(1,jA,2,2,"div",73),Io(2,"div",61),Eo(3,UA,2,1,"div",74),Io(4,"input",75),zo("ngModelChange",function(t){return Ft(e),jo(2).dataElm.value=t}),Mo(),Mo(),Do()}if(2&e){const e=jo(2).dataElm;Zr(1),To("ngIf",e.name),Zr(2),To("ngIf",e.name),Zr(1),Go("type","size"===e.name||"altitude"===e.name?"number":"text"),Go("min","size"===e.name?"0":""),To("ngStyle",Ul(6,HA,e.name?"8em":"100%"))("ngModel",e.value)}}function GA(e,t){1&e&&(Po(0,2),Eo(1,FA,9,4,"ng-container",3),Eo(2,NA,7,5,"ng-container",3),Eo(3,zA,13,13,"ng-container",3),Eo(4,LA,7,7,"ng-container",3),Eo(5,BA,9,6,"ng-container",3),Eo(6,VA,5,8,"ng-container",4),Do(),Ao(7,"div",57)),2&e&&(To("ngSwitch",jo().dataElm.type),Zr(1),To("ngSwitchCase","note"),Zr(1),To("ngSwitchCase","simpleNumber"),Zr(1),To("ngSwitchCase","numberResource"),Zr(1),To("ngSwitchCase","checkProperty"),Zr(1),To("ngSwitchCase","abilityScore"))}function ZA(e,t){if(1&e&&(Eo(0,MA,1,0,"ng-container",50),Eo(1,RA,4,2,"ng-template",null,51,dc),Eo(3,GA,8,6,"ng-template",null,52,dc)),2&e){const e=t.dataElm,n=ko(2),i=ko(4);To("ngIf",0<e.children.length)("ngIfThen",n)("ngIfElse",i)}}function WA(e,t){if(1&e){const e=Fo();Io(0,"div",76),zo("click",function(){return Ft(e),jo().chanageImageView(!1)}),Io(1,"div",77),Io(2,"i",22),ga(3,"close"),Mo(),Mo(),Ao(4,"img",78),ql(5,"safe"),Mo()}if(2&e){const e=jo();To("@fadeInOut","in"),Zr(4),To("src",$l(5,2,e.imageUrl,"resourceUrl"),Xi)}}let YA=(()=>{class e{constructor(e,t,n){this.inventoryService=e,this.changeDetector=t,this.pointerDeviceService=n,this.tabletopObject=null,this.left=0,this.top=0,this._imageFile=Ig.Empty,this.isOpenImageView=!1,this.checkRegExp=/[|\uff5c]/g}get imageUrl(){if(!this.tabletopObject)return"";if(this.isUseIcon)return this.tabletopObject.faceIcon.url;if(this.tabletopObject instanceof gv&&this.tabletopObject.standList&&this.tabletopObject.standList.overviewIndex>-1){const e=this.tabletopObject.standList.standElements[this.tabletopObject.standList.overviewIndex];if(!e)return"";const t=e.getFirstElementByName("imageIdentifier");if(!t)return"";if(this._imageFile.identifier!=t.value){const e=ov.instance.get(t.value);this._imageFile=e||Ig.Empty}return this._imageFile.url}return this.tabletopObject.imageFile?this.tabletopObject.imageFile.url:""}get hasImage(){return 0<this.imageUrl.length}get isUseIcon(){return this.tabletopObject instanceof gv&&this.tabletopObject.isUseIconToOverviewImage&&this.tabletopObject.faceIcon&&0<this.tabletopObject.faceIcon.url.length}get roll(){if(this.tabletopObject instanceof gv){if(this.tabletopObject.standList&&this.tabletopObject.standList.overviewIndex>-1){const e=this.tabletopObject.standList.standElements[this.tabletopObject.standList.overviewIndex];if(!e)return 0;const t=e.getFirstElementByName("applyRoll");return t&&t.value?this.tabletopObject.roll:0}return this.tabletopObject.roll}return 0}get applyImageEffect(){if(this.tabletopObject instanceof gv){if(this.tabletopObject.standList&&this.tabletopObject.standList.overviewIndex>-1){const e=this.tabletopObject.standList.standElements[this.tabletopObject.standList.overviewIndex];if(!e)return!1;const t=e.getFirstElementByName("applyImageEffect");return!(!t||!t.value)}return!0}return!1}get isInverse(){return this.tabletopObject instanceof gv&&!!this.applyImageEffect&&this.tabletopObject.isInverse}get isHollow(){return this.tabletopObject instanceof gv&&!!this.applyImageEffect&&this.tabletopObject.isHollow}get isBlackPaint(){return this.tabletopObject instanceof gv&&!!this.applyImageEffect&&this.tabletopObject.isBlackPaint}get aura(){return this.tabletopObject instanceof gv&&this.applyImageEffect?this.tabletopObject.aura:-1}get inventoryDataElms(){return this.tabletopObject?this.getInventoryTags(this.tabletopObject):[]}get dataElms(){return this.tabletopObject&&this.tabletopObject.detailDataElement?this.tabletopObject.detailDataElement.children:[]}get hasDataElms(){return 0<this.dataElms.length}get newLineString(){return this.inventoryService.newLineString}get isPointerDragging(){return this.pointerDeviceService.isDragging}get pointerEventsStyle(){return{"is-pointer-events-auto":!this.isPointerDragging,"pointer-events-none":this.isPointerDragging}}ngAfterViewInit(){this.initPanelPosition(),setTimeout(()=>{this.adjustPositionRoot()},16),Uy.register(this).on("UPDATE_GAME_OBJECT",-1e3,e=>{let t=Vy.instance.get(e.data.identifier);this.tabletopObject&&t&&t instanceof ev&&(this.tabletopObject===t||this.tabletopObject.contains(t))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",-1e3,e=>{this.changeDetector.markForCheck()})}ngOnDestroy(){Uy.unregister(this)}initPanelPosition(){let e=this.draggablePanel.nativeElement,t=e.offsetWidth,n=this.left+100,i=this.top-e.offsetHeight-50,r=!1;window.innerWidth<n+t&&(n=window.innerWidth-t,r=!0),i<=0&&(i=0),r&&(n=this.left-t-100),n<0&&(n=0),i<0&&(i=0),e.style.left=n+"px",e.style.top=i+"px"}adjustPositionRoot(){let e=this.draggablePanel.nativeElement,t=e.getBoundingClientRect(),n=0,i=0;window.innerWidth<t.right+n&&(n+=window.innerWidth-(t.right+n)),t.left+n<0&&(n+=0-(t.left+n)),window.innerHeight<t.bottom+i&&(i+=window.innerHeight-(t.bottom+i)),t.top+i<0&&(i+=0-(t.top+i)),e.style.left=e.offsetLeft+n+"px",e.style.top=e.offsetTop+i+"px"}chanageImageView(e){this.isOpenImageView=e}getInventoryTags(e){return this.inventoryService.tableInventory.dataElementMap.get(e.identifier)}}return e.\u0275fac=function(t){return new(t||e)(So(rS),So(fl),So(Kw))},e.\u0275cmp=Ze({type:e,selectors:[["overview-panel"]],viewQuery:function(e,t){if(1&e&&cc(OM,3),2&e){let e;lc(e=hc())&&(t.draggablePanel=e.first)}},inputs:{tabletopObject:"tabletopObject",left:"left",top:"top"},decls:23,vars:9,consts:[["appDraggable","",1,"component","is-pointer-events-none"],["draggablePanel",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngIf"],["overviewCard",""],["overviewNote",""],["overviewCharacter",""],["overviewDiceSymbol",""],["dataElement",""],["imageView",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngTemplateOutlet"],[1,"component-content","is-small-size",3,"ngClass"],["style","position: relative;",4,"ngIf"],["class","component-title title-background",3,"ngClass",4,"ngIf"],[1,"component-background"],["class","grid-container-root",4,"ngIf"],[2,"position","relative"],[1,"card-image",3,"src"],[1,"zoom-button",3,"click"],[1,"material-icons"],["class","component-owner position-right-bottom",3,"ngClass",4,"ngIf"],[1,"component-owner","position-right-bottom",3,"ngClass"],[1,"owner-tag"],[1,"component-title","title-background",3,"ngClass"],[1,"grid-container-root"],[1,"grid-container"],[4,"ngFor","ngForOf"],[1,"component-content","is-large-size",3,"ngClass"],[1,"component-title","title-background"],[1,"component-background","text-note-container"],[1,"is-fill"],["spellcheck","false",1,"textarea",3,"ngModel","ngModelChange"],[1,"textarea-spacer"],[1,"component-content","character-grid-container","is-middle-size"],[1,"title-bg-area","title-background",3,"ngClass"],["class","image-area character-image-box",3,"ngClass",4,"ngIf"],[1,"title-area","component-title",3,"ngClass"],[1,"void-area","is-pointer-events-none"],[1,"dataElm-area","component-background",3,"ngClass"],[1,"image-area","character-image-box",3,"ngClass"],[3,"ngStyle"],[1,"inverser",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"character-image",3,"ngClass","src"],[1,"character-image",3,"src"],["class","owner-name-area component-owner",3,"ngClass",4,"ngIf"],[1,"owner-name-area","component-owner",3,"ngClass"],[4,"ngIf","ngIfThen","ngIfElse"],["thenBlock",""],["elseBlock",""],[1,"section",2,"padding-top","0.5em"],["class","section-text",4,"ngIf"],[1,"grid-container","indetnt"],[1,"section-text"],[1,"section","border"],[1,"section"],[1,"note",2,"position","relative"],[1,"tag"],[1,"value"],[1,"hidden-spacer"],["size","1",1,"input",2,"width","4em",3,"type","ngModel","ngModelChange"],[1,"tag",2,"min-width","100px"],[2,"display","inline-block","width","min-content"],[1,"hidden-spacer",2,"margin-right","2em"],["type","number","size","1",1,"input",2,"width","4em",3,"ngModel","ngModelChange"],[2,"display","inline"],[1,"section",2,"line-height","1em"],["type","range","min","0",3,"title","max","ngModel","ngModelChange"],["type","checkbox",2,"width","2em","margin-right","1em",3,"ngModel","checked","ngModelChange","change"],[2,"font-size","smaller"],["class","tag",4,"ngIf"],["class","hidden-spacer",4,"ngIf"],["size","1",1,"input",3,"ngStyle","type","min","ngModel","ngModelChange"],[1,"image-view-background","is-fill",3,"click"],[1,"close-button","is-pointer-events-none"],[1,"contain-image",3,"src"]],template:function(e,t){1&e&&(Io(0,"div",0,1),Po(2,2),Eo(3,IM,1,0,"ng-container",3),Eo(4,PM,2,4,"ng-container",3),Eo(5,RM,2,4,"ng-container",3),Eo(6,zM,2,4,"ng-container",3),Eo(7,jM,2,4,"ng-container",3),Eo(8,VM,2,4,"ng-container",3),Eo(9,ZM,2,4,"ng-container",4),Do(),Mo(),Eo(10,YM,2,1,"ng-container",5),Eo(11,sA,5,7,"ng-template",null,6,dc),Eo(13,oA,9,7,"ng-template",null,7,dc),Eo(15,vA,8,15,"ng-template",null,8,dc),Eo(17,IA,11,18,"ng-template",null,9,dc),Eo(19,ZA,5,3,"ng-template",null,10,dc),Eo(21,WA,6,5,"ng-template",null,11,dc)),2&e&&(To("@fadeInOut","in"),Zr(2),To("ngSwitch",t.tabletopObject.aliasName),Zr(1),To("ngSwitchCase","numberResource"),Zr(1),To("ngSwitchCase","card"),Zr(1),To("ngSwitchCase","card-stack"),Zr(1),To("ngSwitchCase","text-note"),Zr(1),To("ngSwitchCase","character"),Zr(1),To("ngSwitchCase","dice-symbol"),Zr(2),To("ngIf",t.isOpenImageView))},directives:[eI,$h,Xh,Kh,Zh,Jh,Uh,Vh,ju,sd,Sd,Qh,Id,Fd,zu],pipes:[$_],styles:[".component[_ngcontent-%COMP%]{position:absolute;max-height:100%;max-width:100%;box-sizing:border-box;overflow:visible;color:#444;z-index:9000;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.component-content[_ngcontent-%COMP%]{font-size:12px}.is-large-size[_ngcontent-%COMP%]{max-width:350px}.is-middle-size[_ngcontent-%COMP%]{max-width:270px}.is-small-size[_ngcontent-%COMP%]{max-width:250px}.is-middle-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:270px}.is-small-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:250px}.component-background[_ngcontent-%COMP%]{background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border-bottom:1px solid #999}.component-title[_ngcontent-%COMP%]{color:#ccc;font-size:1em;text-align:right;vertical-align:middle;height:32px;line-height:32px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 1em}.title-background[_ngcontent-%COMP%]{background-color:#555;border-top:1px solid #999;border-left:1px solid #999;border-right:1px solid #999}.component-owner[_ngcontent-%COMP%]{font-size:.8em;color:#ccc;vertical-align:middle;text-align:right;padding:2px 1em}.component-owner[_ngcontent-%COMP%], .owner-tag[_ngcontent-%COMP%]{overflow:hidden;max-width:100%;box-sizing:border-box}.owner-tag[_ngcontent-%COMP%]{width:-webkit-min-content;width:-moz-min-content;width:min-content;margin-left:auto;margin-right:0;color:#f5f5f5;background-color:#1e1e1e;padding:3px 9px;border-radius:6px;white-space:nowrap;text-overflow:ellipsis;opacity:.9}.card-image[_ngcontent-%COMP%]{width:250px;max-height:330px;padding:8px;vertical-align:bottom;-o-object-fit:contain;object-fit:contain;box-sizing:border-box;background-color:hsla(0,0%,80%,.5)}.zoom-button[_ngcontent-%COMP%]{position:absolute;left:8px;bottom:-21px;width:42px;height:42px;border-radius:100px;padding:4px}.zoom-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:24px;vertical-align:bottom}.position-right-bottom[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0}.image-view-background[_ngcontent-%COMP%]{color:#ccc;background-color:rgba(30,30,30,.3);z-index:9900}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{position:absolute;right:16px;top:16px}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:36px}.contain-image[_ngcontent-%COMP%]{width:100%;height:100%;box-sizing:border-box;padding:16px;vertical-align:bottom;-o-object-fit:contain;object-fit:contain}.text-note-container[_ngcontent-%COMP%]{width:100%;max-height:400px;padding:.5em 1.5em;box-sizing:border-box;overflow:hidden auto;line-height:1.8;border-left:1px solid #999;border-right:1px solid #999}.character-image-box[_ngcontent-%COMP%]{width:100px;overflow:hidden;vertical-align:bottom;margin-left:.5em;margin-bottom:-6px;z-index:1;overflow:visible}.character-image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom;-o-object-fit:contain;object-fit:contain;-o-object-position:bottom left;object-position:bottom left}.character-image-box.has-icon[_ngcontent-%COMP%]{width:100px;height:100px;max-width:100px;max-height:100px;transform:translateY(-16px);margin-top:16px}.character-image-box.has-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0;object-position:50% 0;border-radius:1em}.character-image[_ngcontent-%COMP%]{padding:0;width:100%;vertical-align:bottom}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.character-grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:-webkit-min-content auto;grid-template-columns:min-content auto;grid-template-rows:1fr auto auto auto}.title-bg-area[_ngcontent-%COMP%]{grid-area:3/1/4/3}.title-area[_ngcontent-%COMP%]{grid-area:3/2/4/3}.owner-name-area[_ngcontent-%COMP%]{grid-area:2/2/3/3}.image-area[_ngcontent-%COMP%]{grid-area:1/1/4/2}.void-area[_ngcontent-%COMP%]{grid-area:1/2/3/3}.dataElm-area[_ngcontent-%COMP%]{grid-area:4/1/5/3}.grid-container-root[_ngcontent-%COMP%]{padding:.5em 1.2em;max-height:250px;overflow:hidden auto;box-sizing:border-box;border-left:1px solid #999;border-right:1px solid #999}.grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr fit-content(80%)}.grid-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{box-sizing:border-box;line-height:24px}.indetnt[_ngcontent-%COMP%]{padding-left:.5em}.section[_ngcontent-%COMP%]{max-width:100%;grid-column:1/span 2}.section-text[_ngcontent-%COMP%]{font-size:1.1em;font-weight:700;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.note[_ngcontent-%COMP%]{margin-left:.5em;font-size:1em;line-height:1.8}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box;resize:both;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.textarea[_ngcontent-%COMP%]:hover{background:#eee}.textarea[_ngcontent-%COMP%]:focus{background:#fff}.tag[_ngcontent-%COMP%]{padding-right:1em;min-width:7em}.tag[_ngcontent-%COMP%], .value[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.value[_ngcontent-%COMP%]{font-size:1.2em;text-align:right}.hidden-spacer[_ngcontent-%COMP%]{height:0}.hidden-spacer[_ngcontent-%COMP%], .textarea-spacer[_ngcontent-%COMP%]{visibility:hidden;min-width:3em;overflow:hidden;white-space:pre-wrap}.textarea-spacer[_ngcontent-%COMP%]{height:auto;min-height:24px;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.input[_ngcontent-%COMP%]{min-width:3em;text-align:right;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#eee}.input[_ngcontent-%COMP%]:focus{background:#fff}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:focus, input[type=number][_ngcontent-%COMP%]:hover{-moz-appearance:number-input}.border[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.separator[_ngcontent-%COMP%]{padding:2px 0;border-bottom:1px solid #888}.with-button-marign[_ngcontent-%COMP%]{padding-left:60px}.is-fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0}.is-bold[_ngcontent-%COMP%]{font-weight:700}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}input[type=range][_ngcontent-%COMP%]{--slider-track-color:transparent;--slider-fill-color:#555;--slider-border-color:#777;--slider-height:0.8em;--slider-thumb-size:1.0em;--range:calc(var(--max) - var(--min));--ratio:calc((var(--val) - var(--min))/var(--range));--sx:calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:1px solid var(--slider-border-color);border-bottom:1px solid var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color);background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms ease 0s}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #fff)}"],data:{animation:[Jd("fadeInOut",[sp("void => *",[ep("100ms ease-out",rp([np({opacity:0,offset:0}),np({opacity:1,offset:1})]))]),sp("* => void",[ep("100ms ease-in",rp([np({opacity:1,offset:0}),np({opacity:0,offset:1})]))])])]},changeDetection:0}),e})(),qA=(()=>{class e{constructor(e,t,n,i){this.ngZone=e,this.viewContainerRef=t,this.componentFactoryResolver=n,this.pointerDeviceService=i,this.callbackOnMouseEnter=e=>this.onMouseEnter(e),this.callbackOnMouseLeave=e=>this.onMouseLeave(e),this.callbackOnMouseDown=e=>this.onMouseDown(e)}ngOnInit(){}ngAfterViewInit(){this.addEventListeners(this.viewContainerRef.element.nativeElement)}ngOnDestroy(){this.removeEventListeners(this.viewContainerRef.element.nativeElement),this.clearTimer(),this.close()}onMouseEnter(e){this.clearTimer(),this.tooltipComponentRef||this.startOpenTimer()}onMouseLeave(e){this.clearTimer(),this.tooltipComponentRef&&this.startCloseTimer()}onMouseDown(e){this.tooltipComponentRef&&(this.tooltipComponentRef.location.nativeElement.contains(e.target)||this.viewContainerRef.element.nativeElement.contains(e.target)||this.ngZone.run(()=>this.closeAll()))}startOpenTimer(){let e=this.pointerDeviceService.pointerX,t=this.pointerDeviceService.pointerY;this.openTooltipTimer=setTimeout(()=>{this.openTooltipTimer=null,4<Math.pow(e-this.pointerDeviceService.pointerX,2)+Math.pow(t-this.pointerDeviceService.pointerY,2)?this.startOpenTimer():this.ngZone.run(()=>this.open())},100)}startCloseTimer(){this.closeTooltipTimer=setTimeout(()=>{this.closeTooltipTimer=null,this.tooltipComponentRef&&this.tooltipComponentRef.location.nativeElement.contains(document.activeElement)?this.startCloseTimer():this.ngZone.run(()=>this.closeAll())},400)}clearTimer(){this.closeTooltipTimer&&clearTimeout(this.closeTooltipTimer),this.openTooltipTimer&&clearTimeout(this.openTooltipTimer),this.closeTooltipTimer=this.openTooltipTimer=null}open(){if(this.closeAll(),this.pointerDeviceService.isDragging)return;let t=j_.defaultParentViewContainerRef;const n=t.injector,i=this.componentFactoryResolver.resolveComponentFactory(YA);this.tooltipComponentRef=t.createComponent(i,t.length,n),this.tooltipComponentRef.instance.tabletopObject=this.tabletopObject,this.tooltipComponentRef.instance.left=this.pointerDeviceService.pointerX,this.tooltipComponentRef.instance.top=this.pointerDeviceService.pointerY,this.addEventListeners(this.tooltipComponentRef.location.nativeElement),this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.addEventListener("mousedown",this.callbackOnMouseDown,!0)}),Uy.register(this).on("DELETE_GAME_OBJECT",-1e3,e=>{this.tabletopObject&&this.tabletopObject.identifier===e.data.identifier&&this.closeAll()}),this.tooltipComponentRef.onDestroy(()=>{this.removeEventListeners(this.tooltipComponentRef.location.nativeElement),document.body.removeEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.removeEventListener("mousedown",this.callbackOnMouseDown,!0),this.clearTimer(),this.tooltipComponentRef=null,Uy.unregister(this)}),e.activeTooltips.push(this.tooltipComponentRef)}close(){if(!this.tooltipComponentRef)return;let t=e.activeTooltips.indexOf(this.tooltipComponentRef);0<=t&&e.activeTooltips.splice(t,1),this.tooltipComponentRef.destroy(),this.tooltipComponentRef=null}closeAll(){e.activeTooltips.forEach(e=>e.destroy()),e.activeTooltips=[],this.close()}addEventListeners(e){this.ngZone.runOutsideAngular(()=>{e.addEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.addEventListener("mouseleave",this.callbackOnMouseLeave,!1)})}removeEventListeners(e){e.removeEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.removeEventListener("mouseleave",this.callbackOnMouseLeave,!1)}}return e.activeTooltips=[],e.\u0275fac=function(t){return new(t||e)(So(Rc),So(kl),So(La),So(Kw))},e.\u0275dir=Qe({type:e,selectors:[["","appTooltip",""]],inputs:{tabletopObject:["appTooltip","tabletopObject"]}}),e})();function $A(e,t){if(1&e){const e=Fo();Io(0,"div",2),Io(1,"div",3),Io(2,"div",4),ql(3,"safe"),Mo(),Io(4,"div",4),ql(5,"safe"),Mo(),Mo(),Io(6,"div",5),Io(7,"button",6),zo("click",function(){Ft(e);const n=t.$implicit;return jo().drawCard(n)}),ga(8,"\u5c71\u672d\u304b\u3089\u51fa\u3059"),Mo(),Io(9,"button",0),zo("click",function(){Ft(e);const n=t.$implicit;return jo().showDetail(n)}),Io(10,"i",7),ga(11,"settings"),Mo(),ga(12,"\u7de8\u96c6"),Mo(),Ao(13,"br"),Io(14,"button",0),zo("click",function(){Ft(e);const n=t.$implicit;return jo().up(n)}),ga(15,"\u2191"),Mo(),Io(16,"button",0),zo("click",function(){Ft(e);const n=t.$implicit;return jo().down(n)}),ga(17,"\u2193"),Mo(),Ao(18,"br"),Mo(),Mo()}if(2&e){const e=t.$implicit;Zr(1),To("appTooltip",e),Zr(1),ta("background-image",$l(3,5,"url("+(null==e||null==e.frontImage?null:e.frontImage.url)+")","style")),Zr(2),ta("background-image",$l(5,8,"url("+(null==e||null==e.backImage?null:e.backImage.url)+")","style"))}}let XA=(()=>{class e{constructor(e,t){this.panelService=e,this.changeDetector=t,this.cardStack=null,this.owner=Hy.peerContext.userId}ngOnInit(){Promise.resolve().then(()=>this.panelService.title=this.cardStack.name+" \u306e\u30ab\u30fc\u30c9\u4e00\u89a7"),Uy.register(this).on("UPDATE_GAME_OBJECT",-1e3,e=>{let t=Vy.instance.get(e.data.identifier);this.cardStack&&t&&((this.cardStack===t||t instanceof ev&&this.cardStack.contains(t))&&this.changeDetector.markForCheck(),e.data.identifier===this.cardStack.identifier&&this.cardStack.owner!==this.owner&&this.panelService.close())}).on("DELETE_GAME_OBJECT",-1e3,e=>{this.cardStack&&this.cardStack.identifier===e.data.identifier&&this.panelService.close()})}ngOnDestroy(){Uy.unregister(this),this.cardStack.owner===this.owner&&(this.cardStack.owner="")}drawCard(e){e.parent.removeChild(e),e.location.x=this.cardStack.location.x+100+50*Math.random(),e.location.y=this.cardStack.location.y+25+50*Math.random(),e.location.name=this.cardStack.location.name,e.rotate+=this.cardStack.rotate,360<e.rotate&&(e.rotate-=360),e.toTopmost(),q_.play(Y_.cardDraw)}up(e){let t=e.parent,n=t.children.indexOf(e);0<n&&t.insertBefore(e,t.children[n-1])}down(e){let t=e.parent,n=t.children.indexOf(e);n<t.children.length-1&&t.insertBefore(t.children[n+1],e)}close(e=!1){e&&(this.cardStack.shuffle(),Uy.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier}),q_.play(Y_.cardShuffle)),this.panelService.close()}showDetail(e){let t="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(t+=" - "+e.name),this.panelService.open(wx,{title:t,left:this.panelService.left+10,top:this.panelService.top+20,width:600,height:600}).tabletopObject=e}trackByCard(e,t){return t.identifier}}return e.\u0275fac=function(t){return new(t||e)(So(wv),So(fl))},e.\u0275cmp=Ze({type:e,selectors:[["card-stack-list"]],inputs:{cardStack:"cardStack"},decls:5,vars:2,consts:[[3,"click"],["class","box",4,"ngFor","ngForOf","ngForTrackBy"],[1,"box"],[1,"image-box",3,"appTooltip"],[1,"image","contain"],[2,"display","inline-block"],["type","submit",3,"click"],[1,"material-icons",2,"font-size","1.1em","vertical-align","text-bottom"]],template:function(e,t){1&e&&(Io(0,"div"),Io(1,"button",0),zo("click",function(){return t.close(!0)}),ga(2,"\u30b7\u30e3\u30c3\u30d5\u30eb\u3057\u3066\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b"),Mo(),Ao(3,"hr"),Eo(4,$A,19,11,"div",1),Mo()),2&e&&(Zr(4),To("ngForOf",t.cardStack.cards)("ngForTrackBy",t.trackByCard))},directives:[Vh,qA],pipes:[$_],styles:[".box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%], .image-box[_ngcontent-%COMP%]{display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px}.contain[_ngcontent-%COMP%]{background-position:50%;background-repeat:no-repeat;background-size:contain}"],changeDetection:0}),e})();const KA=function(e){return{transform:e}};function QA(e,t){if(1&e){const e=Fo();Io(0,"div"),zo("@shuffle.start",function(t){return Ft(e),jo().animationShuffleStarted(t)})("@shuffle.done",function(t){return Ft(e),jo().animationShuffleDone(t)}),Ao(1,"img",5),ql(2,"safe"),Mo()}if(2&e){const e=jo();To("@bounceInOut",void 0)("@shuffle",e.animeState),Zr(1),To("ngStyle",Ul(7,KA,"rotateZ("+e.topCard.rotate+"deg)"))("src",$l(2,4,e.imageFile.url,"resourceUrl"),Xi)}}function JA(e,t){1&e&&(Po(0),Io(1,"div",6),Io(2,"i",7),ga(3,"autorenew"),Mo(),Mo(),Io(4,"div",8),Io(5,"i",7),ga(6,"autorenew"),Mo(),Mo(),Io(7,"div",9),Io(8,"i",7),ga(9,"autorenew"),Mo(),Mo(),Io(10,"div",10),Io(11,"i",7),ga(12,"autorenew"),Mo(),Mo(),Do())}function eP(e,t){if(1&e&&(Io(0,"div",11),Io(1,"span"),ga(2),Mo(),Mo()),2&e){const e=jo();To("ngStyle",Ul(2,KA,"translateY(-50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),Zr(2),ba("",e.cards.length,"\u679a")}}const tP=function(e,t){return{"background-color":e,transform:t}};function nP(e,t){if(1&e&&(Io(0,"div",12),Io(1,"span"),Io(2,"b"),ga(3),Mo(),ga(4," \u304c\u78ba\u8a8d\u4e2d"),Mo(),Mo()),2&e){const e=jo();To("ngStyle",Hl(2,tP,e.ownerColor,"translateY(50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),Zr(3),ma(e.ownerName)}}const iP=function(e){return{"is-empty":e}};let rP=(()=>{class e{constructor(e,t,n,i,r,s,o,a){this.ngZone=e,this.contextMenuService=t,this.panelService=n,this.elementRef=i,this.changeDetector=r,this.imageService=s,this.pointerDeviceService=o,this.modalService=a,this.cardStack=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null}get name(){return this.cardStack.name}get rotate(){return this.cardStack.rotate}set rotate(e){this.cardStack.rotate=e}get zindex(){return this.cardStack.zindex}get isShowTotal(){return this.cardStack.isShowTotal}get cards(){return this.cardStack.cards}get isEmpty(){return this.cardStack.isEmpty}get size(){let e=this.cardStack.topCard;return e?e.size:2}get hasOwner(){return this.cardStack.hasOwner}get ownerName(){return this.cardStack.ownerName}get ownerColor(){return this.cardStack.ownerColor}get topCard(){return this.cardStack.topCard}get imageFile(){return this.imageService.getSkeletonOr(this.cardStack.imageFile)}get isIconHidden(){return null!=this.iconHiddenTimer}ngOnInit(){Uy.register(this).on("SHUFFLE_CARD_STACK",-1e3,e=>{e.data.identifier===this.cardStack.identifier&&(this.animeState="active",this.changeDetector.markForCheck())}).on("INVERSE_CARD_STACK",-1e3,e=>{e.data.identifier===this.cardStack.identifier&&(this.animeState="inverse",this.changeDetector.markForCheck())}).on("UPDATE_GAME_OBJECT",-1e3,e=>{let t=Vy.instance.get(e.data.identifier);this.cardStack&&t&&(this.cardStack===t||t instanceof ev&&this.cardStack.contains(t)||t instanceof av&&t.userId===this.cardStack.owner)&&this.changeDetector.markForCheck()}).on("CARD_STACK_DECREASED",e=>{e.data.cardStackIdentifier===this.cardStack.identifier&&this.cardStack&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",-1e3,e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let t=av.findByPeerId(e.data.peerId);t&&this.cardStack.owner!==t.userId||this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.cardStack,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain","text-note"]},this.rotableOption={tabletopObject:this.cardStack}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new JO(this.elementRef.nativeElement)}),this.input.onStart=e=>this.ngZone.run(()=>this.onInputStart(e))}ngOnDestroy(){this.input.destroy(),Uy.unregister(this)}animationShuffleStarted(e){}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onCardDrop(e){if(this.cardStack!==e.detail&&(e.detail instanceof rw!=0||e.detail instanceof ow!=0))if(e.stopPropagation(),e.preventDefault(),e.detail instanceof rw){let t=e.detail;Math.pow(t.location.x-this.cardStack.location.x,2)+Math.pow(t.location.y-this.cardStack.location.y,2)+Math.pow(t.posZ-this.cardStack.posZ,2)<Math.pow(50,2)&&this.cardStack.putOnTop(t)}else if(e.detail instanceof ow){let t=e.detail;Math.pow(t.location.x-this.cardStack.location.x,2)+Math.pow(t.location.y-this.cardStack.location.y,2)+Math.pow(t.posZ-this.cardStack.posZ,2)<Math.pow(25,2)&&this.concatStack(t)}}startDoubleClickTimer(e){if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(()=>this.stopDoubleClickTimer(),e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}stopDoubleClickTimer(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}onDoubleClick(){this.stopDoubleClickTimer(),Math.pow(this.doubleClickPoint.x-this.input.pointer.x,2)+Math.pow(this.doubleClickPoint.y-this.input.pointer.y,2)<Math.pow(10,2)&&(console.log("onDoubleClick !!!!"),null!=this.drawCard()&&q_.play(Y_.cardDraw))}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.startDoubleClickTimer(e),this.cardStack.toTopmost(),this.startIconHiddenTimer(),Uy.trigger("SELECT_TABLETOP_OBJECT",{identifier:this.cardStack.identifier,className:"GameCharacter"})}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:"\u30ab\u30fc\u30c9\u3092\uff11\u679a\u5f15\u304f",action:()=>{null!=this.drawCard()&&q_.play(Y_.cardDraw)},default:this.cards.length>0,disabled:0==this.cards.length},{name:"\u30ab\u30fc\u30c9\u3092\u5f15\u304f",action:null,subActions:[2,3,4,5,10].map(e=>({name:`${e}\u679a`,action:()=>{for(let t=0;t<e&&null!=this.drawCard();t++)0!=t&&3!=t&&9!=t||q_.play(Y_.cardDraw)}})),disabled:0==this.cards.length},B_,{name:"\u4e00\u756a\u4e0a\u3092\u8868\u306b\u3059\u308b",action:()=>{this.cardStack.faceUp(),q_.play(Y_.cardDraw)},disabled:0==this.cards.length},{name:"\u4e00\u756a\u4e0a\u3092\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDown(),q_.play(Y_.cardDraw)},disabled:0==this.cards.length},B_,{name:"\u3059\u3079\u3066\u8868\u306b\u3059\u308b",action:()=>{this.cardStack.faceUpAll(),q_.play(Y_.cardDraw)},disabled:0==this.cards.length},{name:"\u3059\u3079\u3066\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDownAll(),q_.play(Y_.cardDraw)},disabled:0==this.cards.length},{name:"\u3059\u3079\u3066\u6b63\u4f4d\u7f6e\u306b\u3059\u308b",action:()=>{this.cardStack.uprightAll(),q_.play(Y_.cardDraw)},disabled:0==this.cards.length},B_,{name:"\u30b7\u30e3\u30c3\u30d5\u30eb",action:()=>{this.cardStack.shuffle(),q_.play(Y_.cardShuffle),Uy.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier})},disabled:0==this.cards.length},{name:"\u30ab\u30fc\u30c9\u4e00\u89a7\u3092\u898b\u308b",action:()=>{this.showStackList(this.cardStack)},disabled:0==this.cards.length},B_,this.isShowTotal?{name:"\u2611 \u679a\u6570\u3092\u8868\u793a",action:()=>{this.cardStack.isShowTotal=!1}}:{name:"\u2610 \u679a\u6570\u3092\u8868\u793a",action:()=>{this.cardStack.isShowTotal=!0}},{name:"\u30ab\u30fc\u30c9\u30b5\u30a4\u30ba\u3092\u63c3\u3048\u308b",action:()=>{this.cardStack.topCard&&this.cardStack.unifyCardsSize(this.cardStack.topCard.size)},disabled:0==this.cards.length},B_,{name:"\u5c71\u672d\u3092\u4eba\u6570\u5206\u306b\u5206\u5272\u3059\u308b",action:()=>{this.splitStack(Hy.peerIds.length),q_.play(Y_.cardDraw)},disabled:0==this.cards.length},{name:"\u5c71\u672d\u3092\u5d29\u3059",action:()=>{this.breakStack(),q_.play(Y_.cardShuffle)},disabled:0==this.cards.length},{name:"\u5c71\u672d\u5168\u4f53\u3092\u88cf\u8fd4\u3059",action:()=>{this.cardStack.inverse(),q_.play(Y_.cardDraw),q_.play(Y_.cardDraw),Uy.call("INVERSE_CARD_STACK",{identifier:this.cardStack.identifier})},disabled:0==this.cards.length},B_,{name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.cardStack)}},this.cardStack.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.cardStack.getUrls().map(e=>{const t=e.value.toString();return{name:e.name?e.name:t,action:()=>{this.modalService.open(Iv,{url:t,title:this.cardStack.name,subTitle:e.name})},disabled:!rv.validUrl(t),error:rv.validUrl(t)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",materialIcon:"open_in_new"}})},this.cardStack.getUrls().length<=0?null:B_,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let e=this.cardStack.clone();e.location.x+=this.gridSize,e.location.y+=this.gridSize,e.owner="",e.toTopmost(),q_.play(Y_.cardPut)}},{name:"\u5c71\u672d\u3092\u524a\u9664\u3059\u308b",action:()=>{this.cardStack.setLocation("graveyard"),this.cardStack.destroy(),q_.play(Y_.sweep)}}],this.name)}onMove(){q_.play(Y_.cardPick)}onMoved(){q_.play(Y_.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}drawCard(){let e=this.cardStack.drawCard();return e&&(this.cardStack.update(),e.location.x+=100+50*Math.random(),e.location.y+=25+50*Math.random(),e.setLocation(this.cardStack.location.name)),e}breakStack(){let e=this.cardStack.drawCardAll().reverse();for(let t of e)t.location.x+=25-50*Math.random(),t.location.y+=25-50*Math.random(),t.toTopmost(),t.setLocation(this.cardStack.location.name);this.cardStack.setLocation("graveyard"),this.cardStack.destroy()}splitStack(e){if(e<2)return;let t=[];for(let s=0;s<e;s++){let e=ow.create(this.cardStack.name);e.location.x=this.cardStack.location.x+50-100*Math.random(),e.location.y=this.cardStack.location.y+50-100*Math.random(),e.posZ=this.cardStack.posZ,e.location.name=this.cardStack.location.name,e.rotate=this.rotate,e.toTopmost(),t.push(e)}let n=this.cardStack.drawCardAll();this.cardStack.setLocation("graveyard"),this.cardStack.destroy();let i=0,r=n.length/e*(i+1);for(let s=0;s<n.length;s++)t[i].putOnBottom(n[s]),r<=s+1&&(i++,r=n.length/e*(i+1))}concatStack(e,t=this.cardStack){let n=ow.create(e.name);n.location.name=t.location.name,n.location.x=t.location.x,n.location.y=t.location.y,n.posZ=t.posZ,n.zindex=e.zindex,n.rotate=t.rotate;let i=t.drawCardAll(),r=e.drawCardAll();for(let s of r.concat(i))n.putOnBottom(s);t.setLocation(""),t.destroy(),e.setLocation(""),e.destroy()}dispatchCardDropEvent(){let e=this.elementRef.nativeElement.parentElement.children,t=new CustomEvent("carddrop",{detail:this.cardStack,bubbles:!0});for(let n=0;n<e.length;n++)e[n].dispatchEvent(t)}showDetail(e){Uy.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let t=this.pointerDeviceService.pointers[0],n="\u5c71\u672d\u8a2d\u5b9a";e.name.length&&(n+=" - "+e.name),this.panelService.open(wx,{title:n,left:t.x-300,top:t.y-300,width:600,height:600}).tabletopObject=e}showStackList(e){Uy.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let t=this.pointerDeviceService.pointers[0],n={left:t.x-200,top:t.y-300,width:400,height:600};this.cardStack.owner=Hy.peerContext.userId,this.panelService.open(XA,n).cardStack=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}}return e.\u0275fac=function(t){return new(t||e)(So(Rc),So(j_),So(wv),So(Ha),So(fl),So(MO),So(Kw),So(xv))},e.\u0275cmp=Ze({type:e,selectors:[["card-stack"]],hostBindings:function(e,t){1&e&&zo("carddrop",function(e){return t.onCardDrop(e)})("dragstart",function(e){return t.onDragstart(e)})("contextmenu",function(e){return t.onContextMenu(e)})},inputs:{cardStack:"cardStack",is3D:"is3D"},decls:6,vars:11,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"ngClass","movable.option","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-pointer-events-auto","is-grab",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[4,"ngIf"],["class","name-tag is-nowrap is-black-background",3,"ngStyle",4,"ngIf"],["class","name-tag has-length-limit is-nowrap is-black-background","style","color: whitesmoke",3,"ngStyle",4,"ngIf"],[1,"card-image",3,"ngStyle","src"],[1,"rotate-grab","of-left-top"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom"],[1,"rotate-grab","of-right-bottom"],[1,"rotate-grab","of-right-top"],[1,"name-tag","is-nowrap","is-black-background",3,"ngStyle"],[1,"name-tag","has-length-limit","is-nowrap","is-black-background",2,"color","whitesmoke",3,"ngStyle"]],template:function(e,t){1&e&&(Io(0,"div",0),zo("movable.ondragstart",function(){return t.onMove()})("movable.ondragend",function(){return t.onMoved()}),Io(1,"div",1),zo("rotable.ondragstart",function(){return t.onMove()})("rotable.ondragend",function(){return t.onMoved()}),Eo(2,QA,3,9,"div",2),Eo(3,JA,13,0,"ng-container",2),Eo(4,eP,3,4,"div",3),Eo(5,nP,5,5,"div",4),Mo(),Mo()),2&e&&(ta("width",t.size*t.gridSize,"px"),To("ngClass",Ul(9,iP,t.isEmpty))("movable.option",t.movableOption),Zr(1),To("rotable.option",t.rotableOption),Zr(1),To("ngIf",t.topCard&&t.imageFile),Zr(1),To("ngIf",!t.isIconHidden),Zr(1),To("ngIf",t.isShowTotal),Zr(1),To("ngIf",t.hasOwner))},directives:[WI,Uh,YI,Zh,Qh],pipes:[$_],styles:[".is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.is-empty[_ngcontent-%COMP%]{height:100px;width:100px}.component[_ngcontent-%COMP%]{position:absolute;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component[_ngcontent-%COMP%], .component-content[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;margin-top:-5px;margin-left:-5px;border:5px solid #ccc;border-radius:5px;background-color:#ccc}.card-image[_ngcontent-%COMP%]{display:block;top:0;left:0;bottom:0;right:0;margin:auto;height:auto;width:100%}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;display:none}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:50%;opacity:.9}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;max-width:18em}.has-length-limit[_ngcontent-%COMP%], .is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:rgba(30,30,30,.8)}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%]{display:inline}"],data:{animation:[Jd("shuffle",[ip("active",np({transform:""})),sp("* => active",[ep("800ms ease",rp([np({transform:"scale3d(0, 0, 0) rotateZ(0deg)",offset:0}),np({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(360deg)",offset:.5}),np({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(520deg)",offset:.75}),np({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(630deg)",offset:.875}),np({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(720deg)",offset:1})]))]),sp("* => inverse",[ep("200ms ease",rp([np({transform:"scale3d(1.0, 1.0, 1.0)",offset:0}),np({transform:"scale3d(0.6, 1.2, 1.2)",offset:.5}),np({transform:"scale3d(0, 0.75, 0.75)",offset:.75}),np({transform:"scale3d(0.5, 1.125, 1.125)",offset:.875}),np({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])]),Jd("bounceInOut",[sp("void => *",[ep("600ms ease",rp([np({transform:"scale3d(0, 0, 0)",offset:0}),np({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),np({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),np({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),np({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),sp("* => void",[ep(100,np({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),e})();function sP(e,t){if(1&e&&(Ao(0,"img",7),ql(1,"safe")),2&e){const e=jo();To("@inverse",e.state)("src",$l(1,2,e.isFront?e.frontImage.url:e.backImage.url,"resourceUrl"),Xi)}}const oP=function(e,t){return{"background-color":e,transform:t}};function aP(e,t){if(1&e&&(Io(0,"div",8),Io(1,"span"),Io(2,"b"),ga(3),Mo(),Mo(),Mo()),2&e){const e=jo();To("ngStyle",Hl(2,oP,e.ownerColor,"translateY(-75%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),Zr(3),ma(e.ownerName)}}function lP(e,t){1&e&&(Ao(0,"img",9),ql(1,"safe")),2&e&&To("src",$l(1,1,jo().frontImage.url,"resourceUrl"),Xi)}function cP(e,t){1&e&&(Po(0),Io(1,"div",10),Io(2,"i",11),ga(3,"autorenew"),Mo(),Mo(),Io(4,"div",12),Io(5,"i",11),ga(6,"autorenew"),Mo(),Mo(),Io(7,"div",13),Io(8,"i",11),ga(9,"autorenew"),Mo(),Mo(),Io(10,"div",14),Io(11,"i",11),ga(12,"autorenew"),Mo(),Mo(),Ao(13,"div",15),Do())}let hP=(()=>{class e{constructor(e,t,n,i,r,s,o,a,l){this.ngZone=e,this.contextMenuService=t,this.panelService=n,this.elementRef=i,this.changeDetector=r,this.tabletopService=s,this.imageService=o,this.pointerDeviceService=a,this.modalService=l,this.card=null,this.is3D=!1,this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null}get name(){return this.card.name}get state(){return this.card.state}set state(e){this.card.state=e}get rotate(){return this.card.rotate}set rotate(e){this.card.rotate=e}get owner(){return this.card.owner}set owner(e){this.card.owner=e}get zindex(){return this.card.zindex}get size(){return this.adjustMinBounds(this.card.size)}get isHand(){return this.card.isHand}get isFront(){return this.card.isFront}get isVisible(){return this.card.isVisible}get hasOwner(){return this.card.hasOwner}get ownerName(){return this.card.ownerName}get ownerColor(){return this.card.ownerColor}get imageFile(){return this.imageService.getSkeletonOr(this.card.imageFile)}get frontImage(){return this.imageService.getSkeletonOr(this.card.frontImage)}get backImage(){return this.imageService.getSkeletonOr(this.card.backImage)}get isIconHidden(){return null!=this.iconHiddenTimer}ngOnInit(){Uy.register(this).on("UPDATE_GAME_OBJECT",-1e3,e=>{let t=Vy.instance.get(e.data.identifier);this.card&&t&&(this.card===t||t instanceof ev&&this.card.contains(t)||t instanceof av&&t.userId===this.card.owner)&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",-1e3,e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let t=av.findByPeerId(e.data.peerId);t&&this.card.owner!==t.userId||this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.card,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain","text-note"]},this.rotableOption={tabletopObject:this.card}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new JO(this.elementRef.nativeElement)}),this.input.onStart=e=>this.ngZone.run(()=>this.onInputStart(e))}ngOnDestroy(){this.input.destroy(),Uy.unregister(this)}onCardDrop(e){if(this.card!==e.detail&&(e.detail instanceof rw!=0||e.detail instanceof ow!=0)&&(e.stopPropagation(),e.preventDefault(),e.detail instanceof ow)){let t=e.detail;Math.pow(t.location.x-this.card.location.x,2)+Math.pow(t.location.y-this.card.location.y,2)+Math.pow(t.posZ-this.card.posZ,2)<Math.pow(25,2)&&(t.location.x=this.card.location.x,t.location.y=this.card.location.y,t.posZ=this.card.posZ,t.putOnBottom(this.card))}}startDoubleClickTimer(e){if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(()=>this.stopDoubleClickTimer(),e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}stopDoubleClickTimer(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}onDoubleClick(){if(this.stopDoubleClickTimer(),Math.pow(this.doubleClickPoint.x-this.input.pointer.x,2)+Math.pow(this.doubleClickPoint.y-this.input.pointer.y,2)<Math.pow(10,2)){if(console.log("onDoubleClick !!!!"),this.hasOwner&&!this.isHand)return;this.state=this.isVisible&&!this.isHand?iw.BACK:iw.FRONT,this.owner="",q_.play(Y_.cardDraw)}}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.startDoubleClickTimer(e),this.card.toTopmost(),this.startIconHiddenTimer()}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[!this.isVisible||this.isHand?{name:this.isHand?"\u8868\u5411\u304d\u3067\u51fa\u3059\uff08\u516c\u958b\u3059\u308b\uff09":this.hasOwner?"\u8868\u306b\u3059\u308b\uff08\u516c\u958b\u3059\u308b\uff09":"\u8868\u306b\u3059\u308b",action:()=>{this.card.faceUp(),q_.play(Y_.cardDraw)},default:!this.hasOwner||this.isHand}:{name:"\u88cf\u306b\u3059\u308b",action:()=>{this.card.faceDown(),q_.play(Y_.cardDraw)},default:!this.hasOwner||this.isHand},this.isHand?{name:"\u88cf\u5411\u304d\u3067\u51fa\u3059",action:()=>{this.card.faceDown(),q_.play(Y_.cardDraw)}}:{name:"\u81ea\u5206\u3060\u3051\u898b\u308b\uff08\u624b\u672d\u306b\u3059\u308b\uff09",action:()=>{q_.play(Y_.cardDraw),this.card.faceDown(),this.owner=Hy.peerContext.userId}},B_,{name:"\u91cd\u306a\u3063\u305f\u30ab\u30fc\u30c9\u3067\u5c71\u672d\u3092\u4f5c\u308b",action:()=>{this.createStack(),q_.play(Y_.cardPut)}},B_,{name:"\u30ab\u30fc\u30c9\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.card)}},this.isVisible&&this.card.getUrls().length>0?{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.card.getUrls().map(e=>{const t=e.value.toString();return{name:e.name?e.name:t,action:()=>{this.modalService.open(Iv,{url:t,title:this.card.name,subTitle:e.name})},disabled:!rv.validUrl(t),error:rv.validUrl(t)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",materialIcon:"open_in_new"}})}:null,this.isVisible&&this.card.getUrls().length>0?B_:null,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let e=this.card.clone();e.location.x+=this.gridSize,e.location.y+=this.gridSize,e.toTopmost(),q_.play(Y_.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.card.destroy(),q_.play(Y_.sweep)}}],this.isVisible?this.name:"\u30ab\u30fc\u30c9")}onMove(){this.input.cancel(),q_.play(Y_.cardPick)}onMoved(){q_.play(Y_.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}createStack(){let e=ow.create("\u5c71\u672d");e.location.x=this.card.location.x,e.location.y=this.card.location.y,e.posZ=this.card.posZ,e.location.name=this.card.location.name,e.rotate=this.rotate,e.zindex=this.card.zindex;let t=this.tabletopService.cards.filter(e=>Math.pow(e.location.x-this.card.location.x,2)+Math.pow(e.location.y-this.card.location.y,2)+Math.pow(e.posZ-this.card.posZ,2)<Math.pow(100,2));t.sort((e,t)=>e.zindex<t.zindex?1:e.zindex>t.zindex?-1:0);for(let n of t)e.putOnBottom(n)}dispatchCardDropEvent(){console.log("dispatchCardDropEvent");let e=this.elementRef.nativeElement.parentElement.children,t=new CustomEvent("carddrop",{detail:this.card,bubbles:!0});for(let n=0;n<e.length;n++)e[n].dispatchEvent(t)}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}adjustMinBounds(e,t=0){return e<t?t:e}showDetail(e){Uy.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let t=this.pointerDeviceService.pointers[0],n="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(n+=" - "+e.name),this.panelService.open(wx,{title:n,left:t.x-300,top:t.y-300,width:600,height:600}).tabletopObject=e}}return e.\u0275fac=function(t){return new(t||e)(So(Rc),So(j_),So(wv),So(Ha),So(fl),So(hS),So(MO),So(Kw),So(xv))},e.\u0275cmp=Ze({type:e,selectors:[["card"]],hostBindings:function(e,t){1&e&&zo("carddrop",function(e){return t.onCardDrop(e)})("dragstart",function(e){return t.onDragstart(e)})("contextmenu",function(e){return t.onContextMenu(e)})},inputs:{card:"card",is3D:"is3D"},decls:7,vars:9,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none","is-grab",3,"movable.option","movable.ondragstart","movable.ondragend"],[1,"is-pointer-events-none"],["appRotable","",1,"component-content","is-pointer-events-auto",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],["class","card-image",3,"src",4,"ngIf"],["class","name-tag is-nowrap has-length-limit is-black-background",3,"ngStyle",4,"ngIf"],["class","card-image thumbnail-transform is-translucent",3,"src",4,"ngIf"],[4,"ngIf"],[1,"card-image",3,"src"],[1,"name-tag","is-nowrap","has-length-limit","is-black-background",3,"ngStyle"],[1,"card-image","thumbnail-transform","is-translucent",3,"src"],[1,"rotate-grab","of-left-top"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom"],[1,"rotate-grab","of-right-bottom"],[1,"rotate-grab","of-right-top"],[1,"border-bg","is-pointer-events-none"]],template:function(e,t){1&e&&(Io(0,"div",0),zo("movable.ondragstart",function(){return t.onMove()})("movable.ondragend",function(){return t.onMoved()}),Io(1,"div",1),Io(2,"div",2),zo("rotable.ondragstart",function(){return t.onMove()})("rotable.ondragend",function(){return t.onMoved()}),Eo(3,sP,2,5,"img",3),Eo(4,aP,4,5,"div",4),Eo(5,lP,2,4,"img",5),Eo(6,cP,14,0,"ng-container",6),Mo(),Mo(),Mo()),2&e&&(ta("width",t.size*t.gridSize,"px"),To("movable.option",t.movableOption),Zr(1),To("@slidInOut",void 0),Zr(1),To("rotable.option",t.rotableOption),Zr(1),To("ngIf",t.imageFile),Zr(1),To("ngIf",!t.isFront&&t.hasOwner&&0<t.ownerName.length),Zr(1),To("ngIf",t.isHand&&t.frontImage),Zr(1),To("ngIf",!t.isIconHidden))},directives:[WI,YI,Zh,Qh],pipes:[$_],styles:[".is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:auto;width:auto;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;min-width:25px;min-height:25px}.component[_ngcontent-%COMP%], .component-content[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;box-sizing:border-box}.card-image[_ngcontent-%COMP%]{display:block;top:0;left:0;bottom:0;right:0;margin:auto;height:auto;width:100%}.thumbnail-transform[_ngcontent-%COMP%]{position:absolute;transform:scale(.9)}.is-translucent[_ngcontent-%COMP%]{filter:opacity(.8)}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;display:none}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-10px}.of-left-bottom[_ngcontent-%COMP%], .of-left-top[_ngcontent-%COMP%]{left:-10px;border-radius:14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-10px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-10px;right:-10px;border-radius:14px}.of-right-top[_ngcontent-%COMP%]{top:-10px;right:-10px;border-radius:14px}.border-bg[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;border-radius:8px;background-color:hsla(0,0%,80%,.5);top:-2px;left:-2px;right:-2px;bottom:-2px;z-index:-1;display:none}.component[_ngcontent-%COMP%]:hover   .border-bg[_ngcontent-%COMP%]{display:block}.component[_ngcontent-%COMP%]:active   .border-bg[_ngcontent-%COMP%]{display:none}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:0;color:#f5f5f5!important;opacity:.9}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;max-width:18em}.has-length-limit[_ngcontent-%COMP%], .is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:rgba(30,30,30,.8)}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%]{display:inline}"],data:{animation:[Jd("inverse",[ip("inverse",np({transform:""})),sp(":increment, :decrement",[ep("200ms ease",rp([np({transform:"scale3d(1.0, 1.0, 1.0)",offset:0}),np({transform:"scale3d(0.6, 1.2, 1.2)",offset:.5}),np({transform:"scale3d(0, 0.75, 0.75)",offset:.75}),np({transform:"scale3d(0.5, 1.125, 1.125)",offset:.875}),np({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])]),Jd("slidInOut",[sp("void => *",[ep("200ms ease",rp([np({"transform-origin":"left center",transform:"scale3d(0, 1.0, 1.0)",offset:0}),np({"transform-origin":"left center",transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),sp("* => void",[ep(100,np({"transform-origin":"left center",transform:"scale3d(0, 1.0, 1.0)"}))])])]},changeDetection:0}),e})();function uP(e,t){1&e&&(Po(0),Io(1,"div",17),Io(2,"div",18),Io(3,"div",19),ga(4,"autorenew"),Mo(),Io(5,"div",20),ga(6,"autorenew"),Mo(),Mo(),Mo(),Do())}function dP(e,t){1&e&&(Io(0,"i",25),ga(1,"lock"),Mo())}function pP(e,t){if(1&e&&(Io(0,"span"),ga(1),Mo()),2&e){const e=jo(2);Zr(1),ma(e.face)}}function fP(e,t){1&e&&(Io(0,"span"),ga(1,"???"),Mo())}function gP(e,t){1&e&&(Io(0,"i",25),ga(1,"lock"),Mo())}function mP(e,t){if(1&e&&(Io(0,"span"),ga(1),Mo()),2&e){const e=jo(2);Zr(1),ma(e.face)}}function bP(e,t){1&e&&(Io(0,"span"),ga(1,"???"),Mo())}const yP=function(e){return{transform:e}};function vP(e,t){if(1&e&&(Io(0,"div",21),Io(1,"div",22),Eo(2,dP,2,0,"i",23),ga(3),Eo(4,pP,2,1,"span",5),Eo(5,fP,2,0,"span",5),Mo(),Io(6,"div",24),Eo(7,gP,2,0,"i",23),ga(8),Eo(9,mP,2,1,"span",5),Eo(10,bP,2,0,"span",5),Mo(),Mo()),2&e){const e=jo();To("ngStyle",Ul(9,yP,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateX("+e.nameTagRotate+"deg)")),Zr(2),To("ngIf",e.isLock&&e.hasOwner),Zr(1),ba("",e.name,":"),Zr(1),To("ngIf",e.isVisible),Zr(1),To("ngIf",!e.isVisible),Zr(2),To("ngIf",e.isLock&&e.hasOwner),Zr(1),ba("",e.name,":"),Zr(1),To("ngIf",e.isVisible),Zr(1),To("ngIf",!e.isVisible)}}const _P=function(e,t){return{"background-color":e,transform:t}};function wP(e,t){if(1&e&&(Io(0,"div",26),Io(1,"div",27),Io(2,"b"),ga(3),Mo(),Mo(),Io(4,"div",28),Io(5,"b"),ga(6),Mo(),Mo(),Mo()),2&e){const e=jo();To("ngStyle",Hl(3,_P,e.ownerColor+"dd","translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateX("+e.nameTagRotate+"deg)")),Zr(3),ma(e.ownerName),Zr(3),ma(e.ownerName)}}const CP=function(e,t){return{"is-black-mask":e,"is-harf-black-mask":t}};function xP(e,t){if(1&e&&(Ao(0,"img",29),ql(1,"safe")),2&e){const e=jo();To("src",$l(1,2,e.imageFile.url,"resourceUrl"),Xi)("ngClass",Hl(5,CP,!e.isVisible,e.isMine))}}function EP(e,t){if(1&e&&(Ao(0,"img",30),ql(1,"safe")),2&e){const e=jo();To("src",$l(1,2,e.imageFile.url,"resourceUrl"),Xi)("ngClass",Hl(5,CP,!e.isVisible,e.isMine))}}function kP(e,t){1&e&&(Ao(0,"img",31),ql(1,"safe")),2&e&&To("src",$l(1,1,jo().imageFile.url,"resourceUrl"),Xi)}function SP(e,t){1&e&&(Ao(0,"img",32),ql(1,"safe")),2&e&&To("src",$l(1,1,jo().imageFile.url,"resourceUrl"),Xi)}const TP=function(e){return{"is-gray-border":e}};let OP=(()=>{class e{constructor(e,t,n,i,r,s,o,a){this.ngZone=e,this.panelService=t,this.contextMenuService=n,this.elementRef=i,this.changeDetector=r,this.pointerDeviceService=s,this.imageService=o,this.modalService=a,this.diceSymbol=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null,this.viewRotateX=50,this.viewRotateZ=10}get face(){return this.diceSymbol.face}set face(e){this.diceSymbol.face=e}get owner(){return this.diceSymbol.owner}set owner(e){this.diceSymbol.owner=e}get rotate(){return this.diceSymbol.rotate}set rotate(e){this.diceSymbol.rotate=e}get name(){return this.diceSymbol.name}set name(e){this.diceSymbol.name=e}get size(){return this.adjustMinBounds(this.diceSymbol.size)}get faces(){return this.diceSymbol.faces}get nothingFaces(){return this.diceSymbol.nothingFaces}get imageFile(){return this.imageService.getEmptyOr(this.diceSymbol.imageFile)}get isMine(){return this.diceSymbol.isMine}get hasOwner(){return this.diceSymbol.hasOwner}get ownerName(){return this.diceSymbol.ownerName}get ownerColor(){return this.diceSymbol.ownerColor}get isVisible(){return this.diceSymbol.isVisible}get isDropShadow(){return this.diceSymbol.isDropShadow}set isDropShadow(e){this.diceSymbol.isDropShadow=e}get isLock(){return this.diceSymbol.isLock}set isLock(e){this.diceSymbol.isLock=e}get isIconHidden(){return null!=this.iconHiddenTimer}get nameTagRotate(){let e=this.viewRotateX%360-90,t=(this.viewRotateZ+this.rotate)%360;return t=t>0?t:360+t,(e>0?e:360+e)*(this.isFlip?1:-1)}get isFlip(){let e=(this.viewRotateZ+this.rotate)%360;return e=e>0?e:360+e,90<e&&e<270}ngOnInit(){Uy.register(this).on("ROLL_DICE_SYNBOL",-1e3,e=>{e.data.identifier===this.diceSymbol.identifier&&this.ngZone.run(()=>{this.animeState="inactive",this.changeDetector.markForCheck(),setTimeout(()=>{this.animeState="active",this.changeDetector.markForCheck()})})}).on("UPDATE_GAME_OBJECT",-1e3,e=>{let t=Vy.instance.get(e.data.identifier);this.diceSymbol&&t&&(this.diceSymbol===t||t instanceof ev&&this.diceSymbol.contains(t)||t instanceof av&&t.userId===this.diceSymbol.owner)&&this.changeDetector.markForCheck()}).on("DICE_ALL_OPEN",-1e3,e=>{this.owner&&!this.isLock&&(this.owner="",q_.play(Y_.unlock))}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateX=e.data.x,this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",-1e3,e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let t=av.findByPeerId(e.data.peerId);t&&this.diceSymbol.owner!==t.userId||this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.diceSymbol,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain","text-note","character"]},this.rotableOption={tabletopObject:this.diceSymbol}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new JO(this.elementRef.nativeElement)}),this.input.onStart=e=>this.ngZone.run(()=>this.onInputStart(e))}ngOnDestroy(){this.input.destroy(),Uy.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onInputStart(e){this.startDoubleClickTimer(e),this.startIconHiddenTimer()}startDoubleClickTimer(e){if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(()=>this.stopDoubleClickTimer(),e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}stopDoubleClickTimer(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}onDoubleClick(){this.stopDoubleClickTimer(),Math.pow(this.doubleClickPoint.x-this.input.pointer.x,2)+Math.pow(this.doubleClickPoint.y-this.input.pointer.y,2)<Math.pow(10,2)&&this.isVisible&&this.diceRoll()}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let t=this.pointerDeviceService.pointers[0],n=[];if(n.push({name:"\u30c0\u30a4\u30b9\u3092\u632f\u308b",action:()=>{this.diceRoll()},disabled:!this.isVisible,default:this.isVisible}),n.push(B_),(this.isMine||this.hasOwner)&&n.push({name:"\u30c0\u30a4\u30b9\u3092\u516c\u958b",action:()=>{this.owner="",q_.play(Y_.unlock)}}),this.isMine||n.push({name:"\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{this.owner=Hy.peerContext.userId,q_.play(Y_.lock)}}),n.push(this.isLock?{name:"\u2611 \u4e00\u6589\u516c\u958b\u3057\u306a\u3044",action:()=>{this.isLock=!1,q_.play(Y_.unlock)}}:{name:"\u2610 \u4e00\u6589\u516c\u958b\u3057\u306a\u3044",action:()=>{this.isLock=!0,q_.play(Y_.lock)}}),this.isVisible){let e=[],t=this.nothingFaces;t.length>0&&(t.forEach(t=>{e.push({name:`${this.face==t?"\u25c9":"\u25cb"} ${t}\u3000`,action:()=>{q_.play(Y_.dicePut),this.face=t}})}),e.push(B_)),this.faces.forEach(t=>{e.push({name:`${this.face==t?"\u25c9":"\u25cb"} ${t}\u3000`,action:()=>{q_.play(Y_.dicePut),this.face=t}})}),n.push({name:"\u30c0\u30a4\u30b9\u76ee",action:null,subActions:e})}n.push(B_),n.push(this.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!1}}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!0}}),n.push(B_),n.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.diceSymbol)}}),this.diceSymbol.getUrls().length>0&&(n.push({name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.diceSymbol.getUrls().map(e=>{const t=e.value.toString();return{name:e.name?e.name:t,action:()=>{this.modalService.open(Iv,{url:t,title:this.diceSymbol.name,subTitle:e.name})},disabled:!rv.validUrl(t),error:rv.validUrl(t)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",materialIcon:"open_in_new"}})}),n.push(B_)),n.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let e=this.diceSymbol.clone();e.location.x+=this.gridSize,e.location.y+=this.gridSize,e.update(),q_.play(Y_.dicePut)}}),n.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.diceSymbol.destroy(),q_.play(Y_.sweep)}}),this.contextMenuService.open(t,n,this.name)}onMove(){q_.play(Y_.dicePick)}onMoved(){q_.play(Y_.dicePut)}diceRoll(){return Uy.call("ROLL_DICE_SYNBOL",{identifier:this.diceSymbol.identifier}),q_.play(Y_.diceRoll1),this.diceSymbol.diceRoll()}showDetail(e){Uy.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let t=this.pointerDeviceService.pointers[0],n="\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u8a2d\u5b9a";e.name.length&&(n+=" - "+e.name),this.panelService.open(wx,{title:n,left:t.x-300,top:t.y-300,width:600,height:600}).tabletopObject=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}adjustMinBounds(e,t=0){return e<t?t:e}}return e.\u0275fac=function(t){return new(t||e)(So(Rc),So(wv),So(j_),So(Ha),So(fl),So(Kw),So(MO),So(xv))},e.\u0275cmp=Ze({type:e,selectors:[["dice-symbol"]],hostBindings:function(e,t){1&e&&zo("dragstart",function(e){return t.onDragstart(e)})("contextmenu",function(e){return t.onContextMenu(e)})},inputs:{diceSymbol:"diceSymbol",is3D:"is3D"},decls:19,vars:31,consts:[["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.option","movable.ondragstart","movable.ondragend"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[1,"pedestal-inner",3,"ngClass"],[1,"pedestal-outer"],[4,"ngIf"],[1,"upright-transform","is-fit-width","is-3d"],[1,"rotate-frame","is-3d"],[1,"rotate-inner","is-3d"],[1,"is-3d",2,"transform-origin","center bottom"],["class","name-tag is-nowrap is-black-background is-3d",3,"ngStyle",4,"ngIf"],["class","owner-tag is-nowrap is-black-background is-3d",3,"ngStyle",4,"ngIf"],["class","image front-face is-3d",3,"src","ngClass",4,"ngIf"],["class","image back-face is-3d","style","transform: rotateY(-180deg)",3,"src","ngClass",4,"ngIf"],[1,"is-3d",2,"position","relative","top","-20%"],["class","image shadow","style","opacity: 0.7; filter: brightness(0) blur(1px)",3,"src",4,"ngIf"],["class","image shadow","style","opacity: 0.7; filter: brightness(0) blur(1px); transform: scaleX(-1)",3,"src",4,"ngIf"],[1,"pedestal-grab","rotate-grab"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"name-tag","is-nowrap","is-black-background","is-3d",3,"ngStyle"],[1,"fornt-tag","is-3d"],["class","material-icons lock-icon",4,"ngIf"],[1,"back-tag","is-3d"],[1,"material-icons","lock-icon"],[1,"owner-tag","is-nowrap","is-black-background","is-3d",3,"ngStyle"],[1,"fornt-tag","is-3d",2,"color","whitesmoke"],[1,"back-tag","is-3d",2,"color","whitesmoke"],[1,"image","front-face","is-3d",3,"src","ngClass"],[1,"image","back-face","is-3d",2,"transform","rotateY(-180deg)",3,"src","ngClass"],[1,"image","shadow",2,"opacity","0.7","filter","brightness(0) blur(1px)",3,"src"],[1,"image","shadow",2,"opacity","0.7","filter","brightness(0) blur(1px)","transform","scaleX(-1)",3,"src"]],template:function(e,t){1&e&&(Io(0,"div",0),zo("movable.ondragstart",function(){return t.onMove()})("movable.ondragend",function(){return t.onMoved()}),Io(1,"div",1),Io(2,"div",2),zo("rotable.ondragstart",function(){return t.onMove()})("rotable.ondragend",function(){return t.onMoved()}),Ao(3,"div",3),Ao(4,"div",4),Eo(5,uP,7,0,"ng-container",5),Io(6,"div",1),Io(7,"div",6),Io(8,"div",7),Io(9,"div",8),Io(10,"div",9),zo("@diceRollNameTag.done",function(e){return t.animationShuffleDone(e)}),Eo(11,vP,11,11,"div",10),Mo(),Eo(12,wP,7,6,"div",11),Io(13,"div",1),zo("@diceRoll.done",function(e){return t.animationShuffleDone(e)}),Eo(14,xP,2,8,"img",12),Eo(15,EP,2,8,"img",13),Mo(),Mo(),Mo(),Mo(),Io(16,"div",14),zo("@diceRoll.done",function(e){return t.animationShuffleDone(e)}),Eo(17,kP,2,4,"img",15),Eo(18,SP,2,4,"img",16),Mo(),Mo(),Mo(),Mo(),Mo()),2&e&&(ta("width",t.size*t.gridSize,"px")("height",t.size*t.gridSize,"px"),To("movable.option",t.movableOption),Zr(1),To("@bounceInOut","in"),Zr(1),To("rotable.option",t.rotableOption),Zr(1),To("ngClass",Ul(29,TP,t.hasOwner)),Zr(2),To("ngIf",!t.isIconHidden),Zr(3),ta("width",t.size*t.gridSize,"px")("height",t.size*t.gridSize,"px"),Zr(2),To("@changeFaceNameTag",t.isVisible?t.face:null)("@diceRollNameTag",t.animeState),Zr(1),To("ngIf",0<t.name.length),Zr(1),To("ngIf",t.hasOwner&&0<t.ownerName.length),Zr(1),To("@changeFace",t.isVisible?t.face:null)("@diceRoll",t.animeState),Zr(1),To("ngIf",0<t.imageFile.url.length),Zr(1),To("ngIf",0<t.imageFile.url.length),Zr(1),ta("width",t.size*t.gridSize,"px")("height",t.size*t.gridSize,"px"),To("@changeFace",t.isVisible?t.face:null)("@diceRoll",t.animeState),Zr(1),To("ngIf",!t.isFlip&&t.isDropShadow&&0<t.imageFile.url.length),Zr(1),To("ngIf",t.isFlip&&t.isDropShadow&&0<t.imageFile.url.length))},directives:[WI,YI,Uh,Zh,Qh],pipes:[$_],styles:[".is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;border-color:#999 #ccc #ccc #999;border-style:solid;border-width:28px 12px;border-radius:22px}.pedestal-grab-border[_ngcontent-%COMP%], .pedestal-inner[_ngcontent-%COMP%]{width:100%;height:100%;box-sizing:border-box}.pedestal-inner[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;border:6px solid #d88b4b;border-radius:5px}.is-gray-border[_ngcontent-%COMP%]{border-color:#999}.pedestal-outer[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:2px solid #212121;border-radius:5px}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute}.fill-frame[_ngcontent-%COMP%], .image[_ngcontent-%COMP%]{bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{margin:auto;width:100%;height:auto;vertical-align:bottom}.image.shadow[_ngcontent-%COMP%]{width:100%;height:100%}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.name-tag[_ngcontent-%COMP%]{font-size:15px;top:-30px}.name-tag[_ngcontent-%COMP%], .owner-tag[_ngcontent-%COMP%]{box-sizing:border-box;padding:3px 9px;border-radius:6px;position:absolute}.owner-tag[_ngcontent-%COMP%]{font-size:12px;top:-55px}.rotate-frame[_ngcontent-%COMP%], .rotate-inner[_ngcontent-%COMP%]{bottom:0;left:0;right:0}.rotate-inner[_ngcontent-%COMP%]{position:absolute;width:100%;height:auto}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:rgba(30,30,30,.8)}.back-tag[_ngcontent-%COMP%], .fornt-tag[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.back-tag[_ngcontent-%COMP%]{position:absolute;top:3px;transform:rotateY(-180deg)}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{bottom:0}.of-back[_ngcontent-%COMP%], .of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{top:0}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%]{display:inline}.material-icons.lock-icon[_ngcontent-%COMP%]{display:inline-block;font-size:smaller;margin-right:2px}.back-face[_ngcontent-%COMP%], .front-face[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.back-face[_ngcontent-%COMP%]{position:absolute;transform:rotateY(-180deg)}"],data:{animation:[Jd("diceRoll",[sp("* => active",[ep("800ms ease",rp([np({transform:"scale3d(0.8, 0.8, 0.8) rotateZ(-0deg)",offset:0}),np({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(-360deg)",offset:.5}),np({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(-520deg)",offset:.75}),np({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(-630deg)",offset:.875}),np({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(-720deg)",offset:1})]))])]),Jd("diceRollNameTag",[sp("* => active",[ep("800ms ease",rp([np({transform:"scale3d(0.8, 0.8, 0.8) rotateY(0deg)",offset:0}),np({transform:"scale3d(1.2, 1.2, 1.2) rotateY(360deg)",offset:.5}),np({transform:"scale3d(0.75, 0.75, 0.75) rotateY(520deg)",offset:.75}),np({transform:"scale3d(1.125, 1.125, 1.125) rotateY(630deg)",offset:.875}),np({transform:"scale3d(1.0, 1.0, 1.0) rotateY(720deg)",offset:1})]))])]),Jd("changeFace",[sp(":increment,:decrement",[ep("200ms ease",rp([np({transform:"scale3d(0.8, 0.8, 0.8) rotateZ(0deg)",offset:0}),np({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(-360deg)",offset:1})]))])]),Jd("changeFaceNameTag",[sp(":increment,:decrement",[ep("200ms ease",rp([np({transform:"scale3d(0.8, 0.8, 0.8) rotateY(0deg)",offset:0}),np({transform:"scale3d(1.0, 1.0, 1.0) rotateY(360deg)",offset:1})]))])]),Jd("bounceInOut",[sp("void => *",[ep("600ms ease",rp([np({transform:"scale3d(0, 0, 0)",offset:0}),np({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),np({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),np({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),np({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),sp("* => void",[ep(100,np({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),e})();const IP=["characterImage"],MP=["chatBubble"],AP=function(e){return{opacity:e}};function PP(e,t){if(1&e&&(Ao(0,"img",30),ql(1,"safe")),2&e){const e=jo();ta("height",e.size*e.gridSize*e.heightWidthRatio,"px"),To("src",$l(1,5,0<e.shadowImageFile.url.length?e.shadowImageFile.url:e.imageFile.url,"resourceUrl"),Xi)("ngStyle",Ul(8,AP,e.isHollow?.4:.7))("@switchImageShadow",e.gameCharacter.currntImageIndex)}}const DP=function(e){return{transform:e}};function RP(e,t){if(1&e&&(Io(0,"div",31),Io(1,"div",32),ga(2),Mo(),Io(3,"div",33),ga(4),Mo(),Mo()),2&e){const e=jo();To("ngStyle",Ul(3,DP,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px) translateY("+e.nameplateOffset+"px) rotateX("+e.nameTagRotate+"deg)")),Zr(2),ma(e.name),Zr(2),ma(e.name)}}const FP=function(e,t){return{"black-paint":e,hollow:t}};function NP(e,t){if(1&e){const e=Fo();Io(0,"img",34,35),zo("load",function(){return Ft(e),jo().onImageLoad()}),ql(2,"safe"),Mo()}if(2&e){const e=jo();ta("height",e.size*e.gridSize*e.heightWidthRatio,"px"),To("ngClass",Hl(7,FP,e.isBlackPaint,e.isHollow))("src",$l(2,4,e.imageFile.url,"resourceUrl"),Xi)}}function zP(e,t){if(1&e&&(Io(0,"span",41),Ao(1,"img",42),ql(2,"safe"),Mo()),2&e){const e=jo(2);Zr(1),ta("border-color",e.dialogColor),To("src",$l(2,3,e.dialogFaceIcon.url,"resourceUrl"),Xi)}}function LP(e,t){if(1&e&&(Io(0,"span",41),Ao(1,"img",42),ql(2,"safe"),Mo()),2&e){const e=jo(2);Zr(1),ta("border-color",e.dialogColor),To("src",$l(2,3,e.dialogFaceIcon.url,"resourceUrl"),Xi)}}const BP=function(e,t){return{emote:e,"is-whisper":t}};function jP(e,t){if(1&e&&(Io(0,"div",36),Io(1,"div",37),Io(2,"p",38),Eo(3,zP,3,6,"span",39),ga(4),Mo(),Io(5,"p",40),Eo(6,LP,3,6,"span",39),ga(7),Mo(),Mo(),Mo()),2&e){const e=jo();ta("color",!e.isEmote&&e.isWhisper?"#ccc":e.dialogColor),To("@fadeAndScaleInOut",e.isEmote),Zr(2),ta("min-width",e.dialogChatBubbleMinWidth,"px")("border-color",e.dialogColor),To("ngClass",Hl(17,BP,e.isEmote,e.isWhisper)),Zr(1),To("ngIf",!e.isEmote&&e.isUseFaceIcon&&0<(null==e.dialogFaceIcon?null:e.dialogFaceIcon.url.length)),Zr(1),ma(e.dialogText),Zr(1),ta("min-width",e.dialogChatBubbleMinWidth,"px")("border-color",e.dialogColor),To("ngClass",Hl(20,BP,e.isEmote,e.isWhisper)),Zr(1),To("ngIf",!e.isEmote&&e.isUseFaceIcon&&0<(null==e.dialogFaceIcon?null:e.dialogFaceIcon.url.length)),Zr(1),ma(e.dialogText)}}const UP=function(e){return{transform:e}};function HP(e,t){if(1&e&&(Io(0,"div",43),Io(1,"div",37),Io(2,"span",44),Io(3,"i"),ga(4),Mo(),Mo(),Io(5,"span",45),Io(6,"i"),ga(7),Mo(),Mo(),Mo(),Io(8,"div",37),Io(9,"span",46),ga(10),Mo(),Io(11,"span",47),ga(12),Mo(),Mo(),Io(13,"div",37),Io(14,"span",44),Io(15,"i"),ga(16),Mo(),Mo(),Io(17,"span",45),Io(18,"i"),ga(19),Mo(),Mo(),Mo(),Mo()),2&e){const e=jo();ta("height",e.math.abs(e.altitude*e.gridSize)-(e.altitude>0?0:e.chatBubbleAltitude+4),"px"),To("ngStyle",Ul(13,UP,"translateX("+e.size*e.gridSize/2+"px) translateY("+-e.size*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),Zr(1),ta("visibility",e.altitude>0?"visible":"hidden"),Zr(3),ma(e.elevation),Zr(3),ma(e.elevation),Zr(3),ma(e.math.abs(e.altitude)),Zr(2),ma(e.math.abs(e.altitude)),Zr(1),ta("visibility",e.altitude<0?"visible":"hidden"),Zr(3),ma(e.elevation),Zr(3),ma(e.elevation)}}const VP=function(e){return{"not-inventory":e}},GP=function(e,t){return{"transform-origin":e,transform:t}},ZP=function(e,t,n,i,r,s,o,a){return{black:e,blue:t,green:n,cyan:i,red:r,magenta:s,yellow:o,white:a}},WP=function(e){return{fall:e}},YP=function(e){return{inverse:e}},qP=function(e,t,n){return{bottom:e,transform:t,visibility:n}};let $P=(()=>{class e{constructor(e,t,n,i,r,s){this.contextMenuService=e,this.panelService=t,this.changeDetector=n,this.pointerDeviceService=i,this.ngZone=r,this.modalService=s,this.gameCharacter=null,this.is3D=!1,this.gridSize=50,this.math=Math,this.stringUtil=rv,this.viewRotateX=50,this.viewRotateZ=10,this.heightWidthRatio=1.5,this._dialog=null,this.dialogTimeOutId=null,this.chatIntervalId=null,this.movableOption={},this.rotableOption={}}get name(){return this.gameCharacter.name}get size(){return this.adjustMinBounds(this.gameCharacter.size)}get altitude(){return this.gameCharacter.altitude}set altitude(e){this.gameCharacter.altitude=e}get imageFile(){return this.gameCharacter.imageFile}get rotate(){return this.gameCharacter.rotate}set rotate(e){this.gameCharacter.rotate=e}get roll(){return this.gameCharacter.roll}set roll(e){this.gameCharacter.roll=e}get isDropShadow(){return this.gameCharacter.isDropShadow}set isDropShadow(e){this.gameCharacter.isDropShadow=e}get isAltitudeIndicate(){return this.gameCharacter.isAltitudeIndicate}set isAltitudeIndicate(e){this.gameCharacter.isAltitudeIndicate=e}get isInverse(){return this.gameCharacter.isInverse}set isInverse(e){this.gameCharacter.isInverse=e}get isHollow(){return this.gameCharacter.isHollow}set isHollow(e){this.gameCharacter.isHollow=e}get isBlackPaint(){return this.gameCharacter.isBlackPaint}set isBlackPaint(e){this.gameCharacter.isBlackPaint=e}get aura(){return this.gameCharacter.aura}set aura(e){this.gameCharacter.aura=e}get isNotRide(){return this.gameCharacter.isNotRide}set isNotRide(e){this.gameCharacter.isNotRide=e}get isUseIconToOverviewImage(){return this.gameCharacter.isUseIconToOverviewImage}set isUseIconToOverviewImage(e){this.gameCharacter.isUseIconToOverviewImage=e}get faceIcon(){return this.gameCharacter.faceIcon}get dialogFaceIcon(){return this.dialog&&this.dialog.faceIconIdentifier?ov.instance.get(this.dialog.faceIconIdentifier):null}get shadowImageFile(){return this.gameCharacter.shadowImageFile}get elevation(){return+((this.gameCharacter.posZ+this.altitude*this.gridSize)/this.gridSize).toFixed(1)}set dialog(e){if(!this.gameCharacter)return;clearTimeout(this.dialogTimeOutId),clearInterval(this.chatIntervalId);let t=rv.cr(e.text);const n=rv.isEmote(t);n||(t=t.replace(/[\u3002\u3001]{3}/g,"\u2026").replace(/[\u3002\u3001]{2}/g,"\u2025").replace(/(\u3002|[\r\n]{2,})/g,"$1                            ").trimEnd());let i=1e3/t.length>36?1e3/t.length:36;i>200&&(i=200),n||(this.gameCharacter.text=t.slice(0,1)),this.dialogTimeOutId=setTimeout(()=>{this._dialog=null,this.gameCharacter.text="",this.gameCharacter.isEmote=!1,this.changeDetector.markForCheck()},t.length*i+6e3),this._dialog=e,this.gameCharacter.isEmote=n;let r=1;n?(this.gameCharacter.text=t,this.changeDetector.markForCheck()):this.chatIntervalId=setInterval(()=>{r++,this.gameCharacter.text=t.slice(0,r),this.changeDetector.markForCheck(),r>=t.length&&clearInterval(this.chatIntervalId)},i)}get dialogText(){if(!this.gameCharacter||!this.gameCharacter.text)return"";const e=this.gameCharacter.text.replace(/\u3002/g,"\u3002\n\n").split(/[\r\n]{2,}/g).filter(e=>e.trim());return e.length>0?e.reverse()[0].trim():""}get dialogChatBubbleMinWidth(){const e=(this.gameCharacter.size+1.8)*this.gridSize,t=11*this.dialogText.length+52+(this.isUseFaceIcon&&this.dialogFaceIcon&&this.dialogFaceIcon.url?32:0);return e<t?e:t}get dialog(){return this._dialog}get chatBubbleXDeg(){let e=90-this.viewRotateX;return e<0&&(e=360+e),e%=360,e>180&&(e=-(180-(e-180))),e>90&&(e=90),e<-90&&(e=-90),e/1.5}get characterImageHeight(){if(!this.characterImage)return 0;let e=this.characterImage.nativeElement.naturalHeight/this.characterImage.nativeElement.naturalWidth;return e>this.heightWidthRatio&&(e=this.heightWidthRatio),e*this.gridSize*this.size}get chatBubbleAltitude(){let e=Math.cos(this.roll*Math.PI/180),t=Math.abs(Math.sin(this.roll*Math.PI/180));e<.5&&(e=.5),t<.5&&(t=.5);const n=(this.characterImageHeight+(this.name?36:0))*e+4,i=this.gridSize*this.size/2*t+4+this.gridSize*this.size/2;return n>i?n:i}get nameplateOffset(){return this.characterImage?this.gridSize*this.size*this.heightWidthRatio-this.characterImageHeight:this.gridSize*this.size*this.heightWidthRatio}get nameTagRotate(){let e=this.viewRotateX%360-90,t=(this.viewRotateZ+this.rotate)%360,n=this.roll%360;return t=t>0?t:360+t,n=n>0?n:360+n,(e>0?e:360+e)*(90<t&&t<270?1:-1)*(90<=n&&n<=270?-1:1)}get isListen(){return this.dialog&&this.dialog.text&&!this.dialog.dialogTest&&this.dialog.text.trim().length>0}get isWhisper(){return this.dialog&&this.dialog.secret}get isEmote(){return this.gameCharacter.isEmote}get isUseFaceIcon(){return this.dialog&&this.dialog.faceIconIdentifier}get dialogColor(){return this.dialog&&this.dialog.color?this.dialog.color:av.CHAT_DEFAULT_COLOR}ngOnInit(){Uy.register(this).on("UPDATE_GAME_OBJECT",-1e3,e=>{let t=Vy.instance.get(e.data.identifier);this.gameCharacter&&t&&(this.gameCharacter===t||t instanceof ev&&this.gameCharacter.contains(t))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",-1e3,e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateX=e.data.x,this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on("POPUP_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&this.ngZone.run(()=>{this.dialog=e.data,this.changeDetector.markForCheck()})}).on("FAREWELL_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&(this.ngZone.run(()=>{this._dialog=null,this.gameCharacter.text="",this.gameCharacter.isEmote=!1,this.changeDetector.markForCheck()}),clearTimeout(this.dialogTimeOutId),clearInterval(this.chatIntervalId))}),this.movableOption={tabletopObject:this.gameCharacter,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain","text-note","character"]},this.rotableOption={tabletopObject:this.gameCharacter}}ngAfterViewInit(){}ngOnDestroy(){clearTimeout(this.dialogTimeOutId),clearInterval(this.chatIntervalId),this.gameCharacter&&(this.gameCharacter.text="",this.gameCharacter.isEmote=!1),Uy.unregister(this)}onDragstart(e){console.log("Dragstart Cancel !!!!"),e.stopPropagation(),e.preventDefault()}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[this.gameCharacter.imageFiles.length<=1?null:{name:"\u753b\u50cf\u5207\u308a\u66ff\u3048",action:null,subActions:this.gameCharacter.imageFiles.map((e,t)=>({name:this.gameCharacter.currntImageIndex==t?"\u25c9":"\u25cb",action:()=>{this.changeImage(t)},default:this.gameCharacter.currntImageIndex==t,icon:e}))},this.gameCharacter.imageFiles.length<=1?null:B_,this.isUseIconToOverviewImage?{name:"\u2611 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{this.isUseIconToOverviewImage=!1,Uy.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{this.isUseIconToOverviewImage=!0,Uy.trigger("UPDATE_INVENTORY",null)}},this.gameCharacter.isShowChatBubble?{name:"\u2611 \ud83d\udcad\u306e\u8868\u793a",action:()=>{this.gameCharacter.isShowChatBubble=!1}}:{name:"\u2610 \ud83d\udcad\u306e\u8868\u793a",action:()=>{this.gameCharacter.isShowChatBubble=!0}},this.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!1,Uy.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!0,Uy.trigger("UPDATE_INVENTORY",null)}},{name:"\u753b\u50cf\u52b9\u679c",action:null,subActions:[this.isInverse?{name:"\u2611 \u53cd\u8ee2",action:()=>{this.isInverse=!1,Uy.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u53cd\u8ee2",action:()=>{this.isInverse=!0,Uy.trigger("UPDATE_INVENTORY",null)}},this.isHollow?{name:"\u2611 \u307c\u304b\u3057",action:()=>{this.isHollow=!1,Uy.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u307c\u304b\u3057",action:()=>{this.isHollow=!0,Uy.trigger("UPDATE_INVENTORY",null)}},this.isBlackPaint?{name:"\u2611 \u9ed2\u5857\u308a",action:()=>{this.isBlackPaint=!1,Uy.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ed2\u5857\u308a",action:()=>{this.isBlackPaint=!0,Uy.trigger("UPDATE_INVENTORY",null)}},{name:"\u30aa\u30fc\u30e9",action:null,subActions:[{name:(-1==this.aura?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{this.aura=-1,Uy.trigger("UPDATE_INVENTORY",null)}},B_].concat(["\u30d6\u30e9\u30c3\u30af","\u30d6\u30eb\u30fc","\u30b0\u30ea\u30fc\u30f3","\u30b7\u30a2\u30f3","\u30ec\u30c3\u30c9","\u30de\u30bc\u30f3\u30bf","\u30a4\u30a8\u30ed\u30fc","\u30db\u30ef\u30a4\u30c8"].map((e,t)=>({name:`${this.aura==t?"\u25c9":"\u25cb"} ${e}`,action:()=>{this.aura=t,Uy.trigger("UPDATE_INVENTORY",null)}})))},B_,{name:"\u30ea\u30bb\u30c3\u30c8",action:()=>{this.isInverse=!1,this.isHollow=!1,this.isBlackPaint=!1,this.aura=-1,Uy.trigger("UPDATE_INVENTORY",null)},disabled:!this.isInverse&&!this.isHollow&&!this.isBlackPaint&&-1==this.aura}]},B_,this.isNotRide?{name:"\u2610 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{this.isNotRide=!1,Uy.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2611 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{this.isNotRide=!0,Uy.trigger("UPDATE_INVENTORY",null)}},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1,Uy.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0,Uy.trigger("UPDATE_INVENTORY",null)}},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,q_.play(Y_.sweep))},altitudeHande:this.gameCharacter},B_,{name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.gameCharacter)}},{name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a",action:()=>{this.showChatPalette(this.gameCharacter)}},{name:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a",action:()=>{this.showStandSetting(this.gameCharacter)}},B_,{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.gameCharacter.getUrls().map(e=>{const t=e.value.toString();return{name:e.name?e.name:t,action:()=>{this.modalService.open(Iv,{url:t,title:this.gameCharacter.name,subTitle:e.name})},disabled:!rv.validUrl(t),error:rv.validUrl(t)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",materialIcon:"open_in_new"}}),disabled:this.gameCharacter.getUrls().length<=0},B_,this.gameCharacter.isInventoryIndicate?{name:"\u2611 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{this.gameCharacter.isInventoryIndicate=!1,Uy.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{this.gameCharacter.isInventoryIndicate=!0,Uy.trigger("UPDATE_INVENTORY",null)}},{name:"\u30c6\u30fc\u30d6\u30eb\u304b\u3089\u79fb\u52d5",action:null,subActions:[{name:"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea",action:()=>{Uy.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation("common"),q_.play(Y_.piecePut)}},{name:"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea",action:()=>{Uy.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation(Hy.peerId),q_.play(Y_.piecePut)}},{name:"\u5893\u5834",action:()=>{Uy.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation("graveyard"),q_.play(Y_.sweep)}}]},B_,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let e=this.gameCharacter.clone();e.location.x+=this.gridSize,e.location.y+=this.gridSize,e.update(),q_.play(Y_.piecePut)}}],this.name)}onMove(){q_.play(Y_.piecePick)}onMoved(){this.gameCharacter&&this.gameCharacter.text&&Uy.call("FAREWELL_CHAT_BALLOON",{characterIdentifier:this.gameCharacter.identifier}),q_.play(Y_.piecePut)}onImageLoad(){Uy.trigger("UPDATE_GAME_OBJECT",this.gameCharacter)}adjustMinBounds(e,t=0){return e<t?t:e}showDetail(e){let t=this.pointerDeviceService.pointers[0],n="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(n+=" - "+e.name),this.panelService.open(wx,{title:n,left:t.x-400,top:t.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let t=this.pointerDeviceService.pointers[0];this.panelService.open(Tw,{left:t.x-250,top:t.y-175,width:620,height:350}).character=e}showStandSetting(e){let t=this.pointerDeviceService.pointers[0];this.panelService.open(Jw,{left:t.x-400,top:t.y-175,width:730,height:572}).character=e}changeImage(e){this.gameCharacter.currntImageIndex!=e&&(this.gameCharacter.currntImageIndex=e,q_.play(Y_.surprise),Uy.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),Uy.trigger("UPDATE_INVENTORY",null))}nextImage(){this.gameCharacter.imageFiles.length<=1||this.changeImage(this.gameCharacter.currntImageIndex+1>=this.gameCharacter.imageFiles.length?0:this.gameCharacter.currntImageIndex+1)}}return e.\u0275fac=function(t){return new(t||e)(So(j_),So(wv),So(fl),So(Kw),So(Rc),So(xv))},e.\u0275cmp=Ze({type:e,selectors:[["game-character"]],viewQuery:function(e,t){if(1&e&&(cc(IP,1),cc(MP,1)),2&e){let e;lc(e=hc())&&(t.characterImage=e.first),lc(e=hc())&&(t.chatBubble=e.first)}},hostBindings:function(e,t){1&e&&zo("dragstart",function(e){return t.onDragstart(e)})("contextmenu",function(e){return t.onContextMenu(e)})},inputs:{gameCharacter:"gameCharacter",is3D:"is3D"},decls:36,vars:78,consts:[["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.option","movable.ondragstart","movable.ondragend"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[1,"pedestal-inner",3,"ngClass"],[1,"pedestal-outer"],[1,"pedestal-grab","rotate-grab"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"is-pointer-events-none"],[1,"image-box","is-3d",2,"pointer-events","none",3,"ngStyle"],[1,"aura","is-3d",2,"pointer-events","none",3,"ngClass"],[2,"pointer-events","none","transition","transform 132ms 0s ease",3,"ngStyle"],["class","image drop-shadow is-3d","style","pointer-events: none;","style","filter: brightness(0) blur(1px);",3,"height","src","ngStyle",4,"ngIf"],[1,"upright-transform","is-fit-width","is-3d",3,"ngClass","ngStyle","dblclick"],["appRotable","",1,"rotate-frame","is-3d",3,"rotable.value","rotable.valueChange","rotable.ondragstart","rotable.ondragend"],[1,"rotate-inner","is-3d"],["class","name-tag is-nowrap is-black-background is-3d",3,"ngStyle",4,"ngIf"],[1,"inverser","is-3d",3,"ngClass"],[1,"aura","is-3d",3,"ngClass"],[1,"image-box","is-3d"],["class","image",3,"ngClass","src","height","load",4,"ngIf"],[1,"grab-group"],[1,"rotate-grab","rotate-grab-icon","of-top",3,"ngStyle"],[1,"material-icons"],[1,"rotate-grab","rotate-grab-icon","of-bottom",3,"ngStyle"],[1,"chat-bubble","is-3d",3,"ngStyle"],["chatBubble",""],["class","is-3d","style","transform-origin: center bottom;",3,"color",4,"ngIf"],["class","is-3d","style","display: flex; flex-flow: column nowrap; justify-content: space-between; border-left: 2px dashed black; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],[1,"image","drop-shadow","is-3d",2,"filter","brightness(0) blur(1px)",3,"src","ngStyle"],[1,"name-tag","is-nowrap","is-black-background","is-3d",3,"ngStyle"],[1,"fornt-tag","has-length-limit","is-3d"],[1,"back-tag","has-length-limit","is-3d"],[1,"image",3,"ngClass","src","load"],["characterImage",""],[1,"is-3d",2,"transform-origin","center bottom"],[1,"is-3d"],[1,"is-3d","chat-bubble-buyo",2,"position","absolute","backface-visibility","hidden",3,"ngClass"],["class","face-icon-box",4,"ngIf"],[1,"is-3d","chat-bubble-buyo","back",2,"backface-visibility","hidden","transform","rotateY(-180deg)",3,"ngClass"],[1,"face-icon-box"],[1,"face-icon",3,"src"],[1,"is-3d",2,"display","flex","flex-flow","column nowrap","justify-content","space-between","border-left","2px dashed black","transform-origin","top left",3,"ngStyle"],[1,"elevation-indicator","is-3d",2,"position","absolute"],[1,"elevation-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"]],template:function(e,t){1&e&&(Io(0,"div",0),zo("movable.ondragstart",function(){return t.onMove()})("movable.ondragend",function(){return t.onMoved()}),Io(1,"div",1),Io(2,"div",2),zo("rotable.ondragstart",function(){return t.onMove()})("rotable.ondragend",function(){return t.onMoved()}),Ao(3,"div",3),Ao(4,"div",4),Io(5,"div",5),Io(6,"div",6),Io(7,"div",7),ga(8,"autorenew"),Mo(),Io(9,"div",8),ga(10,"autorenew"),Mo(),Mo(),Mo(),Io(11,"div",9),Io(12,"div",10),Io(13,"div",11),Io(14,"div",12),Eo(15,PP,2,10,"img",13),Mo(),Mo(),Mo(),Mo(),Io(16,"div",14),zo("dblclick",function(){return t.nextImage()}),Io(17,"div",15),zo("rotable.valueChange",function(e){return t.roll=e})("rotable.ondragstart",function(){return t.onMove()})("rotable.ondragend",function(){return t.onMoved()}),Io(18,"div",16),Eo(19,RP,5,5,"div",17),Io(20,"div",9),Io(21,"div",18),Io(22,"span",19),Io(23,"span",20),Eo(24,NP,3,10,"img",21),Mo(),Mo(),Mo(),Mo(),Io(25,"div",22),Io(26,"div",23),Io(27,"i",24),ga(28,"autorenew"),Mo(),Mo(),Io(29,"div",25),Io(30,"i",24),ga(31,"autorenew"),Mo(),Mo(),Mo(),Mo(),Mo(),Io(32,"div",26,27),Eo(34,jP,8,23,"div",28),Mo(),Mo(),Mo(),Eo(35,HP,20,15,"div",29),Mo(),Mo()),2&e&&(ta("width",t.size*t.gridSize,"px")("height",t.size*t.gridSize,"px"),To("movable.option",t.movableOption),Zr(1),To("@bounceInOut","in"),Zr(1),To("rotable.option",t.rotableOption),Zr(1),To("@switchImagePedestal",t.gameCharacter.currntImageIndex)("ngClass",Ul(39,VP,!t.gameCharacter.isInventoryIndicate)),Zr(1),To("@switchImagePedestal",t.gameCharacter.currntImageIndex),Zr(8),ta("width",t.size*t.gridSize,"px")("height",t.size*t.gridSize*t.heightWidthRatio,"px"),To("ngStyle",Hl(41,GP,"50% "+t.size*t.gridSize+"px","translateY(-10%) scale(1.0,"+1/t.heightWidthRatio+") translateY(-"+99/t.heightWidthRatio+"%) rotateZ("+t.roll+"deg)")),Zr(1),To("ngClass",Zl(44,ZP,0==t.aura,1==t.aura,2==t.aura,3==t.aura,4==t.aura,5==t.aura,6==t.aura,7==t.aura)),Zr(1),To("ngStyle",Ul(53,DP,"scaleX("+(t.isInverse?"-1":"1")+")")),Zr(1),To("ngIf",t.isDropShadow&&(0<t.imageFile.url.length||0<t.shadowImageFile.url.length)),Zr(1),To("ngClass",Ul(55,WP,0==t.altitude))("ngStyle",Ul(57,DP,"rotateY(90deg) rotateZ(-90deg) rotateY(-90deg) translateY(-50%) translateY("+-t.altitude*t.gridSize+"px)")),Zr(1),ta("width",t.size*t.gridSize,"px")("height",t.size*t.gridSize,"px"),To("rotable.value",t.roll),Zr(2),To("ngIf",0<t.name.length),Zr(1),To("@switchImage",t.gameCharacter.currntImageIndex),Zr(1),To("ngClass",Ul(59,YP,t.isInverse)),Zr(1),To("ngClass",Zl(61,ZP,0==t.aura,1==t.aura,2==t.aura,3==t.aura,4==t.aura,5==t.aura,6==t.aura,7==t.aura)),Zr(1),ta("width",t.size*t.gridSize,"px")("height",t.size*t.gridSize*t.heightWidthRatio,"px"),Zr(1),To("ngIf",0<t.imageFile.url.length),Zr(2),To("ngStyle",Ul(70,DP,"translateX(-50%) translateX("+t.size*t.gridSize/2+"px) translateY("+(t.nameplateOffset-10)+"px)")),Zr(3),To("ngStyle",Ul(72,DP,"translateX(-50%) translateX("+t.size*t.gridSize/2+"px")),Zr(3),To("ngStyle",Vl(74,qP,t.chatBubbleAltitude-(t.isEmote?t.gridSize/2:0)-4+"px","translateX(-50%) translateX("+t.size*t.gridSize/2+"px) rotateY("+(t.rotate+t.viewRotateZ)+"deg) rotateX("+t.chatBubbleXDeg+"deg)",t.gameCharacter.isShowChatBubble?"visible":"hidden")),Zr(2),To("ngIf",t.isListen),Zr(1),To("ngIf",t.isAltitudeIndicate&&(t.altitude<=-.5||.5<=t.altitude)))},directives:[WI,YI,Uh,Qh,Zh],pipes:[$_],styles:['@supports (-moz-user-select:-moz-none){.chat-bubble[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:after{bottom:-28px!important}}.is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.upright-transform.fall[_ngcontent-%COMP%]{transition:transform 132ms cubic-bezier(.21,.97,.75,1.25)}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;border-color:#999 #ccc #ccc #999;border-style:solid;border-width:28px 12px;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%], .pedestal-inner[_ngcontent-%COMP%]{width:100%;height:100%;box-sizing:border-box}.pedestal-inner[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;border:6px solid #ffcc80;border-radius:25px}.pedestal-inner.not-inventory[_ngcontent-%COMP%]{border-color:#80ccee}.pedestal-outer[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:2px solid #212121;border-radius:25px}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute}.fill-frame[_ngcontent-%COMP%], .image[_ngcontent-%COMP%]{bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{margin:auto;width:100%;height:auto;vertical-align:bottom}.image-box[_ngcontent-%COMP%]{display:inline-block;text-align:center}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{-o-object-fit:contain;object-fit:contain;-o-object-position:50% 100%;object-position:50% 100%;margin-bottom:0;margin-top:auto}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms ease 0s}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #fff)}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:13px;padding:2px 8px;border-radius:12px;position:absolute;top:-26px}.rotate-frame[_ngcontent-%COMP%], .rotate-inner[_ngcontent-%COMP%]{bottom:0;left:0;right:0;overflow:visible}.rotate-inner[_ngcontent-%COMP%]{position:absolute;width:100%;height:auto}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:rgba(30,30,30,.8)}.back-tag[_ngcontent-%COMP%], .fornt-tag[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.back-tag[_ngcontent-%COMP%]{position:absolute;top:3px;transform:rotateY(-180deg)}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:24em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{bottom:0}.of-back[_ngcontent-%COMP%], .of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{top:0}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%]{display:inline}.altitude-indicator[_ngcontent-%COMP%]{font-size:10px}.altitude-indicator[_ngcontent-%COMP%], .elevation-indicator[_ngcontent-%COMP%]{padding-left:2px;color:#000;text-shadow:#f5f5f5 0 0 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.elevation-indicator[_ngcontent-%COMP%]{font-weight:bolder;font-size:12px}.chat-bubble[_ngcontent-%COMP%]{position:absolute;pointer-events:none;transform-origin:center calc(100% + 12px)}.chat-bubble[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{box-sizing:border-box;display:inline-block;max-width:100%;min-width:130px;font-size:11px;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:1px solid;border-radius:24px;margin:0;padding:6px 12px;white-space:pre-wrap;word-break:break-all;text-align:center}.chat-bubble[_ngcontent-%COMP%]   p.emote[_ngcontent-%COMP%]{text-align:center;font-size:38px;font-weight:700;border:none;background:none;min-width:300px;-webkit-text-stroke:1px #f0dabd;letter-spacing:-8px;white-space:nowrap}.chat-bubble[_ngcontent-%COMP%]   p.is-whisper[_ngcontent-%COMP%]{border-radius:24px 12px;font-size:11px;background:rgba(85,85,85,.8);box-shadow:0 0 2px 0 #ccc}.chat-bubble[_ngcontent-%COMP%]   p.is-whisper.emote[_ngcontent-%COMP%]{font-size:38px;font-weight:700;border:none;background:none;min-width:200px;-webkit-text-stroke:2px #555;box-shadow:none}.chat-bubble[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:after{box-sizing:border-box;content:"";position:absolute;padding:0;line-height:1;vertical-align:baseline;left:50%;margin:0 0 0 -8px;bottom:-17px;border:8px solid transparent;border-top-color:inherit}.chat-bubble[_ngcontent-%COMP%]   p.emote[_ngcontent-%COMP%]:after{border:0 transparent}.chat-bubble[_ngcontent-%COMP%]   p.is-whisper.emote[_ngcontent-%COMP%]:after{content:none}.chat-bubble-buyo[_ngcontent-%COMP%]{transform-origin:center calc(100% + 8px);transition:all .2s ease;-webkit-animation:chat-bubble-buyo 1.2s ease-in-out .1s infinite alternate;animation:chat-bubble-buyo 1.2s ease-in-out .1s infinite alternate;transform:scale3d(.9,.9,.9)}.chat-bubble-buyo.back[_ngcontent-%COMP%]{transform-origin:center calc(100% + 8px);transition:all .2s ease;-webkit-animation:chat-bubble-buyo-back 1.2s ease-in-out .1s infinite alternate;animation:chat-bubble-buyo-back 1.2s ease-in-out .1s infinite alternate;transform:rotateY(-180deg) scale3d(.9,.9,.9)}.chat-bubble-buyo.emote[_ngcontent-%COMP%]{-webkit-animation-duration:.6s;animation-duration:.6s}@-webkit-keyframes chat-bubble-buyo{0%{transform:scale3d(.9,.9,.9)}to{transform:scaleX(1)}}@keyframes chat-bubble-buyo{0%{transform:scale3d(.9,.9,.9)}to{transform:scaleX(1)}}@-webkit-keyframes chat-bubble-buyo-back{0%{transform:rotateY(-180deg) scale3d(.9,.9,.9)}to{transform:rotateY(-180deg) scaleX(1)}}@keyframes chat-bubble-buyo-back{0%{transform:rotateY(-180deg) scale3d(.9,.9,.9)}to{transform:rotateY(-180deg) scaleX(1)}}.drop-shadow[_ngcontent-%COMP%]{pointer-events:none}.face-icon-box[_ngcontent-%COMP%]{display:inline-block;position:relative;border:0;width:36px;height:36px;max-width:36px;max-height:36px;overflow:hidden;left:-20px;top:-18px;margin-right:-16px;margin-bottom:-22px}.face-icon-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0;object-position:50% 0;border-radius:.4em}'],data:{animation:[Jd("switchImage",[sp(":increment, :decrement",[ep("400ms ease",rp([np({transform:"scale3d(0.8, 0.8, 0.8) rotateY(0deg)"}),np({transform:"scale3d(1.2, 1.2, 1.2) rotateY(180deg)"}),np({transform:"scale3d(1.0, 1.0, 1.0) rotateY(360deg)"})]))])]),Jd("switchImageShadow",[sp(":increment, :decrement",[ep("400ms ease",rp([np({transform:"scale3d(0.8, 0.8, 0.8)"}),np({transform:"scale3d(0, 1.2, 1.2)"}),np({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),Jd("switchImagePedestal",[sp(":increment, :decrement",[ep("400ms ease",rp([np({transform:"scale3d(0, 0, 0)"}),np({transform:"scale3d(1.2, 1.2, 1.2)"}),np({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),Jd("bounceInOut",[sp("void => *",[ep("600ms ease",rp([np({transform:"scale3d(0, 0, 0)",offset:0}),np({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),np({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),np({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),np({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),sp("* => void",[ep(100,np({transform:"scale3d(0, 0, 0)"}))])]),Jd("fadeAndScaleInOut",[sp("void => *, true => false",[ep("200ms ease-in-out",rp([np({transform:"scale3d(0, 0, 0)",opacity:0}),np({transform:"scale3d(1.0, 1.0, 1.0)",opacity:.8})]))]),sp("* => void, true => false",[ep("100ms ease-in-out",np({transform:"scale3d(0, 0, 0)",opacity:0}))])])]},changeDetection:0}),e})();const XP=["cursor"],KP=["opacity"],QP=function(e){return{transform:e}};function JP(e,t){if(1&e&&(Io(0,"div",1,2),Io(2,"div",3),Io(3,"div",4,5),Io(5,"div",6),ql(6,"safe"),Io(7,"div",7),Io(8,"div",8),Io(9,"span",9),Io(10,"b"),ga(11),Mo(),Mo(),Mo(),Io(12,"div",10),Io(13,"span",9),Io(14,"b"),ga(15),Mo(),Mo(),Mo(),Mo(),Mo(),Mo(),Mo(),Mo()),2&e){const e=jo();Zr(2),To("ngStyle",Ul(15,QP,"rotateZ("+-e.rotateZ+"deg)")),Zr(1),ta("background-color",e.color+"dd"),Zr(2),ta("background-image",$l(6,12,"url("+e.iconUrl+")","style")),Zr(2),To("ngStyle",Ul(17,QP,"translateX(-50%) rotateX("+e.nameTagRotate+"deg)")),Zr(1),ta("background-color",e.color+"dd"),Zr(3),ma(e.name),Zr(1),ta("background-color",e.color+"dd"),Zr(3),ma(e.name)}}let eD=(()=>{class e{constructor(e,t,n,i){this.changeDetector=e,this.batchService=t,this.coordinateService=n,this.ngZone=i,this.cursor=av.myCursor,this.cursorElement=null,this.opacityElement=null,this.fadeOutTimer=null,this.updateInterval=null,this.callcack=e=>this.onMouseMove(e),this._x=0,this._y=0}get iconUrl(){return this.cursor.image.url}get name(){return this.cursor.name}get isMine(){return this.cursor.isMine}get color(){return this.cursor.color&&"#ffffff"!=this.cursor.color?this.cursor.color:"#f0dabd"}get rotateZ(){return e.viewRotateZ}get nameTagRotate(){let t=e.viewRotateX%360-90;return-(t>0?t:360+t)}get delayMs(){let e=16.6*Hy.peerIds.length;return e<100?100:e}ngOnInit(){this.isMine||Uy.register(this).on("CURSOR_MOVE",e=>{e.sendFrom===this.cursor.peerId&&this.batchService.add(()=>{this.stopTransition(),this.setAnimatedTransition(),this.setPosition(e.data[0],e.data[1],e.data[2]),this.resetFadeOut(),this.changeDetector.markForCheck()},this)}).on("TABLE_VIEW_ROTATE",-1e3,t=>{e.viewRotateX=t.data.x,e.viewRotateZ=t.data.z,this.changeDetector.markForCheck()})}ngAfterViewInit(){this.isMine?this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousemove",this.callcack),document.body.addEventListener("touchmove",this.callcack)}):(this.cursorElement=this.cursorElementRef.nativeElement,this.opacityElement=this.opacityElementRef.nativeElement,this.setAnimatedTransition(),this.setPosition(0,0,0),this.resetFadeOut())}ngOnDestroy(){document.body.removeEventListener("mousemove",this.callcack),document.body.removeEventListener("touchmove",this.callcack),Uy.unregister(this),this.batchService.remove(this),this.fadeOutTimer&&this.fadeOutTimer.clear()}onMouseMove(e){let t=e.touches?e.changedTouches[0].pageX:e.pageX,n=e.touches?e.changedTouches[0].pageY:e.pageY;t===this._x&&n===this._y||(this._x=t,this._y=n,this._target=e.target,this.updateInterval||(this.updateInterval=setTimeout(()=>{this.updateInterval=null,this.calcLocalCoordinate(this._x,this._y,this._target)},this.delayMs)))}calcLocalCoordinate(e,t,n){if(!document.getElementById("app-table-layer").contains(n))return;let i={x:e,y:t,z:0};i=this.coordinateService.calcTabletopLocalCoordinate(i,n),Uy.call("CURSOR_MOVE",[i.x,i.y,i.z])}resetFadeOut(){this.opacityElement.style.opacity="1.0",null==this.fadeOutTimer&&(this.fadeOutTimer=new Gy(()=>{this.opacityElement.style.opacity="0.0"},3e3)),this.fadeOutTimer.reset()}stopTransition(){this.cursorElement.style.transform=window.getComputedStyle(this.cursorElement).transform}setAnimatedTransition(){this.cursorElement.style.transition=`transform ${this.delayMs+33}ms linear, opacity 0.5s ease-out`}setPosition(e,t,n){this.cursorElement.style.transform="translateX("+e+"px) translateY("+t+"px) translateZ("+n+"px)"}}return e.viewRotateX=50,e.viewRotateZ=10,e.ctor=void Uy.register(e).on("TABLE_VIEW_ROTATE",-1e3,t=>{e.viewRotateX=t.data.x,e.viewRotateZ=t.data.z}),e.\u0275fac=function(t){return new(t||e)(So(fl),So(Sk),So(cS),So(Rc))},e.\u0275cmp=Ze({type:e,selectors:[["peer-cursor"],["","peer-cursor",""]],viewQuery:function(e,t){if(1&e&&(cc(XP,1),cc(KP,1)),2&e){let e;lc(e=hc())&&(t.cursorElementRef=e.first),lc(e=hc())&&(t.opacityElementRef=e.first)}},inputs:{cursor:"cursor"},decls:1,vars:1,consts:[["class","component is-3d is-transition is-pointer-events-none",4,"ngIf"],[1,"component","is-3d","is-transition","is-pointer-events-none"],["cursor",""],[1,"is-3d","is-transition",3,"ngStyle"],[1,"peer-cursor","is-3d","is-transition"],["opacity",""],[1,"icon","is-3d"],[1,"is-center","is-3d",3,"ngStyle"],[1,"name","is-3d",2,"backface-visibility","hidden"],[2,"white-space","nowrap","color","whitesmoke"],[1,"name","is-3d",2,"position","absolute","backface-visibility","hidden","transform","rotateY(-180deg)"]],template:function(e,t){1&e&&Eo(0,JP,16,19,"div",0),2&e&&To("ngIf",!t.isMine)},directives:[Zh,Qh],pipes:[$_],styles:[".component[_ngcontent-%COMP%]{position:absolute;overflow:visible;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.is-transition[_ngcontent-%COMP%]{transition:transform 133ms linear,opacity .5s ease-out}.peer-cursor[_ngcontent-%COMP%]{height:45px;width:45px;position:absolute;left:0;top:0;box-sizing:border-box;border:1px solid #f0dabd;border-radius:50% 50% 5% 50%;background-color:rgba(240,218,189,.9);opacity:.6;transform-origin:100% 100%;transform:translateX(-100%) translateY(-100%) rotateX(-90deg) rotate(45deg)}.icon[_ngcontent-%COMP%]{overflow:visible;height:100%;width:100%;border-radius:100%;background-position:top,50%;background-repeat:no-repeat;background-size:cover;background-color:#f0dabd;transform:rotate(-45deg) scale(.85)}.name[_ngcontent-%COMP%]{box-sizing:border-box;font-size:7px;padding:2px 5px;border-radius:14px;color:#ccc;background-color:rgba(30,30,30,.8);transform-origin:center}.is-center[_ngcontent-%COMP%]{position:absolute;left:50%;top:-26px;transform:translateX(-50%)}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}"]}),e})();const tD=["root"],nD=["gameTable"],iD=["gameObjects"],rD=["gridCanvas"];function sD(e,t){1&e&&Ao(0,"terrain",17),2&e&&To("terrain",t.$implicit)}function oD(e,t){1&e&&Ao(0,"game-table-mask",18),2&e&&To("gameTableMask",t.$implicit)}const aD=function(e){return{"z-index":e}};function lD(e,t){if(1&e&&Ao(0,"text-note",19),2&e){const e=t.$implicit;To("textNote",e)("appTooltip",e)("ngStyle",Ul(3,aD,e.zindex))}}const cD=function(e,t){return{"z-index":e,transform:t}};function hD(e,t){if(1&e&&Ao(0,"card-stack",20),2&e){const e=t.$implicit;To("cardStack",e)("appTooltip",e)("ngStyle",Hl(3,cD,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function uD(e,t){if(1&e&&Ao(0,"card",21),2&e){const e=t.$implicit;To("card",e)("appTooltip",e)("ngStyle",Hl(3,cD,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function dD(e,t){if(1&e&&Ao(0,"dice-symbol",22),2&e){const e=t.$implicit;To("diceSymbol",e)("appTooltip",e)}}function pD(e,t){if(1&e&&Ao(0,"game-character",23),2&e){const e=t.$implicit;To("gameCharacter",e)("appTooltip",e)}}function fD(e,t){1&e&&Ao(0,"peer-cursor",24),2&e&&To("cursor",t.$implicit)}const gD=function(e,t){return[e,t]},mD=function(e){return{"is-grabbing":e}},bD=function(e){return{transform:e}};let yD=(()=>{class e{constructor(e,t,n,i,r,s,o,a){this.ngZone=e,this.contextMenuService=t,this.pointerDeviceService=n,this.coordinateService=i,this.imageService=r,this.tabletopService=s,this.tabletopActionService=o,this.modalService=a,this.isTransformMode=!1,this.viewPotisonX=100,this.viewPotisonY=0,this.viewPotisonZ=0,this.viewRotateX=50,this.viewRotateY=0,this.viewRotateZ=10,this.mouseGesture=null,this.touchGesture=null}get tableSelecter(){return this.tabletopService.tableSelecter}get currentTable(){return this.tabletopService.currentTable}get gridHeight(){return this.tabletopService.currentTable.gridHeight}get tableImage(){return this.imageService.getSkeletonOr(this.currentTable.imageIdentifier)}get backgroundImage(){return this.imageService.getEmptyOr(this.currentTable.backgroundImageIdentifier)}get backgroundFilterType(){return this.currentTable.backgroundFilterType}get isPointerDragging(){return this.pointerDeviceService.isDragging}get characters(){return this.tabletopService.characters}get tableMasks(){return this.tabletopService.tableMasks}get cards(){return this.tabletopService.cards}get cardStacks(){return this.tabletopService.cardStacks}get terrains(){return this.tabletopService.terrains}get textNotes(){return this.tabletopService.textNotes}get diceSymbols(){return this.tabletopService.diceSymbols}get peerCursors(){return this.tabletopService.peerCursors}ngOnInit(){Uy.register(this).on("UPDATE_GAME_OBJECT",-1e3,e=>{this.gameTable.nativeElement.style.transition=null,e.data.identifier!==this.currentTable.identifier&&e.data.identifier!==this.tableSelecter.identifier||(console.log("UPDATE_GAME_OBJECT GameTableComponent "+this.currentTable.identifier),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor))}).on("DRAG_LOCKED_OBJECT",e=>{this.gameTable.nativeElement.style.transition=null,this.isTransformMode=!0,this.pointerDeviceService.isDragging=!1,this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}).on("RESET_POINT_OF_VIEW",e=>{this.isTransformMode=!1,this.pointerDeviceService.isDragging=!1,this.setTransform(this.viewPotisonX,this.viewPotisonY,this.viewPotisonZ,this._rightRotate(this.viewRotateX),this._rightRotate(this.viewRotateY,!0),this._rightRotate(this.viewRotateZ),!0),setTimeout(()=>{this.gridCanvas.nativeElement.style.opacity="0.0",this.gameTable.nativeElement.style.transition="0.1s ease-out",setTimeout(()=>{this.gameTable.nativeElement.style.transition=null},100),e&&"top"==e.data?this.setTransform(0,0,0,0,0,0,!0):this.setTransform(100,0,0,50,0,10,!0)},50),this.removeFocus()}),this.tabletopActionService.makeDefaultTable(),this.tabletopActionService.makeDefaultTabletopObjects()}_rightRotate(e,t=!1){let n=e%360;return t||(n>180?n-=360:n<-180&&(n+=360)),n}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.initializeTableTouchGesture(),this.initializeTableMouseGesture()}),this.cancelInput(),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor),this.setTransform(0,0,0,0,0,0),this.coordinateService.tabletopOriginElement=this.gameObjects.nativeElement}ngOnDestroy(){Uy.unregister(this),this.mouseGesture.destroy(),this.touchGesture.destroy()}initializeTableTouchGesture(){this.touchGesture=new VI(this.rootElementRef.nativeElement,this.ngZone),this.touchGesture.onstart=this.onTableTouchStart.bind(this),this.touchGesture.onend=this.onTableTouchEnd.bind(this),this.touchGesture.ongesture=this.onTableTouchGesture.bind(this),this.touchGesture.ontransform=this.onTableTouchTransform.bind(this)}initializeTableMouseGesture(){this.mouseGesture=new UI(this.rootElementRef.nativeElement),this.mouseGesture.onstart=this.onTableMouseStart.bind(this),this.mouseGesture.onend=this.onTableMouseEnd.bind(this),this.mouseGesture.ontransform=this.onTableMouseTransform.bind(this)}onTableTouchStart(){this.mouseGesture.cancel()}onTableTouchEnd(){this.cancelInput()}onTableTouchGesture(){this.cancelInput()}onTableTouchTransform(e,t,n,i,r,s,o,a){if(!this.isTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),a.cancelable&&a.preventDefault();let l=(1e3+Math.abs(this.viewPotisonZ))/1e3;80<i+this.viewRotateX&&(i+=80-(i+this.viewRotateX)),i+this.viewRotateX<0&&(i+=0-(i+this.viewRotateX)),750<n+this.viewPotisonZ&&(n+=750-(n+this.viewPotisonZ)),this.setTransform(e*=l,t*=l,n,i,r,s)}onTableMouseStart(e){e.target.contains(this.gameObjects.nativeElement)||1===e.button||2===e.button?this.isTransformMode=!0:(this.isTransformMode=!1,this.pointerDeviceService.isDragging=!0,this.gridCanvas.nativeElement.style.opacity="1"),document.activeElement.contains(e.target)||(this.removeSelectionRanges(),this.removeFocus())}onTableMouseEnd(e){this.cancelInput()}onTableMouseTransform(e,t,n,i,r,s,o,a){if(!this.isTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),a.cancelable&&a.preventDefault();let l=(1e3+Math.abs(this.viewPotisonZ))/1e3;this.setTransform(e*=l,t*=l,n,i,r,s)}cancelInput(){this.mouseGesture.cancel(),this.isTransformMode=!0,this.pointerDeviceService.isDragging=!1,this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}onContextMenu(e){if(!document.activeElement.contains(this.gameObjects.nativeElement))return;if(e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let t=this.pointerDeviceService.pointers[0],n=this.coordinateService.calcTabletopLocalCoordinate(),i=[];Array.prototype.push.apply(i,this.tabletopActionService.makeDefaultContextMenuActions(n)),i.push(B_),i.push({name:"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a",action:()=>{this.modalService.open(jO)}}),this.contextMenuService.open(t,i,this.currentTable.name)}setTransform(e,t,n,i,r,s,o=!1){o?(this.viewRotateX=i,this.viewRotateY=r,this.viewRotateZ=s,this.viewPotisonX=e,this.viewPotisonY=t,this.viewPotisonZ=n):(this.viewRotateX+=i,this.viewRotateY+=r,this.viewRotateZ+=s,this.viewPotisonX+=e,this.viewPotisonY+=t,this.viewPotisonZ+=n),(o||0!=i||0!=r||0!=i)&&this.ngZone.run(()=>{Uy.trigger("TABLE_VIEW_ROTATE",{x:this.viewRotateX,y:this.viewRotateY,z:this.viewRotateZ})}),this.gameTable.nativeElement.style.transform="translateZ("+this.viewPotisonZ+"px) translateY("+this.viewPotisonY+"px) translateX("+this.viewPotisonX+"px) rotateY("+this.viewRotateY+"deg) rotateX("+this.viewRotateX+"deg) rotateZ("+this.viewRotateZ+"deg) "}setGameTableGrid(e,t,n=50,i=pC.SQUARE,r="#000000e6"){this.gameTable.nativeElement.style.width=e*n+"px",this.gameTable.nativeElement.style.height=t*n+"px",new LI(this.gridCanvas.nativeElement).render(e,t,n,i,r),this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}removeSelectionRanges(){let e=window.getSelection();e.isCollapsed||e.removeAllRanges()}removeFocus(){document.activeElement instanceof HTMLElement&&document.activeElement.blur()}trackByGameObject(e,t){return t.identifier}}return e.\u0275fac=function(t){return new(t||e)(So(Rc),So(j_),So(Kw),So(cS),So(MO),So(hS),So(ZI),So(xv))},e.\u0275cmp=Ze({type:e,selectors:[["game-table"]],viewQuery:function(e,t){if(1&e&&(cc(tD,3),cc(nD,3),cc(iD,3),cc(rD,3)),2&e){let e;lc(e=hc())&&(t.rootElementRef=e.first),lc(e=hc())&&(t.gameTable=e.first),lc(e=hc())&&(t.gameObjects=e.first),lc(e=hc())&&(t.gridCanvas=e.first)}},hostBindings:function(e,t){1&e&&zo("contextmenu",function(e){return t.onContextMenu(e)})},decls:19,vars:36,consts:[[1,"background-image","is-pointer-events-none",3,"ngClass"],[1,"component","is-fill","is-perspective",3,"ngClass"],["root",""],[1,"component-content","is-fill","is-3d"],["gameTable",""],["id","app-game-table",1,"game-table","table-image","is-3d"],["gameObjects",""],[1,"grid-canvas","is-fill","is-pointer-events-none",3,"ngStyle"],["gridCanvas",""],["class","is-3d",3,"terrain",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"gameTableMask",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"textNote","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"cardStack","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"card","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"diceSymbol","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"gameCharacter","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"cursor",4,"ngFor","ngForOf","ngForTrackBy"],[1,"is-3d",3,"terrain"],[1,"is-3d",3,"gameTableMask"],[1,"is-3d",3,"textNote","appTooltip","ngStyle"],[1,"is-3d",3,"cardStack","appTooltip","ngStyle"],[1,"is-3d",3,"card","appTooltip","ngStyle"],[1,"is-3d",3,"diceSymbol","appTooltip"],[1,"is-3d",3,"gameCharacter","appTooltip"],[1,"is-3d",3,"cursor"]],template:function(e,t){1&e&&(Io(0,"div",0),ql(1,"safe"),Mo(),Io(2,"div",1,2),Io(4,"div",3,4),Io(6,"div",5,6),ql(8,"safe"),Ao(9,"canvas",7,8),Eo(11,sD,1,1,"terrain",9),Eo(12,oD,1,1,"game-table-mask",10),Eo(13,lD,1,5,"text-note",11),Eo(14,hD,1,6,"card-stack",12),Eo(15,uD,1,6,"card",13),Eo(16,dD,1,2,"dice-symbol",14),Eo(17,pD,1,2,"game-character",15),Eo(18,fD,1,1,"peer-cursor",16),Mo(),Mo(),Mo()),2&e&&(ta("background-image",$l(1,23,"url("+t.backgroundImage.url+")","style")),To("ngClass",Hl(29,gD,t.backgroundFilterType?"is-filter":"",t.backgroundFilterType)),Zr(2),To("ngClass",Ul(32,mD,t.isPointerDragging)),Zr(4),ta("background-image",$l(8,26,"url("+t.tableImage.url+")","style")),Zr(3),To("ngStyle",Ul(34,bD,"translateZ("+(t.gridHeight+.1)+"px)")),Zr(2),To("ngForOf",t.terrains)("ngForTrackBy",t.trackByGameObject),Zr(1),To("ngForOf",t.tableMasks)("ngForTrackBy",t.trackByGameObject),Zr(1),To("ngForOf",t.textNotes)("ngForTrackBy",t.trackByGameObject),Zr(1),To("ngForOf",t.cardStacks)("ngForTrackBy",t.trackByGameObject),Zr(1),To("ngForOf",t.cards)("ngForTrackBy",t.trackByGameObject),Zr(1),To("ngForOf",t.diceSymbols)("ngForTrackBy",t.trackByGameObject),Zr(1),To("ngForOf",t.characters)("ngForTrackBy",t.trackByGameObject),Zr(1),To("ngForOf",t.peerCursors)("ngForTrackBy",t.trackByGameObject))},directives:[Uh,Qh,Vh,uM,bM,TM,qA,rP,hP,OP,$P,eD],pipes:[$_],styles:['.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-perspective[_ngcontent-%COMP%]{perspective:1000px}.is-fill[_ngcontent-%COMP%]{display:block;top:0;left:0;bottom:0;right:0;margin:auto}.is-3d[_ngcontent-%COMP%], .is-fill[_ngcontent-%COMP%]{position:absolute}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d;-webkit-backface-visibility:hidden;backface-visibility:hidden}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.component[_ngcontent-%COMP%]{-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;touch-action:manipulation;height:100%;width:100%;overflow:hidden}.component-content[_ngcontent-%COMP%]{height:2000px;width:2000px}.grid-canvas[_ngcontent-%COMP%]{opacity:0;transform:translateZ(.15px);transition:.1s ease-out;-webkit-backface-visibility:hidden;backface-visibility:hidden}.game-table[_ngcontent-%COMP%], .table-image[_ngcontent-%COMP%]{height:100%;width:100%}.table-image[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;background-size:100% 100%}.background-image[_ngcontent-%COMP%], .table-image[_ngcontent-%COMP%]{position:absolute;background-repeat:no-repeat}.background-image[_ngcontent-%COMP%]{top:0;left:0;bottom:0;right:0;margin:-5px;background-position:50%;background-size:cover}.background-image.is-filter[_ngcontent-%COMP%]{will-change:filter}.background-image.is-filter.black[_ngcontent-%COMP%], .background-image.is-filter.white[_ngcontent-%COMP%]{filter:blur(5px)}.background-image.is-filter[_ngcontent-%COMP%]:after{display:block;content:"";width:100%;height:100%}.background-image.is-filter.white[_ngcontent-%COMP%]:after{background-color:#f7f7f7;filter:opacity(.2)}.background-image.is-filter.black[_ngcontent-%COMP%]:after{background-color:#1a1a1a;filter:opacity(.3)}']}),e})(),vD=(()=>{class e{constructor(e){this.elementRef=e,this.timer=null,this.needRepeat=!1}ngAfterViewInit(){let e=()=>{this.needRepeat?(this.timer=setTimeout(e,650),this.needRepeat=!1):(this.timer=null,this.elementRef.nativeElement.style.display="none")};Uy.register(this).on("*",t=>{this.needRepeat||Hy.bandwidthUsage<3072||(null===this.timer?(this.elementRef.nativeElement.style.display="block",this.timer=setTimeout(e,650)):this.needRepeat=!0)})}ngOnDestroy(){Uy.unregister(this)}}return e.\u0275fac=function(t){return new(t||e)(So(Ha))},e.\u0275cmp=Ze({type:e,selectors:[["network-indicator"]],decls:12,vars:0,consts:[[1,"sk-cube-grid"],[1,"sk-cube","sk-cube1"],[1,"sk-cube","sk-cube2"],[1,"sk-cube","sk-cube3"],[1,"sk-cube","sk-cube4"],[1,"sk-cube","sk-cube5"],[1,"sk-cube","sk-cube6"],[1,"sk-cube","sk-cube7"],[1,"sk-cube","sk-cube8"],[1,"sk-cube","sk-cube9"],[1,"sk-title"]],template:function(e,t){1&e&&(Io(0,"div",0),Ao(1,"div",1),Ao(2,"div",2),Ao(3,"div",3),Ao(4,"div",4),Ao(5,"div",5),Ao(6,"div",6),Ao(7,"div",7),Ao(8,"div",8),Ao(9,"div",9),Io(10,"div",10),ga(11,"sync"),Mo(),Mo())},styles:[".sk-cube-grid[_ngcontent-%COMP%]{font-size:8px;color:#444;height:100%;width:100%;background-color:hsla(0,0%,96.9%,.6)}.sk-cube[_ngcontent-%COMP%]{background-color:#555}.sk-title[_ngcontent-%COMP%]{padding:2px 0;background-color:hsla(0,0%,96.9%,.6)}"]}),e})();const _D=["modalLayer"];function wD(e,t){if(1&e){const e=Fo();Io(0,"li",2),zo("click",function(){return Ft(e),jo().save()}),Io(1,"a",3),Io(2,"div"),Io(3,"i",5),ga(4,"sd_storage"),Mo(),Mo(),Io(5,"div"),ga(6,"\u4fdd\u5b58"),Mo(),Mo(),Mo()}}function CD(e,t){if(1&e&&(Io(0,"li",12),Io(1,"a"),Io(2,"div"),Io(3,"i",13),ga(4,"sd_storage"),Mo(),Mo(),Io(5,"div"),ga(6),Mo(),Mo(),Mo()),2&e){const e=jo();Zr(6),ba("",e.progresPercent,"%")}}let xD=(()=>{class e{constructor(e,t,n,i,r,s,o,a,l){this.modalService=e,this.panelService=t,this.pointerDeviceService=n,this.chatMessageService=i,this.appConfigService=r,this.saveDataService=s,this.ngZone=o,this.contextMenuService=a,this.standImageService=l,this.immediateUpdateTimer=null,this.lazyUpdateTimer=null,this.openPanelCount=0,this.isSaveing=!1,this.progresPercent=0,this.ngZone.runOutsideAngular(()=>{iC.instance.initialize(),fS.instance.initialize(),pS.instance.initialize(),mS.instance.initialize()}),this.appConfigService.initialize(),this.pointerDeviceService.initialize(),pw.instance.initialize(),aC.instance.initialize(),new _v("DiceBot").initialize(),new bS("Jukebox").initialize(),new q_("SoundEffect").initialize(),pw.instance.addChatTab("\u30e1\u30a4\u30f3\u30bf\u30d6","MainTab"),pw.instance.addChatTab("\u30b5\u30d6\u30bf\u30d6","SubTab");let c=new mv("SampleDiceRollTable");c.initialize(),c.name="\u30b5\u30f3\u30d7\u30eb\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868",c.command="SAMPLE",c.dice="1d6",c.value="1:\u3053\u308c\u306f\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u30b5\u30f3\u30d7\u30eb\u3067\u3059\n2:\u6570\u5b57\u3068\u5bfe\u5fdc\u3059\u308b\u7d50\u679c\u30921\u884c\u306b1\u3064\u3065\u3064:\uff08\u30b3\u30ed\u30f3\uff09\u3067\u533a\u5207\u308a\n3:\u6570\u5b57:\u7d50\u679c\u306e\u3088\u3046\u306b\u8a18\u8ff0\u3057\u307e\u3059\n4:\\\\n  \\n\u3067\u6539\u884c\u3057\u307e\u3059\n5-6:\u307e\u305f\u3001-\uff08\u30cf\u30a4\u30d5\u30f3\uff09\u3067\u533a\u5207\u3063\u3066\u6570\u5b57\u306e\u7bc4\u56f2\u3092\u6307\u5b9a\u53ef\u80fd\u3067\u3059",yv.instance.addDiceRollTable(c);let h=Ig.createEmpty("none_icon").toContext();h.url="./assets/images/ic_account_circle_black_24dp_2x.png";let u=ov.instance.add(h);h=Ig.createEmpty("stand_no_image").toContext(),h.url="./assets/images/nc96424.png",ov.instance.add(h),G_.resumeAudioContext(),Y_.dicePick=Z_.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,Y_.dicePut=Z_.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,Y_.diceRoll1=Z_.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu01.mp3").identifier,Y_.diceRoll2=Z_.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu02.mp3").identifier,Y_.cardDraw=Z_.instance.add("./assets/sounds/soundeffect-lab/card-turn-over1.mp3").identifier,Y_.cardPick=Z_.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,Y_.cardPut=Z_.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,Y_.cardShuffle=Z_.instance.add("./assets/sounds/soundeffect-lab/card-open1.mp3").identifier,Y_.piecePick=Z_.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,Y_.piecePut=Z_.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,Y_.blockPick=Z_.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,Y_.blockPut=Z_.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,Y_.lock=Z_.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,Y_.unlock=Z_.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,Y_.sweep=Z_.instance.add("./assets/sounds/tm2/tm2_swing003.wav").identifier,Y_.puyon=Z_.instance.add("./assets/sounds/soundeffect-lab/puyon1.mp3").identifier,Y_.surprise=Z_.instance.add("./assets/sounds/otologic/Onmtp-Surprise02-1.mp3").identifier,Z_.instance.get(Y_.dicePick).isHidden=!0,Z_.instance.get(Y_.dicePut).isHidden=!0,Z_.instance.get(Y_.diceRoll1).isHidden=!0,Z_.instance.get(Y_.diceRoll2).isHidden=!0,Z_.instance.get(Y_.cardDraw).isHidden=!0,Z_.instance.get(Y_.cardPick).isHidden=!0,Z_.instance.get(Y_.cardPut).isHidden=!0,Z_.instance.get(Y_.cardShuffle).isHidden=!0,Z_.instance.get(Y_.piecePick).isHidden=!0,Z_.instance.get(Y_.piecePut).isHidden=!0,Z_.instance.get(Y_.blockPick).isHidden=!0,Z_.instance.get(Y_.blockPut).isHidden=!0,Z_.instance.get(Y_.lock).isHidden=!0,Z_.instance.get(Y_.unlock).isHidden=!0,Z_.instance.get(Y_.sweep).isHidden=!0,Z_.instance.get(Y_.puyon).isHidden=!0,Z_.instance.get(Y_.surprise).isHidden=!0,av.createMyCursor(),av.myCursor.name||(av.myCursor.name="\u30d7\u30ec\u30a4\u30e4\u30fc"),av.myCursor.imageIdentifier=u.identifier,Uy.register(this).on("UPDATE_GAME_OBJECT",e=>{this.lazyNgZoneUpdate(e.isSendFromSelf)}).on("DELETE_GAME_OBJECT",e=>{this.lazyNgZoneUpdate(e.isSendFromSelf)}).on("SYNCHRONIZE_AUDIO_LIST",e=>{e.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("LOAD_CONFIG",e=>{if(console.log("LOAD_CONFIG !!!",e.data),e.data.dice&&e.data.dice.url)fetch(e.data.dice.url+"/v1/names",{mode:"cors"}).then(e=>e.json()).then(t=>{let n=e.data.dice.url;_v.apiUrl="/"===n.substr(n.length-1)?n.substr(0,n.length-1):n,_v.diceBotInfos=[];let i=t.names.filter(e=>"DiceBot"!=e.system).map(e=>{let t=e.sort_key&&e.sort_key.indexOf("\u56fd\u969b\u5316")<0?e.sort_key:e.name.normalize("NFKD");for(let n of _v.replaceData)n[2]&&e.name===n[0]&&(t=n[1],e.name=n[2]),t=t.split(n[0].normalize("NFKD")).join(n[1].normalize("NFKD"));return e.normalize=t.replace(/[\u3041-\u3096]/g,e=>String.fromCharCode(e.charCodeAt(0)+96)).replace(/\u7b2c(.+?)\u7248/g,"\u30bf\u30a4$1\u30cf\u30f3").replace(/[\u30fb!?\uff01\uff1f\s\u3000:\uff1a=\uff1d\/\uff0f\uff08\uff09\(\)]+/g,"").replace(/([\u30a2\u30ab\u30b5\u30bf\u30ca\u30cf\u30de\u30e4\u30e9\u30ef])\u30fc+/g,"$1\u30a2").replace(/([\u30a4\u30ad\u30b7\u30c1\u30cb\u30d2\u30df\u30ea])\u30fc+/g,"$1\u30a4").replace(/([\u30a6\u30af\u30b9\u30c4\u30cc\u30d5\u30e0\u30e6\u30eb])\u30fc+/g,"$1\u30a6").replace(/([\u30a8\u30b1\u30bb\u30c6\u30cd\u30d8\u30e1\u30ec])\u30fc+/g,"$1\u30a8").replace(/([\u30aa\u30b3\u30bd\u30c8\u30ce\u30db\u30e2\u30e8\u30ed])\u30fc+/g,"$1\u30aa").replace(/\u30f3+\u30fc+/g,"\u30f3").replace(/\u30f3+/g,"\u30f3"),e}).map(e=>{const t=/.+\:(.+)/.exec(e.system);return e.lang=t?t[1]:"A",e}).sort((e,t)=>e.lang<t.lang?-1:e.lang>t.lang?1:e.normalize==t.normalize?0:e.normalize<t.normalize?-1:1);if(_v.diceBotInfos.push(...i.map(e=>({script:e.system,game:e.name}))),i.length>0){let e=i[0].normalize.substr(0,1),t={index:i[0].normalize.substr(0,1),infos:[]};for(let n of i){let i="B"==n.lang?"\u7279\u6b8a":"ChineseTraditional"==n.lang?"\u6b63\u9ad4\u4e2d\u6587":"Korean"==n.lang?"\ud55c\uad6d\uc5b4":"English"==n.lang?"English":n.normalize.substr(0,1);i!==e&&(e=i,_v.diceBotInfosIndexed.push(t),t={index:i,infos:[]}),t.infos.push({script:n.system,game:n.name})}_v.diceBotInfosIndexed.push(t)}});else{_v.diceBotInfos.forEach(e=>{let t=e.game.normalize("NFKD");for(let n of _v.replaceData)n[2]&&e.game===n[0]&&(t=n[1],e.game=n[2]),t=t.split(n[0].normalize("NFKD")).join(n[1].normalize("NFKD"));t=t.replace(/[\u3041-\u3096]/g,e=>String.fromCharCode(e.charCodeAt(0)+96)).replace(/\u7b2c(.+?)\u7248/g,"\u30bf\u30a4$1\u30cf\u30f3").replace(/[\u30fb!?\uff01\uff1f\s\u3000:\uff1a=\uff1d\/\uff0f\uff08\uff09\(\)]+/g,"").replace(/([\u30a2\u30ab\u30b5\u30bf\u30ca\u30cf\u30de\u30e4\u30e9\u30ef])\u30fc+/g,"$1\u30a2").replace(/([\u30a4\u30ad\u30b7\u30c1\u30cb\u30d2\u30df\u30ea])\u30fc+/g,"$1\u30a4").replace(/([\u30a6\u30af\u30b9\u30c4\u30cc\u30d5\u30e0\u30e6\u30eb])\u30fc+/g,"$1\u30a6").replace(/([\u30a8\u30b1\u30bb\u30c6\u30cd\u30d8\u30e1\u30ec])\u30fc+/g,"$1\u30a8").replace(/([\u30aa\u30b3\u30bd\u30c8\u30ce\u30db\u30e2\u30e8\u30ed])\u30fc+/g,"$1\u30aa").replace(/\u30f3+\u30fc+/g,"\u30f3").replace(/\u30f3+/g,"\u30f3"),e.sort_key=e.lang?e.lang:t.normalize("NFKD")}),_v.diceBotInfos.sort((e,t)=>e.sort_key==t.sort_key?0:e.sort_key<t.sort_key?-1:1);let e=_v.diceBotInfos[0].sort_key[0],t={index:e,infos:[]};for(let n of _v.diceBotInfos)(n.lang?n.lang:n.sort_key[0])!==e&&(e=n.lang?n.lang:n.sort_key[0],_v.diceBotInfosIndexed.push(t),t={index:e,infos:[]}),t.infos.push({script:n.script,game:n.game});_v.diceBotInfosIndexed.push(t)}Hy.setApiKey(e.data.webrtc.key),Hy.open()}).on("FILE_LOADED",e=>{this.lazyNgZoneUpdate(!1)}).on("OPEN_NETWORK",e=>{console.log("OPEN_NETWORK",e.data.peerId),av.myCursor.peerId=Hy.peerContext.peerId,av.myCursor.userId=Hy.peerContext.userId}).on("CLOSE_NETWORK",e=>{console.log("CLOSE_NETWORK",e.data.peerId),this.ngZone.run(()=>xg(this,void 0,void 0,function*(){1<Hy.peerIds.length?yield this.modalService.open(L_,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u63a5\u7d9a\u306b\u4f55\u3089\u304b\u306e\u7570\u5e38\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\n\u3053\u306e\u8868\u793a\u4ee5\u5f8c\u3001\u63a5\u7d9a\u304c\u4e0d\u5b89\u5b9a\u3067\u3042\u308c\u3070\u3001\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3068\u518d\u63a5\u7d9a\u3092\u8a66\u307f\u3066\u304f\u3060\u3055\u3044\u3002"}):(yield this.modalService.open(L_,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:"\u63a5\u7d9a\u60c5\u5831\u304c\u7834\u68c4\u3055\u308c\u307e\u3057\u305f\u3002\n\u3053\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b\u3068\u518d\u63a5\u7d9a\u3092\u8a66\u307f\u307e\u3059\u3002"}),Hy.open())}))}).on("CONNECT_PEER",e=>{e.isSendFromSelf&&this.chatMessageService.calibrateTimeOffset(),this.lazyNgZoneUpdate(e.isSendFromSelf)}).on("DISCONNECT_PEER",e=>{this.lazyNgZoneUpdate(e.isSendFromSelf)}).on("POPUP_STAND_IMAGE",-1e3,e=>{let t=Vy.instance.get(e.data.standIdentifier),n=Vy.instance.get(e.data.characterIdentifier);this.standImageService.show(n,t,e.data.color?e.data.color:null,e.data.secret)}).on("FAREWELL_STAND_IMAGE",-1e3,e=>{this.standImageService.farewell(e.data.characterIdentifier)}).on("DESTORY_STAND_IMAGE_ALL",-1e3,e=>{this.standImageService.destroyAll()})}ngAfterViewInit(){wv.defaultParentViewContainerRef=xv.defaultParentViewContainerRef=j_.defaultParentViewContainerRef=OI.defaultParentViewContainerRef=this.modalLayerViewContainerRef,setTimeout(()=>{this.panelService.open(kk,{width:520,height:450,left:100}),this.panelService.open(iT,{width:700,height:400,left:100,top:450})},0)}ngOnDestroy(){Uy.unregister(this)}open(e){let t=null,n={width:450,height:600,left:100};switch(e){case"PeerMenuComponent":n.width=520,t=kk;break;case"ChatWindowComponent":t=iT,n.width=700;break;case"GameTableSettingComponent":t=jO,n={width:630,height:400,left:100};break;case"FileStorageComponent":t=jT;break;case"GameCharacterSheetComponent":t=wx;break;case"JukeboxComponent":t=$O;break;case"GameCharacterGeneratorComponent":t=UT,n={width:500,height:300,left:100};break;case"GameObjectInventoryComponent":t=OO;break;case"DiceRollTableSettingComponent":t=zI,n={width:645,height:470}}t&&(n.top=20*(this.openPanelCount%10+1),n.left=100+5*(this.openPanelCount%20+1),this.openPanelCount=this.openPanelCount+1,this.panelService.open(t,n))}save(){return xg(this,void 0,void 0,function*(){if(this.isSaveing)return;this.isSaveing=!0,this.progresPercent=0;let e=Hy.peerContext&&0<Hy.peerContext.roomName.length?Hy.peerContext.roomName:"\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf";yield this.saveDataService.saveRoomAsync(e,e=>{this.progresPercent=e}),setTimeout(()=>{this.isSaveing=!1,this.progresPercent=0},500)})}handleFileSelect(e){let t=e.target,n=t.files;n.length&&iC.instance.load(n),t.value=""}lazyNgZoneUpdate(e){if(e){if(null!==this.immediateUpdateTimer)return;this.immediateUpdateTimer=setTimeout(()=>{this.immediateUpdateTimer=null,null!=this.lazyUpdateTimer&&(clearTimeout(this.lazyUpdateTimer),this.lazyUpdateTimer=null),this.ngZone.run(()=>{})},0)}else{if(null!==this.lazyUpdateTimer)return;this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,null!=this.immediateUpdateTimer&&(clearTimeout(this.immediateUpdateTimer),this.immediateUpdateTimer=null),this.ngZone.run(()=>{})},100)}}openDiceRollTable(){}resetPointOfView(){this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:"\u521d\u671f\u8996\u70b9\u306b\u623b\u3059",action:()=>Uy.trigger("RESET_POINT_OF_VIEW",null)},{name:"\u771f\u4e0a\u304b\u3089\u8996\u308b",action:()=>Uy.trigger("RESET_POINT_OF_VIEW","top")}],"\u8996\u70b9\u30ea\u30bb\u30c3\u30c8")}standSetteings(){const e=TI.isShowStand,t=TI.isShowNameTag,n=TI.isCanBeGone;this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:(e?"\u2611":"\u2610")+"\u30b9\u30bf\u30f3\u30c9\u8868\u793a",action:()=>{TI.isShowStand=!e}},{name:(t?"\u2611":"\u2610")+"\u30cd\u30fc\u30e0\u30bf\u30b0\u8868\u793a",action:()=>{TI.isShowNameTag=!t}},{name:(n?"\u2611":"\u2610")+"\u900f\u660e\u5316\u3001\u81ea\u52d5\u9000\u53bb",action:()=>{TI.isCanBeGone=!n}},B_,{name:"\u8868\u793a\u30b9\u30bf\u30f3\u30c9\u5168\u6d88\u53bb",action:()=>Uy.trigger("DESTORY_STAND_IMAGE_ALL",null)}],"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a")}diceAllOpne(){confirm("\u300c\u4e00\u6589\u516c\u958b\u3057\u306a\u3044\u300d\u8a2d\u5b9a\u3067\u306f\u306a\u3044\u30c0\u30a4\u30b9\u3092\u3059\u3079\u3066\u516c\u958b\u3057\u307e\u3059\u3002\n\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f")&&Uy.trigger("DICE_ALL_OPEN",null)}}return e.\u0275fac=function(t){return new(t||e)(So(xv),So(wv),So(Kw),So(fw),So(ok),So(_C),So(Rc),So(j_),So(OI))},e.\u0275cmp=Ze({type:e,selectors:[["app-root"]],viewQuery:function(e,t){if(1&e&&cc(_D,3,kl),2&e){let e;lc(e=hc())&&(t.modalLayerViewContainerRef=e.first)}},decls:98,vars:9,consts:[["id","app-table-layer",2,"position","absolute","width","100%","height","100%","overflow","hidden"],[3,"top","left","width","height","title","isAbleFullScreenButton","isAbleCloseButton"],[3,"click"],["routerLink","/","routerLinkActive","active"],[1,"material-icons","icon-size"],[1,"material-icons"],["type","file","multiple","","accept","application/xml,text/xml,application/zip",2,"display","none",3,"change"],[3,"click",4,"ngIf"],["style","pointer-events: none;",4,"ngIf"],[2,"margin-top","2em","font-size","8px","text-align","center"],["modalLayer",""],[1,"networkIndicator"],[2,"pointer-events","none"],[1,"material-icons","vibration-amine"]],template:function(e,t){1&e&&(Io(0,"div",0),Ao(1,"game-table"),Mo(),Io(2,"ui-panel",1),Io(3,"nav"),Io(4,"ul"),Io(5,"li",2),zo("click",function(){return t.open("PeerMenuComponent")}),Io(6,"a",3),Io(7,"div"),Io(8,"i",4),ga(9,"people"),Mo(),Mo(),Io(10,"div"),ga(11,"\u63a5\u7d9a"),Mo(),Mo(),Mo(),Io(12,"li",2),zo("click",function(){return t.open("ChatWindowComponent")}),Io(13,"a",3),Io(14,"div"),Io(15,"i",4),ga(16,"speaker_notes"),Mo(),Mo(),Io(17,"div"),ga(18,"\u30c1\u30e3\u30c3\u30c8\u753b\u9762"),Mo(),Mo(),Mo(),Io(19,"li",2),zo("click",function(){return t.open("GameTableSettingComponent")}),Io(20,"a",3),Io(21,"div"),Io(22,"i",4),ga(23,"layers"),Mo(),Mo(),Io(24,"div"),ga(25,"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a"),Mo(),Mo(),Mo(),Io(26,"li",2),zo("click",function(){return t.open("FileStorageComponent")}),Io(27,"a",3),Io(28,"div"),Io(29,"i",4),ga(30,"photo_library"),Mo(),Mo(),Io(31,"div"),ga(32,"\u753b\u50cf"),Mo(),Mo(),Mo(),Io(33,"li",2),zo("click",function(){return t.open("JukeboxComponent")}),Io(34,"a",3),Io(35,"div"),Io(36,"i",5),ga(37,"queue_music"),Mo(),Mo(),Io(38,"div"),ga(39,"\u97f3\u697d"),Mo(),Mo(),Mo(),Io(40,"li",2),zo("click",function(){return t.open("DiceRollTableSettingComponent")}),Io(41,"a",3),Io(42,"div"),Io(43,"i",5),ga(44,"table_rows"),Mo(),Mo(),Io(45,"div"),ga(46,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868"),Mo(),Mo(),Mo(),Io(47,"li",2),zo("click",function(){return t.open("GameObjectInventoryComponent")}),Io(48,"a",3),Io(49,"div"),Io(50,"i",4),ga(51,"folder_shared"),Mo(),Mo(),Io(52,"div"),ga(53,"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),Mo(),Mo(),Mo(),Io(54,"li",2),zo("click",function(){return t.diceAllOpne()}),Io(55,"a",3),Io(56,"div"),Io(57,"i",4),ga(58,"all_out"),Mo(),Mo(),Io(59,"div"),ga(60,"\u30c0\u30a4\u30b9\u4e00\u6589\u516c\u958b"),Mo(),Mo(),Mo(),Io(61,"li",2),zo("click",function(){return t.standSetteings()}),Io(62,"a",3),Io(63,"div"),Io(64,"i",4),ga(65,"how_to_reg"),Mo(),Mo(),Io(66,"div"),ga(67,"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a"),Io(68,"sup"),ga(69,"*"),Mo(),Mo(),Mo(),Mo(),Io(70,"li",2),zo("click",function(){return t.resetPointOfView()}),Io(71,"a",3),Io(72,"div"),Io(73,"i",4),ga(74,"remove_red_eye"),Mo(),Mo(),Io(75,"div"),ga(76,"\u8996\u70b9\u30ea\u30bb\u30c3\u30c8"),Io(77,"sup"),ga(78,"*"),Mo(),Mo(),Mo(),Mo(),Io(79,"li"),Io(80,"a",3),Io(81,"label"),Io(82,"div"),Io(83,"i",5),ga(84,"open_in_browser"),Mo(),Mo(),Io(85,"div"),ga(86,"ZIP\u8aad\u8fbc"),Mo(),Io(87,"input",6),zo("change",function(e){return t.handleFileSelect(e)}),Mo(),Mo(),Mo(),Mo(),Eo(88,wD,7,0,"li",7),Eo(89,CD,7,1,"li",8),Mo(),Io(90,"div",9),Io(91,"b"),Io(92,"sup"),ga(93,"*"),Mo(),ga(94,"\u306f\u81ea\u5206\u306e\u307f"),Mo(),Mo(),Mo(),Mo(),Ao(95,"div",null,10),Ao(97,"network-indicator",11)),2&e&&(Zr(2),To("top",0)("left",0)("width",100)("height",710)("title","\u30e1\u30cb\u30e5\u30fc")("isAbleFullScreenButton",!1)("isAbleCloseButton",!1),Zr(86),To("ngIf",!t.isSaveing),Zr(1),To("ngIf",t.isSaveing))},directives:[yD,uI,Zh,vD],styles:["nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{text-align:center;padding:5px;color:#ccc;color:#444;cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:hover{color:#ccc;background-color:rgba(30,30,30,.8)}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{height:128px;width:128px;font-size:8px;-webkit-user-select:none;-moz-user-select:none;user-select:none}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:24px}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{text-decoration:none}.icon-size[_ngcontent-%COMP%]{font-size:40px}.side-menu[_ngcontent-%COMP%]{top:0;left:0;box-sizing:border-box;overflow:auto;position:absolute;color:#ccc;background-color:rgba(30,30,30,.8);border:1px solid #999;padding:0;height:100%;width:300px}.networkIndicator[_ngcontent-%COMP%]{display:none;z-index:9999;pointer-events:none;position:absolute;top:3px;right:3px;height:30px;width:30px}.vibration-amine[_ngcontent-%COMP%]{-webkit-animation:vibration .2s infinite;animation:vibration .2s infinite}@-webkit-keyframes vibration{0%{transform:scale(1) translate(0)}50%{transform:scale(1.02,.95) translateY(5%)}to{transform:scale(1) translate(0)}}@keyframes vibration{0%{transform:scale(1) translate(0)}50%{transform:scale(1.02,.95) translateY(5%)}to{transform:scale(1) translate(0)}}sup[_ngcontent-%COMP%]{color:red}"]}),e})();wv.UIPanelComponentClass=uI,j_.ContextMenuComponentClass=NT,xv.ModalComponentClass=QO;const ED=new y(e=>e.complete());function kD(e){return e?function(e){return new y(t=>e.schedule(()=>t.complete()))}(e):ED}function SD(e){return new y(t=>{let n;try{n=e()}catch(i){return void t.error(i)}return(n?N(n):kD()).subscribe(t)})}function TD(e,t){return new y(t?n=>t.schedule(OD,0,{error:e,subscriber:n}):t=>t.error(e))}function OD({error:e,subscriber:t}){t.error(e)}function ID(e,t,n,r){return i(n)&&(r=n,n=void 0),r?ID(e,t,n).pipe(S(e=>l(e)?r(...e):r(e))):new y(i=>{MD(e,t,function(e){i.next(arguments.length>1?Array.prototype.slice.call(arguments):e)},i,n)})}function MD(e,t,n,i,r){let s;if(function(e){return e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}(e)){const i=e;e.addEventListener(t,n,r),s=()=>i.removeEventListener(t,n,r)}else if(function(e){return e&&"function"==typeof e.on&&"function"==typeof e.off}(e)){const i=e;e.on(t,n),s=()=>i.off(t,n)}else if(function(e){return e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener}(e)){const i=e;e.addListener(t,n),s=()=>i.removeListener(t,n)}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(let s=0,o=e.length;s<o;s++)MD(e[s],t,n,i,r)}i.add(s)}function AD(...e){let t=e[e.length-1];return k(t)?(e.pop(),F(e,t)):G(e)}function PD(){}const DD=new y(PD);function RD(e,t){return function(n){return n.lift(new FD(e,t))}}class FD{constructor(e,t){this.predicate=e,this.thisArg=t}call(e,t){return t.subscribe(new ND(e,this.predicate,this.thisArg))}}class ND extends f{constructor(e,t,n){super(e),this.predicate=t,this.thisArg=n,this.count=0}_next(e){let t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(n){return void this.destination.error(n)}t&&this.destination.next(e)}}function zD(e,t){return"function"==typeof t?n=>n.pipe(zD((n,i)=>N(e(n,i)).pipe(S((e,r)=>t(n,e,i,r))))):t=>t.lift(new LD(e))}class LD{constructor(e){this.project=e}call(e,t){return t.subscribe(new BD(e,this.project))}}class BD extends L{constructor(e,t){super(e),this.project=t,this.index=0}_next(e){let t;const n=this.index++;try{t=this.project(e,n)}catch(i){return void this.destination.error(i)}this._innerSub(t)}_innerSub(e){const t=this.innerSubscription;t&&t.unsubscribe();const n=new z(this),i=this.destination;i.add(n),this.innerSubscription=B(e,n),this.innerSubscription!==n&&i.add(this.innerSubscription)}_complete(){const{innerSubscription:e}=this;e&&!e.closed||super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(e){this.destination.next(e)}}const jD=(()=>{function e(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return e.prototype=Object.create(Error.prototype),e})();function UD(e){return t=>0===e?kD():t.lift(new HD(e))}class HD{constructor(e){if(this.total=e,this.total<0)throw new jD}call(e,t){return t.subscribe(new VD(e,this.total))}}class VD extends f{constructor(e,t){super(e),this.total=t,this.count=0}_next(e){const t=this.total,n=++this.count;n<=t&&(this.destination.next(e),n===t&&(this.destination.complete(),this.unsubscribe()))}}class GD{constructor(e,t,n){this.nextOrObserver=e,this.error=t,this.complete=n}call(e,t){return t.subscribe(new ZD(e,this.nextOrObserver,this.error,this.complete))}}class ZD extends f{constructor(e,t,n,r){super(e),this._tapNext=PD,this._tapError=PD,this._tapComplete=PD,this._tapError=n||PD,this._tapComplete=r||PD,i(t)?(this._context=this,this._tapNext=t):t&&(this._context=t,this._tapNext=t.next||PD,this._tapError=t.error||PD,this._tapComplete=t.complete||PD)}_next(e){try{this._tapNext.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.next(e)}_error(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)}_complete(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}class WD extends u{constructor(e,t){super()}schedule(e,t=0){return this}}class YD extends WD{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const n=this.id,i=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(i,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(i,this.id,t),this}requestAsyncId(e,t,n=0){return setInterval(e.flush.bind(e,this),n)}recycleAsyncId(e,t,n=0){if(null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let n,i=!1;try{this.work(e)}catch(r){i=!0,n=!!r&&r||new Error(r)}if(i)return this.unsubscribe(),n}_unsubscribe(){const e=this.id,t=this.scheduler,n=t.actions,i=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==i&&n.splice(i,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}let qD=(()=>{class e{constructor(t,n=e.now){this.SchedulerAction=t,this.now=n}schedule(e,t=0,n){return new this.SchedulerAction(this,e).schedule(n,t)}}return e.now=()=>Date.now(),e})();class $D extends qD{constructor(e,t=qD.now){super(e,()=>$D.delegate&&$D.delegate!==this?$D.delegate.now():t()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(e,t=0,n){return $D.delegate&&$D.delegate!==this?$D.delegate.schedule(e,t,n):super.schedule(e,t,n)}flush(e){const{actions:t}=this;if(this.active)return void t.push(e);let n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}const XD=new $D(YD);let KD=(()=>{class e{constructor(e,t,n){this.kind=e,this.value=t,this.error=n,this.hasValue="N"===e}observe(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}do(e,t,n){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return n&&n()}}accept(e,t,n){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,n)}toObservable(){switch(this.kind){case"N":return AD(this.value);case"E":return TD(this.error);case"C":return kD()}throw new Error("unexpected notification kind value")}static createNext(t){return void 0!==t?new e("N",t):e.undefinedValueNotification}static createError(t){return new e("E",void 0,t)}static createComplete(){return e.completeNotification}}return e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",void 0),e})();class QD{constructor(e,t){this.delay=e,this.scheduler=t}call(e,t){return t.subscribe(new JD(e,this.delay,this.scheduler))}}class JD extends f{constructor(e,t,n){super(e),this.delay=t,this.scheduler=n,this.queue=[],this.active=!1,this.errored=!1}static dispatch(e){const t=e.source,n=t.queue,i=e.scheduler,r=e.destination;for(;n.length>0&&n[0].time-i.now()<=0;)n.shift().notification.observe(r);if(n.length>0){const t=Math.max(0,n[0].time-i.now());this.schedule(e,t)}else this.unsubscribe(),t.active=!1}_schedule(e){this.active=!0,this.destination.add(e.schedule(JD.dispatch,this.delay,{source:this,destination:this.destination,scheduler:e}))}scheduleNotification(e){if(!0===this.errored)return;const t=this.scheduler,n=new eR(t.now()+this.delay,e);this.queue.push(n),!1===this.active&&this._schedule(t)}_next(e){this.scheduleNotification(KD.createNext(e))}_error(e){this.errored=!0,this.queue=[],this.destination.error(e),this.unsubscribe()}_complete(){this.scheduleNotification(KD.createComplete()),this.unsubscribe()}}class eR{constructor(e,t){this.time=e,this.notification=t}}const tR="Service workers are disabled or not supported by this browser";class nR{constructor(e){if(this.serviceWorker=e,e){const t=ID(e,"controllerchange").pipe(S(()=>e.controller)),n=function(...e){return V(1)(AD(...e))}(SD(()=>AD(e.controller)),t);this.worker=n.pipe(RD(e=>!!e)),this.registration=this.worker.pipe(zD(()=>e.getRegistration()));const i=ID(e,"message").pipe(S(e=>e.data)).pipe(RD(e=>e&&e.type)).pipe(Q(new x));i.connect(),this.events=i}else this.worker=this.events=this.registration=SD(()=>TD(new Error("Service workers are disabled or not supported by this browser")))}postMessage(e,t){return this.worker.pipe(UD(1),(n=n=>{n.postMessage(Object.assign({action:e},t))},function(e){return e.lift(new GD(n,void 0,void 0))})).toPromise().then(()=>{});var n}postMessageWithStatus(e,t,n){const i=this.waitForStatus(n),r=this.postMessage(e,t);return Promise.all([i,r]).then(()=>{})}generateNonce(){return Math.round(1e7*Math.random())}eventsOfType(e){return this.events.pipe(RD(t=>t.type===e))}nextEventOfType(e){return this.eventsOfType(e).pipe(UD(1))}waitForStatus(e){return this.eventsOfType("STATUS").pipe(RD(t=>t.nonce===e),UD(1),S(e=>{if(!e.status)throw new Error(e.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}}let iR=(()=>{class e{constructor(e){if(this.sw=e,this.subscriptionChanges=new x,!e.isEnabled)return this.messages=DD,this.notificationClicks=DD,void(this.subscription=DD);this.messages=this.sw.eventsOfType("PUSH").pipe(S(e=>e.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(S(e=>e.data)),this.pushManager=this.sw.registration.pipe(S(e=>e.pushManager));const t=this.pushManager.pipe(zD(e=>e.getSubscription()));this.subscription=Z(t,this.subscriptionChanges)}get isEnabled(){return this.sw.isEnabled}requestSubscription(e){if(!this.sw.isEnabled)return Promise.reject(new Error(tR));const t={userVisibleOnly:!0};let n=this.decodeBase64(e.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),i=new Uint8Array(new ArrayBuffer(n.length));for(let r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return t.applicationServerKey=i,this.pushManager.pipe(zD(e=>e.subscribe(t)),UD(1)).toPromise().then(e=>(this.subscriptionChanges.next(e),e))}unsubscribe(){return this.sw.isEnabled?this.subscription.pipe(UD(1),zD(e=>{if(null===e)throw new Error("Not subscribed to push notifications.");return e.unsubscribe().then(e=>{if(!e)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})})).toPromise():Promise.reject(new Error(tR))}decodeBase64(e){return atob(e)}}return e.\u0275fac=function(t){return new(t||e)(oi(nR))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})(),rR=(()=>{class e{constructor(e){if(this.sw=e,!e.isEnabled)return this.available=DD,this.activated=DD,void(this.unrecoverable=DD);this.available=this.sw.eventsOfType("UPDATE_AVAILABLE"),this.activated=this.sw.eventsOfType("UPDATE_ACTIVATED"),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}get isEnabled(){return this.sw.isEnabled}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(tR));const e=this.sw.generateNonce();return this.sw.postMessageWithStatus("CHECK_FOR_UPDATES",{statusNonce:e},e)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(tR));const e=this.sw.generateNonce();return this.sw.postMessageWithStatus("ACTIVATE_UPDATE",{statusNonce:e},e)}}return e.\u0275fac=function(t){return new(t||e)(oi(nR))},e.\u0275prov=pe({token:e,factory:e.\u0275fac}),e})();class sR{}const oR=new Zn("NGSW_REGISTER_SCRIPT");function aR(e,t,n,i){return()=>{if(!nu(i)||!("serviceWorker"in navigator)||!1===n.enabled)return;let r;if(navigator.serviceWorker.addEventListener("controllerchange",()=>{null!==navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({action:"INITIALIZE"})}),"function"==typeof n.registrationStrategy)r=n.registrationStrategy();else{const[t,...i]=(n.registrationStrategy||"registerWhenStable:30000").split(":");switch(t){case"registerImmediately":r=AD(null);break;case"registerWithDelay":r=lR(+i[0]||0);break;case"registerWhenStable":r=i[0]?Z(cR(e),lR(+i[0])):cR(e);break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${n.registrationStrategy}`)}}e.get(Rc).runOutsideAngular(()=>r.pipe(UD(1)).subscribe(()=>navigator.serviceWorker.register(t,{scope:n.scope}).catch(e=>console.error("Service worker registration failed with:",e))))}}function lR(e){return AD(null).pipe(function(e,t=XD){var n;const i=(n=e)instanceof Date&&!isNaN(+n)?+e-t.now():Math.abs(e);return e=>e.lift(new QD(i,t))}(e))}function cR(e){return e.get(Jc).isStable.pipe(RD(e=>e))}function hR(e,t){return new nR(nu(t)&&!1!==e.enabled?navigator.serviceWorker:void 0)}let uR=(()=>{class e{static register(t,n={}){return{ngModule:e,providers:[{provide:oR,useValue:t},{provide:sR,useValue:n},{provide:nR,useFactory:hR,deps:[sR,vc]},{provide:pc,useFactory:aR,deps:[io,oR,sR,vc],multi:!0}]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Xe({type:e}),e.\u0275inj=fe({providers:[iR,rR]}),e})(),dR=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Xe({type:e,bootstrap:[xD]}),e.\u0275inj=fe({providers:[ok,fw,j_,xv,rS,wv,Kw,hS,OI],imports:[[Pu,_g,tu,Kd,M_,uR.register("ngsw-worker.js",{enabled:!0})]]}),e})();We(Tw,[Td,od,xd,Vh,Dd,ju,sd,Sd,Zh,wg,iS,Bd,Vd],[]),We(Tw,[Td,od,xd,Vh,Dd,ju,sd,Sd,Zh,wg,iS,Bd,Vd],[]),function(){if(Yc)throw new Error("Cannot enable prod mode after platform setup.");Wc=!1}(),Mu().bootstrapModule(dR).catch(e=>console.error(e))},zn8P:function(e,t){function n(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="zn8P"},zqaK:function(e,t,n){var i=n("aKC4"),r=n("McxJ");t.version=n("7ice").version,t.compress=function(e,t){return new i(t).compress(e)},t.decompress=function(e,t){return new r(t).decompress(e)}}},[[0,0]]]);