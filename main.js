(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[179],{383:(C,le,me)=>{"use strict";me.r(le),me.d(le,{default:()=>$});var d=me(5861),H=me(3604),ee=me.n(H);class $ extends(ee()){dynamicImportI18n(O,E){return(0,d.Z)(function*(){return(yield me(6507)(`./${O}.${E}.json`)).default})()}dynamicImport(O){return(0,d.Z)(function*(){yield me(85)(`./${O}`)})()}}},1099:(C,le,me)=>{"use strict";function d(t){return"function"==typeof t}function H(t){const e=t(i=>{Error.call(i),i.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const ee=H(t=>function(e){t(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function $(t,n){if(t){const e=t.indexOf(n);0<=e&&t.splice(e,1)}}class x{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const s of e)s.remove(this);else e.remove(this);const{initialTeardown:i}=this;if(d(i))try{i()}catch(s){n=s instanceof ee?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{Y(s)}catch(o){n=null!=n?n:[],o instanceof ee?n=[...n,...o.errors]:n.push(o)}}if(n)throw new ee(n)}}add(n){var e;if(n&&n!==this)if(this.closed)Y(n);else{if(n instanceof x){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(n)}}_hasParent(n){const{_parentage:e}=this;return e===n||Array.isArray(e)&&e.includes(n)}_addParent(n){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(n),e):e?[e,n]:n}_removeParent(n){const{_parentage:e}=this;e===n?this._parentage=null:Array.isArray(e)&&$(e,n)}remove(n){const{_finalizers:e}=this;e&&$(e,n),n instanceof x&&n._removeParent(this)}}x.EMPTY=(()=>{const t=new x;return t.closed=!0,t})();const O=x.EMPTY;function E(t){return t instanceof x||t&&"closed"in t&&d(t.remove)&&d(t.add)&&d(t.unsubscribe)}function Y(t){d(t)?t():t.unsubscribe()}const G={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},D={setTimeout(t,n,...e){const{delegate:i}=D;return(null==i?void 0:i.setTimeout)?i.setTimeout(t,n,...e):setTimeout(t,n,...e)},clearTimeout(t){const{delegate:n}=D;return((null==n?void 0:n.clearTimeout)||clearTimeout)(t)},delegate:void 0};function W(t){D.setTimeout(()=>{const{onUnhandledError:n}=G;if(!n)throw t;n(t)})}function B(){}const Z=oe("C",void 0,void 0);function oe(t,n,e){return{kind:t,value:n,error:e}}let z=null;function q(t){if(G.useDeprecatedSynchronousErrorHandling){const n=!z;if(n&&(z={errorThrown:!1,error:null}),t(),n){const{errorThrown:e,error:i}=z;if(z=null,e)throw i}}else t()}class I extends x{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,E(n)&&n.add(this)):this.destination=R}static create(n,e,i){return new S(n,e,i)}next(n){this.isStopped?P(function j(t){return oe("N",t,void 0)}(n),this):this._next(n)}error(n){this.isStopped?P(function T(t){return oe("E",void 0,t)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?P(Z,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const A=Function.prototype.bind;function J(t,n){return A.call(t,n)}class L{constructor(n){this.partialObserver=n}next(n){const{partialObserver:e}=this;if(e.next)try{e.next(n)}catch(i){M(i)}}error(n){const{partialObserver:e}=this;if(e.error)try{e.error(n)}catch(i){M(i)}else M(n)}complete(){const{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(e){M(e)}}}class S extends I{constructor(n,e,i){let r;if(super(),d(n)||!n)r={next:null!=n?n:void 0,error:null!=e?e:void 0,complete:null!=i?i:void 0};else{let s;this&&G.useDeprecatedNextContext?(s=Object.create(n),s.unsubscribe=()=>this.unsubscribe(),r={next:n.next&&J(n.next,s),error:n.error&&J(n.error,s),complete:n.complete&&J(n.complete,s)}):r=n}this.destination=new L(r)}}function M(t){G.useDeprecatedSynchronousErrorHandling?function K(t){G.useDeprecatedSynchronousErrorHandling&&z&&(z.errorThrown=!0,z.error=t)}(t):W(t)}function P(t,n){const{onStoppedNotification:e}=G;e&&D.setTimeout(()=>e(t,n))}const R={closed:!0,next:B,error:function v(t){throw t},complete:B},te="function"==typeof Symbol&&Symbol.observable||"@@observable";function k(t){return t}function de(...t){return N(t)}function N(t){return 0===t.length?k:1===t.length?t[0]:function(e){return t.reduce((i,r)=>r(i),e)}}let F=(()=>{class t{constructor(e){e&&(this._subscribe=e)}lift(e){const i=new t;return i.source=this,i.operator=e,i}subscribe(e,i,r){const s=function c(t){return t&&t instanceof I||function l(t){return t&&d(t.next)&&d(t.error)&&d(t.complete)}(t)&&E(t)}(e)?e:new S(e,i,r);return q(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(e){try{return this._subscribe(e)}catch(i){e.error(i)}}forEach(e,i){return new(i=g(i))((r,s)=>{const o=new S({next:a=>{try{e(a)}catch(h){s(h),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(e){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(e)}[te](){return this}pipe(...e){return N(e)(this)}toPromise(e){return new(e=g(e))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return t.create=n=>new t(n),t})();function g(t){var n;return null!==(n=null!=t?t:G.Promise)&&void 0!==n?n:Promise}const f=H(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let u=(()=>{class t extends F{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const i=new p(this,this);return i.operator=e,i}_throwIfClosed(){if(this.closed)throw new f}next(e){q(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(e)}})}error(e){q(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:i}=this;for(;i.length;)i.shift().error(e)}})}complete(){q(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:i,isStopped:r,observers:s}=this;return i||r?O:(this.currentObservers=null,s.push(e),new x(()=>{this.currentObservers=null,$(s,e)}))}_checkFinalizedStatuses(e){const{hasError:i,thrownError:r,isStopped:s}=this;i?e.error(r):s&&e.complete()}asObservable(){const e=new F;return e.source=this,e}}return t.create=(n,e)=>new p(n,e),t})();class p extends u{constructor(n,e){super(),this.destination=n,this.source=e}next(n){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===i||i.call(e,n)}error(n){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===i||i.call(e,n)}complete(){var n,e;null===(e=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===e||e.call(n)}_subscribe(n){var e,i;return null!==(i=null===(e=this.source)||void 0===e?void 0:e.subscribe(n))&&void 0!==i?i:O}}function _(t){return d(null==t?void 0:t.lift)}function y(t){return n=>{if(_(n))return n.lift(function(e){try{return t(e,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function m(t,n,e,i,r){return new ne(t,n,e,i,r)}class ne extends I{constructor(n,e,i,r,s,o){super(n),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=e?function(a){try{e(a)}catch(h){n.error(h)}}:super._next,this._error=r?function(a){try{r(a)}catch(h){n.error(h)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){n.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}}function se(t,n){return y((e,i)=>{let r=0;e.subscribe(m(i,s=>{i.next(t.call(n,s,r++))}))})}var Ee=function(t,n){return(Ee=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])})(t,n)};function ke(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}Ee(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}var ce=function(){return ce=Object.assign||function(n){for(var e,i=1,r=arguments.length;i<r;i++)for(var s in e=arguments[i])Object.prototype.hasOwnProperty.call(e,s)&&(n[s]=e[s]);return n},ce.apply(this,arguments)};function $e(t,n,e,i){var o,r=arguments.length,s=r<3?n:null===i?i=Object.getOwnPropertyDescriptor(n,e):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,n,e,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(n,e,s):o(n,e))||s);return r>3&&s&&Object.defineProperty(n,e,s),s}function mt(t){return this instanceof mt?(this.v=t,this):new mt(t)}function bt(t,n,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=e.apply(t,n||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(pe){i[pe]&&(r[pe]=function(we){return new Promise(function(Ie,Pe){s.push([pe,we,Ie,Pe])>1||a(pe,we)})})}function a(pe,we){try{!function h(pe){pe.value instanceof mt?Promise.resolve(pe.value.v).then(w,X):fe(s[0][2],pe)}(i[pe](we))}catch(Ie){fe(s[0][3],Ie)}}function w(pe){a("next",pe)}function X(pe){a("throw",pe)}function fe(pe,we){pe(we),s.shift(),s.length&&a(s[0][0],s[0][1])}}function jt(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=function xe(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],i=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(s){e[s]=t[s]&&function(o){return new Promise(function(a,h){!function r(s,o,a,h){Promise.resolve(h).then(function(w){s({value:w,done:a})},o)}(a,h,(o=t[s](o)).done,o.value)})}}}const vo=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function xf(t){return d(null==t?void 0:t.then)}function Su(t){return d(t[te])}function Iu(t){return Symbol.asyncIterator&&d(null==t?void 0:t[Symbol.asyncIterator])}function ic(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const wf=function vg(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Ef(t){return d(null==t?void 0:t[wf])}function ku(t){return bt(this,arguments,function*(){const e=t.getReader();try{for(;;){const{value:i,done:r}=yield mt(e.read());if(r)return yield mt(void 0);yield yield mt(i)}}finally{e.releaseLock()}})}function Tf(t){return d(null==t?void 0:t.getReader)}function $r(t){if(t instanceof F)return t;if(null!=t){if(Su(t))return function bg(t){return new F(n=>{const e=t[te]();if(d(e.subscribe))return e.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(vo(t))return function rc(t){return new F(n=>{for(let e=0;e<t.length&&!n.closed;e++)n.next(t[e]);n.complete()})}(t);if(xf(t))return function yg(t){return new F(n=>{t.then(e=>{n.closed||(n.next(e),n.complete())},e=>n.error(e)).then(null,W)})}(t);if(Iu(t))return Mu(t);if(Ef(t))return function Cg(t){return new F(n=>{for(const e of t)if(n.next(e),n.closed)return;n.complete()})}(t);if(Tf(t))return function Du(t){return Mu(ku(t))}(t)}throw ic(t)}function Mu(t){return new F(n=>{(function xg(t,n){var e,i,r,s;return function Ce(t,n,e,i){return new(e||(e=Promise))(function(s,o){function a(X){try{w(i.next(X))}catch(fe){o(fe)}}function h(X){try{w(i.throw(X))}catch(fe){o(fe)}}function w(X){X.done?s(X.value):function r(s){return s instanceof e?s:new e(function(o){o(s)})}(X.value).then(a,h)}w((i=i.apply(t,n||[])).next())})}(this,void 0,void 0,function*(){try{for(e=jt(t);!(i=yield e.next()).done;)if(n.next(i.value),n.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=e.return)&&(yield s.call(e))}finally{if(r)throw r.error}}n.complete()})})(t,n).catch(e=>n.error(e))})}function ws(t,n,e,i=0,r=!1){const s=n.schedule(function(){e(),r?t.add(this.schedule(null,i)):this.unsubscribe()},i);if(t.add(s),!r)return s}function $a(t,n,e=1/0){return d(n)?$a((i,r)=>se((s,o)=>n(i,s,r,o))($r(t(i,r))),e):("number"==typeof n&&(e=n),y((i,r)=>function wg(t,n,e,i,r,s,o,a){const h=[];let w=0,X=0,fe=!1;const pe=()=>{fe&&!h.length&&!w&&n.complete()},we=Pe=>w<i?Ie(Pe):h.push(Pe),Ie=Pe=>{s&&n.next(Pe),w++;let Be=!1;$r(e(Pe,X++)).subscribe(m(n,Le=>{null==r||r(Le),s?we(Le):n.next(Le)},()=>{Be=!0},void 0,()=>{if(Be)try{for(w--;h.length&&w<i;){const Le=h.shift();o?ws(n,o,()=>Ie(Le)):Ie(Le)}pe()}catch(Le){n.error(Le)}}))};return t.subscribe(m(n,we,()=>{fe=!0,pe()})),()=>{null==a||a()}}(i,r,t,e)))}function Au(t=1/0){return $a(k,t)}const sc=new F(t=>t.complete());function bo(t){return t&&d(t.schedule)}function Jo(t){return t[t.length-1]}function yo(t){return d(Jo(t))?t.pop():void 0}function Co(t){return bo(Jo(t))?t.pop():void 0}function Sf(t,n=0){return y((e,i)=>{e.subscribe(m(i,r=>ws(i,t,()=>i.next(r),n),()=>ws(i,t,()=>i.complete(),n),r=>ws(i,t,()=>i.error(r),n)))})}function If(t,n=0){return y((e,i)=>{i.add(t.schedule(()=>e.subscribe(i),n))})}function Es(t,n){if(!t)throw new Error("Iterable cannot be null");return new F(e=>{ws(e,n,()=>{const i=t[Symbol.asyncIterator]();ws(e,n,()=>{i.next().then(r=>{r.done?e.complete():e.next(r.value)})},0,!0)})})}function vr(t,n){return n?function Ts(t,n){if(null!=t){if(Su(t))return function oc(t,n){return $r(t).pipe(If(n),Sf(n))}(t,n);if(vo(t))return function va(t,n){return new F(e=>{let i=0;return n.schedule(function(){i===t.length?e.complete():(e.next(t[i++]),e.closed||this.schedule())})})}(t,n);if(xf(t))return function Kr(t,n){return $r(t).pipe(If(n),Sf(n))}(t,n);if(Iu(t))return Es(t,n);if(Ef(t))return function xo(t,n){return new F(e=>{let i;return ws(e,n,()=>{i=t[wf](),ws(e,n,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void e.error(o)}s?e.complete():e.next(r)},0,!0)}),()=>d(null==i?void 0:i.return)&&i.return()})}(t,n);if(Tf(t))return function ll(t,n){return Es(ku(t),n)}(t,n)}throw ic(t)}(t,n):$r(t)}function cl(...t){const n=Co(t),e=function Nu(t,n){return"number"==typeof Jo(t)?t.pop():n}(t,1/0),i=t;return i.length?1===i.length?$r(i[0]):Au(e)(vr(i,n)):sc}function ba(t,n,...e){if(!0===n)return void t();if(!1===n)return;const i=new S({next:()=>{i.unsubscribe(),t()}});return n(...e).subscribe(i)}function In(t){for(let n in t)if(t[n]===In)return n;throw Error("Could not find renamed property on target object.")}function ya(t,n){for(const e in n)n.hasOwnProperty(e)&&!t.hasOwnProperty(e)&&(t[e]=n[e])}function qn(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(qn).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const n=t.toString();if(null==n)return""+n;const e=n.indexOf("\n");return-1===e?n:n.substring(0,e)}function ul(t,n){return null==t||""===t?null===n?"":n:null==n||""===n?t:t+" "+n}const Fu=In({__forward_ref__:In});function Xn(t){return t.__forward_ref__=Xn,t.toString=function(){return qn(this())},t}function on(t){return wo(t)?t():t}function wo(t){return"function"==typeof t&&t.hasOwnProperty(Fu)&&t.__forward_ref__===Xn}class At extends Error{constructor(n,e){super(function dl(t,n){return`NG0${Math.abs(t)}${n?": "+n:""}`}(n,e)),this.code=n}}function nn(t){return"string"==typeof t?t:null==t?"":String(t)}function qi(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():nn(t)}function qe(t,n){const e=n?` in ${n}`:"";throw new At(-201,`No provider for ${qi(t)} found${e}`)}function ss(t,n){null==t&&function Jn(t,n,e,i){throw new Error(`ASSERTION ERROR: ${t}`+(null==i?"":` [Expected=> ${e} ${i} ${n} <=Actual]`))}(n,t,null,"!=")}function rn(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function os(t){return{providers:t.providers||[],imports:t.imports||[]}}function Sg(t){return Ov(t,Mf)||Ov(t,Bv)}function Ov(t,n){return t.hasOwnProperty(n)?t[n]:null}function Rv(t){return t&&(t.hasOwnProperty(Ig)||t.hasOwnProperty(OI))?t[Ig]:null}const Mf=In({\u0275prov:In}),Ig=In({\u0275inj:In}),Bv=In({ngInjectableDef:In}),OI=In({ngInjectorDef:In});var gn=(()=>((gn=gn||{})[gn.Default=0]="Default",gn[gn.Host=1]="Host",gn[gn.Self=2]="Self",gn[gn.SkipSelf=4]="SkipSelf",gn[gn.Optional=8]="Optional",gn))();let kg;function Ca(t){const n=kg;return kg=t,n}function Lv(t,n,e){const i=Sg(t);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:e&gn.Optional?null:void 0!==n?n:void qe(qn(t),"Injector")}function xa(t){return{toString:t}.toString()}var Qs=(()=>((Qs=Qs||{})[Qs.OnPush=0]="OnPush",Qs[Qs.Default=1]="Default",Qs))(),Js=(()=>{return(t=Js||(Js={}))[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",Js;var t})();const BI="undefined"!=typeof globalThis&&globalThis,LI="undefined"!=typeof window&&window,zI="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,si=BI||"undefined"!=typeof global&&global||LI||zI,ac={},ui=[],Df=In({\u0275cmp:In}),Mg=In({\u0275dir:In}),Dg=In({\u0275pipe:In}),zv=In({\u0275mod:In}),ea=In({\u0275fac:In}),Ou=In({__NG_ELEMENT_ID__:In});let jI=0;function Xt(t){return xa(()=>{const e={},i={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===Qs.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||ui,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||Js.Emulated,id:"c",styles:t.styles||ui,_:null,setInput:null,schemas:t.schemas||null,tView:null},r=t.directives,s=t.features,o=t.pipes;return i.id+=jI++,i.inputs=Vv(t.inputs,e),i.outputs=Vv(t.outputs),s&&s.forEach(a=>a(i)),i.directiveDefs=r?()=>("function"==typeof r?r():r).map(jv):null,i.pipeDefs=o?()=>("function"==typeof o?o():o).map(Hv):null,i})}function Ag(t,n,e){const i=t.\u0275cmp;i.directiveDefs=()=>n.map(jv),i.pipeDefs=()=>e.map(Hv)}function jv(t){return fr(t)||function wa(t){return t[Mg]||null}(t)}function Hv(t){return function fl(t){return t[Dg]||null}(t)}const Uv={};function Ss(t){return xa(()=>{const n={type:t.type,bootstrap:t.bootstrap||ui,declarations:t.declarations||ui,imports:t.imports||ui,exports:t.exports||ui,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&(Uv[t.id]=t.type),n})}function Vv(t,n){if(null==t)return ac;const e={};for(const i in t)if(t.hasOwnProperty(i)){let r=t[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),e[r]=i,n&&(n[r]=s)}return e}const Qt=Xt;function yr(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,onDestroy:t.type.prototype.ngOnDestroy||null}}function fr(t){return t[Df]||null}function Is(t,n){const e=t[zv]||null;if(!e&&!0===n)throw new Error(`Type ${qn(t)} does not have '\u0275mod' property.`);return e}function Eo(t){return Array.isArray(t)&&"object"==typeof t[1]}function to(t){return Array.isArray(t)&&!0===t[1]}function Fg(t){return 0!=(8&t.flags)}function Ff(t){return 2==(2&t.flags)}function Of(t){return 1==(1&t.flags)}function no(t){return null!==t.template}function qI(t){return 0!=(512&t[2])}function _l(t,n){return t.hasOwnProperty(ea)?t[ea]:null}class YI{constructor(n,e,i){this.previousValue=n,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}}function io(){return qv}function qv(t){return t.type.prototype.ngOnChanges&&(t.setInput=XI),ZI}function ZI(){const t=Kv(this),n=null==t?void 0:t.current;if(n){const e=t.previous;if(e===ac)t.previous=n;else for(let i in n)e[i]=n[i];t.current=null,this.ngOnChanges(n)}}function XI(t,n,e,i){const r=Kv(t)||function QI(t,n){return t[Wv]=n}(t,{previous:ac,current:null}),s=r.current||(r.current={}),o=r.previous,a=this.declaredInputs[e],h=o[a];s[a]=new YI(h&&h.currentValue,n,o===ac),t[i]=n}io.ngInherit=!0;const Wv="__ngSimpleChanges__";function Kv(t){return t[Wv]||null}let zg;function jg(){return void 0!==zg?zg:"undefined"!=typeof document?document:void 0}function Pi(t){return!!t.listen}const Yv={createRenderer:(t,n)=>jg()};function zi(t){for(;Array.isArray(t);)t=t[0];return t}function Rf(t,n){return zi(n[t])}function ls(t,n){return zi(n[t.index])}function Hg(t,n){return t.data[n]}function fc(t,n){return t[n]}function cs(t,n){const e=n[t];return Eo(e)?e:e[0]}function Zv(t){return 4==(4&t[2])}function Ug(t){return 128==(128&t[2])}function Ea(t,n){return null==n?null:t[n]}function Xv(t){t[18]=0}function Vg(t,n){t[5]+=n;let e=t,i=t[3];for(;null!==i&&(1===n&&1===e[5]||-1===n&&0===e[5]);)i[5]+=n,e=i,i=i[3]}const hn={lFrame:o1(null),bindingsEnabled:!0};function Jv(){return hn.bindingsEnabled}function $t(){return hn.lFrame.lView}function Hn(){return hn.lFrame.tView}function Oe(t){return hn.lFrame.contextLView=t,t[8]}function Wi(){let t=e1();for(;null!==t&&64===t.type;)t=t.parent;return t}function e1(){return hn.lFrame.currentTNode}function To(t,n){const e=hn.lFrame;e.currentTNode=t,e.isParent=n}function Gg(){return hn.lFrame.isParent}function qg(){hn.lFrame.isParent=!1}function Or(){const t=hn.lFrame;let n=t.bindingRootIndex;return-1===n&&(n=t.bindingRootIndex=t.tView.bindingStartIndex),n}function hc(){return hn.lFrame.bindingIndex++}function na(t){const n=hn.lFrame,e=n.bindingIndex;return n.bindingIndex=n.bindingIndex+t,e}function gk(t,n){const e=hn.lFrame;e.bindingIndex=e.bindingRootIndex=t,Wg(n)}function Wg(t){hn.lFrame.currentDirectiveIndex=t}function i1(){return hn.lFrame.currentQueryIndex}function Yg(t){hn.lFrame.currentQueryIndex=t}function mk(t){const n=t[1];return 2===n.type?n.declTNode:1===n.type?t[6]:null}function r1(t,n,e){if(e&gn.SkipSelf){let r=n,s=t;for(;!(r=r.parent,null!==r||e&gn.Host||(r=mk(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;n=r,t=s}const i=hn.lFrame=s1();return i.currentTNode=n,i.lView=t,!0}function Lf(t){const n=s1(),e=t[1];hn.lFrame=n,n.currentTNode=e.firstChild,n.lView=t,n.tView=e,n.contextLView=t,n.bindingIndex=e.bindingStartIndex,n.inI18n=!1}function s1(){const t=hn.lFrame,n=null===t?null:t.child;return null===n?o1(t):n}function o1(t){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=n),n}function a1(){const t=hn.lFrame;return hn.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const l1=a1;function zf(){const t=a1();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function Rr(){return hn.lFrame.selectedIndex}function Ta(t){hn.lFrame.selectedIndex=t}function Ii(){const t=hn.lFrame;return Hg(t.tView,t.selectedIndex)}function jf(t,n){for(let e=n.directiveStart,i=n.directiveEnd;e<i;e++){const s=t.data[e].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:h,ngAfterViewChecked:w,ngOnDestroy:X}=s;o&&(t.contentHooks||(t.contentHooks=[])).push(-e,o),a&&((t.contentHooks||(t.contentHooks=[])).push(e,a),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(e,a)),h&&(t.viewHooks||(t.viewHooks=[])).push(-e,h),w&&((t.viewHooks||(t.viewHooks=[])).push(e,w),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(e,w)),null!=X&&(t.destroyHooks||(t.destroyHooks=[])).push(e,X)}}function Hf(t,n,e){c1(t,n,3,e)}function Uf(t,n,e,i){(3&t[2])===e&&c1(t,n,e,i)}function Zg(t,n){let e=t[2];(3&e)===n&&(e&=2047,e+=1,t[2]=e)}function c1(t,n,e,i){const s=null!=i?i:-1,o=n.length-1;let a=0;for(let h=void 0!==i?65535&t[18]:0;h<o;h++)if("number"==typeof n[h+1]){if(a=n[h],null!=i&&a>=i)break}else n[h]<0&&(t[18]+=65536),(a<s||-1==s)&&(Tk(t,e,n,h),t[18]=(4294901760&t[18])+h+2),h++}function Tk(t,n,e,i){const r=e[i]<0,s=e[i+1],a=t[r?-e[i]:e[i]];if(r){if(t[2]>>11<t[18]>>16&&(3&t[2])===n){t[2]+=2048;try{s.call(a)}finally{}}}else try{s.call(a)}finally{}}class ju{constructor(n,e,i){this.factory=n,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=i}}function Vf(t,n,e){const i=Pi(t);let r=0;for(;r<e.length;){const s=e[r];if("number"==typeof s){if(0!==s)break;r++;const o=e[r++],a=e[r++],h=e[r++];i?t.setAttribute(n,a,h,o):n.setAttributeNS(o,a,h)}else{const o=s,a=e[++r];Qg(o)?i&&t.setProperty(n,o,a):i?t.setAttribute(n,o,a):n.setAttribute(o,a),r++}}return r}function u1(t){return 3===t||4===t||6===t}function Qg(t){return 64===t.charCodeAt(0)}function Gf(t,n){if(null!==n&&0!==n.length)if(null===t||0===t.length)t=n.slice();else{let e=-1;for(let i=0;i<n.length;i++){const r=n[i];"number"==typeof r?e=r:0===e||d1(t,e,r,null,-1===e||2===e?n[++i]:null)}}return t}function d1(t,n,e,i,r){let s=0,o=t.length;if(-1===n)o=-1;else for(;s<t.length;){const a=t[s++];if("number"==typeof a){if(a===n){o=-1;break}if(a>n){o=s-1;break}}}for(;s<t.length;){const a=t[s];if("number"==typeof a)break;if(a===e){if(null===i)return void(null!==r&&(t[s+1]=r));if(i===t[s+1])return void(t[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(t.splice(o,0,n),s=o+1),t.splice(s++,0,e),null!==i&&t.splice(s++,0,i),null!==r&&t.splice(s++,0,r)}function f1(t){return-1!==t}function pc(t){return 32767&t}function gc(t,n){let e=function Dk(t){return t>>16}(t),i=n;for(;e>0;)i=i[15],e--;return i}let Jg=!0;function qf(t){const n=Jg;return Jg=t,n}let Ak=0;function Uu(t,n){const e=t_(t,n);if(-1!==e)return e;const i=n[1];i.firstCreatePass&&(t.injectorIndex=n.length,e_(i.data,t),e_(n,null),e_(i.blueprint,null));const r=Wf(t,n),s=t.injectorIndex;if(f1(r)){const o=pc(r),a=gc(r,n),h=a[1].data;for(let w=0;w<8;w++)n[s+w]=a[o+w]|h[o+w]}return n[s+8]=r,s}function e_(t,n){t.push(0,0,0,0,0,0,0,0,n)}function t_(t,n){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===n[t.injectorIndex+8]?-1:t.injectorIndex}function Wf(t,n){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let e=0,i=null,r=n;for(;null!==r;){const s=r[1],o=s.type;if(i=2===o?s.declTNode:1===o?r[6]:null,null===i)return-1;if(e++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|e<<16}return-1}function Kf(t,n,e){!function Pk(t,n,e){let i;"string"==typeof e?i=e.charCodeAt(0)||0:e.hasOwnProperty(Ou)&&(i=e[Ou]),null==i&&(i=e[Ou]=Ak++);const r=255&i;n.data[t+(r>>5)]|=1<<r}(t,n,e)}function g1(t,n,e){if(e&gn.Optional)return t;qe(n,"NodeInjector")}function _1(t,n,e,i){if(e&gn.Optional&&void 0===i&&(i=null),0==(e&(gn.Self|gn.Host))){const r=t[9],s=Ca(void 0);try{return r?r.get(n,i,e&gn.Optional):Lv(n,i,e&gn.Optional)}finally{Ca(s)}}return g1(i,n,e)}function m1(t,n,e,i=gn.Default,r){if(null!==t){const s=function Rk(t){if("string"==typeof t)return t.charCodeAt(0)||0;const n=t.hasOwnProperty(Ou)?t[Ou]:void 0;return"number"==typeof n?n>=0?255&n:Fk:n}(e);if("function"==typeof s){if(!r1(n,t,i))return i&gn.Host?g1(r,e,i):_1(n,e,i,r);try{const o=s(i);if(null!=o||i&gn.Optional)return o;qe(e)}finally{l1()}}else if("number"==typeof s){let o=null,a=t_(t,n),h=-1,w=i&gn.Host?n[16][6]:null;for((-1===a||i&gn.SkipSelf)&&(h=-1===a?Wf(t,n):n[a+8],-1!==h&&b1(i,!1)?(o=n[1],a=pc(h),n=gc(h,n)):a=-1);-1!==a;){const X=n[1];if(v1(s,a,X.data)){const fe=Ok(a,n,e,o,i,w);if(fe!==$1)return fe}h=n[a+8],-1!==h&&b1(i,n[1].data[a+8]===w)&&v1(s,a,n)?(o=X,a=pc(h),n=gc(h,n)):a=-1}}}return _1(n,e,i,r)}const $1={};function Fk(){return new _c(Wi(),$t())}function Ok(t,n,e,i,r,s){const o=n[1],a=o.data[t+8],X=Yf(a,o,e,null==i?Ff(a)&&Jg:i!=o&&0!=(3&a.type),r&gn.Host&&s===a);return null!==X?Vu(n,o,X,a):$1}function Yf(t,n,e,i,r){const s=t.providerIndexes,o=n.data,a=1048575&s,h=t.directiveStart,X=s>>20,pe=r?a+X:t.directiveEnd;for(let we=i?a:a+X;we<pe;we++){const Ie=o[we];if(we<h&&e===Ie||we>=h&&Ie.type===e)return we}if(r){const we=o[h];if(we&&no(we)&&we.type===e)return h}return null}function Vu(t,n,e,i){let r=t[e];const s=n.data;if(function Sk(t){return t instanceof ju}(r)){const o=r;o.resolving&&function Tg(t,n){const e=n?`. Dependency path: ${n.join(" > ")} > ${t}`:"";throw new At(-200,`Circular dependency in DI detected for ${t}${e}`)}(qi(s[e]));const a=qf(o.canSeeViewProviders);o.resolving=!0;const h=o.injectImpl?Ca(o.injectImpl):null;r1(t,i,gn.Default);try{r=t[e]=o.factory(void 0,s,t,i),n.firstCreatePass&&e>=i.directiveStart&&function Ek(t,n,e){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=n.type.prototype;if(i){const o=qv(n);(e.preOrderHooks||(e.preOrderHooks=[])).push(t,o),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(t,o)}r&&(e.preOrderHooks||(e.preOrderHooks=[])).push(0-t,r),s&&((e.preOrderHooks||(e.preOrderHooks=[])).push(t,s),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(t,s))}(e,s[e],n)}finally{null!==h&&Ca(h),qf(a),o.resolving=!1,l1()}}return r}function v1(t,n,e){return!!(e[n+(t>>5)]&1<<t)}function b1(t,n){return!(t&gn.Self||t&gn.Host&&n)}class _c{constructor(n,e){this._tNode=n,this._lView=e}get(n,e,i){return m1(this._tNode,this._lView,n,i,e)}}function xr(t){return xa(()=>{const n=t.prototype.constructor,e=n[ea]||n_(n),i=Object.prototype;let r=Object.getPrototypeOf(t.prototype).constructor;for(;r&&r!==i;){const s=r[ea]||n_(r);if(s&&s!==e)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function n_(t){return wo(t)?()=>{const n=n_(on(t));return n&&n()}:_l(t)}const $c="__parameters__";function bc(t,n,e){return xa(()=>{const i=function r_(t){return function(...e){if(t){const i=t(...e);for(const r in i)this[r]=i[r]}}}(n);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return a.annotation=o,a;function a(h,w,X){const fe=h.hasOwnProperty($c)?h[$c]:Object.defineProperty(h,$c,{value:[]})[$c];for(;fe.length<=X;)fe.push(null);return(fe[X]=fe[X]||[]).push(o),h}}return e&&(r.prototype=Object.create(e.prototype)),r.prototype.ngMetadataName=t,r.annotationCls=r,r})}class On{constructor(n,e){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=rn({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return`InjectionToken ${this._desc}`}}function Ds(t,n){void 0===n&&(n=t);for(let e=0;e<t.length;e++){let i=t[e];Array.isArray(i)?(n===t&&(n=t.slice(0,e)),Ds(i,n)):n!==t&&n.push(i)}return n}function So(t,n){t.forEach(e=>Array.isArray(e)?So(e,n):n(e))}function C1(t,n,e){n>=t.length?t.push(e):t.splice(n,0,e)}function Zf(t,n){return n>=t.length-1?t.pop():t.splice(n,1)[0]}function Wu(t,n){const e=[];for(let i=0;i<t;i++)e.push(n);return e}function us(t,n,e){let i=yc(t,n);return i>=0?t[1|i]=e:(i=~i,function jk(t,n,e,i){let r=t.length;if(r==n)t.push(e,i);else if(1===r)t.push(i,t[0]),t[0]=e;else{for(r--,t.push(t[r-1],t[r]);r>n;)t[r]=t[r-2],r--;t[n]=e,t[n+1]=i}}(t,i,n,e)),i}function o_(t,n){const e=yc(t,n);if(e>=0)return t[1|e]}function yc(t,n){return function E1(t,n,e){let i=0,r=t.length>>e;for(;r!==i;){const s=i+(r-i>>1),o=t[s<<e];if(n===o)return s<<e;o>n?r=s:i=s+1}return~(r<<e)}(t,n,1)}const Ku={},l_="__NG_DI_FLAG__",Qf="ngTempTokenPath",Kk=/\n/gm,S1="__source",Zk=In({provide:String,useValue:In});let Yu;function I1(t){const n=Yu;return Yu=t,n}function Xk(t,n=gn.Default){if(void 0===Yu)throw new At(203,"");return null===Yu?Lv(t,void 0,n):Yu.get(t,n&gn.Optional?null:void 0,n)}function an(t,n=gn.Default){return(function RI(){return kg}()||Xk)(on(t),n)}const Qk=an;function c_(t){const n=[];for(let e=0;e<t.length;e++){const i=on(t[e]);if(Array.isArray(i)){if(0===i.length)throw new At(900,"");let r,s=gn.Default;for(let o=0;o<i.length;o++){const a=i[o],h=Jk(a);"number"==typeof h?-1===h?r=a.token:s|=h:r=a}n.push(an(r,s))}else n.push(an(i))}return n}function Zu(t,n){return t[l_]=n,t.prototype[l_]=n,t}function Jk(t){return t[l_]}const Jf=Zu(bc("Optional"),8),eh=Zu(bc("SkipSelf"),4);var ds=(()=>((ds=ds||{})[ds.Important=1]="Important",ds[ds.DashCase=2]="DashCase",ds))();const O1="__ngContext__";function wr(t,n){t[O1]=n}function h_(t){const n=function Qu(t){return t[O1]||null}(t);return n?Array.isArray(n)?n:n.lView:null}function g_(t,n){return undefined(t,n)}function Ju(t){const n=t[3];return to(n)?n[3]:n}function __(t){return U1(t[13])}function m_(t){return U1(t[4])}function U1(t){for(;null!==t&&!to(t);)t=t[4];return t}function xc(t,n,e,i,r){if(null!=i){let s,o=!1;to(i)?s=i:Eo(i)&&(o=!0,i=i[0]);const a=zi(i);0===t&&null!==e?null==r?Y1(n,e,a):ml(n,e,a,r||null,!0):1===t&&null!==e?ml(n,e,a,r||null,!0):2===t?function w_(t,n,e){const i=nh(t,n);i&&function MM(t,n,e,i){Pi(t)?t.removeChild(n,e,i):n.removeChild(e)}(t,i,n,e)}(n,a,o):3===t&&n.destroyNode(a),null!=s&&function PM(t,n,e,i,r){const s=e[7];s!==zi(e)&&xc(n,t,i,s,r);for(let a=10;a<e.length;a++){const h=e[a];ed(h[1],h,t,n,i,s)}}(n,t,s,e,r)}}function v_(t,n,e){if(Pi(t))return t.createElement(n,e);{const i=null!==e?function nk(t){const n=t.toLowerCase();return"svg"===n?"http://www.w3.org/2000/svg":"math"===n?"http://www.w3.org/1998/MathML/":null}(e):null;return null===i?t.createElement(n):t.createElementNS(i,n)}}function G1(t,n){const e=t[9],i=e.indexOf(n),r=n[3];1024&n[2]&&(n[2]&=-1025,Vg(r,-1)),e.splice(i,1)}function b_(t,n){if(t.length<=10)return;const e=10+n,i=t[e];if(i){const r=i[17];null!==r&&r!==t&&G1(r,i),n>0&&(t[e-1][4]=i[4]);const s=Zf(t,10+n);!function CM(t,n){ed(t,n,n[11],2,null,null),n[0]=null,n[6]=null}(i[1],i);const o=s[19];null!==o&&o.detachView(s[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function q1(t,n){if(!(256&n[2])){const e=n[11];Pi(e)&&e.destroyNode&&ed(t,n,e,3,null,null),function EM(t){let n=t[13];if(!n)return y_(t[1],t);for(;n;){let e=null;if(Eo(n))e=n[13];else{const i=n[10];i&&(e=i)}if(!e){for(;n&&!n[4]&&n!==t;)Eo(n)&&y_(n[1],n),n=n[3];null===n&&(n=t),Eo(n)&&y_(n[1],n),e=n&&n[4]}n=e}}(n)}}function y_(t,n){if(!(256&n[2])){n[2]&=-129,n[2]|=256,function kM(t,n){let e;if(null!=t&&null!=(e=t.destroyHooks))for(let i=0;i<e.length;i+=2){const r=n[e[i]];if(!(r instanceof ju)){const s=e[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=r[s[o]],h=s[o+1];try{h.call(a)}finally{}}else try{s.call(r)}finally{}}}}(t,n),function IM(t,n){const e=t.cleanup,i=n[7];let r=-1;if(null!==e)for(let s=0;s<e.length-1;s+=2)if("string"==typeof e[s]){const o=e[s+1],a="function"==typeof o?o(n):zi(n[o]),h=i[r=e[s+2]],w=e[s+3];"boolean"==typeof w?a.removeEventListener(e[s],h,w):w>=0?i[r=w]():i[r=-w].unsubscribe(),s+=2}else{const o=i[r=e[s+1]];e[s].call(o)}if(null!==i){for(let s=r+1;s<i.length;s++)i[s]();n[7]=null}}(t,n),1===n[1].type&&Pi(n[11])&&n[11].destroy();const e=n[17];if(null!==e&&to(n[3])){e!==n[3]&&G1(e,n);const i=n[19];null!==i&&i.detachView(t)}}}function W1(t,n,e){return function K1(t,n,e){let i=n;for(;null!==i&&40&i.type;)i=(n=i).parent;if(null===i)return e[0];if(2&i.flags){const r=t.data[i.directiveStart].encapsulation;if(r===Js.None||r===Js.Emulated)return null}return ls(i,e)}(t,n.parent,e)}function ml(t,n,e,i,r){Pi(t)?t.insertBefore(n,e,i,r):n.insertBefore(e,i,r)}function Y1(t,n,e){Pi(t)?t.appendChild(n,e):n.appendChild(e)}function Z1(t,n,e,i,r){null!==i?ml(t,n,e,i,r):Y1(t,n,e)}function nh(t,n){return Pi(t)?t.parentNode(n):n.parentNode}function X1(t,n,e){return J1(t,n,e)}let sh,oh,J1=function Q1(t,n,e){return 40&t.type?ls(t,e):null};function ih(t,n,e,i){const r=W1(t,i,n),s=n[11],a=X1(i.parent||n[6],i,n);if(null!=r)if(Array.isArray(e))for(let h=0;h<e.length;h++)Z1(s,r,e[h],a,!1);else Z1(s,r,e,a,!1)}function rh(t,n){if(null!==n){const e=n.type;if(3&e)return ls(n,t);if(4&e)return x_(-1,t[n.index]);if(8&e){const i=n.child;if(null!==i)return rh(t,i);{const r=t[n.index];return to(r)?x_(-1,r):zi(r)}}if(32&e)return g_(n,t)()||zi(t[n.index]);{const i=tb(t,n);return null!==i?Array.isArray(i)?i[0]:rh(Ju(t[16]),i):rh(t,n.next)}}return null}function tb(t,n){return null!==n?t[16][6].projection[n.projection]:null}function x_(t,n){const e=10+t+1;if(e<n.length){const i=n[e],r=i[1].firstChild;if(null!==r)return rh(i,r)}return n[7]}function E_(t,n,e,i,r,s,o){for(;null!=e;){const a=i[e.index],h=e.type;if(o&&0===n&&(a&&wr(zi(a),i),e.flags|=4),64!=(64&e.flags))if(8&h)E_(t,n,e.child,i,r,s,!1),xc(n,t,r,a,s);else if(32&h){const w=g_(e,i);let X;for(;X=w();)xc(n,t,r,X,s);xc(n,t,r,a,s)}else 16&h?nb(t,n,i,e,r,s):xc(n,t,r,a,s);e=o?e.projectionNext:e.next}}function ed(t,n,e,i,r,s){E_(e,i,t.firstChild,n,r,s,!1)}function nb(t,n,e,i,r,s){const o=e[16],h=o[6].projection[i.projection];if(Array.isArray(h))for(let w=0;w<h.length;w++)xc(n,t,r,h[w],s);else E_(t,n,h,o[3],r,s,!0)}function ib(t,n,e){Pi(t)?t.setAttribute(n,"style",e):n.style.cssText=e}function T_(t,n,e){Pi(t)?""===e?t.removeAttribute(n,"class"):t.setAttribute(n,"class",e):n.className=e}function $l(t){var n;return(null===(n=function S_(){if(void 0===sh&&(sh=null,si.trustedTypes))try{sh=si.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch(t){}return sh}())||void 0===n?void 0:n.createHTML(t))||t}function rb(t){var n;return(null===(n=function I_(){if(void 0===oh&&(oh=null,si.trustedTypes))try{oh=si.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch(t){}return oh}())||void 0===n?void 0:n.createHTML(t))||t}class vl{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class BM extends vl{getTypeName(){return"HTML"}}class LM extends vl{getTypeName(){return"Style"}}class zM extends vl{getTypeName(){return"Script"}}class jM extends vl{getTypeName(){return"URL"}}class HM extends vl{getTypeName(){return"ResourceURL"}}function fs(t){return t instanceof vl?t.changingThisBreaksApplicationSecurity:t}function Io(t,n){const e=ab(t);if(null!=e&&e!==n){if("ResourceURL"===e&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${e} (see https://g.co/ng/security#xss)`)}return e===n}function ab(t){return t instanceof vl&&t.getTypeName()||null}class KM{constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{const e=(new window.DOMParser).parseFromString($l(n),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(n):(e.removeChild(e.firstChild),e)}catch(e){return null}}}class YM{constructor(n){if(this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e);const i=this.inertDocument.createElement("body");e.appendChild(i)}}getInertBodyElement(n){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=$l(n),e;const i=this.inertDocument.createElement("body");return i.innerHTML=$l(n),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(i),i}stripCustomNsAttrs(n){const e=n.attributes;for(let r=e.length-1;0<r;r--){const o=e.item(r).name;("xmlns:ns1"===o||0===o.indexOf("ns1:"))&&n.removeAttribute(o)}let i=n.firstChild;for(;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}const XM=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,QM=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function td(t){return(t=String(t)).match(XM)||t.match(QM)?t:"unsafe:"+t}function cb(t){return(t=String(t)).split(",").map(n=>td(n.trim())).join(", ")}function ko(t){const n={};for(const e of t.split(","))n[e]=!0;return n}function nd(...t){const n={};for(const e of t)for(const i in e)e.hasOwnProperty(i)&&(n[i]=!0);return n}const ub=ko("area,br,col,hr,img,wbr"),db=ko("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),fb=ko("rp,rt"),k_=nd(ub,nd(db,ko("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),nd(fb,ko("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),nd(fb,db)),M_=ko("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),D_=ko("srcset"),hb=nd(M_,D_,ko("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),ko("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),JM=ko("script,style,template");class eD{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(n){let e=n.firstChild,i=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?i=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,i&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let r=this.checkClobberedElement(e,e.nextSibling);if(r){e=r;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(n){const e=n.nodeName.toLowerCase();if(!k_.hasOwnProperty(e))return this.sanitizedSomething=!0,!JM.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const i=n.attributes;for(let r=0;r<i.length;r++){const s=i.item(r),o=s.name,a=o.toLowerCase();if(!hb.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let h=s.value;M_[a]&&(h=td(h)),D_[a]&&(h=cb(h)),this.buf.push(" ",o,'="',pb(h),'"')}return this.buf.push(">"),!0}endElement(n){const e=n.nodeName.toLowerCase();k_.hasOwnProperty(e)&&!ub.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(n){this.buf.push(pb(n))}checkClobberedElement(n,e){if(e&&(n.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${n.outerHTML}`);return e}}const tD=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,nD=/([^\#-~ |!])/g;function pb(t){return t.replace(/&/g,"&amp;").replace(tD,function(n){return"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";"}).replace(nD,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let ah;function gb(t,n){let e=null;try{ah=ah||function lb(t){const n=new YM(t);return function ZM(){try{return!!(new window.DOMParser).parseFromString($l(""),"text/html")}catch(t){return!1}}()?new KM(n):n}(t);let i=n?String(n):"";e=ah.getInertBodyElement(i);let r=5,s=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=s,s=e.innerHTML,e=ah.getInertBodyElement(i)}while(i!==s);return $l((new eD).sanitizeChildren(A_(e)||e))}finally{if(e){const i=A_(e)||e;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function A_(t){return"content"in t&&function iD(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var pi=(()=>((pi=pi||{})[pi.NONE=0]="NONE",pi[pi.HTML=1]="HTML",pi[pi.STYLE=2]="STYLE",pi[pi.SCRIPT=3]="SCRIPT",pi[pi.URL=4]="URL",pi[pi.RESOURCE_URL=5]="RESOURCE_URL",pi))();function Yi(t){const n=id();return n?rb(n.sanitize(pi.HTML,t)||""):Io(t,"HTML")?rb(fs(t)):gb(jg(),nn(t))}function en(t){const n=id();return n?n.sanitize(pi.URL,t)||"":Io(t,"URL")?fs(t):td(nn(t))}function id(){const t=$t();return t&&t[12]}function N_(t){return t.ngOriginalError}function hD(t,...n){t.error(...n)}class rd{constructor(){this._console=console}handleError(n){const e=this._findOriginalError(n),i=function fD(t){return t&&t.ngErrorLogger||hD}(n);i(this._console,"ERROR",n),e&&i(this._console,"ORIGINAL ERROR",e)}_findOriginalError(n){let e=n&&N_(n);for(;e&&N_(e);)e=N_(e);return e||null}}const bD=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(si))();function lh(t){return t.ownerDocument}function Mo(t){return t instanceof Function?t():t}function $b(t,n,e){let i=t.length;for(;;){const r=t.indexOf(n,e);if(-1===r)return r;if(0===r||t.charCodeAt(r-1)<=32){const s=n.length;if(r+s===i||t.charCodeAt(r+s)<=32)return r}e=r+1}}const vb="ng-template";function xD(t,n,e){let i=0;for(;i<t.length;){let r=t[i++];if(e&&"class"===r){if(r=t[i],-1!==$b(r.toLowerCase(),n,0))return!0}else if(1===r){for(;i<t.length&&"string"==typeof(r=t[i++]);)if(r.toLowerCase()===n)return!0;return!1}}return!1}function bb(t){return 4===t.type&&t.value!==vb}function wD(t,n,e){return n===(4!==t.type||e?t.value:vb)}function ED(t,n,e){let i=4;const r=t.attrs||[],s=function ID(t){for(let n=0;n<t.length;n++)if(u1(t[n]))return n;return t.length}(r);let o=!1;for(let a=0;a<n.length;a++){const h=n[a];if("number"!=typeof h){if(!o)if(4&i){if(i=2|1&i,""!==h&&!wD(t,h,e)||""===h&&1===n.length){if(ro(i))return!1;o=!0}}else{const w=8&i?h:n[++a];if(8&i&&null!==t.attrs){if(!xD(t.attrs,w,e)){if(ro(i))return!1;o=!0}continue}const fe=TD(8&i?"class":h,r,bb(t),e);if(-1===fe){if(ro(i))return!1;o=!0;continue}if(""!==w){let pe;pe=fe>s?"":r[fe+1].toLowerCase();const we=8&i?pe:null;if(we&&-1!==$b(we,w,0)||2&i&&w!==pe){if(ro(i))return!1;o=!0}}}}else{if(!o&&!ro(i)&&!ro(h))return!1;if(o&&ro(h))continue;o=!1,i=h|1&i}}return ro(i)||o}function ro(t){return 0==(1&t)}function TD(t,n,e,i){if(null===n)return-1;let r=0;if(i||!e){let s=!1;for(;r<n.length;){const o=n[r];if(o===t)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=n[++r];for(;"string"==typeof a;)a=n[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function kD(t,n){let e=t.indexOf(4);if(e>-1)for(e++;e<t.length;){const i=t[e];if("number"==typeof i)return-1;if(i===n)return e;e++}return-1}(n,t)}function yb(t,n,e=!1){for(let i=0;i<n.length;i++)if(ED(t,n[i],e))return!0;return!1}function MD(t,n){e:for(let e=0;e<n.length;e++){const i=n[e];if(t.length===i.length){for(let r=0;r<t.length;r++)if(t[r]!==i[r])continue e;return!0}}return!1}function Cb(t,n){return t?":not("+n.trim()+")":n}function DD(t){let n=t[0],e=1,i=2,r="",s=!1;for(;e<t.length;){let o=t[e];if("string"==typeof o)if(2&i){const a=t[++e];r+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!ro(o)&&(n+=Cb(s,r),r=""),i=o,s=s||!ro(i);e++}return""!==r&&(n+=Cb(s,r)),n}const pn={};function U(t){xb(Hn(),$t(),Rr()+t,!1)}function xb(t,n,e,i){if(!i)if(3==(3&n[2])){const s=t.preOrderCheckHooks;null!==s&&Hf(n,s,e)}else{const s=t.preOrderHooks;null!==s&&Uf(n,s,0,e)}Ta(e)}function ch(t,n){return t<<17|n<<2}function so(t){return t>>17&32767}function F_(t){return 2|t}function ia(t){return(131068&t)>>2}function O_(t,n){return-131069&t|n<<2}function R_(t){return 1|t}function Nb(t,n){const e=t.contentQueries;if(null!==e)for(let i=0;i<e.length;i+=2){const r=e[i],s=e[i+1];if(-1!==s){const o=t.data[s];Yg(r),o.contentQueries(2,n[s],s)}}}function sd(t,n,e,i,r,s,o,a,h,w){const X=n.blueprint.slice();return X[0]=r,X[2]=140|i,Xv(X),X[3]=X[15]=t,X[8]=e,X[10]=o||t&&t[10],X[11]=a||t&&t[11],X[12]=h||t&&t[12]||null,X[9]=w||t&&t[9]||null,X[6]=s,X[16]=2==n.type?t[16]:X,X}function Ec(t,n,e,i,r){let s=t.data[n];if(null===s)s=function q_(t,n,e,i,r){const s=e1(),o=Gg(),h=t.data[n]=function YD(t,n,e,i,r,s){return{type:e,index:i,insertBeforeIndex:null,injectorIndex:n?n.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,e,n,i,r);return null===t.firstChild&&(t.firstChild=h),null!==s&&(o?null==s.child&&null!==h.parent&&(s.child=h):null===s.next&&(s.next=h)),h}(t,n,e,i,r),function pk(){return hn.lFrame.inI18n}()&&(s.flags|=64);else if(64&s.type){s.type=e,s.value=i,s.attrs=r;const o=function zu(){const t=hn.lFrame,n=t.currentTNode;return t.isParent?n:n.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return To(s,!0),s}function Tc(t,n,e,i){if(0===e)return-1;const r=n.length;for(let s=0;s<e;s++)n.push(i),t.blueprint.push(i),t.data.push(null);return r}function od(t,n,e){Lf(n);try{const i=t.viewQuery;null!==i&&tm(1,i,e);const r=t.template;null!==r&&Fb(t,n,r,1,e),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&Nb(t,n),t.staticViewQueries&&tm(2,t.viewQuery,e);const s=t.components;null!==s&&function qD(t,n){for(let e=0;e<n.length;e++)hA(t,n[e])}(n,s)}catch(i){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),i}finally{n[2]&=-5,zf()}}function Sc(t,n,e,i){const r=n[2];if(256!=(256&r)){Lf(n);try{Xv(n),function t1(t){return hn.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==e&&Fb(t,n,e,2,i);const o=3==(3&r);if(o){const w=t.preOrderCheckHooks;null!==w&&Hf(n,w,null)}else{const w=t.preOrderHooks;null!==w&&Uf(n,w,0,null),Zg(n,0)}if(function dA(t){for(let n=__(t);null!==n;n=m_(n)){if(!n[2])continue;const e=n[9];for(let i=0;i<e.length;i++){const r=e[i],s=r[3];0==(1024&r[2])&&Vg(s,1),r[2]|=1024}}}(n),function uA(t){for(let n=__(t);null!==n;n=m_(n))for(let e=10;e<n.length;e++){const i=n[e],r=i[1];Ug(i)&&Sc(r,i,r.template,i[8])}}(n),null!==t.contentQueries&&Nb(t,n),o){const w=t.contentCheckHooks;null!==w&&Hf(n,w)}else{const w=t.contentHooks;null!==w&&Uf(n,w,1),Zg(n,1)}!function VD(t,n){const e=t.hostBindingOpCodes;if(null!==e)try{for(let i=0;i<e.length;i++){const r=e[i];if(r<0)Ta(~r);else{const s=r,o=e[++i],a=e[++i];gk(o,s),a(2,n[s])}}}finally{Ta(-1)}}(t,n);const a=t.components;null!==a&&function GD(t,n){for(let e=0;e<n.length;e++)fA(t,n[e])}(n,a);const h=t.viewQuery;if(null!==h&&tm(2,h,i),o){const w=t.viewCheckHooks;null!==w&&Hf(n,w)}else{const w=t.viewHooks;null!==w&&Uf(n,w,2),Zg(n,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),n[2]&=-73,1024&n[2]&&(n[2]&=-1025,Vg(n[3],-1))}finally{zf()}}}function WD(t,n,e,i){const r=n[10],o=Zv(n);try{!o&&r.begin&&r.begin(),o&&od(t,n,i),Sc(t,n,e,i)}finally{!o&&r.end&&r.end()}}function Fb(t,n,e,i,r){const s=Rr(),o=2&i;try{Ta(-1),o&&n.length>20&&xb(t,n,20,!1),e(i,r)}finally{Ta(s)}}function Ob(t,n,e){if(Fg(n)){const r=n.directiveEnd;for(let s=n.directiveStart;s<r;s++){const o=t.data[s];o.contentQueries&&o.contentQueries(1,e[s],s)}}}function W_(t,n,e){!Jv()||(function nA(t,n,e,i){const r=e.directiveStart,s=e.directiveEnd;t.firstCreatePass||Uu(e,n),wr(i,n);const o=e.initialInputs;for(let a=r;a<s;a++){const h=t.data[a],w=no(h);w&&aA(n,e,h);const X=Vu(n,t,a,e);wr(X,n),null!==o&&lA(0,a-r,X,h,0,o),w&&(cs(e.index,n)[8]=X)}}(t,n,e,ls(e,n)),128==(128&e.flags)&&function iA(t,n,e){const i=e.directiveStart,r=e.directiveEnd,o=e.index,a=function _k(){return hn.lFrame.currentDirectiveIndex}();try{Ta(o);for(let h=i;h<r;h++){const w=t.data[h],X=n[h];Wg(h),(null!==w.hostBindings||0!==w.hostVars||null!==w.hostAttrs)&&Vb(w,X)}}finally{Ta(-1),Wg(a)}}(t,n,e))}function K_(t,n,e=ls){const i=n.localNames;if(null!==i){let r=n.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],a=-1===o?e(n,t):t[o];t[r++]=a}}}function Rb(t){const n=t.tView;return null===n||n.incompleteFirstPass?t.tView=fh(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):n}function fh(t,n,e,i,r,s,o,a,h,w){const X=20+i,fe=X+r,pe=function KD(t,n){const e=[];for(let i=0;i<n;i++)e.push(i<t?null:pn);return e}(X,fe),we="function"==typeof w?w():w;return pe[1]={type:t,blueprint:pe,template:e,queries:null,viewQuery:a,declTNode:n,data:pe.slice().fill(null,X),bindingStartIndex:X,expandoStartIndex:fe,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:h,consts:we,incompleteFirstPass:!1}}function zb(t,n,e,i){const r=Zb(n);null===e?r.push(i):(r.push(e),t.firstCreatePass&&Xb(t).push(i,r.length-1))}function jb(t,n,e){for(let i in t)if(t.hasOwnProperty(i)){const r=t[i];(e=null===e?{}:e).hasOwnProperty(i)?e[i].push(n,r):e[i]=[n,r]}return e}function hs(t,n,e,i,r,s,o,a){const h=ls(n,e);let X,w=n.inputs;!a&&null!=w&&(X=w[i])?(ey(t,e,X,i,r),Ff(n)&&function QD(t,n){const e=cs(n,t);16&e[2]||(e[2]|=64)}(e,n.index)):3&n.type&&(i=function XD(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(i),r=null!=o?o(r,n.value||"",i):r,Pi(s)?s.setProperty(h,i,r):Qg(i)||(h.setProperty?h.setProperty(i,r):h[i]=r))}function Y_(t,n,e,i){let r=!1;if(Jv()){const s=function rA(t,n,e){const i=t.directiveRegistry;let r=null;if(i)for(let s=0;s<i.length;s++){const o=i[s];yb(e,o.selectors,!1)&&(r||(r=[]),Kf(Uu(e,n),t,o.type),no(o)?(Gb(t,e),r.unshift(o)):r.push(o))}return r}(t,n,e),o=null===i?null:{"":-1};if(null!==s){r=!0,qb(e,t.data.length,s.length);for(let X=0;X<s.length;X++){const fe=s[X];fe.providersResolver&&fe.providersResolver(fe)}let a=!1,h=!1,w=Tc(t,n,s.length,null);for(let X=0;X<s.length;X++){const fe=s[X];e.mergedAttrs=Gf(e.mergedAttrs,fe.hostAttrs),Wb(t,e,n,w,fe),oA(w,fe,o),null!==fe.contentQueries&&(e.flags|=8),(null!==fe.hostBindings||null!==fe.hostAttrs||0!==fe.hostVars)&&(e.flags|=128);const pe=fe.type.prototype;!a&&(pe.ngOnChanges||pe.ngOnInit||pe.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(e.index),a=!0),!h&&(pe.ngOnChanges||pe.ngDoCheck)&&((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(e.index),h=!0),w++}!function ZD(t,n){const i=n.directiveEnd,r=t.data,s=n.attrs,o=[];let a=null,h=null;for(let w=n.directiveStart;w<i;w++){const X=r[w],fe=X.inputs,pe=null===s||bb(n)?null:cA(fe,s);o.push(pe),a=jb(fe,w,a),h=jb(X.outputs,w,h)}null!==a&&(a.hasOwnProperty("class")&&(n.flags|=16),a.hasOwnProperty("style")&&(n.flags|=32)),n.initialInputs=o,n.inputs=a,n.outputs=h}(t,e)}o&&function sA(t,n,e){if(n){const i=t.localNames=[];for(let r=0;r<n.length;r+=2){const s=e[n[r+1]];if(null==s)throw new At(-301,!1);i.push(n[r],s)}}}(e,i,o)}return e.mergedAttrs=Gf(e.mergedAttrs,e.attrs),r}function Ub(t,n,e,i,r,s){const o=s.hostBindings;if(o){let a=t.hostBindingOpCodes;null===a&&(a=t.hostBindingOpCodes=[]);const h=~n.index;(function tA(t){let n=t.length;for(;n>0;){const e=t[--n];if("number"==typeof e&&e<0)return e}return 0})(a)!=h&&a.push(h),a.push(i,r,o)}}function Vb(t,n){null!==t.hostBindings&&t.hostBindings(1,n)}function Gb(t,n){n.flags|=2,(t.components||(t.components=[])).push(n.index)}function oA(t,n,e){if(e){if(n.exportAs)for(let i=0;i<n.exportAs.length;i++)e[n.exportAs[i]]=t;no(n)&&(e[""]=t)}}function qb(t,n,e){t.flags|=1,t.directiveStart=n,t.directiveEnd=n+e,t.providerIndexes=n}function Wb(t,n,e,i,r){t.data[i]=r;const s=r.factory||(r.factory=_l(r.type)),o=new ju(s,no(r),null);t.blueprint[i]=o,e[i]=o,Ub(t,n,0,i,Tc(t,e,r.hostVars,pn),r)}function aA(t,n,e){const i=ls(n,t),r=Rb(e),s=t[10],o=hh(t,sd(t,r,null,e.onPush?64:16,i,n,s,s.createRenderer(i,e),null,null));t[n.index]=o}function Do(t,n,e,i,r,s){const o=ls(t,n);!function Z_(t,n,e,i,r,s,o){if(null==s)Pi(t)?t.removeAttribute(n,r,e):n.removeAttribute(r);else{const a=null==o?nn(s):o(s,i||"",r);Pi(t)?t.setAttribute(n,r,a,e):e?n.setAttributeNS(e,r,a):n.setAttribute(r,a)}}(n[11],o,s,t.value,e,i,r)}function lA(t,n,e,i,r,s){const o=s[n];if(null!==o){const a=i.setInput;for(let h=0;h<o.length;){const w=o[h++],X=o[h++],fe=o[h++];null!==a?i.setInput(e,fe,w,X):e[X]=fe}}}function cA(t,n){let e=null,i=0;for(;i<n.length;){const r=n[i];if(0!==r)if(5!==r){if("number"==typeof r)break;t.hasOwnProperty(r)&&(null===e&&(e=[]),e.push(r,t[r],n[i+1])),i+=2}else i+=2;else i+=4}return e}function Kb(t,n,e,i){return new Array(t,!0,!1,n,null,0,i,e,null,null)}function fA(t,n){const e=cs(n,t);if(Ug(e)){const i=e[1];80&e[2]?Sc(i,e,i.template,e[8]):e[5]>0&&X_(e)}}function X_(t){for(let i=__(t);null!==i;i=m_(i))for(let r=10;r<i.length;r++){const s=i[r];if(1024&s[2]){const o=s[1];Sc(o,s,o.template,s[8])}else s[5]>0&&X_(s)}const e=t[1].components;if(null!==e)for(let i=0;i<e.length;i++){const r=cs(e[i],t);Ug(r)&&r[5]>0&&X_(r)}}function hA(t,n){const e=cs(n,t),i=e[1];(function pA(t,n){for(let e=n.length;e<t.blueprint.length;e++)n.push(t.blueprint[e])})(i,e),od(i,e,e[8])}function hh(t,n){return t[13]?t[14][4]=n:t[13]=n,t[14]=n,n}function Q_(t){for(;t;){t[2]|=64;const n=Ju(t);if(qI(t)&&!n)return t;t=n}return null}function Yb(t){!function J_(t){for(let n=0;n<t.components.length;n++){const e=t.components[n],i=h_(e),r=i[1];WD(r,i,r.template,e)}}(t[8])}function tm(t,n,e){Yg(0),n(t,e)}const _A=(()=>Promise.resolve(null))();function Zb(t){return t[7]||(t[7]=[])}function Xb(t){return t.cleanup||(t.cleanup=[])}function Jb(t,n){const e=t[9],i=e?e.get(rd,null):null;i&&i.handleError(n)}function ey(t,n,e,i,r){for(let s=0;s<e.length;){const o=e[s++],a=e[s++],h=n[o],w=t.data[o];null!==w.setInput?w.setInput(h,r,i,a):h[a]=r}}function ra(t,n,e){const i=Rf(n,t);!function V1(t,n,e){Pi(t)?t.setValue(n,e):n.textContent=e}(t[11],i,e)}function ph(t,n,e){let i=e?t.styles:null,r=e?t.classes:null,s=0;if(null!==n)for(let o=0;o<n.length;o++){const a=n[o];"number"==typeof a?s=a:1==s?r=ul(r,a):2==s&&(i=ul(i,a+": "+n[++o]+";"))}e?t.styles=i:t.stylesWithoutHost=i,e?t.classes=r:t.classesWithoutHost=r}const nm=new On("INJECTOR",-1);class ty{get(n,e=Ku){if(e===Ku){const i=new Error(`NullInjectorError: No provider for ${qn(n)}!`);throw i.name="NullInjectorError",i}return e}}const im=new On("Set Injector scope."),ad={},vA={};let rm;function ny(){return void 0===rm&&(rm=new ty),rm}function iy(t,n=null,e=null,i){const r=ry(t,n,e,i);return r._resolveInjectorDefTypes(),r}function ry(t,n=null,e=null,i){return new bA(t,e,n||ny(),i)}class bA{constructor(n,e,i,r=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];e&&So(e,a=>this.processProvider(a,n,e)),So([n],a=>this.processInjectorType(a,[],s)),this.records.set(nm,Ic(void 0,this));const o=this.records.get(im);this.scope=null!=o?o.value:null,this.source=r||("object"==typeof n?null:qn(n))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(n=>n.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(n,e=Ku,i=gn.Default){this.assertNotDestroyed();const r=I1(this),s=Ca(void 0);try{if(!(i&gn.SkipSelf)){let a=this.records.get(n);if(void 0===a){const h=function IA(t){return"function"==typeof t||"object"==typeof t&&t instanceof On}(n)&&Sg(n);a=h&&this.injectableDefInScope(h)?Ic(sm(n),ad):null,this.records.set(n,a)}if(null!=a)return this.hydrate(n,a)}return(i&gn.Self?ny():this.parent).get(n,e=i&gn.Optional&&e===Ku?null:e)}catch(o){if("NullInjectorError"===o.name){if((o[Qf]=o[Qf]||[]).unshift(qn(n)),r)throw o;return function eM(t,n,e,i){const r=t[Qf];throw n[S1]&&r.unshift(n[S1]),t.message=function tM(t,n,e,i=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let r=qn(n);if(Array.isArray(n))r=n.map(qn).join(" -> ");else if("object"==typeof n){let s=[];for(let o in n)if(n.hasOwnProperty(o)){let a=n[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):qn(a)))}r=`{${s.join(", ")}}`}return`${e}${i?"("+i+")":""}[${r}]: ${t.replace(Kk,"\n  ")}`}("\n"+t.message,r,e,i),t.ngTokenPath=r,t[Qf]=null,t}(o,n,"R3InjectorError",this.source)}throw o}finally{Ca(s),I1(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(n=>this.get(n))}toString(){const n=[];return this.records.forEach((i,r)=>n.push(qn(r))),`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new At(205,!1)}processInjectorType(n,e,i){if(!(n=on(n)))return!1;let r=Rv(n);const s=null==r&&n.ngModule||void 0,o=void 0===s?n:s,a=-1!==i.indexOf(o);if(void 0!==s&&(r=Rv(s)),null==r)return!1;if(null!=r.imports&&!a){let X;i.push(o);try{So(r.imports,fe=>{this.processInjectorType(fe,e,i)&&(void 0===X&&(X=[]),X.push(fe))})}finally{}if(void 0!==X)for(let fe=0;fe<X.length;fe++){const{ngModule:pe,providers:we}=X[fe];So(we,Ie=>this.processProvider(Ie,pe,we||ui))}}this.injectorDefTypes.add(o);const h=_l(o)||(()=>new o);this.records.set(o,Ic(h,ad));const w=r.providers;if(null!=w&&!a){const X=n;So(w,fe=>this.processProvider(fe,X,w))}return void 0!==s&&void 0!==n.providers}processProvider(n,e,i){let r=kc(n=on(n))?n:on(n&&n.provide);const s=function CA(t,n,e){return oy(t)?Ic(void 0,t.useValue):Ic(sy(t),ad)}(n);if(kc(n)||!0!==n.multi)this.records.get(r);else{let o=this.records.get(r);o||(o=Ic(void 0,ad,!0),o.factory=()=>c_(o.multi),this.records.set(r,o)),r=n,o.multi.push(n)}this.records.set(r,s)}hydrate(n,e){return e.value===ad&&(e.value=vA,e.value=e.factory()),"object"==typeof e.value&&e.value&&function SA(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(e.value)&&this.onDestroy.add(e.value),e.value}injectableDefInScope(n){if(!n.providedIn)return!1;const e=on(n.providedIn);return"string"==typeof e?"any"===e||e===this.scope:this.injectorDefTypes.has(e)}}function sm(t){const n=Sg(t),e=null!==n?n.factory:_l(t);if(null!==e)return e;if(t instanceof On)throw new At(204,!1);if(t instanceof Function)return function yA(t){const n=t.length;if(n>0)throw Wu(n,"?"),new At(204,!1);const e=function NI(t){const n=t&&(t[Mf]||t[Bv]);if(n){const e=function FI(t){if(t.hasOwnProperty("name"))return t.name;const n=(""+t).match(/^function\s*([^\s(]+)/);return null===n?"":n[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${e}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${e}" class.`),n}return null}(t);return null!==e?()=>e.factory(t):()=>new t}(t);throw new At(204,!1)}function sy(t,n,e){let i;if(kc(t)){const r=on(t);return _l(r)||sm(r)}if(oy(t))i=()=>on(t.useValue);else if(function wA(t){return!(!t||!t.useFactory)}(t))i=()=>t.useFactory(...c_(t.deps||[]));else if(function xA(t){return!(!t||!t.useExisting)}(t))i=()=>an(on(t.useExisting));else{const r=on(t&&(t.useClass||t.provide));if(!function TA(t){return!!t.deps}(t))return _l(r)||sm(r);i=()=>new r(...c_(t.deps))}return i}function Ic(t,n,e=!1){return{factory:t,value:n,multi:e?[]:void 0}}function oy(t){return null!==t&&"object"==typeof t&&Zk in t}function kc(t){return"function"==typeof t}let Yr=(()=>{class t{static create(e,i){var r;if(Array.isArray(e))return iy({name:""},i,e,"");{const s=null!==(r=e.name)&&void 0!==r?r:"";return iy({name:s},e.parent,e.providers,s)}}}return t.THROW_IF_NOT_FOUND=Ku,t.NULL=new ty,t.\u0275prov=rn({token:t,providedIn:"any",factory:()=>an(nm)}),t.__NG_ELEMENT_ID__=-1,t})();function OA(t,n){jf(h_(t)[1],Wi())}function ei(t){let n=function $y(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),e=!0;const i=[t];for(;n;){let r;if(no(t))r=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new At(903,"");r=n.\u0275dir}if(r){if(e){i.push(r);const o=t;o.inputs=lm(t.inputs),o.declaredInputs=lm(t.declaredInputs),o.outputs=lm(t.outputs);const a=r.hostBindings;a&&zA(t,a);const h=r.viewQuery,w=r.contentQueries;if(h&&BA(t,h),w&&LA(t,w),ya(t.inputs,r.inputs),ya(t.declaredInputs,r.declaredInputs),ya(t.outputs,r.outputs),no(r)&&r.data.animation){const X=t.data;X.animation=(X.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(t),a===ei&&(e=!1)}}n=Object.getPrototypeOf(n)}!function RA(t){let n=0,e=null;for(let i=t.length-1;i>=0;i--){const r=t[i];r.hostVars=n+=r.hostVars,r.hostAttrs=Gf(r.hostAttrs,e=Gf(e,r.hostAttrs))}}(i)}function lm(t){return t===ac?{}:t===ui?[]:t}function BA(t,n){const e=t.viewQuery;t.viewQuery=e?(i,r)=>{n(i,r),e(i,r)}:n}function LA(t,n){const e=t.contentQueries;t.contentQueries=e?(i,r,s)=>{n(i,r,s),e(i,r,s)}:n}function zA(t,n){const e=t.hostBindings;t.hostBindings=e?(i,r)=>{n(i,r),e(i,r)}:n}let gh=null;function Mc(){if(!gh){const t=si.Symbol;if(t&&t.iterator)gh=t.iterator;else{const n=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<n.length;++e){const i=n[e];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(gh=i)}}}return gh}function ld(t){return!!cm(t)&&(Array.isArray(t)||!(t instanceof Map)&&Mc()in t)}function cm(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Ao(t,n,e){return t[n]=e}function cd(t,n){return t[n]}function Er(t,n,e){return!Object.is(t[n],e)&&(t[n]=e,!0)}function bl(t,n,e,i){const r=Er(t,n,e);return Er(t,n+1,i)||r}function _h(t,n,e,i,r){const s=bl(t,n,e,i);return Er(t,n+2,r)||s}function As(t,n,e,i,r,s){const o=bl(t,n,e,i);return bl(t,n+2,r,s)||o}function Bt(t,n,e,i){const r=$t();return Er(r,hc(),n)&&(Hn(),Do(Ii(),r,t,n,e,i)),Bt}function Ac(t,n,e,i){return Er(t,hc(),e)?n+nn(e)+i:pn}function Pc(t,n,e,i,r,s){const a=bl(t,function ta(){return hn.lFrame.bindingIndex}(),e,r);return na(2),a?n+nn(e)+i+nn(r)+s:pn}function um(t,n,e,i,r,s){const o=$t(),a=Ac(o,n,e,i);return a!==pn&&Do(Ii(),o,t,a,r,s),um}function Te(t,n,e,i,r,s,o,a){const h=$t(),w=Hn(),X=t+20,fe=w.firstCreatePass?function WA(t,n,e,i,r,s,o,a,h){const w=n.consts,X=Ec(n,t,4,o||null,Ea(w,a));Y_(n,e,X,Ea(w,h)),jf(n,X);const fe=X.tViews=fh(2,X,i,r,s,n.directiveRegistry,n.pipeRegistry,null,n.schemas,w);return null!==n.queries&&(n.queries.template(n,X),fe.queries=n.queries.embeddedTView(X)),X}(X,w,h,n,e,i,r,s,o):w.data[X];To(fe,!1);const pe=h[11].createComment("");ih(w,h,pe,fe),wr(pe,h),hh(h,h[X]=Kb(pe,h,pe,fe)),Of(fe)&&W_(w,h,fe),null!=o&&K_(h,fe,a)}function Kt(t){return fc(function hk(){return hn.lFrame.contextLView}(),20+t)}function He(t,n=gn.Default){const e=$t();return null===e?an(t,n):m1(Wi(),e,on(t),n)}function re(t,n,e){const i=$t();return Er(i,hc(),n)&&hs(Hn(),Ii(),i,t,n,i[11],e,!1),re}function gm(t,n,e,i,r){const o=r?"class":"style";ey(t,e,n.inputs[o],o,i)}function Q(t,n,e,i){const r=$t(),s=Hn(),o=20+t,a=r[11],h=r[o]=v_(a,n,function wk(){return hn.lFrame.currentNamespace}()),w=s.firstCreatePass?function gP(t,n,e,i,r,s,o){const a=n.consts,w=Ec(n,t,2,r,Ea(a,s));return Y_(n,e,w,Ea(a,o)),null!==w.attrs&&ph(w,w.attrs,!1),null!==w.mergedAttrs&&ph(w,w.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,w),w}(o,s,r,0,n,e,i):s.data[o];To(w,!0);const X=w.mergedAttrs;null!==X&&Vf(a,h,X);const fe=w.classes;null!==fe&&T_(a,h,fe);const pe=w.styles;return null!==pe&&ib(a,h,pe),64!=(64&w.flags)&&ih(s,r,h,w),0===function lk(){return hn.lFrame.elementDepthCount}()&&wr(h,r),function ck(){hn.lFrame.elementDepthCount++}(),Of(w)&&(W_(s,r,w),Ob(s,w,r)),null!==i&&K_(r,w),Q}function ie(){let t=Wi();Gg()?qg():(t=t.parent,To(t,!1));const n=t;!function uk(){hn.lFrame.elementDepthCount--}();const e=Hn();return e.firstCreatePass&&(jf(e,t),Fg(t)&&e.queries.elementEnd(t)),null!=n.classesWithoutHost&&function kk(t){return 0!=(16&t.flags)}(n)&&gm(e,n,$t(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function Mk(t){return 0!=(32&t.flags)}(n)&&gm(e,n,$t(),n.stylesWithoutHost,!1),ie}function ot(t,n,e,i){return Q(t,n,e,i),ie(),ot}function Ke(t,n,e){const i=$t(),r=Hn(),s=t+20,o=r.firstCreatePass?function _P(t,n,e,i,r){const s=n.consts,o=Ea(s,i),a=Ec(n,t,8,"ng-container",o);return null!==o&&ph(a,o,!0),Y_(n,e,a,Ea(s,r)),null!==n.queries&&n.queries.elementStart(n,a),a}(s,r,i,n,e):r.data[s];To(o,!0);const a=i[s]=i[11].createComment("");return ih(r,i,a,o),wr(a,i),Of(o)&&(W_(r,i,o),Ob(r,o,i)),null!=e&&K_(i,o),Ke}function Ye(){let t=Wi();const n=Hn();return Gg()?qg():(t=t.parent,To(t,!1)),n.firstCreatePass&&(jf(n,t),Fg(t)&&n.queries.elementEnd(t)),Ye}function _n(t,n,e){return Ke(t,n,e),Ye(),_n}function it(){return $t()}function $h(t){return!!t&&"function"==typeof t.then}const By=function Ry(t){return!!t&&"function"==typeof t.subscribe};function Ae(t,n,e,i){const r=$t(),s=Hn(),o=Wi();return function zy(t,n,e,i,r,s,o,a){const h=Of(i),X=t.firstCreatePass&&Xb(t),fe=n[8],pe=Zb(n);let we=!0;if(3&i.type||a){const Be=ls(i,n),Le=a?a(Be):Be,Fe=pe.length,Ve=a?Ge=>a(zi(Ge[i.index])):i.index;if(Pi(e)){let Ge=null;if(!a&&h&&(Ge=function mP(t,n,e,i){const r=t.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===e&&r[s+1]===i){const a=n[7],h=r[s+2];return a.length>h?a[h]:null}"string"==typeof o&&(s+=2)}return null}(t,n,r,i.index)),null!==Ge)(Ge.__ngLastListenerFn__||Ge).__ngNextListenerFn__=s,Ge.__ngLastListenerFn__=s,we=!1;else{s=_m(i,n,fe,s,!1);const ct=e.listen(Le,r,s);pe.push(s,ct),X&&X.push(r,Ve,Fe,Fe+1)}}else s=_m(i,n,fe,s,!0),Le.addEventListener(r,s,o),pe.push(s),X&&X.push(r,Ve,Fe,o)}else s=_m(i,n,fe,s,!1);const Ie=i.outputs;let Pe;if(we&&null!==Ie&&(Pe=Ie[r])){const Be=Pe.length;if(Be)for(let Le=0;Le<Be;Le+=2){const ut=n[Pe[Le]][Pe[Le+1]].subscribe(s),st=pe.length;pe.push(s,ut),X&&X.push(r,i.index,st,-(st+1))}}}(s,r,r[11],o,t,n,!!e,i),Ae}function jy(t,n,e,i){try{return!1!==e(i)}catch(r){return Jb(t,r),!1}}function _m(t,n,e,i,r){return function s(o){if(o===Function)return i;const a=2&t.flags?cs(t.index,n):n;0==(32&n[2])&&Q_(a);let h=jy(n,0,i,o),w=s.__ngNextListenerFn__;for(;w;)h=jy(n,0,w,o)&&h,w=w.__ngNextListenerFn__;return r&&!1===h&&(o.preventDefault(),o.returnValue=!1),h}}function _e(t=1){return function $k(t){return(hn.lFrame.contextLView=function vk(t,n){for(;t>0;)n=n[15],t--;return n}(t,hn.lFrame.contextLView))[8]}(t)}function $P(t,n){let e=null;const i=function SD(t){const n=t.attrs;if(null!=n){const e=n.indexOf(5);if(0==(1&e))return n[e+1]}return null}(t);for(let r=0;r<n.length;r++){const s=n[r];if("*"!==s){if(null===i?yb(t,s,!0):MD(i,s))return r}else e=r}return e}function mm(t){const n=$t()[16][6];if(!n.projection){const i=n.projection=Wu(t?t.length:1,null),r=i.slice();let s=n.child;for(;null!==s;){const o=t?$P(s,t):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s),s=s.next}}}function $m(t,n=0,e){const i=$t(),r=Hn(),s=Ec(r,20+t,16,null,e||null);null===s.projection&&(s.projection=n),qg(),64!=(64&s.flags)&&function AM(t,n,e){nb(n[11],0,n,e,W1(t,e,n),X1(e.parent||n[6],e,n))}(r,i,s)}function ht(t,n,e){return Zi(t,"",n,"",e),ht}function Zi(t,n,e,i,r){const s=$t(),o=Ac(s,n,e,i);return o!==pn&&hs(Hn(),Ii(),s,t,o,s[11],r,!1),Zi}function Zy(t,n,e,i,r){const s=t[e+1],o=null===n;let a=i?so(s):ia(s),h=!1;for(;0!==a&&(!1===h||o);){const X=t[a+1];yP(t[a],n)&&(h=!0,t[a+1]=i?R_(X):F_(X)),a=i?so(X):ia(X)}h&&(t[e+1]=i?F_(s):R_(s))}function yP(t,n){return null===t||null==n||(Array.isArray(t)?t[1]:t)===n||!(!Array.isArray(t)||"string"!=typeof n)&&yc(t,n)>=0}const Xi={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Xy(t){return t.substring(Xi.key,Xi.keyEnd)}function CP(t){return t.substring(Xi.value,Xi.valueEnd)}function Qy(t,n){const e=Xi.textEnd;return e===n?-1:(n=Xi.keyEnd=function EP(t,n,e){for(;n<e&&t.charCodeAt(n)>32;)n++;return n}(t,Xi.key=n,e),jc(t,n,e))}function Jy(t,n){const e=Xi.textEnd;let i=Xi.key=jc(t,n,e);return e===i?-1:(i=Xi.keyEnd=function TP(t,n,e){let i;for(;n<e&&(45===(i=t.charCodeAt(n))||95===i||(-33&i)>=65&&(-33&i)<=90||i>=48&&i<=57);)n++;return n}(t,i,e),i=tC(t,i,e),i=Xi.value=jc(t,i,e),i=Xi.valueEnd=function SP(t,n,e){let i=-1,r=-1,s=-1,o=n,a=o;for(;o<e;){const h=t.charCodeAt(o++);if(59===h)return a;34===h||39===h?a=o=nC(t,h,o,e):n===o-4&&85===s&&82===r&&76===i&&40===h?a=o=nC(t,41,o,e):h>32&&(a=o),s=r,r=i,i=-33&h}return a}(t,i,e),tC(t,i,e))}function eC(t){Xi.key=0,Xi.keyEnd=0,Xi.value=0,Xi.valueEnd=0,Xi.textEnd=t.length}function jc(t,n,e){for(;n<e&&t.charCodeAt(n)<=32;)n++;return n}function tC(t,n,e,i){return(n=jc(t,n,e))<e&&n++,n}function nC(t,n,e,i){let r=-1,s=e;for(;s<i;){const o=t.charCodeAt(s++);if(o==n&&92!==r)return s;r=92==o&&92===r?0:o}throw new Error}function Qe(t,n,e){return ao(t,n,e,!1),Qe}function vh(t,n){return ao(t,n,null,!0),vh}function hr(t){lo(sC,IP,t,!1)}function IP(t,n){for(let e=function wP(t){return eC(t),Jy(t,jc(t,0,Xi.textEnd))}(n);e>=0;e=Jy(n,e))sC(t,Xy(n),CP(n))}function ud(t){lo(us,Po,t,!0)}function Po(t,n){for(let e=function xP(t){return eC(t),Qy(t,jc(t,0,Xi.textEnd))}(n);e>=0;e=Qy(n,e))us(t,Xy(n),!0)}function ao(t,n,e,i){const r=$t(),s=Hn(),o=na(2);s.firstUpdatePass&&rC(s,t,o,i),n!==pn&&Er(r,o,n)&&oC(s,s.data[Rr()],r,r[11],t,r[o+1]=function FP(t,n){return null==t||("string"==typeof n?t+=n:"object"==typeof t&&(t=qn(fs(t)))),t}(n,e),i,o)}function lo(t,n,e,i){const r=Hn(),s=na(2);r.firstUpdatePass&&rC(r,null,s,i);const o=$t();if(e!==pn&&Er(o,s,e)){const a=r.data[Rr()];if(lC(a,i)&&!iC(r,s)){let h=i?a.classesWithoutHost:a.stylesWithoutHost;null!==h&&(e=ul(h,e||"")),gm(r,a,o,e,i)}else!function NP(t,n,e,i,r,s,o,a){r===pn&&(r=ui);let h=0,w=0,X=0<r.length?r[0]:null,fe=0<s.length?s[0]:null;for(;null!==X||null!==fe;){const pe=h<r.length?r[h+1]:void 0,we=w<s.length?s[w+1]:void 0;let Pe,Ie=null;X===fe?(h+=2,w+=2,pe!==we&&(Ie=fe,Pe=we)):null===fe||null!==X&&X<fe?(h+=2,Ie=X):(w+=2,Ie=fe,Pe=we),null!==Ie&&oC(t,n,e,i,Ie,Pe,o,a),X=h<r.length?r[h]:null,fe=w<s.length?s[w]:null}}(r,a,o,o[11],o[s+1],o[s+1]=function PP(t,n,e){if(null==e||""===e)return ui;const i=[],r=fs(e);if(Array.isArray(r))for(let s=0;s<r.length;s++)t(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&t(i,s,r[s]);else"string"==typeof r&&n(i,r);return i}(t,n,e),i,s)}}function iC(t,n){return n>=t.expandoStartIndex}function rC(t,n,e,i){const r=t.data;if(null===r[e+1]){const s=r[Rr()],o=iC(t,e);lC(s,i)&&null===n&&!o&&(n=!1),n=function kP(t,n,e,i){const r=function Kg(t){const n=hn.lFrame.currentDirectiveIndex;return-1===n?null:t[n]}(t);let s=i?n.residualClasses:n.residualStyles;if(null===r)0===(i?n.classBindings:n.styleBindings)&&(e=dd(e=vm(null,t,n,e,i),n.attrs,i),s=null);else{const o=n.directiveStylingLast;if(-1===o||t[o]!==r)if(e=vm(r,t,n,e,i),null===s){let h=function MP(t,n,e){const i=e?n.classBindings:n.styleBindings;if(0!==ia(i))return t[so(i)]}(t,n,i);void 0!==h&&Array.isArray(h)&&(h=vm(null,t,n,h[1],i),h=dd(h,n.attrs,i),function DP(t,n,e,i){t[so(e?n.classBindings:n.styleBindings)]=i}(t,n,i,h))}else s=function AP(t,n,e){let i;const r=n.directiveEnd;for(let s=1+n.directiveStylingLast;s<r;s++)i=dd(i,t[s].hostAttrs,e);return dd(i,n.attrs,e)}(t,n,i)}return void 0!==s&&(i?n.residualClasses=s:n.residualStyles=s),e}(r,s,n,i),function vP(t,n,e,i,r,s){let o=s?n.classBindings:n.styleBindings,a=so(o),h=ia(o);t[i]=e;let X,w=!1;if(Array.isArray(e)){const fe=e;X=fe[1],(null===X||yc(fe,X)>0)&&(w=!0)}else X=e;if(r)if(0!==h){const pe=so(t[a+1]);t[i+1]=ch(pe,a),0!==pe&&(t[pe+1]=O_(t[pe+1],i)),t[a+1]=function ND(t,n){return 131071&t|n<<17}(t[a+1],i)}else t[i+1]=ch(a,0),0!==a&&(t[a+1]=O_(t[a+1],i)),a=i;else t[i+1]=ch(h,0),0===a?a=i:t[h+1]=O_(t[h+1],i),h=i;w&&(t[i+1]=F_(t[i+1])),Zy(t,X,i,!0),Zy(t,X,i,!1),function bP(t,n,e,i,r){const s=r?t.residualClasses:t.residualStyles;null!=s&&"string"==typeof n&&yc(s,n)>=0&&(e[i+1]=R_(e[i+1]))}(n,X,t,i,s),o=ch(a,h),s?n.classBindings=o:n.styleBindings=o}(r,s,n,e,o,i)}}function vm(t,n,e,i,r){let s=null;const o=e.directiveEnd;let a=e.directiveStylingLast;for(-1===a?a=e.directiveStart:a++;a<o&&(s=n[a],i=dd(i,s.hostAttrs,r),s!==t);)a++;return null!==t&&(e.directiveStylingLast=a),i}function dd(t,n,e){const i=e?1:2;let r=-1;if(null!==n)for(let s=0;s<n.length;s++){const o=n[s];"number"==typeof o?r=o:r===i&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),us(t,o,!!e||n[++s]))}return void 0===t?null:t}function sC(t,n,e){us(t,n,fs(e))}function oC(t,n,e,i,r,s,o,a){if(!(3&n.type))return;const h=t.data,w=h[a+1];bh(function Tb(t){return 1==(1&t)}(w)?aC(h,n,e,r,ia(w),o):void 0)||(bh(s)||function Eb(t){return 2==(2&t)}(w)&&(s=aC(h,null,e,r,a,o)),function NM(t,n,e,i,r){const s=Pi(t);if(n)r?s?t.addClass(e,i):e.classList.add(i):s?t.removeClass(e,i):e.classList.remove(i);else{let o=-1===i.indexOf("-")?void 0:ds.DashCase;if(null==r)s?t.removeStyle(e,i,o):e.style.removeProperty(i);else{const a="string"==typeof r&&r.endsWith("!important");a&&(r=r.slice(0,-10),o|=ds.Important),s?t.setStyle(e,i,r,o):e.style.setProperty(i,r,a?"important":"")}}}(i,o,Rf(Rr(),e),r,s))}function aC(t,n,e,i,r,s){const o=null===n;let a;for(;r>0;){const h=t[r],w=Array.isArray(h),X=w?h[1]:h,fe=null===X;let pe=e[r+1];pe===pn&&(pe=fe?ui:void 0);let we=fe?o_(pe,i):X===i?pe:void 0;if(w&&!bh(we)&&(we=o_(h,i)),bh(we)&&(a=we,o))return a;const Ie=t[r+1];r=o?so(Ie):ia(Ie)}if(null!==n){let h=s?n.residualClasses:n.residualStyles;null!=h&&(a=o_(h,i))}return a}function bh(t){return void 0!==t}function lC(t,n){return 0!=(t.flags&(n?16:32))}function ye(t,n=""){const e=$t(),i=Hn(),r=t+20,s=i.firstCreatePass?Ec(i,r,1,n,null):i.data[r],o=e[r]=function $_(t,n){return Pi(t)?t.createText(n):t.createTextNode(n)}(e[11],n);ih(i,e,o,s),To(s,!1)}function Xe(t){return Rn("",t,""),Xe}function Rn(t,n,e){const i=$t(),r=Ac(i,t,n,e);return r!==pn&&ra(i,Rr(),r),Rn}function Ma(t,n,e,i,r){const s=$t(),o=Pc(s,t,n,e,i,r);return o!==pn&&ra(s,Rr(),o),Ma}const yl=void 0;var t4=["en",[["a","p"],["AM","PM"],yl],[["AM","PM"],yl,yl],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],yl,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],yl,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",yl,"{1} 'at' {0}",yl],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function e4(t){const e=Math.floor(Math.abs(t)),i=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===i?1:5}];let Hc={};function Lr(t){const n=function n4(t){return t.toLowerCase().replace(/_/g,"-")}(t);let e=IC(n);if(e)return e;const i=n.split("-")[0];if(e=IC(i),e)return e;if("en"===i)return t4;throw new Error(`Missing locale data for the locale "${t}".`)}function IC(t){return t in Hc||(Hc[t]=si.ng&&si.ng.common&&si.ng.common.locales&&si.ng.common.locales[t]),Hc[t]}var Dt=(()=>((Dt=Dt||{})[Dt.LocaleId=0]="LocaleId",Dt[Dt.DayPeriodsFormat=1]="DayPeriodsFormat",Dt[Dt.DayPeriodsStandalone=2]="DayPeriodsStandalone",Dt[Dt.DaysFormat=3]="DaysFormat",Dt[Dt.DaysStandalone=4]="DaysStandalone",Dt[Dt.MonthsFormat=5]="MonthsFormat",Dt[Dt.MonthsStandalone=6]="MonthsStandalone",Dt[Dt.Eras=7]="Eras",Dt[Dt.FirstDayOfWeek=8]="FirstDayOfWeek",Dt[Dt.WeekendRange=9]="WeekendRange",Dt[Dt.DateFormat=10]="DateFormat",Dt[Dt.TimeFormat=11]="TimeFormat",Dt[Dt.DateTimeFormat=12]="DateTimeFormat",Dt[Dt.NumberSymbols=13]="NumberSymbols",Dt[Dt.NumberFormats=14]="NumberFormats",Dt[Dt.CurrencyCode=15]="CurrencyCode",Dt[Dt.CurrencySymbol=16]="CurrencySymbol",Dt[Dt.CurrencyName=17]="CurrencyName",Dt[Dt.Currencies=18]="Currencies",Dt[Dt.Directionality=19]="Directionality",Dt[Dt.PluralCase=20]="PluralCase",Dt[Dt.ExtraData=21]="ExtraData",Dt))();const yh="en-US";let kC=yh;function Cm(t,n,e,i,r){if(t=on(t),Array.isArray(t))for(let s=0;s<t.length;s++)Cm(t[s],n,e,i,r);else{const s=Hn(),o=$t();let a=kc(t)?t:on(t.provide),h=sy(t);const w=Wi(),X=1048575&w.providerIndexes,fe=w.directiveStart,pe=w.providerIndexes>>20;if(kc(t)||!t.multi){const we=new ju(h,r,He),Ie=wm(a,n,r?X:X+pe,fe);-1===Ie?(Kf(Uu(w,o),s,a),xm(s,t,n.length),n.push(a),w.directiveStart++,w.directiveEnd++,r&&(w.providerIndexes+=1048576),e.push(we),o.push(we)):(e[Ie]=we,o[Ie]=we)}else{const we=wm(a,n,X+pe,fe),Ie=wm(a,n,X,X+pe),Pe=we>=0&&e[we],Be=Ie>=0&&e[Ie];if(r&&!Be||!r&&!Pe){Kf(Uu(w,o),s,a);const Le=function e5(t,n,e,i,r){const s=new ju(t,e,He);return s.multi=[],s.index=n,s.componentProviders=0,JC(s,r,i&&!e),s}(r?J4:Q4,e.length,r,i,h);!r&&Be&&(e[Ie].providerFactory=Le),xm(s,t,n.length,0),n.push(a),w.directiveStart++,w.directiveEnd++,r&&(w.providerIndexes+=1048576),e.push(Le),o.push(Le)}else xm(s,t,we>-1?we:Ie,JC(e[r?Ie:we],h,!r&&i));!r&&i&&Be&&e[Ie].componentProviders++}}}function xm(t,n,e,i){const r=kc(n),s=function EA(t){return!!t.useClass}(n);if(r||s){const h=(s?on(n.useClass):n).prototype.ngOnDestroy;if(h){const w=t.destroyHooks||(t.destroyHooks=[]);if(!r&&n.multi){const X=w.indexOf(e);-1===X?w.push(e,[i,h]):w[X+1].push(i,h)}else w.push(e,h)}}}function JC(t,n,e){return e&&t.componentProviders++,t.multi.push(n)-1}function wm(t,n,e,i){for(let r=e;r<i;r++)if(n[r]===t)return r;return-1}function Q4(t,n,e,i){return Em(this.multi,[])}function J4(t,n,e,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=Vu(e,e[1],this.providerFactory.index,i);s=a.slice(0,o),Em(r,s);for(let h=o;h<a.length;h++)s.push(a[h])}else s=[],Em(r,s);return s}function Em(t,n){for(let e=0;e<t.length;e++)n.push((0,t[e])());return n}function gi(t,n=[]){return e=>{e.providersResolver=(i,r)=>function X4(t,n,e){const i=Hn();if(i.firstCreatePass){const r=no(t);Cm(e,i.data,i.blueprint,r,!0),Cm(n,i.data,i.blueprint,r,!1)}}(i,r?r(t):t,n)}}class ex{}class i5{resolveComponentFactory(n){throw function n5(t){const n=Error(`No component factory found for ${qn(t)}. Did you add it to @NgModule.entryComponents?`);return n.ngComponent=t,n}(n)}}let Th=(()=>{class t{}return t.NULL=new i5,t})();function r5(){return Vc(Wi(),$t())}function Vc(t,n){return new yi(ls(t,n))}let yi=(()=>{class t{constructor(e){this.nativeElement=e}}return t.__NG_ELEMENT_ID__=r5,t})();function s5(t){return t instanceof yi?t.nativeElement:t}class _d{}let Cl=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>function a5(){const t=$t(),e=cs(Wi().index,t);return function o5(t){return t[11]}(Eo(e)?e:t)}(),t})(),l5=(()=>{class t{}return t.\u0275prov=rn({token:t,providedIn:"root",factory:()=>null}),t})();class Sh{constructor(n){this.full=n,this.major=n.split(".")[0],this.minor=n.split(".")[1],this.patch=n.split(".").slice(2).join(".")}}const c5=new Sh("13.3.12"),Tm={};function Ih(t,n,e,i,r=!1){for(;null!==e;){const s=n[e.index];if(null!==s&&i.push(zi(s)),to(s))for(let a=10;a<s.length;a++){const h=s[a],w=h[1].firstChild;null!==w&&Ih(h[1],h,w,i)}const o=e.type;if(8&o)Ih(t,n,e.child,i);else if(32&o){const a=g_(e,n);let h;for(;h=a();)i.push(h)}else if(16&o){const a=tb(n,e);if(Array.isArray(a))i.push(...a);else{const h=Ju(n[16]);Ih(h[1],h,a,i,!0)}}e=r?e.projectionNext:e.next}return i}class md{constructor(n,e){this._lView=n,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const n=this._lView,e=n[1];return Ih(e,n,e.firstChild,[])}get context(){return this._lView[8]}set context(n){this._lView[8]=n}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[3];if(to(n)){const e=n[8],i=e?e.indexOf(this):-1;i>-1&&(b_(n,i),Zf(e,i))}this._attachedToViewContainer=!1}q1(this._lView[1],this._lView)}onDestroy(n){zb(this._lView[1],this._lView,null,n)}markForCheck(){Q_(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){!function em(t,n,e){const i=n[10];i.begin&&i.begin();try{Sc(t,n,t.template,e)}catch(r){throw Jb(n,r),r}finally{i.end&&i.end()}}(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new At(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function wM(t,n){ed(t,n,n[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new At(902,"");this._appRef=n}}class u5 extends md{constructor(n){super(n),this._view=n}detectChanges(){Yb(this._view)}checkNoChanges(){}get context(){return null}}class nx extends Th{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const e=fr(n);return new Sm(e,this.ngModule)}}function ix(t){const n=[];for(let e in t)t.hasOwnProperty(e)&&n.push({propName:t[e],templateName:e});return n}class Sm extends ex{constructor(n,e){super(),this.componentDef=n,this.ngModule=e,this.componentType=n.type,this.selector=function AD(t){return t.map(DD).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return ix(this.componentDef.inputs)}get outputs(){return ix(this.componentDef.outputs)}create(n,e,i,r){const s=(r=r||this.ngModule)?function f5(t,n){return{get:(e,i,r)=>{const s=t.get(e,Tm,r);return s!==Tm||i===Tm?s:n.get(e,i,r)}}}(n,r.injector):n,o=s.get(_d,Yv),a=s.get(l5,null),h=o.createRenderer(null,this.componentDef),w=this.componentDef.selectors[0][0]||"div",X=i?function Lb(t,n,e){if(Pi(t))return t.selectRootElement(n,e===Js.ShadowDom);let i="string"==typeof n?t.querySelector(n):n;return i.textContent="",i}(h,i,this.componentDef.encapsulation):v_(o.createRenderer(null,this.componentDef),w,function d5(t){const n=t.toLowerCase();return"svg"===n?"svg":"math"===n?"math":null}(w)),fe=this.componentDef.onPush?576:528,pe=function my(t,n){return{components:[],scheduler:t||bD,clean:_A,playerHandler:n||null,flags:0}}(),we=fh(0,null,null,1,0,null,null,null,null,null),Ie=sd(null,we,pe,fe,null,null,o,h,a,s);let Pe,Be;Lf(Ie);try{const Le=function gy(t,n,e,i,r,s){const o=e[1];e[20]=t;const h=Ec(o,20,2,"#host",null),w=h.mergedAttrs=n.hostAttrs;null!==w&&(ph(h,w,!0),null!==t&&(Vf(r,t,w),null!==h.classes&&T_(r,t,h.classes),null!==h.styles&&ib(r,t,h.styles)));const X=i.createRenderer(t,n),fe=sd(e,Rb(n),null,n.onPush?64:16,e[20],h,i,X,s||null,null);return o.firstCreatePass&&(Kf(Uu(h,e),o,n.type),Gb(o,h),qb(h,e.length,1)),hh(e,fe),e[20]=fe}(X,this.componentDef,Ie,o,h);if(X)if(i)Vf(h,X,["ng-version",c5.full]);else{const{attrs:Fe,classes:Ve}=function PD(t){const n=[],e=[];let i=1,r=2;for(;i<t.length;){let s=t[i];if("string"==typeof s)2===r?""!==s&&n.push(s,t[++i]):8===r&&e.push(s);else{if(!ro(r))break;r=s}i++}return{attrs:n,classes:e}}(this.componentDef.selectors[0]);Fe&&Vf(h,X,Fe),Ve&&Ve.length>0&&T_(h,X,Ve.join(" "))}if(Be=Hg(we,20),void 0!==e){const Fe=Be.projection=[];for(let Ve=0;Ve<this.ngContentSelectors.length;Ve++){const Ge=e[Ve];Fe.push(null!=Ge?Array.from(Ge):null)}}Pe=function _y(t,n,e,i,r){const s=e[1],o=function eA(t,n,e){const i=Wi();t.firstCreatePass&&(e.providersResolver&&e.providersResolver(e),Wb(t,i,n,Tc(t,n,1,null),e));const r=Vu(n,t,i.directiveStart,i);wr(r,n);const s=ls(i,n);return s&&wr(s,n),r}(s,e,n);if(i.components.push(o),t[8]=o,r&&r.forEach(h=>h(o,n)),n.contentQueries){const h=Wi();n.contentQueries(1,o,h.directiveStart)}const a=Wi();return!s.firstCreatePass||null===n.hostBindings&&null===n.hostAttrs||(Ta(a.index),Ub(e[1],a,0,a.directiveStart,a.directiveEnd,n),Vb(n,o)),o}(Le,this.componentDef,Ie,pe,[OA]),od(we,Ie,null)}finally{zf()}return new p5(this.componentType,Pe,Vc(Be,Ie),Ie,Be)}}class p5 extends class t5{}{constructor(n,e,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=e,this.hostView=this.changeDetectorRef=new u5(r),this.componentType=n}get injector(){return new _c(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}class Gc{}const qc=new Map;class ox extends Gc{constructor(n,e){super(),this._parent=e,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new nx(this);const i=Is(n);this._bootstrapComponents=Mo(i.bootstrap),this._r3Injector=ry(n,e,[{provide:Gc,useValue:this},{provide:Th,useValue:this.componentFactoryResolver}],qn(n)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(n)}get(n,e=Yr.THROW_IF_NOT_FOUND,i=gn.Default){return n===Yr||n===Gc||n===nm?this:this._r3Injector.get(n,e,i)}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class Im extends class _5{}{constructor(n){super(),this.moduleType=n,null!==Is(n)&&function m5(t){const n=new Set;!function e(i){const r=Is(i,!0),s=r.id;null!==s&&(function rx(t,n,e){if(n&&n!==e)throw new Error(`Duplicate module registered for ${t} - ${qn(n)} vs ${qn(n.name)}`)}(s,qc.get(s),i),qc.set(s,i));const o=Mo(r.imports);for(const a of o)n.has(a)||(n.add(a),e(a))}(t)}(n)}create(n){return new ox(this.moduleType,n)}}function sa(t,n,e){const i=Or()+t,r=$t();return r[i]===pn?Ao(r,i,e?n.call(e):n()):cd(r,i)}function ft(t,n,e,i){return function ax(t,n,e,i,r,s){const o=n+e;return Er(t,o,r)?Ao(t,o+1,s?i.call(s,r):i(r)):$d(t,o+1)}($t(),Or(),t,n,e,i)}function Yt(t,n,e,i,r){return lx($t(),Or(),t,n,e,i,r)}function Zr(t,n,e,i,r,s){return function cx(t,n,e,i,r,s,o,a){const h=n+e;return _h(t,h,r,s,o)?Ao(t,h+3,a?i.call(a,r,s,o):i(r,s,o)):$d(t,h+3)}($t(),Or(),t,n,e,i,r,s)}function co(t,n,e,i,r,s,o){return function ux(t,n,e,i,r,s,o,a,h){const w=n+e;return As(t,w,r,s,o,a)?Ao(t,w+4,h?i.call(h,r,s,o,a):i(r,s,o,a)):$d(t,w+4)}($t(),Or(),t,n,e,i,r,s,o)}function km(t,n,e,i,r,s,o,a,h){const w=Or()+t,X=$t(),fe=As(X,w,e,i,r,s);return bl(X,w+4,o,a)||fe?Ao(X,w+6,h?n.call(h,e,i,r,s,o,a):n(e,i,r,s,o,a)):cd(X,w+6)}function Wc(t,n,e,i,r,s,o,a,h,w){const X=Or()+t,fe=$t();let pe=As(fe,X,e,i,r,s);return _h(fe,X+4,o,a,h)||pe?Ao(fe,X+7,w?n.call(w,e,i,r,s,o,a,h):n(e,i,r,s,o,a,h)):cd(fe,X+7)}function uo(t,n,e,i,r,s,o,a,h,w,X){const fe=Or()+t,pe=$t(),we=As(pe,fe,e,i,r,s);return As(pe,fe+4,o,a,h,w)||we?Ao(pe,fe+8,X?n.call(X,e,i,r,s,o,a,h,w):n(e,i,r,s,o,a,h,w)):cd(pe,fe+8)}function $d(t,n){const e=t[n];return e===pn?void 0:e}function lx(t,n,e,i,r,s,o){const a=n+e;return bl(t,a,r,s)?Ao(t,a+2,o?i.call(o,r,s):i(r,s)):$d(t,a+2)}function Et(t,n){const e=Hn();let i;const r=t+20;e.firstCreatePass?(i=function b5(t,n){if(n)for(let e=n.length-1;e>=0;e--){const i=n[e];if(t===i.name)return i}}(n,e.pipeRegistry),e.data[r]=i,i.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(r,i.onDestroy)):i=e.data[r];const s=i.factory||(i.factory=_l(i.type)),o=Ca(He);try{const a=qf(!1),h=s();return qf(a),function KA(t,n,e,i){e>=t.data.length&&(t.data[e]=null,t.blueprint[e]=null),n[e]=i}(e,$t(),r,h),h}finally{Ca(o)}}function Tt(t,n,e,i){const r=t+20,s=$t(),o=fc(s,r);return function vd(t,n){return t[1].data[n].pure}(s,r)?lx(s,Or(),n,o.transform,e,i,o):o.transform(e,i)}function Mm(t){return n=>{setTimeout(t,void 0,n)}}const Tn=class E5 extends u{constructor(n=!1){super(),this.__isAsync=n}emit(n){super.next(n)}subscribe(n,e,i){var r,s,o;let a=n,h=e||(()=>null),w=i;if(n&&"object"==typeof n){const fe=n;a=null===(r=fe.next)||void 0===r?void 0:r.bind(fe),h=null===(s=fe.error)||void 0===s?void 0:s.bind(fe),w=null===(o=fe.complete)||void 0===o?void 0:o.bind(fe)}this.__isAsync&&(h=Mm(h),a&&(a=Mm(a)),w&&(w=Mm(w)));const X=super.subscribe({next:a,error:h,complete:w});return n instanceof x&&n.add(X),X}};function T5(){return this._results[Mc()]()}class Dm{constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=Mc(),i=Dm.prototype;i[e]||(i[e]=T5)}get changes(){return this._changes||(this._changes=new Tn)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,e){return this._results.reduce(n,e)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,e){const i=this;i.dirty=!1;const r=Ds(n);(this._changesDetected=!function Lk(t,n,e){if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++){let r=t[i],s=n[i];if(e&&(r=e(r),s=e(s)),s!==r)return!1}return!0}(i._results,r,e))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let oa=(()=>{class t{}return t.__NG_ELEMENT_ID__=k5,t})();const S5=oa,I5=class extends S5{constructor(n,e,i){super(),this._declarationLView=n,this._declarationTContainer=e,this.elementRef=i}createEmbeddedView(n){const e=this._declarationTContainer.tViews,i=sd(this._declarationLView,e,n,16,null,e.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(i[19]=s.createEmbeddedView(e)),od(e,i,n),new md(i)}};function k5(){return kh(Wi(),$t())}function kh(t,n){return 4&t.type?new I5(n,t,Vc(t,n)):null}let zr=(()=>{class t{}return t.__NG_ELEMENT_ID__=M5,t})();function M5(){return px(Wi(),$t())}const D5=zr,fx=class extends D5{constructor(n,e,i){super(),this._lContainer=n,this._hostTNode=e,this._hostLView=i}get element(){return Vc(this._hostTNode,this._hostLView)}get injector(){return new _c(this._hostTNode,this._hostLView)}get parentInjector(){const n=Wf(this._hostTNode,this._hostLView);if(f1(n)){const e=gc(n,this._hostLView),i=pc(n);return new _c(e[1].data[i+8],e)}return new _c(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const e=hx(this._lContainer);return null!==e&&e[n]||null}get length(){return this._lContainer.length-10}createEmbeddedView(n,e,i){const r=n.createEmbeddedView(e||{});return this.insert(r,i),r}createComponent(n,e,i,r,s){const o=n&&!function qu(t){return"function"==typeof t}(n);let a;if(o)a=e;else{const fe=e||{};a=fe.index,i=fe.injector,r=fe.projectableNodes,s=fe.ngModuleRef}const h=o?n:new Sm(fr(n)),w=i||this.parentInjector;if(!s&&null==h.ngModule){const pe=(o?w:this.parentInjector).get(Gc,null);pe&&(s=pe)}const X=h.create(w,r,void 0,s);return this.insert(X.hostView,a),X}insert(n,e){const i=n._lView,r=i[1];if(function ak(t){return to(t[3])}(i)){const X=this.indexOf(n);if(-1!==X)this.detach(X);else{const fe=i[3],pe=new fx(fe,fe[6],fe[3]);pe.detach(pe.indexOf(n))}}const s=this._adjustIndex(e),o=this._lContainer;!function TM(t,n,e,i){const r=10+i,s=e.length;i>0&&(e[r-1][4]=n),i<s-10?(n[4]=e[r],C1(e,10+i,n)):(e.push(n),n[4]=null),n[3]=e;const o=n[17];null!==o&&e!==o&&function SM(t,n){const e=t[9];n[16]!==n[3][3][16]&&(t[2]=!0),null===e?t[9]=[n]:e.push(n)}(o,n);const a=n[19];null!==a&&a.insertView(t),n[2]|=128}(r,i,o,s);const a=x_(s,o),h=i[11],w=nh(h,o[7]);return null!==w&&function xM(t,n,e,i,r,s){i[0]=r,i[6]=n,ed(t,i,e,1,r,s)}(r,o[6],h,i,w,a),n.attachToViewContainerRef(),C1(Am(o),s,n),n}move(n,e){return this.insert(n,e)}indexOf(n){const e=hx(this._lContainer);return null!==e?e.indexOf(n):-1}remove(n){const e=this._adjustIndex(n,-1),i=b_(this._lContainer,e);i&&(Zf(Am(this._lContainer),e),q1(i[1],i))}detach(n){const e=this._adjustIndex(n,-1),i=b_(this._lContainer,e);return i&&null!=Zf(Am(this._lContainer),e)?new md(i):null}_adjustIndex(n,e=0){return null==n?this.length+e:n}};function hx(t){return t[8]}function Am(t){return t[8]||(t[8]=[])}function px(t,n){let e;const i=n[t.index];if(to(i))e=i;else{let r;if(8&t.type)r=zi(i);else{const s=n[11];r=s.createComment("");const o=ls(t,n);ml(s,nh(s,o),r,function DM(t,n){return Pi(t)?t.nextSibling(n):n.nextSibling}(s,o),!1)}n[t.index]=e=Kb(i,n,r,t),hh(n,e)}return new fx(e,t,n)}class Pm{constructor(n){this.queryList=n,this.matches=null}clone(){return new Pm(this.queryList)}setDirty(){this.queryList.setDirty()}}class Nm{constructor(n=[]){this.queries=n}createEmbeddedView(n){const e=n.queries;if(null!==e){const i=null!==n.contentQueries?n.contentQueries[0]:e.length,r=[];for(let s=0;s<i;s++){const o=e.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new Nm(r)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let e=0;e<this.queries.length;e++)null!==vx(n,e).matches&&this.queries[e].setDirty()}}class gx{constructor(n,e,i=null){this.predicate=n,this.flags=e,this.read=i}}class Fm{constructor(n=[]){this.queries=n}elementStart(n,e){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(n,e)}elementEnd(n){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(n)}embeddedTView(n){let e=null;for(let i=0;i<this.length;i++){const r=null!==e?e.length:0,s=this.getByIndex(i).embeddedTView(n,r);s&&(s.indexInDeclarationView=i,null!==e?e.push(s):e=[s])}return null!==e?new Fm(e):null}template(n,e){for(let i=0;i<this.queries.length;i++)this.queries[i].template(n,e)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class Om{constructor(n,e=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(n,e){this.isApplyingToNode(e)&&this.matchTNode(n,e)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,e){this.elementStart(n,e)}embeddedTView(n,e){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,e),new Om(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let i=n.parent;for(;null!==i&&8&i.type&&i.index!==e;)i=i.parent;return e===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(n,e){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(n,e,N5(e,s)),this.matchTNodeWithReadOption(n,e,Yf(e,n,s,!1,!1))}else i===oa?4&e.type&&this.matchTNodeWithReadOption(n,e,-1):this.matchTNodeWithReadOption(n,e,Yf(e,n,i,!1,!1))}matchTNodeWithReadOption(n,e,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===yi||r===zr||r===oa&&4&e.type)this.addMatch(e.index,-2);else{const s=Yf(e,n,r,!1,!1);null!==s&&this.addMatch(e.index,s)}else this.addMatch(e.index,i)}}addMatch(n,e){null===this.matches?this.matches=[n,e]:this.matches.push(n,e)}}function N5(t,n){const e=t.localNames;if(null!==e)for(let i=0;i<e.length;i+=2)if(e[i]===n)return e[i+1];return null}function O5(t,n,e,i){return-1===e?function F5(t,n){return 11&t.type?Vc(t,n):4&t.type?kh(t,n):null}(n,t):-2===e?function R5(t,n,e){return e===yi?Vc(n,t):e===oa?kh(n,t):e===zr?px(n,t):void 0}(t,n,i):Vu(t,t[1],e,n)}function _x(t,n,e,i){const r=n[19].queries[i];if(null===r.matches){const s=t.data,o=e.matches,a=[];for(let h=0;h<o.length;h+=2){const w=o[h];a.push(w<0?null:O5(n,s[w],o[h+1],e.metadata.read))}r.matches=a}return r.matches}function Rm(t,n,e,i){const r=t.queries.getByIndex(e),s=r.matches;if(null!==s){const o=_x(t,n,r,e);for(let a=0;a<s.length;a+=2){const h=s[a];if(h>0)i.push(o[a/2]);else{const w=s[a+1],X=n[-h];for(let fe=10;fe<X.length;fe++){const pe=X[fe];pe[17]===pe[3]&&Rm(pe[1],pe,w,i)}if(null!==X[9]){const fe=X[9];for(let pe=0;pe<fe.length;pe++){const we=fe[pe];Rm(we[1],we,w,i)}}}}}return i}function ln(t){const n=$t(),e=Hn(),i=i1();Yg(i+1);const r=vx(e,i);if(t.dirty&&Zv(n)===(2==(2&r.metadata.flags))){if(null===r.matches)t.reset([]);else{const s=r.crossesNgTemplate?Rm(e,n,i,[]):_x(e,n,r,i);t.reset(s,s5),t.notifyOnChanges()}return!0}return!1}function cn(t,n,e){const i=Hn();i.firstCreatePass&&(function $x(t,n,e){null===t.queries&&(t.queries=new Fm),t.queries.track(new Om(n,e))}(i,new gx(t,n,e),-1),2==(2&n)&&(i.staticViewQueries=!0)),function mx(t,n,e){const i=new Dm(4==(4&e));zb(t,n,i,i.destroy),null===n[19]&&(n[19]=new Nm),n[19].queries.push(new Pm(i))}(i,$t(),n)}function un(){return function L5(t,n){return t[19].queries[n].queryList}($t(),i1())}function vx(t,n){return t.queries.getByIndex(n)}function Un(t,n){return kh(t,n)}function Ah(...t){}const Um=new On("Application Initializer");let Vm=(()=>{class t{constructor(e){this.appInits=e,this.resolve=Ah,this.reject=Ah,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const e=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if($h(s))e.push(s);else if(By(s)){const o=new Promise((a,h)=>{s.subscribe({complete:a,error:h})});e.push(o)}}Promise.all(e).then(()=>{i()}).catch(r=>{this.reject(r)}),0===e.length&&i(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)(an(Um,8))},t.\u0275prov=rn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const yd=new On("AppId",{providedIn:"root",factory:function Ox(){return`${Gm()}${Gm()}${Gm()}`}});function Gm(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Rx=new On("Platform Initializer"),Cd=new On("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),iN=new On("appBootstrapListener"),Da=new On("LocaleId",{providedIn:"root",factory:()=>Qk(Da,gn.Optional|gn.SkipSelf)||function rN(){return"undefined"!=typeof $localize&&$localize.locale||yh}()}),lN=(()=>Promise.resolve(0))();function qm(t){"undefined"==typeof Zone?lN.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class Cn{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Tn(!1),this.onMicrotaskEmpty=new Tn(!1),this.onStable=new Tn(!1),this.onError=new Tn(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&e,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function cN(){let t=si.requestAnimationFrame,n=si.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&n){const e=t[Zone.__symbol__("OriginalDelegate")];e&&(t=e);const i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:n}}().nativeRequestAnimationFrame,function fN(t){const n=()=>{!function dN(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(si,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,Km(t),t.isCheckStableRunning=!0,Wm(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),Km(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,i,r,s,o,a)=>{try{return Bx(t),e.invokeTask(r,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||t.shouldCoalesceRunChangeDetection)&&n(),Lx(t)}},onInvoke:(e,i,r,s,o,a,h)=>{try{return Bx(t),e.invoke(r,s,o,a,h)}finally{t.shouldCoalesceRunChangeDetection&&n(),Lx(t)}},onHasTask:(e,i,r,s)=>{e.hasTask(r,s),i===r&&("microTask"==s.change?(t._hasPendingMicrotasks=s.microTask,Km(t),Wm(t)):"macroTask"==s.change&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(e,i,r,s)=>(e.handleError(r,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Cn.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Cn.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(n,e,i){return this._inner.run(n,e,i)}runTask(n,e,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,n,uN,Ah,Ah);try{return s.runTask(o,e,i)}finally{s.cancelTask(o)}}runGuarded(n,e,i){return this._inner.runGuarded(n,e,i)}runOutsideAngular(n){return this._outer.run(n)}}const uN={};function Wm(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function Km(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function Bx(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function Lx(t){t._nesting--,Wm(t)}class hN{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Tn,this.onMicrotaskEmpty=new Tn,this.onStable=new Tn,this.onError=new Tn}run(n,e,i){return n.apply(e,i)}runGuarded(n,e,i){return n.apply(e,i)}runOutsideAngular(n){return n()}runTask(n,e,i,r){return n.apply(e,i)}}let Ym=(()=>{class t{constructor(e){this._ngZone=e,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Cn.assertNotInAngularZone(),qm(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())qm(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(e)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),e(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:e,timeoutId:s,updateCb:r})}whenStable(e,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(e,i,r){return[]}}return t.\u0275fac=function(e){return new(e||t)(an(Cn))},t.\u0275prov=rn({token:t,factory:t.\u0275fac}),t})(),pN=(()=>{class t{constructor(){this._applications=new Map,Zm.addToWindow(this)}registerApplication(e,i){this._applications.set(e,i)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,i=!0){return Zm.findTestabilityInTree(this,e,i)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=rn({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();class gN{addToWindow(n){}findTestabilityInTree(n,e,i){return null}}let Zm=new gN,xl=null;const zx=new On("AllowMultipleToken"),jx=new On("PlatformOnDestroy");function Hx(t,n,e=[]){const i=`Platform: ${n}`,r=new On(i);return(s=[])=>{let o=Xm();if(!o||o.injector.get(zx,!1)){const a=[...e,...s,{provide:r,useValue:!0}];t?t(a):function vN(t){if(xl&&!xl.get(zx,!1))throw new At(400,"");xl=t;const n=t.get(Ux),e=t.get(Rx,null);e&&e.forEach(i=>i())}(function yN(t=[],n){return Yr.create({name:n,providers:[{provide:im,useValue:"platform"},{provide:jx,useValue:()=>xl=null},...t]})}(a,i))}return function bN(t){const n=Xm();if(!n)throw new At(401,"");return n}()}}function Xm(){var t;return null!==(t=null==xl?void 0:xl.get(Ux))&&void 0!==t?t:null}let Ux=(()=>{class t{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,i){const a=function CN(t,n){let e;return e="noop"===t?new hN:("zone.js"===t?void 0:t)||new Cn({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==n?void 0:n.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==n?void 0:n.ngZoneRunCoalescing)}),e}(i?i.ngZone:void 0,{ngZoneEventCoalescing:i&&i.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:i&&i.ngZoneRunCoalescing||!1}),h=[{provide:Cn,useValue:a}];return a.run(()=>{const w=Yr.create({providers:h,parent:this.injector,name:e.moduleType.name}),X=e.create(w),fe=X.injector.get(rd,null);if(!fe)throw new At(402,"");return a.runOutsideAngular(()=>{const pe=a.onError.subscribe({next:we=>{fe.handleError(we)}});X.onDestroy(()=>{Jm(this._modules,X),pe.unsubscribe()})}),function xN(t,n,e){try{const i=e();return $h(i)?i.catch(r=>{throw n.runOutsideAngular(()=>t.handleError(r)),r}):i}catch(i){throw n.runOutsideAngular(()=>t.handleError(i)),i}}(fe,a,()=>{const pe=X.injector.get(Vm);return pe.runInitializers(),pe.donePromise.then(()=>(function o4(t){ss(t,"Expected localeId to be defined"),"string"==typeof t&&(kC=t.toLowerCase().replace(/_/g,"-"))}(X.injector.get(Da,yh)||yh),this._moduleDoBootstrap(X),X))})})}bootstrapModule(e,i=[]){const r=Vx({},i);return function mN(t,n,e){const i=new Im(e);return Promise.resolve(i)}(0,0,e).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(e){const i=e.injector.get(Qm);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!e.instance.ngDoBootstrap)throw new At(403,"");e.instance.ngDoBootstrap(i)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new At(404,"");this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const e=this._injector.get(jx,null);null==e||e(),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)(an(Yr))},t.\u0275prov=rn({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();function Vx(t,n){return Array.isArray(n)?n.reduce(Vx,t):Object.assign(Object.assign({},t),n)}let Qm=(()=>{class t{constructor(e,i,r,s){this._zone=e,this._injector=i,this._exceptionHandler=r,this._initStatus=s,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const o=new F(h=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{h.next(this._stable),h.complete()})}),a=new F(h=>{let w;this._zone.runOutsideAngular(()=>{w=this._zone.onStable.subscribe(()=>{Cn.assertNotInAngularZone(),qm(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,h.next(!0))})})});const X=this._zone.onUnstable.subscribe(()=>{Cn.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{h.next(!1)}))});return()=>{w.unsubscribe(),X.unsubscribe()}});this.isStable=cl(o,a.pipe(function kf(t={}){const{connector:n=(()=>new u),resetOnError:e=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=t;return s=>{let o,a,h,w=0,X=!1,fe=!1;const pe=()=>{null==a||a.unsubscribe(),a=void 0},we=()=>{pe(),o=h=void 0,X=fe=!1},Ie=()=>{const Pe=o;we(),null==Pe||Pe.unsubscribe()};return y((Pe,Be)=>{w++,!fe&&!X&&pe();const Le=h=null!=h?h:n();Be.add(()=>{w--,0===w&&!fe&&!X&&(a=ba(Ie,r))}),Le.subscribe(Be),!o&&w>0&&(o=new S({next:Fe=>Le.next(Fe),error:Fe=>{fe=!0,pe(),a=ba(we,e,Fe),Le.error(Fe)},complete:()=>{X=!0,pe(),a=ba(we,i),Le.complete()}}),$r(Pe).subscribe(o))})(s)}}()))}bootstrap(e,i){if(!this._initStatus.done)throw new At(405,"");let r;r=e instanceof ex?e:this._injector.get(Th).resolveComponentFactory(e),this.componentTypes.push(r.componentType);const s=function $N(t){return t.isBoundToModule}(r)?void 0:this._injector.get(Gc),a=r.create(Yr.NULL,[],i||r.selector,s),h=a.location.nativeElement,w=a.injector.get(Ym,null),X=w&&a.injector.get(pN);return w&&X&&X.registerApplication(h,w),a.onDestroy(()=>{this.detachView(a.hostView),Jm(this.components,a),X&&X.unregisterApplication(h)}),this._loadComponent(a),a}tick(){if(this._runningTick)throw new At(101,"");try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const i=e;this._views.push(i),i.attachToAppRef(this)}detachView(e){const i=e;Jm(this._views,i),i.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(iN,[]).concat(this._bootstrapListeners).forEach(r=>r(e))}ngOnDestroy(){this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return t.\u0275fac=function(e){return new(e||t)(an(Cn),an(Yr),an(rd),an(Vm))},t.\u0275prov=rn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function Jm(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}let qx=!0,Oi=(()=>{class t{}return t.__NG_ELEMENT_ID__=TN,t})();function TN(t){return function SN(t,n,e){if(Ff(t)&&!e){const i=cs(t.index,n);return new md(i,i)}return 47&t.type?new md(n[16],n):null}(Wi(),$t(),16==(16&t))}class Xx{constructor(){}supports(n){return ld(n)}create(n){return new PN(n)}}const AN=(t,n)=>n;class PN{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||AN}forEachItem(n){let e;for(e=this._itHead;null!==e;e=e._next)n(e)}forEachOperation(n){let e=this._itHead,i=this._removalsHead,r=0,s=null;for(;e||i;){const o=!i||e&&e.currentIndex<Jx(i,r,s)?e:i,a=Jx(o,r,s),h=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(e=e._next,null==o.previousIndex)r++;else{s||(s=[]);const w=a-r,X=h-r;if(w!=X){for(let pe=0;pe<w;pe++){const we=pe<s.length?s[pe]:s[pe]=0,Ie=we+pe;X<=Ie&&Ie<w&&(s[pe]=we+1)}s[o.previousIndex]=X-w}}a!==h&&n(o,a,h)}}forEachPreviousItem(n){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachMovedItem(n){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}forEachIdentityChange(n){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)n(e)}diff(n){if(null==n&&(n=[]),!ld(n))throw new At(900,"");return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let r,s,o,e=this._itHead,i=!1;if(Array.isArray(n)){this.length=n.length;for(let a=0;a<this.length;a++)s=n[a],o=this._trackByFn(a,s),null!==e&&Object.is(e.trackById,o)?(i&&(e=this._verifyReinsertion(e,s,o,a)),Object.is(e.item,s)||this._addIdentityChange(e,s)):(e=this._mismatch(e,s,o,a),i=!0),e=e._next}else r=0,function qA(t,n){if(Array.isArray(t))for(let e=0;e<t.length;e++)n(t[e]);else{const e=t[Mc()]();let i;for(;!(i=e.next()).done;)n(i.value)}}(n,a=>{o=this._trackByFn(r,a),null!==e&&Object.is(e.trackById,o)?(i&&(e=this._verifyReinsertion(e,a,o,r)),Object.is(e.item,a)||this._addIdentityChange(e,a)):(e=this._mismatch(e,a,o,r),i=!0),e=e._next,r++}),this.length=r;return this._truncate(e),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,e,i,r){let s;return null===n?s=this._itTail:(s=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._reinsertAfter(n,s,r)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._moveAfter(n,s,r)):n=this._addAfter(new NN(e,i),s,r),n}_verifyReinsertion(n,e,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?n=this._reinsertAfter(s,n._prev,r):n.currentIndex!=r&&(n.currentIndex=r,this._addToMoves(n,r)),n}_truncate(n){for(;null!==n;){const e=n._next;this._addToRemovals(this._unlink(n)),n=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,e,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const r=n._prevRemoved,s=n._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(n,e,i),this._addToMoves(n,i),n}_moveAfter(n,e,i){return this._unlink(n),this._insertAfter(n,e,i),this._addToMoves(n,i),n}_addAfter(n,e,i){return this._insertAfter(n,e,i),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,e,i){const r=null===e?this._itHead:e._next;return n._next=r,n._prev=e,null===r?this._itTail=n:r._prev=n,null===e?this._itHead=n:e._next=n,null===this._linkedRecords&&(this._linkedRecords=new Qx),this._linkedRecords.put(n),n.currentIndex=i,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const e=n._prev,i=n._next;return null===e?this._itHead=i:e._next=i,null===i?this._itTail=e:i._prev=e,n}_addToMoves(n,e){return n.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Qx),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,e){return n.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class NN{constructor(n,e){this.item=n,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class FN{constructor(){this._head=null,this._tail=null}add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,e){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===e||e<=i.currentIndex)&&Object.is(i.trackById,n))return i;return null}remove(n){const e=n._prevDup,i=n._nextDup;return null===e?this._head=i:e._nextDup=i,null===i?this._tail=e:i._prevDup=e,null===this._head}}class Qx{constructor(){this.map=new Map}put(n){const e=n.trackById;let i=this.map.get(e);i||(i=new FN,this.map.set(e,i)),i.add(n)}get(n,e){const r=this.map.get(n);return r?r.get(n,e):null}remove(n){const e=n.trackById;return this.map.get(e).remove(n)&&this.map.delete(e),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Jx(t,n,e){const i=t.previousIndex;if(null===i)return i;let r=0;return e&&i<e.length&&(r=e[i]),i+n+r}class e2{constructor(){}supports(n){return n instanceof Map||cm(n)}create(){return new ON}}class ON{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(n){let e;for(e=this._mapHead;null!==e;e=e._next)n(e)}forEachPreviousItem(n){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)n(e)}forEachChangedItem(n){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}diff(n){if(n){if(!(n instanceof Map||cm(n)))throw new At(900,"")}else n=new Map;return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(n,(i,r)=>{if(e&&e.key===r)this._maybeAddToChanges(e,i),this._appendAfter=e,e=e._next;else{const s=this._getOrCreateRecordForKey(r,i);e=this._insertBeforeOrAppend(e,s)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let i=e;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,e){if(n){const i=n._prev;return e._next=n,e._prev=i,n._prev=e,i&&(i._next=e),n===this._mapHead&&(this._mapHead=e),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(n,e){if(this._records.has(n)){const r=this._records.get(n);this._maybeAddToChanges(r,e);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new RN(n);return this._records.set(n,i),i.currentValue=e,this._addToAdditions(i),i}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;null!==n;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;null!=n;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,e){Object.is(e,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=e,this._addToChanges(n))}_addToAdditions(n){null===this._additionsHead?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){null===this._changesHead?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,e){n instanceof Map?n.forEach(e):Object.keys(n).forEach(i=>e(n[i],i))}}class RN{constructor(n){this.key=n,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function t2(){return new Fh([new Xx])}let Fh=(()=>{class t{constructor(e){this.factories=e}static create(e,i){if(null!=i){const r=i.factories.slice();e=e.concat(r)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>t.create(e,i||t2()),deps:[[t,new eh,new Jf]]}}find(e){const i=this.factories.find(r=>r.supports(e));if(null!=i)return i;throw new At(901,"")}}return t.\u0275prov=rn({token:t,providedIn:"root",factory:t2}),t})();function n2(){return new xd([new e2])}let xd=(()=>{class t{constructor(e){this.factories=e}static create(e,i){if(i){const r=i.factories.slice();e=e.concat(r)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>t.create(e,i||n2()),deps:[[t,new eh,new Jf]]}}find(e){const i=this.factories.find(s=>s.supports(e));if(i)return i;throw new At(901,"")}}return t.\u0275prov=rn({token:t,providedIn:"root",factory:n2}),t})();const zN=Hx(null,"core",[]);let jN=(()=>{class t{constructor(e){}}return t.\u0275fac=function(e){return new(e||t)(an(Qm))},t.\u0275mod=Ss({type:t}),t.\u0275inj=os({}),t})(),Oh=null;function El(){return Oh}const Xr=new On("DocumentToken");var Ri=(()=>((Ri=Ri||{})[Ri.Format=0]="Format",Ri[Ri.Standalone=1]="Standalone",Ri))(),Nn=(()=>((Nn=Nn||{})[Nn.Narrow=0]="Narrow",Nn[Nn.Abbreviated=1]="Abbreviated",Nn[Nn.Wide=2]="Wide",Nn[Nn.Short=3]="Short",Nn))(),ki=(()=>((ki=ki||{})[ki.Short=0]="Short",ki[ki.Medium=1]="Medium",ki[ki.Long=2]="Long",ki[ki.Full=3]="Full",ki))(),Zt=(()=>((Zt=Zt||{})[Zt.Decimal=0]="Decimal",Zt[Zt.Group=1]="Group",Zt[Zt.List=2]="List",Zt[Zt.PercentSign=3]="PercentSign",Zt[Zt.PlusSign=4]="PlusSign",Zt[Zt.MinusSign=5]="MinusSign",Zt[Zt.Exponential=6]="Exponential",Zt[Zt.SuperscriptingExponent=7]="SuperscriptingExponent",Zt[Zt.PerMille=8]="PerMille",Zt[Zt.Infinity=9]="Infinity",Zt[Zt.NaN=10]="NaN",Zt[Zt.TimeSeparator=11]="TimeSeparator",Zt[Zt.CurrencyDecimal=12]="CurrencyDecimal",Zt[Zt.CurrencyGroup=13]="CurrencyGroup",Zt))();function Rh(t,n){return Ns(Lr(t)[Dt.DateFormat],n)}function Bh(t,n){return Ns(Lr(t)[Dt.TimeFormat],n)}function Lh(t,n){return Ns(Lr(t)[Dt.DateTimeFormat],n)}function Ps(t,n){const e=Lr(t),i=e[Dt.NumberSymbols][n];if(void 0===i){if(n===Zt.CurrencyDecimal)return e[Dt.NumberSymbols][Zt.Decimal];if(n===Zt.CurrencyGroup)return e[Dt.NumberSymbols][Zt.Group]}return i}function o2(t){if(!t[Dt.ExtraData])throw new Error(`Missing extra locale data for the locale "${t[Dt.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Ns(t,n){for(let e=n;e>-1;e--)if(void 0!==t[e])return t[e];throw new Error("Locale data API: locale data undefined")}function s$(t){const[n,e]=t.split(":");return{hours:+n,minutes:+e}}const oF=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,wd={},aF=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Qi=(()=>((Qi=Qi||{})[Qi.Short=0]="Short",Qi[Qi.ShortGMT=1]="ShortGMT",Qi[Qi.Long=2]="Long",Qi[Qi.Extended=3]="Extended",Qi))(),Jt=(()=>((Jt=Jt||{})[Jt.FullYear=0]="FullYear",Jt[Jt.Month=1]="Month",Jt[Jt.Date=2]="Date",Jt[Jt.Hours=3]="Hours",Jt[Jt.Minutes=4]="Minutes",Jt[Jt.Seconds=5]="Seconds",Jt[Jt.FractionalSeconds=6]="FractionalSeconds",Jt[Jt.Day=7]="Day",Jt))(),xn=(()=>((xn=xn||{})[xn.DayPeriods=0]="DayPeriods",xn[xn.Days=1]="Days",xn[xn.Months=2]="Months",xn[xn.Eras=3]="Eras",xn))();function Ed(t,n,e,i){let r=function _F(t){if(c2(t))return t;if("number"==typeof t&&!isNaN(t))return new Date(t);if("string"==typeof t){if(t=t.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(t)){const[r,s=1,o=1]=t.split("-").map(a=>+a);return zh(r,s-1,o)}const e=parseFloat(t);if(!isNaN(t-e))return new Date(e);let i;if(i=t.match(oF))return function mF(t){const n=new Date(0);let e=0,i=0;const r=t[8]?n.setUTCFullYear:n.setFullYear,s=t[8]?n.setUTCHours:n.setHours;t[9]&&(e=Number(t[9]+t[10]),i=Number(t[9]+t[11])),r.call(n,Number(t[1]),Number(t[2])-1,Number(t[3]));const o=Number(t[4]||0)-e,a=Number(t[5]||0)-i,h=Number(t[6]||0),w=Math.floor(1e3*parseFloat("0."+(t[7]||0)));return s.call(n,o,a,h,w),n}(i)}const n=new Date(t);if(!c2(n))throw new Error(`Unable to convert "${t}" into a date`);return n}(t);n=aa(e,n)||n;let a,o=[];for(;n;){if(a=aF.exec(n),!a){o.push(n);break}{o=o.concat(a.slice(1));const X=o.pop();if(!X)break;n=X}}let h=r.getTimezoneOffset();i&&(h=l2(i,h),r=function gF(t,n,e){const i=e?-1:1,r=t.getTimezoneOffset();return function pF(t,n){return(t=new Date(t.getTime())).setMinutes(t.getMinutes()+n),t}(t,i*(l2(n,r)-r))}(r,i,!0));let w="";return o.forEach(X=>{const fe=function hF(t){if(a$[t])return a$[t];let n;switch(t){case"G":case"GG":case"GGG":n=_i(xn.Eras,Nn.Abbreviated);break;case"GGGG":n=_i(xn.Eras,Nn.Wide);break;case"GGGGG":n=_i(xn.Eras,Nn.Narrow);break;case"y":n=Hi(Jt.FullYear,1,0,!1,!0);break;case"yy":n=Hi(Jt.FullYear,2,0,!0,!0);break;case"yyy":n=Hi(Jt.FullYear,3,0,!1,!0);break;case"yyyy":n=Hi(Jt.FullYear,4,0,!1,!0);break;case"Y":n=Vh(1);break;case"YY":n=Vh(2,!0);break;case"YYY":n=Vh(3);break;case"YYYY":n=Vh(4);break;case"M":case"L":n=Hi(Jt.Month,1,1);break;case"MM":case"LL":n=Hi(Jt.Month,2,1);break;case"MMM":n=_i(xn.Months,Nn.Abbreviated);break;case"MMMM":n=_i(xn.Months,Nn.Wide);break;case"MMMMM":n=_i(xn.Months,Nn.Narrow);break;case"LLL":n=_i(xn.Months,Nn.Abbreviated,Ri.Standalone);break;case"LLLL":n=_i(xn.Months,Nn.Wide,Ri.Standalone);break;case"LLLLL":n=_i(xn.Months,Nn.Narrow,Ri.Standalone);break;case"w":n=o$(1);break;case"ww":n=o$(2);break;case"W":n=o$(1,!0);break;case"d":n=Hi(Jt.Date,1);break;case"dd":n=Hi(Jt.Date,2);break;case"c":case"cc":n=Hi(Jt.Day,1);break;case"ccc":n=_i(xn.Days,Nn.Abbreviated,Ri.Standalone);break;case"cccc":n=_i(xn.Days,Nn.Wide,Ri.Standalone);break;case"ccccc":n=_i(xn.Days,Nn.Narrow,Ri.Standalone);break;case"cccccc":n=_i(xn.Days,Nn.Short,Ri.Standalone);break;case"E":case"EE":case"EEE":n=_i(xn.Days,Nn.Abbreviated);break;case"EEEE":n=_i(xn.Days,Nn.Wide);break;case"EEEEE":n=_i(xn.Days,Nn.Narrow);break;case"EEEEEE":n=_i(xn.Days,Nn.Short);break;case"a":case"aa":case"aaa":n=_i(xn.DayPeriods,Nn.Abbreviated);break;case"aaaa":n=_i(xn.DayPeriods,Nn.Wide);break;case"aaaaa":n=_i(xn.DayPeriods,Nn.Narrow);break;case"b":case"bb":case"bbb":n=_i(xn.DayPeriods,Nn.Abbreviated,Ri.Standalone,!0);break;case"bbbb":n=_i(xn.DayPeriods,Nn.Wide,Ri.Standalone,!0);break;case"bbbbb":n=_i(xn.DayPeriods,Nn.Narrow,Ri.Standalone,!0);break;case"B":case"BB":case"BBB":n=_i(xn.DayPeriods,Nn.Abbreviated,Ri.Format,!0);break;case"BBBB":n=_i(xn.DayPeriods,Nn.Wide,Ri.Format,!0);break;case"BBBBB":n=_i(xn.DayPeriods,Nn.Narrow,Ri.Format,!0);break;case"h":n=Hi(Jt.Hours,1,-12);break;case"hh":n=Hi(Jt.Hours,2,-12);break;case"H":n=Hi(Jt.Hours,1);break;case"HH":n=Hi(Jt.Hours,2);break;case"m":n=Hi(Jt.Minutes,1);break;case"mm":n=Hi(Jt.Minutes,2);break;case"s":n=Hi(Jt.Seconds,1);break;case"ss":n=Hi(Jt.Seconds,2);break;case"S":n=Hi(Jt.FractionalSeconds,1);break;case"SS":n=Hi(Jt.FractionalSeconds,2);break;case"SSS":n=Hi(Jt.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":n=Hh(Qi.Short);break;case"ZZZZZ":n=Hh(Qi.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":n=Hh(Qi.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":n=Hh(Qi.Long);break;default:return null}return a$[t]=n,n}(X);w+=fe?fe(r,e,h):"''"===X?"'":X.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),w}function zh(t,n,e){const i=new Date(0);return i.setFullYear(t,n,e),i.setHours(0,0,0),i}function aa(t,n){const e=function KN(t){return Lr(t)[Dt.LocaleId]}(t);if(wd[e]=wd[e]||{},wd[e][n])return wd[e][n];let i="";switch(n){case"shortDate":i=Rh(t,ki.Short);break;case"mediumDate":i=Rh(t,ki.Medium);break;case"longDate":i=Rh(t,ki.Long);break;case"fullDate":i=Rh(t,ki.Full);break;case"shortTime":i=Bh(t,ki.Short);break;case"mediumTime":i=Bh(t,ki.Medium);break;case"longTime":i=Bh(t,ki.Long);break;case"fullTime":i=Bh(t,ki.Full);break;case"short":const r=aa(t,"shortTime"),s=aa(t,"shortDate");i=jh(Lh(t,ki.Short),[r,s]);break;case"medium":const o=aa(t,"mediumTime"),a=aa(t,"mediumDate");i=jh(Lh(t,ki.Medium),[o,a]);break;case"long":const h=aa(t,"longTime"),w=aa(t,"longDate");i=jh(Lh(t,ki.Long),[h,w]);break;case"full":const X=aa(t,"fullTime"),fe=aa(t,"fullDate");i=jh(Lh(t,ki.Full),[X,fe])}return i&&(wd[e][n]=i),i}function jh(t,n){return n&&(t=t.replace(/\{([^}]+)}/g,function(e,i){return null!=n&&i in n?n[i]:e})),t}function fo(t,n,e="-",i,r){let s="";(t<0||r&&t<=0)&&(r?t=1-t:(t=-t,s=e));let o=String(t);for(;o.length<n;)o="0"+o;return i&&(o=o.substr(o.length-n)),s+o}function Hi(t,n,e=0,i=!1,r=!1){return function(s,o){let a=function cF(t,n){switch(t){case Jt.FullYear:return n.getFullYear();case Jt.Month:return n.getMonth();case Jt.Date:return n.getDate();case Jt.Hours:return n.getHours();case Jt.Minutes:return n.getMinutes();case Jt.Seconds:return n.getSeconds();case Jt.FractionalSeconds:return n.getMilliseconds();case Jt.Day:return n.getDay();default:throw new Error(`Unknown DateType value "${t}".`)}}(t,s);if((e>0||a>-e)&&(a+=e),t===Jt.Hours)0===a&&-12===e&&(a=12);else if(t===Jt.FractionalSeconds)return function lF(t,n){return fo(t,3).substr(0,n)}(a,n);const h=Ps(o,Zt.MinusSign);return fo(a,n,h,i,r)}}function _i(t,n,e=Ri.Format,i=!1){return function(r,s){return function uF(t,n,e,i,r,s){switch(e){case xn.Months:return function XN(t,n,e){const i=Lr(t),s=Ns([i[Dt.MonthsFormat],i[Dt.MonthsStandalone]],n);return Ns(s,e)}(n,r,i)[t.getMonth()];case xn.Days:return function ZN(t,n,e){const i=Lr(t),s=Ns([i[Dt.DaysFormat],i[Dt.DaysStandalone]],n);return Ns(s,e)}(n,r,i)[t.getDay()];case xn.DayPeriods:const o=t.getHours(),a=t.getMinutes();if(s){const w=function tF(t){const n=Lr(t);return o2(n),(n[Dt.ExtraData][2]||[]).map(i=>"string"==typeof i?s$(i):[s$(i[0]),s$(i[1])])}(n),X=function nF(t,n,e){const i=Lr(t);o2(i);const s=Ns([i[Dt.ExtraData][0],i[Dt.ExtraData][1]],n)||[];return Ns(s,e)||[]}(n,r,i),fe=w.findIndex(pe=>{if(Array.isArray(pe)){const[we,Ie]=pe,Pe=o>=we.hours&&a>=we.minutes,Be=o<Ie.hours||o===Ie.hours&&a<Ie.minutes;if(we.hours<Ie.hours){if(Pe&&Be)return!0}else if(Pe||Be)return!0}else if(pe.hours===o&&pe.minutes===a)return!0;return!1});if(-1!==fe)return X[fe]}return function YN(t,n,e){const i=Lr(t),s=Ns([i[Dt.DayPeriodsFormat],i[Dt.DayPeriodsStandalone]],n);return Ns(s,e)}(n,r,i)[o<12?0:1];case xn.Eras:return function QN(t,n){return Ns(Lr(t)[Dt.Eras],n)}(n,i)[t.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(r,s,t,n,e,i)}}function Hh(t){return function(n,e,i){const r=-1*i,s=Ps(e,Zt.MinusSign),o=r>0?Math.floor(r/60):Math.ceil(r/60);switch(t){case Qi.Short:return(r>=0?"+":"")+fo(o,2,s)+fo(Math.abs(r%60),2,s);case Qi.ShortGMT:return"GMT"+(r>=0?"+":"")+fo(o,1,s);case Qi.Long:return"GMT"+(r>=0?"+":"")+fo(o,2,s)+":"+fo(Math.abs(r%60),2,s);case Qi.Extended:return 0===i?"Z":(r>=0?"+":"")+fo(o,2,s)+":"+fo(Math.abs(r%60),2,s);default:throw new Error(`Unknown zone width "${t}"`)}}}function a2(t){return zh(t.getFullYear(),t.getMonth(),t.getDate()+(4-t.getDay()))}function o$(t,n=!1){return function(e,i){let r;if(n){const s=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,o=e.getDate();r=1+Math.floor((o+s)/7)}else{const s=a2(e),o=function fF(t){const n=zh(t,0,1).getDay();return zh(t,0,1+(n<=4?4:11)-n)}(s.getFullYear()),a=s.getTime()-o.getTime();r=1+Math.round(a/6048e5)}return fo(r,t,Ps(i,Zt.MinusSign))}}function Vh(t,n=!1){return function(e,i){return fo(a2(e).getFullYear(),t,Ps(i,Zt.MinusSign),n)}}const a$={};function l2(t,n){t=t.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+t)/6e4;return isNaN(e)?n:e}function c2(t){return t instanceof Date&&!isNaN(t.valueOf())}let Yn=(()=>{class t{constructor(e,i,r,s){this._iterableDiffers=e,this._keyValueDiffers=i,this._ngEl=r,this._renderer=s,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(ld(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(i=>this._toggleClass(i.key,i.currentValue)),e.forEachChangedItem(i=>this._toggleClass(i.key,i.currentValue)),e.forEachRemovedItem(i=>{i.previousValue&&this._toggleClass(i.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(i=>{if("string"!=typeof i.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${qn(i.item)}`);this._toggleClass(i.item,!0)}),e.forEachRemovedItem(i=>this._toggleClass(i.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(i=>this._toggleClass(i,!0)):Object.keys(e).forEach(i=>this._toggleClass(i,!!e[i])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(i=>this._toggleClass(i,!1)):Object.keys(e).forEach(i=>this._toggleClass(i,!1)))}_toggleClass(e,i){(e=e.trim())&&e.split(/\s+/g).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return t.\u0275fac=function(e){return new(e||t)(He(Fh),He(xd),He(yi),He(Cl))},t.\u0275dir=Qt({type:t,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),t})();class DF{constructor(n,e,i,r){this.$implicit=n,this.ngForOf=e,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let oi=(()=>{class t{constructor(e,i,r){this._viewContainer=e,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const i=this._viewContainer;e.forEachOperation((r,s,o)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new DF(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)i.remove(null===s?void 0:s);else if(null!==s){const a=i.get(s);i.move(a,o),h2(a,r)}});for(let r=0,s=i.length;r<s;r++){const a=i.get(r).context;a.index=r,a.count=s,a.ngForOf=this._ngForOf}e.forEachIdentityChange(r=>{h2(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(e,i){return!0}}return t.\u0275fac=function(e){return new(e||t)(He(zr),He(oa),He(Fh))},t.\u0275dir=Qt({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),t})();function h2(t,n){t.context.$implicit=n.item}let bn=(()=>{class t{constructor(e,i){this._viewContainer=e,this._context=new AF,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){p2("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){p2("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,i){return!0}}return t.\u0275fac=function(e){return new(e||t)(He(zr),He(oa))},t.\u0275dir=Qt({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),t})();class AF{constructor(){this.$implicit=null,this.ngIf=null}}function p2(t,n){if(n&&!n.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${qn(n)}'.`)}class h${constructor(n,e){this._viewContainerRef=n,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(n){n&&!this._created?this.create():!n&&this._created&&this.destroy()}}let Tl=(()=>{class t{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(e)}_matchCase(e){const i=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||i,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),i}_updateDefaultCases(e){if(this._defaultViews&&e!==this._defaultUsed){this._defaultUsed=e;for(let i=0;i<this._defaultViews.length;i++)this._defaultViews[i].enforceState(e)}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=Qt({type:t,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),t})(),Sd=(()=>{class t{constructor(e,i,r){this.ngSwitch=r,r._addCase(),this._view=new h$(e,i)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return t.\u0275fac=function(e){return new(e||t)(He(zr),He(oa),He(Tl,9))},t.\u0275dir=Qt({type:t,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),t})(),Id=(()=>{class t{constructor(e,i,r){r._addDefault(new h$(e,i))}}return t.\u0275fac=function(e){return new(e||t)(He(zr),He(oa),He(Tl,9))},t.\u0275dir=Qt({type:t,selectors:[["","ngSwitchDefault",""]]}),t})(),Ji=(()=>{class t{constructor(e,i,r){this._ngEl=e,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,i){const[r,s]=e.split(".");null!=(i=null!=i&&s?`${i}${s}`:i)?this._renderer.setStyle(this._ngEl.nativeElement,r,i):this._renderer.removeStyle(this._ngEl.nativeElement,r)}_applyChanges(e){e.forEachRemovedItem(i=>this._setStyle(i.key,null)),e.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),e.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}}return t.\u0275fac=function(e){return new(e||t)(He(yi),He(xd),He(Cl))},t.\u0275dir=Qt({type:t,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}}),t})(),Sl=(()=>{class t{constructor(e){this._viewContainerRef=e,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null}ngOnChanges(e){if(e.ngTemplateOutlet){const i=this._viewContainerRef;this._viewRef&&i.remove(i.indexOf(this._viewRef)),this._viewRef=this.ngTemplateOutlet?i.createEmbeddedView(this.ngTemplateOutlet,this.ngTemplateOutletContext):null}else this._viewRef&&e.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return t.\u0275fac=function(e){return new(e||t)(He(zr))},t.\u0275dir=Qt({type:t,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet"},features:[io]}),t})();const UF=new On("DATE_PIPE_DEFAULT_TIMEZONE");let _2=(()=>{class t{constructor(e,i){this.locale=e,this.defaultTimezone=i}transform(e,i="mediumDate",r,s){var o;if(null==e||""===e||e!=e)return null;try{return Ed(e,i,s||this.locale,null!==(o=null!=r?r:this.defaultTimezone)&&void 0!==o?o:void 0)}catch(a){throw function ho(t,n){return new At(2100,"")}()}}}return t.\u0275fac=function(e){return new(e||t)(He(Da,16),He(UF,24))},t.\u0275pipe=yr({name:"date",type:t,pure:!0}),t})(),$2=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ss({type:t}),t.\u0275inj=os({}),t})();const v2="browser";function _$(t){return t===v2}class m$ extends class sO extends class VN{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function UN(t){Oh||(Oh=t)}(new m$)}onAndCancel(n,e,i){return n.addEventListener(e,i,!1),()=>{n.removeEventListener(e,i,!1)}}dispatchEvent(n,e){n.dispatchEvent(e)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,e){return(e=e||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,e){return"window"===e?window:"document"===e?n:"body"===e?n.body:null}getBaseHref(n){const e=function oO(){return kd=kd||document.querySelector("base"),kd?kd.getAttribute("href"):null}();return null==e?null:function aO(t){qh=qh||document.createElement("a"),qh.setAttribute("href",t);const n=qh.pathname;return"/"===n.charAt(0)?n:`/${n}`}(e)}resetBaseElement(){kd=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return function kF(t,n){n=encodeURIComponent(n);for(const e of t.split(";")){const i=e.indexOf("="),[r,s]=-1==i?[e,""]:[e.slice(0,i),e.slice(i+1)];if(r.trim()===n)return decodeURIComponent(s)}return null}(document.cookie,n)}}let qh,kd=null;const y2=new On("TRANSITION_ID"),cO=[{provide:Um,useFactory:function lO(t,n,e){return()=>{e.get(Vm).donePromise.then(()=>{const i=El(),r=n.querySelectorAll(`style[ng-transition="${t}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[y2,Xr,Yr],multi:!0}];class $${static init(){!function _N(t){Zm=t}(new $$)}addToWindow(n){si.getAngularTestability=(i,r=!0)=>{const s=n.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},si.getAllAngularTestabilities=()=>n.getAllTestabilities(),si.getAllAngularRootElements=()=>n.getAllRootElements(),si.frameworkStabilizers||(si.frameworkStabilizers=[]),si.frameworkStabilizers.push(i=>{const r=si.getAllAngularTestabilities();let s=r.length,o=!1;const a=function(h){o=o||h,s--,0==s&&i(o)};r.forEach(function(h){h.whenStable(a)})})}findTestabilityInTree(n,e,i){if(null==e)return null;const r=n.getTestability(e);return null!=r?r:i?El().isShadowRoot(e)?this.findTestabilityInTree(n,e.host,!0):this.findTestabilityInTree(n,e.parentElement,!0):null}}let uO=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=rn({token:t,factory:t.\u0275fac}),t})();const Wh=new On("EventManagerPlugins");let Kh=(()=>{class t{constructor(e,i){this._zone=i,this._eventNameToPlugin=new Map,e.forEach(r=>r.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,i,r){return this._findPluginFor(i).addEventListener(e,i,r)}addGlobalEventListener(e,i,r){return this._findPluginFor(i).addGlobalEventListener(e,i,r)}getZone(){return this._zone}_findPluginFor(e){const i=this._eventNameToPlugin.get(e);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(e))return this._eventNameToPlugin.set(e,o),o}throw new Error(`No event manager plugin found for event ${e}`)}}return t.\u0275fac=function(e){return new(e||t)(an(Wh),an(Cn))},t.\u0275prov=rn({token:t,factory:t.\u0275fac}),t})();class C2{constructor(n){this._doc=n}addGlobalEventListener(n,e,i){const r=El().getGlobalEventTarget(this._doc,n);if(!r)throw new Error(`Unsupported event target ${r} for event ${e}`);return this.addEventListener(r,e,i)}}let x2=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(e){const i=new Set;e.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=rn({token:t,factory:t.\u0275fac}),t})(),Md=(()=>{class t extends x2{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,i,r){e.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,r.push(i.appendChild(o))})}addHost(e){const i=[];this._addStylesToHost(this._stylesSet,e,i),this._hostNodes.set(e,i)}removeHost(e){const i=this._hostNodes.get(e);i&&i.forEach(w2),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(e,r,i)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(w2))}}return t.\u0275fac=function(e){return new(e||t)(an(Xr))},t.\u0275prov=rn({token:t,factory:t.\u0275fac}),t})();function w2(t){El().remove(t)}const v$={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},b$=/%COMP%/g;function Yh(t,n,e){for(let i=0;i<n.length;i++){let r=n[i];Array.isArray(r)?Yh(t,r,e):(r=r.replace(b$,t),e.push(r))}return e}function S2(t){return n=>{if("__ngUnwrap__"===n)return t;!1===t(n)&&(n.preventDefault(),n.returnValue=!1)}}let Zh=(()=>{class t{constructor(e,i,r){this.eventManager=e,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new y$(e)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;switch(i.encapsulation){case Js.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new _O(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(e),r}case 1:case Js.ShadowDom:return new mO(this.eventManager,this.sharedStylesHost,e,i);default:if(!this.rendererByCompId.has(i.id)){const r=Yh(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)(an(Kh),an(Md),an(yd))},t.\u0275prov=rn({token:t,factory:t.\u0275fac}),t})();class y${constructor(n){this.eventManager=n,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(n,e){return e?document.createElementNS(v$[e]||e,n):document.createElement(n)}createComment(n){return document.createComment(n)}createText(n){return document.createTextNode(n)}appendChild(n,e){n.appendChild(e)}insertBefore(n,e,i){n&&n.insertBefore(e,i)}removeChild(n,e){n&&n.removeChild(e)}selectRootElement(n,e){let i="string"==typeof n?document.querySelector(n):n;if(!i)throw new Error(`The selector "${n}" did not match any elements`);return e||(i.textContent=""),i}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,e,i,r){if(r){e=r+":"+e;const s=v$[r];s?n.setAttributeNS(s,e,i):n.setAttribute(e,i)}else n.setAttribute(e,i)}removeAttribute(n,e,i){if(i){const r=v$[i];r?n.removeAttributeNS(r,e):n.removeAttribute(`${i}:${e}`)}else n.removeAttribute(e)}addClass(n,e){n.classList.add(e)}removeClass(n,e){n.classList.remove(e)}setStyle(n,e,i,r){r&(ds.DashCase|ds.Important)?n.style.setProperty(e,i,r&ds.Important?"important":""):n.style[e]=i}removeStyle(n,e,i){i&ds.DashCase?n.style.removeProperty(e):n.style[e]=""}setProperty(n,e,i){n[e]=i}setValue(n,e){n.nodeValue=e}listen(n,e,i){return"string"==typeof n?this.eventManager.addGlobalEventListener(n,e,S2(i)):this.eventManager.addEventListener(n,e,S2(i))}}class _O extends y${constructor(n,e,i,r){super(n),this.component=i;const s=Yh(r+"-"+i.id,i.styles,[]);e.addStyles(s),this.contentAttr=function hO(t){return"_ngcontent-%COMP%".replace(b$,t)}(r+"-"+i.id),this.hostAttr=function pO(t){return"_nghost-%COMP%".replace(b$,t)}(r+"-"+i.id)}applyToHost(n){super.setAttribute(n,this.hostAttr,"")}createElement(n,e){const i=super.createElement(n,e);return super.setAttribute(i,this.contentAttr,""),i}}class mO extends y${constructor(n,e,i,r){super(n),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=Yh(r.id,r.styles,[]);for(let o=0;o<s.length;o++){const a=document.createElement("style");a.textContent=s[o],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(n,e){return super.appendChild(this.nodeOrShadowRoot(n),e)}insertBefore(n,e,i){return super.insertBefore(this.nodeOrShadowRoot(n),e,i)}removeChild(n,e){return super.removeChild(this.nodeOrShadowRoot(n),e)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}}let $O=(()=>{class t extends C2{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,r){return e.addEventListener(i,r,!1),()=>this.removeEventListener(e,i,r)}removeEventListener(e,i,r){return e.removeEventListener(i,r)}}return t.\u0275fac=function(e){return new(e||t)(an(Xr))},t.\u0275prov=rn({token:t,factory:t.\u0275fac}),t})();const k2=["alt","control","meta","shift"],bO={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},M2={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},yO={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let CO=(()=>{class t extends C2{constructor(e){super(e)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,i,r){const s=t.parseEventName(i),o=t.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>El().onAndCancel(e,s.domEventName,o))}static parseEventName(e){const i=e.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=t._normalizeKey(i.pop());let o="";if(k2.forEach(h=>{const w=i.indexOf(h);w>-1&&(i.splice(w,1),o+=h+".")}),o+=s,0!=i.length||0===s.length)return null;const a={};return a.domEventName=r,a.fullKey=o,a}static getEventFullKey(e){let i="",r=function xO(t){let n=t.key;if(null==n){if(n=t.keyIdentifier,null==n)return"Unidentified";n.startsWith("U+")&&(n=String.fromCharCode(parseInt(n.substring(2),16)),3===t.location&&M2.hasOwnProperty(n)&&(n=M2[n]))}return bO[n]||n}(e);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),k2.forEach(s=>{s!=r&&yO[s](e)&&(i+=s+".")}),i+=r,i}static eventCallback(e,i,r){return s=>{t.getEventFullKey(s)===e&&r.runGuarded(()=>i(s))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return t.\u0275fac=function(e){return new(e||t)(an(Xr))},t.\u0275prov=rn({token:t,factory:t.\u0275fac}),t})();const SO=Hx(zN,"browser",[{provide:Cd,useValue:v2},{provide:Rx,useValue:function wO(){m$.makeCurrent(),$$.init()},multi:!0},{provide:Xr,useFactory:function TO(){return function ik(t){zg=t}(document),document},deps:[]}]),IO=[{provide:im,useValue:"root"},{provide:rd,useFactory:function EO(){return new rd},deps:[]},{provide:Wh,useClass:$O,multi:!0,deps:[Xr,Cn,Cd]},{provide:Wh,useClass:CO,multi:!0,deps:[Xr]},{provide:Zh,useClass:Zh,deps:[Kh,Md,yd]},{provide:_d,useExisting:Zh},{provide:x2,useExisting:Md},{provide:Md,useClass:Md,deps:[Xr]},{provide:Ym,useClass:Ym,deps:[Cn]},{provide:Kh,useClass:Kh,deps:[Wh,Cn]},{provide:class rO{},useClass:uO,deps:[]}];let D2=(()=>{class t{constructor(e){if(e)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:t,providers:[{provide:yd,useValue:e.appId},{provide:y2,useExisting:yd},cO]}}}return t.\u0275fac=function(e){return new(e||t)(an(t,12))},t.\u0275mod=Ss({type:t}),t.\u0275inj=os({providers:IO,imports:[$2,jN]}),t})();"undefined"!=typeof window&&window;let N2=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=rn({token:t,factory:function(e){let i=null;return i=e?new(e||t):an(F2),i},providedIn:"root"}),t})(),F2=(()=>{class t extends N2{constructor(e){super(),this._doc=e}sanitize(e,i){if(null==i)return null;switch(e){case pi.NONE:return i;case pi.HTML:return Io(i,"HTML")?fs(i):gb(this._doc,String(i)).toString();case pi.STYLE:return Io(i,"Style")?fs(i):i;case pi.SCRIPT:if(Io(i,"Script"))return fs(i);throw new Error("unsafe value used in a script context");case pi.URL:return ab(i),Io(i,"URL")?fs(i):td(String(i));case pi.RESOURCE_URL:if(Io(i,"ResourceURL"))return fs(i);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${e} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(e){return function UM(t){return new BM(t)}(e)}bypassSecurityTrustStyle(e){return function VM(t){return new LM(t)}(e)}bypassSecurityTrustScript(e){return function GM(t){return new zM(t)}(e)}bypassSecurityTrustUrl(e){return function qM(t){return new jM(t)}(e)}bypassSecurityTrustResourceUrl(e){return function WM(t){return new HM(t)}(e)}}return t.\u0275fac=function(e){return new(e||t)(an(Xr))},t.\u0275prov=rn({token:t,factory:function(e){let i=null;return i=e?new e:function BO(t){return new F2(t.get(Xr))}(an(Yr)),i},providedIn:"root"}),t})();me(5386);const{isArray:LO}=Array,{getPrototypeOf:zO,prototype:jO,keys:HO}=Object;function O2(t){if(1===t.length){const n=t[0];if(LO(n))return{args:n,keys:null};if(function UO(t){return t&&"object"==typeof t&&zO(t)===jO}(n)){const e=HO(n);return{args:e.map(i=>n[i]),keys:e}}}return{args:t,keys:null}}const{isArray:VO}=Array;function Dd(t){return se(n=>function GO(t,n){return VO(n)?t(...n):t(n)}(t,n))}function R2(t,n){return t.reduce((e,i,r)=>(e[i]=n[r],e),{})}let B2=(()=>{class t{constructor(e,i){this._renderer=e,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return t.\u0275fac=function(e){return new(e||t)(He(Cl),He(yi))},t.\u0275dir=Qt({type:t}),t})(),Il=(()=>{class t extends B2{}return t.\u0275fac=function(){let n;return function(i){return(n||(n=xr(t)))(i||t)}}(),t.\u0275dir=Qt({type:t,features:[ei]}),t})();const No=new On("NgValueAccessor"),WO={provide:No,useExisting:Xn(()=>Jr),multi:!0};let Jr=(()=>{class t extends Il{writeValue(e){this.setProperty("checked",e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=xr(t)))(i||t)}}(),t.\u0275dir=Qt({type:t,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(e,i){1&e&&Ae("change",function(s){return i.onChange(s.target.checked)})("blur",function(){return i.onTouched()})},features:[gi([WO]),ei]}),t})();const KO={provide:No,useExisting:Xn(()=>mi),multi:!0},L2=new On("CompositionEventMode");let mi=(()=>{class t extends B2{constructor(e,i,r){super(e,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function YO(){const t=El()?El().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(e){this.setProperty("value",null==e?"":e)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return t.\u0275fac=function(e){return new(e||t)(He(Cl),He(yi),He(L2,8))},t.\u0275dir=Qt({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,i){1&e&&Ae("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},features:[gi([KO]),ei]}),t})();function Pa(t){return null==t||0===t.length}function z2(t){return null!=t&&"number"==typeof t.length}const Tr=new On("NgValidators"),Na=new On("NgAsyncValidators");function U2(t){return Pa(t.value)?{required:!0}:null}function Xh(t){return null}function Y2(t){return null!=t}function Z2(t){const n=$h(t)?vr(t):t;return By(n),n}function X2(t){let n={};return t.forEach(e=>{n=null!=e?Object.assign(Object.assign({},n),e):n}),0===Object.keys(n).length?null:n}function Q2(t,n){return n.map(e=>e(t))}function J2(t){return t.map(n=>function XO(t){return!t.validate}(n)?n:e=>n.validate(e))}function x$(t){return null!=t?function ew(t){if(!t)return null;const n=t.filter(Y2);return 0==n.length?null:function(e){return X2(Q2(e,n))}}(J2(t)):null}function w$(t){return null!=t?function tw(t){if(!t)return null;const n=t.filter(Y2);return 0==n.length?null:function(e){return function qO(...t){const n=yo(t),{args:e,keys:i}=O2(t),r=new F(s=>{const{length:o}=e;if(!o)return void s.complete();const a=new Array(o);let h=o,w=o;for(let X=0;X<o;X++){let fe=!1;$r(e[X]).subscribe(m(s,pe=>{fe||(fe=!0,w--),a[X]=pe},()=>h--,void 0,()=>{(!h||!fe)&&(w||s.next(i?R2(i,a):a),s.complete())}))}});return n?r.pipe(Dd(n)):r}(Q2(e,n).map(Z2)).pipe(se(X2))}}(J2(t)):null}function nw(t,n){return null===t?[n]:Array.isArray(t)?[...t,n]:[t,n]}function E$(t){return t?Array.isArray(t)?t:[t]:[]}function Qh(t,n){return Array.isArray(t)?t.includes(n):t===n}function sw(t,n){const e=E$(n);return E$(t).forEach(r=>{Qh(e,r)||e.push(r)}),e}function ow(t,n){return E$(n).filter(e=>!Qh(t,e))}class aw{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=x$(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=w$(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n){this.control&&this.control.reset(n)}hasError(n,e){return!!this.control&&this.control.hasError(n,e)}getError(n,e){return this.control?this.control.getError(n,e):null}}class Fa extends aw{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class Hr extends aw{get formDirective(){return null}get path(){return null}}class lw{constructor(n){this._cd=n}is(n){var e,i,r;return"submitted"===n?!!(null===(e=this._cd)||void 0===e?void 0:e.submitted):!!(null===(r=null===(i=this._cd)||void 0===i?void 0:i.control)||void 0===r?void 0:r[n])}}let $i=(()=>{class t extends lw{constructor(e){super(e)}}return t.\u0275fac=function(e){return new(e||t)(He(Fa,2))},t.\u0275dir=Qt({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,i){2&e&&vh("ng-untouched",i.is("untouched"))("ng-touched",i.is("touched"))("ng-pristine",i.is("pristine"))("ng-dirty",i.is("dirty"))("ng-valid",i.is("valid"))("ng-invalid",i.is("invalid"))("ng-pending",i.is("pending"))},features:[ei]}),t})(),kl=(()=>{class t extends lw{constructor(e){super(e)}}return t.\u0275fac=function(e){return new(e||t)(He(Hr,10))},t.\u0275dir=Qt({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,i){2&e&&vh("ng-untouched",i.is("untouched"))("ng-touched",i.is("touched"))("ng-pristine",i.is("pristine"))("ng-dirty",i.is("dirty"))("ng-valid",i.is("valid"))("ng-invalid",i.is("invalid"))("ng-pending",i.is("pending"))("ng-submitted",i.is("submitted"))},features:[ei]}),t})();function Ad(t,n){I$(t,n),n.valueAccessor.writeValue(t.value),function sR(t,n){n.valueAccessor.registerOnChange(e=>{t._pendingValue=e,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&uw(t,n)})}(t,n),function aR(t,n){const e=(i,r)=>{n.valueAccessor.writeValue(i),r&&n.viewToModelUpdate(i)};t.registerOnChange(e),n._registerOnDestroy(()=>{t._unregisterOnChange(e)})}(t,n),function oR(t,n){n.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&uw(t,n),"submit"!==t.updateOn&&t.markAsTouched()})}(t,n),function rR(t,n){if(n.valueAccessor.setDisabledState){const e=i=>{n.valueAccessor.setDisabledState(i)};t.registerOnDisabledChange(e),n._registerOnDestroy(()=>{t._unregisterOnDisabledChange(e)})}}(t,n)}function np(t,n){t.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(n)})}function I$(t,n){const e=function iw(t){return t._rawValidators}(t);null!==n.validator?t.setValidators(nw(e,n.validator)):"function"==typeof e&&t.setValidators([e]);const i=function rw(t){return t._rawAsyncValidators}(t);null!==n.asyncValidator?t.setAsyncValidators(nw(i,n.asyncValidator)):"function"==typeof i&&t.setAsyncValidators([i]);const r=()=>t.updateValueAndValidity();np(n._rawValidators,r),np(n._rawAsyncValidators,r)}function uw(t,n){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function D$(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}const Pd="VALID",rp="INVALID",Yc="PENDING",Nd="DISABLED";function P$(t){return(sp(t)?t.validators:t)||null}function pw(t){return Array.isArray(t)?x$(t):t||null}function N$(t,n){return(sp(n)?n.asyncValidators:t)||null}function gw(t){return Array.isArray(t)?w$(t):t||null}function sp(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}const F$=t=>t instanceof R$;function mw(t){return(t=>t instanceof bw)(t)?t.value:t.getRawValue()}function $w(t,n){const e=F$(t),i=t.controls;if(!(e?Object.keys(i):i).length)throw new At(1e3,"");if(!i[n])throw new At(1001,"")}function vw(t,n){F$(t),t._forEachChild((i,r)=>{if(void 0===n[r])throw new At(1002,"")})}class O${constructor(n,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=n,this._rawAsyncValidators=e,this._composedValidatorFn=pw(this._rawValidators),this._composedAsyncValidatorFn=gw(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get valid(){return this.status===Pd}get invalid(){return this.status===rp}get pending(){return this.status==Yc}get disabled(){return this.status===Nd}get enabled(){return this.status!==Nd}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._rawValidators=n,this._composedValidatorFn=pw(n)}setAsyncValidators(n){this._rawAsyncValidators=n,this._composedAsyncValidatorFn=gw(n)}addValidators(n){this.setValidators(sw(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(sw(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(ow(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(ow(n,this._rawAsyncValidators))}hasValidator(n){return Qh(this._rawValidators,n)}hasAsyncValidator(n){return Qh(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){this.touched=!0,this._parent&&!n.onlySelf&&this._parent.markAsTouched(n)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(n=>n.markAllAsTouched())}markAsUntouched(n={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}markAsDirty(n={}){this.pristine=!1,this._parent&&!n.onlySelf&&this._parent.markAsDirty(n)}markAsPristine(n={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}markAsPending(n={}){this.status=Yc,!1!==n.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!n.onlySelf&&this._parent.markAsPending(n)}disable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=Nd,this.errors=null,this._forEachChild(i=>{i.disable(Object.assign(Object.assign({},n),{onlySelf:!0}))}),this._updateValue(),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},n),{skipPristineCheck:e})),this._onDisabledChange.forEach(i=>i(!0))}enable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=Pd,this._forEachChild(i=>{i.enable(Object.assign(Object.assign({},n),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},n),{skipPristineCheck:e})),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(n){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(n){this._parent=n}updateValueAndValidity(n={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Pd||this.status===Yc)&&this._runAsyncValidator(n.emitEvent)),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(n)}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Nd:Pd}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n){if(this.asyncValidator){this.status=Yc,this._hasOwnPendingAsyncValidator=!0;const e=Z2(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:n})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(n,e={}){this.errors=n,this._updateControlsErrors(!1!==e.emitEvent)}get(n){return function dR(t,n,e){if(null==n||(Array.isArray(n)||(n=n.split(e)),Array.isArray(n)&&0===n.length))return null;let i=t;return n.forEach(r=>{i=F$(i)?i.controls.hasOwnProperty(r)?i.controls[r]:null:(t=>t instanceof hR)(i)&&i.at(r)||null}),i}(this,n,".")}getError(n,e){const i=e?this.get(e):this;return i&&i.errors?i.errors[n]:null}hasError(n,e){return!!this.getError(n,e)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(n)}_initObservables(){this.valueChanges=new Tn,this.statusChanges=new Tn}_calculateStatus(){return this._allControlsDisabled()?Nd:this.errors?rp:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Yc)?Yc:this._anyControlsHaveStatus(rp)?rp:Pd}_anyControlsHaveStatus(n){return this._anyControls(e=>e.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n={}){this.pristine=!this._anyControlsDirty(),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}_updateTouched(n={}){this.touched=this._anyControlsTouched(),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}_isBoxedValue(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){sp(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class bw extends O${constructor(n=null,e,i){super(P$(e),N$(i,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),sp(e)&&e.initialValueIsDefault&&(this.defaultValue=this._isBoxedValue(n)?n.value:n)}setValue(n,e={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(n,e={}){this.setValue(n,e)}reset(n=this.defaultValue,e={}){this._applyFormState(n),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){D$(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){D$(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){this._isBoxedValue(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}}class R$ extends O${constructor(n,e,i){super(P$(e),N$(i,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,e){return this.controls[n]?this.controls[n]:(this.controls[n]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(n,e,i={}){this.registerControl(n,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(n,e={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(n,e,i={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],e&&this.registerControl(n,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,e={}){vw(this,n),Object.keys(n).forEach(i=>{$w(this,i),this.controls[i].setValue(n[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){null!=n&&(Object.keys(n).forEach(i=>{this.controls[i]&&this.controls[i].patchValue(n[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n={},e={}){this._forEachChild((i,r)=>{i.reset(n[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(n,e,i)=>(n[i]=mw(e),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(e,i)=>!!i._syncPendingControls()||e);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(e=>{const i=this.controls[e];i&&n(i,e)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(const e of Object.keys(this.controls)){const i=this.controls[e];if(this.contains(e)&&n(i))return!0}return!1}_reduceValue(){return this._reduceChildren({},(n,e,i)=>((e.enabled||this.disabled)&&(n[i]=e.value),n))}_reduceChildren(n,e){let i=n;return this._forEachChild((r,s)=>{i=e(i,r,s)}),i}_allControlsDisabled(){for(const n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}}class hR extends O${constructor(n,e,i){super(P$(e),N$(i,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(n){return this.controls[n]}push(n,e={}){this.controls.push(n),this._registerControl(n),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(n,e,i={}){this.controls.splice(n,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(n,e={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(n,e,i={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),e&&(this.controls.splice(n,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(n,e={}){vw(this,n),n.forEach((i,r)=>{$w(this,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){null!=n&&(n.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n=[],e={}){this._forEachChild((i,r)=>{i.reset(n[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(n=>mw(n))}clear(n={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:n.emitEvent}))}_syncPendingControls(){let n=this.controls.reduce((e,i)=>!!i._syncPendingControls()||e,!1);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){this.controls.forEach((e,i)=>{n(e,i)})}_updateValue(){this.value=this.controls.filter(n=>n.enabled||this.disabled).map(n=>n.value)}_anyControls(n){return this.controls.some(e=>e.enabled&&n(e))}_setUpControls(){this._forEachChild(n=>this._registerControl(n))}_allControlsDisabled(){for(const n of this.controls)if(n.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(n){n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)}}const pR={provide:Hr,useExisting:Xn(()=>la)},Fd=(()=>Promise.resolve(null))();let la=(()=>{class t extends Hr{constructor(e,i){super(),this.submitted=!1,this._directives=new Set,this.ngSubmit=new Tn,this.form=new R$({},x$(e),w$(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){Fd.then(()=>{const i=this._findContainer(e.path);e.control=i.registerControl(e.name,e.control),Ad(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){Fd.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){Fd.then(()=>{const i=this._findContainer(e.path),r=new R$({});(function dw(t,n){I$(t,n)})(r,e),i.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){Fd.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,i){Fd.then(()=>{this.form.get(e.path).setValue(i)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,function hw(t,n){t._syncPendingControls(),n.forEach(e=>{const i=e.control;"submit"===i.updateOn&&i._pendingChange&&(e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}(this.form,this._directives),this.ngSubmit.emit(e),!1}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return t.\u0275fac=function(e){return new(e||t)(He(Tr,10),He(Na,10))},t.\u0275dir=Qt({type:t,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,i){1&e&&Ae("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[gi([pR]),ei]}),t})();const _R={provide:Fa,useExisting:Xn(()=>di)},xw=(()=>Promise.resolve(null))();let di=(()=>{class t extends Fa{constructor(e,i,r,s,o){super(),this._changeDetectorRef=o,this.control=new bw,this._registered=!1,this.update=new Tn,this._parent=e,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function M$(t,n){if(!n)return null;let e,i,r;return Array.isArray(n),n.forEach(s=>{s.constructor===mi?e=s:function uR(t){return Object.getPrototypeOf(t.constructor)===Il}(s)?i=s:r=s}),r||i||e||null}(0,s)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const i=e.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),function k$(t,n){if(!t.hasOwnProperty("model"))return!1;const e=t.model;return!!e.isFirstChange()||!Object.is(n,e.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Ad(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){xw.then(()=>{var i;this.control.setValue(e,{emitViewToModelChange:!1}),null===(i=this._changeDetectorRef)||void 0===i||i.markForCheck()})}_updateDisabled(e){const i=e.isDisabled.currentValue,r=""===i||i&&"false"!==i;xw.then(()=>{var s;r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),null===(s=this._changeDetectorRef)||void 0===s||s.markForCheck()})}_getPath(e){return this._parent?function ep(t,n){return[...n.path,t]}(e,this._parent):[e]}}return t.\u0275fac=function(e){return new(e||t)(He(Hr,9),He(Tr,10),He(Na,10),He(No,10),He(Oi,8))},t.\u0275dir=Qt({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[gi([_R]),ei,io]}),t})(),Ml=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=Qt({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),t})();const mR={provide:No,useExisting:Xn(()=>ps),multi:!0};let ps=(()=>{class t extends Il{writeValue(e){this.setProperty("value",null==e?"":e)}registerOnChange(e){this.onChange=i=>{e(""==i?null:parseFloat(i))}}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=xr(t)))(i||t)}}(),t.\u0275dir=Qt({type:t,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(e,i){1&e&&Ae("input",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},features:[gi([mR]),ei]}),t})();const $R={provide:No,useExisting:Xn(()=>Oa),multi:!0};let ww=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ss({type:t}),t.\u0275inj=os({}),t})(),vR=(()=>{class t{constructor(){this._accessors=[]}add(e,i){this._accessors.push([e,i])}remove(e){for(let i=this._accessors.length-1;i>=0;--i)if(this._accessors[i][1]===e)return void this._accessors.splice(i,1)}select(e){this._accessors.forEach(i=>{this._isSameGroup(i,e)&&i[1]!==e&&i[1].fireUncheck(e.value)})}_isSameGroup(e,i){return!!e[0].control&&e[0]._parent===i._control._parent&&e[1].name===i.name}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=rn({token:t,factory:t.\u0275fac,providedIn:ww}),t})(),Oa=(()=>{class t extends Il{constructor(e,i,r,s){super(e,i),this._registry=r,this._injector=s,this.onChange=()=>{}}ngOnInit(){this._control=this._injector.get(Fa),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(e){this._state=e===this.value,this.setProperty("checked",this._state)}registerOnChange(e){this._fn=e,this.onChange=()=>{e(this.value),this._registry.select(this)}}fireUncheck(e){this.writeValue(e)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}}return t.\u0275fac=function(e){return new(e||t)(He(Cl),He(yi),He(vR),He(Yr))},t.\u0275dir=Qt({type:t,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(e,i){1&e&&Ae("change",function(){return i.onChange()})("blur",function(){return i.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[gi([$R]),ei]}),t})();const bR={provide:No,useExisting:Xn(()=>gs),multi:!0};let gs=(()=>{class t extends Il{writeValue(e){this.setProperty("value",parseFloat(e))}registerOnChange(e){this.onChange=i=>{e(""==i?null:parseFloat(i))}}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=xr(t)))(i||t)}}(),t.\u0275dir=Qt({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,i){1&e&&Ae("change",function(s){return i.onChange(s.target.value)})("input",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},features:[gi([bR]),ei]}),t})();const TR={provide:No,useExisting:Xn(()=>es),multi:!0};function kw(t,n){return null==t?`${n}`:(n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let es=(()=>{class t extends Il{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const r=kw(this._getOptionId(e),e);this.setProperty("value",r)}registerOnChange(e){this.onChange=i=>{this.value=this._getOptionValue(i),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i),e))return i;return null}_getOptionValue(e){const i=function SR(t){return t.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i):e}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=xr(t)))(i||t)}}(),t.\u0275dir=Qt({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,i){1&e&&Ae("change",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[gi([TR]),ei]}),t})(),Ur=(()=>{class t{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(kw(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(He(yi),He(Cl),He(es,9))},t.\u0275dir=Qt({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();const IR={provide:No,useExisting:Xn(()=>j$),multi:!0};function Mw(t,n){return null==t?`${n}`:("string"==typeof n&&(n=`'${n}'`),n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let j$=(()=>{class t extends Il{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let i;if(this.value=e,Array.isArray(e)){const r=e.map(s=>this._getOptionId(s));i=(s,o)=>{s._setSelected(r.indexOf(o.toString())>-1)}}else i=(r,s)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(e){this.onChange=i=>{const r=[],s=i.selectedOptions;if(void 0!==s){const o=s;for(let a=0;a<o.length;a++){const w=this._getOptionValue(o[a].value);r.push(w)}}else{const o=i.options;for(let a=0;a<o.length;a++){const h=o[a];if(h.selected){const w=this._getOptionValue(h.value);r.push(w)}}}this.value=r,e(r)}}_registerOption(e){const i=(this._idCounter++).toString();return this._optionMap.set(i,e),i}_getOptionId(e){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i)._value,e))return i;return null}_getOptionValue(e){const i=function kR(t){return t.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i)._value:e}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=xr(t)))(i||t)}}(),t.\u0275dir=Qt({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,i){1&e&&Ae("change",function(s){return i.onChange(s.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[gi([IR]),ei]}),t})(),Vr=(()=>{class t{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(Mw(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(Mw(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(He(yi),He(Cl),He(j$,9))},t.\u0275dir=Qt({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();function Dw(t){return"number"==typeof t?t:parseInt(t,10)}function Aw(t){return"number"==typeof t?t:parseFloat(t)}let Dl=(()=>{class t{constructor(){this._validator=Xh}ngOnChanges(e){if(this.inputName in e){const i=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):Xh,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=Qt({type:t,features:[io]}),t})();const DR={provide:Tr,useExisting:Xn(()=>Fo),multi:!0};let Fo=(()=>{class t extends Dl{constructor(){super(...arguments),this.inputName="max",this.normalizeInput=e=>Aw(e),this.createValidator=e=>function H2(t){return n=>{if(Pa(n.value)||Pa(t))return null;const e=parseFloat(n.value);return!isNaN(e)&&e>t?{max:{max:t,actual:n.value}}:null}}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=xr(t)))(i||t)}}(),t.\u0275dir=Qt({type:t,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Bt("max",i._enabled?i.max:null)},inputs:{max:"max"},features:[gi([DR]),ei]}),t})();const AR={provide:Tr,useExisting:Xn(()=>Oo),multi:!0};let Oo=(()=>{class t extends Dl{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=e=>Aw(e),this.createValidator=e=>function j2(t){return n=>{if(Pa(n.value)||Pa(t))return null;const e=parseFloat(n.value);return!isNaN(e)&&e<t?{min:{min:t,actual:n.value}}:null}}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=xr(t)))(i||t)}}(),t.\u0275dir=Qt({type:t,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Bt("min",i._enabled?i.min:null)},inputs:{min:"min"},features:[gi([AR]),ei]}),t})();const PR={provide:Tr,useExisting:Xn(()=>op),multi:!0};let op=(()=>{class t extends Dl{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=e=>function MR(t){return null!=t&&!1!==t&&"false"!=`${t}`}(e),this.createValidator=e=>U2}enabled(e){return e}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=xr(t)))(i||t)}}(),t.\u0275dir=Qt({type:t,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,i){2&e&&Bt("required",i._enabled?"":null)},inputs:{required:"required"},features:[gi([PR]),ei]}),t})();const OR={provide:Tr,useExisting:Xn(()=>H$),multi:!0};let H$=(()=>{class t extends Dl{constructor(){super(...arguments),this.inputName="minlength",this.normalizeInput=e=>Dw(e),this.createValidator=e=>function q2(t){return n=>Pa(n.value)||!z2(n.value)?null:n.value.length<t?{minlength:{requiredLength:t,actualLength:n.value.length}}:null}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=xr(t)))(i||t)}}(),t.\u0275dir=Qt({type:t,selectors:[["","minlength","","formControlName",""],["","minlength","","formControl",""],["","minlength","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Bt("minlength",i._enabled?i.minlength:null)},inputs:{minlength:"minlength"},features:[gi([OR]),ei]}),t})();const RR={provide:Tr,useExisting:Xn(()=>U$),multi:!0};let U$=(()=>{class t extends Dl{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=e=>Dw(e),this.createValidator=e=>function W2(t){return n=>z2(n.value)&&n.value.length>t?{maxlength:{requiredLength:t,actualLength:n.value.length}}:null}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=xr(t)))(i||t)}}(),t.\u0275dir=Qt({type:t,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Bt("maxlength",i._enabled?i.maxlength:null)},inputs:{maxlength:"maxlength"},features:[gi([RR]),ei]}),t})(),LR=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ss({type:t}),t.\u0275inj=os({imports:[[ww]]}),t})(),zR=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ss({type:t}),t.\u0275inj=os({imports:[LR]}),t})();class Ow{}const ca="*";function Sn(t,n){return{type:7,name:t,definitions:n,options:{}}}function Rt(t,n=null){return{type:4,styles:n,timings:t}}function Rw(t,n=null){return{type:2,steps:t,options:n}}function et(t){return{type:6,styles:t,offset:null}}function ap(t,n,e){return{type:0,name:t,styles:n,options:e}}function sn(t){return{type:5,steps:t}}function Lt(t,n,e=null){return{type:1,expr:t,animation:n,options:e}}function Bw(t){Promise.resolve(null).then(t)}class Od{constructor(n=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=n+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}onStart(n){this._onStartFns.push(n)}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){Bw(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(n=>n()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(n){this._position=this.totalTime?n*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class Lw{constructor(n){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=n;let e=0,i=0,r=0;const s=this.players.length;0==s?Bw(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++e==s&&this._onFinish()}),o.onDestroy(()=>{++i==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,a)=>Math.max(o,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this.players.forEach(n=>n.init())}onStart(n){this._onStartFns.push(n)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(n=>n()),this._onStartFns=[])}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(n=>n.play())}pause(){this.players.forEach(n=>n.pause())}restart(){this.players.forEach(n=>n.restart())}finish(){this._onFinish(),this.players.forEach(n=>n.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(n=>n.destroy()),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this.players.forEach(n=>n.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(n){const e=n*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,e/i.totalTime):1;i.setPosition(r)})}getPosition(){const n=this.players.reduce((e,i)=>null===e||i.totalTime>e.totalTime?i:e,null);return null!=n?n.getPosition():0}beforeDestroy(){this.players.forEach(n=>{n.beforeDestroy&&n.beforeDestroy()})}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}const Bn=!1;function zw(t){return new At(3e3,Bn)}function y6(){return"undefined"!=typeof window&&void 0!==window.document}function G$(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function Ra(t){switch(t.length){case 0:return new Od;case 1:return t[0];default:return new Lw(t)}}function jw(t,n,e,i,r={},s={}){const o=[],a=[];let h=-1,w=null;if(i.forEach(X=>{const fe=X.offset,pe=fe==h,we=pe&&w||{};Object.keys(X).forEach(Ie=>{let Pe=Ie,Be=X[Ie];if("offset"!==Ie)switch(Pe=n.normalizePropertyName(Pe,o),Be){case"!":Be=r[Ie];break;case ca:Be=s[Ie];break;default:Be=n.normalizeStyleValue(Ie,Pe,Be,o)}we[Pe]=Be}),pe||a.push(we),w=we,h=fe}),o.length)throw function u6(t){return new At(3502,Bn)}();return a}function q$(t,n,e,i){switch(n){case"start":t.onStart(()=>i(e&&W$(e,"start",t)));break;case"done":t.onDone(()=>i(e&&W$(e,"done",t)));break;case"destroy":t.onDestroy(()=>i(e&&W$(e,"destroy",t)))}}function W$(t,n,e){const i=e.totalTime,s=K$(t.element,t.triggerName,t.fromState,t.toState,n||t.phaseName,null==i?t.totalTime:i,!!e.disabled),o=t._data;return null!=o&&(s._data=o),s}function K$(t,n,e,i,r="",s=0,o){return{element:t,triggerName:n,fromState:e,toState:i,phaseName:r,totalTime:s,disabled:!!o}}function _s(t,n,e){let i;return t instanceof Map?(i=t.get(n),i||t.set(n,i=e)):(i=t[n],i||(i=t[n]=e)),i}function Hw(t){const n=t.indexOf(":");return[t.substring(1,n),t.substr(n+1)]}let Y$=(t,n)=>!1,Uw=(t,n,e)=>[],Vw=null;function Z$(t){const n=t.parentNode||t.host;return n===Vw?null:n}(G$()||"undefined"!=typeof Element)&&(y6()?(Vw=(()=>document.documentElement)(),Y$=(t,n)=>{for(;n;){if(n===t)return!0;n=Z$(n)}return!1}):Y$=(t,n)=>t.contains(n),Uw=(t,n,e)=>{if(e)return Array.from(t.querySelectorAll(n));const i=t.querySelector(n);return i?[i]:[]});let Al=null,Gw=!1;function qw(t){Al||(Al=function x6(){return"undefined"!=typeof document?document.body:null}()||{},Gw=!!Al.style&&"WebkitAppearance"in Al.style);let n=!0;return Al.style&&!function C6(t){return"ebkit"==t.substring(1,6)}(t)&&(n=t in Al.style,!n&&Gw&&(n="Webkit"+t.charAt(0).toUpperCase()+t.substr(1)in Al.style)),n}const Ww=Y$,Kw=Uw;let Yw=(()=>{class t{validateStyleProperty(e){return qw(e)}matchesElement(e,i){return!1}containsElement(e,i){return Ww(e,i)}getParentElement(e){return Z$(e)}query(e,i,r){return Kw(e,i,r)}computeStyle(e,i,r){return r||""}animate(e,i,r,s,o,a=[],h){return new Od(r,s)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=rn({token:t,factory:t.\u0275fac}),t})(),X$=(()=>{class t{}return t.NOOP=new Yw,t})();const Q$="ng-enter",cp="ng-leave",up="ng-trigger",dp=".ng-trigger",Xw="ng-animating",J$=".ng-animating";function Pl(t){if("number"==typeof t)return t;const n=t.match(/^(-?[\.\d]+)(m?s)/);return!n||n.length<2?0:e0(parseFloat(n[1]),n[2])}function e0(t,n){return"s"===n?1e3*t:t}function fp(t,n,e){return t.hasOwnProperty("duration")?t:function T6(t,n,e){let r,s=0,o="";if("string"==typeof t){const a=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return n.push(zw()),{duration:0,delay:0,easing:""};r=e0(parseFloat(a[1]),a[2]);const h=a[3];null!=h&&(s=e0(parseFloat(h),a[4]));const w=a[5];w&&(o=w)}else r=t;if(!e){let a=!1,h=n.length;r<0&&(n.push(function HR(){return new At(3100,Bn)}()),a=!0),s<0&&(n.push(function UR(){return new At(3101,Bn)}()),a=!0),a&&n.splice(h,0,zw())}return{duration:r,delay:s,easing:o}}(t,n,e)}function Zc(t,n={}){return Object.keys(t).forEach(e=>{n[e]=t[e]}),n}function Ba(t,n,e={}){if(n)for(let i in t)e[i]=t[i];else Zc(t,e);return e}function Jw(t,n,e){return e?n+":"+e+";":""}function eE(t){let n="";for(let e=0;e<t.style.length;e++){const i=t.style.item(e);n+=Jw(0,i,t.style.getPropertyValue(i))}for(const e in t.style)t.style.hasOwnProperty(e)&&!e.startsWith("_")&&(n+=Jw(0,k6(e),t.style[e]));t.setAttribute("style",n)}function Ro(t,n,e){t.style&&(Object.keys(n).forEach(i=>{const r=n0(i);e&&!e.hasOwnProperty(i)&&(e[i]=t.style[r]),t.style[r]=n[i]}),G$()&&eE(t))}function Nl(t,n){t.style&&(Object.keys(n).forEach(e=>{const i=n0(e);t.style[i]=""}),G$()&&eE(t))}function Rd(t){return Array.isArray(t)?1==t.length?t[0]:Rw(t):t}const t0=new RegExp("{{\\s*(.+?)\\s*}}","g");function tE(t){let n=[];if("string"==typeof t){let e;for(;e=t0.exec(t);)n.push(e[1]);t0.lastIndex=0}return n}function hp(t,n,e){const i=t.toString(),r=i.replace(t0,(s,o)=>{let a=n[o];return n.hasOwnProperty(o)||(e.push(function GR(t){return new At(3003,Bn)}()),a=""),a.toString()});return r==i?t:r}function pp(t){const n=[];let e=t.next();for(;!e.done;)n.push(e.value),e=t.next();return n}const I6=/-+([a-z0-9])/g;function n0(t){return t.replace(I6,(...n)=>n[1].toUpperCase())}function k6(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function ms(t,n,e){switch(n.type){case 7:return t.visitTrigger(n,e);case 0:return t.visitState(n,e);case 1:return t.visitTransition(n,e);case 2:return t.visitSequence(n,e);case 3:return t.visitGroup(n,e);case 4:return t.visitAnimate(n,e);case 5:return t.visitKeyframes(n,e);case 6:return t.visitStyle(n,e);case 8:return t.visitReference(n,e);case 9:return t.visitAnimateChild(n,e);case 10:return t.visitAnimateRef(n,e);case 11:return t.visitQuery(n,e);case 12:return t.visitStagger(n,e);default:throw function qR(t){return new At(3004,Bn)}()}}function nE(t,n){return window.getComputedStyle(t)[n]}function F6(t,n){const e=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(i=>function O6(t,n,e){if(":"==t[0]){const h=function R6(t,n){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,i)=>parseFloat(i)>parseFloat(e);case":decrement":return(e,i)=>parseFloat(i)<parseFloat(e);default:return n.push(function o6(t){return new At(3016,Bn)}()),"* => *"}}(t,e);if("function"==typeof h)return void n.push(h);t=h}const i=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return e.push(function s6(t){return new At(3015,Bn)}()),n;const r=i[1],s=i[2],o=i[3];n.push(iE(r,o));"<"==s[0]&&!("*"==r&&"*"==o)&&n.push(iE(o,r))}(i,e,n)):e.push(t),e}const $p=new Set(["true","1"]),vp=new Set(["false","0"]);function iE(t,n){const e=$p.has(t)||vp.has(t),i=$p.has(n)||vp.has(n);return(r,s)=>{let o="*"==t||t==r,a="*"==n||n==s;return!o&&e&&"boolean"==typeof r&&(o=r?$p.has(t):vp.has(t)),!a&&i&&"boolean"==typeof s&&(a=s?$p.has(n):vp.has(n)),o&&a}}const B6=new RegExp("s*:selfs*,?","g");function r0(t,n,e,i){return new L6(t).build(n,e,i)}class L6{constructor(n){this._driver=n}build(n,e,i){const r=new H6(e);this._resetContextStyleTimingState(r);const s=ms(this,Rd(n),r);return r.unsupportedCSSPropertiesFound.size&&r.unsupportedCSSPropertiesFound.keys(),s}_resetContextStyleTimingState(n){n.currentQuerySelector="",n.collectedStyles={},n.collectedStyles[""]={},n.currentTime=0}visitTrigger(n,e){let i=e.queryCount=0,r=e.depCount=0;const s=[],o=[];return"@"==n.name.charAt(0)&&e.errors.push(function KR(){return new At(3006,Bn)}()),n.definitions.forEach(a=>{if(this._resetContextStyleTimingState(e),0==a.type){const h=a,w=h.name;w.toString().split(/\s*,\s*/).forEach(X=>{h.name=X,s.push(this.visitState(h,e))}),h.name=w}else if(1==a.type){const h=this.visitTransition(a,e);i+=h.queryCount,r+=h.depCount,o.push(h)}else e.errors.push(function YR(){return new At(3007,Bn)}())}),{type:7,name:n.name,states:s,transitions:o,queryCount:i,depCount:r,options:null}}visitState(n,e){const i=this.visitStyle(n.styles,e),r=n.options&&n.options.params||null;if(i.containsDynamicStyles){const s=new Set,o=r||{};i.styles.forEach(a=>{if(bp(a)){const h=a;Object.keys(h).forEach(w=>{tE(h[w]).forEach(X=>{o.hasOwnProperty(X)||s.add(X)})})}}),s.size&&(pp(s.values()),e.errors.push(function ZR(t,n){return new At(3008,Bn)}()))}return{type:0,name:n.name,style:i,options:r?{params:r}:null}}visitTransition(n,e){e.queryCount=0,e.depCount=0;const i=ms(this,Rd(n.animation),e);return{type:1,matchers:F6(n.expr,e.errors),animation:i,queryCount:e.queryCount,depCount:e.depCount,options:Fl(n.options)}}visitSequence(n,e){return{type:2,steps:n.steps.map(i=>ms(this,i,e)),options:Fl(n.options)}}visitGroup(n,e){const i=e.currentTime;let r=0;const s=n.steps.map(o=>{e.currentTime=i;const a=ms(this,o,e);return r=Math.max(r,e.currentTime),a});return e.currentTime=r,{type:3,steps:s,options:Fl(n.options)}}visitAnimate(n,e){const i=function V6(t,n){if(t.hasOwnProperty("duration"))return t;if("number"==typeof t)return s0(fp(t,n).duration,0,"");const e=t;if(e.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=s0(0,0,"");return s.dynamic=!0,s.strValue=e,s}const r=fp(e,n);return s0(r.duration,r.delay,r.easing)}(n.timings,e.errors);e.currentAnimateTimings=i;let r,s=n.styles?n.styles:et({});if(5==s.type)r=this.visitKeyframes(s,e);else{let o=n.styles,a=!1;if(!o){a=!0;const w={};i.easing&&(w.easing=i.easing),o=et(w)}e.currentTime+=i.duration+i.delay;const h=this.visitStyle(o,e);h.isEmptyStep=a,r=h}return e.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(n,e){const i=this._makeStyleAst(n,e);return this._validateStyleAst(i,e),i}_makeStyleAst(n,e){const i=[];Array.isArray(n.styles)?n.styles.forEach(o=>{"string"==typeof o?o==ca?i.push(o):e.errors.push(function XR(t){return new At(3002,Bn)}()):i.push(o)}):i.push(n.styles);let r=!1,s=null;return i.forEach(o=>{if(bp(o)){const a=o,h=a.easing;if(h&&(s=h,delete a.easing),!r)for(let w in a)if(a[w].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:i,easing:s,offset:n.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(n,e){const i=e.currentAnimateTimings;let r=e.currentTime,s=e.currentTime;i&&s>0&&(s-=i.duration+i.delay),n.styles.forEach(o=>{"string"!=typeof o&&Object.keys(o).forEach(a=>{if(!this._driver.validateStyleProperty(a))return delete o[a],void e.unsupportedCSSPropertiesFound.add(a);const h=e.collectedStyles[e.currentQuerySelector],w=h[a];let X=!0;w&&(s!=r&&s>=w.startTime&&r<=w.endTime&&(e.errors.push(function QR(t,n,e,i,r){return new At(3010,Bn)}()),X=!1),s=w.startTime),X&&(h[a]={startTime:s,endTime:r}),e.options&&function S6(t,n,e){const i=n.params||{},r=tE(t);r.length&&r.forEach(s=>{i.hasOwnProperty(s)||e.push(function VR(t){return new At(3001,Bn)}())})}(o[a],e.options,e.errors)})})}visitKeyframes(n,e){const i={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function JR(){return new At(3011,Bn)}()),i;let s=0;const o=[];let a=!1,h=!1,w=0;const X=n.steps.map(Le=>{const Fe=this._makeStyleAst(Le,e);let Ve=null!=Fe.offset?Fe.offset:function U6(t){if("string"==typeof t)return null;let n=null;if(Array.isArray(t))t.forEach(e=>{if(bp(e)&&e.hasOwnProperty("offset")){const i=e;n=parseFloat(i.offset),delete i.offset}});else if(bp(t)&&t.hasOwnProperty("offset")){const e=t;n=parseFloat(e.offset),delete e.offset}return n}(Fe.styles),Ge=0;return null!=Ve&&(s++,Ge=Fe.offset=Ve),h=h||Ge<0||Ge>1,a=a||Ge<w,w=Ge,o.push(Ge),Fe});h&&e.errors.push(function e6(){return new At(3012,Bn)}()),a&&e.errors.push(function t6(){return new At(3200,Bn)}());const fe=n.steps.length;let pe=0;s>0&&s<fe?e.errors.push(function n6(){return new At(3202,Bn)}()):0==s&&(pe=1/(fe-1));const we=fe-1,Ie=e.currentTime,Pe=e.currentAnimateTimings,Be=Pe.duration;return X.forEach((Le,Fe)=>{const Ve=pe>0?Fe==we?1:pe*Fe:o[Fe],Ge=Ve*Be;e.currentTime=Ie+Pe.delay+Ge,Pe.duration=Ge,this._validateStyleAst(Le,e),Le.offset=Ve,i.styles.push(Le)}),i}visitReference(n,e){return{type:8,animation:ms(this,Rd(n.animation),e),options:Fl(n.options)}}visitAnimateChild(n,e){return e.depCount++,{type:9,options:Fl(n.options)}}visitAnimateRef(n,e){return{type:10,animation:this.visitReference(n.animation,e),options:Fl(n.options)}}visitQuery(n,e){const i=e.currentQuerySelector,r=n.options||{};e.queryCount++,e.currentQuery=n;const[s,o]=function z6(t){const n=!!t.split(/\s*,\s*/).find(e=>":self"==e);return n&&(t=t.replace(B6,"")),t=t.replace(/@\*/g,dp).replace(/@\w+/g,e=>dp+"-"+e.substr(1)).replace(/:animating/g,J$),[t,n]}(n.selector);e.currentQuerySelector=i.length?i+" "+s:s,_s(e.collectedStyles,e.currentQuerySelector,{});const a=ms(this,Rd(n.animation),e);return e.currentQuery=null,e.currentQuerySelector=i,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:a,originalSelector:n.selector,options:Fl(n.options)}}visitStagger(n,e){e.currentQuery||e.errors.push(function i6(){return new At(3013,Bn)}());const i="full"===n.timings?{duration:0,delay:0,easing:"full"}:fp(n.timings,e.errors,!0);return{type:12,animation:ms(this,Rd(n.animation),e),timings:i,options:null}}}class H6{constructor(n){this.errors=n,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function bp(t){return!Array.isArray(t)&&"object"==typeof t}function Fl(t){return t?(t=Zc(t)).params&&(t.params=function j6(t){return t?Zc(t):null}(t.params)):t={},t}function s0(t,n,e){return{duration:t,delay:n,easing:e}}function o0(t,n,e,i,r,s,o=null,a=!1){return{type:1,element:t,keyframes:n,preStyleProps:e,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:a}}class yp{constructor(){this._map=new Map}get(n){return this._map.get(n)||[]}append(n,e){let i=this._map.get(n);i||this._map.set(n,i=[]),i.push(...e)}has(n){return this._map.has(n)}clear(){this._map.clear()}}const W6=new RegExp(":enter","g"),Y6=new RegExp(":leave","g");function a0(t,n,e,i,r,s={},o={},a,h,w=[]){return(new Z6).buildKeyframes(t,n,e,i,r,s,o,a,h,w)}class Z6{buildKeyframes(n,e,i,r,s,o,a,h,w,X=[]){w=w||new yp;const fe=new l0(n,e,w,r,s,X,[]);fe.options=h,fe.currentTimeline.setStyles([o],null,fe.errors,h),ms(this,i,fe);const pe=fe.timelines.filter(we=>we.containsAnimation());if(Object.keys(a).length){let we;for(let Ie=pe.length-1;Ie>=0;Ie--){const Pe=pe[Ie];if(Pe.element===e){we=Pe;break}}we&&!we.allowOnlyTimelineStyles()&&we.setStyles([a],null,fe.errors,h)}return pe.length?pe.map(we=>we.buildKeyframes()):[o0(e,[],[],[],0,0,"",!1)]}visitTrigger(n,e){}visitState(n,e){}visitTransition(n,e){}visitAnimateChild(n,e){const i=e.subInstructions.get(e.element);if(i){const r=e.createSubContext(n.options),s=e.currentTimeline.currentTime,o=this._visitSubInstructions(i,r,r.options);s!=o&&e.transformIntoNewTimeline(o)}e.previousNode=n}visitAnimateRef(n,e){const i=e.createSubContext(n.options);i.transformIntoNewTimeline(),this.visitReference(n.animation,i),e.transformIntoNewTimeline(i.currentTimeline.currentTime),e.previousNode=n}_visitSubInstructions(n,e,i){let s=e.currentTimeline.currentTime;const o=null!=i.duration?Pl(i.duration):null,a=null!=i.delay?Pl(i.delay):null;return 0!==o&&n.forEach(h=>{const w=e.appendInstructionToTimeline(h,o,a);s=Math.max(s,w.duration+w.delay)}),s}visitReference(n,e){e.updateOptions(n.options,!0),ms(this,n.animation,e),e.previousNode=n}visitSequence(n,e){const i=e.subContextCount;let r=e;const s=n.options;if(s&&(s.params||s.delay)&&(r=e.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Cp);const o=Pl(s.delay);r.delayNextStep(o)}n.steps.length&&(n.steps.forEach(o=>ms(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),e.previousNode=n}visitGroup(n,e){const i=[];let r=e.currentTimeline.currentTime;const s=n.options&&n.options.delay?Pl(n.options.delay):0;n.steps.forEach(o=>{const a=e.createSubContext(n.options);s&&a.delayNextStep(s),ms(this,o,a),r=Math.max(r,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(o=>e.currentTimeline.mergeTimelineCollectedStyles(o)),e.transformIntoNewTimeline(r),e.previousNode=n}_visitTiming(n,e){if(n.dynamic){const i=n.strValue;return fp(e.params?hp(i,e.params,e.errors):i,e.errors)}return{duration:n.duration,delay:n.delay,easing:n.easing}}visitAnimate(n,e){const i=e.currentAnimateTimings=this._visitTiming(n.timings,e),r=e.currentTimeline;i.delay&&(e.incrementTime(i.delay),r.snapshotCurrentStyles());const s=n.style;5==s.type?this.visitKeyframes(s,e):(e.incrementTime(i.duration),this.visitStyle(s,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=n}visitStyle(n,e){const i=e.currentTimeline,r=e.currentAnimateTimings;!r&&i.getCurrentStyleProperties().length&&i.forwardFrame();const s=r&&r.easing||n.easing;n.isEmptyStep?i.applyEmptyStep(s):i.setStyles(n.styles,s,e.errors,e.options),e.previousNode=n}visitKeyframes(n,e){const i=e.currentAnimateTimings,r=e.currentTimeline.duration,s=i.duration,a=e.createSubContext().currentTimeline;a.easing=i.easing,n.styles.forEach(h=>{a.forwardTime((h.offset||0)*s),a.setStyles(h.styles,h.easing,e.errors,e.options),a.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(a),e.transformIntoNewTimeline(r+s),e.previousNode=n}visitQuery(n,e){const i=e.currentTimeline.currentTime,r=n.options||{},s=r.delay?Pl(r.delay):0;s&&(6===e.previousNode.type||0==i&&e.currentTimeline.getCurrentStyleProperties().length)&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=Cp);let o=i;const a=e.invokeQuery(n.selector,n.originalSelector,n.limit,n.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=a.length;let h=null;a.forEach((w,X)=>{e.currentQueryIndex=X;const fe=e.createSubContext(n.options,w);s&&fe.delayNextStep(s),w===e.element&&(h=fe.currentTimeline),ms(this,n.animation,fe),fe.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,fe.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(o),h&&(e.currentTimeline.mergeTimelineCollectedStyles(h),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=n}visitStagger(n,e){const i=e.parentContext,r=e.currentTimeline,s=n.timings,o=Math.abs(s.duration),a=o*(e.currentQueryTotal-1);let h=o*e.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":h=a-h;break;case"full":h=i.currentStaggerTime}const X=e.currentTimeline;h&&X.delayNextStep(h);const fe=X.currentTime;ms(this,n.animation,e),e.previousNode=n,i.currentStaggerTime=r.currentTime-fe+(r.startTime-i.currentTimeline.startTime)}}const Cp={};class l0{constructor(n,e,i,r,s,o,a,h){this._driver=n,this.element=e,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Cp,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=h||new xp(this._driver,e,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(n,e){if(!n)return;const i=n;let r=this.options;null!=i.duration&&(r.duration=Pl(i.duration)),null!=i.delay&&(r.delay=Pl(i.delay));const s=i.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(a=>{(!e||!o.hasOwnProperty(a))&&(o[a]=hp(s[a],o,this.errors))})}}_copyOptions(){const n={};if(this.options){const e=this.options.params;if(e){const i=n.params={};Object.keys(e).forEach(r=>{i[r]=e[r]})}}return n}createSubContext(n=null,e,i){const r=e||this.element,s=new l0(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(n),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(n){return this.previousNode=Cp,this.currentTimeline=this.currentTimeline.fork(this.element,n),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(n,e,i){const r={duration:null!=e?e:n.duration,delay:this.currentTimeline.currentTime+(null!=i?i:0)+n.delay,easing:""},s=new X6(this._driver,n.element,n.keyframes,n.preStyleProps,n.postStyleProps,r,n.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(n){this.currentTimeline.forwardTime(this.currentTimeline.duration+n)}delayNextStep(n){n>0&&this.currentTimeline.delayNextStep(n)}invokeQuery(n,e,i,r,s,o){let a=[];if(r&&a.push(this.element),n.length>0){n=(n=n.replace(W6,"."+this._enterClassName)).replace(Y6,"."+this._leaveClassName);let w=this._driver.query(this.element,n,1!=i);0!==i&&(w=i<0?w.slice(w.length+i,w.length):w.slice(0,i)),a.push(...w)}return!s&&0==a.length&&o.push(function r6(t){return new At(3014,Bn)}()),a}}class xp{constructor(n,e,i,r){this._driver=n,this.element=e,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(n){const e=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||e?(this.forwardTime(this.currentTime+n),e&&this.snapshotCurrentStyles()):this.startTime+=n}fork(n,e){return this.applyStylesToKeyframe(),new xp(this._driver,n,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(n){this.applyStylesToKeyframe(),this.duration=n,this._loadKeyframe()}_updateStyle(n,e){this._localTimelineStyles[n]=e,this._globalTimelineStyles[n]=e,this._styleSummary[n]={time:this.currentTime,value:e}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(n){n&&(this._previousKeyframe.easing=n),Object.keys(this._globalTimelineStyles).forEach(e=>{this._backFill[e]=this._globalTimelineStyles[e]||ca,this._currentKeyframe[e]=ca}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(n,e,i,r){e&&(this._previousKeyframe.easing=e);const s=r&&r.params||{},o=function Q6(t,n){const e={};let i;return t.forEach(r=>{"*"===r?(i=i||Object.keys(n),i.forEach(s=>{e[s]=ca})):Ba(r,!1,e)}),e}(n,this._globalTimelineStyles);Object.keys(o).forEach(a=>{const h=hp(o[a],s,i);this._pendingStyles[a]=h,this._localTimelineStyles.hasOwnProperty(a)||(this._backFill[a]=this._globalTimelineStyles.hasOwnProperty(a)?this._globalTimelineStyles[a]:ca),this._updateStyle(a,h)})}applyStylesToKeyframe(){const n=this._pendingStyles,e=Object.keys(n);0!=e.length&&(this._pendingStyles={},e.forEach(i=>{this._currentKeyframe[i]=n[i]}),Object.keys(this._localTimelineStyles).forEach(i=>{this._currentKeyframe.hasOwnProperty(i)||(this._currentKeyframe[i]=this._localTimelineStyles[i])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(n=>{const e=this._localTimelineStyles[n];this._pendingStyles[n]=e,this._updateStyle(n,e)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const n=[];for(let e in this._currentKeyframe)n.push(e);return n}mergeTimelineCollectedStyles(n){Object.keys(n._styleSummary).forEach(e=>{const i=this._styleSummary[e],r=n._styleSummary[e];(!i||r.time>i.time)&&this._updateStyle(e,r.value)})}buildKeyframes(){this.applyStylesToKeyframe();const n=new Set,e=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,h)=>{const w=Ba(a,!0);Object.keys(w).forEach(X=>{const fe=w[X];"!"==fe?n.add(X):fe==ca&&e.add(X)}),i||(w.offset=h/this.duration),r.push(w)});const s=n.size?pp(n.values()):[],o=e.size?pp(e.values()):[];if(i){const a=r[0],h=Zc(a);a.offset=0,h.offset=1,r=[a,h]}return o0(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}}class X6 extends xp{constructor(n,e,i,r,s,o,a=!1){super(n,e,o.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=a,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let n=this.keyframes,{delay:e,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const s=[],o=i+e,a=e/o,h=Ba(n[0],!1);h.offset=0,s.push(h);const w=Ba(n[0],!1);w.offset=oE(a),s.push(w);const X=n.length-1;for(let fe=1;fe<=X;fe++){let pe=Ba(n[fe],!1);pe.offset=oE((e+pe.offset*i)/o),s.push(pe)}i=o,e=0,r="",n=s}return o0(this.element,n,this.preStyleProps,this.postStyleProps,i,e,r,!0)}}function oE(t,n=3){const e=Math.pow(10,n-1);return Math.round(t*e)/e}class c0{}class J6 extends c0{normalizePropertyName(n,e){return n0(n)}normalizeStyleValue(n,e,i,r){let s="";const o=i.toString().trim();if(e8[e]&&0!==i&&"0"!==i)if("number"==typeof i)s="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function WR(t,n){return new At(3005,Bn)}())}return o+s}}const e8=(()=>function t8(t){const n={};return t.forEach(e=>n[e]=!0),n}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function aE(t,n,e,i,r,s,o,a,h,w,X,fe,pe){return{type:0,element:t,triggerName:n,isRemovalTransition:r,fromState:e,fromStyles:s,toState:i,toStyles:o,timelines:a,queriedElements:h,preStyleProps:w,postStyleProps:X,totalTime:fe,errors:pe}}const u0={};class lE{constructor(n,e,i){this._triggerName=n,this.ast=e,this._stateStyles=i}match(n,e,i,r){return function n8(t,n,e,i,r){return t.some(s=>s(n,e,i,r))}(this.ast.matchers,n,e,i,r)}buildStyles(n,e,i){const r=this._stateStyles["*"],s=this._stateStyles[n],o=r?r.buildStyles(e,i):{};return s?s.buildStyles(e,i):o}build(n,e,i,r,s,o,a,h,w,X){const fe=[],pe=this.ast.options&&this.ast.options.params||u0,Ie=this.buildStyles(i,a&&a.params||u0,fe),Pe=h&&h.params||u0,Be=this.buildStyles(r,Pe,fe),Le=new Set,Fe=new Map,Ve=new Map,Ge="void"===r,ct={params:Object.assign(Object.assign({},pe),Pe)},ut=X?[]:a0(n,e,this.ast.animation,s,o,Ie,Be,ct,w,fe);let st=0;if(ut.forEach(nt=>{st=Math.max(nt.duration+nt.delay,st)}),fe.length)return aE(e,this._triggerName,i,r,Ge,Ie,Be,[],[],Fe,Ve,st,fe);ut.forEach(nt=>{const lt=nt.element,gt=_s(Fe,lt,{});nt.preStyleProps.forEach(Ht=>gt[Ht]=!0);const Vt=_s(Ve,lt,{});nt.postStyleProps.forEach(Ht=>Vt[Ht]=!0),lt!==e&&Le.add(lt)});const yt=pp(Le.values());return aE(e,this._triggerName,i,r,Ge,Ie,Be,ut,yt,Fe,Ve,st)}}class i8{constructor(n,e,i){this.styles=n,this.defaultParams=e,this.normalizer=i}buildStyles(n,e){const i={},r=Zc(this.defaultParams);return Object.keys(n).forEach(s=>{const o=n[s];null!=o&&(r[s]=o)}),this.styles.styles.forEach(s=>{if("string"!=typeof s){const o=s;Object.keys(o).forEach(a=>{let h=o[a];h.length>1&&(h=hp(h,r,e));const w=this.normalizer.normalizePropertyName(a,e);h=this.normalizer.normalizeStyleValue(a,w,h,e),i[w]=h})}}),i}}class s8{constructor(n,e,i){this.name=n,this.ast=e,this._normalizer=i,this.transitionFactories=[],this.states={},e.states.forEach(r=>{this.states[r.name]=new i8(r.style,r.options&&r.options.params||{},i)}),cE(this.states,"true","1"),cE(this.states,"false","0"),e.transitions.forEach(r=>{this.transitionFactories.push(new lE(n,r,this.states))}),this.fallbackTransition=function o8(t,n,e){return new lE(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,a)=>!0],options:null,queryCount:0,depCount:0},n)}(n,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(n,e,i,r){return this.transitionFactories.find(o=>o.match(n,e,i,r))||null}matchStyles(n,e,i){return this.fallbackTransition.buildStyles(n,e,i)}}function cE(t,n,e){t.hasOwnProperty(n)?t.hasOwnProperty(e)||(t[e]=t[n]):t.hasOwnProperty(e)&&(t[n]=t[e])}const a8=new yp;class l8{constructor(n,e,i){this.bodyNode=n,this._driver=e,this._normalizer=i,this._animations={},this._playersById={},this.players=[]}register(n,e){const i=[],s=r0(this._driver,e,i,[]);if(i.length)throw function d6(t){return new At(3503,Bn)}();this._animations[n]=s}_buildPlayer(n,e,i){const r=n.element,s=jw(0,this._normalizer,0,n.keyframes,e,i);return this._driver.animate(r,s,n.duration,n.delay,n.easing,[],!0)}create(n,e,i={}){const r=[],s=this._animations[n];let o;const a=new Map;if(s?(o=a0(this._driver,e,s,Q$,cp,{},{},i,a8,r),o.forEach(X=>{const fe=_s(a,X.element,{});X.postStyleProps.forEach(pe=>fe[pe]=null)})):(r.push(function f6(){return new At(3300,Bn)}()),o=[]),r.length)throw function h6(t){return new At(3504,Bn)}();a.forEach((X,fe)=>{Object.keys(X).forEach(pe=>{X[pe]=this._driver.computeStyle(fe,pe,ca)})});const w=Ra(o.map(X=>{const fe=a.get(X.element);return this._buildPlayer(X,{},fe)}));return this._playersById[n]=w,w.onDestroy(()=>this.destroy(n)),this.players.push(w),w}destroy(n){const e=this._getPlayer(n);e.destroy(),delete this._playersById[n];const i=this.players.indexOf(e);i>=0&&this.players.splice(i,1)}_getPlayer(n){const e=this._playersById[n];if(!e)throw function p6(t){return new At(3301,Bn)}();return e}listen(n,e,i,r){const s=K$(e,"","","");return q$(this._getPlayer(n),i,s,r),()=>{}}command(n,e,i,r){if("register"==i)return void this.register(n,r[0]);if("create"==i)return void this.create(n,e,r[0]||{});const s=this._getPlayer(n);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(n)}}}const uE="ng-animate-queued",d0="ng-animate-disabled",h8=[],dE={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},p8={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Fs="__ng_removed";class f0{constructor(n,e=""){this.namespaceId=e;const i=n&&n.hasOwnProperty("value");if(this.value=function $8(t){return null!=t?t:null}(i?n.value:n),i){const s=Zc(n);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(n){const e=n.params;if(e){const i=this.options.params;Object.keys(e).forEach(r=>{null==i[r]&&(i[r]=e[r])})}}}const Bd="void",h0=new f0(Bd);class g8{constructor(n,e,i){this.id=n,this.hostElement=e,this._engine=i,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+n,Os(e,this._hostClassName)}listen(n,e,i,r){if(!this._triggers.hasOwnProperty(e))throw function g6(t,n){return new At(3302,Bn)}();if(null==i||0==i.length)throw function _6(t){return new At(3303,Bn)}();if(!function v8(t){return"start"==t||"done"==t}(i))throw function m6(t,n){return new At(3400,Bn)}();const s=_s(this._elementListeners,n,[]),o={name:e,phase:i,callback:r};s.push(o);const a=_s(this._engine.statesByElement,n,{});return a.hasOwnProperty(e)||(Os(n,up),Os(n,up+"-"+e),a[e]=h0),()=>{this._engine.afterFlush(()=>{const h=s.indexOf(o);h>=0&&s.splice(h,1),this._triggers[e]||delete a[e]})}}register(n,e){return!this._triggers[n]&&(this._triggers[n]=e,!0)}_getTrigger(n){const e=this._triggers[n];if(!e)throw function $6(t){return new At(3401,Bn)}();return e}trigger(n,e,i,r=!0){const s=this._getTrigger(e),o=new p0(this.id,e,n);let a=this._engine.statesByElement.get(n);a||(Os(n,up),Os(n,up+"-"+e),this._engine.statesByElement.set(n,a={}));let h=a[e];const w=new f0(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&h&&w.absorbOptions(h.options),a[e]=w,h||(h=h0),w.value!==Bd&&h.value===w.value){if(!function C8(t,n){const e=Object.keys(t),i=Object.keys(n);if(e.length!=i.length)return!1;for(let r=0;r<e.length;r++){const s=e[r];if(!n.hasOwnProperty(s)||t[s]!==n[s])return!1}return!0}(h.params,w.params)){const Pe=[],Be=s.matchStyles(h.value,h.params,Pe),Le=s.matchStyles(w.value,w.params,Pe);Pe.length?this._engine.reportError(Pe):this._engine.afterFlush(()=>{Nl(n,Be),Ro(n,Le)})}return}const pe=_s(this._engine.playersByElement,n,[]);pe.forEach(Pe=>{Pe.namespaceId==this.id&&Pe.triggerName==e&&Pe.queued&&Pe.destroy()});let we=s.matchTransition(h.value,w.value,n,w.params),Ie=!1;if(!we){if(!r)return;we=s.fallbackTransition,Ie=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:e,transition:we,fromState:h,toState:w,player:o,isFallbackTransition:Ie}),Ie||(Os(n,uE),o.onStart(()=>{Xc(n,uE)})),o.onDone(()=>{let Pe=this.players.indexOf(o);Pe>=0&&this.players.splice(Pe,1);const Be=this._engine.playersByElement.get(n);if(Be){let Le=Be.indexOf(o);Le>=0&&Be.splice(Le,1)}}),this.players.push(o),pe.push(o),o}deregister(n){delete this._triggers[n],this._engine.statesByElement.forEach((e,i)=>{delete e[n]}),this._elementListeners.forEach((e,i)=>{this._elementListeners.set(i,e.filter(r=>r.name!=n))})}clearElementCache(n){this._engine.statesByElement.delete(n),this._elementListeners.delete(n);const e=this._engine.playersByElement.get(n);e&&(e.forEach(i=>i.destroy()),this._engine.playersByElement.delete(n))}_signalRemovalForInnerTriggers(n,e){const i=this._engine.driver.query(n,dp,!0);i.forEach(r=>{if(r[Fs])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,e,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(n,e,i,r){const s=this._engine.statesByElement.get(n),o=new Map;if(s){const a=[];if(Object.keys(s).forEach(h=>{if(o.set(h,s[h].value),this._triggers[h]){const w=this.trigger(n,h,Bd,r);w&&a.push(w)}}),a.length)return this._engine.markElementAsRemoved(this.id,n,!0,e,o),i&&Ra(a).onDone(()=>this._engine.processLeaveNode(n)),!0}return!1}prepareLeaveAnimationListeners(n){const e=this._elementListeners.get(n),i=this._engine.statesByElement.get(n);if(e&&i){const r=new Set;e.forEach(s=>{const o=s.name;if(r.has(o))return;r.add(o);const h=this._triggers[o].fallbackTransition,w=i[o]||h0,X=new f0(Bd),fe=new p0(this.id,o,n);this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:o,transition:h,fromState:w,toState:X,player:fe,isFallbackTransition:!0})})}}removeNode(n,e){const i=this._engine;if(n.childElementCount&&this._signalRemovalForInnerTriggers(n,e),this.triggerLeaveAnimation(n,e,!0))return;let r=!1;if(i.totalAnimations){const s=i.players.length?i.playersByQueriedElement.get(n):[];if(s&&s.length)r=!0;else{let o=n;for(;o=o.parentNode;)if(i.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(n),r)i.markElementAsRemoved(this.id,n,!1,e);else{const s=n[Fs];(!s||s===dE)&&(i.afterFlush(()=>this.clearElementCache(n)),i.destroyInnerAnimations(n),i._onRemovalComplete(n,e))}}insertNode(n,e){Os(n,this._hostClassName)}drainQueuedTransitions(n){const e=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const s=i.element,o=this._elementListeners.get(s);o&&o.forEach(a=>{if(a.name==i.triggerName){const h=K$(s,i.triggerName,i.fromState.value,i.toState.value);h._data=n,q$(i.player,a.phase,h,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(i)}),this._queue=[],e.sort((i,r)=>{const s=i.transition.ast.depCount,o=r.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(n){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,n)}elementContainsData(n){let e=!1;return this._elementListeners.has(n)&&(e=!0),e=!!this._queue.find(i=>i.element===n)||e,e}}class _8{constructor(n,e,i){this.bodyNode=n,this.driver=e,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}_onRemovalComplete(n,e){this.onRemovalComplete(n,e)}get queuedPlayers(){const n=[];return this._namespaceList.forEach(e=>{e.players.forEach(i=>{i.queued&&n.push(i)})}),n}createNamespace(n,e){const i=new g8(n,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(i,e):(this.newHostElements.set(e,i),this.collectEnterElement(e)),this._namespaceLookup[n]=i}_balanceNamespaceList(n,e){const i=this._namespaceList,r=this.namespacesByHostElement,s=i.length-1;if(s>=0){let o=!1;if(void 0!==this.driver.getParentElement){let a=this.driver.getParentElement(e);for(;a;){const h=r.get(a);if(h){const w=i.indexOf(h);i.splice(w+1,0,n),o=!0;break}a=this.driver.getParentElement(a)}}else for(let a=s;a>=0;a--)if(this.driver.containsElement(i[a].hostElement,e)){i.splice(a+1,0,n),o=!0;break}o||i.unshift(n)}else i.push(n);return r.set(e,n),n}register(n,e){let i=this._namespaceLookup[n];return i||(i=this.createNamespace(n,e)),i}registerTrigger(n,e,i){let r=this._namespaceLookup[n];r&&r.register(e,i)&&this.totalAnimations++}destroy(n,e){if(!n)return;const i=this._fetchNamespace(n);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[n];const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>i.destroy(e))}_fetchNamespace(n){return this._namespaceLookup[n]}fetchNamespacesByElement(n){const e=new Set,i=this.statesByElement.get(n);if(i){const r=Object.keys(i);for(let s=0;s<r.length;s++){const o=i[r[s]].namespaceId;if(o){const a=this._fetchNamespace(o);a&&e.add(a)}}}return e}trigger(n,e,i,r){if(wp(e)){const s=this._fetchNamespace(n);if(s)return s.trigger(e,i,r),!0}return!1}insertNode(n,e,i,r){if(!wp(e))return;const s=e[Fs];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(e);o>=0&&this.collectedLeaveElements.splice(o,1)}if(n){const o=this._fetchNamespace(n);o&&o.insertNode(e,i)}r&&this.collectEnterElement(e)}collectEnterElement(n){this.collectedEnterElements.push(n)}markElementAsDisabled(n,e){e?this.disabledNodes.has(n)||(this.disabledNodes.add(n),Os(n,d0)):this.disabledNodes.has(n)&&(this.disabledNodes.delete(n),Xc(n,d0))}removeNode(n,e,i,r){if(wp(e)){const s=n?this._fetchNamespace(n):null;if(s?s.removeNode(e,r):this.markElementAsRemoved(n,e,!1,r),i){const o=this.namespacesByHostElement.get(e);o&&o.id!==n&&o.removeNode(e,r)}}else this._onRemovalComplete(e,r)}markElementAsRemoved(n,e,i,r,s){this.collectedLeaveElements.push(e),e[Fs]={namespaceId:n,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(n,e,i,r,s){return wp(e)?this._fetchNamespace(n).listen(e,i,r,s):()=>{}}_buildInstruction(n,e,i,r,s){return n.transition.build(this.driver,n.element,n.fromState.value,n.toState.value,i,r,n.fromState.options,n.toState.options,e,s)}destroyInnerAnimations(n){let e=this.driver.query(n,dp,!0);e.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(n,J$,!0),e.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(n){const e=this.playersByElement.get(n);e&&e.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(n){const e=this.playersByQueriedElement.get(n);e&&e.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(n=>{if(this.players.length)return Ra(this.players).onDone(()=>n());n()})}processLeaveNode(n){var e;const i=n[Fs];if(i&&i.setForRemoval){if(n[Fs]=dE,i.namespaceId){this.destroyInnerAnimations(n);const r=this._fetchNamespace(i.namespaceId);r&&r.clearElementCache(n)}this._onRemovalComplete(n,i.setForRemoval)}(null===(e=n.classList)||void 0===e?void 0:e.contains(d0))&&this.markElementAsDisabled(n,!1),this.driver.query(n,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(n=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)Os(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{e=this._flushAnimations(i,n)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],e.length?Ra(e).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(n){throw function v6(t){return new At(3402,Bn)}()}_flushAnimations(n,e){const i=new yp,r=[],s=new Map,o=[],a=new Map,h=new Map,w=new Map,X=new Set;this.disabledNodes.forEach(wt=>{X.add(wt);const It=this.driver.query(wt,".ng-animate-queued",!0);for(let St=0;St<It.length;St++)X.add(It[St])});const fe=this.bodyNode,pe=Array.from(this.statesByElement.keys()),we=pE(pe,this.collectedEnterElements),Ie=new Map;let Pe=0;we.forEach((wt,It)=>{const St=Q$+Pe++;Ie.set(It,St),wt.forEach(Ot=>Os(Ot,St))});const Be=[],Le=new Set,Fe=new Set;for(let wt=0;wt<this.collectedLeaveElements.length;wt++){const It=this.collectedLeaveElements[wt],St=It[Fs];St&&St.setForRemoval&&(Be.push(It),Le.add(It),St.hasAnimation?this.driver.query(It,".ng-star-inserted",!0).forEach(Ot=>Le.add(Ot)):Fe.add(It))}const Ve=new Map,Ge=pE(pe,Array.from(Le));Ge.forEach((wt,It)=>{const St=cp+Pe++;Ve.set(It,St),wt.forEach(Ot=>Os(Ot,St))}),n.push(()=>{we.forEach((wt,It)=>{const St=Ie.get(It);wt.forEach(Ot=>Xc(Ot,St))}),Ge.forEach((wt,It)=>{const St=Ve.get(It);wt.forEach(Ot=>Xc(Ot,St))}),Be.forEach(wt=>{this.processLeaveNode(wt)})});const ct=[],ut=[];for(let wt=this._namespaceList.length-1;wt>=0;wt--)this._namespaceList[wt].drainQueuedTransitions(e).forEach(St=>{const Ot=St.player,$n=St.element;if(ct.push(Ot),this.collectedEnterElements.length){const Di=$n[Fs];if(Di&&Di.setForMove){if(Di.previousTriggersValues&&Di.previousTriggersValues.has(St.triggerName)){const $o=Di.previousTriggersValues.get(St.triggerName),xs=this.statesByElement.get(St.element);xs&&xs[St.triggerName]&&(xs[St.triggerName].value=$o)}return void Ot.destroy()}}const jn=!fe||!this.driver.containsElement(fe,$n),Wn=Ve.get($n),bi=Ie.get($n),kn=this._buildInstruction(St,i,bi,Wn,jn);if(kn.errors&&kn.errors.length)return void ut.push(kn);if(jn)return Ot.onStart(()=>Nl($n,kn.fromStyles)),Ot.onDestroy(()=>Ro($n,kn.toStyles)),void r.push(Ot);if(St.isFallbackTransition)return Ot.onStart(()=>Nl($n,kn.fromStyles)),Ot.onDestroy(()=>Ro($n,kn.toStyles)),void r.push(Ot);const vt=[];kn.timelines.forEach(Di=>{Di.stretchStartingKeyframe=!0,this.disabledNodes.has(Di.element)||vt.push(Di)}),kn.timelines=vt,i.append($n,kn.timelines),o.push({instruction:kn,player:Ot,element:$n}),kn.queriedElements.forEach(Di=>_s(a,Di,[]).push(Ot)),kn.preStyleProps.forEach((Di,$o)=>{const xs=Object.keys(Di);if(xs.length){let Ys=h.get($o);Ys||h.set($o,Ys=new Set),xs.forEach(ol=>Ys.add(ol))}}),kn.postStyleProps.forEach((Di,$o)=>{const xs=Object.keys(Di);let Ys=w.get($o);Ys||w.set($o,Ys=new Set),xs.forEach(ol=>Ys.add(ol))})});if(ut.length){const wt=[];ut.forEach(It=>{wt.push(function b6(t,n){return new At(3505,Bn)}())}),ct.forEach(It=>It.destroy()),this.reportError(wt)}const st=new Map,yt=new Map;o.forEach(wt=>{const It=wt.element;i.has(It)&&(yt.set(It,It),this._beforeAnimationBuild(wt.player.namespaceId,wt.instruction,st))}),r.forEach(wt=>{const It=wt.element;this._getPreviousPlayers(It,!1,wt.namespaceId,wt.triggerName,null).forEach(Ot=>{_s(st,It,[]).push(Ot),Ot.destroy()})});const nt=Be.filter(wt=>_E(wt,h,w)),lt=new Map;hE(lt,this.driver,Fe,w,ca).forEach(wt=>{_E(wt,h,w)&&nt.push(wt)});const Vt=new Map;we.forEach((wt,It)=>{hE(Vt,this.driver,new Set(wt),h,"!")}),nt.forEach(wt=>{const It=lt.get(wt),St=Vt.get(wt);lt.set(wt,Object.assign(Object.assign({},It),St))});const Ht=[],dn=[],Pn={};o.forEach(wt=>{const{element:It,player:St,instruction:Ot}=wt;if(i.has(It)){if(X.has(It))return St.onDestroy(()=>Ro(It,Ot.toStyles)),St.disabled=!0,St.overrideTotalTime(Ot.totalTime),void r.push(St);let $n=Pn;if(yt.size>1){let Wn=It;const bi=[];for(;Wn=Wn.parentNode;){const kn=yt.get(Wn);if(kn){$n=kn;break}bi.push(Wn)}bi.forEach(kn=>yt.set(kn,$n))}const jn=this._buildAnimation(St.namespaceId,Ot,st,s,Vt,lt);if(St.setRealPlayer(jn),$n===Pn)Ht.push(St);else{const Wn=this.playersByElement.get($n);Wn&&Wn.length&&(St.parentPlayer=Ra(Wn)),r.push(St)}}else Nl(It,Ot.fromStyles),St.onDestroy(()=>Ro(It,Ot.toStyles)),dn.push(St),X.has(It)&&r.push(St)}),dn.forEach(wt=>{const It=s.get(wt.element);if(It&&It.length){const St=Ra(It);wt.setRealPlayer(St)}}),r.forEach(wt=>{wt.parentPlayer?wt.syncPlayerEvents(wt.parentPlayer):wt.destroy()});for(let wt=0;wt<Be.length;wt++){const It=Be[wt],St=It[Fs];if(Xc(It,cp),St&&St.hasAnimation)continue;let Ot=[];if(a.size){let jn=a.get(It);jn&&jn.length&&Ot.push(...jn);let Wn=this.driver.query(It,J$,!0);for(let bi=0;bi<Wn.length;bi++){let kn=a.get(Wn[bi]);kn&&kn.length&&Ot.push(...kn)}}const $n=Ot.filter(jn=>!jn.destroyed);$n.length?b8(this,It,$n):this.processLeaveNode(It)}return Be.length=0,Ht.forEach(wt=>{this.players.push(wt),wt.onDone(()=>{wt.destroy();const It=this.players.indexOf(wt);this.players.splice(It,1)}),wt.play()}),Ht}elementContainsData(n,e){let i=!1;const r=e[Fs];return r&&r.setForRemoval&&(i=!0),this.playersByElement.has(e)&&(i=!0),this.playersByQueriedElement.has(e)&&(i=!0),this.statesByElement.has(e)&&(i=!0),this._fetchNamespace(n).elementContainsData(e)||i}afterFlush(n){this._flushFns.push(n)}afterFlushAnimationsDone(n){this._whenQuietFns.push(n)}_getPreviousPlayers(n,e,i,r,s){let o=[];if(e){const a=this.playersByQueriedElement.get(n);a&&(o=a)}else{const a=this.playersByElement.get(n);if(a){const h=!s||s==Bd;a.forEach(w=>{w.queued||!h&&w.triggerName!=r||o.push(w)})}}return(i||r)&&(o=o.filter(a=>!(i&&i!=a.namespaceId||r&&r!=a.triggerName))),o}_beforeAnimationBuild(n,e,i){const s=e.element,o=e.isRemovalTransition?void 0:n,a=e.isRemovalTransition?void 0:e.triggerName;for(const h of e.timelines){const w=h.element,X=w!==s,fe=_s(i,w,[]);this._getPreviousPlayers(w,X,o,a,e.toState).forEach(we=>{const Ie=we.getRealPlayer();Ie.beforeDestroy&&Ie.beforeDestroy(),we.destroy(),fe.push(we)})}Nl(s,e.fromStyles)}_buildAnimation(n,e,i,r,s,o){const a=e.triggerName,h=e.element,w=[],X=new Set,fe=new Set,pe=e.timelines.map(Ie=>{const Pe=Ie.element;X.add(Pe);const Be=Pe[Fs];if(Be&&Be.removedBeforeQueried)return new Od(Ie.duration,Ie.delay);const Le=Pe!==h,Fe=function y8(t){const n=[];return gE(t,n),n}((i.get(Pe)||h8).map(st=>st.getRealPlayer())).filter(st=>!!st.element&&st.element===Pe),Ve=s.get(Pe),Ge=o.get(Pe),ct=jw(0,this._normalizer,0,Ie.keyframes,Ve,Ge),ut=this._buildPlayer(Ie,ct,Fe);if(Ie.subTimeline&&r&&fe.add(Pe),Le){const st=new p0(n,a,Pe);st.setRealPlayer(ut),w.push(st)}return ut});w.forEach(Ie=>{_s(this.playersByQueriedElement,Ie.element,[]).push(Ie),Ie.onDone(()=>function m8(t,n,e){let i;if(t instanceof Map){if(i=t.get(n),i){if(i.length){const r=i.indexOf(e);i.splice(r,1)}0==i.length&&t.delete(n)}}else if(i=t[n],i){if(i.length){const r=i.indexOf(e);i.splice(r,1)}0==i.length&&delete t[n]}return i}(this.playersByQueriedElement,Ie.element,Ie))}),X.forEach(Ie=>Os(Ie,Xw));const we=Ra(pe);return we.onDestroy(()=>{X.forEach(Ie=>Xc(Ie,Xw)),Ro(h,e.toStyles)}),fe.forEach(Ie=>{_s(r,Ie,[]).push(we)}),we}_buildPlayer(n,e,i){return e.length>0?this.driver.animate(n.element,e,n.duration,n.delay,n.easing,i):new Od(n.duration,n.delay)}}class p0{constructor(n,e,i){this.namespaceId=n,this.triggerName=e,this.element=i,this._player=new Od,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(n){this._containsRealPlayer||(this._player=n,Object.keys(this._queuedCallbacks).forEach(e=>{this._queuedCallbacks[e].forEach(i=>q$(n,e,void 0,i))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(n.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(n){this.totalTime=n}syncPlayerEvents(n){const e=this._player;e.triggerCallback&&n.onStart(()=>e.triggerCallback("start")),n.onDone(()=>this.finish()),n.onDestroy(()=>this.destroy())}_queueEvent(n,e){_s(this._queuedCallbacks,n,[]).push(e)}onDone(n){this.queued&&this._queueEvent("done",n),this._player.onDone(n)}onStart(n){this.queued&&this._queueEvent("start",n),this._player.onStart(n)}onDestroy(n){this.queued&&this._queueEvent("destroy",n),this._player.onDestroy(n)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(n){this.queued||this._player.setPosition(n)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(n){const e=this._player;e.triggerCallback&&e.triggerCallback(n)}}function wp(t){return t&&1===t.nodeType}function fE(t,n){const e=t.style.display;return t.style.display=null!=n?n:"none",e}function hE(t,n,e,i,r){const s=[];e.forEach(h=>s.push(fE(h)));const o=[];i.forEach((h,w)=>{const X={};h.forEach(fe=>{const pe=X[fe]=n.computeStyle(w,fe,r);(!pe||0==pe.length)&&(w[Fs]=p8,o.push(w))}),t.set(w,X)});let a=0;return e.forEach(h=>fE(h,s[a++])),o}function pE(t,n){const e=new Map;if(t.forEach(a=>e.set(a,[])),0==n.length)return e;const r=new Set(n),s=new Map;function o(a){if(!a)return 1;let h=s.get(a);if(h)return h;const w=a.parentNode;return h=e.has(w)?w:r.has(w)?1:o(w),s.set(a,h),h}return n.forEach(a=>{const h=o(a);1!==h&&e.get(h).push(a)}),e}function Os(t,n){var e;null===(e=t.classList)||void 0===e||e.add(n)}function Xc(t,n){var e;null===(e=t.classList)||void 0===e||e.remove(n)}function b8(t,n,e){Ra(e).onDone(()=>t.processLeaveNode(n))}function gE(t,n){for(let e=0;e<t.length;e++){const i=t[e];i instanceof Lw?gE(i.players,n):n.push(i)}}function _E(t,n,e){const i=e.get(t);if(!i)return!1;let r=n.get(t);return r?i.forEach(s=>r.add(s)):n.set(t,i),e.delete(t),!0}class Ep{constructor(n,e,i){this.bodyNode=n,this._driver=e,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new _8(n,e,i),this._timelineEngine=new l8(n,e,i),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(n,e,i,r,s){const o=n+"-"+r;let a=this._triggerCache[o];if(!a){const h=[],X=r0(this._driver,s,h,[]);if(h.length)throw function c6(t,n){return new At(3404,Bn)}();a=function r8(t,n,e){return new s8(t,n,e)}(r,X,this._normalizer),this._triggerCache[o]=a}this._transitionEngine.registerTrigger(e,r,a)}register(n,e){this._transitionEngine.register(n,e)}destroy(n,e){this._transitionEngine.destroy(n,e)}onInsert(n,e,i,r){this._transitionEngine.insertNode(n,e,i,r)}onRemove(n,e,i,r){this._transitionEngine.removeNode(n,e,r||!1,i)}disableAnimations(n,e){this._transitionEngine.markElementAsDisabled(n,e)}process(n,e,i,r){if("@"==i.charAt(0)){const[s,o]=Hw(i);this._timelineEngine.command(s,e,o,r)}else this._transitionEngine.trigger(n,e,i,r)}listen(n,e,i,r,s){if("@"==i.charAt(0)){const[o,a]=Hw(i);return this._timelineEngine.listen(o,e,a,s)}return this._transitionEngine.listen(n,e,i,r,s)}flush(n=-1){this._transitionEngine.flush(n)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let w8=(()=>{class t{constructor(e,i,r){this._element=e,this._startStyles=i,this._endStyles=r,this._state=0;let s=t.initialStylesByElement.get(e);s||t.initialStylesByElement.set(e,s={}),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&Ro(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Ro(this._element,this._initialStyles),this._endStyles&&(Ro(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(Nl(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Nl(this._element,this._endStyles),this._endStyles=null),Ro(this._element,this._initialStyles),this._state=3)}}return t.initialStylesByElement=new WeakMap,t})();function g0(t){let n=null;const e=Object.keys(t);for(let i=0;i<e.length;i++){const r=e[i];E8(r)&&(n=n||{},n[r]=t[r])}return n}function E8(t){return"display"===t||"position"===t}class mE{constructor(n,e,i,r){this.element=n,this.keyframes=e,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const n=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,n,this.options),this._finalKeyframe=n.length?n[n.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(n,e,i){return n.animate(e,i)}onStart(n){this._onStartFns.push(n)}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(n=>n()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}setPosition(n){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=n*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const n={};if(this.hasStarted()){const e=this._finalKeyframe;Object.keys(e).forEach(i=>{"offset"!=i&&(n[i]=this._finished?e[i]:nE(this.element,i))})}this.currentSnapshot=n}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class T8{validateStyleProperty(n){return qw(n)}matchesElement(n,e){return!1}containsElement(n,e){return Ww(n,e)}getParentElement(n){return Z$(n)}query(n,e,i){return Kw(n,e,i)}computeStyle(n,e,i){return window.getComputedStyle(n)[e]}animate(n,e,i,r,s,o=[]){const h={duration:i,delay:r,fill:0==r?"both":"forwards"};s&&(h.easing=s);const w={},X=o.filter(pe=>pe instanceof mE);(function M6(t,n){return 0===t||0===n})(i,r)&&X.forEach(pe=>{let we=pe.currentSnapshot;Object.keys(we).forEach(Ie=>w[Ie]=we[Ie])}),e=function D6(t,n,e){const i=Object.keys(e);if(i.length&&n.length){let s=n[0],o=[];if(i.forEach(a=>{s.hasOwnProperty(a)||o.push(a),s[a]=e[a]}),o.length)for(var r=1;r<n.length;r++){let a=n[r];o.forEach(function(h){a[h]=nE(t,h)})}}return n}(n,e=e.map(pe=>Ba(pe,!1)),w);const fe=function x8(t,n){let e=null,i=null;return Array.isArray(n)&&n.length?(e=g0(n[0]),n.length>1&&(i=g0(n[n.length-1]))):n&&(e=g0(n)),e||i?new w8(t,e,i):null}(n,e);return new mE(n,e,h,fe)}}let S8=(()=>{class t extends Ow{constructor(e,i){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(i.body,{id:"0",encapsulation:Js.None,styles:[],data:{animation:[]}})}build(e){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(e)?Rw(e):e;return $E(this._renderer,null,i,"register",[r]),new I8(i,this._renderer)}}return t.\u0275fac=function(e){return new(e||t)(an(_d),an(Xr))},t.\u0275prov=rn({token:t,factory:t.\u0275fac}),t})();class I8 extends class jR{}{constructor(n,e){super(),this._id=n,this._renderer=e}create(n,e){return new k8(this._id,n,e||{},this._renderer)}}class k8{constructor(n,e,i,r){this.id=n,this.element=e,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(n,e){return this._renderer.listen(this.element,`@@${this.id}:${n}`,e)}_command(n,...e){return $E(this._renderer,this.element,this.id,n,e)}onDone(n){this._listen("done",n)}onStart(n){this._listen("start",n)}onDestroy(n){this._listen("destroy",n)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(n){this._command("setPosition",n)}getPosition(){var n,e;return null!==(e=null===(n=this._renderer.engine.players[+this.id])||void 0===n?void 0:n.getPosition())&&void 0!==e?e:0}}function $E(t,n,e,i,r){return t.setProperty(n,`@@${e}:${i}`,r)}const vE="@.disabled";let M8=(()=>{class t{constructor(e,i,r){this.delegate=e,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(s,o)=>{const a=null==o?void 0:o.parentNode(s);a&&o.removeChild(a,s)}}createRenderer(e,i){const s=this.delegate.createRenderer(e,i);if(!(e&&i&&i.data&&i.data.animation)){let X=this._rendererCache.get(s);return X||(X=new bE("",s,this.engine),this._rendererCache.set(s,X)),X}const o=i.id,a=i.id+"-"+this._currentId;this._currentId++,this.engine.register(a,e);const h=X=>{Array.isArray(X)?X.forEach(h):this.engine.registerTrigger(o,a,e,X.name,X)};return i.data.animation.forEach(h),new D8(this,a,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,i,r){e>=0&&e<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,a]=s;o(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return t.\u0275fac=function(e){return new(e||t)(an(_d),an(Ep),an(Cn))},t.\u0275prov=rn({token:t,factory:t.\u0275fac}),t})();class bE{constructor(n,e,i){this.namespaceId=n,this.delegate=e,this.engine=i,this.destroyNode=this.delegate.destroyNode?r=>e.destroyNode(r):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(n,e){return this.delegate.createElement(n,e)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}appendChild(n,e){this.delegate.appendChild(n,e),this.engine.onInsert(this.namespaceId,e,n,!1)}insertBefore(n,e,i,r=!0){this.delegate.insertBefore(n,e,i),this.engine.onInsert(this.namespaceId,e,n,r)}removeChild(n,e,i){this.engine.onRemove(this.namespaceId,e,this.delegate,i)}selectRootElement(n,e){return this.delegate.selectRootElement(n,e)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,e,i,r){this.delegate.setAttribute(n,e,i,r)}removeAttribute(n,e,i){this.delegate.removeAttribute(n,e,i)}addClass(n,e){this.delegate.addClass(n,e)}removeClass(n,e){this.delegate.removeClass(n,e)}setStyle(n,e,i,r){this.delegate.setStyle(n,e,i,r)}removeStyle(n,e,i){this.delegate.removeStyle(n,e,i)}setProperty(n,e,i){"@"==e.charAt(0)&&e==vE?this.disableAnimations(n,!!i):this.delegate.setProperty(n,e,i)}setValue(n,e){this.delegate.setValue(n,e)}listen(n,e,i){return this.delegate.listen(n,e,i)}disableAnimations(n,e){this.engine.disableAnimations(n,e)}}class D8 extends bE{constructor(n,e,i,r){super(e,i,r),this.factory=n,this.namespaceId=e}setProperty(n,e,i){"@"==e.charAt(0)?"."==e.charAt(1)&&e==vE?this.disableAnimations(n,i=void 0===i||!!i):this.engine.process(this.namespaceId,n,e.substr(1),i):this.delegate.setProperty(n,e,i)}listen(n,e,i){if("@"==e.charAt(0)){const r=function A8(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(n);let s=e.substr(1),o="";return"@"!=s.charAt(0)&&([s,o]=function P8(t){const n=t.indexOf(".");return[t.substring(0,n),t.substr(n+1)]}(s)),this.engine.listen(this.namespaceId,r,s,o,a=>{this.factory.scheduleListenerCallback(a._data||-1,i,a)})}return this.delegate.listen(n,e,i)}}let N8=(()=>{class t extends Ep{constructor(e,i,r){super(e.body,i,r)}ngOnDestroy(){this.flush()}}return t.\u0275fac=function(e){return new(e||t)(an(Xr),an(X$),an(c0))},t.\u0275prov=rn({token:t,factory:t.\u0275fac}),t})();const yE=new On("AnimationModuleType"),CE=[{provide:Ow,useClass:S8},{provide:c0,useFactory:function F8(){return new J6}},{provide:Ep,useClass:N8},{provide:_d,useFactory:function O8(t,n,e){return new M8(t,n,e)},deps:[Zh,Ep,Cn]}],xE=[{provide:X$,useFactory:()=>new T8},{provide:yE,useValue:"BrowserAnimations"},...CE],R8=[{provide:X$,useClass:Yw},{provide:yE,useValue:"NoopAnimations"},...CE];let B8=(()=>{class t{static withConfig(e){return{ngModule:t,providers:e.disableAnimations?R8:xE}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ss({type:t}),t.\u0275inj=os({providers:xE,imports:[D2]}),t})(),Ld=(()=>{class t{constructor(){this.count=0,this.animeState="active"}ngOnChanges(){this.animeState="inactive",queueMicrotask(()=>{this.animeState="active"})}animationShuffleDone(e){this.animeState="inactive"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Xt({type:t,selectors:[["badge"]],inputs:{count:"count"},features:[io],decls:2,vars:2,consts:[[1,"badge"]],template:function(e,i){1&e&&(Q(0,"div",0),ye(1),ie()),2&e&&(re("@bounce",i.animeState),U(1),Xe(i.count))},styles:[".badge[_ngcontent-%COMP%]{min-width:8px;min-height:8px;font-size:8px;padding:2px 4px;border-radius:100px;text-align:center;color:#eee;background-color:#cf5252}"],data:{animation:[Sn("bounce",[ap("active",et({transform:""})),Lt("* => active",[Rt("600ms ease",sn([et({transform:"scale3d(0.5, 0.5, 0.5)",offset:0}),et({transform:"scale3d(2, 2, 2)",offset:.5}),et({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),et({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),et({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])])]}}),t})();var _0,tn=me(5861);(_0||(_0={})).resize=function n(e,i,r,s){let o=e.width,a=e.height,h=o/(i=Math.round(i)),w=a/(r=Math.round(r)),X=Math.ceil(h/2),fe=Math.ceil(w/2),pe=e.getContext("2d"),we=pe.getImageData(0,0,o,a),Ie=pe.createImageData(i,r),Pe=we.data,Be=Ie.data;for(let Le=0;Le<r;Le++)for(let Fe=0;Fe<i;Fe++){let Ve=4*(Fe+Le*i),Ge=0,ct=0,ut=0,st=0,yt=0,nt=0,lt=0,gt=(Le+.5)*w,Vt=Math.floor(Le*w),Ht=Math.ceil((Le+1)*w);for(let dn=Vt;dn<Ht;dn++){let Pn=Math.abs(gt-(dn+.5))/fe,wt=(Fe+.5)*h,It=Pn*Pn,St=Math.floor(Fe*h),Ot=Math.ceil((Fe+1)*h);for(let $n=St;$n<Ot;$n++){let jn=Math.abs(wt-($n+.5))/X,Wn=Math.sqrt(It+jn*jn);if(Wn>=1)continue;Ge=2*Wn*Wn*Wn-3*Wn*Wn+1;let bi=4*($n+dn*o);lt+=Ge*Pe[bi+3],ut+=Ge,Pe[bi+3]<255&&(Ge=Ge*Pe[bi+3]/250),st+=Ge*Pe[bi],yt+=Ge*Pe[bi+1],nt+=Ge*Pe[bi+2],ct+=Ge}}Be[Ve]=st/ct,Be[Ve+1]=yt/ct,Be[Ve+2]=nt/ct,Be[Ve+3]=lt/ut}!0===s?(e.width=i,e.height=r):pe.clearRect(0,0,o,a),pe.putImageData(Ie,0,0)};var po,L8=me(7412),wE=me(1817);!function(t){function r(){return(r=(0,tn.Z)(function*(h){return h instanceof Blob?s(h):a(h)})).apply(this,arguments)}function s(h){return o.apply(this,arguments)}function o(){return(o=(0,tn.Z)(function*(h){return a(yield t.readAsArrayBufferAsync(h))})).apply(this,arguments)}function a(h){let w=L8.create(h);return wE(w).toString()}t.readAsArrayBufferAsync=function n(h){return new Promise((w,X)=>{let fe=new FileReader;fe.onload=pe=>{w(fe.result)},fe.onabort=fe.onerror=pe=>{X(pe)},fe.readAsArrayBuffer(h)})},t.readAsTextAsync=function e(h){return new Promise((w,X)=>{let fe=new FileReader;fe.onload=pe=>{w(fe.result)},fe.onabort=fe.onerror=pe=>{X(pe)},fe.readAsText(h)})},t.calcSHA256Async=function i(h){return r.apply(this,arguments)}}(po||(po={}));var Ui=(()=>(function(t){t[t.NULL=0]="NULL",t[t.THUMBNAIL=1]="THUMBNAIL",t[t.COMPLETE=2]="COMPLETE",t[t.URL=1e3]="URL"}(Ui||(Ui={})),Ui))();class Ut{constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:"",thumbnail:{blob:null,type:"",url:""}}}get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob?this.context.blob:this.context.thumbnail.blob}get url(){return this.context.url?this.context.url:this.context.thumbnail.url}get thumbnail(){return this.context.thumbnail}get state(){return this.url||this.blob?this.url&&!this.blob?Ui.URL:this.blob===this.thumbnail.blob?Ui.THUMBNAIL:Ui.COMPLETE:Ui.NULL}get isEmpty(){return this.state<=Ui.NULL}static createEmpty(n){let e=new Ut;return e.context.identifier=n,e}static create(n){if("string"==typeof n){let e=new Ut;return e.context.identifier=n,e.context.name=n,e.context.url=n,e}{let e=new Ut;return e.apply(n),e}}static createAsync(n){return(0,tn.Z)(function*(){return n instanceof File?yield Ut._createAsync(n,n.name):n instanceof Blob?yield Ut._createAsync(n):void 0})()}static _createAsync(n,e){return(0,tn.Z)(function*(){let i=yield po.readAsArrayBufferAsync(n),r=new Ut;r.context.identifier=yield po.calcSHA256Async(i),r.context.name=e,r.context.blob=new Blob([i],{type:n.type}),r.context.url=window.URL.createObjectURL(r.context.blob);try{r.context.thumbnail=yield Ut.createThumbnailAsync(r.context)}catch(s){throw s}return null!=r.context.name&&(r.context.name=r.context.identifier),r})()}destroy(){this.revokeURLs()}apply(n){!this.context.identifier&&n.identifier&&(this.context.identifier=n.identifier),!this.context.name&&n.name&&(this.context.name=n.name),!this.context.blob&&n.blob&&(this.context.blob=n.blob),!this.context.type&&n.type&&(this.context.type=n.type),!this.context.url&&n.url&&(this.state!==Ui.URL&&window.URL.revokeObjectURL(this.context.url),this.context.url=n.url),!this.context.thumbnail.blob&&n.thumbnail.blob&&(this.context.thumbnail.blob=n.thumbnail.blob),!this.context.thumbnail.type&&n.thumbnail.type&&(this.context.thumbnail.type=n.thumbnail.type),!this.context.thumbnail.url&&n.thumbnail.url&&(this.state!==Ui.URL&&window.URL.revokeObjectURL(this.context.thumbnail.url),this.context.thumbnail.url=n.thumbnail.url),this.createURLs()}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url,thumbnail:{blob:this.context.thumbnail.blob,type:this.context.thumbnail.type,url:this.context.thumbnail.url}}}createURLs(){this.state!==Ui.URL&&(this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob)),this.context.thumbnail.blob&&""===this.context.thumbnail.url&&(this.context.thumbnail.url=window.URL.createObjectURL(this.context.thumbnail.blob)))}revokeURLs(){this.state!==Ui.URL&&(window.URL.revokeObjectURL(this.context.url),window.URL.revokeObjectURL(this.context.thumbnail.url))}static createThumbnailAsync(n){return new Promise((e,i)=>{let r=new Image;r.onload=s=>{let o=Math.min(128/Math.max(r.width,r.height),1),a=r.width*o,h=r.height*o,w=document.createElement("canvas"),X=w.getContext("2d");w.width=r.width,w.height=r.height,X.drawImage(r,0,0),_0.resize(w,a,h,!0),w.toBlob(fe=>{let pe={type:fe.type,blob:fe,url:window.URL.createObjectURL(fe)};e(pe)},n.blob.type)},r.onabort=r.onerror=()=>{i()},r.src=n.url})}}Ut.Empty=Ut.createEmpty("null");let Qc=0;const zd=new Map,Sp=new MessageChannel;function Sr(t){if(4294967296===Qc&&(Qc=0),++Qc in zd)throw new Error("setZeroTimeout queue overflow.");return zd.set(Qc,t),Sp.port2.postMessage(Qc),Qc}Sp.port1.onmessage=function(t){const n=zd.get(t.data);zd.delete(t.data),n&&n()},Sp.port1.start(),Sp.port2.start();class EE{}var TE=me(8497),La=(()=>(function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LOW=1]="LOW",t[t.MIDDLE=2]="MIDDLE",t[t.HIGH=3]="HIGH"}(La||(La={})),La))();const H8=function j8(t){if(t.length>=255)throw new TypeError("Alphabet too long");const n=new Uint8Array(256);for(let w=0;w<n.length;w++)n[w]=255;for(let w=0;w<t.length;w++){const X=t.charAt(w),fe=X.charCodeAt(0);if(255!==n[fe])throw new TypeError(X+" is ambiguous");n[fe]=w}const e=t.length,i=t.charAt(0),r=Math.log(e)/Math.log(256),s=Math.log(256)/Math.log(e);function a(w){if("string"!=typeof w)throw new TypeError("Expected String");if(0===w.length)return new Uint8Array;let X=0;if(" "===w[X])return;let fe=0,pe=0;for(;w[X]===i;)fe++,X++;const we=(w.length-X)*r+1>>>0,Ie=new Uint8Array(we);for(;w[X];){let Fe=n[w.charCodeAt(X)];if(255===Fe)return;let Ve=0;for(let Ge=we-1;(0!==Fe||Ve<pe)&&-1!==Ge;Ge--,Ve++)Fe+=e*Ie[Ge]>>>0,Ie[Ge]=Fe%256>>>0,Fe=Fe/256>>>0;if(0!==Fe)throw new Error("Non-zero carry");pe=Ve,X++}if(" "===w[X])return;let Pe=we-pe;for(;Pe!==we&&0===Ie[Pe];)Pe++;const Be=new Uint8Array(fe+(we-Pe));let Le=fe;for(;Pe!==we;)Be[Le++]=Ie[Pe++];return Be}return{encode:function o(w){if(w instanceof Uint8Array||(ArrayBuffer.isView(w)?w=new Uint8Array(w.buffer,w.byteOffset,w.byteLength):Array.isArray(w)&&(w=Uint8Array.from(w))),!(w instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===w.length)return"";let X=0,fe=0,pe=0;const we=w.length;for(;pe!==we&&0===w[pe];)pe++,X++;const Ie=(we-pe)*s+1>>>0,Pe=new Uint8Array(Ie);for(;pe!==we;){let Fe=w[pe],Ve=0;for(let Ge=Ie-1;(0!==Fe||Ve<fe)&&-1!==Ge;Ge--,Ve++)Fe+=256*Pe[Ge]>>>0,Pe[Ge]=Fe%e>>>0,Fe=Fe/e>>>0;if(0!==Fe)throw new Error("Non-zero carry");fe=Ve,pe++}let Be=Ie-fe;for(;Be!==Ie&&0===Pe[Be];)Be++;let Le=i.repeat(X);for(;Be<Ie;++Be)Le+=t.charAt(Pe[Be]);return Le},decodeUnsafe:a,decode:function h(w){const X=a(w);if(X)return X;throw new Error("Non-base"+e+" character")}}}("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),U8=/^(\w{6})(\w{3})(\w*)-(\w*)/i;class vi{constructor(n){this.peerId="",this.userId="",this.roomId="",this.roomName="",this.password="",this.digestUserId="",this.digestPassword="",this.isOpen=!1,this.session={grade:La.UNSPECIFIED,ping:0,health:0,speed:0,description:""},this.parse(n)}get isRoom(){return 0<this.roomId.length}get hasPassword(){return 0<this.password.length+this.digestPassword.length}parse(n){try{this.peerId=n;let e=U8.exec(n);if(null!=e)return this.digestUserId=e[1],this.roomId=e[2],this.roomName=TE.L(e[3]),void(this.digestPassword=e[4])}catch(e){console.warn(e)}this.digestUserId=n}verifyPassword(n){return SE(this.roomId,n)===this.digestPassword}static parse(n){return new vi(n)}static create(...n){return n.length<=1?vi._create.apply(this,n):vi._createRoom.apply(this,n)}static _create(n=""){let e=function V8(t){return null==t?"":IE(t)}(n),i=new vi(e);return i.userId=n,i}static _createRoom(n="",e="",i="",r=""){let s=this.generateId("******"),o=SE(e,r),a=`${s}${e}${TE.n(i)}-${o}`,h=new vi(a);return h.userId=n,h.password=r,h}static generateId(n="********"){const e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";let i=n;return i=n.replace(/\*/g,r=>e[Math.floor(Math.random()*e.length)]),i}}function SE(t,n){return null==t||null==n?"":0<n.length?IE(t+n,7):""}function IE(t,n=-1){if(null==t)return"";let e=wE(t),i=new Uint8Array(Uint32Array.from(e.words).buffer),r=H8.encode(i);return n<0&&(n=r.length),r.length<n&&(n=r.length),r=r.slice(0,n),r}function Jc(t){let n=t.length;for(;--n>=0;)t[n]=0}const y0=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Ip=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Q8=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),OE=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ua=new Array(576);Jc(ua);const Ud=new Array(60);Jc(Ud);const Vd=new Array(512);Jc(Vd);const Gd=new Array(256);Jc(Gd);const C0=new Array(29);Jc(C0);const kp=new Array(30);function x0(t,n,e,i,r){this.static_tree=t,this.extra_bits=n,this.extra_base=e,this.elems=i,this.max_length=r,this.has_stree=t&&t.length}let RE,BE,LE;function w0(t,n){this.dyn_tree=t,this.max_code=0,this.stat_desc=n}Jc(kp);const zE=t=>t<256?Vd[t]:Vd[256+(t>>>7)],qd=(t,n)=>{t.pending_buf[t.pending++]=255&n,t.pending_buf[t.pending++]=n>>>8&255},ts=(t,n,e)=>{t.bi_valid>16-e?(t.bi_buf|=n<<t.bi_valid&65535,qd(t,t.bi_buf),t.bi_buf=n>>16-t.bi_valid,t.bi_valid+=e-16):(t.bi_buf|=n<<t.bi_valid&65535,t.bi_valid+=e)},Bo=(t,n,e)=>{ts(t,e[2*n],e[2*n+1])},jE=(t,n)=>{let e=0;do{e|=1&t,t>>>=1,e<<=1}while(--n>0);return e>>>1},HE=(t,n,e)=>{const i=new Array(16);let s,o,r=0;for(s=1;s<=15;s++)r=r+e[s-1]<<1,i[s]=r;for(o=0;o<=n;o++){let a=t[2*o+1];0!==a&&(t[2*o]=jE(i[a]++,a))}},UE=t=>{let n;for(n=0;n<286;n++)t.dyn_ltree[2*n]=0;for(n=0;n<30;n++)t.dyn_dtree[2*n]=0;for(n=0;n<19;n++)t.bl_tree[2*n]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},VE=t=>{t.bi_valid>8?qd(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},GE=(t,n,e,i)=>{const r=2*n,s=2*e;return t[r]<t[s]||t[r]===t[s]&&i[n]<=i[e]},E0=(t,n,e)=>{const i=t.heap[e];let r=e<<1;for(;r<=t.heap_len&&(r<t.heap_len&&GE(n,t.heap[r+1],t.heap[r],t.depth)&&r++,!GE(n,i,t.heap[r],t.depth));)t.heap[e]=t.heap[r],e=r,r<<=1;t.heap[e]=i},qE=(t,n,e)=>{let i,r,o,a,s=0;if(0!==t.sym_next)do{i=255&t.pending_buf[t.sym_buf+s++],i+=(255&t.pending_buf[t.sym_buf+s++])<<8,r=t.pending_buf[t.sym_buf+s++],0===i?Bo(t,r,n):(o=Gd[r],Bo(t,o+256+1,n),a=y0[o],0!==a&&(r-=C0[o],ts(t,r,a)),i--,o=zE(i),Bo(t,o,e),a=Ip[o],0!==a&&(i-=kp[o],ts(t,i,a)))}while(s<t.sym_next);Bo(t,256,n)},T0=(t,n)=>{const e=n.dyn_tree,i=n.stat_desc.static_tree,r=n.stat_desc.has_stree,s=n.stat_desc.elems;let o,a,w,h=-1;for(t.heap_len=0,t.heap_max=573,o=0;o<s;o++)0!==e[2*o]?(t.heap[++t.heap_len]=h=o,t.depth[o]=0):e[2*o+1]=0;for(;t.heap_len<2;)w=t.heap[++t.heap_len]=h<2?++h:0,e[2*w]=1,t.depth[w]=0,t.opt_len--,r&&(t.static_len-=i[2*w+1]);for(n.max_code=h,o=t.heap_len>>1;o>=1;o--)E0(t,e,o);w=s;do{o=t.heap[1],t.heap[1]=t.heap[t.heap_len--],E0(t,e,1),a=t.heap[1],t.heap[--t.heap_max]=o,t.heap[--t.heap_max]=a,e[2*w]=e[2*o]+e[2*a],t.depth[w]=(t.depth[o]>=t.depth[a]?t.depth[o]:t.depth[a])+1,e[2*o+1]=e[2*a+1]=w,t.heap[1]=w++,E0(t,e,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,n)=>{const e=n.dyn_tree,i=n.max_code,r=n.stat_desc.static_tree,s=n.stat_desc.has_stree,o=n.stat_desc.extra_bits,a=n.stat_desc.extra_base,h=n.stat_desc.max_length;let w,X,fe,pe,we,Ie,Pe=0;for(pe=0;pe<=15;pe++)t.bl_count[pe]=0;for(e[2*t.heap[t.heap_max]+1]=0,w=t.heap_max+1;w<573;w++)X=t.heap[w],pe=e[2*e[2*X+1]+1]+1,pe>h&&(pe=h,Pe++),e[2*X+1]=pe,!(X>i)&&(t.bl_count[pe]++,we=0,X>=a&&(we=o[X-a]),Ie=e[2*X],t.opt_len+=Ie*(pe+we),s&&(t.static_len+=Ie*(r[2*X+1]+we)));if(0!==Pe){do{for(pe=h-1;0===t.bl_count[pe];)pe--;t.bl_count[pe]--,t.bl_count[pe+1]+=2,t.bl_count[h]--,Pe-=2}while(Pe>0);for(pe=h;0!==pe;pe--)for(X=t.bl_count[pe];0!==X;)fe=t.heap[--w],!(fe>i)&&(e[2*fe+1]!==pe&&(t.opt_len+=(pe-e[2*fe+1])*e[2*fe],e[2*fe+1]=pe),X--)}})(t,n),HE(e,h,t.bl_count)},WE=(t,n,e)=>{let i,s,r=-1,o=n[1],a=0,h=7,w=4;for(0===o&&(h=138,w=3),n[2*(e+1)+1]=65535,i=0;i<=e;i++)s=o,o=n[2*(i+1)+1],!(++a<h&&s===o)&&(a<w?t.bl_tree[2*s]+=a:0!==s?(s!==r&&t.bl_tree[2*s]++,t.bl_tree[32]++):a<=10?t.bl_tree[34]++:t.bl_tree[36]++,a=0,r=s,0===o?(h=138,w=3):s===o?(h=6,w=3):(h=7,w=4))},KE=(t,n,e)=>{let i,s,r=-1,o=n[1],a=0,h=7,w=4;for(0===o&&(h=138,w=3),i=0;i<=e;i++)if(s=o,o=n[2*(i+1)+1],!(++a<h&&s===o)){if(a<w)do{Bo(t,s,t.bl_tree)}while(0!=--a);else 0!==s?(s!==r&&(Bo(t,s,t.bl_tree),a--),Bo(t,16,t.bl_tree),ts(t,a-3,2)):a<=10?(Bo(t,17,t.bl_tree),ts(t,a-3,3)):(Bo(t,18,t.bl_tree),ts(t,a-11,7));a=0,r=s,0===o?(h=138,w=3):s===o?(h=6,w=3):(h=7,w=4)}};let YE=!1;const ZE=(t,n,e,i)=>{ts(t,0+(i?1:0),3),VE(t),qd(t,e),qd(t,~e),e&&t.pending_buf.set(t.window.subarray(n,n+e),t.pending),t.pending+=e};var gB={_tr_init:t=>{YE||((()=>{let t,n,e,i,r;const s=new Array(16);for(e=0,i=0;i<28;i++)for(C0[i]=e,t=0;t<1<<y0[i];t++)Gd[e++]=i;for(Gd[e-1]=i,r=0,i=0;i<16;i++)for(kp[i]=r,t=0;t<1<<Ip[i];t++)Vd[r++]=i;for(r>>=7;i<30;i++)for(kp[i]=r<<7,t=0;t<1<<Ip[i]-7;t++)Vd[256+r++]=i;for(n=0;n<=15;n++)s[n]=0;for(t=0;t<=143;)ua[2*t+1]=8,t++,s[8]++;for(;t<=255;)ua[2*t+1]=9,t++,s[9]++;for(;t<=279;)ua[2*t+1]=7,t++,s[7]++;for(;t<=287;)ua[2*t+1]=8,t++,s[8]++;for(HE(ua,287,s),t=0;t<30;t++)Ud[2*t+1]=5,Ud[2*t]=jE(t,5);RE=new x0(ua,y0,257,286,15),BE=new x0(Ud,Ip,0,30,15),LE=new x0(new Array(0),Q8,0,19,7)})(),YE=!0),t.l_desc=new w0(t.dyn_ltree,RE),t.d_desc=new w0(t.dyn_dtree,BE),t.bl_desc=new w0(t.bl_tree,LE),t.bi_buf=0,t.bi_valid=0,UE(t)},_tr_stored_block:ZE,_tr_flush_block:(t,n,e,i)=>{let r,s,o=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),T0(t,t.l_desc),T0(t,t.d_desc),o=(t=>{let n;for(WE(t,t.dyn_ltree,t.l_desc.max_code),WE(t,t.dyn_dtree,t.d_desc.max_code),T0(t,t.bl_desc),n=18;n>=3&&0===t.bl_tree[2*OE[n]+1];n--);return t.opt_len+=3*(n+1)+5+5+4,n})(t),r=t.opt_len+3+7>>>3,s=t.static_len+3+7>>>3,s<=r&&(r=s)):r=s=e+5,e+4<=r&&-1!==n?ZE(t,n,e,i):4===t.strategy||s===r?(ts(t,2+(i?1:0),3),qE(t,ua,Ud)):(ts(t,4+(i?1:0),3),((t,n,e,i)=>{let r;for(ts(t,n-257,5),ts(t,e-1,5),ts(t,i-4,4),r=0;r<i;r++)ts(t,t.bl_tree[2*OE[r]+1],3);KE(t,t.dyn_ltree,n-1),KE(t,t.dyn_dtree,e-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1),qE(t,t.dyn_ltree,t.dyn_dtree)),UE(t),i&&VE(t)},_tr_tally:(t,n,e)=>(t.pending_buf[t.sym_buf+t.sym_next++]=n,t.pending_buf[t.sym_buf+t.sym_next++]=n>>8,t.pending_buf[t.sym_buf+t.sym_next++]=e,0===n?t.dyn_ltree[2*e]++:(t.matches++,n--,t.dyn_ltree[2*(Gd[e]+256+1)]++,t.dyn_dtree[2*zE(n)]++),t.sym_next===t.sym_end),_tr_align:t=>{ts(t,2,3),Bo(t,256,ua),(t=>{16===t.bi_valid?(qd(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}},Wd=(t,n,e,i)=>{let r=65535&t|0,s=t>>>16&65535|0,o=0;for(;0!==e;){o=e>2e3?2e3:e,e-=o;do{r=r+n[i++]|0,s=s+r|0}while(--o);r%=65521,s%=65521}return r|s<<16|0};const mB=new Uint32Array((()=>{let t,n=[];for(var e=0;e<256;e++){t=e;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;n[e]=t}return n})());var ar=(t,n,e,i)=>{const r=mB,s=i+e;t^=-1;for(let o=i;o<s;o++)t=t>>>8^r[255&(t^n[o])];return-1^t},Rl={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Bl={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:$B,_tr_stored_block:S0,_tr_flush_block:vB,_tr_tally:za,_tr_align:bB}=gB,{Z_NO_FLUSH:ja,Z_PARTIAL_FLUSH:yB,Z_FULL_FLUSH:CB,Z_FINISH:Rs,Z_BLOCK:XE,Z_OK:pr,Z_STREAM_END:QE,Z_STREAM_ERROR:Lo,Z_DATA_ERROR:xB,Z_BUF_ERROR:I0,Z_DEFAULT_COMPRESSION:wB,Z_FILTERED:EB,Z_HUFFMAN_ONLY:Mp,Z_RLE:TB,Z_FIXED:SB,Z_DEFAULT_STRATEGY:IB,Z_UNKNOWN:kB,Z_DEFLATED:Dp}=Bl,zo=262,jl=(t,n)=>(t.msg=Rl[n],n),JE=t=>2*t-(t>4?9:0),Ua=t=>{let n=t.length;for(;--n>=0;)t[n]=0},zB=t=>{let n,e,i,r=t.w_size;n=t.hash_size,i=n;do{e=t.head[--i],t.head[i]=e>=r?e-r:0}while(--n);n=r,i=n;do{e=t.prev[--i],t.prev[i]=e>=r?e-r:0}while(--n)};let Va=(t,n,e)=>(n<<t.hash_shift^e)&t.hash_mask;const $s=t=>{const n=t.state;let e=n.pending;e>t.avail_out&&(e=t.avail_out),0!==e&&(t.output.set(n.pending_buf.subarray(n.pending_out,n.pending_out+e),t.next_out),t.next_out+=e,n.pending_out+=e,t.total_out+=e,t.avail_out-=e,n.pending-=e,0===n.pending&&(n.pending_out=0))},vs=(t,n)=>{vB(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,n),t.block_start=t.strstart,$s(t.strm)},Zn=(t,n)=>{t.pending_buf[t.pending++]=n},Yd=(t,n)=>{t.pending_buf[t.pending++]=n>>>8&255,t.pending_buf[t.pending++]=255&n},F0=(t,n,e,i)=>{let r=t.avail_in;return r>i&&(r=i),0===r?0:(t.avail_in-=r,n.set(t.input.subarray(t.next_in,t.next_in+r),e),1===t.state.wrap?t.adler=Wd(t.adler,n,r,e):2===t.state.wrap&&(t.adler=ar(t.adler,n,r,e)),t.next_in+=r,t.total_in+=r,r)},e3=(t,n)=>{let r,s,e=t.max_chain_length,i=t.strstart,o=t.prev_length,a=t.nice_match;const h=t.strstart>t.w_size-zo?t.strstart-(t.w_size-zo):0,w=t.window,X=t.w_mask,fe=t.prev,pe=t.strstart+258;let we=w[i+o-1],Ie=w[i+o];t.prev_length>=t.good_match&&(e>>=2),a>t.lookahead&&(a=t.lookahead);do{if(r=n,w[r+o]===Ie&&w[r+o-1]===we&&w[r]===w[i]&&w[++r]===w[i+1]){i+=2,r++;do{}while(w[++i]===w[++r]&&w[++i]===w[++r]&&w[++i]===w[++r]&&w[++i]===w[++r]&&w[++i]===w[++r]&&w[++i]===w[++r]&&w[++i]===w[++r]&&w[++i]===w[++r]&&i<pe);if(s=258-(pe-i),i=pe-258,s>o){if(t.match_start=n,o=s,s>=a)break;we=w[i+o-1],Ie=w[i+o]}}}while((n=fe[n&X])>h&&0!=--e);return o<=t.lookahead?o:t.lookahead},ru=t=>{const n=t.w_size;let e,i,r;do{if(i=t.window_size-t.lookahead-t.strstart,t.strstart>=n+(n-zo)&&(t.window.set(t.window.subarray(n,n+n-i),0),t.match_start-=n,t.strstart-=n,t.block_start-=n,t.insert>t.strstart&&(t.insert=t.strstart),zB(t),i+=n),0===t.strm.avail_in)break;if(e=F0(t.strm,t.window,t.strstart+t.lookahead,i),t.lookahead+=e,t.lookahead+t.insert>=3)for(r=t.strstart-t.insert,t.ins_h=t.window[r],t.ins_h=Va(t,t.ins_h,t.window[r+1]);t.insert&&(t.ins_h=Va(t,t.ins_h,t.window[r+3-1]),t.prev[r&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=r,r++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<zo&&0!==t.strm.avail_in)},t3=(t,n)=>{let i,r,s,e=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,o=0,a=t.strm.avail_in;do{if(i=65535,s=t.bi_valid+42>>3,t.strm.avail_out<s||(s=t.strm.avail_out-s,r=t.strstart-t.block_start,i>r+t.strm.avail_in&&(i=r+t.strm.avail_in),i>s&&(i=s),i<e&&(0===i&&n!==Rs||n===ja||i!==r+t.strm.avail_in)))break;o=n===Rs&&i===r+t.strm.avail_in?1:0,S0(t,0,0,o),t.pending_buf[t.pending-4]=i,t.pending_buf[t.pending-3]=i>>8,t.pending_buf[t.pending-2]=~i,t.pending_buf[t.pending-1]=~i>>8,$s(t.strm),r&&(r>i&&(r=i),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+r),t.strm.next_out),t.strm.next_out+=r,t.strm.avail_out-=r,t.strm.total_out+=r,t.block_start+=r,i-=r),i&&(F0(t.strm,t.strm.output,t.strm.next_out,i),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i)}while(0===o);return a-=t.strm.avail_in,a&&(a>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=a&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-a,t.strm.next_in),t.strstart),t.strstart+=a,t.insert+=a>t.w_size-t.insert?t.w_size-t.insert:a),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),o?4:n!==ja&&n!==Rs&&0===t.strm.avail_in&&t.strstart===t.block_start?2:(s=t.window_size-t.strstart,t.strm.avail_in>s&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,s+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),s>t.strm.avail_in&&(s=t.strm.avail_in),s&&(F0(t.strm,t.window,t.strstart,s),t.strstart+=s,t.insert+=s>t.w_size-t.insert?t.w_size-t.insert:s),t.high_water<t.strstart&&(t.high_water=t.strstart),s=t.bi_valid+42>>3,s=t.pending_buf_size-s>65535?65535:t.pending_buf_size-s,e=s>t.w_size?t.w_size:s,r=t.strstart-t.block_start,(r>=e||(r||n===Rs)&&n!==ja&&0===t.strm.avail_in&&r<=s)&&(i=r>s?s:r,o=n===Rs&&0===t.strm.avail_in&&i===r?1:0,S0(t,t.block_start,i,o),t.block_start+=i,$s(t.strm)),o?3:1)},O0=(t,n)=>{let e,i;for(;;){if(t.lookahead<zo){if(ru(t),t.lookahead<zo&&n===ja)return 1;if(0===t.lookahead)break}if(e=0,t.lookahead>=3&&(t.ins_h=Va(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==e&&t.strstart-e<=t.w_size-zo&&(t.match_length=e3(t,e)),t.match_length>=3)if(i=za(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=Va(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=Va(t,t.ins_h,t.window[t.strstart+1]);else i=za(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(vs(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,n===Rs?(vs(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(vs(t,!1),0===t.strm.avail_out)?1:2},su=(t,n)=>{let e,i,r;for(;;){if(t.lookahead<zo){if(ru(t),t.lookahead<zo&&n===ja)return 1;if(0===t.lookahead)break}if(e=0,t.lookahead>=3&&(t.ins_h=Va(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==e&&t.prev_length<t.max_lazy_match&&t.strstart-e<=t.w_size-zo&&(t.match_length=e3(t,e),t.match_length<=5&&(t.strategy===EB||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-3,i=za(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=Va(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,i&&(vs(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(i=za(t,0,t.window[t.strstart-1]),i&&vs(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=za(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,n===Rs?(vs(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(vs(t,!1),0===t.strm.avail_out)?1:2};function jo(t,n,e,i,r){this.good_length=t,this.max_lazy=n,this.nice_length=e,this.max_chain=i,this.func=r}const Zd=[new jo(0,0,0,0,t3),new jo(4,4,8,4,O0),new jo(4,5,16,8,O0),new jo(4,6,32,32,O0),new jo(4,4,16,16,su),new jo(8,16,32,32,su),new jo(8,16,128,128,su),new jo(8,32,128,256,su),new jo(32,128,258,1024,su),new jo(32,258,258,4096,su)];function VB(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Dp,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Ua(this.dyn_ltree),Ua(this.dyn_dtree),Ua(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Ua(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Ua(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Xd=t=>{if(!t)return 1;const n=t.state;return!n||n.strm!==t||42!==n.status&&57!==n.status&&69!==n.status&&73!==n.status&&91!==n.status&&103!==n.status&&113!==n.status&&666!==n.status?1:0},n3=t=>{if(Xd(t))return jl(t,Lo);t.total_in=t.total_out=0,t.data_type=kB;const n=t.state;return n.pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=2===n.wrap?57:n.wrap?42:113,t.adler=2===n.wrap?0:1,n.last_flush=-2,$B(n),pr},i3=t=>{const n=n3(t);return n===pr&&(t=>{t.window_size=2*t.w_size,Ua(t.head),t.max_lazy_match=Zd[t.level].max_lazy,t.good_match=Zd[t.level].good_length,t.nice_match=Zd[t.level].nice_length,t.max_chain_length=Zd[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0})(t.state),n},r3=(t,n,e,i,r,s)=>{if(!t)return Lo;let o=1;if(n===wB&&(n=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),r<1||r>9||e!==Dp||i<8||i>15||n<0||n>9||s<0||s>SB||8===i&&1!==o)return jl(t,Lo);8===i&&(i=9);const a=new VB;return t.state=a,a.strm=t,a.status=42,a.wrap=o,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=r+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<r+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=n,a.strategy=s,a.method=e,i3(t)};var Qd_deflateInit2=r3,Qd_deflateSetHeader=(t,n)=>Xd(t)||2!==t.state.wrap?Lo:(t.state.gzhead=n,pr),Qd_deflate=(t,n)=>{if(Xd(t)||n>XE||n<0)return t?jl(t,Lo):Lo;const e=t.state;if(!t.output||0!==t.avail_in&&!t.input||666===e.status&&n!==Rs)return jl(t,0===t.avail_out?I0:Lo);const i=e.last_flush;if(e.last_flush=n,0!==e.pending){if($s(t),0===t.avail_out)return e.last_flush=-1,pr}else if(0===t.avail_in&&JE(n)<=JE(i)&&n!==Rs)return jl(t,I0);if(666===e.status&&0!==t.avail_in)return jl(t,I0);if(42===e.status&&0===e.wrap&&(e.status=113),42===e.status){let r=Dp+(e.w_bits-8<<4)<<8,s=-1;if(s=e.strategy>=Mp||e.level<2?0:e.level<6?1:6===e.level?2:3,r|=s<<6,0!==e.strstart&&(r|=32),r+=31-r%31,Yd(e,r),0!==e.strstart&&(Yd(e,t.adler>>>16),Yd(e,65535&t.adler)),t.adler=1,e.status=113,$s(t),0!==e.pending)return e.last_flush=-1,pr}if(57===e.status)if(t.adler=0,Zn(e,31),Zn(e,139),Zn(e,8),e.gzhead)Zn(e,(e.gzhead.text?1:0)+(e.gzhead.hcrc?2:0)+(e.gzhead.extra?4:0)+(e.gzhead.name?8:0)+(e.gzhead.comment?16:0)),Zn(e,255&e.gzhead.time),Zn(e,e.gzhead.time>>8&255),Zn(e,e.gzhead.time>>16&255),Zn(e,e.gzhead.time>>24&255),Zn(e,9===e.level?2:e.strategy>=Mp||e.level<2?4:0),Zn(e,255&e.gzhead.os),e.gzhead.extra&&e.gzhead.extra.length&&(Zn(e,255&e.gzhead.extra.length),Zn(e,e.gzhead.extra.length>>8&255)),e.gzhead.hcrc&&(t.adler=ar(t.adler,e.pending_buf,e.pending,0)),e.gzindex=0,e.status=69;else if(Zn(e,0),Zn(e,0),Zn(e,0),Zn(e,0),Zn(e,0),Zn(e,9===e.level?2:e.strategy>=Mp||e.level<2?4:0),Zn(e,3),e.status=113,$s(t),0!==e.pending)return e.last_flush=-1,pr;if(69===e.status){if(e.gzhead.extra){let r=e.pending,s=(65535&e.gzhead.extra.length)-e.gzindex;for(;e.pending+s>e.pending_buf_size;){let a=e.pending_buf_size-e.pending;if(e.pending_buf.set(e.gzhead.extra.subarray(e.gzindex,e.gzindex+a),e.pending),e.pending=e.pending_buf_size,e.gzhead.hcrc&&e.pending>r&&(t.adler=ar(t.adler,e.pending_buf,e.pending-r,r)),e.gzindex+=a,$s(t),0!==e.pending)return e.last_flush=-1,pr;r=0,s-=a}let o=new Uint8Array(e.gzhead.extra);e.pending_buf.set(o.subarray(e.gzindex,e.gzindex+s),e.pending),e.pending+=s,e.gzhead.hcrc&&e.pending>r&&(t.adler=ar(t.adler,e.pending_buf,e.pending-r,r)),e.gzindex=0}e.status=73}if(73===e.status){if(e.gzhead.name){let s,r=e.pending;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>r&&(t.adler=ar(t.adler,e.pending_buf,e.pending-r,r)),$s(t),0!==e.pending)return e.last_flush=-1,pr;r=0}s=e.gzindex<e.gzhead.name.length?255&e.gzhead.name.charCodeAt(e.gzindex++):0,Zn(e,s)}while(0!==s);e.gzhead.hcrc&&e.pending>r&&(t.adler=ar(t.adler,e.pending_buf,e.pending-r,r)),e.gzindex=0}e.status=91}if(91===e.status){if(e.gzhead.comment){let s,r=e.pending;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>r&&(t.adler=ar(t.adler,e.pending_buf,e.pending-r,r)),$s(t),0!==e.pending)return e.last_flush=-1,pr;r=0}s=e.gzindex<e.gzhead.comment.length?255&e.gzhead.comment.charCodeAt(e.gzindex++):0,Zn(e,s)}while(0!==s);e.gzhead.hcrc&&e.pending>r&&(t.adler=ar(t.adler,e.pending_buf,e.pending-r,r))}e.status=103}if(103===e.status){if(e.gzhead.hcrc){if(e.pending+2>e.pending_buf_size&&($s(t),0!==e.pending))return e.last_flush=-1,pr;Zn(e,255&t.adler),Zn(e,t.adler>>8&255),t.adler=0}if(e.status=113,$s(t),0!==e.pending)return e.last_flush=-1,pr}if(0!==t.avail_in||0!==e.lookahead||n!==ja&&666!==e.status){let r=0===e.level?t3(e,n):e.strategy===Mp?((t,n)=>{let e;for(;;){if(0===t.lookahead&&(ru(t),0===t.lookahead)){if(n===ja)return 1;break}if(t.match_length=0,e=za(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,e&&(vs(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,n===Rs?(vs(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(vs(t,!1),0===t.strm.avail_out)?1:2})(e,n):e.strategy===TB?((t,n)=>{let e,i,r,s;const o=t.window;for(;;){if(t.lookahead<=258){if(ru(t),t.lookahead<=258&&n===ja)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(r=t.strstart-1,i=o[r],i===o[++r]&&i===o[++r]&&i===o[++r])){s=t.strstart+258;do{}while(i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&r<s);t.match_length=258-(s-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(e=za(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(e=za(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),e&&(vs(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,n===Rs?(vs(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(vs(t,!1),0===t.strm.avail_out)?1:2})(e,n):Zd[e.level].func(e,n);if((3===r||4===r)&&(e.status=666),1===r||3===r)return 0===t.avail_out&&(e.last_flush=-1),pr;if(2===r&&(n===yB?bB(e):n!==XE&&(S0(e,0,0,!1),n===CB&&(Ua(e.head),0===e.lookahead&&(e.strstart=0,e.block_start=0,e.insert=0))),$s(t),0===t.avail_out))return e.last_flush=-1,pr}return n!==Rs?pr:e.wrap<=0?QE:(2===e.wrap?(Zn(e,255&t.adler),Zn(e,t.adler>>8&255),Zn(e,t.adler>>16&255),Zn(e,t.adler>>24&255),Zn(e,255&t.total_in),Zn(e,t.total_in>>8&255),Zn(e,t.total_in>>16&255),Zn(e,t.total_in>>24&255)):(Yd(e,t.adler>>>16),Yd(e,65535&t.adler)),$s(t),e.wrap>0&&(e.wrap=-e.wrap),0!==e.pending?pr:QE)},Qd_deflateEnd=t=>{if(Xd(t))return Lo;const n=t.state.status;return t.state=null,113===n?jl(t,xB):pr},Qd_deflateSetDictionary=(t,n)=>{let e=n.length;if(Xd(t))return Lo;const i=t.state,r=i.wrap;if(2===r||1===r&&42!==i.status||i.lookahead)return Lo;if(1===r&&(t.adler=Wd(t.adler,n,e,0)),i.wrap=0,e>=i.w_size){0===r&&(Ua(i.head),i.strstart=0,i.block_start=0,i.insert=0);let h=new Uint8Array(i.w_size);h.set(n.subarray(e-i.w_size,e),0),n=h,e=i.w_size}const s=t.avail_in,o=t.next_in,a=t.input;for(t.avail_in=e,t.next_in=0,t.input=n,ru(i);i.lookahead>=3;){let h=i.strstart,w=i.lookahead-2;do{i.ins_h=Va(i,i.ins_h,i.window[h+3-1]),i.prev[h&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=h,h++}while(--w);i.strstart=h,i.lookahead=2,ru(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,t.next_in=o,t.input=a,t.avail_in=s,i.wrap=r,pr};const sL=(t,n)=>Object.prototype.hasOwnProperty.call(t,n);var Ap_assign=function(t){const n=Array.prototype.slice.call(arguments,1);for(;n.length;){const e=n.shift();if(e){if("object"!=typeof e)throw new TypeError(e+"must be non-object");for(const i in e)sL(e,i)&&(t[i]=e[i])}}return t},Ap_flattenChunks=t=>{let n=0;for(let i=0,r=t.length;i<r;i++)n+=t[i].length;const e=new Uint8Array(n);for(let i=0,r=0,s=t.length;i<s;i++){let o=t[i];e.set(o,r),r+=o.length}return e};let s3=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){s3=!1}const Jd=new Uint8Array(256);for(let t=0;t<256;t++)Jd[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Jd[254]=Jd[254]=1;var ef_string2buf=t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let n,e,i,r,s,o=t.length,a=0;for(r=0;r<o;r++)e=t.charCodeAt(r),55296==(64512&e)&&r+1<o&&(i=t.charCodeAt(r+1),56320==(64512&i)&&(e=65536+(e-55296<<10)+(i-56320),r++)),a+=e<128?1:e<2048?2:e<65536?3:4;for(n=new Uint8Array(a),s=0,r=0;s<a;r++)e=t.charCodeAt(r),55296==(64512&e)&&r+1<o&&(i=t.charCodeAt(r+1),56320==(64512&i)&&(e=65536+(e-55296<<10)+(i-56320),r++)),e<128?n[s++]=e:e<2048?(n[s++]=192|e>>>6,n[s++]=128|63&e):e<65536?(n[s++]=224|e>>>12,n[s++]=128|e>>>6&63,n[s++]=128|63&e):(n[s++]=240|e>>>18,n[s++]=128|e>>>12&63,n[s++]=128|e>>>6&63,n[s++]=128|63&e);return n},ef_buf2string=(t,n)=>{const e=n||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,n));let i,r;const s=new Array(2*e);for(r=0,i=0;i<e;){let o=t[i++];if(o<128){s[r++]=o;continue}let a=Jd[o];if(a>4)s[r++]=65533,i+=a-1;else{for(o&=2===a?31:3===a?15:7;a>1&&i<e;)o=o<<6|63&t[i++],a--;a>1?s[r++]=65533:o<65536?s[r++]=o:(o-=65536,s[r++]=55296|o>>10&1023,s[r++]=56320|1023&o)}}return((t,n)=>{if(n<65534&&t.subarray&&s3)return String.fromCharCode.apply(null,t.length===n?t:t.subarray(0,n));let e="";for(let i=0;i<n;i++)e+=String.fromCharCode(t[i]);return e})(s,r)},ef_utf8border=(t,n)=>{(n=n||t.length)>t.length&&(n=t.length);let e=n-1;for(;e>=0&&128==(192&t[e]);)e--;return e<0||0===e?n:e+Jd[t[e]]>n?e:n},o3=function fL(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const a3=Object.prototype.toString,{Z_NO_FLUSH:hL,Z_SYNC_FLUSH:pL,Z_FULL_FLUSH:gL,Z_FINISH:_L,Z_OK:Pp,Z_STREAM_END:mL,Z_DEFAULT_COMPRESSION:$L,Z_DEFAULT_STRATEGY:vL,Z_DEFLATED:bL}=Bl;function tf(t){this.options=Ap_assign({level:$L,method:bL,chunkSize:16384,windowBits:15,memLevel:8,strategy:vL},t||{});let n=this.options;n.raw&&n.windowBits>0?n.windowBits=-n.windowBits:n.gzip&&n.windowBits>0&&n.windowBits<16&&(n.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o3,this.strm.avail_out=0;let e=Qd_deflateInit2(this.strm,n.level,n.method,n.windowBits,n.memLevel,n.strategy);if(e!==Pp)throw new Error(Rl[e]);if(n.header&&Qd_deflateSetHeader(this.strm,n.header),n.dictionary){let i;if(i="string"==typeof n.dictionary?ef_string2buf(n.dictionary):"[object ArrayBuffer]"===a3.call(n.dictionary)?new Uint8Array(n.dictionary):n.dictionary,e=Qd_deflateSetDictionary(this.strm,i),e!==Pp)throw new Error(Rl[e]);this._dict_set=!0}}function R0(t,n){const e=new tf(n);if(e.push(t,!0),e.err)throw e.msg||Rl[e.err];return e.result}tf.prototype.push=function(t,n){const e=this.strm,i=this.options.chunkSize;let r,s;if(this.ended)return!1;for(s=n===~~n?n:!0===n?_L:hL,e.input="string"==typeof t?ef_string2buf(t):"[object ArrayBuffer]"===a3.call(t)?new Uint8Array(t):t,e.next_in=0,e.avail_in=e.input.length;;)if(0===e.avail_out&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),(s===pL||s===gL)&&e.avail_out<=6)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else{if(r=Qd_deflate(e,s),r===mL)return e.next_out>0&&this.onData(e.output.subarray(0,e.next_out)),r=Qd_deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===Pp;if(0!==e.avail_out){if(s>0&&e.next_out>0)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else if(0===e.avail_in)break}else this.onData(e.output)}return!0},tf.prototype.onData=function(t){this.chunks.push(t)},tf.prototype.onEnd=function(t){t===Pp&&(this.result=Ap_flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var IL={Deflate:tf,deflate:R0,deflateRaw:function yL(t,n){return(n=n||{}).raw=!0,R0(t,n)},gzip:function CL(t,n){return(n=n||{}).gzip=!0,R0(t,n)},constants:Bl};const Np=16209;var ML=function(n,e){let i,r,s,o,a,h,w,X,fe,pe,we,Ie,Pe,Be,Le,Fe,Ve,Ge,ct,ut,st,yt,nt,lt;const gt=n.state;i=n.next_in,nt=n.input,r=i+(n.avail_in-5),s=n.next_out,lt=n.output,o=s-(e-n.avail_out),a=s+(n.avail_out-257),h=gt.dmax,w=gt.wsize,X=gt.whave,fe=gt.wnext,pe=gt.window,we=gt.hold,Ie=gt.bits,Pe=gt.lencode,Be=gt.distcode,Le=(1<<gt.lenbits)-1,Fe=(1<<gt.distbits)-1;e:do{Ie<15&&(we+=nt[i++]<<Ie,Ie+=8,we+=nt[i++]<<Ie,Ie+=8),Ve=Pe[we&Le];t:for(;;){if(Ge=Ve>>>24,we>>>=Ge,Ie-=Ge,Ge=Ve>>>16&255,0===Ge)lt[s++]=65535&Ve;else{if(!(16&Ge)){if(0==(64&Ge)){Ve=Pe[(65535&Ve)+(we&(1<<Ge)-1)];continue t}if(32&Ge){gt.mode=16191;break e}n.msg="invalid literal/length code",gt.mode=Np;break e}ct=65535&Ve,Ge&=15,Ge&&(Ie<Ge&&(we+=nt[i++]<<Ie,Ie+=8),ct+=we&(1<<Ge)-1,we>>>=Ge,Ie-=Ge),Ie<15&&(we+=nt[i++]<<Ie,Ie+=8,we+=nt[i++]<<Ie,Ie+=8),Ve=Be[we&Fe];n:for(;;){if(Ge=Ve>>>24,we>>>=Ge,Ie-=Ge,Ge=Ve>>>16&255,!(16&Ge)){if(0==(64&Ge)){Ve=Be[(65535&Ve)+(we&(1<<Ge)-1)];continue n}n.msg="invalid distance code",gt.mode=Np;break e}if(ut=65535&Ve,Ge&=15,Ie<Ge&&(we+=nt[i++]<<Ie,Ie+=8,Ie<Ge&&(we+=nt[i++]<<Ie,Ie+=8)),ut+=we&(1<<Ge)-1,ut>h){n.msg="invalid distance too far back",gt.mode=Np;break e}if(we>>>=Ge,Ie-=Ge,Ge=s-o,ut>Ge){if(Ge=ut-Ge,Ge>X&&gt.sane){n.msg="invalid distance too far back",gt.mode=Np;break e}if(st=0,yt=pe,0===fe){if(st+=w-Ge,Ge<ct){ct-=Ge;do{lt[s++]=pe[st++]}while(--Ge);st=s-ut,yt=lt}}else if(fe<Ge){if(st+=w+fe-Ge,Ge-=fe,Ge<ct){ct-=Ge;do{lt[s++]=pe[st++]}while(--Ge);if(st=0,fe<ct){Ge=fe,ct-=Ge;do{lt[s++]=pe[st++]}while(--Ge);st=s-ut,yt=lt}}}else if(st+=fe-Ge,Ge<ct){ct-=Ge;do{lt[s++]=pe[st++]}while(--Ge);st=s-ut,yt=lt}for(;ct>2;)lt[s++]=yt[st++],lt[s++]=yt[st++],lt[s++]=yt[st++],ct-=3;ct&&(lt[s++]=yt[st++],ct>1&&(lt[s++]=yt[st++]))}else{st=s-ut;do{lt[s++]=lt[st++],lt[s++]=lt[st++],lt[s++]=lt[st++],ct-=3}while(ct>2);ct&&(lt[s++]=lt[st++],ct>1&&(lt[s++]=lt[st++]))}break}}break}}while(i<r&&s<a);ct=Ie>>3,i-=ct,Ie-=ct<<3,we&=(1<<Ie)-1,n.next_in=i,n.next_out=s,n.avail_in=i<r?r-i+5:5-(i-r),n.avail_out=s<a?a-s+257:257-(s-a),gt.hold=we,gt.bits=Ie};const DL=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),AL=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),PL=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),NL=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var nf=(t,n,e,i,r,s,o,a)=>{const h=a.bits;let Ve,Ge,ct,ut,st,nt,w=0,X=0,fe=0,pe=0,we=0,Ie=0,Pe=0,Be=0,Le=0,Fe=0,yt=null;const lt=new Uint16Array(16),gt=new Uint16Array(16);let Ht,dn,Pn,Vt=null;for(w=0;w<=15;w++)lt[w]=0;for(X=0;X<i;X++)lt[n[e+X]]++;for(we=h,pe=15;pe>=1&&0===lt[pe];pe--);if(we>pe&&(we=pe),0===pe)return r[s++]=20971520,r[s++]=20971520,a.bits=1,0;for(fe=1;fe<pe&&0===lt[fe];fe++);for(we<fe&&(we=fe),Be=1,w=1;w<=15;w++)if(Be<<=1,Be-=lt[w],Be<0)return-1;if(Be>0&&(0===t||1!==pe))return-1;for(gt[1]=0,w=1;w<15;w++)gt[w+1]=gt[w]+lt[w];for(X=0;X<i;X++)0!==n[e+X]&&(o[gt[n[e+X]]++]=X);if(0===t?(yt=Vt=o,nt=20):1===t?(yt=DL,Vt=AL,nt=257):(yt=PL,Vt=NL,nt=0),Fe=0,X=0,w=fe,st=s,Ie=we,Pe=0,ct=-1,Le=1<<we,ut=Le-1,1===t&&Le>852||2===t&&Le>592)return 1;for(;;){Ht=w-Pe,o[X]+1<nt?(dn=0,Pn=o[X]):o[X]>=nt?(dn=Vt[o[X]-nt],Pn=yt[o[X]-nt]):(dn=96,Pn=0),Ve=1<<w-Pe,Ge=1<<Ie,fe=Ge;do{Ge-=Ve,r[st+(Fe>>Pe)+Ge]=Ht<<24|dn<<16|Pn|0}while(0!==Ge);for(Ve=1<<w-1;Fe&Ve;)Ve>>=1;if(0!==Ve?(Fe&=Ve-1,Fe+=Ve):Fe=0,X++,0==--lt[w]){if(w===pe)break;w=n[e+o[X]]}if(w>we&&(Fe&ut)!==ct){for(0===Pe&&(Pe=we),st+=fe,Ie=w-Pe,Be=1<<Ie;Ie+Pe<pe&&(Be-=lt[Ie+Pe],!(Be<=0));)Ie++,Be<<=1;if(Le+=1<<Ie,1===t&&Le>852||2===t&&Le>592)return 1;ct=Fe&ut,r[ct]=we<<24|Ie<<16|st-s|0}}return 0!==Fe&&(r[st+Fe]=w-Pe<<24|64<<16|0),a.bits=we,0};const{Z_FINISH:p3,Z_BLOCK:OL,Z_TREES:Fp,Z_OK:Hl,Z_STREAM_END:RL,Z_NEED_DICT:BL,Z_STREAM_ERROR:Bs,Z_DATA_ERROR:g3,Z_MEM_ERROR:_3,Z_BUF_ERROR:LL,Z_DEFLATED:m3}=Bl,Op=16180,Rp=16190,da=16191,Bp=16199,Lp=16200,Ei=16209,j3=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function UL(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Ul=t=>{if(!t)return 1;const n=t.state;return!n||n.strm!==t||n.mode<Op||n.mode>16211?1:0},H3=t=>{if(Ul(t))return Bs;const n=t.state;return t.total_in=t.total_out=n.total=0,t.msg="",n.wrap&&(t.adler=1&n.wrap),n.mode=Op,n.last=0,n.havedict=0,n.flags=-1,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new Int32Array(852),n.distcode=n.distdyn=new Int32Array(592),n.sane=1,n.back=-1,Hl},U3=t=>{if(Ul(t))return Bs;const n=t.state;return n.wsize=0,n.whave=0,n.wnext=0,H3(t)},V3=(t,n)=>{let e;if(Ul(t))return Bs;const i=t.state;return n<0?(e=0,n=-n):(e=5+(n>>4),n<48&&(n&=15)),n&&(n<8||n>15)?Bs:(null!==i.window&&i.wbits!==n&&(i.window=null),i.wrap=e,i.wbits=n,U3(t))},G3=(t,n)=>{if(!t)return Bs;const e=new UL;t.state=e,e.strm=t,e.window=null,e.mode=Op;const i=V3(t,n);return i!==Hl&&(t.state=null),i};let H0,U0,q3=!0;const GL=t=>{if(q3){H0=new Int32Array(512),U0=new Int32Array(32);let n=0;for(;n<144;)t.lens[n++]=8;for(;n<256;)t.lens[n++]=9;for(;n<280;)t.lens[n++]=7;for(;n<288;)t.lens[n++]=8;for(nf(1,t.lens,0,288,H0,0,t.work,{bits:9}),n=0;n<32;)t.lens[n++]=5;nf(2,t.lens,0,32,U0,0,t.work,{bits:5}),q3=!1}t.lencode=H0,t.lenbits=9,t.distcode=U0,t.distbits=5},W3=(t,n,e,i)=>{let r;const s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),i>=s.wsize?(s.window.set(n.subarray(e-s.wsize,e),0),s.wnext=0,s.whave=s.wsize):(r=s.wsize-s.wnext,r>i&&(r=i),s.window.set(n.subarray(e-i,e-i+r),s.wnext),(i-=r)?(s.window.set(n.subarray(e-i,e),0),s.wnext=i,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0};var fa_inflateReset=U3,fa_inflateInit2=G3,fa_inflate=(t,n)=>{let e,i,r,s,o,a,h,w,X,fe,pe,we,Ie,Pe,Le,Fe,Ve,Ge,ct,ut,st,yt,Be=0;const nt=new Uint8Array(4);let lt,gt;const Vt=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Ul(t)||!t.output||!t.input&&0!==t.avail_in)return Bs;e=t.state,e.mode===da&&(e.mode=16192),o=t.next_out,r=t.output,h=t.avail_out,s=t.next_in,i=t.input,a=t.avail_in,w=e.hold,X=e.bits,fe=a,pe=h,yt=Hl;e:for(;;)switch(e.mode){case Op:if(0===e.wrap){e.mode=16192;break}for(;X<16;){if(0===a)break e;a--,w+=i[s++]<<X,X+=8}if(2&e.wrap&&35615===w){0===e.wbits&&(e.wbits=15),e.check=0,nt[0]=255&w,nt[1]=w>>>8&255,e.check=ar(e.check,nt,2,0),w=0,X=0,e.mode=16181;break}if(e.head&&(e.head.done=!1),!(1&e.wrap)||(((255&w)<<8)+(w>>8))%31){t.msg="incorrect header check",e.mode=Ei;break}if((15&w)!==m3){t.msg="unknown compression method",e.mode=Ei;break}if(w>>>=4,X-=4,st=8+(15&w),0===e.wbits&&(e.wbits=st),st>15||st>e.wbits){t.msg="invalid window size",e.mode=Ei;break}e.dmax=1<<e.wbits,e.flags=0,t.adler=e.check=1,e.mode=512&w?16189:da,w=0,X=0;break;case 16181:for(;X<16;){if(0===a)break e;a--,w+=i[s++]<<X,X+=8}if(e.flags=w,(255&e.flags)!==m3){t.msg="unknown compression method",e.mode=Ei;break}if(57344&e.flags){t.msg="unknown header flags set",e.mode=Ei;break}e.head&&(e.head.text=w>>8&1),512&e.flags&&4&e.wrap&&(nt[0]=255&w,nt[1]=w>>>8&255,e.check=ar(e.check,nt,2,0)),w=0,X=0,e.mode=16182;case 16182:for(;X<32;){if(0===a)break e;a--,w+=i[s++]<<X,X+=8}e.head&&(e.head.time=w),512&e.flags&&4&e.wrap&&(nt[0]=255&w,nt[1]=w>>>8&255,nt[2]=w>>>16&255,nt[3]=w>>>24&255,e.check=ar(e.check,nt,4,0)),w=0,X=0,e.mode=16183;case 16183:for(;X<16;){if(0===a)break e;a--,w+=i[s++]<<X,X+=8}e.head&&(e.head.xflags=255&w,e.head.os=w>>8),512&e.flags&&4&e.wrap&&(nt[0]=255&w,nt[1]=w>>>8&255,e.check=ar(e.check,nt,2,0)),w=0,X=0,e.mode=16184;case 16184:if(1024&e.flags){for(;X<16;){if(0===a)break e;a--,w+=i[s++]<<X,X+=8}e.length=w,e.head&&(e.head.extra_len=w),512&e.flags&&4&e.wrap&&(nt[0]=255&w,nt[1]=w>>>8&255,e.check=ar(e.check,nt,2,0)),w=0,X=0}else e.head&&(e.head.extra=null);e.mode=16185;case 16185:if(1024&e.flags&&(we=e.length,we>a&&(we=a),we&&(e.head&&(st=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(i.subarray(s,s+we),st)),512&e.flags&&4&e.wrap&&(e.check=ar(e.check,i,we,s)),a-=we,s+=we,e.length-=we),e.length))break e;e.length=0,e.mode=16186;case 16186:if(2048&e.flags){if(0===a)break e;we=0;do{st=i[s+we++],e.head&&st&&e.length<65536&&(e.head.name+=String.fromCharCode(st))}while(st&&we<a);if(512&e.flags&&4&e.wrap&&(e.check=ar(e.check,i,we,s)),a-=we,s+=we,st)break e}else e.head&&(e.head.name=null);e.length=0,e.mode=16187;case 16187:if(4096&e.flags){if(0===a)break e;we=0;do{st=i[s+we++],e.head&&st&&e.length<65536&&(e.head.comment+=String.fromCharCode(st))}while(st&&we<a);if(512&e.flags&&4&e.wrap&&(e.check=ar(e.check,i,we,s)),a-=we,s+=we,st)break e}else e.head&&(e.head.comment=null);e.mode=16188;case 16188:if(512&e.flags){for(;X<16;){if(0===a)break e;a--,w+=i[s++]<<X,X+=8}if(4&e.wrap&&w!==(65535&e.check)){t.msg="header crc mismatch",e.mode=Ei;break}w=0,X=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),t.adler=e.check=0,e.mode=da;break;case 16189:for(;X<32;){if(0===a)break e;a--,w+=i[s++]<<X,X+=8}t.adler=e.check=j3(w),w=0,X=0,e.mode=Rp;case Rp:if(0===e.havedict)return t.next_out=o,t.avail_out=h,t.next_in=s,t.avail_in=a,e.hold=w,e.bits=X,BL;t.adler=e.check=1,e.mode=da;case da:if(n===OL||n===Fp)break e;case 16192:if(e.last){w>>>=7&X,X-=7&X,e.mode=16206;break}for(;X<3;){if(0===a)break e;a--,w+=i[s++]<<X,X+=8}switch(e.last=1&w,w>>>=1,X-=1,3&w){case 0:e.mode=16193;break;case 1:if(GL(e),e.mode=Bp,n===Fp){w>>>=2,X-=2;break e}break;case 2:e.mode=16196;break;case 3:t.msg="invalid block type",e.mode=Ei}w>>>=2,X-=2;break;case 16193:for(w>>>=7&X,X-=7&X;X<32;){if(0===a)break e;a--,w+=i[s++]<<X,X+=8}if((65535&w)!=(w>>>16^65535)){t.msg="invalid stored block lengths",e.mode=Ei;break}if(e.length=65535&w,w=0,X=0,e.mode=16194,n===Fp)break e;case 16194:e.mode=16195;case 16195:if(we=e.length,we){if(we>a&&(we=a),we>h&&(we=h),0===we)break e;r.set(i.subarray(s,s+we),o),a-=we,s+=we,h-=we,o+=we,e.length-=we;break}e.mode=da;break;case 16196:for(;X<14;){if(0===a)break e;a--,w+=i[s++]<<X,X+=8}if(e.nlen=257+(31&w),w>>>=5,X-=5,e.ndist=1+(31&w),w>>>=5,X-=5,e.ncode=4+(15&w),w>>>=4,X-=4,e.nlen>286||e.ndist>30){t.msg="too many length or distance symbols",e.mode=Ei;break}e.have=0,e.mode=16197;case 16197:for(;e.have<e.ncode;){for(;X<3;){if(0===a)break e;a--,w+=i[s++]<<X,X+=8}e.lens[Vt[e.have++]]=7&w,w>>>=3,X-=3}for(;e.have<19;)e.lens[Vt[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,lt={bits:e.lenbits},yt=nf(0,e.lens,0,19,e.lencode,0,e.work,lt),e.lenbits=lt.bits,yt){t.msg="invalid code lengths set",e.mode=Ei;break}e.have=0,e.mode=16198;case 16198:for(;e.have<e.nlen+e.ndist;){for(;Be=e.lencode[w&(1<<e.lenbits)-1],Le=Be>>>24,Fe=Be>>>16&255,Ve=65535&Be,!(Le<=X);){if(0===a)break e;a--,w+=i[s++]<<X,X+=8}if(Ve<16)w>>>=Le,X-=Le,e.lens[e.have++]=Ve;else{if(16===Ve){for(gt=Le+2;X<gt;){if(0===a)break e;a--,w+=i[s++]<<X,X+=8}if(w>>>=Le,X-=Le,0===e.have){t.msg="invalid bit length repeat",e.mode=Ei;break}st=e.lens[e.have-1],we=3+(3&w),w>>>=2,X-=2}else if(17===Ve){for(gt=Le+3;X<gt;){if(0===a)break e;a--,w+=i[s++]<<X,X+=8}w>>>=Le,X-=Le,st=0,we=3+(7&w),w>>>=3,X-=3}else{for(gt=Le+7;X<gt;){if(0===a)break e;a--,w+=i[s++]<<X,X+=8}w>>>=Le,X-=Le,st=0,we=11+(127&w),w>>>=7,X-=7}if(e.have+we>e.nlen+e.ndist){t.msg="invalid bit length repeat",e.mode=Ei;break}for(;we--;)e.lens[e.have++]=st}}if(e.mode===Ei)break;if(0===e.lens[256]){t.msg="invalid code -- missing end-of-block",e.mode=Ei;break}if(e.lenbits=9,lt={bits:e.lenbits},yt=nf(1,e.lens,0,e.nlen,e.lencode,0,e.work,lt),e.lenbits=lt.bits,yt){t.msg="invalid literal/lengths set",e.mode=Ei;break}if(e.distbits=6,e.distcode=e.distdyn,lt={bits:e.distbits},yt=nf(2,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,lt),e.distbits=lt.bits,yt){t.msg="invalid distances set",e.mode=Ei;break}if(e.mode=Bp,n===Fp)break e;case Bp:e.mode=Lp;case Lp:if(a>=6&&h>=258){t.next_out=o,t.avail_out=h,t.next_in=s,t.avail_in=a,e.hold=w,e.bits=X,ML(t,pe),o=t.next_out,r=t.output,h=t.avail_out,s=t.next_in,i=t.input,a=t.avail_in,w=e.hold,X=e.bits,e.mode===da&&(e.back=-1);break}for(e.back=0;Be=e.lencode[w&(1<<e.lenbits)-1],Le=Be>>>24,Fe=Be>>>16&255,Ve=65535&Be,!(Le<=X);){if(0===a)break e;a--,w+=i[s++]<<X,X+=8}if(Fe&&0==(240&Fe)){for(Ge=Le,ct=Fe,ut=Ve;Be=e.lencode[ut+((w&(1<<Ge+ct)-1)>>Ge)],Le=Be>>>24,Fe=Be>>>16&255,Ve=65535&Be,!(Ge+Le<=X);){if(0===a)break e;a--,w+=i[s++]<<X,X+=8}w>>>=Ge,X-=Ge,e.back+=Ge}if(w>>>=Le,X-=Le,e.back+=Le,e.length=Ve,0===Fe){e.mode=16205;break}if(32&Fe){e.back=-1,e.mode=da;break}if(64&Fe){t.msg="invalid literal/length code",e.mode=Ei;break}e.extra=15&Fe,e.mode=16201;case 16201:if(e.extra){for(gt=e.extra;X<gt;){if(0===a)break e;a--,w+=i[s++]<<X,X+=8}e.length+=w&(1<<e.extra)-1,w>>>=e.extra,X-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=16202;case 16202:for(;Be=e.distcode[w&(1<<e.distbits)-1],Le=Be>>>24,Fe=Be>>>16&255,Ve=65535&Be,!(Le<=X);){if(0===a)break e;a--,w+=i[s++]<<X,X+=8}if(0==(240&Fe)){for(Ge=Le,ct=Fe,ut=Ve;Be=e.distcode[ut+((w&(1<<Ge+ct)-1)>>Ge)],Le=Be>>>24,Fe=Be>>>16&255,Ve=65535&Be,!(Ge+Le<=X);){if(0===a)break e;a--,w+=i[s++]<<X,X+=8}w>>>=Ge,X-=Ge,e.back+=Ge}if(w>>>=Le,X-=Le,e.back+=Le,64&Fe){t.msg="invalid distance code",e.mode=Ei;break}e.offset=Ve,e.extra=15&Fe,e.mode=16203;case 16203:if(e.extra){for(gt=e.extra;X<gt;){if(0===a)break e;a--,w+=i[s++]<<X,X+=8}e.offset+=w&(1<<e.extra)-1,w>>>=e.extra,X-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){t.msg="invalid distance too far back",e.mode=Ei;break}e.mode=16204;case 16204:if(0===h)break e;if(we=pe-h,e.offset>we){if(we=e.offset-we,we>e.whave&&e.sane){t.msg="invalid distance too far back",e.mode=Ei;break}we>e.wnext?(we-=e.wnext,Ie=e.wsize-we):Ie=e.wnext-we,we>e.length&&(we=e.length),Pe=e.window}else Pe=r,Ie=o-e.offset,we=e.length;we>h&&(we=h),h-=we,e.length-=we;do{r[o++]=Pe[Ie++]}while(--we);0===e.length&&(e.mode=Lp);break;case 16205:if(0===h)break e;r[o++]=e.length,h--,e.mode=Lp;break;case 16206:if(e.wrap){for(;X<32;){if(0===a)break e;a--,w|=i[s++]<<X,X+=8}if(pe-=h,t.total_out+=pe,e.total+=pe,4&e.wrap&&pe&&(t.adler=e.check=e.flags?ar(e.check,r,pe,o-pe):Wd(e.check,r,pe,o-pe)),pe=h,4&e.wrap&&(e.flags?w:j3(w))!==e.check){t.msg="incorrect data check",e.mode=Ei;break}w=0,X=0}e.mode=16207;case 16207:if(e.wrap&&e.flags){for(;X<32;){if(0===a)break e;a--,w+=i[s++]<<X,X+=8}if(4&e.wrap&&w!==(4294967295&e.total)){t.msg="incorrect length check",e.mode=Ei;break}w=0,X=0}e.mode=16208;case 16208:yt=RL;break e;case Ei:yt=g3;break e;case 16210:return _3;default:return Bs}return t.next_out=o,t.avail_out=h,t.next_in=s,t.avail_in=a,e.hold=w,e.bits=X,(e.wsize||pe!==t.avail_out&&e.mode<Ei&&(e.mode<16206||n!==p3))&&W3(t,t.output,t.next_out,pe-t.avail_out),fe-=t.avail_in,pe-=t.avail_out,t.total_in+=fe,t.total_out+=pe,e.total+=pe,4&e.wrap&&pe&&(t.adler=e.check=e.flags?ar(e.check,r,pe,t.next_out-pe):Wd(e.check,r,pe,t.next_out-pe)),t.data_type=e.bits+(e.last?64:0)+(e.mode===da?128:0)+(e.mode===Bp||16194===e.mode?256:0),(0===fe&&0===pe||n===p3)&&yt===Hl&&(yt=LL),yt},fa_inflateEnd=t=>{if(Ul(t))return Bs;let n=t.state;return n.window&&(n.window=null),t.state=null,Hl},fa_inflateGetHeader=(t,n)=>{if(Ul(t))return Bs;const e=t.state;return 0==(2&e.wrap)?Bs:(e.head=n,n.done=!1,Hl)},fa_inflateSetDictionary=(t,n)=>{const e=n.length;let i,r,s;return Ul(t)||(i=t.state,0!==i.wrap&&i.mode!==Rp)?Bs:i.mode===Rp&&(r=1,r=Wd(r,n,e,0),r!==i.check)?g3:(s=W3(t,n,e,e),s?(i.mode=16210,_3):(i.havedict=1,Hl))},a9=function o9(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const K3=Object.prototype.toString,{Z_NO_FLUSH:l9,Z_FINISH:c9,Z_OK:rf,Z_STREAM_END:V0,Z_NEED_DICT:G0,Z_STREAM_ERROR:u9,Z_DATA_ERROR:Y3,Z_MEM_ERROR:d9}=Bl;function sf(t){this.options=Ap_assign({chunkSize:65536,windowBits:15,to:""},t||{});const n=this.options;n.raw&&n.windowBits>=0&&n.windowBits<16&&(n.windowBits=-n.windowBits,0===n.windowBits&&(n.windowBits=-15)),n.windowBits>=0&&n.windowBits<16&&!(t&&t.windowBits)&&(n.windowBits+=32),n.windowBits>15&&n.windowBits<48&&0==(15&n.windowBits)&&(n.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o3,this.strm.avail_out=0;let e=fa_inflateInit2(this.strm,n.windowBits);if(e!==rf)throw new Error(Rl[e]);if(this.header=new a9,fa_inflateGetHeader(this.strm,this.header),n.dictionary&&("string"==typeof n.dictionary?n.dictionary=ef_string2buf(n.dictionary):"[object ArrayBuffer]"===K3.call(n.dictionary)&&(n.dictionary=new Uint8Array(n.dictionary)),n.raw&&(e=fa_inflateSetDictionary(this.strm,n.dictionary),e!==rf)))throw new Error(Rl[e])}function q0(t,n){const e=new sf(n);if(e.push(t),e.err)throw e.msg||Rl[e.err];return e.result}sf.prototype.push=function(t,n){const e=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let s,o,a;if(this.ended)return!1;for(o=n===~~n?n:!0===n?c9:l9,e.input="[object ArrayBuffer]"===K3.call(t)?new Uint8Array(t):t,e.next_in=0,e.avail_in=e.input.length;;){for(0===e.avail_out&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),s=fa_inflate(e,o),s===G0&&r&&(s=fa_inflateSetDictionary(e,r),s===rf?s=fa_inflate(e,o):s===Y3&&(s=G0));e.avail_in>0&&s===V0&&e.state.wrap>0&&0!==t[e.next_in];)fa_inflateReset(e),s=fa_inflate(e,o);switch(s){case u9:case Y3:case G0:case d9:return this.onEnd(s),this.ended=!0,!1}if(a=e.avail_out,e.next_out&&(0===e.avail_out||s===V0))if("string"===this.options.to){let h=ef_utf8border(e.output,e.next_out),w=e.next_out-h,X=ef_buf2string(e.output,h);e.next_out=w,e.avail_out=i-w,w&&e.output.set(e.output.subarray(h,h+w),0),this.onData(X)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(s!==rf||0!==a){if(s===V0)return s=fa_inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(0===e.avail_in)break}}return!0},sf.prototype.onData=function(t){this.chunks.push(t)},sf.prototype.onEnd=function(t){t===rf&&(this.result="string"===this.options.to?this.chunks.join(""):Ap_flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var $9={Inflate:sf,inflate:q0,inflateRaw:function f9(t,n){return(n=n||{}).raw=!0,q0(t,n)},ungzip:q0,constants:Bl};const{Deflate:v9}=IL,{Inflate:x9}=$9;var Z3=v9,X3=x9;function W0(){return W0=(0,tn.Z)(function*(t,n){const e=new Z3({level:2,gzip:!0});try{return yield Q3(e,t,n),e.result}catch(i){console.error(i)}return null}),W0.apply(this,arguments)}function K0(){return K0=(0,tn.Z)(function*(t,n){const e=new X3;try{return yield Q3(e,t,n),e.result}catch(i){console.error(i)}return null}),K0.apply(this,arguments)}function Q3(t,n){return Y0.apply(this,arguments)}function Y0(){return Y0=(0,tn.Z)(function*(t,n,e=16384){let i=Math.ceil(n.byteLength/e),r=null;for(let s=0;s<i;s++)yield O9(),r=n.slice(s*e,(s+1)*e),t.push(r,i<=s+1);if(t.err)throw new Error(`error: ${t.err}`);return t}),Y0.apply(this,arguments)}function O9(){return new Promise(t=>Sr(t))}var bs,J3=me(2391);!function(t){t.encode=function n(i){try{return J3.encode(i)}catch(r){console.error(r,i)}return null},t.decode=function e(i){try{return J3.decode(i)}catch(r){console.error(r,i)}return null}}(bs||(bs={}));var ns,R9=me(9069);!function(t){let n=[];for(let i=0;i<256;i++)n[i]=(i<16?"0":"")+i.toString(16);t.generateUuid=function e(){const i=new Uint32Array(4);window.crypto.getRandomValues(i);const r=i[0],s=i[1],o=i[2],a=i[3];return n[255&r]+n[r>>8&255]+n[r>>16&255]+n[r>>24&255]+"-"+n[255&s]+n[s>>8&255]+"-"+n[s>>16&15|64]+n[s>>24&255]+"-"+n[63&o|128]+n[o>>8&255]+"-"+n[o>>16&255]+n[o>>24&255]+n[255&a]+n[a>>8&255]+n[a>>16&255]+n[a>>24&255]}}(ns||(ns={}));class ha{constructor(n,e){this.timerMilliSecond=0,this.timeoutDate=0,this.isStopped=!1,this.callback=n,this.timerMilliSecond=e,this.reset()}get isActive(){return null!=this.timeoutTimer}stop(){this.isStopped=!0}clear(){this.callback=null,this.timerMilliSecond=0,this.timeoutDate=0,this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.isStopped=!1}reset(...n){1===n.length?this.timerMilliSecond=n[0]:1<n.length&&(this.callback=n[0],this.timerMilliSecond=n[1]),this.isStopped=!1;let e=this.timeoutDate;this.timeoutDate=performance.now()+this.timerMilliSecond,!(this.timeoutTimer&&e<=this.timeoutDate)&&this.setTimeout()}setTimeout(){this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.callback&&(this.timeoutTimer=setTimeout(()=>{this.timeoutTimer=null,!this.isStopped&&(performance.now()<this.timeoutDate?this.setTimeout():this.callback&&this.callback())},this.timeoutDate-performance.now()))}}class zp{constructor(){}static add(n){this.monitoringConnections.add(n),n.updateStatsAsync(),this.restart()}static remove(n){this.monitoringConnections.delete(n)}static restart(){null==this.updateWebRTCStatsTimer?this.updateWebRTCStatsTimer=new ha(()=>this.doMonitoringAsync(),this.calcIntervalTime()):this.updateWebRTCStatsTimer.isActive||this.updateWebRTCStatsTimer.reset(this.calcIntervalTime())}static calcIntervalTime(){return Math.min(2e3+1e3*this.monitoringConnections.size,1e4)}static doMonitoringAsync(){var n=this;return(0,tn.Z)(function*(){for(let e of n.monitoringConnections)e.open?yield e.updateStatsAsync():n.remove(e);n.monitoringConnections.size<1?n.updateWebRTCStatsTimer=null:n.restart()})()}}zp.updateWebRTCStatsTimer=null,zp.monitoringConnections=new Set;var Ls=(()=>(function(t){t.UNKNOWN="unknown",t.RELAY="relay",t.PRFLX="prflx",t.SRFLX="srflx",t.HOST="host"}(Ls||(Ls={})),Ls))();class B9{constructor(n){this.peerConnection=n,this.candidateType=Ls.UNKNOWN}updateAsync(){var n=this;return(0,tn.Z)(function*(){let e=null;try{e=yield n.peerConnection.getStats()}catch(pe){console.warn(pe)}if(null==e)return void(n.candidateType=Ls.UNKNOWN);let i=[],r=[],s=[],o=[],a=[],h=[],w=[];e.forEach(pe=>{0<=pe.type.indexOf("candidate-pair")&&i.push(pe),0<=pe.type.indexOf("local-candidate")&&r.push(pe),0<=pe.type.indexOf("remote-candidate")&&s.push(pe)}),i.forEach(pe=>{"succeeded"===pe.state&&(o.push(pe.localCandidateId),a.push(pe.remoteCandidateId))}),r.forEach(pe=>{o.includes(pe.id)&&h.push(pe)}),s.forEach(pe=>{a.includes(pe.id)&&w.push(pe)});let X=Ls.UNKNOWN,fe=Object.values(Ls);h.concat(w).forEach(pe=>{let we=fe.indexOf(pe.candidateType);fe.indexOf(X)<we&&(X=fe[we])}),n.candidateType=X})()}}class eT extends R9.EventEmitter{constructor(n){super(),this.conn=n,this.chunkSize=15872,this.receivedMap=new Map,this.timeoutTimer=null,this._timestamp=performance.now(),this._ping=0,this._candidateType=Ls.UNKNOWN,n.on("data",e=>this.onData(e)),n.on("open",()=>{this.stats=new B9(this.getPeerConnection()),this.clearTimeoutTimer(),function L9(t){t._dc&&t._sendBuffer&&(t._startSendLoop=z9)}(n),this.emit("open"),this.startMonitoring()}),n.on("close",()=>{this.clearTimeoutTimer(),this.emit("close")}),n.on("error",e=>{this.clearTimeoutTimer(),this.emit("error",e)}),this.setTimeoutTimer()}get open(){return this.conn.open}get remoteId(){return this.conn.remoteId}get metadata(){return this.conn.metadata}get bufferedAmount(){var n,e;return null!==(e=null===(n=this.conn._dc)||void 0===n?void 0:n.bufferedAmount)&&void 0!==e?e:0}get timestamp(){return this._timestamp}set timestamp(n){this._timestamp=n}get ping(){return this._ping}set ping(n){this._ping=n}get candidateType(){return this._candidateType}set candidateType(n){this._candidateType=n}close(){this.clearTimeoutTimer(),this.stopMonitoring(),this.conn.close()}send(n){let e=bs.encode(n),i=Math.ceil(e.byteLength/this.chunkSize);if(i<=1)return void this.conn.send(e);let r=ns.generateUuid(),s=null,o=null;for(let a=0;a<i;a++)s=e.slice(a*this.chunkSize,(a+1)*this.chunkSize),o={id:r,data:s,index:a,total:i},this.conn.send(bs.encode(o))}getPeerConnection(){return this.conn.getPeerConnection()}startMonitoring(){zp.add(this)}stopMonitoring(){zp.remove(this)}updateStatsAsync(){var n=this;return(0,tn.Z)(function*(){null!=n.stats&&(n.sendPing(),yield n.stats.updateAsync(),n.candidateType=n.stats.candidateType,n.emit("stats",n.stats))})()}sendPing(){let n=bs.encode({from:this.remoteId,ping:performance.now()});this.conn.send(n)}receivePing(n){if(n.from===this.remoteId){let i=performance.now()-n.ping;this.ping=i<=this.ping?.5*this.ping+.5*i:i}else{let e=bs.encode(n);this.conn.send(e)}}onData(n){this.timestamp=performance.now();let e=bs.decode(new Uint8Array(n));if(null!=e.ping)return void this.receivePing(e);let r=e;if(null==r.id)return void this.emit("data",e);let s=this.receivedMap.get(r.id);if(null==s&&(s={id:r.id,chanks:new Array(r.total),length:0,byteLength:0},this.receivedMap.set(r.id,s)),null!=s.chanks[r.index]||(s.length++,s.byteLength+=r.data.byteLength,s.chanks[r.index]=r.data,s.length<r.total))return;this.receivedMap.delete(r.id);let o=new Uint8Array(s.byteLength),a=0;for(let w of s.chanks)o.set(w,a),a+=w.byteLength;let h=bs.decode(o);this.emit("data",h)}setTimeoutTimer(){this.clearTimeoutTimer(),this.timeoutTimer=setTimeout(()=>{console.warn(`timeout ${this.conn.remoteId}`),this.timeoutTimer=null,this.emit("close")},15e3)}clearTimeoutTimer(){null!=this.timeoutTimer&&(clearTimeout(this.timeoutTimer),this.timeoutTimer=null)}}function z9(){this.sendInterval||(this.sendInterval=Sr(tT.bind(this)))}function tT(){const t=this._sendBuffer.shift();try{this._dc.send(t)}catch(n){this._sendBuffer.push(t)}this.sendInterval=0===this._sendBuffer.length?void 0:Sr(tT.bind(this))}class j9{constructor(){this._peerIds=[],this.peerContext=vi.parse("???"),this.peerContexts=[],this.callback=new EE,this.bandwidthUsage=0,this.key="",this.connections=[],this.listAllPeersCache=[],this.httpRequestInterval=performance.now()+500,this.outboundQueue=Promise.resolve(),this.inboundQueue=Promise.resolve(),this.relayingPeerIds=new Map,this.maybeUnavailablePeerIds=new Set}get peerId(){return this.peerContext?this.peerContext.peerId:"???"}get peerIds(){return this._peerIds}open(...n){console.log("open",n),this.peerContext=0===n.length?vi.create(vi.generateId()):1===n.length?vi.create(n[0]):vi.create(n[0],n[1],n[2],n[3]),this.openPeer()}close(){this.peer&&this.peer.destroy(),this.disconnectAll(),this.peer=null,this.peerContext=vi.parse("???")}connect(n){if(!this.shouldConnect(n))return!1;let e=new eT(this.peer.connect(n,{serialization:"none",metadata:{sendFrom:this.peerId}}));return this.openDataConnection(e),!0}shouldConnect(n){return this.peerContext&&this.peer&&this.peerId?this.peerId===n?(console.log("connect() is Fail. "+n+" is me."),!1):this.findDataConnection(n)?(console.log("connect() is Fail. <"+n+"> is already connecting."),!1):!(!n||!n.length||n===this.peerId):(console.log("connect() is Fail. ID\u304c\u5272\u308a\u632f\u3089\u308c\u308b\u307e\u3067\u5f85\u3066\u3084"),!1)}disconnect(n){let e=this.findDataConnection(n);return!!e&&(this.closeDataConnection(e),!0)}disconnectAll(){console.log("<closeAllDataConnection()>");for(let n of this.connections.concat())this.closeDataConnection(n)}send(n,e){var i=this;if(this.connections.length<1)return;let r={data:bs.encode(n),ttl:1},s=r.data.byteLength;this.bandwidthUsage+=s,this.outboundQueue=this.outboundQueue.then(()=>new Promise((o,a)=>{Sr((0,tn.Z)(function*(){if(1024<r.data.byteLength&&Array.isArray(n)&&1<n.length){let h=yield function N9(t,n){return W0.apply(this,arguments)}(r.data);h.byteLength<r.data.byteLength&&(r.data=h,r.isCompressed=!0)}return e?i.sendUnicast(r,e):i.sendBroadcast(r),i.bandwidthUsage-=s,o()}))}))}sendUnicast(n,e){n.ttl=0;let i=this.findDataConnection(e);i&&i.open&&i.send(n)}sendBroadcast(n){for(let e of this.connections)e.open&&e.send(n)}setApiKey(n){this.key!==n&&console.log("Key Change"),this.key=n}listAllPeers(){return new Promise((n,e)=>{if(!this.peer)return n([]);let i=performance.now();if(i<this.httpRequestInterval)return console.warn("httpRequestInterval... "+(this.httpRequestInterval-i)),void n(this.listAllPeersCache.concat());this.httpRequestInterval=i+6e3,this.peer.listAllPeers(r=>{this.listAllPeersCache=r.concat(),n(r)})})}openPeer(){this.peer&&(console.warn("It is already opened."),this.close());let n=new Peer(this.peerContext.peerId,{key:this.key});n.on("open",e=>{console.log("My peer ID is: "+e),(!this.peerContext||this.peerContext.peerId!==e)&&(this.peerContext=vi.parse(e)),this.peerContext.isOpen=!0,console.log("My peer Context",this.peerContext),this.callback.onOpen&&this.callback.onOpen(this.peerId)}),n.on("close",()=>{console.log("Peer close"),this.peerContext&&this.peerContext.isOpen&&(this.peerContext.isOpen=!1,this.callback.onClose&&this.callback.onClose(this.peerId))}),n.on("connection",e=>{this.openDataConnection(new eT(e))}),n.on("error",e=>{console.error("<"+this.peerId+"> "+e.type+" => "+e.message);let i=`${this.getSkyWayErrorMessage(e.type)}\n\n${e.type}: ${e.message}`;switch(e.type){case"peer-unavailable":let r=/"(.+)"/.exec(e.message)[1];this.disconnect(r);break;case"disconnected":case"socket-error":case"unavailable-id":case"authentication":case"server-error":this.peerContext&&this.peerContext.isOpen&&(this.close(),this.callback.onClose&&this.callback.onClose(this.peerId))}this.callback.onError&&this.callback.onError(this.peerId,e.type,i,e)}),this.peer=n}openDataConnection(n){if(!1===this.addDataConnection(n))return;let e=this.connections.indexOf(n),i=null;0<=e&&(i=this.peerContexts[e]),this.maybeUnavailablePeerIds.add(n.remoteId),n.on("data",r=>{this.onData(n,r)}),n.on("open",()=>{this.maybeUnavailablePeerIds.delete(n.remoteId),i&&(i.isOpen=!0),this.updatePeerList(),this.callback.onConnect&&this.callback.onConnect(n.remoteId)}),n.on("close",()=>{this.closeDataConnection(n)}),n.on("error",()=>{this.closeDataConnection(n)}),n.on("stats",()=>{let r=performance.now()-n.timestamp,s=r<=1e4?1:5e3/(r-1e4+5e3),o=s<1?r:n.ping,a=500/(o+500);switch(i.session.health=s,i.session.ping=o,i.session.speed=a*s,n.candidateType){case Ls.HOST:i.session.grade=La.HIGH;break;case Ls.SRFLX:case Ls.PRFLX:i.session.grade=La.MIDDLE;break;case Ls.RELAY:i.session.grade=La.LOW;break;default:i.session.grade=La.UNSPECIFIED}i.session.description=n.candidateType,i.session.health<.2&&this.closeDataConnection(n)})}closeDataConnection(n){n.close();let e=this.connections.indexOf(n);0<=e&&(console.log(n.remoteId+" is \u3048\u3093\u3044\u30fcindex:"+e+" length:"+this.connections.length),this.connections.splice(e,1),this.peerContexts.splice(e,1)),this.relayingPeerIds.delete(n.remoteId),this.relayingPeerIds.forEach(i=>{let r=i.indexOf(n.remoteId);0<=r&&i.splice(r,1)}),console.log("<close()> Peer:"+n.remoteId+" length:"+this.connections.length+":"+this.peerContexts.length),this.updatePeerList(),0<=e&&this.callback.onDisconnect&&this.callback.onDisconnect(n.remoteId)}addDataConnection(n){let e=this.findDataConnection(n.remoteId);if(null!==e){if(console.log("add() is Fail. "+n.remoteId+" is already connecting."),e!==n){if(!(e.metadata.sendFrom<n.metadata.sendFrom))return this.closeDataConnection(e),this.addDataConnection(n),!0;this.closeDataConnection(n)}return!1}return this.connections.push(n),this.peerContexts.push(vi.parse(n.remoteId)),console.log("<add()> Peer:"+n.remoteId+" length:"+this.connections.length),!0}findDataConnection(n){for(let e of this.connections)if(e.remoteId===n)return e;return null}onData(n,e){var i=this;if(e.peers&&0<e.peers.length&&this.onUpdatePeerList(n,e),0<e.ttl&&this.onRelay(n,e),this.callback.onData){let r=e.data.byteLength;this.bandwidthUsage+=r,this.inboundQueue=this.inboundQueue.then(()=>new Promise((s,o)=>{Sr((0,tn.Z)(function*(){let a=e.isCompressed?yield function F9(t,n){return K0.apply(this,arguments)}(e.data):e.data;return i.callback.onData(n.remoteId,bs.decode(a)),i.bandwidthUsage-=r,s()}))}))}}onRelay(n,e){e.ttl--;let i=this.relayingPeerIds.get(n.remoteId);if(null!=i)for(let r of i){let s=this.findDataConnection(r);s&&s.open&&(console.log("<"+r+"> \u8ee2\u9001\u3057\u306a\u304d\u3083\u30fb\u30fb\u30fb"),s.send(e))}}onUpdatePeerList(n,e){let i=[],r=[],s=function H9(t,n){let e=[],i=[],r=!1,s=!1;for(let o of t.concat(n))r=t.includes(o),s=n.includes(o),r&&!s?e.push(o):!r&&s&&i.push(o);return{diff1:e,diff2:i}}(this._peerIds,e.peers);if(i=s.diff1,r=s.diff2,this.relayingPeerIds.set(n.remoteId,i),e.peers=e.peers.concat(i),r.length)for(let o of r)!this.maybeUnavailablePeerIds.has(o)&&this.connect(o)&&console.log("auto connect to unknown Peer <"+o+">")}updatePeerList(){let n=[];for(let e of this.connections)e.open&&n.push(e.remoteId);return n.push(this.peerId),n.sort(function(e,i){return e>i?1:e<i?-1:0}),this._peerIds=n,console.log("<update()>",n),this.notifyPeerList(),n}notifyPeerList(){if(this.connections.length<1)return;let n={data:bs.encode([]),peers:this._peerIds,ttl:1};this.sendBroadcast(n)}getSkyWayErrorMessage(n){switch(n){case"room-error":return"SkyWay Room API \u306b\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002";case"permission":return"\u8a72\u5f53\u306e SkyWay Room \u306e\u5229\u7528\u304c\u8a31\u53ef\u3055\u308c\u3066\u307e\u305b\u3093\u3002";case"list-error":return"SkyWay listAllPeers API \u304c Disabled \u3067\u3059\u3002";case"disconnected":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u306b\u63a5\u7d9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002";case"socket-error":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u3068\u306e\u901a\u4fe1\u3067\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002";case"invalid-id":return"Peer ID \u304c\u4e0d\u6b63\u3067\u3059\u3002";case"unavailable-id":return"\u305d\u306e Peer ID \u3059\u3067\u306b\u4f7f\u7528\u3055\u308c\u3066\u3044\u307e\u3059\u3002";case"peer-unavailable":return"\u305d\u306e Peer ID \u306f\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002";case"invalid-key":return"SkyWay API \u30ad\u30fc\u304c\u7121\u52b9\u3067\u3059\u3002";case"invalid-domain":return"SkyWay API \u30ad\u30fc\u306b\u306f\u73fe\u5728\u306e\u30c9\u30e1\u30a4\u30f3\u306f\u767b\u9332\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002";case"authentication":return"\u8a8d\u8a3c\u30a8\u30e9\u30fc\u3067\u3059\u3002";case"server-error":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u3068\u306e\u63a5\u7d9a\u4e2d\u306b\u554f\u984c\u304c\u3042\u308a\u307e\u3057\u305f\u3002 \u5c11\u3057\u5f85\u3063\u3066\u3001\u30ea\u30c8\u30e9\u30a4\u3057\u3066\u304f\u3060\u3055\u3044\u3002";case"sfu-client-not-supported":return"\u3053\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306f SFU \u306e\u4f7f\u7528\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u6700\u65b0\u306e Google Chrome \u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044";case"peer-unavailable":return"Peer \u3078\u30c7\u30fc\u30bf\u3092\u9001\u4fe1\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002Peer ID \u304c\u6b63\u3057\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002";case"signaling-limited":return"\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u56de\u6570\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u5168\u3066\u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09";case"sfu-limited":return"SFU \u30b5\u30fc\u30d0\u306e\u5229\u7528\u91cf\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001SFU \u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09";case"turn-limited":return"TURN \u30b5\u30fc\u30d0\u306e\u5229\u7528\u91cf\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001TURN \u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09\n\u3053\u306e\u72b6\u614b\u3067\u306f\u3001\u4e00\u90e8\u306e\u30e6\u30fc\u30b6\u306e\u63a5\u7d9a\u306b\u554f\u984c\u304c\u767a\u751f\u3059\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002";case"peer-unavailable":return"\u305d\u306ePeer ID\u306f\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002";default:return"SkyWay\u306b\u95a2\u3059\u308b\u4e0d\u660e\u306a\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002"}}}const nT=vi.parse("???");class Ho{constructor(){this.callback=new EE,this.key="",this.queue=new Set,this.sendInterval=null,this.sendCallback=()=>{this.sendQueue()},this.callbackUnload=n=>{this.close()},console.log("Network ready...")}static get instance(){return Ho._instance||(Ho._instance=new Ho),Ho._instance}get peerId(){return this.connection?this.connection.peerId:nT.peerId}get peerIds(){return this.connection?this.connection.peerIds.concat():[]}get peerContexts(){return this.connection?this.connection.peerContexts.concat():[]}get peerContext(){return this.connection?this.connection.peerContext:nT}get isOpen(){return!(!this.connection||!this.connection.peerContext)&&this.connection.peerContext.isOpen}get bandwidthUsage(){return this.connection?this.connection.bandwidthUsage:0}open(...n){this.connection&&this.connection.peerContext&&(console.warn("It is already opened."),this.close()),console.log("Network open...",n),this.connection=this.initializeConnection(),this.connection.open.apply(this.connection,n),window.addEventListener("unload",this.callbackUnload,!1)}close(){this.connection&&this.connection.close(),this.connection=null,window.removeEventListener("unload",this.callbackUnload,!1),console.log("Network close...")}connect(n){return!!this.connection&&this.connection.connect(n)}disconnect(n){!this.connection||this.connection.disconnect(n)&&(console.log("<disconnectPeer()> Peer:"+n),this.disconnect(n))}send(n,e){this.queue.add({data:n,sendTo:e}),null===this.sendInterval&&(this.sendInterval=Sr(this.sendCallback))}sendQueue(){let n=[],e={},i=[],r=this.queue.size<128?this.queue.size:128;for(let s of this.queue){if(r<=0)break;r--,this.queue.delete(s),null==s.sendTo?n.push(s.data):s.sendTo===this.peerId?i.push(s.data):(s.sendTo in e||(e[s.sendTo]=[]),e[s.sendTo].push(s.data))}if(this.connection){n.length&&this.connection.send(n);for(let s in e)this.connection.send(e[s],s)}this.callback.onData&&(this.callback.onData(null,n),this.callback.onData(this.peerId,i)),this.sendInterval=0<this.queue.size?Sr(this.sendCallback):null}setApiKey(n){this.key!==n&&console.log("Key Change"),this.key=n}listAllPeers(){return this.connection?this.connection.listAllPeers():Promise.resolve([])}initializeConnection(){let n=new j9;return n.setApiKey(this.key),n.callback.onOpen=e=>{this.callback.onOpen&&this.callback.onOpen(e)},n.callback.onClose=e=>{this.callback.onClose&&this.callback.onClose(e)},n.callback.onConnect=e=>{this.callback.onConnect&&this.callback.onConnect(e)},n.callback.onDisconnect=e=>{this.callback.onDisconnect&&this.callback.onDisconnect(e)},n.callback.onData=(e,i)=>{this.callback.onData&&this.callback.onData(e,i)},n.callback.onError=(e,i,r,s)=>{this.callback.onError&&this.callback.onError(e,i,r,s)},0<this.queue.size&&null===this.sendInterval&&(this.sendInterval=Sr(this.sendCallback)),n}}class jp{constructor(n,e,i=Ho.instance.peerId){this.eventName=n,this.data=e,this.sendFrom=i,this.isSendFromSelf=!1,this.isSendFromSelf=this.sendFrom===Ho.instance.peerId}toContext(){return{sendFrom:this.sendFrom,eventName:this.eventName,data:this.data}}}class Z0{constructor(n,e){this._priority=0,this._isRegistered=!1,this._subject=n,this._key=e}get subject(){return this._subject}get key(){return this._key}get eventName(){return this._eventName}get priority(){return this._priority}get callback(){return this._callback}get isOnlyOnce(){return this._isOnlyOnce}get isRegistered(){return this._isRegistered}on(...n){return this._isOnlyOnce=!1,2===n.length?this.register(n[0],0,n[1]):this.register(n[0],n[1],n[2])}once(...n){let e=this.on.apply(this,n);return this._isOnlyOnce=!0,e}register(n,e,i){return this.isRegistered&&this.unregister(),this._eventName=n||"*",this._priority=e,this._callback=i,this.subject.registerListener(this),this._isRegistered=!0,new Z0(this.subject,this.key)}unregister(){return this.subject.unregisterListener(this),this._callback=null,this._isRegistered=!1,this}trigger(n){this.callback&&this.isRegistered&&(this.callback.apply(this.key,[n,this]),this.isOnlyOnce&&this.unregister())}isEqual(n,e,i){return!(null!=n&&n!==this.key||null!=e&&e!==this.eventName||null!=i&&i!==this.callback)}}class Vl{constructor(){this.listenerMap=new Map,console.log("EventSystem ready...")}static get instance(){return Vl._instance||(Vl._instance=new Vl,Vl._instance.initializeNetworkEvent()),Vl._instance}register(n){return new Z0(this,n)}unregister(...n){1===n.length?this._unregister(n[0],null,null):2===n.length?"string"==typeof n[1]?this._unregister(n[0],n[1],null):this._unregister(n[0],null,n[1]):this._unregister(n[0],n[1],n[2])}_unregister(n=this,e,i){let r=this.listenerMap.values();for(let s of r)for(let o of s.concat())o.isEqual(n,e,i)&&o.unregister()}registerListener(n){let e=this.getListeners(n.eventName);return e.push(n),e.sort((i,r)=>r.priority-i.priority),this.listenerMap.set(n.eventName,e),n}unregisterListener(n){let e=this.getListeners(n.eventName),i=e.indexOf(n);return i<0?null:(e.splice(i,1),n.unregister(),e.length<1&&this.listenerMap.delete(n.eventName),n)}call(...n){"string"==typeof n[0]?this._call(new jp(n[0],n[1]),n[2]):this._call(n[0],n[1])}_call(n,e){let i=n.toContext();Ho.instance.send(i,e)}trigger(...n){if(2!==n.length)return this._trigger(n[0]instanceof jp?n[0]:new jp(n[0].eventName,n[0].data,n[0].sendFrom));this._trigger(new jp(n[0],n[1]))}_trigger(n){let e=this.getListeners(n.eventName).concat(this.getListeners("*"));for(let i of e)i.trigger(n);return n}getListeners(n){return this.listenerMap.has(n)?this.listenerMap.get(n):[]}initializeNetworkEvent(){let n=Ho.instance.callback;n.onOpen=e=>{this.trigger("OPEN_NETWORK",{peerId:e})},n.onClose=e=>{this.trigger("CLOSE_NETWORK",{peerId:e})},n.onConnect=e=>{this.sendSystemMessage("<"+e+"> connect <DataConnection>"),this.trigger("CONNECT_PEER",{peerId:e})},n.onDisconnect=e=>{this.sendSystemMessage("<"+e+"> disconnect <DataConnection>"),this.trigger("DISCONNECT_PEER",{peerId:e})},n.onData=(e,i)=>{for(let r of i)this.trigger(r)},n.onError=(e,i,r,s)=>{this.sendSystemMessage("<"+e+"> "+r),this.trigger("NETWORK_ERROR",{peerId:e,errorType:i,errorMessage:r,errorObject:s})}}sendSystemMessage(n){console.log(n)}}const ze=Vl.instance,xt=Ho.instance;class dt{constructor(){this.identifierMap=new Map,this.aliasNameMap=new Map,this.garbageMap=new Map,this.queueMap=new Map,this.updateInterval=null,this.garbageCollectionInterval=null,this.updateCallback=()=>{this.updateQueue()},console.log("ObjectStore ready...")}static get instance(){return dt._instance||(dt._instance=new dt),dt._instance}add(n,e=!0){return null!=this.get(n.identifier)||this.isDeleted(n.identifier)?null:(this.identifierMap.set(n.identifier,n),(this.aliasNameMap.has(n.aliasName)?this.aliasNameMap.get(n.aliasName):this.aliasNameMap.set(n.aliasName,new Map).get(n.aliasName)).set(n.identifier,n),n.onStoreAdded(),e&&this.update(n.toContext()),n)}remove(n){if(!this.identifierMap.has(n.identifier))return null;this.identifierMap.delete(n.identifier);let e=this.aliasNameMap.get(n.aliasName);return e&&e.delete(n.identifier),n.onStoreRemoved(),n}delete(n,e=!0){let i=null,r=null;return"string"==typeof n?(i=this.get(n),r=n):(i=n,r=n.identifier),this.markForDelete(r),null==i?null:this._delete(i,e)}_delete(n,e){return null===this.remove(n)?null:(e&&ze.call("DELETE_GAME_OBJECT",{aliasName:n.aliasName,identifier:n.identifier}),n)}markForDelete(n){this.garbageMap.set(n,performance.now()),this.garbageCollection(6e5)}get(n){return this.identifierMap.has(n)?this.identifierMap.get(n):null}getObjects(n){if(null==n)return Array.from(this.identifierMap.values());let e="";return e="string"==typeof n?n:n.aliasName,this.aliasNameMap.has(e)?Array.from(this.aliasNameMap.get(e).values()):[]}update(n){let e=null;if("string"==typeof n){let i=this.get(n);i&&(e=i.toContext())}else e=n;if(e){if(this.queueMap.has(e.identifier)){let i=this.queueMap.get(e.identifier);for(let r in e)i[r]=e[r];return}ze.call("UPDATE_GAME_OBJECT",e),this.queueMap.set(e.identifier,e),null===this.updateInterval&&(this.updateInterval=Sr(this.updateCallback))}}updateQueue(){this.queueMap.clear(),this.updateInterval=null}isDeleted(n){return null!=this.garbageMap.get(n)}getCatalog(){let n=[];for(let e of this.identifierMap.values())n.push({identifier:e.identifier,version:e.version});return n}clearDeleteHistory(){this.garbageMap.clear()}garbageCollection(n){"number"==typeof n?null===this.garbageCollectionInterval&&(this.garbageCollectionInterval=setTimeout(()=>{this.garbageCollectionInterval=null},1e3),this._garbageCollection(n)):this.garbageMap.delete(n.identifier)}_garbageCollection(n){let e=performance.now(),i=this.garbageMap.size-1e5;if(i<1)return;let r=this.garbageMap.entries();for(;i<1;){i--;let s=r.next();if(s.done)break;let o=s.value[0];s.value[1]+n<e||this.garbageMap.delete(o)}}}var pa,U9=me(383);class Uo{constructor(){this.constructorMap=new Map,this.aliasMap=new Map,console.log("ObjectFactory ready...")}static get instance(){return Uo._instance||(Uo._instance=new Uo),Uo._instance}register(n,e){var i,r,s;e||(e=null!==(i=n.name)&&void 0!==i?i:null!==(s=null===(r=n.toString().match(/function\s*([^(]*)\(/))||void 0===r?void 0:r[1])&&void 0!==s?s:""),this.constructorMap.has(e)?console.error("\u305d\u306e alias<"+e+"> \u306f\u3059\u3067\u306b\u5272\u308a\u5f53\u3066\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f"):this.aliasMap.has(n)?console.error("\u305d\u306e constructor \u306f\u3059\u3067\u306b\u767b\u9332\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f",n):(console.log("addGameObjectFactory -> "+e),this.constructorMap.set(e,n),this.aliasMap.set(n,e))}create(n,e){let i=this.constructorMap.get(n);return i?new i(e):(console.error(n+"\u3068\u3044\u3046\u540d\u306eGameObject\u30af\u30e9\u30b9\u306f\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),null)}getAlias(n){var e;return null!==(e=this.aliasMap.get(n))&&void 0!==e?e:""}}function iT(t){return n=>{Uo.instance.register(n,t)}}function au(){return(t,n)=>{Object.defineProperty(t,n,{get:function e(){return this.context.syncData[n]},set:function i(r){this.context.syncData[n]=r,this.update()},enumerable:!0,configurable:!0})}}!function(t){const n=/&|<|>|"|'/g,e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"},i=/&amp;|&lt;|&gt;|&quot;|&apos;/g,r={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'"},s=/((?:[\0-\x08\x0B\f\x0E-\x1F\uFFFD\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))/g;function X(pe){return e[pe]}function fe(pe){return r[pe]}t.xml2element=function o(pe){let we=new DOMParser,Ie=null;try{pe=function w(pe){return pe.replace(s,"").trim()}(pe),Ie=we.parseFromString(pe,"application/xml"),Ie.getElementsByTagName("parsererror").length&&(console.error("XML\u306e\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3057\u305f",Ie.documentElement),Ie=null)}catch(Pe){console.error(Pe)}return Ie?Ie.documentElement:null},t.encodeEntityReference=function a(pe){return pe.replace(n,X)},t.decodeEntityReference=function h(pe){return pe.replace(i,fe)}}(pa||(pa={}));const G9=Object.getOwnPropertyNames(Object.prototype);Object.getOwnPropertyNames(Array.prototype);class ti{constructor(){console.log("ObjectSerializer ready...")}static get instance(){return ti._instance||(ti._instance=new ti),ti._instance}toXml(n){let e="",i="toAttributes"in n?n.toAttributes():ti.toAttributes(n.toContext().syncData),r=n.aliasName,s="";for(let o in i){let a=pa.encodeEntityReference(i[o]+"");null!=a&&(s+=" "+o+'="'+a+'"')}return e+=`<${r+s}>`,e+="innerXml"in n?n.innerXml():"",e+=`</${r}>`,e}static toAttributes(n){let e={};for(let i in n){let o=ti.make2Attributes(n[i],i);for(let a in o)e[a]=o[a]}return e}static make2Attributes(n,e){let i={};if(Array.isArray(n)){let r=ti.array2attributes(n,e);for(let s in r)i[s]=r[s]}else if("object"==typeof n){let r=ti.object2attributes(n,e);for(let s in r)i[s]=r[s]}else i[e]=n;return i}static object2attributes(n,e){let i={};for(let r in n){let a=ti.make2Attributes(n[r],e+"."+r);for(let h in a)i[h]=a[h]}return i}static array2attributes(n,e){let i={},r=n.length;for(let s=0;s<r;s++){let h=ti.make2Attributes(n[s],e+"."+s);for(let w in h)i[w]=h[w]}return i}parseXml(n){let e=null;if(e="string"==typeof n?pa.xml2element(n):n,!e)return console.error("xmlElement\u304c\u7a7a\u3067\u3059"),null;let i=Uo.instance.create(e.tagName);if(!i)return null;if("parseAttributes"in i)i.parseAttributes(e.attributes);else{let r=i.toContext();ti.parseAttributes(r.syncData,e.attributes),i.apply(r)}return i.initialize(),"parseInnerXml"in i&&i.parseInnerXml(e),i}static parseAttributes(n,e){let i=e.length;for(let r=0;r<i;r++){let s=e[r].value;s=pa.decodeEntityReference(s);let o=e[r].name.split("."),a=o[0],h=n,w=o.find(fe=>G9.includes(fe));null==w?1<o.length&&(({obj:h,key:a}=ti.attributes2object(o,h,a)),null==a)||("string"!=typeof h[a]&&null!=h[a]&&(s=JSON.parse(s)),h[a]=s):console.log(`skip invalid key (${w})`)}return n}static attributes2object(n,e,i){let r=null,s=n.length;for(let o=0;o<s;o++){let a=parseInt(n[o]);if(r&&!Number.isNaN(a)&&!Array.isArray(e)&&Object.keys(r).length&&(r[i]=[],e=r[i]),i=Number.isNaN(a)?n[o]:a,Array.isArray(e)&&"number"!=typeof i)return console.warn("Array\u306b\u306findex\u306e\u633f\u5165\u3057\u304b\u8a31\u53ef\u3057\u306a\u3044"),{obj:e,key:null};o+1<s&&(null==e[i]&&(e[i]="number"==typeof i?[]:{}),r=e,e=e[i])}return{obj:e,key:i}}static parseInnerXml(n){return null}}class Ga{constructor(n=ns.generateUuid()){this.context={aliasName:this.constructor.aliasName,identifier:"",majorVersion:0,minorVersion:0,syncData:{}},this.context.identifier=n}static get aliasName(){return Uo.instance.getAlias(this)}get aliasName(){return this.context.aliasName}get identifier(){return this.context.identifier}get version(){return this.context.majorVersion+this.context.minorVersion}initialize(){dt.instance.add(this)}destroy(){dt.instance.delete(this)}onStoreAdded(){}onStoreRemoved(){}update(){this.versionUp(),dt.instance.update(this.identifier)}versionUp(){this.context.majorVersion+=1,this.context.minorVersion=Math.random()}apply(n){null!==n&&this.identifier===n.identifier&&(this.context.majorVersion=n.majorVersion,this.context.minorVersion=n.minorVersion,this.context.syncData=n.syncData)}clone(){let n=this.toXml();return ti.instance.parseXml(n)}toContext(){return{aliasName:this.context.aliasName,identifier:this.context.identifier,majorVersion:this.context.majorVersion,minorVersion:this.context.minorVersion,syncData:rT(this.context.syncData)}}toXml(){return ti.instance.toXml(this)}}function rT(t){if(null==t)return t;let n=Array.isArray(t)?[]:{},e=Object.getOwnPropertyNames(t);for(let i of e){let r=typeof t[i];null!=t[i]&&"object"===r?n[i]=rT(t[i]):"function"!==r&&(n[i]=t[i])}return n}var Vo;let Vn=Vo=class extends Ga{constructor(){super(...arguments),this.value="",this.attributes={},this.parentIdentifier="",this.majorIndex=0,this.minorIndex=Math.random(),this._children=[],this.needsSort=!0}get index(){return this.majorIndex+this.minorIndex}set index(n){this.majorIndex=0|n,this.minorIndex=n-this.majorIndex,this.parent&&(this.parent.needsSort=!0)}get parent(){return dt.instance.get(this.parentIdentifier)}get parentId(){return this.parentIdentifier}get parentIsAssigned(){return 0<this.parentIdentifier.length}get parentIsUnknown(){return this.parentIsAssigned&&null==dt.instance.get(this.parentIdentifier)}get parentIsDestroyed(){return this.parentIsAssigned&&dt.instance.isDeleted(this.parentIdentifier)}get children(){return this.needsSort&&(this.needsSort=!1,this._children.sort((n,e)=>n.index-e.index)),this._children.concat()}destroy(){super.destroy();for(let n of this._children.concat())n.destroy();this._children=[]}onStoreAdded(){super.onStoreAdded(),this.initializeChildren()}onStoreRemoved(){super.onStoreRemoved(),this.parent&&this.parent.removeChild(this)}onChildAdded(n){}onChildRemoved(n){}_onChildAdded(n){let e=this;for(;e&&(e.onChildAdded(n),e=e.parent,e!==this););}_onChildRemoved(n){let e=this;for(;e&&(e.onChildRemoved(n),e=e.parent,e!==this););}initializeChildren(){if(null==Vo.unknownNodes[this.identifier])return;let n=Vo.unknownNodes[this.identifier];for(let e of n)e.parent===this&&this.updateChildren(e);Vo.unknownNodes[this.identifier]&&delete Vo.unknownNodes[this.identifier]}updateChildren(n=this){let e=this._children.indexOf(n),i=!1,r=n.parent===this;if(e<0&&r)this._children.push(n),e=this._children.length-1,i=!0;else{if(0<=e&&!r)return this._children.splice(e,1),void this._onChildRemoved(n);if(e<0&&!r)return}let s=this._children.length;s&&((this._children[e-1<0?0:e-1].index>n.index||n.index>this._children[s-1<e+1?s-1:e+1].index)&&(this.needsSort=!0),i&&this._onChildAdded(n))}updateIndexs(){let n=this.children;for(let e=0;e<n.length;e++)n[e].majorIndex=e,n[e].minorIndex=Math.random()}appendChild(n){if(n.contains(this))return null;n.parent&&n.parent!==this&&n.parent.removeChild(n);let e=0<this.children.length?this.children[this.children.length-1].majorIndex+1:0;return n.parentIdentifier=this.identifier,n.majorIndex=e,n.minorIndex=Math.random(),this.updateChildren(n),n}insertBefore(n,e){if(n.contains(this))return null;if(n===e&&n.parent===this)return n;n.parent&&n.parent!==this&&n.parent.removeChild(n);let i=this.children.indexOf(e);if(i<0)return this.appendChild(n);n.parentIdentifier=this.identifier;let r=0<i?this.children[i-1].index:0,s=e.index-r,o=r+s*(.45+.1*Math.random());return n.majorIndex=0|o,n.minorIndex=o-n.majorIndex,this.updateChildren(n),s<1e-7&&this.updateIndexs(),n}removeChild(n){return this.children.indexOf(n)<0?null:(n.parentIdentifier="",n.majorIndex=0,n.minorIndex=Math.random(),this.updateChildren(n),n)}contains(n){let e=n.parent;for(;e;){if(e===n)return console.error("\u3042 \u3084\u3063\u3079\u3001\u5faa\u74b0\u53c2\u7167",n),!1;if(e===this)return!0;e=e.parent}return!1}setAttribute(n,e){this.attributes[n]=e,this.update()}getAttribute(n){return null==this.attributes[n]?"":this.attributes[n]}removeAttribute(n){delete this.attributes[n],this.update()}toAttributes(){return ti.toAttributes(this.attributes)}parseAttributes(n){ti.parseAttributes(this.attributes,n)}innerXml(){let n="";n+=pa.encodeEntityReference(this.value+"");for(let e of this.children)n+=ti.instance.toXml(e);return n}parseInnerXml(n){let e=n.children,i=e.length;if(0<i)for(let r=0;r<i;r++){let s=ti.instance.parseXml(e[r]);s instanceof Vo&&this.appendChild(s)}else this.value=pa.decodeEntityReference(n.innerHTML)}apply(n){let e=this.parent;super.apply(n),e&&this.parent!==e&&e.updateChildren(this),this.parent?this.parent.updateChildren(this):this.parentIsAssigned&&(this.parentIdentifier in Vo.unknownNodes||(Vo.unknownNodes[this.parentIdentifier]=[]),Vo.unknownNodes[this.parentIdentifier].push(this))}};function ni(t){return n=>{iT(t)(n)}}function at(){return(t,n)=>{t instanceof Vn?function V9(){return(t,n)=>{Object.defineProperty(t,n,{get:function e(){return this.getAttribute(n)},set:function i(r){this.setAttribute(n,r)},enumerable:!0,configurable:!0})}}()(t,n):au()(t,n)}}Vn.unknownNodes={},$e([au()],Vn.prototype,"value",void 0),$e([au()],Vn.prototype,"attributes",void 0),$e([au()],Vn.prototype,"parentIdentifier",void 0),$e([au()],Vn.prototype,"majorIndex",void 0),$e([au()],Vn.prototype,"minorIndex",void 0),Vn=Vo=$e([iT("node")],Vn);class sT{constructor(n="Queue"){this.name=n,this.queue=Promise.resolve(),this._length=0}get length(){return this._length}add(n){this._length++,console.log(`${this.name} add: ${this._length}`),this.queue=this.queue.then("function"==typeof n.then?()=>n:0<n.length?()=>new Promise(n):n);let e=this.queue;return this.queue=this.queue.catch(i=>{console.error(i)}),this.queue=this.queue.then(()=>{this._length--,console.log(`${this.name} done: ${this._length}`)}),e}}var rt,ii;!function(t){const n=new RegExp(["\ud83c[\udf00-\udfff]","\ud83d[\udc00-\ude4f]","\ud83d[\ude80-\udeff]","\ud7c9[\ude00-\udeff]","[\u2600-\u27bf]"].join("|"));t.toHalfWidth=function e(pe){return pe.replace(/[\uff01-\uff5e]/g,we=>String.fromCharCode(we.charCodeAt(0)-65248))},t.isEmote=function i(pe){return!!pe&&(pe=this.cr(pe).replace(/[\s\r\n]/g,""),Array.from(pe).length<=3&&!/[\u300c\u300d]/.test(pe)&&(n.test(pe)||/[$\uff04\\\uffe5\uff01\uff1f\u2755\u2762\u203d\u203c/!/?\u2665\u266a\u266c\u2669\u266b\u263a\ud83e\udd2e\u2764\ufe0f\u2620\ufe0f]/.test(pe)))},t.cr=function r(pe){if(!pe)return"";let we="",Ie="";return[...pe].forEach(Pe=>{if(Ie){switch(Pe){case"n":case"\uff4e":we+="\n";break;case"\\":case"\uffe5":we+=Pe;break;default:we+=Ie+Pe}Ie=""}else"\\"==Pe||"\uffe5"==Pe?Ie=Pe:we+=Pe}),we},t.validUrl=function s(pe){if(!pe)return!1;try{new URL(pe.trim())}catch(we){return!1}return/^https?\:\/\//.test(pe.trim())},t.sameOrigin=function o(pe){if(!pe)return!1;try{return new URL(pe).origin===window.location.origin}catch(we){return!1}},t.escapeHtml=function a(pe){return"string"!=typeof pe&&(pe=pe.toString()),pe.replace(/[&'`"<>]/g,function(we){return{"&":"&amp;","'":"&#x27;","`":"&#x60;",'"':"&quot;","<":"&lt;",">":"&gt;"}[we]})},t.rubyToHtml=function h(pe){return"string"!=typeof pe&&(pe=pe.toString()),pe.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g,"<ruby>$1<rp>(</rp><rt>$2</rt><rp>)</rp></ruby>")},t.rubyToText=function w(pe){return"string"!=typeof pe&&(pe=pe.toString()),pe.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g,"$1($2)")},t.aliasNameToClassName=function X(pe){switch(pe){case"character":return"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc";case"cut-in":return"\u30ab\u30c3\u30c8\u30a4\u30f3";case"dice-roll-table":return"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868";case"terrain":return"\u5730\u5f62";case"table-mask":return"\u30de\u30c3\u30d7\u30de\u30b9\u30af";case"text-note":return"\u5171\u6709\u30e1\u30e2";case"card":return"\u30ab\u30fc\u30c9";case"dice-symbol":return"\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb";case"card-stack":return"\u5c71\u672d";case"game-table":return"\u30c6\u30fc\u30d6\u30eb";case"chat-tab":return"\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6";case"range":return"\u5c04\u7a0b\u30fb\u7bc4\u56f2";default:return pe}},t.textShadowColor=function fe(pe,we="#ffffff",Ie="#333333"){return pe&&/^\#[0-9a-f]{6}$/i.test(pe)&&pe.substring(1,7).match(/.{2}/g).reduce((Pe,Be)=>Pe+parseInt(Be,16),0)>510?Ie:we}}(rt||(rt={}));class Nt{constructor(){this.imageHash={},console.log("ImageStorage ready...")}static get instance(){return Nt._instance||(Nt._instance=new Nt),Nt._instance}get images(){let n=[];for(let e in this.imageHash)n.push(this.imageHash[e]);return n}destroy(){for(let n in this.imageHash)this.delete(n)}addAsync(n){var e=this;return(0,tn.Z)(function*(){let i=yield Ut.createAsync(n);return e._add(i)})()}add(n){let e;if("string"==typeof n)e=Ut.create(n);else if(n instanceof Ut)e=n;else{if(this.update(n))return this.imageHash[n.identifier];e=Ut.create(n)}return this._add(e)}_add(n){return Ui.COMPLETE<=n.state&&this.lazySynchronize(100),this.update(n)?this.imageHash[n.identifier]:(this.imageHash[n.identifier]=n,console.log("add Image: "+n.identifier),n)}update(n){let e;e=n instanceof Ut?n.toContext():n;let i=this.imageHash[n.identifier];return!!i&&(i.apply(n),!0)}delete(n){let e=this.imageHash[n];return!!e&&(e.destroy(),delete this.imageHash[n],!0)}get(n){return this.imageHash[n]||null}synchronize(n){this.lazyTimer&&this.lazyTimer.stop(),ze.call("SYNCHRONIZE_FILE_LIST",this.getCatalog(),n)}lazySynchronize(n,e){null==this.lazyTimer&&(this.lazyTimer=new ha(()=>this.synchronize(e),n)),this.lazyTimer.reset(n)}getCatalog(){let n=[];for(let e of this.images)Ui.COMPLETE<=e.state&&n.push({identifier:e.identifier,state:e.state});return n}}let We=ii=class extends Ga{constructor(){super(...arguments),this.userId="",this.peerId="",this.name="",this.imageIdentifier="",this.color=ii.CHAT_DEFAULT_COLOR,this.isGMMode=!1}get isMine(){return ii.myCursor&&ii.myCursor===this}get image(){return Nt.instance.get(this.imageIdentifier)}onStoreAdded(){super.onStoreAdded(),this.isMine||ze.register(this).on("DISCONNECT_PEER",n=>{n.data.peerId===this.peerId&&setTimeout(()=>{xt.peerIds.includes(this.peerId)||(ii.userIdMap.delete(this.userId),ii.peerIdMap.delete(this.peerId),dt.instance.remove(this))},3e4)})}onStoreRemoved(){super.onStoreRemoved(),ze.unregister(this),ii.userIdMap.delete(this.userId),ii.peerIdMap.delete(this.peerId)}static findByUserId(n){return this.find(ii.userIdMap,n,!0)}static findByPeerId(n){return this.find(ii.peerIdMap,n,!1)}static find(n,e,i){let r=n.get(e);if(null!=r&&dt.instance.get(r))return dt.instance.get(r);let s=dt.instance.getObjects(ii);for(let o of s){let a=i?o.userId:o.peerId;if(a===e)return n.set(a,o.identifier),o}return null}static createMyCursor(){return ii.myCursor?(console.warn("It is already created."),ii.myCursor):(ii.myCursor=new ii,ii.myCursor.peerId=xt.peerId,ii.myCursor.initialize(),window.localStorage&&localStorage.getItem(ii.CHAT_MY_NAME_LOCAL_STORAGE_KEY)&&(ii.myCursor.name=localStorage.getItem(ii.CHAT_MY_NAME_LOCAL_STORAGE_KEY)),window.localStorage&&localStorage.getItem(ii.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)&&(ii.myCursor.color=localStorage.getItem(ii.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)),ii.myCursor)}apply(n){let e=n.syncData.userId,i=n.syncData.peerId;e!==this.userId&&(ii.userIdMap.set(e,this.identifier),ii.userIdMap.delete(this.userId)),i!==this.peerId&&(ii.peerIdMap.set(i,this.identifier),ii.peerIdMap.delete(this.peerId)),super.apply(n)}isPeerAUdon(){return null!=/u.*d.*o.*n/gi.exec(this.peerId)}};We.isGMHold=!1,We.CHAT_MY_NAME_LOCAL_STORAGE_KEY="udonanaumu-chat-my-name-local-storage",We.CHAT_MY_COLOR_LOCAL_STORAGE_KEY="udonanaumu-chat-my-color-local-storage",We.CHAT_DEFAULT_COLOR="#444444",We.CHAT_TRANSPARENT_COLOR="#ffffff",We.myCursor=null,We.userIdMap=new Map,We.peerIdMap=new Map,$e([at()],We.prototype,"userId",void 0),$e([at()],We.prototype,"peerId",void 0),$e([at()],We.prototype,"name",void 0),$e([at()],We.prototype,"imageIdentifier",void 0),$e([at()],We.prototype,"color",void 0),$e([at()],We.prototype,"isGMMode",void 0),We=ii=$e([ni("PeerCursor")],We);let lu=class extends Vn{constructor(){super(...arguments),this.dicebot="",this.paletteColor="",this._palettes=[],this._paletteLines=[],this._paletteVariables=[],this.isAnalized=!1}get color(){return this.paletteColor&&"#ffffff"!=this.paletteColor?this.paletteColor:window.localStorage&&localStorage.getItem(We.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)&&"#ffffff"!=localStorage.getItem(We.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)?localStorage.getItem(We.CHAT_MY_COLOR_LOCAL_STORAGE_KEY):We.CHAT_DEFAULT_COLOR}set color(n){this.paletteColor=n}get paletteLines(){return this.isAnalized||this.parse(this.value),this._paletteLines}get paletteVariables(){return this.isAnalized||this.parse(this.value),this._paletteVariables}getPalette(){return this.isAnalized||this.parse(this.value),this._palettes}setPalette(n){this.value=n,this.isAnalized=!1}evaluate(n,e){let i="";i="string"==typeof n?n:n.palette,console.log(i);let s=0,o=!0;for(;o;)s++,o=!1,i=i.replace(/[{\uff5b]\s*([^{}\uff5b\uff5d]+)\s*[}\uff5d]/g,(a,h)=>{o=!0;let w="";for(let X of this.paletteVariables)X.name==h&&(w=X.value);if(e){let X=e.getFirstElementByNameUnsensitive(h);return X?(w=X.isNumberResource?X.currentValue:X.isCheckProperty?(X.currentValue+"").split(/[|\uff5c]/g)[X.value?0:1]:X.isAbilityScore?X.calcAbilityScore():X.value,null==w&&(w="")):((X=e.getFirstElementByNameUnsensitive(h.replace(/^\u6700\u5927/,""))||e.getFirstElementByNameUnsensitive(h.replace(/^Max[\:\_\-\s]?/i,""))||e.getFirstElementByNameUnsensitive(h.replace(/^\u57fa\u672c/,""))||e.getFirstElementByNameUnsensitive(h.replace(/^\u521d\u671f/,""))||e.getFirstElementByNameUnsensitive(h.replace(/^\u539f/,""))||e.getFirstElementByNameUnsensitive(h.replace(/\u57fa\u672c\u5024$/,""))||e.getFirstElementByNameUnsensitive(h.replace(/\u521d\u671f\u5024$/,""))||e.getFirstElementByNameUnsensitive(h.replace(/\u539f\u70b9$/,"")))&&(X.isNumberResource||X.isAbilityScore)&&(w=X.value),(X=e.getFirstElementByNameUnsensitive(h.replace(/\u4fee\u6b63\u5024?$/,""))||e.getFirstElementByNameUnsensitive(h.replace(/\s*Mod(ifier|\.)?$/i,""))||e.getFirstElementByNameUnsensitive(h.replace(/\u30dc\u30fc\u30ca\u30b9$/,"")))&&X.isAbilityScore&&(w=X.calcAbilityScore())),w+""}return""}),128<s&&(o=!1);return i}parse(n){this._palettes=n.split("\n"),this._paletteLines=[],this._paletteVariables=[];for(let e of this._palettes){let i=this.parseVariable(e);i?this._paletteVariables.push(i):this._paletteLines.push({palette:e})}this.isAnalized=!0}parseVariable(n){let e=/^\s*[/\uff0f]{2}([^=\uff1d{}\uff5b\uff5d\s]+)\s*[=\uff1d]\s*(.+)\s*/gi.exec(n);return e?{name:rt.toHalfWidth(e[1]),value:e[2]}:null}apply(n){super.apply(n),this.isAnalized=!1}};var qa;$e([at()],lu.prototype,"dicebot",void 0),$e([at()],lu.prototype,"paletteColor",void 0),lu=$e([ni("chat-palette")],lu);let _t=qa=class extends Vn{get isSimpleNumber(){return null!=this.type&&"simpleNumber"===this.type}get isNumberResource(){return null!=this.type&&"numberResource"===this.type}get isCheckProperty(){return null!=this.type&&"checkProperty"===this.type}get isNote(){return null!=this.type&&"note"===this.type}get isAbilityScore(){return null!=this.type&&"abilityScore"===this.type}get isUrl(){return null!=this.type&&"url"===this.type}static create(n,e="",i={},r=""){let s;return s=r&&0<r.length?new qa(r):new qa,s.attributes=i,s.name=n,s.value=e,s.initialize(),s}getElementsByName(n){let e=[];for(let i of this.children)i instanceof qa&&(i.getAttribute("name")===n&&e.push(i),Array.prototype.push.apply(e,i.getElementsByName(n)));return e}getElementsByType(n){let e=[];for(let i of this.children)i instanceof qa&&(i.getAttribute("type")===n&&e.push(i),Array.prototype.push.apply(e,i.getElementsByType(n)));return e}getFirstElementByName(n){for(let e of this.children)if(e instanceof qa){if(e.getAttribute("name")===n)return e;let i=e.getFirstElementByName(n);if(i)return i}return null}getFirstElementByNameUnsensitive(n){for(let e of this.children)if(e instanceof qa){if(rt.toHalfWidth(e.getAttribute("name").replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).toLowerCase()===rt.toHalfWidth(n.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).toLowerCase())return e;let i=e.getFirstElementByNameUnsensitive(n);if(i)return i}return null}calcAbilityScore(){if(!this.isAbilityScore||!this.value)return 0;let n;return(n=this.currentValue.toString().match(/^div(\d+)$/))?Math.floor(+this.value/+n[1]):(n=this.currentValue.toString().match(/^DnD/))?Math.floor((+this.value-10)/2):+this.value}};$e([at()],_t.prototype,"name",void 0),$e([at()],_t.prototype,"type",void 0),$e([at()],_t.prototype,"currentValue",void 0),_t=qa=$e([ni("data")],_t);let Ci=class extends Vn{constructor(){super(...arguments),this.location={name:"table",x:0,y:0},this.posZ=0,this._imageFile=Ut.Empty,this._shadowImageFile=Ut.Empty,this._dataElements={},this.currntImageIndex=0,this.isUseIconToOverviewImage=!1,this.currntIconIndex=0,this.isAltitudeIndicate=!1,this.isInverse=!1,this.isHollow=!1,this.isBlackPaint=!1,this.aura=-1,this.isNotRide=!0,this.isInventoryIndicate=!0}get isVisibleOnTable(){return"table"===this.location.name}get rootDataElement(){for(let n of this.children)if(n.getAttribute("name")===this.aliasName)return n;return null}get imageDataElement(){return this.getElement("image")}get commonDataElement(){return this.getElement("common")}get detailDataElement(){return this.getElement("detail")}get imageElement(){if(!this.imageDataElement)return null;let n=this.imageDataElement.getElementsByName("imageIdentifier");return n[this.currntImageIndex<0?0:this.currntImageIndex>=n.length?n.length-1:this.currntImageIndex]}get imageFile(){if(!this.imageDataElement)return this._imageFile;let n=this.imageElement;if(n&&this._imageFile.identifier!==n.value){let e=Nt.instance.get(n.value);this._imageFile=e||Ut.Empty}return this._imageFile}get imageFiles(){return this.imageDataElement?this.imageDataElement.getElementsByName("imageIdentifier").map(e=>Nt.instance.get(e.value)||null).filter(e=>null!=e):[]}get faceIcon(){if(!this.imageDataElement)return null;let n=this.imageDataElement.getElementsByName("faceIcon");if(n){let e=n[this.currntIconIndex];return this.currntIconIndex<0&&(this.currntIconIndex=0),e?Nt.instance.get(e.value):null}return null}get faceIcons(){return this.imageDataElement?this.imageDataElement.getElementsByName("faceIcon").map(e=>Nt.instance.get(e.value)||null).filter(e=>null!=e):[]}get shadowImageFile(){if(!this.imageDataElement)return this._shadowImageFile;let n=this.imageDataElement.getFirstElementByName("shadowImageIdentifier");if(n&&this._shadowImageFile.identifier!==n.value){let e=Nt.instance.get(n.value);this._shadowImageFile=e||Ut.Empty}else{let e=this.imageElement;if(e&&this._shadowImageFile.identifier!==e.currentValue){let i=Nt.instance.get(e.currentValue);this._shadowImageFile=i||Ut.Empty}}return this._shadowImageFile}get altitude(){let n=this.getElement("altitude",this.commonDataElement);!n&&this.commonDataElement&&this.commonDataElement.appendChild(_t.create("altitude",0,{},"altitude_"+this.identifier));let e=n?+n.value:0;return Number.isNaN(e)?0:e}set altitude(n){let e=this.getElement("altitude",this.commonDataElement);e&&(e.value=n)}get isGMMode(){return!!We.myCursor&&We.myCursor.isGMMode}createDataElements(){this.initialize();let n=this.aliasName;if(!this.rootDataElement){let e=_t.create(n,"",{},n+"_"+this.identifier);this.appendChild(e)}this.imageDataElement||(this.rootDataElement.appendChild(_t.create("image","",{},"image_"+this.identifier)),this.imageDataElement.appendChild(_t.create("imageIdentifier","",{type:"image"},"imageIdentifier_"+this.identifier))),this.commonDataElement||this.rootDataElement.appendChild(_t.create("common","",{},"common_"+this.identifier)),this.detailDataElement||this.rootDataElement.appendChild(_t.create("detail","",{},"detail_"+this.identifier))}getElement(n,e=this.rootDataElement){if(!e)return null;let i=this._dataElements[n]?dt.instance.get(this._dataElements[n]):null;return(!i||!e.contains(i))&&(i=e.getFirstElementByName(n),this._dataElements[n]=i?i.identifier:null),i}getCommonValue(n,e){let i=this.getElement(n,this.commonDataElement);if(!i)return e;if("number"==typeof e){let r=+i.value;return Number.isNaN(r)?e:r}return i.value+""}getUrls(){return this.rootDataElement.getElementsByType("url")}setCommonValue(n,e){let i=this.getElement(n,this.commonDataElement);!i||(i.value=e)}getImageFile(n){if(!this.imageDataElement)return null;let e=this.getElement(n,this.imageDataElement);return e?Nt.instance.get(e.value):null}setImageFile(n,e){let i=e?this.getElement(n,this.imageDataElement):null;!i||(i.value=e.identifier)}setLocation(n){this.location.name=n,this.update()}};$e([at()],Ci.prototype,"location",void 0),$e([at()],Ci.prototype,"posZ",void 0),$e([at()],Ci.prototype,"currntImageIndex",void 0),$e([at()],Ci.prototype,"isUseIconToOverviewImage",void 0),$e([at()],Ci.prototype,"currntIconIndex",void 0),$e([at()],Ci.prototype,"isAltitudeIndicate",void 0),$e([at()],Ci.prototype,"isInverse",void 0),$e([at()],Ci.prototype,"isHollow",void 0),$e([at()],Ci.prototype,"isBlackPaint",void 0),$e([at()],Ci.prototype,"aura",void 0),$e([at()],Ci.prototype,"isNotRide",void 0),$e([at()],Ci.prototype,"isInventoryIndicate",void 0),Ci=$e([ni("TabletopObject")],Ci);var Mi=(()=>(function(t){t[t.Default=1]="Default",t[t.Image=2]="Image",t[t.Postfix=3]="Postfix",t[t.PostfixOrImage=4]="PostfixOrImage",t[t.PostfixAndImage=5]="PostfixAndImage",t[t.NotConditionStandUp=6]="NotConditionStandUp"}(Mi||(Mi={})),Mi))();let Wa=class extends _t{constructor(){super(...arguments),this.position=5,this.height=35,this.overviewIndex=-1}get standElements(){return this.getElementsByName("stand")}add(n){let e=this.getFirstElementByName("stand")?Mi.NotConditionStandUp:Mi.Default,i=_t.create("stand");i.appendChild(_t.create("name","",{},"name_"+i.identifier)),i.appendChild(_t.create("imageIdentifier",n&&n!=Ut.Empty.identifier?n:"stand_no_image",{type:"image"},"imageIdentifier_"+i.identifier)),i.appendChild(_t.create("conditionType",e,{},"conditionType_"+i.identifier)),i.appendChild(_t.create("height",0,{currentValue:0},"height_"+i.identifier)),i.appendChild(_t.create("applyImageEffect","",{},"applyImageEffect_"+i.identifier)),i.appendChild(_t.create("applyRoll","",{},"applyRoll_"+i.identifier)),i.appendChild(_t.create("applyDialog","applyDialog",{},"applyDialog_"+i.identifier)),i.appendChild(_t.create("showName","showName",{},"showName_"+i.identifier)),i.appendChild(_t.create("postfix","",{},"postfix_"+i.identifier)),i.appendChild(_t.create("position",0,{currentValue:""},"position_"+i.identifier)),i.appendChild(_t.create("speakingImageIdentifier","",{type:"image"},"speakingImageIdentifier_"+i.identifier)),this.appendChild(i)}remove(n){this.removeChild(n)}matchStandInfo(n,e,i=null){const r=e instanceof Ut?e.identifier:e;let s="",o=!1,a=[];["\uff20\u9000\u53bb","@farewell"].forEach(we=>{rt.toHalfWidth(n).trimRight().toUpperCase().endsWith(rt.toHalfWidth(we).toUpperCase())&&(("@"==we.slice(0,1)||"\uff20"==we.slice(0,1))&&s.length<we.length&&(s=we),o=!0)});for(const we of this.standElements){const Ie=we.getFirstElementByName("name");Ie&&Ie.value.toString()==i&&a.push(we)}let h=1,w=!0,X=[],fe=[];for(const we of this.standElements){if(!we.getFirstElementByName("imageIdentifier")||!we.getFirstElementByName("conditionType"))continue;const Ie=we.getFirstElementByName("conditionType").value;if(Ie!=Mi.NotConditionStandUp)if(Ie==Mi.Default)X.push(we);else{const Pe=we.getFirstElementByName("postfix")?we.getFirstElementByName("postfix").value.toString():null,Be=we.getFirstElementByName("targetImageIdentifier")?we.getElementsByName("targetImageIdentifier").map(Ve=>Ve.value):[];let Le=!1,Fe=!1;if(Pe&&(Ie==Mi.Postfix||Ie==Mi.PostfixOrImage||Ie==Mi.PostfixAndImage))for(let Ve of Pe.split(/[\r\n]+/g))null==Ve||0==Ve.trim().length||rt.toHalfWidth(n).toUpperCase().trimRight().endsWith(rt.toHalfWidth(Ve).trimRight().toUpperCase())&&(("@"==Ve.slice(0,1)||"\uff20"==Ve.slice(0,1))&&s.length<Ve.length&&(s=Ve),Le=!0);Be.length>0&&(Ie==Mi.Image||Ie==Mi.PostfixOrImage||Ie==Mi.PostfixAndImage)&&(Fe=r&&Be.indexOf(r)>=0),(Le&&(Ie==Mi.Postfix||Ie==Mi.PostfixOrImage)||Fe&&(Ie==Mi.Image||Ie==Mi.PostfixOrImage)||Le&&Fe&&Ie==Mi.PostfixAndImage)&&(w=!1,fe.push(we),h<+Ie&&(h=+Ie))}}i||(a=w?X:fe.filter(we=>+we.getFirstElementByName("conditionType").value==h));let pe={standElementIdentifier:null,matchMostLongText:s,farewell:o};return a&&a.length>0&&(pe.standElementIdentifier=a[Math.floor(Math.random()*a.length)].identifier),pe}};var Hp;$e([at()],Wa.prototype,"position",void 0),$e([at()],Wa.prototype,"height",void 0),$e([at()],Wa.prototype,"overviewIndex",void 0),Wa=$e([ni("stand-list")],Wa);let Gt=Hp=class extends Ci{constructor(n=ns.generateUuid()){super(n),this.rotate=0,this.roll=0,this.isDropShadow=!0,this.isShowChatBubble=!0,this.owner="",this.text="",this.isEmote=!1,this.isLoaded=!1,this.chatBubbleAltitude=0,this.isAltitudeIndicate=!0}get name(){return this.getCommonValue("name","")}set name(n){this.setCommonValue("name",n)}get size(){return this.getCommonValue("size",1)}get height(){let n=this.getElement("height",this.commonDataElement);!n&&this.commonDataElement&&this.commonDataElement.insertBefore(_t.create("height",0,{currentValue:""},"height_"+this.identifier),this.getElement("altitude",this.commonDataElement));let e=n?+n.value:0;return n&&n.currentValue&&(e=(Number.isNaN(e)?0:e)*this.size),Number.isNaN(e)?0:e}get chatPalette(){for(let n of this.children)if(n instanceof lu)return n;return null}get ownerName(){let n=We.findByUserId(this.owner);return n?n.name:null}get ownerColor(){let n=We.findByUserId(this.owner);return n?n.color:"#444444"}get standList(){for(let e of this.children)if(e instanceof Wa)return e;let n=new Wa("StandList_"+this.identifier);return n.initialize(),this.appendChild(n),n}static create(n,e,i){let r=new Hp;return r.createDataElements(),r.initialize(),r.createTestGameDataElement(n,e,i),r}get isHideIn(){return!!this.owner}get isVisible(){return!this.owner||xt.peerContext.userId===this.owner}static get isStealthMode(){for(const n of dt.instance.getObjects(Hp))if(n.isHideIn&&n.isVisible&&"table"===n.location.name)return!0;return!1}createTestGameDataElement(n,e,i){this.createDataElements();let r=_t.create("name",n,{},"name_"+this.identifier),s=_t.create("size",e,{},"size_"+this.identifier),o=_t.create("height",0,{currentValue:""},"height_"+this.identifier),a=_t.create("altitude",0,{},"altitude_"+this.identifier);this.imageDataElement.getFirstElementByName("imageIdentifier")&&(this.imageDataElement.getFirstElementByName("imageIdentifier").value=i);let h=_t.create("\u30ea\u30bd\u30fc\u30b9","",{},"\u30ea\u30bd\u30fc\u30b9"+this.identifier),w=_t.create("HP",200,{type:"numberResource",currentValue:"200"},"HP_"+this.identifier),X=_t.create("MP",100,{type:"numberResource",currentValue:"100"},"MP_"+this.identifier);this.commonDataElement.appendChild(r),this.commonDataElement.appendChild(s),this.commonDataElement.appendChild(o),this.commonDataElement.appendChild(a),this.detailDataElement.appendChild(h),h.appendChild(w),h.appendChild(X);let fe=_t.create("\u60c5\u5831","",{},"\u60c5\u5831"+this.identifier);this.detailDataElement.appendChild(fe),fe.appendChild(_t.create("\u8aac\u660e","\u3053\u3053\u306b\u8aac\u660e\u3092\u66f8\u304f\n\u3042\u3044\u3046\u3048\u304a",{type:"note"},"\u8aac\u660e"+this.identifier)),fe.appendChild(_t.create("\u30e1\u30e2","\u4efb\u610f\u306e\u6587\u5b57\u5217\n\uff11\n\uff12\n\uff13\n\uff14\n\uff15",{type:"note"},"\u30e1\u30e2"+this.identifier)),fe.appendChild(_t.create("\u53c2\u7167URL","https://www.example.com",{type:"url"},"\u53c2\u7167URL"+this.identifier)),fe=_t.create("\u80fd\u529b","",{},"\u80fd\u529b"+this.identifier),this.detailDataElement.appendChild(fe),fe.appendChild(_t.create("\u5668\u7528\u5ea6",24,{type:"abilityScore",currentValue:"div6"},"\u5668\u7528\u5ea6"+this.identifier)),fe.appendChild(_t.create("\u654f\u6377\u5ea6",24,{type:"abilityScore",currentValue:"div6"},"\u654f\u6377\u5ea6"+this.identifier)),fe.appendChild(_t.create("\u7b4b\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u7b4b\u529b"+this.identifier)),fe.appendChild(_t.create("\u751f\u547d\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u751f\u547d\u529b"+this.identifier)),fe.appendChild(_t.create("\u77e5\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u77e5\u529b"+this.identifier)),fe.appendChild(_t.create("\u7cbe\u795e\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u7cbe\u795e\u529b"+this.identifier)),fe=_t.create("\u6226\u95d8\u7279\u6280","",{},"\u6226\u95d8\u7279\u6280"+this.identifier),this.detailDataElement.appendChild(fe),fe.appendChild(_t.create("Lv1","\u5168\u529b\u653b\u6483",{},"Lv1"+this.identifier)),fe.appendChild(_t.create("Lv3","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9",{},"Lv3"+this.identifier)),fe.appendChild(_t.create("Lv5","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9\u2161",{},"Lv5"+this.identifier)),fe.appendChild(_t.create("Lv7","\u9811\u5f37",{},"Lv7"+this.identifier)),fe.appendChild(_t.create("Lv9","\u8599\u304e\u6255\u3044",{},"Lv9"+this.identifier)),fe.appendChild(_t.create("\u81ea\u52d5","\u6cbb\u7652\u9069\u6b63",{},"\u81ea\u52d5"+this.identifier)),(new DOMParser).parseFromString(this.rootDataElement.toXml(),"application/xml");let Ie=new lu("ChatPalette_"+this.identifier);Ie.setPalette("\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u5165\u529b\u4f8b\uff1a\n2d6+1 \u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\n\uff11\uff44\uff12\uff10\uff0b{\u654f\u6377}\uff0b\uff5b\u683c\u95d8\uff5d\u3000{name}\u306e\u683c\u95d8\uff01\n//\u654f\u6377=10+{\u654f\u6377A}\n//\u654f\u6377A=10\n//\u683c\u95d8\uff1d\uff11"),Ie.initialize(),this.appendChild(Ie);let Pe=new Wa("StandList_"+this.identifier);Pe.initialize(),this.appendChild(Pe)}};$e([at()],Gt.prototype,"rotate",void 0),$e([at()],Gt.prototype,"roll",void 0),$e([at()],Gt.prototype,"isDropShadow",void 0),$e([at()],Gt.prototype,"isShowChatBubble",void 0),$e([at()],Gt.prototype,"owner",void 0),Gt=Hp=$e([ni("character")],Gt);let ga=class extends Vn{constructor(){super(...arguments),this.name="",this.command="",this.dice=""}parseText(){return this.value?this.value.split(/[\r\n]+/).map(n=>{let e=null;if(e=(n=n.trim()).match(/([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[\-\u2015\uff0d~\uff5e][\s\u3000]*([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[:\uff1a](.+)/)){const i=+rt.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-")),r=+rt.toHalfWidth(e[2].replace(/[\-\uff0d\u2010]/,"-"));return i<=r?{range:{start:i,end:r},result:e[3]}:{range:{start:r,end:i},result:e[3]}}if(e=n.match(/([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[\-\u2015\uff0d~\uff5e][\s\u3000]*[\*\uff0a][\s\u3000]*[:\uff1a](.+)/))return{range:{start:+rt.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-")),end:null},result:e[2]};if(e=n.match(/[\*\uff0a][\s\u3000]*[\-\u2015\uff0d~\uff5e][\s\u3000]*([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[:\uff1a](.+)/))return{range:{start:null,end:+rt.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-"))},result:e[2]};if(e=n.match(/([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[:\uff1a](.+)/)){const i=+rt.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-"));return{range:{start:i,end:i},result:e[2]}}return(e=n.match(/[\*\uff0a][\s\u3000]*[\-\u2015\uff0d~\uff5e][\*\uff0a][\s\u3000]*[:\uff1a](.+)/))||(e=n.match(/[\*\uff0a][\s\u3000]*[:\uff1a](.+)/))?{range:{start:null,end:null},result:e[1]}:null}).filter(n=>n):[]}};var zs;$e([at()],ga.prototype,"name",void 0),$e([at()],ga.prototype,"command",void 0),$e([at()],ga.prototype,"dice",void 0),ga=$e([ni("dice-roll-table")],ga);let go=zs=class extends Vn{static get instance(){return zs._instance||(zs._instance=new zs("DiceRollTableList"),zs._instance.initialize()),zs._instance}get diceRollTables(){return this.children}addDiceRollTable(...n){let e=null;if(n[0]instanceof ga)e=n[0];else{let i=n[0];e=new ga(n[1]),e.name=i,e.initialize()}return this.appendChild(e)}parseInnerXml(n){for(let i of zs.instance.children)i.destroy();let e=zs.instance.toContext();e.syncData=this.toContext().syncData,zs.instance.apply(e),zs.instance.update(),super.parseInnerXml.apply(zs.instance,[n]),this.destroy()}};go=zs=$e([ni("dice-roll-table-list")],go);var gr=(()=>(function(t){t[t.NULL=0]="NULL",t[t.THUMBNAIL=1]="THUMBNAIL",t[t.COMPLETE=2]="COMPLETE",t[t.URL=1e3]="URL"}(gr||(gr={})),gr))();class ys{constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:""},this.isHidden=!1}get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob}get url(){return this.context.url}get isReady(){return gr.NULL<this.state}get state(){return this.url||this.blob?this.url&&!this.blob?gr.URL:gr.COMPLETE:gr.NULL}static createEmpty(n){let e=new ys;return e.context.identifier=n,e}static create(n){if("string"==typeof n){let e=new ys;return e.context.identifier=n,e.context.name=n,e.context.url=n,e}{let e=new ys;return e.apply(n),e}}static createAsync(n){return(0,tn.Z)(function*(){return n instanceof File?yield ys._createAsync(n,n.name):n instanceof Blob?yield ys._createAsync(n):void 0})()}static _createAsync(n,e){return(0,tn.Z)(function*(){let i=yield po.readAsArrayBufferAsync(n),r=new ys;return r.context.identifier=yield po.calcSHA256Async(i),r.context.name=e,r.context.blob=new Blob([i],{type:n.type}),r.context.type=r.context.blob.type,r.context.url=window.URL.createObjectURL(r.context.blob),r.context.name||(r.context.name=r.context.identifier),r})()}destroy(){this.revokeURLs()}apply(n){!this.context.identifier&&n.identifier&&(this.context.identifier=n.identifier),n.name&&(this.context.name=n.name),!this.context.blob&&n.blob&&(this.context.blob=n.blob),!this.context.type&&n.type&&(this.context.type=n.type),!this.context.url&&n.url&&(this.state!==gr.URL&&window.URL.revokeObjectURL(this.context.url),this.context.url=n.url),this.createURLs()}createURLs(){this.state!==gr.URL&&this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob))}revokeURLs(){this.state!==gr.URL&&window.URL.revokeObjectURL(this.context.url)}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url}}}var Ka=(()=>(function(t){t[t.MASTER=0]="MASTER",t[t.AUDITION=1]="AUDITION"}(Ka||(Ka={})),Ka))();class Ft{constructor(n){this.volumeType=Ka.MASTER,this.audio=n}static get audioContext(){return Ft._audioContext||(Ft._audioContext=new(window.AudioContext||window.webkitAudioContext)),Ft._audioContext}static get volume(){return Ft._volume}static set volume(n){Ft._volume=n,Ft.masterGainNode.gain.setTargetAtTime(Ft._volume,Ft.audioContext.currentTime,.01)}static get auditionVolume(){return Ft._auditionVolume}static set auditionVolume(n){Ft._auditionVolume=n,Ft.auditionGainNode.gain.setTargetAtTime(Ft._auditionVolume,Ft.audioContext.currentTime,.01)}static get masterGainNode(){if(!Ft._masterGainNode){let n=Ft.audioContext.createGain();n.gain.setValueAtTime(Ft._volume,Ft.audioContext.currentTime),n.connect(Ft.audioContext.destination),Ft._masterGainNode=n}return Ft._masterGainNode}static get auditionGainNode(){if(!Ft._auditionGainNode){let n=Ft.audioContext.createGain();n.gain.setValueAtTime(Ft._auditionVolume,Ft.audioContext.currentTime),n.connect(Ft.audioContext.destination),Ft._auditionGainNode=n}return Ft._auditionGainNode}static get rootNode(){return Ft.masterGainNode}static get auditionNode(){return Ft.auditionGainNode}get audioElm(){return this._audioElm||(this._audioElm=new Audio,this._audioElm.onplay=()=>{},this._audioElm.onpause=()=>{this.mediaElementSource.disconnect()},this._audioElm.onended=()=>{this.mediaElementSource.disconnect()}),this._audioElm}get mediaElementSource(){return this._mediaElementSource||(this._mediaElementSource=Ft.audioContext.createMediaElementSource(this.audioElm)),this._mediaElementSource}get volume(){return this.audioElm.volume}set volume(n){this.audioElm.volume=n}get loop(){return this.audioElm.loop}set loop(n){this.audioElm.loop=n}get paused(){return this.audioElm.paused}static play(n,e=1){this.playBufferAsync(n,e)}play(n=this.audio){if(this.stop(),this.audio=n,!this.audio)return;let e=this.audio.url;n.state===gr.URL&&(Ft.cacheMap.has(n.identifier)?e=Ft.cacheMap.get(n.identifier).url:Ft.createCacheAsync(n)),this.mediaElementSource.connect(this.getConnectingAudioNode()),this.audioElm.src=e,this.audioElm.load(),this.audioElm.play().catch(i=>{console.warn(i)})}pause(){this.audioElm.pause()}stop(){!this.audioElm||(this.pause(),this.audioElm.currentTime=0,this.audioElm.src="",this.audioElm.load(),this.mediaElementSource.disconnect())}getConnectingAudioNode(){return this.volumeType===Ka.AUDITION?Ft.auditionNode:Ft.rootNode}static playBufferAsync(n,e=1){return(0,tn.Z)(function*(){let i=yield Ft.createBufferSourceAsync(n);if(!i)return;let r=Ft.audioContext.createGain();r.gain.setValueAtTime(e,Ft.audioContext.currentTime),r.connect(Ft.rootNode),i.connect(r),i.onended=()=>{i.stop(),i.disconnect(),r.disconnect(),i.buffer=null},i.start()})()}static createBufferSourceAsync(n){var e=this;return(0,tn.Z)(function*(){if(!n)return null;try{let i=n.blob;if(n.state===gr.URL)if(Ft.cacheMap.has(n.identifier))i=Ft.cacheMap.get(n.identifier).blob;else{let o=yield Ft.createCacheAsync(n);i=o&&o.blob?o.blob:null}if(!i)return null;let r=yield e.decodeAudioDataAsync(i),s=Ft.audioContext.createBufferSource();return s.buffer=r,s}catch(i){return console.warn(i),null}})()}static decodeAudioDataAsync(n){return new Promise(function(){var e=(0,tn.Z)(function*(i,r){Ft.audioContext.decodeAudioData(yield po.readAsArrayBufferAsync(n),s=>i(s),s=>r(s))});return function(i,r){return e.apply(this,arguments)}}())}static getBlobAsync(n){return(0,tn.Z)(function*(){if(n.blob)return n.blob;if(n.url.length<1)throw new Error("\u3048\u3063 \u306a\u306b\u305d\u308c\u6016\u3044");try{let e=yield fetch(n.url);if(!e.ok)throw new Error("Network response was not ok.");return yield e.blob()}catch(e){throw console.warn("There has been a problem with your fetch operation: ",e.message),e}})()}static createCacheAsync(n){return(0,tn.Z)(function*(){let e={url:n.url,blob:null};try{e.blob=yield Ft.getBlobAsync(n)}catch(i){return console.error(i),e}return Ft.cacheMap.has(n.identifier)?Ft.cacheMap.get(n.identifier):(e.url=URL.createObjectURL(e.blob),Ft.cacheMap.set(n.identifier,e),e)})()}static resumeAudioContext(){Ft.audioContext.resume();let n=()=>{Ft.audioContext.resume(),document.removeEventListener("touchstart",n,!0),document.removeEventListener("mousedown",n,!0),console.log("resumeAudioContext")};document.addEventListener("touchstart",n,!0),document.addEventListener("mousedown",n,!0)}}Ft._volume=.5,Ft._auditionVolume=.5,Ft.cacheMap=new Map;class zt{constructor(){this.hash={},console.log("AudioStorage ready...")}static get instance(){return zt._instance||(zt._instance=new zt),zt._instance}get audios(){let n=[];for(let e in this.hash)n.push(this.hash[e]);return n}destroy(){for(let n in this.hash)this.delete(n)}addAsync(n){var e=this;return(0,tn.Z)(function*(){let i=yield ys.createAsync(n);return e._add(i)})()}add(n){let e;if("string"==typeof n)e=ys.create(n);else if(n instanceof ys)e=n;else{if(this.update(n))return this.hash[n.identifier];e=ys.create(n)}return this._add(e)}_add(n){return gr.COMPLETE<=n.state&&this.lazySynchronize(100),this.update(n)?this.hash[n.identifier]:(this.hash[n.identifier]=n,console.log("add Audio: "+n.identifier),n)}update(n){let e;e=n instanceof ys?n.toContext():n;let i=this.hash[n.identifier];return!!i&&(i.apply(n),!0)}delete(n){let e=this.hash[n];return!!e&&(e.destroy(),delete this.hash[n],!0)}get(n){return this.hash[n]||null}synchronize(n){this.lazyTimer&&this.lazyTimer.stop(),ze.call("SYNCHRONIZE_AUDIO_LIST",this.getCatalog(),n)}lazySynchronize(n,e){null==this.lazyTimer&&(this.lazyTimer=new ha(()=>this.synchronize(e),n)),this.lazyTimer.reset(n)}getCatalog(){let n=[];for(let e of zt.instance.audios)gr.COMPLETE<=e.state&&n.push({identifier:e.identifier,state:e.state});return n}}var Up=(()=>(function(t){t.ACTION="action",t.SEPARATOR="separator"}(Up||(Up={})),Up))();const kt={name:"",disabled:!0,type:Up.SEPARATOR};let lr=(()=>{class t{constructor(){this.title="",this.actions=[],this.position={x:0,y:0},this.titleColor=We.CHAT_DEFAULT_COLOR,this.titleBold=!1}get isShow(){return!!this.panelComponentRef}open(e,i,r,s,o,a){let h;this.close(),s||(s=t.defaultParentViewContainerRef,console.log("Context Open")),h=s.createComponent(t.ContextMenuComponentClass,{index:s.length,injector:s.injector});const w=h.injector.get(t);w.panelComponentRef=h,i&&(w.actions=i),e&&(w.position.x=e.x,w.position.y=e.y),w.titleColor=o||We.CHAT_DEFAULT_COLOR,w.titleBold=a,w.title=null!=r?r:"",h.onDestroy(()=>{w.panelComponentRef=null})}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}}return t.ContextMenuComponentClass=null,t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=rn({token:t,factory:t.\u0275fac}),t})(),fi=(()=>{class t{constructor(e){this.ngZone=e,this.callbackOnPointerDown=i=>this.onPointerDown(i),this.callbackOnPointerMove=i=>this.onPointerMove(i),this.callbackOnPointerUp=i=>this.onPointerUp(i),this.callbackOnContextMenu=i=>this.onContextMenu(i),this._isAllowedToOpenContextMenu=!1,this.pointers=[{x:0,y:0,z:0,identifier:-1}],this.startPostion=this.pointers[0],this.primaryPointer=this.pointers[0],this._isDragging=!1}get isAllowedToOpenContextMenu(){return this._isAllowedToOpenContextMenu}get pointer(){return this.primaryPointer}get pointerX(){return this.primaryPointer.x}get pointerY(){return this.primaryPointer.y}get isDragging(){return this._isDragging}set isDragging(e){e!==this._isDragging&&this.ngZone.run(()=>this._isDragging=e)}initialize(){this.addEventListeners()}destroy(){this.removeEventListeners()}onPointerDown(e){this.onPointerMove(e),this._isAllowedToOpenContextMenu=!0,this.startPostion=this.pointers[0]}onPointerMove(e){e.touches?this.onTouchMove(e):this.onMouseMove(e),this.targetElement=e.target}onPointerUp(e){this.onPointerMove(e)}onMouseMove(e){let i={x:e.pageX,y:e.pageY,z:0,identifier:-9999};this.isSyntheticEvent(i)||(this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(i),this.pointers=[i],this.primaryPointer=i)}onTouchMove(e){let i=e.touches.length;if(!(i<1)){this.pointers=[];for(let r=0;r<i;r++){let s=e.touches[r],o={x:s.pageX,y:s.pageY,z:0,identifier:s.identifier};this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(o),this.pointers.push(o)}this.primaryPointer=this.pointers[0]}}onContextMenu(e){this._isAllowedToOpenContextMenu=!0,this.onPointerUp(e)}preventContextMenuIfNeeded(e,i=3){i**2<(e.x-this.startPostion.x)**2+(e.y-this.startPostion.y)**2&&(this._isAllowedToOpenContextMenu=!1)}isSyntheticEvent(e,i=15){for(let r of this.pointers)if(r.identifier!==e.identifier&&(e.x-r.x)**2+(e.y-r.y)**2<i**2)return!0;return!1}addEventListeners(){this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.addEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.addEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.addEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.addEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.addEventListener("touchend",this.callbackOnPointerUp,!0),document.body.addEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.addEventListener("drop",this.callbackOnPointerUp,!0),document.body.addEventListener("contextmenu",this.callbackOnContextMenu,!0)})}removeEventListeners(){document.body.removeEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.removeEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.removeEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.removeEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.removeEventListener("touchend",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.removeEventListener("drop",this.callbackOnPointerUp,!0),document.body.removeEventListener("contextmenu",this.callbackOnContextMenu,!0)}}return t.\u0275fac=function(e){return new(e||t)(an(Cn))},t.\u0275prov=rn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Bi;!function(t){function e(i,r=0){return i=parseFloat(i),isNaN(i)?r:i}t.relation=function n(i,r,s=0){return"number"==typeof i?i:"string"==typeof i?(i=i.trim().toLowerCase()).indexOf("%")>0?e(i.replace("%",""),s)/100*r:i.indexOf("px")>0||i.indexOf("pt")>0?e(i.replace("px",""),s):i.indexOf("vw")>0?e(i.replace("vw",""),s)/100*window.innerWidth:i.indexOf("vh")>0?e(i.replace("vh",""),s)/100*window.innerHeight:i.indexOf("vm")>0?e(i.replace("vm",""),s)/100*Math.min(window.innerWidth,window.innerHeight):i.indexOf("em")>0?e(i.replace("em",""),s):"top"===i||"left"===i?0:"center"===i||"middle"===i?.5*r:"bottom"===i||"right"===i?r:s:s},t.parse=e}(Bi||(Bi={}));class js{constructor(n,e={capture:!1,passive:!1,always:!1}){this.target=n,this.callbackOnMouse=this.onMouse.bind(this),this.callbackOnTouch=this.onTouch.bind(this),this.callbackOnMenu=this.onMenu.bind(this),this.lastPointers=[],this.primaryPointer={x:0,y:0,z:0,identifier:-9999},this._isDragging=!1,this._isGrabbing=!1,this._isDestroyed=!1,this.option=null,this.option={capture:!0===e.capture,passive:!0===e.passive,always:!0===e.always},this.initialize()}get pointer(){return this.primaryPointer}get isDragging(){return this._isDragging}get isGrabbing(){return this._isGrabbing}get isDestroyed(){return this._isDestroyed}initialize(){this.target.addEventListener("mousedown",this.callbackOnMouse,this.option.capture),this.target.addEventListener("touchstart",this.callbackOnTouch,this.option.capture),this.option.always&&this.addEventListeners()}destroy(){this.cancel(),this._isDestroyed=!0,this.target.removeEventListener("mousedown",this.callbackOnMouse,this.option.capture),this.target.removeEventListener("touchstart",this.callbackOnTouch,this.option.capture),this.removeEventListeners()}cancel(){this._isDragging=this._isGrabbing=!1,this.option.always||this.removeEventListeners()}onMouse(n){let e={x:n.pageX,y:n.pageY,z:0,identifier:-9999};this.isSyntheticEvent(e)||(this.lastPointers=[e],this.primaryPointer=e,this.onPointer(n))}onTouch(n){let e=n.changedTouches.length;if(!(e<1)){this.lastPointers=[];for(let i=0;i<e;i++){let r=n.changedTouches[i];this.lastPointers.push({x:r.pageX,y:r.pageY,z:0,identifier:r.identifier})}if("touchstart"===n.type)this.primaryPointer=this.lastPointers[0];else{let r=Array.from(n.changedTouches).find(o=>o.identifier===this.primaryPointer.identifier);if(null==r)return void(null!=Array.from(n.touches).find(a=>a.identifier===this.primaryPointer.identifier)||(this.onEnd&&this.onEnd(n),this.cancel()));this.primaryPointer={x:r.pageX,y:r.pageY,z:0,identifier:r.identifier}}this.onPointer(n)}}onPointer(n){switch(n.type){case"mousedown":case"touchstart":this._isGrabbing=!0,this._isDragging=!1,this.addEventListeners(),this.onStart&&this.onStart(n);break;case"mousemove":case"touchmove":this.onMove&&this.onMove(n),this._isDragging=this._isGrabbing;break;default:this.onEnd&&this.onEnd(n),this.cancel()}}onMenu(n){this.onContextMenu&&this.onContextMenu(n)}isSyntheticEvent(n,e=15){for(let i of this.lastPointers)if(i.identifier!==n.identifier&&(n.x-i.x)**2+(n.y-i.y)**2<e**2)return!0;return!1}addEventListeners(){let n={capture:this.option.capture,passive:this.option.passive};this.target.ownerDocument.addEventListener("mousemove",this.callbackOnMouse,n),this.target.ownerDocument.addEventListener("mouseup",this.callbackOnMouse,n),this.target.ownerDocument.addEventListener("touchmove",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("touchend",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("touchcancel",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("contextmenu",this.callbackOnMenu,n),this.target.ownerDocument.addEventListener("drop",this.callbackOnMouse,n)}removeEventListeners(){let n={capture:this.option.capture};this.target.ownerDocument.removeEventListener("mousemove",this.callbackOnMouse,n),this.target.ownerDocument.removeEventListener("mouseup",this.callbackOnMouse,n),this.target.ownerDocument.removeEventListener("touchmove",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("touchend",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("touchcancel",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("contextmenu",this.callbackOnMenu,n),this.target.ownerDocument.removeEventListener("drop",this.callbackOnMouse,n)}}let X0=(()=>{class t{constructor(e,i){this.ngZone=e,this.elementRef=i,this.isDisable=!1,this.boundsSelector="body",this.handleSelector="",this.unhandleSelector="input,textarea,button,select,option,span",this.stackSelector="",this.opacity=.7,this.allowOverHalf=!1,this.onstart=new Tn,this.onmove=new Tn,this.onend=new Tn,this.callbackOnResize=this.adjustPosition.bind(this),this.input=null,this.startPosition={x:0,y:0,z:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={x:0,y:0,z:0}}ngAfterViewInit(){this.initialize(),this.adjustPosition(),this.setForeground()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.input=new js(this.elementRef.nativeElement),window.addEventListener("resize",this.callbackOnResize,!1)}),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this)}cancel(){this.input.cancel()}destroy(){window.removeEventListener("resize",this.callbackOnResize,!1),this.input.destroy()}onInputStart(e){if(this.isDisable)return this.cancel();if(1===e.button||2===e.button)return this.cancel();this.setForeground(),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=this.input.pointer,this.prevTrans={x:0,y:0,z:0};let i=this.isHandleElement(e.target),r=this.isUnhandleElement(e.target),s=null!=e.touches&&this.isScrollableElement(e.target);!i||r||s?this.cancel():(this.elementRef.nativeElement.style.cursor="grabbing",e.stopPropagation())}onInputMove(e){let i={x:this.input.pointer.x-this.startPointer.x,y:this.input.pointer.y-this.startPointer.y,z:this.input.pointer.z-this.startPointer.z},s=this.calcCorrectionPosition({x:i.x-this.prevTrans.x,y:i.y-this.prevTrans.y,z:i.z-this.prevTrans.z});i.x+=s.x,i.y+=s.y,i.z+=s.z,0<i.x**2+i.y**2+i.z**2&&(this.elementRef.nativeElement.style.opacity=this.opacity+""),this.elementRef.nativeElement.style.willChange="top, left",this.elementRef.nativeElement.style.left=i.x+this.startPosition.x+"px",this.elementRef.nativeElement.style.top=i.y+this.startPosition.y+"px",this.elementRef.nativeElement.style.cursor="grabbing",this.prevTrans=i,e.cancelable&&e.preventDefault(),e.stopPropagation()}onInputEnd(e){this.elementRef.nativeElement.style.opacity=null,this.elementRef.nativeElement.style.cursor=null,this.elementRef.nativeElement.style.willChange=null,this.input.isDragging&&e.cancelable&&(this.preventClickIfNeeded(e),e.preventDefault()),e.stopPropagation()}onContextMenu(e){e.stopPropagation()}preventClickIfNeeded(e){if(null!=e.touches)return;if(225>(this.input.pointer.x-this.startPointer.x)**2+(this.input.pointer.y-this.startPointer.y)**2+(this.input.pointer.z-this.startPointer.z)**2)return;let a=h=>{h.cancelable&&h.preventDefault(),h.stopPropagation()};this.elementRef.nativeElement.addEventListener("click",a,!0),queueMicrotask(()=>this.elementRef.nativeElement.removeEventListener("click",a,!0))}adjustPosition(){let e=this.calcElementPosition(this.elementRef.nativeElement),i=this.calcCorrectionPosition();this.elementRef.nativeElement.style.left=i.x+e.x+"px",this.elementRef.nativeElement.style.top=i.y+e.y+"px"}isHandleElement(e){return this.handleSelector.length<1||this.isContainsElement(e,this.handleSelector)}isUnhandleElement(e){return!(this.unhandleSelector.length<1)&&this.isContainsElement(e,this.unhandleSelector)}isContainsElement(e,i){let r=this.elementRef.nativeElement.querySelectorAll(i);for(let s=0;s<r.length;s++)if(r[s].contains(e))return!0;return!1}isScrollableElement(e){let i=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector),r=e,s=["scroll","auto"],o=["fixed","sticky","-webkit-sticky"];for(;r&&i!==r&&this.elementRef.nativeElement!==r;){let a=window.getComputedStyle(r);if(0<=s.indexOf(a.overflowY)&&r.offsetHeight<r.scrollHeight)return!0;if(0<=o.indexOf(a.position))return!1;r=r.parentElement}return!1}calcCorrectionPosition(e={x:0,y:0,z:0}){let i={x:0,y:0,z:0},r=this.elementRef.nativeElement.getBoundingClientRect(),s=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();if(this.allowOverHalf){const o=r.right-r.left,a=r.bottom-r.top;s.right+o/2<r.right+e.x&&(i.x+=s.right+o/2-(r.right+e.x)),r.left+e.x<s.left-o/2&&(i.x+=s.left-o/2-(r.left+e.x)),s.bottom+a/2<r.bottom+e.y&&(i.y+=s.bottom+a/2-(r.bottom+e.y)),r.top+e.y<s.top-a/2&&(i.y+=s.top-a/2-(r.top+e.y))}else s.right<r.right+e.x&&(i.x+=s.right-(r.right+e.x)),r.left+e.x<s.left&&(i.x+=s.left-(r.left+e.x)),s.bottom<r.bottom+e.y&&(i.y+=s.bottom-(r.bottom+e.y)),r.top+e.y<s.top&&(i.y+=s.top-(r.top+e.y));return i}calcElementPosition(e){let i=window.getComputedStyle(e);return{x:Bi.relation(i.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),y:Bi.relation(i.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),z:0}}setForeground(){if(this.stackSelector.length<1)return;let e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),i=0,r=99999;e.forEach(s=>{let o=parseInt(s.style.zIndex);i<o&&(i=o),o<r&&(r=o)}),!(i<=parseInt(this.elementRef.nativeElement.style.zIndex))&&(e.forEach(s=>{s.style.zIndex=parseInt(s.style.zIndex)-r+""}),this.elementRef.nativeElement.style.zIndex=i+1+"")}}return t.\u0275fac=function(e){return new(e||t)(He(Cn),He(yi))},t.\u0275dir=Qt({type:t,selectors:[["","appDraggable",""]],inputs:{isDisable:["draggable.disable","isDisable"],boundsSelector:["draggable.bounds","boundsSelector"],handleSelector:["draggable.handle","handleSelector"],unhandleSelector:["draggable.unhandle","unhandleSelector"],stackSelector:["draggable.stack","stackSelector"],opacity:["draggable.opacity","opacity"],allowOverHalf:["draggable.allowOverHalf","allowOverHalf"]},outputs:{onstart:"draggable.start",onmove:"draggable.move",onend:"draggable.end"}}),t})();class Ya extends u{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){const e=super._subscribe(n);return!e.closed&&n.next(this._value),e}getValue(){const{hasError:n,thrownError:e,_value:i}=this;if(n)throw e;return this._throwIfClosed(),i}next(n){super.next(this._value=n)}}function Za(...t){return vr(t,Co(t))}function aT(t,n,e){return e?aT(t,n).pipe(Dd(e)):new F(i=>{const r=(...o)=>i.next(1===o.length?o[0]:o),s=t(r);return d(n)?()=>n(r,s):void 0})}function Xa(...t){const n=Co(t),e=yo(t),{args:i,keys:r}=O2(t);if(0===i.length)return vr([],n);const s=new F(lT(i,n,r?o=>R2(r,o):k));return e?s.pipe(Dd(e)):s}function lT(t,n,e=k){return i=>{cT(n,()=>{const{length:r}=t,s=new Array(r);let o=r,a=r;for(let h=0;h<r;h++)cT(n,()=>{const w=vr(t[h],n);let X=!1;w.subscribe(m(i,fe=>{s[h]=fe,X||(X=!0,a--),a||i.next(e(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}function cT(t,n,e){t?ws(e,t,n):n()}function Go(t){return t<=0?()=>sc:y((n,e)=>{let i=0;n.subscribe(m(e,r=>{++i<=t&&(e.next(r),t<=i&&e.complete())}))})}function Vp(...t){return function W9(){return Au(1)}()(vr(t,Co(t)))}function uT(...t){const n=Co(t);return y((e,i)=>{(n?Vp(t,e,n):Vp(t,e)).subscribe(i)})}function dT(t,n,e){const i=d(t)||n||e?{next:t,error:n,complete:e}:t;return i?y((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let a=!0;r.subscribe(m(s,h=>{var w;null===(w=i.next)||void 0===w||w.call(i,h),s.next(h)},()=>{var h;a=!1,null===(h=i.complete)||void 0===h||h.call(i),s.complete()},h=>{var w;a=!1,null===(w=i.error)||void 0===w||w.call(i,h),s.error(h)},()=>{var h,w;a&&(null===(h=i.unsubscribe)||void 0===h||h.call(i)),null===(w=i.finalize)||void 0===w||w.call(i)}))}):k}function Q0(t){return y((n,e)=>{$r(t).subscribe(m(e,()=>e.complete(),B)),!e.closed&&n.subscribe(e)})}class Y9 extends F{constructor(n,e){super(),this.source=n,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,_(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){const n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:n}=this;this._subject=this._connection=null,null==n||n.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new x;const e=this.getSubject();n.add(this.source.subscribe(m(e,void 0,()=>{this._teardown(),e.complete()},i=>{this._teardown(),e.error(i)},()=>this._teardown()))),n.closed&&(this._connection=null,n=x.EMPTY)}return n}refCount(){return function K9(){return y((t,n)=>{let e=null;t._refCount++;const i=m(n,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount)return void(e=null);const r=t._connection,s=e;e=null,r&&(!s||r===s)&&r.unsubscribe(),n.unsubscribe()});t.subscribe(i),i.closed||(e=t.connect())})}()(this)}}const X9={connector:()=>new u};function fT(t,n=X9){const{connector:e}=n;return y((i,r)=>{const s=e();$r(t(function Z9(t){return new F(n=>t.subscribe(n))}(s))).subscribe(r),r.add(i.subscribe(s))})}function hT(t){return t?n=>fT(t)(n):n=>function Q9(t,n){const e=d(t)?t:()=>t;return d(n)?fT(n,{connector:e}):i=>new Y9(i,e)}(new u)(n)}function of(t,n){return y((e,i)=>{let r=null,s=0,o=!1;const a=()=>o&&!r&&i.complete();e.subscribe(m(i,h=>{null==r||r.unsubscribe();let w=0;const X=s++;$r(t(h,X)).subscribe(r=m(i,fe=>i.next(n?n(h,fe,X,w++):fe),()=>{r=null,a()}))},()=>{o=!0,a()}))})}function J0(...t){const n=yo(t);return y((e,i)=>{const r=t.length,s=new Array(r);let o=t.map(()=>!1),a=!1;for(let h=0;h<r;h++)$r(t[h]).subscribe(m(i,w=>{s[h]=w,!a&&!o[h]&&(o[h]=!0,(a=o.every(k))&&(o=null))},B));e.subscribe(m(i,h=>{if(a){const w=[h,...s];i.next(n?n(...w):w)}}))})}function J9(t,n,e,i,r){return(s,o)=>{let a=e,h=n,w=0;s.subscribe(m(o,X=>{const fe=w++;h=a?t(h,X,fe):(a=!0,X),i&&o.next(h)},r&&(()=>{a&&o.next(h),o.complete()})))}}function n7(t,n){return t===n}const{isArray:i7}=Array;function r7(t){return 1===t.length&&i7(t[0])?t[0]:t}function pT(...t){const n=yo(t);return n?de(pT(...t),Dd(n)):y((e,i)=>{lT([e,...r7(t)])(i)})}function Gl(t,n){return y((e,i)=>{let r=0;e.subscribe(m(i,s=>t.call(n,s,r++)&&i.next(s)))})}const o7=["youtubeContainer"];let mT=(()=>{class t{constructor(e,i){this._ngZone=e,this._youtubeContainer=new u,this._destroyed=new u,this._playerChanges=new Ya(void 0),this._videoId=new Ya(void 0),this._height=new Ya(390),this._width=new Ya(640),this._startSeconds=new Ya(void 0),this._endSeconds=new Ya(void 0),this._suggestedQuality=new Ya(void 0),this._playerVars=new Ya(void 0),this.ready=this._getLazyEmitter("onReady"),this.stateChange=this._getLazyEmitter("onStateChange"),this.error=this._getLazyEmitter("onError"),this.apiChange=this._getLazyEmitter("onApiChange"),this.playbackQualityChange=this._getLazyEmitter("onPlaybackQualityChange"),this.playbackRateChange=this._getLazyEmitter("onPlaybackRateChange"),this._isBrowser=_$(i)}get videoId(){return this._videoId.value}set videoId(e){this._videoId.next(e)}get height(){return this._height.value}set height(e){this._height.next(e||390)}get width(){return this._width.value}set width(e){this._width.next(e||640)}set startSeconds(e){this._startSeconds.next(e)}set endSeconds(e){this._endSeconds.next(e)}set suggestedQuality(e){this._suggestedQuality.next(e)}get playerVars(){return this._playerVars.value}set playerVars(e){this._playerVars.next(e)}ngOnInit(){if(!this._isBrowser)return;let e=Za(!0);if(!window.YT||!window.YT.Player){const r=new u;this._existingApiReadyCallback=window.onYouTubeIframeAPIReady,window.onYouTubeIframeAPIReady=()=>{this._existingApiReadyCallback&&this._existingApiReadyCallback(),this._ngZone.run(()=>r.next(!0))},e=r.pipe(Go(1),uT(!1))}const i=function u7(t,n,e,i,r,s,o){const a=Xa([n,s]).pipe(J0(Xa([i,r])),se(([h,w])=>{const[X,fe]=h,[pe,we]=w;return X?{videoId:X,playerVars:fe,width:pe,height:we}:void 0}));return Xa([t,a,Za(o)]).pipe(function d7(t){return de(pT(t),function s7(t){return y((n,e)=>{let i=!1,r=0;n.subscribe(m(e,s=>(i||(i=!t(s,r++)))&&e.next(s)))})}(([n,e])=>!e),se(([n])=>n))}(e),function e7(t,n){return y(J9(t,n,arguments.length>=2,!0))}(f7,void 0),function t7(t,n=k){return t=null!=t?t:n7,y((e,i)=>{let r,s=!0;e.subscribe(m(i,o=>{const a=n(o);(s||!t(r,a))&&(s=!1,r=a,i.next(o))}))})}())}(this._youtubeContainer,this._videoId,e,this._width,this._height,this._playerVars,this._ngZone).pipe(dT(r=>{this._playerChanges.next(r)}),function c7(t){return $a(n=>n?$T(n)?Za(n):new F(e=>{let i=!1,r=!1;const s=o=>{r=!0,i||(o.target.removeEventListener("onReady",s),e.next(o.target))};return n.addEventListener("onReady",s),()=>{i=!0,r||t(n)}}).pipe(Go(1),uT(void 0)):Za(void 0))}(r=>{$T(r)||r.destroy()}),Q0(this._destroyed),hT());i.subscribe(r=>{this._player=r,r&&this._pendingPlayerState&&this._initializePlayer(r,this._pendingPlayerState),this._pendingPlayerState=void 0}),function a7(t,n,e){Xa([t,n,e]).subscribe(([i,r,s])=>i&&i.setSize(r,s))}(i,this._width,this._height),function l7(t,n){Xa([t,n]).subscribe(([e,i])=>e&&i&&e.setPlaybackQuality(i))}(i,this._suggestedQuality),function h7(t,n,e,i,r,s){const o=Xa([e,i]).pipe(se(([X,fe])=>({startSeconds:X,endSeconds:fe}))),a=o.pipe(ev(t,X=>!!X&&!function p7(t){const n=t.getPlayerState();return n!==YT.PlayerState.UNSTARTED&&n!==YT.PlayerState.CUED}(X))),h=n.pipe(ev(t,(X,fe)=>!!X&&X.videoId!==fe));cl(t.pipe(ev(Xa([n,o]),([X,fe],pe)=>!(!pe||X==pe.videoId&&!fe.startSeconds&&!fe.endSeconds))),h,a).pipe(J0(Xa([t,n,o,r])),se(([X,fe])=>fe),Q0(s)).subscribe(([X,fe,pe,we])=>{!fe||!X||(X.videoId=fe,X.cueVideoById(Object.assign({videoId:fe,suggestedQuality:we},pe)))})}(i,this._videoId,this._startSeconds,this._endSeconds,this._suggestedQuality,this._destroyed),i.connect()}ngAfterViewInit(){this._youtubeContainer.next(this.youtubeContainer.nativeElement)}ngOnDestroy(){this._player&&(this._player.destroy(),window.onYouTubeIframeAPIReady=this._existingApiReadyCallback),this._playerChanges.complete(),this._videoId.complete(),this._height.complete(),this._width.complete(),this._startSeconds.complete(),this._endSeconds.complete(),this._suggestedQuality.complete(),this._youtubeContainer.complete(),this._playerVars.complete(),this._destroyed.next(),this._destroyed.complete()}playVideo(){this._player?this._player.playVideo():this._getPendingState().playbackState=YT.PlayerState.PLAYING}pauseVideo(){this._player?this._player.pauseVideo():this._getPendingState().playbackState=YT.PlayerState.PAUSED}stopVideo(){this._player?this._player.stopVideo():this._getPendingState().playbackState=YT.PlayerState.CUED}seekTo(e,i){this._player?this._player.seekTo(e,i):this._getPendingState().seek={seconds:e,allowSeekAhead:i}}mute(){this._player?this._player.mute():this._getPendingState().muted=!0}unMute(){this._player?this._player.unMute():this._getPendingState().muted=!1}isMuted(){return this._player?this._player.isMuted():!!this._pendingPlayerState&&!!this._pendingPlayerState.muted}setVolume(e){this._player?this._player.setVolume(e):this._getPendingState().volume=e}getVolume(){return this._player?this._player.getVolume():this._pendingPlayerState&&null!=this._pendingPlayerState.volume?this._pendingPlayerState.volume:0}setPlaybackRate(e){if(this._player)return this._player.setPlaybackRate(e);this._getPendingState().playbackRate=e}getPlaybackRate(){return this._player?this._player.getPlaybackRate():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackRate?this._pendingPlayerState.playbackRate:0}getAvailablePlaybackRates(){return this._player?this._player.getAvailablePlaybackRates():[]}getVideoLoadedFraction(){return this._player?this._player.getVideoLoadedFraction():0}getPlayerState(){if(this._isBrowser&&window.YT)return this._player?this._player.getPlayerState():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackState?this._pendingPlayerState.playbackState:YT.PlayerState.UNSTARTED}getCurrentTime(){return this._player?this._player.getCurrentTime():this._pendingPlayerState&&this._pendingPlayerState.seek?this._pendingPlayerState.seek.seconds:0}getPlaybackQuality(){return this._player?this._player.getPlaybackQuality():"default"}getAvailableQualityLevels(){return this._player?this._player.getAvailableQualityLevels():[]}getDuration(){return this._player?this._player.getDuration():0}getVideoUrl(){return this._player?this._player.getVideoUrl():""}getVideoEmbedCode(){return this._player?this._player.getVideoEmbedCode():""}_getPendingState(){return this._pendingPlayerState||(this._pendingPlayerState={}),this._pendingPlayerState}_initializePlayer(e,i){const{playbackState:r,playbackRate:s,volume:o,muted:a,seek:h}=i;switch(r){case YT.PlayerState.PLAYING:e.playVideo();break;case YT.PlayerState.PAUSED:e.pauseVideo();break;case YT.PlayerState.CUED:e.stopVideo()}null!=s&&e.setPlaybackRate(s),null!=o&&e.setVolume(o),null!=a&&(a?e.mute():e.unMute()),null!=h&&e.seekTo(h.seconds,h.allowSeekAhead)}_getLazyEmitter(e){return this._playerChanges.pipe(of(i=>i?aT(r=>{i.addEventListener(e,r)},r=>{try{i.removeEventListener&&i.removeEventListener(e,r)}catch(s){}}):Za()),i=>new F(r=>i.subscribe({next:s=>this._ngZone.run(()=>r.next(s)),error:s=>r.error(s),complete:()=>r.complete()})),Q0(this._destroyed))}}return t.\u0275fac=function(e){return new(e||t)(He(Cn),He(Cd))},t.\u0275cmp=Xt({type:t,selectors:[["youtube-player"]],viewQuery:function(e,i){if(1&e&&cn(o7,5),2&e){let r;ln(r=un())&&(i.youtubeContainer=r.first)}},inputs:{videoId:"videoId",height:"height",width:"width",startSeconds:"startSeconds",endSeconds:"endSeconds",suggestedQuality:"suggestedQuality",playerVars:"playerVars",showBeforeIframeApiLoads:"showBeforeIframeApiLoads"},outputs:{ready:"ready",stateChange:"stateChange",error:"error",apiChange:"apiChange",playbackQualityChange:"playbackQualityChange",playbackRateChange:"playbackRateChange"},decls:2,vars:0,consts:[["youtubeContainer",""]],template:function(e,i){1&e&&ot(0,"div",null,0)},encapsulation:2,changeDetection:0}),t})();function f7(t,[n,e,i]){if(t&&e&&t.playerVars!==e.playerVars)t.destroy();else{if(!e)return void(t&&t.destroy());if(t)return t}const r=i.runOutsideAngular(()=>new YT.Player(n,e));return r.videoId=e.videoId,r.playerVars=e.playerVars,r}function $T(t){return"getPlayerStatus"in t}function ev(t,n){return de(J0(t),Gl(([e,i])=>n(i,e)),se(([e])=>e))}let g7=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ss({type:t}),t.\u0275inj=os({}),t})(),ai=(()=>{class t{constructor(e){this._sanitizer=e}transform(e,i="html"){switch(i){case"html":return this._sanitizer.bypassSecurityTrustHtml(e);case"style":return this._sanitizer.bypassSecurityTrustStyle(e);case"script":return this._sanitizer.bypassSecurityTrustScript(e);case"url":return this._sanitizer.bypassSecurityTrustUrl(e);case"resourceUrl":return this._sanitizer.bypassSecurityTrustResourceUrl(e);default:throw new Error(`Invalid safe type specified: ${i}`)}}}return t.\u0275fac=function(e){return new(e||t)(He(N2,16))},t.\u0275pipe=yr({name:"safe",type:t,pure:!0}),t})();const _7=["cutInImageElement"],m7=["videoPlayerComponent"];function $7(t,n){1&t&&_n(0)}const af=function(t,n,e,i,r,s,o){return{video:t,test:n,secret:e,minimaize:i,"is-bordered":r,"is-grab":s,"is-grabbing":o}};function v7(t,n){if(1&t){const e=it();Q(0,"div",2,3),Ae("@cutInNone.done",function(){Oe(e);const r=_e();return r.isVisible?null:r.end()})("dblclick",function(){return Oe(e),_e().stop()})("mousedown",function(){return Oe(e),_e().draggstart()})("mouseup",function(){return Oe(e),_e().draggend()})("mouseleave",function(){return Oe(e),_e().draggend()})("mouseout",function(){return Oe(e),_e().draggend()})("mousemove",function(){Oe(e);const r=_e();return!!r.isPointerDragging&&r.draggstart()}),Te(2,$7,1,0,"ng-container",4),ie()}if(2&t){const e=_e(),i=Kt(6);Qe("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible&&!e.videoId?"auto":"none"),re("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInNone",void 0)("ngClass",Wc(17,af,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),U(2),re("ngTemplateOutlet",i)}}function b7(t,n){1&t&&_n(0)}function y7(t,n){if(1&t){const e=it();Q(0,"div",2,3),Ae("@cutInFadeInOut.done",function(){Oe(e);const r=_e();return r.isVisible?null:r.end()})("dblclick",function(){return Oe(e),_e().stop()})("mousedown",function(){return Oe(e),_e().draggstart()})("mouseup",function(){return Oe(e),_e().draggend()})("mouseleave",function(){return Oe(e),_e().draggend()})("mouseout",function(){return Oe(e),_e().draggend()})("mousemove",function(){Oe(e);const r=_e();return!!r.isPointerDragging&&r.draggstart()}),Te(2,b7,1,0,"ng-container",4),ie()}if(2&t){const e=_e(),i=Kt(6);Qe("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible&&!e.videoId?"auto":"none"),re("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInFadeInOut",void 0)("ngClass",Wc(17,af,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),U(2),re("ngTemplateOutlet",i)}}function C7(t,n){1&t&&_n(0)}function x7(t,n){if(1&t){const e=it();Q(0,"div",2,3),Ae("@cutInBounceInOut.done",function(){Oe(e);const r=_e();return r.isVisible?null:r.end()})("dblclick",function(){return Oe(e),_e().stop()})("mousedown",function(){return Oe(e),_e().draggstart()})("mouseup",function(){return Oe(e),_e().draggend()})("mouseleave",function(){return Oe(e),_e().draggend()})("mouseout",function(){return Oe(e),_e().draggend()})("mousemove",function(){Oe(e);const r=_e();return!!r.isPointerDragging&&r.draggstart()}),Te(2,C7,1,0,"ng-container",4),ie()}if(2&t){const e=_e(),i=Kt(6);Qe("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible?"auto":"none"),re("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInBounceInOut",void 0)("ngClass",Wc(17,af,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),U(2),re("ngTemplateOutlet",i)}}function w7(t,n){1&t&&_n(0)}function E7(t,n){if(1&t){const e=it();Q(0,"div",2,3),Ae("@cutInOpenInOut.done",function(){Oe(e);const r=_e();return r.isVisible?null:r.end()})("dblclick",function(){return Oe(e),_e().stop()})("mousedown",function(){return Oe(e),_e().draggstart()})("mouseup",function(){return Oe(e),_e().draggend()})("mouseleave",function(){return Oe(e),_e().draggend()})("mouseout",function(){return Oe(e),_e().draggend()})("mousemove",function(){Oe(e);const r=_e();return!!r.isPointerDragging&&r.draggstart()}),Te(2,w7,1,0,"ng-container",4),ie()}if(2&t){const e=_e(),i=Kt(6);Qe("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible?"auto":"none"),re("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInOpenInOut",void 0)("ngClass",Wc(17,af,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),U(2),re("ngTemplateOutlet",i)}}function T7(t,n){1&t&&_n(0)}function S7(t,n){if(1&t){const e=it();Q(0,"div",2,3),Ae("@cutInOpenInOut2.done",function(){Oe(e);const r=_e();return r.isVisible?null:r.end()})("dblclick",function(){return Oe(e),_e().stop()})("mousedown",function(){return Oe(e),_e().draggstart()})("mouseup",function(){return Oe(e),_e().draggend()})("mouseleave",function(){return Oe(e),_e().draggend()})("mouseout",function(){return Oe(e),_e().draggend()})("mousemove",function(){Oe(e);const r=_e();return!!r.isPointerDragging&&r.draggstart()}),Te(2,T7,1,0,"ng-container",4),ie()}if(2&t){const e=_e(),i=Kt(6);Qe("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible?"auto":"none"),re("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInOpenInOut2",void 0)("ngClass",Wc(17,af,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),U(2),re("ngTemplateOutlet",i)}}function I7(t,n){1&t&&(Q(0,"div",21),ye(1,"TEST"),ie())}function k7(t,n){1&t&&(Q(0,"div",22),ye(1,"TEST"),ie())}function M7(t,n){1&t&&(Q(0,"div",23),ye(1,"TEST"),ie())}function D7(t,n){1&t&&(Q(0,"div",24),ye(1,"TEST"),ie())}function A7(t,n){1&t&&(Q(0,"div",25)(1,"i",26),ye(2,"visibility"),ie(),ye(3," For Your Eyes Only"),ie())}function P7(t,n){1&t&&(Q(0,"div",27),ye(1,"For Your Eyes Only "),Q(2,"i",26),ye(3,"visibility"),ie()())}function N7(t,n){if(1&t&&(Q(0,"div",28)(1,"span")(2,"span",29),ye(3),ie()()()),2&t){const e=_e(2);U(1),Qe("color",e.senderColor),U(1),Qe("width",e.pixcelWidth-(e.isBordered?6:0),"px"),U(1),Ma("",e.senderName,"",e.isMine?"\uff08\u3042\u306a\u305f\uff09":"","")}}function F7(t,n){if(1&t&&(Q(0,"div",30)(1,"span")(2,"span",29),ye(3),ie()()()),2&t){const e=_e(2);U(1),Qe("color",e.senderColor),U(1),Qe("width",e.pixcelWidth-(e.isBordered?6:0),"px"),U(1),Ma("",e.senderName,"",e.isMine?"\uff08\u3042\u306a\u305f\uff09":"","")}}function O7(t,n){if(1&t){const e=it();Q(0,"div",31),Ae("contextmenu",function(r){return Oe(e),_e(2).onContextMenu(r)}),ie()}if(2&t){const e=_e(2);Qe("width",e.pixcelWidth,"px")("height",e.pixcelHeight,"px")}}const R7=function(t,n,e,i){return{autoplay:1,controls:0,start:t,loop:n,playsinline:1,rel:0,listType:"playlist",list:e,playlist:i,disablekb:1,fs:0,iv_load_policy:3,modestbranding:1}};function B7(t,n){if(1&t){const e=it();Q(0,"youtube-player",32,33),Ae("ready",function(r){return Oe(e),_e(2).onPlayerReady(r)})("stateChange",function(r){return Oe(e),_e(2).onPlayerStateChange(r)}),ie()}if(2&t){const e=_e(2);Qe("visibility",e.videoId&&!e.isSoundOnly?"visible":"hidden"),re("videoId",e.videoId)("width",e.pixcelWidth-(e.isBordered?6:0))("height",e.pixcelHeight-(e.isBordered?6:0))("playerVars",co(6,R7,e.cutIn.videoStart,e.cutIn&&e.cutIn.isLoop?1:0,e.playListId?e.playListId:null,e.playListId?null:e.videoId))}}function L7(t,n){if(1&t){const e=it();Q(0,"img",34,35),Ae("error",function(){return Oe(e),_e(2).onErrorFallback()}),ie()}if(2&t){const e=_e(2);Qe("object-fit",e.objectFit),re("src","https://img.youtube.com/vi/"+e.videoId+"/hqdefault.jpg",en)}}function z7(t,n){if(1&t){const e=it();Q(0,"img",36,35),Ae("load",function(){return Oe(e),_e(2).onImageLoad()})("contextmenu",function(r){return Oe(e),_e(2).onContextMenu(r)}),Et(2,"safe"),ie()}if(2&t){const e=_e(2);Qe("object-fit",e.objectFit),re("src",Tt(2,3,e.cutInImage.url,"resourceUrl"),en)}}const Gp=function(t){return{transform:t}};function j7(t,n){if(1&t){const e=it();Te(0,I7,2,0,"div",5),Te(1,k7,2,0,"div",6),Te(2,M7,2,0,"div",7),Te(3,D7,2,0,"div",8),Te(4,A7,4,0,"div",9),Te(5,P7,4,0,"div",10),Te(6,N7,4,6,"div",11),Te(7,F7,4,6,"div",12),Q(8,"div",13),Ae("contextmenu",function(r){return Oe(e),_e().onContextMenu(r)}),ie(),Q(9,"div",14),Ae("contextmenu",function(r){return Oe(e),_e().onContextMenu(r)}),ie(),Q(10,"div",15),Ae("contextmenu",function(r){return Oe(e),_e().onContextMenu(r)}),ie(),Q(11,"div",16),Ae("contextmenu",function(r){return Oe(e),_e().onContextMenu(r)}),ie(),Te(12,O7,1,4,"div",17),Te(13,B7,2,11,"youtube-player",18),Te(14,L7,2,3,"img",19),Te(15,z7,3,6,"img",20)}if(2&t){const e=_e();re("ngIf",e.isTest),U(1),re("ngIf",e.isTest),U(1),re("ngIf",e.isTest),U(1),re("ngIf",e.isTest),U(1),re("ngIf",e.isSecret),U(1),re("ngIf",e.isSecret),U(1),re("ngIf",e.isIndicateSender),U(1),re("ngIf",e.isIndicateSender),U(1),Qe("width",e.pixcelWidth+3,"px")("height",19,"px"),re("ngStyle",ft(32,Gp,"translateX(-"+(e.isBordered?6:3)+"px) translateY(-"+(e.isBordered?6:3)+"px)")),U(1),Qe("width",e.pixcelWidth+3,"px")("height",19,"px"),re("ngStyle",ft(34,Gp,"translateX("+(e.isBordered?6:3)+"px) translateY("+(e.isBordered?6:3)+"px)")),U(1),Qe("width",19,"px")("height",e.pixcelHeight+3,"px"),re("ngStyle",ft(36,Gp,"translateX(-"+(e.isBordered?6:3)+"px) translateY(-"+(e.isBordered?6:3)+"px)")),U(1),Qe("width",19,"px")("height",e.pixcelHeight+3,"px"),re("ngStyle",ft(38,Gp,"translateX("+(e.isBordered?6:3)+"px) translateY("+(e.isBordered?6:3)+"px)")),U(1),re("ngIf",!e.videoId),U(1),re("ngIf",e.videoId),U(1),re("ngIf",e.videoId&&!e.isSoundOnly),U(1),re("ngIf",!e.videoId||e.isSoundOnly)}}let vT=(()=>{class t{constructor(e,i,r){this.pointerDeviceService=e,this.contextMenuService=i,this.ngZone=r,this.animationType=0,this._imageFile=Ut.Empty,this._isVisible=!1,this._isEnd=!1,this.videoStateTransition=!1,this.isMinimize=!1,this.isBackyard=!1,this.isSecret=!1,this.isTest=!1,this.isIndicateSender=!1,this.sender="",this.videoId="",this.playListId="",this.cutInImageTransformOrigin="center",this._naturalWidth=0,this._naturalHeight=0,this._dragging=!1,this.audioPlayer=new Ft}get naturalWidth(){return this.videoId&&!this.isSoundOnly?480:this._naturalWidth}get naturalHeight(){return this.videoId&&!this.isSoundOnly?270:this._naturalHeight}ngOnInit(){ze.register(this).on("CHANGE_JUKEBOX_VOLUME",-100,e=>{this.videoPlayer&&this.videoPlayer.setVolume(this.videoVolume)}).on("PLAY_VIDEO_CUT_IN",-1e3,e=>{this.cutIn&&this.cutIn.identifier!=e.data.identifier&&this.videoId&&this.stop()})}ngOnDestroy(){ze.unregister(this,"UPDATE_AUDIO_RESOURE"),ze.unregister(this,"CHANGE_JUKEBOX_VOLUME"),ze.unregister(this,"PLAY_VIDEO_CUT_IN"),clearTimeout(this._timeoutId),clearTimeout(this._timeoutIdVideo)}get isPointerDragging(){return this._dragging}draggstart(){this.ngZone.run(()=>{this._dragging=!0})}draggend(){this.ngZone.run(()=>{this._dragging=!1})}get isVisible(){return this.cutIn&&this._isVisible}set isVisible(e){this._isVisible=e}get isEnd(){return!this.cutIn||this._isEnd}get cutInImage(){if(!this.cutIn)return this._imageFile;if(this._imageFile.identifier!==this.cutIn.imageIdentifier){let e=Nt.instance.get(this.cutIn.imageIdentifier);this._imageFile=e||Ut.Empty}return this._imageFile}get pixcelWidthPreAdjust(){if(this.isMinimize)return t.MIN_SIZE;let e=0;return this.cutIn&&(e=this.cutIn.width<=0&&this.cutIn.height<=0?this.naturalWidth:this.cutIn.width<=0?document.documentElement.offsetHeight*this.cutIn.height*(this.naturalWidth/this.naturalHeight)/100:document.documentElement.clientWidth*this.cutIn.width/100),e}get pixcelWidth(){let e=this.pixcelWidthPreAdjust;return(this.cutIn.isPreventOutBounds||this.videoId)&&(this.isAjustAspect?this.isAjustAspectWidth?e=document.documentElement.clientWidth:e*=document.documentElement.offsetHeight/this.pixcelHeightPreAdjust:e>document.documentElement.clientWidth&&(e=document.documentElement.clientWidth)),!this.isMinimize&&(this.cutIn.width<=0||this.cutIn.height<=0)&&this.pixelWidthAspectMinimun>e?e=this.pixelWidthAspectMinimun:e<t.MIN_SIZE&&(e=t.MIN_SIZE),e}get pixcelHeightPreAdjust(){if(this.isMinimize)return t.MIN_SIZE;let e=0;return this.cutIn&&(e=this.cutIn.width<=0&&this.cutIn.height<=0?this.naturalHeight:this.cutIn.height<=0?document.documentElement.clientWidth*this.cutIn.width*(this.naturalHeight/this.naturalWidth)/100:document.documentElement.offsetHeight*this.cutIn.height/100),e}get pixelWidthAspectMinimun(){let e=t.MIN_SIZE;return this.cutIn&&this.naturalWidth>this.naturalHeight&&(e=t.MIN_SIZE*this.naturalWidth/this.naturalHeight),e}get pixcelHeight(){let e=this.pixcelHeightPreAdjust;return(this.cutIn.isPreventOutBounds||this.videoId)&&(this.isAjustAspect?this.isAjustAspectWidth?e*=document.documentElement.offsetWidth/this.pixcelWidthPreAdjust:e=document.documentElement.offsetHeight:e>document.documentElement.offsetHeight&&(e=document.documentElement.offsetHeight)),!this.isMinimize&&(this.cutIn.width<=0||this.cutIn.height<=0)&&this.pixelHeightAspectMinimun>e?e=this.pixelHeightAspectMinimun:e<t.MIN_SIZE&&(e=t.MIN_SIZE),e}get pixelHeightAspectMinimun(){let e=t.MIN_SIZE;return this.cutIn&&this.naturalWidth<this.naturalHeight&&(e=t.MIN_SIZE*this.naturalHeight/this.naturalWidth),e}get isAjustAspect(){return(this.cutIn.width<=0||this.cutIn.height<=0)&&(this.pixcelWidthPreAdjust>document.documentElement.clientWidth||this.pixcelHeightPreAdjust>document.documentElement.offsetHeight)}get isAjustAspectWidth(){const e=this.pixcelWidthPreAdjust;return e>document.documentElement.clientWidth?!(document.documentElement.offsetHeight<this.pixcelHeightPreAdjust*(document.documentElement.clientWidth/e)):(document,!1)}get pixcelPosX(){let e=0;if(!this.cutIn)return e;if(e=document.documentElement.clientWidth*this.cutIn.posX/100-this.pixcelWidth/2,this.cutIn.isPreventOutBounds||this.videoId){const i=this.pixcelWidth/2-document.documentElement.clientWidth*this.cutIn.posX/100;i>0&&(e+=i);const r=-(document.documentElement.clientWidth-document.documentElement.clientWidth*this.cutIn.posX/100-this.pixcelWidth/2);r>0&&(e-=r)}return e}get pixcelPosY(){let e=0;if(!this.cutIn)return e;if(e=document.documentElement.offsetHeight*this.cutIn.posY/100-this.pixcelHeight/2,this.cutIn.isPreventOutBounds||this.videoId){const i=this.pixcelHeight/2-document.documentElement.offsetHeight*this.cutIn.posY/100;i>0&&(e+=i);const r=-(document.documentElement.offsetHeight-document.documentElement.offsetHeight*this.cutIn.posY/100-this.pixcelHeight/2);r>0&&(e-=r)}return e}get zIndex(){return!this.cutIn||this.isBackyard?0:(this.cutIn.isFrontOfStand||this.videoId?15e5:5e5)+this.cutIn.zIndex+(this.videoId?1e3:0)}get objectFit(){return this.cutIn?this.isMinimize||this.videoId&&!this.isSoundOnly||2==this.cutIn.objectFitType?"contain":1==this.cutIn.objectFitType?"cover":"fill":"none"}get videoVolume(){return 100*(this.isTest?Ft.auditionVolume:Ft.volume)}get isBordered(){return this.cutIn&&this.cutIn.borderStyle>0}get isSoundOnly(){return this.cutIn&&this.cutIn.isSoundOnly}get senderName(){let e="";if(!this.sender)return e;let i=We.findByPeerId(this.sender);return i instanceof We&&(e=i.name),e}get isMine(){return this.sender===We.myCursor.peerId}get senderColor(){let e=We.CHAT_DEFAULT_COLOR;if(!this.sender)return e;let i=We.findByPeerId(this.sender);return i instanceof We&&(e=i.color),e}play(){this.isEnd||(this._isVisible?this.cutIn.videoId||this.audioPlayer.play():(this.ngZone.run(()=>{this._isVisible=!0,this.cutIn.videoId||this._play()}),this.cutIn.duration>0&&(this._timeoutId=setTimeout(()=>{this.stop(),clearTimeout(this._timeoutId),this._timeoutId=null},1e3*this.cutIn.duration))))}_play(){if(this.isEnd)return;const e=zt.instance.get(this.cutIn.audioIdentifier);e&&e.isReady?(this.audioPlayer.volumeType=this.isTest?Ka.AUDITION:Ka.MASTER,this.audioPlayer.loop=this.cutIn.isLoop,this.cutIn.videoId||this.audioPlayer.play(e)):ze.register(this).on("UPDATE_AUDIO_RESOURE",-100,i=>{this.cutIn.videoId||this._play()})}pause(){this.cutIn.videoId||this.audioPlayer.pause()}stop(){ze.unregister(this,"UPDATE_AUDIO_RESOURE"),this.ngZone.run(()=>{this._isVisible=!1,this._dragging=!1,this.audioPlayer.stop()})}end(){this._isEnd=!0,this.audioPlayer.stop()}onImageLoad(){this._naturalWidth=this.cutInImageElement.nativeElement.naturalWidth,this._naturalHeight=this.cutInImageElement.nativeElement.naturalHeight}onPlayerReady(e){e.target.setVolume(this.videoVolume),e.target.playVideo()}onPlayerStateChange(e){const i=e.data;1==i&&(this.videoStateTransition=!0,this._timeoutIdVideo=setTimeout(()=>{this.ngZone.run(()=>{this.videoStateTransition=!1,this._timeoutIdVideo=null})},200),this.cutIn&&ze.trigger("PLAY_VIDEO_CUT_IN",{identifier:this.cutIn.identifier})),2==i&&(this.videoStateTransition=!0,this._timeoutIdVideo=setTimeout(()=>{this.ngZone.run(()=>{this.videoStateTransition=!1,this._timeoutIdVideo=null})},200)),5==i&&(this.videoStateTransition=!0,this._timeoutIdVideo=setTimeout(()=>{this.ngZone.run(()=>{this.videoStateTransition=!1,this._timeoutIdVideo=null})},200))}onErrorFallback(){console.log("fallback"),this.videoId&&(this.cutInImageElement.nativeElement.src="https://img.youtube.com/vi/"+this.videoId+"/default.jpg")}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:"\u9589\u3058\u308b\uff08\u81ea\u5206\u306e\u307f\u505c\u6b62\uff09",action:()=>{this.stop()},default:!0,selfOnly:!0},kt,{name:(this.isIndicateSender?"\u2611":"\u2610")+"\u9001\u4fe1\u8005\u3092\u8868\u793a",action:()=>{this.isIndicateSender=!this.isIndicateSender},selfOnly:!0},{name:(this.isBackyard?"\u2611":"\u2610")+"\u30a6\u30a3\u30f3\u30c9\u30a6\u306e\u80cc\u5f8c\u306b\u8868\u793a",action:()=>{this.isBackyard=!this.isBackyard},selfOnly:!0},{name:(this.isMinimize?"\u2611":"\u2610")+"\u6700\u5c0f\u5316",action:()=>{this.isMinimize=!this.isMinimize},selfOnly:!0}],this.cutIn.name)}}return t.MIN_SIZE=250,t.\u0275fac=function(e){return new(e||t)(He(fi),He(lr),He(Cn))},t.\u0275cmp=Xt({type:t,selectors:[["cut-in"]],viewQuery:function(e,i){if(1&e&&(cn(_7,5),cn(m7,5)),2&e){let r;ln(r=un())&&(i.cutInImageElement=r.first),ln(r=un())&&(i.videoPlayer=r.first)}},hostBindings:function(e,i){1&e&&Ae("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{cutIn:"cutIn",animationType:"animationType"},decls:7,vars:5,consts:[["appDraggable","","class","container","style","position: absolute",3,"draggable.allowOverHalf","draggable.unhandle","width","height","left","top","z-index","pointer-events","ngClass","dblclick","mousedown","mouseup","mouseleave","mouseout","mousemove",4,"ngIf"],["image",""],["appDraggable","",1,"container",2,"position","absolute",3,"draggable.allowOverHalf","draggable.unhandle","ngClass","dblclick","mousedown","mouseup","mouseleave","mouseout","mousemove"],["cutInContainerElement",""],[4,"ngTemplateOutlet"],["class","test-indicator grow left-top",4,"ngIf"],["class","test-indicator grow right-top",4,"ngIf"],["class","test-indicator grow left-bottom",4,"ngIf"],["class","test-indicator grow right-bottom",4,"ngIf"],["class","secret-indicator grow left-top",4,"ngIf"],["class","secret-indicator grow right-bottom","style","text-align: right",4,"ngIf"],["class","name-indicator grow right-top","style","text-align: right",4,"ngIf"],["class","name-indicator grow left-bottom",4,"ngIf"],[1,"handler","top",3,"ngStyle","contextmenu"],[1,"handler","bottom",3,"ngStyle","contextmenu"],[1,"handler","left",3,"ngStyle","contextmenu"],[1,"handler","right",3,"ngStyle","contextmenu"],["style","pointer-events: auto","class","handler",3,"width","height","contextmenu",4,"ngIf"],["style","position: absolute; pointer-events: auto","suggestedQuality","default",3,"visibility","videoId","width","height","playerVars","ready","stateChange",4,"ngIf"],["style","pointer-events: auto","draggable","false",3,"object-fit","src","error",4,"ngIf"],["style","pointer-events: none","draggable","false",3,"object-fit","src","load","contextmenu",4,"ngIf"],[1,"test-indicator","grow","left-top"],[1,"test-indicator","grow","right-top"],[1,"test-indicator","grow","left-bottom"],[1,"test-indicator","grow","right-bottom"],[1,"secret-indicator","grow","left-top"],[1,"material-icons",2,"font-size","smaller"],[1,"secret-indicator","grow","right-bottom",2,"text-align","right"],[1,"name-indicator","grow","right-top",2,"text-align","right"],[2,"display","inline-block","white-space","nowrap","overflow","hidden","text-overflow","ellipsis"],[1,"name-indicator","grow","left-bottom"],[1,"handler",2,"pointer-events","auto",3,"contextmenu"],["suggestedQuality","default",2,"position","absolute","pointer-events","auto",3,"videoId","width","height","playerVars","ready","stateChange"],["videoPlayerComponent",""],["draggable","false",2,"pointer-events","auto",3,"src","error"],["cutInImageElement",""],["draggable","false",2,"pointer-events","none",3,"src","load","contextmenu"]],template:function(e,i){1&e&&(Te(0,v7,3,25,"div",0),Te(1,y7,3,25,"div",0),Te(2,x7,3,25,"div",0),Te(3,E7,3,25,"div",0),Te(4,S7,3,25,"div",0),Te(5,j7,16,40,"ng-template",null,1,Un)),2&e&&(re("ngIf",i.isVisible&&-1==i.animationType),U(1),re("ngIf",i.isVisible&&0==i.animationType),U(1),re("ngIf",i.isVisible&&1==i.animationType),U(1),re("ngIf",i.isVisible&&2==i.animationType),U(1),re("ngIf",i.isVisible&&3==i.animationType))},directives:[bn,X0,Yn,Sl,Ji,mT],pipes:[ai],styles:[".container[_ngcontent-%COMP%]{margin:0;padding:0}.container.video[_ngcontent-%COMP%]{background-color:#000}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}img[_ngcontent-%COMP%]{margin:0;padding:0;width:100%;height:100%}.container[_ngcontent-%COMP%]:hover{outline:3px dotted #22F}.container.minimaize[_ngcontent-%COMP%]{outline:3px solid #22F}.container.is-bordered[_ngcontent-%COMP%]{border:3px ridge #dde}.container.is-bordered[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:1px solid black;box-sizing:border-box}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.test-indicator[_ngcontent-%COMP%]{position:absolute;pointer-events:none;z-index:5;color:#00f;font-size:smaller;padding:0 3px 1px;font-weight:bolder}.secret-indicator[_ngcontent-%COMP%]{position:absolute;pointer-events:none;z-index:5;color:gray;font-size:smaller;padding:0 3px 2px;font-weight:bolder;opacity:.6}.name-indicator[_ngcontent-%COMP%]{position:absolute;pointer-events:none;z-index:10;padding:0 3px 0 6px;font-weight:bolder;font-size:smaller}.left-top[_ngcontent-%COMP%]{left:0;top:0}.left-bottom[_ngcontent-%COMP%]{left:0;bottom:0}.right-top[_ngcontent-%COMP%]{right:0;top:0}.right-bottom[_ngcontent-%COMP%]{right:0;bottom:0}.handler[_ngcontent-%COMP%]{position:absolute;z-index:20;pointer-events:auto}.handler.top[_ngcontent-%COMP%]{top:0;left:0}.handler.bottom[_ngcontent-%COMP%]{bottom:0;right:0}.handler.left[_ngcontent-%COMP%]{top:0;left:0}.handler.right[_ngcontent-%COMP%]{right:0;bottom:0}"],data:{animation:[Sn("cutInNone",[Lt("void => *",[Rt("10ms ease-in",sn([et({opacity:0,offset:0}),et({opacity:1,offset:1})]))]),Lt("* => void",[Rt("10ms ease-in",sn([et({opacity:0,offset:1})]))])]),Sn("cutInFadeInOut",[Lt("void => *",[Rt("330ms ease-in",sn([et({opacity:0,offset:0}),et({opacity:1,offset:1})]))]),Lt("* => void",[Rt("330ms ease-in",sn([et({opacity:1,offset:0}),et({opacity:0,offset:1})]))])]),Sn("cutInBounceInOut",[Lt("void => *",[Rt("600ms ease",sn([et({transform:"scale3d(0, 0, 0)",offset:0}),et({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),et({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),et({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),et({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Lt("* => void",[Rt(100,et({transform:"scale3d(0, 0, 0)"}))])]),Sn("cutInOpenInOut",[Lt("void => *",[Rt("262ms ease",sn([et({opacity:0,transform:"scale3d(0, 1.0, 1.0)",offset:0}),et({opacity:1,transform:"scale3d(1.1, 1.0, 1.0)",offset:.875}),et({opacity:1,transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Lt("* => void",[Rt(100,et({opacity:0,transform:"scale3d(0, 1.0, 1.0)"}))])]),Sn("cutInOpenInOut2",[Lt("void => *",[Rt("262ms ease",sn([et({opacity:0,transform:"scale3d(1.0, 0, 1.0)",offset:0}),et({opacity:1,transform:"scale3d(1.0, 1.1, 1.0)",offset:.875}),et({opacity:1,transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Lt("* => void",[Rt(100,et({opacity:0,transform:"scale3d(1.0, 0, 1.0)"}))])])]}}),t})(),qp=(()=>{class t{constructor(){}static nowShowingIdentifiers(){return this.cutInComponentRefQueue.filter(e=>e&&e.instance&&e.instance.cutIn&&e.instance.isVisible).map(e=>e.instance.cutIn.identifier)}play(e,i=!1,r=!1,s=null){if(!e)return;for(const a of t.cutInComponentRefQueue)if(a&&a.instance){const h=a.instance;if(h.isEnd)a.destroy();else{const w=h.cutIn;(e.identifier===w.identifier||e.videoId&&w.videoId||null!=e.tag&&""!=e.tag.trim()&&null!=w.tag&&""!=w.tag.trim()&&rt.toHalfWidth(e.tag).toUpperCase().trim()==rt.toHalfWidth(w.tag).toUpperCase().trim())&&h.stop()}}t.cutInComponentRefQueue=t.cutInComponentRefQueue.filter(a=>a&&a.instance);const o=t.defaultParentViewContainerRef.createComponent(vT);o.instance.cutIn=e,o.instance.animationType=e.animationType,o.instance.videoId=e.videoId,o.instance.playListId=e.playListId,o.instance.isSecret=i,o.instance.isTest=r,o.instance.sender=s,o.instance.play(),t.cutInComponentRefQueue.push(o)}stop(e){if(e){e instanceof xi&&(e=e.identifier);for(const i of t.cutInComponentRefQueue)if(i&&i.instance){const r=i.instance;r.isEnd?i.destroy():e===r.cutIn.identifier&&r.stop()}t.cutInComponentRefQueue=t.cutInComponentRefQueue.filter(i=>i&&i.instance)}}}return t.cutInComponentRefQueue=[],t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=rn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),xi=class extends Vn{constructor(){super(...arguments),this.name="",this.tag="",this.duration=6,this.width=0,this.height=0,this.posX=50,this.posY=50,this.zIndex=0,this.objectFitType=0,this.animationType=0,this.borderStyle=0,this.isFrontOfStand=!1,this.isPreventOutBounds=!1,this.imageIdentifier=Ut.Empty.identifier,this.isVideoCutIn=!1,this.videoUrl="",this.isSoundOnly=!1,this.audioFileName="",this.audioIdentifier="",this.isLoop=!1}get videoId(){if(!this.isVideoCutIn||!this.videoUrl)return"";let n="";if(!rt.validUrl(this.videoUrl))return"";{const e=new URL(this.videoUrl).hostname;if("youtube.com"==e||"www.youtube.com"==e){let i=this.videoUrl.split("v=");i[1]&&(n=encodeURI(i[1].split(/[\?\&\#\/]/)[0]))}else{if("youtu.be"!=e)return"";{let i=this.videoUrl.split("youtu.be/");i[1]&&(n=encodeURI(i[1].split(/[\?\&\#\/]/)[0]))}}}return n.replace(/[\<\>\/\:\s\r\n]/g,"")}get videoStart(){if(!this.isVideoCutIn||!this.videoUrl||!this.videoId)return null;const n=/[\&\?](?:start|t)\=([\dhms]+)/i.exec(this.videoUrl);return n&&n[1]?this._sec(n[1]):null}_sec(n){if(!n)return null;let e=null;if(e=/^(\d+)$/.exec(n))return e[1];if(e=/^(?:(\d+)h)?(?:(\d+)m)?(?:(\d+)s)?$/i.exec(n)){let i=0;return e[1]&&(i+=60*+e[1]*60),e[2]&&(i+=60*+e[2]),e[3]&&(i+=+e[3]),""+i}return null}get playListId(){if(!this.isVideoCutIn||!this.videoId)return"";let n="";if(!rt.validUrl(this.videoUrl))return"";{let e=this.videoUrl.split("list=");e[1]&&(n=encodeURI(e[1].split(/[\&\#\/]/)[0]))}return n.replace(/[\<\>\/\:\s\r\n]/g,"")}get isValidAudio(){return 0==this.audioFileName.length||0==this.audioIdentifier.length||!!zt.instance.get(this.audioIdentifier)}get postfixes(){return null==this.value||""==(this.value+"").trim()?[]:Array.from(new Set(this.value.split(/[\r\n]+/g).map(n=>null!=n?n.trimRight():""))).filter(n=>""!=n)}get isPlayingNow(){return qp.nowShowingIdentifiers().includes(this.identifier)}};var Hs;$e([at()],xi.prototype,"name",void 0),$e([at()],xi.prototype,"tag",void 0),$e([at()],xi.prototype,"duration",void 0),$e([at()],xi.prototype,"width",void 0),$e([at()],xi.prototype,"height",void 0),$e([at()],xi.prototype,"posX",void 0),$e([at()],xi.prototype,"posY",void 0),$e([at()],xi.prototype,"zIndex",void 0),$e([at()],xi.prototype,"objectFitType",void 0),$e([at()],xi.prototype,"animationType",void 0),$e([at()],xi.prototype,"borderStyle",void 0),$e([at()],xi.prototype,"isFrontOfStand",void 0),$e([at()],xi.prototype,"isPreventOutBounds",void 0),$e([at()],xi.prototype,"imageIdentifier",void 0),$e([at()],xi.prototype,"isVideoCutIn",void 0),$e([at()],xi.prototype,"videoUrl",void 0),$e([at()],xi.prototype,"audioFileName",void 0),$e([at()],xi.prototype,"audioIdentifier",void 0),$e([at()],xi.prototype,"isLoop",void 0),xi=$e([ni("cut-in")],xi);let _o=Hs=class extends Vn{static get instance(){return Hs._instance||(Hs._instance=new Hs("CutInList"),Hs._instance.initialize()),Hs._instance}get cutIns(){return this.children}addCutIn(...n){let e=null;if(n[0]instanceof xi)e=n[0];else{let i=n[0];e=new xi(n[1]),e.name=i,e.initialize()}return this.appendChild(e)}parseInnerXml(n){for(let i of Hs.instance.children)i.destroy();let e=Hs.instance.toContext();e.syncData=this.toContext().syncData,Hs.instance.apply(e),Hs.instance.update(),super.parseInnerXml.apply(Hs.instance,[n]),this.destroy()}matchCutInInfo(n){n=rt.toHalfWidth(n).toUpperCase().trimRight();let e="",i=new Map;const r=[];for(const a of this.cutIns.map(h=>[Math.random(),h]).sort((h,w)=>h[0]-w[0]).map(h=>h[1])){if(!a)continue;let h=!1;for(const w of a.postfixes)n.endsWith(rt.toHalfWidth(w).toUpperCase().trimRight())&&(h=!0,("@"==w.slice(0,1)||"\uff20"==w.slice(0,1))&&e.length<w.length&&(e=w));if(h){const w=a.tag;null!=w&&w.trim().length>0?i.set(rt.toHalfWidth(w).toUpperCase().trim(),a):r.push(a)}}r.push(...i.values());const o=r.map(a=>[Math.random(),a]).sort((a,h)=>a[0]-h[0]);return{names:o.map(a=>a[1].name),identifiers:o.map(a=>a[1].identifier),matchMostLongText:e}}};var fn;_o=Hs=$e([ni("cut-in-list")],_o);let Gn=fn=class extends Ga{constructor(n,e=null){super(n),this.chatMessageService=e}onStoreAdded(){var n=this;super.onStoreAdded(),ze.register(this).on("SEND_MESSAGE",function(){var e=(0,tn.Z)(function*(i){const r=dt.instance.get(i.data.messageIdentifier);if(!r||!r.isSendFromSelf||r.isSystem||r.isOperationLog)return;const s=rt.toHalfWidth(r.text).replace("\u200b","");let o=r.tag.replace("noface","").trim();o=o||"DiceBot";try{const a=/^((srepeat|repeat|srep|rep|sx|x)?(\d+)?[ \u3000]+)?([^\n]*)?/gi.exec(s),h=a[2],w=h&&0===h.toUpperCase().indexOf("S"),X=null!=a[3]?Number(a[3]):1;let fe=null!=a[4]?a[4]:s;if(!fe||X<=0)return;let pe={id:"DiceBot",result:"",isSecret:!1,isDiceRollTable:!1,isEmptyDice:!0,isSuccess:!1,isFailure:!0,isCritical:!1,isFumble:!1},we=!1;for(const Ie of go.instance.diceRollTables){if(null==Ie.command)continue;let Pe=!1,Be=0,Le="",Fe=!1;const Ve=rt.toHalfWidth(Ie.command.replace(/[\u2015\u30fc\u2014\u2010]/g,"-").trim()).toUpperCase(),Ge=rt.toHalfWidth(fe.replace(/[\u2015\u30fc\u2014\u2010]/g,"-").trim()).toUpperCase();if(!Ge.startsWith("S"+Ve)||Ge[("S"+Ve).length]&&!/[ \=\+\-]/.test(Ge.charAt(("S"+Ve).length))?Ge.startsWith(Ve)&&(!Ge[Ve.length]||/[ \=\+\-]/.test(Ge.charAt(Ve.length)))&&(we=!0,Ge[Ve.length]&&" "!=Ge[Ve.length]&&(Le=Ge.substring(Ve.length))):(we=!0,Pe=!0,Ge[("S"+Ve).length]&&" "!=Ge[("S"+Ve).length]&&(Le=Ge.substring(("S"+Ve).length))),Le)if(Le=Le.split(" ")[0],/^[\+\-]\d+$/.test(Le))Be=+Le,Le=` (\u4fee\u6b63${Le})`;else{if(!/^\=\-?\d+$/.test(Le)){we=!1;continue}Fe=!0}if(we){pe.isFailure=!1,pe.isDiceRollTable=!0,pe.tableName=Ie.name&&Ie.name.length>0?Ie.name:"(\u7121\u540d\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868)",pe.isSecret=Pe||w;const ct=Ie.parseText();for(let ut=0;ut<X&&ut<32;ut++){let st=null,yt=yield fn.diceRollAsync(Fe?`C(${Le.substring(1)})`:rt.toHalfWidth(Ie.dice).replace(/[\u216e\xd0]/g,"D").replace(/\\xd7/g,"*").replace(/\\xf7/g,"/").replace(/[\u2015\u30fc\u2014\u2010]/g,"-"),"DiceBot",1);pe.isEmptyDice=pe.isEmptyDice&&yt.isEmptyDice,yt.result&&(yt.result=n.formatRollResult(yt.result));let nt=null;yt.result.length>0&&(nt=yt.result.match(/\s\u2192\s(?:\u6210\u529f\u6570|\u8a08\u7b97\u7d50\u679c)?(\-?\d+)$/))&&(st=+nt[1]);let lt=!1;if(null!=st)for(const gt of ct)if((null===gt.range.start||gt.range.start<=st+Be)&&(null===gt.range.end||st+Be<=gt.range.end)){pe.result+=Fe?"\u6307\u5b9a="+st+"\n"+rt.cr(gt.result):yt.result+Le+(Le?` \u2192 ${st+Be}`:"")+"\n"+rt.cr(gt.result),lt=!0;break}lt||(pe.result+=null==st?"\uff08\u30a8\u30e9\u30fc\uff1a\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u304b\u3089\u6570\u5b57\u304c\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\uff09\n(\u7d50\u679c\u306a\u3057)":Fe?"\u6307\u5b9a="+st+"\n(\u7d50\u679c\u306a\u3057)":yt.result+Le+(Le?` \u2192 ${st+Be}`:"")+"\n(\u7d50\u679c\u306a\u3057)"),1<X&&(pe.result+=` #${ut+1}`),ut<X-1&&(pe.result+="\n")}break}}if(!we){if(!fn.apiUrl&&!(yield fn.loadGameSystemAsync(o)).COMMAND_PATTERN.test(fe))return;let Pe,Ie=!1;if((Pe=/^(S?CHOICE\d*)[ \u3000]+([^ \u3000]*)/gi.exec(fe.trim()))&&(fe=fe.trim().replace(/[\u3000\s]+/g," "),Ie=!0),Ie||((Pe=/^(S?CHOICE\d*\[[^\[\]]+\])/gi.exec(fe.trim()))||(Pe=/^(S?CHOICE\d*\([^\(\)]+\))/gi.exec(fe.trim())))&&(go.instance.diceRollTables.map(Be=>Be.command).some(Be=>null!=Be&&Be.trim().toUpperCase()===Pe[1].toUpperCase())||(fe=Pe[1],Ie=!0)),Ie||(fe=fe.trim().split(/\s+/)[0].replace(/[\u216e\xd0]/g,"D").replace(/\\xd7/g,"*").replace(/\\xf7/g,"/").replace(/[\u2015\u30fc\u2014\u2010]/g,"-")),fn.apiUrl){if(!Ie&&!/choice\d*\[.*\]/i.test(fe)&&!/^[a-zA-Z0-9!-/:-@\xa5[-`{-~\}]+$/.test(fe))return;pe=yield fn.diceRollAsync(fe,o,X),pe.isSecret=pe.isSecret||w}else for(let Be=0;Be<X&&Be<32;Be++){let Le=yield fn.diceRollAsync(fe,o,X);if(Le.result.length<1)break;pe.id=Le.id,pe.result+=Le.result,pe.isSecret=pe.isSecret||Le.isSecret||w,pe.isEmptyDice=pe.isEmptyDice&&Le.isEmptyDice,pe.isSuccess=pe.isSuccess||Le.isSuccess,pe.isFailure=pe.isFailure&&Le.isFailure,pe.isCritical=pe.isCritical||Le.isCritical,pe.isFumble=pe.isFumble||Le.isFumble,1<X&&(pe.result+=` #${Be+1}\n`)}}if(!pe.result)return;pe.result=pe.result.trimRight(),n.sendResultMessage(pe,r)}catch(a){console.error(a)}});return function(i){return e.apply(this,arguments)}}())}onStoreRemoved(){super.onStoreRemoved(),ze.unregister(this)}sendResultMessage(n,e){let i=n.id.split(":")[0],r=n.result;const s=n.isSecret,o=n.isEmptyDice,a=n.isSuccess,h=n.isFailure,w=n.isCritical,X=n.isFumble;if(r.length<1)return;n.isDiceRollTable||(r=this.formatRollResult(r));let fe="system";s&&(fe+=" secret"),o&&(fe+=" empty"),a&&(fe+=" success"),h&&(fe+=" failure"),w&&(fe+=" critical"),X&&(fe+=" fumble");let pe={identifier:"",tabIdentifier:e.tabIdentifier,originFrom:e.from,from:n.isDiceRollTable?"Dice-Roll Table":fn.apiUrl?`BCDice-API(${fn.apiUrl})`:"System-BCDice",timestamp:e.timestamp+1,imageIdentifier:"",tag:fe,name:`${n.isDiceRollTable?n.tableName:i} : ${e.name}${s?" (Secret)":""}`,text:r,color:e.color,isUseStandImage:e.isUseStandImage},we="";const Ie=dt.instance.get(e.characterIdentifier);if(Ie instanceof Gt){const Le=Ie.standList.matchStandInfo(r,e.imageIdentifier);if(!s&&!e.standName&&e.isUseStandImage)if(Le.farewell){const Fe={characterIdentifier:Ie.identifier};if(e.to){const Ve=We.findByUserId(e.to);Ve&&(Ve.peerId!=We.myCursor.peerId&&ze.call("FAREWELL_STAND_IMAGE",Fe,Ve.peerId),ze.call("FAREWELL_STAND_IMAGE",Fe,We.myCursor.peerId))}else ze.call("FAREWELL_STAND_IMAGE",Fe)}else if(Le&&Le.standElementIdentifier){const Fe=dt.instance.get(Le.standElementIdentifier);if(Fe&&Fe.getFirstElementByName("conditionType")){const Ve=+Fe.getFirstElementByName("conditionType").value;if(Ve==Mi.Postfix||Ve==Mi.PostfixOrImage||Ve==Mi.PostfixAndImage){const Ge={characterIdentifier:Ie.identifier,standIdentifier:Le.standElementIdentifier,color:e.color,secret:!!e.to};if(Ge.secret){const ct=We.findByUserId(e.to);ct&&(ct.peerId!=We.myCursor.peerId&&ze.call("POPUP_STAND_IMAGE",Ge,ct.peerId),ze.call("POPUP_STAND_IMAGE",Ge,We.myCursor.peerId))}else ze.call("POPUP_STAND_IMAGE",Ge)}}}we=Le.matchMostLongText}const Pe=dt.instance.get(e.tabIdentifier),Be=_o.instance.matchCutInInfo(r);if(!s&&Pe.isUseStandImage&&Be){for(const Le of Be.identifiers){const Fe={identifier:Le,secret:!!e.to,sender:We.myCursor.peerId};if(Fe.secret){const Ve=We.findByUserId(e.to);Ve&&(Ve.peerId!=We.myCursor.peerId&&ze.call("PLAY_CUT_IN",Fe,Ve.peerId),ze.call("PLAY_CUT_IN",Fe,We.myCursor.peerId))}else ze.call("PLAY_CUT_IN",Fe)}if(Be.names&&Be.names.length&&!e.to&&this.chatMessageService){const Le=new Map;for(const Ve of Be.names){let Ge=Le.get(Ve)||0;Ge+=1,Le.set(""==Ve?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":Ve,Ge)}const Fe=`${[...Le.keys()].map(Ve=>Le.get(Ve)>1?`${Ve}\xd7${Le.get(Ve)}`:Ve).join("\u3001")}`;this.chatMessageService.sendOperationLog(Fe+" \u304c\u8d77\u52d5\u3057\u305f")}}we.length<Be.matchMostLongText.length&&(we=Be.matchMostLongText),we&&pe.text&&(pe.text=pe.text.slice(0,pe.text.length-we.length)),null!=e.to&&0<e.to.length&&(pe.to=e.to,e.to.indexOf(e.from)<0&&(pe.to+=" "+e.from)),Pe&&Pe.addMessage(pe)}static diceRollAsync(n,e,i=1){return(0,tn.Z)(function*(){if(e=e||"DiceBot",fn.apiUrl){const r=1==fn.apiVersion?fn.apiUrl+"/v1/diceroll?system="+(e?encodeURIComponent(e):"DiceBot")+"&command="+encodeURIComponent(n):`${fn.apiUrl}/v2/game_system/${e?encodeURIComponent(e):"DiceBot"}/roll?command=${encodeURIComponent(n)}`,s=[];for(let o=1;o<=i;o++)s.push(fetch(r,{mode:"cors"}).then(a=>{if(a.ok)return a.json();throw new Error(a.statusText)}).then(a=>({id:e,result:(1==fn.apiVersion?a.result:a.text)+(i>1?` #${o}\n`:""),isSecret:a.secret,isEmptyDice:1==fn.apiVersion?a.dices&&0==a.dices.length:a.rands&&0==a.rands.length,isSuccess:a.success,isFailure:a.failure,isCritical:a.critical,isFumble:a.fumble})).catch(a=>({id:e,result:"",isSecret:!1,isEmptyDice:!0})));return Promise.all(s).then(o=>o.reduce((a,h)=>({id:e,result:a.result+h.result,isSecret:a.isSecret||h.isSecret,isEmptyDice:a.isEmptyDice&&h.isEmptyDice,isSuccess:a.isSuccess||h.isSuccess,isFailure:a.isFailure&&h.isFailure,isCritical:a.isCritical||h.isCritical,isFumble:a.isFumble||h.isFumble}),{id:e,result:"",isSecret:!1,isEmptyDice:!0,isSuccess:!1,isFailure:!0,isCritical:!1,isFumble:!1}))}try{let r=yield fn.loadGameSystemAsync(e);const s=r.eval(n);return s?(console.log("diceRoll!!!",s),console.log("isSecret!!!",s.secret),console.log("isEmptyDice!!!",!s.rands||0==s.rands.length),{id:r.ID,result:s.text,isSecret:s.secret,isEmptyDice:!s.rands||0==s.rands.length,isSuccess:s.success,isFailure:s.failure,isCritical:s.critical,isFumble:s.fumble}):{id:e,result:"",isSecret:!1,isEmptyDice:!0}}catch(r){console.error(r)}return{id:e,result:"",isSecret:!1,isEmptyDice:!0}})()}static getHelpMessage(n){return(0,tn.Z)(function*(){if(n=n||"DiceBot",fn.apiUrl){const e=[fetch(1==fn.apiVersion?fn.apiUrl+"/v1/systeminfo?system=DiceBot":`${fn.apiUrl}/v2/game_system/DiceBot`,{mode:"cors"}).then(i=>i.json())];return n&&"DiceBot"!=n&&e.push(fetch(1==fn.apiVersion?fn.apiUrl+"/v1/systeminfo?system="+encodeURIComponent(n):`${fn.apiUrl}/v2/game_system/${encodeURIComponent(n)}`,{mode:"cors"}).then(i=>i.json())),Promise.all(e).then(i=>i.map(r=>1==fn.apiVersion&&r.systeminfo&&r.systeminfo.info?r.systeminfo.info.replace("\u90e8\u5c4b\u306e\u30b7\u30b9\u30c6\u30e0\u540d","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306a\u3069\u306e\u30b7\u30b9\u30c6\u30e0\u540d"):r.help_message?r.help_message.replace("\u90e8\u5c4b\u306e\u30b7\u30b9\u30c6\u30e0\u540d","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306a\u3069\u306e\u30b7\u30b9\u30c6\u30e0\u540d"):"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u60c5\u5831\u304c\u3042\u308a\u307e\u305b\u3093\u3002"))}{let e=[""];try{if(e=[(yield fn.loadGameSystemAsync("DiceBot")).HELP_MESSAGE],n&&""!=n&&"DiceBot"!=n){let i=yield fn.loadGameSystemAsync(n);e.push(i&&"DiceBot"!=i.ID&&i.HELP_MESSAGE?i.HELP_MESSAGE.replace("\u90e8\u5c4b\u306e\u30b7\u30b9\u30c6\u30e0\u540d","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306a\u3069\u306e\u30b7\u30b9\u30c6\u30e0\u540d"):"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u60c5\u5831\u304c\u3042\u308a\u307e\u305b\u3093\u3002")}}catch(i){console.error(i)}return e}})()}static loadGameSystemAsync(n){var e=this;return(0,tn.Z)(function*(){return yield fn.queue.add(()=>{const i=e.diceBotInfos.some(r=>r.id===n)?n:"DiceBot";try{return fn.loader.getGameSystemClass(i)}catch(r){return fn.loader.dynamicLoad(i)}})})()}static initializeDiceBotQueue(){let n=new sT("DiceBotQueue");return n.add((0,tn.Z)(function*(){fn.loader=new((yield Promise.resolve().then(me.bind(me,383))).default),fn.diceBotInfos=fn.loader.listAvailableGameSystems().filter(e=>"DiceBot"!=e.id).sort((e,i)=>{const r=e.sortKey,s=i.sortKey;return r<s?-1:r>s?1:0}).map(e=>{const i=/.+\:(.+)/.exec(e.id);let r;return i&&i[1]&&(r="ChineseTraditional"==i[1]?"\u6b63\u9ad4\u4e2d\u6587":"Korean"==i[1]?"\ud55c\uad6d\uc5b4":"English"==i[1]?"English":"Other"),{id:e.id,game:e.name,lang:r,sort_key:e.sortKey}})})),n}formatRollResult(n){return null==n?"":n.split("\n").map(e=>{let i=[],r=[],s=[],o=[];return e.split(" \uff1e ").map((a,h,w)=>{if(1===w.length)return a;if(0==h){const fe=fn.apiUrl&&1==fn.apiVersion?/^(?:\: )\((CHOICE(?:\d+)?[\[\( ].+)\)$/i:/^\((CHOICE(?:\d+)?[\[\( ].+)\)$/i,pe=a.match(fn.apiUrl&&1==fn.apiVersion?/^(?:\: )\(([A-Z\d\+\-\*\/=\(\),\[\]\<\>@]+)\)$/i:/^\(([A-Z\d\+\-\*\/=\(\),\[\]\<\>@]+)\)$/i)||a.match(fe);return pe&&!pe[1].toUpperCase().startsWith("CHOICE")&&(i=[...a.matchAll(/(?<diceCount>\d+)D\d+(?:(?<keepDrop>[KD][HL])(?<keepDropCount>\d+))?/gi)],i.length||(r=[...a.matchAll(/\d+B\d+(?:\+\d+B\d+)*(?:\[6\]Limit\[\d+\])?(?<sign><=|>=|<>|==|!=|<|>|=)(?<criteria>\d+)/gi)],r.length||(s=[...a.matchAll(/\d+R\d+(?:\+\d+R\d+)*\[(?<rerollSign><=|>=|<>|==|!=|<|>|=)?(?<rerollCriteria>\d+)\](?:(?<sign><=|>=|<>|==|!=|<|>|=)(?<criteria>\d+))?/gi)],s.length||(o=[...a.matchAll(/\d+U\d+(?:\+\d+U\d+)*\[(?<rerollCriteria>\d+)\](?<modifier>[\-+]\d+)?(?:(?<sign><=|>=|<>|==|!=|<|>|=)(?<criteria>\d+))?/gi)])))),pe?"\u{1f3b2}"+pe[1]:a}if(h==w.length-1)return a;if(1==h&&(i.length||r.length||s.length||o.length))try{let X=a;const pe=[...a.matchAll(i.length?/(?<total>\d+)\[(?<diceArrayString>\d+(?:,\d+)*)?\]/gi:o.length?/(?:(?<total>\d+)\[(?<diceArrayString>\d+(?:,\d+)*)?\])|(?<modifier2>[\-+]\d+)|(?<dieString>\d+)/gi:/(?<diceArrayString>\d+(?:,\d+)*)/gi)];if(pe.length){let Ie,we=0;pe.forEach((Pe,Be)=>{if(Ie=Pe[0],i.length){const{diceCount:Fe,keepDrop:Ve,keepDropCount:Ge}=i[Be].groups,{total:ct,diceArrayString:ut}=Pe.groups;if(Ve){const st=null!=ut?ut.split(",").sort((lt,gt)=>+lt-+gt):[],yt=Ve.startsWith("K")?Ge:Fe-Ge;("KH"===Ve||"DL"===Ve)&&st.reverse();const nt=st.map((lt,gt)=>gt+1<=yt?`${lt}`:`~~~${lt}~~~`);("DH"===Ve||"DL"===Ve)&&nt.reverse(),Ie=`${ct}[${nt.join(",")}]`}}else if(r.length){const{sign:Fe,criteria:Ve}=r[0].groups,{diceArrayString:Ge}=Pe.groups;Ie=Ge.split(",").map(ct=>fn.isPass(ct,Fe,Ve)?`${ct}`:`~~~${ct}~~~`).join(",")}else if(s.length){let{rerollSign:Fe,rerollCriteria:Ve,sign:Ge,criteria:ct}=s[0].groups;Fe||(Fe=Ge),Ve||(Ve=ct);const{diceArrayString:ut}=Pe.groups;Ie=ut.split(",").map(st=>fn.isPass(st,Fe,Ve)?`###${st}###`:st).map(st=>fn.isPass(st,Ge,ct,!1)?st:`~~~${st}~~~`).join(",")}else if(o.length){const{rerollCriteria:Fe,modifier:Ve,sign:Ge,criteria:ct}=o[0].groups,{total:ut,diceArrayString:st,modifier2:yt,dieString:nt}=Pe.groups;if(console.log(o[0],Pe),yt)Ie=` (${yt})`;else if(ut)Ie=ut+"["+st.split(",").map(lt=>fn.isPass(lt,">=",Fe)?`###${lt}###`:lt).join(",")+"]",fn.isPass(+ut+(Ve?+Ve:0),Ge,ct)||(Ie=`~~~${Ie}~~~`);else{let lt=Ie;Ie=fn.isPass(nt,">=",Fe)?`###${nt}###`:nt,fn.isPass(+lt+(Ve?+Ve:0),Ge,ct)||(Ie=`~~~${Ie}~~~`)}}const Le=X.indexOf(Pe[0],we);Ie!=Pe[0]&&(X=X.substring(0,Le)+Ie+X.substring(Le+Pe[0].length)),we=Le+Ie.length})}a=X}catch(X){console.error(X)}return a}).join(" \u2192 ")}).join("\n")}static isPass(n,e,i,r=!0){if(null==n)return r;let s=n.toString().match(/(\d+)/);s&&(n=s[1]);let o=r;switch(e){case"==":case"=":o=+n==+i;break;case"!=":case"<>":o=+n!=+i;break;case">=":o=+n>=+i;break;case"<=":o=+n<=+i;break;case"<":o=+n<+i;break;case">":o=+n>+i}return o}};function bT(t,n){if(Array.prototype.indexOf)return t.indexOf(n);for(var e=0,i=t.length;e<i;e++)if(t[e]===n)return e;return-1}function ql(t,n){for(var e=t.length-1;e>=0;e--)!0===n(t[e])&&t.splice(e,1)}function tv(t){throw new Error("Unhandled case for value: '".concat(t,"'"))}Gn.queue=fn.initializeDiceBotQueue(),Gn.loader=new U9.default,Gn.apiUrl=null,Gn.apiVersion=1,Gn.adminUrl=null,Gn.diceBotInfos=[],Gn.diceBotInfosIndexed=[],Gn.replaceData=[["\u65b0\u30af\u30c8\u30a5\u30eb\u30d5","\u30b7\u30f3\u30af\u30c8\u30a6\u30eb\u30d5\u30b7\u30f3\u30efTRPG","\u65b0\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG"],["\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG","\u30af\u30c8\u30a6\u30eb\u30d5\u30b7\u30f3\u30efTRPG","(\u65e7) \u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG"],["\ud06c\ud234\ub8e8","\ud06c\ud234\ub8e8\uc758 \ubd80\ub984 6\ud310","\ud06c\ud234\ub8e8\uc758 \ubd80\ub984 6\ud310"],["\u514b\u8607\u9b6f\u795e\u8a71","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c\u516d\u7248","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c\u516d\u7248"],["\u514b\u8607\u9b6f\u795e\u8a71\u7b2c7\u7248","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c7\u7248","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c\u4e03\u7248"],["\u30c0\u30d6\u30eb\u30af\u30ed\u30b92nd,3rd","\u30bf\u30d5\u30eb\u30af\u30ed\u30b9 The 2nd Edition/The 3rd Edtion","\u30c0\u30d6\u30eb\u30af\u30ed\u30b9 The 2nd Edition, The 3rd Edtion"],["\u30c8\u30fc\u30b0","\u30c8\u30aa\u30af","\u30c8\u30fc\u30b0\uff08TORG\uff09"],["\u30ef\u30fc\u30d7\u30b9","\u30ef\u30a2\u30d5\u30b9","WARPS"],["\u30c8\u30fc\u30b01.5\u7248","\u30c8\u30aa\u30af1.5\u30cf\u30f3","\u30c8\u30fc\u30b0\uff08TORG\uff09 1.5\u7248"],["\u30c8\u30fc\u30b0 \u30a8\u30bf\u30cb\u30c6\u30a3","\u30c8\u30aa\u30af\u30a8\u30bf\u30cb\u30c6\u30a4","\u30c8\u30fc\u30b0\uff08TORG\uff09 \u30a8\u30bf\u30cb\u30c6\u30a3"],["\u5fc3\u885d\u60f3\u6a5fTRPG\u30a2\u30eb\u30c8\u30ec\u30a4\u30ba","\u30b7\u30f3\u30b7\u30e8\u30a6\u30bd\u30a6\u30adTRPG\u30a2\u30eb\u30c8\u30ec\u30a4\u30b9","\u5fc3\u885d\u60f3\u6a5fTRPG \u30a2\u30eb\u30c8\u30ec\u30a4\u30ba"],["\u30d1\u30e9\u30b5\u30a4\u30c8\u30d6\u30e9\u30c3\u30c9RPG","\u30cf\u30e9\u30b5\u30a4\u30c8\u30d5\u30e9\u30c4\u30c8","\u30d1\u30e9\u30b5\u30a4\u30c8\u30d6\u30e9\u30c3\u30c9"],["\u72af\u7f6a\u6d3b\u5287RPG\u30d0\u30c3\u30c9\u30e9\u30a4\u30d5","\u30cf\u30f3\u30b5\u30a4\u30ab\u30c4\u30b1\u30adRPG\u30cf\u30c4\u30c8\u30e9\u30a4\u30d5","\u72af\u7f6a\u6d3b\u5287RPG\u30d0\u30c3\u30c9\u30e9\u30a4\u30d5"],["\u6643\u5929\u306e\u30a4\u30eb\u30fc\u30b8\u30aa","\u30b3\u30a6\u30c6\u30f3\u30ce\u30a4\u30eb\u30a6\u30b7\u30aa","\u6643\u5929\u306e\u30a4\u30eb\u30fc\u30b8\u30aa"],["\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb","\u30cf\u30af\u30eb\u30de\u30ce\u30c8\u30a6\u30ce\u30b9\u30ab\u30a4\u30ce\u30aa\u30c4","\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb"],["\u5728\u308a\u3066\u904d\u304f\u30aa\u30eb\u30ac\u30ec\u30a4\u30f3","\u30a2\u30ea\u30c6\u30a2\u30de\u30cd\u30af\u30aa\u30eb\u30ab\u30ec\u30a4\u30f3","\u5728\u308a\u3066\u904d\u304f\u30aa\u30eb\u30ac\u30ec\u30a4\u30f3"],["Pathfinder","\u30cf\u30b9\u30d5\u30a2\u30a4\u30f3\u30bf\u30a2RPG","\u30d1\u30b9\u30d5\u30a1\u30a4\u30f3\u30c0\u30fcRPG"],["\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG\u3000\u899a\u9192\u7de8","\u30b7\u30f3\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4TRPG\u30ab\u30af\u30bb\u30a4\u30d8\u30f3","\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG \u899a\u9192\u7bc7"],["\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG\u3000\u899a\u9192\u7bc7","\u30b7\u30f3\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4TRPG\u30ab\u30af\u30bb\u30a4\u30d8\u30f3","\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG \u899a\u9192\u7bc7"],["YearZeroEngine","\u30a4\u30e4\u30a2\u30bb\u30ed\u30a8\u30f3\u30b7\u30f3","Year Zero Engine"],["Year Zero Engine","\u30a4\u30e4\u30a2\u30bb\u30ed\u30a8\u30f3\u30b7\u30f3","Year Zero Engine"],["ADVANCED FIGHTING FANTASY 2nd Edition","\u30a2\u30c8\u30cf\u30f3\u30b9\u30c8\u30d5\u30a1\u30a4\u30c6\u30a4\u30f3\u30af\u30d5\u30a1\u30f3\u30bf\u30b7\u30a4\u30bf\u30a42\u30cf\u30f3","\u30a2\u30c9\u30d0\u30f3\u30b9\u30c8\u30fb\u30d5\u30a1\u30a4\u30c6\u30a3\u30f3\u30b0\u30fb\u30d5\u30a1\u30f3\u30bf\u30b8\u30fc \u7b2c2\u7248"],["Vampire: The Masquerade 5th Edition","\u30a6\u30a2\u30f3\u30cf\u30a4\u30a2\u30b5\u30de\u30b9\u30ab\u30ec\u30a8\u30c8\u30bf\u30a45\u30cf\u30f3","\u30f4\u30a1\u30f3\u30d1\u30a4\u30a2\uff1a\u30b6\u30fb\u30de\u30b9\u30ab\u30ec\u30fc\u30c9 \u7b2c5\u7248"],["\u30ef\u30fc\u30eb\u30c9\u30aa\u30d6\u30c0\u30fc\u30af\u30cd\u30b9","\u30ef\u30a2\u30eb\u30c8\u30aa\u30d5\u30bf\u30a2\u30af\u30cd\u30b9","\u30ef\u30fc\u30eb\u30c9\u30fb\u30aa\u30d6\u30fb\u30c0\u30fc\u30af\u30cd\u30b9"],["\u30e2\u30ce\u30c8\u30fc\u30f3\u30fb\u30df\u30e5\u30fc\u30b8\u30a2\u30e0","\u30e2\u30ce\u30c8\u30aa\u30f3\u30df\u30e6\u30a6\u30b7\u30a2\u30e0","\u30e2\u30ce\u30c8\u30fc\u30f3\u30df\u30e5\u30fc\u30b8\u30a2\u30e0"],["\u5263\u306e\u8857\u306e\u7570\u90a6\u4ebaTRPG","\u30c4\u30eb\u30ad\u30ce\u30de\u30c1\u30ce\u30a4\u30db\u30a6\u30b7\u30f3TRPG"],["\u58ca\u308c\u305f\u4e16\u754c\u306e\u30dd\u30b9\u30c8\u30de\u30f3","\u30b3\u30ef\u30ec\u30bf\u30bb\u30ab\u30a4\u30ce\u30db\u30b9\u30c8\u30de\u30f3","\u58ca\u308c\u305f\u4e16\u754c\u306e\u30dd\u30b9\u30c8\u30de\u30f3"],["\u7d2b\u7e1e\u306e\u30ea\u30f4\u30e9\u30c9\u30fc\u30eb","\u30b7\u30b7\u30de\u30ce\u30ea\u30d5\u30e9\u30c8\u30aa\u30eb","\u7d2b\u7e1e\u306e\u30ea\u30f4\u30e9\u30c9\u30fc\u30eb"],["SRS\u6c4e\u7528(\u6539\u9020\u7248)","\u30b9\u30bf\u30f3\u30bf\u30a2\u30c8RPG\u30b7\u30b9\u30c6\u30e0\u30aa\u30eb\u30bf\u30ca\u30c6\u30a4\u30d5\u30cf\u30f3","SRS\u6c4e\u7528 \u30aa\u30eb\u30bf\u30ca\u30c6\u30a3\u30f4"],["Standard RPG System","\u30b9\u30bf\u30f3\u30bf\u30a2\u30c8RPG\u30b7\u30b9\u30c6\u30e0","\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0\uff08SRS\uff09"],["\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0","\u30b9\u30bf\u30f3\u30bf\u30a2\u30c8RPG\u30b7\u30b9\u30c6\u30e0","\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0\uff08SRS\uff09"],["NJSLYRBATTLE","\u30cb\u30f3\u30b7\u30e4\u30b9\u30ec\u30a4\u30e4\u30a2\u30cf\u30c8\u30eb"],["Record of Steam","\u30ec\u30b3\u30aa\u30c8\u30aa\u30d5\u30b9\u30c1\u30a4\u30e0"],["\u8a69\u7247\u306e\u30a2\u30eb\u30bb\u30c3\u30c8","\u30a6\u30bf\u30ab\u30bf\u30ce\u30a2\u30eb\u30bb\u30c4\u30c8"],["Shared\u2020Fantasia","\u30b7\u30a8\u30a2\u30a2\u30c8\u30d5\u30a2\u30f3\u30bf\u30b7\u30a2"],["\u771f\u30fb\u5973\u795e\u8ee2\u751f","\u30b7\u30f3\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4"],["\u5973\u795e\u8ee2\u751f","\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4"],["\u899a\u9192\u7bc7","\u30ab\u30af\u30bb\u30a4\u30d8\u30f3"],["Chill","\u30c1\u30eb"],["BBNTRPG","\u30d2\u30a4\u30d2\u30a4\u30a8\u30ccTRPG","BBNTRPG (Black Black Network TRPG)"],["TORG Eternity","\u30c8\u30aa\u30af\u30a8\u30bf\u30a2\u30cb\u30c6\u30a4"],["\u30ac\u30fc\u30d7\u30b9","\u30ab\u30a2\u30d5\u30b9","GURPS"],["\u30ac\u30fc\u30d7\u30b9\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba","\u30ab\u30a2\u30d5\u30b9\u30d5\u30a4\u30eb\u30c8\u30a6\u30a4\u30b9","GURPS\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba"],["\u7d76\u5bfe\u96b7\u5974","\u30bb\u30c4\u30bf\u30a4\u30ec\u30a4\u30c8"],["\u30bb\u30e9\u30d5\u30a3\u30b6\u30a4\u30f3","\u30bb\u30a4\u30b7\u30e6\u30f3\u30b7\u30c4\u30ab\u30f3TRPG\u30bb\u30e9\u30d5\u30a4\u30b5\u30a4\u30f3","\u9752\u6625\u75be\u60a3TRPG \u30bb\u30e9\u30d5\u30a3\u30b6\u30a4\u30f3"],["\u8266\u3053\u308c","\u30ab\u30f3\u30b3\u30ec"],["\u795e\u6211\u72e9","\u30ab\u30df\u30ab\u30ab\u30ea"],["\u9d7a\u93e1","\u30cc\u30a8\u30ab\u30ab\u30df"],["\u30c8\u30fc\u30ad\u30e7\u30fc","\u30c8\u30aa\u30ad\u30e8\u30a6"],["\uff2e\u25ce\uff36\uff21","\u30ce\u30a6\u30a2"],["\u521d\u97f3\u30df\u30af","\u30cf\u30c4\u30cd\u30df\u30af"],["\u6731\u306e\u5b64\u5854","\u30a2\u30b1\u30ce\u30b3\u30c8\u30a6"],["\u5728\u308a\u3066\u904d\u304f","\u30a2\u30ea\u30c6\u30a2\u30de\u30cd\u30af"],["\u592e\u83ef\u5c01\u795e","\u30aa\u30a6\u30ab\u30db\u30a6\u30b7\u30f3"],["\u5fc3\u885d\u60f3\u6a5f","\u30b7\u30f3\u30b7\u30e8\u30a6\u30bd\u30a6\u30ad"],["\u80ce\u3088\u308a\u60f3\u3048","\u30cf\u30e9\u30e8\u30ea\u30aa\u30e2\u30a8"],["\u5c55\u721b\u4f1a","\u30c6\u30f3\u30e9\u30f3\u30ab\u30a4"],["\u58ca\u308c\u305f","\u30b3\u30ef\u30ec\u30bf"],["\u6bd4\u53e1\u5c71","\u30d2\u30a8\u30a4\u30b5\u30f3"],["\u4e16\u754c\u6a39","\u30bb\u30ab\u30a4\u30b7\u30e6"],["\u7570\u90a6\u4eba","\u30a4\u30db\u30a6\u30b7\u30f3"],["\u8ee2\u653b\u751f","\u30c6\u30f3\u30b3\u30a6\u30bb\u30a4"],["\u63a2\u7a7a\u58eb","\u30b9\u30ab\u30a4\u30ce\u30aa\u30c4"],["\u5263\u306e\u8857","\u30c4\u30eb\u30ad\u30ce\u30de\u30c1"],["\u9ed2\u7d62","\u30b3\u30c4\u30b1\u30f3"],["\u7d2b\u7e1e","\u30b7\u30b7\u30de"],["\u7834\u754c","\u30cf\u30ab\u30a4"],["\u9280\u5263","\u30ad\u30f3\u30b1\u30f3"],["\u6771\u4eac","\u30c8\u30a6\u30ad\u30e8\u30a6"],["\u7247\u9053","\u30ab\u30bf\u30df\u30c1"],["\u52c7\u8005","\u30e6\u30a6\u30b7\u30e4"],["\u5c11\u5973","\u30b7\u30e8\u30a6\u30b7\u30e8"],["\u771f\u7a7a","\u30b7\u30f3\u30af\u30a6"],["\u5b66\u5712","\u30ab\u30af\u30a8\u30f3"],["\u4e16\u754c","\u30bb\u30ab\u30a4"],["\u9752\u6625","\u30bb\u30a4\u30b7\u30e6\u30f3"],["\u75be\u60a3","\u30b7\u30c4\u30ab\u30f3"],["\u8ff7\u5bae","\u30e1\u30a4\u30ad\u30e6\u30a6"],["\u6b6f\u8eca","\u30cf\u30af\u30eb\u30de"],["\u84bc\u5929","\u30bd\u30a6\u30c6\u30f3"],["\u589c\u843d","\u30c4\u30a4\u30e9\u30af"],["\u7279\u547d","\u30c8\u30af\u30e1\u30a4"],["\u6643\u5929","\u30b3\u30a6\u30c6\u30f3"],["\u53db\u9006","\u30cf\u30f3\u30ad\u30e4\u30af"],["\u72af\u7f6a","\u30cf\u30f3\u30b5\u30a4"],["\u6d3b\u5287","\u30ab\u30c4\u30b1\u30ad"],["\u78a7\u7a7a","\u30d8\u30ad\u30af\u30a6"],["\u84ec\u83b1","\u30db\u30a6\u30e9\u30a4"],["\u5192\u967a","\u30db\u30a6\u30b1\u30f3"],["\u516d\u9580","\u30ed\u30af\u30e2\u30f3"],["\u708e\u4e0a","\u30a8\u30f3\u30b7\u30e8\u30a6"],["\u7121\u9650","\u30e0\u30b1\u30f3"],["\u5854","\u30c8\u30a6"],["\u7363","\u30b1\u30e2\u30ce"],["\u7378","\u30b1\u30e2\u30ce"],["\u68ee","\u30e2\u30ea"],["&","\u30a2\u30f3\u30c8"],["\uff06","\u30a2\u30f3\u30c8"],["\u30f4\u30a1","\u30cf"],["\u30f4\u30a3","\u30d2"],["\u30f4\u30a7","\u30d8"],["\u30f4\u30a9","\u30db"],["\u30f4","\u30d5"],["\u30a1","\u30a2"],["\u30a3","\u30a4"],["\u30a5","\u30a6"],["\u30a7","\u30a8"],["\u30a9","\u30aa"],["\u30e3","\u30e4"],["\u30e5","\u30e6"],["\u30e7","\u30e8"],["\u30c3","\u30c4"],["\u30f2","\u30aa"],["\u30ac","\u30ab"],["\u30ae","\u30ad"],["\u30b0","\u30af"],["\u30b2","\u30b1"],["\u30b4","\u30b3"],["\u30b6","\u30b5"],["\u30b8","\u30b7"],["\u30ba","\u30b9"],["\u30bc","\u30bb"],["\u30be","\u30bd"],["\u30c0","\u30bf"],["\u30c2","\u30c1"],["\u30c5","\u30c4"],["\u30c7","\u30c6"],["\u30c9","\u30c8"],["\u30d0","\u30cf"],["\u30d3","\u30d2"],["\u30d6","\u30d5"],["\u30d9","\u30d8"],["\u30dc","\u30db"],["\u30d1","\u30cf"],["\u30d4","\u30d2"],["\u30d7","\u30d5"],["\u30da","\u30d8"],["\u30dd","\u30db"]],Gn=fn=$e([ni("dice-bot")],Gn);var e,nv=function(){function t(n){void 0===n&&(n={}),this.tagName="",this.attrs={},this.innerHTML="",this.whitespaceRegex=/\s+/,this.tagName=n.tagName||"",this.attrs=n.attrs||{},this.innerHTML=n.innerHtml||n.innerHTML||""}return t.prototype.setTagName=function(n){return this.tagName=n,this},t.prototype.getTagName=function(){return this.tagName||""},t.prototype.setAttr=function(n,e){return this.getAttrs()[n]=e,this},t.prototype.getAttr=function(n){return this.getAttrs()[n]},t.prototype.setAttrs=function(n){return Object.assign(this.getAttrs(),n),this},t.prototype.getAttrs=function(){return this.attrs||(this.attrs={})},t.prototype.setClass=function(n){return this.setAttr("class",n)},t.prototype.addClass=function(n){for(var o,e=this.getClass(),i=this.whitespaceRegex,r=e?e.split(i):[],s=n.split(i);o=s.shift();)-1===bT(r,o)&&r.push(o);return this.getAttrs().class=r.join(" "),this},t.prototype.removeClass=function(n){for(var o,e=this.getClass(),i=this.whitespaceRegex,r=e?e.split(i):[],s=n.split(i);r.length&&(o=s.shift());){var a=bT(r,o);-1!==a&&r.splice(a,1)}return this.getAttrs().class=r.join(" "),this},t.prototype.getClass=function(){return this.getAttrs().class||""},t.prototype.hasClass=function(n){return-1!==(" "+this.getClass()+" ").indexOf(" "+n+" ")},t.prototype.setInnerHTML=function(n){return this.innerHTML=n,this},t.prototype.setInnerHtml=function(n){return this.setInnerHTML(n)},t.prototype.getInnerHTML=function(){return this.innerHTML||""},t.prototype.getInnerHtml=function(){return this.getInnerHTML()},t.prototype.toAnchorString=function(){var n=this.getTagName(),e=this.buildAttrsStr();return["<",n,e=e?" "+e:"",">",this.getInnerHtml(),"</",n,">"].join("")},t.prototype.buildAttrsStr=function(){if(!this.attrs)return"";var n=this.getAttrs(),e=[];for(var i in n)n.hasOwnProperty(i)&&e.push(i+'="'+n[i]+'"');return e.join(" ")},t}(),yT=function(){function t(n){void 0===n&&(n={}),this.newWindow=!1,this.truncate={},this.className="",this.newWindow=n.newWindow||!1,this.truncate=n.truncate||{},this.className=n.className||""}return t.prototype.build=function(n){return new nv({tagName:"a",attrs:this.createAttrs(n),innerHtml:this.processAnchorText(n.getAnchorText())})},t.prototype.createAttrs=function(n){var e={href:n.getAnchorHref()},i=this.createCssClass(n);return i&&(e.class=i),this.newWindow&&(e.target="_blank",e.rel="noopener noreferrer"),this.truncate&&this.truncate.length&&this.truncate.length<n.getAnchorText().length&&(e.title=n.getAnchorHref()),e},t.prototype.createCssClass=function(n){var e=this.className;if(e){for(var i=[e],r=n.getCssClassSuffixes(),s=0,o=r.length;s<o;s++)i.push(e+"-"+r[s]);return i.join(" ")}return""},t.prototype.processAnchorText=function(n){return this.doTruncate(n)},t.prototype.doTruncate=function(n){var e=this.truncate;if(!e||!e.length)return n;var i=e.length,r=e.location;return"smart"===r?function q7(t,n,e){var i,r;null==e?(e="&hellip;",r=3,i=8):(r=e.length,i=e.length);var o=function(Fe){var Ve="";return Fe.scheme&&Fe.host&&(Ve+=Fe.scheme+"://"),Fe.host&&(Ve+=Fe.host),Fe.path&&(Ve+="/"+Fe.path),Fe.query&&(Ve+="?"+Fe.query),Fe.fragment&&(Ve+="#"+Fe.fragment),Ve},a=function(Fe,Ve){var Ge=Ve/2,ct=Math.ceil(Ge),ut=-1*Math.floor(Ge),st="";return ut<0&&(st=Fe.substr(ut)),Fe.substr(0,ct)+e+st};if(t.length<=n)return t;var Ve,Ge,ct,h=n-r,w=(Ve={},(ct=(Ge=t).match(/^([a-z]+):\/\//i))&&(Ve.scheme=ct[1],Ge=Ge.substr(ct[0].length)),(ct=Ge.match(/^(.*?)(?=(\?|#|\/|$))/i))&&(Ve.host=ct[1],Ge=Ge.substr(ct[0].length)),(ct=Ge.match(/^\/(.*?)(?=(\?|#|$))/i))&&(Ve.path=ct[1],Ge=Ge.substr(ct[0].length)),(ct=Ge.match(/^\?(.*?)(?=(#|$))/i))&&(Ve.query=ct[1],Ge=Ge.substr(ct[0].length)),(ct=Ge.match(/^#(.*?)$/i))&&(Ve.fragment=ct[1]),Ve);if(w.query){var X=w.query.match(/^(.*?)(?=(\?|\#))(.*?)$/i);X&&(w.query=w.query.substr(0,X[1].length),t=o(w))}if(t.length<=n||(w.host&&(w.host=w.host.replace(/^www\./,""),t=o(w)),t.length<=n))return t;var fe="";if(w.host&&(fe+=w.host),fe.length>=h)return w.host.length==n?(w.host.substr(0,n-r)+e).substr(0,h+i):a(fe,h).substr(0,h+i);var pe="";if(w.path&&(pe+="/"+w.path),w.query&&(pe+="?"+w.query),pe){if((fe+pe).length>=h)return(fe+pe).length==n?(fe+pe).substr(0,n):(fe+a(pe,h-fe.length)).substr(0,h+i);fe+=pe}if(w.fragment){var Ie="#"+w.fragment;if((fe+Ie).length>=h)return(fe+Ie).length==n?(fe+Ie).substr(0,n):(fe+a(Ie,h-fe.length)).substr(0,h+i);fe+=Ie}if(w.scheme&&w.host){var Be=w.scheme+"://";if((fe+Be).length<h)return(Be+fe).substr(0,n)}if(fe.length<=n)return fe;var Le="";return h>0&&(Le=fe.substr(-1*Math.floor(h/2))),(fe.substr(0,Math.ceil(h/2))+e+Le).substr(0,h+i)}(n,i):"middle"===r?function W7(t,n,e){if(t.length<=n)return t;var i,r;null==e?(e="&hellip;",i=8,r=3):(i=e.length,r=e.length);var s=n-r,o="";return s>0&&(o=t.substr(-1*Math.floor(s/2))),(t.substr(0,Math.ceil(s/2))+e+o).substr(0,s+i)}(n,i):function K7(t,n,e){return function V7(t,n,e){var i;return t.length>n&&(null==e?(e="&hellip;",i=3):i=e.length,t=t.substring(0,n-i)+e),t}(t,n,e)}(n,i)},t}(),cu=function(){function t(n){this.__jsduckDummyDocProp=null,this.matchedText="",this.offset=0,this.tagBuilder=n.tagBuilder,this.matchedText=n.matchedText,this.offset=n.offset}return t.prototype.getMatchedText=function(){return this.matchedText},t.prototype.setOffset=function(n){this.offset=n},t.prototype.getOffset=function(){return this.offset},t.prototype.getCssClassSuffixes=function(){return[this.getType()]},t.prototype.buildTag=function(){return this.tagBuilder.build(this)},t}(),CT=function(t){function n(e){var i=t.call(this,e)||this;return i.email="",i.email=e.email,i}return ke(n,t),n.prototype.getType=function(){return"email"},n.prototype.getEmail=function(){return this.email},n.prototype.getAnchorHref=function(){return"mailto:"+this.email},n.prototype.getAnchorText=function(){return this.email},n}(cu),xT=function(t){function n(e){var i=t.call(this,e)||this;return i.serviceName="",i.hashtag="",i.serviceName=e.serviceName,i.hashtag=e.hashtag,i}return ke(n,t),n.prototype.getType=function(){return"hashtag"},n.prototype.getServiceName=function(){return this.serviceName},n.prototype.getHashtag=function(){return this.hashtag},n.prototype.getAnchorHref=function(){var e=this.serviceName,i=this.hashtag;switch(e){case"twitter":return"https://twitter.com/hashtag/"+i;case"facebook":return"https://www.facebook.com/hashtag/"+i;case"instagram":return"https://instagram.com/explore/tags/"+i;case"tiktok":return"https://www.tiktok.com/tag/"+i;default:throw new Error("Unknown service name to point hashtag to: "+e)}},n.prototype.getAnchorText=function(){return"#"+this.hashtag},n}(cu),wT=function(t){function n(e){var i=t.call(this,e)||this;return i.serviceName="twitter",i.mention="",i.mention=e.mention,i.serviceName=e.serviceName,i}return ke(n,t),n.prototype.getType=function(){return"mention"},n.prototype.getMention=function(){return this.mention},n.prototype.getServiceName=function(){return this.serviceName},n.prototype.getAnchorHref=function(){switch(this.serviceName){case"twitter":return"https://twitter.com/"+this.mention;case"instagram":return"https://instagram.com/"+this.mention;case"soundcloud":return"https://soundcloud.com/"+this.mention;case"tiktok":return"https://www.tiktok.com/@"+this.mention;default:throw new Error("Unknown service name to point mention to: "+this.serviceName)}},n.prototype.getAnchorText=function(){return"@"+this.mention},n.prototype.getCssClassSuffixes=function(){var e=t.prototype.getCssClassSuffixes.call(this),i=this.getServiceName();return i&&e.push(i),e},n}(cu),ET=function(t){function n(e){var i=t.call(this,e)||this;return i.number="",i.plusSign=!1,i.number=e.number,i.plusSign=e.plusSign,i}return ke(n,t),n.prototype.getType=function(){return"phone"},n.prototype.getPhoneNumber=function(){return this.number},n.prototype.getNumber=function(){return this.getPhoneNumber()},n.prototype.getAnchorHref=function(){return"tel:"+(this.plusSign?"+":"")+this.number},n.prototype.getAnchorText=function(){return this.matchedText},n}(cu),TT=function(t){function n(e){var i=t.call(this,e)||this;return i.url="",i.urlMatchType="scheme",i.protocolUrlMatch=!1,i.protocolRelativeMatch=!1,i.stripPrefix={scheme:!0,www:!0},i.stripTrailingSlash=!0,i.decodePercentEncoding=!0,i.schemePrefixRegex=/^(https?:\/\/)?/i,i.wwwPrefixRegex=/^(https?:\/\/)?(www\.)?/i,i.protocolRelativeRegex=/^\/\//,i.protocolPrepended=!1,i.urlMatchType=e.urlMatchType,i.url=e.url,i.protocolUrlMatch=e.protocolUrlMatch,i.protocolRelativeMatch=e.protocolRelativeMatch,i.stripPrefix=e.stripPrefix,i.stripTrailingSlash=e.stripTrailingSlash,i.decodePercentEncoding=e.decodePercentEncoding,i}return ke(n,t),n.prototype.getType=function(){return"url"},n.prototype.getUrlMatchType=function(){return this.urlMatchType},n.prototype.getUrl=function(){var e=this.url;return!this.protocolRelativeMatch&&!this.protocolUrlMatch&&!this.protocolPrepended&&(e=this.url="http://"+e,this.protocolPrepended=!0),e},n.prototype.getAnchorHref=function(){return this.getUrl().replace(/&amp;/g,"&")},n.prototype.getAnchorText=function(){var e=this.getMatchedText();return this.protocolRelativeMatch&&(e=this.stripProtocolRelativePrefix(e)),this.stripPrefix.scheme&&(e=this.stripSchemePrefix(e)),this.stripPrefix.www&&(e=this.stripWwwPrefix(e)),this.stripTrailingSlash&&(e=this.removeTrailingSlash(e)),this.decodePercentEncoding&&(e=this.removePercentEncoding(e)),e},n.prototype.stripSchemePrefix=function(e){return e.replace(this.schemePrefixRegex,"")},n.prototype.stripWwwPrefix=function(e){return e.replace(this.wwwPrefixRegex,"$1")},n.prototype.stripProtocolRelativePrefix=function(e){return e.replace(this.protocolRelativeRegex,"")},n.prototype.removeTrailingSlash=function(e){return"/"===e.charAt(e.length-1)&&(e=e.slice(0,-1)),e},n.prototype.removePercentEncoding=function(e){var i=e.replace(/%22/gi,"&quot;").replace(/%26/gi,"&amp;").replace(/%27/gi,"&#39;").replace(/%3C/gi,"&lt;").replace(/%3E/gi,"&gt;");try{return decodeURIComponent(i)}catch(r){return i}},n}(cu),uu=function t(n){this.__jsduckDummyDocProp=null,this.tagBuilder=n.tagBuilder},iv=/[A-Za-z]/,Y7=/[\d]/,Z7=/[\D]/,Wl=/\s/,rv=/['"]/,X7=/[\x00-\x1F\x7F]/,ST=/A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC/.source,IT=ST+/\u2700-\u27bf\udde6-\uddff\ud800-\udbff\udc00-\udfff\ufe0e\ufe0f\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0\ud83c\udffb-\udfff\u200d\u3299\u3297\u303d\u3030\u24c2\ud83c\udd70-\udd71\udd7e-\udd7f\udd8e\udd91-\udd9a\udde6-\uddff\ude01-\ude02\ude1a\ude2f\ude32-\ude3a\ude50-\ude51\u203c\u2049\u25aa-\u25ab\u25b6\u25c0\u25fb-\u25fe\u00a9\u00ae\u2122\u2139\udc04\u2600-\u26FF\u2b05\u2b06\u2b07\u2b1b\u2b1c\u2b50\u2b55\u231a\u231b\u2328\u23cf\u23e9-\u23f3\u23f8-\u23fa\udccf\u2935\u2934\u2190-\u21ff/.source+/\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D4-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D01-\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF8\u1CF9\u1DC0-\u1DF5\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F/.source,Wp=/0-9\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19/.source,ez=IT+Wp,Ti=IT+Wp,lf=new RegExp("[".concat(Ti,"]")),tz="(?:["+Wp+"]{1,3}\\.){3}["+Wp+"]{1,3}",nz="["+Ti+"](?:["+Ti+"\\-_]{0,61}["+Ti+"])?",kT=function(t){return"(?=("+nz+"))\\"+t},sv=function(t){return"(?:"+kT(t)+"(?:\\."+kT(t+1)+"){0,126}|"+tz+")"},Kp=(new RegExp("["+Ti+".\\-]*["+Ti+"\\-]"),lf),MT=/(?:xn--vermgensberatung-pwb|xn--vermgensberater-ctb|xn--clchc0ea0b2g2a9gcd|xn--w4r85el8fhu5dnra|northwesternmutual|travelersinsurance|verm\xf6gensberatung|xn--5su34j936bgsg|xn--bck1b9a5dre4c|xn--mgbah1a3hjkrd|xn--mgbai9azgqp6j|xn--mgberp4a5d4ar|xn--xkc2dl3a5ee0h|verm\xf6gensberater|xn--fzys8d69uvgm|xn--mgba7c0bbn0a|xn--mgbcpq6gpa1a|xn--xkc2al3hye2a|americanexpress|kerryproperties|sandvikcoromant|xn--i1b6b1a6a2e|xn--kcrx77d1x4a|xn--lgbbat1ad8j|xn--mgba3a4f16a|xn--mgbaakc7dvf|xn--mgbc0a9azcg|xn--nqv7fs00ema|americanfamily|bananarepublic|cancerresearch|cookingchannel|kerrylogistics|weatherchannel|xn--54b7fta0cc|xn--6qq986b3xl|xn--80aqecdr1a|xn--b4w605ferd|xn--fiq228c5hs|xn--h2breg3eve|xn--jlq480n2rg|xn--jlq61u9w7b|xn--mgba3a3ejt|xn--mgbaam7a8h|xn--mgbayh7gpa|xn--mgbbh1a71e|xn--mgbca7dzdo|xn--mgbi4ecexp|xn--mgbx4cd0ab|xn--rvc1e0am3e|international|lifeinsurance|travelchannel|wolterskluwer|xn--cckwcxetd|xn--eckvdtc9d|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--h2brj9c8c|xn--tiq49xqyj|xn--yfro4i67o|xn--ygbi2ammx|construction|lplfinancial|scholarships|versicherung|xn--3e0b707e|xn--45br5cyl|xn--4dbrk0ce|xn--80adxhks|xn--80asehdb|xn--8y0a063a|xn--gckr3f0f|xn--mgb9awbf|xn--mgbab2bd|xn--mgbgu82a|xn--mgbpl2fh|xn--mgbt3dhd|xn--mk1bu44c|xn--ngbc5azd|xn--ngbe9e0a|xn--ogbpf8fl|xn--qcka1pmc|accountants|barclaycard|blackfriday|blockbuster|bridgestone|calvinklein|contractors|creditunion|engineering|enterprises|foodnetwork|investments|kerryhotels|lamborghini|motorcycles|olayangroup|photography|playstation|productions|progressive|redumbrella|williamhill|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--3bst00m|xn--3ds443g|xn--3hcrj9c|xn--42c2d9a|xn--45brj9c|xn--55qw42g|xn--6frz82g|xn--80ao21a|xn--9krt00a|xn--cck2b3b|xn--czr694b|xn--d1acj3b|xn--efvy88h|xn--fct429k|xn--fjq720a|xn--flw351e|xn--g2xx48c|xn--gecrj9c|xn--gk3at1e|xn--h2brj9c|xn--hxt814e|xn--imr513n|xn--j6w193g|xn--jvr189m|xn--kprw13d|xn--kpry57d|xn--mgbbh1a|xn--mgbtx2b|xn--mix891f|xn--nyqy26a|xn--otu796d|xn--pgbs0dh|xn--q9jyb4c|xn--rhqv96g|xn--rovu88b|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--vuq861b|xn--w4rs40l|xn--xhq521b|xn--zfr164b|\u0b9a\u0bbf\u0b99\u0bcd\u0b95\u0baa\u0bcd\u0baa\u0bc2\u0bb0\u0bcd|accountant|apartments|associates|basketball|bnpparibas|boehringer|capitalone|consulting|creditcard|cuisinella|eurovision|extraspace|foundation|healthcare|immobilien|industries|management|mitsubishi|nextdirect|properties|protection|prudential|realestate|republican|restaurant|schaeffler|tatamotors|technology|university|vlaanderen|volkswagen|xn--30rr7y|xn--3pxu8k|xn--45q11c|xn--4gbrim|xn--55qx5d|xn--5tzm5g|xn--80aswg|xn--90a3ac|xn--9dbq2a|xn--9et52u|xn--c2br7g|xn--cg4bki|xn--czrs0t|xn--czru2d|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--io0a7i|xn--kput3i|xn--mxtq1m|xn--o3cw4h|xn--pssy2u|xn--q7ce6a|xn--unup4y|xn--wgbh1c|xn--wgbl6a|xn--y9a3aq|accenture|alfaromeo|allfinanz|amsterdam|analytics|aquarelle|barcelona|bloomberg|christmas|community|directory|education|equipment|fairwinds|financial|firestone|fresenius|frontdoor|furniture|goldpoint|hisamitsu|homedepot|homegoods|homesense|institute|insurance|kuokgroup|lancaster|landrover|lifestyle|marketing|marshalls|melbourne|microsoft|panasonic|passagens|pramerica|richardli|shangrila|solutions|statebank|statefarm|stockholm|travelers|vacations|xn--90ais|xn--c1avg|xn--d1alf|xn--e1a4c|xn--fhbei|xn--j1aef|xn--j1amh|xn--l1acc|xn--ngbrx|xn--nqv7f|xn--p1acf|xn--qxa6a|xn--tckwe|xn--vhquv|yodobashi|\u0645\u0648\u0631\u064a\u062a\u0627\u0646\u064a\u0627|abudhabi|airforce|allstate|attorney|barclays|barefoot|bargains|baseball|boutique|bradesco|broadway|brussels|builders|business|capetown|catering|catholic|cipriani|cityeats|cleaning|clinique|clothing|commbank|computer|delivery|deloitte|democrat|diamonds|discount|discover|download|engineer|ericsson|etisalat|exchange|feedback|fidelity|firmdale|football|frontier|goodyear|grainger|graphics|guardian|hdfcbank|helsinki|holdings|hospital|infiniti|ipiranga|istanbul|jpmorgan|lighting|lundbeck|marriott|maserati|mckinsey|memorial|merckmsd|mortgage|observer|partners|pharmacy|pictures|plumbing|property|redstone|reliance|saarland|samsclub|security|services|shopping|showtime|softbank|software|stcgroup|supplies|training|vanguard|ventures|verisign|woodside|xn--90ae|xn--node|xn--p1ai|xn--qxam|yokohama|\u0627\u0644\u0633\u0639\u0648\u062f\u064a\u0629|abogado|academy|agakhan|alibaba|android|athleta|auction|audible|auspost|avianca|banamex|bauhaus|bentley|bestbuy|booking|brother|bugatti|capital|caravan|careers|channel|charity|chintai|citadel|clubmed|college|cologne|comcast|company|compare|contact|cooking|corsica|country|coupons|courses|cricket|cruises|dentist|digital|domains|exposed|express|farmers|fashion|ferrari|ferrero|finance|fishing|fitness|flights|florist|flowers|forsale|frogans|fujitsu|gallery|genting|godaddy|grocery|guitars|hamburg|hangout|hitachi|holiday|hosting|hoteles|hotmail|hyundai|ismaili|jewelry|juniper|kitchen|komatsu|lacaixa|lanxess|lasalle|latrobe|leclerc|limited|lincoln|markets|monster|netbank|netflix|network|neustar|okinawa|oldnavy|organic|origins|philips|pioneer|politie|realtor|recipes|rentals|reviews|rexroth|samsung|sandvik|schmidt|schwarz|science|shiksha|singles|staples|storage|support|surgery|systems|temasek|theater|theatre|tickets|tiffany|toshiba|trading|walmart|wanggou|watches|weather|website|wedding|whoswho|windows|winners|xfinity|yamaxun|youtube|zuerich|\u043a\u0430\u0442\u043e\u043b\u0438\u043a|\u0627\u062a\u0635\u0627\u0644\u0627\u062a|\u0627\u0644\u0628\u062d\u0631\u064a\u0646|\u0627\u0644\u062c\u0632\u0627\u0626\u0631|\u0627\u0644\u0639\u0644\u064a\u0627\u0646|\u067e\u0627\u06a9\u0633\u062a\u0627\u0646|\u0643\u0627\u062b\u0648\u0644\u064a\u0643|\u0b87\u0ba8\u0bcd\u0ba4\u0bbf\u0baf\u0bbe|abarth|abbott|abbvie|africa|agency|airbus|airtel|alipay|alsace|alstom|amazon|anquan|aramco|author|bayern|beauty|berlin|bharti|bostik|boston|broker|camera|career|casino|center|chanel|chrome|church|circle|claims|clinic|coffee|comsec|condos|coupon|credit|cruise|dating|datsun|dealer|degree|dental|design|direct|doctor|dunlop|dupont|durban|emerck|energy|estate|events|expert|family|flickr|futbol|gallup|garden|george|giving|global|google|gratis|health|hermes|hiphop|hockey|hotels|hughes|imamat|insure|intuit|jaguar|joburg|juegos|kaufen|kinder|kindle|kosher|lancia|latino|lawyer|lefrak|living|locker|london|luxury|madrid|maison|makeup|market|mattel|mobile|monash|mormon|moscow|museum|mutual|nagoya|natura|nissan|nissay|norton|nowruz|office|olayan|online|oracle|orange|otsuka|pfizer|photos|physio|pictet|quebec|racing|realty|reisen|repair|report|review|rocher|rogers|ryukyu|safety|sakura|sanofi|school|schule|search|secure|select|shouji|soccer|social|stream|studio|supply|suzuki|swatch|sydney|taipei|taobao|target|tattoo|tennis|tienda|tjmaxx|tkmaxx|toyota|travel|unicom|viajes|viking|villas|virgin|vision|voting|voyage|vuelos|walter|webcam|xihuan|yachts|yandex|zappos|\u043c\u043e\u0441\u043a\u0432\u0430|\u043e\u043d\u043b\u0430\u0439\u043d|\u0627\u0628\u0648\u0638\u0628\u064a|\u0627\u0631\u0627\u0645\u0643\u0648|\u0627\u0644\u0627\u0631\u062f\u0646|\u0627\u0644\u0645\u063a\u0631\u0628|\u0627\u0645\u0627\u0631\u0627\u062a|\u0641\u0644\u0633\u0637\u064a\u0646|\u0645\u0644\u064a\u0633\u064a\u0627|\u092d\u093e\u0930\u0924\u092e\u094d|\u0b87\u0bb2\u0b99\u0bcd\u0b95\u0bc8|\u30d5\u30a1\u30c3\u30b7\u30e7\u30f3|actor|adult|aetna|amfam|amica|apple|archi|audio|autos|azure|baidu|beats|bible|bingo|black|boats|bosch|build|canon|cards|chase|cheap|cisco|citic|click|cloud|coach|codes|crown|cymru|dabur|dance|deals|delta|drive|dubai|earth|edeka|email|epson|faith|fedex|final|forex|forum|gallo|games|gifts|gives|glass|globo|gmail|green|gripe|group|gucci|guide|homes|honda|horse|house|hyatt|ikano|irish|jetzt|koeln|kyoto|lamer|lease|legal|lexus|lilly|linde|lipsy|loans|locus|lotte|lotto|macys|mango|media|miami|money|movie|music|nexus|nikon|ninja|nokia|nowtv|omega|osaka|paris|parts|party|phone|photo|pizza|place|poker|praxi|press|prime|promo|quest|radio|rehab|reise|ricoh|rocks|rodeo|rugby|salon|sener|seven|sharp|shell|shoes|skype|sling|smart|smile|solar|space|sport|stada|store|study|style|sucks|swiss|tatar|tires|tirol|tmall|today|tokyo|tools|toray|total|tours|trade|trust|tunes|tushu|ubank|vegas|video|vodka|volvo|wales|watch|weber|weibo|works|world|xerox|yahoo|\u05d9\u05e9\u05e8\u05d0\u05dc|\u0627\u06cc\u0631\u0627\u0646|\u0628\u0627\u0632\u0627\u0631|\u0628\u06be\u0627\u0631\u062a|\u0633\u0648\u062f\u0627\u0646|\u0633\u0648\u0631\u064a\u0629|\u0647\u0645\u0631\u0627\u0647|\u092d\u093e\u0930\u094b\u0924|\u0938\u0902\u0917\u0920\u0928|\u09ac\u09be\u0982\u09b2\u09be|\u0c2d\u0c3e\u0c30\u0c24\u0c4d|\u0d2d\u0d3e\u0d30\u0d24\u0d02|\u5609\u91cc\u5927\u9152\u5e97|aarp|able|adac|aero|akdn|ally|amex|arab|army|arpa|arte|asda|asia|audi|auto|baby|band|bank|bbva|beer|best|bike|bing|blog|blue|bofa|bond|book|buzz|cafe|call|camp|care|cars|casa|case|cash|cbre|cern|chat|citi|city|club|cool|coop|cyou|data|date|dclk|deal|dell|desi|diet|dish|docs|dvag|erni|fage|fail|fans|farm|fast|fiat|fido|film|fire|fish|flir|food|ford|free|fund|game|gbiz|gent|ggee|gift|gmbh|gold|golf|goog|guge|guru|hair|haus|hdfc|help|here|hgtv|host|hsbc|icbc|ieee|imdb|immo|info|itau|java|jeep|jobs|jprs|kddi|kids|kiwi|kpmg|kred|land|lego|lgbt|lidl|life|like|limo|link|live|loan|loft|love|ltda|luxe|maif|meet|meme|menu|mini|mint|mobi|moda|moto|name|navy|news|next|nico|nike|ollo|open|page|pars|pccw|pics|ping|pink|play|plus|pohl|porn|post|prod|prof|qpon|read|reit|rent|rest|rich|room|rsvp|ruhr|safe|sale|sarl|save|saxo|scot|seat|seek|sexy|shaw|shia|shop|show|silk|sina|site|skin|sncf|sohu|song|sony|spot|star|surf|talk|taxi|team|tech|teva|tiaa|tips|town|toys|tube|vana|visa|viva|vivo|vote|voto|wang|weir|wien|wiki|wine|work|xbox|yoga|zara|zero|zone|\u0434\u0435\u0442\u0438|\u0441\u0430\u0439\u0442|\u0628\u0627\u0631\u062a|\u0628\u064a\u062a\u0643|\u0680\u0627\u0631\u062a|\u062a\u0648\u0646\u0633|\u0634\u0628\u0643\u0629|\u0639\u0631\u0627\u0642|\u0639\u0645\u0627\u0646|\u0645\u0648\u0642\u0639|\u092d\u093e\u0930\u0924|\u09ad\u09be\u09b0\u09a4|\u09ad\u09be\u09f0\u09a4|\u0a2d\u0a3e\u0a30\u0a24|\u0aad\u0abe\u0ab0\u0aa4|\u0b2d\u0b3e\u0b30\u0b24|\u0cad\u0cbe\u0cb0\u0ca4|\u0dbd\u0d82\u0d9a\u0dcf|\u30a2\u30de\u30be\u30f3|\u30b0\u30fc\u30b0\u30eb|\u30af\u30e9\u30a6\u30c9|\u30dd\u30a4\u30f3\u30c8|\u7ec4\u7ec7\u673a\u6784|\u96fb\u8a0a\u76c8\u79d1|\u9999\u683c\u91cc\u62c9|aaa|abb|abc|aco|ads|aeg|afl|aig|anz|aol|app|art|aws|axa|bar|bbc|bbt|bcg|bcn|bet|bid|bio|biz|bms|bmw|bom|boo|bot|box|buy|bzh|cab|cal|cam|car|cat|cba|cbn|cbs|ceo|cfa|cfd|com|cpa|crs|dad|day|dds|dev|dhl|diy|dnp|dog|dot|dtv|dvr|eat|eco|edu|esq|eus|fan|fit|fly|foo|fox|frl|ftr|fun|fyi|gal|gap|gay|gdn|gea|gle|gmo|gmx|goo|gop|got|gov|hbo|hiv|hkt|hot|how|ibm|ice|icu|ifm|inc|ing|ink|int|ist|itv|jcb|jio|jll|jmp|jnj|jot|joy|kfh|kia|kim|kpn|krd|lat|law|lds|llc|llp|lol|lpl|ltd|man|map|mba|med|men|mil|mit|mlb|mls|mma|moe|moi|mom|mov|msd|mtn|mtr|nab|nba|nec|net|new|nfl|ngo|nhk|now|nra|nrw|ntt|nyc|obi|one|ong|onl|ooo|org|ott|ovh|pay|pet|phd|pid|pin|pnc|pro|pru|pub|pwc|red|ren|ril|rio|rip|run|rwe|sap|sas|sbi|sbs|sca|scb|ses|sew|sex|sfr|ski|sky|soy|spa|srl|stc|tab|tax|tci|tdk|tel|thd|tjx|top|trv|tui|tvs|ubs|uno|uol|ups|vet|vig|vin|vip|wed|win|wme|wow|wtc|wtf|xin|xxx|xyz|you|yun|zip|\u0431\u0435\u043b|\u043a\u043e\u043c|\u049b\u0430\u0437|\u043c\u043a\u0434|\u043c\u043e\u043d|\u043e\u0440\u0433|\u0440\u0443\u0441|\u0441\u0440\u0431|\u0443\u043a\u0440|\u0570\u0561\u0575|\u05e7\u05d5\u05dd|\u0639\u0631\u0628|\u0642\u0637\u0631|\u0643\u0648\u0645|\u0645\u0635\u0631|\u0915\u0949\u092e|\u0928\u0947\u091f|\u0e04\u0e2d\u0e21|\u0e44\u0e17\u0e22|\u0ea5\u0eb2\u0ea7|\u30b9\u30c8\u30a2|\u30bb\u30fc\u30eb|\u307f\u3093\u306a|\u4e2d\u6587\u7f51|\u4e9a\u9a6c\u900a|\u5929\u4e3b\u6559|\u6211\u7231\u4f60|\u65b0\u52a0\u5761|\u6de1\u9a6c\u9521|\u8bfa\u57fa\u4e9a|\u98de\u5229\u6d66|ac|ad|ae|af|ag|ai|al|am|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|\u03b5\u03bb|\u03b5\u03c5|\u0431\u0433|\u0435\u044e|\u0440\u0444|\u10d2\u10d4|\ub2f7\ub137|\ub2f7\ucef4|\uc0bc\uc131|\ud55c\uad6d|\u30b3\u30e0|\u4e16\u754c|\u4e2d\u4fe1|\u4e2d\u56fd|\u4e2d\u570b|\u4f01\u4e1a|\u4f5b\u5c71|\u4fe1\u606f|\u5065\u5eb7|\u516b\u5366|\u516c\u53f8|\u516c\u76ca|\u53f0\u6e7e|\u53f0\u7063|\u5546\u57ce|\u5546\u5e97|\u5546\u6807|\u5609\u91cc|\u5728\u7ebf|\u5927\u62ff|\u5a31\u4e50|\u5bb6\u96fb|\u5e7f\u4e1c|\u5fae\u535a|\u6148\u5584|\u624b\u673a|\u62db\u8058|\u653f\u52a1|\u653f\u5e9c|\u65b0\u95fb|\u65f6\u5c1a|\u66f8\u7c4d|\u673a\u6784|\u6e38\u620f|\u6fb3\u9580|\u70b9\u770b|\u79fb\u52a8|\u7f51\u5740|\u7f51\u5e97|\u7f51\u7ad9|\u7f51\u7edc|\u8054\u901a|\u8c37\u6b4c|\u8d2d\u7269|\u901a\u8ca9|\u96c6\u56e2|\u98df\u54c1|\u9910\u5385|\u9999\u6e2f)/,iz=new RegExp("[".concat(Ti,"!#$%&'*+/=?^_`{|}~-]")),rz=new RegExp("^".concat(MT.source,"$")),DT=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.localPartCharRegex=iz,e.strictTldRegex=rz,e}return ke(n,t),n.prototype.parseMatches=function(e){for(var i=this.tagBuilder,r=this.localPartCharRegex,s=this.strictTldRegex,o=[],a=e.length,h=new Yp,w={m:"a",a:"i",i:"l",l:"t",t:"o",o:":"},X=0,fe=0,pe=h;X<a;){var we=e.charAt(X);switch(fe){case 0:"m"===(nt=we)?ut(1):r.test(nt)&&ut();break;case 1:Pe(e.charAt(X-1),we);break;case 2:Be(we);break;case 3:Le(we);break;case 4:Fe(we);break;case 5:Ve(we);break;case 6:Ge(we);break;case 7:ct(we);break;default:tv(fe)}X++}var nt;return yt(),o;function Pe(nt,lt){":"===nt?r.test(lt)?(fe=2,pe=new Yp(ce(ce({},pe),{hasMailtoPrefix:!0}))):st():w[nt]===lt||(r.test(lt)?fe=2:"."===lt?fe=3:"@"===lt?fe=4:st())}function Be(nt){"."===nt?fe=3:"@"===nt?fe=4:r.test(nt)||st()}function Le(nt){"."===nt||"@"===nt?st():r.test(nt)?fe=2:st()}function Fe(nt){Kp.test(nt)?fe=5:st()}function Ve(nt){"."===nt?fe=7:"-"===nt?fe=6:Kp.test(nt)||yt()}function Ge(nt){"-"===nt||"."===nt?yt():Kp.test(nt)?fe=5:yt()}function ct(nt){"."===nt||"-"===nt?yt():Kp.test(nt)?(fe=5,pe=new Yp(ce(ce({},pe),{hasDomainDot:!0}))):yt()}function ut(nt){void 0===nt&&(nt=2),fe=nt,pe=new Yp({idx:X})}function st(){fe=0,pe=h}function yt(){if(pe.hasDomainDot){var nt=e.slice(pe.idx,X);/[-.]$/.test(nt)&&(nt=nt.slice(0,-1));var lt=pe.hasMailtoPrefix?nt.slice(7):nt;(function gt(Vt){var dn=(Vt.split(".").pop()||"").toLowerCase();return s.test(dn)})(lt)&&o.push(new CT({tagBuilder:i,matchedText:nt,offset:pe.idx,email:lt}))}st()}},n}(uu),Yp=function t(n){void 0===n&&(n={}),this.idx=void 0!==n.idx?n.idx:-1,this.hasMailtoPrefix=!!n.hasMailtoPrefix,this.hasDomainDot=!!n.hasDomainDot},sz=function(){function t(){}return t.isValid=function(n,e){return!(e&&!this.isValidUriScheme(e)||this.urlMatchDoesNotHaveProtocolOrDot(n,e)||this.urlMatchDoesNotHaveAtLeastOneWordChar(n,e)&&!this.isValidIpAddress(n)||this.containsMultipleDots(n))},t.isValidIpAddress=function(n){var e=new RegExp(this.hasFullProtocolRegex.source+this.ipRegex.source);return null!==n.match(e)},t.containsMultipleDots=function(n){var e=n;return this.hasFullProtocolRegex.test(n)&&(e=n.split("://")[1]),e.split("/")[0].indexOf("..")>-1},t.isValidUriScheme=function(n){var e=n.match(this.uriSchemeRegex),i=e&&e[0].toLowerCase();return"javascript:"!==i&&"vbscript:"!==i},t.urlMatchDoesNotHaveProtocolOrDot=function(n,e){return!(!n||e&&this.hasFullProtocolRegex.test(e)||-1!==n.indexOf("."))},t.urlMatchDoesNotHaveAtLeastOneWordChar=function(n,e){return!(!n||!e||this.hasFullProtocolRegex.test(e)||this.hasWordCharAfterProtocolRegex.test(n))},t.hasFullProtocolRegex=/^[A-Za-z][-.+A-Za-z0-9]*:\/\//,t.uriSchemeRegex=/^[A-Za-z][-.+A-Za-z0-9]*:/,t.hasWordCharAfterProtocolRegex=new RegExp(":[^\\s]*?["+ST+"]"),t.ipRegex=/[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?(:[0-9]*)?\/?$/,t}(),oz=(e=new RegExp("[/?#](?:["+Ti+"\\-+&@#/%=~_()|'$*\\[\\]{}?!:,.;^\u2713]*["+Ti+"\\-+&@#/%=~_()|'$*\\[\\]{}\u2713])?"),new RegExp(["(?:","(",/(?:[A-Za-z][-.+A-Za-z0-9]{0,63}:(?![A-Za-z][-.+A-Za-z0-9]{0,63}:\/\/)(?!\d+\/?)(?:\/\/)?)/.source,sv(2),")","|","(","(//)?",/(?:www\.)/.source,sv(6),")","|","(","(//)?",sv(10)+"\\.",MT.source,"(?![-"+ez+"])",")",")","(?::[0-9]+)?","(?:"+e.source+")?"].join(""),"gi")),az=new RegExp("["+Ti+"]"),AT=function(t){function n(e){var i=t.call(this,e)||this;return i.stripPrefix={scheme:!0,www:!0},i.stripTrailingSlash=!0,i.decodePercentEncoding=!0,i.matcherRegex=oz,i.wordCharRegExp=az,i.stripPrefix=e.stripPrefix,i.stripTrailingSlash=e.stripTrailingSlash,i.decodePercentEncoding=e.decodePercentEncoding,i}return ke(n,t),n.prototype.parseMatches=function(e){for(var w,i=this.matcherRegex,r=this.stripPrefix,s=this.stripTrailingSlash,o=this.decodePercentEncoding,a=this.tagBuilder,h=[],X=function(){var pe=w[0],we=w[1],Ie=w[4],Le=w.index,Fe=w[5]||w[9],Ve=e.charAt(Le-1);if(!sz.isValid(pe,we)||Le>0&&"@"===Ve||Le>0&&Fe&&fe.wordCharRegExp.test(Ve))return"continue";if(/\?$/.test(pe)&&(pe=pe.substr(0,pe.length-1)),fe.matchHasUnbalancedClosingParen(pe))pe=pe.substr(0,pe.length-1);else{var Ge=fe.matchHasInvalidCharAfterTld(pe,we);Ge>-1&&(pe=pe.substr(0,Ge))}var ct=["http://","https://"].find(function(nt){return!!we&&-1!==we.indexOf(nt)});if(ct){var ut=pe.indexOf(ct);pe=pe.substr(ut),we=we.substr(ut),Le+=ut}h.push(new TT({tagBuilder:a,matchedText:pe,offset:Le,urlMatchType:we?"scheme":Ie?"www":"tld",url:pe,protocolUrlMatch:!!we,protocolRelativeMatch:!!Fe,stripPrefix:r,stripTrailingSlash:s,decodePercentEncoding:o}))},fe=this;null!==(w=i.exec(e));)X();return h},n.prototype.matchHasUnbalancedClosingParen=function(e){var r,i=e.charAt(e.length-1);if(")"===i)r="(";else if("]"===i)r="[";else{if("}"!==i)return!1;r="{"}for(var s=0,o=0,a=e.length-1;o<a;o++){var h=e.charAt(o);h===r?s++:h===i&&(s=Math.max(s-1,0))}return 0===s},n.prototype.matchHasInvalidCharAfterTld=function(e,i){if(!e)return-1;var r=0;i&&(r=e.indexOf(":"),e=e.slice(r));var o=new RegExp("^((.?//)?[-."+Ti+"]*[-"+Ti+"]\\.[-"+Ti+"]+)").exec(e);return null===o?-1:(r+=o[1].length,e=e.slice(o[1].length),/^[^-.A-Za-z0-9:\/?#]/.test(e)?r:-1)},n}(uu),PT=new RegExp("[_".concat(Ti,"]")),NT=function(t){function n(e){var i=t.call(this,e)||this;return i.serviceName="twitter",i.serviceName=e.serviceName,i}return ke(n,t),n.prototype.parseMatches=function(e){for(var i=this.tagBuilder,r=this.serviceName,s=[],o=e.length,a=0,h=-1,w=0;a<o;){var X=e.charAt(a);switch(w){case 0:"#"===(Be=X)?(w=2,h=a):lf.test(Be)&&(w=1);break;case 1:pe(X);break;case 2:we(X);break;case 3:Ie(X);break;default:tv(w)}a++}var Be;return Pe(),s;function pe(Be){lf.test(Be)||(w=0)}function we(Be){w=PT.test(Be)?3:lf.test(Be)?1:0}function Ie(Be){PT.test(Be)||(Pe(),h=-1,w=lf.test(Be)?1:0)}function Pe(){if(h>-1&&a-h<=140){var Be=e.slice(h,a),Le=new xT({tagBuilder:i,matchedText:Be,offset:h,serviceName:r,hashtag:Be.slice(1)});s.push(Le)}}},n}(uu),lz=["twitter","facebook","instagram","tiktok"],dz=new RegExp("".concat(/(?:(?:(?:(\+)?\d{1,3}[-\040.]?)?\(?\d{3}\)?[-\040.]?\d{3}[-\040.]?\d{4})|(?:(\+)(?:9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)[-\040.]?(?:\d[-\040.]?){6,12}\d+))([,;]+[0-9]+#?)*/.source,"|").concat(/(0([1-9]{1}-?[1-9]\d{3}|[1-9]{2}-?\d{3}|[1-9]{2}\d{1}-?\d{2}|[1-9]{2}\d{2}-?\d{1})-?\d{4}|0[789]0-?\d{4}-?\d{4}|050-?\d{4}-?\d{4})/.source),"g"),FT=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.matcherRegex=dz,e}return ke(n,t),n.prototype.parseMatches=function(e){for(var o,i=this.matcherRegex,r=this.tagBuilder,s=[];null!==(o=i.exec(e));){var a=o[0],h=a.replace(/[^0-9,;#]/g,""),w=!(!o[1]&&!o[2]),X=0==o.index?"":e.substr(o.index-1,1),fe=e.substr(o.index+a.length,1),pe=!X.match(/\d/)&&!fe.match(/\d/);this.testMatch(o[3])&&this.testMatch(a)&&pe&&s.push(new ET({tagBuilder:r,matchedText:a,offset:o.index,number:h,plusSign:w}))}return s},n.prototype.testMatch=function(e){return Z7.test(e)},n}(uu),fz=new RegExp("@[_".concat(Ti,"]{1,50}(?![_").concat(Ti,"])"),"g"),hz=new RegExp("@[_.".concat(Ti,"]{1,30}(?![_").concat(Ti,"])"),"g"),pz=new RegExp("@[-_.".concat(Ti,"]{1,50}(?![-_").concat(Ti,"])"),"g"),gz=new RegExp("@[_.".concat(Ti,"]{1,23}[_").concat(Ti,"](?![_").concat(Ti,"])"),"g"),_z=new RegExp("[^"+Ti+"]"),OT=function(t){function n(e){var i=t.call(this,e)||this;return i.serviceName="twitter",i.matcherRegexes={twitter:fz,instagram:hz,soundcloud:pz,tiktok:gz},i.nonWordCharRegex=_z,i.serviceName=e.serviceName,i}return ke(n,t),n.prototype.parseMatches=function(e){var h,i=this.serviceName,r=this.matcherRegexes[this.serviceName],s=this.nonWordCharRegex,o=this.tagBuilder,a=[];if(!r)return a;for(;null!==(h=r.exec(e));){var w=h.index,X=e.charAt(w-1);if(0===w||s.test(X)){var fe=h[0].replace(/\.+$/g,""),pe=fe.slice(1);a.push(new wT({tagBuilder:o,matchedText:fe,offset:w,serviceName:i,mention:pe}))}}return a},n}(uu);var qo=function t(n){void 0===n&&(n={}),this.idx=void 0!==n.idx?n.idx:-1,this.type=n.type||"tag",this.name=n.name||"",this.isOpening=!!n.isOpening,this.isClosing=!!n.isClosing},$z=function(){function t(n){void 0===n&&(n={}),this.version=t.version,this.urls={},this.email=!0,this.phone=!0,this.hashtag=!1,this.mention=!1,this.newWindow=!0,this.stripPrefix={scheme:!0,www:!0},this.stripTrailingSlash=!0,this.decodePercentEncoding=!0,this.truncate={length:0,location:"end"},this.className="",this.replaceFn=null,this.context=void 0,this.sanitizeHtml=!1,this.matchers=null,this.tagBuilder=null,this.urls=this.normalizeUrlsCfg(n.urls),this.email="boolean"==typeof n.email?n.email:this.email,this.phone="boolean"==typeof n.phone?n.phone:this.phone,this.hashtag=n.hashtag||this.hashtag,this.mention=n.mention||this.mention,this.newWindow="boolean"==typeof n.newWindow?n.newWindow:this.newWindow,this.stripPrefix=this.normalizeStripPrefixCfg(n.stripPrefix),this.stripTrailingSlash="boolean"==typeof n.stripTrailingSlash?n.stripTrailingSlash:this.stripTrailingSlash,this.decodePercentEncoding="boolean"==typeof n.decodePercentEncoding?n.decodePercentEncoding:this.decodePercentEncoding,this.sanitizeHtml=n.sanitizeHtml||!1;var e=this.mention;if(!1!==e&&-1===["twitter","instagram","soundcloud","tiktok"].indexOf(e))throw new Error("invalid `mention` cfg '".concat(e,"' - see docs"));var i=this.hashtag;if(!1!==i&&-1===lz.indexOf(i))throw new Error("invalid `hashtag` cfg '".concat(i,"' - see docs"));this.truncate=this.normalizeTruncateCfg(n.truncate),this.className=n.className||this.className,this.replaceFn=n.replaceFn||this.replaceFn,this.context=n.context||this}return t.link=function(n,e){return new t(e).link(n)},t.parse=function(n,e){return new t(e).parse(n)},t.prototype.normalizeUrlsCfg=function(n){return null==n&&(n=!0),"boolean"==typeof n?{schemeMatches:n,wwwMatches:n,tldMatches:n}:{schemeMatches:"boolean"!=typeof n.schemeMatches||n.schemeMatches,wwwMatches:"boolean"!=typeof n.wwwMatches||n.wwwMatches,tldMatches:"boolean"!=typeof n.tldMatches||n.tldMatches}},t.prototype.normalizeStripPrefixCfg=function(n){return null==n&&(n=!0),"boolean"==typeof n?{scheme:n,www:n}:{scheme:"boolean"!=typeof n.scheme||n.scheme,www:"boolean"!=typeof n.www||n.www}},t.prototype.normalizeTruncateCfg=function(n){return"number"==typeof n?{length:n,location:"end"}:function U7(t,n){for(var e in n)n.hasOwnProperty(e)&&void 0===t[e]&&(t[e]=n[e]);return t}(n||{},{length:Number.POSITIVE_INFINITY,location:"end"})},t.prototype.parse=function(n){var e=this,i=["a","style","script"],r=0,s=[];return function mz(t,n){for(var e=n.onOpenTag,i=n.onCloseTag,r=n.onText,s=n.onComment,o=n.onDoctype,a=new qo,h=0,w=t.length,X=0,fe=0,pe=a;h<w;){var we=t.charAt(h);switch(X){case 0:"<"===we&&$n();break;case 1:"!"===(vt=we)?X=13:"/"===vt?(X=2,pe=new qo(ce(ce({},pe),{isClosing:!0}))):"<"===vt?$n():iv.test(vt)?(X=3,pe=new qo(ce(ce({},pe),{isOpening:!0}))):(X=0,pe=a);break;case 2:Le(we);break;case 3:Be(we);break;case 4:Fe(we);break;case 5:Ve(we);break;case 6:Ge(we);break;case 7:ct(we);break;case 8:ut(we);break;case 9:st(we);break;case 10:yt(we);break;case 11:nt(we);break;case 12:lt(we);break;case 13:"--"===t.substr(h,2)?(h+=2,pe=new qo(ce(ce({},pe),{type:"comment"})),X=14):"DOCTYPE"===t.substr(h,7).toUpperCase()?(h+=7,pe=new qo(ce(ce({},pe),{type:"doctype"})),X=20):Ot();break;case 14:Vt(we);break;case 15:Ht(we);break;case 16:dn(we);break;case 17:Pn(we);break;case 18:wt(we);break;case 19:It(we);break;case 20:St(we);break;default:tv(X)}h++}var vt;function Be(vt){Wl.test(vt)?(pe=new qo(ce(ce({},pe),{name:bi()})),X=4):"<"===vt?$n():"/"===vt?(pe=new qo(ce(ce({},pe),{name:bi()})),X=12):">"===vt?(pe=new qo(ce(ce({},pe),{name:bi()})),jn()):!iv.test(vt)&&!Y7.test(vt)&&":"!==vt&&Ot()}function Le(vt){">"===vt?Ot():iv.test(vt)?X=3:Ot()}function Fe(vt){Wl.test(vt)||("/"===vt?X=12:">"===vt?jn():"<"===vt?$n():"="===vt||rv.test(vt)||X7.test(vt)?Ot():X=5)}function Ve(vt){Wl.test(vt)?X=6:"/"===vt?X=12:"="===vt?X=7:">"===vt?jn():"<"===vt?$n():rv.test(vt)&&Ot()}function Ge(vt){Wl.test(vt)||("/"===vt?X=12:"="===vt?X=7:">"===vt?jn():"<"===vt?$n():rv.test(vt)?Ot():X=5)}function ct(vt){Wl.test(vt)||('"'===vt?X=8:"'"===vt?X=9:/[>=`]/.test(vt)?Ot():"<"===vt?$n():X=10)}function ut(vt){'"'===vt&&(X=11)}function st(vt){"'"===vt&&(X=11)}function yt(vt){Wl.test(vt)?X=4:">"===vt?jn():"<"===vt&&$n()}function nt(vt){Wl.test(vt)?X=4:"/"===vt?X=12:">"===vt?jn():"<"===vt?$n():(X=4,function kn(){h--}())}function lt(vt){">"===vt?(pe=new qo(ce(ce({},pe),{isClosing:!0})),jn()):X=4}function Vt(vt){"-"===vt?X=15:">"===vt?Ot():X=16}function Ht(vt){"-"===vt?X=18:">"===vt?Ot():X=16}function dn(vt){"-"===vt&&(X=17)}function Pn(vt){X="-"===vt?18:16}function wt(vt){">"===vt?jn():"!"===vt?X=19:"-"===vt||(X=16)}function It(vt){"-"===vt?X=17:">"===vt?jn():X=16}function St(vt){">"===vt?jn():"<"===vt&&$n()}function Ot(){X=0,pe=a}function $n(){X=1,pe=new qo({idx:h})}function jn(){var vt=t.slice(fe,pe.idx);vt&&r(vt,fe),"comment"===pe.type?s(pe.idx):"doctype"===pe.type?o(pe.idx):(pe.isOpening&&e(pe.name,pe.idx),pe.isClosing&&i(pe.name,pe.idx)),Ot(),fe=h+1}function bi(){return t.slice(pe.idx+(pe.isClosing?2:1),h).toLowerCase()}fe<h&&function Wn(){var vt=t.slice(fe,h);r(vt,fe),fe=h+1}()}(n,{onOpenTag:function(o){i.indexOf(o)>=0&&r++},onText:function(o,a){if(0===r){var w=function G7(t,n){if(!n.global)throw new Error("`splitRegex` must have the 'g' flag set");for(var r,e=[],i=0;r=n.exec(t);)e.push(t.substring(i,r.index)),e.push(r[0]),i=r.index+r[0].length;return e.push(t.substring(i)),e}(o,/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi),X=a;w.forEach(function(fe,pe){if(pe%2==0){var we=e.parseText(fe,X);s.push.apply(s,we)}X+=fe.length})}},onCloseTag:function(o){i.indexOf(o)>=0&&(r=Math.max(r-1,0))},onComment:function(o){},onDoctype:function(o){}}),s=this.compactMatches(s),s=this.removeUnwantedMatches(s)},t.prototype.compactMatches=function(n){n.sort(function(h,w){return h.getOffset()-w.getOffset()});for(var e=0;e<n.length-1;){var i=n[e],r=i.getOffset(),s=i.getMatchedText().length,o=r+s;if(e+1<n.length){if(n[e+1].getOffset()===r){var a=n[e+1].getMatchedText().length>s?e:e+1;n.splice(a,1);continue}if(n[e+1].getOffset()<o){n.splice(e+1,1);continue}}e++}return n},t.prototype.removeUnwantedMatches=function(n){return this.hashtag||ql(n,function(e){return"hashtag"===e.getType()}),this.email||ql(n,function(e){return"email"===e.getType()}),this.phone||ql(n,function(e){return"phone"===e.getType()}),this.mention||ql(n,function(e){return"mention"===e.getType()}),this.urls.schemeMatches||ql(n,function(e){return"url"===e.getType()&&"scheme"===e.getUrlMatchType()}),this.urls.wwwMatches||ql(n,function(e){return"url"===e.getType()&&"www"===e.getUrlMatchType()}),this.urls.tldMatches||ql(n,function(e){return"url"===e.getType()&&"tld"===e.getUrlMatchType()}),n},t.prototype.parseText=function(n,e){void 0===e&&(e=0),e=e||0;for(var i=this.getMatchers(),r=[],s=0,o=i.length;s<o;s++){for(var a=i[s].parseMatches(n),h=0,w=a.length;h<w;h++)a[h].setOffset(e+a[h].getOffset());r.push.apply(r,a)}return r},t.prototype.link=function(n){if(!n)return"";this.sanitizeHtml&&(n=n.replace(/</g,"&lt;").replace(/>/g,"&gt;"));for(var e=this.parse(n),i=[],r=0,s=0,o=e.length;s<o;s++){var a=e[s];i.push(n.substring(r,a.getOffset())),i.push(this.createMatchReturnVal(a)),r=a.getOffset()+a.getMatchedText().length}return i.push(n.substring(r)),i.join("")},t.prototype.createMatchReturnVal=function(n){var e;return this.replaceFn&&(e=this.replaceFn.call(this.context,n)),"string"==typeof e?e:!1===e?n.getMatchedText():e instanceof nv?e.toAnchorString():n.buildTag().toAnchorString()},t.prototype.getMatchers=function(){if(this.matchers)return this.matchers;var n=this.getTagBuilder(),e=[new NT({tagBuilder:n,serviceName:this.hashtag}),new DT({tagBuilder:n}),new FT({tagBuilder:n}),new OT({tagBuilder:n,serviceName:this.mention}),new AT({tagBuilder:n,stripPrefix:this.stripPrefix,stripTrailingSlash:this.stripTrailingSlash,decodePercentEncoding:this.decodePercentEncoding})];return this.matchers=e},t.prototype.getTagBuilder=function(){var n=this.tagBuilder;return n||(n=this.tagBuilder=new yT({newWindow:this.newWindow,truncate:this.truncate,className:this.className})),n},t.version="3.16.2",t.AnchorTagBuilder=yT,t.HtmlTag=nv,t.matcher={Email:DT,Hashtag:NT,Matcher:uu,Mention:OT,Phone:FT,Url:AT},t.match={Email:CT,Hashtag:xT,Match:cu,Mention:wT,Phone:ET,Url:TT},t}();const RT=$z,ov=RT;let An=(()=>{class t{constructor(){this.title="\u7121\u540d\u306e\u30d1\u30cd\u30eb",this.left=0,this.top=0,this.width=100,this.height=100,this.isAbleMinimizeButton=!0,this.isAbleFullScreenButton=!0,this.isAbleCloseButton=!0,this.isAbleRotateButton=!1,this.scrollablePanel=null}get isShow(){return!!this.panelComponentRef}open(e,i,r){let s;r||(r=t.defaultParentViewContainerRef),s=r.createComponent(t.UIPanelComponentClass,{index:r.length,injector:r.injector});let o=s.instance.content.createComponent(e);const a=s.injector.get(t);return a.panelComponentRef=s,i&&(i.title&&(a.title=i.title),i.top&&(a.top=i.top),i.left&&(a.left=i.left),i.width&&(a.width=i.width),i.height&&(a.height=i.height)),s.onDestroy(()=>{a.panelComponentRef=null}),o.instance}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}}return t.UIPanelComponentClass=null,t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=rn({token:t,factory:t.\u0275fac}),t})();class vz{constructor(n,e,i){this._resolve=n,this._reject=e,this.option=i}resolve(n){this._resolve(n),this._resolve=null}reject(n){this._reject(n),this._reject=null}}let Fn=(()=>{class t{constructor(){this.modalContext=null,this.count=0,this.title="\u7121\u540d\u306e\u30e2\u30fc\u30c0\u30eb"}get option(){return this.modalContext?this.modalContext.option:null}get isShow(){return this.count>0}open(e,i,r){let s;return r||(r=t.defaultParentViewContainerRef),new Promise((o,a)=>{const X=new t;X.modalContext=new vz(pe=>{s&&(s.destroy(),o(pe),this.count--)},pe=>{s&&(s.destroy(),a(pe),this.count--)},i);const fe=Yr.create({providers:[{provide:t,useValue:X}],parent:r.injector});s=r.createComponent(t.ModalComponentClass,{index:r.length,injector:fe}),s.instance.content.createComponent(e),s.onDestroy(()=>{this.count--}),this.count++})}resolve(e){this.modalContext&&(this.modalContext.resolve(e),this.modalContext=null)}reject(e){this.modalContext&&(this.modalContext.reject(e),this.modalContext=null)}}return t.ModalComponentClass=null,t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=rn({token:t,factory:t.\u0275fac}),t})();const bz=function(t){return{outer:t}};function yz(t,n){if(1&t&&(Q(0,"div",5),ye(1),Q(2,"span",6),ye(3),ie(),ye(4),Q(5,"span",7),ye(6),ie()()),2&t){const e=_e();U(1),Rn("",e.urlObj.protocol,"//"),U(1),re("ngClass",ft(6,bz,e.isOuter)),U(1),Xe(e.urlObj.host),U(1),Xe(e.urlObj.pathname),U(2),Ma("",e.urlObj.search,"",e.urlObj.hash,"")}}function Cz(t,n){if(1&t&&(Q(0,"div",5),ye(1),ie()),2&t){const e=_e();U(1),Xe(e.url)}}function xz(t,n){1&t&&(Q(0,"div"),ye(1,"\u3053\u306eURL\u3092\u958b\u304d\u307e\u3059\u304b\uff1f\uff08\u5225\u30a6\u30a3\u30f3\u30c9\u30a6\u3067\u958b\u304d\u307e\u3059\u3001\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u3092\u8a31\u53ef\u3057\u3066\u304f\u3060\u3055\u3044\uff09"),ie())}function wz(t,n){1&t&&(Q(0,"div"),ye(1,"\u26a0\ufe0fURL\u304c\u4e0d\u6b63\u3067\u3059\u3002"),ie())}let qr=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.url="",this.title="",this.subTitle="",this.url=i.option.url?i.option.url:"",this.title=i.option.title?i.option.title:"",this.subTitle=i.option.subTitle?i.option.subTitle:"",this.urlObj=this.isValid?new URL(this.url):null}get isValid(){return rt.validUrl(this.url.trim())}get isOuter(){return!!this.isValid&&window.location.origin!=this.urlObj.origin}ngOnInit(){Promise.resolve().then(()=>{let e="\u5916\u90e8URL\u3092\u958b\u304f";this.title?e+="\u3008"+this.title+(this.subTitle?`\uff1a${this.subTitle}`:"")+"\u3009":this.subTitle&&(e+=`\u3008${this.subTitle}\u3009`),this.modalService.title=this.panelService.title=e}),ze.register(this)}ngOnDestroy(){ze.unregister(this)}openUrl(){window.open(this.url.trim(),"_blank","noopener"),this.modalService.resolve(!0)}cancel(){this.modalService.resolve(!1)}}return t.\u0275fac=function(e){return new(e||t)(He(An),He(Fn))},t.\u0275cmp=Xt({type:t,selectors:[["open-url"]],decls:11,vars:5,consts:[["class","url",4,"ngIf"],[1,"help"],[4,"ngIf"],["type","submit",3,"disabled","click"],["type","button",3,"click"],[1,"url"],[3,"ngClass"],[1,"opt"]],template:function(e,i){1&e&&(Q(0,"div"),Te(1,yz,7,8,"div",0),Te(2,Cz,2,1,"div",0),ot(3,"hr"),Q(4,"div",1),Te(5,xz,2,0,"div",2),Te(6,wz,2,0,"div",2),ie()(),Q(7,"button",3),Ae("click",function(){return i.openUrl()}),ye(8,"\u958b\u304f"),ie(),Q(9,"button",4),Ae("click",function(){return i.cancel()}),ye(10,"\u30ad\u30e3\u30f3\u30bb\u30eb"),ie()),2&e&&(U(1),re("ngIf",i.isValid),U(1),re("ngIf",!i.isValid),U(3),re("ngIf",i.isValid),U(1),re("ngIf",!i.isValid),U(1),re("disabled",!i.isValid))},directives:[bn,Yn],styles:[".url[_ngcontent-%COMP%]{word-break:break-all}.url[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]{font-weight:700}.opt[_ngcontent-%COMP%]{color:gray}.help[_ngcontent-%COMP%]{font-size:smaller}"]}),t})();const Ez=["message"];function Tz(t,n){if(1&t&&(Q(0,"span")(1,"pre",1),ye(2),ie()()),2&t){const e=_e();U(2),Xe(e.text)}}function Sz(t,n){1&t&&ot(0,"hr")}function Iz(t,n){if(1&t){const e=it();Q(0,"pre",1)(1,"span",3,4),Ae("click",function(r){return Oe(e),_e(2).onLinkClick(r)}),Et(3,"safe"),ie(),Te(4,Sz,1,0,"hr",0),ie()}if(2&t){const e=n.$implicit,i=n.last,r=_e(2);U(1),re("innerHTML",Tt(3,2,r.htmlEscapeLinking(e),"html"),Yi),U(3),re("ngIf",!i)}}function kz(t,n){if(1&t&&(Q(0,"span"),Te(1,Iz,5,5,"pre",2),ie()),2&t){const e=_e();U(1),re("ngForOf",e.text)}}let du=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.text="",this.title="",this.stringUtil=rt}ngOnInit(){Promise.resolve().then(()=>{this.panelService.title=this.title,this.modalService.option&&null!=this.modalService.option.title&&(this.modalService.title=this.modalService.option.title?this.modalService.option.title:"",this.text=this.modalService.option.text?this.modalService.option.text:"")})}htmlEscapeLinking(e,i=!1){return ov.link(rt.escapeHtml(e),{urls:{schemeMatches:!0,wwwMatches:!0,tldMatches:!1},truncate:{length:96,location:"end"},decodePercentEncoding:i,stripPrefix:i,stripTrailingSlash:i,email:!1,phone:!1,replaceFn:function(r){if("url"==r.getType()&&rt.validUrl(r.getAnchorHref())){if(rt.sameOrigin(r.getAnchorHref()))return!0;{const s=r.buildTag();return s.setAttr("rel","nofollow"),s.addClass("outer-link"),s}}return!1}})}isObj(e){return"object"==typeof e}onLinkClick(e){if(e&&"A"==e.target.tagName){const i=e.target.getAttribute("href");if(!rt.sameOrigin(i))return e.preventDefault(),this.modalService.open(qr,{url:e.target.getAttribute("href")}),!1}return!0}}return t.\u0275fac=function(e){return new(e||t)(He(An),He(Fn))},t.\u0275cmp=Xt({type:t,selectors:[["text-view"]],viewQuery:function(e,i){if(1&e&&cn(Ez,5),2&e){let r;ln(r=un())&&(i.messageElm=r.first)}},inputs:{text:"text",title:"title"},decls:2,vars:2,consts:[[4,"ngIf"],[1,"text"],["class","text",4,"ngFor","ngForOf"],[3,"innerHTML","click"],["message",""]],template:function(e,i){1&e&&(Te(0,Tz,3,1,"span",0),Te(1,kz,2,1,"span",0)),2&e&&(re("ngIf",!i.isObj(i.text)),U(1),re("ngIf",i.isObj(i.text)))},directives:[bn,oi],pipes:[ai],styles:["[_nghost-%COMP%]{display:block}.text[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;font-size:12px;white-space:pre-wrap;margin:0;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}"]}),t})();var fu;let tt=(()=>{class t{}return t.dicePick="",t.dicePut="",t.diceRoll1="",t.diceRoll2="",t.cardDraw="",t.cardPick="",t.cardPut="",t.cardShuffle="",t.piecePick="",t.piecePut="",t.blockPick="",t.blockPut="",t.lock="",t.unlock="",t.sweep="",t.puyon="",t.surprise="",t.coinToss="",t})(),pt=fu=class extends Ga{onStoreAdded(){super.onStoreAdded(),ze.register(this).on("SOUND_EFFECT",n=>{Ft.play(zt.instance.get(n.data),.5)}).on("SEND_MESSAGE",n=>{let e=dt.instance.get(n.data.messageIdentifier);!e||!e.isSendFromSelf||e.isEmptyDice||(Math.random()<.5?fu.play(tt.diceRoll1):fu.play(tt.diceRoll2))})}onStoreRemoved(){super.onStoreRemoved(),ze.unregister(this)}play(n){fu.play(n)}static play(n){let e="";e="string"==typeof n?n:n.identifier,fu._play(e)}static _play(n){ze.call("SOUND_EFFECT",n)}};var cf;pt=fu=$e([ni("sound-effect")],pt);let wn=cf=class extends Vn{constructor(){super(...arguments),this.imageIdentifier="",this.tag="",this.hide=!1}get words(){return(null==this.tag||""==this.tag.trim())&&(this.tag=""),""===this.tag.trim()?[]:(this.tag=rt.toHalfWidth(this.tag).toLowerCase(),this.tag.trim().split(/\s+/))}containsWords(n,e=!0){if("string"==typeof n&&(n=n.trim().split(/\s+/)),0==n.length)return!1;if(n=n.concat(),e){for(const i of n)if(` ${this.tag} `.indexOf(` ${rt.toHalfWidth(i).toLowerCase()} `)>=0)return!0;return!1}for(const i of n)if(` ${this.tag} `.indexOf(` ${rt.toHalfWidth(i).toLowerCase()} `)<0)return!1;return!0}addWords(n){"string"==typeof n&&(n=n.trim().split(/\s+/)),n=n.concat();const e=Array.from(new Set(n.map(i=>rt.toHalfWidth(i).toLowerCase())));return this.tag=Array.from(new Set(e.concat(this.words))).sort().join(" "),ze.call("OPERATE_IMAGE_TAGS",this.identifier),e}removeWords(n){"string"==typeof n&&(n=n.trim().split(/\s+/)),n=n.concat();const e=Array.from(new Set(n.map(i=>rt.toHalfWidth(i).toLowerCase())));return this.tag=this.words.filter(i=>!e.includes(rt.toHalfWidth(i).toLowerCase())).sort().join(" "),ze.call("OPERATE_IMAGE_TAGS",this.identifier),e}static get(n){return dt.instance.get(`imagetag_${n}`)}static create(n){const e=new cf(`imagetag_${n}`);return e.imageIdentifier=n,e.initialize(),e}parseInnerXml(n){let e=cf.get(this.imageIdentifier);e||(e=cf.create(this.imageIdentifier));const i=e.toContext();i.syncData=this.toContext().syncData,e.apply(i),e.update(),this.destroy()}};var Kl;$e([at()],wn.prototype,"imageIdentifier",void 0),$e([at()],wn.prototype,"tag",void 0),$e([at()],wn.prototype,"hide",void 0),wn=cf=$e([ni("image-tag")],wn);let Ir=Kl=class extends Vn{constructor(){super(...arguments),this.identifiers=[]}static searchImages(n,e,i,r){"string"==typeof n&&(n=n.trim().split(/\s+/));const s=Kl.allImagesOwnWords(r);return n=n.filter(a=>s.includes(a)),this.allImages(r).filter(a=>{const h=wn.get(a.identifier);return e&&(i||0===n.length)&&(!h||null==h.tag||""===h.tag.trim())||(!e||i)&&h&&h.containsWords(n,i)})}static allImages(n){return Nt.instance.images.filter(i=>{if(n)return!0;const r=wn.get(i.identifier);return!r||!r.hide})}static allImagesOwnWords(n){return Kl.imagesOwnWords(this.allImages(n))}static imagesOwnWords(n,e=!1){if(e){if(0===n.length)return[];const i=n.map(s=>wn.get(s.identifier));if(!i[0])return[];let r=i[0].words;for(let s=1;s<i.length;s++){if(!i[s])return[];if(r=r.filter(o=>i[s].words.includes(o)),0===r.length)return r}return r.sort()}{const i=[];for(const r of n){const s=wn.get(r.identifier);s&&i.push(...s.words)}return Array.from(new Set(i)).sort()}}static countAllImagesHasWord(n,e){let i=0;if(null!=n&&""===n.trim())return i;for(const r of Kl.allImages(e)){const s=wn.get(r.identifier);null==n?(!s||null==s.tag||""==s.tag.trim())&&i++:s&&s.containsWords(n.trim(),!1)&&i++}return i}static imagesIsHidden(n){for(const e of n){const i=wn.get(e.identifier);if(!i||!i.hide)return!1}return!0}static sortImagesByWords(n,e){const i=n.map(r=>{const s=wn.get(r.identifier);return{image:r,tag:s&&null!=s.tag?s.tag:""}});return i.sort((r,s)=>{let o=0;return e.some(a=>(o=Kl._sortByWordCriteria(r,s,a),!!o)),o}),i.map(r=>r.image)}static _sortByWordCriteria(n,e,i){if(null==i)return""==n.tag&&""==e.tag?0:""==n.tag?-1:""==e.tag?1:0;const r=` ${n.tag} `.indexOf(` ${i} `),s=` ${e.tag} `.indexOf(` ${i} `);return-1==r&&-1==s?0:r>=0&&-1==s?-1:-1==r&&s>=0?1:0}onStoreAdded(){super.onStoreAdded(),dt.instance.remove(this)}innerXml(){return Array.from(new Set(this.identifiers)).map(n=>wn.get(n)).filter(n=>n).map(n=>n.toXml()).join("")}static create(n){const e=new Kl;return e.identifiers=n.map(i=>i.identifier),e}};Ir=Kl=$e([ni("image-tag-list")],Ir);var Yl,BT=me(4327),LT=me(5650);!function(t){const n={avif:"image/avif",gif:"image/gif",jpg:"image/jpeg",jpeg:"image/jpeg",jpe:"image/jpeg",jfif:"image/jpeg",pjpeg:"image/jpeg",pjp:"image/jpeg",png:"image/png",apng:"image/apng",webp:"image/webp",svg:"image/svg+xml",svgz:"image/svg+xml",ico:"image/x-icon",cur:"image/x-icon",bmp:"image/bmp",html:"text/html",htm:"text/html",shtml:"text/html",xml:"text/xml",yml:"text/yaml",yaml:"text/yaml",json:"application/json",map:"application/json",zip:"application/zip",mp3:"audio/mp3",wav:"audio/wav",m4a:"audio/aac",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",mp4:"video/mp4",webm:"video/webm"};t.type=function e(r){let s=r.replace(/.*[\.\/\\]/,"").toLowerCase();return n[s]?n[s]:""},t.extension=function i(r){for(let s in n)if(n[s]===r)return s;return r.split("/")[1]}}(Yl||(Yl={}));class Wo{constructor(){this.maxImageSize=2097152,this.maxAudioeSize=10485760,console.log("FileArchiver ready...")}static get instance(){return Wo._instance||(Wo._instance=new Wo),Wo._instance}initialize(){this.destroy(),this.addEventListeners()}destroy(){this.removeEventListeners()}addEventListeners(){this.removeEventListeners(),this.callbackOnDragEnter=n=>this.onDragEnter(n),this.callbackOnDragOver=n=>this.onDragOver(n),this.callbackOnDrop=n=>this.onDrop(n),document.body.addEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.addEventListener("dragover",this.callbackOnDragOver,!1),document.body.addEventListener("drop",this.callbackOnDrop,!1)}removeEventListeners(){document.body.removeEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.removeEventListener("dragover",this.callbackOnDragOver,!1),document.body.removeEventListener("drop",this.callbackOnDrop,!1),this.callbackOnDragEnter=null,this.callbackOnDragOver=null,this.callbackOnDrop=null}onDragEnter(n){n.preventDefault()}onDragOver(n){n.preventDefault()}onDrop(n){n.preventDefault(),console.log("onDrop",n.dataTransfer),this.load(n.dataTransfer.files)}load(n){var e=this;return(0,tn.Z)(function*(){if(!n)return;let i=n instanceof FileList?jT(n):n;for(let r of i)yield e.handleImage(r),yield e.handleAudio(r),yield e.handleText(r),yield e.handleZip(r),ze.trigger("FILE_LOADED",{file:r})})()}handleImage(n){var e=this;return(0,tn.Z)(function*(){if(!(n.type.indexOf("image/")<0)){if(e.maxImageSize<n.size)return void console.warn(`File size limit exceeded. -> ${n.name} (${(n.size/1024/1024).toFixed(2)}MB)`);console.log(n.name+" type:"+n.type),yield Nt.instance.addAsync(n)}})()}handleAudio(n){var e=this;return(0,tn.Z)(function*(){if(!(n.type.indexOf("audio/")<0)){if(e.maxAudioeSize<n.size)return void console.warn(`File size limit exceeded. -> ${n.name} (${(n.size/1024/1024).toFixed(2)}MB)`);console.log(n.name+" type:"+n.type),yield zt.instance.addAsync(n)}})()}handleText(n){return(0,tn.Z)(function*(){if(!(n.type.indexOf("text/")<0)){console.log(n.name+" type:"+n.type);try{let e=pa.xml2element(yield po.readAsTextAsync(n));e&&ze.trigger("XML_LOADED",{xmlElement:e})}catch(e){console.warn(e)}}})()}handleZip(n){var e=this;return(0,tn.Z)(function*(){if(!(0<=n.type.indexOf("application/")||n.type.length<1))return;let i=new LT;try{i=yield i.loadAsync(n)}catch(s){return void console.warn(s)}let r=[];i.forEach((s,o)=>r.push(o));for(let s of r)try{let o=yield s.async("arraybuffer");console.log(s.name+" \u89e3\u51cd..."),yield e.load([new File([o],s.name,{type:Yl.type(s.name)})])}catch(o){console.warn(o)}})()}saveAsync(n,e,i){return(0,tn.Z)(function*(){if(!n)return;let r=n instanceof FileList?jT(n):n,s=new LT;for(let a of r)s.file(a.name,a);let o=yield s.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}},i);(0,BT.saveAs)(o,e+".zip")})()}}function jT(t){let n=[],e=t.length;for(let i=0;i<e;i++)n.push(t[i]);return n}function Mz(t,n){if(1&t&&(Q(0,"i",6),ye(1),ie()),2&t){const e=_e();U(1),Xe(e.materialIcon)}}function Dz(t,n){if(1&t&&(Q(0,"div",7),ye(1),ie()),2&t){const e=_e();U(1),Xe(e.help)}}function Az(t,n){1&t&&(ot(0,"div",8),Et(1,"safe")),2&t&&re("innerHTML",Tt(1,1,_e().helpHtml,"html"),Yi)}function Pz(t,n){if(1&t){const e=it();Q(0,"button",9),Ae("click",function(){return Oe(e),_e().cancel()}),ye(1,"\u30ad\u30e3\u30f3\u30bb\u30eb"),ie()}}let er=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.title="",this.subTitle="",this.text="",this.help="",this.helpHtml="",this.materialIcon="",this.type=Si.OK,this.action=null,this.cancelAction=null,this.title=i.option.title?i.option.title:"",this.subTitle=i.option.subTitle?i.option.subTitle:"",this.text=i.option.text?i.option.text:"",this.help=i.option.help?i.option.help:"",this.helpHtml=i.option.helpHtml?i.option.helpHtml:"",this.materialIcon=i.option.materialIcon?i.option.materialIcon:"",this.type=i.option.type?i.option.type:Si.OK,this.action=i.option.action?i.option.action:null,this.cancelAction=i.option.cancelAction?i.option.cancelAction:null}ngOnInit(){Promise.resolve().then(()=>{let e="\u78ba\u8a8d";this.title?e+="\u3008"+this.title+(this.subTitle?`\uff1a${this.subTitle}`:"")+"\u3009":this.subTitle&&(e+=`\u3008${this.subTitle}\u3009`),this.modalService.title=this.panelService.title=e}),ze.register(this)}ngOnDestroy(){ze.unregister(this)}ok(){this.modalService.resolve(!0),this.action&&this.action()}cancel(){this.modalService.resolve(!1),this.cancelAction&&this.cancelAction()}}return t.\u0275fac=function(e){return new(e||t)(He(An),He(Fn))},t.\u0275cmp=Xt({type:t,selectors:[["app-confirmation"]],decls:9,vars:5,consts:[[1,"text"],["class","material-icons icon",4,"ngIf"],["class","help",4,"ngIf"],["class","help",3,"innerHTML",4,"ngIf"],["type","submit",3,"click"],["type","button",3,"click",4,"ngIf"],[1,"material-icons","icon"],[1,"help"],[1,"help",3,"innerHTML"],["type","button",3,"click"]],template:function(e,i){1&e&&(Q(0,"div",0),Te(1,Mz,2,1,"i",1),ye(2),ie(),ot(3,"hr"),Te(4,Dz,2,1,"div",2),Te(5,Az,2,4,"div",3),Q(6,"button",4),Ae("click",function(){return i.ok()}),ye(7,"\uff2f\uff2b"),ie(),Te(8,Pz,2,0,"button",5)),2&e&&(U(1),re("ngIf",i.materialIcon),U(1),Xe(i.text),U(2),re("ngIf",i.help&&!i.helpHtml),U(1),re("ngIf",i.helpHtml),U(3),re("ngIf",i.type>1))},directives:[bn],pipes:[ai],styles:[".text[_ngcontent-%COMP%]{font-weight:bolder;white-space:pre-wrap;word-break:break-all}.icon[_ngcontent-%COMP%]{display:inline-block;font-size:2.5rem;vertical-align:middle;margin-right:4px;padding:2px;text-shadow:2px 2px 2px #555}.help[_ngcontent-%COMP%]{font-size:smaller;white-space:pre-wrap;word-break:break-all;margin-bottom:3px}"]}),t})();var Si=(()=>(function(t){t[t.OK=1]="OK",t[t.OK_CANCEL=2]="OK_CANCEL"}(Si||(Si={})),Si))();function Nz(t,n){1&t&&ot(0,"badge",12),2&t&&re("count",_e(2).countImagesHasWord(null))("@.disabled",!0)}function Fz(t,n){if(1&t){const e=it();Q(0,"label")(1,"input",25),Ae("ngModelChange",function(r){return Oe(e),_e().searchNoTagImage=r})("change",function(){Oe(e);const r=_e();return r.searchNoTagImage=!!r.searchNoTagImage}),ie(),Q(2,"div",26)(3,"s"),ye(4,"No Tag"),ie(),Te(5,Nz,1,2,"badge",27),ie()()}if(2&t){const e=_e();U(1),ht("checked",e.searchNoTagImage?"checked":""),re("ngModel",e.searchNoTagImage),U(4),re("ngIf",e.countImagesHasWord(null)>0)}}function Oz(t,n){if(1&t&&ot(0,"badge",12),2&t){const e=_e().$implicit;re("count",_e().countImagesHasWord(e))("@.disabled",!0)}}function Rz(t,n){if(1&t){const e=it();Q(0,"label")(1,"input",28),Ae("change",function(){const s=Oe(e).$implicit;return _e().onSelectedWord(s)}),ie(),Q(2,"div"),ye(3),Te(4,Oz,1,2,"badge",27),ie()()}if(2&t){const e=n.$implicit,i=_e();U(1),ht("value",e),re("checked",i.searchWords.includes(e)),U(2),Xe(e),U(1),re("ngIf",i.countImagesHasWord(e)>0)}}function Bz(t,n){1&t&&_n(0)}function Lz(t,n){if(1&t&&(Q(0,"label",40),ye(1),ie()),2&t){const e=_e().$implicit;U(1),Xe(e)}}function zz(t,n){1&t&&(Q(0,"span",41),ye(1,"\u2026"),ie())}function jz(t,n){if(1&t&&(Ke(0),Te(1,Lz,2,1,"label",38),Te(2,zz,2,0,"span",39),Ye()),2&t){const e=n.index;U(1),re("ngIf",e<6),U(1),re("ngIf",6==e)}}function Hz(t,n){if(1&t&&(Q(0,"div",37),Te(1,jz,3,2,"ng-container",14),ie()),2&t){const e=_e().$implicit,i=_e();U(1),re("ngForOf",i.getTagWords(e))}}function Uz(t,n){1&t&&(Q(0,"div",37)(1,"s",42),ye(2,"No Tag"),ie()())}function Vz(t,n){1&t&&(Q(0,"div",43)(1,"i",44),ye(2,"visibility"),ie()())}function Gz(t,n){if(1&t){const e=it();Q(0,"img",45),Ae("click",function(){Oe(e);const r=_e().$implicit;return _e().onSelectedFile(r)}),Et(1,"safe"),ie()}if(2&t){const e=_e().$implicit;re("src",Tt(1,2,e.url,"resourceUrl"),en)("alt",e.name)}}function qz(t,n){1&t&&ot(0,"img",46),2&t&&ht("alt",_e().$implicit.name)}const Wz=function(t){return{selected:t}};function Kz(t,n){if(1&t&&(Q(0,"div",29)(1,"div",30),Te(2,Bz,1,0,"ng-container",31),Te(3,Hz,2,1,"ng-template",null,32,Un),Te(5,Uz,3,0,"ng-template",null,33,Un),ie(),Te(7,Vz,3,0,"div",34),Te(8,Gz,2,5,"img",35),Te(9,qz,1,1,"img",36),ie()),2&t){const e=n.$implicit,i=Kt(4),r=Kt(6),s=_e();re("@scaleInOut",void 0)("ngClass",ft(8,Wz,s.selected(e))),U(2),re("ngIf",s.getTagWords(e).length>0)("ngIfThen",i)("ngIfElse",r),U(5),re("ngIf",s.getHidden(e)),U(1),re("ngIf",0<e.url.length),U(1),re("ngIf",e.url.length<=0)}}function Yz(t,n){if(1&t){const e=it();Q(0,"label",56),Ae("click",function(){const s=Oe(e).$implicit;return _e(3).removeTagWord(s)}),ye(1),Q(2,"sup",57),ye(3,"\xd7"),ie()()}if(2&t){const e=n.$implicit;U(1),Xe(e)}}function Zz(t,n){if(1&t&&(Ke(0),Te(1,Yz,4,1,"label",55),Ye()),2&t){const e=_e(2);U(1),re("ngForOf",e.selectedImagesOwnWords())}}function Xz(t,n){1&t&&(Ke(0),Q(1,"span",58)(2,"s"),ye(3,"No Tag"),ie()(),Ye())}function Qz(t,n){if(1&t&&(Q(0,"option",59),ye(1),ie()),2&t){const e=n.$implicit;ht("value",e),U(1),Xe(e)}}const HT=function(t){return{"red-eye":t}};function Jz(t,n){if(1&t){const e=it();Q(0,"div",47)(1,"div")(2,"div",48)(3,"button",49),Ae("click",function(){Oe(e);const r=_e();return r.setectedImagesToHidden(!r.selectedImagesIsHidden)}),Q(4,"i",8),ye(5),ie()()(),Q(6,"button",50),Ae("click",function(){return Oe(e),_e().onUnselect()}),ye(7),ie(),Q(8,"input",51),Ae("ngModelChange",function(r){return Oe(e),_e().addingTagWord=r}),ie(),Q(9,"button",52),Ae("click",function(){return Oe(e),_e().addTagWord()}),ye(10,"\u30bf\u30b0\u8ffd\u52a0 \u27a1"),ie(),Te(11,Zz,2,1,"ng-container",13),Te(12,Xz,4,0,"ng-container",13),ie(),Q(13,"datalist",53),Te(14,Qz,2,2,"option",54),ie()()}if(2&t){const e=_e();re("@fadeAndUpInOut",void 0),U(3),Bt("title",e.selectedImagesIsHidden?"\u9078\u629e\u753b\u50cf\u3092\u8868\u793a\u8a2d\u5b9a\u306b\u3059\u308b":"\u9078\u629e\u753b\u50cf\u3092\u975e\u8868\u793a\u8a2d\u5b9a\u306b\u3059\u308b"),U(1),re("ngClass",ft(12,HT,e.selectedImagesIsHidden)),U(1),Xe(e.selectedImagesIsHidden?"visibility":"visibility_off"),U(2),Rn("\u9078\u629e\u89e3\u9664 (",e.selectedImageFiles.length," \u9078\u629e\u4e2d)"),U(1),um("list","",e.panelId,"_suggest"),re("ngModel",e.addingTagWord),U(1),re("disabled",null==e.addingTagWord||""===e.addingTagWord.trim()),U(2),re("ngIf",e.selectedImagesOwnWords().length>0),U(1),re("ngIf",0==e.selectedImagesOwnWords().length),U(1),Zi("id","",e.panelId,"_suggest"),U(1),re("ngForOf",e.suggestWords())}}const ej=function(t){return{selecter:t}};let Us=(()=>{class t{constructor(e,i,r){this.changeDetector=e,this.panelService=i,this.modalService=r,this._searchNoTagImage=!0,this.serchCondIsOr=!0,this.addingTagWord="",this.searchWords=[],this.deletedWords=[],this.selectedImageFiles=[],this.isSort=!0,this.isShowHideImages=!1}get images(){const e=Ir.searchImages(this.searchWords,this.searchNoTagImage&&this.countAllImagesHasWord(null)>0,this.serchCondIsOr,this.isShowHideImages),i=e.map(r=>r.identifier);return this.selectedImageFiles=this.selectedImageFiles.filter(r=>i.includes(r.identifier)),this.isSort?Ir.sortImagesByWords(e,t.sortOrder):e}get searchNoTagImage(){return this._searchNoTagImage}set searchNoTagImage(e){e?t.sortOrder.unshift(null):t.sortOrder=t.sortOrder.filter(i=>null!=i),t.sortOrder=Array.from(new Set(t.sortOrder)),this._searchNoTagImage=e,ze.trigger("CHANGE_SORT_ORDER",null)}get searchAllImage(){if(!this.searchNoTagImage&&this.countAllImagesHasWord(null)>0)return!1;for(const e of this.allImagesOwnWords)if(!this.searchWords.includes(e))return!1;return!0}get isSelected(){let e=this.selectedImageFiles.length>0;return e||(this.addingTagWord=""),e}get selectedImagesIsHidden(){return Ir.imagesIsHidden(this.selectedImageFiles)}get allImagesOwnWords(){return Ir.allImagesOwnWords(this.isShowHideImages)}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7"),this.searchWords=this.allImagesOwnWords,this.panelId=ns.generateUuid()}ngAfterViewInit(){ze.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("OPERATE_IMAGE_TAGS",e=>{this.changeDetector.markForCheck()}).on("CHANGE_SORT_ORDER",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){ze.unregister(this)}allImages(){return Ir.allImages(this.isShowHideImages)}countAllImagesHasWord(e){return Ir.countAllImagesHasWord(e,this.isShowHideImages)}countImagesHasWord(e){let i=0;if(null!=e&&""===e.trim())return i;for(const r of this.images){const s=wn.get(r.identifier);null==e?(!s||null==s.tag||""==s.tag.trim())&&i++:s&&s.containsWords(e.trim(),!1)&&i++}return i}handleFileSelect(e){let i=e.target,r=i.files;r.length&&Wo.instance.load(r),i.value=""}selected(e){return this.selectedImageFiles.map(i=>i.identifier).includes(e.identifier)}selectedImagesOwnWords(e=!1){return Ir.imagesOwnWords(this.selectedImageFiles,e)}onSelectedWord(e){null==e||""===e.trim()||(this.searchWords.includes(e)?(this.searchWords=this.searchWords.filter(i=>e!==i),t.sortOrder=t.sortOrder.filter(i=>e!==i)):(this.searchWords.push(e),t.sortOrder.unshift(e)),t.sortOrder=Array.from(new Set(t.sortOrder)),ze.trigger("CHANGE_SORT_ORDER",e))}onSelectedFile(e){this.selected(e)?this.selectedImageFiles=this.selectedImageFiles.filter(i=>i.identifier!==e.identifier):this.selectedImageFiles.push(e)}getTagWords(e){const i=wn.get(e.identifier);return i?i.words:[]}getHidden(e){const i=wn.get(e.identifier);return!!i&&i.hide}onSearchAllImage(){this.searchAllImage?(this.searchWords=[],this._searchNoTagImage=!1):(this.searchWords=this.allImagesOwnWords,this._searchNoTagImage=!0)}onUnselect(){this.selectedImageFiles=[]}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(er,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:Si.OK_CANCEL,materialIcon:"visibility",action:()=>{this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}setectedImagesToHidden(e){this.modalService.open(er,{title:e?"\u975e\u8868\u793a\u306b\u8a2d\u5b9a":"\u975e\u8868\u793a\u8a2d\u5b9a\u3092\u89e3\u9664",text:`\u753b\u50cf${e?"\u3092\u975e\u8868\u793a\u306b\u8a2d\u5b9a":"\u306e\u975e\u8868\u793a\u8a2d\u5b9a\u3092\u89e3\u9664"}\u3057\u307e\u3059\u304b\uff1f`,help:e?"\u9078\u629e\u3057\u305f\u753b\u50cf\u3092\u975e\u8868\u793a\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u3053\u308c\u306f\u300c\u610f\u56f3\u305b\u305a\u306b\u30cd\u30bf\u30d0\u30ec\u3092\u898b\u3066\u3057\u307e\u3046\u300d\u3053\u3068\u306a\u3069\u3092\u9632\u3050\u3082\u306e\u3067\u3042\u308a\u3001\u4ed6\u8005\u304b\u3089\u5b8c\u5168\u306b\u96a0\u3059\u3082\u306e\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002":"\u9078\u629e\u3057\u305f\u753b\u50cf\u306e\u975e\u8868\u793a\u8a2d\u5b9a\u3092\u89e3\u9664\u3057\u307e\u3059\u3002",type:Si.OK_CANCEL,materialIcon:e?"visibility_off":"visibility",action:()=>{for(const i of this.selectedImageFiles){const r=wn.get(i.identifier)||wn.create(i.identifier);r.hide=e,ze.call("OPERATE_IMAGE_TAGS",r.identifier)}}})}addTagWord(){if(null==this.addingTagWord||""==this.addingTagWord.trim())return;const e=this.addingTagWord.trim().split(/\s+/);this.modalService.open(er,{title:"\u753b\u50cf\u306b\u30bf\u30b0\u3092\u8ffd\u52a0",text:"\u753b\u50cf\u306b\u30bf\u30b0\u3092\u8ffd\u52a0\u3057\u307e\u3059\u304b\uff1f",helpHtml:"\u9078\u629e\u3057\u305f\u753b\u50cf\u306b "+e.map(i=>`<b class="word-tag">${rt.escapeHtml(i)}</b>`).join(" ")+" \u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002",type:Si.OK_CANCEL,materialIcon:"sell",action:()=>{let i=null;for(const r of this.selectedImageFiles)i=(wn.get(r.identifier)||wn.create(r.identifier)).addWords(e);i&&(this.serchCondIsOr&&this.searchWords.push(...i),t.sortOrder.unshift(...i)),this.serchCondIsOr&&(this.searchWords=Array.from(new Set(this.searchWords)).sort()),t.sortOrder=Array.from(new Set(t.sortOrder)),ze.trigger("CHANGE_SORT_ORDER",i),this.addingTagWord=""}})}removeTagWord(e){this.modalService.open(er,{title:"\u753b\u50cf\u304b\u3089\u30bf\u30b0\u3092\u524a\u9664",text:"\u753b\u50cf\u304b\u3089\u30bf\u30b0\u3092\u524a\u9664\u3057\u307e\u3059\u304b\uff1f",helpHtml:`\u9078\u629e\u3057\u305f\u753b\u50cf\u304b\u3089 <b class="word-tag">${rt.escapeHtml(e)}</b> \u3092\u524a\u9664\u3057\u307e\u3059\u3002`,type:Si.OK_CANCEL,materialIcon:"sell",action:()=>{if(null==e||""==e.trim())return;for(const r of this.selectedImageFiles){let s=wn.get(r.identifier);s&&s.removeWords(e)}const i=this.allImagesOwnWords;this.searchWords=this.searchWords.filter(r=>i.includes(r)),this.deletedWords.push(e),this.deletedWords=Array.from(new Set(this.deletedWords)),ze.trigger("CHANGE_SORT_ORDER",this.deletedWords)}})}identify(e,i){return i.identifier}suggestWords(){const e=this.selectedImagesOwnWords(!0);return Array.from(new Set(this.allImagesOwnWords.concat(this.deletedWords))).filter(i=>0!==i.indexOf("*")&&!e.includes(i))}}return t.sortOrder=[],t.\u0275fac=function(e){return new(e||t)(He(Oi),He(An),He(Fn))},t.\u0275cmp=Xt({type:t,selectors:[["file-storage"]],decls:41,vars:19,consts:[[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","image/*",2,"display","none",3,"change"],[1,"sticky-top"],[2,"float","right","margin-top","3px","margin-right","3px"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[1,"word-selecter"],["name","word-selecter","type","checkbox","value","ALL",3,"checked","click"],[1,"all-tags"],[1,"badge",3,"count"],[4,"ngIf"],[4,"ngFor","ngForOf"],[2,"white-space","nowrap"],[2,"margin-left","3px",3,"ngModel","ngModelChange"],["value","true"],["value",""],["sytle","white-space: nowrap","title","\u6700\u8fd1\u4f7f\u3063\u305f\u30bf\u30b0\u306e\u753b\u50cf\u3092\u524d\u306b"],["name","is-sort","value","Sort","type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"font-size","smaller","margin-right","3px"],["id","file-list",2,"padding-top","3px",3,"ngClass"],["class","image","style","text-align: center; min-width: 100px; height: 120px; position: relative;",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["class","sticky-bottom",4,"ngIf"],["name","word-selecter","type","checkbox","value","No Tag",3,"ngModel","checked","ngModelChange","change"],[1,"no-tag"],["class","badge",3,"count",4,"ngIf"],["name","word-selecter","type","checkbox",3,"value","checked","change"],[1,"image",2,"text-align","center","min-width","100px","height","120px","position","relative",3,"ngClass"],[2,"position","absolute","font-size","xx-small","text-align","left","bottom","0px","width","100%","height","100%","overflow","hidden","pointer-events","none"],[4,"ngIf","ngIfThen","ngIfElse"],["tagsBlock",""],["noTagBlock",""],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["height","120",3,"src","alt","click",4,"ngIf"],["src","assets/images/loading.gif",3,"alt",4,"ngIf"],[2,"position","absolute","bottom","0px","z-index","5"],["class","word-tag grow","style","display: block; width: 88px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],["class","grow","style","display: block; width: 88px; overflow: hidden; padding-left: 2px; font-weight: bold; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],[1,"word-tag","grow",2,"display","block","width","88px","overflow","hidden","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"display","block","width","88px","overflow","hidden","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"color","gray","display","block","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons","red-eye",2,"margin-right","2px","font-size","16px","display","block"],["height","120",3,"src","alt","click"],["src","assets/images/loading.gif",3,"alt"],[1,"sticky-bottom"],[2,"margin-left","3px","float","right"],[2,"padding","2px 0.5em",3,"click"],[2,"font-size","x-small","margin-right","2em",3,"click"],["type","text","placeholder","\u30b9\u30da\u30fc\u30b9 \u533a\u5207\u308a\u3067 \u8907\u6570\u53ef\u80fd",2,"width","14em",3,"ngModel","ngModelChange"],[2,"font-size","x-small",3,"disabled","click"],[3,"id"],[3,"value",4,"ngFor","ngForOf"],["class","word-tag","style","cursor: pointer; font-size: smaller",3,"click",4,"ngFor","ngForOf"],[1,"word-tag",2,"cursor","pointer","font-size","smaller",3,"click"],[2,"font-size","xx-small","color","red"],[2,"font-size","smaller","font-weight","bolder","margin-left","3px","color","gray"],[3,"value"]],template:function(e,i){1&e&&(Q(0,"label")(1,"div",0)(2,"div")(3,"i",1),ye(4,"add_photo_alternate"),ie()(),Q(5,"div"),ye(6,"\u3053\u3053\u306b\u753b\u50cf\u3092\u30c9\u30ed\u30c3\u30d7"),ie(),Q(7,"div",2),ye(8,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),ie(),Q(9,"input",3),Ae("change",function(s){return i.handleFileSelect(s)}),ie(),Q(10,"div",2),ot(11,"br"),ye(12,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d2MB\u307e\u3067"),ie()()(),Q(13,"div",4)(14,"div",5)(15,"label",6)(16,"input",7),Ae("click",function(s){return i.onShowHiddenImages(s)}),ie(),Q(17,"i",8),ye(18),ie()()(),Q(19,"span",9)(20,"label")(21,"input",10),Ae("click",function(){return i.onSearchAllImage()}),ie(),Q(22,"div",11)(23,"b"),ye(24,"ALL"),ie(),ot(25,"badge",12),ie()(),Te(26,Fz,6,3,"label",13),Te(27,Rz,5,4,"label",14),ie(),Q(28,"span",15)(29,"select",16),Ae("ngModelChange",function(s){return i.serchCondIsOr=s}),Q(30,"option",17),ye(31,"\u3044\u305a\u308c\u304b (OR)"),ie(),Q(32,"option",18),ye(33,"\u3059\u3079\u3066 (AND)"),ie()(),Q(34,"label",19)(35,"input",20),Ae("ngModelChange",function(s){return i.isSort=s})("change",function(){return i.isSort=!!i.isSort}),ie(),Q(36,"b",21),ye(37,"\u30bd\u30fc\u30c8"),ie()()()(),Q(38,"div",22),Te(39,Kz,10,10,"div",23),ie(),Te(40,Jz,15,14,"div",24)),2&e&&(U(16),ht("checked",i.isShowHideImages?"checked":""),U(1),re("ngClass",ft(15,HT,i.isShowHideImages)),U(1),Xe(i.isShowHideImages?"visibility":"visibility_off"),U(3),ht("checked",i.searchAllImage?"checked":""),U(4),re("count",i.images.length)("@.disabled",!0),U(1),re("ngIf",i.countAllImagesHasWord(null)>0),U(1),re("ngForOf",i.allImagesOwnWords),U(2),re("ngModel",i.serchCondIsOr),U(6),ht("checked",i.isSort?"checked":""),re("ngModel",i.isSort),U(3),re("ngClass",ft(17,ej,i.isSelected)),U(1),re("ngForOf",i.images)("ngForTrackBy",i.identify),U(1),re("ngIf",i.isSelected))},directives:[Yn,Ld,bn,Jr,$i,di,oi,es,Ur,Vr,mi],pipes:[ai],styles:['[_nghost-%COMP%]{display:block}.drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.image[_ngcontent-%COMP%]{font-size:0;display:inline-block;border:2px solid transparent;margin-right:-2px;cursor:pointer}.image[_ngcontent-%COMP%]:hover{border:2px dotted red;transform:scale(1.08);z-index:150;transition-duration:60ms}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom;transition-duration:.12s}.image.selected[_ngcontent-%COMP%]{border:2px solid red}.selecter[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]:not(.selected)   img[_ngcontent-%COMP%]{filter:saturate(40%) opacity(90%) blur(2px)}.image[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(1px);backdrop-filter:blur(1px);filter:none!important}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.sticky-top[_ngcontent-%COMP%]{position:sticky;top:0;background-color:#f0dabde6;border-bottom:1px dotted #666;z-index:100}.sticky-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;background-color:#f0dabde6;border-top:1px dotted #666;z-index:200}.word-tag[_ngcontent-%COMP%]{margin-right:3px;display:inline-block;color:#000;font-weight:bolder}.word-tag[_ngcontent-%COMP%]:hover{color:red}.word-selecter[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.word-selecter[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{display:none}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div.all-tags[_ngcontent-%COMP%]{background-color:#eee;color:#008b8b}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}'],data:{animation:[Sn("scaleInOut",[Lt("void => *",[Rt("200ms ease",sn([et({transform:"scale3d(0, 0, 0)",offset:0}),et({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Lt("* => void",[Rt("180ms ease",et({transform:"scale3d(0, 0, 0)"}))])]),Sn("fadeAndUpInOut",[Lt("void => *",[Rt("100ms ease-in-out",sn([et({"transform-origin":"center bottom",transform:"translateY(8px) scaleY(0)",opacity:.6}),et({"transform-origin":"center bottom",transform:"translateY(0px) scaleY(1.0)",opacity:1})]))]),Lt("* => void",[Rt("100ms ease-in-out",et({"transform-origin":"center bottom",transform:"translateY(0px) scaleY(1.0)",opacity:1})),Rt("100ms ease-in-out",et({"transform-origin":"center bottom",transform:"translateY(8px) scaleY(0)",opacity:.6}))])])]},changeDetection:0}),t})();function tj(t,n){1&t&&ot(0,"badge",8),2&t&&re("count",_e(2).countImagesHasWord(null))("@.disabled",!0)}function nj(t,n){if(1&t){const e=it();Q(0,"label")(1,"input",21),Ae("ngModelChange",function(r){return Oe(e),_e().searchNoTagImage=r})("change",function(){Oe(e);const r=_e();return r.searchNoTagImage=!!r.searchNoTagImage}),ie(),Q(2,"div",22)(3,"s"),ye(4,"No Tag"),ie(),Te(5,tj,1,2,"badge",23),ie()()}if(2&t){const e=_e();U(1),ht("checked",e.searchNoTagImage?"checked":""),re("ngModel",e.searchNoTagImage),U(4),re("ngIf",e.countImagesHasWord(null)>0)}}function ij(t,n){if(1&t&&ot(0,"badge",8),2&t){const e=_e().$implicit;re("count",_e().countImagesHasWord(e))("@.disabled",!0)}}function rj(t,n){if(1&t){const e=it();Q(0,"label")(1,"input",24),Ae("change",function(){const s=Oe(e).$implicit;return _e().onSelectedWord(s)}),ie(),Q(2,"div"),ye(3),Te(4,ij,1,2,"badge",23),ie()()}if(2&t){const e=n.$implicit,i=_e();U(1),ht("value",e),re("checked",i.searchWords.includes(e)),U(2),Xe(e),U(1),re("ngIf",i.countImagesHasWord(e)>0)}}function sj(t,n){if(1&t){const e=it();Q(0,"span",25)(1,"button",26),Ae("click",function(){Oe(e);const r=_e();return r.onSelectedFile(r.empty)}),ye(2,"\u753b\u50cf\u306a\u3057"),ot(3,"br"),ye(4,"/\u8a2d\u5b9a\u89e3\u9664"),ie()()}}function oj(t,n){1&t&&_n(0)}function aj(t,n){if(1&t&&(Q(0,"label",39),ye(1),ie()),2&t){const e=_e().$implicit;U(1),Xe(e)}}function lj(t,n){1&t&&(Q(0,"span",40),ye(1,"\u2026"),ie())}function cj(t,n){if(1&t&&(Ke(0),Te(1,aj,2,1,"label",37),Te(2,lj,2,0,"span",38),Ye()),2&t){const e=n.index;U(1),re("ngIf",e<6),U(1),re("ngIf",6==e)}}function uj(t,n){if(1&t&&(Q(0,"div",36),Te(1,cj,3,2,"ng-container",10),ie()),2&t){const e=_e().$implicit,i=_e();U(1),re("ngForOf",i.getTagWords(e))}}function dj(t,n){1&t&&(Q(0,"div",36)(1,"s",41),ye(2,"No Tag"),ie()())}function fj(t,n){1&t&&(Q(0,"div",42)(1,"i",43),ye(2,"visibility"),ie()())}function hj(t,n){1&t&&(Q(0,"div",44)(1,"b",45),ye(2,"\u8a2d\u5b9a\u4e2d"),ie()())}function pj(t,n){if(1&t){const e=it();Q(0,"img",46),Ae("click",function(){Oe(e);const r=_e().$implicit,s=_e();return!s.getCurrent(r)&&s.onSelectedFile(r)}),Et(1,"safe"),ie()}if(2&t){const e=_e().$implicit;re("src",Tt(1,2,e.url,"resourceUrl"),en)("alt",e.name)}}function gj(t,n){1&t&&ot(0,"img",47),2&t&&ht("alt",_e().$implicit.name)}const _j=function(t){return{"current-images":t}};function mj(t,n){if(1&t&&(Q(0,"div",27)(1,"div",28),Te(2,oj,1,0,"ng-container",29),Te(3,uj,2,1,"ng-template",null,30,Un),Te(5,dj,3,0,"ng-template",null,31,Un),ie(),Te(7,fj,3,0,"div",32),Te(8,hj,3,0,"div",33),Te(9,pj,2,5,"img",34),Te(10,gj,1,1,"img",35),ie()),2&t){const e=n.$implicit,i=Kt(4),r=Kt(6),s=_e();re("@scaleInOut",void 0)("ngClass",ft(9,_j,s.getCurrent(e))),U(2),re("ngIf",s.getTagWords(e).length>0)("ngIfThen",i)("ngIfElse",r),U(5),re("ngIf",s.getHidden(e)),U(1),re("ngIf",s.getCurrent(e)),U(1),re("ngIf",0<e.url.length),U(1),re("ngIf",e.url.length<=0)}}const $j=function(t){return{"red-eye":t}};let Ko=(()=>{class t{constructor(e,i,r){this.changeDetector=e,this.panelService=i,this.modalService=r,this.isAllowedEmpty=!1,this.currentImageIdentifires=[],this._searchNoTagImage=!0,this.serchCondIsOr=!0,this.addingTagWord="",this.searchWords=[],this.isSort=!0,this.isShowHideImages=!1,this.isAllowedEmpty=!(!this.modalService.option||!this.modalService.option.isAllowedEmpty),this.modalService.option&&this.modalService.option.currentImageIdentifires&&(this.currentImageIdentifires=this.modalService.option.currentImageIdentifires)}get images(){const e=Ir.searchImages(this.searchWords,this.searchNoTagImage&&this.countAllImagesHasWord(null)>0,this.serchCondIsOr,this.isShowHideImages);return this.isSort?Ir.sortImagesByWords(e,Us.sortOrder).sort((i,r)=>this.getCurrent(i)?this.getCurrent(r)?0:-1:this.getCurrent(r)?1:0):e}get empty(){return Ut.Empty}get searchNoTagImage(){return this._searchNoTagImage}set searchNoTagImage(e){e?Us.sortOrder.unshift(null):Us.sortOrder=Us.sortOrder.filter(i=>null!=i),Us.sortOrder=Array.from(new Set(Us.sortOrder)),this._searchNoTagImage=e,ze.trigger("CHANGE_SORT_ORDER",null)}get searchAllImage(){if(!this.searchNoTagImage&&this.countAllImagesHasWord(null)>0)return!1;for(const e of this.allImagesOwnWords)if(!this.searchWords.includes(e))return!1;return!0}get allImagesOwnWords(){return Ir.allImagesOwnWords(this.isShowHideImages)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7"),this.searchWords=this.allImagesOwnWords}ngAfterViewInit(){ze.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("OPERATE_IMAGE_TAGS",e=>{this.changeDetector.markForCheck()}).on("CHANGE_SORT_ORDER",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){ze.unregister(this)}allImages(){return Ir.allImages(this.isShowHideImages)}countAllImagesHasWord(e){return Ir.countAllImagesHasWord(e,this.isShowHideImages)}countImagesHasWord(e){let i=0;if(null!=e&&""===e.trim())return i;for(const r of this.images){const s=wn.get(r.identifier);null==e?(!s||null==s.tag||""==s.tag.trim())&&i++:s&&s.containsWords(e.trim(),!1)&&i++}return i}getTagWords(e){const i=wn.get(e.identifier);return i?i.words:[]}getHidden(e){const i=wn.get(e.identifier);return!!i&&i.hide}getCurrent(e){return!!this.currentImageIdentifires&&this.currentImageIdentifires.includes(e.identifier)}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(er,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:Si.OK_CANCEL,materialIcon:"visibility",action:()=>{this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}onSelectedFile(e){this.modalService.resolve(e.identifier)}onSearchAllImage(){this.searchAllImage?(this.searchWords=[],this._searchNoTagImage=!1):(this.searchWords=this.allImagesOwnWords,this._searchNoTagImage=!0)}onSelectedWord(e){null==e||""===e.trim()||(this.searchWords.includes(e)?(this.searchWords=this.searchWords.filter(i=>e!==i),Us.sortOrder=Us.sortOrder.filter(i=>e!==i)):(this.searchWords.push(e),Us.sortOrder.unshift(e)),Us.sortOrder=Array.from(new Set(Us.sortOrder)),ze.trigger("CHANGE_SORT_ORDER",e))}cancel(){this.modalService.resolve(!1)}identify(e,i){return i.identifier}}return t.\u0275fac=function(e){return new(e||t)(He(Oi),He(An),He(Fn))},t.\u0275cmp=Xt({type:t,selectors:[["file-selector"]],inputs:{isAllowedEmpty:"isAllowedEmpty",currentImageIdentifires:"currentImageIdentifires"},decls:28,vars:16,consts:[[1,"sticky-top"],[2,"float","right","margin-top","3px","margin-right","3px"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[1,"word-selecter"],["name","word-selecter","type","checkbox","value","ALL",3,"checked","click"],[1,"all-tags"],[1,"badge",3,"count"],[4,"ngIf"],[4,"ngFor","ngForOf"],[2,"white-space","nowrap"],[2,"margin-left","3px",3,"ngModel","ngModelChange"],["value","true"],["value",""],["sytle","white-space: nowrap","title","\u6700\u8fd1\u4f7f\u3063\u305f\u30bf\u30b0\u306e\u753b\u50cf\u3092\u524d\u306b"],["name","is-sort","value","Sort","type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"font-size","smaller","margin-right","3px"],["id","file-list",2,"min-height","250px","margin-left","1px","padding-top","3px"],["class","empty","style","display: inline-block;",4,"ngIf"],["class","image","style","text-align: center; min-width: 100px; height: 120px; position: relative",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["name","word-selecter","type","checkbox","value","No Tag",3,"ngModel","checked","ngModelChange","change"],[1,"no-tag"],["class","badge",3,"count",4,"ngIf"],["name","word-selecter","type","checkbox",3,"value","checked","change"],[1,"empty",2,"display","inline-block"],[2,"min-width","100px","margin-left","-1px","margin-right","3px",3,"click"],[1,"image",2,"text-align","center","min-width","100px","height","120px","position","relative",3,"ngClass"],[2,"position","absolute","font-size","xx-small","text-align","left","bottom","0px","width","100%","height","100%","overflow","hidden","pointer-events","none"],[4,"ngIf","ngIfThen","ngIfElse"],["tagsBlock",""],["noTagBlock",""],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["style","position: absolute; top: 0px; left: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["height","120",3,"src","alt","click",4,"ngIf"],["src","assets/images/loading.gif",3,"alt",4,"ngIf"],[2,"position","absolute","bottom","0px","z-index","5"],["class","word-tag grow","style","display: block; width: 88px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],["class","grow","style","display: block; width: 88px; overflow: hidden; padding-left: 2px; font-weight: bold; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],[1,"word-tag","grow",2,"display","block","width","88px","overflow","hidden","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"display","block","width","88px","overflow","hidden","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"color","gray","display","block","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons","red-eye",2,"z-index","5","margin-right","2px","font-size","16px","display","block"],[2,"position","absolute","top","0px","left","0px","pointer-events","none","z-index","5"],[1,"grow",2,"font-size","13px","color","red","padding-left","2px"],["height","120",3,"src","alt","click"],["src","assets/images/loading.gif",3,"alt"]],template:function(e,i){1&e&&(Q(0,"div",0)(1,"div",1)(2,"label",2)(3,"input",3),Ae("click",function(s){return i.onShowHiddenImages(s)}),ie(),Q(4,"i",4),ye(5),ie()()(),Q(6,"span",5)(7,"label")(8,"input",6),Ae("click",function(){return i.onSearchAllImage()}),ie(),Q(9,"div",7)(10,"b"),ye(11,"ALL"),ie(),ot(12,"badge",8),ie()(),Te(13,nj,6,3,"label",9),Te(14,rj,5,4,"label",10),ie(),Q(15,"span",11)(16,"select",12),Ae("ngModelChange",function(s){return i.serchCondIsOr=s}),Q(17,"option",13),ye(18,"\u3044\u305a\u308c\u304b (OR)"),ie(),Q(19,"option",14),ye(20,"\u3059\u3079\u3066 (AND)"),ie()(),Q(21,"label",15)(22,"input",16),Ae("ngModelChange",function(s){return i.isSort=s})("change",function(){return i.isSort=!!i.isSort}),ie(),Q(23,"b",17),ye(24,"\u30bd\u30fc\u30c8"),ie()()()(),Q(25,"div",18),Te(26,sj,5,0,"span",19),Te(27,mj,11,11,"div",20),ie()),2&e&&(U(3),ht("checked",i.isShowHideImages?"checked":""),U(1),re("ngClass",ft(14,$j,i.isShowHideImages)),U(1),Xe(i.isShowHideImages?"visibility":"visibility_off"),U(3),ht("checked",i.searchAllImage?"checked":""),U(4),re("count",i.images.length)("@.disabled",!0),U(1),re("ngIf",i.countAllImagesHasWord(null)>0),U(1),re("ngForOf",i.allImagesOwnWords),U(2),re("ngModel",i.serchCondIsOr),U(6),ht("checked",i.isSort?"checked":""),re("ngModel",i.isSort),U(4),re("ngIf",i.isAllowedEmpty),U(1),re("ngForOf",i.images)("ngForTrackBy",i.identify))},directives:[Yn,Ld,bn,Jr,$i,di,oi,es,Ur,Vr],pipes:[ai],styles:["[_nghost-%COMP%]{display:block}.image[_ngcontent-%COMP%]{font-size:0;display:inline-block;border:2px solid transparent;margin-left:-2px}.image[_ngcontent-%COMP%]:not(.current-images){cursor:pointer}.image[_ngcontent-%COMP%]:not(.current-images):hover{border:2px dotted red;transform:scale(1.08);z-index:200;transition-duration:60ms}.current-images[_ngcontent-%COMP%]{border:2px solid red}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom;transition-duration:.12s}.image[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(1px);backdrop-filter:blur(1px);filter:none!important}.empty[_ngcontent-%COMP%]{line-height:120px;vertical-align:top}.empty[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:120px;margin:1px;box-sizing:border-box;vertical-align:top}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.sticky-top[_ngcontent-%COMP%]{position:sticky;top:0;background-color:#f0dabde6;border-top:1px dotted #666;border-bottom:1px dotted #666;z-index:100}.word-tag[_ngcontent-%COMP%]{margin-right:3px;display:inline-block;color:#000;font-weight:bolder}.word-tag[_ngcontent-%COMP%]:hover{color:red}.word-selecter[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.word-selecter[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{display:none}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div.all-tags[_ngcontent-%COMP%]{background-color:#eee;color:#008b8b}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}"],data:{animation:[Sn("scaleInOut",[Lt("void => *",[Rt("200ms ease",sn([et({transform:"scale3d(0, 0, 0)",offset:0}),et({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Lt("* => void",[Rt("180ms ease",et({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),t})();function av(t,n=[]){let e=dt.instance.getObjects(t.aliasName);n.forEach(s=>e=e.concat(dt.instance.getObjects(s))),e=e.filter(s=>s.isVisibleOnTable);let i=-1,r=!1;for(let s=0;s<e.length;s++)i===e[s].zindex?r=!0:i<e[s].zindex&&(i=e[s].zindex,r=!1);if((i!==t.zindex||r)&&(t.zindex=i+1,!(t.zindex<e.length+256))){e.sort((s,o)=>s.zindex-o.zindex);for(let s=0;s<e.length;s++)e[s].zindex=s}}var Zp,Cs=(()=>(function(t){t[t.FRONT=0]="FRONT",t[t.BACK=1]="BACK"}(Cs||(Cs={})),Cs))();let zn=Zp=class extends Ci{constructor(){super(...arguments),this.state=Cs.FRONT,this.rotate=0,this.owner="",this.zindex=0,this.isLocked=!1}get isVisibleOnTable(){return"table"===this.location.name&&(!this.parentIsAssigned||this.parentIsDestroyed)}get name(){return this.getCommonValue("name","")}get size(){return this.getCommonValue("size",2)}set size(n){this.setCommonValue("size",n)}get frontImage(){return this.getImageFile("front")}get backImage(){return this.getImageFile("back")}get imageFile(){return this.isVisible?this.frontImage:this.backImage}get fontsize(){let n=this.getElement("fontsize",this.commonDataElement);return!n&&this.commonDataElement&&this.commonDataElement.appendChild(_t.create("fontsize",18,{},"fontsize_"+this.identifier)),n?+n.value:18}set fontsize(n){this.setCommonValue("fontsize",n)}get text(){let n=this.getElement("text",this.commonDataElement);return!n&&this.commonDataElement&&this.commonDataElement.appendChild(_t.create("text","",{type:"note",currentValue:""},"text_"+this.identifier)),n?n.value+"":""}set text(n){this.setCommonValue("text",n)}get color(){return this.getCommonValue("color","#555555")}set color(n){this.setCommonValue("color",n)}get ownerName(){let n=We.findByUserId(this.owner);return n?n.name:""}get ownerColor(){let n=We.findByUserId(this.owner);return n?n.color:"#444444"}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return!!this.hasOwner&&(xt.peerContext.userId===this.owner&&xt.peerContext.isOpen||xt.peerContexts.some(n=>{const e=We.findByPeerId(n.peerId);return e&&e.userId===this.owner&&n.isOpen}))}get isHand(){return xt.peerContext.userId===this.owner}get isFront(){return this.state===Cs.FRONT}get isVisible(){return this.isHand||this.isFront}faceUp(){this.state=Cs.FRONT,this.owner=""}faceDown(){this.state=Cs.BACK,this.owner=""}toTopmost(){av(this,["card-stack"])}static create(n,e,i,r=2,s){let o=null;return o=s?new Zp(s):new Zp,o.createDataElements(),o.commonDataElement.appendChild(_t.create("name",n,{},"name_"+o.identifier)),o.commonDataElement.appendChild(_t.create("size",r,{},"size_"+o.identifier)),o.imageDataElement.appendChild(_t.create("front",e,{type:"image"},"front_"+o.identifier)),o.imageDataElement.appendChild(_t.create("back",i,{type:"image"},"back_"+o.identifier)),o.commonDataElement.appendChild(_t.create("fontsize",18,{},"fontsize_"+o.identifier)),o.commonDataElement.appendChild(_t.create("text","",{type:"note",currentValue:""},"text_"+o.identifier)),o.commonDataElement.appendChild(_t.create("color","#555555",{type:"color"},"ccolor_"+o.identifier)),o.initialize(),o}};var Xp;$e([at()],zn.prototype,"state",void 0),$e([at()],zn.prototype,"rotate",void 0),$e([at()],zn.prototype,"owner",void 0),$e([at()],zn.prototype,"zindex",void 0),$e([at()],zn.prototype,"isLocked",void 0),zn=Zp=$e([ni("card")],zn);let Kn=Xp=class extends Ci{constructor(){super(...arguments),this.rotate=0,this.zindex=0,this.owner="",this.isShowTotal=!0,this.isLocked=!1}get name(){return this.getCommonValue("name","")}get ownerName(){let n=We.findByUserId(this.owner);return n?n.name:""}get ownerColor(){let n=We.findByUserId(this.owner);return n?n.color:"#444444"}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return!!this.hasOwner&&(xt.peerContext.userId===this.owner&&xt.peerContext.isOpen||xt.peerContexts.some(n=>{const e=We.findByPeerId(n.peerId);return e&&e.userId===this.owner&&n.isOpen}))}get cardRoot(){for(let n of this.children)if("cardRoot"===n.getAttribute("name"))return n;return null}get cards(){return this.cardRoot?this.cardRoot.children:[]}get topCard(){return this.isEmpty?null:this.cards[0]}get isEmpty(){return this.cards.length<1}get imageFile(){return this.topCard?this.topCard.imageFile:null}onChildRemoved(n){super.onChildRemoved(n),n instanceof zn&&ze.trigger("CARD_STACK_DECREASED",{cardStackIdentifier:this.identifier,cardIdentifier:n.identifier})}shuffle(){if(!this.cardRoot)return;let n=this.cardRoot.children.length;for(let e of this.cards)e.index=Math.random()*n,e.rotate=180*Math.floor(2*Math.random()),this.setSamePositionFor(e);return this.cards}drawCard(){let n=this.topCard?this.cardRoot.removeChild(this.topCard):null;return n&&(n.rotate+=this.rotate,360<n.rotate&&(n.rotate-=360),this.setSamePositionFor(n),n.toTopmost()),n}drawCardAll(){let n=this.cards;for(let e of n)this.cardRoot.removeChild(e),e.rotate+=this.rotate,this.setSamePositionFor(e),360<e.rotate&&(e.rotate-=360);return n}faceUp(){this.topCard&&(this.topCard.faceUp(),this.setSamePositionFor(this.topCard))}faceDown(){this.topCard&&(this.topCard.faceDown(),this.setSamePositionFor(this.topCard))}faceUpAll(){for(let n of this.cards)n.faceUp(),this.setSamePositionFor(n)}faceDownAll(){for(let n of this.cards)n.faceDown(),this.setSamePositionFor(n)}uprightAll(){for(let n of this.cards)n.rotate=0,this.setSamePositionFor(n)}inverse(){const n=[];for(;;){let e=this.topCard?this.cardRoot.removeChild(this.topCard):null;if(null==e)break;n.unshift(e),e.state=e.state==Cs.FRONT?Cs.BACK:Cs.FRONT}for(let e of n)this.putOnBottom(e)}unifyCardsSize(n){for(const e of this.cards)e.size!==n&&(e.size=n)}putOnTop(n){if(!this.cardRoot)return null;if(!this.topCard)return this.putOnBottom(n);n.owner="",n.zindex=0;let e=Math.abs(n.rotate-this.rotate);return 180<e&&(e=360-e),n.rotate=e<=90?0:180,this.setSamePositionFor(n),this.cardRoot.insertBefore(n,this.topCard)}putOnBottom(n){if(!this.cardRoot)return null;n.owner="",n.zindex=0;let e=Math.abs(n.rotate-this.rotate);return 180<e&&(e=360-e),n.rotate=e<=90?0:180,this.setSamePositionFor(n),this.cardRoot.appendChild(n)}toTopmost(){av(this,["card"])}setLocation(n){super.setLocation(n);let e=this.cards;for(let i of e)i.setLocation(n)}setSamePositionFor(n){n.location.name=this.location.name,n.location.x=this.location.x,n.location.y=this.location.y,n.posZ=this.posZ}static create(n,e){let i=null;i=e?new Xp(e):new Xp,i.createDataElements(),i.commonDataElement.appendChild(_t.create("name",n,{},"name_"+i.identifier));let r=new Vn("cardRoot_"+i.identifier);return r.setAttribute("name","cardRoot"),r.initialize(),i.appendChild(r),i.initialize(),i}};$e([at()],Kn.prototype,"rotate",void 0),$e([at()],Kn.prototype,"zindex",void 0),$e([at()],Kn.prototype,"owner",void 0),$e([at()],Kn.prototype,"isShowTotal",void 0),$e([at()],Kn.prototype,"isLocked",void 0),Kn=Xp=$e([ni("card-stack")],Kn);var Qp,Fi=(()=>(function(t){t[t.D2=0]="D2",t[t.D4=1]="D4",t[t.D6=2]="D6",t[t.D8=3]="D8",t[t.D10=4]="D10",t[t.D10_10TIMES=5]="D10_10TIMES",t[t.D12=6]="D12",t[t.D20=7]="D20"}(Fi||(Fi={})),Fi))();let cr=Qp=class extends Ci{constructor(){super(...arguments),this.face="0",this.owner="",this.rotate=0,this.isDropShadow=!0,this.isLock=!1}get name(){return this.getCommonValue("name","")}set name(n){this.setCommonValue("name",n)}get size(){return this.getCommonValue("size",1)}set size(n){this.setCommonValue("size",n)}get faces(){return this.imageDataElement?this.imageDataElement.children.filter(n=>"nothing"!=n.currentValue).map(n=>n.name):[]}get imageFile(){return this.isVisible?this.getImageFile(this.face):this.faces.length?this.getImageFile(this.faces[0]):null}get backFaceImageFile(){return this.isCoin?this.getImageFile(this.isVisible?"\u8868"==this.face?"\u88cf":"\u8868":this.faces[1]):this.imageFile}get nothingFaces(){return this.imageDataElement.children.filter(n=>"nothing"==n.currentValue).map(n=>n.name)}get ownerName(){let n=We.findByUserId(this.owner);return n?n.name:""}get ownerColor(){let n=We.findByUserId(this.owner);return n?n.color:"#444444"}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return this.hasOwner&&xt.peerContexts.some(n=>n.userId===this.owner&&n.isOpen)}get isMine(){return xt.peerContext.userId===this.owner}get isVisible(){return!this.hasOwner||this.isMine||this.isGMMode}get isCoin(){return 2===this.faces.length}diceRoll(){let n=this.faces;return this.face=0<n.length?n[Math.floor(Math.random()*n.length)]:"",this.face}setDicetype(n){this.makeDiceFace(n)}makeDiceFace(n,e){let i=1,r=[],s=o=>o+1+"";switch(n){case Fi.D2:i=2,s=a=>0===a?"\u8868":"\u88cf";break;case Fi.D4:i=4;break;case Fi.D6:i=6,r.push(_t.create("\u306a\u3057","",{type:"image",currentValue:"nothing"},null!=e?"nothing_"+e:null));break;case Fi.D8:i=8;break;case Fi.D10_10TIMES:s=a=>a+1+"0";case Fi.D10:i=10;break;case Fi.D12:i=12;break;case Fi.D20:i=20;break;default:i=2}for(let o=0;o<i;o++){let a=s(o);r.push(_t.create(a,"",{type:"image"},null!=e?a+"_"+e:null))}return this.imageDataElement.children.forEach(o=>o.destroy()),r.forEach(o=>this.imageDataElement.appendChild(o)),this.face=this.faces[0],r}static create(n,e,i,r){let s=r?new Qp(r):new Qp;return s.createDataElements(),s.commonDataElement.appendChild(_t.create("name",n,{},"name_"+s.identifier)),s.commonDataElement.appendChild(_t.create("size",i,{},"size_"+s.identifier)),s.makeDiceFace(e,s.identifier),s.initialize(),s}};var lv;$e([at()],cr.prototype,"face",void 0),$e([at()],cr.prototype,"owner",void 0),$e([at()],cr.prototype,"rotate",void 0),$e([at()],cr.prototype,"isDropShadow",void 0),$e([at()],cr.prototype,"isLock",void 0),cr=Qp=$e([ni("dice-symbol")],cr);let Qn=lv=class extends Vn{constructor(){super(...arguments),this.toName="",this.toImageIdentifier="",this.toColor="",this.aura=-1,this.lastUpdate=0,this.isAnimated=!1,this._sendTo=[],this._tags=[],this.locale="en-US"}get tabIdentifier(){return this.parent.identifier}get text(){return this.value}set text(n){this.value=null==n?"":n}get timestamp(){let n=this.getAttribute("timestamp"),e=n?+n:0;return Number.isNaN(e)?1:e}get sendTo(){return this._to!==this.to&&(this._to=this.to,this._sendTo=null!=this.to&&0<this.to.trim().length?this.to.trim().split(/\s+/):[]),this._sendTo}get isEdited(){return this.lastUpdate>0}get tags(){return this._tag!==this.tag&&(this._tag=this.tag,this._tags=null!=this.tag&&0<this.tag.trim().length?this.tag.trim().split(/\s+/):[]),this._tags}get image(){return Nt.instance.get(this.imageIdentifier)}get toImage(){return Nt.instance.get(this.toImageIdentifier)}get index(){return this.minorIndex+this.timestamp}get isDirect(){return 0<this.sendTo.length||-1<this.tags.indexOf("direct")}get isSendFromSelf(){return this.from===xt.peerContext.userId||this.originFrom===xt.peerContext.userId||-1<this.tags.indexOf("mine")}get isRelatedToMe(){return-1<this.sendTo.indexOf(xt.peerContext.userId)||this.isSendFromSelf||this.isGMMode}get isDisplayable(){return!this.isDirect||this.isRelatedToMe}get isSystem(){return-1<this.tags.indexOf("system")}get isDicebot(){return this.isSystem&&this.from.indexOf("Dice")>=0&&!/^C\(.+\) \u2192/i.test(this.text)}get isCalculate(){return this.isSystem&&this.from.indexOf("Dice")>=0&&/^C\(.+\) \u2192/i.test(this.text)}get isSecret(){return-1<this.tags.indexOf("secret")}get isEmptyDice(){return!this.isDicebot||-1<this.tags.indexOf("empty")}get isSpecialColor(){return this.isDirect||this.isSecret||this.isSystem||this.isOperationLog||this.isDicebot||this.isCalculate}get isEditable(){return!this.isSystem&&!this.isOperationLog&&this.from===xt.peerContext.userId}get isFaceIcon(){return!this.isSystem&&(!this.characterIdentifier||this.tags.indexOf("noface")<0)}get isOperationLog(){return-1<this.tags.indexOf("opelog")}get isSuccess(){return this.isDicebot&&-1<this.tags.indexOf("success")}get isFailure(){return this.isDicebot&&-1<this.tags.indexOf("failure")}get isCritical(){return this.isDicebot&&-1<this.tags.indexOf("critical")}get isFumble(){return this.isDicebot&&-1<this.tags.indexOf("fumble")}get isGMMode(){return!!We.myCursor&&We.myCursor.isGMMode}logFragment(n,e=null,i="HH:mm",r=!0){return 0==n?this.logFragmentText(e,i):this.logFragmentHtml(e,i,2!=n)}logFragmentText(n=null,e="HH:mm"){n=n&&""!=n.trim()?`[${n}] `:"";const i=""==e?"":Ed(new Date(this.timestamp),e,this.locale)+"\uff1a",r=this.isEdited?""==e?" (\u7de8\u96c6\u6e08)":` (\u7de8\u96c6\u6e08 ${Ed(new Date(this.lastUpdate),e,this.locale)})`:"";let s=rt.rubyToText(this.text);return this.isDicebot&&(s=s.replace(/###(.+?)###/g,"*$1").replace(/\~\~\~(.+?)\~\~\~/g,"~$1")),s.lastIndexOf("\n")==s.length-1&&!r&&(s+="\n"),`${n}${i}${this.name}${this.toColor?" \u27a1 "+this.toName:""}\uff1a${this.isSecret&&!this.isSendFromSelf?"\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09":s+r}`}logFragmentHtml(n=null,e="HH:mm",i=!0){const r=rt.escapeHtml(this.color?this.color:We.CHAT_DEFAULT_COLOR),s=` style="color: ${r}"`,o=this.toColor?rt.escapeHtml(this.toColor):"",a=this.toColor?` style="color: ${o}"`:"",h=this.isDirect||this.isSecret?' class="grow"':"",w=n&&""!=n.trim()?`<span class="tab-name">${rt.escapeHtml(n)}</span> `:"",X=new Date(this.timestamp),fe=""==e?"":`<time datetime="${X.toISOString()}">${rt.escapeHtml(Ed(X,e,this.locale))}</time>\uff1a`,pe=`<span${h}${s}>${rt.escapeHtml(this.name)}</span>`+(this.toColor?` \u27a1 <span${h}${a}>${rt.escapeHtml(this.toName)}</span>`:"");let we=["message"];(this.isDirect||this.isSecret)&&we.push("direct-message"),this.isSystem&&we.push("system-message"),(this.isDicebot||this.isCalculate)&&we.push("dicebot-message"),this.isOperationLog&&we.push("operation-log");let Ie=["msg-text"];(!this.isSecret||this.isSendFromSelf)&&(this.isSuccess&&Ie.push("is-success"),this.isFailure&&Ie.push("is-failure"),this.isCritical&&Ie.push("is-critical"),this.isFumble&&Ie.push("is-fumble"));let Pe=this.isSecret&&!this.isSendFromSelf?"<s>\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09</s>":RT.link(this.isOperationLog?rt.escapeHtml(this.text):rt.rubyToHtml(rt.escapeHtml(this.text)),{urls:{schemeMatches:!0,wwwMatches:!0,tldMatches:!1},truncate:{length:96,location:"end"},decodePercentEncoding:!1,stripPrefix:!1,stripTrailingSlash:!1,email:!1,phone:!1,className:"outer-link",replaceFn:function(Le){return"url"==Le.getType()&&rt.validUrl(Le.getAnchorHref())}});this.isDicebot&&(Pe=lv.decorationDiceResult(Pe));let Be="";if(this.isEdited)if(""==e)Be='<span class="is-edited">\u7de8\u96c6\u6e08</span>';else{const Le=new Date(this.lastUpdate);Be=`<span class="is-edited"><b>\u7de8\u96c6\u6e08</b> <time datetime="${Le.toISOString()}">${rt.escapeHtml(Ed(Le,e,this.locale))}</time></span>`}return Pe.lastIndexOf("\n")==Pe.length-1&&!Be&&(Pe+="\n"),`<div class="${we.join(" ")}" style="border-left-color: ${r}">\n  <div class="msg-header">${w}${fe}<span class="msg-name">${pe}</span>\uff1a</div>\n  <div class="${Ie.join(" ")}"><span${this.isSpecialColor?"":s}>${Pe}</span>${Be}</div>\n</div>`}static logCss(n=!0){return"body {\n  color: #444;\n  background-color: #FFF;\n}\n.message {\n  display: flex;\n  width: 100%;\n  word-wrap: break-word;\n  overflow-wrap: anywhere;\n  word-break: break-word;\n  border-left: 4px solid transparent;\n  margin-top: 1px;\n}\n.direct-message {\n  background-color: #555;\n  color: #CCC;\n}\n.dicebot-message .msg-text {\n  color: #11F;\n}\n.direct-message.dicebot-message .msg-text {\n  color: #CCF;\n}\n.dicebot-message .msg-text.is-success {\n  color: #17f;\n}\n.dicebot-message .msg-text.is-failure {\n  color: #F05;\n}\n.direct-message.dicebot-message .msg-text.is-success {\n  color: #adF;\n}\n.direct-message.dicebot-message .msg-text.is-failure {\n  color: #F66;\n}\n.operation-log {\n  color: #666;\n  background-color: #CCCCCCAA;\n}\n.dicebot-message .msg-name,\n.dicebot-message .msg-text,\n.operation-log .msg-name,\n.operation-log .msg-text {\n  font-style: oblique;\n}\n.tab-name {\n  display: inline-block;\n}\n.tab-name::before {\n  content: '[';\n}\n.tab-name::after {\n  content: ']';\n}\n.msg-header {\n  white-space: nowrap;\n  border-left: 1px solid #FFF;\n  padding-left: 2px;\n}\n.msg-name {\n  font-weight: bolder;\n}\n.msg-text {\n  white-space: pre-wrap;\n  width: 100%\n}\n.is-edited {\n  margin-left: 2px;\n  font-size: 8px;\n}\n.is-edited::before {\n  content: '(';\n}\n.is-edited::after {\n  content: ')';\n}\na[target=_blank] {\n  text-decoration: none;\n  word-break: break-all;\n}\na[target=_blank]:hover {\n  text-decoration: underline;\n}\na.outer-link::after {\n  margin-right: 2px;\n  margin-left: 2px;\n  font-family: 'Material Icons';\n  content: '\\e89e';\n  font-weight: bolder;\n  text-decoration: none;\n  display: inline-block;\n  font-size: smaller;\n  vertical-align: 25%;\n}\n.direct-message a[href] {\n  color: #CCF;\n}\n.direct-message a[href]:visited {\n  color: #99D;\n}\nruby {\n  ruby-align: space-between;\n}\ns.drop-dice .dropped {\n  color: #999;\n}\n.grow {\n  text-shadow: \n       1px  0px 1px #ffffff,\n       0px  1px 1px #ffffff,\n      -1px  0px 1px #ffffff,\n       0px -1px 1px #ffffff; \n}"}static decorationDiceResult(n){return n.replace(/###(.+?)###/g,'<b class="special-dice">$1</b>').replace(/\~\~\~(.+?)\~\~\~/g,'<s class="drop-dice"><span class="dropped">$1</span></s>')}};$e([at()],Qn.prototype,"originFrom",void 0),$e([at()],Qn.prototype,"from",void 0),$e([at()],Qn.prototype,"to",void 0),$e([at()],Qn.prototype,"name",void 0),$e([at()],Qn.prototype,"toName",void 0),$e([at()],Qn.prototype,"tag",void 0),$e([at()],Qn.prototype,"dicebot",void 0),$e([at()],Qn.prototype,"imageIdentifier",void 0),$e([at()],Qn.prototype,"toImageIdentifier",void 0),$e([at()],Qn.prototype,"color",void 0),$e([at()],Qn.prototype,"toColor",void 0),$e([at()],Qn.prototype,"isInverseIcon",void 0),$e([at()],Qn.prototype,"isHollowIcon",void 0),$e([at()],Qn.prototype,"isBlackPaint",void 0),$e([at()],Qn.prototype,"aura",void 0),$e([at()],Qn.prototype,"characterIdentifier",void 0),$e([at()],Qn.prototype,"standIdentifier",void 0),$e([at()],Qn.prototype,"standName",void 0),$e([at()],Qn.prototype,"isUseStandImage",void 0),$e([at()],Qn.prototype,"lastUpdate",void 0),Qn=lv=$e([ni("chat")],Qn);let Qa=class extends Vn{constructor(){super(...arguments),this.name="\u30bf\u30d6",this.isUseStandImage=!0,this.recieveOperationLogLevel=0,this._unreadLength=0}get chatMessages(){return this.children}get unreadLength(){return this._unreadLength}get hasUnread(){return 0<this.unreadLength}get latestTimeStamp(){let n=this.chatMessages.length-1;return n<0?0:this.chatMessages[n].timestamp}onChildAdded(n){super.onChildAdded(n),n.parent===this&&n instanceof Qn&&n.isDisplayable&&(this._unreadLength++,ze.trigger("MESSAGE_ADDED",{tabIdentifier:this.identifier,messageIdentifier:n.identifier}))}addMessage(n){n.tabIdentifier=this.identifier;let e=new Qn;for(let i in n)if("identifier"!==i&&"tabIdentifier"!==i){if("text"===i){e.value=n[i];continue}null==n[i]||""===n[i]||e.setAttribute(i,n[i])}return e.initialize(),ze.trigger("SEND_MESSAGE",{tabIdentifier:this.identifier,messageIdentifier:e.identifier}),this.appendChild(e),e}markForRead(){this._unreadLength=0}innerXml(){let n="";for(let e of this.children)e instanceof Qn&&!e.isDisplayable||(n+=ti.instance.toXml(e));return n}parseInnerXml(n){return super.parseInnerXml(n)}log(n,e,i=!0){const r=this.chatMessages.filter(s=>s.isDisplayable&&(i||!s.isOperationLog)).sort((s,o)=>s.index-o.index).map(s=>s.logFragment(n,null,e)).join("\n");return 0==n?r:`<!DOCTYPE html>\n<html lang="ja-JP">\n<head>\n<meta charset="UTF-8">\n<title>Udonarium with Fly\uff1a\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0\uff1a${rt.escapeHtml(""==this.name?"(\u7121\u540d\u306e\u30bf\u30d6)":this.name)}</title>\n<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">\n<style>\n${Qn.logCss()}\n</style>\n</head>\n<body>\n${r}\n</body>\n</html>`}};var Vs;$e([at()],Qa.prototype,"name",void 0),$e([at()],Qa.prototype,"isUseStandImage",void 0),$e([at()],Qa.prototype,"recieveOperationLogLevel",void 0),Qa=$e([ni("chat-tab")],Qa);let mo=Vs=class extends Vn{static get instance(){return Vs._instance||(Vs._instance=new Vs("ChatTabList"),Vs._instance.initialize()),Vs._instance}get chatTabs(){return this.children}addChatTab(...n){let e=null;if(n[0]instanceof Qa)e=n[0];else{let i=n[0];e=new Qa(n[1]),e.name=i,e.initialize()}return this.appendChild(e)}parseInnerXml(n){for(let i of Vs.instance.children)i.destroy();let e=Vs.instance.toContext();e.syncData=this.toContext().syncData,Vs.instance.apply(e),Vs.instance.update(),super.parseInnerXml.apply(Vs.instance,[n]),this.destroy()}log(n,e,i=!0){if(!this.chatTabs)return"";const r=this.chatTabs.reduce((s,o)=>(o&&s.push(...o.chatMessages.filter(a=>a.isDisplayable&&(i||!a.isOperationLog)).map(a=>({index:a.index,tabName:o.name,chatMessage:a}))),s),[]).sort((s,o)=>s.index-o.index).map(s=>s.chatMessage.logFragment(n,s.tabName,e)).join("\n");return 0==n?r:`<!DOCTYPE html>\n<html lang="ja-JP">\n<head>\n<meta charset="UTF-8">\n<title>Udonarium with Fly\uff1a\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0\uff1a\u5168\u3066\u306e\u30bf\u30d6</title>\n<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">\n<style>\n${Qn.logCss()}\n</style>\n</head>\n<body>\n${r}\n</body>\n</html>`}};mo=Vs=$e([ni("chat-tab-list")],mo);let kr=(()=>{class t{constructor(){this.intervalTimer=null,this.timeOffset=Date.now(),this.performanceOffset=performance.now(),this.ntpApiUrls=["https://worldtimeapi.org/api/ip"],this.gameType=""}get chatTabs(){return mo.instance.chatTabs}calibrateTimeOffset(){if(null!=this.intervalTimer)return void console.log("calibrateTimeOffset was canceled.");let e=Math.floor(Math.random()*this.ntpApiUrls.length),i=this.ntpApiUrls[e],r=performance.now();fetch(i).then(s=>{if(s.ok)return s.json();throw new Error("Network response was not ok.")}).then(s=>{let o=performance.now(),a=(o-r)/2,w=new Date(s.utc_datetime).getTime();this.timeOffset=w+a,this.performanceOffset=o,console.log("latency: "+a+"ms"),console.log("st: "+w),console.log("timeOffset: "+this.timeOffset),console.log("performanceOffset: "+this.performanceOffset),this.setIntervalTimer()}).catch(s=>{console.warn("There has been a problem with your fetch operation: ",s.message),this.setIntervalTimer()}),this.setIntervalTimer()}setIntervalTimer(){null!=this.intervalTimer&&clearTimeout(this.intervalTimer),this.intervalTimer=setTimeout(()=>{this.intervalTimer=null,this.calibrateTimeOffset()},216e5)}getTime(){return Math.floor(this.timeOffset+(performance.now()-this.performanceOffset))}sendMessage(e,i,r,s,o,a,h,w,X,fe,pe,we,Ie,Pe,Be){let Le=!(pe&&this.findFaceIconIdentifier(s)),Fe={from:xt.peerContext.userId,to:t.findId(o),name:this.findObjectName(s),toName:o?this.findObjectName(o):"",imageIdentifier:this.findImageIdentifier(s,pe),toImageIdentifier:o?this.findImageIdentifier(o):"",timestamp:this.calcTimeStamp(e),tag:Le?`${r} noface`:r,text:rt.cr(i),color:a,toColor:o?this.findObjectColor(o):"",isInverseIcon:Le&&h?1:0,isHollowIcon:Le&&w?1:0,isBlackPaint:Le&&X?1:0,aura:Le?fe:-1,characterIdentifier:we,standIdentifier:Ie,standName:Pe,isUseStandImage:Be};return e.addMessage(Fe)}sendOperationLog(e,i=1){for(const r of this.chatTabs){if(r.recieveOperationLogLevel<i)continue;let s={from:xt.peerContext.userId,name:We.myCursor.name,imageIdentifier:We.myCursor.imageIdentifier,timestamp:this.calcTimeStamp(r),tag:"opelog",text:rt.cr(e),color:We.myCursor.color};r.addMessage(s)}}static findId(e){let i=dt.instance.get(e);return i instanceof Gt?i.identifier:i instanceof We?i.userId:null}findObjectName(e){let i=dt.instance.get(e);return i instanceof Gt?i.name&&i.name.length?i.name:"\uff08\u7121\u540d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\uff09":i instanceof We?i.name&&i.name.length?i.name:"\uff08\u7121\u540d\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\uff09":e}findObjectColor(e){let i=dt.instance.get(e);return i instanceof Gt?i.chatPalette.color:i instanceof We?i.color:null}makeMessageName(e,i){let r=this.findObjectName(e);return null==i||i.length<1?r:r+" \u27a1 "+this.findObjectName(i)}findImageIdentifier(e,i=!1){let r=dt.instance.get(e);return r instanceof Gt?i&&r.faceIcon&&0<r.faceIcon.url.length?r.faceIcon.identifier:r.imageFile?r.imageFile.identifier:"":r instanceof We?r.imageIdentifier:e}findFaceIconIdentifier(e){let i=dt.instance.get(e);return i instanceof Gt&&i.faceIcon&&0<i.faceIcon.url.length?i.faceIcon.identifier:""}calcTimeStamp(e){let i=this.getTime(),r=e.latestTimeStamp;return i<=r?r+1:i}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=rn({token:t,factory:t.\u0275fac}),t})();const bj=["chatInput"],yj=["chatPlette"];function Cj(t,n){1&t&&(Q(0,"i",13),ye(1,"how_to_reg"),ie())}function xj(t,n){1&t&&(Q(0,"i",13),ye(1,"history_edu"),ie())}function wj(t,n){1&t&&ot(0,"badge",14),2&t&&re("count",_e().$implicit.unreadLength)}function Ej(t,n){if(1&t){const e=it();Q(0,"label")(1,"input",10),Ae("ngModelChange",function(r){return Oe(e),_e().chatTabidentifier=r}),ie(),Q(2,"div")(3,"span"),ye(4),ie(),Te(5,Cj,2,0,"i",11),Te(6,xj,2,0,"i",11),Te(7,wj,1,1,"badge",12),ie()()}if(2&t){const e=n.$implicit,i=_e();U(1),ht("value",e.identifier),re("ngModel",i.chatTabidentifier),U(2),Qe("cursor",i.chatTabidentifier!=e.identifier?"pointer":"")("color",""==e.name&&i.chatTabidentifier!=e.identifier?"gray":""),U(1),Xe(""==e.name?"(\u7121\u540d\u306e\u30bf\u30d6)":e.name),U(1),re("ngIf",e.isUseStandImage),U(1),re("ngIf",e.recieveOperationLogLevel>0),U(1),re("ngIf",e.hasUnread)}}function Tj(t,n){1&t&&(Q(0,"div",15)(1,"i",16),ye(2,"info_outline"),ie(),ye(3," \u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u7de8\u96c6\u4e2d\u3067\u3059"),ie())}function Sj(t,n){if(1&t&&(Q(0,"option",21),ye(1),ie()),2&t){const e=_e().$implicit;Qe("color",_e(3).color),ht("value",e),U(1),Xe(e)}}function Ij(t,n){if(1&t&&(Ke(0),Te(1,Sj,2,4,"option",20),Ye()),2&t){const e=n.$implicit,i=_e(3);U(1),re("ngIf",i.filter(e))}}function kj(t,n){if(1&t&&(Ke(0),Te(1,Ij,2,1,"ng-container",3),Ye()),2&t){const e=_e(2);U(1),re("ngForOf",e.palette.getPalette())}}function Mj(t,n){if(1&t){const e=it();Q(0,"div",17)(1,"select",18,19),Ae("input",function(r){return Oe(e),_e().selectPalette(r.target.value)})("click",function(r){return Oe(e),_e().clickPalette(r.target.value)}),Te(3,kj,2,1,"ng-container",9),ie()()}if(2&t){const e=_e();U(3),re("ngIf",e.palette)}}function Dj(t,n){if(1&t){const e=it();Q(0,"div",17)(1,"textarea",22),Ae("ngModelChange",function(r){return Oe(e),_e().editPalette=r}),ie()()}if(2&t){const e=_e();U(1),re("ngModel",e.editPalette)}}function Aj(t,n){1&t&&(Q(0,"span"),ye(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u7de8\u96c6"),ie())}function Pj(t,n){1&t&&(Q(0,"span"),ye(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u78ba\u5b9a"),ie())}let hu=(()=>{class t{constructor(e,i){this.chatMessageService=e,this.panelService=i,this.character=null,this._gameType="",this.chatTabidentifier="",this.text="",this.sendTo="",this.isEdit=!1,this.editPalette="",this.filterText="",this.doubleClickTimer=null,this.selectedPaletteIndex=-1}get palette(){return this.character.chatPalette}get color(){return this.chatInputComponent.color}get gameType(){return this._gameType?this._gameType:"DiceBot"}set gameType(e){this._gameType=e,this.character.chatPalette&&(this.character.chatPalette.dicebot=e)}get sendFrom(){return this.character.identifier}set sendFrom(e){this.onSelectedCharacter(e)}get diceBotInfos(){return Gn.diceBotInfos}get chatTab(){return dt.instance.get(this.chatTabidentifier)}get myPeer(){return We.myCursor}get otherPeers(){return dt.instance.getObjects(We)}ngOnInit(){Promise.resolve().then(()=>this.updatePanelTitle()),this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"",this.gameType=this.character.chatPalette?this.character.chatPalette.dicebot:"",ze.register(this).on("DELETE_GAME_OBJECT",e=>{this.character&&this.character.identifier===e.data.identifier&&this.panelService.close(),this.chatTabidentifier===e.data.identifier&&(this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"")})}ngOnDestroy(){ze.unregister(this),this.isEdit&&this.toggleEditMode()}updatePanelTitle(){this.panelService.title=this.character.name+" \u306e\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8"}onSelectedCharacter(e){this.isEdit&&this.toggleEditMode();let i=dt.instance.get(e);if(i instanceof Gt){this.character=i;let r=this.character.chatPalette?this.character.chatPalette.dicebot:"";0<r.length&&(this.gameType=r)}this.updatePanelTitle()}selectPalette(e){this.text=e}clickPalette(e){if(!this.chatPletteElementRef.nativeElement)return;const i=this.palette.evaluate(e,this.character.rootDataElement);this.doubleClickTimer&&this.selectedPaletteIndex===this.chatPletteElementRef.nativeElement.selectedIndex?(clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.chatInputComponent.sendChat(null)):(this.selectedPaletteIndex=this.chatPletteElementRef.nativeElement.selectedIndex,this.text=i,this.chatInputComponent.textAreaElementRef.nativeElement.value=this.text,this.doubleClickTimer=setTimeout(()=>{this.doubleClickTimer=null},400))}sendChat(e){if(this.chatTab){let i=this.palette.evaluate(e.text,this.character.rootDataElement);this.chatMessageService.sendMessage(this.chatTab,i,e.gameType,e.sendFrom,e.sendTo,e.color,e.isInverse,e.isHollow,e.isBlackPaint,e.aura,e.isUseFaceIcon,e.characterIdentifier,e.standIdentifier,e.standName,e.isUseStandImage),this.filterText=""}}resetPletteSelect(){!this.chatPletteElementRef.nativeElement||(this.chatPletteElementRef.nativeElement.selectedIndex=-1)}toggleEditMode(){this.isEdit=!this.isEdit,this.isEdit?this.editPalette=this.palette.value+"":this.palette.setPalette(this.editPalette)}filter(e){return null==this.filterText||""==this.filterText.trim()||e.search(this.filterText)>=0}}return t.\u0275fac=function(e){return new(e||t)(He(kr),He(An))},t.\u0275cmp=Xt({type:t,selectors:[["chat-palette"]],viewQuery:function(e,i){if(1&e&&(cn(bj,7),cn(yj,5)),2&e){let r;ln(r=un())&&(i.chatInputComponent=r.first),ln(r=un())&&(i.chatPletteElementRef=r.first)}},inputs:{character:"character"},decls:14,vars:11,consts:[[1,"flex-container"],[2,"flex-grow","0"],[1,"chat-tab"],[4,"ngFor","ngForOf"],[3,"onlyCharacters","chatTabidentifier","gameType","sendFrom","text","gameTypeChange","sendFromChange","textChange","chat"],["chatInput",""],["class","edit-info",4,"ngIf"],["style","flex-grow: 1; height: 0; min-height: 100px;",4,"ngIf"],["type","submit",3,"click"],[4,"ngIf"],["name","chat-tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],["class","material-icons small-font",4,"ngIf"],["class","badge",3,"count",4,"ngIf"],[1,"material-icons","small-font"],[1,"badge",3,"count"],[1,"edit-info"],[1,"material-icons",2,"vertical-align","bottom","size","0.8rem"],[2,"flex-grow","1","height","0","min-height","100px"],["size","5",1,"palette",2,"overflow-y","auto",3,"input","click"],["chatPlette",""],[3,"value","color",4,"ngIf"],[3,"value"],["placeholder","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8",1,"palette",2,"resize","none",3,"ngModel","ngModelChange"]],template:function(e,i){1&e&&(Q(0,"div",0)(1,"div",1)(2,"form")(3,"div",2),Te(4,Ej,8,10,"label",3),ie()(),Q(5,"chat-input",4,5),Ae("gameTypeChange",function(s){return i.gameType=s})("sendFromChange",function(s){return i.sendFrom=s})("textChange",function(s){return i.text=s})("chat",function(s){return i.sendChat(s)}),ie(),Te(7,Tj,4,0,"div",6),ie(),Te(8,Mj,4,1,"div",7),Te(9,Dj,2,1,"div",7),Q(10,"div",1)(11,"button",8),Ae("click",function(){return i.toggleEditMode()}),Te(12,Aj,2,0,"span",9),Te(13,Pj,2,0,"span",9),ie()()()),2&e&&(U(4),re("ngForOf",i.chatMessageService.chatTabs),U(1),re("onlyCharacters",!0)("chatTabidentifier",i.chatTabidentifier)("gameType",i.gameType)("sendFrom",i.sendFrom)("text",i.text),U(2),re("ngIf",i.isEdit),U(1),re("ngIf",!i.isEdit),U(1),re("ngIf",i.isEdit),U(3),re("ngIf",!i.isEdit),U(1),re("ngIf",i.isEdit))},styles:["[_nghost-%COMP%]{display:block;height:100%}.edit-info[_ngcontent-%COMP%]{width:100%;text-align:center;color:#ccc;background-color:#1e1e1ecc}.palette[_ngcontent-%COMP%]{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;width:100%;height:100%}.flex-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.chat-tab[_ngcontent-%COMP%]{padding:0 5px 5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:8px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:top;font-size:.6rem}"]}),t})();function Nj(t,n){if(1&t&&(Q(0,"div",11),ye(1),ie()),2&t){const e=_e(2);U(1),Xe(e.isSpeaking?"\u{1f603}":"\u{1f910}")}}const Fj=function(t){return{transform:t}},Oj=function(t){return{inverse:t}},Rj=function(t,n,e,i,r,s,o,a){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:s,yellow:o,white:a}},Bj=function(t,n){return{"black-paint":t,hollow:n}};function Lj(t,n){if(1&t){const e=it();Ke(0),Q(1,"div")(2,"div",5)(3,"div",6)(4,"span",7)(5,"img",8),Ae("dblclick",function(){return Oe(e),_e().openModal()}),Et(6,"safe"),ie()()()(),Q(7,"button",9),Ae("click",function(){return Oe(e),_e().openModal()}),Q(8,"b"),ye(9),ie()(),Te(10,Nj,2,1,"div",10),ie(),Ye()}if(2&t){const e=_e();U(2),re("ngStyle",ft(10,Fj,e.isApplyRoll?"rotate("+e.gameCharacter.roll+"deg)":"")),U(1),re("ngClass",ft(12,Oj,e.isApplyImageEffect&&e.gameCharacter.isInverse)),U(1),re("ngClass",uo(14,Rj,e.isApplyImageEffect&&0==e.gameCharacter.aura,e.isApplyImageEffect&&1==e.gameCharacter.aura,e.isApplyImageEffect&&2==e.gameCharacter.aura,e.isApplyImageEffect&&3==e.gameCharacter.aura,e.isApplyImageEffect&&4==e.gameCharacter.aura,e.isApplyImageEffect&&5==e.gameCharacter.aura,e.isApplyImageEffect&&6==e.gameCharacter.aura,e.isApplyImageEffect&&7==e.gameCharacter.aura)),U(1),re("src",Tt(6,7,e.standImage.url,"resourceUrl"),en)("ngClass",Yt(23,Bj,e.isApplyImageEffect&&e.gameCharacter.isBlackPaint,e.isApplyImageEffect&&e.gameCharacter.isHollow)),U(4),Rn("",e.isSpeakable?"\u901a\u5e38":"","\u753b\u50cf\u5909\u66f4"),U(1),re("ngIf",e.isSpeakable)}}function zj(t,n){if(1&t){const e=it();Ke(0),Q(1,"span",12)(2,"input",13),Ae("ngModelChange",function(r){return Oe(e),_e().nameElement.value=r}),ie()(),Ye()}if(2&t){const e=_e();U(2),re("ngModel",e.nameElement.value)}}function jj(t,n){if(1&t){const e=it();Ke(0),Q(1,"b",12),ye(2,"\u3000Cond: "),ie(),Q(3,"select",14),Ae("ngModelChange",function(r){return Oe(e),_e().conditionTypeElement.value=r}),Q(4,"option",15),ye(5,"\u30c7\u30d5\u30a9\u30eb\u30c8"),ie(),Q(6,"option",15),ye(7,"\u6307\u5b9a\u753b\u50cf"),ie(),Q(8,"option",15),ye(9,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e"),ie(),Q(10,"option",15),ye(11,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e \u307e\u305f\u306f \u6307\u5b9a\u753b\u50cf"),ie(),Q(12,"option",15),ye(13,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e \u304b\u3064 \u6307\u5b9a\u753b\u50cf"),ie(),Q(14,"option",15),ye(15,"\u9078\u629e\u6642\u306e\u307f"),ie()(),Ye()}if(2&t){const e=_e();U(3),re("ngModel",e.conditionTypeElement.value),U(1),ht("value",e.standConditionType.Default),U(2),ht("value",e.standConditionType.Image),U(2),ht("value",e.standConditionType.Postfix),U(2),ht("value",e.standConditionType.PostfixOrImage),U(2),ht("value",e.standConditionType.PostfixAndImage),U(2),ht("value",e.standConditionType.NotConditionStandUp)}}function Hj(t,n){if(1&t){const e=it();Ke(0),Q(1,"span",12)(2,"b",16),ye(3,"Tag: "),ie(),Q(4,"input",17),Ae("ngModelChange",function(r){return Oe(e),_e().nameElement.currentValue=r}),ie()(),Ye()}if(2&t){const e=_e();U(4),re("ngModel",e.nameElement.currentValue)}}function Uj(t,n){if(1&t){const e=it();Ke(0),Q(1,"label",18)(2,"input",19),Ae("ngModelChange",function(r){return Oe(e),_e().showNameElement.value=r})("change",function(){Oe(e);const r=_e();return r.showNameElement.value=r.showNameElement.value?"showName":""}),ie(),Q(3,"b",12),ye(4,"\u30cd\u30fc\u30e0\u30bf\u30b0"),ie()(),Ye()}if(2&t){const e=_e();U(2),ht("checked",e.showNameElement.value?"checked":""),re("ngModel",e.showNameElement.value)}}function Vj(t,n){if(1&t){const e=it();Ke(0),Q(1,"label",18)(2,"input",19),Ae("ngModelChange",function(r){return Oe(e),_e().applyImageEffectElement.value=r})("change",function(){Oe(e);const r=_e();return r.applyImageEffectElement.value=r.applyImageEffectElement.value?"applyImageEffect":""}),ie(),Q(3,"b",12),ye(4,"\u753b\u50cf\u52b9\u679c\u53cd\u6620"),ie()(),Ye()}if(2&t){const e=_e();U(2),ht("checked",e.applyImageEffectElement.value?"checked":""),re("ngModel",e.applyImageEffectElement.value)}}function Gj(t,n){if(1&t){const e=it();Ke(0),Q(1,"label",18)(2,"input",19),Ae("ngModelChange",function(r){return Oe(e),_e().applyRollElement.value=r})("change",function(){Oe(e);const r=_e();return r.applyRollElement.value=r.applyRollElement.value?"applyRoll":""}),ie(),Q(3,"b",12),ye(4,"\u56de\u8ee2\u53cd\u6620"),ie()(),Ye()}if(2&t){const e=_e();U(2),ht("checked",e.applyRollElement.value?"checked":""),re("ngModel",e.applyRollElement.value)}}function qj(t,n){if(1&t){const e=it();Ke(0),Q(1,"label",20)(2,"input",19),Ae("ngModelChange",function(r){return Oe(e),_e().applyDialogElement.value=r})("change",function(){Oe(e);const r=_e();return r.applyDialogElement.value=r.applyDialogElement.value?"applyDialog":""}),ie(),Q(3,"b",12),ye(4,"\u{1f4ad}"),ie()(),Ye()}if(2&t){const e=_e();U(2),ht("checked",e.applyDialogElement.value?"checked":""),re("ngModel",e.applyDialogElement.value)}}const Wj=function(t){return{"disabled-text":t}};function Kj(t,n){if(1&t){const e=it();Ke(0),ot(1,"br"),Q(2,"button",21),Ae("click",function(){return Oe(e),_e().testStandUp()}),Q(3,"b"),ye(4,"\u30c6\u30b9\u30c8 (\u81ea\u5206\u3060\u3051\u898b\u308b)"),Q(5,"sup",22),ye(6,"*"),ie()()(),Q(7,"label",23)(8,"input",19),Ae("ngModelChange",function(r){return Oe(e),_e().positionElement.currentValue=r})("change",function(){Oe(e);const r=_e();return r.positionElement.currentValue=r.positionElement.currentValue?"posSpecialize":""}),ie(),Q(9,"b",12),ye(10,"Pos\u500b\u5225\u6307\u5b9a: "),ie()(),Q(11,"span",24)(12,"input",25),Ae("ngModelChange",function(r){return Oe(e),_e().positionElement.value=r}),ie(),Q(13,"input",26),Ae("ngModelChange",function(r){return Oe(e),_e().positionElement.value=r}),ie(),Q(14,"b",27),ye(15,"%"),ie()(),Ye()}if(2&t){const e=_e();U(8),ht("checked",e.positionElement.currentValue?"checked":""),re("ngModel",e.positionElement.currentValue),U(4),re("ngModel",e.positionElement.value)("disabled",!e.positionElement.currentValue),U(1),re("ngModel",e.positionElement.value)("disabled",!e.positionElement.currentValue),U(1),re("ngClass",ft(7,Wj,!e.positionElement.currentValue))}}function Yj(t,n){if(1&t){const e=it();Ke(0),ot(1,"br"),Q(2,"span",24)(3,"b",28),ye(4,"Height (0=\u6307\u5b9a\u306a\u3057): "),ie(),Q(5,"input",29),Ae("ngModelChange",function(r){return Oe(e),_e().heightElement.value=r}),ie(),Q(6,"input",30),Ae("ngModelChange",function(r){return Oe(e),_e().heightElement.value=r}),ie(),Q(7,"b",31),ye(8,"%"),ie()(),Q(9,"span",32)(10,"b",28),ye(11,"AdjY: "),ie(),Q(12,"input",33),Ae("ngModelChange",function(r){return Oe(e),_e().heightElement.currentValue=r}),ie(),Q(13,"b",31),ye(14,"%"),ie()(),Ye()}if(2&t){const e=_e();U(5),re("ngModel",e.heightElement.value),U(1),re("ngModel",e.heightElement.value),U(6),re("ngModel",e.heightElement.currentValue)}}function Zj(t,n){if(1&t){const e=it();Q(0,"div")(1,"textarea",34),Ae("ngModelChange",function(r){return Oe(e),_e().postfixElement.value=r}),ie()()}if(2&t){const e=_e();U(1),re("ngModel",e.postfixElement.value)}}const Xj=function(t){return{"current-icon":t}};function Qj(t,n){if(1&t){const e=it();Q(0,"div",39)(1,"img",40),Ae("click",function(){Oe(e);const r=_e().$implicit;return _e(3).selectImage(r.identifier)}),Et(2,"safe"),ie()()}if(2&t){const e=_e().$implicit,i=_e(3);re("ngClass",ft(6,Xj,i.isSelectedImage(e.identifier))),U(1),re("src",Tt(2,3,e.url,"resourceUrl"),en)("alt",e.name)}}function Jj(t,n){if(1&t&&(Ke(0),Te(1,Qj,3,8,"div",38),Ye()),2&t){const e=n.$implicit;U(1),re("ngIf",0<e.url.length)}}function eH(t,n){if(1&t&&(Q(0,"div",36),Te(1,Jj,2,1,"ng-container",37),ie()),2&t){const e=_e(2);U(1),re("ngForOf",e.imageList)}}function tH(t,n){1&t&&(Q(0,"div"),ye(1,"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u753b\u50cf\u3001\u9854IC\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),ie())}function nH(t,n){if(1&t&&(Q(0,"div"),Te(1,eH,2,1,"div",35),Te(2,tH,2,0,"div",2),ie()),2&t){const e=_e();U(1),re("ngIf",e.imageList&&e.imageList.length>0),U(1),re("ngIf",!e.imageList||0==e.imageList.length)}}let UT=(()=>{class t{constructor(e){this.modalService=e,this.standElement=null,this.imageList=[],this.gameCharacter=null,this.isSpeaking=!1,this._imageFile=Ut.Empty,this.standConditionType=Mi}ngOnInit(){}get standImage(){if(!this.standElement)return this._imageFile;let e=null;if(this.isSpeaking&&(e=this.standElement.getFirstElementByName("speakingImageIdentifier"),e||(e=this.standElement.appendChild(_t.create("speakingImageIdentifier",Ut.Empty.identifier,{type:"image"},"speakingImageIdentifier_"+this.standElement.identifier)))),(!e||!e.value||e.value==Ut.Empty.identifier)&&(e=this.standElement.getFirstElementByName("imageIdentifier")),e){if(this._imageFile.identifier!==e.value){let i=Nt.instance.get(e.value);this._imageFile=i||Ut.Empty}}else{let i=Ut.createEmpty("stand_no_image").toContext();i.url="./assets/images/nc96424.png",this._imageFile=Nt.instance.add(i),this.standElement.appendChild(_t.create("imageIdentifier",this._imageFile.identifier,{type:"image"},"imageIdentifier_"+this.standElement.identifier))}return this._imageFile}get nameElement(){return this.standElement?this.standElement.getFirstElementByName("name")||this.standElement.appendChild(_t.create("name","",{},"name_"+this.standElement.identifier)):null}get heightElement(){return this.standElement?this.standElement.getFirstElementByName("height")||this.standElement.appendChild(_t.create("height",0,{currentValue:0},"height_"+this.standElement.identifier)):null}get conditionTypeElement(){return this.standElement?this.standElement.getFirstElementByName("conditionType")||this.standElement.appendChild(_t.create("conditionType",Mi.Default,{},"conditionType_"+this.standElement.identifier)):null}get postfixElement(){return this.standElement?this.standElement.getFirstElementByName("postfix")||this.standElement.appendChild(_t.create("postfix","",{},"postfix_"+this.standElement.identifier)):null}get applyImageEffectElement(){return this.standElement?this.standElement.getFirstElementByName("applyImageEffect")||this.standElement.appendChild(_t.create("applyImageEffect","",{},"applyImageEffect_"+this.standElement.identifier)):null}get applyRollElement(){return this.standElement?this.standElement.getFirstElementByName("applyRoll")||this.standElement.appendChild(_t.create("applyRoll","",{},"applyRoll_"+this.standElement.identifier)):null}get applyDialogElement(){return this.standElement?this.standElement.getFirstElementByName("applyDialog")||this.standElement.appendChild(_t.create("applyDialog","applyDialog",{},"applyDialog_"+this.standElement.identifier)):null}get showNameElement(){return this.standElement?this.standElement.getFirstElementByName("showName")||this.standElement.appendChild(_t.create("showName","showName",{},"showName_"+this.standElement.identifier)):null}get positionElement(){return this.standElement?this.standElement.getFirstElementByName("position")||this.standElement.appendChild(_t.create("position",0,{currentValue:""},"position_"+this.standElement.identifier)):null}get isApplyImageEffect(){let e=this.applyImageEffectElement;return!(!e||!e.value)}get isApplyRoll(){let e=this.applyRollElement;return!(!e||!e.value)}get isApplyDialog(){let e=this.applyDialogElement;return!(!e||!e.value)}get isShowName(){let e=this.showNameElement;return!(!e||!e.value)}get isSpeakable(){if(!this.standElement)return!1;const e=this.standElement.getFirstElementByName("speakingImageIdentifier");return e&&e.value&&e.value!==Ut.Empty.identifier}openModal(e="imageIdentifier",i=!1){if(!this.standElement)return;let r=[],s=this.standElement.getFirstElementByName(e);s?r=[s.value+""]:s=this.standElement.appendChild(_t.create(e,"",{type:"image"},e+"_"+this.standElement.identifier)),this.modalService.open(Ko,{isAllowedEmpty:i,currentImageIdentifires:r}).then(o=>{!o||(s.value=o)})}openSpeakingModal(){this.openModal("speakingImageIdentifier",!0)}remove(){!this.standElement||this.standElement.parent.removeChild(this.standElement)}selectImage(e){if(!this.standElement)return;let i=!1;for(let r of this.standElement.getElementsByName("targetImageIdentifier")){let s=!0;for(let o of this.imageList)if(o.identifier==r.value){s=!1;break}s?this.standElement.removeChild(r):r.value==e&&(i=!0,this.standElement.removeChild(r))}i||this.standElement.appendChild(_t.create("targetImageIdentifier",e,{},"targetImageIdentifier_"+ns.generateUuid()))}isSelectedImage(e){let i=this.standElement.getElementsByName("targetImageIdentifier");for(let r of i)if(r.value==e)return!0;return!1}testStandUp(){ze.trigger("POPUP_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier,standIdentifier:this.standElement.identifier,color:this.gameCharacter.chatPalette?this.gameCharacter.chatPalette.color:null}),ze.trigger("POPUP_CHAT_BALLOON",{characterIdentifier:this.gameCharacter.identifier,text:"\u3053\u308c\u306f\u30c6\u30b9\u30c8\u3067\u3059\u3001\u3042\u306a\u305f\u306b\u3060\u3051\u898b\u3048\u3066\u3044\u307e\u3059\u3002\u30b9\u30bf\u30f3\u30c9\u306e\u8a2d\u5b9a\u3092\u884c\u3046\u969b\u306f\u3001\u30e1\u30cb\u30e5\u30fc\u306e\u300c\u500b\u4eba\u8a2d\u5b9a\u300d\u304b\u3089\u300c\u900f\u660e\u5316\u3001\u81ea\u52d5\u9000\u53bb\u300d\u3092\u30aa\u30d5\u306b\u3059\u308b\u3068\u5fae\u8abf\u6574\u304c\u884c\u3044\u3084\u3059\u304f\u306a\u308a\u307e\u3059\u3002",color:this.gameCharacter.chatPalette?this.gameCharacter.chatPalette.color:null,dialogTest:!0})}}return t.\u0275fac=function(e){return new(e||t)(He(Fn))},t.\u0275cmp=Xt({type:t,selectors:[["stand-element"]],inputs:{standElement:"standElement",imageList:"imageList",gameCharacter:"gameCharacter",isSpeaking:"isSpeaking"},decls:20,vars:14,consts:[[1,"stand-container"],[1,"stand-image-container"],[4,"ngIf"],[2,"display","flex","flex-direction","column","padding-left","3px","width","100%"],[2,"font-size","9px",3,"click"],[3,"ngStyle"],[1,"inverser",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"stand-image",3,"src","ngClass","dblclick"],[1,"stand-image-button",2,"font-size","smaller","padding","2px 3px",3,"click"],["style","position: absolute; margin-top: -26px; margin-left: 120px; font-size: 22px; filter: grayscale(100%); opacity: 0.5; cursor: default;",4,"ngIf"],[2,"position","absolute","margin-top","-26px","margin-left","120px","font-size","22px","filter","grayscale(100%)","opacity","0.5","cursor","default"],[2,"font-size","smaller"],["type","text","placeholder","Name",2,"width","7em",3,"ngModel","ngModelChange"],[2,"width","15.5em",3,"ngModel","ngModelChange"],[3,"value"],[2,"margin-left","1em"],["type","text","placeholder","Tag",2,"width","3em",3,"ngModel","ngModelChange"],[2,"margin-right","0.6em"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"margin-right","0.2em"],[2,"font-size","9px","margin-right","1em",3,"click"],[1,"self-only"],[2,"margin-right","0.3em"],[2,"white-space","nowrap","font-size","smaller"],["type","range","min","0","max","100",2,"width","140px",3,"ngModel","disabled","ngModelChange"],["type","number","min","0","max","100",2,"width","3em","text-align","right",3,"ngModel","disabled","ngModelChange"],[2,"display","inline-block","font-size","smaller","margin-left","3px",3,"ngClass"],[2,"display","inline-block","margin-left","3px"],["type","range","min","0","max","100",2,"width","130px",3,"ngModel","ngModelChange"],["type","number","min","0","max","200",2,"width","3em","text-align","right",3,"ngModel","ngModelChange"],[2,"display","inline-block","font-size","smaller","margin-left","3px"],[2,"white-space","nowrap","margin-left","0.8em","font-size","smaller"],["type","number","min","-100","max","100",2,"width","3.4em","text-align","right",3,"ngModel","ngModelChange"],["placeholder","1\u884c\u306b\u4e00\u3064\u3001\u5192\u982d@\u3092\u4ed8\u3051\u308b\u3068\u30de\u30c3\u30c1\u6642\u306b\u30c6\u30ad\u30b9\u30c8\u304b\u3089\u5207\u308a\u53d6\u308a\r\n@\u6012\u308a\r\n@\u5fc5\u6bba\u6280",2,"width","100%","margin-top","3px","height","2.4rem",3,"ngModel","ngModelChange"],["style","display: flex; flex-wrap: wrap; margin-right: -30px;",4,"ngIf"],[2,"display","flex","flex-wrap","wrap","margin-right","-30px"],[4,"ngFor","ngForOf"],["class","icon-image-box",3,"ngClass",4,"ngIf"],[1,"icon-image-box",3,"ngClass"],[3,"src","alt","click"]],template:function(e,i){1&e&&(Q(0,"div")(1,"div",0)(2,"div",1),Te(3,Lj,11,26,"ng-container",2),ie(),Q(4,"div",3)(5,"div"),Te(6,zj,3,1,"ng-container",2),Te(7,jj,16,7,"ng-container",2),Te(8,Hj,5,1,"ng-container",2),ie(),Q(9,"div"),Te(10,Uj,5,2,"ng-container",2),Te(11,Vj,5,2,"ng-container",2),Te(12,Gj,5,2,"ng-container",2),Te(13,qj,5,2,"ng-container",2),Q(14,"button",4),Ae("click",function(){return i.openSpeakingModal()}),ye(15,"\u53e3\u30d1\u30af\u753b\u50cf (APNG\u306a\u3069)"),ie(),Te(16,Kj,16,9,"ng-container",2),Te(17,Yj,15,3,"ng-container",2),ie(),Te(18,Zj,2,1,"div",2),Te(19,nH,3,2,"div",2),ie()()()),2&e&&(U(3),re("ngIf",i.standImage),U(3),re("ngIf",i.nameElement),U(1),re("ngIf",i.conditionTypeElement),U(1),re("ngIf",i.nameElement),U(2),re("ngIf",i.showNameElement),U(1),re("ngIf",i.applyImageEffectElement),U(1),re("ngIf",i.applyRollElement),U(1),re("ngIf",i.applyDialogElement),U(1),Qe("font-weight",i.isSpeakable?"bolder":"normal"),U(2),re("ngIf",i.positionElement),U(1),re("ngIf",i.heightElement),U(1),re("ngIf",i.postfixElement&&(i.conditionTypeElement.value==i.standConditionType.Postfix||i.conditionTypeElement.value==i.standConditionType.PostfixOrImage||i.conditionTypeElement.value==i.standConditionType.PostfixAndImage)),U(1),re("ngIf",i.conditionTypeElement.value==i.standConditionType.Image||i.conditionTypeElement.value==i.standConditionType.PostfixOrImage||i.conditionTypeElement.value==i.standConditionType.PostfixAndImage))},directives:[bn,Ji,Yn,mi,$i,di,es,Ur,Vr,Jr,gs,Oo,Fo,ps,oi],pipes:[ai],styles:[".stand-container[_ngcontent-%COMP%]{display:flex;flex-direction:row}.stand-image-container[_ngcontent-%COMP%]{width:150px;height:150px}.stand-image[_ngcontent-%COMP%]{width:150px;height:150px;-o-object-fit:contain;object-fit:contain;transform-origin:bottom;z-index:5}.stand-image-button[_ngcontent-%COMP%]{display:block;margin-top:-154px;margin-left:-4px;position:relative;z-index:10}.postfix-text[_ngcontent-%COMP%]{width:8em}.position-indicate[_ngcontent-%COMP%]{display:inline-block;font-size:smaller;width:3em}.remove-button[_ngcontent-%COMP%]{font-weight:bolder;color:red;background-color:transparent}.remove-button[_ngcontent-%COMP%]:hover{background-color:#eee}.icon-image-box[_ngcontent-%COMP%]{position:relative;width:50px;height:50px;max-width:50px;max-height:50px;border-radius:.5rem;color:#000;z-index:100;margin-top:1px;margin-bottom:1px;margin-left:2px}.icon-image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:.5rem;border:2px solid transparent}.icon-image-box[_ngcontent-%COMP%]:hover{z-index:600}.icon-image-box[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{border:2px dotted rgba(255,0,0,40)}.icon-image-box.current-icon[_ngcontent-%COMP%]{z-index:500}.icon-image-box.current-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid red}.icon-image-box[_ngcontent-%COMP%]:not(.current-icon){z-index:400}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #fff)}.disabled-text[_ngcontent-%COMP%]{color:gray}.self-only[_ngcontent-%COMP%]{color:red}"]}),t})();function iH(t,n){if(1&t){const e=it();Q(0,"div",14)(1,"div",15)(2,"div",16)(3,"input",17),Ae("click",function(){const s=Oe(e).index;return _e().overviewIndex=s}),ie()(),Q(4,"div",18),ot(5,"stand-element",19,20),ie(),Q(7,"div",21)(8,"button",22),Ae("click",function(){const r=Oe(e),s=r.$implicit,o=r.index;return _e().delele(s,o)}),ye(9,"\xd7"),ie(),Q(10,"button",23),Ae("click",function(){const s=Oe(e).$implicit;return _e().upStandIndex(s)}),ye(11,"\u2191"),ie(),Q(12,"button",24),Ae("click",function(){const s=Oe(e).$implicit;return _e().downStandIndex(s)}),ye(13,"\u2193"),ie()()(),ot(14,"hr"),ie()}if(2&t){const e=n.$implicit,i=n.index,r=_e();U(1),Qe("border-color",r.overviewIndex==i?"red":"transparent"),U(2),Zi("name","",r.panelId,"_overviewIndex"),ht("value",i),re("checked",r.overviewIndex==i),U(2),re("standElement",e)("imageList",r.imageList)("gameCharacter",r.character)}}function rH(t,n){if(1&t){const e=it();Q(0,"button",12),Ae("click",function(){return Oe(e),_e().restore()}),ye(1,"\u76f4\u524d\u306b\u524a\u9664\u3057\u305f\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u3092\u623b\u3059"),ie()}}let Jp=(()=>{class t{constructor(e,i,r){this.panelService=e,this.pointerDeviceService=i,this.modalService=r,this.character=null,this.standSettingXML="",this.isSpeaking=!1}get standElements(){return this.character.standList.standElements}get imageList(){if(!this.character)return[];let e=[],i={};const s=this.character.imageDataElement.getElementsByName("imageIdentifier").concat(this.character.imageDataElement.getElementsByName("faceIcon"));for(let o of s){if(i[o.value])continue;let a=this.imageElementToFile(o);a&&(i[o.value]=!0,e.push(a))}return e}get position(){return this.character&&this.character.standList?this.character.standList.position:0}set position(e){!this.character||!this.character.standList||(this.character.standList.position=e)}get height(){return this.character&&this.character.standList?this.character.standList.height:0}set height(e){!this.character||!this.character.standList||(this.character.standList.height=e)}get overviewIndex(){return this.character&&this.character.standList?this.character.standList.overviewIndex:-1}set overviewIndex(e){!this.character||!this.character.standList||(this.character.standList.overviewIndex=e)}ngOnInit(){Promise.resolve().then(()=>this.updatePanelTitle()),ze.register(this).on("DELETE_GAME_OBJECT",-1e3,e=>{this.character&&this.character.identifier===e.data.identifier&&this.panelService.close()}),this.panelId=ns.generateUuid()}ngAfterViewInit(){this._intervalId=setInterval(()=>{this.isSpeaking=!this.isSpeaking,this.standElementComponents.forEach(e=>{e.isSpeaking=this.isSpeaking})},3600)}ngOnDestroy(){clearInterval(this._intervalId),ze.unregister(this)}updatePanelTitle(){this.panelService.title=this.character.name+" \u306e\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a"}add(){this.character.standList.add(this.character.imageFile.identifier),this.standSettingXML=""}delele(e,i){ze.call("DELETE_STAND_IMAGE",{characterIdentifier:this.character.identifier,identifier:e.identifier}),this.character&&this.character.standList&&this.modalService.open(er,{title:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u306e\u524a\u9664",text:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u3092\u524a\u9664\u3057\u307e\u3059\u304b\uff1f",type:Si.OK_CANCEL,materialIcon:"person_off",action:()=>{this.standSettingXML=e.toXml(),this.character.standList.removeChild(e)&&(this.character.standList.overviewIndex==i?this.character.standList.overviewIndex=-1:this.character.standList.overviewIndex>i&&(this.character.standList.overviewIndex-=1))}})}restore(){if(!this.standSettingXML)return;let e=ti.instance.parseXml(this.standSettingXML);this.character.standList.appendChild(e),this.standSettingXML=""}upStandIndex(e){this.standSettingXML="";let i=this.character.standList,r=i.children.indexOf(e);0<r&&(i.insertBefore(e,i.children[r-1]),this.character.standList.overviewIndex==r?this.character.standList.overviewIndex-=1:this.character.standList.overviewIndex==r-1&&(this.character.standList.overviewIndex+=1))}downStandIndex(e){this.standSettingXML="";let i=this.character.standList,r=i.children.indexOf(e);r<i.children.length-1&&(i.insertBefore(i.children[r+1],e),this.character.standList.overviewIndex==r?this.character.standList.overviewIndex+=1:this.character.standList.overviewIndex==r+1&&(this.character.standList.overviewIndex-=1))}helpStandSeteing(){let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(du,{left:e.x,top:e.y,width:600,height:590});r.title="\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u30d8\u30eb\u30d7",r.text='\u3000\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306e\u30b9\u30bf\u30f3\u30c9\u306e\u540d\u524d\u3001\u4f4d\u7f6e\u3068\u753b\u50cf\u306e\u9ad8\u3055\uff08\u305d\u308c\u305e\u308c\u753b\u9762\u30b5\u30a4\u30ba\u306b\u5bfe\u3059\u308b\u76f8\u5bfe\u6307\u5b9a\uff09\u3001\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u306b\u30b9\u30bf\u30f3\u30c9\u304c\u8868\u793a\u3055\u308c\u308b\u6761\u4ef6\u3092\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\n\n\u3000\u30b9\u30bf\u30f3\u30c9\u306b\u540d\u524d\u3092\u8a2d\u5b9a\u3057\u305f\u5834\u5408\u3001\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3001\u30c1\u30e3\u30c3\u30c8\u30d1\u30cd\u30eb\u306e\u30ea\u30b9\u30c8\u306b\u8868\u793a\u3055\u308c\u3001\u9078\u629e\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\u307e\u305f\u3001\u30bf\u30b0\u3092\u8a2d\u5b9a\u3057\u305f\u5834\u5408\u3001\u7570\u306a\u308b\u30bf\u30b0\u3067\u306f\u540c\u3058\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3067\u3042\u3063\u3066\u3082\u767b\u5834\u3001\u9000\u53bb\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u304c\u884c\u308f\u308c\u307e\u3059\u3002\n\n\u3000\u753b\u50cf\u306e\u4f4d\u7f6e\u3068\u9ad8\u3055\u306f\u500b\u5225\u6307\u5b9a\u3082\u53ef\u80fd\u3067\u3059\u3001\u4f4d\u7f6e\u306e\u500b\u5225\u6307\u5b9a\u306f\u30c1\u30a7\u30c3\u30af\u306a\u3057\u3001\u9ad8\u3055\u306f0\u3068\u3057\u305f\u5834\u5408\u306b\u5168\u4f53\u306e\u8a2d\u5b9a\u304c\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002\u7e26\u4f4d\u7f6e\u8abf\u6574(AdjY)\u306f\u3001\u30b9\u30bf\u30f3\u30c9\u753b\u50cf\u306e\u9ad8\u3055\u306b\u5bfe\u3059\u308b\u76f8\u5bfe\u6307\u5b9a\u3068\u306a\u308a\u307e\u3059\uff08\u4f8b\u3048\u3070\u3001-50%\u3068\u3059\u308b\u3068\u753b\u50cf\u306e\u4e0b\u534a\u5206\u304c\u753b\u9762\u7aef\u3088\u308a\u4e0b\u306b\u96a0\u308c\u307e\u3059\uff09\u3002\n\n\u3000\u6761\u4ef6\u306e\u300c\u6307\u5b9a\u753b\u50cf\u300d\u306f\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u753b\u50cf\u3042\u308b\u3044\u306f\u9854IC\u3067\u3059\u3002\u307e\u305f\u3001\u7279\u5225\u306a\u6761\u4ef6\u3068\u3057\u3066\u5e38\u306b\u3001\u30c1\u30e3\u30c3\u30c8\u30c6\u30ad\u30b9\u30c8\u306e\u672b\u5c3e\u304c"@\u9000\u53bb"\u307e\u305f\u306f"@farewell"\u306e\u5834\u5408\u306f\u3001\u305d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306e\u30b9\u30bf\u30f3\u30c9\u3092\u9000\u53bb\u3055\u305b\u307e\u3059\u3002\n\n\u3000\u512a\u5148\u9806\u4f4d\u306f\u9ad8\u3044\u3082\u306e\u304b\u3089\n\n\u3000\u3000\uff11. "@\u9000\u53bb"\u3001"@farewell"\u306b\u3088\u308b\u9000\u53bb\n\u3000\u3000\uff12. \u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3001\u30c1\u30e3\u30c3\u30c8\u30d1\u30cd\u30eb\u306e\u30ea\u30b9\u30c8\u3067\u9078\u629e\u3057\u305f\u540d\u524d\n\u3000\u3000\uff13. \u300c\u6307\u5b9a\u753b\u50cf \u304b\u3064 \u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u300d\n\u3000\u3000\uff14. \u300c\u6307\u5b9a\u753b\u50cf \u307e\u305f\u306f \u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u300d\n\u3000\u3000\uff15. \u300c\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u300d\n\u3000\u3000\uff16. \u300c\u6307\u5b9a\u753b\u50cf\u300d\n\n\u3000\u3069\u306e\u6761\u4ef6\u3082\u6e80\u305f\u3055\u306a\u3044\u5834\u5408\u300c\u30c7\u30d5\u30a9\u30eb\u30c8\u300d\u306e\u3082\u306e\u304c\u4f7f\u7528\u3055\u308c\u3001\u540c\u3058\u512a\u5148\u9806\u4f4d\u306e\u6761\u4ef6\u304c\u8907\u6570\u3042\u308b\u5834\u5408\u306f\u30e9\u30f3\u30c0\u30e0\u30671\u3064\u304c\u9078\u629e\u3055\u308c\u307e\u3059\u3002\n\n\u3000\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u4e00\u81f4\u3092\u5224\u5b9a\u3059\u308b\u969b\u3001\u5168\u89d2\u534a\u89d2\u3001\u30a2\u30eb\u30d5\u30a1\u3079\u30c3\u30c8\u306e\u5927\u6587\u5b57\u5c0f\u6587\u5b57\u306f\u533a\u5225\u3055\u308c\u307e\u305b\u3093\u3002\n\u3000\u307e\u305f\u3001"@\u9000\u53bb"\u3001"@farewell"\u306b\u3088\u308b\u9000\u53bb\u6642\u3001\u3042\u308b\u3044\u306f"@\u7b11\u3044"\u306e\u3088\u3046\u306b\u5148\u982d\u304c"@"\u3067\u59cb\u307e\u308b\u6761\u4ef6\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u5834\u5408\u3001\uff08\u30b9\u30bf\u30f3\u30c9\u306e\u6709\u52b9\u7121\u52b9\u3001\u6761\u4ef6\u3092\u6e80\u305f\u3059\u304b\u306b\u95a2\u308f\u3089\u305a\uff09\u305d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3067\u306e\u9001\u4fe1\u6642\u306b\u3001\u6761\u4ef6\u306b\u4e00\u81f4\u3059\u308b\u30c1\u30e3\u30c3\u30c8\u30c6\u30ad\u30b9\u30c8\u672b\u5c3e\u306e@\u4ee5\u4e0b\u306f\u5207\u308a\u843d\u3068\u3055\u308c\u307e\u3059\u3002'}imageElementToFile(e){return e?Nt.instance.get(e.value):null}}return t.\u0275fac=function(e){return new(e||t)(He(An),He(fi),He(Fn))},t.\u0275cmp=Xt({type:t,selectors:[["app-stand-setting"]],viewQuery:function(e,i){if(1&e&&cn(UT,5),2&e){let r;ln(r=un())&&(i.standElementComponents=r)}},inputs:{character:"character"},decls:27,vars:10,consts:[[2,"margin-bottom","4px"],[2,"float","right",3,"click"],[1,"position-indicate"],["type","range","min","0","max","100",2,"width","350px",3,"ngModel","ngModelChange"],["type","number","min","0","max","100",2,"width","3em","text-align","right","margin-right","3px",3,"ngModel","ngModelChange"],["sytle","margin-left: 3px; margin-right: 1em "],["type","number","min","0","max","200",2,"width","3em","text-align","right","margin-right","3px",3,"ngModel","ngModelChange"],[1,"overview-selecter",2,"padding","0px","width","695px"],[2,"font-size","smaller","font-weight","bolder"],["type","radio","value","-1",3,"name","checked","click"],[2,"display","flex","flex-direction","row","flex-wrap","wrap"],["style","width: 700px",4,"ngFor","ngForOf"],[3,"click"],[3,"click",4,"ngIf"],[2,"width","700px"],[1,"overview-selecter",2,"display","flex","flex-direction","row","justify-content","space-between"],[2,"display","flex","align-items","center","justify-content","center"],["type","radio",2,"z-index","10",3,"name","value","checked","click"],[2,"margin-left","-1em","margin-right","-1em"],[3,"standElement","imageList","gameCharacter"],["standElementComponent",""],[2,"text-align","right","width","3em"],[1,"remove-button","danger",3,"click"],[1,"remove-button",2,"margin-top","5px",3,"click"],[1,"remove-button",2,"margin-top","2px",3,"click"]],template:function(e,i){1&e&&(Q(0,"div",0)(1,"button",1),Ae("click",function(){return i.helpStandSeteing()}),ye(2,"?"),ie(),Q(3,"div",2)(4,"b"),ye(5,"Pos: "),ie(),Q(6,"input",3),Ae("ngModelChange",function(s){return i.position=s}),ie(),Q(7,"input",4),Ae("ngModelChange",function(s){return i.position=s}),ie(),Q(8,"b",5),ye(9,"\uff05\u3000"),ie()(),Q(10,"div",2)(11,"b"),ye(12,"Height (0=\u5143\u753b\u50cf\u306e\u307e\u307e): "),ie(),Q(13,"input",3),Ae("ngModelChange",function(s){return i.height=s}),ie(),Q(14,"input",6),Ae("ngModelChange",function(s){return i.height=s}),ie(),Q(15,"b",5),ye(16,"\uff05"),ie()()(),Q(17,"div",7)(18,"label",8)(19,"input",9),Ae("click",function(){return i.overviewIndex=-1}),ie(),ye(20," \u30b9\u30bf\u30f3\u30c9\u753b\u50cf\u3092\u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u4f7f\u7528\u3057\u306a\u3044"),ie()(),ot(21,"hr"),Q(22,"div",10),Te(23,iH,15,8,"div",11),ie(),Q(24,"button",12),Ae("click",function(){return i.add()}),ye(25,"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u306e\u8ffd\u52a0"),ie(),Te(26,rH,2,0,"button",13)),2&e&&(U(6),re("ngModel",i.position),U(1),re("ngModel",i.position),U(6),re("ngModel",i.height),U(1),re("ngModel",i.height),U(3),Qe("border-color",-1==i.overviewIndex?"red":"transparent"),U(2),Zi("name","",i.panelId,"_overviewIndex"),re("checked",-1==i.overviewIndex),U(4),re("ngForOf",i.standElements),U(3),re("ngIf",i.standSettingXML))},directives:[gs,mi,$i,di,Oo,Fo,ps,oi,UT,bn],styles:[".position-indicate[_ngcontent-%COMP%]{display:inline-block;font-size:smaller}.description[_ngcontent-%COMP%]{font-size:smaller}.remove-button[_ngcontent-%COMP%]{display:inline-block;font-weight:bolder;font-size:smaller;margin-top:-4px;margin-right:-1px}.overview-selecter[_ngcontent-%COMP%]{border:2px solid red;border-radius:8px;padding-top:1px;padding-bottom:4px}input[type=radio][_ngcontent-%COMP%]{width:1.5em;height:1.5em}"]}),t})();var eg;let li=eg=class extends Ci{constructor(n=ns.generateUuid()){super(n),this.isLocked=!1,this.rotate=0,this.followingCharctorIdentifier=null,this.followingCounterDummy=0,this.offSetX=!1,this.offSetY=!1,this.type="CORN",this.subDivisionSnapPolygonal=!0,this.fillType=1,this.isExpandByFollowing=!1,this.isFollowAltitude=!1,this.followingCharactorCache=null,this.gridSize=50,this.isAltitudeIndicate=!0,this.followingCharctorIdentifier=null}get name(){return this.getCommonValue("name","")}get length(){return this.getCommonValue("length",1)}get width(){return this.getCommonValue("width",1)}get opacity(){let n=this.getElement("opacity",this.commonDataElement),e=n?n.currentValue/n.value:1;return Number.isNaN(e)?1:e}get rangeColor(){let n=this.getElement("color",this.commonDataElement);return n?n.value+"":"#ff0000"}set rangeColor(n){this.setCommonValue("color",n)}get gridColor(){let n=this.getElement("color",this.commonDataElement);return n?n.currentValue+"":"#ffff00"}set gridColor(n){let e=this.getElement("color",this.commonDataElement);e&&(e.currentValue=n)}get isApplyWidth(){return"LINE"===this.type||"CORN"===this.type}get followingCharactor(){if(this.followingCharctorIdentifier){if(!this.followingCharactorCache||this.followingCharactorCache.identifier!==this.followingCharctorIdentifier){let n=dt.instance.get(this.followingCharctorIdentifier);n&&n instanceof Gt?this.followingCharactorCache=n:(this.followingCharctorIdentifier=null,this.followingCharactorCache=null)}}else this.followingCharactorCache=null;return this.followingCharactorCache}set followingCharactor(n){n?(this.followingCharactorCache=n,this.followingCharctorIdentifier=n.identifier):(this.followingCharactorCache=null,this.followingCharctorIdentifier=null)}followingCounterDummyCount(){this.followingCounterDummy++,this.followingCounterDummy>=50&&(this.followingCounterDummy=0)}following(){if(!this.followingCharactor||this.followingCharactor.isHideIn)return console.log("\u8ffd\u5f93\u5bfe\u8c61\u898b\u5931\u3044"),void(this.followingCharactor=null);this.location.x=this.followingCharactor.location.x+this.gridSize*this.followingCharactor.size/2,this.location.y=this.followingCharactor.location.y+this.gridSize*this.followingCharactor.size/2,this.isFollowAltitude&&(this.altitude=this.followingCharactor.altitude,this.posZ=this.followingCharactor.posZ),this.followingCounterDummyCount()}static create(n,e,i,r,s){let o=null;return o=s?new eg(s):new eg,o.createDataElements(),o.commonDataElement.appendChild(_t.create("name",n,{},"name_"+o.identifier)),o.commonDataElement.appendChild(_t.create("length",i,{},"length_"+o.identifier)),o.commonDataElement.appendChild(_t.create("width",e,{},"width_"+o.identifier)),o.commonDataElement.appendChild(_t.create("opacity",r,{type:"numberResource",currentValue:r},"opacity_"+o.identifier)),o.commonDataElement.appendChild(_t.create("color","#ff0000",{type:"colors",currentValue:"#ffff00"},"ccolor_"+o.identifier)),o.commonDataElement.appendChild(_t.create("altitude",0,{},"altitude_"+o.identifier)),o.initialize(),o}};$e([at()],li.prototype,"isLocked",void 0),$e([at()],li.prototype,"rotate",void 0),$e([at()],li.prototype,"followingCharctorIdentifier",void 0),$e([at()],li.prototype,"followingCounterDummy",void 0),$e([at()],li.prototype,"offSetX",void 0),$e([at()],li.prototype,"offSetY",void 0),$e([at()],li.prototype,"type",void 0),$e([at()],li.prototype,"subDivisionSnapPolygonal",void 0),$e([at()],li.prototype,"fillType",void 0),$e([at()],li.prototype,"isExpandByFollowing",void 0),$e([at()],li.prototype,"isFollowAltitude",void 0),li=eg=$e([ni("range")],li);var Yo,uf=(()=>(function(t){t.ASC="ASC",t.DESC="DESC"}(uf||(uf={})),uf))();let Zo=Yo=class extends Ga{constructor(){super(...arguments),this.sortTag="name",this.sortOrder=uf.ASC,this.dataTag="HP MP \u654f\u6377\u5ea6 \u751f\u547d\u529b \u7cbe\u795e\u529b"}static get instance(){return Yo._instance||(Yo._instance=new Yo("DataSummarySetting"),Yo._instance.initialize()),Yo._instance}get dataTags(){return this._dataTag!==this.dataTag&&(this._dataTag=this.dataTag,this._dataTags=null!=this.dataTag&&0<this.dataTag.trim().length?this.dataTag.trim().split(/\s+/):[]),this._dataTags}innerXml(){return""}parseInnerXml(n){let e=Yo.instance.toContext();e.syncData=this.toContext().syncData,Yo.instance.apply(e),Yo.instance.update(),this.destroy()}};var tg;$e([at()],Zo.prototype,"sortTag",void 0),$e([at()],Zo.prototype,"sortOrder",void 0),$e([at()],Zo.prototype,"dataTag",void 0),Zo=Yo=$e([ni("summary-setting")],Zo);let is=tg=class extends Ci{constructor(){super(...arguments),this.isLock=!1,this.blendType=0,this.isTransparentOnGMMode=!1}get name(){return this.getCommonValue("name","")}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get opacity(){let n=this.getElement("opacity",this.commonDataElement),e=n?n.currentValue/n.value:1;return Number.isNaN(e)?1:e}get fontsize(){let n=this.getElement("fontsize",this.commonDataElement);return!n&&this.commonDataElement&&this.commonDataElement.appendChild(_t.create("fontsize",18,{},"fontsize_"+this.identifier)),n?+n.value:18}set fontsize(n){this.setCommonValue("fontsize",n)}get text(){let n=this.getElement("text",this.commonDataElement);return!n&&this.commonDataElement&&this.commonDataElement.appendChild(_t.create("text","",{type:"note",currentValue:""},"text_"+this.identifier)),n?n.value+"":""}set text(n){this.setCommonValue("text",n)}get color(){let n=this.getElement("color",this.commonDataElement);return n?n.value+"":"#555555"}set color(n){this.setCommonValue("color",n)}get bgcolor(){let n=this.getElement("color",this.commonDataElement);return n?n.currentValue+"":"#0a0a0a"}set bgcolor(n){let e=this.getElement("color",this.commonDataElement);e&&(e.currentValue=n)}static create(n,e,i,r,s){let o=null;return o=s?new tg(s):new tg,o.createDataElements(),o.commonDataElement.appendChild(_t.create("name",n,{},"name_"+o.identifier)),o.commonDataElement.appendChild(_t.create("width",e,{},"width_"+o.identifier)),o.commonDataElement.appendChild(_t.create("height",i,{},"height_"+o.identifier)),o.commonDataElement.appendChild(_t.create("opacity",r,{type:"numberResource",currentValue:r},"opacity_"+o.identifier)),o.commonDataElement.appendChild(_t.create("fontsize",18,{},"fontsize_"+o.identifier)),o.commonDataElement.appendChild(_t.create("text","",{type:"note",currentValue:""},"text_"+o.identifier)),o.commonDataElement.appendChild(_t.create("color","#555555",{type:"colors",currentValue:"#0a0a0a"},"ccolor_"+o.identifier)),o.commonDataElement.appendChild(_t.create("altitude",0,{},"altitude_"+o.identifier)),o.initialize(),o}};$e([at()],is.prototype,"isLock",void 0),$e([at()],is.prototype,"blendType",void 0),$e([at()],is.prototype,"isTransparentOnGMMode",void 0),is=tg=$e([ni("table-mask")],is);var ng,_a=(()=>(function(t){t[t.NULL=0]="NULL",t[t.FLOOR=1]="FLOOR",t[t.WALL=2]="WALL",t[t.ALL=3]="ALL"}(_a||(_a={})),_a))(),ci=(()=>(function(t){t[t.NONE=0]="NONE",t[t.TOP=1]="TOP",t[t.BOTTOM=2]="BOTTOM",t[t.LEFT=3]="LEFT",t[t.RIGHT=4]="RIGHT"}(ci||(ci={})),ci))();let ur=ng=class extends Ci{constructor(){super(...arguments),this.isLocked=!1,this.mode=_a.ALL,this.rotate=0,this.isDropShadow=!0,this.isSurfaceShading=!0,this.isInteract=!0,this.isSlope=!1,this.slopeDirection=ci.NONE}get width(){return this.getCommonValue("width",1)}set width(n){this.setCommonValue("width",n)}get height(){return this.getCommonValue("height",1)}set height(n){this.setCommonValue("height",n)}get depth(){return this.getCommonValue("depth",1)}set depth(n){this.setCommonValue("depth",n)}get name(){return this.getCommonValue("name","")}set name(n){this.setCommonValue("name",n)}get wallImage(){return this.getImageFile("wall")}get floorImage(){return this.getImageFile("floor")}get hasWall(){return!!(this.mode&_a.WALL)}get hasFloor(){return!!(this.mode&_a.FLOOR)}static create(n,e,i,r,s,o,a){let h=null;return h=a?new ng(a):new ng,h.createDataElements(),h.commonDataElement.appendChild(_t.create("name",n,{},"name_"+h.identifier)),h.commonDataElement.appendChild(_t.create("width",e,{},"width_"+h.identifier)),h.commonDataElement.appendChild(_t.create("height",r,{},"height_"+h.identifier)),h.commonDataElement.appendChild(_t.create("depth",i,{},"depth_"+h.identifier)),h.commonDataElement.appendChild(_t.create("altitude",0,{},"altitude_"+h.identifier)),h.imageDataElement.appendChild(_t.create("wall",s,{type:"image"},"wall_"+h.identifier)),h.imageDataElement.appendChild(_t.create("floor",o,{type:"image"},"floor_"+h.identifier)),h.initialize(),h}};$e([at()],ur.prototype,"isLocked",void 0),$e([at()],ur.prototype,"mode",void 0),$e([at()],ur.prototype,"rotate",void 0),$e([at()],ur.prototype,"isDropShadow",void 0),$e([at()],ur.prototype,"isSurfaceShading",void 0),$e([at()],ur.prototype,"isInteract",void 0),$e([at()],ur.prototype,"isSlope",void 0),$e([at()],ur.prototype,"slopeDirection",void 0),ur=ng=$e([ni("terrain")],ur);var Gs=(()=>(function(t){t[t.NONE=-1]="NONE",t[t.SQUARE=0]="SQUARE",t[t.HEX_VERTICAL=1]="HEX_VERTICAL",t[t.HEX_HORIZONTAL=2]="HEX_HORIZONTAL"}(Gs||(Gs={})),Gs))(),ig=(()=>(function(t){t.NONE="",t.WHITE="white",t.BLACK="black"}(ig||(ig={})),ig))();let Vi=class extends Vn{constructor(){super(...arguments),this.name="\u30c6\u30fc\u30d6\u30eb",this.width=20,this.height=20,this.gridSize=50,this.imageIdentifier="imageIdentifier",this.backgroundImageIdentifier="imageIdentifier",this.backgroundFilterType=ig.NONE,this.selected=!1,this.gridType=Gs.SQUARE,this.gridColor="#000000e6",this.isShowNumber=!0,this.gridHeight=0}get terrains(){let n=[];return this.children.forEach(e=>{e instanceof ur&&n.push(e)}),n}get masks(){let n=[];return this.children.forEach(e=>{e instanceof is&&n.push(e)}),n}onStoreAdded(){super.onStoreAdded(),this.selected&&ze.trigger("SELECT_GAME_TABLE",{identifier:this.identifier})}};var rg;$e([at()],Vi.prototype,"name",void 0),$e([at()],Vi.prototype,"width",void 0),$e([at()],Vi.prototype,"height",void 0),$e([at()],Vi.prototype,"gridSize",void 0),$e([at()],Vi.prototype,"imageIdentifier",void 0),$e([at()],Vi.prototype,"backgroundImageIdentifier",void 0),$e([at()],Vi.prototype,"backgroundFilterType",void 0),$e([at()],Vi.prototype,"selected",void 0),$e([at()],Vi.prototype,"gridType",void 0),$e([at()],Vi.prototype,"gridColor",void 0),$e([at()],Vi.prototype,"isShowNumber",void 0),Vi=$e([ni("game-table")],Vi);let Mr=rg=class extends Ci{constructor(){super(...arguments),this.rotate=0,this.zindex=0,this.password="",this.isUpright=!0,this.isLocked=!1,this.isWhiteOut=!1}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get fontSize(){return this.getCommonValue("fontsize",1)}get title(){return this.getCommonValue("title","")}get text(){return this.getCommonValue("text","")}set text(n){this.setCommonValue("text",n)}get color(){return this.getCommonValue("color","#444444")}set color(n){this.setCommonValue("color",n)}toTopmost(){av(this)}static create(n,e,i=16,r=1,s=1,o){let a=o?new rg(o):new rg;return a.createDataElements(),a.commonDataElement.appendChild(_t.create("width",r,{},"width_"+a.identifier)),a.commonDataElement.appendChild(_t.create("height",s,{},"height_"+a.identifier)),a.commonDataElement.appendChild(_t.create("fontsize",i,{},"fontsize_"+a.identifier)),a.commonDataElement.appendChild(_t.create("title",n,{},"title_"+a.identifier)),a.commonDataElement.appendChild(_t.create("text",e,{type:"note",currentValue:e},"text_"+a.identifier)),a.commonDataElement.appendChild(_t.create("color","#444444",{type:"color"},"ccolor_"+a.identifier)),a.commonDataElement.appendChild(_t.create("altitude",0,{},"altitude_"+a.identifier)),a.initialize(),a}};$e([at()],Mr.prototype,"rotate",void 0),$e([at()],Mr.prototype,"zindex",void 0),$e([at()],Mr.prototype,"password",void 0),$e([at()],Mr.prototype,"isUpright",void 0),$e([at()],Mr.prototype,"isLocked",void 0),$e([at()],Mr.prototype,"isWhiteOut",void 0),Mr=rg=$e([ni("text-note")],Mr);let cv=class extends Ga{onStoreAdded(){super.onStoreAdded(),dt.instance.remove(this)}innerXml(){let n="",e=[];e=e.concat(dt.instance.getObjects(Vi)),e=e.concat(dt.instance.getObjects(Gt)),e=e.concat(dt.instance.getObjects(li)),e=e.concat(dt.instance.getObjects(Mr)),e=e.concat(dt.instance.getObjects(Kn)),e=e.concat(dt.instance.getObjects(zn).filter(i=>null===i.parent)),e=e.concat(dt.instance.getObjects(cr));for(let i of e)n+=i.toXml();return n}parseInnerXml(n){let e=[];e=e.concat(dt.instance.getObjects(Vi)),e=e.concat(dt.instance.getObjects(is)),e=e.concat(dt.instance.getObjects(ur)),e=e.concat(dt.instance.getObjects(Gt)),e=e.concat(dt.instance.getObjects(li)),e=e.concat(dt.instance.getObjects(Mr)),e=e.concat(dt.instance.getObjects(Kn)),e=e.concat(dt.instance.getObjects(zn)),e=e.concat(dt.instance.getObjects(cr));for(let i of e)i.destroy();for(let i=0;i<n.children.length;i++)ti.instance.parseXml(n.children[i])}};cv=$e([ni("room")],cv);var sH=me(1203);class Dr{constructor(n,e){this.ngZone=n,this.chatMessageService=e}saveRoomAsync(n="fly_\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",e){return this.chatMessageService.sendOperationLog(`\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf ${n}.zip \u3092\u4fdd\u5b58`),Dr.queue.add((i,r)=>i(this._saveRoomAsync(n,e)))}_saveRoomAsync(n="fly_\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",e){let i=[],r=this.convertToXml(new cv),s=this.convertToXml(mo.instance),o=this.convertToXml(go.instance),a=this.convertToXml(_o.instance),h=this.convertToXml(Zo.instance);i.push(new File([r],"fly_data.xml",{type:"text/plain"})),i.push(new File([s],"fly_chat.xml",{type:"text/plain"})),i.push(new File([o],"fly_rollTable.xml",{type:"text/plain"})),i.push(new File([a],"fly_cutIn.xml",{type:"text/plain"})),i.push(new File([h],"summary.xml",{type:"text/plain"}));let w=[];w=w.concat(this.searchImageFiles(r)),w=w.concat(this.searchImageFiles(s)),w=w.concat(this.searchImageFiles(a));for(const fe of w)fe.state===Ui.COMPLETE&&i.push(new File([fe.blob],fe.identifier+"."+Yl.extension(fe.blob.type),{type:fe.blob.type}));let X=this.convertToXml(Ir.create(w));return i.push(new File([X],"fly_imageTag.xml",{type:"text/plain"})),this.saveAsync(i,this.appendTimestamp(n),e)}saveGameObjectAsync(n,e="fly_xml_data",i){return this.chatMessageService.sendOperationLog(`${rt.aliasNameToClassName(n.aliasName)}\u306e\u30c7\u30fc\u30bf ${e}.zip \u3092\u4fdd\u5b58`),Dr.queue.add((r,s)=>r(this._saveGameObjectAsync(n,e,i)))}_saveGameObjectAsync(n,e="fly_xml_data",i){let r=[],s=this.convertToXml(n);r.push(new File([s],"fly_data.xml",{type:"text/plain"}));let o=[];o=o.concat(this.searchImageFiles(s));for(const h of o)h.state===Ui.COMPLETE&&r.push(new File([h.blob],h.identifier+"."+Yl.extension(h.blob.type),{type:h.blob.type}));let a=this.convertToXml(Ir.create(o));return r.push(new File([a],"fly_imageTag.xml",{type:"text/plain"})),this.saveAsync(r,this.appendTimestamp(e),i)}saveAsync(n,e,i){let r=-1;return Wo.instance.saveAsync(n,e,s=>{let o=0|s.percent;o<=r||(r=o,this.ngZone.run(()=>i(r)))})}convertToXml(n){return'<?xml version="1.0" encoding="UTF-8"?>\n'+sH.xml(n.toXml(),2)}searchImageFiles(n){let e=pa.xml2element(n),i=[];if(!e)return i;let r={},s=e.ownerDocument.querySelectorAll('*[type="image"]');for(let o=0;o<s.length;o++){let a=s[o].innerHTML;r[a]=Nt.instance.get(a);let h=s[o].getAttribute("currentValue");h&&(r[h]=Nt.instance.get(h))}s=e.ownerDocument.querySelectorAll("*[imageIdentifier], *[toImageIdentifier], *[backgroundImageIdentifier]");for(let o=0;o<s.length;o++){let a=s[o].getAttribute("imageIdentifier");a&&(r[a]=Nt.instance.get(a));let h=s[o].getAttribute("toImageIdentifier");h&&(r[a]=Nt.instance.get(h));let w=s[o].getAttribute("backgroundImageIdentifier");w&&(r[w]=Nt.instance.get(w))}for(let o in r){let a=r[o];a&&i.push(a)}return i}appendTimestamp(n){let e=new Date;return n+`_${e.getFullYear()}-${("00"+(e.getMonth()+1)).slice(-2)}-${("00"+e.getDate()).slice(-2)}_${("00"+e.getHours()).slice(-2)}${("00"+e.getMinutes()).slice(-2)}`}saveChatLog(n,e,i=null,r="HH:mm",s=!0){const o=0==n?"text/plain":"text/html",a=0==n?".txt":".html",h="fly_"+this.appendTimestamp(e)+a;this.chatMessageService.sendOperationLog(`\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0 ${h} \u3092\u4fdd\u5b58`),BT(new Blob([i?i.log(n,r,s):mo.instance.log(n,r,s)],{type:`${o};charset=utf-8`}),h)}}Dr.queue=new sT("SaveDataServiceQueue"),Dr.\u0275fac=function(n){return new(n||Dr)(an(Cn),an(kr))},Dr.\u0275prov=rn({token:Dr,factory:Dr.\u0275fac,providedIn:"root"});class qs{constructor(n,e){this.elementRef=n,this.chatMessageService=e,this.isDisable=!1,this.timeout=666,this.showValue=!0,this.type="\u30aa\u30d6\u30b8\u30a7\u30af\u30c8"}ngAfterViewInit(){let n=this.dataElement;for(;(n=n.parent)&&(n instanceof zn&&(this.type="\u30ab\u30fc\u30c9"),n instanceof Kn&&(this.type="\u5c71\u672d"),n instanceof cr&&(this.type=n.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9"),n instanceof Gt&&(this.type="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc"),n instanceof is&&(this.type="\u30de\u30c3\u30d7\u30de\u30b9\u30af"),n instanceof ur&&(this.type="\u5730\u5f62"),n instanceof Mr&&(this.type="\u5171\u6709\u30e1\u30e2"),n instanceof li&&(this.type="\u5c04\u7a0b\u30fb\u7bc4\u56f2"),n.parentIsAssigned&&!n.parentIsUnknown););const e=qs.LoggingValueMap,i=this.dataElement.identifier,r=this.elementRef.nativeElement;e.set(i,{oldValue:this.loggingValue}),r.addEventListener("input",()=>{e.get(i).timerId&&clearTimeout(e.get(i).timerId),e.get(i).timerId=setTimeout(()=>{this.doLogging()},this.timeout)})}ngOnDestroy(){const n=qs.LoggingValueMap,e=this.dataElement.identifier;n.get(e)&&n.get(e).timerId&&this.doLogging()}doLogging(){const n=qs.LoggingValueMap,e=this.dataElement.identifier;n.get(e).timerId&&(clearTimeout(n.get(e).timerId),n.get(e).timerId=null);const i=n.get(e).oldValue,r=this.loggingValue,s=this.dataElement;if(!this.isDisable&&r!=i){let o=`${""==this.name?`(\u7121\u540d\u306e${this.type})`:this.name} \u306e ${""==s.name?"(\u7121\u540d\u306e\u5909\u6570)":s.name} \u3092\u5909\u66f4`;this.showValue&&(s.isSimpleNumber||s.isNumberResource||s.isAbilityScore)?o+=` ${i} \u2192 ${r}`:s.isCheckProperty&&(o+=` ${r}`),this.chatMessageService.sendOperationLog(o)}n.get(e).oldValue=r}get loggingValue(){const n=this.dataElement;if(!n)return;let e;if(n.isSimpleNumber)e=`${n.value}`;else if(n.isNumberResource)e=`${n.currentValue}/${n.value&&0!=n.value?n.value:"???"}`;else if(n.isCheckProperty)e=n.value?" \u2192 \u2714ON":" \u2192 OFF";else if(n.isAbilityScore){const i=n.calcAbilityScore();e=`${n.value}`,n.currentValue&&(e+=`(${i>=0?"+":""}${i})`)}else e=n.value?n.value.toString():"";return e}}function oH(t,n){1&t&&_n(0)}function aH(t,n){if(1&t){const e=it();Q(0,"div",3),Te(1,oH,1,0,"ng-container",5),Q(2,"select",6),Ae("change",function(r){return Oe(e),_e(3).setElementType(r.target.value)}),Q(3,"option",7),ye(4,"\u901a\u5e38"),ie(),Q(5,"option",8),ye(6,"\u6570\u5024"),ie(),Q(7,"option",9),ye(8,"\u30ea\u30bd\u30fc\u30b9"),ie(),Q(9,"option",10),ye(10,"\u80fd\u529b\u5024"),ie(),Q(11,"option",11),ye(12,"\u30c1\u30a7\u30c3\u30af"),ie(),Q(13,"option",12),ye(14,"\u30ce\u30fc\u30c8"),ie(),Q(15,"option",13),ye(16,"\u53c2\u7167URL"),ie()()()}if(2&t){const e=_e(3),i=Kt(2);U(1),re("ngTemplateOutlet",i),U(1),re("ngModel",e.gameDataElement.type)}}function lH(t,n){1&t&&(Ke(0),ot(1,"br"),Q(2,"span",15),ye(3,"0=\u753b\u50cf\u4f9d\u5b58"),ie(),Ye())}function cH(t,n){if(1&t&&(Ke(0),Q(1,"span",14),ye(2),ie(),Te(3,lH,4,0,"ng-container",0),Ye()),2&t){const e=_e(3);U(2),Xe(e.name),U(1),re("ngIf","character"===e.descriptionType&&"height"===e.name)}}function uH(t,n){if(1&t){const e=it();Ke(0),Q(1,"div",16),ye(2),ie(),Q(3,"input",17),Ae("ngModelChange",function(r){return Oe(e),_e(3).name=r}),ie(),Ye()}if(2&t){const e=_e(3);U(2),Xe(e.name),U(1),re("ngModel",e.name)}}function dH(t,n){if(1&t){const e=it();Ke(0),Q(1,"input",21),Ae("ngModelChange",function(r){return Oe(e),_e(4).currentValue=r}),Et(2,"safe"),ie(),ot(3,"br"),Q(4,"input",22),Ae("ngModelChange",function(r){return Oe(e),_e(4).currentValue=r}),ie(),Q(5,"b",23),ye(6,"%"),ie(),Ye()}if(2&t){const e=_e(4);U(1),hr(Tt(2,5,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),Zi("title","",e.currentValue,"%"),re("ngModel",e.currentValue),U(3),re("ngModel",e.currentValue)}}function fH(t,n){if(1&t){const e=it();Ke(0),Q(1,"label",24)(2,"input",25),Ae("ngModelChange",function(r){return Oe(e),_e(5).value=r}),ie(),Q(3,"div",26),ye(4),ie()(),Q(5,"label",27)(6,"input",25),Ae("ngModelChange",function(r){return Oe(e),_e(5).currentValue=r}),ie(),Q(7,"div",26),ye(8),ie()(),Ye()}if(2&t){const e=_e(5);U(1),Qe("color",e.value)("background-color",e.currentValue)("text-shadow",e.colorSampleTextShadowCss),U(1),re("ngModel",e.value),U(2),Xe(e.value),U(1),Qe("color",e.value)("background-color",e.currentValue)("text-shadow",e.colorSampleTextShadowCss),U(1),re("ngModel",e.currentValue),U(2),Rn("(",e.currentValue,")")}}function hH(t,n){if(1&t){const e=it();Ke(0),Q(1,"label",24)(2,"input",25),Ae("ngModelChange",function(r){return Oe(e),_e(5).value=r}),ie(),ye(3),ie(),Ye()}if(2&t){const e=_e(5);U(1),Qe("color",e.value)("text-shadow",e.colorSampleTextShadowCss),U(1),re("ngModel",e.value),U(1),Rn(" ",e.value,"")}}function pH(t,n){if(1&t&&(Ke(0),Te(1,fH,9,16,"ng-container",0),Te(2,hH,4,6,"ng-container",0),Ye()),2&t){const e=_e(4);U(1),re("ngIf","colors"===e.gameDataElement.type),U(1),re("ngIf","color"===e.gameDataElement.type)}}function gH(t,n){if(1&t){const e=it();Q(0,"dev",31)(1,"label")(2,"input",32),Ae("ngModelChange",function(r){return Oe(e),_e(5).currentValue=r})("change",function(){Oe(e);const r=_e(5);return r.currentValue=r.currentValue?r.name:""}),ie(),ye(3,"\xd7 size"),ie()()}if(2&t){const e=_e(5);U(2),ht("checked",e.currentValue?"checked":""),re("ngModel",e.currentValue)}}function _H(t,n){if(1&t){const e=it();Ke(0),Q(1,"input",28),Ae("ngModelChange",function(r){return Oe(e),_e(4).value=r}),Et(2,"safe"),ie(),ot(3,"br"),Q(4,"input",29),Ae("ngModelChange",function(r){return Oe(e),_e(4).value=r}),ie(),Te(5,gH,4,2,"dev",30),Ye()}if(2&t){const e=_e(4);U(1),hr(Tt(2,11,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),ht("title",e.value),ht("min","altitude"===e.name?-12:"fontsize"===e.name||"length"===e.name?1:0),ht("max","fontsize"===e.name?128:12),ht("step","fontsize"===e.name?1:.5),re("ngModel",e.value),U(3),ht("min","altitude"===e.name?-24:"fontsize"===e.name||"length"===e.name?1:0),ht("step","fontsize"===e.name?1:.1),re("ngModel",e.value),U(1),re("ngIf","character"===e.descriptionType&&"height"===e.name)}}function mH(t,n){if(1&t&&(Ke(0)(1,18),Te(2,dH,7,8,"ng-container",19),Te(3,pH,3,2,"ng-container",19),Te(4,_H,6,14,"ng-container",20),Ye()()),2&t){const e=_e(3);U(1),re("ngSwitch",e.gameDataElement.name),U(1),re("ngSwitchCase","opacity"),U(1),re("ngSwitchCase","color")}}function $H(t,n){if(1&t){const e=it();Ke(0),Q(1,"div",33),ye(2),ie(),Q(3,"input",34),Ae("ngModelChange",function(r){return Oe(e),_e(4).value=r}),ie(),Ye()}if(2&t){const e=_e(4);U(2),Xe(e.value),U(1),ht("type",e.isNum(e.value)?"number":"text"),re("logging.name",e.tableTopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.value)}}function vH(t,n){if(1&t){const e=it();Ke(0),Q(1,"input",35),Ae("ngModelChange",function(r){return Oe(e),_e(4).currentValue=r}),Et(2,"safe"),ie(),ot(3,"br"),Q(4,"input",36),Ae("ngModelChange",function(r){return Oe(e),_e(4).currentValue=r}),ie(),ye(5," / "),Q(6,"input",37),Ae("ngModelChange",function(r){return Oe(e),_e(4).value=r}),ie(),Ye()}if(2&t){const e=_e(4);U(1),hr(Tt(2,16,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),ht("title",e.currentValue),ht("max",e.isNum(e.value)?e.value:1e3),re("logging.name",e.tableTopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.currentValue),U(3),re("logging.name",e.tableTopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.currentValue),U(2),re("logging.name",e.tableTopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.value)}}function bH(t,n){if(1&t){const e=it();Ke(0),Q(1,"select",39),Ae("ngModelChange",function(r){return Oe(e),_e(5).currentValue=r}),Q(2,"option",7),ye(3,"\u306a\u3057"),ie(),Q(4,"option",40),ye(5,"\xf72"),ie(),Q(6,"option",41),ye(7,"\xf73 SRS,LHZ"),ie(),Q(8,"option",42),ye(9,"\xf74"),ie(),Q(10,"option",43),ye(11,"\xf75"),ie(),Q(12,"option",44),ye(13,"\xf76 SW"),ie(),Q(14,"option",45),ye(15,"\xf710"),ie(),Q(16,"option",46),ye(17,"D&D 3e\uff5e"),ie()(),Ye()}if(2&t){const e=_e(5);U(1),re("ngModel",e.currentValue)}}function yH(t,n){if(1&t&&(Ke(0),Q(1,"span",47),ye(2),ie(),Ye()),2&t){const e=_e(5);U(2),Xe("("+(e.abilityScore>=0?"+":"")+e.abilityScore+")")}}function CH(t,n){if(1&t){const e=it();Ke(0),Q(1,"input",38),Ae("ngModelChange",function(r){return Oe(e),_e(4).value=r}),ie(),Te(2,bH,18,1,"ng-container",0),Te(3,yH,3,1,"ng-container",0),Ye()}if(2&t){const e=_e(4);U(1),ht("type",e.isNum(e.value)?"number":"text"),re("logging.name",e.tableTopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.value),U(1),re("ngIf",e.isEdit),U(1),re("ngIf",!e.isEdit&&e.currentValue)}}function xH(t,n){if(1&t){const e=it();Q(0,"input",51),Ae("ngModelChange",function(r){return Oe(e),_e(5).currentValue=r}),ie()}2&t&&re("ngModel",_e(5).currentValue)}function wH(t,n){if(1&t&&(Q(0,"span",52),ye(1),ie()),2&t){const e=_e(5);U(1),Xe(e.checkValue)}}function EH(t,n){if(1&t){const e=it();Ke(0),Q(1,"input",48),Ae("ngModelChange",function(r){return Oe(e),_e(4).value=r})("change",function(){Oe(e);const r=_e(4);return r.value=r.value?r.name:""}),ie(),Te(2,xH,1,1,"input",49),Te(3,wH,2,1,"span",50),Ye()}if(2&t){const e=_e(4);U(1),ht("checked",e.value?"checked":""),re("logging.name",e.tableTopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.value),U(1),re("ngIf",e.isEdit),U(1),re("ngIf",!e.isEdit)}}function TH(t,n){if(1&t){const e=it();Ke(0),Q(1,"textarea",53),Ae("ngModelChange",function(r){return Oe(e),_e(4).value=r}),ie(),Ye()}if(2&t){const e=_e(4);U(1),re("ngModel",e.value)}}function SH(t,n){if(1&t){const e=it();Ke(0),Q(1,"div",33),ye(2),ie(),Q(3,"span",54)(4,"input",55),Ae("ngModelChange",function(r){return Oe(e),_e(4).value=r}),ie(),Q(5,"button",56),Ae("click",function(){Oe(e);const r=_e(4);return!!r.stringUtil.validUrl(r.value)&&r.openUrl(r.value)}),Q(6,"i",57),ye(7),ie()()(),Ye()}if(2&t){const e=_e(4);U(2),Xe(e.value),U(2),re("ngModel",e.value),U(1),Bt("disabled",e.stringUtil.validUrl(e.value)?null:""),U(2),Xe(e.stringUtil.validUrl(e.value)?e.stringUtil.sameOrigin(e.value)?"link":"open_in_new":"link_off")}}function IH(t,n){if(1&t){const e=it();Q(0,"input",60),Ae("ngModelChange",function(r){return Oe(e),_e(5).value=r}),ie()}2&t&&re("ngModel",_e(5).value)}function kH(t,n){1&t&&(Q(0,"span",61),ye(1,"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09"),ie())}function MH(t,n){if(1&t&&(Ke(0),Q(1,"div",33),ye(2),ie(),Te(3,IH,1,1,"input",58),Te(4,kH,2,0,"span",59),Ye()),2&t){const e=_e(4);U(2),Xe(e.value),U(1),re("ngIf",!(e.isHideText&&e.isTableTopObjectName)),U(1),re("ngIf",e.isHideText&&e.isTableTopObjectName)}}function DH(t,n){if(1&t&&(Ke(0)(1,18),Te(2,$H,4,6,"ng-container",19),Te(3,vH,7,19,"ng-container",19),Te(4,CH,4,7,"ng-container",19),Te(5,EH,4,7,"ng-container",19),Te(6,TH,2,1,"ng-container",19),Te(7,SH,8,4,"ng-container",19),Te(8,MH,5,3,"ng-container",20),Ye()()),2&t){const e=_e(3);U(1),re("ngSwitch",e.gameDataElement.type),U(1),re("ngSwitchCase","simpleNumber"),U(1),re("ngSwitchCase","numberResource"),U(1),re("ngSwitchCase","abilityScore"),U(1),re("ngSwitchCase","checkProperty"),U(1),re("ngSwitchCase","note"),U(1),re("ngSwitchCase","url")}}function AH(t,n){if(1&t&&(Ke(0),Te(1,aH,17,2,"div",2),Q(2,"div",3),Te(3,cH,4,2,"ng-container",0),Te(4,uH,4,2,"ng-container",0),ie(),Q(5,"div",4),Te(6,mH,5,3,"ng-container",0),Te(7,DH,9,7,"ng-container",0),ie(),Ye()),2&t){const e=_e(2);U(1),re("ngIf",e.isEdit),U(2),re("ngIf",e.isTagLocked),U(1),re("ngIf",!e.isTagLocked),U(2),re("ngIf",e.isCommonValue),U(1),re("ngIf",!e.isCommonValue)}}function PH(t,n){1&t&&_n(0)}function NH(t,n){if(1&t&&(Q(0,"div",67),Te(1,PH,1,0,"ng-container",5),ie()),2&t){_e(3);const e=Kt(2);U(1),re("ngTemplateOutlet",e)}}function FH(t,n){if(1&t&&(Ke(0),Q(1,"div",68),ye(2),ie(),Ye()),2&t){const e=_e(3);U(2),Xe(e.name)}}function OH(t,n){if(1&t){const e=it();Ke(0),Q(1,"input",69),Ae("ngModelChange",function(r){return Oe(e),_e(3).name=r}),ie(),Ye()}if(2&t){const e=_e(3);U(1),re("ngModel",e.name)}}function RH(t,n){if(1&t&&ot(0,"div",72),2&t){const e=n.$implicit,i=_e(4);re("gameDataElement",e)("tableTopObjectName",i.tableTopObjectName)("isEdit",i.isEdit)("isTagLocked",i.isTagLocked)("isHideText",i.isHideText)("isNoLogging",i.isNoLogging)("descriptionType",i.descriptionType)}}function BH(t,n){if(1&t&&(Q(0,"div",70),Te(1,RH,1,7,"div",71),ie()),2&t){const e=_e(3);U(1),re("ngForOf",e.gameDataElement.children)}}function LH(t,n){if(1&t&&(Ke(0),Te(1,NH,2,1,"div",62),ot(2,"div",63),Q(3,"div",64)(4,"div",65),Te(5,FH,3,1,"ng-container",0),Te(6,OH,2,1,"ng-container",0),ie(),Te(7,BH,2,1,"div",66),ie(),Ye()),2&t){const e=_e(2);U(1),re("ngIf",e.isEdit),U(3),Qe("border-color",e.isTagLocked&&"common"===e.name?"transparent":""),U(1),re("ngIf",e.isTagLocked&&"common"!=e.name),U(1),re("ngIf",!e.isTagLocked),U(1),re("ngIf",0<e.gameDataElement.children.length)}}function zH(t,n){if(1&t&&(Ke(0),Te(1,AH,8,5,"ng-container",0),Te(2,LH,8,6,"ng-container",0),Ye()),2&t){const e=_e();U(1),re("ngIf",e.gameDataElement.children.length<1),U(1),re("ngIf",0<e.gameDataElement.children.length)}}function jH(t,n){if(1&t){const e=it();Q(0,"button",73),Ae("click",function(){return Oe(e),_e().addElement()}),Q(1,"i",74),ye(2,"add_circle"),ie()(),Q(3,"button",73),Ae("click",function(){return Oe(e),_e().upElement()}),Q(4,"i",74),ye(5,"arrow_upward"),ie()(),ot(6,"br"),Q(7,"button",73),Ae("click",function(){return Oe(e),_e().deleteElement()}),Q(8,"i",74),ye(9,"remove_circle_outline"),ie()(),Q(10,"button",73),Ae("click",function(){return Oe(e),_e().downElement()}),Q(11,"i",74),ye(12,"arrow_downward"),ie()()}}qs.LoggingValueMap=new Map,qs.\u0275fac=function(n){return new(n||qs)(He(yi),He(kr))},qs.\u0275dir=Qt({type:qs,selectors:[["","appLogging",""]],inputs:{isDisable:["logging.disable","isDisable"],timeout:["logging.timeout","timeout"],name:["logging.name","name"],dataElement:["logging.dataElement","dataElement"],showValue:["logging.loggingValue","showValue"]}});let HH=(()=>{class t{constructor(e,i){this.changeDetector=e,this.modalService=i,this.tableTopObjectName=null,this.gameDataElement=null,this.isEdit=!1,this.isTagLocked=!1,this.isValueLocked=!1,this.isHideText=!1,this.isNoLogging=!1,this.stringUtil=rt,this._name="",this._value=0,this._currentValue=0,this.updateTimer=null}get name(){return this._name}set name(e){this._name=e,this.setUpdateTimer()}get value(){return this._value}set value(e){this._value=e,this.setUpdateTimer()}get currentValue(){return this._currentValue}set currentValue(e){this._currentValue=e,this.setUpdateTimer()}get abilityScore(){return this.gameDataElement.calcAbilityScore()}get isTableTopObjectName(){return this.isTagLocked&&"name"===this.gameDataElement.name}get checkValue(){if(null==this.currentValue)return"";let e=this.currentValue.toString().split(/[|\uff5c]/,2);return e.length<=1?null==this.value||""==this.value?"":this.currentValue.toString():null==this.value||""==this.value?e[1]:e[0]}get isCommonValue(){return!!this.gameDataElement&&this.isTagLocked&&("size"===this.gameDataElement.name||"width"===this.gameDataElement.name||"height"===this.gameDataElement.name||"depth"===this.gameDataElement.name||"length"===this.gameDataElement.name||"fontsize"===this.gameDataElement.name||"opacity"===this.gameDataElement.name||"altitude"===this.gameDataElement.name||"color"===this.gameDataElement.name)}get isNotApplicable(){return this.isCommonValue&&"range-not-width"===this.descriptionType&&"width"===this.gameDataElement.name}get colorSampleTextShadowCss(){const e=rt.textShadowColor(this.value.toString());return`${e} -1px -1px 0px, \n      ${e} 0px -1px 0px, \n      ${e} 1px -1px 0px, \n      ${e} -1px 0px 0px, \n      ${e} 1px 0px 0px,\n      ${e} -1px 1px 0px,\n      ${e} 0px 1px 0px,\n      ${e} 1px 1px 0px`}get identifier(){return this.gameDataElement.identifier}ngOnInit(){this.gameDataElement&&this.setValues(this.gameDataElement),ze.register(this).on("UPDATE_GAME_OBJECT",e=>{this.gameDataElement&&e.data.identifier===this.gameDataElement.identifier&&(this.setValues(this.gameDataElement),this.changeDetector.markForCheck())}).on("DELETE_GAME_OBJECT",e=>{this.gameDataElement&&this.gameDataElement.identifier===e.data.identifier&&this.changeDetector.markForCheck()})}ngOnDestroy(){ze.unregister(this)}ngAfterViewInit(){}addElement(){this.gameDataElement.appendChild(_t.create("\u30bf\u30b0","",{}))}deleteElement(){this.gameDataElement.destroy()}upElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);0<i&&e.insertBefore(this.gameDataElement,e.children[i-1])}downElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.gameDataElement)}setElementType(e){this.gameDataElement.setAttribute("type",e)}isNum(e){return isFinite(e)}openUrl(e){rt.sameOrigin(e)?window.open(e.trim(),"_blank","noopener"):this.modalService.open(qr,{url:e,title:this.tableTopObjectName,subTitle:this.name})}setValues(e){this._name=e.name,this._currentValue=e.currentValue,this._value=e.value}setUpdateTimer(){clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>{this.gameDataElement.name!==this.name&&(this.gameDataElement.name=this.name),this.gameDataElement.currentValue!==this.currentValue&&(this.gameDataElement.currentValue=this.currentValue),this.gameDataElement.value!==this.value&&(this.gameDataElement.value=this.value),this.updateTimer=null},66)}}return t.\u0275fac=function(e){return new(e||t)(He(Oi),He(Fn))},t.\u0275cmp=Xt({type:t,selectors:[["game-data-element"],["","game-data-element",""]],inputs:{tableTopObjectName:"tableTopObjectName",gameDataElement:"gameDataElement",isEdit:"isEdit",isTagLocked:"isTagLocked",isValueLocked:"isValueLocked",isHideText:"isHideText",isNoLogging:"isNoLogging",descriptionType:"descriptionType"},decls:3,vars:1,consts:[[4,"ngIf"],["editButtons",""],["class","table-cell table-cell_solid",4,"ngIf"],[1,"table-cell","table-cell_solid"],[1,"table-cell"],[4,"ngTemplateOutlet"],[3,"ngModel","change"],["value",""],["value","simpleNumber"],["value","numberResource"],["value","abilityScore"],["value","checkProperty"],["value","note"],["value","url"],[2,"font-family","Cambria, Georgia","font-size","0.9rem"],[2,"font-size","0.4rem"],[1,"hidden-spacer",2,"font-family","Cambria, Georgia","font-size","0.9rem"],["size","1","placeholder","Value",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","0.9rem",3,"ngModel","ngModelChange"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["type","range","min","0","max","100","step","1",2,"width","90%",3,"ngModel","title","ngModelChange"],["type","number","min","0","max","100","step","1","size","1","placeholder","Opacity",2,"margin-left","3.5em","width","4em","text-align","right",3,"ngModel","ngModelChange"],[1,"move",2,"font-size","small"],[1,"color-sample",2,"padding","0px 2px 0px 0xp","width","6.5em"],["type","color",2,"width","1em",3,"ngModel","ngModelChange"],[2,"display","inline-block","box-sizing","border-box","width","calc(100% - 1em)","text-align","center"],[1,"color-sample",2,"padding","0px 2px 0px 0xp","width","7.5em"],["type","range",2,"width","90%",3,"ngModel","title","min","max","step","ngModelChange"],["type","number","size","1","placeholder","Value",2,"width","35%","max-width","4em","text-align","right",3,"min","step","ngModel","ngModelChange"],["style","color: #444; font-family: Cambria, Georgia; font-size: 0.9rem; display: inline-block; margin-left: 3px",4,"ngIf"],[2,"color","#444","font-family","Cambria, Georgia","font-size","0.9rem","display","inline-block","margin-left","3px"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[1,"hidden-spacer",2,"font-size","1.0em","font-family","Cambria, Georgia"],["appLogging","","size","1","placeholder","Number",2,"width","40%","min-width","3em","max-width","8em","text-align","right",3,"logging.name","logging.dataElement","logging.disable","type","ngModel","ngModelChange"],["appLogging","","type","range","min","0",3,"logging.name","logging.dataElement","logging.disable","ngModel","title","max","ngModelChange"],["appLogging","","size","1","type","number","placeholder","Value",2,"width","5em","text-align","right",3,"logging.name","logging.dataElement","logging.disable","ngModel","ngModelChange"],["appLogging","","size","1","type","number","placeholder","Value",2,"width","5em",3,"logging.name","logging.dataElement","logging.disable","ngModel","ngModelChange"],["appLogging","","size","1","placeholder","Value",2,"width","40%","max-width","5em","text-align","right",3,"logging.name","logging.dataElement","logging.disable","type","ngModel","ngModelChange"],[1,"modeifire-type",2,"width","40%","max-width","5em",3,"ngModel","ngModelChange"],["value","div2"],["value","div3"],["value","div4"],["value","div5"],["value","div6"],["value","div10"],["value","DnD3"],[2,"font-size","smaller"],["appLogging","","type","checkbox",2,"width","30%","max-width","4em",3,"logging.name","logging.dataElement","logging.disable","ngModel","checked","ngModelChange","change"],["style","width:50%; max-width:4em","type","text","size","1","placeholder","Option",3,"ngModel","ngModelChange",4,"ngIf"],["style","font-size: 1.0em; font-family: Cambria, Georgia; color: #555",4,"ngIf"],["type","text","size","1","placeholder","Option",2,"width","50%","max-width","4em",3,"ngModel","ngModelChange"],[2,"font-size","1.0em","font-family","Cambria, Georgia","color","#555"],["placeholder","Note",2,"width","100%","height","5em","min-width","50px","resize","bose","font-size","0.8em",3,"ngModel","ngModelChange"],[2,"white-space","nowrap"],["type","url","size","1","placeholder","https://www.example.com",2,"width","calc(100% - 1.6rem)","min-width","10px",3,"ngModel","ngModelChange"],[2,"width","1.6rem",3,"click"],[1,"material-icons",2,"font-size","1.0rem"],["style","width:100%; min-width:10px;","size","1","placeholder","",3,"ngModel","ngModelChange",4,"ngIf"],["style","color: gray; font-size: 1.0em; font-family: Cambria, Georgia;",4,"ngIf"],["size","1","placeholder","",2,"width","100%","min-width","10px",3,"ngModel","ngModelChange"],[2,"color","gray","font-size","1.0em","font-family","Cambria, Georgia"],["class","table-cell table-cell_solid","style","vertical-align: top;",4,"ngIf"],[1,"table-cell","table-cell_inner-table",2,"padding","0","width","0"],[1,"table-cell_inner-table"],[1,"table-cell_inner-table-title"],["class","table",4,"ngIf"],[1,"table-cell","table-cell_solid",2,"vertical-align","top"],[2,"padding","2px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold"],["size","1","placeholder","Value",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold",3,"ngModel","ngModelChange"],[1,"table"],["game-data-element","","class","table-row",3,"gameDataElement","tableTopObjectName","isEdit","isTagLocked","isHideText","isNoLogging","descriptionType",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","tableTopObjectName","isEdit","isTagLocked","isHideText","isNoLogging","descriptionType"],[3,"click"],[1,"material-icons"]],template:function(e,i){1&e&&(Te(0,zH,3,2,"ng-container",0),Te(1,jH,13,0,"ng-template",null,1,Un)),2&e&&re("ngIf",i.gameDataElement&&!i.isNotApplicable&&!(i.isHideText&&("text"==i.name||"fontsize"==i.name||"color"==i.name)))},directives:[bn,Sl,es,$i,di,Ur,Vr,mi,Tl,Sd,gs,Oo,Fo,ps,Id,Jr,qs,oi,t],pipes:[ai],styles:[".game-data-element[_ngcontent-%COMP%]{margin-left:10px}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{padding-top:10px;display:table-row;box-sizing:border-box}.table-cell[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.5em 0 .1em .5em;border-bottom:1px dotted #888;box-sizing:border-box}.table-cell_solid[_ngcontent-%COMP%]{width:10px;white-space:nowrap}.table-cell_inner-table[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.2em 0 .1em .5em;border:none;box-sizing:border-box}.table-cell_inner-table-title[_ngcontent-%COMP%]{border-bottom:1px solid #444;border-left:8px solid #444;padding-left:8px}.box[_ngcontent-%COMP%]{display:inline-block;margin:10px}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;max-width:20em;overflow:hidden;padding:0 3px;box-sizing:border-box}input[_ngcontent-%COMP%], button[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}input[_ngcontent-%COMP%]:hover, textarea[_ngcontent-%COMP%]:hover, select[_ngcontent-%COMP%]:hover{background:#EEE}input[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{background:#FFF}button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}.table-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.5rem}button[_ngcontent-%COMP%]:disabled{color:gray}button[_ngcontent-%COMP%]:disabled:hover{background-color:transparent}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.modeifire-type[_ngcontent-%COMP%]{font-size:smaller}input[type=color][_ngcontent-%COMP%]:hover, input[type=color][_ngcontent-%COMP%]:not(:hover){-webkit-appearance:auto;-moz-appearance:auto;appearance:auto;width:44px;height:22px;background-color:#efefef;cursor:default;color:#000;border-width:1px;border-style:solid;border-color:#767676;-o-border-image:none;border-image:none;-o-border-image:initial;border-image:initial;padding:1px 2px}@media (prefers-color-scheme: dark){input[type=color][_ngcontent-%COMP%]:hover, input[type=color][_ngcontent-%COMP%]:not(:hover){background-color:#3b3b3b;color:#fff;border-color:#858585}}.color-sample[_ngcontent-%COMP%]{display:inline-block;font-weight:bolder;width:6em;text-shadow:#eee -1px -1px 0px,#eee 0px -1px 0px,#eee 1px -1px 0px,#eee -1px 0px 0px,#eee 1px 0px 0px,#eee -1px 1px 0px,#eee 0px 1px 0px,#eee 1px 1px 0px}input[_ngcontent-%COMP%] + .move[_ngcontent-%COMP%]{display:inline-block;transform:translate(-1em);transition:transform 18ms}input[_ngcontent-%COMP%]:hover + .move[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:active + .move[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:focus + .move[_ngcontent-%COMP%]{display:inline-block;transform:translate(0);transition:transform 18ms}@supports (-moz-user-select: -moz-none){input[_ngcontent-%COMP%] + .move[_ngcontent-%COMP%]{transform:translate(0)}}"],changeDetection:0}),t})();const UH=["mainImage"];function VH(t,n){1&t&&_n(0)}function GH(t,n){if(1&t){const e=it();Ke(0),Q(1,"button",4),Ae("click",function(){return Oe(e),_e().openModal("front")}),ye(2,"\u8868\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),ie(),Q(3,"button",0),Ae("click",function(){return Oe(e),_e().openModal("back")}),ye(4,"\u88cf\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),ie(),Ye()}if(2&t){const e=_e();U(1),re("disabled",!e.isVisible)}}function qH(t,n){if(1&t){const e=it();Ke(0),Q(1,"button",0),Ae("click",function(){return Oe(e),_e().openModalChangeAllCardImages()}),ye(2,"\u5168\u30ab\u30fc\u30c9\u306e\u88cf\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),ie(),Ye()}}function WH(t,n){if(1&t){const e=it();Ke(0),Q(1,"button",0),Ae("click",function(){return Oe(e),_e().openModal("floor")}),ye(2,"\u5e8a\u306e\u753b\u50cf\u3092\u5909\u66f4"),ie(),Q(3,"button",0),Ae("click",function(){return Oe(e),_e().openModal("wall")}),ye(4,"\u58c1\u306e\u753b\u50cf\u3092\u5909\u66f4"),ie(),Ye()}}function KH(t,n){if(1&t){const e=it();Ke(0),Q(1,"button",4),Ae("click",function(){Oe(e);const r=_e();return r.openModal(r.tabletopObject.face)}),ye(2,"\u30c0\u30a4\u30b9\u76ee\u306e\u753b\u50cf\u3092\u5909\u66f4"),ie(),Ye()}if(2&t){const e=_e();U(1),re("disabled",!e.isVisible)}}function YH(t,n){if(1&t){const e=it();Ke(0),Q(1,"button",0),Ae("click",function(){Oe(e);const r=_e();return r.openModalReplaceImage(r.tabletopObject.imageFiles.length>1||0<(null==r.tabletopObject.imageFile?null:r.tabletopObject.imageFile.url.length))}),ye(2),ie(),Q(3,"button",4),Ae("click",function(){return Oe(e),_e().openModal("faceIcon")}),ye(4),ie(),Ye()}if(2&t){const e=_e();U(2),Rn("\u753b\u50cf",(null==e.tabletopObject.imageFiles?null:e.tabletopObject.imageFiles.length)>1?"\u7f6e\u63db/\u524a\u9664":"\u8a2d\u5b9a",""),U(1),re("disabled",(null==e.tabletopObject.faceIcons?null:e.tabletopObject.faceIcons.length)>=e.MAX_IMAGE_ICON_COUNT),U(1),Rn("\u9854IC",(null==e.tabletopObject.faceIcons?null:e.tabletopObject.faceIcons.length)>0?"\u8ffd\u52a0":"\u8a2d\u5b9a","")}}function ZH(t,n){if(1&t){const e=it();Ke(0),Q(1,"button",0),Ae("click",function(){Oe(e);const r=_e(2);return r.openModal("imageIdentifier",r.tabletopObject.imageFile&&r.tabletopObject.imageFile.url.length>0)}),ye(2,"\u753b\u50cf\u5909\u66f4"),ie(),Ye()}}function XH(t,n){if(1&t&&(Ke(0),Te(1,ZH,3,0,"ng-container",8),Ye()),2&t){const e=_e();U(1),re("ngIf","range"!==e.tabletopObject.aliasName)}}function QH(t,n){if(1&t&&(Q(0,"div",10),ye(1),ie()),2&t){const e=_e();U(1),Rn("",e.progresPercent,"%")}}function JH(t,n){if(1&t){const e=it();Q(0,"select",12),Ae("change",function(r){return Oe(e),_e(2).setLocation(r.target.value)}),Q(1,"option",13),ye(2,"\u30c6\u30fc\u30d6\u30eb"),ie(),Q(3,"option",14),ye(4,"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),ie(),Q(5,"option",15),ye(6,"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),ie(),Q(7,"option",16),ye(8,"\u5893\u5730"),ie()()}if(2&t){const e=_e(2);re("ngModel",e.tabletopObject.location.name),U(5),ht("value",e.networkService.peerId)}}function eU(t,n){if(1&t){const e=it();Ke(0),Te(1,JH,9,2,"select",11),Q(2,"button",4),Ae("click",function(){Oe(e);const r=_e();return r.openModal("shadowImageIdentifier",r.tabletopObject.shadowImageFile.url.length>0)}),ye(3,"\u753b\u50cf\u306e\u5f71\u306e\u5909\u66f4"),ie(),Ye()}if(2&t){const e=_e();U(1),re("ngIf",e.tabletopObject),U(1),re("disabled",!e.tabletopObject.imageElement||"null"==e.tabletopObject.imageElement.value)}}function tU(t,n){if(1&t){const e=it();Q(0,"button",35),Ae("click",function(){Oe(e);const r=_e(2),s=r.index,o=r.$implicit;return _e(3).deleteIcon(s,o.identifier)}),Q(1,"b",36),ye(2,"close"),ie()()}}const nU=function(t){return{"current-icon":t}};function iU(t,n){if(1&t){const e=it();Q(0,"div",32)(1,"img",33),Ae("click",function(){Oe(e);const r=_e().index;return _e(3).selectIcon(r)}),Et(2,"safe"),ie(),Te(3,tU,3,0,"button",34),ie()}if(2&t){const e=_e(),i=e.index,r=e.$implicit,s=_e(3);re("@bounceInOut",void 0)("ngClass",ft(8,nU,s.tabletopObject.currntIconIndex==i)),U(1),re("src",Tt(2,5,r.url,"resourceUrl"),en)("alt",r.name),U(2),re("ngIf",s.tabletopObject.currntIconIndex==i)}}function rU(t,n){if(1&t&&(Q(0,"div",5),Te(1,iU,4,10,"div",31),ie()),2&t){const e=n.$implicit,i=n.index;Qe("top",-_e(3).showIconOffset(i),"px"),U(1),re("ngIf",0<e.url.length)}}const sU=function(t){return{hide:t}};function oU(t,n){if(1&t){const e=it();Q(0,"span",37)(1,"img",33),Ae("click",function(){const s=Oe(e).index;return _e(3).selectImage(s)}),Et(2,"safe"),ie()()}if(2&t){const e=n.$implicit,i=n.index,r=_e(3);Qe("left",50*(r.tabletopObject.currntImageIndex<=i?i-1:i)-r.showCaseOffset(i),"px"),re("ngClass",ft(9,sU,r.tabletopObject.currntImageIndex==i)),U(1),re("@bounceInOut",void 0)("src",Tt(2,6,e.url,"resourceUrl"),en)("alt",e.name)}}function aU(t,n){if(1&t){const e=it();Q(0,"button",38),Ae("click",function(){return Oe(e),_e(3).openModalAddImage()}),ye(1),ie()}if(2&t){const e=_e(3);Qe("left",e.tabletopObject.imageFiles.length<0?-5:45*(e.tabletopObject.imageFiles.length-1)-5-e.showCaseOffset(e.tabletopObject.imageFiles.length-2),"px"),U(1),Xe(e.tabletopObject.imageFiles.length<2?"\u5207\u308a\u66ff\u3048\u753b\u50cf\u8a2d\u5b9a":"\uff0b")}}const lU=function(t){return{transform:t}};function cU(t,n){if(1&t&&(Q(0,"div",39),ot(1,"div",40),Et(2,"safe"),ie()),2&t){const e=_e(3);Qe("width",e.imageAreaRreact.width,"px")("height",e.imageAreaRreact.height,"px"),re("ngStyle",ft(15,lU,"scale("+e.imageAreaRreact.scale+")")),U(1),Qe("font-size",e.cardFontSize,"px")("color",e.cardColor)("text-shadow",e.cardTextShadowCss),re("innerHTML",Tt(2,12,e.cardText,"html"),Yi)}}const uU=function(t){return{inverse:t}},dU=function(t,n,e,i,r,s,o,a){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:s,yellow:o,white:a}},fU=function(t,n,e){return{"black-paint":t,hollow:n,small:e}};function hU(t,n){if(1&t){const e=it();Q(0,"div",20)(1,"div",21),Te(2,rU,2,3,"div",22),ie(),Q(3,"div",23),Te(4,oU,3,11,"span",24),Te(5,aU,2,3,"button",25),ie(),Te(6,cU,3,17,"div",26),Q(7,"span",27)(8,"span",28)(9,"img",29,30),Ae("dblclick",function(){return Oe(e),_e(2).openMainImageModal()})("load",function(){return Oe(e),_e(2).onMainImageLoad()}),Et(11,"safe"),ie()()()()}if(2&t){const e=_e(2);U(2),re("ngForOf",e.tabletopObject.faceIcons)("ngForTrackBy",e.identify),U(2),re("ngForOf",e.tabletopObject.imageFiles),U(1),re("ngIf","character"==e.tabletopObject.aliasName&&e.tabletopObject.imageFiles.length<e.MAX_IMAGE_ICON_COUNT&&(e.tabletopObject.imageFiles.length>1||0<(null==e.tabletopObject.imageFile?null:e.tabletopObject.imageFile.url.length))),U(1),re("ngIf","card"==e.tabletopObject.aliasName&&(e.tabletopObject.isFront||e.tabletopObject.isHand||e.isVisible)||"card-stack"==e.tabletopObject.aliasName&&e.tabletopObject.topCard.isFront),U(1),re("ngClass",ft(14,uU,e.tabletopObject.isInverse)),U(1),re("ngClass",uo(16,dU,0==e.tabletopObject.aura,1==e.tabletopObject.aura,2==e.tabletopObject.aura,3==e.tabletopObject.aura,4==e.tabletopObject.aura,5==e.tabletopObject.aura,6==e.tabletopObject.aura,7==e.tabletopObject.aura)),U(1),re("src",Tt(11,11,e.imageFile.url,"resourceUrl"),en)("alt",e.imageFile.name)("ngClass",Zr(25,fU,e.isBlackPaint,e.tabletopObject.isHollow,""==e.tabletopObject.aliasName))("@switchImage",e.tabletopObject.currntImageIndex)}}function pU(t,n){if(1&t){const e=it();Q(0,"div",45)(1,"button",46),Ae("click",function(){return Oe(e),_e(3).showChatPalette()}),ye(2,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a"),ie(),Q(3,"button",46),Ae("click",function(){return Oe(e),_e(3).showStandSetting()}),ye(4,"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a"),ie()()}}function gU(t,n){if(1&t&&(Ke(0),Q(1,"div",41)(2,"div",42),ot(3,"div",43),ie(),Te(4,pU,5,0,"div",44),ie(),Ye()),2&t){const e=_e(2);U(3),re("gameDataElement",e.tabletopObject.commonDataElement)("tableTopObjectName",e.tableTopObjectName)("isTagLocked",!0)("isHideText","card"===e.tabletopObject.aliasName&&!e.tabletopObject.isFront&&!e.tabletopObject.isHand&&!e.tabletopObject.isGMMode)("isNoLogging",e.isNoLogging)("descriptionType",e.descriptionType),U(1),re("ngIf","character"===e.tabletopObject.aliasName)}}function _U(t,n){if(1&t&&(Q(0,"div",41)(1,"div",42),ot(2,"div",48),ie()()),2&t){const e=n.$implicit,i=_e(3);U(2),re("gameDataElement",e)("tableTopObjectName",i.tableTopObjectName)("isEdit",i.isEdit)("isNoLogging",i.isNoLogging)}}function mU(t,n){if(1&t&&(Ke(0),Te(1,_U,3,4,"div",47),Ye()),2&t){const e=_e(2);U(1),re("ngForOf",e.tabletopObject.detailDataElement.children)}}function $U(t,n){if(1&t){const e=it();Ke(0),Q(1,"div",41)(2,"button",49),Ae("click",function(){return Oe(e),_e(2).addDataElement()}),ye(3,"\u65b0\u3057\u3044\u9805\u76ee\u3092\u8ffd\u52a0"),ie()(),Ye()}}function vU(t,n){if(1&t){const e=it();Q(0,"div",17)(1,"img",18),Ae("click",function(){return Oe(e),_e().openModal("shadowImageIdentifier",!0)}),Et(2,"safe"),ie(),Te(3,hU,12,29,"div",19),Te(4,gU,5,7,"ng-container",8),Te(5,mU,2,1,"ng-container",8),Te(6,$U,4,0,"ng-container",8),ie()}if(2&t){const e=_e();U(1),re("src",Tt(2,6,e.tabletopObject.shadowImageFile.url,"resourceUrl"),en)("alt",e.tabletopObject.shadowImageFile.name),U(2),re("ngIf",(0<(null==e.tabletopObject.imageFile?null:e.tabletopObject.imageFile.url.length)||0<(null==e.tabletopObject.faceIcons?null:e.tabletopObject.faceIcons.length))&&"table-mask"!=e.tabletopObject.aliasName),U(1),re("ngIf",e.tabletopObject.commonDataElement),U(1),re("ngIf",e.tabletopObject.detailDataElement),U(1),re("ngIf",e.isEdit)}}const bU=function(t){return{"is-hidden":t}};let Ws=(()=>{class t{constructor(e,i,r,s){this.saveDataService=e,this.panelService=i,this.modalService=r,this.pointerDeviceService=s,this.tabletopObject=null,this.isEdit=!1,this.networkService=xt,this.MAX_IMAGE_ICON_COUNT=8,this.isSaveing=!1,this.progresPercent=0,this.gridSize=50,this.naturalWidth=0,this.naturalHeight=0,this.mainImageWidth=0,this.mainImageHeight=0}ngOnInit(){ze.register(this).on("DELETE_GAME_OBJECT",e=>{this.tabletopObject&&this.tabletopObject.identifier===e.data.identifier&&this.panelService.close()}).on("UPDATE_GAME_OBJECT",-1e3,e=>{if(this.tabletopObject&&this.tabletopObject.identifier===e.data.identifier)switch(this.tabletopObject.aliasName){case"terrain":this.panelService.title=`\u5730\u5f62\u8a2d\u5b9a - ${this.tableTopObjectName}`;break;case"card":const i=this.tabletopObject;i instanceof zn&&(this.panelService.title=`\u30ab\u30fc\u30c9\u8a2d\u5b9a - ${i.isFront?this.tableTopObjectName:"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09"}`);break;case"card-stack":this.panelService.title=`\u5c71\u672d\u8a2d\u5b9a - ${this.tableTopObjectName}`;break;case"table-mask":this.panelService.title=`\u30de\u30c3\u30d7\u30de\u30b9\u30af\u8a2d\u5b9a - ${this.tableTopObjectName}`;break;case"text-note":this.panelService.title=`\u5171\u6709\u30e1\u30e2\u8a2d\u5b9a - ${this.tableTopObjectName}`;break;case"dice-symbol":this.panelService.title=`\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u8a2d\u5b9a - ${this.tableTopObjectName}`;break;case"character":this.panelService.title=`\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8 - ${this.tableTopObjectName}`;break;case"range":this.panelService.title=`\u5c04\u7a0b\u30fb\u7bc4\u56f2\u8a2d\u5b9a - ${this.tableTopObjectName}`}})}ngAfterViewInit(){}ngOnDestroy(){ze.unregister(this)}toggleEditMode(){this.isEdit=!this.isEdit}addDataElement(){if(this.tabletopObject.detailDataElement){let e=_t.create("\u898b\u51fa\u3057","",{}),i=_t.create("\u30bf\u30b0","",{});e.appendChild(i),this.tabletopObject.detailDataElement.appendChild(e)}}clone(){let e=this.tabletopObject.clone();switch(e.location.x+=50,e.location.y+=50,this.tabletopObject.parent&&this.tabletopObject.parent.appendChild(e),e.update(),this.tabletopObject.aliasName){case"terrain":pt.play(tt.blockPut),e.isLocked=!1;break;case"card":case"card-stack":e.owner="",e.toTopmost();case"table-mask":e.isLock=!1,pt.play(tt.cardPut);break;case"text-note":e.toTopmost(),pt.play(tt.cardPut);break;case"dice-symbol":pt.play(tt.dicePut);default:pt.play(tt.piecePut)}}get tableTopObjectName(){let e=this.tabletopObject.commonDataElement.getFirstElementByName("name")||this.tabletopObject.commonDataElement.getFirstElementByName("title");return e?e.value:""}get imageFile(){const e=this.tabletopObject;return e?e instanceof zn&&this.isVisible?e.frontImage:e.imageFile:Ut.Empty}get descriptionType(){return this.tabletopObject instanceof li&&!this.tabletopObject.isApplyWidth?"range-not-width":this.tabletopObject.aliasName}saveToXML(){var e=this;return(0,tn.Z)(function*(){if(!e.tabletopObject||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i=e.tableTopObjectName;yield e.saveDataService.saveGameObjectAsync(e.tabletopObject,"fly_xml_"+i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}setLocation(e){ze.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.tabletopObject.identifier}),pt.play("graveyard"==e?tt.sweep:tt.piecePut),this.tabletopObject.setLocation(e)}openModal(e="",i=!1){let r=[];if("shadowImageIdentifier"==e){const s=this.tabletopObject.imageElement;s&&"null"!=s.value&&s.currentValue&&(r=[s.currentValue+""])}else{const s=this.tabletopObject.imageDataElement.getElementsByName(e);s&&s.length>0&&(r=s.map(o=>o.value+""))}this.modalService.open(Ko,{isAllowedEmpty:i,currentImageIdentifires:r}).then(s=>{if(this.tabletopObject&&this.tabletopObject.imageDataElement&&s)if("shadowImageIdentifier"==e){const o=this.tabletopObject.imageElement;if(o){"null"!=o.value&&(o.currentValue=s);const a=this.tabletopObject.imageDataElement.getElementsByName("shadowImageIdentifier");for(const h of a)this.tabletopObject.imageDataElement.removeChild(h)}}else if("faceIcon"===e){let o=this.tabletopObject.imageDataElement.getElementsByName(e);if(o.length>=this.MAX_IMAGE_ICON_COUNT){for(let a=this.MAX_IMAGE_ICON_COUNT;a<o.length;a++)this.deleteIcon(a);o[this.MAX_IMAGE_ICON_COUNT-1].value=s}else this.tabletopObject.imageDataElement.appendChild(_t.create(e,s,{type:"image"},e+ns.generateUuid()));this.tabletopObject.currntIconIndex<0&&(this.tabletopObject.currntIconIndex=0)}else{let o=this.tabletopObject.imageDataElement.getFirstElementByName(e);if(!o)return;o.value=s}})}openModalAddImage(){let e=[];const i=this.tabletopObject.imageDataElement.getElementsByName("imageIdentifier");i.length>0&&(e=i.map(r=>r.value+"")),this.modalService.open(Ko,{currentImageIdentifires:e}).then(r=>{if(!this.tabletopObject||!this.tabletopObject.imageDataElement||!r)return;let s=this.tabletopObject.imageDataElement.getElementsByName("imageIdentifier");if(s.length>=this.MAX_IMAGE_ICON_COUNT){for(let o=this.MAX_IMAGE_ICON_COUNT;o<s.length;o++)this.deleteImage(o);s[this.MAX_IMAGE_ICON_COUNT-1].value=r}else this.tabletopObject.imageDataElement.appendChild(_t.create("imageIdentifier",r,{type:"image"},name+ns.generateUuid()));this.tabletopObject.currntImageIndex<0&&(this.tabletopObject.currntImageIndex=0)})}openModalReplaceImage(e=!1){let i=[];const r=this.tabletopObject.imageDataElement.getElementsByName("imageIdentifier");r.length>0&&(i=r.map(s=>s.value+"")),this.modalService.open(Ko,{isAllowedEmpty:e,currentImageIdentifires:i}).then(s=>{!this.tabletopObject||!this.tabletopObject.imageDataElement||!s||("null"==s?this.tabletopObject.imageElement&&1==this.tabletopObject.imageFiles.length?(this.tabletopObject.imageElement.value=s,this.tabletopObject.imageElement.currentValue=s):this.deleteImage(this.tabletopObject.currntImageIndex):this.tabletopObject.imageElement&&(this.tabletopObject.imageElement.value=s))})}openModalChangeAllCardImages(){this.modalService.open(Ko,{isAllowedEmpty:!1}).then(e=>{!this.tabletopObject||!this.tabletopObject||!(this.tabletopObject instanceof Kn)||!e||this.tabletopObject.cards.forEach(i=>{let r=i.imageDataElement.getFirstElementByName("back");r&&(r.value=e)})})}selectImage(e,i="imageIdentifier"){this.tabletopObject.currntImageIndex!=e&&(this.tabletopObject.currntImageIndex=e,pt.play(tt.surprise),ze.trigger("UPDATE_INVENTORY",null))}selectIcon(e){this.tabletopObject.currntIconIndex!=e&&(this.tabletopObject.currntIconIndex=e)}deleteImage(e=0,i="imageIdentifier"){if(!this.tabletopObject||!this.tabletopObject.imageDataElement)return;let r=this.tabletopObject.imageDataElement.getElementsByName(i);r&&0<r.length&&e<r.length&&(this.tabletopObject.currntImageIndex>e&&(this.tabletopObject.currntImageIndex-=1),this.tabletopObject.imageDataElement.removeChild(r[e]),this.tabletopObject.currntImageIndex>=r.length-1&&(this.tabletopObject.currntImageIndex=r.length-2),this.tabletopObject.currntImageIndex<0&&(this.tabletopObject.currntImageIndex=0))}deleteIcon(e=0,i=""){if(!this.tabletopObject||!this.tabletopObject.imageDataElement)return;let r=this.tabletopObject.imageDataElement.getElementsByName("faceIcon");r&&0<r.length&&e<r.length&&(!i||r[e].value===i)&&(this.tabletopObject.currntIconIndex>e&&(this.tabletopObject.currntIconIndex-=1),this.tabletopObject.imageDataElement.removeChild(r[e]),this.tabletopObject.currntIconIndex>=r.length-1&&(this.tabletopObject.currntIconIndex=r.length-2),this.tabletopObject.currntIconIndex<0&&(this.tabletopObject.currntIconIndex=0))}openMainImageModal(){var e;this.tabletopObject instanceof Kn||(this.tabletopObject instanceof zn?this.openModal(this.tabletopObject.isVisible?"front":"back"):this.tabletopObject instanceof cr?this.openModal(this.tabletopObject.face):this.tabletopObject instanceof Gt?this.openModalReplaceImage(this.tabletopObject.imageFiles.length>1||0<(null===(e=this.tabletopObject.imageFile)||void 0===e?void 0:e.url.length)):this.openModal("imageIdentifier",this.tabletopObject.imageFile&&this.tabletopObject.imageFile.url.length>0))}showChatPalette(){if(!(this.tabletopObject instanceof Gt))return;let e=this.pointerDeviceService.pointers[0];this.panelService.open(hu,{left:e.x-250,top:e.y-175,width:620,height:350}).character=this.tabletopObject}showStandSetting(){if(!(this.tabletopObject instanceof Gt))return;let e=this.pointerDeviceService.pointers[0];this.panelService.open(Jp,{left:e.x-400,top:e.y-175,width:720,height:572}).character=this.tabletopObject}onMainImageLoad(){!this.mainImageElement||(this.mainImageWidth=this.mainImageElement.nativeElement.clientWidth,this.mainImageHeight=this.mainImageElement.nativeElement.clientHeight,this.naturalWidth=this.mainImageElement.nativeElement.naturalWidth,this.naturalHeight=this.mainImageElement.nativeElement.naturalHeight)}identify(e,i){return i.identifier}get imageAreaRreact(){return this.calcImageAreaRect(this.mainImageWidth,this.mainImageHeight,0)}calcImageAreaRect(e,i,r){const s={width:0,height:0,top:r,left:r,scale:1};if(0==this.naturalWidth||0==this.naturalHeight)return s;const o=e-2*r,a=i-2*r;this.naturalHeight*o/this.naturalWidth>a?(s.width=this.naturalWidth*a/this.naturalHeight,s.height=a,s.left=r+(o-s.width)/2):(s.width=o,s.height=this.naturalHeight*o/this.naturalWidth,s.top=r+(a-s.height)/2);let h=null;return this.tabletopObject instanceof Kn?h=this.tabletopObject.topCard:this.tabletopObject instanceof zn&&(h=this.tabletopObject),h&&(s.scale=s.width/(h.size*this.gridSize),s.width=h.size*this.gridSize,s.height=s.width*this.naturalHeight/this.naturalWidth),s}get cardColor(){let e=null;return this.tabletopObject instanceof Kn?e=this.tabletopObject.topCard:this.tabletopObject instanceof zn&&(e=this.tabletopObject),e?e.color:"#555555"}get cardFontSize(){let e=null;return this.tabletopObject instanceof Kn?e=this.tabletopObject.topCard:this.tabletopObject instanceof zn&&(e=this.tabletopObject),e?e.fontsize+9:18}get cardText(){let e=null;return this.tabletopObject instanceof Kn?e=this.tabletopObject.topCard:this.tabletopObject instanceof zn&&(e=this.tabletopObject),e?rt.rubyToHtml(rt.escapeHtml(e.text)):""}get cardTextShadowCss(){const e=rt.textShadowColor(this.cardColor);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}get isVisible(){return!!this.tabletopObject&&(!(!We.myCursor||!We.myCursor.isGMMode)||(this.tabletopObject instanceof zn?this.tabletopObject.isFront||this.tabletopObject.isHand:!(this.tabletopObject instanceof cr)||this.tabletopObject.isVisible))}get isBlackPaint(){return this.tabletopObject instanceof Gt?this.tabletopObject.isBlackPaint:this.tabletopObject instanceof cr&&!this.isVisible}get isNoLogging(){return this.tabletopObject instanceof zn?!this.tabletopObject.isFront:this.tabletopObject instanceof cr&&this.tabletopObject.hasOwner}showCaseOffset(e){let i=this.tabletopObject.imageFiles.length;return i<=5?0:(50-160/(i-2))*(this.tabletopObject.currntImageIndex<=e?e-1:e)}showIconOffset(e){let i=this.tabletopObject.faceIcons.length;return i<=5?0:(50-200/(i-1))*e+2}}return t.\u0275fac=function(e){return new(e||t)(He(Dr),He(An),He(Fn),He(fi))},t.\u0275cmp=Xt({type:t,selectors:[["game-character-sheet"]],viewQuery:function(e,i){if(1&e&&cn(UH,5),2&e){let r;ln(r=un())&&(i.mainImageElement=r.first)}},inputs:{tabletopObject:"tabletopObject"},decls:19,vars:14,consts:[[3,"click"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[4,"ngIf"],["class","flex-container",4,"ngIf"],[1,"progress"],[3,"ngModel","change",4,"ngIf"],[3,"ngModel","change"],["value","table"],["value","common"],[3,"value"],["value","graveyard"],[1,"flex-container"],[1,"shadow-image",3,"src","alt","click"],["class","box main-image-box",4,"ngIf"],[1,"box","main-image-box"],[1,"icons-box"],["style","position: relative",3,"top",4,"ngFor","ngForOf","ngForTrackBy"],[1,"image-showcase",2,"position","absolute","height","50px","top","300px"],["class","image-thumbnail","style","position: absolute;",3,"ngClass","left",4,"ngFor","ngForOf"],["style","position: relative; bottom: 30px; z-index: 700;",3,"left","click",4,"ngIf"],["class","text",3,"width","height","ngStyle",4,"ngIf"],[1,"inverser",2,"display","inline-block",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"main-image",3,"src","alt","ngClass","dblclick","load"],["mainImage",""],["class","icon-image-box",3,"ngClass",4,"ngIf"],[1,"icon-image-box",3,"ngClass"],[3,"src","alt","click"],["class","button-delete-icon","title","\u9854IC\u524a\u9664",3,"click",4,"ngIf"],["title","\u9854IC\u524a\u9664",1,"button-delete-icon",3,"click"],[1,"material-icons",2,"font-size","1rem"],[1,"image-thumbnail",2,"position","absolute",3,"ngClass"],[2,"position","relative","bottom","30px","z-index","700",3,"click"],[1,"text",3,"ngStyle"],[3,"innerHTML"],[1,"flex-item"],[1,"table"],["game-data-element","",1,"table-row",3,"gameDataElement","tableTopObjectName","isTagLocked","isHideText","isNoLogging","descriptionType"],["style","margin-top: 3px; text-align: right",4,"ngIf"],[2,"margin-top","3px","text-align","right"],[2,"font-size","11px","color","#444",3,"click"],["class","flex-item",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","tableTopObjectName","isEdit","isNoLogging"],[2,"width","100%","color","#555",3,"click"]],template:function(e,i){1&e&&(Q(0,"button",0),Ae("click",function(){return i.toggleEditMode()}),ye(1,"\u7de8\u96c6\u5207\u308a\u66ff\u3048"),ie(),Ke(2,1),Te(3,VH,1,0,"ng-container",2),Te(4,GH,5,1,"ng-container",2),Te(5,qH,3,0,"ng-container",2),Te(6,WH,5,0,"ng-container",2),Te(7,KH,3,1,"ng-container",2),Te(8,YH,5,3,"ng-container",2),Te(9,XH,2,1,"ng-container",3),Ye(),Q(10,"button",0),Ae("click",function(){return i.clone()}),ye(11,"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b"),ie(),Q(12,"button",4),Ae("click",function(){return i.saveToXML()}),Q(13,"div",5)(14,"div",6),ye(15,"\u4fdd\u5b58"),ie(),Te(16,QH,2,1,"div",7),ie()(),Te(17,eU,4,2,"ng-container",8),Te(18,vU,7,9,"div",9)),2&e&&(U(2),re("ngSwitch",i.tabletopObject.aliasName),U(1),re("ngSwitchCase","numberResource"),U(1),re("ngSwitchCase","card"),U(1),re("ngSwitchCase","card-stack"),U(1),re("ngSwitchCase","terrain"),U(1),re("ngSwitchCase","dice-symbol"),U(1),re("ngSwitchCase","character"),U(4),re("disabled",i.isSaveing),U(2),re("ngClass",ft(12,bU,i.isSaveing)),U(2),re("ngIf",i.isSaveing),U(1),re("ngIf","character"===i.tabletopObject.aliasName),U(1),re("ngIf",i.tabletopObject))},directives:[Tl,Sd,Id,bn,Yn,es,$i,di,Ur,Vr,oi,Ji,HH],pipes:[ai],styles:["[_nghost-%COMP%]{display:block}.main-image-box[_ngcontent-%COMP%]{width:250px;height:250px;z-index:0}.main-image[_ngcontent-%COMP%]{width:250px;-o-object-position:center bottom;object-position:center bottom}.image-showcase[_ngcontent-%COMP%]{vertical-align:top;text-align:left;position:absolute;display:inline-block;vertical-align:bottom;transform-origin:center bottom}.image-thumbnail[_ngcontent-%COMP%]{color:#000;filter:drop-shadow(1px 1px 0px rgb(255,244,232)) drop-shadow(-1px 1px 0px rgb(255,244,232)) drop-shadow(-1px -1px 0px rgb(255,244,232)) drop-shadow(1px -1px 0px rgb(255,244,232));z-index:100;vertical-align:bottom;transform-origin:center bottom;transition:all 132ms ease-in-out}.image-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;max-height:100px;position:absolute;left:0;right:0;bottom:0;margin:auto;-o-object-fit:contain;object-fit:contain;-o-object-position:center bottom;object-position:center bottom;transform-origin:center bottom}.image-thumbnail[_ngcontent-%COMP%]:hover{z-index:600}.image-thumbnail[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{width:75px;max-height:150px;left:-12px;transition:all 132ms ease-in-out}.image-thumbnail.hide[_ngcontent-%COMP%]{transform:scale3d(0,0,0)}.icons-box[_ngcontent-%COMP%]{vertical-align:top;text-align:center;position:absolute;left:216px;z-index:2}.icon-image-box[_ngcontent-%COMP%]{position:relative;width:50px;height:50px;max-width:50px;max-height:50px;border-radius:.5rem;color:#000;filter:drop-shadow(1px 1px 0px rgb(255,244,232)) drop-shadow(-1px 1px 0px rgb(255,244,232)) drop-shadow(-1px -1px 0px rgb(255,244,232)) drop-shadow(1px -1px 0px rgb(255,244,232));z-index:100;margin-top:1px;margin-left:-3px}.icon-image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:.5rem;border:2px solid transparent}.icon-image-box[_ngcontent-%COMP%]:hover{z-index:600}.icon-image-box[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{border:2px dotted rgba(255,0,0,40)}.icon-image-box.current-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid red}.icon-image-box[_ngcontent-%COMP%]{z-index:400}.shadow-image[_ngcontent-%COMP%]{position:absolute;width:50px;filter:brightness(0) blur(1px) drop-shadow(0px 0px 1px #fff);opacity:.7;margin-top:6px;margin-left:6px;z-index:5}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{display:table-row;box-sizing:border-box}.table-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:table-cell;border:1px solid #FFF;vertical-align:top;box-sizing:border-box}.box[_ngcontent-%COMP%]{display:inline-block;margin:5px;box-sizing:border-box}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px 0;padding:10px;flex:1 0 auto;box-sizing:border-box;min-width:25px;background-color:#eac99dcc;background-color:#f0dabdcc;color:#444;z-index:1}.flex-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{color:#ccc}.button-delete-icon[_ngcontent-%COMP%]{display:inline-block;position:absolute;margin:0;padding:2px 0 0;background-color:transparent;right:-3px;top:1px;height:18px;width:18px;font-size:8px;color:red}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #fff)}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}.text[_ngcontent-%COMP%]{transform-origin:left top;position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}"],data:{animation:[Sn("switchImage",[Lt(":increment, :decrement",[Rt("200ms ease",sn([et({transform:"scale3d(0, 0, 0)"}),et({transform:"scale3d(0, 1.2, 1.2)"}),et({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),Sn("showcase",[Lt(":increment, :decrement",[Rt("200ms 200ms ease-in",sn([et({transform:"scale3d(0, 1.0, 1.0)"}),et({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),Sn("showcaseItem",[Lt(":enter",[Rt("200ms ease",sn([et({transform:"scale3d(0, 0, 0)"}),et({transform:"scale3d(1.0, 1.0, 1.0)"})]))]),Lt(":leave",[Rt("200ms ease",sn([et({transform:"scale3d(1.0, 1.0, 1.0)"}),et({transform:"scale3d(0, 0, 0)"})]))])]),Sn("bounceInOut",[Lt("void => *",[Rt("600ms ease",sn([et({transform:"scale3d(0, 0, 0)",offset:0}),et({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),et({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),et({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),et({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Lt("* => void",[Rt(100,et({transform:"scale3d(0, 0, 0)"}))])])]}}),t})();const yU=["passwordInput"],CU=function(){return{standalone:!0}};let xU=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.password="",this.help="",this.targetPeerContext=null,this.title="",this.targetPeerContext=vi.parse(i.option.peerId?i.option.peerId:"???"),this.title=i.option.title?i.option.title:""}get peerId(){return xt.peerId}get isConnected(){return!(xt.peerIds.length<=1)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title=`\u30d1\u30b9\u30ef\u30fc\u30c9\u3008${this.title}\u3009`),ze.register(this)}ngAfterViewInit(){this.passwordInputElementRef.nativeElement.focus()}ngOnDestroy(){ze.unregister(this)}onInputChange(e){this.help=""}submit(){this.targetPeerContext.verifyPassword(this.password)&&this.modalService.resolve(this.password),this.help="\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u9055\u3044\u307e\u3059"}}return t.\u0275fac=function(e){return new(e||t)(He(An),He(Fn))},t.\u0275cmp=Xt({type:t,selectors:[["password-check"]],viewQuery:function(e,i){if(1&e&&cn(yU,7),2&e){let r;ln(r=un())&&(i.passwordInputElementRef=r.first)}},decls:11,vars:4,consts:[["passwordForm","ngForm"],["placeholder","\u30d1\u30b9\u30ef\u30fc\u30c9",3,"ngModel","ngModelOptions","ngModelChange","input"],["passwordInput",""],["type","submit",3,"click"],[2,"font-size","12px"]],template:function(e,i){1&e&&(Q(0,"form",null,0)(2,"div"),ye(3,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),Q(4,"input",1,2),Ae("ngModelChange",function(s){return i.password=s})("input",function(s){return i.onInputChange(s.target.value)}),ie()(),Q(6,"button",3),Ae("click",function(){return i.submit()}),ye(7,"\u5165\u5ba4"),ie()(),Q(8,"div")(9,"span",4),ye(10),ie()()),2&e&&(U(4),re("ngModel",i.password)("ngModelOptions",sa(3,CU)),U(6),Xe(i.help))},directives:[Ml,kl,la,mi,$i,di],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}"]}),t})();function wU(t,n){if(1&t&&(Q(0,"div")(1,"div",9),ye(2," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),ie(),Q(3,"div",9),ye(4," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),ie(),Q(5,"div",9),ye(6," \u30eb\u30fc\u30e0\u540d\u524d\u306e\u9577\u3055\u306f128\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),ie()()),2&t){_e();const e=Kt(4);U(1),re("hidden",!e.errors.required),U(2),re("hidden",!e.errors.minlength),U(2),re("hidden",!e.errors.maxlength)}}function EU(t,n){if(1&t&&(Q(0,"div")(1,"div",9),ye(2," \u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u306f12\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),ie()()),2&t){_e();const e=Kt(8);U(1),re("hidden",!e.errors.maxlength)}}function TU(t,n){1&t&&(Q(0,"div"),ye(1," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5408\u8a08\u304c\u9577\u3059\u304e\u308b\u3088\u3046\u3067\u3059\u3002\u3069\u3061\u3089\u304b\u3092\u5c11\u3057\u77ed\u304f\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002 "),ie())}function SU(t,n){if(1&t){const e=it();Q(0,"div")(1,"div"),ye(2,"\u30eb\u30fc\u30e0\u540d : "),Q(3,"input",3,4),Ae("input",function(r){Oe(e);const s=_e();return s.calcPeerId(r.target.value,s.password)})("ngModelChange",function(r){return Oe(e),_e().roomName=r}),ie()(),Q(5,"div"),ye(6,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),Q(7,"input",5,6),Ae("input",function(r){Oe(e);const s=_e();return s.calcPeerId(s.roomName,r.target.value)})("ngModelChange",function(r){return Oe(e),_e().password=r}),ie()(),ot(9,"hr"),Te(10,wU,7,3,"div",7),Te(11,EU,3,1,"div",7),Te(12,TU,2,0,"div",7),Q(13,"div")(14,"button",8),Ae("click",function(){return Oe(e),_e().createRoom()}),ye(15,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210"),ie()()()}if(2&t){const e=Kt(4),i=Kt(8),r=_e();U(3),re("ngModel",r.roomName),U(4),re("ngModel",r.password),U(3),re("ngIf",e.errors&&(e.dirty||e.touched)),U(1),re("ngIf",i.errors&&(i.dirty||i.touched)),U(1),re("ngIf",!r.validateLength),U(2),re("disabled",!e.valid||!i.valid||!r.validateLength)}}function IU(t,n){1&t&&(Q(0,"span",1),ye(1,"\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u63a5\u7d9a\u3057\u305f\u307e\u307e\u3067\u306f\u30eb\u30fc\u30e0\u4f5c\u6210\u3092\u884c\u3048\u307e\u305b\u3093\u3002"),ot(2,"br"),ye(3,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),ot(4,"br"),ye(5,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),ie())}let kU=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.peers=[],this.isReloading=!1,this.roomName="\u3075\u3064\u3046\u306e\u90e8\u5c4b",this.password="",this.isPrivate=!1,this.validateLength=!1}get peerId(){return xt.peerId}get isConnected(){return!(xt.peerIds.length<=1)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30eb\u30fc\u30e0\u4f5c\u6210"),ze.register(this),this.calcPeerId(this.roomName,this.password)}ngOnDestroy(){ze.unregister(this)}calcPeerId(e,i){let r=xt.peerContext?xt.peerContext.userId:vi.generateId(),s=vi.create(r,vi.generateId("***"),e,i);this.validateLength=s.peerId.length<64}createRoom(){let e=xt.peerContext?xt.peerContext.userId:vi.generateId();xt.open(e,vi.generateId("***"),this.roomName,this.password),We.myCursor.peerId=xt.peerId,this.modalService.resolve()}}return t.\u0275fac=function(e){return new(e||t)(He(An),He(Fn))},t.\u0275cmp=Xt({type:t,selectors:[["room-setting"]],decls:6,vars:2,consts:[[4,"ngIf","ngIfElse"],[2,"font-size","12px"],["other_content",""],["required","","minlength","1","maxlength","128","placeholder","\u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808",1,"input",3,"ngModel","input","ngModelChange"],["roomNameValidation","ngModel"],["maxlength","12","placeholder","\u7a7a\u306a\u3089\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u3057",1,"input",3,"ngModel","input","ngModelChange"],["passwordValidation","ngModel"],[4,"ngIf"],[3,"disabled","click"],[3,"hidden"]],template:function(e,i){if(1&e&&(Te(0,SU,16,6,"div",0),Q(1,"div")(2,"span",1),ye(3,"\u203b\u4f5c\u6210\u3057\u305f\u30eb\u30fc\u30e0\u306f\u53c2\u52a0\u8005\u304c0\u4eba\u306b\u306a\u3063\u305f\u6642\u70b9\u3067\u89e3\u6563\u3057\u307e\u3059\u3002\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),ie()(),Te(4,IU,6,0,"ng-template",null,2,Un)),2&e){const r=Kt(5);re("ngIf",!i.isConnected)("ngIfElse",r)}},directives:[bn,mi,op,H$,U$,$i,di],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.input[_ngcontent-%COMP%]{width:100%}"]}),t})();function MU(t,n){1&t&&(Q(0,"td")(1,"i",11),ye(2,"lock"),ie()())}function DU(t,n){1&t&&(Q(0,"td"),ye(1,"-"),ie())}function AU(t,n){if(1&t){const e=it();Q(0,"button",12),Ae("click",function(){Oe(e);const r=_e().$implicit;return _e(3).connect(r.peerContexts)}),ye(1,"\u63a5\u7d9a"),ie()}if(2&t){const e=_e().$implicit,i=_e(3);re("disabled",(null==e.peerContexts[0]?null:e.peerContexts[0].roomId)===i.currentRoom)}}function PU(t,n){if(1&t&&(Ke(0),Q(1,"tr")(2,"td",9),ye(3),ie(),Q(4,"td",7),ye(5),ie(),Te(6,MU,3,0,"td",4),Te(7,DU,2,0,"td",4),Q(8,"td"),ye(9),ie(),Q(10,"td"),Te(11,AU,2,1,"button",10),ie()(),Ye()),2&t){const e=n.$implicit;U(3),Xe(null==e.peerContexts[0]?null:e.peerContexts[0].roomId),U(2),Xe(e.roomName),U(1),re("ngIf",e.peerContexts[0].hasPassword),U(1),re("ngIf",!e.peerContexts[0].hasPassword),U(2),Rn("",e.peerContexts.length,"\u4eba"),U(2),re("ngIf",0<e.alias.length)}}function NU(t,n){if(1&t&&(Ke(0),Q(1,"table",6)(2,"tr")(3,"th"),ye(4,"\u30eb\u30fc\u30e0ID"),ie(),Q(5,"th",7),ye(6,"\u30eb\u30fc\u30e0\u540d"),ie(),Q(7,"th"),ye(8,"\u30d1\u30b9\u30ef\u30fc\u30c9"),ie(),Q(9,"th"),ye(10,"\u53c2\u52a0\u8005"),ie(),ot(11,"th"),ie(),Te(12,PU,12,6,"ng-container",8),ie(),Ye()),2&t){const e=_e(2);U(12),re("ngForOf",e.rooms)}}function FU(t,n){if(1&t&&(Q(0,"span",13),ye(1),ie()),2&t){const e=_e(2);U(1),Xe(e.help)}}function OU(t,n){if(1&t){const e=it();Q(0,"div")(1,"button",2),Ae("click",function(){return Oe(e),_e().reload()}),ye(2,"\u4e00\u89a7\u3092\u66f4\u65b0"),ie(),Q(3,"button",3),Ae("click",function(){return Oe(e),_e().showRoomSetting()}),ye(4,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b"),ie(),ot(5,"hr"),Te(6,NU,13,1,"ng-container",4),Te(7,FU,2,1,"span",5),ie()}if(2&t){const e=_e();U(1),re("disabled",e.isReloading),U(5),re("ngIf",e.rooms.length),U(1),re("ngIf",e.rooms.length<1)}}function RU(t,n){1&t&&(Q(0,"span",13),ye(1,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),ot(2,"br"),ye(3,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),ie())}let BU=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.rooms=[],this.isReloading=!1,this.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"}get currentRoom(){return xt.peerContext.roomId}get peerId(){return xt.peerId}get isConnected(){return!(xt.peerIds.length<=1)}ngOnInit(){Promise.resolve().then(()=>this.changeTitle()),ze.register(this).on("OPEN_NETWORK",e=>{this.changeTitle()}).on("CONNECT_PEER",e=>{this.changeTitle()}),this.reload()}changeTitle(){this.modalService.title=this.panelService.title="\u30ed\u30d3\u30fc",xt.peerContext.roomName.length&&(this.modalService.title=this.panelService.title="\u3008"+xt.peerContext.roomName+"/"+xt.peerContext.roomId+"\u3009")}ngOnDestroy(){ze.unregister(this)}reload(){var e=this;return(0,tn.Z)(function*(){e.isReloading=!0,e.help="\u691c\u7d22\u4e2d...",e.rooms=[];let i={},r=yield xt.listAllPeers();for(let s of r){let o=vi.parse(s);if(o.isRoom){let a=o.roomId+o.roomName;a in i||(i[a]=[]),i[a].push(o)}}for(let s in i)e.rooms.push({alias:s,roomName:i[s][0].roomName,peerContexts:i[s]});e.rooms.sort((s,o)=>s.alias<o.alias?-1:s.alias>o.alias?1:0),e.help="\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u300c\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b\u300d\u3067\u65b0\u898f\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002",e.isReloading=!1})()}connect(e){var i=this;return(0,tn.Z)(function*(){let r=e[0],s="";if(r.hasPassword&&(s=yield i.modalService.open(xU,{peerId:r.peerId,title:`${r.roomName}/${r.roomId}`}),null==s&&(s="")),!r.verifyPassword(s))return;let o=xt.peerContext?xt.peerContext.userId:vi.generateId();xt.open(o,r.roomId,r.roomName,s),We.myCursor.peerId=xt.peerId;let a=[];ze.register(a).on("OPEN_NETWORK",h=>{console.log("LobbyComponent OPEN_PEER",h.data.peerId),ze.unregister(a),dt.instance.clearDeleteHistory();for(let w of e)xt.connect(w.peerId);ze.register(a).on("CONNECT_PEER",w=>{console.log("\u63a5\u7d9a\u6210\u529f\uff01",w.data.peerId),a.push(w.data.peerId),console.log("\u63a5\u7d9a\u6210\u529f "+a.length+"/"+e.length),e.length<=a.length&&(i.resetNetwork(),ze.unregister(a),i.closeIfConnected())}).on("DISCONNECT_PEER",w=>{console.warn("\u63a5\u7d9a\u5931\u6557",w.data.peerId),a.push(w.data.peerId),console.warn("\u63a5\u7d9a\u5931\u6557 "+a.length+"/"+e.length),e.length<=a.length&&(i.resetNetwork(),ze.unregister(a),i.closeIfConnected())})})})()}resetNetwork(){xt.peerContexts.length<1&&(xt.open(),We.myCursor.peerId=xt.peerId)}closeIfConnected(){0<xt.peerContexts.length&&this.modalService.resolve()}showRoomSetting(){var e=this;return(0,tn.Z)(function*(){yield e.modalService.open(kU,{width:700,height:400,left:0,top:400}),e.reload(),e.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"})()}}return t.\u0275fac=function(e){return new(e||t)(He(An),He(Fn))},t.\u0275cmp=Xt({type:t,selectors:[["lobby"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["other_content",""],[3,"disabled","click"],[3,"click"],[4,"ngIf"],["style","font-size: 12px;",4,"ngIf"],[1,"room-list"],[1,"room-name"],[4,"ngFor","ngForOf"],[1,"is-small-font"],["type","submit",3,"disabled","click",4,"ngIf"],[1,"material-icons",2,"vertical-align","middle","font-size","0.9rem"],["type","submit",3,"disabled","click"],[2,"font-size","12px"]],template:function(e,i){if(1&e&&(Te(0,OU,8,3,"div",0),Te(1,RU,4,0,"ng-template",null,1,Un)),2&e){const r=Kt(2);re("ngIf",!i.isConnected)("ngIfElse",r)}},directives:[bn,oi],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.room-list[_ngcontent-%COMP%]{font-size:12px;border:0;border-spacing:0;padding:0;width:100%;max-width:100%;white-space:nowrap}.room-list[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:1px .5em;text-align:center}.room-name[_ngcontent-%COMP%]{white-space:normal;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;min-width:50%}.is-small-font[_ngcontent-%COMP%]{font-size:10px}"]}),t})();var tr_isObject=function LU(t){return"object"==typeof t&&null!==t},tr_repeat=function HU(t,n){var i,e="";for(i=0;i<n;i+=1)e+=t;return e},tr_isNegativeZero=function UU(t){return 0===t&&Number.NEGATIVE_INFINITY===1/t};function GT(t,n){var e="",i=t.reason||"(unknown reason)";return t.mark?(t.mark.name&&(e+='in "'+t.mark.name+'" '),e+="("+(t.mark.line+1)+":"+(t.mark.column+1)+")",!n&&t.mark.snippet&&(e+="\n\n"+t.mark.snippet),i+" "+e):i}function df(t,n){Error.call(this),this.name="YAMLException",this.reason=t,this.mark=n,this.message=GT(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}(df.prototype=Object.create(Error.prototype)).constructor=df,df.prototype.toString=function(n){return this.name+": "+GT(this,n)};var Wr=df;function uv(t,n,e,i,r){var s="",o="",a=Math.floor(r/2)-1;return i-n>a&&(n=i-a+(s=" ... ").length),e-i>a&&(e=i+a-(o=" ...").length),{str:s+t.slice(n,e).replace(/\t/g,"\u2192")+o,pos:i-n+s.length}}function dv(t,n){return tr_repeat(" ",n-t.length)+t}var QU=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],JU=["scalar","sequence","mapping"],_r=function tV(t,n){if(n=n||{},Object.keys(n).forEach(function(e){if(-1===QU.indexOf(e))throw new Wr('Unknown option "'+e+'" is met in definition of "'+t+'" YAML type.')}),this.options=n,this.tag=t,this.kind=n.kind||null,this.resolve=n.resolve||function(){return!0},this.construct=n.construct||function(e){return e},this.instanceOf=n.instanceOf||null,this.predicate=n.predicate||null,this.represent=n.represent||null,this.representName=n.representName||null,this.defaultStyle=n.defaultStyle||null,this.multi=n.multi||!1,this.styleAliases=function eV(t){var n={};return null!==t&&Object.keys(t).forEach(function(e){t[e].forEach(function(i){n[String(i)]=e})}),n}(n.styleAliases||null),-1===JU.indexOf(this.kind))throw new Wr('Unknown kind "'+this.kind+'" is specified for "'+t+'" YAML type.')};function qT(t,n){var e=[];return t[n].forEach(function(i){var r=e.length;e.forEach(function(s,o){s.tag===i.tag&&s.kind===i.kind&&s.multi===i.multi&&(r=o)}),e[r]=i}),e}function fv(t){return this.extend(t)}fv.prototype.extend=function(n){var e=[],i=[];if(n instanceof _r)i.push(n);else if(Array.isArray(n))i=i.concat(n);else{if(!n||!Array.isArray(n.implicit)&&!Array.isArray(n.explicit))throw new Wr("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");n.implicit&&(e=e.concat(n.implicit)),n.explicit&&(i=i.concat(n.explicit))}e.forEach(function(s){if(!(s instanceof _r))throw new Wr("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(s.loadKind&&"scalar"!==s.loadKind)throw new Wr("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(s.multi)throw new Wr("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),i.forEach(function(s){if(!(s instanceof _r))throw new Wr("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var r=Object.create(fv.prototype);return r.implicit=(this.implicit||[]).concat(e),r.explicit=(this.explicit||[]).concat(i),r.compiledImplicit=qT(r,"implicit"),r.compiledExplicit=qT(r,"explicit"),r.compiledTypeMap=function nV(){var n,e,t={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function i(r){r.multi?(t.multi[r.kind].push(r),t.multi.fallback.push(r)):t[r.kind][r.tag]=t.fallback[r.tag]=r}for(n=0,e=arguments.length;n<e;n+=1)arguments[n].forEach(i);return t}(r.compiledImplicit,r.compiledExplicit),r};var WT=fv,KT=new _r("tag:yaml.org,2002:str",{kind:"scalar",construct:function(t){return null!==t?t:""}}),ZT=new _r("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(t){return null!==t?t:[]}}),XT=new _r("tag:yaml.org,2002:map",{kind:"mapping",construct:function(t){return null!==t?t:{}}}),QT=new WT({explicit:[KT,ZT,XT]}),JT=new _r("tag:yaml.org,2002:null",{kind:"scalar",resolve:function iV(t){if(null===t)return!0;var n=t.length;return 1===n&&"~"===t||4===n&&("null"===t||"Null"===t||"NULL"===t)},construct:function rV(){return null},predicate:function sV(t){return null===t},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"}),eS=new _r("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function oV(t){if(null===t)return!1;var n=t.length;return 4===n&&("true"===t||"True"===t||"TRUE"===t)||5===n&&("false"===t||"False"===t||"FALSE"===t)},construct:function aV(t){return"true"===t||"True"===t||"TRUE"===t},predicate:function lV(t){return"[object Boolean]"===Object.prototype.toString.call(t)},represent:{lowercase:function(t){return t?"true":"false"},uppercase:function(t){return t?"TRUE":"FALSE"},camelcase:function(t){return t?"True":"False"}},defaultStyle:"lowercase"});function cV(t){return 48<=t&&t<=57||65<=t&&t<=70||97<=t&&t<=102}function uV(t){return 48<=t&&t<=55}function dV(t){return 48<=t&&t<=57}var tS=new _r("tag:yaml.org,2002:int",{kind:"scalar",resolve:function fV(t){if(null===t)return!1;var r,n=t.length,e=0,i=!1;if(!n)return!1;if(("-"===(r=t[e])||"+"===r)&&(r=t[++e]),"0"===r){if(e+1===n)return!0;if("b"===(r=t[++e])){for(e++;e<n;e++)if("_"!==(r=t[e])){if("0"!==r&&"1"!==r)return!1;i=!0}return i&&"_"!==r}if("x"===r){for(e++;e<n;e++)if("_"!==(r=t[e])){if(!cV(t.charCodeAt(e)))return!1;i=!0}return i&&"_"!==r}if("o"===r){for(e++;e<n;e++)if("_"!==(r=t[e])){if(!uV(t.charCodeAt(e)))return!1;i=!0}return i&&"_"!==r}}if("_"===r)return!1;for(;e<n;e++)if("_"!==(r=t[e])){if(!dV(t.charCodeAt(e)))return!1;i=!0}return!(!i||"_"===r)},construct:function hV(t){var i,n=t,e=1;if(-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),("-"===(i=n[0])||"+"===i)&&("-"===i&&(e=-1),i=(n=n.slice(1))[0]),"0"===n)return 0;if("0"===i){if("b"===n[1])return e*parseInt(n.slice(2),2);if("x"===n[1])return e*parseInt(n.slice(2),16);if("o"===n[1])return e*parseInt(n.slice(2),8)}return e*parseInt(n,10)},predicate:function pV(t){return"[object Number]"===Object.prototype.toString.call(t)&&t%1==0&&!tr_isNegativeZero(t)},represent:{binary:function(t){return t>=0?"0b"+t.toString(2):"-0b"+t.toString(2).slice(1)},octal:function(t){return t>=0?"0o"+t.toString(8):"-0o"+t.toString(8).slice(1)},decimal:function(t){return t.toString(10)},hexadecimal:function(t){return t>=0?"0x"+t.toString(16).toUpperCase():"-0x"+t.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),gV=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),$V=/^[-+]?[0-9]+e/,nS=new _r("tag:yaml.org,2002:float",{kind:"scalar",resolve:function _V(t){return!(null===t||!gV.test(t)||"_"===t[t.length-1])},construct:function mV(t){var n,e;return e="-"===(n=t.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(n[0])>=0&&(n=n.slice(1)),".inf"===n?1===e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===n?NaN:e*parseFloat(n,10)},predicate:function bV(t){return"[object Number]"===Object.prototype.toString.call(t)&&(t%1!=0||tr_isNegativeZero(t))},represent:function vV(t,n){var e;if(isNaN(t))switch(n){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===t)switch(n){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===t)switch(n){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(tr_isNegativeZero(t))return"-0.0";return e=t.toString(10),$V.test(e)?e.replace("e",".e"):e},defaultStyle:"lowercase"}),rS=QT.extend({implicit:[JT,eS,tS,nS]}),sS=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),oS=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$"),aS=new _r("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function yV(t){return null!==t&&(null!==sS.exec(t)||null!==oS.exec(t))},construct:function CV(t){var n,e,i,r,s,o,a,pe,h=0,w=null;if(null===(n=sS.exec(t))&&(n=oS.exec(t)),null===n)throw new Error("Date resolve error");if(e=+n[1],i=+n[2]-1,r=+n[3],!n[4])return new Date(Date.UTC(e,i,r));if(s=+n[4],o=+n[5],a=+n[6],n[7]){for(h=n[7].slice(0,3);h.length<3;)h+="0";h=+h}return n[9]&&(w=6e4*(60*+n[10]+ +(n[11]||0)),"-"===n[9]&&(w=-w)),pe=new Date(Date.UTC(e,i,r,s,o,a,h)),w&&pe.setTime(pe.getTime()-w),pe},instanceOf:Date,represent:function xV(t){return t.toISOString()}}),lS=new _r("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function wV(t){return"<<"===t||null===t}}),hv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r",cS=new _r("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function EV(t){if(null===t)return!1;var n,e,i=0,r=t.length,s=hv;for(e=0;e<r;e++)if(!((n=s.indexOf(t.charAt(e)))>64)){if(n<0)return!1;i+=6}return i%8==0},construct:function TV(t){var n,e,i=t.replace(/[\r\n=]/g,""),r=i.length,s=hv,o=0,a=[];for(n=0;n<r;n++)n%4==0&&n&&(a.push(o>>16&255),a.push(o>>8&255),a.push(255&o)),o=o<<6|s.indexOf(i.charAt(n));return 0==(e=r%4*6)?(a.push(o>>16&255),a.push(o>>8&255),a.push(255&o)):18===e?(a.push(o>>10&255),a.push(o>>2&255)):12===e&&a.push(o>>4&255),new Uint8Array(a)},predicate:function IV(t){return"[object Uint8Array]"===Object.prototype.toString.call(t)},represent:function SV(t){var i,r,n="",e=0,s=t.length,o=hv;for(i=0;i<s;i++)i%3==0&&i&&(n+=o[e>>18&63],n+=o[e>>12&63],n+=o[e>>6&63],n+=o[63&e]),e=(e<<8)+t[i];return 0==(r=s%3)?(n+=o[e>>18&63],n+=o[e>>12&63],n+=o[e>>6&63],n+=o[63&e]):2===r?(n+=o[e>>10&63],n+=o[e>>4&63],n+=o[e<<2&63],n+=o[64]):1===r&&(n+=o[e>>2&63],n+=o[e<<4&63],n+=o[64],n+=o[64]),n}}),kV=Object.prototype.hasOwnProperty,MV=Object.prototype.toString,uS=new _r("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function DV(t){if(null===t)return!0;var e,i,r,s,o,n=[],a=t;for(e=0,i=a.length;e<i;e+=1){if(o=!1,"[object Object]"!==MV.call(r=a[e]))return!1;for(s in r)if(kV.call(r,s)){if(o)return!1;o=!0}if(!o)return!1;if(-1!==n.indexOf(s))return!1;n.push(s)}return!0},construct:function AV(t){return null!==t?t:[]}}),PV=Object.prototype.toString,dS=new _r("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function NV(t){if(null===t)return!0;var n,e,i,r,s,o=t;for(s=new Array(o.length),n=0,e=o.length;n<e;n+=1){if("[object Object]"!==PV.call(i=o[n])||1!==(r=Object.keys(i)).length)return!1;s[n]=[r[0],i[r[0]]]}return!0},construct:function FV(t){if(null===t)return[];var n,e,i,r,s,o=t;for(s=new Array(o.length),n=0,e=o.length;n<e;n+=1)i=o[n],r=Object.keys(i),s[n]=[r[0],i[r[0]]];return s}}),OV=Object.prototype.hasOwnProperty,fS=new _r("tag:yaml.org,2002:set",{kind:"mapping",resolve:function RV(t){if(null===t)return!0;var n,e=t;for(n in e)if(OV.call(e,n)&&null!==e[n])return!1;return!0},construct:function BV(t){return null!==t?t:{}}}),pv=rS.extend({implicit:[aS,lS],explicit:[cS,uS,dS,fS]}),Ja=Object.prototype.hasOwnProperty,zV=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,jV=/[\x85\u2028\u2029]/,HV=/[,\[\]\{\}]/,_S=/^(?:!|!!|![a-z\-]+!)$/i,mS=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function $S(t){return Object.prototype.toString.call(t)}function Xo(t){return 10===t||13===t}function Zl(t){return 9===t||32===t}function rs(t){return 9===t||32===t||10===t||13===t}function pu(t){return 44===t||91===t||93===t||123===t||125===t}function UV(t){var n;return 48<=t&&t<=57?t-48:97<=(n=32|t)&&n<=102?n-97+10:-1}function VV(t){return 120===t?2:117===t?4:85===t?8:0}function GV(t){return 48<=t&&t<=57?t-48:-1}function vS(t){return 48===t?"\0":97===t?"\x07":98===t?"\b":116===t||9===t?"\t":110===t?"\n":118===t?"\v":102===t?"\f":114===t?"\r":101===t?"\x1b":32===t?" ":34===t?'"':47===t?"/":92===t?"\\":78===t?"\x85":95===t?"\xa0":76===t?"\u2028":80===t?"\u2029":""}function qV(t){return t<=65535?String.fromCharCode(t):String.fromCharCode(55296+(t-65536>>10),56320+(t-65536&1023))}for(var bS=new Array(256),yS=new Array(256),gu=0;gu<256;gu++)bS[gu]=vS(gu)?1:0,yS[gu]=vS(gu);function WV(t,n){this.input=t,this.filename=n.filename||null,this.schema=n.schema||pv,this.onWarning=n.onWarning||null,this.legacy=n.legacy||!1,this.json=n.json||!1,this.listener=n.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=t.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function CS(t,n){var e={name:t.filename,buffer:t.input.slice(0,-1),position:t.position,line:t.line,column:t.position-t.lineStart};return e.snippet=function ZU(t,n){if(n=Object.create(n||null),!t.buffer)return null;n.maxLength||(n.maxLength=79),"number"!=typeof n.indent&&(n.indent=1),"number"!=typeof n.linesBefore&&(n.linesBefore=3),"number"!=typeof n.linesAfter&&(n.linesAfter=2);for(var s,e=/\r?\n|\r|\0/g,i=[0],r=[],o=-1;s=e.exec(t.buffer);)r.push(s.index),i.push(s.index+s[0].length),t.position<=s.index&&o<0&&(o=i.length-2);o<0&&(o=i.length-1);var h,w,a="",X=Math.min(t.line+n.linesAfter,r.length).toString().length,fe=n.maxLength-(n.indent+X+3);for(h=1;h<=n.linesBefore&&!(o-h<0);h++)w=uv(t.buffer,i[o-h],r[o-h],t.position-(i[o]-i[o-h]),fe),a=tr_repeat(" ",n.indent)+dv((t.line-h+1).toString(),X)+" | "+w.str+"\n"+a;for(w=uv(t.buffer,i[o],r[o],t.position,fe),a+=tr_repeat(" ",n.indent)+dv((t.line+1).toString(),X)+" | "+w.str+"\n",a+=tr_repeat("-",n.indent+X+3+w.pos)+"^\n",h=1;h<=n.linesAfter&&!(o+h>=r.length);h++)w=uv(t.buffer,i[o+h],r[o+h],t.position-(i[o]-i[o+h]),fe),a+=tr_repeat(" ",n.indent)+dv((t.line+h+1).toString(),X)+" | "+w.str+"\n";return a.replace(/\n$/,"")}(e),new Wr(n,e)}function qt(t,n){throw CS(t,n)}function ag(t,n){t.onWarning&&t.onWarning.call(null,CS(t,n))}var xS={YAML:function(n,e,i){var r,s,o;null!==n.version&&qt(n,"duplication of %YAML directive"),1!==i.length&&qt(n,"YAML directive accepts exactly one argument"),null===(r=/^([0-9]+)\.([0-9]+)$/.exec(i[0]))&&qt(n,"ill-formed argument of the YAML directive"),s=parseInt(r[1],10),o=parseInt(r[2],10),1!==s&&qt(n,"unacceptable YAML version of the document"),n.version=i[0],n.checkLineBreaks=o<2,1!==o&&2!==o&&ag(n,"unsupported YAML version of the document")},TAG:function(n,e,i){var r,s;2!==i.length&&qt(n,"TAG directive accepts exactly two arguments"),s=i[1],_S.test(r=i[0])||qt(n,"ill-formed tag handle (first argument) of the TAG directive"),Ja.call(n.tagMap,r)&&qt(n,'there is a previously declared suffix for "'+r+'" tag handle'),mS.test(s)||qt(n,"ill-formed tag prefix (second argument) of the TAG directive");try{s=decodeURIComponent(s)}catch(o){qt(n,"tag prefix is malformed: "+s)}n.tagMap[r]=s}};function el(t,n,e,i){var r,s,o,a;if(n<e){if(a=t.input.slice(n,e),i)for(r=0,s=a.length;r<s;r+=1)9===(o=a.charCodeAt(r))||32<=o&&o<=1114111||qt(t,"expected valid JSON character");else zV.test(a)&&qt(t,"the stream contains non-printable characters");t.result+=a}}function wS(t,n,e,i){var r,s,o,a;for(tr_isObject(e)||qt(t,"cannot merge mappings; the provided source object is unacceptable"),o=0,a=(r=Object.keys(e)).length;o<a;o+=1)Ja.call(n,s=r[o])||(n[s]=e[s],i[s]=!0)}function _u(t,n,e,i,r,s,o,a,h){var w,X;if(Array.isArray(r))for(w=0,X=(r=Array.prototype.slice.call(r)).length;w<X;w+=1)Array.isArray(r[w])&&qt(t,"nested arrays are not supported inside keys"),"object"==typeof r&&"[object Object]"===$S(r[w])&&(r[w]="[object Object]");if("object"==typeof r&&"[object Object]"===$S(r)&&(r="[object Object]"),r=String(r),null===n&&(n={}),"tag:yaml.org,2002:merge"===i)if(Array.isArray(s))for(w=0,X=s.length;w<X;w+=1)wS(t,n,s[w],e);else wS(t,n,s,e);else!t.json&&!Ja.call(e,r)&&Ja.call(n,r)&&(t.line=o||t.line,t.lineStart=a||t.lineStart,t.position=h||t.position,qt(t,"duplicated mapping key")),"__proto__"===r?Object.defineProperty(n,r,{configurable:!0,enumerable:!0,writable:!0,value:s}):n[r]=s,delete e[r];return n}function _v(t){var n;10===(n=t.input.charCodeAt(t.position))?t.position++:13===n?(t.position++,10===t.input.charCodeAt(t.position)&&t.position++):qt(t,"a line break is expected"),t.line+=1,t.lineStart=t.position,t.firstTabInLine=-1}function Gi(t,n,e){for(var i=0,r=t.input.charCodeAt(t.position);0!==r;){for(;Zl(r);)9===r&&-1===t.firstTabInLine&&(t.firstTabInLine=t.position),r=t.input.charCodeAt(++t.position);if(n&&35===r)do{r=t.input.charCodeAt(++t.position)}while(10!==r&&13!==r&&0!==r);if(!Xo(r))break;for(_v(t),r=t.input.charCodeAt(t.position),i++,t.lineIndent=0;32===r;)t.lineIndent++,r=t.input.charCodeAt(++t.position)}return-1!==e&&0!==i&&t.lineIndent<e&&ag(t,"deficient indentation"),i}function lg(t){var e,n=t.position;return!(45!==(e=t.input.charCodeAt(n))&&46!==e||e!==t.input.charCodeAt(n+1)||e!==t.input.charCodeAt(n+2)||(n+=3,e=t.input.charCodeAt(n),0!==e&&!rs(e)))}function mv(t,n){1===n?t.result+=" ":n>1&&(t.result+=tr_repeat("\n",n-1))}function ES(t,n){var e,h,i=t.tag,r=t.anchor,s=[],a=!1;if(-1!==t.firstTabInLine)return!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=s),h=t.input.charCodeAt(t.position);0!==h&&(-1!==t.firstTabInLine&&(t.position=t.firstTabInLine,qt(t,"tab characters must not be used in indentation")),45===h&&rs(t.input.charCodeAt(t.position+1)));)if(a=!0,t.position++,Gi(t,!0,-1)&&t.lineIndent<=n)s.push(null),h=t.input.charCodeAt(t.position);else if(e=t.line,mu(t,n,3,!1,!0),s.push(t.result),Gi(t,!0,-1),h=t.input.charCodeAt(t.position),(t.line===e||t.lineIndent>n)&&0!==h)qt(t,"bad indentation of a sequence entry");else if(t.lineIndent<n)break;return!!a&&(t.tag=i,t.anchor=r,t.kind="sequence",t.result=s,!0)}function eG(t){var n,r,s,o,e=!1,i=!1;if(33!==(o=t.input.charCodeAt(t.position)))return!1;if(null!==t.tag&&qt(t,"duplication of a tag property"),60===(o=t.input.charCodeAt(++t.position))?(e=!0,o=t.input.charCodeAt(++t.position)):33===o?(i=!0,r="!!",o=t.input.charCodeAt(++t.position)):r="!",n=t.position,e){do{o=t.input.charCodeAt(++t.position)}while(0!==o&&62!==o);t.position<t.length?(s=t.input.slice(n,t.position),o=t.input.charCodeAt(++t.position)):qt(t,"unexpected end of the stream within a verbatim tag")}else{for(;0!==o&&!rs(o);)33===o&&(i?qt(t,"tag suffix cannot contain exclamation marks"):(r=t.input.slice(n-1,t.position+1),_S.test(r)||qt(t,"named tag handle cannot contain such characters"),i=!0,n=t.position+1)),o=t.input.charCodeAt(++t.position);s=t.input.slice(n,t.position),HV.test(s)&&qt(t,"tag suffix cannot contain flow indicator characters")}s&&!mS.test(s)&&qt(t,"tag name cannot contain such characters: "+s);try{s=decodeURIComponent(s)}catch(a){qt(t,"tag name is malformed: "+s)}return e?t.tag=s:Ja.call(t.tagMap,r)?t.tag=t.tagMap[r]+s:"!"===r?t.tag="!"+s:"!!"===r?t.tag="tag:yaml.org,2002:"+s:qt(t,'undeclared tag handle "'+r+'"'),!0}function tG(t){var n,e;if(38!==(e=t.input.charCodeAt(t.position)))return!1;for(null!==t.anchor&&qt(t,"duplication of an anchor property"),e=t.input.charCodeAt(++t.position),n=t.position;0!==e&&!rs(e)&&!pu(e);)e=t.input.charCodeAt(++t.position);return t.position===n&&qt(t,"name of an anchor node must contain at least one character"),t.anchor=t.input.slice(n,t.position),!0}function mu(t,n,e,i,r){var s,o,a,fe,pe,we,Ie,Pe,Be,h=1,w=!1,X=!1;if(null!==t.listener&&t.listener("open",t),t.tag=null,t.anchor=null,t.kind=null,t.result=null,s=o=a=4===e||3===e,i&&Gi(t,!0,-1)&&(w=!0,t.lineIndent>n?h=1:t.lineIndent===n?h=0:t.lineIndent<n&&(h=-1)),1===h)for(;eG(t)||tG(t);)Gi(t,!0,-1)?(w=!0,a=s,t.lineIndent>n?h=1:t.lineIndent===n?h=0:t.lineIndent<n&&(h=-1)):a=!1;if(a&&(a=w||r),(1===h||4===e)&&(Pe=1===e||2===e?n:n+1,Be=t.position-t.lineStart,1===h?a&&(ES(t,Be)||function JV(t,n,e){var i,r,s,o,a,h,Fe,w=t.tag,X=t.anchor,fe={},pe=Object.create(null),we=null,Ie=null,Pe=null,Be=!1,Le=!1;if(-1!==t.firstTabInLine)return!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=fe),Fe=t.input.charCodeAt(t.position);0!==Fe;){if(!Be&&-1!==t.firstTabInLine&&(t.position=t.firstTabInLine,qt(t,"tab characters must not be used in indentation")),i=t.input.charCodeAt(t.position+1),s=t.line,63!==Fe&&58!==Fe||!rs(i)){if(o=t.line,a=t.lineStart,h=t.position,!mu(t,e,2,!1,!0))break;if(t.line===s){for(Fe=t.input.charCodeAt(t.position);Zl(Fe);)Fe=t.input.charCodeAt(++t.position);if(58===Fe)rs(Fe=t.input.charCodeAt(++t.position))||qt(t,"a whitespace character is expected after the key-value separator within a block mapping"),Be&&(_u(t,fe,pe,we,Ie,null,o,a,h),we=Ie=Pe=null),Le=!0,Be=!1,r=!1,we=t.tag,Ie=t.result;else{if(!Le)return t.tag=w,t.anchor=X,!0;qt(t,"can not read an implicit mapping pair; a colon is missed")}}else{if(!Le)return t.tag=w,t.anchor=X,!0;qt(t,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===Fe?(Be&&(_u(t,fe,pe,we,Ie,null,o,a,h),we=Ie=Pe=null),Le=!0,Be=!0,r=!0):Be?(Be=!1,r=!0):qt(t,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),t.position+=1,Fe=i;if((t.line===s||t.lineIndent>n)&&(Be&&(o=t.line,a=t.lineStart,h=t.position),mu(t,n,4,!0,r)&&(Be?Ie=t.result:Pe=t.result),Be||(_u(t,fe,pe,we,Ie,Pe,o,a,h),we=Ie=Pe=null),Gi(t,!0,-1),Fe=t.input.charCodeAt(t.position)),(t.line===s||t.lineIndent>n)&&0!==Fe)qt(t,"bad indentation of a mapping entry");else if(t.lineIndent<n)break}return Be&&_u(t,fe,pe,we,Ie,null,o,a,h),Le&&(t.tag=w,t.anchor=X,t.kind="mapping",t.result=fe),Le}(t,Be,Pe))||function XV(t,n){var i,r,s,a,X,fe,pe,we,Pe,Be,Le,Fe,e=!0,o=t.tag,h=t.anchor,Ie=Object.create(null);if(91===(Fe=t.input.charCodeAt(t.position)))X=93,we=!1,a=[];else{if(123!==Fe)return!1;X=125,we=!0,a={}}for(null!==t.anchor&&(t.anchorMap[t.anchor]=a),Fe=t.input.charCodeAt(++t.position);0!==Fe;){if(Gi(t,!0,n),(Fe=t.input.charCodeAt(t.position))===X)return t.position++,t.tag=o,t.anchor=h,t.kind=we?"mapping":"sequence",t.result=a,!0;e?44===Fe&&qt(t,"expected the node content, but found ','"):qt(t,"missed comma between flow collection entries"),Le=null,fe=pe=!1,63===Fe&&rs(t.input.charCodeAt(t.position+1))&&(fe=pe=!0,t.position++,Gi(t,!0,n)),i=t.line,r=t.lineStart,s=t.position,mu(t,n,1,!1,!0),Be=t.tag,Pe=t.result,Gi(t,!0,n),Fe=t.input.charCodeAt(t.position),(pe||t.line===i)&&58===Fe&&(fe=!0,Fe=t.input.charCodeAt(++t.position),Gi(t,!0,n),mu(t,n,1,!1,!0),Le=t.result),we?_u(t,a,Ie,Be,Pe,Le,i,r,s):a.push(fe?_u(t,null,Ie,Be,Pe,Le,i,r,s):Pe),Gi(t,!0,n),44===(Fe=t.input.charCodeAt(t.position))?(e=!0,Fe=t.input.charCodeAt(++t.position)):e=!1}qt(t,"unexpected end of the stream within a flow collection")}(t,Pe)?X=!0:(o&&function QV(t,n){var e,i,X,fe,r=1,s=!1,o=!1,a=n,h=0,w=!1;if(124===(fe=t.input.charCodeAt(t.position)))i=!1;else{if(62!==fe)return!1;i=!0}for(t.kind="scalar",t.result="";0!==fe;)if(43===(fe=t.input.charCodeAt(++t.position))||45===fe)1===r?r=43===fe?3:2:qt(t,"repeat of a chomping mode identifier");else{if(!((X=GV(fe))>=0))break;0===X?qt(t,"bad explicit indentation width of a block scalar; it cannot be less than one"):o?qt(t,"repeat of an indentation width identifier"):(a=n+X-1,o=!0)}if(Zl(fe)){do{fe=t.input.charCodeAt(++t.position)}while(Zl(fe));if(35===fe)do{fe=t.input.charCodeAt(++t.position)}while(!Xo(fe)&&0!==fe)}for(;0!==fe;){for(_v(t),t.lineIndent=0,fe=t.input.charCodeAt(t.position);(!o||t.lineIndent<a)&&32===fe;)t.lineIndent++,fe=t.input.charCodeAt(++t.position);if(!o&&t.lineIndent>a&&(a=t.lineIndent),Xo(fe))h++;else{if(t.lineIndent<a){3===r?t.result+=tr_repeat("\n",s?1+h:h):1===r&&s&&(t.result+="\n");break}for(i?Zl(fe)?(w=!0,t.result+=tr_repeat("\n",s?1+h:h)):w?(w=!1,t.result+=tr_repeat("\n",h+1)):0===h?s&&(t.result+=" "):t.result+=tr_repeat("\n",h):t.result+=tr_repeat("\n",s?1+h:h),s=!0,o=!0,h=0,e=t.position;!Xo(fe)&&0!==fe;)fe=t.input.charCodeAt(++t.position);el(t,e,t.position,!1)}}return!0}(t,Pe)||function YV(t,n){var e,i,r;if(39!==(e=t.input.charCodeAt(t.position)))return!1;for(t.kind="scalar",t.result="",t.position++,i=r=t.position;0!==(e=t.input.charCodeAt(t.position));)if(39===e){if(el(t,i,t.position,!0),39!==(e=t.input.charCodeAt(++t.position)))return!0;i=t.position,t.position++,r=t.position}else Xo(e)?(el(t,i,r,!0),mv(t,Gi(t,!1,n)),i=r=t.position):t.position===t.lineStart&&lg(t)?qt(t,"unexpected end of the document within a single quoted scalar"):(t.position++,r=t.position);qt(t,"unexpected end of the stream within a single quoted scalar")}(t,Pe)||function ZV(t,n){var e,i,r,s,o,a;if(34!==(a=t.input.charCodeAt(t.position)))return!1;for(t.kind="scalar",t.result="",t.position++,e=i=t.position;0!==(a=t.input.charCodeAt(t.position));){if(34===a)return el(t,e,t.position,!0),t.position++,!0;if(92===a){if(el(t,e,t.position,!0),Xo(a=t.input.charCodeAt(++t.position)))Gi(t,!1,n);else if(a<256&&bS[a])t.result+=yS[a],t.position++;else if((o=VV(a))>0){for(r=o,s=0;r>0;r--)(o=UV(a=t.input.charCodeAt(++t.position)))>=0?s=(s<<4)+o:qt(t,"expected hexadecimal character");t.result+=qV(s),t.position++}else qt(t,"unknown escape sequence");e=i=t.position}else Xo(a)?(el(t,e,i,!0),mv(t,Gi(t,!1,n)),e=i=t.position):t.position===t.lineStart&&lg(t)?qt(t,"unexpected end of the document within a double quoted scalar"):(t.position++,i=t.position)}qt(t,"unexpected end of the stream within a double quoted scalar")}(t,Pe)?X=!0:function nG(t){var n,e,i;if(42!==(i=t.input.charCodeAt(t.position)))return!1;for(i=t.input.charCodeAt(++t.position),n=t.position;0!==i&&!rs(i)&&!pu(i);)i=t.input.charCodeAt(++t.position);return t.position===n&&qt(t,"name of an alias node must contain at least one character"),e=t.input.slice(n,t.position),Ja.call(t.anchorMap,e)||qt(t,'unidentified alias "'+e+'"'),t.result=t.anchorMap[e],Gi(t,!0,-1),!0}(t)?(X=!0,(null!==t.tag||null!==t.anchor)&&qt(t,"alias node should not have any properties")):function KV(t,n,e){var r,s,o,a,h,w,X,we,fe=t.kind,pe=t.result;if(rs(we=t.input.charCodeAt(t.position))||pu(we)||35===we||38===we||42===we||33===we||124===we||62===we||39===we||34===we||37===we||64===we||96===we||(63===we||45===we)&&(rs(r=t.input.charCodeAt(t.position+1))||e&&pu(r)))return!1;for(t.kind="scalar",t.result="",s=o=t.position,a=!1;0!==we;){if(58===we){if(rs(r=t.input.charCodeAt(t.position+1))||e&&pu(r))break}else if(35===we){if(rs(t.input.charCodeAt(t.position-1)))break}else{if(t.position===t.lineStart&&lg(t)||e&&pu(we))break;if(Xo(we)){if(h=t.line,w=t.lineStart,X=t.lineIndent,Gi(t,!1,-1),t.lineIndent>=n){a=!0,we=t.input.charCodeAt(t.position);continue}t.position=o,t.line=h,t.lineStart=w,t.lineIndent=X;break}}a&&(el(t,s,o,!1),mv(t,t.line-h),s=o=t.position,a=!1),Zl(we)||(o=t.position+1),we=t.input.charCodeAt(++t.position)}return el(t,s,o,!1),!!t.result||(t.kind=fe,t.result=pe,!1)}(t,Pe,1===e)&&(X=!0,null===t.tag&&(t.tag="?")),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):0===h&&(X=a&&ES(t,Be))),null===t.tag)null!==t.anchor&&(t.anchorMap[t.anchor]=t.result);else if("?"===t.tag){for(null!==t.result&&"scalar"!==t.kind&&qt(t,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+t.kind+'"'),fe=0,pe=t.implicitTypes.length;fe<pe;fe+=1)if((Ie=t.implicitTypes[fe]).resolve(t.result)){t.result=Ie.construct(t.result),t.tag=Ie.tag,null!==t.anchor&&(t.anchorMap[t.anchor]=t.result);break}}else if("!"!==t.tag){if(Ja.call(t.typeMap[t.kind||"fallback"],t.tag))Ie=t.typeMap[t.kind||"fallback"][t.tag];else for(Ie=null,fe=0,pe=(we=t.typeMap.multi[t.kind||"fallback"]).length;fe<pe;fe+=1)if(t.tag.slice(0,we[fe].tag.length)===we[fe].tag){Ie=we[fe];break}Ie||qt(t,"unknown tag !<"+t.tag+">"),null!==t.result&&Ie.kind!==t.kind&&qt(t,"unacceptable node kind for !<"+t.tag+'> tag; it should be "'+Ie.kind+'", not "'+t.kind+'"'),Ie.resolve(t.result,t.tag)?(t.result=Ie.construct(t.result,t.tag),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):qt(t,"cannot resolve a node with !<"+t.tag+"> explicit tag")}return null!==t.listener&&t.listener("close",t),null!==t.tag||null!==t.anchor||X}function iG(t){var e,i,r,o,n=t.position,s=!1;for(t.version=null,t.checkLineBreaks=t.legacy,t.tagMap=Object.create(null),t.anchorMap=Object.create(null);0!==(o=t.input.charCodeAt(t.position))&&(Gi(t,!0,-1),o=t.input.charCodeAt(t.position),!(t.lineIndent>0||37!==o));){for(s=!0,o=t.input.charCodeAt(++t.position),e=t.position;0!==o&&!rs(o);)o=t.input.charCodeAt(++t.position);for(r=[],(i=t.input.slice(e,t.position)).length<1&&qt(t,"directive name must not be less than one character in length");0!==o;){for(;Zl(o);)o=t.input.charCodeAt(++t.position);if(35===o){do{o=t.input.charCodeAt(++t.position)}while(0!==o&&!Xo(o));break}if(Xo(o))break;for(e=t.position;0!==o&&!rs(o);)o=t.input.charCodeAt(++t.position);r.push(t.input.slice(e,t.position))}0!==o&&_v(t),Ja.call(xS,i)?xS[i](t,i,r):ag(t,'unknown document directive "'+i+'"')}Gi(t,!0,-1),0===t.lineIndent&&45===t.input.charCodeAt(t.position)&&45===t.input.charCodeAt(t.position+1)&&45===t.input.charCodeAt(t.position+2)?(t.position+=3,Gi(t,!0,-1)):s&&qt(t,"directives end mark is expected"),mu(t,t.lineIndent-1,4,!1,!0),Gi(t,!0,-1),t.checkLineBreaks&&jV.test(t.input.slice(n,t.position))&&ag(t,"non-ASCII line breaks are interpreted as content"),t.documents.push(t.result),t.position===t.lineStart&&lg(t)?46===t.input.charCodeAt(t.position)&&(t.position+=3,Gi(t,!0,-1)):t.position<t.length-1&&qt(t,"end of the stream or a document separator is expected")}function TS(t,n){n=n||{},0!==(t=String(t)).length&&(10!==t.charCodeAt(t.length-1)&&13!==t.charCodeAt(t.length-1)&&(t+="\n"),65279===t.charCodeAt(0)&&(t=t.slice(1)));var e=new WV(t,n),i=t.indexOf("\0");for(-1!==i&&(e.position=i,qt(e,"null byte is not allowed in input")),e.input+="\0";32===e.input.charCodeAt(e.position);)e.lineIndent+=1,e.position+=1;for(;e.position<e.length-1;)iG(e);return e.documents}var SS_load=function sG(t,n){var e=TS(t,n);if(0!==e.length){if(1===e.length)return e[0];throw new Wr("expected a single document in the stream, but found more")}};function xv(t,n){return function(){throw new Error("Function yaml."+t+" is removed in js-yaml 4. Use yaml."+n+" instead, which is now safe by default.")}}var WS=SS_load;xv("safeLoad","load"),xv("safeLoadAll","loadAll"),xv("safeDump","dump");const KS=Object.getOwnPropertyNames(Object.prototype),iq=Object.getOwnPropertyNames(Array.prototype);let wv=(()=>{class t{constructor(){this.peerHistory=[],this.isOpen=!1}initialize(){this.initAppConfig()}initAppConfig(){var e=this;return(0,tn.Z)(function*(){try{console.log("YAML\u8aad\u307f\u8fbc\u307f...");let i=yield e.loadYaml(),r=WS(i);t.applyConfig(r)}catch(i){console.warn(i)}ze.trigger("LOAD_CONFIG",t.appConfig)})()}loadYaml(){return(0,tn.Z)(function*(){let e=document.querySelector('script[type$="yaml"]');if(!e)return console.warn("loadYaml element not found."),"";let i=e.getAttribute("src");return null==i?(console.warn("loadYaml url undefined."),e.textContent):(yield fetch(i)).text()})()}static applyConfig(e,i=t.appConfig){if(null==e)return i;let r=Object.getOwnPropertyNames(e);for(let s of r)(Array.isArray(e)||Array.isArray(i)?KS.concat(iq):KS).includes(s)?console.log(`skip invalid key (${s})`):null!=e[s]&&"object"==typeof e[s]?(null==i[s]&&(i[s]=Array.isArray(e[s])?[]:{}),t.applyConfig(e[s],i[s])):"function"!=typeof e[s]&&"function"!=typeof i[s]&&(i[s]=e[s]);return i}}return t.appConfig={webrtc:{key:""},app:{title:"",mode:""},dice:{url:"",api:1}},t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=rn({token:t,factory:t.\u0275fac}),t})();function rq(t,n){if(1&t){const e=it();Q(0,"div",12),Ae("click",function(){return Oe(e),_e(2).changeIcon()}),Et(1,"safe"),ie()}2&t&&Qe("background-image",Tt(1,2,"url("+_e(2).myPeer.image.url+")","style"))}const sq=function(t){return{"i-am-gm":t}};function oq(t,n){if(1&t){const e=it();Q(0,"div")(1,"div",3),Te(2,rq,2,5,"div",4),Q(3,"div")(4,"label",5)(5,"b",6)(6,"input",7),Ae("click",function(r){return Oe(e),_e().onGMMode(r)}),ie(),ye(7),ie()(),ot(8,"br"),Q(9,"button",8),Ae("click",function(){return Oe(e),_e().changeIcon()}),ye(10,"\u30d7\u30ec\u30a4\u30e4\u30fc\u30a2\u30a4\u30b3\u30f3\u5909\u66f4"),ie()()(),Q(11,"div"),ye(12," \u3042\u306a\u305f\u306e\u8272\u3068\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\uff1a"),Q(13,"input",9),Ae("ngModelChange",function(r){return Oe(e),_e().myPeerColor=r}),ie(),Q(14,"input",10),Ae("ngModelChange",function(r){return Oe(e),_e().myPeerName=r}),ie(),ot(15,"br"),ye(16," \u203b\u6700\u5f8c\u306b\u4f7f\u3063\u305f\u8272\u3068\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\u3092\u30d6\u30e9\u30a6\u30b6\u306b\u4fdd\u5b58\u3002"),ot(17,"br"),Q(18,"span",11),ye(19,"\u8272\u3092\u521d\u671f\u5024\u306b\u623b\u3059\u969b\u306f\u767d(255,255,255)\u3092\u9078\u629e\u3002"),ie()()()}if(2&t){const e=_e();U(2),re("ngIf",e.myPeer.image),U(2),re("ngClass",ft(8,sq,e.isGMMode||e.isGMHold)),U(2),ht("checked",e.isGMMode||e.isGMHold?"checked":""),U(1),Xe(e.isGMMode?"\u73fe\u5728GM\u30e2\u30fc\u30c9\u3067\u3059":e.isGMHold?"GM\u30e2\u30fc\u30c9\u4fdd\u7559\u4e2d":"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b"),U(6),re("ngModel",e.myPeerColor),U(1),Qe("color",e.myPeerColor),re("ngModel",e.myPeerName)}}function aq(t,n){if(1&t){const e=it();Q(0,"button",18),Ae("click",function(){return Oe(e),_e(2).copyPeerId()}),Q(1,"b",19),ye(2,"content_copy"),ie()()}2&t&&re("disabled",_e(2).isCopied)}function lq(t,n){if(1&t&&(Ke(0),Q(1,"span",13)(2,"span",14),ye(3),ie(),ot(4,"input",15),ie(),Te(5,aq,3,1,"button",16),Q(6,"span",17),ye(7),ie(),Ye()),2&t){const e=_e();U(3),Xe(e.networkService.peerContext.userId),U(1),ht("value",e.networkService.peerContext.userId),U(1),re("ngIf",e.isAbleClipboardCopy),U(1),Qe("color",e.myPeerColor),re("@fadeInOut",e.isCopied),U(1),Rn(" ",e.isCopied?"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002":"","")}}function cq(t,n){1&t&&(Q(0,"span",20),ye(1,"???"),ie())}function uq(t,n){if(1&t){const e=it();Q(0,"button",18),Ae("click",function(){return Oe(e),_e(3).copyRoomName()}),Q(1,"b",19),ye(2,"content_copy"),ie()()}2&t&&re("disabled",_e(3).isRoomNameCopied)}function dq(t,n){if(1&t&&(Ke(0),Q(1,"span",13)(2,"span",21),ye(3),ie(),ot(4,"input",22),ie(),Te(5,uq,3,1,"button",16),Q(6,"span",17),ye(7),ie(),Ye()),2&t){const e=_e(2);U(3),Ma("",e.networkService.peerContext.roomName,"/",e.networkService.peerContext.roomId,""),U(1),ht("value",e.networkService.peerContext.roomName+"/"+e.networkService.peerContext.roomId),U(1),re("ngIf",e.isAbleClipboardCopy),U(1),Qe("color",e.myPeerColor),re("@fadeInOut",e.isRoomNameCopied),U(1),Rn(" ",e.isRoomNameCopied?"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002":"","")}}function fq(t,n){if(1&t&&(Q(0,"span",13)(1,"span",21),ye(2),ie(),ot(3,"input",22),ie()),2&t){const e=_e(3);U(2),Xe(e.networkService.peerContext.password),U(1),ht("value",e.networkService.peerContext.password)}}function hq(t,n){if(1&t&&(Q(0,"div",29),ye(1),ie()),2&t){const e=_e(3);U(1),Xe(e.maskedPassword)}}function pq(t,n){if(1&t){const e=it();Q(0,"button",18),Ae("click",function(){return Oe(e),_e(3).copyPassword()}),Q(1,"b",19),ye(2,"content_copy"),ie()()}2&t&&re("disabled",_e(3).isPasswordCopied)}const gq=function(t){return{"red-eye":t}};function _q(t,n){if(1&t){const e=it();Ke(0),Q(1,"div"),ye(2," \u30d1\u30b9\u30ef\u30fc\u30c9 "),Q(3,"label",23)(4,"input",24),Ae("click",function(r){return Oe(e),_e(2).onPasswordOpen(r)}),ie(),Q(5,"b",25),ye(6),ie(),ye(7,"\uff1a "),ie(),Q(8,"div",26),Te(9,fq,4,2,"span",27),Te(10,hq,2,1,"div",28),Te(11,pq,3,1,"button",16),Q(12,"span",17),ye(13),ie()()(),Ye()}if(2&t){const e=_e(2);U(4),ht("checked",e.isPasswordOpen?"checked":""),U(1),re("ngClass",ft(10,gq,e.isPasswordOpen)),U(1),Xe(e.isPasswordOpen?"visibility":"visibility_off"),U(3),re("ngIf",e.isPasswordOpen),U(1),re("ngIf",!e.isPasswordOpen),U(1),re("ngIf",e.isAbleClipboardCopy&&e.isPasswordOpen),U(1),Qe("color",e.myPeerColor),re("@fadeInOut",e.isPasswordCopied),U(1),Rn(" ",e.isPasswordCopied?"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002":"","")}}function mq(t,n){if(1&t&&(Ke(0),ot(1,"hr"),Q(2,"div"),ye(3,"\u30eb\u30fc\u30e0\u540d\uff1a "),Q(4,"span"),Te(5,dq,8,8,"ng-container",0),ie()(),Te(6,_q,14,12,"ng-container",0),Ye()),2&t){const e=_e();U(5),re("ngIf",e.networkService.isOpen),U(1),re("ngIf",e.networkService.peerContext.password)}}function $q(t,n){1&t&&(Q(0,"div",20),ye(1,"\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u63a5\u7d9a\u72b6\u614b"),Q(2,"span",35),ye(3,"\uff08\u826f\u597d "),ie(),Q(4,"i",36),ye(5,"sentiment_very_satisfied"),ie(),Q(6,"span",35),ye(7," \uff1e "),ie(),Q(8,"i",37),ye(9,"sentiment_dissatisfied"),ie(),Q(10,"span",35),ye(11," \uff1e "),ie(),Q(12,"i",38),ye(13,"mood_bad"),ie(),Q(14,"span",35),ye(15," \uff1e "),ie(),Q(16,"i",39),ye(17,"sentiment_very_dissatisfied"),ie(),Q(18,"span",35),ye(19," \u4e0d\u826f\uff09"),ie(),ye(20,"\uff1a"),ie())}function vq(t,n){1&t&&(Q(0,"div"),ye(1,"[\u63a5\u7d9a\u4e2d]"),ie())}function bq(t,n){if(1&t&&(Q(0,"div",40),Et(1,"safe"),ie()),2&t){const e=_e().$implicit;Qe("background-image",Tt(1,2,"url("+_e().findPeerImageUrl(e.peerId)+")","style"))}}const yq=function(t){return{"is-gm-mode":t}};function Cq(t,n){if(1&t&&(Q(0,"div"),Te(1,$q,21,0,"div",30),Q(2,"div"),Te(3,vq,2,0,"div",0),Q(4,"div",31)(5,"i",32),ye(6),ie(),Q(7,"span",33),ye(8),ie(),ye(9,"["),Te(10,bq,2,5,"div",34),Q(11,"span")(12,"b"),ye(13),ie()(),ye(14,"]"),ie()()()),2&t){const e=n.$implicit,i=n.index,r=_e();U(1),re("ngIf",0==i),U(2),re("ngIf",!e.isOpen),U(1),re("ngClass",ft(12,yq,r.findPeerIsGMMode(e.peerId))),U(1),ud("material-icons health "+r.healthClass(e.session.health)),U(1),Xe(r.healthIcon(e.session.health)),U(2),Xe(r.findUserId(e.peerId)),U(2),re("ngIf",r.findPeerImageUrl(e.peerId)),U(2),Qe("color",r.findPeerColor(e.peerId)),U(1),Xe(r.findPeerName(e.peerId))}}function xq(t,n){if(1&t){const e=it();Ke(0),Q(1,"input",41),Ae("ngModelChange",function(r){return Oe(e),_e(2).targetUserId=r}),ie(),Q(2,"button",18),Ae("click",function(){return Oe(e),_e(2).connectPeer()}),ye(3,"\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a"),ie(),ot(4,"br"),Ye()}if(2&t){const e=_e(2);U(1),re("ngModel",e.targetUserId)("disabled",e.isDisableConnect),U(1),re("disabled",!e.networkService.isOpen||null==e.targetUserId||""==e.targetUserId||e.isDisableConnect)}}function wq(t,n){if(1&t){const e=it();Q(0,"button",18),Ae("click",function(){return Oe(e),_e(2).showLobby()}),ye(1,"\u30ed\u30d3\u30fc\uff08\u30eb\u30fc\u30e0\u4e00\u89a7\uff09\u3092\u8868\u793a"),ie()}if(2&t){const e=_e(2);re("disabled",!e.networkService.isOpen||e.isDisableConnect)}}function Eq(t,n){if(1&t&&(Q(0,"div"),Te(1,xq,5,3,"ng-container",0),Te(2,wq,2,1,"button",16),ie()),2&t){const e=_e();U(1),re("ngIf",!e.networkService.peerContext.isRoom),U(1),re("ngIf",e.networkService.peerIds.length<=1)}}function Tq(t,n){1&t&&(Q(0,"div",43),ye(1,"\u203b\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306f\u3001\u304a\u4e92\u3044\u306eID\u3092\u30e6\u30c9\u30ca\u30ea\u30a6\u30e0\u5916\u3067\u5171\u6709\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),ie())}function Sq(t,n){1&t&&(Q(0,"div",43),ye(1,"\u203b\u4e00\u4eba\u3067\u52d5\u4f5c\u78ba\u8a8d\u3092\u884c\u3044\u305f\u3044\u5834\u5408\u306f\u30d6\u30e9\u30a6\u30b6\u30922\u3064\u958b\u304f\u3068\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u3002"),ie())}function Iq(t,n){if(1&t&&(Ke(0),Te(1,Tq,2,0,"div",42),Te(2,Sq,2,0,"div",42),Ye()),2&t){const e=_e(2);U(1),re("ngIf",e.networkService.peerContexts.length<1),U(1),re("ngIf",e.networkService.peerContexts.length<1)}}function kq(t,n){1&t&&(Ke(0),Q(1,"div",43),ye(2,"\u203b\u30eb\u30fc\u30e0\u6a5f\u80fd\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u6642\u306f\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002"),ie(),Ye())}function Mq(t,n){if(1&t&&(Ke(0),Te(1,Iq,3,2,"ng-container",0),Te(2,kq,3,0,"ng-container",0),Ye()),2&t){const e=_e();U(1),re("ngIf",!e.networkService.peerContext.isRoom),U(1),re("ngIf",e.networkService.peerContext.isRoom)}}function Dq(t,n){1&t&&(Ke(0),Q(1,"div",43),ye(2,"\u203bGM\u30e2\u30fc\u30c9\u4e2d\uff08\u4fdd\u7559\u4e2d\u542b\u3080\uff09\u306f\u81ea\u5206\u304b\u3089\u63a5\u7d9a\u3092\u884c\u3048\u307e\u305b\u3093\u3002"),ie(),Ye())}let Ev=(()=>{class t{constructor(e,i,r,s){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.appConfigService=s,this.targetUserId="",this.networkService=xt,this.gameRoomService=dt.instance,this.isCopied=!1,this.isRoomNameCopied=!1,this.isPasswordCopied=!1,this.isPasswordOpen=!1,this.help=""}get myPeer(){return We.myCursor}get myPeerName(){return We.myCursor?We.myCursor.name:null}set myPeerName(e){window.localStorage&&localStorage.setItem(We.CHAT_MY_NAME_LOCAL_STORAGE_KEY,e),We.myCursor&&(We.myCursor.name=e)}get myPeerColor(){return We.myCursor?We.myCursor.color:We.CHAT_DEFAULT_COLOR}set myPeerColor(e){We.myCursor&&(We.myCursor.color=e==We.CHAT_TRANSPARENT_COLOR?We.CHAT_DEFAULT_COLOR:e),window.localStorage&&localStorage.setItem(We.CHAT_MY_COLOR_LOCAL_STORAGE_KEY,We.myCursor.color)}get isGMMode(){return!!We.myCursor&&We.myCursor.isGMMode}set isGMMode(e){We.myCursor&&(We.myCursor.isGMMode=e)}get isGMHold(){return We.isGMHold}get isDisableConnect(){return this.isGMHold||this.isGMMode}get maskedPassword(){return"\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf"}ngOnInit(){Promise.resolve().then(()=>{this.panelService.title="\u63a5\u7d9a\u60c5\u5831",this.panelService.isAbleFullScreenButton=!1})}ngOnDestroy(){clearTimeout(this._timeOutId),clearTimeout(this._timeOutId2),clearTimeout(this._timeOutId3),ze.unregister(this)}changeIcon(){let e=[];this.myPeer&&this.myPeer.imageIdentifier&&(e=[this.myPeer.imageIdentifier]),this.modalService.open(Ko,{currentImageIdentifires:e}).then(i=>{!this.myPeer||!i||(this.myPeer.imageIdentifier=i)})}connectPeer(){let e=this.targetUserId;if(this.targetUserId="",e.length<1)return;let i=vi.create(e);i.isRoom||(dt.instance.clearDeleteHistory(),xt.connect(i.peerId),(We.isGMHold||this.isGMMode)&&(We.isGMHold=!1,this.isGMMode=!1,this.isGMMode&&(this.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664"),ze.trigger("CHANGE_GM_MODE",null))))}showLobby(){(We.isGMHold||this.isGMMode)&&(We.isGMHold=!1,this.isGMMode=!1,this.isGMMode&&(this.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664"),ze.trigger("CHANGE_GM_MODE",null))),this.modalService.open(BU,{width:700,height:400,left:0,top:400})}findUserId(e){const i=We.findByPeerId(e);return i?i.userId:""}findPeerName(e){const i=We.findByPeerId(e);return i?i.name:""}findPeerColor(e){const i=We.findByPeerId(e);return i?i.color:""}findPeerImageUrl(e){const i=We.findByPeerId(e);return i?i.image.url:""}findPeerIsGMMode(e){const i=We.findByPeerId(e);return!!i&&i.isGMMode}copyPeerId(){navigator.clipboard&&(navigator.clipboard.writeText(this.networkService.peerContext.userId),this.isCopied=!0,clearTimeout(this._timeOutId),this._timeOutId=setTimeout(()=>{this.isCopied=!1},1e3))}copyRoomName(){navigator.clipboard&&(navigator.clipboard.writeText(this.networkService.peerContext.roomName+"/"+this.networkService.peerContext.roomId),this.isRoomNameCopied=!0,clearTimeout(this._timeOutId2),this._timeOutId2=setTimeout(()=>{this.isRoomNameCopied=!1},1e3))}copyPassword(){navigator.clipboard&&(navigator.clipboard.writeText(this.networkService.peerContext.password),this.isPasswordCopied=!0,clearTimeout(this._timeOutId3),this._timeOutId2=setTimeout(()=>{this.isPasswordCopied=!1},1e3),this.isPasswordOpen=!1)}isAbleClipboardCopy(){return!!navigator.clipboard}onPasswordOpen(e){this.isPasswordOpen?this.isPasswordOpen=!1:(e.preventDefault(),this.modalService.open(er,{title:"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u8868\u793a",text:"\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",type:Si.OK_CANCEL,materialIcon:"visibility",action:()=>{this.isPasswordOpen=!0,e.target.checked=!0}}))}onGMMode(e){We.isGMHold||this.isGMMode?this.isGMMode?(e.preventDefault(),this.modalService.open(er,{title:"GM\u30e2\u30fc\u30c9\u89e3\u9664",text:"GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664\u3057\u307e\u3059\u304b\uff1f",type:Si.OK_CANCEL,materialIcon:"person_remove",action:()=>{We.isGMHold=!1,this.isGMMode=!1,e.target.checked=!1,this.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664"),ze.trigger("CHANGE_GM_MODE",null),Gt.isStealthMode&&this.modalService.open(er,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:Si.OK,materialIcon:"disabled_visible"})}})):(We.isGMHold=!1,this.isGMMode=!1):(e.preventDefault(),this.modalService.open(er,{title:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b",text:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u304b\uff1f\nGM\u30e2\u30fc\u30c9\u4e2d\uff08\u4fdd\u7559\u4e2d\u542b\u3080\uff09\u306f\u3042\u306a\u305f\u304b\u3089\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3001\u30eb\u30fc\u30e0\u3078\u306e\u63a5\u7d9a\u306f\u884c\u3048\u307e\u305b\u3093\u3002",helpHtml:"GM\u30e2\u30fc\u30c9\u3067\u306f\u3001<b>\u79d8\u8a71</b>\u3001\u88cf\u5411\u304d\u306e<b>\u30ab\u30fc\u30c9</b>\u3001\u516c\u958b\u3055\u308c\u3066\u3044\u306a\u3044<b>\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb</b>\u3001<b>\u30ad\u30e3\u30e9\u30af\u30bf\u30fc</b>\u4f4d\u7f6e\u3001<b>\u30ab\u30fc\u30bd\u30eb</b>\u4f4d\u7f6e\u3092\u3059\u3079\u3066\u898b\u308b\u3053\u3068\u304c\u3067\u304d\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u3089\u306a\u304f\u306a\u308a\u307e\u3059\u3002\n\n<b><big>\u2014With great power comes great responsibility.</big></b>",type:Si.OK_CANCEL,materialIcon:"person_add",action:()=>{We.isGMHold=!0,this.isGMMode=!1,e.target.checked=!0,this.modalService.open(er,{title:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b",text:"\u307e\u3060GM\u30e2\u30fc\u30c9\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002",helpHtml:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b\u306b\u306f\u3001\u30c1\u30e3\u30c3\u30c8\u304b\u3089 <b>GM\u306b\u306a\u308b</b> \u307e\u305f\u306f <b>GM\u306b\u306a\u308a\u307e\u3059</b> \u3092\u542b\u3080\u6587\u3092\u9001\u4fe1\u3057\u307e\u3059\u3002",type:Si.OK,materialIcon:"person_add"})}}))}healthIcon(e){return e>=.99?"sentiment_very_satisfied":e>.97?"sentiment_dissatisfied":e>.95?"mood_bad":"sentiment_very_dissatisfied"}healthClass(e){return e>=.99?"health-blue":e>.97?"health-green":e>.95?"health-yellow":"health-red"}}return t.\u0275fac=function(e){return new(e||t)(He(Fn),He(An),He(kr),He(wv))},t.\u0275cmp=Xt({type:t,selectors:[["peer-menu"]],decls:13,vars:8,consts:[[4,"ngIf"],["style","font-weight: bold;",4,"ngIf"],[4,"ngFor","ngForOf"],[2,"display","flex","align-items","flex-end","margin-bottom","4px"],["class","image cover","style","cursor: pointer",3,"background-image","click",4,"ngIf"],[2,"display","inline-block","margin-bottom","2px",3,"ngClass"],[2,"font-size","smaller"],["type","checkbox","name","i-am-gamemaster","value","I'm Gamemaster",3,"checked","click"],[3,"click"],["type","color",2,"width","1em","margin-right","0.5em",3,"ngModel","ngModelChange"],["placeholder","\u30cb\u30c3\u30af\u30cd\u30fc\u30e0",2,"font-weight","bolder",3,"ngModel","ngModelChange"],[2,"font-size","smaller","margin-left","1em"],[1,"image","cover",2,"cursor","pointer",3,"click"],[1,"id-input-container"],[1,"id-spacer"],["type","text","readonly","",1,"id-input",3,"value"],[3,"disabled","click",4,"ngIf"],[1,"copied"],[3,"disabled","click"],[1,"material-icons",2,"font-size","1em","vertical-align","bottom"],[2,"font-weight","bold"],[1,"id-spacer","room-data"],["type","text","readonly","",1,"id-input","room-data",3,"value"],["sytle","white-space: nowrap"],["name","show-hide-password","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[2,"display","inline"],["class","id-input-container",4,"ngIf"],["style","display: inline","class","masked-password","draggable","false",4,"ngIf"],["draggable","false",1,"masked-password",2,"display","inline"],["style","font-weight: bold",4,"ngIf"],[3,"ngClass"],[2,"margin-right","2px"],[2,"margin-right","3px"],["class","cover mini-icon",3,"background-image",4,"ngIf"],[1,"health"],[1,"material-icons","health","health-blue"],[1,"material-icons","health","health-green"],[1,"material-icons","health","health-yellow"],[1,"material-icons","health","health-red"],[1,"cover","mini-icon"],["placeholder","\u63a5\u7d9a\u3057\u305f\u3044\u76f8\u624b\u306eID","name","targetUserId",3,"ngModel","disabled","ngModelChange"],["style","font-size: 12px",4,"ngIf"],[2,"font-size","12px"]],template:function(e,i){1&e&&(Te(0,oq,20,10,"div",0),Q(1,"div")(2,"div"),ye(3,"\u3042\u306a\u305f\u306eID\uff1a "),Q(4,"span"),Te(5,lq,8,7,"ng-container",0),ie(),Te(6,cq,2,0,"span",1),ie()(),Te(7,mq,7,2,"ng-container",0),ot(8,"hr"),Te(9,Cq,15,14,"div",2),Te(10,Eq,3,2,"div",0),Te(11,Mq,3,2,"ng-container",0),Te(12,Dq,3,0,"ng-container",0)),2&e&&(re("ngIf",i.myPeer),U(5),re("ngIf",i.networkService.isOpen),U(1),re("ngIf",!i.networkService.isOpen),U(1),re("ngIf",i.networkService.peerContext.isRoom),U(2),re("ngForOf",i.networkService.peerContexts),U(1),re("ngIf",!i.isGMMode&&!i.isGMHold),U(1),re("ngIf",!i.isGMMode&&!i.isGMHold),U(1),re("ngIf",i.isGMMode||i.isGMHold))},directives:[bn,Yn,mi,$i,di,oi],pipes:[ai],styles:['[_nghost-%COMP%]{display:block}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:table-cell;vertical-align:top;border-radius:.6rem}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto;height:auto;max-width:100%;max-height:100%;vertical-align:bottom}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}.id-input-container[_ngcontent-%COMP%]{display:inline-block;position:relative}.id-spacer[_ngcontent-%COMP%]{visibility:hidden;display:inline-block;pointer-events:none;padding:0 3px;box-sizing:border-box;border-color:transparent;border-radius:3px;border-width:2px;border-style:solid;font-family:Cambria,Georgia;font-size:larger;font-weight:bolder}.id-input[_ngcontent-%COMP%]{top:0;left:-4px;width:100%;position:absolute;background:none;border:none;outline:none;color:#444;font-family:Cambria,Georgia;font-size:larger;padding:2px;box-sizing:border-box;border-color:transparent;border-radius:3px;border-width:2px;border-style:solid;font-weight:bolder}.room-data[_ngcontent-%COMP%]{font-size:medium}.masked-password[_ngcontent-%COMP%]{font-weight:bolder;color:#444;font-family:Cambria,Georgia;-webkit-user-select:none;-moz-user-select:none;user-select:none;display:inline-block}.id-input[_ngcontent-%COMP%]:active, .id-input[_ngcontent-%COMP%]:hover{border-color:#444}.copied[_ngcontent-%COMP%]{font-size:smaller;opacity:0;white-space:nowrap}.health[_ngcontent-%COMP%]{font-size:14px;font-weight:400}.health-blue[_ngcontent-%COMP%]{color:#00f;filter:drop-shadow(0px 0px 2px skyblue)}.health-green[_ngcontent-%COMP%]{color:green;filter:drop-shadow(0px 0px 1px greenyellow)}.health-yellow[_ngcontent-%COMP%]{color:#757532;filter:drop-shadow(0px 0px 1px yellow)}.health-red[_ngcontent-%COMP%]{color:#8b0000;filter:drop-shadow(0px 0px 2px red)}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}.mini-icon[_ngcontent-%COMP%]{display:inline-block;padding:0;width:16px;height:16px;vertical-align:middle;border-radius:.2rem;margin-right:2px}.is-gm-mode[_ngcontent-%COMP%]:after{content:"\\3010GM\\3011";color:red}.i-am-gm[_ngcontent-%COMP%]{color:red;text-shadow:1px 1px 0px #eee,-1px 1px 0px #eee,1px -1px 0px #eee,-1px -1px 0px #eee,1px 0px 0px #eee,0px 1px 0px #eee,-1px 0px 0px #eee,0px -1px 0px #eee,0px 0px 2px crimson}'],data:{animation:[Sn("fadeInOut",[Lt("false => true",[Rt("50ms ease-in-out",et({opacity:1})),Rt("900ms ease-in-out",et({opacity:0}))])])]}}),t})(),dg=(()=>{class t{constructor(e){this.ngZone=e,this.batchTask=new Map,this.batchTaskTimer=null,this.needsChangeDetection=!1}add(e,i={}){this.batchTask.set(i,e),this.startTimer()}remove(e={}){this.batchTask.delete(e)}requireChangeDetection(){this.needsChangeDetection=!0,this.startTimer()}startTimer(){null==this.batchTaskTimer&&this.ngZone.runOutsideAngular(()=>{Sr(()=>this.execBatch()),this.batchTaskTimer=setInterval(()=>{0<this.batchTask.size?this.execBatch():(clearInterval(this.batchTaskTimer),this.batchTaskTimer=null)},66)})}execBatch(){this.batchTask.forEach(e=>e()),this.batchTask.clear(),this.needsChangeDetection&&(this.needsChangeDetection=!1,this.ngZone.run(()=>{}))}}return t.\u0275fac=function(e){return new(e||t)(an(Cn))},t.\u0275prov=rn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Aq=["textArea"];function Pq(t,n){1&t&&(ot(0,"img",27),Et(1,"safe")),2&t&&re("src",Tt(1,1,_e(2).imageFile.url,"resourceUrl"),en)}function Nq(t,n){if(1&t&&(Q(0,"div",25),Te(1,Pq,2,4,"img",26),ie()),2&t){const e=_e();U(1),re("ngIf",0<e.imageFile.url.length)}}function Fq(t,n){if(1&t&&(Q(0,"div",25),ot(1,"img",27),Et(2,"safe"),ie()),2&t){const e=_e(2);U(1),re("src",Tt(2,1,null==e.character.faceIcon?null:e.character.faceIcon.url,"resourceUrl"),en)}}const Oq=function(t,n){return{inverse:t,hollow:n}},Rq=function(t,n,e,i,r,s,o,a){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:s,yellow:o,white:a}},Bq=function(t){return{"black-paint":t}};function Lq(t,n){if(1&t&&(Q(0,"div",30)(1,"span",31),ot(2,"img",32),Et(3,"safe"),ie()()),2&t){const e=_e(3);re("ngClass",Yt(7,Oq,e.character.isInverse,e.character.isHollow)),U(1),re("ngClass",uo(10,Rq,0==e.character.aura,1==e.character.aura,2==e.character.aura,3==e.character.aura,4==e.character.aura,5==e.character.aura,6==e.character.aura,7==e.character.aura)),U(1),re("src",Tt(3,4,e.character.imageFile.url,"resourceUrl"),en)("ngClass",ft(19,Bq,e.character.isBlackPaint))}}function zq(t,n){if(1&t&&Te(0,Lq,4,21,"div",29),2&t){const e=_e(2);re("ngIf",e.character&&null!=e.character.imageFile&&0<e.character.imageFile.url.length)}}function jq(t,n){if(1&t&&(Te(0,Fq,3,4,"div",2),Te(1,zq,1,1,"ng-template",null,28,Un)),2&t){const e=Kt(2),i=_e();re("ngIf",i.isUseFaceIcon&&i.character&&null!=i.character.faceIcon&&0<(null==i.character.faceIcon||null==i.character.faceIcon.url?null:i.character.faceIcon.url.length))("ngIfElse",e)}}function Hq(t,n){if(1&t){const e=it();Q(0,"input",33),Ae("ngModelChange",function(r){return Oe(e),_e().isUseFaceIcon=r})("change",function(){Oe(e);const r=_e();return r.isUseFaceIcon=!!r.isUseFaceIcon}),ie()}if(2&t){const e=_e();ht("checked",e.isUseFaceIcon?"checked":""),re("ngModel",e.isUseFaceIcon)}}function Uq(t,n){1&t&&(Q(0,"b",34),ye(1,"\u9854IC"),ie())}function Vq(t,n){if(1&t&&(Q(0,"option",35),ye(1),ie()),2&t){const e=_e();Qe("color",e.myColor),ht("value",null==e.myPeer?null:e.myPeer.identifier),U(1),Rn("",null==e.myPeer?null:e.myPeer.name,"\uff08\u3042\u306a\u305f\uff09")}}function Gq(t,n){if(1&t&&(Q(0,"option",36),ye(1),ie()),2&t){const e=n.$implicit;Qe("color",e.chatPalette&&e.chatPalette.color&&"#ffffff"!=e.chatPalette.color?e.chatPalette.color:"#444"),ht("value",e.identifier),U(1),Xe(e.name)}}function qq(t,n){1&t&&(Ke(0),ye(1,"\uff08\u3042\u306a\u305f\uff09"),Ye())}function Wq(t,n){if(1&t&&(Q(0,"option",35),ye(1),Te(2,qq,2,0,"ng-container",24),ie()),2&t){const e=n.$implicit,i=_e();Qe("color",e.color),ht("value",e.identifier),U(1),Rn("",e.name," "),U(1),re("ngIf",e===i.myPeer)}}function Kq(t,n){if(1&t&&(Q(0,"option",42),ye(1),ie()),2&t){const e=n.$implicit;ht("value",e.script),U(1),Xe(e.game)}}function Yq(t,n){if(1&t&&(Q(0,"optgroup",40),Te(1,Kq,2,2,"option",41),ie()),2&t){const e=n.$implicit;ht("label",e.index),U(1),re("ngForOf",e.infos)}}const _f=function(){return{standalone:!0}},fg=function(t){return{"not-specified":t}};function Zq(t,n){if(1&t){const e=it();Q(0,"select",37),Ae("change",function(r){return Oe(e),_e().loadDiceBot(r.target.value)})("ngModelChange",function(r){return Oe(e),_e().gameType=r}),Q(1,"option",38),ye(2,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u6307\u5b9a\u306a\u3057"),ie(),Te(3,Yq,2,2,"optgroup",39),ie()}if(2&t){const e=_e();re("ngModel",e.gameType)("ngModelOptions",sa(4,_f))("ngClass",ft(5,fg,"DiceBot"==e.gameType||""==e.gameType)),U(3),re("ngForOf",e.diceBotInfosIndexed)}}function Xq(t,n){if(1&t){const e=it();Q(0,"select",43),Ae("change",function(r){return Oe(e),_e().loadDiceBot(r.target.value)})("ngModelChange",function(r){return Oe(e),_e().gameType=r}),Q(1,"option",38),ye(2,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8aad\u8fbc\u4e2d\u2026"),ie()()}if(2&t){const e=_e();re("ngModel",e.gameType)("ngModelOptions",sa(3,_f))("ngClass",ft(4,fg,"DiceBot"==e.gameType||""==e.gameType))}}function Qq(t,n){if(1&t&&(Q(0,"option",42),ye(1),ie()),2&t){const e=n.$implicit;ht("value",e),U(1),Xe(e)}}const Jq=function(t){return{"disabled-stand":t}};function eW(t,n){if(1&t){const e=it();Q(0,"div",44)(1,"label",45)(2,"input",33),Ae("ngModelChange",function(r){return Oe(e),_e().isUseStandImage=r})("change",function(){Oe(e);const r=_e();return r.isUseStandImage=!!r.isUseStandImage}),ie(),Q(3,"b",34),ye(4,"Stand: "),ie()(),Q(5,"select",46),Ae("change",function(){return Oe(e),_e().isUseStandImage=!0})("ngModelChange",function(r){return Oe(e),_e().standName=r}),Q(6,"option",13),ye(7,"\u672a\u9078\u629e"),ie(),Te(8,Qq,2,2,"option",41),ie(),Q(9,"span",47)(10,"b",34),ye(11,"Pos: "),ie(),Q(12,"input",48),Ae("change",function(){return Oe(e),_e().isUseStandImage=!0})("ngModelChange",function(r){return Oe(e),_e().character.standList.position=r}),ie(),Q(13,"input",49),Ae("change",function(){return Oe(e),_e().isUseStandImage=!0})("ngModelChange",function(r){return Oe(e),_e().character.standList.position=r}),ie(),Q(14,"b",34),ye(15,"\uff05"),ie()(),Q(16,"button",50),Ae("click",function(){return Oe(e),_e().farewellStand()}),ye(17,"\u9000\u53bb"),ie()()}if(2&t){const e=_e();re("ngClass",ft(14,Jq,!e.isUseStandImageOnChatTab)),U(2),ht("checked",e.isUseStandImage?"checked":""),re("ngModel",e.isUseStandImage),Bt("disabled",e.isUseStandImageOnChatTab?null:""),U(3),re("ngModel",e.standName)("ngModelOptions",sa(16,_f))("ngClass",ft(17,fg,""==e.standName)),Bt("disabled",e.isUseStandImageOnChatTab?null:""),U(3),re("ngForOf",e.standNameList),U(4),re("ngModel",e.character.standList.position),Bt("disabled",e.isUseStandImageOnChatTab?null:""),U(1),re("ngModel",e.character.standList.position),Bt("disabled",e.isUseStandImageOnChatTab?null:""),U(3),Bt("disabled",e.isUseStandImageOnChatTab?null:"")}}function tW(t,n){if(1&t){const e=it();Q(0,"input",51),Ae("ngModelChange",function(r){return Oe(e),_e().paletteColor=r}),ie()}2&t&&re("ngModel",_e().paletteColor)("ngModelOptions",sa(2,_f))}function nW(t,n){1&t&&(Q(0,"div",58),Et(1,"safe"),ie()),2&t&&Qe("background-image",Tt(1,2,"url("+_e().$implicit.imageUrl+")","style"))}function iW(t,n){1&t&&(Q(0,"span",59),ye(1,", "),ie())}function rW(t,n){if(1&t&&(Q(0,"div",53),Te(1,nW,2,5,"div",54),Q(2,"div",55),Et(3,"safe"),Q(4,"span",56),ye(5),ie(),Te(6,iW,2,0,"span",57),ie()()),2&t){const e=n.$implicit,i=n.index,r=_e(2);U(1),re("ngIf",e.imageUrl),U(1),Qe("color",Tt(3,5,e.color,"style")),U(3),Xe(e.name),U(1),re("ngIf",r.writingPeerNameAndColors.length!==i+1)}}function sW(t,n){if(1&t&&(Ke(0),Te(1,rW,7,8,"div",52),ye(2," \u304c\u5165\u529b\u4e2d... "),Ye()),2&t){const e=_e();U(1),re("ngForOf",e.writingPeerNameAndColors)}}const oW=function(t){return{"direct-message":t}},YS=function(t,n){return{color:t,"font-weight":n}};class nr{constructor(n,e,i,r,s,o){this.ngZone=n,this.chatMessageService=e,this.batchService=i,this.panelService=r,this.pointerDeviceService=s,this.contextMenuService=o,this.onlyCharacters=!1,this.chatTabidentifier="",this._gameType="",this.gameTypeChange=new Tn,this._sendFrom=this.myPeer?this.myPeer.identifier:"",this.sendFromChange=new Tn,this._sendTo="",this.sendToChange=new Tn,this._text="",this.textChange=new Tn,this.chat=new Tn,this.gameHelp="",this.isUseFaceIcon=!0,this.isUseStandImage=!0,this.currentHistoryIndex=-1,this.standName="",this.shouldUpdateCharacterList=!0,this._gameCharacters=[],this.writingEventInterval=null,this.previousWritingLength=0,this.writingPeers=new Map,this.writingPeerNameAndColors=[]}get isUseStandImageOnChatTab(){const n=dt.instance.get(this.chatTabidentifier);return n&&n.isUseStandImage}get gameType(){return this._gameType}set gameType(n){this._gameType=n,this.gameTypeChange.emit(n)}get sendFrom(){return this._sendFrom}set sendFrom(n){this._sendFrom=n,this.sendFromChange.emit(n)}get sendTo(){return this._sendTo}set sendTo(n){this._sendTo=n,this.sendToChange.emit(n)}get text(){return this._text}set text(n){this._text=n,this.textChange.emit(n)}get isDirect(){return!(null==this.sendTo||!this.sendTo.length)}get character(){let n=dt.instance.get(this.sendFrom);return n instanceof Gt?n:null}get hasStand(){return!(!this.character||!this.character.standList)&&this.character.standList.standElements.length>0}get standNameList(){if(!this.hasStand)return[];let n=[];for(let e of this.character.standList.standElements){let i=e.getFirstElementByName("name");i&&i.value&&n.indexOf(i.value.toString())<0&&n.push(i.value.toString())}return n.sort()}get standListNoGroup(){return[]}get standListWithGroup(){if(!this.hasStand)return[];let n={};const e=this.character.standList.standElements.map(i=>i.getFirstElementByName("name")).filter(i=>i);e.sort((i,r)=>i.currentValue===r.currentValue?0:i.currentValue>r.currentValue?-1:1);for(const i of e)if(i&&i.value){const r=i.currentValue&&i.currentValue.toString().length>0?i.currentValue.toString():"";r&&(n[r]||(n[r]=[]),n[r].indexOf(i.value.toString())<0&&n[r].push(i.value.toString()))}return Object.keys(n).sort().map(i=>({name:i,stands:n[i].sort()})).filter(i=>i.stands.length>0)}get imageFile(){let n=dt.instance.get(this.sendFrom),e=null;return n instanceof Gt?e=n.imageFile:n instanceof We&&(e=n.image),e||Ut.Empty}get paletteColor(){return this.character&&this.character.chatPalette&&this.character.chatPalette.paletteColor?this.character.chatPalette.paletteColor:We.CHAT_TRANSPARENT_COLOR}set paletteColor(n){this.character.chatPalette.color=n||We.CHAT_TRANSPARENT_COLOR}get myColor(){return We.myCursor&&We.myCursor.color&&We.myCursor.color!=We.CHAT_TRANSPARENT_COLOR?We.myCursor.color:We.CHAT_DEFAULT_COLOR}get color(){return this.paletteColor&&this.paletteColor!=We.CHAT_TRANSPARENT_COLOR?this.paletteColor:this.myColor}get sendToColor(){let n=dt.instance.get(this.sendTo);return n instanceof We?n.color:We.CHAT_DEFAULT_COLOR}get gameCharacters(){return this.shouldUpdateCharacterList&&(this.shouldUpdateCharacterList=!1,this._gameCharacters=dt.instance.getObjects(Gt).filter(n=>this.allowsChat(n))),this._gameCharacters}get diceBotInfos(){return Gn.diceBotInfos}get myPeer(){return We.myCursor}get otherPeers(){return dt.instance.getObjects(We)}get diceBotInfosIndexed(){return Gn.diceBotInfosIndexed}ngOnInit(){ze.register(this).on("MESSAGE_ADDED",n=>{if(n.data.tabIdentifier!==this.chatTabidentifier)return;let e=dt.instance.get(n.data.messageIdentifier),i=dt.instance.getObjects(We).find(s=>s.userId===e.from),r=i?i.peerId:"?";this.writingPeers.has(r)&&(this.writingPeers.get(r).stop(),this.writingPeers.delete(r),this.updateWritingPeerNameAndColors())}).on("UPDATE_GAME_OBJECT",n=>{if(n.data.aliasName!==Gt.aliasName||(this.shouldUpdateCharacterList=!0,n.data.identifier!==this.sendFrom))return;let e=dt.instance.get(n.data.identifier);e&&!this.allowsChat(e)&&(this.sendFrom=0<this.gameCharacters.length&&this.onlyCharacters?this.gameCharacters[0].identifier:this.myPeer.identifier)}).on("DISCONNECT_PEER",n=>{let e=dt.instance.get(this.sendTo);e instanceof We&&e.peerId===n.data.peerId&&(this.sendTo="")}).on("WRITING_A_MESSAGE",n=>{n.isSendFromSelf||n.data!==this.chatTabidentifier||(this.writingPeers.has(n.sendFrom)||this.writingPeers.set(n.sendFrom,new ha(()=>{this.writingPeers.delete(n.sendFrom),this.updateWritingPeerNameAndColors(),this.ngZone.run(()=>{})},2e3)),this.writingPeers.get(n.sendFrom).reset(),this.updateWritingPeerNameAndColors(),this.batchService.requireChangeDetection())})}ngOnDestroy(){ze.unregister(this),this.batchService.remove(this)}updateWritingPeerNameAndColors(){this.writingPeerNameAndColors=Array.from(this.writingPeers.keys()).map(n=>{let e=We.findByPeerId(n);return{name:e?e.name:"",color:e?e.color:We.CHAT_TRANSPARENT_COLOR,imageUrl:e?e.image.url:""}})}onInput(){if(null===this.writingEventInterval&&this.previousWritingLength<=this.text.length){let n=null;if(this.isDirect){let e=dt.instance.get(this.sendTo);if(e instanceof We){let i=vi.parse(e.peerId);i&&(n=i.peerId)}}ze.call("WRITING_A_MESSAGE",this.chatTabidentifier,n),this.writingEventInterval=setTimeout(()=>{this.writingEventInterval=null},200)}this.previousWritingLength=this.text.length,this.calcFitHeight()}moveHistory(n,e){if(n&&n.preventDefault(),this.currentHistoryIndex<0&&(this.tmpText=this.text),e<0&&this.currentHistoryIndex<0)this.currentHistoryIndex=-1;else{if(e>0&&this.currentHistoryIndex>=nr.history.length-1)return void(this.currentHistoryIndex=nr.history.length-1);this.currentHistoryIndex=this.currentHistoryIndex+e}let i;this.currentHistoryIndex<0?(this.currentHistoryIndex=-1,i=this.tmpText&&this.tmpText.length?this.tmpText:""):i=nr.history[this.currentHistoryIndex],this.text=i,this.previousWritingLength=this.text.length,this.textAreaElementRef.nativeElement.value=i,this.calcFitHeight()}sendChat(n){if(n&&n.preventDefault(),n&&13!==n.keyCode)return;this.sendFrom.length||(this.sendFrom=this.myPeer.identifier);let e=this.text,i="",r=null;if(this.character&&(rt.cr(e).trim()||this.standName)&&(e=this.character.chatPalette.evaluate(this.text,this.character.rootDataElement),this.character.standList)){let a=null;a=this.isUseFaceIcon&&this.character.faceIcon?this.character.faceIcon.identifier:this.character.imageFile?this.character.imageFile.identifier:null;const h=this.character.standList.matchStandInfo(e,a,this.standName);if(this.isUseStandImage&&this.isUseStandImageOnChatTab)if(h.farewell)this.farewellStand();else if(h.standElementIdentifier){r=h.standElementIdentifier;const w={characterIdentifier:this.character.identifier,standIdentifier:h.standElementIdentifier,color:this.character.chatPalette?this.character.chatPalette.color:We.CHAT_DEFAULT_COLOR,secret:!!this.sendTo};if(w.secret){const X=dt.instance.get(this.sendTo);X&&(X.peerId!=We.myCursor.peerId&&ze.call("POPUP_STAND_IMAGE",w,X.peerId),ze.call("POPUP_STAND_IMAGE",w,We.myCursor.peerId))}else ze.call("POPUP_STAND_IMAGE",w)}i=h.matchMostLongText}const s=_o.instance.matchCutInInfo(e);if(this.isUseStandImageOnChatTab&&s){for(const a of s.identifiers){const h={identifier:a,secret:!!this.sendTo,sender:We.myCursor.peerId};if(h.secret){const w=dt.instance.get(this.sendTo);w&&(w.peerId!=We.myCursor.peerId&&ze.call("PLAY_CUT_IN",h,w.peerId),ze.call("PLAY_CUT_IN",h,We.myCursor.peerId))}else ze.call("PLAY_CUT_IN",h)}if(s.names&&s.names.length&&!this.sendTo){const a=new Map;for(const w of s.names){let X=a.get(w)||0;X+=1,a.set(""==w?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":w,X)}const h=`${[...a.keys()].map(w=>a.get(w)>1?`${w}\xd7${a.get(w)}`:w).join("\u3001")}`;this.chatMessageService.sendOperationLog(h+" \u304c\u8d77\u52d5\u3057\u305f")}}if(i.length<s.matchMostLongText.length&&(i=s.matchMostLongText),e=e.slice(0,e.length-i.length),this.isUseStandImageOnChatTab&&this.character&&rt.cr(e).trim()){const a=/^((srepeat|repeat|srep|rep|sx|x)?(\d+)?[ \u3000]+)?([^\n]*)?/gi.exec(e);let w,h=null!=a[4]?a[4].trim():e.trim();/^(S?CHOICE\d*)[ \u3000]+([^ \u3000]*)/gi.test(h)?h="":((w=/^(S?CHOICE\d*\[[^\[\]]+\])/gi.exec(h))||(w=/^(S?CHOICE\d*\([^\(\)]+\))/gi.exec(h)))&&(h=h.slice(w[1].length));const X=/\u300c+([\s\S]+?)\u300d/gm;let fe,pe=[];for(;null!==(fe=X.exec(h));)pe.push(fe[1]);if(0===pe.length){const we=h.split(/[\s\u3000]/).slice(-1)[0];rt.isEmote(we)&&pe.push(we)}if(pe.length>0){const we={characterIdentifier:this.character.identifier,text:pe.join("\n\n"),faceIconIdentifier:this.isUseFaceIcon&&this.character.faceIcon?this.character.faceIcon.identifier:null,color:this.color,secret:!!this.sendTo};if(we.secret){const Ie=dt.instance.get(this.sendTo);Ie&&(Ie.peerId!=We.myCursor.peerId&&ze.call("POPUP_CHAT_BALLOON",we,Ie.peerId),ze.call("POPUP_CHAT_BALLOON",we,We.myCursor.peerId))}else ze.call("POPUP_CHAT_BALLOON",we)}else rt.cr(e).trim()&&this.character.text&&ze.call("FAREWELL_CHAT_BALLOON",{characterIdentifier:this.character.identifier})}We.isGMHold&&!this.sendTo&&!We.myCursor.isGMMode&&/GM(?:\u30e2\u30fc\u30c9)?\u306b\u306a(?:\u308a\u307e\u3059|\u308b)/i.test(rt.toHalfWidth(e))&&(We.myCursor.isGMMode=!0,this.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u306b\u306a\u3063\u305f"),ze.trigger("CHANGE_GM_MODE",null)),rt.cr(e).trim()&&(nr.history=nr.history.filter(a=>a!==this.text),nr.history.unshift(this.text),nr.history.length>=nr.MAX_HISTORY_NUM&&nr.history.pop(),this.currentHistoryIndex=-1,this.tmpText=null,this.chat.emit({text:e,gameType:this.gameType,sendFrom:this.sendFrom,sendTo:this.sendTo,color:this.color,isInverse:!!this.character&&this.character.isInverse,isHollow:!!this.character&&this.character.isHollow,isBlackPaint:!!this.character&&this.character.isBlackPaint,aura:this.character?this.character.aura:-1,isUseFaceIcon:this.isUseFaceIcon,characterIdentifier:this.character?this.character.identifier:null,standIdentifier:r,standName:this.standName,isUseStandImage:this.isUseStandImage&&this.isUseStandImageOnChatTab})),this.text="",this.previousWritingLength=this.text.length,this.textAreaElementRef.nativeElement.value="",this.calcFitHeight(),ze.trigger("MESSAGE_EDITING_START",null)}calcFitHeight(){let n=this.textAreaElementRef.nativeElement;n.style.height="",n.scrollHeight>=n.offsetHeight&&(n.style.height=n.scrollHeight+"px")}loadDiceBot(n){console.log("onChangeGameType ready"),Gn.getHelpMessage(n).then(e=>{console.log("onChangeGameType done\n"+e)})}showDicebotHelp(){Gn.getHelpMessage(this.gameType).then(n=>{this.gameHelp=n;let e="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8";for(let o of Gn.diceBotInfos)o.id===this.gameType&&(e="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3008"+o.game+"\u3009");e+="\u4f7f\u7528\u6cd5";let i=this.pointerDeviceService.pointers[0],s=this.panelService.open(du,{left:i.x,top:i.y,width:600,height:500});s.title=e,s.text=this.gameHelp})}onContextMenu(n){if(n.stopPropagation(),n.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let e=this.pointerDeviceService.pointers[0];if(!this.character)return void this.contextMenuService.open(e,[{name:"\u63a5\u7d9a\u60c5\u5831",action:()=>{this.panelService.open(Ev,{width:520,height:600,top:e.y-100,left:e.x-100})}}],We.myCursor.name,null,We.myCursor.color,!0);let i=[{name:"\u300c\u300d\u3092\u5165\u529b",action:()=>{let r=this.textAreaElementRef.nativeElement,s=this.text.trim();"\u300c"!=s.slice(0,1)&&(s="\u300c"+s),"\u300d"!=s.slice(-1)&&(s+="\u300d"),this.text=s,r.value=this.text,r.selectionStart=this.text.length-1,r.selectionEnd=this.text.length-1,r.focus()}}];this.character&&(this.isUseFaceIcon&&this.character.faceIcon?(i.push(kt),i.push({name:"\u9854\u30a2\u30a4\u30b3\u30f3\u306e\u5207\u308a\u66ff\u3048",action:null,subActions:this.character.faceIcons.map((r,s)=>({name:this.character.currntIconIndex==s?"\u25c9":"\u25cb",action:()=>{this.character.currntIconIndex!=s&&(this.character.currntIconIndex=s)},default:this.character.currntIconIndex==s,icon:r})),disabled:this.character.faceIcons.length<=1})):(this.character.imageFiles.length>1&&(i.push(kt),i.push({name:"\u753b\u50cf\u5207\u308a\u66ff\u3048",action:null,subActions:this.character.imageFiles.map((r,s)=>({name:this.character.currntImageIndex==s?"\u25c9":"\u25cb",action:()=>{this.character.currntImageIndex=s,pt.play(tt.surprise),ze.trigger("UPDATE_INVENTORY",null)},default:this.character.currntImageIndex==s,icon:r}))})),i.push(kt),i.push({name:"\u753b\u50cf\u52b9\u679c",action:null,subActions:[this.character.isInverse?{name:"\u2611 \u53cd\u8ee2",action:()=>{this.character.isInverse=!1,ze.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u53cd\u8ee2",action:()=>{this.character.isInverse=!0,ze.trigger("UPDATE_INVENTORY",null)}},this.character.isHollow?{name:"\u2611 \u307c\u304b\u3057",action:()=>{this.character.isHollow=!1,ze.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u307c\u304b\u3057",action:()=>{this.character.isHollow=!0,ze.trigger("UPDATE_INVENTORY",null)}},this.character.isBlackPaint?{name:"\u2611 \u9ed2\u5857\u308a",action:()=>{this.character.isBlackPaint=!1,ze.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ed2\u5857\u308a",action:()=>{this.character.isBlackPaint=!0,ze.trigger("UPDATE_INVENTORY",null)}},{name:"\u30aa\u30fc\u30e9",action:null,subActions:[{name:(-1==this.character.aura?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{this.character.aura=-1,ze.trigger("UPDATE_INVENTORY",null)}},kt].concat(["\u30d6\u30e9\u30c3\u30af","\u30d6\u30eb\u30fc","\u30b0\u30ea\u30fc\u30f3","\u30b7\u30a2\u30f3","\u30ec\u30c3\u30c9","\u30de\u30bc\u30f3\u30bf","\u30a4\u30a8\u30ed\u30fc","\u30db\u30ef\u30a4\u30c8"].map((r,s)=>({name:`${this.character.aura==s?"\u25c9":"\u25cb"} ${r}`,action:()=>{this.character.aura=s,ze.trigger("UPDATE_INVENTORY",null)}})))},kt,{name:"\u30ea\u30bb\u30c3\u30c8",action:()=>{this.character.isInverse=!1,this.character.isHollow=!1,this.character.isBlackPaint=!1,this.character.aura=-1,ze.trigger("UPDATE_INVENTORY",null)},disabled:!this.character.isInverse&&!this.character.isHollow&&!this.character.isBlackPaint&&-1==this.character.aura}]})),i.push(kt),i.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.character)}}),this.onlyCharacters||i.push({name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a",action:()=>{this.showChatPalette(this.character)}}),i.push({name:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a",action:()=>{this.showStandSetting(this.character)}})),this.contextMenuService.open(e,i,this.character.name)}farewellStand(){if(this.character){const n={characterIdentifier:this.character.identifier};if(this.sendTo){const e=dt.instance.get(this.sendTo);e&&(e.peerId!=We.myCursor.peerId&&ze.call("FAREWELL_STAND_IMAGE",n,e.peerId),ze.call("FAREWELL_STAND_IMAGE",n,We.myCursor.peerId))}else ze.call("FAREWELL_STAND_IMAGE",n)}}showDetail(n){let e=this.pointerDeviceService.pointers[0],i="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";n.name.length&&(i+=" - "+n.name),this.panelService.open(Ws,{title:i,left:e.x-400,top:e.y-300,width:800,height:600}).tabletopObject=n}showChatPalette(n){let e=this.pointerDeviceService.pointers[0];this.panelService.open(hu,{left:e.x-250,top:e.y-175,width:620,height:350}).character=n}showStandSetting(n){let e=this.pointerDeviceService.pointers[0];this.panelService.open(Jp,{left:e.x-400,top:e.y-175,width:730,height:572}).character=n}allowsChat(n){switch(n.location.name){case"table":case this.myPeer.peerId:return!0;case"graveyard":return!1;default:for(const e of xt.peerContexts)if(e.isOpen&&n.location.name===e.peerId)return!1;return!0}}}nr.history=new Array,nr.MAX_HISTORY_NUM=1e3,nr.\u0275fac=function(n){return new(n||nr)(He(Cn),He(kr),He(dg),He(An),He(fi),He(lr))},nr.\u0275cmp=Xt({type:nr,selectors:[["chat-input"]],viewQuery:function(n,e){if(1&n&&cn(Aq,7),2&n){let i;ln(i=un())&&(e.textAreaElementRef=i.first)}},inputs:{onlyCharacters:"onlyCharacters",chatTabidentifier:"chatTabidentifier",_gameType:["gameType","_gameType"],_sendFrom:["sendFrom","_sendFrom"],_sendTo:["sendTo","_sendTo"],_text:["text","_text"]},outputs:{gameTypeChange:"gameTypeChange",sendFromChange:"sendFromChange",sendToChange:"sendToChange",textChange:"textChange",chat:"chat"},decls:35,vars:34,consts:[[1,"table",3,"ngClass"],[1,"table-cell","imagebox",2,"cursor","context-menu","padding-left","4px",3,"contextmenu"],["class","imagebox",4,"ngIf","ngIfElse"],["isCharacter",""],[1,"table-cell"],[2,"margin-right","5px"],["type","checkbox",3,"ngModel","checked","ngModelChange","change",4,"ngIf"],["style","font-size: smaller;",4,"ngIf"],[3,"ngModel","ngStyle","ngModelChange","change"],["style","font-weight: bolder;",3,"value","color",4,"ngIf"],["style","font-weight: normal;",3,"color","value",4,"ngFor","ngForOf"],[2,"white-space","nowrap"],[2,"max-width","9.5em",3,"ngModel","ngClass","ngStyle","ngModelChange"],["value","",1,"not-specified"],["style","font-weight: bolder;",3,"value","color",4,"ngFor","ngForOf"],["style","width: 12em;",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange",4,"ngIf"],["style","width: 12em;","disabled","",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange",4,"ngIf"],[3,"click"],["style","font-size: smaller",3,"ngClass",4,"ngIf"],["type","color","style","width:1em; margin-left: 3px",3,"ngModel","ngModelOptions","ngModelChange",4,"ngIf"],[1,"chat-input",3,"placeholder","ngModel","ngModelOptions","ngModelChange","input","keydown.enter","keydown.control.arrowup","keydown.control.arrowdown"],["textArea",""],["type","submit",3,"click"],[1,"writing-info"],[4,"ngIf"],[1,"imagebox"],["class","image face-icon",3,"src",4,"ngIf"],[1,"image","face-icon",3,"src"],["noFaceIcon",""],["class","inverser",3,"ngClass",4,"ngIf"],[1,"inverser",3,"ngClass"],[1,"aura","imagebox",3,"ngClass"],[1,"image",3,"src","ngClass"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"font-size","smaller"],[2,"font-weight","bolder",3,"value"],[2,"font-weight","normal",3,"value"],[2,"width","12em",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange"],["value","DiceBot",1,"not-specified"],["class","dice-bot-group",3,"label",4,"ngFor","ngForOf"],[1,"dice-bot-group",3,"label"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["disabled","",2,"width","12em",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange"],[2,"font-size","smaller",3,"ngClass"],[2,"margin-right","2px"],[2,"width","8em","margin-right","6px",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange"],[2,"white-space","nowrap","margin-left","1em","display","inline-block"],["type","range","min","0","max","100",2,"width","186px",3,"ngModel","change","ngModelChange"],["type","number","min","0","max","100",2,"width","3em","text-align","right","margin-right","3px",3,"ngModel","change","ngModelChange"],["type","button",2,"margin-left","1.3em","font-size","smaller",3,"click"],["type","color",2,"width","1em","margin-left","3px",3,"ngModel","ngModelOptions","ngModelChange"],["style","display: inline; white-space: pre",4,"ngFor","ngForOf"],[2,"display","inline","white-space","pre"],["class","cover mini-icon",3,"background-image",4,"ngIf"],[2,"font-weight","bold","display","inline"],[1,"peer-name"],["style","user-select: none",4,"ngIf"],[1,"cover","mini-icon"],[2,"user-select","none"]],template:function(n,e){if(1&n&&(Q(0,"div",0)(1,"div",1),Ae("contextmenu",function(r){return e.onContextMenu(r)}),Te(2,Nq,2,1,"div",2),Te(3,jq,3,2,"ng-template",null,3,Un),ie(),Q(5,"div",4)(6,"div")(7,"label",5),Te(8,Hq,1,2,"input",6),Te(9,Uq,2,0,"b",7),ie(),Q(10,"select",8),Ae("ngModelChange",function(r){return e.sendFrom=r})("change",function(){return e.standName=""}),Te(11,Vq,2,4,"option",9),Te(12,Gq,2,4,"option",10),ie(),Q(13,"span",11),ye(14," \u27a1 "),Q(15,"select",12),Ae("ngModelChange",function(r){return e.sendTo=r}),Q(16,"option",13),ye(17,"\u5168\u54e1"),ie(),Te(18,Wq,3,5,"option",14),ie()(),Q(19,"span",11),Te(20,Zq,4,7,"select",15),Te(21,Xq,3,6,"select",16),Q(22,"button",17),Ae("click",function(){return e.showDicebotHelp()}),ye(23,"?"),ie()()(),Te(24,eW,18,19,"div",18),Q(25,"div")(26,"form"),Te(27,tW,1,3,"input",19),Q(28,"textarea",20,21),Ae("ngModelChange",function(r){return e.text=r})("input",function(){return e.onInput()})("keydown.enter",function(r){return e.sendChat(r)})("keydown.control.arrowup",function(r){return e.moveHistory(r,1)})("keydown.control.arrowdown",function(r){return e.moveHistory(r,-1)}),ie(),Q(30,"button",22),Ae("click",function(){return e.sendChat(null)}),Q(31,"b"),ye(32,"SEND"),ie()()()(),Q(33,"div",23),Te(34,sW,3,1,"ng-container",24),ie()()()),2&n){const i=Kt(4);re("ngClass",ft(23,oW,e.isDirect)),U(2),re("ngIf",!e.character)("ngIfElse",i),U(6),re("ngIf",e.character),U(1),re("ngIf",e.character),U(1),Qe("max-width",e.character?"9.5em":"13em"),re("ngModel",e.sendFrom)("ngStyle",Yt(25,YS,e.color,e.sendFrom!=(null==e.myPeer?null:e.myPeer.identifier)?"normal":"bolder")),U(1),re("ngIf",!e.onlyCharacters),U(1),re("ngForOf",e.gameCharacters),U(3),re("ngModel",e.sendTo)("ngClass",ft(28,fg,""==e.sendTo))("ngStyle",Yt(30,YS,""==e.sendTo?null:e.sendToColor,""==e.sendTo?"normal":"bolder")),U(3),re("ngForOf",e.otherPeers),U(2),re("ngIf",e.diceBotInfosIndexed.length>0),U(1),re("ngIf",e.diceBotInfosIndexed.length<1),U(3),re("ngIf",e.hasStand),U(3),re("ngIf",e.onlyCharacters),U(1),re("placeholder",e.onlyCharacters?"Ctrl+\u21c5:\u5c65\u6b74 \u23ce:\u9001\u4fe1 Shift+\u23ce:\u6539\u884c\u3000\u767d(255,255,255):\u3042\u306a\u305f\u306e\u8272":"Ctrl+\u21c5:\u5c65\u6b74 \u23ce:\u9001\u4fe1 Shift+\u23ce:\u6539\u884c\u3000\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u8272\u3092\u512a\u5148")("ngModel",e.text)("ngModelOptions",sa(33,_f)),U(6),re("ngIf",0<e.writingPeerNameAndColors.length)}},directives:[Yn,bn,Jr,$i,di,es,Ji,Ur,Vr,oi,gs,mi,Oo,Fo,ps,Ml,kl,la],pipes:[ai],styles:['[_nghost-%COMP%]{display:block}.table[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px;display:table;width:100%}.table[_ngcontent-%COMP%]   .table-cell[_ngcontent-%COMP%]{display:table-cell}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:50px;height:50px;max-width:50px;max-height:50px;vertical-align:top;text-align:center}.image[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%}.image.face-icon[_ngcontent-%COMP%]{border-radius:.5rem}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #00f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 6px #ccc) drop-shadow(0 -4px 4px #fff)}.chat-input[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,"M+ 1p",sans-serif;line-height:1.3;font-size:13px;width:calc(100% - 100px);height:calc(1em + 4px);min-height:calc(1em + 7px);max-height:calc(6em + 7px);overflow-y:auto;padding:1px;margin:5px;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;vertical-align:bottom}.writing-info[_ngcontent-%COMP%]{font-size:8px;height:1.3em}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.not-specified[_ngcontent-%COMP%]{color:gray}.dice-bot-group[_ngcontent-%COMP%]{color:#f5f5f5;background-color:#555}option[_ngcontent-%COMP%]{color:#000;background-color:#fff}.disabled-stand[_ngcontent-%COMP%]{color:gray}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}.direct-message[_ngcontent-%COMP%]   .writing-info[_ngcontent-%COMP%]{color:#eee}.mini-icon[_ngcontent-%COMP%]{display:inline-block;padding:0;width:.9rem;height:.9rem;vertical-align:middle;border-radius:.2rem;margin-right:1px;-o-object-fit:cover;object-fit:cover}.direct-message[_ngcontent-%COMP%]   .mini-icon[_ngcontent-%COMP%]{filter:drop-shadow(1px 1px 1px #ffffff) drop-shadow(-1px -1px 1px #ffffff)}.direct-message[_ngcontent-%COMP%]   .peer-name[_ngcontent-%COMP%]{text-shadow:1px 0px 1px #ffffff,0px 1px 1px #ffffff,-1px 0px 1px #ffffff,0px -1px 1px #ffffff}']});let Tv=(()=>{class t{constructor(){this.tableInventory=new hg(e=>"table"===e.location.name),this.commonInventory=new hg(e=>!this.isAnyLocation(e.location.name)),this.privateInventory=new hg(e=>e.location.name===xt.peerId),this.graveyardInventory=new hg(e=>"graveyard"===e.location.name),this.indicateAll=!1,this._sortStop=!1,this.locationMap=new Map,this.tagNameMap=new Map,this.newLineString="/",this.newLineDataElement=_t.create(this.newLineString),this.initialize()}get summarySetting(){return Zo.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(e){this.summarySetting.sortTag=e}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(e){this.summarySetting.sortOrder=e}get dataTag(){return this.summarySetting.dataTag}set dataTag(e){this.summarySetting.dataTag=e}get dataTags(){return this.summarySetting.dataTags}get sortStop(){return this.sortStop}set sortStop(e){const i=this._sortStop;this._sortStop=e,i&&!this._sortStop&&this.refresh()}initialize(){ze.register(this).on("OPEN_NETWORK",e=>{this.refresh()}).on("CONNECT_PEER",e=>{this.refresh()}).on("DISCONNECT_PEER",e=>{this.refresh()}).on("UPDATE_GAME_OBJECT",e=>{let i=dt.instance.get(e.data.identifier);if(i)if(i instanceof Gt){let r=this.locationMap.get(i.identifier);i.location.name!==r&&(this.locationMap.set(i.identifier,i.location.name),this.refresh())}else if(i instanceof _t){if(!this.containsInGameCharacter(i))return;let r=this.tagNameMap.get(i.identifier);(this.dataTags.includes(r)||this.dataTags.includes(i.name))&&i.name!==r&&(this.tagNameMap.set(i.identifier,i.name),this.refreshDataElements()),this.sortTag===i.name&&this.refreshSort(),0<i.children.length&&(this.refreshDataElements(),this.refreshSort()),this.callInventoryUpdate()}else i instanceof Zo&&(this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate())}).on("DELETE_GAME_OBJECT",e=>{this.locationMap.delete(e.data.identifier),this.tagNameMap.delete(e.data.identifier),this.refresh()}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.callInventoryUpdate()})}containsInGameCharacter(e){let i=e.parent,r=Gt.aliasName;for(;i;){if(i.aliasName===r)return!0;i=i.parent}return!1}refresh(){this.refreshObjects(),this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate()}refreshObjects(){this.tableInventory.refreshObjects(),this.commonInventory.refreshObjects(),this.privateInventory.refreshObjects(),this.graveyardInventory.refreshObjects()}refreshDataElements(){this.tableInventory.refreshDataElements(),this.commonInventory.refreshDataElements(),this.privateInventory.refreshDataElements(),this.graveyardInventory.refreshDataElements()}refreshSort(){this._sortStop||(this.tableInventory.refreshSort(),this.commonInventory.refreshSort(),this.privateInventory.refreshSort(),this.graveyardInventory.refreshSort())}callInventoryUpdate(){ze.trigger("UPDATE_INVENTORY",null)}isAnyLocation(e){if("table"===e||e===xt.peerId||"graveyard"===e)return!0;for(let i of xt.peerContexts)if(i.isOpen&&e===i.peerId)return!0;return!1}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=rn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();class hg{constructor(n){this.classifier=n,this.newLineString="/",this.newLineDataElement=_t.create(this.newLineString),this._tabletopObjects=[],this._dataElementMap=new Map,this.needsRefreshObjects=!0,this.needsRefreshElements=!0,this.needsSort=!0}get summarySetting(){return Zo.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(n){this.summarySetting.sortTag=n}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(n){this.summarySetting.sortOrder=n}get dataTag(){return this.summarySetting.dataTag}set dataTag(n){this.summarySetting.dataTag=n}get dataTags(){return this.summarySetting.dataTags}get tabletopObjects(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this.needsSort&&(this._tabletopObjects=this.sortTabletopObjects(this._tabletopObjects),this.needsSort=!1),this._tabletopObjects}get length(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this._tabletopObjects.length}get dataElementMap(){if(this.needsRefreshElements){this._dataElementMap.clear();let n=this.tabletopObjects;for(let e of n){if(!e.detailDataElement)continue;let i=this.dataTags.map(r=>r===this.newLineString?this.newLineDataElement:e.detailDataElement.getFirstElementByName(r));this._dataElementMap.set(e.identifier,i)}this.needsRefreshElements=!1}return this._dataElementMap}refreshObjects(){this.needsRefreshObjects=!0}refreshDataElements(){this.needsRefreshElements=!0}refreshSort(){this.needsSort=!0}searchTabletopObjects(){let n=dt.instance.getObjects(Gt),e=[];for(let i of n)this.classifier(i)&&e.push(i);return e}sortTabletopObjects(n){let e=this.sortTag.length?this.sortTag.trim():"",i="ASC"===this.sortOrder?-1:1;return e.length<1||n.sort((r,s)=>{var o,a;let h=null===(o=r.rootDataElement)||void 0===o?void 0:o.getFirstElementByName(e),w=null===(a=s.rootDataElement)||void 0===a?void 0:a.getFirstElementByName(e);if(!h&&!w)return 0;if(!w)return-1;if(!h)return 1;let X=this.convertToSortableValue(h),fe=this.convertToSortableValue(w);return X<fe?i:X>fe?-1*i:0}),n}convertToSortableValue(n){let i=rt.toHalfWidth(((n.isNumberResource?n.currentValue:n.value)+"").trim()),r=+i;return Number.isNaN(r)?i:r}}var Xl;let dr=Xl=class extends Ga{constructor(){super(...arguments),this.viewTableIdentifier="",this.gridShow=!1,this.gridSnap=!0}static get instance(){return Xl._instance||(Xl._instance=new Xl("TableSelecter"),Xl._instance.initialize()),Xl._instance}onStoreAdded(){super.onStoreAdded(),ze.register(this).on("SELECT_GAME_TABLE",n=>{console.log("SELECT_GAME_TABLE "+this.identifier),this.viewTable&&(this.viewTable.selected=!1),this.viewTableIdentifier=n.data.identifier,this.viewTable&&(this.viewTable.selected=!0)})}onStoreRemoved(){super.onStoreRemoved(),ze.unregister(this)}get viewTable(){let n=dt.instance.get(this.viewTableIdentifier);return n||(n=dt.instance.getObjects(Vi)[0],n&&(this.viewTableIdentifier.length<1||dt.instance.isDeleted(this.viewTableIdentifier))&&(this.viewTableIdentifier=n.identifier,ze.trigger("SELECT_GAME_TABLE",{identifier:n.identifier}))),n}};$e([at()],dr.prototype,"viewTableIdentifier",void 0),dr=Xl=$e([ni("TableSelecter")],dr);class ir{constructor(){this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1}static create(n,e=null,i=new ir){return n&&n.ownerDocument?i.setCSS((e||window.getComputedStyle(n)).transform):i.identity()}setData(n){if(null==n)return;let e=n.length;return 16==e?(this.m11=n[0],this.m12=n[1],this.m13=n[2],this.m14=n[3],this.m21=n[4],this.m22=n[5],this.m23=n[6],this.m24=n[7],this.m31=n[8],this.m32=n[9],this.m33=n[10],this.m34=n[11],this.m41=n[12],this.m42=n[13],this.m43=n[14],this.m44=n[15]):6==e?(this.m11=n[0],this.m12=n[1],this.m13=0,this.m14=0,this.m21=n[2],this.m22=n[3],this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=n[4],this.m42=n[5],this.m43=0,this.m44=1):9==e&&(this.m11=n[0],this.m12=n[1],this.m13=0,this.m14=n[2],this.m21=n[3],this.m22=n[4],this.m23=0,this.m24=n[5],this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=n[6],this.m42=n[7],this.m43=0,this.m44=n[8]),this}identity(){return this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1,this}scalar(n){return this.m11*=n,this.m12*=n,this.m13*=n,this.m14*=n,this.m21*=n,this.m22*=n,this.m23*=n,this.m24*=n,this.m31*=n,this.m32*=n,this.m33*=n,this.m34*=n,this.m41*=n,this.m42*=n,this.m43*=n,this.m44*=n,this}unproject(n,e={x:0,y:0,z:0,w:1}){let i=n.x*this.m11+n.y*this.m21+this.m41,r=n.x*this.m12+n.y*this.m22+this.m42,s=n.x*this.m13+n.y*this.m23+this.m43,o=n.x*this.m14+n.y*this.m24+this.m44,a=i+this.m31,h=r+this.m32,w=s+this.m33,X=o+this.m34;0==o&&(o=1e-4),i/=o,r/=o,s/=o,0==X&&(X=1e-4),a/=X,h/=X,w/=X;let fe=w-s;if(0==fe)return e.x=i,e.y=r,e.z=s,e.w=s,e;let pe=-s/fe;return i+=pe*(a-i),r+=pe*(h-r),e.x=i,e.y=r,e.z=s,e.w=s,e}project(n,e={x:0,y:0,z:0,w:1}){let i=n.z,r=n.x*this.m14+n.y*this.m24+i*this.m34+this.m44,s=n.x*this.m11+n.y*this.m21+i*this.m31+this.m41,o=n.x*this.m12+n.y*this.m22+i*this.m32+this.m42;return 0==r&&(r=1e-4),s/=r,o/=r,r<0&&(s-=this.m41,o-=this.m42,s*=1/r,o*=1/r,s+=this.m41,o+=this.m42),e.x=s,e.y=o,e.z=i,e.w=i,e}append(n){return ir.multiply(this,n,this)}setPosition(n){return this.m41=n.x,this.m42=n.y,this.m43=n.z,this}getPosition(n={x:0,y:0,z:0,w:1}){return n.x=this.m41,n.y=this.m42,n.z=this.m43,n}static makePosition(n,e=new ir){return e.identity(),e.setPosition(n),e}appendPosition(...n){let e;return e=1===n.length?n[0]:{x:n[0],y:n[1],z:n[2],w:1},this.append(ir.makePosition(e,ir.MATRIX3D))}static makePerspective(n,e=new ir){return e.identity(),e.m34=n?-1/n:0,e}appendPerspective(n){return n?this.append(ir.makePerspective(n,ir.MATRIX3D)):this}invert(n){n=n||this;let e=[],i=this.m11,r=this.m12,s=this.m13,o=this.m14,a=this.m21,h=this.m22,w=this.m23,X=this.m24,fe=this.m31,pe=this.m32,we=this.m33,Ie=this.m34,Pe=this.m41,Be=this.m42,Le=this.m43,Fe=this.m44;e[0]=w*Ie*Be-X*we*Be+X*pe*Le-h*Ie*Le-w*pe*Fe+h*we*Fe,e[1]=o*we*Be-s*Ie*Be-o*pe*Le+r*Ie*Le+s*pe*Fe-r*we*Fe,e[2]=s*X*Be-o*w*Be+o*h*Le-r*X*Le-s*h*Fe+r*w*Fe,e[3]=o*w*pe-s*X*pe-o*h*we+r*X*we+s*h*Ie-r*w*Ie;let Ve=i*e[0]+a*e[1]+fe*e[2]+Pe*e[3];return 0==Ve?(console.warn("Can not invert matrix, determinant is 0"),this):(e[4]=X*we*Pe-w*Ie*Pe-X*fe*Le+a*Ie*Le+w*fe*Fe-a*we*Fe,e[5]=s*Ie*Pe-o*we*Pe+o*fe*Le-i*Ie*Le-s*fe*Fe+i*we*Fe,e[6]=o*w*Pe-s*X*Pe-o*a*Le+i*X*Le+s*a*Fe-i*w*Fe,e[7]=s*X*fe-o*w*fe+o*a*we-i*X*we-s*a*Ie+i*w*Ie,e[8]=h*Ie*Pe-X*pe*Pe+X*fe*Be-a*Ie*Be-h*fe*Fe+a*pe*Fe,e[9]=o*pe*Pe-r*Ie*Pe-o*fe*Be+i*Ie*Be+r*fe*Fe-i*pe*Fe,e[10]=r*X*Pe-o*h*Pe+o*a*Be-i*X*Be-r*a*Fe+i*h*Fe,e[11]=o*h*fe-r*X*fe-o*a*pe+i*X*pe+r*a*Ie-i*h*Ie,e[12]=w*pe*Pe-h*we*Pe-w*fe*Be+a*we*Be+h*fe*Le-a*pe*Le,e[13]=r*we*Pe-s*pe*Pe+s*fe*Be-i*we*Be-r*fe*Le+i*pe*Le,e[14]=s*h*Pe-r*w*Pe-s*a*Be+i*w*Be+r*a*Le-i*h*Le,e[15]=r*w*fe-s*h*fe+s*a*pe-i*w*pe-r*a*we+i*h*we,n.setData(e),n.scalar(1/Ve),n)}setCSS(n){if(!n||"none"==n)return this.identity();let e=n.replace("matrix3d(","").replace("matrix(","").replace(")","").split(","),i=e.length;for(let r=0;r<i;++r)e[r]=Bi.parse(e[r]);return this.setData(e)}appendCSS(n,e=!1){return n&&"none"!=n?e&&n.indexOf("matrix3d")>=0?this.append(ir.MATRIX3D.setCSS(n).flatten()):this.append(ir.MATRIX3D.setCSS(n)):this}flatten(){return this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m44=1,this.m14=0,this.m24=0,this.m43=0,this}static multiply(n,e,i=new ir){let s=n.m11*e.m12+n.m12*e.m22+n.m13*e.m32+n.m14*e.m42,o=n.m11*e.m13+n.m12*e.m23+n.m13*e.m33+n.m14*e.m43,a=n.m11*e.m14+n.m12*e.m24+n.m13*e.m34+n.m14*e.m44,h=n.m21*e.m11+n.m22*e.m21+n.m23*e.m31+n.m24*e.m41,w=n.m21*e.m12+n.m22*e.m22+n.m23*e.m32+n.m24*e.m42,X=n.m21*e.m13+n.m22*e.m23+n.m23*e.m33+n.m24*e.m43,fe=n.m21*e.m14+n.m22*e.m24+n.m23*e.m34+n.m24*e.m44,pe=n.m31*e.m11+n.m32*e.m21+n.m33*e.m31+n.m34*e.m41,we=n.m31*e.m12+n.m32*e.m22+n.m33*e.m32+n.m34*e.m42,Ie=n.m31*e.m13+n.m32*e.m23+n.m33*e.m33+n.m34*e.m43,Pe=n.m31*e.m14+n.m32*e.m24+n.m33*e.m34+n.m34*e.m44,Be=n.m41*e.m11+n.m42*e.m21+n.m43*e.m31+n.m44*e.m41,Le=n.m41*e.m12+n.m42*e.m22+n.m43*e.m32+n.m44*e.m42,Fe=n.m41*e.m13+n.m42*e.m23+n.m43*e.m33+n.m44*e.m43,Ve=n.m41*e.m14+n.m42*e.m24+n.m43*e.m34+n.m44*e.m44;return i.m11=n.m11*e.m11+n.m12*e.m21+n.m13*e.m31+n.m14*e.m41,i.m12=s,i.m13=o,i.m14=a,i.m21=h,i.m22=w,i.m23=X,i.m24=fe,i.m31=pe,i.m32=we,i.m33=Ie,i.m34=Pe,i.m41=Be,i.m42=Le,i.m43=Fe,i.m44=Ve,i}toString(n=3){return"m11="+this.m11.toFixed(n)+"\tm21="+this.m21.toFixed(n)+"\tm31="+this.m31.toFixed(n)+"\tm41="+this.m41.toFixed(n)+"\nm12="+this.m12.toFixed(n)+"\tm22="+this.m22.toFixed(n)+"\tm32="+this.m32.toFixed(n)+"\tm42="+this.m42.toFixed(n)+"\nm13="+this.m13.toFixed(n)+"\tm23="+this.m23.toFixed(n)+"\tm33="+this.m33.toFixed(n)+"\tm43="+this.m43.toFixed(n)+"\nm14="+this.m14.toFixed(n)+"\tm24="+this.m24.toFixed(n)+"\tm34="+this.m34.toFixed(n)+"\tm44="+this.m44.toFixed(n)}}ir.MATRIX3D=new ir;class mf{constructor(n){this.matrix=new ir,this.sceneTransform=new ir,this.inverseSceneTransform=new ir,this.initialize(n)}clear(){return this.element=null,this.matrix.identity(),this}initialize(n){if(!n)return;this.element=n;let e=window.getComputedStyle(n),i=0,r=0;return this.element.parentElement?(i=this.element.parentElement.clientWidth,r=this.element.parentElement.clientHeight):(i=window.innerWidth,r=window.innerHeight),this.paddingLeft=Bi.relation(e.paddingTop,i),this.paddingTop=Bi.relation(e.paddingTop,r),this.marginLeft=Bi.relation(e.marginLeft,i),this.marginTop=Bi.relation(e.marginTop,r),this.borderLeft=Bi.relation(e.borderLeft,i),this.borderTop=Bi.relation(e.borderTop,r),this.matrix.setCSS(e.transform),this.sceneTransform.identity(),this.extract(this,this.sceneTransform),this.sceneTransform.invert(this.inverseSceneTransform),this}globalToLocal(n,e,i=0){let r={x:n,y:e,z:i,w:1};return this.inverseSceneTransform.unproject(r,r),this.fromBorderBox(r),r}localToGlobal(n,e,i=0){let r={x:n,y:e,z:i,w:1};return this.sceneTransform.project(r,r),this.fromBorderBox(r),r}localToLocal(n,e,i,r){let s_x=n,s_y=e,s_z=i,o=new mf(r),a=ir.multiply(this.sceneTransform,o.inverseSceneTransform),h={x:0,y:0,z:0,w:1};return h.x=s_x*a.m11+s_y*a.m21+s_z*a.m31+1*a.m41,h.y=s_x*a.m12+s_y*a.m22+s_z*a.m32+1*a.m42,h.z=s_x*a.m13+s_y*a.m23+s_z*a.m33+1*a.m43,h.w=s_x*a.m14+s_y*a.m24+s_z*a.m34+1*a.m44,o.clear(),this.toBorderBox(h),h}extract(n,e){let r=n.element;for(;r;)this.extractMatrix(r,e),r&&"fixed"===r.style.position&&(console.warn("fixed\u9818\u57df\u306f\u8a08\u7b97\u304c\u4e0d\u6b63\u78ba"),e.appendPosition(window.pageXOffset,window.pageYOffset,0)),r=r.parentElement}extractMatrix(n,e=null){if(e||(e=new ir),!n)return e;let i=n,r=window.getComputedStyle(n);if("none"!=r.transform){let a=r.transformOrigin?r.transformOrigin.split(" "):[],h=Bi.relation(a[0],i.offsetWidth,.5*i.offsetWidth),w=Bi.relation(a[1],i.offsetHeight,.5*i.offsetHeight),X=Bi.relation(a[2],0,0);e.appendPosition(-h,-w,-X),e.appendCSS(r.transform),e.appendPosition(h,w,X)}let s=this.getPosition(n);e.appendPosition(s.x,s.y,0);let o=0;if(n.parentElement){let a=window.getComputedStyle(n.parentElement);o=Bi.parse(a.perspective)}if(n.parentElement&&o){let h=window.getComputedStyle(n.parentElement).perspectiveOrigin.split(" "),w=Bi.relation(h[0],i.parentElement.offsetWidth),X=Bi.relation(h[1],i.parentElement.offsetHeight);e.appendPosition(-w,-X,0),e.appendPerspective(o),e.appendPosition(w,X,0)}return e}getPosition(n){let e={x:0,y:0};return e.x=n.offsetParent?n.parentElement===n.offsetParent?n.offsetLeft:n.parentElement.offsetParent===n.offsetParent?n.offsetLeft-n.parentElement.offsetLeft:0:n.offsetLeft,e.y=n.offsetParent?n.parentElement===n.offsetParent?n.offsetTop:n.parentElement.offsetParent===n.offsetParent?n.offsetTop-n.parentElement.offsetTop:0:n.offsetTop,e.x+=n.offsetParent?n.offsetParent.clientLeft:0,e.y+=n.offsetParent?n.offsetParent.clientTop:0,e}fromBorderBox(n){n.x+=this.paddingLeft,n.y+=this.paddingTop,n.x-=this.marginLeft,n.y-=this.marginTop,n.x-=this.borderLeft,n.y-=this.borderTop}toBorderBox(n){n.x-=this.paddingLeft,n.y-=this.paddingTop,n.x+=this.marginLeft,n.y+=this.marginTop,n.x+=this.borderLeft,n.y+=this.borderTop}}let tl=(()=>{class t{constructor(e){this.pointerDeviceService=e,this.tabletopOriginElement=document.body}convertToLocal(e,i=document.body){let r=new mf(i),s=r.globalToLocal(e.x,e.y,e.z?e.z:0);return r.clear(),{x:s.x,y:s.y,z:s.z}}convertToGlobal(e,i=document.body){let r=new mf(i),s=r.localToGlobal(e.x,e.y,e.z?e.z:0);return r.clear(),{x:s.x,y:s.y,z:s.z}}convertLocalToLocal(e,i,r){let s=new mf(i),o=s.globalToLocal(e.x,e.y,e.z?e.z:0),a=s.localToLocal(o.x,o.y,0,r);return s.clear(),{x:a.x,y:a.y,z:a.z}}calcTabletopLocalCoordinate(e={x:this.pointerDeviceService.pointers[0].x,y:this.pointerDeviceService.pointers[0].y,z:0},i=this.pointerDeviceService.targetElement){return i.contains(this.tabletopOriginElement)?(e=this.convertToLocal(e,this.tabletopOriginElement)).z=0:e=this.convertLocalToLocal(e,i,this.tabletopOriginElement),{x:e.x,y:e.y,z:0<e.z?e.z:0}}}return t.\u0275fac=function(e){return new(e||t)(an(fi))},t.\u0275prov=rn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),vu=(()=>{class t{constructor(e){this.coordinateService=e,this._emptyTable=new Vi(""),this.locationMap=new Map,this.parentMap=new Map,this.characterCache=new nl(()=>dt.instance.getObjects(Gt).filter(i=>i.isVisibleOnTable)),this.cardCache=new nl(()=>dt.instance.getObjects(zn).filter(i=>i.isVisibleOnTable)),this.cardStackCache=new nl(()=>dt.instance.getObjects(Kn).filter(i=>i.isVisibleOnTable)),this.tableMaskCache=new nl(()=>{let i=this.tableSelecter.viewTable;return i?i.masks:[]}),this.rangeCache=new nl(()=>dt.instance.getObjects(li).filter(i=>i.isVisibleOnTable)),this.terrainCache=new nl(()=>{let i=this.tableSelecter.viewTable;return i?i.terrains:[]}),this.textNoteCache=new nl(()=>dt.instance.getObjects(Mr)),this.diceSymbolCache=new nl(()=>dt.instance.getObjects(cr)),this.initialize()}get tableSelecter(){return dr.instance}get currentTable(){return this.tableSelecter.viewTable||this._emptyTable}get characters(){return this.characterCache.objects}get cards(){return this.cardCache.objects}get cardStacks(){return this.cardStackCache.objects}get tableMasks(){return this.tableMaskCache.objects}get ranges(){return this.rangeCache.objects}get terrains(){return this.terrainCache.objects}get textNotes(){return this.textNoteCache.objects}get diceSymbols(){return this.diceSymbolCache.objects}get peerCursors(){return dt.instance.getObjects(We)}initialize(){this.refreshCacheAll(),ze.register(this).on("UPDATE_GAME_OBJECT",e=>{if(e.data.identifier===this.currentTable.identifier||e.data.identifier===this.tableSelecter.identifier)return this.refreshCache(is.aliasName),void this.refreshCache(ur.aliasName);let i=dt.instance.get(e.data.identifier);i&&i instanceof Ci?this.shouldRefreshCache(i)&&(this.refreshCache(e.data.aliasName),this.updateMap(i)):this.refreshCache(e.data.aliasName)}).on("DELETE_GAME_OBJECT",e=>{let i=e.data.aliasName;i?this.refreshCache(i):this.refreshCacheAll()}).on("XML_LOADED",e=>{let r=ti.instance.parseXml(e.data.xmlElement);if(r instanceof Ci){let s=this.coordinateService.calcTabletopLocalCoordinate();r.location.x=s.x-25,r.location.y=s.y-25,r.posZ=s.z,this.placeToTabletop(r),pt.play(tt.piecePut)}else r instanceof Qa?mo.instance.addChatTab(r):r instanceof ga?go.instance.addDiceRollTable(r):r instanceof xi&&_o.instance.addCutIn(r)})}findCache(e){switch(e){case Gt.aliasName:return this.characterCache;case zn.aliasName:return this.cardCache;case Kn.aliasName:return this.cardStackCache;case is.aliasName:return this.tableMaskCache;case ur.aliasName:return this.terrainCache;case Mr.aliasName:return this.textNoteCache;case cr.aliasName:return this.diceSymbolCache;case li.aliasName:return this.rangeCache;default:return null}}refreshCache(e){let i=this.findCache(e);i&&i.refresh()}refreshCacheAll(){this.characterCache.refresh(),this.cardCache.refresh(),this.cardStackCache.refresh(),this.tableMaskCache.refresh(),this.terrainCache.refresh(),this.textNoteCache.refresh(),this.diceSymbolCache.refresh(),this.rangeCache.refresh(),this.clearMap()}shouldRefreshCache(e){return this.locationMap.get(e.identifier)!==e.location.name||this.parentMap.get(e.identifier)!==e.parentId}updateMap(e){this.locationMap.set(e.identifier,e.location.name),this.parentMap.set(e.identifier,e.parentId)}clearMap(){this.locationMap.clear(),this.parentMap.clear()}placeToTabletop(e){switch(e.aliasName){case is.aliasName:e instanceof is&&(e.isLock=!1);case ur.aliasName:if(e instanceof ur&&(e.isLocked=!1),!this.tableSelecter||!this.tableSelecter.viewTable)return;this.tableSelecter.viewTable.appendChild(e);break;case zn.aliasName:case Kn.aliasName:case li.aliasName:case Mr.aliasName:(e instanceof zn||e instanceof Kn||e instanceof li||e instanceof Mr)&&(e.isLocked=!1),e instanceof li&&(e.followingCharctorIdentifier=null);default:e.setLocation("table")}}}return t.\u0275fac=function(e){return new(e||t)(an(tl))},t.\u0275prov=rn({token:t,factory:t.\u0275fac}),t})();class nl{constructor(n){this.refreshCollector=n,this.needsRefresh=!0,this._objects=[]}get objects(){return this.needsRefresh&&(this._objects=this.refreshCollector(),this._objects=this._objects?this._objects:[],this.needsRefresh=!1),this._objects}refresh(){this.needsRefresh=!0}}class Ql{constructor(n,e,i){this.chanks=[],this.chankSize=32768,this.chankReceiveCount=0,this.sentChankIndex=0,this.bufferingChankRange=4,this.completedChankIndex=0,this.startTime=0,this.isCanceled=!1,this.identifier=n,this.sendTo=e,this.data=i}static createSendTask(n,e,i){let r=new Ql(n,e,i);return r.onstart=()=>r.initializeSend(),r}static createReceiveTask(n){let e=new Ql(n);return e.onstart=()=>e.initializeReceive(),e}start(n){this.onstart?(this.data=n,this.onstart(),this.onstart=null):console.warn("\u518d\u8d77\u52d5\u3059\u308b\u4ed5\u69d8\u306a\u3069\u7121\u3044\u3002")}progress(n,e){this.onprogress&&this.onprogress(this,n,e)}finish(){this.isCanceled||(this.isCanceled=!0,this.onfinish&&this.onfinish(this,this.data),this.dispose())}timeout(){this.isCanceled||(this.isCanceled=!0,this.ontimeout&&this.ontimeout(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}cancel(){this.isCanceled||(null!=this.sendTo&&ze.call("CANCEL_TASK_"+this.identifier,null,this.sendTo),this._cancel())}_cancel(){this.isCanceled||(this.isCanceled=!0,this.oncancel&&this.oncancel(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}dispose(){ze.unregister(this),this.sendChankTimer&&function z8(t){zd.delete(t)}(this.sendChankTimer),this.timeoutTimer&&this.timeoutTimer.clear(),this.sendChankTimer=null,this.timeoutTimer=null,this.onprogress=this.onfinish=this.ontimeout=this.oncancel=null}initializeSend(){this.uint8Array=bs.encode(this.data);let n=Math.ceil(this.uint8Array.byteLength/this.chankSize);this.chanks=new Array(n),console.log("\u30c1\u30e3\u30f3\u30af\u5206\u5272 "+this.identifier,this.chanks.length),ze.register(this).on("FILE_MORE_CHANK_"+this.identifier,e=>{this.sendTo===e.sendFrom&&(this.completedChankIndex=e.data,null==this.sendChankTimer&&this.sentChankIndex+1<this.chanks.length&&this.sendChank(this.sentChankIndex+1),this.resetTimeout())}).on("DISCONNECT_PEER",e=>{e.data.peerId===this.sendTo&&(console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,e.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,e=>{console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,e.sendFrom),this._cancel()}),this.sentChankIndex=this.completedChankIndex=0,this.startTime=performance.now(),Sr(()=>this.sendChank(0))}sendChank(n){let e=this.uint8Array.slice(n*this.chankSize,(n+1)*this.chankSize);ze.call("FILE_SEND_CHANK_"+this.identifier,{index:n,length:this.chanks.length,chank:e},this.sendTo),this.sentChankIndex=n,this.sendChankTimer=null,this.chanks.length<=n+1?(console.log("\u30d0\u30c3\u30d5\u30a1\u9001\u4fe1\u5b8c\u4e86",this.identifier),this.outputTransferRate(this.uint8Array.byteLength),Sr(()=>this.finish())):this.completedChankIndex+this.bufferingChankRange<=n?this.resetTimeout():this.sendChankTimer=Sr(()=>{this.sendChank(this.sentChankIndex+1)})}initializeReceive(){this.resetTimeout(),this.startTime=performance.now(),this.chankReceiveCount=0,ze.register(this).on("FILE_SEND_CHANK_"+this.identifier,n=>{this.chanks.length<1&&(this.chanks=new Array(n.data.length)),null==this.chanks[n.data.index]?(this.chankReceiveCount++,this.chanks[n.data.index]=n.data.chank,this.progress(n.data.index,n.data.length),this.chanks.length<=this.chankReceiveCount?this.finishReceive():(this.resetTimeout(),ze.call("FILE_MORE_CHANK_"+this.identifier,n.data.index,n.sendFrom))):console.log(`already received. [${n.data.index}] <${this.identifier}>`)}).on("DISCONNECT_PEER",n=>{n.data.peerId===this.sendTo&&(console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,n.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,n=>{console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,n.sendFrom),this._cancel()})}finishReceive(){console.log("\u30d0\u30c3\u30d5\u30a1\u53d7\u4fe1\u5b8c\u4e86",this.identifier);let n=0;for(let r of this.chanks)n+=r.byteLength;this.outputTransferRate(n);let e=new Uint8Array(n),i=0;for(let r of this.chanks)e.set(r,i),i+=r.byteLength;this.data=bs.decode(e),this.finish()}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new ha(()=>this.timeout(),1e4)),this.timeoutTimer.reset()}outputTransferRate(n){let e=performance.now()-this.startTime,i=n/1024/1024/(e/1e3);console.log(`${(n/1024).toFixed(2)}KB ${(e/1e3).toFixed(2)}\u79d2 \u8ee2\u9001\u901f\u5ea6: ${i.toFixed(2)}MB/s`)}}class bu{constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4}static get instance(){return bu._instance||(bu._instance=new bu),bu._instance}initialize(){console.log("AudioSharingSystem ready..."),this.destroy(),ze.register(this).on("CONNECT_PEER",-1,n=>{!n.isSendFromSelf||(console.log("CONNECT_PEER AudioStorageService !!!",n.data.peerId),zt.instance.synchronize())}).on("SYNCHRONIZE_AUDIO_LIST",n=>{if(n.isSendFromSelf)return;console.log("SYNCHRONIZE_AUDIO_LIST "+n.sendFrom);let e=n.data,i=[];console.log("SYNCHRONIZE_AUDIO_LIST active tasks ",this.sendTaskMap.size+this.receiveTaskMap.size);for(let s of e){let o=zt.instance.get(s.identifier);null===o&&(o=ys.createEmpty(s.identifier),zt.instance.add(o)),o.state<gr.COMPLETE&&!this.receiveTaskMap.has(s.identifier)&&i.push({identifier:s.identifier,state:o.state})}if(i.length<1&&!this.hasActiveTask()&&e.length<zt.instance.getCatalog().length&&zt.instance.synchronize(n.sendFrom),i.length<1||this.isLimitReceiveTask())return;let r=Math.floor(Math.random()*i.length);this.request([i[r]],n.sendFrom)}).on("REQUEST_AUDIO_RESOURE",n=>{if(n.isSendFromSelf)return;let e=n.data.identifiers,i=[];for(let r of e){let s=zt.instance.get(r.identifier);s&&r.state<s.state&&i.push({identifier:r.identifier,state:r.state})}if(!1===this.isLimitSendTask()&&0<i.length&&!this.existsSendTask(n.data.receiver)){console.log("REQUEST_AUDIO_RESOURE Send!!! "+n.data.receiver+" -> "+i);let r=Math.floor(Math.random()*i.length),o=zt.instance.get(i[r].identifier);this.startSendTask(o,n.data.receiver)}else{let r=n.data.candidatePeers,s=r.indexOf(xt.peerId);-1<s&&r.splice(s,1);for(let o of r)return console.log("REQUEST_AUDIO_RESOURE AudioStorageService Relay!!! "+o+" -> "+n.data.identifiers),void ze.call(n,o);console.log("REQUEST_FILE_RESOURE AudioStorageService \u3042\u3076\u308c\u305f..."+n.data.receiver,i.length)}}).on("UPDATE_AUDIO_RESOURE",1e3,n=>{let e=n.data;console.log("UPDATE_AUDIO_RESOURE AudioStorageService "+n.sendFrom+" -> ",e);for(let i of e)i.blob&&(i.blob=new Blob([i.blob],{type:i.type})),zt.instance.add(i)}).on("START_AUDIO_TRANSMISSION",n=>{console.log("START_AUDIO_TRANSMISSION "+n.data.fileIdentifier);let e=n.data.fileIdentifier,i=zt.instance.get(e);this.receiveTaskMap.has(e)||i&&gr.COMPLETE<=i.state?(console.warn("CANCEL_TASK_ "+e),ze.call("CANCEL_TASK_"+e,null,n.sendFrom)):this.startReceiveTask(e)})}destroy(){ze.unregister(this)}startSendTask(n,e){var i=this;return(0,tn.Z)(function*(){let r=Ql.createSendTask(n.identifier,e);i.sendTaskMap.set(n.identifier,r),ze.call("START_AUDIO_TRANSMISSION",{fileIdentifier:n.identifier},e);let s={identifier:n.identifier,name:n.name,blob:null,type:"",url:null};n.state===gr.URL?s.url=n.url:(s.blob=yield po.readAsArrayBufferAsync(n.blob),s.type=n.blob.type),r.onfinish=()=>{i.stopSendTask(r.identifier),zt.instance.synchronize()},r.start(s)})()}startReceiveTask(n){let e=zt.instance.get(n),i=Ql.createReceiveTask(n);this.receiveTaskMap.set(n,i),i.onprogress=(r,s,o)=>{let a=e.toContext();a.name=(100*s/o).toFixed(1)+"%",e.apply(a)},i.onfinish=(r,s)=>{this.stopReceiveTask(r.identifier),s&&ze.trigger("UPDATE_AUDIO_RESOURE",[s]),zt.instance.synchronize()},i.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(n){let e=this.sendTaskMap.get(n);e&&e.cancel(),this.sendTaskMap.delete(n),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(n){let e=this.receiveTaskMap.get(n);e&&e.cancel(),this.receiveTaskMap.delete(n),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(n,e){console.log("requestFile() "+e);let i=xt.peerIds;i.splice(i.indexOf(xt.peerId),1),ze.call("REQUEST_AUDIO_RESOURE",{identifiers:n,receiver:xt.peerId,candidatePeers:i},e)}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(n){for(let e of this.sendTaskMap.values())if(e&&e.sendTo===n)return!0;return!1}}class yu{constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4,console.log("FileSharingSystem ready...")}static get instance(){return yu._instance||(yu._instance=new yu),yu._instance}initialize(){var n=this;ze.register(this).on("CONNECT_PEER",1,e=>{!e.isSendFromSelf||(console.log("CONNECT_PEER ImageStorageService !!!",e.data.peerId),Nt.instance.synchronize())}).on("XML_LOADED",e=>{!function aW(t){let n=[],e=t.querySelectorAll('*[type="image"]');for(let i=0;i<e.length;i++){let r=e[i].innerHTML;!Nt.instance.get(r)&&0<Yl.type(r).length&&n.push(r)}e=t.querySelectorAll("*[imageIdentifier]");for(let i=0;i<e.length;i++){let r=e[i].getAttribute("imageIdentifier");!Nt.instance.get(r)&&0<Yl.type(r).length&&n.push(r)}for(let i of n)Nt.instance.add(i)}(e.data.xmlElement)}).on("SYNCHRONIZE_FILE_LIST",e=>{if(e.isSendFromSelf)return;console.log("SYNCHRONIZE_FILE_LIST ImageStorageService "+e.sendFrom);let i=e.data,r=[];for(let s of i){let o=Nt.instance.get(s.identifier);null===o&&(o=Ut.createEmpty(s.identifier),Nt.instance.add(o)),o.state<Ui.COMPLETE&&!this.receiveTaskMap.has(s.identifier)&&r.push({identifier:s.identifier,state:o.state})}r.length<1&&!this.hasActiveTask()&&i.length<Nt.instance.getCatalog().length&&Nt.instance.synchronize(e.sendFrom),!(r.length<1||this.isLimitReceiveTask())&&this.request(r,e.sendFrom)}).on("REQUEST_FILE_RESOURE",function(){var e=(0,tn.Z)(function*(i){if(i.isSendFromSelf)return;let r=i.data.identifiers,s=[];for(let o of r){let a=Nt.instance.get(o.identifier);a&&o.state<a.state&&s.push({identifier:o.identifier,state:o.state})}if(!1===n.isLimitSendTask()&&0<s.length&&!n.existsSendTask(i.data.receiver)){let o=n.makeSendUpdateImages(s);console.log("REQUEST_FILE_RESOURE ImageStorageService Send!!! "+i.data.receiver+" -> "+o.length),n.startSendTask(o,i.data.receiver)}else{let o=i.data.candidatePeers,a=o.indexOf(xt.peerId);-1<a&&o.splice(a,1);for(let h of o)return console.log("REQUEST_FILE_RESOURE ImageStorageService Relay!!! "+h+" -> "+i.data.identifiers),void ze.call(i,h);console.log("REQUEST_FILE_RESOURE ImageStorageService \u3042\u3076\u308c\u305f..."+i.data.receiver,s.length)}});return function(i){return e.apply(this,arguments)}}()).on("UPDATE_FILE_RESOURE",1e3,e=>{let i=e.data.updateImages;console.log("UPDATE_FILE_RESOURE ImageStorageService "+e.sendFrom+" -> ",i);for(let r of i)r.blob&&(r.blob=new Blob([r.blob],{type:r.type})),r.thumbnail.blob&&(r.thumbnail.blob=new Blob([r.thumbnail.blob],{type:r.thumbnail.type})),Nt.instance.add(r)}).on("START_FILE_TRANSMISSION",e=>{console.log("START_FILE_TRANSMISSION "+e.data.taskIdentifier);let i=e.data.taskIdentifier,r=Nt.instance.get(i);this.receiveTaskMap.has(i)||r&&Ui.COMPLETE<=r.state?(console.warn("CANCEL_TASK_ "+i),ze.call("CANCEL_TASK_"+i,null,e.sendFrom)):this.startReceiveTask(i)})}destroy(){ze.unregister(this)}startSendTask(n,e){var i=this;return(0,tn.Z)(function*(){let r=1===n.length?n[0].identifier:ns.generateUuid(),s=Ql.createSendTask(r,e);i.sendTaskMap.set(s.identifier,s),ze.call("START_FILE_TRANSMISSION",{taskIdentifier:r},e);for(let o of n)o.thumbnail.blob?o.thumbnail.blob=yield po.readAsArrayBufferAsync(o.thumbnail.blob):o.blob&&(o.blob=yield po.readAsArrayBufferAsync(o.blob));s.onfinish=(o,a)=>{i.stopSendTask(o.identifier),Nt.instance.synchronize()},s.start(n)})()}startReceiveTask(n){let e=Ql.createReceiveTask(n);this.receiveTaskMap.set(n,e),e.onfinish=(i,r)=>{this.stopReceiveTask(i.identifier),r&&ze.trigger("UPDATE_FILE_RESOURE",{identifier:i.identifier,updateImages:r}),Nt.instance.synchronize()},e.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(n){let e=this.sendTaskMap.get(n);e&&e.cancel(),this.sendTaskMap.delete(n),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(n){let e=this.receiveTaskMap.get(n);e&&e.cancel(),this.receiveTaskMap.delete(n),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(n,e){console.log("requestFile() "+e);let i=xt.peerIds;i.splice(i.indexOf(xt.peerId),1),ze.call("REQUEST_FILE_RESOURE",{identifiers:n,receiver:xt.peerId,candidatePeers:i},e)}makeSendUpdateImages(n,e=524288){let i=[],r=0;for(let s=n.length-1;0<=s;s--){let o=Math.floor(Math.random()*(s+1));[n[s],n[o]]=[n[o],n[s]]}n.sort((s,o)=>s.state<o.state?-1:s.state>o.state?1:0);for(let s=0;s<n.length;s++){let o=n[s],a=Nt.instance.get(o.identifier),h={identifier:a.identifier,name:a.name,type:"",blob:null,url:null,thumbnail:{type:"",blob:null,url:null}};a.state===Ui.URL?h.url=a.url:o.state===Ui.NULL?(h.thumbnail.blob=a.thumbnail.blob,h.thumbnail.type=a.thumbnail.type):(h.blob=a.blob,h.type=a.blob.type);let w=h.blob?h.blob.size:h.thumbnail.blob?h.thumbnail.blob.size:100;if(i.push(h),r+=w,e<r)break}return i}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(n){for(let e of this.sendTaskMap.values())if(e&&e.sendTo===n)return!0;return!1}}class Li{constructor(n){this.peerId=n,this.requestMap=new Map}static create(n,e){Li.tasksMap.size<1&&ze.register(Li.key).on("DISCONNECT_PEER",r=>{Li.onDisconnect(r.data.peerId)}).on("UPDATE_GAME_OBJECT",r=>{r.isSendFromSelf||Li.onUpdate(r.data.identifier)}).on("DELETE_GAME_OBJECT",r=>{r.isSendFromSelf||Li.onUpdate(r.data.identifier)});let i=new Li(n);return i.initialize(e),i}cancel(){this.timeoutTimer&&this.timeoutTimer.clear(),this.timeoutTimer=null,this.onsynchronize=this.onfinish=this.ontimeout=null;for(let n of this.requestMap.values())this.deleteTasksMap(n.identifier);this.requestMap.clear()}initialize(n){for(let e of n){e.ttl--,this.requestMap.set(e.identifier,e);let i=Li.tasksMap.get(e.identifier);null==i&&(i=[]),i.push(this),Li.tasksMap.set(e.identifier,i);let r=null!=this.peerId&&e.holderIds.includes(this.peerId)?this.peerId:null;ze.call("REQUEST_GAME_OBJECT",e.identifier,r)}this.requestMap.size<1?setTimeout(()=>this.finish()):this.resetTimeout()}finish(){this.onfinish&&this.onfinish(this),this.cancel()}timeout(){this.ontimeout&&this.ontimeout(this,Array.from(this.requestMap.values()).filter(n=>0<=n.ttl)),this.finish()}static onDisconnect(n){for(let e of Li.tasksMap.values())for(let i of e.concat())i.peerId===n&&i.timeout();Li.tasksMap.size<1&&ze.unregister(Li.key)}static onUpdate(n){if(!Li.tasksMap.has(n))return;let e=Li.tasksMap.get(n);for(let i of e.concat())i.onUpdate(n);Li.tasksMap.size<1&&ze.unregister(Li.key)}onUpdate(n){this.requestMap.delete(n),this.onsynchronize&&this.onsynchronize(this,n),this.requestMap.size<1?this.finish():this.resetTimeout()}deleteTasksMap(n){let e=Li.tasksMap.get(n),i=e.indexOf(this);-1<i&&e.splice(i,1),e.length<1&&Li.tasksMap.delete(n)}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new ha(()=>this.timeout(),3e4)),this.timeoutTimer.reset()}}Li.key={},Li.tasksMap=new Map;class Cu{constructor(){this.requestMap=new Map,this.peerMap=new Map,this.tasks=[]}static get instance(){return Cu._instance||(Cu._instance=new Cu),Cu._instance}initialize(){this.destroy(),console.log("ObjectSynchronizer ready..."),ze.register(this).on("CONNECT_PEER",2,n=>{!n.isSendFromSelf||(console.log("CONNECT_PEER GameRoomService !!!",n.data.peerId),this.sendCatalog(n.data.peerId))}).on("DISCONNECT_PEER",n=>{this.removePeerMap(n.data.peerId)}).on("SYNCHRONIZE_GAME_OBJECT",n=>{if(n.isSendFromSelf)return;console.log("SYNCHRONIZE_GAME_OBJECT "+n.sendFrom);let e=n.data;for(let i of e)dt.instance.isDeleted(i.identifier)?ze.call("DELETE_GAME_OBJECT",{aliasName:"",identifier:i.identifier},n.sendFrom):this.addRequestMap(i,n.sendFrom);this.synchronize()}).on("REQUEST_GAME_OBJECT",n=>{if(!n.isSendFromSelf)if(dt.instance.isDeleted(n.data))ze.call("DELETE_GAME_OBJECT",{aliasName:"",identifier:n.data},n.sendFrom);else{let e=dt.instance.get(n.data);e&&ze.call("UPDATE_GAME_OBJECT",e.toContext(),n.sendFrom)}}).on("UPDATE_GAME_OBJECT",1e3,n=>{let e=n.data,i=dt.instance.get(e.identifier);i?n.isSendFromSelf||this.updateObject(i,e):dt.instance.isDeleted(e.identifier)?ze.call("DELETE_GAME_OBJECT",{aliasName:e.aliasName,identifier:e.identifier},n.sendFrom):this.createObject(e)}).on("DELETE_GAME_OBJECT",1e3,n=>{dt.instance.delete(n.data.identifier,!1)})}destroy(){ze.unregister(this)}updateObject(n,e){e.majorVersion+e.minorVersion>n.version&&n.apply(e)}createObject(n){let e=Uo.instance.create(n.aliasName,n.identifier);e?(dt.instance.add(e,!1),e.apply(n)):console.warn(n.aliasName+" is Unknown...?",n)}sendCatalog(n){let e=dt.instance.getCatalog(),i=setInterval(()=>{ze.call("SYNCHRONIZE_GAME_OBJECT",e.splice(0,e.length<2048?e.length:2048),n),e.length<1&&clearInterval(i)})}addRequestMap(n,e){let i=this.requestMap.get(n.identifier);i&&i.version===n.version?(i.holderIds.push(e),this.addPeerMap(e)):(!i||i.version<n.version)&&(this.requestMap.set(n.identifier,{identifier:n.identifier,version:n.version,holderIds:[e],ttl:2}),this.addPeerMap(e))}addPeerMap(n){this.peerMap.has(n)||this.peerMap.set(n,[])}removePeerMap(n){this.peerMap.delete(n)}synchronize(){for(;0<this.requestMap.size&&this.tasks.length<32;)this.runSynchronizeTask()}runSynchronizeTask(){let n=this.getTargetPeerId(),e=this.makeRequestList(n);if(e.length<1)return void this.removePeerMap(n);let i=Li.create(n,e);this.tasks.push(i);let r=this.peerMap.get(n);r&&r.push(i),i.onfinish=s=>{this.tasks.splice(this.tasks.indexOf(s),1);let o=this.peerMap.get(n);o&&o.splice(o.indexOf(s),1),this.synchronize()},i.ontimeout=(s,o)=>{console.log("GameObject synchronize \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8"),o.forEach(a=>this.requestMap.set(a.identifier,a))}}makeRequestList(n,e=32){let i=[];for(let[r,s]of this.requestMap){if(e<=i.length)break;if(!s.holderIds.includes(n))continue;let o=dt.instance.get(s.identifier);(!o||o.version<s.version)&&i.push(s),this.requestMap.delete(r)}return i}getTargetPeerId(){let n=9999,e=null,i=xt.peerContexts;for(let r=i.length-1;0<=r;r--){let s=Math.floor(Math.random()*(r+1));[i[r],i[s]]=[i[s],i[r]]}for(let r of i){let s=this.peerMap.get(r.peerId);r.isOpen&&s&&s.length<n&&(n=s.length,e=r.peerId)}return e}}let Jl=class extends Ga{constructor(){super(...arguments),this.audioIdentifier="",this.startTime=0,this.isLoop=!1,this.isPlaying=!1,this.audioPlayer=new Ft}get audio(){return zt.instance.get(this.audioIdentifier)}onStoreAdded(){super.onStoreAdded(),this.unlockAfterUserInteraction()}onStoreRemoved(){super.onStoreRemoved(),this._stop()}play(n,e=!1){let i=zt.instance.get(n);!i||!i.isReady||(this.audioIdentifier=n,this.isPlaying=!0,this.isLoop=e,this._play())}_play(){this._stop(),this.audio&&this.audio.isReady?(this.audioPlayer.loop=!0,this.audioPlayer.play(this.audio)):this.playAfterFileUpdate()}stop(){this.audioIdentifier="",this.isPlaying=!1,this._stop()}_stop(){this.unregisterEvent(),this.audioPlayer.stop()}playAfterFileUpdate(){ze.register(this).on("UPDATE_AUDIO_RESOURE",n=>{this._play()})}unlockAfterUserInteraction(){let n=()=>{document.body.removeEventListener("touchstart",n,!0),document.body.removeEventListener("mousedown",n,!0),this.audioPlayer.stop(),this.isPlaying&&this._play()};document.body.addEventListener("touchstart",n,!0),document.body.addEventListener("mousedown",n,!0)}unregisterEvent(){ze.unregister(this,"UPDATE_AUDIO_RESOURE")}apply(n){let e=this.audioIdentifier,i=this.isPlaying;super.apply(n),e===this.audioIdentifier&&i||!this.isPlaying?i!==this.isPlaying&&!this.isPlaying&&this._stop():this._play()}};function lW(t,n){if(1&t&&(Q(0,"option",6),ye(1),ie()),2&t){const e=n.$implicit;ht("value",e.identifier),U(1),Xe(e.name)}}function cW(t,n){if(1&t){const e=it();Ke(0),Q(1,"div",7)(2,"div"),ye(3," \u30bf\u30d6"),Q(4,"sup",8),ye(5,"*"),ie(),ye(6,"\uff1a "),Q(7,"label")(8,"input",9),Ae("ngModelChange",function(r){return Oe(e),_e().isAllTabs=r}),ie(),ye(9,"\u9078\u629e\u3057\u305f\u30bf\u30d6"),ie(),Q(10,"label")(11,"input",9),Ae("ngModelChange",function(r){return Oe(e),_e().isAllTabs=r}),ie(),ye(12,"\u5168\u3066\u306e\u30bf\u30d6"),ie()(),Q(13,"div"),ye(14," \u5f62\u5f0f"),Q(15,"sup",8),ye(16,"*"),ie(),ye(17,"\uff1a "),Q(18,"label")(19,"input",9),Ae("ngModelChange",function(r){return Oe(e),_e().logFormat=r}),ie(),ye(20,"\u30c6\u30ad\u30b9\u30c8"),ie(),Q(21,"label")(22,"input",9),Ae("ngModelChange",function(r){return Oe(e),_e().logFormat=r}),ie(),ye(23,"HTML"),ie()(),Q(24,"div"),ye(25," \u6642\u523b"),Q(26,"sup",8),ye(27,"*"),ie(),ye(28,"\uff1a "),Q(29,"label")(30,"input",9),Ae("ngModelChange",function(r){return Oe(e),_e().dateFormat=r}),ie(),ye(31,"\u306a\u3057"),ie(),Q(32,"label")(33,"input",9),Ae("ngModelChange",function(r){return Oe(e),_e().dateFormat=r}),ie(),ye(34,"\u6642\uff1a\u5206"),ie(),Q(35,"label")(36,"input",9),Ae("ngModelChange",function(r){return Oe(e),_e().dateFormat=r}),ie(),ye(37,"\u65e5\u4ed8\u6642\u523b"),ie()()(),ot(38,"hr"),Q(39,"div",10)(40,"div")(41,"label",11)(42,"input",12),Ae("ngModelChange",function(r){return Oe(e),_e().isWriteOerationLog=r}),ie(),ye(43,"\u64cd\u4f5c\u30ed\u30b0\u3092\u542b\u3081\u308b"),Q(44,"sup",8),ye(45,"*"),ie()()(),Q(46,"div",13)(47,"button",14),Ae("click",function(){return Oe(e),_e().saveLog()}),ye(48,"\u30ed\u30b0\u51fa\u529b"),ie()()(),Ye()}if(2&t){const e=_e();U(8),Zi("name","",e.panelId,"-log-output-tab"),re("ngModel",e.isAllTabs)("checked",!e.isAllTabs)("value",!1),U(3),Zi("name","",e.panelId,"-log-output-tab"),re("ngModel",e.isAllTabs)("checked",e.isAllTabs)("value",!0),U(8),Zi("name","",e.panelId,"-log-output-format"),re("ngModel",e.logFormat)("checked",0==e.logFormat)("value",0),U(3),Zi("name","",e.panelId,"-log-output-format"),re("ngModel",e.logFormat)("checked",1==e.logFormat)("value",1),U(8),Zi("name","",e.panelId,"-log-output-timestamp-type"),re("ngModel",e.dateFormat)("checked",""==e.dateFormat)("value",""),U(3),Zi("name","",e.panelId,"-log-output-timestamp-type"),re("ngModel",e.dateFormat)("checked","HH:mm"==e.dateFormat)("value","HH:mm"),U(3),Zi("name","",e.panelId,"-log-output-timestamp-type"),re("ngModel",e.dateFormat)("checked","yyyy/MM/dd HH:mm"==e.dateFormat)("value","yyyy/MM/dd HH:mm"),U(6),ht("checked",e.isWriteOerationLog?"checked":""),re("ngModel",e.isWriteOerationLog),U(5),re("disabled",e.isDiable)}}function uW(t,n){1&t&&(Ke(0),Q(1,"div",15),ye(2,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002"),ie(),Ye())}$e([at()],Jl.prototype,"audioIdentifier",void 0),$e([at()],Jl.prototype,"startTime",void 0),$e([at()],Jl.prototype,"isLoop",void 0),$e([at()],Jl.prototype,"isPlaying",void 0),Jl=$e([ni("jukebox")],Jl);let ZS=(()=>{class t{constructor(e,i,r,s){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.saveDataService=s,this.selectedTab=null}get isAllTabs(){return t.isAllTabs}set isAllTabs(e){t.isAllTabs=e}get logFormat(){return t.logFormat}set logFormat(e){t.logFormat=e}get dateFormat(){return t.dateFormat}set dateFormat(e){t.dateFormat=e}get isWriteOerationLog(){return t.isWriteOerationLog}set isWriteOerationLog(e){t.isWriteOerationLog=e}get tabName(){return this.selectedTab.name}set tabName(e){this.selectedTab.name=e}get chatTabs(){return this.chatMessageService.chatTabs}get isEmpty(){return this.chatMessageService.chatTabs.length<1}get isDeleted(){return!!this.selectedTab&&null==dt.instance.get(this.selectedTab.identifier)}get isDiable(){return this.isEmpty||!this.isAllTabs&&(!this.selectedTab||this.isDeleted)}get roomName(){return xt.peerContext&&0<xt.peerContext.roomName.length?xt.peerContext.roomName:"\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf"}ngOnInit(){Promise.resolve().then(()=>{this.modalService.title=this.panelService.title="\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0\u51fa\u529b",this.panelService.isAbleFullScreenButton=!1}),ze.register(this).on("DELETE_GAME_OBJECT",1e3,e=>{this.selectedTab&&e.data.identifier===this.selectedTab.identifier&&dt.instance.get(e.data.identifier)}),this.panelId=ns.generateUuid()}ngOnDestroy(){ze.unregister(this)}onChangeSelectTab(e){this.selectedTab=dt.instance.get(e)}saveLog(){this.isDiable||this.saveDataService.saveChatLog(this.logFormat,this.roomName+"_chatLog_"+(this.isAllTabs?"\u5168\u3066\u306e\u30bf\u30d6":this.selectedTab.name),this.isAllTabs?null:this.selectedTab,this.dateFormat,this.isWriteOerationLog)}}return t.isAllTabs=!1,t.logFormat=1,t.dateFormat="HH:mm",t.isWriteOerationLog=!0,t.\u0275fac=function(e){return new(e||t)(He(Fn),He(An),He(kr),He(Dr))},t.\u0275cmp=Xt({type:t,selectors:[["app-chat-log-output"]],decls:7,vars:5,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],["size","10",2,"width","140px",3,"ngModel","disabled","change"],[3,"value",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[3,"value"],[2,"font-weight","bolder","font-size","smaller","padding-top","3px"],[1,"self-only"],["type","radio",3,"name","ngModel","checked","value","ngModelChange"],[2,"width","100%","display","flex"],[2,"font-weight","bolder","font-size","smaller","padding-top","3px","padding-right","1em"],["type","checkbox",3,"ngModel","checked","ngModelChange"],[2,"flex-grow","1","text-align","right"],[2,"font-size","smaller",3,"disabled","click"],[2,"font-size","12px"]],template:function(e,i){1&e&&(Q(0,"div",0)(1,"div",1)(2,"select",2),Ae("change",function(s){return i.onChangeSelectTab(s.target.value)}),Te(3,lW,2,2,"option",3),ie()(),Q(4,"div",4),Te(5,cW,49,31,"ng-container",5),ie()(),Te(6,uW,3,0,"ng-container",5)),2&e&&(U(2),re("ngModel",null==i.selectedTab?null:i.selectedTab.identifier)("disabled",i.isAllTabs),U(1),re("ngForOf",i.chatTabs),U(2),re("ngIf",!i.isEmpty),U(1),re("ngIf",i.isEmpty))},directives:[es,$i,di,oi,Ur,Vr,bn,Oa,mi,Jr],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}label[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]{margin-left:.5em}.self-only[_ngcontent-%COMP%]{color:red}.log-sample-text[_ngcontent-%COMP%], .log-sample-html[_ngcontent-%COMP%]{background-color:#fff;font-size:smaller;overflow-y:hidden;width:100%;min-height:1.6em}select[_ngcontent-%COMP%]:disabled   option[_ngcontent-%COMP%]{color:HighlightText;background-color:Highlight}"]}),t})();function dW(t,n){if(1&t&&(Q(0,"option",7),ye(1),ie()),2&t){const e=n.$implicit;Qe("color",""==e.name?"gray":""),ht("value",e.identifier),ht("title",e.name),U(1),Xe(""==e.name?"(\u7121\u540d\u306e\u30bf\u30d6)":e.name)}}function fW(t,n){if(1&t&&(Q(0,"div",20),ye(1),ie()),2&t){const e=_e(3);U(1),Rn("",e.progresPercent,"%")}}const hW=function(t){return{"is-hidden":t}};function pW(t,n){if(1&t){const e=it();Ke(0),Q(1,"button",12),Ae("click",function(){return Oe(e),_e(2).upTabIndex()}),ye(2,"\u2191"),ie(),Q(3,"button",12),Ae("click",function(){return Oe(e),_e(2).downTabIndex()}),ye(4,"\u2193"),ie(),Q(5,"div",13)(6,"button",12),Ae("click",function(){return Oe(e),_e(2).showLogOutput()}),Q(7,"i",14),ye(8,"history_edu"),ie(),ye(9,"\u30ed\u30b0"),ie(),Q(10,"button",15),Ae("click",function(){return Oe(e),_e(2).save()}),Q(11,"div",16)(12,"div",17),ye(13,"\u4fdd\u5b58"),ie(),Te(14,fW,2,1,"div",18),ie()(),Q(15,"button",19),Ae("click",function(){return Oe(e),_e(2).delete()}),ye(16,"\u524a\u9664"),ie()(),Ye()}if(2&t){const e=_e(2);U(10),re("disabled",e.isSaveing),U(2),re("ngClass",ft(4,hW,e.isSaveing)),U(2),re("ngIf",e.isSaveing),U(1),Bt("disabled",e.chatTabs.length<=1?"":null)}}function gW(t,n){if(1&t){const e=it();Ke(0),Q(1,"button",12),Ae("click",function(){return Oe(e),_e(2).restore()}),ye(2,"\u5143\u306b\u623b\u3059"),ie(),Ye()}}function _W(t,n){if(1&t){const e=it();Ke(0),Q(1,"div")(2,"label")(3,"b",8),ye(4,"\u30bf\u30d6\u540d: "),ie(),Q(5,"input",9),Ae("ngModelChange",function(r){return Oe(e),_e().tabName=r}),ie()()(),Q(6,"div",10)(7,"label")(8,"input",11),Ae("ngModelChange",function(r){return Oe(e),_e().isUseStandImage=r})("change",function(){Oe(e);const r=_e();return r.isUseStandImage=!!r.isUseStandImage}),ie(),ye(9," \u{1f4ad}\u3001\u30ab\u30c3\u30c8\u30a4\u30f3\u3001\u30b9\u30bf\u30f3\u30c9\u6709\u52b9 "),ie()(),Q(10,"div",10)(11,"label")(12,"input",11),Ae("ngModelChange",function(r){return Oe(e),_e().recieveOperationLogLevel=r})("change",function(){Oe(e);const r=_e();return r.recieveOperationLogLevel=r.recieveOperationLogLevel>0?1:0}),ie(),ye(13," \u64cd\u4f5c\u30ed\u30b0\u3092\u53d7\u4fe1\u3059\u308b "),ie()(),ot(14,"hr"),Q(15,"div"),Te(16,pW,17,6,"ng-container",6),Te(17,gW,3,0,"ng-container",6),ie(),Ye()}if(2&t){const e=_e();U(5),re("ngModel",e.tabName),Bt("disabled",e.isEditable?null:""),U(3),ht("checked",e.isUseStandImage?"checked":""),re("ngModel",e.isUseStandImage),Bt("disabled",e.isEditable?null:""),U(4),ht("checked",e.recieveOperationLogLevel>0?"checked":""),re("ngModel",e.recieveOperationLogLevel),Bt("disabled",e.isEditable?null:""),U(4),re("ngIf",!e.isDeleted),U(1),re("ngIf",e.isDeleted)}}function mW(t,n){1&t&&(Ke(0),Q(1,"div",21),ye(2,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b\u300d\u304b\u3089\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),ie(),Ye())}let $W=(()=>{class t{constructor(e,i,r,s,o){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.saveDataService=s,this.pointerDeviceService=o,this.selectedTab=null,this.selectedTabXml="",this.isSaveing=!1,this.progresPercent=0}get tabName(){return this.selectedTab.name}set tabName(e){this.isEditable&&(this.selectedTab.name=e)}get isUseStandImage(){return this.selectedTab.isUseStandImage}set isUseStandImage(e){this.isEditable&&(this.selectedTab.isUseStandImage=e)}get recieveOperationLogLevel(){return this.selectedTab.recieveOperationLogLevel}set recieveOperationLogLevel(e){this.isEditable&&(this.selectedTab.recieveOperationLogLevel=e)}get chatTabs(){return this.chatMessageService.chatTabs}get isEmpty(){return this.chatMessageService.chatTabs.length<1}get isDeleted(){return!!this.selectedTab&&null==dt.instance.get(this.selectedTab.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}get roomName(){return xt.peerContext&&0<xt.peerContext.roomName.length?xt.peerContext.roomName:"\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf"}ngOnInit(){Promise.resolve().then(()=>{this.modalService.title=this.panelService.title="\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u8a2d\u5b9a",this.panelService.isAbleFullScreenButton=!1}),ze.register(this).on("DELETE_GAME_OBJECT",2e3,e=>{if(!this.selectedTab||e.data.identifier!==this.selectedTab.identifier)return;let i=dt.instance.get(e.data.identifier);null!==i&&(this.selectedTabXml=i.toXml())})}ngOnDestroy(){ze.unregister(this)}onChangeSelectTab(e){this.selectedTab=dt.instance.get(e),this.selectedTabXml=""}create(){mo.instance.addChatTab("\u30bf\u30d6")}save(){var e=this;return(0,tn.Z)(function*(){if(!e.selectedTab||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i="fly_chat_"+e.selectedTab.name;yield e.saveDataService.saveGameObjectAsync(e.selectedTab,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}delete(){!this.isEmpty&&this.selectedTab&&(this.selectedTabXml=this.selectedTab.toXml(),this.selectedTab.destroy())}restore(){if(this.selectedTab&&this.selectedTabXml){let e=ti.instance.parseXml(this.selectedTabXml);mo.instance.addChatTab(e),this.selectedTabXml=""}}upTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,i=e.children.indexOf(this.selectedTab);0<i&&e.insertBefore(this.selectedTab,e.children[i-1])}downTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,i=e.children.indexOf(this.selectedTab);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.selectedTab)}showLogOutput(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(ZS,{left:e.x-250,top:e.y-175,width:450,height:300}).selectedTab=this.selectedTab}}return t.\u0275fac=function(e){return new(e||t)(He(Fn),He(An),He(kr),He(Dr),He(fi))},t.\u0275cmp=Xt({type:t,selectors:[["app-chat-tab-setting"]],decls:10,vars:4,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[2,"font-size","smaller","margin-bottom","2px",3,"click"],["size","10",2,"width","100%","max-width","140px",3,"ngModel","change"],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[3,"value","title"],[2,"font-size","smaller"],["placeholder","Name",2,"width","200px",3,"ngModel","ngModelChange"],[2,"font-weight","bolder","font-size","smaller","padding-top","3px"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[3,"click"],[2,"float","right"],[1,"material-icons","small-font"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,i){1&e&&(Q(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Ae("click",function(){return i.create()}),ye(4,"\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b"),ie()(),Q(5,"select",3),Ae("change",function(s){return i.onChangeSelectTab(s.target.value)}),Te(6,dW,2,5,"option",4),ie()(),Q(7,"div",5),Te(8,_W,18,10,"ng-container",6),ie()(),Te(9,mW,3,0,"ng-container",6)),2&e&&(U(5),re("ngModel",null==i.selectedTab?null:i.selectedTab.identifier),U(1),re("ngForOf",i.chatTabs),U(2),re("ngIf",!i.isEmpty&&i.selectedTab),U(1),re("ngIf",i.isEmpty))},directives:[es,$i,di,oi,Ur,Vr,bn,mi,Jr,Yn],styles:["[_nghost-%COMP%]{display:block}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}.small-font[_ngcontent-%COMP%]{font-size:16px;vertical-align:middle}"]}),t})();const vW=["edit"];function bW(t,n){1&t&&_n(0)}function yW(t,n){if(1&t&&(Ke(0),Te(1,bW,1,0,"ng-container",11),Ye()),2&t){_e();const e=Kt(11);U(1),re("ngTemplateOutlet",e)}}function CW(t,n){1&t&&_n(0)}function xW(t,n){if(1&t&&(Ke(0),Te(1,CW,1,0,"ng-container",11),Ye()),2&t){_e();const e=Kt(13);U(1),re("ngTemplateOutlet",e)}}function wW(t,n){1&t&&_n(0)}function EW(t,n){1&t&&_n(0)}function TW(t,n){if(1&t&&(Q(0,"div"),Te(1,EW,1,0,"ng-container",11),ie()),2&t){_e();const e=Kt(19);U(1),re("ngTemplateOutlet",e)}}function SW(t,n){1&t&&_n(0)}function IW(t,n){if(1&t&&(Ke(0),Te(1,SW,1,0,"ng-container",11),Ye()),2&t){_e();const e=Kt(13);U(1),re("ngTemplateOutlet",e)}}function kW(t,n){1&t&&_n(0)}function MW(t,n){if(1&t&&(Ke(0),Te(1,kW,1,0,"ng-container",11),Ye()),2&t){_e();const e=Kt(11);U(1),re("ngTemplateOutlet",e)}}const DW=function(t,n){return{"black-paint":t,"face-icon":n}};function AW(t,n){if(1&t&&(ot(0,"img",15),Et(1,"safe")),2&t){const e=_e(2);re("src",Tt(1,2,null==e.imageFile?null:e.imageFile.url,"resourceUrl"),en)("ngClass",Yt(5,DW,1==e.chatMessage.isBlackPaint,e.chatMessage.isFaceIcon))}}const PW=function(t,n){return{inverse:t,hollow:n}},NW=function(t,n,e,i,r,s,o,a){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:s,yellow:o,white:a}};function FW(t,n){if(1&t&&(Q(0,"div",12)(1,"span",13),Te(2,AW,2,8,"img",14),ie()()),2&t){const e=_e();re("ngClass",Yt(3,PW,1==e.chatMessage.isInverseIcon,1==e.chatMessage.isHollowIcon)),U(1),re("ngClass",uo(6,NW,0==e.chatMessage.aura,1==e.chatMessage.aura,2==e.chatMessage.aura,3==e.chatMessage.aura,4==e.chatMessage.aura,5==e.chatMessage.aura,6==e.chatMessage.aura,7==e.chatMessage.aura)),U(1),re("ngIf",0<(null==e.imageFile||null==e.imageFile.url?null:e.imageFile.url.length))}}function OW(t,n){if(1&t&&(Ke(0),Q(1,"span",19),ye(2),Et(3,"date"),ie(),Ye()),2&t){const e=_e(2);U(2),Xe(Tt(3,1,e.chatMessage.timestamp,"H:mm"))}}function RW(t,n){if(1&t&&(ot(0,"img",22),Et(1,"safe")),2&t){const e=_e(3);re("src",Tt(1,1,null==e.toImageFile?null:e.toImageFile.url,"resourceUrl"),en)}}const Sv=function(t){return{grow:t}};function BW(t,n){if(1&t&&(Ke(0),Te(1,RW,2,4,"img",20),Q(2,"span",18),ye(3),ie(),Q(4,"span",21),ye(5,"\u27a1"),ie(),Ye()),2&t){const e=_e(2);U(1),re("ngIf",0<(null==e.toImageFile||null==e.toImageFile.url?null:e.toImageFile.url.length)),U(1),Qe("color",e.chatMessage.toColor&&"#ffffff"!=e.chatMessage.toColor?e.chatMessage.toColor:""),re("ngClass",ft(5,Sv,e.chatMessage.isDirect||e.chatMessage.isSecret)),U(1),Xe(e.chatMessage.toName)}}function LW(t,n){if(1&t&&(ot(0,"img",22),Et(1,"safe")),2&t){const e=_e(3);re("src",Tt(1,1,null==e.toImageFile?null:e.toImageFile.url,"resourceUrl"),en)}}function zW(t,n){if(1&t&&(Ke(0),Q(1,"span",23),ye(2,"\u27a1"),ie(),Te(3,LW,2,4,"img",20),Q(4,"span",18),ye(5),ie(),Ye()),2&t){const e=_e(2);U(3),re("ngIf",0<(null==e.toImageFile||null==e.toImageFile.url?null:e.toImageFile.url.length)),U(1),Qe("color",e.chatMessage.toColor&&"#ffffff"!=e.chatMessage.toColor?e.chatMessage.toColor:""),re("ngClass",ft(5,Sv,e.chatMessage.isDirect||e.chatMessage.isSecret)),U(1),Xe(e.chatMessage.toName)}}function jW(t,n){if(1&t){const e=it();Q(0,"span",27),Ae("click",function(r){return Oe(e),_e(3).onLinkClick(r)}),Et(1,"safe"),ie()}2&t&&re("innerHTML",Tt(1,1,_e(3).htmlEscapedFrom,"html"),Yi)}function HW(t,n){if(1&t&&(Q(0,"span",19),ye(1),Et(2,"date"),ie()),2&t){const e=_e(3);U(1),Xe(Tt(2,1,e.chatMessage.timestamp,"y/M/d H:mm"))}}function UW(t,n){if(1&t&&(Q(0,"span",19),ye(1),Et(2,"date"),ie()),2&t){const e=_e(3);U(1),Xe(Tt(2,1,e.chatMessage.timestamp,"H:mm"))}}function VW(t,n){1&t&&_n(0)}function GW(t,n){if(1&t&&(Ke(0),Te(1,jW,2,4,"span",24),Te(2,HW,3,4,"span",25),Te(3,UW,3,4,"span",25),Te(4,VW,1,0,"ng-container",26),Ye()),2&t){const e=_e(2),i=Kt(19);U(1),re("ngIf",!e.isCompact),U(1),re("ngIf",!e.isCompact&&e.chatMessage.timestamp),U(1),re("ngIf",e.isCompact&&e.chatMessage.timestamp),U(1),re("ngIf",!(e.isEditable&&!e.isCompact))("ngIfElse",i)}}function qW(t,n){if(1&t&&(Q(0,"div",16),Te(1,OW,4,4,"ng-container",2),Q(2,"span",17),Te(3,BW,6,7,"ng-container",2),Q(4,"span",18),ye(5),ie(),Te(6,zW,6,7,"ng-container",2),ie(),Te(7,GW,5,5,"ng-container",2),ie()),2&t){const e=_e();U(1),re("ngIf",e.isCompact&&!e.isMine&&e.chatMessage.timestamp),U(2),re("ngIf",!e.isMine&&e.chatMessage.toColor),U(1),Qe("color",e.chatMessage.color&&"#ffffff"!=e.chatMessage.color?e.chatMessage.color:""),re("ngClass",ft(8,Sv,e.chatMessage.isDirect||e.chatMessage.isSecret)),U(1),Xe(e.chatMessage.name),U(1),re("ngIf",e.isMine&&e.chatMessage.toColor),U(1),re("ngIf",!e.isCompact||e.isMine)}}function WW(t,n){if(1&t){const e=it();Q(0,"div",33)(1,"span",34),ye(2),ie(),Q(3,"textarea",35,36),Ae("ngModelChange",function(r){return Oe(e),_e(2).editingText=r})("keydown.enter",function(r){return Oe(e),_e(2).editEnd(r)})("keydown.escape",function(){return Oe(e),_e(2).editCancel()}),ie()()}if(2&t){const e=_e(2);U(2),Xe(e.lastNewLineAdjust(e.editingText)),U(1),re("ngModel",e.editingText)}}function KW(t,n){if(1&t&&(Q(0,"span",37)(1,"b",38),ye(2,"\u7de8\u96c6\u6e08"),ie(),ye(3),Et(4,"date"),ie()),2&t){const e=_e(2);U(3),Rn(" ",Tt(4,1,e.chatMessage.lastUpdate,"M/d H:mm"),"")}}function YW(t,n){if(1&t){const e=it();Q(0,"button",39),Ae("click",function(){return Oe(e),_e(2).discloseMessage()}),ye(1,"\u7d50\u679c\u3092\u516c\u958b"),ie()}}function ZW(t,n){if(1&t){const e=it();Te(0,WW,5,2,"div",28),Q(1,"div")(2,"span",29)(3,"span",30),Ae("click",function(r){return Oe(e),_e().onLinkClick(r)}),Et(4,"safe"),ie(),Te(5,KW,5,4,"span",31),Te(6,YW,2,0,"button",32),ie()()}if(2&t){const e=_e();re("ngIf",e.isEditing),U(1),Qe("display",e.isEditing?"none":"block"),U(2),Qe("color",!e.chatMessage.isSpecialColor&&e.chatMessage.color&&"#ffffff"!=e.chatMessage.color?e.chatMessage.color:""),re("innerHTML",Tt(4,8,e.htmlEscapedText,"html"),Yi),U(2),re("ngIf",!e.isEditing&&e.chatMessage.isEdited),U(1),re("ngIf",e.chatMessage.isSecret)}}function XW(t,n){1&t&&(Q(0,"span")(1,"s"),ye(2,"\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09"),ie()())}function QW(t,n){if(1&t){const e=it();Q(0,"button",45),Ae("click",function(){return Oe(e),_e(2).editStart()}),Q(1,"i",46),ye(2,"edit"),ie()()}}function JW(t,n){1&t&&(Q(0,"button",47)(1,"i",46),ye(2,"clear"),ie()())}function eK(t,n){if(1&t){const e=it();Q(0,"button",48),Ae("click",function(){return Oe(e),_e(2).editEnd()}),Q(1,"i",46),ye(2,"done"),ie()()}2&t&&re("disabled",0==_e(2).editingText.trim().length)}function tK(t,n){if(1&t){const e=it();Q(0,"button",49),Ae("click",function(){return Oe(e),_e(2).editCancel()}),Q(1,"i",46),ye(2,"clear"),ie()()}}function nK(t,n){if(1&t&&(Q(0,"span",40),Te(1,QW,3,0,"button",41),Te(2,JW,3,0,"button",42),Te(3,eK,3,1,"button",43),Te(4,tK,3,0,"button",44),ie()),2&t){const e=_e();Qe("visibility",e.isEditing?"visible":""),U(1),re("ngIf",!e.isEditing),U(1),re("ngIf",!e.isEditing),U(1),re("ngIf",e.isEditing),U(1),re("ngIf",e.isEditing)}}const iK=function(t,n){return{compact:t,editing:n}},rK=function(t,n,e,i,r,s){return{"is-mine":t,"is-others":n,"direct-message":e,"system-message":i,"dicebot-message":r,"operation-log":s}},sK=function(t,n,e,i){return{"is-success":t,"is-failure":n,"is-critical":e,"is-fumble":i}};let oK=(()=>{class t{constructor(e,i,r){this.chatMessageService=e,this.modalService=i,this.changeDetector=r,this.compact=!1,this.imageFile=Ut.Empty,this.animeState="inactive",this.isEditing=!1,this.editingText="",this.stringUtil=rt}ngOnInit(){ze.register(this).on("MESSAGE_EDITING_START",-1e3,r=>{r.isSendFromSelf&&(!r.data||r.data.messageIdentifier!==this.chatMessage.identifier)&&this.editCancel()}).on("CHANGE_GM_MODE",r=>{this.changeDetector.markForCheck()});let e=this.chatMessage.image;e&&(this.imageFile=e),e=this.chatMessage.toImage,e&&(this.toImageFile=e),this.chatMessageService.getTime()-1e4<this.chatMessage.timestamp&&(this.animeState="active")}ngAfterViewInit(){this.chatMessage.isAnimated=!0}get isMine(){return this.chatMessage.isSendFromSelf}get isEditable(){return this.chatMessage.isEditable}get isCompact(){return this.compact||this.chatMessage.isOperationLog}get htmlEscapedFrom(){return this._htmlEscapeLinking(this.chatMessage.from,!0)}get htmlEscapedText(){let e=this._htmlEscapeLinking(this.chatMessage.text,!1,!this.chatMessage.isOperationLog);return this.chatMessage.isDicebot&&(e=Qn.decorationDiceResult(e)),e}_htmlEscapeLinking(e,i=!1,r=!1){return e=rt.escapeHtml(e),r&&(e=rt.rubyToHtml(e)),ov.link(this.lastNewLineAdjust(e),{urls:{schemeMatches:!0,wwwMatches:!0,tldMatches:!1},truncate:{length:48,location:"end"},decodePercentEncoding:i,stripPrefix:i,stripTrailingSlash:i,email:!1,phone:!1,replaceFn:function(s){if("url"==s.getType()&&rt.validUrl(s.getAnchorHref())){if(rt.sameOrigin(s.getAnchorHref()))return!0;{const o=s.buildTag();return o.setAttr("rel","nofollow"),o.addClass("outer-link"),o}}return!1}})}discloseMessage(){this.chatMessage.tag=this.chatMessage.tag.replace("secret","")}editStart(){ze.trigger("MESSAGE_EDITING_START",{messageIdentifier:this.chatMessage.identifier}),this.editingText=this.chatMessage.text,this.isEditing=!0,setTimeout(()=>{this.editElm.nativeElement&&this.editElm.nativeElement.focus()})}editEnd(e=null){e&&e.preventDefault(),(!e||13===e.keyCode)&&(this.isEditable&&this.editingText.trim().length>0&&this.chatMessage.text!=this.editingText?(this.chatMessage.isSecret||(this.chatMessage.lastUpdate=Date.now()),this.chatMessage.text=this.editingText,this.isEditing=!1):this.editCancel())}editCancel(){this.isEditing=!1}lastNewLineAdjust(e){return null==e?"":!this.isEditing&&(this.chatMessage.isEdited||this.chatMessage.isSecret)||e.lastIndexOf("\n")!=e.length-1?e:e+"\n"}onLinkClick(e){if(e&&"A"==e.target.tagName){const i=e.target.getAttribute("href");if(!rt.sameOrigin(i))return e.preventDefault(),this.modalService.open(qr,{url:e.target.getAttribute("href")}),!1}return!0}}return t.\u0275fac=function(e){return new(e||t)(He(kr),He(Fn),He(Oi))},t.\u0275cmp=Xt({type:t,selectors:[["chat-message"]],viewQuery:function(e,i){if(1&e&&cn(vW,5),2&e){let r;ln(r=un())&&(i.editElm=r.first)}},inputs:{chatMessage:"chatMessage",compact:"compact"},features:[gi([{provide:L2,useValue:!1}])],decls:20,vars:36,consts:[[1,"container",3,"ngClass"],[1,"message",3,"ngClass"],[4,"ngIf"],[1,"body"],[1,"text","msg-text",3,"ngClass"],[4,"ngIf","ngIfThen","ngIfElse"],["image",""],["title",""],["visible",""],["secret",""],["editor",""],[4,"ngTemplateOutlet"],[1,"image",3,"ngClass"],[1,"aura",3,"ngClass"],["draggable","false",3,"src","ngClass",4,"ngIf"],["draggable","false",3,"src","ngClass"],[1,"title"],[1,"msg-name"],[3,"ngClass"],[1,"tip","msg-timestamp"],["draggable","false","class","mini-icon",3,"src",4,"ngIf"],[2,"display","inline-block","margin","0px 6px","user-select","none","transform","rotateY(180deg)"],["draggable","false",1,"mini-icon",3,"src"],[2,"display","inline-block","margin","0px 6px","user-select","none"],["class","tip msg-from",3,"innerHTML","click",4,"ngIf"],["class","tip msg-timestamp",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"tip","msg-from",3,"innerHTML","click"],["style","position: relative",4,"ngIf"],[2,"display","inline-block"],[3,"innerHTML","click"],["class","is-edited",4,"ngIf"],["style","padding-top: 1px; padding-bottom: 1px; margin-left: 3px;",3,"click",4,"ngIf"],[2,"position","relative"],["aria-hidden","true",2,"visibility","hidden","display","inline-block"],[2,"position","absolute","top","0px","left","0px","width","100%","height","100%",3,"ngModel","ngModelChange","keydown.enter","keydown.escape"],["edit",""],[1,"is-edited"],[2,"white-space","nowrap"],[2,"padding-top","1px","padding-bottom","1px","margin-left","3px",3,"click"],[1,"edit-buttons",2,"margin-left","4px","white-space","nowrap"],["class","edit-button","title","\u7de8\u96c6",3,"click",4,"ngIf"],["class","edit-button","aria-hidden","true","style","visibility: hidden",4,"ngIf"],["class","edit-button","title","\u78ba\u5b9a",3,"disabled","click",4,"ngIf"],["class","edit-button","title","\u30ad\u30e3\u30f3\u30bb\u30eb",3,"click",4,"ngIf"],["title","\u7de8\u96c6",1,"edit-button",3,"click"],[1,"material-icons","small-font"],["aria-hidden","true",1,"edit-button",2,"visibility","hidden"],["title","\u78ba\u5b9a",1,"edit-button",3,"disabled","click"],["title","\u30ad\u30e3\u30f3\u30bb\u30eb",1,"edit-button",3,"click"]],template:function(e,i){if(1&e&&(Q(0,"div",0)(1,"div",1),Te(2,yW,2,1,"ng-container",2),Q(3,"div",3),Te(4,xW,2,1,"ng-container",2),Q(5,"div",4),Te(6,wW,1,0,"ng-container",5),ie(),Te(7,TW,2,1,"div",2),Te(8,IW,2,1,"ng-container",2),ie(),Te(9,MW,2,1,"ng-container",2),ie()(),Te(10,FW,3,15,"ng-template",null,6,Un),Te(12,qW,8,10,"ng-template",null,7,Un),Te(14,ZW,7,11,"ng-template",null,8,Un),Te(16,XW,3,0,"ng-template",null,9,Un),Te(18,nK,5,6,"ng-template",null,10,Un)),2&e){const r=Kt(15),s=Kt(17);re("ngClass",Yt(21,iK,i.isCompact,i.isEditing)),U(1),Qe("border-left-color",!i.chatMessage.isSystem||i.chatMessage.isDicebot||i.chatMessage.isCalculate?i.chatMessage.color:"#444444")("border-right-color",!i.chatMessage.isSystem||i.chatMessage.isDicebot||i.chatMessage.isCalculate?i.chatMessage.color:"#444444"),re("ngClass",km(24,rK,i.isMine,!i.isMine,i.chatMessage.isDirect||i.chatMessage.isSecret,i.chatMessage.isSystem,i.chatMessage.isDicebot||i.chatMessage.isCalculate,i.chatMessage.isOperationLog))("@flyInOut",i.isMine?null:"active")("@flyInOutMe",i.isMine?"active":null),U(1),re("ngIf",i.isMine&&!i.isCompact),U(1),Qe("justify-content",i.isCompact&&!i.isMine?"flex-end":"flex-start"),U(1),re("ngIf",!i.isCompact||i.isMine),U(1),Qe("flex-grow",i.isCompact&&!i.isEditing?0:1),re("ngClass",co(31,sK,(!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf)&&i.chatMessage.isSuccess,(!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf)&&i.chatMessage.isFailure,(!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf)&&i.chatMessage.isCritical,(!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf)&&i.chatMessage.isFumble)),U(1),re("ngIf",!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf||i.chatMessage.isGMMode)("ngIfThen",r)("ngIfElse",s),U(1),re("ngIf",i.isEditable&&i.isCompact),U(1),re("ngIf",i.isCompact&&!i.isMine),U(1),re("ngIf",!i.isMine&&!i.isCompact)}},directives:[Yn,bn,Sl,mi,$i,di],pipes:[ai,_2],styles:['[_nghost-%COMP%]{display:block}.container[_ngcontent-%COMP%]{width:100%;overflow-x:hidden;box-sizing:border-box}.message[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;box-sizing:border-box;padding:5px;width:100%;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;border-bottom:1px dotted #999}.is-mine.message[_ngcontent-%COMP%]{border-left:4px solid #555}.is-others.message[_ngcontent-%COMP%]{border-right:4px solid #555}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc;border-bottom:1px dotted #CCC}.is-mine.direct-message[_ngcontent-%COMP%]{border-left:4px solid #555}.is-others.direct-message[_ngcontent-%COMP%]{border-right:4px solid #555}.operation-log[_ngcontent-%COMP%]{color:#666;background-color:#cccc}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{padding:0;width:50px;height:50px;flex-shrink:0;vertical-align:top;pointer-events:none}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img.face-icon[_ngcontent-%COMP%]{border-radius:.5rem}.message[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{flex-grow:1}.message[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{vertical-align:top;font-size:14px;padding-left:12px;padding-right:12px}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.message[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{vertical-align:top;padding:2px 12px 0;font-size:14px}.message[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{font-size:8px;padding-left:12px}.msg-name[_ngcontent-%COMP%]{font-weight:700}.msg-text[_ngcontent-%COMP%]{white-space:pre-wrap}.dicebot-message[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%]{font-size:8px}.dicebot-message[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{color:#11f}.direct-message.dicebot-message[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{color:#ccf}.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-success[_ngcontent-%COMP%]{color:#17f}.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-failure[_ngcontent-%COMP%]{color:#f05}.direct-message.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-success[_ngcontent-%COMP%]{color:#adf}.direct-message.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-failure[_ngcontent-%COMP%]{color:#f66}.dicebot-message[_ngcontent-%COMP%]{border-left:4px transparent}.dicebot-message[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%], .dicebot-message[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%], .operation-log[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%], .operation-log[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{font-style:oblique}.is-others[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .is-others[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{text-align:right}.is-others[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-align:left;max-width:100%}.is-edited[_ngcontent-%COMP%]{margin-left:2px;font-size:8px;vertical-align:bottom}.is-edited[_ngcontent-%COMP%]:before{content:"("}.is-edited[_ngcontent-%COMP%]:after{content:")"}.edit-button[_ngcontent-%COMP%]{padding:0 6px;vertical-align:10%;margin:0 1px 0 0}.edit-buttons[_ngcontent-%COMP%]{visibility:hidden}.container[_ngcontent-%COMP%]:hover   .edit-buttons[_ngcontent-%COMP%]{visibility:visible}textarea[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,"M+ 1p",sans-serif;margin:-3px;font-size:14px;resize:none}.small-font[_ngcontent-%COMP%]{font-size:14px;vertical-align:bottom}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #00f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 6px #ccc) drop-shadow(0 -4px 4px #fff)}.msg-timestamp[_ngcontent-%COMP%]{white-space:nowrap}.container.compact[_ngcontent-%COMP%]{overflow:hidden}.container.compact.editing[_ngcontent-%COMP%]{padding-top:1px}.container.compact[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{padding:2px!important}.container.compact[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap}.container.compact[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{min-width:6em}.container.compact[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .container.compact[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .container.compact[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{padding:0 3px;text-align:left}.container.compact[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%]{flex-grow:0}.container.compact[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{flex-grow:1}.container.compact[_ngcontent-%COMP%]   .edit-buttons[_ngcontent-%COMP%]{display:none}.container.compact[_ngcontent-%COMP%]:hover   .edit-buttons[_ngcontent-%COMP%], .container.compact.editing[_ngcontent-%COMP%]   .edit-buttons[_ngcontent-%COMP%]{display:inline-block}.container.compact[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{margin:-3px}.grow[_ngcontent-%COMP%]{text-shadow:1px 0px 1px #ffffff,0px 1px 1px #ffffff,-1px 0px 1px #ffffff,0px -1px 1px #ffffff}.mini-icon[_ngcontent-%COMP%]{display:inline-block;padding:0;width:1rem;height:1rem;vertical-align:middle;border-radius:.2rem;-o-object-fit:cover;object-fit:cover;margin-right:2px;filter:drop-shadow(1px 1px 1px #ffffff) drop-shadow(-1px -1px 1px #ffffff)}'],data:{animation:[Sn("flyInOut",[Lt("* => active",[Rt("200ms ease-out",sn([et({transform:"translateX(100px)",opacity:"0",offset:0}),et({transform:"translateX(0)",opacity:"1",offset:1})]))]),Lt("void => *",[Rt("200ms ease-out",sn([et({opacity:"0",offset:0}),et({opacity:"1",offset:1})]))])]),Sn("flyInOutMe",[Lt("* => active",[Rt("200ms ease-out",sn([et({transform:"translateX(-100px)",opacity:"0",offset:0}),et({transform:"translateX(0)",opacity:"1",offset:1})]))]),Lt("void => *",[Rt("200ms ease-out",sn([et({opacity:"0",offset:0}),et({opacity:"1",offset:1})]))])])]}}),t})();const aK=["logContainer"],lK=["messageContainer"];function cK(t,n){if(1&t&&ot(0,"chat-message",7),2&t){const e=_e().$implicit,i=_e(2);re("chatMessage",e)("compact",i.compact)("@.disabled",i.compact||e.isAnimated)}}function uK(t,n){if(1&t&&(Ke(0),Te(1,cK,1,3,"chat-message",6),Ye()),2&t){const e=n.$implicit;U(1),re("ngIf",e.isDisplayable)}}function dK(t,n){if(1&t&&(Ke(0),Te(1,uK,2,1,"ng-container",5),Ye()),2&t){const e=_e();U(1),re("ngForOf",e.chatMessages)("ngForTrackBy",e.trackByChatMessage)}}function fK(t,n){if(1&t&&ot(0,"chat-message",7),2&t){const e=n.$implicit,i=_e(2);re("chatMessage",e)("compact",i.compact)("@.disabled",i.compact||e.isAnimated)}}function hK(t,n){if(1&t&&(Ke(0),Te(1,fK,1,3,"chat-message",8),Ye()),2&t){const e=_e();U(1),re("ngForOf",e.sampleMessages)}}const Iv=window.navigator.userAgent.toLowerCase(),XS=Iv.indexOf("iphone")>-1||Iv.indexOf("ipad")>-1||Iv.indexOf("macintosh")>-1&&"ontouchend"in document;let pK=(()=>{class t{constructor(e,i,r){this.ngZone=e,this.changeDetector=i,this.panelService=r,this.compact=!1,this.sampleMessages=[{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",tag:"mine",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u30b5\u30fc\u30d0\u30fc\u3092\u4f7f\u7528\u3057\u306a\u3044TRPG\u30aa\u30f3\u30bb\u30c4\u30fc\u30eb\u3067\u3059\u3002\u53c2\u52a0\u8005\u540c\u58eb\u3067\u63a5\u7d9a\u3057\u3001\u30b3\u30de\u3084\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u306a\u3069\u3092\u540c\u671f\u3057\u307e\u3059\u3002"},{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",tag:"mine",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u5168\u3066\u306e\u30c7\u30fc\u30bf\u304c\u5404\u53c2\u52a0\u8005\u306e\u30d6\u30e9\u30a6\u30b6\u5185\u306b\u3042\u308b\u305f\u3081\u3001\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3092\u5b9f\u884c\u3057\u3066\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u3092\u751f\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u4fdd\u5b58\u3057\u305fzip\u306e\u8aad\u307f\u8fbc\u307f\u306f\u30d6\u30e9\u30a6\u30b6\u753b\u9762\u3078\u306e\u30d5\u30a1\u30a4\u30eb\u30c9\u30ed\u30c3\u30d7\u3067\u884c\u3048\u307e\u3059\u3002"},{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",toColor:"#444444",tag:"mine direct",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",toName:"\u30d7\u30ec\u30a4\u30e4\u30fc",text:"\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\uff08\u79d8\u5bc6\u4f1a\u8a71\uff09\u306f\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\u306b\u8a18\u9332\u3055\u308c\u307e\u305b\u3093\u3002"},{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",toColor:"#444444",tag:"mine direct",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",toName:"\u30d7\u30ec\u30a4\u30e4\u30fc",text:"\u307e\u305f\u3001\u904e\u53bb\u306e\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u3042\u306a\u305f\u306eID\u304c\u66f4\u65b0\u3055\u308c\u308b\u3068\u540c\u3058\u30eb\u30fc\u30e0\u5185\u3067\u3042\u3063\u3066\u3082\u898b\u3048\u306a\u304f\u306a\u308a\u307e\u3059\u3002\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002"},{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",tag:"mine",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u52d5\u4f5c\u63a8\u5968\u74b0\u5883\u306f\u30c7\u30b9\u30af\u30c8\u30c3\u30d7Chrome\u3067\u3059\u3002\u4eca\u306e\u3068\u3053\u308d\u3001\u30b9\u30de\u30db\u304b\u3089\u3060\u3068\u4e0a\u624b\u304f\u64cd\u4f5c\u3067\u304d\u307e\u305b\u3093\u3002"},{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",tag:"mine",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u4ee5\u4e0a\u3067\u3059\u3002\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u6700\u521d\u306e\u30c1\u30e3\u30c3\u30c8\u3092\u5165\u529b\u3059\u308b\u3068\u975e\u8868\u793a\u306b\u306a\u308a\u307e\u3059\u3002"}],this.topTimestamp=0,this.botomTimestamp=0,this.needUpdate=!0,this.topElm=null,this.bottomElm=null,this.topElmBox=null,this.bottomElmBox=null,this.topIndex=0,this.bottomIndex=0,this.preScrollTop=0,this.scrollSpeed=0,this._chatMessages=[],this.scrollEventShortTimer=null,this.scrollEventLongTimer=null,this.addMessageEventTimer=null,this.callbackOnScroll=()=>this.onScroll(),this.callbackOnScrollToBottom=()=>this.resetMessages(),this.onAddMessage=new Tn}get minMessageHeight(){if(this.compact)return 26;let e=this.chatTab.chatMessages[this.chatTab.chatMessages.length-1];return e&&e.isOperationLog?26:61}get chatMessages(){if(!this.chatTab)return[];if(this.needUpdate){this.needUpdate=!1;let e=this.chatTab?this.chatTab.chatMessages:[];this.adjustIndex(),this._chatMessages=e.slice(this.topIndex,this.bottomIndex+1),this.topTimestamp=0<this._chatMessages.length?this._chatMessages[0].timestamp:0,this.botomTimestamp=0<this._chatMessages.length?this._chatMessages[this._chatMessages.length-1].timestamp:0}return this._chatMessages}get minScrollHeight(){return this.chatTab.chatMessages.reduce((i,r)=>i+(r.isDisplayable?this.compact||r.isOperationLog?26:61:0),0)}get topSpace(){return this.minScrollHeight-this.bottomSpace}get bottomSpace(){return 0<this.chatMessages.length?(this.chatTab.chatMessages.length-this.bottomIndex-1)*this.minMessageHeight:0}get isEmpty(){return this.chatTab.chatMessages.every(e=>!e.isDisplayable)}ngOnInit(){let e=[];for(let i of this.sampleMessages){let r=new Qn;for(let s in i)if("identifier"!==s&&"tabIdentifier"!==s){if("text"===s){r.value=i[s];continue}null==i[s]||""===i[s]||r.setAttribute(s,i[s])}e.push(r)}this.sampleMessages=e,ze.register(this).on("MESSAGE_ADDED",i=>{let r=dt.instance.get(i.data.messageIdentifier);!r||!this.chatTab.contains(r)||this.topTimestamp<=r.timestamp&&(this.changeDetector.markForCheck(),this.needUpdate=!0,this.onMessageInit())}).on("UPDATE_GAME_OBJECT",i=>{let r=dt.instance.get(i.data.identifier);r&&r instanceof Qn&&this.topTimestamp<=r.timestamp&&r.timestamp<=this.botomTimestamp&&this.chatTab.contains(r)&&this.changeDetector.markForCheck()})}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.scrollEventShortTimer=new ha(()=>this.lazyScrollUpdate(),33),this.scrollEventLongTimer=new ha(()=>this.lazyScrollUpdate(!1),66),this.onScroll(),this.panelService.scrollablePanel.addEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.addEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1)})}ngOnDestroy(){ze.unregister(this),this.panelService.scrollablePanel.removeEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.removeEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1),this.scrollEventShortTimer.clear(),this.scrollEventLongTimer.clear(),this.addMessageEventTimer&&clearTimeout(this.addMessageEventTimer),this.addMessageEventTimer=null}ngOnChanges(){Promise.resolve().then(()=>this.resetMessages())}ngAfterViewChecked(){!this.topElm||!this.bottomElm||this.ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>this.adjustScrollPosition())})}onMessageInit(){null==this.addMessageEventTimer&&this.ngZone.runOutsideAngular(()=>{this.addMessageEventTimer=setTimeout(()=>{this.addMessageEventTimer=null,this.ngZone.run(()=>this.onAddMessage.emit())},0)})}resetMessages(){let e=this.chatTab.chatMessages.length-1;this.topIndex=e-Math.floor(this.panelService.scrollablePanel.clientHeight/this.minMessageHeight),this.bottomIndex=e,this.needUpdate=!0,this.preScrollTop=-1,this.scrollSpeed=0,this.topElm=this.bottomElm=null,this.adjustIndex(),this.changeDetector.markForCheck()}trackByChatMessage(e,i){return i.identifier}adjustIndex(){let e=this.chatTab?this.chatTab.chatMessages:[],i=0<e.length?e.length-1:0;this.topIndex<0&&(this.topIndex=0),i<this.bottomIndex&&(this.bottomIndex=i),this.topIndex<0&&(this.topIndex=0),this.bottomIndex<0&&(this.bottomIndex=0),i<this.topIndex&&(this.topIndex=i),i<this.bottomIndex&&(this.bottomIndex=i)}getScrollPosition(){let e=this.panelService.scrollablePanel.scrollTop,i=this.panelService.scrollablePanel.clientHeight,r=this.panelService.scrollablePanel.scrollHeight;return e<0&&(e=0),r-i<e&&(e=r-i),{top:e,bottom:e+i,clientHeight:i,scrollHeight:r}}adjustScrollPosition(){if(!this.topElm||!this.bottomElm)return;let e=this.logContainerRef.nativeElement.contains(this.topElm),i=this.logContainerRef.nativeElement.contains(this.bottomElm),{hasTopBlank:r,hasBotomBlank:s}=this.checkBlank(e,i);this.topElm=this.bottomElm=null,(r||s||!e&&!i)&&Sr(()=>this.lazyScrollUpdate())}checkBlank(e,i){let r=!e,s=!i;if(!e&&!i)return{hasTopBlank:r,hasBotomBlank:s};let o=null,a=null,h=null,w=0;i?(o=this.bottomElm,a=this.bottomElmBox):e&&(o=this.topElm,a=this.topElmBox),h=o.getBoundingClientRect(),w=a.top-h.top-this.scrollSpeed,(!r||!s)&&.25<w**2&&(this.panelService.scrollablePanel.scrollTop-=w);let X=this.logContainerRef.nativeElement.getBoundingClientRect(),fe=this.messageContainerRef.nativeElement.getBoundingClientRect(),pe=fe.top-X.top,we=pe+fe.height,Ie=this.getScrollPosition();return r=Ie.top<pe,s=we<Ie.bottom&&Ie.bottom<Ie.scrollHeight,{hasTopBlank:r,hasBotomBlank:s}}markForReadIfNeeded(){if(!this.chatTab.hasUnread)return;let e=this.getScrollPosition();e.scrollHeight<=e.bottom+100&&Sr(()=>{this.chatTab.markForRead(),this.changeDetector.markForCheck(),this.ngZone.run(()=>{})})}onScroll(){this.scrollEventShortTimer.reset(),this.scrollEventLongTimer.isActive||this.scrollEventLongTimer.reset()}lazyScrollUpdate(e=!0){this.scrollEventShortTimer.stop(),this.scrollEventLongTimer.stop();let i=this.messageContainerRef.nativeElement.querySelectorAll("chat-message"),r=this.messageContainerRef.nativeElement.offsetTop,s=r+this.messageContainerRef.nativeElement.clientHeight,o=this.topIndex,a=this.bottomIndex,h=this.getScrollPosition();this.scrollSpeed=h.top-this.preScrollTop,this.preScrollTop=h.top;let w=h.top<r,X=s<h.bottom&&h.bottom<h.scrollHeight;if(e||this.scrollEventShortTimer.reset(),!e&&!w&&!X)return;let fe=h.top-(!e&&w?100:1200),pe=h.bottom+(!e&&X?100:1200);this.markForReadIfNeeded(),this.calcItemIndexRange(r,s,fe,pe,h,i),(this.topIndex!=o||this.bottomIndex!=a)&&(this.needUpdate=!0,this.topElm=i[0],this.bottomElm=i[i.length-1],this.topElmBox=this.topElm.getBoundingClientRect(),this.bottomElmBox=this.bottomElm.getBoundingClientRect(),Sr(()=>{let Ie=this.getScrollPosition();this.scrollSpeed=Ie.top-this.preScrollTop,this.preScrollTop=Ie.top,this.changeDetector.markForCheck(),this.ngZone.run(()=>{})}))}calcElementMaxHeight(e){let i=this.minMessageHeight;for(let r=e.length-1;0<=r;r--){let s=e[r].clientHeight;i<s&&(i=s)}return i}calcItemIndexRange(e,i,r,s,o,a){if(r>=i||e>=s)this.bottomIndex=this.chatTab.chatMessages.length-1-Math.floor((o.scrollHeight-o.top-o.clientHeight)/this.minMessageHeight),this.topIndex=this.bottomIndex-Math.floor(o.clientHeight/this.minMessageHeight),this.bottomIndex+=1,this.topIndex-=1;else{let h=this.calcElementMaxHeight(a);r<e?this.topIndex-=Math.floor((e-r)/h)+1:r>e&&(XS||(this.topIndex+=Math.floor((r-e)/h))),i>s?XS||(this.bottomIndex-=Math.floor((i-s)/h)):i<s&&(this.bottomIndex+=Math.floor((s-i)/h)+1)}this.adjustIndex()}}return t.\u0275fac=function(e){return new(e||t)(He(Cn),He(Oi),He(An))},t.\u0275cmp=Xt({type:t,selectors:[["chat-tab"]],viewQuery:function(e,i){if(1&e&&(cn(aK,7),cn(lK,7)),2&e){let r;ln(r=un())&&(i.logContainerRef=r.first),ln(r=un())&&(i.messageContainerRef=r.first)}},inputs:{compact:"compact",chatTab:"chatTab"},outputs:{onAddMessage:"onAddMessage"},features:[io],decls:6,vars:6,consts:[[1,"log"],["logContainer",""],[1,"virtual-scroll-container"],["messageContainer",""],[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"chatMessage","compact",4,"ngIf"],[3,"chatMessage","compact"],[3,"chatMessage","compact",4,"ngFor","ngForOf"]],template:function(e,i){1&e&&(Q(0,"div",0,1)(2,"div",2,3),Te(4,dK,2,2,"ng-container",4),Te(5,hK,2,1,"ng-container",4),ie()()),2&e&&(Qe("min-height",i.minScrollHeight,"px"),U(2),Qe("margin-bottom",i.bottomSpace,"px"),U(2),re("ngIf",!i.isEmpty),U(1),re("ngIf",i.isEmpty))},directives:[bn,oi,oK],styles:["[_nghost-%COMP%]{display:block}.log[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:flex-end;align-items:flex-end;width:100%;height:100%}.virtual-scroll-container[_ngcontent-%COMP%]{flex-shrink:0;width:100%}"],changeDetection:0}),t})();const gK=["chatTabComponemt"];function _K(t,n){if(1&t){const e=it();Q(0,"chat-tab",13,14),Ae("onAddMessage",function(){return Oe(e),_e().scrollToBottom()}),ie()}if(2&t){const e=_e();re("chatTab",e.chatTab)("compact",e.isCompact)}}function mK(t,n){1&t&&(Q(0,"div"),ye(1,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u306e\u5185\u5bb9\u304c\u66f4\u65b0\u3055\u308c\u307e\u3057\u305f\u3002\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u9078\u629e\u3057\u306a\u304a\u3059\u304b\u3001\u3053\u306e\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u958b\u304d\u306a\u304a\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),ie())}function $K(t,n){1&t&&(Q(0,"i",8),ye(1,"how_to_reg"),ie())}function vK(t,n){1&t&&(Q(0,"i",8),ye(1,"history_edu"),ie())}function bK(t,n){1&t&&ot(0,"badge",19),2&t&&re("count",_e().$implicit.unreadLength)}function yK(t,n){if(1&t){const e=it();Q(0,"label",15)(1,"input",16),Ae("ngModelChange",function(r){return Oe(e),_e().chatTabidentifier=r}),ie(),Q(2,"div")(3,"span"),ye(4),ie(),Te(5,$K,2,0,"i",17),Te(6,vK,2,0,"i",17),Te(7,bK,1,1,"badge",18),ie()()}if(2&t){const e=n.$implicit,i=_e();U(1),ht("value",e.identifier),re("ngModel",i.chatTabidentifier),U(2),Qe("cursor",i.chatTabidentifier!=e.identifier?"pointer":"")("color",""==e.name&&i.chatTabidentifier!=e.identifier?"gray":""),U(1),Xe(""==e.name?"(\u7121\u540d\u306e\u30bf\u30d6)":e.name),U(1),re("ngIf",e.isUseStandImage),U(1),re("ngIf",e.recieveOperationLogLevel>0),U(1),re("ngIf",e.hasUnread)}}let QS=(()=>{class t{constructor(e,i,r){this.chatMessageService=e,this.panelService=i,this.pointerDeviceService=r,this.sendFrom="Guest",this._isCompact=!1,this._chatTabidentifier="",this.isAutoScroll=!0,this.scrollToBottomTimer=null}get isCompact(){return this._isCompact}set isCompact(e){this._isCompact=e,this.chatTabComponemt.onScroll()}get gameType(){return this.chatMessageService.gameType?this.chatMessageService.gameType:"DiceBot"}set gameType(e){this.chatMessageService.gameType=e}get chatTabidentifier(){return this._chatTabidentifier}set chatTabidentifier(e){let i=this._chatTabidentifier!==e;this._chatTabidentifier=e,this.updatePanelTitle(),i&&this.scrollToBottom(!0)}get chatTab(){return dt.instance.get(this.chatTabidentifier)}ngOnInit(){this.sendFrom=We.myCursor.identifier,this._chatTabidentifier=0<this.chatMessageService.chatTabs.length?this.chatMessageService.chatTabs[0].identifier:"",ze.register(this).on("MESSAGE_ADDED",e=>{if(e.data.tabIdentifier!==this.chatTabidentifier)return;let i=dt.instance.get(e.data.messageIdentifier);i&&i.isSendFromSelf?this.isAutoScroll=!0:this.checkAutoScroll(),this.isAutoScroll&&this.chatTab&&this.chatTab.markForRead()}),Promise.resolve().then(()=>this.updatePanelTitle())}ngAfterViewInit(){queueMicrotask(()=>this.scrollToBottom(!0))}ngOnDestroy(){ze.unregister(this)}scrollToBottom(e=!1){if(e&&(this.isAutoScroll=!0),!this.isAutoScroll)return;let i=new CustomEvent("scrolltobottom",{});this.panelService.scrollablePanel.dispatchEvent(i),null==this.scrollToBottomTimer&&(this.scrollToBottomTimer=setTimeout(()=>{this.chatTab&&this.chatTab.markForRead(),this.scrollToBottomTimer=null,this.isAutoScroll=!1,this.panelService.scrollablePanel&&(this.panelService.scrollablePanel.scrollTop=this.panelService.scrollablePanel.scrollHeight)},0))}checkAutoScroll(){this.panelService.scrollablePanel&&(this.isAutoScroll=this.panelService.scrollablePanel.scrollHeight-this.panelService.scrollablePanel.clientHeight-150<=this.panelService.scrollablePanel.scrollTop)}updatePanelTitle(){this.panelService.title=this.chatTab&&""!==this.chatTab.name?"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6 - "+this.chatTab.name:"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6"}onSelectedTab(e){this.updatePanelTitle()}showTabSetting(){let e=this.pointerDeviceService.pointers[0];this.panelService.open($W,{left:e.x-250,top:e.y-175,width:460,height:330}).selectedTab=this.chatTab}showLogOutput(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(ZS,{left:e.x-250,top:e.y-175,width:460,height:300}).selectedTab=this.chatTab}sendChat(e){this.chatTab&&this.chatMessageService.sendMessage(this.chatTab,e.text,e.gameType,e.sendFrom,e.sendTo,e.color,e.isInverse,e.isHollow,e.isBlackPaint,e.aura,e.isUseFaceIcon,e.characterIdentifier,e.standIdentifier,e.standName,e.isUseStandImage)}trackByChatTab(e,i){return i.identifier}}return t.\u0275fac=function(e){return new(e||t)(He(kr),He(An),He(fi))},t.\u0275cmp=Xt({type:t,selectors:[["chat-window"]],viewQuery:function(e,i){if(1&e&&cn(gK,5),2&e){let r;ln(r=un())&&(i.chatTabComponemt=r.first)}},decls:23,vars:10,consts:[[1,"component"],[1,"log"],[3,"chatTab","compact","onAddMessage",4,"ngIf"],[4,"ngIf"],[1,"sticky-bottom"],[1,"chat-tab"],["class","tab",4,"ngFor","ngForOf","ngForTrackBy"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[1,"small-font",2,"float","right","padding","1px 4px 1px 2px","margin-left","2px","height","24px","box-sizing","border-box"],["name","isCompact","type","checkbox",3,"ngModel","value","checked","ngModelChange"],[2,"color","red"],[3,"chatTabidentifier","gameType","sendFrom","gameTypeChange","sendFromChange","chat"],[3,"chatTab","compact","onAddMessage"],["chatTabComponemt",""],[1,"tab"],["name","chat-tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],["class","material-icons small-font",4,"ngIf"],["class","badge",3,"count",4,"ngIf"],[1,"badge",3,"count"]],template:function(e,i){1&e&&(Q(0,"div",0)(1,"div",1),Te(2,_K,2,2,"chat-tab",2),Te(3,mK,2,0,"div",3),ie(),Q(4,"div",4)(5,"form")(6,"div",5),Te(7,yK,8,10,"label",6),Q(8,"button",7),Ae("click",function(){return i.showTabSetting()}),Q(9,"i",8),ye(10,"settings"),ie(),ye(11,"\u30bf\u30d6\u8a2d\u5b9a"),ie(),Q(12,"button",7),Ae("click",function(){return i.showLogOutput()}),Q(13,"i",8),ye(14,"history_edu"),ie(),ye(15,"\u30ed\u30b0"),ie(),Q(16,"label",9)(17,"input",10),Ae("ngModelChange",function(s){return i.isCompact=s}),ie(),Q(18,"b"),ye(19,"\u7c21\u6613\u8868\u793a"),Q(20,"sup",11),ye(21,"*"),ie()()()()(),Q(22,"chat-input",12),Ae("gameTypeChange",function(s){return i.gameType=s})("sendFromChange",function(s){return i.sendFrom=s})("chat",function(s){return i.sendChat(s)}),ie()()()),2&e&&(U(2),re("ngIf",i.chatTab),U(1),re("ngIf",!i.chatTab),U(4),re("ngForOf",i.chatMessageService.chatTabs)("ngForTrackBy",i.trackByChatTab),U(10),re("ngModel",i.isCompact)("value",!0)("checked",i.isCompact),U(5),re("chatTabidentifier",i.chatTabidentifier)("gameType",i.gameType)("sendFrom",i.sendFrom))},directives:[bn,pK,Ml,kl,la,oi,Oa,mi,$i,di,Ld,Jr,nr],styles:["[_nghost-%COMP%]{display:block;height:100%}.loop-anime[_ngcontent-%COMP%]{animation:anime1 1.3s infinite ease-in-out}.component[_ngcontent-%COMP%]{min-height:100%;display:flex;flex-direction:column;justify-content:space-between;align-content:space-between}.sticky-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;width:100%;background-color:#f0dabdcc;border-top:1px dotted #666;margin-bottom:0}.chat-tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 4px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}label.compact[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.tab[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{vertical-align:top;font-size:.8rem}"]}),t})();const CK=["root"],xK=["altitudeSlider"];function wK(t,n){if(1&t){const e=it();Q(0,"span",12),ye(1," (\u9ad8\u5ea6 "),Q(2,"input",13),Ae("ngModelChange",function(r){return Oe(e),_e(2).altitudeHande.altitude=r}),ie(),ye(3,")"),ie()}if(2&t){const e=_e(2);U(2),re("ngModel",e.altitudeHande.altitude)}}function EK(t,n){if(1&t&&(Q(0,"div")(1,"div",10),ye(2),Te(3,wK,4,1,"span",11),ie()()),2&t){const e=_e();U(1),Qe("color",e.titleColor)("font-weight",e.titleBold?"bolder":"normal"),U(1),Xe(e.title),U(1),re("ngIf",e.altitudeHande)}}function TK(t,n){1&t&&(Q(0,"div",14)(1,"div",15),ye(2,"\u9ad8"),ie(),Q(3,"div",16),ye(4,"0"),ie(),Q(5,"div",17),ye(6,"\u4f4e"),ie()())}function SK(t,n){if(1&t){const e=it();Q(0,"div",18)(1,"input",19,20),Ae("ngModelChange",function(r){return Oe(e),_e().altitudeHande.altitude=r}),ie()()}if(2&t){const e=_e();U(1),ht("title",e.altitudeHande.altitude),re("ngModel",e.altitudeHande.altitude)}}function IK(t,n){1&t&&_n(0)}const kK=function(t){return{action:t}};function MK(t,n){if(1&t&&(Ke(0),Te(1,IK,1,0,"ng-container",21),Ye()),2&t){const e=_e().$implicit;_e();const i=Kt(12),r=Kt(10);U(1),re("ngTemplateOutlet","separator"===(null==e?null:e.type)?i:r)("ngTemplateOutletContext",ft(2,kK,e))}}function DK(t,n){if(1&t&&(Ke(0),Te(1,MK,2,4,"ng-container",2),Ye()),2&t){const e=n.$implicit;U(1),re("ngIf",e)}}function AK(t,n){1&t&&(Q(0,"span",43),ye(1,"\u26a0\ufe0f"),ie()),2&t&&ht("title",_e().action.error)}function PK(t,n){1&t&&ot(0,"input",44),2&t&&re("disabled",_e().action.disabled)}function NK(t,n){1&t&&ot(0,"input",45),2&t&&re("disabled",_e().action.disabled)}function FK(t,n){1&t&&ot(0,"input",46),2&t&&re("disabled",_e().action.disabled)}function OK(t,n){1&t&&ot(0,"input",47),2&t&&re("disabled",_e().action.disabled)}function RK(t,n){1&t&&(Q(0,"span",48),ye(1,"\u25a0"),ie())}function BK(t,n){1&t&&(Q(0,"span",49),ye(1,"\u25a0"),ie())}function LK(t,n){1&t&&(Q(0,"span",50),ye(1,"\u25a0"),ie())}function zK(t,n){1&t&&(Q(0,"span",51),ye(1,"\u25a0"),ie())}function jK(t,n){1&t&&(Q(0,"span",52),ye(1,"\u25a0"),ie())}function HK(t,n){1&t&&(Q(0,"span",53),ye(1,"\u25a0"),ie())}function UK(t,n){1&t&&(Q(0,"span",54),ye(1,"\u25a0"),ie())}function VK(t,n){1&t&&(Q(0,"span",55),ye(1,"\u25a0"),ie())}function GK(t,n){if(1&t&&(Q(0,"span",56)(1,"i",57),ye(2),ie()()),2&t){const e=_e().action;U(2),Xe(e.materialIcon)}}function qK(t,n){1&t&&(Q(0,"sup",58),ye(1,"*"),ie())}function WK(t,n){if(1&t&&(Q(0,"span",59),ot(1,"img",60),Et(2,"safe"),ie()),2&t){const e=_e().action;U(1),re("src",Tt(2,1,e.icon.url,"resourceUrl"),en)}}function KK(t,n){1&t&&(Q(0,"i",61),ye(1,"open_in_new"),ie())}function YK(t,n){1&t&&(Q(0,"div",62)(1,"i",63),ye(2,"arrow_forward_ios"),ie()())}function ZK(t,n){if(1&t&&ot(0,"context-menu",64),2&t){const e=_e().action,i=_e();re("title",e.name)("actions",i.subMenu)("isSubmenu",!0)}}const XK=function(t,n){return{hasHighlight:t,disabled:n}},QK=function(t,n){return{"icon-menu":t,default:n}};function JK(t,n){if(1&t){const e=it();Q(0,"li",22),Ae("click",function(){const s=Oe(e).action,o=_e();return!(s.disabled||s.altitudeHande&&0==s.altitudeHande.altitude)&&o.doAction(s)})("mouseenter",function(){const s=Oe(e).action,o=_e();return!(s.disabled||s.altitudeHande&&0==s.altitudeHande.altitude)&&o.showSubMenu(s)}),Q(1,"div",23),Te(2,AK,2,1,"span",24),Te(3,PK,1,1,"input",25),Te(4,NK,1,1,"input",26),Te(5,FK,1,1,"input",27),Te(6,OK,1,1,"input",28),Te(7,RK,2,0,"span",29),Te(8,BK,2,0,"span",30),Te(9,LK,2,0,"span",31),Te(10,zK,2,0,"span",32),Te(11,jK,2,0,"span",33),Te(12,HK,2,0,"span",34),Te(13,UK,2,0,"span",35),Te(14,VK,2,0,"span",36),Te(15,GK,3,1,"span",37),ye(16),Te(17,qK,2,0,"sup",38),Te(18,WK,3,4,"span",39),Te(19,KK,2,0,"i",40),ie(),Te(20,YK,3,0,"div",41),Te(21,ZK,1,3,"context-menu",42),ie()}if(2&t){const e=n.action,i=_e();Qe("padding-left",e.icon?0:(e.level?e.level+1.5:1.5)-(i.altitudeHande?.5:0),"em")("color",e.color?e.color:"")("text-align",e.center?"center":""),re("ngClass",Yt(28,XK,!(e.disabled||e.icon||e.altitudeHande&&0==e.altitudeHande.altitude),e.disabled||e.altitudeHande&&0==e.altitudeHande.altitude)),U(1),re("ngClass",Yt(31,QK,e.icon,e.default)),U(1),re("ngIf",e.error),U(1),re("ngIf",e.name&&0==e.name.indexOf("\u2611")),U(1),re("ngIf",e.name&&0==e.name.indexOf("\u2610")),U(1),re("ngIf",e.name&&0==e.name.indexOf("\u25c9")),U(1),re("ngIf",e.name&&0==e.name.indexOf("\u25cb")),U(1),re("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30d6\u30e9\u30c3\u30af")),U(1),re("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30d6\u30eb\u30fc")),U(1),re("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30b0\u30ea\u30fc\u30f3")),U(1),re("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30b7\u30a2\u30f3")),U(1),re("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30ec\u30c3\u30c9")),U(1),re("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30de\u30bc\u30f3\u30bf")),U(1),re("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30a4\u30a8\u30ed\u30fc")),U(1),re("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30db\u30ef\u30a4\u30c8")),U(1),re("ngIf",e.materialIcon),U(1),Rn(" ",e.name.replace("\u2611","").replace("\u2610","").replace("\u25c9","").replace("\u25cb",""),""),U(1),re("ngIf",e.selfOnly),U(1),re("ngIf",e.icon&&0<(null==e.icon?null:e.icon.url.length)),U(1),re("ngIf",e.isOuterLink),U(1),re("ngIf",e.subActions&&!e.disabled),U(1),re("ngIf",i.subMenu&&i.parentMenu===e)}}function eY(t,n){1&t&&(Q(0,"li"),ot(1,"hr",65),ie())}const tY=function(t,n,e,i){return{"icons-panel":t,"submenu-panel":n,"is-max-limit":e,"pointer-events-none":i}};let nY=(()=>{class t{constructor(e,i,r){this.elementRef=e,this.contextMenuService=i,this.pointerDeviceService=r,this.title="",this.actions=[],this.titleColor=We.CHAT_DEFAULT_COLOR,this.titleBold=!1,this.isSubmenu=!1,this.callbackOnOutsideClick=s=>this.onOutsideClick(s)}get isPointerDragging(){return this.pointerDeviceService.isDragging}get altitudeHande(){for(let e of this.actions)if(e&&e.altitudeHande)return e.altitudeHande;return null}get isIconsMenu(){for(let e of this.actions)if(!e||!e.icon)return!1;return!0}ngOnInit(){this.isSubmenu||(this.title=this.contextMenuService.title,this.actions=this.contextMenuService.actions,this.titleColor=this.contextMenuService.titleColor,this.titleBold=this.contextMenuService.titleBold)}ngAfterViewInit(){this.isSubmenu?this.adjustPositionSub():(this.adjustPositionRoot(),document.addEventListener("touchstart",this.callbackOnOutsideClick,!0),document.addEventListener("mousedown",this.callbackOnOutsideClick,!0))}ngOnDestroy(){document.removeEventListener("touchstart",this.callbackOnOutsideClick,!0),document.removeEventListener("mousedown",this.callbackOnOutsideClick,!0)}onOutsideClick(e){!1===this.rootElementRef.nativeElement.contains(e.target)&&this.close()}onContextMenu(e){e.stopPropagation(),e.preventDefault()}adjustPositionRoot(){let e=this.rootElementRef.nativeElement;e.style.left=this.contextMenuService.position.x+"px",e.style.top=this.contextMenuService.position.y+"px";let i=e.getBoundingClientRect(),r=0,s=0;window.innerWidth<i.right+r&&(r+=window.innerWidth-(i.right+r)),i.left+r<0&&(r+=0-(i.left+r)),window.innerHeight<i.bottom+s&&(s+=window.innerHeight-(i.bottom+s)),i.top+s<0&&(s+=0-(i.top+s)),e.style.left=e.offsetLeft+r+"px",e.style.top=e.offsetTop+s+"px",this.altitudeSlider&&(this.altitudeSlider.nativeElement.style.height=e.clientHeight-72+"px")}adjustPositionSub(){let i=this.rootElementRef.nativeElement,r=this.elementRef.nativeElement.parentElement.getBoundingClientRect(),s=i.getBoundingClientRect(),o=0,a=0;window.innerWidth<s.right+o&&(o-=r.width+s.width,o+=8),s.left+o<0&&(o+=0-(s.left+o)),window.innerHeight<s.bottom+a&&(a+=window.innerHeight-(s.bottom+a)),s.top+a<0&&(a+=0-(s.top+a)),i.style.left=i.offsetLeft+o+"px",i.style.top=i.offsetTop+a+"px"}doAction(e){this.showSubMenu(e),null!=e.action&&(e.action(),this.close())}showSubMenu(e){this.hideSubMenu(),clearTimeout(this.showSubMenuTimer),!(null==e.subActions||e.subActions.length<1)&&(this.showSubMenuTimer=setTimeout(()=>{this.parentMenu=e,this.subMenu=e.subActions,clearTimeout(this.hideSubMenuTimer)},250))}hideSubMenu(){clearTimeout(this.hideSubMenuTimer),this.hideSubMenuTimer=setTimeout(()=>{this.subMenu=null},1200)}close(){this.contextMenuService&&this.contextMenuService.close()}}return t.\u0275fac=function(e){return new(e||t)(He(yi),He(lr),He(fi))},t.\u0275cmp=Xt({type:t,selectors:[["context-menu"]],viewQuery:function(e,i){if(1&e&&(cn(CK,7),cn(xK,5)),2&e){let r;ln(r=un())&&(i.rootElementRef=r.first),ln(r=un())&&(i.altitudeSlider=r.first)}},hostBindings:function(e,i){1&e&&Ae("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{title:"title",actions:"actions",titleColor:"titleColor",titleBold:"titleBold",isSubmenu:"isSubmenu"},decls:13,vars:10,consts:[[1,"component",2,"display","flex","flex-direction","column",3,"ngClass","mouseleave"],["root",""],[4,"ngIf"],[2,"display","flex","align-items","center"],["class","altitude ruler","style","display: flex; align-self: stretch; flex-direction: column; align-content: center",4,"ngIf"],["class","altitude",4,"ngIf"],[2,"flex-grow","1"],[4,"ngFor","ngForOf"],["actionMenu",""],["separator",""],[1,"title"],["style","font-size: small;",4,"ngIf"],[2,"font-size","small"],["type","number","step","0.1",2,"font-size","small","width","3.6em","text-align","right",3,"ngModel","ngModelChange"],[1,"altitude","ruler",2,"display","flex","align-self","stretch","flex-direction","column","align-content","center"],[2,"margin-top","2em"],[2,"align-self","center","margin-top","auto","margin-bottom","auto"],[2,"margin-bottom","2em"],[1,"altitude"],["type","range","max","12","min","-12","step","0.5","orient","vertical",1,"altitude",3,"title","ngModel","ngModelChange"],["altitudeSlider",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngClass","click","mouseenter"],[1,"menu-title",3,"ngClass"],[3,"title",4,"ngIf"],["type","checkbox","checked","",3,"disabled",4,"ngIf"],["type","checkbox",3,"disabled",4,"ngIf"],["type","radio","checked","",3,"disabled",4,"ngIf"],["type","radio",3,"disabled",4,"ngIf"],["class","color-indicator","style","color: #000",4,"ngIf"],["class","color-indicator","style","color: #00f",4,"ngIf"],["class","color-indicator","style","color: #0f0",4,"ngIf"],["class","color-indicator","style","color: #0ff",4,"ngIf"],["class","color-indicator","style","color: #f00",4,"ngIf"],["class","color-indicator","style","color: #f0f",4,"ngIf"],["class","color-indicator","style","color: #ff0",4,"ngIf"],["class","color-indicator","style","color: #fff",4,"ngIf"],["style","vertical-align: top",4,"ngIf"],["class","self-only",4,"ngIf"],["class","imagebox",4,"ngIf"],["class","material-icons","style","font-size: 1rem",4,"ngIf"],["class","sub-menu-arrow",4,"ngIf"],[3,"title","actions","isSubmenu",4,"ngIf"],[3,"title"],["type","checkbox","checked","",3,"disabled"],["type","checkbox",3,"disabled"],["type","radio","checked","",3,"disabled"],["type","radio",3,"disabled"],[1,"color-indicator",2,"color","#000"],[1,"color-indicator",2,"color","#00f"],[1,"color-indicator",2,"color","#0f0"],[1,"color-indicator",2,"color","#0ff"],[1,"color-indicator",2,"color","#f00"],[1,"color-indicator",2,"color","#f0f"],[1,"color-indicator",2,"color","#ff0"],[1,"color-indicator",2,"color","#fff"],[2,"vertical-align","top"],[1,"material-icons",2,"font-size","150%","padding-left","2px"],[1,"self-only"],[1,"imagebox"],[1,"image",3,"src"],[1,"material-icons",2,"font-size","1rem"],[1,"sub-menu-arrow"],[1,"material-icons",2,"font-size","1em","vertical-align","bottom"],[3,"title","actions","isSubmenu"],[1,"separator"]],template:function(e,i){1&e&&(Q(0,"div",0,1),Ae("mouseleave",function(){return i.hideSubMenu()}),Te(2,EK,4,6,"div",2),Q(3,"div",3),Te(4,TK,7,0,"div",4),Te(5,SK,3,2,"div",5),Q(6,"div",6)(7,"ul"),Te(8,DK,2,1,"ng-container",7),ie()()()(),Te(9,JK,22,34,"ng-template",null,8,Un),Te(11,eY,2,0,"ng-template",null,9,Un)),2&e&&(re("ngClass",co(5,tY,i.isIconsMenu,i.isSubmenu,!i.isSubmenu,i.isPointerDragging)),U(2),re("ngIf",!i.isIconsMenu&&0<i.title.length||i.altitudeHande),U(2),re("ngIf",i.altitudeHande),U(1),re("ngIf",i.altitudeHande),U(3),re("ngForOf",i.actions))},directives:[Yn,bn,ps,mi,$i,di,gs,oi,Sl,t],pipes:[ai],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;padding:0;white-space:nowrap;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;z-index:2000000}.submenu-panel[_ngcontent-%COMP%]{position:absolute;left:calc(100% - 4px);top:-16px}.icons-panel[_ngcontent-%COMP%]{padding-bottom:2px}.icons-panel[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{width:54px;padding:1px}.icons-panel[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{padding:1px 0}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-max-limit[_ngcontent-%COMP%]{max-height:100%;max-width:100%}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em;font-size:12px;text-align:center;padding:4px 16px;margin:0 2px;color:#444;border-bottom:1px solid #AAA}.menu-title[_ngcontent-%COMP%]{display:inline-block}hr.separator[_ngcontent-%COMP%]{margin:.1em -12px;height:1px;border:0;background-color:#aaa}.sub-menu-arrow[_ngcontent-%COMP%]{display:inline-block;position:absolute;top:2px;bottom:0;right:1px}ul[_ngcontent-%COMP%]{list-style:none;padding:2px 0;margin:0}ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:relative;cursor:-moz-default;cursor:-webkit-default;cursor:default;padding:2px 20px;font-size:12px;color:#444}ul[_ngcontent-%COMP%] > li.hasHighlight[_ngcontent-%COMP%]:hover{color:#ccc;background-color:#1e1e1ecc}.menu-title[_ngcontent-%COMP%]:not(.icon-menu){overflow:hidden;max-width:16.5em;text-overflow:ellipsis}td.altitude[_ngcontent-%COMP%]{vertical-align:middle}input.altitude[_ngcontent-%COMP%]{writing-mode:bt-lr;-webkit-appearance:slider-vertical;-moz-appearance:slider-vertical;appearance:slider-vertical;width:8px;height:100%;padding:3px}.disabled[_ngcontent-%COMP%]   .menu-title[_ngcontent-%COMP%], .disabled[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{color:gray}.altitude-view[_ngcontent-%COMP%]{color:#000;vertical-align:top;width:3em;text-align:right}.ruler[_ngcontent-%COMP%]{color:#444;font-size:small;padding-left:4px;padding-right:2px}.default[_ngcontent-%COMP%]{font-weight:bolder}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:50px;height:50px;max-width:50px;max-height:50px;vertical-align:top;margin-left:auto;margin-right:auto;text-align:center}.image[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:middle;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:.5rem}.icon-menu[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none}.icon-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid transparent;z-index:400}.icon-menu[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{border:2px dotted rgba(255,0,0,40);z-index:600}.icon-menu.default[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid red;z-index:500}.color-indicator[_ngcontent-%COMP%]{font-size:larger;text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff;margin-right:-.2rem}.self-only[_ngcontent-%COMP%]{color:red}"]}),t})(),iY=(()=>{class t{constructor(e,i,r){this.viewContainerRef=e,this.modalService=i,this.panelService=r,this.name="\u30b2\u30fc\u30e0\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",this.size=1,this.xml="",this.minSize=1,this.maxSize=20,this.tableBackgroundImage=Ut.createEmpty("null")}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u30fc"),ze.register(this).on("SELECT_FILE",e=>{console.log("SELECT_FILE GameCharacterGeneratorComponent "+e.data.fileIdentifier);let r=Nt.instance.get(e.data.fileIdentifier);r&&(this.tableBackgroundImage=r)})}ngAfterViewInit(){}ngOnDestroy(){ze.unregister(this)}createGameCharacter(){Gt.create(this.name,this.size,this.tableBackgroundImage.identifier)}createGameTableMask(){let e=dr.instance.viewTable;if(!e)return;let i=is.create("\u30de\u30c3\u30d7\u30de\u30b9\u30af",5,5,100);e.appendChild(i)}createGameCharacterForXML(e){ti.instance.parseXml(e)}openModal(){this.modalService.open(Ko)}}return t.\u0275fac=function(e){return new(e||t)(He(zr),He(Fn),He(An))},t.\u0275cmp=Xt({type:t,selectors:[["game-character-generator"]],decls:15,vars:12,consts:[[3,"click"],["height","120",3,"src"],["placeholder","Name","name","name",3,"ngModel","ngModelChange"],["type","range","name","size",3,"ngModel","title","min","max","ngModelChange"],["type","number",3,"ngModel","min","max","ngModelChange"]],template:function(e,i){1&e&&(Q(0,"button",0),Ae("click",function(){return i.openModal()}),ye(1,"\u753b\u50cf\u3092\u9078\u3076"),ie(),Q(2,"div"),ot(3,"img",1),Et(4,"safe"),ie(),Q(5,"input",2),Ae("ngModelChange",function(s){return i.name=s}),ie(),Q(6,"div")(7,"div")(8,"input",3),Ae("ngModelChange",function(s){return i.size=s}),ie(),ye(9," Size : "),Q(10,"input",4),Ae("ngModelChange",function(s){return i.size=s}),ie()(),Q(11,"button",0),Ae("click",function(){return i.createGameCharacter()}),ye(12,"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u4f5c\u308b"),ie(),Q(13,"button",0),Ae("click",function(){return i.createGameTableMask()}),ye(14,"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u4f5c\u308b"),ie()()),2&e&&(U(3),re("src",Tt(4,9,i.tableBackgroundImage.url,"resourceUrl"),en),U(2),re("ngModel",i.name),U(3),ht("title",i.size),ht("min",i.minSize),ht("max",i.maxSize),re("ngModel",i.size),U(2),ht("min",i.minSize),ht("max",i.maxSize),re("ngModel",i.size))},directives:[mi,$i,di,gs,ps,Oo,Fo],pipes:[ai],styles:[""]}),t})();function rY(t,n){1&t&&_n(0)}function sY(t,n){1&t&&_n(0)}function oY(t,n){if(1&t&&(Q(0,"div"),ye(1),ie()),2&t){const e=_e();U(1),Rn("",e.getTabTitle(e.selectTab),"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306f\u7a7a\u3067\u3059")}}function aY(t,n){if(1&t&&(Q(0,"div",12),ye(1),ie()),2&t){const e=_e().$implicit;Qe("background-color",e.ownerColor),U(1),Xe(e.ownerName?e.ownerName:"\uff08\u7121\u540d\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\uff09")}}function lY(t,n){1&t&&_n(0)}const cY=function(t,n,e){return{box:!0,selected:t,"is-hide-in":n,"is-inventory-no-indicate":e}},uY=function(t){return{gameObject:t}};function dY(t,n){if(1&t){const e=it();Q(0,"div",9),Ae("contextmenu",function(r){const o=Oe(e).$implicit;return _e().onContextMenu(r,o)})("click",function(){const s=Oe(e).$implicit;return _e().selectGameObject(s)})("dblclick",function(r){const o=Oe(e).$implicit;return _e().focusGameObject(o,r)}),Te(1,aY,2,3,"div",10),Te(2,lY,1,0,"ng-container",11),ie()}if(2&t){const e=n.$implicit,i=_e(),r=Kt(11);re("ngClass",Zr(4,cY,i.selectedIdentifier===e.identifier,e.isHideIn,!e.isInventoryIndicate)),U(1),re("ngIf",e.isHideIn&&null!=e.ownerName),U(1),re("ngTemplateOutlet",r)("ngTemplateOutletContext",ft(8,uY,e))}}function fY(t,n){if(1&t){const e=it();Q(0,"div",13)(1,"button",14),Ae("click",function(){return Oe(e),_e().cleanInventory()}),ye(2,"\u5893\u5834\u3092\u7a7a\u306b\u3059\u308b"),ie()()}if(2&t){const e=_e();U(1),Bt("disabled",e.getGameObjects(e.selectTab).length<1?"":null)}}function hY(t,n){if(1&t){const e=it();Q(0,"label")(1,"input",18),Ae("ngModelChange",function(r){return Oe(e),_e(2).selectTab=r}),ie(),Q(2,"div"),ye(3),ie()()}if(2&t){const e=n.$implicit,i=_e(2);U(1),ht("value",e),re("ngModel",i.selectTab),U(2),Ma("",i.getTabTitle(e)," (",i.getGameObjects(e).length,")")}}function pY(t,n){if(1&t&&(Q(0,"form",15)(1,"div",16),Te(2,hY,4,4,"label",17),ie()()),2&t){const e=_e();U(2),re("ngForOf",e.inventoryTypes)}}function gY(t,n){if(1&t){const e=it();Ke(0),Q(1,"div")(2,"div",19)(3,"b"),ye(4,"\u4e26\u3073\u9806: "),ie()(),Q(5,"input",20),Ae("ngModelChange",function(r){return Oe(e),_e(2).sortTag=r}),ie(),Q(6,"select",21),Ae("ngModelChange",function(r){return Oe(e),_e(2).sortOrder=r}),Q(7,"option",22),ye(8,"\u6607\u9806"),ie(),Q(9,"option",23),ye(10,"\u964d\u9806"),ie()()(),Q(11,"div",24)(12,"b"),ye(13,"\u8868\u793a\u9805\u76ee: "),ie()(),Q(14,"input",25),Ae("ngModelChange",function(r){return Oe(e),_e(2).dataTag=r}),ie(),Q(15,"div",13)(16,"button",26),Ae("click",function(){return Oe(e),_e(2).toggleEdit()}),Q(17,"i",27),ye(18,"settings"),ie(),ye(19,"\u5b8c\u4e86"),ie()(),Ye()}if(2&t){const e=_e(2);U(5),re("ngModel",e.sortTag),U(1),re("ngModel",e.sortOrder),U(8),re("ngModel",e.dataTag)}}function _Y(t,n){if(1&t&&(Ke(0),Q(1,"span"),ye(2),ie(),Ye()),2&t){const e=_e(3);U(2),Ma("",e.sortTag," (",e.sortOrderName,")")}}function mY(t,n){1&t&&(Ke(0),ye(1,"-"),Ye())}function $Y(t,n){if(1&t){const e=it();Q(0,"label",32)(1,"input",33),Ae("ngModelChange",function(r){return Oe(e),_e(3).indicateAll=r}),ie(),Q(2,"b"),ye(3,"\u3059\u3079\u3066\u8868\u793a"),Q(4,"sup",34),ye(5,"*"),ie()()()}if(2&t){const e=_e(3);U(1),re("ngModel",e.indicateAll)}}function vY(t,n){if(1&t){const e=it();Ke(0),Q(1,"table",28)(2,"tr")(3,"th",29),ye(4,"\u4e26\u3073\u9806:"),ie(),Q(5,"td",29),Te(6,_Y,3,2,"ng-container",2),Te(7,mY,2,0,"ng-container",2),ie(),Q(8,"td",30)(9,"button",26),Ae("click",function(){return Oe(e),_e(2).toggleEdit()}),Q(10,"i",27),ye(11,"settings"),ie(),ye(12,"\u8a2d\u5b9a"),ie(),Te(13,$Y,6,1,"label",31),ie()()(),Ye()}if(2&t){const e=_e(2);U(6),re("ngIf",0<e.sortTag.length),U(1),re("ngIf",e.sortTag.length<1),U(6),re("ngIf","table"===e.selectTab)}}function bY(t,n){if(1&t&&(Te(0,gY,20,3,"ng-container",2),Te(1,vY,14,3,"ng-container",2)),2&t){const e=_e();re("ngIf",e.isEdit),U(1),re("ngIf",!e.isEdit)}}function yY(t,n){if(1&t&&(Q(0,"i",56),ot(1,"img",57),Et(2,"safe"),ie()),2&t){const e=_e().gameObject;U(1),re("src",Tt(2,1,e.faceIcon.url,"resourceUrl"),en)}}function CY(t,n){1&t&&(Q(0,"i",42),ye(1,"emoji_emotions"),ie())}const xY=function(t){return{opacity:t}};function wY(t,n){if(1&t&&(Q(0,"i",56),ot(1,"img",58),Et(2,"safe"),ie()),2&t){const e=_e().gameObject;U(1),re("ngStyle",ft(5,xY,e.isDropShadow?.7:.3))("src",Tt(2,2,e.shadowImageFile.url,"resourceUrl"),en)}}function EY(t,n){if(1&t&&(Q(0,"i",42),ye(1),ie()),2&t){const e=_e().gameObject;U(1),Xe(e.isDropShadow?"star_half":"star_border")}}function TY(t,n){if(1&t){const e=it();Q(0,"button",59),Ae("click",function(r){Oe(e);const s=_e().gameObject;return _e().onContextMenu(r,s)}),Q(1,"i",42),ye(2,"settings"),ie()()}}const SY=function(t,n,e,i){return{inverse:t,hollow:n,"is-hide-in":e,"black-paint":i}};function IY(t,n){if(1&t&&(ot(0,"img",60),Et(1,"safe")),2&t){const e=_e().gameObject;re("src",Tt(1,2,e.imageFile.url,"resourceUrl"),en)("ngClass",co(5,SY,e.isInverse,e.isHollow,e.isHideIn,e.isBlackPaint))}}function kY(t,n){1&t&&_n(0)}const MY=function(t,n){return{dataElm:t,name:n}};function DY(t,n){if(1&t&&(Ke(0),Te(1,kY,1,0,"ng-container",11),Ye()),2&t){const e=n.$implicit,i=_e(2).gameObject;_e();const r=Kt(13);U(1),re("ngTemplateOutlet",r)("ngTemplateOutletContext",Yt(2,MY,e,i.name))}}function AY(t,n){if(1&t&&(Q(0,"div"),Te(1,DY,2,5,"ng-container",61),ie()),2&t){const e=_e().gameObject,i=_e();U(1),re("ngForOf",i.getInventoryTags(e))("ngForTrackBy",i.trackByGameObject)}}const xu=function(t){return{"is-active":t}},JS=function(t){return{"is-hide-in":t}},PY=function(t,n,e,i,r,s,o,a){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:s,yellow:o,white:a}};function NY(t,n){if(1&t){const e=it();Q(0,"div",35)(1,"div",36)(2,"button",37),Ae("click",function(){const s=Oe(e).gameObject;return s.isUseIconToOverviewImage=!s.isUseIconToOverviewImage}),Te(3,yY,3,4,"i",38),Te(4,CY,2,0,"ng-template",null,39,Un),ie(),Q(6,"span",40),ye(7),ie(),Q(8,"button",41),Ae("click",function(){const s=Oe(e).gameObject;return s.isShowChatBubble=!s.isShowChatBubble}),Q(9,"i",42),ye(10),ie()(),Q(11,"button",43),Ae("click",function(){const s=Oe(e).gameObject;return s.isDropShadow=!s.isDropShadow}),Te(12,wY,3,7,"i",38),Te(13,EY,2,1,"ng-template",null,44,Un),ie(),Q(15,"button",45),Ae("click",function(){const s=Oe(e).gameObject;return s.isNotRide=!s.isNotRide}),Q(16,"i",42),ye(17),ie()(),Q(18,"button",46),Ae("click",function(){const s=Oe(e).gameObject;return s.isAltitudeIndicate=!s.isAltitudeIndicate}),Q(19,"i",47),ye(20,"straighten"),ie(),Q(21,"span",48),ye(22),ie()(),Q(23,"button",49),Ae("click",function(){const s=Oe(e).gameObject;return s.isInventoryIndicate=!s.isInventoryIndicate}),Q(24,"i",42),ye(25,"all_inbox"),ie()(),Te(26,TY,3,0,"button",50),ie(),Q(27,"div",51)(28,"div",52)(29,"span",53),Te(30,IY,2,10,"img",54),ie()(),Q(31,"div",55),Te(32,AY,2,2,"div",2),ie()()()}if(2&t){const e=n.gameObject,i=Kt(5),r=Kt(14),s=_e();U(2),re("disabled",s.selectedIdentifier!==e.identifier)("ngClass",ft(26,xu,e.isUseIconToOverviewImage)),U(1),re("ngIf",e.faceIcon&&0<(null==e.faceIcon?null:e.faceIcon.url.length))("ngIfElse",i),U(4),Xe(e.name),U(1),re("disabled",s.selectedIdentifier!==e.identifier)("ngClass",ft(28,xu,e.isShowChatBubble)),U(2),Xe(e.isShowChatBubble?"textsms":"speaker_notes_off"),U(1),re("disabled",s.selectedIdentifier!==e.identifier)("ngClass",ft(30,xu,e.isDropShadow)),U(1),re("ngIf",e.shadowImageFile&&0<e.shadowImageFile.url.length)("ngIfElse",r),U(3),re("disabled",s.selectedIdentifier!==e.identifier)("ngClass",ft(32,xu,!e.isNotRide)),U(2),Xe(e.isNotRide?"directions_run":"directions_bike"),U(1),re("disabled",s.selectedIdentifier!==e.identifier)("ngClass",ft(34,xu,e.isAltitudeIndicate)),U(4),Xe(e.altitude),U(1),re("disabled",s.selectedIdentifier!==e.identifier)("ngClass",ft(36,xu,e.isInventoryIndicate)),U(3),re("ngIf",s.selectedIdentifier===e.identifier),U(1),re("ngClass",ft(38,JS,e.isHideIn)),U(1),re("ngClass",ft(40,JS,e.isHideIn)),U(1),re("ngClass",uo(42,PY,0==e.aura,1==e.aura,2==e.aura,3==e.aura,4==e.aura,5==e.aura,6==e.aura,7==e.aura)),U(1),re("ngIf",e.imageFile.url),U(2),re("ngIf",e.rootDataElement)}}function FY(t,n){1&t&&(Ke(0),ot(1,"br"),Ye())}function OY(t,n){if(1&t){const e=it();Ke(0),Q(1,"div",67)(2,"span"),ye(3),ie()(),Q(4,"div",68)(5,"div",69)(6,"div",70)(7,"div",71),ye(8),ie(),Q(9,"input",72),Ae("ngModelChange",function(r){return Oe(e),_e(2).dataElm.value=r}),ie()()()(),Ye()}if(2&t){const e=_e(2),i=e.dataElm,r=e.name;U(3),Xe(i.name),U(5),Xe(i.value),U(1),ht("type",i.value&&i.value==+i.value?"number":"text"),re("logging.name",r)("logging.dataElement",i)("ngModel",i.value)}}const RY=function(){return{"background-color":"green"}};function BY(t,n){if(1&t){const e=it();Ke(0),Q(1,"div",73)(2,"div",74)(3,"span"),ye(4),ie()(),Q(5,"input",75),Ae("ngModelChange",function(r){return Oe(e),_e(2).dataElm.currentValue=r}),ie()(),Q(6,"div",73)(7,"input",76),Ae("ngModelChange",function(r){return Oe(e),_e(2).dataElm.currentValue=r}),Et(8,"safe"),ie()(),Ye()}if(2&t){const e=_e(2),i=e.dataElm,r=e.name;U(4),Xe(i.name),U(1),re("logging.name",r)("logging.dataElement",i)("ngModel",i.currentValue),Bt("data-init-value",i.currentValue),U(2),hr(Tt(8,14,"font-size: 0.8em; min-width: 1em; width:"+(i.name.length+4.5)+"em; --min: 0; --max: "+i.value+"; --val:"+i.currentValue+";","style")),ht("title",i.currentValue),ht("max",+i.value?i.value:1e3),re("logging.name",r)("logging.dataElement",i)("ngStyle",sa(17,RY))("ngModel",i.currentValue),Bt("data-init-value",i.currentValue)}}function LY(t,n){if(1&t){const e=it();Ke(0),Q(1,"div",67)(2,"span"),ye(3),ie()(),Q(4,"div",68)(5,"div",69)(6,"div",70)(7,"input",77),Ae("ngModelChange",function(r){return Oe(e),_e(2).dataElm.value=r})("change",function(){Oe(e);const r=_e(2).dataElm;return r.value=r.value?r.name:""}),ie()()()(),Ye()}if(2&t){const e=_e(2),i=e.dataElm,r=e.name;U(1),Qe("text-decoration",i.value?"none":"line-through"),U(2),Xe(i.name),U(4),ht("checked",i.value?"checked":""),re("logging.name",r)("logging.dataElement",i)("ngModel",i.value)}}function zY(t,n){if(1&t&&(Q(0,"span",79),ye(1),ie()),2&t){const e=_e(3).dataElm;U(1),Rn("(",(e.calcAbilityScore()>=0?"+":"")+e.calcAbilityScore(),")")}}function jY(t,n){if(1&t){const e=it();Ke(0),Q(1,"div",67)(2,"span"),ye(3),ie()(),Q(4,"div",68)(5,"div",69)(6,"div",70)(7,"div",71),ye(8),ie(),Q(9,"input",72),Ae("ngModelChange",function(r){return Oe(e),_e(2).dataElm.value=r}),ie(),Te(10,zY,2,1,"span",78),ie()()(),Ye()}if(2&t){const e=_e(2),i=e.dataElm,r=e.name;U(3),Xe(i.name),U(5),Xe(i.value),U(1),ht("type",i.value&&i.value==+i.value?"number":"text"),re("logging.name",r)("logging.dataElement",i)("ngModel",i.value),U(1),re("ngIf",i.currentValue)}}const HY=function(t){return{"outer-link":t}};function UY(t,n){if(1&t){const e=it();Ke(0),Q(1,"div",67)(2,"a",80),Ae("click",function(){Oe(e);const r=_e(2),s=r.dataElm,o=r.name,a=_e();return!!a.stringUtil.validUrl(s.value)&&a.openUrl(s.value,o,s.name)}),Et(3,"safe"),Q(4,"span",81),ye(5),ie()()(),Ye()}if(2&t){const e=_e(2).dataElm,i=_e();U(2),re("ngClass",ft(8,HY,!i.stringUtil.sameOrigin(e.value))),Bt("title",e.value)("href",Tt(3,5,i.stringUtil.validUrl(e.value)?e.value:"","url"),en)("disabled",i.stringUtil.validUrl(e.value)?null:""),U(3),Xe(e.name)}}function VY(t,n){1&t&&_n(0)}function GY(t,n){1&t&&_n(0)}function qY(t,n){1&t&&_n(0)}function WY(t,n){if(1&t){const e=it();Ke(0),Q(1,"div",67)(2,"span"),ye(3),ie()(),Q(4,"div",68)(5,"div",69)(6,"div",70)(7,"div",71),ye(8),ie(),Q(9,"input",82),Ae("ngModelChange",function(r){return Oe(e),_e(3).dataElm.value=r}),ie()()()(),Ye()}if(2&t){const e=_e(3).dataElm;U(3),Xe(e.name),U(5),Xe(e.value),U(1),ht("type","size"===e.name||"altitude"===e.name?"number":"text"),ht("min","size"===e.name?"0":""),re("ngModel",e.value)}}function KY(t,n){if(1&t&&(Ke(0),Te(1,WY,10,5,"ng-container",2),Ye()),2&t){const e=_e(2).dataElm;U(1),re("ngIf",0==e.children.length)}}function YY(t,n){if(1&t&&(Q(0,"div",63),Ke(1,64),Te(2,OY,10,6,"ng-container",65),Te(3,BY,9,18,"ng-container",65),Te(4,LY,8,7,"ng-container",65),Te(5,jY,11,7,"ng-container",65),Te(6,UY,6,10,"ng-container",65),Te(7,VY,1,0,"ng-container",65),Te(8,GY,1,0,"ng-container",65),Te(9,qY,1,0,"ng-container",65),Te(10,KY,2,1,"ng-container",66),Ye(),ie()),2&t){const e=_e().dataElm;U(1),re("ngSwitch",e.attributes.type),U(1),re("ngSwitchCase","simpleNumber"),U(1),re("ngSwitchCase","numberResource"),U(1),re("ngSwitchCase","checkProperty"),U(1),re("ngSwitchCase","abilityScore"),U(1),re("ngSwitchCase","url"),U(1),re("ngSwitchCase","colors"),U(1),re("ngSwitchCase","color"),U(1),re("ngSwitchCase","note")}}function ZY(t,n){if(1&t&&(Te(0,FY,2,0,"ng-container",2),Te(1,YY,11,9,"div",62)),2&t){const e=n.dataElm,i=_e();re("ngIf",(null==e?null:e.name)===i.newLineString),U(1),re("ngIf",e&&e.name!==i.newLineString)}}let XY=(()=>{class t{constructor(e,i,r,s,o,a){this.changeDetector=e,this.panelService=i,this.inventoryService=r,this.contextMenuService=s,this.pointerDeviceService=o,this.modalService=a,this.inventoryTypes=["table","common","graveyard"],this.selectTab="table",this.selectedIdentifier="",this.isEdit=!1,this.stringUtil=rt,this.sortStopTimerId=null}get sortTag(){return this.inventoryService.sortTag}set sortTag(e){this.inventoryService.sortTag=e}get sortOrder(){return this.inventoryService.sortOrder}set sortOrder(e){this.inventoryService.sortOrder=e}get dataTag(){return this.inventoryService.dataTag}set dataTag(e){this.inventoryService.dataTag=e}get dataTags(){return this.inventoryService.dataTags}get indicateAll(){return this.inventoryService.indicateAll}set indicateAll(e){this.inventoryService.indicateAll=e}get sortOrderName(){return this.sortOrder===uf.ASC?"\u6607\u9806":"\u964d\u9806"}get newLineString(){return this.inventoryService.newLineString}get isGMMode(){return!!We.myCursor&&We.myCursor.isGMMode}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),ze.register(this).on("SELECT_TABLETOP_OBJECT",e=>{dt.instance.get(e.data.identifier)instanceof Ci&&(this.selectedIdentifier=e.data.identifier,this.changeDetector.markForCheck())}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("UPDATE_INVENTORY",e=>{(e.isSendFromSelf||e.data)&&this.changeDetector.markForCheck()}).on("OPEN_NETWORK",e=>{this.inventoryTypes=["table","common",xt.peerId,"graveyard"],this.inventoryTypes.includes(this.selectTab)||(this.selectTab=xt.peerId)}),this.inventoryTypes=["table","common",xt.peerId,"graveyard"]}ngOnDestroy(){ze.unregister(this),this.sortStopTimerId&&clearTimeout(this.sortStopTimerId)}getTabTitle(e){switch(e){case"table":return"\u30c6\u30fc\u30d6\u30eb";case xt.peerId:return"\u500b\u4eba";case"graveyard":return"\u5893\u5834";default:return"\u5171\u6709"}}getInventory(e){switch(e){case"table":return this.inventoryService.tableInventory;case xt.peerId:return this.inventoryService.privateInventory;case"graveyard":return this.inventoryService.graveyardInventory;default:return this.inventoryService.commonInventory}}getGameObjects(e){return this.getInventory(e).tabletopObjects.filter(i=>"table"!=e||this.indicateAll||i.isInventoryIndicate)}getInventoryTags(e){return this.getInventory(e.location.name).dataElementMap.get(e.identifier)}onContextMenu(e,i){if(document.activeElement instanceof HTMLInputElement&&"range"!==document.activeElement.getAttribute("type")||(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;this.selectGameObject(i);let r=this.pointerDeviceService.pointers[0],s=[];"table"===i.location.name&&(this.isGMMode||i.isVisible)&&s.push({name:"\u30c6\u30fc\u30d6\u30eb\u4e0a\u304b\u3089\u63a2\u3059",action:()=>{"table"===i.location.name&&ze.trigger("FOCUS_TABLETOP_OBJECT",{x:i.location.x,y:i.location.y,z:i.posZ+(i.altitude>0?50*i.altitude:0)})},default:"table"===i.location.name,disabled:"table"!==i.location.name,selfOnly:!0}),i.isHideIn&&s.push({name:"\u4f4d\u7f6e\u3092\u516c\u958b\u3059\u308b",action:()=>{i.owner="",pt.play(tt.piecePut),ze.trigger("UPDATE_INVENTORY",null)}}),(!i.isHideIn||!i.isVisible)&&s.push({name:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u308b\uff08\u30b9\u30c6\u30eb\u30b9\uff09",action:()=>{"table"===i.location.name&&!Gt.isStealthMode&&!We.myCursor.isGMMode&&this.modalService.open(er,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:Si.OK,materialIcon:"disabled_visible"}),i.owner=xt.peerContext.userId,pt.play(tt.sweep),ze.call("UPDATE_INVENTORY",!0)}}),s.push(kt),i.imageFiles.length>1&&(s.push({name:"\u753b\u50cf\u5207\u308a\u66ff\u3048",action:null,subActions:i.imageFiles.map((a,h)=>({name:i.currntImageIndex==h?"\u25c9":"\u25cb",action:()=>{i.currntImageIndex=h,pt.play(tt.surprise),ze.trigger("UPDATE_INVENTORY",null)},default:i.currntImageIndex==h,icon:a}))}),s.push(kt)),s.push(i.isUseIconToOverviewImage?{name:"\u2611 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{i.isUseIconToOverviewImage=!1,ze.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{i.isUseIconToOverviewImage=!0,ze.trigger("UPDATE_INVENTORY",null)}}),s.push(i.isShowChatBubble?{name:"\u2611 \u{1f4ad}\u306e\u8868\u793a",action:()=>{i.isShowChatBubble=!1,ze.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u{1f4ad}\u306e\u8868\u793a",action:()=>{i.isShowChatBubble=!0,ze.trigger("UPDATE_INVENTORY",null)}}),s.push(i.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{i.isDropShadow=!1,ze.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{i.isDropShadow=!0,ze.trigger("UPDATE_INVENTORY",null)}}),s.push({name:"\u753b\u50cf\u52b9\u679c",action:null,subActions:[i.isInverse?{name:"\u2611 \u53cd\u8ee2",action:()=>{i.isInverse=!1,ze.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u53cd\u8ee2",action:()=>{i.isInverse=!0,ze.trigger("UPDATE_INVENTORY",null)}},i.isHollow?{name:"\u2611 \u307c\u304b\u3057",action:()=>{i.isHollow=!1,ze.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u307c\u304b\u3057",action:()=>{i.isHollow=!0,ze.trigger("UPDATE_INVENTORY",null)}},i.isBlackPaint?{name:"\u2611 \u9ed2\u5857\u308a",action:()=>{i.isBlackPaint=!1,ze.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ed2\u5857\u308a",action:()=>{i.isBlackPaint=!0,ze.trigger("UPDATE_INVENTORY",null)}},{name:"\u30aa\u30fc\u30e9",action:null,subActions:[{name:(-1==i.aura?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{i.aura=-1,ze.trigger("UPDATE_INVENTORY",null)}},kt].concat(["\u30d6\u30e9\u30c3\u30af","\u30d6\u30eb\u30fc","\u30b0\u30ea\u30fc\u30f3","\u30b7\u30a2\u30f3","\u30ec\u30c3\u30c9","\u30de\u30bc\u30f3\u30bf","\u30a4\u30a8\u30ed\u30fc","\u30db\u30ef\u30a4\u30c8"].map((a,h)=>({name:`${i.aura==h?"\u25c9":"\u25cb"} ${a}`,action:()=>{i.aura=h,ze.trigger("UPDATE_INVENTORY",null)}})))},kt,{name:"\u30ea\u30bb\u30c3\u30c8",action:()=>{i.isInverse=!1,i.isHollow=!1,i.isBlackPaint=!1,i.aura=-1,ze.trigger("UPDATE_INVENTORY",null)},disabled:!i.isInverse&&!i.isHollow&&!i.isBlackPaint&&-1==i.aura}]}),s.push(kt),s.push(i.isNotRide?{name:"\u2610 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{i.isNotRide=!1,ze.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2611 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{i.isNotRide=!0,ze.trigger("UPDATE_INVENTORY",null)}}),s.push(i.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{i.isAltitudeIndicate=!1,ze.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{i.isAltitudeIndicate=!0,ze.trigger("UPDATE_INVENTORY",null)}}),s.push({name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=i.altitude&&(i.altitude=0,"table"===i.location.name&&pt.play(tt.sweep))},altitudeHande:i}),s.push(kt),s.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(i)}}),s.push({name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a",action:()=>{this.showChatPalette(i)},disabled:"graveyard"===i.location.name}),s.push({name:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a",action:()=>{this.showStandSetting(i)}}),s.push(kt),s.push({name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:i.getUrls().map(a=>{const h=a.value.toString();return{name:a.name?a.name:h,action:()=>{rt.sameOrigin(h)?window.open(h.trim(),"_blank","noopener"):this.modalService.open(qr,{url:h,title:i.name,subTitle:a.name})},disabled:!rt.validUrl(h),error:rt.validUrl(h)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:rt.validUrl(h)&&!rt.sameOrigin(h)}}),disabled:i.getUrls().length<=0}),s.push(kt),s.push(i.isInventoryIndicate?{name:"\u2611 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{i.isInventoryIndicate=!1,ze.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{i.isInventoryIndicate=!0,ze.trigger("UPDATE_INVENTORY",null)}});let o=[{name:"table",alias:"\u30c6\u30fc\u30d6\u30eb"},{name:"common",alias:"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"},{name:xt.peerId,alias:"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"},{name:"graveyard",alias:"\u5893\u5834"}];s.push({name:`${(o.find(a=>a.name==i.location.name)||o[1]).alias}\u304b\u3089\u79fb\u52d5`,action:null,subActions:o.filter((a,h)=>!(i.location.name==a.name||1==h&&!o.map(w=>w.name).includes(i.location.name))).map(a=>({name:`${a.alias}`,action:()=>{let h=Gt.isStealthMode;ze.call("FAREWELL_STAND_IMAGE",{characterIdentifier:i.identifier}),i.setLocation(a.name),"table"===a.name&&i.isHideIn&&i.isVisible&&!h&&!We.myCursor.isGMMode&&this.modalService.open(er,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:Si.OK,materialIcon:"disabled_visible"}),pt.play("graveyard"==a.name?tt.sweep:tt.piecePut),ze.call("UPDATE_INVENTORY",!0)}})),disabled:!i.isVisible&&!this.isGMMode}),s.push(kt),s.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{this.cloneGameObject(i),pt.play(tt.piecePut)},disabled:!i.isVisible&&!this.isGMMode}),s.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b\uff08\u81ea\u52d5\u63a1\u756a\uff09",action:()=>{const a=i.clone(),h=a.name.split("_");let w;w=h.length>1&&/\d+/.test(h[h.length-1])?h.slice(0,h.length-1).join("_"):h.join("_");let X=0;for(const fe of dt.instance.getObjects(Gt)){if(!fe.name.startsWith(w))continue;let pe=fe.name.match(/_(\d+)$/)?+RegExp.$1:0;pe>X&&(X=pe)}a.name=w+"_"+(X+1),a.update(),pt.play(tt.piecePut)},disabled:!i.isVisible&&!this.isGMMode}),"graveyard"===i.location.name?(s.push(kt),s.push({name:"\u524a\u9664\u3059\u308b\uff08\u5b8c\u5168\u306b\u524a\u9664\uff09",action:()=>{this.deleteGameObject(i),pt.play(tt.sweep)}})):(s.push(kt),s.push({name:"\u524a\u9664\u3059\u308b\uff08\u5893\u5834\u3078\u79fb\u52d5\uff09",action:()=>{ze.call("FAREWELL_STAND_IMAGE",{characterIdentifier:i.identifier}),i.setLocation("graveyard"),pt.play(tt.sweep)}})),this.contextMenuService.open(r,s,i.name)}toggleEdit(){this.isEdit=!this.isEdit}cleanInventory(){let e=this.getTabTitle(this.selectTab),i=this.getGameObjects(this.selectTab);this.modalService.open(er,{title:"\u5893\u5834\u3092\u7a7a\u306b\u3059\u308b",text:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u5b8c\u5168\u306b\u524a\u9664\u3057\u307e\u3059\u304b\uff1f",helpHtml:`<b>${rt.escapeHtml(e)}</b>\u306b\u5b58\u5728\u3059\u308b <b>${i.length}</b> \u4f53\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u5b8c\u5168\u306b\u524a\u9664\u3057\u307e\u3059\u3002`,type:Si.OK_CANCEL,materialIcon:"delete_forever",action:()=>{for(const r of i)this.deleteGameObject(r);pt.play(tt.sweep)}})}cloneGameObject(e){e.clone()}showDetail(e){ze.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(r+=" - "+e.name),this.panelService.open(Ws,{title:r,left:i.x-800,top:i.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(hu,{left:i.x-250,top:i.y-175,width:620,height:350}).character=e}selectGameObject(e){ze.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName,highlighting:!0})}focusGameObject(e,i){i.target instanceof HTMLElement&&(new Set(["input","button"]).has(i.target.tagName.toLowerCase())||"table"!==e.location.name||!e.isVisible&&!this.isGMMode||ze.trigger("FOCUS_TABLETOP_OBJECT",{x:e.location.x,y:e.location.y,z:e.posZ+(e.altitude>0?50*e.altitude:0)}))}deleteGameObject(e){e.destroy(),this.changeDetector.markForCheck()}showStandSetting(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(Jp,{left:i.x-400,top:i.y-175,width:730,height:572}).character=e}trackByGameObject(e,i){return i?i.identifier:e}openUrl(e,i=null,r=null){return rt.sameOrigin(e)?window.open(e.trim(),"_blank","noopener"):this.modalService.open(qr,{url:e,title:i,subTitle:r}),!1}onInput(){this.inventoryService.sortStop=!0,this.sortStopTimerId&&clearTimeout(this.sortStopTimerId),this.sortStopTimerId=setTimeout(()=>{this.inventoryService.sortStop=!1},666)}}return t.\u0275fac=function(e){return new(e||t)(He(Oi),He(An),He(Tv),He(lr),He(fi),He(Fn))},t.\u0275cmp=Xt({type:t,selectors:[["game-object-inventory"]],decls:14,vars:6,consts:[[1,"component",3,"input"],[4,"ngTemplateOutlet"],[4,"ngIf"],["class","object-container",3,"ngClass","contextmenu","click","dblclick",4,"ngFor","ngForOf","ngForTrackBy"],["style","padding-top: 6px;",4,"ngIf"],["inventoryTab",""],["inventoryViewSetting",""],["gameObjectTags",""],["dataElmTag",""],[1,"object-container",3,"ngClass","contextmenu","click","dblclick"],["class","owner-tag",3,"background-color",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"owner-tag"],[2,"padding-top","6px"],[1,"danger",3,"click"],[1,"is-sticky-top"],[1,"tab"],[4,"ngFor","ngForOf"],["name","tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],[2,"font-size","12px"],["placeholder","\u30bf\u30b0\u540d",1,"order-control",3,"ngModel","ngModelChange"],[1,"order-control",3,"ngModel","ngModelChange"],["value","ASC"],["value","DESC"],[2,"font-size","12px","padding-top","6px"],["placeholder","\u30b9\u30da\u30fc\u30b9\u533a\u5207\u308a\u3067\u30bf\u30b0\u540d \u30b9\u30e9\u30c3\u30b7\u30e5\u3067\u6539\u884c ex.\u300cHP MP / \u30e1\u30e2\u300d",2,"width","100%","box-sizing","border-box",3,"ngModel","ngModelChange"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[2,"font-size","0.8em"],["nowrap","",2,"vertical-align","middle"],["width","100%","nowrap",""],["style","float: right; font-size: smaller",4,"ngIf"],[2,"float","right","font-size","smaller"],["type","checkbox",3,"ngModel","ngModelChange"],[1,"self_only"],[1,"inventory-object"],[1,"object-name"],["title","\u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854\u30a2\u30a4\u30b3\u30f3\u3092\u4f7f\u7528",1,"indicate",2,"font-size","0.8em","padding","1px","width","24px","height","16px","margin-bottom","1px",3,"disabled","ngClass","click"],["class","face-icon",4,"ngIf","ngIfElse"],["altImage",""],[1,"game-object-name",2,"margin-left","3px","margin-right","3px"],["title","\u{1f4ad}\u306e\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"disabled","ngClass","click"],[1,"material-icons",2,"font-size","1em"],["title","\u5f71\u306e\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","1px","width","24px","height","16px","margin-bottom","1px",3,"disabled","ngClass","click"],["altShadow",""],["title","\u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"disabled","ngClass","click"],["title","\u9ad8\u5ea6\u306e\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"disabled","ngClass","click"],[1,"material-icons","rotate",2,"font-size","1em"],[2,"display","inline-block","text-align","center","font-size","xx-small","color","gray","min-width","2em"],["title","\u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"disabled","ngClass","click"],["style","font-size: 0.8em; padding: 2px 5px;","title","\u30e1\u30cb\u30e5\u30fc",3,"click",4,"ngIf"],[1,"object-tags-box",3,"ngClass"],[1,"table-cell","image-box",3,"ngClass"],[1,"aura",3,"ngClass"],["class","inverser","draggable","false",3,"src","ngClass",4,"ngIf"],[1,"table-cell"],[1,"face-icon"],["alt","",3,"src"],["alt","",2,"filter","brightness(0)",3,"ngStyle","src"],["title","\u30e1\u30cb\u30e5\u30fc",2,"font-size","0.8em","padding","2px 5px",3,"click"],["draggable","false",1,"inverser",3,"src","ngClass"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","object-tag",4,"ngIf"],[1,"object-tag"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"tag-name"],[2,"text-align","center"],[2,"display","inline-block"],[1,"tag-value-box"],[1,"hidden-spacer",2,"font-weight","bold"],["appLogging","","size","1","placeholder","",1,"input","tag-value",3,"logging.name","logging.dataElement","type","ngModel","ngModelChange"],[1,"resource-tag"],[2,"font-size","0.8em","display","inline-block","margin-right","0.5em"],["appLogging","","type","number","size","1","placeholder","Value",1,"input","resource-value",3,"logging.name","logging.dataElement","ngModel","ngModelChange"],["appLogging","","type","range","min","0",3,"logging.name","logging.dataElement","title","max","ngStyle","ngModel","ngModelChange"],["appLogging","","type","checkbox",3,"logging.name","logging.dataElement","ngModel","checked","ngModelChange","change"],["style","font-size: smaller;",4,"ngIf"],[2,"font-size","smaller"],["target","_blank",3,"ngClass","click"],[1,"url-link"],["size","1",1,"input","tag-value",2,"min-width","4em",3,"type","min","ngModel","ngModelChange"]],template:function(e,i){if(1&e&&(Q(0,"div",0),Ae("input",function(){return i.onInput()}),Te(1,rY,1,0,"ng-container",1),Te(2,sY,1,0,"ng-container",1),Te(3,oY,2,1,"div",2),Te(4,dY,3,10,"div",3),Te(5,fY,3,1,"div",4),ie(),Te(6,pY,3,1,"ng-template",null,5,Un),Te(8,bY,2,2,"ng-template",null,6,Un),Te(10,NY,33,51,"ng-template",null,7,Un),Te(12,ZY,2,2,"ng-template",null,8,Un)),2&e){const r=Kt(7),s=Kt(9);U(1),re("ngTemplateOutlet",r),U(1),re("ngTemplateOutlet",s),U(1),re("ngIf",i.getGameObjects(i.selectTab).length<1),U(1),re("ngForOf",i.getGameObjects(i.selectTab))("ngForTrackBy",i.trackByGameObject),U(1),re("ngIf","graveyard"===i.selectTab)}},directives:[Sl,bn,oi,Yn,Ml,kl,la,Oa,mi,$i,di,es,Ur,Vr,Jr,Ji,Tl,Sd,qs,ps,gs,Id],pipes:[ai],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{width:100%}.box[_ngcontent-%COMP%]{border:transparent 2px solid;border-left:transparent 6px solid;margin-top:2px;padding:2px 2px 3px;box-sizing:border-box;border-bottom:1px dotted #666}.selected[_ngcontent-%COMP%]{padding:2px;border:2px dotted #666;border-left:6px solid #EFBC70}.selected.is-inventory-no-indicate[_ngcontent-%COMP%]{border-left-color:#80ccee}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;font-size:1em;min-width:1em;max-width:12em;overflow:hidden;padding:0 2px;box-sizing:border-box;white-space:nowrap}.input[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;padding:2px;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#EEE}.input[_ngcontent-%COMP%]:focus{background:#FFF}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.tab[_ngcontent-%COMP%]{padding:0;border:solid 1px #555;border-radius:.3em;overflow:hidden;display:flex;flex-flow:row nowrap;justify-content:space-around;align-items:stretch;text-align:center;margin:0;max-width:500px;background-color:#f0dabde6}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;flex:1 0 auto;flex-grow:1}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:checked{background:#555;color:#ccc}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{vertical-align:middle;outline:0;font-size:.6em;background-color:transparent;color:#444;box-sizing:border-box;margin:0;padding:2px 8px;cursor:pointer}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.is-sticky-top[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10000}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.table-cell[_ngcontent-%COMP%]{display:table-cell}.image-box[_ngcontent-%COMP%]{padding:0;width:32px;height:32px;display:table-cell;vertical-align:top}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%}.inventory-object[_ngcontent-%COMP%]{font-size:14px;display:inline-block;vertical-align:text-top}.object-name[_ngcontent-%COMP%]{font-size:.8em;font-weight:700;padding:0 .25em}.object-tags-box[_ngcontent-%COMP%]{display:table;table-layout:fixed}.object-tag[_ngcontent-%COMP%]{display:inline-block;padding:0 .25em;vertical-align:middle}.resource-tag[_ngcontent-%COMP%]{text-align:center;vertical-align:bottom;overflow:hidden;white-space:nowrap}.resource-value[_ngcontent-%COMP%]{font-weight:700;width:4em;text-align:right;font-family:inherit}.tag-name[_ngcontent-%COMP%]{font-size:.8em;text-align:left;vertical-align:bottom;min-width:1em;max-width:12em;overflow:hidden;white-space:nowrap}.tag-value-box[_ngcontent-%COMP%]{display:table-cell;width:10px}.tag-value[_ngcontent-%COMP%]{font-size:1em;font-weight:700;width:100%;min-width:1em;max-width:12em;text-align:center;font-family:inherit}.tag-value[type=number][_ngcontent-%COMP%]{min-width:3.4em;text-align:right}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.5}.inverser.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.inverser.is-hide-in[_ngcontent-%COMP%]{filter:invert(100%)}.inverser.black-paint.is-hide-in[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #00f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 3px #aaa) drop-shadow(0 -2px 2px #fff)}.material-icons.rotate[_ngcontent-%COMP%]{transform:rotate(90deg)}button.indicate[_ngcontent-%COMP%]:disabled{border-color:transparent}button.indicate[_ngcontent-%COMP%]:disabled   .material-icons[_ngcontent-%COMP%]{color:#000}button.indicate[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:.5}button.is-active[_ngcontent-%COMP%]{background-color:#fff}button.is-active[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:1}button.link[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}button.link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button.link[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}button.link[_ngcontent-%COMP%]:disabled{color:gray}button.link[_ngcontent-%COMP%]:disabled:hover{background-color:transparent}.face-icon[_ngcontent-%COMP%]{display:inline-block;width:12px;height:12px;max-width:12px;max-height:12px;vertical-align:middle;overflow:hidden}.face-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:.2rem}.self_only[_ngcontent-%COMP%]{color:red}.order-control[_ngcontent-%COMP%]{box-sizing:border-box;height:1.6em}.object-container.is-hide-in[_ngcontent-%COMP%]{background-color:#34549966}.object-container.is-hide-in[_ngcontent-%COMP%]   .game-object-name[_ngcontent-%COMP%], .object-tags-box.is-hide-in[_ngcontent-%COMP%]{color:#ddd;filter:invert(85%)}.image-box.is-hide-in[_ngcontent-%COMP%]{filter:invert(100%)}.object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:#ddd}.object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active, .object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{color:#222}.object-container[_ngcontent-%COMP%]{position:relative}.owner-tag[_ngcontent-%COMP%]{position:absolute;font-size:8px;width:-moz-min-content;width:min-content;max-width:100%;overflow:hidden;color:#f5f5f5;background-color:#1e1e1e;box-sizing:border-box;padding:2px 6px;border-radius:6px;white-space:nowrap;text-overflow:ellipsis;opacity:.9;top:1px;right:1px;pointer-events:none}.url-link[_ngcontent-%COMP%]{cursor:pointer}"],changeDetection:0}),t})();const QY=Ut.create("./assets/images/skeleton.png");let wu=(()=>{class t{constructor(){}getSkeletonOr(e){let i=e instanceof Ut?e:Nt.instance.get(e);return i&&!i.isEmpty?i:QY}getEmptyOr(e){let i=e instanceof Ut?e:Nt.instance.get(e);return i&&!i.isEmpty?i:Ut.Empty}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=rn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function JY(t,n){if(1&t&&(Q(0,"option",11),ye(1),ie()),2&t){const e=n.$implicit;Qe("color",""==e.name?"gray":""),ht("value",e.identifier),ht("title",e.name),U(1),Xe(""==e.name?"(\u7121\u540d\u306e\u30c6\u30fc\u30d6\u30eb)":e.name)}}function eZ(t,n){if(1&t&&(Q(0,"div",41)(1,"i",42),ye(2),ie()()),2&t){const e=_e(2);U(1),ud(e.isShowHideImages?"red-eye":"grow"),U(1),Xe(e.isShowHideImages?"visibility":"visibility_off")}}function tZ(t,n){if(1&t){const e=it();Q(0,"div")(1,"button",43),Ae("click",function(){return Oe(e),_e(2).openDistanceViewImageModal()}),ye(2,"\u80cc\u666f\u753b\u50cf\u3092\u8ffd\u52a0"),ie()()}if(2&t){const e=_e(2);U(1),re("disabled",!e.isEditable)}}function nZ(t,n){if(1&t&&(Q(0,"div",41)(1,"i",42),ye(2),ie()()),2&t){const e=_e(3);U(1),ud(e.isShowHideImages?"red-eye":"grow"),U(1),Xe(e.isShowHideImages?"visibility":"visibility_off")}}const eI=function(t){return{blackout:t}};function iZ(t,n){if(1&t){const e=it();Q(0,"div",13),Ae("click",function(){return Oe(e),_e(2).openDistanceViewImageModal()}),Te(1,nZ,3,3,"div",14),ot(2,"img",15),Et(3,"safe"),ie()}if(2&t){const e=_e(2);U(1),re("ngIf",e.getHidden(e.tableDistanceviewImage)),U(1),re("ngClass",ft(6,eI,!e.isShowHideImages&&e.getHidden(e.tableDistanceviewImage)))("src",Tt(3,3,e.tableDistanceviewImage.url,"resourceUrl"),en)}}function rZ(t,n){if(1&t&&(Q(0,"div",48),ye(1),ie()),2&t){const e=_e(3);U(1),Rn("",e.progresPercent,"%")}}const sZ=function(t){return{"is-hidden":t}};function oZ(t,n){if(1&t){const e=it();Ke(0),Q(1,"button",44),Ae("click",function(){return Oe(e),_e(2).save()}),Q(2,"div",45)(3,"div",32),ye(4,"\u4fdd\u5b58"),ie(),Te(5,rZ,2,1,"div",46),ie()(),Q(6,"button",47),Ae("click",function(){return Oe(e),_e(2).delete()}),ye(7,"\u524a\u9664"),ie(),Ye()}if(2&t){const e=_e(2);U(1),re("disabled",e.isSaveing),U(2),re("ngClass",ft(4,sZ,e.isSaveing)),U(2),re("ngIf",e.isSaveing),U(1),re("disabled",e.getGameTables().length<=1)}}function aZ(t,n){if(1&t){const e=it();Ke(0),Q(1,"button",49),Ae("click",function(){return Oe(e),_e(2).restore()}),ye(2,"\u5143\u306b\u623b\u3059"),ie(),Ye()}}const lZ=function(t){return{disabled:t}};function cZ(t,n){if(1&t){const e=it();Ke(0),Q(1,"div",12)(2,"div")(3,"b"),ye(4,"\u753b\u50cf"),ie(),Q(5,"div",13),Ae("click",function(){return Oe(e),_e().openBgImageModal()}),Te(6,eZ,3,3,"div",14),ot(7,"img",15),Et(8,"safe"),ie()(),Q(9,"div")(10,"b"),ye(11,"\u80cc\u666f"),ie(),Te(12,tZ,3,1,"div",10),Te(13,iZ,4,8,"div",16),ie()(),Q(14,"div")(15,"label",17),ye(16,"Name\uff1a"),Q(17,"input",18),Ae("ngModelChange",function(r){return Oe(e),_e().tableName=r}),ie()()(),Q(18,"div")(19,"label",17),ye(20,"Width\uff1a"),Q(21,"input",19),Ae("ngModelChange",function(r){return Oe(e),_e().tableWidth=r}),ie()(),Q(22,"input",20),Ae("ngModelChange",function(r){return Oe(e),_e().tableWidth=r}),ie()(),Q(23,"div")(24,"label",17),ye(25,"Height\uff1a"),Q(26,"input",21),Ae("ngModelChange",function(r){return Oe(e),_e().tableHeight=r}),ie()(),Q(27,"input",20),Ae("ngModelChange",function(r){return Oe(e),_e().tableHeight=r}),ie()(),Q(28,"div")(29,"label",17),ye(30,"\u30b0\u30ea\u30c3\u30c9\uff1a "),Q(31,"select",22),Ae("ngModelChange",function(r){return Oe(e),_e().tableGridType=r}),Q(32,"option",23),ye(33,"\u306a\u3057"),ie(),Q(34,"option",24),ye(35,"\u30b9\u30af\u30a8\u30a2"),ie(),Q(36,"option",25),ye(37,"\u30d8\u30af\u30b9\uff08\u7e26\u63c3\u3048\uff09"),ie(),Q(38,"option",26),ye(39,"\u30d8\u30af\u30b9\uff08\u6a2a\u63c3\u3048\uff09"),ie()()(),Q(40,"label",27),ye(41,"\u8272\uff1a "),Q(42,"select",28),Ae("ngModelChange",function(r){return Oe(e),_e().tableGridColor=r}),Q(43,"option",29),ye(44,"\u9ed2"),ie(),Q(45,"option",30),ye(46,"\u767d"),ie()()()(),Q(47,"div")(48,"label",17)(49,"input",31),Ae("ngModelChange",function(r){return Oe(e),_e().tableGridNumberShow=r}),ie(),Q(50,"span",32),ye(51,"\u30b0\u30ea\u30c3\u30c9\u306e\u5ea7\u6a19\u756a\u53f7\u3092\u8868\u793a"),ie()()(),Q(52,"div")(53,"label",17),ye(54,"\u80cc\u666f\u30d5\u30a3\u30eb\u30bf\uff1a "),Q(55,"select",33),Ae("ngModelChange",function(r){return Oe(e),_e().tableDistanceviewFilter=r}),Q(56,"option",34),ye(57,"\u306a\u3057"),ie(),Q(58,"option",35),ye(59,"\u30db\u30ef\u30a4\u30c8"),ie(),Q(60,"option",36),ye(61,"\u30d6\u30e9\u30c3\u30af"),ie()()()(),ot(62,"hr"),Q(63,"div")(64,"label",17)(65,"input",37),Ae("ngModelChange",function(r){return Oe(e),_e().tableGridShow=r}),ie(),ye(66," \u30b0\u30ea\u30c3\u30c9\u3092\u5e38\u306b\u8868\u793a"),Q(67,"sup",38),ye(68,"*"),ie()(),Q(69,"label",39)(70,"input",40),Ae("ngModelChange",function(r){return Oe(e),_e().tableGridSnap=r}),ie(),ye(71," \u30b9\u30ca\u30c3\u30d7"),Q(72,"sup",38),ye(73,"*"),ie()(),Te(74,oZ,8,6,"ng-container",10),Te(75,aZ,3,0,"ng-container",10),ie(),Ye()}if(2&t){const e=_e();U(6),re("ngIf",e.getHidden(e.tableBackgroundImage)),U(1),re("ngClass",ft(41,eI,!e.isShowHideImages&&e.getHidden(e.tableBackgroundImage)))("src",Tt(8,38,e.tableBackgroundImage.url,"resourceUrl"),en),U(5),re("ngIf",!e.tableDistanceviewImage.url),U(1),re("ngIf",e.tableDistanceviewImage.url),U(4),re("ngModel",e.tableName)("disabled",!e.isEditable),U(4),ht("title",e.tableWidth),ht("min",e.minSize),ht("max",e.maxSize),re("ngModel",e.tableWidth)("disabled",!e.isEditable),U(1),ht("min",e.minSize),ht("max",e.maxSize),re("ngModel",e.tableWidth)("disabled",!e.isEditable),U(4),ht("title",e.tableHeight),ht("min",e.minSize),ht("max",e.maxSize),re("ngModel",e.tableHeight)("disabled",!e.isEditable),U(1),ht("min",e.minSize),ht("max",e.maxSize),re("ngModel",e.tableHeight)("disabled",!e.isEditable),U(4),re("ngModel",e.tableGridType)("disabled",!e.isEditable),U(11),re("ngModel",e.tableGridColor)("disabled",!e.isEditable||-1==e.tableGridType),U(7),re("ngModel",e.tableGridNumberShow)("disabled",!e.isEditable||-1==e.tableGridType),U(1),re("ngClass",ft(43,lZ,!e.isEditable||-1==e.tableGridType)),U(5),re("ngModel",e.tableDistanceviewFilter)("disabled",!e.isEditable),U(10),re("ngModel",e.tableGridShow),U(5),re("ngModel",e.tableGridSnap),U(4),re("ngIf",!e.isDeleted),U(1),re("ngIf",e.isDeleted)}}function uZ(t,n){1&t&&(Ke(0),Q(1,"div",50),ye(2,"\u203b\u30c6\u30fc\u30d6\u30eb\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b\u300d\u304b\u3089\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),ie(),Ye())}const dZ=function(t){return{"red-eye":t}};let tI=(()=>{class t{constructor(e,i,r,s,o){this.changeDetector=e,this.modalService=i,this.saveDataService=r,this.imageService=s,this.panelService=o,this.minSize=1,this.maxSize=100,this.isShowHideImages=!1,this.selectedTable=null,this.selectedTableXml="",this.isSaveing=!1,this.progresPercent=0}get tableBackgroundImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.imageIdentifier:null)}get tableDistanceviewImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.backgroundImageIdentifier:null)}get tableName(){return this.selectedTable.name}set tableName(e){this.isEditable&&(this.selectedTable.name=e)}get tableWidth(){return this.selectedTable.width}set tableWidth(e){this.isEditable&&(this.selectedTable.width=e)}get tableHeight(){return this.selectedTable.height}set tableHeight(e){this.isEditable&&(this.selectedTable.height=e)}get tableGridColor(){return this.selectedTable.gridColor}set tableGridColor(e){this.isEditable&&(this.selectedTable.gridColor=e)}get tableGridShow(){return this.tableSelecter.gridShow}set tableGridShow(e){this.tableSelecter.gridShow=e,ze.trigger("UPDATE_GAME_OBJECT",this.tableSelecter.toContext())}get tableGridSnap(){return this.tableSelecter.gridSnap}set tableGridSnap(e){this.tableSelecter.gridSnap=e}get tableGridType(){return this.selectedTable.gridType}set tableGridType(e){this.isEditable&&(this.selectedTable.gridType=Number(e))}get tableGridNumberShow(){return this.selectedTable.isShowNumber}set tableGridNumberShow(e){this.selectedTable.isShowNumber=e,ze.trigger("UPDATE_GAME_OBJECT",this.tableSelecter.toContext())}get tableDistanceviewFilter(){return this.selectedTable.backgroundFilterType}set tableDistanceviewFilter(e){this.isEditable&&(this.selectedTable.backgroundFilterType=e)}get tableSelecter(){return dr.instance}get isEmpty(){return!this.tableSelecter||!this.tableSelecter.viewTable}get isDeleted(){return!this.selectedTable||null==dt.instance.get(this.selectedTable.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}ngOnInit(){Promise.resolve().then(()=>{this.modalService.title=this.panelService.title="\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a"}),this.selectedTable=this.tableSelecter.viewTable,ze.register(this).on("DELETE_GAME_OBJECT",2e3,e=>{if(!this.selectedTable||e.data.identifier!==this.selectedTable.identifier)return;let i=dt.instance.get(e.data.identifier);null!==i&&(this.selectedTableXml=i.toXml())})}ngAfterViewInit(){}ngOnDestroy(){ze.unregister(this)}selectGameTable(e){ze.call("SELECT_GAME_TABLE",{identifier:e},xt.peerId),this.selectedTable=dt.instance.get(e),this.selectedTableXml=""}getGameTables(){return dt.instance.getObjects(Vi)}createGameTable(){let e=new Vi;e.name="\u767d\u7d19\u306e\u30c6\u30fc\u30d6\u30eb",e.imageIdentifier="testTableBackgroundImage_image",e.initialize(),this.selectGameTable(e.identifier)}save(){var e=this;return(0,tn.Z)(function*(){!e.selectedTable||e.isSaveing||(e.isSaveing=!0,e.progresPercent=0,e.selectedTable.selected=!0,yield e.saveDataService.saveGameObjectAsync(e.selectedTable,"fly_map_"+e.selectedTable.name,i=>{e.progresPercent=i}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500))})()}delete(){!this.isEmpty&&this.selectedTable&&(this.selectedTableXml=this.selectedTable.toXml(),this.selectedTable.destroy())}restore(){if(this.selectedTable&&this.selectedTableXml){let e=ti.instance.parseXml(this.selectedTableXml);this.selectGameTable(e.identifier),this.selectedTableXml=""}}getHidden(e){const i=wn.get(e.identifier);return!!i&&i.hide}openBgImageModal(){if(this.isDeleted)return;let e=[];this.selectedTable&&this.selectedTable.imageIdentifier&&(e=[this.selectedTable.imageIdentifier]),this.modalService.open(Ko,{currentImageIdentifires:e}).then(i=>{!this.selectedTable||!i||(this.selectedTable.imageIdentifier=i)})}openDistanceViewImageModal(){if(this.isDeleted)return;let e=[];this.selectedTable&&this.selectedTable.backgroundImageIdentifier&&(e=[this.selectedTable.backgroundImageIdentifier]),this.modalService.open(Ko,{isAllowedEmpty:!0,currentImageIdentifires:e}).then(i=>{!this.selectedTable||!i||(this.selectedTable.backgroundImageIdentifier=i)})}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(er,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:Si.OK_CANCEL,materialIcon:"visibility",action:()=>{this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}}return t.\u0275fac=function(e){return new(e||t)(He(Oi),He(Fn),He(Dr),He(wu),He(An))},t.\u0275cmp=Xt({type:t,selectors:[["game-table-setting"]],decls:15,vars:9,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[2,"margin-bottom","2px","font-size","smaller",3,"click"],["size","10",2,"width","100%","max-width","155px",3,"ngModel","change"],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[2,"float","right","margin-top","3px","margin-right","3px"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[4,"ngIf"],[3,"value","title"],[1,"images-select"],[2,"position","relative","overflow","hidden","cursor","pointer",3,"click"],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["height","120",3,"ngClass","src"],["style","position: relative; overflow: hidden; cursor: pointer",3,"click",4,"ngIf"],[1,"self-setting"],["placeholder","Name",3,"ngModel","disabled","ngModelChange"],["type","range","name","tableWidth",3,"ngModel","title","min","max","disabled","ngModelChange"],["type","number",2,"width","5em",3,"ngModel","min","max","disabled","ngModelChange"],["type","range","name","tableHeight",3,"ngModel","title","min","max","disabled","ngModelChange"],["name","tableGridType",3,"ngModel","disabled","ngModelChange"],["value","-1"],["value","0"],["value","1"],["value","2"],[1,"self-setting",2,"margin-left","3px"],["name","tableGridColor",3,"ngModel","disabled","ngModelChange"],["value","#000000e6"],["value","#dddddde6"],["type","checkbox","name","tableGridNumberShow",3,"ngModel","disabled","ngModelChange"],[3,"ngClass"],["name","tableDistanceviewFilter",3,"ngModel","disabled","ngModelChange"],["value",""],["value","white"],["value","black"],["type","checkbox","name","tableGridShow",3,"ngModel","ngModelChange"],[1,"self-only"],[1,"self-setting",2,"margin-left","1em"],["type","checkbox","name","tableGridSnap",3,"ngModel","ngModelChange"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons",2,"margin-right","2px","font-size","16px","display","block"],[2,"height","120px",3,"disabled","click"],[2,"margin-left","2em",3,"disabled","click"],[2,"position","relative"],["class","progress",4,"ngIf"],[1,"danger",3,"disabled","click"],[1,"progress"],[3,"click"],[2,"font-size","12px"]],template:function(e,i){1&e&&(Q(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Ae("click",function(){return i.createGameTable()}),ye(4,"\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b"),ie()(),Q(5,"select",3),Ae("change",function(s){return i.selectGameTable(s.target.value)}),Te(6,JY,2,5,"option",4),ie()(),Q(7,"div",5)(8,"div",6)(9,"label",7)(10,"input",8),Ae("click",function(s){return i.onShowHiddenImages(s)}),ie(),Q(11,"i",9),ye(12),ie()()(),Te(13,cZ,76,45,"ng-container",10),ie()(),Te(14,uZ,3,0,"ng-container",10)),2&e&&(U(5),re("ngModel",null==i.selectedTable?null:i.selectedTable.identifier),U(1),re("ngForOf",i.getGameTables()),U(4),ht("checked",i.isShowHideImages?"checked":""),U(1),re("ngClass",ft(7,dZ,i.isShowHideImages)),U(1),Xe(i.isShowHideImages?"visibility":"visibility_off"),U(1),re("ngIf",!i.isEmpty||i.selectedTable),U(1),re("ngIf",i.isEmpty))},directives:[es,$i,di,oi,Ur,Vr,Yn,bn,mi,gs,ps,Oo,Fo,Jr],pipes:[ai],styles:["[_nghost-%COMP%]{display:block}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.images-select[_ngcontent-%COMP%]{display:flex}input[type=number][_ngcontent-%COMP%]{text-align:right}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.blackout[_ngcontent-%COMP%]{filter:blur(12px) grayscale(70%)}.self-only[_ngcontent-%COMP%]{color:red}img[_ngcontent-%COMP%]{transition:all .1s 0s ease}.self-setting[_ngcontent-%COMP%]{font-weight:bolder;font-size:smaller}.disabled[_ngcontent-%COMP%]{color:gray;font-weight:400}"]}),t})();function fZ(t,n){if(1&t){const e=it();Q(0,"button",21),Ae("click",function(){Oe(e);const r=_e().$implicit;return _e().play(r)}),Q(1,"i",22),ye(2,"play_arrow"),ie(),ye(3,"\u8a66\u8074"),Q(4,"sup",23),ye(5,"*"),ie()()}2&t&&re("disabled",!_e().$implicit.isReady)}function hZ(t,n){if(1&t){const e=it();Q(0,"button",21),Ae("click",function(){return Oe(e),_e(2).stop()}),Q(1,"i",22),ye(2,"stop"),ie(),ye(3,"\u8a66\u8074"),Q(4,"sup",23),ye(5,"*"),ie()()}2&t&&re("disabled",!_e().$implicit.isReady)}function pZ(t,n){if(1&t){const e=it();Q(0,"button",21),Ae("click",function(){Oe(e);const r=_e().$implicit;return _e().playBGM(r)}),Q(1,"i",22),ye(2,"loop"),ie(),ye(3,"\uff22\uff27\uff2d"),ie()}2&t&&re("disabled",!_e().$implicit.isReady)}function gZ(t,n){if(1&t){const e=it();Q(0,"button",21),Ae("click",function(){Oe(e);const r=_e().$implicit;return _e().stopBGM(r)}),Q(1,"i",22),ye(2,"stop"),ie(),ye(3,"\uff22\uff27\uff2d"),ie()}2&t&&re("disabled",!_e().$implicit.isReady)}function _Z(t,n){1&t&&(Q(0,"span",20)(1,"b"),ye(2,"\u3010\u8a66\u8074\u4e2d\u3011"),ie()())}function mZ(t,n){1&t&&(Q(0,"span",20)(1,"b"),ye(2,"\u3010\uff22\uff27\uff2d\u3011"),ie()())}function $Z(t,n){1&t&&(Q(0,"span",20)(1,"b"),ye(2,"\u3010\u8a66\u8074/BGM\u3011"),ie()())}function vZ(t,n){if(1&t&&(Ke(0),Te(1,mZ,3,0,"span",18),Te(2,$Z,3,0,"span",18),Ye()),2&t){const e=_e().$implicit,i=_e();U(1),re("ngIf",e!=(null==i.auditionPlayer?null:i.auditionPlayer.audio)||e==(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&(null==i.auditionPlayer?null:i.auditionPlayer.paused)),U(1),re("ngIf",e===(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&!(null!=i.auditionPlayer&&i.auditionPlayer.paused))}}const bZ=function(t){return{last:t}};function yZ(t,n){if(1&t&&(Q(0,"div",16),Te(1,fZ,6,1,"button",17),Te(2,hZ,6,1,"button",17),Te(3,pZ,4,1,"button",17),Te(4,gZ,4,1,"button",17),Te(5,_Z,3,0,"span",18),Te(6,vZ,3,2,"ng-container",19),Q(7,"span",20),ye(8),ie()()),2&t){const e=n.$implicit,i=n.last,r=_e();re("ngClass",ft(10,bZ,i)),U(1),re("ngIf",e!==(null==r.auditionPlayer?null:r.auditionPlayer.audio)||(null==r.auditionPlayer?null:r.auditionPlayer.paused)),U(1),re("ngIf",e===(null==r.auditionPlayer?null:r.auditionPlayer.audio)&&!(null!=r.auditionPlayer&&r.auditionPlayer.paused)),U(1),re("ngIf",e!==(null==r.jukebox?null:r.jukebox.audio)),U(1),re("ngIf",e===(null==r.jukebox?null:r.jukebox.audio)),U(1),re("ngIf",e===(null==r.auditionPlayer?null:r.auditionPlayer.audio)&&!(null!=r.auditionPlayer&&r.auditionPlayer.paused)&&e!=(null==r.jukebox?null:r.jukebox.audio)),U(1),re("ngIf",e===(null==r.jukebox?null:r.jukebox.audio)),U(1),Qe("font-weight",e===(null==r.jukebox?null:r.jukebox.audio)?"bolder":"normal"),U(1),Xe(e.name)}}function CZ(t,n){1&t&&(Q(0,"div",24)(1,"small")(2,"b"),ye(3,"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u3053\u3053\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002"),ie()()())}let xZ=(()=>{class t{constructor(e,i,r){this.modalService=e,this.panelService=i,this.ngZone=r,this.auditionPlayer=new Ft,this.lazyUpdateTimer=null}get volume(){return Ft.volume}set volume(e){Ft.volume=e,ze.trigger("CHANGE_JUKEBOX_VOLUME",null)}get auditionVolume(){return Ft.auditionVolume}set auditionVolume(e){Ft.auditionVolume=e,ze.trigger("CHANGE_JUKEBOX_VOLUME",null)}get audios(){return zt.instance.audios.filter(e=>!e.isHidden)}get jukebox(){return dt.instance.get("Jukebox")}get percentAuditionVolume(){return Math.floor(100*Ft.auditionVolume)}set percentAuditionVolume(e){Ft.auditionVolume=e/100}get percentVolume(){return Math.floor(100*Ft.volume)}set percentVolume(e){Ft.volume=e/100}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30b8\u30e5\u30fc\u30af\u30dc\u30c3\u30af\u30b9"),this.auditionPlayer.volumeType=Ka.AUDITION,ze.register(this).on("*",e=>{e.eventName.startsWith("FILE_")&&this.lazyNgZoneUpdate()})}ngOnDestroy(){ze.unregister(this),this.stop()}play(e){this.auditionPlayer.play(e)}stop(){this.auditionPlayer.stop()}playBGM(e){this.jukebox.play(e.identifier,!0)}stopBGM(e){this.jukebox.audio===e&&this.jukebox.stop()}handleFileSelect(e){let i=e.target,r=i.files;r.length&&Wo.instance.load(r),i.value=""}lazyNgZoneUpdate(){null===this.lazyUpdateTimer&&(this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,this.ngZone.run(()=>{})},100))}}return t.\u0275fac=function(e){return new(e||t)(He(Fn),He(An),He(Cn))},t.\u0275cmp=Xt({type:t,selectors:[["app-jukebox"]],decls:52,vars:10,consts:[[1,"header",2,"position","sticky","top","0px"],[1,"self-only"],[1,"material-icons",2,"font-size","22px"],["type","range","min","0","max","1","step","0.01",2,"width","53%",3,"ngModel","title","ngModelChange"],[2,"white-space","nowrap"],["type","number","min","0","max","100","step","1",2,"width","3em",3,"ngModel","ngModelChange"],[2,"font-size","smaller","padding-left","3px"],[2,"margin-bottom","3px"],["class","box","style","white-space: nowrap; text-overflow: ellipsis; overflow: hidden",3,"ngClass",4,"ngFor","ngForOf"],["style","padding: 1em 0px; text-align: center",4,"ngIf"],[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","audio/*",2,"display","none",3,"change"],[2,"font-size","12px","margin-top","3px"],[2,"font-size","12px"],[1,"box",2,"white-space","nowrap","text-overflow","ellipsis","overflow","hidden",3,"ngClass"],[3,"disabled","click",4,"ngIf"],["style","padding-left: 2px",4,"ngIf"],[4,"ngIf"],[2,"padding-left","2px"],[3,"disabled","click"],[1,"material-icons"],[1,"self-only",2,"font-size","larger"],[2,"padding","1em 0px","text-align","center"]],template:function(e,i){1&e&&(Q(0,"div",0)(1,"div")(2,"b"),ye(3,"\u8a66\u8074\u97f3\u91cf"),Q(4,"sup",1),ye(5,"*"),ie(),ye(6,"\uff1a"),ie(),Q(7,"i",2),ye(8),ie(),Q(9,"input",3),Ae("ngModelChange",function(s){return i.auditionVolume=s}),ie(),Q(10,"span",4)(11,"input",5),Ae("ngModelChange",function(s){return i.percentAuditionVolume=s}),ie(),Q(12,"b",6),ye(13,"%"),ie()()(),Q(14,"div")(15,"b"),ye(16,"\u518d\u751f\u97f3\u91cf"),Q(17,"sup",1),ye(18,"*"),ie(),ye(19,"\uff1a"),ie(),Q(20,"i",2),ye(21),ie(),Q(22,"input",3),Ae("ngModelChange",function(s){return i.volume=s}),ie(),Q(23,"span",4)(24,"input",5),Ae("ngModelChange",function(s){return i.percentVolume=s}),ie(),Q(25,"b",6),ye(26,"%"),ie()()()(),Q(27,"div",7),Te(28,yZ,9,12,"div",8),Te(29,CZ,4,0,"div",9),ie(),Q(30,"label")(31,"div",10)(32,"div")(33,"i",11),ye(34,"playlist_add"),ie()(),Q(35,"div"),ye(36,"\u3053\u3053\u306b\u97f3\u697d\u3092\u30c9\u30ed\u30c3\u30d7"),ie(),Q(37,"div",12),ye(38,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),ie(),Q(39,"input",13),Ae("change",function(s){return i.handleFileSelect(s)}),ie(),Q(40,"div",12),ot(41,"br"),ye(42,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d10MB\u307e\u3067"),ie()()(),Q(43,"div",14),ye(44,"\u203b\u300c\u8a66\u8074"),Q(45,"sup",1),ye(46,"*"),ie(),ye(47,"\u300d\u306f\u81ea\u5206\u306e\u30b9\u30d4\u30fc\u30ab\u30fc\u3060\u3051\u3067\u97f3\u697d\u30921\u56de\u518d\u751f\u3057\u307e\u3059\u3002"),ie(),Q(48,"div",15),ye(49,"\u203b\u300cBGM\u300d\u306f\u30eb\u30fc\u30e0\u5185\u306e\u5168\u54e1\u30671\u3064\u306e\u97f3\u697d\u3092\u30eb\u30fc\u30d7\u518d\u751f\u3057\u307e\u3059\u3002"),ie(),Q(50,"div",15),ye(51,"\u203b\u73fe\u884c\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u306b\u306f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u542b\u307e\u308c\u307e\u305b\u3093\u3002\uff08\u6bce\u56de\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u304c\u5fc5\u8981\u3067\u3059\uff09"),ie()),2&e&&(U(8),Xe(0==i.auditionVolume?"volume_off":i.auditionVolume<=.5?"volume_down":"volume_up"),U(1),ht("title",i.percentAuditionVolume+"%"),re("ngModel",i.auditionVolume),U(2),re("ngModel",i.percentAuditionVolume),U(10),Xe(0==i.volume?"volume_off":i.volume<=.5?"volume_down":"volume_up"),U(1),ht("title",i.percentVolume+"%"),re("ngModel",i.volume),U(2),re("ngModel",i.percentVolume),U(4),re("ngForOf",i.audios),U(1),re("ngIf",i.audios.length<1))},directives:[gs,mi,$i,di,Oo,Fo,ps,oi,Yn,bn],styles:['[_nghost-%COMP%]{display:block}.drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.box[_ngcontent-%COMP%]{font-size:smaller;border-bottom:1px dotted #888;vertical-align:baseline}.box.last[_ngcontent-%COMP%]{border-bottom:0px none transparent}.volume[_ngcontent-%COMP%]{display:inline-block;width:3em;text-align:right}input[type=number][_ngcontent-%COMP%]{text-align:right}.self-only[_ngcontent-%COMP%]{color:red}button[_ngcontent-%COMP%]   .self-only[_ngcontent-%COMP%]{vertical-align:text-top}.box[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:12px;height:26px;width:5.6em;margin-left:0;margin-right:0}button[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:12px}.header[_ngcontent-%COMP%]{background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border-bottom:dotted 1px #888}']}),t})();const wZ=["content"],EZ=["*"];let TZ=(()=>{class t{constructor(e){this.modalService=e}clickBackground(e){e.target===e.currentTarget&&this.resolve()}resolve(){this.modalService.resolve(null)}reject(){this.modalService.reject()}}return t.\u0275fac=function(e){return new(e||t)(He(Fn))},t.\u0275cmp=Xt({type:t,selectors:[["modal"]],viewQuery:function(e,i){if(1&e&&cn(wZ,7,zr),2&e){let r;ln(r=un())&&(i.content=r.first)}},ngContentSelectors:EZ,decls:13,vars:3,consts:[[1,"component"],[1,"modal-background",3,"click"],[1,"modal-panel"],[1,"title"],[1,"title-button"],[3,"click"],[1,"material-icons",2,"font-size","14px"],[1,"scrollable-panel"],["content",""]],template:function(e,i){1&e&&(mm(),Q(0,"div",0)(1,"div",1),Ae("click",function(s){return i.clickBackground(s)}),ie(),Q(2,"div",2)(3,"div",3)(4,"div",4)(5,"button",5),Ae("click",function(){return i.resolve()}),Q(6,"i",6),ye(7,"close"),ie()()(),ye(8),ie(),Q(9,"div",7),$m(10),ot(11,"div",null,8),ie()()()),2&e&&(U(1),re("@bgInOut","in"),U(1),re("@flyInOut","in"),U(6),Rn(" ",i.modalService.title," "))},styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;inset:0;z-index:1899999;display:flex;align-items:center;justify-content:center;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.modal-background[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;color:#ccc;background-color:#1e1e1e4d;inset:0;z-index:-1}.modal-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:hidden;color:#444;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;height:auto;max-height:calc(100% - 10px);width:800px;max-width:100%}.title[_ngcontent-%COMP%]{position:relative;overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;padding:2px 5px;width:100%;background-color:#ccc;color:#444}.title-button[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#444}.header[_ngcontent-%COMP%], .content[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]{padding:10px}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;max-height:calc(100vh - 41px);width:100%;padding:8px}"],data:{animation:[Sn("flyInOut",[Lt("void => *",[Rt("100ms ease-out",sn([et({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),et({transform:"scale(1.0, 1.0)",opacity:"1.0",offset:1})]))]),Lt("* => void",[Rt(100,et({transform:"scale(0, 0)"}))])]),Sn("bgInOut",[ap("in",et({"background-color":"rgba(30, 30, 30, 0.4)"})),Lt("void => *",[et({"background-color":"rgba(30, 30, 30, 0.0)"}),Rt(200)]),Lt("* => void",[Rt(200,et({"background-color":"rgba(30, 30, 30, 0.0)"}))])])]}}),t})();var mn=(()=>(function(t){t.N="n",t.E="e",t.W="w",t.S="s",t.NE="ne",t.NW="nw",t.SE="se",t.SW="sw"}(mn||(mn={})),mn))();class SZ{constructor(n,e){this.target=n,this.type=e,this.input=null,this.handle=null,this.width=12,this.initialize()}initialize(){this.handle=this.target.ownerDocument.createElement("div"),this.handle.classList.add("ui-resize-handler-"+this.type),this.input=new js(this.handle),this.target.appendChild(this.handle);let n=this.handle.style;switch(n.position="absolute",n.zIndex="1",n.backgroundColor="transparent",this.type){case mn.N:n.top=3*-this.width/4+"px",n.left="0px",n.right="0px",n.height=`${this.width}px`;break;case mn.E:n.top="0px",n.bottom="0px",n.right=3*-this.width/4+"px",n.width=`${this.width}px`;break;case mn.W:n.top="0px",n.bottom="0px",n.left=3*-this.width/4+"px",n.width=`${this.width}px`;break;case mn.S:n.bottom=3*-this.width/4+"px",n.left="0px",n.right="0px",n.height=`${this.width}px`;break;case mn.NE:n.top=3*-this.width/4+"px",n.right=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.zIndex="2";break;case mn.NW:n.top=3*-this.width/4+"px",n.left=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.zIndex="2";break;case mn.SE:n.bottom=3*-this.width/4+"px",n.right=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.zIndex="2";break;case mn.SW:n.bottom=3*-this.width/4+"px",n.left=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.zIndex="2"}this.cursor(!0)}destroy(){this.handle.remove(),this.input.destroy()}cursor(n){let e=this.handle.style;if(n)switch(this.type){case mn.N:e.cursor="ns-resize";break;case mn.E:case mn.W:e.cursor="ew-resize";break;case mn.S:e.cursor="ns-resize";break;case mn.NE:e.cursor="nesw-resize";break;case mn.NW:case mn.SE:e.cursor="nwse-resize";break;case mn.SW:e.cursor="nesw-resize"}else e.cursor="default"}}let IZ=(()=>{class t{constructor(e,i){this.ngZone=e,this.elementRef=i,this.boundsSelector="body",this.stackSelector="",this.minWidth=100,this.minHeight=100,this.ostart=new Tn,this.onmove=new Tn,this.onend=new Tn,this.handleMap=new Map,this._isDisable=!1,this._align="normal",this.startPosition={left:0,top:0,width:0,height:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={left:0,top:0,width:0,height:0}}set isDisable(e){this._isDisable=e,this.initialize()}set align(e){this._align=e,this.initialize()}get handleTypes(){return this._isDisable||"none"===this._align?[]:"horizontal"===this._align?[mn.E,mn.W]:"vertical"===this._align?[mn.N,mn.S]:[mn.N,mn.E,mn.W,mn.S,mn.NE,mn.NW,mn.SE,mn.SW]}ngAfterViewInit(){this.initialize(),this.setForeground()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.handleMap.forEach(e=>e.destroy()),this.handleMap.clear(),this.handleTypes.forEach(e=>{let i=new SZ(this.elementRef.nativeElement,e);this.handleMap.set(e,i),i.input.onStart=r=>this.onResizeStart(r,i),i.input.onMove=r=>this.onResizeMove(r,i),i.input.onEnd=r=>this.onResizeEnd(r,i),i.input.onContextMenu=r=>this.onContextMenu(r,i)})})}cancel(){this.handleMap.forEach(e=>e.input.cancel())}destroy(){this.handleMap.forEach(e=>e.destroy()),this.handleMap.clear()}onResizeStart(e,i){if(this._isDisable||1===e.button||2===e.button)return this.cancel();this.setForeground(),this.handleMap.forEach(r=>{r!==i&&r.input.cancel()}),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=i.input.pointer,this.prevTrans={left:0,top:0,width:0,height:0},e.stopPropagation()}onResizeMove(e,i){let r={left:0,top:0,width:i.input.pointer.x-this.startPointer.x,height:i.input.pointer.y-this.startPointer.y};switch(i.type){case mn.N:case mn.S:r.width=0;break;case mn.E:case mn.W:r.height=0}switch(i.type){case mn.SW:r.left=r.width,r.width*=-1;break;case mn.NE:r.top=r.height,r.height*=-1;break;case mn.E:case mn.S:case mn.SE:break;case mn.N:case mn.W:case mn.NW:r.left=r.width,r.top=r.height,r.width*=-1,r.height*=-1}r.width+this.startPosition.width<this.minWidth&&(r.width=this.minWidth-this.startPosition.width,r.left=0!==r.left?-r.width:r.left),r.height+this.startPosition.height<this.minHeight&&(r.height=this.minHeight-this.startPosition.height,r.top=0!==r.top?-r.height:r.top);let o=this.calcCorrectionPosition({left:r.left-this.prevTrans.left,top:r.top-this.prevTrans.top,width:r.width-this.prevTrans.width,height:r.height-this.prevTrans.height});r.left+=o.left,r.top+=o.top,r.width+=o.width,r.height+=o.height,this.elementRef.nativeElement.style.left=r.left+this.startPosition.left+"px",this.elementRef.nativeElement.style.top=r.top+this.startPosition.top+"px",this.elementRef.nativeElement.style.width=r.width+this.startPosition.width+"px",this.elementRef.nativeElement.style.height=r.height+this.startPosition.height+"px",this.prevTrans=r,e.cancelable&&e.preventDefault(),e.stopPropagation()}onResizeEnd(e,i){i.input.isDragging&&e.cancelable&&e.preventDefault(),e.stopPropagation()}onContextMenu(e,i){e.stopPropagation()}calcCorrectionPosition(e={left:0,top:0,width:0,height:0}){let i={left:0,top:0,width:0,height:0},r=this.elementRef.nativeElement.getBoundingClientRect(),s=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();return s.right<r.right+e.left+e.width&&(i.width+=s.right-(r.right+e.left+e.width)),r.left+e.left<s.left&&(i.left+=s.left-(r.left+e.left),i.width-=i.left),s.bottom<r.bottom+e.top+e.height&&(i.height+=s.bottom-(r.bottom+e.top+e.height)),r.top+e.top<s.top&&(i.top+=s.top-(r.top+e.top),i.height-=i.top),i}calcElementPosition(e){let i=window.getComputedStyle(e);return{left:Bi.relation(i.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),top:Bi.relation(i.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),width:Bi.relation(i.width,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),height:Bi.relation(i.height,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight)}}setForeground(){if(this.stackSelector.length<1)return;let e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),i=0,r=99999;e.forEach(s=>{let o=parseInt(s.style.zIndex);i<o&&(i=o),o<r&&(r=o)}),!(i<=parseInt(this.elementRef.nativeElement.style.zIndex))&&(e.forEach(s=>{s.style.zIndex=parseInt(s.style.zIndex)-r+""}),this.elementRef.nativeElement.style.zIndex=i+1+"")}}return t.\u0275fac=function(e){return new(e||t)(He(Cn),He(yi))},t.\u0275dir=Qt({type:t,selectors:[["","appResizable",""]],inputs:{boundsSelector:["resizable.bounds","boundsSelector"],stackSelector:["resizable.stack","stackSelector"],minWidth:["resizable.minWidth","minWidth"],minHeight:["resizable.minHeight","minHeight"],isDisable:["resizable.disable","isDisable"],align:["resizable.align","align"]},outputs:{ostart:"resizable.start",onmove:"resizable.move",onend:"resizable.end"}}),t})();const kZ=["draggablePanel"],MZ=["scrollablePanel"],DZ=["content"],AZ=["titleBar"];function PZ(t,n){if(1&t){const e=it();Q(0,"button",11),Ae("click",function(){return Oe(e),_e().toggleRotate()}),Q(1,"i",12),ye(2,"pivot_table_chart"),ie()()}}function NZ(t,n){if(1&t){const e=it();Q(0,"button",13),Ae("click",function(){return Oe(e),_e().toggleMinimize()}),Q(1,"i",14),ye(2),ie()()}if(2&t){const e=_e();U(1),Qe("font-size",e.isMinimized?12:14,"px"),U(1),Xe(e.isMinimized?"crop_din":"minimize")}}function FZ(t,n){if(1&t){const e=it();Q(0,"button",13),Ae("click",function(){return Oe(e),_e().toggleFullScreen()}),Q(1,"i",14),ye(2),ie()()}if(2&t){const e=_e();U(1),Qe("font-size",e.isFullScreen&&!e.isMinimized?12:14,"px"),U(1),Xe(e.isFullScreen?e.isMinimized?"minimize":"crop_din":"fullscreen")}}function OZ(t,n){if(1&t){const e=it();Q(0,"button",13),Ae("click",function(){return Oe(e),_e().close()}),Q(1,"i",12),ye(2,"close"),ie()()}}const RZ=function(t,n,e,i){return{"pointer-events-none":t,"is-full-screen":n,"is-minimized":e,"i-am-gm":i}},BZ=function(t){return{rotateble:t}},LZ=function(t,n){return{overlay:t,horizontal:n}},zZ=["*"];let nI=(()=>{class t{constructor(e,i){this.panelService=e,this.pointerDeviceService=i,this.rotateEvent=new Tn,this.showTitleButtons=!0,this.preLeft=0,this.preTop=0,this.preWidth=100,this.preHeight=100,this.horizontalWidth=1032,this.horizontalHeight=100,this.verticalWidth=0,this.verticalHeight=0,this.isMinimized=!1,this.isFullScreen=!1,this.isHorizontal=!1}set title(e){this.panelService.title=e}set left(e){this.panelService.left=e}set top(e){this.panelService.top=e}set width(e){this.panelService.width=e}set height(e){this.panelService.height=e}set isAbleMinimizeButton(e){this.panelService.isAbleMinimizeButton=e}set isAbleFullScreenButton(e){this.panelService.isAbleFullScreenButton=e}set isAbleCloseButton(e){this.panelService.isAbleCloseButton=e}set isAbleRotateButton(e){this.panelService.isAbleRotateButton=e}get title(){return this.panelService.title}get left(){return this.panelService.left}get top(){return this.panelService.top}get width(){return this.panelService.width}get height(){return this.panelService.height}get isAbleMinimizeButton(){return this.panelService.isAbleMinimizeButton}get isAbleFullScreenButton(){return this.panelService.isAbleFullScreenButton}get isAbleCloseButton(){return this.panelService.isAbleCloseButton}get isAbleRotateButton(){return this.panelService.isAbleRotateButton}get isGMMode(){return!!We.myCursor&&We.myCursor.isGMMode}get isPointerDragging(){return this.pointerDeviceService.isDragging}ngOnInit(){this.panelService.scrollablePanel=this.scrollablePanel.nativeElement}toggleMinimize(){const e=this.draggablePanel.nativeElement,i=this.scrollablePanel.nativeElement;if(e.style.transition="width 0.1s ease-in-out, height 0.1s ease-in-out",i.style.overflowY="hidden",setTimeout(()=>{e.style.transition=null,i.style.overflowY=null},100),!this.isMinimized&&!this.isFullScreen){const r=e.offsetWidth,s=e.offsetHeight;this.isHorizontal?(this.horizontalWidth=r,this.horizontalHeight=s):(this.verticalWidth=r,this.verticalHeight=s)}this.isMinimized=!this.isMinimized,this.isFullScreen=!1}toggleFullScreen(){const e=this.draggablePanel.nativeElement,i=this.scrollablePanel.nativeElement;if(e.style.transition="width 0.1s ease-in-out, height 0.1s ease-in-out",i.style.overflowY="hidden",setTimeout(()=>{e.style.transition=null,i.style.overflowY=null},100),!this.isMinimized&&!this.isFullScreen){const r=e.offsetWidth,s=e.offsetHeight;this.isHorizontal?(this.horizontalWidth=r,this.horizontalHeight=s):(this.verticalWidth=r,this.verticalHeight=s)}this.isFullScreen=!this.isFullScreen}toggleRotate(){const e=this.draggablePanel.nativeElement,i=this.scrollablePanel.nativeElement;e.style.transition="width 0.1s ease-in-out, height 0.1s ease-in-out",i.style.overflowY="hidden",setTimeout(()=>{e.style.transition=null,i.style.overflowY=null},100);const r=e.offsetWidth,s=e.offsetHeight;this.isHorizontal?(this.isHorizontal=!1,e.style.width=(this.verticalWidth<100?100:this.verticalWidth)+"px",e.style.height=(this.verticalHeight<100?100:this.verticalHeight)+"px",!this.isMinimized&&!this.isFullScreen&&(this.horizontalWidth=r,this.horizontalHeight=s)):(this.isHorizontal=!0,e.style.width=(this.horizontalWidth<100?100:this.horizontalWidth)+"px",e.style.height=(this.horizontalHeight<100?100:this.horizontalHeight)+"px",!this.isMinimized&&!this.isFullScreen&&(this.verticalWidth=r,this.verticalHeight=s)),this.isMinimized=!1,this.isFullScreen=!1,this.rotateEvent.emit(this.isHorizontal)}close(){this.panelService&&this.panelService.close()}}return t.\u0275fac=function(e){return new(e||t)(He(An),He(fi))},t.\u0275cmp=Xt({type:t,selectors:[["ui-panel"]],viewQuery:function(e,i){if(1&e&&(cn(kZ,7),cn(MZ,7),cn(DZ,7,zr),cn(AZ,7)),2&e){let r;ln(r=un())&&(i.draggablePanel=r.first),ln(r=un())&&(i.scrollablePanel=r.first),ln(r=un())&&(i.content=r.first),ln(r=un())&&(i.titleBar=r.first)}},inputs:{title:"title",left:"left",top:"top",width:"width",height:"height",isAbleMinimizeButton:"isAbleMinimizeButton",isAbleFullScreenButton:"isAbleFullScreenButton",isAbleCloseButton:"isAbleCloseButton",isAbleRotateButton:"isAbleRotateButton",showTitleButtons:"showTitleButtons"},outputs:{rotateEvent:"rotateEvent"},features:[gi([An])],ngContentSelectors:zZ,decls:16,vars:34,consts:[["appDraggable","","appResizable","",1,"draggable-panel",3,"ngClass","resizable.disable","resizable.align","draggable.disable","draggable.stack","resizable.stack"],["draggablePanel",""],[1,"title"],["titleBar",""],["style","padding: 0px; height: 14px; margin-top: 3px; margin-left: 1px",3,"click",4,"ngIf"],[3,"ngClass"],[1,"title-button"],[3,"click",4,"ngIf"],[1,"scrollable-panel",3,"ngClass"],["scrollablePanel",""],["content",""],[2,"padding","0px","height","14px","margin-top","3px","margin-left","1px",3,"click"],[1,"material-icons",2,"font-size","14px"],[3,"click"],[1,"material-icons"]],template:function(e,i){1&e&&(mm(),Q(0,"div",0,1)(2,"div",2,3),Te(4,PZ,3,0,"button",4),Q(5,"div",5),ye(6),ie(),Q(7,"div",6),Te(8,NZ,3,3,"button",7),Te(9,FZ,3,3,"button",7),Te(10,OZ,3,0,"button",7),ie()(),Q(11,"div",8,9),$m(13),ot(14,"div",null,10),ie()()),2&e&&(Qe("left",i.left,"px")("top",i.top,"px")("width",i.width,"px")("height",i.height,"px"),re("@flyInOut","in")("ngClass",co(24,RZ,i.isPointerDragging,i.isFullScreen,i.isMinimized&&!i.isFullScreen,i.isGMMode))("resizable.disable",i.isMinimized||i.isFullScreen)("resizable.align",i.isAbleRotateButton?i.isHorizontal?"horizontal":"vertical":"normal")("draggable.disable",i.isFullScreen)("draggable.stack",".draggable-panel")("resizable.stack",".draggable-panel"),U(4),re("ngIf",i.isAbleRotateButton),U(1),re("ngClass",ft(29,BZ,i.isAbleRotateButton)),U(1),Xe(i.panelService.title),U(2),re("ngIf",i.isAbleMinimizeButton),U(1),re("ngIf",i.isAbleFullScreenButton),U(1),re("ngIf",i.isAbleCloseButton),U(1),Qe("display",i.isMinimized&&!i.isFullScreen?"none":null),re("ngClass",Yt(31,LZ,i.isAbleRotateButton,i.isHorizontal)))},directives:[X0,IZ,Yn,bn],styles:["[_nghost-%COMP%]{display:block}.draggable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;color:#444;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;padding:0;top:200px;height:200px;width:300px;max-height:100%;max-width:100%;cursor:grab}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;position:absolute;top:25px;bottom:0;width:100%;padding:8px;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;padding:2px 5px;width:100%;background-color:#555;color:#ccc;-webkit-user-select:none;-moz-user-select:none;user-select:none}.title-button[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#ccc}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}@media screen and (-webkit-min-device-pixel-ratio: 0){.scrollable-panel.overlay[_ngcontent-%COMP%]{overflow:overlay}}.scrollable-panel.horizontal[_ngcontent-%COMP%]{overflow-x:auto;overflow-y:hidden}.rotateble[_ngcontent-%COMP%]{display:inline;top:-3px;position:relative}.is-minimized[_ngcontent-%COMP%]{height:27px!important}.is-full-screen[_ngcontent-%COMP%]{left:0!important;top:0!important;width:100vw!important;height:100vh!important;cursor:default}.draggable-panel.is-full-screen[_ngcontent-%COMP%]{border:0px none}.draggable-panel.i-am-gm[_ngcontent-%COMP%]{background:linear-gradient(-30deg,rgba(240,208,208,.9),rgba(255,236,236,.9))}"],data:{animation:[Sn("flyInOut",[Lt("void => *",[Rt("100ms ease-out",sn([et({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),et({transform:"scale(1.0, 1.0)",opacity:"1",offset:1})]))]),Lt("* => void",[Rt(100,et({transform:"scale(0, 0)"}))])])]}}),t})();const jZ=["standImageElement"],HZ=["dialogElement"],UZ=function(t){return{"emote-secret":t}};function VZ(t,n){if(1&t&&(Q(0,"div",12),ye(1),ie()),2&t){const e=_e(3);Qe("visibility",e.isShowStand&&e.isApplyDialog?"visible":"hidden")("width",e.imageWidth,"px")("font-size",e.imageWidth/4.5>16?e.imageWidth/4.5:16,"px")("color",e.color?e.color:"#444")("bottom",e.emoteCssBottom,"px"),re("@fadeAndScaleInOut",void 0)("ngClass",ft(13,UZ,e.isSecret)),U(1),Xe(e.gameCharacter.text)}}const GZ=function(t,n){return{"transform-origin":t,transform:n}},qZ=function(t){return{inverse:t}},WZ=function(t,n,e,i,r,s,o,a){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:s,yellow:o,white:a}},KZ=function(t,n){return{"black-paint":t,hollow:n}};function YZ(t,n){if(1&t){const e=it();Ke(0),Te(1,VZ,2,15,"div",5),Q(2,"div",6)(3,"div",7)(4,"div",8)(5,"div",9)(6,"img",10,11),Ae("load",function(){return Oe(e),_e(2).onImageLoad()}),Et(8,"safe"),ie()()()()(),Ye()}if(2&t){const e=_e(2);U(1),re("ngIf",!e.isBackyard&&e.gameCharacter.isEmote),U(1),re("ngStyle",Yt(11,GZ,e.standImageTransformOrigin,e.isApplyRoll?"rotate("+e.gameCharacter.roll+"deg)":"")),U(1),re("ngClass",ft(14,qZ,e.isApplyImageEffect&&e.gameCharacter.isInverse)),U(1),re("ngClass",uo(16,WZ,e.isApplyImageEffect&&0==e.gameCharacter.aura,e.isApplyImageEffect&&1==e.gameCharacter.aura,e.isApplyImageEffect&&2==e.gameCharacter.aura,e.isApplyImageEffect&&3==e.gameCharacter.aura,e.isApplyImageEffect&&4==e.gameCharacter.aura,e.isApplyImageEffect&&5==e.gameCharacter.aura,e.isApplyImageEffect&&6==e.gameCharacter.aura,e.isApplyImageEffect&&7==e.gameCharacter.aura)),U(2),Qe("height",e.height>0?e.height+"vh":"auto"),re("src",Tt(8,8,e.standImage.url,"resourceUrl"),en)("ngClass",Yt(25,KZ,e.isApplyImageEffect&&e.gameCharacter.isBlackPaint,e.isApplyImageEffect&&e.gameCharacter.isHollow))}}const ZZ=function(t,n,e,i){return{"is-can-be-gone":t,"is-ghostly":n,backyard:e,secret:i}};function XZ(t,n){if(1&t){const e=it();Q(0,"div",3),Ae("click",function(){Oe(e);const r=_e();return r.toGhostly(),r.toBackyard()}),Te(1,YZ,9,28,"ng-container",4),ie()}if(2&t){const e=_e();Qe("left",e.position+"%")("height",0==e.height?"":e.height+"vh")("margin-left",-e.imageWidth/2,"px")("margin-bottom",e.adjustY,"px"),re("@standInOut",e.groupValue)("ngClass",co(11,ZZ,e.isCanBeGone,e.isGhostly,e.isBackyard,e.isSecret)),U(1),re("ngIf",e.gameCharacter&&e.standImage.url&&e.standImage.url.length>0)}}const QZ=function(t,n,e){return{"is-can-be-gone":t,"is-ghostly":n,backyard:e}};function JZ(t,n){if(1&t&&(Q(0,"span",13)(1,"b"),ye(2),ie()()),2&t){const e=_e();Qe("color",e.color?e.color:"#444")("left",e.position+"%")("margin-bottom",e.adjustY>0?e.adjustY:0,"px")("border-color",e.color?e.color:"#444")("margin-left",e.nameTagCSSMarginLeft,"px"),re("ngClass",Zr(12,QZ,e.isCanBeGone,e.isGhostly,e.isBackyard)),U(2),Xe(e.gameCharacter.name)}}const eX=function(t,n,e){return{left:t,right:n,"transform-origin":e}},tX=function(t,n,e,i,r,s){return{"is-can-be-gone":t,"is-ghostly":n,backyard:e,"dialog-secret":i,"is-position-right":r,"is-position-left":s}};function nX(t,n){if(1&t){const e=it();Q(0,"div",14,15),Ae("click",function(){Oe(e);const r=_e();return r.toGhostly(),r.toBackyard()}),Q(2,"p",16),Ae("@dialogShake.start",function(r){return Oe(e),_e().onSpeaking(r)}),Et(3,"safe"),ie()()}if(2&t){const e=_e();Qe("visibility",e.isShowStand&&e.isApplyDialog?"visible":"hidden")("color",e.isSecret?"#ccc":e.color?e.color:"#444")("left",e.dialogBoxCSSLeft,"px")("bottom",e.dialogBoxCssBottom>12?e.dialogBoxCssBottom:12,"px")("max-width",e.dialogBoxCSSMaxWidth,"px")("border-color",e.color?e.color:"#444"),re("@fadeAndScaleInOut",void 0)("ngStyle",Zr(20,eX,e.position<=50?e.dialogBoxCSSLeft+"px":"auto",e.position>50?e.dialogBoxCSSRight+"px":"auto",e.position<=50?"12px calc(100% + 12px)":"calc(100% - 12px) calc(100% + 12px)"))("ngClass",km(24,tX,e.isCanBeGone,e.isGhostly,e.isBackyard,e.isSecret,e.position<=50,e.position>50)),U(2),re("@dialogShake",e.math.floor(e.dialogText.length/2))("innerHTML",Tt(3,17,e.dialogText,"html"),Yi)}}let Qo=(()=>{class t{constructor(e){this.ngZone=e,this._imageFile=Ut.Empty,this.isFarewell=!1,this.isGhostly=!1,this.isBackyard=!1,this.isVisible=!1,this.isSecret=!1,this.standImageTransformOrigin="center",this.naturalWidth=0,this.naturalHeight=0,this.isSpeaking=!1,this.math=Math}onSpeaking(e){this.gameCharacter&&this.gameCharacter.text&&(this.isApplyDialog||this.isSpeakable||this.gameCharacter.isShowChatBubble)&&(clearTimeout(this._timeoutId),this._timeoutId=setTimeout(()=>{this.ngZone.run(()=>{this.isVisible=!1})},12e3)),this.isSpeakable&&(clearTimeout(this._dialogTimeoutId),this.gameCharacter&&this.gameCharacter.text&&(this.isSpeaking=!0),this._dialogTimeoutId=setTimeout(()=>{this.ngZone.run(()=>{this.isSpeaking=!1})},300))}get isShowStand(){return t.isShowStand}get isShowNameTag(){return t.isShowNameTag&&this.isShowName}get isCanBeGone(){return t.isCanBeGone}set dialog(e){if(!this.gameCharacter||"table"===this.gameCharacter.location.name&&!this.gameCharacter.isHideIn||"graveyard"===this.gameCharacter.location.name)return;clearTimeout(this._dialogTimeoutId);let i=rt.cr(e.text);const r=rt.isEmote(i),s=[],o=/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g;let a,h=0,w=0;if(!r)for(i=i.replace(/[\u3002\u3001]{3}/g,"\u2026").replace(/[\u3002\u3001]{2}/g,"\u2025").replace(/(\u3002|[\r\n]{2,})/g,"$1                            ").trimEnd();null!==(a=o.exec(i));){let Le=a.index-3*h;s.push({base:a[1],ruby:a[2],start:Le-w,end:Le+a[1].length-w-1}),h++,w+=a[2].length}let X=1e3/Array.from(i).length>36?1e3/Array.from(i).length:36;X>200&&(X=200),this._dialogTimeoutId=setTimeout(()=>{this.gameCharacter.text="",this.gameCharacter.isEmote=!1},Array.from(i).length*X+6e3),this.gameCharacter.isEmote=r,h=0;let fe=0,pe=0,we="",Ie=s.shift(),Pe="",Be=!1;if(r)this.gameCharacter.text=i;else{const Le=Array.from(i.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a.+?\u300b/g,"$1"));this._chatIntervalId=setInterval(()=>{let Fe=Le[h],Ve=Fe.length>1;if(Fe){if(!Be&&Ie&&fe>=Ie.start&&(we+="<ruby>",Be=!0,pe=0),we+=rt.escapeHtml(Fe),Be){pe+=1;let Ge=Ie.ruby;Pe="<rt>"+rt.escapeHtml(Array.from(Ge).slice(0,Math.ceil(Array.from(Ge).length*(pe/Array.from(Ie.base).length))).join(""))+"</rt>"}Be&&Ie&&fe>=Ie.end-(Ve?1:0)&&(we+=Pe+"</ruby>",Be=!1,Ie=s.shift()),fe+=Fe.length}h+=1,this.gameCharacter.text=we+(Be?Pe+"</ruby>":""),h>=Le.length&&clearInterval(this._chatIntervalId)},X)}}get dialogText(){return this.gameCharacter&&this.gameCharacter.text?this.gameCharacter.text.replace(/[\r\n]{2,}/g,"\n\n").replace(/                            /g,"").trim():""}get standImage(){if(!this.standElement)return this._imageFile;let e=null;if(this.isSpeaking&&(e=this.standElement.getFirstElementByName("speakingImageIdentifier")),(!e||!e.value||e.value==Ut.Empty.identifier)&&(e=this.standElement.getFirstElementByName("imageIdentifier")),e&&this._imageFile.identifier!==e.value){let i=Nt.instance.get(e.value);this._imageFile=i||Ut.Empty}return this._imageFile}get isSpeakable(){if(!this.standElement)return!1;let e=this.standElement.getFirstElementByName("speakingImageIdentifier");return e&&e.value&&e.value!==Ut.Empty.identifier}ngOnInit(){ze.register(this).on("POPUP_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&this.ngZone.run(()=>{this.dialog=e.data})}).on("FAREWELL_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&(this.ngZone.run(()=>{this.dialog=null,this.gameCharacter.text="",this.gameCharacter.isEmote=!1}),clearTimeout(this._dialogTimeoutId),clearInterval(this._chatIntervalId))})}ngOnDestroy(){clearTimeout(this._timeoutId),clearTimeout(this._dialogTimeoutId)}get group(){if(!this.gameCharacter)return"";let e=this.standElement.getFirstElementByName("name");return e.currentValue&&e.currentValue.toString().length>0?e.currentValue.toString():""}get groupValue(){let e=0;const i=this.group;for(let r=0;r<i.length;r++)e=(e<<5)-e+i.charCodeAt(r),e|=0;return e}get position(){if(!this.gameCharacter)return 0;let e=this.standElement.getFirstElementByName("position");return e&&e.currentValue?+e.value:this.gameCharacter.standList.position}get adjustY(){if(!this.gameCharacter)return 0;let e=this.standElement.getFirstElementByName("height");return this.imageHeight*(e&&e.currentValue?+e.currentValue:0)/100}get height(){if(!this.gameCharacter||!this.standElement)return 0;let e=this.standElement.getFirstElementByName("height");return e&&0!=+e.value||!this.gameCharacter.standList?e?+e.value:0:this.gameCharacter.standList.height}get imageHeight(){return 0==this.height?this.naturalHeight:document.documentElement.offsetHeight*this.height/100}get imageWidth(){return this.imageHeight*this.naturalWidth/this.naturalHeight}get dialogBoxCSSLeft(){return this.imageWidth*(this.position>50?.33:.66)-this.imageWidth/2-12+this.position*document.documentElement.clientWidth/100-(this.position>50?this.dialogBoxCSSMaxWidth:0)}get dialogBoxCSSRight(){return document.documentElement.clientWidth-this.dialogBoxCSSLeft-this.dialogBoxCSSMaxWidth}get dialogBoxCSSMaxWidth(){let e=this.imageWidth/document.documentElement.clientWidth;return e/=2,e<.14&&(e=.14),e*document.documentElement.clientWidth}get dialogBoxCssBottom(){let e=.66*this.imageHeight+this.adjustY;return e<48&&(e=48),this.dialogElement&&e>document.documentElement.offsetHeight-this.dialogElement.nativeElement.clientHeight&&(e=document.documentElement.offsetHeight-this.dialogElement.nativeElement.clientHeight),e}get emoteCssBottom(){let e=.66*this.imageHeight+(this.imageWidth/4.5>16?this.imageWidth/4.5:16);return e<0&&(e=0),e}get nameTagCSSMarginLeft(){let e=this.imageWidth/2-this.position*document.documentElement.clientWidth/100;return e<32&&(e=32),-this.imageWidth/2+e}get isApplyImageEffect(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("applyImageEffect");return!(!e||!e.value)}get isApplyRoll(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("applyRoll");return!(!e||!e.value)}get isApplyDialog(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("applyDialog");return!(!e||!e.value)}get isShowName(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("showName");return!(!e||!e.value)}calcStandImageTransformOrigin(){return"center 66%"}toGhostly(){this.ngZone.run(()=>{this.isGhostly=!0})}toBackyard(){this.ngZone.run(()=>{this.isBackyard=!0})}toFront(){this.ngZone.run(()=>{this.isFarewell=!1,this.isGhostly=!1,this.isBackyard=!1,this.isVisible=!0}),clearTimeout(this._timeoutId),this._timeoutId=setTimeout(()=>{this.ngZone.run(()=>{this.isVisible=!1})},12e3)}toFarewell(){this.ngZone.run(()=>{this.isFarewell=!0,this.isVisible=!1})}onImageLoad(){this.naturalWidth=this.standImageElement.nativeElement.naturalWidth,this.naturalHeight=this.standImageElement.nativeElement.naturalHeight,this.standImageTransformOrigin=this.calcStandImageTransformOrigin()}}return t.isShowStand=!0,t.isShowNameTag=!0,t.isCanBeGone=!0,t.\u0275fac=function(e){return new(e||t)(He(Cn))},t.\u0275cmp=Xt({type:t,selectors:[["stand-image"]],viewQuery:function(e,i){if(1&e&&(cn(jZ,5),cn(HZ,5)),2&e){let r;ln(r=un())&&(i.standImageElement=r.first),ln(r=un())&&(i.dialogElement=r.first)}},inputs:{gameCharacter:"gameCharacter",standElement:"standElement",color:"color"},decls:4,vars:7,consts:[["class","stand-image-container",3,"left","height","margin-left","margin-bottom","ngClass","click",4,"ngIf"],["class","name-tag","style","pointer-events: none;",3,"color","ngClass","left","margin-bottom","border-color","margin-left",4,"ngIf"],["class","name-tag dialog chat-bubble-buyo","style","margin-left: 12px; min-width: 5em; white-space: pre-wrap; font-size: 14px; pointer-events: none;",3,"visibility","color","left","bottom","max-width","ngStyle","ngClass","border-color","click",4,"ngIf"],[1,"stand-image-container",3,"ngClass","click"],[4,"ngIf"],["class","emote chat-bubble-buyo","style","position: absolute; pointer-events: none; text-align: center; margin-top: -1em",3,"visibility","width","font-size","color","bottom","ngClass",4,"ngIf"],[3,"ngStyle"],[1,"inverser",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"color-fillter"],["draggable","false",1,"stand-image",3,"src","ngClass","load"],["standImageElement",""],[1,"emote","chat-bubble-buyo",2,"position","absolute","pointer-events","none","text-align","center","margin-top","-1em",3,"ngClass"],[1,"name-tag",2,"pointer-events","none",3,"ngClass"],[1,"name-tag","dialog","chat-bubble-buyo",2,"margin-left","12px","min-width","5em","white-space","pre-wrap","font-size","14px","pointer-events","none",3,"ngStyle","ngClass","click"],["dialogElement",""],[2,"width","100%",3,"innerHTML"]],template:function(e,i){1&e&&(Q(0,"div"),Te(1,XZ,2,16,"div",0),Te(2,JZ,3,16,"span",1),Te(3,nX,4,31,"div",2),ie()),2&e&&(Qe("visibility",i.isShowStand?"visible":"hidden")("pointer-events",i.isShowStand?"auto":"none"),U(1),re("ngIf",!i.isFarewell&&(i.isVisible||!i.isCanBeGone)),U(1),re("ngIf",i.isShowStand&&!i.isFarewell&&(i.isVisible||!i.isCanBeGone)&&i.isShowNameTag&&i.gameCharacter&&i.gameCharacter.name),U(1),re("ngIf",!i.isFarewell&&i.isVisible&&!i.isBackyard&&i.gameCharacter&&i.gameCharacter.text&&!i.gameCharacter.isEmote))},directives:[bn,Yn,Ji],pipes:[ai],styles:['.stand-image-container[_ngcontent-%COMP%]{position:absolute;display:inline-block;bottom:-.1%;z-index:1000000;transition:opacity .1s ease-in}.is-ghostly[_ngcontent-%COMP%]{z-index:900000}.is-can-be-gone.is-ghostly[_ngcontent-%COMP%]{opacity:.5;filter:brightness(.5)}.backyard[_ngcontent-%COMP%]{pointer-events:none;z-index:0}.name-tag[_ngcontent-%COMP%]{color:#444;background-color:#f5f5f5;border:2px solid #444;border-radius:24px;padding:4px 12px;bottom:2px;display:inline-block;white-space:nowrap;position:absolute;font-size:16px;opacity:.9;z-index:1000005}.name-tag.is-ghostly[_ngcontent-%COMP%]{z-index:900005}.is-can-be-gone.name-tag.is-ghostly[_ngcontent-%COMP%]{opacity:.5}.name-tag.backyard[_ngcontent-%COMP%]{z-index:1}.is-can-be-gone.is-ghostly.backyard[_ngcontent-%COMP%]{opacity:.25}.secret[_ngcontent-%COMP%]   .color-fillter[_ngcontent-%COMP%]{filter:grayscale(80%)}.name-tag.dialog[_ngcontent-%COMP%]{border-radius:24px 24px 24px 12px}.name-tag.dialog-secret[_ngcontent-%COMP%]{border-radius:24px 12px;background:rgba(85,85,85,.9)}.name-tag.dialog.is-position-left[_ngcontent-%COMP%]{border-radius:24px 24px 12px}.name-tag.dialog.dialog-secret.is-position-left[_ngcontent-%COMP%]{border-radius:12px 24px}.emote[_ngcontent-%COMP%]{text-align:center;font-size:48px;font-weight:700;border:none;background:none;-webkit-text-stroke:2px whitesmoke;white-space:pre-wrap;word-break:break-word}.emote.emote-secret[_ngcontent-%COMP%]{-webkit-text-stroke:2px #555}.emote.emote-secret.is-ghostly[_ngcontent-%COMP%]{z-index:900005}.emote[_ngcontent-%COMP%]{z-index:1000005}.emote.is-ghostly[_ngcontent-%COMP%]{z-index:900005}.dialog[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{overflow-wrap:anywhere;word-break:break-word;display:inline-block;margin-top:.5em;margin-bottom:.5em}.dialog.is-position-right[_ngcontent-%COMP%]:after{box-sizing:border-box;content:"";position:absolute;padding:0;line-height:1;vertical-align:baseline;bottom:-25px;border:12px solid transparent;border-top-color:inherit;left:17px;margin:0 0 0 -12px}.dialog.is-position-left[_ngcontent-%COMP%]:before{box-sizing:border-box;content:"";position:absolute;margin:0 -12px 0 0;padding:0;line-height:1;vertical-align:baseline;bottom:-25px;border:12px solid transparent;border-top-color:inherit;right:17px}.chat-bubble-buyo[_ngcontent-%COMP%]{transition:transform .2s ease;animation:chat-bubble-buyo 1.2s ease-in-out .1s infinite alternate;transform:scale3d(.9,.9,.9)}.chat-bubble-buyo.emote[_ngcontent-%COMP%]{animation-duration:.6s;transform-origin:center bottom}@keyframes chat-bubble-buyo{0%{transform:scale3d(.9,.9,.9)}to{transform:scale(1)}}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #fff)}'],data:{animation:[Sn("standInOut",[Lt("void => *,:increment,:decrement",[Rt("132ms cubic-bezier(.21,.97,.75,1.25)",sn([et({opacity:.6,transform:"translateY(48px) scale(0.9)",offset:0}),et({opacity:1,transform:"translateY(0px) scale(1.0)",offset:1})]))]),Lt("* => void,:increment,:decrement",[Rt("132ms ease-out",sn([et({transform:"translateY(0px) scale(1.0)",offset:0}),et({opacity:0,transform:"translateY(96px) scale(0.9)",offset:1})]))])]),Sn("dialogShake",[Lt(":increment",[Rt("19ms ease",sn([et({transform:"translateX(1px)"})])),Rt("19ms ease",sn([et({transform:"translateX(-1px)"})]))])]),Sn("fadeAndScaleInOut",[Lt("void => *, true => false",[Rt("200ms ease-in-out",sn([et({transform:"scale3d(0, 0, 0)",opacity:0}),et({transform:"scale3d(0.9, 0.9, 0.9)",opacity:.9})]))]),Lt("* => void, true => false",[Rt("100ms ease-in-out",et({transform:"scale3d(0, 0, 0)",opacity:0}))])])]}}),t})();class rr{constructor(){}show(n,e,i=null,r=!1){let s=!0;for(const o of rr.currentStandImageShowing){const a=o[0],h=o[1];if(!h)continue;const w=h.instance;w.isVisible&&n.identifier!=a?w.toGhostly():n.identifier==a&&"graveyard"!=n.location.name?(w.standElement=e,w.color=i||n.chatPalette.color,w.isSecret=r,w.toFront(),s=!1):(w.isFarewell||Qo.isCanBeGone)&&(h.destroy(),rr.currentStandImageShowing.delete(a))}if(s&&"graveyard"!=n.location.name){const o=rr.defaultParentViewContainerRef.createComponent(Qo);o.instance.gameCharacter=n,o.instance.standElement=e,o.instance.color=i||n.chatPalette.color,o.instance.isSecret=r,o.instance.toFront(),rr.currentStandImageShowing.set(n.identifier,o)}}farewell(n){n instanceof Gt&&(n=n.identifier);const e=rr.currentStandImageShowing.get(n);e&&e.instance&&e.instance.toFarewell()}destroy(n,e){n instanceof Gt&&(n=n.identifier),e instanceof _t&&(e=e.identifier);for(const i of rr.currentStandImageShowing){const r=i[1];!r||(!r.instance||!r.instance.standElement||r.instance.standElement.identifier==e)&&(r.destroy(),rr.currentStandImageShowing.delete(n))}}destroyAll(){for(const n of rr.currentStandImageShowing){const e=n[0],i=n[1];!i||(i.destroy(),rr.currentStandImageShowing.delete(e))}}}rr.currentStandImageShowing=new Map,rr.\u0275fac=function(n){return new(n||rr)},rr.\u0275prov=rn({token:rr,factory:rr.\u0275fac,providedIn:"root"});const iX=["diceRollTableSelecter"];function rX(t,n){if(1&t&&(Q(0,"option",9),ye(1),ie()),2&t){const e=n.$implicit;Qe("color",""==e.name?"gray":""),ht("value",e.identifier),ht("title",e.name),U(1),Xe(""==e.name?"(\u7121\u540d\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868)":e.name)}}function sX(t,n){if(1&t&&(Q(0,"div",25),ye(1),ie()),2&t){const e=_e(3);U(1),Rn("",e.progresPercent,"%")}}const oX=function(t){return{"is-hidden":t}};function aX(t,n){if(1&t){const e=it();Ke(0),Q(1,"button",18),Ae("click",function(){return Oe(e),_e(2).upTabIndex()}),ye(2,"\u2191"),ie(),Q(3,"button",18),Ae("click",function(){return Oe(e),_e(2).downTabIndex()}),ye(4,"\u2193"),ie(),Q(5,"div",19)(6,"button",20),Ae("click",function(){return Oe(e),_e(2).save()}),Q(7,"div",21)(8,"div",22),ye(9,"\u4fdd\u5b58"),ie(),Te(10,sX,2,1,"div",23),ie()(),Q(11,"button",24),Ae("click",function(){return Oe(e),_e(2).delete()}),ye(12,"\u524a\u9664"),ie()(),Ye()}if(2&t){const e=_e(2);U(6),re("disabled",e.isSaveing),U(2),re("ngClass",ft(3,oX,e.isSaveing)),U(2),re("ngIf",e.isSaveing)}}function lX(t,n){if(1&t){const e=it();Ke(0),Q(1,"button",18),Ae("click",function(){return Oe(e),_e(2).restore()}),ye(2,"\u5143\u306b\u623b\u3059"),ie(),Ye()}}function cX(t,n){if(1&t){const e=it();Ke(0),Q(1,"div",10)(2,"div",11)(3,"b"),ye(4,"name: "),ie(),Q(5,"input",12),Ae("ngModelChange",function(r){return Oe(e),_e().diceRollTableName=r}),ie()(),Q(6,"div")(7,"span",13)(8,"b"),ye(9,"command: "),ie(),Q(10,"input",14),Ae("ngModelChange",function(r){return Oe(e),_e().diceRollTableCommand=r}),ie()(),Q(11,"span",15)(12,"b"),ye(13,"dice: "),ie(),Q(14,"input",16),Ae("ngModelChange",function(r){return Oe(e),_e().diceRollTableDice=r}),ie()()()(),Q(15,"div")(16,"textarea",17),Ae("ngModelChange",function(r){return Oe(e),_e().diceRollTableText=r}),ie()(),ot(17,"hr"),Q(18,"div"),Te(19,aX,13,5,"ng-container",8),Te(20,lX,3,0,"ng-container",8),ie(),Ye()}if(2&t){const e=_e();U(5),re("ngModel",e.diceRollTableName),Bt("disabled",e.isEditable?null:""),U(5),re("ngModel",e.diceRollTableCommand),Bt("disabled",e.isEditable?null:""),U(4),re("ngModel",e.diceRollTableDice),Bt("disabled",e.isEditable?null:""),U(2),re("ngModel",e.diceRollTableText),Bt("disabled",e.isEditable?null:""),U(3),re("ngIf",!e.isDeleted),U(1),re("ngIf",e.isDeleted&&e.selectedDiceRollTableXml)}}function uX(t,n){if(1&t){const e=it();Ke(0),Q(1,"button",18),Ae("click",function(){return Oe(e),_e(2).restore()}),ye(2,"\u5143\u306b\u623b\u3059"),ie(),Ye()}}function dX(t,n){if(1&t&&(Ke(0),Q(1,"div",26),ye(2," \u203b\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u304c\u3042\u308a\u307e\u305b\u3093\u3002 "),Te(3,uX,3,0,"ng-container",8),ie(),Ye()),2&t){const e=_e();U(3),re("ngIf",e.isDeleted&&e.selectedDiceRollTableXml)}}let fX=(()=>{class t{constructor(e,i,r,s){this.pointerDeviceService=e,this.modalService=i,this.panelService=r,this.saveDataService=s,this.selectedDiceRollTable=null,this.selectedDiceRollTableXml="",this.isSaveing=!1,this.progresPercent=0}get diceRollTableName(){return this.selectedDiceRollTable.name}set diceRollTableName(e){this.isEditable&&(this.selectedDiceRollTable.name=e)}get diceRollTableDice(){return this.selectedDiceRollTable.dice}set diceRollTableDice(e){this.isEditable&&(this.selectedDiceRollTable.dice=e)}get diceRollTableCommand(){return this.selectedDiceRollTable.command}set diceRollTableCommand(e){this.isEditable&&(this.selectedDiceRollTable.command=e)}get diceRollTableText(){return this.selectedDiceRollTable.value}set diceRollTableText(e){this.isEditable&&(this.selectedDiceRollTable.value=e)}get diceRollTables(){return go.instance.children}get isEmpty(){return this.diceRollTables.length<1}get isDeleted(){return!!this.selectedDiceRollTable&&null==dt.instance.get(this.selectedDiceRollTable.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u8a2d\u5b9a"),ze.register(this).on("DELETE_GAME_OBJECT",1e3,e=>{if(!this.selectedDiceRollTable||e.data.identifier!==this.selectedDiceRollTable.identifier)return;let i=dt.instance.get(e.data.identifier);null!==i&&(this.selectedDiceRollTableXml=i.toXml())})}ngAfterViewInit(){this.diceRollTables.length>0&&queueMicrotask(()=>{this.onChangeDiceRollTable(this.diceRollTables[0].identifier),this.diceRollTableSelecter.nativeElement.selectedIndex=0})}ngOnDestroy(){ze.unregister(this)}onChangeDiceRollTable(e){this.selectedDiceRollTable=dt.instance.get(e),this.selectedDiceRollTableXml=""}create(e="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868"){return go.instance.addDiceRollTable(e)}add(){const e=this.create();queueMicrotask(()=>{this.onChangeDiceRollTable(e.identifier),this.diceRollTableSelecter.nativeElement.value=e.identifier})}save(){var e=this;return(0,tn.Z)(function*(){if(!e.selectedDiceRollTable||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i="fly_rollTable_"+e.selectedDiceRollTable.name;yield e.saveDataService.saveGameObjectAsync(e.selectedDiceRollTable,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}saveAll(){var e=this;return(0,tn.Z)(function*(){e.isSaveing||(e.isSaveing=!0,e.progresPercent=0,yield e.saveDataService.saveGameObjectAsync(go.instance,"fly_rollTable_All",i=>{e.progresPercent=i}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500))})()}delete(){!this.isEmpty&&this.selectedDiceRollTable&&(this.selectedDiceRollTableXml=this.selectedDiceRollTable.toXml(),this.selectedDiceRollTable.destroy())}restore(){if(this.selectedDiceRollTable&&this.selectedDiceRollTableXml){let e=ti.instance.parseXml(this.selectedDiceRollTableXml);go.instance.addDiceRollTable(e),this.selectedDiceRollTableXml="",queueMicrotask(()=>{const i=this.diceRollTables;this.onChangeDiceRollTable(i[i.length-1].identifier),this.diceRollTableSelecter.nativeElement.selectedIndex=i.length-1})}}upTabIndex(){if(!this.selectedDiceRollTable)return;let e=this.selectedDiceRollTable.parent,i=e.children.indexOf(this.selectedDiceRollTable);0<i&&e.insertBefore(this.selectedDiceRollTable,e.children[i-1])}downTabIndex(){if(!this.selectedDiceRollTable)return;let e=this.selectedDiceRollTable.parent,i=e.children.indexOf(this.selectedDiceRollTable);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.selectedDiceRollTable)}helpDiceRollTable(){let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(du,{left:e.x,top:e.y,width:600,height:788});r.title="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u30d8\u30eb\u30d7",r.text="\u3000\u540d\u524d\u3001\u30b3\u30de\u30f3\u30c9\u3001\u632f\u308b\u30c0\u30a4\u30b9\u3092\u8a2d\u5b9a\u3057\u3001\u30c0\u30a4\u30b9\u306e\u6570\u5b57\u3067\u8868\u3092\u53c2\u7167\u3057\u3001\u8868\u793a\u3057\u307e\u3059\u3002\n\u3000\u30c1\u30e3\u30c3\u30c8\u3067\u30b3\u30de\u30f3\u30c9\u3092\u9001\u4fe1\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3068\u540c\u69d8\u306b\u7d50\u679c\u304c\u9001\u4fe1\u3055\u308c\u307e\u3059\u3002\n\u3000\u8868\u306f1\u884c\u3054\u3068\u306b\u6570\u5b57\u3068\u7d50\u679c\u3092:\uff08\u30b3\u30ed\u30f3\uff09\u3067\u533a\u5207\u308a\u300c\u6570\u5b57:\u7d50\u679c\u300d\u306e\u5f62\u3067\u8a18\u8ff0\u3057\u307e\u3059\uff08\u3088\u3063\u3066\u3001\u30c0\u30a4\u30b9\u306f\u6700\u5f8c\u306b\u4e00\u3064\u306e\u6570\u5b57\u3092\u8fd4\u3059\u3082\u306e\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3001\u30d0\u30e9\u30d0\u30e9\u30c0\u30a4\u30b9 nBm\u3001\u500b\u6570\u632f\u308a\u8db3\u3057\u30c0\u30a4\u30b9 nRm\u3001\u4e0a\u65b9\u7121\u9650\u30ed\u30fc\u30eb nUm \u306e\u6210\u529f\u6570\u306b\u3082\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\uff09\u3002\n\u3000\n\u3000-\uff08\u30cf\u30a4\u30d5\u30f3\uff09\u307e\u305f\u306f\uff5e\u3067\u533a\u5207\u3063\u3066\u6570\u5b57\u306e\u7bc4\u56f2\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\u3000\u8868\u306b \\n \u3068\u66f8\u304f\u3068\u3001\u305d\u3053\u3067\u6539\u884c\u3057\u307e\u3059\uff08\\n\u306f\u8868\u793a\u3055\u308c\u307e\u305b\u3093\uff09\u3002\n\n\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u4f8b\uff09\n\u3000name: \u906d\u9047\u8266\u7a2e\u3000\n\u3000command: ShipType\u3000\u3000dice: 1d6\n\n\u3000\u30001:\u6226\u8266\n\u3000\u30002:\u7a7a\u6bcd\n\u3000\u30003:\u91cd\u5de1\u6d0b\u8266\n\u3000\u30004:\u8efd\u5de1\u6d0b\u8266\n\u3000\u30005-6:\u99c6\u9010\u8266\n\n\u3000\u8868\u3092\u53c2\u7167\u3059\u308b\u969b\u306f\u5148\u306b\u3042\u308b\u3082\u306e\u304c\u512a\u5148\u3055\u308c\u307e\u3059\u3001\u4e0a\u8a18\u306e\u4f8b\u3067\u306f\u6700\u5f8c\u306e\u884c\u3092\u300c1-6:\u99c6\u9010\u8266\u300d\u306a\u3069\u3068\u3057\u3066\u3082\u540c\u3058\u7d50\u679c\u306b\u306a\u308a\u307e\u3059\uff08\u304c\u3001\u5206\u304b\u308a\u3084\u3059\u3044\u8a18\u8ff0\u3092\u304a\u52e7\u3081\u3057\u307e\u3059\uff09\u3002\n\u3000\u30c7\u30d5\u30a9\u30eb\u30c8\u306e D66 \u306f\u30bd\u30fc\u30c8\u3055\u308c\u307e\u305b\u3093\u306e\u3067\u3001\u5fc5\u8981\u306a\u5834\u5408\uff08\u30b5\u30a4\u30b3\u30ed\u30fb\u30d5\u30a3\u30af\u30b7\u30e7\u30f3\u306e\u540d\u524d\u8868\u306a\u3069\uff09\u306f\u3001 D66S \u3068\u3057\u3066\u30bd\u30fc\u30c8\u3057\u305f\u6570\u5b57\u3092\u5f97\u3066\u304f\u3060\u3055\u3044\u3002\n\u3000\u6570\u5b57\u306e\u8a18\u8ff0\u306e\u969b *\uff08\u30a2\u30b9\u30bf\u30ea\u30b9\u30af\uff09\u3092\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\uff08\u4efb\u610f\u306e\u6570\u5b57\uff09\u3068\u3057\u3066\u4f7f\u7528\u53ef\u80fd\u3067\u3059\u3001\u4f8b\u3048\u3070 *-1 \u3068\u3059\u308c\u30701\u4ee5\u4e0b\u30016-* \u3068\u3059\u308c\u30706\u4ee5\u4e0a\u306e\u4efb\u610f\u306e\u6570\u5b57\u3067\u3059\uff08*\u5358\u72ec\u306f\u3059\u3079\u3066\u306e\u6570\u5b57\u3068\u306a\u308a\u3001\u5148\u306b\u3042\u308b\u3082\u306e\u304b\u3089\u53c2\u7167\u3055\u308c\u307e\u3059\u306e\u3067\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u9014\u4e2d\u306e\u884c\u306b\u66f8\u3044\u305f\u5834\u5408\u305d\u308c\u3088\u308a\u5148\u306e\u884c\u304c\u53c2\u7167\u3055\u308c\u306a\u304f\u306a\u308a\u307e\u3059\uff09\u3002\u5f8c\u8ff0\u306e\u4fee\u6b63\u306b\u3088\u308a\u8868\u304b\u3089\u306f\u307f\u51fa\u3057\u3066\u3082\u7d50\u679c\u3092\u5f97\u3089\u308c\u308b\u3088\u3046\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u3000\u30c1\u30e3\u30c3\u30c8\u304b\u3089\u306e\u30b3\u30de\u30f3\u30c9\u306e\u969b\u3001\u5168\u89d2\u534a\u89d2\u3001\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u306e\u5927\u6587\u5b57\u5c0f\u6587\u5b57\u306f\u7121\u8996\u3055\u308c\u307e\u3059\u3002\u307e\u305f\u30c0\u30a4\u30b9\u306b\u4fee\u6b63\u3092\u8db3\u3057\u5f15\u304d\u3059\u308b\u3001\u3042\u308b\u3044\u306f\u4efb\u610f\u306e\u6570\u5b57\u3067\u53c2\u7167\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\u30b3\u30de\u30f3\u30c9\u306e\u5f8c\u306b +\u4fee\u6b63\u5024 \u307e\u305f\u306f -\u4fee\u6b63\u5024 \u3092\u8a18\u8ff0\u3059\u308b\u3053\u3068\u3067\u632f\u3089\u308c\u305f\u30c0\u30a4\u30b9\u306e\u6570\u5b57\u3092\u4fee\u6b63\u3057\u307e\u3059\u3002\u307e\u305f =\u6307\u5b9a\u5024 \u3068\u8a18\u8f09\u3059\u308b\u3053\u3068\u3067\u3001\u305d\u306e\u6570\u5b57\u3067\u30b3\u30de\u30f3\u30c9\u306b\u5bfe\u5fdc\u3059\u308b\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u3092\u53c2\u7167\u3057\u307e\u3059\u3002\u4fee\u6b63\u5024\u3001\u6307\u5b9a\u5024\u306f\u4efb\u610f\u306e\u6574\u6570\u3067\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\u306e\u4f8b\uff09\n\u3000ShipType=3\n\u3000\u524d\u8ff0\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u4f8b\u300c\u906d\u9047\u8266\u7a2e\u300d\u3092\u6570\u5b573\u6307\u5b9a\u3067\u53c2\u7167\u3057\u307e\u3059\u3001\u7d50\u679c\u300c\u91cd\u5de1\u6d0b\u8266\u300d\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\u3082\u3057\u30011\u672a\u6e80\u30846\u3092\u8d85\u3048\u308b\u6570\u5b57\u3092\u6307\u5b9a\u3057\u305f\u5834\u5408\u300c\uff08\u7d50\u679c\u306a\u3057\uff09\u300d\u3068\u306a\u308b\u3067\u3057\u3087\u3046\u3002\n\n\u3000ShipType+2\n\u3000\u524d\u8ff0\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u4f8b\u300c\u906d\u9047\u8266\u7a2e\u300d\u30921d6\u306e\u7d50\u679c\u306b+2\u3057\u305f\u6570\u5b57\u3067\u53c2\u7167\u3057\u307e\u3059\u3002\u300c\u906d\u9047\u8266\u7a2e\u300d\u306b\u306f7\u4ee5\u964d\u306e\u8a18\u8f09\u304c\u3042\u308a\u307e\u305b\u3093\u3001\u305d\u306e\u5834\u5408\u300c\uff08\u7d50\u679c\u306a\u3057\uff09\u300d\u3068\u306a\u308b\u3067\u3057\u3087\u3046\u3001\u305d\u308c\u3092\u907f\u3051\u305f\u3044\u5834\u5408\u306f\u524d\u8ff0\u306e\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9 * \u3092\u4f7f\u7528\u3057\u307e\u3059\u3002"}}return t.\u0275fac=function(e){return new(e||t)(He(fi),He(Fn),He(An),He(Dr))},t.\u0275cmp=Xt({type:t,selectors:[["dice-roll-table-setting"]],viewQuery:function(e,i){if(1&e&&cn(iX,5),2&e){let r;ln(r=un())&&(i.diceRollTableSelecter=r.first)}},decls:13,vars:3,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[2,"font-size","smaller","margin-bottom","3px",3,"click"],["size","15",2,"width","14em",3,"change"],["diceRollTableSelecter",""],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[2,"float","right",3,"click"],[4,"ngIf"],[3,"value","title"],[2,"font-size","smaller"],[2,"margin-bottom","3px"],["placeholder","Name",2,"width","60%","min-width","5em",3,"ngModel","ngModelChange"],[2,"white-space","nowrap"],["placeholder","Command",2,"width","7em",3,"ngModel","ngModelChange"],[2,"white-space","nowrap","margin-left","1em"],["placeholder","Dice",2,"width","3.3em","text-align","center",3,"ngModel","ngModelChange"],["placeholder","1:\u6570\u5b57\u3068\u7d50\u679c\u3092:\uff08\u30b3\u30ed\u30f3\uff09\u3067\u533a\u5207\u3063\u3066\u8a18\u8ff0\r\n2:\u7d50\u679c\uff12\r\n3:\u7d50\u679c\uff13\r\n4:\u2026",2,"width","100%","height","20em","margin-top","3px","resize","vertical",3,"ngModel","ngModelChange"],[3,"click"],[2,"float","right"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,i){1&e&&(Q(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Ae("click",function(){return i.add()}),ye(4,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u8ffd\u52a0"),ie()(),Q(5,"select",3,4),Ae("change",function(s){return i.onChangeDiceRollTable(s.target.value)}),Te(7,rX,2,5,"option",5),ie()(),Q(8,"div",6)(9,"button",7),Ae("click",function(){return i.helpDiceRollTable()}),ye(10,"?"),ie(),Te(11,cX,21,10,"ng-container",8),ie()(),Te(12,dX,4,1,"ng-container",8)),2&e&&(U(7),re("ngForOf",i.diceRollTables),U(4),re("ngIf",!i.isEmpty&&i.selectedDiceRollTable),U(1),re("ngIf",i.isEmpty))},directives:[oi,Ur,Vr,bn,mi,$i,di,Yn],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}"]}),t})();const hX=["cutInSelecter"];function pX(t,n){if(1&t&&(Q(0,"option",10),ye(1),ie()),2&t){const e=n.$implicit;Qe("color",e.isValidAudio?""==e.name?"gray":"":"red"),ht("value",e.identifier),ht("title",e.name),U(1),Xe((e.isPlayingNow?"\u25b6 ":"\u25a0 ")+(e.isValidAudio?"":"\u26a0\ufe0f")+(""==e.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":e.name))}}function gX(t,n){if(1&t&&(Q(0,"div",66)(1,"i",67),ye(2),ie()()),2&t){const e=_e(2);U(1),ud(e.isShowHideImages?"red-eye":"grow"),U(1),Xe(e.isShowHideImages?"visibility":"visibility_off")}}function _X(t,n){if(1&t){const e=it();Q(0,"button",8),Ae("click",function(){return Oe(e),_e(3).openModal()}),Q(1,"b"),ye(2,"\u753b\u50cf\u5909\u66f4"),ie()()}}function mX(t,n){if(1&t&&(Q(0,"div",68),Te(1,_X,3,0,"button",69),ie()),2&t){const e=_e(2);U(1),re("ngIf",!e.cutInVideoId||e.cutInisSoundOnly)}}function $X(t,n){if(1&t&&(Q(0,"div",70)(1,"i",71),ye(2),ie()()),2&t){const e=_e(2);U(2),Xe(e.cutInPlayListId?"featured_play_list":"movie")}}function vX(t,n){1&t&&(Ke(0),ye(1,"\uff08\u3042\u306a\u305f\uff09"),Ye())}function bX(t,n){if(1&t&&(Q(0,"option",72),ye(1),Te(2,vX,2,0,"ng-container",9),ie()),2&t){const e=n.$implicit,i=_e(2);Qe("color",e.color),ht("value",e.identifier),U(1),Rn("",e.name," "),U(1),re("ngIf",e===i.myPeer)}}function yX(t,n){if(1&t&&(Q(0,"option",73),ye(1),ie()),2&t){const e=n.$implicit;ht("value",e.identifier),U(1),Xe(e.name)}}function CX(t,n){1&t&&(Q(0,"span",48)(1,"i",76),ye(2,"check"),ie(),Q(3,"span",77),ye(4,"Link OK"),ie()())}function xX(t,n){if(1&t&&(Q(0,"span",78),ot(1,"i",79),Q(2,"span",80),ye(3,"\u26a0\ufe0fLink NG:"),ie(),ye(4),ie()),2&t){const e=_e(3);U(4),Rn(" ",e.cutInAudioFileName,"")}}function wX(t,n){if(1&t&&(Ke(0),Te(1,CX,5,0,"span",74),Te(2,xX,5,1,"span",75),Ye()),2&t){const e=_e(2);U(1),re("ngIf",e.isValidAudio),U(1),re("ngIf",!e.isValidAudio)}}function EX(t,n){if(1&t&&(Q(0,"div",86),ye(1),ie()),2&t){const e=_e(3);U(1),Rn("",e.progresPercent,"%")}}const TX=function(t){return{"is-hidden":t}};function SX(t,n){if(1&t){const e=it();Ke(0),Q(1,"button",8),Ae("click",function(){return Oe(e),_e(2).upTabIndex()}),ye(2,"\u2191"),ie(),Q(3,"button",8),Ae("click",function(){return Oe(e),_e(2).downTabIndex()}),ye(4,"\u2193"),ie(),Q(5,"div",19)(6,"button",81),Ae("click",function(){return Oe(e),_e(2).save()}),Q(7,"div",82)(8,"div",83),ye(9,"\u4fdd\u5b58"),ie(),Te(10,EX,2,1,"div",84),ie()(),Q(11,"button",85),Ae("click",function(){return Oe(e),_e(2).delete()}),ye(12,"\u524a\u9664"),ie()(),Ye()}if(2&t){const e=_e(2);U(6),re("disabled",e.isSaveing),U(2),re("ngClass",ft(3,TX,e.isSaveing)),U(2),re("ngIf",e.isSaveing)}}function IX(t,n){if(1&t){const e=it();Ke(0),Q(1,"button",8),Ae("click",function(){return Oe(e),_e(2).restore()}),ye(2,"\u5143\u306b\u623b\u3059"),ie(),Ye()}}const kX=function(t){return{blackout:t}},MX=function(t){return{"red-eye":t}},iI=function(t){return{"not-specified":t}},DX=function(t,n){return{color:t,"font-weight":n}};function AX(t,n){if(1&t){const e=it();Ke(0),Q(1,"div",11)(2,"div")(3,"div",12),Ae("dblclick",function(){Oe(e);const r=_e();return!(!r.isEditable||r.cutInVideoId&&!r.cutInisSoundOnly)&&r.openModal()}),Te(4,gX,3,3,"div",13),Te(5,mX,2,1,"div",14),Te(6,$X,3,1,"div",15),ot(7,"img",16),Et(8,"safe"),ie()(),Q(9,"div",17)(10,"div",18)(11,"div",19)(12,"label",20)(13,"input",21),Ae("click",function(r){return Oe(e),_e().onShowHiddenImages(r)}),ie(),Q(14,"i",22),ye(15),ie()()()(),Q(16,"div",23)(17,"b",24),ye(18,"Name: "),ie(),Q(19,"input",25),Ae("ngModelChange",function(r){return Oe(e),_e().cutInName=r}),ie(),Q(20,"b",26),ye(21,"Tag: "),ie(),Q(22,"input",27),Ae("ngModelChange",function(r){return Oe(e),_e().cutInTag=r}),ie()(),Q(23,"div",28)(24,"b",24),ye(25,"Duration (0=\u7121\u5236\u9650): "),ie(),Q(26,"input",29),Ae("ngModelChange",function(r){return Oe(e),_e().cutInDuration=r}),ie(),Q(27,"b",30),ye(28,"sec."),ie()(),Q(29,"div",23)(30,"b",24),ye(31,"Cut In: "),ie(),Q(32,"select",31),Ae("ngModelChange",function(r){return Oe(e),_e().cutInType=r}),Q(33,"option",32),ye(34,"\u5373\u6642\u51fa\u73fe"),ie(),Q(35,"option",32),ye(36,"\u6d6e\u304d\u51fa\u308b"),ie(),Q(37,"option",32),ye(38,"\u98db\u3073\u51fa\u3059"),ie(),Q(39,"option",32),ye(40,"\u958b\u304f\uff08\u5de6\u53f3\uff09"),ie(),Q(41,"option",32),ye(42,"\u958b\u304f\uff08\u4e0a\u4e0b\uff09"),ie()(),Q(43,"label",33)(44,"input",34),Ae("click",function(){Oe(e);const r=_e();return r.borderStyle=0==r.borderStyle?1:0}),ie(),Q(45,"b"),ye(46,"\u67a0\u3042\u308a"),ie()()(),Q(47,"div",23)(48,"b",24),ye(49,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e: "),ie(),ot(50,"br"),Q(51,"textarea",35),Ae("ngModelChange",function(r){return Oe(e),_e().cutInCond=r}),ie()()()(),Q(52,"div",36)(53,"div")(54,"button",8),Ae("click",function(){return Oe(e),_e().testCutIn()}),Q(55,"b"),ye(56,"\u30c6\u30b9\u30c8 (\u81ea\u5206\u3060\u3051\u898b\u308b)"),Q(57,"sup",37),ye(58,"*"),ie()()(),Q(59,"span",38)(60,"button",39),Ae("click",function(){return Oe(e),_e().playCutIn()}),Q(61,"b")(62,"i",40),ye(63,"play_arrow"),ie(),ye(64,"\u518d\u751f"),ie()(),Q(65,"button",41),Ae("click",function(){return Oe(e),_e().stopCutIn()}),Q(66,"b")(67,"i",40),ye(68,"stop"),ie(),ye(69,"\u505c\u6b62"),ie()(),Q(70,"span",42),ye(71," \u27a1 "),Q(72,"select",43),Ae("ngModelChange",function(r){return Oe(e),_e().sendTo=r}),Q(73,"option",44),ye(74,"\u5168\u54e1"),ie(),Te(75,bX,3,5,"option",45),ie()()()(),Q(76,"div",46)(77,"div")(78,"b",47),ye(79,"\u4f4d\u7f6e"),ie(),Q(80,"label",48)(81,"input",49),Ae("ngModelChange",function(r){return Oe(e),_e().cutInIsPreventOutBounds=r}),ie(),Q(82,"b"),ye(83,"\u898b\u5207\u308c\u9632\u6b62"),ie()()(),Q(84,"div",50)(85,"b"),ye(86,"PosX: "),ie(),Q(87,"input",51),Ae("ngModelChange",function(r){return Oe(e),_e().cutInPosX=r}),ie(),Q(88,"input",52),Ae("ngModelChange",function(r){return Oe(e),_e().cutInPosX=r}),ie(),Q(89,"b",23),ye(90,"%"),ie()(),Q(91,"div",50)(92,"b"),ye(93,"PosY: "),ie(),Q(94,"input",53),Ae("ngModelChange",function(r){return Oe(e),_e().cutInPosY=r}),ie(),Q(95,"input",52),Ae("ngModelChange",function(r){return Oe(e),_e().cutInPosY=r}),ie(),Q(96,"b",23),ye(97,"%"),ie()(),Q(98,"div",50)(99,"b"),ye(100,"Z-Index (\u5927\u304d\u3044\u3082\u306e\u304c\u524d): "),ie(),Q(101,"input",52),Ae("ngModelChange",function(r){return Oe(e),_e().cutInZIndex=r}),ie(),Q(102,"label",48)(103,"input",54),Ae("ngModelChange",function(r){return Oe(e),_e().cutInIsFrontOfStand=r}),ie(),Q(104,"b"),ye(105,"\u30b9\u30bf\u30f3\u30c9\u306e\u524d\u9762\u306b\u8868\u793a"),ie()()()(),Q(106,"div",46)(107,"div")(108,"b",47),ye(109,"\u30b5\u30a4\u30ba\uff08\u5e45\u3001\u9ad8\u3055\u5171\u306b0\u306e\u5834\u5408\u306f\u5143\u753b\u50cf\u306e\u307e\u307e\uff09"),ie()(),Q(110,"div",50)(111,"b"),ye(112,"Width (0=\u6307\u5b9a\u306a\u3057): "),ie(),Q(113,"input",55),Ae("ngModelChange",function(r){return Oe(e),_e().cutInWidth=r}),ie(),Q(114,"input",52),Ae("ngModelChange",function(r){return Oe(e),_e().cutInWidth=r}),ie(),Q(115,"b",23),ye(116,"%"),ie()(),Q(117,"div",50)(118,"b"),ye(119,"Height (0=\u6307\u5b9a\u306a\u3057): "),ie(),Q(120,"input",56),Ae("ngModelChange",function(r){return Oe(e),_e().cutInHeight=r}),ie(),Q(121,"input",52),Ae("ngModelChange",function(r){return Oe(e),_e().cutInHeight=r}),ie(),Q(122,"b",23),ye(123,"%"),ie()(),Q(124,"div",50)(125,"b"),ye(126,"\u5143\u753b\u50cf\u3068\u7e26\u6a2a\u6bd4\u304c\u7570\u306a\u308b\u5834\u5408: "),ie(),Q(127,"select",57),Ae("ngModelChange",function(r){return Oe(e),_e().objectFitType=r}),Q(128,"option",32),ye(129,"\u4f38\u7e2e\u3059\u308b"),ie(),Q(130,"option",32),ye(131,"\u5207\u308a\u53d6\u308b"),ie()()()(),Q(132,"div",46)(133,"div")(134,"b",47),ye(135,"\u52b9\u679c\u97f3\u30fb\u52d5\u753b"),ie(),Q(136,"label",48)(137,"input",58),Ae("ngModelChange",function(r){return Oe(e),_e().cutInSEIsLoop=r}),ie(),Q(138,"b"),ye(139,"\u7e70\u308a\u8fd4\u3057"),ie()()(),Q(140,"div",50)(141,"input",59),Ae("ngModelChange",function(r){return Oe(e),_e().cutInIsVideo=r}),ie(),Q(142,"label",60)(143,"b"),ye(144,"\u97f3\u697d\u30d5\u30a1\u30a4\u30eb: "),ie()(),Q(145,"select",61),Ae("ngModelChange",function(r){return Oe(e),_e().cutInAudioIdentifier=r})("change",function(r){return Oe(e),_e().onAudioFileChange(r.target.value)}),Q(146,"option",44),ye(147,"\u52b9\u679c\u97f3\u306a\u3057"),ie(),Te(148,yX,2,2,"option",62),ie(),Te(149,wX,3,2,"ng-container",9),ie(),Q(150,"div",50)(151,"input",59),Ae("ngModelChange",function(r){return Oe(e),_e().cutInIsVideo=r}),ie(),Q(152,"label",60)(153,"b"),ye(154,"\u52d5\u753bURL: "),ie()(),Q(155,"input",63),Ae("ngModelChange",function(r){return Oe(e),_e().cutInVideoURL=r}),ie()(),Q(156,"div",64)(157,"a",65),Ae("click",function(){return Oe(e),_e().openYouTubeTerms()}),ye(158,"YouTube \u5229\u7528\u898f\u7d04"),ie()()()(),ot(159,"hr"),Q(160,"div"),Te(161,SX,13,5,"ng-container",9),Te(162,IX,3,0,"ng-container",9),ie(),Ye()}if(2&t){const e=_e();U(4),re("ngIf",(!e.cutInVideoId||e.cutInisSoundOnly)&&e.getHidden(e.cutInImage)),U(1),re("ngIf",e.isEditable),U(1),re("ngIf",e.cutInVideoId&&!e.cutInisSoundOnly),U(1),re("ngClass",ft(125,kX,(!e.cutInVideoId||e.cutInisSoundOnly)&&!e.isShowHideImages&&e.getHidden(e.cutInImage)))("src",Tt(8,122,e.cutInImageUrl,"resourceUrl"),en),U(6),ht("checked",e.isShowHideImages?"checked":""),U(1),re("ngClass",ft(127,MX,e.isShowHideImages)),U(1),Xe(e.isShowHideImages?"visibility":"visibility_off"),U(4),re("ngModel",e.cutInName),Bt("disabled",e.isEditable?null:""),U(3),re("ngModel",e.cutInTag),Bt("disabled",e.isEditable?null:""),U(4),re("ngModel",e.cutInDuration),Bt("disabled",!e.isEditable||e.isPlaying?"":null),U(6),re("ngModel",e.cutInType),Bt("disabled",e.isEditable?null:""),U(1),re("value",-1)("selected",-1==e.cutInType),U(2),re("value",0)("selected",0==e.cutInType),U(2),re("value",1)("selected",1==e.cutInType),U(2),re("value",2)("selected",2==e.cutInType),U(2),re("value",3)("selected",3==e.cutInType),U(3),re("checked",1==e.borderStyle),Bt("disabled",e.isEditable?null:""),U(7),re("ngModel",e.cutInCond),Bt("disabled",e.isEditable?null:""),U(3),Bt("disabled",e.isEditable?null:""),U(6),Bt("disabled",e.isEditable?null:""),U(5),Bt("disabled",e.isEditable?null:""),U(7),re("ngModel",e.sendTo)("ngClass",ft(129,iI,""==e.sendTo))("ngStyle",Yt(131,DX,""==e.sendTo?null:e.sendToColor,""==e.sendTo?"normal":"bolder")),U(3),re("ngForOf",e.otherPeers),U(6),re("ngModel",e.cutInIsPreventOutBounds)("checked",e.cutInIsPreventOutBounds)("value",!0),Bt("disabled",!e.isEditable||e.cutInVideoId?"":null),U(6),ht("title",e.cutInPosX),ht("min",e.minSize),ht("max",e.maxSize),re("ngModel",e.cutInPosX),Bt("disabled",e.isEditable?null:""),U(1),ht("min",e.minSize),ht("max",e.maxSize),re("ngModel",e.cutInPosX),Bt("disabled",e.isEditable?null:""),U(6),ht("title",e.cutInPosY),ht("min",e.minSize),ht("max",e.maxSize),re("ngModel",e.cutInPosY),Bt("disabled",e.isEditable?null:""),U(1),ht("min",e.minSize),ht("max",e.maxSize),re("ngModel",e.cutInPosY),Bt("disabled",e.isEditable?null:""),U(6),ht("min",-e.maxSize),ht("max",e.maxSize),re("ngModel",e.cutInZIndex),Bt("disabled",!e.isEditable||e.cutInVideoId?"":null),U(2),re("ngModel",e.cutInIsFrontOfStand)("checked",e.cutInIsFrontOfStand)("value",!0),Bt("disabled",!e.isEditable||e.cutInVideoId?"":null),U(10),ht("title",e.cutInWidth),ht("min",e.minSize),ht("max",e.maxSize),re("ngModel",e.cutInWidth),Bt("disabled",e.isEditable?null:""),U(1),ht("min",e.minSize),ht("max",2*e.maxSize),re("ngModel",e.cutInWidth),Bt("disabled",e.isEditable?null:""),U(6),ht("title",e.cutInHeight),ht("min",e.minSize),ht("max",e.maxSize),re("ngModel",e.cutInHeight),Bt("disabled",e.isEditable?null:""),U(1),ht("min",e.minSize),ht("max",2*e.maxSize),re("ngModel",e.cutInHeight),Bt("disabled",e.isEditable?null:""),U(6),re("ngModel",e.objectFitType),Bt("disabled",e.cutInVideoId&&!e.cutInisSoundOnly||!e.isEditable?"":null),U(1),re("value",0)("selected",0==e.objectFitType),U(2),re("value",1)("selected",1==e.objectFitType),U(7),re("ngModel",e.cutInSEIsLoop)("checked",e.cutInSEIsLoop)("value",!0),Bt("disabled",!e.isEditable||e.isPlaying?"":null),U(4),Zi("name","",e.panelId,"-media")("id","",e.panelId,"-media-sound"),re("ngModel",e.cutInIsVideo)("checked",!e.cutInIsVideo)("value",!1),Bt("disabled",!e.isEditable||e.isPlaying?"":null),U(1),Zi("for","",e.panelId,"-media-sound"),U(3),Qe("min-width",e.isValidAudio?10:5,"em")("max-width",e.isValidAudio?20:5,"em"),re("ngModel",e.cutInAudioIdentifier)("ngClass",ft(134,iI,""==e.cutInAudioIdentifier)),Bt("disabled",e.cutInIsVideo||!e.isEditable||e.isPlaying?"":null),U(3),re("ngForOf",e.audios),U(1),re("ngIf",e.isEditable&&e.cutInAudioFileName.length>0),U(2),Zi("name","",e.panelId,"-media")("id","",e.panelId,"-media-video"),re("ngModel",e.cutInIsVideo)("checked",e.cutInIsVideo)("value",!0),Bt("disabled",!e.isEditable||e.isPlaying?"":null),U(1),Zi("for","",e.panelId,"-media-video"),U(3),re("ngModel",e.cutInVideoURL),Bt("disabled",e.cutInIsVideo&&e.isEditable&&!e.isPlaying?null:""),U(6),re("ngIf",!e.isDeleted),U(1),re("ngIf",e.isDeleted&&e.selectedCutInXml)}}function PX(t,n){if(1&t){const e=it();Ke(0),Q(1,"button",8),Ae("click",function(){return Oe(e),_e(2).restore()}),ye(2,"\u5143\u306b\u623b\u3059"),ie(),Ye()}}function NX(t,n){if(1&t&&(Ke(0),Q(1,"div",87),ye(2," \u203b\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u3042\u308a\u307e\u305b\u3093\u3002 "),Te(3,PX,3,0,"ng-container",9),ie(),Ye()),2&t){const e=_e();U(3),re("ngIf",e.isDeleted&&e.selectedCutInXml)}}let FX=(()=>{class t{constructor(e,i,r,s,o,a){this.changeDetector=e,this.pointerDeviceService=i,this.modalService=r,this.panelService=s,this.saveDataService=o,this.chatMessageService=a,this.minSize=0,this.maxSize=100,this.isShowHideImages=!1,this.selectedCutIn=null,this.selectedCutInXml="",this.sendTo="",this.isSaveing=!1,this.progresPercent=0}get cutIns(){return _o.instance.cutIns}get cutInName(){return this.selectedCutIn.name}set cutInName(e){this.isEditable&&(this.selectedCutIn.name=e)}get cutInTag(){return this.selectedCutIn.tag}set cutInTag(e){this.isEditable&&(this.selectedCutIn.tag=e)}get cutInDuration(){return this.selectedCutIn.duration}set cutInDuration(e){this.isEditable&&(this.selectedCutIn.duration=e)}get cutInCond(){return this.selectedCutIn.value+""}set cutInCond(e){this.isEditable&&(this.selectedCutIn.value=e)}get cutInIsPreventOutBounds(){return this.selectedCutIn.isPreventOutBounds}set cutInIsPreventOutBounds(e){this.isEditable&&(this.selectedCutIn.isPreventOutBounds=e)}get cutInWidth(){return this.selectedCutIn.width}set cutInWidth(e){this.isEditable&&(this.selectedCutIn.width=e)}get cutInHeight(){return this.selectedCutIn.height}set cutInHeight(e){this.isEditable&&(this.selectedCutIn.height=e)}get objectFitType(){return this.selectedCutIn.objectFitType}set objectFitType(e){this.isEditable&&(this.selectedCutIn.objectFitType=e)}get cutInPosX(){return this.selectedCutIn.posX}set cutInPosX(e){this.isEditable&&(this.selectedCutIn.posX=e)}get cutInPosY(){return this.selectedCutIn.posY}set cutInPosY(e){this.isEditable&&(this.selectedCutIn.posY=e)}get cutInZIndex(){return this.selectedCutIn.zIndex}set cutInZIndex(e){this.isEditable&&(this.selectedCutIn.zIndex=e)}get cutInIsFrontOfStand(){return this.selectedCutIn.isFrontOfStand}set cutInIsFrontOfStand(e){this.isEditable&&(this.selectedCutIn.isFrontOfStand=e)}get cutInAudioIdentifier(){return this.selectedCutIn.audioIdentifier}set cutInAudioIdentifier(e){this.isEditable&&(this.selectedCutIn.audioIdentifier=e)}get cutInAudioFileName(){return this.selectedCutIn.audioFileName}set cutInAudioFileName(e){this.isEditable&&(this.selectedCutIn.audioFileName=e)}get cutInSEIsLoop(){return this.selectedCutIn.isLoop}set cutInSEIsLoop(e){this.isEditable&&(this.selectedCutIn.isLoop=e)}get cutInType(){return this.selectedCutIn.animationType}set cutInType(e){this.isEditable&&(this.selectedCutIn.animationType=e)}get borderStyle(){return this.selectedCutIn.borderStyle}set borderStyle(e){this.isEditable&&(this.selectedCutIn.borderStyle=e)}get isEmpty(){return this.cutIns.length<1}get isDeleted(){return!!this.selectedCutIn&&null==dt.instance.get(this.selectedCutIn.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}get cutInIsVideo(){return this.selectedCutIn.isVideoCutIn}set cutInIsVideo(e){this.isEditable&&(this.selectedCutIn.isVideoCutIn=e)}get cutInVideoURL(){return this.selectedCutIn.videoUrl}set cutInVideoURL(e){this.isEditable&&(this.selectedCutIn.videoUrl=e)}get cutInisSoundOnly(){return this.selectedCutIn.isSoundOnly}set cutInisSoundOnly(e){this.isEditable&&(this.selectedCutIn.isSoundOnly=e)}get cutInVideoId(){return this.selectedCutIn?this.selectedCutIn.videoId:""}get cutInPlayListId(){return this.cutInVideoId?this.selectedCutIn.playListId:""}get cutInImage(){return this.selectedCutIn&&Nt.instance.get(this.selectedCutIn.imageIdentifier)||Ut.Empty}get cutInImageUrl(){return this.selectedCutIn?!this.selectedCutIn.videoId||this.cutInisSoundOnly?this.cutInImage.url:`https://img.youtube.com/vi/${this.selectedCutIn.videoId}/hqdefault.jpg`:Ut.Empty.url}get isPlaying(){return!!this.selectedCutIn&&qp.nowShowingIdentifiers().includes(this.selectedCutIn.identifier)}get isValidAudio(){return!this.selectedCutIn||this.selectedCutIn.isValidAudio}get myPeer(){return We.myCursor}get otherPeers(){return dt.instance.getObjects(We)}get myColor(){return We.myCursor&&We.myCursor.color&&We.myCursor.color!=We.CHAT_TRANSPARENT_COLOR?We.myCursor.color:We.CHAT_DEFAULT_COLOR}get sendToColor(){let e=dt.instance.get(this.sendTo);return e instanceof We?e.color:We.CHAT_DEFAULT_COLOR}get audios(){return zt.instance.audios.filter(e=>!e.isHidden)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30ab\u30c3\u30c8\u30a4\u30f3\u8a2d\u5b9a"),ze.register(this).on("SYNCHRONIZE_AUDIO_LIST",-1e3,e=>{this.onAudioFileChange()}),this.panelId=ns.generateUuid()}ngAfterViewInit(){this.cutIns.length>0&&queueMicrotask(()=>{this.onChangeCutIn(this.cutIns[0].identifier),this.cutInSelecter.nativeElement.selectedIndex=0})}ngOnDestroy(){ze.unregister(this)}onChangeCutIn(e){this.selectedCutIn=dt.instance.get(e),this.selectedCutInXml=""}create(e="\u30ab\u30c3\u30c8\u30a4\u30f3"){return _o.instance.addCutIn(e)}add(){const e=this.create();e.imageIdentifier="stand_no_image",queueMicrotask(()=>{this.onChangeCutIn(e.identifier),this.cutInSelecter.nativeElement.value=e.identifier})}save(){var e=this;return(0,tn.Z)(function*(){if(!e.selectedCutIn||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i="fly_cutIn_"+e.selectedCutIn.name;yield e.saveDataService.saveGameObjectAsync(e.selectedCutIn,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}delete(){!this.selectedCutIn||(ze.call("STOP_CUT_IN",{identifier:this.selectedCutIn.identifier}),this.isEmpty||(this.selectedCutInXml=this.selectedCutIn.toXml(),this.selectedCutIn.destroy()))}restore(){if(this.selectedCutIn&&this.selectedCutInXml){let e=ti.instance.parseXml(this.selectedCutInXml);_o.instance.addCutIn(e),this.selectedCutInXml="",queueMicrotask(()=>{const i=this.cutIns;this.onChangeCutIn(i[i.length-1].identifier),this.cutInSelecter.nativeElement.selectedIndex=i.length-1})}}getHidden(e){const i=wn.get(e.identifier);return!!i&&i.hide}upTabIndex(){if(!this.selectedCutIn)return;let e=this.selectedCutIn.parent,i=e.children.indexOf(this.selectedCutIn);0<i&&e.insertBefore(this.selectedCutIn,e.children[i-1])}downTabIndex(){if(!this.selectedCutIn)return;let e=this.selectedCutIn.parent,i=e.children.indexOf(this.selectedCutIn);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.selectedCutIn)}openModal(){if(this.isDeleted)return;let e=[];this.selectedCutIn&&this.selectedCutIn.imageIdentifier&&(e=[this.selectedCutIn.imageIdentifier]),this.modalService.open(Ko,{currentImageIdentifires:e}).then(i=>{!this.selectedCutIn||!i||(this.selectedCutIn.imageIdentifier=i)})}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(er,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:Si.OK_CANCEL,materialIcon:"visibility",action:()=>{this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}playCutIn(){const e=this.selectedCutIn;if(!e)return;const i={identifier:e.identifier,secret:!!this.sendTo,sender:We.myCursor.peerId};if(i.secret){const r=dt.instance.get(this.sendTo);r&&(r.peerId!=We.myCursor.peerId&&ze.call("PLAY_CUT_IN",i,r.peerId),ze.call("PLAY_CUT_IN",i,We.myCursor.peerId))}else ze.call("PLAY_CUT_IN",i),this.chatMessageService.sendOperationLog((""==e.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":e.name)+" \u3092\u518d\u751f\u3057\u305f")}stopCutIn(){if(!this.selectedCutIn)return;const e={identifier:this.selectedCutIn.identifier,secret:!!this.sendTo,sender:We.myCursor.peerId};if(e.secret){const i=dt.instance.get(this.sendTo);i&&(i.peerId!=We.myCursor.peerId&&ze.call("STOP_CUT_IN",e,i.peerId),ze.call("STOP_CUT_IN",e,We.myCursor.peerId))}else ze.call("STOP_CUT_IN",e)}testCutIn(){!this.selectedCutIn||queueMicrotask(()=>{ze.trigger("PLAY_CUT_IN",{identifier:this.selectedCutIn.identifier,test:!0})})}onAudioFileChange(e=""){if(!e&&this.selectedCutIn&&(e=this.selectedCutIn.audioIdentifier),""==e)return void(this.cutInAudioFileName="");const i=zt.instance.get(e);this.cutInAudioFileName=i?i.name:""}openYouTubeTerms(){return this.modalService.open(qr,{url:"https://www.youtube.com/terms",title:"YouTube \u5229\u7528\u898f\u7d04"}),!1}helpCutIn(){let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(du,{left:e.x,top:e.y,width:600,height:620});r.title="\u30ab\u30c3\u30c8\u30a4\u30f3\u30d8\u30eb\u30d7",r.text=`\u3000\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u540d\u524d\u3001\u8868\u793a\u6642\u9593\u3001\u4f4d\u7f6e\u3068\u5e45\u3068\u9ad8\u3055\uff08\u305d\u308c\u305e\u308c\u753b\u9762\u30b5\u30a4\u30ba\u306b\u5bfe\u3059\u308b\u76f8\u5bfe\u6307\u5b9a\uff09\u3001\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u306b\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u8868\u793a\u3055\u308c\u308b\u6761\u4ef6\u3092\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\u307e\u305f\u3001\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u5834\u5408\u304a\u3088\u3073\u300c\u898b\u5207\u308c\u9632\u6b62\u300d\u306b\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u305f\u5834\u5408\u3001\u753b\u9762\u5185\u306b\u53ce\u307e\u308b\u3088\u3046\u306b\u4f4d\u7f6e\u3068\u30b5\u30a4\u30ba\u304c\u8abf\u6574\u3055\u308c\u307e\u3059\u3002\n\u3000\n\u3000\u6a2a\u4f4d\u7f6e\uff08PosX\uff09\u3068\u7e26\u4f4d\u7f6e\uff08PosY\uff09\u306f\u3001\u753b\u9762\u306e\u5de6\u4e0a\u9685\u304b\u3089\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u4e2d\u5fc3\u4f4d\u7f6e\u307e\u3067\u306e\u8ddd\u96e2\u3068\u306a\u308a\u307e\u3059\u3002\u30b5\u30a4\u30ba\u306e\u5e45\uff08Width\uff09\u3068\u9ad8\u3055\uff08Height\uff09\u306e\u3069\u3061\u3089\u304b\u30920\u3068\u3057\u305f\u5834\u5408\u3001\u5143\u753b\u50cf\u306e\u7e26\u6a2a\u6bd4\u3092\u4fdd\u3063\u3066\u62e1\u5927\u7e2e\u5c0f\u3057\u307e\u3059\uff08\u305f\u3060\u3057\u3001\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u6700\u5c0f\u5e45\u3001\u9ad8\u3055\u306f${vT.MIN_SIZE}\u30d4\u30af\u30bb\u30eb\u3068\u306a\u308a\u307e\u3059\uff09\u3002\n\u3000\n\u3000\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u5fc5\u305a\u524d\u9762\u3001\u305d\u306e\u4ed6\u306f\u5f8c\u304b\u3089\u8868\u793a\u3055\u308c\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u753b\u50cf\u304c\u3088\u308a\u524d\u9762\u306b\u306a\u308a\u307e\u3059\u304c\u3001\u91cd\u306a\u308a\u9806\uff08Z-Index\uff09\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3067\u5236\u5fa1\u53ef\u80fd\u3067\u3059\u3002\u540c\u3058\u30ab\u30c3\u30c8\u30a4\u30f3\u3001\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u3001\u540c\u3058\u30bf\u30b0\u304c\u6307\u5b9a\u3055\u308c\u305f\u30ab\u30c3\u30c8\u30a4\u30f3\u3092\u518d\u751f\u3059\u308b\u5834\u5408\u306f\u3001\u4ee5\u524d\u306e\u3082\u306e\u306f\u505c\u6b62\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u6761\u4ef6\u3092\u6e80\u305f\u3059\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u8907\u6570\u3042\u308b\u5834\u5408\u3001\n\n\u3000\u3000\u30fb\u30bf\u30b0\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3082\u306e\u306f\u3059\u3079\u3066\n\u3000\u3000\u30fb\u30bf\u30b0\u304c\u8a2d\u5b9a\u3055\u308c\u305f\u3082\u306e\u306f\u3001\u540c\u3058\u30bf\u30b0\u306e\u3082\u306e\u306e\u4e2d\u304b\u3089\u30e9\u30f3\u30c0\u30e0\u306b1\u3064\n\u3000\u3000\u30fb\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u4e0a\u8a18\u306e\u4e2d\u304b\u3089\u30e9\u30f3\u30c0\u30e0\u306b1\u3064\u3092\u9078\u629e\n\n\u3068\u306a\u308a\u307e\u3059\u3002\n\n\u3000\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u30c9\u30e9\u30c3\u30b0\u306b\u3088\u3063\u3066\u79fb\u52d5\u53ef\u80fd\u3067\u3059\uff08\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u7aef\u3092\u30c9\u30e9\u30c3\u30b0\uff09\u3002\u307e\u305f\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af\u3067\u9589\u3058\u308b\uff08\u81ea\u5206\u3060\u3051\u505c\u6b62\uff09\u3001\u53f3\u30af\u30ea\u30c3\u30af\u3067\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u64cd\u4f5c\u304c\u53ef\u80fd\u3067\u3059\uff08\u300c\u9589\u3058\u308b\u300d\u300c\u30a6\u30a3\u30f3\u30c9\u30a6\u306e\u80cc\u9762\u306b\u8868\u793a\u300d\u300c\u6700\u5c0f\u5316\u300d\u304c\u53ef\u80fd\u3001\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u7aef\u3067\u53d7\u4ed8\uff09\u3002\n\n\u3000\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u3092\u30ab\u30c3\u30c8\u30a4\u30f3\u8868\u793a\u6642\u306e\u52b9\u679c\u97f3\u3068\u3057\u3066\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\u97f3\u91cf\u306b\u306f\u30b8\u30e5\u30fc\u30af\u30dc\u30c3\u30af\u30b9\u306e\u8a2d\u5b9a\uff08\u300c\u30c6\u30b9\u30c8 (\u81ea\u5206\u3060\u3051\u898b\u308b)\u300d\u306e\u5834\u5408\u306f\u8a66\u8074\u97f3\u91cf\uff09\u304c\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002\u8868\u793a\u6642\u9593\u3084\u624b\u52d5\u64cd\u4f5c\u306b\u3088\u3063\u3066\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u505c\u6b62\u3057\u305f\u969b\u306b\u306f\u3001\u9014\u4e2d\u3067\u3042\u3063\u3066\u3082\u97f3\u58f0\u3082\u505c\u6b62\u3057\u307e\u3059\u3002\u30ab\u30c3\u30c8\u30a4\u30f3\u3084\u90e8\u5c4b\u306e\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u306b\u306f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u542b\u307e\u308c\u307e\u305b\u3093\u306e\u3067\u3001\u5fc5\u8981\u3067\u3057\u305f\u3089\u5225\u9014\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u304f\u3060\u3055\u3044\uff08\u30ab\u30c3\u30c8\u30a4\u30f3\u3068\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306e\u30ea\u30f3\u30af\u306f\u30d5\u30a1\u30a4\u30eb\u306e\u5185\u5bb9\u306b\u3088\u308a\u307e\u3059\u3001\u540c\u540d\u306e\u5225\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u3082\u518d\u30ea\u30f3\u30af\u3055\u308c\u307e\u305b\u3093\uff09\u3002\n\n\u3000\u30ab\u30c3\u30c8\u30a4\u30f3\u306b\u52d5\u753b\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u3001URL\u306f\u73fe\u5728YouTube\u306e\u3082\u306e\u306e\u307f\u6709\u52b9\u3067\u3059\u3002\u52d5\u753b\u3092\u5229\u7528\u3059\u308b\u969b\u306f\u6a29\u5229\u8005\u304a\u3088\u3073YouTube\u306e\u5b9a\u3081\u305f\u5229\u7528\u898f\u7d04\u3092\u53c2\u7167\u3057\u3001\u9806\u5b88\u3057\u3066\u304f\u3060\u3055\u3044\u3002`}}return t.\u0275fac=function(e){return new(e||t)(He(Oi),He(fi),He(Fn),He(An),He(Dr),He(kr))},t.\u0275cmp=Xt({type:t,selectors:[["app-cut-in-setting"]],viewQuery:function(e,i){if(1&e&&cn(hX,5),2&e){let r;ln(r=un())&&(i.cutInSelecter=r.first)}},decls:14,vars:3,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[2,"font-size","smaller","margin-bottom","3px",3,"click"],["size","15",2,"width","12em",3,"change"],["cutInSelecter",""],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[2,"float","right","margin-top","3px","margin-right","3px"],[3,"click"],[4,"ngIf"],[3,"value","title"],[2,"display","flex"],[2,"position","relative","overflow","hidden",3,"dblclick"],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["style","position: absolute; top: 1px; left: -1px; z-index: 5",4,"ngIf"],["class","grow","style","opacity: 0.8; position: absolute; bottom: 1px; right: -1px; z-index: 5",4,"ngIf"],[2,"width","160px","height","160px","object-fit","contain",3,"ngClass","src"],[2,"display","flex","flex-direction","column","width","100%"],[2,"padding-bottom","2px"],[2,"float","right"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[2,"padding-left","2px"],[2,"font-size","smaller"],["type","text","placeholder","Name",2,"width","8em",3,"ngModel","ngModelChange"],[2,"font-size","smaller","margin-left","1em"],["type","text","placeholder","Tag",2,"width","3em",3,"ngModel","ngModelChange"],[2,"padding-left","2px","padding-top","2px"],["type","number","min","0","max","1000",2,"width","3.5em",3,"ngModel","ngModelChange"],[2,"font-size","smaller","padding-left","2px"],[2,"min-width","8em",3,"ngModel","ngModelChange"],[3,"value","selected"],[2,"margin-left","1em","font-size","smaller"],["name","borderStyle","type","checkbox",3,"checked","click"],["placeholder","1\u884c\u306b\u4e00\u3064\u3001\u5192\u982d@\u3067\u30de\u30c3\u30c1\u6642\u306b\u30c6\u30ad\u30b9\u30c8\u304b\u3089\u5207\u308a\u53d6\u308a\r\n@\u8857\u4e26\u307f",2,"width","100%","height","3em",3,"ngModel","ngModelChange"],[2,"font-size","smaller","display","flex","flex-direction","column","width","100%"],[1,"self-only"],[2,"margin-left","2em"],[2,"margin-right","0px",3,"click"],[1,"material-icons",2,"font-size","smaller"],[2,"margin-left","0px",3,"click"],[2,"white-space","nowrap"],[2,"max-width","10em",3,"ngModel","ngClass","ngStyle","ngModelChange"],["value","",1,"not-specified"],["style","font-weight: bolder;",3,"value","color",4,"ngFor","ngForOf"],[1,"section"],[1,"header"],[2,"margin-left","0.6em"],["name","cutInIsPreventOutBounds","type","checkbox",3,"ngModel","checked","value","ngModelChange"],[2,"padding-left","1em"],["type","range","name","cutInPosX",2,"width","180px",3,"ngModel","title","min","max","ngModelChange"],["type","number",2,"width","3.5em",3,"ngModel","min","max","ngModelChange"],["type","range","name","cutInPosY",2,"width","180px",3,"ngModel","title","min","max","ngModelChange"],["name","cutInIsFrontOfStand","type","checkbox",3,"ngModel","checked","value","ngModelChange"],["type","range","name","cutInWidth",2,"width","180px",3,"ngModel","title","min","max","ngModelChange"],["type","range","name","cutIHeight",2,"width","180px",3,"ngModel","title","min","max","ngModelChange"],[3,"ngModel","ngModelChange"],["name","cutInSEIsLoop","type","checkbox",3,"ngModel","checked","value","ngModelChange"],["type","radio",3,"name","id","ngModel","checked","value","ngModelChange"],[3,"for"],[3,"ngModel","ngClass","ngModelChange","change"],["style","color: black",3,"value",4,"ngFor","ngForOf"],["type","text",2,"width","24em",3,"ngModel","ngModelChange"],[2,"padding-left","2.5em"],["href","https://www.youtube.com/terms","target","_blank",1,"outer-link",3,"click"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons",2,"margin-right","2px","font-size","16px","display","block"],[2,"position","absolute","top","1px","left","-1px","z-index","5"],[3,"click",4,"ngIf"],[1,"grow",2,"opacity","0.8","position","absolute","bottom","1px","right","-1px","z-index","5"],[1,"material-icons",2,"font-size","32px"],[2,"font-weight","bolder",3,"value"],[2,"color","black",3,"value"],["style","margin-left: 0.6em",4,"ngIf"],["style","margin-left: 0.6em; color: red; display:inline-block; white-space: nowrap; max-width: 20em; overflow: hidden; text-overflow: ellipsis",4,"ngIf"],[1,"material-icons",2,"font-size","14px"],[2,"color","blue"],[2,"margin-left","0.6em","color","red","display","inline-block","white-space","nowrap","max-width","20em","overflow","hidden","text-overflow","ellipsis"],[1,"material-icons"],[2,"font-weight","bolder"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,i){1&e&&(Q(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Ae("click",function(){return i.add()}),ye(4,"\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u8ffd\u52a0"),ie()(),Q(5,"select",3,4),Ae("change",function(s){return i.onChangeCutIn(s.target.value)}),Te(7,pX,2,5,"option",5),ie()(),Q(8,"div",6)(9,"div",7)(10,"button",8),Ae("click",function(){return i.helpCutIn()}),ye(11,"?"),ie()(),Te(12,AX,163,136,"ng-container",9),ie()(),Te(13,NX,4,1,"ng-container",9)),2&e&&(U(7),re("ngForOf",i.cutIns),U(5),re("ngIf",!i.isEmpty&&i.selectedCutIn),U(1),re("ngIf",i.isEmpty))},directives:[oi,Ur,Vr,bn,Yn,mi,$i,di,Oo,Fo,ps,es,Ji,Jr,gs,Oa],pipes:[ai],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.header[_ngcontent-%COMP%]{margin-top:3px}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.blackout[_ngcontent-%COMP%]{filter:blur(12px) grayscale(70%)}.self-only[_ngcontent-%COMP%]{color:red}img[_ngcontent-%COMP%]{transition:all .1s 0s ease}.self-setting[_ngcontent-%COMP%]{font-weight:bolder;font-size:smaller}input[type=number][_ngcontent-%COMP%]{text-align:right}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.not-specified[_ngcontent-%COMP%]{color:gray}.self-only[_ngcontent-%COMP%]{color:red;vertical-align:text-top}.section[_ngcontent-%COMP%]{margin-top:.4em}"]}),t})();function rI(t){return new F(n=>{$r(t()).subscribe(n)})}const RX=["addListener","removeListener"],BX=["addEventListener","removeEventListener"],LX=["on","off"];function pg(t,n,e,i){if(d(e)&&(i=e,e=void 0),i)return pg(t,n,e).pipe(Dd(i));const[r,s]=function HX(t){return d(t.addEventListener)&&d(t.removeEventListener)}(t)?BX.map(o=>a=>t[o](n,a,e)):function zX(t){return d(t.addListener)&&d(t.removeListener)}(t)?RX.map(sI(t,n)):function jX(t){return d(t.on)&&d(t.off)}(t)?LX.map(sI(t,n)):[];if(!r&&vo(t))return $a(o=>pg(o,n,e))($r(t));if(!r)throw new TypeError("Invalid event target");return new F(o=>{const a=(...h)=>o.next(1<h.length?h:h[0]);return r(a),()=>s(a)})}function sI(t,n){return e=>i=>t[e](n,i)}const il=new F(B);class UX extends x{constructor(n,e){super()}schedule(n,e=0){return this}}const gg={setInterval(t,n,...e){const{delegate:i}=gg;return(null==i?void 0:i.setInterval)?i.setInterval(t,n,...e):setInterval(t,n,...e)},clearInterval(t){const{delegate:n}=gg;return((null==n?void 0:n.clearInterval)||clearInterval)(t)},delegate:void 0},oI={now:()=>(oI.delegate||Date).now(),delegate:void 0};class $f{constructor(n,e=$f.now){this.schedulerActionCtor=n,this.now=e}schedule(n,e=0,i){return new this.schedulerActionCtor(this,n).schedule(i,e)}}$f.now=oI.now;const aI=new class GX extends $f{constructor(n,e=$f.now){super(n,e),this.actions=[],this._active=!1}flush(n){const{actions:e}=this;if(this._active)return void e.push(n);let i;this._active=!0;do{if(i=n.execute(n.state,n.delay))break}while(n=e.shift());if(this._active=!1,i){for(;n=e.shift();)n.unsubscribe();throw i}}}(class VX extends UX{constructor(n,e){super(n,e),this.scheduler=n,this.work=e,this.pending=!1}schedule(n,e=0){var i;if(this.closed)return this;this.state=n;const r=this.id,s=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(s,r,e)),this.pending=!0,this.delay=e,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(s,this.id,e),this}requestAsyncId(n,e,i=0){return gg.setInterval(n.flush.bind(n,this),i)}recycleAsyncId(n,e,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return e;null!=e&&gg.clearInterval(e)}execute(n,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(n,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,e){let r,i=!1;try{this.work(n)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:n,scheduler:e}=this,{actions:i}=e;this.work=this.state=this.scheduler=null,this.pending=!1,$(i,this),null!=n&&(this.id=this.recycleAsyncId(e,n,null)),this.delay=null,super.unsubscribe()}}}),qX=aI;function lI(t,n){return n?e=>Vp(n.pipe(Go(1),function WX(){return y((t,n)=>{t.subscribe(m(n,B))})}()),e.pipe(lI(t))):$a((e,i)=>t(e,i).pipe(Go(1),function KX(t){return se(()=>t)}(e)))}const vf="Service workers are disabled or not supported by this browser";class _g{constructor(n){if(this.serviceWorker=n,n){const i=pg(n,"controllerchange").pipe(se(()=>n.controller)),s=Vp(rI(()=>Za(n.controller)),i);this.worker=s.pipe(Gl(X=>!!X)),this.registration=this.worker.pipe(of(()=>n.getRegistration()));const w=pg(n,"message").pipe(se(X=>X.data)).pipe(Gl(X=>X&&X.type)).pipe(hT());w.connect(),this.events=w}else this.worker=this.events=this.registration=function QX(t){return rI(()=>function OX(t,n){const e=d(t)?t:()=>t,i=r=>r.error(e());return new F(n?r=>n.schedule(i,0,r):i)}(new Error(t)))}(vf)}postMessage(n,e){return this.worker.pipe(Go(1),dT(i=>{i.postMessage(Object.assign({action:n},e))})).toPromise().then(()=>{})}postMessageWithOperation(n,e,i){const r=this.waitForOperationCompleted(i),s=this.postMessage(n,e);return Promise.all([s,r]).then(([,o])=>o)}generateNonce(){return Math.round(1e7*Math.random())}eventsOfType(n){let e;return e="string"==typeof n?i=>i.type===n:i=>n.includes(i.type),this.events.pipe(Gl(e))}nextEventOfType(n){return this.eventsOfType(n).pipe(Go(1))}waitForOperationCompleted(n){return this.eventsOfType("OPERATION_COMPLETED").pipe(Gl(e=>e.nonce===n),Go(1),se(e=>{if(void 0!==e.result)return e.result;throw new Error(e.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}}let JX=(()=>{class t{constructor(e){if(this.sw=e,this.subscriptionChanges=new u,!e.isEnabled)return this.messages=il,this.notificationClicks=il,void(this.subscription=il);this.messages=this.sw.eventsOfType("PUSH").pipe(se(r=>r.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(se(r=>r.data)),this.pushManager=this.sw.registration.pipe(se(r=>r.pushManager));const i=this.pushManager.pipe(of(r=>r.getSubscription()));this.subscription=cl(i,this.subscriptionChanges)}get isEnabled(){return this.sw.isEnabled}requestSubscription(e){if(!this.sw.isEnabled)return Promise.reject(new Error(vf));const i={userVisibleOnly:!0};let r=this.decodeBase64(e.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),s=new Uint8Array(new ArrayBuffer(r.length));for(let o=0;o<r.length;o++)s[o]=r.charCodeAt(o);return i.applicationServerKey=s,this.pushManager.pipe(of(o=>o.subscribe(i)),Go(1)).toPromise().then(o=>(this.subscriptionChanges.next(o),o))}unsubscribe(){return this.sw.isEnabled?this.subscription.pipe(Go(1),of(i=>{if(null===i)throw new Error("Not subscribed to push notifications.");return i.unsubscribe().then(r=>{if(!r)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})})).toPromise():Promise.reject(new Error(vf))}decodeBase64(e){return atob(e)}}return t.\u0275fac=function(e){return new(e||t)(an(_g))},t.\u0275prov=rn({token:t,factory:t.\u0275fac}),t})(),cI=(()=>{class t{constructor(e){if(this.sw=e,!e.isEnabled)return this.versionUpdates=il,this.available=il,this.activated=il,void(this.unrecoverable=il);this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY"]),this.available=this.versionUpdates.pipe(Gl(i=>"VERSION_READY"===i.type),se(i=>({type:"UPDATE_AVAILABLE",current:i.currentVersion,available:i.latestVersion}))),this.activated=this.sw.eventsOfType("UPDATE_ACTIVATED"),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}get isEnabled(){return this.sw.isEnabled}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(vf));const e=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:e},e)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(vf));const e=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:e},e)}}return t.\u0275fac=function(e){return new(e||t)(an(_g))},t.\u0275prov=rn({token:t,factory:t.\u0275fac}),t})();class kv{}const uI=new On("NGSW_REGISTER_SCRIPT");function eQ(t,n,e,i){return()=>{if(!_$(i)||!("serviceWorker"in navigator)||!1===e.enabled)return;let s;if(navigator.serviceWorker.addEventListener("controllerchange",()=>{null!==navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({action:"INITIALIZE"})}),"function"==typeof e.registrationStrategy)s=e.registrationStrategy();else{const[a,...h]=(e.registrationStrategy||"registerWhenStable:30000").split(":");switch(a){case"registerImmediately":s=Za(null);break;case"registerWithDelay":s=dI(+h[0]||0);break;case"registerWhenStable":s=h[0]?cl(fI(t),dI(+h[0])):fI(t);break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${e.registrationStrategy}`)}}t.get(Cn).runOutsideAngular(()=>s.pipe(Go(1)).subscribe(()=>navigator.serviceWorker.register(n,{scope:e.scope}).catch(a=>console.error("Service worker registration failed with:",a))))}}function dI(t){return Za(null).pipe(function XX(t,n=aI){const e=function ZX(t=0,n,e=qX){let i=-1;return null!=n&&(bo(n)?e=n:i=n),new F(r=>{let s=function YX(t){return t instanceof Date&&!isNaN(t)}(t)?+t-e.now():t;s<0&&(s=0);let o=0;return e.schedule(function(){r.closed||(r.next(o++),0<=i?this.schedule(void 0,i):r.complete())},s)})}(t,n);return lI(()=>e)}(t))}function fI(t){return t.get(Qm).isStable.pipe(Gl(e=>e))}function tQ(t,n){return new _g(_$(n)&&!1!==t.enabled?navigator.serviceWorker:void 0)}let nQ=(()=>{class t{static register(e,i={}){return{ngModule:t,providers:[{provide:uI,useValue:e},{provide:kv,useValue:i},{provide:_g,useFactory:tQ,deps:[kv,Cd]},{provide:Um,useFactory:eQ,deps:[Yr,uI,kv,Cd],multi:!0}]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ss({type:t}),t.\u0275inj=os({providers:[JX,cI]}),t})();class iQ{constructor(n){this.canvasElement=n}makeBrush(n,e,i){n.strokeStyle=i,n.fillStyle=n.strokeStyle,n.lineWidth=1;let r=Math.floor(e/5);return n.font=`bold ${r}px sans-serif`,n.textBaseline="top",n.textAlign="center",n}render(n,e,i=50,r=Gs.SQUARE,s="#000000e6",o=!0){this.canvasElement.width=n*i,this.canvasElement.height=e*i;let a=this.canvasElement.getContext("2d");if(r<0)return;let h=this.generateCalcGridPositionFunc(r);this.makeBrush(a,i,s);for(let w=0;w<=e;w++)for(let X=0;X<=n;X++){let{gx:fe,gy:pe}=h(X,w,i);this.strokeSquare(a,fe,pe,i),o&&a.fillText((X+1).toString()+"-"+(w+1).toString(),fe+i/2,pe+i/2)}}generateCalcGridPositionFunc(n){switch(n){case Gs.HEX_VERTICAL:return(e,i,r)=>e%2==1?{gx:e*r,gy:i*r}:{gx:e*r,gy:i*r+r/2};case Gs.HEX_HORIZONTAL:return(e,i,r)=>i%2==1?{gx:e*r,gy:i*r}:{gx:e*r+r/2,gy:i*r};default:return(e,i,r)=>({gx:e*r,gy:i*r})}}strokeSquare(n,e,i,r){n.beginPath(),n.strokeRect(e,i,r,r)}strokeHex(n,e,i,r,s){let o=s===Gs.HEX_HORIZONTAL?-30:0,a=r/Math.sqrt(3),h=e+r/2,w=i+r/2;n.beginPath();for(let X=0;X<6;X++){o+=60;let fe=Math.PI/180*o,pe=Math.cos(fe)*a+h,we=Math.sin(fe)*a+w;n.lineTo(pe,we)}n.closePath(),n.stroke()}}var ec=(()=>(function(t){t.DRAG="drag",t.ZOOM="zoom",t.ROTATE="rotate",t.KEYBOARD="keyboard"}(ec||(ec={})),ec))(),Ks=(()=>(function(t){t.ArrowLeft="ArrowLeft",t.ArrowUp="ArrowUp",t.ArrowRight="ArrowRight",t.ArrowDown="ArrowDown"}(Ks||(Ks={})),Ks))();class rQ{constructor(n){this.targetElement=n,this.currentPositionX=0,this.currentPositionY=0,this.buttonCode=0,this.input=null,this.callbackOnWheel=e=>this.onWheel(e),this.callbackOnKeydown=e=>this.onKeydown(e),this.onstart=null,this.onend=null,this.ontransform=null,this.initialize()}get isGrabbing(){return this.input.isGrabbing}get isDragging(){return this.input.isDragging}initialize(){this.input=new js(this.targetElement,{capture:!0}),this.addEventListeners(),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this)}cancel(){this.input.cancel()}destroy(){this.input.destroy(),this.removeEventListeners()}onInputStart(n){this.currentPositionX=this.input.pointer.x,this.currentPositionY=this.input.pointer.y,this.buttonCode=n.button,this.onstart&&this.onstart(n)}onInputEnd(n){this.onend&&this.onend(n)}onInputMove(n){let e=this.input.pointer.x,i=this.input.pointer.y,r=e-this.currentPositionX,s=i-this.currentPositionY,o=0,a=0,w=0,fe=0,pe=ec.DRAG;2===this.buttonCode?(pe=ec.ROTATE,fe=-r/5,w=-s/5):(o=r,a=s),this.currentPositionX=e,this.currentPositionY=i,this.ontransform&&this.ontransform(o,a,0,w,0,fe,pe,n)}onWheel(n){let e=0;switch(n.deltaMode){case WheelEvent.DOM_DELTA_LINE:e=16*n.deltaY;break;case WheelEvent.DOM_DELTA_PAGE:e=n.deltaY*window.innerHeight;break;default:e=n.deltaY}let s=0;s=-1.5*e,9e4<s**2&&(s=Math.min(Math.max(s,-300),300)),this.ontransform&&this.ontransform(0,0,s,0,0,0,ec.ZOOM,n)}onKeydown(n){let e=0,i=0,r=0,s=0,a=0,h=this.getKeyName(n);switch(h){case Ks.ArrowLeft:n.shiftKey?a=-2:e=10;break;case Ks.ArrowUp:n.shiftKey?s=-2:n.ctrlKey?r=150:i=10;break;case Ks.ArrowRight:n.shiftKey?a=2:e=-10;break;case Ks.ArrowDown:n.shiftKey?s=2:n.ctrlKey?r=-150:i=-10}null!=Ks[h]&&this.ontransform&&this.ontransform(e,i,r,s,0,a,ec.KEYBOARD,n)}getKeyName(n){if(n.key)return n.key;switch(n.keyCode){case 37:return Ks.ArrowLeft;case 38:return Ks.ArrowUp;case 39:return Ks.ArrowRight;case 40:return Ks.ArrowDown;default:return""}}addEventListeners(){this.targetElement.addEventListener("wheel",this.callbackOnWheel,!1),document.body.addEventListener("keydown",this.callbackOnKeydown,!1)}removeEventListeners(){this.targetElement.removeEventListener("wheel",this.callbackOnWheel,!1),document.body.removeEventListener("keydown",this.callbackOnKeydown,!1)}}var rl=(()=>(function(t){t.PAN="pan",t.TAP_PINCH="tappinch",t.PINCH="pinch",t.ROTATE="rotate"}(rl||(rl={})),rl))();class sQ{constructor(n,e){this.targetElement=n,this.ngZone=e,this.hammer=null,this.deltaHammerDeltaX=0,this.deltaHammerDeltaY=1,this.deltaHammerScale=1,this.deltaHammerRotation=0,this.prevHammerDeltaX=0,this.prevHammerDeltaY=0,this.prevHammerScale=0,this.prevHammerRotation=0,this.tappedPanTimer=null,this.tappedPanCenter={x:0,y:0},this.onstart=null,this.onend=null,this.ongesture=null,this.ontransform=null,this.initializeHammer()}destroy(){this.clearTappedPanTimer(),this.hammer.destroy()}initializeHammer(){this.hammer=new Hammer.Manager(this.targetElement,{inputClass:Hammer.TouchInput});let n=new Hammer.Tap,e=new Hammer.Pan({event:"pan1p",pointers:1,threshold:0}),i=new Hammer.Pan({event:"pan2p",pointers:2,threshold:0}),r=new Hammer.Pinch,s=new Hammer.Rotate;e.recognizeWith(i),e.recognizeWith(s),e.recognizeWith(r),i.recognizeWith(r),i.recognizeWith(s),r.recognizeWith(s),this.hammer.add([n,e,i,r,s]),this.hammer.on("hammer.input",this.onHammer.bind(this)),this.hammer.on("tap",this.onTap.bind(this)),this.hammer.on("pan1pstart",this.onTappedPanStart.bind(this)),this.hammer.on("pan1pmove",this.onTappedPanMove.bind(this)),this.hammer.on("pan1pend",this.onTappedPanEnd.bind(this)),this.hammer.on("pan1pcancel",this.onTappedPanEnd.bind(this)),this.hammer.on("pan2pmove",this.onPanMove.bind(this)),this.hammer.on("pinchmove",this.onPinchMove.bind(this)),this.hammer.on("rotatemove",this.onRotateMove.bind(this));let o=window.navigator.userAgent.toLowerCase();(o.indexOf("iphone")>-1||o.indexOf("ipad")>-1||o.indexOf("macintosh")>-1&&"ontouchend"in document)&&(this.hammer.add(new Hammer.Press({time:251})),this.hammer.on("press",h=>{let w=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,clientX:h.center.x,clientY:h.center.y});this.ngZone.run(()=>h.srcEvent.target.dispatchEvent(w))}))}onHammer(n){n.isFirst?(this.deltaHammerScale=n.scale,this.deltaHammerRotation=n.rotation,this.deltaHammerDeltaX=n.deltaX,this.deltaHammerDeltaY=n.deltaY,this.onstart&&this.onstart(n.srcEvent)):n.isFinal?this.onend&&this.onend(n.srcEvent):(this.deltaHammerScale=n.scale-this.prevHammerScale,this.deltaHammerRotation=n.rotation-this.prevHammerRotation,this.deltaHammerDeltaX=n.deltaX-this.prevHammerDeltaX,this.deltaHammerDeltaY=n.deltaY-this.prevHammerDeltaY),this.prevHammerScale=n.scale,this.prevHammerRotation=n.rotation,this.prevHammerDeltaX=n.deltaX,this.prevHammerDeltaY=n.deltaY,null!=this.tappedPanTimer&&n.eventType==Hammer.INPUT_START&&2500<(this.tappedPanCenter.x-n.center.x)**2+(this.tappedPanCenter.y-n.center.y)**2&&this.clearTappedPanTimer()}onTap(n){this.tappedPanCenter=n.center,this.tappedPanTimer=setTimeout(()=>{this.tappedPanTimer=null},400),this.ongesture&&this.ongesture(n.srcEvent)}onTappedPanStart(n){null!=this.tappedPanTimer&&(this.clearTappedPanTimer(!1),this.ongesture&&this.ongesture(n.srcEvent))}onTappedPanEnd(n){this.clearTappedPanTimer()}onTappedPanMove(n){if(null==this.tappedPanTimer){let e=this.deltaHammerDeltaX,i=this.deltaHammerDeltaY,r=0;this.ontransform&&this.ontransform(e,i,r,0,0,0,rl.PAN,n.srcEvent)}else{this.clearTappedPanTimer(!1);let i=7.5*this.deltaHammerDeltaY;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,i,0,0,0,rl.TAP_PINCH,n.srcEvent)}}onPanMove(n){this.clearTappedPanTimer();let e=-this.deltaHammerDeltaY/window.innerHeight*100;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,0,e,0,0,rl.ROTATE,n.srcEvent)}onPinchMove(n){this.clearTappedPanTimer();let e=500*this.deltaHammerScale;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,e,0,0,0,rl.PINCH,n.srcEvent)}onRotateMove(n){this.clearTappedPanTimer();let e=this.deltaHammerRotation;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,0,0,0,e,rl.ROTATE,n.srcEvent)}clearTappedPanTimer(n=!0){clearTimeout(this.tappedPanTimer),n&&(this.tappedPanTimer=null)}}let mg=(()=>{class t{constructor(){}createGameCharacter(e){let i=Gt.create("\u65b0\u3057\u3044\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",1,"");return i.location.x=e.x-25,i.location.y=e.y-25,i.posZ=e.z,i}createGameTableMask(e){let i=this.getViewTable();if(!i)return;let r=is.create("\u30de\u30c3\u30d7\u30de\u30b9\u30af",5,5,100);return r.location.x=e.x-25,r.location.y=e.y-25,r.posZ=e.z,i.appendChild(r),r}createTerrain(e){let i="./assets/images/tex.jpg",r=Nt.instance.get(i);r||(r=Nt.instance.add(i),wn.create(r.identifier).tag="*default \u5730\u5f62");let s=this.getViewTable();if(!s)return;let o=ur.create("\u5730\u5f62",2,2,2,r.identifier,r.identifier);return o.location.x=e.x-50,o.location.y=e.y-50,o.posZ=e.z,s.appendChild(o),o}createTextNote(e){let i=Mr.create("\u5171\u6709\u30e1\u30e2","\u30c6\u30ad\u30b9\u30c8\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044",5,4,3);return i.location.x=e.x,i.location.y=e.y,i.posZ=e.z,i}createDiceSymbol(e,i,r,s){let o=cr.create(i,r,1),a=null;return o.nothingFaces.forEach(h=>{let w=`./assets/images/dice/${s}/${s}[0].png`;a=Nt.instance.get(w),a||(a=Nt.instance.add(w),wn.create(a.identifier).tag="*default "+(r===Fi.D2?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")),o.imageDataElement.getFirstElementByName(h).value=a.identifier}),o.faces.forEach(h=>{let w=`./assets/images/dice/${s}/${s}[${h}].png`;a=Nt.instance.get(w),a||(a=Nt.instance.add(w),wn.create(a.identifier).tag="*default "+(r===Fi.D2?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")),o.imageDataElement.getFirstElementByName(h).value=a.identifier}),o.location.x=e.x-25,o.location.y=e.y-25,o.posZ=e.z,o}createBlankCard(e){const i="./assets/images/trump/blank_card.png",r="./assets/images/trump/z01.gif";let s,o;s=Nt.instance.get(i),s||(s=Nt.instance.add(i),wn.create(s.identifier).tag="*default \u30ab\u30fc\u30c9"),o=Nt.instance.get(r),o||(o=Nt.instance.add(r),wn.create(o.identifier).tag="*default \u30ab\u30fc\u30c9");let a=zn.create("\u30ab\u30fc\u30c9",s.identifier,o.identifier);return a.location.x=e.x-25,a.location.y=e.y-25,a.posZ=e.z,a}cardName(e){let i="";const r=e.slice(0,1),s=parseInt(e.substring(1,3));switch(r){case"c":i="\u30af\u30e9\u30d6";break;case"d":i="\u30c0\u30a4\u30e4";break;case"h":i="\u30cf\u30fc\u30c8";break;case"s":i="\u30b9\u30da\u30fc\u30c9";break;case"x":i="\u30b8\u30e7\u30fc\u30ab\u30fc"}return i+="x"==r?`\uff08${1==s?"\u8d64":"\u9ed2"}\uff09`:`\u306e${1==s?"\u30a8\u30fc\u30b9":s>=11?["\u30b8\u30e3\u30c3\u30af","\u30af\u30a4\u30fc\u30f3","\u30ad\u30f3\u30b0"][s-11]:s}`,i}createTrump(e){let i=Kn.create("\u30c8\u30e9\u30f3\u30d7\u5c71\u672d");i.location.x=e.x-25,i.location.y=e.y-25,i.posZ=e.z;let r="./assets/images/trump/z02.gif";if(!Nt.instance.get(r)){const a=Nt.instance.add(r);wn.create(a.identifier).tag="*default \u30ab\u30fc\u30c9"}let s=["c","d","h","s"],o=[];for(let a of s)for(let h=1;h<=13;h++)o.push(a+("00"+h).slice(-2));o.push("x01"),o.push("x02");for(let a of o){let h="./assets/images/trump/"+a+".gif";if(!Nt.instance.get(h)){const X=Nt.instance.add(h);wn.create(X.identifier).tag="*default \u30ab\u30fc\u30c9"}let w=zn.create(this.cardName(a),h,r);i.putOnBottom(w)}return i}createRangeArea(e,i){let r;switch(i){case"LINE":r=li.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u76f4\u7dda)",1,6,100);break;case"CIRCLE":r=li.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u5186)",3,3,100);break;case"SQUARE":r=li.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u6b63\u65b9\u5f62)",3,3,100);break;case"DIAMOND":r=li.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u30c0\u30a4\u30e4)",3,3,100);break;default:r=li.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u9310\u5f62)",6,6,100)}return r.location.x=e.x,r.location.y=e.y,r.posZ=e.z,r.type=i,r.commonDataElement.getFirstElementByName("opacity").currentValue=60,r}makeDefaultTable(){let e=new Vi("gameTable"),i=null,r=Ut.createEmpty("testTableBackgroundImage_image").toContext();r.url="./assets/images/BG10a_80.jpg",i=Nt.instance.add(r),wn.create(i.identifier).tag="*default \u30c6\u30fc\u30d6\u30eb",e.name="\u6700\u521d\u306e\u30c6\u30fc\u30d6\u30eb",e.imageIdentifier=i.identifier,e.width=20,e.height=15,e.initialize(),dr.instance.viewTableIdentifier=e.identifier}makeDefaultTabletopObjects(){let e=null,i=null,r=null;e=new Gt("testCharacter_1"),r=Ut.createEmpty("testCharacter_1_image").toContext(),r.url="./assets/images/mon_052.gif",i=Nt.instance.add(r),wn.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=250,e.location.y=450,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcA",1,i.identifier),e=new Gt("testCharacter_2"),e.location.x=400,e.location.y=400,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcB",1,i.identifier),e=new Gt("testCharacter_3"),r=Ut.createEmpty("testCharacter_3_image").toContext(),r.url="./assets/images/mon_128.gif",i=Nt.instance.add(r),wn.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=200,e.location.y=100,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcC",3,i.identifier),e=new Gt("testCharacter_4"),r=Ut.createEmpty("testCharacter_4_image").toContext(),r.url="./assets/images/mon_150.gif",i=Nt.instance.add(r),wn.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=300,e.location.y=550,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcA",1,i.identifier),e=new Gt("testCharacter_5"),r=Ut.createEmpty("testCharacter_5_image").toContext(),r.url="./assets/images/mon_211.gif",i=Nt.instance.add(r),wn.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=600,e.location.y=600,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcB",1,i.identifier),e=new Gt("testCharacter_6"),r=Ut.createEmpty("testCharacter_6_image").toContext(),r.url="./assets/images/mon_135.gif",i=Nt.instance.add(r),wn.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.initialize(),e.location.x=250,e.location.y=650,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcC",1,i.identifier)}makeDefaultContextMenuActions(e){return[this.getCreateCharacterMenu(e),this.getCreateTableMaskMenu(e),this.getCreateTerrainMenu(e),this.getCreateTextNoteMenu(e),this.getCreateBlankCardMenu(e),this.getCreateTrumpMenu(e),this.getCreateDiceSymbolMenu(e),this.getCreateRangeMenu(e)]}getCreateCharacterMenu(e){return{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u4f5c\u6210",action:()=>{let i=this.createGameCharacter(e);ze.trigger("SELECT_TABLETOP_OBJECT",{identifier:i.identifier,className:i.aliasName}),pt.play(tt.piecePut)}}}getCreateTableMaskMenu(e){return{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u4f5c\u6210",action:()=>{this.createGameTableMask(e),pt.play(tt.cardPut)}}}getCreateTerrainMenu(e){return{name:"\u5730\u5f62\u3092\u4f5c\u6210",action:()=>{this.createTerrain(e),pt.play(tt.blockPut)}}}getCreateTextNoteMenu(e){return{name:"\u5171\u6709\u30e1\u30e2\u3092\u4f5c\u6210",action:()=>{this.createTextNote(e),pt.play(tt.cardPut)}}}getCreateBlankCardMenu(e){return{name:"\u30d6\u30e9\u30f3\u30af\u30ab\u30fc\u30c9\u3092\u4f5c\u6210",action:()=>{this.createBlankCard(e),pt.play(tt.cardPut)}}}getCreateTrumpMenu(e){return{name:"\u30c8\u30e9\u30f3\u30d7\u306e\u5c71\u672d\u3092\u4f5c\u6210",action:()=>{this.createTrump(e),pt.play(tt.cardPut)}}}getCreateDiceSymbolMenu(e){let r=[];return[{menuName:"\u30b3\u30a4\u30f3 (\u8868/\u88cf)",diceName:"\u30b3\u30a4\u30f3",type:Fi.D2,imagePathPrefix:"2_coin"},{menuName:"D4",diceName:"D4",type:Fi.D4,imagePathPrefix:"4_dice"},{menuName:"D6",diceName:"D6",type:Fi.D6,imagePathPrefix:"6_dice"},{menuName:"D6 (Black)",diceName:"D6",type:Fi.D6,imagePathPrefix:"6_dice_black"},{menuName:"D8",diceName:"D8",type:Fi.D8,imagePathPrefix:"8_dice"},{menuName:"D10",diceName:"D10",type:Fi.D10,imagePathPrefix:"10_dice"},{menuName:"D10 (00-90)",diceName:"D10",type:Fi.D10_10TIMES,imagePathPrefix:"100_dice"},{menuName:"D12",diceName:"D12",type:Fi.D12,imagePathPrefix:"12_dice"},{menuName:"D20",diceName:"D20",type:Fi.D20,imagePathPrefix:"20_dice"}].forEach(s=>{r.push({name:s.menuName,action:()=>{this.createDiceSymbol(e,s.diceName,s.type,s.imagePathPrefix),pt.play(tt.dicePut)}})}),{name:"\u30c0\u30a4\u30b9\u3092\u4f5c\u6210",action:null,subActions:r}}getCreateRangeMenu(e){let r=[];return[{menuName:"\u9310\u5f62",typeName:"CORN"},{menuName:"\u76f4\u7dda",typeName:"LINE"},{menuName:"\u5186",typeName:"CIRCLE"},{menuName:"\u6b63\u65b9\u5f62",typeName:"SQUARE"},{menuName:"\u30c0\u30a4\u30e4\u30e2\u30f3\u30c9",typeName:"DIAMOND"}].forEach(s=>{r.push({name:s.menuName,action:()=>{this.createRangeArea(e,s.typeName),pt.play(tt.dicePut)}})}),{name:"\u5c04\u7a0b\u30fb\u7bc4\u56f2\u3092\u4f5c\u6210",action:null,subActions:r}}getViewTable(){return dr.instance.viewTable}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=rn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),sl=(()=>{class t{constructor(e,i,r,s,o,a){this.ngZone=e,this.elementRef=i,this.batchService=r,this.pointerDeviceService=s,this.coordinateService=o,this.tabletopService=a,this.layerName="",this.colideLayers=[],this.transformCssOffset="",this.isDisable=!1,this.isInteract=!0,this.onstart=new Tn,this.ondragstart=new Tn,this.ondrag=new Tn,this.ondragend=new Tn,this.onend=new Tn,this._posX=0,this._posY=0,this._posZ=0,this.pointerOffset2d={x:0,y:0,z:0},this.pointerStart3d={x:0,y:0,z:0},this.height=0,this.width=0,this.ratio=1,this.updateTimer=null,this.collidableElements=[],this.input=null}set option(e){this.tabletopObject=null!=e.tabletopObject?e.tabletopObject:this.tabletopObject,this.layerName=null!=e.layerName?e.layerName:this.layerName,this.colideLayers=null!=e.colideLayers?e.colideLayers:this.colideLayers,this.transformCssOffset=null!=e.transformCssOffset?e.transformCssOffset:this.transformCssOffset}get nativeElement(){return this.elementRef.nativeElement}get posX(){return this._posX}set posX(e){this._posX=e,this.setUpdateTimer()}get posY(){return this._posY}set posY(e){this._posY=e,this.setUpdateTimer()}get posZ(){return this._posZ}set posZ(e){this._posZ=e,this.setUpdateTimer()}get isGridSnap(){return dr.instance.gridSnap}ngAfterViewInit(){this.batchService.add(()=>this.initialize(),this.elementRef),this.setPosition(this.tabletopObject)}ngOnDestroy(){this.cancel(),this.input.destroy(),this.unregister(),ze.unregister(this),this.batchService.remove(this),this.batchService.remove(this.elementRef)}initialize(){this.input=new js(this.nativeElement),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),ze.register(this).on("UPDATE_GAME_OBJECT",e=>{e.isSendFromSelf&&this.input.isGrabbing||e.data.identifier!==this.tabletopObject.identifier||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.stopTransition(),this.setPosition(this.tabletopObject)},this)}),this.layerName.length<1&&this.tabletopObject&&(this.layerName=this.tabletopObject.aliasName),this.register(),this.findCollidableElements(),this.setPosition(this.tabletopObject)}cancel(){this.input.cancel(),this.setPointerEvents(!0),this.setAnimatedTransition(!0),this.setCollidableLayer(!1),this.tabletopService.tableSelecter.viewTable&&(this.tabletopService.tableSelecter.viewTable.gridHeight=0)}onInputStart(e){if(this.callSelectedEvent(),this.collidableElements.length<1&&this.findCollidableElements(),this.isDisable||1===e.button||2===e.button)return this.cancel();this.onstart.emit(e),this.setPointerEvents(!1),this.setAnimatedTransition(!1),this.setCollidableLayer(this.isInteract),this.width=this.nativeElement.clientWidth,this.height=this.nativeElement.clientHeight;let i={x:this.posX+this.width/2,y:this.posY+this.height/2,z:this.posZ},r=this.coordinateService.convertToGlobal(i,this.coordinateService.tabletopOriginElement);this.setPointerEvents(!0),this.pointerOffset2d.x=r.x-this.input.pointer.x,this.pointerOffset2d.y=r.y-this.input.pointer.y,this.pointerOffset2d.z=r.z-this.input.pointer.z,this.pointerStart3d.x=i.x,this.pointerStart3d.y=i.y,this.pointerStart3d.z=i.z,this.targetStartRect=this.nativeElement.getBoundingClientRect(),this.ratio=1,this.tabletopService.tableSelecter.viewTable.gridHeight=this.posZ+.5,this.setUpdateTimer()}onInputMove(e){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();e.cancelable&&e.preventDefault(),this.input.isDragging||this.setPointerEvents(!1);let i={x:this.input.pointer.x+this.pointerOffset2d.x*this.ratio,y:this.input.pointer.y+this.pointerOffset2d.y*this.ratio,z:0};i.x=Math.min(window.innerWidth-.1,Math.max(i.x,.1)),i.y=Math.min(window.innerHeight-.1,Math.max(i.y,.1));let r=document.elementFromPoint(i.x,i.y);if(null==r)return;let s=this.coordinateService.calcTabletopLocalCoordinate(i,r);if(s.x-=this.width/2,s.y-=this.height/2,this.posX===s.x&&this.posY===s.y&&this.posZ===s.z)return;this.input.isDragging||this.ondragstart.emit(e),this.ondrag.emit(e);let a=this.nativeElement.getBoundingClientRect().width/this.targetStartRect.width;a<this.ratio&&(this.ratio+=.1*(a-this.ratio)),this.posX=s.x,this.posY=s.y,this.posZ=s.z,dr.instance.viewTable.gridHeight=this.posZ+.5}onInputEnd(e){if(this.isDisable)return this.cancel();this.input.isDragging&&this.ondragend.emit(e),this.isGridSnap&&this.input.isDragging&&this.snapToGrid(),this.cancel(),this.onend.emit(e)}onContextMenu(e){if(this.isDisable)return this.cancel();e.cancelable&&e.preventDefault(),this.isGridSnap&&this.input.isDragging&&this.snapToGrid();let i=this.input.isGrabbing&&e.isTrusted;if(this.cancel(),i){e.stopPropagation();let r=new MouseEvent(e.type,e);this.ngZone.run(()=>this.nativeElement.dispatchEvent(r))}}callSelectedEvent(){this.tabletopObject&&ze.trigger("SELECT_TABLETOP_OBJECT",{identifier:this.tabletopObject.identifier,className:this.tabletopObject.aliasName})}snapToGrid(e=25){this.posX=this.calcSnapNum(this.posX,e),this.posY=this.calcSnapNum(this.posY,e)}calcSnapNum(e,i){return i<=0?e:(e=e<0?e-i/2:e+i/2)-e%i}setPosition(e){this._posX=e.location.x,this._posY=e.location.y,this._posZ=e.posZ,this.updateTransformCss()}setUpdateTimer(){null===this.updateTimer&&this.tabletopObject&&(this.updateTimer=setTimeout(()=>{this.tabletopObject.location.x=this.posX,this.tabletopObject.location.y=this.posY,this.tabletopObject.posZ=this.posZ,this.updateTimer=null},66)),this.updateTransformCss()}findCollidableElements(){this.collidableElements=[],"none"===getComputedStyle(this.nativeElement).pointerEvents?this.findNestedCollidableElements(this.nativeElement):this.collidableElements=[this.nativeElement]}findNestedCollidableElements(e){let i=e.children;for(let r=0;r<i.length;r++){let s=i[r];s instanceof HTMLElement&&"none"!==getComputedStyle(s).pointerEvents&&this.collidableElements.push(s)}if(this.collidableElements.length<1)for(let r=0;r<i.length;r++){let s=i[r];s instanceof HTMLElement&&this.findNestedCollidableElements(s)}}setPointerEvents(e){let i=e?"auto":"none";this.collidableElements.forEach(r=>r.style.pointerEvents=i)}setAnimatedTransition(e){this.nativeElement.style.transition=e?"transform 132ms linear":""}shouldTransition(e){return e.location.x!==this.posX||e.location.y!==this.posY||e.posZ!==this.posZ}stopTransition(){this.nativeElement.style.transform=window.getComputedStyle(this.nativeElement).transform}updateTransformCss(){let e=`${this.transformCssOffset} translate3d(${this.posX.toFixed(4)}px, ${this.posY.toFixed(4)}px, ${this.posZ.toFixed(4)}px)`;this.nativeElement.style.transform=e}setCollidableLayer(e){let i=e;for(let r in t.layerHash)i=-1<this.colideLayers.indexOf(r)?"character"==r?!this.input.isGrabbing||e&&!this.tabletopObject.isNotRide:!this.input.isGrabbing||e:!e,t.layerHash[r].forEach(s=>{s===this||s.input.isGrabbing||s.setPointerEvents(i)})}register(){this.layerName in t.layerHash||(t.layerHash[this.layerName]=[]),t.layerHash[this.layerName].indexOf(this)<0&&t.layerHash[this.layerName].push(this)}unregister(){if(!(this.layerName in t.layerHash))return;let e=t.layerHash[this.layerName].indexOf(this);-1<e&&t.layerHash[this.layerName].splice(e,1)}}return t.layerHash={},t.\u0275fac=function(e){return new(e||t)(He(Cn),He(yi),He(dg),He(fi),He(tl),He(vu))},t.\u0275dir=Qt({type:t,selectors:[["","appMovable",""]],inputs:{option:["movable.option","option"],isDisable:["movable.disable","isDisable"],isInteract:["movable.interact","isInteract"]},outputs:{onstart:"movable.onstart",ondragstart:"movable.ondragstart",ondrag:"movable.ondrag",ondragend:"movable.ondragend",onend:"movable.onend"}}),t})(),tc=(()=>{class t{constructor(e,i,r,s,o){this.elementRef=e,this.batchService=i,this.pointerDeviceService=r,this.coordinateService=s,this.tabletopService=o,this.transformCssOffset="",this.grabbingSelecter=".rotate-grab",this.isDisable=!1,this.polygonal=24,this.onstart=new Tn,this.ondragstart=new Tn,this.ondrag=new Tn,this.ondragend=new Tn,this.onend=new Tn,this._rotate=0,this.valueChange=new Tn,this.rotateOffset=0,this.updateTimer=null,this.grabbingElement=null,this.input=null}set option(e){this.tabletopObject=null!=e.tabletopObject?e.tabletopObject:this.tabletopObject,this.grabbingSelecter=null!=e.grabbingSelecter?e.grabbingSelecter:this.grabbingSelecter,this.transformCssOffset=null!=e.transformCssOffset?e.transformCssOffset:this.transformCssOffset}get nativeElement(){return this.elementRef.nativeElement}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.setUpdateTimer()}set value(e){this._rotate=e,this.updateTransformCss()}get isAllowedToRotate(){if(!this.grabbingElement||!this.nativeElement)return!1;if(this.grabbingSelecter.length<1)return!0;let e=this.nativeElement.querySelectorAll(this.grabbingSelecter),i=!1;for(let r=0;r<e.length;r++)if(i=e[r].contains(this.grabbingElement),i)return!0;return!1}ngAfterViewInit(){this.batchService.add(()=>this.initialize(),this.elementRef),this.tabletopObject?this.setRotate(this.tabletopObject):this.updateTransformCss()}ngOnDestroy(){this.cancel(),this.input.destroy(),ze.unregister(this),this.batchService.remove(this),this.batchService.remove(this.elementRef)}initialize(){this.input=new js(this.nativeElement),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),this.tabletopObject?(ze.register(this).on("UPDATE_GAME_OBJECT",e=>{e.isSendFromSelf&&this.input.isGrabbing||e.data.identifier!==this.tabletopObject.identifier||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.stopTransition(),this.setRotate(this.tabletopObject)},this)}),this.setRotate(this.tabletopObject)):this.updateTransformCss()}cancel(){this.input.cancel(),this.grabbingElement=null,this.setAnimatedTransition(!0),this.tabletopService.tableSelecter.viewTable&&(this.tabletopService.tableSelecter.viewTable.gridHeight=0)}onInputStart(e){if(this.grabbingElement=e.target,this.isDisable||!this.isAllowedToRotate||1===e.button||2===e.button)return this.cancel();e.stopPropagation(),this.onstart.emit(e);let i=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.nativeElement.parentElement);this.rotateOffset=this.calcRotate(i,this.rotate),this.setAnimatedTransition(!1),this.tabletopObject&&(this.tabletopService.tableSelecter.viewTable.gridHeight=this.tabletopObject.posZ+.5,this.setUpdateTimer())}onInputMove(e){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();e.cancelable&&e.preventDefault(),e.stopPropagation();let i=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.nativeElement.parentElement),r=this.calcRotate(i,this.rotateOffset);this.input.isDragging||this.ondragstart.emit(e),this.ondrag.emit(e),this.rotate=r}onInputEnd(e){if(this.isDisable)return this.cancel();e.stopPropagation(),this.input.isDragging&&this.ondragend.emit(e),this.cancel(),this.snapToPolygonal(this.polygonal),this.onend.emit(e)}onContextMenu(e){if(this.isDisable)return this.cancel();e.cancelable&&e.preventDefault(),this.cancel(),this.snapToPolygonal(this.polygonal)}calcRotate(e,i){return(180*Math.atan2(e.y-this.nativeElement.clientHeight/2,e.x-this.nativeElement.clientWidth/2)/Math.PI-i)%360}snapToPolygonal(e=24){e<=1||(this.rotate=this.rotate<0?this.rotate-180/e:this.rotate+180/e,this.rotate-=this.rotate%(360/e))}setUpdateTimer(){null===this.updateTimer&&(this.updateTimer=setTimeout(()=>{this.valueChange.emit(this.rotate),this.tabletopObject&&(this.tabletopObject.rotate=this.rotate),this.updateTimer=null},66)),this.updateTransformCss()}setRotate(e){e&&(this._rotate=e.rotate),this.updateTransformCss()}setAnimatedTransition(e){this.nativeElement.style.transition=e?"transform 132ms linear":""}shouldTransition(e){return e.rotate!==this.rotate}stopTransition(){this.nativeElement.style.transform=window.getComputedStyle(this.nativeElement).transform}updateTransformCss(){let e=`${this.transformCssOffset} rotateZ(${this.rotate.toFixed(4)}deg)`;this.nativeElement.style.transform=e}}return t.\u0275fac=function(e){return new(e||t)(He(yi),He(dg),He(fi),He(tl),He(vu))},t.\u0275dir=Qt({type:t,selectors:[["","appRotable",""]],inputs:{option:["rotable.option","option"],isDisable:["rotable.disable","isDisable"],polygonal:["rotable.polygonal","polygonal"],value:["rotable.value","value"]},outputs:{onstart:"rotable.onstart",ondragstart:"rotable.ondragstart",ondrag:"rotable.ondrag",ondragend:"rotable.ondragend",onend:"rotable.onend",valueChange:"rotable.valueChange"}}),t})();const hI=function(t){return{"blinking-animation":t}};function oQ(t,n){if(1&t&&(Q(0,"div",6),Et(1,"safe"),ie()),2&t){const e=_e(2);Qe("background-image",Tt(1,3,"url("+e.floorImage.url+")","style")),re("ngClass",ft(6,hI,!e.isLocked))}}function aQ(t,n){if(1&t&&(Ke(0),Te(1,oQ,2,8,"div",5),Ye()),2&t){const e=_e();U(1),re("ngIf",e.isDropShadow&&(0!=e.terreinAltitude||e.isSlope&&!e.hasWall))}}const lQ=function(t,n,e){return{"backface-visibility":t,transform:n,filter:e}};function cQ(t,n){if(1&t&&(Ke(0),Q(1,"div",7),Et(2,"safe"),ie(),Ye()),2&t){const e=_e();U(1),Qe("background-image",Tt(2,4,"url("+e.floorImage.url+")","style")),re("ngClass",ft(7,hI,!e.isLocked))("ngStyle",Zr(9,lQ,e.isSlope?"visible":"hidden","translateZ("+e.height/(e.isSlope?2:1)*e.gridSize+"px)"+e.floorModCss,"brightness("+e.floorBrightness+")"))}}const $g=function(t,n,e,i){return{"blinking-animation":t,"no-shadow":n,"is-slope":e,"is-inverse-slope":i}};function uQ(t,n){if(1&t&&(Q(0,"div",9),Et(1,"safe"),ie()),2&t){const e=_e(3);Qe("background-image",Tt(1,7,"url("+e.wallImage.url+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),re("ngClass",co(10,$g,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.LEFT,e.slopeDirection==e.slopeDirectionState.RIGHT))}}function dQ(t,n){if(1&t&&(Ke(0),Te(1,uQ,2,15,"div",8),Ye()),2&t){const e=_e(2);U(1),re("ngIf",e.isVisibleWallTopBottom)}}function fQ(t,n){if(1&t&&(Q(0,"div",11),Et(1,"safe"),ie()),2&t){const e=_e(3);Qe("background-image",Tt(1,7,"url("+e.wallImage.url+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),re("ngClass",co(10,$g,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.LEFT,e.slopeDirection==e.slopeDirectionState.RIGHT))}}function hQ(t,n){if(1&t&&(Ke(0),Te(1,fQ,2,15,"div",10),Ye()),2&t){const e=_e(2);U(1),re("ngIf",e.isVisibleWallTopBottom)}}function pQ(t,n){if(1&t&&(Q(0,"div",13),Et(1,"safe"),ie()),2&t){const e=_e(3);Qe("background-image",Tt(1,7,"url("+e.wallImage.url+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),re("ngClass",co(10,$g,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.BOTTOM,e.slopeDirection==e.slopeDirectionState.TOP))}}function gQ(t,n){if(1&t&&(Ke(0),Te(1,pQ,2,15,"div",12),Ye()),2&t){const e=_e(2);U(1),re("ngIf",e.isVisibleWallLeftRight)}}function _Q(t,n){if(1&t&&(Q(0,"div",15),Et(1,"safe"),ie()),2&t){const e=_e(3);Qe("background-image",Tt(1,7,"url("+e.wallImage.url+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),re("ngClass",co(10,$g,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.BOTTOM,e.slopeDirection==e.slopeDirectionState.TOP))}}function mQ(t,n){if(1&t&&(Ke(0),Te(1,_Q,2,15,"div",14),Ye()),2&t){const e=_e(2);U(1),re("ngIf",e.isVisibleWallLeftRight)}}function $Q(t,n){if(1&t&&(Ke(0),Te(1,dQ,2,1,"ng-container",2),Te(2,hQ,2,1,"ng-container",2),Te(3,gQ,2,1,"ng-container",2),Te(4,mQ,2,1,"ng-container",2),Ye()),2&t){const e=_e();U(1),re("ngIf",e.slopeDirection!=e.slopeDirectionState.TOP),U(1),re("ngIf",e.slopeDirection!=e.slopeDirectionState.BOTTOM),U(1),re("ngIf",e.slopeDirection!=e.slopeDirectionState.LEFT),U(1),re("ngIf",e.slopeDirection!=e.slopeDirectionState.RIGHT)}}function vQ(t,n){if(1&t&&(Ke(0),Q(1,"div",16),ot(2,"div",17),Q(3,"div",18)(4,"i",19),ye(5,"autorenew"),ie()(),Q(6,"div",20)(7,"i",19),ye(8,"autorenew"),ie()(),Q(9,"div",21)(10,"i",19),ye(11,"autorenew"),ie()(),Q(12,"div",22)(13,"i",19),ye(14,"autorenew"),ie()()(),Ye()),2&t){const e=_e();U(1),Qe("opacity",e.isInteract?"1.0":"0.5")("height",e.depth*e.gridSize,"px")}}const pI=function(t){return{transform:t}};function bQ(t,n){if(1&t&&(Q(0,"div",23)(1,"div",24),ye(2),ie(),Q(3,"div",25),ye(4),ie()()),2&t){const e=_e();Qe("height",e.math.abs(e.terreinAltitude*e.gridSize),"px"),re("ngStyle",ft(5,pI,"translateX("+e.width*e.gridSize/2+"px) translateY("+-e.depth*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.terreinAltitude>0?-(e.altitude+(e.isSlope||e.isWallExist?0:e.height))*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),U(2),Xe(e.math.abs(e.terreinAltitude)),U(2),Xe(e.math.abs(e.terreinAltitude))}}const yQ=function(t){return{"is-grab":t}},CQ=function(t,n){return{"upright-transform":t,fall:n}};let xQ=(()=>{class t{constructor(e,i,r,s,o,a,h,w,X,fe){this.ngZone=e,this.imageService=i,this.tabletopActionService=r,this.contextMenuService=s,this.elementRef=o,this.panelService=a,this.changeDetector=h,this.pointerDeviceService=w,this.modalService=X,this.coordinateService=fe,this.terrain=null,this.is3D=!1,this.gridSize=50,this.movableOption={},this.rotableOption={},this.math=Math,this.slopeDirectionState=ci,this.input=null,this.viewRotateZ=10}get name(){return this.terrain.name}get mode(){return this.terrain.mode}set mode(e){this.terrain.mode=e}get isLocked(){return this.terrain.isLocked}set isLocked(e){this.terrain.isLocked=e}get hasWall(){return this.terrain.hasWall}get hasFloor(){return this.terrain.hasFloor}get wallImage(){return this.imageService.getSkeletonOr(this.terrain.wallImage)}get floorImage(){return this.imageService.getSkeletonOr(this.terrain.floorImage)}get height(){return this.adjustMinBounds(this.terrain.height)}get width(){return this.adjustMinBounds(this.terrain.width)}get depth(){return this.adjustMinBounds(this.terrain.depth)}get altitude(){return this.terrain.altitude}set altitude(e){this.terrain.altitude=e}get isDropShadow(){return this.terrain.isDropShadow}set isDropShadow(e){this.terrain.isDropShadow=e}get isSurfaceShading(){return this.terrain.isSurfaceShading}set isSurfaceShading(e){this.terrain.isSurfaceShading=e}get isInteract(){return this.terrain.isInteract}set isInteract(e){this.terrain.isInteract=e}get isSlope(){return this.terrain.isSlope}set isSlope(e){this.terrain.isSlope=e,e||(this.terrain.slopeDirection=ci.NONE)}get slopeDirection(){return this.terrain.isSlope?this.terrain.isSlope&&this.terrain.slopeDirection===ci.NONE?ci.BOTTOM:this.terrain.slopeDirection:ci.NONE}set slopeDirection(e){this.terrain.isSlope=e!=ci.NONE,this.terrain.slopeDirection=e}get isAltitudeIndicate(){return this.terrain.isAltitudeIndicate}set isAltitudeIndicate(e){this.terrain.isAltitudeIndicate=e}get isVisibleFloor(){return 0<this.width*this.depth}get isVisibleWallTopBottom(){return 0<this.width*this.height}get isVisibleWallLeftRight(){return 0<this.depth*this.height}get isWallExist(){return this.hasWall&&this.wallImage&&this.wallImage.url&&this.wallImage.url.length>0}get terreinAltitude(){let e=this.altitude;return(this.altitude<0||!this.isSlope&&!this.isWallExist)&&(e+=this.height),e}ngOnInit(){ze.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=dt.instance.get(e.data.identifier);!this.terrain||!i||(this.terrain===i||i instanceof Vn&&this.terrain.contains(i))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.terrain,colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.terrain}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new js(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this.input.destroy(),ze.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLocked&&ze.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate();this.contextMenuService.open(i,[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,pt.play(tt.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,pt.play(tt.lock)}},kt,{name:"\u50be\u659c",action:null,subActions:[{name:(this.slopeDirection==ci.NONE?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{this.slopeDirection=ci.NONE}},kt,{name:(this.slopeDirection==ci.TOP?"\u25c9":"\u25cb")+" \u4e0a\uff08\u5317\uff09",action:()=>{this.slopeDirection=ci.TOP}},{name:(this.slopeDirection==ci.BOTTOM?"\u25c9":"\u25cb")+" \u4e0b\uff08\u5357\uff09",action:()=>{this.slopeDirection=ci.BOTTOM}},{name:(this.slopeDirection==ci.LEFT?"\u25c9":"\u25cb")+" \u5de6\uff08\u897f\uff09",action:()=>{this.slopeDirection=ci.LEFT}},{name:(this.slopeDirection==ci.RIGHT?"\u25c9":"\u25cb")+" \u53f3\uff08\u6771\uff09",action:()=>{this.slopeDirection=ci.RIGHT}}]},{name:"\u58c1\u306e\u8868\u793a",action:null,subActions:[{name:(this.hasWall&&this.isSurfaceShading?"\u25c9":"\u25cb")+" \u901a\u5e38",action:()=>{this.mode=_a.ALL,this.isSurfaceShading=!0}},{name:(this.hasWall&&!this.isSurfaceShading?"\u25c9":"\u25cb")+" \u9670\u5f71\u306a\u3057",action:()=>{this.mode=_a.ALL,this.isSurfaceShading=!1}},{name:(this.hasWall?"\u25cb":"\u25c9")+" \u975e\u8868\u793a",action:()=>{this.mode=_a.FLOOR,this.depth*this.width==0&&(this.terrain.width=this.width<=0?1:this.width,this.terrain.depth=this.depth<=0?1:this.depth)}}]},kt,this.isDropShadow?{name:"\u2611 \u5f71\u3092\u843d\u3068\u3059",action:()=>{this.isDropShadow=!1}}:{name:"\u2610 \u5f71\u3092\u843d\u3068\u3059",action:()=>{this.isDropShadow=!0}},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0}},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,pt.play(tt.sweep))},altitudeHande:this.terrain},kt,{name:"\u5730\u5f62\u8a2d\u5b9a\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.terrain)}},this.terrain.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.terrain.getUrls().map(s=>{const o=s.value.toString();return{name:s.name?s.name:o,action:()=>{rt.sameOrigin(o)?window.open(o.trim(),"_blank","noopener"):this.modalService.open(qr,{url:o,title:this.terrain.name,subTitle:s.name})},disabled:!rt.validUrl(o),error:rt.validUrl(o)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:rt.validUrl(o)&&!rt.sameOrigin(o)}})},this.terrain.getUrls().length<=0?null:kt,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let s=this.terrain.clone();s.location.x+=this.gridSize,s.location.y+=this.gridSize,s.isLocked=!1,this.terrain.parent&&this.terrain.parent.appendChild(s),pt.play(tt.blockPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.terrain.destroy(),pt.play(tt.sweep)}},kt,{name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(r)}],this.name)}onMove(){pt.play(tt.blockPick)}onMoved(){pt.play(tt.blockPut)}get floorModCss(){let e="",i=0;switch(this.slopeDirection){case ci.TOP:i=Math.atan(this.height/this.depth),e=" rotateX("+i+"rad) scaleY("+1/Math.cos(i)+")";break;case ci.BOTTOM:i=Math.atan(this.height/this.depth),e=" rotateX("+-i+"rad) scaleY("+1/Math.cos(i)+")";break;case ci.LEFT:i=Math.atan(this.height/this.width),e=" rotateY("+-i+"rad) scaleX("+1/Math.cos(i)+")";break;case ci.RIGHT:i=Math.atan(this.height/this.width),e=" rotateY("+i+"rad) scaleX("+1/Math.cos(i)+")"}return e}get floorBrightness(){let e=1;if(!this.isSurfaceShading)return e;switch(this.slopeDirection){case ci.TOP:e=.4;break;case ci.BOTTOM:e=1;break;case ci.LEFT:e=.6;break;case ci.RIGHT:e=.9}return e}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){ze.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5730\u5f62\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Ws,{title:r,left:i.x-250,top:i.y-150,width:550,height:380}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(He(Cn),He(wu),He(mg),He(lr),He(yi),He(An),He(Oi),He(fi),He(Fn),He(tl))},t.\u0275cmp=Xt({type:t,selectors:[["terrain"]],hostBindings:function(e,i){1&e&&Ae("dragstart",function(s){return i.onDragstart(s)})("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{terrain:"terrain",is3D:"is3D"},decls:8,vars:24,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.option","movable.disable","movable.interact","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"ngClass","rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],[4,"ngIf"],[1,"is-3d","texture",2,"z-index","1",3,"ngClass","ngStyle"],["class","is-3d","style","display:flex; align-items: center; border-left: 2px dashed blanchedalmond; position: absolute; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],["style","opacity: 0.7; filter: brightness(0) blur(1px); transform: translateZ(0.3px) scale(0.98); backface-visibility: visible","class","is-3d texture chrome-smooth-image-trick",3,"ngClass","background-image",4,"ngIf"],[1,"is-3d","texture","chrome-smooth-image-trick",2,"opacity","0.7","filter","brightness(0) blur(1px)","transform","translateZ(0.3px) scale(0.98)","backface-visibility","visible",3,"ngClass"],[1,"is-3d","texture","chrome-smooth-image-trick",3,"ngClass","ngStyle"],["class","is-3d texture of-wall-top chrome-smooth-image-trick","style","transform: translateY(-100%) rotateX(90deg) rotateZ(180deg) scaleX(-1.0)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-top","chrome-smooth-image-trick",2,"transform","translateY(-100%) rotateX(90deg) rotateZ(180deg) scaleX(-1.0)",3,"ngClass"],["class","is-3d texture of-wall-bottom chrome-smooth-image-trick","style","transform: rotateX(-90deg)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-bottom","chrome-smooth-image-trick",2,"transform","rotateX(-90deg)",3,"ngClass"],["class","is-3d texture of-wall-left chrome-smooth-image-trick","style","transform: rotateZ(90deg) rotateX(-90deg) scaleX(-1.0) translateX(-100%) translateY(-100%)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-left","chrome-smooth-image-trick",2,"transform","rotateZ(90deg) rotateX(-90deg) scaleX(-1.0) translateX(-100%) translateY(-100%)",3,"ngClass"],["class","is-3d texture of-wall-right chrome-smooth-image-trick","style","transform: rotateZ(-90deg) rotateX(-90deg) translateY(-100%)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-right","chrome-smooth-image-trick",2,"transform","rotateZ(-90deg) rotateX(-90deg) translateY(-100%)",3,"ngClass"],[1,"is-3d",2,"z-index","0"],[1,"pedestal-grab","rotate-grab","is-3d"],[1,"rotate-grab","of-left-top","rotate-grab-icon","is-3d"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","rotate-grab-icon","is-3d"],[1,"rotate-grab","of-right-bottom","rotate-grab-icon","is-3d"],[1,"rotate-grab","of-right-top","rotate-grab-icon","is-3d"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","position","absolute","transform-origin","top left",3,"ngStyle"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"]],template:function(e,i){1&e&&(Q(0,"div",0),Ae("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),Q(1,"div",1),Ae("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Te(2,aQ,2,1,"ng-container",2),Q(3,"div",3),Te(4,cQ,3,13,"ng-container",2),Te(5,$Q,5,4,"ng-container",2),ie(),Te(6,vQ,15,4,"ng-container",2),ie(),Te(7,bQ,5,7,"div",4),ie()),2&e&&(Qe("width",i.width*i.gridSize,"px")("height",i.depth*i.gridSize,"px"),re("movable.option",i.movableOption)("movable.disable",i.isLocked)("movable.interact",i.isInteract),U(1),re("ngClass",ft(17,yQ,!i.isLocked))("rotable.option",i.rotableOption)("rotable.disable",i.isLocked),U(1),re("ngIf",i.hasFloor&&i.isVisibleFloor&&0<(null==i.floorImage?null:i.floorImage.url.length)),U(1),re("ngClass",Yt(19,CQ,i.height<.5&&0==i.altitude,i.height>=.5&&0==i.altitude))("ngStyle",ft(22,pI,"translateZ("+i.altitude*i.gridSize+"px)")),U(1),re("ngIf",i.hasFloor&&i.isVisibleFloor&&0<(null==i.floorImage?null:i.floorImage.url.length)),U(1),re("ngIf",i.isWallExist),U(1),re("ngIf",!i.isLocked),U(1),re("ngIf",i.isAltitudeIndicate&&!((i.isSlope||i.isWallExist)&&-i.height<i.altitude&&i.altitude<0)&&(i.terreinAltitude<=-.5||.5<=i.terreinAltitude)))},directives:[sl,tc,Yn,bn,Ji],pipes:[ai],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{height:100%;width:100%}.texture[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;background-repeat:no-repeat;background-size:100% 100%;height:100%;width:100%}.of-wall-top[_ngcontent-%COMP%]{top:0;left:0;transform-origin:50% 100%;transform:translateY(-100%) rotateX(90deg) rotate(180deg) scaleX(-1);filter:brightness(.3)}.of-wall-bottom[_ngcontent-%COMP%]{bottom:0;left:0;transform-origin:50% 100%;transform:rotateX(-90deg)}.of-wall-left[_ngcontent-%COMP%]{top:0;left:0;transform-origin:0% 0%;transform:rotate(90deg) rotateX(-90deg) scaleX(-1) translate(-100%) translateY(-100%);filter:brightness(.5)}.of-wall-right[_ngcontent-%COMP%]{top:0;right:0;transform-origin:100% 0%;transform:rotate(-90deg) rotateX(-90deg) translateY(-100%);filter:brightness(.8)}.of-wall-top.is-slope[_ngcontent-%COMP%], .of-wall-bottom.is-slope[_ngcontent-%COMP%], .of-wall-left.is-slope[_ngcontent-%COMP%], .of-wall-right.is-slope[_ngcontent-%COMP%]{-webkit-clip-path:polygon(100% 0%,0% 100%,100% 100%);clip-path:polygon(100% 0%,0% 100%,100% 100%)}.of-wall-top.is-inverse-slope[_ngcontent-%COMP%], .of-wall-bottom.is-inverse-slope[_ngcontent-%COMP%], .of-wall-left.is-inverse-slope[_ngcontent-%COMP%], .of-wall-right.is-inverse-slope[_ngcontent-%COMP%]{-webkit-clip-path:polygon(0% 0%,100% 100%,0% 100%);clip-path:polygon(0% 0%,100% 100%,0% 100%)}.of-wall-top.no-shadow[_ngcontent-%COMP%], .of-wall-left.no-shadow[_ngcontent-%COMP%], .of-wall-right.no-shadow[_ngcontent-%COMP%]{filter:brightness(1)}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;position:absolute;inset:-14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.rotate-grab[_ngcontent-%COMP%]{opacity:0;z-index:-1}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;border:solid 2px #CCCCCC;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:0;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;transform-style:preserve-3d;transform:translateZ(.1px)}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px;border-radius:14px 7px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px;border-radius:7px 14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px;border-radius:14px 7px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px;border-radius:7px 14px}.blinking-animation[_ngcontent-%COMP%]{animation:blink 1s linear infinite alternate}@keyframes blink{0%{opacity:.9}to{opacity:.5}}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.upright-transform[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.fall[_ngcontent-%COMP%]{transition:transform 132ms cubic-bezier(.21,.97,.75,1.25)}"],changeDetection:0}),t})();const wQ=["draggablePanel"],EQ=["cardImage"],TQ=["fullCardImage"],SQ=["textArea"];function IQ(t,n){1&t&&_n(0)}function kQ(t,n){1&t&&_n(0)}const gI=function(t){return{card:t}};function MQ(t,n){if(1&t&&(Ke(0),Te(1,kQ,1,0,"ng-container",14),Ye()),2&t){const e=_e(),i=Kt(13);U(1),re("ngTemplateOutlet",i)("ngTemplateOutletContext",ft(2,gI,e.tabletopObject))}}function DQ(t,n){1&t&&_n(0)}function AQ(t,n){if(1&t&&(Ke(0),Te(1,DQ,1,0,"ng-container",14),Ye()),2&t){const e=_e(),i=Kt(13);U(1),re("ngTemplateOutlet",i)("ngTemplateOutletContext",ft(2,gI,e.tabletopObject))}}function PQ(t,n){1&t&&_n(0)}const NQ=function(t){return{note:t}};function FQ(t,n){if(1&t&&(Ke(0),Te(1,PQ,1,0,"ng-container",14),Ye()),2&t){const e=_e(),i=Kt(15);U(1),re("ngTemplateOutlet",i)("ngTemplateOutletContext",ft(2,NQ,e.tabletopObject))}}function OQ(t,n){1&t&&_n(0)}const RQ=function(t){return{character:t}};function BQ(t,n){if(1&t&&(Ke(0),Te(1,OQ,1,0,"ng-container",14),Ye()),2&t){const e=_e(),i=Kt(17);U(1),re("ngTemplateOutlet",i)("ngTemplateOutletContext",ft(2,RQ,e.tabletopObject))}}function LQ(t,n){1&t&&_n(0)}const zQ=function(t){return{dice:t}};function jQ(t,n){if(1&t&&(Ke(0),Te(1,LQ,1,0,"ng-container",14),Ye()),2&t){const e=_e(),i=Kt(19);U(1),re("ngTemplateOutlet",i)("ngTemplateOutletContext",ft(2,zQ,e.tabletopObject))}}function HQ(t,n){1&t&&_n(0)}const UQ=function(t){return{range:t}};function VQ(t,n){if(1&t&&(Ke(0),Te(1,HQ,1,0,"ng-container",14),Ye()),2&t){const e=_e(),i=Kt(21);U(1),re("ngTemplateOutlet",i)("ngTemplateOutletContext",ft(2,UQ,e.tabletopObject))}}function GQ(t,n){1&t&&_n(0)}const qQ=function(t){return{object:t}};function WQ(t,n){if(1&t&&(Ke(0),Te(1,GQ,1,0,"ng-container",14),Ye()),2&t){const e=_e(),i=Kt(23);U(1),re("ngTemplateOutlet",i)("ngTemplateOutletContext",ft(2,qQ,e.tabletopObject))}}function KQ(t,n){1&t&&_n(0)}function YQ(t,n){if(1&t&&(Ke(0),Te(1,KQ,1,0,"ng-container",15),Ye()),2&t){_e();const e=Kt(27);U(1),re("ngTemplateOutlet",e)}}const _I=function(t){return{transform:t}};function ZQ(t,n){if(1&t&&(Q(0,"div",28),ot(1,"div",29),Et(2,"safe"),ie()),2&t){const e=_e(3);Qe("width",e.imageAreaRect.width,"px")("height",e.imageAreaRect.height,"px")("left",e.imageAreaRect.left,"px"),re("ngStyle",ft(17,_I,"scale("+e.imageAreaRect.scale+")")),U(1),Qe("font-size",e.cardFontSize,"px")("color",e.cardColor)("text-shadow",e.cardTextShadowCss),re("innerHTML",Tt(2,14,e.cardText,"html"),Yi)}}const mI=function(t){return{"with-button-marign":t}};function XQ(t,n){if(1&t&&(Q(0,"div",30)(1,"div",31),ye(2),ie()()),2&t){const e=_e(2).card,i=_e();re("ngClass",ft(4,mI,i.hasImage)),U(1),Qe("background-color",e.ownerColor),U(1),Xe(e.ownerName)}}function QQ(t,n){if(1&t){const e=it();Q(0,"div",21),Te(1,ZQ,3,19,"div",22),Q(2,"img",23,24),Ae("load",function(){return Oe(e),_e(2).onCardImageLoad()}),Et(4,"safe"),ie(),Q(5,"button",25),Ae("click",function(){return Oe(e),_e(2).chanageImageView(!0)}),Q(6,"i",26),ye(7,"zoom_in"),ie()(),Te(8,XQ,3,6,"div",27),ie()}if(2&t){const e=_e().card,i=_e();U(1),re("ngIf","card"==e.aliasName&&(e.isFront||e.isHand||e.isGMMode)||"card-stack"==e.aliasName&&e.topCard.isFront),U(1),re("src",Tt(4,3,i.imageUrl,"resourceUrl"),en),U(6),re("ngIf",e.ownerIsOnline&&0<e.ownerName.length)}}function JQ(t,n){if(1&t&&(Ke(0),ye(1),Ye()),2&t){const e=_e().card;U(1),Xe(e.name)}}function eJ(t,n){1&t&&(Ke(0),ye(1," \u306e\u30c8\u30c3\u30d7"),Ye())}function tJ(t,n){1&t&&(Ke(0),ye(1,"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09"),Ye())}function nJ(t,n){1&t&&_n(0)}const Eu=function(t,n){return{dataElm:t,name:n}};function iJ(t,n){if(1&t&&(Ke(0),Te(1,nJ,1,0,"ng-container",14),Ye()),2&t){const e=n.$implicit,i=_e(2).card;_e();const r=Kt(25);U(1),re("ngTemplateOutlet",r)("ngTemplateOutletContext",Yt(2,Eu,e,i.name))}}function rJ(t,n){if(1&t&&(Q(0,"div",32)(1,"div",33),Te(2,iJ,2,5,"ng-container",34),ie()()),2&t){const e=_e(2);U(2),re("ngForOf",e.dataElms)}}const Pr=function(t,n){return{"is-pointer-events-auto":t,"pointer-events-none":n}};function sJ(t,n){if(1&t&&(Q(0,"div",16),Te(1,QQ,9,6,"div",17),Q(2,"div",18),Te(3,JQ,2,1,"ng-container",5),Te(4,eJ,2,0,"ng-container",5),Te(5,tJ,2,0,"ng-container",5),ie(),Q(6,"div",19),Te(7,rJ,3,1,"div",20),ie()()),2&t){const e=n.card,i=_e();re("ngClass",Yt(7,Pr,!i.isPointerDragging,i.isPointerDragging)),U(1),re("ngIf",i.hasImage),U(1),re("ngClass",ft(10,mI,i.hasImage)),U(1),re("ngIf",null==e.isVisible||e.isVisible||e.isGMMode),U(1),re("ngIf","card-stack"==e.aliasName&&!e.isEmpty),U(1),re("ngIf",null!=e.isVisible&&!e.isVisible&&!e.isGMMode),U(2),re("ngIf",i.hasDataElms&&(e.isVisible||e.isGMMode))}}const oJ=function(t){return{"hide-text-area":t}},aJ=function(t){return{"hide-area":t}};function lJ(t,n){if(1&t){const e=it();Q(0,"div",35)(1,"div",36),ye(2),ie(),Q(3,"div",37)(4,"div",38),Ae("mousedown",function(){return Oe(e),_e().textAreaActivate()}),Q(5,"div",39)(6,"textarea",40,41),Ae("ngModelChange",function(r){return Oe(e).note.text=r}),ie()(),ot(8,"div",42),Et(9,"safe"),ot(10,"div",43),Et(11,"safe"),ie()()()}if(2&t){const e=n.note,i=_e();re("ngClass",Yt(13,Pr,!i.isPointerDragging,i.isPointerDragging)),U(2),Xe(e.title),U(4),re("ngModel",e.text)("ngClass",ft(16,oJ,!i.isSelected)),U(2),re("innerHTML",Tt(9,7,i.adjustedRubiedNote(e.text),"html"),Yi)("ngClass",ft(18,aJ,i.isSelected)),U(2),re("innerHTML",Tt(11,10,i.adjustedRubiedNote(e.text,!i.isSelected),"html"),Yi)}}const cJ=function(t){return{transform:t}},$I=function(t,n){return{inverse:t,hollow:n}},vI=function(t,n,e,i,r,s,o,a){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:s,yellow:o,white:a}},bI=function(t){return{"black-paint":t}};function uJ(t,n){if(1&t&&(Ke(0),Q(1,"div",51)(2,"div",52)(3,"span",53),ot(4,"img",54),Et(5,"safe"),ie()()(),Ye()),2&t){const e=_e(3);U(1),re("ngStyle",ft(8,cJ,"rotate("+e.roll+"deg)")),U(1),re("ngClass",Yt(10,$I,e.isInverse,e.isHollow)),U(1),re("ngClass",uo(13,vI,0==e.aura,1==e.aura,2==e.aura,3==e.aura,4==e.aura,5==e.aura,6==e.aura,7==e.aura)),U(1),re("ngClass",ft(22,bI,e.isBlackPaint))("src",Tt(5,5,e.imageUrl,"resourceUrl"),en)}}function dJ(t,n){if(1&t&&(Ke(0),ot(1,"img",55),Et(2,"safe"),Ye()),2&t){const e=_e(3);U(1),re("src",Tt(2,1,e.imageUrl,"resourceUrl"),en)}}const fJ=function(t,n,e){return{"has-icon":t,"is-pointer-events-auto":n,"pointer-events-none":e}};function hJ(t,n){if(1&t&&(Q(0,"div",50),Te(1,uJ,6,24,"ng-container",5),Te(2,dJ,3,4,"ng-container",5),ie()),2&t){const e=_e(2);re("ngClass",Zr(3,fJ,e.isUseIcon,!e.isPointerDragging,e.isPointerDragging)),U(1),re("ngIf",!e.isUseIcon),U(1),re("ngIf",e.isUseIcon)}}function pJ(t,n){1&t&&_n(0)}function gJ(t,n){if(1&t&&(Ke(0),Q(1,"div",33),Te(2,pJ,1,0,"ng-container",14),ie(),Ye()),2&t){const e=_e().$implicit,i=_e(2).character;_e();const r=Kt(25);U(2),re("ngTemplateOutlet",r)("ngTemplateOutletContext",Yt(2,Eu,e,i.name))}}function _J(t,n){if(1&t&&(Ke(0),Te(1,gJ,3,5,"ng-container",5),Ye()),2&t){const e=n.$implicit,i=_e(3);U(1),re("ngIf",e&&e.name!==i.newLineString)}}function mJ(t,n){if(1&t&&(Q(0,"div",32),Te(1,_J,2,1,"ng-container",34),ie()),2&t){const e=_e(2);U(1),re("ngForOf",e.inventoryDataElms)}}function $J(t,n){if(1&t&&(Q(0,"div",44),ot(1,"div",45),Te(2,hJ,3,7,"div",46),Q(3,"div",47),ye(4),ie(),ot(5,"div",48),Q(6,"div",49),Te(7,mJ,2,1,"div",20),ie()()),2&t){const e=n.character,i=_e();U(1),re("ngClass",Yt(6,Pr,!i.isPointerDragging,i.isPointerDragging)),U(1),re("ngIf",i.hasImage),U(1),re("ngClass",Yt(9,Pr,!i.isPointerDragging,i.isPointerDragging)),U(1),Xe(e.name),U(2),re("ngClass",Yt(12,Pr,!i.isPointerDragging,i.isPointerDragging)),U(1),re("ngIf",i.hasDataElms)}}function vJ(t,n){if(1&t&&(Ke(0),ye(1),Ye()),2&t){const e=_e().dice;U(1),Rn("",e.name,":")}}function bJ(t,n){if(1&t&&(Ke(0),ye(1),Ye()),2&t){const e=_e().dice;U(1),Xe(e.face)}}function yJ(t,n){1&t&&(Ke(0),ye(1,"???"),Ye())}function CJ(t,n){if(1&t&&(Q(0,"div",57)(1,"div",31),ye(2),ie()()),2&t){const e=_e().dice,i=_e();re("ngClass",Yt(4,Pr,!i.isPointerDragging,i.isPointerDragging)),U(1),Qe("background-color",e.ownerColor),U(1),Rn("",e.ownerName," ")}}const xJ=function(t,n){return{"is-black-mask":t,"is-harf-black-mask":n}};function wJ(t,n){if(1&t&&(Q(0,"div",50),ot(1,"img",58),Et(2,"safe"),ie()),2&t){const e=_e().dice,i=_e();re("ngClass",Yt(6,Pr,!i.isPointerDragging,i.isPointerDragging)),U(1),re("ngClass",Yt(9,xJ,!e.isVisible,e.isMine||e.isGMMode&&e.hasOwner))("src",Tt(2,3,i.imageUrl,"resourceUrl"),en)}}function EJ(t,n){1&t&&_n(0)}function TJ(t,n){if(1&t&&(Ke(0),Te(1,EJ,1,0,"ng-container",14),Ye()),2&t){const e=_e().$implicit,i=_e(2).dice;_e();const r=Kt(25);U(1),re("ngTemplateOutlet",r)("ngTemplateOutletContext",Yt(2,Eu,e,i.name))}}function SJ(t,n){if(1&t&&(Ke(0),Te(1,TJ,2,5,"ng-container",5),Ye()),2&t){const e=n.$implicit,i=_e(3);U(1),re("ngIf",e&&e.name!==i.newLineString)}}function IJ(t,n){if(1&t&&(Q(0,"div",32)(1,"div",33),Te(2,SJ,2,1,"ng-container",34),ie()()),2&t){const e=_e(2);U(2),re("ngForOf",e.dataElms)}}function kJ(t,n){if(1&t&&(Q(0,"div",44),ot(1,"div",45),Q(2,"div",47),Te(3,vJ,2,1,"ng-container",5),Te(4,bJ,2,1,"ng-container",5),Te(5,yJ,2,0,"ng-container",5),ie(),Te(6,CJ,3,7,"div",56),Te(7,wJ,3,12,"div",46),ot(8,"div",48),Q(9,"div",49),Te(10,IJ,3,1,"div",20),ie()()),2&t){const e=n.dice,i=_e();U(1),re("ngClass",Yt(9,Pr,!i.isPointerDragging,i.isPointerDragging)),U(1),re("ngClass",Yt(12,Pr,!i.isPointerDragging,i.isPointerDragging)),U(1),re("ngIf",0<(null==e||null==e.name?null:e.name.length)),U(1),re("ngIf",e.isVisible),U(1),re("ngIf",!e.isVisible),U(1),re("ngIf",e.hasOwner&&0<e.ownerName.length),U(1),re("ngIf",i.hasImage),U(2),re("ngClass",Yt(15,Pr,!i.isPointerDragging,i.isPointerDragging)),U(1),re("ngIf",i.hasDataElms&&e.isVisible)}}function MJ(t,n){if(1&t){const e=it();Ke(0),Q(1,"div",60),ye(2),ie(),Q(3,"div",61)(4,"div",62)(5,"div",63),ye(6),ie(),Q(7,"input",64),Ae("ngModelChange",function(r){return Oe(e),_e().$implicit.value=r}),ie()()(),Q(8,"div",65)(9,"input",66),Ae("ngModelChange",function(r){return Oe(e),_e().$implicit.value=r}),Et(10,"safe"),ie()(),Ye()}if(2&t){const e=_e().$implicit;U(1),Bt("title",e.name),U(1),Xe(e.name),U(4),Xe(e.value),U(1),re("ngModel",e.value),U(2),hr(Tt(10,9,"font-size: 0.8em; width: 100%; --min: 0; --max:"+e.value+"; --val:"+e.currentValue+";","style")),ht("title",e.value),re("min","length"==e.name?1:0)("ngModel",e.value)}}function DJ(t,n){if(1&t){const e=it();Ke(0),Q(1,"div",60),ye(2),ie(),Q(3,"div",61)(4,"div",62)(5,"div",63),ye(6),ie(),Q(7,"input",67),Ae("ngModelChange",function(r){return Oe(e),_e().$implicit.currentValue=r}),ie(),Q(8,"b",68),ye(9,"%"),ie()()(),Q(10,"div",65)(11,"input",69),Ae("ngModelChange",function(r){return Oe(e),_e().$implicit.currentValue=r}),Et(12,"safe"),ie()(),Ye()}if(2&t){const e=_e().$implicit;U(1),Bt("title",e.name),U(1),Xe(e.name),U(4),Xe(e.currentValue),U(1),re("ngModel",e.currentValue),U(4),hr(Tt(12,8,"font-size: 0.8em; width: 100%; --min: 0; --max:"+e.value+"; --val:"+e.currentValue+";","style")),Zi("title","",e.currentValue,"%"),re("ngModel",e.currentValue)}}function AJ(t,n){if(1&t&&(Ke(0),Te(1,MJ,11,12,"ng-container",5),Te(2,DJ,13,11,"ng-container",5),Ye()),2&t){const e=n.$implicit;U(1),re("ngIf","length"==e.name||"width"==e.name),U(1),re("ngIf","opacity"==e.name)}}function PJ(t,n){if(1&t&&(Ke(0),Q(1,"div",70),ye(2),ie(),Q(3,"div",71)(4,"div",72)(5,"span",73),ot(6,"img",74),Et(7,"safe"),ie()()(),Ye()),2&t){const e=_e(2).range;U(2),Rn("\u27a1 ",e.followingCharactor.name,""),U(2),re("ngClass",Yt(8,$I,e.followingCharactor.isInverse,e.followingCharactor.isHollow)),U(1),re("ngClass",uo(11,vI,0==e.followingCharactor.aura,1==e.followingCharactor.aura,2==e.followingCharactor.aura,3==e.followingCharactor.aura,4==e.followingCharactor.aura,5==e.followingCharactor.aura,6==e.followingCharactor.aura,7==e.followingCharactor.aura)),U(1),re("ngClass",ft(20,bI,e.followingCharactor.isBlackPaint))("src",Tt(7,5,e.followingCharactor.imageFile.url,"resourceUrl"),en)}}function NJ(t,n){1&t&&ot(0,"div",75)}function FJ(t,n){1&t&&_n(0)}function OJ(t,n){if(1&t&&(Ke(0),Te(1,FJ,1,0,"ng-container",14),Ye()),2&t){const e=_e().$implicit,i=_e(2).range;_e();const r=Kt(25);U(1),re("ngTemplateOutlet",r)("ngTemplateOutletContext",Yt(2,Eu,e,i.name))}}function RJ(t,n){if(1&t&&(Ke(0),Te(1,OJ,2,5,"ng-container",5),Ye()),2&t){const e=n.$implicit,i=_e(3);U(1),re("ngIf",e&&e.name!==i.newLineString)}}function BJ(t,n){if(1&t&&(Q(0,"div",32)(1,"div",33),Te(2,AJ,3,2,"ng-container",34),Te(3,PJ,8,22,"ng-container",5),Te(4,NJ,1,0,"div",59),Te(5,RJ,2,1,"ng-container",34),ie()()),2&t){const e=_e().range,i=_e();U(2),re("ngForOf",i.rangeElms),U(1),re("ngIf",e.followingCharactor),U(1),re("ngIf",i.dataElms.length>0),U(1),re("ngForOf",i.dataElms)}}function LJ(t,n){if(1&t&&(Q(0,"div",44),ot(1,"div",45),Q(2,"div",47),ye(3),ie(),ot(4,"div",48),Q(5,"div",49),Te(6,BJ,6,4,"div",20),ie()()),2&t){const e=n.range,i=_e();U(1),re("ngClass",Yt(5,Pr,!i.isPointerDragging,i.isPointerDragging)),U(1),re("ngClass",Yt(8,Pr,!i.isPointerDragging,i.isPointerDragging)),U(1),Xe(e.name),U(2),re("ngClass",Yt(11,Pr,!i.isPointerDragging,i.isPointerDragging)),U(1),re("ngIf",i.rangeElms.length>0)}}function zJ(t,n){1&t&&_n(0)}function jJ(t,n){if(1&t&&(Ke(0),Te(1,zJ,1,0,"ng-container",14),Ye()),2&t){const e=_e().$implicit,i=_e().object;_e();const r=Kt(25);U(1),re("ngTemplateOutlet",r)("ngTemplateOutletContext",Yt(2,Eu,e,i.name))}}function HJ(t,n){if(1&t&&(Ke(0),Te(1,jJ,2,5,"ng-container",5),Ye()),2&t){const e=n.$implicit,i=_e(2);U(1),re("ngIf",e&&e.name!==i.newLineString)}}function UJ(t,n){if(1&t&&(Q(0,"div",44),ot(1,"div",45),Q(2,"div",47),ye(3),ie(),ot(4,"div",48),Q(5,"div",49)(6,"div",32)(7,"div",33),Te(8,HJ,2,1,"ng-container",34),ie()()()()),2&t){const e=n.object,i=_e();U(1),re("ngClass",Yt(5,Pr,!i.isPointerDragging,i.isPointerDragging)),U(1),re("ngClass",Yt(8,Pr,!i.isPointerDragging,i.isPointerDragging)),U(1),Xe(e.name),U(2),re("ngClass",Yt(11,Pr,!i.isPointerDragging,i.isPointerDragging)),U(3),re("ngForOf",i.dataElms)}}function VJ(t,n){1&t&&_n(0)}function GJ(t,n){if(1&t&&(Q(0,"div",82),ye(1),ie()),2&t){const e=_e(2).dataElm;Bt("title",e.name),U(1),Xe(e.name)}}function qJ(t,n){1&t&&_n(0)}function WJ(t,n){if(1&t&&(Ke(0),Te(1,qJ,1,0,"ng-container",14),Ye()),2&t){const e=n.$implicit,i=_e(2).name;_e();const r=Kt(25);U(1),re("ngTemplateOutlet",r)("ngTemplateOutletContext",Yt(2,Eu,e,i))}}function KJ(t,n){if(1&t&&(Q(0,"div",79),Te(1,GJ,2,2,"div",80),Q(2,"div",81),Te(3,WJ,2,5,"ng-container",34),ie()()),2&t){const e=_e().dataElm;U(1),re("ngIf",0<e.name.trim().length),U(2),re("ngForOf",e.children)}}function YJ(t,n){if(1&t){const e=it();Ke(0),Q(1,"div",84)(2,"div"),ye(3),ie(),Q(4,"div",85)(5,"div",39)(6,"textarea",86),Ae("ngModelChange",function(r){return Oe(e),_e(2).dataElm.value=r}),ie()(),Q(7,"div",87),ye(8),ie()()(),Ye()}if(2&t){const e=_e(2).dataElm;U(2),Bt("title",e.name),U(1),Xe(e.name),U(3),re("ngModel",e.value),U(2),Xe(e.value)}}function ZJ(t,n){if(1&t){const e=it();Ke(0),Q(1,"div",70),ye(2),ie(),Q(3,"div",61)(4,"div",88),ye(5),ie(),Q(6,"input",89),Ae("ngModelChange",function(r){return Oe(e),_e(2).dataElm.value=r}),ie()(),Ye()}if(2&t){const e=_e(2),i=e.dataElm,r=e.name,s=_e();U(1),Bt("title",i.name),U(1),Xe(i.name),U(3),Xe(i.value),U(1),ht("type",i.value&&i.value==+i.value?"number":"text"),re("logging.name",r)("logging.dataElement",i)("logging.disable",s.isNoLogging)("ngModel",i.value)}}function XJ(t,n){if(1&t){const e=it();Ke(0),Q(1,"div",60),ye(2),ie(),Q(3,"div",61)(4,"div",62)(5,"div",63),ye(6),ie(),Q(7,"input",90),Ae("ngModelChange",function(r){return Oe(e),_e(2).dataElm.currentValue=r}),ie()(),Q(8,"div",91),ye(9),ie()(),Q(10,"div",65)(11,"input",92),Ae("ngModelChange",function(r){return Oe(e),_e(2).dataElm.currentValue=r}),Et(12,"safe"),ie()(),Ye()}if(2&t){const e=_e(2),i=e.dataElm,r=e.name,s=_e();U(1),Bt("title",i.name),U(1),Xe(i.name),U(4),Xe(i.currentValue),U(1),re("logging.name",r)("logging.dataElement",i)("logging.disable",s.isNoLogging)("ngModel",i.currentValue),U(2),Rn(" / ",+i.value?i.value:"???",""),U(2),hr(Tt(12,16,"font-size: 0.8em; width: 100%; --min: 0; --max:"+i.value+"; --val:"+i.currentValue+";","style")),ht("title",i.currentValue),ht("max",+i.value?i.value:1e3),re("logging.name",r)("logging.dataElement",i)("logging.disable",s.isNoLogging)("ngModel",i.currentValue)}}function QJ(t,n){if(1&t){const e=it();Ke(0),Q(1,"div",70)(2,"span"),ye(3),ie(),ye(4),ie(),Q(5,"div",61)(6,"input",93),Ae("ngModelChange",function(r){return Oe(e),_e(2).dataElm.value=r})("change",function(){Oe(e);const r=_e(2).dataElm;return r.value=r.value?r.name:""}),ie()(),Ye()}if(2&t){const e=_e(2),i=e.dataElm,r=e.name,s=_e();U(1),Bt("title",i.name),U(1),Qe("text-decoration",i.value?"none":"line-through"),U(1),Xe(i.name),U(1),Rn(" ",i.currentValue.toString().split(s.checkRegExp)[i.value?0:1],""),U(2),ht("checked",i.value?"checked":""),re("logging.name",r)("logging.dataElement",i)("logging.disable",s.isNoLogging)("ngModel",i.value)}}function JJ(t,n){if(1&t&&(Q(0,"span",95),ye(1),ie()),2&t){const e=_e(3).dataElm;U(1),Rn("(",(e.calcAbilityScore()>=0?"+":"")+e.calcAbilityScore(),")")}}function eee(t,n){if(1&t){const e=it();Ke(0),Q(1,"div",70),ye(2),ie(),Q(3,"div",61)(4,"div",88),ye(5),ie(),Q(6,"input",89),Ae("ngModelChange",function(r){return Oe(e),_e(2).dataElm.value=r}),ie(),Te(7,JJ,2,1,"span",94),ie(),Ye()}if(2&t){const e=_e(2),i=e.dataElm,r=e.name,s=_e();U(1),Bt("title",i.name),U(1),Xe(i.name),U(3),Xe(i.value),U(1),ht("type",i.value&&i.value==+i.value?"number":"text"),re("logging.name",r)("logging.dataElement",i)("logging.disable",s.isNoLogging)("ngModel",i.value),U(1),re("ngIf",i.currentValue)}}function tee(t,n){if(1&t){const e=it();Ke(0),Q(1,"div",70),ye(2),ie(),Q(3,"div",61)(4,"div",88),ye(5),ie(),Q(6,"input",96),Ae("ngModelChange",function(r){return Oe(e),_e(2).dataElm.value=r}),ie(),Q(7,"button",97),Ae("click",function(){Oe(e);const r=_e(2),s=r.dataElm,o=r.name,a=_e();return!!a.stringUtil.validUrl(s.value)&&a.openUrl(s.value,o,s.name)}),Q(8,"i",98),ye(9),ie()()(),Ye()}if(2&t){const e=_e(2).dataElm,i=_e();U(1),Bt("title",e.name),U(1),Xe(e.name),U(3),Xe(e.value),U(1),re("ngModel",e.value),U(1),Bt("disabled",i.stringUtil.validUrl(e.value)?null:""),U(2),Xe(i.stringUtil.validUrl(e.value)?i.stringUtil.sameOrigin(e.value)?"link":"open_in_new":"link_off")}}function nee(t,n){if(1&t&&(Q(0,"div",70),ye(1),ie()),2&t){const e=_e(3).dataElm;Bt("title",e.name),U(1),Xe(e.name)}}function iee(t,n){if(1&t&&(Q(0,"div",88),ye(1),ie()),2&t){const e=_e(3).dataElm;U(1),Xe(e.value)}}const ree=function(t){return{"min-width":t}};function see(t,n){if(1&t){const e=it();Ke(0),Te(1,nee,2,2,"div",99),Q(2,"div",61),Te(3,iee,2,1,"div",100),Q(4,"input",101),Ae("ngModelChange",function(r){return Oe(e),_e(2).dataElm.value=r}),ie()(),Ye()}if(2&t){const e=_e(2).dataElm;U(1),re("ngIf",e.name),U(2),re("ngIf",e.name),U(1),ht("type","size"===e.name||"altitude"===e.name?"number":"text"),ht("min","size"===e.name?"0":""),re("ngStyle",ft(6,ree,e.name?"8em":"100%"))("ngModel",e.value)}}function oee(t,n){1&t&&(Ke(0,2),Te(1,YJ,9,4,"ng-container",3),Te(2,ZJ,7,8,"ng-container",3),Te(3,XJ,13,19,"ng-container",3),Te(4,QJ,7,10,"ng-container",3),Te(5,eee,8,9,"ng-container",3),Te(6,tee,10,6,"ng-container",3),Te(7,see,5,8,"ng-container",4),Ye(),ot(8,"div",83)),2&t&&(re("ngSwitch",_e().dataElm.type),U(1),re("ngSwitchCase","note"),U(1),re("ngSwitchCase","simpleNumber"),U(1),re("ngSwitchCase","numberResource"),U(1),re("ngSwitchCase","checkProperty"),U(1),re("ngSwitchCase","abilityScore"),U(1),re("ngSwitchCase","url"))}function aee(t,n){if(1&t&&(Te(0,VJ,1,0,"ng-container",76),Te(1,KJ,4,2,"ng-template",null,77,Un),Te(3,oee,9,7,"ng-template",null,78,Un)),2&t){const e=n.dataElm,i=Kt(2),r=Kt(4);re("ngIf",0<e.children.length)("ngIfThen",i)("ngIfElse",r)}}function lee(t,n){if(1&t&&(Q(0,"div",107),ot(1,"div",29),Et(2,"safe"),ie()),2&t){const e=_e(2);Qe("width",e.fullImageAreaRect.width,"px")("height",e.fullImageAreaRect.height,"px")("left",e.fullImageAreaRect.left,"px")("top",e.fullImageAreaRect.top,"px"),re("ngStyle",ft(19,_I,"scale("+e.fullImageAreaRect.scale+")")),U(1),Qe("font-size",e.cardFontSize,"px")("color",e.cardColor)("text-shadow",e.cardTextShadowCss),re("innerHTML",Tt(2,16,e.cardText,"html"),Yi)}}function cee(t,n){if(1&t){const e=it();Q(0,"div",102),Ae("click",function(){return Oe(e),_e().chanageImageView(!1)}),Te(1,lee,3,21,"div",103),Q(2,"div",104)(3,"i",26),ye(4,"close"),ie()(),ot(5,"img",105,106),Et(7,"safe"),ie()}if(2&t){const e=_e();re("@fadeInOut","in"),U(1),re("ngIf","card"==e.tabletopObject.aliasName&&(e.tabletopObject.isFront||e.tabletopObject.isHand||e.tabletopObject.isGMMode)||"card-stack"==e.tabletopObject.aliasName&&e.tabletopObject.topCard.isFront),U(4),re("src",Tt(7,3,e.imageUrl,"resourceUrl"),en)}}let uee=(()=>{class t{constructor(e,i,r,s){this.inventoryService=e,this.changeDetector=i,this.pointerDeviceService=r,this.modalService=s,this.tabletopObject=null,this.left=0,this.top=0,this.gridSize=50,this.naturalWidth=0,this.naturalHeight=0,this.stringUtil=rt,this._imageFile=Ut.Empty,this.isOpenImageView=!1,this.checkRegExp=/[|\uff5c]/g}get imageUrl(){if(!this.tabletopObject)return"";if(this.isUseIcon)return this.tabletopObject.faceIcon.url;if(this.tabletopObject instanceof Gt&&this.tabletopObject.standList&&this.tabletopObject.standList.overviewIndex>-1){const e=this.tabletopObject.standList.standElements[this.tabletopObject.standList.overviewIndex];if(!e)return"";try{const i=e.getFirstElementByName("imageIdentifier");if(!i)return"";if(this._imageFile.identifier!=i.value){const r=Nt.instance.get(i.value);this._imageFile=r||Ut.Empty}}catch(i){console.log(i)}return this._imageFile.url}return this.tabletopObject instanceof zn&&this.tabletopObject.isGMMode?this.tabletopObject.frontImage?this.tabletopObject.frontImage.url:"":this.tabletopObject.imageFile?this.tabletopObject.imageFile.url:""}get hasImage(){return 0<this.imageUrl.length}get isUseIcon(){return this.tabletopObject instanceof Gt&&this.tabletopObject.isUseIconToOverviewImage&&this.tabletopObject.faceIcon&&0<this.tabletopObject.faceIcon.url.length}get roll(){if(this.tabletopObject instanceof Gt){if(this.tabletopObject.standList&&this.tabletopObject.standList.overviewIndex>-1){const e=this.tabletopObject.standList.standElements[this.tabletopObject.standList.overviewIndex];if(!e)return 0;try{const i=e.getFirstElementByName("applyRoll");return i&&i.value?this.tabletopObject.roll:0}catch(i){console.log(i)}}return this.tabletopObject.roll}return 0}get applyImageEffect(){if(this.tabletopObject instanceof Gt){if(this.tabletopObject.standList&&this.tabletopObject.standList.overviewIndex>-1){const e=this.tabletopObject.standList.standElements[this.tabletopObject.standList.overviewIndex];if(!e)return!1;try{const i=e.getFirstElementByName("applyImageEffect");return!(!i||!i.value)}catch(i){console.log(i)}}return!0}return!1}get isInverse(){return!!(this.tabletopObject instanceof Gt&&this.applyImageEffect)&&this.tabletopObject.isInverse}get isHollow(){return!!(this.tabletopObject instanceof Gt&&this.applyImageEffect)&&this.tabletopObject.isHollow}get isBlackPaint(){return!!(this.tabletopObject instanceof Gt&&this.applyImageEffect)&&this.tabletopObject.isBlackPaint}get aura(){return this.tabletopObject instanceof Gt&&this.applyImageEffect?this.tabletopObject.aura:-1}get inventoryDataElms(){return this.tabletopObject?this.getInventoryTags(this.tabletopObject):[]}get dataElms(){return this.tabletopObject&&this.tabletopObject.detailDataElement?this.tabletopObject.detailDataElement.children:[]}get hasDataElms(){return 0<this.dataElms.length}get newLineString(){return this.inventoryService.newLineString}get isPointerDragging(){return this.pointerDeviceService.isDragging}get pointerEventsStyle(){return{"is-pointer-events-auto":!this.isPointerDragging,"pointer-events-none":this.isPointerDragging}}ngAfterViewInit(){this.initPanelPosition(),setTimeout(()=>{this.adjustPositionRoot()},16),ze.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=dt.instance.get(e.data.identifier);!this.tabletopObject||!i||!(i instanceof Vn)||(this.tabletopObject===i||this.tabletopObject.contains(i))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()})}ngOnDestroy(){ze.unregister(this)}initPanelPosition(){let e=this.draggablePanel.nativeElement,i=e.offsetWidth,s=this.left+100,o=this.top-e.offsetHeight-50,a=!1;window.innerWidth<s+i&&(s=window.innerWidth-i,a=!0),o<=0&&(o=0),a&&(s=this.left-i-100),s<0&&(s=0),o<0&&(o=0),e.style.left=s+"px",e.style.top=o+"px"}adjustPositionRoot(){let e=this.draggablePanel.nativeElement,i=e.getBoundingClientRect(),r=0,s=0;window.innerWidth<i.right+r&&(r+=window.innerWidth-(i.right+r)),i.left+r<0&&(r+=0-(i.left+r)),window.innerHeight<i.bottom+s&&(s+=window.innerHeight-(i.bottom+s)),i.top+s<0&&(s+=0-(i.top+s)),e.style.left=e.offsetLeft+r+"px",e.style.top=e.offsetTop+s+"px"}chanageImageView(e){this.isOpenImageView=e}openUrl(e,i=null,r=null){rt.sameOrigin(e)?window.open(e.trim(),"_blank","noopener"):this.modalService.open(qr,{url:e,title:i,subTitle:r})}getInventoryTags(e){return this.inventoryService.tableInventory.dataElementMap.get(e.identifier)}onCardImageLoad(){!this.cardImageElement||(this.naturalWidth=this.cardImageElement.nativeElement.naturalWidth,this.naturalHeight=this.cardImageElement.nativeElement.naturalHeight)}onFullCardImageLoad(){!this.cardImageElement||(this.naturalWidth=this.cardImageElement.nativeElement.naturalWidth,this.naturalHeight=this.cardImageElement.nativeElement.naturalHeight)}get imageAreaRect(){return this.calcImageAreaRect(250,330,8)}get fullImageAreaRect(){return this.calcImageAreaRect(document.documentElement.clientWidth,document.documentElement.offsetHeight,16)}calcImageAreaRect(e,i,r){const s={width:0,height:0,top:r,left:r,scale:1};if(0==this.naturalWidth||0==this.naturalHeight)return s;const o=e-2*r,a=i-2*r;this.naturalHeight*o/this.naturalWidth>a?(s.width=this.naturalWidth*a/this.naturalHeight,s.height=a,s.left=r+(o-s.width)/2):(s.width=o,s.height=this.naturalHeight*o/this.naturalWidth,s.top=r+(a-s.height)/2);let h=null;return this.tabletopObject instanceof Kn?h=this.tabletopObject.topCard:this.tabletopObject instanceof zn&&(h=this.tabletopObject),h&&(s.scale=s.width/(h.size*this.gridSize),s.width=h.size*this.gridSize,s.height=s.width*this.naturalHeight/this.naturalWidth),s}get cardColor(){let e=null;return this.tabletopObject instanceof Kn?e=this.tabletopObject.topCard:this.tabletopObject instanceof zn&&(e=this.tabletopObject),e?e.color:"#555555"}get cardFontSize(){let e=null;return this.tabletopObject instanceof Kn?e=this.tabletopObject.topCard:this.tabletopObject instanceof zn&&(e=this.tabletopObject),e?e.fontsize+9:18}get cardText(){let e=null;return this.tabletopObject instanceof Kn?e=this.tabletopObject.topCard:this.tabletopObject instanceof zn&&(e=this.tabletopObject),e?rt.rubyToHtml(rt.escapeHtml(e.text)):""}get cardTextShadowCss(){const e=rt.textShadowColor(this.cardColor);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}get rangeElms(){let e=[];return!this.tabletopObject||!(this.tabletopObject instanceof li)||!this.tabletopObject.commonDataElement||(this.tabletopObject.commonDataElement.getFirstElementByName("length")&&e.push(this.tabletopObject.commonDataElement.getFirstElementByName("length")),("CORN"===this.tabletopObject.type||"LINE"===this.tabletopObject.type)&&this.tabletopObject.commonDataElement.getFirstElementByName("width")&&e.push(this.tabletopObject.commonDataElement.getFirstElementByName("width")),this.tabletopObject.commonDataElement.getFirstElementByName("opacity")&&e.push(this.tabletopObject.commonDataElement.getFirstElementByName("opacity"))),e}get isNoLogging(){return this.tabletopObject instanceof zn?!this.tabletopObject.isFront:this.tabletopObject instanceof cr&&this.tabletopObject.hasOwner}get isSelected(){return this.textAreaElementRef&&document.activeElement===this.textAreaElementRef.nativeElement}adjustedRubiedNote(e,i=!0){if(!e)return"";let r=rt.escapeHtml(e);return i&&(r=rt.rubyToHtml(r)),r.lastIndexOf("\n")==r.length-1?r+"\n":r}textAreaActivate(){this.textAreaElementRef&&this.textAreaElementRef.nativeElement&&this.textAreaElementRef.nativeElement.focus()}}return t.\u0275fac=function(e){return new(e||t)(He(Tv),He(Oi),He(fi),He(Fn))},t.\u0275cmp=Xt({type:t,selectors:[["overview-panel"]],viewQuery:function(e,i){if(1&e&&(cn(wQ,7),cn(EQ,5),cn(TQ,5),cn(SQ,5)),2&e){let r;ln(r=un())&&(i.draggablePanel=r.first),ln(r=un())&&(i.cardImageElement=r.first),ln(r=un())&&(i.fullCardImageElement=r.first),ln(r=un())&&(i.textAreaElementRef=r.first)}},inputs:{tabletopObject:"tabletopObject",left:"left",top:"top"},decls:28,vars:10,consts:[["appDraggable","",1,"component","is-pointer-events-none"],["draggablePanel",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngIf"],["overviewCard",""],["overviewNote",""],["overviewCharacter",""],["overviewDiceSymbol",""],["overviewRange",""],["overviewTabletop",""],["dataElement",""],["imageView",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngTemplateOutlet"],[1,"component-content","is-small-size",3,"ngClass"],["style","position: relative;",4,"ngIf"],[1,"component-title","title-background",3,"ngClass"],[1,"component-background"],["class","grid-container-root",4,"ngIf"],[2,"position","relative"],["class","text","style","z-index: 5; top: 8px",3,"width","height","left","ngStyle",4,"ngIf"],["draggable","false",1,"card-image",3,"src","load"],["cardImage",""],[1,"zoom-button",2,"z-index","10",3,"click"],[1,"material-icons"],["class","component-owner position-right-bottom","style","z-index: 10",3,"ngClass",4,"ngIf"],[1,"text",2,"z-index","5","top","8px",3,"ngStyle"],[3,"innerHTML"],[1,"component-owner","position-right-bottom",2,"z-index","10",3,"ngClass"],[1,"owner-tag"],[1,"grid-container-root"],[1,"grid-container"],[4,"ngFor","ngForOf"],[1,"component-content","is-large-size",3,"ngClass"],[1,"component-title","title-background"],[1,"component-background","text-note-container"],[2,"position","relative",3,"mousedown"],[1,"is-fill"],["spellcheck","false",1,"textarea",2,"resize","none",3,"ngModel","ngClass","ngModelChange"],["textArea",""],[1,"note-text",2,"pointer-events","none","position","absolute",3,"innerHTML","ngClass"],[1,"textarea-spacer",2,"pointer-events","none",3,"innerHTML"],[1,"component-content","character-grid-container","is-middle-size"],[1,"title-bg-area","title-background",3,"ngClass"],["class","image-area character-image-box",3,"ngClass",4,"ngIf"],[1,"title-area","component-title",3,"ngClass"],[1,"void-area","is-pointer-events-none"],[1,"dataElm-area","component-background",3,"ngClass"],[1,"image-area","character-image-box",3,"ngClass"],[3,"ngStyle"],[1,"inverser",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"character-image",2,"pointer-events","none",3,"ngClass","src"],[1,"character-image",2,"pointer-events","none",3,"src"],["class","owner-name-area component-owner",3,"ngClass",4,"ngIf"],[1,"owner-name-area","component-owner",3,"ngClass"],["draggable","false",1,"character-image",3,"ngClass","src"],["class","section border","style","padding-top: 2px",4,"ngIf"],[1,"tag",2,"min-width","100px"],[1,"value"],[2,"display","inline-block","width","min-content"],[1,"hidden-spacer",2,"margin-right","2em"],["type","number","step","0.1","size","1",1,"input",2,"width","4em",3,"ngModel","ngModelChange"],[1,"section",2,"line-height","1em"],["type","range","max","12","step","0.5",3,"title","min","ngModel","ngModelChange"],["type","number","size","1",1,"input",2,"width","4em",3,"ngModel","ngModelChange"],[1,"move",2,"font-size","small"],["type","range","min","0","max","100",3,"title","ngModel","ngModelChange"],[1,"tag"],[1,"value",2,"margin-top","3px","pointer-events","none"],[1,"inverser",2,"min-width","32px","min-height","32px","max-width","32px","max-height","32px","margin-left","auto","margin-right","0px",3,"ngClass"],[1,"aura-following",3,"ngClass"],["draggable","false",1,"character-image",2,"pointer-events","none",3,"ngClass","src"],[1,"section","border",2,"padding-top","2px"],[4,"ngIf","ngIfThen","ngIfElse"],["thenBlock",""],["elseBlock",""],[1,"section",2,"padding-top","0.5em"],["class","section-text",4,"ngIf"],[1,"grid-container","indetnt"],[1,"section-text"],[1,"section","border"],[1,"section"],[1,"note",2,"position","relative"],["spellcheck","false",1,"textarea",3,"ngModel","ngModelChange"],[1,"textarea-spacer"],[1,"hidden-spacer"],["appLogging","","size","1",1,"input",2,"width","4em",3,"logging.name","logging.dataElement","logging.disable","type","ngModel","ngModelChange"],["appLogging","","type","number","size","1",1,"input",2,"width","4em",3,"logging.name","logging.dataElement","logging.disable","ngModel","ngModelChange"],[2,"display","inline"],["appLogging","","type","range","min","0",3,"logging.name","logging.dataElement","logging.disable","title","max","ngModel","ngModelChange"],["appLogging","","type","checkbox",2,"width","2em","margin-right","1em",3,"logging.name","logging.dataElement","logging.disable","ngModel","checked","ngModelChange","change"],["style","font-size: smaller;",4,"ngIf"],[2,"font-size","smaller"],["type","url","size","1",1,"input",2,"width","calc(8em - 1.6rem)",3,"ngModel","ngModelChange"],[1,"link",2,"width","1.6rem",3,"click"],[1,"material-icons",2,"font-size","1.0rem"],["class","tag",4,"ngIf"],["class","hidden-spacer",4,"ngIf"],["size","1",1,"input",3,"ngStyle","type","min","ngModel","ngModelChange"],[1,"image-view-background","is-fill",3,"click"],["class","text","style","z-index: 5",3,"width","height","left","top","ngStyle",4,"ngIf"],[1,"close-button","is-pointer-events-none",2,"z-index","10"],["draggable","false",1,"contain-image",3,"src"],["fullCardImage",""],[1,"text",2,"z-index","5",3,"ngStyle"]],template:function(e,i){1&e&&(Q(0,"div",0,1),Ke(2,2),Te(3,IQ,1,0,"ng-container",3),Te(4,MQ,2,4,"ng-container",3),Te(5,AQ,2,4,"ng-container",3),Te(6,FQ,2,4,"ng-container",3),Te(7,BQ,2,4,"ng-container",3),Te(8,jQ,2,4,"ng-container",3),Te(9,VQ,2,4,"ng-container",3),Te(10,WQ,2,4,"ng-container",4),Ye(),ie(),Te(11,YQ,2,1,"ng-container",5),Te(12,sJ,8,12,"ng-template",null,6,Un),Te(14,lJ,12,20,"ng-template",null,7,Un),Te(16,$J,8,15,"ng-template",null,8,Un),Te(18,kJ,11,18,"ng-template",null,9,Un),Te(20,LJ,7,14,"ng-template",null,10,Un),Te(22,UJ,9,14,"ng-template",null,11,Un),Te(24,aee,5,3,"ng-template",null,12,Un),Te(26,cee,8,6,"ng-template",null,13,Un)),2&e&&(re("@fadeInOut","in"),U(2),re("ngSwitch",i.tabletopObject.aliasName),U(1),re("ngSwitchCase","numberResource"),U(1),re("ngSwitchCase","card"),U(1),re("ngSwitchCase","card-stack"),U(1),re("ngSwitchCase","text-note"),U(1),re("ngSwitchCase","character"),U(1),re("ngSwitchCase","dice-symbol"),U(1),re("ngSwitchCase","range"),U(2),re("ngIf",i.isOpenImageView))},directives:[X0,Tl,Sd,Sl,Id,bn,Yn,Ji,oi,mi,$i,di,ps,gs,qs,Jr],pipes:[ai],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;max-height:100%;max-width:100%;box-sizing:border-box;overflow:visible;color:#444;z-index:9000;overscroll-behavior:contain;-webkit-overflow-scrolling:touch;cursor:grab}.component-content[_ngcontent-%COMP%]{font-size:12px}.is-large-size[_ngcontent-%COMP%]{max-width:350px}.is-middle-size[_ngcontent-%COMP%]{max-width:270px}.is-small-size[_ngcontent-%COMP%]{max-width:250px}.is-middle-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:270px}.is-small-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:250px}.component-background[_ngcontent-%COMP%]{background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border-bottom:solid 1px #999}.component-title[_ngcontent-%COMP%]{color:#ccc;font-size:1em;text-align:right;vertical-align:middle;height:32px;line-height:32px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 1em}.title-background[_ngcontent-%COMP%]{background-color:#555;border-top:solid 1px #999;border-left:solid 1px #999;border-right:solid 1px #999}.component-owner[_ngcontent-%COMP%]{font-size:.8em;color:#ccc;vertical-align:middle;overflow:hidden;text-align:right;padding:2px 1em;max-width:100%;box-sizing:border-box}.owner-tag[_ngcontent-%COMP%]{width:-moz-min-content;width:min-content;max-width:100%;margin-left:auto;margin-right:0;overflow:hidden;color:#f5f5f5;background-color:#1e1e1e;box-sizing:border-box;padding:3px 9px;border-radius:6px;white-space:nowrap;text-overflow:ellipsis;opacity:.9}.card-image[_ngcontent-%COMP%]{width:250px;max-height:330px;padding:8px;vertical-align:bottom;-o-object-fit:contain;object-fit:contain;box-sizing:border-box;background-color:#cccccc80}.zoom-button[_ngcontent-%COMP%]{position:absolute;left:8px;bottom:-21px;width:42px;height:42px;border-radius:100px;padding:4px}.zoom-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:24px;vertical-align:bottom}.position-right-bottom[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0}.image-view-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1e4d;z-index:9900}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{position:absolute;right:16px;top:16px}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:36px}.contain-image[_ngcontent-%COMP%]{width:100%;height:100%;box-sizing:border-box;padding:16px;vertical-align:bottom;-o-object-fit:contain;object-fit:contain}.text-note-container[_ngcontent-%COMP%]{width:100%;max-height:400px;padding:.6em 1.2em;box-sizing:border-box;overflow:hidden auto;line-height:1.8;border-left:solid 1px #999;border-right:solid 1px #999}.character-image-box[_ngcontent-%COMP%]{width:100px;vertical-align:bottom;margin-left:.5em;margin-bottom:-6px;z-index:1;overflow:visible}.character-image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:150px;vertical-align:bottom;-o-object-fit:contain;object-fit:contain;-o-object-position:bottom center;object-position:bottom center}.character-image-box.has-icon[_ngcontent-%COMP%]{width:100px;height:100px;max-width:100px;max-height:100px;transform:translateY(-16px);margin-top:16px}.character-image-box.has-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:1em}.character-image[_ngcontent-%COMP%]{padding:0;width:100%;vertical-align:bottom}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.character-grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:min-content auto;grid-template-rows:1fr auto auto auto}.title-bg-area[_ngcontent-%COMP%]{grid-area:3 / 1 / 4 / 3}.title-area[_ngcontent-%COMP%]{grid-area:3 / 2 / 4 / 3}.owner-name-area[_ngcontent-%COMP%]{grid-area:2 / 2 / 3 / 3}.image-area[_ngcontent-%COMP%]{grid-area:1 / 1 / 4 / 2}.void-area[_ngcontent-%COMP%]{grid-area:1 / 2 / 3 / 3}.dataElm-area[_ngcontent-%COMP%]{grid-area:4 / 1 / 5 / 3}.grid-container-root[_ngcontent-%COMP%]{padding:.5em 1.2em;max-height:250px;overflow:hidden auto;box-sizing:border-box;border-left:solid 1px #999;border-right:solid 1px #999}.grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr fit-content(80%)}.grid-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{box-sizing:border-box;line-height:24px}.indetnt[_ngcontent-%COMP%]{padding-left:.5em}.section[_ngcontent-%COMP%]{max-width:100%;grid-column:1 / span 2}.section-text[_ngcontent-%COMP%]{font-size:1.1em;font-weight:700;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.note[_ngcontent-%COMP%]{margin-left:.5em;font-size:1em;line-height:1.8}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box;resize:none;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.textarea[_ngcontent-%COMP%]:hover{background:#EEE}.textarea[_ngcontent-%COMP%]:focus{background:#FFF}.tag[_ngcontent-%COMP%]{padding-right:1em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;min-width:7em}.value[_ngcontent-%COMP%]{font-size:1.2em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;text-align:right}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0px;min-width:3em;overflow:hidden;white-space:pre-wrap}.textarea-spacer[_ngcontent-%COMP%]{visibility:hidden;min-width:3em;height:auto;min-height:24px;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.input[_ngcontent-%COMP%]{min-width:3em;text-align:right;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#EEE}.input[_ngcontent-%COMP%]:focus{background:#FFF}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}.border[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.separator[_ngcontent-%COMP%]{padding:2px 0;border-bottom:1px solid #888}.with-button-marign[_ngcontent-%COMP%]{padding-left:60px}.is-fill[_ngcontent-%COMP%]{position:absolute;inset:0}.is-bold[_ngcontent-%COMP%]{font-weight:700}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #fff)}.aura-following.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px black)}.aura-following.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #33f)}.aura-following.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3f3)}.aura-following.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3ff)}.aura-following.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f00)}.aura-following.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f0f)}.aura-following.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #ff3)}.aura-following.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #fff)}button.link[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}button.link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button.link[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}button.link[_ngcontent-%COMP%]:disabled{color:gray}button.link[_ngcontent-%COMP%]:disabled:hover{background-color:transparent}.text[_ngcontent-%COMP%]{transform-origin:left top;position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.hide-area[_ngcontent-%COMP%]{overflow:hidden!important;font-size:0pt!important;width:0px!important;height:0px!important;margin:0!important;padding:0!important;border:0px none!important}.note-text[_ngcontent-%COMP%]{color:#444;min-width:3em;height:auto;min-height:24px;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.hide-text-area[_ngcontent-%COMP%]{color:transparent}input[_ngcontent-%COMP%] + .move[_ngcontent-%COMP%]{display:inline-block;transform:translate(-1em);transition:transform 18ms}input[_ngcontent-%COMP%]:hover + .move[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:active + .move[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:focus + .move[_ngcontent-%COMP%]{display:inline-block;transform:translate(0);transition:transform 18ms}@supports (-moz-user-select: -moz-none){input[_ngcontent-%COMP%] + .move[_ngcontent-%COMP%]{transform:translate(0)}}"],data:{animation:[Sn("fadeInOut",[Lt("void => *",[Rt("100ms ease-out",sn([et({opacity:0,offset:0}),et({opacity:1,offset:1})]))]),Lt("* => void",[Rt("100ms ease-in",sn([et({opacity:1,offset:0}),et({opacity:0,offset:1})]))])])]},changeDetection:0}),t})(),yI=(()=>{class t{constructor(e,i,r){this.ngZone=e,this.viewContainerRef=i,this.pointerDeviceService=r,this.callbackOnMouseEnter=s=>this.onMouseEnter(s),this.callbackOnMouseLeave=s=>this.onMouseLeave(s),this.callbackOnMouseDown=s=>this.onMouseDown(s)}ngOnInit(){}ngAfterViewInit(){this.addEventListeners(this.viewContainerRef.element.nativeElement)}ngOnDestroy(){this.removeEventListeners(this.viewContainerRef.element.nativeElement),this.clearTimer(),this.close()}onMouseEnter(e){this.clearTimer(),this.tooltipComponentRef||this.startOpenTimer()}onMouseLeave(e){this.clearTimer(),this.tooltipComponentRef&&this.startCloseTimer()}onMouseDown(e){!this.tooltipComponentRef||!this.tooltipComponentRef.location.nativeElement.contains(e.target)&&!this.viewContainerRef.element.nativeElement.contains(e.target)&&this.ngZone.run(()=>this.closeAll())}startOpenTimer(){let e=this.pointerDeviceService.pointerX,i=this.pointerDeviceService.pointerY;this.openTooltipTimer=setTimeout(()=>{this.openTooltipTimer=null,4<(e-this.pointerDeviceService.pointerX)**2+(i-this.pointerDeviceService.pointerY)**2?this.startOpenTimer():this.ngZone.run(()=>this.open())},100)}startCloseTimer(){this.closeTooltipTimer=setTimeout(()=>{this.closeTooltipTimer=null,this.tooltipComponentRef&&this.tooltipComponentRef.location.nativeElement.contains(document.activeElement)?this.startCloseTimer():this.ngZone.run(()=>this.closeAll())},400)}clearTimer(){this.closeTooltipTimer&&clearTimeout(this.closeTooltipTimer),this.openTooltipTimer&&clearTimeout(this.openTooltipTimer),this.closeTooltipTimer=this.openTooltipTimer=null}open(){if(this.closeAll(),this.pointerDeviceService.isDragging)return;let e=lr.defaultParentViewContainerRef;this.tooltipComponentRef=e.createComponent(uee,{index:e.length,injector:e.injector}),this.tooltipComponentRef.instance.tabletopObject=this.tabletopObject,this.tooltipComponentRef.instance.left=this.pointerDeviceService.pointerX,this.tooltipComponentRef.instance.top=this.pointerDeviceService.pointerY,this.addEventListeners(this.tooltipComponentRef.location.nativeElement),this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.addEventListener("mousedown",this.callbackOnMouseDown,!0)}),ze.register(this).on("DELETE_GAME_OBJECT",i=>{this.tabletopObject&&this.tabletopObject.identifier===i.data.identifier&&this.closeAll()}),this.tooltipComponentRef.onDestroy(()=>{this.removeEventListeners(this.tooltipComponentRef.location.nativeElement),document.body.removeEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.removeEventListener("mousedown",this.callbackOnMouseDown,!0),this.clearTimer(),this.tooltipComponentRef=null,ze.unregister(this)}),t.activeTooltips.push(this.tooltipComponentRef)}close(){if(!this.tooltipComponentRef)return;let e=t.activeTooltips.indexOf(this.tooltipComponentRef);0<=e&&t.activeTooltips.splice(e,1),this.tooltipComponentRef.destroy(),this.tooltipComponentRef=null}closeAll(){t.activeTooltips.forEach(e=>e.destroy()),t.activeTooltips=[],this.close()}addEventListeners(e){this.ngZone.runOutsideAngular(()=>{e.addEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.addEventListener("mouseleave",this.callbackOnMouseLeave,!1)})}removeEventListeners(e){e.removeEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.removeEventListener("mouseleave",this.callbackOnMouseLeave,!1)}}return t.activeTooltips=[],t.\u0275fac=function(e){return new(e||t)(He(Cn),He(zr),He(fi))},t.\u0275dir=Qt({type:t,selectors:[["","appTooltip",""]],inputs:{tabletopObject:["appTooltip","tabletopObject"]}}),t})();function dee(t,n){if(1&t&&(ot(0,"img",9),Et(1,"safe")),2&t){const e=_e();Qe("mix-blend-mode",1==e.blendType?null:"hard-light"),re("src",Tt(1,3,e.imageFile.url,"resourceUrl"),en)}}const fee=function(t){return{transform:t}};function hee(t,n){if(1&t&&(Q(0,"div",10)(1,"div",11)(2,"span",12),ye(3),ie(),Q(4,"span",13),ye(5),ie()()()),2&t){const e=_e();Qe("height",e.math.abs(e.gameTableMaskAltitude*e.gridSize),"px"),re("ngStyle",ft(5,fee,"translateX("+e.width*e.gridSize/2+"px) translateY("+-e.height*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),U(3),Xe(e.math.abs(e.gameTableMaskAltitude)),U(2),Xe(e.gameTableMaskAltitude)}}const pee=function(t){return{"is-grab":t}},Mv=function(t){return{fall:t}},CI=function(t){return{transform:t}},gee=function(t){return{"is-inverse":t}},_ee=function(t,n){return{"border-width":t,transform:n}},mee=function(t){return{image:t}};let $ee=(()=>{class t{constructor(e,i,r,s,o,a,h,w,X){this.ngZone=e,this.tabletopActionService=i,this.contextMenuService=r,this.elementRef=s,this.panelService=o,this.changeDetector=a,this.pointerDeviceService=h,this.modalService=w,this.coordinateService=X,this.gameTableMask=null,this.is3D=!1,this.gridSize=50,this.math=Math,this.viewRotateZ=10,this.movableOption={},this.input=null}get name(){return this.gameTableMask.name}get width(){return this.adjustMinBounds(this.gameTableMask.width)}get height(){return this.adjustMinBounds(this.gameTableMask.height)}get opacity(){return this.gameTableMask.opacity}get imageFile(){return this.gameTableMask.imageFile}get isLock(){return this.gameTableMask.isLock}set isLock(e){this.gameTableMask.isLock=e}get blendType(){return this.gameTableMask.blendType}set blendType(e){this.gameTableMask.blendType=e}get fontSize(){return this.gameTableMask.fontsize}set fontSize(e){this.gameTableMask.fontsize=e}get text(){return this.gameTableMask.text}set text(e){this.gameTableMask.text=e}get color(){return this.gameTableMask.color}set color(e){this.gameTableMask.color=e}get bgcolor(){return this.gameTableMask.bgcolor}set bgcolor(e){this.gameTableMask.bgcolor=e}get textShadowCss(){const e=rt.textShadowColor(this.color);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}get altitude(){return this.gameTableMask.altitude}set altitude(e){this.gameTableMask.altitude=e}get isAltitudeIndicate(){return this.gameTableMask.isAltitudeIndicate}set isAltitudeIndicate(e){this.gameTableMask.isAltitudeIndicate=e}get gameTableMaskAltitude(){return+this.altitude.toFixed(1)}get rubiedText(){return rt.rubyToHtml(rt.escapeHtml(this.text))}get isInverse(){return 90<Math.abs(this.viewRotateZ)%360&&Math.abs(this.viewRotateZ)%360<270}get isGMMode(){return this.gameTableMask.isGMMode}ngOnInit(){ze.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=dt.instance.get(e.data.identifier);!this.gameTableMask||!i||(this.gameTableMask===i||i instanceof Vn&&this.gameTableMask.contains(i))&&this.changeDetector.markForCheck()}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.gameTableMask,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new js(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this.input.destroy(),ze.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLock&&ze.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate();this.contextMenuService.open(i,[this.isGMMode?this.gameTableMask.isTransparentOnGMMode?{name:"\u2611 GM\u30e2\u30fc\u30c9\u6642\u900f\u904e",action:()=>{this.gameTableMask.isTransparentOnGMMode=!1,pt.play(tt.lock)}}:{name:"\u2610 GM\u30e2\u30fc\u30c9\u6642\u900f\u904e",action:()=>{this.gameTableMask.isTransparentOnGMMode=!0,pt.play(tt.unlock)}}:null,this.isGMMode?kt:null,this.isLock?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLock=!1,pt.play(tt.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLock=!0,pt.play(tt.lock)}},{name:"\u753b\u50cf\u3068\u8272",subActions:[{name:(0==this.blendType?"\u25c9":"\u25cb")+" \u753b\u50cf\u306e\u307f",action:()=>{this.blendType=0,pt.play(tt.cardDraw)}},{name:(1==this.blendType?"\u25c9":"\u25cb")+" \u80cc\u666f\u8272\u3068\u91cd\u306d\u308b",action:()=>{this.blendType=1,pt.play(tt.cardDraw)}},{name:(2==this.blendType?"\u25c9":"\u25cb")+" \u80cc\u666f\u8272\u3068\u6df7\u305c\u308b",action:()=>{this.blendType=2,pt.play(tt.cardDraw)}},kt,{name:"\u8272\u306e\u521d\u671f\u5316",action:()=>{this.color="#555555",this.bgcolor="#0a0a0a",pt.play(tt.cardDraw)}}]},kt,this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0}},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,pt.play(tt.sweep))},altitudeHande:this.gameTableMask},kt,{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.gameTableMask)}},this.gameTableMask.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.gameTableMask.getUrls().map(s=>{const o=s.value.toString();return{name:s.name?s.name:o,action:()=>{rt.sameOrigin(o)?window.open(o.trim(),"_blank","noopener"):this.modalService.open(qr,{url:o,title:this.gameTableMask.name,subTitle:s.name})},disabled:!rt.validUrl(o),error:rt.validUrl(o)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:rt.validUrl(o)&&!rt.sameOrigin(o)}})},this.gameTableMask.getUrls().length<=0?null:kt,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let s=this.gameTableMask.clone();console.log("\u30b3\u30d4\u30fc",s),s.location.x+=this.gridSize,s.location.y+=this.gridSize,s.isLock=!1,this.gameTableMask.parent&&this.gameTableMask.parent.appendChild(s),pt.play(tt.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.gameTableMask.destroy(),pt.play(tt.sweep)}},kt,{name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(r)}],this.name)}onMove(){pt.play(tt.cardPick)}onMoved(){pt.play(tt.cardPut)}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u30de\u30c3\u30d7\u30de\u30b9\u30af\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Ws,{title:r,left:i.x-200,top:i.y-150,width:400,height:530}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(He(Cn),He(mg),He(lr),He(yi),He(An),He(Oi),He(fi),He(Fn),He(tl))},t.\u0275cmp=Xt({type:t,selectors:[["game-table-mask"]],hostBindings:function(e,i){1&e&&Ae("dragstart",function(s){return i.onDragstart(s)})("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{gameTableMask:"gameTableMask",is3D:"is3D"},decls:10,vars:52,consts:[["appMovable","",1,"component","is-3d",2,"pointer-events","none",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],[1,"is-3d","text",2,"left","2px","top","2px","backface-visibility","hidden",3,"ngClass","ngStyle"],[1,"is-3d",2,"z-index","5","pointer-events","none",3,"ngClass","innerHtml"],[1,"border","is-fit-full",2,"backface-visibility","hidden",3,"ngClass","ngStyle"],[1,"is-fit-full","is-3d","chrome-smooth-image-trick",2,"pointer-events","auto",3,"ngClass"],["class","is-fit-full is-3d chrome-smooth-image-trick","style","pointer-events: none; position: absolute;",3,"mix-blend-mode","src",4,"ngIf"],[1,"lock-icon","is-center","is-3d",2,"pointer-events","none","z-index","10",3,"ngClass","ngStyle"],[1,"material-icons","is-3d",2,"pointer-events","none","backface-visibility","hidden"],["class","is-3d","style","display: flex; align-items: center; border-left: 2px dashed blanchedalmond; transform-origin: top left; pointer-events: none",3,"height","ngStyle",4,"ngIf"],[1,"is-fit-full","is-3d","chrome-smooth-image-trick",2,"pointer-events","none","position","absolute",3,"src"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","transform-origin","top left","pointer-events","none",3,"ngStyle"],[1,"is-3d",2,"pointer-events","none"],[1,"altitude-indicator","is-3d",2,"position","absolute","pointer-events","none"],[1,"altitude-indicator","is-3d",2,"position","absolute","pointer-events","none","transform","rotateY(-180deg)"]],template:function(e,i){1&e&&(Q(0,"div",0),Ae("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),Q(1,"div",1),ot(2,"div",2),ie(),Q(3,"div",3)(4,"div",4),Te(5,dee,2,6,"img",5),ie()(),Q(6,"div",6)(7,"i",7),ye(8),ie()(),Te(9,hee,6,7,"div",8),ie()),2&e&&(Qe("width",i.width*i.gridSize,"px")("height",i.height*i.gridSize,"px"),re("ngClass",ft(33,pee,!i.isLock))("movable.option",i.movableOption)("movable.disable",i.isLock),U(1),Qe("width",i.width*i.gridSize-4,"px")("height",i.height*i.gridSize-4,"px"),re("ngClass",ft(35,Mv,0==i.altitude))("ngStyle",ft(37,CI,"translateZ("+i.altitude*i.gridSize+"px)")),U(1),Qe("font-size",i.fontSize+9,"px")("color",i.color)("text-shadow",i.textShadowCss),re("ngClass",ft(39,gee,i.isInverse))("innerHtml",i.rubiedText,Yi),U(1),re("ngClass",ft(41,Mv,0==i.altitude))("ngStyle",Yt(43,_ee,i.isLock?"0px":"2px","translateZ("+i.altitude*i.gridSize+"px)")),U(1),Qe("opacity",i.opacity*(i.isGMMode&&i.gameTableMask.isTransparentOnGMMode?.6:1))("background-color",i.imageFile.url.length<1||i.blendType>0?i.bgcolor:null),re("ngClass",ft(46,mee,i.imageFile.url.length>=1)),U(1),re("ngIf",i.imageFile.url.length>=1),U(1),re("ngClass",ft(48,Mv,0==i.altitude))("ngStyle",ft(50,CI,"translateZ("+i.altitude*i.gridSize+"px)")),U(2),Xe(i.isLock?"lock":"open_with"),U(1),re("ngIf",i.isAltitudeIndicate&&i.math.abs(i.gameTableMaskAltitude)>=.5))},directives:[sl,Yn,Ji,bn],pipes:[ai],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.image[_ngcontent-%COMP%]{display:block;box-sizing:border-box}.lock-icon[_ngcontent-%COMP%]{background-color:#ccc;border-radius:100%;color:#444;width:25px;height:25px;visibility:hidden}.component[_ngcontent-%COMP%]:hover   .lock-icon[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .lock-icon[_ngcontent-%COMP%]{visibility:visible}.is-center[_ngcontent-%COMP%]{position:absolute;inset:0;margin:auto}.border[_ngcontent-%COMP%]{box-sizing:border-box;border:2px solid transparent}.image.border[_ngcontent-%COMP%]{border-width:0px}.component[_ngcontent-%COMP%]:hover   .border[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .border[_ngcontent-%COMP%], .is-grab[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{border:2px solid #cccccc!important}.is-fit-full[_ngcontent-%COMP%]{height:100%;width:100%}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.fall[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.text[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.is-inverse[_ngcontent-%COMP%]{transform:rotate(180deg)}"],changeDetection:0}),t})();const vee=["textArea"];function bee(t,n){if(1&t&&(Q(0,"div",20),ye(1),ie()),2&t){const e=_e();U(1),Xe(e.title)}}function yee(t,n){if(1&t&&(Q(0,"div",20),ye(1),ie()),2&t){const e=_e();U(1),Xe(e.title)}}const Cee=function(t){return{"is-grab":t}},Dv=function(t){return{transform:t}};function xee(t,n){if(1&t&&ot(0,"div",21),2&t){const e=_e();Qe("width",(e.width-1)*e.gridSize,"px")("min-height",e.gridSize/2,"px"),re("ngClass",ft(6,Cee,!e.isLocked))("ngStyle",ft(8,Dv,"translateX("+e.gridSize/2+"px) translateY("+-e.gridSize/4+"px)"))}}function wee(t,n){1&t&&(Q(0,"div")(1,"div",15)(2,"i",16),ye(3,"autorenew"),ie()(),Q(4,"div",17)(5,"i",16),ye(6,"autorenew"),ie()()())}const Eee=function(t){return{transform:t}};function Tee(t,n){if(1&t&&(Q(0,"div",22)(1,"div",23)(2,"span",24),ye(3),ie(),Q(4,"span",25),ye(5),ie()()()),2&t){const e=_e();Qe("height",e.math.abs(e.textNoteAltitude*e.gridSize),"px"),re("ngStyle",ft(5,Eee,"rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),U(3),Xe(e.math.abs(e.textNoteAltitude)),U(2),Xe(e.textNoteAltitude)}}const See=function(t,n){return{"is-transition":t,fall:n}},xI=function(t){return{"is-bg-filter":t}},Iee=function(t,n,e){return{"is-pointer-events-none":t,"is-pointer-events-auto":n,"hide-area":e}},kee=function(t){return{"hide-area":t}};let Mee=(()=>{class t{constructor(e,i,r,s,o,a,h){this.ngZone=e,this.contextMenuService=i,this.elementRef=r,this.panelService=s,this.changeDetector=o,this.pointerDeviceService=a,this.modalService=h,this.textNote=null,this.is3D=!1,this.callbackOnMouseUp=w=>this.onMouseUp(w),this.gridSize=50,this.math=Math,this._transitionTimeout=null,this._transition=!1,this._fallTimeout=null,this._fall=!1,this.calcFitHeightTimer=null,this.movableOption={},this.rotableOption={},this.viewRotateZ=10,this.input=null}get title(){return this.textNote.title}get text(){return this.calcFitHeightIfNeeded(),this.textNote.text}set text(e){this.calcFitHeightIfNeeded(),this.textNote.text=e}get color(){return this.textNote.color}set color(e){this.textNote.color=e}get textShadowCss(){const e=rt.textShadowColor(this.color,"#f2f2f2","#000000");return`${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px,\n    ${e} 0px 0px 0.5px,\n    ${e} 0px 0px 0.5px`}get fontSize(){return this.calcFitHeightIfNeeded(),this.textNote.fontSize}get imageFile(){return this.textNote.imageFile}get rotate(){return this.textNote.rotate}set rotate(e){this.textNote.rotate=e}get height(){return this.adjustMinBounds(this.textNote.height)}get width(){return this.adjustMinBounds(this.textNote.width)}get altitude(){return this.textNote.altitude}set altitude(e){this.textNote.altitude=e}get textNoteAltitude(){let e=this.altitude;if(this.isUpright&&this.altitude<0){if(-this.height<=this.altitude)return 0;e+=this.height}return+e.toFixed(1)}get isUpright(){return this.textNote.isUpright}set isUpright(e){this.textNote.isUpright=e}get isAltitudeIndicate(){return this.textNote.isAltitudeIndicate}set isAltitudeIndicate(e){this.textNote.isAltitudeIndicate=e}get isLocked(){return this.textNote.isLocked}set isLocked(e){this.textNote.isLocked=e}get isWhiteOut(){return this.textNote.isWhiteOut}set isWhiteOut(e){this.textNote.isWhiteOut=e}get isSelected(){return document.activeElement===this.textAreaElementRef.nativeElement}get rubiedText(){return rt.rubyToHtml(rt.escapeHtml(this.text))}get transition(){return this._transition}set transition(e){this._transition=e,this._transitionTimeout&&clearTimeout(this._transitionTimeout),this._transitionTimeout=e?setTimeout(()=>{this._transition=!1},132):null}get fall(){return this._fall}set fall(e){this._fall=e,this._fallTimeout&&clearTimeout(this._fallTimeout),this._fallTimeout=e?setTimeout(()=>{this._fall=!1},132):null}ngOnInit(){ze.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=dt.instance.get(e.data.identifier);!this.textNote||!i||(this.textNote===i||i instanceof Vn&&this.textNote.contains(i))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.textNote,transformCssOffset:"translateZ(0.17px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.textNote}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new js(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this._transitionTimeout&&clearTimeout(this._transitionTimeout),this._fallTimeout&&clearTimeout(this._fallTimeout),ze.unregister(this)}onInputStart(e){this.input.cancel(),this.textNote.isLocked&&ze.trigger("DRAG_LOCKED_OBJECT",{})}onDragstart(e){e.stopPropagation(),e.preventDefault()}onMouseDown(e){if(!this.isSelected){if(e.preventDefault(),this.textNote.toTopmost(),2===e.button)return void ze.trigger("DRAG_LOCKED_OBJECT",{});this.addMouseEventListeners()}}onMouseUp(e){if(this.pointerDeviceService.isAllowedToOpenContextMenu){let i=window.getSelection();i.isCollapsed||i.removeAllRanges(),this.textAreaElementRef.nativeElement.focus()}this.removeMouseEventListeners(),e.preventDefault()}onRotateMouseDown(e){e.stopPropagation(),e.preventDefault()}onContextMenu(e){this.removeMouseEventListeners(),!this.isSelected&&(e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu)&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,pt.play(tt.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,pt.play(tt.lock)}},kt,this.isUpright?{name:"\u2611 \u76f4\u7acb",action:()=>{this.transition=!0,this.isUpright=!1}}:{name:"\u2610 \u76f4\u7acb",action:()=>{this.transition=!0,this.isUpright=!0}},this.isWhiteOut?{name:"\u2611 \u753b\u50cf\u306e\u8272\u629c\u304d",action:()=>{this.isWhiteOut=!1}}:{name:"\u2610 \u753b\u50cf\u306e\u8272\u629c\u304d",action:()=>{this.isWhiteOut=!0}},kt,this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0}},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.isUpright?this.fall=!0:this.transition=!0,this.altitude=0,pt.play(tt.sweep))},altitudeHande:this.textNote},kt,{name:"\u30e1\u30e2\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.textNote)}},this.textNote.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.textNote.getUrls().map(r=>{const s=r.value.toString();return{name:r.name?r.name:s,action:()=>{rt.sameOrigin(s)?window.open(s.trim(),"_blank","noopener"):this.modalService.open(qr,{url:s,title:this.textNote.title,subTitle:r.name})},disabled:!rt.validUrl(s),error:rt.validUrl(s)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:rt.validUrl(s)&&!rt.sameOrigin(s)}})},this.textNote.getUrls().length<=0?null:kt,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.textNote.clone();r.isLocked=!1,console.log("\u30b3\u30d4\u30fc",r),r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.toTopmost(),pt.play(tt.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.textNote.destroy(),pt.play(tt.sweep)}}],this.title)}onMove(){pt.play(tt.cardPick)}onMoved(){pt.play(tt.cardPut)}calcFitHeightIfNeeded(){this.calcFitHeightTimer||this.ngZone.runOutsideAngular(()=>{this.calcFitHeightTimer=setTimeout(()=>{this.calcFitHeight(),this.calcFitHeightTimer=null},0)})}calcFitHeight(){let e=this.textAreaElementRef.nativeElement;e.style.height="0",e.scrollHeight>e.offsetHeight&&(e.style.height=e.scrollHeight+"px")}lastNewLineAdjust(e){return null==e?"":this.isSelected||e.lastIndexOf("\n")!=e.length-1?e:e+"\n"}adjustMinBounds(e,i=0){return e<i?i:e}addMouseEventListeners(){document.body.addEventListener("mouseup",this.callbackOnMouseUp,!1)}removeMouseEventListeners(){document.body.removeEventListener("mouseup",this.callbackOnMouseUp,!1)}showDetail(e){ze.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5171\u6709\u30e1\u30e2\u8a2d\u5b9a";e.title.length&&(r+=" - "+e.title),this.panelService.open(Ws,{title:r,left:i.x-350,top:i.y-200,width:560,height:470}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(He(Cn),He(lr),He(yi),He(An),He(Oi),He(fi),He(Fn))},t.\u0275cmp=Xt({type:t,selectors:[["text-note"]],viewQuery:function(e,i){if(1&e&&cn(vee,7),2&e){let r;ln(r=un())&&(i.textAreaElementRef=r.first)}},hostBindings:function(e,i){1&e&&Ae("dragstart",function(s){return i.onDragstart(s)})("mousedown",function(s){return i.onMouseDown(s)})("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{textNote:"textNote",is3D:"is3D"},decls:28,vars:77,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.option","movable.disable","movable.ondragstart","movable.ondragend"],["appRotable","",1,"is-3d",3,"rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],[1,"component-content","is-3d","is-pointer-events-auto"],[1,"is-3d",3,"ngClass","ngStyle"],[1,"upright-transform","is-3d","is-bg-color","is-front","is-bg-texture","chrome-smooth-image-trick",3,"ngClass"],["class","title is-3d is-black-background is-pointer-events-none",4,"ngIf"],["spellcheck","false",1,"textarea","is-3d",3,"ngClass","ngModel","input","ngModelChange"],["textArea",""],[1,"is-3d","is-outline-text","note-text",2,"margin-top","-18px",3,"ngClass","innerHTML"],[1,"upright-transform","is-3d","is-back","is-bg-color","is-bg-texture","chrome-smooth-image-trick",3,"ngClass"],[1,"is-3d","is-pointer-events-none",2,"visibility","hidden"],["spellcheck","false","readonly","",1,"textarea","is-3d","hide-area","is-pointer-events-none",3,"ngModel","ngModelChange"],[1,"is-3d","is-outline-text","note-text","is-pointer-events-none",2,"margin-top","-18px",3,"innerHTML"],["class","grand-grabing-area","style","position: absolute",3,"ngClass","ngStyle","width","min-height",4,"ngIf"],[3,"ngStyle"],[1,"rotate-grab","of-left-top"],[1,"material-icons"],[1,"rotate-grab","of-right-top"],[4,"ngIf"],["class","is-3d","style","display: flex; align-items: center; border-left: 2px dashed blanchedalmond; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],[1,"title","is-3d","is-black-background","is-pointer-events-none"],[1,"grand-grabing-area",2,"position","absolute",3,"ngClass","ngStyle"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","transform-origin","top left",3,"ngStyle"],[1,"is-3d"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"]],template:function(e,i){1&e&&(Q(0,"div",0),Ae("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),Q(1,"div",1),Ae("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Q(2,"div",2)(3,"div",3)(4,"div",4),Et(5,"safe"),Te(6,bee,2,1,"div",5),Q(7,"textarea",6,7),Ae("input",function(){return i.calcFitHeight()})("ngModelChange",function(s){return i.text=s}),ie(),ot(9,"div",8),Et(10,"safe"),ie(),Q(11,"div",9),Et(12,"safe"),Q(13,"div",10),Te(14,yee,2,1,"div",5),Q(15,"textarea",11),Ae("ngModelChange",function(s){return i.text=s}),ie(),ot(16,"div",12),Et(17,"safe"),ie()()(),Te(18,xee,1,10,"div",13),Q(19,"div",14)(20,"div",15)(21,"i",16),ye(22),ie()(),Q(23,"div",17)(24,"i",16),ye(25),ie()()(),Te(26,wee,7,0,"div",18),ie()(),Te(27,Tee,6,7,"div",19),ie()),2&e&&(re("movable.option",i.movableOption)("movable.disable",i.isSelected||i.isLocked),U(1),re("rotable.option",i.rotableOption)("rotable.disable",i.isLocked),U(1),Qe("width",i.width*i.gridSize,"px"),U(1),re("ngClass",Yt(60,See,i.transition,i.fall))("ngStyle",ft(63,Dv,"translateZ("+i.altitude*i.gridSize+"px) rotateY(90deg) rotateZ("+(i.isUpright?0:90)+"deg) rotateY(-90deg)")),U(1),Qe("background-image",Tt(5,48,"url("+(null==i.imageFile?null:i.imageFile.url)+")","style"))("width",i.width*i.gridSize,"px")("min-height",i.height*i.gridSize,"px"),re("ngClass",ft(65,xI,i.isWhiteOut&&(null==i.imageFile?null:i.imageFile.url.length)>0)),U(2),re("ngIf",i.title.length),U(1),Qe("font-size",i.fontSize+9,"px"),re("ngClass",Zr(67,Iee,!i.isSelected,i.isSelected,!i.isSelected))("ngModel",i.text),U(2),Qe("font-size",i.fontSize+9,"px")("color",i.color)("text-shadow",i.textShadowCss),re("ngClass",ft(71,kee,i.isSelected))("innerHTML",Tt(10,51,i.lastNewLineAdjust(i.rubiedText),"html"),Yi),U(2),Qe("background-image",Tt(12,54,"url("+(null==i.imageFile?null:i.imageFile.url)+")","style"))("width",i.width*i.gridSize,"px")("min-height",i.height*i.gridSize,"px"),re("ngClass",ft(73,xI,i.isWhiteOut&&(null==i.imageFile?null:i.imageFile.url.length)>0)),U(3),re("ngIf",i.title.length),U(1),Qe("font-size",i.fontSize+9,"px"),re("ngModel",i.text),U(1),Qe("font-size",i.fontSize+9,"px"),re("innerHTML",Tt(17,57,i.lastNewLineAdjust(i.rubiedText),"html"),Yi),U(2),re("ngIf",!i.isLocked),U(1),re("ngStyle",ft(75,Dv,"translateZ("+i.altitude*i.gridSize+"px)")),U(3),Xe(i.isLocked?"lock":"autorenew"),U(3),Xe(i.isLocked?"lock":"autorenew"),U(1),re("ngIf",!i.isLocked),U(1),re("ngIf",i.isAltitudeIndicate&&i.math.abs(i.textNoteAltitude)>=.5))},directives:[sl,tc,Yn,Ji,bn,mi,$i,di],pipes:[ai],styles:['[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;width:1px;height:0}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;transform:translate(-50%)}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;-webkit-backface-visibility:hidden;backface-visibility:hidden}.is-front[_ngcontent-%COMP%]{transform-origin:50% 100%;transform:rotateX(-90deg)}.is-back[_ngcontent-%COMP%]{transform-origin:50% 100%;transform:rotateX(-90deg) rotateY(180deg)}.is-bg-texture[_ngcontent-%COMP%]{background-repeat:no-repeat;background-size:100% 100%}.is-bg-filter[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:rgba(255,255,255,.7);transition:background-color .2s}.is-bg-color[_ngcontent-%COMP%]{box-sizing:border-box;color:#444;background-color:#f0dabde6;border:solid 1px #999}.title[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;-webkit-backface-visibility:hidden;backface-visibility:hidden}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;resize:none;overflow:hidden;box-sizing:border-box;background:none;border:none;border-radius:0;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1rem;padding:2px;margin:0;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;-webkit-backface-visibility:hidden;backface-visibility:hidden}.textarea[_ngcontent-%COMP%]:focus{background:rgba(255,255,255,.75)}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.is-outline-text[_ngcontent-%COMP%]{font-size:24px;color:#444;text-shadow:#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:42px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;text-align:center;padding:2px;background-color:#ccc;border-radius:28px;color:#444;font-size:8px}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-21px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-21px}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.fall[_ngcontent-%COMP%]{transition:transform 132ms cubic-bezier(.21,.97,.75,1.25)}.hide-area[_ngcontent-%COMP%]{overflow:hidden!important;font-size:0pt!important;width:0px!important;height:0px!important;margin:0!important;padding:0!important;border:0px none!important}.note-text[_ngcontent-%COMP%]{font-family:Cambria,Georgia;padding:2px;white-space:pre-wrap;-webkit-backface-visibility:hidden;backface-visibility:hidden;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}'],changeDetection:0}),t})();const Dee=["cardImage"],Aee=function(t){return{transform:t}};let Pee=(()=>{class t{constructor(){this.card=null,this.gridSize=50,this.naturalWidth=0,this.naturalHeight=0}ngOnInit(){}onCardImageLoad(){!this.cardImageElement||(this.naturalWidth=this.cardImageElement.nativeElement.naturalWidth,this.naturalHeight=this.cardImageElement.nativeElement.naturalHeight)}get rubiedText(){return this.card?rt.rubyToHtml(rt.escapeHtml(this.card.text)):""}get imageAreaRect(){return this.calcImageAreaRect(64,64,0)}calcImageAreaRect(e,i,r){const s={width:0,height:0,top:r,left:r,scale:1};if(0==this.naturalWidth||0==this.naturalHeight)return s;const o=e-2*r,a=i-2*r;return this.naturalHeight*o/this.naturalWidth>a?(s.width=this.naturalWidth*a/this.naturalHeight,s.height=a,s.left=r+(o-s.width)/2):(s.width=o,s.height=this.naturalHeight*o/this.naturalWidth,s.top=r+(a-s.height)/2),this.card&&(s.scale=s.width/(this.card.size*this.gridSize),s.width=this.card.size*this.gridSize,s.height=s.width*this.naturalHeight/this.naturalWidth),s}get cardColor(){return this.card?this.card.color:"#555555"}get cardFontSize(){return this.card?this.card.fontsize+9:18}get cardText(){return this.card?this.card.text:""}get textShadowCss(){const e=rt.textShadowColor(this.cardColor);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=Xt({type:t,selectors:[["card-list-image"]],viewQuery:function(e,i){if(1&e&&cn(Dee,7),2&e){let r;ln(r=un())&&(i.cardImageElement=r.first)}},inputs:{card:"card"},decls:11,vars:30,consts:[[1,"image-box",2,"position","relative",3,"appTooltip"],[1,"text",2,"z-index","5",3,"ngStyle"],[3,"innerHTML"],[1,"image","contain"],[3,"src","load"],["cardImage",""],[3,"src"]],template:function(e,i){1&e&&(Q(0,"div",0)(1,"div",1),ot(2,"div",2),Et(3,"safe"),ie(),Q(4,"div",3)(5,"img",4,5),Ae("load",function(){return i.onCardImageLoad()}),Et(7,"safe"),ie()(),Q(8,"div",3),ot(9,"img",6),Et(10,"safe"),ie()()),2&e&&(re("appTooltip",i.card),U(1),Qe("width",i.imageAreaRect.width,"px")("height",i.imageAreaRect.height,"px")("left",i.imageAreaRect.left,"px")("top",i.imageAreaRect.top,"px"),re("ngStyle",ft(28,Aee,"scale("+i.imageAreaRect.scale+")")),U(1),Qe("font-size",i.cardFontSize,"px")("color",i.cardColor)("text-shadow",i.textShadowCss),re("innerHTML",Tt(3,19,i.rubiedText,"html"),Yi),U(3),re("src",Tt(7,22,null==i.card||null==i.card.frontImage?null:i.card.frontImage.url,"resourceUrl"),en),U(4),re("src",Tt(10,25,null==i.card||null==i.card.backImage?null:i.card.backImage.url,"resourceUrl"),en))},directives:[yI,Ji],pipes:[ai],styles:[".image-box[_ngcontent-%COMP%]{display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:64px;height:64px;-o-object-fit:contain;object-fit:contain}.text[_ngcontent-%COMP%]{transform-origin:left top;position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}"]}),t})();function Nee(t,n){if(1&t){const e=it();Q(0,"div",2),ot(1,"card-list-image",3),Q(2,"div",4)(3,"button",5),Ae("click",function(){const s=Oe(e).$implicit;return _e().drawCard(s)}),ye(4,"\u5c71\u672d\u304b\u3089\u51fa\u3059"),ie(),Q(5,"button",0),Ae("click",function(){const s=Oe(e).$implicit;return _e().showDetail(s)}),Q(6,"i",6),ye(7,"settings"),ie(),ye(8,"\u7de8\u96c6"),ie(),ot(9,"br"),Q(10,"button",0),Ae("click",function(){const s=Oe(e).$implicit;return _e().up(s)}),ye(11,"\u2191"),ie(),Q(12,"button",0),Ae("click",function(){const s=Oe(e).$implicit;return _e().down(s)}),ye(13,"\u2193"),ie(),ot(14,"br"),ie()()}if(2&t){const e=n.$implicit;U(1),re("card",e)}}let Fee=(()=>{class t{constructor(e,i,r){this.panelService=e,this.changeDetector=i,this.chatMessageService=r,this.cardStack=null,this.owner=xt.peerContext.userId}ngOnInit(){Promise.resolve().then(()=>this.panelService.title=this.cardStack.name+" \u306e\u30ab\u30fc\u30c9\u4e00\u89a7"),ze.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=dt.instance.get(e.data.identifier);!this.cardStack||!i||((this.cardStack===i||i instanceof Vn&&this.cardStack.contains(i))&&this.changeDetector.markForCheck(),e.data.identifier===this.cardStack.identifier&&this.cardStack.owner!==this.owner&&this.panelService.close())}).on("DELETE_GAME_OBJECT",e=>{this.cardStack&&this.cardStack.identifier===e.data.identifier&&this.panelService.close()})}ngOnDestroy(){ze.unregister(this),this.cardStack.owner===this.owner&&(this.cardStack.owner="")}drawCard(e){e.parent.removeChild(e),e.location.x=this.cardStack.location.x+100+50*Math.random(),e.location.y=this.cardStack.location.y+25+50*Math.random(),e.location.name=this.cardStack.location.name,e.rotate+=this.cardStack.rotate,360<e.rotate&&(e.rotate-=360),e.toTopmost(),pt.play(tt.cardDraw),this.chatMessageService.sendOperationLog(e.isFront?`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${""==e.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":e.name} \u3092\u53d6\u308a\u51fa\u3057\u305f`:`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 1\u679a\u53d6\u308a\u51fa\u3057\u3066\u4f0f\u305b\u305f`)}up(e){let i=e.parent,r=i.children.indexOf(e);0<r&&i.insertBefore(e,i.children[r-1])}down(e){let i=e.parent,r=i.children.indexOf(e);r<i.children.length-1&&i.insertBefore(i.children[r+1],e)}close(e=!1){e&&(this.cardStack.shuffle(),ze.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier}),pt.play(tt.cardShuffle)),this.panelService.close()}showDetail(e){let r="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Ws,{title:r,left:this.panelService.left+10,top:this.panelService.top+20,width:600,height:600}).tabletopObject=e}trackByCard(e,i){return i.identifier}}return t.\u0275fac=function(e){return new(e||t)(He(An),He(Oi),He(kr))},t.\u0275cmp=Xt({type:t,selectors:[["card-stack-list"]],inputs:{cardStack:"cardStack"},decls:5,vars:2,consts:[[3,"click"],["class","box",4,"ngFor","ngForOf","ngForTrackBy"],[1,"box"],[3,"card"],[2,"display","inline-block"],["type","submit",3,"click"],[1,"material-icons",2,"font-size","1.1em","vertical-align","text-bottom"]],template:function(e,i){1&e&&(Q(0,"div")(1,"button",0),Ae("click",function(){return i.close(!0)}),ye(2,"\u30b7\u30e3\u30c3\u30d5\u30eb\u3057\u3066\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b"),ie(),ot(3,"hr"),Te(4,Nee,15,1,"div",1),ie()),2&e&&(U(4),re("ngForOf",i.cardStack.cards)("ngForTrackBy",i.trackByCard))},directives:[oi,Pee],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image-box[_ngcontent-%COMP%]{display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}"],changeDetection:0}),t})();const Av=function(t){return{transform:t}};function Oee(t,n){if(1&t&&(Q(0,"div",9),ot(1,"div",10),Et(2,"safe"),ie()),2&t){const e=_e(2);re("ngStyle",ft(11,Av,"rotateZ("+e.topCard.rotate+"deg)")),U(1),Qe("font-size",e.topCard.fontsize+9,"px")("color",e.topCard.color)("text-shadow",e.textShadowCss(e.topCard.color)),re("innerHTML",Tt(2,8,e.rubiedText,"html"),Yi)}}function Ree(t,n){if(1&t){const e=it();Q(0,"div",6),Ae("@shuffle.start",function(r){return Oe(e),_e().animationShuffleStarted(r)})("@shuffle.done",function(r){return Oe(e),_e().animationShuffleDone(r)}),Te(1,Oee,3,13,"div",7),ot(2,"img",8),Et(3,"safe"),ie()}if(2&t){const e=_e();re("@bounceInOut",void 0)("@shuffle",e.animeState),U(1),re("ngIf",e.topCard.isFront),U(1),re("ngStyle",ft(8,Av,"rotateZ("+e.topCard.rotate+"deg)"))("src",Tt(3,5,e.imageFile.url,"resourceUrl"),en)}}function Bee(t,n){if(1&t&&(Ke(0),Q(1,"div",11)(2,"i",12),ye(3),ie()(),Q(4,"div",13)(5,"i",12),ye(6),ie()(),Q(7,"div",14)(8,"i",12),ye(9),ie()(),Q(10,"div",15)(11,"i",12),ye(12),ie()(),Ye()),2&t){const e=_e();U(3),Xe(e.isLocked?"lock":"autorenew"),U(3),Xe(e.isLocked?"lock":"autorenew"),U(3),Xe(e.isLocked?"lock":"autorenew"),U(3),Xe(e.isLocked?"lock":"autorenew")}}const wI=function(t){return{"is-inverse":t}};function Lee(t,n){if(1&t&&(Q(0,"div",16)(1,"span",17),ye(2),ie()()),2&t){const e=_e();re("ngStyle",ft(3,Av,"translateY(-50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateZ("+(e.isInverse?180:0)+"deg)")),U(1),re("ngClass",ft(5,wI,e.isInverse)),U(1),Rn("",e.cards.length,"\u679a")}}const zee=function(t,n){return{"background-color":t,transform:n}};function jee(t,n){if(1&t&&(Q(0,"div",18)(1,"span",17)(2,"b"),ye(3),ie(),ye(4," \u304c\u78ba\u8a8d\u4e2d"),ie()()),2&t){const e=_e();re("ngStyle",Yt(3,zee,e.ownerColor,"translateY(50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateZ("+(e.isInverse?180:0)+"deg)")),U(1),re("ngClass",ft(6,wI,e.isInverse)),U(2),Xe(e.ownerName)}}const Hee=function(t){return{"is-empty":t}},Uee=function(t){return{"is-grab":t}};let Vee=(()=>{class t{constructor(e,i,r,s,o,a,h,w,X){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.elementRef=s,this.changeDetector=o,this.imageService=a,this.pointerDeviceService=h,this.modalService=w,this.chatMessageService=X,this.cardStack=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.viewRotateZ=10,this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null}get name(){return this.cardStack.name}get rotate(){return this.cardStack.rotate}set rotate(e){this.cardStack.rotate=e}get zindex(){return this.cardStack.zindex}get isShowTotal(){return this.cardStack.isShowTotal}get cards(){return this.cardStack.cards}get isEmpty(){return this.cardStack.isEmpty}get size(){let e=this.cardStack.topCard;return e?e.size:2}get hasOwner(){return this.cardStack.hasOwner}get ownerIsOnline(){return this.cardStack.ownerIsOnline}get ownerName(){return this.cardStack.ownerName}get ownerColor(){return this.cardStack.ownerColor}get topCard(){return this.cardStack.topCard}get imageFile(){return this.imageService.getSkeletonOr(this.cardStack.imageFile)}get isIconHidden(){return null!=this.iconHiddenTimer}get rubiedText(){return rt.rubyToHtml(rt.escapeHtml(this.topCard.text))}get isLocked(){return!!this.cardStack&&this.cardStack.isLocked}set isLocked(e){this.cardStack&&(this.cardStack.isLocked=e)}get isInverse(){const e=Math.abs(this.viewRotateZ+this.rotate)%360;return 90<e&&e<270}ngOnInit(){ze.register(this).on("SHUFFLE_CARD_STACK",e=>{e.data.identifier===this.cardStack.identifier&&(this.animeState="active",this.changeDetector.markForCheck())}).on("INVERSE_CARD_STACK",e=>{e.data.identifier===this.cardStack.identifier&&(this.animeState="inverse",this.changeDetector.markForCheck())}).on("UPDATE_GAME_OBJECT",e=>{let i=dt.instance.get(e.data.identifier);!this.cardStack||!i||(this.cardStack===i||i instanceof Vn&&this.cardStack.contains(i)||i instanceof We&&i.userId===this.cardStack.owner)&&this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on("CARD_STACK_DECREASED",e=>{e.data.cardStackIdentifier===this.cardStack.identifier&&this.cardStack&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=We.findByPeerId(e.data.peerId);(!i||this.cardStack.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.cardStack,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain","text-note"]},this.rotableOption={tabletopObject:this.cardStack}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new js(this.elementRef.nativeElement)}),this.input.onStart=e=>this.ngZone.run(()=>this.onInputStart(e))}ngOnDestroy(){this.input.destroy(),ze.unregister(this)}animationShuffleStarted(e){}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onCardDrop(e){if(this.cardStack!==e.detail&&(e.detail instanceof zn||e.detail instanceof Kn))if(e.stopPropagation(),e.preventDefault(),e.detail instanceof zn){let i=e.detail;(i.location.x-this.cardStack.location.x)**2+(i.location.y-this.cardStack.location.y)**2+(i.posZ-this.cardStack.posZ)**2<2500&&(this.chatMessageService.sendOperationLog(`${i.isFront?""==i.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":i.name:"\u4f0f\u305b\u305f\u30ab\u30fc\u30c9"} \u3092 ${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306b\u4e57\u305b\u305f`),this.cardStack.putOnTop(i))}else if(e.detail instanceof Kn){let i=e.detail;(i.location.x-this.cardStack.location.x)**2+(i.location.y-this.cardStack.location.y)**2+(i.posZ-this.cardStack.posZ)**2<625&&(this.chatMessageService.sendOperationLog(`${""==i.name?"(\u7121\u540d\u306e\u5c71\u672d)":i.name} \u3092\u5168\u3066 ${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306b\u4e57\u305b\u305f`),this.concatStack(i))}}startDoubleClickTimer(e){if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(()=>this.stopDoubleClickTimer(),e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}stopDoubleClickTimer(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}onDoubleClick(){if(this.stopDoubleClickTimer(),(this.doubleClickPoint.x-this.input.pointer.x)**2+(this.doubleClickPoint.y-this.input.pointer.y)**2<100){console.log("onDoubleClick !!!!");const i=this.drawCard();if(i){let r;pt.play(tt.cardDraw),r=i.isFront?`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${""==i.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":i.name} \u3092\u5f15\u3044\u305f`:`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 1\u679a\u5f15\u3044\u3066\u4f0f\u305b\u305f`,this.chatMessageService.sendOperationLog(r)}}}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.startDoubleClickTimer(e),this.cardStack.toTopmost(),this.startIconHiddenTimer(),this.isLocked&&ze.trigger("DRAG_LOCKED_OBJECT",{}),ze.trigger("SELECT_TABLETOP_OBJECT",{identifier:this.cardStack.identifier,className:"GameCharacter"})}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,pt.play(tt.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,pt.play(tt.lock)}},kt,{name:"\u30ab\u30fc\u30c9\u3092\uff11\u679a\u5f15\u304f",action:()=>{const r=this.drawCard();if(r){let s;pt.play(tt.cardDraw),s=r.isFront?`${this.cardStack.name} \u304b\u3089 ${""==r.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":r.name} \u3092\u5f15\u3044\u305f`:`${this.cardStack.name} \u304b\u3089 1\u679a\u5f15\u3044\u3066\u4f0f\u305b\u305f`,this.chatMessageService.sendOperationLog(s)}},default:this.cards.length>0,disabled:0==this.cards.length},{name:"\u30ab\u30fc\u30c9\u3092\u5f15\u304f",action:null,subActions:[2,3,4,5,10].map(r=>({name:`${r}\u679a`,action:()=>{const s=[];for(let o=0;o<r;o++){const a=this.drawCard();a&&(s.push(a),(0==o||3==o||9==o)&&pt.play(tt.cardDraw))}if(s.length>0){const o=s.filter(a=>a.isFront);if(0==o.length)this.chatMessageService.sendOperationLog(`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${s.length}\u679a\u5f15\u3044\u3066\u4f0f\u305b\u305f`);else{const a=new Map;for(const w of o){let X=a.get(w.name)||0;X+=1,a.set(""==w.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":w.name,X)}let h=`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${[...a.keys()].map(w=>`${w} \u3092 ${a.get(w)}\u679a`).join("\u3001")}`;h+=o.length===s.length?"\u5f15\u3044\u305f":`\u5f15\u304d\u3001${s.length-o.length}\u679a\u3092\u4f0f\u305b\u305f`,this.chatMessageService.sendOperationLog(h)}}}})),disabled:0==this.cards.length},kt,0!=this.cards.length&&this.cardStack.topCard.isFront?{name:"\u4e00\u756a\u4e0a\u3092\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDown(),pt.play(tt.cardDraw)},disabled:0==this.cards.length}:{name:"\u4e00\u756a\u4e0a\u3092\u8868\u306b\u3059\u308b",action:()=>{!this.cardStack.topCard||(this.cardStack.topCard.isFront||this.chatMessageService.sendOperationLog(`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306e\u4e00\u756a\u4e0a\u306e ${""==this.cardStack.topCard.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.cardStack.topCard.name} \u3092\u516c\u958b\u3057\u305f`),this.cardStack.faceUp(),pt.play(tt.cardDraw))},disabled:0==this.cards.length},kt,{name:"\u3059\u3079\u3066\u8868\u306b\u3059\u308b",action:()=>{this.cardStack.faceUpAll(),pt.play(tt.cardDraw)},disabled:0==this.cards.length},{name:"\u3059\u3079\u3066\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDownAll(),pt.play(tt.cardDraw)},disabled:0==this.cards.length},{name:"\u3059\u3079\u3066\u6b63\u4f4d\u7f6e\u306b\u3059\u308b",action:()=>{this.cardStack.uprightAll(),pt.play(tt.cardDraw)},disabled:0==this.cards.length},kt,{name:"\u30b7\u30e3\u30c3\u30d5\u30eb",action:()=>{this.cardStack.shuffle(),pt.play(tt.cardShuffle),ze.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier})},disabled:0==this.cards.length},{name:"\u30ab\u30fc\u30c9\u4e00\u89a7\u3092\u898b\u308b",action:()=>{this.showStackList(this.cardStack),this.chatMessageService.sendOperationLog(`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306e\u30ab\u30fc\u30c9\u4e00\u89a7\u3092\u898b\u305f`)},disabled:0==this.cards.length},kt,this.isShowTotal?{name:"\u2611 \u679a\u6570\u3092\u8868\u793a",action:()=>{this.cardStack.isShowTotal=!1}}:{name:"\u2610 \u679a\u6570\u3092\u8868\u793a",action:()=>{this.cardStack.isShowTotal=!0}},{name:"\u30ab\u30fc\u30c9\u30b5\u30a4\u30ba\u3092\u63c3\u3048\u308b",action:()=>{this.cardStack.topCard&&this.cardStack.unifyCardsSize(this.cardStack.topCard.size)},disabled:0==this.cards.length},kt,{name:"\u5c71\u672d\u3092\u5206\u5272\u3059\u308b",subActions:[{name:"\u4eba\u6570\u3067\u5206\u5272",action:()=>{this.splitStack(xt.peerIds.length),pt.play(tt.cardDraw)}},kt,...[2,3,4,5,6].map(r=>({name:`${r}\u3064\u306b\u5206\u5272`,action:()=>{this.splitStack(r),pt.play(tt.cardDraw)}}))],disabled:0==this.cards.length},{name:"\u5c71\u672d\u3092\u5d29\u3059",action:()=>{this.breakStack(),pt.play(tt.cardShuffle)},disabled:0==this.cards.length},{name:"\u5c71\u672d\u5168\u4f53\u3092\u88cf\u8fd4\u3059",action:()=>{this.cardStack.inverse(),pt.play(tt.cardDraw),pt.play(tt.cardDraw),ze.call("INVERSE_CARD_STACK",{identifier:this.cardStack.identifier})},disabled:0==this.cards.length},kt,{name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.cardStack)}},this.cardStack.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.cardStack.getUrls().map(r=>{const s=r.value.toString();return{name:r.name?r.name:s,action:()=>{rt.sameOrigin(s)?window.open(s.trim(),"_blank","noopener"):this.modalService.open(qr,{url:s,title:this.cardStack.name,subTitle:r.name})},disabled:!rt.validUrl(s),error:rt.validUrl(s)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:rt.validUrl(s)&&!rt.sameOrigin(s)}})},this.cardStack.getUrls().length<=0?null:kt,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.cardStack.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.owner="",r.isLocked=!1,r.toTopmost(),pt.play(tt.cardPut)}},{name:"\u5c71\u672d\u3092\u524a\u9664\u3059\u308b",action:()=>{this.cardStack.setLocation("graveyard"),this.cardStack.destroy(),pt.play(tt.sweep)}}],this.name)}onMove(){pt.play(tt.cardPick)}onMoved(){pt.play(tt.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}drawCard(){let e=this.cardStack.drawCard();return e&&(this.cardStack.update(),e.location.x+=100+50*Math.random(),e.location.y+=25+50*Math.random(),e.setLocation(this.cardStack.location.name)),e}textShadowCss(e){const i=rt.textShadowColor(e);return`${i} 0px 0px 2px, \n    ${i} 0px 0px 2px, \n    ${i} 0px 0px 2px, \n    ${i} 0px 0px 2px, \n    ${i} 0px 0px 2px, \n    ${i} 0px 0px 2px,\n    ${i} 0px 0px 2px,\n    ${i} 0px 0px 2px`}breakStack(){let e=this.cardStack.drawCardAll().reverse();for(let i of e)i.location.x+=25-50*Math.random(),i.location.y+=25-50*Math.random(),i.toTopmost(),i.setLocation(this.cardStack.location.name);this.cardStack.setLocation("graveyard"),this.cardStack.destroy()}splitStack(e){if(e<2)return;let i=[];for(let a=0;a<e;a++){let h=Kn.create(`${this.cardStack.name}_${("0"+(a+1).toString()).slice(-2)}`);h.location.x=this.cardStack.location.x+50-100*Math.random(),h.location.y=this.cardStack.location.y+50-100*Math.random(),h.posZ=this.cardStack.posZ,h.location.name=this.cardStack.location.name,h.rotate=this.rotate,h.toTopmost(),i.push(h)}let r=this.cardStack.drawCardAll();this.cardStack.setLocation("graveyard"),this.cardStack.destroy();let s=0,o=r.length/e*(s+1);for(let a=0;a<r.length;a++)i[s].putOnBottom(r[a]),o<=a+1&&(s++,o=r.length/e*(s+1))}concatStack(e,i=this.cardStack){let r=Kn.create(i.name);r.location.name=i.location.name,r.location.x=i.location.x,r.location.y=i.location.y,r.posZ=i.posZ,r.zindex=e.zindex,r.rotate=i.rotate;let s=i.drawCardAll(),o=e.drawCardAll();for(let a of o.concat(s))r.putOnBottom(a);i.setLocation(""),i.destroy(),e.setLocation(""),e.destroy()}dispatchCardDropEvent(){let r=this.elementRef.nativeElement.parentElement.children,s=new CustomEvent("carddrop",{detail:this.cardStack,bubbles:!0});for(let o=0;o<r.length;o++)r[o].dispatchEvent(s)}showDetail(e){ze.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5c71\u672d\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Ws,{title:r,left:i.x-300,top:i.y-300,width:600,height:490}).tabletopObject=e}showStackList(e){ze.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r={left:i.x-200,top:i.y-300,width:400,height:600};this.cardStack.owner=xt.peerContext.userId,this.panelService.open(Fee,r).cardStack=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}}return t.\u0275fac=function(e){return new(e||t)(He(Cn),He(lr),He(An),He(yi),He(Oi),He(wu),He(fi),He(Fn),He(kr))},t.\u0275cmp=Xt({type:t,selectors:[["card-stack"]],hostBindings:function(e,i){1&e&&Ae("carddrop",function(s){return i.onCardDrop(s)})("dragstart",function(s){return i.onDragstart(s)})("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{cardStack:"cardStack",is3D:"is3D"},decls:6,vars:16,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-pointer-events-auto","is-3d",3,"ngClass","rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],["class","is-3d",4,"ngIf"],[4,"ngIf"],["class","name-tag is-nowrap is-black-background is-3d number-of-cards","style","z-index: 10",3,"ngStyle",4,"ngIf"],["class","name-tag has-length-limit is-nowrap is-black-background is-3d","style","z-index: 10; color: whitesmoke",3,"ngStyle",4,"ngIf"],[1,"is-3d"],["class","text is-3d","style","width: 100%; height: 100%",3,"ngStyle",4,"ngIf"],[1,"card-image","chrome-smooth-image-trick",3,"ngStyle","src"],[1,"text","is-3d",2,"width","100%","height","100%",3,"ngStyle"],[1,"is-3d",3,"innerHTML"],[1,"rotate-grab","of-left-top","is-3d"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","is-3d"],[1,"rotate-grab","of-right-bottom","is-3d"],[1,"rotate-grab","of-right-top","is-3d"],[1,"name-tag","is-nowrap","is-black-background","is-3d","number-of-cards",2,"z-index","10",3,"ngStyle"],[3,"ngClass"],[1,"name-tag","has-length-limit","is-nowrap","is-black-background","is-3d",2,"z-index","10","color","whitesmoke",3,"ngStyle"]],template:function(e,i){1&e&&(Q(0,"div",0),Ae("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),Q(1,"div",1),Ae("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Te(2,Ree,4,10,"div",2),Te(3,Bee,13,4,"ng-container",3),Te(4,Lee,3,7,"div",4),Te(5,jee,5,8,"div",5),ie()()),2&e&&(Qe("width",i.size*i.gridSize,"px"),re("ngClass",ft(12,Hee,i.isEmpty))("movable.option",i.movableOption)("movable.disable",i.isLocked),U(1),re("ngClass",ft(14,Uee,!i.isLocked))("rotable.option",i.rotableOption)("rotable.disable",i.isLocked),U(1),re("ngIf",i.topCard&&i.imageFile),U(1),re("ngIf",!i.isIconHidden),U(1),re("ngIf",i.isShowTotal),U(1),re("ngIf",i.ownerIsOnline))},directives:[sl,Yn,tc,bn,Ji],pipes:[ai],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.is-empty[_ngcontent-%COMP%]{height:100px;width:100px}.component[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;margin-top:-5px;margin-left:-5px;border:solid 5px #CCCCCC;border-radius:5px;background-color:#ccc;-webkit-backface-visibility:hidden;backface-visibility:hidden}.card-image[_ngcontent-%COMP%]{display:block;inset:0;margin:auto;height:auto;width:100%}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.rotate-grab[_ngcontent-%COMP%]{display:none;z-index:11}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:50%;opacity:.9}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.text[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.component[_ngcontent-%COMP%]:not(.is-empty):hover   .number-of-cards[_ngcontent-%COMP%]{visibility:hidden}.is-inverse[_ngcontent-%COMP%]{transform:rotate(180deg)}"],data:{animation:[Sn("shuffle",[ap("active",et({transform:""})),Lt("* => active",[Rt("800ms ease",sn([et({transform:"scale3d(0, 0, 0) rotateZ(0deg)",offset:0}),et({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(360deg)",offset:.5}),et({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(520deg)",offset:.75}),et({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(630deg)",offset:.875}),et({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(720deg)",offset:1})]))]),Lt("* => inverse",[Rt("200ms ease",sn([et({transform:"scale3d(1.0, 1.0, 1.0)",offset:0}),et({transform:"scale3d(0.6, 1.2, 1.2)",offset:.5}),et({transform:"scale3d(0, 0.75, 0.75)",offset:.75}),et({transform:"scale3d(0.5, 1.125, 1.125)",offset:.875}),et({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])]),Sn("bounceInOut",[Lt("void => *",[Rt("600ms ease",sn([et({transform:"scale3d(0, 0, 0)",offset:0}),et({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),et({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),et({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),et({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Lt("* => void",[Rt(100,et({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),t})();function Gee(t,n){if(1&t&&(Q(0,"div",8),ot(1,"div",9),Et(2,"safe"),ie()),2&t){const e=_e();Qe("opacity",e.isFront?1:.8)("transform",e.isFront?"":"scale(0.9)"),re("@flipOpen",void 0),U(1),Qe("font-size",e.fontSize+9,"px")("color",e.color)("text-shadow",e.textShadowCss),re("@inverse",e.state)("innerHTML",Tt(2,13,e.rubiedText,"html"),Yi)}}function qee(t,n){if(1&t&&(ot(0,"img",10),Et(1,"safe")),2&t){const e=_e();re("@inverse",e.state)("src",Tt(1,2,e.isFront?e.frontImage.url:e.backImage.url,"resourceUrl"),en)}}const Wee=function(t,n){return{"background-color":t,transform:n}};function Kee(t,n){if(1&t&&(Q(0,"div",11)(1,"span",12)(2,"b"),ye(3),ie()()()),2&t){const e=_e();re("ngStyle",Yt(2,Wee,e.ownerColor,"translateY(-75%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),U(3),Xe(e.ownerName)}}function Yee(t,n){1&t&&(ot(0,"img",13),Et(1,"safe")),2&t&&re("src",Tt(1,1,_e().frontImage.url,"resourceUrl"),en)}function Zee(t,n){if(1&t&&(Ke(0),Q(1,"div",14)(2,"i",15),ye(3),ie()(),Q(4,"div",16)(5,"i",15),ye(6),ie()(),Q(7,"div",17)(8,"i",15),ye(9),ie()(),Q(10,"div",18)(11,"i",15),ye(12),ie()(),ot(13,"div",19),Ye()),2&t){const e=_e();U(3),Xe(e.isLocked?"lock":"autorenew"),U(3),Xe(e.isLocked?"lock":"autorenew"),U(3),Xe(e.isLocked?"lock":"autorenew"),U(3),Xe(e.isLocked?"lock":"autorenew")}}const Xee=function(t){return{"is-grab":t}};let Qee=(()=>{class t{constructor(e,i,r,s,o,a,h,w,X,fe){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.elementRef=s,this.changeDetector=o,this.tabletopService=a,this.imageService=h,this.pointerDeviceService=w,this.modalService=X,this.chatMessageService=fe,this.card=null,this.is3D=!1,this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null}get name(){return this.card.name}get state(){return this.card.state}set state(e){this.card.state=e}get rotate(){return this.card.rotate}set rotate(e){this.card.rotate=e}get owner(){return this.card.owner}set owner(e){this.card.owner=e}get zindex(){return this.card.zindex}get size(){return this.adjustMinBounds(this.card.size)}get fontSize(){return this.card.fontsize}set fontSize(e){this.card.fontsize=e}get text(){return this.card.text}set text(e){this.card.text=e}get color(){return this.card.color}set color(e){this.card.color=e}get textShadowCss(){const e=rt.textShadowColor(this.color);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}get isHand(){return this.card.isHand}get isFront(){return this.card.isFront}get isVisible(){return this.card.isVisible}get hasOwner(){return this.card.hasOwner}get ownerIsOnline(){return this.card.ownerIsOnline}get ownerName(){return this.card.ownerName}get ownerColor(){return this.card.ownerColor}get isGMMode(){return this.card.isGMMode}get imageFile(){return this.imageService.getSkeletonOr(this.card.imageFile)}get frontImage(){return this.imageService.getSkeletonOr(this.card.frontImage)}get backImage(){return this.imageService.getSkeletonOr(this.card.backImage)}get isIconHidden(){return null!=this.iconHiddenTimer}get rubiedText(){return rt.rubyToHtml(rt.escapeHtml(this.text))}get isLocked(){return!!this.card&&this.card.isLocked}set isLocked(e){this.card&&(this.card.isLocked=e)}ngOnInit(){ze.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=dt.instance.get(e.data.identifier);!this.card||!i||(this.card===i||i instanceof Vn&&this.card.contains(i)||i instanceof We&&i.userId===this.card.owner)&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=We.findByPeerId(e.data.peerId);(!i||this.card.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.card,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain","text-note"]},this.rotableOption={tabletopObject:this.card}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new js(this.elementRef.nativeElement)}),this.input.onStart=e=>this.ngZone.run(()=>this.onInputStart(e))}ngOnDestroy(){this.input.destroy(),ze.unregister(this)}onCardDrop(e){if(this.card!==e.detail&&(e.detail instanceof zn||e.detail instanceof Kn)&&(e.stopPropagation(),e.preventDefault(),e.detail instanceof Kn)){if(this.isLocked)return;let i=e.detail;(i.location.x-this.card.location.x)**2+(i.location.y-this.card.location.y)**2+(i.posZ-this.card.posZ)**2<625&&(i.location.x=this.card.location.x,i.location.y=this.card.location.y,i.posZ=this.card.posZ,i.putOnBottom(this.card),this.isLocked=!1)}}startDoubleClickTimer(e){if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(()=>this.stopDoubleClickTimer(),e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}stopDoubleClickTimer(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}onDoubleClick(){if(!this.isLocked&&(this.stopDoubleClickTimer(),(this.doubleClickPoint.x-this.input.pointer.x)**2+(this.doubleClickPoint.y-this.input.pointer.y)**2<100)){if(console.log("onDoubleClick !!!!"),this.ownerIsOnline&&!this.isHand)return;this.state=this.isVisible&&!this.isHand?Cs.BACK:Cs.FRONT,this.owner="",this.state===Cs.FRONT&&this.chatMessageService.sendOperationLog((""==this.card.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.card.name)+" \u3092\u516c\u958b"),pt.play(tt.cardDraw)}}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.startDoubleClickTimer(e),this.card.toTopmost(),this.startIconHiddenTimer(),this.isLocked&&ze.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,pt.play(tt.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,pt.play(tt.lock)}},kt,!this.isVisible||this.isHand?{name:this.isHand?"\u8868\u5411\u304d\u3067\u51fa\u3059\uff08\u516c\u958b\u3059\u308b\uff09":this.ownerIsOnline?"\u8868\u306b\u3059\u308b\uff08\u516c\u958b\u3059\u308b\uff09":"\u8868\u306b\u3059\u308b",action:()=>{this.card.faceUp(),this.chatMessageService.sendOperationLog((""==this.card.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.card.name)+" \u3092\u516c\u958b"),pt.play(tt.cardDraw)},default:!this.isLocked&&(!this.ownerIsOnline||this.isHand)}:{name:"\u88cf\u306b\u3059\u308b",action:()=>{this.card.faceDown(),pt.play(tt.cardDraw)},default:!this.card.isLocked&&(!this.ownerIsOnline||this.isHand)},this.isHand?{name:"\u88cf\u5411\u304d\u3067\u51fa\u3059",action:()=>{this.card.faceDown(),pt.play(tt.cardDraw)}}:{name:"\u81ea\u5206\u3060\u3051\u898b\u308b\uff08\u624b\u672d\u306b\u3059\u308b\uff09",action:()=>{pt.play(tt.cardDraw),this.chatMessageService.sendOperationLog(`${this.card.isFront?""==this.card.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.card.name:"(\u4f0f\u305b\u305f\u30ab\u30fc\u30c9)"} \u3092\u81ea\u5206\u3060\u3051\u898b\u305f`),this.card.faceDown(),this.owner=xt.peerContext.userId}},kt,{name:"\u91cd\u306a\u3063\u305f\u30ab\u30fc\u30c9\u3067\u5c71\u672d\u3092\u4f5c\u308b",action:()=>{this.createStack(),pt.play(tt.cardPut)},disabled:this.isLocked},kt,{name:"\u30ab\u30fc\u30c9\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.card)}},this.isVisible&&this.card.getUrls().length>0?{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.card.getUrls().map(r=>{const s=r.value.toString();return{name:r.name?r.name:s,action:()=>{rt.sameOrigin(s)?window.open(s.trim(),"_blank","noopener"):this.modalService.open(qr,{url:s,title:this.card.name,subTitle:r.name})},disabled:!rt.validUrl(s),error:rt.validUrl(s)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:rt.validUrl(s)&&!rt.sameOrigin(s)}})}:null,this.isVisible&&this.card.getUrls().length>0?kt:null,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.card.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.toTopmost(),r.isLocked=!1,pt.play(tt.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.card.destroy(),pt.play(tt.sweep)}}],this.isVisible?this.name:"\u30ab\u30fc\u30c9")}onMove(){this.input.cancel(),pt.play(tt.cardPick)}onMoved(){pt.play(tt.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}createStack(){let e=this.tabletopService.cards.filter(r=>(r.location.x-this.card.location.x)**2+(r.location.y-this.card.location.y)**2+(r.posZ-this.card.posZ)**2<1e4&&!r.isLocked);if(0==e.length)return;let i=Kn.create("\u5c71\u672d");i.location.x=this.card.location.x,i.location.y=this.card.location.y,i.posZ=this.card.posZ,i.location.name=this.card.location.name,i.rotate=this.rotate,i.zindex=this.card.zindex,e.sort((r,s)=>r.zindex<s.zindex?1:r.zindex>s.zindex?-1:0);for(let r of e)i.putOnBottom(r)}dispatchCardDropEvent(){console.log("dispatchCardDropEvent");let r=this.elementRef.nativeElement.parentElement.children,s=new CustomEvent("carddrop",{detail:this.card,bubbles:!0});for(let o=0;o<r.length;o++)r[o].dispatchEvent(s)}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){ze.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(r+=" - "+(this.isVisible?e.name:"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09")),this.panelService.open(Ws,{title:r,left:i.x-300,top:i.y-300,width:600,height:490}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(He(Cn),He(lr),He(An),He(yi),He(Oi),He(vu),He(wu),He(fi),He(Fn),He(kr))},t.\u0275cmp=Xt({type:t,selectors:[["card"]],hostBindings:function(e,i){1&e&&Ae("carddrop",function(s){return i.onCardDrop(s)})("dragstart",function(s){return i.onDragstart(s)})("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{card:"card",is3D:"is3D"},decls:8,vars:15,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],[1,"is-pointer-events-none","is-3d"],["appRotable","",1,"component-content","is-pointer-events-auto","is-3d",3,"rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],["class","text is-3d","style","width: 100%; height: 100%",3,"opacity","transform",4,"ngIf"],["class","card-image is-3d chrome-smooth-image-trick",3,"src",4,"ngIf"],["class","name-tag is-nowrap has-length-limit is-black-background is-3d",3,"ngStyle",4,"ngIf"],["class","card-image thumbnail-transform is-translucent is-3d chrome-smooth-image-trick",3,"src",4,"ngIf"],[4,"ngIf"],[1,"text","is-3d",2,"width","100%","height","100%"],[1,"is-3d",3,"innerHTML"],[1,"card-image","is-3d","chrome-smooth-image-trick",3,"src"],[1,"name-tag","is-nowrap","has-length-limit","is-black-background","is-3d",3,"ngStyle"],[1,"is-3d"],[1,"card-image","thumbnail-transform","is-translucent","is-3d","chrome-smooth-image-trick",3,"src"],[1,"rotate-grab","of-left-top","is-3d"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","is-3d"],[1,"rotate-grab","of-right-bottom","is-3d"],[1,"rotate-grab","of-right-top","is-3d"],[1,"border-bg","is-pointer-events-none","is-3d"]],template:function(e,i){1&e&&(Q(0,"div",0),Ae("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),Q(1,"div",1)(2,"div",2),Ae("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Te(3,Gee,3,16,"div",3),Te(4,qee,2,5,"img",4),Te(5,Kee,4,5,"div",5),Te(6,Yee,2,4,"img",6),Te(7,Zee,14,4,"ng-container",7),ie()()()),2&e&&(Qe("width",i.size*i.gridSize,"px"),re("ngClass",ft(13,Xee,!i.isLocked))("movable.option",i.movableOption)("movable.disable",i.isLocked),U(1),re("@slidInOut",void 0),U(1),re("rotable.option",i.rotableOption)("rotable.disable",i.isLocked),U(1),re("ngIf",i.isFront||i.isHand||i.isGMMode),U(1),re("ngIf",i.imageFile),U(1),re("ngIf",!i.isFront&&i.ownerIsOnline&&0<i.ownerName.length),U(1),re("ngIf",!i.isFront&&(i.isHand||i.isGMMode)&&i.frontImage),U(1),re("ngIf",!i.isIconHidden))},directives:[sl,Yn,tc,bn,Ji],pipes:[ai],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:auto;width:auto;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;min-width:25px;min-height:25px}.component-content[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;height:100%;width:100%;box-sizing:border-box}.card-image[_ngcontent-%COMP%]{display:block;inset:0;margin:auto;height:auto;width:100%}.thumbnail-transform[_ngcontent-%COMP%]{position:absolute;transform:scale(.9)}.is-translucent[_ngcontent-%COMP%]{filter:opacity(.8)}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;z-index:11}.rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-10px;left:-10px;border-radius:14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-10px;left:-10px;border-radius:14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-10px;right:-10px;border-radius:14px}.of-right-top[_ngcontent-%COMP%]{top:-10px;right:-10px;border-radius:14px}.border-bg[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;border-radius:8px;background-color:#cccccc80;inset:-2px;z-index:-1}.border-bg[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .border-bg[_ngcontent-%COMP%]{display:block}.component[_ngcontent-%COMP%]:active   .border-bg[_ngcontent-%COMP%]{display:none}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:0;color:#f5f5f5!important;opacity:.9;z-index:10}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.text[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}"],data:{animation:[Sn("inverse",[ap("inverse",et({transform:""})),Lt(":increment, :decrement",[Rt("200ms ease",sn([et({transform:"scale3d(1.0, 1.0, 1.0)",offset:0}),et({transform:"scale3d(0.6, 1.2, 1.2)",offset:.5}),et({transform:"scale3d(0, 0.75, 0.75)",offset:.75}),et({transform:"scale3d(0.5, 1.125, 1.125)",offset:.875}),et({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])]),Sn("flipOpen",[Lt(":enter",[Rt("200ms ease",sn([et({transform:"scale3d(0, 1.0, 1.0)",offset:0}),et({transform:"scale3d(0, 1.2, 1.2)",offset:.5}),et({transform:"scale3d(0, 0.75, 0.75)",offset:.75}),et({transform:"scale3d(0.5, 1.125, 1.125)",offset:.875}),et({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])]),Sn("slidInOut",[Lt("void => *",[Rt("200ms ease",sn([et({"transform-origin":"left center",transform:"scale3d(0, 1.0, 1.0)",offset:0}),et({"transform-origin":"left center",transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Lt("* => void",[Rt(100,et({"transform-origin":"left center",transform:"scale3d(0, 1.0, 1.0)"}))])])]},changeDetection:0}),t})();class bf{constructor(n,e,i){this.canvasElement=n,this.canvasElementRange=e,this.canvasElementCenter=i}makeBrush(n,e,i){n.strokeStyle=i,n.fillStyle=n.strokeStyle,n.lineWidth=1;let r=Math.floor(e/5);return n.font=`bold ${r}px sans-serif`,n.textBaseline="top",n.textAlign="center",n}chkOuterProduct(n,e,i,r,s,o){return(i-n)*(o-e)-(r-e)*(s-n)>=-.01}chkInCircle(n,e,i){return n*n>=e*e+i*i}renderCircle(n){let e=n.gridSize,i=n.areaWidth*e/2,r=n.areaHeight*e/2,o=(Math,-n.centerX%e),a=-n.centerY%e;o>0&&(o-=e),a>0&&(a-=e),n.offSetX&&(o<-.5?o+=e/2:o-=e/2),n.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=n.areaWidth*e,this.canvasElement.height=n.areaHeight*e;let h=this.canvasElement.getContext("2d"),w=0,X=0,fe=this.generateCalcGridPositionFunc(n.gridType,n.centerX,n.centerY,n.areaWidth,n.areaHeight);if(0==n.fillType)this.makeBrush(h,e,n.gridColor),h.beginPath(),h.arc(i,r,n.range*e,0,2*Math.PI,!0),h.fill();else{this.makeBrush(h,e,n.gridColor);for(let pe=0;pe<=n.areaHeight+1;pe++)for(let we=0;we<=n.areaWidth+1;we++){let{gx:Ie,gy:Pe}=fe(we,pe,e);if(1==n.fillType)w=Ie+o+e/2-i,X=Pe+a+e/2-r,this.chkInCircle(n.range*e,w,X)&&this.fillSquare(h,Ie+o,Pe+a,e);else{let Be=0;for(let Le=0;Le<e;Le++)for(let Fe=0;Fe<e;Fe++)w=Ie+o+Le-i+.5,X=Pe+a+Fe-r+.5,this.chkInCircle(n.range*e,w,X)&&Be++;(2==n.fillType&&Be>=1||3==n.fillType&&Be>=e*e/2||4==n.fillType&&Be>=e*e)&&this.fillSquare(h,Ie+o,Pe+a,e)}}}this.canvasElementRange.width=n.areaWidth*e,this.canvasElementRange.height=n.areaHeight*e,h=this.canvasElementRange.getContext("2d"),this.makeBrush(h,e,n.rangeColor),h.beginPath(),h.lineWidth=2,h.arc(i,r,n.range*e,0,2*Math.PI,!0),h.stroke(),n.isDocking?(h.beginPath(),h.strokeRect(i-6,r-6,12,12)):(h.beginPath(),h.arc(i,i,5,0,2*Math.PI,!0),h.fill()),this.canvasElementCenter.width=n.areaWidth*e,this.canvasElementCenter.height=n.areaHeight*e,h=this.canvasElementCenter.getContext("2d"),this.makeBrush(h,e,n.rangeColor),n.isDocking?(h.beginPath(),h.strokeRect(i-6,r-6,12,12)):(h.beginPath(),h.arc(i,i,5,0,2*Math.PI,!0),h.fill())}renderLine(n){let e=n.gridSize,i=n.areaWidth*e/2,r=n.areaHeight*e/2,s=Math.PI/180*n.degree,o=-n.centerX%e,a=-n.centerY%e;o>0&&(o-=e),a>0&&(a-=e),n.offSetX&&(o<-.5?o+=e/2:o-=e/2),n.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=n.areaWidth*e,this.canvasElement.height=n.areaHeight*e;let h=this.canvasElement.getContext("2d"),X=.5*n.width*e,pe=-.5*n.width*e,we=n.range*e,Ie=-.5*n.width*e,Pe=n.range*e,Be=.5*n.width*e,Le=0-e*Math.sqrt(2),Fe=X+e*Math.sqrt(2),Ve=0-e*Math.sqrt(2),Ge=pe-e*Math.sqrt(2),ct=we+e*Math.sqrt(2),ut=Ie-e*Math.sqrt(2),st=Pe+e*Math.sqrt(2),yt=Be+e*Math.sqrt(2),nt=0*Math.cos(s)-X*Math.sin(s),lt=0*Math.sin(s)+X*Math.cos(s),gt=0*Math.cos(s)-pe*Math.sin(s),Vt=0*Math.sin(s)+pe*Math.cos(s),Ht=we*Math.cos(s)-Ie*Math.sin(s),dn=we*Math.sin(s)+Ie*Math.cos(s),Pn=Pe*Math.cos(s)-Be*Math.sin(s),wt=Pe*Math.sin(s)+Be*Math.cos(s),It={clip01x:Le*Math.cos(s)-Fe*Math.sin(s),clip01y:Le*Math.sin(s)+Fe*Math.cos(s),clip02x:Ve*Math.cos(s)-Ge*Math.sin(s),clip02y:Ve*Math.sin(s)+Ge*Math.cos(s),clip03x:ct*Math.cos(s)-ut*Math.sin(s),clip03y:ct*Math.sin(s)+ut*Math.cos(s),clip04x:st*Math.cos(s)-yt*Math.sin(s),clip04y:st*Math.sin(s)+yt*Math.cos(s)},St=0,Ot=0,$n=this.generateCalcGridPositionFunc(n.gridType,n.centerX,n.centerY,n.areaWidth,n.areaHeight);if(this.makeBrush(h,e,n.gridColor),0==n.fillType)this.makeBrush(h,e,n.gridColor),h.beginPath(),h.moveTo(nt+i,lt+r),h.lineTo(gt+i,Vt+r),h.lineTo(Ht+i,dn+r),h.lineTo(Pn+i,wt+r),h.lineTo(nt+i,lt+r),h.fill();else{this.makeBrush(h,e,n.gridColor);for(let jn=0;jn<=n.areaHeight+1;jn++)for(let Wn=0;Wn<=n.areaWidth+1;Wn++){let{gx:bi,gy:kn}=$n(Wn,jn,e);if(1==n.fillType)St=bi+o+e/2-i,Ot=kn+a+e/2-r,this.chkOuterProduct(nt,lt,gt,Vt,St,Ot)&&this.chkOuterProduct(gt,Vt,Ht,dn,St,Ot)&&this.chkOuterProduct(Ht,dn,Pn,wt,St,Ot)&&this.chkOuterProduct(Pn,wt,nt,lt,St,Ot)&&this.fillSquare(h,bi+o,kn+a,e);else{let vt=0;for(let nc=0;nc<e;nc++)for(let Di=0;Di<e;Di++)St=bi+o+nc-i+.5,Ot=kn+a+Di-r+.5,this.chkOuterProduct(nt,lt,gt,Vt,St,Ot)&&this.chkOuterProduct(gt,Vt,Ht,dn,St,Ot)&&this.chkOuterProduct(Ht,dn,Pn,wt,St,Ot)&&this.chkOuterProduct(Pn,wt,nt,lt,St,Ot)&&vt++;(2==n.fillType&&vt>=1||3==n.fillType&&vt>=e*e/2||4==n.fillType&&vt>=e*e)&&this.fillSquare(h,bi+o,kn+a,e)}}}return this.canvasElementRange.width=n.areaWidth*e,this.canvasElementRange.height=n.areaHeight*e,h=this.canvasElementRange.getContext("2d"),this.makeBrush(h,e,n.rangeColor),h.beginPath(),h.lineWidth=2,h.moveTo(nt+i,lt+r),h.lineTo(gt+i,Vt+r),h.lineTo(Ht+i,dn+r),h.lineTo(Pn+i,wt+r),h.lineTo(nt+i,lt+r),h.stroke(),h.beginPath(),h.arc(i,i,5,0,2*Math.PI,!0),h.fill(),this.canvasElementCenter.width=n.areaWidth*e,this.canvasElementCenter.height=n.areaHeight*e,h=this.canvasElementCenter.getContext("2d"),this.makeBrush(h,e,n.rangeColor),h.beginPath(),h.arc(i,i,5,0,2*Math.PI,!0),h.fill(),It}static gripAreaPathLine(n){let e=n.gridSize,i=Math.PI/180*n.degree,we=.5*n.width*e,Pe=-.5*n.width*e,Be=n.range*e,Le=-.5*n.width*e,Fe=n.range*e,Ve=.5*n.width*e;return{clip01x:0*Math.cos(i)-we*Math.sin(i),clip01y:0*Math.sin(i)+we*Math.cos(i),clip02x:0*Math.cos(i)-Pe*Math.sin(i),clip02y:0*Math.sin(i)+Pe*Math.cos(i),clip03x:Be*Math.cos(i)-Le*Math.sin(i),clip03y:Be*Math.sin(i)+Le*Math.cos(i),clip04x:Fe*Math.cos(i)-Ve*Math.sin(i),clip04y:Fe*Math.sin(i)+Ve*Math.cos(i)}}renderSquare(n){let e=n.gridSize,i=n.areaWidth*e/2,r=n.areaHeight*e/2,o=(Math,-n.centerX%e),a=-n.centerY%e;o>0&&(o-=e),a>0&&(a-=e),n.offSetX&&(o<-.5?o+=e/2:o-=e/2),n.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=n.areaWidth*e,this.canvasElement.height=n.areaHeight*e;let h=this.canvasElement.getContext("2d"),w=-n.range*e,X=n.range*e,fe=-n.range*e,pe=-n.range*e,we=n.range*e,Ie=-n.range*e,Pe=n.range*e,Be=n.range*e,nt={clip01x:w-1*e,clip01y:X+1*e,clip02x:fe-1*e,clip02y:pe-1*e,clip03x:we+1*e,clip03y:Ie-1*e,clip04x:Pe+1*e,clip04y:Be+1*e},lt=0,gt=0,Vt=this.generateCalcGridPositionFunc(n.gridType,n.centerX,n.centerY,n.areaWidth,n.areaHeight);if(this.makeBrush(h,e,n.gridColor),0==n.fillType)this.makeBrush(h,e,n.gridColor),h.beginPath(),h.moveTo(w+i,X+r),h.lineTo(fe+i,pe+r),h.lineTo(we+i,Ie+r),h.lineTo(Pe+i,Be+r),h.lineTo(w+i,X+r),h.fill();else{this.makeBrush(h,e,n.gridColor);for(let Ht=0;Ht<=n.areaHeight+1;Ht++)for(let dn=0;dn<=n.areaWidth+1;dn++){let{gx:Pn,gy:wt}=Vt(dn,Ht,e);if(1==n.fillType)lt=Pn+o+e/2-i,gt=wt+a+e/2-r,this.chkOuterProduct(w,X,fe,pe,lt,gt)&&this.chkOuterProduct(fe,pe,we,Ie,lt,gt)&&this.chkOuterProduct(we,Ie,Pe,Be,lt,gt)&&this.chkOuterProduct(Pe,Be,w,X,lt,gt)&&this.fillSquare(h,Pn+o,wt+a,e);else{let It=0;for(let St=0;St<e;St++)for(let Ot=0;Ot<e;Ot++)lt=Pn+o+St-i+.5,gt=wt+a+Ot-r+.5,this.chkOuterProduct(w,X,fe,pe,lt,gt)&&this.chkOuterProduct(fe,pe,we,Ie,lt,gt)&&this.chkOuterProduct(we,Ie,Pe,Be,lt,gt)&&this.chkOuterProduct(Pe,Be,w,X,lt,gt)&&It++;(2==n.fillType&&It>=1||3==n.fillType&&It>=e*e/2||4==n.fillType&&It>=e*e)&&this.fillSquare(h,Pn+o,wt+a,e)}}}return this.canvasElementRange.width=n.areaWidth*e,this.canvasElementRange.height=n.areaHeight*e,h=this.canvasElementRange.getContext("2d"),this.makeBrush(h,e,n.rangeColor),h.beginPath(),h.lineWidth=2,h.moveTo(w+i,X+r),h.lineTo(fe+i,pe+r),h.lineTo(we+i,Ie+r),h.lineTo(Pe+i,Be+r),h.lineTo(w+i,X+r),h.stroke(),n.isDocking?(h.beginPath(),h.strokeRect(i-6,r-6,12,12)):(h.beginPath(),h.arc(i,i,5,0,2*Math.PI,!0),h.fill()),this.canvasElementCenter.width=n.areaWidth*e,this.canvasElementCenter.height=n.areaHeight*e,h=this.canvasElementCenter.getContext("2d"),this.makeBrush(h,e,n.rangeColor),n.isDocking?(h.beginPath(),h.strokeRect(i-6,r-6,12,12)):(h.beginPath(),h.arc(i,i,5,0,2*Math.PI,!0),h.fill()),nt}static gripAreaPathSquare(n){let e=n.gridSize;return Math,{clip01x:-n.range*e,clip01y:n.range*e,clip02x:-n.range*e,clip02y:-n.range*e,clip03x:n.range*e,clip03y:-n.range*e,clip04x:n.range*e,clip04y:n.range*e}}renderDiamond(n){let e=n.gridSize,i=n.areaWidth*e/2,r=n.areaHeight*e/2,s=-n.centerX%e,o=-n.centerY%e;s>0&&(s-=e),o>0&&(o-=e),n.offSetX&&(s<-.5?s+=e/2:s-=e/2),n.offSetY&&(o<-.5?o+=e/2:o-=e/2),this.canvasElement.width=n.areaWidth*e,this.canvasElement.height=n.areaHeight*e;let a=this.canvasElement.getContext("2d"),h=-n.range*e,fe=-n.range*e,pe=n.range*e,Pe=n.range*e,yt={clip01x:h-2*e,clip01y:0,clip02x:0,clip02y:fe-2*e,clip03x:pe+2*e,clip03y:0,clip04x:0,clip04y:Pe+2*e},nt=0,lt=0,gt=this.generateCalcGridPositionFunc(n.gridType,n.centerX,n.centerY,n.areaWidth,n.areaHeight);if(this.makeBrush(a,e,n.gridColor),0==n.fillType)this.makeBrush(a,e,n.gridColor),a.beginPath(),a.moveTo(h+i,0+r),a.lineTo(0+i,fe+r),a.lineTo(pe+i,0+r),a.lineTo(0+i,Pe+r),a.lineTo(h+i,0+r),a.fill();else{this.makeBrush(a,e,n.gridColor);for(let Vt=0;Vt<=n.areaHeight+1;Vt++)for(let Ht=0;Ht<=n.areaWidth+1;Ht++){let{gx:dn,gy:Pn}=gt(Ht,Vt,e);if(1==n.fillType)nt=dn+s+e/2-i,lt=Pn+o+e/2-r,this.chkOuterProduct(h,0,0,fe,nt,lt)&&this.chkOuterProduct(0,fe,pe,0,nt,lt)&&this.chkOuterProduct(pe,0,0,Pe,nt,lt)&&this.chkOuterProduct(0,Pe,h,0,nt,lt)&&this.fillSquare(a,dn+s,Pn+o,e);else{let wt=0;for(let It=0;It<e;It++)for(let St=0;St<e;St++)nt=dn+s+It-i+.5,lt=Pn+o+St-r+.5,this.chkOuterProduct(h,0,0,fe,nt,lt)&&this.chkOuterProduct(0,fe,pe,0,nt,lt)&&this.chkOuterProduct(pe,0,0,Pe,nt,lt)&&this.chkOuterProduct(0,Pe,h,0,nt,lt)&&wt++;(2==n.fillType&&wt>=1||3==n.fillType&&wt>=e*e/2||4==n.fillType&&wt>=e*e)&&this.fillSquare(a,dn+s,Pn+o,e)}}}return this.canvasElementRange.width=n.areaWidth*e,this.canvasElementRange.height=n.areaHeight*e,a=this.canvasElementRange.getContext("2d"),this.makeBrush(a,e,n.rangeColor),a.beginPath(),a.lineWidth=2,a.moveTo(h+i,0+r),a.lineTo(0+i,fe+r),a.lineTo(pe+i,0+r),a.lineTo(0+i,Pe+r),a.lineTo(h+i,0+r),a.stroke(),n.isDocking?(a.beginPath(),a.strokeRect(i-6,r-6,12,12)):(a.beginPath(),a.arc(i,i,5,0,2*Math.PI,!0),a.fill()),this.canvasElementCenter.width=n.areaWidth*e,this.canvasElementCenter.height=n.areaHeight*e,a=this.canvasElementCenter.getContext("2d"),this.makeBrush(a,e,n.rangeColor),n.isDocking?(a.beginPath(),a.strokeRect(i-6,r-6,12,12)):(a.beginPath(),a.arc(i,i,5,0,2*Math.PI,!0),a.fill()),yt}static gripAreaPathDiamond(n){let e=n.gridSize;return{clip01x:-n.range*e,clip01y:0,clip02x:0,clip02y:-n.range*e,clip03x:n.range*e,clip03y:0,clip04x:0,clip04y:n.range*e}}renderCorn(n){let e=n.gridSize,i=n.areaWidth*e/2,r=n.areaHeight*e/2,s=Math.PI/180*n.degree,o=-n.centerX%e,a=-n.centerY%e;o>0&&(o-=e),a>0&&(a-=e),n.offSetX&&(o<-.5?o+=e/2:o-=e/2),n.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=n.areaWidth*e,this.canvasElement.height=n.areaHeight*e;let h=this.canvasElement.getContext("2d"),fe=n.range*e,pe=-.5*n.width*e,we=n.range*e,Ie=.5*n.width*e,Pe=0-e*Math.sqrt(2),Le=0-e*Math.sqrt(2),Fe=0-e*Math.sqrt(2),Ve=fe-e*Math.sqrt(2),Ge=pe-e*Math.sqrt(2),ct=fe,ut=pe-e*Math.sqrt(2),st=fe+e*Math.sqrt(2),yt=pe-e*Math.sqrt(2),nt=st,lt=-yt,gt=ct,Vt=-ut,Ht=Ve,dn=-Ge,Pn=Le,wt=-Fe,Ot=fe*Math.cos(s)-pe*Math.sin(s),$n=fe*Math.sin(s)+pe*Math.cos(s),jn=we*Math.cos(s)-Ie*Math.sin(s),Wn=we*Math.sin(s)+Ie*Math.cos(s),bi={clip01x:Pe*Math.cos(s)-0*Math.sin(s),clip01y:Pe*Math.sin(s)+0*Math.cos(s),clip02x:Le*Math.cos(s)-Fe*Math.sin(s),clip02y:Le*Math.sin(s)+Fe*Math.cos(s),clip03x:Ve*Math.cos(s)-Ge*Math.sin(s),clip03y:Ve*Math.sin(s)+Ge*Math.cos(s),clip04x:ct*Math.cos(s)-ut*Math.sin(s),clip04y:ct*Math.sin(s)+ut*Math.cos(s),clip05x:st*Math.cos(s)-yt*Math.sin(s),clip05y:st*Math.sin(s)+yt*Math.cos(s),clip06x:nt*Math.cos(s)-lt*Math.sin(s),clip06y:nt*Math.sin(s)+lt*Math.cos(s),clip07x:gt*Math.cos(s)-Vt*Math.sin(s),clip07y:gt*Math.sin(s)+Vt*Math.cos(s),clip08x:Ht*Math.cos(s)-dn*Math.sin(s),clip08y:Ht*Math.sin(s)+dn*Math.cos(s),clip09x:Pn*Math.cos(s)-wt*Math.sin(s),clip09y:Pn*Math.sin(s)+wt*Math.cos(s)},kn=0,vt=0,nc=this.generateCalcGridPositionFunc(n.gridType,n.centerX,n.centerY,n.areaWidth,n.areaHeight);if(0==n.fillType)this.makeBrush(h,e,n.gridColor),h.beginPath(),h.moveTo(0+i,0+r),h.lineTo(Ot+i,$n+r),h.lineTo(jn+i,Wn+r),h.lineTo(0+i,0+r),h.fill();else{this.makeBrush(h,e,n.gridColor);for(let Di=0;Di<=n.areaHeight+1;Di++)for(let $o=0;$o<=n.areaWidth+1;$o++){let{gx:xs,gy:Ys}=nc($o,Di,e);if(1==n.fillType)kn=xs+o+e/2-i,vt=Ys+a+e/2-r,this.chkOuterProduct(0,0,Ot,$n,kn,vt)&&this.chkOuterProduct(Ot,$n,jn,Wn,kn,vt)&&this.chkOuterProduct(jn,Wn,0,0,kn,vt)&&this.fillSquare(h,xs+o,Ys+a,e);else{let ol=0;for(let Pv=0;Pv<e;Pv++)for(let Nv=0;Nv<e;Nv++)kn=xs+o+Pv-i+.5,vt=Ys+a+Nv-r+.5,this.chkOuterProduct(0,0,Ot,$n,kn,vt)&&this.chkOuterProduct(Ot,$n,jn,Wn,kn,vt)&&this.chkOuterProduct(jn,Wn,0,0,kn,vt)&&ol++;(2==n.fillType&&ol>=1||3==n.fillType&&ol>=e*e/2||4==n.fillType&&ol>=e*e)&&this.fillSquare(h,xs+o,Ys+a,e)}}}return this.canvasElementRange.width=n.areaWidth*e,this.canvasElementRange.height=n.areaHeight*e,h=this.canvasElementRange.getContext("2d"),this.makeBrush(h,e,n.rangeColor),h.beginPath(),h.lineWidth=2,h.moveTo(0+i,0+r),h.lineTo(Ot+i,$n+r),h.lineTo(jn+i,Wn+r),h.lineTo(0+i,0+r),h.stroke(),h.beginPath(),h.arc(i,i,5,0,2*Math.PI,!0),h.fill(),this.canvasElementCenter.width=n.areaWidth*e,this.canvasElementCenter.height=n.areaHeight*e,h=this.canvasElementCenter.getContext("2d"),this.makeBrush(h,e,n.rangeColor),h.beginPath(),h.arc(i,i,5,0,2*Math.PI,!0),h.fill(),bi}static gripAreaPathCorn(n){let e=n.gridSize,i=Math.PI/180*n.degree,o=n.range*e,a=-.5*n.width*e,pe=o,we=a,Ie=o,Pe=a,Be=o,Le=a,Fe=Be,Ve=-Le,Ge=Ie,ct=-Pe,ut=pe,st=-we;return{clip01x:0*Math.cos(i)-0*Math.sin(i),clip01y:0*Math.sin(i)+0*Math.cos(i),clip02x:0*Math.cos(i)-0*Math.sin(i),clip02y:0*Math.sin(i)+0*Math.cos(i),clip03x:pe*Math.cos(i)-we*Math.sin(i),clip03y:pe*Math.sin(i)+we*Math.cos(i),clip04x:Ie*Math.cos(i)-Pe*Math.sin(i),clip04y:Ie*Math.sin(i)+Pe*Math.cos(i),clip05x:Be*Math.cos(i)-Le*Math.sin(i),clip05y:Be*Math.sin(i)+Le*Math.cos(i),clip06x:Fe*Math.cos(i)-Ve*Math.sin(i),clip06y:Fe*Math.sin(i)+Ve*Math.cos(i),clip07x:Ge*Math.cos(i)-ct*Math.sin(i),clip07y:Ge*Math.sin(i)+ct*Math.cos(i),clip08x:ut*Math.cos(i)-st*Math.sin(i),clip08y:ut*Math.sin(i)+st*Math.cos(i),clip09x:0*Math.cos(i)- -0*Math.sin(i),clip09y:0*Math.sin(i)+-0*Math.cos(i)}}generateCalcGridPositionFunc(n,e,i,r,s){switch(n){case Gs.HEX_VERTICAL:return(o,a,h)=>(o+(e%(2*h)<h?1:0)+(r%4==0?1:0))%2==1?{gx:o*h,gy:a*h}:{gx:o*h,gy:a*h+h/2};case Gs.HEX_HORIZONTAL:return(o,a,h)=>(a+(i%(2*h)<h?1:0)+(s%4==0?1:0))%2==1?{gx:o*h,gy:a*h}:{gx:o*h+h/2,gy:a*h};default:return(o,a,h)=>({gx:o*h,gy:a*h})}}fillSquare(n,e,i,r){n.beginPath(),n.fillRect(e,i,r,r)}strokeSquare(n,e,i,r){n.beginPath(),n.strokeStyle="#55555533",n.strokeRect(e,i,r,r)}strokeHex(n,e,i,r,s){let o=s===Gs.HEX_HORIZONTAL?-30:0,a=r/Math.sqrt(3),h=e+r/2,w=i+r/2;n.beginPath();for(let X=0;X<6;X++){o+=60;let fe=Math.PI/180*o,pe=Math.cos(fe)*a+h,we=Math.sin(fe)*a+w;n.lineTo(pe,we)}n.closePath(),n.stroke()}}const Jee=["gridCanvas"],ete=["rangeCanvas"],tte=["centerPunch"],nte=["rotate"];function ite(t,n){if(1&t&&(Q(0,"div",15)(1,"i",16),ye(2),ie()()),2&t){const e=_e();U(2),Xe(e.isLocked?"lock":"open_with")}}function rte(t,n){if(1&t&&(Ke(0),Q(1,"div",21)(2,"i",16),ye(3),ie()(),Ye()),2&t){const e=n.$implicit,i=_e(2);U(1),Qe("left",i.math.ceil((e-.3)*i.gridSize),"px"),U(2),Xe(i.isLocked?"lock":"autorenew")}}function ste(t,n){if(1&t&&(Ke(0),Q(1,"div",17),Te(2,rte,4,3,"ng-container",18),Q(3,"div",19)(4,"i",16),ye(5),ie()(),Q(6,"div",20)(7,"i",16),ye(8),ie()()(),Ye()),2&t){const e=_e();U(2),re("ngForOf",e.rotateHandlesLeftPos),U(3),Xe(e.isLocked?"lock":"autorenew"),U(3),Xe(e.isLocked?"lock":"autorenew")}}const EI=function(t){return{transform:t}};function ote(t,n){if(1&t&&(Q(0,"div",22)(1,"div",23)(2,"span",24)(3,"i"),ye(4),ie()(),Q(5,"span",25)(6,"i"),ye(7),ie()()(),Q(8,"div",23)(9,"span",26),ye(10),ie(),Q(11,"span",27),ye(12),ie()(),Q(13,"div",28)(14,"span",24)(15,"i"),ye(16),ie()(),Q(17,"span",25)(18,"i"),ye(19),ie()()()()),2&t){const e=_e();Qe("border-left-color",e.range.rangeColor)("height",e.math.abs(e.altitude*e.gridSize)-(e.altitude>0||!e.isFollowed?0:e.followingCharactor.chatBubbleAltitude+4),"px"),re("ngStyle",ft(40,EI,"rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),U(1),Qe("visibility",e.altitude>0?"visible":"hidden"),U(1),Qe("color",e.range.rangeColor)("text-shadow",e.textShadowCss),U(2),Xe(e.elevation),U(1),Qe("color",e.range.rangeColor)("text-shadow",e.textShadowCss),U(2),Xe(e.elevation),U(2),Qe("color",e.range.rangeColor)("text-shadow",e.textShadowCss),U(1),Xe(e.math.abs(e.altitude)),U(1),Qe("color",e.range.rangeColor)("text-shadow",e.textShadowCss),U(1),Xe(e.math.abs(e.altitude)),U(1),Qe("visibility",e.altitude<0?"visible":"hidden"),re("ngStyle",ft(42,EI,"translateY("+(e.isFollowed?e.followingCharactor.chatBubbleAltitude+4:0)+"px)")),U(1),Qe("color",e.range.rangeColor)("text-shadow",e.textShadowCss),U(2),Xe(e.elevation),U(1),Qe("color",e.range.rangeColor)("text-shadow",e.textShadowCss),U(2),Xe(e.elevation)}}const ate=function(t){return{"is-grab":t}},lte=function(t){return{fall:t}};let cte=(()=>{class t{constructor(e,i,r,s,o,a,h,w,X,fe){this.ngZone=e,this.tabletopActionService=i,this.contextMenuService=r,this.elementRef=s,this.panelService=o,this.changeDetector=a,this.pointerDeviceService=h,this.coordinateService=w,this.tabletopService=X,this.modalService=fe,this.range=null,this.is3D=!1,this.clipAreaCorn={clip01x:0,clip01y:0,clip02x:100,clip02y:0,clip03x:100,clip03y:100,clip04x:0,clip04y:100,clip05x:0,clip05y:0,clip06x:0,clip06y:0,clip07x:0,clip07y:0,clip08x:0,clip08y:0,clip09x:0,clip09y:0},this.gripAreaCorn={clip01x:0,clip01y:0,clip02x:100,clip02y:0,clip03x:100,clip03y:100,clip04x:0,clip04y:100,clip05x:0,clip05y:0,clip06x:0,clip06y:0,clip07x:0,clip07y:0,clip08x:0,clip08y:0,clip09x:0,clip09y:0},this.clipAreaLine={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.gripAreaLine={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.clipAreaSquare={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.gripAreaSquare={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.clipAreaDiamond={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.gripAreaDiamond={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.gridSize=50,this.movableOption={},this.rotableOption={},this.viewRotateZ=10,this.isMoving=!1,this.math=Math,this.input=null}get clipPathText(){let e="";switch(this.range.type){case"LINE":e=this.clipLine;break;case"CIRCLE":e=this.clipCircle;break;case"SQUARE":e=this.clipSquare;break;case"DIAMOND":e=this.clipDiamond;break;default:e=this.clipCorn}return e}get gripPathText(){let e="";switch(this.range.type){case"LINE":e=this.gripLine;break;case"CIRCLE":e=this.gripCircle;break;case"SQUARE":e=this.gripSquare;break;case"DIAMOND":e=this.gripDiamond;break;default:e=this.gripCorn}return e}get clipCircle(){return"circle("+(this.rangeLength+1.5)*this.gridSize+"px)"}get gripCircle(){return"circle("+(this.rangeLength>1?this.rangeLength:1)*this.gridSize+"px)"}get clipCorn(){return this.clipCornPath(this.clipAreaCorn)}get gripCorn(){return this.clipCornPath(this.gripAreaCorn)}clipCornPath(e){let i="polygon("+e.clip01x+"px "+e.clip01y+"px, ";return i+=e.clip02x+"px "+e.clip02y+"px, ",i+=e.clip03x+"px "+e.clip03y+"px, ",i+=e.clip04x+"px "+e.clip04y+"px, ",i+=e.clip05x+"px "+e.clip05y+"px, ",i+=e.clip06x+"px "+e.clip06y+"px, ",i+=e.clip07x+"px "+e.clip07y+"px, ",i+=e.clip08x+"px "+e.clip08y+"px, ",i+=e.clip09x+"px "+e.clip09y+"px)",i}get clipLine(){return this.clipLinePath(this.clipAreaLine)}get gripLine(){return this.clipLinePath(this.gripAreaLine)}clipLinePath(e){let i="polygon("+e.clip01x+"px "+e.clip01y+"px, ";return i+=e.clip02x+"px "+e.clip02y+"px, ",i+=e.clip03x+"px "+e.clip03y+"px, ",i+=e.clip04x+"px "+e.clip04y+"px)",i}get clipSquare(){return this.clipSquarePath(this.clipAreaSquare)}get gripSquare(){return this.clipSquarePath(this.gripAreaSquare)}clipSquarePath(e){let i="polygon("+e.clip01x+"px "+e.clip01y+"px, ";return i+=e.clip02x+"px "+e.clip02y+"px, ",i+=e.clip03x+"px "+e.clip03y+"px, ",i+=e.clip04x+"px "+e.clip04y+"px)",i}get clipDiamond(){return this.clipDiamondPath(this.clipAreaDiamond)}get gripDiamond(){return this.clipDiamondPath(this.gripAreaDiamond)}clipDiamondPath(e){let i="polygon("+e.clip01x+"px "+e.clip01y+"px, ";return i+=e.clip02x+"px "+e.clip02y+"px, ",i+=e.clip03x+"px "+e.clip03y+"px, ",i+=e.clip04x+"px "+e.clip04y+"px)",i}get gripLength(){return this.rangeLength>1?this.rangeLength:1}get gripWidth(){return"CIRCLE"==this.range.type||"SQUARE"==this.range.type||"DIAMOND"==this.range.type?this.gripLength:this.range.width>this.gripLength?this.range.width:this.gripLength}get tableSelecter(){return this.tabletopService.tableSelecter}get currentTable(){return this.tabletopService.currentTable}get name(){return this.range.name}get width(){return this.adjustMinBounds(this.range.width)}get length(){return this.adjustMinBounds(this.range.length)}get opacity(){return this.range.opacity}get imageFile(){return this.range.imageFile}get isLocked(){return this.range.isLocked}set isLocked(e){this.range.isLocked=e}get areaQuadrantSize(){let e=this.width<1?1:this.width,i=this.rangeLength<1?1:this.rangeLength;return Math.ceil(Math.sqrt(e*e+i*i))+1}get rotateDeg(){let e="0.0";return this.rotate&&this.rotate.nativeElement&&this.rotate.nativeElement.style&&this.rotate.nativeElement.style.transform?(e=this.rotate.nativeElement.style.transform.replace(/[^0-9\.\-]/g,""),e||(e="0.0"),parseFloat(e)):0}get altitude(){return this.range.altitude}set altitude(e){this.range.altitude=e}get elevation(){return+((this.range.posZ+this.altitude*this.gridSize)/this.gridSize).toFixed(1)}get isAltitudeIndicate(){return this.range.isAltitudeIndicate}set isAltitudeIndicate(e){this.range.isAltitudeIndicate=e}get textShadowCss(){return`${rt.textShadowColor(this.range.rangeColor,"#f5f5f5")} 0px 0px 3px`}get followingCharactor(){return this.range.followingCharactor}set followingCharactor(e){this.range.followingCharactor=e}get isFollowed(){return this.followingCharactor&&this.followingCharactor.location.x<=this.range.location.x&&this.range.location.x<=this.followingCharactor.location.x+this.followingCharactor.size*this.gridSize&&this.followingCharactor.location.y<=this.range.location.y&&this.range.location.y<=this.followingCharactor.location.y+this.followingCharactor.size*this.gridSize&&this.followingCharactor.altitude+this.followingCharactor.posZ-.5<=this.range.altitude+this.range.posZ&&this.range.altitude+this.range.posZ<=this.followingCharactor.altitude+this.followingCharactor.posZ+.5}get dockableCharacters(){let e=this.tabletopService.characters.filter(i=>"table"===i.location.name&&!i.isHideIn&&[{x:0,y:0},{x:i.size*this.gridSize,y:0},{x:0,y:i.size*this.gridSize},{x:i.size*this.gridSize,y:i.size*this.gridSize}].some(r=>this.range.location.x-this.rangeLength*this.gridSize<=i.location.x+r.x&&i.location.x+r.x<=this.range.location.x+this.rangeLength*this.gridSize&&this.range.location.y-this.rangeLength*this.gridSize<=i.location.y+r.y&&i.location.y+r.y<=this.range.location.y+this.rangeLength*this.gridSize));return this.followingCharactor&&!e.some(i=>i===this.followingCharactor)&&e.push(this.followingCharactor),e.sort((i,r)=>i.name.localeCompare(r.name,"ja"))}get rangeLength(){let e=this.length<1?1:this.length;return this.followingCharactor&&this.range.isExpandByFollowing&&(e+=this.followingCharactor.size/2),e}get rotateHandlesLeftPos(){let e=[];for(let i=1;i<Math.ceil(this.rangeLength/6);i++)e.push(this.rangeLength*i/Math.ceil(this.rangeLength/6));return e.push(this.rangeLength),e}ngOnInit(){ze.register(this).on("UPDATE_GAME_OBJECT",-1e3,e=>{let i=dt.instance.get(e.data.identifier);if(!this.range||!i)return;let r=!1;(this.range===i||i instanceof Vn&&this.range.contains(i))&&(this.ngZone.run(()=>{this.setRange()}),r=!0),this.followingCharactor&&(i.identifier===this.followingCharactor.identifier||i instanceof Vn&&this.followingCharactor.contains(i))&&(this.ngZone.run(()=>{this.range.following(),this.setRange()}),r=!0),r&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",-1e3,e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.range,transformCssOffset:"translateZ(0.25px)",colideLayers:["terrain","text-note"]},this.rotableOption={tabletopObject:this.range},this.setRange()}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new js(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this),this.setRange(),queueMicrotask(()=>{this.changeDetector.markForCheck()})}ngOnDestroy(){this.input.destroy(),ze.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLocked&&ze.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate(),s=[];if(s.push(this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,pt.play(tt.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,pt.play(tt.lock)}}),s.push({name:"\u5f71\u97ff\u30b0\u30ea\u30c3\u30c9\u306e\u5224\u5b9a\u65b9\u6cd5",action:null,subActions:[{name:(0==this.range.fillType?"\u25c9":"\u25cb")+" \u5224\u5b9a\u306a\u3057 (\u8f2a\u90ed\u5185\u3092\u5857\u308a\u3064\u3076\u3059)",action:()=>{this.range.fillType=0}},kt,{name:(1==this.range.fillType?"\u25c9":"\u25cb")+" \u30b0\u30ea\u30c3\u30c9\u306e\u4e2d\u5fc3\u3092\u8986\u3046",action:()=>{this.range.fillType=1}},{name:(2==this.range.fillType?"\u25c9":"\u25cb")+" \u30b0\u30ea\u30c3\u30c9\u306e\u4e00\u90e8\u3067\u3082\u8986\u3046",action:()=>{this.range.fillType=2}},{name:(3==this.range.fillType?"\u25c9":"\u25cb")+" \u30b0\u30ea\u30c3\u30c9\u306e\u534a\u5206\u4ee5\u4e0a\u3092\u8986\u3046",action:()=>{this.range.fillType=3}},{name:(4==this.range.fillType?"\u25c9":"\u25cb")+" \u30b0\u30ea\u30c3\u30c9\u5168\u4f53\u3092\u8986\u3046",action:()=>{this.range.fillType=4}}]}),s.push(kt),"CIRCLE"==this.range.type||"SQUARE"==this.range.type||"DIAMOND"==this.range.type){let o=this.dockableCharacters.length<=0?this.followingCharactor?[]:[{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c\u3044\u307e\u305b\u3093",action:null,disabled:!0,center:!0}]:this.dockableCharacters.map(a=>({name:`${this.followingCharactor&&this.followingCharactor.identifier===a.identifier?"\u25c9":"\u25cb"} ${a.name}`,action:()=>{this.followingCharactor=a,this.ngZone.run(()=>{this.range.following()}),pt.play(tt.lock)}}));0!=o.length&&o.push(kt),o.push({name:"\u8ffd\u5f93\u3092\u89e3\u9664\u3059\u308b",action:()=>{pt.play(tt.unlock),this.followingCharactor=null},disabled:!this.followingCharactor}),s.push({name:"\u4ed8\u8fd1\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u8ffd\u5f93",action:null,subActions:o}),s.push(this.range.isExpandByFollowing?{name:"\u2611 \u8ffd\u5f93\u6642\u30b5\u30a4\u30ba\u306b\u5408\u308f\u305b\u3066\u62e1\u5927",action:()=>{this.range.isExpandByFollowing=!1}}:{name:"\u2610 \u8ffd\u5f93\u6642\u30b5\u30a4\u30ba\u306b\u5408\u308f\u305b\u3066\u62e1\u5927",action:()=>{this.range.isExpandByFollowing=!0}}),s.push(this.range.isFollowAltitude?{name:"\u2611 \u9ad8\u3055\u30fb\u9ad8\u5ea6\u306b\u3082\u8ffd\u5f93",action:()=>{this.range.isFollowAltitude=!1}}:{name:"\u2610 \u9ad8\u3055\u30fb\u9ad8\u5ea6\u306b\u3082\u8ffd\u5f93",action:()=>{this.range.isFollowAltitude=!0,this.followingCharactor&&this.range.following()}})}else s.push(this.range.subDivisionSnapPolygonal?{name:"\u2611 \u7d30\u304b\u3044\u89d2\u5ea6\u3067\u56de\u8ee2",action:()=>{this.range.subDivisionSnapPolygonal=!1}}:{name:"\u2610 \u7d30\u304b\u3044\u89d2\u5ea6\u3067\u56de\u8ee2",action:()=>{this.range.subDivisionSnapPolygonal=!0}});s.push(kt),s.push(this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0}}),s.push({name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,pt.play(tt.sweep))},altitudeHande:this.range}),s.push(kt),s.push({name:"\u5c04\u7a0b\u30fb\u7bc4\u56f2\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.range)}}),this.range.getUrls().length>0&&(s.push({name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.range.getUrls().map(o=>{const a=o.value.toString();return{name:o.name?o.name:a,action:()=>{rt.sameOrigin(a)?window.open(a.trim(),"_blank","noopener"):this.modalService.open(qr,{url:a,title:this.range.name,subTitle:o.name})},disabled:!rt.validUrl(a),error:rt.validUrl(a)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:rt.validUrl(a)&&!rt.sameOrigin(a)}})}),s.push(kt)),s.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let o=this.range.clone();console.log("\u30b3\u30d4\u30fc",o),o.location.x+=this.gridSize,o.location.y+=this.gridSize,o.isLocked=!1,o.followingCharctorIdentifier=null,this.range.parent&&this.range.parent.appendChild(o),pt.play(tt.cardPut)}}),s.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.range.destroy(),pt.play(tt.sweep)}}),s.push(kt),s.push({name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(r)}),this.contextMenuService.open(i,s,this.name)}onMove(){this.isMoving=!0,pt.play(tt.cardPick)}onMoved(){this.isMoving=!1,pt.play(tt.cardPut)}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u5c04\u7a0b\u30fb\u7bc4\u56f2\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Ws,{title:r,left:i.x-200,top:i.y-150,width:400,height:390}).tabletopObject=e}setRange(){let e=new bf(this.gridCanvas.nativeElement,this.rangeCanvas.nativeElement,this.centerPunch.nativeElement),i={areaWidth:2*this.areaQuadrantSize,areaHeight:2*this.areaQuadrantSize,range:this.rangeLength,width:this.width<.1?.1:this.width,centerX:this.range.location.x,centerY:this.range.location.y,gridSize:this.gridSize,type:this.range.type,gridColor:this.range.gridColor,rangeColor:this.range.rangeColor,fanDegree:0,degree:this.rotateDeg,offSetX:this.range.offSetX,offSetY:this.range.offSetY,gridType:this.currentTable.gridType,isDocking:!!this.followingCharactor,fillType:this.range.fillType};switch(this.range.type){case"LINE":this.clipAreaLine=e.renderLine(i),this.gripAreaLine=bf.gripAreaPathLine(i);break;case"CIRCLE":e.renderCircle(i);break;case"SQUARE":this.clipAreaSquare=e.renderSquare(i),this.gripAreaSquare=bf.gripAreaPathSquare(i);break;case"DIAMOND":this.clipAreaDiamond=e.renderDiamond(i),this.gripAreaDiamond=bf.gripAreaPathDiamond(i);break;default:this.clipAreaCorn=e.renderCorn(i),this.gripAreaCorn=bf.gripAreaPathCorn(i)}this.gridCanvas.nativeElement.style.opacity=this.range.opacity+""}}return t.\u0275fac=function(e){return new(e||t)(He(Cn),He(mg),He(lr),He(yi),He(An),He(Oi),He(fi),He(tl),He(vu),He(Fn))},t.\u0275cmp=Xt({type:t,selectors:[["range"]],viewQuery:function(e,i){if(1&e&&(cn(Jee,7),cn(ete,7),cn(tte,7),cn(nte,5)),2&e){let r;ln(r=un())&&(i.gridCanvas=r.first),ln(r=un())&&(i.rangeCanvas=r.first),ln(r=un())&&(i.centerPunch=r.first),ln(r=un())&&(i.rotate=r.first)}},hostBindings:function(e,i){1&e&&Ae("dragstart",function(s){return i.onDragstart(s)})("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{range:"range",is3D:"is3D"},decls:19,vars:48,consts:[["appMovable","",1,"component","is-3d",2,"pointer-events","none",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],[1,"is-3d",3,"ngClass"],[1,"is-3d",2,"position","absolute"],[1,"is-fill",2,"position","absolute","pointer-events","auto","top","-100%"],[1,"is-3d",2,"position","absolute","pointer-events","none"],[1,"is-3d",2,"position","absolute","z-index","0"],[1,"is-fill","is-3d"],["gridCanvas",""],["rangeCanvas",""],["appRotable","",1,"component-content","is-3d",2,"transform","rotateZ(0deg)",3,"rotable.option","rotable.polygonal","rotable.disable","rotable.ondragstart","rotable.ondragend"],["rotate",""],["class","is-3d","class","lock-icon is-center",4,"ngIf"],[4,"ngIf"],["class","is-3d","style","display: flex; flex-flow: column nowrap; justify-content: space-between; border-left: 2px dashed black; transform-origin: top left",3,"border-left-color","height","ngStyle",4,"ngIf"],["centerPunch",""],[1,"lock-icon","is-center"],[1,"material-icons"],[1,"is-3d",2,"position","absolute","width","28px","pointer-events","auto"],[4,"ngFor","ngForOf"],[1,"rotate-grab","of-corn-bottom","rotate-grab-icon","is-3d","will-change"],[1,"rotate-grab","of-corn-top","rotate-grab-icon","is-3d","will-change"],[1,"rotate-grab","of-corn-tip","rotate-grab-icon","is-3d","will-change",2,"position","absolute"],[1,"is-3d",2,"display","flex","flex-flow","column nowrap","justify-content","space-between","border-left","2px dashed black","transform-origin","top left",3,"ngStyle"],[1,"is-3d"],[1,"elevation-indicator","is-3d",2,"position","absolute"],[1,"elevation-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"is-3d",3,"ngStyle"]],template:function(e,i){1&e&&(Q(0,"div",0),Ae("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),Q(1,"div",1)(2,"div",2),ot(3,"div",3),ie(),Q(4,"div",4)(5,"div",5),ot(6,"canvas",6,7),ie(),Q(8,"div",2),ot(9,"canvas",6,8),ie(),Q(11,"div",9,10),Ae("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Te(13,ite,3,1,"div",11),Te(14,ste,9,3,"ng-container",12),ie()()(),Te(15,ote,20,44,"div",13),Q(16,"div",5),ot(17,"canvas",6,14),ie()()),2&e&&(re("ngClass",ft(44,ate,!i.isLocked))("movable.option",i.movableOption)("movable.disable",i.isLocked),U(1),Qe("transform","translateZ("+i.altitude*i.gridSize+"px)"),re("ngClass",ft(46,lte,0==i.altitude)),U(1),Qe("clip-path",i.gripPathText),U(1),Qe("left",1.5*-i.gripLength*i.gridSize,"px")("width",3*i.gripLength*i.gridSize,"px")("height",3*i.gripWidth*i.gridSize,"px"),U(1),Qe("width",0,"px")("height",0,"px")("clip-path",i.clipPathText),U(1),Qe("top",0,"px")("left",-1*i.areaQuadrantSize*i.gridSize,"px"),U(3),Qe("z-index",i.isMoving?5:0)("top",0,"px")("left",-1*i.areaQuadrantSize*i.gridSize,"px"),U(3),Qe("opacity",i.isMoving?.7:1),re("rotable.option",i.rotableOption)("rotable.polygonal",i.range.subDivisionSnapPolygonal?360:24)("rotable.disable",i.isLocked),U(2),re("ngIf","CIRCLE"==i.range.type||"SQUARE"==i.range.type||"DIAMOND"==i.range.type),U(1),re("ngIf","CIRCLE"!=i.range.type&&"SQUARE"!=i.range.type&&"DIAMOND"!=i.range.type),U(1),re("ngIf",i.isAltitudeIndicate&&(i.altitude<=-.5||.5<=i.altitude)),U(1),Qe("visibility",0!=i.altitude?"visible":"hidden")("top",0,"px")("left",-1*i.areaQuadrantSize*i.gridSize,"px"))},directives:[sl,Yn,tc,bn,oi,Ji],styles:[".is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.image[_ngcontent-%COMP%]{display:block}.lock-icon[_ngcontent-%COMP%]{background-color:#ccc;border-radius:100%;color:#444;width:25px;height:25px;visibility:hidden}.component[_ngcontent-%COMP%]:hover   .lock-icon[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .lock-icon[_ngcontent-%COMP%]{visibility:visible}.is-center[_ngcontent-%COMP%]{position:absolute;top:-12.5px;left:-12.5px;margin:auto}.border[_ngcontent-%COMP%]{box-sizing:border-box;border:solid 2px #CCCCCC}.is-fit-full[_ngcontent-%COMP%]{height:100%;width:100%}.pedestal-grab-corn[_ngcontent-%COMP%]{z-index:-1;position:absolute;inset:-14px 14px -14px -14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;position:absolute;inset:-14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:1}.rotate-grab[_ngcontent-%COMP%]{opacity:0;z-index:-1}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:30px;height:30px;box-sizing:border-box;border:solid 2px #CCCCCC;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:0;background-color:#ccc;border-radius:100%;color:#444;font-size:24px;transform-style:preserve-3d;transform:translateZ(.1px)}.will-change[_ngcontent-%COMP%]{will-change:opacity}.of-corn-top[_ngcontent-%COMP%]{top:-30px;left:-15px;border-radius:15px 15px 0 0}.of-corn-bottom[_ngcontent-%COMP%]{bottom:-30px;left:-15px;border-radius:0 0 15px 15px}.of-corn-tip[_ngcontent-%COMP%]{top:-15px;left:-15px;border-radius:15px}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px;border-radius:14px 7px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px;border-radius:7px 14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px;border-radius:14px 7px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px;border-radius:7px 14px}.is-fill[_ngcontent-%COMP%]{display:block;position:absolute;inset:0;margin:auto}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.fall[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.altitude-indicator[_ngcontent-%COMP%]{font-size:10px}.elevation-indicator[_ngcontent-%COMP%], .altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;color:#000;text-shadow:whitesmoke 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.elevation-indicator[_ngcontent-%COMP%]{font-weight:bolder;font-size:12px}"],changeDetection:0}),t})();function ute(t,n){1&t&&(Ke(0),Q(1,"div",20)(2,"div",21)(3,"div",22),ye(4,"autorenew"),ie(),Q(5,"div",23),ye(6,"autorenew"),ie()()(),Ye())}function dte(t,n){1&t&&(Q(0,"i",24),ye(1,"lock"),ie())}function fte(t,n){1&t&&(Q(0,"span"),ye(1,"\uff1a"),ie())}function hte(t,n){if(1&t&&(Q(0,"span"),ye(1),ie()),2&t){const e=_e();U(1),Xe(e.face)}}function pte(t,n){1&t&&(Q(0,"span"),ye(1,"???"),ie())}function gte(t,n){1&t&&(Q(0,"i",24),ye(1,"lock"),ie())}function _te(t,n){1&t&&(Q(0,"span"),ye(1,"\uff1a"),ie())}function mte(t,n){if(1&t&&(Q(0,"span"),ye(1),ie()),2&t){const e=_e();U(1),Xe(e.face)}}function $te(t,n){1&t&&(Q(0,"span"),ye(1,"???"),ie())}const vte=function(t,n){return{"background-color":t,transform:n}};function bte(t,n){if(1&t&&(Q(0,"div",25)(1,"div",26)(2,"b"),ye(3),ie()(),Q(4,"div",27)(5,"b"),ye(6),ie()()()),2&t){const e=_e();re("ngStyle",Yt(3,vte,e.ownerColor+"dd","translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateX("+e.nameTagRotate+"deg)")),U(3),Xe(e.ownerName),U(3),Xe(e.ownerName)}}const TI=function(t,n){return{"is-black-mask":t,"is-harf-black-mask":n}};function yte(t,n){if(1&t&&(ot(0,"img",28),Et(1,"safe")),2&t){const e=_e();re("src",Tt(1,2,e.imageFile.url,"resourceUrl"),en)("ngClass",Yt(5,TI,!e.isVisible,e.isMine||e.isGMMode&&e.hasOwner))}}function Cte(t,n){if(1&t&&(ot(0,"img",29),Et(1,"safe")),2&t){const e=_e();re("src",Tt(1,2,e.backFaceImageFile.url,"resourceUrl"),en)("ngClass",Yt(5,TI,!e.isVisible,e.isMine||e.isGMMode&&e.hasOwner||e.isVisible&&e.isCoin))}}function xte(t,n){1&t&&(ot(0,"img",30),Et(1,"safe")),2&t&&re("src",Tt(1,1,_e().imageFile.url,"resourceUrl"),en)}function wte(t,n){if(1&t&&(ot(0,"img",30),Et(1,"safe")),2&t){const e=_e();Qe("transform",e.isCoin?"scaleX(-1)":"scaleX(-1) scaleY(-1)"),re("src",Tt(1,3,e.backFaceImageFile.url,"resourceUrl"),en)}}const Ete=function(t){return{"is-gray-border":t}},Tte=function(t){return{transform:t}};let Ste=(()=>{class t{constructor(e,i,r,s,o,a,h,w,X){this.ngZone=e,this.panelService=i,this.contextMenuService=r,this.elementRef=s,this.changeDetector=o,this.pointerDeviceService=a,this.imageService=h,this.modalService=w,this.chatMessageService=X,this.diceSymbol=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null,this.viewRotateX=50,this.viewRotateZ=10}get face(){return this.diceSymbol.face}set face(e){this.diceSymbol.face=e}get owner(){return this.diceSymbol.owner}set owner(e){this.diceSymbol.owner=e}get rotate(){return this.diceSymbol.rotate}set rotate(e){this.diceSymbol.rotate=e}get name(){return this.diceSymbol.name}set name(e){this.diceSymbol.name=e}get size(){return this.adjustMinBounds(this.diceSymbol.size)}get faces(){return this.diceSymbol.faces}get nothingFaces(){return this.diceSymbol.nothingFaces}get imageFile(){return this.imageService.getEmptyOr(this.diceSymbol.imageFile)}get backFaceImageFile(){return this.imageService.getEmptyOr(this.diceSymbol.backFaceImageFile)}get isGMMode(){return this.diceSymbol.isGMMode}get isMine(){return this.diceSymbol.isMine}get hasOwner(){return this.diceSymbol.hasOwner}get ownerName(){return this.diceSymbol.ownerName}get ownerColor(){return this.diceSymbol.ownerColor}get isVisible(){return this.diceSymbol.isVisible}get isDropShadow(){return this.diceSymbol.isDropShadow}set isDropShadow(e){this.diceSymbol.isDropShadow=e}get isLock(){return this.diceSymbol.isLock}set isLock(e){this.diceSymbol.isLock=e}get isCoin(){return this.diceSymbol.isCoin}get isIconHidden(){return null!=this.iconHiddenTimer}get nameTagRotate(){let e=this.viewRotateX%360-90,i=(this.viewRotateZ+this.rotate)%360;return i=i>0?i:360+i,(e>0?e:360+e)*(this.isFlip?1:-1)}get isFlip(){let e=(this.viewRotateZ+this.rotate)%360;return e=e>0?e:360+e,90<e&&e<270}ngOnInit(){ze.register(this).on("ROLL_DICE_SYMBOL",e=>{e.data.identifier===this.diceSymbol.identifier&&this.ngZone.run(()=>{this.animeState="inactive",this.changeDetector.markForCheck(),queueMicrotask(()=>{this.animeState="active",this.changeDetector.markForCheck()})})}).on("UPDATE_GAME_OBJECT",e=>{let i=dt.instance.get(e.data.identifier);!this.diceSymbol||!i||(this.diceSymbol===i||i instanceof Vn&&this.diceSymbol.contains(i)||i instanceof We&&i.userId===this.diceSymbol.owner)&&this.changeDetector.markForCheck()}).on("DICE_ALL_OPEN",e=>{this.owner&&!this.isLock&&(this.owner="",pt.play(tt.unlock),this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u306e${this.isCoin?"\u8868\uff0f\u88cf":"\u76ee"}\u3092\u516c\u958b \u2192 ${this.face}`))}).on("TABLE_VIEW_ROTATE",e=>{this.ngZone.run(()=>{this.viewRotateX=e.data.x,this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=We.findByPeerId(e.data.peerId);(!i||this.diceSymbol.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.diceSymbol,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain","text-note","character"]},this.rotableOption={tabletopObject:this.diceSymbol}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new js(this.elementRef.nativeElement)}),this.input.onStart=e=>this.ngZone.run(()=>this.onInputStart(e))}ngOnDestroy(){this.input.destroy(),ze.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onInputStart(e){this.startDoubleClickTimer(e),this.startIconHiddenTimer()}startDoubleClickTimer(e){if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(()=>this.stopDoubleClickTimer(),e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}stopDoubleClickTimer(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}onDoubleClick(){this.stopDoubleClickTimer(),(this.doubleClickPoint.x-this.input.pointer.x)**2+(this.doubleClickPoint.y-this.input.pointer.y)**2<100&&this.isVisible&&this.diceRoll()}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];if(r.push({name:this.isCoin?"\u30b3\u30a4\u30f3\u30c8\u30b9":"\u30c0\u30a4\u30b9\u3092\u632f\u308b",action:()=>{this.diceRoll()},disabled:!this.isVisible,default:this.isVisible}),r.push(kt),(this.isMine||this.hasOwner)&&r.push({name:(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+"\u3092\u516c\u958b",action:()=>{this.owner="",pt.play(tt.unlock),this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u306e${this.isCoin?"\u8868\uff0f\u88cf":"\u76ee"}\u3092\u516c\u958b \u2192 ${this.face}`)}}),this.isMine||r.push({name:"\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{this.owner=xt.peerContext.userId,this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u3092\u81ea\u5206\u3060\u3051\u898b\u305f`),pt.play(tt.lock)}}),r.push(this.isLock?{name:"\u2611 \u4e00\u6589\u516c\u958b\u3057\u306a\u3044",action:()=>{this.isLock=!1,pt.play(tt.unlock)},disabled:this.hasOwner&&!this.isVisible}:{name:"\u2610 \u4e00\u6589\u516c\u958b\u3057\u306a\u3044",action:()=>{this.isLock=!0,pt.play(tt.lock)},disabled:this.hasOwner&&!this.isVisible}),this.isVisible){let s=[],o=this.nothingFaces;o.length>0&&(o.forEach(a=>{s.push({name:`${this.face==a?"\u25c9":"\u25cb"} ${a}\u3000`,action:()=>{pt.play(tt.dicePut),this.face=a}})}),s.push(kt)),this.faces.forEach(a=>{s.push({name:`${this.face==a?"\u25c9":"\u25cb"} ${a}\u3000`,action:()=>{""===this.owner&&pt.play(tt.dicePut),""===this.owner&&this.face!=a&&this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u306e${this.isCoin?"\u8868\uff0f\u88cf":"\u76ee"}\u3092\u5909\u66f4 \u2192 ${a}`),this.face=a}})}),r.push({name:this.isCoin?"\u8868\uff0f\u88cf":"\u30c0\u30a4\u30b9\u76ee",action:null,subActions:s})}r.push(kt),r.push(this.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!1}}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!0}}),r.push(kt),r.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.diceSymbol)}}),this.diceSymbol.getUrls().length>0&&(r.push({name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.diceSymbol.getUrls().map(s=>{const o=s.value.toString();return{name:s.name?s.name:o,action:()=>{rt.sameOrigin(o)?window.open(o.trim(),"_blank","noopener"):this.modalService.open(qr,{url:o,title:this.diceSymbol.name,subTitle:s.name})},disabled:!rt.validUrl(o),error:rt.validUrl(o)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:rt.validUrl(o)&&!rt.sameOrigin(o)}})}),r.push(kt)),r.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let s=this.diceSymbol.clone();s.location.x+=this.gridSize,s.location.y+=this.gridSize,s.update(),pt.play(tt.dicePut)}}),r.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.diceSymbol.destroy(),pt.play(tt.sweep)}}),this.contextMenuService.open(i,r,this.name)}onMove(){pt.play(tt.dicePick)}onMoved(){pt.play(tt.dicePut)}diceRoll(){ze.call("ROLL_DICE_SYMBOL",{identifier:this.diceSymbol.identifier}),pt.play(this.isCoin?tt.coinToss:tt.diceRoll1);let e=this.diceSymbol.diceRoll(),i=`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u3092${this.isCoin?"\u30c8\u30b9\u3057\u305f":"\u632f\u3063\u305f"}`;return""===this.owner&&(i+=` \u2192 ${e}`),this.chatMessageService.sendOperationLog(i),e}showDetail(e){ze.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(Ws,{title:r,left:i.x-300,top:i.y-300,width:600,height:490}).tabletopObject=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}adjustMinBounds(e,i=0){return e<i?i:e}}return t.\u0275fac=function(e){return new(e||t)(He(Cn),He(An),He(lr),He(yi),He(Oi),He(fi),He(wu),He(Fn),He(kr))},t.\u0275cmp=Xt({type:t,selectors:[["dice-symbol"]],hostBindings:function(e,i){1&e&&Ae("dragstart",function(s){return i.onDragstart(s)})("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{diceSymbol:"diceSymbol",is3D:"is3D"},decls:31,vars:48,consts:[["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.option","movable.ondragstart","movable.ondragend"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[1,"pedestal-inner",3,"ngClass"],[1,"pedestal-outer"],[4,"ngIf"],[1,"upright-transform","is-fit-width","is-3d"],[1,"rotate-frame","is-3d"],[1,"rotate-inner","is-3d"],[1,"is-3d",3,"ngStyle"],[1,"name-tag","is-nowrap","is-black-background","is-3d",2,"transform","translateX(-50%)"],[1,"fornt-tag","is-3d"],["class","material-icons lock-icon",4,"ngIf"],[1,"back-tag","is-3d"],["class","owner-tag is-nowrap is-black-background is-3d",3,"ngStyle",4,"ngIf"],["class","image front-face is-3d chrome-smooth-image-trick",3,"src","ngClass",4,"ngIf"],["class","image back-face is-3d chrome-smooth-image-trick","style","transform: rotateY(-180deg)",3,"src","ngClass",4,"ngIf"],[1,"is-3d",2,"position","relative","top","-20%"],["class","image shadow is-3d","style","opacity: 0.7; filter: brightness(0) blur(1px)",3,"src",4,"ngIf"],["class","image shadow is-3d","style","opacity: 0.7; filter: brightness(0) blur(1px)",3,"src","transform",4,"ngIf"],[1,"pedestal-grab","rotate-grab","is-3d"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"material-icons","lock-icon"],[1,"owner-tag","is-nowrap","is-black-background","is-3d",3,"ngStyle"],[1,"fornt-tag","is-3d",2,"color","whitesmoke"],[1,"back-tag","is-3d",2,"color","whitesmoke"],[1,"image","front-face","is-3d","chrome-smooth-image-trick",3,"src","ngClass"],[1,"image","back-face","is-3d","chrome-smooth-image-trick",2,"transform","rotateY(-180deg)",3,"src","ngClass"],[1,"image","shadow","is-3d",2,"opacity","0.7","filter","brightness(0) blur(1px)",3,"src"]],template:function(e,i){1&e&&(Q(0,"div",0),Ae("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),Q(1,"div",1)(2,"div",2),Ae("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),ot(3,"div",3)(4,"div",4),Te(5,ute,7,0,"ng-container",5),Q(6,"div",1)(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"div",10),Ae("@diceRollNameTag.done",function(s){return i.animationShuffleDone(s)}),Q(12,"div",11),Te(13,dte,2,0,"i",12),ye(14),Te(15,fte,2,0,"span",5),Te(16,hte,2,1,"span",5),Te(17,pte,2,0,"span",5),ie(),Q(18,"div",13),Te(19,gte,2,0,"i",12),ye(20),Te(21,_te,2,0,"span",5),Te(22,mte,2,1,"span",5),Te(23,$te,2,0,"span",5),ie()()(),Te(24,bte,7,6,"div",14),Q(25,"div",1),Ae("@diceRoll.done",function(s){return i.animationShuffleDone(s)})("@coinFlip.done",function(s){return i.animationShuffleDone(s)}),Te(26,yte,2,8,"img",15),Te(27,Cte,2,8,"img",16),ie()()()(),Q(28,"div",17),Ae("@diceRoll.done",function(s){return i.animationShuffleDone(s)}),Te(29,xte,2,4,"img",18),Te(30,wte,2,6,"img",19),ie()()()()()),2&e&&(Qe("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),re("movable.option",i.movableOption),U(1),re("@bounceInOut","in"),U(1),re("rotable.option",i.rotableOption),U(1),re("ngClass",ft(44,Ete,i.hasOwner)),U(2),re("ngIf",!i.isIconHidden),U(3),Qe("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),U(2),re("ngStyle",ft(46,Tte,"translateX("+i.size*i.gridSize/2+"px) rotateX("+i.nameTagRotate+"deg)")),U(1),re("@changeFaceNameTag",i.isVisible?i.face:null)("@diceRollNameTag",i.animeState),U(2),re("ngIf",i.isLock&&i.hasOwner),U(1),Xe(i.name),U(1),re("ngIf",0<i.name.length),U(1),re("ngIf",i.isVisible),U(1),re("ngIf",!i.isVisible),U(2),re("ngIf",i.isLock&&i.hasOwner),U(1),Xe(i.name),U(1),re("ngIf",0<i.name.length),U(1),re("ngIf",i.isVisible),U(1),re("ngIf",!i.isVisible),U(1),re("ngIf",i.hasOwner&&0<i.ownerName.length),U(1),Qe("transform",i.isCoin?"rotateX(30deg)":""),re("@changeFace",!i.isCoin&&i.isVisible?i.face:null)("@changeFaceCoin",i.isCoin&&i.isVisible?"\u88cf"==i.face?0:1:null)("@diceRoll",!i.isCoin&&i.animeState)("@coinFlip",i.isCoin&&i.animeState),U(1),re("ngIf",0<i.imageFile.url.length),U(1),re("ngIf",0<i.backFaceImageFile.url.length),U(1),Qe("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),re("@changeFace",!i.isCoin&&i.isVisible?i.face:null)("@changeFaceCoin",i.isCoin&&i.isVisible?"\u8868"==i.face?1:2:null)("@diceRoll",i.animeState),U(1),re("ngIf",!i.isFlip&&i.isDropShadow&&0<i.imageFile.url.length),U(1),re("ngIf",i.isFlip&&i.isDropShadow&&0<i.backFaceImageFile.url.length))},directives:[sl,tc,Yn,bn,Ji],pipes:[ai],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:100%;box-sizing:border-box;border-top:solid 28px #999;border-left:solid 12px #999;border-right:solid 12px #CCC;border-bottom:solid 28px #CCC;border-radius:22px}.pedestal-inner[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 6px rgb(216,139,75);border-radius:5px}.is-gray-border[_ngcontent-%COMP%]{border-color:#999}.pedestal-outer[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 2px #212121;border-radius:5px}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{bottom:0;left:0;right:0;margin:auto;width:100%;height:auto;vertical-align:bottom}.image.shadow[_ngcontent-%COMP%]{width:100%;height:100%}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:6px;position:absolute;top:-30px;transform-origin:center bottom}.owner-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:12px;padding:3px 9px;border-radius:6px;position:absolute;top:-55px;transform-origin:center bottom}.rotate-frame[_ngcontent-%COMP%]{bottom:0;left:0;right:0}.rotate-inner[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;width:100%;height:auto}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.fornt-tag[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.back-tag[_ngcontent-%COMP%]{position:absolute;top:3px;-webkit-backface-visibility:hidden;backface-visibility:hidden;transform:rotateY(-180deg)}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;bottom:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{position:absolute;width:24px;top:0;left:0;right:0;margin:auto;color:#444}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.material-icons.lock-icon[_ngcontent-%COMP%]{display:inline-block;font-size:smaller;margin-right:2px}.front-face[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.back-face[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;transform:rotateY(-180deg)}"],data:{animation:[Sn("diceRoll",[Lt("* => active",[Rt("800ms ease",sn([et({transform:"scale3d(0.8, 0.8, 0.8) rotateZ(-0deg)",offset:0}),et({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(-360deg)",offset:.5}),et({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(-520deg)",offset:.75}),et({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(-630deg)",offset:.875}),et({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(-720deg)",offset:1})]))])]),Sn("coinFlip",[Lt("* => active",[Rt("800ms ease-out",sn([et({transform:"scale3d(0.8, 0.8, 0.8) translateY(0%) rotateX(60deg) rotateX(-0deg) rotateY(-0deg)",offset:0}),et({transform:"scale3d(1.2, 1.2, 1.2)  translateY(-28%) rotateX(60deg) rotateX(-360deg) rotateY(-360deg)",offset:.5}),et({transform:"scale3d(0.75, 0.75, 0.75) translateY(-40%) rotateX(60deg) rotateX(-520deg) rotateY(-520deg)",offset:.75}),et({transform:"scale3d(1.125, 1.125, 1.125) translateY(-28%) rotateX(60deg) rotateX(-630deg) rotateY(-630deg)",offset:.875}),et({transform:"scale3d(1.0, 1.0, 1.0) translateY(0%) rotateX(60deg) rotateX(-720deg) rotateY(-720deg)",offset:1})]))])]),Sn("diceRollNameTag",[Lt("* => active",[Rt("800ms ease",sn([et({transform:"translateX(-50%) scale3d(0.8, 0.8, 0.8) rotateY(0deg)",offset:0}),et({transform:"translateX(-50%) scale3d(1.2, 1.2, 1.2) rotateY(360deg)",offset:.5}),et({transform:"translateX(-50%) scale3d(0.75, 0.75, 0.75) rotateY(520deg)",offset:.75}),et({transform:"translateX(-50%) scale3d(1.125, 1.125, 1.125) rotateY(630deg)",offset:.875}),et({transform:"translateX(-50%) scale3d(1.0, 1.0, 1.0) rotateY(720deg)",offset:1})]))])]),Sn("changeFace",[Lt(":increment,:decrement",[Rt("200ms ease",sn([et({transform:"scale3d(0.8, 0.8, 0.8) rotateZ(0deg)",offset:0}),et({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(-360deg)",offset:1})]))])]),Sn("changeFaceCoin",[Lt(":increment,:decrement",[Rt("200ms ease",sn([et({transform:"scale3d(0.8, 0.8, 0.8) rotateX(0deg)",offset:0}),et({transform:"scale3d(1.0, 1.0, 1.0) rotateX(-720deg)",offset:1})]))])]),Sn("changeFaceNameTag",[Lt(":increment,:decrement",[Rt("200ms ease",sn([et({transform:"translateX(-50%) scale3d(0.8, 0.8, 0.8) rotateY(0deg)",offset:0}),et({transform:"translateX(-50%) scale3d(1.0, 1.0, 1.0) rotateY(360deg)",offset:1})]))])]),Sn("bounceInOut",[Lt("void => *",[Rt("600ms ease",sn([et({transform:"scale3d(0, 0, 0)",offset:0}),et({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),et({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),et({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),et({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Lt("* => void",[Rt(100,et({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),t})();const Ite=["characterImage"],kte=["chatBubble"],Mte=function(t){return{opacity:t}};function Dte(t,n){if(1&t&&(ot(0,"img",31),Et(1,"safe")),2&t){const e=_e();Qe("height",e.characterShadowImageHeight,"px")("filter","brightness(0) blur(1px)"+(e.isHideIn?" invert(85%)":"")),re("src",Tt(1,7,0<e.shadowImageFile.url.length?e.shadowImageFile.url:e.imageFile.url,"resourceUrl"),en)("ngStyle",ft(10,Mte,(e.isHollow?.5:.7)*(e.isHideIn?.85:1)))("@switchImageShadow",e.gameCharacter.currntImageIndex)}}const Ate=function(t,n){return{"background-color":t,transform:n}};function Pte(t,n){if(1&t&&(Q(0,"div",32)(1,"div",33)(2,"b"),ye(3),ie()(),Q(4,"div",34)(5,"b"),ye(6),ie()()()),2&t){const e=_e();re("ngStyle",Yt(3,Ate,e.ownerColor+"dd","translateX(-50%) translateX("+e.size*e.gridSize/2+"px) translateY(6px) rotateX("+e.nameTagRotate+"deg)")),U(3),Xe(e.ownerName),U(3),Xe(e.ownerName)}}const Nte=function(t){return{"is-hide-in-tag":t}},yf=function(t){return{transform:t}};function Fte(t,n){if(1&t&&(Q(0,"div",35)(1,"div",36),ye(2),ie(),Q(3,"div",37),ye(4),ie()()),2&t){const e=_e();re("ngClass",ft(4,Nte,e.isHideIn))("ngStyle",ft(6,yf,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateX("+e.nameTagRotate+"deg)")),U(2),Xe(e.name),U(2),Xe(e.name)}}const Ote=function(t){return{"is-hide-in":t}};function Rte(t,n){if(1&t){const e=it();Q(0,"img",38,39),Ae("load",function(){return Oe(e),_e().onImageLoad()}),Et(2,"safe"),ie()}if(2&t){const e=_e();Qe("height",e.characterImageHeight,"px"),re("src",Tt(2,4,e.imageFile.url,"resourceUrl"),en)("ngClass",ft(7,Ote,e.isHideIn))}}function Bte(t,n){if(1&t&&(Q(0,"span",46),ot(1,"img",47),Et(2,"safe"),ie()),2&t){const e=_e(2);U(1),Qe("border-color",e.dialogColor),re("src",Tt(2,3,e.dialogFaceIcon.url,"resourceUrl"),en)}}function Lte(t,n){if(1&t&&(Q(0,"span",46),ot(1,"img",47),Et(2,"safe"),ie()),2&t){const e=_e(2);U(1),Qe("border-color",e.dialogColor),re("src",Tt(2,3,e.dialogFaceIcon.url,"resourceUrl"),en)}}const SI=function(t,n,e){return{emote:t,rubied:n,"is-whisper":e}};function zte(t,n){if(1&t&&(Q(0,"div",40)(1,"div",41)(2,"p",42),Te(3,Bte,3,6,"span",43),ot(4,"span",44),Et(5,"safe"),ie(),Q(6,"p",45),Te(7,Lte,3,6,"span",43),ot(8,"span",44),Et(9,"safe"),ie()()()),2&t){const e=_e();Qe("color",!e.isEmote&&e.isWhisper?"#ccc":e.dialogColor),re("@fadeAndScaleInOut",e.isEmote),U(2),Qe("min-width",e.dialogChatBubbleMinWidth,"px")("border-color",e.dialogColor),re("ngClass",Zr(23,SI,e.isEmote,e.isRubied,e.isWhisper)),U(1),re("ngIf",!e.isEmote&&e.isUseFaceIcon&&0<(null==e.dialogFaceIcon?null:e.dialogFaceIcon.url.length)),U(1),re("innerHTML",Tt(5,17,e.dialogText,"html"),Yi),U(2),Qe("min-width",e.dialogChatBubbleMinWidth,"px")("border-color",e.dialogColor),re("ngClass",Zr(27,SI,e.isEmote,e.isRubied,e.isWhisper)),U(1),re("ngIf",!e.isEmote&&e.isUseFaceIcon&&0<(null==e.dialogFaceIcon?null:e.dialogFaceIcon.url.length)),U(1),re("innerHTML",Tt(9,20,e.dialogText,"html"),Yi)}}const II=function(t){return{transform:t}};function jte(t,n){if(1&t&&(Q(0,"div",48)(1,"div",41)(2,"span",49)(3,"i"),ye(4),ie()(),Q(5,"span",50)(6,"i"),ye(7),ie()()(),Q(8,"div",41)(9,"span",51),ye(10),ie(),Q(11,"span",52),ye(12),ie()(),Q(13,"div",53)(14,"span",49)(15,"i"),ye(16),ie()(),Q(17,"span",50)(18,"i"),ye(19),ie()()()()),2&t){const e=_e();Qe("height",e.math.abs(e.altitude*e.gridSize)-(e.altitude>0?0:e.chatBubbleAltitude+4),"px"),re("ngStyle",ft(14,II,"translateX("+e.size*e.gridSize/2+"px) translateY("+-e.size*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),U(1),Qe("visibility",e.altitude>0?"visible":"hidden"),U(3),Xe(e.elevation),U(3),Xe(e.elevation),U(3),Xe(e.math.abs(e.altitude)),U(2),Xe(e.math.abs(e.altitude)),U(1),Qe("visibility",e.altitude<0?"visible":"hidden"),re("ngStyle",ft(16,II,"translateY("+(e.chatBubbleAltitude+4)+"px)")),U(3),Xe(e.elevation),U(3),Xe(e.elevation)}}const Hte=function(t,n,e){return{selected:t,"not-inventory":n,"is-hide-in-pedestal":e}},kI=function(t,n,e,i,r,s,o,a){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:s,yellow:o,white:a}},Ute=function(t){return{fall:t}},Vte=function(t,n,e){return{inverse:t,"black-paint":n,hollow:e}},Gte=function(t,n,e){return{bottom:t,transform:n,visibility:e}};let qte=(()=>{class t{constructor(e,i,r,s,o,a){this.contextMenuService=e,this.panelService=i,this.changeDetector=r,this.pointerDeviceService=s,this.ngZone=o,this.modalService=a,this.gameCharacter=null,this.is3D=!1,this.gridSize=50,this.math=Math,this.stringUtil=rt,this.viewRotateX=50,this.viewRotateZ=10,this.heightWidthRatio=1.5,this.selected=!1,this._dialog=null,this.dialogTimeOutId=null,this.chatIntervalId=null,this.naturalImageWidth=0,this.naturalImageHeight=0,this.naturaHeightWidthRatio=1,this.movableOption={},this.rotableOption={}}get name(){return this.gameCharacter.name}get size(){return this.adjustMinBounds(this.gameCharacter.size)}get altitude(){return this.gameCharacter.altitude}set altitude(e){this.gameCharacter.altitude=e}get height(){return this.adjustMinBounds(this.gameCharacter.height)}get imageFile(){return this.gameCharacter.imageFile}get rotate(){return this.gameCharacter.rotate}set rotate(e){this.gameCharacter.rotate=e}get roll(){return this.gameCharacter.roll}set roll(e){this.gameCharacter.roll=e}get isDropShadow(){return this.gameCharacter.isDropShadow}set isDropShadow(e){this.gameCharacter.isDropShadow=e}get isAltitudeIndicate(){return this.gameCharacter.isAltitudeIndicate}set isAltitudeIndicate(e){this.gameCharacter.isAltitudeIndicate=e}get isInverse(){return this.gameCharacter.isInverse}set isInverse(e){this.gameCharacter.isInverse=e}get isHollow(){return this.gameCharacter.isHollow}set isHollow(e){this.gameCharacter.isHollow=e}get isBlackPaint(){return this.gameCharacter.isBlackPaint}set isBlackPaint(e){this.gameCharacter.isBlackPaint=e}get aura(){return this.gameCharacter.aura}set aura(e){this.gameCharacter.aura=e}get isNotRide(){return this.gameCharacter.isNotRide}set isNotRide(e){this.gameCharacter.isNotRide=e}get isUseIconToOverviewImage(){return this.gameCharacter.isUseIconToOverviewImage}set isUseIconToOverviewImage(e){this.gameCharacter.isUseIconToOverviewImage=e}get ownerName(){return this.gameCharacter.ownerName}get ownerColor(){return this.gameCharacter.ownerColor}get isHideIn(){return!!this.gameCharacter.owner}get isVisible(){return this.gameCharacter.isVisible}get isGMMode(){return!!We.myCursor&&We.myCursor.isGMMode}get faceIcon(){return this.gameCharacter.faceIcon}get dialogFaceIcon(){return this.dialog&&this.dialog.faceIconIdentifier?Nt.instance.get(this.dialog.faceIconIdentifier):null}get shadowImageFile(){return this.gameCharacter.shadowImageFile}get elevation(){return+((this.gameCharacter.posZ+this.altitude*this.gridSize)/this.gridSize).toFixed(1)}set dialog(e){if(!this.gameCharacter||this.gameCharacter.isHideIn)return;clearTimeout(this.dialogTimeOutId),clearInterval(this.chatIntervalId);let i=rt.cr(e.text);const r=rt.isEmote(i),s=[],o=/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g;let a,h=0,w=0;if(!r)for(i=i.replace(/[\u3002\u3001]{3}/g,"\u2026").replace(/[\u3002\u3001]{2}/g,"\u2025").replace(/(\u3002|[\r\n]{2,})/g,"$1                            ").trimEnd();null!==(a=o.exec(i));){let Le=a.index-3*h;s.push({base:a[1],ruby:a[2],start:Le-w,end:Le+a[1].length-w-1}),h++,w+=a[2].length}let X=1e3/Array.from(i).length>36?1e3/Array.from(i).length:36;X>200&&(X=200),this.dialogTimeOutId=setTimeout(()=>{this._dialog=null,this.gameCharacter.text="",this.gameCharacter.isEmote=!1,this.changeDetector.markForCheck()},Array.from(i).length*X+6e3),this._dialog=e,this.gameCharacter.isEmote=r,h=0;let fe=0,pe=0,we="",Ie=s.shift(),Pe="",Be=!1;if(r)this.gameCharacter.text=i,this.changeDetector.markForCheck();else{const Le=Array.from(i.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a.+?\u300b/g,"$1"));this.chatIntervalId=setInterval(()=>{let Fe=Le[h],Ve=Fe.length>1;if(Fe){if(!Be&&Ie&&fe>=Ie.start&&(we+="<ruby>",Be=!0,pe=0),we+=rt.escapeHtml(Fe),Be){pe+=1;let Ge=Ie.ruby;Pe="<rt>"+rt.escapeHtml(Array.from(Ge).slice(0,Math.ceil(Array.from(Ge).length*(pe/Array.from(Ie.base).length))).join(""))+"</rt>"}Be&&Ie&&fe>=Ie.end-(Ve?1:0)&&(we+=Pe+"</ruby>",Be=!1,Ie=s.shift()),fe+=Fe.length}h+=1,this.gameCharacter.text=we+(Be?Pe+"</ruby>":""),this.changeDetector.markForCheck(),h>=Le.length&&clearInterval(this.chatIntervalId)},X)}}get dialogText(){if(!this.gameCharacter||!this.gameCharacter.text)return"";const e=this.gameCharacter.text.replace(/\u3002/g,"\u3002\n\n").split(/[\r\n]{2,}/g).filter(i=>i.trim());return e.length>0?e.reverse()[0].trim():""}get isRubied(){return!(!this.gameCharacter||!this.gameCharacter.text)&&-1<this.dialogText.indexOf("<ruby>")}get dialogChatBubbleMinWidth(){const e=this.characterImageWidth+2.1*this.gridSize,i=this.isUseFaceIcon&&this.dialogFaceIcon&&this.dialogFaceIcon.url,r=11*Array.from(this.dialogText).length+52+(i?32:0);return e<r?e:r}get dialog(){return this._dialog}get chatBubbleXDeg(){let e=90-this.viewRotateX;return e<0&&(e=360+e),e%=360,e>180&&(e=-(180-(e-180))),e>90&&(e=90),e<-90&&(e=-90),e/1.5}get characterImageHeight(){if(!this.characterImage||!this.naturalImageHeight)return 0;if(this.height>0)return this.gridSize*this.height;let e=this.naturaHeightWidthRatio;return e>this.heightWidthRatio&&(e=this.heightWidthRatio),e*this.gridSize*this.size}get characterImageWidth(){if(!this.characterImage||!this.naturalImageWidth)return 0;if(this.height<=0)return this.gridSize*this.size;let e=this.naturaHeightWidthRatio;return e>this.heightWidthRatio&&(e=this.heightWidthRatio),this.gridSize*this.height/e}get characterShadowImageHeight(){return this.characterImageHeight}get characterShadowImageWidth(){return this.characterImageWidth}get characterShadowOffset(){let e=0;return.2<this.height&&this.height<=.3?e=.09:.1<this.height&&this.height<=.2?e=.19:0<this.height&&this.height<=.1&&(e=.29),this.gridSize*this.size/2-.99*this.characterShadowImageHeight-this.gridSize*e}get chatBubbleAltitude(){let e=Math.cos(this.roll*Math.PI/180),i=Math.abs(Math.sin(this.roll*Math.PI/180));e<.5&&(e=.5),i<.5&&(i=.5);const r=(this.characterImageHeight+(""!=this.name?24:0))*e+4,s=this.characterImageWidth/2*i+4+this.characterImageWidth/2;let o=r>s?r:s;return this.gameCharacter.chatBubbleAltitude=o,o}get nameTagRotate(){let e=this.viewRotateX%360-90,i=(this.viewRotateZ+this.rotate)%360,r=this.roll%360;return i=i>0?i:360+i,r=r>0?r:360+r,(e>0?e:360+e)*(90<i&&i<270?1:-1)*(90<=r&&r<=270?-1:1)}get isListen(){return this.dialog&&this.dialog.text&&!this.dialog.dialogTest&&this.dialog.text.trim().length>0}get isWhisper(){return this.dialog&&this.dialog.secret}get isEmote(){return this.gameCharacter.isEmote}get isUseFaceIcon(){return this.dialog&&this.dialog.faceIconIdentifier}get dialogColor(){return this.dialog&&this.dialog.color?this.dialog.color:We.CHAT_DEFAULT_COLOR}ngOnInit(){ze.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=dt.instance.get(e.data.identifier);!this.gameCharacter||!i||(this.gameCharacter===i||i instanceof Vn&&this.gameCharacter.contains(i))&&(this.gameCharacter.imageFiles.length<=0&&(this.naturalImageHeight=0,this.naturalImageWidth=0,this.naturaHeightWidthRatio=1),this.changeDetector.markForCheck())}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateX=e.data.x,this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on("SELECT_TABLETOP_OBJECT",-1e3,e=>{this.ngZone.run(()=>{this.selected=!(!e.data.highlighting||e.data.identifier!==this.gameCharacter.identifier),this.changeDetector.markForCheck()})}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on("POPUP_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&this.ngZone.run(()=>{this.dialog=e.data,this.changeDetector.markForCheck()})}).on("FAREWELL_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&(this.ngZone.run(()=>{this._dialog=null,this.gameCharacter.text="",this.gameCharacter.isEmote=!1,this.changeDetector.markForCheck()}),clearTimeout(this.dialogTimeOutId),clearInterval(this.chatIntervalId))}),this.movableOption={tabletopObject:this.gameCharacter,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain","text-note","character"]},this.rotableOption={tabletopObject:this.gameCharacter}}ngAfterViewInit(){queueMicrotask(()=>{this.gameCharacter.isLoaded=!0})}ngOnDestroy(){clearTimeout(this.dialogTimeOutId),clearInterval(this.chatIntervalId),this.gameCharacter&&(this.gameCharacter.text="",this.gameCharacter.isEmote=!1),ze.unregister(this)}onDragstart(e){console.log("Dragstart Cancel !!!!"),e.stopPropagation(),e.preventDefault()}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:this.isHideIn?"\u4f4d\u7f6e\u3092\u516c\u958b\u3059\u308b":"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u308b\uff08\u30b9\u30c6\u30eb\u30b9\uff09",action:()=>{this.isHideIn?(this.gameCharacter.owner="",pt.play(tt.piecePut)):(!Gt.isStealthMode&&!We.myCursor.isGMMode&&this.modalService.open(er,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:Si.OK,materialIcon:"disabled_visible"}),this.gameCharacter.owner=xt.peerContext.userId,pt.play(tt.sweep),ze.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier})),ze.call("UPDATE_INVENTORY",!0)}},kt,this.gameCharacter.imageFiles.length<=1?null:{name:"\u753b\u50cf\u5207\u308a\u66ff\u3048",action:null,subActions:this.gameCharacter.imageFiles.map((r,s)=>({name:this.gameCharacter.currntImageIndex==s?"\u25c9":"\u25cb",action:()=>{this.changeImage(s)},default:this.gameCharacter.currntImageIndex==s,icon:r}))},this.gameCharacter.imageFiles.length<=1?null:kt,this.isUseIconToOverviewImage?{name:"\u2611 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{this.isUseIconToOverviewImage=!1,ze.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{this.isUseIconToOverviewImage=!0,ze.trigger("UPDATE_INVENTORY",null)}},this.gameCharacter.isShowChatBubble?{name:"\u2611 \u{1f4ad}\u306e\u8868\u793a",action:()=>{this.gameCharacter.isShowChatBubble=!1,ze.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u{1f4ad}\u306e\u8868\u793a",action:()=>{this.gameCharacter.isShowChatBubble=!0,ze.trigger("UPDATE_INVENTORY",null)}},this.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!1,ze.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!0,ze.trigger("UPDATE_INVENTORY",null)}},{name:"\u753b\u50cf\u52b9\u679c",action:null,subActions:[this.isInverse?{name:"\u2611 \u53cd\u8ee2",action:()=>{this.isInverse=!1,ze.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u53cd\u8ee2",action:()=>{this.isInverse=!0,ze.trigger("UPDATE_INVENTORY",null)}},this.isHollow?{name:"\u2611 \u307c\u304b\u3057",action:()=>{this.isHollow=!1,ze.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u307c\u304b\u3057",action:()=>{this.isHollow=!0,ze.trigger("UPDATE_INVENTORY",null)}},this.isBlackPaint?{name:"\u2611 \u9ed2\u5857\u308a",action:()=>{this.isBlackPaint=!1,ze.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ed2\u5857\u308a",action:()=>{this.isBlackPaint=!0,ze.trigger("UPDATE_INVENTORY",null)}},{name:"\u30aa\u30fc\u30e9",action:null,subActions:[{name:(-1==this.aura?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{this.aura=-1,ze.trigger("UPDATE_INVENTORY",null)}},kt].concat(["\u30d6\u30e9\u30c3\u30af","\u30d6\u30eb\u30fc","\u30b0\u30ea\u30fc\u30f3","\u30b7\u30a2\u30f3","\u30ec\u30c3\u30c9","\u30de\u30bc\u30f3\u30bf","\u30a4\u30a8\u30ed\u30fc","\u30db\u30ef\u30a4\u30c8"].map((r,s)=>({name:`${this.aura==s?"\u25c9":"\u25cb"} ${r}`,colorSample:!0,action:()=>{this.aura=s,ze.trigger("UPDATE_INVENTORY",null)}})))},kt,{name:"\u30ea\u30bb\u30c3\u30c8",action:()=>{this.isInverse=!1,this.isHollow=!1,this.isBlackPaint=!1,this.aura=-1,ze.trigger("UPDATE_INVENTORY",null)},disabled:!this.isInverse&&!this.isHollow&&!this.isBlackPaint&&-1==this.aura}]},kt,this.isNotRide?{name:"\u2610 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{this.isNotRide=!1,ze.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2611 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{this.isNotRide=!0,ze.trigger("UPDATE_INVENTORY",null)}},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1,ze.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0,ze.trigger("UPDATE_INVENTORY",null)}},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,this.isHideIn||pt.play(tt.sweep))},altitudeHande:this.gameCharacter},kt,{name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.gameCharacter)}},{name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a",action:()=>{this.showChatPalette(this.gameCharacter)}},{name:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a",action:()=>{this.showStandSetting(this.gameCharacter)}},kt,{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.gameCharacter.getUrls().map(r=>{const s=r.value.toString();return{name:r.name?r.name:s,action:()=>{rt.sameOrigin(s)?window.open(s.trim(),"_blank","noopener"):this.modalService.open(qr,{url:s,title:this.gameCharacter.name,subTitle:r.name})},disabled:!rt.validUrl(s),error:rt.validUrl(s)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:rt.validUrl(s)&&!rt.sameOrigin(s)}}),disabled:this.gameCharacter.getUrls().length<=0},kt,this.gameCharacter.isInventoryIndicate?{name:"\u2611 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{this.gameCharacter.isInventoryIndicate=!1,ze.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{this.gameCharacter.isInventoryIndicate=!0,ze.trigger("UPDATE_INVENTORY",null)}},{name:"\u30c6\u30fc\u30d6\u30eb\u304b\u3089\u79fb\u52d5",action:null,subActions:[{name:"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea",action:()=>{ze.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation("common"),pt.play(tt.piecePut)}},{name:"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea",action:()=>{ze.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation(xt.peerId),pt.play(tt.piecePut)}},{name:"\u5893\u5834",action:()=>{ze.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation("graveyard"),pt.play(tt.sweep)}}]},kt,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.gameCharacter.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.update(),pt.play(tt.piecePut)}},{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b\uff08\u81ea\u52d5\u63a1\u756a\uff09",action:()=>{const r=this.gameCharacter.clone(),s=r.name.split("_");let o;o=s.length>1&&/\d+/.test(s[s.length-1])?s.slice(0,s.length-1).join("_"):s.join("_");let a=0;for(const h of dt.instance.getObjects(Gt)){if(!h.name.startsWith(o))continue;let w=h.name.match(/_(\d+)$/)?+RegExp.$1:0;w>a&&(a=w)}r.name=o+"_"+(a+1),r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.update(),pt.play(tt.piecePut)}},kt,{name:"\u524a\u9664\u3059\u308b\uff08\u5893\u5834\u3078\u79fb\u52d5\uff09",action:()=>{ze.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation("graveyard"),pt.play(tt.sweep)}}],this.name)}onMove(){this.isHideIn||pt.play(tt.piecePick)}onMoved(){this.gameCharacter&&this.gameCharacter.text&&ze.call("FAREWELL_CHAT_BALLOON",{characterIdentifier:this.gameCharacter.identifier}),this.isHideIn||pt.play(tt.piecePut),this.selected=!1}onImageLoad(){this.naturalImageWidth=this.characterImage.nativeElement.naturalWidth,this.naturalImageHeight=this.characterImage.nativeElement.naturalHeight,this.naturaHeightWidthRatio=this.naturalImageWidth&&this.naturalImageHeight?this.naturalImageHeight/this.naturalImageWidth:1}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(r+=" - "+e.name),this.panelService.open(Ws,{title:r,left:i.x-400,top:i.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(hu,{left:i.x-250,top:i.y-175,width:620,height:350}).character=e}showStandSetting(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(Jp,{left:i.x-400,top:i.y-175,width:730,height:572}).character=e}changeImage(e){this.gameCharacter.currntImageIndex!=e&&(this.gameCharacter.currntImageIndex=e,this.isHideIn||pt.play(tt.surprise),ze.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),ze.trigger("UPDATE_INVENTORY",null))}nextImage(){this.gameCharacter.imageFiles.length<=1||this.changeImage(this.gameCharacter.currntImageIndex+1>=this.gameCharacter.imageFiles.length?0:this.gameCharacter.currntImageIndex+1)}}return t.\u0275fac=function(e){return new(e||t)(He(lr),He(An),He(Oi),He(fi),He(Cn),He(Fn))},t.\u0275cmp=Xt({type:t,selectors:[["game-character"]],viewQuery:function(e,i){if(1&e&&(cn(Ite,5),cn(kte,5)),2&e){let r;ln(r=un())&&(i.characterImage=r.first),ln(r=un())&&(i.chatBubble=r.first)}},hostBindings:function(e,i){1&e&&Ae("dragstart",function(s){return i.onDragstart(s)})("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{gameCharacter:"gameCharacter",is3D:"is3D"},decls:36,vars:85,consts:[["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.option","movable.ondragstart","movable.ondragend"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[1,"pedestal-inner",3,"ngClass"],[1,"pedestal-outer"],[1,"pedestal-grab","rotate-grab"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"is-pointer-events-none","is-3d",2,"transform-origin","center bottom"],[1,"image-box","is-3d",2,"transform-origin","center 66%"],[1,"aura","is-3d",2,"pointer-events","none",3,"ngClass"],[1,"is-3d",2,"pointer-events","none","transition","transform 132ms 0s ease",3,"ngStyle"],["class","image drop-shadow is-3d  chrome-smooth-image-trick","style","pointer-events: none",3,"height","src","filter","ngStyle",4,"ngIf"],[1,"upright-transform","is-fit-width","is-3d",3,"ngClass","ngStyle","dblclick"],["appRotable","",1,"rotate-frame","is-3d",2,"position","absolute",3,"rotable.value","rotable.valueChange","rotable.ondragstart","rotable.ondragend"],[1,"rotate-inner","is-3d"],["class","owner-tag is-nowrap is-black-background is-3d",3,"ngStyle",4,"ngIf"],["class","name-tag is-nowrap is-black-background is-3d",3,"ngClass","ngStyle",4,"ngIf"],[1,"is-pointer-events-none","is-3d","aura",3,"ngClass"],[1,"inverser","is-3d",3,"ngClass"],[1,"image-box","is-3d"],["class","image is-3d chrome-smooth-image-trick",3,"src","ngClass","height","load",4,"ngIf"],[1,"grab-group","is-3d"],[1,"rotate-grab","rotate-grab-icon","of-top","is-3d",3,"ngStyle"],[1,"material-icons"],[1,"rotate-grab","rotate-grab-icon","of-bottom","is-3d",3,"ngStyle"],[1,"chat-bubble","is-3d",3,"ngStyle"],["chatBubble",""],["class","is-3d","style","transform-origin: center bottom;",3,"color",4,"ngIf"],["class","is-3d","style","display: flex; flex-flow: column nowrap; justify-content: space-between; border-left: 2px dashed black; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],[1,"image","drop-shadow","is-3d","chrome-smooth-image-trick",2,"pointer-events","none",3,"src","ngStyle"],[1,"owner-tag","is-nowrap","is-black-background","is-3d",3,"ngStyle"],[1,"fornt-tag","is-3d",2,"color","whitesmoke"],[1,"back-tag","is-3d",2,"color","whitesmoke"],[1,"name-tag","is-nowrap","is-black-background","is-3d",3,"ngClass","ngStyle"],[1,"fornt-tag","has-length-limit","is-3d"],[1,"back-tag","has-length-limit","is-3d"],[1,"image","is-3d","chrome-smooth-image-trick",3,"src","ngClass","load"],["characterImage",""],[1,"is-3d",2,"transform-origin","center bottom"],[1,"is-3d"],[1,"is-3d","chat-bubble-buyo",2,"position","absolute","backface-visibility","hidden",3,"ngClass"],["class","face-icon-box is-3d",4,"ngIf"],[3,"innerHTML"],[1,"is-3d","chat-bubble-buyo","back",2,"backface-visibility","hidden","transform","rotateY(-180deg)",3,"ngClass"],[1,"face-icon-box","is-3d"],[1,"face-icon","is-3d",3,"src"],[1,"is-3d",2,"display","flex","flex-flow","column nowrap","justify-content","space-between","border-left","2px dashed black","transform-origin","top left",3,"ngStyle"],[1,"elevation-indicator","is-3d",2,"position","absolute"],[1,"elevation-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"is-3d",3,"ngStyle"]],template:function(e,i){1&e&&(Q(0,"div",0),Ae("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),Q(1,"div",1)(2,"div",2),Ae("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),ot(3,"div",3)(4,"div",4),Q(5,"div",5)(6,"div",6)(7,"div",7),ye(8,"autorenew"),ie(),Q(9,"div",8),ye(10,"autorenew"),ie()()(),Q(11,"div",9)(12,"div",10)(13,"div",11)(14,"div",12),Te(15,Dte,2,12,"img",13),ie()()()(),Q(16,"div",14),Ae("dblclick",function(){return i.nextImage()}),Q(17,"div",15),Ae("rotable.valueChange",function(s){return i.roll=s})("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Q(18,"div",16),Te(19,Pte,7,6,"div",17),Te(20,Fte,5,8,"div",18),Q(21,"div",19)(22,"div",20)(23,"span",21),Te(24,Rte,3,9,"img",22),ie()()(),Q(25,"div",23)(26,"div",24)(27,"i",25),ye(28,"autorenew"),ie()(),Q(29,"div",26)(30,"i",25),ye(31,"autorenew"),ie()()()()(),Q(32,"div",27,28),Te(34,zte,10,31,"div",29),ie()()(),Te(35,jte,20,18,"div",30),ie()()),2&e&&(Qe("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),re("movable.option",i.movableOption),U(1),re("@bounceInOut","in"),U(1),re("rotable.option",i.rotableOption),U(1),re("@switchImagePedestal",i.gameCharacter.currntImageIndex)("ngClass",Zr(45,Hte,i.selected,!i.gameCharacter.isInventoryIndicate,i.isHideIn)),U(1),re("@switchImagePedestal",i.gameCharacter.currntImageIndex),U(7),Qe("transform","translateX("+(i.size*i.gridSize-i.characterShadowImageWidth)/2+"px) translateY("+i.characterShadowOffset+"px) scale(1.0, 0.66)"),U(1),Qe("width",i.characterShadowImageWidth,"px")("height",i.characterShadowImageHeight,"px")("transform","rotateZ("+i.roll+"deg)"),U(1),re("ngClass",uo(49,kI,0==i.aura,1==i.aura,2==i.aura,3==i.aura,4==i.aura,5==i.aura,6==i.aura,7==i.aura)),U(1),re("ngStyle",ft(58,yf,"scaleX("+(i.isInverse?"-1":"1")+")")),U(1),re("ngIf",i.isDropShadow&&(0<i.imageFile.url.length||0<i.shadowImageFile.url.length)),U(1),re("ngClass",ft(60,Ute,0==i.altitude))("ngStyle",ft(62,yf,"rotateY(90deg) rotateZ(-90deg) rotateY(-90deg) translateY(-50%) translateY("+-i.altitude*i.gridSize+"px)")),U(1),Qe("transform-origin","center "+.333*-i.characterImageHeight+"px"),re("rotable.value",i.roll),U(1),Qe("transform","translateZ("+-i.size*i.gridSize/2+"px)"),U(1),re("ngIf",i.isGMMode&&i.isHideIn&&0<i.ownerName.length),U(1),re("ngIf",0<i.name.length),U(1),re("@switchImage",i.gameCharacter.currntImageIndex)("ngClass",uo(64,kI,0==i.aura,1==i.aura,2==i.aura,3==i.aura,4==i.aura,5==i.aura,6==i.aura,7==i.aura)),U(1),re("ngClass",Zr(73,Vte,i.isInverse,i.isBlackPaint,i.isHollow)),U(1),Qe("width",i.characterImageWidth,"px")("height",i.characterImageHeight,"px")("transform","translateX("+(i.size*i.gridSize-i.characterImageWidth)/2+"px)"),U(1),re("ngIf",0<i.imageFile.url.length),U(2),re("ngStyle",ft(77,yf,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px) translateY("+(-i.characterImageHeight-(i.isGMMode&&i.isHideIn?20:0))+"px)")),U(3),re("ngStyle",ft(79,yf,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px")),U(3),re("ngStyle",Zr(81,Gte,i.chatBubbleAltitude-(i.isEmote?i.gridSize/2:0)-4+"px","translateZ("+-i.size*i.gridSize/2+"px) translateX(-50%) translateX("+i.size*i.gridSize/2+"px) rotateY("+(i.rotate+i.viewRotateZ)+"deg) rotateX("+i.chatBubbleXDeg+"deg)",i.gameCharacter.isShowChatBubble?"visible":"hidden")),U(2),re("ngIf",i.isListen),U(1),re("ngIf",i.isAltitudeIndicate&&(i.altitude<=-.5||.5<=i.altitude)))},directives:[sl,tc,Yn,Ji,bn],pipes:[ai],styles:['[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.upright-transform.fall[_ngcontent-%COMP%]{transition:transform 132ms cubic-bezier(.21,.97,.75,1.25)}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:100%;box-sizing:border-box;border-top:solid 28px #999;border-left:solid 12px #999;border-right:solid 12px #CCC;border-bottom:solid 28px #CCC;border-radius:37px}.pedestal-inner[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 6px #FFCC80;border-radius:25px}.pedestal-inner.not-inventory[_ngcontent-%COMP%]{border-color:#80ccee}.pedestal-outer[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 2px #212121;border-radius:25px}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{bottom:0;left:0;right:0;margin:auto;width:100%;height:auto;vertical-align:bottom}.image-box[_ngcontent-%COMP%]{display:inline-block;text-align:center}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{-o-object-fit:contain;object-fit:contain;-o-object-position:50% 100%;object-position:50% 100%;margin-bottom:0;margin-top:auto;image-rendering:-webkit-optimize-contrast;image-rendering:crisp-edges}.inverse[_ngcontent-%COMP%]{transform:rotateY(-180deg)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #fff)}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:13px;padding:2px 8px;border-radius:12px;position:absolute;top:-26px;transform-origin:center bottom}.owner-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:11px;padding:2px 9px;border-radius:6px;position:absolute;top:-55px;transform-origin:center bottom}.rotate-frame[_ngcontent-%COMP%]{bottom:0;left:0;right:0;overflow:visible}.rotate-inner[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;width:100%;height:auto;overflow:visible}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.is-black-background.is-hide-in-tag[_ngcontent-%COMP%]{color:#1e1e1e;background-color:#e9e9e9cc}.fornt-tag[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.back-tag[_ngcontent-%COMP%]{position:absolute;top:3px;-webkit-backface-visibility:hidden;backface-visibility:hidden;transform:rotateY(-180deg)}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:24em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;bottom:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{position:absolute;width:24px;top:0;left:0;right:0;margin:auto;color:#444}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.altitude-indicator[_ngcontent-%COMP%]{font-size:10px}.elevation-indicator[_ngcontent-%COMP%], .altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;color:#000;text-shadow:#f5f5f5 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.elevation-indicator[_ngcontent-%COMP%]{font-weight:bolder;font-size:12px}.chat-bubble[_ngcontent-%COMP%]{position:absolute;pointer-events:none;transform-origin:center calc(100% + 12px)}.chat-bubble[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{box-sizing:border-box;display:inline-block;max-width:100%;min-width:130px;font-size:13px;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:1px solid;border-radius:24px;margin:0;padding:6px 12px;white-space:pre-wrap;word-break:break-word;overflow-wrap:anywhere;text-align:center}.chat-bubble[_ngcontent-%COMP%]   p.rubied[_ngcontent-%COMP%]{padding-top:12px}.chat-bubble[_ngcontent-%COMP%]   p.emote[_ngcontent-%COMP%]{text-align:center;font-size:38px;font-weight:700;border:none;background:none;min-width:300px;-webkit-text-stroke:1px rgb(240,218,189);letter-spacing:-2px;white-space:pre}.chat-bubble[_ngcontent-%COMP%]   p.is-whisper[_ngcontent-%COMP%]{border-radius:24px 12px;font-size:13px;background:rgba(85,85,85,.8);box-shadow:0 0 2px #ccc}.chat-bubble[_ngcontent-%COMP%]   p.is-whisper.emote[_ngcontent-%COMP%]{font-size:38px;font-weight:700;border:none;background:none;min-width:200px;-webkit-text-stroke:2px #555;box-shadow:none}.chat-bubble[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:after{box-sizing:border-box;content:"";position:absolute;padding:0;line-height:1;vertical-align:baseline;left:50%;margin:0 0 0 -8px;bottom:-17px;border:8px solid transparent;border-top-color:inherit}.chat-bubble[_ngcontent-%COMP%]   p.emote[_ngcontent-%COMP%]:after{border:0px none transparent}.chat-bubble[_ngcontent-%COMP%]   p.is-whisper.emote[_ngcontent-%COMP%]:after{content:none}.chat-bubble-buyo[_ngcontent-%COMP%]{transform-origin:center calc(100% + 8px);transition:all .2s ease;animation:chat-bubble-buyo 1.2s ease-in-out .1s infinite alternate;transform:scale3d(.9,.9,.9)}.chat-bubble-buyo.back[_ngcontent-%COMP%]{transform-origin:center calc(100% + 8px);transition:all .2s ease;animation:chat-bubble-buyo-back 1.2s ease-in-out .1s infinite alternate;transform:rotateY(-180deg) scale3d(.9,.9,.9)}.chat-bubble-buyo.emote[_ngcontent-%COMP%]{animation-duration:.6s}@keyframes chat-bubble-buyo{0%{transform:scale3d(.9,.9,.9)}to{transform:scale(1)}}@keyframes chat-bubble-buyo-back{0%{transform:rotateY(-180deg) scale3d(.9,.9,.9)}to{transform:rotateY(-180deg) scale(1)}}.drop-shadow[_ngcontent-%COMP%]{pointer-events:none}.face-icon-box[_ngcontent-%COMP%]{display:block;position:relative;border:0px none;width:36px;height:36px;max-width:36px;max-height:36px;overflow:hidden;left:-20px;top:-18px;margin-right:-16px;margin-bottom:-22px;float:left;-webkit-backface-visibility:hidden;backface-visibility:hidden}p.rubied[_ngcontent-%COMP%]   .face-icon-box[_ngcontent-%COMP%]{top:-21px}.face-icon-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:.4em}.selected[_ngcontent-%COMP%]{filter:drop-shadow(0px 0px 8px yellow) drop-shadow(0px 0px 4px yellow);transition:all .2s ease-in}.is-hide-in-pedestal[_ngcontent-%COMP%]{filter:grayscale(70%)}.is-hide-in-pedestal.selected[_ngcontent-%COMP%]{filter:grayscale(70%) drop-shadow(0px 0px 8px yellow) drop-shadow(0px 0px 4px yellow)}.is-hide-in[_ngcontent-%COMP%]{filter:invert(85%) opacity(85%)}'],data:{animation:[Sn("switchImage",[Lt(":increment, :decrement",[Rt("400ms ease",sn([et({transform:"scale3d(0.8, 0.8, 0.8) rotateY(0deg)"}),et({transform:"scale3d(1.2, 1.2, 1.2) rotateY(180deg)"}),et({transform:"scale3d(1.0, 1.0, 1.0) rotateY(360deg)"})]))])]),Sn("switchImageShadow",[Lt(":increment, :decrement",[Rt("400ms ease",sn([et({transform:"scale3d(0.8, 0.8, 0.8)"}),et({transform:"scale3d(0, 1.2, 1.2)"}),et({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),Sn("switchImagePedestal",[Lt(":increment, :decrement",[Rt("400ms ease",sn([et({transform:"scale3d(0, 0, 0)"}),et({transform:"scale3d(1.2, 1.2, 1.2)"}),et({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),Sn("bounceInOut",[Lt("void => *",[Rt("600ms ease",sn([et({transform:"scale3d(0, 0, 0)",offset:0}),et({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),et({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),et({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),et({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Lt("* => void",[Rt(100,et({transform:"scale3d(0, 0, 0)"}))])]),Sn("fadeAndScaleInOut",[Lt("void => *, true => false",[Rt("200ms ease-in-out",sn([et({transform:"scale3d(0, 0, 0)",opacity:0}),et({transform:"scale3d(1.0, 1.0, 1.0)",opacity:.8})]))]),Lt("* => void, true => false",[Rt("100ms ease-in-out",et({transform:"scale3d(0, 0, 0)",opacity:0}))])])]},changeDetection:0}),t})();const Wte=["cursor"],Kte=["opacity"],Yte=["rotate"];function Zte(t,n){if(1&t&&(Q(0,"div",8)(1,"div",9),Et(2,"safe"),Q(3,"div",10)(4,"span",11),ye(5),ie()()()()),2&t){const e=n.$implicit,i=_e(2);Qe("background-color",i.color),re("ngClass",e),U(1),Qe("background-image",Tt(2,8,"url("+i.iconUrl+")","style")),U(2),Qe("background-color",i.color),U(2),Xe(i.name)}}const Xte=function(){return["is-front","is-back"]};function Qte(t,n){1&t&&(Ke(0),Q(1,"div",1,2)(3,"div",3,4)(5,"div",5,6),Te(7,Zte,6,11,"div",7),ie()()(),Ye()),2&t&&(U(7),re("ngForOf",sa(1,Xte)))}class Nr{constructor(n,e,i,r){this.changeDetector=n,this.batchService=e,this.coordinateService=i,this.ngZone=r,this.cursor=We.myCursor,this.cursorElement=null,this.opacityElement=null,this.rotateElement=null,this.fadeOutTimer=null,this.updateInterval=null,this.callcack=s=>this.onMouseMove(s),this._x=0,this._y=0}get iconUrl(){return this.cursor.image.url}get name(){return this.cursor.name}get isMine(){return this.cursor.isMine}get color(){return this.cursor.color&&"#ffffff"!=this.cursor.color?this.cursor.color:"#f0dabd"}get rotateZ(){return Nr.viewRotateZ}get nameTagRotate(){let n=Nr.viewRotateX%360-90;return-(n>0?n:360+n)}get delayMs(){let n=16.6*xt.peerIds.length;return n<100?100:n}ngOnInit(){this.isMine||ze.register(this).on("CURSOR_MOVE",n=>{n.sendFrom===this.cursor.peerId&&this.batchService.add(()=>{this.stopTransition(),this.setAnimatedTransition(),this.setPosition(n.data[0],n.data[1],n.data[2]),this.setRotate(),this.resetFadeOut(),this.changeDetector.markForCheck()},this)}).on("TABLE_VIEW_ROTATE",-1e3,n=>{this.ngZone.run(()=>{Nr.viewRotateX=n.data.x,Nr.viewRotateZ=n.data.z,this.rotateElement&&this.setRotate(),this.changeDetector.markForCheck()})})}ngAfterViewInit(){this.isMine?this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousemove",this.callcack),document.body.addEventListener("touchmove",this.callcack)}):(this.cursorElement=this.cursorElementRef.nativeElement,this.opacityElement=this.opacityElementRef.nativeElement,this.rotateElement=this.rotateElementRef.nativeElement,this.setAnimatedTransition(),this.setPosition(0,0,0),this.resetFadeOut())}ngOnDestroy(){document.body.removeEventListener("mousemove",this.callcack),document.body.removeEventListener("touchmove",this.callcack),ze.unregister(this),this.batchService.remove(this),this.fadeOutTimer&&this.fadeOutTimer.clear()}onMouseMove(n){let e=n.touches?n.changedTouches[0].pageX:n.pageX,i=n.touches?n.changedTouches[0].pageY:n.pageY;e===this._x&&i===this._y||(this._x=e,this._y=i,this._target=n.target,this.updateInterval||(this.updateInterval=setTimeout(()=>{this.updateInterval=null,this.calcLocalCoordinate(this._x,this._y,this._target)},this.delayMs)))}calcLocalCoordinate(n,e,i){if(!document.getElementById("app-table-layer").contains(i))return;let r={x:n,y:e,z:0};r=this.coordinateService.calcTabletopLocalCoordinate(r,i),ze.call("CURSOR_MOVE",[r.x,r.y,r.z])}resetFadeOut(){this.opacityElement.style.opacity="1.0",null==this.fadeOutTimer&&(this.fadeOutTimer=new ha(()=>{this.opacityElement.style.opacity="0.0"},3e3)),this.fadeOutTimer.reset()}stopTransition(){this.cursorElement.style.transform=window.getComputedStyle(this.cursorElement).transform}setAnimatedTransition(){this.cursorElement.style.transition=`transform ${this.delayMs+33}ms linear, opacity 0.5s ease-out`}setPosition(n,e,i){this.cursorElement.style.transform=`translateX(${n.toFixed(4)}px) translateY(${e.toFixed(4)}px) translateZ(${i.toFixed(4)}px)`}setRotate(){this.rotateElement.style.transform=`rotateZ(${-this.rotateZ}deg) rotateX(${this.nameTagRotate}deg)`}}Nr.viewRotateX=50,Nr.viewRotateZ=10,Nr.ctor=void ze.register(Nr).on("TABLE_VIEW_ROTATE",-1e3,t=>{Nr.viewRotateX=t.data.x,Nr.viewRotateZ=t.data.z}),Nr.\u0275fac=function(n){return new(n||Nr)(He(Oi),He(dg),He(tl),He(Cn))},Nr.\u0275cmp=Xt({type:Nr,selectors:[["peer-cursor"],["","peer-cursor",""]],viewQuery:function(n,e){if(1&n&&(cn(Wte,5),cn(Kte,5),cn(Yte,5)),2&n){let i;ln(i=un())&&(e.cursorElementRef=i.first),ln(i=un())&&(e.opacityElementRef=i.first),ln(i=un())&&(e.rotateElementRef=i.first)}},inputs:{cursor:"cursor"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"component","is-3d","is-transition","is-pointer-events-none"],["cursor",""],[1,"is-3d"],["rotate",""],[1,"upright-transform","is-3d","is-transition"],["opacity",""],["class","peer-cursor is-3d",3,"ngClass","background-color",4,"ngFor","ngForOf"],[1,"peer-cursor","is-3d",3,"ngClass"],[1,"icon","is-3d"],[1,"name","is-center","is-3d"],[1,"is-3d",2,"white-space","nowrap","color","whitesmoke"]],template:function(n,e){1&n&&Te(0,Qte,8,2,"ng-container",0),2&n&&re("ngIf",!e.isMine)},directives:[bn,oi,Yn],pipes:[ai],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;overflow:visible;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.is-transition[_ngcontent-%COMP%]{transition:transform 133ms linear,opacity .5s ease-out}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.peer-cursor[_ngcontent-%COMP%]{height:45px;width:45px;position:absolute;left:0;top:0;box-sizing:border-box;border:solid 1px rgba(240,218,189);border-radius:50% 50% 5%;opacity:.7;transform-origin:100% 100%;-webkit-backface-visibility:hidden;backface-visibility:hidden}.is-front[_ngcontent-%COMP%]{transform:translate(-100%) translateY(-100%) rotateX(-90deg) rotate(45deg)}.is-back[_ngcontent-%COMP%]{transform:translate(-100%) translateY(-100%) rotateX(-90deg) rotateY(180deg) rotate(45deg)}.icon[_ngcontent-%COMP%]{overflow:visible;height:100%;width:100%;border-radius:100%;background-position:top,center;background-repeat:no-repeat;background-size:cover;background-color:#f0dabd;transform:rotate(-45deg) scale(.85)}.name[_ngcontent-%COMP%]{box-sizing:border-box;font-size:7px;padding:2px 5px;border-radius:14px;color:#ccc;background-color:#1e1e1ecc;transform-origin:center}.is-center[_ngcontent-%COMP%]{position:absolute;left:50%;top:-26px;transform:translate(-50%)}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}"]});const Jte=["root"],ene=["gameTable"],tne=["gameObjects"],nne=["gridCanvas"];function ine(t,n){if(1&t&&(Ke(0),ot(1,"terrain",18),Ye()),2&t){const e=_e().$implicit;U(1),Qe("z-index",e.height>0?0:1),re("terrain",e)("appTooltip",e)}}function rne(t,n){if(1&t&&(Ke(0),ot(1,"terrain",19),Ye()),2&t){const e=_e().$implicit;U(1),Qe("z-index",e.height>0?0:1),re("terrain",e)}}function sne(t,n){if(1&t&&(Ke(0),Te(1,ine,2,4,"ng-container",17),Te(2,rne,2,3,"ng-container",17),Ye()),2&t){const e=n.$implicit;U(1),re("ngIf",e.detailDataElement&&0<e.detailDataElement.children.length),U(1),re("ngIf",!e.detailDataElement||e.detailDataElement.children.length<=0)}}function one(t,n){if(1&t&&(Ke(0),ot(1,"game-table-mask",20),Ye()),2&t){const e=_e().$implicit;U(1),re("gameTableMask",e)("appTooltip",e)}}function ane(t,n){if(1&t&&(Ke(0),ot(1,"game-table-mask",21),Ye()),2&t){const e=_e().$implicit;U(1),re("gameTableMask",e)}}function lne(t,n){if(1&t&&(Ke(0),Te(1,one,2,2,"ng-container",17),Te(2,ane,2,1,"ng-container",17),Ye()),2&t){const e=n.$implicit;U(1),re("ngIf",e.detailDataElement&&0<e.detailDataElement.children.length),U(1),re("ngIf",!e.detailDataElement||e.detailDataElement.children.length<=0)}}const cne=function(t){return{"z-index":t}};function une(t,n){if(1&t&&ot(0,"text-note",22),2&t){const e=n.$implicit;re("textNote",e)("appTooltip",e)("ngStyle",ft(3,cne,e.zindex))}}const MI=function(t,n){return{"z-index":t,transform:n}};function dne(t,n){if(1&t&&ot(0,"card-stack",23),2&t){const e=n.$implicit;re("cardStack",e)("appTooltip",e)("ngStyle",Yt(3,MI,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function fne(t,n){if(1&t&&ot(0,"card",24),2&t){const e=n.$implicit;re("card",e)("appTooltip",e)("ngStyle",Yt(3,MI,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function hne(t,n){if(1&t&&ot(0,"range",25),2&t){const e=n.$implicit;re("range",e)("appTooltip",e)}}function pne(t,n){if(1&t&&ot(0,"dice-symbol",26),2&t){const e=n.$implicit;re("diceSymbol",e)("appTooltip",e)}}function gne(t,n){if(1&t&&(Ke(0),ot(1,"game-character",27),Ye()),2&t){const e=_e().$implicit;U(1),Qe("display",e.isLoaded?"":"none"),re("gameCharacter",e)("appTooltip",e)}}function _ne(t,n){if(1&t&&(Ke(0),Te(1,gne,2,4,"ng-container",17),Ye()),2&t){const e=n.$implicit,i=_e();U(1),re("ngIf",e&&(e.isVisible||i.isGMMode))}}function mne(t,n){if(1&t&&ot(0,"peer-cursor",28),2&t){const e=n.$implicit,i=_e();Qe("display",i.isCursorHidIn(e)&&!i.isGMMode?"none":""),re("cursor",e)}}const $ne=function(t,n,e){return[t,n,e]},vne=function(t){return{"is-grabbing":t}},bne=function(t){return{transform:t}};let yne=(()=>{class t{constructor(e,i,r,s,o,a,h,w){this.ngZone=e,this.contextMenuService=i,this.pointerDeviceService=r,this.coordinateService=s,this.imageService=o,this.tabletopService=a,this.tabletopActionService=h,this.modalService=w,this.isTableTransformMode=!1,this.isTableTransformed=!1,this.viewPotisonX=100,this.viewPotisonY=0,this.viewPotisonZ=0,this.viewRotateX=50,this.viewRotateY=0,this.viewRotateZ=10,this.mouseGesture=null,this.touchGesture=null}get tableSelecter(){return this.tabletopService.tableSelecter}get currentTable(){return this.tabletopService.currentTable}get gridHeight(){return this.tabletopService.currentTable.gridHeight}get tableImage(){return this.imageService.getSkeletonOr(this.currentTable.imageIdentifier)}get backgroundImage(){return this.imageService.getEmptyOr(this.currentTable.backgroundImageIdentifier)}get backgroundFilterType(){return this.currentTable.backgroundFilterType}get isPointerDragging(){return this.pointerDeviceService.isDragging}get characters(){return this.tabletopService.characters}get tableMasks(){return this.tabletopService.tableMasks}get cards(){return this.tabletopService.cards}get cardStacks(){return this.tabletopService.cardStacks}get ranges(){return this.tabletopService.ranges}get terrains(){return this.tabletopService.terrains}get textNotes(){return this.tabletopService.textNotes}get diceSymbols(){return this.tabletopService.diceSymbols}get peerCursors(){return this.tabletopService.peerCursors}get isStealthMode(){return Gt.isStealthMode}get isGMMode(){return We.myCursor&&We.myCursor.isGMMode}ngOnInit(){ze.register(this).on("UPDATE_GAME_OBJECT",e=>{e.data.identifier!==this.currentTable.identifier&&e.data.identifier!==this.tableSelecter.identifier||(console.log("UPDATE_GAME_OBJECT GameTableComponent "+this.currentTable.identifier),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor,this.currentTable.isShowNumber))}).on("DRAG_LOCKED_OBJECT",e=>{this.isTableTransformMode=!0,this.pointerDeviceService.isDragging=!1,this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}).on("RESET_POINT_OF_VIEW",e=>{this.isTableTransformMode=!1,this.pointerDeviceService.isDragging=!1,this.setTransform(this.viewPotisonX,this.viewPotisonY,this.viewPotisonZ,this._rightRotate(this.viewRotateX),this._rightRotate(this.viewRotateY,!0),this._rightRotate(this.viewRotateZ),!0),setTimeout(()=>{this.gridCanvas.nativeElement.style.opacity="0.0",this.gameTable.nativeElement.style.transition="0.1s ease-out",setTimeout(()=>{this.gameTable.nativeElement.style.transition=null},100),e&&"top"==e.data?this.setTransform(0,0,0,0,0,0,!0):this.setTransform(100,0,0,50,0,10,!0)},50),this.removeFocus()}).on("FOCUS_TABLETOP_OBJECT",e=>{setTimeout(()=>{console.log(`move table to focus (${e.data.x}, ${e.data.y})`),this.gameTable.nativeElement.style.transition="0.1s ease-out",setTimeout(()=>{this.gameTable.nativeElement.style.transition=null},100);let s=e.data.x-this.gridCanvas.nativeElement.clientWidth/2,o=e.data.y-this.gridCanvas.nativeElement.clientHeight/2,a=e.data.z,h=this.viewRotateZ/180*Math.PI,w=s*Math.cos(h)-o*Math.sin(h),X=s*Math.sin(h)+o*Math.cos(h),fe=this.viewRotateX/180*Math.PI,pe=X*Math.cos(fe),we=X*Math.sin(fe)+a;this.setTransform(100-w-this.viewPotisonX,-pe-this.viewPotisonY,-we-this.viewPotisonZ,0,0,0)},50)}),this.tabletopActionService.makeDefaultTable(),this.tabletopActionService.makeDefaultTabletopObjects()}_rightRotate(e,i=!1){let r=e%360;return i||(r>180?r-=360:r<-180&&(r+=360)),r}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.initializeTableTouchGesture(),this.initializeTableMouseGesture()}),this.cancelInput(),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor),this.setTransform(0,0,0,0,0,0),this.coordinateService.tabletopOriginElement=this.gameObjects.nativeElement}ngOnDestroy(){ze.unregister(this),this.mouseGesture.destroy(),this.touchGesture.destroy()}initializeTableTouchGesture(){this.touchGesture=new sQ(this.rootElementRef.nativeElement,this.ngZone),this.touchGesture.onstart=this.onTableTouchStart.bind(this),this.touchGesture.onend=this.onTableTouchEnd.bind(this),this.touchGesture.ongesture=this.onTableTouchGesture.bind(this),this.touchGesture.ontransform=this.onTableTouchTransform.bind(this)}initializeTableMouseGesture(){this.mouseGesture=new rQ(this.rootElementRef.nativeElement),this.mouseGesture.onstart=this.onTableMouseStart.bind(this),this.mouseGesture.onend=this.onTableMouseEnd.bind(this),this.mouseGesture.ontransform=this.onTableMouseTransform.bind(this)}onTableTouchStart(){this.mouseGesture.cancel()}onTableTouchEnd(){this.cancelInput()}onTableTouchGesture(){this.cancelInput()}onTableTouchTransform(e,i,r,s,o,a,h,w){if(!this.isTableTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),w.cancelable&&w.preventDefault();let X=(1e3+Math.abs(this.viewPotisonZ))/1e3;80<s+this.viewRotateX&&(s+=80-(s+this.viewRotateX)),s+this.viewRotateX<0&&(s+=0-(s+this.viewRotateX)),750<r+this.viewPotisonZ&&(r+=750-(r+this.viewPotisonZ)),this.setTransform(e*=X,i*=X,r,s,o,a),this.isTableTransformed=!0}onTableMouseStart(e){e.target.contains(this.gameObjects.nativeElement)||1===e.button||2===e.button?this.isTableTransformMode=!0:(this.isTableTransformMode=!1,this.pointerDeviceService.isDragging=!0,this.gridCanvas.nativeElement.style.opacity="1"),document.activeElement.contains(e.target)||(this.removeSelectionRanges(),this.removeFocus())}onTableMouseEnd(e){this.cancelInput()}onTableMouseTransform(e,i,r,s,o,a,h,w){if(!this.isTableTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),w.cancelable&&w.preventDefault();let X=(1e3+Math.abs(this.viewPotisonZ))/1e3;this.setTransform(e*=X,i*=X,r,s,o,a),this.isTableTransformed=!0}cancelInput(){this.mouseGesture.cancel(),this.isTableTransformMode=!0,this.pointerDeviceService.isDragging=!1,this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}onContextMenu(e){if(!document.activeElement.contains(this.gameObjects.nativeElement)||(e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate(),s=[];Array.prototype.push.apply(s,this.tabletopActionService.makeDefaultContextMenuActions(r)),s.push(kt),s.push({name:"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a",action:()=>{this.modalService.open(tI)}}),this.contextMenuService.open(i,s,this.currentTable.name)}onDocumentMouseDown(e){this.isTableTransformed=!1}onDocumentTouchStart(e){this.isTableTransformed=!1}onDocumentContextMenu(e){this.isTableTransformed&&!this.pointerDeviceService.isAllowedToOpenContextMenu&&e.preventDefault()}setTransform(e,i,r,s,o,a,h=!1){h?(this.viewRotateX=s,this.viewRotateY=o,this.viewRotateZ=a,this.viewPotisonX=e,this.viewPotisonY=i,this.viewPotisonZ=r):(this.viewRotateX+=s,this.viewRotateY+=o,this.viewRotateZ+=a,this.viewPotisonX+=e,this.viewPotisonY+=i,this.viewPotisonZ+=r),(h||0!=s||0!=o||0!=s)&&this.ngZone.run(()=>{ze.trigger("TABLE_VIEW_ROTATE",{x:this.viewRotateX,y:this.viewRotateY,z:this.viewRotateZ})}),this.gameTable.nativeElement.style.transform=`translateZ(${this.viewPotisonZ.toFixed(4)}px) translateY(${this.viewPotisonY.toFixed(4)}px) translateX(${this.viewPotisonX.toFixed(4)}px) rotateY(${this.viewRotateY.toFixed(4)}deg) rotateX(${this.viewRotateX.toFixed(4)+"deg) rotateZ("+this.viewRotateZ.toFixed(4)}deg)`}setGameTableGrid(e,i,r=50,s=Gs.SQUARE,o="#000000e6",a=!0){this.gameTable.nativeElement.style.width=e*r+"px",this.gameTable.nativeElement.style.height=i*r+"px",new iQ(this.gridCanvas.nativeElement).render(e,i,r,s,o,a),this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}removeSelectionRanges(){let e=window.getSelection();e.isCollapsed||e.removeAllRanges()}removeFocus(){document.activeElement instanceof HTMLElement&&document.activeElement.blur()}trackByGameObject(e,i){return i.identifier}isCursorHidIn(e){if(e.isGMMode)return!0;for(let i of this.characters)if(i.isHideIn&&"table"===i.location.name&&i.owner===e.userId)return!0;return!1}}return t.\u0275fac=function(e){return new(e||t)(He(Cn),He(lr),He(fi),He(tl),He(wu),He(vu),He(mg),He(Fn))},t.\u0275cmp=Xt({type:t,selectors:[["game-table"]],viewQuery:function(e,i){if(1&e&&(cn(Jte,7),cn(ene,7),cn(tne,7),cn(nne,7)),2&e){let r;ln(r=un())&&(i.rootElementRef=r.first),ln(r=un())&&(i.gameTable=r.first),ln(r=un())&&(i.gameObjects=r.first),ln(r=un())&&(i.gridCanvas=r.first)}},hostBindings:function(e,i){1&e&&Ae("contextmenu",function(s){return i.onContextMenu(s)})("mousedown",function(s){return i.onDocumentMouseDown(s)},!1,lh)("touchstart",function(s){return i.onDocumentTouchStart(s)},!1,lh)("contextmenu",function(s){return i.onDocumentContextMenu(s)},!1,lh)},decls:21,vars:39,consts:[[1,"background-image","is-pointer-events-none",3,"ngClass"],[1,"component","is-fill","is-perspective",3,"ngClass"],["root",""],[1,"component-content","is-fill","is-3d"],["gameTable",""],["id","app-game-table",1,"game-table","table-image","is-3d"],["gameObjects",""],[1,"grid-canvas","is-fill","is-pointer-events-none",3,"ngStyle"],["gridCanvas",""],[1,"is-fill","is-3d","is-pointer-events-none"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"textNote","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"cardStack","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"card","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"range","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"diceSymbol","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"cursor","display",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],[1,"is-3d",3,"terrain","appTooltip"],[1,"is-3d",3,"terrain"],[1,"is-3d",3,"gameTableMask","appTooltip"],[1,"is-3d",3,"gameTableMask"],[1,"is-3d",3,"textNote","appTooltip","ngStyle"],[1,"is-3d",3,"cardStack","appTooltip","ngStyle"],[1,"is-3d",3,"card","appTooltip","ngStyle"],[1,"is-3d",3,"range","appTooltip"],[1,"is-3d",3,"diceSymbol","appTooltip"],[1,"is-3d",3,"gameCharacter","appTooltip"],[1,"is-3d",3,"cursor"]],template:function(e,i){1&e&&(Q(0,"div",0),Et(1,"safe"),ie(),Q(2,"div",1,2)(4,"div",3,4)(6,"div",5,6),Et(8,"safe"),ot(9,"canvas",7,8),Q(11,"div",9),Te(12,sne,3,2,"ng-container",10),ie(),Te(13,lne,3,2,"ng-container",10),Te(14,une,1,5,"text-note",11),Te(15,dne,1,6,"card-stack",12),Te(16,fne,1,6,"card",13),Te(17,hne,1,2,"range",14),Te(18,pne,1,2,"dice-symbol",15),Te(19,_ne,2,1,"ng-container",10),Te(20,mne,1,3,"peer-cursor",16),ie()()()),2&e&&(Qe("background-image",Tt(1,25,"url("+i.backgroundImage.url+")","style")),re("ngClass",Zr(31,$ne,i.backgroundFilterType?"is-filter":"",i.isStealthMode&&!i.isGMMode?"is-hide-in":"",i.backgroundFilterType)),U(2),re("ngClass",ft(35,vne,i.isPointerDragging)),U(4),Qe("background-image",Tt(8,28,"url("+i.tableImage.url+")","style")),U(3),re("ngStyle",ft(37,bne,"translateZ("+(i.gridHeight+.1)+"px)")),U(3),re("ngForOf",i.terrains)("ngForTrackBy",i.trackByGameObject),U(1),re("ngForOf",i.tableMasks)("ngForTrackBy",i.trackByGameObject),U(1),re("ngForOf",i.textNotes)("ngForTrackBy",i.trackByGameObject),U(1),re("ngForOf",i.cardStacks)("ngForTrackBy",i.trackByGameObject),U(1),re("ngForOf",i.cards)("ngForTrackBy",i.trackByGameObject),U(1),re("ngForOf",i.ranges)("ngForTrackBy",i.trackByGameObject),U(1),re("ngForOf",i.diceSymbols)("ngForTrackBy",i.trackByGameObject),U(1),re("ngForOf",i.characters)("ngForTrackBy",i.trackByGameObject),U(1),re("ngForOf",i.peerCursors)("ngForTrackBy",i.trackByGameObject))},directives:[Yn,Ji,oi,bn,xQ,yI,$ee,Mee,Vee,Qee,cte,Ste,qte,Nr],pipes:[ai],styles:['[_nghost-%COMP%]{display:block}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-perspective[_ngcontent-%COMP%]{perspective:1000px}.is-fill[_ngcontent-%COMP%]{display:block;position:absolute;inset:0;margin:auto}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.component[_ngcontent-%COMP%]{-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;touch-action:manipulation;height:100%;width:100%;overflow:hidden}.component-content[_ngcontent-%COMP%]{height:2000px;width:2000px}.grid-canvas[_ngcontent-%COMP%]{opacity:0;transform:translateZ(.15px);transition:.1s ease-out;-webkit-backface-visibility:hidden;backface-visibility:hidden}.game-table[_ngcontent-%COMP%]{height:100%;width:100%}.table-image[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;background-repeat:no-repeat;background-size:100% 100%}.background-image[_ngcontent-%COMP%]{position:absolute;inset:0;margin:-5px;background-repeat:no-repeat;background-position:center;background-size:cover;transition:filter .2s ease-in-out}.background-image.is-filter[_ngcontent-%COMP%]{will-change:filter}.background-image.is-filter.white[_ngcontent-%COMP%], .background-image.is-filter.black[_ngcontent-%COMP%]{filter:blur(5px)}.background-image.is-filter[_ngcontent-%COMP%]:after{display:block;content:"";width:100%;height:100%}.background-image.is-filter.white[_ngcontent-%COMP%]:after{background-color:#f7f7f7;filter:opacity(.2)}.background-image.is-filter.black[_ngcontent-%COMP%]:after{background-color:#1a1a1a;filter:opacity(.3)}.background-image.is-filter.is-hide-in.white[_ngcontent-%COMP%]:after{background-color:#1a1a1a;filter:opacity(.3)}.background-image.is-filter.is-hide-in.black[_ngcontent-%COMP%]:after{background-color:#f7f7f7;filter:opacity(.2)}.background-image.is-filter.is-hide-in[_ngcontent-%COMP%]{filter:invert(85%) blur(5px);-webkit-backdrop-filter:invert(85%);backdrop-filter:invert(85%)}.background-image.is-hide-in[_ngcontent-%COMP%]{filter:invert(85%);-webkit-backdrop-filter:invert(85%);backdrop-filter:invert(85%);background-color:#ffcc80}']}),t})(),Cne=(()=>{class t{constructor(e){this.elementRef=e,this.timer=null,this.needRepeat=!1}ngAfterViewInit(){let e=()=>{this.needRepeat?(this.timer=setTimeout(e,650),this.needRepeat=!1):(this.timer=null,this.elementRef.nativeElement.style.display="none")};ze.register(this).on("*",i=>{this.needRepeat||xt.bandwidthUsage<3072||(null===this.timer?(this.elementRef.nativeElement.style.display="block",this.timer=setTimeout(e,650)):this.needRepeat=!0)})}ngOnDestroy(){ze.unregister(this)}}return t.\u0275fac=function(e){return new(e||t)(He(yi))},t.\u0275cmp=Xt({type:t,selectors:[["network-indicator"]],decls:12,vars:0,consts:[[1,"sk-cube-grid"],[1,"sk-cube","sk-cube1"],[1,"sk-cube","sk-cube2"],[1,"sk-cube","sk-cube3"],[1,"sk-cube","sk-cube4"],[1,"sk-cube","sk-cube5"],[1,"sk-cube","sk-cube6"],[1,"sk-cube","sk-cube7"],[1,"sk-cube","sk-cube8"],[1,"sk-cube","sk-cube9"],[1,"sk-title"]],template:function(e,i){1&e&&(Q(0,"div",0),ot(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9),Q(10,"div",10),ye(11,"sync"),ie()())},styles:["[_nghost-%COMP%]{display:block}.sk-cube-grid[_ngcontent-%COMP%]{font-size:8px;color:#444;height:100%;width:100%;background-color:#f7f7f799}.sk-cube[_ngcontent-%COMP%]{background-color:#555}.sk-title[_ngcontent-%COMP%]{padding:2px 0;background-color:#f7f7f799}"]}),t})();const xne=["modalLayer"];function wne(t,n){if(1&t){const e=it();Q(0,"li",3),Ae("click",function(){return Oe(e),_e().save()}),Q(1,"a",4)(2,"div")(3,"i",6),ye(4,"sd_storage"),ie()(),Q(5,"div"),ye(6,"\u4fdd\u5b58"),ie()()()}}function Ene(t,n){if(1&t&&(Q(0,"li",14)(1,"a")(2,"div")(3,"i",15),ye(4,"sd_storage"),ie()(),Q(5,"div"),ye(6),ie()()()),2&t){const e=_e();U(6),Rn("",e.progresPercent,"%")}}const Tne=function(t){return{horizontal:t}};let Sne=(()=>{class t{constructor(e,i,r,s,o,a,h,w,X,fe,pe){var we=this;this.swUpdate=e,this.modalService=i,this.panelService=r,this.pointerDeviceService=s,this.chatMessageService=o,this.appConfigService=a,this.saveDataService=h,this.ngZone=w,this.contextMenuService=X,this.standImageService=fe,this.cutInService=pe,this.immediateUpdateTimer=null,this.lazyUpdateTimer=null,this.openPanelCount=0,this.isSaveing=!1,this.progresPercent=0,this.isHorizontal=!1,this.isLoggedin=!1,this.isUpdateCanceled=!1,this.ngZone.runOutsideAngular(()=>{Wo.instance.initialize(),yu.instance.initialize(),bu.instance.initialize(),Cu.instance.initialize()}),this.appConfigService.initialize(),this.pointerDeviceService.initialize(),dr.instance.initialize(),mo.instance.initialize(),Zo.instance.initialize(),new Gn("DiceBot",this.chatMessageService).initialize(),Gn.getHelpMessage("").then(()=>this.lazyNgZoneUpdate(!0)),new Jl("Jukebox").initialize(),new pt("SoundEffect").initialize(),mo.instance.addChatTab("\u30e1\u30a4\u30f3\u30bf\u30d6","MainTab"),mo.instance.addChatTab("\u30b5\u30d6\u30bf\u30d6","SubTab").recieveOperationLogLevel=1,_o.instance.initialize();let Fe=new ga("SampleDiceRollTable");Fe.initialize(),Fe.name="\u30b5\u30f3\u30d7\u30eb\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868",Fe.command="SAMPLE",Fe.dice="1d6",Fe.value="1:\u3053\u308c\u306f\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u30b5\u30f3\u30d7\u30eb\u3067\u3059\n2:\u6570\u5b57\u3068\u5bfe\u5fdc\u3059\u308b\u7d50\u679c\u30921\u884c\u306b1\u3064\u3065\u3064:\uff08\u30b3\u30ed\u30f3\uff09\u3067\u533a\u5207\u308a\n3:\u6570\u5b57:\u7d50\u679c\u306e\u3088\u3046\u306b\u8a18\u8ff0\u3057\u307e\u3059\n4:\\\\n  \\n\u3067\u6539\u884c\u3057\u307e\u3059\n5-6:\u307e\u305f\u3001-\uff08\u30cf\u30a4\u30d5\u30f3\uff09\u3067\u533a\u5207\u3063\u3066\u6570\u5b57\u306e\u7bc4\u56f2\u3092\u6307\u5b9a\u53ef\u80fd\u3067\u3059",go.instance.addDiceRollTable(Fe);let Ve=Ut.createEmpty("none_icon").toContext();Ve.url="./assets/images/ic_account_circle_black_24dp_2x.png";let Ge=Nt.instance.add(Ve);wn.create(Ge.identifier).tag="*default \u30a2\u30a4\u30b3\u30f3",Ve=Ut.createEmpty("stand_no_image").toContext(),Ve.url="./assets/images/nc96424.png";let ct=Nt.instance.add(Ve);wn.create(ct.identifier).tag="*default \u30b9\u30bf\u30f3\u30c9",Ft.resumeAudioContext(),tt.dicePick=zt.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,tt.dicePut=zt.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,tt.diceRoll1=zt.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu01.mp3").identifier,tt.diceRoll2=zt.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu02.mp3").identifier,tt.cardDraw=zt.instance.add("./assets/sounds/soundeffect-lab/card-turn-over1.mp3").identifier,tt.cardPick=zt.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,tt.cardPut=zt.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,tt.cardShuffle=zt.instance.add("./assets/sounds/soundeffect-lab/card-open1.mp3").identifier,tt.piecePick=zt.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,tt.piecePut=zt.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,tt.blockPick=zt.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,tt.blockPut=zt.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,tt.lock=zt.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,tt.unlock=zt.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,tt.sweep=zt.instance.add("./assets/sounds/tm2/tm2_swing003.wav").identifier,tt.puyon=zt.instance.add("./assets/sounds/soundeffect-lab/puyon1.mp3").identifier,tt.surprise=zt.instance.add("./assets/sounds/otologic/Onmtp-Surprise02-1.mp3").identifier,tt.coinToss=zt.instance.add("./assets/sounds/niconicomons/nc146227.mp3").identifier,zt.instance.get(tt.dicePick).isHidden=!0,zt.instance.get(tt.dicePut).isHidden=!0,zt.instance.get(tt.diceRoll1).isHidden=!0,zt.instance.get(tt.diceRoll2).isHidden=!0,zt.instance.get(tt.cardDraw).isHidden=!0,zt.instance.get(tt.cardPick).isHidden=!0,zt.instance.get(tt.cardPut).isHidden=!0,zt.instance.get(tt.cardShuffle).isHidden=!0,zt.instance.get(tt.piecePick).isHidden=!0,zt.instance.get(tt.piecePut).isHidden=!0,zt.instance.get(tt.blockPick).isHidden=!0,zt.instance.get(tt.blockPut).isHidden=!0,zt.instance.get(tt.lock).isHidden=!0,zt.instance.get(tt.unlock).isHidden=!0,zt.instance.get(tt.sweep).isHidden=!0,zt.instance.get(tt.puyon).isHidden=!0,zt.instance.get(tt.surprise).isHidden=!0,zt.instance.get(tt.coinToss).isHidden=!0,We.createMyCursor(),We.myCursor.name||(We.myCursor.name="\u30d7\u30ec\u30a4\u30e4\u30fc"),We.myCursor.imageIdentifier=Ge.identifier,ze.register(this).on("UPDATE_GAME_OBJECT",ut=>{this.lazyNgZoneUpdate(ut.isSendFromSelf)}).on("DELETE_GAME_OBJECT",ut=>{this.lazyNgZoneUpdate(ut.isSendFromSelf)}).on("SYNCHRONIZE_AUDIO_LIST",ut=>{ut.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("SYNCHRONIZE_FILE_LIST",ut=>{ut.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("LOAD_CONFIG",ut=>{if(console.log("LOAD_CONFIG !!!",ut.data),ut.data.dice&&ut.data.dice.url){const st=ut.data.dice.api;fetch(ut.data.dice.url+(1==st?"/v1/names":"/v2/game_system"),{mode:"cors"}).then(yt=>yt.json()).then(yt=>{let nt=ut.data.dice.url;Gn.apiUrl=nt.endsWith("/")?nt.substring(0,nt.length-1):nt,Gn.apiVersion=st,Gn.diceBotInfos=[];let lt=(1==st?yt.names:yt.game_system).filter(gt=>"DiceBot"!=(1==st?gt.system:gt.id)).map(gt=>{let Vt=gt.sort_key&&gt.sort_key.indexOf("\u56fd\u969b\u5316")<0?gt.sort_key:gt.name.normalize("NFKD");for(let Ht of Gn.replaceData)Ht[2]&&gt.name===Ht[0]&&(Vt=Ht[1],gt.name=Ht[2]),Vt=Vt.split(Ht[0].normalize("NFKD")).join(Ht[1].normalize("NFKD"));return gt.normalize=Vt.replace(/[\u3041-\u3096]/g,Ht=>String.fromCharCode(Ht.charCodeAt(0)+96)).replace(/\u7b2c(.+?)\u7248/g,"\u30bf\u30a4$1\u30cf\u30f3").replace(/[\u30fb!?\uff01\uff1f\s\u3000:\uff1a=\uff1d\/\uff0f\uff08\uff09\(\)]+/g,"").replace(/([\u30a2\u30ab\u30b5\u30bf\u30ca\u30cf\u30de\u30e4\u30e9\u30ef])\u30fc+/g,"$1\u30a2").replace(/([\u30a4\u30ad\u30b7\u30c1\u30cb\u30d2\u30df\u30ea])\u30fc+/g,"$1\u30a4").replace(/([\u30a6\u30af\u30b9\u30c4\u30cc\u30d5\u30e0\u30e6\u30eb])\u30fc+/g,"$1\u30a6").replace(/([\u30a8\u30b1\u30bb\u30c6\u30cd\u30d8\u30e1\u30ec])\u30fc+/g,"$1\u30a8").replace(/([\u30aa\u30b3\u30bd\u30c8\u30ce\u30db\u30e2\u30e8\u30ed])\u30fc+/g,"$1\u30aa").replace(/\u30f3+\u30fc+/g,"\u30f3").replace(/\u30f3+/g,"\u30f3"),gt}).map(gt=>{const Vt=/.+\:(.+)/.exec(1==st?gt.system:gt.id);return gt.lang=Vt?Vt[1]:"A",gt}).sort((gt,Vt)=>gt.lang<Vt.lang?-1:gt.lang>Vt.lang?1:gt.normalize==Vt.normalize?0:gt.normalize<Vt.normalize?-1:1);if(Gn.diceBotInfos.push(...lt.map(gt=>({script:1==st?gt.system:gt.id,game:gt.name}))),lt.length>0){let gt=lt[0].normalize.substring(0,1),Vt={index:lt[0].normalize.substring(0,1),infos:[]};for(let Ht of lt){let dn="Other"==Ht.lang?"\u305d\u306e\u4ed6":"ChineseTraditional"==Ht.lang?"\u6b63\u9ad4\u4e2d\u6587":"Korean"==Ht.lang?"\ud55c\uad6d\uc5b4":"English"==Ht.lang?"English":"SimplifiedChinese"==Ht.lang?"\u7b80\u4f53\u4e2d\u6587":Ht.normalize.substring(0,1);dn!==gt&&(gt=dn,Gn.diceBotInfosIndexed.push(Vt),Vt={index:dn,infos:[]}),Vt.infos.push({script:1==st?Ht.system:Ht.id,game:Ht.name})}Gn.diceBotInfosIndexed.push(Vt),Gn.diceBotInfosIndexed.sort((Ht,dn)=>Ht.index==dn.index?0:Ht.index<dn.index?-1:1)}})}else{Gn.diceBotInfos.forEach(nt=>{let lt=nt.sort_key.normalize("NFKD");for(let gt of Gn.replaceData)gt[2]&&nt.game===gt[0]&&(lt=gt[1],nt.game=gt[2]),lt=lt.split(gt[0].normalize("NFKD")).join(gt[1].normalize("NFKD"));lt=lt.replace(/[\u3041-\u3096]/g,gt=>String.fromCharCode(gt.charCodeAt(0)+96)).replace(/\u7b2c(.+?)\u7248/g,"\u30bf\u30a4$1\u30cf\u30f3").replace(/[\u30fb!?\uff01\uff1f\s\u3000:\uff1a=\uff1d\/\uff0f\uff08\uff09\(\)]+/g,"").replace(/([\u30a2\u30ab\u30b5\u30bf\u30ca\u30cf\u30de\u30e4\u30e9\u30ef])\u30fc+/g,"$1\u30a2").replace(/([\u30a4\u30ad\u30b7\u30c1\u30cb\u30d2\u30df\u30ea])\u30fc+/g,"$1\u30a4").replace(/([\u30a6\u30af\u30b9\u30c4\u30cc\u30d5\u30e0\u30e6\u30eb])\u30fc+/g,"$1\u30a6").replace(/([\u30a8\u30b1\u30bb\u30c6\u30cd\u30d8\u30e1\u30ec])\u30fc+/g,"$1\u30a8").replace(/([\u30aa\u30b3\u30bd\u30c8\u30ce\u30db\u30e2\u30e8\u30ed])\u30fc+/g,"$1\u30aa").replace(/\u30f3+\u30fc+/g,"\u30f3").replace(/\u30f3+/g,"\u30f3"),nt.sort_key=nt.lang?nt.lang:lt.normalize("NFKD")}),Gn.diceBotInfos.sort((nt,lt)=>"Other"==nt.sort_key&&"Other"==lt.sort_key?0:"Other"==nt.sort_key?1:"Other"==lt.sort_key?-1:nt.sort_key==lt.sort_key?0:nt.sort_key<lt.sort_key?-1:1);let st=Gn.diceBotInfos[0].sort_key[0],yt={index:st,infos:[]};for(let nt of Gn.diceBotInfos)"Other"==nt.lang&&(nt.lang="\u7b80\u4f53\u4e2d\u6587"),(nt.lang?nt.lang:nt.sort_key[0])!==st&&(st=nt.lang?nt.lang:nt.sort_key[0],Gn.diceBotInfosIndexed.push(yt),yt={index:st,infos:[]}),yt.infos.push({script:nt.id,game:nt.game});Gn.diceBotInfosIndexed.push(yt)}Gn.diceBotInfosIndexed.sort((st,yt)=>st.index==yt.index?0:st.index<yt.index?-1:1),xt.setApiKey(ut.data.webrtc.key),xt.open()}).on("FILE_LOADED",ut=>{this.lazyNgZoneUpdate(!1)}).on("OPEN_NETWORK",ut=>{console.log("OPEN_NETWORK",ut.data.peerId),We.myCursor.peerId=xt.peerContext.peerId,We.myCursor.userId=xt.peerContext.userId,this.isLoggedin=!1}).on("NETWORK_ERROR",ut=>{console.log("NETWORK_ERROR",ut.data.peerId);let st=ut.data.errorType,yt=ut.data.errorMessage;this.ngZone.run((0,tn.Z)(function*(){["peer-unavailable"].includes(st)||(yield we.modalService.open(du,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:yt}),["disconnected","socket-error","unavailable-id","authentication","server-error"].includes(st)&&(yield we.modalService.open(du,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:"\u3053\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b\u3068\u518d\u63a5\u7d9a\u3092\u8a66\u307f\u307e\u3059\u3002"}),xt.open(),we.isLoggedin=!1))}))}).on("CONNECT_PEER",ut=>{ut.isSendFromSelf&&(this.chatMessageService.calibrateTimeOffset(),this.isLoggedin||(this.isLoggedin=!0,o.sendOperationLog((xt.peerContext.isRoom?xt.peerContext.roomName+" \u306b":"\u4ed6\u8005\u3068")+"\u63a5\u7d9a\u3057\u305f"))),this.lazyNgZoneUpdate(ut.isSendFromSelf)}).on("DISCONNECT_PEER",ut=>{this.lazyNgZoneUpdate(ut.isSendFromSelf),ut.isSendFromSelf&&(this.isLoggedin=!1)}).on("PLAY_CUT_IN",-1e3,ut=>{let st=dt.instance.get(ut.data.identifier);this.cutInService.play(st,!!ut.data.secret&&ut.data.secret,!!ut.data.test&&ut.data.test,ut.data.sender)}).on("STOP_CUT_IN",-1e3,ut=>{this.cutInService.stop(ut.data.identifier)}).on("POPUP_STAND_IMAGE",-1e3,ut=>{let st=dt.instance.get(ut.data.standIdentifier),yt=dt.instance.get(ut.data.characterIdentifier);this.standImageService.show(yt,st,ut.data.color?ut.data.color:null,ut.data.secret)}).on("FAREWELL_STAND_IMAGE",-1e3,ut=>{this.standImageService.farewell(ut.data.characterIdentifier)}).on("DELETE_STAND_IMAGE",-1e3,ut=>{this.standImageService.destroy(ut.data.characterIdentifier,ut.data.identifier)}).on("DESTORY_STAND_IMAGE_ALL",-1e3,ut=>{this.standImageService.destroyAll()})}get otherPeers(){return dt.instance.getObjects(We)}ngOnInit(){window.addEventListener("beforeunload",t.beforeUnloadProc)}ngAfterViewInit(){An.defaultParentViewContainerRef=Fn.defaultParentViewContainerRef=lr.defaultParentViewContainerRef=rr.defaultParentViewContainerRef=qp.defaultParentViewContainerRef=this.modalLayerViewContainerRef,queueMicrotask(()=>{this.panelService.open(Ev,{width:520,height:450,left:100}),this.panelService.open(QS,{width:700,height:400,left:100,top:450})}),this.swUpdate.versionUpdates.subscribe(e=>{switch(e.type){case"VERSION_DETECTED":console.log(`Downloading new app version: ${e.version.hash}`);break;case"VERSION_READY":console.log(`Current app version: ${e.currentVersion.hash}`),console.log(`New app version ready for use: ${e.latestVersion.hash}`),this.isUpdateCanceled||this.modalService.open(er,{title:"Udonarium with Fly \u306e\u66f4\u65b0",text:"Udonarium with Fly \u306e\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u516c\u958b\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u66f4\u65b0\u3092\u884c\u3044\u307e\u3059\u304b\uff1f",help:"\u66f4\u65b0\u306e\u969b\u306b\u30da\u30fc\u30b8\u3092\u518d\u8aad\u307f\u8fbc\u307f\u3057\u307e\u3059\u3002\u624b\u52d5\u3067\u518d\u8aad\u307f\u8fbc\u307f\u3092\u884c\u3046\u3053\u3068\u3067\u3082\u66f4\u65b0\u53ef\u80fd\u3067\u3059\u3002",type:Si.OK_CANCEL,materialIcon:"browser_updated",action:()=>{this.swUpdate.activateUpdate().then(()=>{window.removeEventListener("beforeunload",t.beforeUnloadProc),document.location.reload()})},cancelAction:()=>{this.isUpdateCanceled=!0}});break;case"VERSION_INSTALLATION_FAILED":console.log(`Failed to install app version '${e.version.hash}': ${e.error}`)}})}ngOnDestroy(){ze.unregister(this)}open(e){let i=null,r={width:450,height:600,left:100};switch(e){case"PeerMenuComponent":r.width=520,i=Ev;break;case"ChatWindowComponent":i=QS,r.width=700;break;case"GameTableSettingComponent":i=tI,r={width:610,height:400,left:100};break;case"FileStorageComponent":i=Us,r.width=700;break;case"GameCharacterSheetComponent":i=Ws;break;case"JukeboxComponent":i=xZ;break;case"GameCharacterGeneratorComponent":i=iY,r={width:500,height:300,left:100};break;case"GameObjectInventoryComponent":i=XY;break;case"DiceRollTableSettingComponent":i=fX,r={width:645,height:475};break;case"CutInSettingComponent":i=FX,r={width:700,height:600}}i&&(r.top=20*(this.openPanelCount%10+1),r.left=100+5*(this.openPanelCount%20+1),this.openPanelCount=this.openPanelCount+1,this.panelService.open(i,r))}save(){var e=this;return(0,tn.Z)(function*(){if(e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i=xt.peerContext&&0<xt.peerContext.roomName.length?xt.peerContext.roomName:"fly_\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf";yield e.saveDataService.saveRoomAsync(i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}handleFileSelect(e){let i=e.target,r=i.files;r.length&&Wo.instance.load(r),i.value=""}lazyNgZoneUpdate(e){if(e){if(null!==this.immediateUpdateTimer)return;this.immediateUpdateTimer=setTimeout(()=>{this.immediateUpdateTimer=null,null!=this.lazyUpdateTimer&&(clearTimeout(this.lazyUpdateTimer),this.lazyUpdateTimer=null),this.ngZone.run(()=>{})},0)}else{if(null!==this.lazyUpdateTimer)return;this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,null!=this.immediateUpdateTimer&&(clearTimeout(this.immediateUpdateTimer),this.immediateUpdateTimer=null),this.ngZone.run(()=>{})},100)}}toolBox(){const e=[],i=_o.instance.cutIns;e.push({name:"\u30ab\u30c3\u30c8\u30a4\u30f3\u518d\u751f",materialIcon:"play_arrow",action:null,subActions:0===i.length?[{name:"(\u30ab\u30c3\u30c8\u30a4\u30f3\u306a\u3057)",disabled:!0,center:!0}]:i.map(r=>({name:`${r.isValidAudio?"":"\u26a0\ufe0f"}${""==r.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":r.name}`,subActions:[{name:"\u5168\u54e1",action:()=>{ze.call("PLAY_CUT_IN",{identifier:r.identifier,secret:!1,sender:We.myCursor.peerId}),this.chatMessageService.sendOperationLog((""==r.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":r.name)+" \u3092\u518d\u751f\u3057\u305f")}},kt,...this.otherPeers.map(s=>({name:s.name+(s===We.myCursor?" (\u3042\u306a\u305f)":""),color:s.color,default:!0,action:()=>{s!==We.myCursor&&ze.call("PLAY_CUT_IN",{identifier:r.identifier,secret:!0,sender:We.myCursor.peerId},s.peerId),ze.call("PLAY_CUT_IN",{identifier:r.identifier,secret:!0,sender:We.myCursor.peerId},We.myCursor.peerId)}}))]}))}),e.push(kt),e.push({name:"\u30ab\u30c3\u30c8\u30a4\u30f3\u8a2d\u5b9a",materialIcon:"movie_creation",action:()=>this.open("CutInSettingComponent")}),e.push({name:"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u8a2d\u5b9a",materialIcon:"table_rows",action:()=>this.open("DiceRollTableSettingComponent")}),this.contextMenuService.open(this.pointerDeviceService.pointers[0],e,"\u30c4\u30fc\u30eb\u30dc\u30c3\u30af\u30b9")}resetPointOfView(){this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:"\u521d\u671f\u8996\u70b9\u306b\u623b\u3059",action:()=>ze.trigger("RESET_POINT_OF_VIEW",null)},{name:"\u771f\u4e0a\u304b\u3089\u8996\u308b",action:()=>ze.trigger("RESET_POINT_OF_VIEW","top")}],"\u8996\u70b9\u30ea\u30bb\u30c3\u30c8")}standSetteings(){const e=Qo.isShowStand,i=Qo.isShowNameTag,r=Qo.isCanBeGone;this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:(dr.instance.gridShow?"\u2611":"\u2610")+"\u30c6\u30fc\u30d6\u30eb\u30b0\u30ea\u30c3\u30c9\u3092\u5e38\u306b\u8868\u793a",action:()=>{dr.instance.gridShow=!dr.instance.gridShow,ze.trigger("UPDATE_GAME_OBJECT",dr.instance.toContext())}},{name:(dr.instance.gridSnap?"\u2611":"\u2610")+"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u79fb\u52d5\u6642\u306b\u30b9\u30ca\u30c3\u30d7",action:()=>{dr.instance.gridSnap=!dr.instance.gridSnap}},kt,{name:(e?"\u2611":"\u2610")+"\u30b9\u30bf\u30f3\u30c9\u8868\u793a",action:()=>{Qo.isShowStand=!e}},{name:(i?"\u2611":"\u2610")+"\u30cd\u30fc\u30e0\u30bf\u30b0\u8868\u793a",action:()=>{Qo.isShowNameTag=!i},level:1,disabled:!Qo.isShowStand},{name:(r?"\u2611":"\u2610")+"\u900f\u660e\u5316\u3001\u81ea\u52d5\u9000\u53bb",action:()=>{Qo.isCanBeGone=!r},level:1,disabled:!Qo.isShowStand},kt,{name:"\u8868\u793a\u30b9\u30bf\u30f3\u30c9\u5168\u6d88\u53bb",action:()=>ze.trigger("DESTORY_STAND_IMAGE_ALL",null)}],"\u500b\u4eba\u8a2d\u5b9a")}diceAllOpne(){this.modalService.open(er,{title:"\u30c0\u30a4\u30b9\u4e00\u6589\u516c\u958b",text:"\u30c6\u30fc\u30d6\u30eb\u4e0a\u306e\u30c0\u30a4\u30b9\u3001\u30b3\u30a4\u30f3\u3092\u516c\u958b\u3057\u307e\u3059\u304b\uff1f",help:"\u300c\u4e00\u6589\u516c\u958b\u3057\u306a\u3044\u300d\u8a2d\u5b9a\u306e\u3082\u306e\u306f\u516c\u958b\u3055\u308c\u307e\u305b\u3093\u3002",type:Si.OK_CANCEL,materialIcon:"all_out",action:()=>{ze.trigger("DICE_ALL_OPEN",null)}})}deleteGameObject(e){throw new Error("Method not implemented.")}rotateChange(e){this.isHorizontal=e}}return t.beforeUnloadProc=n=>{n.preventDefault(),n.returnValue=""},t.\u0275fac=function(e){return new(e||t)(He(cI),He(Fn),He(An),He(fi),He(kr),He(wv),He(Dr),He(Cn),He(lr),He(rr),He(qp))},t.\u0275cmp=Xt({type:t,selectors:[["app-root"]],viewQuery:function(e,i){if(1&e&&cn(xne,7,zr),2&e){let r;ln(r=un())&&(i.modalLayerViewContainerRef=r.first)}},decls:98,vars:13,consts:[["id","app-table-layer",2,"position","absolute","width","100%","height","100%","overflow","hidden"],[3,"top","left","width","height","title","isAbleFullScreenButton","isAbleCloseButton","isAbleRotateButton","rotateEvent"],[3,"ngClass"],[3,"click"],["routerLink","/","routerLinkActive","active"],[1,"material-icons","icon-size"],[1,"material-icons"],[1,"self-only"],["type","file","multiple","","accept","application/xml,text/xml,application/zip",2,"display","none",3,"change"],[3,"click",4,"ngIf"],["style","pointer-events: none;",4,"ngIf"],[1,"self-only-indicater",2,"font-size","8px","text-align","center"],["modalLayer",""],[1,"networkIndicator"],[2,"pointer-events","none"],[1,"material-icons","vibration-amine"]],template:function(e,i){1&e&&(Q(0,"div",0),ot(1,"game-table"),ie(),Q(2,"ui-panel",1),Ae("rotateEvent",function(s){return i.rotateChange(s)}),Q(3,"nav",2)(4,"ul")(5,"li",3),Ae("click",function(){return i.open("PeerMenuComponent")}),Q(6,"a",4)(7,"div")(8,"i",5),ye(9,"people"),ie()(),Q(10,"div"),ye(11,"\u63a5\u7d9a"),ie()()(),Q(12,"li",3),Ae("click",function(){return i.open("ChatWindowComponent")}),Q(13,"a",4)(14,"div")(15,"i",5),ye(16,"speaker_notes"),ie()(),Q(17,"div"),ye(18,"\u30c1\u30e3\u30c3\u30c8\u753b\u9762"),ie()()(),Q(19,"li",3),Ae("click",function(){return i.open("GameTableSettingComponent")}),Q(20,"a",4)(21,"div")(22,"i",5),ye(23,"layers"),ie()(),Q(24,"div"),ye(25,"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a"),ie()()(),Q(26,"li",3),Ae("click",function(){return i.open("FileStorageComponent")}),Q(27,"a",4)(28,"div")(29,"i",5),ye(30,"photo_library"),ie()(),Q(31,"div"),ye(32,"\u753b\u50cf"),ie()()(),Q(33,"li",3),Ae("click",function(){return i.open("JukeboxComponent")}),Q(34,"a",4)(35,"div")(36,"i",6),ye(37,"queue_music"),ie()(),Q(38,"div"),ye(39,"\u97f3\u697d"),ie()()(),Q(40,"li",3),Ae("click",function(){return i.toolBox()}),Q(41,"a",4)(42,"div")(43,"i",6),ye(44,"build"),ie()(),Q(45,"div"),ye(46,"\u30c4\u30fc\u30eb\u30dc\u30c3\u30af\u30b9"),ie()()(),Q(47,"li",3),Ae("click",function(){return i.open("GameObjectInventoryComponent")}),Q(48,"a",4)(49,"div")(50,"i",5),ye(51,"folder_shared"),ie()(),Q(52,"div"),ye(53,"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),ie()()(),Q(54,"li",3),Ae("click",function(){return i.diceAllOpne()}),Q(55,"a",4)(56,"div")(57,"i",5),ye(58,"all_out"),ie()(),Q(59,"div"),ye(60,"\u30c0\u30a4\u30b9\u4e00\u6589\u516c\u958b"),ie()()(),Q(61,"li",3),Ae("click",function(){return i.standSetteings()}),Q(62,"a",4)(63,"div")(64,"i",5),ye(65,"how_to_reg"),ie()(),Q(66,"div"),ye(67,"\u500b\u4eba\u8a2d\u5b9a"),Q(68,"sup",7),ye(69,"*"),ie()()()(),Q(70,"li",3),Ae("click",function(){return i.resetPointOfView()}),Q(71,"a",4)(72,"div")(73,"i",5),ye(74,"remove_red_eye"),ie()(),Q(75,"div"),ye(76,"\u8996\u70b9\u30ea\u30bb\u30c3\u30c8"),Q(77,"sup",7),ye(78,"*"),ie()()()(),Q(79,"li")(80,"a",4)(81,"label")(82,"div")(83,"i",6),ye(84,"open_in_browser"),ie()(),Q(85,"div"),ye(86,"ZIP\u8aad\u8fbc"),ie(),Q(87,"input",8),Ae("change",function(s){return i.handleFileSelect(s)}),ie()()()(),Te(88,wne,7,0,"li",9),Te(89,Ene,7,1,"li",10),ie(),Q(90,"div",11)(91,"b")(92,"sup",7),ye(93,"*"),ie(),ye(94,"\u306f\u81ea\u5206\u306e\u307f"),ie()()()(),ot(95,"div",null,12)(97,"network-indicator",13)),2&e&&(U(2),re("top",0)("left",0)("width",100)("height",710)("title","\u30e1\u30cb\u30e5\u30fc")("isAbleFullScreenButton",!1)("isAbleCloseButton",!1)("isAbleRotateButton",!0),U(1),re("ngClass",ft(11,Tne,i.isHorizontal)),U(85),re("ngIf",!i.isSaveing),U(1),re("ngIf",i.isSaveing))},directives:[yne,nI,Yn,bn,Cne],styles:["[_nghost-%COMP%]{display:block}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{text-align:center;padding:5px;color:#ccc;color:#444;cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:hover{color:#ccc;background-color:#1e1e1ecc}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{height:128px;width:128px;font-size:8px;-webkit-user-select:none;-moz-user-select:none;user-select:none}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:24px}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{text-decoration:none}.icon-size[_ngcontent-%COMP%]{font-size:40px}.side-menu[_ngcontent-%COMP%]{top:0;left:0;box-sizing:border-box;overflow:auto;position:absolute;color:#ccc;background-color:#1e1e1ecc;border:solid 1px #999;padding:0;height:100%;width:300px}.networkIndicator[_ngcontent-%COMP%]{display:none;z-index:9999;pointer-events:none;position:absolute;top:3px;right:3px;height:30px;width:30px}.vibration-amine[_ngcontent-%COMP%]{animation:vibration .2s infinite}@keyframes vibration{0%{transform:scale(1) translate(0)}50%{transform:scale(1.02,.95) translateY(5%)}to{transform:scale(1) translate(0)}}.self-only[_ngcontent-%COMP%]{color:red}.horizontal[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap}.horizontal[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{display:inline-block;width:74px}[_ngcontent-%COMP%]:not(.horizontal)   .self-only-indicater[_ngcontent-%COMP%]{margin-top:2em}.horizontal[_ngcontent-%COMP%]   .self-only-indicater[_ngcontent-%COMP%]{display:none}"]}),t})();An.UIPanelComponentClass=nI,lr.ContextMenuComponentClass=nY,Fn.ModalComponentClass=TZ;let Ine=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ss({type:t}),t.\u0275inj=os({}),t})(),kne=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ss({type:t,bootstrap:[Sne]}),t.\u0275inj=os({providers:[wv,kr,lr,Fn,Tv,An,fi,vu,rr],imports:[[D2,B8,$2,zR,Ine,g7,nQ.register("ngsw-worker.js",{enabled:true})]]}),t})();Ag(hu,[Ml,kl,la,oi,Oa,mi,$i,di,bn,Ld,nr,Ur,Vr],[]),Ag(hu,[Ml,kl,la,oi,Oa,mi,$i,di,bn,Ld,nr,Ur,Vr],[]),function EN(){qx=!1}(),SO().bootstrapModule(kne).catch(t=>console.error(t))},5904:(C,le,me)=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0}),me(8827),me(4748),me(9202),me(8465);var d=me(3583),H=me(3693),ee=function(){function $(x,O){this.internal=null!=O?O:d.BCDice.Base.$new(x)}return $.eval=function(x){var O=d.BCDice.Base.$eval(x);return H.parseResult(O)},Object.defineProperty($.prototype,"randomizer",{get:function(){return this.internal.randomizer},enumerable:!1,configurable:!0}),$.prototype.eval=function(){var x=this.internal.$eval();return H.parseResult(x)},$}();le.default=ee},8827:(C,le,me)=>{me(9993),Opal.queue(function(d){var W,j,q,I,A,oe,z,Z,H=d.module,ee=d.ensure_kwargs,$=d.truthy,x=d.thrower,O=d.def,E=[],Y=d.nil,G=d.$$$;return W=E,j=Z=[H(E[0],"BCDice")].concat(W),z=[oe=H(Z[0],"ArithmeticEvaluator")].concat(j),I=[q=d.get_singleton_class(oe)].concat(z),A=d.$r(I),O(q,"$eval",function(L,S){try{x("eval_return");var v,P=Y;return null==(v=(S=ee(S)).$$smap.round_type)&&(v=G(A("RoundType"),"FLOOR")),$(L)&&$(P=A("Arithmetic").$eval(L,v))?P:0}catch(R){if(R===d.t_eval_return)return R.$v;throw R}},-2)})},9202:(C,le,me)=>{me(9993),Opal.modules.json=function(d){var z,oe,H=d.module,ee=d.klass,$=d.send,x=d.Object,O=d.hash2,E=d.eqeqeq,Y=d.defs,G=d.truthy,D=d.def,W=d.return_val,B=[],Z=d.nil,T=d.$$$;return function(j,oe){var q,z=H(j,"JSON"),K=[z].concat(oe),I=d.$r(K);ee(K[0],I("StandardError"),"JSONError"),ee(K[0],I("JSONError"),"ParserError");var A=d.hasOwnProperty;function J(S){try{return JSON.parse(S)}catch(M){z.$raise(T(I("JSON"),"ParserError"),M.message)}}function L(S,M){var v,P,R,te,k,de;switch(typeof S){case"string":case"number":return S;case"boolean":return!!S;case"undefined":return Z;case"object":if(!S)return Z;if(S.$$is_array){for(P=M.array_class.$new(),te=0,k=S.length;te<k;te++)P.$push(L(S[te],M));return P}for(de in R=M.object_class.$new(),S)A.call(S,de)&&(q=[de,L(S[de],M)],$(R,"[]=",q));return M.parse||(v=R["$[]"](I("JSON").$create_id()))==Z?R:x.$const_get(v).$json_create(R)}}d.get_singleton_class(z).$attr_accessor("create_id"),z["$create_id="]("json_class"),Y(z,"$[]",function(M,v){return null==v&&(v=O([],{})),E(I("String"),M)?this.$parse(M,v):this.$generate(M,v)},-2),Y(z,"$parse",function(M,v){return null==v&&(v=O([],{})),this.$from_object(J(M),v.$merge(O(["parse"],{parse:!0})))},-2),Y(z,"$parse!",function(M,v){return null==v&&(v=O([],{})),this.$parse(M,v)},-2),Y(z,"$load",function(M,v){return null==v&&(v=O([],{})),this.$from_object(J(M),v)},-2),Y(z,"$from_object",function(M,v){return null==v&&(v=O([],{})),G(v["$[]"]("object_class"))||v["$[]="]("object_class",I("Hash")),G(v["$[]"]("array_class"))||v["$[]="]("array_class",I("Array")),L(M,v.$$smap)},-2),Y(z,"$generate",function(M,v){return null==v&&(v=O([],{})),M.$to_json(v)},-2),Y(z,"$dump",function(M,v,P){var te;return null==v&&(v=Z),null==P&&(P=Z),te=this.$generate(M),G(v)?(G(v["$responds_to?"]("to_io"))&&(v=v.$to_io()),v.$write(te),v):te},-2)}(B[0],B),z=ee(B[0],null,"Object"),D(z,"$to_json",function(){return this.$to_s().$to_json()}),oe=H(B[0],"Enumerable"),D(oe,"$to_json",function(){return this.$to_a().$to_json()}),function(j,oe){var z=ee(j,null,"Array");D(z,"$to_json",function(){for(var I=[],A=0,J=this.length;A<J;A++)I.push(this[A].$to_json());return"["+I.join(",")+"]"})}(B[0]),function(j,oe){var z=ee(j,null,"Boolean");D(z,"$to_json",function(){return 1==this?"true":"false"})}(B[0]),function(j,oe){var z=ee(j,null,"Hash");D(z,"$to_json",function(){for(var S,M,I=[],A=0,J=this.$$keys,L=J.length;A<L;A++)(S=J[A]).$$is_string?M=this.$$smap[S]:(M=S.value,S=S.key),I.push(S.$to_s().$to_json()+":"+M.$to_json());return"{"+I.join(",")+"}"})}(B[0]),function(j,oe){var z=ee(j,null,"NilClass");D(z,"$to_json",W("null"))}(B[0]),function(j,oe){var z=ee(j,null,"Numeric");D(z,"$to_json",function(){return this.toString()})}(B[0]),function(j,oe){var z=ee(j,null,"String");D(z,"$to_json",function(){return JSON.stringify(this)})}(B[0]),function(j,oe){var z=ee(j,null,"Time");D(z,"$to_json",function(){return this.$strftime("%FT%T%z").$to_json()})}(B[0]),function(j,oe){var z=ee(j,null,"Date");return D(z,"$to_json",function(){return this.$to_s().$to_json()}),D(z,"$as_json",function(){return this.$to_s()})}(B[0])},Opal.modules.i18n=function(d){var A,S,v,P,J,L,H=d.module,ee=d.class_variable_set,$=d.class_variable_get,x=d.def,O=d.truthy,E=d.hash2,Y=d.send,G=d.ensure_kwargs,D=d.kwrestargs,W=d.to_a,Z=d.alias,T=d.klass,j=d.return_val,z=[],q=d.nil,K=d.$$$;return d.top.$require("json"),A=z,L=[J=H(z[0],"I18n")].concat(A),S=d.get_singleton_class(J),v=[S].concat(L),P=d.$r(v),ee(v[1],"@@load_path",[]),ee(v[1],"@@table",q),x(S,"$load_path",function(){return $(v[1],"@@load_path",!1)}),x(S,"$default_locale",function(){return $(v[1],"@@default_locale",!1)}),x(S,"$default_locale=",function(te){return ee(v[1],"@@default_locale",te)}),x(S,"$fallbacks",function(){return K(K(P("I18n"),"Locale"),"Fallbacks").$new()}),x(S,"$load_default_translation",function(){return O($(v[1],"@@table",!1)["$nil?"]())?(ee(v[1],"@@table",E([],{})),this.$load_translation(JSON.stringify(me(6884)))):q}),x(S,"$load_translation",function(te){var de;return this.$load_default_translation(),de=P("JSON").$parse(te,E(["symbolize_names"],{symbolize_names:!0})),ee(v[1],"@@table",Y($(v[1],"@@table",!1),"merge",[de],function(F,g,l){return null==F&&(F=q),null==g&&(g=q),null==l&&(l=q),g.$merge(l)}))}),x(S,"$clear_translate_table",function(){return ee(v[1],"@@table",q)}),x(S,"$translate",function(te,k){var de,N,g,l,c=q,f=q,u=q;null==(de=(k=G(k)).$$smap.locale)&&(de=q),N=D(k,{locale:!0}),this.$load_default_translation(),g=Y(te.$split("."),"map",[],"to_sym".$to_proc()),l=$(v[1],"@@table",!1),c=$(v[1],"@@default_locale",!1),f=O(u=Y(l,"dig",[de].concat(W(g))))?u:Y(l,"dig",[c].concat(W(g)));try{O(f["$is_a?"](P("String")))&&(f=this.$format(f,d.to_hash(N)))}catch(p){if(!d.rescue(p,[P("ArgumentError"),P("KeyError")]))throw p;d.pop_exception()}return O(u=f)?u:N["$[]"]("default")},-2),Z(S,"t","translate"),function(S,M){var te,k,de,P=[H(S,"Locale")].concat(M),R=d.$r(P);te=P[0],k=R("Hash"),de=T(te,k,"Fallbacks"),x(de,"$defaults=",j(q))}(L[0],L),function(S,M){var P=[H(S,"Backend")].concat(M);H(P[0],"Simple")}(L[0],L),function(S,M){var R,v=H(S,"Thread");return[v].concat(M),R=d.get_singleton_class(v),x(R,"$current",function(){return E(["i18n_fallbacks"],{i18n_fallbacks:q})})}(L[0],L)},Opal.modules["i18n/backend/fallbacks"]=function(d){var K,J,S,M,I,A,H=d.module,ee=d.class_variable_set,$=d.truthy,x=d.class_variable_get,O=d.def,E=d.send,Y=d.send2,G=d.find_super,D=d.hash2,W=d.find_block_super,B=d.neqeq,Z=d.thrower,T=d.return_val,j=[],oe=d.nil,z=d.$$$;return K=j,A=[I=H(j[0],"I18n")].concat(K),ee(A[0],"@@fallbacks",oe),J=d.get_singleton_class(I),S=[J].concat(A),M=d.$r(S),O(J,"$fallbacks",function(){var R=oe;return ee(S[1],"@@fallbacks",$(null!=S[1].$$cvars["@@fallbacks"]?"class variable":oe)&&$(R=x(S[1],"@@fallbacks",!1))?R:z(z(M("I18n"),"Locale"),"Fallbacks").$new()),$(R=M("Thread").$current()["$[]"]("i18n_fallbacks"))?R:x(S[1],"@@fallbacks",!1)}),O(J,"$fallbacks=",function(P){var R;return ee(S[1],"@@fallbacks",$(P["$is_a?"](M("Array")))?z(z(M("I18n"),"Locale"),"Fallbacks").$new(P):P),R=["i18n_fallbacks",x(S[1],"@@fallbacks",!1)],E(M("Thread").$current(),"[]=",R),R[R.length-1]}),function(J,L){var P,R,te,k,M=[H(J,"Backend")].concat(L);return P=M,te=[R=H(M[0],"Fallbacks")].concat(P),k=d.$r(te),O(R,"$translate",function de(N,F,g){try{var l=Z("return"),c=de.$$p||oe,f=this,u=oe,p=oe;return de.$$p=null,null==g&&(g=k("EMPTY_HASH")),$(g.$fetch("fallback",!0))?$(g["$[]"]("fallback_in_progress"))?Y(f,G(f,"translate",de,!1,!0),"translate",[N,F,g],c):($(g["$[]"]("default"))&&(u=f["$extract_non_symbol_default!"](g)),p=g.$merge(D(["fallback_in_progress"],{fallback_in_progress:!0})),E(k("I18n").$fallbacks()["$[]"](N),"each",[],function _(y){var m=null==_.$$s?this:_.$$s;null==y&&(y=oe);try{return E(m,"catch",["exception"],function ne(){var se=null==ne.$$s?this:ne.$$s,Ee=oe;if(Ee=Y(se,W(se,"translate",ne.$$def||_.$$def||de,!1,!1),"translate",[y,F,p],null),$(Ee["$nil?"]()))return oe;B(N.$to_s(),y.$to_s())&&se.$on_fallback(N,y,F,g),l.$throw(Ee)},{$$s:m,$$ret:l})}catch(ne){if(!d.rescue(ne,[z(k("I18n"),"InvalidLocale")]))throw ne;try{return oe}finally{d.pop_exception()}}},{$$s:f}),$(g["$key?"]("default"))&&$(g["$[]"]("default")["$nil?"]())?oe:$(u)?Y(f,G(f,"translate",de,!1,!0),"translate",[N,oe,g.$merge(D(["default"],{default:u}))],null):f.$throw("exception",z(k("I18n"),"MissingTranslation").$new(N,F,g))):Y(f,G(f,"translate",de,!1,!0),"translate",[N,F,g],c)}catch(_){if(_===l)return _.$v;throw _}},-3),O(R,"$extract_non_symbol_default!",function(N){var g,F=oe;return F=[N["$[]"]("default")].$flatten(),g=E(F,"detect",[],function(c){return null==c&&(c=oe),c["$is_a?"](k("Symbol"))["$!"]()}),$(g)&&N["$[]="]("default",F["$[]"](0,F.$index(g))),g}),O(R,"$exists?",function de(N,F,g){try{var l=Z("return"),c=de.$$p||oe,f=this;return de.$$p=null,null==g&&(g=k("EMPTY_HASH")),$(g.$fetch("fallback",!0))?(E(k("I18n").$fallbacks()["$[]"](N),"each",[],function u(p){var _=null==u.$$s?this:u.$$s;null==p&&(p=oe);try{if(!$(Y(_,W(_,"exists?",u.$$def||de,!1,!1),"exists?",[p,F],null)))return oe;l.$throw(!0)}catch(y){if(!d.rescue(y,[z(k("I18n"),"InvalidLocale")]))throw y;try{return oe}finally{d.pop_exception()}}},{$$s:f,$$ret:l}),!1):Y(f,G(f,"exists?",de,!1,!0),"exists?",[N,F,g],c)}catch(u){if(u===l)return u.$v;throw u}},-3),R.$private(),O(R,"$on_fallback",T(oe))}(A[0],A)},Opal.modules["bcdice/randomizer"]=function(d){var I,v,P,R,te,k,J,L,ee=d.klass,$=d.const_set,x=d.def,O=d.truthy,E=d.rb_gt,Y=d.rb_plus,G=d.rb_le,D=d.send,W=d.rb_minus,B=d.eqeq,Z=d.rb_times,T=d.eqeqeq,j=d.rb_ge,oe=[],z=d.nil,q=d.$$$;return I=oe,J=[(0,d.module)(oe[0],"BCDice")].concat(I),L=d.$r(J),v=J,R=[P=ee(J[0],null,"Randomizer")].concat(v),te=d.$r(R),(k=P.$$prototype).rand_results=k.detailed_rand_results=z,$(R[0],"UPPER_LIMIT_DICE_TIMES",200),$(R[0],"UPPER_LIMIT_DICE_SIDES",1e4),$(R[0],"UPPER_LIMIT_RANDS",1e4),x(P,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]}),P.$attr_reader("rand_results"),P.$attr_reader("detailed_rand_results"),$(R[0],"DetailedRandResult",te("Struct").$new("kind","sides","value")),x(P,"$roll_barabara",function(N,F){var g=this;return O(E(Y(g.rand_results.$size(),N),te("UPPER_LIMIT_RANDS")))&&g.$raise(te("TooManyRandsError")),O(G(N,0))||O(E(N,te("UPPER_LIMIT_DICE_TIMES")))?[]:D(te("Array"),"new",[N],function l(){return(null==l.$$s?this:l.$$s).$roll_once(F)},{$$s:g})}),x(P,"$roll_sum",function(N,F){return this.$roll_barabara(N,F).$sum()}),x(P,"$roll_once",function(N){var g=z;return O(G(N,0))||O(E(N,te("UPPER_LIMIT_DICE_SIDES")))?0:(g=this.$rand_inner(N),this.$push_to_detail("normal",N,g),g)}),x(P,"$roll_index",function(N){return W(this.$roll_once(N),1)}),x(P,"$roll_tens_d10",function(){var g,F=z;return F=this.$rand_inner(10),B(F,10)&&(F=0),g=Z(F,10),this.$push_to_detail("tens_d10",10,g),g}),x(P,"$roll_d9",function(){var F;return F=W(this.$rand_inner(10),1),this.$push_to_detail("d9",10,F),F}),x(P,"$roll_d66",function(N){var l,g=z;return g=D(te("Array"),"new",[2],function c(){return(null==c.$$s?this:c.$$s).$roll_once(6)},{$$s:this}),T(q(te("D66SortType"),"ASC"),l=N)?g["$sort!"]():T(q(te("D66SortType"),"DESC"),l)&&g["$sort!"]()["$reverse!"](),Y(Z(g["$[]"](0),10),g["$[]"](1))}),P.$private(),x(P,"$rand_inner",function(N){var g,F=this;return O(j(F.rand_results.$size(),te("UPPER_LIMIT_RANDS")))&&F.$raise(te("TooManyRandsError")),g=F.$random(N),F.rand_results["$<<"]([g,N]),g}),x(P,"$random",function(N){return Y(te("Kernel").$rand(N),1)}),x(P,"$push_to_detail",function(N,F,g){var c;return c=te("DetailedRandResult").$new(N,F,g),this.detailed_rand_results.$push(c)}),ee(J[0],L("StandardError"),"TooManyRandsError"),z},Opal.modules["bcdice/dice_table/roll_result"]=function(d){var D,T,K,I,A,J,L,oe,B,H=d.module,ee=d.klass,$=d.def,x=d.truthy,O=d.return_val,E=[],Y=d.nil;return D=E,T=B=[H(E[0],"BCDice")].concat(D),K=oe=[H(B[0],"DiceTable")].concat(T),A=[I=ee(oe[0],null,"RollResult")].concat(K),J=d.$r(A),(L=I.$$prototype).table_name=L.value=L.body=Y,$(I,"$initialize",function(M,v,P){var R=this;return R.table_name=M,R.value=v,R.body=P}),I.$attr_reader("table_name"),I.$attr_reader("value"),I.$attr_reader("body"),$(I,"$to_s",function(){var M=this;return M.table_name+"("+M.value+") \uff1e "+M.body}),$(I,"$last_body",function(){var M=this;return x(M.body["$is_a?"](J("RollResult")))?M.body.$last_body():M.body}),$(I,"$empty?",O(!1))},Opal.modules["bcdice/dice_table/chain_table"]=function(d){var D,T,K,I,A,J,L,oe,B,H=d.module,ee=d.klass,$=d.truthy,x=d.def,O=d.rb_minus,E=[],Y=d.nil;return D=E,T=B=[H(E[0],"BCDice")].concat(D),K=oe=[H(B[0],"DiceTable")].concat(T),A=[I=ee(oe[0],null,"ChainTable")].concat(K),J=d.$r(A),(L=I.$$prototype).times=L.sides=L.items=L.name=Y,x(I,"$initialize",function(M,v,P){var R=this,te=Y;return R.name=M,R.items=P.$freeze(),te=/(\d+)D(\d+)/i.$match(v),$(te)||R.$raise(J("ArgumentError"),"Unexpected table type: "+v),R.times=te["$[]"](1).$to_i(),R.sides=te["$[]"](2).$to_i()}),x(I,"$roll",function(M){var P,R,v=this,te=Y;return P=M.$roll_sum(v.times,v.sides),R=O(P,v.times),te=v.items["$[]"](R),$(te["$respond_to?"]("roll"))&&(te=te.$roll(M)),J("RollResult").$new(v.name,P,te)})},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(d){var Z,z,J,L,S,M,v,K,j,H=d.module,ee=d.klass,$=d.hash2,x=d.defs,O=d.def,E=d.rb_plus,Y=d.rb_times,G=d.rb_minus,D=[],W=d.nil;return Z=D,z=j=[H(D[0],"BCDice")].concat(Z),J=K=[H(j[0],"DiceTable")].concat(z),S=[L=ee(K[0],null,"D66GridTable")].concat(J),M=d.$r(S),(v=L.$$prototype).name=v.items=W,x(L,"$from_i18n",function(R,te){var de=W;return de=M("I18n").$t(R,$(["locale","raise"],{locale:te,raise:!0})),this.$new(de["$[]"]("name"),de["$[]"]("items"))}),O(L,"$initialize",function(R,te){return this.name=R,this.items=te.$freeze()}),O(L,"$roll",function(R){var k,de,N,F,g;return k=R.$roll_once(6),de=R.$roll_once(6),N=E(Y(k,10),de),F=G(k,1),g=G(de,1),M("RollResult").$new(this.name,N,this.items["$[]"](F)["$[]"](g))})},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(d){var W,j,A,J,L,S,z,q,Z,H=d.module,ee=d.klass,$=d.hash2,x=d.defs,O=d.def,Y=[],G=d.nil;return d.top.$require("bcdice/dice_table/d66_grid_table"),W=Y,j=Z=[H(Y[0],"BCDice")].concat(W),z=[H(Z[0],"DiceTable")].concat(j),q=d.$r(z),A=z,L=[J=ee(z[0],q("D66GridTable"),"D66HalfGridTable")].concat(A),S=d.$r(L),x(J,"$from_i18n",function(v,P){var te=G;return te=S("I18n").$t(v,$(["locale","raise"],{locale:P,raise:!0})),this.$new(te["$[]"]("name"),te["$[]"]("items_1_2_3"),te["$[]"]("items_4_5_6"))}),O(J,"$initialize",function(v,P,R){return this.name=v,this.items=[P,P,P,R,R,R].$freeze()})},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(d){var W,j,A,J,L,S,z,q,Z,H=d.module,ee=d.klass,$=d.hash2,x=d.defs,O=d.def,Y=[],G=d.nil;return d.top.$require("bcdice/dice_table/d66_grid_table"),W=Y,j=Z=[H(Y[0],"BCDice")].concat(W),z=[H(Z[0],"DiceTable")].concat(j),q=d.$r(z),A=z,L=[J=ee(z[0],q("D66GridTable"),"D66OneThirdTable")].concat(A),S=d.$r(L),x(J,"$from_i18n",function(v,P){var te=G;return te=S("I18n").$t(v,$(["locale","raise"],{locale:P,raise:!0})),this.$new(te["$[]"]("name"),te["$[]"]("items_1_2"),te["$[]"]("items_3_4"),te["$[]"]("items_5_6"))}),O(J,"$initialize",function(v,P,R,te){return this.name=v,this.items=[P,P,R,R,te,te].$freeze()})},Opal.modules["bcdice/dice_table/d66_table"]=function(d){var j,K,S,M,v,P,R,A,z,H=d.module,ee=d.klass,$=d.hash2,x=d.defs,O=d.def,E=d.eqeqeq,Y=d.rb_plus,G=d.rb_times,D=d.truthy,W=[],B=d.nil,Z=d.$$$;return j=W,K=z=[H(W[0],"BCDice")].concat(j),S=A=[H(z[0],"DiceTable")].concat(K),v=[M=ee(A[0],null,"D66Table")].concat(S),P=d.$r(v),(R=M.$$prototype).sort_type=R.items=R.name=B,x(M,"$from_i18n",function(k,de){var g,F=B;return F=P("I18n").$t(k,$(["locale"],{locale:de})),g=P("D66SortType").$const_get(F["$[]"]("d66_sort_type")),this.$new(F["$[]"]("name"),g,F["$[]"]("items"))}),O(M,"$initialize",function(k,de,N){var F=this;return F.name=k,F.sort_type=de,F.items=N.$freeze()}),O(M,"$roll",function(k){var N=B,F=B,g=B,l=B;return N=k.$roll_barabara(2,6),E(Z(P("D66SortType"),"ASC"),F=this.sort_type)?N["$sort!"]():E(Z(P("D66SortType"),"DESC"),F)&&N["$sort!"]()["$reverse!"](),g=Y(G(N["$[]"](0),10),N["$[]"](1)),l=D(F=this.items["$[]"](g))?F:this.items["$[]"](g.$to_s()),D(l["$respond_to?"]("roll"))&&(l=l.$roll(k)),P("RollResult").$new(this.name,g,l)}),O(M,"$choice",function(k){return P("RollResult").$new(this.name,k,this.items["$[]"](k))})},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(d){var oe,I,J,L,q,H=d.module,ee=d.klass,$=d.hash2,x=d.send,O=d.to_ary,E=d.rb_plus,Y=d.rb_times,G=d.send2,D=d.find_super,W=d.def,Z=[],T=d.nil;return d.top.$require("bcdice/dice_table/d66_table"),oe=Z,I=q=[H(Z[0],"BCDice")].concat(oe),J=[H(q[0],"DiceTable")].concat(I),L=d.$r(J),W(ee(J[0],L("D66Table"),"D66LeftRangeTable"),"$initialize",function P(R,te,k){var F;return P.$$p=null,F=$([],{}),x(k,"each",[],function(l){var c,p;return null==l&&(l=T),c=O(l),p=null==c[1]?T:c[1],x(null==c[0]?T:c[0],"each",[],function(y){return null==y&&(y=T),x(p,"each_with_index",[],function(ne,se){var Ee,ke;return null==ne&&(ne=T),null==se&&(se=T),ke=E(Y(y,10),E(se,1)),x(F,"[]=",Ee=[ke,ne]),Ee[Ee.length-1]})})}),G(this,D(this,"initialize",P,!1,!0),"initialize",[R,te,F],null)})},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(d){var T,q,L,S,M,v,P,I,oe,H=d.module,ee=d.klass,$=d.hash2,x=d.defs,O=d.def,E=d.truthy,Y=d.rb_minus,G=d.rb_plus,D=d.rb_times,W=[],B=d.nil;return T=W,q=oe=[H(W[0],"BCDice")].concat(T),L=I=[H(oe[0],"DiceTable")].concat(q),M=[S=ee(I[0],null,"D66ParityTable")].concat(L),v=d.$r(M),(P=S.$$prototype).odd=P.even=P.name=B,x(S,"$from_i18n",function(te,k){var N=B;return N=v("I18n").$t(te,$(["locale","raise"],{locale:k,raise:!0})),this.$new(N["$[]"]("name"),N["$[]"]("odd"),N["$[]"]("even"))}),O(S,"$initialize",function(te,k,de){var N=this;return N.name=te,N.odd=k.$freeze(),N.even=de.$freeze()}),O(S,"$roll",function(te){var N,g,l,k=this,de=B;return de=te.$roll_once(6),N=te.$roll_once(6),g=(E(de["$odd?"]())?k.odd:k.even)["$[]"](Y(N,1)),l=G(D(de,10),N),v("RollResult").$new(k.name,l,g)})},Opal.modules["bcdice/dice_table/d66_range_table"]=function(d){var W,j,I,A,J,L,S,z,Z,H=d.module,ee=d.klass,$=d.def,x=d.rb_plus,O=d.rb_times,E=d.send,Y=[],G=d.nil;return W=Y,j=Z=[H(Y[0],"BCDice")].concat(W),I=z=[H(Z[0],"DiceTable")].concat(j),J=[A=ee(z[0],null,"D66RangeTable")].concat(I),L=d.$r(J),(S=A.$$prototype).items=S.name=G,$(A,"$initialize",function(v,P){return this.name=v,this.items=P.$freeze()}),$(A,"$roll",function(v){var R,te,k,de=G;return R=v.$roll_once(6),te=v.$roll_once(6),k=x(O(R,10),te),de=E(this.items,"find",[],function(F){return null==F&&(F=G),F["$[]"](0)["$include?"](k)}),L("RollResult").$new(this.name,k,de["$[]"](1))})},Opal.modules["bcdice/dice_table/range_table"]=function(d){var T,q,L,S,M,v,P,I,oe,H=d.module,ee=d.klass,$=d.const_set,x=d.send,O=d.truthy,E=d.def,Y=d.eqeqeq,G=d.rb_times,D=d.rb_plus,W=[],B=d.nil;return T=W,q=oe=[H(W[0],"BCDice")].concat(T),L=I=[H(oe[0],"DiceTable")].concat(q),M=[S=ee(I[0],null,"RangeTable")].concat(L),v=d.$r(M),(P=S.$$prototype).name=P.items=P.num_of_dice=P.num_of_sides=P.formatter=B,$(M[0],"RollResult",x(v("Struct"),"new",["sum","values","content","formatted"],function R(){return(null==R.$$s?this:R.$$s).$alias_method("to_s","formatted")},{$$s:S})),$(M[0],"Item",v("Struct").$new("range","content")),$(M[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),$(M[0],"DEFAULT_FORMATTER",x(S,"lambda",[],function(te,k){return null==te&&(te=B),null==k&&(k=B),te.$name()+"("+k.$sum()+") \uff1e "+k.$content()})),S.$attr_reader("name"),S.$attr_reader("num_of_dice"),S.$attr_reader("num_of_sides"),E(S,"$initialize",function R(te,k,de){var g,N=R.$$p||B,F=this,l=B;return R.$$p=null,F.name=te.$freeze(),F.formatter=O(g=N)?g:v("DEFAULT_FORMATTER"),l=v("DICE_ROLL_METHOD_RE").$match(k),O(l)||F.$raise(v("ArgumentError"),F.name+": invalid dice roll method: "+k),F.num_of_dice=l["$[]"](1).$to_i(),F.num_of_sides=l["$[]"](2).$to_i(),F.$store(de)}),E(S,"$fetch",function(te){var de,k=this;return de=x(k.items,"find",[],function(F){return null==F&&(F=B),F.$range()["$include?"](te)}),O(de)||k.$raise(v("RangeError"),k.name+": value is out of range: "+te),de}),E(S,"$roll",function(te){var N,k=this,de=B,F=B;return N=(de=te.$roll_barabara(k.num_of_dice,k.num_of_sides)).$sum(),(F=v("RollResult").$new(N,de,k.$fetch(N).$content()))["$formatted="](k.formatter["$[]"](k,F)),F}),S.$private(),E(S,"$store",function(te){var de,N,k=this;return de=x(te,"map",[],function F(g,l){return null==g&&(g=B),null==l&&(l=B),[(null==F.$$s?this:F.$$s).$coerce_to_int_range(g),l]},{$$s:k}),N=x(de,"sort_by",[],function(g,l){return null==g&&(g=B),null==l&&(l=B),g.$min()}),k.$assert_min_sum_is_covered(N),k.$assert_max_sum_is_covered(N),k.$assert_no_gap_or_overlap_in_ranges(N),k.items=x(N,"map",[],function(g,l){return null==g&&(g=B),null==l&&(l=B),v("Item").$new(g,l.$freeze()).$freeze()}).$freeze(),k}),E(S,"$coerce_to_int_range",function(te){var de;return Y(v("Integer"),de=te)?v("Range").$new(te,te):Y(v("Range"),de)&&O(te.$begin()["$is_a?"](v("Integer")))&&O(te.$end()["$is_a?"](v("Integer")))?te:this.$raise(v("TypeError"),this.name+": "+te+" ("+te.$class()+") must be an Integer or a Range with Integers ")}),E(S,"$assert_min_sum_is_covered",function(te){var de,k=this,N=B;return de=k.num_of_dice,N=te.$first()["$[]"](0),O(N["$include?"](de))||k.$raise(v("RangeError"),k.name+": min value ("+de+") is not covered: "+N),k}),E(S,"$assert_max_sum_is_covered",function(te){var de,k=this,N=B;return de=G(k.num_of_dice,k.num_of_sides),N=te.$last()["$[]"](0),O(N["$include?"](de))||k.$raise(v("RangeError"),k.name+": max value ("+de+") is not covered: "+N),k}),E(S,"$assert_no_gap_or_overlap_in_ranges",function(te){return x(te,"each_cons",[2],function de(N,F){var f,u,g=null==de.$$s?this:de.$$s,l=B,c=B;return null==g.name&&(g.name=B),null==N&&(N=B),null==F&&(F=B),l=N["$[]"](0),c=F["$[]"](0),f=l.$max(),u=D(f,1),O(c["$include?"](f))&&g.$raise(v("RangeError"),g.name+": Range overlap: "+l+" and "+c),O(c["$include?"](u))?B:g.$raise(v("RangeError"),g.name+": Range gap: "+l+" and "+c)},{$$s:this}),this})},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(d){var B,oe,A,v,P,R,te,L,q,T,H=d.module,ee=d.klass,$=d.send,x=d.def,O=d.rb_minus,E=d.return_ivar,Y=[],G=d.nil,D=d.$$$;return B=Y,oe=T=[H(Y[0],"BCDice")].concat(B),A=q=[H(T[0],"DiceTable")].concat(oe),v=L=[ee(q[0],null,"SaiFicSkillTable")].concat(A),R=[P=ee(L[0],null,"Category")].concat(v),te=d.$r(R),x(P,"$initialize",function(de,N,F,g){var l=this;return l.name=de,l.skills=$(N.$map(),"with_index",[2],function(f,u){return null==f&&(f=G),null==u&&(u=G),D(te("SaiFicSkillTable"),"Skill").$new(de,f,F,u,g)}),l.dice=F}),x(P,"$roll",function(de){return this.$skills()["$[]"](O(de.$roll_sum(2,6),2))}),x(P,"$to_s",E("name")),P.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(d){var G,Z,q,L,S,I,j,W,H=d.module,ee=d.klass,$=d.def,x=d.hash2,O=[],E=d.nil;return G=O,Z=W=[H(O[0],"BCDice")].concat(G),q=j=[H(W[0],"DiceTable")].concat(Z),I=[ee(j[0],null,"SaiFicSkillTable")].concat(q),(S=(L=ee(I[0],null,"Skill")).$$prototype).s_format=S.category_dice=S.row_dice=S.category_name=S.name=E,$(L,"$initialize",function(v,P,R,te,k){var de=this;return de.category_name=v,de.name=P,de.category_dice=R,de.row_dice=te,de.s_format=k}),$(L,"$to_s",function(){var v=this;return v.$format(v.s_format,x(["category_dice","row_dice","category_name","skill_name"],{category_dice:v.category_dice,row_dice:v.row_dice,category_name:v.category_name,skill_name:v.name}))}),L.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(d){var I,S,te,k,de,N,F,v,J,H=d.module,ee=d.klass,$=d.ensure_kwargs,x=d.hash2,O=d.send,Y=d.defs,G=d.const_set,D=d.to_ary,W=d.def,B=d.truthy,Z=d.rb_minus,T=d.rb_plus,j=d.top,oe=[],z=d.nil,q=d.$$$;return j.$require("bcdice/dice_table/sai_fic_skill_table/category"),j.$require("bcdice/dice_table/sai_fic_skill_table/skill"),I=oe,S=J=[H(oe[0],"BCDice")].concat(I),te=v=[H(J[0],"DiceTable")].concat(S),de=[k=ee(v[0],null,"SaiFicSkillTable")].concat(te),N=d.$r(de),(F=k.$$prototype).rtt=F.rtt_format=F.rct=F.rct_format=F.rttn=F.rttn_format=F.categories=z,Y(k,"$from_i18n",function(l,c,f){var u,p,_,se,ne=z;return null==(u=(f=$(f)).$$smap.rtt)&&(u=z),null==(p=f.$$smap.rct)&&(p=z),null==(_=f.$$smap.rttn)&&(_=z),se=(ne=N("I18n").$t("RTT",x(["locale","raise","default"],{locale:c,raise:!1,default:x([],{})})).$merge(N("I18n").$t(l,x(["locale","raise"],{locale:c,raise:!0}))))["$[]"]("items"),ne=O(ne,"select",[],function(ke,ce){return null==ke&&(ke=z),null==ce&&(ce=z),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](ke)}),this.$new(se,d.to_hash(ne).$merge(x(["rtt","rct","rttn"],{rtt:u,rct:p,rttn:_})))},-3),G(de[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),G(de[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),G(de[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),G(de[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),W(k,"$initialize",function(l,c){var f,u,p,_,y,m,ne,se=this;return null==(f=(c=$(c)).$$smap.rtt)&&(f=z),null==(u=c.$$smap.rct)&&(u=z),null==(p=c.$$smap.rttn)&&(p=z),null==(_=c.$$smap.rtt_format)&&(_=N("DEFAULT_RTT")),null==(y=c.$$smap.rct_format)&&(y=N("DEFAULT_RCT")),null==(m=c.$$smap.rttn_format)&&(m=N("DEFAULT_RTTN")),null==(ne=c.$$smap.s_format)&&(ne=N("DEFAULT_S")),se.categories=O(l.$map(),"with_index",[1],function(ke,ce){var Me,be,he;return null==ke&&(ke=z),null==ce&&(ce=z),be=null==(Me=D(ke))[0]?z:Me[0],he=null==Me[1]?z:Me[1],q(N("SaiFicSkillTable"),"Category").$new(be,he,ce,ne)},{$$has_top_level_mlhs_arg:!0}),se.rtt=f,se.rct=u,se.rttn=p.$to_a(),se.rtt_format=_,se.rct_format=y,se.rttn_format=m},-2),G(de[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),k.$attr_reader("categories"),W(k,"$roll_command",function(l,c){var u,f=this,p=z,_=z;return B(["RTT",f.rtt]["$include?"](u=c))?f.$format_skill(f.rtt_format,f.$roll_skill(l)):B(["RCT",f.rct]["$include?"](u))?(p=f.$roll_category(l),f.$format(f.rct_format,x(["category_dice","category_name"],{category_dice:p.$dice(),category_name:p.$name()}))):B(_=N("RTTN").$index(u))||B(_=f.rttn.$index(u))?f.$format_skill(f.rttn_format,f.categories["$[]"](_).$roll(l)):z}),W(k,"$roll_category",function(l){return this.categories["$[]"](Z(l.$roll_once(6),1))}),W(k,"$roll_skill",function(l){return this.$roll_category(l).$roll(l)}),W(k,"$prefixes",function(){var l=this;return T(["RTT[1-6]?","RCT",l.rtt,l.rct],l.rttn).$compact()}),k.$private(),W(k,"$format_skill",function(l,c){return this.$format(l,x(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:c.$category_dice(),row_dice:c.$row_dice(),category_name:c.$category_name(),skill_name:c.$name(),text:c.$to_s()}))})},Opal.modules["bcdice/dice_table/table"]=function(d){var B,oe,A,J,L,S,M,q,T,H=d.module,ee=d.klass,$=d.hash2,x=d.defs,O=d.truthy,E=d.def,Y=d.rb_minus,G=[],D=d.nil;return B=G,oe=T=[H(G[0],"BCDice")].concat(B),A=q=[H(T[0],"DiceTable")].concat(oe),L=[J=ee(q[0],null,"Table")].concat(A),S=d.$r(L),(M=J.$$prototype).times=M.sides=M.name=M.items=D,x(J,"$from_i18n",function(P,R){var k=D;return k=S("I18n").$t(P,$(["locale"],{locale:R})),this.$new(k["$[]"]("name"),k["$[]"]("type"),k["$[]"]("items"))}),E(J,"$initialize",function(P,R,te){var k=this,de=D;return k.name=P,k.items=te.$freeze(),de=/(\d+)D(\d+)/i.$match(R),O(de)||k.$raise(S("ArgumentError"),"Unexpected table type: "+R),k.times=de["$[]"](1).$to_i(),k.sides=de["$[]"](2).$to_i()}),E(J,"$roll",function(P){var te,R=this;return te=P.$roll_sum(R.times,R.sides),R.$choice(te)}),E(J,"$choice",function(P){var te,R=this;return te=Y(P,R.times),S("RollResult").$new(R.name,P,R.items["$[]"](te))})},Opal.modules["bcdice/dice_table"]=function(d){var H=d.top;return H.$require("bcdice/dice_table/roll_result"),H.$require("bcdice/dice_table/chain_table"),H.$require("bcdice/dice_table/d66_grid_table"),H.$require("bcdice/dice_table/d66_half_grid_table"),H.$require("bcdice/dice_table/d66_one_third_table"),H.$require("bcdice/dice_table/d66_left_range_table"),H.$require("bcdice/dice_table/d66_parity_table"),H.$require("bcdice/dice_table/d66_range_table"),H.$require("bcdice/dice_table/d66_table"),H.$require("bcdice/dice_table/range_table"),H.$require("bcdice/dice_table/sai_fic_skill_table"),H.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(d){var E,W,Z,G,H=d.module,ee=d.const_set,$=[];return E=$,W=G=[H($[0],"BCDice")].concat(E),Z=[H(G[0],"D66SortType")].concat(W),ee(Z[0],"NO_SORT","no_sort"),ee(Z[0],"ASC","asc"),ee(Z[0],"DESC","desc"),function(D,W){var Z=[H(D,"RoundType")].concat(W);return ee(Z[0],"CEIL","ceil"),ee(Z[0],"FLOOR","floor"),ee(Z[0],"ROUND","round")}(G[0],G)},Opal.modules["bcdice/translate"]=function(d){var W,j,oe,z,q,Z,H=d.module,ee=d.ensure_kwargs,$=d.kwrestargs,O=d.hash2,E=d.def,Y=[],G=d.nil;return W=Y,j=Z=[H(Y[0],"BCDice")].concat(W),z=[oe=H(Z[0],"Translate")].concat(j),q=d.$r(z),E(oe,"$translate",function(I,A){var J,L=this;return null==L.locale&&(L.locale=G),A=ee(A),J=$(A,{}),q("I18n").$translate(I,O(["locale","raise"],{locale:L.locale,raise:!0}).$merge(d.to_hash(J)))},-2)},Opal.modules["bcdice/result"]=function(d){var oe,K,z,W,Z,ee=d.klass,$=d.send,x=d.def,O=d.return_val,E=d.return_ivar,Y=[],G=d.nil;return W=Y,oe=Z=[(0,d.module)(Y[0],"BCDice")].concat(W),[z=ee(Z[0],null,"Result")].concat(oe),x(K=d.get_singleton_class(z),"$success",function(J){return $(this.$new(),"tap",[],function(M){var v;return null==M&&(M=G),M["$text="](J),$(M,"success=",v=[!0]),v[v.length-1]})}),x(K,"$failure",function(J){return $(this.$new(),"tap",[],function(M){var v;return null==M&&(M=G),M["$text="](J),$(M,"failure=",v=[!0]),v[v.length-1]})}),x(K,"$critical",function(J){return $(this.$new(),"tap",[],function(M){var v;return null==M&&(M=G),M["$text="](J),M["$critical="](!0),$(M,"success=",v=[!0]),v[v.length-1]})}),x(K,"$fumble",function(J){return $(this.$new(),"tap",[],function(M){var v;return null==M&&(M=G),M["$text="](J),M["$fumble="](!0),$(M,"failure=",v=[!0]),v[v.length-1]})}),x(K,"$nothing",O("nothing")),x(z,"$initialize",function(I){var A=this;return null==I&&(I=G),A.text=I,A.rands=G,A.detailed_rands=G,A.secret=!1,A.success=!1,A.failure=!1,A.critical=!1,A.fumble=!1},-1),z.$attr_accessor("text","rands","detailed_rands"),z.$attr_writer("secret","success","failure","critical","fumble"),x(z,"$secret?",E("secret")),x(z,"$success?",E("success")),x(z,"$failure?",E("failure")),x(z,"$critical?",E("critical")),x(z,"$fumble?",E("fumble")),x(z,"$condition=",function(I){return this.success=I,this.failure=I["$!"]()})},Opal.modules["racc/parser"]=function(d){var P,te,k,H=d.module,ee=d.klass,$=d.truthy,x=d.const_set,O=d.defs,E=d.gvars,Y=d.rb_lt,G=d.def,D=d.to_ary,W=d.send,B=d.neqeq,Z=d.rb_plus,T=d.eqeq,j=d.rb_ge,oe=d.rb_gt,z=d.rb_minus,q=d.rb_le,K=d.rb_times,I=d.assign_ivar_val,J=[],L=d.$r(J),S=d.nil,M=d.$$$;return P=J,te=[H(J[0],"Racc")].concat(P),k=d.$r(te),ee(te[0],k("StandardError"),"ParseError"),$(M("::","ParseError","skip_raise")?"constant":S)||x(J[0],"ParseError",M(L("Racc"),"ParseError")),function(v,P){var g,l,c,f,u,k=[H(v,"Racc")].concat(P),de=d.$r(k);return $(de("Racc_No_Extensions","skip_raise")?"constant":S)||x(k[0],"Racc_No_Extensions",!1),g=k,c=[l=ee(k[0],null,"Parser")].concat(g),f=d.$r(c),(u=l.$$prototype).yydebug=u.racc_debug_out=u.racc_error_status=u.racc_t=u.racc_vstack=u.racc_val=u.racc_state=u.racc_tstack=S,x(c[0],"Racc_Runtime_Version","1.4.6"),x(c[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),x(c[0],"Racc_Runtime_Core_Version_R","1.4.6"),x(c[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),x(c[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),x(c[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),x(c[0],"Racc_Runtime_Core_Version",f("Racc_Runtime_Core_Version_R")),x(c[0],"Racc_Runtime_Core_Revision",f("Racc_Runtime_Core_Revision_R")),x(c[0],"Racc_Runtime_Type","ruby"),O(f("Parser"),"$racc_runtime_type",function(){return f("Racc_Runtime_Type")}),G(l,"$_racc_setup",function(){var _,y,m=this,ne=S,se=S;return null==E.stderr&&(E.stderr=S),$(M(m.$class(),"Racc_debug_parser"))||(m.yydebug=!1),$(null!=(_=m.yydebug)&&_!==S?"instance-variable":S)||(m.yydebug=!1),$(m.yydebug)&&($(null!=(y=m.racc_debug_out)&&y!==S?"instance-variable":S)||(m.racc_debug_out=E.stderr),m.racc_debug_out=$(ne=m.racc_debug_out)?ne:E.stderr),se=M(m.$class(),"Racc_arg"),$(Y(se.$size(),14))&&se["$[]="](13,!0),se}),G(l,"$_racc_init_sysvars",function(){var _=this;return _.racc_state=[0],_.racc_tstack=[],_.racc_vstack=[],_.racc_t=S,_.racc_val=S,_.racc_read_next=!0,_.racc_user_yyerror=!1,_.racc_error_status=0}),G(l,"$do_parse",function(){return this.$__send__(f("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),G(l,"$next_token",function(){return this.$raise(f("NotImplementedError"),this.$class()+"#next_token is not defined")}),G(l,"$_racc_do_parse_rb",function(_,y){var m,Ee=S,ke=S,ce=S,Me=S,be=S,he=S,Se=S,ve=S;return m=D(_),Ee=null==m[0]?S:m[0],ke=null==m[1]?S:m[1],ce=null==m[2]?S:m[2],Me=null==m[3]?S:m[3],be=null==m[10]?S:m[10],this.$_racc_init_sysvars(),he=Se=ve=S,W(this,"catch",["racc_end_parse"],function ae(){var ue,Ce,b=null==ae.$$s?this:ae.$$s,V=S;for(null==b.racc_state&&(b.racc_state=S),null==b.racc_read_next&&(b.racc_read_next=S),null==b.racc_t&&(b.racc_t=S),null==b.yydebug&&(b.yydebug=S),null==b.racc_val&&(b.racc_val=S);$(!0);)for($(ve=Me["$[]"](b.racc_state["$[]"](-1)))?($(b.racc_read_next)&&B(b.racc_t,0)&&(Ce=b.$next_token(),ue=D(Ce),he=null==ue[0]?S:ue[0],b.racc_val=null==ue[1]?S:ue[1],b.racc_t=$(he)?$(V=be["$[]"](he))?V:1:0,$(b.yydebug)&&b.$racc_read_token(b.racc_t,he,b.racc_val),b.racc_read_next=!1),ve=Z(ve,b.racc_t),$(j(ve,0))&&$(Se=Ee["$[]"](ve))&&T(ke["$[]"](ve),b.racc_state["$[]"](-1))||(Se=ce["$[]"](b.racc_state["$[]"](-1)))):Se=ce["$[]"](b.racc_state["$[]"](-1));$(Se=b.$_racc_evalact(Se,_)););},{$$s:this})}),G(l,"$yyparse",function(_,y){return this.$__send__(f("Racc_YY_Parse_Method"),_,y,this.$_racc_setup(),!0)}),G(l,"$_racc_yyparse_rb",function(_,y,m,ne){var se,ce=S,Me=S,$e=S,be=S,Se=S,ve=S,ae=S;return se=D(m),ce=null==se[0]?S:se[0],Me=null==se[1]?S:se[1],$e=null==se[2]?S:se[2],be=null==se[3]?S:se[3],Se=null==se[10]?S:se[10],this.$_racc_init_sysvars(),ve=S,ae=S,W(this,"catch",["racc_end_parse"],function ue(){var Ce=null==ue.$$s?this:ue.$$s;for(null==Ce.racc_state&&(Ce.racc_state=S);!$(ae=be["$[]"](Ce.racc_state["$[]"](-1)));)for(;$(ve=Ce.$_racc_evalact($e["$[]"](Ce.racc_state["$[]"](-1)),m)););return W(_,"__send__",[y],function b(V,ge){var xe=null==b.$$s?this:b.$$s,De=S,Re=S;for(null==xe.racc_t&&(xe.racc_t=S),null==xe.racc_state&&(xe.racc_state=S),null==xe.racc_read_next&&(xe.racc_read_next=S),null==V&&(V=S),null==ge&&(ge=S),xe.racc_t=$(V)?$(De=Se["$[]"](V))?De:1:0,xe.racc_val=ge,xe.racc_read_next=!1,ae=Z(ae,xe.racc_t),$(j(ae,0))&&$(ve=ce["$[]"](ae))&&T(Me["$[]"](ae),xe.racc_state["$[]"](-1))||(ve=$e["$[]"](xe.racc_state["$[]"](-1)));$(ve=xe.$_racc_evalact(ve,m)););for(;$($(De=$(Re=(ae=be["$[]"](xe.racc_state["$[]"](-1)))["$!"]())?Re:xe.racc_read_next["$!"]())?De:xe.racc_t["$=="](0));)for($(ae)&&$(ae=Z(ae,xe.racc_t))&&$(j(ae,0))&&$(ve=ce["$[]"](ae))&&T(Me["$[]"](ae),xe.racc_state["$[]"](-1))||(ve=$e["$[]"](xe.racc_state["$[]"](-1)));$(ve=xe.$_racc_evalact(ve,m)););},{$$s:Ce})},{$$s:this})}),G(l,"$_racc_evalact",function(_,y){var m,$e,se=this,Ee=S,ke=S,Me=S,be=S,he=S,Se=S;if(Ee=null==(m=D(y))[0]?S:m[0],ke=null==m[1]?S:m[1],Me=null==m[3]?S:m[3],$e=null==m[11]?S:m[11],be=null==m[12]?S:m[12],$(oe(_,0))&&$(Y(_,$e)))$(oe(se.racc_error_status,0))&&(T(se.racc_t,1)||(se.racc_error_status=z(se.racc_error_status,1))),se.racc_vstack.$push(se.racc_val),se.racc_state.$push(_),se.racc_read_next=!0,$(se.yydebug)&&(se.racc_tstack.$push(se.racc_t),se.$racc_shift(se.racc_t,se.racc_tstack,se.racc_vstack));else if($(Y(_,0))&&$(oe(_,be["$-@"]()))){if(he=W(se,"catch",["racc_jump"],function ve(){var ae=null==ve.$$s?this:ve.$$s;return null==ae.racc_state&&(ae.racc_state=S),ae.racc_state.$push(ae.$_racc_do_reduce(y,_)),!1},{$$s:se}),$(he))switch(he){case 1:return se.racc_user_yyerror=!0,be["$-@"]();case 2:return $e;default:se.$raise("[Racc Bug] unknown jump code")}}else if(T(_,$e))$(se.yydebug)&&se.$racc_accept(),se.$throw("racc_end_parse",se.racc_vstack["$[]"](0));else{if(T(_,be["$-@"]())){switch(se.racc_error_status){case 0:$(y["$[]"](21))||se.$on_error(se.racc_t,se.racc_val,se.racc_vstack);break;case 3:T(se.racc_t,0)&&se.$throw("racc_end_parse",S),se.racc_read_next=!0}for(se.racc_user_yyerror=!1,se.racc_error_status=3;$(!0)&&!($(Se=Me["$[]"](se.racc_state["$[]"](-1)))&&(Se=Z(Se,1),$(j(Se,0))&&$(_=Ee["$[]"](Se))&&T(ke["$[]"](Se),se.racc_state["$[]"](-1))));)$(q(se.racc_state.$size(),1))&&se.$throw("racc_end_parse",S),se.racc_state.$pop(),se.racc_vstack.$pop(),$(se.yydebug)&&(se.racc_tstack.$pop(),se.$racc_e_pop(se.racc_state,se.racc_tstack,se.racc_vstack));return _}se.$raise("[Racc Bug] unknown action "+_.$inspect())}return $(se.yydebug)&&se.$racc_next_state(se.racc_state["$[]"](-1),se.racc_state),S}),G(l,"$_racc_do_reduce",function(_,y){var m,be,Se,V,ge,xe,Ue,se=this,ke=S,ce=S,Me=S,$e=S,he=S,ve=S,ae=S,ue=S,Ce=S,b=S,De=S,Re=S,Ze=S;return ke=null==(m=D(_))[4]?S:m[4],ce=null==m[5]?S:m[5],Me=null==m[6]?S:m[6],$e=null==m[7]?S:m[7],be=null==m[8]?S:m[8],he=null==m[9]?S:m[9],Se=null==m[13]?S:m[13],ve=se.racc_state,ae=se.racc_vstack,ue=se.racc_tstack,Ce=K(y,-3),b=he["$[]"](Ce),V=he["$[]"](Z(Ce,1)),ge=he["$[]"](Z(Ce,2)),xe=[],$(se.yydebug)&&(De=ue["$[]"](b["$-@"](),b)),Re=ae["$[]"](b["$-@"](),b),$(se.yydebug)&&ue["$[]="](b["$-@"](),b,xe),ae["$[]="](b["$-@"](),b,xe),ve["$[]="](b["$-@"](),b,xe),$(Se)?ae.$push(se.$__send__(ge,Re,ae,Re["$[]"](0))):ae.$push(se.$__send__(ge,Re,ae)),ue.$push(V),$(se.yydebug)&&se.$racc_reduce(De,V,ue,ae),Ue=z(V,be),$(Ce=$e["$[]"](Ue))&&(Ce=Z(Ce,ve["$[]"](-1)),$(j(Ce,0))&&$(Ze=ke["$[]"](Ce))&&T(ce["$[]"](Ce),Ue))?Ze:Me["$[]"](Ue)}),G(l,"$on_error",function(_,y,m){var se;return this.$raise(f("ParseError"),this.$sprintf("\nparse error on value %s (%s)",y.$inspect(),$(se=this.$token_to_str(_))?se:"?"))}),G(l,"$yyerror",function(){return this.$throw("racc_jump",1)}),G(l,"$yyaccept",function(){return this.$throw("racc_jump",2)}),G(l,"$yyerrok",I("racc_error_status",0)),G(l,"$racc_read_token",function(_,y,m){var ne=this;return ne.racc_debug_out.$print("read    "),ne.racc_debug_out.$print(y.$inspect(),"(",ne.$racc_token2str(_),") "),ne.racc_debug_out.$puts(m.$inspect()),ne.racc_debug_out.$puts()}),G(l,"$racc_shift",function(_,y,m){return this.racc_debug_out.$puts("shift   "+this.$racc_token2str(_)),this.$racc_print_stacks(y,m),this.racc_debug_out.$puts()}),G(l,"$racc_reduce",function(_,y,m,ne){var se=this,Ee=S;return(Ee=se.racc_debug_out).$print("reduce "),$(_["$empty?"]())?Ee.$print(" <none>"):W(_,"each",[],function ke(ce){return null==ce&&(ce=S),Ee.$print(" ",(null==ke.$$s?this:ke.$$s).$racc_token2str(ce))},{$$s:se}),Ee.$puts(" --\x3e "+se.$racc_token2str(y)),se.$racc_print_stacks(m,ne),se.racc_debug_out.$puts()}),G(l,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),G(l,"$racc_e_pop",function(_,y,m){return this.racc_debug_out.$puts("error recovering mode: pop token"),this.$racc_print_states(_),this.$racc_print_stacks(y,m),this.racc_debug_out.$puts()}),G(l,"$racc_next_state",function(_,y){var m=this;return m.racc_debug_out.$puts("goto    "+_),m.$racc_print_states(y),m.racc_debug_out.$puts()}),G(l,"$racc_print_stacks",function(_,y){var ne=S;return(ne=this.racc_debug_out).$print("        ["),W(_,"each_index",[],function se(Ee){return null==Ee&&(Ee=S),ne.$print(" (",(null==se.$$s?this:se.$$s).$racc_token2str(_["$[]"](Ee))," ",y["$[]"](Ee).$inspect(),")")},{$$s:this}),ne.$puts(" ]")}),G(l,"$racc_print_states",function(_){var m=S;return(m=this.racc_debug_out).$print("        ["),W(_,"each",[],function(se){return null==se&&(se=S),m.$print(" ",se)}),m.$puts(" ]")}),G(l,"$racc_token2str",function(_){var m;return $(m=M(this.$class(),"Racc_token_to_s_table")["$[]"](_))?m:this.$raise("[Racc Bug] can't convert token "+_+" to string")}),G(l,"$token_to_str",function(_){return M(this.$class(),"Racc_token_to_s_table")["$[]"](_)})}(J[0],J)},Opal.modules["bcdice/arithmetic/node"]=function(d){var I,S,R,g,l,k,de,v,J,H=d.module,ee=d.klass,$=d.def,x=d.thrower,O=d.return_ivar,E=d.send2,Y=d.find_super,G=d.eqeq,D=d.const_set,W=d.eqeqeq,B=d.rb_divide,Z=d.truthy,T=d.assign_ivar,j=d.alias,oe=[],z=d.nil,q=d.$$$;return I=oe,S=J=[H(oe[0],"BCDice")].concat(I),R=v=[H(J[0],"Arithmetic")].concat(S),k=[H(v[0],"Node")].concat(R),de=d.$r(k),(l=(g=ee(k[0],null,"BinaryOp")).$$prototype).lhs=l.rhs=l.op=z,$(g,"$initialize",function(f,u,p){var _=this;return _.lhs=f,_.op=u,_.rhs=p}),$(g,"$eval",function(f){try{x("eval_return");var y,p=this,_=z;return _=p.lhs.$eval(f),y=p.rhs.$eval(f),_.$send(p.op,y)}catch(m){if(m===d.t_eval_return)return m.$v;throw m}}),$(g,"$output",function(){var f=this;return""+f.lhs.$output()+f.op+f.rhs.$output()}),$(g,"$s_exp",function(){var f=this;return"("+f.$op_for_s_exp()+" "+f.lhs.$s_exp()+" "+f.rhs.$s_exp()+")"}),$(g,"$op_for_s_exp",O("op")),function(N,F,g){var l=ee(N,F,"DivideBase"),c=[l].concat(g),f=d.$r(c),u=l.$$prototype;u.lhs=u.rhs=u.op=z,$(l,"$initialize",function p(_,y){return p.$$p=null,E(this,Y(this,"initialize",p,!1,!0),"initialize",[_,"/",y],null)}),$(l,"$eval",function(_){try{x("eval_return");var ne,se,m=this;return ne=m.lhs.$eval(_),se=m.rhs.$eval(_),G(se,0)&&m.$raise(f("ZeroDivisionError")),m.$divide_and_round(ne,se,_)}catch(Ee){if(Ee===d.t_eval_return)return Ee.$v;throw Ee}}),$(l,"$output",function p(){var _=p.$$p||z,y=this;return p.$$p=null,""+E(y,Y(y,"output",p,!1,!0),"output",[],_)+y.$rounding_method()}),l.$private(),$(l,"$rounding_method",function(){return q(this.$class(),"ROUNDING_METHOD")}),$(l,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),$(l,"$divide_and_round",function(_,y,m){return this.$raise(f("NotImplementedError"))})}(k[0],de("BinaryOp"),k),function(N,F,g){var l=ee(N,F,"DivideWithGameSystemDefault"),c=[l].concat(g),f=d.$r(c);D(c[0],"ROUNDING_METHOD",""),l.$private(),$(l,"$divide_and_round",function(p,_,y){var m,ne=z;return W(q(f("RoundType"),"CEIL"),m=y)?B(p.$to_f(),_).$ceil():W(q(f("RoundType"),"ROUND"),m)?(ne=B(p.$to_f(),_),Z(ne["$negative?"]())?ne.$abs().$round()["$-@"]():ne.$round()):B(p,_).$floor()})}(k[0],de("DivideBase"),k),function(N,F,g){var l=ee(N,F,"DivideWithCeil"),c=[l].concat(g);D(c[0],"ROUNDING_METHOD","C"),l.$private(),$(l,"$divide_and_round",function(u,p,_){return B(u.$to_f(),p).$ceil()})}(k[0],de("DivideBase"),k),function(N,F,g){var l=ee(N,F,"DivideWithRound"),c=[l].concat(g);D(c[0],"ROUNDING_METHOD","R"),l.$private(),$(l,"$divide_and_round",function(u,p,_){var y=z;return y=B(u.$to_f(),p),Z(y["$negative?"]())?y.$abs().$round()["$-@"]():y.$round()})}(k[0],de("DivideBase"),k),function(N,F,g){var l=ee(N,F,"DivideWithFloor"),c=[l].concat(g);D(c[0],"ROUNDING_METHOD","F"),l.$private(),$(l,"$divide_and_round",function(u,p,_){return B(u,p).$floor()})}(k[0],de("DivideBase"),k),function(N,F){var g=ee(N,null,"Negative");g.$$prototype.body=z,$(g,"$initialize",T("body")),$(g,"$eval",function(f){try{return x("eval_return"),this.body.$eval(f)["$-@"]()}catch(_){if(_===d.t_eval_return)return _.$v;throw _}}),$(g,"$output",function(){return"-"+this.body.$output()}),$(g,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(k[0]),function(N,F){var g=ee(N,null,"Parenthesis");g.$$prototype.expr=z,$(g,"$initialize",T("expr")),$(g,"$eval",function(f){try{return x("eval_return"),this.expr.$eval(f)}catch(_){if(_===d.t_eval_return)return _.$v;throw _}}),$(g,"$output",function(){return"("+this.expr.$output()+")"}),$(g,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(k[0]),function(N,F){var g=ee(N,null,"Number");return g.$$prototype.value=z,$(g,"$initialize",T("value")),$(g,"$eval",O("value")),$(g,"$output",function(){return this.value.$to_s()}),j(g,"s_exp","output")}(k[0])},Opal.modules.strscan=function(d){var T,j,oe,z,q,ee=d.def,$=d.truthy,x=d.eqeqeq,O=d.Opal,E=d.return_ivar,Y=d.send,G=d.alias,D=[],W=d.nil;return T=D,oe=[j=(0,d.klass)(D[0],null,"StringScanner")].concat(T),z=d.$r(oe),(q=j.$$prototype).pos=q.string=q.working=q.matched=q.prev_pos=q.match=W,j.$attr_reader("pos","matched"),ee(j,"$initialize",function(I){var A=this;return A.string=I,A.pos=0,A.matched=W,A.working=I,A.match=[]}),j.$attr_reader("string"),ee(j,"$beginning_of_line?",function(){var I=this;return 0===I.pos||"\n"===I.string.charAt(I.pos-1)}),ee(j,"$scan",function(I){var A=this,J=(I=A.$anchor(I)).exec(A.working);return null==J?A.matched=W:(A.prev_pos=A.pos,A.pos+=J[0].length,A.working=A.working.substring(J[0].length),A.matched=J[0],A.match=J,J[0])}),ee(j,"$scan_until",function(I){var A=this;I=A.$anchor(I);for(var J=A.working,L=0;J.length!=L;++L){var S=I.exec(J.substr(L));if(null!==S){var M=L+S[0].length,v=J.substr(0,M);return A.matched=S[0],A.match=S,A.prev_pos=A.pos+L,A.pos+=M,A.working=J.substr(M),v}}return A.matched=W}),ee(j,"$[]",function(I){var J;if($(this.match["$empty?"]()))return W;x(z("Symbol"),J=I)?I=I.$to_s():x(z("String"),J)||(I=O["$coerce_to!"](I,z("Integer"),"to_int"));var L=this.match;return I<0&&(I+=L.length),I<0||I>=L.length||null==L[I]?W:L[I]}),ee(j,"$check",function(I){var A=this,J=(I=A.$anchor(I)).exec(A.working);return A.matched=null==J?W:J[0]}),ee(j,"$check_until",function(I){var A=this,J=A.prev_pos,L=A.pos,S=A.working,M=A.$scan_until(I);return A.prev_pos=J,A.pos=L,A.working=S,M}),ee(j,"$peek",function(I){return this.working.substring(0,I)}),ee(j,"$eos?",function(){return 0===this.working.length}),ee(j,"$exist?",function(I){var J=I.exec(this.working);return null==J?W:0==J.index?0:J.index+1}),ee(j,"$skip",function(I){var A=this,J=(I=A.$anchor(I)).exec(A.working);if(null==J)return A.match=[],A.matched=W;var L=J[0],S=L.length;return A.matched=L,A.match=J,A.prev_pos=A.pos,A.pos+=S,A.working=A.working.substring(S),S}),ee(j,"$skip_until",function(I){var J=this.$scan_until(I);return J===W?W:(this.matched=J.substr(-1),J.length)}),ee(j,"$get_byte",function(){var I=this,A=W;return I.pos<I.string.length?(I.prev_pos=I.pos,I.pos+=1,A=I.matched=I.working.substring(0,1),I.working=I.working.substring(1)):I.matched=W,A}),ee(j,"$match?",function(I){var A=this,J=(I=A.$anchor(I)).exec(A.working);return null==J?W:(A.prev_pos=A.pos,J[0].length)}),ee(j,"$pos=",function(I){var A=this;return I<0&&(I+=A.string.$length()),A.pos=I,A.working=A.string.slice(I)}),ee(j,"$matched_size",function(){return this.matched===W?W:this.matched.length}),ee(j,"$post_match",function(){var I=this;return I.matched===W?W:I.string.substr(I.pos)}),ee(j,"$pre_match",function(){var I=this;return I.matched===W?W:I.string.substr(0,I.prev_pos)}),ee(j,"$reset",function(){var I=this;return I.working=I.string,I.matched=W,I.pos=0}),ee(j,"$rest",E("working")),ee(j,"$rest?",function(){return 0!==this.working.length}),ee(j,"$rest_size",function(){return this.$rest().$size()}),ee(j,"$terminate",function(){var I,A=this;return A.match=W,I=[A.string.$length()],Y(A,"pos=",I),I[I.length-1]}),ee(j,"$unscan",function(){var I=this;return I.pos=I.prev_pos,I.prev_pos=W,I.match=W,I}),G(j,"bol?","beginning_of_line?"),G(j,"getch","get_byte"),j.$private(),ee(j,"$anchor",function(I){var A=I.toString().match(/\/([^\/]+)$/);return A=A?A[1]:void 0,new RegExp("^(?:"+I.source+")",A)})},Opal.modules["bcdice/normalize"]=function(d){var G,Z,W,H=d.module,ee=d.eqeqeq,$=d.def,x=d.eqeq,O=[],E=d.nil;return G=O,W=[H(O[0],"BCDice")].concat(G),(Z=H(W[0],"Normalize")).$module_function(),$(Z,"$comparison_operator",function(j){var oe;return ee(/<=|=</,oe=j)?"<=":ee(/>=|=>/,oe)?">=":ee(/<>|!=|=!/,oe)?"!=":ee(/</,oe)?"<":ee(/>/,oe)?">":ee(/=/,oe)?"==":E}),$(Z,"$target_number",function(j){return x(j,"?")?j:j.$to_i()})},Opal.modules["bcdice/command/lexer"]=function(d){var T,q,L,S,M,v,P,I,oe,H=d.module,ee=d.klass,$=d.const_set,x=d.hash2,O=d.truthy,E=d.send,Y=d.def,G=d.thrower,D=d.top,W=[],B=d.nil;return D.$require("strscan"),D.$require("bcdice/normalize"),T=W,q=oe=[H(W[0],"BCDice")].concat(T),L=I=[H(oe[0],"Command")].concat(q),M=[S=ee(I[0],null,"Lexer")].concat(L),v=d.$r(M),(P=S.$$prototype).scanner=P.notations=B,$(M[0],"SYMBOLS",x(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),Y(S,"$initialize",function(te,k){var de,N,g;return te=O(g=(de=(N=te)===B||null==N?B:N.$split(" ",2))===B||null==de?B:de.$first())?g:"",this.scanner=v("StringScanner").$new(te),this.notations=E(k,"map",[],function(c){return null==c&&(c=B),O(c["$is_a?"](v("String")))?v("Regexp").$new(c):c})}),Y(S,"$next_token",function(){try{var te=G("return"),k=this,de=B,N=B,g=B,l=B;return O(k.scanner["$eos?"]())?[!1,"$"]:(E(k.notations,"each",[],function c(f){var p,u=null==c.$$s?this:c.$$s;if(null==u.scanner&&(u.scanner=B),null==f&&(f=B),p=u.scanner.$scan(f),!O(p))return B;te.$throw(["NOTATION",p])},{$$s:k,$$ret:te}),O(de=k.scanner.$scan(/\d+/))?["NUMBER",de.$to_i()]:O(N=k.scanner.$scan(/[<>!=]+/))?(N=v("Normalize").$comparison_operator(N),[O(N)?"CMP_OP":"ILLEGAL",N]):(g=k.scanner.$getch().$upcase(),[O(l=v("SYMBOLS")["$[]"](g))?l:g.$to_sym(),g]))}catch(c){if(c===te)return c.$v;throw c}}),Y(S,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/command/parsed"]=function(d){var D,T,K,I,A,J,L,oe,B,H=d.module,ee=d.klass,$=d.def,x=d.return_ivar,O=d.truthy,E=[],Y=d.nil;return D=E,T=B=[H(E[0],"BCDice")].concat(D),K=oe=[H(B[0],"Command")].concat(T),A=[I=ee(oe[0],null,"Parsed")].concat(K),J=d.$r(A),(L=I.$$prototype).critical=L.fumble=L.dollar=L.modify_number=L.question_target=L.target_number=L.prefix_number=L.command=L.suffix_number=L.cmp_op=Y,I.$attr_accessor("command"),I.$attr_accessor("prefix_number"),I.$attr_accessor("suffix_number"),I.$attr_accessor("critical"),I.$attr_accessor("fumble"),I.$attr_accessor("dollar"),I.$attr_accessor("modify_number"),I.$attr_accessor("cmp_op"),I.$attr_accessor("target_number"),I.$attr_writer("question_target"),$(I,"$initialize",function(){var M=this;return M.prefix_number=Y,M.suffix_number=Y,M.critical=Y,M.fumble=Y,M.dollar=Y,M.cmp_op=Y,M.target_number=Y,M.question_target=!1}),$(I,"$question_target?",x("question_target")),$(I,"$to_s",function(M){var v=this,P=Y,R=Y,te=Y,k=Y,de=Y;switch(null==M&&(M="after_command"),P=O(v.critical)?"@"+v.critical:Y,R=O(v.fumble)?"#"+v.fumble:Y,te=O(v.dollar)?"$"+v.dollar:Y,k=J("Format").$modifier(v.modify_number),de=O(v.question_target)?"?":v.target_number,M){case"after_command":return[v.prefix_number,v.command,v.suffix_number,P,R,te,k,v.cmp_op,de].$join();case"after_modify_number":return[v.prefix_number,v.command,v.suffix_number,k,P,R,te,v.cmp_op,de].$join();case"after_target_number":return[v.prefix_number,v.command,v.suffix_number,k,v.cmp_op,de,P,R,te].$join();default:return Y}},-1)},Opal.modules["bcdice/command/parser"]=function(d){var M,te,l,p,_,y,m,ne,se,Ee,ke,ce,be,c,f,u,ve,de,N,P,H=d.klass,ee=d.module,$=d.slice,x=d.extract_kwargs,O=d.ensure_kwargs,E=d.get_kwarg,Y=d.send2,G=d.find_super,D=d.def,W=d.send,B=d.eqeq,Z=d.thrower,T=d.hash,j=d.const_set,oe=d.truthy,z=d.to_ary,q=d.hash2,K=d.top,I=[],A=d.$r(I),J=d.nil,L=d.$$$;return K.$require("racc/parser.rb"),K.$require("bcdice/arithmetic/node"),K.$require("bcdice/command/lexer"),K.$require("bcdice/command/parsed"),H(L(A("BCDice"),"Command"),L(A("Racc"),"Parser"),"Parser"),M=I,te=P=[ee(I[0],"BCDice")].concat(M),de=[ee(P[0],"Command")].concat(te),N=d.$r(de),l=de,f=[c=H(de[0],L(N("Racc"),"Parser"),"Parser")].concat(l),u=d.$r(f),(ve=c.$$prototype).notations=ve.lexer=ve.modifier=ve.suffix_number=ve.prefix_number=ve.need_suffix_number=ve.need_prefix_number=ve.critical=ve.fumble=ve.dollar=ve.allowed_cmp_op=ve.question_target=J,D(c,"$initialize",function ae(ue,Ce){var b,V,ge,xe,Re=this;return ae.$$p=null,b=$(arguments),V=x(b),V=O(V),ge=b,xe=E(V,"round_type"),Y(Re,G(Re,"initialize",ae,!1,!0),"initialize",[],null),Re.notations=ge,Re.round_type=xe,Re.prefix_number=!1,Re.suffix_number=!1,Re.need_prefix_number=!1,Re.need_suffix_number=!1,Re.modifier=!0,Re.critical=!1,Re.fumble=!1,Re.dollar=!1,Re.allowed_cmp_op=[J,">=",">","<=","<","==","!="],Re.question_target=!1},-2),D(c,"$disable_modifier",function(){return this.modifier=!1,this}),D(c,"$enable_prefix_number",function(){return this.prefix_number=!0,this}),D(c,"$enable_suffix_number",function(){return this.suffix_number=!0,this}),D(c,"$has_prefix_number",function(){return this.prefix_number=!0,this.need_prefix_number=!0,this}),D(c,"$has_suffix_number",function(){return this.suffix_number=!0,this.need_suffix_number=!0,this}),D(c,"$enable_critical",function(){return this.critical=!0,this}),D(c,"$enable_fumble",function(){return this.fumble=!0,this}),D(c,"$enable_dollar",function(){return this.dollar=!0,this}),D(c,"$restrict_cmp_op_to",function(ue){var Ce,V=this;return Ce=$(arguments),V.allowed_cmp_op=Ce,V},-1),D(c,"$enable_question_target",function(){return this.question_target=!0,this}),D(c,"$parse",function(ue){try{return this.lexer=u("Lexer").$new(ue,this.notations),this.$do_parse()}catch(b){if(!d.rescue(b,[u("ParseError"),u("ZeroDivisionError")]))throw b;try{return J}finally{d.pop_exception()}}}),c.$private(),D(c,"$parsed",function(ue,Ce,b,V){try{return Z("eval_return"),W(u("Parsed").$new(),"tap",[],function De(Re){var Ue,Ze,mt,bt,Wt,jt,En,yn=null==De.$$s?this:De.$$s;return null==yn.round_type&&(yn.round_type=J),null==Re&&(Re=J),Re["$command="](ue["$[]"]("command")),Re["$prefix_number="]((Ue=ue["$[]"]("prefix"))===J||null==Ue?J:Ue.$eval(yn.round_type)),Re["$suffix_number="]((Ze=ue["$[]"]("suffix"))===J||null==Ze?J:Ze.$eval(yn.round_type)),Re["$critical="]((mt=Ce["$[]"]("critical"))===J||null==mt?J:mt.$eval(yn.round_type)),Re["$fumble="]((bt=Ce["$[]"]("fumble"))===J||null==bt?J:bt.$eval(yn.round_type)),Re["$dollar="]((Wt=Ce["$[]"]("dollar"))===J||null==Wt?J:Wt.$eval(yn.round_type)),Re["$modify_number="](b.$eval(yn.round_type)),Re["$cmp_op="](V["$[]"]("cmp_op")),B(V["$[]"]("target"),"?")?(Re["$question_target="](!0),W(Re,"target_number=",jt=[0]),jt[jt.length-1]):(Re["$question_target="](!1),jt=[(En=V["$[]"]("target"),En===J||null==En?J:En.$eval(yn.round_type))],W(Re,"target_number=",jt),jt[jt.length-1])},{$$s:this})}catch(De){if(De===d.t_eval_return)return De.$v;throw De}}),D(c,"$next_token",function(){return this.lexer.$next_token()}),p=d.large_array_unpack("6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,33,34,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,,,17,18,6,,5,,,17,18,,,5,23,24,25,26,56,54,55,57"),_=d.large_array_unpack("0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,,17,15,15,18,18,23,,18,30,30,23,23,24,,23,31,31,24,24,25,,24,44,44,25,25,28,,25,47,47,28,28,29,,28,48,48,29,29,33,,29,49,49,33,33,34,,33,50,50,34,34,36,,34,,,36,36,37,,36,,,37,37,,,37,27,27,27,27,52,52,52,52"),y=d.large_array_unpack("-2,4,16,-3,-1,11,,33,13,35,23,30,1,,28,40,,37,44,,,-2,,51,58,65,0,106,72,79,47,54,,86,93,,100,107,,,,,,,63,,,68,75,82,89,,120,,,,,"),m=d.large_array_unpack("-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29"),ne=d.large_array_unpack("30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,,,21,47,48,40,51,52,49,50,44,46,3,,,,13,,,,,,,,32"),se=d.large_array_unpack("8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,,,4,8,8,5,7,7,8,8,9,5,6,,,,6,,,,,,,,6"),Ee=[J,6,13,3,9,-1,27,-15,-10,-1,-38],ke=[J,J,J,J,J,J,19,16,15,J,J],ce=d.large_array_unpack("0,0,racc_error,4,20,_reduce_1,4,20,_reduce_2,3,20,_reduce_3,3,21,_reduce_4,2,21,_reduce_5,2,21,_reduce_6,1,21,_reduce_7,0,22,_reduce_8,3,22,_reduce_9,3,22,_reduce_10,3,22,_reduce_11,2,23,_reduce_12,2,23,_reduce_13,3,23,_reduce_14,3,23,_reduce_15,0,24,_reduce_16,2,24,_reduce_17,2,24,_reduce_18,3,28,_reduce_19,3,28,_reduce_20,1,28,_reduce_none,3,27,_reduce_22,4,27,_reduce_23,1,27,_reduce_none,0,29,_reduce_25,1,29,_reduce_26,1,29,_reduce_27,1,29,_reduce_28,1,29,_reduce_29,2,26,_reduce_30,2,26,_reduce_31,1,26,_reduce_none,3,25,_reduce_33,1,25,_reduce_34"),be=T(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),j(f[0],"Racc_arg",[p,_,m,y,ne,se,ke,Ee,19,ce,be,58,35,!0]),j(f[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),j(f[0],"Racc_debug_parser",!1),D(c,"$_reduce_1",function(ue,Ce,b){var V;return oe(this.modifier)||this.$raise(u("ParseError")),V=z(ue),this.$parsed(null==V[0]?J:V[0],null==V[1]?J:V[1],null==V[2]?J:V[2],null==V[3]?J:V[3])}),D(c,"$_reduce_2",function(ue,Ce,b){var V;return oe(this.modifier)||this.$raise(u("ParseError")),V=z(ue),this.$parsed(null==V[0]?J:V[0],null==V[2]?J:V[2],null==V[1]?J:V[1],null==V[3]?J:V[3])}),D(c,"$_reduce_3",function(ue,Ce,b){var V,Ue;return Ue=null==(V=z(ue))[2]?J:V[2],this.$parsed(null==V[0]?J:V[0],null==V[1]?J:V[1],L(L(u("Arithmetic"),"Node"),"Number").$new(0),Ue)}),D(c,"$_reduce_4",function(ue,Ce,b){var V=this;return oe(V.prefix_number)&&oe(V.suffix_number)||V.$raise(u("ParseError")),q(["command","prefix","suffix"],{command:ue["$[]"](1),prefix:ue["$[]"](0),suffix:ue["$[]"](2)})}),D(c,"$_reduce_5",function(ue,Ce,b){var V=this;return oe(V.prefix_number)||V.$raise(u("ParseError")),oe(V.need_suffix_number)&&V.$raise(u("ParseError")),q(["command","prefix"],{command:ue["$[]"](1),prefix:ue["$[]"](0)})}),D(c,"$_reduce_6",function(ue,Ce,b){var V=this;return oe(V.suffix_number)||V.$raise(u("ParseError")),oe(V.need_prefix_number)&&V.$raise(u("ParseError")),q(["command","suffix"],{command:ue["$[]"](0),suffix:ue["$[]"](1)})}),D(c,"$_reduce_7",function(ue,Ce,b){var V=this;return(oe(V.need_prefix_number)||oe(V.need_suffix_number))&&V.$raise(u("ParseError")),q(["command"],{command:ue["$[]"](0)})}),D(c,"$_reduce_8",function(ue,Ce,b){return q([],{})}),D(c,"$_reduce_9",function(ue,Ce,b){var V,Ue,De=J;return De=null==(V=z(ue))[0]?J:V[0],Ue=null==V[2]?J:V[2],oe(this.critical)&&oe(De["$[]"]("critical")["$nil?"]())||this.$raise(u("ParseError")),De["$[]="]("critical",Ue),De}),D(c,"$_reduce_10",function(ue,Ce,b){var V,Ue,De=J;return De=null==(V=z(ue))[0]?J:V[0],Ue=null==V[2]?J:V[2],oe(this.fumble)&&oe(De["$[]"]("fumble")["$nil?"]())||this.$raise(u("ParseError")),De["$[]="]("fumble",Ue),De}),D(c,"$_reduce_11",function(ue,Ce,b){var V,Ue,De=J;return De=null==(V=z(ue))[0]?J:V[0],Ue=null==V[2]?J:V[2],oe(this.dollar)&&oe(De["$[]"]("dollar")["$nil?"]())||this.$raise(u("ParseError")),De["$[]="]("dollar",Ue),De}),D(c,"$_reduce_12",function(ue,Ce,b){return ue["$[]"](1)}),D(c,"$_reduce_13",function(ue,Ce,b){return L(L(u("Arithmetic"),"Node"),"Negative").$new(ue["$[]"](1))}),D(c,"$_reduce_14",function(ue,Ce,b){return L(L(u("Arithmetic"),"Node"),"BinaryOp").$new(ue["$[]"](0),"+",ue["$[]"](2))}),D(c,"$_reduce_15",function(ue,Ce,b){return L(L(u("Arithmetic"),"Node"),"BinaryOp").$new(ue["$[]"](0),"-",ue["$[]"](2))}),D(c,"$_reduce_16",function(ue,Ce,b){return oe(this.allowed_cmp_op["$include?"](J))||this.$raise(u("ParseError")),q([],{})}),D(c,"$_reduce_17",function(ue,Ce,b){var V,De,Re;return Re=null==(V=z(ue))[1]?J:V[1],oe(this.allowed_cmp_op["$include?"](De=null==V[0]?J:V[0]))||this.$raise(u("ParseError")),q(["cmp_op","target"],{cmp_op:De,target:Re})}),D(c,"$_reduce_18",function(ue,Ce,b){var ge,V=this;return ge=ue["$[]"](0),oe(V.question_target)||V.$raise(u("ParseError")),oe(V.allowed_cmp_op["$include?"](ge))||V.$raise(u("ParseError")),q(["cmp_op","target"],{cmp_op:ge,target:"?"})}),D(c,"$_reduce_19",function(ue,Ce,b){return L(L(u("Arithmetic"),"Node"),"BinaryOp").$new(ue["$[]"](0),"+",ue["$[]"](2))}),D(c,"$_reduce_20",function(ue,Ce,b){return L(L(u("Arithmetic"),"Node"),"BinaryOp").$new(ue["$[]"](0),"-",ue["$[]"](2))}),D(c,"$_reduce_22",function(ue,Ce,b){return L(L(u("Arithmetic"),"Node"),"BinaryOp").$new(ue["$[]"](0),"*",ue["$[]"](2))}),D(c,"$_reduce_23",function(ue,Ce,b){return ue["$[]"](3).$new(ue["$[]"](0),ue["$[]"](2))}),D(c,"$_reduce_25",function(ue,Ce,b){return L(L(u("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),D(c,"$_reduce_26",function(ue,Ce,b){return L(L(u("Arithmetic"),"Node"),"DivideWithCeil")}),D(c,"$_reduce_27",function(ue,Ce,b){return L(L(u("Arithmetic"),"Node"),"DivideWithCeil")}),D(c,"$_reduce_28",function(ue,Ce,b){return L(L(u("Arithmetic"),"Node"),"DivideWithRound")}),D(c,"$_reduce_29",function(ue,Ce,b){return L(L(u("Arithmetic"),"Node"),"DivideWithFloor")}),D(c,"$_reduce_30",function(ue,Ce,b){return ue["$[]"](1)}),D(c,"$_reduce_31",function(ue,Ce,b){return L(L(u("Arithmetic"),"Node"),"Negative").$new(ue["$[]"](1))}),D(c,"$_reduce_33",function(ue,Ce,b){return ue["$[]"](1)}),D(c,"$_reduce_34",function(ue,Ce,b){return L(L(u("Arithmetic"),"Node"),"Number").$new(ue["$[]"](0))}),D(c,"$_reduce_none",function(ue,Ce,b){return ue["$[]"](0)})},Opal.modules["bcdice/deprecated/checker"]=function(d){var W,j,K,I,A,J,z,Z,H=d.module,ee=d.send,$=d.eqeqeq,x=d.truthy,O=d.def,E=d.return_val,Y=[],G=d.nil;return W=Y,j=Z=[H(Y[0],"BCDice")].concat(W),K=z=[H(Z[0],"Deprecated")].concat(j),A=[I=H(z[0],"Checker")].concat(K),J=d.$r(A),I.$private(),O(I,"$check_result_legacy",function(S,M,v,P){var de,R=this,te=G,k=G,N=G,F=G;return te=ee(M,"map",[],"sides".$to_proc()),de=(k=ee(M,"map",[],"value".$to_proc())).$sum(),N=$([100],F=te)?R.$check_1D100(S,de,v,P):$([20],F)?R.$check_1D20(S,de,v,P):$([6,6],F)?R.$check_2D6(S,de,k,v,P):G,(x(N["$nil?"]())||x(N["$empty?"]()))&&(N=$([10],F=te.$uniq())?R.$check_nD10(S,de,k,v,P):$([6],F)?R.$check_nD6(S,de,k,v,P):G,x(N["$nil?"]())||x(N["$empty?"]()))?G:J("Result").$new(N.$delete_prefix(" \uff1e "))}),O(I,"$check_1D100",E(G)),O(I,"$check_1D20",E(G)),O(I,"$check_nD10",E(G)),O(I,"$check_2D6",E(G)),O(I,"$check_nD6",E(G))},Opal.queue(function(d){var A,R,F,u,_,y,g,l,c,f,k,H=d.module,ee=d.klass,$=d.slice,x=d.rb_plus,O=d.truthy,E=d.def,Y=d.regexp,G=d.send,D=d.thrower,W=d.return_ivar,B=d.assign_ivar_val,Z=d.eqeqeq,T=d.eqeq,j=d.return_val,oe=d.range,z=d.rb_minus,q=d.rb_divide,K=d.rb_times,I=d.rb_ge,J=d.top,L=[],S=d.$r(L),M=d.nil,v=d.$$$;return J.$require("i18n"),J.$require("i18n/backend/fallbacks"),J.$require("bcdice/randomizer"),J.$require("bcdice/dice_table"),J.$require("bcdice/enum"),J.$require("bcdice/translate"),J.$require("bcdice/result"),J.$require("bcdice/command/parser"),J.$require("bcdice/deprecated/checker"),R=L,F=k=[H(L[0],"BCDice")].concat(R),l=[g=ee(k[0],null,"Base")].concat(F),c=d.$r(l),(f=g.$$prototype).raw_input=f.randomizer=f.enabled_upcase_input=f.debug=M,_=[u=d.get_singleton_class(g)].concat(l),y=d.$r(_),u.$attr_reader("prefixes"),E(u,"$register_prefix",function(ne){var Ee,ke=this,ce=M;return null==ke.prefixes&&(ke.prefixes=M),Ee=$(arguments),ke.prefixes=x(O(ce=ke.prefixes)?ce:[],Ee.$flatten())},-1),E(u,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())}),E(u,"$prefixes_pattern",function(){var ne=this,se=M;return null==ne.prefixes_pattern&&(ne.prefixes_pattern=M),null==ne.prefixes&&(ne.prefixes=M),ne.prefixes_pattern=O(se=ne.prefixes_pattern)?se:M,O(ne.prefixes_pattern)?ne.prefixes_pattern:(ne.prefixes=O(se=ne.prefixes)?se:[],ne.prefixes.$freeze(),ne.prefixes_pattern=(O(ne.prefixes["$empty?"]())?/(?!)/:Y(["^(S)?(",ne.prefixes.$join("|"),")"],"i")).$freeze())}),E(u,"$command_pattern",function(){var ne=this,se=M,Ee=M;return null==ne.command_pattern&&(ne.command_pattern=M),null==ne.prefixes&&(ne.prefixes=M),ne.command_pattern=O(se=ne.command_pattern)?se:M,O(ne.command_pattern)?ne.command_pattern:(ne.prefixes=O(se=ne.prefixes)?se:[],ne.prefixes.$freeze(),Ee=x(G(v(y("CommonCommand"),"COMMANDS"),"map",[],function(ce){return null==ce&&(ce=M),v(ce,"PREFIX_PATTERN").$source()}),ne.prefixes),ne.command_pattern=Y(["^S?(",Ee.$join("|"),")"],"i").$freeze())}),E(u,"$eval",function(ne){try{return D("eval_return"),this.$new(ne).$eval()}catch(ke){if(ke===d.t_eval_return)return ke.$v;throw ke}}),g.$include(c("Translate")),g.$include(v(c("Deprecated"),"Checker")),E(g,"$initialize",function(p){var _=this;return _.raw_input=p,_.sort_add_dice=!1,_.sort_barabara_dice=!1,_.d66_sort_type=v(c("D66SortType"),"NO_SORT"),_.enabled_d9=!1,_.round_type=v(c("RoundType"),"FLOOR"),_.sides_implicit_d=6,_.upper_dice_reroll_threshold=M,_.reroll_dice_reroll_threshold=M,_.default_cmp_op=M,_.default_target_number=M,_.enabled_upcase_input=!0,_.locale="ja_jp",_.randomizer=v(c("BCDice"),"Randomizer").$new(),_.debug=!1}),g.$attr_accessor("randomizer"),g.$attr_reader("d66_sort_type"),g.$attr_reader("round_type"),g.$attr_reader("sides_implicit_d"),g.$attr_reader("upper_dice_reroll_threshold"),g.$attr_reader("reroll_dice_reroll_threshold"),g.$attr_reader("default_cmp_op"),g.$attr_reader("default_target_number"),E(g,"$sort_add_dice?",W("sort_add_dice")),E(g,"$sort_barabara_dice?",W("sort_barabara_dice")),E(g,"$enabled_d9?",W("enabled_d9")),E(g,"$enable_debug",B("debug",!0)),E(g,"$eval",function(){var _,m,p=this,y=M;return _=v(c("BCDice"),"Preprocessor").$process(p.raw_input,p),y=O(m=p.$dice_command(_))?m:p.$eval_common_command(p.raw_input),O(y)?(y["$rands="](p.randomizer.$rand_results()),y["$detailed_rands="](p.randomizer.$detailed_rand_results()),y):M}),E(g,"$change_text",function(p){return p}),E(g,"$check_result",function(p,_,y,m){var ne=this,se=M,Ee=M,ke=M,ce=M,Me=M;return se=ne.$check_result_legacy(p,_,y,m),O(se)?se:(Ee=G(_,"map",[],"sides".$to_proc()),ce=(ke=G(_,"map",[],"value".$to_proc())).$sum(),se=Z([100],Me=Ee)?ne.$result_1d100(p,ce,y,m):Z([20],Me)?ne.$result_1d20(p,ce,y,m):Z([6,6],Me)?ne.$result_2d6(p,ce,ke,y,m):M,T(se,c("Result").$nothing())?M:O(se)?se:(se=Z([10],Me=Ee.$uniq())?ne.$result_nd10(p,ce,ke,y,m):Z([6],Me)?ne.$result_nd6(p,ce,ke,y,m):M,T(se,c("Result").$nothing())?M:O(se)?se:ne.$result_ndx(p,y,m)))}),E(g,"$grich_text",j(M)),g.$private(),E(g,"$eval_common_command",function(p){try{D("eval_return");var y=D("return");return p=this.$change_text(p),G(v(c("CommonCommand"),"COMMANDS"),"each",[],function ne(se){var ke,Ee=null==ne.$$s?this:ne.$$s;if(null==Ee.randomizer&&(Ee.randomizer=M),null==se&&(se=M),ke=se.$eval(p,Ee,Ee.randomizer),!O(ke))return M;y.$throw(ke)},{$$s:this,$$ret:y}),M}catch(ne){if(ne===d.t_eval_return||ne===y)return ne.$v;throw ne}}),E(g,"$dice_command",function(p){var _=this,y=M,m=M,ne=M,se=M;return O(_.enabled_upcase_input)&&(p=p.$upcase()),y=_.$class().$prefixes_pattern().$match(p),O(y)?(m=y["$[]"](1)["$nil?"]()["$!"](),O(m)&&(p=p["$[]"](oe(1,-1,!1))),ne=_.$eval_game_system_specific_command(p),O(ne["$is_a?"](c("Result")))?(ne["$secret="](O(se=ne["$secret?"]())?se:m),ne):O(ne["$nil?"]())||O(ne["$empty?"]())||T(ne,"1")?M:G(c("Result").$new(),"tap",[],function(ke){var ce;return null==ke&&(ke=M),ke["$text="](ne.$to_s()),G(ke,"secret=",ce=[m]),ce[ce.length-1]})):M}),E(g,"$eval_game_system_specific_command",j(M)),E(g,"$result_ndx",function(p,_,y){return O(y["$is_a?"](c("String")))?M:O(p.$send(_,y))?c("Result").$success(this.$translate("success")):c("Result").$failure(this.$translate("failure"))}),E(g,"$result_1d100",j(M)),E(g,"$result_1d20",j(M)),E(g,"$result_nd10",j(M)),E(g,"$result_2d6",j(M)),E(g,"$result_nd6",j(M)),E(g,"$get_table_by_2d6",function(p){return this.$get_table_by_nD6(p,2)}),E(g,"$get_table_by_1d6",function(p){return this.$get_table_by_nD6(p,1)}),E(g,"$get_table_by_nD6",function(p,_){return this.$get_table_by_nDx(p,_,6)}),E(g,"$get_table_by_nDx",function(p,_,y){var ne,se=M;return ne=this.randomizer.$roll_sum(_,y),se=this.$get_table_value(p["$[]"](z(ne,_))),O(se["$nil?"]())?["1",0]:[se,ne]}),E(g,"$get_table_by_1d3",function(p){var m,ne,_=this,se=M;return _.$debug("get_table_by_1d3"),m=_.randomizer.$roll_sum(1,6),_.$debug("num",m),ne=q(z(m,1),2).$to_i(),_.$debug("index",ne),se=p["$[]"](ne),O(se["$nil?"]())?["1",0]:[se,m]}),E(g,"$get_table_by_d66_swap",function(p){var y;return y=this.randomizer.$roll_d66(v(c("D66SortType"),"ASC")),[this.$get_table_by_number(y,p),y]}),E(g,"$get_table_by_d66",function(p){var y,m,ne,Ee,se=M;return y=this.randomizer.$roll_once(6),m=this.randomizer.$roll_once(6),ne=x(K(z(y,1),6),z(m,1)),se=p["$[]"](ne),Ee=""+y+m,O(se["$nil?"]())?["1",Ee]:[se,Ee]}),E(g,"$get_table_by_number",function(p,_,y){try{var m=D("return");return null==y&&(y="1"),G(_,"each",[],function se(Ee){var ce,ke=null==se.$$s?this:se.$$s;if(null==Ee&&(Ee=M),ce=Ee["$[]"](0),!O(I(ce,p)))return M;m.$throw(ke.$get_table_value(Ee["$[]"](1)))},{$$s:this,$$ret:m}),this.$get_table_value(y)}catch(se){if(se===m)return se.$v;throw se}},-3),E(g,"$get_table_value",function(p){return O(p["$is_a?"](c("Proc")))?p.$call():p}),E(g,"$roll_tables",function(p,_){var m=M;return m=_["$[]"](p),O(m)?m.$roll(this.randomizer).$to_s():M}),E(g,"$debug",function(p,_){var m,ne=this,se=M,Ee=M;return m=$(arguments,1),O(ne.debug)?(se=O(p["$is_a?"](c("String")))?p:p.$inspect(),O(m["$empty?"]())?ne.$warn(se):(Ee=G(m,"map",[],function(ce){return null==ce&&(ce=M),O(ce["$is_a?"](c("String")))?'"'+ce+'"':ce.$inspect()}),ne.$warn(se+": "+Ee.$join(", ")))):M},-2),v(v(S("I18n"),"Backend"),"Simple").$include(v(v(S("I18n"),"Backend"),"Fallbacks")),S("I18n").$load_path()["$<<"](S("Dir")["$[]"](S("File").$join("bcdice","../../i18n/**/*.yml"))),S("I18n")["$default_locale="]("ja_jp"),A=[["ja_jp"]],G(S("I18n").$fallbacks(),"defaults=",A),A[A.length-1]})},4748:(C,le,me)=>{me(9993),Opal.modules["bcdice/normalize"]=function(d){var G,Z,W,H=d.module,ee=d.eqeqeq,$=d.def,x=d.eqeq,O=[],E=d.nil;return G=O,W=[H(O[0],"BCDice")].concat(G),(Z=H(W[0],"Normalize")).$module_function(),$(Z,"$comparison_operator",function(j){var oe;return ee(/<=|=</,oe=j)?"<=":ee(/>=|=>/,oe)?">=":ee(/<>|!=|=!/,oe)?"!=":ee(/</,oe)?"<":ee(/>/,oe)?">":ee(/=/,oe)?"==":E}),$(Z,"$target_number",function(j){return x(j,"?")?j:j.$to_i()})},Opal.modules["racc/parser"]=function(d){var P,te,k,H=d.module,ee=d.klass,$=d.truthy,x=d.const_set,O=d.defs,E=d.gvars,Y=d.rb_lt,G=d.def,D=d.to_ary,W=d.send,B=d.neqeq,Z=d.rb_plus,T=d.eqeq,j=d.rb_ge,oe=d.rb_gt,z=d.rb_minus,q=d.rb_le,K=d.rb_times,I=d.assign_ivar_val,J=[],L=d.$r(J),S=d.nil,M=d.$$$;return P=J,te=[H(J[0],"Racc")].concat(P),k=d.$r(te),ee(te[0],k("StandardError"),"ParseError"),$(M("::","ParseError","skip_raise")?"constant":S)||x(J[0],"ParseError",M(L("Racc"),"ParseError")),function(v,P){var g,l,c,f,u,k=[H(v,"Racc")].concat(P),de=d.$r(k);return $(de("Racc_No_Extensions","skip_raise")?"constant":S)||x(k[0],"Racc_No_Extensions",!1),g=k,c=[l=ee(k[0],null,"Parser")].concat(g),f=d.$r(c),(u=l.$$prototype).yydebug=u.racc_debug_out=u.racc_error_status=u.racc_t=u.racc_vstack=u.racc_val=u.racc_state=u.racc_tstack=S,x(c[0],"Racc_Runtime_Version","1.4.6"),x(c[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),x(c[0],"Racc_Runtime_Core_Version_R","1.4.6"),x(c[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),x(c[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),x(c[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),x(c[0],"Racc_Runtime_Core_Version",f("Racc_Runtime_Core_Version_R")),x(c[0],"Racc_Runtime_Core_Revision",f("Racc_Runtime_Core_Revision_R")),x(c[0],"Racc_Runtime_Type","ruby"),O(f("Parser"),"$racc_runtime_type",function(){return f("Racc_Runtime_Type")}),G(l,"$_racc_setup",function(){var _,y,m=this,ne=S,se=S;return null==E.stderr&&(E.stderr=S),$(M(m.$class(),"Racc_debug_parser"))||(m.yydebug=!1),$(null!=(_=m.yydebug)&&_!==S?"instance-variable":S)||(m.yydebug=!1),$(m.yydebug)&&($(null!=(y=m.racc_debug_out)&&y!==S?"instance-variable":S)||(m.racc_debug_out=E.stderr),m.racc_debug_out=$(ne=m.racc_debug_out)?ne:E.stderr),se=M(m.$class(),"Racc_arg"),$(Y(se.$size(),14))&&se["$[]="](13,!0),se}),G(l,"$_racc_init_sysvars",function(){var _=this;return _.racc_state=[0],_.racc_tstack=[],_.racc_vstack=[],_.racc_t=S,_.racc_val=S,_.racc_read_next=!0,_.racc_user_yyerror=!1,_.racc_error_status=0}),G(l,"$do_parse",function(){return this.$__send__(f("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),G(l,"$next_token",function(){return this.$raise(f("NotImplementedError"),this.$class()+"#next_token is not defined")}),G(l,"$_racc_do_parse_rb",function(_,y){var m,Ee=S,ke=S,ce=S,Me=S,be=S,he=S,Se=S,ve=S;return m=D(_),Ee=null==m[0]?S:m[0],ke=null==m[1]?S:m[1],ce=null==m[2]?S:m[2],Me=null==m[3]?S:m[3],be=null==m[10]?S:m[10],this.$_racc_init_sysvars(),he=Se=ve=S,W(this,"catch",["racc_end_parse"],function ae(){var ue,Ce,b=null==ae.$$s?this:ae.$$s,V=S;for(null==b.racc_state&&(b.racc_state=S),null==b.racc_read_next&&(b.racc_read_next=S),null==b.racc_t&&(b.racc_t=S),null==b.yydebug&&(b.yydebug=S),null==b.racc_val&&(b.racc_val=S);$(!0);)for($(ve=Me["$[]"](b.racc_state["$[]"](-1)))?($(b.racc_read_next)&&B(b.racc_t,0)&&(Ce=b.$next_token(),ue=D(Ce),he=null==ue[0]?S:ue[0],b.racc_val=null==ue[1]?S:ue[1],b.racc_t=$(he)?$(V=be["$[]"](he))?V:1:0,$(b.yydebug)&&b.$racc_read_token(b.racc_t,he,b.racc_val),b.racc_read_next=!1),ve=Z(ve,b.racc_t),$(j(ve,0))&&$(Se=Ee["$[]"](ve))&&T(ke["$[]"](ve),b.racc_state["$[]"](-1))||(Se=ce["$[]"](b.racc_state["$[]"](-1)))):Se=ce["$[]"](b.racc_state["$[]"](-1));$(Se=b.$_racc_evalact(Se,_)););},{$$s:this})}),G(l,"$yyparse",function(_,y){return this.$__send__(f("Racc_YY_Parse_Method"),_,y,this.$_racc_setup(),!0)}),G(l,"$_racc_yyparse_rb",function(_,y,m,ne){var se,ce=S,Me=S,$e=S,be=S,Se=S,ve=S,ae=S;return se=D(m),ce=null==se[0]?S:se[0],Me=null==se[1]?S:se[1],$e=null==se[2]?S:se[2],be=null==se[3]?S:se[3],Se=null==se[10]?S:se[10],this.$_racc_init_sysvars(),ve=S,ae=S,W(this,"catch",["racc_end_parse"],function ue(){var Ce=null==ue.$$s?this:ue.$$s;for(null==Ce.racc_state&&(Ce.racc_state=S);!$(ae=be["$[]"](Ce.racc_state["$[]"](-1)));)for(;$(ve=Ce.$_racc_evalact($e["$[]"](Ce.racc_state["$[]"](-1)),m)););return W(_,"__send__",[y],function b(V,ge){var xe=null==b.$$s?this:b.$$s,De=S,Re=S;for(null==xe.racc_t&&(xe.racc_t=S),null==xe.racc_state&&(xe.racc_state=S),null==xe.racc_read_next&&(xe.racc_read_next=S),null==V&&(V=S),null==ge&&(ge=S),xe.racc_t=$(V)?$(De=Se["$[]"](V))?De:1:0,xe.racc_val=ge,xe.racc_read_next=!1,ae=Z(ae,xe.racc_t),$(j(ae,0))&&$(ve=ce["$[]"](ae))&&T(Me["$[]"](ae),xe.racc_state["$[]"](-1))||(ve=$e["$[]"](xe.racc_state["$[]"](-1)));$(ve=xe.$_racc_evalact(ve,m)););for(;$($(De=$(Re=(ae=be["$[]"](xe.racc_state["$[]"](-1)))["$!"]())?Re:xe.racc_read_next["$!"]())?De:xe.racc_t["$=="](0));)for($(ae)&&$(ae=Z(ae,xe.racc_t))&&$(j(ae,0))&&$(ve=ce["$[]"](ae))&&T(Me["$[]"](ae),xe.racc_state["$[]"](-1))||(ve=$e["$[]"](xe.racc_state["$[]"](-1)));$(ve=xe.$_racc_evalact(ve,m)););},{$$s:Ce})},{$$s:this})}),G(l,"$_racc_evalact",function(_,y){var m,$e,se=this,Ee=S,ke=S,Me=S,be=S,he=S,Se=S;if(Ee=null==(m=D(y))[0]?S:m[0],ke=null==m[1]?S:m[1],Me=null==m[3]?S:m[3],$e=null==m[11]?S:m[11],be=null==m[12]?S:m[12],$(oe(_,0))&&$(Y(_,$e)))$(oe(se.racc_error_status,0))&&(T(se.racc_t,1)||(se.racc_error_status=z(se.racc_error_status,1))),se.racc_vstack.$push(se.racc_val),se.racc_state.$push(_),se.racc_read_next=!0,$(se.yydebug)&&(se.racc_tstack.$push(se.racc_t),se.$racc_shift(se.racc_t,se.racc_tstack,se.racc_vstack));else if($(Y(_,0))&&$(oe(_,be["$-@"]()))){if(he=W(se,"catch",["racc_jump"],function ve(){var ae=null==ve.$$s?this:ve.$$s;return null==ae.racc_state&&(ae.racc_state=S),ae.racc_state.$push(ae.$_racc_do_reduce(y,_)),!1},{$$s:se}),$(he))switch(he){case 1:return se.racc_user_yyerror=!0,be["$-@"]();case 2:return $e;default:se.$raise("[Racc Bug] unknown jump code")}}else if(T(_,$e))$(se.yydebug)&&se.$racc_accept(),se.$throw("racc_end_parse",se.racc_vstack["$[]"](0));else{if(T(_,be["$-@"]())){switch(se.racc_error_status){case 0:$(y["$[]"](21))||se.$on_error(se.racc_t,se.racc_val,se.racc_vstack);break;case 3:T(se.racc_t,0)&&se.$throw("racc_end_parse",S),se.racc_read_next=!0}for(se.racc_user_yyerror=!1,se.racc_error_status=3;$(!0)&&!($(Se=Me["$[]"](se.racc_state["$[]"](-1)))&&(Se=Z(Se,1),$(j(Se,0))&&$(_=Ee["$[]"](Se))&&T(ke["$[]"](Se),se.racc_state["$[]"](-1))));)$(q(se.racc_state.$size(),1))&&se.$throw("racc_end_parse",S),se.racc_state.$pop(),se.racc_vstack.$pop(),$(se.yydebug)&&(se.racc_tstack.$pop(),se.$racc_e_pop(se.racc_state,se.racc_tstack,se.racc_vstack));return _}se.$raise("[Racc Bug] unknown action "+_.$inspect())}return $(se.yydebug)&&se.$racc_next_state(se.racc_state["$[]"](-1),se.racc_state),S}),G(l,"$_racc_do_reduce",function(_,y){var m,be,Se,V,ge,xe,Ue,se=this,ke=S,ce=S,Me=S,$e=S,he=S,ve=S,ae=S,ue=S,Ce=S,b=S,De=S,Re=S,Ze=S;return ke=null==(m=D(_))[4]?S:m[4],ce=null==m[5]?S:m[5],Me=null==m[6]?S:m[6],$e=null==m[7]?S:m[7],be=null==m[8]?S:m[8],he=null==m[9]?S:m[9],Se=null==m[13]?S:m[13],ve=se.racc_state,ae=se.racc_vstack,ue=se.racc_tstack,Ce=K(y,-3),b=he["$[]"](Ce),V=he["$[]"](Z(Ce,1)),ge=he["$[]"](Z(Ce,2)),xe=[],$(se.yydebug)&&(De=ue["$[]"](b["$-@"](),b)),Re=ae["$[]"](b["$-@"](),b),$(se.yydebug)&&ue["$[]="](b["$-@"](),b,xe),ae["$[]="](b["$-@"](),b,xe),ve["$[]="](b["$-@"](),b,xe),$(Se)?ae.$push(se.$__send__(ge,Re,ae,Re["$[]"](0))):ae.$push(se.$__send__(ge,Re,ae)),ue.$push(V),$(se.yydebug)&&se.$racc_reduce(De,V,ue,ae),Ue=z(V,be),$(Ce=$e["$[]"](Ue))&&(Ce=Z(Ce,ve["$[]"](-1)),$(j(Ce,0))&&$(Ze=ke["$[]"](Ce))&&T(ce["$[]"](Ce),Ue))?Ze:Me["$[]"](Ue)}),G(l,"$on_error",function(_,y,m){var se;return this.$raise(f("ParseError"),this.$sprintf("\nparse error on value %s (%s)",y.$inspect(),$(se=this.$token_to_str(_))?se:"?"))}),G(l,"$yyerror",function(){return this.$throw("racc_jump",1)}),G(l,"$yyaccept",function(){return this.$throw("racc_jump",2)}),G(l,"$yyerrok",I("racc_error_status",0)),G(l,"$racc_read_token",function(_,y,m){var ne=this;return ne.racc_debug_out.$print("read    "),ne.racc_debug_out.$print(y.$inspect(),"(",ne.$racc_token2str(_),") "),ne.racc_debug_out.$puts(m.$inspect()),ne.racc_debug_out.$puts()}),G(l,"$racc_shift",function(_,y,m){return this.racc_debug_out.$puts("shift   "+this.$racc_token2str(_)),this.$racc_print_stacks(y,m),this.racc_debug_out.$puts()}),G(l,"$racc_reduce",function(_,y,m,ne){var se=this,Ee=S;return(Ee=se.racc_debug_out).$print("reduce "),$(_["$empty?"]())?Ee.$print(" <none>"):W(_,"each",[],function ke(ce){return null==ce&&(ce=S),Ee.$print(" ",(null==ke.$$s?this:ke.$$s).$racc_token2str(ce))},{$$s:se}),Ee.$puts(" --\x3e "+se.$racc_token2str(y)),se.$racc_print_stacks(m,ne),se.racc_debug_out.$puts()}),G(l,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),G(l,"$racc_e_pop",function(_,y,m){return this.racc_debug_out.$puts("error recovering mode: pop token"),this.$racc_print_states(_),this.$racc_print_stacks(y,m),this.racc_debug_out.$puts()}),G(l,"$racc_next_state",function(_,y){var m=this;return m.racc_debug_out.$puts("goto    "+_),m.$racc_print_states(y),m.racc_debug_out.$puts()}),G(l,"$racc_print_stacks",function(_,y){var ne=S;return(ne=this.racc_debug_out).$print("        ["),W(_,"each_index",[],function se(Ee){return null==Ee&&(Ee=S),ne.$print(" (",(null==se.$$s?this:se.$$s).$racc_token2str(_["$[]"](Ee))," ",y["$[]"](Ee).$inspect(),")")},{$$s:this}),ne.$puts(" ]")}),G(l,"$racc_print_states",function(_){var m=S;return(m=this.racc_debug_out).$print("        ["),W(_,"each",[],function(se){return null==se&&(se=S),m.$print(" ",se)}),m.$puts(" ]")}),G(l,"$racc_token2str",function(_){var m;return $(m=M(this.$class(),"Racc_token_to_s_table")["$[]"](_))?m:this.$raise("[Racc Bug] can't convert token "+_+" to string")}),G(l,"$token_to_str",function(_){return M(this.$class(),"Racc_token_to_s_table")["$[]"](_)})}(J[0],J)},Opal.modules.strscan=function(d){var T,j,oe,z,q,ee=d.def,$=d.truthy,x=d.eqeqeq,O=d.Opal,E=d.return_ivar,Y=d.send,G=d.alias,D=[],W=d.nil;return T=D,oe=[j=(0,d.klass)(D[0],null,"StringScanner")].concat(T),z=d.$r(oe),(q=j.$$prototype).pos=q.string=q.working=q.matched=q.prev_pos=q.match=W,j.$attr_reader("pos","matched"),ee(j,"$initialize",function(I){var A=this;return A.string=I,A.pos=0,A.matched=W,A.working=I,A.match=[]}),j.$attr_reader("string"),ee(j,"$beginning_of_line?",function(){var I=this;return 0===I.pos||"\n"===I.string.charAt(I.pos-1)}),ee(j,"$scan",function(I){var A=this,J=(I=A.$anchor(I)).exec(A.working);return null==J?A.matched=W:(A.prev_pos=A.pos,A.pos+=J[0].length,A.working=A.working.substring(J[0].length),A.matched=J[0],A.match=J,J[0])}),ee(j,"$scan_until",function(I){var A=this;I=A.$anchor(I);for(var J=A.working,L=0;J.length!=L;++L){var S=I.exec(J.substr(L));if(null!==S){var M=L+S[0].length,v=J.substr(0,M);return A.matched=S[0],A.match=S,A.prev_pos=A.pos+L,A.pos+=M,A.working=J.substr(M),v}}return A.matched=W}),ee(j,"$[]",function(I){var J;if($(this.match["$empty?"]()))return W;x(z("Symbol"),J=I)?I=I.$to_s():x(z("String"),J)||(I=O["$coerce_to!"](I,z("Integer"),"to_int"));var L=this.match;return I<0&&(I+=L.length),I<0||I>=L.length||null==L[I]?W:L[I]}),ee(j,"$check",function(I){var A=this,J=(I=A.$anchor(I)).exec(A.working);return A.matched=null==J?W:J[0]}),ee(j,"$check_until",function(I){var A=this,J=A.prev_pos,L=A.pos,S=A.working,M=A.$scan_until(I);return A.prev_pos=J,A.pos=L,A.working=S,M}),ee(j,"$peek",function(I){return this.working.substring(0,I)}),ee(j,"$eos?",function(){return 0===this.working.length}),ee(j,"$exist?",function(I){var J=I.exec(this.working);return null==J?W:0==J.index?0:J.index+1}),ee(j,"$skip",function(I){var A=this,J=(I=A.$anchor(I)).exec(A.working);if(null==J)return A.match=[],A.matched=W;var L=J[0],S=L.length;return A.matched=L,A.match=J,A.prev_pos=A.pos,A.pos+=S,A.working=A.working.substring(S),S}),ee(j,"$skip_until",function(I){var J=this.$scan_until(I);return J===W?W:(this.matched=J.substr(-1),J.length)}),ee(j,"$get_byte",function(){var I=this,A=W;return I.pos<I.string.length?(I.prev_pos=I.pos,I.pos+=1,A=I.matched=I.working.substring(0,1),I.working=I.working.substring(1)):I.matched=W,A}),ee(j,"$match?",function(I){var A=this,J=(I=A.$anchor(I)).exec(A.working);return null==J?W:(A.prev_pos=A.pos,J[0].length)}),ee(j,"$pos=",function(I){var A=this;return I<0&&(I+=A.string.$length()),A.pos=I,A.working=A.string.slice(I)}),ee(j,"$matched_size",function(){return this.matched===W?W:this.matched.length}),ee(j,"$post_match",function(){var I=this;return I.matched===W?W:I.string.substr(I.pos)}),ee(j,"$pre_match",function(){var I=this;return I.matched===W?W:I.string.substr(0,I.prev_pos)}),ee(j,"$reset",function(){var I=this;return I.working=I.string,I.matched=W,I.pos=0}),ee(j,"$rest",E("working")),ee(j,"$rest?",function(){return 0!==this.working.length}),ee(j,"$rest_size",function(){return this.$rest().$size()}),ee(j,"$terminate",function(){var I,A=this;return A.match=W,I=[A.string.$length()],Y(A,"pos=",I),I[I.length-1]}),ee(j,"$unscan",function(){var I=this;return I.pos=I.prev_pos,I.prev_pos=W,I.match=W,I}),G(j,"bol?","beginning_of_line?"),G(j,"getch","get_byte"),j.$private(),ee(j,"$anchor",function(I){var A=I.toString().match(/\/([^\/]+)$/);return A=A?A[1]:void 0,new RegExp("^(?:"+I.source+")",A)})},Opal.modules["bcdice/common_command/lexer"]=function(d){var B,oe,A,J,L,S,q,T,H=d.module,ee=d.klass,$=d.const_set,x=d.hash2,O=d.truthy,E=d.def,Y=d.top,G=[],D=d.nil;return Y.$require("strscan"),Y.$require("bcdice/normalize"),B=G,oe=T=[H(G[0],"BCDice")].concat(B),A=q=[H(T[0],"CommonCommand")].concat(oe),L=[J=ee(q[0],null,"Lexer")].concat(A),S=d.$r(L),J.$$prototype.scanner=D,$(L[0],"SYMBOLS",x(["+","-","*","/","(",")","[","]","?","@"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","?":"QUESTION","@":"AT"}).$freeze()),E(J,"$initialize",function(P){var te;return P=O(te=P.$split(" ",2).$first())?te:"",this.scanner=S("StringScanner").$new(P)}),E(J,"$next_token",function(){var P=this,R=D,te=D,k=D,N=D;return O(P.scanner["$eos?"]())?[!1,"$"]:O(R=P.scanner.$scan(/\d+/))?["NUMBER",R.$to_i()]:O(te=P.scanner.$scan(/[<>!=]+/))?["CMP_OP",S("Normalize").$comparison_operator(te)]:(k=P.scanner.$getch().$upcase(),[O(N=S("SYMBOLS")["$[]"](k))?N:k.$to_sym(),k])}),E(J,"$source",function(){return this.scanner.$string()})},Opal.modules.singleton=function(d){var B,z,q,K,I,Z,T,j,H=d.module,ee=d.def,$=d.send2,x=d.find_super,O=d.send,E=d.truthy,Y=d.defs,G=[],D=d.nil;return B=G,T=[Z=H(G[0],"Singleton")].concat(B),j=d.$r(T),ee(Z,"$clone",function(){return this.$raise(j("TypeError"),"can't clone instance of singleton "+this.$class())}),ee(Z,"$dup",function(){return this.$raise(j("TypeError"),"can't dup instance of singleton "+this.$class())}),z=T,K=[q=H(T[0],"SingletonClassMethods")].concat(z),I=d.$r(K),ee(q,"$clone",function A(){var J=A.$$p||D;return A.$$p=null,I("Singleton").$__init__($(this,x(this,"clone",A,!1,!0),"clone",[],J))}),ee(q,"$inherited",function A(J){var L=A.$$p||D;return A.$$p=null,$(this,x(this,"inherited",A,!1,!0),"inherited",[J],L),I("Singleton").$__init__(J)}),function(oe,z){var q=[oe].concat(z),K=d.$r(q);return ee(oe,"$__init__",function(A){return O(A,"instance_eval",[],function L(){return(null==L.$$s?this:L.$$s).singleton__instance__=D},{$$s:this}),Y(A,"$instance",function(){var S=this;return null==S.singleton__instance__&&(S.singleton__instance__=D),E(S.singleton__instance__)?S.singleton__instance__:S.singleton__instance__=S.$new()}),A}),ee(oe,"$included",function I(A){var J=I.$$p||D;return I.$$p=null,$(this,x(this,"included",I,!1,!0),"included",[A],J),A.$extend(K("SingletonClassMethods")),K("Singleton").$__init__(A)})}(d.get_singleton_class(j("Singleton")),T)},Opal.modules["bcdice/common_command/add_dice/node"]=function(d){var v,k,g,u,se,Ee,ke,ce,Me,_,y,c,N,R,H=d.module,ee=d.klass,$=d.def,x=d.rb_plus,O=d.thrower,E=d.truthy,Y=d.rb_le,G=d.send,D=d.return_val,W=d.alias,B=d.return_ivar,Z=d.send2,T=d.find_super,j=d.const_set,oe=d.eqeqeq,z=d.rb_divide,q=d.assign_ivar,K=d.not,I=d.neqeq,J=[],L=d.nil,S=d.$$$;return d.top.$require("singleton"),v=J,k=R=[H(J[0],"BCDice")].concat(v),g=N=[H(R[0],"CommonCommand")].concat(k),u=c=[H(N[0],"AddDice")].concat(g),_=[H(c[0],"Node")].concat(u),y=d.$r(_),se=_,ke=[Ee=ee(_[0],null,"Command")].concat(se),ce=d.$r(ke),(Me=Ee.$$prototype).lhs=Me.rhs=Me.cmp_op=L,Ee.$attr_reader("lhs"),Ee.$attr_reader("cmp_op"),Ee.$attr_reader("rhs"),$(Ee,"$initialize",function(be,he,Se,ve){return null==Se&&(Se=L),null==ve&&(ve=L),this.secret=be,this.lhs=he,this.cmp_op=Se,this.rhs=ve},-3),$(Ee,"$expr",function(be){try{var Se;return O("eval_return"),x(x(this.lhs.$expr(be),this.$cmp_op_text()),(Se=this.rhs,Se===L||null==Se?L:Se.$eval(be,L)).$to_s())}catch(ae){if(ae===d.t_eval_return)return ae.$v;throw ae}}),$(Ee,"$s_exp",function(){var be=this;return E(be.cmp_op)?"(Command ("+be.cmp_op+" "+be.lhs.$s_exp()+" "+be.rhs.$s_exp()+"))":"(Command "+be.lhs.$s_exp()+")"}),$(Ee,"$eval",function(be,he){try{O("eval_return");var ve,ge,ae=this,ue=L,Ce=L,b=L,V=L,xe=L;return he=ce("Randomizer").$new(he,be),ue=ae.lhs.$eval(be,he),Ce=E(Y(he.$rand_results().$size(),1))&&E(ae.lhs["$is_a?"](S(ce("Node"),"DiceRoll")))?L:ae.lhs.$output(),b=E(ae.cmp_op)?(V=ae.rhs.$eval(be,L),be.$check_result(ue,he.$rand_results(),ae.cmp_op,V)):L,b=E(ge=b)?ge:ce("Result").$new(),xe=["("+ae.$expr(be)+")",Ce,ue,(ve=b,ve===L||null==ve?L:ve.$text())].$compact(),G(b,"tap",[],function De(Re){var Ue,Ze=null==De.$$s?this:De.$$s;return null==Ze.secret&&(Ze.secret=L),null==Re&&(Re=L),Re["$secret="](Ze.secret),Ue=[xe.$join(" \uff1e ")],G(Re,"text=",Ue),Ue[Ue.length-1]},{$$s:ae})}catch(De){if(De===d.t_eval_return)return De.$v;throw De}}),Ee.$private(),$(Ee,"$cmp_op_text",function(){switch(this.cmp_op){case"!=":return"<>";case"==":return"=";default:return this.cmp_op.$to_s()}}),function(m,ne,se){var Ee=ee(m,null,"UndecidedTarget"),ke=[Ee].concat(se),ce=d.$r(ke);Ee.$include(ce("Singleton")),$(Ee,"$eval",D("?")),$(Ee,"$include_dice?",D(!1)),$(Ee,"$expr",D("?")),$(Ee,"$output",D("?")),W(Ee,"s_exp","output")}(_[0],0,_),function(m,ne){var se=ee(m,null,"BinaryOp"),Ee=se.$$prototype;Ee.lhs=Ee.rhs=Ee.op=L,$(se,"$initialize",function(ce,Me,$e){return this.lhs=ce,this.op=Me,this.rhs=$e}),$(se,"$eval",function(ce,Me){try{var he,Se;return O("eval_return"),he=this.lhs.$eval(ce,Me),Se=this.rhs.$eval(ce,Me),this.$calc(he,Se,ce.$round_type()).$to_i()}catch(ve){if(ve===d.t_eval_return)return ve.$v;throw ve}}),$(se,"$include_dice?",function(){var Me;return E(Me=this.lhs["$include_dice?"]())?Me:this.rhs["$include_dice?"]()}),$(se,"$expr",function(ce){var $e,be;return $e=this.lhs.$expr(ce),be=this.rhs.$expr(ce),""+$e+this.op+be}),$(se,"$output",function(){return""+this.lhs.$output()+this.op+this.rhs.$output()}),$(se,"$s_exp",function(){return"("+this.$op_for_s_exp()+" "+this.lhs.$s_exp()+" "+this.rhs.$s_exp()+")"}),se.$private(),$(se,"$calc",function(ce,Me,$e){return ce.$send(this.op,Me).$to_i()}),$(se,"$op_for_s_exp",B("op"))}(_[0]),function(m,ne,se){var Ee=ee(m,ne,"DivideBase"),ke=[Ee].concat(se),ce=d.$r(ke);Ee.$$prototype.op=L,$(Ee,"$initialize",function $e(be,he){return $e.$$p=null,Z(this,T(this,"initialize",$e,!1,!0),"initialize",[be,"/",he],null)}),$(Ee,"$expr",function $e(be){return $e.$$p=null,""+Z(this,T(this,"expr",$e,!1,!0),"expr",[be],null)+this.$rounding_method()}),$(Ee,"$output",function $e(){var be=$e.$$p||L;return $e.$$p=null,""+Z(this,T(this,"output",$e,!1,!0),"output",[],be)+this.$rounding_method()}),Ee.$private(),$(Ee,"$rounding_method",function(){return S(this.$class(),"ROUNDING_METHOD")}),$(Ee,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),$(Ee,"$calc",function(be,he,Se){return E(he["$zero?"]())?1:this.$divide_and_round(be,he,Se).$to_i()}),$(Ee,"$divide_and_round",function(be,he,Se){return this.$raise(ce("NotImplementedError"))})}(_[0],y("BinaryOp"),_),function(m,ne,se){var Ee=ee(m,ne,"DivideWithGameSystemDefault"),ke=[Ee].concat(se),ce=d.$r(ke);j(ke[0],"ROUNDING_METHOD",""),Ee.$private(),$(Ee,"$divide_and_round",function($e,be,he){var Se,ve=L;return oe(S(ce("RoundType"),"CEIL"),Se=he)?z($e.$to_f(),be).$ceil():oe(S(ce("RoundType"),"ROUND"),Se)?(ve=z($e.$to_f(),be),E(ve["$negative?"]())?ve.$abs().$round()["$-@"]():ve.$round()):z($e,be).$floor()})}(_[0],y("DivideBase"),_),function(m,ne,se){var Ee=ee(m,ne,"DivideWithRoundingUp"),ke=[Ee].concat(se);j(ke[0],"ROUNDING_METHOD","U"),Ee.$private(),$(Ee,"$divide_and_round",function(Me,$e,be){return z(Me.$to_f(),$e).$ceil()})}(_[0],y("DivideBase"),_),function(m,ne,se){var Ee=ee(m,ne,"DivideWithRoundingOff"),ke=[Ee].concat(se);j(ke[0],"ROUNDING_METHOD","R"),Ee.$private(),$(Ee,"$divide_and_round",function(Me,$e,be){var he=L;return he=z(Me.$to_f(),$e),E(he["$negative?"]())?he.$abs().$round()["$-@"]():he.$round()})}(_[0],y("DivideBase"),_),function(m,ne,se){var Ee=ee(m,ne,"DivideWithRoundingDown"),ke=[Ee].concat(se);j(ke[0],"ROUNDING_METHOD","F"),Ee.$private(),$(Ee,"$divide_and_round",function(Me,$e,be){return z(Me,$e).$floor()})}(_[0],y("DivideBase"),_),function(m,ne){var se=ee(m,null,"Negate");se.$$prototype.body=L,se.$attr_reader("body"),$(se,"$initialize",q("body")),$(se,"$eval",function(ce,Me){try{return O("eval_return"),this.body.$eval(ce,Me).$to_i()["$-@"]()}catch(he){if(he===d.t_eval_return)return he.$v;throw he}}),$(se,"$include_dice?",function(){return this.body["$include_dice?"]()}),$(se,"$expr",function(ce){return"-"+this.body.$expr(ce)}),$(se,"$output",function(){return"-"+this.body.$output()}),$(se,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(_[0]),function(m,ne){var se=ee(m,null,"DiceRoll"),Ee=se.$$prototype;Ee.times=Ee.sides=L,$(se,"$initialize",function(ce,Me){return this.times=ce,this.sides=Me,this.text=L}),$(se,"$eval",function(ce,Me){try{O("eval_return");var he,Se,ve=L,ae=L;return he=this.times.$eval(ce,L),Se=this.$eval_sides(ce),ae=(ve=Me.$roll(he,Se)).$sum(),this.text=ae+"["+ve.$join(",")+"]",ae.$to_i()}catch(ue){if(ue===d.t_eval_return)return ue.$v;throw ue}}),$(se,"$include_dice?",D(!0)),$(se,"$expr",function(ce){try{return O("eval_return"),this.times.$eval(ce,L)+"D"+this.$eval_sides(ce)}catch(Se){if(Se===d.t_eval_return)return Se.$v;throw Se}}),$(se,"$output",B("text")),$(se,"$s_exp",function(){return"(DiceRoll "+this.times.$s_exp()+" "+this.sides.$s_exp()+")"}),se.$private(),$(se,"$eval_sides",function(ce){try{return O("eval_return"),this.sides.$eval(ce,L)}catch(be){if(be===d.t_eval_return)return be.$v;throw be}})}(_[0]),function(m,ne){var se=ee(m,ne,"ImplicitSidesDiceRoll");se.$$prototype.times=L,$(se,"$initialize",function(ce){return this.times=ce,this.text=L}),$(se,"$s_exp",function(){return"(ImplicitSidesDiceRoll "+this.times.$s_exp()+")"}),se.$private(),$(se,"$eval_sides",function(ce){return ce.$sides_implicit_d()})}(_[0],y("DiceRoll")),function(m,ne,se){var Ee=ee(m,null,"DiceRollWithFilter"),ke=[Ee].concat(se),ce=d.$r(ke),Me=Ee.$$prototype;Me.times=Me.n_filtering=Me.filter=Me.sides=L,j(ke[0],"Filter",ce("Struct").$new("abbr","apply")),j(ke[0],"KEEP_HIGHEST",ce("Filter").$new("KH",G(Ee,"lambda",[],function(be,he){return null==be&&(be=L),null==he&&(he=L),be.$reverse().$take(he)})).$freeze()),j(ke[0],"KEEP_LOWEST",ce("Filter").$new("KL",G(Ee,"lambda",[],function(be,he){return null==be&&(be=L),null==he&&(he=L),be.$take(he)})).$freeze()),j(ke[0],"DROP_HIGHEST",ce("Filter").$new("DH",G(Ee,"lambda",[],function(be,he){return null==be&&(be=L),null==he&&(he=L),be.$reverse().$drop(he)})).$freeze()),j(ke[0],"DROP_LOWEST",ce("Filter").$new("DL",G(Ee,"lambda",[],function(be,he){return null==be&&(be=L),null==he&&(he=L),be.$drop(he)})).$freeze()),$(Ee,"$initialize",function(be,he,Se,ve){var ae=this;return I(he,"implicit")&&K(he["$respond_to?"]("eval"))&&ae.$raise(ce("TypeError"),"sides must be a Node or :implicit ("+he.$inspect()+")"),ae.times=be,ae.sides=he,ae.n_filtering=Se,ae.filter=ve,ae.text=L}),$(Ee,"$eval",function(be,he){try{O("eval_return");var ae,ue,Ce,ve=this,b=L,V=L;return ae=ve.times.$eval(be,L),ue=ve.$eval_sides(be),Ce=ve.n_filtering.$eval(be,L),b=he.$roll(ae,ue).$sort(),V=ve.filter.$apply()["$[]"](b,Ce).$sum(),ve.text=V+"["+b.$join(",")+"]",V.$to_i()}catch(ge){if(ge===d.t_eval_return)return ge.$v;throw ge}}),$(Ee,"$include_dice?",D(!0)),$(Ee,"$implicit_sides?",function(){return this.sides["$=="]("implicit")}),$(Ee,"$expr",function(be){try{var ve,ae,ue;return O("eval_return"),ve=this.times.$eval(be,L),ae=this.$eval_sides(be),ue=this.n_filtering.$eval(be,L),ve+"D"+ae+this.filter.$abbr()+ue}catch(Ce){if(Ce===d.t_eval_return)return Ce.$v;throw Ce}}),$(Ee,"$output",B("text")),$(Ee,"$s_exp",function(){var he,be=this;return he=E(be["$implicit_sides?"]())?be.sides.$inspect():be.sides.$s_exp(),"(DiceRollWithFilter "+be.times.$s_exp()+" "+he+" "+be.filter.$abbr().$inspect()+" "+be.n_filtering.$s_exp()+")"}),Ee.$private(),$(Ee,"$eval_sides",function(be){try{return O("eval_return"),E(this["$implicit_sides?"]())?be.$sides_implicit_d():this.sides.$eval(be,L)}catch(ve){if(ve===d.t_eval_return)return ve.$v;throw ve}})}(_[0],0,_),function(m,ne){var se=ee(m,null,"Parenthesis");se.$$prototype.expr=L,$(se,"$initialize",q("expr")),$(se,"$eval",function(ce,Me){try{return O("eval_return"),this.expr.$eval(ce,Me).$to_i()}catch(he){if(he===d.t_eval_return)return he.$v;throw he}}),$(se,"$include_dice?",function(){return this.expr["$include_dice?"]()}),$(se,"$expr",function(ce){return"("+this.expr.$expr(ce)+")"}),$(se,"$output",function(){return"("+this.expr.$output()+")"}),$(se,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(_[0]),function(m,ne,se){var Ee=ee(m,null,"Number"),ke=[Ee].concat(se),ce=d.$r(ke);return Ee.$$prototype.literal=L,Ee.$attr_reader("literal"),$(Ee,"$initialize",function(be){return this.literal=be.$to_i()}),$(Ee,"$negate",function(){return ce("Number").$new(this.literal["$-@"]())}),$(Ee,"$eval",function(be,he){return this.literal.$to_i()}),$(Ee,"$include_dice?",D(!1)),$(Ee,"$expr",function(be){return this.literal.$to_s()}),$(Ee,"$output",function(){return this.literal.$to_s()}),W(Ee,"s_exp","output")}(_[0],0,_)},Opal.modules["bcdice/common_command/add_dice/parser"]=function(d){var I,S,R,g,u,p,_,y,m,ne,se,Ee,ke,$e,l,c,f,k,de,v,J,H=d.module,ee=d.klass,$=d.defs,x=d.def,O=d.truthy,E=d.eqeq,Y=d.hash,G=d.const_set,D=d.to_ary,W=d.not,B=d.return_val,Z=d.neqeq,T=d.hash2,j=d.top,oe=[],z=d.nil,q=d.$$$;return j.$require("racc/parser.rb"),j.$require("bcdice/common_command/lexer"),j.$require("bcdice/common_command/add_dice/node"),I=oe,S=J=[H(oe[0],"BCDice")].concat(I),R=v=[H(J[0],"CommonCommand")].concat(S),k=[H(v[0],"AddDice")].concat(R),de=d.$r(k),g=k,c=[l=ee(k[0],q(de("Racc"),"Parser"),"Parser")].concat(g),f=d.$r(c),l.$$prototype.lexer=z,$(l,"$parse",function(ae){return this.$new().$parse(ae)}),x(l,"$parse",function(ae){try{return this.lexer=f("Lexer").$new(ae),this.$do_parse()}catch(Ce){if(!d.rescue(Ce,[f("ParseError")]))throw Ce;try{return z}finally{d.pop_exception()}}}),l.$private(),x(l,"$next_token",function(){return this.lexer.$next_token()}),x(l,"$expand_negate",function(ae,ue){if(O(ue["$is_a?"](q(f("Node"),"Negate")))){if(E(ae,"+"))return["-",ue.$body()];if(E(ae,"-"))return["+",ue.$body()]}return[ae,ue]}),u=d.large_array_unpack("14,14,50,12,51,19,20,14,14,14,12,3,12,17,18,14,8,9,12,4,13,13,28,8,9,8,9,13,13,13,14,8,9,12,15,13,14,23,14,12,56,12,19,20,57,14,8,9,12,,13,,8,9,8,9,13,14,13,,12,8,9,14,16,13,-27,-27,19,20,-27,17,18,8,9,,42,13,,17,18,40,39,13,,38,-28,-28,40,39,-28,,38,45,47,44,46,52,53,54,55"),p=d.large_array_unpack("16,12,38,16,38,6,6,2,36,8,2,0,8,27,27,9,16,16,9,1,16,12,16,2,2,8,8,2,36,8,13,9,9,13,4,9,17,11,18,17,50,18,29,29,51,19,13,13,19,,13,,17,17,18,18,17,20,18,,20,19,19,23,5,19,23,23,30,30,23,25,25,20,20,,25,20,,5,5,24,24,23,,24,33,33,34,34,33,,34,32,32,32,32,39,39,40,40"),_=d.large_array_unpack("7,19,5,,34,61,-15,,7,13,,32,-1,28,,,-2,34,36,43,55,,,61,76,53,,-5,,22,48,,79,81,83,,6,,-8,90,92,,,,,,,,,,29,31,,,,,,"),y=d.large_array_unpack("-3,-41,-41,-4,-41,-1,-9,-12,-41,-41,-20,-26,-41,-41,-40,58,-41,-41,-41,-41,-41,-18,-19,-22,-24,-41,-2,-5,-6,-7,-8,-10,-13,-21,-41,-25,-37,-30,-41,-41,-41,-38,-39,-11,-14,-15,-16,-17,-23,-29,-41,-41,-33,-34,-35,-36,-31,-32"),m=[24,5,21,22,29,30,35,1,2,26,43,33,25,31,32,27,48,34,z,z,z,z,z,z,49],ne=[9,3,6,6,5,5,11,1,2,4,7,9,3,6,6,3,11,10,z,z,z,z,z,z,9],se=[z,7,8,-1,-7,-13,-6,-22,z,-12,-6,-18,z,z,z],Ee=[z,z,z,z,z,6,7,z,10,11,z,z,36,37,41],ke=d.large_array_unpack("0,0,racc_error,2,26,_reduce_1,4,26,_reduce_2,0,27,_reduce_3,1,27,_reduce_4,1,29,_reduce_none,1,29,_reduce_6,3,28,_reduce_7,3,28,_reduce_8,1,28,_reduce_none,3,30,_reduce_10,4,30,_reduce_11,1,30,_reduce_none,0,32,_reduce_13,1,32,_reduce_14,1,32,_reduce_15,1,32,_reduce_16,1,32,_reduce_17,2,31,_reduce_18,2,31,_reduce_19,1,31,_reduce_none,3,33,_reduce_21,2,33,_reduce_22,4,33,_reduce_23,2,33,_reduce_24,3,33,_reduce_25,1,33,_reduce_none,0,35,_reduce_27,1,35,_reduce_28,2,36,_reduce_29,1,36,_reduce_30,3,39,_reduce_31,3,39,_reduce_32,2,37,_reduce_33,2,37,_reduce_34,2,37,_reduce_35,2,37,_reduce_36,1,38,_reduce_none,1,38,_reduce_none,3,34,_reduce_39,1,34,_reduce_40"),$e=Y(!1,0,"error",1,"NUMBER",2,"CMP_OP",3,"S",4,"D",5,"K",6,"H",7,"L",8,"M",9,"A",10,"X",11,"I",12,"N",13,"U",14,"R",15,"F",16,"C",17,"PLUS",18,"MINUS",19,"ASTERISK",20,"SLASH",21,"PARENL",22,"PARENR",23,"QUESTION",24),G(c[0],"Racc_arg",[u,p,y,_,m,ne,Ee,se,25,ke,$e,58,41,!0]),G(c[0],"Racc_token_to_s_table",d.large_array_unpack("$end,error,NUMBER,CMP_OP,S,D,K,H,L,M,A,X,I,N,U,R,F,C,PLUS,MINUS,ASTERISK,SLASH,PARENL,PARENR,QUESTION,$start,command,secret,add,target,mul,unary,round_type,dice,term,explicit_or_implicit_sides,filter,filter_type,filter_type_with_shorthand,filter_shorthand")),G(c[0],"Racc_debug_parser",!1),x(l,"$_reduce_1",function(ae,ue,Ce){var b,xe,De=z;return xe=null==(b=D(ae))[0]?z:b[0],O((De=null==b[1]?z:b[1])["$include_dice?"]())||this.$raise(f("ParseError")),q(f("Node"),"Command").$new(xe,De)}),x(l,"$_reduce_2",function(ae,ue,Ce){var b,xe,De=z,Re=z,Ue=z;return xe=null==(b=D(ae))[0]?z:b[0],Re=null==b[2]?z:b[2],Ue=null==b[3]?z:b[3],(W((De=null==b[1]?z:b[1])["$include_dice?"]())||O(Ue["$include_dice?"]())||O(Re["$nil?"]()))&&this.$raise(f("ParseError")),q(f("Node"),"Command").$new(xe,De,Re,Ue)}),x(l,"$_reduce_3",B(!1)),x(l,"$_reduce_4",B(!0)),x(l,"$_reduce_6",function(ae,ue,Ce){return q(f("Node"),"UndecidedTarget").$instance()}),x(l,"$_reduce_7",function(ae,ue,Ce){var b,V,xe,De,Re;return xe=ae["$[]"](0),V=this.$expand_negate("+",ae["$[]"](2)),De=null==(b=D(V))[0]?z:b[0],Re=null==b[1]?z:b[1],q(f("Node"),"BinaryOp").$new(xe,De,Re)}),x(l,"$_reduce_8",function(ae,ue,Ce){var b,V,xe,De,Re;return xe=ae["$[]"](0),V=this.$expand_negate("-",ae["$[]"](2)),De=null==(b=D(V))[0]?z:b[0],Re=null==b[1]?z:b[1],q(f("Node"),"BinaryOp").$new(xe,De,Re)}),x(l,"$_reduce_10",function(ae,ue,Ce){var b,V;return b=ae["$[]"](0),V=ae["$[]"](2),q(f("Node"),"BinaryOp").$new(b,"*",V)}),x(l,"$_reduce_11",function(ae,ue,Ce){var b,V;return b=ae["$[]"](0),V=ae["$[]"](2),ae["$[]"](3).$new(b,V)}),x(l,"$_reduce_13",function(ae,ue,Ce){return q(f("Node"),"DivideWithGameSystemDefault")}),x(l,"$_reduce_14",function(ae,ue,Ce){return q(f("Node"),"DivideWithRoundingDown")}),x(l,"$_reduce_15",function(ae,ue,Ce){return q(f("Node"),"DivideWithRoundingUp")}),x(l,"$_reduce_16",function(ae,ue,Ce){return q(f("Node"),"DivideWithRoundingUp")}),x(l,"$_reduce_17",function(ae,ue,Ce){return q(f("Node"),"DivideWithRoundingOff")}),x(l,"$_reduce_18",function(ae,ue,Ce){return ae["$[]"](1)}),x(l,"$_reduce_19",function(ae,ue,Ce){var b=z;return b=ae["$[]"](1),O(b["$is_a?"](q(f("Node"),"Negate")))?b.$body():q(f("Node"),"Negate").$new(b)}),x(l,"$_reduce_21",function(ae,ue,Ce){var V=z,ge=z;return V=ae["$[]"](0),ge=ae["$[]"](2),(O(V["$include_dice?"]())||O(ge["$include_dice?"]()))&&this.$raise(f("ParseError")),q(f("Node"),"DiceRoll").$new(V,ge)}),x(l,"$_reduce_22",function(ae,ue,Ce){var V=z;return V=ae["$[]"](0),O(V["$include_dice?"]())&&this.$raise(f("ParseError")),q(f("Node"),"ImplicitSidesDiceRoll").$new(V)}),x(l,"$_reduce_23",function(ae,ue,Ce){var xe,V=z,ge=z,De=z;return V=ae["$[]"](0),ge=ae["$[]"](2),xe=ae["$[]"](3)["$[]"]("filter"),De=ae["$[]"](3)["$[]"]("n_filtering"),Z(ge,"implicit")&&O(ge["$include_dice?"]())&&this.$raise(f("ParseError")),(O(V["$include_dice?"]())||O(De["$include_dice?"]()))&&this.$raise(f("ParseError")),q(f("Node"),"DiceRollWithFilter").$new(V,ge,De,xe)}),x(l,"$_reduce_24",function(ae,ue,Ce){var V,ge=z;return V=q(f("Node"),"Number").$new(1),ge=ae["$[]"](1),O(ge["$include_dice?"]())&&this.$raise(f("ParseError")),O(ge["$instance_of?"](q(f("Node"),"Number")))&&E(ge.$literal(),66)&&this.$raise(f("ParseError")),q(f("Node"),"DiceRoll").$new(V,ge)}),x(l,"$_reduce_25",function(ae,ue,Ce){var V,xe,b=this,ge=z,De=z;return V=q(f("Node"),"Number").$new(1),ge=ae["$[]"](1),xe=ae["$[]"](2)["$[]"]("filter"),De=ae["$[]"](2)["$[]"]("n_filtering"),Z(ge,"implicit")&&O(ge["$include_dice?"]())&&b.$raise(f("ParseError")),O(De["$include_dice?"]())&&b.$raise(f("ParseError")),O(ge["$instance_of?"](q(f("Node"),"Number")))&&E(ge.$literal(),66)&&b.$raise(f("ParseError")),q(f("Node"),"DiceRollWithFilter").$new(V,ge,De,xe)}),x(l,"$_reduce_27",B("implicit")),x(l,"$_reduce_28",function(ae,ue,Ce){return ae["$[]"](0)}),x(l,"$_reduce_29",function(ae,ue,Ce){return T(["filter","n_filtering"],{filter:ae["$[]"](0),n_filtering:ae["$[]"](1)})}),x(l,"$_reduce_30",function(ae,ue,Ce){return T(["filter","n_filtering"],{filter:ae["$[]"](0),n_filtering:q(f("Node"),"Number").$new(1)})}),x(l,"$_reduce_31",function(ae,ue,Ce){return q(q(f("Node"),"DiceRollWithFilter"),"KEEP_HIGHEST")}),x(l,"$_reduce_32",function(ae,ue,Ce){return q(q(f("Node"),"DiceRollWithFilter"),"KEEP_LOWEST")}),x(l,"$_reduce_33",function(ae,ue,Ce){return q(q(f("Node"),"DiceRollWithFilter"),"KEEP_HIGHEST")}),x(l,"$_reduce_34",function(ae,ue,Ce){return q(q(f("Node"),"DiceRollWithFilter"),"KEEP_LOWEST")}),x(l,"$_reduce_35",function(ae,ue,Ce){return q(q(f("Node"),"DiceRollWithFilter"),"DROP_HIGHEST")}),x(l,"$_reduce_36",function(ae,ue,Ce){return q(q(f("Node"),"DiceRollWithFilter"),"DROP_LOWEST")}),x(l,"$_reduce_39",function(ae,ue,Ce){return q(f("Node"),"Parenthesis").$new(ae["$[]"](1))}),x(l,"$_reduce_40",function(ae,ue,Ce){return q(f("Node"),"Number").$new(ae["$[]"](0))}),x(l,"$_reduce_none",function(ae,ue,Ce){return ae["$[]"](0)})},Opal.modules["bcdice/common_command/add_dice/randomizer"]=function(d){var B,oe,I,M,v,P,R,te,J,q,T,H=d.module,ee=d.klass,$=d.const_set,x=d.def,O=d.eqeq,E=d.send,Y=d.truthy,G=[],D=d.nil;return B=G,oe=T=[H(G[0],"BCDice")].concat(B),I=q=[H(T[0],"CommonCommand")].concat(oe),M=J=[H(q[0],"AddDice")].concat(I),P=[v=ee(J[0],null,"Randomizer")].concat(M),R=d.$r(P),(te=v.$$prototype).game_system=te.rand_source=te.rand_results=D,v.$attr_reader("rand_results"),$(P[0],"RandResult",R("Struct").$new("sides","value")),x(v,"$initialize",function(de,N){var F=this;return F.rand_source=de,F.game_system=N,F.rand_results=[]}),x(v,"$roll",function(de,N){var l,F=this,g=D;return g=O(N,66)?E(R("Array"),"new",[de],function c(){var f=null==c.$$s?this:c.$$s;return null==f.rand_source&&(f.rand_source=D),null==f.game_system&&(f.game_system=D),f.rand_source.$roll_d66(f.game_system.$d66_sort_type())},{$$s:F}):O(N,9)&&Y(F.game_system["$enabled_d9?"]())?E(R("Array"),"new",[de],function c(){var f=null==c.$$s?this:c.$$s;return null==f.rand_source&&(f.rand_source=D),f.rand_source.$roll_d9()},{$$s:F}):F.rand_source.$roll_barabara(de,N),Y(F.game_system["$sort_add_dice?"]())&&g["$sort!"](),l=E(g,"map",[],function(f){return null==f&&(f=D),R("RandResult").$new(N,f)}),F.rand_results.$concat(l),g})},Opal.modules["bcdice/common_command/add_dice"]=function(d){var D,T,q,A,L,S,K,I,oe,B,H=d.module,ee=d.const_set,$=d.thrower,x=d.def,O=d.top,E=[],Y=d.nil;return O.$require("bcdice/normalize"),O.$require("bcdice/common_command/add_dice/parser"),O.$require("bcdice/common_command/add_dice/randomizer"),D=E,T=B=[H(E[0],"BCDice")].concat(D),q=oe=[H(B[0],"CommonCommand")].concat(T),ee((I=[K=H(oe[0],"AddDice")].concat(q))[0],"PREFIX_PATTERN",/[+\-(]*(\d+|D\d+)/.$freeze()),L=[A=d.get_singleton_class(K)].concat(I),S=d.$r(L),x(A,"$eval",function(v,P,R){try{var k;return $("eval_return"),(k=S("Parser").$parse(v))===Y||null==k?Y:k.$eval(P,R)}catch(N){if(N===d.t_eval_return)return N.$v;throw N}})},Opal.modules["bcdice/common_command/reroll_dice/node"]=function(d){var K,L,P,de,c,f,u,p,_,F,te,M,A,H=d.module,ee=d.klass,$=d.ensure_kwargs,x=d.get_kwarg,O=d.def,E=d.truthy,Y=d.send,G=d.thrower,D=d.rb_lt,W=d.rb_plus,B=d.rb_gt,Z=d.eqeq,T=d.rb_le,j=d.rb_ge,oe=[],z=d.nil;return K=oe,L=A=[H(oe[0],"BCDice")].concat(K),P=M=[H(A[0],"CommonCommand")].concat(L),de=te=[H(M[0],"RerollDice")].concat(P),c=F=[H(te[0],"Node")].concat(de),u=[f=ee(F[0],null,"Command")].concat(c),p=d.$r(u),(_=f.$$prototype).cmp_op=_.reroll_cmp_op=_.target_number_node=_.reroll_threshold_node=_.notations=_.source=z,O(f,"$initialize",function(m){var ne,se,Ee,ke,ce,Me,$e,be=this;return m=$(m),ne=x(m,"secret"),se=x(m,"notations"),Ee=x(m,"source"),null==(ke=m.$$smap.cmp_op)&&(ke=z),null==(ce=m.$$smap.target_number)&&(ce=z),null==(Me=m.$$smap.reroll_cmp_op)&&(Me=z),null==($e=m.$$smap.reroll_threshold)&&($e=z),be.secret=ne,be.notations=se,be.cmp_op=ke,be.target_number_node=ce,be.reroll_cmp_op=Me,be.reroll_threshold_node=$e,be.source=Ee}),O(f,"$eval",function(m,ne){try{G("eval_return");var Ee,ke,Me,$e,he,ve,ae,Ce,ce=this,be=z,Se=z,ue=z,b=z,V=z,ge=z,xe=z,De=z;return Me=m.$round_type(),$e=E(be=ce.cmp_op)?be:m.$default_cmp_op(),he=E(be=E(Se=ce.reroll_cmp_op)?Se:$e)?be:">=",ve=E(be=(Ee=ce.target_number_node)===z||null==Ee?z:Ee.$eval(Me))?be:m.$default_target_number(),ae=E(be=E(Se=(ke=ce.reroll_threshold_node)===z||null==ke?z:ke.$eval(Me))?Se:m.$reroll_dice_reroll_threshold())?be:ve,ue=p("RerollCondition").$new(he,ae),Ce=Y(ce.notations,"map",[],function(Ue){return null==Ue&&(Ue=z),Ue.$to_dice(Me)}),E(Y(Ce,"all?",[],function(Ue){return null==Ue&&(Ue=z),ue["$valid?"](Ue.$sides())}))?(V=(b=ce.$roll(Ce,ne,ue,m["$sort_barabara_dice?"]())).$flatten(),ge=b.$take(ce.notations.$size()).$flatten().$count(1),xe=E($e)?Y(V,"count",[],function(Ue){return null==Ue&&(Ue=z),Ue.$send($e,ve)}):0,De=[ce.$expr(Me,ue,$e,ve),Y(b,"map",[],function(Ue){return null==Ue&&(Ue=z),Ue.$join(",")}).$join(" + "),"\u6210\u529f\u6570"+xe,m.$grich_text(ge,V.$size(),xe)].$compact(),ce.$result_with_text(De.$join(" \uff1e "))):ce.$result_with_text(ce.source+" \uff1e \u6761\u4ef6\u304c\u9593\u9055\u3063\u3066\u3044\u307e\u3059\u30022R6>=5 \u3042\u308b\u3044\u306f 2R6[5] \u306e\u3088\u3046\u306b\u632f\u308a\u8db3\u3057\u76ee\u6a19\u5024\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002")}catch(Re){if(Re===d.t_eval_return)return Re.$v;throw Re}}),f.$private(),O(f,"$roll",function(m,ne,se,Ee){var ke=z,ce=z,Me=z,$e=z,be=z,he=z;for(ke=[],ce=0;E(E(Me=m["$empty?"]()["$!"]())?D(ce,p("REROLL_LIMIT")):Me);)$e=m.$shift(),ce=W(ce,1),be=$e.$roll(ne),E(Ee)&&be["$sort!"](),ke.$push(be),he=Y(be,"count",[],function(ve){return null==ve&&(ve=z),se["$reroll?"](ve)}),E(B(he,0))&&m.$push(p("Dice").$new(he,$e.$sides()));return ke}),O(f,"$expr",function(m,ne,se,Ee){var ce,Me,$e;return ce=Y(this.notations,"map",[],function(he){return null==he&&(he=z),he.$to_dice(m)}).$join("+"),Me=Z(ne.$cmp_op(),se)?"":p("Format").$comparison_operator(ne.$cmp_op()),$e=p("Format").$comparison_operator(se),"("+ce+"["+Me+ne.$threshold()+"]"+$e+Ee+")"}),O(f,"$result_with_text",function(m){return Y(p("Result").$new(),"tap",[],function se(Ee){var ke,ce=null==se.$$s?this:se.$$s;return null==ce.secret&&(ce.secret=z),null==Ee&&(Ee=z),Ee["$secret="](ce.secret),Y(Ee,"text=",ke=[m]),ke[ke.length-1]},{$$s:this})}),function(g,l){var c=ee(g,null,"RerollCondition"),f=c.$$prototype;f.threshold=f.cmp_op=z,c.$attr_reader("cmp_op"),c.$attr_reader("threshold"),O(c,"$initialize",function(p,_){return this.cmp_op=p,this.threshold=_}),O(c,"$valid?",function(p){var _=this;if(!E(_.threshold))return!1;switch(_.cmp_op){case"<=":return D(_.threshold,p);case"<":return T(_.threshold,p);case">=":return B(_.threshold,1);case">":return j(_.threshold,1);case"!=":return d.Range.$new(1,p,!1)["$include?"](_.threshold);default:return!0}}),O(c,"$reroll?",function(p){return p.$send(this.cmp_op,this.threshold)})}(F[0]),function(g,l,c){var f=ee(g,null,"Notation"),u=[f].concat(c),p=d.$r(u),_=f.$$prototype;_.times=_.sides=z,O(f,"$initialize",function(m,ne){return this.times=m,this.sides=ne}),O(f,"$to_dice",function(m){try{var Ee,ke;return G("eval_return"),Ee=this.times.$eval(m),ke=this.sides.$eval(m),p("Dice").$new(Ee,ke)}catch(ce){if(ce===d.t_eval_return)return ce.$v;throw ce}})}(F[0],0,F),function(g,l){var c=ee(g,null,"Dice");return c.$attr_reader("times","sides"),O(c,"$initialize",function(u,p){return this.times=u,this.sides=p}),O(c,"$roll",function(u){return u.$roll_barabara(this.$times(),this.$sides())}),O(c,"$to_s",function(){return this.$times()+"R"+this.$sides()})}(F[0])},Opal.modules["bcdice/arithmetic/node"]=function(d){var I,S,R,g,l,k,de,v,J,H=d.module,ee=d.klass,$=d.def,x=d.thrower,O=d.return_ivar,E=d.send2,Y=d.find_super,G=d.eqeq,D=d.const_set,W=d.eqeqeq,B=d.rb_divide,Z=d.truthy,T=d.assign_ivar,j=d.alias,oe=[],z=d.nil,q=d.$$$;return I=oe,S=J=[H(oe[0],"BCDice")].concat(I),R=v=[H(J[0],"Arithmetic")].concat(S),k=[H(v[0],"Node")].concat(R),de=d.$r(k),(l=(g=ee(k[0],null,"BinaryOp")).$$prototype).lhs=l.rhs=l.op=z,$(g,"$initialize",function(f,u,p){var _=this;return _.lhs=f,_.op=u,_.rhs=p}),$(g,"$eval",function(f){try{x("eval_return");var y,p=this,_=z;return _=p.lhs.$eval(f),y=p.rhs.$eval(f),_.$send(p.op,y)}catch(m){if(m===d.t_eval_return)return m.$v;throw m}}),$(g,"$output",function(){var f=this;return""+f.lhs.$output()+f.op+f.rhs.$output()}),$(g,"$s_exp",function(){var f=this;return"("+f.$op_for_s_exp()+" "+f.lhs.$s_exp()+" "+f.rhs.$s_exp()+")"}),$(g,"$op_for_s_exp",O("op")),function(N,F,g){var l=ee(N,F,"DivideBase"),c=[l].concat(g),f=d.$r(c),u=l.$$prototype;u.lhs=u.rhs=u.op=z,$(l,"$initialize",function p(_,y){return p.$$p=null,E(this,Y(this,"initialize",p,!1,!0),"initialize",[_,"/",y],null)}),$(l,"$eval",function(_){try{x("eval_return");var ne,se,m=this;return ne=m.lhs.$eval(_),se=m.rhs.$eval(_),G(se,0)&&m.$raise(f("ZeroDivisionError")),m.$divide_and_round(ne,se,_)}catch(Ee){if(Ee===d.t_eval_return)return Ee.$v;throw Ee}}),$(l,"$output",function p(){var _=p.$$p||z,y=this;return p.$$p=null,""+E(y,Y(y,"output",p,!1,!0),"output",[],_)+y.$rounding_method()}),l.$private(),$(l,"$rounding_method",function(){return q(this.$class(),"ROUNDING_METHOD")}),$(l,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),$(l,"$divide_and_round",function(_,y,m){return this.$raise(f("NotImplementedError"))})}(k[0],de("BinaryOp"),k),function(N,F,g){var l=ee(N,F,"DivideWithGameSystemDefault"),c=[l].concat(g),f=d.$r(c);D(c[0],"ROUNDING_METHOD",""),l.$private(),$(l,"$divide_and_round",function(p,_,y){var m,ne=z;return W(q(f("RoundType"),"CEIL"),m=y)?B(p.$to_f(),_).$ceil():W(q(f("RoundType"),"ROUND"),m)?(ne=B(p.$to_f(),_),Z(ne["$negative?"]())?ne.$abs().$round()["$-@"]():ne.$round()):B(p,_).$floor()})}(k[0],de("DivideBase"),k),function(N,F,g){var l=ee(N,F,"DivideWithCeil"),c=[l].concat(g);D(c[0],"ROUNDING_METHOD","C"),l.$private(),$(l,"$divide_and_round",function(u,p,_){return B(u.$to_f(),p).$ceil()})}(k[0],de("DivideBase"),k),function(N,F,g){var l=ee(N,F,"DivideWithRound"),c=[l].concat(g);D(c[0],"ROUNDING_METHOD","R"),l.$private(),$(l,"$divide_and_round",function(u,p,_){var y=z;return y=B(u.$to_f(),p),Z(y["$negative?"]())?y.$abs().$round()["$-@"]():y.$round()})}(k[0],de("DivideBase"),k),function(N,F,g){var l=ee(N,F,"DivideWithFloor"),c=[l].concat(g);D(c[0],"ROUNDING_METHOD","F"),l.$private(),$(l,"$divide_and_round",function(u,p,_){return B(u,p).$floor()})}(k[0],de("DivideBase"),k),function(N,F){var g=ee(N,null,"Negative");g.$$prototype.body=z,$(g,"$initialize",T("body")),$(g,"$eval",function(f){try{return x("eval_return"),this.body.$eval(f)["$-@"]()}catch(_){if(_===d.t_eval_return)return _.$v;throw _}}),$(g,"$output",function(){return"-"+this.body.$output()}),$(g,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(k[0]),function(N,F){var g=ee(N,null,"Parenthesis");g.$$prototype.expr=z,$(g,"$initialize",T("expr")),$(g,"$eval",function(f){try{return x("eval_return"),this.expr.$eval(f)}catch(_){if(_===d.t_eval_return)return _.$v;throw _}}),$(g,"$output",function(){return"("+this.expr.$output()+")"}),$(g,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(k[0]),function(N,F){var g=ee(N,null,"Number");return g.$$prototype.value=z,$(g,"$initialize",T("value")),$(g,"$eval",O("value")),$(g,"$output",function(){return this.value.$to_s()}),j(g,"s_exp","output")}(k[0])},Opal.modules["bcdice/common_command/barabara_dice/parser"]=function(d){var z,A,M,de,l,c,f,u,p,_,y,m,ne,ke,N,F,g,P,R,L,K,H=d.module,ee=d.klass,$=d.defs,x=d.def,O=d.hash,E=d.const_set,Y=d.hash2,G=d.return_val,D=d.to_ary,W=d.truthy,B=d.top,Z=[],T=d.nil,j=d.$$$;return B.$require("racc/parser.rb"),B.$require("bcdice/common_command/lexer"),B.$require("bcdice/common_command/reroll_dice/node"),B.$require("bcdice/arithmetic/node"),z=Z,A=K=[H(Z[0],"BCDice")].concat(z),M=L=[H(K[0],"CommonCommand")].concat(A),P=[H(L[0],"BarabaraDice")].concat(M),R=d.$r(P),de=P,F=[N=ee(P[0],j(R("Racc"),"Parser"),"Parser")].concat(de),g=d.$r(F),N.$$prototype.lexer=T,$(N,"$parse",function(he){return this.$new().$parse(he)}),x(N,"$parse",function(he){try{return this.lexer=g("Lexer").$new(he),this.$do_parse()}catch(ve){if(!d.rescue(ve,[g("ParseError")]))throw ve;try{return T}finally{d.pop_exception()}}}),N.$private(),x(N,"$next_token",function(){return this.lexer.$next_token()}),l=d.large_array_unpack("13,9,3,9,24,25,9,9,9,26,18,19,8,12,8,18,19,8,8,8,9,4,9,38,36,37,39,18,19,18,19,8,9,8,9,27,28,24,25,18,19,18,19,8,9,8,9,27,28,27,28,18,19,18,19,8,10,8,14"),c=d.large_array_unpack("5,2,0,8,15,15,13,14,12,15,8,8,2,5,8,12,12,13,14,12,18,1,19,34,34,34,34,18,18,19,19,18,24,19,25,16,16,21,21,24,24,25,25,24,27,25,28,31,31,32,32,27,27,28,28,27,4,28,7"),f=d.large_array_unpack("-6,21,-1,,56,-9,,55,1,,,,6,4,5,-5,24,,18,20,,28,,,30,32,,42,44,,,36,38,,19,,,,,"),u=d.large_array_unpack("-2,-25,-25,-3,-25,-4,-7,-25,-25,-24,40,-1,-25,-25,-25,-25,-11,-14,-25,-25,-22,-5,-6,-8,-25,-25,-23,-25,-25,-20,-21,-9,-10,-12,-15,-13,-16,-17,-18,-19"),p=[7,1,6,15,2,29,30,21,31,32,5,7,23,22,33,34,11,35],_=[7,1,6,5,2,9,9,5,8,8,3,7,7,6,9,9,4,10],y=[T,1,4,8,11,-5,0,-2,-16,-13,-17],m=[T,T,T,T,T,T,T,20,16,17,T],ne=d.large_array_unpack("0,0,racc_error,3,24,_reduce_1,0,25,_reduce_2,1,25,_reduce_3,0,27,_reduce_4,2,27,_reduce_5,3,26,_reduce_6,1,26,_reduce_7,3,29,_reduce_8,3,28,_reduce_9,3,28,_reduce_10,1,28,_reduce_none,3,31,_reduce_12,4,31,_reduce_13,1,31,_reduce_none,0,33,_reduce_15,1,33,_reduce_16,1,33,_reduce_17,1,33,_reduce_18,1,33,_reduce_19,2,32,_reduce_20,2,32,_reduce_21,1,32,_reduce_none,3,30,_reduce_23,1,30,_reduce_24"),ke=O(!1,0,"error",1,"NUMBER",2,"B",3,"R",4,"U",5,"C",6,"F",7,"S",8,"PLUS",9,"MINUS",10,"ASTERISK",11,"SLASH",12,"PARENL",13,"PARENR",14,"BRACKETL",15,"BRACKETR",16,"LESS",17,"GREATER",18,"EQUAL",19,"NOT",20,"AT",21,"CMP_OP",22),E(F[0],"Racc_arg",[l,c,u,f,p,_,m,y,23,ne,ke,40,25,!0]),E(F[0],"Racc_token_to_s_table",d.large_array_unpack("$end,error,NUMBER,B,R,U,C,F,S,PLUS,MINUS,ASTERISK,SLASH,PARENL,PARENR,BRACKETL,BRACKETR,LESS,GREATER,EQUAL,NOT,AT,CMP_OP,$start,expr,secret,notations,target,add,dice,term,mul,unary,round_type")),E(F[0],"Racc_debug_parser",!1),x(N,"$_reduce_1",function(he,Se,ve){return j(g("Node"),"Command").$new(Y(["secret","notations","cmp_op","target_number"],{secret:he["$[]"](0),notations:he["$[]"](1),cmp_op:he["$[]"](2)["$[]"]("cmp_op"),target_number:he["$[]"](2)["$[]"]("target")}))}),x(N,"$_reduce_2",G(!1)),x(N,"$_reduce_3",G(!0)),x(N,"$_reduce_4",function(he,Se,ve){return Y([],{})}),x(N,"$_reduce_5",function(he,Se,ve){var ae,b,V;return V=null==(ae=D(he))[1]?T:ae[1],W(b=null==ae[0]?T:ae[0])||this.$raise(g("ParseError")),Y(["cmp_op","target"],{cmp_op:b,target:V})}),x(N,"$_reduce_6",function(he,Se,ve){var ae=T;return(ae=he["$[]"](0)).$push(he["$[]"](2)),ae}),x(N,"$_reduce_7",function(he,Se,ve){return[he["$[]"](0)]}),x(N,"$_reduce_8",function(he,Se,ve){var ae,ue;return ae=he["$[]"](0),ue=he["$[]"](2),j(g("Node"),"Notation").$new(ae,ue)}),x(N,"$_reduce_9",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"+",he["$[]"](2))}),x(N,"$_reduce_10",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"-",he["$[]"](2))}),x(N,"$_reduce_12",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"*",he["$[]"](2))}),x(N,"$_reduce_13",function(he,Se,ve){return he["$[]"](3).$new(he["$[]"](0),he["$[]"](2))}),x(N,"$_reduce_15",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),x(N,"$_reduce_16",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"DivideWithCeil")}),x(N,"$_reduce_17",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"DivideWithCeil")}),x(N,"$_reduce_18",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"DivideWithRound")}),x(N,"$_reduce_19",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"DivideWithFloor")}),x(N,"$_reduce_20",function(he,Se,ve){return he["$[]"](1)}),x(N,"$_reduce_21",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"Negative").$new(he["$[]"](1))}),x(N,"$_reduce_23",function(he,Se,ve){return he["$[]"](1)}),x(N,"$_reduce_24",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"Number").$new(he["$[]"](0))}),x(N,"$_reduce_none",function(he,Se,ve){return he["$[]"](0)})},Opal.modules["bcdice/common_command/barabara_dice"]=function(d){var D,T,q,A,L,S,K,I,oe,B,H=d.module,ee=d.const_set,$=d.thrower,x=d.def,E=[],Y=d.nil;return d.top.$require("bcdice/common_command/barabara_dice/parser"),D=E,T=B=[H(E[0],"BCDice")].concat(D),q=oe=[H(B[0],"CommonCommand")].concat(T),ee((I=[K=H(oe[0],"BarabaraDice")].concat(q))[0],"PREFIX_PATTERN",/\d+B\d+/.$freeze()),L=[A=d.get_singleton_class(K)].concat(I),S=d.$r(L),x(A,"$eval",function(v,P,R){try{var k;return $("eval_return"),(k=S("Parser").$parse(v))===Y||null==k?Y:k.$eval(P,R)}catch(N){if(N===d.t_eval_return)return N.$v;throw N}})},Opal.modules["bcdice/result"]=function(d){var oe,K,z,W,Z,ee=d.klass,$=d.send,x=d.def,O=d.return_val,E=d.return_ivar,Y=[],G=d.nil;return W=Y,oe=Z=[(0,d.module)(Y[0],"BCDice")].concat(W),[z=ee(Z[0],null,"Result")].concat(oe),x(K=d.get_singleton_class(z),"$success",function(J){return $(this.$new(),"tap",[],function(M){var v;return null==M&&(M=G),M["$text="](J),$(M,"success=",v=[!0]),v[v.length-1]})}),x(K,"$failure",function(J){return $(this.$new(),"tap",[],function(M){var v;return null==M&&(M=G),M["$text="](J),$(M,"failure=",v=[!0]),v[v.length-1]})}),x(K,"$critical",function(J){return $(this.$new(),"tap",[],function(M){var v;return null==M&&(M=G),M["$text="](J),M["$critical="](!0),$(M,"success=",v=[!0]),v[v.length-1]})}),x(K,"$fumble",function(J){return $(this.$new(),"tap",[],function(M){var v;return null==M&&(M=G),M["$text="](J),M["$fumble="](!0),$(M,"failure=",v=[!0]),v[v.length-1]})}),x(K,"$nothing",O("nothing")),x(z,"$initialize",function(I){var A=this;return null==I&&(I=G),A.text=I,A.rands=G,A.detailed_rands=G,A.secret=!1,A.success=!1,A.failure=!1,A.critical=!1,A.fumble=!1},-1),z.$attr_accessor("text","rands","detailed_rands"),z.$attr_writer("secret","success","failure","critical","fumble"),x(z,"$secret?",E("secret")),x(z,"$success?",E("success")),x(z,"$failure?",E("failure")),x(z,"$critical?",E("critical")),x(z,"$fumble?",E("fumble")),x(z,"$condition=",function(I){return this.success=I,this.failure=I["$!"]()})},Opal.modules["bcdice/common_command/tally_dice/node"]=function(d){var I,S,R,N,f,u,p,_,g,k,v,J,H=d.module,ee=d.klass,$=d.const_set,x=d.ensure_kwargs,O=d.get_kwarg,E=d.def,Y=d.truthy,G=d.rb_gt,D=d.send,W=d.not,B=d.eqeq,Z=d.hash2,T=d.thrower,j=d.alias,z=[],q=d.nil;return d.top.$require("bcdice/result"),I=z,S=J=[H(z[0],"BCDice")].concat(I),R=v=[H(J[0],"CommonCommand")].concat(S),N=k=[H(v[0],"TallyDice")].concat(R),f=g=[H(k[0],"Node")].concat(N),p=[u=ee(g[0],null,"Command")].concat(f),_=d.$r(p),u.$$prototype.notation=q,$(p[0],"MAX_SIDES",20),E(u,"$initialize",function(ne){var se,Ee;return ne=x(ne),se=O(ne,"secret"),Ee=O(ne,"notation"),this.secret=se,this.notation=Ee}),E(u,"$eval",function(ne,se){var ke=q,ce=q,Me=q,$e=q,be=q,he=q;return ke=this.notation.$to_dice(ne.$round_type()),Y(ke["$valid?"]())?Y(G(ke.$sides(),_("MAX_SIDES")))?_("Result").$new("("+ke+") \uff1e \u9762\u6570\u306f1\u4ee5\u4e0a\u3001"+_("MAX_SIDES")+"\u4ee5\u4e0b\u3068\u3057\u3066\u304f\u3060\u3055\u3044"):(ce=ke.$roll(se),Me=(Y(ne["$sort_barabara_dice?"]())?ce.$sort():ce).$join(","),$e=D(D(ce,"group_by",[],"itself".$to_proc()),"transform_values",[],"length".$to_proc()),be=D(d.Range.$new(1,ke.$sides(),!1),"map",[],function(ve){var ae;return null==ve&&(ve=q),ae=$e.$fetch(ve,0),B(ae,0)&&W(ke["$show_zeros?"]())?q:"["+ve+"]\xd7"+$e.$fetch(ve,0)}),he=["("+ke+")",Me,be.$compact().$join(", ")].$compact(),D(_("Result").$new(),"tap",[],function Se(ve){var ae,ue=null==Se.$$s?this:Se.$$s;return null==ue.secret&&(ue.secret=q),null==ve&&(ve=q),ve["$secret="](ue.secret),ae=[he.$join(" \uff1e ")],D(ve,"text=",ae),ae[ae.length-1]},{$$s:this})):q}),function(l,c,f){var u=ee(l,null,"Notation"),p=[u].concat(f),_=d.$r(p),y=u.$$prototype;y.times=y.sides=y.show_zeros=q,u.$attr_reader("times"),u.$attr_reader("sides"),u.$attr_reader("show_zeros"),E(u,"$initialize",function(ne){var se,Ee,ke;return ne=x(ne),se=O(ne,"times"),Ee=O(ne,"sides"),ke=O(ne,"show_zeros"),this.times=se,this.sides=Ee,this.show_zeros=ke}),E(u,"$to_dice",function(ne){try{var ke,ce;return T("eval_return"),ke=this.times.$eval(ne),ce=this.sides.$eval(ne),_("Dice").$new(Z(["times","sides","show_zeros"],{times:ke,sides:ce,show_zeros:this.show_zeros}))}catch(Me){if(Me===d.t_eval_return)return Me.$v;throw Me}})}(g[0],0,g),function(l,c){var f=ee(l,null,"Dice"),u=f.$$prototype;return u.times=u.sides=u.show_zeros=q,f.$attr_reader("times"),f.$attr_reader("sides"),f.$attr_reader("show_zeros"),j(f,"show_zeros?","show_zeros"),E(f,"$initialize",function(_){var y,m,ne;return _=x(_),y=O(_,"times"),m=O(_,"sides"),ne=O(_,"show_zeros"),this.times=y,this.sides=m,this.show_zeros=ne}),E(f,"$valid?",function(){var y;return Y(y=G(this.times,0))?G(this.sides,0):y}),E(f,"$roll",function(_){return _.$roll_barabara(this.times,this.sides)}),E(f,"$to_s",function(){var y,_=this;return y=Y(_.show_zeros)?"Z":"Y",_.times+"T"+y+_.sides})}(g[0])},Opal.modules["bcdice/common_command/tally_dice/parser"]=function(d){var j,K,L,te,F,g,l,c,f,u,p,_,y,se,k,de,N,M,v,A,z,H=d.module,ee=d.klass,$=d.defs,x=d.def,O=d.hash,E=d.const_set,Y=d.hash2,G=d.return_val,D=d.top,W=[],B=d.nil,Z=d.$$$;return D.$require("racc/parser.rb"),D.$require("bcdice/common_command/lexer"),D.$require("bcdice/common_command/tally_dice/node"),D.$require("bcdice/arithmetic/node"),j=W,K=z=[H(W[0],"BCDice")].concat(j),L=A=[H(z[0],"CommonCommand")].concat(K),M=[H(A[0],"TallyDice")].concat(L),v=d.$r(M),te=M,de=[k=ee(M[0],Z(v("Racc"),"Parser"),"Parser")].concat(te),N=d.$r(de),k.$$prototype.lexer=B,$(k,"$parse",function($e){return this.$new().$parse($e)}),x(k,"$parse",function($e){try{return this.lexer=N("Lexer").$new($e),this.$do_parse()}catch(he){if(!d.rescue(he,[N("ParseError")]))throw he;try{return B}finally{d.pop_exception()}}}),k.$private(),x(k,"$next_token",function(){return this.lexer.$next_token()}),F=d.large_array_unpack("8,8,18,19,20,21,8,8,8,22,14,15,3,7,7,14,15,14,15,7,7,7,8,4,8,35,33,34,36,8,9,14,15,14,15,7,8,7,14,15,23,24,7,23,24,14,15,23,24,7,10"),g=d.large_array_unpack("2,7,10,10,11,11,14,17,15,11,7,7,0,2,7,14,14,15,15,14,17,15,20,1,21,31,31,31,31,23,4,20,20,21,21,20,24,21,23,23,12,12,23,28,28,24,24,29,29,24,6"),l=d.large_array_unpack("2,23,-2,,30,,47,-1,,,-2,-7,27,,4,6,,5,,,20,22,,27,34,,,,30,34,,19,,,,,"),c=d.large_array_unpack("-2,-23,-23,-3,-23,-1,-23,-23,-22,37,-23,-23,-9,-12,-23,-23,-20,-23,-5,-6,-23,-23,-21,-23,-23,-18,-19,-4,-7,-8,-10,-13,-11,-14,-15,-16,-17"),f=[6,25,26,12,1,2,5,17,11,32,30,31,B,B,B,27,28,29],u=[4,8,8,7,1,2,3,5,6,9,8,8,B,B,B,4,7,7],p=[B,4,5,4,-2,-3,1,-4,-13,-22],_=[B,B,B,B,16,B,B,B,13,B],y=d.large_array_unpack("0,0,racc_error,2,18,_reduce_1,0,19,_reduce_2,1,19,_reduce_3,4,20,_reduce_4,1,22,_reduce_5,1,22,_reduce_6,3,23,_reduce_7,3,23,_reduce_8,1,23,_reduce_none,3,24,_reduce_10,4,24,_reduce_11,1,24,_reduce_none,0,26,_reduce_13,1,26,_reduce_14,1,26,_reduce_15,1,26,_reduce_16,1,26,_reduce_17,2,25,_reduce_18,2,25,_reduce_19,1,25,_reduce_none,3,21,_reduce_21,1,21,_reduce_22"),se=O(!1,0,"error",1,"NUMBER",2,"T",3,"Y",4,"Z",5,"R",6,"U",7,"C",8,"F",9,"S",10,"PLUS",11,"MINUS",12,"ASTERISK",13,"SLASH",14,"PARENL",15,"PARENR",16),E(de[0],"Racc_arg",[F,g,c,l,f,u,_,p,17,y,se,37,23,!0]),E(de[0],"Racc_token_to_s_table",["$end","error","NUMBER","T","Y","Z","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","$start","expr","secret","notation","term","show_zeros","add","mul","unary","round_type"]),E(de[0],"Racc_debug_parser",!1),x(k,"$_reduce_1",function($e,be,he){return Z(N("Node"),"Command").$new(Y(["secret","notation"],{secret:$e["$[]"](0),notation:$e["$[]"](1)}))}),x(k,"$_reduce_2",G(!1)),x(k,"$_reduce_3",G(!0)),x(k,"$_reduce_4",function($e,be,he){return Z(N("Node"),"Notation").$new(Y(["times","sides","show_zeros"],{times:$e["$[]"](0),sides:$e["$[]"](3),show_zeros:$e["$[]"](2)}))}),x(k,"$_reduce_5",G(!1)),x(k,"$_reduce_6",G(!0)),x(k,"$_reduce_7",function($e,be,he){return Z(Z(N("Arithmetic"),"Node"),"BinaryOp").$new($e["$[]"](0),"+",$e["$[]"](2))}),x(k,"$_reduce_8",function($e,be,he){return Z(Z(N("Arithmetic"),"Node"),"BinaryOp").$new($e["$[]"](0),"-",$e["$[]"](2))}),x(k,"$_reduce_10",function($e,be,he){return Z(Z(N("Arithmetic"),"Node"),"BinaryOp").$new($e["$[]"](0),"*",$e["$[]"](2))}),x(k,"$_reduce_11",function($e,be,he){return $e["$[]"](3).$new($e["$[]"](0),$e["$[]"](2))}),x(k,"$_reduce_13",function($e,be,he){return Z(Z(N("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),x(k,"$_reduce_14",function($e,be,he){return Z(Z(N("Arithmetic"),"Node"),"DivideWithCeil")}),x(k,"$_reduce_15",function($e,be,he){return Z(Z(N("Arithmetic"),"Node"),"DivideWithCeil")}),x(k,"$_reduce_16",function($e,be,he){return Z(Z(N("Arithmetic"),"Node"),"DivideWithRound")}),x(k,"$_reduce_17",function($e,be,he){return Z(Z(N("Arithmetic"),"Node"),"DivideWithFloor")}),x(k,"$_reduce_18",function($e,be,he){return $e["$[]"](1)}),x(k,"$_reduce_19",function($e,be,he){return Z(Z(N("Arithmetic"),"Node"),"Negative").$new($e["$[]"](1))}),x(k,"$_reduce_21",function($e,be,he){return $e["$[]"](1)}),x(k,"$_reduce_22",function($e,be,he){return Z(Z(N("Arithmetic"),"Node"),"Number").$new($e["$[]"](0))}),x(k,"$_reduce_none",function($e,be,he){return $e["$[]"](0)})},Opal.modules["bcdice/common_command/tally_dice"]=function(d){var D,T,q,A,L,S,K,I,oe,B,H=d.module,ee=d.const_set,$=d.thrower,x=d.def,E=[],Y=d.nil;return d.top.$require("bcdice/common_command/tally_dice/parser"),D=E,T=B=[H(E[0],"BCDice")].concat(D),q=oe=[H(B[0],"CommonCommand")].concat(T),ee((I=[K=H(oe[0],"TallyDice")].concat(q))[0],"PREFIX_PATTERN",/\d+T[YZ]\d+/.$freeze()),L=[A=d.get_singleton_class(K)].concat(I),S=d.$r(L),x(A,"$eval",function(v,P,R){try{var k;return $("eval_return"),(k=S("Parser").$parse(v))===Y||null==k?Y:k.$eval(P,R)}catch(N){if(N===d.t_eval_return)return N.$v;throw N}})},Opal.modules["bcdice/common_command/calc/node"]=function(d){var j,K,L,P,N,F,g,l,te,M,A,z,H=d.module,ee=d.klass,$=d.ensure_kwargs,x=d.get_kwarg,O=d.def,E=d.truthy,Y=d.send,G=d.thrower,W=[],B=d.nil,Z=d.$$$;return d.top.$require("bcdice/arithmetic/node"),j=W,K=z=[H(W[0],"BCDice")].concat(j),L=A=[H(z[0],"CommonCommand")].concat(K),P=M=[H(A[0],"Calc")].concat(L),N=te=[H(M[0],"Node")].concat(P),g=[F=ee(te[0],null,"Command")].concat(N),l=d.$r(g),F.$$prototype.expr=B,O(F,"$initialize",function(u){var p,_;return u=$(u),p=x(u,"secret"),_=x(u,"expr"),this.secret=p,this.expr=_}),O(F,"$eval",function(u){try{G("eval_return");var y,m,_=this;return y=function(){try{return _.expr.$eval(u).$to_i()}catch(ne){if(!d.rescue(ne,[l("ZeroDivisionError")]))throw ne;try{return"\u30bc\u30ed\u9664\u7b97\u304c\u767a\u751f\u3057\u305f\u305f\u3081\u8a08\u7b97\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f"}finally{d.pop_exception()}}}(),m=E(_.expr["$is_a?"](Z(Z(l("Arithmetic"),"Node"),"Parenthesis")))?_.expr.$output():"("+_.expr.$output()+")",Y(l("Result").$new(),"tap",[],function ne(se){var Ee,ke=null==ne.$$s?this:ne.$$s;return null==ke.secret&&(ke.secret=B),null==se&&(se=B),se["$secret="](ke.secret),Y(se,"text=",Ee=["c"+m+" \uff1e "+y]),Ee[Ee.length-1]},{$$s:_})}catch(ne){if(ne===d.t_eval_return)return ne.$v;throw ne}})},Opal.modules["bcdice/common_command/calc/parser"]=function(d){var j,K,L,te,F,g,l,c,f,u,p,_,y,se,k,de,N,M,v,A,z,H=d.module,ee=d.klass,$=d.defs,x=d.def,O=d.hash,E=d.const_set,Y=d.hash2,G=d.return_val,D=d.top,W=[],B=d.nil,Z=d.$$$;return D.$require("racc/parser.rb"),D.$require("bcdice/common_command/lexer"),D.$require("bcdice/common_command/calc/node"),D.$require("bcdice/arithmetic/node"),j=W,K=z=[H(W[0],"BCDice")].concat(j),L=A=[H(z[0],"CommonCommand")].concat(K),M=[H(A[0],"Calc")].concat(L),v=d.$r(M),te=M,de=[k=ee(M[0],Z(v("Racc"),"Parser"),"Parser")].concat(te),N=d.$r(de),k.$$prototype.lexer=B,$(k,"$parse",function($e){return this.$new().$parse($e)}),x(k,"$parse",function($e){try{return this.lexer=N("Lexer").$new($e),this.$do_parse()}catch(he){if(!d.rescue(he,[N("ParseError")]))throw he;try{return B}finally{d.pop_exception()}}}),k.$private(),x(k,"$next_token",function(){return this.lexer.$next_token()}),F=d.large_array_unpack("14,3,14,15,16,4,10,11,10,11,13,14,13,14,17,18,5,10,11,10,11,13,14,13,14,17,18,6,10,11,10,11,13,14,13,14,17,18,,10,11,10,11,13,,13,15,16,,,,26,30,28,29,31"),g=d.large_array_unpack("5,0,10,7,7,1,5,5,10,10,5,11,10,13,8,8,2,11,11,13,13,11,15,13,16,22,22,4,15,15,16,16,15,17,16,18,23,23,,17,17,18,18,17,,18,21,21,,,,21,25,25,25,25"),l=[-6,5,11,B,27,-2,B,-5,4,B,0,9,B,11,B,20,22,31,33,B,B,38,15,26,B,49,B,B,B,B,B,B],c=[-2,-20,-20,-3,-20,-20,32,-1,-6,-9,-20,-20,-17,-20,-19,-20,-20,-20,-20,-15,-16,-20,-4,-5,-7,-10,-18,-8,-11,-12,-13,-14],f=[7,1,19,20,22,23,2,27,21,24,25],u=[3,1,5,5,4,4,2,6,3,5,5],p=[B,1,6,-5,-11,-8,-18,B],_=[B,B,B,B,8,9,B,12],y=d.large_array_unpack("0,0,racc_error,3,15,_reduce_1,0,16,_reduce_2,1,16,_reduce_3,3,17,_reduce_4,3,17,_reduce_5,1,17,_reduce_none,3,18,_reduce_7,4,18,_reduce_8,1,18,_reduce_none,0,20,_reduce_10,1,20,_reduce_11,1,20,_reduce_12,1,20,_reduce_13,1,20,_reduce_14,2,19,_reduce_15,2,19,_reduce_16,1,19,_reduce_none,3,21,_reduce_18,1,21,_reduce_19"),se=O(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"S",7,"PLUS",8,"MINUS",9,"ASTERISK",10,"SLASH",11,"PARENL",12,"PARENR",13),E(de[0],"Racc_arg",[F,g,c,l,f,u,_,p,14,y,se,32,20,!0]),E(de[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","$start","expr","secret","add","mul","unary","round_type","term"]),E(de[0],"Racc_debug_parser",!1),x(k,"$_reduce_1",function($e,be,he){return Z(N("Node"),"Command").$new(Y(["secret","expr"],{secret:$e["$[]"](0),expr:$e["$[]"](2)}))}),x(k,"$_reduce_2",G(!1)),x(k,"$_reduce_3",G(!0)),x(k,"$_reduce_4",function($e,be,he){return Z(Z(N("Arithmetic"),"Node"),"BinaryOp").$new($e["$[]"](0),"+",$e["$[]"](2))}),x(k,"$_reduce_5",function($e,be,he){return Z(Z(N("Arithmetic"),"Node"),"BinaryOp").$new($e["$[]"](0),"-",$e["$[]"](2))}),x(k,"$_reduce_7",function($e,be,he){return Z(Z(N("Arithmetic"),"Node"),"BinaryOp").$new($e["$[]"](0),"*",$e["$[]"](2))}),x(k,"$_reduce_8",function($e,be,he){return $e["$[]"](3).$new($e["$[]"](0),$e["$[]"](2))}),x(k,"$_reduce_10",function($e,be,he){return Z(Z(N("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),x(k,"$_reduce_11",function($e,be,he){return Z(Z(N("Arithmetic"),"Node"),"DivideWithCeil")}),x(k,"$_reduce_12",function($e,be,he){return Z(Z(N("Arithmetic"),"Node"),"DivideWithCeil")}),x(k,"$_reduce_13",function($e,be,he){return Z(Z(N("Arithmetic"),"Node"),"DivideWithRound")}),x(k,"$_reduce_14",function($e,be,he){return Z(Z(N("Arithmetic"),"Node"),"DivideWithFloor")}),x(k,"$_reduce_15",function($e,be,he){return $e["$[]"](1)}),x(k,"$_reduce_16",function($e,be,he){return Z(Z(N("Arithmetic"),"Node"),"Negative").$new($e["$[]"](1))}),x(k,"$_reduce_18",function($e,be,he){return Z(Z(N("Arithmetic"),"Node"),"Parenthesis").$new($e["$[]"](1))}),x(k,"$_reduce_19",function($e,be,he){return Z(Z(N("Arithmetic"),"Node"),"Number").$new($e["$[]"](0))}),x(k,"$_reduce_none",function($e,be,he){return $e["$[]"](0)})},Opal.modules["bcdice/common_command/calc"]=function(d){var D,T,q,A,L,S,K,I,oe,B,H=d.module,ee=d.const_set,$=d.thrower,x=d.def,E=[],Y=d.nil;return d.top.$require("bcdice/common_command/calc/parser"),D=E,T=B=[H(E[0],"BCDice")].concat(D),q=oe=[H(B[0],"CommonCommand")].concat(T),ee((I=[K=H(oe[0],"Calc")].concat(q))[0],"PREFIX_PATTERN",/C[+\-(]*\d+/.$freeze()),L=[A=d.get_singleton_class(K)].concat(I),S=d.$r(L),x(A,"$eval",function(v,P,R){try{var k;return $("eval_return"),(k=S("Parser").$parse(v))===Y||null==k?Y:k.$eval(P.$round_type())}catch(N){if(N===d.t_eval_return)return N.$v;throw N}})},Opal.modules["bcdice/common_command/choice"]=function(d){var A,M,k,c,u,de,N,F,g,P,L,H=d.module,ee=d.klass,$=d.const_set,x=d.hash2,O=d.def,E=d.truthy,Y=d.eqeq,G=d.eqeqeq,D=d.send,W=d.rb_lt,B=d.thrower,Z=d.rb_gt,T=d.ensure_kwargs,j=d.get_kwarg,z=[],q=d.nil,K=d.$$$;return d.top.$require("strscan"),A=z,M=L=[H(z[0],"BCDice")].concat(A),k=P=[H(L[0],"CommonCommand")].concat(M),N=[de=ee(P[0],null,"Choice")].concat(k),F=d.$r(N),(g=de.$$prototype).items=g.takes=g.block_delimiter=q,$(N[0],"PREFIX_PATTERN",/choice/.$freeze()),c=N,$((u=[H(N[0],"BlockDelimiter")].concat(c))[0],"BRACKET","bracket"),$(u[0],"PAREN","paren"),$(u[0],"SPACE","space"),$(N[0],"DELIMITER",x(["bracket","paren","space"],{bracket:/,/,paren:/,/,space:/\s+/}).$freeze()),$(N[0],"DELIMITER_CHAR",x(["bracket","paren","space"],{bracket:", ",paren:", ",space:" "}).$freeze()),$(N[0],"TERMINATION",x(["bracket","paren","space"],{bracket:/\]/,paren:/\)/,space:/$/}).$freeze()),$(N[0],"SUFFIX",x(["bracket","paren","space"],{bracket:"]",paren:")",space:""}).$freeze()),function(l,c){var f=[l].concat(c),u=d.$r(f);O(l,"$eval",function(_,y,m){var ne;return(ne=this.$parse(_))===q||null==ne?q:ne.$roll(m)}),l.$private(),O(l,"$parse",function(_){try{var m,Ee,Me,$e,be,y=B("return"),se=q,ke=q,ce=q,he=q,Se=q,ve=q;if((se=u("StringScanner").$new(_)).$skip(/\s+/),Ee=se.$scan(/S/i)["$nil?"]()["$!"](),!E(se.$scan(/choice/i))||(ke=E(ce=(m=se.$scan(/\d+/))===q||null==m?q:m.$to_i())?ce:1,Y(ke,0)))return q;for(Me=G("[",ce=se.$scan(/\(|\[|\s+/))?K(u("BlockDelimiter"),"BRACKET"):G("(",ce)?K(u("BlockDelimiter"),"PAREN"):G(u("String"),ce)?K(u("BlockDelimiter"),"SPACE"):void y.$throw(),$e=u("DELIMITER")["$[]"](Me),be=u("TERMINATION")["$[]"](Me),he=[];E(Se=se.$scan_until($e));)he.$push(Se.$delete_suffix(","));return ve=se.$scan_until(be),!E(ve)||(he.$push(ve.$delete_suffix(u("SUFFIX")["$[]"](Me))),he=D(D(he,"map",[],"strip".$to_proc()),"reject",[],"empty?".$to_proc()),Y(he.$size(),1)&&(he=this.$parse_multi_item_shorthand(he.$first())),E(he["$empty?"]())||E(W(he.$size(),ke)))?q:this.$new(x(["secret","block_delimiter","takes","items"],{secret:Ee,block_delimiter:Me,takes:ke,items:he}))}catch(ae){if(ae===y)return ae.$v;throw ae}}),O(l,"$parse_multi_item_shorthand",function(_){var m,ne;return E(m=E(ne=this.$parse_multi_nums_shorthand(_))?ne:this.$parse_multi_chars_shorthand(_))?m:[]}),O(l,"$parse_multi_nums_shorthand",function(_){var y=q,m=q,ne=q;return y=/^(\d+)-(\d+)$/.$match(_),!E(y)||(m=y["$[]"](1).$to_i(),ne=y["$[]"](2).$to_i(),E(Z(m,ne)))?q:m.$upto(ne).$to_a()}),O(l,"$parse_multi_chars_shorthand",function(_){var m,y=q,ne=q,se=q;return y=E(m=/^([a-z])-([a-z])$/.$match(_))?m:/^([A-Z])-([A-Z])$/.$match(_),!E(y)||(ne=y["$[]"](1),se=y["$[]"](2),E(Z(ne,se)))?q:ne.$upto(se).$to_a()})}(d.get_singleton_class(de),N),O(de,"$initialize",function(c){var f,u,p,_,y=this;return c=T(c),f=j(c,"secret"),u=j(c,"block_delimiter"),p=j(c,"takes"),_=j(c,"items"),y.secret=f,y.block_delimiter=u,y.takes=p,y.items=_}),O(de,"$roll",function(c){var f=this,u=q,p=q;return E(Z(f.items.$size(),100))?F("Result").$new("\u9805\u76ee\u6570\u306f100\u4ee5\u4e0b\u3068\u3057\u3066\u304f\u3060\u3055\u3044"):(u=f.items.$dup(),p=[],D(f.takes,"times",[],function(){var y;return y=c.$roll_index(u.$size()),p["$<<"](u.$delete_at(y))}),D(F("Result").$new(),"tap",[],function _(y){var m,se,ne=null==_.$$s?this:_.$$s;return null==ne.block_delimiter&&(ne.block_delimiter=q),null==ne.secret&&(ne.secret=q),null==y&&(y=q),se=p.$join(F("DELIMITER_CHAR")["$[]"](ne.block_delimiter)),y["$secret="](ne.secret),m=["("+ne.$expr()+") \uff1e "+se],D(y,"text=",m),m[m.length-1]},{$$s:f}))}),O(de,"$expr",function(){var f,u,c=this;return f=Y(c.takes,1)?q:c.takes,G(K(F("BlockDelimiter"),"SPACE"),u=c.block_delimiter)?"choice"+f+" "+c.items.$join(" "):G(K(F("BlockDelimiter"),"BRACKET"),u)?"choice"+f+"["+c.items.$join(",")+"]":G(K(F("BlockDelimiter"),"PAREN"),u)?"choice"+f+"("+c.items.$join(",")+")":q})},Opal.modules["bcdice/common_command/d66_dice"]=function(d){var K,L,R,F,l,c,te,k,de,M,A,H=d.module,ee=d.klass,$=d.const_set,x=d.thrower,O=d.def,E=d.truthy,Y=d.hash2,G=d.ensure_kwargs,D=d.get_kwarg,W=d.send,B=d.eqeqeq,Z=d.rb_plus,T=d.rb_times,j=[],oe=d.nil,z=d.$$$;return K=j,L=A=[H(j[0],"BCDice")].concat(K),R=M=[H(A[0],"CommonCommand")].concat(L),k=[te=ee(M[0],null,"D66Dice")].concat(R),de=d.$r(k),te.$$prototype.sort_type=oe,$(k[0],"PREFIX_PATTERN",/D66/.$freeze()),l=[F=d.get_singleton_class(te)].concat(k),c=d.$r(l),O(F,"$eval",function(u,p,_){try{var m;return x("eval_return"),(m=this.$parse(u,p))===oe||null==m?oe:m.$eval(_)}catch(Ee){if(Ee===d.t_eval_return)return Ee.$v;throw Ee}}),F.$private(),O(F,"$parse",function(u,p){var y=oe,m=oe;return u=u.$split(" ",2).$first(),y=/^(S)?D66([ANSD])?$/i.$match(u.$upcase()),E(y)?this.$new(Y(["secret","sort_type","suffix"],{secret:y["$[]"](1)["$nil?"]()["$!"](),sort_type:E(m=this.$sort_type_from_suffix(y["$[]"](2)))?m:p.$d66_sort_type(),suffix:y["$[]"](2)})):oe}),O(F,"$sort_type_from_suffix",function(u){switch(u){case"A":case"S":return z(c("D66SortType"),"ASC");case"D":return z(c("D66SortType"),"DESC");case"N":return z(c("D66SortType"),"NO_SORT");default:return oe}}),O(te,"$initialize",function(g){var l,c,f,u=this;return g=G(g),l=D(g,"secret"),c=D(g,"sort_type"),f=D(g,"suffix"),u.secret=l,u.sort_type=c,u.suffix=f}),O(te,"$eval",function(g){var c;return c=this.$roll(g),W(de("Result").$new(),"tap",[],function f(u){var p,_=null==f.$$s?this:f.$$s;return null==_.secret&&(_.secret=oe),null==_.suffix&&(_.suffix=oe),null==u&&(u=oe),u["$secret="](_.secret),W(u,"text=",p=["(D66"+_.suffix+") \uff1e "+c]),p[p.length-1]},{$$s:this})}),te.$private(),O(te,"$roll",function(g){var f,c=oe;return c=W(de("Array"),"new",[2],function(){return g.$roll_once(6)}),B(z(de("D66SortType"),"ASC"),f=this.sort_type)?c["$sort!"]():B(z(de("D66SortType"),"DESC"),f)&&c["$sort!"]()["$reverse!"](),Z(T(c["$[]"](0),10),c["$[]"](1))})},Opal.modules["bcdice/common_command/repeat"]=function(d){var q,J,P,N,g,l,R,te,k,de,S,I,H=d.module,ee=d.klass,$=d.const_set,x=d.def,O=d.truthy,E=d.hash2,Y=d.ensure_kwargs,G=d.get_kwarg,D=d.send,W=d.eqeq,B=d.thrower,Z=d.rb_lt,j=[],oe=d.nil;return d.top.$require("strscan"),q=j,J=I=[H(j[0],"BCDice")].concat(q),P=S=[H(I[0],"CommonCommand")].concat(J),te=[R=ee(S[0],null,"Repeat")].concat(P),k=d.$r(te),(de=R.$$prototype).times=de.trailer=de.secret=oe,$(te[0],"PREFIX_PATTERN",/(repeat|rep|x)\d+/.$freeze()),$(te[0],"REPEAT_LIMIT",100),g=[N=d.get_singleton_class(R)].concat(te),l=d.$r(g),x(N,"$eval",function(f,u,p){var _;return(_=this.$parse(f))===oe||null==_?oe:_.$roll(u,p)}),N.$private(),x(N,"$parse",function(f){var u,y,_=oe,m=oe,ne=oe,se=oe,Ee=oe;return y=(_=l("StringScanner").$new(f)).$scan(/s/i)["$nil?"]()["$!"](),m=_.$scan(/repeat|rep|x/i),ne=(u=_.$scan(/\d+/))===oe||null==u?oe:u.$to_i(),se=_.$scan(/\s+/),O(m["$nil?"]())||O(ne["$nil?"]())||O(se["$nil?"]())||(Ee=_.$post_match(),O(Ee["$nil?"]())||O(Ee["$empty?"]()))?oe:this.$new(E(["secret","times","trailer"],{secret:y,times:ne,trailer:Ee}))}),x(R,"$initialize",function(F){var g,l,c,f=this;return F=Y(F),g=G(F,"secret"),l=G(F,"times"),c=G(F,"trailer"),f.secret=g,f.times=l,f.trailer=c}),x(R,"$roll",function(F,g){try{B("eval_return");var f,c=this,u=oe,p=oe,_=oe,y=oe;return f=c.$validate(),O(f)?f:(u=D(k("Array"),"new",[c.times],function m(){var ne=null==m.$$s?this:m.$$s,se=oe;return null==ne.trailer&&(ne.trailer=oe),(se=F.$class().$new(ne.trailer))["$randomizer="](g),se.$eval()},{$$s:c}),W(D(u,"count",[],function(ne){return null==ne&&(ne=oe),ne["$=="](oe)}),c.times)?c.$result_with_text("\u7e70\u308a\u8fd4\u3057\u5bfe\u8c61\u306e\u30b3\u30de\u30f3\u30c9\u304c\u5b9f\u884c\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f ("+c.trailer+")"):(p=D(u.$map(),"with_index",[1],function(ne,se){return null==ne&&(ne=oe),null==se&&(se=oe),"#"+se+"\n"+ne.$text()}).$join("\n\n"),_=O(y=c.secret)?y:D(u,"any?",[],"secret?".$to_proc()),D(k("Result").$new(),"tap",[],function(ne){var se;return null==ne&&(ne=oe),ne["$secret="](_),D(ne,"text=",se=[p]),se[se.length-1]})))}catch(m){if(m===d.t_eval_return)return m.$v;throw m}}),R.$private(),x(R,"$validate",function(){var F=this;return O(/^(repeat|rep|x)\d+/["$match?"](F.trailer))?F.$result_with_text("Repeat\u30b3\u30de\u30f3\u30c9\u306e\u91cd\u8907\u306f\u3067\u304d\u307e\u305b\u3093"):O(Z(F.times,1))||O(Z(k("REPEAT_LIMIT"),F.times))?F.$result_with_text("\u7e70\u308a\u8fd4\u3057\u56de\u6570\u306f1\u4ee5\u4e0a\u3001"+k("REPEAT_LIMIT")+"\u4ee5\u4e0b\u3068\u3057\u3066\u304f\u3060\u3055\u3044"):oe}),x(R,"$result_with_text",function(F){return D(k("Result").$new(),"tap",[],function l(c){var f,u=null==l.$$s?this:l.$$s;return null==u.secret&&(u.secret=oe),null==c&&(c=oe),c["$secret="](u.secret),D(c,"text=",f=[F]),f[f.length-1]},{$$s:this})})},Opal.modules["bcdice/format"]=function(d){var W,j,oe,z,q,Z,H=d.module,ee=d.eqeqeq,$=d.def,x=d.truthy,O=d.eqeq,E=d.rb_gt,Y=[],G=d.nil;return W=Y,j=Z=[H(Y[0],"BCDice")].concat(W),z=[oe=H(Z[0],"Format")].concat(j),q=d.$r(z),oe.$module_function(),$(oe,"$comparison_operator",function(I){var A;return ee("==",A=I)?"=":ee("!=",A)?"<>":ee(q("Symbol"),A)?I.$to_s():G}),$(oe,"$modifier",function(I){return x(I["$nil?"]())?G:O(I,0)?"":x(E(I,0))?"+"+I:I.$to_s()})},Opal.modules["bcdice/common_command/barabara_dice/result"]=function(d){var B,oe,I,M,q,T,H=d.module,ee=d.klass,$=d.send2,x=d.find_super,O=d.def,Y=[],G=d.nil,D=d.$$$;return d.top.$require("bcdice/result"),B=Y,oe=T=[H(Y[0],"BCDice")].concat(B),I=q=[H(T[0],"CommonCommand")].concat(oe),(M=ee([H(q[0],"BarabaraDice")].concat(I)[0],D(D("BCDice"),"Result"),"Result")).$attr_accessor("last_dice_list_list"),M.$attr_accessor("last_dice_list"),M.$attr_accessor("success_num"),O(M,"$initialize",function v(P){var te=this;return v.$$p=null,null==P&&(P=G),$(te,x(te,"initialize",v,!1,!0),"initialize",[P],null),te.last_dice_list_list=[],te.last_dice_list=[],te.success_num=0},-1)},Opal.modules["bcdice/common_command/barabara_dice/node"]=function(d){var T,q,J,v,de,N,F,g,l,R,S,I,oe,H=d.module,ee=d.klass,$=d.ensure_kwargs,x=d.get_kwarg,O=d.def,E=d.send,Y=d.truthy,G=d.thrower,D=d.top,W=[],B=d.nil;return D.$require("bcdice/format"),D.$require("bcdice/common_command/barabara_dice/result"),T=W,q=oe=[H(W[0],"BCDice")].concat(T),J=I=[H(oe[0],"CommonCommand")].concat(q),v=S=[H(I[0],"BarabaraDice")].concat(J),de=R=[H(S[0],"Node")].concat(v),F=[N=ee(R[0],null,"Command")].concat(de),g=d.$r(F),(l=N.$$prototype).notations=l.cmp_op=l.target_number=B,O(N,"$initialize",function(f){var u,p,_,y,m=this;return f=$(f),u=x(f,"secret"),p=x(f,"notations"),_=x(f,"cmp_op"),y=x(f,"target_number"),m.secret=u,m.notations=p,m.cmp_op=_,m.target_number=y}),O(N,"$eval",function(f,u){try{G("eval_return");var _,m,se,ke,$e,be,y=this,ne=B,Ee=B,ce=B,Me=B,he=B,Se=B;return m=f.$round_type(),ne=E(y.notations,"map",[],function(ae){return null==ae&&(ae=B),ae.$to_dice(m)}),se=Y(Ee=y.cmp_op)?Ee:f.$default_cmp_op(),ke=Y(Ee=(_=y.target_number)===B||null==_?B:_.$eval(m))?Ee:f.$default_target_number(),ce=E(ne,"map",[],function(ae){return null==ae&&(ae=B),ae.$roll(u)}),Y(f["$sort_barabara_dice?"]())&&E(ce,"map!",[],"sort".$to_proc()),$e=(Me=ce.$flatten()).$count(1),be=Y(se)?E(Me,"count",[],function(ae){return null==ae&&(ae=B),ae.$send(se,ke)}):0,Y(se)&&(he="\u6210\u529f\u6570"+be),Se=["("+ne.$join("+")+g("Format").$comparison_operator(se)+ke+")",Me.$join(","),he,f.$grich_text($e,Me.$size(),be)].$compact(),E(g("Result").$new(),"tap",[],function ve(ae){var ue,Ce=null==ve.$$s?this:ve.$$s;return null==Ce.secret&&(Ce.secret=B),null==ae&&(ae=B),ae["$secret="](Ce.secret),ae["$text="](Se.$join(" \uff1e ")),ae["$last_dice_list_list="](ce),ae["$last_dice_list="](Me),E(ae,"success_num=",ue=[be]),ue[ue.length-1]},{$$s:y})}catch(ve){if(ve===d.t_eval_return)return ve.$v;throw ve}}),function(te,k,de){var N=ee(te,null,"Notation"),F=[N].concat(de),g=d.$r(F),l=N.$$prototype;l.times=l.sides=B,O(N,"$initialize",function(f,u){return this.times=f,this.sides=u}),O(N,"$to_dice",function(f){try{var _,y;return G("eval_return"),_=this.times.$eval(f),y=this.sides.$eval(f),g("Dice").$new(_,y)}catch(m){if(m===d.t_eval_return)return m.$v;throw m}})}(R[0],0,R),function(te,k){var de=ee(te,null,"Dice"),N=de.$$prototype;return N.times=N.sides=B,O(de,"$initialize",function(g,l){return this.times=g,this.sides=l}),O(de,"$roll",function(g){return g.$roll_barabara(this.times,this.sides)}),O(de,"$to_s",function(){return this.times+"B"+this.sides})}(R[0])},Opal.modules["bcdice/common_command/reroll_dice/parser"]=function(d){var z,A,M,de,l,c,f,u,p,_,y,m,ne,ke,N,F,g,P,R,L,K,H=d.module,ee=d.klass,$=d.defs,x=d.def,O=d.hash,E=d.const_set,Y=d.hash2,G=d.return_val,D=d.to_ary,W=d.truthy,B=d.top,Z=[],T=d.nil,j=d.$$$;return B.$require("racc/parser.rb"),B.$require("bcdice/common_command/lexer"),B.$require("bcdice/common_command/barabara_dice/node"),B.$require("bcdice/arithmetic/node"),z=Z,A=K=[H(Z[0],"BCDice")].concat(z),M=L=[H(K[0],"CommonCommand")].concat(A),P=[H(L[0],"RerollDice")].concat(M),R=d.$r(P),de=P,F=[N=ee(P[0],j(R("Racc"),"Parser"),"Parser")].concat(de),g=d.$r(F),N.$$prototype.lexer=T,$(N,"$parse",function(he){return this.$new().$parse(he)}),x(N,"$parse",function(he){try{return this.lexer=g("Lexer").$new(he),this.$do_parse()}catch(ve){if(!d.rescue(ve,[g("ParseError")]))throw ve;try{return T}finally{d.pop_exception()}}}),N.$private(),x(N,"$next_token",function(){return this.lexer.$next_token()}),l=d.large_array_unpack("9,3,9,9,9,15,20,21,20,21,8,14,8,8,8,9,9,4,13,28,10,39,20,21,9,8,8,31,32,9,20,21,33,16,8,20,21,9,24,8,34,35,9,20,21,31,32,8,20,21,9,13,8,31,32,9,20,21,34,35,8,20,21,9,,8,34,35,9,20,21,31,32,8,20,21,9,,8,,31,32,20,21,31,32,8,40,,,,47,51,49,50,52"),c=d.large_array_unpack("14,0,24,2,15,5,14,14,24,24,14,5,24,2,15,16,8,1,5,14,4,24,8,8,13,16,8,17,17,20,13,13,17,7,13,20,20,21,11,20,18,18,28,21,21,26,26,21,28,28,31,12,28,38,38,32,31,31,42,42,31,32,32,34,,32,43,43,35,34,34,46,46,34,35,35,39,,35,,27,27,39,39,41,41,39,27,,,,41,45,45,45,45"),f=d.large_array_unpack("-6,17,1,,20,-3,,30,14,,,18,30,22,-2,2,13,19,30,,27,35,,,0,,37,72,40,,,48,53,,61,66,,,45,74,,76,48,56,,89,63,,,,,,"),u=d.large_array_unpack("-4,-31,-31,-5,-31,-6,-13,-31,-31,-30,53,-1,-6,-31,-31,-31,-31,-31,-17,-20,-31,-31,-28,-3,-31,-2,-7,-31,-31,-12,-14,-31,-31,-29,-31,-31,-26,-27,-10,-31,-8,-31,-15,-16,-18,-21,-11,-9,-19,-22,-23,-24,-25"),p=[17,7,11,36,37,26,27,1,6,25,42,43,2,5,7,30,38,44,45,12,41,29,23,48,T,T,T,T,T,T,T,46],_=[7,9,4,11,11,7,7,1,8,4,10,10,2,3,9,9,7,11,11,5,7,8,6,12,T,T,T,T,T,T,T,7],y=[T,7,12,11,-3,14,11,-8,6,-1,-21,-17,-22],m=[T,T,T,T,T,T,T,T,T,22,18,19,T],ne=d.large_array_unpack("0,0,racc_error,3,23,_reduce_1,4,23,_reduce_2,4,23,_reduce_3,0,24,_reduce_4,1,24,_reduce_5,0,26,_reduce_6,2,26,_reduce_7,3,27,_reduce_8,4,27,_reduce_9,2,28,_reduce_10,3,28,_reduce_11,3,25,_reduce_12,1,25,_reduce_13,3,30,_reduce_14,3,29,_reduce_15,3,29,_reduce_16,1,29,_reduce_none,3,32,_reduce_18,4,32,_reduce_19,1,32,_reduce_none,0,34,_reduce_21,1,34,_reduce_22,1,34,_reduce_23,1,34,_reduce_24,1,34,_reduce_25,2,33,_reduce_26,2,33,_reduce_27,1,33,_reduce_none,3,31,_reduce_29,1,31,_reduce_30"),ke=O(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"S",7,"PLUS",8,"MINUS",9,"ASTERISK",10,"SLASH",11,"PARENL",12,"PARENR",13,"BRACKETL",14,"BRACKETR",15,"LESS",16,"GREATER",17,"EQUAL",18,"NOT",19,"AT",20,"CMP_OP",21),E(F[0],"Racc_arg",[l,c,u,f,p,_,m,y,22,ne,ke,53,31,!0]),E(F[0],"Racc_token_to_s_table",d.large_array_unpack("$end,error,NUMBER,R,U,C,F,S,PLUS,MINUS,ASTERISK,SLASH,PARENL,PARENR,BRACKETL,BRACKETR,LESS,GREATER,EQUAL,NOT,AT,CMP_OP,$start,expr,secret,notations,target,bracket,at,add,dice,term,mul,unary,round_type")),E(F[0],"Racc_debug_parser",!1),x(N,"$_reduce_1",function(he,Se,ve){return j(g("Node"),"Command").$new(Y(["secret","notations","cmp_op","target_number","source"],{secret:he["$[]"](0),notations:he["$[]"](1),cmp_op:he["$[]"](2)["$[]"]("cmp_op"),target_number:he["$[]"](2)["$[]"]("target"),source:this.lexer.$source()}))}),x(N,"$_reduce_2",function(he,Se,ve){var ue=T,Ce=T;return ue=he["$[]"](3),Ce=he["$[]"](2),j(g("Node"),"Command").$new(Y(["secret","notations","cmp_op","target_number","reroll_cmp_op","reroll_threshold","source"],{secret:he["$[]"](0),notations:he["$[]"](1),cmp_op:ue["$[]"]("cmp_op"),target_number:ue["$[]"]("target"),reroll_cmp_op:Ce["$[]"]("cmp_op"),reroll_threshold:Ce["$[]"]("threshold"),source:this.lexer.$source()}))}),x(N,"$_reduce_3",function(he,Se,ve){var ue=T,Ce=T;return ue=he["$[]"](2),Ce=he["$[]"](3),j(g("Node"),"Command").$new(Y(["secret","notations","cmp_op","target_number","reroll_cmp_op","reroll_threshold","source"],{secret:he["$[]"](0),notations:he["$[]"](1),cmp_op:ue["$[]"]("cmp_op"),target_number:ue["$[]"]("target"),reroll_cmp_op:Ce["$[]"]("cmp_op"),reroll_threshold:Ce["$[]"]("threshold"),source:this.lexer.$source()}))}),x(N,"$_reduce_4",G(!1)),x(N,"$_reduce_5",G(!0)),x(N,"$_reduce_6",function(he,Se,ve){return Y([],{})}),x(N,"$_reduce_7",function(he,Se,ve){var ae,b,V;return V=null==(ae=D(he))[1]?T:ae[1],W(b=null==ae[0]?T:ae[0])||this.$raise(g("ParseError")),Y(["cmp_op","target"],{cmp_op:b,target:V})}),x(N,"$_reduce_8",function(he,Se,ve){return Y(["threshold"],{threshold:he["$[]"](1)})}),x(N,"$_reduce_9",function(he,Se,ve){var ue,Ce;return ue=he["$[]"](1),Ce=he["$[]"](2),W(ue)||this.$raise(g("ParseError")),Y(["cmp_op","threshold"],{cmp_op:ue,threshold:Ce})}),x(N,"$_reduce_10",function(he,Se,ve){return Y(["threshold"],{threshold:he["$[]"](1)})}),x(N,"$_reduce_11",function(he,Se,ve){var ue,Ce;return ue=he["$[]"](1),Ce=he["$[]"](2),W(ue)||this.$raise(g("ParseError")),Y(["cmp_op","threshold"],{cmp_op:ue,threshold:Ce})}),x(N,"$_reduce_12",function(he,Se,ve){var ae=T;return(ae=he["$[]"](0)).$push(he["$[]"](2)),ae}),x(N,"$_reduce_13",function(he,Se,ve){return[he["$[]"](0)]}),x(N,"$_reduce_14",function(he,Se,ve){var ae,ue;return ae=he["$[]"](0),ue=he["$[]"](2),j(g("Node"),"Notation").$new(ae,ue)}),x(N,"$_reduce_15",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"+",he["$[]"](2))}),x(N,"$_reduce_16",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"-",he["$[]"](2))}),x(N,"$_reduce_18",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"*",he["$[]"](2))}),x(N,"$_reduce_19",function(he,Se,ve){return he["$[]"](3).$new(he["$[]"](0),he["$[]"](2))}),x(N,"$_reduce_21",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),x(N,"$_reduce_22",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"DivideWithCeil")}),x(N,"$_reduce_23",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"DivideWithCeil")}),x(N,"$_reduce_24",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"DivideWithRound")}),x(N,"$_reduce_25",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"DivideWithFloor")}),x(N,"$_reduce_26",function(he,Se,ve){return he["$[]"](1)}),x(N,"$_reduce_27",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"Negative").$new(he["$[]"](1))}),x(N,"$_reduce_29",function(he,Se,ve){return he["$[]"](1)}),x(N,"$_reduce_30",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"Number").$new(he["$[]"](0))}),x(N,"$_reduce_none",function(he,Se,ve){return he["$[]"](0)})},Opal.modules["bcdice/common_command/reroll_dice"]=function(d){var D,T,q,A,L,S,K,I,oe,B,H=d.module,ee=d.const_set,$=d.thrower,x=d.def,O=d.top,E=[],Y=d.nil;return O.$require("bcdice/normalize"),O.$require("bcdice/format"),O.$require("bcdice/common_command/reroll_dice/parser"),D=E,T=B=[H(E[0],"BCDice")].concat(D),q=oe=[H(B[0],"CommonCommand")].concat(T),ee((I=[K=H(oe[0],"RerollDice")].concat(q))[0],"PREFIX_PATTERN",/\d+R\d+/.$freeze()),ee(I[0],"REROLL_LIMIT",1e4),L=[A=d.get_singleton_class(K)].concat(I),S=d.$r(L),x(A,"$eval",function(v,P,R){try{var k;return $("eval_return"),(k=S("Parser").$parse(v))===Y||null==k?Y:k.$eval(P,R)}catch(N){if(N===d.t_eval_return)return N.$v;throw N}})},Opal.modules["bcdice/common_command/upper_dice/node"]=function(d){var q,J,v,k,l,c,f,u,p,N,R,S,I,H=d.module,ee=d.klass,$=d.ensure_kwargs,x=d.get_kwarg,O=d.def,E=d.send,Y=d.truthy,G=d.rb_le,D=d.thrower,W=d.rb_plus,B=d.eqeq,Z=d.hash2,T=d.rb_lt,j=[],oe=d.nil;return q=j,J=I=[H(j[0],"BCDice")].concat(q),v=S=[H(I[0],"CommonCommand")].concat(J),k=R=[H(S[0],"UpperDice")].concat(v),l=N=[H(R[0],"Node")].concat(k),f=[c=ee(N[0],null,"Command")].concat(l),u=d.$r(f),(p=c.$$prototype).notations=p.reroll_threshold=p.modifier=p.target_number=p.cmp_op=oe,O(c,"$initialize",function(y){var m,ne,se,Ee,ke,ce,Me=this;return y=$(y),m=x(y,"secret"),ne=x(y,"notations"),se=x(y,"modifier"),Ee=x(y,"cmp_op"),ke=x(y,"target_number"),null==(ce=y.$$smap.reroll_threshold)&&(ce=oe),Me.secret=m,Me.notations=ne,Me.modifier=se,Me.cmp_op=Ee,Me.target_number=ke,Me.reroll_threshold=ce}),O(c,"$eval",function(y,m){try{D("eval_return");var se,Ee,ke,Me,$e,be,ve,ue,Se,ae,ce=this,he=oe,Ce=oe,b=oe,V=oe;return Me=y.$round_type(),$e=E(ce.notations,"map",[],function(xe){return null==xe&&(xe=oe),xe.$to_dice(Me)}),be=Y(he=Y(Se=(se=ce.reroll_threshold)===oe||null==se?oe:se.$eval(Me))?Se:y.$upper_dice_reroll_threshold())?he:0,ve=Y(he=(Ee=ce.modifier)===oe||null==Ee?oe:Ee.$eval(Me))?he:0,ae=(ke=ce.target_number)===oe||null==ke?oe:ke.$eval(Me),ue=ce.$expr($e,be,ve,ae),Y(G(be,1))?ce.$result_with_text("("+ue+") \uff1e \u7121\u9650\u30ed\u30fc\u30eb\u306e\u6761\u4ef6\u304c\u307e\u3061\u304c\u3063\u3066\u3044\u307e\u3059"):(Ce=E($e,"map",[],function(xe){return null==xe&&(xe=oe),xe.$roll(m,be,y["$sort_barabara_dice?"]())}).$reduce([],"concat"),b=Y(ce.cmp_op)?ce.$result_success_count(Ce,ve,ae):ce.$result_max_sum(Ce,ve),V=["("+ue+")",ce.$interlim_expr(Ce,ve),b],ce.$result_with_text(V.$join(" \uff1e ")))}catch(ge){if(ge===d.t_eval_return)return ge.$v;throw ge}}),c.$private(),O(c,"$result_success_count",function(y,m,ne){return"\u6210\u529f\u6570"+E(y,"count",[],function ke(ce){var Me=null==ke.$$s?this:ke.$$s;return null==Me.cmp_op&&(Me.cmp_op=oe),null==ce&&(ce=oe),W(ce["$[]"]("sum"),m).$send(Me.cmp_op,ne)},{$$s:this})}),O(c,"$result_max_sum",function(y,m){var se,ne=oe;return ne=E(y,"map",[],function(ce){return null==ce&&(ce=oe),ce["$[]"]("sum")}),se=W(ne.$sum(),m),E(ne,"map",[],function(ce){return null==ce&&(ce=oe),W(ce,m)}).$max()+"/"+se+"(\u6700\u5927/\u5408\u8a08)"}),O(c,"$interlim_expr",function(y,m){var ne;return ne=E(y,"map",[],function(Ee){return null==Ee&&(Ee=oe),B(Ee["$[]"]("list").$size(),1)?Ee["$[]"]("sum"):Ee["$[]"]("sum")+"["+Ee["$[]"]("list").$join(",")+"]"}).$join(","),W(ne,u("Format").$modifier(m))}),O(c,"$expr",function(y,m,ne,se){var ke,ce;return ke=u("Format").$comparison_operator(this.cmp_op),ce=u("Format").$modifier(ne),y.$join("+")+"["+m+"]"+ce+ke+se}),O(c,"$result_with_text",function(y){return E(u("Result").$new(),"tap",[],function ne(se){var Ee,ke=null==ne.$$s?this:ne.$$s;return null==ke.secret&&(ke.secret=oe),null==se&&(se=oe),se["$secret="](ke.secret),E(se,"text=",Ee=[y]),Ee[Ee.length-1]},{$$s:this})}),function(F,g,l){var c=ee(F,null,"Notation"),f=[c].concat(l),u=d.$r(f),p=c.$$prototype;p.roll_times=p.sides=oe,O(c,"$initialize",function(y,m){return this.roll_times=y,this.sides=m}),O(c,"$to_dice",function(y){try{var se,Ee;return D("eval_return"),se=this.roll_times.$eval(y),Ee=this.sides.$eval(y),u("Dice").$new(se,Ee)}catch(ke){if(ke===d.t_eval_return)return ke.$v;throw ke}})}(N[0],0,N),function(F,g,l){var c=ee(F,null,"Dice"),f=[c].concat(l),u=d.$r(f),p=c.$$prototype;return p.roll_times=p.sides=oe,O(c,"$initialize",function(y,m){return this.roll_times=y,this.sides=m}),O(c,"$roll",function(y,m,ne){var Ee=oe;return Ee=E(u("Array"),"new",[this.roll_times],function ke(){var Me=oe;return Me=(null==ke.$$s?this:ke.$$s).$roll_ones(y,m),Z(["sum","list"],{sum:Me.$sum(),list:Me})},{$$s:this}),Y(ne)&&(Ee=E(Ee,"sort_by",[],function(ce){return null==ce&&(ce=oe),ce["$[]"]("sum")})),Ee}),O(c,"$to_s",function(){return this.roll_times+"U"+this.sides}),c.$private(),O(c,"$roll_ones",function(y,m){var ne=this,se=oe;return se=[],function(){try{var Ee=D("break");E(ne,"loop",[],function ke(){var Me,ce=null==ke.$$s?this:ke.$$s;if(null==ce.sides&&(ce.sides=oe),Me=y.$roll_once(ce.sides),se.$push(Me),!Y(T(Me,m)))return oe;Ee.$throw()},{$$s:ne})}catch(ke){if(ke===Ee)return ke.$v;throw ke}}(),se})}(N[0],0,N)},Opal.modules["bcdice/common_command/upper_dice/parser"]=function(d){var z,A,M,de,l,c,f,u,p,_,y,m,ne,ke,N,F,g,P,R,L,K,H=d.module,ee=d.klass,$=d.defs,x=d.def,O=d.hash,E=d.const_set,Y=d.hash2,G=d.return_val,D=d.to_ary,W=d.truthy,B=d.top,Z=[],T=d.nil,j=d.$$$;return B.$require("racc/parser.rb"),B.$require("bcdice/common_command/lexer"),B.$require("bcdice/common_command/upper_dice/node"),B.$require("bcdice/arithmetic/node"),z=Z,A=K=[H(Z[0],"BCDice")].concat(z),M=L=[H(K[0],"CommonCommand")].concat(A),P=[H(L[0],"UpperDice")].concat(M),R=d.$r(P),de=P,F=[N=ee(P[0],j(R("Racc"),"Parser"),"Parser")].concat(de),g=d.$r(F),N.$$prototype.lexer=T,$(N,"$parse",function(he){return this.$new().$parse(he)}),x(N,"$parse",function(he){try{return this.lexer=g("Lexer").$new(he),this.$do_parse()}catch(ve){if(!d.rescue(ve,[g("ParseError")]))throw ve;try{return T}finally{d.pop_exception()}}}),N.$private(),x(N,"$next_token",function(){return this.lexer.$next_token()}),l=d.large_array_unpack("9,9,36,37,3,9,9,21,22,49,8,8,21,22,9,8,8,14,15,9,21,22,4,16,8,21,22,9,10,8,36,37,9,21,22,38,17,8,21,22,9,25,8,27,15,9,21,22,28,29,8,21,22,9,44,8,39,40,9,21,22,39,40,8,21,22,9,25,8,39,40,9,21,22,36,37,8,21,22,9,17,8,39,40,9,21,22,39,40,8,21,22,9,,8,39,40,,21,22,39,40,8,58,56,57,59,36,37"),c=d.large_array_unpack("2,8,34,34,0,17,14,8,8,34,2,8,14,14,15,17,14,5,5,16,15,15,1,5,15,16,16,21,4,16,18,18,22,21,21,18,7,21,22,22,25,11,22,12,12,27,25,25,13,13,25,27,27,28,24,27,19,19,29,28,28,30,30,28,29,29,36,26,29,33,33,37,36,36,45,45,36,37,37,39,32,37,47,47,40,39,39,48,48,39,40,40,44,,40,50,50,,44,44,51,51,44,53,53,53,53,54,54"),f=d.large_array_unpack("-3,22,-2,,28,9,,32,-1,,,20,35,40,4,12,17,3,22,46,,25,30,,34,38,46,43,51,56,51,,76,59,-6,,64,69,,77,82,,,,90,66,,72,77,,85,90,,100,99,,,,,"),u=d.large_array_unpack("-4,-35,-35,-5,-35,-6,-17,-35,-35,-34,60,-12,-6,-7,-35,-35,-35,-35,-35,-21,-24,-35,-35,-32,-1,-35,-12,-35,-35,-35,-8,-16,-32,-9,-35,-18,-35,-35,-33,-35,-35,-30,-31,-3,-35,-13,-2,-10,-11,-14,-19,-20,-22,-25,-15,-23,-26,-27,-28,-29"),p=d.large_array_unpack("18,30,33,41,42,24,6,1,34,2,5,12,11,7,30,47,48,45,31,26,46,52,53,50,51,32,43,55,35,,,,,,,,54"),_=d.large_array_unpack("10,9,9,13,13,5,11,1,10,2,3,6,4,12,9,9,9,10,11,4,5,13,13,9,9,12,7,14,12,,,,,,,,10"),y=[T,7,9,8,7,-6,6,2,T,-13,-8,4,11,-18,-26],m=[T,T,T,T,T,T,T,T,13,19,T,T,23,20,T],ne=d.large_array_unpack("0,0,racc_error,4,23,_reduce_1,5,23,_reduce_2,5,23,_reduce_3,0,24,_reduce_4,1,24,_reduce_5,0,26,_reduce_6,1,26,_reduce_7,2,30,_reduce_8,2,30,_reduce_9,3,30,_reduce_10,3,30,_reduce_11,0,27,_reduce_12,2,27,_reduce_13,3,28,_reduce_14,2,29,_reduce_15,3,25,_reduce_16,1,25,_reduce_17,3,33,_reduce_18,3,32,_reduce_19,3,32,_reduce_20,1,32,_reduce_none,3,31,_reduce_22,4,31,_reduce_23,1,31,_reduce_none,0,36,_reduce_25,1,36,_reduce_26,1,36,_reduce_27,1,36,_reduce_28,1,36,_reduce_29,2,35,_reduce_30,2,35,_reduce_31,1,35,_reduce_none,3,34,_reduce_33,1,34,_reduce_34"),ke=O(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"S",7,"PLUS",8,"MINUS",9,"ASTERISK",10,"SLASH",11,"PARENL",12,"PARENR",13,"BRACKETL",14,"BRACKETR",15,"LESS",16,"GREATER",17,"EQUAL",18,"NOT",19,"AT",20,"CMP_OP",21),E(F[0],"Racc_arg",[l,c,u,f,p,_,m,y,22,ne,ke,60,35,!0]),E(F[0],"Racc_token_to_s_table",d.large_array_unpack("$end,error,NUMBER,R,U,C,F,S,PLUS,MINUS,ASTERISK,SLASH,PARENL,PARENR,BRACKETL,BRACKETR,LESS,GREATER,EQUAL,NOT,AT,CMP_OP,$start,expr,secret,notations,modifier,target,bracket,at,modifier_expr,mul,add,dice,term,unary,round_type")),E(F[0],"Racc_debug_parser",!1),x(N,"$_reduce_1",function(he,Se,ve){return j(j(g("UpperDice"),"Node"),"Command").$new(Y(["secret","notations","modifier","cmp_op","target_number"],{secret:he["$[]"](0),notations:he["$[]"](1),modifier:he["$[]"](2),cmp_op:he["$[]"](3)["$[]"]("cmp_op"),target_number:he["$[]"](3)["$[]"]("target")}))}),x(N,"$_reduce_2",function(he,Se,ve){return j(j(g("UpperDice"),"Node"),"Command").$new(Y(["secret","notations","modifier","cmp_op","target_number","reroll_threshold"],{secret:he["$[]"](0),notations:he["$[]"](1),modifier:he["$[]"](3),cmp_op:he["$[]"](4)["$[]"]("cmp_op"),target_number:he["$[]"](4)["$[]"]("target"),reroll_threshold:he["$[]"](2)}))}),x(N,"$_reduce_3",function(he,Se,ve){return j(j(g("UpperDice"),"Node"),"Command").$new(Y(["secret","notations","modifier","cmp_op","target_number","reroll_threshold"],{secret:he["$[]"](0),notations:he["$[]"](1),modifier:he["$[]"](2),cmp_op:he["$[]"](3)["$[]"]("cmp_op"),target_number:he["$[]"](3)["$[]"]("target"),reroll_threshold:he["$[]"](4)}))}),x(N,"$_reduce_4",G(!1)),x(N,"$_reduce_5",G(!0)),x(N,"$_reduce_6",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"Number").$new(0)}),x(N,"$_reduce_7",function(he,Se,ve){return he["$[]"](0)}),x(N,"$_reduce_8",function(he,Se,ve){return he["$[]"](1)}),x(N,"$_reduce_9",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"Negative").$new(he["$[]"](1))}),x(N,"$_reduce_10",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"+",he["$[]"](2))}),x(N,"$_reduce_11",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"-",he["$[]"](2))}),x(N,"$_reduce_12",function(he,Se,ve){return Y([],{})}),x(N,"$_reduce_13",function(he,Se,ve){var ae,b,V;return V=null==(ae=D(he))[1]?T:ae[1],W(b=null==ae[0]?T:ae[0])||this.$raise(g("ParseError")),Y(["cmp_op","target"],{cmp_op:b,target:V})}),x(N,"$_reduce_14",function(he,Se,ve){return he["$[]"](1)}),x(N,"$_reduce_15",function(he,Se,ve){return he["$[]"](1)}),x(N,"$_reduce_16",function(he,Se,ve){var ae=T;return(ae=he["$[]"](0)).$push(he["$[]"](2)),ae}),x(N,"$_reduce_17",function(he,Se,ve){return[he["$[]"](0)]}),x(N,"$_reduce_18",function(he,Se,ve){var ae,ue;return ae=he["$[]"](0),ue=he["$[]"](2),j(j(g("UpperDice"),"Node"),"Notation").$new(ae,ue)}),x(N,"$_reduce_19",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"+",he["$[]"](2))}),x(N,"$_reduce_20",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"-",he["$[]"](2))}),x(N,"$_reduce_22",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"*",he["$[]"](2))}),x(N,"$_reduce_23",function(he,Se,ve){return he["$[]"](3).$new(he["$[]"](0),he["$[]"](2))}),x(N,"$_reduce_25",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),x(N,"$_reduce_26",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"DivideWithCeil")}),x(N,"$_reduce_27",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"DivideWithCeil")}),x(N,"$_reduce_28",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"DivideWithRound")}),x(N,"$_reduce_29",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"DivideWithFloor")}),x(N,"$_reduce_30",function(he,Se,ve){return he["$[]"](1)}),x(N,"$_reduce_31",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"Negative").$new(he["$[]"](1))}),x(N,"$_reduce_33",function(he,Se,ve){return he["$[]"](1)}),x(N,"$_reduce_34",function(he,Se,ve){return j(j(g("Arithmetic"),"Node"),"Number").$new(he["$[]"](0))}),x(N,"$_reduce_none",function(he,Se,ve){return he["$[]"](0)})},Opal.modules["bcdice/common_command/upper_dice"]=function(d){var D,T,q,A,L,S,K,I,oe,B,H=d.module,ee=d.const_set,$=d.thrower,x=d.def,E=[],Y=d.nil;return d.top.$require("bcdice/common_command/upper_dice/parser"),D=E,T=B=[H(E[0],"BCDice")].concat(D),q=oe=[H(B[0],"CommonCommand")].concat(T),ee((I=[K=H(oe[0],"UpperDice")].concat(q))[0],"PREFIX_PATTERN",/\d+U\d+/.$freeze()),L=[A=d.get_singleton_class(K)].concat(I),S=d.$r(L),x(A,"$eval",function(v,P,R){try{var k;return $("eval_return"),(k=S("Parser").$parse(v))===Y||null==k?Y:k.$eval(P,R)}catch(N){if(N===d.t_eval_return)return N.$v;throw N}})},Opal.modules["bcdice/common_command/version"]=function(d){var W,j,K,J,S,M,I,A,z,Z,H=d.module,ee=d.const_set,$=d.truthy,x=d.send,O=d.def,E=[],Y=d.nil,G=d.$$$;return W=E,j=Z=[H(E[0],"BCDice")].concat(W),K=z=[H(Z[0],"CommonCommand")].concat(j),ee((A=[I=H(z[0],"Version")].concat(K))[0],"PREFIX_PATTERN",/BCDiceVersion/.$freeze()),S=[J=d.get_singleton_class(I)].concat(A),M=d.$r(S),O(J,"$eval",function(P,R,te){return P=P.$split(" ",2).$first(),$(P["$match?"](/^BCDiceVersion$/i))?x(M("Result").$new(),"tap",[],function(de){var N;return null==de&&(de=Y),N=["BCDice "+G(M("BCDice"),"VERSION")],x(de,"text=",N),N[N.length-1]}):Y})},Opal.queue(function(d){var Y,B,T,j,D,H=d.module,ee=d.const_set,$=d.top,x=[];return $.$require("bcdice/common_command/add_dice"),$.$require("bcdice/common_command/barabara_dice"),$.$require("bcdice/common_command/tally_dice"),$.$require("bcdice/common_command/calc"),$.$require("bcdice/common_command/choice"),$.$require("bcdice/common_command/d66_dice"),$.$require("bcdice/common_command/repeat"),$.$require("bcdice/common_command/reroll_dice"),$.$require("bcdice/common_command/upper_dice"),$.$require("bcdice/common_command/version"),Y=x,B=D=[H(x[0],"BCDice")].concat(Y),T=[H(D[0],"CommonCommand")].concat(B),j=d.$r(T),ee(T[0],"COMMANDS",[j("AddDice"),j("BarabaraDice"),j("TallyDice"),j("Calc"),j("Choice"),j("D66Dice"),j("Repeat"),j("RerollDice"),j("UpperDice"),j("Version")].$freeze())})},9993:function(){(function(C){"use strict";var le;if("undefined"!=typeof globalThis?C=globalThis:"undefined"!=typeof global?C=global:"undefined"!=typeof window&&(C=window),null==C.console&&(C.console={}),"log"in(le="object"==typeof C.console?C.console:{})||(le.log=function(){}),"warn"in le||(le.warn=le.log),void 0!==C.Opal)return le.warn("Opal already loaded. Loading twice can cause troubles, please fix your setup."),C.Opal;var me,d,H,ee,$,x,O,E=C.Opal={};E.global=C,E.config={missing_require_severity:"error",unsupported_features_severity:"warning",experimental_features_severity:"warning",enable_stack_trace:!0};var Y=Function.prototype.call,G=Function.prototype.bind,D=Object.hasOwn||Y.bind(Object.prototype.hasOwnProperty),W=Object.setPrototypeOf,B=Y.bind(Array.prototype.slice),Z=Y.bind(Array.prototype.splice),j=4;function oe(){return j+=2}E.uid=oe,E.id=function(b){return b.$$is_number?2*b+1:(null==b.$$id&&K(b,"$$id",oe()),b.$$id)};var z=E.gvars={};function q(b,V){if(b||(b=E.Exception||Error),!O||!O.$raise)throw b.$new?b.$new(V):new b(V);arguments.length>2?O.$raise(b.$new.apply(b,B(arguments,1))):O.$raise(b,V)}function K(b,V,ge){"string"==typeof b?b[V]=ge:Object.defineProperty(b,V,{value:ge,enumerable:!1,configurable:!0,writable:!0})}E.exit=function(b){z.DEBUG&&le.log("Exited with status "+b)},E.exceptions=[],E.pop_exception=function(){var b=E.exceptions.pop();b?(z["!"]=b,z["@"]=b.$backtrace()):z["!"]=z["@"]=me},E.prop=K,E.defineProperty=E.prop,E.slice=B;var I=E.truthy=function(b){return!(!1===b||me===b||null==b||b instanceof Boolean&&!0!==b.valueOf())};function A(b){var V,ge,xe;for(V=0,ge=E.tracers_for_class.length;V<ge;V++)(xe=E.tracers_for_class[V]).trace_object=b,xe.block.$call(xe)}function J(b,V){if(b.$$autoload[V].loaded){if(b.$$autoload[V].loaded&&!b.$$autoload[V].required&&b.$$autoload[V].exception)throw b.$$autoload[V].exception}else{b.$$autoload[V].loaded=!0;try{E.Kernel.$require(b.$$autoload[V].path)}catch(ge){throw b.$$autoload[V].exception=ge,ge}if(b.$$autoload[V].required=!0,null!=b.$$const[V])return b.$$autoload[V].success=!0,b.$$const[V]}}function L(b,V){if(b){if(null!=b.$$const[V])return b.$$const[V];if(b.$$autoload&&b.$$autoload[V])return J(b,V)}}function M(b,V){var ge,xe,De;if(null!=b)for(ge=0,xe=(De=se(b)).length;ge<xe;ge++){if(De[ge].$$const&&D(De[ge].$$const,V))return De[ge].$$const[V];if(De[ge].$$autoload&&De[ge].$$autoload[V])return J(De[ge],V)}}function P(b,V){return(b||H).$const_missing(V)}function R(b,V,ge){var xe=!0;return(null==b||"::"===b)&&(b=H),ge.$$is_a_module&&((null==ge.$$name||ge.$$name===me)&&(ge.$$name=V),null==ge.$$base_module&&(ge.$$base_module=b)),b.$$const=b.$$const||Object.create(null),(V in b.$$const||"$$autoload"in b&&V in b.$$autoload)&&(xe=!1),b.$$const[V]=ge,b.$$=b.$$const,E.const_cache_version++,b===H&&(E[V]=ge),K(b,V,ge),xe&&b.$const_added&&!b.$const_added.$$pristine&&b.$const_added(V),ge}function te(b,V,ge){var xe;if(xe=null!=V&&V.$$bridge?function(){var Ze=B(arguments),mt=new(G.apply(V.$$constructor,[null].concat(Ze)));return W(mt,xe.$$prototype),mt}:function(){},b&&b!==me&&K(xe,"displayName","::"+b),K(xe,"$$name",b),K(xe,"$$constructor",xe),K(xe,"$$prototype",xe.prototype),K(xe,"$$const",{}),K(xe,"$$is_class",!0),K(xe,"$$is_a_module",!0),K(xe,"$$super",V),K(xe,"$$cvars",{}),K(xe,"$$own_included_modules",[]),K(xe,"$$own_prepended_modules",[]),K(xe,"$$ancestors",[]),K(xe,"$$ancestors_cache_version",null),K(xe,"$$subclasses",[]),K(xe.$$prototype,"$$class",xe),E.Class&&W(xe,E.Class.prototype),null!=V){if(W(xe.$$prototype,V.$$prototype),!0!==ge)if("undefined"!=typeof WeakRef){var De,Re,Ue=[];for(De=0;De<V.$$subclasses.length;De++)void 0!==(Re=V.$$subclasses[De]).deref()&&Ue.push(Re);Ue.push(new WeakRef(xe)),V.$$subclasses=Ue}else V.$$subclasses.push(xe);V.$$meta&&E.build_class_singleton_class(xe)}return xe}function N(b){var V=function(){},ge=V;return b&&K(V,"displayName",b+".constructor"),K(ge,"$$name",b),K(ge,"$$prototype",V.prototype),K(ge,"$$const",{}),K(ge,"$$is_module",!0),K(ge,"$$is_a_module",!0),K(ge,"$$cvars",{}),K(ge,"$$iclasses",[]),K(ge,"$$own_included_modules",[]),K(ge,"$$own_prepended_modules",[]),K(ge,"$$ancestors",[ge]),K(ge,"$$ancestors_cache_version",null),W(ge,E.Module.prototype),ge}function g(b,V){b.hasOwnProperty("$$meta")?b.$$meta=V:K(b,"$$meta",V),b.$$frozen?b.$$meta.$freeze():W(b,V.$$prototype)}function l(b){return b.hasOwnProperty("$$iclass")&&b.hasOwnProperty("$$root")}function p(b){var V=_(b);return b.$$is_module&&b.$$iclasses.push(V),V}function _(b){var V={},ge=b.$$prototype;ge.hasOwnProperty("$$dummy")&&(ge=ge.$$define_methods_on);var Re,xe=Object.getOwnPropertyNames(ge),De=xe.length;for(Re=0;Re<De;Re++){var Ue=xe[Re];K(V,Ue,ge[Ue])}return K(V,"$$iclass",!0),K(V,"$$module",b),V}function y(b){var V=b.length,ge=b[0];if(K(ge,"$$root",!0),1===V)return{first:ge,last:ge};for(var xe=ge,De=1;De<V;De++){var Re=b[De];W(xe,Re),xe=Re}return{first:b[0],last:b[V-1]}}function m(b){if(!b.hasOwnProperty("$$dummy")){if(b.hasOwnProperty("$$iclass"))return b.$$module;if(b.hasOwnProperty("$$class"))return b.$$class}}function se(b){if(!b)return[];if(b.$$ancestors_cache_version===E.const_cache_version)return b.$$ancestors;var ge,xe,De,V=[];for(ge=0,xe=function ne(b){return b.$$own_prepended_modules.concat([b]).concat(b.$$own_included_modules)}(b),De=xe.length;ge<De;ge++)V.push(xe[ge]);if(b.$$super)for(ge=0,De=(xe=se(b.$$super)).length;ge<De;ge++)V.push(xe[ge]);return b.$$ancestors_cache_version=E.const_cache_version,b.$$ancestors=V,V}function Ee(b){return b.hasOwnProperty("$$meta")&&null!==b.$$meta?se(b.$$meta):se(b.$$class)}function ke(b,V){"number"==typeof V?b.$$arity=V:"object"==typeof V&&Object.assign(b,V)}E.falsy=function(b){return!I(b)},E.type_error=function(b,V,ge,xe){b=b.$$class,q(E.TypeError,xe&&ge?"can't convert "+b+" into "+V+" ("+b+"#"+ge+" gives "+(xe=xe.$$class)+")":"no implicit conversion of "+b+" into "+V)},E.coerce_to=function(b,V,ge,xe){var De;return"to_int"===ge&&V===E.Integer&&b.$$is_number?b<0?Math.ceil(b):Math.floor(b):"to_str"===ge&&V===E.String&&b.$$is_string||E.is_a(b,V)?b:b["$respond_to?"].$$pristine&&b.$method_missing.$$pristine?((null==(De=b[Me(ge)])||De.$$stub)&&E.type_error(b,V),De.apply(b,xe)):(b["$respond_to?"](ge)||E.type_error(b,V),null==xe&&(xe=[]),E.send(b,ge,xe))},E.respond_to=function(b,V,ge){if(null==b||!b.$$class)return!1;ge=!!ge;var xe=b[V];return b["$respond_to?"].$$pristine?"function"==typeof xe&&!xe.$$stub||(b["$respond_to_missing?"].$$pristine?void 0:E.send(b,b["$respond_to_missing?"],[V.substr(1),ge])):E.send(b,b["$respond_to?"],[V.substr(1),ge])},E.trace_class=!1,E.tracers_for_class=[],E.const_get_local=function(b,V,ge){var xe;if(null!=b)return"::"===b&&(b=H),!b.$$is_module&&!b.$$is_class&&q(E.TypeError,b.toString()+" is not a class/module"),null!=(xe=L(b,V))||ge?xe:P(b,V)},E.const_get_qualified=function(b,V,ge){var xe,De,Re,Ue=E.const_cache_version;return null==V?null!=(xe=L(H,b))?xe:E.const_get_qualified(H,b,ge):null!=b?("::"===b&&(b=H),!b.$$is_module&&!b.$$is_class&&q(E.TypeError,b.toString()+" is not a class/module"),null==(De=b.$$const_cache)&&(K(b,"$$const_cache",Object.create(null)),De=b.$$const_cache),null==(Re=De[V])||Re[0]!==Ue?(null!=(xe=L(b,V))||(xe=M(b,V)),De[V]=[Ue,xe]):xe=Re[1],null!=xe||ge?xe:P(b,V)):void 0},E.const_cache_version=1,E.const_get_relative=function(b,V,ge){var De,Ue,Ze,xe=b[0],Re=E.const_cache_version;return null==(Ue=b.$$const_cache)&&(K(b,"$$const_cache",Object.create(null)),Ue=b.$$const_cache),null==(Ze=Ue[V])||Ze[0]!==Re?(null!=(De=L(xe,V))||null!=(De=function S(b,V){var ge,xe,De;if(0!==b.length)for(ge=0,xe=b.length;ge<xe;ge++){if(null!=(De=b[ge].$$const[V]))return De;if(b[ge].$$autoload&&b[ge].$$autoload[V])return J(b[ge],V)}}(b,V))||null!=(De=M(xe,V))||(De=function v(b,V){if(null==b||b.$$is_module)return M(H,V)}(xe,V)),Ue[V]=[Re,De]):De=Ze[1],null!=De||ge?De:P(xe,V)},E.const_set=R,E.constants=function(b,V){null==V&&(V=!0);var ge,De,Re,Ze,xe=[b],Ue={};for(V&&(xe=xe.concat(se(b))),V&&b.$$is_module&&(xe=xe.concat([E.Object]).concat(se(E.Object))),De=0,Re=xe.length;De<Re&&(ge=xe[De],b===H||ge!=H);De++){for(Ze in ge.$$const)Ue[Ze]=!0;if(ge.$$autoload)for(Ze in ge.$$autoload)Ue[Ze]=!0}return Object.keys(Ue)},E.const_remove=function(b,V){if(E.const_cache_version++,null!=b.$$const[V]){var ge=b.$$const[V];return delete b.$$const[V],ge}if(b.$$autoload&&b.$$autoload[V])return delete b.$$autoload[V],me;q(E.NameError,"constant "+b+"::"+b.$name()+" not defined")},E.const_get_relative_factory=function(b){return function(V,ge){return E.$$(b,V,ge)}},E.$$=E.const_get_relative,E.$$$=E.const_get_qualified,E.$r=E.const_get_relative_factory,E.allocate_class=te,E.klass=function(b,V,ge){var xe;null==b||"::"==b?b=H:!b.$$is_class&&!b.$$is_module&&(b=b.$$class),null!=V&&(!V.hasOwnProperty||V.hasOwnProperty&&!V.hasOwnProperty("$$is_class"))&&(V.constructor&&"Function"==V.constructor.name?(xe=V,V=H):q(E.TypeError,"superclass must be a Class ("+(V.constructor&&(V.constructor.name||V.constructor.$$name)||typeof V)+" given)"));var De=function k(b,V){var ge=L(b,V);if(ge)return ge.$$is_class||q(E.TypeError,V+" is not a class"),ge}(b,ge);return null!=De?V&&function de(b,V){b.$$super!==V&&q(E.TypeError,"superclass mismatch for class "+b.$$name)}(De,V):(null==V&&(V=H),R(b,ge,De=te(ge,V)),V.$inherited&&V.$inherited(De),xe&&E.bridge(xe,De)),E.trace_class&&A(De),De},E.allocate_module=N,E.module=function(b,V){var ge;return null==b||"::"==b?b=H:!b.$$is_class&&!b.$$is_module&&(b=b.$$class),ge=function F(b,V){var ge=L(b,V);return null==ge&&b===H&&(ge=M(H,V)),ge&&!ge.$$is_module&&ge!==H&&q(E.TypeError,V+" is not a module"),ge}(b,V),null==ge&&R(b,V,ge=N(V)),E.trace_class&&A(ge),ge},E.get_singleton_class=function(b){return b.$$meta?b.$$meta:b.hasOwnProperty("$$is_class")?E.build_class_singleton_class(b):b.hasOwnProperty("$$is_module")?E.build_module_singleton_class(b):E.build_object_singleton_class(b)},E.build_class_singleton_class=function(b){if(b.$$meta)return b.$$meta;var ge=te(null,b===d?$:E.get_singleton_class(b.$$super),!0);return K(ge,"$$is_singleton",!0),K(ge,"$$singleton_of",b),g(b,ge),K(b,"$$class",E.Class),ge},E.build_module_singleton_class=function(b){if(b.$$meta)return b.$$meta;var V=te(null,E.Module,!0);return K(V,"$$is_singleton",!0),K(V,"$$singleton_of",b),g(b,V),K(b,"$$class",E.Module),V},E.build_object_singleton_class=function(b){var ge=te(me,b.$$class,!0);return K(ge,"$$is_singleton",!0),K(ge,"$$singleton_of",b),delete ge.$$prototype.$$class,g(b,ge),ge},E.is_method=function(b){return"$"===b[0]&&"$"!==b[1]},E.instance_methods=function(b){for(var V=[],ge=[],xe=se(b),De=0,Re=xe.length;De<Re;De++){var Ze=xe[De].$$prototype;Ze.hasOwnProperty("$$dummy")&&(Ze=Ze.$$define_methods_on);for(var mt=Object.getOwnPropertyNames(Ze),bt=0,Wt=mt.length;bt<Wt;bt++){var jt=mt[bt];if(E.is_method(jt)){var En=jt.slice(1),yn=Ze[jt];yn.$$stub&&-1===V.indexOf(En)&&V.push(En),!yn.$$stub&&-1===ge.indexOf(En)&&-1===V.indexOf(En)&&ge.push(En)}}}return ge},E.own_instance_methods=function(b){var V=[],ge=b.$$prototype;ge.hasOwnProperty("$$dummy")&&(ge=ge.$$define_methods_on);for(var xe=Object.getOwnPropertyNames(ge),De=0,Re=xe.length;De<Re;De++){var Ue=xe[De];if(E.is_method(Ue)&&!ge[Ue].$$stub){var mt=Ue.slice(1);V.push(mt)}}return V},E.methods=function(b){return E.instance_methods(b.$$meta||b.$$class)},E.own_methods=function(b){return b.$$meta?E.own_instance_methods(b.$$meta):[]},E.receiver_methods=function(b){var V=E.get_singleton_class(b),ge=E.own_instance_methods(V),xe=E.own_instance_methods(V.$$super);return ge.concat(xe)},E.class_variables=function(b){var ge,V=se(b),De={};for(ge=V.length-1;ge>=0;ge--){var Re=V[ge];for(var Ue in Re.$$cvars)De[Ue]=Re.$$cvars[Ue]}return De},E.class_variable_set=function(b,V,ge){var De,xe=se(b);for(De=xe.length-2;De>=0;De--){var Ue=xe[De];if(D(Ue.$$cvars,V))return Ue.$$cvars[V]=ge,ge}return b.$$cvars[V]=ge,ge},E.class_variable_get=function(b,V,ge){if(D(b.$$cvars,V))return b.$$cvars[V];var De,xe=se(b),Re=xe.length;for(De=0;De<Re;De++){var Ue=xe[De];if(D(Ue.$$cvars,V))return Ue.$$cvars[V]}return ge||q(E.NameError,"uninitialized class variable "+V+" in "+b.$name()),me},E.append_features=function(b,V){var ge=se(b),xe=[];-1!==ge.indexOf(V)&&q(E.ArgumentError,"cyclic include detected");for(var De=0,Re=ge.length;De<Re;De++){var Ze=p(ge[De]);K(Ze,"$$included",!0),xe.push(Ze)}var Wt,jt,mt=se(V),bt=y(xe);if(-1===mt.indexOf(b))Wt=V.$$prototype,jt=Object.getPrototypeOf(V.$$prototype);else{for(var En=V.$$prototype,yn=Object.getPrototypeOf(En);null!=yn&&(yn.$$module!==b||!l(yn));)En=yn,yn=Object.getPrototypeOf(yn);if(yn){for(var mr=Object.getPrototypeOf(yn);mr.hasOwnProperty("$$iclass")&&!l(mr);)mr=Object.getPrototypeOf(mr);Wt=En,jt=mr}else Wt=V.$$prototype,jt=Object.getPrototypeOf(V.$$prototype)}W(Wt,bt.first),W(bt.last,jt),V.$$own_included_modules=function c(b){for(var ge,V=[],xe=Object.getPrototypeOf(b.$$prototype);xe&&!xe.hasOwnProperty("$$class");)(ge=m(xe))&&V.push(ge),xe=Object.getPrototypeOf(xe);return V}(V),E.const_cache_version++},E.prepend_features=function(b,V){var ge=se(b),xe=[];-1!==ge.indexOf(V)&&q(E.ArgumentError,"cyclic prepend detected");for(var De=0,Re=ge.length;De<Re;De++){var Ze=p(ge[De]);K(Ze,"$$prepended",!0),xe.push(Ze)}var jt,En,yn,mt=y(xe),bt=V.$$prototype,Wt=Object.getPrototypeOf(bt);if(bt.hasOwnProperty("$$dummy")?jt=bt.$$define_methods_on:(jt=_(V),function u(b){for(var V=b.$$prototype,ge=Object.getOwnPropertyNames(V),xe=0;xe<ge.length;xe++){var De=ge[xe];E.is_method(De)&&delete V[De]}}(V),K(bt,"$$dummy",!0),K(bt,"$$define_methods_on",jt),W(bt,jt),W(jt,Wt)),-1===se(V).indexOf(b))for(En=bt,yn=Object.getPrototypeOf(bt);null!=yn&&!yn.hasOwnProperty("$$root")&&yn!==jt&&yn.hasOwnProperty("$$iclass");)yn=Object.getPrototypeOf(yn);else q(E.RuntimeError,"Prepending a module multiple times is not supported");W(En,mt.first),W(mt.last,yn),V.$$own_prepended_modules=function f(b){var ge,V=[],xe=Object.getPrototypeOf(b.$$prototype);if(b.$$prototype.hasOwnProperty("$$dummy"))for(;xe&&xe!==b.$$prototype.$$define_methods_on;)(ge=m(xe))&&V.push(ge),xe=Object.getPrototypeOf(xe);return V}(V),E.const_cache_version++},E.bridge=function(b,V){b.hasOwnProperty("$$bridge")&&q(E.ArgumentError,"already bridged"),K(b,"$$bridge",V),W(b.prototype,(V.$$super||E.Object).$$prototype),K(V,"$$prototype",b.prototype),K(V.$$prototype,"$$class",V),K(V,"$$constructor",b),K(V,"$$bridge",!0)},E.ancestors=se,E.included_modules=function(b){for(var V=[],ge=null,xe=Object.getPrototypeOf(b.$$prototype);xe&&Object.getPrototypeOf(xe);xe=Object.getPrototypeOf(xe))(ge=m(xe))&&ge.$$is_module&&xe.$$iclass&&xe.$$included&&V.push(ge);return V},E.add_stubs=function(b){for(var ge,xe,V=E.BasicObject.$$prototype,De=0,Re=(b=b.split(",")).length;De<Re;De++)(null==(xe=V[ge=Me(b[De])])||xe.$$stub)&&E.add_stub_for(V,ge)},E.add_stub_for=function(b,V){K(b,V,E.stub_for(V))},E.stub_for=function(b){function V(){this.$method_missing.$$p=V.$$p,V.$$p=null;for(var ge=new Array(arguments.length),xe=0,De=ge.length;xe<De;xe++)ge[xe]=arguments[xe];return this.$method_missing.apply(this,[b.slice(1)].concat(ge))}return V.$$stub=!0,V},E.ac=function(b,V,ge,xe){var De="";De+=ge.$$is_a_module?ge.$$name+".":ge.$$class.$$name+"#",q(E.ArgumentError,"["+(De+=xe)+"] wrong number of arguments (given "+b+", expected "+V+")")},E.block_ac=function(b,V,ge){q(E.ArgumentError,"`block in "+ge+"': wrong number of arguments (given "+b+", expected "+V+")")},E.find_super=function(b,V,ge,xe,De){for(var Ue,Ze,Re=Me(V),bt=(Ue=Ee(b)).indexOf(ge.$$owner)+1;bt<Ue.length;bt++){var jt=Ue[bt].$$prototype;if(jt.hasOwnProperty("$$dummy")&&(jt=jt.$$define_methods_on),jt.hasOwnProperty(Re)){Ze=jt[Re];break}}return!xe&&Ze&&Ze.$$stub&&b.$method_missing.$$pristine&&q(E.NoMethodError,"super: no superclass method `"+V+"' for "+b,V),Ze.$$stub&&!De?null:Ze},E.find_block_super=function(b,V,ge,xe,De){var Re=V;return ge||q(E.RuntimeError,"super called outside of method"),De&&ge.$$define_meth&&q(E.RuntimeError,"implicit argument passing of super from method defined by define_method() is not supported. Specify all arguments explicitly"),ge.$$def&&(Re=ge.$$jsid),E.find_super(b,Re,ge,xe)},E.find_super_dispatcher=E.find_super,E.find_iter_super_dispatcher=E.find_block_super,E.yield1=function(b,V){"function"!=typeof b&&q(E.LocalJumpError,"no block given");var xe=b.$$has_trailing_comma_in_args;return(b.length>1||(b.$$has_top_level_mlhs_arg||xe)&&1===b.length)&&(V=E.to_ary(V)),(b.length>1||xe&&1===b.length)&&V.$$is_array?b.apply(null,V):b(V)},E.yieldX=function(b,V){if("function"!=typeof b&&q(E.LocalJumpError,"no block given"),b.length>1&&1===V.length&&V[0].$$is_array)return b.apply(null,V[0]);if(!V.$$is_array){for(var ge=new Array(V.length),xe=0,De=ge.length;xe<De;xe++)ge[xe]=V[xe];return b.apply(null,ge)}return b.apply(null,V)},E.rescue=function(b,V){for(var ge=0;ge<V.length;ge++){var xe=V[ge];if(xe.$$is_array){var De=E.rescue(b,xe);if(De)return De}else if(xe===E.JS.Error||xe["$==="](b))return xe}return null},E.is_a=function(b,V){return null!=V&&b.$$meta===V||b.$$class===V||(b.$$is_number&&V.$$is_number_class?!V.$$is_integer_class||b%1==0:-1!==se(b.$$is_class?E.get_singleton_class(b):b.$$meta||b.$$class).indexOf(V))},E.to_hash=function(b){if(b.$$is_hash)return b;if(b["$respond_to?"]("to_hash",!0)){var V=b.$to_hash();if(V.$$is_hash)return V;q(E.TypeError,"Can't convert "+b.$$class+" to Hash ("+b.$$class+"#to_hash gives "+V.$$class+")")}else q(E.TypeError,"no implicit conversion of "+b.$$class+" into Hash")},E.to_ary=function(b){if(b.$$is_array)return b;if(!b["$respond_to?"]("to_ary",!0))return[b];var V=b.$to_ary();return V===me?[b]:V.$$is_array?V:void q(E.TypeError,"Can't convert "+b.$$class+" to Array ("+b.$$class+"#to_ary gives "+V.$$class+")")},E.to_a=function(b){if(b.$$is_array)return b.slice();if(!b["$respond_to?"]("to_a",!0))return[b];var V=b.$to_a();return V===me?[b]:V.$$is_array?V:void q(E.TypeError,"Can't convert "+b.$$class+" to Array ("+b.$$class+"#to_a gives "+V.$$class+")")},E.extract_kwargs=function(b){var V=b[b.length-1];if(null!=V&&E.respond_to(V,"$to_hash",!0))return Z(b,b.length-1),V},E.kwrestargs=function(b,V){var De,ge=[],xe={},Re=b.$$smap;for(De in Re)V[De]||(ge.push(De),xe[De]=Re[De]);return E.hash2(ge,xe)};var ce={};function Me(b){return ce[b]||(ce[b]="$"+b)}function $e(b){return"function"==typeof b&&!b.$$stub}E.jsid=Me,E.send=function(b,V,ge,xe,De){var Re;return"function"==typeof V?(Re=V,V=null):"string"==typeof V?Re=b[Me(V)]:q(E.NameError,"Passed method should be a string or a function"),E.send2(b,Re,V,ge,xe,De)},E.send2=function(b,V,ge,xe,De,Re){return null==V&&null!=ge&&b.$method_missing&&(V=b.$method_missing,xe=[ge].concat(xe)),ke(De,Re),"function"==typeof De&&(V.$$p=De),V.apply(b,xe)},E.refined_send=function(b,V,ge,xe,De,Re){var Ue,Ze,mt,bt,Wt,jt,En,yn,mr,al;for(bt=Ee(V),Ue=0;Ue<bt.length;Ue++)for(Wt=E.id(bt[Ue]),Ze=0;Ze<b.length;Ze++)for(mt=(jt=b[Ze]).length-1;mt>=0;mt--)if(void 0!==(En=jt[mt]).$$refine_modules&&void 0!==(yn=En.$$refine_modules)[Wt]&&void 0!==(mr=yn[Wt]).$$prototype[Me(ge)])return al=mr.$$prototype[Me(ge)],E.send2(V,al,ge,xe,De,Re);return E.send(V,ge,xe,De,Re)},E.lambda=function(b,V){return b.$$is_lambda=!0,ke(b,V),b},E.def=function(b,V,ge,xe){return ke(ge,xe),b===E.top?E.defn(E.Object,V,ge):!b.$$eval&&b.$$is_a_module?E.defn(b,V,ge):E.defs(b,V,ge)},E.defn=function(b,V,ge){he(b),ge.displayName=V,ge.$$owner=b;var xe=V.substr(1),De=b.$$prototype;if(De.hasOwnProperty("$$dummy")&&(De=De.$$define_methods_on),K(De,V,ge),b.$$is_module){b.$$module_function&&E.defs(b,V,ge);for(var Re=0,Ue=b.$$iclasses,Ze=Ue.length;Re<Ze;Re++)K(Ue[Re],V,ge)}var bt=b.$$singleton_of;return!b.$method_added||b.$method_added.$$stub||bt?bt&&bt.$singleton_method_added&&!bt.$singleton_method_added.$$stub&&bt.$singleton_method_added(xe):b.$method_added(xe),xe},E.defs=function(b,V,ge,xe){return ke(ge,xe),(b.$$is_string||b.$$is_number)&&q(E.TypeError,"can't define singleton"),E.defn(E.get_singleton_class(b),V,ge)},E.rdef=function(b,V){D(b.$$prototype,V)||q(E.NameError,"method '"+V.substr(1)+"' not defined in "+b.$name()),delete b.$$prototype[V],b.$$is_singleton?b.$$prototype.$singleton_method_removed&&!b.$$prototype.$singleton_method_removed.$$stub&&b.$$prototype.$singleton_method_removed(V.substr(1)):b.$method_removed&&!b.$method_removed.$$stub&&b.$method_removed(V.substr(1))},E.udef=function(b,V){(!b.$$prototype[V]||b.$$prototype[V].$$stub)&&q(E.NameError,"method '"+V.substr(1)+"' not defined in "+b.$name()),E.add_stub_for(b.$$prototype,V),b.$$is_singleton?b.$$prototype.$singleton_method_undefined&&!b.$$prototype.$singleton_method_undefined.$$stub&&b.$$prototype.$singleton_method_undefined(V.substr(1)):b.$method_undefined&&!b.$method_undefined.$$stub&&b.$method_undefined(V.substr(1))},E.alias=function(b,V,ge){var Re,Ue,xe=Me(V),De=Me(ge);if(void 0===b.$$prototype&&(b=E.Object),Re=b.$$prototype[De],b.$$eval)return E.alias(E.get_singleton_class(b),V,ge);if(!$e(Re)){for(var Ze=b.$$super;"function"!=typeof Re&&Ze;)Re=Ze[De],Ze=Ze.$$super;!$e(Re)&&b.$$is_module&&(Re=E.Object.$$prototype[De]),$e(Re)||q(E.NameError,"undefined method `"+ge+"' for class `"+b.$name()+"'")}Re.$$alias_of&&(Re=Re.$$alias_of),Ue=function(){var bt,Wt,jt,mt=Ue.$$p;for(bt=new Array(arguments.length),Wt=0,jt=arguments.length;Wt<jt;Wt++)bt[Wt]=arguments[Wt];return Ue.$$p=null,E.send(this,Re,bt,mt)};try{Object.defineProperty(Ue,"length",{value:Re.length})}catch(mt){}return Ue.displayName=V,Ue.$$arity=null==Re.$$arity?Re.length:Re.$$arity,Ue.$$parameters=Re.$$parameters,Ue.$$source_location=Re.$$source_location,Ue.$$alias_of=Re,Ue.$$alias_name=V,E.defn(b,xe,Ue),b},E.alias_gvar=function(b,V){return Object.defineProperty(z,b,{configurable:!0,enumerable:!0,get:function(){return z[V]},set:function(ge){z[V]=ge}}),me},E.alias_native=function(b,V,ge){var xe=Me(V),De=b.$$prototype[ge];return("function"!=typeof De||De.$$stub)&&q(E.NameError,"undefined native method `"+ge+"' for class `"+b.$name()+"'"),E.defn(b,xe,De),b},E.hash_init=function(b){b.$$smap=Object.create(null),b.$$map=Object.create(null),b.$$keys=[]},E.hash_clone=function(b,V){V.$$none=b.$$none,V.$$proc=b.$$proc;for(var Ue,Ze,ge=0,xe=b.$$keys,De=b.$$smap,Re=xe.length;ge<Re;ge++)(Ue=xe[ge]).$$is_string?Ze=De[Ue]:(Ze=Ue.value,Ue=Ue.key),E.hash_put(V,Ue,Ze)},E.hash_put=function(b,V,ge){if(V.$$is_string)return D(b.$$smap,V)||b.$$keys.push(V),void(b.$$smap[V]=ge);var xe,De,Re;if(xe=b.$$by_identity?E.id(V):V.$hash(),!D(b.$$map,xe))return b.$$keys.push(De={key:V,key_hash:xe,value:ge}),void(b.$$map[xe]=De);for(De=b.$$map[xe];De;){if(V===De.key||V["$eql?"](De.key)){Re=void 0,De.value=ge;break}Re=De,De=De.next}Re&&(b.$$keys.push(De={key:V,key_hash:xe,value:ge}),Re.next=De)},E.hash_get=function(b,V){if(V.$$is_string)return D(b.$$smap,V)?b.$$smap[V]:void 0;var ge,xe;if(ge=b.$$by_identity?E.id(V):V.$hash(),D(b.$$map,ge))for(xe=b.$$map[ge];xe;){if(V===xe.key||V["$eql?"](xe.key))return xe.value;xe=xe.next}},E.hash_delete=function(b,V){var ge,Re,Ue,xe=b.$$keys,De=xe.length;if(V.$$is_string){if("string"!=typeof V&&(V=V.valueOf()),!D(b.$$smap,V))return;for(ge=0;ge<De;ge++)if((Ue=xe[ge]).$$is_string&&"string"!=typeof Ue&&(Ue=Ue.valueOf()),Ue===V){xe.splice(ge,1);break}return Re=b.$$smap[V],delete b.$$smap[V],Re}var Ze=V.$hash();if(D(b.$$map,Ze))for(var bt,mt=b.$$map[Ze];mt;){if(V===mt.key||V["$eql?"](mt.key)){for(Re=mt.value,ge=0;ge<De;ge++)if(xe[ge]===mt){xe.splice(ge,1);break}return bt&&mt.next?bt.next=mt.next:bt?delete bt.next:mt.next?b.$$map[Ze]=mt.next:delete b.$$map[Ze],Re}bt=mt,mt=mt.next}},E.hash_rehash=function(b){for(var xe,De,Re,V=0,ge=b.$$keys.length;V<ge;V++)if(!b.$$keys[V].$$is_string&&(xe=b.$$keys[V].key.$hash())!==b.$$keys[V].key_hash){for(De=b.$$map[b.$$keys[V].key_hash],Re=void 0;De;){if(De===b.$$keys[V]){Re&&De.next?Re.next=De.next:Re?delete Re.next:De.next?b.$$map[b.$$keys[V].key_hash]=De.next:delete b.$$map[b.$$keys[V].key_hash];break}Re=De,De=De.next}if(b.$$keys[V].key_hash=xe,!D(b.$$map,xe)){b.$$map[xe]=b.$$keys[V];continue}for(De=b.$$map[xe],Re=void 0;De;){if(De===b.$$keys[V]){Re=void 0;break}Re=De,De=De.next}Re&&(Re.next=b.$$keys[V])}},E.hash=function(){var V,ge,xe,De,Re,b=arguments.length;if(1===b&&arguments[0].$$is_hash)return arguments[0];if(ge=new E.Hash,E.hash_init(ge),1===b){if(V=arguments[0],arguments[0].$$is_array){for(De=V.length,xe=0;xe<De;xe++)2!==V[xe].length&&q(E.ArgumentError,"value not of length 2: "+V[xe].$inspect()),E.hash_put(ge,Re=V[xe][0],V[xe][1]);return ge}for(Re in V=arguments[0])D(V,Re)&&E.hash_put(ge,Re,V[Re]);return ge}for(b%2!=0&&q(E.ArgumentError,"odd number of arguments for Hash"),xe=0;xe<b;xe+=2)E.hash_put(ge,Re=arguments[xe],arguments[xe+1]);return ge},E.hash2=function(b,V){var ge=new E.Hash;return ge.$$smap=V,ge.$$map=Object.create(null),ge.$$keys=b,ge},E.range=function(b,V,ge){var xe=new E.Range;return xe.begin=b,xe.end=V,xe.excl=ge,xe};var be=["constructor","displayName","__count__","__noSuchMethod__","__parent__","__proto__","hasOwnProperty","valueOf"];function he(b){b.$$frozen&&q(E.FrozenError,"can't modify frozen "+b.$class()+": "+b,E.hash2(["receiver"],{receiver:b}))}function Se(b,V){return"number"==typeof b&&"number"==typeof V}function ve(b,V){return"number"==typeof b&&"number"==typeof V||"string"==typeof b&&"string"==typeof V}function ue(b){return function(){return b}}E.ivar=function(b){return-1!==be.indexOf(b)&&(b+="$"),b},E.deny_frozen_access=he,E.freeze=function(b){return K(b,"$$frozen",!0),b.hasOwnProperty("$$id")||K(b,"$$id",oe()),b.hasOwnProperty("$$meta")?b.$$meta.$freeze():K(b,"$$meta",null),b.hasOwnProperty("$$comparable")||K(b,"$$comparable",null),Object.seal(b),b},E.freeze_props=function(b){var V,ge,xe;for(V in b)("string"!=(ge=typeof V)&&"object"!==ge||"$"!==V[0])&&(xe=Object.getOwnPropertyDescriptor(b,V))&&xe.enumerable&&xe.writable&&function(){var De=b[V];Object.defineProperty(b,V,{get:function(){return De},set:function(Re){he(b)},enumerable:!0})}()},E.escape_regexp=function(b){return b.replace(/([-[\]\/{}()*+?.^$\\| ])/g,"\\$1").replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r").replace(/[\f]/g,"\\f").replace(/[\t]/g,"\\t")},E.global_regexp=function(b){return b.global?b:(null==b.$$g?b.$$g=new RegExp(b.source,(b.multiline?"gm":"g")+(b.ignoreCase?"i":"")):b.$$g.lastIndex=null,b.$$g)},E.global_multiline_regexp=function(b){var V,ge;return b.global&&b.multiline?b:(ge="gm"+(b.ignoreCase?"i":""),b.multiline?(null==b.$$g&&(b.$$g=new RegExp(b.source,ge)),V=b.$$g):(null==b.$$gm&&(b.$$gm=new RegExp(b.source,ge)),V=b.$$gm),V.lastIndex=null,V)},E.regexp=function(b,V){for(var ge,xe=void 0!==V&&V&&V.indexOf("i")>=0,De=0,Re=b.length;De<Re;De++)(ge=b[De])instanceof RegExp&&(ge.ignoreCase!==xe&&E.Kernel.$warn("ignore case doesn't match for "+ge.source.$inspect(),E.hash({uplevel:1})),ge=ge.source),""===ge&&(ge="(?:"+ge+")"),b[De]=ge;return V?new RegExp(b.join(""),V):new RegExp(b.join(""))},E.modules={},E.loaded_features=["corelib/runtime"],E.current_dir=".",E.require_table={"corelib/runtime":!0},E.normalize=function(b){var V,ge,xe=[];"."!==E.current_dir&&(b=E.current_dir.replace(/\/*$/,"/")+b);for(var Re=0,Ue=(V=(b=(b=b.replace(/^\.\//,"")).replace(/\.(rb|opal|js)$/,"")).split("/")).length;Re<Ue;Re++)""!==(ge=V[Re])&&(".."===ge?xe.pop():xe.push(ge));return xe.join("/")},E.loaded=function(b){var V,ge,xe;for(V=0,ge=b.length;V<ge;V++)xe=E.normalize(b[V]),!E.require_table[xe]&&(E.loaded_features.push(xe),E.require_table[xe]=!0)},E.load_normalized=function(b){E.loaded([b]);var V=E.modules[b];if(V){var ge=V(E);if("undefined"!=typeof Promise&&ge instanceof Promise)return ge.then(ue(!0))}else{var xe=E.config.missing_require_severity,De="cannot load such file -- "+b;"error"===xe?q(E.LoadError,De):"warning"===xe&&le.warn("WARNING: LoadError: "+De)}return!0},E.load=function(b){return b=E.normalize(b),E.load_normalized(b)},E.require=function(b){return b=E.normalize(b),!E.require_table[b]&&E.load_normalized(b)},E.encodings=Object.create(null),E.set_encoding=function(b,V,ge){void 0===ge&&(ge="encoding"),("string"==typeof b||!0===b.$$frozen)&&q(E.FrozenError,"can't modify frozen String");var xe=E.find_encoding(V);return xe===b[ge]||(b[ge]=xe),b},E.find_encoding=function(b){var V=E.encodings,ge=V[b]||V[b.toUpperCase()];return ge||q(E.ArgumentError,"unknown encoding name - "+b),ge},E.enc=function(b,V){var ge=new String(b);return(ge=E.set_encoding(ge,V)).internal_encoding=ge.encoding,ge},E.binary=function(b){var V=new String(b);return E.set_encoding(V,"binary","internal_encoding")},E.last_promise=null,E.promise_unhandled_exception=!1,E.queue=function(b){if(E.last_promise)return E.last_promise=E.last_promise.then(function(){if(!E.promise_unhandled_exception)return b(E)}).catch(function(ge){E.respond_to(ge,"$full_message")&&(ge=ge.$full_message()),le.error(ge),E.promise_unhandled_exception=!0,E.exit(1)}),E.last_promise;var V=b(E);return"function"==typeof Promise&&"object"==typeof V&&V instanceof Promise&&(E.last_promise=V),V},E.rb_plus=function(b,V){return Se(b,V)?b+V:b["$+"](V)},E.rb_minus=function(b,V){return Se(b,V)?b-V:b["$-"](V)},E.rb_times=function(b,V){return Se(b,V)?b*V:b["$*"](V)},E.rb_divide=function(b,V){return Se(b,V)?b/V:b["$/"](V)},E.rb_lt=function(b,V){return Se(b,V)?b<V:b["$<"](V)},E.rb_gt=function(b,V){return Se(b,V)?b>V:b["$>"](V)},E.rb_le=function(b,V){return Se(b,V)?b<=V:b["$<="](V)},E.rb_ge=function(b,V){return Se(b,V)?b>=V:b["$>="](V)},E.eqeq=function ae(b,V){return ve(b,V)?b===V:I(b["$=="](V))},E.eqeqeq=function(b,V){return ve(b,V)?b===V:I(b["$==="](V))},E.neqeq=function(b,V){return ve(b,V)?b!==V:I(b["$!="](V))},E.not=function(b){return null==b||!1===b||me===b||!0!==b&&!b["$!"].$$pristine&&I(b["$!"]())},E.return_val=ue,E.return_self=function(){return this},E.return_ivar=function(b){return function(){return null==this[b]?me:this[b]}},E.assign_ivar=function(b){return function(V){return he(this),this[b]=V}},E.assign_ivar_val=function(b,V){return function(){return he(this),this[b]=V}},E.ensure_kwargs=function(b){return null==b?E.hash2([],{}):b.$$is_hash?b:void q(E.ArgumentError,"expected kwargs")},E.get_kwarg=function(b,V){return D(b.$$smap,V)||q(E.ArgumentError,"missing keyword: "+V),b.$$smap[V]},E.large_array_unpack=function(b){var xe,V=b.split(","),ge=V.length;for(xe=0;xe<ge;xe++)switch(V[xe][0]){case void 0:V[xe]=me;break;case"-":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":V[xe]=+V[xe]}return V},E.BasicObject=d=te("BasicObject",null),E.Object=H=te("Object",E.BasicObject),E.Module=ee=te("Module",E.Object),E.Class=$=te("Class",E.Module),E.Opal=x=N("Opal"),E.Kernel=O=N("Kernel"),W(E.BasicObject,E.Class.$$prototype),W(E.Object,E.Class.$$prototype),W(E.Module,E.Class.$$prototype),W(E.Class,E.Class.$$prototype),d.$$const.BasicObject=d,R(H,"BasicObject",d),R(H,"Object",H),R(H,"Module",ee),R(H,"Class",$),R(H,"Opal",x),R(H,"Kernel",O),d.$$class=$,H.$$class=$,ee.$$class=$,$.$$class=$,x.$$class=ee,O.$$class=ee,K(H.$$prototype,"toString",function(){var b=this.$to_s();return b.$$is_string&&"object"==typeof b?b.valueOf():b}),K(H.$$prototype,"$require",E.require),E.top=new H,E.top.$to_s=E.top.$inspect=ue("main"),E.top.$define_method=function Ce(){var b=B(arguments),V=Ce.$$p;return Ce.$$p=null,E.send(H,"define_method",b,V)},E.NilClass=te("NilClass",E.Object),R(H,"NilClass",E.NilClass),(me=E.nil=new E.NilClass).$$id=4,me.call=me.apply=function(){q(E.LocalJumpError,"no block given")},me.$$frozen=!0,me.$$comparable=!1,Object.seal(me),E.thrower=function(b){var V=new Error("unexpected "+b);return V.$thrower_type=b,V.$throw=function(ge){throw null==ge&&(ge=me),V.$v=ge,V},V},E.t_eval_return=E.thrower("return"),TypeError.$$super=Error,E.file_sources={}}).call(this),Opal.loaded(["corelib/runtime.js"]),Opal.modules["corelib/helpers"]=function(C){var le=C.type_error,me=C.coerce_to,d=C.module,H=C.defs,ee=C.slice,$=C.eqeqeq,x=C.Kernel,O=C.truthy,E=C.Opal,Y=C.nil,G=C.$$$;return function(D){var W=d("::","Opal");H(W,"$bridge",function(T,j){return C.bridge(T,j)}),H(W,"$coerce_to!",function(T,j,oe,z){var q,I=Y;return q=ee(arguments,3),I=me(T,j,oe,q),$(j,I)||x.$raise(le(T,j,oe,I)),I},-4),H(W,"$coerce_to?",function(T,j,oe,z){var K,I=Y;return K=ee(arguments,3),!O(T["$respond_to?"](oe))||(I=me(T,j,oe,K),O(I["$nil?"]()))?Y:($(j,I)||x.$raise(le(T,j,oe,I)),I)},-4),H(W,"$try_convert",function(T,j,oe){return $(j,T)?T:O(T["$respond_to?"](oe))?T.$__send__(oe):Y}),H(W,"$compare",function(T,j){var oe;return oe=T["$<=>"](j),O(oe===Y)&&x.$raise(G("ArgumentError"),"comparison of "+T.$class()+" with "+j.$class()+" failed"),oe}),H(W,"$destructure",function(T){if(1==T.length)return T[0];if(T.$$is_array)return T;for(var j=new Array(T.length),oe=0,z=j.length;oe<z;oe++)j[oe]=T[oe];return j}),H(W,"$respond_to?",function(T,j,oe){return null==oe&&(oe=!1),!(null==T||!T.$$class)&&T["$respond_to?"](j,oe)},-3),H(W,"$instance_variable_name!",function(T){return T=E["$coerce_to!"](T,G("String"),"to_str"),O(/^@[a-zA-Z_][a-zA-Z0-9_]*?$/.test(T))||x.$raise(G("NameError").$new("'"+T+"' is not allowed as an instance variable name",T)),T}),H(W,"$class_variable_name!",function(T){return T=E["$coerce_to!"](T,G("String"),"to_str"),O(T.length<3||"@@"!==T.slice(0,2))&&x.$raise(G("NameError").$new("`"+T+"' is not allowed as a class variable name",T)),T}),H(W,"$const_name?",function(T){return"string"!=typeof T&&(T=E["$coerce_to!"](T,G("String"),"to_str")),T[0]===T[0].toUpperCase()}),H(W,"$const_name!",function(T){return O(G("::","String","skip_raise")?"constant":Y)&&(T=E["$coerce_to!"](T,G("String"),"to_str")),(!T||T[0]!=T[0].toUpperCase())&&this.$raise(G("NameError"),"wrong constant name "+T),T}),H(W,"$pristine",function(T,j){for(var z,K,I=(z=ee(arguments,1)).length-1;I>=0;I--)(K=T.$$prototype[C.jsid(z[I])])&&!K.$$stub&&(K.$$pristine=!0);return Y},-2);var B=[];return H(W,"$inspect",function(T){var oe=!1;return function(){try{try{return null===T?"null":void 0===T?"undefined":void 0===T.$$class?Object.prototype.toString.apply(T):"function"!=typeof T.$inspect||T.$inspect.$$stub||-1!==B.indexOf(T.$__id__())?"#<"+T.$$class+":0x"+T.$__id__().$to_s(16)+">":(B.push(T.$__id__()),oe=!0,T.$inspect())}catch(z){if(!C.rescue(z,[G("Exception")]))throw z;try{return"#<"+T.$$class+":0x"+T.$__id__().$to_s(16)+">"}finally{C.pop_exception()}}}finally{oe&&B.pop()}}()},-1)}()},Opal.modules["corelib/module"]=function(C){var l,c,f,u,le=C.truthy,me=C.coerce_to,d=C.const_set,H=C.Object,ee=C.return_ivar,$=C.assign_ivar,x=C.ivar,O=C.deny_frozen_access,E=C.freeze,Y=C.prop,G=C.jsid,D=C.klass,W=C.defs,B=C.send,Z=C.def,T=C.eqeqeq,j=C.Module,oe=C.Kernel,z=C.rb_lt,q=C.rb_gt,K=C.slice,I=C.to_a,A=C.hash2,J=C.Opal,L=C.return_val,S=C.eqeq,M=C.lambda,v=C.range,P=C.send2,R=C.find_super,te=C.alias,de=C.nil,N=C.$$$;return l=[],c=D("::",null,"Module"),f=[c].concat(l),u=C.$r(f),W(c,"$allocate",function(){var y=C.allocate_module(de,function(){});return this!==C.Module&&Object.setPrototypeOf(y,this.$$prototype),y}),Z(c,"$initialize",function p(){var _=p.$$p||de;return p.$$p=null,_!==de?B(this,"module_eval",[],_.$to_proc()):de}),Z(c,"$===",function(_){return!le(null==_)&&C.is_a(_,this)}),Z(c,"$<",function(_){var ne,se,Ee,y=this;if(T(j,_)||oe.$raise(N("TypeError"),"compared with non class/module"),y===_)return!1;for(se=0,Ee=(ne=C.ancestors(y)).length;se<Ee;se++)if(ne[se]===_)return!0;for(se=0,Ee=(ne=C.ancestors(_)).length;se<Ee;se++)if(ne[se]===y)return!1;return de}),Z(c,"$<=",function(_){var m;return le(m=this["$equal?"](_))?m:z(this,_)}),Z(c,"$>",function(_){return T(j,_)||oe.$raise(N("TypeError"),"compared with non class/module"),z(_,this)}),Z(c,"$>=",function(_){var m;return le(m=this["$equal?"](_))?m:q(this,_)}),Z(c,"$<=>",function(_){var m=de;return this===_?0:!T(j,_)||(m=z(this,_),le(m["$nil?"]()))?de:le(m)?-1:1}),Z(c,"$alias_method",function(_,y){var m=this;return O(m),_=me(_,N("String"),"to_str"),y=me(y,N("String"),"to_str"),C.alias(m,_,y),m}),Z(c,"$alias_native",function(_,y){var m=this;return null==y&&(y=_),O(m),C.alias_native(m,_,y),m},-2),Z(c,"$ancestors",function(){return C.ancestors(this)}),Z(c,"$append_features",function(_){return O(_),C.append_features(this,_),this}),Z(c,"$attr_accessor",function(_){var y,m,ne=this;return y=K(arguments),B(ne,"attr_reader",I(m=y)),B(ne,"attr_writer",I(m))},-1),Z(c,"$attr",function(_){var m,ne=this;return 2!=(m=K(arguments)).length||!0!==m[1]&&!1!==m[1]?B(ne,"attr_reader",I(m)):(ne.$warn("optional boolean argument is obsoleted",A(["uplevel"],{uplevel:1})),m[1]?ne.$attr_accessor(m[0]):ne.$attr_reader(m[0]),de)},-1),Z(c,"$attr_reader",function(_){var m,ne=this;m=K(arguments),O(ne);for(var se=ne.$$prototype,Ee=m.length-1;Ee>=0;Ee--){var ke=m[Ee],ce=G(ke),Me=x(ke),$e=ee(Me);C.prop(se,Me,de),$e.$$parameters=[],$e.$$arity=0,C.defn(ne,ce,$e)}return de},-1),Z(c,"$attr_writer",function(_){var m,ne=this;m=K(arguments),O(ne);for(var se=ne.$$prototype,Ee=m.length-1;Ee>=0;Ee--){var ke=m[Ee],ce=G(ke+"="),Me=x(ke),$e=$(Me);$e.$$parameters=[["req"]],$e.$$arity=1,C.prop(se,Me,de),C.defn(ne,ce,$e)}return de},-1),Z(c,"$autoload",function(_,y){var m=this;return O(m),u("Opal")["$const_name?"](_)||oe.$raise(N("NameError"),"autoload must be constant name: "+_),""==y&&oe.$raise(N("ArgumentError"),"empty file name"),m.$$const.hasOwnProperty(_)||(m.$$autoload||(m.$$autoload={}),C.const_cache_version++,m.$$autoload[_]={path:y,loaded:!1,required:!1,success:!1,exception:!1},m.$const_added&&!m.$const_added.$$pristine&&m.$const_added(_)),de}),Z(c,"$autoload?",function(_){var y=this;if(y.$$autoload&&y.$$autoload[_]&&!y.$$autoload[_].required&&!y.$$autoload[_].success)return y.$$autoload[_].path;for(var m=y.$ancestors(),ne=0,se=m.length;ne<se;ne++)if(m[ne].$$autoload&&m[ne].$$autoload[_]&&!m[ne].$$autoload[_].required&&!m[ne].$$autoload[_].success)return m[ne].$$autoload[_].path;return de}),Z(c,"$class_variables",function(){return Object.keys(C.class_variables(this))}),Z(c,"$class_variable_get",function(_){return _=J["$class_variable_name!"](_),C.class_variable_get(this,_,!1)}),Z(c,"$class_variable_set",function(_,y){return O(this),_=J["$class_variable_name!"](_),C.class_variable_set(this,_,y)}),Z(c,"$class_variable_defined?",function(_){return _=J["$class_variable_name!"](_),C.class_variables(this).hasOwnProperty(_)}),Z(c,"$const_added",L(de)),J.$pristine(c,"const_added"),Z(c,"$remove_class_variable",function(_){var y=this;if(O(y),_=J["$class_variable_name!"](_),C.hasOwnProperty.call(y.$$cvars,_)){var m=y.$$cvars[_];return delete y.$$cvars[_],m}oe.$raise(N("NameError"),"cannot remove "+_+" for "+y)}),Z(c,"$constants",function(_){return null==_&&(_=!0),C.constants(this,_)},-1),W(c,"$constants",function(_){if(null==_){var ne,Ee,ke,m=(this.$$nesting||[]).concat(H),se={};for(Ee=0,ke=m.length;Ee<ke;Ee++)for(ne in m[Ee].$$const)se[ne]=!0;return Object.keys(se)}return C.constants(this,_)},-1),W(c,"$nesting",function(){return this.$$nesting||[]}),Z(c,"$const_defined?",function(_,y){var m=this;null==y&&(y=!0),_=u("Opal")["$const_name!"](_),le(_["$=~"](N(J,"CONST_NAME_REGEXP")))||oe.$raise(N("NameError").$new("wrong constant name "+_,_));var ne,ke,ce,se=[m];for(y&&(se=se.concat(C.ancestors(m)),m.$$is_module&&(se=se.concat([H]).concat(C.ancestors(H)))),ke=0,ce=se.length;ke<ce;ke++)if(null!=(ne=se[ke]).$$const[_]||ne.$$autoload&&ne.$$autoload[_]&&!ne.$$autoload[_].required&&!ne.$$autoload[_].success)return!0;return!1},-2),Z(c,"$const_get",function(_,y){var m=this;return null==y&&(y=!0),0===(_=u("Opal")["$const_name!"](_)).indexOf("::")&&"::"!==_&&(_=_.slice(2)),le(-1!=_.indexOf("::")&&"::"!=_)?B(_.$split("::"),"inject",[m],function(se,Ee){return null==se&&(se=de),null==Ee&&(Ee=de),se.$const_get(Ee)}):(le(_["$=~"](N(J,"CONST_NAME_REGEXP")))||oe.$raise(N("NameError").$new("wrong constant name "+_,_)),y?C.$$([m],_):C.const_get_local(m,_))},-2),Z(c,"$const_missing",function(_){var m;return m=S(this,H)?_:this+"::"+_,oe.$raise(N("NameError").$new("uninitialized constant "+m,_))}),Z(c,"$const_set",function(_,y){return O(this),_=J["$const_name!"](_),(le(_["$!~"](N(J,"CONST_NAME_REGEXP")))||le(_["$start_with?"]("::")))&&oe.$raise(N("NameError").$new("wrong constant name "+_,_)),d(this,_,y),y}),Z(c,"$public_constant",L(de)),Z(c,"$define_method",function p(_,y){var se,m=p.$$p||de,Ee=de;return p.$$p=null,O(this),void 0===y&&m===de&&oe.$raise(N("ArgumentError"),"tried to create a Proc object without a block"),m=le(se=m)?se:T(N("Proc"),Ee=y)?y:T(N("Method"),Ee)?y.$to_proc().$$unbound:T(N("UnboundMethod"),Ee)?M(function ce(Me){var be,he=null==ce.$$s?this:ce.$$s,Se=de;return be=K(arguments),Se=y.$bind(he),B(Se,"call",I(be))},{$$arity:-1,$$s:this}):oe.$raise(N("TypeError"),"wrong argument type "+m.$class()+" (expected Proc/Method)"),"undefined"!=typeof Proxy&&(m.$$proxy_target=m,m=new Proxy(m,{apply:function(ce,Me,$e){var be=ce.$$jsid;ce.$$jsid=_;try{return ce.apply(Me,$e)}catch(he){if(he===ce.$$brk||he===ce.$$ret)return he.$v;throw he}finally{ce.$$jsid=be}}})),m.$$jsid=_,m.$$s=null,m.$$def=m,m.$$define_meth=!0,C.defn(this,G(_),m)},-2),Z(c,"$freeze",function(){var _=this;return le(_["$frozen?"]())?_:(_.hasOwnProperty("$$base_module")||Y(_,"$$base_module",null),E(_))}),Z(c,"$remove_method",function(_){var m,ne=this;m=K(arguments);for(var se=0;se<m.length;se++){var Ee=m[se];"string"==typeof Ee||Ee.$$is_string||ne.$raise(N("TypeError"),ne.$name()+" is not a symbol nor a string"),O(ne),C.rdef(ne,"$"+Ee)}return ne},-1),Z(c,"$singleton_class?",function(){return!!this.$$is_singleton}),Z(c,"$include",function(_){for(var m,ne=this,se=(m=K(arguments)).length-1;se>=0;se--){var Ee=m[se];Ee.$$is_module||oe.$raise(N("TypeError"),"wrong argument type "+Ee.$class()+" (expected Module)"),Ee.$append_features(ne),Ee.$included(ne)}return ne},-1),Z(c,"$included_modules",function(){return C.included_modules(this)}),Z(c,"$include?",function(_){_.$$is_module||oe.$raise(N("TypeError"),"wrong argument type "+_.$class()+" (expected Module)");var m,ne,se,Ee=C.ancestors(this);for(m=0,ne=Ee.length;m<ne;m++)if((se=Ee[m])===_&&se!==this)return!0;return!1}),Z(c,"$instance_method",function(_){var y=this,m=y.$$prototype[G(_)];return(!m||m.$$stub)&&oe.$raise(N("NameError").$new("undefined method `"+_+"' for class `"+y.$name()+"'",_)),N("UnboundMethod").$new(y,m.$$owner||y,m,_)}),Z(c,"$instance_methods",function(_){return null==_&&(_=!0),le(_)?C.instance_methods(this):C.own_instance_methods(this)},-1),Z(c,"$included",L(de)),Z(c,"$extended",L(de)),Z(c,"$extend_object",function(_){return O(_),de}),Z(c,"$method_added",function(_){return K(arguments),de},-1),Z(c,"$method_removed",function(_){return K(arguments),de},-1),Z(c,"$method_undefined",function(_){return K(arguments),de},-1),Z(c,"$module_eval",function p(_){var ne,se,y=p.$$p||de,Ee=this,ke=de,$e=de,be=de,he=de,Se=de;p.$$p=null,ne=K(arguments),le(y["$nil?"]())&&le(!!C.compile)?(le(v(1,3,!1)["$cover?"](ne.$size()))||oe.$raise(N("ArgumentError"),"wrong number of arguments (0 for 1..3)"),ke=null==(se=[].concat(I(ne)))[0]?de:se[0],$e=A(["file","eval"],{file:le(be=null==se[1]?de:se[1])?be:"(eval)",eval:!0}),he=C.hash({arity_check:!1}).$merge($e),Se=J.$compile(ke,he),y=B(oe,"proc",[],function ue(){var Ce=null==ue.$$s?this:ue.$$s;return new Function("Opal,self","return "+Se)(C,Ce)},{$$s:Ee})):le(ne["$any?"]())&&oe.$raise(N("ArgumentError"),"wrong number of arguments ("+ne.$size()+" for 0)\n\n  NOTE:If you want to enable passing a String argument please add \"require 'opal-parser'\" to your script\n");var ae,ve=y.$$s;return y.$$s=null,ae=y.apply(Ee,[Ee]),y.$$s=ve,ae},-1),Z(c,"$module_exec",function p(_){var ne,y=p.$$p||de,se=this;p.$$p=null,ne=K(arguments),y===de&&oe.$raise(N("LocalJumpError"),"no block given");var ke,Ee=y.$$s;return y.$$s=null,ke=y.apply(se,ne),y.$$s=Ee,ke},-1),Z(c,"$method_defined?",function(_){var m=this.$$prototype[G(_)];return!!m&&!m.$$stub}),Z(c,"$module_function",function(_){var m,ne=this;if(m=K(arguments),O(ne),0===m.length)return ne.$$module_function=!0,de;for(var se=0,Ee=m.length;se<Ee;se++){var ke=m[se],ce=G(ke),Me=ne.$$prototype[ce];C.defs(ne,ce,Me)}return 1===m.length?m[0]:m},-1),Z(c,"$name",function(){var _=this;if(_.$$full_name)return _.$$full_name;for(var y=[],m=_;m;){if(m.$$name===de||null==m.$$name)return de;if(y.unshift(m.$$name),(m=m.$$base_module)===H)break}return 0===y.length?de:_.$$full_name=y.join("::")}),Z(c,"$prepend",function(_){var m,ne=this;0===(m=K(arguments)).length&&oe.$raise(N("ArgumentError"),"wrong number of arguments (given 0, expected 1+)");for(var se=m.length-1;se>=0;se--){var Ee=m[se];Ee.$$is_module||oe.$raise(N("TypeError"),"wrong argument type "+Ee.$class()+" (expected Module)"),Ee.$prepend_features(ne),Ee.$prepended(ne)}return ne},-1),Z(c,"$prepend_features",function(_){var y=this;return O(_),y.$$is_module||oe.$raise(N("TypeError"),"wrong argument type "+y.$class()+" (expected Module)"),C.prepend_features(y,_),y}),Z(c,"$prepended",L(de)),Z(c,"$remove_const",function(_){return O(this),C.const_remove(this,_)}),Z(c,"$to_s",function(){var y,_=this;return le(y=C.Module.$name.call(_))?y:"#<"+(_.$$is_module?"Module":"Class")+":0x"+_.$__id__().$to_s(16)+">"}),Z(c,"$undef_method",function(_){var m,ne=this;m=K(arguments);for(var se=0;se<m.length;se++){var Ee=m[se];"string"==typeof Ee||Ee.$$is_string||ne.$raise(N("TypeError"),ne.$name()+" is not a symbol nor a string"),O(ne),C.udef(ne,"$"+m[se])}return ne},-1),Z(c,"$instance_variables",function(){var _=this,y=de;C.Module.$$nesting=f,y=_.$constants();var m=[];for(var ne in _)_.hasOwnProperty(ne)&&"$"!==ne.charAt(0)&&"constructor"!==ne&&!y["$include?"](ne)&&m.push("@"+ne);return m}),Z(c,"$dup",function p(){var _=p.$$p||de,y=this,m=de;return p.$$p=null,(m=P(y,R(y,"dup",p,!1,!0),"dup",[],_)).$copy_class_variables(y),m.$copy_constants(y),m}),Z(c,"$copy_class_variables",function(_){for(var m in _.$$cvars)this.$$cvars[m]=_.$$cvars[m]}),Z(c,"$copy_constants",function(_){var m,ne=_.$$const;for(m in ne)d(this,m,ne[m])}),Z(c,"$refine",function p(_){var m,se,ke,y=p.$$p||de,ne=this,Ee=de;return p.$$p=null,se=(m=[ne,de,de])[0],Ee=m[1],ke=C.id(_),void 0===ne.$$refine_modules&&(ne.$$refine_modules=Object.create(null)),(Ee=void 0===ne.$$refine_modules[ke]?ne.$$refine_modules[ke]=N("Refinement").$new():ne.$$refine_modules[ke]).refinement_module=se,Ee.refined_class=_,B(Ee,"class_exec",[],y.$to_proc()),Ee}),Z(c,"$refinements",function(){var y=this.$$refine_modules,m=A([],{});if(void 0===y)return m;for(var ne in y)m["$[]="](y[ne].refined_class,y[ne]);return m}),Z(c,"$using",function(_){return oe.$raise("Module#using is not permitted in methods")}),te(c,"class_eval","module_eval"),te(c,"class_exec","module_exec"),te(c,"inspect","to_s"),function(F,g){var l=D("::",g,"Refinement"),c=l.$$prototype;return c.refinement_module=c.refined_class=de,l.$attr_reader("refined_class"),Z(l,"$inspect",function f(){var u=f.$$p||de,p=this;return f.$$p=null,le(p.refinement_module)?"#<refinement:"+p.refined_class.$inspect()+"@"+p.refinement_module.$inspect()+">":P(p,R(p,"inspect",f,!1,!0),"inspect",[],u)})}(0,j)},Opal.modules["corelib/class"]=function(C){var oe,z,q,K,le=C.klass,me=C.send,d=C.defs,H=C.def,ee=C.rb_plus,$=C.return_val,x=C.slice,O=C.send2,E=C.find_super,Y=C.Kernel,G=C.alias,B=C.nil,Z=C.$$$;return C.top.$require("corelib/module"),oe=[],q=[z=le("::",null,"Class")].concat(oe),K=C.$r(q),d(z,"$new",function I(A){var J=I.$$p||B;if(I.$$p=null,null==A&&(A=K("Object")),!A.$$is_class)throw C.TypeError.$new("superclass must be a Class");var L=C.allocate_class(B,A);return A.$inherited(L),J!==B&&me(L,"class_eval",[],J.$to_proc()),L},-1),H(z,"$allocate",function(){var J=new this.$$constructor;return J.$$id=C.uid(),J}),H(z,"$descendants",function(){return ee(this.$subclasses(),me(this.$subclasses(),"map",[],"descendants".$to_proc()).$flatten())}),H(z,"$inherited",$(B)),H(z,"$initialize_dup",function(A){var J=this;J.$initialize_copy(A),J.$$name=null,J.$$full_name=null}),H(z,"$new",function I(A){var S,J=I.$$p||B,M=this;I.$$p=null,S=x(arguments);var v=M.$allocate();return C.send(v,v.$initialize,S,J),v},-1),H(z,"$subclasses",function(){var A=this;if("undefined"!=typeof WeakRef){var J,L,S=[];for(J=0;J<A.$$subclasses.length;J++)void 0!==(L=A.$$subclasses[J].deref())&&S.push(L);return S}return A.$$subclasses}),H(z,"$superclass",function(){return this.$$super||B}),H(z,"$to_s",function I(){var J=this;I.$$p=null;var L=J.$$singleton_of;return L&&L.$$is_a_module?"#<Class:"+L.$name()+">":L?"#<Class:#<"+L.$$class.$name()+":0x"+C.id(L).$to_s(16)+">>":O(J,E(J,"to_s",I,!1,!0),"to_s",[],null)}),H(z,"$attached_object",function(){var A=this;if(null!=A.$$singleton_of)return A.$$singleton_of;Y.$raise(Z("TypeError"),"`"+A+"' is not a singleton class")}),G(z,"inspect","to_s")},Opal.modules["corelib/basic_object"]=function(C){"use strict";var z,me=C.slice,d=C.def,H=C.alias,ee=C.return_val,$=C.Opal,x=C.truthy,O=C.range,E=C.Kernel,Y=C.to_a,G=C.hash2,D=C.send,W=C.eqeq,B=C.rb_ge,Z=C.nil,T=C.$$$;return d(z=(0,C.klass)("::",null,"BasicObject"),"$initialize",function(K){return me(arguments),Z},-1),d(z,"$==",function(K){return this===K}),d(z,"$eql?",function(K){return this["$=="](K)}),H(z,"equal?","=="),d(z,"$__id__",function(){var K=this;return null!=K.$$id||C.prop(K,"$$id",C.uid()),K.$$id}),d(z,"$__send__",function q(K,I){var L,A=q.$$p||Z,S=this;q.$$p=null,L=me(arguments,1),K.$$is_string||S.$raise(T("TypeError"),S.$inspect()+" is not a symbol nor a string");var M=S[C.jsid(K)];return M?(A!==Z&&(M.$$p=A),M.apply(S,L)):(A!==Z&&(S.$method_missing.$$p=A),S.$method_missing.apply(S,[K].concat(L)))},-2),d(z,"$!",ee(!1)),$.$pristine("!"),d(z,"$!=",function(K){return this["$=="](K)["$!"]()}),d(z,"$instance_eval",function q(K){var J,L,I=q.$$p||Z,S=this,M=Z,R=Z,te=Z,k=Z,de=Z;if(q.$$p=null,J=me(arguments),x(I["$nil?"]())&&x(!!C.compile))x(O(1,3,!1)["$cover?"](J.$size()))||E.$raise(T("ArgumentError"),"wrong number of arguments (0 for 1..3)"),M=null==(L=[].concat(Y(J)))[0]?Z:L[0],R=G(["file","eval"],{file:x(te=null==L[1]?Z:L[1])?te:"(eval)",eval:!0}),k=C.hash({arity_check:!1}).$merge(R),de=$.$compile(M,k),I=D(E,"proc",[],function g(){var l=null==g.$$s?this:g.$$s;return new Function("Opal,self","return "+de)(C,l)},{$$s:S});else{if(x(I["$nil?"]())&&x(B(J.$length(),1))&&W(J.$first()["$[]"](0),"@"))return S.$instance_variable_get(J.$first());x(J["$any?"]())&&E.$raise(T("ArgumentError"),"wrong number of arguments ("+J.$size()+" for 0)")}var F,N=I.$$s;if(I.$$s=null,S.$$is_a_module){S.$$eval=!0;try{F=I.call(S,S)}finally{S.$$eval=!1}}else F=I.call(S,S);return I.$$s=N,F},-1),d(z,"$instance_exec",function q(K){var J,I=q.$$p||Z,L=this;q.$$p=null,J=me(arguments),x(I)||E.$raise(T("ArgumentError"),"no block given");var M,S=I.$$s;if(I.$$s=null,L.$$is_a_module){L.$$eval=!0;try{M=I.apply(L,J)}finally{L.$$eval=!1}}else M=I.apply(L,J);return I.$$s=S,M},-1),d(z,"$singleton_method_added",function(K){return me(arguments),Z},-1),d(z,"$singleton_method_removed",function(K){return me(arguments),Z},-1),d(z,"$singleton_method_undefined",function(K){return me(arguments),Z},-1),d(z,"$method_missing",function q(K,I){var L,S=this,M=Z;return q.$$p=null,L=me(arguments,1),M=$.$inspect(S),E.$raise(T("NoMethodError").$new("undefined method `"+K+"' for "+M,K,L),Z,E.$caller(1))},-2),$.$pristine(z,"method_missing"),d(z,"$respond_to_missing?",function(K,I){return null==I&&(I=!1),!1},-2)},Opal.modules["corelib/kernel"]=function(C){"use strict";var N,le=C.truthy,me=C.coerce_to,d=C.respond_to,H=C.Opal,ee=C.deny_frozen_access,$=C.freeze,x=C.freeze_props,O=C.jsid,E=C.module,Y=C.return_val,G=C.def,D=C.Kernel,W=C.gvars,B=C.slice,Z=C.send,T=C.to_a,j=C.ensure_kwargs,oe=C.eqeq,z=C.hash2,q=C.rb_plus,K=C.eqeqeq,I=C.return_self,A=C.rb_le,J=C.extract_kwargs,L=C.rb_lt,S=C.Object,M=C.alias,v=C.klass,R=C.nil,te=C.$$$;return function(k,de){var N=E("::","Kernel"),F=[N].concat([]),g=C.$r(F);G(N,"$=~",Y(!1)),G(N,"$!~",function(f){return this["$=~"](f)["$!"]()}),G(N,"$===",function(f){var p;return le(p=this.$object_id()["$=="](f.$object_id()))?p:this["$=="](f)}),G(N,"$<=>",function(f){this.$$comparable=!0;var p=this["$=="](f);return p&&p!==R?0:R}),G(N,"$method",function(f){var u=this,p=u[O(f)];return(!p||p.$$stub)&&D.$raise(te("NameError").$new("undefined method `"+f+"' for class `"+u.$class()+"'",f)),te("Method").$new(u,p.$$owner||u.$class(),p,f)}),G(N,"$methods",function(f){return null==f&&(f=!0),le(f)?C.methods(this):C.own_methods(this)},-1),G(N,"$public_methods",function(f){return null==f&&(f=!0),le(f)?C.methods(this):C.receiver_methods(this)},-1),G(N,"$Array",function(f){var u;return f===R?[]:f.$$is_array?f:(u=H["$coerce_to?"](f,te("Array"),"to_ary"))!==R||(u=H["$coerce_to?"](f,te("Array"),"to_a"))!==R?u:[f]}),G(N,"$at_exit",function c(){var u,f=c.$$p||R;return null==W.__at_exit__&&(W.__at_exit__=R),c.$$p=null,W.__at_exit__=le(u=W.__at_exit__)?u:[],W.__at_exit__["$<<"](f),f}),G(N,"$caller",function(f,u){var p,_;null==f&&(f=1),null==u&&(u=R),_=[];for(var y=f+1,m=(p=(new Error).$backtrace()).length;y<m;y++)p[y].match(/runtime\.js/)||_.push(p[y]);return u!=R&&(_=_.slice(0,u)),_},-1),G(N,"$caller_locations",function(f){var u,_=this;return u=B(arguments),Z(Z(_,"caller",T(u)),"map",[],function(m){return null==m&&(m=R),te(te(te("Thread"),"Backtrace"),"Location").$new(m)})},-1),G(N,"$class",function(){return this.$$class}),G(N,"$copy_instance_variables",function(f){var _,y,m,p=Object.keys(f);for(_=0,y=p.length;_<y;_++)"$"!==(m=p[_]).charAt(0)&&f.hasOwnProperty(m)&&(this[m]=f[m])}),G(N,"$copy_singleton_methods",function(f){var p,_,y,m;if(f.hasOwnProperty("$$meta")&&null!==f.$$meta){var ne=C.get_singleton_class(f),se=C.get_singleton_class(this);for(p=0,m=(y=Object.getOwnPropertyNames(ne.$$prototype)).length;p<m;p++)C.is_method(_=y[p])&&(se.$$prototype[_]=ne.$$prototype[_]);se.$$const=Object.assign({},ne.$$const),Object.setPrototypeOf(se.$$prototype,Object.getPrototypeOf(ne.$$prototype))}for(p=0,m=(y=Object.getOwnPropertyNames(f)).length;p<m;p++)"$"===(_=y[p]).charAt(0)&&"$"!==_.charAt(1)&&f.hasOwnProperty(_)&&(this[_]=f[_])}),G(N,"$clone",function(f){var u,p=this,_=R;return null==(u=(f=j(f)).$$smap.freeze)&&(u=R),le(u["$nil?"]())||oe(u,!0)||oe(u,!1)||p.$raise(g("ArgumentError"),"unexpected value for freeze: "+u.$class()),(_=p.$class().$allocate()).$copy_instance_variables(p),_.$copy_singleton_methods(p),_.$initialize_clone(p,z(["freeze"],{freeze:u})),(oe(u,!0)||le(u["$nil?"]())&&le(p["$frozen?"]()))&&_.$freeze(),_},-1),G(N,"$initialize_clone",function(f,u){return u=j(u),this.$initialize_copy(f),this},-2),G(N,"$define_singleton_method",function c(f,u){var p=c.$$p||R;return c.$$p=null,Z(this.$singleton_class(),"define_method",[f,u],p.$to_proc())},-2),G(N,"$dup",function(){var f=this,u=R;return(u=f.$class().$allocate()).$copy_instance_variables(f),u.$initialize_dup(f),u}),G(N,"$initialize_dup",function(f){return this.$initialize_copy(f)}),G(N,"$enum_for",function c(f,u){var _,y,m,p=c.$$p||R,ne=this;return c.$$p=null,(_=B(arguments)).length>0&&(y=_.shift()),null==y&&(y="each"),m=_,Z(te("Enumerator"),"for",[ne,y].concat(T(m)),p.$to_proc())},-1),G(N,"$equal?",function(f){return this===f}),G(N,"$exit",function(f){var u;for(null==W.__at_exit__&&(W.__at_exit__=R),null==f&&(f=!0),W.__at_exit__=le(u=W.__at_exit__)?u:[];!le(W.__at_exit__["$empty?"]());)W.__at_exit__.$pop().$call();return f=f.$$is_boolean?f?0:1:me(f,te("Integer"),"to_int"),C.exit(f),R},-1),G(N,"$extend",function(f){var p,_=this;0==(p=B(arguments)).length&&_.$raise(te("ArgumentError"),"wrong number of arguments (given 0, expected 1+)"),ee(_);for(var y=_.$singleton_class(),m=p.length-1;m>=0;m--){var ne=p[m];ne.$$is_module||D.$raise(te("TypeError"),"wrong argument type "+ne.$class()+" (expected Module)"),ne.$append_features(y),ne.$extend_object(_),ne.$extended(_)}return _},-1),G(N,"$freeze",function(){var f=this;return le(f["$frozen?"]())?f:"object"==typeof f?(x(f),$(f)):f}),G(N,"$frozen?",function(){switch(typeof this){case"string":case"symbol":case"number":case"boolean":return!0;case"object":return this.$$frozen||!1;default:return!1}}),G(N,"$gets",function(f){var u;return null==W.stdin&&(W.stdin=R),u=B(arguments),Z(W.stdin,"gets",T(u))},-1),G(N,"$hash",function(){return this.$__id__()}),G(N,"$initialize_copy",Y(R));var l=[];G(N,"$inspect",function(){var f=this,u=R,p=R,_=R;return function(){try{try{return u="",p=f.$__id__(),le(l["$include?"](p))?u=" ...":(l["$<<"](p),_=!0,Z(f.$instance_variables(),"each",[],function m(ne){var Ee,ke;return null==ne&&(ne=R),Ee=(null==m.$$s?this:m.$$s).$instance_variable_get(ne),ke=g("Opal").$inspect(Ee),u=q(u," "+ne+"="+ke)},{$$s:f})),"#<"+f.$class()+":0x"+p.$to_s(16)+u+">"}catch(m){if(!C.rescue(m,[g("StandardError")]))throw m;try{return"#<"+f.$class()+":0x"+p.$to_s(16)+">"}finally{C.pop_exception()}}}finally{le(_)&&l.$pop()}}()}),G(N,"$instance_of?",function(f){return!f.$$is_class&&!f.$$is_module&&D.$raise(te("TypeError"),"class or module required"),this.$$class===f}),G(N,"$instance_variable_defined?",function(f){return f=H["$instance_variable_name!"](f),C.hasOwnProperty.call(this,f.substr(1))}),G(N,"$instance_variable_get",function(f){f=H["$instance_variable_name!"](f);var p=this[C.ivar(f.substr(1))];return null==p?R:p}),G(N,"$instance_variable_set",function(f,u){return ee(this),f=H["$instance_variable_name!"](f),this[C.ivar(f.substr(1))]=u}),G(N,"$remove_instance_variable",function(f){var u=this;f=H["$instance_variable_name!"](f);var _,p=C.ivar(f.substr(1));return u.hasOwnProperty(p)?(_=u[p],delete u[p],_):D.$raise(te("NameError"),"instance variable "+f+" not defined")}),G(N,"$instance_variables",function(){var p,u=[];for(var _ in this)this.hasOwnProperty(_)&&"$"!==_.charAt(0)&&(p="$"===_.substr(-1)?_.slice(0,_.length-1):_,u.push("@"+p));return u}),G(N,"$Integer",function(f,u){var p,_,y;return f.$$is_string?"0"===f?0:(void 0===u?u=0:(1===(u=me(u,te("Integer"),"to_int"))||u<0||u>36)&&D.$raise(te("ArgumentError"),"invalid radix "+u),_=(_=(_=f.toLowerCase()).replace(/(\d)_(?=\d)/g,"$1")).replace(/^(\s*[+-]?)(0[bodx]?)/,function(m,ne,se){switch(se){case"0b":if(0===u||2===u)return u=2,ne;case"0":case"0o":if(0===u||8===u)return u=8,ne;case"0d":if(0===u||10===u)return u=10,ne;case"0x":if(0===u||16===u)return u=16,ne}D.$raise(te("ArgumentError"),'invalid value for Integer(): "'+f+'"')}),y="0-"+((u=0===u?10:u)<=10?u-1:"9a-"+String.fromCharCode(u-11+97)),new RegExp("^\\s*[+-]?["+y+"]+\\s*$").test(_)||D.$raise(te("ArgumentError"),'invalid value for Integer(): "'+f+'"'),p=parseInt(_,u),isNaN(p)&&D.$raise(te("ArgumentError"),'invalid value for Integer(): "'+f+'"'),p):(void 0!==u&&D.$raise(te("ArgumentError"),"base specified for non string value"),f===R&&D.$raise(te("TypeError"),"can't convert nil into Integer"),f.$$is_number?((f===1/0||f===-1/0||isNaN(f))&&D.$raise(te("FloatDomainError"),f),Math.floor(f)):f["$respond_to?"]("to_int")&&(p=f.$to_int())!==R?p:H["$coerce_to!"](f,te("Integer"),"to_i"))},-2),G(N,"$Float",function(f){var u;return f===R&&D.$raise(te("TypeError"),"can't convert nil into Float"),f.$$is_string?(u=(u=f.toString()).replace(/(\d)_(?=\d)/g,"$1"),/^\s*[-+]?0[xX][0-9a-fA-F]+\s*$/.test(u)?D.$Integer(u):(/^\s*[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?\s*$/.test(u)||D.$raise(te("ArgumentError"),'invalid value for Float(): "'+f+'"'),parseFloat(u))):H["$coerce_to!"](f,te("Float"),"to_f")}),G(N,"$Hash",function(f){return le(f["$nil?"]())||oe(f,[])?z([],{}):K(te("Hash"),f)?f:H["$coerce_to!"](f,te("Hash"),"to_hash")}),G(N,"$is_a?",function(f){return!f.$$is_class&&!f.$$is_module&&D.$raise(te("TypeError"),"class or module required"),C.is_a(this,f)}),G(N,"$itself",I),G(N,"$lambda",function c(){var f=c.$$p||R;return c.$$p=null,C.lambda(f)}),G(N,"$load",function(f){return f=H["$coerce_to!"](f,te("String"),"to_str"),C.load(f)}),G(N,"$loop",function c(){var f=c.$$p||R,p=R;if(c.$$p=null,f===R)return Z(this,"enum_for",["loop"],function(){return te(te("Float"),"INFINITY")});for(;le(!0);)try{C.yieldX(f,[])}catch(_){if(!C.rescue(_,[te("StopIteration")]))throw _;p=_;try{return p.$result()}finally{C.pop_exception()}}return this}),G(N,"$nil?",Y(!1)),G(N,"$printf",function(f){var u,p,_=this;return u=B(arguments),le((p=u)["$any?"]())&&_.$print(Z(_,"format",T(p))),R},-1),G(N,"$proc",function c(){var f=c.$$p||R;return c.$$p=null,le(f)||D.$raise(te("ArgumentError"),"tried to create Proc object without a block"),f.$$is_lambda=!1,f}),G(N,"$puts",function(f){var u;return null==W.stdout&&(W.stdout=R),u=B(arguments),Z(W.stdout,"puts",T(u))},-1),G(N,"$p",function(f){var u,p;return u=B(arguments),Z(p=u,"each",[],function(y){return null==W.stdout&&(W.stdout=R),null==y&&(y=R),W.stdout.$puts(y.$inspect())}),le(A(p.$length(),1))?p["$[]"](0):p},-1),G(N,"$print",function(f){var u;return null==W.stdout&&(W.stdout=R),u=B(arguments),Z(W.stdout,"print",T(u))},-1),G(N,"$readline",function(f){var u;return null==W.stdin&&(W.stdin=R),u=B(arguments),Z(W.stdin,"readline",T(u))},-1),G(N,"$warn",function(f,u){var p,_,y,m,ne,se,Ee=this,ke=R;return null==W.VERBOSE&&(W.VERBOSE=R),null==W.stderr&&(W.stderr=R),p=B(arguments),_=J(p),y=p,null==(m=(_=j(_)).$$smap.uplevel)&&(m=R),le(m)&&(m=H["$coerce_to!"](m,te("Integer"),"to_str"),le(L(m,0))&&D.$raise(te("ArgumentError"),"negative level ("+m+")"),ne=(se=Ee.$caller(q(m,1),1).$first())===R||null==se?R:se.$split(":in `"),ke=ne===R||null==ne?R:ne.$first(),le(ke)&&(ke+=": "),y=Z(y,"map",[],function(Me){return null==Me&&(Me=R),ke+"warning: "+Me})),le(W.VERBOSE["$nil?"]())||le(y["$empty?"]())?R:Z(W.stderr,"puts",T(y))},-1),G(N,"$raise",function(f,u,p){throw null==W["!"]&&(W["!"]=R),null==W["@"]&&(W["@"]=R),null==u&&(u=R),null==p&&(p=R),null==f&&W["!"]!==R?W["!"]:(null==f?f=te("RuntimeError").$new(""):d(f,"$to_str")?f=te("RuntimeError").$new(f.$to_str()):f.$$is_class&&d(f,"$exception")?f=f.$exception(u):f.$$is_exception||(f=te("TypeError").$new("exception class/object expected")),p!==R&&f.$set_backtrace(p),W["!"]!==R&&C.exceptions.push(W["!"]),W["!"]=f,W["@"]=f.$backtrace(),f)},-1),G(N,"$rand",function(f){return void 0===f?te(te("Random"),"DEFAULT").$rand():(f.$$is_number&&(f<0&&(f=Math.abs(f)),f%1!=0&&(f=f.$to_i()),0===f&&(f=void 0)),te(te("Random"),"DEFAULT").$rand(f))},-1),G(N,"$respond_to?",function(f,u){var p=this;null==u&&(u=!1);var _=p[O(f)];return"function"==typeof _&&!_.$$stub||!0!==p["$respond_to_missing?"].$$pristine&&p["$respond_to_missing?"](f,u)},-2),G(N,"$respond_to_missing?",function(f,u){return null==u&&(u=!1),!1},-2),H.$pristine(N,"respond_to?","respond_to_missing?"),G(N,"$require",function(f){return"string"!=typeof f&&C.String&&C.Array&&(f=H["$coerce_to!"](f,te("String"),"to_str")),C.require(f)}),G(N,"$require_relative",function(f){return H["$try_convert!"](f,te("String"),"to_str"),f=te("File").$expand_path(te("File").$join(C.current_file,"..",f)),C.require(f)}),G(N,"$require_tree",function(f,u){var p;null==(p=(u=j(u)).$$smap.autoload)&&(p=!1);var _=[];for(var y in f=te("File").$expand_path(f),"."===(f=C.normalize(f))&&(f=""),C.modules)y["$start_with?"](f)&&_.push(p?[y,!0]:[y,C.require(y)]);return _},-2),G(N,"$singleton_class",function(){return C.get_singleton_class(this)}),G(N,"$sleep",function(f){null==f&&(f=R),f===R&&D.$raise(te("TypeError"),"can't convert NilClass into time interval"),f.$$is_number||D.$raise(te("TypeError"),"can't convert "+f.$class()+" into time interval"),f<0&&D.$raise(te("ArgumentError"),"time interval must be positive");for(var u=C.global.performance?function(){return performance.now()}:function(){return new Date},p=u();u()-p<=1e3*f;);return Math.round(f)},-1),G(N,"$srand",function(f){return null==f&&(f=g("Random").$new_seed()),te("Random").$srand(f)},-1),G(N,"$String",function(f){var u;return le(u=H["$coerce_to?"](f,te("String"),"to_str"))?u:H["$coerce_to!"](f,te("String"),"to_s")}),G(N,"$tap",function c(){var f=c.$$p||R;return c.$$p=null,C.yield1(f,this),this}),G(N,"$to_proc",I),G(N,"$to_s",function(){return"#<"+this.$class()+":0x"+this.$__id__().$to_s(16)+">"}),G(N,"$catch",function c(f){var u=c.$$p||R,p=R,_=R;c.$$p=null,null==f&&(f=R);try{return f=le(p=f)?p:S.$new(),C.yield1(u,f)}catch(y){if(!C.rescue(y,[te("UncaughtThrowError")]))throw y;_=y;try{return oe(_.$tag(),f)?_.$value():D.$raise()}finally{C.pop_exception()}}},-1),G(N,"$throw",function(f,u){return null==u&&(u=R),D.$raise(te("UncaughtThrowError").$new(f,u))},-2),G(N,"$open",function c(f){var _,u=c.$$p||R;return c.$$p=null,_=B(arguments),Z(te("File"),"open",T(_),u.$to_proc())},-1),G(N,"$yield_self",function c(){var f=c.$$p||R;return c.$$p=null,f===R?Z(this,"enum_for",["yield_self"],Y(1)):C.yield1(f,this)}),M(N,"fail","raise"),M(N,"kind_of?","is_a?"),M(N,"object_id","__id__"),M(N,"public_send","__send__"),M(N,"send","__send__"),M(N,"then","yield_self"),M(N,"to_enum","enum_for")}(),N=v("::",null,"Object"),delete S.$$prototype.$require,N.$include(D)},Opal.modules["corelib/main"]=function(C){var E,le=C.return_val,me=C.def,d=C.Object,H=C.slice,ee=C.Kernel;return me(E=C.get_singleton_class(C.top),"$to_s",le("main")),me(E,"$include",function(D){return d.$include(D)}),me(E,"$autoload",function(D){var W;return W=H(arguments),C.Object.$autoload.apply(C.Object,W)},-1),me(E,"$using",function(D){return ee.$raise("main.using is permitted only at toplevel")})},Opal.modules["corelib/error/errno"]=function(C){var D,W,B,le=C.module,me=C.truthy,d=C.rb_plus,H=C.send2,ee=C.find_super,$=C.def,x=C.klass,O=[],E=C.nil,Y=C.$$$;return function(G,D){var Z,j,W=le("::","Errno"),T=([W].concat(D),E);for(Z=[["EINVAL","Invalid argument",22],["EEXIST","File exists",17],["EISDIR","Is a directory",21],["EMFILE","Too many open files",24],["ESPIPE","Illegal seek",29],["EACCES","Permission denied",13],["EPERM","Operation not permitted",1],["ENOENT","No such file or directory",2],["ENAMETOOLONG","File name too long",36]],T=E,j=0;j<Z.length;j++)!function(){var K,z=Z[j][1],q=Z[j][2];(T=C.klass(W,C.SystemCallError,Z[j][0])).errno=q,K=C.get_singleton_class(T),$(K,"$new",function A(J){var M=E;return A.$$p=null,null==J&&(J=E),M=z,me(J)&&(M=d(M," - "+J)),H(this,ee(this,"new",A,!1,!0),"new",[M],null)},-1)}()}(0,O),D=Y("StandardError"),W=O,[B=x("::",D,"SystemCallError")].concat(W),$(B,"$errno",function(){return this.$class().$errno()}),C.get_singleton_class(B).$attr_reader("errno")},Opal.modules["corelib/error"]=function(C){var A,J,le=C.klass,me=C.slice,d=C.gvars,H=C.defs,ee=C.send,$=C.to_a,x=C.def,O=C.truthy,E=C.hash2,Y=C.Kernel,G=C.not,D=C.rb_plus,W=C.eqeq,B=C.Object,Z=C.ensure_kwargs,T=C.send2,j=C.find_super,oe=C.module,z=[],q=C.nil,K=C.$$$;return function(I,A,J){var P,L=le("::",A,"Exception"),S=[L].concat(J),M=C.$r(S);function R(te){for(var de,k=[],N=0;N<te.length;N++){var F=te[N];!F||!F.$$is_string||((de=F.match(/^    at (.*?) \((.*?)\)$/))?k.push(de[2]+":in `"+de[1]+"'"):(de=F.match(/^    at (.*?)$/))?k.push(de[1]+":in `undefined'"):(de=F.match(/^  from (.*?)$/))?k.push(de[1]):(de=F.match(/^(.*?)@(.*?)$/))&&k.push(de[2]+":in `"+de[1]+"'"))}return k}L.$$prototype.message=q,C.prop(L.$$prototype,"$$is_exception",!0),Error.stackTraceLimit=100,H(L,"$new",function(k){var N,F=this;null==d["!"]&&(d["!"]=q);var g=(N=me(arguments)).length>0?N[0]:q,l=new F.$$constructor(g);return l.name=F.$$name,l.message=g,l.cause=d["!"],C.send(l,l.$initialize,N),C.config.enable_stack_trace&&Error.captureStackTrace&&Error.captureStackTrace(l,P),l},-1),P=L.$new,H(L,"$exception",function(k){var de,F=this;return de=me(arguments),ee(F,"new",$(de))},-1),x(L,"$initialize",function(k){var de,N,F=this;return de=me(arguments),F.message=(N=de).length>0?N[0]:q},-1),x(L,"$backtrace",function(){var k=this;if(k.backtrace)return k.backtrace;var de=k.stack;return void 0!==de&&de.$$is_string?k.backtrace=R(de.split("\n")):de?k.backtrace=R(de):[]}),x(L,"$backtrace_locations",function(){var k;return this.backtrace_locations||(this.backtrace_locations=(k=this.$backtrace())===q||null==k?q:ee(k,"map",[],function(F){return null==F&&(F=q),K(K(K("Thread"),"Backtrace"),"Location").$new(F)})),this.backtrace_locations}),x(L,"$cause",function(){return this.cause||q}),x(L,"$exception",function(k){var de=this;if(null==k&&(k=q),k===q||de===k)return de;var N=de.$clone();return N.message=k,de.backtrace&&(N.backtrace=de.backtrace.$dup()),N.stack=de.stack,N.cause=de.cause,N},-1),x(L,"$message",function(){return this.$to_s()}),x(L,"$full_message",function(k){var N,F=this,g=q,l=q,c=q,f=q,u=q,p=q,_=q,y=q,m=q;return null==d.stderr&&(d.stderr=q),null==k&&(k=q),O(M("Hash","skip_raise")?"constant":q)?(c=(N=[(k=E(["highlight","order"],{highlight:d.stderr["$tty?"](),order:"top"}).$merge(O(g=k)?g:E([],{})))["$[]"]("highlight"),k["$[]"]("order")])[1],O([!0,!1]["$include?"](l=N[0]))||Y.$raise(K("ArgumentError"),"expected true or false as highlight: "+l),O(["top","bottom"]["$include?"](c))||Y.$raise(K("ArgumentError"),"expected :top or :bottom as order: "+c),O(l)?(f="\x1b[1;4m",u="\x1b[1m",p="\x1b[m"):f=u=p="",_=F.$backtrace().$dup(),(G(_)||O(_["$empty?"]()))&&(_=F.$caller()),y=_.$shift(),m=D(m=y+": ",""+u+F.$to_s()+" ("+f+F.$class()+p+u+")"+p+"\n"),m=D(m,ee(_,"map",[],function(se){return null==se&&(se=q),"\tfrom "+se+"\n"}).$join()),O(F.$cause())&&(m=D(m,F.$cause().$full_message(E(["highlight"],{highlight:l})))),W(c,"bottom")&&(m=m.$split("\n").$reverse().$join("\n"),m=D(u+"Traceback"+p+" (most recent call last):\n",m)),m):F.message+"\n"+F.stack},-1),x(L,"$inspect",function(){var k=this,de=q;return de=k.$to_s(),O(de["$empty?"]())?k.$class().$to_s():"#<"+k.$class().$to_s()+": "+k.$to_s()+">"}),x(L,"$set_backtrace",function(k){var F,g,de=this,N=!0;if(k===q)de.backtrace=q,de.stack="";else if(k.$$is_string)de.backtrace=[k],de.stack="  from "+k;else{if(k.$$is_array){for(F=0,g=k.length;F<g;F++)if(!k[F].$$is_string){N=!1;break}}else N=!1;!1===N&&Y.$raise(K("TypeError"),"backtrace must be Array of String"),de.backtrace=k,de.stack=ee(k,"map",[],function(c){return null==c&&(c=q),D("  from ",c)}).join("\n")}return k}),x(L,"$to_s",function(){var de,N,k=this;return O(de=O(N=k.message)?k.message.$to_s():N)?de:k.$class().$to_s()})}(0,Error,z),le("::",K("Exception"),"ScriptError"),le("::",K("ScriptError"),"SyntaxError"),le("::",K("ScriptError"),"LoadError"),le("::",K("ScriptError"),"NotImplementedError"),le("::",K("Exception"),"SystemExit"),le("::",K("Exception"),"NoMemoryError"),le("::",K("Exception"),"SignalException"),le("::",K("SignalException"),"Interrupt"),le("::",K("Exception"),"SecurityError"),le("::",K("Exception"),"SystemStackError"),le("::",K("Exception"),"StandardError"),le("::",K("StandardError"),"EncodingError"),le("::",K("StandardError"),"ZeroDivisionError"),le("::",K("StandardError"),"NameError"),le("::",K("NameError"),"NoMethodError"),le("::",K("StandardError"),"RuntimeError"),le("::",K("RuntimeError"),"FrozenError"),le("::",K("StandardError"),"LocalJumpError"),le("::",K("StandardError"),"TypeError"),le("::",K("StandardError"),"ArgumentError"),le("::",K("ArgumentError"),"UncaughtThrowError"),le("::",K("StandardError"),"IndexError"),le("::",K("IndexError"),"StopIteration"),le("::",K("StopIteration"),"ClosedQueueError"),le("::",K("IndexError"),"KeyError"),le("::",K("StandardError"),"RangeError"),le("::",K("RangeError"),"FloatDomainError"),le("::",K("StandardError"),"IOError"),le("::",K("IOError"),"EOFError"),le("::",K("StandardError"),"SystemCallError"),le("::",K("StandardError"),"RegexpError"),le("::",K("StandardError"),"ThreadError"),le("::",K("StandardError"),"FiberError"),B.$autoload("Errno","corelib/error/errno"),A=K("RuntimeError"),(J=le("::",A,"FrozenError")).$attr_reader("receiver"),x(J,"$initialize",function L(S,M){var v,R=this;return L.$$p=null,null==(v=(M=Z(M)).$$smap.receiver)&&(v=q),T(R,j(R,"initialize",L,!1,!0),"initialize",[S],null),R.receiver=v},-2),function(I,A){var J=le("::",A,"UncaughtThrowError");J.$$prototype.tag=q,J.$attr_reader("tag","value"),x(J,"$initialize",function S(M,v){var R=this;return S.$$p=null,null==v&&(v=q),R.tag=M,R.value=v,T(R,j(R,"initialize",S,!1,!0),"initialize",["uncaught throw "+R.tag.$inspect()],null)},-2)}(0,K("ArgumentError")),function(I,A){var J=le("::",null,"NameError");J.$attr_reader("name"),x(J,"$initialize",function L(S,M){var P=this;return L.$$p=null,null==M&&(M=q),T(P,j(P,"initialize",L,!1,!0),"initialize",[S],null),P.name=M},-2)}(),function(I,A){var J=le("::",null,"NoMethodError");J.$attr_reader("args"),x(J,"$initialize",function L(S,M,v){var R=this;return L.$$p=null,null==M&&(M=q),null==v&&(v=[]),T(R,j(R,"initialize",L,!1,!0),"initialize",[S,M],null),R.args=v},-2)}(),le("::",null,"StopIteration").$attr_reader("result"),function(I,A){var J=le("::",null,"KeyError"),L=J.$$prototype;L.receiver=L.key=q,x(J,"$initialize",function S(M,v){var P,R,k=this;return S.$$p=null,null==(P=(v=Z(v)).$$smap.receiver)&&(P=q),null==(R=v.$$smap.key)&&(R=q),T(k,j(k,"initialize",S,!1,!0),"initialize",[M],null),k.receiver=P,k.key=R},-2),x(J,"$receiver",function(){var v;return O(v=this.receiver)?v:Y.$raise(K("ArgumentError"),"no receiver is available")}),x(J,"$key",function(){var v;return O(v=this.key)?v:Y.$raise(K("ArgumentError"),"no key is available")})}(),function(I,A){var L=[oe("::","JS")].concat(A);return le(L[0],null,"Error"),q}(0,z)},Opal.modules["corelib/constants"]=function(C){var le=C.const_set,d=C.$$$;return le("::","RUBY_PLATFORM","opal"),le("::","RUBY_ENGINE","opal"),le("::","RUBY_VERSION","3.2.0"),le("::","RUBY_ENGINE_VERSION","1.7.1"),le("::","RUBY_RELEASE_DATE","2023-01-06"),le("::","RUBY_PATCHLEVEL",0),le("::","RUBY_REVISION","0"),le("::","RUBY_COPYRIGHT","opal - Copyright (C) 2013-2022 Adam Beynon and the Opal contributors"),le("::","RUBY_DESCRIPTION","opal "+d("RUBY_ENGINE_VERSION")+" ("+d("RUBY_RELEASE_DATE")+" revision "+d("RUBY_REVISION")+")")},Opal.modules["opal/base"]=function(C){var le=C.Object;return le.$require("corelib/runtime"),le.$require("corelib/helpers"),le.$require("corelib/module"),le.$require("corelib/class"),le.$require("corelib/basic_object"),le.$require("corelib/kernel"),le.$require("corelib/main"),le.$require("corelib/error"),le.$require("corelib/constants")},Opal.modules["corelib/nil"]=function(C){var z,j,me=C.Kernel,d=C.def,H=C.return_val,ee=C.ensure_kwargs,$=C.NilClass,x=C.slice,O=C.truthy,E=C.rb_gt,Y=C.alias,D=C.nil,W=C.$$$;return[j=(0,C.klass)("::",null,"NilClass")].concat([]),j.$$prototype.$$meta=j,z=C.get_singleton_class(j),d(z,"$allocate",function(){return me.$raise(W("TypeError"),"allocator undefined for "+this.$name())}),C.udef(z,"$new"),d(j,"$!",H(!0)),d(j,"$&",H(!1)),d(j,"$|",function(q){return!1!==q&&q!==D}),d(j,"$^",function(q){return!1!==q&&q!==D}),d(j,"$==",function(q){return q===D}),d(j,"$dup",H(D)),d(j,"$clone",function(q){return q=ee(q),D},-1),d(j,"$inspect",H("nil")),d(j,"$nil?",H(!0)),d(j,"$singleton_class",function(){return $}),d(j,"$to_a",function(){return[]}),d(j,"$to_h",function(){return C.hash()}),d(j,"$to_i",H(0)),d(j,"$to_s",H("")),d(j,"$to_c",function(){return W("Complex").$new(0,0)}),d(j,"$rationalize",function(q){var K;return K=x(arguments),O(E(K.$length(),1))&&me.$raise(W("ArgumentError")),me.$Rational(0,1)},-1),d(j,"$to_r",function(){return me.$Rational(0,1)}),d(j,"$instance_variables",function(){return[]}),Y(j,"to_f","to_i")},Opal.modules["corelib/boolean"]=function(C){"use strict";var le=C.klass,me=C.Kernel,d=C.def,H=C.return_self,ee=C.ensure_kwargs,$=C.slice,x=C.truthy,O=C.send2,E=C.find_super,Y=C.to_a,G=C.alias,W=C.nil,B=C.$$$;return function(Z,T,j){var I,oe=le("::",T,"Boolean");[oe].concat([]),C.prop(oe.$$prototype,"$$is_boolean",!0);for(var q=["$$class","$$meta"],K=0;K<q.length;K++)Object.defineProperty(oe.$$prototype,q[K],{configurable:!0,enumerable:!1,get:function(){return 1==this?C.TrueClass:0==this?C.FalseClass:C.Boolean}});Object.defineProperty(oe.$$prototype,"$$id",{configurable:!0,enumerable:!1,get:function(){return 1==this?2:0==this?0:W}}),I=C.get_singleton_class(oe),d(I,"$allocate",function(){return me.$raise(B("TypeError"),"allocator undefined for "+this.$name())}),C.udef(I,"$new"),d(oe,"$__id__",function(){return this.valueOf()?2:0}),d(oe,"$!",function(){return 1!=this}),d(oe,"$&",function(A){return 1==this&&!1!==A&&A!==W}),d(oe,"$|",function(A){return 1==this||!1!==A&&A!==W}),d(oe,"$^",function(A){return 1==this?!1===A||A===W:!1!==A&&A!==W}),d(oe,"$==",function(A){return 1==this===A.valueOf()}),d(oe,"$singleton_class",function(){return this.$$meta}),d(oe,"$to_s",function(){return 1==this?"true":"false"}),d(oe,"$dup",H),d(oe,"$clone",function(A){return A=ee(A),this},-1),d(oe,"$method_missing",function I(A,J){var M,L=I.$$p||W,v=this;I.$$p=null,M=$(arguments,1);var P=v.$$class.$$prototype[C.jsid(A)];return x(void 0!==P&&!P.$$stub)||O(v,E(v,"method_missing",I,!1,!0),"method_missing",[A].concat(Y(M)),L),C.send(v,P,M,L)},-2),d(oe,"$respond_to_missing?",function(A,J){null==J&&(J=!1);var S=this.$$class.$$prototype[C.jsid(A)];return void 0!==S&&!S.$$stub},-2),G(oe,"eql?","=="),G(oe,"equal?","=="),G(oe,"inspect","to_s"),G(oe,"object_id","__id__")}(0,Boolean),le("::",B("Boolean"),"TrueClass"),le("::",B("Boolean"),"FalseClass"),W},Opal.modules["corelib/comparable"]=function(C){var le=C.truthy,me=C.module,d=C.rb_gt,H=C.rb_lt,ee=C.eqeqeq,$=C.Kernel,x=C.def,O=C.nil,E=C.$$$;return function(Y){var G=me("::","Comparable"),D=O;function W(T){return C.is_a(T,C.Integer)?T:d(T,0)?1:H(T,0)?-1:0}function Z(T,j){var oe=T["$<=>"](j);return le(oe)||function B(T,j){var oe;oe=ee(O,D=j)||ee(!0,D)||ee(!1,D)||ee(E("Integer"),D)||ee(E("Float"),D)?j.$inspect():j.$$class,$.$raise(E("ArgumentError"),"comparison of "+T.$class()+" with "+oe+" failed")}(T,j),W(oe)}return x(G,"$==",function(j){var oe=this,z=O;return!!le(oe["$equal?"](j))||oe["$<=>"]!=C.Kernel["$<=>"]&&(oe.$$comparable?(oe.$$comparable=!1,!1):!!le(z=oe["$<=>"](j))&&0==W(z))}),x(G,"$>",function(j){return Z(this,j)>0}),x(G,"$>=",function(j){return Z(this,j)>=0}),x(G,"$<",function(j){return Z(this,j)<0}),x(G,"$<=",function(j){return Z(this,j)<=0}),x(G,"$between?",function(j,oe){return!(H(this,j)||d(this,oe))}),x(G,"$clamp",function(j,oe){var q,K,z=this;if(null==oe&&(oe=O),oe===O&&(C.is_a(j,C.Range)||$.$raise(E("TypeError"),"wrong argument type "+j.$class()+" (expected Range)"),K=j.excl,oe=j.end,j=j.begin,oe!==O&&K&&$.$raise(E("ArgumentError"),"cannot clamp with an exclusive range")),j!==O&&oe!==O&&Z(j,oe)>0&&$.$raise(E("ArgumentError"),"min argument must be smaller than max argument"),j!==O){if(0==(q=Z(z,j)))return z;if(q<0)return j}return oe!==O&&(q=Z(z,oe))>0?oe:z},-2)}()},Opal.modules["corelib/regexp"]=function(C){var v,P,de,F,g,R,te,k,le=C.coerce_to,me=C.prop,d=C.freeze,H=C.klass,ee=C.const_set,$=C.send2,x=C.find_super,O=C.def,E=C.truthy,Y=C.gvars,G=C.slice,D=C.Kernel,W=C.Opal,B=C.alias,Z=C.send,T=C.hash2,j=C.rb_plus,oe=C.ensure_kwargs,z=C.rb_ge,q=C.to_a,K=C.eqeqeq,I=C.rb_minus,A=C.return_ivar,J=[],L=C.nil,S=C.$$$;return H("::",S("StandardError"),"RegexpError"),v=RegExp,P=J,te=[R=H("::",v,"Regexp")].concat(P),k=C.$r(te),ee(R,"IGNORECASE",1),ee(R,"EXTENDED",2),ee(R,"MULTILINE",4),C.prop(R.$$prototype,"$$is_regexp",!0),F=[de=C.get_singleton_class(R)].concat(te),g=C.$r(F),O(de,"$allocate",function l(){var c=l.$$p||L,u=L;return l.$$p=null,(u=$(this,x(this,"allocate",l,!1,!0),"allocate",[],c)).uninitialized=!0,u}),O(de,"$escape",function(c){return C.escape_regexp(c)}),O(de,"$last_match",function(c){return null==Y["~"]&&(Y["~"]=L),null==c&&(c=L),E(c["$nil?"]())?Y["~"]:E(Y["~"])?Y["~"]["$[]"](c):L},-1),O(de,"$union",function(c){var u,_,y,m,ne,se,p=this;if(0==(u=G(arguments)).length)return/(?!)/;if(1==u.length&&u[0].$$is_regexp)return u[0];_=u[0].$$is_array,u.length>1&&_&&D.$raise(S("TypeError"),"no implicit conversion of Array into String"),_&&(u=u[0]),ne=void 0,y=[];for(var Ee=0;Ee<u.length;Ee++)(m=u[Ee]).$$is_string?y.push(p.$escape(m)):m.$$is_regexp?(se=m.$options(),null!=ne&&ne!=se&&D.$raise(S("TypeError"),"All expressions must use the same options"),ne=se,y.push("("+m.source+")")):y.push(p.$escape(m.$to_str()));return p.$new(y.$join("|"),ne)},-1),O(de,"$new",function(c,f){if(c.$$is_regexp)return new RegExp(c);if("\\"===(c=W["$coerce_to!"](c,S("String"),"to_str")).charAt(c.length-1)&&"\\"!==c.charAt(c.length-2)&&D.$raise(S("RegexpError"),"too short escape sequence: /"+c+"/"),c=c.replace("\\A","^").replace("\\z","$"),void 0===f||f["$!"]())return new RegExp(c);if(f.$$is_number){var u="";g("IGNORECASE")&f&&(u+="i"),g("MULTILINE")&f&&(u+="m"),f=u}else f="i";return new RegExp(c,f)},-2),B(de,"compile","new"),B(de,"quote","escape"),O(R,"$==",function(N){return N instanceof RegExp&&this.toString()===N.toString()}),O(R,"$===",function(N){return this.$match(W["$coerce_to?"](N,S("String"),"to_str"))!==L}),O(R,"$=~",function(N){var g;return null==Y["~"]&&(Y["~"]=L),E(g=this.$match(N))?Y["~"].$begin(0):g}),O(R,"$freeze",function(){var N=this;return E(N["$frozen?"]())?N:(N.hasOwnProperty("$$g")||me(N,"$$g",null),N.hasOwnProperty("$$gm")||me(N,"$$gm",null),d(N))}),O(R,"$inspect",function(){var g=this.toString(),l=/^\/(.*)\/([^\/]*)$/.exec(g);if(l){for(var f=l[2],u=l[1].split(""),p=u.length,_=!1,y="",m=0;m<p;m++){var ne=u[m];!_&&"/"==ne&&(y=y.concat("\\")),y=y.concat(ne),_="\\"==ne&&!_}return"/"+y+"/"+f}return g}),O(R,"$match",function de(N,F){var g=de.$$p||L,l=this;if(null==Y["~"]&&(Y["~"]=L),de.$$p=null,l.uninitialized&&D.$raise(S("TypeError"),"uninitialized Regexp"),void 0===F){if(N===L)return Y["~"]=L;var c=l.exec(le(N,S("String"),"to_str"));return c?(Y["~"]=S("MatchData").$new(l,c),g===L?Y["~"]:C.yield1(g,Y["~"])):Y["~"]=L}if(F=le(F,S("Integer"),"to_int"),N===L||(N=le(N,S("String"),"to_str"),F<0&&(F+=N.length)<0))return Y["~"]=L;for(var f,u=C.global_regexp(l);;){if(null===(f=u.exec(N)))return Y["~"]=L;if(f.index>=F)return Y["~"]=S("MatchData").$new(u,f),g===L?Y["~"]:C.yield1(g,Y["~"]);u.lastIndex=f.index+1}},-2),O(R,"$match?",function(N,F){var l,g=this;return g.uninitialized&&D.$raise(S("TypeError"),"uninitialized Regexp"),void 0===F?N!==L&&g.test(le(N,S("String"),"to_str")):(F=le(F,S("Integer"),"to_int"),!(N===L||(N=le(N,S("String"),"to_str"),F<0&&(F+=N.length)<0)||null===(l=C.global_regexp(g).exec(N))||l.index<F))},-2),O(R,"$names",function(){return Z(this.$source().$scan(/\(?<(\w+)>/,T(["no_matchdata"],{no_matchdata:!0})),"map",[],"first".$to_proc()).$uniq()}),O(R,"$named_captures",function(){return Z(Z(Z(this.$source().$scan(/\(?<(\w+)>/,T(["no_matchdata"],{no_matchdata:!0})),"map",[],"first".$to_proc()).$each_with_index(),"group_by",[],"first".$to_proc()),"transform_values",[],function(g){return null==g&&(g=L),Z(g,"map",[],function(c){return null==c&&(c=L),j(c.$last(),1)})})}),O(R,"$~",function(){return null==Y._&&(Y._=L),this["$=~"](Y._)}),O(R,"$source",function(){return this.source}),O(R,"$options",function(){var N=this;N.uninitialized&&D.$raise(S("TypeError"),"uninitialized Regexp");var F=0;return N.multiline&&(F|=k("MULTILINE")),N.ignoreCase&&(F|=k("IGNORECASE")),F}),O(R,"$casefold?",function(){return this.ignoreCase}),B(R,"eql?","=="),B(R,"to_s","source"),function(M,v,P){var R=H(M,null,"MatchData"),te=[R].concat(P),k=C.$r(te);return R.$$prototype.matches=L,R.$attr_reader("post_match","pre_match","regexp","string"),O(R,"$initialize",function(F,g,l){var c,f=this;null==(c=(l=oe(l)).$$smap.no_matchdata)&&(c=!1),E(c)||(Y["~"]=f),f.regexp=F,f.begin=g.index,f.string=g.input,f.pre_match=g.input.slice(0,g.index),f.post_match=g.input.slice(g.index+g[0].length),f.matches=[];for(var u=0,p=g.length;u<p;u++){var _=g[u];f.matches.push(null==_?L:_)}},-3),O(R,"$match",function(F){var l;return E(l=this["$[]"](F))?l:E(F["$is_a?"](k("Integer")))&&E(z(F,this.$length()))?D.$raise(S("IndexError"),"index "+F+" out of matches"):L}),O(R,"$match_length",function(F){var g;return(g=this.$match(F))===L||null==g?L:g.$length()}),O(R,"$[]",function(F){var l,c=this;return(l=G(arguments))[0].$$is_string?(c.$regexp().$names()["$include?"](l["$[]"](0))["$!"]()&&D.$raise(S("IndexError"),"undefined group name reference: "+l["$[]"](0)),c.$named_captures()["$[]"](l["$[]"](0))):Z(c.matches,"[]",q(l))},-1),O(R,"$offset",function(F){var g=this;return 0!==F&&D.$raise(S("ArgumentError"),"MatchData#offset only supports 0th element"),[g.begin,g.begin+g.matches[F].length]}),O(R,"$==",function(F){var g=this,l=L,c=L,f=L,u=L;return!!K(S("MatchData"),F)&&(E(l=E(c=E(f=E(u=g.string==F.string)?g.regexp.toString()==F.regexp.toString():u)?g.pre_match==F.pre_match:f)?g.post_match==F.post_match:c)?g.begin==F.begin:l)}),O(R,"$begin",function(F){return 0!==F&&D.$raise(S("ArgumentError"),"MatchData#begin only supports 0th element"),this.begin}),O(R,"$end",function(F){return 0!==F&&D.$raise(S("ArgumentError"),"MatchData#end only supports 0th element"),this.begin+this.matches[F].length}),O(R,"$captures",function(){return this.matches.slice(1)}),O(R,"$named_captures",function(){var g=L;return g=this.$captures(),Z(this.$regexp().$named_captures(),"transform_values",[],function(c){return null==c&&(c=L),g["$[]"](I(c.$last(),1))})}),O(R,"$names",function(){return this.$regexp().$names()}),O(R,"$inspect",function(){var F=this,g="#<MatchData "+F.matches[0].$inspect();if(F.$regexp().$names()["$empty?"]())for(var l=1,c=F.matches.length;l<c;l++)g+=" "+l+":"+F.matches[l].$inspect();else Z(F.$named_captures(),"each",[],function(u,p){return null==u&&(u=L),null==p&&(p=L),g+=" "+u+":"+p.$inspect()});return g+">"}),O(R,"$length",function(){return this.matches.length}),O(R,"$to_a",A("matches")),O(R,"$to_s",function(){return this.matches[0]}),O(R,"$values_at",function(F){var l,c=this;l=G(arguments);var f,u,p,_=[];for(f=0;f<l.length;f++)l[f].$$is_range&&((u=l[f].$to_a()).unshift(f,1),Array.prototype.splice.apply(l,u)),(p=W["$coerce_to!"](l[f],S("Integer"),"to_int"))<0&&(p+=c.matches.length)<0?_.push(L):_.push(c.matches[p]);return _},-1),B(R,"eql?","=="),B(R,"size","length")}(J[0],0,J)},Opal.modules["corelib/string"]=function(C){var le=C.coerce_to,me=C.respond_to,d=C.global_multiline_regexp,H=C.prop,ee=C.klass,$=C.def,x=C.Opal,O=C.defs,E=C.slice,Y=C.send,G=C.to_a,D=C.extract_kwargs,W=C.ensure_kwargs,B=C.eqeqeq,Z=C.Kernel,T=C.truthy,j=C.gvars,oe=C.rb_divide,z=C.rb_plus,q=C.eqeq,K=C.hash2,I=C.alias,A=C.const_set,J=C.top,L=[],S=C.$r(L),M=C.nil,v=C.$$$;return J.$require("corelib/comparable"),J.$require("corelib/regexp"),function(P,R,te){var k=ee("::",String,"String"),de=[k].concat(te),N=C.$r(de);function F(g){function l(Ee){var ce,$e,be,he,Se,ve,ke="",Me=Ee.length;for(ce=0;ce<Me;ce++)if("-"===($e=Ee.charAt(ce))&&ce>0&&ce<Me-1&&!be){for((he=Ee.charCodeAt(ce-1))>(Se=Ee.charCodeAt(ce+1))&&Z.$raise(v("ArgumentError"),'invalid range "'+he+"-"+Se+'" in string transliteration'),ve=he+1;ve<Se+1;ve++)ke+=String.fromCharCode(ve);be=!0,ce++}else be="\\"===$e,ke+=$e;return ke}function c(Ee,ke){if(0===Ee.length)return ke;var Me,be,ce="",$e=Ee.length;for(Me=0;Me<$e;Me++)be=Ee.charAt(Me),-1!==ke.indexOf(be)&&(ce+=be);return ce}var f,u,p,_,y,m,ne="",se="";for(f=0,u=g.length;f<u;f++)_="^"===(p=le(g[f],v("String"),"to_str")).charAt(0)&&p.length>1,p=l(_?p.slice(1):p),_?se=c(se,p):ne=c(ne,p);if(ne.length>0&&se.length>0){for(m="",f=0,u=ne.length;f<u;f++)y=ne.charAt(f),-1===se.indexOf(y)&&(m+=y);ne=m,se=""}return ne.length>0?"["+v("Regexp").$escape(ne)+"]":se.length>0?"[^"+v("Regexp").$escape(se)+"]":null}k.$include(v("Comparable")),C.prop(k.$$prototype,"$$is_string",!0),$(k,"$__id__",function(){return this.toString()}),O(k,"$try_convert",function(l){return x["$coerce_to?"](l,v("String"),"to_str")}),O(k,"$new",function(l){var f,u=this,p=(f=E(arguments))[0]||"",_=f[f.length-1];return p=le(p,v("String"),"to_str"),_&&_.$$is_hash&&_.$$smap.encoding&&(p=p.$force_encoding(_.$$smap.encoding)),(p=new u.$$constructor(p)).$initialize.$$pristine||Y(p,"initialize",G(f)),p},-1),$(k,"$initialize",function(l,c){var f,u;return f=E(arguments),u=D(f),u=W(u),f.length>0&&f.shift(),M},-1),$(k,"$%",function(l){var c=this;return B(v("Array"),l)?Y(c,"format",[c].concat(G(l))):c.$format(c,l)}),$(k,"$*",function(l){if((l=le(l,v("Integer"),"to_int"))<0&&Z.$raise(v("ArgumentError"),"negative argument"),0===l)return"";var f="",u=this.toString();for(u.length*l>=1<<28&&Z.$raise(v("RangeError"),"multiply count must not overflow maximum string size");1==(1&l)&&(f+=u),0!=(l>>>=1);)u+=u;return f}),$(k,"$+",function(l){var c=this;if(""==(l=le(l,v("String"),"to_str"))&&c.$$class===C.String)return c;if(""==c&&l.$$class===C.String)return l;var f=c+l;return c.encoding===f.encoding&&l.encoding===f.encoding||"UTF-8"===c.encoding.name||"UTF-8"===l.encoding.name?f:C.enc(f,c.encoding)}),$(k,"$<=>",function(l){var c=this;if(T(l["$respond_to?"]("to_str")))return c>(l=l.$to_str().$to_s())?1:c<l?-1:0;var f=l["$<=>"](c);return f===M?M:f>0?-1:f<0?1:0}),$(k,"$==",function(l){return l.$$is_string?this.toString()===l.toString():!!me(l,"$to_str")&&l["$=="](this)}),$(k,"$=~",function(l){return l.$$is_string&&Z.$raise(v("TypeError"),"type mismatch: String given"),l["$=~"](this)}),$(k,"$[]",function(l,c){var p,_,f=this,u=f.length;if(l.$$is_range)return p=l.excl,_=l,c=l.end===M?-1:le(l.end,v("Integer"),"to_int"),l=l.begin===M?0:le(l.begin,v("Integer"),"to_int"),Math.abs(l)>u?M:(l<0&&(l+=u),c<0&&(c+=u),(!p||_.end===M)&&(c+=1),(c-=l)<0&&(c=0),f.substr(l,c));if(l.$$is_string)return null!=c&&Z.$raise(v("TypeError")),-1!==f.indexOf(l)?l:M;if(l.$$is_regexp){var y=f.match(l);return null===y?(j["~"]=M,M):(j["~"]=v("MatchData").$new(l,y),null==c?y[0]:(c=le(c,v("Integer"),"to_int"))<0&&-c<y.length?y[c+=y.length]:c>=0&&c<y.length?y[c]:M)}return(l=le(l,v("Integer"),"to_int"))<0&&(l+=u),null==c?l>=u||l<0?M:f.substr(l,1):(c=le(c,v("Integer"),"to_int"))<0||l>u||l<0?M:f.substr(l,c)},-2),$(k,"$b",function(){return new String(this).$force_encoding("binary")}),$(k,"$capitalize",function(){return this.charAt(0).toUpperCase()+this.substr(1).toLowerCase()}),$(k,"$casecmp",function(l){var c=this;if(!T(l["$respond_to?"]("to_str")))return M;l=le(l,v("String"),"to_str").$to_s();var f=/^[\x00-\x7F]*$/;return f.test(c)&&f.test(l)&&(c=c.toLowerCase(),l=l.toLowerCase()),c["$<=>"](l)}),$(k,"$casecmp?",function(l){var f=this.$casecmp(l);return f===M?M:0===f}),$(k,"$center",function(l,c){var f=this;if(null==c&&(c=" "),l=le(l,v("Integer"),"to_int"),c=le(c,v("String"),"to_str").$to_s(),T(c["$empty?"]())&&Z.$raise(v("ArgumentError"),"zero width padding"),T(l<=f.length))return f;var u=f.$ljust(oe(z(l,f.length),2).$ceil(),c);return f.$rjust(oe(z(l,f.length),2).$floor(),c)+u.slice(f.length)},-2),$(k,"$chomp",function(l){var f,c=this;return null==j["/"]&&(j["/"]=M),null==l&&(l=j["/"]),T(l===M||0===c.length)?c:("\n"===(l=x["$coerce_to!"](l,v("String"),"to_str").$to_s())?f=c.replace(/\r?\n?$/,""):""===l?f=c.replace(/(\r?\n)+$/,""):c.length>=l.length&&c.substr(c.length-l.length,l.length)===l&&(f=c.substr(0,c.length-l.length)),null!=f?f:c)},-1),$(k,"$chop",function(){var l=this,c=l.length;return c<=1?"":"\n"===l.charAt(c-1)&&"\r"===l.charAt(c-2)?l.substr(0,c-2):l.substr(0,c-1)}),$(k,"$chr",function(){return this.charAt(0)}),$(k,"$clone",function(l){var c,f=this,u=M;return null==(c=(l=W(l)).$$smap.freeze)&&(c=M),T(c["$nil?"]())||q(c,!0)||q(c,!1)||f.$raise(N("ArgumentError"),"unexpected value for freeze: "+c.$class()),(u=new String(f)).$copy_singleton_methods(f),u.$initialize_clone(f,K(["freeze"],{freeze:c})),q(c,!0)?u.$$frozen||(u.$$frozen=!0):T(c["$nil?"]())&&f.$$frozen&&(u.$$frozen=!0),u},-1),$(k,"$dup",function(){var c=M;return(c=new String(this)).$initialize_dup(this),c}),$(k,"$count",function(l){var f,u=this;0===(f=E(arguments)).length&&Z.$raise(v("ArgumentError"),"ArgumentError: wrong number of arguments (0 for 1+)");var p=F(f);return null===p?0:u.length-u.replace(new RegExp(p,"g"),"").length},-1),$(k,"$delete",function(l){var f,u=this;0===(f=E(arguments)).length&&Z.$raise(v("ArgumentError"),"ArgumentError: wrong number of arguments (0 for 1+)");var p=F(f);return null===p?u:u.replace(new RegExp(p,"g"),"")},-1),$(k,"$delete_prefix",function(l){var c=this;return l.$$is_string||(l=le(l,v("String"),"to_str")),c.slice(0,l.length)===l?c.slice(l.length):c}),$(k,"$delete_suffix",function(l){var c=this;return l.$$is_string||(l=le(l,v("String"),"to_str")),c.slice(c.length-l.length)===l?c.slice(0,c.length-l.length):c}),$(k,"$downcase",function(){return this.toLowerCase()}),$(k,"$each_line",function g(l,c){var u,p,_,y,ne,se,Ee,ke,ce,Me,$e,be,f=g.$$p||M,m=this;if(null==j["/"]&&(j["/"]=M),g.$$p=null,u=E(arguments),p=D(u),p=W(p),u.length>0&&(_=u.shift()),null==_&&(_=j["/"]),null==(y=p.$$smap.chomp)&&(y=!1),f===M)return m.$enum_for("each_line",_,K(["chomp"],{chomp:y}));if(_===M)return C.yield1(f,m),m;if(0===(_=le(_,v("String"),"to_str")).length){for(se=0,Ee=(ne=m.split(/((?:\r?\n){2})(?:(?:\r?\n)*)/)).length;se<Ee;se+=2)(ne[se]||ne[se+1])&&(be=(ne[se]||"")+(ne[se+1]||""),y&&(be=be.$chomp("\n")),C.yield1(f,be));return m}for(ce=m.$chomp(_),Me=m.length!=ce.length,se=0,ke=($e=ce.split(_)).length;se<ke;se++)be=$e[se],(se<ke-1||Me)&&(be+=_),y&&(be=be.$chomp(_)),C.yield1(f,be);return m},-1),$(k,"$empty?",function(){return 0===this.length}),$(k,"$end_with?",function(l){for(var f,u=this,p=0,_=(f=E(arguments)).length;p<_;p++){var y=le(f[p],v("String"),"to_str").$to_s();if(u.length>=y.length&&u.substr(u.length-y.length,y.length)==y)return!0}return!1},-1),$(k,"$gsub",function g(l,c){var f=g.$$p||M,u=this;if(g.$$p=null,void 0===c&&f===M)return u.$enum_for("gsub",l);var m,ne,se,p="",_=M,y=0;for(l.$$is_regexp?l=d(l):(l=le(l,v("String"),"to_str"),l=new RegExp(l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"));;){if(null===(m=l.exec(u))){j["~"]=M,p+=u.slice(y);break}_=v("MatchData").$new(l,m),void 0===c?(se=l.lastIndex,ne=f(m[0]),l.lastIndex=se):c.$$is_hash?ne=c["$[]"](m[0]).$to_s():(c.$$is_string||(c=le(c,v("String"),"to_str")),ne=c.replace(/([\\]+)([0-9+&`'])/g,function(Ee,ke,ce){if(ke.length%2==0)return Ee;switch(ce){case"+":for(var Me=m.length-1;Me>0;Me--)if(void 0!==m[Me])return ke.slice(1)+m[Me];return"";case"&":return ke.slice(1)+m[0];case"`":return ke.slice(1)+u.slice(0,m.index);case"'":return ke.slice(1)+u.slice(m.index+m[0].length);default:return ke.slice(1)+(m[ce]||"")}}).replace(/\\\\/g,"\\")),l.lastIndex===m.index?(p+=u.slice(y,m.index)+ne+(u[m.index]||""),l.lastIndex+=1):p+=u.slice(y,m.index)+ne,y=l.lastIndex}return j["~"]=_,p},-2),$(k,"$hash",function(){return this.toString()}),$(k,"$hex",function(){return this.$to_i(16)}),$(k,"$include?",function(l){return l.$$is_string||(l=le(l,v("String"),"to_str")),-1!==this.indexOf(l)}),$(k,"$index",function(l,c){var u,p,_,f=this;if(void 0===c)c=0;else if((c=le(c,v("Integer"),"to_int"))<0&&(c+=f.length)<0)return M;if(l.$$is_regexp)for(_=d(l);;){if(null===(p=_.exec(f))){j["~"]=M,u=-1;break}if(p.index>=c){j["~"]=v("MatchData").$new(_,p),u=p.index;break}_.lastIndex=p.index+1}else u=0===(l=le(l,v("String"),"to_str")).length&&c>f.length?-1:f.indexOf(l,c);return-1===u?M:u},-2),$(k,"$inspect",function(){var l=this,f={"\x07":"\\a","\x1b":"\\e","\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\v":"\\v",'"':'\\"',"\\":"\\\\"};return'"'+l.replace(/[\\\"\x00-\x1f\u007F-\u009F\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,function(p){return f[p]?f[p]:(p=p.charCodeAt(0))<=255&&(l.encoding["$binary?"]()||l.internal_encoding["$binary?"]())?"\\x"+("00"+p.toString(16).toUpperCase()).slice(-2):"\\u"+("0000"+p.toString(16).toUpperCase()).slice(-4)}).replace(/\#[\$\@\{]/g,"\\$&")+'"'}),$(k,"$intern",function(){return this.toString()}),$(k,"$length",function(){return this.length}),I(k,"size","length"),$(k,"$lines",function g(l,c){var u,p,_,y,f=g.$$p||M,m=this,ne=M;return null==j["/"]&&(j["/"]=M),g.$$p=null,u=E(arguments),p=D(u),p=W(p),u.length>0&&(_=u.shift()),null==_&&(_=j["/"]),null==(y=p.$$smap.chomp)&&(y=!1),ne=Y(m,"each_line",[_,K(["chomp"],{chomp:y})],f.$to_proc()),T(f)?m:ne.$to_a()},-1),$(k,"$ljust",function(l,c){var f=this;if(null==c&&(c=" "),l=le(l,v("Integer"),"to_int"),c=le(c,v("String"),"to_str").$to_s(),T(c["$empty?"]())&&Z.$raise(v("ArgumentError"),"zero width padding"),T(l<=f.length))return f;var u=-1,p="";for(l-=f.length;++u<l;)p+=c;return f+p.slice(0,l)},-2),$(k,"$lstrip",function(){return this.replace(/^[\u0000\s]*/,"")}),$(k,"$ascii_only?",function(){return!!this.encoding.ascii&&/^[\x00-\x7F]*$/.test(this)}),$(k,"$match",function g(l,c){var f=g.$$p||M;return g.$$p=null,(B(N("String"),l)||T(l["$respond_to?"]("to_str")))&&(l=v("Regexp").$new(l.$to_str())),B(v("Regexp"),l)||Z.$raise(v("TypeError"),"wrong argument type "+l.$class()+" (expected Regexp)"),Y(l,"match",[this,c],f.$to_proc())},-2),$(k,"$match?",function(l,c){return(B(N("String"),l)||T(l["$respond_to?"]("to_str")))&&(l=v("Regexp").$new(l.$to_str())),B(v("Regexp"),l)||Z.$raise(v("TypeError"),"wrong argument type "+l.$class()+" (expected Regexp)"),l["$match?"](this,c)},-2),$(k,"$next",function(){var l=this,c=l.length;if(0===c)return"";for(var _,f=l,u=l.search(/[a-zA-Z0-9]/),p=!1;c--;){if((_=l.charCodeAt(c))>=48&&_<=57||_>=65&&_<=90||_>=97&&_<=122)switch(_){case 57:p=!0,_=48;break;case 90:p=!0,_=65;break;case 122:p=!0,_=97;break;default:p=!1,_+=1}else-1===u?255===_?(p=!0,_=0):(p=!1,_+=1):p=!0;if(f=f.slice(0,c)+String.fromCharCode(_)+f.slice(c+1),p&&(0===c||c===u)){switch(_){case 65:case 97:break;default:_+=1}f=0===c?String.fromCharCode(_)+f:f.slice(0,c)+String.fromCharCode(_)+f.slice(c),p=!1}if(!p)break}return f}),$(k,"$oct",function(){var c,f=this,u=8;return/^\s*_/.test(f)?0:(f=f.replace(/^(\s*[+-]?)(0[bodx]?)(.+)$/i,function(p,_,y,m){switch(m.charAt(0)){case"+":case"-":return p;case"0":if("x"===m.charAt(1)&&"0x"===y)return p}switch(y){case"0b":u=2;break;case"0":case"0o":u=8;break;case"0d":u=10;break;case"0x":u=16}return _+m}),c=parseInt(f.replace(/_(?!_)/g,""),u),isNaN(c)?0:c)}),$(k,"$ord",function(){var l=this;return"function"==typeof l.codePointAt?l.codePointAt(0):l.charCodeAt(0)}),$(k,"$partition",function(l){var f,u,c=this;return l.$$is_regexp?null===(u=l.exec(c))?f=-1:(v("MatchData").$new(l,u),l=u[0],f=u.index):(l=le(l,v("String"),"to_str"),f=c.indexOf(l)),-1===f?[c,"",""]:[c.slice(0,f),c.slice(f,f+l.length),c.slice(f+l.length)]}),$(k,"$reverse",function(){return this.split("").reverse().join("")}),$(k,"$rindex",function(l,c){var u,p,_,y,f=this;if(void 0===c)c=f.length;else if((c=le(c,v("Integer"),"to_int"))<0&&(c+=f.length)<0)return M;if(l.$$is_regexp){for(p=null,_=d(l);!(null===(y=_.exec(f))||y.index>c);)_.lastIndex=(p=y).index+1;null===p?(j["~"]=M,u=-1):(v("MatchData").$new(_,p),u=p.index)}else l=le(l,v("String"),"to_str"),u=f.lastIndexOf(l,c);return-1===u?M:u},-2),$(k,"$rjust",function(l,c){var f=this;if(null==c&&(c=" "),l=le(l,v("Integer"),"to_int"),c=le(c,v("String"),"to_str").$to_s(),T(c["$empty?"]())&&Z.$raise(v("ArgumentError"),"zero width padding"),T(l<=f.length))return f;var u=Math.floor(l-f.length),p=Math.floor(u/c.length),_=Array(p+1).join(c);return _+c.slice(0,u-_.length)+f},-2),$(k,"$rpartition",function(l){var f,u,p,_,c=this;if(l.$$is_regexp){for(u=null,p=d(l);null!==(_=p.exec(c));)p.lastIndex=(u=_).index+1;null===u?f=-1:(v("MatchData").$new(p,u),l=u[0],f=u.index)}else l=le(l,v("String"),"to_str"),f=c.lastIndexOf(l);return-1===f?["","",c]:[c.slice(0,f),c.slice(f,f+l.length),c.slice(f+l.length)]}),$(k,"$rstrip",function(){return this.replace(/[\s\u0000]*$/,"")}),$(k,"$scan",function g(l,c){var u,f=g.$$p||M;g.$$p=null,null==(u=(c=W(c)).$$smap.no_matchdata)&&(u=!1);var m,_=[],y=M;for(l.$$is_regexp?l=d(l):(l=le(l,v("String"),"to_str"),l=new RegExp(l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"));null!=(m=l.exec(this));)y=v("MatchData").$new(l,m,K(["no_matchdata"],{no_matchdata:u})),f===M?_.push(1==m.length?m[0]:y.$captures()):C.yield1(f,1==m.length?m[0]:y.$captures()),l.lastIndex===m.index&&(l.lastIndex+=1);return u||(j["~"]=y),f!==M?this:_},-2),$(k,"$singleton_class",function(){return C.get_singleton_class(this)}),$(k,"$split",function(l,c){var f=this,u=M;if(null==j[";"]&&(j[";"]=M),0===f.length)return[];if(void 0===c)c=0;else if(1===(c=x["$coerce_to!"](c,v("Integer"),"to_int")))return[f];(void 0===l||l===M)&&(l=T(u=j[";"])?u:" ");var m,ne,se,p=[],_=f.toString(),y=0;if(l.$$is_regexp?l=d(l):" "===(l=le(l,v("String"),"to_str").$to_s())?(l=/\s+/gm,_=_.replace(/^\s+/,"")):l=new RegExp(l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"),1===(p=_.split(l)).length&&p[0]===_)return[p[0]];for(;-1!==(ne=p.indexOf(void 0));)p.splice(ne,1);if(0===c){for(;""===p[p.length-1];)p.length-=1;return p}if(m=l.exec(_),c<0){if(null!==m&&""===m[0]&&-1===l.source.indexOf("(?="))for(ne=0,se=m.length;ne<se;ne++)p.push("");return p}if(null!==m&&""===m[0])return p.splice(c-1,p.length-1,p.slice(c-1).join("")),p;if(c>=p.length)return p;for(ne=0;null!==m&&(ne++,y=l.lastIndex,ne+1!==c);)m=l.exec(_);return p.splice(c-1,p.length-1,_.slice(y)),p},-1),$(k,"$squeeze",function(l){var f,u=this;if(0===(f=E(arguments)).length)return u.replace(/(.)\1+/g,"$1");var p=F(f);return null===p?u:u.replace(new RegExp("("+p+")\\1+","g"),"$1")},-1),$(k,"$start_with?",function(l){for(var f,u=this,p=0,_=(f=E(arguments)).length;p<_;p++)if(f[p].$$is_regexp){var y=f[p],m=y.exec(u);if(null!=m&&0===m.index)return j["~"]=v("MatchData").$new(y,m),!0;j["~"]=M}else{var ne=le(f[p],v("String"),"to_str").$to_s();if(0===u.indexOf(ne))return!0}return!1},-1),$(k,"$strip",function(){return this.replace(/^[\s\u0000]*|[\s\u0000]*$/g,"")}),$(k,"$sub",function g(l,c){var f=g.$$p||M,u=this;g.$$p=null,l.$$is_regexp||(l=le(l,v("String"),"to_str"),l=new RegExp(l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")));var p,_=l.exec(u);return null===_?(j["~"]=M,p=u.toString()):(v("MatchData").$new(l,_),void 0===c?(f===M&&Z.$raise(v("ArgumentError"),"wrong number of arguments (1 for 2)"),p=u.slice(0,_.index)+f(_[0])+u.slice(_.index+_[0].length)):c.$$is_hash?p=u.slice(0,_.index)+c["$[]"](_[0]).$to_s()+u.slice(_.index+_[0].length):(c=(c=le(c,v("String"),"to_str")).replace(/([\\]+)([0-9+&`'])/g,function(y,m,ne){if(m.length%2==0)return y;switch(ne){case"+":for(var se=_.length-1;se>0;se--)if(void 0!==_[se])return m.slice(1)+_[se];return"";case"&":return m.slice(1)+_[0];case"`":return m.slice(1)+u.slice(0,_.index);case"'":return m.slice(1)+u.slice(_.index+_[0].length);default:return m.slice(1)+(_[ne]||"")}}).replace(/\\\\/g,"\\"),p=u.slice(0,_.index)+c+u.slice(_.index+_[0].length))),p},-2),$(k,"$sum",function(l){null==l&&(l=16),l=le(l,v("Integer"),"to_int");for(var f=0,u=this.length,p=0;p<u;p++)f+=this.charCodeAt(p);return l<=0?f:f&Math.pow(2,l)-1},-1),$(k,"$swapcase",function(){return this.replace(/([a-z]+)|([A-Z]+)/g,function(f,u,p){return u?f.toUpperCase():f.toLowerCase()})}),$(k,"$to_f",function(){if("_"===this.charAt(0))return 0;var c=parseFloat(this.replace(/_/g,""));return isNaN(c)||c==1/0||c==-1/0?0:c}),$(k,"$to_i",function(l){null==l&&(l=10);var f,u=this.toLowerCase(),p=le(l,v("Integer"),"to_int");return(1===p||p<0||p>36)&&Z.$raise(v("ArgumentError"),"invalid radix "+p),/^\s*_/.test(u)?0:(u=u.replace(/^(\s*[+-]?)(0[bodx]?)(.+)$/,function(_,y,m,ne){switch(ne.charAt(0)){case"+":case"-":return _;case"0":if("x"===ne.charAt(1)&&"0x"===m&&(0===p||16===p))return _}switch(m){case"0b":if(0===p||2===p)return p=2,y+ne;break;case"0":case"0o":if(0===p||8===p)return p=8,y+ne;break;case"0d":if(0===p||10===p)return p=10,y+ne;break;case"0x":if(0===p||16===p)return p=16,y+ne}return _}),f=parseInt(u.replace(/_(?!_)/g,""),p),isNaN(f)?0:f)},-1),$(k,"$to_proc",function g(){var f,u,p=M;return g.$$p=null,f=this.valueOf(),u=C.jsid(f),p=Y(Z,"proc",[],function _(y){var se,m=_.$$p||M;_.$$p=null,0===(se=E(arguments)).length&&Z.$raise(v("ArgumentError"),"no receiver given");var Ee=se[0];null==Ee&&(Ee=M);var ke=Ee[u];return ke?se=se.slice(1):(ke=Ee.$method_missing,se[0]=f),"function"==typeof m&&(ke.$$p=m),0===se.length?ke.call(Ee):ke.apply(Ee,se)},-1),p.$$source_location=M,p}),$(k,"$to_s",function(){return this.toString()}),$(k,"$tr",function(l,c){var f=this;if(l=le(l,v("String"),"to_str").$to_s(),c=le(c,v("String"),"to_str").$to_s(),0==l.length||l===c)return f;var u,p,_,y,m,ne,se,Ee={},ke=l.split(""),ce=ke.length,Me=c.split(""),$e=Me.length,be=!1,he=null;"^"===ke[0]&&ke.length>1&&(be=!0,ke.shift(),he=Me[$e-1],ce-=1);var Se=[],ve=null;for(p=!1,u=0;u<ce;u++)if(y=ke[u],null==ve)ve=y,Se.push(y);else if("-"===y)"-"===ve?(Se.push("-"),Se.push("-")):u==ce-1?Se.push("-"):p=!0;else if(p){for((m=ve.charCodeAt(0))>(ne=y.charCodeAt(0))&&Z.$raise(v("ArgumentError"),'invalid range "'+String.fromCharCode(m)+"-"+String.fromCharCode(ne)+'" in string transliteration'),_=m+1;_<ne;_++)Se.push(String.fromCharCode(_));Se.push(y),p=null,ve=null}else Se.push(y);if(ce=(ke=Se).length,be)for(u=0;u<ce;u++)Ee[ke[u]]=!0;else{if($e>0){var ae=[],ue=null;for(p=!1,u=0;u<$e;u++)if(y=Me[u],null==ue)ue=y,ae.push(y);else if("-"===y)"-"===ue?(ae.push("-"),ae.push("-")):u==$e-1?ae.push("-"):p=!0;else if(p){for((m=ue.charCodeAt(0))>(ne=y.charCodeAt(0))&&Z.$raise(v("ArgumentError"),'invalid range "'+String.fromCharCode(m)+"-"+String.fromCharCode(ne)+'" in string transliteration'),_=m+1;_<ne;_++)ae.push(String.fromCharCode(_));ae.push(y),p=null,ue=null}else ae.push(y);$e=(Me=ae).length}var Ce=ce-$e;if(Ce>0){var b=$e>0?Me[$e-1]:"";for(u=0;u<Ce;u++)Me.push(b)}for(u=0;u<ce;u++)Ee[ke[u]]=Me[u]}var V="";for(u=0,se=f.length;u<se;u++){var ge=Ee[y=f.charAt(u)];V+=be?null==ge?he:y:null!=ge?ge:y}return V}),$(k,"$tr_s",function(l,c){var f=this;if(l=le(l,v("String"),"to_str").$to_s(),c=le(c,v("String"),"to_str").$to_s(),0==l.length)return f;var u,p,_,y,m,ne,se,Ee={},ke=l.split(""),ce=ke.length,Me=c.split(""),$e=Me.length,be=!1,he=null;"^"===ke[0]&&ke.length>1&&(be=!0,ke.shift(),he=Me[$e-1],ce-=1);var Se=[],ve=null;for(p=!1,u=0;u<ce;u++)if(y=ke[u],null==ve)ve=y,Se.push(y);else if("-"===y)"-"===ve?(Se.push("-"),Se.push("-")):u==ce-1?Se.push("-"):p=!0;else if(p){for((m=ve.charCodeAt(0))>(ne=y.charCodeAt(0))&&Z.$raise(v("ArgumentError"),'invalid range "'+String.fromCharCode(m)+"-"+String.fromCharCode(ne)+'" in string transliteration'),_=m+1;_<ne;_++)Se.push(String.fromCharCode(_));Se.push(y),p=null,ve=null}else Se.push(y);if(ce=(ke=Se).length,be)for(u=0;u<ce;u++)Ee[ke[u]]=!0;else{if($e>0){var ae=[];for(p=!1,u=0;u<$e;u++)if(y=Me[u],null==ve)ve=y,ae.push(y);else if("-"===y)u==$e-1?ae.push("-"):p=!0;else if(p){for((m=ve.charCodeAt(0))>(ne=y.charCodeAt(0))&&Z.$raise(v("ArgumentError"),'invalid range "'+String.fromCharCode(m)+"-"+String.fromCharCode(ne)+'" in string transliteration'),_=m+1;_<ne;_++)ae.push(String.fromCharCode(_));ae.push(y),p=null,ve=null}else ae.push(y);$e=(Me=ae).length}var Ce=ce-$e;if(Ce>0){var b=$e>0?Me[$e-1]:"";for(u=0;u<Ce;u++)Me.push(b)}for(u=0;u<ce;u++)Ee[ke[u]]=Me[u]}var V="",ge=null;for(u=0,se=f.length;u<se;u++){var xe=Ee[y=f.charAt(u)];be?null==xe?null==ge&&(V+=he,ge=!0):(V+=y,ge=null):null!=xe?(null==ge||ge!==xe)&&(V+=xe,ge=xe):(V+=y,ge=null)}return V}),$(k,"$upcase",function(){return this.toUpperCase()}),$(k,"$upto",function g(l,c){var f=g.$$p||M,u=this;if(g.$$p=null,null==c&&(c=!1),f===M)return u.$enum_for("upto",l,c);var p,_,y=u.toString();if(l=le(l,v("String"),"to_str"),1===y.length&&1===l.length)for(p=y.charCodeAt(0),_=l.charCodeAt(0);p<=_&&(!c||p!==_);)f(String.fromCharCode(p)),p+=1;else if(parseInt(y,10).toString()===y&&parseInt(l,10).toString()===l)for(p=parseInt(y,10),_=parseInt(l,10);p<=_&&(!c||p!==_);)f(p.toString()),p+=1;else for(;y.length<=l.length&&y<=l&&(!c||y!==l);)f(y),y=y.$succ();return u},-2),$(k,"$instance_variables",function(){return[]}),O(k,"$_load",function(l){var c,u=this;return c=E(arguments),Y(u,"new",G(c))},-1),$(k,"$unicode_normalize",function(l){return null==l&&(l="nfc"),T(["nfc","nfd","nfkc","nfkd"]["$include?"](l))||Z.$raise(v("ArgumentError"),"Invalid normalization form "+l),this.normalize(l.$upcase())},-1),$(k,"$unicode_normalized?",function(l){return null==l&&(l="nfc"),this.$unicode_normalize(l)["$=="](this)},-1),$(k,"$unpack",function(l){return Z.$raise("To use String#unpack, you must first require 'corelib/string/unpack'.")}),$(k,"$unpack1",function(l){return Z.$raise("To use String#unpack1, you must first require 'corelib/string/unpack'.")}),$(k,"$freeze",function(){var l=this;return"string"==typeof l||H(l,"$$frozen",!0),l}),$(k,"$-@",function(){var l=this;return"string"==typeof l||l.$$frozen?l:"UTF-8"==l.encoding.name&&"UTF-8"==l.internal_encoding.name?l.toString():l.$dup().$freeze()}),$(k,"$frozen?",function(){return"string"==typeof this||!0===this.$$frozen}),I(k,"+@","dup"),I(k,"===","=="),I(k,"byteslice","[]"),I(k,"eql?","=="),I(k,"equal?","==="),I(k,"object_id","__id__"),I(k,"slice","[]"),I(k,"succ","next"),I(k,"to_str","to_s"),I(k,"to_sym","intern"),x.$pristine(k,"initialize")}(0,0,L),A(L[0],"Symbol",S("String"))},Opal.modules["corelib/enumerable"]=function(C){var le=C.truthy,me=C.coerce_to,d=C.yield1,H=C.yieldX,ee=C.deny_frozen_access,$=C.module,x=C.send,O=C.slice,E=C.to_a,Y=C.Opal,G=C.thrower,D=C.def,W=C.Kernel,B=C.return_val,Z=C.rb_gt,T=C.rb_times,j=C.rb_lt,oe=C.eqeq,z=C.rb_plus,q=C.rb_minus,K=C.rb_divide,I=C.rb_le,A=C.hash2,J=C.lambda,L=C.not,S=C.alias,v=C.nil,P=C.$$$;return function(R,te){var k=$("::","Enumerable"),de=[k].concat([]),N=C.$r(de);function F(g){return 0===g.length&&(g=[v]),g.length>1&&(g=[g]),g}return D(k,"$all?",function g(l){try{var c=G("return"),f=g.$$p||v;return g.$$p=null,le(void 0!==l)?x(this,"each",[],function(_){var ne=v;if(ne=F(O(arguments)),le(x(l,"public_send",["==="].concat(E(ne)))))return v;c.$throw(!1)},{$$arity:-1,$$ret:c}):x(this,"each",[],f!==v?function(_){var y;if(y=O(arguments),le(C.yieldX(f,E(y))))return v;c.$throw(!1)}:function(_){var y;if(y=O(arguments),le(Y.$destructure(y)))return v;c.$throw(!1)},{$$arity:-1,$$ret:c}),!0}catch(p){if(p===c)return p.$v;throw p}},-1),D(k,"$any?",function g(l){try{var c=G("return"),f=g.$$p||v;return g.$$p=null,le(void 0!==l)?x(this,"each",[],function(_){var ne=v;if(ne=F(O(arguments)),!le(x(l,"public_send",["==="].concat(E(ne)))))return v;c.$throw(!0)},{$$arity:-1,$$ret:c}):x(this,"each",[],f!==v?function(_){var y;if(y=O(arguments),!le(C.yieldX(f,E(y))))return v;c.$throw(!0)}:function(_){var y;if(y=O(arguments),!le(Y.$destructure(y)))return v;c.$throw(!0)},{$$arity:-1,$$ret:c}),!1}catch(p){if(p===c)return p.$v;throw p}},-1),D(k,"$chunk",function g(){var l=g.$$p||v,c=this;return g.$$p=null,l===v?x(c,"to_enum",["chunk"],function f(){return(null==f.$$s?this:f.$$s).$enumerator_size()},{$$s:c}):x(P("Enumerator"),"new",[],function f(u){var p=null==f.$$s?this:f.$$s;null==u&&(u=v);var _=v,y=[];function m(){y.length>0&&u.$yield(_,y)}p.$each.$$p=function(ne){var se=d(l,ne);se===v?(m(),y=[],_=v):(_===v||_===se?y.push(ne):(m(),y=[ne]),_=se)},p.$each(),m()},{$$s:c})}),D(k,"$chunk_while",function g(){var l=g.$$p||v;return g.$$p=null,l===v&&W.$raise(P("ArgumentError"),"no block given"),x(this,"slice_when",[],function(u,p){return null==u&&(u=v),null==p&&(p=v),C.yieldX(l,[u,p])["$!"]()})}),D(k,"$collect",function g(){var l=g.$$p||v,c=this;if(g.$$p=null,l===v)return x(c,"enum_for",["collect"],function u(){return(null==u.$$s?this:u.$$s).$enumerator_size()},{$$s:c});var f=[];return c.$each.$$p=function(){var u=H(l,arguments);f.push(u)},c.$each(),f}),D(k,"$collect_concat",function g(){var l=g.$$p||v,c=this;return g.$$p=null,l===v?x(c,"enum_for",["collect_concat"],function f(){return(null==f.$$s?this:f.$$s).$enumerator_size()},{$$s:c}):x(c,"map",[],l.$to_proc()).$flatten(1)}),D(k,"$compact",function(){return this.$to_a().$compact()}),D(k,"$count",function g(l){var c=g.$$p||v,u=v;return g.$$p=null,u=0,null!=l&&c!==v&&this.$warn("warning: given block not used"),le(null!=l)?c=x(W,"proc",[],function(_){var y;return y=O(arguments),Y.$destructure(y)["$=="](l)},-1):le(c["$nil?"]())&&(c=x(W,"proc",[],B(!0))),x(this,"each",[],function(_){var y;return y=O(arguments),le(H(c,y))?u++:v},-1),u},-1),D(k,"$cycle",function g(l){var c=g.$$p||v,f=this;if(g.$$p=null,null==l&&(l=v),c===v)return x(f,"enum_for",["cycle",l],function m(){var ne=null==m.$$s?this:m.$$s;return le(l["$nil?"]())?le(ne["$respond_to?"]("size"))?P(P("Float"),"INFINITY"):v:(l=Y["$coerce_to!"](l,P("Integer"),"to_int"),le(Z(l,0))?T(ne.$enumerator_size(),l):0)},{$$s:f});if(!le(l["$nil?"]())&&(l=Y["$coerce_to!"](l,P("Integer"),"to_int"),le(l<=0)))return v;var p,_,u=[];if(f.$each.$$p=function(){var m=Y.$destructure(arguments);d(c,m),u.push(m)},f.$each(),0===u.length)return v;if(l===v)for(;;)for(p=0,_=u.length;p<_;p++)d(c,u[p]);else for(;l>1;){for(p=0,_=u.length;p<_;p++)d(c,u[p]);l--}},-1),D(k,"$detect",function g(l){try{var c=G("return"),f=g.$$p||v;return g.$$p=null,f===v?this.$enum_for("detect",l):(x(this,"each",[],function(_){var y,ne=v;if(y=O(arguments),ne=Y.$destructure(y),!le(C.yield1(f,ne)))return v;c.$throw(ne)},{$$arity:-1,$$ret:c}),void 0!==l?"function"==typeof l?l():l:v)}catch(p){if(p===c)return p.$v;throw p}},-1),D(k,"$drop",function(l){l=me(l,P("Integer"),"to_int"),le(l<0)&&W.$raise(P("ArgumentError"),"attempt to drop negative size");var f=[],u=0;return this.$each.$$p=function(){l<=u&&f.push(Y.$destructure(arguments)),u++},this.$each(),f}),D(k,"$drop_while",function g(){var l=g.$$p||v,c=this;if(g.$$p=null,l===v)return c.$enum_for("drop_while");var f=[],u=!0;return c.$each.$$p=function(){var p=Y.$destructure(arguments);if(u){var _=d(l,p);le(_)||(u=!1,f.push(p))}else f.push(p)},c.$each(),f}),D(k,"$each_cons",function g(l){var c=g.$$p||v,f=this;if(g.$$p=null,le(1!=arguments.length)&&W.$raise(P("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 1)"),l=Y.$try_convert(l,P("Integer"),"to_int"),le(l<=0)&&W.$raise(P("ArgumentError"),"invalid size"),c===v)return x(f,"enum_for",["each_cons",l],function p(){var y=v;return y=(null==p.$$s?this:p.$$s).$enumerator_size(),le(y["$nil?"]())?v:oe(y,0)||le(j(y,l))?0:z(q(y,l),1)},{$$s:f});var u=[];return f.$each.$$p=function(){var p=Y.$destructure(arguments);u.push(p),u.length>l&&u.shift(),u.length==l&&d(c,u.slice(0,l))},f.$each(),f}),D(k,"$each_entry",function g(l){var u,c=g.$$p||v,p=this;return g.$$p=null,u=O(arguments),c===v?x(p,"to_enum",["each_entry"].concat(E(u)),function _(){return(null==_.$$s?this:_.$$s).$enumerator_size()},{$$s:p}):(p.$each.$$p=function(){var _=Y.$destructure(arguments);d(c,_)},p.$each.apply(p,u),p)},-1),D(k,"$each_slice",function g(l){var c=g.$$p||v,f=this;if(g.$$p=null,l=me(l,P("Integer"),"to_int"),le(l<=0)&&W.$raise(P("ArgumentError"),"invalid slice size"),c===v)return x(f,"enum_for",["each_slice",l],function p(){var _=null==p.$$s?this:p.$$s;return le(_["$respond_to?"]("size"))?K(_.$size(),l).$ceil():v},{$$s:f});var u=[];return f.$each.$$p=function(){var p=Y.$destructure(arguments);u.push(p),u.length===l&&(d(c,u),u=[])},f.$each(),u.length>0&&d(c,u),f}),D(k,"$each_with_index",function g(l){var u,c=g.$$p||v,p=this;if(g.$$p=null,u=O(arguments),c===v)return x(p,"enum_for",["each_with_index"].concat(E(u)),function y(){return(null==y.$$s?this:y.$$s).$enumerator_size()},{$$s:p});var _=0;return p.$each.$$p=function(){var y=Y.$destructure(arguments);c(y,_),_++},p.$each.apply(p,u),p},-1),D(k,"$each_with_object",function g(l){var c=g.$$p||v,f=this;return g.$$p=null,c===v?x(f,"enum_for",["each_with_object",l],function u(){return(null==u.$$s?this:u.$$s).$enumerator_size()},{$$s:f}):(f.$each.$$p=function(){var u=Y.$destructure(arguments);c(u,l)},f.$each(),l)}),D(k,"$entries",function(l){var f,u=this;f=O(arguments);var p=[];return u.$each.$$p=function(){p.push(Y.$destructure(arguments))},u.$each.apply(u,f),p},-1),D(k,"$filter_map",function g(){var l=g.$$p||v,c=this;return g.$$p=null,l===v?x(c,"enum_for",["filter_map"],function f(){return(null==f.$$s?this:f.$$s).$enumerator_size()},{$$s:c}):x(x(c,"map",[],l.$to_proc()),"select",[],"itself".$to_proc())}),D(k,"$find_all",function g(){var l=g.$$p||v,c=this;if(g.$$p=null,l===v)return x(c,"enum_for",["find_all"],function u(){return(null==u.$$s?this:u.$$s).$enumerator_size()},{$$s:c});var f=[];return c.$each.$$p=function(){var u=Y.$destructure(arguments),p=d(l,u);le(p)&&f.push(u)},c.$each(),f}),D(k,"$find_index",function g(l){try{var c=G("return"),f=g.$$p||v,u=this,p=v;return g.$$p=null,le(void 0===l&&f===v)?u.$enum_for("find_index"):(null!=l&&f!==v&&u.$warn("warning: given block not used"),p=0,le(null!=l)?x(u,"each",[],function(y){var m;return m=O(arguments),oe(Y.$destructure(m),l)&&c.$throw(p),p+=1},{$$arity:-1,$$ret:c}):x(u,"each",[],function(y){var m;return m=O(arguments),le(C.yieldX(f,E(m)))&&c.$throw(p),p+=1},{$$arity:-1,$$ret:c}),v)}catch(_){if(_===c)return _.$v;throw _}},-1),D(k,"$first",function(l){try{var c=G("return"),u=v,p=v;return le(void 0===l)?x(this,"each",[],function(y){null==y&&(y=v),c.$throw(y)},{$$ret:c}):(u=[],l=me(l,P("Integer"),"to_int"),le(l<0)&&W.$raise(P("ArgumentError"),"attempt to take negative size"),le(0==l)?[]:(p=0,x(this,"each",[],function(y){var m;if(m=O(arguments),u.push(Y.$destructure(m)),!le(l<=++p))return v;c.$throw(u)},{$$arity:-1,$$ret:c}),u))}catch(_){if(_===c)return _.$v;throw _}},-1),D(k,"$grep",function g(l){var c=g.$$p||v,u=v;return g.$$p=null,u=[],x(this,"each",[],function(_){var m,ne=v;return ne=F(m=O(arguments)),le(x(l,"__send__",["==="].concat(E(ne))))?(c!==v?(le(Z(m.$length(),1))&&(m=[m]),m=C.yieldX(c,E(m))):le(I(m.$length(),1))&&(m=m["$[]"](0)),u.$push(m)):v},-1),u}),D(k,"$grep_v",function g(l){var c=g.$$p||v,u=v;return g.$$p=null,u=[],x(this,"each",[],function(_){var m,ne=v;return ne=F(m=O(arguments)),le(x(l,"__send__",["==="].concat(E(ne))))?v:(c!==v?(le(Z(m.$length(),1))&&(m=[m]),m=C.yieldX(c,E(m))):le(I(m.$length(),1))&&(m=m["$[]"](0)),u.$push(m))},-1),u}),D(k,"$group_by",function g(){var c,l=g.$$p||v,f=this,u=v,p=v;return g.$$p=null,l===v?x(f,"enum_for",["group_by"],function y(){return(null==y.$$s?this:y.$$s).$enumerator_size()},{$$s:f}):(u=A([],{}),f.$each.$$p=function(){var y=Y.$destructure(arguments),m=d(l,y);(le(p=u["$[]"](m))?p:(c=[m,[]],x(u,"[]=",c),c[c.length-1]))["$<<"](y)},f.$each(),u)}),D(k,"$include?",function(l){try{var c=G("return");return x(this,"each",[],function(p){var _;if(_=O(arguments),!oe(Y.$destructure(_),l))return v;c.$throw(!0)},{$$arity:-1,$$ret:c}),!1}catch(u){if(u===c)return u.$v;throw u}}),D(k,"$inject",function g(l,c){var f=g.$$p||v,u=this;g.$$p=null;var p=l;return f!==v&&void 0===c?u.$each.$$p=function(){var _=Y.$destructure(arguments);void 0!==p?(_=H(f,[p,_]),p=_):p=_}:(void 0===c&&(P("Symbol")["$==="](l)||W.$raise(P("TypeError"),l.$inspect()+" is not a Symbol"),c=l,p=void 0),u.$each.$$p=function(){var _=Y.$destructure(arguments);p=void 0!==p?p.$__send__(c,_):_}),u.$each(),null==p?v:p},-1),D(k,"$lazy",function(){return x(P(P("Enumerator"),"Lazy"),"new",[this,this.$enumerator_size()],function(f,u){var p;return null==f&&(f=v),p=O(arguments,1),x(f,"yield",E(p))},-2)}),D(k,"$enumerator_size",function(){return le(this["$respond_to?"]("size"))?this.$size():v}),D(k,"$max",function g(l){var u,p,c=g.$$p||v,f=this;return g.$$p=null,void 0===l||l===v?(f.$each.$$p=function(){var _=Y.$destructure(arguments);void 0!==u?((p=c!==v?H(c,[_,u]):_["$<=>"](u))===v&&W.$raise(P("ArgumentError"),"comparison failed"),p>0&&(u=_)):u=_},f.$each(),void 0===u?v:u):(l=me(l,P("Integer"),"to_int"),x(f,"sort",[],c.$to_proc()).$reverse().$first(l))},-1),D(k,"$max_by",function g(l){var u,p,c=g.$$p||v,f=this;return g.$$p=null,null==l&&(l=v),le(c)?le(l["$nil?"]())?(f.$each.$$p=function(){var _=Y.$destructure(arguments),y=d(c,_);if(void 0===u)return u=_,void(p=y);y["$<=>"](p)>0&&(u=_,p=y)},f.$each(),void 0===u?v:u):x(f,"sort_by",[],c.$to_proc()).$reverse().$take(l):x(f,"enum_for",["max_by",l],function _(){return(null==_.$$s?this:_.$$s).$enumerator_size()},{$$s:f})},-1),D(k,"$min",function g(l){var u,c=g.$$p||v,f=this;return g.$$p=null,null==l&&(l=v),le(l["$nil?"]())?(f.$each.$$p=c!==v?function(){var p=Y.$destructure(arguments);if(void 0!==u){var _=c(p,u);_===v&&W.$raise(P("ArgumentError"),"comparison failed"),_<0&&(u=p)}else u=p}:function(){var p=Y.$destructure(arguments);void 0!==u?Y.$compare(p,u)<0&&(u=p):u=p},f.$each(),void 0===u?v:u):c!==v?x(f,"sort",[],function(_,y){return null==_&&(_=v),null==y&&(y=v),C.yieldX(c,[_,y])}).$take(l):f.$sort().$take(l)},-1),D(k,"$min_by",function g(l){var u,p,c=g.$$p||v,f=this;return g.$$p=null,null==l&&(l=v),le(c)?le(l["$nil?"]())?(f.$each.$$p=function(){var _=Y.$destructure(arguments),y=d(c,_);if(void 0===u)return u=_,void(p=y);y["$<=>"](p)<0&&(u=_,p=y)},f.$each(),void 0===u?v:u):x(f,"sort_by",[],c.$to_proc()).$take(l):x(f,"enum_for",["min_by",l],function _(){return(null==_.$$s?this:_.$$s).$enumerator_size()},{$$s:f})},-1),D(k,"$minmax",function g(){var f,l=g.$$p||v;g.$$p=null,l=le(f=l)?f:x(W,"proc",[],function(m,ne){return null==m&&(m=v),null==ne&&(ne=v),m["$<=>"](ne)});var u=v,p=v,_=!0;return this.$each.$$p=function(){var y=Y.$destructure(arguments);if(_)u=p=y,_=!1;else{var m=l.$call(u,y);m===v?W.$raise(P("ArgumentError"),"comparison failed"):m>0&&(u=y);var ne=l.$call(p,y);ne===v?W.$raise(P("ArgumentError"),"comparison failed"):ne<0&&(p=y)}},this.$each(),[u,p]}),D(k,"$minmax_by",function g(){var l=g.$$p||v,c=this;if(g.$$p=null,!le(l))return x(c,"enum_for",["minmax_by"],function y(){return(null==y.$$s?this:y.$$s).$enumerator_size()},{$$s:c});var p,_,f=v,u=v;return c.$each.$$p=function(){var y=Y.$destructure(arguments),m=d(l,y);(void 0===p||m["$<=>"](p)<0)&&(f=y,p=m),(void 0===_||m["$<=>"](_)>0)&&(u=y,_=m)},c.$each(),[f,u]}),D(k,"$none?",function g(l){try{var c=G("return"),f=g.$$p||v;return g.$$p=null,le(void 0!==l)?x(this,"each",[],function(_){var ne=v;if(ne=F(O(arguments)),!le(x(l,"public_send",["==="].concat(E(ne)))))return v;c.$throw(!1)},{$$arity:-1,$$ret:c}):x(this,"each",[],f!==v?function(_){var y;if(y=O(arguments),!le(C.yieldX(f,E(y))))return v;c.$throw(!1)}:function(_){var y,ne=v;if(y=O(arguments),ne=Y.$destructure(y),!le(ne))return v;c.$throw(!1)},{$$arity:-1,$$ret:c}),!0}catch(p){if(p===c)return p.$v;throw p}},-1),D(k,"$one?",function g(l){try{var c=G("return"),f=g.$$p||v,p=v;return g.$$p=null,p=0,le(void 0!==l)?x(this,"each",[],function(y){var se=v;return se=F(O(arguments)),le(x(l,"public_send",["==="].concat(E(se))))?(p=z(p,1),le(Z(p,1))?void c.$throw(!1):v):v},{$$arity:-1,$$ret:c}):x(this,"each",[],f!==v?function(y){var m;return m=O(arguments),le(C.yieldX(f,E(m)))?(p=z(p,1),le(Z(p,1))?void c.$throw(!1):v):v}:function(y){var m;return m=O(arguments),le(Y.$destructure(m))?(p=z(p,1),le(Z(p,1))?void c.$throw(!1):v):v},{$$arity:-1,$$ret:c}),p["$=="](1)}catch(_){if(_===c)return _.$v;throw _}},-1),D(k,"$partition",function g(){var l=g.$$p||v,c=this;if(g.$$p=null,l===v)return x(c,"enum_for",["partition"],function _(){return(null==_.$$s?this:_.$$s).$enumerator_size()},{$$s:c});var f=[],u=[];return c.$each.$$p=function(){var _=Y.$destructure(arguments),y=d(l,_);le(y)?f.push(_):u.push(_)},c.$each(),[f,u]}),D(k,"$reject",function g(){var l=g.$$p||v,c=this;if(g.$$p=null,l===v)return x(c,"enum_for",["reject"],function u(){return(null==u.$$s?this:u.$$s).$enumerator_size()},{$$s:c});var f=[];return c.$each.$$p=function(){var u=Y.$destructure(arguments),p=d(l,u);le(p)||f.push(u)},c.$each(),f}),D(k,"$reverse_each",function g(){var l=g.$$p||v,c=this;if(g.$$p=null,l===v)return x(c,"enum_for",["reverse_each"],function p(){return(null==p.$$s?this:p.$$s).$enumerator_size()},{$$s:c});var f=[];c.$each.$$p=function(){f.push(arguments)},c.$each();for(var u=f.length-1;u>=0;u--)H(l,f[u]);return f}),D(k,"$slice_before",function g(l){var c=g.$$p||v,f=this;return g.$$p=null,le(void 0===l&&c===v)&&W.$raise(P("ArgumentError"),"both pattern and block are given"),le(void 0!==l&&c!==v||arguments.length>1)&&W.$raise(P("ArgumentError"),"wrong number of arguments ("+arguments.length+" expected 1)"),x(P("Enumerator"),"new",[],function u(p){var _=null==u.$$s?this:u.$$s;null==p&&(p=v);var y=[];_.$each.$$p=c!==v?void 0===l?function(){var m=Y.$destructure(arguments),ne=d(c,m);le(ne)&&y.length>0&&(p["$<<"](y),y=[]),y.push(m)}:function(){var m=Y.$destructure(arguments),ne=c(m,l.$dup());le(ne)&&y.length>0&&(p["$<<"](y),y=[]),y.push(m)}:function(){var m=Y.$destructure(arguments),ne=l["$==="](m);le(ne)&&y.length>0&&(p["$<<"](y),y=[]),y.push(m)},_.$each(),y.length>0&&p["$<<"](y)},{$$s:f})},-1),D(k,"$slice_after",function g(l){var c=g.$$p||v,f=this;return g.$$p=null,le(void 0===l&&c===v)&&W.$raise(P("ArgumentError"),"both pattern and block are given"),le(void 0!==l&&c!==v||arguments.length>1)&&W.$raise(P("ArgumentError"),"wrong number of arguments ("+arguments.length+" expected 1)"),le(void 0!==l)&&(c=x(W,"proc",[],function(p){return null==p&&(p=v),l["$==="](p)})),x(P("Enumerator"),"new",[],function u(p){var y,_=null==u.$$s?this:u.$$s;null==p&&(p=v),_.$each.$$p=function(){var m=Y.$destructure(arguments),ne=d(c,m);null==y&&(y=[]),le(ne)?(y.push(m),p.$yield(y),y=null):y.push(m)},_.$each(),null!=y&&p.$yield(y)},{$$s:f})},-1),D(k,"$slice_when",function g(){var l=g.$$p||v;return g.$$p=null,l===v&&W.$raise(P("ArgumentError"),"wrong number of arguments (0 for 1)"),x(P("Enumerator"),"new",[],function f(u){var p=null==f.$$s?this:f.$$s;null==u&&(u=v);var _=v,y=v;p.$each_cons.$$p=function(){var m=Y.$destructure(arguments),ne=m[0],se=m[1],Ee=H(l,[ne,se]);y=se,_===v&&(_=[]),le(Ee)?(_.push(ne),u.$yield(_),_=[]):_.push(ne)},p.$each_cons(2),_!==v&&(_.push(y),u.$yield(_))},{$$s:this})}),D(k,"$sort",function g(){var f,l=g.$$p||v;return g.$$p=null,f=this.$to_a(),l===v&&(l=J(function(p,_){return null==p&&(p=v),null==_&&(_=v),p["$<=>"](_)})),x(f,"sort",[],l.$to_proc())}),D(k,"$sort_by",function g(){var l=g.$$p||v,c=this,f=v;return g.$$p=null,l===v?x(c,"enum_for",["sort_by"],function u(){return(null==u.$$s?this:u.$$s).$enumerator_size()},{$$s:c}):(f=x(c,"map",[],function(){var p=v;return p=Y.$destructure(arguments),[C.yield1(l,p),p]}),x(f,"sort!",[],function(p,_){return null==p&&(p=v),null==_&&(_=v),p[0]["$<=>"](_[0])}),x(f,"map!",[],function(p){return null==p&&(p=v),p[1]}))}),D(k,"$sum",function g(l){var c=g.$$p||v,u=v,p=v;return g.$$p=null,null==l&&(l=0),u=l,p=0,x(this,"each",[],function(y){var ne,se=v,Ee=v,ke=v;return ne=O(arguments),se=c!==v?C.yieldX(c,E(ne)):Y.$destructure(ne),L([P(P("Float"),"INFINITY"),P(P("Float"),"INFINITY")["$-@"]()]["$include?"](se))&&le(se["$respond_to?"]("-"))?(Ee=q(se,p),ke=z(u,Ee),p=q(q(ke,u),Ee),u=ke):u=z(u,se)},-1),u},-1),D(k,"$take",function(l){return this.$first(l)}),D(k,"$take_while",function g(){try{var l=G("return"),c=g.$$p||v,u=v;return g.$$p=null,le(c)?(u=[],x(this,"each",[],function(_){var y,ne=v;return y=O(arguments),ne=Y.$destructure(y),le(C.yield1(c,ne))||l.$throw(u),u.push(ne)},{$$arity:-1,$$ret:l})):this.$enum_for("take_while")}catch(p){if(p===l)return p.$v;throw p}}),D(k,"$uniq",function g(){var l=g.$$p||v,f=v;return g.$$p=null,f=A([],{}),x(this,"each",[],function(p){var _,m,ne=v,se=v;return _=O(arguments),ne=Y.$destructure(_),se=l!==v?C.yield1(l,ne):ne,le(f["$key?"](se))?v:(x(f,"[]=",m=[se,ne]),m[m.length-1])},-1),f.$values()}),D(k,"$tally",function(l){var f;return l&&l!==v&&ee(l),f=x(x(this,"group_by",[],"itself".$to_proc()),"transform_values",[],"count".$to_proc()),le(l)?(x(f,"each",[],function(p,_){var y;return null==p&&(p=v),null==_&&(_=v),y=[p,z(l.$fetch(p,0),_)],x(l,"[]=",y),y[y.length-1]}),l):f},-1),D(k,"$to_h",function g(l){var u,c=g.$$p||v,p=this;if(g.$$p=null,u=O(arguments),c!==v)return x(x(p,"map",[],c.$to_proc()),"to_h",E(u));var _=A([],{});return p.$each.$$p=function(){var y=Y.$destructure(arguments),m=Y["$coerce_to?"](y,P("Array"),"to_ary");m.$$is_array||W.$raise(P("TypeError"),"wrong element type "+m.$class()+" (expected array)"),2!==m.length&&W.$raise(P("ArgumentError"),"wrong array length (expected 2, was "+m.$length()+")"),C.hash_put(_,m[0],m[1])},p.$each.apply(p,u),_},-1),D(k,"$to_set",function g(l,c){var u,p,f=g.$$p||v,y=this;return g.$$p=null,(u=O(arguments)).length>0&&(p=u.shift()),null==p&&(p=N("Set")),x(p,"new",[y].concat(E(u)),f.$to_proc())},-1),D(k,"$zip",function g(l){var u,p=this;return g.$$p=null,u=O(arguments),x(p.$to_a(),"zip",E(u))},-1),S(k,"find","detect"),S(k,"filter","find_all"),S(k,"flat_map","collect_concat"),S(k,"map","collect"),S(k,"member?","include?"),S(k,"reduce","inject"),S(k,"select","find_all"),S(k,"to_a","entries")}()},Opal.modules["corelib/enumerator/arithmetic_sequence"]=function(C){var A,J,L,le=C.klass,me=C.truthy,d=C.to_a,H=C.eqeq,ee=C.Kernel,$=C.def,x=C.rb_gt,O=C.rb_lt,E=C.rb_le,Y=C.rb_ge,G=C.rb_plus,D=C.rb_minus,W=C.eqeqeq,B=C.not,Z=C.rb_times,T=C.rb_divide,j=C.alias,z=C.nil,q=C.$$$;return A=[],L=[J=le("::",null,"Enumerator")].concat(A),function(S,M,v){var P=le(S,M,"ArithmeticSequence"),R=[P].concat(v),te=C.$r(R),k=P.$$prototype;k.step_arg2=k.receiver_num=k.step_arg1=k.step=k.range=k.topfx=k.bypfx=k.creation_method=k.skipped_arg=z,C.prop(P.$$prototype,"$$is_arithmetic_seq",!0);var de=1/0;return $(P,"$initialize",function(F,g,l){var c,f=this,u=z;return null==l&&(l="step"),f.creation_method=l,me(F["$is_a?"](q("Array")))?(c=[].concat(d(F)),f.step_arg1=null==c[0]?z:c[0],f.step_arg2=null==c[1]?z:c[1],f.topfx=null==c[2]?z:c[2],f.bypfx=null==c[3]?z:c[3],f.receiver_num=g,f.step=1,f.range=me(f.step_arg2)?(f.step=f.step_arg2,C.Range.$new(f.receiver_num,f.step_arg1,!1)):me(f.step_arg1)?C.Range.$new(f.receiver_num,f.step_arg1,!1):C.Range.$new(f.receiver_num,z,!1)):(me(g)||(f.skipped_arg=!0),c=[F,me(u=g)?u:1],f.range=c[0],f.step=c[1]),f.object=f,H(f.step,0)&&ee.$raise(te("ArgumentError"),"step can't be 0"),me(f.step["$respond_to?"]("to_int"))?z:ee.$raise(te("ArgumentError"),"no implicit conversion of "+f.step.$class()+" into Integer")},-2),P.$attr_reader("step"),$(P,"$begin",function(){return this.range.$begin()}),$(P,"$end",function(){return this.range.$end()}),$(P,"$exclude_end?",function(){return this.range["$exclude_end?"]()}),$(P,"$_lesser_than_end?",function(F){var l,c,g=this;return l=me(c=g.$end())?c:de,me(x(g.$step(),0))?me(g["$exclude_end?"]())?O(F,l):E(F,l):me(g["$exclude_end?"]())?x(F,l):Y(F,l)}),$(P,"$_greater_than_begin?",function(F){var l,c;return l=me(c=this.$begin())?c:de["$-@"](),me(x(this.$step(),0))?x(F,l):O(F,l)}),$(P,"$first",function(F){var g=this,l=z,c=z,f=z;if(l=me(c=g.$begin())?c:de["$-@"](),!me(F))return me(g["$_lesser_than_end?"](l))?l:z;for(f=[];me(me(c=g["$_lesser_than_end?"](l))?x(F,0):c);)f["$<<"](l),l=G(l,g.$step()),F=D(F,1);return f},-1),$(P,"$each",function N(){var l,F=N.$$p||z,g=this,c=z;if(N.$$p=null,F===z)return g;for(W(z,g.$begin())&&ee.$raise(te("TypeError"),"nil can't be coerced into Integer"),c=me(l=g.$begin())?l:de["$-@"]();me(g["$_lesser_than_end?"](c));)C.yield1(F,c),c=G(c,g.$step());return g}),$(P,"$last",function(F){var g=this,l=z,c=z,f=z;if(W(de,l=g.$end())||W(de["$-@"](),l)?ee.$raise(q("FloatDomainError"),g.$end()):W(z,l)&&ee.$raise(q("RangeError"),"cannot get the last element of endless arithmetic sequence"),c=D(g.$end(),D(g.$end(),g.$begin())["$%"](g.$step())),me(g["$_lesser_than_end?"](c))||(c=D(c,g.$step())),!me(F))return me(g["$_greater_than_begin?"](c))?c:z;for(f=[];me(me(l=g["$_greater_than_begin?"](c))?x(F,0):l);)f["$<<"](c),c=D(c,g.$step()),F=D(F,1);return f.$reverse()},-1),$(P,"$size",function(){var g,F=this,l=z;return g=me(x(F.$step(),0))?1:-1,B(F["$_lesser_than_end?"](F.$begin()))?0:me([de["$-@"](),de]["$include?"](F.$step()))?1:me([Z(de["$-@"](),g),z]["$include?"](F.$begin()))||me([Z(de,g),z]["$include?"](F.$end()))?de:(l=D(F.$end(),D(F.$end(),F.$begin())["$%"](F.$step())),me(F["$_lesser_than_end?"](l))||(l=D(l,F.$step())),G(T(D(l,F.$begin()),F.$step()).$abs().$to_i(),1))}),$(P,"$==",function(F){var l,c,f,u,g=this;return me(l=me(c=me(f=me(u=g.$class()["$=="](F.$class()))?g.$begin()["$=="](F.$begin()):u)?g.$end()["$=="](F.$end()):f)?g.$step()["$=="](F.$step()):c)?g["$exclude_end?"]()["$=="](F["$exclude_end?"]()):l}),$(P,"$hash",function(){var F=this;return[F.$begin(),F.$end(),F.$step(),F["$exclude_end?"]()].$hash()}),$(P,"$inspect",function(){var F=this,g=z;return me(F.receiver_num)?(g=me(F.step_arg2)?"("+F.topfx+F.step_arg1.$inspect()+", "+F.bypfx+F.step_arg2.$inspect()+")":me(F.step_arg1)?"("+F.topfx+F.step_arg1.$inspect()+")":z,"("+F.receiver_num.$inspect()+"."+F.creation_method+g+")"):(g=me(F.skipped_arg)?z:"("+F.step+")","(("+F.range.$inspect()+")."+F.creation_method+g+")")}),j(P,"===","=="),j(P,"eql?","==")}(J,J,L)},Opal.modules["corelib/enumerator/chain"]=function(C){var j,oe,B,le=C.deny_frozen_access,me=C.klass,d=C.slice,H=C.def,ee=C.send,$=C.to_a,x=C.truthy,O=C.rb_plus,E=C.thrower,Y=C.nil,G=C.$$$;return B=me("::",null,"Enumerator"),(oe=(j=me(B,B,"Chain")).$$prototype).enums=oe.iterated=Y,H(j,"$initialize",function(q){var I,A=this;return I=d(arguments),le(A),A.enums=I,A.iterated=[],A.object=A},-1),H(j,"$each",function z(q){var I,A,K=z.$$p||Y,J=this;return z.$$p=null,I=d(arguments),A=I,K===Y?ee(J,"to_enum",["each"].concat($(A)),function L(){return(null==L.$$s?this:L.$$s).$size()},{$$s:J}):(ee(J.enums,"each",[],function L(S){var M=null==L.$$s?this:L.$$s;return null==M.iterated&&(M.iterated=Y),null==S&&(S=Y),M.iterated["$<<"](S),ee(S,"each",$(A),K.$to_proc())},{$$s:J}),J)},-1),H(j,"$size",function(q){try{var I,A,K=E("return"),J=this,L=Y;return I=d(arguments),A=I,L=0,ee(J.enums,"each",[],function(M){var v;return null==M&&(M=Y),v=ee(M,"size",$(A)),x([Y,G(G("Float"),"INFINITY")]["$include?"](v))&&K.$throw(v),L=O(L,v)},{$$ret:K}),L}catch(S){if(S===K)return S.$v;throw S}},-1),H(j,"$rewind",function(){var q=this;return ee(q.iterated,"reverse_each",[],function(I){return null==I&&(I=Y),x(I["$respond_to?"]("rewind"))?I.$rewind():Y}),q.iterated=[],q}),H(j,"$inspect",function(){return"#<Enumerator::Chain: "+this.enums.$inspect()+">"})},Opal.modules["corelib/enumerator/generator"]=function(C){var W,oe,z,q,K,Z,le=C.deny_frozen_access,me=C.klass,d=C.truthy,H=C.Kernel,ee=C.def,$=C.slice,x=C.send,O=[],E=C.nil,Y=C.$$$;return W=O,oe=Z=[me(O[0],null,"Enumerator")].concat(W),q=[z=me(Z[0],null,"Generator")].concat(oe),K=C.$r(q),z.$$prototype.block=E,z.$include(Y("Enumerable")),ee(z,"$initialize",function A(){var J=A.$$p||E;return A.$$p=null,le(this),d(J)||H.$raise(Y("LocalJumpError"),"no block given"),this.block=J}),ee(z,"$each",function A(J){var M,L=A.$$p||E,v=this,P=E;A.$$p=null,M=$(arguments),P=x(K("Yielder"),"new",[],L.$to_proc());try{M.unshift(P),C.yieldX(v.block,M)}catch(R){if(R&&"breaker"==R.$thrower_type)return R.$v;throw R}return v},-1)},Opal.modules["corelib/enumerator/lazy"]=function(C){var S,te,k,de,N,M,le=C.truthy,me=C.coerce_to,d=C.yield1,H=C.yieldX,ee=C.deny_frozen_access,$=C.klass,x=C.slice,O=C.send2,E=C.find_super,Y=C.to_a,G=C.defs,D=C.Kernel,W=C.send,B=C.def,Z=C.return_self,T=C.Opal,j=C.rb_lt,oe=C.eqeqeq,z=C.rb_plus,q=C.alias,I=C.nil,A=C.$$$;return S=[],te=[M=$("::",null,"Enumerator")].concat(S),de=[k=$(M,M,"Lazy")].concat(te),N=C.$r(de),k.$$prototype.enumerator=I,$(k,A("Exception"),"StopLazyError"),G(k,"$for",function g(l,c){var u,p=g.$$p||I,_=this,y=I;return g.$$p=null,u=x(arguments,1),(y=O(_,E(_,"for",g,!1,!0),"for",[l].concat(Y(u)),p)).enumerator=l,y},-2),B(k,"$initialize",function g(l,c){var f=g.$$p||I,u=this;return g.$$p=null,null==c&&(c=I),ee(u),f===I&&D.$raise(A("ArgumentError"),"tried to call lazy new without a block"),u.enumerator=l,O(u,E(u,"initialize",g,!1,!0),"initialize",[c],function(_,y){var ne;null==_&&(_=I),ne=x(arguments,1);try{return W(l,"each",Y(ne),function(Ee){var ce;(ce=x(arguments)).unshift(_),H(f,ce)},-1)}catch(se){if(!C.rescue(se,[N("StopLazyError")]))throw se;try{return I}finally{C.pop_exception()}}},-2)},-2),B(k,"$lazy",Z),B(k,"$collect",function g(){var l=g.$$p||I;return g.$$p=null,le(l)||D.$raise(A("ArgumentError"),"tried to call lazy map without a block"),W(N("Lazy"),"new",[this,this.$enumerator_size()],function(u,p){var _;null==u&&(u=I),_=x(arguments,1);var m=H(l,_);u.$yield(m)},-2)}),B(k,"$collect_concat",function g(){var l=g.$$p||I;return g.$$p=null,le(l)||D.$raise(A("ArgumentError"),"tried to call lazy map without a block"),W(N("Lazy"),"new",[this,I],function(u,p){var _;null==u&&(u=I),_=x(arguments,1);var m=H(l,_);if(m["$respond_to?"]("force")&&m["$respond_to?"]("each"))W(m,"each",[],function(Ee){return null==Ee&&(Ee=I),u.$yield(Ee)});else{var ne=T.$try_convert(m,A("Array"),"to_ary");ne===I?u.$yield(m):W(m,"each",[],function(Ee){return null==Ee&&(Ee=I),u.$yield(Ee)})}},-2)}),B(k,"$drop",function(l){var f,u,p=I;return l=me(l,A("Integer"),"to_int"),le(j(l,0))&&D.$raise(A("ArgumentError"),"attempt to drop negative size"),f=this.$enumerator_size(),u=oe(A("Integer"),f)&&le(j(l,f))?l:f,p=0,W(N("Lazy"),"new",[this,u],function(y,m){var se;return null==y&&(y=I),se=x(arguments,1),le(j(p,l))?p=z(p,1):W(y,"yield",Y(se))},-2)}),B(k,"$drop_while",function g(){var l=g.$$p||I,f=I;return g.$$p=null,le(l)||D.$raise(A("ArgumentError"),"tried to call lazy drop_while without a block"),f=!0,W(N("Lazy"),"new",[this,I],function(p,_){var m;if(null==p&&(p=I),m=x(arguments,1),!le(f))return W(p,"yield",Y(m));var ne=H(l,m);le(ne)||(f=!1,W(p,"yield",Y(m)))},-2)}),B(k,"$enum_for",function g(l,c){var u,p,_,f=g.$$p||I,y=this;return g.$$p=null,(u=x(arguments)).length>0&&(p=u.shift()),null==p&&(p="each"),_=u,W(y.$class(),"for",[y,p].concat(Y(_)),f.$to_proc())},-1),B(k,"$find_all",function g(){var l=g.$$p||I;return g.$$p=null,le(l)||D.$raise(A("ArgumentError"),"tried to call lazy select without a block"),W(N("Lazy"),"new",[this,I],function(u,p){var _,y;null==u&&(u=I),_=x(arguments,1);var m=H(l,y=_);le(m)&&W(u,"yield",Y(y))},-2)}),B(k,"$grep",function g(l){var c=g.$$p||I;return g.$$p=null,le(c)?W(N("Lazy"),"new",[this,I],function(p,_){var y;null==p&&(p=I),y=x(arguments,1);var ne=T.$destructure(y),se=l["$==="](ne);le(se)&&(se=d(c,ne),p.$yield(d(c,ne)))},-2):W(N("Lazy"),"new",[this,I],function(p,_){var y;null==p&&(p=I),y=x(arguments,1);var ne=T.$destructure(y),se=l["$==="](ne);le(se)&&p.$yield(ne)},-2)}),B(k,"$reject",function g(){var l=g.$$p||I;return g.$$p=null,le(l)||D.$raise(A("ArgumentError"),"tried to call lazy reject without a block"),W(N("Lazy"),"new",[this,I],function(u,p){var _,y;null==u&&(u=I),_=x(arguments,1);var m=H(l,y=_);le(m)||W(u,"yield",Y(y))},-2)}),B(k,"$take",function(l){var f,u,p=I;return l=me(l,A("Integer"),"to_int"),le(j(l,0))&&D.$raise(A("ArgumentError"),"attempt to take negative size"),f=this.$enumerator_size(),u=oe(A("Integer"),f)&&le(j(l,f))?l:f,p=0,W(N("Lazy"),"new",[this,u],function(y,m){var se;return null==y&&(y=I),se=x(arguments,1),le(j(p,l))?(W(y,"yield",Y(se)),p=z(p,1)):D.$raise(N("StopLazyError"))},-2)}),B(k,"$take_while",function g(){var l=g.$$p||I;return g.$$p=null,le(l)||D.$raise(A("ArgumentError"),"tried to call lazy take_while without a block"),W(N("Lazy"),"new",[this,I],function(u,p){var _,y;null==u&&(u=I),_=x(arguments,1);var m=H(l,y=_);le(m)?W(u,"yield",Y(y)):D.$raise(N("StopLazyError"))},-2)}),B(k,"$inspect",function(){return"#<"+this.$class()+": "+this.enumerator.$inspect()+">"}),q(k,"force","to_a"),q(k,"filter","find_all"),q(k,"flat_map","collect_concat"),q(k,"map","collect"),q(k,"select","find_all"),q(k,"to_enum","enum_for")},Opal.modules["corelib/enumerator/yielder"]=function(C){var Y,Z,D,le=C.klass,me=C.def,d=C.slice,H=C.send,ee=C.to_a,$=[],x=C.nil;return Y=$,D=[le($[0],null,"Enumerator")].concat(Y),(Z=le(D[0],null,"Yielder")).$$prototype.block=x,me(Z,"$initialize",function j(){var oe=j.$$p||x;return j.$$p=null,this.block=oe,this}),me(Z,"$yield",function(oe){var z,K=this;z=d(arguments);var I=C.yieldX(K.block,z);if(I&&"break"==I.$thrower_type)throw I;return I},-1),me(Z,"$<<",function(oe){return this.$yield(oe),this}),me(Z,"$to_proc",function(){return H(this,"proc",[],function z(q){var K,A=null==z.$$s?this:z.$$s;return K=d(arguments),H(A,"yield",ee(K))},{$$arity:-1,$$s:this})})},Opal.modules["corelib/enumerator"]=function(C){var L,S,M,v,P,le=C.slice,me=C.coerce_to,d=C.deny_frozen_access,H=C.klass,ee=C.defs,$=C.truthy,x=C.send,O=C.not,E=C.def,Y=C.rb_plus,G=C.to_a,D=C.Opal,W=C.send2,B=C.find_super,Z=C.rb_ge,T=C.Kernel,j=C.rb_le,oe=C.alias,K=C.nil,I=C.$$$;return C.top.$require("corelib/enumerable"),L=[],M=[S=H("::",null,"Enumerator")].concat(L),v=C.$r(M),(P=S.$$prototype).size=P.args=P.object=P.method=P.values=P.cursor=K,S.$include(I("Enumerable")),S.$$prototype.$$is_enumerator=!0,ee(S,"$for",function R(te,k,de){var F,g,l,N=R.$$p||K,c=this;R.$$p=null,(F=le(arguments,1)).length>0&&(g=F.shift()),null==g&&(g="each"),l=F;var f=c.$allocate();return f.object=te,f.size=N,f.method=g,f.args=l,f.cursor=0,f},-2),E(S,"$initialize",function R(te){var k=R.$$p||K,F=this;return R.$$p=null,le(arguments),d(F),F.cursor=0,$(k)?(F.object=x(v("Generator"),"new",[],k.$to_proc()),F.method="each",F.args=[],F.size=arguments[0]||K,$(F.size)&&O(F.size["$respond_to?"]("call"))?F.size=me(F.size,I("Integer"),"to_int"):K):(F.object=arguments[0],F.method=arguments[1]||"each",F.args=le(arguments,2),F.size=K)},-1),E(S,"$each",function R(te){var N,k=R.$$p||K,F=this;return R.$$p=null,N=le(arguments),$(k["$nil?"]())&&$(N["$empty?"]())?F:(N=Y(F.args,N),$(k["$nil?"]())?x(F.$class(),"new",[F.object,F.method].concat(G(N))):x(F.object,"__send__",[F.method].concat(G(N)),k.$to_proc()))},-1),E(S,"$size",function(){return $(this.size["$respond_to?"]("call"))?x(this.size,"call",G(this.args)):this.size}),E(S,"$with_index",function R(te){var k=R.$$p||K;if(R.$$p=null,null==te&&(te=0),te=$(te)?me(te,I("Integer"),"to_int"):0,!$(k))return x(this,"enum_for",["with_index",te],function g(){return(null==g.$$s?this:g.$$s).$size()},{$$s:this});var F=te;return this.$each.$$p=function(){var g=D.$destructure(arguments),l=k(g,F);return F++,l},this.$each()},-1),E(S,"$each_with_index",function R(){var te=R.$$p||K,k=this;return R.$$p=null,te===K?x(k,"enum_for",["each_with_index"],function de(){return(null==de.$$s?this:de.$$s).$size()},{$$s:k}):(W(k,B(k,"each_with_index",R,!1,!0),"each_with_index",[],te),k.object)}),E(S,"$rewind",function(){return this.cursor=0,this}),E(S,"$peek_values",function(){var k,te=this;return te.values=$(k=te.values)?k:x(te,"map",[],function(N){return le(arguments)},-1),$(Z(te.cursor,te.values.$length()))&&T.$raise(I("StopIteration"),"iteration reached an end"),te.values["$[]"](te.cursor)}),E(S,"$peek",function(){var k=K;return k=this.$peek_values(),$(j(k.$length(),1))?k["$[]"](0):k}),E(S,"$next_values",function(){var k;return k=this.$peek_values(),this.cursor=Y(this.cursor,1),k}),E(S,"$next",function(){var k=K;return k=this.$next_values(),$(j(k.$length(),1))?k["$[]"](0):k}),E(S,"$feed",function(te){return this.$raise(v("NotImplementedError"),"Opal doesn't support Enumerator#feed")}),E(S,"$+",function(te){return I(I("Enumerator"),"Chain").$new(this,te)}),E(S,"$inspect",function(){var te=this,k=K;return k="#<"+te.$class()+": "+te.object.$inspect()+":"+te.method,$(te.args["$any?"]())&&(k=Y(k,"("+te.args.$inspect()["$[]"](I("Range").$new(1,-2))+")")),Y(k,">")}),oe(S,"with_object","each_with_object"),S.$autoload("ArithmeticSequence","corelib/enumerator/arithmetic_sequence"),S.$autoload("Chain","corelib/enumerator/chain"),S.$autoload("Generator","corelib/enumerator/generator"),S.$autoload("Lazy","corelib/enumerator/lazy"),S.$autoload("Yielder","corelib/enumerator/yielder")},Opal.modules["corelib/numeric"]=function(C){var P,le=C.klass,me=C.truthy,d=C.Kernel,H=C.def,ee=C.to_ary,$=C.return_self,x=C.rb_minus,O=C.rb_times,E=C.rb_lt,Y=C.eqeq,G=C.rb_divide,D=C.return_val,W=C.Opal,B=C.slice,Z=C.extract_kwargs,T=C.ensure_kwargs,j=C.not,oe=C.send,z=C.rb_ge,q=C.rb_le,K=C.rb_plus,I=C.rb_gt,A=C.alias,L=C.nil,S=C.$$$;return C.top.$require("corelib/comparable"),(P=le("::",null,"Numeric")).$include(S("Comparable")),H(P,"$coerce",function(te){var k=this;return me(te["$instance_of?"](k.$class()))?[te,k]:[d.$Float(te),d.$Float(k)]}),H(P,"$__coerced__",function(te,k){var de,N;if(me(k["$respond_to?"]("coerce")))return N=k.$coerce(this),(null==(de=ee(N))[0]?L:de[0]).$__send__(te,null==de[1]?L:de[1]);switch(te){case"+":case"-":case"*":case"/":case"%":case"&":case"|":case"^":case"**":return d.$raise(S("TypeError"),k.$class()+" can't be coerced into Numeric");case">":case">=":case"<":case"<=":case"<=>":return d.$raise(S("ArgumentError"),"comparison of "+this.$class()+" with "+k.$class()+" failed");default:return L}}),H(P,"$<=>",function(te){return me(this["$equal?"](te))?0:L}),H(P,"$+@",$),H(P,"$-@",function(){return x(0,this)}),H(P,"$%",function(te){return x(this,O(te,this.$div(te)))}),H(P,"$abs",function(){return E(this,0)?this["$-@"]():this}),H(P,"$abs2",function(){return O(this,this)}),H(P,"$angle",function(){return E(this,0)?S(S("Math"),"PI"):0}),H(P,"$ceil",function(te){return null==te&&(te=0),this.$to_f().$ceil(te)},-1),H(P,"$conj",$),H(P,"$denominator",function(){return this.$to_r().$denominator()}),H(P,"$div",function(te){return Y(te,0)&&d.$raise(S("ZeroDivisionError"),"divided by o"),G(this,te).$floor()}),H(P,"$divmod",function(te){return[this.$div(te),this["$%"](te)]}),H(P,"$fdiv",function(te){return G(this.$to_f(),te)}),H(P,"$floor",function(te){return null==te&&(te=0),this.$to_f().$floor(te)},-1),H(P,"$i",function(){return d.$Complex(0,this)}),H(P,"$imag",D(0)),H(P,"$integer?",D(!1)),H(P,"$nonzero?",function(){return me(this["$zero?"]())?L:this}),H(P,"$numerator",function(){return this.$to_r().$numerator()}),H(P,"$polar",function(){return[this.$abs(),this.$arg()]}),H(P,"$quo",function(te){return G(W["$coerce_to!"](this,S("Rational"),"to_r"),te)}),H(P,"$real",$),H(P,"$real?",D(!0)),H(P,"$rect",function(){return[this,0]}),H(P,"$round",function(te){return this.$to_f().$round(te)},-1),H(P,"$step",function R(te,k,de){var F,g,l,c,f,u,N=R.$$p||L,p=this,_=L;function y(){c===L&&d.$raise(S("TypeError"),"step must be numeric"),null!=c&&c["$=="](0)&&d.$raise(S("ArgumentError"),"step can't be 0"),(c===L||null==c)&&(c=1);var he=c["$<=>"](0);he===L&&d.$raise(S("ArgumentError"),"0 can't be coerced into "+c.$class()),(l===L||null==l)&&(l=he>0?S(S("Float"),"INFINITY"):S(S("Float"),"INFINITY")["$-@"]()),W.$compare(p,l)}function m(){if(c>0&&p>l||c<0&&p<l)return 0;if(c===1/0||c===-1/0)return 1;var he=Math.abs,Se=Math.floor,ve=(he(p)+he(l)+he(l-p))/he(c)*S(S("Float"),"EPSILON");return ve===1/0||ve===-1/0?0:(ve>.5&&(ve=.5),Se((l-p)/c+ve)+1)}function ne(){if(y(),0===c)return 1/0;if(c%1!=0)return m();if(c>0&&p>l||c<0&&p<l)return 0;var he=Math.ceil,Se=Math.abs;return he((Se(p-l)+1)/Se(c))}if(R.$$p=null,F=B(arguments),g=Z(F),g=T(g),F.length>0&&(l=F.shift()),F.length>0&&(c=F.shift()),f=g.$$smap.to,u=g.$$smap.by,void 0!==l&&void 0!==f&&d.$raise(S("ArgumentError"),"to is given twice"),void 0!==c&&void 0!==u&&d.$raise(S("ArgumentError"),"step is given twice"),void 0!==f&&(l=f),void 0!==u&&(c=u),void 0===l&&(l=L),N===L)return(j(l)||me(l["$is_a?"](S("Numeric"))))&&(j(c)||me(c["$is_a?"](S("Numeric"))))?S(S("Enumerator"),"ArithmeticSequence").$new([l,c,me(f)?"to: ":L,me(u)?"by: ":L],p):oe(p,"enum_for",["step",l,c],ne.$to_proc());y();var se=c["$negative?"](),Ee=c["$=="](0)||l===1/0&&!se||l===-1/0&&se;if(p.$$is_number&&c.$$is_number&&l.$$is_number){if(p%1!=0||!Ee&&l%1!=0||c%1!=0){var ce=p.$to_f().valueOf();c=c.$to_f().valueOf(),l=l.$to_f().valueOf();var Me=m();if(isFinite(c))if(0===c)for(;;)N(ce);else for(var $e=0;$e<Me;$e++){var be=$e*c+p;(c>=0?l<be:l>be)&&(be=l),N(be)}else 0!==Me&&N(ce);return p}var ke=p;if(Ee)for(;;ke+=c)N(ke);else if(se)for(;ke>=l;ke+=c)N(ke);else for(;ke<=l;ke+=c)N(ke);return p}for(_=p;me(se?z(_,l):q(_,l));)C.yield1(N,_),_=K(_,c)},-1),H(P,"$to_c",function(){return d.$Complex(this,0)}),H(P,"$to_int",function(){return this.$to_i()}),H(P,"$truncate",function(te){return null==te&&(te=0),this.$to_f().$truncate(te)},-1),H(P,"$zero?",function(){return this["$=="](0)}),H(P,"$positive?",function(){return I(this,0)}),H(P,"$negative?",function(){return E(this,0)}),H(P,"$dup",$),H(P,"$clone",function(te){return te=T(te),this},-1),H(P,"$finite?",D(!0)),H(P,"$infinite?",D(L)),A(P,"arg","angle"),A(P,"conjugate","conj"),A(P,"imaginary","imag"),A(P,"magnitude","abs"),A(P,"modulo","%"),A(P,"phase","arg"),A(P,"rectangular","rect")},Opal.modules["corelib/array"]=function(C){var le=C.truthy,me=C.falsy,d=C.hash_ids,H=C.yield1,ee=C.hash_get,$=C.hash_put,x=C.hash_delete,O=C.coerce_to,E=C.respond_to,Y=C.deny_frozen_access,G=C.freeze,D=C.klass,W=C.slice,B=C.defs,Z=C.Kernel,T=C.def,j=C.Opal,oe=C.eqeqeq,z=C.hash2,q=C.send2,K=C.find_super,I=C.send,A=C.rb_gt,J=C.rb_times,L=C.eqeq,S=C.rb_minus,M=C.to_a,v=C.to_ary,P=C.gvars,R=C.rb_ge,te=C.assign_ivar,k=C.rb_lt,de=C.return_self,N=C.neqeq,F=C.alias,g=C.top,c=C.nil,f=C.$$$;return g.$require("corelib/enumerable"),g.$require("corelib/numeric"),function(u,p,_){var y=D("::",Array,"Array"),m=[y].concat([]),ne=C.$r(m);function Ee(ve,ae){return ae.$$name===C.Array?ve:ae.$allocate().$replace(ve.$to_a())}function ke(ve,ae,ue){for(var Ce,b=null,V=new Array(ve.length),ge=0,xe=0,De=ve.length;ge<De;ge++){if(!b)try{Ce=H(ue,ve[ge])}catch(Re){b=Re}(b||ae(Ce))&&(V[xe]=ve[ge],xe+=1)}if(xe!==ge&&(ve.splice.apply(ve,[0,V.length].concat(V)),ve.splice(xe,V.length)),b)throw b}function ce(ve,ae){var Ce,b,V,ue=ve.length;return Ce=ae.excl,b=ae.begin===c?0:O(ae.begin,C.Integer,"to_int"),V=ae.end===c?-1:O(ae.end,C.Integer,"to_int"),b<0&&(b+=ue)<0||(ae.excl_rev&&ae.begin!==c&&(b+=1),b>ue)?c:V<0&&(V+=ue)<0?[]:((!Ce||ae.end===c)&&(V+=1),ve.slice(b,V))}function be(ve,ae){return ve===ae||0===ae?1:ae>0&&ve>ae?be(ve-1,ae-1)+be(ve-1,ae):0}y.$include(f("Enumerable")),C.prop(y.$$prototype,"$$is_array",!0),B(y,"$[]",function(ae){var b=this;return Ee(W(arguments),b)},-1),T(y,"$initialize",function ve(ae,ue){var V,ge,Ce=ve.$$p||c,b=this;if(ve.$$p=null,null==ae&&(ae=c),null==ue&&(ue=c),Y(b),ue!==c&&Ce!==c&&Z.$warn("warning: block supersedes default value argument"),ae>f(f("Integer"),"MAX")&&Z.$raise(f("ArgumentError"),"array size too big"),arguments.length>2&&Z.$raise(f("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..2)"),0===arguments.length)return b.splice(0,b.length),b;if(1===arguments.length){if(ae.$$is_array)return b.$replace(ae.$to_a()),b;if(ae["$respond_to?"]("to_ary"))return b.$replace(ae.$to_ary()),b}if((ae=O(ae,f("Integer"),"to_int"))<0&&Z.$raise(f("ArgumentError"),"negative array size"),b.splice(0,b.length),Ce===c)for(V=0;V<ae;V++)b.push(ue);else for(V=0;V<ae;V++)ge=Ce(V),b[V]=ge;return b},-1),B(y,"$try_convert",function(ae){return j["$coerce_to?"](ae,f("Array"),"to_ary")}),T(y,"$&",function(ae){ae=oe(f("Array"),ae)?ae.$to_a():O(ae,f("Array"),"to_ary").$to_a();var V,ge,xe,Ce=[],b=z([],{});for(V=0,ge=ae.length;V<ge;V++)$(b,ae[V],!0);for(V=0,ge=this.length;V<ge;V++)void 0!==x(b,xe=this[V])&&Ce.push(xe);return Ce}),T(y,"$|",function(ae){ae=oe(f("Array"),ae)?ae.$to_a():O(ae,f("Array"),"to_ary").$to_a();var b,V,Ce=z([],{});for(b=0,V=this.length;b<V;b++)$(Ce,this[b],!0);for(b=0,V=ae.length;b<V;b++)$(Ce,ae[b],!0);return Ce.$keys()}),T(y,"$*",function(ae){if(le(ae["$respond_to?"]("to_str")))return this.$join(ae.$to_str());ae=O(ae,f("Integer"),"to_int"),le(ae<0)&&Z.$raise(f("ArgumentError"),"negative argument");for(var Ce=[],b=this.$to_a(),V=0;V<ae;V++)Ce=Ce.concat(b);return Ce}),T(y,"$+",function(ae){return ae=oe(f("Array"),ae)?ae.$to_a():O(ae,f("Array"),"to_ary").$to_a(),this.concat(ae)}),T(y,"$-",function(ae){if(ae=oe(f("Array"),ae)?ae.$to_a():O(ae,f("Array"),"to_ary").$to_a(),le(0===this.length))return[];if(le(0===ae.length))return this.slice();var V,ge,xe,Ce=[],b=z([],{});for(V=0,ge=ae.length;V<ge;V++)$(b,ae[V],!0);for(V=0,ge=this.length;V<ge;V++)void 0===ee(b,xe=this[V])&&Ce.push(xe);return Ce}),T(y,"$<<",function(ae){return Y(this),this.push(ae),this}),T(y,"$<=>",function(ae){if(oe(f("Array"),ae))ae=ae.$to_a();else{if(!le(ae["$respond_to?"]("to_ary")))return c;ae=ae.$to_ary().$to_a()}if(this.$hash()===ae.$hash())return 0;for(var Ce=Math.min(this.length,ae.length),b=0;b<Ce;b++){var V=this[b]["$<=>"](ae[b]);if(0!==V)return V}return this.length["$<=>"](ae.length)}),T(y,"$==",function(ae){var Ce={};return function b(V,ge){var xe,De,Re,Ue;if(V===ge)return!0;if(!ge.$$is_array)return!!E(ge,"$to_ary")&&ge["$=="](V);if(V.$$constructor!==Array&&(V=V.$to_a()),ge.$$constructor!==Array&&(ge=ge.$to_a()),V.length!==ge.length)return!1;for(Ce[V.$object_id()]=!0,xe=0,De=V.length;xe<De;xe++)if(Ue=ge[xe],(Re=V[xe]).$$is_array){if(Ue.$$is_array&&Ue.length!==Re.length||!Ce.hasOwnProperty(Re.$object_id())&&!b(Re,Ue))return!1}else if(!Re["$=="](Ue))return!1;return!0}(this,ae)}),T(y,"$[]",function(ae,ue){return ae.$$is_range?ce(this,ae):ae.$$is_arithmetic_seq?function Me(ve,ae){var ue,Ce=[],b=0;for(ue=ae.step<0?ce(ve,{begin:ae.range.end,end:ae.range.begin,excl:!1,excl_rev:ae.range.excl}).$reverse():ce(ve,ae.range);b<ue.length;)Ce.push(ue[b]),b+=Math.abs(ae.step);return Ce}(this,ae):function $e(ve,ae,ue){var Ce=ve.length;return(ae=O(ae,C.Integer,"to_int"))<0&&(ae+=Ce)<0?c:void 0===ue?ae>=Ce||ae<0?c:ve[ae]:(ue=O(ue,C.Integer,"to_int"))<0||ae>Ce||ae<0?c:ve.slice(ae,ae+ue)}(this,ae,ue)},-2),T(y,"$[]=",function(ae,ue,Ce){var b=this,V=c,ge=c;Y(b),V=c;var xe,mt,De=b.length;if(ae.$$is_range){V=ue.$$is_array?ue.$to_a():ue["$respond_to?"]("to_ary")?ue.$to_ary().$to_a():[ue];var Re=ae.excl,Ue=ae.begin===c?0:O(ae.begin,C.Integer,"to_int"),Ze=ae.end===c?-1:O(ae.end,C.Integer,"to_int");if(Ue<0&&(Ue+=De)<0&&Z.$raise(f("RangeError"),ae.$inspect()+" out of range"),Ze<0&&(Ze+=De),(!Re||ae.end===c)&&(Ze+=1),Ue>De)for(xe=De;xe<Ue;xe++)b[xe]=c;return b.splice.apply(b,Ze<0?[Ue,0].concat(V):[Ue,Ze-Ue].concat(V)),ue}if(void 0===Ce?ge=1:(ge=ue,V=(ue=Ce).$$is_array?ue.$to_a():ue["$respond_to?"]("to_ary")?ue.$to_ary().$to_a():[ue]),ae=O(ae,f("Integer"),"to_int"),ge=O(ge,f("Integer"),"to_int"),ae<0&&(mt=ae,(ae+=De)<0&&Z.$raise(f("IndexError"),"index "+mt+" too small for array; minimum "+-b.length)),ge<0&&Z.$raise(f("IndexError"),"negative length ("+ge+")"),ae>De)for(xe=De;xe<ae;xe++)b[xe]=c;return void 0===Ce?b[ae]=ue:b.splice.apply(b,[ae,ge].concat(V)),ue},-3),T(y,"$any?",function ve(ae){var ue=ve.$$p||c;return ve.$$p=null,0!==this.length&&q(this,K(this,"any?",ve,!1,!0),"any?",[ae],ue)},-1),T(y,"$assoc",function(ae){for(var V,Ce=0,b=this.length;Ce<b;Ce++)if((V=this[Ce]).length&&V[0]["$=="](ae))return V;return c}),T(y,"$at",function(ae){return(ae=O(ae,f("Integer"),"to_int"))<0&&(ae+=this.length),ae<0||ae>=this.length?c:this[ae]}),T(y,"$bsearch_index",function ve(){var ae=ve.$$p||c;if(ve.$$p=null,ae===c)return this.$enum_for("bsearch_index");for(var V,xe,Ce=0,b=this.length,De=!1,Re=c;Ce<b;){if(V=Ce+Math.floor((b-Ce)/2),!0===(xe=H(ae,this[V])))Re=V,De=!0;else if(!1===xe||xe===c)De=!1;else if(xe.$$is_number){if(0===xe)return V;De=xe<0}else Z.$raise(f("TypeError"),"wrong argument type "+xe.$class()+" (must be numeric, true, false or nil)");De?b=V:Ce=V+1}return Re}),T(y,"$bsearch",function ve(){var ae=ve.$$p||c,Ce=c;return ve.$$p=null,ae===c?this.$enum_for("bsearch"):null!=(Ce=I(this,"bsearch_index",[],ae.$to_proc()))&&Ce.$$is_number?this[Ce]:Ce}),T(y,"$cycle",function ve(ae){var b,V,ue=ve.$$p||c,Ce=this;if(ve.$$p=null,null==ae&&(ae=c),ue===c)return I(Ce,"enum_for",["cycle",ae],function xe(){var De=null==xe.$$s?this:xe.$$s;return le(ae["$nil?"]())?f(f("Float"),"INFINITY"):(ae=j["$coerce_to!"](ae,f("Integer"),"to_int"),le(A(ae,0))?J(De.$enumerator_size(),ae):0)},{$$s:Ce});if(le(Ce["$empty?"]())||L(ae,0))return c;if(ae===c)for(;;)for(b=0,V=Ce.length;b<V;b++)H(ue,Ce[b]);else{if((ae=j["$coerce_to!"](ae,f("Integer"),"to_int"))<=0)return Ce;for(;ae>0;){for(b=0,V=Ce.length;b<V;b++)H(ue,Ce[b]);ae--}}return Ce},-1),T(y,"$clear",function(){return Y(this),this.splice(0,this.length),this}),T(y,"$count",function ve(ae){var ue=ve.$$p||c;return ve.$$p=null,le(void 0!==ae)||le(ue)?q(this,K(this,"count",ve,!1,!0),"count",[ae],ue):this.$size()},-1),T(y,"$initialize_copy",function(ae){return this.$replace(ae)}),T(y,"$collect",function ve(){var ae=ve.$$p||c;if(ve.$$p=null,ae===c)return I(this,"enum_for",["collect"],function xe(){return(null==xe.$$s?this:xe.$$s).$size()},{$$s:this});for(var Ce=[],b=0,V=this.length;b<V;b++){var ge=H(ae,this[b]);Ce.push(ge)}return Ce}),T(y,"$collect!",function ve(){var ae=ve.$$p||c,ue=this;if(ve.$$p=null,ae===c)return I(ue,"enum_for",["collect!"],function ge(){return(null==ge.$$s?this:ge.$$s).$size()},{$$s:ue});Y(ue);for(var Ce=0,b=ue.length;Ce<b;Ce++){var V=H(ae,ue[Ce]);ue[Ce]=V}return ue}),T(y,"$combination",function ve(ae){var b,V,ge,xe,De,Re,Ue,Ze,ue=ve.$$p||c,Ce=this;if(ve.$$p=null,b=j["$coerce_to!"](ae,f("Integer"),"to_int"),ue===c)return I(Ce,"enum_for",["combination",b],function mt(){return be((null==mt.$$s?this:mt.$$s).length,b)},{$$s:Ce});if(0===b)C.yield1(ue,[]);else if(1===b)for(V=0,ge=Ce.length;V<ge;V++)C.yield1(ue,[Ce[V]]);else if(b===Ce.length)C.yield1(ue,Ce.slice());else if(b>=0&&b<Ce.length){for(xe=[],V=0;V<=b+1;V++)xe.push(0);for(De=[],Re=0,Ue=!1,xe[0]=-1;!Ue;){for(De[Re]=Ce[xe[Re+1]];Re<b-1;)Ze=xe[1+ ++Re]=xe[Re]+1,De[Re]=Ce[Ze];C.yield1(ue,De.slice()),Re++;do{Ue=0===Re,xe[Re]++,Re--}while(xe[Re+1]+b===Ce.length+Re+1)}}return Ce}),T(y,"$repeated_combination",function ve(ae){var b,ue=ve.$$p||c;return ve.$$p=null,b=j["$coerce_to!"](ae,f("Integer"),"to_int"),ue===c?I(this,"enum_for",["repeated_combination",b],function ge(){return be((null==ge.$$s?this:ge.$$s).length+b-1,b)},{$$s:this}):(b>=0&&function V(ge,xe,De,Re){if(De.length!=ge)for(var Ze=xe;Ze<Re.length;Ze++)De.push(Re[Ze]),V(ge,Ze,De,Re),De.pop();else{var Ue=De.slice();C.yield1(ue,Ue)}}(b,0,[],this),this)}),T(y,"$compact",function(){for(var V,ue=[],Ce=0,b=this.length;Ce<b;Ce++)(V=this[Ce])!==c&&ue.push(V);return ue}),T(y,"$compact!",function(){var ae=this;Y(ae);for(var ue=ae.length,Ce=0,b=ae.length;Ce<b;Ce++)ae[Ce]===c&&(ae.splice(Ce,1),b--,Ce--);return ae.length===ue?c:ae}),T(y,"$concat",function(ae){var Ce,b=this;return Ce=W(arguments),Y(b),Ce=I(Ce,"map",[],function V(ge){var xe=null==V.$$s?this:V.$$s;return null==ge&&(ge=c),ge=oe(f("Array"),ge)?ge.$to_a():O(ge,f("Array"),"to_ary").$to_a(),le(ge["$equal?"](xe))&&(ge=ge.$dup()),ge},{$$s:b}),I(Ce,"each",[],function V(ge){var xe=null==V.$$s?this:V.$$s;null==ge&&(ge=c);for(var De=0,Re=ge.length;De<Re;De++)xe.push(ge[De])},{$$s:b}),b},-1),T(y,"$delete",function ve(ae){var ue=ve.$$p||c,Ce=this;ve.$$p=null;for(var b=Ce.length,V=0,ge=b;V<ge;V++)Ce[V]["$=="](ae)&&(Y(Ce),Ce.splice(V,1),ge--,V--);return Ce.length===b?ue!==c?C.yieldX(ue,[]):c:ae}),T(y,"$delete_at",function(ae){var ue=this;if(Y(ue),(ae=O(ae,f("Integer"),"to_int"))<0&&(ae+=ue.length),ae<0||ae>=ue.length)return c;var Ce=ue[ae];return ue.splice(ae,1),Ce}),T(y,"$delete_if",function ve(){var ae=ve.$$p||c,ue=this;return ve.$$p=null,ae===c?I(ue,"enum_for",["delete_if"],function Ce(){return(null==Ce.$$s?this:Ce.$$s).$size()},{$$s:ue}):(Y(ue),ke(ue,me,ae),ue)}),T(y,"$difference",function(ae){var ue,b=this;return ue=W(arguments),I(ue,"reduce",[b.$to_a().$dup()],function(ge,xe){return null==ge&&(ge=c),null==xe&&(xe=c),S(ge,xe)})},-1),T(y,"$dig",function(ae,ue){var b,V=this,ge=c;return b=W(arguments,1),(ge=V["$[]"](ae))===c||0===b.length?ge:(le(ge["$respond_to?"]("dig"))||Z.$raise(f("TypeError"),ge.$class()+" does not have #dig method"),I(ge,"dig",M(b)))},-2),T(y,"$drop",function(ae){return(ae=O(ae,f("Integer"),"to_int"))<0&&Z.$raise(f("ArgumentError")),this.slice(ae)}),T(y,"$dup",function ve(){var ae=ve.$$p||c,ue=this;return ve.$$p=null,ue.$$class===C.Array&&ue.$$class.$allocate.$$pristine&&ue.$copy_instance_variables.$$pristine&&ue.$initialize_dup.$$pristine?ue.slice(0):q(ue,K(ue,"dup",ve,!1,!0),"dup",[],ae)}),T(y,"$each",function ve(){var ae=ve.$$p||c,ue=this;if(ve.$$p=null,ae===c)return I(ue,"enum_for",["each"],function ge(){return(null==ge.$$s?this:ge.$$s).$size()},{$$s:ue});for(var Ce=0,b=ue.length;Ce<b;Ce++)H(ae,ue[Ce]);return ue}),T(y,"$each_index",function ve(){var ae=ve.$$p||c;if(ve.$$p=null,ae===c)return I(this,"enum_for",["each_index"],function ge(){return(null==ge.$$s?this:ge.$$s).$size()},{$$s:this});for(var Ce=0,b=this.length;Ce<b;Ce++)H(ae,Ce);return this}),T(y,"$empty?",function(){return 0===this.length}),T(y,"$eql?",function(ae){var Ce={};return function b(V,ge){var xe,De,Re,Ue;if(!ge.$$is_array||(ge=ge.$to_a(),V.length!==ge.length))return!1;for(Ce[V.$object_id()]=!0,xe=0,De=V.length;xe<De;xe++)if(Ue=ge[xe],(Re=V[xe]).$$is_array){if(Ue.$$is_array&&Ue.length!==Re.length||!Ce.hasOwnProperty(Re.$object_id())&&!b(Re,Ue))return!1}else if(!Re["$eql?"](Ue))return!1;return!0}(this,ae)}),T(y,"$fetch",function ve(ae,ue){var Ce=ve.$$p||c,b=this;ve.$$p=null;var V=ae;return(ae=O(ae,f("Integer"),"to_int"))<0&&(ae+=b.length),ae>=0&&ae<b.length?b[ae]:(Ce!==c&&null!=ue&&b.$warn("warning: block supersedes default value argument"),Ce!==c?Ce(V):null!=ue?ue:void Z.$raise(f("IndexError"),0===b.length?"index "+V+" outside of array bounds: 0...0":"index "+V+" outside of array bounds: -"+b.length+"..."+b.length))},-2),T(y,"$fill",function ve(ae){var b,V,bt,jt,ue=ve.$$p||c,xe=this,De=c,Re=c,Ue=c,Ze=c,mt=c;if(ve.$$p=null,b=W(arguments),Y(xe),le(ue)?(le(b.length>2)&&Z.$raise(f("ArgumentError"),"wrong number of arguments ("+b.$length()+" for 0..2)"),De=null==(V=v(b))[0]?c:V[0],Re=null==V[1]?c:V[1]):(le(0==b.length)?Z.$raise(f("ArgumentError"),"wrong number of arguments (0 for 1..3)"):le(b.length>3)&&Z.$raise(f("ArgumentError"),"wrong number of arguments ("+b.$length()+" for 1..3)"),Ue=null==(V=v(b))[0]?c:V[0],De=null==V[1]?c:V[1],Re=null==V[2]?c:V[2]),oe(f("Range"),De)){if(le(Re)&&Z.$raise(f("TypeError"),"length invalid with range"),Ze=De.begin===c?0:O(De.begin,f("Integer"),"to_int"),le(Ze<0)&&(Ze+=this.length),le(Ze<0)&&Z.$raise(f("RangeError"),De.$inspect()+" out of range"),mt=De.end===c?-1:O(De.end,f("Integer"),"to_int"),le(mt<0)&&(mt+=this.length),le(De["$exclude_end?"]())||(mt+=1),le(mt<=Ze))return xe}else if(le(De))if(Ze=O(De,f("Integer"),"to_int"),le(Ze<0)&&(Ze+=this.length),le(Ze<0)&&(Ze=0),le(Re)){if(mt=O(Re,f("Integer"),"to_int"),le(0==mt))return xe;mt+=Ze}else mt=this.length;else Ze=0,mt=this.length;if(le(Ze>this.length))for(bt=this.length;bt<mt;bt++)xe[bt]=c;if(le(mt>this.length)&&(this.length=mt),le(ue))for(;Ze<mt;Ze++)jt=ue(Ze),xe[Ze]=jt;else for(;Ze<mt;Ze++)xe[Ze]=Ue;return xe},-1),T(y,"$first",function(ae){return null==ae?0===this.length?c:this[0]:((ae=O(ae,f("Integer"),"to_int"))<0&&Z.$raise(f("ArgumentError"),"negative array size"),this.slice(0,ae))},-1),T(y,"$flatten",function(ae){var ue=this;return void 0!==ae&&(ae=O(ae,f("Integer"),"to_int")),function Ce(b,V){var xe,De,Re,Ue,ge=[];for(xe=0,De=(b=b.$to_a()).length;xe<De;xe++)if(E(Re=b[xe],"$to_ary",!0))if((Ue=Re.$to_ary())!==c)switch(Ue.$$is_array||Z.$raise(f("TypeError")),Ue===ue&&Z.$raise(f("ArgumentError")),V){case void 0:ge=ge.concat(Ce(Ue));break;case 0:ge.push(Ue);break;default:ge.push.apply(ge,Ce(Ue,V-1))}else ge.push(Re);else ge.push(Re);return ge}(ue,ae)},-1),T(y,"$flatten!",function(ae){var ue=this;Y(ue);var Ce=ue.$flatten(ae);if(ue.length==Ce.length){for(var b=0,V=ue.length;b<V&&ue[b]===Ce[b];b++);if(b==V)return c}return ue.$replace(Ce),ue},-1),T(y,"$freeze",function(){return le(this["$frozen?"]())?this:G(this)}),T(y,"$hash",function(){var ge,xe,ae=this,ue=void 0===d,Ce=["A"],b=ae.$object_id();try{if(ue&&(d=Object.create(null)),d[b])return"self";for(xe in d)if(ae["$eql?"](d[xe]))return"self";for(d[b]=ae,ge=0;ge<ae.length;ge++)Ce.push(ae[ge].$hash());return Ce.join(",")}finally{ue&&(d=void 0)}}),T(y,"$include?",function(ae){for(var Ce=0,b=this.length;Ce<b;Ce++)if(this[Ce]["$=="](ae))return!0;return!1}),T(y,"$index",function ve(ae){var b,V,ge,ue=ve.$$p||c,Ce=this;if(ve.$$p=null,null!=ae&&ue!==c&&Ce.$warn("warning: given block not used"),null!=ae){for(b=0,V=Ce.length;b<V;b++)if(Ce[b]["$=="](ae))return b}else{if(ue===c)return Ce.$enum_for("index");for(b=0,V=Ce.length;b<V;b++)if(!1!==(ge=ue(Ce[b]))&&ge!==c)return b}return c},-1),T(y,"$insert",function(ae,ue){var b,V=this;if(b=W(arguments,1),Y(V),ae=O(ae,f("Integer"),"to_int"),b.length>0){if(ae<0&&(ae+=V.length+1)<0&&Z.$raise(f("IndexError"),ae+" is out of bounds"),ae>V.length)for(var ge=V.length;ge<ae;ge++)V.push(c);V.splice.apply(V,[ae,0].concat(b))}return V},-2);var ue,he=[];return T(y,"$inspect",function(){var ae=this,ue=[],Ce=ae.$__id__(),b=!0;return function(){try{if(-1!==he.indexOf(Ce))return b=!1,"[...]";he.push(Ce);for(var V=0,ge=ae.length;V<ge;V++){var xe=ae["$[]"](V);ue.push(ne("Opal").$inspect(xe))}return"["+ue.join(", ")+"]"}finally{b&&he.pop()}}()}),T(y,"$intersection",function(ae){var ue,b=this;return ue=W(arguments),I(ue,"reduce",[b.$to_a().$dup()],function(ge,xe){return null==ge&&(ge=c),null==xe&&(xe=c),ge["$&"](xe)})},-1),T(y,"$intersect?",function(ae){return this.$intersection(ae)["$empty?"]()["$!"]()}),T(y,"$join",function(ae){var ue=this;if(null==P[","]&&(P[","]=c),null==ae&&(ae=c),le(0===ue.length))return"";le(ae===c)&&(ae=P[","]);var b,V,ge,xe,Ce=[];for(b=0,V=ue.length;b<V;b++)E(ge=ue[b],"$to_str")&&(xe=ge.$to_str())!==c?Ce.push(xe.$to_s()):E(ge,"$to_ary")&&((xe=ge.$to_ary())===ue&&Z.$raise(f("ArgumentError")),xe!==c)?Ce.push(xe.$join(ae)):E(ge,"$to_s")&&(xe=ge.$to_s())!==c?Ce.push(xe):Z.$raise(f("NoMethodError").$new(ne("Opal").$inspect(ue.$item())+" doesn't respond to #to_str, #to_ary or #to_s","to_str"));return Ce.join(ae===c?"":j["$coerce_to!"](ae,f("String"),"to_str").$to_s())},-1),T(y,"$keep_if",function ve(){var ae=ve.$$p||c,ue=this;return ve.$$p=null,ae===c?I(ue,"enum_for",["keep_if"],function Ce(){return(null==Ce.$$s?this:Ce.$$s).$size()},{$$s:ue}):(Y(ue),ke(ue,le,ae),ue)}),T(y,"$last",function(ae){var ue=this;return null==ae?0===ue.length?c:ue[ue.length-1]:((ae=O(ae,f("Integer"),"to_int"))<0&&Z.$raise(f("ArgumentError"),"negative array size"),ae>ue.length&&(ae=ue.length),ue.slice(ue.length-ae,ue.length))},-1),T(y,"$length",function(){return this.length}),T(y,"$max",function ve(ae){var ue=ve.$$p||c;return ve.$$p=null,I(this.$each(),"max",[ae],ue.$to_proc())},-1),T(y,"$min",function ve(){var ae=ve.$$p||c;return ve.$$p=null,I(this.$each(),"min",[],ae.$to_proc())}),T(y,"$permutation",function ve(ae){var ge,xe,De,ue=ve.$$p||c,Ce=this,b=c,V=c;if(ve.$$p=null,ue===c)return I(Ce,"enum_for",["permutation",ae],function Ue(){var Ze=null==Ue.$$s?this:Ue.$$s;return function Se(ve,ae){for(var ue=ae>=0?1:0;ae;)ue*=ve,ve--,ae--;return ue}(Ze.length,void 0===ae?Ze.length:ae)},{$$s:Ce});if(!((ae=void 0===ae?Ce.length:O(ae,f("Integer"),"to_int"))<0||Ce.length<ae))if(0===ae)C.yield1(ue,[]);else if(1===ae)for(var Re=0;Re<Ce.length;Re++)C.yield1(ue,[Ce[Re]]);else b=ne("Array").$new(ae),V=ne("Array").$new(Ce.length,!1),ge=function(Ue,Ze,mt,bt,Wt){Ce=this;for(var jt=0;jt<Ce.length;jt++)if(bt["$[]"](jt)["$!"]())if(Ze[mt]=jt,mt<Ue-1)bt[jt]=!0,ge.call(Ce,Ue,Ze,mt+1,bt,Wt),bt[jt]=!1;else{De=[];for(var En=0;En<Ze.length;En++)De.push(Ce[Ze[En]]);H(Wt,De)}},ue!==c?(xe=Ce.slice(),ge.call(xe,ae,b,0,V,ue)):ge.call(Ce,ae,b,0,V,ue);return Ce},-1),T(y,"$repeated_permutation",function ve(ae){var b,ue=ve.$$p||c;return ve.$$p=null,b=j["$coerce_to!"](ae,f("Integer"),"to_int"),ue===c?I(this,"enum_for",["repeated_permutation",b],function ge(){var xe=null==ge.$$s?this:ge.$$s;return le(R(b,0))?xe.$size()["$**"](b):0},{$$s:this}):(function V(ge,xe,De){if(xe.length!=ge)for(var Ue=0;Ue<De.length;Ue++)xe.push(De[Ue]),V(ge,xe,De),xe.pop();else{var Re=xe.slice();C.yield1(ue,Re)}}(b,[],this.slice()),this)}),T(y,"$pop",function(ae){var ue=this;return Y(ue),le(void 0===ae)?le(0===ue.length)?c:ue.pop():(ae=O(ae,f("Integer"),"to_int"),le(ae<0)&&Z.$raise(f("ArgumentError"),"negative array size"),le(0===ue.length)?[]:le(1===ae)?[ue.pop()]:le(ae>ue.length)?ue.splice(0,ue.length):ue.splice(ue.length-ae,ue.length))},-1),T(y,"$product",function ve(ae){var Ce,b,ue=ve.$$p||c,V=this;ve.$$p=null,Ce=W(arguments);var Ze,mt,bt,Wt,ge=ue!==c?null:[],xe=(b=Ce).length+1,De=new Array(xe),Re=new Array(xe),Ue=new Array(xe),jt=1;for(Ue[0]=V,Ze=1;Ze<xe;Ze++)Ue[Ze]=O(b[Ze-1],f("Array"),"to_ary");for(Ze=0;Ze<xe;Ze++){if(0===(Wt=Ue[Ze].length))return ge||V;(jt*=Wt)>2147483647&&Z.$raise(f("RangeError"),"too big to product"),Re[Ze]=Wt,De[Ze]=0}e:for(;;){for(bt=[],Ze=0;Ze<xe;Ze++)bt.push(Ue[Ze][De[Ze]]);for(ge?ge.push(bt):C.yield1(ue,bt),De[mt=xe-1]++;De[mt]===Re[mt];){if(De[mt]=0,--mt<0)break e;De[mt]++}}return ge||V},-1),T(y,"$push",function(ae){var Ce,b=this;Ce=W(arguments),Y(b);for(var V=0,ge=Ce.length;V<ge;V++)b.push(Ce[V]);return b},-1),T(y,"$rassoc",function(ae){for(var V,Ce=0,b=this.length;Ce<b;Ce++)if((V=this[Ce]).length&&void 0!==V[1]&&V[1]["$=="](ae))return V;return c}),T(y,"$reject",function ve(){var ae=ve.$$p||c,ue=this;if(ve.$$p=null,ae===c)return I(ue,"enum_for",["reject"],function xe(){return(null==xe.$$s?this:xe.$$s).$size()},{$$s:ue});for(var ge,Ce=[],b=0,V=ue.length;b<V;b++)(!1===(ge=ae(ue[b]))||ge===c)&&Ce.push(ue[b]);return Ce}),T(y,"$reject!",function ve(){var ae=ve.$$p||c,ue=this,Ce=c;return ve.$$p=null,ae===c?I(ue,"enum_for",["reject!"],function b(){return(null==b.$$s?this:b.$$s).$size()},{$$s:ue}):(Y(ue),Ce=ue.$length(),I(ue,"delete_if",[],ae.$to_proc()),L(ue.$length(),Ce)?c:ue)}),T(y,"$replace",function(ae){var ue=this;return Y(ue),ae=oe(f("Array"),ae)?ae.$to_a():O(ae,f("Array"),"to_ary").$to_a(),ue.splice(0,ue.length),ue.push.apply(ue,ae),ue}),T(y,"$reverse",function(){return this.slice(0).reverse()}),T(y,"$reverse!",function(){return Y(this),this.reverse()}),T(y,"$reverse_each",function ve(){var ae=ve.$$p||c;return ve.$$p=null,ae===c?I(this,"enum_for",["reverse_each"],function Ce(){return(null==Ce.$$s?this:Ce.$$s).$size()},{$$s:this}):(I(this.$reverse(),"each",[],ae.$to_proc()),this)}),T(y,"$rindex",function ve(ae){var b,V,ue=ve.$$p||c,Ce=this;if(ve.$$p=null,null!=ae&&ue!==c&&Ce.$warn("warning: given block not used"),null!=ae){for(b=Ce.length-1;b>=0&&!(b>=Ce.length);b--)if(Ce[b]["$=="](ae))return b}else if(ue!==c){for(b=Ce.length-1;b>=0&&!(b>=Ce.length);b--)if(!1!==(V=ue(Ce[b]))&&V!==c)return b}else if(null==ae)return Ce.$enum_for("rindex");return c},-1),T(y,"$rotate",function(ae){var Ce,b,V,ge;return null==ae&&(ae=1),ae=O(ae,f("Integer"),"to_int"),1===this.length?this.slice():0===this.length?[]:(V=(Ce=this.slice()).slice(b=ae%Ce.length),ge=Ce.slice(0,b),V.concat(ge))},-1),T(y,"$rotate!",function(ae){var ue=this,Ce=c;return null==ae&&(ae=1),Y(ue),0===ue.length||1===ue.length?ue:(ae=O(ae,f("Integer"),"to_int"),Ce=ue.$rotate(ae),ue.$replace(Ce))},-1),(ue=D(y,null,"SampleRandom")).$$prototype.rng=c,T(ue,"$initialize",te("rng")),T(ue,"$rand",function(V){var xe;return xe=O(this.rng.$rand(V),f("Integer"),"to_int"),le(xe<0)&&Z.$raise(f("RangeError"),"random value must be >= 0"),le(xe<V)||Z.$raise(f("RangeError"),"random value must be less than Array size"),xe}),T(y,"$sample",function(ae,ue){var ge,xe,De,Re,Ue,Ze,mt,bt,Ce=this,b=c,V=c;if(le(void 0===ae))return Ce.$at(Z.$rand(Ce.length));if(le(void 0===ue)?le(b=j["$coerce_to?"](ae,f("Hash"),"to_hash"))?(ue=b,ae=c):(ue=c,ae=O(ae,f("Integer"),"to_int")):(ae=O(ae,f("Integer"),"to_int"),ue=O(ue,f("Hash"),"to_hash")),le(ae)&&le(ae<0)&&Z.$raise(f("ArgumentError"),"count must be greater than 0"),le(ue)&&(V=ue["$[]"]("random")),V=le(V)&&le(V["$respond_to?"]("rand"))?ne("SampleRandom").$new(V):Z,!le(ae))return Ce[V.$rand(Ce.length)];switch(ae>Ce.length&&(ae=Ce.length),ae){case 0:return[];case 1:return[Ce[V.$rand(Ce.length)]];case 2:return(Re=V.$rand(Ce.length))===(Ue=V.$rand(Ce.length))&&(Ue=0===Re?Re+1:Re-1),[Ce[Re],Ce[Ue]];default:if(Ce.length/ae>3){for(ge=!1,xe=0,Re=1,(De=ne("Array").$new(ae))[0]=V.$rand(Ce.length);Re<ae;){for(Ze=V.$rand(Ce.length),Ue=0;Ue<Re;){for(;Ze===De[Ue];){if(++xe>100){ge=!0;break}Ze=V.$rand(Ce.length)}if(ge)break;Ue++}if(ge)break;De[Re]=Ze,Re++}if(!ge){for(Re=0;Re<ae;)De[Re]=Ce[De[Re]],Re++;return De}}De=Ce.slice();for(var Wt=0;Wt<ae;Wt++)mt=V.$rand(Ce.length),bt=De[Wt],De[Wt]=De[mt],De[mt]=bt;return ae===Ce.length?De:De["$[]"](0,ae)}},-1),T(y,"$select",function ve(){var ae=ve.$$p||c;if(ve.$$p=null,ae===c)return I(this,"enum_for",["select"],function De(){return(null==De.$$s?this:De.$$s).$size()},{$$s:this});for(var ge,xe,Ce=[],b=0,V=this.length;b<V;b++)xe=H(ae,ge=this[b]),le(xe)&&Ce.push(ge);return Ce}),T(y,"$select!",function ve(){var ae=ve.$$p||c,ue=this;if(ve.$$p=null,ae===c)return I(ue,"enum_for",["select!"],function b(){return(null==b.$$s?this:b.$$s).$size()},{$$s:ue});Y(ue);var Ce=ue.length;return I(ue,"keep_if",[],ae.$to_proc()),ue.length===Ce?c:ue}),T(y,"$shift",function(ae){var ue=this;return Y(ue),le(void 0===ae)?le(0===ue.length)?c:function se(ve){for(var ae=ve[0],ue=1,Ce=ve.length;ue<Ce;ue++)ve[ue-1]=ve[ue];return ve.pop(),ae}(ue):(ae=O(ae,f("Integer"),"to_int"),le(ae<0)&&Z.$raise(f("ArgumentError"),"negative array size"),le(0===ue.length)?[]:ue.splice(0,ae))},-1),T(y,"$shuffle",function(ae){return this.$dup().$to_a()["$shuffle!"](ae)},-1),T(y,"$shuffle!",function(ae){var ue=this;Y(ue);var Ce,V,ge,b=ue.length;for(void 0!==ae&&(ae=j["$coerce_to?"](ae,f("Hash"),"to_hash"))!==c&&(ae=ae["$[]"]("random"))!==c&&ae["$respond_to?"]("rand")&&(Ce=ae);b;)Ce?((V=Ce.$rand(b).$to_int())<0&&Z.$raise(f("RangeError"),"random number too small "+V),V>=b&&Z.$raise(f("RangeError"),"random number too big "+V)):V=ue.$rand(b),ge=ue[--b],ue[b]=ue[V],ue[V]=ge;return ue},-1),T(y,"$slice!",function(ae,ue){var Ce=this,b=c,V=c,ge=c,xe=c,De=c;if(Y(Ce),b=c,le(void 0===ue))if(oe(f("Range"),ae)){b=Ce["$[]"](V=ae),ge=V.begin===c?0:O(V.begin,f("Integer"),"to_int"),xe=V.end===c?-1:O(V.end,f("Integer"),"to_int"),ge<0&&(ge+=Ce.length),xe<0?xe+=Ce.length:xe>=Ce.length&&(xe=Ce.length-1,V.excl&&(xe+=1));var Re=xe-ge;V.excl&&V.end!==c?xe-=1:Re+=1,ge<Ce.length&&ge>=0&&xe<Ce.length&&xe>=0&&Re>0&&Ce.splice(ge,Re)}else{if((De=O(ae,f("Integer"),"to_int"))<0&&(De+=Ce.length),De<0||De>=Ce.length)return c;b=Ce[De],0===De?Ce.shift():Ce.splice(De,1)}else{if(De=O(ae,f("Integer"),"to_int"),(ue=O(ue,f("Integer"),"to_int"))<0)return c;b=Ce["$[]"](De,ue),De<0&&(De+=Ce.length),De+ue>Ce.length&&(ue=Ce.length-De),De<Ce.length&&De>=0&&Ce.splice(De,ue)}return b},-2),T(y,"$sort",function ve(){var ae=ve.$$p||c;return ve.$$p=null,le(this.length>1)?(ae===c&&(ae=function(Ce,b){return Ce["$<=>"](b)}),this.slice().sort(function(Ce,b){var V=ae(Ce,b);return V===c&&Z.$raise(f("ArgumentError"),"comparison of "+Ce.$inspect()+" with "+b.$inspect()+" failed"),A(V,0)?1:k(V,0)?-1:0})):this}),T(y,"$sort!",function ve(){var Ce,ae=ve.$$p||c,ue=this;ve.$$p=null,Y(ue),Ce=ae!==c?I(ue.slice(),"sort",[],ae.$to_proc()):ue.slice().$sort(),ue.length=0;for(var b=0,V=Ce.length;b<V;b++)ue.push(Ce[b]);return ue}),T(y,"$sort_by!",function ve(){var ae=ve.$$p||c,ue=this;return ve.$$p=null,ae===c?I(ue,"enum_for",["sort_by!"],function Ce(){return(null==Ce.$$s?this:Ce.$$s).$size()},{$$s:ue}):(Y(ue),ue.$replace(I(ue,"sort_by",[],ae.$to_proc())))}),T(y,"$take",function(ae){return ae<0&&Z.$raise(f("ArgumentError")),this.slice(0,ae)}),T(y,"$take_while",function ve(){var ae=ve.$$p||c;ve.$$p=null;for(var ge,xe,Ce=[],b=0,V=this.length;b<V;b++){if(!1===(xe=ae(ge=this[b]))||xe===c)return Ce;Ce.push(ge)}return Ce}),T(y,"$to_a",function(){return this.$$class===C.Array?this:C.Array.$new(this)}),T(y,"$to_ary",de),T(y,"$to_h",function ve(){var ae=ve.$$p||c,Ce=c;ve.$$p=null,Ce=this,ae!==c&&(Ce=I(Ce,"map",[],ae.$to_proc()));var b,ge,V=Ce.length,Re=z([],{});for(b=0;b<V;b++)(ge=j["$coerce_to?"](Ce[b],f("Array"),"to_ary")).$$is_array||Z.$raise(f("TypeError"),"wrong element type "+ge.$class()+" at "+b+" (expected array)"),2!==ge.length&&Z.$raise(f("ArgumentError"),"wrong array length at "+b+" (expected 2, was "+ge.$length()+")"),$(Re,ge[0],ge[1]);return Re}),T(y,"$transpose",function(){var ue=c,Ce=c;return le(this["$empty?"]())?[]:(ue=[],Ce=c,I(this,"each",[],function(V){var ge=c;return null==V&&(V=c),V=oe(f("Array"),V)?V.$to_a():O(V,f("Array"),"to_ary").$to_a(),Ce=le(ge=Ce)?ge:V.length,N(V.length,Ce)&&Z.$raise(f("IndexError"),"element size differs ("+V.length+" should be "+Ce+")"),I(V.length,"times",[],function(De){var Re;return null==De&&(De=c),(le(ge=ue["$[]"](De))?ge:(I(ue,"[]=",Re=[De,[]]),Re[Re.length-1]))["$<<"](V.$at(De))})}),ue)}),T(y,"$union",function(ae){var ue,b=this;return ue=W(arguments),I(ue,"reduce",[b.$uniq()],function(ge,xe){return null==ge&&(ge=c),null==xe&&(xe=c),ge["$|"](xe)})},-1),T(y,"$uniq",function ve(){var ae=ve.$$p||c;ve.$$p=null;var b,V,ge,xe,Ce=z([],{});if(ae===c)for(b=0,V=this.length;b<V;b++)void 0===ee(Ce,ge=this[b])&&$(Ce,ge,ge);else for(b=0,V=this.length;b<V;b++)xe=H(ae,ge=this[b]),void 0===ee(Ce,xe)&&$(Ce,xe,ge);return Ce.$values()}),T(y,"$uniq!",function ve(){var ae=ve.$$p||c,ue=this;ve.$$p=null,Y(ue);var V,ge,xe,De,Ce=ue.length,b=z([],{});for(V=0,ge=Ce;V<ge;V++)xe=ue[V],De=ae===c?xe:H(ae,xe),void 0!==ee(b,De)?(ue.splice(V,1),ge--,V--):$(b,De,xe);return ue.length===Ce?c:ue}),T(y,"$unshift",function(ae){var Ce,b=this;Ce=W(arguments),Y(b);var V=b.length,ge=Ce.length;if(0==ge)return b;for(var xe=V-ge,De=0;De<ge;De++)b.push(b[xe+De]);for(var Re=V-1;Re-ge>=0;)b[Re]=b[Re-ge],Re--;for(var Ue=0;Ue<ge;Ue++)b[Ue]=Ce[Ue];return b},-1),T(y,"$values_at",function(ae){var ue,b=this,V=c;return ue=W(arguments),V=[],I(ue,"each",[],function ge(xe){var De=null==ge.$$s?this:ge.$$s,Re=c,Ue=c,Ze=c;return null==xe&&(xe=c),le(xe["$is_a?"](f("Range")))?(Re=xe.$end()===c?-1:O(xe.$end(),f("Integer"),"to_int"),(Ue=xe.$begin()===c?0:O(xe.$begin(),f("Integer"),"to_int"))<0?(Ue+=De.length,c):(Re<0&&(Re+=De.length),xe["$exclude_end?"]()&&xe.$end()!==c&&Re--,Re<Ue?c:I(Ue,"upto",[Re],function mt(bt){return null==bt&&(bt=c),V["$<<"]((null==mt.$$s?this:mt.$$s).$at(bt))},{$$s:De}))):(Ze=O(xe,f("Integer"),"to_int"),V["$<<"](De.$at(Ze)))},{$$s:b}),V},-1),T(y,"$zip",function ve(ae){var Ce,b,ue=ve.$$p||c,V=this,ge=c;ve.$$p=null,Ce=W(arguments);var Re,Ue,Ze,mt,bt,xe=[],De=V.length;for(mt=0,bt=(b=Ce).length;mt<bt;mt++)if(!(Ue=b[mt]).$$is_array){if(Ue.$$is_range||Ue.$$is_enumerator){b[mt]=Ue.$take(De);continue}b[mt]=(le(ge=j["$coerce_to?"](Ue,f("Array"),"to_ary"))?ge:j["$coerce_to!"](Ue,f("Enumerator"),"to_enum","each")).$to_a()}for(Ze=0;Ze<De;Ze++){for(Re=[V[Ze]],mt=0,bt=b.length;mt<bt;mt++)null==(Ue=b[mt][Ze])&&(Ue=c),Re[mt+1]=Ue;xe[Ze]=Re}if(ue!==c){for(Ze=0;Ze<De;Ze++)C.yield1(ue,xe[Ze]);return c}return xe},-1),B(y,"$inherited",function(ae){ae.$$prototype.$to_a=function(){return this.slice(0,this.length)}}),T(y,"$instance_variables",function ve(){var ae=ve.$$p||c;return ve.$$p=null,I(q(this,K(this,"instance_variables",ve,!1,!0),"instance_variables",[],ae),"reject",[],function(b){var V;return null==b&&(b=c),le(V=/^@\d+$/.test(b))?V:b["$=="]("@length")})}),T(y,"$pack",function(ae){return W(arguments),Z.$raise("To use Array#pack, you must first require 'corelib/array/pack'.")},-1),F(y,"append","push"),F(y,"filter","select"),F(y,"filter!","select!"),F(y,"map","collect"),F(y,"map!","collect!"),F(y,"prepend","unshift"),F(y,"size","length"),F(y,"slice","[]"),F(y,"to_s","inspect"),j.$pristine(y.$singleton_class(),"allocate"),j.$pristine(y,"copy_instance_variables","initialize_dup")}()},Opal.modules["corelib/hash"]=function(C){var P,de,R,te,k,le=C.yield1,me=C.hash,d=C.hash_init,H=C.hash_get,ee=C.hash_put,$=C.hash_delete,x=C.deny_frozen_access,O=C.freeze,E=C.klass,Y=C.slice,G=C.Opal,D=C.Kernel,W=C.defs,B=C.def,Z=C.send,T=C.rb_ge,j=C.rb_gt,oe=C.hash2,z=C.truthy,q=C.to_a,K=C.return_self,I=C.alias,L=C.nil,S=C.$$$;return C.top.$require("corelib/enumerable"),P=[],te=[R=E("::",null,"Hash")].concat(P),k=C.$r(te),R.$include(S("Enumerable")),R.$$prototype.$$is_hash=!0,W(R,"$[]",function(F){var l,f,p,c=this,u=(l=Y(arguments)).length;if(1===u){if((f=G["$coerce_to?"](l["$[]"](0),S("Hash"),"to_hash"))!==L)return c.$allocate()["$merge!"](f);for((l=G["$coerce_to?"](l["$[]"](0),S("Array"),"to_ary"))===L&&D.$raise(S("ArgumentError"),"odd number of arguments for Hash"),u=l.length,f=c.$allocate(),p=0;p<u;p++)if(l[p].$$is_array)switch(l[p].length){case 1:f.$store(l[p][0],L);break;case 2:f.$store(l[p][0],l[p][1]);break;default:D.$raise(S("ArgumentError"),"invalid number of elements ("+l[p].length+" for 1..2)")}return f}for(u%2!=0&&D.$raise(S("ArgumentError"),"odd number of arguments for Hash"),f=c.$allocate(),p=0;p<u;p+=2)f.$store(l[p],l[p+1]);return f},-1),W(R,"$allocate",function(){var g=new this.$$constructor;return d(g),g.$$none=L,g.$$proc=L,g}),W(R,"$try_convert",function(F){return G["$coerce_to?"](F,S("Hash"),"to_hash")}),B(R,"$initialize",function N(F){var g=N.$$p||L,l=this;return N.$$p=null,x(l),void 0!==F&&g!==L&&D.$raise(S("ArgumentError"),"wrong number of arguments (1 for 0)"),l.$$none=void 0===F?L:F,l.$$proc=g,l},-1),B(R,"$==",function(F){var g=this;if(g===F)return!0;if(!F.$$is_hash||g.$$keys.length!==F.$$keys.length)return!1;for(var u,p,_,l=0,c=g.$$keys,f=c.length;l<f;l++)if((u=c[l]).$$is_string?(p=g.$$smap[u],_=F.$$smap[u]):(p=u.value,_=H(F,u.key)),void 0===_||!p["$eql?"](_))return!1;return!0}),B(R,"$>=",function(F){var l=L;return F=G["$coerce_to!"](F,S("Hash"),"to_hash"),!(this.$$keys.length<F.$$keys.length)&&(l=!0,Z(F,"each",[],function c(f,u){var _;null==f&&(f=L),null==u&&(u=L),null!=(_=(null==c.$$s?this:c.$$s).$fetch(f,null))&&_===u||(l=!1)},{$$s:this}),l)}),B(R,"$>",function(F){return F=G["$coerce_to!"](F,S("Hash"),"to_hash"),!(this.$$keys.length<=F.$$keys.length)&&T(this,F)}),B(R,"$<",function(F){return F=G["$coerce_to!"](F,S("Hash"),"to_hash"),j(F,this)}),B(R,"$<=",function(F){return F=G["$coerce_to!"](F,S("Hash"),"to_hash"),T(F,this)}),B(R,"$[]",function(F){var l=H(this,F);return void 0!==l?l:this.$default(F)}),B(R,"$[]=",function(F,g){return x(this),ee(this,F,g),g}),B(R,"$assoc",function(F){for(var u,l=0,c=this.$$keys,f=c.length;l<f;l++)if((u=c[l]).$$is_string){if(u["$=="](F))return[u,this.$$smap[u]]}else if(u.key["$=="](F))return[u.key,u.value];return L}),B(R,"$clear",function(){var F=this;return x(F),d(F),F}),B(R,"$clone",function(){var g=new this.$$class;return d(g),C.hash_clone(this,g),g}),B(R,"$compact",function(){for(var u,p,g=me(),l=0,c=this.$$keys,f=c.length;l<f;l++)(u=c[l]).$$is_string?p=this.$$smap[u]:(p=u.value,u=u.key),p!==L&&ee(g,u,p);return g}),B(R,"$compact!",function(){var F=this;x(F);for(var u,p,g=!1,l=0,c=F.$$keys,f=c.length;l<f;l++)(u=c[l]).$$is_string?p=F.$$smap[u]:(p=u.value,u=u.key),p===L&&void 0!==$(F,u)&&(g=!0,f--,l--);return g?F:L}),B(R,"$compare_by_identity",function(){var F=this;x(F);var g,l,c,u,f=F.$$keys;if(F.$$by_identity)return F;if(0===F.$$keys.length)return F.$$by_identity=!0,F;for(u=oe([],{}).$compare_by_identity(),g=0,l=f.length;g<l;g++)(c=f[g]).$$is_string||(c=c.key),ee(u,c,H(F,c));return F.$$by_identity=!0,F.$$map=u.$$map,F.$$smap=u.$$smap,F}),B(R,"$compare_by_identity?",function(){return!0===this.$$by_identity}),B(R,"$default",function(F){var g=this;return void 0!==F&&g.$$proc!==L&&void 0!==g.$$proc?g.$$proc.$call(g,F):void 0===g.$$none?L:g.$$none},-1),B(R,"$default=",function(F){var g=this;return x(g),g.$$proc=L,g.$$none=F,F}),B(R,"$default_proc",function(){return void 0!==this.$$proc?this.$$proc:L}),B(R,"$default_proc=",function(F){var g=this;x(g);var l=F;return l!==L&&(l=G["$coerce_to!"](l,S("Proc"),"to_proc"))["$lambda?"]()&&2!==l.$arity().$abs()&&D.$raise(S("TypeError"),"default_proc takes two arguments"),g.$$none=L,g.$$proc=l,F}),B(R,"$delete",function N(F){var g=N.$$p||L;N.$$p=null,x(this);var c=$(this,F);return void 0!==c?c:g!==L?C.yield1(g,F):L}),B(R,"$delete_if",function N(){var F=N.$$p||L,g=this;if(N.$$p=null,!z(F))return Z(g,"enum_for",["delete_if"],function y(){return(null==y.$$s?this:y.$$s).$size()},{$$s:g});x(g);for(var u,p,_,l=0,c=g.$$keys,f=c.length;l<f;l++)(u=c[l]).$$is_string?p=g.$$smap[u]:(p=u.value,u=u.key),!1!==(_=F(u,p))&&_!==L&&void 0!==$(g,u)&&(f--,l--);return g}),B(R,"$dig",function(F,g){var c,f=this,u=L;return c=Y(arguments,1),(u=f["$[]"](F))===L||0===c.length?u:(z(u["$respond_to?"]("dig"))||D.$raise(S("TypeError"),u.$class()+" does not have #dig method"),Z(u,"dig",q(c)))},-2),B(R,"$each",function N(){var F=N.$$p||L,g=this;if(N.$$p=null,!z(F))return Z(g,"enum_for",["each"],function _(){return(null==_.$$s?this:_.$$s).$size()},{$$s:g});for(var u,p,l=0,c=g.$$keys.slice(),f=c.length;l<f;l++)(u=c[l]).$$is_string?p=g.$$smap[u]:(p=u.value,u=u.key),le(F,[u,p]);return g}),B(R,"$each_key",function N(){var F=N.$$p||L,g=this;if(N.$$p=null,!z(F))return Z(g,"enum_for",["each_key"],function p(){return(null==p.$$s?this:p.$$s).$size()},{$$s:g});for(var u,l=0,c=g.$$keys.slice(),f=c.length;l<f;l++)F((u=c[l]).$$is_string?u:u.key);return g}),B(R,"$each_value",function N(){var F=N.$$p||L,g=this;if(N.$$p=null,!z(F))return Z(g,"enum_for",["each_value"],function p(){return(null==p.$$s?this:p.$$s).$size()},{$$s:g});for(var u,l=0,c=g.$$keys.slice(),f=c.length;l<f;l++)F((u=c[l]).$$is_string?g.$$smap[u]:u.value);return g}),B(R,"$empty?",function(){return 0===this.$$keys.length}),B(R,"$except",function(F){var l,c=this;return l=Y(arguments),Z(c.$dup(),"except!",q(l))},-1),B(R,"$except!",function(F){var g,c=this;return g=Y(arguments),Z(g,"each",[],function f(u){return null==u&&(u=L),(null==f.$$s?this:f.$$s).$delete(u)},{$$s:c}),c},-1),B(R,"$fetch",function N(F,g){var l=N.$$p||L;N.$$p=null;var f=H(this,F);return void 0!==f?f:l!==L?l(F):void 0!==g?g:D.$raise(S("KeyError").$new("key not found: "+F.$inspect(),oe(["key","receiver"],{key:F,receiver:this})))},-2),B(R,"$fetch_values",function N(F){var l,g=N.$$p||L,f=this;return N.$$p=null,l=Y(arguments),Z(l,"map",[],function u(p){return null==p&&(p=L),Z(null==u.$$s?this:u.$$s,"fetch",[p],g.$to_proc())},{$$s:f})},-1),B(R,"$flatten",function(F){null==F&&(F=1),F=G["$coerce_to!"](F,S("Integer"),"to_int");for(var p,_,l=[],c=0,f=this.$$keys,u=f.length;c<u;c++)if((p=f[c]).$$is_string?_=this.$$smap[p]:(_=p.value,p=p.key),l.push(p),_.$$is_array){if(1===F){l.push(_);continue}l=l.concat(_.$flatten(F-2))}else l.push(_);return l},-1),B(R,"$freeze",function(){var F=this;return z(F["$frozen?"]())?F:O(F)}),B(R,"$has_key?",function(F){return void 0!==H(this,F)}),B(R,"$has_value?",function(F){for(var u,l=0,c=this.$$keys,f=c.length;l<f;l++)if(((u=c[l]).$$is_string?this.$$smap[u]:u.value)["$=="](F))return!0;return!1}),B(R,"$hash",function(){var f,F=this,g=void 0===C.hash_ids,l=F.$object_id(),c=["Hash"];try{if(g&&(C.hash_ids=Object.create(null)),C[l])return"self";for(f in C.hash_ids)if(F["$eql?"](C.hash_ids[f]))return"self";C.hash_ids[l]=F;for(var p=0,_=F.$$keys,y=_.length;p<y;p++)c.push((f=_[p]).$$is_string?[f,F.$$smap[f].$hash()]:[f.key_hash,f.value.$hash()]);return c.sort().join()}finally{g&&(C.hash_ids=void 0)}}),B(R,"$index",function(F){for(var u,p,l=0,c=this.$$keys,f=c.length;l<f;l++)if((u=c[l]).$$is_string?p=this.$$smap[u]:(p=u.value,u=u.key),p["$=="](F))return u;return L}),B(R,"$indexes",function(F){for(var l,y,c=this,f=[],u=0,p=(l=Y(arguments)).length;u<p;u++)void 0!==(y=H(c,l[u]))?f.push(y):f.push(c.$default());return f},-1),B(R,"$inspect",function(){var F=this,g=void 0===de,l=F.$object_id(),c=[];return function(){try{if(g&&(de={}),de.hasOwnProperty(l))return"{...}";de[l]=!0;for(var _,y,f=0,u=F.$$keys,p=u.length;f<p;f++)(_=u[f]).$$is_string?y=F.$$smap[_]:(y=_.value,_=_.key),_=k("Opal").$inspect(_),y=k("Opal").$inspect(y),c.push(_+"=>"+y);return"{"+c.join(", ")+"}"}finally{g&&(de=void 0)}}()}),B(R,"$invert",function(){for(var u,p,g=me(),l=0,c=this.$$keys,f=c.length;l<f;l++)(u=c[l]).$$is_string?p=this.$$smap[u]:(p=u.value,u=u.key),ee(g,p,u);return g}),B(R,"$keep_if",function N(){var F=N.$$p||L,g=this;if(N.$$p=null,!z(F))return Z(g,"enum_for",["keep_if"],function y(){return(null==y.$$s?this:y.$$s).$size()},{$$s:g});x(g);for(var u,p,_,l=0,c=g.$$keys,f=c.length;l<f;l++)(u=c[l]).$$is_string?p=g.$$smap[u]:(p=u.value,u=u.key),(!1===(_=F(u,p))||_===L)&&void 0!==$(g,u)&&(f--,l--);return g}),B(R,"$keys",function(){for(var u,g=[],l=0,c=this.$$keys,f=c.length;l<f;l++)g.push((u=c[l]).$$is_string?u:u.key);return g}),B(R,"$length",function(){return this.$$keys.length}),B(R,"$merge",function N(F){var c,g=N.$$p||L,f=this;return N.$$p=null,c=Y(arguments),Z(f.$dup(),"merge!",q(c),g.$to_proc())},-1),B(R,"$merge!",function N(F){var c,u,p,_,y,m,ne,se,Ee,g=N.$$p||L,f=this;for(N.$$p=null,c=Y(arguments),x(f),u=0;u<c.length;++u)if(m=(y=(_=G["$coerce_to!"](c[u],S("Hash"),"to_hash")).$$keys).length,g===L)for(p=0;p<m;p++)(ne=y[p]).$$is_string?Ee=_.$$smap[ne]:(Ee=ne.value,ne=ne.key),ee(f,ne,Ee);else for(p=0;p<m;p++)(ne=y[p]).$$is_string?Ee=_.$$smap[ne]:(Ee=ne.value,ne=ne.key),void 0!==(se=H(f,ne))?ee(f,ne,g(ne,se,Ee)):ee(f,ne,Ee);return f},-1),B(R,"$rassoc",function(F){for(var u,p,l=0,c=this.$$keys,f=c.length;l<f;l++)if((u=c[l]).$$is_string?p=this.$$smap[u]:(p=u.value,u=u.key),p["$=="](F))return[u,p];return L}),B(R,"$rehash",function(){var F=this;return x(F),C.hash_rehash(F),F}),B(R,"$reject",function N(){var F=N.$$p||L,g=this;if(N.$$p=null,!z(F))return Z(g,"enum_for",["reject"],function m(){return(null==m.$$s?this:m.$$s).$size()},{$$s:g});for(var p,_,y,l=me(),c=0,f=g.$$keys,u=f.length;c<u;c++)(p=f[c]).$$is_string?_=g.$$smap[p]:(_=p.value,p=p.key),(!1===(y=F(p,_))||y===L)&&ee(l,p,_);return l}),B(R,"$reject!",function N(){var F=N.$$p||L,g=this;if(N.$$p=null,!z(F))return Z(g,"enum_for",["reject!"],function m(){return(null==m.$$s?this:m.$$s).$size()},{$$s:g});x(g);for(var p,_,y,l=!1,c=0,f=g.$$keys,u=f.length;c<u;c++)(p=f[c]).$$is_string?_=g.$$smap[p]:(_=p.value,p=p.key),!1!==(y=F(p,_))&&y!==L&&void 0!==$(g,p)&&(l=!0,u--,c--);return l?g:L}),B(R,"$replace",function(F){var g=this;x(g),F=G["$coerce_to!"](F,S("Hash"),"to_hash"),d(g);for(var u,_,l=0,c=F.$$keys,f=c.length;l<f;l++)(u=c[l]).$$is_string?_=F.$$smap[u]:(_=u.value,u=u.key),ee(g,u,_);return z(F.$default_proc())?g["$default_proc="](F.$default_proc()):g["$default="](F.$default()),g}),B(R,"$select",function N(){var F=N.$$p||L,g=this;if(N.$$p=null,!z(F))return Z(g,"enum_for",["select"],function m(){return(null==m.$$s?this:m.$$s).$size()},{$$s:g});for(var p,_,y,l=me(),c=0,f=g.$$keys,u=f.length;c<u;c++)(p=f[c]).$$is_string?_=g.$$smap[p]:(_=p.value,p=p.key),!1!==(y=F(p,_))&&y!==L&&ee(l,p,_);return l}),B(R,"$select!",function N(){var F=N.$$p||L,g=this;if(N.$$p=null,!z(F))return Z(g,"enum_for",["select!"],function m(){return(null==m.$$s?this:m.$$s).$size()},{$$s:g});x(g);for(var p,_,y,l=L,c=0,f=g.$$keys,u=f.length;c<u;c++)(p=f[c]).$$is_string?_=g.$$smap[p]:(_=p.value,p=p.key),(!1===(y=F(p,_))||y===L)&&(void 0!==$(g,p)&&(u--,c--),l=g);return l}),B(R,"$shift",function(){var F=this;x(F);var l,g=F.$$keys;return g.length>0?[l=(l=g[0]).$$is_string?l:l.key,$(F,l)]:L}),B(R,"$slice",function(F){var l,c=this;l=Y(arguments);for(var f=me(),u=0,p=l.length;u<p;u++){var _=l[u],y=H(c,_);void 0!==y&&ee(f,_,y)}return f},-1),B(R,"$to_a",function(){for(var u,p,g=[],l=0,c=this.$$keys,f=c.length;l<f;l++)(u=c[l]).$$is_string?p=this.$$smap[u]:(p=u.value,u=u.key),g.push([u,p]);return g}),B(R,"$to_h",function N(){var F=N.$$p||L,g=this;if(N.$$p=null,F!==L)return Z(g,"map",[],F.$to_proc()).$to_h();if(g.$$class===C.Hash)return g;var l=new C.Hash;return d(l),C.hash_clone(g,l),l}),B(R,"$to_hash",K),B(R,"$to_proc",function(){return Z(this,"proc",[],function g(l){var c=null==g.$$s?this:g.$$s;return null==l&&D.$raise(S("ArgumentError"),"no key given"),c["$[]"](l)},{$$arity:-1,$$s:this})}),B(R,"$transform_keys",function N(){var F=N.$$p||L,g=this;if(N.$$p=null,!z(F))return Z(g,"enum_for",["transform_keys"],function y(){return(null==y.$$s?this:y.$$s).$size()},{$$s:g});for(var p,_,l=me(),c=0,f=g.$$keys,u=f.length;c<u;c++)(p=f[c]).$$is_string?_=g.$$smap[p]:(_=p.value,p=p.key),p=le(F,p),ee(l,p,_);return l}),B(R,"$transform_keys!",function N(){var F=N.$$p||L,g=this;if(N.$$p=null,!z(F))return Z(g,"enum_for",["transform_keys!"],function y(){return(null==y.$$s?this:y.$$s).$size()},{$$s:g});x(g);var c,u,p,_,l=C.slice(g.$$keys),f=l.length;for(c=0;c<f;c++)(u=l[c]).$$is_string?p=g.$$smap[u]:(p=u.value,u=u.key),_=le(F,u),$(g,u),ee(g,_,p);return g}),B(R,"$transform_values",function N(){var F=N.$$p||L,g=this;if(N.$$p=null,!z(F))return Z(g,"enum_for",["transform_values"],function y(){return(null==y.$$s?this:y.$$s).$size()},{$$s:g});for(var p,_,l=me(),c=0,f=g.$$keys,u=f.length;c<u;c++)(p=f[c]).$$is_string?_=g.$$smap[p]:(_=p.value,p=p.key),_=le(F,_),ee(l,p,_);return l}),B(R,"$transform_values!",function N(){var F=N.$$p||L,g=this;if(N.$$p=null,!z(F))return Z(g,"enum_for",["transform_values!"],function _(){return(null==_.$$s?this:_.$$s).$size()},{$$s:g});x(g);for(var u,p,l=0,c=g.$$keys,f=c.length;l<f;l++)(u=c[l]).$$is_string?p=g.$$smap[u]:(p=u.value,u=u.key),p=le(F,p),ee(g,u,p);return g}),B(R,"$values",function(){for(var u,g=[],l=0,c=this.$$keys,f=c.length;l<f;l++)g.push((u=c[l]).$$is_string?this.$$smap[u]:u.value);return g}),I(R,"dup","clone"),I(R,"each_pair","each"),I(R,"eql?","=="),I(R,"filter","select"),I(R,"filter!","select!"),I(R,"include?","has_key?"),I(R,"indices","indexes"),I(R,"key","index"),I(R,"key?","has_key?"),I(R,"member?","has_key?"),I(R,"size","length"),I(R,"store","[]="),I(R,"to_s","inspect"),I(R,"update","merge!"),I(R,"value?","has_value?"),I(R,"values_at","indexes")},Opal.modules["corelib/number"]=function(C){var R,te,N,g,l,k,de,le=C.klass,me=C.Opal,d=C.Kernel,H=C.def,ee=C.eqeqeq,$=C.truthy,x=C.rb_gt,O=C.not,E=C.rb_lt,Y=C.alias,G=C.send2,D=C.find_super,W=C.send,B=C.rb_plus,Z=C.rb_minus,T=C.eqeq,j=C.return_self,oe=C.rb_divide,z=C.to_ary,q=C.rb_times,K=C.rb_le,I=C.rb_ge,A=C.return_val,J=C.const_set,S=[],M=C.nil,v=C.$$$;return C.top.$require("corelib/numeric"),function(P,R,te){var f,k=le("::",R,"Number");function F(f){var u=new Uint8Array(8);return new DataView(u.buffer).setFloat64(0,f,!0),u}function g(f){return new DataView(f.buffer).getFloat64(0,!0)}function l(f){for(var u=F(f),p=0;p<u.length;p++){if(255!==u[p]){u[p]++;break}u[p]=0}return g(u)}function c(f){for(var u=F(f),p=0;p<u.length;p++){if(0!==u[p]){u[p]--;break}u[p]=255}return g(u)}[k].concat(te),me.$bridge(Number,k),C.prop(k.$$prototype,"$$is_number",!0),k.$$is_number_class=!0,f=C.get_singleton_class(k),H(f,"$allocate",function(){return d.$raise(v("TypeError"),"allocator undefined for "+this.$name())}),C.udef(f,"$new"),H(k,"$coerce",function(u){var p=this;if(u===M)d.$raise(v("TypeError"),"can't convert "+u.$class()+" into Float");else{if(u.$$is_string)return[d.$Float(u),p];if(u["$respond_to?"]("to_f"))return[me["$coerce_to!"](u,v("Float"),"to_f"),p];if(u.$$is_number)return[u,p];d.$raise(v("TypeError"),"can't convert "+u.$class()+" into Float")}}),H(k,"$__id__",function(){return 2*this+1}),H(k,"$+",function(u){return u.$$is_number?this+u:this.$__coerced__("+",u)}),H(k,"$-",function(u){return u.$$is_number?this-u:this.$__coerced__("-",u)}),H(k,"$*",function(u){return u.$$is_number?this*u:this.$__coerced__("*",u)}),H(k,"$/",function(u){return u.$$is_number?this/u:this.$__coerced__("/",u)}),H(k,"$%",function(u){var p=this;return u.$$is_number?u==-1/0?u:0!=u?u<0||p<0?(p%u+u)%u:p%u:void d.$raise(v("ZeroDivisionError"),"divided by 0"):p.$__coerced__("%",u)}),H(k,"$&",function(u){return u.$$is_number?this&u:this.$__coerced__("&",u)}),H(k,"$|",function(u){return u.$$is_number?this|u:this.$__coerced__("|",u)}),H(k,"$^",function(u){return u.$$is_number?this^u:this.$__coerced__("^",u)}),H(k,"$<",function(u){return u.$$is_number?this<u:this.$__coerced__("<",u)}),H(k,"$<=",function(u){return u.$$is_number?this<=u:this.$__coerced__("<=",u)}),H(k,"$>",function(u){return u.$$is_number?this>u:this.$__coerced__(">",u)}),H(k,"$>=",function(u){return u.$$is_number?this>=u:this.$__coerced__(">=",u)}),H(k,"$<=>",function(u){try{return function(f,u){return u.$$is_number?isNaN(f)||isNaN(u)?M:f>u?1:f<u?-1:0:f.$__coerced__("<=>",u)}(this,u)}catch(_){if(!C.rescue(_,[v("ArgumentError")]))throw _;try{return M}finally{C.pop_exception()}}}),H(k,"$<<",function(u){return(u=me["$coerce_to!"](u,v("Integer"),"to_int"))>0?this<<u:this>>-u}),H(k,"$>>",function(u){return(u=me["$coerce_to!"](u,v("Integer"),"to_int"))>0?this>>u:this<<-u}),H(k,"$[]",function(u){return(u=me["$coerce_to!"](u,v("Integer"),"to_int"))<0?0:u>=32?this<0?1:0:this>>u&1}),H(k,"$+@",function(){return+this}),H(k,"$-@",function(){return-this}),H(k,"$~",function(){return~this}),H(k,"$**",function(u){var p=this;return ee(v("Integer"),u)?O(v("Integer")["$==="](p))||$(x(u,0))?Math.pow(p,u):v("Rational").$new(p,1)["$**"](u):E(p,0)&&(ee(v("Float"),u)||ee(v("Rational"),u))?v("Complex").$new(p,0)["$**"](u.$to_f()):$(null!=u.$$is_number)?Math.pow(p,u):p.$__coerced__("**",u)}),H(k,"$==",function(u){return u.$$is_number?this.valueOf()===u.valueOf():!!u["$respond_to?"]("==")&&u["$=="](this)}),Y(k,"===","=="),H(k,"$abs",function(){return Math.abs(this)}),H(k,"$abs2",function(){return Math.abs(this*this)}),H(k,"$allbits?",function(u){return(this&(u=me["$coerce_to!"](u,v("Integer"),"to_int")))==u}),H(k,"$anybits?",function(u){return 0!=(this&me["$coerce_to!"](u,v("Integer"),"to_int"))}),H(k,"$angle",function(){var u=this;return $(u["$nan?"]())?u:0==u?1/u>0?0:Math.PI:u<0?Math.PI:0}),H(k,"$bit_length",function(){var u=this;if(ee(v("Integer"),u)||d.$raise(v("NoMethodError").$new("undefined method `bit_length` for "+u+":Float","bit_length")),0===u||-1===u)return 0;for(var p=0,_=u<0?~u:u;0!=_;)p+=1,_>>>=1;return p}),H(k,"$ceil",function(u){null==u&&(u=0);var _=this.$to_f();if(_%1==0&&u>=0)return _;var y=Math.pow(10,u),m=Math.ceil(_*y)/y;return _%1==0&&(m=Math.round(m)),m},-1),H(k,"$chr",function(u){return C.enc(String.fromCharCode(this),u||"BINARY")},-1),H(k,"$denominator",function f(){var u=f.$$p||M,p=this;return f.$$p=null,$(p["$nan?"]())||$(p["$infinite?"]())?1:G(p,D(p,"denominator",f,!1,!0),"denominator",[],u)}),H(k,"$downto",function f(u){var p=f.$$p||M,_=this;if(f.$$p=null,p===M)return W(_,"enum_for",["downto",u],function m(){var ne=null==m.$$s?this:m.$$s;return ee(v("Numeric"),u)||d.$raise(v("ArgumentError"),"comparison of "+ne.$class()+" with "+u.$class()+" failed"),$(x(u,ne))?0:B(Z(ne,u),1)},{$$s:_});u.$$is_number||d.$raise(v("ArgumentError"),"comparison of "+_.$class()+" with "+u.$class()+" failed");for(var y=_;y>=u;y--)p(y);return _}),H(k,"$equal?",function(u){var _;return $(_=this["$=="](u))?_:isNaN(this)&&isNaN(u)}),H(k,"$even?",function(){return this%2==0}),H(k,"$floor",function(u){null==u&&(u=0);var _=this.$to_f();if(_%1==0&&u>=0)return _;var y=Math.pow(10,u),m=Math.floor(_*y)/y;return _%1==0&&(m=Math.round(m)),m},-1),H(k,"$gcd",function(u){ee(v("Integer"),u)||d.$raise(v("TypeError"),"not an integer");for(var _=Math.abs(this),y=Math.abs(u);_>0;){var m=_;_=y%_,y=m}return y}),H(k,"$gcdlcm",function(u){return[this.$gcd(u),this.$lcm(u)]}),H(k,"$integer?",function(){return this%1==0}),H(k,"$is_a?",function f(u){var p=f.$$p||M,_=this;return f.$$p=null,!!(T(u,v("Integer"))&&ee(v("Integer"),_)||T(u,v("Integer"))&&ee(v("Integer"),_)||T(u,v("Float"))&&ee(v("Float"),_))||G(_,D(_,"is_a?",f,!1,!0),"is_a?",[u],p)}),H(k,"$instance_of?",function f(u){var p=f.$$p||M,_=this;return f.$$p=null,!!(T(u,v("Integer"))&&ee(v("Integer"),_)||T(u,v("Integer"))&&ee(v("Integer"),_)||T(u,v("Float"))&&ee(v("Float"),_))||G(_,D(_,"instance_of?",f,!1,!0),"instance_of?",[u],p)}),H(k,"$lcm",function(u){var p=this;return ee(v("Integer"),u)||d.$raise(v("TypeError"),"not an integer"),0==p||0==u?0:Math.abs(p*u/p.$gcd(u))}),H(k,"$next",function(){return this+1}),H(k,"$nobits?",function(u){return 0==(this&me["$coerce_to!"](u,v("Integer"),"to_int"))}),H(k,"$nonzero?",function(){return 0==this?M:this}),H(k,"$numerator",function f(){var u=f.$$p||M,p=this;return f.$$p=null,$(p["$nan?"]())||$(p["$infinite?"]())?p:G(p,D(p,"numerator",f,!1,!0),"numerator",[],u)}),H(k,"$odd?",function(){return this%2!=0}),H(k,"$ord",j),H(k,"$pow",function(u,p){var _=this;return 0==_&&d.$raise(v("ZeroDivisionError"),"divided by 0"),void 0===p?_["$**"](u):(v("Integer")["$==="](u)||d.$raise(v("TypeError"),"Integer#pow() 2nd argument not allowed unless a 1st argument is integer"),u<0&&d.$raise(v("TypeError"),"Integer#pow() 1st argument cannot be negative when 2nd argument specified"),v("Integer")["$==="](p)||d.$raise(v("TypeError"),"Integer#pow() 2nd argument not allowed unless all arguments are integers"),0===p&&d.$raise(v("ZeroDivisionError"),"divided by 0"),_["$**"](u)["$%"](p))},-2),H(k,"$pred",function(){return this-1}),H(k,"$quo",function f(u){var p=f.$$p||M,_=this;return f.$$p=null,ee(v("Integer"),_)?G(_,D(_,"quo",f,!1,!0),"quo",[u],p):oe(_,u)}),H(k,"$rationalize",function(u){var p,_,y=this,m=M,ne=M;return arguments.length>1&&d.$raise(v("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),ee(v("Integer"),y)?v("Rational").$new(y,1):$(y["$infinite?"]())?d.$raise(v("FloatDomainError"),"Infinity"):$(y["$nan?"]())?d.$raise(v("FloatDomainError"),"NaN"):$(null==u)?(_=v("Math").$frexp(y),m=null==(p=z(_))[0]?M:p[0],ne=null==p[1]?M:p[1],m=v("Math").$ldexp(m,v(v("Float"),"MANT_DIG")).$to_i(),ne=Z(ne,v(v("Float"),"MANT_DIG")),v("Rational").$new(q(2,m),1["$<<"](Z(1,ne))).$rationalize(v("Rational").$new(1,1["$<<"](Z(1,ne))))):y.$to_r().$rationalize(u)},-1),H(k,"$remainder",function(u){return Z(this,q(u,oe(this,u).$truncate()))}),H(k,"$round",function(u){var p,_,ne,y=this;if(ee(v("Integer"),y)){if($(null==u)||(ee(v("Float"),u)&&$(u["$infinite?"]())&&d.$raise(v("RangeError"),"Infinity"),u=me["$coerce_to!"](u,v("Integer"),"to_int"),$(E(u,v(v("Integer"),"MIN")))&&d.$raise(v("RangeError"),"out of bounds"),$(u>=0)))return y;if(.415241*(u=u["$-@"]())-.125>y.$size())return 0;var se=Math.pow(10,u),Ee=Math.floor((Math.abs(y)+se/2)/se)*se;return y<0?-Ee:Ee}if($(y["$nan?"]())&&$(null==u)&&d.$raise(v("FloatDomainError"),"NaN"),u=me["$coerce_to!"](u||0,v("Integer"),"to_int"),$(K(u,0)))$(y["$nan?"]())?d.$raise(v("RangeError"),"NaN"):$(y["$infinite?"]())&&d.$raise(v("FloatDomainError"),"Infinity");else{if(T(u,0))return Math.round(y);if($(y["$nan?"]())||$(y["$infinite?"]()))return y}return _=v("Math").$frexp(y),ne=null==(p=z(_))[1]?M:p[1],$(I(u,Z(B(v(v("Float"),"DIG"),2),$(x(ne,0))?oe(ne,4):Z(oe(ne,3),1))))?y:$(E(u,($(x(ne,0))?B(oe(ne,3),1):oe(ne,4))["$-@"]()))?0:Math.round(y*Math.pow(10,u))/Math.pow(10,u)},-1),H(k,"$times",function f(){var u=f.$$p||M,p=this;if(f.$$p=null,!$(u))return W(p,"enum_for",["times"],function y(){return null==y.$$s?this:y.$$s},{$$s:p});for(var _=0;_<p;_++)u(_);return p}),H(k,"$to_f",j),H(k,"$to_i",function(){var u=this;return u<0?Math.ceil(u):Math.floor(u)}),H(k,"$to_r",function(){var u,p,_=this,y=M,m=M;return ee(v("Integer"),_)?v("Rational").$new(_,1):(p=v("Math").$frexp(_),y=null==(u=z(p))[0]?M:u[0],m=null==u[1]?M:u[1],y=v("Math").$ldexp(y,v(v("Float"),"MANT_DIG")).$to_i(),m=Z(m,v(v("Float"),"MANT_DIG")),q(y,v(v("Float"),"RADIX")["$**"](m)).$to_r())}),H(k,"$to_s",function(u){var p=this;return null==u&&(u=10),u=me["$coerce_to!"](u,v("Integer"),"to_int"),($(E(u,2))||$(x(u,36)))&&d.$raise(v("ArgumentError"),"invalid radix "+u),T(p,0)&&$(1/p==-1/0)?"-0.0":p.toString(u)},-1),H(k,"$truncate",function(u){null==u&&(u=0);var _=this.$to_f();if(_%1==0&&u>=0)return _;var y=Math.pow(10,u),m=parseInt(_*y,10)/y;return _%1==0&&(m=Math.round(m)),m},-1),H(k,"$digits",function(u){var p=this;null==u&&(u=10),E(p,0)&&d.$raise(v(v("Math"),"DomainError"),"out of domain"),u=me["$coerce_to!"](u,v("Integer"),"to_int"),$(E(u,2))&&d.$raise(v("ArgumentError"),"invalid radix "+u),p!=parseInt(p)&&d.$raise(v("NoMethodError"),"undefined method `digits' for "+p.$inspect());var _=p,y=[];if(0==p)return[0];for(;0!=_;)y.push(_%u),_=parseInt(_/u,10);return y},-1),H(k,"$divmod",function f(u){var p=f.$$p||M,_=this;return f.$$p=null,$(_["$nan?"]())||$(u["$nan?"]())?d.$raise(v("FloatDomainError"),"NaN"):$(_["$infinite?"]())?d.$raise(v("FloatDomainError"),"Infinity"):G(_,D(_,"divmod",f,!1,!0),"divmod",[u],p)}),H(k,"$upto",function f(u){var p=f.$$p||M,_=this;if(f.$$p=null,p===M)return W(_,"enum_for",["upto",u],function m(){var ne=null==m.$$s?this:m.$$s;return ee(v("Numeric"),u)||d.$raise(v("ArgumentError"),"comparison of "+ne.$class()+" with "+u.$class()+" failed"),$(E(u,ne))?0:B(Z(u,ne),1)},{$$s:_});u.$$is_number||d.$raise(v("ArgumentError"),"comparison of "+_.$class()+" with "+u.$class()+" failed");for(var y=_;y<=u;y++)p(y);return _}),H(k,"$zero?",function(){return 0==this}),H(k,"$size",A(4)),H(k,"$nan?",function(){return isNaN(this)}),H(k,"$finite?",function(){var u=this;return u!=1/0&&u!=-1/0&&!isNaN(u)}),H(k,"$infinite?",function(){return this==1/0?1:this==-1/0?-1:M}),H(k,"$positive?",function(){var u=this;return 0!=u&&(u==1/0||1/u>0)}),H(k,"$negative?",function(){return this==-1/0||1/this<0}),H(k,"$next_float",function(){var u=this;return T(u,v(v("Float"),"INFINITY"))?v(v("Float"),"INFINITY"):$(u["$nan?"]())?v(v("Float"),"NAN"):I(u,0)?l(Math.abs(u)):c(u)}),H(k,"$prev_float",function(){var u=this;return T(u,v(v("Float"),"INFINITY")["$-@"]())?v(v("Float"),"INFINITY")["$-@"]():$(u["$nan?"]())?v(v("Float"),"NAN"):x(u,0)?c(u):-l(Math.abs(u))}),Y(k,"arg","angle"),Y(k,"eql?","=="),Y(k,"fdiv","/"),Y(k,"inspect","to_s"),Y(k,"kind_of?","is_a?"),Y(k,"magnitude","abs"),Y(k,"modulo","%"),Y(k,"object_id","__id__"),Y(k,"phase","angle"),Y(k,"succ","next"),Y(k,"to_int","to_i")}(0,v("Numeric"),S),J("::","Fixnum",v("Number")),R=v("Numeric"),te=S,de=[k=le("::",R,"Integer")].concat(te),k.$$is_number_class=!0,k.$$is_integer_class=!0,g=[N=C.get_singleton_class(k)].concat(de),l=C.$r(g),H(N,"$allocate",function(){return d.$raise(v("TypeError"),"allocator undefined for "+this.$name())}),C.udef(N,"$new"),H(N,"$sqrt",function(f){return(f=me["$coerce_to!"](f,v("Integer"),"to_int"))<0&&d.$raise(v(v("Math"),"DomainError"),'Numerical argument is out of domain - "isqrt"'),parseInt(Math.sqrt(f),10)}),H(N,"$try_convert",function(f){return l("Opal")["$coerce_to?"](f,this,"to_int")}),J(k,"MAX",Math.pow(2,30)-1),J(k,"MIN",-Math.pow(2,30)),function(P,R,te){var k=le("::",R,"Float");return[k].concat(te),k.$$is_number_class=!0,function(N,F){H(N,"$allocate",function(){return d.$raise(v("TypeError"),"allocator undefined for "+this.$name())}),C.udef(N,"$new"),H(N,"$===",function(l){return!!l.$$is_number})}(C.get_singleton_class(k)),J(k,"INFINITY",1/0),J(k,"MAX",Number.MAX_VALUE),J(k,"MIN",Number.MIN_VALUE),J(k,"NAN",NaN),J(k,"DIG",15),J(k,"MANT_DIG",53),J(k,"RADIX",2),J(k,"EPSILON",Number.EPSILON||2220446049250313e-31)}(0,v("Numeric"),S)},Opal.modules["corelib/range"]=function(C){var le=C.klass,me=C.truthy,d=C.Kernel,H=C.def,ee=C.not,$=C.send2,x=C.find_super,O=C.rb_lt,E=C.rb_le,Y=C.send,G=C.eqeq,D=C.eqeqeq,W=C.return_ivar,B=C.rb_gt,Z=C.rb_minus,T=C.Opal,j=C.rb_divide,oe=C.rb_plus,z=C.rb_times,q=C.rb_ge,K=C.thrower,I=C.alias,L=C.nil,S=C.$$$;return C.top.$require("corelib/enumerable"),function(M,v,P){var R=le("::",null,"Range"),te=[R].concat([]),k=C.$r(te),de=R.$$prototype;function N(F){return F.begin===L||F.end===L||F.begin===-1/0||F.end===1/0||F.begin===1/0||F.end===-1/0}return de.begin=de.end=de.excl=L,R.$include(S("Enumerable")),R.$$prototype.$$is_range=!0,R.$attr_reader("begin","end"),H(R,"$initialize",function(g,l,c){var f=this;return null==c&&(c=!1),me(f.begin)&&d.$raise(S("NameError"),"'initialize' called twice"),me(g["$<=>"](l))||me(g["$nil?"]())||me(l["$nil?"]())||d.$raise(S("ArgumentError"),"bad value for range"),f.begin=g,f.end=l,f.excl=c},-3),H(R,"$===",function(g){return this["$include?"](g)}),H(R,"$count",function F(){var g=F.$$p||L,l=this;return F.$$p=null,ee(g!==L)&&me(N(l))?S(S("Float"),"INFINITY"):$(l,x(l,"count",F,!1,!0),"count",[],g)}),H(R,"$to_a",function F(){var g=F.$$p||L,l=this;return F.$$p=null,me(N(l))&&d.$raise(S("TypeError"),"cannot convert endless range to an array"),$(l,x(l,"to_a",F,!1,!0),"to_a",[],g)}),H(R,"$cover?",function(g){var c,_,l=this,f=L,u=L,p=L;return c=me(f=me(u=me(p=l.begin["$nil?"]())?-1:p)?u:l.begin["$<=>"](g))&&f,_=me(f=me(u=me(p=l.end["$nil?"]())?-1:p)?u:g["$<=>"](l.end))&&f,me(f=me(u=me(l.excl)?me(p=_)?O(_,0):p:me(p=_)?E(_,0):p)?c:u)?E(c,0):f}),H(R,"$each",function F(){var f,p,_,g=F.$$p||L,l=this,c=L,u=L;if(F.$$p=null,g===L)return Y(l,"enum_for",["each"],function y(){return(null==y.$$s?this:y.$$s).$size()},{$$s:l});if(l.begin.$$is_number&&l.end.$$is_number){for((l.begin%1!=0||l.end%1!=0)&&d.$raise(S("TypeError"),"can't iterate from Float"),p=l.begin,_=l.end+(me(l.excl)?0:1);p<_;p++)g(p);return l}if(l.begin.$$is_string&&l.end.$$is_string)return Y(l.begin,"upto",[l.end,l.excl],g.$to_proc()),l;for(f=l.end,me((c=l.begin)["$respond_to?"]("succ"))||d.$raise(S("TypeError"),"can't iterate from "+c.$class());me(me(u=l.end["$nil?"]())?u:O(c["$<=>"](f),0));)C.yield1(g,c),c=c.$succ();return ee(l.excl)&&G(c,f)&&C.yield1(g,c),l}),H(R,"$eql?",function(g){var l=this,c=L,f=L;return!!D(S("Range"),g)&&(me(c=me(f=l.excl["$==="](g["$exclude_end?"]()))?l.begin["$eql?"](g.$begin()):f)?l.end["$eql?"](g.$end()):c)}),H(R,"$exclude_end?",W("excl")),H(R,"$first",function F(g){var l=F.$$p||L,c=this;return F.$$p=null,me(c.begin["$nil?"]())&&d.$raise(S("RangeError"),"cannot get the minimum of beginless range"),me(null==g)?c.begin:$(c,x(c,"first",F,!1,!0),"first",[g],l)},-1),H(R,"$last",function(g){var l=this;return me(l.end["$nil?"]())&&d.$raise(S("RangeError"),"cannot get the maximum of endless range"),me(null==g)?l.end:l.$to_a().$last(g)},-1),H(R,"$max",function F(){var g=F.$$p||L,l=this;return F.$$p=null,me(l.end["$nil?"]())?d.$raise(S("RangeError"),"cannot get the maximum of endless range"):g!==L?$(l,x(l,"max",F,!1,!0),"max",[],g):ee(l.begin["$nil?"]())&&(me(B(l.begin,l.end))||me(l.excl)&&G(l.begin,l.end))?L:l.excl?l.end-1:l.end}),H(R,"$min",function F(){var g=F.$$p||L,l=this;return F.$$p=null,me(l.begin["$nil?"]())?d.$raise(S("RangeError"),"cannot get the minimum of beginless range"):g!==L?$(l,x(l,"min",F,!1,!0),"min",[],g):ee(l.end["$nil?"]())&&(me(B(l.begin,l.end))||me(l.excl)&&G(l.begin,l.end))?L:l.begin}),H(R,"$size",function(){var g=this,l=L,c=L,f=L;return l=S(S("Float"),"INFINITY"),G(g.begin,l)&&ee(g.end["$nil?"]())||G(g.end,l["$-@"]())&&ee(g.begin["$nil?"]())?0:me(N(g))?l:D(S("Numeric"),g.begin)&&D(S("Numeric"),g.end)?(c=g.begin,f=g.end,me(g.excl)&&(f=Z(f,1)),me(O(f,c))?0:(Math.abs(f-c)+1).$to_i()):L}),H(R,"$step",function F(g){var l=F.$$p||L,c=this,f=L,u=L;function p(){null==g?g=1:g.$$is_number||(g=T["$coerce_to!"](g,S("Integer"),"to_int")),g<0?d.$raise(S("ArgumentError"),"step can't be negative"):0===g&&d.$raise(S("ArgumentError"),"step can't be 0")}return F.$$p=null,l===L?(me(c.begin["$is_a?"](k("Numeric")))||me(c.begin["$nil?"]()))&&(me(c.end["$is_a?"](k("Numeric")))||me(c.end["$nil?"]()))&&ee(me(f=c.begin["$nil?"]())?c.end["$nil?"]():f)?S(S("Enumerator"),"ArithmeticSequence").$new(c,g,"step"):Y(c,"enum_for",["step",g],function(){return p(),function _(){if(!c.begin["$respond_to?"]("succ")||c.begin.$$is_string&&c.end.$$is_string)return L;if(g%1==0)return j(c.$size(),g).$ceil();var ke,y=c.begin,m=c.end,ne=Math.abs,se=Math.floor,Ee=(ne(y)+ne(m)+ne(m-y))/ne(g)*S(S("Float"),"EPSILON");return Ee>.5&&(Ee=.5),c.excl?(ke=se((m-y)/g-Ee))*g+y<m&&ke++:ke=se((m-y)/g+Ee)+1,ke}()}):(p(),me(c.begin.$$is_number&&c.end.$$is_number)?(u=0,function(){try{var y=K("break");Y(c,"loop",[],function m(){var se,ne=null==m.$$s?this:m.$$s;return null==ne.begin&&(ne.begin=L),null==ne.excl&&(ne.excl=L),null==ne.end&&(ne.end=L),se=oe(ne.begin,z(u,g)),me(ne.excl)?me(q(se,ne.end))&&y.$throw():me(B(se,ne.end))&&y.$throw(),C.yield1(l,se),u=oe(u,1)},{$$s:c})}catch(m){if(m===y)return m.$v;throw m}}()):(c.begin.$$is_string&&c.end.$$is_string&&g%1!=0&&d.$raise(S("TypeError"),"no implicit conversion to float from string"),Y(c,"each_with_index",[],function(m,ne){return null==m&&(m=L),null==ne&&(ne=L),G(ne["$%"](g),0)?C.yield1(l,m):L})),c)},-1),H(R,"$%",function(g){var l=this;return me(l.begin["$is_a?"](k("Numeric")))&&me(l.end["$is_a?"](k("Numeric")))?S(S("Enumerator"),"ArithmeticSequence").$new(l,g,"%"):l.$step(g)}),H(R,"$bsearch",function F(){var g=F.$$p||L,l=this;return F.$$p=null,g===L?l.$enum_for("bsearch"):(me(N(l)&&(l.begin.$$is_number||l.end.$$is_number))&&d.$raise(S("NotImplementedError"),"Can't #bsearch an infinite range"),me(l.begin.$$is_number&&l.end.$$is_number)||d.$raise(S("TypeError"),"can't do binary search for "+l.begin.$class()),Y(l.$to_a(),"bsearch",[],g.$to_proc()))}),H(R,"$to_s",function(){var g=this,l=L;return(me(l=g.begin)?l:"")+(me(g.excl)?"...":"..")+(me(l=g.end)?l:"")}),H(R,"$inspect",function(){var g=this,l=L;return(me(l=g.begin)?g.begin.$inspect():l)+(me(g.excl)?"...":"..")+(me(l=g.end)?g.end.$inspect():l)}),H(R,"$marshal_load",function(g){var l=this;return l.begin=g["$[]"]("begin"),l.end=g["$[]"]("end"),l.excl=g["$[]"]("excl")}),H(R,"$hash",function(){var g=this;return[g.begin,g.end,g.excl].$hash()}),I(R,"==","eql?"),I(R,"include?","cover?"),I(R,"member?","cover?")}()},Opal.modules["corelib/proc"]=function(C){var j,le=C.slice,d=C.truthy,H=C.Kernel,ee=C.defs,$=C.def,x=C.send,O=C.to_a,E=C.return_self,Y=C.ensure_kwargs,G=C.Opal,D=C.alias,W=C.nil,B=C.$$$;return j=(0,C.klass)("::",Function,"Proc"),C.prop(j.$$prototype,"$$is_proc",!0),C.prop(j.$$prototype,"$$is_lambda",!1),ee(j,"$new",function oe(){var z=oe.$$p||W;return oe.$$p=null,d(z)||H.$raise(B("ArgumentError"),"tried to create a Proc object without a block"),z}),$(j,"$call",function oe(z){var I,q=oe.$$p||W,A=this;oe.$$p=null,I=le(arguments),q!==W&&(A.$$p=q);var J,L=A.$$brk,S=A.$$ret;if(L||S&&A.$$is_lambda)try{J=A.$$is_lambda?A.apply(null,I):C.yieldX(A,I)}catch(M){if(M===L)return M.$v;if(A.$$is_lambda&&M===S)return M.$v;throw M}else J=A.$$is_lambda?A.apply(null,I):C.yieldX(A,I);return J},-1),$(j,"$>>",function oe(z){return oe.$$p=null,x(H,"proc",[],function I(A){var L,J=I.$$p||W,M=null==I.$$s?this:I.$$s,v=W;return I.$$p=null,L=le(arguments),v=x(M,"call",O(L),J.$to_proc()),z.$call(v)},{$$arity:-1,$$s:this})}),$(j,"$<<",function oe(z){return oe.$$p=null,x(H,"proc",[],function I(A){var L,J=I.$$p||W,M=null==I.$$s?this:I.$$s,v=W;return I.$$p=null,L=le(arguments),v=x(z,"call",O(L),J.$to_proc()),M.$call(v)},{$$arity:-1,$$s:this})}),$(j,"$to_proc",E),$(j,"$lambda?",function(){return!!this.$$is_lambda}),$(j,"$arity",function(){var z=this;return z.$$is_curried?-1:null!=z.$$arity?z.$$arity:z.length}),$(j,"$source_location",function(){var q=W;return this.$$is_curried?W:d(q=this.$$source_location)?q:W}),$(j,"$binding",function(){var q=this;return q.$$is_curried&&H.$raise(B("ArgumentError"),"Can't create Binding"),d(B("::","Binding","skip_raise")?"constant":W)?B("Binding").$new(W,[],q.$$s,q.$source_location()):W}),$(j,"$parameters",function(z){var q,K=this;if(q=(z=Y(z)).$$smap.lambda,K.$$is_curried)return[["rest"]];if(K.$$parameters){if(null==q?K.$$is_lambda:q)return K.$$parameters;var A,J,I=[];for(A=0,J=K.$$parameters.length;A<J;A++){var L=K.$$parameters[A];"req"===L[0]&&(L=["opt",L[1]]),I.push(L)}return I}return[]},-1),$(j,"$curry",function(z){var q=this;function K(){var J,I=le(arguments),A=I.length;return A>z&&q.$$is_lambda&&!q.$$is_curried&&H.$raise(B("ArgumentError"),"wrong number of arguments ("+A+" for "+z+")"),A>=z?q.$call.apply(q,I):(J=function(){return K.apply(null,I.concat(le(arguments)))},J.$$is_lambda=q.$$is_lambda,J.$$is_curried=!0,J)}return void 0===z?z=q.length:(z=G["$coerce_to!"](z,B("Integer"),"to_int"),q.$$is_lambda&&z!==q.length&&H.$raise(B("ArgumentError"),"wrong number of arguments ("+z+" for "+q.length+")")),K.$$is_lambda=q.$$is_lambda,K.$$is_curried=!0,K},-1),$(j,"$dup",function(){var z=this,q=z.$$original_proc||z,K=function(){return q.apply(this,arguments)};for(var I in z)z.hasOwnProperty(I)&&(K[I]=z[I]);return K}),D(j,"===","call"),D(j,"clone","dup"),D(j,"yield","call"),D(j,"[]","call")},Opal.modules["corelib/method"]=function(C){var W,B,le=C.klass,me=C.def,d=C.truthy,H=C.slice,ee=C.alias,$=C.Kernel,x=C.send,O=C.to_a,E=C.nil,Y=C.$$$;return(B=(W=le("::",null,"Method")).$$prototype).method=B.receiver=B.owner=B.name=E,W.$attr_reader("owner","receiver","name"),me(W,"$initialize",function(T,j,oe,z){var q=this;return q.receiver=T,q.owner=j,q.name=z,q.method=oe}),me(W,"$arity",function(){return this.method.$arity()}),me(W,"$parameters",function(){return this.method.$$parameters}),me(W,"$source_location",function(){var j;return d(j=this.method.$$source_location)?j:["(eval)",0]}),me(W,"$comments",function(){var j;return d(j=this.method.$$comments)?j:[]}),me(W,"$call",function Z(T){var z,j=Z.$$p||E,q=this;return Z.$$p=null,z=H(arguments),q.method.$$p=j,q.method.apply(q.receiver,z)},-1),me(W,"$curry",function(T){return this.method.$curry(T)},-1),me(W,"$>>",function(T){return this.method["$>>"](T)}),me(W,"$<<",function(T){return this.method["$<<"](T)}),me(W,"$unbind",function(){var T=this;return Y("UnboundMethod").$new(T.receiver.$class(),T.owner,T.method,T.name)}),me(W,"$to_proc",function(){var T=this,j=T.$call.bind(T);return j.$$unbound=T.method,j.$$is_lambda=!0,j.$$arity=null==T.method.$$arity?T.method.length:T.method.$$arity,j.$$parameters=T.method.$$parameters,j}),me(W,"$inspect",function(){var T=this;return"#<"+T.$class()+": "+T.receiver.$class()+"#"+T.name+" (defined in "+T.owner+" in "+T.$source_location().$join(":")+")>"}),ee(W,"[]","call"),ee(W,"===","call"),function(G,D){var W=le("::",null,"UnboundMethod"),B=W.$$prototype;return B.method=B.owner=B.name=B.source=E,W.$attr_reader("source","owner","name"),me(W,"$initialize",function(T,j,oe,z){var q=this;return q.source=T,q.owner=j,q.method=oe,q.name=z}),me(W,"$arity",function(){return this.method.$arity()}),me(W,"$parameters",function(){return this.method.$$parameters}),me(W,"$source_location",function(){var j;return d(j=this.method.$$source_location)?j:["(eval)",0]}),me(W,"$comments",function(){var j;return d(j=this.method.$$comments)?j:[]}),me(W,"$bind",function(T){var j=this;if(j.owner.$$is_module||C.is_a(T,j.owner))return Y("Method").$new(T,j.owner,j.method,j.name);$.$raise(Y("TypeError"),"can't bind singleton method to a different class (expected "+T+".kind_of?("+j.owner+" to be true)")}),me(W,"$bind_call",function Z(T,j){var q,oe=Z.$$p||E,K=this;return Z.$$p=null,q=H(arguments,1),x(K.$bind(T),"call",O(q),oe.$to_proc())},-2),me(W,"$inspect",function(){var T=this;return"#<"+T.$class()+": "+T.source+"#"+T.name+" (defined in "+T.owner+" in "+T.$source_location().$join(":")+")>"})}()},Opal.modules["corelib/variables"]=function(C){var le=C.gvars,me=C.const_set,d=C.Object,H=C.hash2,ee=C.nil;return le["&"]=le["~"]=le["`"]=le["'"]=ee,le.LOADED_FEATURES=le['"']=C.loaded_features,le.LOAD_PATH=le[":"]=[],le["/"]="\n",le[","]=ee,me("::","ARGV",[]),me("::","ARGF",d.$new()),me("::","ENV",H([],{})),le.VERBOSE=!1,le.DEBUG=!1,le.SAFE=0},Opal.modules["corelib/io"]=function(C){var I,v,P,me=C.const_set,d=C.not,H=C.truthy,ee=C.def,$=C.return_ivar,x=C.return_val,O=C.slice,E=C.Kernel,Y=C.gvars,G=C.send,D=C.to_a,W=C.rb_plus,B=C.neqeq,Z=C.range,T=C.hash2,j=C.eqeq,oe=C.to_ary,z=C.rb_gt,q=C.assign_ivar_val,K=C.alias,A=C.nil,J=C.$$$;(P=(v=(0,C.klass)("::",null,"IO")).$$prototype).read_buffer=P.closed=A,me(v,"SEEK_SET",0),me(v,"SEEK_CUR",1),me(v,"SEEK_END",2),me(v,"SEEK_DATA",3),me(v,"SEEK_HOLE",4),me(v,"READABLE",1),me(v,"WRITABLE",4),v.$attr_reader("eof"),v.$attr_accessor("read_proc","sync","tty","write_proc"),ee(v,"$initialize",function(te,k){var de=this;return null==k&&(k="r"),de.fd=te,de.flags=k,de.eof=!1,H(k["$include?"]("r"))&&d(k["$match?"](/[wa+]/))?de.closed="write":H(k["$match?"](/[wa]/))&&d(k["$match?"](/[r+]/))?de.closed="read":A},-2),ee(v,"$fileno",$("fd")),ee(v,"$tty?",function(){return 1==this.tty}),ee(v,"$write",function(te){return this.write_proc(te),te.$size()}),ee(v,"$flush",x(A)),ee(v,"$<<",function(te){return this.$write(te),this}),ee(v,"$print",function(te){var de,N=this;null==Y[","]&&(Y[","]=A);for(var F=0,g=(de=O(arguments)).length;F<g;F++)de[F]=E.$String(de[F]);return N.$write(de.join(Y[","])),A},-1),ee(v,"$puts",function(te){var de,F,N=this;if(0===(de=O(arguments)).length)return N.$write("\n"),A;for(var g=0,l=de.length;g<l;g++)if(de[g].$$is_array){var c=de[g].$flatten();c.length>0&&G(N,"puts",D(c))}else(F=de[g].$$is_string?de[g].valueOf():E.$String(de[g])).endsWith("\n")||(F+="\n"),N.$write(F);return A},-1),ee(v,"$getc",function(){var k,te=this,de=A,N=A;te.read_buffer=H(k=te.read_buffer)?k:"",de="";do{if(te.read_buffer=W(te.read_buffer,de),B(te.read_buffer,""))return N=te.read_buffer["$[]"](0),te.read_buffer=te.read_buffer["$[]"](Z(1,-1,!1)),N}while(H(de=te.$sysread_noraise(1)));return A}),ee(v,"$getbyte",function(){var te;return(te=this.$getc())===A||null==te?A:te.$ord()}),ee(v,"$readbyte",function(){return this.$readchar().$ord()}),ee(v,"$readchar",function(){var k;return H(k=this.$getc())?k:E.$raise(J("EOFError"),"end of file reached")}),ee(v,"$readline",function(te){var k,N=this,F=A;return k=O(arguments),H(F=G(N,"gets",D(k)))?F:E.$raise(J("EOFError"),"end of file reached")},-1),ee(v,"$gets",function(te,k,de){var N,F,l,f,g=this,c=A,u=A,p=A,_=A;null==Y["/"]&&(Y["/"]=A),null==te&&(te=!1),null==k&&(k=A),null==de&&(de=T([],{})),H(te.$$is_number)&&d(k)&&(te=(N=[!1,te,k])[0],k=N[1],de=N[2]),H(te.$$is_hash)&&d(k)&&j(de,T([],{}))?(te=(N=[!1,A,te])[0],k=N[1],de=N[2]):H(k.$$is_hash)&&j(de,T([],{}))&&(te=(N=[te,A,k])[0],k=N[1],de=N[2]),l=te,j(te,!1)&&(te=Y["/"]),j(te,"")&&(te=/\r?\n\r?\n/),te=H(c=te)?c:"",j(l,"")||(te=te.$to_str()),f=j(l,"")?2:te.$length(),j(te," ")&&(te=/ /),g.read_buffer=H(c=g.read_buffer)?c:"",u="",p=A;do{if(g.read_buffer=W(g.read_buffer,u),B(te,"")&&H(H(te.$$is_regexp)?g.read_buffer["$match?"](te):g.read_buffer["$include?"](te))){_=g.read_buffer,F=g.read_buffer.$split(te,2),p=null==(N=oe(F))[0]?A:N[0],g.read_buffer=null==N[1]?A:N[1],B(p,_)&&(p=W(p,_["$[]"](p.$length(),f)));break}}while(H(u=g.$sysread_noraise(j(te,"")?65536:1)));return H(p)||(p=(N=[H(c=g.read_buffer)?c:"",""])[0],g.read_buffer=N[1],j(p,"")&&(p=A)),H(p)&&(H(k)&&(p=p["$[]"](C.Range.$new(0,k,!0)),g.read_buffer=W(p["$[]"](C.Range.$new(k,-1,!1)),g.read_buffer)),H(de["$[]"]("chomp"))&&(p=p.$sub(/\r?\n$/,"")),j(l,"")&&(p=p.$sub(/^[\r\n]+/,""))),j(l,!1)&&(Y._=p),p},-1),ee(v,"$sysread",function(te){var de;return H(de=this.read_proc(te))?de:(this.eof=!0,E.$raise(J("EOFError"),"end of file reached"))}),ee(v,"$sysread_noraise",function(te){try{return this.$sysread(te)}catch(de){if(!C.rescue(de,[J("EOFError")]))throw de;try{return A}finally{C.pop_exception()}}}),ee(v,"$readpartial",function(te){var k,F,de=this,N=A,g=A;return de.read_buffer=H(N=de.read_buffer)?N:"",F=de.$sysread(te),g=(k=[W(de.read_buffer,H(N=F)?N:""),""])[0],de.read_buffer=k[1],j(g,"")&&(g=A),g}),ee(v,"$read",function(te){var k,de=this,N=A,F=A,g=A;null==te&&(te=A),de.read_buffer=H(N=de.read_buffer)?N:"",F="",g=A;do{if(de.read_buffer=W(de.read_buffer,F),H(te)&&H(z(de.read_buffer.$length(),te)))return g=(k=[de.read_buffer["$[]"](C.Range.$new(0,te,!0)),de.read_buffer["$[]"](C.Range.$new(te,-1,!1))])[0],de.read_buffer=k[1],g}while(H(F=de.$sysread_noraise(H(N=te)?N:65536)));return g=(k=[de.read_buffer,""])[0],de.read_buffer=k[1],g},-1),ee(v,"$readlines",function(te){return null==Y["/"]&&(Y["/"]=A),null==te&&(te=Y["/"]),this.$each_line(te).$to_a()},-1),ee(v,"$each",function R(te,k){var N,F,g,de=R.$$p||A,l=this,c=A;if(null==Y["/"]&&(Y["/"]=A),R.$$p=null,(N=O(arguments)).length>0&&(F=N.shift()),null==F&&(F=Y["/"]),g=N,de===A)return G(l,"enum_for",["each",F].concat(D(g)));for(;H(c=G(l,"gets",[F].concat(D(g))));)C.yield1(de,c);return l},-1),ee(v,"$each_byte",function R(){var te=R.$$p||A,k=this,de=A;if(R.$$p=null,te===A)return k.$enum_for("each_byte");for(;H(de=k.$getbyte());)C.yield1(te,de);return k}),ee(v,"$each_char",function R(){var te=R.$$p||A,k=this,de=A;if(R.$$p=null,te===A)return k.$enum_for("each_char");for(;H(de=k.$getc());)C.yield1(te,de);return k}),ee(v,"$close",q("closed","both")),ee(v,"$close_read",function(){return this.closed=j(this.closed,"write")?"both":"read"}),ee(v,"$close_write",function(){return this.closed=j(this.closed,"read")?"both":"write"}),ee(v,"$closed?",function(){return this.closed["$=="]("both")}),ee(v,"$closed_read?",function(){var k;return H(k=this.closed["$=="]("read"))?k:this.closed["$=="]("both")}),ee(v,"$closed_write?",function(){var k;return H(k=this.closed["$=="]("write"))?k:this.closed["$=="]("both")}),ee(v,"$check_writable",function(){return H(this["$closed_write?"]())?E.$raise(J("IOError"),"not opened for writing"):A}),ee(v,"$check_readable",function(){return H(this["$closed_read?"]())?E.$raise(J("IOError"),"not opened for reading"):A}),K(v,"each_line","each"),K(v,"eof?","eof"),me("::","STDIN",Y.stdin=J("IO").$new(0,"r")),me("::","STDOUT",Y.stdout=J("IO").$new(1,"w")),me("::","STDERR",Y.stderr=J("IO").$new(2,"w"));var L=C.global.console;return J("STDOUT")["$write_proc="]("object"==typeof process&&"object"==typeof process.stdout?function(S){process.stdout.write(S)}:function(S){L.log(S)}),J("STDERR")["$write_proc="]("object"==typeof process&&"object"==typeof process.stderr?function(S){process.stderr.write(S)}:function(S){L.warn(S)}),I=[function(S){var M=prompt();return null!==M?M+"\n":A}],G(J("STDIN"),"read_proc=",I),I[I.length-1]},Opal.modules["opal/regexp_anchors"]=function(C){var x,O,E,Y,me=C.const_set,d=[],ee=C.$$$;return x=d,E=[O=(0,C.module)(d[0],"Opal")].concat(x),Y=C.$r(E),me(O,"REGEXP_START","^"),me(O,"REGEXP_END","$"),me(O,"FORBIDDEN_STARTING_IDENTIFIER_CHARS","\\u0001-\\u002F\\u003A-\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),me(O,"FORBIDDEN_ENDING_IDENTIFIER_CHARS","\\u0001-\\u0020\\u0022-\\u002F\\u003A-\\u003E\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),me(O,"INLINE_IDENTIFIER_REGEXP",Y("Regexp").$new("[^"+ee(O,"FORBIDDEN_STARTING_IDENTIFIER_CHARS")+"]*[^"+ee(O,"FORBIDDEN_ENDING_IDENTIFIER_CHARS")+"]")),me(O,"FORBIDDEN_CONST_NAME_CHARS","\\u0001-\\u0020\\u0021-\\u002F\\u003B-\\u003F\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),me(O,"CONST_NAME_REGEXP",Y("Regexp").$new(ee(O,"REGEXP_START")+"(::)?[A-Z][^"+ee(O,"FORBIDDEN_CONST_NAME_CHARS")+"]*"+ee(O,"REGEXP_END")))},Opal.modules["opal/mini"]=function(C){var le=C.Object;return le.$require("opal/base"),le.$require("corelib/nil"),le.$require("corelib/boolean"),le.$require("corelib/string"),le.$require("corelib/comparable"),le.$require("corelib/enumerable"),le.$require("corelib/enumerator"),le.$require("corelib/array"),le.$require("corelib/hash"),le.$require("corelib/number"),le.$require("corelib/range"),le.$require("corelib/proc"),le.$require("corelib/method"),le.$require("corelib/regexp"),le.$require("corelib/variables"),le.$require("corelib/io"),le.$require("opal/regexp_anchors")},Opal.modules["corelib/kernel/format"]=function(C){var B,le=C.coerce_to,d=C.slice,H=C.truthy,ee=C.eqeq,$=C.Opal,x=C.Kernel,O=C.gvars,Y=C.alias,G=C.nil,D=C.$$$;return(0,C.def)(B=(0,C.module)("::","Kernel"),"$format",function(T,j){var oe,z,q=G;null==O.DEBUG&&(O.DEBUG=G),oe=d(arguments,1),ee((z=oe).$length(),1)&&H(z["$[]"](0)["$respond_to?"]("to_ary"))&&(q=$["$coerce_to?"](z["$[]"](0),D("Array"),"to_ary"),H(q["$nil?"]())||(z=q.$to_a()));var A,J,S,M,v,P,R,te,k,de,N,F,g,l,c,p,K="",I=0,L=T.length,f=1,u=0,_=0,y=1,m=2,ne=4,se=8,Ee=16,ke=32,ce=64,Me=128;function $e(){p&ke&&x.$raise(D("ArgumentError"),"flag after width"),p&Me&&x.$raise(D("ArgumentError"),"flag after precision")}function be(){p&ke&&x.$raise(D("ArgumentError"),"width given twice"),p&Me&&x.$raise(D("ArgumentError"),"width after precision")}function he(b){return b>=z.length&&x.$raise(D("ArgumentError"),"too few arguments"),z[b]}function Se(){switch(u){case-1:x.$raise(D("ArgumentError"),"unnumbered("+f+") mixed with numbered");case-2:x.$raise(D("ArgumentError"),"unnumbered("+f+") mixed with named")}return he((u=f++)-1)}function ve(b){return u>0&&x.$raise(D("ArgumentError"),"numbered("+b+") after unnumbered("+u+")"),-2===u&&x.$raise(D("ArgumentError"),"numbered("+b+") after named"),b<1&&x.$raise(D("ArgumentError"),"invalid index - "+b+"$"),u=-1,he(b-1)}function ae(){return void 0===c?Se():c}function ue(b){for(var V,ge="";;J++){if(J===L&&x.$raise(D("ArgumentError"),"malformed format string - %*[0-9]"),T.charCodeAt(J)<48||T.charCodeAt(J)>57)return J--,(V=parseInt(ge,10)||0)>2147483647&&x.$raise(D("ArgumentError"),b+" too big"),V;ge+=T.charAt(J)}}function Ce(b){var V,ge=ue(b);return"$"===T.charAt(J+1)?(J++,V=ve(ge)):V=Se(),V.$to_int()}for(J=T.indexOf("%");-1!==J;J=T.indexOf("%",J)){switch(M=void 0,p=_,P=-1,R=-1,c=void 0,A=J,J++,T.charAt(J)){case"%":I=J;case"":case"\n":case"\0":J++;continue}e:for(;J<L;J++)switch(T.charAt(J)){case" ":$e(),p|=Ee;continue e;case"#":$e(),p|=y;continue e;case"+":$e(),p|=ne;continue e;case"-":$e(),p|=m;continue e;case"0":$e(),p|=se;continue e;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":if(te=ue("width"),"$"===T.charAt(J+1)){if(J+2===L){M="%",J++;break e}void 0!==c&&x.$raise(D("ArgumentError"),"value given twice - %"+te+"$"),c=ve(te),J++}else be(),p|=ke,P=te;continue e;case"<":case"{":for(de="<"===T.charAt(J)?">":"}",k="",J++;;J++){if(J===L&&x.$raise(D("ArgumentError"),"malformed name - unmatched parenthesis"),T.charAt(J)===de){if(u>0&&x.$raise(D("ArgumentError"),"named "+k+" after unnumbered("+u+")"),-1===u&&x.$raise(D("ArgumentError"),"named "+k+" after numbered"),u=-2,(void 0===z[0]||!z[0].$$is_hash)&&x.$raise(D("ArgumentError"),"one hash required"),c=z[0].$fetch(k),">"===de)continue e;if(M=c.toString(),-1!==R&&(M=M.slice(0,R)),p&m)for(;M.length<P;)M+=" ";else for(;M.length<P;)M=" "+M;break e}k+=T.charAt(J)}case"*":J++,be(),p|=ke,(P=Ce("width"))<0&&(p|=m,P=-P);continue e;case".":if(p&Me&&x.$raise(D("ArgumentError"),"precision given twice"),p|=ce|Me,R=0,J++,"*"===T.charAt(J)){J++,(R=Ce("precision"))<0&&(p&=~ce);continue e}R=ue("precision");continue e;case"d":case"i":case"u":if((S=x.$Integer(ae()))>=0){for(M=S.toString();M.length<R;)M="0"+M;if(p&m)for((p&ne||p&Ee)&&(M=(p&ne?"+":" ")+M);M.length<P;)M+=" ";else if(p&se&&-1===R){for(;M.length<P-(p&ne||p&Ee?1:0);)M="0"+M;(p&ne||p&Ee)&&(M=(p&ne?"+":" ")+M)}else for((p&ne||p&Ee)&&(M=(p&ne?"+":" ")+M);M.length<P;)M=" "+M}else{for(M=(-S).toString();M.length<R;)M="0"+M;if(p&m)for(M="-"+M;M.length<P;)M+=" ";else if(p&se&&-1===R){for(;M.length<P-1;)M="0"+M;M="-"+M}else for(M="-"+M;M.length<P;)M=" "+M}break e;case"b":case"B":case"o":case"x":case"X":switch(T.charAt(J)){case"b":case"B":N=2,F="0b",g=/^1+/,l="1";break;case"o":N=8,F="0",g=/^3?7+/,l="7";break;case"x":case"X":N=16,F="0x",g=/^f+/,l="f"}if((S=x.$Integer(ae()))>=0){for(M=S.toString(N);M.length<R;)M="0"+M;if(p&m)for((p&ne||p&Ee)&&(M=(p&ne?"+":" ")+M),p&y&&0!==S&&(M=F+M);M.length<P;)M+=" ";else if(p&se&&-1===R){for(;M.length<P-(p&ne||p&Ee?1:0)-(p&y&&0!==S?F.length:0);)M="0"+M;p&y&&0!==S&&(M=F+M),(p&ne||p&Ee)&&(M=(p&ne?"+":" ")+M)}else for(p&y&&0!==S&&(M=F+M),(p&ne||p&Ee)&&(M=(p&ne?"+":" ")+M);M.length<P;)M=" "+M}else if(p&ne||p&Ee){for(M=(-S).toString(N);M.length<R;)M="0"+M;if(p&m)for(p&y&&(M=F+M),M="-"+M;M.length<P;)M+=" ";else if(p&se&&-1===R){for(;M.length<P-1-(p&y?2:0);)M="0"+M;p&y&&(M=F+M),M="-"+M}else for(p&y&&(M=F+M),M="-"+M;M.length<P;)M=" "+M}else{for(M=(S>>>0).toString(N).replace(g,l);M.length<R-2;)M=l+M;if(p&m)for(M=".."+M,p&y&&(M=F+M);M.length<P;)M+=" ";else if(p&se&&-1===R){for(;M.length<P-2-(p&y?F.length:0);)M=l+M;M=".."+M,p&y&&(M=F+M)}else for(M=".."+M,p&y&&(M=F+M);M.length<P;)M=" "+M}T.charAt(J)===T.charAt(J).toUpperCase()&&(M=M.toUpperCase());break e;case"f":case"e":case"E":case"g":case"G":if((S=x.$Float(ae()))>=0||isNaN(S)){if(S===1/0)M="Inf";else switch(T.charAt(J)){case"f":M=S.toFixed(-1===R?6:R);break;case"e":case"E":M=S.toExponential(-1===R?6:R);break;case"g":case"G":M=S.toExponential(),(v=parseInt(M.split("e")[1],10))<-4||v>=(-1===R?6:R)||(M=S.toPrecision(-1===R?p&y?6:void 0:R))}if(p&m)for((p&ne||p&Ee)&&(M=(p&ne?"+":" ")+M);M.length<P;)M+=" ";else if(p&se&&S!==1/0&&!isNaN(S)){for(;M.length<P-(p&ne||p&Ee?1:0);)M="0"+M;(p&ne||p&Ee)&&(M=(p&ne?"+":" ")+M)}else for((p&ne||p&Ee)&&(M=(p&ne?"+":" ")+M);M.length<P;)M=" "+M}else{if(S===-1/0)M="Inf";else switch(T.charAt(J)){case"f":M=(-S).toFixed(-1===R?6:R);break;case"e":case"E":M=(-S).toExponential(-1===R?6:R);break;case"g":case"G":M=(-S).toExponential(),(v=parseInt(M.split("e")[1],10))<-4||v>=(-1===R?6:R)||(M=(-S).toPrecision(-1===R?p&y?6:void 0:R))}if(p&m)for(M="-"+M;M.length<P;)M+=" ";else if(p&se&&S!==-1/0){for(;M.length<P-1;)M="0"+M;M="-"+M}else for(M="-"+M;M.length<P;)M=" "+M}T.charAt(J)===T.charAt(J).toUpperCase()&&S!==1/0&&S!==-1/0&&!isNaN(S)&&(M=M.toUpperCase()),M=M.replace(/([eE][-+]?)([0-9])$/,"$10$2");break e;case"a":case"A":x.$raise(D("NotImplementedError"),"`A` and `a` format field types are not implemented in Opal yet");case"c":if((S=ae())["$respond_to?"]("to_ary")&&(S=S.$to_ary()[0]),1!==(M=S["$respond_to?"]("to_str")?S.$to_str():String.fromCharCode(le(S,D("Integer"),"to_int"))).length&&x.$raise(D("ArgumentError"),"%c requires a character"),p&m)for(;M.length<P;)M+=" ";else for(;M.length<P;)M=" "+M;break e;case"p":if(M=ae().$inspect(),-1!==R&&(M=M.slice(0,R)),p&m)for(;M.length<P;)M+=" ";else for(;M.length<P;)M=" "+M;break e;case"s":if(M=ae().$to_s(),-1!==R&&(M=M.slice(0,R)),p&m)for(;M.length<P;)M+=" ";else for(;M.length<P;)M=" "+M;break e;default:x.$raise(D("ArgumentError"),"malformed format string - %"+T.charAt(J))}void 0===M&&x.$raise(D("ArgumentError"),"malformed format string - %"),K+=T.slice(I,A)+M,I=J+1}return O.DEBUG&&u>=0&&f<z.length&&x.$raise(D("ArgumentError"),"too many arguments for format string"),K+T.slice(I)},-2),Y(B,"sprintf","format")},Opal.modules["corelib/string/encoding"]=function(C){var Z,A,J,le=C.klass,me=C.hash2,d=C.rb_plus,H=C.truthy,ee=C.send,$=C.defs,x=C.eqeq,O=C.def,E=C.return_ivar,Y=C.return_val,G=C.slice,D=C.Kernel,W=C.Opal,B=C.rb_lt,T=C.top,oe=C.$r([]),z=C.nil,q=C.$$$;return T.$require("corelib/string"),(J=(A=le("::",null,"Encoding")).$$prototype).name=J.dummy=z,$(A,"$register",function L(S,M){var R,k,de,v=L.$$p||z,te=z,N=z,F=z;return L.$$p=null,null==M&&(M=me([],{})),R=d([S],H(te=M["$[]"]("aliases"))?te:[]),k=H(te=M["$[]"]("ascii"))&&te,de=H(te=M["$[]"]("dummy"))&&te,H(M["$[]"]("inherits"))?(N=M["$[]"]("inherits").$clone()).$initialize(S,R,k,de):N=this.$new(S,R,k,de),v!==z&&ee(N,"instance_eval",[],v.$to_proc()),F=C.encodings,ee(R,"each",[],function g(l){return null==l&&(l=z),(null==g.$$s?this:g.$$s).$const_set(l.$tr("-","_"),N),F[l]=N},{$$s:this})},-2),$(A,"$find",function(S){return x(S,"default_external")?this.$default_external():C.find_encoding(S)}),A.$singleton_class().$attr_accessor("default_external"),A.$attr_reader("name","names"),O(A,"$initialize",function(S,M,v,P){var R=this;return R.name=S,R.names=M,R.ascii=v,R.dummy=P}),O(A,"$ascii_compatible?",E("ascii")),O(A,"$dummy?",E("dummy")),O(A,"$binary?",Y(!1)),O(A,"$to_s",E("name")),O(A,"$inspect",function(){return"#<Encoding:"+this.name+(H(this.dummy)?" (dummy)":z)+">"}),O(A,"$charsize",function(S){for(var M=0,v=0,P=S.length;v<P;v++){var R=S.charCodeAt(v);R>=55296&&R<=56319||M++}return M}),O(A,"$each_char",function L(S){var M=L.$$p||z;L.$$p=null;for(var v="",P=0,R=S.length;P<R;P++){var te=S.charCodeAt(P),k=S.charAt(P);te>=56320&&te<=57343?v=k:(te>=55296&&te<=56319&&(k=v+k),"UTF-8"!=S.encoding.name&&((k=new String(k)).encoding=S.encoding),C.yield1(M,k))}}),O(A,"$each_byte",function(S){return G(arguments),D.$raise(q("NotImplementedError"))},-1),O(A,"$bytesize",function(S){return G(arguments),D.$raise(q("NotImplementedError"))},-1),le("::",q("StandardError"),"EncodingError"),le("::",q("EncodingError"),"CompatibilityError"),ee(q("Encoding"),"register",["UTF-8",me(["aliases","ascii"],{aliases:["CP65001"],ascii:!0})],function K(){var I=null==K.$$s?this:K.$$s;return O(I,"$each_byte",function A(J){var L=A.$$p||z;A.$$p=null;for(var M,S=1/0,v=J.length,P=null,R=0;R<v;++R){if((M=J.charCodeAt(R))>55295&&M<57344){if(!P){if(M>56319){(S-=3)>-1&&(C.yield1(L,239),C.yield1(L,191),C.yield1(L,189));continue}if(R+1===v){(S-=3)>-1&&(C.yield1(L,239),C.yield1(L,191),C.yield1(L,189));continue}P=M;continue}if(M<56320){(S-=3)>-1&&(C.yield1(L,239),C.yield1(L,191),C.yield1(L,189)),P=M;continue}M=65536+(P-55296<<10|M-56320)}else P&&(S-=3)>-1&&(C.yield1(L,239),C.yield1(L,191),C.yield1(L,189));if(P=null,M<128){if((S-=1)<0)break;C.yield1(L,M)}else if(M<2048){if((S-=2)<0)break;C.yield1(L,M>>6|192),C.yield1(L,63&M|128)}else if(M<65536){if((S-=3)<0)break;C.yield1(L,M>>12|224),C.yield1(L,M>>6&63|128),C.yield1(L,63&M|128)}else if(M<1114112){if((S-=4)<0)break;C.yield1(L,M>>18|240),C.yield1(L,M>>12&63|128),C.yield1(L,M>>6&63|128),C.yield1(L,63&M|128)}}}),O(I,"$bytesize",function(J){return J.$bytes().$length()})},{$$s:T}),ee(q("Encoding"),"register",["UTF-16LE"],function K(){var I=null==K.$$s?this:K.$$s;return O(I,"$each_byte",function A(J){var L=A.$$p||z;A.$$p=null;for(var S=0,M=J.length;S<M;S++){var v=J.charCodeAt(S);C.yield1(L,255&v),C.yield1(L,v>>8)}}),O(I,"$bytesize",function(J){return 2*J.length})},{$$s:T}),ee(q("Encoding"),"register",["UTF-16BE",me(["inherits"],{inherits:q(q("Encoding"),"UTF_16LE")})],function K(){return O(null==K.$$s?this:K.$$s,"$each_byte",function A(J){var L=A.$$p||z;A.$$p=null;for(var S=0,M=J.length;S<M;S++){var v=J.charCodeAt(S);C.yield1(L,v>>8),C.yield1(L,255&v)}})},{$$s:T}),ee(q("Encoding"),"register",["UTF-32LE"],function K(){var I=null==K.$$s?this:K.$$s;return O(I,"$each_byte",function A(J){var L=A.$$p||z;A.$$p=null;for(var S=0,M=J.length;S<M;S++){var v=J.charCodeAt(S);C.yield1(L,255&v),C.yield1(L,v>>8),C.yield1(L,0),C.yield1(L,0)}}),O(I,"$bytesize",function(J){return 4*J.length})},{$$s:T}),ee(q("Encoding"),"register",["UTF-32BE",me(["inherits"],{inherits:q(q("Encoding"),"UTF_32LE")})],function K(){return O(null==K.$$s?this:K.$$s,"$each_byte",function A(J){var L=A.$$p||z;A.$$p=null;for(var S=0,M=J.length;S<M;S++){var v=J.charCodeAt(S);C.yield1(L,0),C.yield1(L,0),C.yield1(L,v>>8),C.yield1(L,255&v)}})},{$$s:T}),ee(q("Encoding"),"register",["ASCII-8BIT",me(["aliases","ascii"],{aliases:["BINARY"],ascii:!0})],function K(){var I=null==K.$$s?this:K.$$s;return O(I,"$each_char",function A(J){var L=A.$$p||z;A.$$p=null;for(var S=0,M=J.length;S<M;S++){var v=new String(J.charAt(S));v.encoding=J.encoding,C.yield1(L,v)}}),O(I,"$charsize",function(J){return J.length}),O(I,"$each_byte",function A(J){var L=A.$$p||z;A.$$p=null;for(var S=0,M=J.length;S<M;S++){var v=J.charCodeAt(S);C.yield1(L,255&v)}}),O(I,"$bytesize",function(J){return J.length}),O(I,"$binary?",Y(!0))},{$$s:T}),q("Encoding").$register("ISO-8859-1",me(["aliases","ascii","inherits"],{aliases:["ISO8859-1"],ascii:!0,inherits:q(q("Encoding"),"ASCII_8BIT")})),q("Encoding").$register("US-ASCII",me(["aliases","ascii","inherits"],{aliases:["ASCII"],ascii:!0,inherits:q(q("Encoding"),"ASCII_8BIT")})),function(K,I){var A=le("::",null,"String"),J=A.$$prototype;J.internal_encoding=J.bytes=J.encoding=z,A.$attr_reader("encoding"),A.$attr_reader("internal_encoding"),C.prop(String.prototype,"bytes",z),C.prop(String.prototype,"encoding",q(q("Encoding"),"UTF_8")),C.prop(String.prototype,"internal_encoding",q(q("Encoding"),"UTF_8")),O(A,"$b",function(){return this.$dup().$force_encoding("binary")}),O(A,"$bytesize",function(){return this.internal_encoding.$bytesize(this)}),O(A,"$each_byte",function L(){var S=L.$$p||z,M=this;return L.$$p=null,S===z?ee(M,"enum_for",["each_byte"],function v(){return(null==v.$$s?this:v.$$s).$bytesize()},{$$s:M}):(ee(M.internal_encoding,"each_byte",[M],S.$to_proc()),M)}),O(A,"$bytes",function(){var S=this,M=z;return"string"==typeof S?new String(S).$each_byte().$to_a():(S.bytes=H(M=S.bytes)?M:S.$each_byte().$to_a(),S.bytes.$dup())}),O(A,"$each_char",function L(){var S=L.$$p||z,M=this;return L.$$p=null,S===z?ee(M,"enum_for",["each_char"],function v(){return(null==v.$$s?this:v.$$s).$length()},{$$s:M}):(ee(M.encoding,"each_char",[M],S.$to_proc()),M)}),O(A,"$chars",function L(){var S=L.$$p||z;return L.$$p=null,H(S)?ee(this,"each_char",[],S.$to_proc()):this.$each_char().$to_a()}),O(A,"$each_codepoint",function L(){var S=L.$$p||z,M=this;if(L.$$p=null,S===z)return M.$enum_for("each_codepoint");for(var v=0,P=M.length;v<P;v++)C.yield1(S,M.codePointAt(v));return M}),O(A,"$codepoints",function L(){var S=L.$$p||z;return L.$$p=null,S!==z?ee(this,"each_codepoint",[],S.$to_proc()):this.$each_codepoint().$to_a()}),O(A,"$encode",function(S){return C.enc(this,S)}),O(A,"$force_encoding",function(S){var v=this;return S===v.encoding||(S=W["$coerce_to!"](S,q("String"),"to_s"),(S=q("Encoding").$find(S))===v.encoding)||(v=C.set_encoding(v,S)),v}),O(A,"$getbyte",function(S){var v=z;return v=this.$bytes(),S=W["$coerce_to!"](S,q("Integer"),"to_int"),H(B(v.$length(),S))?z:v["$[]"](S)}),O(A,"$initialize_copy",function(S){return"\n      self.encoding = other.encoding;\n      self.internal_encoding = other.internal_encoding;\n    "}),O(A,"$valid_encoding?",Y(!0))}(),Z=[q(oe("Encoding"),"UTF_8")],ee(q("Encoding"),"default_external=",Z),Z[Z.length-1]},Opal.modules["corelib/math"]=function(C){var oe,z,q,K,le=C.type_error,d=C.const_set,H=C.Class,ee=C.slice,$=C.Kernel,x=C.defs,O=C.truthy,E=C.send,Y=C.def,G=C.rb_minus,D=C.eqeqeq,W=C.rb_divide,Z=C.nil,T=C.$$$;return oe=[],q=[z=(0,C.module)("::","Math")].concat(oe),K=C.$r(q),d(z,"E",Math.E),d(z,"PI",Math.PI),d(z,"DomainError",H.$new(T("StandardError"))),x(z,"$checked",function(A,J){var S;if(S=ee(arguments,1),isNaN(S[0])||2==S.length&&isNaN(S[1]))return NaN;var M=Math[A].apply(null,S);return isNaN(M)&&$.$raise(K("DomainError"),'Numerical argument is out of domain - "'+A+'"'),M},-2),x(z,"$float!",function(A){try{return $.$Float(A)}catch(J){if(!C.rescue(J,[T("ArgumentError")]))throw J;try{return $.$raise(le(A,T("Float")))}finally{C.pop_exception()}}}),x(z,"$integer!",function(A){try{return $.$Integer(A)}catch(J){if(!C.rescue(J,[T("ArgumentError")]))throw J;try{return $.$raise(le(A,T("Integer")))}finally{C.pop_exception()}}}),z.$module_function(),O(void 0!==Math.erf)||C.prop(Math,"erf",function(I){var P=1;I<0&&(P=-1);var R=1/(1+.3275911*(I=Math.abs(I)));return P*(1-((((1.061405429*R-1.453152027)*R+1.421413741)*R-.284496736)*R+.254829592)*R*Math.exp(-I*I))}),O(void 0!==Math.erfc)||C.prop(Math,"erfc",function(I){var A=Math.abs(I),J=1/(.5*A+1),F=J*Math.exp(-A*A-1.26551223+J*(J*(J*(J*(J*(J*(J*(J*(.17087277*J-.82215223)+1.48851587)-1.13520398)+.27886807)-.18628806)+.09678418)+.37409196)+1.00002368));return I<0?2-F:F}),E(["acos","acosh","asin","asinh","atan","atanh","cbrt","cos","cosh","erf","erfc","exp","sin","sinh","sqrt","tanh"],"each",[],function I(A){return null==A&&(A=Z),E(null==I.$$s?this:I.$$s,"define_method",[A],function(S){return null==S&&(S=Z),T("Math").$checked(A,T("Math")["$float!"](S))})},{$$s:z}),Y(z,"$atan2",function(A,J){return T("Math").$checked("atan2",T("Math")["$float!"](A),T("Math")["$float!"](J))}),Y(z,"$hypot",function(A,J){return T("Math").$checked("hypot",T("Math")["$float!"](A),T("Math")["$float!"](J))}),Y(z,"$frexp",function(A){if(A=K("Math")["$float!"](A),isNaN(A))return[NaN,0];var J=Math.floor(Math.log(Math.abs(A))/Math.log(2))+1;return[A/Math.pow(2,J),J]}),Y(z,"$gamma",function(A){A=K("Math")["$float!"](A);var J,L,S,M,v,P,R,te,k,N=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];if(isNaN(A))return NaN;if(0===A&&1/A<0)return-1/0;if((-1===A||A===-1/0)&&$.$raise(K("DomainError"),'Numerical argument is out of domain - "gamma"'),K("Integer")["$==="](A)){if(A<=0)return isFinite(A)?1/0:NaN;if(A>171)return 1/0;for(M=A-2,v=A-1;M>1;)v*=M,M--;return 0==v&&(v=1),v}if(A<.5)return Math.PI/(Math.sin(Math.PI*A)*T("Math").$gamma(G(1,A)));if(A>=171.35)return 1/0;if(A>85)return k=(te=(R=(P=A*A)*A)*A)*A,Math.sqrt(2*Math.PI/A)*Math.pow(A/Math.E,A)*(1+1/(12*A)+1/(288*P)-139/(51840*R)-571/(2488320*te)+163879/(209018880*k)+5246819/(75246796800*k*A));for(A-=1,S=N[0],J=1;J<N.length;++J)S+=N[J]/(A+J);return L=A+4.7421875+.5,Math.sqrt(2*Math.PI)*Math.pow(L,A+.5)*Math.exp(-L)*S}),Y(z,"$ldexp",function(A,J){return A=K("Math")["$float!"](A),J=K("Math")["$integer!"](J),isNaN(J)&&$.$raise(T("RangeError"),"float NaN out of range of integer"),A*Math.pow(2,J)}),Y(z,"$lgamma",function(A){return-1==A?[1/0,1]:[Math.log(Math.abs(T("Math").$gamma(A))),T("Math").$gamma(A)<0?-1:1]}),Y(z,"$log",function(A,J){return D(T("String"),A)&&$.$raise(le(A,T("Float"))),O(null==J)?T("Math").$checked("log",T("Math")["$float!"](A)):(D(T("String"),J)&&$.$raise(le(J,T("Float"))),W(T("Math").$checked("log",T("Math")["$float!"](A)),T("Math").$checked("log",T("Math")["$float!"](J))))},-2),Y(z,"$log10",function(A){return D(T("String"),A)&&$.$raise(le(A,T("Float"))),T("Math").$checked("log10",T("Math")["$float!"](A))}),Y(z,"$log2",function(A){return D(T("String"),A)&&$.$raise(le(A,T("Float"))),T("Math").$checked("log2",T("Math")["$float!"](A))}),Y(z,"$tan",function(A){return A=T("Math")["$float!"](A),O(A["$infinite?"]())?T(T("Float"),"NAN"):T("Math").$checked("tan",T("Math")["$float!"](A))})},Opal.modules["corelib/complex/base"]=function(C){var O,E,Y,G,me=C.truthy,d=C.def,H=C.klass,ee=[],$=C.nil;return O=ee,Y=[E=(0,C.module)("::","Kernel")].concat(O),G=C.$r(Y),d(E,"$Complex",function(W,B){return null==B&&(B=$),me(B)?G("Complex").$new(W,B):G("Complex").$new(W,0)},-2),function(x,O,E){var Y=H("::",null,"String"),G=[Y].concat(E),D=C.$r(G);return d(Y,"$to_c",function(){return D("Complex").$from_string(this)})}(0,0,ee)},Opal.modules["corelib/complex"]=function(C){var J,L,S,M,v,le=C.klass,me=C.truthy,d=C.eqeqeq,H=C.Kernel,ee=C.defs,$=C.rb_times,x=C.def,O=C.rb_plus,E=C.rb_minus,Y=C.rb_divide,G=C.eqeq,D=C.to_ary,W=C.rb_gt,B=C.neqeq,Z=C.return_val,T=C.const_set,j=C.alias,oe=C.top,q=C.nil,K=C.$$$;return oe.$require("corelib/numeric"),oe.$require("corelib/complex/base"),J=[],S=[L=le("::",K("Numeric"),"Complex")].concat(J),M=C.$r(S),(v=L.$$prototype).real=v.imag=q,ee(L,"$rect",function(R,te){return null==te&&(te=0),d(K("Numeric"),R)&&me(R["$real?"]())&&d(K("Numeric"),te)&&me(te["$real?"]())||H.$raise(K("TypeError"),"not a real"),this.$new(R,te)},-2),ee(L,"$polar",function(R,te){return null==te&&(te=0),d(K("Numeric"),R)&&me(R["$real?"]())&&d(K("Numeric"),te)&&me(te["$real?"]())||H.$raise(K("TypeError"),"not a real"),this.$new($(R,K("Math").$cos(te)),$(R,K("Math").$sin(te)))},-2),L.$attr_reader("real","imag"),x(L,"$initialize",function(R,te){var k=this;return null==te&&(te=0),k.real=R,k.imag=te,k.$freeze()},-2),x(L,"$coerce",function(R){return d(K("Complex"),R)?[R,this]:d(K("Numeric"),R)&&me(R["$real?"]())?[K("Complex").$new(R,0),this]:H.$raise(K("TypeError"),R.$class()+" can't be coerced into Complex")}),x(L,"$==",function(R){var te=this,k=q;return d(K("Complex"),R)?me(k=te.real["$=="](R.$real()))?te.imag["$=="](R.$imag()):k:d(K("Numeric"),R)&&me(R["$real?"]())?me(k=te.real["$=="](R))?te.imag["$=="](0):k:R["$=="](te)}),x(L,"$-@",function(){return H.$Complex(this.real["$-@"](),this.imag["$-@"]())}),x(L,"$+",function(R){var te=this;return d(K("Complex"),R)?H.$Complex(O(te.real,R.$real()),O(te.imag,R.$imag())):d(K("Numeric"),R)&&me(R["$real?"]())?H.$Complex(O(te.real,R),te.imag):te.$__coerced__("+",R)}),x(L,"$-",function(R){var te=this;return d(K("Complex"),R)?H.$Complex(E(te.real,R.$real()),E(te.imag,R.$imag())):d(K("Numeric"),R)&&me(R["$real?"]())?H.$Complex(E(te.real,R),te.imag):te.$__coerced__("-",R)}),x(L,"$*",function(R){var te=this;return d(K("Complex"),R)?H.$Complex(E($(te.real,R.$real()),$(te.imag,R.$imag())),O($(te.real,R.$imag()),$(te.imag,R.$real()))):d(K("Numeric"),R)&&me(R["$real?"]())?H.$Complex($(te.real,R),$(te.imag,R)):te.$__coerced__("*",R)}),x(L,"$/",function(R){var te=this;return d(K("Complex"),R)?d(K("Number"),te.real)&&me(te.real["$nan?"]())||d(K("Number"),te.imag)&&me(te.imag["$nan?"]())||d(K("Number"),R.$real())&&me(R.$real()["$nan?"]())||d(K("Number"),R.$imag())&&me(R.$imag()["$nan?"]())?K("Complex").$new(K(K("Float"),"NAN"),K(K("Float"),"NAN")):Y($(te,R.$conj()),R.$abs2()):d(K("Numeric"),R)&&me(R["$real?"]())?H.$Complex(te.real.$quo(R),te.imag.$quo(R)):te.$__coerced__("/",R)}),x(L,"$**",function(R){var te,k,de=this,N=q,F=q,g=q,l=q,c=q,f=q,u=q,p=q,_=q,y=q,m=q;if(G(R,0))return K("Complex").$new(1,0);if(d(K("Complex"),R))return k=de.$polar(),N=null==(te=D(k))[0]?q:te[0],F=null==te[1]?q:te[1],g=R.$real(),l=R.$imag(),c=K("Math").$exp(E($(g,K("Math").$log(N)),$(l,F))),f=O($(F,g),$(l,K("Math").$log(N))),K("Complex").$polar(c,f);if(d(K("Integer"),R)){if(me(W(R,0))){for(p=u=de,_=E(R,1);B(_,0);){for(k=_.$divmod(2),y=null==(te=D(k))[0]?q:te[0],m=null==te[1]?q:te[1];G(m,0);)u=H.$Complex(E($(u.$real(),u.$real()),$(u.$imag(),u.$imag())),$($(2,u.$real()),u.$imag())),k=(_=y).$divmod(2),y=null==(te=D(k))[0]?q:te[0],m=null==te[1]?q:te[1];p=$(p,u),_=E(_,1)}return p}return Y(K("Rational").$new(1,1),de)["$**"](R["$-@"]())}return d(K("Float"),R)||d(K("Rational"),R)?(k=de.$polar(),N=null==(te=D(k))[0]?q:te[0],F=null==te[1]?q:te[1],K("Complex").$polar(N["$**"](R),$(F,R))):de.$__coerced__("**",R)}),x(L,"$abs",function(){return K("Math").$hypot(this.real,this.imag)}),x(L,"$abs2",function(){var R=this;return O($(R.real,R.real),$(R.imag,R.imag))}),x(L,"$angle",function(){return K("Math").$atan2(this.imag,this.real)}),x(L,"$conj",function(){return H.$Complex(this.real,this.imag["$-@"]())}),x(L,"$denominator",function(){return this.real.$denominator().$lcm(this.imag.$denominator())}),x(L,"$eql?",function(R){var k,de;return me(k=me(de=M("Complex")["$==="](R))?this.real.$class()["$=="](this.imag.$class()):de)?this["$=="](R):k}),x(L,"$fdiv",function(R){return d(K("Numeric"),R)||H.$raise(K("TypeError"),R.$class()+" can't be coerced into Complex"),Y(this,R)}),x(L,"$finite?",function(){var te;return me(te=this.real["$finite?"]())?this.imag["$finite?"]():te}),x(L,"$hash",function(){return"Complex:"+this.real+":"+this.imag}),x(L,"$infinite?",function(){var te;return me(te=this.real["$infinite?"]())?te:this.imag["$infinite?"]()}),x(L,"$inspect",function(){return"("+this+")"}),x(L,"$numerator",function(){var te,R=this;return te=R.$denominator(),H.$Complex($(R.real.$numerator(),Y(te,R.real.$denominator())),$(R.imag.$numerator(),Y(te,R.imag.$denominator())))}),x(L,"$polar",function(){return[this.$abs(),this.$arg()]}),x(L,"$rationalize",function(R){var te=this;return arguments.length>1&&H.$raise(K("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),B(te.imag,0)&&H.$raise(K("RangeError"),"can't convert "+te+" into Rational"),te.$real().$rationalize(R)},-1),x(L,"$real?",Z(!1)),x(L,"$rect",function(){return[this.real,this.imag]}),x(L,"$to_f",function(){var R=this;return G(R.imag,0)||H.$raise(K("RangeError"),"can't convert "+R+" into Float"),R.real.$to_f()}),x(L,"$to_i",function(){var R=this;return G(R.imag,0)||H.$raise(K("RangeError"),"can't convert "+R+" into Integer"),R.real.$to_i()}),x(L,"$to_r",function(){var R=this;return G(R.imag,0)||H.$raise(K("RangeError"),"can't convert "+R+" into Rational"),R.real.$to_r()}),x(L,"$to_s",function(){var R=this,te=q;return te=R.real.$inspect(),te=O(te,d(K("Number"),R.imag)&&me(R.imag["$nan?"]())||me(R.imag["$positive?"]())||me(R.imag["$zero?"]())?"+":"-"),te=O(te,R.imag.$abs().$inspect()),d(K("Number"),R.imag)&&(me(R.imag["$nan?"]())||me(R.imag["$infinite?"]()))&&(te=O(te,"*")),O(te,"i")}),T(S[0],"I",L.$new(0,1)),ee(L,"$from_string",function(R){var de,N,te=/[+-]?[\d_]+(\.[\d_]+)?(e\d+)?/;function g(){return te.test(R)}function l(){var u=R.match(te)[0];return R=R.slice(u.length),u.replace(/_/g,"")}function c(){if(g()){var f=parseFloat(l());if("/"===R[0]){if(R=R.slice(1),g()){var u=parseFloat(l());return H.$Rational(f,u)}return R="/"+R,f}return f}return null}return R.match(te),(de=c())?(N=c())?H.$Complex(de,N):"i"===R[0]?H.$Complex(0,de):H.$Complex(de,0):H.$Complex(0,"i"===R[0]?1:"-"===R[0]&&"i"===R[1]?-1:"+"===R[0]&&"i"===R[1]?1:0)}),j(C.get_singleton_class(L),"rectangular","rect"),j(L,"arg","angle"),j(L,"conjugate","conj"),j(L,"divide","/"),j(L,"imaginary","imag"),j(L,"magnitude","abs"),j(L,"phase","arg"),j(L,"quo","/"),j(L,"rectangular","rect"),C.udef(L,"$negative?"),C.udef(L,"$positive?"),C.udef(L,"$step"),q},Opal.modules["corelib/rational/base"]=function(C){var me=C.def,d=C.klass,ee=C.$$$;return me((0,C.module)("::","Kernel"),"$Rational",function(E,Y){return null==Y&&(Y=1),ee("Rational").$convert(E,Y)},-2),me(d("::",null,"String"),"$to_r",function(){return ee("Rational").$from_string(this)})},Opal.modules["corelib/rational"]=function(C){var L,S,le=C.klass,me=C.eqeq,d=C.Kernel,H=C.truthy,ee=C.rb_lt,$=C.rb_divide,x=C.defs,O=C.eqeqeq,E=C.not,Y=C.Opal,G=C.def,D=C.return_ivar,W=C.rb_minus,B=C.rb_times,Z=C.rb_plus,T=C.rb_gt,j=C.rb_le,oe=C.return_self,z=C.alias,q=C.top,K=C.nil,I=C.$$$;return q.$require("corelib/numeric"),q.$require("corelib/rational/base"),(S=(L=le("::",I("Numeric"),"Rational")).$$prototype).num=S.den=K,x(L,"$reduce",function(v,P){var te;if(v=v.$to_i(),P=P.$to_i(),me(P,0))d.$raise(I("ZeroDivisionError"),"divided by 0");else if(H(ee(P,0)))v=v["$-@"](),P=P["$-@"]();else if(me(P,1))return this.$new(v,P);return te=v.$gcd(P),this.$new($(v,te),$(P,te))}),x(L,"$convert",function(v,P){return(H(v["$nil?"]())||H(P["$nil?"]()))&&d.$raise(I("TypeError"),"cannot convert nil into Rational"),O(I("Integer"),v)&&O(I("Integer"),P)?this.$reduce(v,P):((O(I("Float"),v)||O(I("String"),v)||O(I("Complex"),v))&&(v=v.$to_r()),(O(I("Float"),P)||O(I("String"),P)||O(I("Complex"),P))&&(P=P.$to_r()),H(P["$equal?"](1))&&E(I("Integer")["$==="](v))?Y["$coerce_to!"](v,I("Rational"),"to_r"):O(I("Numeric"),v)&&O(I("Numeric"),P)?$(v,P):this.$reduce(v,P))}),G(L,"$initialize",function(v,P){var R=this;return R.num=v,R.den=P,R.$freeze()}),G(L,"$numerator",D("num")),G(L,"$denominator",D("den")),G(L,"$coerce",function(v){var R,P=this;return O(I("Rational"),R=v)?[v,P]:O(I("Integer"),R)?[v.$to_r(),P]:O(I("Float"),R)?[v,P.$to_f()]:K}),G(L,"$==",function(v){var R,P=this,te=K;return O(I("Rational"),R=v)?H(te=P.num["$=="](v.$numerator()))?P.den["$=="](v.$denominator()):te:O(I("Integer"),R)?H(te=P.num["$=="](v))?P.den["$=="](1):te:O(I("Float"),R)?P.$to_f()["$=="](v):v["$=="](P)}),G(L,"$<=>",function(v){var R,P=this;return O(I("Rational"),R=v)?W(B(P.num,v.$denominator()),B(P.den,v.$numerator()))["$<=>"](0):O(I("Integer"),R)?W(P.num,B(P.den,v))["$<=>"](0):O(I("Float"),R)?P.$to_f()["$<=>"](v):P.$__coerced__("<=>",v)}),G(L,"$+",function(v){var R,P=this,te=K,k=K;return O(I("Rational"),R=v)?(te=Z(B(P.num,v.$denominator()),B(P.den,v.$numerator())),k=B(P.den,v.$denominator()),d.$Rational(te,k)):O(I("Integer"),R)?d.$Rational(Z(P.num,B(v,P.den)),P.den):O(I("Float"),R)?Z(P.$to_f(),v):P.$__coerced__("+",v)}),G(L,"$-",function(v){var R,P=this,te=K,k=K;return O(I("Rational"),R=v)?(te=W(B(P.num,v.$denominator()),B(P.den,v.$numerator())),k=B(P.den,v.$denominator()),d.$Rational(te,k)):O(I("Integer"),R)?d.$Rational(W(P.num,B(v,P.den)),P.den):O(I("Float"),R)?W(P.$to_f(),v):P.$__coerced__("-",v)}),G(L,"$*",function(v){var R,P=this,te=K,k=K;return O(I("Rational"),R=v)?(te=B(P.num,v.$numerator()),k=B(P.den,v.$denominator()),d.$Rational(te,k)):O(I("Integer"),R)?d.$Rational(B(P.num,v),P.den):O(I("Float"),R)?B(P.$to_f(),v):P.$__coerced__("*",v)}),G(L,"$/",function(v){var R,P=this,te=K,k=K;return O(I("Rational"),R=v)?(te=B(P.num,v.$denominator()),k=B(P.den,v.$numerator()),d.$Rational(te,k)):O(I("Integer"),R)?me(v,0)?$(P.$to_f(),0):d.$Rational(P.num,B(P.den,v)):O(I("Float"),R)?$(P.$to_f(),v):P.$__coerced__("/",v)}),G(L,"$**",function(v){var R,P=this;return O(I("Integer"),R=v)?me(P,0)&&H(ee(v,0))?I(I("Float"),"INFINITY"):H(T(v,0))?d.$Rational(P.num["$**"](v),P.den["$**"](v)):H(ee(v,0))?d.$Rational(P.den["$**"](v["$-@"]()),P.num["$**"](v["$-@"]())):d.$Rational(1,1):O(I("Float"),R)?P.$to_f()["$**"](v):O(I("Rational"),R)?me(v,0)?d.$Rational(1,1):me(v.$denominator(),1)?H(ee(v,0))?d.$Rational(P.den["$**"](v.$numerator().$abs()),P.num["$**"](v.$numerator().$abs())):d.$Rational(P.num["$**"](v.$numerator()),P.den["$**"](v.$numerator())):me(P,0)&&H(ee(v,0))?d.$raise(I("ZeroDivisionError"),"divided by 0"):P.$to_f()["$**"](v):P.$__coerced__("**",v)}),G(L,"$abs",function(){return d.$Rational(this.num.$abs(),this.den.$abs())}),G(L,"$ceil",function(v){var P=this;return null==v&&(v=0),me(v,0)?$(P.num["$-@"](),P.den)["$-@"]().$ceil():P.$with_precision("ceil",v)},-1),G(L,"$floor",function(v){var P=this;return null==v&&(v=0),me(v,0)?$(P.num["$-@"](),P.den)["$-@"]().$floor():P.$with_precision("floor",v)},-1),G(L,"$hash",function(){return"Rational:"+this.num+":"+this.den}),G(L,"$inspect",function(){return"("+this+")"}),G(L,"$rationalize",function(v){var P=this;if(arguments.length>1&&d.$raise(I("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),null==v)return P;for(var l,c,f,u,p,R=v.$abs(),te=W(P,R),k=Z(P,R),de=0,N=1,F=1,g=0;f=te.$ceil(),!j(f,k);)l=(u=f-1)*N+de,c=u*g+F,p=$(1,W(k,u)),k=$(1,W(te,u)),te=p,de=N,F=g,N=l,g=c;return d.$Rational(f*N+de,f*g+F)},-1),G(L,"$round",function(v){var P=this,R=K,te=K,k=K;return null==v&&(v=0),me(v,0)?me(P.num,0)?0:me(P.den,1)?P.num:(R=Z(B(P.num.$abs(),2),P.den),te=B(P.den,2),k=$(R,te).$truncate(),H(ee(P.num,0))?k["$-@"]():k):P.$with_precision("round",v)},-1),G(L,"$to_f",function(){return $(this.num,this.den)}),G(L,"$to_i",function(){return this.$truncate()}),G(L,"$to_r",oe),G(L,"$to_s",function(){return this.num+"/"+this.den}),G(L,"$truncate",function(v){var P=this;return null==v&&(v=0),me(v,0)?H(ee(P.num,0))?P.$ceil():P.$floor():P.$with_precision("truncate",v)},-1),G(L,"$with_precision",function(v,P){var te,k=K;return O(I("Integer"),P)||d.$raise(I("TypeError"),"not an Integer"),te=10["$**"](P),k=B(this,te),H(ee(P,1))?$(k.$send(v),te).$to_i():d.$Rational(k.$send(v),te)}),x(L,"$from_string",function(v){var k,de,P=v.trimLeft(),R=/^[+-]?[\d_]+(\.[\d_]+)?/;function N(){return R.test(P)}function F(){var l=P.match(R)[0];return P=P.slice(l.length),l.replace(/_/g,"")}return P.match(R),N()?(k=parseFloat(F()),"/"===P[0]?(P=P.slice(1),N()?(de=parseFloat(F()),d.$Rational(k,de)):d.$Rational(k,1)):d.$Rational(k,1)):d.$Rational(0,1)}),z(L,"divide","/"),z(L,"quo","/")},Opal.modules["corelib/time"]=function(C){var le=C.slice,me=C.deny_frozen_access,d=C.klass,H=C.Kernel,ee=C.Opal,$=C.defs,x=C.eqeqeq,O=C.def,E=C.truthy,Y=C.rb_gt,G=C.rb_lt,D=C.send,W=C.rb_plus,B=C.rb_divide,Z=C.rb_minus,T=C.range,j=C.neqeq,oe=C.rb_le,z=C.eqeq,q=C.alias,A=C.nil,J=C.$$$;return C.top.$require("corelib/comparable"),function(L,S,M){var v=d("::",S,"Time"),P=[v].concat([]),R=C.$r(P);v.$include(J("Comparable"));var g,te=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],k=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],de=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],N=["January","February","March","April","May","June","July","August","September","October","November","December"];function F(g,l,c,f,u,p){if(g=g.$$is_string?parseInt(g,10):ee["$coerce_to!"](g,J("Integer"),"to_int"),l===A)l=1;else if(!l.$$is_number)if(l["$respond_to?"]("to_str"))switch(l=l.$to_str(),l.toLowerCase()){case"jan":l=1;break;case"feb":l=2;break;case"mar":l=3;break;case"apr":l=4;break;case"may":l=5;break;case"jun":l=6;break;case"jul":l=7;break;case"aug":l=8;break;case"sep":l=9;break;case"oct":l=10;break;case"nov":l=11;break;case"dec":l=12;break;default:l=l.$to_i()}else l=ee["$coerce_to!"](l,J("Integer"),"to_int");return(l<1||l>12)&&H.$raise(J("ArgumentError"),"month out of range: "+l),l-=1,((c=c===A?1:c.$$is_string?parseInt(c,10):ee["$coerce_to!"](c,J("Integer"),"to_int"))<1||c>31)&&H.$raise(J("ArgumentError"),"day out of range: "+c),((f=f===A?0:f.$$is_string?parseInt(f,10):ee["$coerce_to!"](f,J("Integer"),"to_int"))<0||f>24)&&H.$raise(J("ArgumentError"),"hour out of range: "+f),((u=u===A?0:u.$$is_string?parseInt(u,10):ee["$coerce_to!"](u,J("Integer"),"to_int"))<0||u>59)&&H.$raise(J("ArgumentError"),"min out of range: "+u),p===A?p=0:p.$$is_number||(p=p.$$is_string?parseInt(p,10):ee["$coerce_to!"](p,J("Integer"),"to_int")),(p<0||p>60)&&H.$raise(J("ArgumentError"),"sec out of range: "+p),[g,l,c,f,u,p]}return $(v,"$at",function(l,c){var f;return J("Time")["$==="](l)?(void 0!==c&&H.$raise(J("TypeError"),"can't convert Time into an exact number"),(f=new Date(l.getTime())).timezone=l.timezone,f):(l.$$is_number||(l=ee["$coerce_to!"](l,J("Integer"),"to_int")),void 0===c?new Date(1e3*l):(c.$$is_number||(c=ee["$coerce_to!"](c,J("Integer"),"to_int")),new Date(1e3*l+c/1e3)))},-2),$(v,"$new",function(l,c,f,u,p,_,y){var ne,se,Ee,ke;return null==c&&(c=A),null==f&&(f=A),null==u&&(u=A),null==p&&(p=A),null==_&&(_=A),null==y&&(y=A),void 0===l?new Date:(l=(ne=F(l,c,f,u,p,_))[0],c=ne[1],f=ne[2],u=ne[3],p=ne[4],_=ne[5],y===A?(se=new Date(l,c,f,u,p,0,1e3*_),l<100&&se.setFullYear(l),se):(Ee=this.$_parse_offset(y),ke=new Date(Date.UTC(l,c,f,u,p,0,1e3*_)),l<100&&ke.setUTCFullYear(l),(se=new Date(ke.getTime()-36e5*Ee)).timezone=Ee,se))},-1),$(v,"$_parse_offset",function(l){var c;return l.$$is_string?"UTC"==l?c=0:/^[+-]\d\d:[0-5]\d$/.test(l)?c=("-"==l[0]?-1:1)*(+(l[1]+l[2])+ +(l[4]+l[5])/60):H.$raise(J("ArgumentError"),'"+HH:MM", "-HH:MM", "UTC" expected for utc_offset: '+l):l.$$is_number?c=l/3600:H.$raise(J("ArgumentError"),"Opal doesn't support other types for a timezone argument than Integer and String"),c}),$(v,"$local",function(l,c,f,u,p,_,y,m,ne,se){var Ee,ke;return null==c&&(c=A),null==f&&(f=A),null==u&&(u=A),null==p&&(p=A),null==_&&(_=A),null==y&&(y=A),null==m&&(m=A),null==ne&&(ne=A),null==se&&(se=A),10===arguments.length&&(l=(Ee=le(arguments))[5],c=Ee[4],f=Ee[3],u=Ee[2],p=Ee[1],_=Ee[0]),l=(Ee=F(l,c,f,u,p,_))[0],c=Ee[1],f=Ee[2],u=Ee[3],p=Ee[4],_=Ee[5],ke=new Date(l,c,f,u,p,0,1e3*_),l<100&&ke.setFullYear(l),ke},-2),$(v,"$gm",function(l,c,f,u,p,_,y,m,ne,se){var Ee,ke;return null==c&&(c=A),null==f&&(f=A),null==u&&(u=A),null==p&&(p=A),null==_&&(_=A),null==y&&(y=A),null==m&&(m=A),null==ne&&(ne=A),null==se&&(se=A),10===arguments.length&&(l=(Ee=le(arguments))[5],c=Ee[4],f=Ee[3],u=Ee[2],p=Ee[1],_=Ee[0]),l=(Ee=F(l,c,f,u,p,_))[0],c=Ee[1],f=Ee[2],u=Ee[3],p=Ee[4],_=Ee[5],ke=new Date(Date.UTC(l,c,f,u,p,0,1e3*_)),l<100&&ke.setUTCFullYear(l),ke.timezone=0,ke},-2),$(v,"$now",function(){return this.$new()}),O(v,"$+",function(l){x(J("Time"),l)&&H.$raise(J("TypeError"),"time + time?"),l.$$is_number||(l=ee["$coerce_to!"](l,J("Integer"),"to_int"));var f=new Date(this.getTime()+1e3*l);return f.timezone=this.timezone,f}),O(v,"$-",function(l){var c=this;if(x(J("Time"),l))return(c.getTime()-l.getTime())/1e3;l.$$is_number||(l=ee["$coerce_to!"](l,J("Integer"),"to_int"));var f=new Date(c.getTime()-1e3*l);return f.timezone=c.timezone,f}),O(v,"$<=>",function(l){var f=A;return x(J("Time"),l)?this.$to_f()["$<=>"](l.$to_f()):(f=l["$<=>"](this),E(f["$nil?"]())?A:E(Y(f,0))?-1:E(G(f,0))?1:0)}),O(v,"$==",function(l){var f;return E(f=J("Time")["$==="](l))?this.$to_f()===l.$to_f():f}),O(v,"$asctime",function(){return this.$strftime("%a %b %e %H:%M:%S %Y")}),D([["year","getFullYear","getUTCFullYear"],["mon","getMonth","getUTCMonth",1],["wday","getDay","getUTCDay"],["day","getDate","getUTCDate"],["hour","getHours","getUTCHours"],["min","getMinutes","getUTCMinutes"],["sec","getSeconds","getUTCSeconds"]],"each",[],function g(l,c,f,u){var p=null==g.$$s?this:g.$$s;return null==l&&(l=A),null==c&&(c=A),null==f&&(f=A),null==u&&(u=0),D(p,"define_method",[l],function _(){var y=null==_.$$s?this:_.$$s;return u+(null!=y.timezone?new Date(y.getTime()+36e5*y.timezone)[f]():y[c]())},{$$s:p})},{$$arity:-4,$$s:v}),O(v,"$yday",function(){var c,f,l=this;return c=R("Time").$new(l.$year()).$to_i(),f=R("Time").$new(l.$year(),l.$month(),l.$day()).$to_i(),W(B(Z(f,c),86400).$round(),1)}),O(v,"$isdst",function(){var l=this,c=new Date(l.getFullYear(),0,1),f=new Date(l.getFullYear(),6,1);return l.getTimezoneOffset()<Math.max(c.getTimezoneOffset(),f.getTimezoneOffset())}),O(v,"$dup",function(){var l=this,c=A;return(c=new Date(l.getTime())).$copy_instance_variables(l),c.$initialize_dup(l),c}),O(v,"$eql?",function(l){var f;return E(f=l["$is_a?"](J("Time")))?this["$<=>"](l)["$zero?"]():f}),D([["sunday?",0],["monday?",1],["tuesday?",2],["wednesday?",3],["thursday?",4],["friday?",5],["saturday?",6]],"each",[],function g(l,c){var f=null==g.$$s?this:g.$$s;return null==l&&(l=A),null==c&&(c=A),D(f,"define_method",[l],function u(){return(null==u.$$s?this:u.$$s).$wday()===c},{$$s:f})},{$$s:v}),O(v,"$hash",function(){return"Time:"+this.getTime()}),O(v,"$inspect",function(){var l=this;return E(l["$utc?"]())?l.$strftime("%Y-%m-%d %H:%M:%S UTC"):l.$strftime("%Y-%m-%d %H:%M:%S %z")}),O(v,"$succ",function(){var c=new Date(this.getTime()+1e3);return c.timezone=this.timezone,c}),O(v,"$usec",function(){return 1e3*this.getMilliseconds()}),O(v,"$zone",function(){var l=this;if(0===l.timezone)return"UTC";if(null!=l.timezone)return A;var f,c=l.toString();return"GMT"==(f=-1==c.indexOf("(")?c.match(/[A-Z]{3,4}/)[0]:c.match(/\((.+)\)(?:\s|$)/)[1])&&/(GMT\W*\d{4})/.test(c)?RegExp.$1:f}),O(v,"$getgm",function(){var c=new Date(this.getTime());return c.timezone=0,c}),O(v,"$gmtime",function(){var l=this;return 0!==l.timezone&&(me(l),l.timezone=0),l}),O(v,"$gmt?",function(){return 0===this.timezone}),O(v,"$gmt_offset",function(){var l=this;return null!=l.timezone?60*l.timezone:60*-l.getTimezoneOffset()}),O(v,"$strftime",function(l){var c=this;return l.replace(/%([\-_#^0]*:{0,2})(\d+)?([EO]*)(.)/g,function(f,u,p,_,y){var ne,se,Ee,m="",ke=-1!==u.indexOf("0"),ce=-1===u.indexOf("-"),Me=-1!==u.indexOf("_"),$e=-1!==u.indexOf("^"),be=-1!==u.indexOf("#"),he=(u.match(":")||[]).length;switch(p=parseInt(p,10),ke&&Me&&(u.indexOf("0")<u.indexOf("_")?ke=!1:Me=!1),y){case"Y":m+=c.$year();break;case"C":ke=!Me,m+=Math.round(c.$year()/100);break;case"y":ke=!Me,m+=c.$year()%100;break;case"m":ke=!Me,m+=c.$mon();break;case"B":m+=N[c.$mon()-1];break;case"b":case"h":Me=!ke,m+=de[c.$mon()-1];break;case"d":ke=!Me,m+=c.$day();break;case"e":Me=!ke,m+=c.$day();break;case"j":ke=!Me,p=isNaN(p)?3:p,m+=c.$yday();break;case"H":ke=!Me,m+=c.$hour();break;case"k":Me=!ke,m+=c.$hour();break;case"I":ke=!Me,m+=c.$hour()%12||12;break;case"l":Me=!ke,m+=c.$hour()%12||12;break;case"P":m+=c.$hour()>=12?"pm":"am";break;case"p":m+=c.$hour()>=12?"PM":"AM";break;case"M":ke=!Me,m+=c.$min();break;case"S":ke=!Me,m+=c.$sec();break;case"L":ke=!Me,p=isNaN(p)?3:p,m+=c.getMilliseconds();break;case"N":p=isNaN(p)?9:p,m=(m+=c.getMilliseconds().toString().$rjust(3,"0")).$ljust(p,"0");break;case"z":var Se=null==c.timezone?c.getTimezoneOffset():60*-c.timezone,ve=Math.floor(Math.abs(Se)/60),ae=Math.abs(Se)%60;m+=Se<0?"+":"-",m+=ve<10?"0":"",m+=ve,he>0&&(m+=":"),m+=ae<10?"0":"",m+=ae,he>1&&(m+=":00");break;case"Z":m+=c.$zone();break;case"A":m+=te[c.$wday()];break;case"a":m+=k[c.$wday()];break;case"u":m+=c.$wday()+1;break;case"w":m+=c.$wday();break;case"V":m+=c.$cweek_cyear()["$[]"](0).$to_s().$rjust(2,"0");break;case"G":m+=c.$cweek_cyear()["$[]"](1);break;case"g":m+=c.$cweek_cyear()["$[]"](1)["$[]"](T(-2,-1,!1));break;case"s":m+=c.$to_i();break;case"n":m+="\n";break;case"t":m+="\t";break;case"%":m+="%";break;case"c":m+=c.$strftime("%a %b %e %T %Y");break;case"D":case"x":m+=c.$strftime("%m/%d/%y");break;case"F":m+=c.$strftime("%Y-%m-%d");break;case"v":m+=c.$strftime("%e-%^b-%4Y");break;case"r":m+=c.$strftime("%I:%M:%S %p");break;case"R":m+=c.$strftime("%H:%M");break;case"T":case"X":m+=c.$strftime("%H:%M:%S");break;case"J":if((ne=c.$to_date().$jd())<2405160){m+=c.$strftime("%Y-%m-%d");break}ne<2419614?(se="M",Ee=1867):ne<2424875?(se="T",Ee=1911):ne<2447535?(se="S",Ee=1925):ne<2458605?(se="H",Ee=1988):(se="R",Ee=2018),m+=c.$format("%c%02d",se,Z(c.$year(),Ee)),m+=c.$strftime("-%m-%d");break;default:return f}return $e&&(m=m.toUpperCase()),be&&(m=m.replace(/[A-Z]/,function(ue){ue.toLowerCase()}).replace(/[a-z]/,function(ue){ue.toUpperCase()})),ce&&(ke||Me)&&(m=m.$rjust(isNaN(p)?2:p,Me?" ":"0")),m})}),O(v,"$to_a",function(){var l=this;return[l.$sec(),l.$min(),l.$hour(),l.$day(),l.$month(),l.$year(),l.$wday(),l.$yday(),l.$isdst(),l.$zone()]}),O(v,"$to_f",function(){return this.getTime()/1e3}),O(v,"$to_i",function(){return parseInt(this.getTime()/1e3,10)}),O(v,"$cweek_cyear",function(){var f,l=this,p=A,_=A,y=A,ne=A;return f=J("Time").$new(l.$year(),1,1).$wday(),p=l.$year(),E(oe(f,4))&&j(f,0)?_=Z(f,1):(_=Z(Z(f,7),1),z(_,-8)&&(_=-1)),y=B(W(l.$yday(),_),7).$ceil(),E(oe(y,0))?J("Time").$new(Z(l.$year(),1),12,31).$cweek_cyear():(z(y,53)&&(ne=J("Time").$new(l.$year(),12,31).$wday(),E(oe(ne,3))&&j(ne,0)&&(y=1,p=W(p,1))),[y,p])}),g=C.get_singleton_class(v),q(g,"mktime","local"),q(g,"utc","gm"),q(v,"ctime","asctime"),q(v,"dst?","isdst"),q(v,"getutc","getgm"),q(v,"gmtoff","gmt_offset"),q(v,"mday","day"),q(v,"month","mon"),q(v,"to_s","inspect"),q(v,"tv_sec","to_i"),q(v,"tv_usec","usec"),q(v,"utc","gmtime"),q(v,"utc?","gmt?"),q(v,"utc_offset","gmt_offset")}(0,Date)},Opal.modules["corelib/struct"]=function(C){var le=C.klass,me=C.slice,d=C.extract_kwargs,H=C.ensure_kwargs,ee=C.truthy,$=C.neqeq,x=C.eqeq,O=C.Opal,E=C.send,Y=C.Class,G=C.to_a,D=C.def,W=C.defs,B=C.Kernel,Z=C.hash2,T=C.rb_gt,j=C.rb_minus,oe=C.eqeqeq,z=C.rb_lt,q=C.rb_ge,K=C.rb_plus,I=C.alias,L=C.nil,S=C.$$$;return C.top.$require("corelib/enumerable"),function(M,v,P){var R=le("::",null,"Struct"),te=[R].concat([]),k=C.$r(te);R.$include(S("Enumerable")),W(R,"$new",function N(F,g,l){var f,u,p,_,c=N.$$p||L,y=this,m=L;if(N.$$p=null,f=me(arguments,1),u=d(f),u=H(u),p=f,null==(_=u.$$smap.keyword_init)&&(_=!1),ee(F))if(x(F.$class(),S("String"))&&$(F["$[]"](0).$upcase(),F["$[]"](0)))p.$unshift(F),F=L;else try{F=O["$const_name!"](F)}catch(ne){if(!C.rescue(ne,[S("TypeError"),S("NameError")]))throw ne;try{p.$unshift(F),F=L}finally{C.pop_exception()}}return E(p,"map",[],function(se){return null==se&&(se=L),O["$coerce_to!"](se,S("String"),"to_str")}),m=E(Y,"new",[y],function ne(){var Ee,se=null==ne.$$s?this:ne.$$s;return E(p,"each",[],function Ee(ke){return null==ke&&(ke=L),(null==Ee.$$s?this:Ee.$$s).$define_struct_attribute(ke)},{$$s:se}),Ee=C.get_singleton_class(se),D(Ee,"$new",function(Me){var be,he=this,Se=L;return be=me(arguments),(Se=he.$allocate()).$$data={},E(Se,"initialize",G(be)),Se},-1),Ee.$alias_method("[]","new")},{$$s:y}),ee(c)&&E(m,"module_eval",[],c.$to_proc()),m.$$keyword_init=_,ee(F)&&S("Struct").$const_set(F,m),m},-2),W(R,"$define_struct_attribute",function(F){var g=this;return x(g,S("Struct"))&&B.$raise(S("ArgumentError"),"you cannot define attributes to the Struct class"),g.$members()["$<<"](F),E(g,"define_method",[F],function l(){return(null==l.$$s?this:l.$$s).$$data[F]},{$$s:g}),E(g,"define_method",[F+"="],function l(c){return null==c&&(c=L),(null==l.$$s?this:l.$$s).$$data[F]=c},{$$s:g})}),W(R,"$members",function(){var g,F=this;return null==F.members&&(F.members=L),x(F,S("Struct"))&&B.$raise(S("ArgumentError"),"the Struct class has no members"),F.members=ee(g=F.members)?g:[]}),W(R,"$inherited",function(F){var l,g=this;return null==g.members&&(g.members=L),l=g.members,E(F,"instance_eval",[],function c(){return(null==c.$$s?this:c.$$s).members=l},{$$s:g})}),D(R,"$initialize",function(F){var g,l,c=this,f=L,u=L,p=L;return g=me(arguments),l=g,ee(c.$class().$$keyword_init)?(f=ee(u=l.$last())?u:Z([],{}),(ee(T(l.$length(),1))||ee(1===l.length&&!f.$$is_hash))&&B.$raise(S("ArgumentError"),"wrong number of arguments (given "+l.$length()+", expected 0)"),p=j(f.$keys(),c.$class().$members()),ee(p["$any?"]())&&B.$raise(S("ArgumentError"),"unknown keywords: "+p.$join(", ")),E(c.$class().$members(),"each",[],function _(y){var m,ne=null==_.$$s?this:_.$$s;return null==y&&(y=L),m=[y,f["$[]"](y)],E(ne,"[]=",m),m[m.length-1]},{$$s:c})):(ee(T(l.$length(),c.$class().$members().$length()))&&B.$raise(S("ArgumentError"),"struct size differs"),E(c.$class().$members(),"each_with_index",[],function _(y,m){var ne,se=null==_.$$s?this:_.$$s;return null==y&&(y=L),null==m&&(m=L),ne=[y,l["$[]"](m)],E(se,"[]=",ne),ne[ne.length-1]},{$$s:c}))},-1),D(R,"$initialize_copy",function(F){this.$$data={};var c,f,u,l=Object.keys(F.$$data);for(c=0,f=l.length;c<f;c++)this.$$data[u=l[c]]=F.$$data[u]}),W(R,"$keyword_init?",function(){return this.$$keyword_init}),D(R,"$members",function(){return this.$class().$members()}),D(R,"$hash",function(){return k("Hash").$new(this.$$data).$hash()}),D(R,"$[]",function(F){var g=this;return oe(S("Integer"),F)?(ee(z(F,g.$class().$members().$size()["$-@"]()))&&B.$raise(S("IndexError"),"offset "+F+" too small for struct(size:"+g.$class().$members().$size()+")"),ee(q(F,g.$class().$members().$size()))&&B.$raise(S("IndexError"),"offset "+F+" too large for struct(size:"+g.$class().$members().$size()+")"),F=g.$class().$members()["$[]"](F)):oe(S("String"),F)?g.$$data.hasOwnProperty(F)||B.$raise(S("NameError").$new("no member '"+F+"' in struct",F)):B.$raise(S("TypeError"),"no implicit conversion of "+F.$class()+" into Integer"),F=O["$coerce_to!"](F,S("String"),"to_str"),g.$$data[F]}),D(R,"$[]=",function(F,g){var l=this;return oe(S("Integer"),F)?(ee(z(F,l.$class().$members().$size()["$-@"]()))&&B.$raise(S("IndexError"),"offset "+F+" too small for struct(size:"+l.$class().$members().$size()+")"),ee(q(F,l.$class().$members().$size()))&&B.$raise(S("IndexError"),"offset "+F+" too large for struct(size:"+l.$class().$members().$size()+")"),F=l.$class().$members()["$[]"](F)):oe(S("String"),F)?ee(l.$class().$members()["$include?"](F.$to_sym()))||B.$raise(S("NameError").$new("no member '"+F+"' in struct",F)):B.$raise(S("TypeError"),"no implicit conversion of "+F.$class()+" into Integer"),F=O["$coerce_to!"](F,S("String"),"to_str"),l.$$data[F]=g}),D(R,"$==",function(F){if(!ee(F["$instance_of?"](this.$class())))return!1;var l={},c={};return function f(u,p){var _,y,m;for(_ in l[u.$__id__()]=!0,c[p.$__id__()]=!0,u.$$data)if(y=u.$$data[_],m=p.$$data[_],S("Struct")["$==="](y)){if(!(l.hasOwnProperty(y.$__id__())&&c.hasOwnProperty(m.$__id__())||f(y,m)))return!1}else if(!y["$=="](m))return!1;return!0}(this,F)}),D(R,"$eql?",function(F){if(!ee(F["$instance_of?"](this.$class())))return!1;var l={},c={};return function f(u,p){var _,y,m;for(_ in l[u.$__id__()]=!0,c[p.$__id__()]=!0,u.$$data)if(y=u.$$data[_],m=p.$$data[_],S("Struct")["$==="](y)){if(!(l.hasOwnProperty(y.$__id__())&&c.hasOwnProperty(m.$__id__())||f(y,m)))return!1}else if(!y["$eql?"](m))return!1;return!0}(this,F)}),D(R,"$each",function N(){var F=N.$$p||L,g=this;return N.$$p=null,F===L?E(g,"enum_for",["each"],function l(){return(null==l.$$s?this:l.$$s).$size()},{$$s:g}):(E(g.$class().$members(),"each",[],function l(c){return null==c&&(c=L),C.yield1(F,(null==l.$$s?this:l.$$s)["$[]"](c))},{$$s:g}),g)}),D(R,"$each_pair",function N(){var F=N.$$p||L,g=this;return N.$$p=null,F===L?E(g,"enum_for",["each_pair"],function l(){return(null==l.$$s?this:l.$$s).$size()},{$$s:g}):(E(g.$class().$members(),"each",[],function l(c){return null==c&&(c=L),C.yield1(F,[c,(null==l.$$s?this:l.$$s)["$[]"](c)])},{$$s:g}),g)}),D(R,"$length",function(){return this.$class().$members().$length()}),D(R,"$to_a",function(){return E(this.$class().$members(),"map",[],function g(l){return null==l&&(l=L),(null==g.$$s?this:g.$$s)["$[]"](l)},{$$s:this})});var de=[];return D(R,"$inspect",function(){var F=this,g=L,l=L;return function(){try{return g="#<struct ",ee(de["$include?"](F.$__id__()))?K(g,":...>"):(de["$<<"](F.$__id__()),l=!0,oe(S("Struct"),F)&&ee(F.$class().$name())&&(g=K(g,F.$class()+" ")),g=K(g,E(F.$each_pair(),"map",[],function(f,u){return null==f&&(f=L),null==u&&(u=L),f+"="+k("Opal").$inspect(u)}).$join(", ")),g=K(g,">"))}finally{ee(l)&&de.pop()}}()}),D(R,"$to_h",function N(){var F=N.$$p||L,g=this;return N.$$p=null,F!==L?E(E(g,"map",[],F.$to_proc()),"to_h",G(g.$args())):E(g.$class().$members(),"each_with_object",[Z([],{})],function l(c,f){var u;return null==c&&(c=L),null==f&&(f=L),u=[c,(null==l.$$s?this:l.$$s)["$[]"](c)],E(f,"[]=",u),u[u.length-1]},{$$s:g})}),D(R,"$values_at",function(F){var g,l,c=this;g=me(arguments);for(var f=[],u=0,p=(l=E(l=g,"map",[],function(y){return null==y&&(y=L),y.$$is_range?y.$to_a():y}).$flatten()).length;u<p;u++)l[u].$$is_number||B.$raise(S("TypeError"),"no implicit conversion of "+l[u].$class()+" into Integer"),f.push(c["$[]"](l[u]));return f},-1),D(R,"$dig",function(F,g){var c,f=this,u=L;return c=me(arguments,1),(u=ee(F.$$is_string&&f.$$data.hasOwnProperty(F))&&f.$$data[F]||L)===L||0===c.length?u:(ee(u["$respond_to?"]("dig"))||B.$raise(S("TypeError"),u.$class()+" does not have #dig method"),E(u,"dig",G(c)))},-2),I(R,"size","length"),I(R,"to_s","inspect"),I(R,"values","to_a")}()},Opal.modules["corelib/set"]=function(C){var le=C.freeze,me=C.klass,d=C.slice,H=C.defs,ee=C.hash2,$=C.truthy,x=C.eqeqeq,O=C.Kernel,E=C.send,Y=C.def,G=C.eqeq,D=C.rb_lt,W=C.rb_le,B=C.alias,T=C.nil,j=C.$$$;return function(oe,z,q){var K=me("::",null,"Set"),I=[K].concat([]),A=C.$r(I);function S(M){$(M["$is_a?"](j("Set")))||O.$raise(j("ArgumentError"),"value must be a set")}return K.$$prototype.hash=T,K.$include(j("Enumerable")),H(K,"$[]",function(v){var P,te=this;return P=d(arguments),te.$new(P)},-1),Y(K,"$initialize",function M(v){var P=M.$$p||T,R=this;return M.$$p=null,null==v&&(v=T),R.hash=ee([],{}),$(v["$nil?"]())?T:(x(j("Enumerable"),v)||O.$raise(j("ArgumentError"),"value must be enumerable"),$(P)?E(v,"each",[],function te(k){return null==k&&(k=T),(null==te.$$s?this:te.$$s).$add(C.yield1(P,k))},{$$s:R}):R.$merge(v))},-1),Y(K,"$dup",function(){return this.$class().$new().$merge(this)}),Y(K,"$-",function(v){return $(v["$respond_to?"]("each"))||O.$raise(j("ArgumentError"),"value must be enumerable"),this.$dup().$subtract(v)}),Y(K,"$inspect",function(){return"#<Set: {"+this.$to_a().$join(",")+"}>"}),Y(K,"$==",function(v){var P=this;return!!$(P["$equal?"](v))||($(v["$instance_of?"](P.$class()))?P.hash["$=="](v.$instance_variable_get("@hash")):!(!$(v["$is_a?"](j("Set")))||!G(P.$size(),v.$size()))&&E(v,"all?",[],function R(te){var k=null==R.$$s?this:R.$$s;return null==k.hash&&(k.hash=T),null==te&&(te=T),k.hash["$include?"](te)},{$$s:P}))}),Y(K,"$add",function(v){return this.hash["$[]="](v,!0),this}),Y(K,"$classify",function M(){var v=M.$$p||T,P=this,R=T;return M.$$p=null,v===T?P.$enum_for("classify"):(R=E(j("Hash"),"new",[],function te(k,de){var N;return null==k&&(k=T),null==de&&(de=T),N=[de,(null==te.$$s?this:te.$$s).$class().$new()],E(k,"[]=",N),N[N.length-1]},{$$s:P}),E(P,"each",[],function(k){return null==k&&(k=T),R["$[]"](C.yield1(v,k)).$add(k)}),R)}),Y(K,"$collect!",function M(){var v=M.$$p||T,P=this,R=T;return M.$$p=null,v===T?P.$enum_for("collect!"):(R=P.$class().$new(),E(P,"each",[],function(k){return null==k&&(k=T),R["$<<"](C.yield1(v,k))}),P.$replace(R))}),Y(K,"$compare_by_identity",function(){var v=this;return $(v.hash["$respond_to?"]("compare_by_identity"))?(v.hash.$compare_by_identity(),v):v.$raise(A("NotImplementedError"),v.$class().$name()+"#compare_by_identity is not implemented")}),Y(K,"$compare_by_identity?",function(){var P;return $(P=this.hash["$respond_to?"]("compare_by_identity?"))?this.hash["$compare_by_identity?"]():P}),Y(K,"$delete",function(v){return this.hash.$delete(v),this}),Y(K,"$delete?",function(v){var P=this;return $(P["$include?"](v))?(P.$delete(v),P):T}),Y(K,"$delete_if",function M(){var v=M.$$p||T,P=this;return M.$$p=null,v===T?P.$enum_for("delete_if"):(E(E(P,"select",[],function(te){return null==te&&(te=T),C.yield1(v,te)}),"each",[],function R(te){var k=null==R.$$s?this:R.$$s;return null==k.hash&&(k.hash=T),null==te&&(te=T),k.hash.$delete(te)},{$$s:P}),P)}),Y(K,"$freeze",function(){var v=this;return $(v["$frozen?"]())?v:(v.hash.$freeze(),le(v))}),Y(K,"$keep_if",function M(){var v=M.$$p||T,P=this;return M.$$p=null,v===T?P.$enum_for("keep_if"):(E(E(P,"reject",[],function(te){return null==te&&(te=T),C.yield1(v,te)}),"each",[],function R(te){var k=null==R.$$s?this:R.$$s;return null==k.hash&&(k.hash=T),null==te&&(te=T),k.hash.$delete(te)},{$$s:P}),P)}),Y(K,"$reject!",function M(){var v=M.$$p||T,P=this,R=T;return M.$$p=null,v===T?P.$enum_for("reject!"):(R=P.$size(),E(P,"delete_if",[],v.$to_proc()),G(P.$size(),R)?T:P)}),Y(K,"$select!",function M(){var v=M.$$p||T,P=this,R=T;return M.$$p=null,v===T?P.$enum_for("select!"):(R=P.$size(),E(P,"keep_if",[],v.$to_proc()),G(P.$size(),R)?T:P)}),Y(K,"$add?",function(v){return $(this["$include?"](v))?T:this.$add(v)}),Y(K,"$each",function M(){var v=M.$$p||T,P=this;return M.$$p=null,v===T?P.$enum_for("each"):(E(P.hash,"each_key",[],v.$to_proc()),P)}),Y(K,"$empty?",function(){return this.hash["$empty?"]()}),Y(K,"$eql?",function(v){return this.hash["$eql?"](E(v,"instance_eval",[],function R(){var te=null==R.$$s?this:R.$$s;return null==te.hash&&(te.hash=T),te.hash},{$$s:this}))}),Y(K,"$clear",function(){return this.hash.$clear(),this}),Y(K,"$include?",function(v){return this.hash["$include?"](v)}),Y(K,"$merge",function(v){return E(v,"each",[],function R(te){return null==te&&(te=T),(null==R.$$s?this:R.$$s).$add(te)},{$$s:this}),this}),Y(K,"$replace",function(v){var P=this;return P.$clear(),P.$merge(v),P}),Y(K,"$size",function(){return this.hash.$size()}),Y(K,"$subtract",function(v){return E(v,"each",[],function R(te){return null==te&&(te=T),(null==R.$$s?this:R.$$s).$delete(te)},{$$s:this}),this}),Y(K,"$|",function(v){return $(v["$respond_to?"]("each"))||O.$raise(j("ArgumentError"),"value must be enumerable"),this.$dup().$merge(v)}),Y(K,"$superset?",function(v){return S(v),!$(D(this.$size(),v.$size()))&&E(v,"all?",[],function R(te){return null==te&&(te=T),(null==R.$$s?this:R.$$s)["$include?"](te)},{$$s:this})}),Y(K,"$proper_superset?",function(v){return S(v),!$(W(this.$size(),v.$size()))&&E(v,"all?",[],function R(te){return null==te&&(te=T),(null==R.$$s?this:R.$$s)["$include?"](te)},{$$s:this})}),Y(K,"$subset?",function(v){return S(v),!$(D(v.$size(),this.$size()))&&E(this,"all?",[],function(te){return null==te&&(te=T),v["$include?"](te)})}),Y(K,"$proper_subset?",function(v){return S(v),!$(W(v.$size(),this.$size()))&&E(this,"all?",[],function(te){return null==te&&(te=T),v["$include?"](te)})}),Y(K,"$intersect?",function(v){var P=this;return S(v),$(D(P.$size(),v.$size()))?E(P,"any?",[],function(te){return null==te&&(te=T),v["$include?"](te)}):E(v,"any?",[],function R(te){return null==te&&(te=T),(null==R.$$s?this:R.$$s)["$include?"](te)},{$$s:P})}),Y(K,"$disjoint?",function(v){return this["$intersect?"](v)["$!"]()}),Y(K,"$to_a",function(){return this.hash.$keys()}),B(K,"+","|"),B(K,"<","proper_subset?"),B(K,"<<","add"),B(K,"<=","subset?"),B(K,">","proper_superset?"),B(K,">=","superset?"),B(K,"difference","-"),B(K,"filter!","select!"),B(K,"length","size"),B(K,"map!","collect!"),B(K,"member?","include?"),B(K,"union","|")}()},Opal.modules["corelib/dir"]=function(C){var W,G,me=C.def,d=C.truthy,H=C.alias,$=C.nil,x=C.$$$;return[G=(0,C.klass)("::",null,"Dir")].concat([]),W=C.get_singleton_class(G),me(W,"$chdir",function Z(T){var j=Z.$$p||$,oe=$;return Z.$$p=null,function(){try{return oe=C.current_dir,C.current_dir=T,C.yieldX(j,[])}finally{C.current_dir=oe}}()}),me(W,"$pwd",function(){return C.current_dir||"."}),me(W,"$home",function(){var T;return d(T=x("ENV")["$[]"]("HOME"))?T:"."}),H(W,"getwd","pwd")},Opal.modules["corelib/file"]=function(C){var K,I,A,J,le=C.truthy,d=C.const_set,H=C.Opal,ee=C.regexp,$=C.rb_plus,x=C.def,O=C.Kernel,E=C.eqeq,Y=C.rb_lt,G=C.rb_minus,D=C.range,W=C.send,B=C.slice,Z=C.alias,j=C.nil,oe=C.$$$;return K=[],A=[I=(0,C.klass)("::",oe("IO"),"File")].concat(K),J=j,d(A[0],"Separator",d(A[0],"SEPARATOR","/")),d(A[0],"ALT_SEPARATOR",j),d(A[0],"PATH_SEPARATOR",":"),d(A[0],"FNM_SYSCASE",0),J=/^[a-zA-Z]:(?:\\|\/)/,function(L,S){var M=[L].concat(S),v=C.$r(M);function P(te){return le(te["$respond_to?"]("to_path"))&&(te=te.$to_path()),H["$coerce_to!"](te,oe("String"),"to_str")}function R(){return v("ALT_SEPARATOR")===j?C.escape_regexp(v("SEPARATOR")):C.escape_regexp($(v("SEPARATOR"),v("ALT_SEPARATOR")))}return x(L,"$absolute_path",function(k,de){var N,F,l,c,f,g=j,u=j,p=j,_=j,y=j;null==de&&(de=j),N=v("SEPARATOR"),F=R(),g=[],k=le(k["$respond_to?"]("to_path"))?k.$to_path():k,k=H["$coerce_to!"](k,oe("String"),"to_str"),de=le(l=de)?l:oe("Dir").$pwd(),c=k.substr(0,N.length)===N||J.test(k),f=de.substr(0,N.length)===N||J.test(de),le(c)?(u=k.$split(ee(["[",F,"]"])),p=J.test(k)?"":k.$sub(ee(["^([",F,"]+).*$"]),"\\1"),_=!0):(u=$(de.$split(ee(["[",F,"]"])),k.$split(ee(["[",F,"]"]))),p=J.test(de)?"":de.$sub(ee(["^([",F,"]+).*$"]),"\\1"),_=f);for(var m,ne=0,se=u.length;ne<se;ne++)(m=u[ne])!==j&&(""!==m||0!==g.length&&!_)&&("."!==m||0!==g.length&&!_)&&(".."===m?g.pop():g.push(m));return!_&&"."!==u[0]&&g.$unshift("."),y=g.$join(N),le(_)&&(y=$(p,y)),y},-2),x(L,"$expand_path",function(k,de){var F,g,l=j,c=j,f=j;return null==de&&(de=j),F=v("SEPARATOR"),g=R(),le("~"===k[0]||de&&"~"===de[0])&&(l=v("Dir").$home(),le(l)||O.$raise(oe("ArgumentError"),"couldn't find HOME environment -- expanding `~'"),c=J.test(l)?"":l.$sub(ee(["^([",g,"]+).*$"]),"\\1"),le(l["$start_with?"](c))||O.$raise(oe("ArgumentError"),"non-absolute home"),l=$(l,F),f=ee(["^\\~(?:",F,"|$)"]),k=k.$sub(f,l),le(de)&&(de=de.$sub(f,l))),this.$absolute_path(k,de)},-2),x(L,"$dirname",function(k,de){var F;if(null==de&&(de=1),E(de,0))return k;le(Y(de,0))&&O.$raise(oe("ArgumentError"),"level can't be negative"),F=R();var l,g=(k=P(k)).match(new RegExp("^["+F+"]"));return l=""===(k=(k=(k=k.replace(new RegExp("["+F+"]+$"),"")).replace(new RegExp("[^"+F+"]+$"),"")).replace(new RegExp("["+F+"]+$"),""))?g?"/":".":k,1==de?l:this.$dirname(l,G(de,1))},-2),x(L,"$basename",function(k,de){var N;return null==de&&(de=j),N=R(),0==(k=P(k)).length||(de=de!==j?H["$coerce_to!"](de,oe("String"),"to_str"):null,k=(k=k.replace(new RegExp("(.)["+N+"]*$"),"$1")).replace(new RegExp("^(?:.*["+N+"])?([^"+N+"]+)$"),"$1"),".*"===de?k=k.replace(/\.[^\.]+$/,""):null!==de&&(de=C.escape_regexp(de),k=k.replace(new RegExp(de+"$"),""))),k},-2),x(L,"$extname",function(k){var N=j,F=j;return k=P(k),N=this.$basename(k),le(N["$empty?"]())||(F=N["$[]"](D(1,-1,!1)).$rindex("."),le(F["$nil?"]())||E($(F,1),G(N.$length(),1)))?"":N["$[]"](C.Range.$new($(F,1),-1,!1))}),x(L,"$exist?",function(k){return null!=C.modules[k]}),x(L,"$directory?",function(k){var de=j;for(var N in de=[],C.modules)de.push(N);return k=k.$gsub(ee(["(^.",v("SEPARATOR"),"+|",v("SEPARATOR"),"+$)"])),W(de,"find",[],function(g){return null==g&&(g=j),g["$=~"](ee(["^",k]))})}),x(L,"$join",function(k){var de,N,F=j;return de=B(arguments),le((N=de)["$empty?"]())?"":(F="",N=W(N.$flatten().$each_with_index(),"map",[],function(l,c){return null==l&&(l=j),null==c&&(c=j),E(c,0)&&le(l["$empty?"]())||E(N.$length(),$(c,1))&&le(l["$empty?"]())?v("SEPARATOR"):l}),N=W(N,"reject",[],"empty?".$to_proc()),W(N,"each_with_index",[],function(l,c){var f=j;return null==l&&(l=j),null==c&&(c=j),f=N["$[]"]($(c,1)),le(f["$nil?"]())?F=""+F+l:(le(l["$end_with?"](v("SEPARATOR")))&&le(f["$start_with?"](v("SEPARATOR")))&&(l=l.$sub(ee([v("SEPARATOR"),"+$"]),"")),F=le(l["$end_with?"](v("SEPARATOR")))||le(f["$start_with?"](v("SEPARATOR")))?""+F+l:""+F+l+v("SEPARATOR"))}),F)},-1),x(L,"$split",function(k){return k.$split(v("SEPARATOR"))}),Z(L,"realpath","expand_path"),Z(L,"exists?","exist?")}(C.get_singleton_class(I),A)},Opal.modules["corelib/process/base"]=function(C){var O,le=C.klass,me=C.slice,d=C.defs,H=C.return_val,ee=C.nil;return O=le("::",null,"Signal"),d(O,"$trap",function(Y){return me(arguments),ee},-1),function($,x){var O=le("::",null,"GC");return d(O,"$start",H(ee))}()},Opal.modules["corelib/process"]=function(C){var le=C.module,me=C.defs,d=C.truthy,H=C.return_val,ee=C.Kernel,$=C.nil,x=C.$$$;return function(O){var E=le("::","Process"),Y=$;if(E.__clocks__=[],me(E,"$__register_clock__",function(W,B){var Z=this;return null==Z.__clocks__&&(Z.__clocks__=$),Z.$const_set(W,Z.__clocks__.$size()),Z.__clocks__["$<<"](B)}),E.$__register_clock__("CLOCK_REALTIME",function(){return Date.now()}),Y=!1,C.global.performance)Y=function(){return performance.now()};else if(C.global.process&&process.hrtime){var G=process.hrtime();Y=function(){var D=process.hrtime(G);return 1e3*D[0]+(D[1]/1e3|0)/1e3}}return d(Y)&&E.$__register_clock__("CLOCK_MONOTONIC",Y),me(E,"$pid",H(0)),me(E,"$times",function(){var W;return W=x("Time").$now().$to_f(),x(x("Benchmark"),"Tms").$new(W,W,W,W,W)}),me(E,"$clock_gettime",function(W,B){var Z=this,j=$;null==Z.__clocks__&&(Z.__clocks__=$),null==B&&(B="float_second"),d(j=Z.__clocks__["$[]"](W))||ee.$raise(x(x("Errno"),"EINVAL"),"clock_gettime("+W+") "+Z.__clocks__["$[]"](W));var oe=j();switch(B){case"float_second":return oe/1e3;case"float_millisecond":return oe/1;case"float_microsecond":return 1e3*oe;case"second":return oe/1e3|0;case"millisecond":return oe/1|0;case"microsecond":return 1e3*oe|0;case"nanosecond":return 1e6*oe|0;default:ee.$raise(x("ArgumentError"),"unexpected unit: "+B)}},-2)}()},Opal.modules["corelib/random/formatter"]=function(C){var B,oe,z,q,K,Z,me=C.module,d=C.def,H=C.range,ee=C.send,$=C.rb_divide,x=C.Kernel,O=C.Opal,Y=C.nil,G=C.$$$;return B=[],oe=[Z=(0,C.klass)("::",null,"Random")].concat(B),q=[z=me(Z,"Formatter")].concat(oe),K=C.$r(q),d(z,"$hex",function(A){null==A&&(A=Y),A=G("Random").$_verify_count(A);for(var L=this.$bytes(A),S="",M=0;M<A;M++)S+=L.charCodeAt(M).toString(16).padStart(2,"0");return S.$encode("US-ASCII")},-1),d(z,"$random_bytes",function(A){return null==A&&(A=Y),this.$bytes(A)},-1),d(z,"$base64",function(A){return null==A&&(A=Y),G("Base64").$strict_encode64(this.$random_bytes(A)).$encode("US-ASCII")},-1),d(z,"$urlsafe_base64",function(A,J){return null==A&&(A=Y),null==J&&(J=!1),G("Base64").$urlsafe_encode64(this.$random_bytes(A),J).$encode("US-ASCII")},-1),d(z,"$uuid",function(){var J=Y;return(J=this.$hex(16).$split(""))["$[]="](12,"4"),J["$[]="](16,(3&parseInt(J["$[]"](16),16)|8).toString(16)),J=[J["$[]"](H(0,8,!0)),J["$[]"](H(8,12,!0)),J["$[]"](H(12,16,!0)),J["$[]"](H(16,20,!0)),J["$[]"](H(20,32,!0))],(J=ee(J,"map",[],"join".$to_proc())).$join("-")}),d(z,"$random_float",function(){var J=Y,L=Y;return J=this.$bytes(4),L=0,ee(4,"times",[],function(M){return null==M&&(M=Y),L=(L=L["$<<"](8))["$|"](J["$[]"](M).$ord())}),$(L.$abs(),2147483647)}),d(z,"$random_number",function(A){var J=this;function L(){return J.$random_float()}function S(v){return Math.floor(L()*v)}return null==A?L():A.$$is_range?function M(){var v=A.begin,P=A.end;if(v===Y||P===Y)return Y;var R=P-v;return R<0?Y:0===R?v:(P%1==0&&v%1==0&&!A.excl&&R++,S(R)+v)}():A.$$is_number?(A<=0&&x.$raise(G("ArgumentError"),"invalid argument - "+A),A%1==0?S(A):L()*A):((A=O["$coerce_to!"](A,G("Integer"),"to_int"))<=0&&x.$raise(G("ArgumentError"),"invalid argument - "+A),S(A))},-1),d(z,"$alphanumeric",function(A){var L=Y;return null==A&&(A=Y),A=K("Random").$_verify_count(A),L=ee([H("0","9",!1),H("a","z",!1),H("A","Z",!1)],"map",[],"to_a".$to_proc()).$flatten(),ee(G("Array"),"new",[A],function S(M){return null==M&&(M=Y),L["$[]"]((null==S.$$s?this:S.$$s).$random_number(L.$length()))},{$$s:this}).$join()},-1),Z.$include(G(G("Random"),"Formatter")),Z.$extend(G(G("Random"),"Formatter"))},Opal.modules["corelib/random/mersenne_twister"]=function(C){var Y,E,G,le=C.klass,me=C.const_set,d=C.send,ee=C.$$$,$=C.nil;return $=function(){var x=624,O=397,W=function(q,K){return function(q,K){return 2147483648&q|2147483647&K}(q,K)>>>1^(1&K?2567483615:0)};function j(q){var K;return--q.left<=0&&function T(q){var A,K=0,I=q.state;for(q.left=x,q.next=0,A=228;--A;K++)I[K]=I[K+O]^W(I[K+0],I[K+1]);for(A=O;--A;K++)I[K]=I[K+(O-x)]^W(I[K+0],I[K+1]);I[K]=I[K+(O-x)]^W(I[K+0],I[0])}(q),K=q.state[q.next++],K^=K>>>11,K^=K<<7&2636928640,K^=K<<15&4022730752,(K^=K>>>18)>>>0}return{genrand_real:function z(q){return function oe(q,K){return(67108864*(q>>>=5)+(K>>>=6))*(1/9007199254740992)}(j(q),j(q))},init:function B(q){var K={left:0,next:x,state:new Array(x)};return function Z(q,K){var I;for(q.state[0]=K>>>0,I=1;I<x;I++)q.state[I]=1812433253*(q.state[I-1]^q.state[I-1]>>30>>>0)+I,q.state[I]&=4294967295;q.left=1,q.next=x}(K,q),K}}}(),E=le("::",null,"Random"),G=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1,me(E,"MERSENNE_TWISTER_GENERATOR",{new_seed:function(){return Math.round(Math.random()*G)},reseed:function(D){return $.init(D)},rand:function(D){return $.genrand_real(D)}}),d(E,"generator=",Y=[ee(E,"MERSENNE_TWISTER_GENERATOR")]),Y[Y.length-1]},Opal.modules["corelib/random"]=function(C){var B,le=C.truthy,me=C.klass,d=C.Kernel,H=C.defs,ee=C.Opal,$=C.def,x=C.eqeqeq,O=C.send,E=C.top,Y=C.nil,G=C.$$$;return E.$require("corelib/random/formatter"),(B=me("::",null,"Random")).$attr_reader("seed","state"),H(B,"$_verify_count",function(T){return le(T)||(T=16),"number"!=typeof T&&(T=T.$to_int()),T<0&&d.$raise(G("ArgumentError"),"negative string size (or size too big)"),Math.floor(T)}),$(B,"$initialize",function(T){return null==T&&(T=G("Random").$new_seed()),T=ee["$coerce_to!"](T,G("Integer"),"to_int"),this.state=T,this.$reseed(T)},-1),$(B,"$reseed",function(T){return this.seed=T,this.$rng=C.$$rand.reseed(T)}),H(B,"$new_seed",function(){return C.$$rand.new_seed()}),H(B,"$rand",function(T){return G(this,"DEFAULT").$rand(T)},-1),H(B,"$srand",function(T){var oe;return null==T&&(T=G("Random").$new_seed()),T=ee["$coerce_to!"](T,G("Integer"),"to_int"),oe=G(this,"DEFAULT").$seed(),G(this,"DEFAULT").$reseed(T),oe},-1),H(B,"$urandom",function(T){return G("SecureRandom").$bytes(T)}),$(B,"$==",function(T){var oe=Y;return!!x(G("Random"),T)&&(le(oe=this.$seed()["$=="](T.$seed()))?this.$state()["$=="](T.$state()):oe)}),$(B,"$bytes",function(T){return T=G("Random").$_verify_count(T),O(G("Array"),"new",[T],function oe(){return(null==oe.$$s?this:oe.$$s).$rand(255).$chr()},{$$s:this}).$join().$encode("ASCII-8BIT")}),H(B,"$bytes",function(T){return G(this,"DEFAULT").$bytes(T)}),$(B,"$rand",function(T){return this.$random_number(T)},-1),$(B,"$random_float",function(){return this.state++,C.$$rand.rand(this.$rng)}),H(B,"$random_float",function(){return G(this,"DEFAULT").$random_float()}),H(B,"$generator=",function(T){var j=this;return C.$$rand=T,le(j["$const_defined?"]("DEFAULT"))?G(j,"DEFAULT").$reseed():j.$const_set("DEFAULT",j.$new(j.$new_seed()))}),E.$require("corelib/random/mersenne_twister")},Opal.modules["corelib/unsupported"]=function(C){var oe,z,q,le=C.Kernel,me=C.klass,d=C.send,H=C.slice,ee=C.module,$=C.def,x=C.return_val,O=C.alias,E=C.defs,Y=C.top,D=C.nil,W=C.$$$,B={};function Z(j){switch(C.config.unsupported_features_severity){case"error":le.$raise(W("NotImplementedError"),j);break;case"warning":!function T(j){B[j]||(B[j]=!0,Y.$warn(j))}(j)}}return z=me("::",null,"String"),q="String#%s not supported. Mutable String methods are not supported in Opal.",d(["<<","capitalize!","chomp!","chop!","downcase!","gsub!","lstrip!","next!","reverse!","slice!","squeeze!","strip!","sub!","succ!","swapcase!","tr!","tr_s!","upcase!","prepend","[]=","clear","encode!","unicode_normalize!"],"each",[],function K(I){return null==I&&(I=D),d(null==K.$$s?this:K.$$s,"define_method",[I],function(L){return H(arguments),le.$raise(W("NotImplementedError"),q["$%"](I))},-1)},{$$s:z}),function(j){var oe=ee("::","Kernel"),z="Object tainting is not supported by Opal";$(oe,"$taint",function(){return Z(z),this}),$(oe,"$untaint",function(){return Z(z),this}),$(oe,"$tainted?",function(){return Z(z),!1})}(),function(j,oe){var z=me("::",null,"Module");$(z,"$public",function(K){var A,J=this;return 0===(A=H(arguments)).length?(J.$$module_function=!1,D):1===A.length?A[0]:A},-1),$(z,"$private_class_method",function(K){var A;return 1===(A=H(arguments)).length?A[0]:A},-1),$(z,"$private_method_defined?",x(!1)),$(z,"$private_constant",function(K){return H(arguments),D},-1),O(z,"nesting","public"),O(z,"private","public"),O(z,"protected","public"),O(z,"protected_method_defined?","private_method_defined?"),O(z,"public_class_method","private_class_method"),O(z,"public_instance_method","instance_method"),O(z,"public_instance_methods","instance_methods"),O(z,"public_method_defined?","method_defined?")}(),oe=ee("::","Kernel"),$(oe,"$private_methods",function(q){return H(arguments),[]},-1),O(oe,"protected_methods","private_methods"),O(oe,"private_instance_methods","private_methods"),O(oe,"protected_instance_methods","private_methods"),function(j,oe){var z=ee("::","Kernel"),q=[z].concat([]),K=C.$r(q);$(z,"$eval",function(A){return H(arguments),le.$raise(W("NotImplementedError"),"To use Kernel#eval, you must first require 'opal-parser'. See https://github.com/opal/opal/blob/"+K("RUBY_ENGINE_VERSION")+"/docs/opal_parser.md for details.")},-1)}(),E(Y,"$public",function(oe){var q;return 1===(q=H(arguments)).length?q[0]:q},-1),E(Y,"$private",function(oe){var q;return 1===(q=H(arguments)).length?q[0]:q},-1)},Opal.modules["corelib/binding"]=function(C){var z,q,me=C.truthy,d=C.def,H=C.slice,ee=C.send,$=C.to_a,x=C.Kernel,O=C.return_ivar,E=C.eqeq,Y=C.thrower,G=C.module,D=C.const_set,W=C.top,Z=C.nil,T=C.$$$;return(q=(z=(0,C.klass)("::",null,"Binding")).$$prototype).jseval=q.scope_variables=Z,d(z,"$initialize",function(I,A,J,L){var S,M=this;return null==A&&(A=[]),null==L&&(L=Z),M.jseval=(S=[I,A,J,L])[0],M.scope_variables=S[1],M.receiver=S[2],M.source_location=S[3],me(void 0!==typeof J)?Z:J=M.$js_eval("self")},-2),d(z,"$js_eval",function(I){var J,L=this;return J=H(arguments),me(L.jseval)?ee(L.jseval,"call",$(J)):x.$raise("Evaluation on a Proc#binding is not supported")},-1),d(z,"$local_variable_get",function(I){try{return this.$js_eval(I)}catch(J){if(!C.rescue(J,[T("Exception")]))throw J;try{return x.$raise(T("NameError"),"local variable `"+I+"' is not defined for "+this.$inspect())}finally{C.pop_exception()}}}),d(z,"$local_variable_set",function(I,A){return C.Binding.tmp_value=A,this.$js_eval(I+" = Opal.Binding.tmp_value"),delete C.Binding.tmp_value,A}),d(z,"$local_variables",O("scope_variables")),d(z,"$local_variable_defined?",function(I){return this.scope_variables["$include?"](I)}),d(z,"$eval",function(I,A,J){try{return Y("eval_return"),null==A&&(A=Z),null==J&&(J=Z),E(I,"self")?this.$receiver():x.$eval(I,this,A,J)}catch(M){if(M===C.t_eval_return)return M.$v;throw M}},-2),z.$attr_reader("receiver","source_location"),d(G("::","Kernel"),"$binding",function(){return x.$raise("Opal doesn't support dynamic calls to binding")}),D([][0],"TOPLEVEL_BINDING",T("Binding").$new(function(j){return new Function("self","return "+j)(W)},[],W,["<main>",0]))},Opal.modules["corelib/irb"]=function(C){var K,L,te,k,S,M,v,A,le=C.module,me=C.truthy,d=C.Kernel,H=C.defs,ee=C.hash,$=C.gvars,x=C.lambda,O=C.send,E=C.rb_plus,Y=C.const_set,G=C.klass,D=C.def,W=C.Opal,B=C.range,Z=C.eqeq,T=C.thrower,j=[],oe=C.nil,z=C.$$$;K=j,L=A=[le(j[0],"Opal")].concat(K),M=[S=le(A[0],"IRB")].concat(L),v=C.$r(M),H(S,"$ensure_loaded",function(R){var k,de;if(me(C.loaded_features["$include?"](R)))return oe;if(k="https://cdn.opalrb.com/opal/"+(me(v("RUBY_ENGINE_VERSION")["$include?"]("dev"))?"master":v("RUBY_ENGINE_VERSION"))+"/"+R+".js","undefined"!=typeof XMLHttpRequest){var N=new XMLHttpRequest;N.open("GET",k,!1),N.send(""),de=N.responseText}else d.$raise("You need to provision "+R+" yourself in this environment");return new Function("Opal",de)(C),C.require(R),me(C.loaded_features["$include?"](R))?oe:d.$raise("Could not load "+R+" for some reason")}),S.$singleton_class().$attr_accessor("output"),H(S,"$prepare_console",function P(){var R=P.$$p||oe,k=this,de=oe,N=oe;return null==$.stdout&&($.stdout=oe),null==$.stderr&&($.stderr=oe),null==$.stdin&&($.stdin=oe),P.$$p=null,function(){try{return k["$output="](""),de=ee($.stdout,x(function(g){return null==g&&(g=oe),$.stdout=g}),$.stderr,x(function(g){return null==g&&(g=oe),$.stderr=g})),me(k["$browser?"]())&&(O(de,"each",[],function F(g,l){var c=null==F.$$s?this:F.$$s,f=oe;return null==g&&(g=oe),null==l&&(l=oe),(f=g.$dup())["$write_proc="](O(c,"proc",[],function u(p){var _=null==u.$$s?this:u.$$s;return null==p&&(p=oe),_["$output="](E(_.$output(),p)),_["$output="](_.$output().$split("\n").$last(30).$join("\n")),me(p["$end_with?"]("\n"))&&_["$output="](E(_.$output(),"\n")),g.$write_proc().$call(p)},{$$s:c})),f["$tty="](!1),l.$call(f)},{$$s:k}),N=$.stdin.$read_proc(),$.stdin["$read_proc="](function(F){var g=prompt(k.$output());return null!==g?g+"\n":oe})),C.yieldX(R,[])}finally{O(de,"each",[],function(g,l){return null==g&&(g=oe),null==l&&(l=oe),l.$call(g)}),O($.stdin,"read_proc=",[N]),O(k,"output=",[""])}}()}),H(S,"$browser?",function(){return"undefined"!=typeof document&&"undefined"!=typeof prompt}),Y(M[0],"LINEBREAKS",["unexpected token $end","unterminated string meets end of file"].$freeze()),(k=(te=G(M[0],null,"Silencer")).$$prototype).collector=k.stderr=oe,D(te,"$initialize",function(){return null==$.stderr&&($.stderr=oe),this.stderr=$.stderr}),D(te,"$silence",function de(){var N=de.$$p||oe,F=this;return de.$$p=null,function(){try{return F.collector=z("StringIO").$new(),$.stderr=F.collector,C.yieldX(N,[])}finally{$.stderr=F.stderr}}()}),D(te,"$warnings",function(){return this.collector.$string()}),function(q,K,I){var A=G("::",null,"Binding"),J=[A].concat(I),L=C.$r(J);D(A,"$irb",function(){try{var M=T("return"),P=oe;return z(W,"IRB").$ensure_loaded("opal-replutils"),P=z(z(W,"IRB"),"Silencer").$new(),O(z(W,"IRB"),"prepare_console",[],function R(){var te=null==R.$$s?this:R.$$s;return function(){try{var k=T("break");return O(te,"loop",[],function de(){var N=null==de.$$s?this:de.$$s,F=oe,g=oe,l=oe,c=oe,f=oe;for(N.$print(">> "),F=N.$gets(),me(F)||k.$throw(),g="",me(z(W,"IRB")["$browser?"]())&&N.$puts(F),me(F["$start_with?"]("ls "))?(g=F["$[]"](B(3,-1,!1)),l="ls"):Z(F,"ls\n")?(g="self",l="ls"):me(F["$start_with?"]("show "))?(g=F["$[]"](B(5,-1,!1)),l="show"):(g=F,l="inspect"),c=oe;;){try{O(P,"silence",[],function(){return c=C.compile(g,{irb:!0})})}catch(u){if(!C.rescue(u,[L("SyntaxError")]))throw u;f=u;try{if(me(z(z(W,"IRB"),"LINEBREAKS")["$include?"](f.$message()))){N.$print(".. "),F=N.$gets(),me(F)||M.$throw(),me(z(W,"IRB")["$browser?"]())&&N.$puts(F),g=E(g,F);continue}me(P.$warnings()["$empty?"]())?N.$warn(f.$full_message()):N.$warn(P.$warnings())}finally{C.pop_exception()}}break}return Z(l,"show")&&(N.$puts(c),M.$throw()),N.$puts(z("REPLUtils").$eval_and_print(c,l,!1,N))},{$$s:te,$$ret:M})}catch(de){if(de===k)return de.$v;throw de}}()},{$$s:this})}catch(R){if(R===M)return R.$v;throw R}})}(0,0,j),C.irb=function(q){z("Binding").$new(q).$irb()},C.load_parser=function(){C.Opal.IRB.$ensure_loaded("opal-parser")},void 0===C.eval&&(C.eval=function(q){return C.load_parser(),C.eval(q)}),void 0===C.compile&&(C.compile=function(q,K){return C.load_parser(),C.compile(q,K)})},Opal.queue(function(C){var le=C.Object;return le.$require("opal/base"),le.$require("opal/mini"),le.$require("corelib/kernel/format"),le.$require("corelib/string/encoding"),le.$autoload("Math","corelib/math"),le.$require("corelib/complex/base"),le.$autoload("Complex","corelib/complex"),le.$require("corelib/rational/base"),le.$autoload("Rational","corelib/rational"),le.$require("corelib/time"),le.$autoload("Struct","corelib/struct"),le.$autoload("Set","corelib/set"),le.$autoload("Dir","corelib/dir"),le.$autoload("File","corelib/file"),le.$require("corelib/process/base"),le.$autoload("Process","corelib/process"),le.$autoload("Random","corelib/random"),le.$require("corelib/unsupported"),le.$require("corelib/binding"),le.$require("corelib/irb")}),Opal.queue(function(C){var R,F,g,l,c,te,k,de,le=C.module,me=C.defs,d=C.slice,H=C.truthy,ee=C.send,$=C.Kernel,x=C.extract_kwargs,O=C.ensure_kwargs,E=C.range,Y=C.to_a,G=C.def,D=C.return_ivar,W=C.alias,B=C.klass,Z=C.rb_minus,T=C.return_val,j=C.hash2,oe=C.send2,z=C.find_super,q=C.eqeqeq,K=C.rb_ge,I=C.return_self,A=C.gvars,J=C.top,L=[],S=C.$r(L),M=C.nil,v=C.$$$;return R=L,k=[te=le(L[0],"Native")].concat(R),de=C.$r(k),me(te,"$is_a?",function(F,g){try{return F instanceof this.$try_convert(g)}catch(c){return!1}}),me(te,"$try_convert",function(F,g){return null==g&&(g=M),this["$native?"](F)?F:F["$respond_to?"]("to_n")?F.$to_n():g},-2),me(te,"$convert",function(F){return this["$native?"](F)?F:F["$respond_to?"]("to_n")?F.$to_n():void this.$raise(de("ArgumentError"),F.$inspect()+" isn't native")}),me(te,"$call",function N(F,g,l){var u,c=N.$$p||M,p=this;N.$$p=null,u=d(arguments,2);var _=F[g];if(_ instanceof Function){for(var y=new Array(u.length),m=0,ne=u.length;m<ne;m++){var se=u[m],Ee=p.$try_convert(se);y[m]=Ee===M?se:Ee}return c!==M&&y.push(c),p.$Native(_.apply(F,y))}return p.$Native(_)},-3),me(te,"$proc",function N(){var F=N.$$p||M;return N.$$p=null,H(F)||this.$raise(de("LocalJumpError"),"no block given"),ee($,"proc",[],function l(c){var f,u,p=null==l.$$s?this:l.$$s,_=M;if(f=d(arguments),ee(u=f,"map!",[],function m(ne){return null==ne&&(ne=M),(null==m.$$s?this:m.$$s).$Native(ne)},{$$s:p}),_=p.$Native(this),this===C.global)return F.apply(p,u);var y=F.$$s;F.$$s=null;try{return F.apply(_,u)}finally{F.$$s=y}},{$$arity:-1,$$s:this})}),F=k,l=[g=le(k[0],"Helpers")].concat(F),c=C.$r(l),G(g,"$alias_native",function f(u,p,_){var y,m,ne,se,ke=this;return f.$$p=null,y=d(arguments,1),m=x(y),m=O(m),y.length>0&&(ne=y.shift()),null==ne&&(ne=u),null==(se=m.$$smap.as)&&(se=M),H(ne["$end_with?"]("="))?ee(ke,"define_method",[u],function ce(Me){var $e=null==ce.$$s?this:ce.$$s;return null==$e.native&&($e.native=M),null==Me&&(Me=M),$e.native[ne["$[]"](E(0,-2,!1))]=c("Native").$convert(Me),Me},{$$s:ke}):H(se)?ee(ke,"define_method",[u],function ce(Me){var he,$e=ce.$$p||M,Se=null==ce.$$s?this:ce.$$s,ve=M;return null==Se.native&&(Se.native=M),ce.$$p=null,he=d(arguments),ve=ee(c("Native"),"call",[Se.native,ne].concat(Y(he)),$e.$to_proc()),H(ve)?se.$new(ve.$to_n()):M},{$$arity:-1,$$s:ke}):ee(ke,"define_method",[u],function ce(Me){var he,$e=ce.$$p||M,Se=null==ce.$$s?this:ce.$$s;return null==Se.native&&(Se.native=M),ce.$$p=null,he=d(arguments),ee(c("Native"),"call",[Se.native,ne].concat(Y(he)),$e.$to_proc())},{$$arity:-1,$$s:ke})},-2),G(g,"$native_reader",function(u){var p,y=this;return p=d(arguments),ee(p,"each",[],function m(ne){var se=null==m.$$s?this:m.$$s;return null==ne&&(ne=M),ee(se,"define_method",[ne],function Ee(){var ke=null==Ee.$$s?this:Ee.$$s;return null==ke.native&&(ke.native=M),ke.$Native(ke.native[ne])},{$$s:se})},{$$s:y})},-1),G(g,"$native_writer",function(u){var p,y=this;return p=d(arguments),ee(p,"each",[],function m(ne){var se=null==m.$$s?this:m.$$s;return null==ne&&(ne=M),ee(se,"define_method",[ne+"="],function Ee(ke){var ce=null==Ee.$$s?this:Ee.$$s;return null==ce.native&&(ce.native=M),null==ke&&(ke=M),ce.$Native(ce.native[ne]=ke)},{$$s:se})},{$$s:y})},-1),G(g,"$native_accessor",function(u){var p,_,y=this;return p=d(arguments),ee(y,"native_reader",Y(_=p)),ee(y,"native_writer",Y(_))},-1),function(N,F){var g=le(N,"Wrapper"),l=[g].concat(F),c=C.$r(l);G(g,"$initialize",function(u){return H($["$native?"](u))||$.$raise(c("ArgumentError"),u.$inspect()+" isn't native"),this.native=u}),G(g,"$to_n",D("native")),me(g,"$included",function(u){return u.$extend(c("Helpers"))})}(k[0],k),me(te,"$included",function(F){return this.$warn("Including ::Native is deprecated. Please include Native::Wrapper instead."),F.$include(de("Wrapper"))}),function(P,R){var te=le(P,"Kernel"),k=[te].concat(R),de=C.$r(k);G(te,"$native?",function(F){return null==F||!F.$$class}),G(te,"$Native",function N(F){var l=this;return N.$$p=null,H(null==F)?M:H(l["$native?"](F))?v(de("Native"),"Object").$new(F):H(F["$is_a?"](de("Array")))?ee(F,"map",[],function c(f){return null==f&&(f=M),(null==c.$$s?this:c.$$s).$Native(f)},{$$s:l}):H(F["$is_a?"](de("Proc")))?ee(l,"proc",[],function c(f){var p,u=c.$$p||M,y=null==c.$$s?this:c.$$s;return c.$$p=null,p=d(arguments),y.$Native(ee(F,"call",Y(p),u.$to_proc()))},{$$arity:-1,$$s:l}):F}),W(te,"_Array","Array"),G(te,"$Array",function N(F,g){var f,l=N.$$p||M,u=this;return N.$$p=null,f=d(arguments,1),H(u["$native?"](F))?ee(v(de("Native"),"Array"),"new",[F].concat(Y(f)),l.$to_proc()).$to_a():u.$_Array(F)},-2)}(L[0],L),function(P,R){var te=B(P,R,"Object");te.$$prototype.native=M,te.$include(v(v("Native"),"Wrapper")),G(te,"$==",function(N){return this.native===v("Native").$try_convert(N)}),G(te,"$has_key?",function(N){return C.hasOwnProperty.call(this.native,N)}),G(te,"$each",function de(N){var g,l=de.$$p||M,c=this;if(de.$$p=null,g=d(arguments),l!==M){for(var f in c.native)C.yieldX(l,[f,c.native[f]]);return c}return ee(c,"method_missing",["each"].concat(Y(g)))},-1),G(te,"$[]",function(N){var g=this.native[N];return g instanceof Function?g:v("Native").$call(this.native,N)}),G(te,"$[]=",function(N,F){var l;return l=v("Native").$try_convert(F),this.native[N]=H(l===M)?F:l}),G(te,"$merge!",function(N){for(var g in N=v("Native").$convert(N))this.native[g]=N[g];return this}),G(te,"$respond_to?",function(N,F){return null==F&&(F=!1),$.$instance_method("respond_to?").$bind(this).$call(N,F)},-2),G(te,"$respond_to_missing?",function(N,F){return null==F&&(F=!1),C.hasOwnProperty.call(this.native,N)},-2),G(te,"$method_missing",function de(N,F){var c,f,g=de.$$p||M,u=this;return de.$$p=null,c=d(arguments,1),"="===N.charAt(N.length-1)?(f=[N.$slice(0,Z(N.$length(),1)),c["$[]"](0)],ee(u,"[]=",f),f[f.length-1]):ee(v("Native"),"call",[u.native,N].concat(Y(c)),g.$to_proc())},-2),G(te,"$nil?",T(!1)),G(te,"$is_a?",function(N){return C.is_a(this,N)}),G(te,"$instance_of?",function(N){return this.$$class===N}),G(te,"$class",function(){return this.$$class}),G(te,"$to_a",function de(N){var F=de.$$p||M;return de.$$p=null,null==N&&(N=j([],{})),ee(v(v("Native"),"Array"),"new",[this.native,N],F.$to_proc()).$to_a()},-1),G(te,"$inspect",function(){return"#<Native:"+String(this.native)+">"}),W(te,"include?","has_key?"),W(te,"key?","has_key?"),W(te,"kind_of?","is_a?"),W(te,"member?","has_key?")}(S("Native"),S("BasicObject")),function(P,R,te){var k=B(P,null,"Array"),de=[k].concat(te),N=C.$r(de),F=k.$$prototype;F.named=F.native=F.get=F.block=F.set=F.length=M,k.$include(v(N("Native"),"Wrapper")),k.$include(N("Enumerable")),G(k,"$initialize",function g(l,c){var f=g.$$p||M,u=this,p=M;return g.$$p=null,null==c&&(c=j([],{})),oe(u,z(u,"initialize",g,!1,!0),"initialize",[l],null),u.get=H(p=c["$[]"]("get"))?p:c["$[]"]("access"),u.named=c["$[]"]("named"),u.set=H(p=c["$[]"]("set"))?p:c["$[]"]("access"),u.length=H(p=c["$[]"]("length"))?p:"length",u.block=f,H(null==u.$length())?u.$raise(N("ArgumentError"),"no length found on the array-like object"):M},-2),G(k,"$each",function g(){var l=g.$$p||M,c=this;if(g.$$p=null,!H(l))return c.$enum_for("each");for(var f=0,u=c.$length();f<u;f++)C.yield1(l,c["$[]"](f));return c}),G(k,"$[]",function(l){var f,u,c=this;return f=q(N("String"),u=l)||q(N("Symbol"),u)?H(c.named)?c.native[c.named](l):c.native[l]:q(N("Integer"),u)?H(c.get)?c.native[c.get](l):c.native[l]:M,H(f)?H(c.block)?c.block.$call(f):c.$Native(f):M}),G(k,"$[]=",function(l,c){var f=this;return H(f.set)?f.native[f.set](l,N("Native").$convert(c)):f.native[l]=N("Native").$convert(c)}),G(k,"$last",function(l){var c=this,f=M,u=M;if(null==l&&(l=M),H(l)){for(f=Z(c.$length(),1),u=[];H(K(f,0));)u["$<<"](c["$[]"](f)),f=Z(f,1);return u}return c["$[]"](Z(c.$length(),1))},-1),G(k,"$length",function(){return this.native[this.length]}),G(k,"$inspect",function(){return this.$to_a().$inspect()}),W(k,"to_ary","to_a")}(S("Native"),0,L),function(P,R){var te=B(P,null,"Numeric");G(te,"$to_n",function(){return this.valueOf()})}(L[0]),function(P,R){var te=B(P,null,"Proc");G(te,"$to_n",I)}(L[0]),function(P,R){var te=B(P,null,"String");G(te,"$to_n",function(){return this.valueOf()})}(L[0]),function(P,R){var te=B(P,null,"Regexp");G(te,"$to_n",function(){return this.valueOf()})}(L[0]),function(P,R){var te=B(P,null,"MatchData");G(te,"$to_n",D("matches"))}(L[0]),function(P,R,te){var k=B(P,null,"Struct"),de=[k].concat(te),N=C.$r(de);G(k,"$to_n",function(){var l=M;return l={},ee(this,"each_pair",[],function(f,u){return null==f&&(f=M),null==u&&(u=M),l[f]=N("Native").$try_convert(u,u)}),l})}(L[0],0,L),function(P,R,te){var k=B(P,null,"Array"),de=[k].concat(te),N=C.$r(de);G(k,"$to_n",function(){for(var l=[],c=0,f=this.length;c<f;c++){var u=this[c];l.push(N("Native").$try_convert(u,u))}return l})}(L[0],0,L),function(P,R){var te=B(P,null,"Boolean");G(te,"$to_n",function(){return this.valueOf()})}(L[0]),function(P,R){var te=B(P,null,"Time");G(te,"$to_n",I)}(L[0]),function(P,R){var te=B(P,null,"NilClass");G(te,"$to_n",function(){return null})}(L[0]),H(S("Hash")["$method_defined?"]("_initialize"))||function(P,R,te){var k=B(P,null,"Hash"),de=[k].concat(te),N=C.$r(de);W(k,"_initialize","initialize"),G(k,"$initialize",function F(g){var l=F.$$p||M,c=this;if(F.$$p=null,null!=g&&(void 0===g.constructor||g.constructor===Object)){var p,_,f=c.$$smap,u=c.$$keys;for(p in g)!(_=g[p])||void 0!==_.constructor&&_.constructor!==Object?_&&_.$$is_array?(_=_.map(function(y){return!y||void 0!==y.constructor&&y.constructor!==Object?c.$Native(y):N("Hash").$new(y)}),f[p]=_):f[p]=c.$Native(_):f[p]=N("Hash").$new(_),u.push(p);return c}return ee(c,"_initialize",[g],l.$to_proc())},-1),G(k,"$to_n",function(){for(var u,p,l={},c=this.$$keys,f=this.$$smap,_=0,y=c.length;_<y;_++)p=(u=c[_]).$$is_string?f[u]:(u=u.key).value,l[u]=N("Native").$try_convert(p,p);return l})}(L[0],0,L),function(P,R){var te=B(P,null,"Module");G(te,"$native_module",function(){return C.global[this.$name()]=this})}(L[0]),function(P,R,te){var k=B(P,null,"Class"),de=[k].concat(te),N=C.$r(de);G(k,"$native_alias",function(g,l){var c=this,f=c.prototype[C.jsid(l)];f||c.$raise(N("NameError").$new("undefined method `"+l+"' for class `"+c.$inspect()+"'",l)),c.prototype[g]=f}),G(k,"$native_class",function(){var g=this;return g.$native_module(),g.new=g.$new})}(L[0],0,L),A.$=A.global=J.$Native(C.global)}),Opal.modules.strscan=function(C){var W,B,Z,T,j,me=C.def,d=C.truthy,H=C.eqeqeq,ee=C.Opal,$=C.return_ivar,x=C.send,O=C.alias,E=[],Y=C.nil;return W=E,Z=[B=(0,C.klass)(E[0],null,"StringScanner")].concat(W),T=C.$r(Z),(j=B.$$prototype).pos=j.string=j.working=j.matched=j.prev_pos=j.match=Y,B.$attr_reader("pos","matched"),me(B,"$initialize",function(z){var q=this;return q.string=z,q.pos=0,q.matched=Y,q.working=z,q.match=[]}),B.$attr_reader("string"),me(B,"$beginning_of_line?",function(){var z=this;return 0===z.pos||"\n"===z.string.charAt(z.pos-1)}),me(B,"$scan",function(z){var q=this,K=(z=q.$anchor(z)).exec(q.working);return null==K?q.matched=Y:(q.prev_pos=q.pos,q.pos+=K[0].length,q.working=q.working.substring(K[0].length),q.matched=K[0],q.match=K,K[0])}),me(B,"$scan_until",function(z){var q=this;z=q.$anchor(z);for(var K=q.working,I=0;K.length!=I;++I){var A=z.exec(K.substr(I));if(null!==A){var J=I+A[0].length,L=K.substr(0,J);return q.matched=A[0],q.match=A,q.prev_pos=q.pos+I,q.pos+=J,q.working=K.substr(J),L}}return q.matched=Y}),me(B,"$[]",function(z){var K;if(d(this.match["$empty?"]()))return Y;H(T("Symbol"),K=z)?z=z.$to_s():H(T("String"),K)||(z=ee["$coerce_to!"](z,T("Integer"),"to_int"));var I=this.match;return z<0&&(z+=I.length),z<0||z>=I.length||null==I[z]?Y:I[z]}),me(B,"$check",function(z){var q=this,K=(z=q.$anchor(z)).exec(q.working);return q.matched=null==K?Y:K[0]}),me(B,"$check_until",function(z){var q=this,K=q.prev_pos,I=q.pos,A=q.working,J=q.$scan_until(z);return q.prev_pos=K,q.pos=I,q.working=A,J}),me(B,"$peek",function(z){return this.working.substring(0,z)}),me(B,"$eos?",function(){return 0===this.working.length}),me(B,"$exist?",function(z){var K=z.exec(this.working);return null==K?Y:0==K.index?0:K.index+1}),me(B,"$skip",function(z){var q=this,K=(z=q.$anchor(z)).exec(q.working);if(null==K)return q.match=[],q.matched=Y;var I=K[0],A=I.length;return q.matched=I,q.match=K,q.prev_pos=q.pos,q.pos+=A,q.working=q.working.substring(A),A}),me(B,"$skip_until",function(z){var K=this.$scan_until(z);return K===Y?Y:(this.matched=K.substr(-1),K.length)}),me(B,"$get_byte",function(){var z=this,q=Y;return z.pos<z.string.length?(z.prev_pos=z.pos,z.pos+=1,q=z.matched=z.working.substring(0,1),z.working=z.working.substring(1)):z.matched=Y,q}),me(B,"$match?",function(z){var q=this,K=(z=q.$anchor(z)).exec(q.working);return null==K?Y:(q.prev_pos=q.pos,K[0].length)}),me(B,"$pos=",function(z){var q=this;return z<0&&(z+=q.string.$length()),q.pos=z,q.working=q.string.slice(z)}),me(B,"$matched_size",function(){return this.matched===Y?Y:this.matched.length}),me(B,"$post_match",function(){var z=this;return z.matched===Y?Y:z.string.substr(z.pos)}),me(B,"$pre_match",function(){var z=this;return z.matched===Y?Y:z.string.substr(0,z.prev_pos)}),me(B,"$reset",function(){var z=this;return z.working=z.string,z.matched=Y,z.pos=0}),me(B,"$rest",$("working")),me(B,"$rest?",function(){return 0!==this.working.length}),me(B,"$rest_size",function(){return this.$rest().$size()}),me(B,"$terminate",function(){var z,q=this;return q.match=Y,z=[q.string.$length()],x(q,"pos=",z),z[z.length-1]}),me(B,"$unscan",function(){var z=this;return z.pos=z.prev_pos,z.prev_pos=Y,z.match=Y,z}),O(B,"bol?","beginning_of_line?"),O(B,"getch","get_byte"),B.$private(),me(B,"$anchor",function(z){var q=z.toString().match(/\/([^\/]+)$/);return q=q?q[1]:void 0,new RegExp("^(?:"+z.source+")",q)})},Opal.queue(function(C){var E,Y,W,G,le=C.klass,me=C.def,d=C.module,H=C.top,ee=[],$=C.$r(ee),x=C.nil;return H.$require("strscan"),Y=ee,[G=le(ee[0],null,"Dir")].concat(Y),W=C.get_singleton_class(G),me(W,"$[]",function(){return[]}),E=d(ee[0],"StringScannerPatch"),me(E,"$scan_until",function(G){var D=this;G=(D=this).$anchor(G);for(var Z,W=D.pos,B=D.working;;){var T=0===B.length;if(Z=G.exec(B),W+=1,B=B.substr(1),null!=Z)return D.matched=D.string.substr(D.pos,W-D.pos-1+Z[0].length),D.prev_pos=W-1,D.pos=W,D.working=B.substr(Z[0].length-1),D.matched;if(T)return D.matched=x}}),$("StringScanner").$prepend($("StringScannerPatch")),C.top.$__dir__=()=>"/",x})},8465:(C,le,me)=>{me(9993),Opal.modules["bcdice/arithmetic/node"]=function(d){var I,S,R,g,l,k,de,v,J,H=d.module,ee=d.klass,$=d.def,x=d.thrower,O=d.return_ivar,E=d.send2,Y=d.find_super,G=d.eqeq,D=d.const_set,W=d.eqeqeq,B=d.rb_divide,Z=d.truthy,T=d.assign_ivar,j=d.alias,oe=[],z=d.nil,q=d.$$$;return I=oe,S=J=[H(oe[0],"BCDice")].concat(I),R=v=[H(J[0],"Arithmetic")].concat(S),k=[H(v[0],"Node")].concat(R),de=d.$r(k),(l=(g=ee(k[0],null,"BinaryOp")).$$prototype).lhs=l.rhs=l.op=z,$(g,"$initialize",function(f,u,p){var _=this;return _.lhs=f,_.op=u,_.rhs=p}),$(g,"$eval",function(f){try{x("eval_return");var y,p=this,_=z;return _=p.lhs.$eval(f),y=p.rhs.$eval(f),_.$send(p.op,y)}catch(m){if(m===d.t_eval_return)return m.$v;throw m}}),$(g,"$output",function(){var f=this;return""+f.lhs.$output()+f.op+f.rhs.$output()}),$(g,"$s_exp",function(){var f=this;return"("+f.$op_for_s_exp()+" "+f.lhs.$s_exp()+" "+f.rhs.$s_exp()+")"}),$(g,"$op_for_s_exp",O("op")),function(N,F,g){var l=ee(N,F,"DivideBase"),c=[l].concat(g),f=d.$r(c),u=l.$$prototype;u.lhs=u.rhs=u.op=z,$(l,"$initialize",function p(_,y){return p.$$p=null,E(this,Y(this,"initialize",p,!1,!0),"initialize",[_,"/",y],null)}),$(l,"$eval",function(_){try{x("eval_return");var ne,se,m=this;return ne=m.lhs.$eval(_),se=m.rhs.$eval(_),G(se,0)&&m.$raise(f("ZeroDivisionError")),m.$divide_and_round(ne,se,_)}catch(Ee){if(Ee===d.t_eval_return)return Ee.$v;throw Ee}}),$(l,"$output",function p(){var _=p.$$p||z,y=this;return p.$$p=null,""+E(y,Y(y,"output",p,!1,!0),"output",[],_)+y.$rounding_method()}),l.$private(),$(l,"$rounding_method",function(){return q(this.$class(),"ROUNDING_METHOD")}),$(l,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),$(l,"$divide_and_round",function(_,y,m){return this.$raise(f("NotImplementedError"))})}(k[0],de("BinaryOp"),k),function(N,F,g){var l=ee(N,F,"DivideWithGameSystemDefault"),c=[l].concat(g),f=d.$r(c);D(c[0],"ROUNDING_METHOD",""),l.$private(),$(l,"$divide_and_round",function(p,_,y){var m,ne=z;return W(q(f("RoundType"),"CEIL"),m=y)?B(p.$to_f(),_).$ceil():W(q(f("RoundType"),"ROUND"),m)?(ne=B(p.$to_f(),_),Z(ne["$negative?"]())?ne.$abs().$round()["$-@"]():ne.$round()):B(p,_).$floor()})}(k[0],de("DivideBase"),k),function(N,F,g){var l=ee(N,F,"DivideWithCeil"),c=[l].concat(g);D(c[0],"ROUNDING_METHOD","C"),l.$private(),$(l,"$divide_and_round",function(u,p,_){return B(u.$to_f(),p).$ceil()})}(k[0],de("DivideBase"),k),function(N,F,g){var l=ee(N,F,"DivideWithRound"),c=[l].concat(g);D(c[0],"ROUNDING_METHOD","R"),l.$private(),$(l,"$divide_and_round",function(u,p,_){var y=z;return y=B(u.$to_f(),p),Z(y["$negative?"]())?y.$abs().$round()["$-@"]():y.$round()})}(k[0],de("DivideBase"),k),function(N,F,g){var l=ee(N,F,"DivideWithFloor"),c=[l].concat(g);D(c[0],"ROUNDING_METHOD","F"),l.$private(),$(l,"$divide_and_round",function(u,p,_){return B(u,p).$floor()})}(k[0],de("DivideBase"),k),function(N,F){var g=ee(N,null,"Negative");g.$$prototype.body=z,$(g,"$initialize",T("body")),$(g,"$eval",function(f){try{return x("eval_return"),this.body.$eval(f)["$-@"]()}catch(_){if(_===d.t_eval_return)return _.$v;throw _}}),$(g,"$output",function(){return"-"+this.body.$output()}),$(g,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(k[0]),function(N,F){var g=ee(N,null,"Parenthesis");g.$$prototype.expr=z,$(g,"$initialize",T("expr")),$(g,"$eval",function(f){try{return x("eval_return"),this.expr.$eval(f)}catch(_){if(_===d.t_eval_return)return _.$v;throw _}}),$(g,"$output",function(){return"("+this.expr.$output()+")"}),$(g,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(k[0]),function(N,F){var g=ee(N,null,"Number");return g.$$prototype.value=z,$(g,"$initialize",T("value")),$(g,"$eval",O("value")),$(g,"$output",function(){return this.value.$to_s()}),j(g,"s_exp","output")}(k[0])},Opal.modules["racc/parser"]=function(d){var P,te,k,H=d.module,ee=d.klass,$=d.truthy,x=d.const_set,O=d.defs,E=d.gvars,Y=d.rb_lt,G=d.def,D=d.to_ary,W=d.send,B=d.neqeq,Z=d.rb_plus,T=d.eqeq,j=d.rb_ge,oe=d.rb_gt,z=d.rb_minus,q=d.rb_le,K=d.rb_times,I=d.assign_ivar_val,J=[],L=d.$r(J),S=d.nil,M=d.$$$;return P=J,te=[H(J[0],"Racc")].concat(P),k=d.$r(te),ee(te[0],k("StandardError"),"ParseError"),$(M("::","ParseError","skip_raise")?"constant":S)||x(J[0],"ParseError",M(L("Racc"),"ParseError")),function(v,P){var g,l,c,f,u,k=[H(v,"Racc")].concat(P),de=d.$r(k);return $(de("Racc_No_Extensions","skip_raise")?"constant":S)||x(k[0],"Racc_No_Extensions",!1),g=k,c=[l=ee(k[0],null,"Parser")].concat(g),f=d.$r(c),(u=l.$$prototype).yydebug=u.racc_debug_out=u.racc_error_status=u.racc_t=u.racc_vstack=u.racc_val=u.racc_state=u.racc_tstack=S,x(c[0],"Racc_Runtime_Version","1.4.6"),x(c[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),x(c[0],"Racc_Runtime_Core_Version_R","1.4.6"),x(c[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),x(c[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),x(c[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),x(c[0],"Racc_Runtime_Core_Version",f("Racc_Runtime_Core_Version_R")),x(c[0],"Racc_Runtime_Core_Revision",f("Racc_Runtime_Core_Revision_R")),x(c[0],"Racc_Runtime_Type","ruby"),O(f("Parser"),"$racc_runtime_type",function(){return f("Racc_Runtime_Type")}),G(l,"$_racc_setup",function(){var _,y,m=this,ne=S,se=S;return null==E.stderr&&(E.stderr=S),$(M(m.$class(),"Racc_debug_parser"))||(m.yydebug=!1),$(null!=(_=m.yydebug)&&_!==S?"instance-variable":S)||(m.yydebug=!1),$(m.yydebug)&&($(null!=(y=m.racc_debug_out)&&y!==S?"instance-variable":S)||(m.racc_debug_out=E.stderr),m.racc_debug_out=$(ne=m.racc_debug_out)?ne:E.stderr),se=M(m.$class(),"Racc_arg"),$(Y(se.$size(),14))&&se["$[]="](13,!0),se}),G(l,"$_racc_init_sysvars",function(){var _=this;return _.racc_state=[0],_.racc_tstack=[],_.racc_vstack=[],_.racc_t=S,_.racc_val=S,_.racc_read_next=!0,_.racc_user_yyerror=!1,_.racc_error_status=0}),G(l,"$do_parse",function(){return this.$__send__(f("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),G(l,"$next_token",function(){return this.$raise(f("NotImplementedError"),this.$class()+"#next_token is not defined")}),G(l,"$_racc_do_parse_rb",function(_,y){var m,Ee=S,ke=S,ce=S,Me=S,be=S,he=S,Se=S,ve=S;return m=D(_),Ee=null==m[0]?S:m[0],ke=null==m[1]?S:m[1],ce=null==m[2]?S:m[2],Me=null==m[3]?S:m[3],be=null==m[10]?S:m[10],this.$_racc_init_sysvars(),he=Se=ve=S,W(this,"catch",["racc_end_parse"],function ae(){var ue,Ce,b=null==ae.$$s?this:ae.$$s,V=S;for(null==b.racc_state&&(b.racc_state=S),null==b.racc_read_next&&(b.racc_read_next=S),null==b.racc_t&&(b.racc_t=S),null==b.yydebug&&(b.yydebug=S),null==b.racc_val&&(b.racc_val=S);$(!0);)for($(ve=Me["$[]"](b.racc_state["$[]"](-1)))?($(b.racc_read_next)&&B(b.racc_t,0)&&(Ce=b.$next_token(),ue=D(Ce),he=null==ue[0]?S:ue[0],b.racc_val=null==ue[1]?S:ue[1],b.racc_t=$(he)?$(V=be["$[]"](he))?V:1:0,$(b.yydebug)&&b.$racc_read_token(b.racc_t,he,b.racc_val),b.racc_read_next=!1),ve=Z(ve,b.racc_t),$(j(ve,0))&&$(Se=Ee["$[]"](ve))&&T(ke["$[]"](ve),b.racc_state["$[]"](-1))||(Se=ce["$[]"](b.racc_state["$[]"](-1)))):Se=ce["$[]"](b.racc_state["$[]"](-1));$(Se=b.$_racc_evalact(Se,_)););},{$$s:this})}),G(l,"$yyparse",function(_,y){return this.$__send__(f("Racc_YY_Parse_Method"),_,y,this.$_racc_setup(),!0)}),G(l,"$_racc_yyparse_rb",function(_,y,m,ne){var se,ce=S,Me=S,$e=S,be=S,Se=S,ve=S,ae=S;return se=D(m),ce=null==se[0]?S:se[0],Me=null==se[1]?S:se[1],$e=null==se[2]?S:se[2],be=null==se[3]?S:se[3],Se=null==se[10]?S:se[10],this.$_racc_init_sysvars(),ve=S,ae=S,W(this,"catch",["racc_end_parse"],function ue(){var Ce=null==ue.$$s?this:ue.$$s;for(null==Ce.racc_state&&(Ce.racc_state=S);!$(ae=be["$[]"](Ce.racc_state["$[]"](-1)));)for(;$(ve=Ce.$_racc_evalact($e["$[]"](Ce.racc_state["$[]"](-1)),m)););return W(_,"__send__",[y],function b(V,ge){var xe=null==b.$$s?this:b.$$s,De=S,Re=S;for(null==xe.racc_t&&(xe.racc_t=S),null==xe.racc_state&&(xe.racc_state=S),null==xe.racc_read_next&&(xe.racc_read_next=S),null==V&&(V=S),null==ge&&(ge=S),xe.racc_t=$(V)?$(De=Se["$[]"](V))?De:1:0,xe.racc_val=ge,xe.racc_read_next=!1,ae=Z(ae,xe.racc_t),$(j(ae,0))&&$(ve=ce["$[]"](ae))&&T(Me["$[]"](ae),xe.racc_state["$[]"](-1))||(ve=$e["$[]"](xe.racc_state["$[]"](-1)));$(ve=xe.$_racc_evalact(ve,m)););for(;$($(De=$(Re=(ae=be["$[]"](xe.racc_state["$[]"](-1)))["$!"]())?Re:xe.racc_read_next["$!"]())?De:xe.racc_t["$=="](0));)for($(ae)&&$(ae=Z(ae,xe.racc_t))&&$(j(ae,0))&&$(ve=ce["$[]"](ae))&&T(Me["$[]"](ae),xe.racc_state["$[]"](-1))||(ve=$e["$[]"](xe.racc_state["$[]"](-1)));$(ve=xe.$_racc_evalact(ve,m)););},{$$s:Ce})},{$$s:this})}),G(l,"$_racc_evalact",function(_,y){var m,$e,se=this,Ee=S,ke=S,Me=S,be=S,he=S,Se=S;if(Ee=null==(m=D(y))[0]?S:m[0],ke=null==m[1]?S:m[1],Me=null==m[3]?S:m[3],$e=null==m[11]?S:m[11],be=null==m[12]?S:m[12],$(oe(_,0))&&$(Y(_,$e)))$(oe(se.racc_error_status,0))&&(T(se.racc_t,1)||(se.racc_error_status=z(se.racc_error_status,1))),se.racc_vstack.$push(se.racc_val),se.racc_state.$push(_),se.racc_read_next=!0,$(se.yydebug)&&(se.racc_tstack.$push(se.racc_t),se.$racc_shift(se.racc_t,se.racc_tstack,se.racc_vstack));else if($(Y(_,0))&&$(oe(_,be["$-@"]()))){if(he=W(se,"catch",["racc_jump"],function ve(){var ae=null==ve.$$s?this:ve.$$s;return null==ae.racc_state&&(ae.racc_state=S),ae.racc_state.$push(ae.$_racc_do_reduce(y,_)),!1},{$$s:se}),$(he))switch(he){case 1:return se.racc_user_yyerror=!0,be["$-@"]();case 2:return $e;default:se.$raise("[Racc Bug] unknown jump code")}}else if(T(_,$e))$(se.yydebug)&&se.$racc_accept(),se.$throw("racc_end_parse",se.racc_vstack["$[]"](0));else{if(T(_,be["$-@"]())){switch(se.racc_error_status){case 0:$(y["$[]"](21))||se.$on_error(se.racc_t,se.racc_val,se.racc_vstack);break;case 3:T(se.racc_t,0)&&se.$throw("racc_end_parse",S),se.racc_read_next=!0}for(se.racc_user_yyerror=!1,se.racc_error_status=3;$(!0)&&!($(Se=Me["$[]"](se.racc_state["$[]"](-1)))&&(Se=Z(Se,1),$(j(Se,0))&&$(_=Ee["$[]"](Se))&&T(ke["$[]"](Se),se.racc_state["$[]"](-1))));)$(q(se.racc_state.$size(),1))&&se.$throw("racc_end_parse",S),se.racc_state.$pop(),se.racc_vstack.$pop(),$(se.yydebug)&&(se.racc_tstack.$pop(),se.$racc_e_pop(se.racc_state,se.racc_tstack,se.racc_vstack));return _}se.$raise("[Racc Bug] unknown action "+_.$inspect())}return $(se.yydebug)&&se.$racc_next_state(se.racc_state["$[]"](-1),se.racc_state),S}),G(l,"$_racc_do_reduce",function(_,y){var m,be,Se,V,ge,xe,Ue,se=this,ke=S,ce=S,Me=S,$e=S,he=S,ve=S,ae=S,ue=S,Ce=S,b=S,De=S,Re=S,Ze=S;return ke=null==(m=D(_))[4]?S:m[4],ce=null==m[5]?S:m[5],Me=null==m[6]?S:m[6],$e=null==m[7]?S:m[7],be=null==m[8]?S:m[8],he=null==m[9]?S:m[9],Se=null==m[13]?S:m[13],ve=se.racc_state,ae=se.racc_vstack,ue=se.racc_tstack,Ce=K(y,-3),b=he["$[]"](Ce),V=he["$[]"](Z(Ce,1)),ge=he["$[]"](Z(Ce,2)),xe=[],$(se.yydebug)&&(De=ue["$[]"](b["$-@"](),b)),Re=ae["$[]"](b["$-@"](),b),$(se.yydebug)&&ue["$[]="](b["$-@"](),b,xe),ae["$[]="](b["$-@"](),b,xe),ve["$[]="](b["$-@"](),b,xe),$(Se)?ae.$push(se.$__send__(ge,Re,ae,Re["$[]"](0))):ae.$push(se.$__send__(ge,Re,ae)),ue.$push(V),$(se.yydebug)&&se.$racc_reduce(De,V,ue,ae),Ue=z(V,be),$(Ce=$e["$[]"](Ue))&&(Ce=Z(Ce,ve["$[]"](-1)),$(j(Ce,0))&&$(Ze=ke["$[]"](Ce))&&T(ce["$[]"](Ce),Ue))?Ze:Me["$[]"](Ue)}),G(l,"$on_error",function(_,y,m){var se;return this.$raise(f("ParseError"),this.$sprintf("\nparse error on value %s (%s)",y.$inspect(),$(se=this.$token_to_str(_))?se:"?"))}),G(l,"$yyerror",function(){return this.$throw("racc_jump",1)}),G(l,"$yyaccept",function(){return this.$throw("racc_jump",2)}),G(l,"$yyerrok",I("racc_error_status",0)),G(l,"$racc_read_token",function(_,y,m){var ne=this;return ne.racc_debug_out.$print("read    "),ne.racc_debug_out.$print(y.$inspect(),"(",ne.$racc_token2str(_),") "),ne.racc_debug_out.$puts(m.$inspect()),ne.racc_debug_out.$puts()}),G(l,"$racc_shift",function(_,y,m){return this.racc_debug_out.$puts("shift   "+this.$racc_token2str(_)),this.$racc_print_stacks(y,m),this.racc_debug_out.$puts()}),G(l,"$racc_reduce",function(_,y,m,ne){var se=this,Ee=S;return(Ee=se.racc_debug_out).$print("reduce "),$(_["$empty?"]())?Ee.$print(" <none>"):W(_,"each",[],function ke(ce){return null==ce&&(ce=S),Ee.$print(" ",(null==ke.$$s?this:ke.$$s).$racc_token2str(ce))},{$$s:se}),Ee.$puts(" --\x3e "+se.$racc_token2str(y)),se.$racc_print_stacks(m,ne),se.racc_debug_out.$puts()}),G(l,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),G(l,"$racc_e_pop",function(_,y,m){return this.racc_debug_out.$puts("error recovering mode: pop token"),this.$racc_print_states(_),this.$racc_print_stacks(y,m),this.racc_debug_out.$puts()}),G(l,"$racc_next_state",function(_,y){var m=this;return m.racc_debug_out.$puts("goto    "+_),m.$racc_print_states(y),m.racc_debug_out.$puts()}),G(l,"$racc_print_stacks",function(_,y){var ne=S;return(ne=this.racc_debug_out).$print("        ["),W(_,"each_index",[],function se(Ee){return null==Ee&&(Ee=S),ne.$print(" (",(null==se.$$s?this:se.$$s).$racc_token2str(_["$[]"](Ee))," ",y["$[]"](Ee).$inspect(),")")},{$$s:this}),ne.$puts(" ]")}),G(l,"$racc_print_states",function(_){var m=S;return(m=this.racc_debug_out).$print("        ["),W(_,"each",[],function(se){return null==se&&(se=S),m.$print(" ",se)}),m.$puts(" ]")}),G(l,"$racc_token2str",function(_){var m;return $(m=M(this.$class(),"Racc_token_to_s_table")["$[]"](_))?m:this.$raise("[Racc Bug] can't convert token "+_+" to string")}),G(l,"$token_to_str",function(_){return M(this.$class(),"Racc_token_to_s_table")["$[]"](_)})}(J[0],J)},Opal.modules.strscan=function(d){var T,j,oe,z,q,ee=d.def,$=d.truthy,x=d.eqeqeq,O=d.Opal,E=d.return_ivar,Y=d.send,G=d.alias,D=[],W=d.nil;return T=D,oe=[j=(0,d.klass)(D[0],null,"StringScanner")].concat(T),z=d.$r(oe),(q=j.$$prototype).pos=q.string=q.working=q.matched=q.prev_pos=q.match=W,j.$attr_reader("pos","matched"),ee(j,"$initialize",function(I){var A=this;return A.string=I,A.pos=0,A.matched=W,A.working=I,A.match=[]}),j.$attr_reader("string"),ee(j,"$beginning_of_line?",function(){var I=this;return 0===I.pos||"\n"===I.string.charAt(I.pos-1)}),ee(j,"$scan",function(I){var A=this,J=(I=A.$anchor(I)).exec(A.working);return null==J?A.matched=W:(A.prev_pos=A.pos,A.pos+=J[0].length,A.working=A.working.substring(J[0].length),A.matched=J[0],A.match=J,J[0])}),ee(j,"$scan_until",function(I){var A=this;I=A.$anchor(I);for(var J=A.working,L=0;J.length!=L;++L){var S=I.exec(J.substr(L));if(null!==S){var M=L+S[0].length,v=J.substr(0,M);return A.matched=S[0],A.match=S,A.prev_pos=A.pos+L,A.pos+=M,A.working=J.substr(M),v}}return A.matched=W}),ee(j,"$[]",function(I){var J;if($(this.match["$empty?"]()))return W;x(z("Symbol"),J=I)?I=I.$to_s():x(z("String"),J)||(I=O["$coerce_to!"](I,z("Integer"),"to_int"));var L=this.match;return I<0&&(I+=L.length),I<0||I>=L.length||null==L[I]?W:L[I]}),ee(j,"$check",function(I){var A=this,J=(I=A.$anchor(I)).exec(A.working);return A.matched=null==J?W:J[0]}),ee(j,"$check_until",function(I){var A=this,J=A.prev_pos,L=A.pos,S=A.working,M=A.$scan_until(I);return A.prev_pos=J,A.pos=L,A.working=S,M}),ee(j,"$peek",function(I){return this.working.substring(0,I)}),ee(j,"$eos?",function(){return 0===this.working.length}),ee(j,"$exist?",function(I){var J=I.exec(this.working);return null==J?W:0==J.index?0:J.index+1}),ee(j,"$skip",function(I){var A=this,J=(I=A.$anchor(I)).exec(A.working);if(null==J)return A.match=[],A.matched=W;var L=J[0],S=L.length;return A.matched=L,A.match=J,A.prev_pos=A.pos,A.pos+=S,A.working=A.working.substring(S),S}),ee(j,"$skip_until",function(I){var J=this.$scan_until(I);return J===W?W:(this.matched=J.substr(-1),J.length)}),ee(j,"$get_byte",function(){var I=this,A=W;return I.pos<I.string.length?(I.prev_pos=I.pos,I.pos+=1,A=I.matched=I.working.substring(0,1),I.working=I.working.substring(1)):I.matched=W,A}),ee(j,"$match?",function(I){var A=this,J=(I=A.$anchor(I)).exec(A.working);return null==J?W:(A.prev_pos=A.pos,J[0].length)}),ee(j,"$pos=",function(I){var A=this;return I<0&&(I+=A.string.$length()),A.pos=I,A.working=A.string.slice(I)}),ee(j,"$matched_size",function(){return this.matched===W?W:this.matched.length}),ee(j,"$post_match",function(){var I=this;return I.matched===W?W:I.string.substr(I.pos)}),ee(j,"$pre_match",function(){var I=this;return I.matched===W?W:I.string.substr(0,I.prev_pos)}),ee(j,"$reset",function(){var I=this;return I.working=I.string,I.matched=W,I.pos=0}),ee(j,"$rest",E("working")),ee(j,"$rest?",function(){return 0!==this.working.length}),ee(j,"$rest_size",function(){return this.$rest().$size()}),ee(j,"$terminate",function(){var I,A=this;return A.match=W,I=[A.string.$length()],Y(A,"pos=",I),I[I.length-1]}),ee(j,"$unscan",function(){var I=this;return I.pos=I.prev_pos,I.prev_pos=W,I.match=W,I}),G(j,"bol?","beginning_of_line?"),G(j,"getch","get_byte"),j.$private(),ee(j,"$anchor",function(I){var A=I.toString().match(/\/([^\/]+)$/);return A=A?A[1]:void 0,new RegExp("^(?:"+I.source+")",A)})},Opal.modules["bcdice/normalize"]=function(d){var G,Z,W,H=d.module,ee=d.eqeqeq,$=d.def,x=d.eqeq,O=[],E=d.nil;return G=O,W=[H(O[0],"BCDice")].concat(G),(Z=H(W[0],"Normalize")).$module_function(),$(Z,"$comparison_operator",function(j){var oe;return ee(/<=|=</,oe=j)?"<=":ee(/>=|=>/,oe)?">=":ee(/<>|!=|=!/,oe)?"!=":ee(/</,oe)?"<":ee(/>/,oe)?">":ee(/=/,oe)?"==":E}),$(Z,"$target_number",function(j){return x(j,"?")?j:j.$to_i()})},Opal.modules["bcdice/common_command/lexer"]=function(d){var B,oe,A,J,L,S,q,T,H=d.module,ee=d.klass,$=d.const_set,x=d.hash2,O=d.truthy,E=d.def,Y=d.top,G=[],D=d.nil;return Y.$require("strscan"),Y.$require("bcdice/normalize"),B=G,oe=T=[H(G[0],"BCDice")].concat(B),A=q=[H(T[0],"CommonCommand")].concat(oe),L=[J=ee(q[0],null,"Lexer")].concat(A),S=d.$r(L),J.$$prototype.scanner=D,$(L[0],"SYMBOLS",x(["+","-","*","/","(",")","[","]","?","@"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","?":"QUESTION","@":"AT"}).$freeze()),E(J,"$initialize",function(P){var te;return P=O(te=P.$split(" ",2).$first())?te:"",this.scanner=S("StringScanner").$new(P)}),E(J,"$next_token",function(){var P=this,R=D,te=D,k=D,N=D;return O(P.scanner["$eos?"]())?[!1,"$"]:O(R=P.scanner.$scan(/\d+/))?["NUMBER",R.$to_i()]:O(te=P.scanner.$scan(/[<>!=]+/))?["CMP_OP",S("Normalize").$comparison_operator(te)]:(k=P.scanner.$getch().$upcase(),[O(N=S("SYMBOLS")["$[]"](k))?N:k.$to_sym(),k])}),E(J,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/arithmetic/parser"]=function(d){var Z,z,L,P,R,te,k,de,N,F,g,l,u,S,M,v,K,I,j,H=d.module,ee=d.klass,$=d.defs,x=d.def,O=d.hash,E=d.const_set,Y=d.top,G=[],D=d.nil,W=d.$$$;return Y.$require("racc/parser.rb"),Y.$require("bcdice/common_command/lexer"),Y.$require("bcdice/arithmetic/node"),Z=G,z=j=[H(G[0],"BCDice")].concat(Z),K=[H(j[0],"Arithmetic")].concat(z),I=d.$r(K),L=K,M=[S=ee(K[0],W(I("Racc"),"Parser"),"Parser")].concat(L),v=d.$r(M),S.$$prototype.lexer=D,$(S,"$parse",function(ne){return this.$new().$parse(ne)}),x(S,"$parse",function(ne){try{return this.lexer=W(W(v("BCDice"),"CommonCommand"),"Lexer").$new(ne),this.$do_parse()}catch(Ee){if(!d.rescue(Ee,[v("ParseError")]))throw Ee;try{return D}finally{d.pop_exception()}}}),S.$private(),x(S,"$next_token",function(){return this.lexer.$next_token()}),P=d.large_array_unpack("8,17,8,12,13,4,5,4,5,7,8,7,8,12,13,4,5,4,5,7,8,7,8,12,13,4,5,4,5,7,8,7,8,,,4,5,4,5,7,9,7,,,10,11,,10,11,22,26,24,25,27"),R=d.large_array_unpack("0,9,4,2,2,0,0,4,4,0,5,4,7,18,18,5,5,7,7,5,10,7,11,19,19,10,10,11,11,10,12,11,13,,,12,12,13,13,12,1,13,,,16,16,,1,1,16,21,21,21,21"),te=[-2,40,-6,D,0,8,D,10,D,1,18,20,28,30,D,D,37,D,4,14,D,47,D,D,D,D,D,D],k=[-17,-17,-3,-6,-17,-17,-14,-17,-16,-17,-17,-17,-17,-17,-12,-13,-17,28,-1,-2,-4,-7,-15,-5,-8,-9,-10,-11],de=[14,15,23,1,18,19,D,D,20,21,16],N=[3,3,4,1,2,2,D,D,3,3,1],F=[D,3,-6,-4,-19,D],g=[D,D,2,3,D,6],l=d.large_array_unpack("0,0,racc_error,3,14,_reduce_1,3,14,_reduce_2,1,14,_reduce_none,3,15,_reduce_4,4,15,_reduce_5,1,15,_reduce_none,0,17,_reduce_7,1,17,_reduce_8,1,17,_reduce_9,1,17,_reduce_10,1,17,_reduce_11,2,16,_reduce_12,2,16,_reduce_13,1,16,_reduce_none,3,18,_reduce_15,1,18,_reduce_16"),u=O(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12),E(M[0],"Racc_arg",[P,R,k,te,de,N,g,F,13,l,u,28,17,!0]),E(M[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","$start","add","mul","unary","round_type","term"]),E(M[0],"Racc_debug_parser",!1),x(S,"$_reduce_1",function(ne,se,Ee){return W(W(v("Arithmetic"),"Node"),"BinaryOp").$new(ne["$[]"](0),"+",ne["$[]"](2))}),x(S,"$_reduce_2",function(ne,se,Ee){return W(W(v("Arithmetic"),"Node"),"BinaryOp").$new(ne["$[]"](0),"-",ne["$[]"](2))}),x(S,"$_reduce_4",function(ne,se,Ee){return W(W(v("Arithmetic"),"Node"),"BinaryOp").$new(ne["$[]"](0),"*",ne["$[]"](2))}),x(S,"$_reduce_5",function(ne,se,Ee){return ne["$[]"](3).$new(ne["$[]"](0),ne["$[]"](2))}),x(S,"$_reduce_7",function(ne,se,Ee){return W(W(v("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),x(S,"$_reduce_8",function(ne,se,Ee){return W(W(v("Arithmetic"),"Node"),"DivideWithCeil")}),x(S,"$_reduce_9",function(ne,se,Ee){return W(W(v("Arithmetic"),"Node"),"DivideWithCeil")}),x(S,"$_reduce_10",function(ne,se,Ee){return W(W(v("Arithmetic"),"Node"),"DivideWithRound")}),x(S,"$_reduce_11",function(ne,se,Ee){return W(W(v("Arithmetic"),"Node"),"DivideWithFloor")}),x(S,"$_reduce_12",function(ne,se,Ee){return ne["$[]"](1)}),x(S,"$_reduce_13",function(ne,se,Ee){return W(W(v("Arithmetic"),"Node"),"Negative").$new(ne["$[]"](1))}),x(S,"$_reduce_15",function(ne,se,Ee){return ne["$[]"](1)}),x(S,"$_reduce_16",function(ne,se,Ee){return W(W(v("Arithmetic"),"Node"),"Number").$new(ne["$[]"](0))}),x(S,"$_reduce_none",function(ne,se,Ee){return ne["$[]"](0)})},Opal.modules["bcdice/arithmetic"]=function(d){var G,Z,oe,q,K,T,j,W,H=d.module,ee=d.thrower,$=d.def,x=d.top,O=[],E=d.nil;return x.$require("bcdice/arithmetic/node"),x.$require("bcdice/arithmetic/parser"),G=O,Z=W=[H(O[0],"BCDice")].concat(G),j=[T=H(W[0],"Arithmetic")].concat(Z),q=[oe=d.get_singleton_class(T)].concat(j),K=d.$r(q),$(oe,"$eval",function(A,J){try{var S;ee("eval_return");try{return(S=K("Parser").$parse(A))===E||null==S?E:S.$eval(J)}catch(v){if(!d.rescue(v,[K("ZeroDivisionError")]))throw v;try{return E}finally{d.pop_exception()}}}catch(v){if(v===d.t_eval_return)return v.$v;throw v}})},Opal.queue(function(d){var T,K,I,A,J,L,oe,H=d.module,ee=d.klass,$=d.defs,x=d.def,O=d.send,E=d.truthy,Y=d.eqeq,G=d.thrower,W=[],B=d.nil;return d.top.$require("bcdice/arithmetic"),T=W,K=oe=[H(W[0],"BCDice")].concat(T),A=[I=ee(oe[0],null,"Preprocessor")].concat(K),J=d.$r(A),(L=I.$$prototype).game_system=L.text=B,$(I,"$process",function(M,v){return J("Preprocessor").$new(M,v).$process()}),x(I,"$initialize",function(M,v){return this.text=M,this.game_system=v}),x(I,"$process",function(){var M=this;return M.$trim_after_whitespace(),M.$replace_parentheses(),M.text=M.game_system.$change_text(M.text),M.$replace_implicit_d(),M.text}),I.$private(),x(I,"$trim_after_whitespace",function(){return this.text=this.text.$strip().$split(/\s/,2).$first()}),x(I,"$replace_parentheses",function(){try{G("eval_return");var v=this;return function(){try{var P=G("break");return O(v,"loop",[],function R(){var k,te=null==R.$$s?this:R.$$s;if(null==te.text&&(te.text=B),k=te.text,te.text=O(te.text,"gsub",[/\([\d\/+*\-CURF]+\)/],function de(N){var g,F=null==de.$$s?this:de.$$s;return null==F.game_system&&(F.game_system=B),null==N&&(N=B),E(g=J("Arithmetic").$eval(N,F.game_system.$round_type()))?g:N},{$$s:te}),!Y(k,te.text))return B;P.$throw()},{$$s:v})}catch(R){if(R===P)return R.$v;throw R}}()}catch(P){if(P===d.t_eval_return)return P.$v;throw P}}),x(I,"$replace_implicit_d",function(){var M=this;return M.text=O(M.text,"gsub",[/(\d+)D([^\w]|$)/i],function v(){var P=null==v.$$s?this:v.$$s;return null==P.game_system&&(P.game_system=B),J("Regexp").$last_match(1)+"D"+P.game_system.$sides_implicit_d()+J("Regexp").$last_match(2)},{$$s:M})})})},6956:(C,le,me)=>{me(9993),Opal.queue(function(d){var E,$=[];return E=$,(0,d.const_set)([(0,d.module)($[0],"BCDice")].concat(E)[0],"VERSION","3.8.0")})},3583:function(C,le,me){"use strict";var d=this&&this.__importDefault||function($){return $&&$.__esModule?$:{default:$}};Object.defineProperty(le,"__esModule",{value:!0}),le.Opal=le.I18n=le.BCDice=void 0,me(6956);var H=d(me(8459));le.BCDice=H.default.module(null,"BCDice"),le.I18n=H.default.module(null,"I18n");var ee=me(8459);Object.defineProperty(le,"Opal",{enumerable:!0,get:function(){return d(ee).default}})},8459:(C,le,me)=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0}),le.nilToNull=void 0,me(9993),Opal.config.unsupported_features_severity="ignore",le.default=Opal,le.nilToNull=function d(H){return H===Opal.nil?null:H}},3604:function(C,le,me){"use strict";var B,d=this&&this.__extends||(B=function(Z,T){return(B=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(j,oe){j.__proto__=oe}||function(j,oe){for(var z in oe)Object.prototype.hasOwnProperty.call(oe,z)&&(j[z]=oe[z])})(Z,T)},function(Z,T){function j(){this.constructor=Z}B(Z,T),Z.prototype=null===T?Object.create(T):(j.prototype=T.prototype,new j)}),H=this&&this.__awaiter||function(B,Z,T,j){return new(T||(T=Promise))(function(z,q){function K(J){try{A(j.next(J))}catch(L){q(L)}}function I(J){try{A(j.throw(J))}catch(L){q(L)}}function A(J){J.done?z(J.value):function oe(z){return z instanceof T?z:new T(function(q){q(z)})}(J.value).then(K,I)}A((j=j.apply(B,Z||[])).next())})},ee=this&&this.__generator||function(B,Z){var j,oe,z,q,T={label:0,sent:function(){if(1&z[0])throw z[1];return z[1]},trys:[],ops:[]};return q={next:K(0),throw:K(1),return:K(2)},"function"==typeof Symbol&&(q[Symbol.iterator]=function(){return this}),q;function K(A){return function(J){return function I(A){if(j)throw new TypeError("Generator is already executing.");for(;T;)try{if(j=1,oe&&(z=2&A[0]?oe.return:A[0]?oe.throw||((z=oe.return)&&z.call(oe),0):oe.next)&&!(z=z.call(oe,A[1])).done)return z;switch(oe=0,z&&(A=[2&A[0],z.value]),A[0]){case 0:case 1:z=A;break;case 4:return T.label++,{value:A[1],done:!1};case 5:T.label++,oe=A[1],A=[0];continue;case 7:A=T.ops.pop(),T.trys.pop();continue;default:if(!(z=(z=T.trys).length>0&&z[z.length-1])&&(6===A[0]||2===A[0])){T=0;continue}if(3===A[0]&&(!z||A[1]>z[0]&&A[1]<z[3])){T.label=A[1];break}if(6===A[0]&&T.label<z[1]){T.label=z[1],z=A;break}if(z&&T.label<z[2]){T.label=z[2],T.ops.push(A);break}z[2]&&T.ops.pop(),T.trys.pop();continue}A=Z.call(B,T)}catch(J){A=[6,J],oe=0}finally{j=z=0}if(5&A[0])throw A[1];return{value:A[0]?A[1]:void 0,done:!0}}([A,J])}}},$=this&&this.__importDefault||function(B){return B&&B.__esModule?B:{default:B}};Object.defineProperty(le,"__esModule",{value:!0}),le.getGameSystemClass=void 0;var x=$(me(5904)),O=me(3583),E=me(3693),Y=$(me(4682)),G=$(me(3034));function D(B){var Z;return(Z=function(T){function j(oe,z){return T.call(this,oe,null!=z?z:B.$new(oe))||this}return d(j,T),j.eval=function(oe){return E.parseResult(B.$eval(oe))},j}(x.default)).ID=B.$const_get("ID"),Z.NAME=B.$const_get("NAME"),Z.SORT_KEY=B.$const_get("SORT_KEY"),Z.HELP_MESSAGE=B.$const_get("HELP_MESSAGE"),Z.COMMAND_PATTERN=B.$command_pattern(),Z}le.getGameSystemClass=D;var W=function(){function B(){}return B.prototype.getGameSystemIdByName=function(Z){var T,j=null===(T=this.listAvailableGameSystems().find(function(oe){return oe.name===Z}))||void 0===T?void 0:T.id;if(!j)throw new Error("GameSystem named "+Z+" does not exists");return j},B.prototype.getGameSystemInfo=function(Z){var T=this.listAvailableGameSystems().find(function(j){return j.id===Z});if(!T)throw new Error("GameSystem is not found");return T},B.prototype.getGameSystemClass=function(Z){var T=this.listLoadedGameSystems().find(function(j){return j.ID===Z});if(!T)throw new Error("GameSystem "+Z+" is not loaded");return T},B.prototype.getI18nInfos=function(Z){var T=Z.replace(/_[^0-9].*$/g,""),j=this.listAvailabletI18nInfoList().find(function(q){return q.baseClassName===T||q.baseClassName===Z}),oe=j?[j]:[],z=this.listAvailableGameSystems().find(function(q){return q.className===Z});return z?Array.from(new Set(this.getI18nInfos(z.superClassName).concat(oe))):oe},B.prototype.listLoadedGameSystems=function(){var Z,T,j;return null!==(j=null===(T=null===(Z=O.BCDice.GameSystem)||void 0===Z?void 0:Z.$constants())||void 0===T?void 0:T.map(function(oe){return D(O.BCDice.GameSystem[oe])}))&&void 0!==j?j:[]},B.prototype.listAvailableGameSystems=function(){return Y.default.gameSystems},B.prototype.listAvailabletI18nInfoList=function(){return G.default.i18nList},B.prototype.dynamicLoad=function(Z){var T;return H(this,void 0,void 0,function(){var j,oe,z,q,K,I,A,J,L,M,v,P,R;return ee(this,function(te){switch(te.label){case 0:if(j=this.getGameSystemInfo(Z),!(oe=null!==(T=null==j?void 0:j.className)&&void 0!==T?T:Z).match(/^[A-Z]\w*$/))throw new Error("Invalid id");z=this.getI18nInfos(oe),q=0,K=z,te.label=1;case 1:if(!(q<K.length))return[3,6];A=(I=K[q]).locales.filter(function(k){return k===j.locale||k===O.I18n.$default_locale()}),J=0,L=A,te.label=2;case 2:return J<L.length?(P=(v=JSON).stringify,[4,this.dynamicImportI18n(I.baseClassName,L[J])]):[3,5];case 3:M=P.apply(v,[te.sent()]),O.I18n.$load_translation(M),te.label=4;case 4:return J++,[3,2];case 5:return q++,[3,1];case 6:return[4,this.dynamicImport(oe)];case 7:if(te.sent(),!(R=O.BCDice.GameSystem.$const_get(oe)))throw new Error("Failed to load game system");return[2,D(R)]}})})},B.prototype.dynamicImportI18n=function(Z,T){throw new Error("Not implemented")},B.prototype.dynamicImport=function(Z){throw new Error("Not implemented")},B}();le.default=W},3693:function(C,le,me){"use strict";var d=this&&this.__assign||function(){return d=Object.assign||function(x){for(var O,E=1,Y=arguments.length;E<Y;E++)for(var G in O=arguments[E])Object.prototype.hasOwnProperty.call(O,G)&&(x[G]=O[G]);return x},d.apply(this,arguments)},H=this&&this.__rest||function(x,O){var E={};for(var Y in x)Object.prototype.hasOwnProperty.call(x,Y)&&O.indexOf(Y)<0&&(E[Y]=x[Y]);if(null!=x&&"function"==typeof Object.getOwnPropertySymbols){var G=0;for(Y=Object.getOwnPropertySymbols(x);G<Y.length;G++)O.indexOf(Y[G])<0&&Object.prototype.propertyIsEnumerable.call(x,Y[G])&&(E[Y[G]]=x[Y[G]])}return E};Object.defineProperty(le,"__esModule",{value:!0}),le.parseResult=void 0;var ee=me(3583);le.parseResult=function $(x){if(x===ee.Opal.nil)return null;var O=x.detailed_rands,E=H(x,["detailed_rands"]);return d(d({},E),{detailedRands:O.map(function(Y){return Y.$to_n()})})}},7585:function(C,le,me){var d;C.exports=(d=d||function(H,ee){var $;if("undefined"!=typeof window&&window.crypto&&($=window.crypto),"undefined"!=typeof self&&self.crypto&&($=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&($=globalThis.crypto),!$&&"undefined"!=typeof window&&window.msCrypto&&($=window.msCrypto),!$&&"undefined"!=typeof global&&global.crypto&&($=global.crypto),!$)try{$=me(2480)}catch(q){}var x=function(){if($){if("function"==typeof $.getRandomValues)try{return $.getRandomValues(new Uint32Array(1))[0]}catch(q){}if("function"==typeof $.randomBytes)try{return $.randomBytes(4).readInt32LE()}catch(q){}}throw new Error("Native crypto module could not be used to get secure random number.")},O=Object.create||function(){function q(){}return function(K){var I;return q.prototype=K,I=new q,q.prototype=null,I}}(),E={},Y=E.lib={},G=Y.Base={extend:function(q){var K=O(this);return q&&K.mixIn(q),(!K.hasOwnProperty("init")||this.init===K.init)&&(K.init=function(){K.$super.init.apply(this,arguments)}),K.init.prototype=K,K.$super=this,K},create:function(){var q=this.extend();return q.init.apply(q,arguments),q},init:function(){},mixIn:function(q){for(var K in q)q.hasOwnProperty(K)&&(this[K]=q[K]);q.hasOwnProperty("toString")&&(this.toString=q.toString)},clone:function(){return this.init.prototype.extend(this)}},D=Y.WordArray=G.extend({init:function(q,K){q=this.words=q||[],this.sigBytes=null!=K?K:4*q.length},toString:function(q){return(q||B).stringify(this)},concat:function(q){var K=this.words,I=q.words,A=this.sigBytes,J=q.sigBytes;if(this.clamp(),A%4)for(var L=0;L<J;L++)K[A+L>>>2]|=(I[L>>>2]>>>24-L%4*8&255)<<24-(A+L)%4*8;else for(var M=0;M<J;M+=4)K[A+M>>>2]=I[M>>>2];return this.sigBytes+=J,this},clamp:function(){var q=this.words,K=this.sigBytes;q[K>>>2]&=4294967295<<32-K%4*8,q.length=H.ceil(K/4)},clone:function(){var q=G.clone.call(this);return q.words=this.words.slice(0),q},random:function(q){for(var K=[],I=0;I<q;I+=4)K.push(x());return new D.init(K,q)}}),W=E.enc={},B=W.Hex={stringify:function(q){for(var K=q.words,I=q.sigBytes,A=[],J=0;J<I;J++){var L=K[J>>>2]>>>24-J%4*8&255;A.push((L>>>4).toString(16)),A.push((15&L).toString(16))}return A.join("")},parse:function(q){for(var K=q.length,I=[],A=0;A<K;A+=2)I[A>>>3]|=parseInt(q.substr(A,2),16)<<24-A%8*4;return new D.init(I,K/2)}},Z=W.Latin1={stringify:function(q){for(var K=q.words,I=q.sigBytes,A=[],J=0;J<I;J++)A.push(String.fromCharCode(K[J>>>2]>>>24-J%4*8&255));return A.join("")},parse:function(q){for(var K=q.length,I=[],A=0;A<K;A++)I[A>>>2]|=(255&q.charCodeAt(A))<<24-A%4*8;return new D.init(I,K)}},T=W.Utf8={stringify:function(q){try{return decodeURIComponent(escape(Z.stringify(q)))}catch(K){throw new Error("Malformed UTF-8 data")}},parse:function(q){return Z.parse(unescape(encodeURIComponent(q)))}},j=Y.BufferedBlockAlgorithm=G.extend({reset:function(){this._data=new D.init,this._nDataBytes=0},_append:function(q){"string"==typeof q&&(q=T.parse(q)),this._data.concat(q),this._nDataBytes+=q.sigBytes},_process:function(q){var K,I=this._data,A=I.words,J=I.sigBytes,L=this.blockSize,M=J/(4*L),v=(M=q?H.ceil(M):H.max((0|M)-this._minBufferSize,0))*L,P=H.min(4*v,J);if(v){for(var R=0;R<v;R+=L)this._doProcessBlock(A,R);K=A.splice(0,v),I.sigBytes-=P}return new D.init(K,P)},clone:function(){var q=G.clone.call(this);return q._data=this._data.clone(),q},_minBufferSize:0}),z=(Y.Hasher=j.extend({cfg:G.extend(),init:function(q){this.cfg=this.cfg.extend(q),this.reset()},reset:function(){j.reset.call(this),this._doReset()},update:function(q){return this._append(q),this._process(),this},finalize:function(q){return q&&this._append(q),this._doFinalize()},blockSize:16,_createHelper:function(q){return function(K,I){return new q.init(I).finalize(K)}},_createHmacHelper:function(q){return function(K,I){return new z.HMAC.init(q,I).finalize(K)}}}),E.algo={});return E}(Math),d)},7412:function(C,le,me){var d;C.exports=(d=me(7585),function(){if("function"==typeof ArrayBuffer){var $=d.lib.WordArray,x=$.init,O=$.init=function(E){if(E instanceof ArrayBuffer&&(E=new Uint8Array(E)),(E instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&E instanceof Uint8ClampedArray||E instanceof Int16Array||E instanceof Uint16Array||E instanceof Int32Array||E instanceof Uint32Array||E instanceof Float32Array||E instanceof Float64Array)&&(E=new Uint8Array(E.buffer,E.byteOffset,E.byteLength)),E instanceof Uint8Array){for(var Y=E.byteLength,G=[],D=0;D<Y;D++)G[D>>>2]|=E[D]<<24-D%4*8;x.call(this,G,Y)}else x.apply(this,arguments)};O.prototype=$}}(),d.lib.WordArray)},1817:function(C,le,me){var d;C.exports=(d=me(7585),function(H){var ee=d,$=ee.lib,x=$.WordArray,O=$.Hasher,E=ee.algo,Y=[],G=[];!function(){function B(oe){for(var z=H.sqrt(oe),q=2;q<=z;q++)if(!(oe%q))return!1;return!0}function Z(oe){return 4294967296*(oe-(0|oe))|0}for(var T=2,j=0;j<64;)B(T)&&(j<8&&(Y[j]=Z(H.pow(T,.5))),G[j]=Z(H.pow(T,1/3)),j++),T++}();var D=[],W=E.SHA256=O.extend({_doReset:function(){this._hash=new x.init(Y.slice(0))},_doProcessBlock:function(B,Z){for(var T=this._hash.words,j=T[0],oe=T[1],z=T[2],q=T[3],K=T[4],I=T[5],A=T[6],J=T[7],L=0;L<64;L++){if(L<16)D[L]=0|B[Z+L];else{var S=D[L-15],v=D[L-2];D[L]=((S<<25|S>>>7)^(S<<14|S>>>18)^S>>>3)+D[L-7]+((v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10)+D[L-16]}var te=j&oe^j&z^oe&z,N=J+((K<<26|K>>>6)^(K<<21|K>>>11)^(K<<7|K>>>25))+(K&I^~K&A)+G[L]+D[L];J=A,A=I,I=K,K=q+N|0,q=z,z=oe,oe=j,j=N+(((j<<30|j>>>2)^(j<<19|j>>>13)^(j<<10|j>>>22))+te)|0}T[0]=T[0]+j|0,T[1]=T[1]+oe|0,T[2]=T[2]+z|0,T[3]=T[3]+q|0,T[4]=T[4]+K|0,T[5]=T[5]+I|0,T[6]=T[6]+A|0,T[7]=T[7]+J|0},_doFinalize:function(){var B=this._data,Z=B.words,T=8*this._nDataBytes,j=8*B.sigBytes;return Z[j>>>5]|=128<<24-j%32,Z[14+(j+64>>>9<<4)]=H.floor(T/4294967296),Z[15+(j+64>>>9<<4)]=T,B.sigBytes=4*Z.length,this._process(),this._hash},clone:function(){var B=O.clone.call(this);return B._hash=this._hash.clone(),B}});ee.SHA256=O._createHelper(W),ee.HmacSHA256=O._createHmacHelper(W)}(Math),d.SHA256)},6654:C=>{!function(me){C.exports=me;var d="listeners",H={on:function $(G,D){return Y(this,G).push(D),this},once:function x(G,D){var W=this;return B.originalListener=D,Y(W,G).push(B),W;function B(){O.call(W,G,B),D.apply(this,arguments)}},off:O,emit:function E(G,D){var W=this,B=Y(W,G,!0);if(!B)return!1;var Z=arguments.length;if(1===Z)B.forEach(j);else if(2===Z)B.forEach(oe);else{var T=Array.prototype.slice.call(arguments,1);B.forEach(z)}return!!B.length;function j(q){q.call(W)}function oe(q){q.call(W,D)}function z(q){q.apply(W,T)}}};function ee(G){for(var D in H)G[D]=H[D];return G}function O(G,D){var B,W=this;if(arguments.length){if(D){if(B=Y(W,G,!0)){if(!(B=B.filter(Z)).length)return O.call(W,G);W[d][G]=B}}else if((B=W[d])&&(delete B[G],!Object.keys(B).length))return O.call(W)}else delete W[d];return W;function Z(T){return T!==D&&T.originalListener!==D}}function Y(G,D,W){if(!W||G[d]){var B=G[d]||(G[d]={});return B[D]||(B[D]=[])}}ee(me.prototype),me.mixin=ee}(function le(){if(!(this instanceof le))return new le})},9069:C=>{"use strict";var d,le="object"==typeof Reflect?Reflect:null,me=le&&"function"==typeof le.apply?le.apply:function(I,A,J){return Function.prototype.apply.call(I,A,J)};d=le&&"function"==typeof le.ownKeys?le.ownKeys:Object.getOwnPropertySymbols?function(I){return Object.getOwnPropertyNames(I).concat(Object.getOwnPropertySymbols(I))}:function(I){return Object.getOwnPropertyNames(I)};var ee=Number.isNaN||function(I){return I!=I};function $(){$.init.call(this)}C.exports=$,C.exports.once=function oe(K,I){return new Promise(function(A,J){function L(M){K.removeListener(I,S),J(M)}function S(){"function"==typeof K.removeListener&&K.removeListener("error",L),A([].slice.call(arguments))}q(K,I,S,{once:!0}),"error"!==I&&function z(K,I,A){"function"==typeof K.on&&q(K,"error",I,A)}(K,L,{once:!0})})},$.EventEmitter=$,$.prototype._events=void 0,$.prototype._eventsCount=0,$.prototype._maxListeners=void 0;var x=10;function O(K){if("function"!=typeof K)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof K)}function E(K){return void 0===K._maxListeners?$.defaultMaxListeners:K._maxListeners}function Y(K,I,A,J){var L,S,M;if(O(A),void 0===(S=K._events)?(S=K._events=Object.create(null),K._eventsCount=0):(void 0!==S.newListener&&(K.emit("newListener",I,A.listener?A.listener:A),S=K._events),M=S[I]),void 0===M)M=S[I]=A,++K._eventsCount;else if("function"==typeof M?M=S[I]=J?[A,M]:[M,A]:J?M.unshift(A):M.push(A),(L=E(K))>0&&M.length>L&&!M.warned){M.warned=!0;var v=new Error("Possible EventEmitter memory leak detected. "+M.length+" "+String(I)+" listeners added. Use emitter.setMaxListeners() to increase limit");v.name="MaxListenersExceededWarning",v.emitter=K,v.type=I,v.count=M.length,function H(K){console&&console.warn&&console.warn(K)}(v)}return K}function G(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function D(K,I,A){var J={fired:!1,wrapFn:void 0,target:K,type:I,listener:A},L=G.bind(J);return L.listener=A,J.wrapFn=L,L}function W(K,I,A){var J=K._events;if(void 0===J)return[];var L=J[I];return void 0===L?[]:"function"==typeof L?A?[L.listener||L]:[L]:A?function j(K){for(var I=new Array(K.length),A=0;A<I.length;++A)I[A]=K[A].listener||K[A];return I}(L):Z(L,L.length)}function B(K){var I=this._events;if(void 0!==I){var A=I[K];if("function"==typeof A)return 1;if(void 0!==A)return A.length}return 0}function Z(K,I){for(var A=new Array(I),J=0;J<I;++J)A[J]=K[J];return A}function q(K,I,A,J){if("function"==typeof K.on)J.once?K.once(I,A):K.on(I,A);else{if("function"!=typeof K.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof K);K.addEventListener(I,function L(S){J.once&&K.removeEventListener(I,L),A(S)})}}Object.defineProperty($,"defaultMaxListeners",{enumerable:!0,get:function(){return x},set:function(K){if("number"!=typeof K||K<0||ee(K))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+K+".");x=K}}),$.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},$.prototype.setMaxListeners=function(I){if("number"!=typeof I||I<0||ee(I))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+I+".");return this._maxListeners=I,this},$.prototype.getMaxListeners=function(){return E(this)},$.prototype.emit=function(I){for(var A=[],J=1;J<arguments.length;J++)A.push(arguments[J]);var L="error"===I,S=this._events;if(void 0!==S)L=L&&void 0===S.error;else if(!L)return!1;if(L){var M;if(A.length>0&&(M=A[0]),M instanceof Error)throw M;var v=new Error("Unhandled error."+(M?" ("+M.message+")":""));throw v.context=M,v}var P=S[I];if(void 0===P)return!1;if("function"==typeof P)me(P,this,A);else{var R=P.length,te=Z(P,R);for(J=0;J<R;++J)me(te[J],this,A)}return!0},$.prototype.on=$.prototype.addListener=function(I,A){return Y(this,I,A,!1)},$.prototype.prependListener=function(I,A){return Y(this,I,A,!0)},$.prototype.once=function(I,A){return O(A),this.on(I,D(this,I,A)),this},$.prototype.prependOnceListener=function(I,A){return O(A),this.prependListener(I,D(this,I,A)),this},$.prototype.off=$.prototype.removeListener=function(I,A){var J,L,S,M,v;if(O(A),void 0===(L=this._events))return this;if(void 0===(J=L[I]))return this;if(J===A||J.listener===A)0==--this._eventsCount?this._events=Object.create(null):(delete L[I],L.removeListener&&this.emit("removeListener",I,J.listener||A));else if("function"!=typeof J){for(S=-1,M=J.length-1;M>=0;M--)if(J[M]===A||J[M].listener===A){v=J[M].listener,S=M;break}if(S<0)return this;0===S?J.shift():function T(K,I){for(;I+1<K.length;I++)K[I]=K[I+1];K.pop()}(J,S),1===J.length&&(L[I]=J[0]),void 0!==L.removeListener&&this.emit("removeListener",I,v||A)}return this},$.prototype.removeAllListeners=function(I){var A,J,L;if(void 0===(J=this._events))return this;if(void 0===J.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==J[I]&&(0==--this._eventsCount?this._events=Object.create(null):delete J[I]),this;if(0===arguments.length){var M,S=Object.keys(J);for(L=0;L<S.length;++L)"removeListener"!==(M=S[L])&&this.removeAllListeners(M);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(A=J[I]))this.removeListener(I,A);else if(void 0!==A)for(L=A.length-1;L>=0;L--)this.removeListener(I,A[L]);return this},$.prototype.listeners=function(I){return W(this,I,!0)},$.prototype.rawListeners=function(I){return W(this,I,!1)},$.listenerCount=function(K,I){return"function"==typeof K.listenerCount?K.listenerCount(I):B.call(K,I)},$.prototype.listenerCount=B,$.prototype.eventNames=function(){return this._eventsCount>0?d(this._events):[]}},4327:function(C,le){var H;void 0!==(H=function(){"use strict";function $(D,W,B){var Z=new XMLHttpRequest;Z.open("GET",D),Z.responseType="blob",Z.onload=function(){G(Z.response,W,B)},Z.onerror=function(){console.error("could not download file")},Z.send()}function x(D){var W=new XMLHttpRequest;W.open("HEAD",D,!1);try{W.send()}catch(B){}return 200<=W.status&&299>=W.status}function O(D){try{D.dispatchEvent(new MouseEvent("click"))}catch(B){var W=document.createEvent("MouseEvents");W.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),D.dispatchEvent(W)}}var E="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,Y=E.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),G=E.saveAs||("object"!=typeof window||window!==E?function(){}:"download"in HTMLAnchorElement.prototype&&!Y?function(D,W,B){var Z=E.URL||E.webkitURL,T=document.createElement("a");T.download=W=W||D.name||"download",T.rel="noopener","string"==typeof D?(T.href=D,T.origin===location.origin?O(T):x(T.href)?$(D,W,B):O(T,T.target="_blank")):(T.href=Z.createObjectURL(D),setTimeout(function(){Z.revokeObjectURL(T.href)},4e4),setTimeout(function(){O(T)},0))}:"msSaveOrOpenBlob"in navigator?function(D,W,B){if(W=W||D.name||"download","string"!=typeof D)navigator.msSaveOrOpenBlob(function ee(D,W){return void 0===W?W={autoBom:!1}:"object"!=typeof W&&(console.warn("Deprecated: Expected third argument to be a object"),W={autoBom:!W}),W.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(D.type)?new Blob(["\ufeff",D],{type:D.type}):D}(D,B),W);else if(x(D))$(D,W,B);else{var Z=document.createElement("a");Z.href=D,Z.target="_blank",setTimeout(function(){O(Z)})}}:function(D,W,B,Z){if((Z=Z||open("","_blank"))&&(Z.document.title=Z.document.body.innerText="downloading..."),"string"==typeof D)return $(D,W,B);var T="application/octet-stream"===D.type,j=/constructor/i.test(E.HTMLElement)||E.safari,oe=/CriOS\/[\d]+/.test(navigator.userAgent);if((oe||T&&j||Y)&&"undefined"!=typeof FileReader){var z=new FileReader;z.onloadend=function(){var I=z.result;I=oe?I:I.replace(/^data:[^;]*;/,"data:attachment/file;"),Z?Z.location.href=I:location=I,Z=null},z.readAsDataURL(D)}else{var q=E.URL||E.webkitURL,K=q.createObjectURL(D);Z?Z.location=K:location.href=K,Z=null,setTimeout(function(){q.revokeObjectURL(K)},4e4)}});E.saveAs=G.saveAs=G,C.exports=G}.apply(le,[]))&&(C.exports=H)},5386:(C,le,me)=>{var d;!function(H,ee,$,x){"use strict";var oe,O=["","webkit","Moz","MS","ms","o"],E=ee.createElement("div"),G=Math.round,D=Math.abs,W=Date.now;function B(Ne,je,qe){return setTimeout(I(Ne,qe),je)}function Z(Ne,je,qe){return!!Array.isArray(Ne)&&(T(Ne,qe[je],qe),!0)}function T(Ne,je,qe){var Je;if(Ne)if(Ne.forEach)Ne.forEach(je,qe);else if(Ne.length!==x)for(Je=0;Je<Ne.length;)je.call(qe,Ne[Je],Je,Ne),Je++;else for(Je in Ne)Ne.hasOwnProperty(Je)&&je.call(qe,Ne[Je],Je,Ne)}function j(Ne,je,qe){var Je="DEPRECATED METHOD: "+je+"\n"+qe+" AT \n";return function(){var Ct=new Error("get-stack-trace"),Pt=Ct&&Ct.stack?Ct.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Mn=H.console&&(H.console.warn||H.console.log);return Mn&&Mn.call(H.console,Je,Pt),Ne.apply(this,arguments)}}oe="function"!=typeof Object.assign?function(je){if(je===x||null===je)throw new TypeError("Cannot convert undefined or null to object");for(var qe=Object(je),Je=1;Je<arguments.length;Je++){var Ct=arguments[Je];if(Ct!==x&&null!==Ct)for(var Pt in Ct)Ct.hasOwnProperty(Pt)&&(qe[Pt]=Ct[Pt])}return qe}:Object.assign;var z=j(function(je,qe,Je){for(var Ct=Object.keys(qe),Pt=0;Pt<Ct.length;)(!Je||Je&&je[Ct[Pt]]===x)&&(je[Ct[Pt]]=qe[Ct[Pt]]),Pt++;return je},"extend","Use `assign`."),q=j(function(je,qe){return z(je,qe,!0)},"merge","Use `assign`.");function K(Ne,je,qe){var Ct,Je=je.prototype;(Ct=Ne.prototype=Object.create(Je)).constructor=Ne,Ct._super=Je,qe&&oe(Ct,qe)}function I(Ne,je){return function(){return Ne.apply(je,arguments)}}function A(Ne,je){return"function"==typeof Ne?Ne.apply(je&&je[0]||x,je):Ne}function J(Ne,je){return Ne===x?je:Ne}function L(Ne,je,qe){T(P(je),function(Je){Ne.addEventListener(Je,qe,!1)})}function S(Ne,je,qe){T(P(je),function(Je){Ne.removeEventListener(Je,qe,!1)})}function M(Ne,je){for(;Ne;){if(Ne==je)return!0;Ne=Ne.parentNode}return!1}function v(Ne,je){return Ne.indexOf(je)>-1}function P(Ne){return Ne.trim().split(/\s+/g)}function R(Ne,je,qe){if(Ne.indexOf&&!qe)return Ne.indexOf(je);for(var Je=0;Je<Ne.length;){if(qe&&Ne[Je][qe]==je||!qe&&Ne[Je]===je)return Je;Je++}return-1}function te(Ne){return Array.prototype.slice.call(Ne,0)}function k(Ne,je,qe){for(var Je=[],Ct=[],Pt=0;Pt<Ne.length;){var Mn=je?Ne[Pt][je]:Ne[Pt];R(Ct,Mn)<0&&Je.push(Ne[Pt]),Ct[Pt]=Mn,Pt++}return qe&&(Je=je?Je.sort(function(sr,br){return sr[je]>br[je]}):Je.sort()),Je}function de(Ne,je){for(var qe,Je,Ct=je[0].toUpperCase()+je.slice(1),Pt=0;Pt<O.length;){if((Je=(qe=O[Pt])?qe+Ct:je)in Ne)return Je;Pt++}return x}var N=1;function g(Ne){var je=Ne.ownerDocument||Ne;return je.defaultView||je.parentWindow||H}var c="ontouchstart"in H,f=de(H,"PointerEvent")!==x,u=c&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),p="touch",y="mouse",Ce=["x","y"],b=["clientX","clientY"];function V(Ne,je){var qe=this;this.manager=Ne,this.callback=je,this.element=Ne.element,this.target=Ne.options.inputTarget,this.domHandler=function(Je){A(Ne.options.enable,[Ne])&&qe.handler(Je)},this.init()}function xe(Ne,je,qe){var Je=qe.pointers.length,Ct=qe.changedPointers.length,Pt=1&je&&Je-Ct==0,Mn=12&je&&Je-Ct==0;qe.isFirst=!!Pt,qe.isFinal=!!Mn,Pt&&(Ne.session={}),qe.eventType=je,function De(Ne,je){var qe=Ne.session,Je=je.pointers,Ct=Je.length;qe.firstInput||(qe.firstInput=Ze(je)),Ct>1&&!qe.firstMultiple?qe.firstMultiple=Ze(je):1===Ct&&(qe.firstMultiple=!1);var Pt=qe.firstInput,Mn=qe.firstMultiple,ri=Mn?Mn.center:Pt.center,sr=je.center=mt(Je);je.timeStamp=W(),je.deltaTime=je.timeStamp-Pt.timeStamp,je.angle=En(ri,sr),je.distance=jt(ri,sr),function Re(Ne,je){var qe=je.center,Je=Ne.offsetDelta||{},Ct=Ne.prevDelta||{},Pt=Ne.prevInput||{};(1===je.eventType||4===Pt.eventType)&&(Ct=Ne.prevDelta={x:Pt.deltaX||0,y:Pt.deltaY||0},Je=Ne.offsetDelta={x:qe.x,y:qe.y}),je.deltaX=Ct.x+(qe.x-Je.x),je.deltaY=Ct.y+(qe.y-Je.y)}(qe,je),je.offsetDirection=Wt(je.deltaX,je.deltaY);var br=bt(je.deltaTime,je.deltaX,je.deltaY);je.overallVelocityX=br.x,je.overallVelocityY=br.y,je.overallVelocity=D(br.x)>D(br.y)?br.x:br.y,je.scale=Mn?function mr(Ne,je){return jt(je[0],je[1],b)/jt(Ne[0],Ne[1],b)}(Mn.pointers,Je):1,je.rotation=Mn?function yn(Ne,je){return En(je[1],je[0],b)+En(Ne[1],Ne[0],b)}(Mn.pointers,Je):0,je.maxPointers=qe.prevInput?je.pointers.length>qe.prevInput.maxPointers?je.pointers.length:qe.prevInput.maxPointers:je.pointers.length,function Ue(Ne,je){var Ct,Pt,Mn,ri,qe=Ne.lastInterval||je,Je=je.timeStamp-qe.timeStamp;if(8!=je.eventType&&(Je>25||qe.velocity===x)){var sr=je.deltaX-qe.deltaX,br=je.deltaY-qe.deltaY,Xs=bt(Je,sr,br);Pt=Xs.x,Mn=Xs.y,Ct=D(Xs.x)>D(Xs.y)?Xs.x:Xs.y,ri=Wt(sr,br),Ne.lastInterval=je}else Ct=qe.velocity,Pt=qe.velocityX,Mn=qe.velocityY,ri=qe.direction;je.velocity=Ct,je.velocityX=Pt,je.velocityY=Mn,je.direction=ri}(qe,je);var Xs=Ne.element;M(je.srcEvent.target,Xs)&&(Xs=je.srcEvent.target),je.target=Xs}(Ne,qe),Ne.emit("hammer.input",qe),Ne.recognize(qe),Ne.session.prevInput=qe}function Ze(Ne){for(var je=[],qe=0;qe<Ne.pointers.length;)je[qe]={clientX:G(Ne.pointers[qe].clientX),clientY:G(Ne.pointers[qe].clientY)},qe++;return{timeStamp:W(),pointers:je,center:mt(je),deltaX:Ne.deltaX,deltaY:Ne.deltaY}}function mt(Ne){var je=Ne.length;if(1===je)return{x:G(Ne[0].clientX),y:G(Ne[0].clientY)};for(var qe=0,Je=0,Ct=0;Ct<je;)qe+=Ne[Ct].clientX,Je+=Ne[Ct].clientY,Ct++;return{x:G(qe/je),y:G(Je/je)}}function bt(Ne,je,qe){return{x:je/Ne||0,y:qe/Ne||0}}function Wt(Ne,je){return Ne===je?1:D(Ne)>=D(je)?Ne<0?2:4:je<0?8:16}function jt(Ne,je,qe){qe||(qe=Ce);var Je=je[qe[0]]-Ne[qe[0]],Ct=je[qe[1]]-Ne[qe[1]];return Math.sqrt(Je*Je+Ct*Ct)}function En(Ne,je,qe){return qe||(qe=Ce),180*Math.atan2(je[qe[1]]-Ne[qe[1]],je[qe[0]]-Ne[qe[0]])/Math.PI}V.prototype={handler:function(){},init:function(){this.evEl&&L(this.element,this.evEl,this.domHandler),this.evTarget&&L(this.target,this.evTarget,this.domHandler),this.evWin&&L(g(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&S(this.element,this.evEl,this.domHandler),this.evTarget&&S(this.target,this.evTarget,this.domHandler),this.evWin&&S(g(this.element),this.evWin,this.domHandler)}};var al={mousedown:1,mousemove:2,mouseup:4},Cf="mousedown",Tu="mousemove mouseup";function Zs(){this.evEl=Cf,this.evWin=Tu,this.pressed=!1,V.apply(this,arguments)}K(Zs,V,{handler:function(je){var qe=al[je.type];1&qe&&0===je.button&&(this.pressed=!0),2&qe&&1!==je.which&&(qe=4),this.pressed&&(4&qe&&(this.pressed=!1),this.callback(this.manager,qe,{pointers:[je],changedPointers:[je],pointerType:y,srcEvent:je}))}});var vo={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},xf={2:p,3:"pen",4:y,5:"kinect"},Su="pointerdown",Iu="pointermove pointerup pointercancel";function ic(){this.evEl=Su,this.evWin=Iu,V.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}H.MSPointerEvent&&!H.PointerEvent&&(Su="MSPointerDown",Iu="MSPointerMove MSPointerUp MSPointerCancel"),K(ic,V,{handler:function(je){var qe=this.store,Je=!1,Ct=je.type.toLowerCase().replace("ms",""),Pt=vo[Ct],Mn=xf[je.pointerType]||je.pointerType,ri=Mn==p,sr=R(qe,je.pointerId,"pointerId");1&Pt&&(0===je.button||ri)?sr<0&&(qe.push(je),sr=qe.length-1):12&Pt&&(Je=!0),!(sr<0)&&(qe[sr]=je,this.callback(this.manager,Pt,{pointers:qe,changedPointers:[je],pointerType:Mn,srcEvent:je}),Je&&qe.splice(sr,1))}});var vg={touchstart:1,touchmove:2,touchend:4,touchcancel:8},wf="touchstart",Ef="touchstart touchmove touchend touchcancel";function ku(){this.evTarget=wf,this.evWin=Ef,this.started=!1,V.apply(this,arguments)}function Tf(Ne,je){var qe=te(Ne.touches),Je=te(Ne.changedTouches);return 12&je&&(qe=k(qe.concat(Je),"identifier",!0)),[qe,Je]}K(ku,V,{handler:function(je){var qe=vg[je.type];if(1===qe&&(this.started=!0),this.started){var Je=Tf.call(this,je,qe);12&qe&&Je[0].length-Je[1].length==0&&(this.started=!1),this.callback(this.manager,qe,{pointers:Je[0],changedPointers:Je[1],pointerType:p,srcEvent:je})}}});var $r={touchstart:1,touchmove:2,touchend:4,touchcancel:8},bg="touchstart touchmove touchend touchcancel";function rc(){this.evTarget=bg,this.targetIds={},V.apply(this,arguments)}function yg(Ne,je){var qe=te(Ne.touches),Je=this.targetIds;if(3&je&&1===qe.length)return Je[qe[0].identifier]=!0,[qe,qe];var Ct,Pt,Mn=te(Ne.changedTouches),ri=[],sr=this.target;if(Pt=qe.filter(function(br){return M(br.target,sr)}),1===je)for(Ct=0;Ct<Pt.length;)Je[Pt[Ct].identifier]=!0,Ct++;for(Ct=0;Ct<Mn.length;)Je[Mn[Ct].identifier]&&ri.push(Mn[Ct]),12&je&&delete Je[Mn[Ct].identifier],Ct++;return ri.length?[k(Pt.concat(ri),"identifier",!0),ri]:void 0}function Du(){V.apply(this,arguments);var Ne=I(this.handler,this);this.touch=new rc(this.manager,Ne),this.mouse=new Zs(this.manager,Ne),this.primaryTouch=null,this.lastTouches=[]}function xg(Ne,je){1&Ne?(this.primaryTouch=je.changedPointers[0].identifier,ws.call(this,je)):12&Ne&&ws.call(this,je)}function ws(Ne){var je=Ne.changedPointers[0];if(je.identifier===this.primaryTouch){var qe={x:je.clientX,y:je.clientY};this.lastTouches.push(qe);var Je=this.lastTouches;setTimeout(function(){var Pt=Je.indexOf(qe);Pt>-1&&Je.splice(Pt,1)},2500)}}function wg(Ne){for(var je=Ne.srcEvent.clientX,qe=Ne.srcEvent.clientY,Je=0;Je<this.lastTouches.length;Je++){var Ct=this.lastTouches[Je],Pt=Math.abs(je-Ct.x),Mn=Math.abs(qe-Ct.y);if(Pt<=25&&Mn<=25)return!0}return!1}K(rc,V,{handler:function(je){var qe=$r[je.type],Je=yg.call(this,je,qe);!Je||this.callback(this.manager,qe,{pointers:Je[0],changedPointers:Je[1],pointerType:p,srcEvent:je})}}),K(Du,V,{handler:function(je,qe,Je){var Pt=Je.pointerType==y;if(!(Pt&&Je.sourceCapabilities&&Je.sourceCapabilities.firesTouchEvents)){if(Je.pointerType==p)xg.call(this,qe,Je);else if(Pt&&wg.call(this,Je))return;this.callback(je,qe,Je)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var $a=de(E.style,"touchAction"),Au=$a!==x,sc="compute",Pu="manipulation",bo="none",Jo="pan-x",yo="pan-y",Co=function If(){if(!Au)return!1;var Ne={},je=H.CSS&&H.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(qe){Ne[qe]=!je||H.CSS.supports("touch-action",qe)}),Ne}();function Nu(Ne,je){this.manager=Ne,this.set(je)}function vr(Ne){this.options=oe({},this.defaults,Ne||{}),this.id=function F(){return N++}(),this.manager=null,this.options.enable=J(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function cl(Ne){return 16&Ne?"cancel":8&Ne?"end":4&Ne?"move":2&Ne?"start":""}function kf(Ne){return 16==Ne?"down":8==Ne?"up":2==Ne?"left":4==Ne?"right":""}function ba(Ne,je){var qe=je.manager;return qe?qe.get(Ne):Ne}function In(){vr.apply(this,arguments)}function ya(){In.apply(this,arguments),this.pX=null,this.pY=null}function qn(){In.apply(this,arguments)}function ul(){vr.apply(this,arguments),this._timer=null,this._input=null}function Fu(){In.apply(this,arguments)}function Xn(){In.apply(this,arguments)}function on(){vr.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function wo(Ne,je){return(je=je||{}).recognizers=J(je.recognizers,wo.defaults.preset),new dl(Ne,je)}function dl(Ne,je){this.options=oe({},wo.defaults,je||{}),this.options.inputTarget=this.options.inputTarget||Ne,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Ne,this.input=function ge(Ne){return new(Ne.options.inputClass||(f?ic:u?rc:c?Du:Zs))(Ne,xe)}(this),this.touchAction=new Nu(this,this.options.touchAction),nn(this,!0),T(this.options.recognizers,function(qe){var Je=this.add(new qe[0](qe[1]));qe[2]&&Je.recognizeWith(qe[2]),qe[3]&&Je.requireFailure(qe[3])},this)}function nn(Ne,je){var Je,qe=Ne.element;qe.style&&(T(Ne.options.cssProps,function(Ct,Pt){Je=de(qe.style,Pt),je?(Ne.oldCssProps[Je]=qe.style[Je],qe.style[Je]=Ct):qe.style[Je]=Ne.oldCssProps[Je]||""}),je||(Ne.oldCssProps={}))}Nu.prototype={set:function(Ne){Ne==sc&&(Ne=this.compute()),Au&&this.manager.element.style&&Co[Ne]&&(this.manager.element.style[$a]=Ne),this.actions=Ne.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Ne=[];return T(this.manager.recognizers,function(je){A(je.options.enable,[je])&&(Ne=Ne.concat(je.getTouchAction()))}),function Sf(Ne){if(v(Ne,bo))return bo;var je=v(Ne,Jo),qe=v(Ne,yo);return je&&qe?bo:je||qe?je?Jo:yo:v(Ne,Pu)?Pu:"auto"}(Ne.join(" "))},preventDefaults:function(Ne){var je=Ne.srcEvent,qe=Ne.offsetDirection;if(!this.manager.session.prevented){var Je=this.actions,Ct=v(Je,bo)&&!Co[bo],Pt=v(Je,yo)&&!Co[yo],Mn=v(Je,Jo)&&!Co[Jo];if(Ct&&1===Ne.pointers.length&&Ne.distance<2&&Ne.deltaTime<250)return;return Mn&&Pt||!(Ct||Pt&&6&qe||Mn&&24&qe)?void 0:this.preventSrc(je)}je.preventDefault()},preventSrc:function(Ne){this.manager.session.prevented=!0,Ne.preventDefault()}},vr.prototype={defaults:{},set:function(Ne){return oe(this.options,Ne),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Ne){if(Z(Ne,"recognizeWith",this))return this;var je=this.simultaneous;return je[(Ne=ba(Ne,this)).id]||(je[Ne.id]=Ne,Ne.recognizeWith(this)),this},dropRecognizeWith:function(Ne){return Z(Ne,"dropRecognizeWith",this)||(Ne=ba(Ne,this),delete this.simultaneous[Ne.id]),this},requireFailure:function(Ne){if(Z(Ne,"requireFailure",this))return this;var je=this.requireFail;return-1===R(je,Ne=ba(Ne,this))&&(je.push(Ne),Ne.requireFailure(this)),this},dropRequireFailure:function(Ne){if(Z(Ne,"dropRequireFailure",this))return this;Ne=ba(Ne,this);var je=R(this.requireFail,Ne);return je>-1&&this.requireFail.splice(je,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Ne){return!!this.simultaneous[Ne.id]},emit:function(Ne){var je=this,qe=this.state;function Je(Ct){je.manager.emit(Ct,Ne)}qe<8&&Je(je.options.event+cl(qe)),Je(je.options.event),Ne.additionalEvent&&Je(Ne.additionalEvent),qe>=8&&Je(je.options.event+cl(qe))},tryEmit:function(Ne){if(this.canEmit())return this.emit(Ne);this.state=32},canEmit:function(){for(var Ne=0;Ne<this.requireFail.length;){if(!(33&this.requireFail[Ne].state))return!1;Ne++}return!0},recognize:function(Ne){var je=oe({},Ne);if(!A(this.options.enable,[this,je]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(je),30&this.state&&this.tryEmit(je)},process:function(Ne){},getTouchAction:function(){},reset:function(){}},K(In,vr,{defaults:{pointers:1},attrTest:function(Ne){var je=this.options.pointers;return 0===je||Ne.pointers.length===je},process:function(Ne){var je=this.state,qe=Ne.eventType,Je=6&je,Ct=this.attrTest(Ne);return Je&&(8&qe||!Ct)?16|je:Je||Ct?4&qe?8|je:2&je?4|je:2:32}}),K(ya,In,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var Ne=this.options.direction,je=[];return 6&Ne&&je.push(yo),24&Ne&&je.push(Jo),je},directionTest:function(Ne){var je=this.options,qe=!0,Je=Ne.distance,Ct=Ne.direction,Pt=Ne.deltaX,Mn=Ne.deltaY;return Ct&je.direction||(6&je.direction?(Ct=0===Pt?1:Pt<0?2:4,qe=Pt!=this.pX,Je=Math.abs(Ne.deltaX)):(Ct=0===Mn?1:Mn<0?8:16,qe=Mn!=this.pY,Je=Math.abs(Ne.deltaY))),Ne.direction=Ct,qe&&Je>je.threshold&&Ct&je.direction},attrTest:function(Ne){return In.prototype.attrTest.call(this,Ne)&&(2&this.state||!(2&this.state)&&this.directionTest(Ne))},emit:function(Ne){this.pX=Ne.deltaX,this.pY=Ne.deltaY;var je=kf(Ne.direction);je&&(Ne.additionalEvent=this.options.event+je),this._super.emit.call(this,Ne)}}),K(qn,In,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[bo]},attrTest:function(Ne){return this._super.attrTest.call(this,Ne)&&(Math.abs(Ne.scale-1)>this.options.threshold||2&this.state)},emit:function(Ne){1!==Ne.scale&&(Ne.additionalEvent=this.options.event+(Ne.scale<1?"in":"out")),this._super.emit.call(this,Ne)}}),K(ul,vr,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(Ne){var je=this.options,qe=Ne.pointers.length===je.pointers,Je=Ne.distance<je.threshold,Ct=Ne.deltaTime>je.time;if(this._input=Ne,!Je||!qe||12&Ne.eventType&&!Ct)this.reset();else if(1&Ne.eventType)this.reset(),this._timer=B(function(){this.state=8,this.tryEmit()},je.time,this);else if(4&Ne.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(Ne){8===this.state&&(Ne&&4&Ne.eventType?this.manager.emit(this.options.event+"up",Ne):(this._input.timeStamp=W(),this.manager.emit(this.options.event,this._input)))}}),K(Fu,In,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[bo]},attrTest:function(Ne){return this._super.attrTest.call(this,Ne)&&(Math.abs(Ne.rotation)>this.options.threshold||2&this.state)}}),K(Xn,In,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return ya.prototype.getTouchAction.call(this)},attrTest:function(Ne){var qe,je=this.options.direction;return 30&je?qe=Ne.overallVelocity:6&je?qe=Ne.overallVelocityX:24&je&&(qe=Ne.overallVelocityY),this._super.attrTest.call(this,Ne)&&je&Ne.offsetDirection&&Ne.distance>this.options.threshold&&Ne.maxPointers==this.options.pointers&&D(qe)>this.options.velocity&&4&Ne.eventType},emit:function(Ne){var je=kf(Ne.offsetDirection);je&&this.manager.emit(this.options.event+je,Ne),this.manager.emit(this.options.event,Ne)}}),K(on,vr,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Pu]},process:function(Ne){var je=this.options,qe=Ne.pointers.length===je.pointers,Je=Ne.distance<je.threshold,Ct=Ne.deltaTime<je.time;if(this.reset(),1&Ne.eventType&&0===this.count)return this.failTimeout();if(Je&&Ct&&qe){if(4!=Ne.eventType)return this.failTimeout();var Pt=!this.pTime||Ne.timeStamp-this.pTime<je.interval,Mn=!this.pCenter||jt(this.pCenter,Ne.center)<je.posThreshold;if(this.pTime=Ne.timeStamp,this.pCenter=Ne.center,Mn&&Pt?this.count+=1:this.count=1,this._input=Ne,0==this.count%je.taps)return this.hasRequireFailures()?(this._timer=B(function(){this.state=8,this.tryEmit()},je.interval,this),2):8}return 32},failTimeout:function(){return this._timer=B(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),wo.VERSION="2.0.7",wo.defaults={domEvents:!1,touchAction:sc,enable:!0,inputTarget:null,inputClass:null,preset:[[Fu,{enable:!1}],[qn,{enable:!1},["rotate"]],[Xn,{direction:6}],[ya,{direction:6},["swipe"]],[on],[on,{event:"doubletap",taps:2},["tap"]],[ul]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},dl.prototype={set:function(Ne){return oe(this.options,Ne),Ne.touchAction&&this.touchAction.update(),Ne.inputTarget&&(this.input.destroy(),this.input.target=Ne.inputTarget,this.input.init()),this},stop:function(Ne){this.session.stopped=Ne?2:1},recognize:function(Ne){var je=this.session;if(!je.stopped){this.touchAction.preventDefaults(Ne);var qe,Je=this.recognizers,Ct=je.curRecognizer;(!Ct||Ct&&8&Ct.state)&&(Ct=je.curRecognizer=null);for(var Pt=0;Pt<Je.length;)qe=Je[Pt],2===je.stopped||Ct&&qe!=Ct&&!qe.canRecognizeWith(Ct)?qe.reset():qe.recognize(Ne),!Ct&&14&qe.state&&(Ct=je.curRecognizer=qe),Pt++}},get:function(Ne){if(Ne instanceof vr)return Ne;for(var je=this.recognizers,qe=0;qe<je.length;qe++)if(je[qe].options.event==Ne)return je[qe];return null},add:function(Ne){if(Z(Ne,"add",this))return this;var je=this.get(Ne.options.event);return je&&this.remove(je),this.recognizers.push(Ne),Ne.manager=this,this.touchAction.update(),Ne},remove:function(Ne){if(Z(Ne,"remove",this))return this;if(Ne=this.get(Ne)){var je=this.recognizers,qe=R(je,Ne);-1!==qe&&(je.splice(qe,1),this.touchAction.update())}return this},on:function(Ne,je){if(Ne!==x&&je!==x){var qe=this.handlers;return T(P(Ne),function(Je){qe[Je]=qe[Je]||[],qe[Je].push(je)}),this}},off:function(Ne,je){if(Ne!==x){var qe=this.handlers;return T(P(Ne),function(Je){je?qe[Je]&&qe[Je].splice(R(qe[Je],je),1):delete qe[Je]}),this}},emit:function(Ne,je){this.options.domEvents&&function qi(Ne,je){var qe=ee.createEvent("Event");qe.initEvent(Ne,!0,!0),qe.gesture=je,je.target.dispatchEvent(qe)}(Ne,je);var qe=this.handlers[Ne]&&this.handlers[Ne].slice();if(qe&&qe.length){je.type=Ne,je.preventDefault=function(){je.srcEvent.preventDefault()};for(var Je=0;Je<qe.length;)qe[Je](je),Je++}},destroy:function(){this.element&&nn(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},oe(wo,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:dl,Input:V,TouchAction:Nu,TouchInput:rc,MouseInput:Zs,PointerEventInput:ic,TouchMouseInput:Du,SingleTouchInput:ku,Recognizer:vr,AttrRecognizer:In,Tap:on,Pan:ya,Swipe:Xn,Pinch:qn,Rotate:Fu,Press:ul,on:L,off:S,each:T,merge:q,extend:z,assign:oe,inherit:K,bindFn:I,prefixed:de}),(void 0!==H?H:"undefined"!=typeof self?self:{}).Hammer=wo,(d=function(){return wo}.call(le,me,le,C))!==x&&(C.exports=d)}(window,document)},8461:(C,le)=>{le.read=function(me,d,H,ee,$){var x,O,E=8*$-ee-1,Y=(1<<E)-1,G=Y>>1,D=-7,W=H?$-1:0,B=H?-1:1,Z=me[d+W];for(W+=B,x=Z&(1<<-D)-1,Z>>=-D,D+=E;D>0;x=256*x+me[d+W],W+=B,D-=8);for(O=x&(1<<-D)-1,x>>=-D,D+=ee;D>0;O=256*O+me[d+W],W+=B,D-=8);if(0===x)x=1-G;else{if(x===Y)return O?NaN:1/0*(Z?-1:1);O+=Math.pow(2,ee),x-=G}return(Z?-1:1)*O*Math.pow(2,x-ee)},le.write=function(me,d,H,ee,$,x){var O,E,Y,G=8*x-$-1,D=(1<<G)-1,W=D>>1,B=23===$?Math.pow(2,-24)-Math.pow(2,-77):0,Z=ee?0:x-1,T=ee?1:-1,j=d<0||0===d&&1/d<0?1:0;for(d=Math.abs(d),isNaN(d)||d===1/0?(E=isNaN(d)?1:0,O=D):(O=Math.floor(Math.log(d)/Math.LN2),d*(Y=Math.pow(2,-O))<1&&(O--,Y*=2),(d+=O+W>=1?B/Y:B*Math.pow(2,1-W))*Y>=2&&(O++,Y/=2),O+W>=D?(E=0,O=D):O+W>=1?(E=(d*Y-1)*Math.pow(2,$),O+=W):(E=d*Math.pow(2,W-1)*Math.pow(2,$),O=0));$>=8;me[H+Z]=255&E,Z+=T,E/=256,$-=8);for(O=O<<$|E,G+=$;G>0;me[H+Z]=255&O,Z+=T,O/=256,G-=8);me[H+Z-T]|=128*j}},6256:function(C,le){!function($){var Z,x="undefined",O=x!==typeof Buffer&&Buffer,E=x!==typeof Uint8Array&&Uint8Array,Y=x!==typeof ArrayBuffer&&ArrayBuffer,G=[0,0,0,0,0,0,0,0],D=Array.isArray||function M(v){return!!v&&"[object Array]"==Object.prototype.toString.call(v)},W=4294967296;function T(v,P,R){var te=P?0:4,k=P?4:0,de=P?0:3,N=P?1:2,F=P?2:1,g=P?3:0,l=P?A:L,c=P?J:S,f=_.prototype,u="is"+v,p="_"+u;return f.buffer=void 0,f.offset=0,f[p]=!0,f.toNumber=se,f.toString=function Ee(Me){var $e=this.buffer,be=this.offset,he=ce($e,be+te),Se=ce($e,be+k),ve="",ae=!R&&2147483648&he;for(ae&&(he=~he,Se=W-Se),Me=Me||10;;){var ue=he%Me*W+Se;if(he=Math.floor(he/Me),Se=Math.floor(ue/Me),ve=(ue%Me).toString(Me)+ve,!he&&!Se)break}return ae&&(ve="-"+ve),ve},f.toJSON=se,f.toArray=j,O&&(f.toBuffer=oe),E&&(f.toArrayBuffer=z),_[u]=function y(Me){return!(!Me||!Me[p])},$[v]=_,_;function _(Me,$e,be,he){return this instanceof _?function m(Me,$e,be,he,Se){E&&Y&&($e instanceof Y&&($e=new E($e)),he instanceof Y&&(he=new E(he))),$e||be||he||Z?(q($e,be)||(Se=be,he=$e,be=0,$e=new(Z||Array)(8)),Me.buffer=$e,Me.offset=be|=0,x!==typeof he&&("string"==typeof he?function ne(Me,$e,be,he){var Se=0,ve=be.length,ae=0,ue=0;"-"===be[0]&&Se++;for(var Ce=Se;Se<ve;){var b=parseInt(be[Se++],he);if(!(b>=0))break;ue=ue*he+b,ae=ae*he+Math.floor(ue/W),ue%=W}Ce&&(ae=~ae,ue?ue=W-ue:ae++),ke(Me,$e+te,ae),ke(Me,$e+k,ue)}($e,be,he,Se||10):q(he,Se)?K($e,be,he,Se):"number"==typeof Se?(ke($e,be+te,he),ke($e,be+k,Se)):he>0?l($e,be,he):he<0?c($e,be,he):K($e,be,G,0))):Me.buffer=I(G,0)}(this,Me,$e,be,he):new _(Me,$e,be,he)}function se(){var Me=this.buffer,$e=this.offset,be=ce(Me,$e+te),he=ce(Me,$e+k);return R||(be|=0),be?be*W+he:he}function ke(Me,$e,be){Me[$e+g]=255&be,Me[$e+F]=255&(be>>=8),Me[$e+N]=255&(be>>=8),Me[$e+de]=255&(be>>=8)}function ce(Me,$e){return 16777216*Me[$e+de]+(Me[$e+N]<<16)+(Me[$e+F]<<8)+Me[$e+g]}}function j(v){var P=this.buffer,R=this.offset;return Z=null,!1!==v&&0===R&&8===P.length&&D(P)?P:I(P,R)}function oe(v){var P=this.buffer,R=this.offset;if(Z=O,!1!==v&&0===R&&8===P.length&&Buffer.isBuffer(P))return P;var te=new O(8);return K(te,0,P,R),te}function z(v){var P=this.buffer,R=this.offset,te=P.buffer;if(Z=E,!1!==v&&0===R&&te instanceof Y&&8===te.byteLength)return te;var k=new E(8);return K(k,0,P,R),k.buffer}function q(v,P){var R=v&&v.length;return P|=0,R&&P+8<=R&&"string"!=typeof v[P]}function K(v,P,R,te){P|=0,te|=0;for(var k=0;k<8;k++)v[P++]=255&R[te++]}function I(v,P){return Array.prototype.slice.call(v,P,P+8)}function A(v,P,R){for(var te=P+8;te>P;)v[--te]=255&R,R/=256}function J(v,P,R){var te=P+8;for(R++;te>P;)v[--te]=255&-R^255,R/=256}function L(v,P,R){for(var te=P+8;P<te;)v[P++]=255&R,R/=256}function S(v,P,R){var te=P+8;for(R++;P<te;)v[P++]=255&-R^255,R/=256}T("Uint64BE",!0,!0),T("Int64BE",!0,!1),T("Uint64LE",!1,!0),T("Int64LE",!1,!1)}("string"!=typeof le.nodeName?le:this||{})},6425:C=>{var le={}.toString;C.exports=Array.isArray||function(me){return"[object Array]"==le.call(me)}},5650:C=>{C.exports=function le(me,d,H){function ee(O,E){if(!d[O]){if(!me[O]){if($)return $(O,!0);var G=new Error("Cannot find module '"+O+"'");throw G.code="MODULE_NOT_FOUND",G}var D=d[O]={exports:{}};me[O][0].call(D.exports,function(W){return ee(me[O][1][W]||W)},D,D.exports,le,me,d,H)}return d[O].exports}for(var $=void 0,x=0;x<H.length;x++)ee(H[x]);return ee}({1:[function(le,me,d){"use strict";var H=le("./utils"),ee=le("./support"),$="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";d.encode=function(x){for(var O,E,Y,D,W,B,Z=[],T=0,j=x.length,oe=j,z="string"!==H.getTypeOf(x);T<x.length;)oe=j-T,Y=z?(O=x[T++],E=T<j?x[T++]:0,T<j?x[T++]:0):(O=x.charCodeAt(T++),E=T<j?x.charCodeAt(T++):0,T<j?x.charCodeAt(T++):0),D=(3&O)<<4|E>>4,W=1<oe?(15&E)<<2|Y>>6:64,B=2<oe?63&Y:64,Z.push($.charAt(O>>2)+$.charAt(D)+$.charAt(W)+$.charAt(B));return Z.join("")},d.decode=function(x){var O,E,Y,G,D,W,B=0,Z=0,T="data:";if(x.substr(0,T.length)===T)throw new Error("Invalid base64 input, it looks like a data url.");var j,oe=3*(x=x.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(x.charAt(x.length-1)===$.charAt(64)&&oe--,x.charAt(x.length-2)===$.charAt(64)&&oe--,oe%1!=0)throw new Error("Invalid base64 input, bad content length.");for(j=ee.uint8array?new Uint8Array(0|oe):new Array(0|oe);B<x.length;)O=$.indexOf(x.charAt(B++))<<2|(G=$.indexOf(x.charAt(B++)))>>4,E=(15&G)<<4|(D=$.indexOf(x.charAt(B++)))>>2,Y=(3&D)<<6|(W=$.indexOf(x.charAt(B++))),j[Z++]=O,64!==D&&(j[Z++]=E),64!==W&&(j[Z++]=Y);return j}},{"./support":30,"./utils":32}],2:[function(le,me,d){"use strict";var H=le("./external"),ee=le("./stream/DataWorker"),$=le("./stream/Crc32Probe"),x=le("./stream/DataLengthProbe");function O(E,Y,G,D,W){this.compressedSize=E,this.uncompressedSize=Y,this.crc32=G,this.compression=D,this.compressedContent=W}O.prototype={getContentWorker:function(){var E=new ee(H.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new x("data_length")),Y=this;return E.on("end",function(){if(this.streamInfo.data_length!==Y.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),E},getCompressedWorker:function(){return new ee(H.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},O.createWorkerFrom=function(E,Y,G){return E.pipe(new $).pipe(new x("uncompressedSize")).pipe(Y.compressWorker(G)).pipe(new x("compressedSize")).withStreamInfo("compression",Y)},me.exports=O},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(le,me,d){"use strict";var H=le("./stream/GenericWorker");d.STORE={magic:"\0\0",compressWorker:function(){return new H("STORE compression")},uncompressWorker:function(){return new H("STORE decompression")}},d.DEFLATE=le("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(le,me,d){"use strict";var H=le("./utils"),ee=function(){for(var $,x=[],O=0;O<256;O++){$=O;for(var E=0;E<8;E++)$=1&$?3988292384^$>>>1:$>>>1;x[O]=$}return x}();me.exports=function($,x){return void 0!==$&&$.length?"string"!==H.getTypeOf($)?function(O,E,Y,G){var D=ee,W=0+Y;O^=-1;for(var B=0;B<W;B++)O=O>>>8^D[255&(O^E[B])];return-1^O}(0|x,$,$.length):function(O,E,Y,G){var D=ee,W=0+Y;O^=-1;for(var B=0;B<W;B++)O=O>>>8^D[255&(O^E.charCodeAt(B))];return-1^O}(0|x,$,$.length):0}},{"./utils":32}],5:[function(le,me,d){"use strict";d.base64=!1,d.binary=!1,d.dir=!1,d.createFolders=!0,d.date=null,d.compression=null,d.compressionOptions=null,d.comment=null,d.unixPermissions=null,d.dosPermissions=null},{}],6:[function(le,me,d){"use strict";var H;H="undefined"!=typeof Promise?Promise:le("lie"),me.exports={Promise:H}},{lie:37}],7:[function(le,me,d){"use strict";var H="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,ee=le("pako"),$=le("./utils"),x=le("./stream/GenericWorker"),O=H?"uint8array":"array";function E(Y,G){x.call(this,"FlateWorker/"+Y),this._pako=null,this._pakoAction=Y,this._pakoOptions=G,this.meta={}}d.magic="\b\0",$.inherits(E,x),E.prototype.processChunk=function(Y){this.meta=Y.meta,null===this._pako&&this._createPako(),this._pako.push($.transformTo(O,Y.data),!1)},E.prototype.flush=function(){x.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},E.prototype.cleanUp=function(){x.prototype.cleanUp.call(this),this._pako=null},E.prototype._createPako=function(){this._pako=new ee[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var Y=this;this._pako.onData=function(G){Y.push({data:G,meta:Y.meta})}},d.compressWorker=function(Y){return new E("Deflate",Y)},d.uncompressWorker=function(){return new E("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(le,me,d){"use strict";function H(D,W){var B,Z="";for(B=0;B<W;B++)Z+=String.fromCharCode(255&D),D>>>=8;return Z}function ee(D,W,B,Z,T,j){var oe,z,q=D.file,K=D.compression,I=j!==O.utf8encode,A=$.transformTo("string",j(q.name)),J=$.transformTo("string",O.utf8encode(q.name)),L=q.comment,S=$.transformTo("string",j(L)),M=$.transformTo("string",O.utf8encode(L)),v=J.length!==q.name.length,P=M.length!==L.length,R="",te="",k="",de=q.dir,N=q.date,F={crc32:0,compressedSize:0,uncompressedSize:0};W&&!B||(F.crc32=D.crc32,F.compressedSize=D.compressedSize,F.uncompressedSize=D.uncompressedSize);var g=0;W&&(g|=8),I||!v&&!P||(g|=2048);var u,_,l=0,c=0;de&&(l|=16),"UNIX"===T?(c=798,l|=(_=u=q.unixPermissions,u||(_=de?16893:33204),(65535&_)<<16)):(c=20,l|=function(u){return 63&(u||0)}(q.dosPermissions)),oe=N.getUTCHours(),oe<<=6,oe|=N.getUTCMinutes(),oe<<=5,oe|=N.getUTCSeconds()/2,z=N.getUTCFullYear()-1980,z<<=4,z|=N.getUTCMonth()+1,z<<=5,z|=N.getUTCDate(),v&&(te=H(1,1)+H(E(A),4)+J,R+="up"+H(te.length,2)+te),P&&(k=H(1,1)+H(E(S),4)+M,R+="uc"+H(k.length,2)+k);var f="";return f+="\n\0",f+=H(g,2),f+=K.magic,f+=H(oe,2),f+=H(z,2),f+=H(F.crc32,4),f+=H(F.compressedSize,4),f+=H(F.uncompressedSize,4),f+=H(A.length,2),f+=H(R.length,2),{fileRecord:Y.LOCAL_FILE_HEADER+f+A+R,dirRecord:Y.CENTRAL_FILE_HEADER+H(c,2)+f+H(S.length,2)+"\0\0\0\0"+H(l,4)+H(Z,4)+A+R+S}}var $=le("../utils"),x=le("../stream/GenericWorker"),O=le("../utf8"),E=le("../crc32"),Y=le("../signature");function G(D,W,B,Z){x.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=W,this.zipPlatform=B,this.encodeFileName=Z,this.streamFiles=D,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}$.inherits(G,x),G.prototype.push=function(D){var W=D.meta.percent||0,B=this.entriesCount,Z=this._sources.length;this.accumulate?this.contentBuffer.push(D):(this.bytesWritten+=D.data.length,x.prototype.push.call(this,{data:D.data,meta:{currentFile:this.currentFile,percent:B?(W+100*(B-Z-1))/B:100}}))},G.prototype.openedSource=function(D){this.currentSourceOffset=this.bytesWritten,this.currentFile=D.file.name;var W=this.streamFiles&&!D.file.dir;if(W){var B=ee(D,W,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:B.fileRecord,meta:{percent:0}})}else this.accumulate=!0},G.prototype.closedSource=function(D){this.accumulate=!1;var Z,W=this.streamFiles&&!D.file.dir,B=ee(D,W,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(B.dirRecord),W)this.push({data:(Z=D,Y.DATA_DESCRIPTOR+H(Z.crc32,4)+H(Z.compressedSize,4)+H(Z.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:B.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},G.prototype.flush=function(){for(var D=this.bytesWritten,W=0;W<this.dirRecords.length;W++)this.push({data:this.dirRecords[W],meta:{percent:100}});var T,j,oe,K,Z=(T=this.dirRecords.length,j=this.bytesWritten-D,oe=D,K=$.transformTo("string",(0,this.encodeFileName)(this.zipComment)),Y.CENTRAL_DIRECTORY_END+"\0\0\0\0"+H(T,2)+H(T,2)+H(j,4)+H(oe,4)+H(K.length,2)+K);this.push({data:Z,meta:{percent:100}})},G.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},G.prototype.registerPrevious=function(D){this._sources.push(D);var W=this;return D.on("data",function(B){W.processChunk(B)}),D.on("end",function(){W.closedSource(W.previous.streamInfo),W._sources.length?W.prepareNextSource():W.end()}),D.on("error",function(B){W.error(B)}),this},G.prototype.resume=function(){return!!x.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},G.prototype.error=function(D){var W=this._sources;if(!x.prototype.error.call(this,D))return!1;for(var B=0;B<W.length;B++)try{W[B].error(D)}catch(Z){}return!0},G.prototype.lock=function(){x.prototype.lock.call(this);for(var D=this._sources,W=0;W<D.length;W++)D[W].lock()},me.exports=G},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(le,me,d){"use strict";var H=le("../compressions"),ee=le("./ZipFileWorker");d.generateWorker=function($,x,O){var E=new ee(x.streamFiles,O,x.platform,x.encodeFileName),Y=0;try{$.forEach(function(G,D){Y++;var W=function(j,oe){var z=j||oe,q=H[z];if(!q)throw new Error(z+" is not a valid compression method !");return q}(D.options.compression,x.compression),Z=D.dir,T=D.date;D._compressWorker(W,D.options.compressionOptions||x.compressionOptions||{}).withStreamInfo("file",{name:G,dir:Z,date:T,comment:D.comment||"",unixPermissions:D.unixPermissions,dosPermissions:D.dosPermissions}).pipe(E)}),E.entriesCount=Y}catch(G){E.error(G)}return E}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(le,me,d){"use strict";function H(){if(!(this instanceof H))return new H;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var ee=new H;for(var $ in this)"function"!=typeof this[$]&&(ee[$]=this[$]);return ee}}(H.prototype=le("./object")).loadAsync=le("./load"),H.support=le("./support"),H.defaults=le("./defaults"),H.version="3.10.1",H.loadAsync=function(ee,$){return(new H).loadAsync(ee,$)},H.external=le("./external"),me.exports=H},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(le,me,d){"use strict";var H=le("./utils"),ee=le("./external"),$=le("./utf8"),x=le("./zipEntries"),O=le("./stream/Crc32Probe"),E=le("./nodejsUtils");function Y(G){return new ee.Promise(function(D,W){var B=G.decompressed.getContentWorker().pipe(new O);B.on("error",function(Z){W(Z)}).on("end",function(){B.streamInfo.crc32!==G.decompressed.crc32?W(new Error("Corrupted zip : CRC32 mismatch")):D()}).resume()})}me.exports=function(G,D){var W=this;return D=H.extend(D||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:$.utf8decode}),E.isNode&&E.isStream(G)?ee.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):H.prepareContent("the loaded zip file",G,!0,D.optimizedBinaryString,D.base64).then(function(B){var Z=new x(D);return Z.load(B),Z}).then(function(B){var Z=[ee.Promise.resolve(B)],T=B.files;if(D.checkCRC32)for(var j=0;j<T.length;j++)Z.push(Y(T[j]));return ee.Promise.all(Z)}).then(function(B){for(var Z=B.shift(),T=Z.files,j=0;j<T.length;j++){var oe=T[j],z=oe.fileNameStr,q=H.resolve(oe.fileNameStr);W.file(q,oe.decompressed,{binary:!0,optimizedBinaryString:!0,date:oe.date,dir:oe.dir,comment:oe.fileCommentStr.length?oe.fileCommentStr:null,unixPermissions:oe.unixPermissions,dosPermissions:oe.dosPermissions,createFolders:D.createFolders}),oe.dir||(W.file(q).unsafeOriginalName=z)}return Z.zipComment.length&&(W.comment=Z.zipComment),W})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(le,me,d){"use strict";var H=le("../utils"),ee=le("../stream/GenericWorker");function $(x,O){ee.call(this,"Nodejs stream input adapter for "+x),this._upstreamEnded=!1,this._bindStream(O)}H.inherits($,ee),$.prototype._bindStream=function(x){var O=this;(this._stream=x).pause(),x.on("data",function(E){O.push({data:E,meta:{percent:0}})}).on("error",function(E){O.isPaused?this.generatedError=E:O.error(E)}).on("end",function(){O.isPaused?O._upstreamEnded=!0:O.end()})},$.prototype.pause=function(){return!!ee.prototype.pause.call(this)&&(this._stream.pause(),!0)},$.prototype.resume=function(){return!!ee.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},me.exports=$},{"../stream/GenericWorker":28,"../utils":32}],13:[function(le,me,d){"use strict";var H=le("readable-stream").Readable;function ee($,x,O){H.call(this,x),this._helper=$;var E=this;$.on("data",function(Y,G){E.push(Y)||E._helper.pause(),O&&O(G)}).on("error",function(Y){E.emit("error",Y)}).on("end",function(){E.push(null)})}le("../utils").inherits(ee,H),ee.prototype._read=function(){this._helper.resume()},me.exports=ee},{"../utils":32,"readable-stream":16}],14:[function(le,me,d){"use strict";me.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(H,ee){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(H,ee);if("number"==typeof H)throw new Error('The "data" argument must not be a number');return new Buffer(H,ee)},allocBuffer:function(H){if(Buffer.alloc)return Buffer.alloc(H);var ee=new Buffer(H);return ee.fill(0),ee},isBuffer:function(H){return Buffer.isBuffer(H)},isStream:function(H){return H&&"function"==typeof H.on&&"function"==typeof H.pause&&"function"==typeof H.resume}}},{}],15:[function(le,me,d){"use strict";function H(q,K,I){var A,J=$.getTypeOf(K),L=$.extend(I||{},E);L.date=L.date||new Date,null!==L.compression&&(L.compression=L.compression.toUpperCase()),"string"==typeof L.unixPermissions&&(L.unixPermissions=parseInt(L.unixPermissions,8)),L.unixPermissions&&16384&L.unixPermissions&&(L.dir=!0),L.dosPermissions&&16&L.dosPermissions&&(L.dir=!0),L.dir&&(q=T(q)),L.createFolders&&(A=Z(q))&&j.call(this,A,!0),I&&void 0!==I.binary||(L.binary=!("string"===J&&!1===L.binary&&!1===L.base64)),(K instanceof Y&&0===K.uncompressedSize||L.dir||!K||0===K.length)&&(L.base64=!1,L.binary=!0,K="",L.compression="STORE",J="string");var M;M=K instanceof Y||K instanceof x?K:W.isNode&&W.isStream(K)?new B(q,K):$.prepareContent(q,K,L.binary,L.optimizedBinaryString,L.base64);var v=new G(q,M,L);this.files[q]=v}var ee=le("./utf8"),$=le("./utils"),x=le("./stream/GenericWorker"),O=le("./stream/StreamHelper"),E=le("./defaults"),Y=le("./compressedObject"),G=le("./zipObject"),D=le("./generate"),W=le("./nodejsUtils"),B=le("./nodejs/NodejsStreamInputAdapter"),Z=function(q){"/"===q.slice(-1)&&(q=q.substring(0,q.length-1));var K=q.lastIndexOf("/");return 0<K?q.substring(0,K):""},T=function(q){return"/"!==q.slice(-1)&&(q+="/"),q},j=function(q,K){return K=void 0!==K?K:E.createFolders,q=T(q),this.files[q]||H.call(this,q,null,{dir:!0,createFolders:K}),this.files[q]};function oe(q){return"[object RegExp]"===Object.prototype.toString.call(q)}var z={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(q){var K,I,A;for(K in this.files)A=this.files[K],(I=K.slice(this.root.length,K.length))&&K.slice(0,this.root.length)===this.root&&q(I,A)},filter:function(q){var K=[];return this.forEach(function(I,A){q(I,A)&&K.push(A)}),K},file:function(q,K,I){if(1!==arguments.length)return H.call(this,q=this.root+q,K,I),this;if(oe(q)){var A=q;return this.filter(function(L,S){return!S.dir&&A.test(L)})}var J=this.files[this.root+q];return J&&!J.dir?J:null},folder:function(q){if(!q)return this;if(oe(q))return this.filter(function(J,L){return L.dir&&q.test(J)});var I=j.call(this,this.root+q),A=this.clone();return A.root=I.name,A},remove:function(q){var K=this.files[q=this.root+q];if(K||("/"!==q.slice(-1)&&(q+="/"),K=this.files[q]),K&&!K.dir)delete this.files[q];else for(var I=this.filter(function(J,L){return L.name.slice(0,q.length)===q}),A=0;A<I.length;A++)delete this.files[I[A].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(q){var K,I={};try{if((I=$.extend(q||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:ee.utf8encode})).type=I.type.toLowerCase(),I.compression=I.compression.toUpperCase(),"binarystring"===I.type&&(I.type="string"),!I.type)throw new Error("No output type specified.");$.checkSupport(I.type),"darwin"!==I.platform&&"freebsd"!==I.platform&&"linux"!==I.platform&&"sunos"!==I.platform||(I.platform="UNIX"),"win32"===I.platform&&(I.platform="DOS"),K=D.generateWorker(this,I,I.comment||this.comment||"")}catch(J){(K=new x("error")).error(J)}return new O(K,I.type||"string",I.mimeType)},generateAsync:function(q,K){return this.generateInternalStream(q).accumulate(K)},generateNodeStream:function(q,K){return(q=q||{}).type||(q.type="nodebuffer"),this.generateInternalStream(q).toNodejsStream(K)}};me.exports=z},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(le,me,d){"use strict";me.exports=le("stream")},{stream:void 0}],17:[function(le,me,d){"use strict";var H=le("./DataReader");function ee($){H.call(this,$);for(var x=0;x<this.data.length;x++)$[x]=255&$[x]}le("../utils").inherits(ee,H),ee.prototype.byteAt=function($){return this.data[this.zero+$]},ee.prototype.lastIndexOfSignature=function($){for(var x=$.charCodeAt(0),O=$.charCodeAt(1),E=$.charCodeAt(2),Y=$.charCodeAt(3),G=this.length-4;0<=G;--G)if(this.data[G]===x&&this.data[G+1]===O&&this.data[G+2]===E&&this.data[G+3]===Y)return G-this.zero;return-1},ee.prototype.readAndCheckSignature=function($){var x=$.charCodeAt(0),O=$.charCodeAt(1),E=$.charCodeAt(2),Y=$.charCodeAt(3),G=this.readData(4);return x===G[0]&&O===G[1]&&E===G[2]&&Y===G[3]},ee.prototype.readData=function($){if(this.checkOffset($),0===$)return[];var x=this.data.slice(this.zero+this.index,this.zero+this.index+$);return this.index+=$,x},me.exports=ee},{"../utils":32,"./DataReader":18}],18:[function(le,me,d){"use strict";var H=le("../utils");function ee($){this.data=$,this.length=$.length,this.index=0,this.zero=0}ee.prototype={checkOffset:function($){this.checkIndex(this.index+$)},checkIndex:function($){if(this.length<this.zero+$||$<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+$+"). Corrupted zip ?")},setIndex:function($){this.checkIndex($),this.index=$},skip:function($){this.setIndex(this.index+$)},byteAt:function(){},readInt:function($){var x,O=0;for(this.checkOffset($),x=this.index+$-1;x>=this.index;x--)O=(O<<8)+this.byteAt(x);return this.index+=$,O},readString:function($){return H.transformTo("string",this.readData($))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var $=this.readInt(4);return new Date(Date.UTC(1980+($>>25&127),($>>21&15)-1,$>>16&31,$>>11&31,$>>5&63,(31&$)<<1))}},me.exports=ee},{"../utils":32}],19:[function(le,me,d){"use strict";var H=le("./Uint8ArrayReader");function ee($){H.call(this,$)}le("../utils").inherits(ee,H),ee.prototype.readData=function($){this.checkOffset($);var x=this.data.slice(this.zero+this.index,this.zero+this.index+$);return this.index+=$,x},me.exports=ee},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(le,me,d){"use strict";var H=le("./DataReader");function ee($){H.call(this,$)}le("../utils").inherits(ee,H),ee.prototype.byteAt=function($){return this.data.charCodeAt(this.zero+$)},ee.prototype.lastIndexOfSignature=function($){return this.data.lastIndexOf($)-this.zero},ee.prototype.readAndCheckSignature=function($){return $===this.readData(4)},ee.prototype.readData=function($){this.checkOffset($);var x=this.data.slice(this.zero+this.index,this.zero+this.index+$);return this.index+=$,x},me.exports=ee},{"../utils":32,"./DataReader":18}],21:[function(le,me,d){"use strict";var H=le("./ArrayReader");function ee($){H.call(this,$)}le("../utils").inherits(ee,H),ee.prototype.readData=function($){if(this.checkOffset($),0===$)return new Uint8Array(0);var x=this.data.subarray(this.zero+this.index,this.zero+this.index+$);return this.index+=$,x},me.exports=ee},{"../utils":32,"./ArrayReader":17}],22:[function(le,me,d){"use strict";var H=le("../utils"),ee=le("../support"),$=le("./ArrayReader"),x=le("./StringReader"),O=le("./NodeBufferReader"),E=le("./Uint8ArrayReader");me.exports=function(Y){var G=H.getTypeOf(Y);return H.checkSupport(G),"string"!==G||ee.uint8array?"nodebuffer"===G?new O(Y):ee.uint8array?new E(H.transformTo("uint8array",Y)):new $(H.transformTo("array",Y)):new x(Y)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(le,me,d){"use strict";d.LOCAL_FILE_HEADER="PK\x03\x04",d.CENTRAL_FILE_HEADER="PK\x01\x02",d.CENTRAL_DIRECTORY_END="PK\x05\x06",d.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",d.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",d.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(le,me,d){"use strict";var H=le("./GenericWorker"),ee=le("../utils");function $(x){H.call(this,"ConvertWorker to "+x),this.destType=x}ee.inherits($,H),$.prototype.processChunk=function(x){this.push({data:ee.transformTo(this.destType,x.data),meta:x.meta})},me.exports=$},{"../utils":32,"./GenericWorker":28}],25:[function(le,me,d){"use strict";var H=le("./GenericWorker"),ee=le("../crc32");function $(){H.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}le("../utils").inherits($,H),$.prototype.processChunk=function(x){this.streamInfo.crc32=ee(x.data,this.streamInfo.crc32||0),this.push(x)},me.exports=$},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(le,me,d){"use strict";var H=le("../utils"),ee=le("./GenericWorker");function $(x){ee.call(this,"DataLengthProbe for "+x),this.propName=x,this.withStreamInfo(x,0)}H.inherits($,ee),$.prototype.processChunk=function(x){x&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+x.data.length),ee.prototype.processChunk.call(this,x)},me.exports=$},{"../utils":32,"./GenericWorker":28}],27:[function(le,me,d){"use strict";var H=le("../utils"),ee=le("./GenericWorker");function $(x){ee.call(this,"DataWorker");var O=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,x.then(function(E){O.dataIsReady=!0,O.data=E,O.max=E&&E.length||0,O.type=H.getTypeOf(E),O.isPaused||O._tickAndRepeat()},function(E){O.error(E)})}H.inherits($,ee),$.prototype.cleanUp=function(){ee.prototype.cleanUp.call(this),this.data=null},$.prototype.resume=function(){return!!ee.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,H.delay(this._tickAndRepeat,[],this)),!0)},$.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(H.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},$.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var x=null,O=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":x=this.data.substring(this.index,O);break;case"uint8array":x=this.data.subarray(this.index,O);break;case"array":case"nodebuffer":x=this.data.slice(this.index,O)}return this.index=O,this.push({data:x,meta:{percent:this.max?this.index/this.max*100:0}})},me.exports=$},{"../utils":32,"./GenericWorker":28}],28:[function(le,me,d){"use strict";function H(ee){this.name=ee||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}H.prototype={push:function(ee){this.emit("data",ee)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(ee){this.emit("error",ee)}return!0},error:function(ee){return!this.isFinished&&(this.isPaused?this.generatedError=ee:(this.isFinished=!0,this.emit("error",ee),this.previous&&this.previous.error(ee),this.cleanUp()),!0)},on:function(ee,$){return this._listeners[ee].push($),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(ee,$){if(this._listeners[ee])for(var x=0;x<this._listeners[ee].length;x++)this._listeners[ee][x].call(this,$)},pipe:function(ee){return ee.registerPrevious(this)},registerPrevious:function(ee){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=ee.streamInfo,this.mergeStreamInfo(),this.previous=ee;var $=this;return ee.on("data",function(x){$.processChunk(x)}),ee.on("end",function(){$.end()}),ee.on("error",function(x){$.error(x)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var ee=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),ee=!0),this.previous&&this.previous.resume(),!ee},flush:function(){},processChunk:function(ee){this.push(ee)},withStreamInfo:function(ee,$){return this.extraStreamInfo[ee]=$,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var ee in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,ee)&&(this.streamInfo[ee]=this.extraStreamInfo[ee])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var ee="Worker "+this.name;return this.previous?this.previous+" -> "+ee:ee}},me.exports=H},{}],29:[function(le,me,d){"use strict";var H=le("../utils"),ee=le("./ConvertWorker"),$=le("./GenericWorker"),x=le("../base64"),O=le("../support"),E=le("../external"),Y=null;if(O.nodestream)try{Y=le("../nodejs/NodejsStreamOutputAdapter")}catch(W){}function D(W,B,Z){var T=B;switch(B){case"blob":case"arraybuffer":T="uint8array";break;case"base64":T="string"}try{this._internalType=T,this._outputType=B,this._mimeType=Z,H.checkSupport(T),this._worker=W.pipe(new ee(T)),W.lock()}catch(j){this._worker=new $("error"),this._worker.error(j)}}D.prototype={accumulate:function(W){return function G(W,B){return new E.Promise(function(Z,T){var j=[],oe=W._internalType,z=W._outputType,q=W._mimeType;W.on("data",function(K,I){j.push(K),B&&B(I)}).on("error",function(K){j=[],T(K)}).on("end",function(){try{var K=function(I,A,J){switch(I){case"blob":return H.newBlob(H.transformTo("arraybuffer",A),J);case"base64":return x.encode(A);default:return H.transformTo(I,A)}}(z,function(I,A){var J,L=0,S=null,M=0;for(J=0;J<A.length;J++)M+=A[J].length;switch(I){case"string":return A.join("");case"array":return Array.prototype.concat.apply([],A);case"uint8array":for(S=new Uint8Array(M),J=0;J<A.length;J++)S.set(A[J],L),L+=A[J].length;return S;case"nodebuffer":return Buffer.concat(A);default:throw new Error("concat : unsupported type '"+I+"'")}}(oe,j),q);Z(K)}catch(I){T(I)}j=[]}).resume()})}(this,W)},on:function(W,B){var Z=this;return this._worker.on(W,"data"===W?function(T){B.call(Z,T.data,T.meta)}:function(){H.delay(B,arguments,Z)}),this},resume:function(){return H.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(W){if(H.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new Y(this,{objectMode:"nodebuffer"!==this._outputType},W)}},me.exports=D},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(le,me,d){"use strict";if(d.base64=!0,d.array=!0,d.string=!0,d.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,d.nodebuffer="undefined"!=typeof Buffer,d.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)d.blob=!1;else{var H=new ArrayBuffer(0);try{d.blob=0===new Blob([H],{type:"application/zip"}).size}catch($){try{var ee=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);ee.append(H),d.blob=0===ee.getBlob("application/zip").size}catch(x){d.blob=!1}}}try{d.nodestream=!!le("readable-stream").Readable}catch($){d.nodestream=!1}},{"readable-stream":16}],31:[function(le,me,d){"use strict";for(var H=le("./utils"),ee=le("./support"),$=le("./nodejsUtils"),x=le("./stream/GenericWorker"),O=new Array(256),E=0;E<256;E++)O[E]=252<=E?6:248<=E?5:240<=E?4:224<=E?3:192<=E?2:1;function Y(){x.call(this,"utf-8 decode"),this.leftOver=null}function G(){x.call(this,"utf-8 encode")}O[254]=O[254]=1,d.utf8encode=function(D){return ee.nodebuffer?$.newBufferFrom(D,"utf-8"):function(W){var B,Z,T,j,oe,z=W.length,q=0;for(j=0;j<z;j++)55296==(64512&(Z=W.charCodeAt(j)))&&j+1<z&&56320==(64512&(T=W.charCodeAt(j+1)))&&(Z=65536+(Z-55296<<10)+(T-56320),j++),q+=Z<128?1:Z<2048?2:Z<65536?3:4;for(B=ee.uint8array?new Uint8Array(q):new Array(q),j=oe=0;oe<q;j++)55296==(64512&(Z=W.charCodeAt(j)))&&j+1<z&&56320==(64512&(T=W.charCodeAt(j+1)))&&(Z=65536+(Z-55296<<10)+(T-56320),j++),Z<128?B[oe++]=Z:(Z<2048?B[oe++]=192|Z>>>6:(Z<65536?B[oe++]=224|Z>>>12:(B[oe++]=240|Z>>>18,B[oe++]=128|Z>>>12&63),B[oe++]=128|Z>>>6&63),B[oe++]=128|63&Z);return B}(D)},d.utf8decode=function(D){return ee.nodebuffer?H.transformTo("nodebuffer",D).toString("utf-8"):function(W){var B,Z,T,j,oe=W.length,z=new Array(2*oe);for(B=Z=0;B<oe;)if((T=W[B++])<128)z[Z++]=T;else if(4<(j=O[T]))z[Z++]=65533,B+=j-1;else{for(T&=2===j?31:3===j?15:7;1<j&&B<oe;)T=T<<6|63&W[B++],j--;1<j?z[Z++]=65533:T<65536?z[Z++]=T:(z[Z++]=55296|(T-=65536)>>10&1023,z[Z++]=56320|1023&T)}return z.length!==Z&&(z.subarray?z=z.subarray(0,Z):z.length=Z),H.applyFromCharCode(z)}(D=H.transformTo(ee.uint8array?"uint8array":"array",D))},H.inherits(Y,x),Y.prototype.processChunk=function(D){var W=H.transformTo(ee.uint8array?"uint8array":"array",D.data);if(this.leftOver&&this.leftOver.length){if(ee.uint8array){var B=W;(W=new Uint8Array(B.length+this.leftOver.length)).set(this.leftOver,0),W.set(B,this.leftOver.length)}else W=this.leftOver.concat(W);this.leftOver=null}var Z=function(j,oe){var z;for((oe=oe||j.length)>j.length&&(oe=j.length),z=oe-1;0<=z&&128==(192&j[z]);)z--;return z<0||0===z?oe:z+O[j[z]]>oe?z:oe}(W),T=W;Z!==W.length&&(ee.uint8array?(T=W.subarray(0,Z),this.leftOver=W.subarray(Z,W.length)):(T=W.slice(0,Z),this.leftOver=W.slice(Z,W.length))),this.push({data:d.utf8decode(T),meta:D.meta})},Y.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:d.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},d.Utf8DecodeWorker=Y,H.inherits(G,x),G.prototype.processChunk=function(D){this.push({data:d.utf8encode(D.data),meta:D.meta})},d.Utf8EncodeWorker=G},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(le,me,d){"use strict";var H=le("./support"),ee=le("./base64"),$=le("./nodejsUtils"),x=le("./external");function O(B){return B}function E(B,Z){for(var T=0;T<B.length;++T)Z[T]=255&B.charCodeAt(T);return Z}le("setimmediate"),d.newBlob=function(B,Z){d.checkSupport("blob");try{return new Blob([B],{type:Z})}catch(j){try{var T=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return T.append(B),T.getBlob(Z)}catch(oe){throw new Error("Bug : can't construct the Blob.")}}};var Y={stringifyByChunk:function(B,Z,T){var j=[],oe=0,z=B.length;if(z<=T)return String.fromCharCode.apply(null,B);for(;oe<z;)j.push(String.fromCharCode.apply(null,"array"===Z||"nodebuffer"===Z?B.slice(oe,Math.min(oe+T,z)):B.subarray(oe,Math.min(oe+T,z)))),oe+=T;return j.join("")},stringifyByChar:function(B){for(var Z="",T=0;T<B.length;T++)Z+=String.fromCharCode(B[T]);return Z},applyCanBeUsed:{uint8array:function(){try{return H.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(B){return!1}}(),nodebuffer:function(){try{return H.nodebuffer&&1===String.fromCharCode.apply(null,$.allocBuffer(1)).length}catch(B){return!1}}()}};function G(B){var Z=65536,T=d.getTypeOf(B),j=!0;if("uint8array"===T?j=Y.applyCanBeUsed.uint8array:"nodebuffer"===T&&(j=Y.applyCanBeUsed.nodebuffer),j)for(;1<Z;)try{return Y.stringifyByChunk(B,T,Z)}catch(oe){Z=Math.floor(Z/2)}return Y.stringifyByChar(B)}function D(B,Z){for(var T=0;T<B.length;T++)Z[T]=B[T];return Z}d.applyFromCharCode=G;var W={};W.string={string:O,array:function(B){return E(B,new Array(B.length))},arraybuffer:function(B){return W.string.uint8array(B).buffer},uint8array:function(B){return E(B,new Uint8Array(B.length))},nodebuffer:function(B){return E(B,$.allocBuffer(B.length))}},W.array={string:G,array:O,arraybuffer:function(B){return new Uint8Array(B).buffer},uint8array:function(B){return new Uint8Array(B)},nodebuffer:function(B){return $.newBufferFrom(B)}},W.arraybuffer={string:function(B){return G(new Uint8Array(B))},array:function(B){return D(new Uint8Array(B),new Array(B.byteLength))},arraybuffer:O,uint8array:function(B){return new Uint8Array(B)},nodebuffer:function(B){return $.newBufferFrom(new Uint8Array(B))}},W.uint8array={string:G,array:function(B){return D(B,new Array(B.length))},arraybuffer:function(B){return B.buffer},uint8array:O,nodebuffer:function(B){return $.newBufferFrom(B)}},W.nodebuffer={string:G,array:function(B){return D(B,new Array(B.length))},arraybuffer:function(B){return W.nodebuffer.uint8array(B).buffer},uint8array:function(B){return D(B,new Uint8Array(B.length))},nodebuffer:O},d.transformTo=function(B,Z){if(Z=Z||"",!B)return Z;d.checkSupport(B);var T=d.getTypeOf(Z);return W[T][B](Z)},d.resolve=function(B){for(var Z=B.split("/"),T=[],j=0;j<Z.length;j++){var oe=Z[j];"."===oe||""===oe&&0!==j&&j!==Z.length-1||(".."===oe?T.pop():T.push(oe))}return T.join("/")},d.getTypeOf=function(B){return"string"==typeof B?"string":"[object Array]"===Object.prototype.toString.call(B)?"array":H.nodebuffer&&$.isBuffer(B)?"nodebuffer":H.uint8array&&B instanceof Uint8Array?"uint8array":H.arraybuffer&&B instanceof ArrayBuffer?"arraybuffer":void 0},d.checkSupport=function(B){if(!H[B.toLowerCase()])throw new Error(B+" is not supported by this platform")},d.MAX_VALUE_16BITS=65535,d.MAX_VALUE_32BITS=-1,d.pretty=function(B){var Z,T,j="";for(T=0;T<(B||"").length;T++)j+="\\x"+((Z=B.charCodeAt(T))<16?"0":"")+Z.toString(16).toUpperCase();return j},d.delay=function(B,Z,T){setImmediate(function(){B.apply(T||null,Z||[])})},d.inherits=function(B,Z){function T(){}T.prototype=Z.prototype,B.prototype=new T},d.extend=function(){var B,Z,T={};for(B=0;B<arguments.length;B++)for(Z in arguments[B])Object.prototype.hasOwnProperty.call(arguments[B],Z)&&void 0===T[Z]&&(T[Z]=arguments[B][Z]);return T},d.prepareContent=function(B,Z,T,j,oe){return x.Promise.resolve(Z).then(function(z){return H.blob&&(z instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(z)))&&"undefined"!=typeof FileReader?new x.Promise(function(q,K){var I=new FileReader;I.onload=function(A){q(A.target.result)},I.onerror=function(A){K(A.target.error)},I.readAsArrayBuffer(z)}):z}).then(function(z){var K,q=d.getTypeOf(z);return q?("arraybuffer"===q?z=d.transformTo("uint8array",z):"string"===q&&(oe?z=ee.decode(z):T&&!0!==j&&(z=E(K=z,H.uint8array?new Uint8Array(K.length):new Array(K.length)))),z):x.Promise.reject(new Error("Can't read the data of '"+B+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(le,me,d){"use strict";var H=le("./reader/readerFor"),ee=le("./utils"),$=le("./signature"),x=le("./zipEntry"),O=le("./support");function E(Y){this.files=[],this.loadOptions=Y}E.prototype={checkSignature:function(Y){if(!this.reader.readAndCheckSignature(Y)){this.reader.index-=4;var G=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+ee.pretty(G)+", expected "+ee.pretty(Y)+")")}},isSignature:function(Y,G){var D=this.reader.index;this.reader.setIndex(Y);var W=this.reader.readString(4)===G;return this.reader.setIndex(D),W},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var Y=this.reader.readData(this.zipCommentLength),D=ee.transformTo(O.uint8array?"uint8array":"array",Y);this.zipComment=this.loadOptions.decodeFileName(D)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var Y,G,D,W=this.zip64EndOfCentralSize-44;0<W;)Y=this.reader.readInt(2),G=this.reader.readInt(4),D=this.reader.readData(G),this.zip64ExtensibleData[Y]={id:Y,length:G,value:D}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var Y,G;for(Y=0;Y<this.files.length;Y++)this.reader.setIndex((G=this.files[Y]).localHeaderOffset),this.checkSignature($.LOCAL_FILE_HEADER),G.readLocalPart(this.reader),G.handleUTF8(),G.processAttributes()},readCentralDir:function(){var Y;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature($.CENTRAL_FILE_HEADER);)(Y=new x({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(Y);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var Y=this.reader.lastIndexOfSignature($.CENTRAL_DIRECTORY_END);if(Y<0)throw this.isSignature(0,$.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(Y);var G=Y;if(this.checkSignature($.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===ee.MAX_VALUE_16BITS||this.diskWithCentralDirStart===ee.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===ee.MAX_VALUE_16BITS||this.centralDirRecords===ee.MAX_VALUE_16BITS||this.centralDirSize===ee.MAX_VALUE_32BITS||this.centralDirOffset===ee.MAX_VALUE_32BITS){if(this.zip64=!0,(Y=this.reader.lastIndexOfSignature($.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(Y),this.checkSignature($.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,$.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature($.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature($.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var D=this.centralDirOffset+this.centralDirSize;this.zip64&&(D+=20,D+=12+this.zip64EndOfCentralSize);var W=G-D;if(0<W)this.isSignature(G,$.CENTRAL_FILE_HEADER)||(this.reader.zero=W);else if(W<0)throw new Error("Corrupted zip: missing "+Math.abs(W)+" bytes.")},prepareReader:function(Y){this.reader=H(Y)},load:function(Y){this.prepareReader(Y),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},me.exports=E},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(le,me,d){"use strict";var H=le("./reader/readerFor"),ee=le("./utils"),$=le("./compressedObject"),x=le("./crc32"),O=le("./utf8"),E=le("./compressions"),Y=le("./support");function G(D,W){this.options=D,this.loadOptions=W}G.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(D){var W,B;if(D.skip(22),this.fileNameLength=D.readInt(2),B=D.readInt(2),this.fileName=D.readData(this.fileNameLength),D.skip(B),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(W=function(Z){for(var T in E)if(Object.prototype.hasOwnProperty.call(E,T)&&E[T].magic===Z)return E[T];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+ee.pretty(this.compressionMethod)+" unknown (inner file : "+ee.transformTo("string",this.fileName)+")");this.decompressed=new $(this.compressedSize,this.uncompressedSize,this.crc32,W,D.readData(this.compressedSize))},readCentralPart:function(D){this.versionMadeBy=D.readInt(2),D.skip(2),this.bitFlag=D.readInt(2),this.compressionMethod=D.readString(2),this.date=D.readDate(),this.crc32=D.readInt(4),this.compressedSize=D.readInt(4),this.uncompressedSize=D.readInt(4);var W=D.readInt(2);if(this.extraFieldsLength=D.readInt(2),this.fileCommentLength=D.readInt(2),this.diskNumberStart=D.readInt(2),this.internalFileAttributes=D.readInt(2),this.externalFileAttributes=D.readInt(4),this.localHeaderOffset=D.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");D.skip(W),this.readExtraFields(D),this.parseZIP64ExtraField(D),this.fileComment=D.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var D=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==D&&(this.dosPermissions=63&this.externalFileAttributes),3==D&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var D=H(this.extraFields[1].value);this.uncompressedSize===ee.MAX_VALUE_32BITS&&(this.uncompressedSize=D.readInt(8)),this.compressedSize===ee.MAX_VALUE_32BITS&&(this.compressedSize=D.readInt(8)),this.localHeaderOffset===ee.MAX_VALUE_32BITS&&(this.localHeaderOffset=D.readInt(8)),this.diskNumberStart===ee.MAX_VALUE_32BITS&&(this.diskNumberStart=D.readInt(4))}},readExtraFields:function(D){var W,B,Z,T=D.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});D.index+4<T;)W=D.readInt(2),B=D.readInt(2),Z=D.readData(B),this.extraFields[W]={id:W,length:B,value:Z};D.setIndex(T)},handleUTF8:function(){var D=Y.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=O.utf8decode(this.fileName),this.fileCommentStr=O.utf8decode(this.fileComment);else{var W=this.findExtraFieldUnicodePath();if(null!==W)this.fileNameStr=W;else{var B=ee.transformTo(D,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(B)}var Z=this.findExtraFieldUnicodeComment();if(null!==Z)this.fileCommentStr=Z;else{var T=ee.transformTo(D,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(T)}}},findExtraFieldUnicodePath:function(){var D=this.extraFields[28789];if(D){var W=H(D.value);return 1!==W.readInt(1)||x(this.fileName)!==W.readInt(4)?null:O.utf8decode(W.readData(D.length-5))}return null},findExtraFieldUnicodeComment:function(){var D=this.extraFields[25461];if(D){var W=H(D.value);return 1!==W.readInt(1)||x(this.fileComment)!==W.readInt(4)?null:O.utf8decode(W.readData(D.length-5))}return null}},me.exports=G},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(le,me,d){"use strict";function H(W,B,Z){this.name=W,this.dir=Z.dir,this.date=Z.date,this.comment=Z.comment,this.unixPermissions=Z.unixPermissions,this.dosPermissions=Z.dosPermissions,this._data=B,this._dataBinary=Z.binary,this.options={compression:Z.compression,compressionOptions:Z.compressionOptions}}var ee=le("./stream/StreamHelper"),$=le("./stream/DataWorker"),x=le("./utf8"),O=le("./compressedObject"),E=le("./stream/GenericWorker");H.prototype={internalStream:function(W){var B=null,Z="string";try{if(!W)throw new Error("No output type specified.");var T="string"===(Z=W.toLowerCase())||"text"===Z;"binarystring"!==Z&&"text"!==Z||(Z="string"),B=this._decompressWorker();var j=!this._dataBinary;j&&!T&&(B=B.pipe(new x.Utf8EncodeWorker)),!j&&T&&(B=B.pipe(new x.Utf8DecodeWorker))}catch(oe){(B=new E("error")).error(oe)}return new ee(B,Z,"")},async:function(W,B){return this.internalStream(W).accumulate(B)},nodeStream:function(W,B){return this.internalStream(W||"nodebuffer").toNodejsStream(B)},_compressWorker:function(W,B){if(this._data instanceof O&&this._data.compression.magic===W.magic)return this._data.getCompressedWorker();var Z=this._decompressWorker();return this._dataBinary||(Z=Z.pipe(new x.Utf8EncodeWorker)),O.createWorkerFrom(Z,W,B)},_decompressWorker:function(){return this._data instanceof O?this._data.getContentWorker():this._data instanceof E?this._data:new $(this._data)}};for(var Y=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],G=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},D=0;D<Y.length;D++)H.prototype[Y[D]]=G;me.exports=H},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(le,me,d){(function(H){"use strict";var ee,$,x=H.MutationObserver||H.WebKitMutationObserver;if(x){var O=0,E=new x(W),Y=H.document.createTextNode("");E.observe(Y,{characterData:!0}),ee=function(){Y.data=O=++O%2}}else if(H.setImmediate||void 0===H.MessageChannel)ee="document"in H&&"onreadystatechange"in H.document.createElement("script")?function(){var B=H.document.createElement("script");B.onreadystatechange=function(){W(),B.onreadystatechange=null,B.parentNode.removeChild(B),B=null},H.document.documentElement.appendChild(B)}:function(){setTimeout(W,0)};else{var G=new H.MessageChannel;G.port1.onmessage=W,ee=function(){G.port2.postMessage(0)}}var D=[];function W(){var B,Z;$=!0;for(var T=D.length;T;){for(Z=D,D=[],B=-1;++B<T;)Z[B]();T=D.length}$=!1}me.exports=function(B){1!==D.push(B)||$||ee()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(le,me,d){"use strict";var H=le("immediate");function ee(){}var $={},x=["REJECTED"],O=["FULFILLED"],E=["PENDING"];function Y(T){if("function"!=typeof T)throw new TypeError("resolver must be a function");this.state=E,this.queue=[],this.outcome=void 0,T!==ee&&B(this,T)}function G(T,j,oe){this.promise=T,"function"==typeof j&&(this.onFulfilled=j,this.callFulfilled=this.otherCallFulfilled),"function"==typeof oe&&(this.onRejected=oe,this.callRejected=this.otherCallRejected)}function D(T,j,oe){H(function(){var z;try{z=j(oe)}catch(q){return $.reject(T,q)}z===T?$.reject(T,new TypeError("Cannot resolve promise with itself")):$.resolve(T,z)})}function W(T){var j=T&&T.then;if(T&&("object"==typeof T||"function"==typeof T)&&"function"==typeof j)return function(){j.apply(T,arguments)}}function B(T,j){var oe=!1;function z(I){oe||(oe=!0,$.reject(T,I))}function q(I){oe||(oe=!0,$.resolve(T,I))}var K=Z(function(){j(q,z)});"error"===K.status&&z(K.value)}function Z(T,j){var oe={};try{oe.value=T(j),oe.status="success"}catch(z){oe.status="error",oe.value=z}return oe}(me.exports=Y).prototype.finally=function(T){if("function"!=typeof T)return this;var j=this.constructor;return this.then(function(oe){return j.resolve(T()).then(function(){return oe})},function(oe){return j.resolve(T()).then(function(){throw oe})})},Y.prototype.catch=function(T){return this.then(null,T)},Y.prototype.then=function(T,j){if("function"!=typeof T&&this.state===O||"function"!=typeof j&&this.state===x)return this;var oe=new this.constructor(ee);return this.state!==E?D(oe,this.state===O?T:j,this.outcome):this.queue.push(new G(oe,T,j)),oe},G.prototype.callFulfilled=function(T){$.resolve(this.promise,T)},G.prototype.otherCallFulfilled=function(T){D(this.promise,this.onFulfilled,T)},G.prototype.callRejected=function(T){$.reject(this.promise,T)},G.prototype.otherCallRejected=function(T){D(this.promise,this.onRejected,T)},$.resolve=function(T,j){var oe=Z(W,j);if("error"===oe.status)return $.reject(T,oe.value);var z=oe.value;if(z)B(T,z);else{T.state=O,T.outcome=j;for(var q=-1,K=T.queue.length;++q<K;)T.queue[q].callFulfilled(j)}return T},$.reject=function(T,j){T.state=x,T.outcome=j;for(var oe=-1,z=T.queue.length;++oe<z;)T.queue[oe].callRejected(j);return T},Y.resolve=function(T){return T instanceof this?T:$.resolve(new this(ee),T)},Y.reject=function(T){var j=new this(ee);return $.reject(j,T)},Y.all=function(T){var j=this;if("[object Array]"!==Object.prototype.toString.call(T))return this.reject(new TypeError("must be an array"));var oe=T.length,z=!1;if(!oe)return this.resolve([]);for(var q=new Array(oe),K=0,I=-1,A=new this(ee);++I<oe;)J(T[I],I);return A;function J(L,S){j.resolve(L).then(function(M){q[S]=M,++K!==oe||z||(z=!0,$.resolve(A,q))},function(M){z||(z=!0,$.reject(A,M))})}},Y.race=function(T){if("[object Array]"!==Object.prototype.toString.call(T))return this.reject(new TypeError("must be an array"));var oe=T.length,z=!1;if(!oe)return this.resolve([]);for(var q=-1,K=new this(ee);++q<oe;)this.resolve(T[q]).then(function(A){z||(z=!0,$.resolve(K,A))},function(A){z||(z=!0,$.reject(K,A))});return K}},{immediate:36}],38:[function(le,me,d){"use strict";var H={};(0,le("./lib/utils/common").assign)(H,le("./lib/deflate"),le("./lib/inflate"),le("./lib/zlib/constants")),me.exports=H},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(le,me,d){"use strict";var H=le("./zlib/deflate"),ee=le("./utils/common"),$=le("./utils/strings"),x=le("./zlib/messages"),O=le("./zlib/zstream"),E=Object.prototype.toString;function B(T){if(!(this instanceof B))return new B(T);this.options=ee.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},T||{});var j=this.options;j.raw&&0<j.windowBits?j.windowBits=-j.windowBits:j.gzip&&0<j.windowBits&&j.windowBits<16&&(j.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new O,this.strm.avail_out=0;var oe=H.deflateInit2(this.strm,j.level,j.method,j.windowBits,j.memLevel,j.strategy);if(0!==oe)throw new Error(x[oe]);if(j.header&&H.deflateSetHeader(this.strm,j.header),j.dictionary){var z;if(z="string"==typeof j.dictionary?$.string2buf(j.dictionary):"[object ArrayBuffer]"===E.call(j.dictionary)?new Uint8Array(j.dictionary):j.dictionary,0!==(oe=H.deflateSetDictionary(this.strm,z)))throw new Error(x[oe]);this._dict_set=!0}}function Z(T,j){var oe=new B(j);if(oe.push(T,!0),oe.err)throw oe.msg||x[oe.err];return oe.result}B.prototype.push=function(T,j){var oe,z,q=this.strm,K=this.options.chunkSize;if(this.ended)return!1;z=j===~~j?j:!0===j?4:0,q.input="string"==typeof T?$.string2buf(T):"[object ArrayBuffer]"===E.call(T)?new Uint8Array(T):T,q.next_in=0,q.avail_in=q.input.length;do{if(0===q.avail_out&&(q.output=new ee.Buf8(K),q.next_out=0,q.avail_out=K),1!==(oe=H.deflate(q,z))&&0!==oe)return this.onEnd(oe),!(this.ended=!0);0!==q.avail_out&&(0!==q.avail_in||4!==z&&2!==z)||this.onData("string"===this.options.to?$.buf2binstring(ee.shrinkBuf(q.output,q.next_out)):ee.shrinkBuf(q.output,q.next_out))}while((0<q.avail_in||0===q.avail_out)&&1!==oe);return 4===z?(oe=H.deflateEnd(this.strm),this.onEnd(oe),this.ended=!0,0===oe):2!==z||(this.onEnd(0),!(q.avail_out=0))},B.prototype.onData=function(T){this.chunks.push(T)},B.prototype.onEnd=function(T){0===T&&(this.result="string"===this.options.to?this.chunks.join(""):ee.flattenChunks(this.chunks)),this.chunks=[],this.err=T,this.msg=this.strm.msg},d.Deflate=B,d.deflate=Z,d.deflateRaw=function(T,j){return(j=j||{}).raw=!0,Z(T,j)},d.gzip=function(T,j){return(j=j||{}).gzip=!0,Z(T,j)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(le,me,d){"use strict";var H=le("./zlib/inflate"),ee=le("./utils/common"),$=le("./utils/strings"),x=le("./zlib/constants"),O=le("./zlib/messages"),E=le("./zlib/zstream"),Y=le("./zlib/gzheader"),G=Object.prototype.toString;function D(B){if(!(this instanceof D))return new D(B);this.options=ee.assign({chunkSize:16384,windowBits:0,to:""},B||{});var Z=this.options;Z.raw&&0<=Z.windowBits&&Z.windowBits<16&&(Z.windowBits=-Z.windowBits,0===Z.windowBits&&(Z.windowBits=-15)),!(0<=Z.windowBits&&Z.windowBits<16)||B&&B.windowBits||(Z.windowBits+=32),15<Z.windowBits&&Z.windowBits<48&&0==(15&Z.windowBits)&&(Z.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new E,this.strm.avail_out=0;var T=H.inflateInit2(this.strm,Z.windowBits);if(T!==x.Z_OK)throw new Error(O[T]);this.header=new Y,H.inflateGetHeader(this.strm,this.header)}function W(B,Z){var T=new D(Z);if(T.push(B,!0),T.err)throw T.msg||O[T.err];return T.result}D.prototype.push=function(B,Z){var T,j,oe,z,q,K,I=this.strm,A=this.options.chunkSize,J=this.options.dictionary,L=!1;if(this.ended)return!1;j=Z===~~Z?Z:!0===Z?x.Z_FINISH:x.Z_NO_FLUSH,I.input="string"==typeof B?$.binstring2buf(B):"[object ArrayBuffer]"===G.call(B)?new Uint8Array(B):B,I.next_in=0,I.avail_in=I.input.length;do{if(0===I.avail_out&&(I.output=new ee.Buf8(A),I.next_out=0,I.avail_out=A),(T=H.inflate(I,x.Z_NO_FLUSH))===x.Z_NEED_DICT&&J&&(K="string"==typeof J?$.string2buf(J):"[object ArrayBuffer]"===G.call(J)?new Uint8Array(J):J,T=H.inflateSetDictionary(this.strm,K)),T===x.Z_BUF_ERROR&&!0===L&&(T=x.Z_OK,L=!1),T!==x.Z_STREAM_END&&T!==x.Z_OK)return this.onEnd(T),!(this.ended=!0);I.next_out&&(0!==I.avail_out&&T!==x.Z_STREAM_END&&(0!==I.avail_in||j!==x.Z_FINISH&&j!==x.Z_SYNC_FLUSH)||("string"===this.options.to?(oe=$.utf8border(I.output,I.next_out),z=I.next_out-oe,q=$.buf2string(I.output,oe),I.next_out=z,I.avail_out=A-z,z&&ee.arraySet(I.output,I.output,oe,z,0),this.onData(q)):this.onData(ee.shrinkBuf(I.output,I.next_out)))),0===I.avail_in&&0===I.avail_out&&(L=!0)}while((0<I.avail_in||0===I.avail_out)&&T!==x.Z_STREAM_END);return T===x.Z_STREAM_END&&(j=x.Z_FINISH),j===x.Z_FINISH?(T=H.inflateEnd(this.strm),this.onEnd(T),this.ended=!0,T===x.Z_OK):j!==x.Z_SYNC_FLUSH||(this.onEnd(x.Z_OK),!(I.avail_out=0))},D.prototype.onData=function(B){this.chunks.push(B)},D.prototype.onEnd=function(B){B===x.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):ee.flattenChunks(this.chunks)),this.chunks=[],this.err=B,this.msg=this.strm.msg},d.Inflate=D,d.inflate=W,d.inflateRaw=function(B,Z){return(Z=Z||{}).raw=!0,W(B,Z)},d.ungzip=W},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(le,me,d){"use strict";var H="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;d.assign=function(x){for(var O=Array.prototype.slice.call(arguments,1);O.length;){var E=O.shift();if(E){if("object"!=typeof E)throw new TypeError(E+"must be non-object");for(var Y in E)E.hasOwnProperty(Y)&&(x[Y]=E[Y])}}return x},d.shrinkBuf=function(x,O){return x.length===O?x:x.subarray?x.subarray(0,O):(x.length=O,x)};var ee={arraySet:function(x,O,E,Y,G){if(O.subarray&&x.subarray)x.set(O.subarray(E,E+Y),G);else for(var D=0;D<Y;D++)x[G+D]=O[E+D]},flattenChunks:function(x){var O,E,Y,G,D,W;for(O=Y=0,E=x.length;O<E;O++)Y+=x[O].length;for(W=new Uint8Array(Y),O=G=0,E=x.length;O<E;O++)W.set(D=x[O],G),G+=D.length;return W}},$={arraySet:function(x,O,E,Y,G){for(var D=0;D<Y;D++)x[G+D]=O[E+D]},flattenChunks:function(x){return[].concat.apply([],x)}};d.setTyped=function(x){x?(d.Buf8=Uint8Array,d.Buf16=Uint16Array,d.Buf32=Int32Array,d.assign(d,ee)):(d.Buf8=Array,d.Buf16=Array,d.Buf32=Array,d.assign(d,$))},d.setTyped(H)},{}],42:[function(le,me,d){"use strict";var H=le("./common"),ee=!0,$=!0;try{String.fromCharCode.apply(null,[0])}catch(Y){ee=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(Y){$=!1}for(var x=new H.Buf8(256),O=0;O<256;O++)x[O]=252<=O?6:248<=O?5:240<=O?4:224<=O?3:192<=O?2:1;function E(Y,G){if(G<65537&&(Y.subarray&&$||!Y.subarray&&ee))return String.fromCharCode.apply(null,H.shrinkBuf(Y,G));for(var D="",W=0;W<G;W++)D+=String.fromCharCode(Y[W]);return D}x[254]=x[254]=1,d.string2buf=function(Y){var G,D,W,B,Z,T=Y.length,j=0;for(B=0;B<T;B++)55296==(64512&(D=Y.charCodeAt(B)))&&B+1<T&&56320==(64512&(W=Y.charCodeAt(B+1)))&&(D=65536+(D-55296<<10)+(W-56320),B++),j+=D<128?1:D<2048?2:D<65536?3:4;for(G=new H.Buf8(j),B=Z=0;Z<j;B++)55296==(64512&(D=Y.charCodeAt(B)))&&B+1<T&&56320==(64512&(W=Y.charCodeAt(B+1)))&&(D=65536+(D-55296<<10)+(W-56320),B++),D<128?G[Z++]=D:(D<2048?G[Z++]=192|D>>>6:(D<65536?G[Z++]=224|D>>>12:(G[Z++]=240|D>>>18,G[Z++]=128|D>>>12&63),G[Z++]=128|D>>>6&63),G[Z++]=128|63&D);return G},d.buf2binstring=function(Y){return E(Y,Y.length)},d.binstring2buf=function(Y){for(var G=new H.Buf8(Y.length),D=0,W=G.length;D<W;D++)G[D]=Y.charCodeAt(D);return G},d.buf2string=function(Y,G){var D,W,B,Z,T=G||Y.length,j=new Array(2*T);for(D=W=0;D<T;)if((B=Y[D++])<128)j[W++]=B;else if(4<(Z=x[B]))j[W++]=65533,D+=Z-1;else{for(B&=2===Z?31:3===Z?15:7;1<Z&&D<T;)B=B<<6|63&Y[D++],Z--;1<Z?j[W++]=65533:B<65536?j[W++]=B:(j[W++]=55296|(B-=65536)>>10&1023,j[W++]=56320|1023&B)}return E(j,W)},d.utf8border=function(Y,G){var D;for((G=G||Y.length)>Y.length&&(G=Y.length),D=G-1;0<=D&&128==(192&Y[D]);)D--;return D<0||0===D?G:D+x[Y[D]]>G?D:G}},{"./common":41}],43:[function(le,me,d){"use strict";me.exports=function(H,ee,$,x){for(var O=65535&H|0,E=H>>>16&65535|0,Y=0;0!==$;){for($-=Y=2e3<$?2e3:$;E=E+(O=O+ee[x++]|0)|0,--Y;);O%=65521,E%=65521}return O|E<<16|0}},{}],44:[function(le,me,d){"use strict";me.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(le,me,d){"use strict";var H=function(){for(var ee,$=[],x=0;x<256;x++){ee=x;for(var O=0;O<8;O++)ee=1&ee?3988292384^ee>>>1:ee>>>1;$[x]=ee}return $}();me.exports=function(ee,$,x,O){var E=H,Y=O+x;ee^=-1;for(var G=O;G<Y;G++)ee=ee>>>8^E[255&(ee^$[G])];return-1^ee}},{}],46:[function(le,me,d){"use strict";var H,ee=le("../utils/common"),$=le("./trees"),x=le("./adler32"),O=le("./crc32"),E=le("./messages"),W=-2,L=258,S=262,v=113;function de(ce,Me){return ce.msg=E[Me],Me}function N(ce){return(ce<<1)-(4<ce?9:0)}function F(ce){for(var Me=ce.length;0<=--Me;)ce[Me]=0}function g(ce){var Me=ce.state,$e=Me.pending;$e>ce.avail_out&&($e=ce.avail_out),0!==$e&&(ee.arraySet(ce.output,Me.pending_buf,Me.pending_out,$e,ce.next_out),ce.next_out+=$e,Me.pending_out+=$e,ce.total_out+=$e,ce.avail_out-=$e,Me.pending-=$e,0===Me.pending&&(Me.pending_out=0))}function l(ce,Me){$._tr_flush_block(ce,0<=ce.block_start?ce.block_start:-1,ce.strstart-ce.block_start,Me),ce.block_start=ce.strstart,g(ce.strm)}function c(ce,Me){ce.pending_buf[ce.pending++]=Me}function f(ce,Me){ce.pending_buf[ce.pending++]=Me>>>8&255,ce.pending_buf[ce.pending++]=255&Me}function u(ce,Me){var $e,be,he=ce.max_chain_length,Se=ce.strstart,ve=ce.prev_length,ae=ce.nice_match,ue=ce.strstart>ce.w_size-S?ce.strstart-(ce.w_size-S):0,Ce=ce.window,b=ce.w_mask,V=ce.prev,ge=ce.strstart+L,xe=Ce[Se+ve-1],De=Ce[Se+ve];ce.prev_length>=ce.good_match&&(he>>=2),ae>ce.lookahead&&(ae=ce.lookahead);do{if(Ce[($e=Me)+ve]===De&&Ce[$e+ve-1]===xe&&Ce[$e]===Ce[Se]&&Ce[++$e]===Ce[Se+1]){Se+=2,$e++;do{}while(Ce[++Se]===Ce[++$e]&&Ce[++Se]===Ce[++$e]&&Ce[++Se]===Ce[++$e]&&Ce[++Se]===Ce[++$e]&&Ce[++Se]===Ce[++$e]&&Ce[++Se]===Ce[++$e]&&Ce[++Se]===Ce[++$e]&&Ce[++Se]===Ce[++$e]&&Se<ge);if(be=L-(ge-Se),Se=ge-L,ve<be){if(ce.match_start=Me,ae<=(ve=be))break;xe=Ce[Se+ve-1],De=Ce[Se+ve]}}}while((Me=V[Me&b])>ue&&0!=--he);return ve<=ce.lookahead?ve:ce.lookahead}function p(ce){var Me,$e,be,he,Se,ve,ae,ue,Ce,b,V=ce.w_size;do{if(he=ce.window_size-ce.lookahead-ce.strstart,ce.strstart>=V+(V-S)){for(ee.arraySet(ce.window,ce.window,V,V,0),ce.match_start-=V,ce.strstart-=V,ce.block_start-=V,Me=$e=ce.hash_size;be=ce.head[--Me],ce.head[Me]=V<=be?be-V:0,--$e;);for(Me=$e=V;be=ce.prev[--Me],ce.prev[Me]=V<=be?be-V:0,--$e;);he+=V}if(0===ce.strm.avail_in)break;if(ae=ce.window,ue=ce.strstart+ce.lookahead,b=void 0,(Ce=he)<(b=(ve=ce.strm).avail_in)&&(b=Ce),$e=0===b?0:(ve.avail_in-=b,ee.arraySet(ae,ve.input,ve.next_in,b,ue),1===ve.state.wrap?ve.adler=x(ve.adler,ae,b,ue):2===ve.state.wrap&&(ve.adler=O(ve.adler,ae,b,ue)),ve.next_in+=b,ve.total_in+=b,b),ce.lookahead+=$e,ce.lookahead+ce.insert>=3)for(ce.ins_h=ce.window[Se=ce.strstart-ce.insert],ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[Se+1])&ce.hash_mask;ce.insert&&(ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[Se+3-1])&ce.hash_mask,ce.prev[Se&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=Se,Se++,ce.insert--,!(ce.lookahead+ce.insert<3)););}while(ce.lookahead<S&&0!==ce.strm.avail_in)}function _(ce,Me){for(var $e,be;;){if(ce.lookahead<S){if(p(ce),ce.lookahead<S&&0===Me)return 1;if(0===ce.lookahead)break}if($e=0,ce.lookahead>=3&&(ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[ce.strstart+3-1])&ce.hash_mask,$e=ce.prev[ce.strstart&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=ce.strstart),0!==$e&&ce.strstart-$e<=ce.w_size-S&&(ce.match_length=u(ce,$e)),ce.match_length>=3)if(be=$._tr_tally(ce,ce.strstart-ce.match_start,ce.match_length-3),ce.lookahead-=ce.match_length,ce.match_length<=ce.max_lazy_match&&ce.lookahead>=3){for(ce.match_length--;ce.strstart++,ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[ce.strstart+3-1])&ce.hash_mask,$e=ce.prev[ce.strstart&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=ce.strstart,0!=--ce.match_length;);ce.strstart++}else ce.strstart+=ce.match_length,ce.match_length=0,ce.ins_h=ce.window[ce.strstart],ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[ce.strstart+1])&ce.hash_mask;else be=$._tr_tally(ce,0,ce.window[ce.strstart]),ce.lookahead--,ce.strstart++;if(be&&(l(ce,!1),0===ce.strm.avail_out))return 1}return ce.insert=ce.strstart<2?ce.strstart:2,4===Me?(l(ce,!0),0===ce.strm.avail_out?3:4):ce.last_lit&&(l(ce,!1),0===ce.strm.avail_out)?1:2}function y(ce,Me){for(var $e,be,he;;){if(ce.lookahead<S){if(p(ce),ce.lookahead<S&&0===Me)return 1;if(0===ce.lookahead)break}if($e=0,ce.lookahead>=3&&(ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[ce.strstart+3-1])&ce.hash_mask,$e=ce.prev[ce.strstart&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=ce.strstart),ce.prev_length=ce.match_length,ce.prev_match=ce.match_start,ce.match_length=2,0!==$e&&ce.prev_length<ce.max_lazy_match&&ce.strstart-$e<=ce.w_size-S&&(ce.match_length=u(ce,$e),ce.match_length<=5&&(1===ce.strategy||3===ce.match_length&&4096<ce.strstart-ce.match_start)&&(ce.match_length=2)),ce.prev_length>=3&&ce.match_length<=ce.prev_length){for(he=ce.strstart+ce.lookahead-3,be=$._tr_tally(ce,ce.strstart-1-ce.prev_match,ce.prev_length-3),ce.lookahead-=ce.prev_length-1,ce.prev_length-=2;++ce.strstart<=he&&(ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[ce.strstart+3-1])&ce.hash_mask,$e=ce.prev[ce.strstart&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=ce.strstart),0!=--ce.prev_length;);if(ce.match_available=0,ce.match_length=2,ce.strstart++,be&&(l(ce,!1),0===ce.strm.avail_out))return 1}else if(ce.match_available){if((be=$._tr_tally(ce,0,ce.window[ce.strstart-1]))&&l(ce,!1),ce.strstart++,ce.lookahead--,0===ce.strm.avail_out)return 1}else ce.match_available=1,ce.strstart++,ce.lookahead--}return ce.match_available&&(be=$._tr_tally(ce,0,ce.window[ce.strstart-1]),ce.match_available=0),ce.insert=ce.strstart<2?ce.strstart:2,4===Me?(l(ce,!0),0===ce.strm.avail_out?3:4):ce.last_lit&&(l(ce,!1),0===ce.strm.avail_out)?1:2}function m(ce,Me,$e,be,he){this.good_length=ce,this.max_lazy=Me,this.nice_length=$e,this.max_chain=be,this.func=he}function ne(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new ee.Buf16(1146),this.dyn_dtree=new ee.Buf16(122),this.bl_tree=new ee.Buf16(78),F(this.dyn_ltree),F(this.dyn_dtree),F(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new ee.Buf16(16),this.heap=new ee.Buf16(573),F(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new ee.Buf16(573),F(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function se(ce){var Me;return ce&&ce.state?(ce.total_in=ce.total_out=0,ce.data_type=2,(Me=ce.state).pending=0,Me.pending_out=0,Me.wrap<0&&(Me.wrap=-Me.wrap),Me.status=Me.wrap?42:v,ce.adler=2===Me.wrap?0:1,Me.last_flush=0,$._tr_init(Me),0):de(ce,W)}function Ee(ce){var $e,Me=se(ce);return 0===Me&&(($e=ce.state).window_size=2*$e.w_size,F($e.head),$e.max_lazy_match=H[$e.level].max_lazy,$e.good_match=H[$e.level].good_length,$e.nice_match=H[$e.level].nice_length,$e.max_chain_length=H[$e.level].max_chain,$e.strstart=0,$e.block_start=0,$e.lookahead=0,$e.insert=0,$e.match_length=$e.prev_length=2,$e.match_available=0,$e.ins_h=0),Me}function ke(ce,Me,$e,be,he,Se){if(!ce)return W;var ve=1;if(-1===Me&&(Me=6),be<0?(ve=0,be=-be):15<be&&(ve=2,be-=16),he<1||9<he||8!==$e||be<8||15<be||Me<0||9<Me||Se<0||4<Se)return de(ce,W);8===be&&(be=9);var ae=new ne;return(ce.state=ae).strm=ce,ae.wrap=ve,ae.gzhead=null,ae.w_bits=be,ae.w_size=1<<ae.w_bits,ae.w_mask=ae.w_size-1,ae.hash_bits=he+7,ae.hash_size=1<<ae.hash_bits,ae.hash_mask=ae.hash_size-1,ae.hash_shift=~~((ae.hash_bits+3-1)/3),ae.window=new ee.Buf8(2*ae.w_size),ae.head=new ee.Buf16(ae.hash_size),ae.prev=new ee.Buf16(ae.w_size),ae.lit_bufsize=1<<he+6,ae.pending_buf_size=4*ae.lit_bufsize,ae.pending_buf=new ee.Buf8(ae.pending_buf_size),ae.d_buf=1*ae.lit_bufsize,ae.l_buf=3*ae.lit_bufsize,ae.level=Me,ae.strategy=Se,ae.method=$e,Ee(ce)}H=[new m(0,0,0,0,function(ce,Me){var $e=65535;for($e>ce.pending_buf_size-5&&($e=ce.pending_buf_size-5);;){if(ce.lookahead<=1){if(p(ce),0===ce.lookahead&&0===Me)return 1;if(0===ce.lookahead)break}ce.strstart+=ce.lookahead,ce.lookahead=0;var be=ce.block_start+$e;if((0===ce.strstart||ce.strstart>=be)&&(ce.lookahead=ce.strstart-be,ce.strstart=be,l(ce,!1),0===ce.strm.avail_out)||ce.strstart-ce.block_start>=ce.w_size-S&&(l(ce,!1),0===ce.strm.avail_out))return 1}return ce.insert=0,4===Me?(l(ce,!0),0===ce.strm.avail_out?3:4):(ce.strstart>ce.block_start&&l(ce,!1),1)}),new m(4,4,8,4,_),new m(4,5,16,8,_),new m(4,6,32,32,_),new m(4,4,16,16,y),new m(8,16,32,32,y),new m(8,16,128,128,y),new m(8,32,128,256,y),new m(32,128,258,1024,y),new m(32,258,258,4096,y)],d.deflateInit=function(ce,Me){return ke(ce,Me,8,15,8,0)},d.deflateInit2=ke,d.deflateReset=Ee,d.deflateResetKeep=se,d.deflateSetHeader=function(ce,Me){return ce&&ce.state?2!==ce.state.wrap?W:(ce.state.gzhead=Me,0):W},d.deflate=function(ce,Me){var $e,be,he,Se;if(!ce||!ce.state||5<Me||Me<0)return ce?de(ce,W):W;if(be=ce.state,!ce.output||!ce.input&&0!==ce.avail_in||666===be.status&&4!==Me)return de(ce,0===ce.avail_out?-5:W);if(be.strm=ce,$e=be.last_flush,be.last_flush=Me,42===be.status)if(2===be.wrap)ce.adler=0,c(be,31),c(be,139),c(be,8),be.gzhead?(c(be,(be.gzhead.text?1:0)+(be.gzhead.hcrc?2:0)+(be.gzhead.extra?4:0)+(be.gzhead.name?8:0)+(be.gzhead.comment?16:0)),c(be,255&be.gzhead.time),c(be,be.gzhead.time>>8&255),c(be,be.gzhead.time>>16&255),c(be,be.gzhead.time>>24&255),c(be,9===be.level?2:2<=be.strategy||be.level<2?4:0),c(be,255&be.gzhead.os),be.gzhead.extra&&be.gzhead.extra.length&&(c(be,255&be.gzhead.extra.length),c(be,be.gzhead.extra.length>>8&255)),be.gzhead.hcrc&&(ce.adler=O(ce.adler,be.pending_buf,be.pending,0)),be.gzindex=0,be.status=69):(c(be,0),c(be,0),c(be,0),c(be,0),c(be,0),c(be,9===be.level?2:2<=be.strategy||be.level<2?4:0),c(be,3),be.status=v);else{var ve=8+(be.w_bits-8<<4)<<8;ve|=(2<=be.strategy||be.level<2?0:be.level<6?1:6===be.level?2:3)<<6,0!==be.strstart&&(ve|=32),ve+=31-ve%31,be.status=v,f(be,ve),0!==be.strstart&&(f(be,ce.adler>>>16),f(be,65535&ce.adler)),ce.adler=1}if(69===be.status)if(be.gzhead.extra){for(he=be.pending;be.gzindex<(65535&be.gzhead.extra.length)&&(be.pending!==be.pending_buf_size||(be.gzhead.hcrc&&be.pending>he&&(ce.adler=O(ce.adler,be.pending_buf,be.pending-he,he)),g(ce),he=be.pending,be.pending!==be.pending_buf_size));)c(be,255&be.gzhead.extra[be.gzindex]),be.gzindex++;be.gzhead.hcrc&&be.pending>he&&(ce.adler=O(ce.adler,be.pending_buf,be.pending-he,he)),be.gzindex===be.gzhead.extra.length&&(be.gzindex=0,be.status=73)}else be.status=73;if(73===be.status)if(be.gzhead.name){he=be.pending;do{if(be.pending===be.pending_buf_size&&(be.gzhead.hcrc&&be.pending>he&&(ce.adler=O(ce.adler,be.pending_buf,be.pending-he,he)),g(ce),he=be.pending,be.pending===be.pending_buf_size)){Se=1;break}Se=be.gzindex<be.gzhead.name.length?255&be.gzhead.name.charCodeAt(be.gzindex++):0,c(be,Se)}while(0!==Se);be.gzhead.hcrc&&be.pending>he&&(ce.adler=O(ce.adler,be.pending_buf,be.pending-he,he)),0===Se&&(be.gzindex=0,be.status=91)}else be.status=91;if(91===be.status)if(be.gzhead.comment){he=be.pending;do{if(be.pending===be.pending_buf_size&&(be.gzhead.hcrc&&be.pending>he&&(ce.adler=O(ce.adler,be.pending_buf,be.pending-he,he)),g(ce),he=be.pending,be.pending===be.pending_buf_size)){Se=1;break}Se=be.gzindex<be.gzhead.comment.length?255&be.gzhead.comment.charCodeAt(be.gzindex++):0,c(be,Se)}while(0!==Se);be.gzhead.hcrc&&be.pending>he&&(ce.adler=O(ce.adler,be.pending_buf,be.pending-he,he)),0===Se&&(be.status=103)}else be.status=103;if(103===be.status&&(be.gzhead.hcrc?(be.pending+2>be.pending_buf_size&&g(ce),be.pending+2<=be.pending_buf_size&&(c(be,255&ce.adler),c(be,ce.adler>>8&255),ce.adler=0,be.status=v)):be.status=v),0!==be.pending){if(g(ce),0===ce.avail_out)return be.last_flush=-1,0}else if(0===ce.avail_in&&N(Me)<=N($e)&&4!==Me)return de(ce,-5);if(666===be.status&&0!==ce.avail_in)return de(ce,-5);if(0!==ce.avail_in||0!==be.lookahead||0!==Me&&666!==be.status){var ae=2===be.strategy?function(ue,Ce){for(var b;;){if(0===ue.lookahead&&(p(ue),0===ue.lookahead)){if(0===Ce)return 1;break}if(ue.match_length=0,b=$._tr_tally(ue,0,ue.window[ue.strstart]),ue.lookahead--,ue.strstart++,b&&(l(ue,!1),0===ue.strm.avail_out))return 1}return ue.insert=0,4===Ce?(l(ue,!0),0===ue.strm.avail_out?3:4):ue.last_lit&&(l(ue,!1),0===ue.strm.avail_out)?1:2}(be,Me):3===be.strategy?function(ue,Ce){for(var b,V,ge,xe,De=ue.window;;){if(ue.lookahead<=L){if(p(ue),ue.lookahead<=L&&0===Ce)return 1;if(0===ue.lookahead)break}if(ue.match_length=0,ue.lookahead>=3&&0<ue.strstart&&(V=De[ge=ue.strstart-1])===De[++ge]&&V===De[++ge]&&V===De[++ge]){xe=ue.strstart+L;do{}while(V===De[++ge]&&V===De[++ge]&&V===De[++ge]&&V===De[++ge]&&V===De[++ge]&&V===De[++ge]&&V===De[++ge]&&V===De[++ge]&&ge<xe);ue.match_length=L-(xe-ge),ue.match_length>ue.lookahead&&(ue.match_length=ue.lookahead)}if(ue.match_length>=3?(b=$._tr_tally(ue,1,ue.match_length-3),ue.lookahead-=ue.match_length,ue.strstart+=ue.match_length,ue.match_length=0):(b=$._tr_tally(ue,0,ue.window[ue.strstart]),ue.lookahead--,ue.strstart++),b&&(l(ue,!1),0===ue.strm.avail_out))return 1}return ue.insert=0,4===Ce?(l(ue,!0),0===ue.strm.avail_out?3:4):ue.last_lit&&(l(ue,!1),0===ue.strm.avail_out)?1:2}(be,Me):H[be.level].func(be,Me);if(3!==ae&&4!==ae||(be.status=666),1===ae||3===ae)return 0===ce.avail_out&&(be.last_flush=-1),0;if(2===ae&&(1===Me?$._tr_align(be):5!==Me&&($._tr_stored_block(be,0,0,!1),3===Me&&(F(be.head),0===be.lookahead&&(be.strstart=0,be.block_start=0,be.insert=0))),g(ce),0===ce.avail_out))return be.last_flush=-1,0}return 4!==Me?0:be.wrap<=0?1:(2===be.wrap?(c(be,255&ce.adler),c(be,ce.adler>>8&255),c(be,ce.adler>>16&255),c(be,ce.adler>>24&255),c(be,255&ce.total_in),c(be,ce.total_in>>8&255),c(be,ce.total_in>>16&255),c(be,ce.total_in>>24&255)):(f(be,ce.adler>>>16),f(be,65535&ce.adler)),g(ce),0<be.wrap&&(be.wrap=-be.wrap),0!==be.pending?0:1)},d.deflateEnd=function(ce){var Me;return ce&&ce.state?42!==(Me=ce.state.status)&&69!==Me&&73!==Me&&91!==Me&&103!==Me&&Me!==v&&666!==Me?de(ce,W):(ce.state=null,Me===v?de(ce,-3):0):W},d.deflateSetDictionary=function(ce,Me){var $e,be,he,Se,ve,ae,ue,Ce,b=Me.length;if(!ce||!ce.state||2===(Se=($e=ce.state).wrap)||1===Se&&42!==$e.status||$e.lookahead)return W;for(1===Se&&(ce.adler=x(ce.adler,Me,b,0)),$e.wrap=0,b>=$e.w_size&&(0===Se&&(F($e.head),$e.strstart=0,$e.block_start=0,$e.insert=0),Ce=new ee.Buf8($e.w_size),ee.arraySet(Ce,Me,b-$e.w_size,$e.w_size,0),Me=Ce,b=$e.w_size),ve=ce.avail_in,ae=ce.next_in,ue=ce.input,ce.avail_in=b,ce.next_in=0,ce.input=Me,p($e);$e.lookahead>=3;){for(be=$e.strstart,he=$e.lookahead-2;$e.ins_h=($e.ins_h<<$e.hash_shift^$e.window[be+3-1])&$e.hash_mask,$e.prev[be&$e.w_mask]=$e.head[$e.ins_h],$e.head[$e.ins_h]=be,be++,--he;);$e.strstart=be,$e.lookahead=2,p($e)}return $e.strstart+=$e.lookahead,$e.block_start=$e.strstart,$e.insert=$e.lookahead,$e.lookahead=0,$e.match_length=$e.prev_length=2,$e.match_available=0,ce.next_in=ae,ce.input=ue,ce.avail_in=ve,$e.wrap=Se,0},d.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(le,me,d){"use strict";me.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(le,me,d){"use strict";me.exports=function(H,ee){var $,x,O,E,Y,G,D,W,B,Z,T,j,oe,z,q,K,I,A,J,L,S,M,v,P,R;P=H.input,O=(x=H.next_in)+(H.avail_in-5),R=H.output,Y=(E=H.next_out)-(ee-H.avail_out),G=E+(H.avail_out-257),D=($=H.state).dmax,W=$.wsize,B=$.whave,Z=$.wnext,T=$.window,j=$.hold,oe=$.bits,z=$.lencode,q=$.distcode,K=(1<<$.lenbits)-1,I=(1<<$.distbits)-1;e:do{oe<15&&(j+=P[x++]<<oe,j+=P[x++]<<(oe+=8),oe+=8),A=z[j&K];t:for(;;){if(j>>>=J=A>>>24,oe-=J,0==(J=A>>>16&255))R[E++]=65535&A;else{if(!(16&J)){if(0==(64&J)){A=z[(65535&A)+(j&(1<<J)-1)];continue t}if(32&J){$.mode=12;break e}H.msg="invalid literal/length code",$.mode=30;break e}L=65535&A,(J&=15)&&(oe<J&&(j+=P[x++]<<oe,oe+=8),L+=j&(1<<J)-1,j>>>=J,oe-=J),oe<15&&(j+=P[x++]<<oe,j+=P[x++]<<(oe+=8),oe+=8),A=q[j&I];n:for(;;){if(j>>>=J=A>>>24,oe-=J,!(16&(J=A>>>16&255))){if(0==(64&J)){A=q[(65535&A)+(j&(1<<J)-1)];continue n}H.msg="invalid distance code",$.mode=30;break e}if(S=65535&A,oe<(J&=15)&&(j+=P[x++]<<oe,(oe+=8)<J&&(j+=P[x++]<<oe,oe+=8)),D<(S+=j&(1<<J)-1)){H.msg="invalid distance too far back",$.mode=30;break e}if(j>>>=J,oe-=J,(J=E-Y)<S){if(B<(J=S-J)&&$.sane){H.msg="invalid distance too far back",$.mode=30;break e}if(v=T,(M=0)===Z){if(M+=W-J,J<L){for(L-=J;R[E++]=T[M++],--J;);M=E-S,v=R}}else if(Z<J){if(M+=W+Z-J,(J-=Z)<L){for(L-=J;R[E++]=T[M++],--J;);if(M=0,Z<L){for(L-=J=Z;R[E++]=T[M++],--J;);M=E-S,v=R}}}else if(M+=Z-J,J<L){for(L-=J;R[E++]=T[M++],--J;);M=E-S,v=R}for(;2<L;)R[E++]=v[M++],R[E++]=v[M++],R[E++]=v[M++],L-=3;L&&(R[E++]=v[M++],1<L&&(R[E++]=v[M++]))}else{for(M=E-S;R[E++]=R[M++],R[E++]=R[M++],R[E++]=R[M++],2<(L-=3););L&&(R[E++]=R[M++],1<L&&(R[E++]=R[M++]))}break}}break}}while(x<O&&E<G);x-=L=oe>>3,j&=(1<<(oe-=L<<3))-1,H.next_in=x,H.next_out=E,H.avail_in=x<O?O-x+5:5-(x-O),H.avail_out=E<G?G-E+257:257-(E-G),$.hold=j,$.bits=oe}},{}],49:[function(le,me,d){"use strict";var H=le("../utils/common"),ee=le("./adler32"),$=le("./crc32"),x=le("./inffast"),O=le("./inftrees"),D=-2;function T(M){return(M>>>24&255)+(M>>>8&65280)+((65280&M)<<8)+((255&M)<<24)}function j(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new H.Buf16(320),this.work=new H.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function oe(M){var v;return M&&M.state?(M.total_in=M.total_out=(v=M.state).total=0,M.msg="",v.wrap&&(M.adler=1&v.wrap),v.mode=1,v.last=0,v.havedict=0,v.dmax=32768,v.head=null,v.hold=0,v.bits=0,v.lencode=v.lendyn=new H.Buf32(852),v.distcode=v.distdyn=new H.Buf32(592),v.sane=1,v.back=-1,0):D}function z(M){var v;return M&&M.state?((v=M.state).wsize=0,v.whave=0,v.wnext=0,oe(M)):D}function q(M,v){var P,R;return M&&M.state?(R=M.state,v<0?(P=0,v=-v):(P=1+(v>>4),v<48&&(v&=15)),v&&(v<8||15<v)?D:(null!==R.window&&R.wbits!==v&&(R.window=null),R.wrap=P,R.wbits=v,z(M))):D}function K(M,v){var P,R;return M?(R=new j,(M.state=R).window=null,0!==(P=q(M,v))&&(M.state=null),P):D}var I,A,J=!0;function L(M){if(J){var v;for(I=new H.Buf32(512),A=new H.Buf32(32),v=0;v<144;)M.lens[v++]=8;for(;v<256;)M.lens[v++]=9;for(;v<280;)M.lens[v++]=7;for(;v<288;)M.lens[v++]=8;for(O(1,M.lens,0,288,I,0,M.work,{bits:9}),v=0;v<32;)M.lens[v++]=5;O(2,M.lens,0,32,A,0,M.work,{bits:5}),J=!1}M.lencode=I,M.lenbits=9,M.distcode=A,M.distbits=5}function S(M,v,P,R){var te,k=M.state;return null===k.window&&(k.wsize=1<<k.wbits,k.wnext=0,k.whave=0,k.window=new H.Buf8(k.wsize)),R>=k.wsize?(H.arraySet(k.window,v,P-k.wsize,k.wsize,0),k.wnext=0,k.whave=k.wsize):(R<(te=k.wsize-k.wnext)&&(te=R),H.arraySet(k.window,v,P-R,te,k.wnext),(R-=te)?(H.arraySet(k.window,v,P-R,R,0),k.wnext=R,k.whave=k.wsize):(k.wnext+=te,k.wnext===k.wsize&&(k.wnext=0),k.whave<k.wsize&&(k.whave+=te))),0}d.inflateReset=z,d.inflateReset2=q,d.inflateResetKeep=oe,d.inflateInit=function(M){return K(M,15)},d.inflateInit2=K,d.inflate=function(M,v){var P,R,te,k,de,N,F,g,l,c,f,u,p,_,y,m,ne,se,Ee,ke,ce,Me,$e,be,he=0,Se=new H.Buf8(4),ve=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!M||!M.state||!M.output||!M.input&&0!==M.avail_in)return D;12===(P=M.state).mode&&(P.mode=13),de=M.next_out,te=M.output,k=M.next_in,R=M.input,g=P.hold,l=P.bits,c=N=M.avail_in,f=F=M.avail_out,Me=0;e:for(;;)switch(P.mode){case 1:if(0===P.wrap){P.mode=13;break}for(;l<16;){if(0===N)break e;N--,g+=R[k++]<<l,l+=8}if(2&P.wrap&&35615===g){Se[P.check=0]=255&g,Se[1]=g>>>8&255,P.check=$(P.check,Se,2,0),l=g=0,P.mode=2;break}if(P.flags=0,P.head&&(P.head.done=!1),!(1&P.wrap)||(((255&g)<<8)+(g>>8))%31){M.msg="incorrect header check",P.mode=30;break}if(8!=(15&g)){M.msg="unknown compression method",P.mode=30;break}if(l-=4,ce=8+(15&(g>>>=4)),0===P.wbits)P.wbits=ce;else if(ce>P.wbits){M.msg="invalid window size",P.mode=30;break}P.dmax=1<<ce,M.adler=P.check=1,P.mode=512&g?10:12,l=g=0;break;case 2:for(;l<16;){if(0===N)break e;N--,g+=R[k++]<<l,l+=8}if(P.flags=g,8!=(255&P.flags)){M.msg="unknown compression method",P.mode=30;break}if(57344&P.flags){M.msg="unknown header flags set",P.mode=30;break}P.head&&(P.head.text=g>>8&1),512&P.flags&&(Se[0]=255&g,Se[1]=g>>>8&255,P.check=$(P.check,Se,2,0)),l=g=0,P.mode=3;case 3:for(;l<32;){if(0===N)break e;N--,g+=R[k++]<<l,l+=8}P.head&&(P.head.time=g),512&P.flags&&(Se[0]=255&g,Se[1]=g>>>8&255,Se[2]=g>>>16&255,Se[3]=g>>>24&255,P.check=$(P.check,Se,4,0)),l=g=0,P.mode=4;case 4:for(;l<16;){if(0===N)break e;N--,g+=R[k++]<<l,l+=8}P.head&&(P.head.xflags=255&g,P.head.os=g>>8),512&P.flags&&(Se[0]=255&g,Se[1]=g>>>8&255,P.check=$(P.check,Se,2,0)),l=g=0,P.mode=5;case 5:if(1024&P.flags){for(;l<16;){if(0===N)break e;N--,g+=R[k++]<<l,l+=8}P.length=g,P.head&&(P.head.extra_len=g),512&P.flags&&(Se[0]=255&g,Se[1]=g>>>8&255,P.check=$(P.check,Se,2,0)),l=g=0}else P.head&&(P.head.extra=null);P.mode=6;case 6:if(1024&P.flags&&(N<(u=P.length)&&(u=N),u&&(P.head&&(ce=P.head.extra_len-P.length,P.head.extra||(P.head.extra=new Array(P.head.extra_len)),H.arraySet(P.head.extra,R,k,u,ce)),512&P.flags&&(P.check=$(P.check,R,u,k)),N-=u,k+=u,P.length-=u),P.length))break e;P.length=0,P.mode=7;case 7:if(2048&P.flags){if(0===N)break e;for(u=0;ce=R[k+u++],P.head&&ce&&P.length<65536&&(P.head.name+=String.fromCharCode(ce)),ce&&u<N;);if(512&P.flags&&(P.check=$(P.check,R,u,k)),N-=u,k+=u,ce)break e}else P.head&&(P.head.name=null);P.length=0,P.mode=8;case 8:if(4096&P.flags){if(0===N)break e;for(u=0;ce=R[k+u++],P.head&&ce&&P.length<65536&&(P.head.comment+=String.fromCharCode(ce)),ce&&u<N;);if(512&P.flags&&(P.check=$(P.check,R,u,k)),N-=u,k+=u,ce)break e}else P.head&&(P.head.comment=null);P.mode=9;case 9:if(512&P.flags){for(;l<16;){if(0===N)break e;N--,g+=R[k++]<<l,l+=8}if(g!==(65535&P.check)){M.msg="header crc mismatch",P.mode=30;break}l=g=0}P.head&&(P.head.hcrc=P.flags>>9&1,P.head.done=!0),M.adler=P.check=0,P.mode=12;break;case 10:for(;l<32;){if(0===N)break e;N--,g+=R[k++]<<l,l+=8}M.adler=P.check=T(g),l=g=0,P.mode=11;case 11:if(0===P.havedict)return M.next_out=de,M.avail_out=F,M.next_in=k,M.avail_in=N,P.hold=g,P.bits=l,2;M.adler=P.check=1,P.mode=12;case 12:if(5===v||6===v)break e;case 13:if(P.last){g>>>=7&l,l-=7&l,P.mode=27;break}for(;l<3;){if(0===N)break e;N--,g+=R[k++]<<l,l+=8}switch(P.last=1&g,l-=1,3&(g>>>=1)){case 0:P.mode=14;break;case 1:if(L(P),P.mode=20,6!==v)break;g>>>=2,l-=2;break e;case 2:P.mode=17;break;case 3:M.msg="invalid block type",P.mode=30}g>>>=2,l-=2;break;case 14:for(g>>>=7&l,l-=7&l;l<32;){if(0===N)break e;N--,g+=R[k++]<<l,l+=8}if((65535&g)!=(g>>>16^65535)){M.msg="invalid stored block lengths",P.mode=30;break}if(P.length=65535&g,l=g=0,P.mode=15,6===v)break e;case 15:P.mode=16;case 16:if(u=P.length){if(N<u&&(u=N),F<u&&(u=F),0===u)break e;H.arraySet(te,R,k,u,de),N-=u,k+=u,F-=u,de+=u,P.length-=u;break}P.mode=12;break;case 17:for(;l<14;){if(0===N)break e;N--,g+=R[k++]<<l,l+=8}if(P.nlen=257+(31&g),l-=5,P.ndist=1+(31&(g>>>=5)),l-=5,P.ncode=4+(15&(g>>>=5)),g>>>=4,l-=4,286<P.nlen||30<P.ndist){M.msg="too many length or distance symbols",P.mode=30;break}P.have=0,P.mode=18;case 18:for(;P.have<P.ncode;){for(;l<3;){if(0===N)break e;N--,g+=R[k++]<<l,l+=8}P.lens[ve[P.have++]]=7&g,g>>>=3,l-=3}for(;P.have<19;)P.lens[ve[P.have++]]=0;if(P.lencode=P.lendyn,P.lenbits=7,Me=O(0,P.lens,0,19,P.lencode,0,P.work,$e={bits:P.lenbits}),P.lenbits=$e.bits,Me){M.msg="invalid code lengths set",P.mode=30;break}P.have=0,P.mode=19;case 19:for(;P.have<P.nlen+P.ndist;){for(;m=(he=P.lencode[g&(1<<P.lenbits)-1])>>>16&255,ne=65535&he,!((y=he>>>24)<=l);){if(0===N)break e;N--,g+=R[k++]<<l,l+=8}if(ne<16)g>>>=y,l-=y,P.lens[P.have++]=ne;else{if(16===ne){for(be=y+2;l<be;){if(0===N)break e;N--,g+=R[k++]<<l,l+=8}if(g>>>=y,l-=y,0===P.have){M.msg="invalid bit length repeat",P.mode=30;break}ce=P.lens[P.have-1],u=3+(3&g),g>>>=2,l-=2}else if(17===ne){for(be=y+3;l<be;){if(0===N)break e;N--,g+=R[k++]<<l,l+=8}l-=y,ce=0,u=3+(7&(g>>>=y)),g>>>=3,l-=3}else{for(be=y+7;l<be;){if(0===N)break e;N--,g+=R[k++]<<l,l+=8}l-=y,ce=0,u=11+(127&(g>>>=y)),g>>>=7,l-=7}if(P.have+u>P.nlen+P.ndist){M.msg="invalid bit length repeat",P.mode=30;break}for(;u--;)P.lens[P.have++]=ce}}if(30===P.mode)break;if(0===P.lens[256]){M.msg="invalid code -- missing end-of-block",P.mode=30;break}if(P.lenbits=9,Me=O(1,P.lens,0,P.nlen,P.lencode,0,P.work,$e={bits:P.lenbits}),P.lenbits=$e.bits,Me){M.msg="invalid literal/lengths set",P.mode=30;break}if(P.distbits=6,P.distcode=P.distdyn,Me=O(2,P.lens,P.nlen,P.ndist,P.distcode,0,P.work,$e={bits:P.distbits}),P.distbits=$e.bits,Me){M.msg="invalid distances set",P.mode=30;break}if(P.mode=20,6===v)break e;case 20:P.mode=21;case 21:if(6<=N&&258<=F){M.next_out=de,M.avail_out=F,M.next_in=k,M.avail_in=N,P.hold=g,P.bits=l,x(M,f),de=M.next_out,te=M.output,F=M.avail_out,k=M.next_in,R=M.input,N=M.avail_in,g=P.hold,l=P.bits,12===P.mode&&(P.back=-1);break}for(P.back=0;m=(he=P.lencode[g&(1<<P.lenbits)-1])>>>16&255,ne=65535&he,!((y=he>>>24)<=l);){if(0===N)break e;N--,g+=R[k++]<<l,l+=8}if(m&&0==(240&m)){for(se=y,Ee=m,ke=ne;m=(he=P.lencode[ke+((g&(1<<se+Ee)-1)>>se)])>>>16&255,ne=65535&he,!(se+(y=he>>>24)<=l);){if(0===N)break e;N--,g+=R[k++]<<l,l+=8}g>>>=se,l-=se,P.back+=se}if(g>>>=y,l-=y,P.back+=y,P.length=ne,0===m){P.mode=26;break}if(32&m){P.back=-1,P.mode=12;break}if(64&m){M.msg="invalid literal/length code",P.mode=30;break}P.extra=15&m,P.mode=22;case 22:if(P.extra){for(be=P.extra;l<be;){if(0===N)break e;N--,g+=R[k++]<<l,l+=8}P.length+=g&(1<<P.extra)-1,g>>>=P.extra,l-=P.extra,P.back+=P.extra}P.was=P.length,P.mode=23;case 23:for(;m=(he=P.distcode[g&(1<<P.distbits)-1])>>>16&255,ne=65535&he,!((y=he>>>24)<=l);){if(0===N)break e;N--,g+=R[k++]<<l,l+=8}if(0==(240&m)){for(se=y,Ee=m,ke=ne;m=(he=P.distcode[ke+((g&(1<<se+Ee)-1)>>se)])>>>16&255,ne=65535&he,!(se+(y=he>>>24)<=l);){if(0===N)break e;N--,g+=R[k++]<<l,l+=8}g>>>=se,l-=se,P.back+=se}if(g>>>=y,l-=y,P.back+=y,64&m){M.msg="invalid distance code",P.mode=30;break}P.offset=ne,P.extra=15&m,P.mode=24;case 24:if(P.extra){for(be=P.extra;l<be;){if(0===N)break e;N--,g+=R[k++]<<l,l+=8}P.offset+=g&(1<<P.extra)-1,g>>>=P.extra,l-=P.extra,P.back+=P.extra}if(P.offset>P.dmax){M.msg="invalid distance too far back",P.mode=30;break}P.mode=25;case 25:if(0===F)break e;if(P.offset>(u=f-F)){if((u=P.offset-u)>P.whave&&P.sane){M.msg="invalid distance too far back",P.mode=30;break}p=u>P.wnext?P.wsize-(u-=P.wnext):P.wnext-u,u>P.length&&(u=P.length),_=P.window}else _=te,p=de-P.offset,u=P.length;for(F<u&&(u=F),F-=u,P.length-=u;te[de++]=_[p++],--u;);0===P.length&&(P.mode=21);break;case 26:if(0===F)break e;te[de++]=P.length,F--,P.mode=21;break;case 27:if(P.wrap){for(;l<32;){if(0===N)break e;N--,g|=R[k++]<<l,l+=8}if(M.total_out+=f-=F,P.total+=f,f&&(M.adler=P.check=P.flags?$(P.check,te,f,de-f):ee(P.check,te,f,de-f)),f=F,(P.flags?g:T(g))!==P.check){M.msg="incorrect data check",P.mode=30;break}l=g=0}P.mode=28;case 28:if(P.wrap&&P.flags){for(;l<32;){if(0===N)break e;N--,g+=R[k++]<<l,l+=8}if(g!==(4294967295&P.total)){M.msg="incorrect length check",P.mode=30;break}l=g=0}P.mode=29;case 29:Me=1;break e;case 30:Me=-3;break e;case 31:return-4;default:return D}return M.next_out=de,M.avail_out=F,M.next_in=k,M.avail_in=N,P.hold=g,P.bits=l,(P.wsize||f!==M.avail_out&&P.mode<30&&(P.mode<27||4!==v))&&S(M,M.output,M.next_out,f-M.avail_out)?(P.mode=31,-4):(f-=M.avail_out,M.total_in+=c-=M.avail_in,M.total_out+=f,P.total+=f,P.wrap&&f&&(M.adler=P.check=P.flags?$(P.check,te,f,M.next_out-f):ee(P.check,te,f,M.next_out-f)),M.data_type=P.bits+(P.last?64:0)+(12===P.mode?128:0)+(20===P.mode||15===P.mode?256:0),(0==c&&0===f||4===v)&&0===Me&&(Me=-5),Me)},d.inflateEnd=function(M){if(!M||!M.state)return D;var v=M.state;return v.window&&(v.window=null),M.state=null,0},d.inflateGetHeader=function(M,v){var P;return M&&M.state?0==(2&(P=M.state).wrap)?D:((P.head=v).done=!1,0):D},d.inflateSetDictionary=function(M,v){var P,R=v.length;return M&&M.state?0!==(P=M.state).wrap&&11!==P.mode?D:11===P.mode&&ee(1,v,R,0)!==P.check?-3:S(M,v,R,R)?(P.mode=31,-4):(P.havedict=1,0):D},d.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(le,me,d){"use strict";var H=le("../utils/common"),ee=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],$=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],x=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],O=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];me.exports=function(E,Y,G,D,W,B,Z,T){var j,oe,z,q,K,I,A,J,L,S=T.bits,M=0,v=0,P=0,R=0,te=0,k=0,de=0,N=0,F=0,g=0,l=null,c=0,f=new H.Buf16(16),u=new H.Buf16(16),p=null,_=0;for(M=0;M<=15;M++)f[M]=0;for(v=0;v<D;v++)f[Y[G+v]]++;for(te=S,R=15;1<=R&&0===f[R];R--);if(R<te&&(te=R),0===R)return W[B++]=20971520,W[B++]=20971520,T.bits=1,0;for(P=1;P<R&&0===f[P];P++);for(te<P&&(te=P),M=N=1;M<=15;M++)if(N<<=1,(N-=f[M])<0)return-1;if(0<N&&(0===E||1!==R))return-1;for(u[1]=0,M=1;M<15;M++)u[M+1]=u[M]+f[M];for(v=0;v<D;v++)0!==Y[G+v]&&(Z[u[Y[G+v]]++]=v);if(I=0===E?(l=p=Z,19):1===E?(l=ee,c-=257,p=$,_-=257,256):(l=x,p=O,-1),M=P,K=B,de=v=g=0,z=-1,q=(F=1<<(k=te))-1,1===E&&852<F||2===E&&592<F)return 1;for(;;){for(A=M-de,L=Z[v]<I?(J=0,Z[v]):Z[v]>I?(J=p[_+Z[v]],l[c+Z[v]]):(J=96,0),j=1<<M-de,P=oe=1<<k;W[K+(g>>de)+(oe-=j)]=A<<24|J<<16|L|0,0!==oe;);for(j=1<<M-1;g&j;)j>>=1;if(0!==j?(g&=j-1,g+=j):g=0,v++,0==--f[M]){if(M===R)break;M=Y[G+Z[v]]}if(te<M&&(g&q)!==z){for(0===de&&(de=te),K+=P,N=1<<(k=M-de);k+de<R&&!((N-=f[k+de])<=0);)k++,N<<=1;if(F+=1<<k,1===E&&852<F||2===E&&592<F)return 1;W[z=g&q]=te<<24|k<<16|K-B|0}}return 0!==g&&(W[K+g]=M-de<<24|64<<16|0),T.bits=te,0}},{"../utils/common":41}],51:[function(le,me,d){"use strict";me.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(le,me,d){"use strict";var H=le("../utils/common");function x(he){for(var Se=he.length;0<=--Se;)he[Se]=0}var Y=256,G=286,D=30,Z=15,I=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],A=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],J=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S=new Array(576);x(S);var M=new Array(60);x(M);var v=new Array(512);x(v);var P=new Array(256);x(P);var R=new Array(29);x(R);var te,k,de,N=new Array(D);function F(he,Se,ve,ae,ue){this.static_tree=he,this.extra_bits=Se,this.extra_base=ve,this.elems=ae,this.max_length=ue,this.has_stree=he&&he.length}function g(he,Se){this.dyn_tree=he,this.max_code=0,this.stat_desc=Se}function l(he){return he<256?v[he]:v[256+(he>>>7)]}function c(he,Se){he.pending_buf[he.pending++]=255&Se,he.pending_buf[he.pending++]=Se>>>8&255}function f(he,Se,ve){he.bi_valid>16-ve?(he.bi_buf|=Se<<he.bi_valid&65535,c(he,he.bi_buf),he.bi_buf=Se>>16-he.bi_valid,he.bi_valid+=ve-16):(he.bi_buf|=Se<<he.bi_valid&65535,he.bi_valid+=ve)}function u(he,Se,ve){f(he,ve[2*Se],ve[2*Se+1])}function p(he,Se){for(var ve=0;ve|=1&he,he>>>=1,ve<<=1,0<--Se;);return ve>>>1}function _(he,Se,ve){var ae,ue,Ce=new Array(16),b=0;for(ae=1;ae<=Z;ae++)Ce[ae]=b=b+ve[ae-1]<<1;for(ue=0;ue<=Se;ue++){var V=he[2*ue+1];0!==V&&(he[2*ue]=p(Ce[V]++,V))}}function y(he){var Se;for(Se=0;Se<G;Se++)he.dyn_ltree[2*Se]=0;for(Se=0;Se<D;Se++)he.dyn_dtree[2*Se]=0;for(Se=0;Se<19;Se++)he.bl_tree[2*Se]=0;he.dyn_ltree[512]=1,he.opt_len=he.static_len=0,he.last_lit=he.matches=0}function m(he){8<he.bi_valid?c(he,he.bi_buf):0<he.bi_valid&&(he.pending_buf[he.pending++]=he.bi_buf),he.bi_buf=0,he.bi_valid=0}function ne(he,Se,ve,ae){var ue=2*Se,Ce=2*ve;return he[ue]<he[Ce]||he[ue]===he[Ce]&&ae[Se]<=ae[ve]}function se(he,Se,ve){for(var ae=he.heap[ve],ue=ve<<1;ue<=he.heap_len&&(ue<he.heap_len&&ne(Se,he.heap[ue+1],he.heap[ue],he.depth)&&ue++,!ne(Se,ae,he.heap[ue],he.depth));)he.heap[ve]=he.heap[ue],ve=ue,ue<<=1;he.heap[ve]=ae}function Ee(he,Se,ve){var ae,ue,Ce,b,V=0;if(0!==he.last_lit)for(;ae=he.pending_buf[he.d_buf+2*V]<<8|he.pending_buf[he.d_buf+2*V+1],ue=he.pending_buf[he.l_buf+V],V++,0===ae?u(he,ue,Se):(u(he,(Ce=P[ue])+Y+1,Se),0!==(b=I[Ce])&&f(he,ue-=R[Ce],b),u(he,Ce=l(--ae),ve),0!==(b=A[Ce])&&f(he,ae-=N[Ce],b)),V<he.last_lit;);u(he,256,Se)}function ke(he,Se){var ve,ae,ue,Ce=Se.dyn_tree,b=Se.stat_desc.static_tree,V=Se.stat_desc.has_stree,ge=Se.stat_desc.elems,xe=-1;for(he.heap_len=0,he.heap_max=573,ve=0;ve<ge;ve++)0!==Ce[2*ve]?(he.heap[++he.heap_len]=xe=ve,he.depth[ve]=0):Ce[2*ve+1]=0;for(;he.heap_len<2;)Ce[2*(ue=he.heap[++he.heap_len]=xe<2?++xe:0)]=1,he.depth[ue]=0,he.opt_len--,V&&(he.static_len-=b[2*ue+1]);for(Se.max_code=xe,ve=he.heap_len>>1;1<=ve;ve--)se(he,Ce,ve);for(ue=ge;ve=he.heap[1],he.heap[1]=he.heap[he.heap_len--],se(he,Ce,1),ae=he.heap[1],he.heap[--he.heap_max]=ve,he.heap[--he.heap_max]=ae,Ce[2*ue]=Ce[2*ve]+Ce[2*ae],he.depth[ue]=(he.depth[ve]>=he.depth[ae]?he.depth[ve]:he.depth[ae])+1,Ce[2*ve+1]=Ce[2*ae+1]=ue,he.heap[1]=ue++,se(he,Ce,1),2<=he.heap_len;);he.heap[--he.heap_max]=he.heap[1],function(De,Re){var Ue,Ze,mt,bt,Wt,jt,En=Re.dyn_tree,yn=Re.max_code,mr=Re.stat_desc.static_tree,al=Re.stat_desc.has_stree,Cf=Re.stat_desc.extra_bits,Tu=Re.stat_desc.extra_base,Zs=Re.stat_desc.max_length,vo=0;for(bt=0;bt<=Z;bt++)De.bl_count[bt]=0;for(En[2*De.heap[De.heap_max]+1]=0,Ue=De.heap_max+1;Ue<573;Ue++)Zs<(bt=En[2*En[2*(Ze=De.heap[Ue])+1]+1]+1)&&(bt=Zs,vo++),En[2*Ze+1]=bt,yn<Ze||(De.bl_count[bt]++,Wt=0,Tu<=Ze&&(Wt=Cf[Ze-Tu]),De.opt_len+=(jt=En[2*Ze])*(bt+Wt),al&&(De.static_len+=jt*(mr[2*Ze+1]+Wt)));if(0!==vo){do{for(bt=Zs-1;0===De.bl_count[bt];)bt--;De.bl_count[bt]--,De.bl_count[bt+1]+=2,De.bl_count[Zs]--,vo-=2}while(0<vo);for(bt=Zs;0!==bt;bt--)for(Ze=De.bl_count[bt];0!==Ze;)yn<(mt=De.heap[--Ue])||(En[2*mt+1]!==bt&&(De.opt_len+=(bt-En[2*mt+1])*En[2*mt],En[2*mt+1]=bt),Ze--)}}(he,Se),_(Ce,xe,he.bl_count)}function ce(he,Se,ve){var ae,ue,Ce=-1,b=Se[1],V=0,ge=7,xe=4;for(0===b&&(ge=138,xe=3),Se[2*(ve+1)+1]=65535,ae=0;ae<=ve;ae++)ue=b,b=Se[2*(ae+1)+1],++V<ge&&ue===b||(V<xe?he.bl_tree[2*ue]+=V:0!==ue?(ue!==Ce&&he.bl_tree[2*ue]++,he.bl_tree[32]++):V<=10?he.bl_tree[34]++:he.bl_tree[36]++,Ce=ue,xe=(V=0)===b?(ge=138,3):ue===b?(ge=6,3):(ge=7,4))}function Me(he,Se,ve){var ae,ue,Ce=-1,b=Se[1],V=0,ge=7,xe=4;for(0===b&&(ge=138,xe=3),ae=0;ae<=ve;ae++)if(ue=b,b=Se[2*(ae+1)+1],!(++V<ge&&ue===b)){if(V<xe)for(;u(he,ue,he.bl_tree),0!=--V;);else 0!==ue?(ue!==Ce&&(u(he,ue,he.bl_tree),V--),u(he,16,he.bl_tree),f(he,V-3,2)):V<=10?(u(he,17,he.bl_tree),f(he,V-3,3)):(u(he,18,he.bl_tree),f(he,V-11,7));Ce=ue,xe=(V=0)===b?(ge=138,3):ue===b?(ge=6,3):(ge=7,4)}}x(N);var $e=!1;function be(he,Se,ve,ae){var ue,Ce,b;f(he,0+(ae?1:0),3),Ce=Se,b=ve,m(ue=he),c(ue,b),c(ue,~b),H.arraySet(ue.pending_buf,ue.window,Ce,b,ue.pending),ue.pending+=b}d._tr_init=function(he){$e||(function(){var Se,ve,ae,ue,Ce,b=new Array(16);for(ue=ae=0;ue<28;ue++)for(R[ue]=ae,Se=0;Se<1<<I[ue];Se++)P[ae++]=ue;for(P[ae-1]=ue,ue=Ce=0;ue<16;ue++)for(N[ue]=Ce,Se=0;Se<1<<A[ue];Se++)v[Ce++]=ue;for(Ce>>=7;ue<D;ue++)for(N[ue]=Ce<<7,Se=0;Se<1<<A[ue]-7;Se++)v[256+Ce++]=ue;for(ve=0;ve<=Z;ve++)b[ve]=0;for(Se=0;Se<=143;)S[2*Se+1]=8,Se++,b[8]++;for(;Se<=255;)S[2*Se+1]=9,Se++,b[9]++;for(;Se<=279;)S[2*Se+1]=7,Se++,b[7]++;for(;Se<=287;)S[2*Se+1]=8,Se++,b[8]++;for(_(S,287,b),Se=0;Se<D;Se++)M[2*Se+1]=5,M[2*Se]=p(Se,5);te=new F(S,I,257,G,Z),k=new F(M,A,0,D,Z),de=new F(new Array(0),J,0,19,7)}(),$e=!0),he.l_desc=new g(he.dyn_ltree,te),he.d_desc=new g(he.dyn_dtree,k),he.bl_desc=new g(he.bl_tree,de),he.bi_buf=0,he.bi_valid=0,y(he)},d._tr_stored_block=be,d._tr_flush_block=function(he,Se,ve,ae){var ue,Ce,b=0;0<he.level?(2===he.strm.data_type&&(he.strm.data_type=function(V){var ge,xe=4093624447;for(ge=0;ge<=31;ge++,xe>>>=1)if(1&xe&&0!==V.dyn_ltree[2*ge])return 0;if(0!==V.dyn_ltree[18]||0!==V.dyn_ltree[20]||0!==V.dyn_ltree[26])return 1;for(ge=32;ge<Y;ge++)if(0!==V.dyn_ltree[2*ge])return 1;return 0}(he)),ke(he,he.l_desc),ke(he,he.d_desc),b=function(V){var ge;for(ce(V,V.dyn_ltree,V.l_desc.max_code),ce(V,V.dyn_dtree,V.d_desc.max_code),ke(V,V.bl_desc),ge=18;3<=ge&&0===V.bl_tree[2*L[ge]+1];ge--);return V.opt_len+=3*(ge+1)+5+5+4,ge}(he),(Ce=he.static_len+3+7>>>3)<=(ue=he.opt_len+3+7>>>3)&&(ue=Ce)):ue=Ce=ve+5,ve+4<=ue&&-1!==Se?be(he,Se,ve,ae):4===he.strategy||Ce===ue?(f(he,2+(ae?1:0),3),Ee(he,S,M)):(f(he,4+(ae?1:0),3),function(V,ge,xe,De){var Re;for(f(V,ge-257,5),f(V,xe-1,5),f(V,De-4,4),Re=0;Re<De;Re++)f(V,V.bl_tree[2*L[Re]+1],3);Me(V,V.dyn_ltree,ge-1),Me(V,V.dyn_dtree,xe-1)}(he,he.l_desc.max_code+1,he.d_desc.max_code+1,b+1),Ee(he,he.dyn_ltree,he.dyn_dtree)),y(he),ae&&m(he)},d._tr_tally=function(he,Se,ve){return he.pending_buf[he.d_buf+2*he.last_lit]=Se>>>8&255,he.pending_buf[he.d_buf+2*he.last_lit+1]=255&Se,he.pending_buf[he.l_buf+he.last_lit]=255&ve,he.last_lit++,0===Se?he.dyn_ltree[2*ve]++:(he.matches++,Se--,he.dyn_ltree[2*(P[ve]+Y+1)]++,he.dyn_dtree[2*l(Se)]++),he.last_lit===he.lit_bufsize-1},d._tr_align=function(he){var Se;f(he,2,3),u(he,256,S),16===(Se=he).bi_valid?(c(Se,Se.bi_buf),Se.bi_buf=0,Se.bi_valid=0):8<=Se.bi_valid&&(Se.pending_buf[Se.pending++]=255&Se.bi_buf,Se.bi_buf>>=8,Se.bi_valid-=8)}},{"../utils/common":41}],53:[function(le,me,d){"use strict";me.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(le,me,d){(function(H){!function(ee,$){"use strict";if(!ee.setImmediate){var x,O,E,Y,G=1,D={},W=!1,B=ee.document,Z=Object.getPrototypeOf&&Object.getPrototypeOf(ee);Z=Z&&Z.setTimeout?Z:ee,x="[object process]"==={}.toString.call(ee.process)?function(z){process.nextTick(function(){j(z)})}:function(){if(ee.postMessage&&!ee.importScripts){var z=!0,q=ee.onmessage;return ee.onmessage=function(){z=!1},ee.postMessage("","*"),ee.onmessage=q,z}}()?(Y="setImmediate$"+Math.random()+"$",ee.addEventListener?ee.addEventListener("message",oe,!1):ee.attachEvent("onmessage",oe),function(z){ee.postMessage(Y+z,"*")}):ee.MessageChannel?((E=new MessageChannel).port1.onmessage=function(z){j(z.data)},function(z){E.port2.postMessage(z)}):B&&"onreadystatechange"in B.createElement("script")?(O=B.documentElement,function(z){var q=B.createElement("script");q.onreadystatechange=function(){j(z),q.onreadystatechange=null,O.removeChild(q),q=null},O.appendChild(q)}):function(z){setTimeout(j,0,z)},Z.setImmediate=function(z){"function"!=typeof z&&(z=new Function(""+z));for(var q=new Array(arguments.length-1),K=0;K<q.length;K++)q[K]=arguments[K+1];return D[G]={callback:z,args:q},x(G),G++},Z.clearImmediate=T}function T(z){delete D[z]}function j(z){if(W)setTimeout(j,0,z);else{var q=D[z];if(q){W=!0;try{!function(K){var I=K.callback,A=K.args;switch(A.length){case 0:I();break;case 1:I(A[0]);break;case 2:I(A[0],A[1]);break;case 3:I(A[0],A[1],A[2]);break;default:I.apply(undefined,A)}}(q)}finally{T(z),W=!1}}}}function oe(z){z.source===ee&&"string"==typeof z.data&&0===z.data.indexOf(Y)&&j(+z.data.slice(Y.length))}}("undefined"==typeof self?void 0===H?this:H:self)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)},9263:(C,le,me)=>{var d=me(9209),H=me(966);function ee($){this._init($)}ee.prototype={_init:function($){$=$||{},this._data=null,this._table=null,this._result=null,this._onDataCallback=$.onData,this._onEndCallback=$.onEnd},_createTable:function(){for(var $=H.createBuffer(8,d.TABLE_LENGTH),x=0;x<d.TABLE_LENGTH;x++)$[x]=d.BASE62TABLE.charCodeAt(x);return $},_onData:function($,x){var O=H.bufferToString_fast($,x);this._onDataCallback?this._onDataCallback(O):this._result+=O},_onEnd:function(){this._onEndCallback&&this._onEndCallback(),this._data=this._table=null},_search:function(){var $=2,x=this._data,O=this._offset,E=d.BUFFER_MAX;if(this._dataLen-O<E&&(E=this._dataLen-O),$>E)return!1;var W,B,Z,T,j,Y=O-d.WINDOW_BUFFER_MAX,G=x.substring(Y,O+E),D=O+$-3-Y;do{if(2===$){if(B=x.charAt(O)+x.charAt(O+1),!~(Z=G.indexOf(B))||Z>D)break}else 3===$?B+=x.charAt(O+2):B=x.substr(O,$);if(!~(T=d.STRING_LASTINDEXOF_BUG?x.substring(Y,O+$-1).lastIndexOf(B):G.lastIndexOf(B,D)))break;j=T,W=Y+T;do{if(x.charCodeAt(O+$)!==x.charCodeAt(W+$))break}while(++$<E);if(Z===T){$++;break}}while(++$<E);return 2!==$&&(this._index=d.WINDOW_BUFFER_MAX-j,this._length=$-1,!0)},compress:function($){if(null==$||0===$.length)return"";var x,O=this._createTable(),E=H.createWindow(),Y=H.createBuffer(8,d.COMPRESS_CHUNK_SIZE),G=0;this._result="",this._offset=E.length,this._data=E+$,this._dataLen=this._data.length,E=$=null;for(var B,Z,T,j,oe,D=-1,W=-1;this._offset<this._dataLen;)this._search()?(this._index<d.BUFFER_MAX?(Z=this._index,T=0):T=(this._index-(Z=this._index%d.BUFFER_MAX))/d.BUFFER_MAX,2===this._length?(Y[G++]=O[T+d.COMPRESS_FIXED_START],Y[G++]=O[Z]):(Y[G++]=O[T+d.COMPRESS_START],Y[G++]=O[Z],Y[G++]=O[this._length]),this._offset+=this._length,~W&&(W=-1)):(B=this._data.charCodeAt(this._offset++))<d.LATIN_BUFFER_MAX?(B<d.UNICODE_CHAR_MAX?(Z=B,T=0,D=d.LATIN_INDEX):D=(T=(B-(Z=B%d.UNICODE_CHAR_MAX))/d.UNICODE_CHAR_MAX)+d.LATIN_INDEX,W===D?Y[G++]=O[Z]:(Y[G++]=O[D-d.LATIN_INDEX_START],Y[G++]=O[Z],W=D)):(B<d.UNICODE_BUFFER_MAX?(Z=B,T=0,D=d.UNICODE_INDEX):D=(T=(B-(Z=B%d.UNICODE_BUFFER_MAX))/d.UNICODE_BUFFER_MAX)+d.UNICODE_INDEX,Z<d.UNICODE_CHAR_MAX?(j=Z,oe=0):oe=(Z-(j=Z%d.UNICODE_CHAR_MAX))/d.UNICODE_CHAR_MAX,W===D?(Y[G++]=O[j],Y[G++]=O[oe]):(Y[G++]=O[d.CHAR_START],Y[G++]=O[D-d.TABLE_LENGTH],Y[G++]=O[j],Y[G++]=O[oe],W=D)),G>=d.COMPRESS_CHUNK_MAX&&(this._onData(Y,G),G=0);return G>0&&this._onData(Y,G),this._onEnd(),x=this._result,this._result=null,null===x?"":x}},C.exports=ee},9209:(C,le)=>{var me=le.HAS_TYPED="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array,d=!1,H=!1;try{"a"===String.fromCharCode.apply(null,[97])&&(d=!0)}catch(z){}if(me)try{"a"===String.fromCharCode.apply(null,new Uint8Array([97]))&&(H=!0)}catch(z){}le.CAN_CHARCODE_APPLY=d,le.CAN_CHARCODE_APPLY_TYPED=H;var ee=le.APPLY_BUFFER_SIZE=65533;le.APPLY_BUFFER_SIZE_OK=null;var $=!1;-1!=="abc\u307b\u3052".lastIndexOf("\u307b\u3052",1)&&($=!0),le.STRING_LASTINDEXOF_BUG=$;var x=le.BASE62TABLE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",O=le.TABLE_LENGTH=x.length,E=Math.max(O,62)-Math.min(O,62);le.BUFFER_MAX=O-1;var Y=le.WINDOW_MAX=1024;le.WINDOW_BUFFER_MAX=304;var G=le.COMPRESS_CHUNK_SIZE=ee;le.COMPRESS_CHUNK_MAX=G-O;var D=le.DECOMPRESS_CHUNK_SIZE=ee;le.DECOMPRESS_CHUNK_MAX=D+2*Y,le.LATIN_BUFFER_MAX=132;var B=le.UNICODE_CHAR_MAX=40;le.UNICODE_BUFFER_MAX=B*(B+1),le.LATIN_INDEX=O+1,le.LATIN_INDEX_START=E+20,le.UNICODE_INDEX=O+5,le.DECODE_MAX=O-E-19;var Z=le.LATIN_DECODE_MAX=B+7,T=le.CHAR_START=Z+1,j=le.COMPRESS_START=T+1,oe=le.COMPRESS_FIXED_START=j+5;le.COMPRESS_INDEX=oe+5},9727:(C,le,me)=>{var d=me(9209),H=me(966);function ee($){this._init($)}ee.prototype={_init:function($){$=$||{},this._result=null,this._onDataCallback=$.onData,this._onEndCallback=$.onEnd},_createTable:function(){for(var $={},x=0;x<d.TABLE_LENGTH;x++)$[d.BASE62TABLE.charAt(x)]=x;return $},_onData:function($){var x;if(this._onDataCallback){if($)x=this._result,this._result=[];else{var O=d.DECOMPRESS_CHUNK_SIZE-d.WINDOW_MAX;x=this._result.slice(d.WINDOW_MAX,d.WINDOW_MAX+O),this._result=this._result.slice(0,d.WINDOW_MAX).concat(this._result.slice(d.WINDOW_MAX+O))}x.length>0&&this._onDataCallback(H.bufferToString_fast(x))}},_onEnd:function(){this._onEndCallback&&this._onEndCallback()},decompress:function($){if(null==$||0===$.length)return"";this._result=H.stringToArray(H.createWindow());for(var x,W,B,Z,j,oe,z,q,K,I,O=this._createTable(),E=!1,Y=null,G=$.length,D=0;D<G;D++)if(void 0!==(B=O[$.charAt(D)])){if(B<d.DECODE_MAX)j=E?O[$.charAt(++D)]*d.UNICODE_CHAR_MAX+B+d.UNICODE_BUFFER_MAX*Y:Y*d.UNICODE_CHAR_MAX+B,this._result[this._result.length]=j;else if(B<d.LATIN_DECODE_MAX)Y=B-d.DECODE_MAX,E=!1;else if(B===d.CHAR_START)Y=(Z=O[$.charAt(++D)])-5,E=!0;else if(B<d.COMPRESS_INDEX){if(Z=O[$.charAt(++D)],B<d.COMPRESS_FIXED_START?(oe=(B-d.COMPRESS_START)*d.BUFFER_MAX+Z,z=O[$.charAt(++D)]):(oe=(B-d.COMPRESS_FIXED_START)*d.BUFFER_MAX+Z,z=2),(q=this._result.slice(-oe)).length>z&&(q.length=z),K=q.length,q.length>0)for(I=0;I<z;)for(W=0;W<K&&(this._result[this._result.length]=q[W],!(++I>=z));W++);Y=null}this._result.length>=d.DECOMPRESS_CHUNK_MAX&&this._onData()}return this._result=this._result.slice(d.WINDOW_MAX),this._onData(!0),this._onEnd(),x=H.bufferToString_fast(this._result),this._result=null,x}},C.exports=ee},8497:(C,le,me)=>{var d=me(9263),H=me(9727);me(1014),le.n=function(ee,$){return new d($).compress(ee)},le.L=function(ee,$){return new H($).decompress(ee)}},966:(C,le,me)=>{var d=me(9209),H=String.fromCharCode;le.createBuffer=function(O,E){if(!d.HAS_TYPED)return new Array(E);switch(O){case 8:return new Uint8Array(E);case 16:return new Uint16Array(E)}};var ee=le.truncateBuffer=function(O,E){return O.length===E?O:O.subarray?O.subarray(0,E):(O.length=E,O)};le.bufferToString_fast=function(O,E){if(null==E?E=O.length:O=ee(O,E),d.CAN_CHARCODE_APPLY&&d.CAN_CHARCODE_APPLY_TYPED){var Y=O.length;if(Y<d.APPLY_BUFFER_SIZE&&d.APPLY_BUFFER_SIZE_OK)return H.apply(null,O);if(null===d.APPLY_BUFFER_SIZE_OK)try{var G=H.apply(null,O);return Y>d.APPLY_BUFFER_SIZE&&(d.APPLY_BUFFER_SIZE_OK=!0),G}catch(D){d.APPLY_BUFFER_SIZE_OK=!1}}return $(O)};var $=le.bufferToString_chunked=function(O){for(var D,E="",Y=O.length,G=0;G<Y;){if(D=O.subarray?O.subarray(G,G+d.APPLY_BUFFER_SIZE):O.slice(G,G+d.APPLY_BUFFER_SIZE),G+=d.APPLY_BUFFER_SIZE,!d.APPLY_BUFFER_SIZE_OK){if(null===d.APPLY_BUFFER_SIZE_OK)try{E+=H.apply(null,D),D.length>d.APPLY_BUFFER_SIZE&&(d.APPLY_BUFFER_SIZE_OK=!0);continue}catch(W){d.APPLY_BUFFER_SIZE_OK=!1}return x(O)}E+=H.apply(null,D)}return E},x=le.bufferToString_slow=function(O){for(var E="",Y=O.length,G=0;G<Y;G++)E+=H(O[G]);return E};le.stringToArray=function(O){for(var E=[],Y=O&&O.length,G=0;G<Y;G++)E[G]=O.charCodeAt(G);return E},le.createWindow=function(){for(var O=d.WINDOW_MAX>>7,E="        ";!(O&d.WINDOW_MAX);)E+=E,O<<=1;return E}},2391:(C,le,me)=>{le.encode=me(8048).encode,le.decode=me(9175).decode,me(7704),me(8131),me(1490),me(9234)},2295:function(C){function le(me){return me&&me.isBuffer&&me}C.exports=le("undefined"!=typeof Buffer&&Buffer)||le(this.Buffer)||le("undefined"!=typeof window&&window.Buffer)||this.Buffer},7625:(C,le)=>{le.copy=function ee($,x,O,E){var Y;O||(O=0),!E&&0!==E&&(E=this.length),x||(x=0);var G=E-O;if($===this&&O<x&&x<E)for(Y=G-1;Y>=0;Y--)$[Y+x]=this[Y+O];else for(Y=0;Y<G;Y++)$[Y+x]=this[Y+O];return G},le.toString=function H($,x,O){var E=this,Y=0|x;O||(O=E.length);for(var G="",D=0;Y<O;)(D=E[Y++])<128?G+=String.fromCharCode(D):(192==(224&D)?D=(31&D)<<6|63&E[Y++]:224==(240&D)?D=(15&D)<<12|(63&E[Y++])<<6|63&E[Y++]:240==(248&D)&&(D=(7&D)<<18|(63&E[Y++])<<12|(63&E[Y++])<<6|63&E[Y++]),D>=65536?(D-=65536,G+=String.fromCharCode(55296+(D>>>10),56320+(1023&D))):G+=String.fromCharCode(D));return G},le.write=function d($,x){for(var O=this,E=x||(x|=0),Y=$.length,G=0,D=0;D<Y;)(G=$.charCodeAt(D++))<128?O[E++]=G:G<2048?(O[E++]=192|G>>>6,O[E++]=128|63&G):G<55296||G>57343?(O[E++]=224|G>>>12,O[E++]=128|G>>>6&63,O[E++]=128|63&G):(G=65536+(G-55296<<10|$.charCodeAt(D++)-56320),O[E++]=240|G>>>18,O[E++]=128|G>>>12&63,O[E++]=128|G>>>6&63,O[E++]=128|63&G);return E-x}},1864:(C,le,me)=>{var d=me(6093),H=C.exports=ee(0);function ee(x){return new Array(x)}H.alloc=ee,H.concat=d.concat,H.from=function $(x){if(!d.isBuffer(x)&&d.isView(x))x=d.Uint8Array.from(x);else if(d.isArrayBuffer(x))x=new Uint8Array(x);else{if("string"==typeof x)return d.from.call(H,x);if("number"==typeof x)throw new TypeError('"value" argument must not be a number')}return Array.prototype.slice.call(x)}},1884:(C,le,me)=>{var d=me(6093),H=d.global,ee=C.exports=d.hasBuffer?$(0):[];function $(O){return new H(O)}ee.alloc=d.hasBuffer&&H.alloc||$,ee.concat=d.concat,ee.from=function x(O){if(!d.isBuffer(O)&&d.isView(O))O=d.Uint8Array.from(O);else if(d.isArrayBuffer(O))O=new Uint8Array(O);else{if("string"==typeof O)return d.from.call(ee,O);if("number"==typeof O)throw new TypeError('"value" argument must not be a number')}return H.from&&1!==H.from.length?H.from(O):new H(O)}},5364:(C,le,me)=>{var d=me(7625);le.copy=O,le.slice=E,le.toString=function Y(D,W,B){var Z=!$&&H.isBuffer(this)?this.toString:d.toString;return Z.apply(this,arguments)},le.write=function G(D){return function W(){return(this[D]||d[D]).apply(this,arguments)}}("write");var H=me(6093),ee=H.global,$=H.hasBuffer&&"TYPED_ARRAY_SUPPORT"in ee,x=$&&!ee.TYPED_ARRAY_SUPPORT;function O(D,W,B,Z){var T=H.isBuffer(this),j=H.isBuffer(D);if(T&&j)return this.copy(D,W,B,Z);if(x||T||j||!H.isView(this)||!H.isView(D))return d.copy.call(this,D,W,B,Z);var oe=B||null!=Z?E.call(this,B,Z):this;return D.set(oe,W),oe.length}function E(D,W){var B=this.slice||!x&&this.subarray;if(B)return B.call(this,D,W);var Z=H.alloc.call(this,W-D);return O.call(this,Z,0,D,W),Z}},5321:(C,le,me)=>{var d=me(6093),H=C.exports=d.hasArrayBuffer?ee(0):[];function ee(x){return new Uint8Array(x)}H.alloc=ee,H.concat=d.concat,H.from=function $(x){if(d.isView(x)){var O=x.byteOffset,E=x.byteLength;(x=x.buffer).byteLength!==E&&(x.slice?x=x.slice(O,O+E):(x=new Uint8Array(x)).byteLength!==E&&(x=Array.prototype.slice.call(x,O,O+E)))}else{if("string"==typeof x)return d.from.call(H,x);if("number"==typeof x)throw new TypeError('"value" argument must not be a number')}return new Uint8Array(x)}},6093:(C,le,me)=>{var d=le.global=me(2295),H=le.hasBuffer=d&&!!d.isBuffer,ee=le.hasArrayBuffer="undefined"!=typeof ArrayBuffer,$=le.isArray=me(6425);le.isArrayBuffer=ee?function j(I){return I instanceof ArrayBuffer||T(I)}:q;var x=le.isBuffer=H?d.isBuffer:q,O=le.isView=ee?ArrayBuffer.isView||K("ArrayBuffer","buffer"):q;le.alloc=B,le.concat=function Z(I,A){A||(A=0,Array.prototype.forEach.call(I,function M(P){A+=P.length}));var L=B.call(this!==le&&this||I[0],A),S=0;return Array.prototype.forEach.call(I,function v(P){S+=D.copy.call(P,L,S)}),L},le.from=function W(I){return"string"==typeof I?oe.call(this,I):z(this).from(I)};var E=le.Array=me(1864),Y=le.Buffer=me(1884),G=le.Uint8Array=me(5321),D=le.prototype=me(5364);function B(I){return z(this).alloc(I)}var T=K("ArrayBuffer");function oe(I){var A=3*I.length,J=B.call(this,A),L=D.write.call(J,I);return A!==L&&(J=D.slice.call(J,0,L)),J}function z(I){return x(I)?Y:O(I)?G:$(I)?E:H?Y:ee?G:E}function q(){return!1}function K(I,A){return I="[object "+I+"]",function(J){return null!=J&&{}.toString.call(A?J[A]:J)===I}}},5166:(C,le,me)=>{var d=me(6425);le.createCodec=Y,le.install=function $(G){for(var D in G)ee.prototype[D]=x(ee.prototype[D],G[D])},le.filter=function E(G){return d(G)?function O(G){return G=G.slice(),function(W){return G.reduce(D,W)};function D(W,B){return B(W)}}(G):G};var H=me(6093);function ee(G){if(!(this instanceof ee))return new ee(G);this.options=G,this.init()}function x(G,D){return G&&D?function W(){return G.apply(this,arguments),D.apply(this,arguments)}:G||D}function Y(G){return new ee(G)}ee.prototype.init=function(){var G=this.options;return G&&G.uint8array&&(this.bufferish=H.Uint8Array),this},le.preset=Y({preset:!0})},9234:(C,le,me)=>{me(8334),me(2732),me(5166)},5333:(C,le,me)=>{le.T=ee;var d=me(8334).preset;function ee($){if(!(this instanceof ee))return new ee($);if($&&(this.options=$,$.codec)){var x=this.codec=$.codec;x.bufferish&&(this.bufferish=x.bufferish)}}me(6473).k.mixin(ee.prototype),ee.prototype.codec=d,ee.prototype.fetch=function(){return this.codec.decode(this)}},9175:(C,le,me)=>{le.decode=function H(ee,$){var x=new d($);return x.write(ee),x.read()};var d=me(5333).T},8131:(C,le,me)=>{var H=me(6654),ee=me(5333).T;function $(x){if(!(this instanceof $))return new $(x);ee.call(this,x)}$.prototype=new ee,H.mixin($.prototype),$.prototype.decode=function(x){arguments.length&&this.write(x),this.flush()},$.prototype.push=function(x){this.emit("data",x)},$.prototype.end=function(x){this.decode(x),this.emit("end")}},8400:(C,le,me)=>{le.F=ee;var d=me(2732).preset;function ee($){if(!(this instanceof ee))return new ee($);if($&&(this.options=$,$.codec)){var x=this.codec=$.codec;x.bufferish&&(this.bufferish=x.bufferish)}}me(6473).I.mixin(ee.prototype),ee.prototype.codec=d,ee.prototype.write=function($){this.codec.encode(this,$)}},8048:(C,le,me)=>{le.encode=function H(ee,$){var x=new d($);return x.write(ee),x.read()};var d=me(8400).F},7704:(C,le,me)=>{var H=me(6654),ee=me(8400).F;function $(x){if(!(this instanceof $))return new $(x);ee.call(this,x)}$.prototype=new ee,H.mixin($.prototype),$.prototype.encode=function(x){this.write(x),this.emit("data",this.read())},$.prototype.end=function(x){arguments.length&&this.encode(x),this.flush(),this.emit("end")}},7846:(C,le,me)=>{le.S=function H(ee,$){if(!(this instanceof H))return new H(ee,$);this.buffer=d.from(ee),this.type=$};var d=me(6093)},4106:(C,le,me)=>{le.setExtPackers=function O(W){W.addExtPacker(14,Error,[D,E]),W.addExtPacker(1,EvalError,[D,E]),W.addExtPacker(2,RangeError,[D,E]),W.addExtPacker(3,ReferenceError,[D,E]),W.addExtPacker(4,SyntaxError,[D,E]),W.addExtPacker(5,TypeError,[D,E]),W.addExtPacker(6,URIError,[D,E]),W.addExtPacker(10,RegExp,[G,E]),W.addExtPacker(11,Boolean,[Y,E]),W.addExtPacker(12,String,[Y,E]),W.addExtPacker(13,Date,[Number,E]),W.addExtPacker(15,Number,[Y,E]),"undefined"!=typeof Uint8Array&&(W.addExtPacker(17,Int8Array,ee),W.addExtPacker(18,Uint8Array,ee),W.addExtPacker(19,Int16Array,ee),W.addExtPacker(20,Uint16Array,ee),W.addExtPacker(21,Int32Array,ee),W.addExtPacker(22,Uint32Array,ee),W.addExtPacker(23,Float32Array,ee),"undefined"!=typeof Float64Array&&W.addExtPacker(24,Float64Array,ee),"undefined"!=typeof Uint8ClampedArray&&W.addExtPacker(25,Uint8ClampedArray,ee),W.addExtPacker(26,ArrayBuffer,ee),W.addExtPacker(29,DataView,ee)),d.hasBuffer&&W.addExtPacker(27,H,d.from)};var $,d=me(6093),H=d.global,ee=d.Uint8Array.from,x={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function E(W){return $||($=me(8048).encode),$(W)}function Y(W){return W.valueOf()}function G(W){(W=RegExp.prototype.toString.call(W).split("/")).shift();var B=[W.pop()];return B.unshift(W.join("/")),B}function D(W){var B={};for(var Z in x)B[Z]=W[Z];return B}},9146:(C,le,me)=>{le.setExtUnpackers=function x(W){W.addExtUnpacker(14,[O,Y(Error)]),W.addExtUnpacker(1,[O,Y(EvalError)]),W.addExtUnpacker(2,[O,Y(RangeError)]),W.addExtUnpacker(3,[O,Y(ReferenceError)]),W.addExtUnpacker(4,[O,Y(SyntaxError)]),W.addExtUnpacker(5,[O,Y(TypeError)]),W.addExtUnpacker(6,[O,Y(URIError)]),W.addExtUnpacker(10,[O,E]),W.addExtUnpacker(11,[O,G(Boolean)]),W.addExtUnpacker(12,[O,G(String)]),W.addExtUnpacker(13,[O,G(Date)]),W.addExtUnpacker(15,[O,G(Number)]),"undefined"!=typeof Uint8Array&&(W.addExtUnpacker(17,G(Int8Array)),W.addExtUnpacker(18,G(Uint8Array)),W.addExtUnpacker(19,[D,G(Int16Array)]),W.addExtUnpacker(20,[D,G(Uint16Array)]),W.addExtUnpacker(21,[D,G(Int32Array)]),W.addExtUnpacker(22,[D,G(Uint32Array)]),W.addExtUnpacker(23,[D,G(Float32Array)]),"undefined"!=typeof Float64Array&&W.addExtUnpacker(24,[D,G(Float64Array)]),"undefined"!=typeof Uint8ClampedArray&&W.addExtUnpacker(25,G(Uint8ClampedArray)),W.addExtUnpacker(26,D),W.addExtUnpacker(29,[D,G(DataView)])),d.hasBuffer&&W.addExtUnpacker(27,G(H))};var ee,d=me(6093),H=d.global,$={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function O(W){return ee||(ee=me(9175).decode),ee(W)}function E(W){return RegExp.apply(null,W)}function Y(W){return function(B){var Z=new W;for(var T in $)Z[T]=B[T];return Z}}function G(W){return function(B){return new W(B)}}function D(W){return new Uint8Array(W).buffer}},1490:(C,le,me)=>{me(8334),me(2732),me(5166)},6473:(C,le,me)=>{le.k=x,le.I=O;var d=me(6093),$="BUFFER_SHORTAGE";function x(){if(!(this instanceof x))return new x}function O(){if(!(this instanceof O))return new O}function G(){throw new Error("method not implemented: write()")}function D(){throw new Error("method not implemented: fetch()")}function W(){return this.buffers&&this.buffers.length?(this.flush(),this.pull()):this.fetch()}function B(j){(this.buffers||(this.buffers=[])).push(j)}function Z(){return(this.buffers||(this.buffers=[])).shift()}function T(j){return function oe(z){for(var q in j)z[q]=j[q];return z}}x.mixin=T(function E(){return{bufferish:d,write:function j(q){var K=this.offset?d.prototype.slice.call(this.buffer,this.offset):this.buffer;this.buffer=K?q?this.bufferish.concat([K,q]):K:q,this.offset=0},fetch:D,flush:function oe(){for(;this.offset<this.buffer.length;){var K,q=this.offset;try{K=this.fetch()}catch(I){if(I&&I.message!=$)throw I;this.offset=q;break}this.push(K)}},push:B,pull:Z,read:W,reserve:function z(q){var K=this.offset,I=K+q;if(I>this.buffer.length)throw new Error($);return this.offset=I,K},offset:0}}()),x.mixin(x.prototype),O.mixin=T(function Y(){return{bufferish:d,write:G,fetch:function j(){var I=this.start;if(I<this.offset){var A=this.start=this.offset;return d.prototype.slice.call(this.buffer,I,A)}},flush:function oe(){for(;this.start<this.offset;){var I=this.fetch();I&&this.push(I)}},push:B,pull:function z(){var I=this.buffers||(this.buffers=[]),A=I.length>1?this.bufferish.concat(I):I[0];return I.length=0,A},read:W,reserve:function q(I){var A=0|I;if(this.buffer){var J=this.buffer.length,L=0|this.offset,S=L+A;if(S<J)return this.offset=S,L;this.flush(),I=Math.max(I,Math.min(2*J,this.maxBufferSize))}return I=Math.max(I,this.minBufferSize),this.buffer=this.bufferish.alloc(I),this.start=0,this.offset=A,0},send:function K(I){var A=I.length;if(A>this.minBufferSize)this.flush(),this.push(I);else{var J=this.reserve(A);d.prototype.copy.call(I,this.buffer,J)}},maxBufferSize:65536,minBufferSize:2048,offset:0,start:0}}()),O.mixin(O.prototype)},8334:(C,le,me)=>{var d=me(7846).S,H=me(9146),ee=me(4613).readUint8,$=me(1788),x=me(5166);function E(){var D=this.options;return this.decode=function O(D){var W=$.getReadToken(D);return function B(Z){var T=ee(Z),j=W[T];if(!j)throw new Error("Invalid type: "+(T&&"0x"+T.toString(16)));return j(Z)}}(D),D&&D.preset&&H.setExtUnpackers(this),this}x.install({addExtUnpacker:function Y(D,W){(this.extUnpackers||(this.extUnpackers=[]))[D]=x.filter(W)},getExtUnpacker:function G(D){return(this.extUnpackers||(this.extUnpackers=[]))[D]||function B(Z){return new d(Z,D)}},init:E}),le.preset=E.call(x.preset)},4613:(C,le,me)=>{var d=me(8461),H=me(6256),ee=H.Uint64BE,$=H.Int64BE;le.getReadFormat=function G(k){var N=k&&k.int64;return{map:E&&k&&k.usemap?W:D,array:B,str:Z,bin:x.hasArrayBuffer&&k&&k.binarraybuffer?j:T,ext:oe,uint8:z,uint16:K,uint32:A,uint64:L(8,N?v:S),int8:q,int16:I,int32:J,int64:L(8,N?P:M),float32:L(4,R),float64:L(8,te)}},le.readUint8=z;var x=me(6093),O=me(5364),E="undefined"!=typeof Map;function D(k,de){var F,N={},g=new Array(de),l=new Array(de),c=k.codec.decode;for(F=0;F<de;F++)g[F]=c(k),l[F]=c(k);for(F=0;F<de;F++)N[g[F]]=l[F];return N}function W(k,de){var F,N=new Map,g=new Array(de),l=new Array(de),c=k.codec.decode;for(F=0;F<de;F++)g[F]=c(k),l[F]=c(k);for(F=0;F<de;F++)N.set(g[F],l[F]);return N}function B(k,de){for(var N=new Array(de),F=k.codec.decode,g=0;g<de;g++)N[g]=F(k);return N}function Z(k,de){var N=k.reserve(de);return O.toString.call(k.buffer,"utf-8",N,N+de)}function T(k,de){var N=k.reserve(de),g=O.slice.call(k.buffer,N,N+de);return x.from(g)}function j(k,de){var N=k.reserve(de),g=O.slice.call(k.buffer,N,N+de);return x.Uint8Array.from(g).buffer}function oe(k,de){var N=k.reserve(de+1),F=k.buffer[N++],g=N+de,l=k.codec.getExtUnpacker(F);if(!l)throw new Error("Invalid ext type: "+(F&&"0x"+F.toString(16)));return l(O.slice.call(k.buffer,N,g))}function z(k){var de=k.reserve(1);return k.buffer[de]}function q(k){var de=k.reserve(1),N=k.buffer[de];return 128&N?N-256:N}function K(k){var de=k.reserve(2),N=k.buffer;return N[de++]<<8|N[de]}function I(k){var de=k.reserve(2),N=k.buffer,F=N[de++]<<8|N[de];return 32768&F?F-65536:F}function A(k){var de=k.reserve(4),N=k.buffer;return 16777216*N[de++]+(N[de++]<<16)+(N[de++]<<8)+N[de]}function J(k){var de=k.reserve(4),N=k.buffer;return N[de++]<<24|N[de++]<<16|N[de++]<<8|N[de]}function L(k,de){return function(N){var F=N.reserve(k);return de.call(N.buffer,F,!0)}}function S(k){return new ee(this,k).toNumber()}function M(k){return new $(this,k).toNumber()}function v(k){return new ee(this,k)}function P(k){return new $(this,k)}function R(k){return d.read(this,k,!1,23,4)}function te(k){return d.read(this,k,!1,52,8)}},1788:(C,le,me)=>{var d=me(4613);function ee(Y){var G,D=new Array(256);for(G=0;G<=127;G++)D[G]=x(G);for(G=128;G<=143;G++)D[G]=E(G-128,Y.map);for(G=144;G<=159;G++)D[G]=E(G-144,Y.array);for(G=160;G<=191;G++)D[G]=E(G-160,Y.str);for(D[192]=x(null),D[193]=null,D[194]=x(!1),D[195]=x(!0),D[196]=O(Y.uint8,Y.bin),D[197]=O(Y.uint16,Y.bin),D[198]=O(Y.uint32,Y.bin),D[199]=O(Y.uint8,Y.ext),D[200]=O(Y.uint16,Y.ext),D[201]=O(Y.uint32,Y.ext),D[202]=Y.float32,D[203]=Y.float64,D[204]=Y.uint8,D[205]=Y.uint16,D[206]=Y.uint32,D[207]=Y.uint64,D[208]=Y.int8,D[209]=Y.int16,D[210]=Y.int32,D[211]=Y.int64,D[212]=E(1,Y.ext),D[213]=E(2,Y.ext),D[214]=E(4,Y.ext),D[215]=E(8,Y.ext),D[216]=E(16,Y.ext),D[217]=O(Y.uint8,Y.str),D[218]=O(Y.uint16,Y.str),D[219]=O(Y.uint32,Y.str),D[220]=O(Y.uint16,Y.array),D[221]=O(Y.uint32,Y.array),D[222]=O(Y.uint16,Y.map),D[223]=O(Y.uint32,Y.map),G=224;G<=255;G++)D[G]=x(G-256);return D}function x(Y){return function(){return Y}}function O(Y,G){return function(D){var W=Y(D);return G(D,W)}}function E(Y,G){return function(D){return G(D,Y)}}le.getReadToken=function H(Y){var G=d.getReadFormat(Y);return Y&&Y.useraw?function $(Y){var G,D=ee(Y).slice();for(D[217]=D[196],D[218]=D[197],D[219]=D[198],G=160;G<=191;G++)D[G]=E(G-160,Y.bin);return D}(G):ee(G)}},2732:(C,le,me)=>{var d=me(7846).S,H=me(4106),ee=me(9118),$=me(5166);function O(){var G=this.options;return this.encode=function x(G){var D=ee.getWriteType(G);return function W(B,Z){var T=D[typeof Z];if(!T)throw new Error('Unsupported type "'+typeof Z+'": '+Z);T(B,Z)}}(G),G&&G.preset&&H.setExtPackers(this),this}$.install({addExtPacker:function E(G,D,W){W=$.filter(W);var B=D.name;function j(oe){return W&&(oe=W(oe)),new d(oe,G)}B&&"Object"!==B?(this.extPackers||(this.extPackers={}))[B]=j:(this.extEncoderList||(this.extEncoderList=[])).unshift([D,j])},getExtPacker:function Y(G){var D=this.extPackers||(this.extPackers={}),W=G.constructor,B=W&&W.name&&D[W.name];if(B)return B;for(var Z=this.extEncoderList||(this.extEncoderList=[]),T=Z.length,j=0;j<T;j++){var oe=Z[j];if(W===oe[0])return oe[1]}},init:O}),le.preset=O.call($.preset)},3041:(C,le,me)=>{var d=me(8461),H=me(6256),ee=H.Uint64BE,$=H.Int64BE,x=me(8323).w,O=me(6093),E=O.global,G=O.hasBuffer&&"TYPED_ARRAY_SUPPORT"in E&&!E.TYPED_ARRAY_SUPPORT,D=O.hasBuffer&&E.prototype||{};function Z(){var L=x.slice();return L[196]=j(196),L[197]=oe(197),L[198]=z(198),L[199]=j(199),L[200]=oe(200),L[201]=z(201),L[202]=q(202,4,D.writeFloatBE||A,!0),L[203]=q(203,8,D.writeDoubleBE||J,!0),L[204]=j(204),L[205]=oe(205),L[206]=z(206),L[207]=q(207,8,K),L[208]=j(208),L[209]=oe(209),L[210]=z(210),L[211]=q(211,8,I),L[217]=j(217),L[218]=oe(218),L[219]=z(219),L[220]=oe(220),L[221]=z(221),L[222]=oe(222),L[223]=z(223),L}function j(L){return function(S,M){var v=S.reserve(2),P=S.buffer;P[v++]=L,P[v]=M}}function oe(L){return function(S,M){var v=S.reserve(3),P=S.buffer;P[v++]=L,P[v++]=M>>>8,P[v]=M}}function z(L){return function(S,M){var v=S.reserve(5),P=S.buffer;P[v++]=L,P[v++]=M>>>24,P[v++]=M>>>16,P[v++]=M>>>8,P[v]=M}}function q(L,S,M,v){return function(P,R){var te=P.reserve(S+1);P.buffer[te++]=L,M.call(P.buffer,R,te,v)}}function K(L,S){new ee(this,S,L)}function I(L,S){new $(this,S,L)}function A(L,S){d.write(this,L,S,!1,23,4)}function J(L,S){d.write(this,L,S,!1,52,8)}le.getWriteToken=function W(L){return L&&L.uint8array?function B(){var L=Z();return L[202]=q(202,4,A),L[203]=q(203,8,J),L}():G||O.hasBuffer&&L&&L.safe?function T(){var L=x.slice();return L[196]=q(196,1,E.prototype.writeUInt8),L[197]=q(197,2,E.prototype.writeUInt16BE),L[198]=q(198,4,E.prototype.writeUInt32BE),L[199]=q(199,1,E.prototype.writeUInt8),L[200]=q(200,2,E.prototype.writeUInt16BE),L[201]=q(201,4,E.prototype.writeUInt32BE),L[202]=q(202,4,E.prototype.writeFloatBE),L[203]=q(203,8,E.prototype.writeDoubleBE),L[204]=q(204,1,E.prototype.writeUInt8),L[205]=q(205,2,E.prototype.writeUInt16BE),L[206]=q(206,4,E.prototype.writeUInt32BE),L[207]=q(207,8,K),L[208]=q(208,1,E.prototype.writeInt8),L[209]=q(209,2,E.prototype.writeInt16BE),L[210]=q(210,4,E.prototype.writeInt32BE),L[211]=q(211,8,I),L[217]=q(217,1,E.prototype.writeUInt8),L[218]=q(218,2,E.prototype.writeUInt16BE),L[219]=q(219,4,E.prototype.writeUInt32BE),L[220]=q(220,2,E.prototype.writeUInt16BE),L[221]=q(221,4,E.prototype.writeUInt32BE),L[222]=q(222,2,E.prototype.writeUInt16BE),L[223]=q(223,4,E.prototype.writeUInt32BE),L}():Z()}},9118:(C,le,me)=>{var d=me(6425),H=me(6256),ee=H.Uint64BE,$=H.Int64BE,x=me(6093),O=me(5364),E=me(3041),Y=me(8323).w,G=me(7846).S,D="undefined"!=typeof Uint8Array,W="undefined"!=typeof Map,B=[];B[1]=212,B[2]=213,B[4]=214,B[8]=215,B[16]=216,le.getWriteType=function Z(T){var j=E.getWriteToken(T),oe=T&&T.useraw,z=D&&T&&T.binarraybuffer,q=z?x.isArrayBuffer:x.isBuffer,K=z?function l(_,y){g(_,new Uint8Array(y))}:g,A=W&&T&&T.usemap?function u(_,y){if(!(y instanceof Map))return f(_,y);var m=y.size;j[m<16?128+m:m<=65535?222:223](_,m);var se=_.codec.encode;y.forEach(function(Ee,ke,ce){se(_,ke),se(_,Ee)})}:f;return{boolean:function L(_,y){j[y?195:194](_,y)},function:N,number:function S(_,y){var m=0|y;y===m?j[-32<=m&&m<=127?255&m:0<=m?m<=255?204:m<=65535?205:206:-128<=m?208:-32768<=m?209:210](_,m):j[203](_,y)},object:oe?function de(_,y){if(q(y))return function p(_,y){var m=y.length;j[m<32?160+m:m<=65535?218:219](_,m),_.send(y)}(_,y);k(_,y)}:k,string:function te(_){return function y(m,ne){var se=ne.length;m.offset=m.reserve(5+3*se);var ke=m.buffer,ce=_(se),Me=m.offset+ce;se=O.write.call(ke,ne,Me);var $e=_(se);ce!==$e&&O.copy.call(ke,ke,Me+$e-ce,Me,Me+se),j[1===$e?160+se:$e<=3?215+$e:219](m,se),m.offset+=se}}(oe?function R(_){return _<32?1:_<=65535?3:5}:function P(_){return _<32?1:_<=255?2:_<=65535?3:5}),symbol:N,undefined:N};function k(_,y){if(null===y)return N(_,y);if(q(y))return K(_,y);if(d(y))return function F(_,y){var m=y.length;j[m<16?144+m:m<=65535?220:221](_,m);for(var se=_.codec.encode,Ee=0;Ee<m;Ee++)se(_,y[Ee])}(_,y);if(ee.isUint64BE(y))return function M(_,y){j[207](_,y.toArray())}(_,y);if($.isInt64BE(y))return function v(_,y){j[211](_,y.toArray())}(_,y);var m=_.codec.getExtPacker(y);if(m&&(y=m(y)),y instanceof G)return function c(_,y){var m=y.buffer,ne=m.length;j[B[ne]||(ne<255?199:ne<=65535?200:201)](_,ne),Y[y.type](_),_.send(m)}(_,y);A(_,y)}function N(_,y){j[192](_,y)}function g(_,y){var m=y.length;j[m<255?196:m<=65535?197:198](_,m),_.send(y)}function f(_,y){var m=Object.keys(y),ne=m.length;j[ne<16?128+ne:ne<=65535?222:223](_,ne);var Ee=_.codec.encode;m.forEach(function(ke){Ee(_,ke),Ee(_,y[ke])})}}},8323:(C,le)=>{for(var me=le.w=new Array(256),d=0;d<=255;d++)me[d]=H(d);function H(ee){return function($){var x=$.reserve(1);$.buffer[x]=ee}}},1203:C=>{function le(ee){var $="    ";if(isNaN(parseInt(ee)))$=ee;else switch(ee){case 1:$=" ";break;case 2:$="  ";break;case 3:$="   ";break;case 4:$="    ";break;case 5:$="     ";break;case 6:$="      ";break;case 7:$="       ";break;case 8:$="        ";break;case 9:$="         ";break;case 10:$="          ";break;case 11:$="           ";break;case 12:$="            "}for(var x=["\n"],O=0;O<100;O++)x.push(x[O]+$);return x}function me(){this.step="    ",this.shift=le(this.step)}function d(ee,$){return $-(ee.replace(/\(/g,"").length-ee.replace(/\)/g,"").length)}function H(ee,$){return ee.replace(/\s{1,}/g," ").replace(/ AND /gi,"~::~"+$+$+"AND ").replace(/ BETWEEN /gi,"~::~"+$+"BETWEEN ").replace(/ CASE /gi,"~::~"+$+"CASE ").replace(/ ELSE /gi,"~::~"+$+"ELSE ").replace(/ END /gi,"~::~"+$+"END ").replace(/ FROM /gi,"~::~FROM ").replace(/ GROUP\s{1,}BY/gi,"~::~GROUP BY ").replace(/ HAVING /gi,"~::~HAVING ").replace(/ IN /gi," IN ").replace(/ JOIN /gi,"~::~JOIN ").replace(/ CROSS~::~{1,}JOIN /gi,"~::~CROSS JOIN ").replace(/ INNER~::~{1,}JOIN /gi,"~::~INNER JOIN ").replace(/ LEFT~::~{1,}JOIN /gi,"~::~LEFT JOIN ").replace(/ RIGHT~::~{1,}JOIN /gi,"~::~RIGHT JOIN ").replace(/ ON /gi,"~::~"+$+"ON ").replace(/ OR /gi,"~::~"+$+$+"OR ").replace(/ ORDER\s{1,}BY/gi,"~::~ORDER BY ").replace(/ OVER /gi,"~::~"+$+"OVER ").replace(/\(\s{0,}SELECT /gi,"~::~(SELECT ").replace(/\)\s{0,}SELECT /gi,")~::~SELECT ").replace(/ THEN /gi," THEN~::~"+$).replace(/ UNION /gi,"~::~UNION~::~").replace(/ USING /gi,"~::~USING ").replace(/ WHEN /gi,"~::~"+$+"WHEN ").replace(/ WHERE /gi,"~::~WHERE ").replace(/ WITH /gi,"~::~WITH ").replace(/ ALL /gi," ALL ").replace(/ AS /gi," AS ").replace(/ ASC /gi," ASC ").replace(/ DESC /gi," DESC ").replace(/ DISTINCT /gi," DISTINCT ").replace(/ EXISTS /gi," EXISTS ").replace(/ NOT /gi," NOT ").replace(/ NULL /gi," NULL ").replace(/ LIKE /gi," LIKE ").replace(/\s{0,}SELECT /gi,"SELECT ").replace(/\s{0,}UPDATE /gi,"UPDATE ").replace(/ SET /gi," SET ").replace(/~::~{1,}/g,"~::~").split("~::~")}me.prototype.xml=function(ee,$){var x=ee.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").replace(/\s*xmlns\=/g,"~::~xmlns=").split("~::~"),O=x.length,E=!1,Y=0,G="",D=0,W=$?le($):this.shift;for(D=0;D<O;D++)x[D].search(/<!/)>-1?(G+=W[Y]+x[D],E=!0,(x[D].search(/-->/)>-1||x[D].search(/\]>/)>-1||x[D].search(/!DOCTYPE/)>-1)&&(E=!1)):x[D].search(/-->/)>-1||x[D].search(/\]>/)>-1?(G+=x[D],E=!1):/^<\w/.exec(x[D-1])&&/^<\/\w/.exec(x[D])&&/^<[\w:\-\.\,]+/.exec(x[D-1])==/^<\/[\w:\-\.\,]+/.exec(x[D])[0].replace("/","")?(G+=x[D],E||Y--):x[D].search(/<\w/)>-1&&-1==x[D].search(/<\//)&&-1==x[D].search(/\/>/)?G=G+=E?x[D]:W[Y++]+x[D]:x[D].search(/<\w/)>-1&&x[D].search(/<\//)>-1?G=G+=E?x[D]:W[Y]+x[D]:x[D].search(/<\//)>-1?G=G+=E?x[D]:W[--Y]+x[D]:x[D].search(/\/>/)>-1?G=G+=E?x[D]:W[Y]+x[D]:x[D].search(/<\?/)>-1||x[D].search(/xmlns\:/)>-1||x[D].search(/xmlns\=/)>-1?G+=W[Y]+x[D]:G+=x[D];return"\n"==G[0]?G.slice(1):G},me.prototype.json=function(ee,x){return x=x||this.step,"undefined"==typeof JSON?ee:"string"==typeof ee?JSON.stringify(JSON.parse(ee),null,x):"object"==typeof ee?JSON.stringify(ee,null,x):ee},me.prototype.css=function(ee,$){var x=ee.replace(/\s{1,}/g," ").replace(/\{/g,"{~::~").replace(/\}/g,"~::~}~::~").replace(/\;/g,";~::~").replace(/\/\*/g,"~::~/*").replace(/\*\//g,"*/~::~").replace(/~::~\s{0,}~::~/g,"~::~").split("~::~"),O=x.length,E=0,Y="",G=0,D=$?le($):this.shift;for(G=0;G<O;G++)/\{/.exec(x[G])?Y+=D[E++]+x[G]:/\}/.exec(x[G])?Y+=D[--E]+x[G]:(/\*\\/.exec(x[G]),Y+=D[E]+x[G]);return Y.replace(/^\n{1,}/,"")},me.prototype.sql=function(ee,$){var x=ee.replace(/\s{1,}/g," ").replace(/\'/gi,"~::~'").split("~::~"),O=x.length,E=[],Y=0,G=this.step,B=0,Z="",T=0,j=$?le($):this.shift;for(T=0;T<O;T++)E=E.concat(T%2?x[T]:H(x[T],G));for(O=E.length,T=0;T<O;T++)B=d(E[T],B),/\s{0,}\s{0,}SELECT\s{0,}/.exec(E[T])&&(E[T]=E[T].replace(/\,/g,",\n"+G+G)),/\s{0,}\s{0,}SET\s{0,}/.exec(E[T])&&(E[T]=E[T].replace(/\,/g,",\n"+G+G)),/\s{0,}\(\s{0,}SELECT\s{0,}/.exec(E[T])?Z+=j[++Y]+E[T]:/\'/.exec(E[T])?(B<1&&Y&&Y--,Z+=E[T]):(Z+=j[Y]+E[T],B<1&&Y&&Y--);return Z.replace(/^\n{1,}/,"").replace(/\n{1,}/g,"\n")},me.prototype.xmlmin=function(ee,$){return($?ee:ee.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"").replace(/[ \r\n\t]{1,}xmlns/g," xmlns")).replace(/>\s{0,}</g,"><")},me.prototype.jsonmin=function(ee){return"undefined"==typeof JSON?ee:JSON.stringify(JSON.parse(ee),null,0)},me.prototype.cssmin=function(ee,$){return($?ee:ee.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\//g,"")).replace(/\s{1,}/g," ").replace(/\{\s{1,}/g,"{").replace(/\}\s{1,}/g,"}").replace(/\;\s{1,}/g,";").replace(/\/\*\s{1,}/g,"/*").replace(/\*\/\s{1,}/g,"*/")},me.prototype.sqlmin=function(ee){return ee.replace(/\s{1,}/g," ").replace(/\s{1,}\(/,"(").replace(/\s{1,}\)/,")")},C.exports=new me},85:(C,le,me)=>{var d={"./AFF2e":[7676,7327],"./AFF2e.js":[7676,7327],"./AceKillerGene":[1439,7217],"./AceKillerGene.js":[1439,7217],"./Ainecadette":[2160,8150],"./Ainecadette.js":[2160,8150],"./Airgetlamh":[6408,5247],"./Airgetlamh.js":[6408,5247],"./AlchemiaStruggle":[6510,5225],"./AlchemiaStruggle.js":[6510,5225],"./Alsetto":[905,2948],"./Alsetto.js":[905,2948],"./Alshard":[7058,6420],"./Alshard.js":[7058,6420],"./AlterRaise":[1105,3385],"./AlterRaise.js":[1105,3385],"./Amadeus":[5752,1582],"./Amadeus.js":[5752,1582],"./Amadeus_Korean":[6602,5512],"./Amadeus_Korean.js":[6602,5512],"./AngelGear":[4200,9437],"./AngelGear.js":[4200,9437],"./AnimaAnimus":[7164,2919],"./AnimaAnimus.js":[7164,2919],"./Aoharubaan":[5757,6968],"./Aoharubaan.js":[5757,6968],"./Arianrhod":[4005,5283],"./Arianrhod.js":[4005,5283],"./ArsMagica":[3655,5734],"./ArsMagica.js":[3655,5734],"./AssaultEngine":[3898,4339],"./AssaultEngine.js":[3898,4339],"./Avandner":[8206,3084],"./Avandner.js":[8206,3084],"./Ayabito":[5853,1253],"./Ayabito.js":[5853,1253],"./BBN":[8554,2522],"./BBN.js":[8554,2522],"./BadLife":[9538,4872],"./BadLife.js":[9538,4872],"./Bakenokawa":[6103,2135],"./Bakenokawa.js":[6103,2135],"./BarnaKronika":[5396,7073],"./BarnaKronika.js":[5396,7073],"./BattleTech":[2890,6344],"./BattleTech.js":[2890,6344],"./BeastBindTrinity":[1063,4572],"./BeastBindTrinity.js":[1063,4572],"./BeginningIdol":[8857,66],"./BeginningIdol.js":[8857,66],"./BeginningIdol2022":[8381,6466],"./BeginningIdol2022.js":[8381,6466],"./BeginningIdol_Korean":[7816,7117],"./BeginningIdol_Korean.js":[7816,7117],"./BladeOfArcana":[3449,1087],"./BladeOfArcana.js":[3449,1087],"./BlindMythos":[2639,5539],"./BlindMythos.js":[2639,5539],"./BloodCrusade":[2906,2013],"./BloodCrusade.js":[2906,2013],"./BloodMoon":[7994,593],"./BloodMoon.js":[7994,593],"./Bloodorium":[3498,3312],"./Bloodorium.js":[3498,3312],"./CardRanker":[6006,873],"./CardRanker.js":[6006,873],"./CastleInGray":[2519,1820],"./CastleInGray.js":[2519,1820],"./ChaosFlare":[229,1114],"./ChaosFlare.js":[229,1114],"./Chill":[9894,1919],"./Chill.js":[9894,1919],"./Chill3":[3294,8585],"./Chill3.js":[3294,8585],"./CodeLayerd":[6106,9606],"./CodeLayerd.js":[6106,9606],"./ColossalHunter":[519,2461],"./ColossalHunter.js":[519,2461],"./Comes":[1712,2793],"./Comes.js":[1712,2793],"./ConvictorDrive":[1011,8138],"./ConvictorDrive.js":[1011,8138],"./CrashWorld":[6506,2519],"./CrashWorld.js":[6506,2519],"./Cthulhu":[2605,3364],"./Cthulhu.js":[2605,3364],"./Cthulhu7th":[5149,8376],"./Cthulhu7th.js":[5149,8376],"./Cthulhu7th_ChineseTraditional":[9464,6447],"./Cthulhu7th_ChineseTraditional.js":[9464,6447],"./Cthulhu7th_Korean":[329,7170],"./Cthulhu7th_Korean.js":[329,7170],"./CthulhuTech":[9818,2555],"./CthulhuTech.js":[9818,2555],"./Cthulhu_ChineseTraditional":[3109,9285],"./Cthulhu_ChineseTraditional.js":[3109,9285],"./Cthulhu_Korean":[9585,7008],"./Cthulhu_Korean.js":[9585,7008],"./Cthulhu_SimplifiedChinese":[4916,1448],"./Cthulhu_SimplifiedChinese.js":[4916,1448],"./CyberpunkRed":[1933,347],"./CyberpunkRed.js":[1933,347],"./DarkBlaze":[7810,3005],"./DarkBlaze.js":[7810,3005],"./DarkDaysDrive":[3543,5736],"./DarkDaysDrive.js":[3543,5736],"./DarkSouls":[5581,3958],"./DarkSouls.js":[5581,3958],"./DeadlineHeroes":[2270,6143],"./DeadlineHeroes.js":[2270,6143],"./DemonParasite":[7605,5670],"./DemonParasite.js":[7605,5670],"./DesperateRun":[8999,148],"./DesperateRun.js":[8999,148],"./DetatokoSaga":[3264,5413],"./DetatokoSaga.js":[3264,5413],"./DetatokoSaga_Korean":[4236,7553],"./DetatokoSaga_Korean.js":[4236,7553],"./DiceBot":[8618,8159],"./DiceBot.js":[8618,8159],"./DiceOfTheDead":[2533,5651],"./DiceOfTheDead.js":[2533,5651],"./DoubleCross":[1316,8436],"./DoubleCross.js":[1316,8436],"./DoubleCross_Korean":[9761,6708],"./DoubleCross_Korean.js":[9761,6708],"./Dracurouge":[2204,2697],"./Dracurouge.js":[2204,2697],"./Dracurouge_Korean":[759,9678],"./Dracurouge_Korean.js":[759,9678],"./DungeonsAndDragons":[8454,8358],"./DungeonsAndDragons.js":[8454,8358],"./DungeonsAndDragons5":[9781,1125],"./DungeonsAndDragons5.js":[9781,1125],"./EarthDawn":[1329,517],"./EarthDawn.js":[1329,517],"./EarthDawn3":[4021,9730],"./EarthDawn3.js":[4021,9730],"./EarthDawn4":[9918,809],"./EarthDawn4.js":[9918,809],"./EclipsePhase":[410,9735],"./EclipsePhase.js":[410,9735],"./Elric":[8326,7309],"./Elric.js":[8326,7309],"./Elysion":[9626,7372],"./Elysion.js":[9626,7372],"./EmbryoMachine":[2035,9755],"./EmbryoMachine.js":[2035,9755],"./Emoklore":[8686,5620],"./Emoklore.js":[8686,5620],"./EndBreaker":[4869,3515],"./EndBreaker.js":[4869,3515],"./EtrianOdysseySRS":[3460,1851],"./EtrianOdysseySRS.js":[3460,1851],"./FateCoreSystem":[5925,5899],"./FateCoreSystem.js":[5925,5899],"./Fiasco":[6587,6739],"./Fiasco.js":[6587,6739],"./Fiasco_Korean":[3734,7036],"./Fiasco_Korean.js":[3734,7036],"./FilledWith":[4239,6705],"./FilledWith.js":[4239,6705],"./FullMetalPanic":[1959,8725],"./FullMetalPanic.js":[1959,8725],"./FutariSousa":[2729,4564],"./FutariSousa.js":[2729,4564],"./FutariSousa_Korean":[4424,8175],"./FutariSousa_Korean.js":[4424,8175],"./GURPS":[7782,6908],"./GURPS.js":[7782,6908],"./Garako":[1948,8165],"./Garako.js":[1948,8165],"./GardenOrder":[2017,172],"./GardenOrder.js":[2017,172],"./GehennaAn":[1647,5105],"./GehennaAn.js":[1647,5105],"./GeishaGirlwithKatana":[5593,8780],"./GeishaGirlwithKatana.js":[5593,8780],"./GhostLive":[4656,9626],"./GhostLive.js":[4656,9626],"./GoblinSlayer":[3983,2006],"./GoblinSlayer.js":[3983,2006],"./GoldenSkyStories":[3437,9940],"./GoldenSkyStories.js":[3437,9940],"./Gorilla":[6362,7576],"./Gorilla.js":[6362,7576],"./GranCrest":[7150,6613],"./GranCrest.js":[7150,6613],"./Gundog":[8166,6501],"./Gundog.js":[8166,6501],"./GundogRevised":[4196,427],"./GundogRevised.js":[4196,427],"./GundogZero":[5273,493],"./GundogZero.js":[5273,493],"./GurpsFW":[882,6949],"./GurpsFW.js":[882,6949],"./HarnMaster":[6765,4075],"./HarnMaster.js":[6765,4075],"./HatsuneMiku":[3124,6589],"./HatsuneMiku.js":[3124,6589],"./Hieizan":[7418,8171],"./Hieizan.js":[7418,8171],"./HouraiGakuen":[7945,7155],"./HouraiGakuen.js":[7945,7155],"./HunterTheReckoning5th":[7434,3191],"./HunterTheReckoning5th.js":[7434,3191],"./HuntersMoon":[4873,1909],"./HuntersMoon.js":[4873,1909],"./IfIfIf":[7043,4507],"./IfIfIf.js":[7043,4507],"./Illusio":[3843,4796],"./Illusio.js":[3843,4796],"./InfiniteBabeL":[7878,7641],"./InfiniteBabeL.js":[7878,7641],"./InfiniteFantasia":[6391,391],"./InfiniteFantasia.js":[6391,391],"./Insane":[5844,9001],"./Insane.js":[5844,9001],"./Insane_Korean":[9199,1918],"./Insane_Korean.js":[9199,1918],"./Irisbane":[4167,6957],"./Irisbane.js":[4167,6957],"./IthaWenUa":[2726,9872],"./IthaWenUa.js":[2726,9872],"./JamesBond":[4866,7097],"./JamesBond.js":[4866,7097],"./JekyllAndHyde":[817,4788],"./JekyllAndHyde.js":[817,4788],"./JuinKansen":[9673,9327],"./JuinKansen.js":[9673,9327],"./Kamigakari":[2920,8602],"./Kamigakari.js":[2920,8602],"./Kamigakari_Korean":[6250,5309],"./Kamigakari_Korean.js":[6250,5309],"./KanColle":[4670,2098],"./KanColle.js":[4670,2098],"./Karukami":[2838,1616],"./Karukami.js":[2838,1616],"./KemonoNoMori":[1151,3962],"./KemonoNoMori.js":[1151,3962],"./KillDeathBusiness":[744,6750],"./KillDeathBusiness.js":[744,6750],"./KillDeathBusiness_Korean":[346,4401],"./KillDeathBusiness_Korean.js":[346,4401],"./KurayamiCrying":[5627,164],"./KurayamiCrying.js":[5627,164],"./Kutulu":[76,8790],"./Kutulu.js":[76,8790],"./LiveraDoll":[6459,8440],"./LiveraDoll.js":[6459,8440],"./LogHorizon":[8991,4810],"./LogHorizon.js":[8991,4810],"./LogHorizon_Korean":[8959,348],"./LogHorizon_Korean.js":[8959,348],"./LostRecord":[6543,7171],"./LostRecord.js":[6543,7171],"./LostRoyal":[9348,9625],"./LostRoyal.js":[9348,9625],"./MagicaLogia":[5563,2399],"./MagicaLogia.js":[5563,2399],"./MagicaLogia_Korean":[2586,7729],"./MagicaLogia_Korean.js":[2586,7729],"./MagicaLogia_SimplifiedChinese":[3677,6875],"./MagicaLogia_SimplifiedChinese.js":[3677,6875],"./MeikyuDays":[3433,1493],"./MeikyuDays.js":[3433,1493],"./MeikyuKingdom":[9889,8326],"./MeikyuKingdom.js":[9889,8326],"./MeikyuKingdomBasic":[668,7016],"./MeikyuKingdomBasic.js":[668,7016],"./MetalHead":[1175,7276],"./MetalHead.js":[1175,7276],"./MetalHeadExtream":[1587,3062],"./MetalHeadExtream.js":[1587,3062],"./MetallicGuardian":[1245,2040],"./MetallicGuardian.js":[1245,2040],"./MonotoneMuseum":[4351,735],"./MonotoneMuseum.js":[4351,735],"./MonotoneMuseum_Korean":[3989,5249],"./MonotoneMuseum_Korean.js":[3989,5249],"./NSSQ":[6681,4238],"./NSSQ.js":[6681,4238],"./Nechronica":[8885,3532],"./Nechronica.js":[8885,3532],"./Nechronica_Korean":[4361,4116],"./Nechronica_Korean.js":[4361,4116],"./NeverCloud":[9447,3096],"./NeverCloud.js":[9447,3096],"./NightWizard":[7740,5811],"./NightWizard.js":[7740,5811],"./NightWizard3rd":[4933,3535],"./NightWizard3rd.js":[4933,3535],"./NightmareHunterDeep":[1387,298],"./NightmareHunterDeep.js":[1387,298],"./NinjaSlayer":[517,7381],"./NinjaSlayer.js":[517,7381],"./NjslyrBattle":[596,3443],"./NjslyrBattle.js":[596,3443],"./NobunagasBlackCastle":[1067,6652],"./NobunagasBlackCastle.js":[1067,6652],"./Nuekagami":[1848,3293],"./Nuekagami.js":[1848,3293],"./OneWayHeroics":[1989,3852],"./OneWayHeroics.js":[1989,3852],"./OracleEngine":[978,2989],"./OracleEngine.js":[978,2989],"./OrgaRain":[8614,644],"./OrgaRain.js":[8614,644],"./Oukahoushin3rd":[7133,3407],"./Oukahoushin3rd.js":[7133,3407],"./Paradiso":[2313,4246],"./Paradiso.js":[2313,4246],"./Paranoia":[6634,1031],"./Paranoia.js":[6634,1031],"./ParanoiaRebooted":[9628,5289],"./ParanoiaRebooted.js":[9628,5289],"./ParasiteBlood":[8073,1410],"./ParasiteBlood.js":[8073,1410],"./Pathfinder":[5017,1599],"./Pathfinder.js":[5017,1599],"./Peekaboo":[9309,844],"./Peekaboo.js":[9309,844],"./Pendragon":[9113,2311],"./Pendragon.js":[9113,2311],"./PersonaO":[6706,481],"./PersonaO.js":[6706,481],"./PhantasmAdventure":[926,8614],"./PhantasmAdventure.js":[926,8614],"./Postman":[3021,5124],"./Postman.js":[3021,5124],"./PulpCthulhu":[4292,9449],"./PulpCthulhu.js":[4292,9449],"./Raisondetre":[2909,293],"./Raisondetre.js":[2909,293],"./RecordOfLodossWar":[1925,281],"./RecordOfLodossWar.js":[1925,281],"./RecordOfSteam":[1293,2213],"./RecordOfSteam.js":[1293,2213],"./Revulture":[573,9886],"./Revulture.js":[573,9886],"./RokumonSekai2":[3592,9495],"./RokumonSekai2.js":[3592,9495],"./RoleMaster":[7612,2625],"./RoleMaster.js":[7612,2625],"./RuinBreakers":[1349,7696],"./RuinBreakers.js":[1349,7696],"./RuneQuest":[7543,7480],"./RuneQuest.js":[7543,7480],"./RyuTuber":[1287,1766],"./RyuTuber.js":[1287,1766],"./Ryutama":[8123,585],"./Ryutama.js":[8123,585],"./SRS":[5762,1377],"./SRS.js":[5762,1377],"./SajinsenkiAGuS":[4969,5034],"./SajinsenkiAGuS.js":[4969,5034],"./SamsaraBallad":[2255,2250],"./SamsaraBallad.js":[2255,2250],"./Satasupe":[8236,3314],"./Satasupe.js":[8236,3314],"./ScreamHighSchool":[7728,512],"./ScreamHighSchool.js":[7728,512],"./Sengensyou":[1369,3109],"./Sengensyou.js":[1369,3109],"./SevenFortressMobius":[2004,1091],"./SevenFortressMobius.js":[2004,1091],"./ShadowRun":[7633,8975],"./ShadowRun.js":[7633,8975],"./ShadowRun4":[8489,5925],"./ShadowRun4.js":[8489,5925],"./ShadowRun5":[3265,3665],"./ShadowRun5.js":[3265,3665],"./SharedFantasia":[554,2025],"./SharedFantasia.js":[554,2025],"./ShinMegamiTenseiKakuseihen":[6821,8657],"./ShinMegamiTenseiKakuseihen.js":[6821,8657],"./ShinkuuGakuen":[708,1763],"./ShinkuuGakuen.js":[708,1763],"./ShinobiGami":[1946,132],"./ShinobiGami.js":[1946,132],"./Shiranui":[9776,2709],"./Shiranui.js":[9776,2709],"./ShoujoTenrankai":[8491,8565],"./ShoujoTenrankai.js":[8491,8565],"./ShuumatsuKikou":[918,533],"./ShuumatsuKikou.js":[918,533],"./Skynauts":[8327,5150],"./Skynauts.js":[8327,5150],"./SkynautsBouken":[5444,303],"./SkynautsBouken.js":[5444,303],"./StarryDolls":[783,9354],"./StarryDolls.js":[783,9354],"./SteamPunkers":[6339,7103],"./SteamPunkers.js":[6339,7103],"./StellarKnights":[5849,628],"./StellarKnights.js":[5849,628],"./StellarKnights_Korean":[2795,6768],"./StellarKnights_Korean.js":[2795,6768],"./StellarLife":[8594,3740],"./StellarLife.js":[8594,3740],"./StrangerOfSwordCity":[5214,1593],"./StrangerOfSwordCity.js":[5214,1593],"./StratoShout":[203,8470],"./StratoShout.js":[203,8470],"./StratoShout_Korean":[2030,6114],"./StratoShout_Korean.js":[2030,6114],"./Strave":[1758,8233],"./Strave.js":[1758,8233],"./SwordWorld":[8250,3210],"./SwordWorld.js":[8250,3210],"./SwordWorld2_0":[3840,7043],"./SwordWorld2_0.js":[3840,7043],"./SwordWorld2_0_SimplifiedChinese":[206,8196],"./SwordWorld2_0_SimplifiedChinese.js":[206,8196],"./SwordWorld2_5":[9527,9753],"./SwordWorld2_5.js":[9527,9753],"./SwordWorld2_5_SimplifiedChinese":[8463,6152],"./SwordWorld2_5_SimplifiedChinese.js":[8463,6152],"./SwordWorld_SimplifiedChinese":[7184,9640],"./SwordWorld_SimplifiedChinese.js":[7184,9640],"./TalesFromTheLoop":[4331,1982],"./TalesFromTheLoop.js":[4331,1982],"./TherapieSein":[4028,5405],"./TherapieSein.js":[4028,5405],"./TokumeiTenkousei":[4905,5101],"./TokumeiTenkousei.js":[4905,5101],"./TokyoGhostResearch":[3874,2686],"./TokyoGhostResearch.js":[3874,2686],"./TokyoNova":[7459,7455],"./TokyoNova.js":[7459,7455],"./Torg":[3042,6604],"./Torg.js":[3042,6604],"./Torg1_5":[3257,8177],"./Torg1_5.js":[3257,8177],"./TorgEternity":[9543,9931],"./TorgEternity.js":[9543,9931],"./ToshiakiHolyGrailWar":[1641,4957],"./ToshiakiHolyGrailWar.js":[1641,4957],"./TrinitySeven":[8262,589],"./TrinitySeven.js":[8262,589],"./TunnelsAndTrolls":[6450,5188],"./TunnelsAndTrolls.js":[6450,5188],"./TwilightGunsmoke":[4547,6331],"./TwilightGunsmoke.js":[4547,6331],"./UnsungDuet":[6694,1209],"./UnsungDuet.js":[6694,1209],"./Utakaze":[5520,357],"./Utakaze.js":[5520,357],"./VampireTheMasquerade5th":[6409,7115],"./VampireTheMasquerade5th.js":[6409,7115],"./Villaciel":[6633,4906],"./Villaciel.js":[6633,4906],"./VisionConnect":[2527,35],"./VisionConnect.js":[2527,35],"./WARPS":[8581,1380],"./WARPS.js":[8581,1380],"./WaresBlade":[9840,4213],"./WaresBlade.js":[9840,4213],"./Warhammer":[9883,7339],"./Warhammer.js":[9883,7339],"./Warhammer4":[2135,4837],"./Warhammer4.js":[2135,4837],"./WitchQuest":[3617,6088],"./WitchQuest.js":[3617,6088],"./WorldOfDarkness":[3350,3726],"./WorldOfDarkness.js":[3350,3726],"./YankeeYogSothoth":[1930,7906],"./YankeeYogSothoth.js":[1930,7906],"./YearZeroEngine":[929,6632],"./YearZeroEngine.js":[929,6632],"./Yggdrasill":[7157,6467],"./Yggdrasill.js":[7157,6467],"./ZettaiReido":[6698,4999],"./ZettaiReido.js":[6698,4999]};function H(ee){if(!me.o(d,ee))return Promise.resolve().then(()=>{var O=new Error("Cannot find module '"+ee+"'");throw O.code="MODULE_NOT_FOUND",O});var $=d[ee],x=$[0];return me.e($[1]).then(()=>me.t(x,23))}H.keys=()=>Object.keys(d),H.id=85,C.exports=H},6507:(C,le,me)=>{var d={"./Amadeus.ja_jp.json":[6070,9299],"./Amadeus.ko_kr.json":[765,4092],"./Arianrhod.ja_jp.json":[7267,8206],"./BeginningIdol.ja_jp.json":[5355,8635],"./BeginningIdol.ko_kr.json":[2590,6961],"./Cthulhu.ja_jp.json":[8128,652],"./Cthulhu.ko_kr.json":[7002,2617],"./Cthulhu.zh_hans.json":[4209,4922],"./Cthulhu.zh_hant.json":[8021,3147],"./DetatokoSaga.ja_jp.json":[4608,5777],"./DetatokoSaga.ko_kr.json":[408,4502],"./DoubleCross.ja_jp.json":[9221,8706],"./DoubleCross.ko_kr.json":[9734,8517],"./Dracurouge.ja_jp.json":[2286,2847],"./Dracurouge.ko_kr.json":[3597,155],"./Emoklore.ja_jp.json":[8985,6488],"./Fiasco.ja_jp.json":[9873,1800],"./Fiasco.ko_kr.json":[5244,783],"./FutariSousa.ja_jp.json":[9491,8078],"./FutariSousa.ko_kr.json":[8721,9567],"./Insane.ja_jp.json":[5040,6446],"./Insane.ko_kr.json":[5488,3978],"./Kamigakari.ja_jp.json":[2742,3922],"./Kamigakari.ko_kr.json":[7708,1197],"./KillDeathBusiness.ja_jp.json":[2288,3760],"./KillDeathBusiness.ko_kr.json":[1847,287],"./LogHorizon.ja_jp.json":[6438,3811],"./LogHorizon.ko_kr.json":[8319,5106],"./MagicaLogia.ja_jp.json":[4786,9120],"./MagicaLogia.ko_kr.json":[339,2107],"./MagicaLogia.zh_hans.json":[9116,3229],"./MonotoneMuseum.ja_jp.json":[5628,7848],"./MonotoneMuseum.ko_kr.json":[1302,8157],"./Nechronica.ja_jp.json":[9437,667],"./Nechronica.ko_kr.json":[4241,7743],"./StellarKnights.ja_jp.json":[7251,9206],"./StellarKnights.ko_kr.json":[6697,5717],"./StratoShout.ja_jp.json":[7313,7015],"./StratoShout.ko_kr.json":[424,4113],"./SwordWorld.ja_jp.json":[1243,7348],"./SwordWorld.zh_hans.json":[715,654],"./SwordWorld2_0.ja_jp.json":[7547,5351],"./SwordWorld2_0.zh_hans.json":[7912,5642],"./SwordWorld2_5.ja_jp.json":[8368,669],"./SwordWorld2_5.zh_hans.json":[9860,2597]};function H(ee){if(!me.o(d,ee))return Promise.resolve().then(()=>{var O=new Error("Cannot find module '"+ee+"'");throw O.code="MODULE_NOT_FOUND",O});var $=d[ee],x=$[0];return me.e($[1]).then(()=>me.t(x,19))}H.keys=()=>Object.keys(d),H.id=6507,C.exports=H},2480:()=>{},5861:(C,le,me)=>{"use strict";function d(ee,$,x,O,E,Y,G){try{var D=ee[Y](G),W=D.value}catch(B){return void x(B)}D.done?$(W):Promise.resolve(W).then(O,E)}function H(ee){return function(){var $=this,x=arguments;return new Promise(function(O,E){var Y=ee.apply($,x);function G(W){d(Y,O,E,G,D,"next",W)}function D(W){d(Y,O,E,G,D,"throw",W)}G(void 0)})}}me.d(le,{Z:()=>H})},4682:C=>{"use strict";C.exports=JSON.parse('{"gameSystems":[{"id":"PulpCthulhu","name":"\u30d1\u30eb\u30d7\u30fb\u30af\u30c8\u30a5\u30eb\u30d5","className":"PulpCthulhu","superClassName":"Cthulhu7th","sortKey":"\u306f\u308b\u3075\u304f\u3068\u3046\u308b\u3075","locale":"ja_jp"},{"id":"ToshiakiHolyGrailWar","name":"\u3068\u3057\u3042\u304d\u306e\u8056\u676f\u6226\u4e89TRPG","className":"ToshiakiHolyGrailWar","superClassName":"Base","sortKey":"\u3068\u3057\u3042\u304d\u306e\u305b\u3044\u306f\u3044\u305b\u3093\u305d\u3046TRPG","locale":"ja_jp"},{"id":"Raisondetre","name":"\u53db\u9006\u30ec\u30be\u30f3\u30c7\u30fc\u30c8\u30eb","className":"Raisondetre","superClassName":"Base","sortKey":"\u306f\u3093\u304d\u3084\u304f\u308c\u305d\u3093\u3066\u3068\u304a\u308b","locale":"ja_jp"},{"id":"TrinitySeven","name":"\u30c8\u30ea\u30cb\u30c6\u30a3\u30bb\u30d6\u30f3RPG","className":"TrinitySeven","superClassName":"Base","sortKey":"\u3068\u308a\u306b\u3066\u3044\u305b\u3075\u3093RPG","locale":"ja_jp"},{"id":"BladeOfArcana","name":"\u30d6\u30ec\u30a4\u30c9\u30fb\u30aa\u30d6\u30fb\u30a2\u30eb\u30ab\u30ca","className":"BladeOfArcana","superClassName":"Base","sortKey":"\u3075\u308c\u3044\u3068\u304a\u3075\u3042\u308b\u304b\u306a","locale":"ja_jp"},{"id":"RecordOfLodossWar","name":"\u30ed\u30fc\u30c9\u30b9\u5cf6\u6226\u8a18RPG","className":"RecordOfLodossWar","superClassName":"Base","sortKey":"\u308d\u304a\u3068\u3059\u3068\u3046\u305b\u3093\u304dRPG","locale":"ja_jp"},{"id":"RecordOfSteam","name":"Record of Steam","className":"RecordOfSteam","superClassName":"Base","sortKey":"\u308c\u3053\u304a\u3068\u304a\u3075\u3059\u3061\u3044\u3080","locale":"ja_jp"},{"id":"TunnelsAndTrolls","name":"\u30c8\u30f3\u30cd\u30eb\u30ba\uff06\u30c8\u30ed\u30fc\u30eb\u30ba","className":"TunnelsAndTrolls","superClassName":"Base","sortKey":"\u3068\u3093\u306d\u308b\u3059\u3042\u3093\u3068\u3068\u308d\u304a\u308b\u3059","locale":"ja_jp"},{"id":"EarthDawn4","name":"\u30a2\u30fc\u30b9\u30c9\u30fc\u30f34\u7248","className":"EarthDawn4","superClassName":"EarthDawn","sortKey":"\u3042\u3042\u3059\u3068\u304a\u30934","locale":"ja_jp"},{"id":"BlindMythos","name":"\u30d6\u30e9\u30a4\u30f3\u30c9\u30fb\u30df\u30c8\u30b9RPG","className":"BlindMythos","superClassName":"Base","sortKey":"\u3075\u3089\u3044\u3093\u3068\u307f\u3068\u3059RPG","locale":"ja_jp"},{"id":"LogHorizon:Korean","name":"\ub85c\uadf8 \ud638\ub77c\uc774\uc98c","className":"LogHorizon_Korean","superClassName":"LogHorizon","sortKey":"\u56fd\u969b\u5316:Korean:\ub85c\uadf8 \ud638\ub77c\uc774\uc98c","locale":"ko_kr"},{"id":"LostRecord","name":"\u30ed\u30b9\u30c8\u30ec\u30b3\u30fc\u30c9","className":"LostRecord","superClassName":"Base","sortKey":"\u308d\u3059\u3068\u308c\u3053\u304a\u3068","locale":"ja_jp"},{"id":"LostRoyal","name":"\u30ed\u30b9\u30c8\u30ed\u30a4\u30e4\u30eb","className":"LostRoyal","superClassName":"Base","sortKey":"\u308d\u3059\u3068\u308d\u3044\u3084\u308b","locale":"ja_jp"},{"id":"EclipsePhase","name":"\u30a8\u30af\u30ea\u30d7\u30b9\u30fb\u30d5\u30a7\u30a4\u30ba","className":"EclipsePhase","superClassName":"Base","sortKey":"\u3048\u304f\u308a\u3075\u3059\u3075\u3048\u3044\u3059","locale":"ja_jp"},{"id":"Revulture","name":"\u5149\u7815\u306e\u30ea\u30f4\u30a1\u30eb\u30c1\u30e3\u30fc","className":"Revulture","superClassName":"Base","sortKey":"\u3053\u3046\u3055\u3044\u306e\u308a\u3046\u3042\u308b\u3061\u3084\u3042","locale":"ja_jp"},{"id":"TwilightGunsmoke","name":"\u30c8\u30ef\u30a4\u30e9\u30a4\u30c8\u30ac\u30f3\u30b9\u30e2\u30fc\u30af","className":"TwilightGunsmoke","superClassName":"Base","sortKey":"\u3068\u308f\u3044\u3089\u3044\u3068\u304b\u3093\u3059\u3082\u304a\u304f","locale":"ja_jp"},{"id":"Elric","name":"\u30a8\u30eb\u30ea\u30c3\u30af\uff01","className":"Elric","superClassName":"Base","sortKey":"\u3048\u308b\u308a\u3064\u304f","locale":"ja_jp"},{"id":"Elysion","name":"\u30a8\u30ea\u30e5\u30b7\u30aa\u30f3","className":"Elysion","superClassName":"Base","sortKey":"\u3048\u308a\u3086\u3057\u304a\u3093","locale":"ja_jp"},{"id":"UnsungDuet","name":"\u30a2\u30f3\u30b5\u30f3\u30b0\u30fb\u30c7\u30e5\u30a8\u30c3\u30c8","className":"UnsungDuet","superClassName":"Base","sortKey":"\u3042\u3093\u3055\u3093\u304f\u3066\u3086\u3048\u3064\u3068","locale":"ja_jp"},{"id":"RokumonSekai2","name":"\u516d\u9580\u4e16\u754cRPG \u30bb\u30ab\u30f3\u30c9\u30a8\u30c7\u30a3\u30b7\u30e7\u30f3","className":"RokumonSekai2","superClassName":"Base","sortKey":"\u308d\u304f\u3082\u3093\u305b\u304b\u3044RPG2","locale":"ja_jp"},{"id":"Utakaze","name":"\u30a6\u30bf\u30ab\u30bc","className":"Utakaze","superClassName":"Base","sortKey":"\u3046\u305f\u304b\u305b","locale":"ja_jp"},{"id":"MagicaLogia","name":"\u30de\u30ae\u30ab\u30ed\u30ae\u30a2","className":"MagicaLogia","superClassName":"Base","sortKey":"\u307e\u304d\u304b\u308d\u304d\u3042","locale":"ja_jp"},{"id":"RoleMaster","name":"\u30ed\u30fc\u30eb\u30de\u30b9\u30bf\u30fc","className":"RoleMaster","superClassName":"Base","sortKey":"\u308d\u304a\u308b\u307e\u3059\u305f\u3042","locale":"ja_jp"},{"id":"RuinBreakers","name":"\u30eb\u30fc\u30a4\u30f3\u30d6\u30ec\u30a4\u30ab\u30fc\u30ba","className":"RuinBreakers","superClassName":"Base","sortKey":"\u308b\u3046\u3044\u3093\u3075\u308c\u3044\u304b\u3042\u3059","locale":"ja_jp"},{"id":"BloodCrusade","name":"\u30d6\u30e9\u30c3\u30c9\u30fb\u30af\u30eb\u30bb\u30a4\u30c9","className":"BloodCrusade","superClassName":"Base","sortKey":"\u3075\u3089\u3064\u3068\u304f\u308b\u305b\u3044\u3068","locale":"ja_jp"},{"id":"VampireTheMasquerade5th","name":"Vampire: The Masquerade 5th Edition","className":"VampireTheMasquerade5th","superClassName":"Base","sortKey":"\u3046\u3042\u3093\u306f\u3044\u3042\u3055\u307e\u3059\u304b\u308c\u3048\u30685","locale":"ja_jp"},{"id":"AFF2e","name":"ADVANCED FIGHTING FANTASY 2nd Edition","className":"AFF2e","superClassName":"Base","sortKey":"\u3042\u3068\u306f\u3093\u3059\u3068\u3075\u3042\u3044\u3066\u3044\u3093\u304f\u3075\u3042\u3093\u305f\u3057\u30442","locale":"ja_jp"},{"id":"BloodMoon","name":"\u30d6\u30e9\u30c3\u30c9\u30e0\u30fc\u30f3","className":"BloodMoon","superClassName":"Base","sortKey":"\u3075\u3089\u3064\u3068\u3080\u3046\u3093","locale":"ja_jp"},{"id":"Bloodorium","name":"\u30d6\u30e9\u30c9\u30ea\u30a6\u30e0","className":"Bloodorium","superClassName":"Base","sortKey":"\u3075\u3089\u3068\u308a\u3046\u3080","locale":"ja_jp"},{"id":"RuneQuest","name":"\u30eb\u30fc\u30f3\u30af\u30a8\u30b9\u30c8","className":"RuneQuest","superClassName":"Base","sortKey":"\u308b\u3046\u3093\u304f\u3048\u3059\u3068","locale":"ja_jp"},{"id":"RyuTuber","name":"\u30ea\u30e5\u30fc\u30c1\u30e5\u30fc\u30d0\u30fc\u3068\u3061\u3044\u3055\u306a\u5947\u8de1","className":"RyuTuber","superClassName":"Base","sortKey":"\u308a\u3086\u3046\u3061\u3086\u3046\u306f\u3042\u3068\u3061\u3044\u3055\u306a\u304d\u305b\u304d","locale":"ja_jp"},{"id":"Ryutama","name":"\u308a\u3085\u3046\u305f\u307e","className":"Ryutama","superClassName":"Base","sortKey":"\u308a\u3086\u3046\u305f\u307e","locale":"ja_jp"},{"id":"CardRanker","name":"\u30ab\u30fc\u30c9\u30e9\u30f3\u30ab\u30fc","className":"CardRanker","superClassName":"Base","sortKey":"\u304b\u3042\u3068\u3089\u3093\u304b\u3042","locale":"ja_jp"},{"id":"CastleInGray","name":"\u7070\u8272\u57ce\u7dba\u8b5a","className":"CastleInGray","superClassName":"Base","sortKey":"\u306f\u3044\u3044\u308d\u3057\u3088\u3046\u304d\u305f\u3093","locale":"ja_jp"},{"id":"MagicaLogia:Korean","name":"\ub9c8\uae30\uce74\ub85c\uae30\uc544","className":"MagicaLogia_Korean","superClassName":"MagicaLogia","sortKey":"\u56fd\u969b\u5316:Korean:\ub9c8\uae30\uce74\ub85c\uae30\uc544","locale":"ko_kr"},{"id":"MagicaLogia:SimplifiedChinese","name":"\u9b54\u5bfc\u4e66\u5927\u6218","className":"MagicaLogia_SimplifiedChinese","superClassName":"MagicaLogia","sortKey":"\u56fd\u969b\u5316:Simplified Chinese:\u9b54\u5bfc\u4e66\u5927\u6218","locale":"zh_hans"},{"id":"AceKillerGene","name":"\u30a8\u30fc\u30b9\u30ad\u30e9\u30fc\u30b8\u30fc\u30f3","className":"AceKillerGene","superClassName":"GardenOrder","sortKey":"\u3048\u3048\u3059\u304d\u3089\u3042\u3057\u3044\u3093","locale":"ja_jp"},{"id":"GardenOrder","name":"\u30ac\u30fc\u30c7\u30f3\u30aa\u30fc\u30c0\u30fc","className":"GardenOrder","superClassName":"Base","sortKey":"\u304b\u3042\u3066\u3093\u304a\u304a\u305f\u3042","locale":"ja_jp"},{"id":"MeikyuDays","name":"\u8ff7\u5bae\u30c7\u30a4\u30ba","className":"MeikyuDays","superClassName":"Base","sortKey":"\u3081\u3044\u304d\u3086\u3046\u3066\u3044\u3059","locale":"ja_jp"},{"id":"ChaosFlare","name":"\u30ab\u30aa\u30b9\u30d5\u30ec\u30a2","className":"ChaosFlare","superClassName":"Base","sortKey":"\u304b\u304a\u3059\u3075\u308c\u3042","locale":"ja_jp"},{"id":"SajinsenkiAGuS","name":"\u7802\u5875\u6226\u6a5f\u30a2\u30fc\u30ac\u30b9","className":"SajinsenkiAGuS","superClassName":"Base","sortKey":"\u3055\u3057\u3093\u305b\u3093\u304d\u3042\u3042\u304b\u3059","locale":"ja_jp"},{"id":"Villaciel","name":"\u84bc\u5929\u306e\u30f4\u30a3\u30e9\u30b7\u30a8\u30eb","className":"Villaciel","superClassName":"Base","sortKey":"\u305d\u3046\u3066\u3093\u306e\u3046\u3044\u3089\u3057\u3048\u308b","locale":"ja_jp"},{"id":"MeikyuKingdom","name":"\u8ff7\u5bae\u30ad\u30f3\u30b0\u30c0\u30e0","className":"MeikyuKingdom","superClassName":"Base","sortKey":"\u3081\u3044\u304d\u3086\u3046\u304d\u3093\u304f\u305f\u3080","locale":"ja_jp"},{"id":"Chill","name":"Chill","className":"Chill","superClassName":"Base","sortKey":"\u3061\u308b","locale":"ja_jp"},{"id":"SamsaraBallad","name":"\u30b5\u30f3\u30b5\u30fc\u30e9\u30fb\u30d0\u30e9\u30c3\u30c9","className":"SamsaraBallad","superClassName":"Base","sortKey":"\u3055\u3093\u3055\u3042\u3089\u306f\u3089\u3064\u3068","locale":"ja_jp"},{"id":"EmbryoMachine","name":"\u30a8\u30e0\u30d6\u30ea\u30aa\u30de\u30b7\u30f3RPG","className":"EmbryoMachine","superClassName":"Base","sortKey":"\u3048\u3080\u3075\u308a\u304a\u307e\u3057\u3093RPG","locale":"ja_jp"},{"id":"Satasupe","name":"\u30b5\u30bf\u30b9\u30da","className":"Satasupe","superClassName":"Base","sortKey":"\u3055\u305f\u3059\u3078","locale":"ja_jp"},{"id":"Ainecadette","name":"\u30a8\u30cd\u30ab\u30c7\u30c3\u30c8","className":"Ainecadette","superClassName":"Base","sortKey":"\u3048\u306d\u304b\u3066\u3064\u3068","locale":"ja_jp"},{"id":"Chill3","name":"Chill 3rd Edition","className":"Chill3","superClassName":"Base","sortKey":"\u3061\u308b3","locale":"ja_jp"},{"id":"Emoklore","name":"\u30a8\u30e2\u30af\u30ed\u30a2TRPG","className":"Emoklore","superClassName":"Base","sortKey":"\u3048\u3082\u304f\u308d\u3042TRPG","locale":"ja_jp"},{"id":"Airgetlamh","name":"\u6731\u306e\u5b64\u5854\u306e\u30a8\u30a2\u30b2\u30c8\u30e9\u30e0","className":"Airgetlamh","superClassName":"Base","sortKey":"\u3042\u3051\u306e\u3053\u3068\u3046\u306e\u3048\u3042\u3051\u3068\u3089\u3080","locale":"ja_jp"},{"id":"CodeLayerd","name":"\u30b3\u30fc\u30c9\uff1a\u30ec\u30a4\u30e4\u30fc\u30c9","className":"CodeLayerd","superClassName":"Base","sortKey":"\u3053\u304a\u3068\u308c\u3044\u3084\u3042\u3068","locale":"ja_jp"},{"id":"ColossalHunter","name":"\u30b3\u30ed\u30c3\u30b5\u30eb\u30cf\u30f3\u30bf\u30fc","className":"ColossalHunter","superClassName":"Base","sortKey":"\u3053\u308d\u3064\u3055\u308b\u306f\u3093\u305f\u3042","locale":"ja_jp"},{"id":"EndBreaker","name":"\u30a8\u30f3\u30c9\u30d6\u30ec\u30a4\u30ab\u30fc\uff01","className":"EndBreaker","superClassName":"Base","sortKey":"\u3048\u3093\u3068\u3075\u308c\u3044\u304b\u3042","locale":"ja_jp"},{"id":"EtrianOdysseySRS","name":"\u4e16\u754c\u6a39\u306e\u8ff7\u5baeSRS","className":"EtrianOdysseySRS","superClassName":"SRS","sortKey":"\u305b\u304b\u3044\u3057\u3086\u306e\u3081\u3044\u304d\u3086\u3046SRS","locale":"ja_jp"},{"id":"FateCoreSystem","name":"Fate Core System","className":"FateCoreSystem","superClassName":"Base","sortKey":"\u3075\u3048\u3044\u3068\u3053\u3042\u3057\u3059\u3066\u3080","locale":"ja_jp"},{"id":"AlchemiaStruggle","name":"\u30a2\u30eb\u30b1\u30df\u30a2\u30fb\u30b9\u30c8\u30e9\u30b0\u30eb","className":"AlchemiaStruggle","superClassName":"Base","sortKey":"\u3042\u308b\u3051\u307f\u3042\u3059\u3068\u3089\u304f\u308b","locale":"ja_jp"},{"id":"Fiasco","name":"\u30d5\u30a3\u30a2\u30b9\u30b3","className":"Fiasco","superClassName":"Base","sortKey":"\u3075\u3044\u3042\u3059\u3053","locale":"ja_jp"},{"id":"Comes","name":"\u30ab\u30e0\u30ba","className":"Comes","superClassName":"Base","sortKey":"\u304b\u3080\u3059","locale":"ja_jp"},{"id":"ConvictorDrive","name":"\u30b3\u30f3\u30f4\u30a3\u30af\u30bf\u30fc\u30fb\u30c9\u30e9\u30a4\u30d6","className":"ConvictorDrive","superClassName":"Base","sortKey":"\u3053\u3093\u3046\u3044\u304f\u305f\u3042\u3068\u3089\u3044\u3075","locale":"ja_jp"},{"id":"CrashWorld","name":"\u589c\u843d\u4e16\u754c","className":"CrashWorld","superClassName":"Base","sortKey":"\u3064\u3044\u3089\u304f\u305b\u304b\u3044","locale":"ja_jp"},{"id":"Fiasco:Korean","name":"\ud53c\uc544\uc2a4\ucf54","className":"Fiasco_Korean","superClassName":"Fiasco","sortKey":"\u56fd\u969b\u5316:Korean:\ud53c\uc544\uc2a4\ucf54","locale":"ko_kr"},{"id":"FilledWith","name":"\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba","className":"FilledWith","superClassName":"Base","sortKey":"\u3075\u3044\u308b\u3068\u3046\u3044\u3059","locale":"ja_jp"},{"id":"Cthulhu","name":"\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG","className":"Cthulhu","superClassName":"Base","sortKey":"\u304f\u3068\u3046\u308b\u3075\u3057\u3093\u308fTRPG","locale":"ja_jp"},{"id":"VisionConnect","name":"\u30f4\u30a3\u30b8\u30e7\u30f3\u30b3\u30cd\u30af\u30c8","className":"VisionConnect","superClassName":"Base","sortKey":"\u3046\u3044\u3057\u3088\u3093\u3053\u306d\u304f\u3068","locale":"ja_jp"},{"id":"WARPS","name":"\u30ef\u30fc\u30d7\u30b9","className":"WARPS","superClassName":"Base","sortKey":"\u308f\u3042\u3075\u3059","locale":"ja_jp"},{"id":"WaresBlade","name":"\u30ef\u30fc\u30b9\u30d6\u30ec\u30a4\u30c9","className":"WaresBlade","superClassName":"Base","sortKey":"\u308f\u3042\u3059\u3075\u308c\u3044\u3068","locale":"ja_jp"},{"id":"Alsetto","name":"\u8a69\u7247\u306e\u30a2\u30eb\u30bb\u30c3\u30c8","className":"Alsetto","superClassName":"Base","sortKey":"\u3046\u305f\u304b\u305f\u306e\u3042\u308b\u305b\u3064\u3068","locale":"ja_jp"},{"id":"ScreamHighSchool","name":"\u30b9\u30af\u30ea\u30fc\u30e0\u30cf\u30a4\u30b9\u30af\u30fc\u30eb","className":"ScreamHighSchool","superClassName":"GardenOrder","sortKey":"\u3059\u304f\u308a\u3044\u3080\u306f\u3044\u3059\u304f\u3046\u308b","locale":"ja_jp"},{"id":"Alshard","name":"\u30a2\u30eb\u30b7\u30e3\u30fc\u30c9","className":"Alshard","superClassName":"SRS","sortKey":"\u3042\u308b\u3057\u3084\u3042\u3068","locale":"ja_jp"},{"id":"SRS","name":"\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0","className":"SRS","superClassName":"Base","sortKey":"\u3059\u305f\u3093\u305f\u3042\u3068RPG\u3057\u3059\u3066\u3080","locale":"ja_jp"},{"id":"Sengensyou","name":"\u5343\u5e7b\u6284","className":"Sengensyou","superClassName":"Base","sortKey":"\u305b\u3093\u3051\u3093\u3057\u3088\u3046","locale":"ja_jp"},{"id":"SevenFortressMobius","name":"\u30bb\u30d6\u30f3\uff1d\u30d5\u30a9\u30fc\u30c8\u30ec\u30b9 \u30e1\u30d3\u30a6\u30b9","className":"SevenFortressMobius","superClassName":"NightWizard","sortKey":"\u305b\u3075\u3093\u3075\u304a\u304a\u3068\u308c\u3059\u3081\u3072\u3046\u3059","locale":"ja_jp"},{"id":"ShadowRun","name":"\u30b7\u30e3\u30c9\u30a6\u30e9\u30f3","className":"ShadowRun","superClassName":"Base","sortKey":"\u3057\u3084\u3068\u3046\u3089\u3093","locale":"ja_jp"},{"id":"ShadowRun4","name":"\u30b7\u30e3\u30c9\u30a6\u30e9\u30f3 4th Edition","className":"ShadowRun4","superClassName":"Base","sortKey":"\u3057\u3084\u3068\u3046\u3089\u30934","locale":"ja_jp"},{"id":"ShadowRun5","name":"\u30b7\u30e3\u30c9\u30a6\u30e9\u30f3 5th Edition","className":"ShadowRun5","superClassName":"ShadowRun4","sortKey":"\u3057\u3084\u3068\u3046\u3089\u30935","locale":"ja_jp"},{"id":"Cthulhu7th","name":"\u65b0\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG","className":"Cthulhu7th","superClassName":"Base","sortKey":"\u3057\u3093\u304f\u3068\u3046\u308b\u3075\u3057\u3093\u308fTRPG","locale":"ja_jp"},{"id":"Warhammer","name":"\u30a6\u30a9\u30fc\u30cf\u30f3\u30de\u30fc","className":"Warhammer","superClassName":"Base","sortKey":"\u3046\u304a\u304a\u306f\u3093\u307e\u3042","locale":"ja_jp"},{"id":"SharedFantasia","name":"Shared\u2020Fantasia","className":"SharedFantasia","superClassName":"Base","sortKey":"\u3057\u3048\u3042\u3042\u3068\u3075\u3042\u3093\u305f\u3057\u3042","locale":"ja_jp"},{"id":"ShinMegamiTenseiKakuseihen","name":"\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG \u899a\u9192\u7bc7","className":"ShinMegamiTenseiKakuseihen","superClassName":"Base","sortKey":"\u3057\u3093\u3081\u304b\u307f\u3066\u3093\u305b\u3044TRPG\u304b\u304f\u305b\u3044\u3078\u3093","locale":"ja_jp"},{"id":"Warhammer4","name":"\u30a6\u30a9\u30fc\u30cf\u30f3\u30de\u30fcRPG\u7b2c4\u7248","className":"Warhammer4","superClassName":"Base","sortKey":"\u3046\u304a\u304a\u306f\u3093\u307e\u30424","locale":"ja_jp"},{"id":"ShinkuuGakuen","name":"\u771f\u7a7a\u5b66\u5712","className":"ShinkuuGakuen","superClassName":"Base","sortKey":"\u3057\u3093\u304f\u3046\u304b\u304f\u3048\u3093","locale":"ja_jp"},{"id":"FullMetalPanic","name":"\u30d5\u30eb\u30e1\u30bf\u30eb\u30fb\u30d1\u30cb\u30c3\u30af\uff01RPG","className":"FullMetalPanic","superClassName":"SRS","sortKey":"\u3075\u308b\u3081\u305f\u308b\u306f\u306b\u3064\u304fRPG","locale":"ja_jp"},{"id":"FutariSousa","name":"\u30d5\u30bf\u30ea\u30bd\u30a6\u30b5","className":"FutariSousa","superClassName":"Base","sortKey":"\u3075\u305f\u308a\u305d\u3046\u3055","locale":"ja_jp"},{"id":"FutariSousa:Korean","name":"\ub458\uc774\uc11c \uc218\uc0ac(\ud6c4\ud0c0\ub9ac\uc18c\uc6b0\uc0ac)","className":"FutariSousa_Korean","superClassName":"FutariSousa","sortKey":"\u56fd\u969b\u5316:Korean:\ub458\uc774\uc11c \uc218\uc0ac","locale":"ko_kr"},{"id":"Garako","name":"\u30ac\u30e9\u30b3\u3068\u7834\u754c\u306e\u5854","className":"Garako","superClassName":"Base","sortKey":"\u304b\u3089\u3053\u3068\u306f\u304b\u3044\u306e\u3068\u3046","locale":"ja_jp"},{"id":"MeikyuKingdomBasic","name":"\u8ff7\u5bae\u30ad\u30f3\u30b0\u30c0\u30e0 \u57fa\u672c\u30eb\u30fc\u30eb\u30d6\u30c3\u30af","className":"MeikyuKingdomBasic","superClassName":"MeikyuKingdom","sortKey":"\u3081\u3044\u304d\u3086\u3046\u304d\u3093\u304f\u305f\u3080\u304d\u307b\u3093\u308b\u3046\u308b\u3075\u3064\u304f","locale":"ja_jp"},{"id":"WitchQuest","name":"\u30a6\u30a3\u30c3\u30c1\u30af\u30a8\u30b9\u30c8","className":"WitchQuest","superClassName":"Base","sortKey":"\u3046\u3044\u3064\u3061\u304f\u3048\u3059\u3068","locale":"ja_jp"},{"id":"AlterRaise","name":"\u30a2\u30eb\u30c8\u30ec\u30a4\u30ba","className":"AlterRaise","superClassName":"Base","sortKey":"\u3042\u308b\u3068\u308c\u3044\u3059","locale":"ja_jp"},{"id":"WorldOfDarkness","name":"\u30ef\u30fc\u30eb\u30c9\u30fb\u30aa\u30d6\u30fb\u30c0\u30fc\u30af\u30cd\u30b9","className":"WorldOfDarkness","superClassName":"Base","sortKey":"\u308f\u3042\u308b\u3068\u304a\u3075\u305f\u3042\u304f\u306d\u3059","locale":"ja_jp"},{"id":"GehennaAn","name":"\u30b2\u30d8\u30ca\u30fb\u30a2\u30ca\u30b9\u30bf\u30b7\u30b9","className":"GehennaAn","superClassName":"Base","sortKey":"\u3051\u3078\u306a\u3042\u306a\u3059\u305f\u3057\u3059","locale":"ja_jp"},{"id":"GeishaGirlwithKatana","name":"\u30b2\u30a4\u30b7\u30e3\u30fb\u30ac\u30fc\u30eb\u30fb\u30a6\u30a3\u30ba\u30fb\u30ab\u30bf\u30ca","className":"GeishaGirlwithKatana","superClassName":"Base","sortKey":"\u3051\u3044\u3057\u3084\u304b\u3042\u308b\u3046\u3044\u3059\u304b\u305f\u306a","locale":"ja_jp"},{"id":"Amadeus","name":"\u30a2\u30de\u30c7\u30a6\u30b9","className":"Amadeus","superClassName":"Base","sortKey":"\u3042\u307e\u3066\u3046\u3059","locale":"ja_jp"},{"id":"YankeeYogSothoth","name":"\u30e4\u30f3\u30ad\u30fc\uff06\u30e8\u30b0\uff1d\u30bd\u30c8\u30fc\u30b9","className":"YankeeYogSothoth","superClassName":"Base","sortKey":"\u3084\u3093\u304d\u3044\u3042\u3093\u3068\u3088\u304f\u305d\u3068\u304a\u3059","locale":"ja_jp"},{"id":"YearZeroEngine","name":"YearZeroEngine","className":"YearZeroEngine","superClassName":"Base","sortKey":"\u3044\u3084\u3042\u305b\u308d\u3048\u3093\u3057\u3093","locale":"ja_jp"},{"id":"ShinobiGami","name":"\u30b7\u30ce\u30d3\u30ac\u30df","className":"ShinobiGami","superClassName":"Base","sortKey":"\u3057\u306e\u3072\u304b\u307f","locale":"ja_jp"},{"id":"Amadeus:Korean","name":"\uc544\ub9c8\ub370\uc6b0\uc2a4","className":"Amadeus_Korean","superClassName":"Amadeus","sortKey":"\u56fd\u969b\u5316:Korean:\uc544\ub9c8\ub370\uc6b0\uc2a4","locale":"ko_kr"},{"id":"GhostLive","name":"\u5b9f\u6cc1\u30b4\u30fc\u30b9\u30c8\u30e9\u30a4\u30f4","className":"GhostLive","superClassName":"Base","sortKey":"\u3057\u3064\u304d\u3088\u3046\u3053\u304a\u3059\u3068\u3089\u3044\u3075","locale":"ja_jp"},{"id":"AngelGear","name":"\u30a8\u30f3\u30bc\u30eb\u30ae\u30a2 \u5929\u4f7f\u5927\u6226TRPG The 2nd Editon","className":"AngelGear","superClassName":"Base","sortKey":"\u3048\u3093\u305b\u308b\u304d\u30422","locale":"ja_jp"},{"id":"GoblinSlayer","name":"\u30b4\u30d6\u30ea\u30f3\u30b9\u30ec\u30a4\u30e4\u30fcTRPG","className":"GoblinSlayer","superClassName":"Base","sortKey":"\u3053\u3075\u308a\u3093\u3059\u308c\u3044\u3084\u3042TRPG","locale":"ja_jp"},{"id":"Shiranui","name":"\u4e0d\u77e5\u706b","className":"Shiranui","superClassName":"Base","sortKey":"\u3057\u3089\u306c\u3044","locale":"ja_jp"},{"id":"AnimaAnimus","name":"\u30a2\u30cb\u30de\u30a2\u30cb\u30e0\u30b9","className":"AnimaAnimus","superClassName":"Base","sortKey":"\u3042\u306b\u307e\u3042\u306b\u3080\u3059","locale":"ja_jp"},{"id":"Yggdrasill","name":"\u92fc\u9244\u306e\u30e6\u30b0\u30c9\u30e9\u30b7\u30eb","className":"Yggdrasill","superClassName":"Base","sortKey":"\u3053\u3046\u3066\u3064\u306e\u3086\u304f\u3068\u3089\u3057\u308b","locale":"ja_jp"},{"id":"Aoharubaan","name":"\u3042\u304a\u306f\u308b\u3070\u30fc\u3093\u3063","className":"Aoharubaan","superClassName":"Base","sortKey":"\u3042\u304a\u306f\u308b\u306f\u3042\u3093\u3064","locale":"ja_jp"},{"id":"ShuumatsuKikou","name":"\u7d42\u672b\u7d00\u884c\uff32\uff30\uff27","className":"ShuumatsuKikou","superClassName":"Base","sortKey":"\u3057\u3086\u3046\u307e\u3064\u304d\u3053\u3046","locale":"ja_jp"},{"id":"Cthulhu7th:ChineseTraditional","name":"\u514b\u8607\u9b6f\u795e\u8a71\u7b2c7\u7248","className":"Cthulhu7th_ChineseTraditional","superClassName":"Base","sortKey":"\u56fd\u969b\u5316:Chinese Traditional:\u514b\u8607\u9b6f\u795e\u8a71\u7b2c7\u7248","locale":"ja_jp"},{"id":"GoldenSkyStories","name":"\u3086\u3046\u3084\u3051\u3053\u3084\u3051","className":"GoldenSkyStories","superClassName":"Base","sortKey":"\u3086\u3046\u3084\u3051\u3053\u3084\u3051","locale":"ja_jp"},{"id":"Skynauts","name":"\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb\uff08\u516d\u7573\u9593\u5e7b\u60f3\u7a7a\u9593\uff09","className":"Skynauts","superClassName":"Base","sortKey":"\u306f\u304f\u308b\u307e\u306e\u3068\u3046\u306e\u3059\u304b\u3044\u306e\u304a\u3064","locale":"ja_jp"},{"id":"Gorilla","name":"\u30b4\u30ea\u30e9TRPG","className":"Gorilla","superClassName":"Base","sortKey":"\u3053\u308a\u3089TRPG","locale":"ja_jp"},{"id":"GranCrest","name":"\u30b0\u30e9\u30f3\u30af\u30ec\u30b9\u30c8RPG","className":"GranCrest","superClassName":"Base","sortKey":"\u304f\u3089\u3093\u304f\u308c\u3059\u3068RPG","locale":"ja_jp"},{"id":"Gundog","name":"\u30ac\u30f3\u30c9\u30c3\u30b0","className":"Gundog","superClassName":"Base","sortKey":"\u304b\u3093\u3068\u3064\u304f","locale":"ja_jp"},{"id":"Arianrhod","name":"\u30a2\u30ea\u30a2\u30f3\u30ed\u30c3\u30c9RPG","className":"Arianrhod","superClassName":"Base","sortKey":"\u3042\u308a\u3042\u3093\u308d\u3064\u3068RPG","locale":"ja_jp"},{"id":"Cthulhu7th:Korean","name":"\ud06c\ud234\ub8e8\uc758 \ubd80\ub984 7\ud310","className":"Cthulhu7th_Korean","superClassName":"Base","sortKey":"\u56fd\u969b\u5316:Korean:\ud06c\ud234\ub8e8\uc758 \ubd80\ub984 7\ud310","locale":"ja_jp"},{"id":"CthulhuTech","name":"\u30af\u30c8\u30a5\u30eb\u30d5\u30c6\u30c3\u30af","className":"CthulhuTech","superClassName":"Base","sortKey":"\u304f\u3068\u3046\u308b\u3075\u3066\u3064\u304f","locale":"ja_jp"},{"id":"ArsMagica","name":"\u30a2\u30eb\u30b9\u30de\u30ae\u30ab","className":"ArsMagica","superClassName":"Base","sortKey":"\u3042\u308b\u3059\u307e\u304d\u304b","locale":"ja_jp"},{"id":"GundogRevised","name":"\u30ac\u30f3\u30c9\u30c3\u30b0\u30fb\u30ea\u30f4\u30a1\u30a4\u30ba\u30c9","className":"GundogRevised","superClassName":"Base","sortKey":"\u304b\u3093\u3068\u3064\u304f\u308a\u3046\u3042\u3044\u3059\u3068","locale":"ja_jp"},{"id":"GundogZero","name":"\u30ac\u30f3\u30c9\u30c3\u30b0\u30bc\u30ed","className":"GundogZero","superClassName":"Gundog","sortKey":"\u304b\u3093\u3068\u3064\u304f\u305b\u308d","locale":"ja_jp"},{"id":"MetalHead","name":"\u30e1\u30bf\u30eb\u30d8\u30c3\u30c9","className":"MetalHead","superClassName":"Base","sortKey":"\u3081\u305f\u308b\u3078\u3064\u3068","locale":"ja_jp"},{"id":"GURPS","name":"\u30ac\u30fc\u30d7\u30b9","className":"GURPS","superClassName":"Base","sortKey":"\u304b\u3042\u3075\u3059","locale":"ja_jp"},{"id":"GurpsFW","name":"\u30ac\u30fc\u30d7\u30b9\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba","className":"GurpsFW","superClassName":"Base","sortKey":"\u304b\u3042\u3075\u3059\u3075\u3044\u308b\u3068\u3046\u3044\u3059","locale":"ja_jp"},{"id":"AssaultEngine","name":"\u30a2\u30b5\u30eb\u30c8\u30a8\u30f3\u30b8\u30f3","className":"AssaultEngine","superClassName":"Base","sortKey":"\u3042\u3055\u308b\u3068\u3048\u3093\u3057\u3093","locale":"ja_jp"},{"id":"MetalHeadExtream","name":"\u30e1\u30bf\u30eb\u30d8\u30c3\u30c9\u30a8\u30af\u30b9\u30c8\u30ea\u30fc\u30e0","className":"MetalHeadExtream","superClassName":"Base","sortKey":"\u3081\u305f\u308b\u3078\u3064\u3068\u3048\u304f\u3059\u3068\u308a\u3044\u3080","locale":"ja_jp"},{"id":"SkynautsBouken","name":"\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb\uff08\u5192\u967a\u4f01\u753b\u5c40\uff09","className":"SkynautsBouken","superClassName":"Base","sortKey":"\u306f\u304f\u308b\u307e\u306e\u3068\u3046\u306e\u3059\u304b\u3044\u306e\u304a\u30642","locale":"ja_jp"},{"id":"Cthulhu:ChineseTraditional","name":"\u514b\u8607\u9b6f\u795e\u8a71","className":"Cthulhu_ChineseTraditional","superClassName":"Cthulhu","sortKey":"\u56fd\u969b\u5316:Chinese Traditional:\u514b\u8607\u9b6f\u795e\u8a71","locale":"zh_hant"},{"id":"Avandner","name":"\u9ed2\u7d62\u306e\u30a2\u30f4\u30a1\u30f3\u30c9\u30ca\u30fc","className":"Avandner","superClassName":"Base","sortKey":"\u3053\u3064\u3051\u3093\u306e\u3042\u3046\u3042\u3093\u3068\u306a\u3042","locale":"ja_jp"},{"id":"Cthulhu:Korean","name":"\ud06c\ud234\ub8e8","className":"Cthulhu_Korean","superClassName":"Cthulhu","sortKey":"\u56fd\u969b\u5316:Korean:\ud06c\ud234\ub8e8","locale":"ko_kr"},{"id":"Ayabito","name":"\u3042\u3084\u3073\u3068","className":"Ayabito","superClassName":"Base","sortKey":"\u3042\u3084\u3072\u3068","locale":"ja_jp"},{"id":"CyberpunkRed","name":"\u30b5\u30a4\u30d0\u30fc\u30d1\u30f3\u30afRED (\u30d1\u30c3\u30c1\u7248)","className":"CyberpunkRed","superClassName":"Base","sortKey":"\u3055\u3044\u306f\u3042\u306f\u3093\u304f\u308c\u3064\u3068","locale":"ja_jp"},{"id":"Cthulhu:SimplifiedChinese","name":"\u514b\u82cf\u9c81\u7684\u547c\u5524 \u7b2c\u516d\u7248","className":"Cthulhu_SimplifiedChinese","superClassName":"Cthulhu","sortKey":"\u56fd\u969b\u5316:Simplified Chinese:\u514b\u82cf\u9c81\u7684\u547c\u5524 \u7b2c\u516d\u7248","locale":"zh_hans"},{"id":"ZettaiReido","name":"\u7d76\u5bfe\u96b7\u5974","className":"ZettaiReido","superClassName":"Base","sortKey":"\u305b\u3064\u305f\u3044\u308c\u3044\u3068","locale":"ja_jp"},{"id":"Bakenokawa","name":"\u30d0\u30b1\u30ce\u30ab\u30ef","className":"Bakenokawa","superClassName":"Base","sortKey":"\u306f\u3051\u306e\u304b\u308f","locale":"ja_jp"},{"id":"BBN","name":"BBNTRPG","className":"BBN","superClassName":"Base","sortKey":"\u3072\u3044\u3072\u3044\u3048\u306cTRPG","locale":"ja_jp"},{"id":"HarnMaster","name":"\u30cf\u30fc\u30f3\u30de\u30b9\u30bf\u30fc","className":"HarnMaster","superClassName":"Base","sortKey":"\u306f\u3042\u3093\u307e\u3059\u305f\u3042","locale":"ja_jp"},{"id":"StarryDolls","name":"\u30b9\u30bf\u30ea\u30a3\u30c9\u30fc\u30eb","className":"StarryDolls","superClassName":"Base","sortKey":"\u3059\u305f\u308a\u3044\u3068\u304a\u308b","locale":"ja_jp"},{"id":"SteamPunkers","name":"\u30b9\u30c1\u30fc\u30e0\u30d1\u30f3\u30ab\u30fc\u30ba","className":"SteamPunkers","superClassName":"Base","sortKey":"\u3059\u3061\u3044\u3080\u306f\u3093\u304b\u3042\u3059","locale":"ja_jp"},{"id":"BadLife","name":"\u30d0\u30c3\u30c9\u30e9\u30a4\u30d5","className":"BadLife","superClassName":"Base","sortKey":"\u306f\u3064\u3068\u3089\u3044\u3075","locale":"ja_jp"},{"id":"HatsuneMiku","name":"\u521d\u97f3\u30df\u30afTRPG \u30b3\u30b3\u30ed\u30c0\u30f3\u30b8\u30e7\u30f3","className":"HatsuneMiku","superClassName":"Base","sortKey":"\u306f\u3064\u306d\u307f\u304fTRPG\u3053\u3053\u308d\u305f\u3093\u3057\u3088\u3093","locale":"ja_jp"},{"id":"StellarKnights","name":"\u9280\u5263\u306e\u30b9\u30c6\u30e9\u30ca\u30a4\u30c4","className":"StellarKnights","superClassName":"Base","sortKey":"\u304d\u3093\u3051\u3093\u306e\u3059\u3066\u3089\u306a\u3044\u3064","locale":"ja_jp"},{"id":"StellarKnights:Korean","name":"\uc740\uac80\uc758 \uc2a4\ud154\ub77c\ub098\uc774\uce20","className":"StellarKnights_Korean","superClassName":"StellarKnights","sortKey":"\u56fd\u969b\u5316:Korean:\uc740\uac80\uc758 \uc2a4\ud154\ub77c\ub098\uc774\uce20","locale":"ko_kr"},{"id":"BarnaKronika","name":"\u30d0\u30eb\u30ca\u30fb\u30af\u30ed\u30cb\u30ab","className":"BarnaKronika","superClassName":"Base","sortKey":"\u306f\u308b\u306a\u304f\u308d\u306b\u304b","locale":"ja_jp"},{"id":"Hieizan","name":"\u6bd4\u53e1\u5c71\u708e\u4e0a","className":"Hieizan","superClassName":"Base","sortKey":"\u3072\u3048\u3044\u3055\u3093\u3048\u3093\u3057\u3088\u3046","locale":"ja_jp"},{"id":"HouraiGakuen","name":"\u84ec\u83b1\u5b66\u5712\u306e\u5192\u967a!!","className":"HouraiGakuen","superClassName":"Base","sortKey":"\u307b\u3046\u3089\u3044\u304b\u304f\u3048\u3093\u306e\u307b\u3046\u3051\u3093","locale":"ja_jp"},{"id":"MonotoneMuseum","name":"\u30e2\u30ce\u30c8\u30fc\u30f3\u30df\u30e5\u30fc\u30b8\u30a2\u30e0RPG","className":"MonotoneMuseum","superClassName":"Base","sortKey":"\u3082\u306e\u3068\u304a\u3093\u307f\u3086\u3046\u3057\u3042\u3080RPG","locale":"ja_jp"},{"id":"DarkBlaze","name":"\u30c0\u30fc\u30af\u30d6\u30ec\u30a4\u30ba","className":"DarkBlaze","superClassName":"Base","sortKey":"\u305f\u3042\u304f\u3075\u308c\u3044\u3059","locale":"ja_jp"},{"id":"MonotoneMuseum:Korean","name":"\ubaa8\ub178\ud1a4 \ubba4\uc9c0\uc5c4","className":"MonotoneMuseum_Korean","superClassName":"MonotoneMuseum","sortKey":"\u56fd\u969b\u5316:Korean:\ubaa8\ub178\ud1a4 \ubba4\uc9c0\uc5c4","locale":"ko_kr"},{"id":"Nechronica","name":"\u30cd\u30af\u30ed\u30cb\u30ab","className":"Nechronica","superClassName":"Base","sortKey":"\u306d\u304f\u308d\u306b\u304b","locale":"ja_jp"},{"id":"MetallicGuardian","name":"\u30e1\u30bf\u30ea\u30c3\u30af\u30ac\u30fc\u30c7\u30a3\u30a2\u30f3RPG","className":"MetallicGuardian","superClassName":"SRS","sortKey":"\u3081\u305f\u308a\u3064\u304f\u304b\u3042\u3066\u3044\u3042\u3093RPG","locale":"ja_jp"},{"id":"StellarLife","name":"\u30b9\u30c6\u30e9\u30fc\u30e9\u30a4\u30d5TRPG","className":"StellarLife","superClassName":"Base","sortKey":"\u3059\u3066\u3089\u3042\u3089\u3044\u3075TRPG","locale":"ja_jp"},{"id":"StrangerOfSwordCity","name":"\u5263\u306e\u8857\u306e\u7570\u90a6\u4ebaTRPG","className":"StrangerOfSwordCity","superClassName":"Base","sortKey":"\u3064\u308b\u304d\u306e\u307e\u3061\u306e\u3044\u307b\u3046\u3057\u3093TRPG","locale":"ja_jp"},{"id":"Nechronica:Korean","name":"\ub124\ud06c\ub85c\ub2c8\uce74","className":"Nechronica_Korean","superClassName":"Nechronica","sortKey":"\u56fd\u969b\u5316:Korean:\ub124\ud06c\ub85c\ub2c8\uce74","locale":"ko_kr"},{"id":"NeverCloud","name":"\u30cd\u30d0\u30fc\u30af\u30e9\u30a6\u30c9TRPG","className":"NeverCloud","superClassName":"Base","sortKey":"\u306d\u306f\u3042\u304f\u3089\u3046\u3068TRPG","locale":"ja_jp"},{"id":"StratoShout:Korean","name":"\uc2a4\ud2b8\ub77c\ud1a0 \uc0e4\uc6b0\ud2b8","className":"StratoShout_Korean","superClassName":"StratoShout","sortKey":"\u56fd\u969b\u5316:Korean:\uc2a4\ud2b8\ub77c\ud1a0 \uc0e4\uc6b0\ud2b8","locale":"ko_kr"},{"id":"StratoShout","name":"\u30b9\u30c8\u30e9\u30c8\u30b7\u30e3\u30a6\u30c8","className":"StratoShout","superClassName":"Base","sortKey":"\u3059\u3068\u3089\u3068\u3057\u3084\u3046\u3068","locale":"ja_jp"},{"id":"BattleTech","name":"\u30d0\u30c8\u30eb\u30c6\u30c3\u30af","className":"BattleTech","superClassName":"Base","sortKey":"\u306f\u3068\u308b\u3066\u3064\u304f","locale":"ja_jp"},{"id":"DarkDaysDrive","name":"\u30c0\u30fc\u30af\u30c7\u30a4\u30ba\u30c9\u30e9\u30a4\u30d6","className":"DarkDaysDrive","superClassName":"Base","sortKey":"\u305f\u3042\u304f\u3066\u3044\u3059\u3068\u3089\u3044\u3075","locale":"ja_jp"},{"id":"NightWizard","name":"\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 2nd Edition","className":"NightWizard","superClassName":"Base","sortKey":"\u306a\u3044\u3068\u3046\u3044\u3055\u3042\u30682","locale":"ja_jp"},{"id":"DarkSouls","name":"\u30c0\u30fc\u30af\u30bd\u30a6\u30ebTRPG","className":"DarkSouls","superClassName":"Base","sortKey":"\u305f\u3042\u304f\u305d\u3046\u308bTRPG","locale":"ja_jp"},{"id":"SwordWorld","name":"\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c9RPG","className":"SwordWorld","superClassName":"Base","sortKey":"\u305d\u304a\u3068\u308f\u3042\u308b\u3068","locale":"ja_jp"},{"id":"Strave","name":"\u78a7\u7a7a\u306e\u30b9\u30c8\u30ec\u30a4\u30f4","className":"Strave","superClassName":"Base","sortKey":"\u3078\u304d\u304f\u3046\u306e\u3059\u3068\u308c\u3044\u3075","locale":"ja_jp"},{"id":"DeadlineHeroes","name":"\u30c7\u30c3\u30c9\u30e9\u30a4\u30f3\u30d2\u30fc\u30ed\u30fc\u30baRPG","className":"DeadlineHeroes","superClassName":"Base","sortKey":"\u3066\u3064\u3068\u3089\u3044\u3093\u3072\u3044\u308d\u304a\u3059RPG","locale":"ja_jp"},{"id":"HuntersMoon","name":"\u30cf\u30f3\u30bf\u30fc\u30ba\u30fb\u30e0\u30fc\u30f3","className":"HuntersMoon","superClassName":"Base","sortKey":"\u306f\u3093\u305f\u3042\u3059\u3080\u3046\u3093","locale":"ja_jp"},{"id":"HunterTheReckoning5th","name":"Hunter: The Reckoning 5th Edition","className":"HunterTheReckoning5th","superClassName":"Base","sortKey":"\u306f\u3093\u3042\u305f\u3055\u308c\u3053\u306b\u3093\u304f5","locale":"ja_jp"},{"id":"NightWizard3rd","name":"\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 3rd Edition","className":"NightWizard3rd","superClassName":"NightWizard","sortKey":"\u306a\u3044\u3068\u3046\u3044\u3055\u3042\u30683","locale":"ja_jp"},{"id":"NightmareHunterDeep","name":"\u30ca\u30a4\u30c8\u30e1\u30a2\u30cf\u30f3\u30bf\u30fc=\u30c7\u30a3\u30fc\u30d7","className":"NightmareHunterDeep","superClassName":"Base","sortKey":"\u306a\u3044\u3068\u3081\u3042\u306f\u3093\u305f\u3042\u3066\u3044\u3044\u3075","locale":"ja_jp"},{"id":"NinjaSlayer","name":"\u30cb\u30f3\u30b8\u30e3\u30b9\u30ec\u30a4\u30e4\u30fcTRPG","className":"NinjaSlayer","superClassName":"Base","sortKey":"\u306b\u3093\u3057\u3084\u3059\u308c\u3044\u3084\u3042RPG","locale":"ja_jp"},{"id":"IfIfIf","name":"\u30a4\u30d5\u30fb\u30a4\u30d5\u30fb\u30a4\u30d5","className":"IfIfIf","superClassName":"Base","sortKey":"\u3044\u3075\u3044\u3075\u3044\u3075","locale":"ja_jp"},{"id":"DemonParasite","name":"\u30c7\u30e2\u30f3\u30d1\u30e9\u30b5\u30a4\u30c8","className":"DemonParasite","superClassName":"Base","sortKey":"\u3066\u3082\u3093\u306f\u3089\u3055\u3044\u3068","locale":"ja_jp"},{"id":"DesperateRun","name":"Desperate Run TRPG","className":"DesperateRun","superClassName":"Base","sortKey":"\u3066\u3059\u3078\u308c\u3044\u3068\u3089\u3093TRPG","locale":"ja_jp"},{"id":"NjslyrBattle","name":"NJSLYRBATTLE","className":"NjslyrBattle","superClassName":"Base","sortKey":"\u306b\u3093\u3057\u3084\u3059\u308c\u3044\u3084\u3042\u306f\u3068\u308b","locale":"ja_jp"},{"id":"DetatokoSaga","name":"\u3067\u305f\u3068\u3053\u30b5\u30fc\u30ac","className":"DetatokoSaga","superClassName":"Base","sortKey":"\u3066\u305f\u3068\u3053\u3055\u3042\u304b","locale":"ja_jp"},{"id":"NobunagasBlackCastle","name":"\u4fe1\u9577\u306e\u9ed2\u3044\u57ce","className":"NobunagasBlackCastle","superClassName":"Base","sortKey":"\u306e\u3075\u306a\u304b\u306e\u304f\u308d\u3044\u3057\u308d","locale":"ja_jp"},{"id":"BeastBindTrinity","name":"\u30d3\u30fc\u30b9\u30c8\u30d0\u30a4\u30f3\u30c9 \u30c8\u30ea\u30cb\u30c6\u30a3","className":"BeastBindTrinity","superClassName":"Base","sortKey":"\u3072\u3044\u3059\u3068\u306f\u3044\u3093\u3068\u3068\u308a\u306b\u3066\u3044","locale":"ja_jp"},{"id":"Illusio","name":"\u6643\u5929\u306e\u30a4\u30eb\u30fc\u30b8\u30aa","className":"Illusio","superClassName":"Base","sortKey":"\u3053\u3046\u3066\u3093\u306e\u3044\u308b\u3046\u3057\u304a","locale":"ja_jp"},{"id":"SwordWorld2.0","name":"\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.0","className":"SwordWorld2_0","superClassName":"SwordWorld","sortKey":"\u305d\u304a\u3068\u308f\u3042\u308b\u30682.0","locale":"ja_jp"},{"id":"DetatokoSaga:Korean","name":"\ub370\ud0c0\ud1a0\ucf54 \uc0ac\uac00","className":"DetatokoSaga_Korean","superClassName":"DetatokoSaga","sortKey":"\u56fd\u969b\u5316:Korean:\ub370\ud0c0\ud1a0\ucf54 \uc0ac\uac00","locale":"ko_kr"},{"id":"DiceOfTheDead","name":"\u30c0\u30a4\u30b9\u30fb\u30aa\u30d6\u30fb\u30b6\u30fb\u30c7\u30c3\u30c9","className":"DiceOfTheDead","superClassName":"Base","sortKey":"\u305f\u3044\u3059\u304a\u3075\u3055\u3066\u3064\u3068","locale":"ja_jp"},{"id":"NSSQ","name":"SRS\u3058\u3083\u306a\u3044\u4e16\u754c\u6a39\u306e\u8ff7\u5baeTRPG","className":"NSSQ","superClassName":"Base","sortKey":"\u3048\u3059\u3042\u3042\u308b\u3048\u3059\u3057\u3084\u306a\u3044\u305b\u304b\u3044\u3057\u3086\u306e\u3081\u3044\u304d\u3086\u3046TRPG","locale":"ja_jp"},{"id":"InfiniteBabeL","name":"\u5c11\u5e74\u306e\u305f\u3081\u306e\u5c11\u5973\u5c55\u721b\u4f1a\u7570\u805e Infinite BabeL","className":"InfiniteBabeL","superClassName":"ShoujoTenrankai","sortKey":"\u3057\u3088\u3046\u306d\u3093\u306e\u305f\u3081\u306e\u3057\u3088\u3046\u3057\u3088\u3066\u3093\u3089\u3093\u304b\u3044\u3044\u3075\u3093\u3044\u3093\u3075\u3044\u306b\u3064\u3068\u306f\u3078\u308b","locale":"ja_jp"},{"id":"ShoujoTenrankai","name":"\u5c11\u5973\u5c55\u721b\u4f1aTRPG","className":"ShoujoTenrankai","superClassName":"Base","sortKey":"\u3057\u3088\u3046\u3057\u3088\u3066\u3093\u3089\u3093\u304b\u3044TRPG","locale":"ja_jp"},{"id":"DoubleCross","name":"\u30c0\u30d6\u30eb\u30af\u30ed\u30b92nd,3rd","className":"DoubleCross","superClassName":"Base","sortKey":"\u305f\u3075\u308b\u304f\u308d\u30592","locale":"ja_jp"},{"id":"InfiniteFantasia","name":"\u7121\u9650\u306e\u30d5\u30a1\u30f3\u30bf\u30b8\u30a2","className":"InfiniteFantasia","superClassName":"Base","sortKey":"\u3080\u3051\u3093\u306e\u3075\u3042\u3093\u305f\u3057\u3042","locale":"ja_jp"},{"id":"Insane","name":"\u30a4\u30f3\u30bb\u30a4\u30f3","className":"Insane","superClassName":"Base","sortKey":"\u3044\u3093\u305b\u3044\u3093","locale":"ja_jp"},{"id":"OneWayHeroics","name":"\u7247\u9053\u52c7\u8005TRPG","className":"OneWayHeroics","superClassName":"Base","sortKey":"\u304b\u305f\u307f\u3061\u3086\u3046\u3057\u3084TRPG","locale":"ja_jp"},{"id":"BeginningIdol","name":"\u30d3\u30ae\u30cb\u30f3\u30b0\u30a2\u30a4\u30c9\u30eb","className":"BeginningIdol","superClassName":"Base","sortKey":"\u3072\u304d\u306b\u3093\u304f\u3042\u3044\u3068\u308b","locale":"ja_jp"},{"id":"Insane:Korean","name":"\uc778\uc138\uc778","className":"Insane_Korean","superClassName":"Insane","sortKey":"\u56fd\u969b\u5316:Korean:\uc778\uc138\uc778","locale":"ko_kr"},{"id":"Irisbane","name":"\u77b3\u9038\u3089\u3055\u306c\u30a4\u30ea\u30b9\u30d9\u30a4\u30f3","className":"Irisbane","superClassName":"Base","sortKey":"\u3072\u3068\u307f\u305d\u3089\u3055\u306c\u3044\u308a\u3059\u3078\u3044\u3093","locale":"ja_jp"},{"id":"SwordWorld:SimplifiedChinese","name":"\u5251\u4e16\u754c","className":"SwordWorld_SimplifiedChinese","superClassName":"SwordWorld","sortKey":"\u56fd\u969b\u5316:Simplified Chinese:\u5251\u4e16\u754c","locale":"zh_hans"},{"id":"SwordWorld2.0:SimplifiedChinese","name":"\u5251\u4e16\u754c2.0","className":"SwordWorld2_0_SimplifiedChinese","superClassName":"SwordWorld2_0","sortKey":"\u56fd\u969b\u5316:Simplified Chinese:\u5251\u4e16\u754c2.0","locale":"zh_hans"},{"id":"SwordWorld2.5:SimplifiedChinese","name":"\u5251\u4e16\u754c2.5","className":"SwordWorld2_5_SimplifiedChinese","superClassName":"SwordWorld2_5","sortKey":"\u56fd\u969b\u5316:Simplified Chinese:\u5251\u4e16\u754c2.5","locale":"zh_hans"},{"id":"Nuekagami","name":"\u9d7a\u93e1","className":"Nuekagami","superClassName":"Base","sortKey":"\u306c\u3048\u304b\u304b\u307f","locale":"ja_jp"},{"id":"TalesFromTheLoop","name":"\u30b6\u30fb\u30eb\u30fc\u30d7TRPG","className":"TalesFromTheLoop","superClassName":"Base","sortKey":"\u3055\u308b\u3046\u3075TRPG","locale":"ja_jp"},{"id":"SwordWorld2.5","name":"\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.5","className":"SwordWorld2_5","superClassName":"SwordWorld2_0","sortKey":"\u305d\u304a\u3068\u308f\u3042\u308b\u30682.5","locale":"ja_jp"},{"id":"DiceBot","name":"DiceBot","className":"DiceBot","superClassName":"Base","sortKey":"*\u305f\u3044\u3059\u307b\u3064\u3068","locale":"ja_jp"},{"id":"IthaWenUa","name":"\u30a4\u30b5\u30fc\u30fb\u30a6\u30a7\u30f3\uff1d\u30a2\u30fc","className":"IthaWenUa","superClassName":"Base","sortKey":"\u3044\u3055\u3042\u3046\u3048\u3093\u3042\u3042","locale":"ja_jp"},{"id":"JamesBond","name":"\u30b8\u30a7\u30fc\u30e0\u30ba\u30fb\u30dc\u30f3\u30c9007","className":"JamesBond","superClassName":"Base","sortKey":"\u3057\u3048\u3048\u3080\u3059\u307b\u3093\u3068007","locale":"ja_jp"},{"id":"JuinKansen","name":"\u546a\u5370\u611f\u67d3","className":"JuinKansen","superClassName":"Base","sortKey":"\u3057\u3086\u3044\u3093\u304b\u3093\u305b\u3093","locale":"ja_jp"},{"id":"Kamigakari","name":"\u795e\u6211\u72e9","className":"Kamigakari","superClassName":"Base","sortKey":"\u304b\u307f\u304b\u304b\u308a","locale":"ja_jp"},{"id":"DoubleCross:Korean","name":"\ub354\ube14\ud06c\ub85c\uc2a42nd,3rd","className":"DoubleCross_Korean","superClassName":"DoubleCross","sortKey":"\u56fd\u969b\u5316:Korean:\ub354\ube14\ud06c\ub85c\uc2a4","locale":"ko_kr"},{"id":"Dracurouge","name":"\u30c9\u30e9\u30af\u30eb\u30fc\u30b8\u30e5","className":"Dracurouge","superClassName":"Base","sortKey":"\u3068\u3089\u304f\u308b\u3046\u3057\u3086","locale":"ja_jp"},{"id":"TokyoGhostResearch","name":"\u6771\u4eac\u30b4\u30fc\u30b9\u30c8\u30ea\u30b5\u30fc\u30c1","className":"TokyoGhostResearch","superClassName":"Base","sortKey":"\u3068\u3046\u304d\u3088\u3046\u3053\u304a\u3059\u3068\u308a\u3055\u3042\u3061","locale":"ja_jp"},{"id":"JekyllAndHyde","name":"\u30b8\u30ad\u30eb\u3068\u30cf\u30a4\u30c9\u3068\u30b0\u30ea\u30c8\u30b0\u30e9","className":"JekyllAndHyde","superClassName":"DesperateRun","sortKey":"\u3057\u304d\u308b\u3068\u306f\u3044\u3068\u3068\u304f\u308a\u3068\u304f\u3089","locale":"ja_jp"},{"id":"TherapieSein","name":"\u30bb\u30e9\u30d5\u30a3\u30b6\u30a4\u30f3","className":"TherapieSein","superClassName":"Base","sortKey":"\u305b\u3089\u3075\u3044\u3055\u3044\u3093","locale":"ja_jp"},{"id":"TokumeiTenkousei","name":"\u7279\u547d\u8ee2\u653b\u751f","className":"TokumeiTenkousei","superClassName":"Base","sortKey":"\u3068\u304f\u3081\u3044\u3066\u3093\u3053\u3046\u305b\u3044","locale":"ja_jp"},{"id":"OracleEngine","name":"\u30aa\u30e9\u30af\u30eb\u30a8\u30f3\u30b8\u30f3","className":"OracleEngine","superClassName":"Base","sortKey":"\u304a\u3089\u304f\u308b\u3048\u3093\u3057\u3093","locale":"ja_jp"},{"id":"Torg","name":"\u30c8\u30fc\u30b0","className":"Torg","superClassName":"Base","sortKey":"\u3068\u304a\u304f","locale":"ja_jp"},{"id":"Kamigakari:Korean","name":"\uce74\ubbf8\uac00\uce74\ub9ac","className":"Kamigakari_Korean","superClassName":"Kamigakari","sortKey":"\u56fd\u969b\u5316:Korean:\uce74\ubbf8\uac00\uce74\ub9ac","locale":"ko_kr"},{"id":"KanColle","name":"\u8266\u3053\u308cRPG","className":"KanColle","superClassName":"Base","sortKey":"\u304b\u3093\u3053\u308cRPG","locale":"ja_jp"},{"id":"TokyoNova","name":"\u30c8\u30fc\u30ad\u30e7\u30fcN\u25ceVA","className":"TokyoNova","superClassName":"Base","sortKey":"\u3068\u304a\u304d\u3088\u304a\u306e\u306f","locale":"ja_jp"},{"id":"Karukami","name":"\u30ab\u30eb\u30ab\u30df","className":"Karukami","superClassName":"Base","sortKey":"\u304b\u308b\u304b\u307f","locale":"ja_jp"},{"id":"KemonoNoMori","name":"\u7378\u30ce\u68ee","className":"KemonoNoMori","superClassName":"Base","sortKey":"\u3051\u3082\u306e\u306e\u3082\u308a","locale":"ja_jp"},{"id":"OrgaRain","name":"\u5728\u308a\u3066\u904d\u304f\u30aa\u30eb\u30ac\u30ec\u30a4\u30f3","className":"OrgaRain","superClassName":"Base","sortKey":"\u3042\u308a\u3066\u3042\u307e\u306d\u304f\u304a\u308b\u304b\u308c\u3044\u3093","locale":"ja_jp"},{"id":"Oukahoushin3rd","name":"\u592e\u83ef\u5c01\u795eRPG \u7b2c\u4e09\u7248","className":"Oukahoushin3rd","superClassName":"Base","sortKey":"\u304a\u3046\u304b\u307b\u3046\u3057\u3093RPG3","locale":"ja_jp"},{"id":"Paradiso","name":"\u30c1\u30a7\u30ec\u30b9\u30c6\u8272\u306e\u30d1\u30e9\u30c7\u30a3\u30fc\u30be","className":"Paradiso","superClassName":"Base","sortKey":"\u3061\u3048\u308c\u3059\u3066\u3044\u308d\u306e\u306f\u3089\u3066\u3044\u3044\u305d","locale":"ja_jp"},{"id":"KillDeathBusiness","name":"\u30ad\u30eb\u30c7\u30b9\u30d3\u30b8\u30cd\u30b9","className":"KillDeathBusiness","superClassName":"Base","sortKey":"\u304d\u308b\u3066\u3059\u3072\u3057\u306d\u3059","locale":"ja_jp"},{"id":"Dracurouge:Korean","name":"\ub4dc\ub77c\ud06c\ub8e8\uc8fc","className":"Dracurouge_Korean","superClassName":"Dracurouge","sortKey":"\u56fd\u969b\u5316:Korean:\ub4dc\ub77c\ud06c\ub8e8\uc8fc","locale":"ko_kr"},{"id":"DungeonsAndDragons","name":"\u30c0\u30f3\u30b8\u30e7\u30f3\u30ba\uff06\u30c9\u30e9\u30b4\u30f3\u30ba","className":"DungeonsAndDragons","superClassName":"Base","sortKey":"\u305f\u3093\u3057\u3088\u3093\u3059\u3042\u3093\u3068\u3068\u3089\u3053\u3093\u3059","locale":"ja_jp"},{"id":"DungeonsAndDragons5","name":"\u30c0\u30f3\u30b8\u30e7\u30f3\u30ba\uff06\u30c9\u30e9\u30b4\u30f3\u30ba\u7b2c5\u7248","className":"DungeonsAndDragons5","superClassName":"Base","sortKey":"\u305f\u3093\u3057\u3088\u3093\u3059\u3042\u3093\u3068\u3068\u3089\u3053\u3093\u30595","locale":"ja_jp"},{"id":"Torg1.5","name":"\u30c8\u30fc\u30b01.5\u7248","className":"Torg1_5","superClassName":"Torg","sortKey":"\u3068\u304a\u304f1.5","locale":"ja_jp"},{"id":"TorgEternity","name":"\u30c8\u30fc\u30b0 \u30a8\u30bf\u30cb\u30c6\u30a3","className":"TorgEternity","superClassName":"Base","sortKey":"\u3068\u304a\u304f\u3048\u305f\u306b\u3066\u3044","locale":"ja_jp"},{"id":"EarthDawn","name":"\u30a2\u30fc\u30b9\u30c9\u30fc\u30f3","className":"EarthDawn","superClassName":"Base","sortKey":"\u3042\u3042\u3059\u3068\u304a\u3093","locale":"ja_jp"},{"id":"Paranoia","name":"\u30d1\u30e9\u30ce\u30a4\u30a2","className":"Paranoia","superClassName":"Base","sortKey":"\u306f\u3089\u306e\u3044\u3042","locale":"ja_jp"},{"id":"ParanoiaRebooted","name":"\u30d1\u30e9\u30ce\u30a4\u30a2 \u30ea\u30d6\u30fc\u30c6\u30c3\u30c9","className":"ParanoiaRebooted","superClassName":"Base","sortKey":"\u306f\u3089\u306e\u3044\u3042\u308a\u3075\u3046\u3066\u3064\u3068","locale":"ja_jp"},{"id":"ParasiteBlood","name":"\u30d1\u30e9\u30b5\u30a4\u30c8\u30d6\u30e9\u30c3\u30c9RPG","className":"ParasiteBlood","superClassName":"DemonParasite","sortKey":"\u306f\u3089\u3055\u3044\u3068\u3075\u3089\u3064\u3068RPG","locale":"ja_jp"},{"id":"KillDeathBusiness:Korean","name":"Kill Death Business (\ud55c\uad6d\uc5b4)","className":"KillDeathBusiness_Korean","superClassName":"KillDeathBusiness","sortKey":"\u56fd\u969b\u5316:Korean:Kill Death Business","locale":"ko_kr"},{"id":"KurayamiCrying","name":"\u30af\u30e9\u30e4\u30df\u30af\u30e9\u30a4\u30f3","className":"KurayamiCrying","superClassName":"Base","sortKey":"\u304f\u3089\u3084\u307f\u304f\u3089\u3044\u3093","locale":"ja_jp"},{"id":"Peekaboo","name":"\u30d4\u30fc\u30ab\u30fc\u30d6\u30fc","className":"Peekaboo","superClassName":"Base","sortKey":"\u3072\u3044\u304b\u3042\u3075\u3046","locale":"ja_jp"},{"id":"Kutulu","name":"Kutulu","className":"Kutulu","superClassName":"Base","sortKey":"\u304f\u3068\u3046\u308b\u3046","locale":"ja_jp"},{"id":"Pathfinder","name":"Pathfinder","className":"Pathfinder","superClassName":"DungeonsAndDragons","sortKey":"\u306f\u3059\u3075\u3042\u3044\u3093\u305f\u3042","locale":"ja_jp"},{"id":"PersonaO","name":"\u30da\u30eb\u30bd\u30caTRPG-O","className":"PersonaO","superClassName":"Base","sortKey":"\u3078\u308b\u305d\u306aTRPGO","locale":"ja_jp"},{"id":"Pendragon","name":"\u30da\u30f3\u30c9\u30e9\u30b4\u30f3","className":"Pendragon","superClassName":"Base","sortKey":"\u3078\u3093\u3068\u3089\u3053\u3093","locale":"ja_jp"},{"id":"LiveraDoll","name":"\u7d2b\u7e1e\u306e\u30ea\u30f4\u30e9\u30c9\u30fc\u30eb","className":"LiveraDoll","superClassName":"Base","sortKey":"\u3057\u3057\u307e\u306e\u308a\u3046\u3089\u3068\u304a\u308b","locale":"ja_jp"},{"id":"PhantasmAdventure","name":"\u30d5\u30a1\u30f3\u30bf\u30ba\u30e0\u30fb\u30a2\u30c9\u30d9\u30f3\u30c1\u30e3\u30fc","className":"PhantasmAdventure","superClassName":"Base","sortKey":"\u3075\u3042\u3093\u305f\u3059\u3080\u3042\u3068\u3078\u3093\u3061\u3084\u3042","locale":"ja_jp"},{"id":"Postman","name":"\u58ca\u308c\u305f\u4e16\u754c\u306e\u30dd\u30b9\u30c8\u30de\u30f3","className":"Postman","superClassName":"Base","sortKey":"\u3053\u308f\u308c\u305f\u305b\u304b\u3044\u306e\u307b\u3059\u3068\u307e\u3093","locale":"ja_jp"},{"id":"LogHorizon","name":"\u30ed\u30b0\u30fb\u30db\u30e9\u30a4\u30ba\u30f3TRPG","className":"LogHorizon","superClassName":"Base","sortKey":"\u308d\u304f\u307b\u3089\u3044\u3059\u3093TRPG","locale":"ja_jp"},{"id":"EarthDawn3","name":"\u30a2\u30fc\u30b9\u30c9\u30fc\u30f33\u7248","className":"EarthDawn3","superClassName":"EarthDawn","sortKey":"\u3042\u3042\u3059\u3068\u304a\u30933","locale":"ja_jp"},{"id":"BeginningIdol:Korean","name":"\ube44\uae30\ub2dd \uc544\uc774\ub3cc","className":"BeginningIdol_Korean","superClassName":"BeginningIdol","sortKey":"\u56fd\u969b\u5316:Korean:\ube44\uae30\ub2dd \uc544\uc774\ub3cc","locale":"ko_kr"},{"id":"BeginningIdol2022","name":"\u30d3\u30ae\u30cb\u30f3\u30b0\u30a2\u30a4\u30c9\u30eb\uff082022\u5e74\u6539\u8a02\u7248\uff09","className":"BeginningIdol2022","superClassName":"Base","sortKey":"\u3072\u304d\u306b\u3093\u304f\u3042\u3044\u3068\u308b2022","locale":"ja_jp"}]}')},6884:C=>{"use strict";C.exports=JSON.parse('{"ja_jp":{"success":"\u6210\u529f","failure":"\u5931\u6557","critical":"\u30af\u30ea\u30c6\u30a3\u30ab\u30eb","fumble":"\u30d5\u30a1\u30f3\u30d6\u30eb"},"ko_kr":{"success":"\uc131\uacf5","failure":"\uc2e4\ud328","fumble":"\ud38c\ube14","RTT":{"rtt_format":"\ub79c\ub364 \ud2b9\uae30 \uacb0\uc815\ud45c(%<category_dice>d,%<row_dice>d) \uff1e %<text>s","rttn_format":"\uc9c0\uc815\ud2b9\uae30(%<category_name>s)\ud45c(%<row_dice>d) \uff1e %<text>s"}},"zh_hant":{"success":"\u6210\u529f","failure":"\u5931\u6557"},"zh_hans":{"success":"\u6210\u529f","failure":"\u5931\u8d25","fumble":"\u5927\u5931\u8d25","RTT":{"rtt_format":"\u968f\u673a\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s","rttn_format":"%<category_name>s\u9886\u57df\u968f\u673a\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"}}}')},3034:C=>{"use strict";C.exports=JSON.parse('{"i18nList":[{"baseClassName":"MagicaLogia","locales":["ja_jp","ko_kr","zh_hans"]},{"baseClassName":"Fiasco","locales":["ja_jp","ko_kr"]},{"baseClassName":"SwordWorld2_5","locales":["ja_jp","zh_hans"]},{"baseClassName":"Nechronica","locales":["ja_jp","ko_kr"]},{"baseClassName":"Dracurouge","locales":["ja_jp","ko_kr"]},{"baseClassName":"StratoShout","locales":["ja_jp","ko_kr"]},{"baseClassName":"Amadeus","locales":["ja_jp","ko_kr"]},{"baseClassName":"Emoklore","locales":["ja_jp"]},{"baseClassName":"DetatokoSaga","locales":["ja_jp","ko_kr"]},{"baseClassName":"Kamigakari","locales":["ja_jp","ko_kr"]},{"baseClassName":"Arianrhod","locales":["ja_jp"]},{"baseClassName":"StellarKnights","locales":["ja_jp","ko_kr"]},{"baseClassName":"FutariSousa","locales":["ja_jp","ko_kr"]},{"baseClassName":"DoubleCross","locales":["ja_jp","ko_kr"]},{"baseClassName":"Cthulhu","locales":["ja_jp","ko_kr","zh_hant","zh_hans"]},{"baseClassName":"BeginningIdol","locales":["ja_jp","ko_kr"]},{"baseClassName":"MonotoneMuseum","locales":["ja_jp","ko_kr"]},{"baseClassName":"KillDeathBusiness","locales":["ja_jp","ko_kr"]},{"baseClassName":"Insane","locales":["ja_jp","ko_kr"]},{"baseClassName":"SwordWorld","locales":["ja_jp","zh_hans"]},{"baseClassName":"LogHorizon","locales":["ja_jp","ko_kr"]},{"baseClassName":"SwordWorld2_0","locales":["ja_jp","zh_hans"]}]}')},1014:C=>{"use strict";C.exports={}}},C=>{C(C.s=1099)}]);