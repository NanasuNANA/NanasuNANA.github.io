(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[714],{2653:(xe,Re,ke)=>{ke(5151),Opal.modules["bcdice/arithmetic_evaluator"]=function(e){var F,Y,i,o,p,A,E,Q,V=e.module,j=e.ensure_kwargs,l=e.truthy,P=e.thrower,B=e.def,d=[],L=e.nil,v=e.$$$;return F=d,Y=Q=[V(d[0],"BCDice")].concat(F),E=[A=V(Q[0],"ArithmeticEvaluator")].concat(Y),o=[i=e.get_singleton_class(A)].concat(E),p=e.$r(o),B(i,"$eval",function(C,n){try{P("eval_return");var k,H=L;return null==(k=(n=j(n)).$$smap.round_type)&&(k=v(p("RoundType"),"FLOOR")),l(C)&&l(H=p("Arithmetic").$eval(C,k))?H:0}catch(S){if(S===e.t_eval_return)return S.$v;throw S}},-2)},Opal.modules["i18n/backend/fallbacks"]=function(e){var I,_,n,$,o,p,V=e.module,j=e.class_variable_set,l=e.truthy,P=e.class_variable_get,B=e.def,d=e.send,L=e.send2,v=e.find_super,N=e.hash2,F=e.find_block_super,G=e.neqeq,Q=e.thrower,q=e.return_val,Y=[],A=e.nil,E=e.$$$;return I=Y,p=[o=V(Y[0],"I18n")].concat(I),j(p[0],"@@fallbacks",A),_=e.get_singleton_class(o),n=[_].concat(p),$=e.$r(n),B(_,"$fallbacks",function(){var S=A;return j(n[1],"@@fallbacks",l(null!=n[1].$$cvars["@@fallbacks"]?"class variable":A)&&l(S=P(n[1],"@@fallbacks",!1))?S:E(E($("I18n"),"Locale"),"Fallbacks").$new()),l(S=$("Thread").$current()["$[]"]("i18n_fallbacks"))?S:P(n[1],"@@fallbacks",!1)}),B(_,"$fallbacks=",function(H){var S;return j(n[1],"@@fallbacks",l(H["$is_a?"]($("Array")))?E(E($("I18n"),"Locale"),"Fallbacks").$new(H):H),S=["i18n_fallbacks",P(n[1],"@@fallbacks",!1)],d($("Thread").$current(),"[]=",S),S[S.length-1]}),function(_,C){var H,S,K,z,$=[V(_,"Backend")].concat(C);return H=$,K=[S=V($[0],"Fallbacks")].concat(H),z=e.$r(K),B(S,"$translate",function T(h,y,s){try{var c=Q("return"),u=T.$$p||A,b=this,f=A,m=A;return T.$$p=null,null==s&&(s=z("EMPTY_HASH")),l(s.$fetch("fallback",!0))?l(s["$[]"]("fallback_in_progress"))?L(b,v(b,"translate",T,!1,!0),"translate",[h,y,s],u):(l(s["$[]"]("default"))&&(f=b["$extract_non_symbol_default!"](s)),m=s.$merge(N(["fallback_in_progress"],{fallback_in_progress:!0})),d(z("I18n").$fallbacks()["$[]"](h),"each",[],function t(R){var r=null==t.$$s?this:t.$$s;null==R&&(R=A);try{return d(r,"catch",["exception"],function g(){var a=null==g.$$s?this:g.$$s,O=A;if(O=L(a,F(a,"translate",g.$$def||t.$$def||T,!1,!1),"translate",[R,y,m],null),l(O["$nil?"]()))return A;G(h.$to_s(),R.$to_s())&&a.$on_fallback(h,R,y,s),c.$throw(O)},{$$s:r,$$ret:c})}catch(g){if(!e.rescue(g,[E(z("I18n"),"InvalidLocale")]))throw g;try{return A}finally{e.pop_exception()}}},{$$s:b}),l(s["$key?"]("default"))&&l(s["$[]"]("default")["$nil?"]())?A:l(f)?L(b,v(b,"translate",T,!1,!0),"translate",[h,A,s.$merge(N(["default"],{default:f}))],null):b.$throw("exception",E(z("I18n"),"MissingTranslation").$new(h,y,s))):L(b,v(b,"translate",T,!1,!0),"translate",[h,y,s],u)}catch(t){if(t===c)return t.$v;throw t}},-3),B(S,"$extract_non_symbol_default!",function(h){var s,y=A;return y=[h["$[]"]("default")].$flatten(),s=d(y,"detect",[],function(u){return null==u&&(u=A),u["$is_a?"](z("Symbol"))["$!"]()}),l(s)&&h["$[]="]("default",y["$[]"](0,y.$index(s))),s}),B(S,"$exists?",function T(h,y,s){try{var c=Q("return"),u=T.$$p||A,b=this;return T.$$p=null,null==s&&(s=z("EMPTY_HASH")),l(s.$fetch("fallback",!0))?(d(z("I18n").$fallbacks()["$[]"](h),"each",[],function f(m){var t=null==f.$$s?this:f.$$s;null==m&&(m=A);try{if(!l(L(t,F(t,"exists?",f.$$def||T,!1,!1),"exists?",[m,y],null)))return A;c.$throw(!0)}catch(R){if(!e.rescue(R,[E(z("I18n"),"InvalidLocale")]))throw R;try{return A}finally{e.pop_exception()}}},{$$s:b,$$ret:c}),!1):L(b,v(b,"exists?",T,!1,!0),"exists?",[h,y,s],u)}catch(f){if(f===c)return f.$v;throw f}},-3),S.$private(),B(S,"$on_fallback",q(A))}(p[0],p)},Opal.modules["bcdice/randomizer"]=function(e){var o,k,H,S,K,z,_,C,j=e.klass,l=e.const_set,P=e.def,B=e.truthy,d=e.rb_gt,L=e.rb_plus,v=e.rb_le,N=e.send,F=e.rb_minus,G=e.eqeq,Q=e.rb_times,q=e.eqeqeq,Y=e.rb_ge,A=[],E=e.nil,i=e.$$$;return o=A,_=[(0,e.module)(A[0],"BCDice")].concat(o),C=e.$r(_),k=_,S=[H=j(_[0],null,"Randomizer")].concat(k),K=e.$r(S),(z=H.$$prototype).rand_results=z.detailed_rand_results=E,l(S[0],"UPPER_LIMIT_DICE_TIMES",200),l(S[0],"UPPER_LIMIT_DICE_SIDES",1e4),l(S[0],"UPPER_LIMIT_RANDS",1e4),P(H,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]}),H.$attr_reader("rand_results"),H.$attr_reader("detailed_rand_results"),l(S[0],"DetailedRandResult",K("Struct").$new("kind","sides","value")),P(H,"$roll_barabara",function(h,y){var s=this;return B(d(L(s.rand_results.$size(),h),K("UPPER_LIMIT_RANDS")))&&s.$raise(K("TooManyRandsError")),B(v(h,0))||B(d(h,K("UPPER_LIMIT_DICE_TIMES")))?[]:N(K("Array"),"new",[h],function c(){return(null==c.$$s?this:c.$$s).$roll_once(y)},{$$s:s})}),P(H,"$roll_sum",function(h,y){return this.$roll_barabara(h,y).$sum()}),P(H,"$roll_once",function(h){var s=E;return B(v(h,0))||B(d(h,K("UPPER_LIMIT_DICE_SIDES")))?0:(s=this.$rand_inner(h),this.$push_to_detail("normal",h,s),s)}),P(H,"$roll_index",function(h){return F(this.$roll_once(h),1)}),P(H,"$roll_tens_d10",function(){var s,y=E;return y=this.$rand_inner(10),G(y,10)&&(y=0),s=Q(y,10),this.$push_to_detail("tens_d10",10,s),s}),P(H,"$roll_d9",function(){var y;return y=F(this.$rand_inner(10),1),this.$push_to_detail("d9",10,y),y}),P(H,"$roll_d66",function(h){var c,s=E;return s=N(K("Array"),"new",[2],function u(){return(null==u.$$s?this:u.$$s).$roll_once(6)},{$$s:this}),q(i(K("D66SortType"),"ASC"),c=h)?s["$sort!"]():q(i(K("D66SortType"),"DESC"),c)&&s["$sort!"]()["$reverse!"](),L(Q(s["$[]"](0),10),s["$[]"](1))}),H.$private(),P(H,"$rand_inner",function(h){var s,y=this;return B(Y(y.rand_results.$size(),K("UPPER_LIMIT_RANDS")))&&y.$raise(K("TooManyRandsError")),s=y.$random(h),y.rand_results["$<<"]([s,h]),s}),P(H,"$random",function(h){return L(K("Kernel").$rand(h),1)}),P(H,"$push_to_detail",function(h,y,s){var u;return u=K("DetailedRandResult").$new(h,y,s),this.detailed_rand_results.$push(u)}),j(_[0],C("StandardError"),"TooManyRandsError"),E},Opal.modules["bcdice/dice_table/roll_result"]=function(e){var N,q,I,o,p,_,C,A,G,V=e.module,j=e.klass,l=e.def,P=e.truthy,B=e.return_val,d=[],L=e.nil;return N=d,q=G=[V(d[0],"BCDice")].concat(N),I=A=[V(G[0],"DiceTable")].concat(q),p=[o=j(A[0],null,"RollResult")].concat(I),_=e.$r(p),(C=o.$$prototype).table_name=C.value=C.body=L,l(o,"$initialize",function($,k,H){var S=this;return S.table_name=$,S.value=k,S.body=H}),o.$attr_reader("table_name"),o.$attr_reader("value"),o.$attr_reader("body"),l(o,"$to_s",function(){var $=this;return $.table_name+"("+$.value+") \uff1e "+$.body}),l(o,"$last_body",function(){var $=this;return P($.body["$is_a?"](_("RollResult")))?$.body.$last_body():$.body}),l(o,"$empty?",B(!1))},Opal.modules["bcdice/dice_table/chain_table"]=function(e){var N,q,I,o,p,_,C,A,G,V=e.module,j=e.klass,l=e.truthy,P=e.def,B=e.rb_minus,d=[],L=e.nil;return N=d,q=G=[V(d[0],"BCDice")].concat(N),I=A=[V(G[0],"DiceTable")].concat(q),p=[o=j(A[0],null,"ChainTable")].concat(I),_=e.$r(p),(C=o.$$prototype).times=C.sides=C.items=C.name=L,P(o,"$initialize",function($,k,H){var S=this,K=L;return S.name=$,S.items=H.$freeze(),K=/(\d+)D(\d+)/i.$match(k),l(K)||S.$raise(_("ArgumentError"),"Unexpected table type: "+k),S.times=K["$[]"](1).$to_i(),S.sides=K["$[]"](2).$to_i()}),P(o,"$roll",function($){var H,S,k=this,K=L;return H=$.$roll_sum(k.times,k.sides),S=B(H,k.times),K=k.items["$[]"](S),l(K["$respond_to?"]("roll"))&&(K=K.$roll($)),_("RollResult").$new(k.name,H,K)})},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(e){var Q,E,_,C,n,$,k,I,Y,V=e.module,j=e.klass,l=e.hash2,P=e.defs,B=e.def,d=e.rb_plus,L=e.rb_times,v=e.rb_minus,N=[],F=e.nil;return Q=N,E=Y=[V(N[0],"BCDice")].concat(Q),_=I=[V(Y[0],"DiceTable")].concat(E),n=[C=j(I[0],null,"D66GridTable")].concat(_),$=e.$r(n),(k=C.$$prototype).name=k.items=F,P(C,"$from_i18n",function(S,K){var T=F;return T=$("I18n").$t(S,l(["locale","raise"],{locale:K,raise:!0})),this.$new(T["$[]"]("name"),T["$[]"]("items"))}),B(C,"$initialize",function(S,K){return this.name=S,this.items=K.$freeze()}),B(C,"$roll",function(S){var z,T,h,y,s;return z=S.$roll_once(6),T=S.$roll_once(6),h=d(L(z,10),T),y=v(z,1),s=v(T,1),$("RollResult").$new(this.name,h,this.items["$[]"](y)["$[]"](s))})},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(e){var F,Y,p,_,C,n,E,i,Q,V=e.module,j=e.klass,l=e.hash2,P=e.defs,B=e.def,L=[],v=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),F=L,Y=Q=[V(L[0],"BCDice")].concat(F),E=[V(Q[0],"DiceTable")].concat(Y),i=e.$r(E),p=E,C=[_=j(E[0],i("D66GridTable"),"D66HalfGridTable")].concat(p),n=e.$r(C),P(_,"$from_i18n",function(k,H){var K=v;return K=n("I18n").$t(k,l(["locale","raise"],{locale:H,raise:!0})),this.$new(K["$[]"]("name"),K["$[]"]("items_1_2_3"),K["$[]"]("items_4_5_6"))}),B(_,"$initialize",function(k,H,S){return this.name=k,this.items=[H,H,H,S,S,S].$freeze()})},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(e){var F,Y,p,_,C,n,E,i,Q,V=e.module,j=e.klass,l=e.hash2,P=e.defs,B=e.def,L=[],v=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),F=L,Y=Q=[V(L[0],"BCDice")].concat(F),E=[V(Q[0],"DiceTable")].concat(Y),i=e.$r(E),p=E,C=[_=j(E[0],i("D66GridTable"),"D66OneThirdTable")].concat(p),n=e.$r(C),P(_,"$from_i18n",function(k,H){var K=v;return K=n("I18n").$t(k,l(["locale","raise"],{locale:H,raise:!0})),this.$new(K["$[]"]("name"),K["$[]"]("items_1_2"),K["$[]"]("items_3_4"),K["$[]"]("items_5_6"))}),B(_,"$initialize",function(k,H,S,K){return this.name=k,this.items=[H,H,S,S,K,K].$freeze()})},Opal.modules["bcdice/dice_table/d66_table"]=function(e){var Y,I,n,$,k,H,S,p,E,V=e.module,j=e.klass,l=e.hash2,P=e.defs,B=e.def,d=e.eqeqeq,L=e.rb_plus,v=e.rb_times,N=e.truthy,F=[],G=e.nil,Q=e.$$$;return Y=F,I=E=[V(F[0],"BCDice")].concat(Y),n=p=[V(E[0],"DiceTable")].concat(I),k=[$=j(p[0],null,"D66Table")].concat(n),H=e.$r(k),(S=$.$$prototype).sort_type=S.items=S.name=G,P($,"$from_i18n",function(z,T){var s,y=G;return y=H("I18n").$t(z,l(["locale"],{locale:T})),s=H("D66SortType").$const_get(y["$[]"]("d66_sort_type")),this.$new(y["$[]"]("name"),s,y["$[]"]("items"))}),B($,"$initialize",function(z,T,h){var y=this;return y.name=z,y.sort_type=T,y.items=h.$freeze()}),B($,"$roll",function(z){var T=this,h=G,y=G,s=G,c=G;return h=z.$roll_barabara(2,6),d(Q(H("D66SortType"),"ASC"),y=T.sort_type)?h["$sort!"]():d(Q(H("D66SortType"),"DESC"),y)&&h["$sort!"]()["$reverse!"](),s=L(v(h["$[]"](0),10),h["$[]"](1)),c=N(y=T.items["$[]"](s))?y:T.items["$[]"](s.$to_s()),N(c["$respond_to?"]("roll"))&&(c=c.$roll(z)),H("RollResult").$new(T.name,s,c)}),B($,"$choice",function(z){return H("RollResult").$new(this.name,z,this.items["$[]"](z))})},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(e){var A,o,_,C,i,V=e.module,j=e.klass,l=e.hash2,P=e.send,B=e.to_ary,d=e.rb_plus,L=e.rb_times,v=e.send2,N=e.find_super,F=e.def,Q=[],q=e.nil;return e.top.$require("bcdice/dice_table/d66_table"),A=Q,o=i=[V(Q[0],"BCDice")].concat(A),_=[V(i[0],"DiceTable")].concat(o),C=e.$r(_),F(j(_[0],C("D66Table"),"D66LeftRangeTable"),"$initialize",function H(S,K,z){var y;return H.$$p=null,y=l([],{}),P(z,"each",[],function(c){var u,m;return null==c&&(c=q),u=B(c),m=null==u[1]?q:u[1],P(null==u[0]?q:u[0],"each",[],function(R){return null==R&&(R=q),P(m,"each_with_index",[],function(g,a){var O,re;return null==g&&(g=q),null==a&&(a=q),re=d(L(R,10),d(a,1)),P(y,"[]=",O=[re,g]),O[O.length-1]})})}),v(this,N(this,"initialize",H,!1,!0),"initialize",[S,K,y],null)})},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(e){var q,i,C,n,$,k,H,o,A,V=e.module,j=e.klass,l=e.hash2,P=e.defs,B=e.def,d=e.truthy,L=e.rb_minus,v=e.rb_plus,N=e.rb_times,F=[],G=e.nil;return q=F,i=A=[V(F[0],"BCDice")].concat(q),C=o=[V(A[0],"DiceTable")].concat(i),$=[n=j(o[0],null,"D66ParityTable")].concat(C),k=e.$r($),(H=n.$$prototype).odd=H.even=H.name=G,P(n,"$from_i18n",function(K,z){var h=G;return h=k("I18n").$t(K,l(["locale","raise"],{locale:z,raise:!0})),this.$new(h["$[]"]("name"),h["$[]"]("odd"),h["$[]"]("even"))}),B(n,"$initialize",function(K,z,T){var h=this;return h.name=K,h.odd=z.$freeze(),h.even=T.$freeze()}),B(n,"$roll",function(K){var h,s,c,z=this,T=G;return T=K.$roll_once(6),h=K.$roll_once(6),s=(d(T["$odd?"]())?z.odd:z.even)["$[]"](L(h,1)),c=v(N(T,10),h),k("RollResult").$new(z.name,c,s)})},Opal.modules["bcdice/dice_table/d66_range_table"]=function(e){var F,Y,o,p,_,C,n,E,Q,V=e.module,j=e.klass,l=e.def,P=e.rb_plus,B=e.rb_times,d=e.send,L=[],v=e.nil;return F=L,Y=Q=[V(L[0],"BCDice")].concat(F),o=E=[V(Q[0],"DiceTable")].concat(Y),_=[p=j(E[0],null,"D66RangeTable")].concat(o),C=e.$r(_),(n=p.$$prototype).items=n.name=v,l(p,"$initialize",function(k,H){return this.name=k,this.items=H.$freeze()}),l(p,"$roll",function(k){var S,K,z,T=v;return S=k.$roll_once(6),K=k.$roll_once(6),z=P(B(S,10),K),T=d(this.items,"find",[],function(y){return null==y&&(y=v),y["$[]"](0)["$include?"](z)}),C("RollResult").$new(this.name,z,T["$[]"](1))})},Opal.modules["bcdice/dice_table/range_table"]=function(e){var A,o,$,z,h,y,k,H,S,K,_,i,V=e.module,j=e.klass,l=e.const_set,P=e.send,B=e.hash2,d=e.def,L=e.eqeqeq,v=e.truthy,N=e.to_a,F=e.rb_times,G=e.rb_plus,Q=[],q=e.nil;return A=Q,o=i=[V(Q[0],"BCDice")].concat(A),$=_=[V(i[0],"DiceTable")].concat(o),H=[k=j(_[0],null,"RangeTable")].concat($),S=e.$r(H),(K=k.$$prototype).name=K.items=K.num_of_dice=K.num_of_sides=K.formatter=q,l(H[0],"RollResult",P(S("Struct"),"new",["sum","values","content","formatted"],function z(){return(null==z.$$s?this:z.$$s).$alias_method("to_s","formatted")},{$$s:k})),l(H[0],"Item",S("Struct").$new("range","content")),l(H[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),l(H[0],"DEFAULT_FORMATTER",P(k,"lambda",[],function(T,h){return null==T&&(T=q),null==h&&(h=q),T.$name()+"("+h.$sum()+") \uff1e "+h.$content()})),k.$attr_reader("name"),k.$attr_reader("num_of_dice"),k.$attr_reader("num_of_sides"),h=[z=e.get_singleton_class(k)].concat(H),y=e.$r(h),d(z,"$from_i18n",function(c,u){var m,f=q;return f=y("I18n").$t(c,B(["locale"],{locale:u})),m=P(f["$[]"]("items"),"map",[],function t(R){return null==R&&(R=q),[(null==t.$$s?this:t.$$s).$conv_string_range(R["$[]"](0)),R["$[]"](1)]},{$$s:this}),this.$new(f["$[]"]("name"),f["$[]"]("type"),m)}),d(z,"$conv_string_range",function(c){var b,u=this;return null==u.name&&(u.name=q),L(y("Integer"),b=c)?c:L(y("String"),b)?v(c["$include?"](".."))?P(y("Range"),"new",N(P(c.$split("..",2),"map",[],function f(m){return null==m&&(m=q),(null==f.$$s?this:f.$$s).$Integer(m)},{$$s:u}))):u.$Integer(c):u.$raise(y("TypeError"),u.name+": "+c+" ("+c.$class()+") must be a String or an Integer")}),d(k,"$initialize",function z(T,h,y){var u,s=z.$$p||q,c=this,b=q;return z.$$p=null,c.name=T.$freeze(),c.formatter=v(u=s)?u:S("DEFAULT_FORMATTER"),b=S("DICE_ROLL_METHOD_RE").$match(h),v(b)||c.$raise(S("ArgumentError"),c.name+": invalid dice roll method: "+h),c.num_of_dice=b["$[]"](1).$to_i(),c.num_of_sides=b["$[]"](2).$to_i(),c.$store(y)}),d(k,"$fetch",function(T){var y,h=this;return y=P(h.items,"find",[],function(c){return null==c&&(c=q),c.$range()["$include?"](T)}),v(y)||h.$raise(S("RangeError"),h.name+": value is out of range: "+T),y}),d(k,"$roll",function(T){var s,h=this,y=q,c=q;return s=(y=T.$roll_barabara(h.num_of_dice,h.num_of_sides)).$sum(),(c=S("RollResult").$new(s,y,h.$fetch(s).$content()))["$formatted="](h.formatter["$[]"](h,c)),c}),k.$private(),d(k,"$store",function(T){var y,s,h=this;return y=P(T,"map",[],function c(u,b){return null==u&&(u=q),null==b&&(b=q),[(null==c.$$s?this:c.$$s).$coerce_to_int_range(u),b]},{$$s:h}),s=P(y,"sort_by",[],function(u,b){return null==u&&(u=q),null==b&&(b=q),u.$min()}),h.$assert_min_sum_is_covered(s),h.$assert_max_sum_is_covered(s),h.$assert_no_gap_or_overlap_in_ranges(s),h.items=P(s,"map",[],function(u,b){return null==u&&(u=q),null==b&&(b=q),S("Item").$new(u,b.$freeze()).$freeze()}).$freeze(),h}),d(k,"$coerce_to_int_range",function(T){var y;return L(S("Integer"),y=T)?S("Range").$new(T,T):L(S("Range"),y)&&v(T.$begin()["$is_a?"](S("Integer")))&&v(T.$end()["$is_a?"](S("Integer")))?T:this.$raise(S("TypeError"),this.name+": "+T+" ("+T.$class()+") must be an Integer or a Range with Integers ")}),d(k,"$assert_min_sum_is_covered",function(T){var y,h=this,s=q;return y=h.num_of_dice,s=T.$first()["$[]"](0),v(s["$include?"](y))||h.$raise(S("RangeError"),h.name+": min value ("+y+") is not covered: "+s),h}),d(k,"$assert_max_sum_is_covered",function(T){var y,h=this,s=q;return y=F(h.num_of_dice,h.num_of_sides),s=T.$last()["$[]"](0),v(s["$include?"](y))||h.$raise(S("RangeError"),h.name+": max value ("+y+") is not covered: "+s),h}),d(k,"$assert_no_gap_or_overlap_in_ranges",function(T){return P(T,"each_cons",[2],function y(s,c){var m,t,u=null==y.$$s?this:y.$$s,b=q,f=q;return null==u.name&&(u.name=q),null==s&&(s=q),null==c&&(c=q),b=s["$[]"](0),f=c["$[]"](0),m=b.$max(),t=G(m,1),v(f["$include?"](m))&&u.$raise(S("RangeError"),u.name+": Range overlap: "+b+" and "+f),v(f["$include?"](t))?q:u.$raise(S("RangeError"),u.name+": Range gap: "+b+" and "+f)},{$$s:this}),this})},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(e){var G,A,p,k,H,S,K,C,i,q,V=e.module,j=e.klass,l=e.send,P=e.def,B=e.rb_minus,d=e.return_ivar,L=[],v=e.nil,N=e.$$$;return G=L,A=q=[V(L[0],"BCDice")].concat(G),p=i=[V(q[0],"DiceTable")].concat(A),k=C=[j(i[0],null,"SaiFicSkillTable")].concat(p),S=[H=j(C[0],null,"Category")].concat(k),K=e.$r(S),P(H,"$initialize",function(T,h,y,s){var c=this;return c.name=T,c.skills=l(h.$map(),"with_index",[2],function(b,f){return null==b&&(b=v),null==f&&(f=v),N(K("SaiFicSkillTable"),"Skill").$new(T,b,y,f,s)}),c.dice=y}),P(H,"$roll",function(T){return this.$skills()["$[]"](B(T.$roll_sum(2,6),2))}),P(H,"$to_s",d("name")),H.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(e){var v,Q,i,C,n,o,Y,F,V=e.module,j=e.klass,l=e.def,P=e.hash2,B=[],d=e.nil;return v=B,Q=F=[V(B[0],"BCDice")].concat(v),i=Y=[V(F[0],"DiceTable")].concat(Q),o=[j(Y[0],null,"SaiFicSkillTable")].concat(i),(n=(C=j(o[0],null,"Skill")).$$prototype).s_format=n.category_dice=n.row_dice=n.category_name=n.name=d,l(C,"$initialize",function(k,H,S,K,z){var T=this;return T.category_name=k,T.name=H,T.category_dice=S,T.row_dice=K,T.s_format=z}),l(C,"$to_s",function(){var k=this;return k.$format(k.s_format,P(["category_dice","row_dice","category_name","skill_name"],{category_dice:k.category_dice,row_dice:k.row_dice,category_name:k.category_name,skill_name:k.name}))}),C.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(e){var o,n,K,z,T,h,y,k,_,V=e.module,j=e.klass,l=e.ensure_kwargs,P=e.hash2,B=e.send,L=e.defs,v=e.const_set,N=e.to_ary,F=e.def,G=e.truthy,Q=e.rb_minus,q=e.rb_plus,Y=e.top,A=[],E=e.nil,i=e.$$$;return Y.$require("bcdice/dice_table/sai_fic_skill_table/category"),Y.$require("bcdice/dice_table/sai_fic_skill_table/skill"),o=A,n=_=[V(A[0],"BCDice")].concat(o),K=k=[V(_[0],"DiceTable")].concat(n),T=[z=j(k[0],null,"SaiFicSkillTable")].concat(K),h=e.$r(T),(y=z.$$prototype).rtt=y.rtt_format=y.rct=y.rct_format=y.rttn=y.rttn_format=y.categories=E,L(z,"$from_i18n",function(c,u,b){var f,m,t,a,g=E;return null==(f=(b=l(b)).$$smap.rtt)&&(f=E),null==(m=b.$$smap.rct)&&(m=E),null==(t=b.$$smap.rttn)&&(t=E),a=(g=h("I18n").$t("RTT",P(["locale","raise","default"],{locale:u,raise:!1,default:P([],{})})).$merge(h("I18n").$t(c,P(["locale","raise"],{locale:u,raise:!0}))))["$[]"]("items"),g=B(g,"select",[],function(re,ee){return null==re&&(re=E),null==ee&&(ee=E),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](re)}),this.$new(a,e.to_hash(g).$merge(P(["rtt","rct","rttn"],{rtt:f,rct:m,rttn:t})))},-3),v(T[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),v(T[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),v(T[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),v(T[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),F(z,"$initialize",function(c,u){var b,f,m,t,R,r,g,a=this;return null==(b=(u=l(u)).$$smap.rtt)&&(b=E),null==(f=u.$$smap.rct)&&(f=E),null==(m=u.$$smap.rttn)&&(m=E),null==(t=u.$$smap.rtt_format)&&(t=h("DEFAULT_RTT")),null==(R=u.$$smap.rct_format)&&(R=h("DEFAULT_RCT")),null==(r=u.$$smap.rttn_format)&&(r=h("DEFAULT_RTTN")),null==(g=u.$$smap.s_format)&&(g=h("DEFAULT_S")),a.categories=B(c.$map(),"with_index",[1],function(re,ee){var $e,oe,ue;return null==re&&(re=E),null==ee&&(ee=E),oe=null==($e=N(re))[0]?E:$e[0],ue=null==$e[1]?E:$e[1],i(h("SaiFicSkillTable"),"Category").$new(oe,ue,ee,g)},{$$has_top_level_mlhs_arg:!0}),a.rtt=b,a.rct=f,a.rttn=m.$to_a(),a.rtt_format=t,a.rct_format=R,a.rttn_format=r},-2),v(T[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),z.$attr_reader("categories"),F(z,"$roll_command",function(c,u){var f,b=this,m=E,t=E;return G(["RTT",b.rtt]["$include?"](f=u))?b.$format_skill(b.rtt_format,b.$roll_skill(c)):G(["RCT",b.rct]["$include?"](f))?(m=b.$roll_category(c),b.$format(b.rct_format,P(["category_dice","category_name"],{category_dice:m.$dice(),category_name:m.$name()}))):G(t=h("RTTN").$index(f))||G(t=b.rttn.$index(f))?b.$format_skill(b.rttn_format,b.categories["$[]"](t).$roll(c)):E}),F(z,"$roll_category",function(c){return this.categories["$[]"](Q(c.$roll_once(6),1))}),F(z,"$roll_skill",function(c){return this.$roll_category(c).$roll(c)}),F(z,"$prefixes",function(){var c=this;return q(["RTT[1-6]?","RCT",c.rtt,c.rct],c.rttn).$compact()}),z.$private(),F(z,"$format_skill",function(c,u){return this.$format(c,P(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:u.$category_dice(),row_dice:u.$row_dice(),category_name:u.$category_name(),skill_name:u.$name(),text:u.$to_s()}))})},Opal.modules["bcdice/dice_table/table"]=function(e){var G,A,p,_,C,n,$,i,q,V=e.module,j=e.klass,l=e.hash2,P=e.defs,B=e.truthy,d=e.def,L=e.rb_minus,v=[],N=e.nil;return G=v,A=q=[V(v[0],"BCDice")].concat(G),p=i=[V(q[0],"DiceTable")].concat(A),C=[_=j(i[0],null,"Table")].concat(p),n=e.$r(C),($=_.$$prototype).times=$.sides=$.name=$.items=N,P(_,"$from_i18n",function(H,S){var z=N;return z=n("I18n").$t(H,l(["locale"],{locale:S})),this.$new(z["$[]"]("name"),z["$[]"]("type"),z["$[]"]("items"))}),d(_,"$initialize",function(H,S,K){var z=this,T=N;return z.name=H,z.items=K.$freeze(),T=/(\d+)D(\d+)/i.$match(S),B(T)||z.$raise(n("ArgumentError"),"Unexpected table type: "+S),z.times=T["$[]"](1).$to_i(),z.sides=T["$[]"](2).$to_i()}),d(_,"$roll",function(H){var K,S=this;return K=H.$roll_sum(S.times,S.sides),S.$choice(K)}),d(_,"$choice",function(H){var K,S=this;return K=L(H,S.times),n("RollResult").$new(S.name,H,S.items["$[]"](K))})},Opal.modules["bcdice/dice_table"]=function(e){var V=e.top;return V.$require("bcdice/dice_table/roll_result"),V.$require("bcdice/dice_table/chain_table"),V.$require("bcdice/dice_table/d66_grid_table"),V.$require("bcdice/dice_table/d66_half_grid_table"),V.$require("bcdice/dice_table/d66_one_third_table"),V.$require("bcdice/dice_table/d66_left_range_table"),V.$require("bcdice/dice_table/d66_parity_table"),V.$require("bcdice/dice_table/d66_range_table"),V.$require("bcdice/dice_table/d66_table"),V.$require("bcdice/dice_table/range_table"),V.$require("bcdice/dice_table/sai_fic_skill_table"),V.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(e){var d,F,Q,v,V=e.module,j=e.const_set,l=[];return d=l,F=v=[V(l[0],"BCDice")].concat(d),Q=[V(v[0],"D66SortType")].concat(F),j(Q[0],"NO_SORT","no_sort"),j(Q[0],"ASC","asc"),j(Q[0],"DESC","desc"),function(N,F){var Q=[V(N,"RoundType")].concat(F);return j(Q[0],"CEIL","ceil"),j(Q[0],"FLOOR","floor"),j(Q[0],"ROUND","round")}(v[0],v)},Opal.modules["bcdice/translate"]=function(e){var F,Y,A,E,i,Q,V=e.module,j=e.ensure_kwargs,l=e.kwrestargs,B=e.hash2,d=e.def,L=[],v=e.nil;return F=L,Y=Q=[V(L[0],"BCDice")].concat(F),E=[A=V(Q[0],"Translate")].concat(Y),i=e.$r(E),d(A,"$translate",function(o,p){var _,C=this;return null==C.locale&&(C.locale=v),p=j(p),_=l(p,{}),i("I18n").$translate(o,B(["locale","raise"],{locale:C.locale,raise:!0}).$merge(e.to_hash(_)))},-2)},Opal.modules["bcdice/result"]=function(e){var A,I,E,F,Q,j=e.klass,l=e.send,P=e.def,B=e.return_val,d=e.return_ivar,L=[],v=e.nil;return F=L,A=Q=[(0,e.module)(L[0],"BCDice")].concat(F),[E=j(Q[0],null,"Result")].concat(A),P(I=e.get_singleton_class(E),"$success",function(_){return l(this.$new(),"tap",[],function($){var k;return null==$&&($=v),$["$text="](_),l($,"success=",k=[!0]),k[k.length-1]})}),P(I,"$failure",function(_){return l(this.$new(),"tap",[],function($){var k;return null==$&&($=v),$["$text="](_),l($,"failure=",k=[!0]),k[k.length-1]})}),P(I,"$critical",function(_){return l(this.$new(),"tap",[],function($){var k;return null==$&&($=v),$["$text="](_),$["$critical="](!0),l($,"success=",k=[!0]),k[k.length-1]})}),P(I,"$fumble",function(_){return l(this.$new(),"tap",[],function($){var k;return null==$&&($=v),$["$text="](_),$["$fumble="](!0),l($,"failure=",k=[!0]),k[k.length-1]})}),P(I,"$nothing",B("nothing")),P(E,"$initialize",function(o){var p=this;return null==o&&(o=v),p.text=o,p.rands=v,p.detailed_rands=v,p.secret=!1,p.success=!1,p.failure=!1,p.critical=!1,p.fumble=!1},-1),E.$attr_accessor("text","rands","detailed_rands"),E.$attr_writer("secret","success","failure","critical","fumble"),P(E,"$secret?",d("secret")),P(E,"$success?",d("success")),P(E,"$failure?",d("failure")),P(E,"$critical?",d("critical")),P(E,"$fumble?",d("fumble")),P(E,"$condition=",function(o){return this.success=o,this.failure=o["$!"]()})},Opal.modules["racc/parser"]=function(e){var H,K,z,V=e.module,j=e.klass,l=e.truthy,P=e.const_set,B=e.defs,d=e.gvars,L=e.rb_lt,v=e.def,N=e.to_ary,F=e.send,G=e.neqeq,Q=e.rb_plus,q=e.eqeq,Y=e.rb_ge,A=e.rb_gt,E=e.rb_minus,i=e.rb_le,I=e.rb_times,o=e.assign_ivar_val,_=[],C=e.$r(_),n=e.nil,$=e.$$$;return H=_,K=[V(_[0],"Racc")].concat(H),z=e.$r(K),j(K[0],z("StandardError"),"ParseError"),l($("::","ParseError","skip_raise")?"constant":n)||P(_[0],"ParseError",$(C("Racc"),"ParseError")),function(k,H){var s,c,u,b,f,z=[V(k,"Racc")].concat(H),T=e.$r(z);return l(T("Racc_No_Extensions","skip_raise")?"constant":n)||P(z[0],"Racc_No_Extensions",!1),s=z,u=[c=j(z[0],null,"Parser")].concat(s),b=e.$r(u),(f=c.$$prototype).yydebug=f.racc_debug_out=f.racc_error_status=f.racc_t=f.racc_vstack=f.racc_val=f.racc_state=f.racc_tstack=n,P(u[0],"Racc_Runtime_Version","1.4.6"),P(u[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),P(u[0],"Racc_Runtime_Core_Version_R","1.4.6"),P(u[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),P(u[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),P(u[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),P(u[0],"Racc_Runtime_Core_Version",b("Racc_Runtime_Core_Version_R")),P(u[0],"Racc_Runtime_Core_Revision",b("Racc_Runtime_Core_Revision_R")),P(u[0],"Racc_Runtime_Type","ruby"),B(b("Parser"),"$racc_runtime_type",function(){return b("Racc_Runtime_Type")}),v(c,"$_racc_setup",function(){var t,R,r=this,g=n,a=n;return null==d.stderr&&(d.stderr=n),l($(r.$class(),"Racc_debug_parser"))||(r.yydebug=!1),l(null!=(t=r.yydebug)&&t!==n?"instance-variable":n)||(r.yydebug=!1),l(r.yydebug)&&(l(null!=(R=r.racc_debug_out)&&R!==n?"instance-variable":n)||(r.racc_debug_out=d.stderr),r.racc_debug_out=l(g=r.racc_debug_out)?g:d.stderr),a=$(r.$class(),"Racc_arg"),l(L(a.$size(),14))&&a["$[]="](13,!0),a}),v(c,"$_racc_init_sysvars",function(){var t=this;return t.racc_state=[0],t.racc_tstack=[],t.racc_vstack=[],t.racc_t=n,t.racc_val=n,t.racc_read_next=!0,t.racc_user_yyerror=!1,t.racc_error_status=0}),v(c,"$do_parse",function(){return this.$__send__(b("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),v(c,"$next_token",function(){return this.$raise(b("NotImplementedError"),this.$class()+"#next_token is not defined")}),v(c,"$_racc_do_parse_rb",function(t,R){var r,a=this,O=n,re=n,ee=n,$e=n,oe=n,ue=n,_e=n,le=n;return r=N(t),O=null==r[0]?n:r[0],re=null==r[1]?n:r[1],ee=null==r[2]?n:r[2],$e=null==r[3]?n:r[3],oe=null==r[10]?n:r[10],a.$_racc_init_sysvars(),ue=_e=le=n,F(a,"catch",["racc_end_parse"],function se(){var ae,te,D=null==se.$$s?this:se.$$s,X=n;for(null==D.racc_state&&(D.racc_state=n),null==D.racc_read_next&&(D.racc_read_next=n),null==D.racc_t&&(D.racc_t=n),null==D.yydebug&&(D.yydebug=n),null==D.racc_val&&(D.racc_val=n);l(!0);)for(l(le=$e["$[]"](D.racc_state["$[]"](-1)))?(l(D.racc_read_next)&&G(D.racc_t,0)&&(te=D.$next_token(),ae=N(te),ue=null==ae[0]?n:ae[0],D.racc_val=null==ae[1]?n:ae[1],D.racc_t=l(ue)?l(X=oe["$[]"](ue))?X:1:0,l(D.yydebug)&&D.$racc_read_token(D.racc_t,ue,D.racc_val),D.racc_read_next=!1),le=Q(le,D.racc_t),l(Y(le,0))&&l(_e=O["$[]"](le))&&q(re["$[]"](le),D.racc_state["$[]"](-1))||(_e=ee["$[]"](D.racc_state["$[]"](-1)))):_e=ee["$[]"](D.racc_state["$[]"](-1));l(_e=D.$_racc_evalact(_e,t)););},{$$s:a})}),v(c,"$yyparse",function(t,R){return this.$__send__(b("Racc_YY_Parse_Method"),t,R,this.$_racc_setup(),!0)}),v(c,"$_racc_yyparse_rb",function(t,R,r,g){var a,ee=n,$e=n,ce=n,oe=n,_e=n,le=n,se=n;return a=N(r),ee=null==a[0]?n:a[0],$e=null==a[1]?n:a[1],ce=null==a[2]?n:a[2],oe=null==a[3]?n:a[3],_e=null==a[10]?n:a[10],this.$_racc_init_sysvars(),le=n,se=n,F(this,"catch",["racc_end_parse"],function ae(){var te=null==ae.$$s?this:ae.$$s;for(null==te.racc_state&&(te.racc_state=n);!l(se=oe["$[]"](te.racc_state["$[]"](-1)));)for(;l(le=te.$_racc_evalact(ce["$[]"](te.racc_state["$[]"](-1)),r)););return F(t,"__send__",[R],function D(X,M){var w=null==D.$$s?this:D.$$s,Z=n,x=n;for(null==w.racc_t&&(w.racc_t=n),null==w.racc_state&&(w.racc_state=n),null==w.racc_read_next&&(w.racc_read_next=n),null==X&&(X=n),null==M&&(M=n),w.racc_t=l(X)?l(Z=_e["$[]"](X))?Z:1:0,w.racc_val=M,w.racc_read_next=!1,se=Q(se,w.racc_t),l(Y(se,0))&&l(le=ee["$[]"](se))&&q($e["$[]"](se),w.racc_state["$[]"](-1))||(le=ce["$[]"](w.racc_state["$[]"](-1)));l(le=w.$_racc_evalact(le,r)););for(;l(l(Z=l(x=(se=oe["$[]"](w.racc_state["$[]"](-1)))["$!"]())?x:w.racc_read_next["$!"]())?Z:w.racc_t["$=="](0));)for(l(se)&&l(se=Q(se,w.racc_t))&&l(Y(se,0))&&l(le=ee["$[]"](se))&&q($e["$[]"](se),w.racc_state["$[]"](-1))||(le=ce["$[]"](w.racc_state["$[]"](-1)));l(le=w.$_racc_evalact(le,r)););},{$$s:te})},{$$s:this})}),v(c,"$_racc_evalact",function(t,R){var r,ce,a=this,O=n,re=n,$e=n,oe=n,ue=n,_e=n;if(O=null==(r=N(R))[0]?n:r[0],re=null==r[1]?n:r[1],$e=null==r[3]?n:r[3],ce=null==r[11]?n:r[11],oe=null==r[12]?n:r[12],l(A(t,0))&&l(L(t,ce)))l(A(a.racc_error_status,0))&&(q(a.racc_t,1)||(a.racc_error_status=E(a.racc_error_status,1))),a.racc_vstack.$push(a.racc_val),a.racc_state.$push(t),a.racc_read_next=!0,l(a.yydebug)&&(a.racc_tstack.$push(a.racc_t),a.$racc_shift(a.racc_t,a.racc_tstack,a.racc_vstack));else if(l(L(t,0))&&l(A(t,oe["$-@"]()))){if(ue=F(a,"catch",["racc_jump"],function le(){var se=null==le.$$s?this:le.$$s;return null==se.racc_state&&(se.racc_state=n),se.racc_state.$push(se.$_racc_do_reduce(R,t)),!1},{$$s:a}),l(ue))switch(ue.valueOf()){case 1:return a.racc_user_yyerror=!0,oe["$-@"]();case 2:return ce;default:a.$raise("[Racc Bug] unknown jump code")}}else if(q(t,ce))l(a.yydebug)&&a.$racc_accept(),a.$throw("racc_end_parse",a.racc_vstack["$[]"](0));else{if(q(t,oe["$-@"]())){switch(a.racc_error_status.valueOf()){case 0:l(R["$[]"](21))||a.$on_error(a.racc_t,a.racc_val,a.racc_vstack);break;case 3:q(a.racc_t,0)&&a.$throw("racc_end_parse",n),a.racc_read_next=!0}for(a.racc_user_yyerror=!1,a.racc_error_status=3;l(!0)&&!(l(_e=$e["$[]"](a.racc_state["$[]"](-1)))&&(_e=Q(_e,1),l(Y(_e,0))&&l(t=O["$[]"](_e))&&q(re["$[]"](_e),a.racc_state["$[]"](-1))));)l(i(a.racc_state.$size(),1))&&a.$throw("racc_end_parse",n),a.racc_state.$pop(),a.racc_vstack.$pop(),l(a.yydebug)&&(a.racc_tstack.$pop(),a.$racc_e_pop(a.racc_state,a.racc_tstack,a.racc_vstack));return t}a.$raise("[Racc Bug] unknown action "+t.$inspect())}return l(a.yydebug)&&a.$racc_next_state(a.racc_state["$[]"](-1),a.racc_state),n}),v(c,"$_racc_do_reduce",function(t,R){var r,oe,_e,X,M,w,W,a=this,re=n,ee=n,$e=n,ce=n,ue=n,le=n,se=n,ae=n,te=n,D=n,Z=n,x=n,J=n;return re=null==(r=N(t))[4]?n:r[4],ee=null==r[5]?n:r[5],$e=null==r[6]?n:r[6],ce=null==r[7]?n:r[7],oe=null==r[8]?n:r[8],ue=null==r[9]?n:r[9],_e=null==r[13]?n:r[13],le=a.racc_state,se=a.racc_vstack,ae=a.racc_tstack,te=I(R,-3),D=ue["$[]"](te),X=ue["$[]"](Q(te,1)),M=ue["$[]"](Q(te,2)),w=[],l(a.yydebug)&&(Z=ae["$[]"](D["$-@"](),D)),x=se["$[]"](D["$-@"](),D),l(a.yydebug)&&ae["$[]="](D["$-@"](),D,w),se["$[]="](D["$-@"](),D,w),le["$[]="](D["$-@"](),D,w),l(_e)?se.$push(a.$__send__(M,x,se,x["$[]"](0))):se.$push(a.$__send__(M,x,se)),ae.$push(X),l(a.yydebug)&&a.$racc_reduce(Z,X,ae,se),W=E(X,oe),l(te=ce["$[]"](W))&&(te=Q(te,le["$[]"](-1)),l(Y(te,0))&&l(J=re["$[]"](te))&&q(ee["$[]"](te),W))?J:$e["$[]"](W)}),v(c,"$on_error",function(t,R,r){var a,g=this;return g.$raise(b("ParseError"),g.$sprintf("\nparse error on value %s (%s)",R.$inspect(),l(a=g.$token_to_str(t))?a:"?"))}),v(c,"$yyerror",function(){return this.$throw("racc_jump",1)}),v(c,"$yyaccept",function(){return this.$throw("racc_jump",2)}),v(c,"$yyerrok",o("racc_error_status",0)),v(c,"$racc_read_token",function(t,R,r){var g=this;return g.racc_debug_out.$print("read    "),g.racc_debug_out.$print(R.$inspect(),"(",g.$racc_token2str(t),") "),g.racc_debug_out.$puts(r.$inspect()),g.racc_debug_out.$puts()}),v(c,"$racc_shift",function(t,R,r){var g=this;return g.racc_debug_out.$puts("shift   "+g.$racc_token2str(t)),g.$racc_print_stacks(R,r),g.racc_debug_out.$puts()}),v(c,"$racc_reduce",function(t,R,r,g){var a=this,O=n;return(O=a.racc_debug_out).$print("reduce "),l(t["$empty?"]())?O.$print(" <none>"):F(t,"each",[],function re(ee){return null==ee&&(ee=n),O.$print(" ",(null==re.$$s?this:re.$$s).$racc_token2str(ee))},{$$s:a}),O.$puts(" --\x3e "+a.$racc_token2str(R)),a.$racc_print_stacks(r,g),a.racc_debug_out.$puts()}),v(c,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),v(c,"$racc_e_pop",function(t,R,r){var g=this;return g.racc_debug_out.$puts("error recovering mode: pop token"),g.$racc_print_states(t),g.$racc_print_stacks(R,r),g.racc_debug_out.$puts()}),v(c,"$racc_next_state",function(t,R){var r=this;return r.racc_debug_out.$puts("goto    "+t),r.$racc_print_states(R),r.racc_debug_out.$puts()}),v(c,"$racc_print_stacks",function(t,R){var g=n;return(g=this.racc_debug_out).$print("        ["),F(t,"each_index",[],function a(O){return null==O&&(O=n),g.$print(" (",(null==a.$$s?this:a.$$s).$racc_token2str(t["$[]"](O))," ",R["$[]"](O).$inspect(),")")},{$$s:this}),g.$puts(" ]")}),v(c,"$racc_print_states",function(t){var r=n;return(r=this.racc_debug_out).$print("        ["),F(t,"each",[],function(a){return null==a&&(a=n),r.$print(" ",a)}),r.$puts(" ]")}),v(c,"$racc_token2str",function(t){var r;return l(r=$(this.$class(),"Racc_token_to_s_table")["$[]"](t))?r:this.$raise("[Racc Bug] can't convert token "+t+" to string")}),v(c,"$token_to_str",function(t){return $(this.$class(),"Racc_token_to_s_table")["$[]"](t)})}(_[0],_)},Opal.modules["bcdice/arithmetic/node"]=function(e){var o,n,S,s,c,z,T,k,_,V=e.module,j=e.klass,l=e.def,P=e.thrower,B=e.return_ivar,d=e.send2,L=e.find_super,v=e.eqeq,N=e.const_set,F=e.eqeqeq,G=e.rb_divide,Q=e.truthy,q=e.assign_ivar,Y=e.alias,A=[],E=e.nil,i=e.$$$;return o=A,n=_=[V(A[0],"BCDice")].concat(o),S=k=[V(_[0],"Arithmetic")].concat(n),z=[V(k[0],"Node")].concat(S),T=e.$r(z),(c=(s=j(z[0],null,"BinaryOp")).$$prototype).lhs=c.rhs=c.op=E,l(s,"$initialize",function(b,f,m){var t=this;return t.lhs=b,t.op=f,t.rhs=m}),l(s,"$eval",function(b){try{P("eval_return");var R,m=this,t=E;return t=m.lhs.$eval(b),R=m.rhs.$eval(b),t.$send(m.op,R)}catch(r){if(r===e.t_eval_return)return r.$v;throw r}}),l(s,"$output",function(){var b=this;return""+b.lhs.$output()+b.op+b.rhs.$output()}),l(s,"$s_exp",function(){var b=this;return"("+b.$op_for_s_exp()+" "+b.lhs.$s_exp()+" "+b.rhs.$s_exp()+")"}),l(s,"$op_for_s_exp",B("op")),function(h,y,s){var c=j(h,y,"DivideBase"),u=[c].concat(s),b=e.$r(u),f=c.$$prototype;f.lhs=f.rhs=f.op=E,l(c,"$initialize",function m(t,R){return m.$$p=null,d(this,L(this,"initialize",m,!1,!0),"initialize",[t,"/",R],null)}),l(c,"$eval",function(t){try{P("eval_return");var g,a,r=this;return g=r.lhs.$eval(t),a=r.rhs.$eval(t),v(a,0)&&r.$raise(b("ZeroDivisionError")),r.$divide_and_round(g,a,t)}catch(O){if(O===e.t_eval_return)return O.$v;throw O}}),l(c,"$output",function m(){var t=m.$$p||E,R=this;return m.$$p=null,""+d(R,L(R,"output",m,!1,!0),"output",[],t)+R.$rounding_method()}),c.$private(),l(c,"$rounding_method",function(){return i(this.$class(),"ROUNDING_METHOD")}),l(c,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),l(c,"$divide_and_round",function(t,R,r){return this.$raise(b("NotImplementedError"))})}(z[0],T("BinaryOp"),z),function(h,y,s){var c=j(h,y,"DivideWithGameSystemDefault"),u=[c].concat(s),b=e.$r(u);N(u[0],"ROUNDING_METHOD",""),c.$private(),l(c,"$divide_and_round",function(m,t,R){var r,g=E;return F(i(b("RoundType"),"CEIL"),r=R)?G(m.$to_f(),t).$ceil():F(i(b("RoundType"),"ROUND"),r)?(g=G(m.$to_f(),t),Q(g["$negative?"]())?g.$abs().$round()["$-@"]():g.$round()):G(m,t).$floor()})}(z[0],T("DivideBase"),z),function(h,y,s){var c=j(h,y,"DivideWithCeil"),u=[c].concat(s);N(u[0],"ROUNDING_METHOD","C"),c.$private(),l(c,"$divide_and_round",function(f,m,t){return G(f.$to_f(),m).$ceil()})}(z[0],T("DivideBase"),z),function(h,y,s){var c=j(h,y,"DivideWithRound"),u=[c].concat(s);N(u[0],"ROUNDING_METHOD","R"),c.$private(),l(c,"$divide_and_round",function(f,m,t){var R=E;return R=G(f.$to_f(),m),Q(R["$negative?"]())?R.$abs().$round()["$-@"]():R.$round()})}(z[0],T("DivideBase"),z),function(h,y,s){var c=j(h,y,"DivideWithFloor"),u=[c].concat(s);N(u[0],"ROUNDING_METHOD","F"),c.$private(),l(c,"$divide_and_round",function(f,m,t){return G(f,m).$floor()})}(z[0],T("DivideBase"),z),function(h,y){var s=j(h,null,"Negative");s.$$prototype.body=E,l(s,"$initialize",q("body")),l(s,"$eval",function(b){try{return P("eval_return"),this.body.$eval(b)["$-@"]()}catch(t){if(t===e.t_eval_return)return t.$v;throw t}}),l(s,"$output",function(){return"-"+this.body.$output()}),l(s,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(z[0]),function(h,y){var s=j(h,null,"Parenthesis");s.$$prototype.expr=E,l(s,"$initialize",q("expr")),l(s,"$eval",function(b){try{return P("eval_return"),this.expr.$eval(b)}catch(t){if(t===e.t_eval_return)return t.$v;throw t}}),l(s,"$output",function(){return"("+this.expr.$output()+")"}),l(s,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(z[0]),function(h,y){var s=j(h,null,"Number");return s.$$prototype.value=E,l(s,"$initialize",q("value")),l(s,"$eval",B("value")),l(s,"$output",function(){return this.value.$to_s()}),Y(s,"s_exp","output")}(z[0])},Opal.modules.strscan=function(e){var q,Y,A,E,i,j=e.def,l=e.truthy,P=e.eqeqeq,B=e.Opal,d=e.return_ivar,L=e.send,v=e.alias,N=[],F=e.nil;return q=N,A=[Y=(0,e.klass)(N[0],null,"StringScanner")].concat(q),E=e.$r(A),(i=Y.$$prototype).pos=i.string=i.working=i.matched=i.prev_pos=i.match=F,Y.$attr_reader("pos","matched"),j(Y,"$initialize",function(o){var p=this;return p.string=o,p.pos=0,p.matched=F,p.working=o,p.match=[]}),Y.$attr_reader("string"),j(Y,"$beginning_of_line?",function(){var o=this;return 0===o.pos||"\n"===o.string.charAt(o.pos-1)}),j(Y,"$scan",function(o){var p=this,_=(o=p.$anchor(o)).exec(p.working);return null==_?p.matched=F:(p.prev_pos=p.pos,p.pos+=_[0].length,p.working=p.working.substring(_[0].length),p.matched=_[0],p.match=_,_[0])}),j(Y,"$scan_until",function(o){var p=this;o=p.$anchor(o);for(var _=p.working,C=0;_.length!=C;++C){var n=o.exec(_.substr(C));if(null!==n){var $=C+n[0].length,k=_.substr(0,$);return p.matched=n[0],p.match=n,p.prev_pos=p.pos+C,p.pos+=$,p.working=_.substr($),k}}return p.matched=F}),j(Y,"$[]",function(o){var _;if(l(this.match["$empty?"]()))return F;P(E("Symbol"),_=o)?o=o.$to_s():P(E("String"),_)||(o=B["$coerce_to!"](o,E("Integer"),"to_int"));var C=this.match;return o<0&&(o+=C.length),o<0||o>=C.length||null==C[o]?F:C[o]}),j(Y,"$check",function(o){var p=this,_=(o=p.$anchor(o)).exec(p.working);return p.matched=null==_?F:_[0]}),j(Y,"$check_until",function(o){var p=this,_=p.prev_pos,C=p.pos,n=p.working,$=p.$scan_until(o);return p.prev_pos=_,p.pos=C,p.working=n,$}),j(Y,"$peek",function(o){return this.working.substring(0,o)}),j(Y,"$eos?",function(){return 0===this.working.length}),j(Y,"$exist?",function(o){var _=o.exec(this.working);return null==_?F:0==_.index?0:_.index+1}),j(Y,"$skip",function(o){var p=this,_=(o=p.$anchor(o)).exec(p.working);if(null==_)return p.match=[],p.matched=F;var C=_[0],n=C.length;return p.matched=C,p.match=_,p.prev_pos=p.pos,p.pos+=n,p.working=p.working.substring(n),n}),j(Y,"$skip_until",function(o){var _=this.$scan_until(o);return _===F?F:(this.matched=_.substr(-1),_.length)}),j(Y,"$get_byte",function(){var o=this,p=F;return o.pos<o.string.length?(o.prev_pos=o.pos,o.pos+=1,p=o.matched=o.working.substring(0,1),o.working=o.working.substring(1)):o.matched=F,p}),j(Y,"$match?",function(o){var p=this,_=(o=p.$anchor(o)).exec(p.working);return null==_?F:(p.prev_pos=p.pos,_[0].length)}),j(Y,"$pos=",function(o){var p=this;return o<0&&(o+=p.string.$length()),p.pos=o,p.working=p.string.slice(o)}),j(Y,"$matched_size",function(){return this.matched===F?F:this.matched.length}),j(Y,"$post_match",function(){var o=this;return o.matched===F?F:o.string.substr(o.pos)}),j(Y,"$pre_match",function(){var o=this;return o.matched===F?F:o.string.substr(0,o.prev_pos)}),j(Y,"$reset",function(){var o=this;return o.working=o.string,o.matched=F,o.pos=0}),j(Y,"$rest",d("working")),j(Y,"$rest?",function(){return 0!==this.working.length}),j(Y,"$rest_size",function(){return this.$rest().$size()}),j(Y,"$terminate",function(){var o,p=this;return p.match=F,o=[p.string.$length()],L(p,"pos=",o),o[o.length-1]}),j(Y,"$unscan",function(){var o=this;return o.pos=o.prev_pos,o.prev_pos=F,o.match=F,o}),v(Y,"bol?","beginning_of_line?"),v(Y,"getch","get_byte"),Y.$private(),j(Y,"$anchor",function(o){var p=o.toString().match(/\/([^\/]+)$/);return p=p?p[1]:void 0,new RegExp("^(?:"+o.source+")",p)})},Opal.modules["bcdice/normalize"]=function(e){var v,Q,F,V=e.module,j=e.eqeqeq,l=e.def,P=e.eqeq,B=[],d=e.nil;return v=B,F=[V(B[0],"BCDice")].concat(v),(Q=V(F[0],"Normalize")).$module_function(),l(Q,"$comparison_operator",function(Y){var A;return j(/<=|=</,A=Y)?"<=":j(/>=|=>/,A)?">=":j(/<>|!=|=!/,A)?"!=":j(/</,A)?"<":j(/>/,A)?">":j(/=/,A)?"==":d}),l(Q,"$target_number",function(Y){return P(Y,"?")?Y:Y.$to_i()})},Opal.modules["bcdice/command/lexer"]=function(e){var q,i,C,n,$,k,H,o,A,V=e.module,j=e.klass,l=e.const_set,P=e.hash2,B=e.truthy,d=e.send,L=e.def,v=e.thrower,N=e.top,F=[],G=e.nil;return N.$require("strscan"),N.$require("bcdice/normalize"),q=F,i=A=[V(F[0],"BCDice")].concat(q),C=o=[V(A[0],"Command")].concat(i),$=[n=j(o[0],null,"Lexer")].concat(C),k=e.$r($),(H=n.$$prototype).scanner=H.notations=G,l($[0],"SYMBOLS",P(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),L(n,"$initialize",function(K,z){var T,h,s;return K=B(s=(T=(h=K)===G||null==h?G:h.$split(" ",2))===G||null==T?G:T.$first())?s:"",this.scanner=k("StringScanner").$new(K),this.notations=d(z,"map",[],function(u){return null==u&&(u=G),B(u["$is_a?"](k("String")))?k("Regexp").$new(u):u})}),L(n,"$next_token",function(){try{var K=v("return"),z=this,T=G,h=G,s=G,c=G;return B(z.scanner["$eos?"]())?[!1,"$"]:(d(z.notations,"each",[],function u(b){var m,f=null==u.$$s?this:u.$$s;if(null==f.scanner&&(f.scanner=G),null==b&&(b=G),m=f.scanner.$scan(b),!B(m))return G;K.$throw(["NOTATION",m])},{$$s:z,$$ret:K}),B(T=z.scanner.$scan(/\d+/))?["NUMBER",T.$to_i()]:B(h=z.scanner.$scan(/[<>!=]+/))?(h=k("Normalize").$comparison_operator(h),[B(h)?"CMP_OP":"ILLEGAL",h]):(s=z.scanner.$getch().$upcase(),[B(c=k("SYMBOLS")["$[]"](s))?c:s.$to_sym(),s]))}catch(u){if(u===K)return u.$v;throw u}}),L(n,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/command/parsed"]=function(e){var N,q,I,o,p,_,C,A,G,V=e.module,j=e.klass,l=e.def,P=e.return_ivar,B=e.truthy,d=[],L=e.nil;return N=d,q=G=[V(d[0],"BCDice")].concat(N),I=A=[V(G[0],"Command")].concat(q),p=[o=j(A[0],null,"Parsed")].concat(I),_=e.$r(p),(C=o.$$prototype).critical=C.fumble=C.dollar=C.modify_number=C.question_target=C.target_number=C.prefix_number=C.command=C.suffix_number=C.cmp_op=L,o.$attr_accessor("command"),o.$attr_accessor("prefix_number"),o.$attr_accessor("suffix_number"),o.$attr_accessor("critical"),o.$attr_accessor("fumble"),o.$attr_accessor("dollar"),o.$attr_accessor("modify_number"),o.$attr_accessor("cmp_op"),o.$attr_accessor("target_number"),o.$attr_writer("question_target"),l(o,"$initialize",function(){var $=this;return $.prefix_number=L,$.suffix_number=L,$.critical=L,$.fumble=L,$.dollar=L,$.cmp_op=L,$.target_number=L,$.question_target=!1}),l(o,"$question_target?",P("question_target")),l(o,"$to_s",function($){var k=this,H=L,S=L,K=L,z=L,T=L;switch(null==$&&($="after_command"),H=B(k.critical)?"@"+k.critical:L,S=B(k.fumble)?"#"+k.fumble:L,K=B(k.dollar)?"$"+k.dollar:L,z=_("Format").$modifier(k.modify_number),T=B(k.question_target)?"?":k.target_number,$.valueOf()){case"after_command":return[k.prefix_number,k.command,k.suffix_number,H,S,K,z,k.cmp_op,T].$join();case"after_modify_number":return[k.prefix_number,k.command,k.suffix_number,z,H,S,K,k.cmp_op,T].$join();case"after_target_number":return[k.prefix_number,k.command,k.suffix_number,z,k.cmp_op,T,H,S,K].$join();default:return L}},-1)},Opal.modules["bcdice/command/parser"]=function(e){var $,K,c,R,r,g,a,O,re,ee,$e,ce,_e,u,m,t,ae,T,h,H,V=e.klass,j=e.module,l=e.slice,P=e.extract_kwargs,B=e.ensure_kwargs,d=e.get_kwarg,L=e.send2,v=e.find_super,N=e.def,F=e.send,G=e.eqeq,Q=e.thrower,q=e.hash,Y=e.const_set,A=e.truthy,E=e.to_ary,i=e.hash2,I=e.top,o=[],p=e.$r(o),_=e.nil,C=e.$$$;return I.$require("racc/parser.rb"),I.$require("bcdice/arithmetic/node"),I.$require("bcdice/command/lexer"),I.$require("bcdice/command/parsed"),V(C(p("BCDice"),"Command"),C(p("Racc"),"Parser"),"Parser"),$=o,K=H=[j(o[0],"BCDice")].concat($),T=[j(H[0],"Command")].concat(K),h=e.$r(T),c=T,m=[u=V(T[0],C(h("Racc"),"Parser"),"Parser")].concat(c),t=e.$r(m),(ae=u.$$prototype).notations=ae.lexer=ae.modifier=ae.suffix_number=ae.prefix_number=ae.need_suffix_number=ae.need_prefix_number=ae.critical=ae.fumble=ae.dollar=ae.allowed_cmp_op=ae.question_target=_,N(u,"$initialize",function te(D,X){var M,w,Z,x,J=this;return te.$$p=null,M=l(arguments),w=P(M),w=B(w),Z=M,x=d(w,"round_type"),L(J,v(J,"initialize",te,!1,!0),"initialize",[],null),J.notations=Z,J.round_type=x,J.prefix_number=!1,J.suffix_number=!1,J.need_prefix_number=!1,J.need_suffix_number=!1,J.modifier=!0,J.critical=!1,J.fumble=!1,J.dollar=!1,J.allowed_cmp_op=[_,">=",">","<=","<","==","!="],J.question_target=!1},-2),N(u,"$disable_modifier",function(){return this.modifier=!1,this}),N(u,"$enable_prefix_number",function(){return this.prefix_number=!0,this}),N(u,"$enable_suffix_number",function(){return this.suffix_number=!0,this}),N(u,"$has_prefix_number",function(){var D=this;return D.prefix_number=!0,D.need_prefix_number=!0,D}),N(u,"$has_suffix_number",function(){var D=this;return D.suffix_number=!0,D.need_suffix_number=!0,D}),N(u,"$enable_critical",function(){return this.critical=!0,this}),N(u,"$enable_fumble",function(){return this.fumble=!0,this}),N(u,"$enable_dollar",function(){return this.dollar=!0,this}),N(u,"$restrict_cmp_op_to",function(D){var X;return X=l(arguments),this.allowed_cmp_op=X,this},-1),N(u,"$enable_question_target",function(){return this.question_target=!0,this}),N(u,"$parse",function(D){var X=this;try{return X.lexer=t("Lexer").$new(D,X.notations),X.$do_parse()}catch(M){if(!e.rescue(M,[t("ParseError"),t("ZeroDivisionError")]))throw M;try{return _}finally{e.pop_exception()}}}),u.$private(),N(u,"$parsed",function(D,X,M,w){try{return Q("eval_return"),F(t("Parsed").$new(),"tap",[],function W(J){var U,ne,ie,fe,me,de,ve,he=null==W.$$s?this:W.$$s;return null==he.round_type&&(he.round_type=_),null==J&&(J=_),J["$command="](D["$[]"]("command")),J["$prefix_number="]((U=D["$[]"]("prefix"))===_||null==U?_:U.$eval(he.round_type)),J["$suffix_number="]((ne=D["$[]"]("suffix"))===_||null==ne?_:ne.$eval(he.round_type)),J["$critical="]((ie=X["$[]"]("critical"))===_||null==ie?_:ie.$eval(he.round_type)),J["$fumble="]((fe=X["$[]"]("fumble"))===_||null==fe?_:fe.$eval(he.round_type)),J["$dollar="]((me=X["$[]"]("dollar"))===_||null==me?_:me.$eval(he.round_type)),J["$modify_number="](M.$eval(he.round_type)),J["$cmp_op="](w["$[]"]("cmp_op")),G(w["$[]"]("target"),"?")?(J["$question_target="](!0),F(J,"target_number=",de=[0]),de[de.length-1]):(J["$question_target="](!1),de=[(ve=w["$[]"]("target"),ve===_||null==ve?_:ve.$eval(he.round_type))],F(J,"target_number=",de),de[de.length-1])},{$$s:this})}catch(W){if(W===e.t_eval_return)return W.$v;throw W}}),N(u,"$next_token",function(){return this.lexer.$next_token()}),R=e.large_array_unpack("6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,33,34,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,,,17,18,6,,5,,,17,18,,,5,23,24,25,26,56,54,55,57"),r=e.large_array_unpack("0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,,17,15,15,18,18,23,,18,30,30,23,23,24,,23,31,31,24,24,25,,24,44,44,25,25,28,,25,47,47,28,28,29,,28,48,48,29,29,33,,29,49,49,33,33,34,,33,50,50,34,34,36,,34,,,36,36,37,,36,,,37,37,,,37,27,27,27,27,52,52,52,52"),g=e.large_array_unpack("-2,4,16,-3,-1,11,,33,13,35,23,30,1,,28,40,,37,44,,,-2,,51,58,65,0,106,72,79,47,54,,86,93,,100,107,,,,,,,63,,,68,75,82,89,,120,,,,,"),a=e.large_array_unpack("-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29"),O=e.large_array_unpack("30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,,,21,47,48,40,51,52,49,50,44,46,3,,,,13,,,,,,,,32"),re=e.large_array_unpack("8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,,,4,8,8,5,7,7,8,8,9,5,6,,,,6,,,,,,,,6"),ee=[_,6,13,3,9,-1,27,-15,-10,-1,-38],$e=[_,_,_,_,_,_,19,16,15,_,_],ce=e.large_array_unpack("0,0,racc_error,4,20,_reduce_1,4,20,_reduce_2,3,20,_reduce_3,3,21,_reduce_4,2,21,_reduce_5,2,21,_reduce_6,1,21,_reduce_7,0,22,_reduce_8,3,22,_reduce_9,3,22,_reduce_10,3,22,_reduce_11,2,23,_reduce_12,2,23,_reduce_13,3,23,_reduce_14,3,23,_reduce_15,0,24,_reduce_16,2,24,_reduce_17,2,24,_reduce_18,3,28,_reduce_19,3,28,_reduce_20,1,28,_reduce_none,3,27,_reduce_22,4,27,_reduce_23,1,27,_reduce_none,0,29,_reduce_25,1,29,_reduce_26,1,29,_reduce_27,1,29,_reduce_28,1,29,_reduce_29,2,26,_reduce_30,2,26,_reduce_31,1,26,_reduce_none,3,25,_reduce_33,1,25,_reduce_34"),_e=q(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),Y(m[0],"Racc_arg",[R,r,a,g,O,re,$e,ee,19,ce,_e,58,35,!0]),A(t("Ractor","skip_raise")?"constant":_)&&t("Ractor").$make_shareable(t("Racc_arg")),Y(m[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),A(t("Ractor","skip_raise")?"constant":_)&&t("Ractor").$make_shareable(t("Racc_token_to_s_table")),Y(m[0],"Racc_debug_parser",!1),N(u,"$_reduce_1",function(D,X,M){var w,x=this;return A(x.modifier)||x.$raise(t("ParseError")),w=E(D),x.$parsed(null==w[0]?_:w[0],null==w[1]?_:w[1],null==w[2]?_:w[2],null==w[3]?_:w[3])}),N(u,"$_reduce_2",function(D,X,M){var w,x=this;return A(x.modifier)||x.$raise(t("ParseError")),w=E(D),x.$parsed(null==w[0]?_:w[0],null==w[2]?_:w[2],null==w[1]?_:w[1],null==w[3]?_:w[3])}),N(u,"$_reduce_3",function(D,X,M){var w,U;return U=null==(w=E(D))[2]?_:w[2],this.$parsed(null==w[0]?_:w[0],null==w[1]?_:w[1],C(C(t("Arithmetic"),"Node"),"Number").$new(0),U)}),N(u,"$_reduce_4",function(D,X,M){var w=this;return A(w.prefix_number)&&A(w.suffix_number)||w.$raise(t("ParseError")),i(["command","prefix","suffix"],{command:D["$[]"](1),prefix:D["$[]"](0),suffix:D["$[]"](2)})}),N(u,"$_reduce_5",function(D,X,M){var w=this;return A(w.prefix_number)||w.$raise(t("ParseError")),A(w.need_suffix_number)&&w.$raise(t("ParseError")),i(["command","prefix"],{command:D["$[]"](1),prefix:D["$[]"](0)})}),N(u,"$_reduce_6",function(D,X,M){var w=this;return A(w.suffix_number)||w.$raise(t("ParseError")),A(w.need_prefix_number)&&w.$raise(t("ParseError")),i(["command","suffix"],{command:D["$[]"](0),suffix:D["$[]"](1)})}),N(u,"$_reduce_7",function(D,X,M){var w=this;return(A(w.need_prefix_number)||A(w.need_suffix_number))&&w.$raise(t("ParseError")),i(["command"],{command:D["$[]"](0)})}),N(u,"$_reduce_8",function(D,X,M){return i([],{})}),N(u,"$_reduce_9",function(D,X,M){var w,U,W=_;return W=null==(w=E(D))[0]?_:w[0],U=null==w[2]?_:w[2],A(this.critical)&&A(W["$[]"]("critical")["$nil?"]())||this.$raise(t("ParseError")),W["$[]="]("critical",U),W}),N(u,"$_reduce_10",function(D,X,M){var w,U,W=_;return W=null==(w=E(D))[0]?_:w[0],U=null==w[2]?_:w[2],A(this.fumble)&&A(W["$[]"]("fumble")["$nil?"]())||this.$raise(t("ParseError")),W["$[]="]("fumble",U),W}),N(u,"$_reduce_11",function(D,X,M){var w,U,W=_;return W=null==(w=E(D))[0]?_:w[0],U=null==w[2]?_:w[2],A(this.dollar)&&A(W["$[]"]("dollar")["$nil?"]())||this.$raise(t("ParseError")),W["$[]="]("dollar",U),W}),N(u,"$_reduce_12",function(D,X,M){return D["$[]"](1)}),N(u,"$_reduce_13",function(D,X,M){return C(C(t("Arithmetic"),"Node"),"Negative").$new(D["$[]"](1))}),N(u,"$_reduce_14",function(D,X,M){return C(C(t("Arithmetic"),"Node"),"BinaryOp").$new(D["$[]"](0),"+",D["$[]"](2))}),N(u,"$_reduce_15",function(D,X,M){return C(C(t("Arithmetic"),"Node"),"BinaryOp").$new(D["$[]"](0),"-",D["$[]"](2))}),N(u,"$_reduce_16",function(D,X,M){return A(this.allowed_cmp_op["$include?"](_))||this.$raise(t("ParseError")),i([],{})}),N(u,"$_reduce_17",function(D,X,M){var w,W,J;return J=null==(w=E(D))[1]?_:w[1],A(this.allowed_cmp_op["$include?"](W=null==w[0]?_:w[0]))||this.$raise(t("ParseError")),i(["cmp_op","target"],{cmp_op:W,target:J})}),N(u,"$_reduce_18",function(D,X,M){var Z,w=this;return Z=D["$[]"](0),A(w.question_target)||w.$raise(t("ParseError")),A(w.allowed_cmp_op["$include?"](Z))||w.$raise(t("ParseError")),i(["cmp_op","target"],{cmp_op:Z,target:"?"})}),N(u,"$_reduce_19",function(D,X,M){return C(C(t("Arithmetic"),"Node"),"BinaryOp").$new(D["$[]"](0),"+",D["$[]"](2))}),N(u,"$_reduce_20",function(D,X,M){return C(C(t("Arithmetic"),"Node"),"BinaryOp").$new(D["$[]"](0),"-",D["$[]"](2))}),N(u,"$_reduce_22",function(D,X,M){return C(C(t("Arithmetic"),"Node"),"BinaryOp").$new(D["$[]"](0),"*",D["$[]"](2))}),N(u,"$_reduce_23",function(D,X,M){return D["$[]"](3).$new(D["$[]"](0),D["$[]"](2))}),N(u,"$_reduce_25",function(D,X,M){return C(C(t("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),N(u,"$_reduce_26",function(D,X,M){return C(C(t("Arithmetic"),"Node"),"DivideWithCeil")}),N(u,"$_reduce_27",function(D,X,M){return C(C(t("Arithmetic"),"Node"),"DivideWithCeil")}),N(u,"$_reduce_28",function(D,X,M){return C(C(t("Arithmetic"),"Node"),"DivideWithRound")}),N(u,"$_reduce_29",function(D,X,M){return C(C(t("Arithmetic"),"Node"),"DivideWithFloor")}),N(u,"$_reduce_30",function(D,X,M){return D["$[]"](1)}),N(u,"$_reduce_31",function(D,X,M){return C(C(t("Arithmetic"),"Node"),"Negative").$new(D["$[]"](1))}),N(u,"$_reduce_33",function(D,X,M){return D["$[]"](1)}),N(u,"$_reduce_34",function(D,X,M){return C(C(t("Arithmetic"),"Node"),"Number").$new(D["$[]"](0))}),N(u,"$_reduce_none",function(D,X,M){return D["$[]"](0)})},Opal.modules["bcdice/deprecated/checker"]=function(e){var F,Y,I,o,p,_,E,Q,V=e.module,j=e.send,l=e.eqeqeq,P=e.truthy,B=e.def,d=e.return_val,L=[],v=e.nil;return F=L,Y=Q=[V(L[0],"BCDice")].concat(F),I=E=[V(Q[0],"Deprecated")].concat(Y),p=[o=V(E[0],"Checker")].concat(I),_=e.$r(p),o.$private(),B(o,"$check_result_legacy",function(n,$,k,H){var T,S=this,K=v,z=v,h=v,y=v;return K=j($,"map",[],"sides".$to_proc()),T=(z=j($,"map",[],"value".$to_proc())).$sum(),h=l([100],y=K)?S.$check_1D100(n,T,k,H):l([20],y)?S.$check_1D20(n,T,k,H):l([6,6],y)?S.$check_2D6(n,T,z,k,H):v,(P(h["$nil?"]())||P(h["$empty?"]()))&&(h=l([10],y=K.$uniq())?S.$check_nD10(n,T,z,k,H):l([6],y)?S.$check_nD6(n,T,z,k,H):v,P(h["$nil?"]())||P(h["$empty?"]()))?v:_("Result").$new(h.$delete_prefix(" \uff1e "))}),B(o,"$check_1D100",d(v)),B(o,"$check_1D20",d(v)),B(o,"$check_nD10",d(v)),B(o,"$check_2D6",d(v)),B(o,"$check_nD6",d(v))},Opal.modules["bcdice/base"]=function(e){var p,S,y,f,t,R,s,c,u,b,z,V=e.module,j=e.klass,l=e.slice,P=e.rb_plus,B=e.truthy,d=e.def,L=e.regexp,v=e.send,N=e.thrower,F=e.return_ivar,G=e.assign_ivar_val,Q=e.eqeqeq,q=e.eqeq,Y=e.return_val,A=e.range,E=e.rb_minus,i=e.rb_divide,I=e.rb_times,o=e.rb_ge,_=e.top,C=[],n=e.$r(C),$=e.nil,k=e.$$$;return _.$require("i18n"),_.$require("i18n/backend/fallbacks"),_.$require("bcdice/randomizer"),_.$require("bcdice/dice_table"),_.$require("bcdice/enum"),_.$require("bcdice/translate"),_.$require("bcdice/result"),_.$require("bcdice/command/parser"),_.$require("bcdice/deprecated/checker"),S=C,y=z=[V(C[0],"BCDice")].concat(S),c=[s=j(z[0],null,"Base")].concat(y),u=e.$r(c),(b=s.$$prototype).raw_input=b.randomizer=b.enabled_upcase_input=b.debug=$,t=[f=e.get_singleton_class(s)].concat(c),R=e.$r(t),f.$attr_reader("prefixes"),d(f,"$register_prefix",function(g){var O,ee;return null==this.prefixes&&(this.prefixes=$),O=l(arguments),this.prefixes=P(B(ee=this.prefixes)?ee:[],O.$flatten())},-1),d(f,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())}),d(f,"$prefixes_pattern",function(){var g=this,a=$;return null==g.prefixes_pattern&&(g.prefixes_pattern=$),null==g.prefixes&&(g.prefixes=$),g.prefixes_pattern=B(a=g.prefixes_pattern)?a:$,B(g.prefixes_pattern)?g.prefixes_pattern:(g.prefixes=B(a=g.prefixes)?a:[],g.prefixes.$freeze(),g.prefixes_pattern=(B(g.prefixes["$empty?"]())?/(?!)/:L(["^(S)?(",g.prefixes.$join("|"),")"],"i")).$freeze())}),d(f,"$command_pattern",function(){var g=this,a=$,O=$;return null==g.command_pattern&&(g.command_pattern=$),null==g.prefixes&&(g.prefixes=$),g.command_pattern=B(a=g.command_pattern)?a:$,B(g.command_pattern)?g.command_pattern:(g.prefixes=B(a=g.prefixes)?a:[],g.prefixes.$freeze(),O=P(v(k(R("CommonCommand"),"COMMANDS"),"map",[],function(ee){return null==ee&&(ee=$),k(ee,"PREFIX_PATTERN").$source()}),g.prefixes),g.command_pattern=L(["^S?(",O.$join("|"),")"],"i").$freeze())}),d(f,"$eval",function(g){try{return N("eval_return"),this.$new(g).$eval()}catch(re){if(re===e.t_eval_return)return re.$v;throw re}}),s.$include(u("Translate")),s.$include(k(u("Deprecated"),"Checker")),d(s,"$initialize",function(m){var t=this;return t.raw_input=m,t.sort_add_dice=!1,t.sort_barabara_dice=!1,t.d66_sort_type=k(u("D66SortType"),"NO_SORT"),t.enabled_d9=!1,t.round_type=k(u("RoundType"),"FLOOR"),t.sides_implicit_d=6,t.upper_dice_reroll_threshold=$,t.reroll_dice_reroll_threshold=$,t.default_cmp_op=$,t.default_target_number=$,t.enabled_upcase_input=!0,t.locale="ja_jp",t.randomizer=k(u("BCDice"),"Randomizer").$new(),t.debug=!1}),s.$attr_accessor("randomizer"),s.$attr_reader("d66_sort_type"),s.$attr_reader("round_type"),s.$attr_reader("sides_implicit_d"),s.$attr_reader("upper_dice_reroll_threshold"),s.$attr_reader("reroll_dice_reroll_threshold"),s.$attr_reader("default_cmp_op"),s.$attr_reader("default_target_number"),d(s,"$sort_add_dice?",F("sort_add_dice")),d(s,"$sort_barabara_dice?",F("sort_barabara_dice")),d(s,"$enabled_d9?",F("enabled_d9")),d(s,"$enable_debug",G("debug",!0)),d(s,"$eval",function(){var t,r,m=this,R=$;return t=k(u("BCDice"),"Preprocessor").$process(m.raw_input,m),R=B(r=m.$dice_command(t))?r:m.$eval_common_command(m.raw_input),B(R)?(R["$rands="](m.randomizer.$rand_results()),R["$detailed_rands="](m.randomizer.$detailed_rand_results()),R):$}),d(s,"$change_text",function(m){return m}),d(s,"$check_result",function(m,t,R,r){var g=this,a=$,O=$,re=$,ee=$,$e=$;return a=g.$check_result_legacy(m,t,R,r),B(a)?a:(O=v(t,"map",[],"sides".$to_proc()),ee=(re=v(t,"map",[],"value".$to_proc())).$sum(),a=Q([100],$e=O)?g.$result_1d100(m,ee,R,r):Q([20],$e)?g.$result_1d20(m,ee,R,r):Q([6,6],$e)?g.$result_2d6(m,ee,re,R,r):$,q(a,u("Result").$nothing())?$:B(a)?a:(a=Q([10],$e=O.$uniq())?g.$result_nd10(m,ee,re,R,r):Q([6],$e)?g.$result_nd6(m,ee,re,R,r):$,q(a,u("Result").$nothing())?$:B(a)?a:g.$result_ndx(m,R,r)))}),d(s,"$grich_text",Y($)),s.$private(),d(s,"$eval_common_command",function(m){try{N("eval_return");var R=N("return");return m=this.$change_text(m),v(k(u("CommonCommand"),"COMMANDS"),"each",[],function g(a){var re,O=null==g.$$s?this:g.$$s;if(null==O.randomizer&&(O.randomizer=$),null==a&&(a=$),re=a.$eval(m,O,O.randomizer),!B(re))return $;R.$throw(re)},{$$s:this,$$ret:R}),$}catch(g){if(g===e.t_eval_return||g===R)return g.$v;throw g}}),d(s,"$dice_command",function(m){var t=this,R=$,r=$,g=$,a=$;return B(t.enabled_upcase_input)&&(m=m.$upcase()),R=t.$class().$prefixes_pattern().$match(m),B(R)?(r=R["$[]"](1)["$nil?"]()["$!"](),B(r)&&(m=m["$[]"](A(1,-1,!1))),g=t.$eval_game_system_specific_command(m),B(g["$is_a?"](u("Result")))?(g["$secret="](B(a=g["$secret?"]())?a:r),g):B(g["$nil?"]())||B(g["$empty?"]())||q(g,"1")?$:v(u("Result").$new(),"tap",[],function(re){var ee;return null==re&&(re=$),re["$text="](g.$to_s()),v(re,"secret=",ee=[r]),ee[ee.length-1]})):$}),d(s,"$eval_game_system_specific_command",Y($)),d(s,"$result_ndx",function(m,t,R){return B(R["$is_a?"](u("String")))?$:B(m.$send(t,R))?u("Result").$success(this.$translate("success")):u("Result").$failure(this.$translate("failure"))}),d(s,"$result_1d100",Y($)),d(s,"$result_1d20",Y($)),d(s,"$result_nd10",Y($)),d(s,"$result_2d6",Y($)),d(s,"$result_nd6",Y($)),d(s,"$get_table_by_2d6",function(m){return this.$get_table_by_nD6(m,2)}),d(s,"$get_table_by_1d6",function(m){return this.$get_table_by_nD6(m,1)}),d(s,"$get_table_by_nD6",function(m,t){return this.$get_table_by_nDx(m,t,6)}),d(s,"$get_table_by_nDx",function(m,t,R){var g,a=$;return g=this.randomizer.$roll_sum(t,R),a=this.$get_table_value(m["$[]"](E(g,t))),B(a["$nil?"]())?["1",0]:[a,g]}),d(s,"$get_table_by_1d3",function(m){var r,g,t=this,a=$;return t.$debug("get_table_by_1d3"),r=t.randomizer.$roll_sum(1,6),t.$debug("num",r),g=i(E(r,1),2).$to_i(),t.$debug("index",g),a=m["$[]"](g),B(a["$nil?"]())?["1",0]:[a,r]}),d(s,"$get_table_by_d66_swap",function(m){var R;return R=this.randomizer.$roll_d66(k(u("D66SortType"),"ASC")),[this.$get_table_by_number(R,m),R]}),d(s,"$get_table_by_d66",function(m){var R,r,g,O,a=$;return R=this.randomizer.$roll_once(6),r=this.randomizer.$roll_once(6),g=P(I(E(R,1),6),E(r,1)),a=m["$[]"](g),O=""+R+r,B(a["$nil?"]())?["1",O]:[a,O]}),d(s,"$get_table_by_number",function(m,t,R){try{var r=N("return");return null==R&&(R="1"),v(t,"each",[],function a(O){var ee,re=null==a.$$s?this:a.$$s;if(null==O&&(O=$),ee=O["$[]"](0),!B(o(ee,m)))return $;r.$throw(re.$get_table_value(O["$[]"](1)))},{$$s:this,$$ret:r}),this.$get_table_value(R)}catch(a){if(a===r)return a.$v;throw a}},-3),d(s,"$get_table_value",function(m){return B(m["$is_a?"](u("Proc")))?m.$call():m}),d(s,"$roll_tables",function(m,t){var r=$;return r=t["$[]"](m),B(r)?r.$roll(this.randomizer).$to_s():$}),d(s,"$debug",function(m,t){var r,g=this,a=$,O=$;return r=l(arguments,1),B(g.debug)?(a=B(m["$is_a?"](u("String")))?m:m.$inspect(),B(r["$empty?"]())?g.$warn(a):(O=v(r,"map",[],function(ee){return null==ee&&(ee=$),B(ee["$is_a?"](u("String")))?'"'+ee+'"':ee.$inspect()}),g.$warn(a+": "+O.$join(", ")))):$},-2),k(k(n("I18n"),"Backend"),"Simple").$include(k(k(n("I18n"),"Backend"),"Fallbacks")),n("I18n").$load_path()["$<<"](n("Dir")["$[]"](n("File").$join("bcdice","../../i18n/**/*.yml"))),n("I18n")["$default_locale="]("ja_jp"),p=[["ja_jp"]],v(n("I18n").$fallbacks(),"defaults=",p),p[p.length-1]},Opal.modules["bcdice/game_system/sword_world/rating_lexer"]=function(e){var G,A,_,H,S,K,z,n,i,I,q,V=e.module,j=e.klass,l=e.const_set,P=e.hash2,B=e.truthy,d=e.def,v=[],N=e.nil;return e.top.$require("strscan"),G=v,A=q=[V(v[0],"BCDice")].concat(G),i=[V(q[0],"GameSystem")].concat(A),I=e.$r(i),_=i,H=n=[j(i[0],I("Base"),"SwordWorld")].concat(_),K=[S=j(n[0],null,"RatingLexer")].concat(H),z=e.$r(K),S.$$prototype.scanner=N,l(K[0],"SYMBOLS",P(["+","-","*","/","(",")","[","]","@","#","$","~"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","@":"AT","#":"SHARP",$:"DOLLAR","~":"TILDE"}).$freeze()),d(S,"$initialize",function(y){var s,c,b;return y=B(b=(s=(c=y)===N||null==c?N:c.$split(" ",2))===N||null==s?N:s.$first())?b:"",this.scanner=z("StringScanner").$new(y)}),d(S,"$next_token",function(){var y=this,s=N,c=N,b=N;return B(y.scanner["$eos?"]())?[!1,"$"]:B(s=y.scanner.$scan(/\d+/))?["NUMBER",s.$to_i()]:(c=y.scanner.$getch().$upcase(),[B(b=z("SYMBOLS")["$[]"](c))?b:c.$to_sym(),c])}),d(S,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/game_system/sword_world/rating_parsed"]=function(e){var Q,E,C,S,K,z,T,h,$,I,o,Y,V=e.module,j=e.klass,l=e.def,P=e.truthy,B=e.rb_le,d=e.rb_plus,L=e.rb_lt,v=e.neqeq,N=[],F=e.nil;return Q=N,E=Y=[V(N[0],"BCDice")].concat(Q),I=[V(Y[0],"GameSystem")].concat(E),o=e.$r(I),C=I,S=$=[j(I[0],o("Base"),"SwordWorld")].concat(C),z=[K=j($[0],null,"RatingParsed")].concat(S),T=e.$r(z),(h=K.$$prototype).modifier_after_half=h.modifier_after_one_and_a_half=h.semi_fixed_val=h.kept_modify=h.rate=h.greatest_fortune=h.modifier=F,K.$attr_accessor("rate"),K.$attr_accessor("critical"),K.$attr_accessor("kept_modify"),K.$attr_accessor("first_to"),K.$attr_accessor("first_modify"),K.$attr_accessor("first_modify_ssp"),K.$attr_accessor("rateup"),K.$attr_accessor("greatest_fortune"),K.$attr_accessor("semi_fixed_val"),K.$attr_accessor("tmp_fixed_val"),K.$attr_accessor("modifier"),K.$attr_accessor("modifier_after_half"),K.$attr_accessor("modifier_after_one_and_a_half"),l(K,"$initialize",function(s,c){var u=this;return u.rate=s,u.modifier=c,u.critical=13,u.kept_modify=0,u.first_to=0,u.first_modify=0,u.first_modify_ssp=0,u.greatest_fortune=!1,u.rateup=0,u.semi_fixed_val=0,u.tmp_fixed_val=0,u.modifier_after_half=F,u.modifier_after_one_and_a_half=F}),l(K,"$half",function(){return this.modifier_after_half["$nil?"]()["$!"]()}),l(K,"$one_and_a_half",function(){return this.modifier_after_one_and_a_half["$nil?"]()["$!"]()}),l(K,"$min_critical",function(){var s=this;return P(B(s.semi_fixed_val,1))?3:d(d(s.semi_fixed_val,s.kept_modify),2).$clamp(3,13)}),l(K,"$infinite_roll?",function(){return L(this.$critical(),this.$min_critical())}),l(K,"$to_s",function(){var s=this,c=F;return c="KeyNo."+s.rate,P(L(s.$critical(),13))&&(c=d(c,"c["+s.$critical()+"]")),v(s.$first_modify(),0)&&(c=d(c,"m["+T("Format").$modifier(s.$first_modify())+"]")),v(s.$first_modify_ssp(),0)&&(c=d(c,"m[~"+T("Format").$modifier(s.$first_modify_ssp())+"]")),v(s.$first_to(),0)&&(c=d(c,"m["+s.$first_to()+"]")),v(s.$rateup(),0)&&(c=d(c,"r["+s.$rateup()+"]")),P(s.greatest_fortune)&&(c=d(c,"gf")),v(s.$semi_fixed_val(),0)&&(c=d(c,"sf["+s.$semi_fixed_val()+"]")),v(s.$tmp_fixed_val(),0)&&(c=d(c,"tf["+s.$tmp_fixed_val()+"]")),v(s.$kept_modify(),0)&&(c=d(c,"a["+T("Format").$modifier(s.$kept_modify())+"]")),v(s.modifier,0)&&(c=d(c,T("Format").$modifier(s.modifier))),c})},Opal.modules["bcdice/game_system/sword_world/rating_options"]=function(e){var v,Q,I,n,p,Y,A,F,V=e.module,j=e.klass,l=e.truthy,P=e.def,B=[];return v=B,Q=F=[V(B[0],"BCDice")].concat(v),Y=[V(F[0],"GameSystem")].concat(Q),A=e.$r(Y),I=Y,p=[j(Y[0],A("Base"),"SwordWorld")].concat(I),(n=j(p[0],null,"RatingOptions")).$attr_accessor("critical"),n.$attr_accessor("kept_modify"),n.$attr_accessor("first_to"),n.$attr_accessor("first_modify"),n.$attr_accessor("first_modify_ssp"),n.$attr_accessor("rateup"),n.$attr_accessor("greatest_fortune"),n.$attr_accessor("semi_fixed_val"),n.$attr_accessor("tmp_fixed_val"),n.$attr_accessor("modifier"),n.$attr_accessor("modifier_after_half"),n.$attr_accessor("modifier_after_one_and_a_half"),P(n,"$settable_first_roll_adjust_option?",function(){var H,S,k=this;return l(H=l(S=k.$first_modify()["$nil?"]())?k.$first_to()["$nil?"]():S)?k.$first_modify_ssp()["$nil?"]():H}),P(n,"$settable_non_2d_roll_option?",function(){var H,S,k=this;return l(H=l(S=k.$greatest_fortune()["$nil?"]())?k.$semi_fixed_val()["$nil?"]():S)?k.$tmp_fixed_val()["$nil?"]():H})},Opal.modules["bcdice/game_system/sword_world/rating_parser"]=function(e){var p,$,T,b,g,a,O,re,ee,$e,ce,oe,ue,se,f,R,r,D,y,s,H,S,C,V=e.module,j=e.klass,l=e.ensure_kwargs,P=e.send2,B=e.find_super,d=e.def,L=e.send,v=e.truthy,N=e.not,F=e.thrower,G=e.hash,Q=e.const_set,q=e.to_ary,Y=e.eqeq,A=e.top,E=[],i=e.nil,I=e.$$$;return A.$require("racc/parser.rb"),A.$require("bcdice/arithmetic/node"),A.$require("bcdice/enum"),A.$require("bcdice/game_system/sword_world/rating_lexer"),A.$require("bcdice/game_system/sword_world/rating_parsed"),A.$require("bcdice/game_system/sword_world/rating_options"),p=E,$=C=[V(E[0],"BCDice")].concat(p),H=[V(C[0],"GameSystem")].concat($),S=e.$r(H),T=H,y=[j(H[0],S("Base"),"SwordWorld")].concat(T),s=e.$r(y),b=y,R=[f=j(y[0],I(s("Racc"),"Parser"),"RatingParser")].concat(b),r=e.$r(R),(D=f.$$prototype).lexer=D.round_type=D.version=i,d(f,"$initialize",function X(M){var w,Z,W=this;return X.$$p=null,null==(w=(M=l(M)).$$smap.version)&&(w="v1_0"),null==(Z=M.$$smap.round_type)&&(Z=I(r("RoundType"),"CEIL")),P(W,B(W,"initialize",X,!1,!0),"initialize",[],null),W.version=w,W.round_type=Z},-1),d(f,"$set_debug",function(){return this.yydebug=!0,this}),d(f,"$parse",function(M){try{return this.lexer=r("RatingLexer").$new(M),this.$do_parse()}catch(Z){if(!e.rescue(Z,[r("ParseError"),r("ZeroDivisionError")]))throw Z;try{return i}finally{e.pop_exception()}}}),f.$private(),d(f,"$parsed",function(M,w,Z){try{return F("eval_return"),L(r("RatingParsed").$new(M,w),"tap",[],function J(U){var ne,ie,fe,me,de,ve,he,ge,pe,ye=null==J.$$s?this:J.$$s,be=i;return null==ye.round_type&&(ye.round_type=i),null==U&&(U=i),U["$kept_modify="](v(be=(ne=Z.$kept_modify())===i||null==ne?i:ne.$eval(ye.round_type))?be:0),U["$first_to="](v(be=Z.$first_to())?be:0),U["$first_modify="](v(be=Z.$first_modify())?be:0),U["$first_modify_ssp="](v(be=Z.$first_modify_ssp())?be:0),U["$rateup="](v(be=(ie=Z.$rateup())===i||null==ie?i:ie.$eval(ye.round_type))?be:0),N(Z.$greatest_fortune()["$nil?"]())&&U["$greatest_fortune="](Z.$greatest_fortune()),U["$semi_fixed_val="](v(be=(fe=Z.$semi_fixed_val())===i||null==fe?i:fe.$clamp(1,6))?be:0),U["$tmp_fixed_val="](v(be=(me=Z.$tmp_fixed_val())===i||null==me?i:me.$clamp(1,6))?be:0),U["$modifier_after_half="]((de=Z.$modifier_after_half())===i||null==de?i:de.$eval(ye.round_type)),U["$modifier_after_one_and_a_half="]((ve=Z.$modifier_after_one_and_a_half())===i||null==ve?i:ve.$eval(ye.round_type)),he=[v((pe=Z.$critical(),ge=pe===i||null==pe?i:pe.$eval(ye.round_type),be=ge===i||null==ge?i:ge.$clamp(0,13)))?be:v(U.$half())||v(U.$one_and_a_half())?13:10],L(U,"critical=",he),he[he.length-1]},{$$s:this})}catch(J){if(J===e.t_eval_return)return J.$v;throw J}}),d(f,"$next_token",function(){return this.lexer.$next_token()}),g=e.large_array_unpack("36,66,67,27,28,5,68,3,4,37,38,18,16,17,19,6,20,21,23,24,39,64,65,5,13,9,14,22,15,18,16,17,19,10,20,21,23,24,64,65,64,65,13,11,14,22,15,18,16,17,19,5,20,21,23,24,34,41,34,43,13,44,14,22,15,30,31,30,31,33,34,33,34,64,65,64,65,34,45,30,31,30,31,33,34,33,30,31,53,34,33,34,58,30,31,59,34,33,30,31,30,31,33,34,33,30,31,60,34,33,34,62,30,31,63,34,33,30,31,30,31,33,34,33,30,31,69,34,33,34,,30,31,,34,33,30,31,30,31,33,,33,30,31,64,65,33,64,65"),a=e.large_array_unpack("15,56,56,12,12,0,56,0,0,15,15,7,7,7,7,1,7,7,7,7,15,47,47,3,7,4,7,7,7,25,25,25,25,5,25,25,25,25,49,49,51,51,25,6,25,25,25,50,50,50,50,9,50,50,50,50,13,17,14,19,50,20,50,50,50,13,13,14,14,13,16,14,18,52,52,57,57,22,21,16,16,18,18,16,23,18,22,22,29,24,22,27,37,23,23,38,28,23,24,24,27,27,24,30,27,28,28,39,31,28,33,44,30,30,45,41,30,31,31,33,33,31,64,33,41,41,60,65,41,66,,64,64,,67,64,65,65,66,66,65,,66,67,67,72,72,67,73,73"),O=e.large_array_unpack("2,15,,20,20,31,43,7,,48,,,-8,54,56,-2,68,52,70,51,53,70,75,82,87,25,,89,94,70,101,106,,108,,,,90,93,96,,113,,,109,112,,8,,25,43,27,60,,,,-10,62,,,124,,,,120,125,127,132,,,,,132,135"),re=e.large_array_unpack("-37,-37,-5,-37,-37,-37,-37,-1,-5,-37,-4,74,-6,-37,-37,-37,-13,-37,-37,-37,-37,-37,-37,-37,-37,-2,-5,-37,-37,-37,-37,-37,-34,-37,-36,-8,-9,-37,-37,-37,-14,-15,-17,-18,-37,-37,-21,-22,-31,-23,-3,-24,-25,-7,-32,-33,-37,-28,-10,-11,-37,-16,-19,-20,-37,-37,-37,-37,-35,-12,-29,-30,-26,-27"),ee=e.large_array_unpack("29,35,7,40,1,42,47,49,25,46,51,52,2,56,,8,57,54,55,,,26,,,,,50,,61,,,,,,,,,,,,,,,,,,,,,72,73,70,71"),$e=e.large_array_unpack("5,5,3,5,1,5,6,6,3,5,6,6,2,7,,2,6,5,5,,,2,,,,,3,,5,,,,,,,,,,,,,,,,,,,,,6,6,5,5"),ce=[i,4,12,0,i,-13,-17,-20,i],oe=[i,i,i,i,12,48,i,i,32],ue=e.large_array_unpack("0,0,racc_error,2,24,_reduce_1,3,24,_reduce_2,4,24,_reduce_3,2,25,_reduce_4,0,26,_reduce_5,2,26,_reduce_6,4,26,_reduce_7,3,26,_reduce_8,3,26,_reduce_9,4,26,_reduce_10,4,26,_reduce_11,5,26,_reduce_12,2,26,_reduce_13,3,26,_reduce_14,3,26,_reduce_15,4,26,_reduce_16,3,26,_reduce_17,3,26,_reduce_18,4,26,_reduce_19,4,26,_reduce_20,3,26,_reduce_21,2,27,_reduce_22,2,27,_reduce_23,3,27,_reduce_24,3,27,_reduce_25,3,30,_reduce_26,3,30,_reduce_27,1,30,_reduce_none,3,29,_reduce_29,3,29,_reduce_30,1,29,_reduce_none,2,28,_reduce_32,2,28,_reduce_33,1,28,_reduce_none,3,31,_reduce_35,1,31,_reduce_36"),se=G(!1,0,"error",1,"NUMBER",2,"K",3,"R",4,"H",5,"O",6,"G",7,"F",8,"S",9,"T",10,"PLUS",11,"MINUS",12,"ASTERISK",13,"SLASH",14,"PARENL",15,"PARENR",16,"BRACKETL",17,"BRACKETR",18,"AT",19,"SHARP",20,"DOLLAR",21,"TILDE",22),Q(R[0],"Racc_arg",[g,a,re,O,ee,$e,oe,ce,23,ue,se,74,37,!0]),v(r("Ractor","skip_raise")?"constant":i)&&r("Ractor").$make_shareable(r("Racc_arg")),Q(R[0],"Racc_token_to_s_table",["$end","error","NUMBER","K","R","H","O","G","F","S","T","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","AT","SHARP","DOLLAR","TILDE","$start","expr","rate","option","modifier","unary","mul","add","term"]),v(r("Ractor","skip_raise")?"constant":i)&&r("Ractor").$make_shareable(r("Racc_token_to_s_table")),Q(R[0],"Racc_debug_parser",!1),d(f,"$_reduce_1",function(M,w,Z){try{F("eval_return");var W,ne,me,ie=i,fe=i;return ne=null==(W=q(M))[0]?i:W[0],fe=v(me=(ie=null==W[1]?i:W[1]).$modifier())?me:I(I(r("Arithmetic"),"Node"),"Number").$new(0),this.$parsed(ne,fe.$eval(this.round_type),ie)}catch(de){if(de===e.t_eval_return)return de.$v;throw de}}),d(f,"$_reduce_2",function(M,w,Z){try{F("eval_return");var W,ie,me,U=this,fe=i,de=i;return ie=null==(W=q(M))[1]?i:W[1],v((fe=null==W[2]?i:W[2]).$modifier_after_one_and_a_half())&&U.$raise(r("ParseError")),v(fe.$modifier_after_half())||fe["$modifier_after_half="](I(I(r("Arithmetic"),"Node"),"Number").$new(0)),de=v(me=fe.$modifier())?me:I(I(r("Arithmetic"),"Node"),"Number").$new(0),U.$parsed(ie,de.$eval(U.round_type),fe)}catch(ve){if(ve===e.t_eval_return)return ve.$v;throw ve}}),d(f,"$_reduce_3",function(M,w,Z){try{F("eval_return");var W,ie,me,U=this,fe=i,de=i;return ie=null==(W=q(M))[2]?i:W[2],v((fe=null==W[3]?i:W[3]).$modifier_after_half())&&U.$raise(r("ParseError")),v(fe.$modifier_after_one_and_a_half())||fe["$modifier_after_one_and_a_half="](I(I(r("Arithmetic"),"Node"),"Number").$new(0)),de=v(me=fe.$modifier())?me:I(I(r("Arithmetic"),"Node"),"Number").$new(0),U.$parsed(ie,de.$eval(U.round_type),fe)}catch(ve){if(ve===e.t_eval_return)return ve.$v;throw ve}}),d(f,"$_reduce_4",function(M,w,Z){return M["$[]"](1).$to_i()}),d(f,"$_reduce_5",function(M,w,Z){return r("RatingOptions").$new()}),d(f,"$_reduce_6",function(M,w,Z){var x,ne,U=i;return ne=null==(x=q(M))[1]?i:x[1],v((U=null==x[0]?i:x[0]).$modifier()["$nil?"]())||this.$raise(r("ParseError")),U["$modifier="](ne),U}),d(f,"$_reduce_7",function(M,w,Z){var x,ie,U=i;return ie=null==(x=q(M))[2]?i:x[2],v((U=null==x[0]?i:x[0]).$critical()["$nil?"]())||this.$raise(r("ParseError")),U["$critical="](ie),U}),d(f,"$_reduce_8",function(M,w,Z){var x,ie,U=i;return ie=null==(x=q(M))[2]?i:x[2],v((U=null==x[0]?i:x[0]).$critical()["$nil?"]())||this.$raise(r("ParseError")),U["$critical="](ie),U}),d(f,"$_reduce_9",function(M,w,Z){var x,U=i,ie=i;return ie=null==(x=q(M))[2]?i:x[2],v((U=null==x[0]?i:x[0])["$settable_first_roll_adjust_option?"]())||this.$raise(r("ParseError")),U["$first_to="](ie.$to_i()),U}),d(f,"$_reduce_10",function(M,w,Z){var x,U=i,ie=i;return ie=null==(x=q(M))[3]?i:x[3],v((U=null==x[0]?i:x[0])["$settable_first_roll_adjust_option?"]())||this.$raise(r("ParseError")),U["$first_modify="](ie.$to_i()),U}),d(f,"$_reduce_11",function(M,w,Z){var x,U=i,ie=i;return ie=null==(x=q(M))[3]?i:x[3],v((U=null==x[0]?i:x[0])["$settable_first_roll_adjust_option?"]())||this.$raise(r("ParseError")),U["$first_modify="](ie.$to_i()["$-@"]()),U}),d(f,"$_reduce_12",function(M,w,Z){var x,U=i,ie=i;return U=null==(x=q(M))[0]?i:x[0],ie=null==x[4]?i:x[4],Y(this.version,"v2_5")&&v(U["$settable_first_roll_adjust_option?"]())||this.$raise(r("ParseError")),U["$first_modify_ssp="](ie.$to_i()),U}),d(f,"$_reduce_13",function(M,w,Z){var x,U=i;return x=q(M),v((U=null==x[0]?i:x[0]).$modifier_after_half()["$nil?"]())||this.$raise(r("ParseError")),U["$modifier_after_half="](I(I(r("Arithmetic"),"Node"),"Number").$new(0)),U}),d(f,"$_reduce_14",function(M,w,Z){var x,ie,U=i;return ie=null==(x=q(M))[2]?i:x[2],v((U=null==x[0]?i:x[0]).$modifier_after_half()["$nil?"]())||this.$raise(r("ParseError")),U["$modifier_after_half="](ie),U}),d(f,"$_reduce_15",function(M,w,Z){var x,U=i;return x=q(M),v((U=null==x[0]?i:x[0]).$modifier_after_one_and_a_half())&&this.$raise(r("ParseError")),U["$modifier_after_one_and_a_half="](I(I(r("Arithmetic"),"Node"),"Number").$new(0)),U}),d(f,"$_reduce_16",function(M,w,Z){var x,ie,U=i;return ie=null==(x=q(M))[3]?i:x[3],v((U=null==x[0]?i:x[0]).$modifier_after_one_and_a_half())&&this.$raise(r("ParseError")),U["$modifier_after_one_and_a_half="](ie),U}),d(f,"$_reduce_17",function(M,w,Z){var x,ie,U=i;return U=null==(x=q(M))[0]?i:x[0],ie=null==x[2]?i:x[2],v(["v2_5","v2_0"]["$include?"](this.version))&&v(U.$rateup()["$nil?"]())||this.$raise(r("ParseError")),U["$rateup="](ie),U}),d(f,"$_reduce_18",function(M,w,Z){var x,U=i;return U=null==(x=q(M))[0]?i:x[0],v(["v2_5","v2_0"]["$include?"](this.version))&&v(U["$settable_non_2d_roll_option?"]())||this.$raise(r("ParseError")),U["$greatest_fortune="](!0),U}),d(f,"$_reduce_19",function(M,w,Z){var x,U=i,ie=i;return U=null==(x=q(M))[0]?i:x[0],ie=null==x[3]?i:x[3],v(["v2_5","v2_0"]["$include?"](this.version))&&v(U["$settable_non_2d_roll_option?"]())||this.$raise(r("ParseError")),U["$semi_fixed_val="](ie.$to_i()),U}),d(f,"$_reduce_20",function(M,w,Z){var x,U=i,ie=i;return U=null==(x=q(M))[0]?i:x[0],ie=null==x[3]?i:x[3],v(["v2_5","v2_0"]["$include?"](this.version))&&v(U["$settable_non_2d_roll_option?"]())||this.$raise(r("ParseError")),U["$tmp_fixed_val="](ie.$to_i()),U}),d(f,"$_reduce_21",function(M,w,Z){var x,ie,U=i;return U=null==(x=q(M))[0]?i:x[0],ie=null==x[2]?i:x[2],Y(this.version,"v2_5")&&v(U.$kept_modify()["$nil?"]())||this.$raise(r("ParseError")),U["$kept_modify="](ie),U}),d(f,"$_reduce_22",function(M,w,Z){return M["$[]"](1)}),d(f,"$_reduce_23",function(M,w,Z){return I(I(r("Arithmetic"),"Node"),"Negative").$new(M["$[]"](1))}),d(f,"$_reduce_24",function(M,w,Z){return I(I(r("Arithmetic"),"Node"),"BinaryOp").$new(M["$[]"](0),"+",M["$[]"](2))}),d(f,"$_reduce_25",function(M,w,Z){return I(I(r("Arithmetic"),"Node"),"BinaryOp").$new(M["$[]"](0),"-",M["$[]"](2))}),d(f,"$_reduce_26",function(M,w,Z){return I(I(r("Arithmetic"),"Node"),"BinaryOp").$new(M["$[]"](0),"+",M["$[]"](2))}),d(f,"$_reduce_27",function(M,w,Z){return I(I(r("Arithmetic"),"Node"),"BinaryOp").$new(M["$[]"](0),"-",M["$[]"](2))}),d(f,"$_reduce_29",function(M,w,Z){return I(I(r("Arithmetic"),"Node"),"BinaryOp").$new(M["$[]"](0),"*",M["$[]"](2))}),d(f,"$_reduce_30",function(M,w,Z){return I(I(r("Arithmetic"),"Node"),"DivideWithGameSystemDefault").$new(M["$[]"](0),M["$[]"](2))}),d(f,"$_reduce_32",function(M,w,Z){return M["$[]"](1)}),d(f,"$_reduce_33",function(M,w,Z){return I(I(r("Arithmetic"),"Node"),"Negative").$new(M["$[]"](1))}),d(f,"$_reduce_35",function(M,w,Z){return M["$[]"](1)}),d(f,"$_reduce_36",function(M,w,Z){return I(I(r("Arithmetic"),"Node"),"Number").$new(M["$[]"](0))}),d(f,"$_reduce_none",function(M,w,Z){return M["$[]"](0)})},Opal.modules["bcdice/game_system/SwordWorld"]=function(e){var H,T,b,f,m,t,R,y,s,K,V=e.module,j=e.klass,l=e.const_set,P=e.send2,B=e.find_super,d=e.def,L=e.truthy,v=e.rb_ge,N=e.rb_le,F=e.eqeq,G=e.neqeq,Q=e.rb_minus,q=e.rb_gt,Y=e.hash2,A=e.send,E=e.to_ary,i=e.rb_plus,I=e.rb_lt,o=e.rb_times,p=e.thrower,_=e.rb_divide,C=e.top,n=[],$=e.nil;return C.$require("bcdice/base"),C.$require("bcdice/game_system/sword_world/rating_parser"),H=n,T=K=[V(n[0],"BCDice")].concat(H),y=[V(K[0],"GameSystem")].concat(T),s=e.$r(y),b=y,m=[f=j(y[0],s("Base"),"SwordWorld")].concat(b),t=e.$r(m),(R=f.$$prototype).rating_table=R.randomizer=$,l(m[0],"ID","SwordWorld"),l(m[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c9RPG"),l(m[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u3068"),l(m[0],"HELP_MESSAGE","\u30fbSW\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx[c]+m$f) (x:\u30ad\u30fc, c:\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024, m:\u30dc\u30fc\u30ca\u30b9, f:\u51fa\u76ee\u4fee\u6b63)\n"),f.$register_prefix("H?K"),d(f,"$initialize",function r(g){var O=this;return r.$$p=null,P(O,B(O,"initialize",r,!1,!0),"initialize",[g],null),O.rating_table=0}),d(f,"$result_2d6",function(g,a,O,re,ee){return L(v(a,12))?t("Result").$critical(this.$translate("SwordWorld.critical")):L(N(a,2))?t("Result").$fumble(this.$translate("SwordWorld.fumble")):G(re,">=")||F(ee,"?")?$:L(v(g,ee))?t("Result").$success(this.$translate("success")):t("Result").$failure(this.$translate("failure"))}),d(f,"$eval_game_system_specific_command",function(g){return this.$rating(g)}),f.$private(),d(f,"$rating_parser",function(){return t("RatingParser").$new()}),d(f,"$rating",function(g){var a,O,re=this,ee=$,$e=$,ce=$,oe=$,ue=$,_e=$,le=$,se=$,ae=$,te=$,D=$,X=$,M=$,w=$,Z=$,W=$,J=$;return re.$debug("rating string",g),ee=re.$rating_parser().$parse(g),L(ee)?($e=re.$getSW2_0_RatingTable(),ce=Q($e.$length(),1),re.$debug("keyMax",ce),L(q(ee.$rate(),ce))?t("Result").$new(re.$translate("SwordWorld.keynumber_exceeds",Y(["keyMax"],{keyMax:ce}))):L(ee["$infinite_roll?"]())?t("Result").$new(re.$translate("SwordWorld.infinite_critical",Y(["min_critical"],{min_critical:ee.$min_critical()}))):(oe=re.$getNewRates($e),ue=ee+" \uff1e ",_e=[],le=[],se=[],ae=0,te=0,D=0,X=0,M=ee.$first_to(),w=ee.$first_modify(),Z=ee.$first_modify_ssp(),function(){try{var U=p("break");return A(re,"loop",[],function ne(){var ie,fe,he,ge,me=null==ne.$$s?this:ne.$$s,de=$,ve=$;if(fe=me.$rollDice(ee,X),ve=null==(ie=E(fe))[1]?$:ie[1],ae=de=null==ie[0]?$:ie[0],G(M,0)?(ae=de=M,M=0):G(w,0)?(ae=i(ae,w),w=0):G(Z,0)&&(L(N(de,10))&&(ae=i(ae,Z)),Z=0),L(N(de,2))&&(_e["$<<"](de.$to_s()),le["$<<"](ve.$to_s()),se["$<<"]("**"),X=i(X,1),U.$throw()),G(ee.$kept_modify(),0)&&G(ae,2)&&(ae=i(ae,ee.$kept_modify())),L(I(ae,2))&&(ae=2),L(q(ae,12))&&(ae=12),he=i(ee.$rate(),o(X,ee.$rateup())).$clamp(0,ce),me.$debug("currentKey",he),ge=oe["$[]"](ae)["$[]"](he),me.$debug("rateValue",ge),D=i(D,ge),te=i(te,ae),_e["$<<"](ae.$to_s()),le["$<<"](ve.$to_s()),se["$<<"](L(q(ae,2))?ge:"**"),X=i(X,1),L(v(ae,ee.$critical())))return $;U.$throw()},{$$s:re})}catch(ne){if(ne===U)return ne.$v;throw ne}}(),O=re.$getResultText(D,ee,le,_e,se,te,X),a=E(O),W=null==a[1]?$:a[1],J=null==a[2]?$:a[2],ue=i(ue,null==a[0]?$:a[0]),A(t("Result").$new(),"tap",[],function(ne){var ie;return null==ne&&(ne=$),ne["$text="](ue),ne["$critical="](W),A(ne,"fumble=",ie=[J]),ie[ie.length-1]}))):(re.$debug("not matched"),"1")}),d(f,"$getSW2_0_RatingTable",function(){return["*,0,0,0,1,2,2,3,3,4,4","*,0,0,0,1,2,3,3,3,4,4","*,0,0,0,1,2,3,4,4,4,4","*,0,0,1,1,2,3,4,4,4,5","*,0,0,1,2,2,3,4,4,5,5","*,0,1,1,2,2,3,4,5,5,5","*,0,1,1,2,3,3,4,5,5,5","*,0,1,1,2,3,4,4,5,5,6","*,0,1,2,2,3,4,4,5,6,6","*,0,1,2,3,3,4,4,5,6,7","*,1,1,2,3,3,4,5,5,6,7","*,1,2,2,3,3,4,5,6,6,7","*,1,2,2,3,4,4,5,6,6,7","*,1,2,3,3,4,4,5,6,7,7","*,1,2,3,4,4,4,5,6,7,8","*,1,2,3,4,4,5,5,6,7,8","*,1,2,3,4,4,5,6,7,7,8","*,1,2,3,4,5,5,6,7,7,8","*,1,2,3,4,5,6,6,7,7,8","*,1,2,3,4,5,6,7,7,8,9","*,1,2,3,4,5,6,7,8,9,10","*,1,2,3,4,6,6,7,8,9,10","*,1,2,3,5,6,6,7,8,9,10","*,2,2,3,5,6,7,7,8,9,10","*,2,3,4,5,6,7,7,8,9,10","*,2,3,4,5,6,7,8,8,9,10","*,2,3,4,5,6,8,8,9,9,10","*,2,3,4,6,6,8,8,9,9,10","*,2,3,4,6,6,8,9,9,10,10","*,2,3,4,6,7,8,9,9,10,10","*,2,4,4,6,7,8,9,10,10,10","*,2,4,5,6,7,8,9,10,10,11","*,3,4,5,6,7,8,10,10,10,11","*,3,4,5,6,8,8,10,10,10,11","*,3,4,5,6,8,9,10,10,11,11","*,3,4,5,7,8,9,10,10,11,12","*,3,5,5,7,8,9,10,11,11,12","*,3,5,6,7,8,9,10,11,12,12","*,3,5,6,7,8,10,10,11,12,13","*,4,5,6,7,8,10,11,11,12,13","*,4,5,6,7,9,10,11,11,12,13","*,4,6,6,7,9,10,11,12,12,13","*,4,6,7,7,9,10,11,12,13,13","*,4,6,7,8,9,10,11,12,13,14","*,4,6,7,8,10,10,11,12,13,14","*,4,6,7,9,10,10,11,12,13,14","*,4,6,7,9,10,10,12,13,13,14","*,4,6,7,9,10,11,12,13,13,15","*,4,6,7,9,10,12,12,13,13,15","*,4,6,7,10,10,12,12,13,14,15","*,4,6,8,10,10,12,12,13,15,15","*,5,7,8,10,10,12,12,13,15,15","*,5,7,8,10,11,12,12,13,15,15","*,5,7,9,10,11,12,12,14,15,15","*,5,7,9,10,11,12,13,14,15,16","*,5,7,10,10,11,12,13,14,16,16","*,5,8,10,10,11,12,13,15,16,16","*,5,8,10,11,11,12,13,15,16,17","*,5,8,10,11,12,12,13,15,16,17","*,5,9,10,11,12,12,14,15,16,17","*,5,9,10,11,12,13,14,15,16,18","*,5,9,10,11,12,13,14,16,17,18","*,5,9,10,11,13,13,14,16,17,18","*,5,9,10,11,13,13,15,17,17,18","*,5,9,10,11,13,14,15,17,17,18","*,5,9,10,12,13,14,15,17,18,18","*,5,9,10,12,13,15,15,17,18,19","*,5,9,10,12,13,15,16,17,19,19","*,5,9,10,12,14,15,16,17,19,19","*,5,9,10,12,14,16,16,17,19,19","*,5,9,10,12,14,16,17,18,19,19","*,5,9,10,13,14,16,17,18,19,20","*,5,9,10,13,15,16,17,18,19,20","*,5,9,10,13,15,16,17,19,20,21","*,6,9,10,13,15,16,18,19,20,21","*,6,9,10,13,16,16,18,19,20,21","*,6,9,10,13,16,17,18,19,20,21","*,6,9,10,13,16,17,18,20,21,22","*,6,9,10,13,16,17,19,20,22,23","*,6,9,10,13,16,18,19,20,22,23","*,6,9,10,13,16,18,20,21,22,23","*,6,9,10,13,17,18,20,21,22,23","*,6,9,10,14,17,18,20,21,22,24","*,6,9,11,14,17,18,20,21,23,24","*,6,9,11,14,17,19,20,21,23,24","*,6,9,11,14,17,19,21,22,23,24","*,7,10,11,14,17,19,21,22,23,25","*,7,10,12,14,17,19,21,22,24,25","*,7,10,12,14,18,19,21,22,24,25","*,7,10,12,15,18,19,21,22,24,26","*,7,10,12,15,18,19,21,23,25,26","*,7,11,13,15,18,19,21,23,25,26","*,7,11,13,15,18,20,21,23,25,27","*,8,11,13,15,18,20,22,23,25,27","*,8,11,13,16,18,20,22,23,25,28","*,8,11,14,16,18,20,22,23,26,28","*,8,11,14,16,19,20,22,23,26,28","*,8,12,14,16,19,20,22,24,26,28","*,8,12,15,16,19,20,22,24,27,28","*,8,12,15,17,19,20,22,24,27,29","*,8,12,15,18,19,20,22,24,27,30"]}),d(f,"$getNewRates",function(g){var a,O,ee=$,$e=$,ce=$,oe=$,ue=$,_e=$,le=$,se=$,ae=$,te=$,D=$;return ee=[],$e=[],ce=[],oe=[],ue=[],_e=[],le=[],se=[],ae=[],te=[],D=[],A(g,"each",[],function(w){var Z=$;return null==w&&(w=$),Z=w.$split(/,/),D.$push(0),ee.$push(Z["$[]"](1).$to_i()),$e.$push(Z["$[]"](2).$to_i()),ce.$push(Z["$[]"](3).$to_i()),oe.$push(Z["$[]"](4).$to_i()),ue.$push(Z["$[]"](5).$to_i()),_e.$push(Z["$[]"](6).$to_i()),le.$push(Z["$[]"](7).$to_i()),se.$push(Z["$[]"](8).$to_i()),ae.$push(Z["$[]"](9).$to_i()),te.$push(Z["$[]"](10).$to_i())}),F(this.rating_table,1)&&te["$[]="](31,(a=[32,(O=[33,10],A(te,"[]=",O),O[O.length-1])],A(te,"[]=",a),a[a.length-1])),[D,D,D,ee,$e,ce,oe,ue,_e,le,se,ae,te]}),d(f,"$rollDice",function(g,a){var re=$;return[(re=this.randomizer.$roll_barabara(2,6)).$sum(),re.$join(",")]}),d(f,"$getResultText",function(g,a,O,re,ee,$e,ce){var ue=$,_e=$,le=$,se=$,ae=$;return(ue=[]).$push("2D:["+O.$join(" ")+"]="+re.$join(",")),L(N($e,2))?(ue.$push(ee.$join(",")),ue.$push(this.$translate("SwordWorld.fumble")),[ue.$join(" \uff1e "),!1,!0]):(L(q(ee.$size(),1))||G(a.$modifier(),0)?(_e=i(ee.$join(","),t("Format").$modifier(a.$modifier())),L(a.$half())?(_e="("+_e+")/2",G(a.$modifier_after_half(),0)&&(_e=i(_e,t("Format").$modifier(a.$modifier_after_half())))):L(a.$one_and_a_half())&&(_e="("+_e+")*1.5",G(a.$modifier_after_one_and_a_half(),0)&&(_e=i(_e,t("Format").$modifier(a.$modifier_after_one_and_a_half())))),ue.$push(_e)):L(a.$half())?(_e=ee.$first()+"/2",G(a.$modifier_after_half(),0)&&(_e=i(_e,t("Format").$modifier(a.$modifier_after_half()))),ue.$push(_e)):L(a.$one_and_a_half())&&(_e=ee.$first()+"*1.5",G(a.$modifier_after_one_and_a_half(),0)&&(_e=i(_e,t("Format").$modifier(a.$modifier_after_one_and_a_half()))),ue.$push(_e)),L(q(ce,1))&&(le=this.$translate("SwordWorld.round_text",Y(["reroll_count"],{reroll_count:Q(ce,1)})),ue.$push(le)),se=i(g,a.$modifier()),L(a.$half())?(se=_(se,2).$ceil(),G(a.$modifier_after_half(),0)&&(se=i(se,a.$modifier_after_half()))):L(a.$one_and_a_half())&&(se=o(se,1.5).$ceil(),G(a.$modifier_after_one_and_a_half(),0)&&(se=i(se,a.$modifier_after_one_and_a_half()))),ae=se.$to_s(),ue.$push(ae),[ue.$join(" \uff1e "),q(ce,1),!1])})},Opal.modules["bcdice/game_system/sword_world/transcendent_test"]=function(e){var Y,I,$,z,T,h,y,s,H,p,_,E,V=e.module,j=e.klass,l=e.def,P=e.truthy,B=e.rb_lt,d=e.hash2,L=e.rb_ge,v=e.rb_plus,N=e.send,F=e.top,G=[],Q=e.nil;return F.$require("bcdice/result"),F.$require("bcdice/translate"),Y=G,I=E=[V(G[0],"BCDice")].concat(Y),p=[V(E[0],"GameSystem")].concat(I),_=e.$r(p),$=p,z=H=[j(p[0],_("SwordWorld"),"SwordWorld2_0")].concat($),h=[T=j(H[0],null,"TranscendentTest")].concat(z),y=e.$r(h),(s=T.$$prototype).modifier=s.critical_value=s.expression=s.modifier_str=s.target=s.cmp_op=Q,T.$include(y("Translate")),l(T,"$initialize",function(u,b,f,m,t){var R=this;return R.critical_value=u,R.modifier=b,R.cmp_op=f,R.target=m,R.locale=t,R.modifier_str=y("Format").$modifier(R.modifier),R.expression=R.$node_expression()}),l(T,"$execute",function(u){var t,R,r,b=this,f=Q,m=Q,g=Q,a=Q,O=Q,re=Q;if(P(B(b.critical_value,3)))return b.$translate("SwordWorld2_0.transcendent_critical_too_small",d(["expression"],{expression:b.expression}));if(m=[f=u.$roll_barabara(2,6)],t=f["$=="]([1,1]),R=f["$=="]([6,6]),!P(t))for(;P(L(b.$sum_of_dice(m.$last()),b.critical_value));)m.$push(u.$roll_barabara(2,6));return r=b.$sum_of_dice(m),g=v(r,b.modifier),a=b.$result_status(g,m.$length(),t,R),O=d(["success","failure","super_success","critical","fumble"],{success:b.$translate("success"),failure:b.$translate("failure"),super_success:b.$translate("SwordWorld2_0.super_success"),critical:b.$translate("SwordWorld.critical"),fumble:b.$translate("SwordWorld.fumble")}).$freeze()["$[]"](a),re=["("+b.expression+")",""+b.$dice_str(m,r)+b.modifier_str,g,O].$compact(),N(y("Result").$new(),"tap",[],function($e){var ce;return null==$e&&($e=Q),$e["$text="](re.$join(" \uff1e ")),$e["$fumble="](a["$=="]("fumble")),$e["$critical="](a["$=="]("critical")),$e["$success="](["success","super_success","critical"]["$include?"](a)),ce=[["failure","fumble"]["$include?"](a)],N($e,"failure=",ce),ce[ce.length-1]})}),T.$private(),l(T,"$node_expression",function(){var b,u=this;return b="2D6@"+u.critical_value+u.modifier_str,P(u.target)?""+b+u.cmp_op+u.target:b}),l(T,"$sum_of_dice",function(u){return u.$flatten().$sum()}),l(T,"$dice_str",function(u,b){return""+b+N(u,"map",[],function(t){return null==t&&(t=Q),"["+t.$join(",")+"]"}).$join()}),l(T,"$result_status",function(u,b,f,m){var t=this;return P(t.target)?P(f)?"fumble":P(m)?"critical":P(u.$send(t.cmp_op,t.target))?P(L(b,2))&&P(L(u,41))?"super_success":"success":"failure":"no_target"})},Opal.modules["bcdice/game_system/SwordWorld2_0"]=function(e){var _,k,h,y,s,c,u,S,K,n,V=e.module,j=e.klass,l=e.const_set,P=e.send2,B=e.find_super,d=e.def,L=e.eqeqeq,v=e.truthy,N=e.hash2,F=e.rb_gt,G=e.rb_plus,Q=e.eqeq,q=e.rb_times,Y=e.send,A=e.neqeq,E=e.top,i=[],I=e.nil,o=e.$$$;return E.$require("bcdice/arithmetic_evaluator"),E.$require("bcdice/game_system/SwordWorld"),E.$require("bcdice/game_system/sword_world/transcendent_test"),_=i,k=n=[V(i[0],"BCDice")].concat(_),S=[V(n[0],"GameSystem")].concat(k),K=e.$r(S),h=S,s=[y=j(S[0],K("SwordWorld"),"SwordWorld2_0")].concat(h),c=e.$r(s),(u=y.$$prototype).locale=u.randomizer=I,l(s[0],"ID","SwordWorld2.0"),l(s[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.0"),l(s[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u30682.0"),l(s[0],"HELP_MESSAGE",'\u81ea\u52d5\u7684\u6210\u529f\u3001\u6210\u529f\u3001\u5931\u6557\u3001\u81ea\u52d5\u7684\u5931\u6557\u306e\u81ea\u52d5\u5224\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx)\n\u3000"K\u30ad\u30fc\u30ca\u30f3\u30d0\u30fc+\u30dc\u30fc\u30ca\u30b9"\u306e\u5f62\u3067\u8a18\u5165\u3057\u307e\u3059\u3002\n\u3000\u30dc\u30fc\u30ca\u30b9\u306e\u90e8\u5206\u306b\u300cK20+K30\u300d\u306e\u3088\u3046\u306b\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u53d6\u308b\u3053\u3068\u306f\u51fa\u6765\u307e\u305b\u3093\u3002\n\u3000\u307e\u305f\u3001\u30dc\u30fc\u30ca\u30b9\u306f\u8907\u6570\u53d6\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3082\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u3068\u540c\u69d8\u306b\u3001\u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306b\u96a0\u308c\u3066\u30ed\u30fc\u30eb\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20\u3000\u3000\u3000K10+5\u3000\u3000\u3000k30\u3000\u3000\u3000k10+10\u3000\u3000\u3000Sk10-1\u3000\u3000\u3000k10+5+2\n\n\u30fb\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306e\u8a2d\u5b9a\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306f"[\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024]"\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u3000\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u306f\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502410\u3068\u3057\u307e\u3059\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u51e6\u7406\u304c\u5fc5\u8981\u306a\u3044\u3068\u304d\u306f13\u306a\u3069\u3068\u3057\u3066\u304f\u3060\u3055\u3044\u3002(\u9632\u5fa1\u6642\u306a\u3069\u306e\u5bfe\u5fdc)\n\u3000\u307e\u305f\u30bf\u30a4\u30d7\u306e\u8efd\u6e1b\u5316\u306e\u305f\u3081\u306b\u672b\u5c3e\u306b\u300c@\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u300d\u3067\u3082\u51e6\u7406\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\u3000\u4f8b\uff09K20[10]\u3000\u3000\u3000K10+5[9]\u3000\u3000\u3000k30[10]\u3000\u3000\u3000k10[9]+10\u3000\u3000\u3000k10-5@9\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u534a\u6e1b (HKx, KxH+N)\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u5148\u982d\u307e\u305f\u306f\u672b\u5c3e\u306b"H"\u3092\u3064\u3051\u308b\u3068\u3001\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3092\u632f\u3063\u3066\u6700\u7d42\u7d50\u679c\u3092\u534a\u6e1b\u3055\u305b\u307e\u3059\u3002\n\u3000\u672b\u5c3e\u306b\u3064\u3051\u305f\u5834\u5408\u3001\u76f4\u5f8c\u306b\u4fee\u6b63\u3092\u3092\u3064\u3051\u308b\u3053\u3068\u3067\u3001\u534a\u6e1b\u5f8c\u306e\u52a0\u6e1b\u7b97\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3000\u3053\u306e\u969b\u3001\u8907\u6570\u306e\u9805\u306b\u3088\u308b\u4fee\u6b63\u306b\u306f\u30ab\u30c3\u30b3\u3067\u56f2\u3046\u3053\u3068\u304c\u5fc5\u8981\u3067\u3059\uff08\u30ab\u30c3\u30b3\u304c\u306a\u3044\u3068\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3059\uff09\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3092\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u306a\u3057\u3068\u6271\u308f\u308c\u307e\u3059\u3002\n\u3000\u4f8b\uff09HK20\u3000\u3000K20h\u3000\u3000HK10-5@9\u3000\u3000K10-5@9H\u3000\u3000K20gfH\u3000\u3000K20+8H+2\u3000\u3000K20+8H(1+1)\n\n\u30fb\u30c0\u30a4\u30b9\u76ee\u306e\u4fee\u6b63\uff08\u904b\u547d\u5909\u8ee2\u3084\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30ec\u30a4\u7528\uff09\n\u3000\u672b\u5c3e\u306b\u300c$\u4fee\u6b63\u5024\u300d\u3067\u30c0\u30a4\u30b9\u76ee\u306b\u4fee\u6b63\u304c\u304b\u304b\u308a\u307e\u3059\u3002\n\u3000$\uff0b\uff11\u3068\u4fee\u6b63\u8868\u8a18\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u306b\uff0b\u4fee\u6b63\u3001\uff04\uff19\u306e\u3088\u3046\u306b\u56fa\u5b9a\u5024\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u3092\u305d\u306e\u51fa\u76ee\u306b\u5dee\u3057\u66ff\u3048\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3057\u305f\u5834\u5408\u3067\u3082\u56fa\u5b9a\u5024\u3084\u4fee\u6b63\u5024\u306e\u9069\u7528\u306f\u6700\u521d\u306e\u4e00\u56de\u3060\u3051\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20$+1\u3000\u3000\u3000K10+5$9\u3000\u3000\u3000k10-5@9$+2\u3000\u3000\u3000k10[9]+10$9\n\n\u30fb\u9996\u5207\u308a\u5200\u7528\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u4e0a\u6607 r10\n\u3000\u4f8b\uff09K20r10\u3000K30+24@8R10\u3000K40+24@8$12r10\n\n\u30fb\u30b0\u30ec\u30a4\u30c6\u30b9\u30c8\u30d5\u30a9\u30fc\u30c1\u30e5\u30f3\u306f\u672b\u5c3e\u306b gf\n\u3000\u4f8b\uff09K20gf\u3000K30+24@8GF\u3000K40+24@8$12r10gf\n\n\u30fb\u5a01\u529b\u8868\u30921d+sf\u3067\u53c2\u7167 \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5f8c\u3082\u7d99\u7d9a sf4\n\u3000\u4f8b\uff09k10sf4\u3000k0+5SF4@13\u3000k70+26sf3@9\n\n\u30fb\u5a01\u529b\u8868\u30921d+tf\u3067\u53c2\u7167 \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5f8c\u306f2d\u3067\u53c2\u7167 tf3\n\u3000\u4f8b\uff09k10tf3\u3000k0+5TF4@13\u3000k70+26tf3@9\n\n\u30fb\u8d85\u8d8a\u5224\u5b9a\u7528\u306b2d6\u30ed\u30fc\u30eb\u306b 2D6@10 \u66f8\u5f0f\u3067\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u4ed8\u4e0e\u304c\u53ef\u80fd\u306b\u3002\n\u3000\u4f8b\uff092D6@10\u30002D6@10+11>=30\n\n\u30fb\u6210\u9577\u3000(Gr)\n\u3000\u672b\u5c3e\u306b\u6570\u5b57\u3092\u4ed8\u52a0\u3059\u308b\u3053\u3068\u3067\u3001\u8907\u6570\u56de\u306e\u6210\u9577\u3092\u307e\u3068\u3081\u3066\u884c\u3048\u307e\u3059\u3002\n\u3000\u4f8b\uff09Gr3\n\n\u30fb\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3000(FT)\n\u3000\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30fb\u7d61\u307f\u52b9\u679c\u8868\u3000(TT)\n\u3000\u7d61\u307f\u52b9\u679c\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n'),y.$register_prefix("H?K","Gr","2D6?@\\d+","FT","TT"),d(y,"$initialize",function b(f){var t=this;return b.$$p=null,P(t,B(t,"initialize",b,!1,!0),"initialize",[f],null),t.rating_table=2}),d(y,"$eval_game_system_specific_command",function b(f){var R,t=this,g=I;return b.$$p=null,L(/^Gr(\d+)?/i,R=f)?v(f["$=~"](/^Gr(\d+)/i))?t.$growth(c("Regexp").$last_match(1).$to_i()):t.$growth():L(/^2D6?@\d+/i,R)?(g=o(c("Command"),"Parser").$new(/2D6?/i,N(["round_type"],{round_type:o(o(c("BCDice"),"RoundType"),"CEIL")})).$enable_critical().$restrict_cmp_op_to(I,">=",">").$parse(f),v(g)?c("TranscendentTest").$new(g.$critical(),g.$modify_number(),g.$cmp_op(),g.$target_number(),t.locale).$execute(t.randomizer):I):L("FT",R)?t.$get_fumble_table():L("TT",R)?t.$get_tangle_table():P(t,B(t,"eval_game_system_specific_command",b,!1,!0),"eval_game_system_specific_command",[f],null)}),d(y,"$rating_parser",function(){return c("RatingParser").$new(N(["version"],{version:"v2_0"}))}),d(y,"$rollDice",function b(f,m){var R=this,r=I;return b.$$p=null,v(F(f.$semi_fixed_val(),0))?(r=R.randomizer.$roll_once(6),[G(r,f.$semi_fixed_val()),r+","+f.$semi_fixed_val()]):Q(m,0)&&v(F(f.$tmp_fixed_val(),0))?(r=R.randomizer.$roll_once(6),[G(r,f.$tmp_fixed_val()),r+","+f.$tmp_fixed_val()]):v(f.$greatest_fortune())?(r=R.randomizer.$roll_once(6),[q(r,2),r+","+r]):P(R,B(R,"rollDice",b,!1,!0),"rollDice",[f,m],null)}),d(y,"$growth",function(f){return null==f&&(f=1),Y(e.Range.$new(1,f,!1),"map",[],function t(){return(null==t.$$s?this:t.$$s).$growth_step()},{$$s:this}).$join(" | ")},-1),d(y,"$growth_step",function(){var f=this,m=I,t=I,R=I;return t=(m=o(c("DiceTable"),"Table").$from_i18n("SwordWorld2_0.GrowthTable",f.locale)).$roll(f.randomizer),R=m.$roll(f.randomizer),A(t.$value(),R.$value())?"["+t.$value()+","+R.$value()+"]->("+t.$body()+" or "+R.$body()+")":"["+t.$value()+","+R.$value()+"]->("+t.$body()+")"}),d(y,"$get_fumble_table",function(){return o(c("DiceTable"),"Table").$from_i18n("SwordWorld2_0.FumbleTable",this.locale).$roll(this.randomizer)}),d(y,"$get_tangle_table",function(){return o(c("DiceTable"),"Table").$from_i18n("SwordWorld2_0.TangleTable",this.locale).$roll(this.randomizer)})},Opal.modules["bcdice/game_system/SwordWorld2_5"]=function(e){var I,C,K,z,T,h,y,$,k,p,V=e.module,j=e.klass,l=e.const_set,P=e.eqeqeq,B=e.send,d=e.hash2,L=e.truthy,v=e.send2,N=e.find_super,F=e.def,G=e.range,Q=e.rb_plus,Y=[],A=e.nil,E=e.$$$;return e.top.$require("bcdice/game_system/SwordWorld2_0"),I=Y,C=p=[V(Y[0],"BCDice")].concat(I),$=[V(p[0],"GameSystem")].concat(C),k=e.$r($),K=$,T=[z=j($[0],k("SwordWorld2_0"),"SwordWorld2_5")].concat(K),h=e.$r(T),(y=z.$$prototype).randomizer=y.locale=A,l(T[0],"ID","SwordWorld2.5"),l(T[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.5"),l(T[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u30682.5"),l(T[0],"HELP_MESSAGE",'\u81ea\u52d5\u7684\u6210\u529f\u3001\u6210\u529f\u3001\u5931\u6557\u3001\u81ea\u52d5\u7684\u5931\u6557\u306e\u81ea\u52d5\u5224\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx)\n\u3000"K\u30ad\u30fc\u30ca\u30f3\u30d0\u30fc+\u30dc\u30fc\u30ca\u30b9"\u306e\u5f62\u3067\u8a18\u5165\u3057\u307e\u3059\u3002\n\u3000\u30dc\u30fc\u30ca\u30b9\u306e\u90e8\u5206\u306b\u300cK20+K30\u300d\u306e\u3088\u3046\u306b\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u53d6\u308b\u3053\u3068\u306f\u51fa\u6765\u307e\u305b\u3093\u3002\n\u3000\u307e\u305f\u3001\u30dc\u30fc\u30ca\u30b9\u306f\u8907\u6570\u53d6\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3082\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u3068\u540c\u69d8\u306b\u3001\u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306b\u96a0\u308c\u3066\u30ed\u30fc\u30eb\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20\u3000\u3000\u3000K10+5\u3000\u3000\u3000k30\u3000\u3000\u3000k10+10\u3000\u3000\u3000Sk10-1\u3000\u3000\u3000k10+5+2\n\n\u30fb\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306e\u8a2d\u5b9a\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306f"[\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024]"\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u3000\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u306f\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502410\u3068\u3057\u307e\u3059\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u51e6\u7406\u304c\u5fc5\u8981\u306a\u3044\u3068\u304d\u306f13\u306a\u3069\u3068\u3057\u3066\u304f\u3060\u3055\u3044\u3002(\u9632\u5fa1\u6642\u306a\u3069\u306e\u5bfe\u5fdc)\n\u3000\u307e\u305f\u30bf\u30a4\u30d7\u306e\u8efd\u6e1b\u5316\u306e\u305f\u3081\u306b\u672b\u5c3e\u306b\u300c@\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u300d\u3067\u3082\u51e6\u7406\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\u3000\u4f8b\uff09K20[10]\u3000\u3000\u3000K10+5[9]\u3000\u3000\u3000k30[10]\u3000\u3000\u3000k10[9]+10\u3000\u3000\u3000k10-5@9\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u534a\u6e1b (HKx, KxH+N)\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u5148\u982d\u307e\u305f\u306f\u672b\u5c3e\u306b"H"\u3092\u3064\u3051\u308b\u3068\u3001\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3092\u632f\u3063\u3066\u6700\u7d42\u7d50\u679c\u3092\u534a\u6e1b\u3055\u305b\u307e\u3059\u3002\n\u3000\u672b\u5c3e\u306b\u3064\u3051\u305f\u5834\u5408\u3001\u76f4\u5f8c\u306b\u4fee\u6b63\u3092\u3092\u3064\u3051\u308b\u3053\u3068\u3067\u3001\u534a\u6e1b\u5f8c\u306e\u52a0\u6e1b\u7b97\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3000\u3053\u306e\u969b\u3001\u8907\u6570\u306e\u9805\u306b\u3088\u308b\u4fee\u6b63\u306b\u306f\u30ab\u30c3\u30b3\u3067\u56f2\u3046\u3053\u3068\u304c\u5fc5\u8981\u3067\u3059\uff08\u30ab\u30c3\u30b3\u304c\u306a\u3044\u3068\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3059\uff09\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3092\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u306a\u3057\u3068\u6271\u308f\u308c\u307e\u3059\u3002\n\u3000\u4f8b\uff09HK20\u3000\u3000K20h\u3000\u3000HK10-5@9\u3000\u3000K10-5@9H\u3000\u3000K20gfH\u3000\u3000K20+8H+2\u3000\u3000K20+8H+(1+1)\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e1.5\u500d (OHKx, KxOH+N)\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u5148\u982d\u307e\u305f\u306f\u672b\u5c3e\u306b"OH"\u3092\u3064\u3051\u308b\u3068\u3001\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3092\u632f\u3063\u3066\u6700\u7d42\u7d50\u679c\u30921.5\u500d\u3057\u307e\u3059\u3002\n\u3000\u672b\u5c3e\u306b\u3064\u3051\u305f\u5834\u5408\u3001\u76f4\u5f8c\u306b\u4fee\u6b63\u3092\u3092\u3064\u3051\u308b\u3053\u3068\u3067\u30011.5\u500d\u5f8c\u306e\u52a0\u6e1b\u7b97\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3000\u3053\u306e\u969b\u3001\u8907\u6570\u306e\u9805\u306b\u3088\u308b\u4fee\u6b63\u306b\u306f\u30ab\u30c3\u30b3\u3067\u56f2\u3046\u3053\u3068\u304c\u5fc5\u8981\u3067\u3059\uff08\u30ab\u30c3\u30b3\u304c\u306a\u3044\u3068\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3059\uff09\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3092\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u306a\u3057\u3068\u6271\u308f\u308c\u307e\u3059\u3002\n\u3000\u4f8b\uff09OHK20\u3000\u3000K20oh\u3000\u3000OHK10-5@9\u3000\u3000K20+8OH+2\u3000\u3000K20+8OH+(1+1)\n\n\u30fb\u30c0\u30a4\u30b9\u76ee\u306e\u4fee\u6b63\uff08\u904b\u547d\u5909\u8ee2\u3084\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30ec\u30a4\u3001\u9b54\u5973\u306e\u706b\u7528\uff09\n\u3000\u672b\u5c3e\u306b\u300c$\u4fee\u6b63\u5024\u300d\u3067\u30c0\u30a4\u30b9\u76ee\u306b\u4fee\u6b63\u304c\u304b\u304b\u308a\u307e\u3059\u3002\n\u3000$\uff0b\uff11\u3068\u4fee\u6b63\u8868\u8a18\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u306b\uff0b\u4fee\u6b63\u3001\uff04\uff19\u306e\u3088\u3046\u306b\u56fa\u5b9a\u5024\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u3092\u305d\u306e\u51fa\u76ee\u306b\u5dee\u3057\u66ff\u3048\u3002\n\u3000$~\uff0b\uff11\u3068\u30c1\u30eb\u30c0\u3092\u8ffd\u52a0\u3057\u3066\u8a18\u8ff0\u3059\u308b\u3053\u3068\u3067\u3001\u51fa\u76ee10\u4ee5\u4e0b\u306e\u5834\u5408\u306e\u307f\u30c0\u30a4\u30b9\u76ee\u306b\uff0b\u4fee\u6b63\uff08\u9b54\u5973\u306e\u706b\u7528\uff09\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3057\u305f\u5834\u5408\u3067\u3082\u56fa\u5b9a\u5024\u3084\u4fee\u6b63\u5024\u306e\u9069\u7528\u306f\u6700\u521d\u306e\u4e00\u56de\u3060\u3051\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20$+1\u3000\u3000\u3000K10+5$9\u3000\u3000\u3000k10-5@9$+2\u3000\u3000\u3000k10[9]+10$9\u3000\u3000\u3000k20+6$~+1\n\n\u30fb\u30c0\u30a4\u30b9\u76ee\u306e\u4fee\u6b63\uff08\u5fc5\u6bba\u653b\u6483\u7528\uff09\n\u3000\u300c\uff03\u4fee\u6b63\u5024\u300d\u3067\u30c0\u30a4\u30b9\u76ee\u306b\u4fee\u6b63\u304c\u304b\u304b\u308a\u307e\u3059\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3057\u305f\u5834\u5408\u3067\u3082\u4fee\u6b63\u5024\u306e\u9069\u7528\u306f\u7d99\u7d9a\u3055\u308c\u307e\u3059\u3002\n\u3000\u4f8b\uff09K20#1\u3000\u3000\u3000k10-5@9#2\n\n\u30fb\u9996\u5207\u308a\u5200\u7528\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u4e0a\u6607 r5\n\u3000\u4f8b\uff09K20r5\u3000K30+24@8R5\u3000K40+24@8$12r5\n\n\u30fb\u30b0\u30ec\u30a4\u30c6\u30b9\u30c8\u30d5\u30a9\u30fc\u30c1\u30e5\u30f3\u306f\u672b\u5c3e\u306b gf\n\u3000\u4f8b\uff09K20gf\u3000K30+24@8GF\u3000K40+24@8$12r5gf\n\n\u30fb\u5a01\u529b\u8868\u30921d+sf\u3067\u53c2\u7167 \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5f8c\u3082\u7d99\u7d9a sf4\n\u3000\u4f8b\uff09k10sf4\u3000k0+5sf4@13\u3000k70+26sf3@9\n\n\u30fb\u5a01\u529b\u8868\u30921d+tf\u3067\u53c2\u7167 \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5f8c\u306f2d\u3067\u53c2\u7167 tf3\n\u3000\u4f8b\uff09k10tf3\u3000k0+5tf4@13\u3000k70+26tf3@9\n\n\u30fb\u8d85\u8d8a\u5224\u5b9a\u7528\u306b2d6\u30ed\u30fc\u30eb\u306b 2D6@10 \u66f8\u5f0f\u3067\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u4ed8\u4e0e\u304c\u53ef\u80fd\u306b\u3002\n\u3000\u4f8b\uff092D6@10\u30002D6@10+11>=30\n\n\u30fb\u6210\u9577\u3000(Gr)\n\u3000\u672b\u5c3e\u306b\u6570\u5b57\u3092\u4ed8\u52a0\u3059\u308b\u3053\u3068\u3067\u3001\u8907\u6570\u56de\u306e\u6210\u9577\u3092\u307e\u3068\u3081\u3066\u884c\u3048\u307e\u3059\u3002\n\u3000\u4f8b\uff09Gr3\n\n\u30fb\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3000(FT)\n\u3000\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30fb\u7d61\u307f\u52b9\u679c\u8868\u3000(TT)\n\u3000\u7d61\u307f\u52b9\u679c\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30fb\u30c9\u30eb\u30a4\u30c9\u306e\u7269\u7406\u9b54\u6cd5\u7528\u8868\u3000(Dru[2-6\u306e\u5024,7-9\u306e\u5024,10-12\u306e\u5024])\n\u3000\u4f8b\uff09Dru[0,3,6]+10-3\n\n\u30fb\u30a2\u30d3\u30b9\u30ab\u30fc\u30b9\u8868\u3000(ABT)\n\u3000\u30a2\u30d3\u30b9\u30ab\u30fc\u30b9\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n'),z.$register_prefix("H?K","OHK","Gr","2D6?@\\d+","FT","TT","Dru","ABT"),F(z,"$eval_game_system_specific_command",function s(c){var f,b=this,m=A,R=A;return s.$$p=null,P(/^dru\[(\d+),(\d+),(\d+)\]/i,f=c)?(m=B(h("Regexp").$last_match().$captures(),"map",[],"to_i".$to_proc()),R=E(h("Command"),"Parser").$new(/dru\[\d+,\d+,\d+\]/i,d(["round_type"],{round_type:E(E(h("BCDice"),"RoundType"),"CEIL")})).$parse(c),L(R)?b.$druid_dice(R,m):A):P("ABT",f)?b.$get_abyss_curse_table():v(b,N(b,"eval_game_system_specific_command",s,!1,!0),"eval_game_system_specific_command",[c],null)}),F(z,"$rating_parser",function(){return h("RatingParser").$new(d(["version"],{version:"v2_5"}))}),F(z,"$druid_dice",function(c,u){var m,t,R,r,g,f=A;return m=(f=this.randomizer.$roll_barabara(2,6)).$sum(),t=P(G(2,6,!1),R=m)?0:P(G(7,9,!1),R)?1:P(G(10,12,!1),R)?2:A,r=u["$[]"](t),g=Q(r,c.$modify_number()),["("+c.$command().$capitalize()+h("Format").$modifier(c.$modify_number())+")","2D["+f.$join(",")+"]="+m,""+r+h("Format").$modifier(c.$modify_number()),g].$join(" \uff1e ")}),F(z,"$get_abyss_curse_table",function(){var f,c=this,u=A,b=A;return u=E(h("DiceTable"),"D66GridTable").$from_i18n("SwordWorld2_5.AbyssCurseTable",c.locale).$roll(c.randomizer),b=P(14,f=u.$value())?E(h("DiceTable"),"D66ParityTable").$from_i18n("SwordWorld2_5.AbyssCurseCategoryTable",c.locale).$roll(c.randomizer).$to_s():P(25,f)?E(h("DiceTable"),"D66ParityTable").$from_i18n("SwordWorld2_5.AbyssCurseAttrTable",c.locale).$roll(c.randomizer).$to_s():A,[u.$to_s(),b].$compact().$join("\n")})},Opal.queue(function(e){var G,A,_,C,n,i,I,q,V=e.module,j=e.klass,l=e.const_set,P=e.send2,B=e.find_super,d=e.def,v=[];return e.top.$require("bcdice/game_system/SwordWorld2_5"),G=v,A=q=[V(v[0],"BCDice")].concat(G),i=[V(q[0],"GameSystem")].concat(A),I=e.$r(i),_=i,l((n=[C=j(i[0],I("SwordWorld2_5"),"SwordWorld2_5_SimplifiedChinese")].concat(_))[0],"ID","SwordWorld2.5:SimplifiedChinese"),l(n[0],"NAME","\u5251\u4e16\u754c2.5"),l(n[0],"SORT_KEY","\u56fd\u969b\u5316:Simplified Chinese:\u5251\u4e16\u754c2.5"),l(n[0],"HELP_MESSAGE","\u81ea\u52a8\u6210\u529f\u3001\u6210\u529f\u3001\u5931\u8d25\u3001\u81ea\u52a8\u5931\u8d25\u4f1a\u81ea\u52a8\u5224\u5b9a\u3002\n\n  \u30fb\u5a01\u529b\u8868\u3000(Kx)\n  \u3000\u6307\u4ee4\u4e3a\u201cK\u5a01\u529b\u503c+\u52a0\u503c\u201d\u7684\u683c\u5f0f\u3002\n  \u3000\u52a0\u503c\u7684\u90e8\u5206\u4e0d\u80fd\u662f\u50cf\u201cK20+K30\u201d\u8fd9\u6837\u7684\u5a01\u529b\u7684\u5199\u6cd5\u3002\n  \u3000\u53e6\u5916\uff0c\u52a0\u503c\u53ef\u4ee5\u6709\u591a\u4e2a\u3002\n  \u3000\u5a01\u529b\u8868\u548c\u9ab0\u70b9\u4e00\u6837\uff0c\u53ef\u4ee5\u5bf9\u5176\u4ed6\u73a9\u5bb6\u9690\u85cf\u3002\n  \u3000\u4f8b\uff09K20\u3000\u3000\u3000K10+5\u3000\u3000\u3000k30\u3000\u3000\u3000k10+10\u3000\u3000\u3000Sk10-1\u3000\u3000\u3000k10+5+2\n\n  \u30fb\u66b4\u51fb\u503c\u7684\u8bbe\u5b9a\n  \u3000\u66b4\u51fb\u503c\u901a\u8fc7\u201c[\u66b4\u51fb\u503c]\u201d\u6307\u5b9a\u3002\n  \u3000\u6ca1\u6709\u6307\u5b9a\u66b4\u51fb\u503c\u65f6\u9ed8\u8ba4\u4e3a10\u3002\n  \u3000\u5982\u679c\u4e0d\u9700\u8981\u53d1\u751f\u66b4\u51fb\uff0c\u8bf7\u8bbe\u5b9a\u4e3a13\u3002\uff08\u4f8b\u5982\u9632\u5fa1\u65f6\uff09\n  \u3000\u53e6\u5916\u4e5f\u53ef\u5199\u6210\u7ed3\u5c3e\u7684\u201c@\u66b4\u51fb\u503c\u201d\u7684\u5f62\u5f0f\u3002\n  \u3000\u4f8b\uff09K20[10]\u3000\u3000\u3000K10+5[9]\u3000\u3000\u3000k30[10]\u3000\u3000\u3000k10[9]+10\u3000\u3000\u3000k10-5@9\n\n  \u30fb\u5a01\u529b\u8868\u7684\u51cf\u534a (HKx, KxH+N)\n  \u3000\u5728\u5a01\u529b\u8868\u5f00\u5934\u6216\u672b\u5c3e\u52a0\u4e0a\u201cH\u201d\uff0c\u9ab0\u5a01\u529b\u8868\u7684\u6700\u7ec8\u7ed3\u679c\u5c31\u4f1a\u51cf\u534a\u3002\n  \u3000H\u5199\u5728\u5a01\u529b\u8868\u672b\u5c3e\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u5728\u540e\u9762\u76f4\u63a5\u8ddf\u7740\u4fee\u6b63\uff0c\u4f1a\u5728\u51cf\u534a\u540e\u8fdb\u884c\u52a0\u51cf\u8fd0\u7b97\u3002\n  \u3000\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u591a\u4e2a\u4fee\u6b63\u9700\u8981\u7528\u62ec\u53f7\u62ec\u8d77\u6765\uff08\u5426\u5219\u4f1a\u89e3\u6790\u5931\u8d25\uff09\n  \u3000\u6ca1\u6709\u6307\u5b9a\u66b4\u51fb\u503c\u7684\u60c5\u51b5\u4e0b\uff0c\u5219\u89c6\u4e3a\u6ca1\u6709\u66b4\u51fb\u503c\u3002\n  \u3000\u4f8b\uff09HK20\u3000\u3000K20h\u3000\u3000HK10-5@9\u3000\u3000K10-5@9H\u3000\u3000K20gfH\u3000\u3000K20+8H+2\u3000\u3000K20+8H+(1+1)\n\n  \u30fb\u9ab0\u5b50\u51fa\u76ee\u4fee\u6b63\uff08\u547d\u8fd0\u53d8\u8f6c\u6216\u91cd\u51fb\u5149\u8f89\u7528\uff09\n  \u3000\u5728\u6307\u4ee4\u672b\u5c3e\u6dfb\u52a0\u201c$\u4fee\u6b63\u503c\u201d\u6765\u6539\u53d8\u9ab0\u5b50\u51fa\u76ee\u3002\n  \u3000\u53ef\u4ee5\u4f7f\u7528$+1\u7684\u683c\u5f0f\u5728\u9ab0\u5b50\u51fa\u76ee\u4e0a+\u4fee\u6b63\uff0c\u6216\u4f7f\u7528$9\u7684\u683c\u5f0f\u628a\u9ab0\u5b50\u51fa\u76ee\u66ff\u6362\u4e3a\u56fa\u5b9a\u503c\u3002\n  \u3000\u66b4\u51fb\u65f6\u53ea\u6709\u7b2c\u4e00\u6b21\u51fa\u76ee\u5e94\u7528\u8fd9\u4e2a\u4fee\u6b63\u3002\n  \u3000\u4f8b\uff09K20$+1\u3000\u3000\u3000K10+5$9\u3000\u3000\u3000k10-5@9$+2\u3000\u3000\u3000k10[9]+10$9\n\n  \u30fb\u9ab0\u5b50\u51fa\u76ee\u4fee\u6b63\uff08\u5fc5\u6740\u653b\u51fb\u7528\uff09\n  \u3000\u5199\u6210\u201c#\u4fee\u6b63\u503c\u201c\u7684\u683c\u5f0f\u6765\u589e\u52a0\u9ab0\u5b50\u51fa\u76ee\u3002\n  \u3000\u66b4\u51fb\u65f6\u540e\u7eed\u9ab0\u5b50\u4e5f\u4f1a\u7ee7\u7eed\u5e94\u7528\u4fee\u6b63\u503c\u3002\n  \u3000\u4f8b\uff09K20#1\u3000\u3000\u3000k10-5@9#2\n\n  \u30fb\u5a01\u529b\u4e0a\u5347\uff08\u65a9\u9996\u5200\u7528\uff09 r5\n  \u3000r\u540e\u8ddf\u4e0a\u5347\u503c\uff0c\u66b4\u51fb\u540e\u5a01\u529b\u4e0a\u5347r\u540e\u6240\u586b\u5199\u7684\u4e0a\u5347\u503c\u70b9\n  \u3000\u4f8b\uff09K20r5\u3000K30+24@8R5\u3000K40+24@8$12r5\n\n  \u30fb\u6781\u9650\u547d\u8fd0\u5728\u672b\u5c3e\u52a0\u4e0a gf\n  \u3000\u4f8b\uff09K20gf\u3000K30+24@8GF\u3000K40+24@8$12r5gf\n\n  \u30fb\u5a01\u529b\u8868\u4f7f\u75281d+\u56fa\u5b9a\u503c\u5bf9\u5e94 \u66b4\u51fb\u540e\u4ecd\u7ee7\u7eed sf4\n  \u3000\u4f8b\uff09k10sf4\u3000k0+5sf4@13\u3000k70+26sf3@9\n\n  \u30fb\u5a01\u529b\u8868\u4f7f\u75281d+\u56fa\u5b9a\u503c\u5bf9\u5e94 \u66b4\u51fb\u540e\u53d8\u56de\u4f7f\u75282d\u5bf9\u5e94 tf3\n  \u3000\u4f8b\uff09k10tf3\u3000k0+5tf4@13\u3000k70+26tf3@9\n\n  \u30fb\u8d85\u8d8a\u5224\u5b9a\u75282d6\u53ef\u5199\u6210 2d6@10 \u7684\u683c\u5f0f\u52a0\u4e0a\u66b4\u51fb\u503c\u3002\n  \u3000\u4f8b\uff092D6@10\u30002D6@10+11>=30\n\n  \u30fb\u6210\u957f\u3000(Gr)\n  \u3000\u5728Gr\u540e\u9762\u52a0\u4e0a\u6570\u5b57\u53ef\u4ee5\u8fdb\u884c\u591a\u6b21\u6210\u957f\u3002\n  \u3000\u4f8b\uff09Gr3\n\n  \u30fb\u9632\u5fa1\u5927\u5931\u8d25\u8868\u3000(FT)\n  \u3000\u62bd\u53d6\u9632\u5fa1\u5927\u5931\u8d25\u8868\u3002\n\n  \u30fb\u7f20\u7ed5\u6548\u679c\u8868\u3000(TT)\n  \u3000\u62bd\u53d6\u7f20\u7ed5\u6548\u679c\u8868\u3002\n\n  \u30fb\u5fb7\u9c81\u4f0a\u7528\u7269\u7406\u9b54\u6cd5\u8868 (Dru[2~6\u7684\u7ed3\u679c\uff0c7~9\u7684\u7ed3\u679c\uff0c10~12\u7684\u7ed3\u679c])\n  \u3000\u4f8b\uff09Dru[0,3,6]+10-3\n\n  \u30fb\u5948\u843d\u8bc5\u5492\u8868\u3000(ABT)\n  \u3000\u62bd\u53d6\u5948\u843d\u8bc5\u5492\u8868\u3002\n"),C.$register_prefix_from_super_class(),d(C,"$initialize",function $(k){var S=this;return $.$$p=null,P(S,B(S,"initialize",$,!1,!0),"initialize",[k],null),S.locale="zh_hans"})})}}]);