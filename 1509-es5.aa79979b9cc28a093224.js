(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[1509],{11509:function(t,e,n){n(93683),Opal.modules["bcdice/game_system/EarthDawn"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function $(t,e){return"number"==typeof t&&"number"==typeof e?t>=e:t["$>="](e)}var s,a,o,u,l,g,c,d,p,f,_,m,y,h=[],b=t.nil,S=t.$$,E=t.module,x=t.klass,R=t.send2,v=t.truthy,D=t.send;return s=h,a=y=[E(h[0],"BCDice")].concat(s),o=m=[E(y[0],"GameSystem")].concat(a),f=x(m[0],S(m,"Base"),"EarthDawn"),_=[f].concat(o),f.$$prototype.string=f.$$prototype.isFailed=b,t.const_set(_[0],"ID","EarthDawn"),t.const_set(_[0],"NAME","\u30a2\u30fc\u30b9\u30c9\u30fc\u30f3"),t.const_set(_[0],"SORT_KEY","\u3042\u3042\u3059\u3068\u304a\u3093"),t.const_set(_[0],"HELP_MESSAGE","\u30b9\u30c6\u30c3\u30d7\u30c0\u30a4\u30b9\u3000(xEn+k)\n\u30b9\u30c6\u30c3\u30d7x\u3001\u76ee\u6a19\u5024n(\u7701\u7565\u53ef\u80fd\uff09\u3001\u30ab\u30eb\u30de\u30c0\u30a4\u30b9k(D2-D20)\u3067\u30b9\u30c6\u30c3\u30d7\u30c0\u30a4\u30b9\u3092\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002\n\u632f\u308a\u8db3\u3057\u3082\u81ea\u52d5\u3002\n\u4f8b\uff099E\u300010E8\u300010E+D12\n"),f.$register_prefix("\\d+e"),t.def(f,"$initialize",u=function(e){var n=this;return u.$$p&&(u.$$p=null),R(n,t.find_super_dispatcher(n,"initialize",u,!1,!0),"initialize",[e],null),n.sort_add_dice=!0},u.$$arity=1),t.def(f,"$eval_game_system_specific_command",l=function(t){return this.$ed_step(t)},l.$$arity=1),t.def(f,"$ed_step",g=function(t){return this.$getStepResult(t)},g.$$arity=1),t.def(f,"$getStepResult",c=function(t){var s=this,a=b,o=b,u=b,l=b,g=b,c=b,d=b,p=b,f=b,m=b,y=b,h=b,E=b,x=b,R=b,D=b,z=b,T=b,k=b,w=b;return!v(/(\d+)E(\d+)?(\+)?(\d+)?(d\d+)?/i["$=~"](t))||(a=0,s.isFailed=!0,o=S(_,"Regexp").$last_match(1).$to_i(),u=0,l=!1,g=0,c=0,v(e(o,40))&&(o=40),v(S(_,"Regexp").$last_match(2))&&(u=S(_,"Regexp").$last_match(2).$to_i(),v(e(u,43))&&(u=42)),v(S(_,"Regexp").$last_match(3))&&(l=S(_,"Regexp").$last_match(3).$to_i()),v(S(_,"Regexp").$last_match(4))&&(g=S(_,"Regexp").$last_match(4).$to_i()),v(S(_,"Regexp").$last_match(5))&&(c=S(_,"Regexp").$last_match(5)),v(n(u,0)))?b:(p=(d=s.$getStepTable())["$[]"](0)["$[]"](r(o,1)),f=d["$[]"](1)["$[]"](r(o,1)),m=d["$[]"](2)["$[]"](r(o,1)),y=d["$[]"](3)["$[]"](r(o,1)),h=d["$[]"](4)["$[]"](r(o,1)),E=d["$[]"](5)["$[]"](r(o,1)),x=d["$[]"](6)["$[]"](r(o,1)),v(l)&&(/d20/i["$==="](R=c)?f=i(f,g):/d12/i["$==="](R)?m=i(m,g):/d10/i["$==="](R)?y=i(y,g):/d8/i["$==="](R)?h=i(h,g):/d6/i["$==="](R)?E=i(E,g):/d4/i["$==="](R)?x=i(x,g):p=i(p,g)),s.string="",s.$debug("d20step, d12step, d10step, d8step, d6step, d4step",f,m,y,h,E,x),a=i(a,s.$rollStep(20,f)),a=i(a,s.$rollStep(12,m)),a=i(a,s.$rollStep(10,y)),a=i(a,s.$rollStep(8,h)),a=i(a,s.$rollStep(6,E)),a=i(a,s.$rollStep(4,x)),v(e(p,0))&&(s.string=i(s.string,"+")),v(p["$!="](0))&&(s.string=i(s.string,p.$to_s()),a=i(a,p)),s.string=i(s.string," \uff1e "+a),D="\u30b9\u30c6\u30c3\u30d7"+o+" \uff1e "+s.string,u["$=="](0)||(s.string=i(s.string," \uff1e "),z=d["$[]"](7)["$[]"](r(u,1)),T=d["$[]"](8)["$[]"](r(u,1)),k=d["$[]"](9)["$[]"](r(u,1)),w=d["$[]"](11)["$[]"](r(u,1)),s.string=v(s.isFailed)?i(s.string,"\u81ea\u52d5\u5931\u6557"):v($(a,z))?i(s.string,"\u6700\u826f\u6210\u529f"):v($(a,T))?i(s.string,"\u512a\u6210\u529f"):v($(a,k))?i(s.string,"\u826f\u6210\u529f"):v($(a,u))?i(s.string,"\u6210\u529f"):v(n(a,w))?i(s.string,"\u5927\u5931\u6557"):i(s.string,"\u5931\u6557"),D="\u30b9\u30c6\u30c3\u30d7"+o+">="+u+" \uff1e "+s.string),D)},c.$$arity=1),t.def(f,"$getStepTable",d=function(){return[[-2,-1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,0,0,2,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1],[0,0,0,0,0,1,0,0,0,1,1,2,1,0,0,0,1,0,0,0,1,1,2,1,1,1,1,2,1,1,1,2,3,2,1,1,1,2,1,1,0,0,1,0,0,0,1,0,0,0,1,1,2,1],[0,0,0,0,1,0,0,0,1,0,1,0,0,0,0,1,0,0,0,1,0,1,0,0,1,1,2,1,1,1,2,2,1,1,1,1,2,1,1,1,0,0,1,0,0,1,0,0,0,1,0,1,0,0],[0,0,0,1,0,0,0,2,1,1,0,0,0,0,1,0,0,0,2,1,1,0,0,0,0,1,0,0,0,2,1,0,0,0,0,1,0,0,0,2,0,0,0,0,1,0,0,0,2,1,1,0,0,0],[1,1,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0],[6,8,10,12,14,17,19,20,22,24,25,27,29,32,33,35,37,38,39,41,42,44,45,47,48,49,51,52,54,55,56,58,59,60,62,64,65,67,68,70,71,72],[4,6,8,10,11,13,15,16,18,19,21,22,24,26,27,29,30,32,33,34,35,37,38,40,41,42,43,45,46,47,48,49,51,52,53,55,56,58,59,60,61,62],[2,4,6,7,9,10,12,13,14,15,17,18,20,21,22,24,25,26,27,28,29,31,32,33,34,35,36,38,39,40,41,42,43,45,46,47,48,50,51,52,53,54],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42],[0,1,1,1,1,2,2,3,4,5,5,6,6,7,8,8,9,10,11,12,13,13,14,15,16,17,18,18,18,20,21,22,23,23,24,25,26,26,27,28,29,30]]},d.$$arity=0),void t.def(f,"$rollStep",p=function(t,n){var r,$=this,s=b;return $.$debug("rollStep diceType, diceCount, @string",t,n,$.string),s=0,v(e(n,0))&&(v($.string["$empty?"]())||($.string=i($.string,"+")),$.string=i($.string,n+"d"+t+"["),$.$debug("rollStep @string",$.string),D(n,"times",[],((r=function(e){var n=null==r.$$s?this:r.$$s,$=b,a=b;for(null==n.randomizer&&(n.randomizer=b),null==n.string&&(n.string=b),null==e&&(e=b),$=n.randomizer.$roll_once(t),v($["$!="](1))&&(n.isFailed=!1),a=$;$["$=="](t);)a=i(a,$=n.randomizer.$roll_once(t));return s=i(s,a),v(e["$!="](0))&&(n.string=i(n.string,",")),n.string=i(n.string,a.$to_s())}).$$s=$,r.$$arity=1,r)),$.string=i($.string,"]")),s},p.$$arity=2)},function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t>=e:t["$>="](e)}var $,s,a,o,u,l,g,c,d,p,f,_,m,y,h,b,S,E,x=[],R=t.nil,v=t.$$,D=t.module,z=t.klass,T=t.send2,k=t.truthy,w=t.send;t.top.$require("bcdice/game_system/EarthDawn"),$=x,s=E=[D(x[0],"BCDice")].concat($),a=S=[D(E[0],"GameSystem")].concat(s),h=z(S[0],v(S,"EarthDawn"),"EarthDawn3"),b=[h].concat(a),h.$$prototype.string=h.$$prototype.isFailed=R,t.const_set(b[0],"ID","EarthDawn3"),t.const_set(b[0],"NAME","\u30a2\u30fc\u30b9\u30c9\u30fc\u30f33\u7248"),t.const_set(b[0],"SORT_KEY","\u3042\u3042\u3059\u3068\u304a\u30933"),t.const_set(b[0],"HELP_MESSAGE","\u30b9\u30c6\u30c3\u30d7\u30c0\u30a4\u30b9\u3000(xEn+k)\n\u30b9\u30c6\u30c3\u30d7x\u3001\u76ee\u6a19\u5024n(\u7701\u7565\u53ef\u80fd\uff09\u3001\u30ab\u30eb\u30de\u30c0\u30a4\u30b9k(D2\uff5eD20)\u3067\u30b9\u30c6\u30c3\u30d7\u30c0\u30a4\u30b9\u3092\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002\n\u632f\u308a\u8db3\u3057\u3082\u81ea\u52d5\u3002\n\u4f8b\uff09\u30b9\u30c6\u30c3\u30d710\uff1a10E\n\u3000\u3000\u30b9\u30c6\u30c3\u30d710\u3001\u76ee\u6a19\u50248\uff1a10E8\n\u3000\u3000\u30b9\u30c6\u30c3\u30d712\u3001\u76ee\u6a19\u50248\u3001\u30ab\u30eb\u30de\u30c0\u30a4\u30b9D12\uff1a10E8+1D6\n"),h.$register_prefix("\\d+e"),t.def(h,"$initialize",o=function(e){var n=this;return o.$$p&&(o.$$p=null),T(n,t.find_super_dispatcher(n,"initialize",o,!1,!0),"initialize",[e],null),n.sort_add_dice=!0},o.$$arity=1),t.def(h,"$eval_game_system_specific_command",u=function(t){return this.$ed_step(t)},u.$$arity=1),t.def(h,"$ed_step",l=function(t){return this.$getStepResult(t)},l.$$arity=1),t.def(h,"$getStepResult",g=function(r){var i,$,s,a=this,o=R,u=R,l=R,g=R,c=R,d=R,p=R,f=R,_=R,m=R,y=R,h=R;return!k(/^(\d+)E(\d+)?(\+(\d*)D(\d+))?(\+\d)?/i["$=~"](r))||(o=0,a.isFailed=!0,u=v(b,"Regexp").$last_match(1).$to_i(),l=[v(b,"Regexp").$last_match(2).$to_i(),20].$min(),g=v(b,"Regexp").$last_match(3)["$nil?"]()["$!"](),c=[1,v(b,"Regexp").$last_match(4).$to_i()].$max(),d=v(b,"Regexp").$last_match(5).$to_i(),p=v(b,"Regexp").$last_match(6).$to_i(),f=v(b,"Hash").$new(0),k(g)&&(w(f,"[]=",t.to_a(_=[d,c])),e(_.length,1)),k("number"==typeof(s=l)?s<0:s["$<"](0)))?R:(m=a.$getStepInfo(u),a.$debug("stepInfo",m),a.string="",w([20,12,10,8,6,4],"each",[],((i=function(t){return null==t&&(t=R),o=n(o,(null==i.$$s?this:i.$$s).$rollStep(t,m.$shift()))}).$$s=a,i.$$arity=1,i)),y=m.$shift(),w(f,"each",[],(($=function(t,e){return null==t&&(t=R),null==e&&(e=R),o=n(o,(null==$.$$s?this:$.$$s).$rollStep(t,e))}).$$s=a,$.$$arity=2,$)),a.string=n(a.string,n(a.$getModifyText(y),a.$getModifyText(p))),o=n(o,n(y,p)),a.string=n(a.string," \uff1e "+o),h="\u30b9\u30c6\u30c3\u30d7"+u+" \uff1e "+a.string,l["$=="](0)||(a.string=n(a.string,n(" \uff1e ",a.$getSuccess(l,o))),h="\u30b9\u30c6\u30c3\u30d7"+u+">="+l+" \uff1e "+a.string),h)},g.$$arity=1),t.def(h,"$getModifyText",c=function(t){var e=this;return e.string="",t["$=="](0)||(k(r(t,0))&&(e.string=n(e.string,"+")),e.string=n(e.string,t.$to_s())),e.string},c.$$arity=1),t.def(h,"$getBaseStepTable",d=function(){return[[1,[0,0,0,0,1,0,-3]],[2,[0,0,0,0,1,0,-2]],[3,[0,0,0,0,1,0,-1]],[4,[0,0,0,0,1,0,0]],[5,[0,0,0,1,0,0,0]],[6,[0,0,1,0,0,0,0]],[7,[0,1,0,0,0,0,0]]]},d.$$arity=0),t.def(h,"$getStepInfo",p=function(t){var n,r,i=this,$=R,s=R,a=R,o=R,u=R,l=R,g=R,c=R;return r=($=i.$getBaseStepTable()).$last().$first(),k(function(t,e){return"number"==typeof t&&"number"==typeof e?t<=e:t["$<="](e)}(t,r))?i.$get_table_by_number(t,$):(s=[0,1,0,0,0,0,0],a=e(e(t,r),1),u=[0,0,0,0,0,0,0],l=function(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}(a,(o=[[0,0,0,0,2,0,0],[0,0,0,1,1,0,0],[0,0,0,2,0,0,0],[0,0,1,1,0,0,0],[0,0,2,0,0,0,0],[0,1,1,0,0,0,0],[0,2,0,0,0,0,0]]).$size()).$to_i(),w(l,"times",[],((n=function(){return(null==n.$$s?this:n.$$s).$addStepToResult(u,s)}).$$s=i,n.$$arity=0,n)),g=a["$%"](o.$size()),c=o["$[]"](g),i.$addStepToResult(u,c),u)},p.$$arity=1),t.def(h,"$addStepToResult",f=function(r,i){var $;return w(r.$size(),"times",[],(($=function($){var s;return null==$&&($=R),s=[$,n(r["$[]"]($),i["$[]"]($))],w(r,"[]=",t.to_a(s)),s[e(s.length,1)]}).$$s=this,$.$$arity=1,$)),r},f.$$arity=2),t.def(h,"$getSuccess",_=function(e,n){var r,$=this,s=R,a=R,o=R,u=R,l=R,g=R,c=R;return k($.isFailed)?"\u81ea\u52d5\u5931\u6557":(s=$.$getSuccessTable(),a=$.$get_table_by_number(e,s),o=null==(r=t.to_ary(a))[0]?R:r[0],u=null==r[1]?R:r[1],l=null==r[2]?R:r[2],g=null==r[3]?R:r[3],c=null==r[4]?R:r[4],k(i(n,null==r[5]?R:r[5]))?"Extraordinary(\u6975\u4e0a)":k(i(n,c))?"Excelent(\u6700\u9ad8)":k(i(n,g))?"Good(\u4e0a\u51fa\u6765)":k(i(n,l))?"Average(\u305d\u3053\u305d\u3053)":k(i(n,u))?"Poor(\u304a\u7c97\u672b)":k(i(n,o))?"Pathetic(\u60e8\u3081)":R)},_.$$arity=2),t.def(h,"$getSuccessTable",m=function(){return[[2,[0,1,2,5,7,9]],[3,[0,1,3,6,8,10]],[4,[0,1,4,7,10,12]],[5,[1,2,5,8,11,14]],[6,[1,2,6,9,13,17]],[7,[1,3,7,11,15,19]],[8,[1,4,8,13,16,20]],[9,[1,5,9,15,18,22]],[10,[1,6,10,16,20,24]],[11,[1,6,11,17,21,25]],[12,[1,7,12,18,23,27]],[13,[1,7,13,20,25,29]],[14,[1,8,14,21,26,31]],[15,[1,9,15,23,27,31]],[16,[1,10,16,24,28,33]],[17,[1,11,17,25,30,34]],[18,[1,12,18,26,31,36]],[19,[1,12,19,28,33,37]],[20,[1,13,20,29,34,39]],[21,[1,14,21,30,36,41]],[22,[1,15,22,31,37,42]],[23,[1,16,23,33,38,43]],[24,[1,16,24,34,39,44]],[25,[1,17,25,35,41,46]],[26,[1,18,26,36,42,47]],[27,[1,19,27,37,43,49]],[28,[1,19,28,39,45,50]],[29,[1,21,29,40,46,51]],[30,[1,21,30,41,47,53]],[31,[1,22,31,42,48,54]],[32,[1,23,32,43,49,55]],[33,[1,24,33,45,51,57]],[34,[1,24,34,46,52,58]],[35,[1,25,35,47,53,60]],[36,[1,26,36,48,54,60]],[37,[1,27,37,49,56,62]],[38,[1,28,38,51,57,63]],[39,[1,29,39,52,58,64]],[40,[1,30,40,53,59,66]]]},m.$$arity=0),t.def(h,"$rollStep",y=function(t,e){var i,$=this,s=R;return $.$debug("rollStep diceType, diceCount, @string",t,e,$.string),s=0,k(r(e,0))&&(k($.string["$empty?"]())||($.string=n($.string,"+")),$.string=n($.string,e+"d"+t+"["),$.$debug("rollStep @string",$.string),w(e,"times",[],((i=function(e){var r=null==i.$$s?this:i.$$s,$=R,a=R;for(null==r.randomizer&&(r.randomizer=R),null==r.string&&(r.string=R),null==e&&(e=R),$=r.randomizer.$roll_once(t),k($["$!="](1))&&(r.isFailed=!1),a=$;$["$=="](t);)a=n(a,$=r.randomizer.$roll_once(t));return s=n(s,a),k(e["$!="](0))&&(r.string=n(r.string,",")),r.string=n(r.string,a.$to_s())}).$$s=$,i.$$arity=1,i)),$.string=n($.string,"]")),s},y.$$arity=2)}(Opal)}}]);