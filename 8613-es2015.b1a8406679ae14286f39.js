(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[8613],{28613:function(e,_,t){var r,a,s,l,o,i,n,$,u,c,f,d;t(93683),Opal.modules["bcdice/arithmetic_evaluator"]=function(e){var _,t,r,a,s,l,o,i,n=[],$=e.nil,u=e.$$$,c=e.$$,f=e.module,d=e.hash2,E=e.truthy;return _=n,t=i=[f(n[0],"BCDice")].concat(_),o=[l=f(i[0],"ArithmeticEvaluator")].concat(t),r=e.get_singleton_class(l),s=[r].concat(o),void e.def(r,"$eval",a=function(_,t){var r,a=$;if(null==t)t=d([],{});else if(!t.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(r=t.$$smap.round_type)&&(r=u(c(s,"RoundType"),"FLOOR")),E(_)&&E(a=c(s,"Arithmetic").$eval(_,r))?a:0},a.$$arity=-2)},Opal.modules["bcdice/game_system/SRS"]=function(e){function _(e,_){return"number"==typeof e&&"number"==typeof _?e>=_:e["$>="](_)}var t,r,a,s,l,o,i,n,$,u,c,f,d,E,p,h,m,S,g,v,L,R,A,y,T,w=[],D=e.nil,U=e.$$$,G=e.$$,M=e.module,F=e.klass,H=e.send,P=e.send2,b=e.truthy,O=e.hash2;return e.top.$require("bcdice/arithmetic_evaluator"),t=w,r=T=[M(w[0],"BCDice")].concat(t),a=y=[M(T[0],"GameSystem")].concat(r),R=F(y[0],G(y,"Base"),"SRS"),A=[R].concat(a),R.$$prototype.round_type=R.$$prototype.randomizer=R.$$prototype.sort_add_dice=D,e.const_set(A[0],"ID","SRS"),e.const_set(A[0],"NAME","\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0"),e.const_set(A[0],"SORT_KEY","\u3059\u305f\u3093\u305f\u3042\u3068RPG\u3057\u3059\u3066\u3080"),e.const_set(A[0],"HELP_MESSAGE_1","\u30fb\u5224\u5b9a\n\u3000\u30fb\u901a\u5e38\u5224\u5b9a\uff1a2D6+m>=t[c,f]\n\u3000\u3000\u4fee\u6b63\u5024m\u3001\u76ee\u6a19\u5024t\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024c\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024f\u3067\u5224\u5b9a\u30ed\u30fc\u30eb\u3092\u884c\u3044\u307e\u3059\u3002\n\u3000\u3000\u4fee\u6b63\u5024\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u306f\u7701\u7565\u53ef\u80fd\u3067\u3059\uff08[]\u3054\u3068\u7701\u7565\u53ef\uff09\u3002\n\u3000\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u306e\u65e2\u5b9a\u5024\u306f\u3001\u305d\u308c\u305e\u308c12\u30012\u3067\u3059\u3002\n\u3000\u3000\u81ea\u52d5\u6210\u529f\u3001\u81ea\u52d5\u5931\u6557\u3001\u6210\u529f\u3001\u5931\u6557\u3092\u81ea\u52d5\u8868\u793a\u3057\u307e\u3059\u3002\n\n\u3000\u3000\u4f8b) 2d6>=10\u3000\u3000\u3000\u3000\u3000\u4fee\u6b63\u50240\u3001\u76ee\u6a19\u502410\u3067\u5224\u5b9a\n\u3000\u3000\u4f8b) 2d6+2>=10\u3000\u3000\u3000\u3000\u4fee\u6b63\u5024+2\u3001\u76ee\u6a19\u502410\u3067\u5224\u5b9a\n\u3000\u3000\u4f8b) 2d6+2>=10[11]\u3000\u3000\u2191\u3092\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502411\u3067\u5224\u5b9a\n\u3000\u3000\u4f8b) 2d6+2>=10[12,4]\u3000\u2191\u3092\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502412\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u50244\u3067\u5224\u5b9a\n"),e.const_set(A[0],"HELP_MESSAGE_2","\u3000\u30fb\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u304a\u3088\u3073\u30d5\u30a1\u30f3\u30d6\u30eb\u306e\u307f\u306e\u5224\u5b9a\uff1a2D6+m[c,f]\n\u3000\u3000\u76ee\u6a19\u5024\u3092\u6307\u5b9a\u305b\u305a\u3001\u4fee\u6b63\u5024m\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024c\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024f\u3067\u5224\u5b9a\u30ed\u30fc\u30eb\u3092\u884c\u3044\u307e\u3059\u3002\n\u3000\u3000\u4fee\u6b63\u5024\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u306f\u7701\u7565\u53ef\u80fd\u3067\u3059\uff08[]\u306f\u7701\u7565\u4e0d\u53ef\uff09\u3002\n\u3000\u3000\u81ea\u52d5\u6210\u529f\u3001\u81ea\u52d5\u5931\u6557\u3092\u81ea\u52d5\u8868\u793a\u3057\u307e\u3059\u3002\n\n\u3000\u3000\u4f8b) 2d6[]\u3000\u3000\u3000\u3000\u4fee\u6b63\u50240\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502412\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u50242\u3067\u5224\u5b9a\n\u3000\u3000\u4f8b) 2d6+2[11]\u3000\u3000\u4fee\u6b63\u5024+2\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502411\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u50242\u3067\u5224\u5b9a\n\u3000\u3000\u4f8b) 2d6+2[12,4]\u3000\u4fee\u6b63\u5024+2\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502412\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u50244\u3067\u5224\u5b9a\n"),e.const_set(A[0],"HELP_MESSAGE_3","\u30fbD66\u30c0\u30a4\u30b9\u3042\u308a\uff08\u5165\u308c\u66ff\u3048\u306a\u3057)\n"),e.const_set(A[0],"DEFAULT_HELP_MESSAGE",G(A,"HELP_MESSAGE_1")+"\n"+G(A,"HELP_MESSAGE_2")+"\n"+G(A,"HELP_MESSAGE_3")),e.const_set(A[0],"HELP_MESSAGE",G(A,"DEFAULT_HELP_MESSAGE")),p=A,v=M(A[0],"ClassMethods"),L=[v].concat(p),v.$attr_reader("help_message"),v.$attr_reader("aliases_re_for_srs_roll_with_target_value"),v.$attr_reader("aliases_re_for_srs_roll_without_target_value"),e.def(v,"$set_aliases_for_srs_roll",h=function(_){var t,r,a=this,s=D,l=D;return t=e.slice.call(arguments,0,arguments.length),s=H(t,"map",[],"upcase".$to_proc()),l=H(s,"map",[],(r=function(e){return null==e&&(e=D),G(L,"Regexp").$escape(e)},r.$$s=a,r.$$arity=1,r)).$join("|"),a.aliases_re_for_srs_roll_with_target_value=G(L,"Regexp").$new("^(?:"+l+")((?:[-+][-+\\d]+)?>=\\d+(?:\\[\\d*(?:,\\d+)?\\])?)$"),a.aliases_re_for_srs_roll_without_target_value=G(L,"Regexp").$new("^(?:"+l+")([-+][-+\\d]+)?(\\[\\d*(?:,\\d+)?\\])?$"),a.$prepare_help_msg_for_aliases_for_srs_roll(s),a.help_message=a.$concatenate_help_messages(),a},h.$$arity=-1),e.def(v,"$clear_aliases_for_srs_roll",m=function(){var e=this;return e.aliases_re_for_srs_roll_with_target_value=D,e.aliases_re_for_srs_roll_without_target_value=D,e.help_message=U(G(L,"SRS"),"DEFAULT_HELP_MESSAGE"),e},m.$$arity=0),v.$private(),e.def(v,"$prepare_help_msg_for_aliases_for_srs_roll",S=function(e){var _,t,r=this;return r.help_msg_for_aliases_for_srs_roll_with_target_value=H(e,"map",[],(_=function(e){return null==e&&(e=D),"\u3000\u3000\u4f8b) "+e+"+2>=10\u3000\u3000\u3000\u3000 2d6+2>=10\u3068\u540c\u3058\uff08"+e+"\u304c2D6\u306e\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\uff09\n"},_.$$s=r,_.$$arity=1,_)).$join(),r.help_msg_for_aliases_for_srs_roll_without_target_value=H(e,"map",[],(t=function(e){return null==e&&(e=D),"\u3000\u3000\u4f8b) "+e+"\u3000\u3000\u3000\u3000\u3000 2d6[]\u3068\u540c\u3058\uff08"+e+"\u304c2D6\u306e\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\uff09\n\u3000\u3000\u4f8b) "+e+"+2[12,4]\u3000 2d6+2[12,4]\u3068\u540c\u3058\uff08"+e+"\u304c2D6\u306e\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\uff09\n"},t.$$s=r,t.$$arity=1,t)).$join(),r},S.$$arity=1),e.def(v,"$concatenate_help_messages",g=function(){var e=this;return null==e.help_msg_for_aliases_for_srs_roll_with_target_value&&(e.help_msg_for_aliases_for_srs_roll_with_target_value=D),null==e.help_msg_for_aliases_for_srs_roll_without_target_value&&(e.help_msg_for_aliases_for_srs_roll_without_target_value=D),U(G(L,"SRS"),"HELP_MESSAGE_1")+(e.help_msg_for_aliases_for_srs_roll_with_target_value+"\n")+U(G(L,"SRS"),"HELP_MESSAGE_2")+e.help_msg_for_aliases_for_srs_roll_without_target_value+"\n"+U(G(L,"SRS"),"HELP_MESSAGE_3")},g.$$arity=0),function(_,t){var r,a,s,l,o=[_].concat(t);e.def(_,"$inherited",r=function(e){return e.$extend(G(o,"ClassMethods")).$clear_aliases_for_srs_roll()},r.$$arity=1),e.def(_,"$help_message",a=function(){return G(o,"DEFAULT_HELP_MESSAGE")},a.$$arity=0),e.def(_,"$aliases_re_for_srs_roll_with_target_value",s=function(){return D},s.$$arity=0),e.def(_,"$aliases_re_for_srs_roll_without_target_value",l=function(){return D},l.$$arity=0)}(e.get_singleton_class(R),A),R.$register_prefix("2D6"),e.def(R,"$initialize",s=function(_){var t=this;return s.$$p&&(s.$$p=null),P(t,e.find_super_dispatcher(t,"initialize",s,!1,!0),"initialize",[_],null),t.sort_add_dice=!0,t.d66_sort_type=U(G(A,"D66SortType"),"NO_SORT")},s.$$arity=1),e.def(R,"$help_message",l=function(){return this.$class().$help_message()},l.$$arity=0),e.const_set(A[0],"DEFAULT_CRITICAL_VALUE",12),e.const_set(A[0],"DEFAULT_FUMBLE_VALUE",2),e.const_set(A[0],"SRS_ROLL_WITH_TARGET_VALUE_RE",/^2D6([-+][-+\d]+)?>=(\d+)(?:\[(\d+)?(?:,(\d+))?\])?$/.$freeze()),e.const_set(A[0],"SRS_ROLL_WITHOUT_TARGET_VALUE_RE",/^2D6([-+][-+\d]+)?\[(\d+)?(?:,(\d+))?\]$/.$freeze()),e.const_set(A[0],"SRS_ROLL_DEFAULT_THRESHOLDS","["+G(A,"DEFAULT_CRITICAL_VALUE")+","+G(A,"DEFAULT_FUMBLE_VALUE")+"]"),e.const_set(A[0],"SRSRollNode",H(G(A,"Struct"),"new",["modifier","critical_value","fumble_value","target_value"],((o=function(){var _;return e.def(null==o.$$s?this:o.$$s,"$to_s",_=function(){var e,_=this;return e="2D6"+G(A,"Format").$modifier(_.$modifier()),(b(_.$target_value())?e+">="+_.$target_value():e)+"["+_.$critical_value()+","+_.$fumble_value()+"]"},_.$$arity=0),D&&"to_s"}).$$s=R,o.$$arity=0,o))),e.def(R,"$eval_game_system_specific_command",i=function(e){var _,t,r=this;return _=r.$replace_alias_for_srs_roll_with_2d6(e),b(t=r.$parse(_))?r.$execute_srs_roll(t):D},i.$$arity=1),R.$private(),e.def(R,"$replace_alias_for_srs_roll_with_2d6",n=function(e){var _,t=D;return _=e,this.$class().$aliases_re_for_srs_roll_with_target_value()["$==="](_)?"2D6"+G(A,"Regexp").$last_match(1):this.$class().$aliases_re_for_srs_roll_without_target_value()["$==="](_)?"2D6"+G(A,"Regexp").$last_match(1)+(b(t=G(A,"Regexp").$last_match(2))?t:G(A,"SRS_ROLL_DEFAULT_THRESHOLDS")):e},n.$$arity=1),e.def(R,"$parse",$=function(e){var _;return _=e,G(A,"SRS_ROLL_WITH_TARGET_VALUE_RE")["$==="](_)?this.$parse_srs_roll_with_target_value(G(A,"Regexp").$last_match()):G(A,"SRS_ROLL_WITHOUT_TARGET_VALUE_RE")["$==="](_)?this.$parse_srs_roll_without_target_value(G(A,"Regexp").$last_match()):D},$.$$arity=1),e.def(R,"$eval_modifier",u=function(e){return b(e)?G(A,"ArithmeticEvaluator").$eval(e,O(["round_type"],{round_type:this.round_type})):0},u.$$arity=1),e.def(R,"$parse_srs_roll_with_target_value",c=function(e){var _,t,r,a,s,l,o,i;return r=this.$eval_modifier(e["$[]"](1)),a=e["$[]"](2).$to_i(),s=b(o=(_=e["$[]"](3))===D||null==_?D:H(_,"to_i",[]))?o:G(A,"DEFAULT_CRITICAL_VALUE"),l=b(i=(t=e["$[]"](4))===D||null==t?D:H(t,"to_i",[]))?i:G(A,"DEFAULT_FUMBLE_VALUE"),G(A,"SRSRollNode").$new(r,s,l,a)},c.$$arity=1),e.def(R,"$parse_srs_roll_without_target_value",f=function(e){var _,t,r,a,s,l,o;return r=this.$eval_modifier(e["$[]"](1)),a=b(l=(_=e["$[]"](2))===D||null==_?D:H(_,"to_i",[]))?l:G(A,"DEFAULT_CRITICAL_VALUE"),s=b(o=(t=e["$[]"](3))===D||null==t?D:H(t,"to_i",[]))?o:G(A,"DEFAULT_FUMBLE_VALUE"),G(A,"SRSRollNode").$new(r,a,s,D)},f.$$arity=1),e.def(R,"$execute_srs_roll",d=function(_){var t,r,a,s,l=this,o=D,i=D;return o=l.randomizer.$roll_barabara(2,6),b(l.sort_add_dice)&&o["$sort!"](),t=o.$sum(),r=o.$join(","),a=function(e,_){return"number"==typeof e&&"number"==typeof _?e+_:e["$+"](_)}(t,_.$modifier()),i=l.$compare_result(_,t,a),s=[["("+_+")",t+"["+r+"]"+G(A,"Format").$modifier(_.$modifier()),a,i.$text()].$compact().$join(" \uff1e ")],H(i,"text=",e.to_a(s)),function(e,_){"number"==typeof e||e["$-"](1)}(s.length),i},d.$$arity=1),void e.def(R,"$compare_result",E=function(e,t,r){return b(_(t,e.$critical_value()))?G(A,"Result").$critical("\u81ea\u52d5\u6210\u529f"):b(function(e,_){return"number"==typeof e&&"number"==typeof _?e<=_:e["$<="](_)}(t,e.$fumble_value()))?G(A,"Result").$fumble("\u81ea\u52d5\u5931\u6557"):b(e.$target_value()["$nil?"]())?G(A,"Result").$new():b(_(r,e.$target_value()))?G(A,"Result").$success("\u6210\u529f"):G(A,"Result").$failure("\u5931\u6557")},E.$$arity=3)},u=[],c=(r=Opal).$$,f=r.module,d=r.klass,r.top.$require("bcdice/game_system/SRS"),a=u,s=$=[f(u[0],"BCDice")].concat(a),l=n=[f($[0],"GameSystem")].concat(s),i=[o=d(n[0],c(n,"SRS"),"FullMetalPanic")].concat(l),r.const_set(i[0],"ID","FullMetalPanic"),r.const_set(i[0],"NAME","\u30d5\u30eb\u30e1\u30bf\u30eb\u30fb\u30d1\u30cb\u30c3\u30af\uff01RPG"),r.const_set(i[0],"SORT_KEY","\u3075\u308b\u3081\u305f\u308b\u306f\u306b\u3064\u304fRPG"),o.$register_prefix("2D6","MG","FP"),o.$set_aliases_for_srs_roll("MG","FP"),r.const_set(i[0],"HELP_MESSAGE",o.$help_message())}}]);