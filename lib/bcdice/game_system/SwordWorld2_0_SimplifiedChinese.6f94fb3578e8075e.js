(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[8196],{30:(pe,ke,ye)=>{ye(3986),Opal.modules["bcdice/arithmetic_evaluator"]=function(e){var H,j,i,l,p,U,A,Q,Y=e.module,G=e.ensure_kwargs,c=e.truthy,K=e.thrower,P=e.def,f=[],F=e.nil,h=e.$$$;return H=f,j=Q=[Y(f[0],"BCDice")].concat(H),A=[U=Y(Q[0],"ArithmeticEvaluator")].concat(j),l=[i=e.get_singleton_class(U)].concat(A),p=e.$r(l),P(i,"$eval",function(C,r){try{K("eval_return");var k,M=F;return null==(k=(r=G(r)).$$smap.round_type)&&(k=h(p("RoundType"),"FLOOR")),c(C)&&c(M=p("Arithmetic").$eval(C,k))?M:0}catch(N){if(N===e.t_eval_return)return N.$v;throw N}},-2)},Opal.modules["i18n/backend/fallbacks"]=function(e){var I,u,r,n,l,p,Y=e.module,G=e.class_variable_set,c=e.truthy,K=e.class_variable_get,P=e.def,f=e.send,F=e.send2,h=e.find_super,z=e.hash2,H=e.find_block_super,E=e.neqeq,Q=e.thrower,V=e.return_val,j=[],U=e.nil,A=e.$$$;return I=j,p=[l=Y(j[0],"I18n")].concat(I),G(p[0],"@@fallbacks",U),u=e.get_singleton_class(l),r=[u].concat(p),n=e.$r(r),P(u,"$fallbacks",function(){var N=U;return G(r[1],"@@fallbacks",c(null!=r[1].$$cvars["@@fallbacks"]?"class variable":U)&&c(N=K(r[1],"@@fallbacks",!1))?N:A(A(n("I18n"),"Locale"),"Fallbacks").$new()),c(N=n("Thread").$current()["$[]"]("i18n_fallbacks"))?N:K(r[1],"@@fallbacks",!1)}),P(u,"$fallbacks=",function(M){var N;return G(r[1],"@@fallbacks",c(M["$is_a?"](n("Array")))?A(A(n("I18n"),"Locale"),"Fallbacks").$new(M):M),N=["i18n_fallbacks",K(r[1],"@@fallbacks",!1)],f(n("Thread").$current(),"[]=",N),N[N.length-1]}),function(u,C){var M,N,R,x,n=[Y(u,"Backend")].concat(C);return M=n,R=[N=Y(n[0],"Fallbacks")].concat(M),x=e.$r(R),P(N,"$translate",function D(w,g,s){try{var d=Q("return"),o=D.$$p||U,T=this,_=U,b=U;return D.$$p=null,null==s&&(s=x("EMPTY_HASH")),c(s.$fetch("fallback",!0))?c(s["$[]"]("fallback_in_progress"))?F(T,h(T,"translate",D,!1,!0),"translate",[w,g,s],o):(c(s["$[]"]("default"))&&(_=T["$extract_non_symbol_default!"](s)),b=s.$merge(z(["fallback_in_progress"],{fallback_in_progress:!0})),f(x("I18n").$fallbacks()["$[]"](w),"each",[],function t(q){var a=null==t.$$s?this:t.$$s;null==q&&(q=U);try{return f(a,"catch",["exception"],function v(){var $=null==v.$$s?this:v.$$s,ee=U;if(ee=F($,H($,"translate",v.$$def||t.$$def||D,!1,!1),"translate",[q,g,b],null),c(ee["$nil?"]()))return U;E(w.$to_s(),q.$to_s())&&$.$on_fallback(w,q,g,s),d.$throw(ee)},{$$s:a,$$ret:d})}catch(v){if(!e.rescue(v,[A(x("I18n"),"InvalidLocale")]))throw v;try{return U}finally{e.pop_exception()}}},{$$s:T}),c(s["$key?"]("default"))&&c(s["$[]"]("default")["$nil?"]())?U:c(_)?F(T,h(T,"translate",D,!1,!0),"translate",[w,U,s.$merge(z(["default"],{default:_}))],null):T.$throw("exception",A(x("I18n"),"MissingTranslation").$new(w,g,s))):F(T,h(T,"translate",D,!1,!0),"translate",[w,g,s],o)}catch(t){if(t===d)return t.$v;throw t}},-3),P(N,"$extract_non_symbol_default!",function(w){var s,g=U;return g=[w["$[]"]("default")].$flatten(),s=f(g,"detect",[],function(o){return null==o&&(o=U),o["$is_a?"](x("Symbol"))["$!"]()}),c(s)&&w["$[]="]("default",g["$[]"](0,g.$index(s))),s}),P(N,"$exists?",function D(w,g,s){try{var d=Q("return"),o=D.$$p||U,T=this;return D.$$p=null,null==s&&(s=x("EMPTY_HASH")),c(s.$fetch("fallback",!0))?(f(x("I18n").$fallbacks()["$[]"](w),"each",[],function _(b){var t=null==_.$$s?this:_.$$s;null==b&&(b=U);try{if(!c(F(t,H(t,"exists?",_.$$def||D,!1,!1),"exists?",[b,g],null)))return U;d.$throw(!0)}catch(q){if(!e.rescue(q,[A(x("I18n"),"InvalidLocale")]))throw q;try{return U}finally{e.pop_exception()}}},{$$s:T,$$ret:d}),!1):F(T,h(T,"exists?",D,!1,!0),"exists?",[w,g,s],o)}catch(_){if(_===d)return _.$v;throw _}},-3),N.$private(),P(N,"$on_fallback",V(U))}(p[0],p)},Opal.modules["bcdice/randomizer"]=function(e){var l,k,M,N,R,x,u,C,G=e.klass,c=e.const_set,K=e.def,P=e.truthy,f=e.rb_gt,F=e.rb_plus,h=e.rb_le,z=e.send,H=e.rb_minus,E=e.eqeq,Q=e.rb_times,V=e.eqeqeq,j=e.rb_ge,U=[],A=e.nil,i=e.$$$;return l=U,u=[(0,e.module)(U[0],"BCDice")].concat(l),C=e.$r(u),k=u,N=[M=G(u[0],null,"Randomizer")].concat(k),R=e.$r(N),(x=M.$$prototype).rand_results=x.detailed_rand_results=A,c(N[0],"UPPER_LIMIT_DICE_TIMES",200),c(N[0],"UPPER_LIMIT_DICE_SIDES",1e4),c(N[0],"UPPER_LIMIT_RANDS",1e4),K(M,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]}),M.$attr_reader("rand_results"),M.$attr_reader("detailed_rand_results"),c(N[0],"DetailedRandResult",R("Struct").$new("kind","sides","value")),K(M,"$roll_barabara",function(w,g){var s=this;return P(f(F(s.rand_results.$size(),w),R("UPPER_LIMIT_RANDS")))&&s.$raise(R("TooManyRandsError")),P(h(w,0))||P(f(w,R("UPPER_LIMIT_DICE_TIMES")))?[]:z(R("Array"),"new",[w],function d(){return(null==d.$$s?this:d.$$s).$roll_once(g)},{$$s:s})}),K(M,"$roll_sum",function(w,g){return this.$roll_barabara(w,g).$sum()}),K(M,"$roll_once",function(w){var s=A;return P(h(w,0))||P(f(w,R("UPPER_LIMIT_DICE_SIDES")))?0:(s=this.$rand_inner(w),this.$push_to_detail("normal",w,s),s)}),K(M,"$roll_index",function(w){return H(this.$roll_once(w),1)}),K(M,"$roll_tens_d10",function(){var s,g=A;return g=this.$rand_inner(10),E(g,10)&&(g=0),s=Q(g,10),this.$push_to_detail("tens_d10",10,s),s}),K(M,"$roll_d9",function(){var g;return g=H(this.$rand_inner(10),1),this.$push_to_detail("d9",10,g),g}),K(M,"$roll_d66",function(w){var d,s=A;return s=z(R("Array"),"new",[2],function o(){return(null==o.$$s?this:o.$$s).$roll_once(6)},{$$s:this}),V(i(R("D66SortType"),"ASC"),d=w)?s["$sort!"]():V(i(R("D66SortType"),"DESC"),d)&&s["$sort!"]()["$reverse!"](),F(Q(s["$[]"](0),10),s["$[]"](1))}),M.$private(),K(M,"$rand_inner",function(w){var s,g=this;return P(j(g.rand_results.$size(),R("UPPER_LIMIT_RANDS")))&&g.$raise(R("TooManyRandsError")),s=g.$random(w),g.rand_results["$<<"]([s,w]),s}),K(M,"$random",function(w){return F(R("Kernel").$rand(w),1)}),K(M,"$push_to_detail",function(w,g,s){var o;return o=R("DetailedRandResult").$new(w,g,s),this.detailed_rand_results.$push(o)}),G(u[0],C("StandardError"),"TooManyRandsError"),A},Opal.modules["bcdice/dice_table/roll_result"]=function(e){var z,V,I,l,p,u,C,U,E,Y=e.module,G=e.klass,c=e.def,K=e.truthy,P=e.return_val,f=[],F=e.nil;return z=f,V=E=[Y(f[0],"BCDice")].concat(z),I=U=[Y(E[0],"DiceTable")].concat(V),p=[l=G(U[0],null,"RollResult")].concat(I),u=e.$r(p),(C=l.$$prototype).table_name=C.value=C.body=F,c(l,"$initialize",function(n,k,M){var N=this;return N.table_name=n,N.value=k,N.body=M}),l.$attr_reader("table_name"),l.$attr_reader("value"),l.$attr_reader("body"),c(l,"$to_s",function(){var n=this;return n.table_name+"("+n.value+") \uff1e "+n.body}),c(l,"$last_body",function(){var n=this;return K(n.body["$is_a?"](u("RollResult")))?n.body.$last_body():n.body}),c(l,"$empty?",P(!1))},Opal.modules["bcdice/dice_table/chain_table"]=function(e){var z,V,I,l,p,u,C,U,E,Y=e.module,G=e.klass,c=e.truthy,K=e.def,P=e.rb_minus,f=[],F=e.nil;return z=f,V=E=[Y(f[0],"BCDice")].concat(z),I=U=[Y(E[0],"DiceTable")].concat(V),p=[l=G(U[0],null,"ChainTable")].concat(I),u=e.$r(p),(C=l.$$prototype).times=C.sides=C.items=C.name=F,K(l,"$initialize",function(n,k,M){var N=this,R=F;return N.name=n,N.items=M.$freeze(),R=/(\d+)D(\d+)/i.$match(k),c(R)||N.$raise(u("ArgumentError"),"Unexpected table type: "+k),N.times=R["$[]"](1).$to_i(),N.sides=R["$[]"](2).$to_i()}),K(l,"$roll",function(n){var M,N,k=this,R=F;return M=n.$roll_sum(k.times,k.sides),N=P(M,k.times),R=k.items["$[]"](N),c(R["$respond_to?"]("roll"))&&(R=R.$roll(n)),u("RollResult").$new(k.name,M,R)})},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(e){var Q,A,u,C,r,n,k,I,j,Y=e.module,G=e.klass,c=e.hash2,K=e.defs,P=e.def,f=e.rb_plus,F=e.rb_times,h=e.rb_minus,z=[],H=e.nil;return Q=z,A=j=[Y(z[0],"BCDice")].concat(Q),u=I=[Y(j[0],"DiceTable")].concat(A),r=[C=G(I[0],null,"D66GridTable")].concat(u),n=e.$r(r),(k=C.$$prototype).name=k.items=H,K(C,"$from_i18n",function(N,R){var D=H;return D=n("I18n").$t(N,c(["locale","raise"],{locale:R,raise:!0})),this.$new(D["$[]"]("name"),D["$[]"]("items"))}),P(C,"$initialize",function(N,R){return this.name=N,this.items=R.$freeze()}),P(C,"$roll",function(N){var x,D,w,g,s;return x=N.$roll_once(6),D=N.$roll_once(6),w=f(F(x,10),D),g=h(x,1),s=h(D,1),n("RollResult").$new(this.name,w,this.items["$[]"](g)["$[]"](s))})},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(e){var H,j,p,u,C,r,A,i,Q,Y=e.module,G=e.klass,c=e.hash2,K=e.defs,P=e.def,F=[],h=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),H=F,j=Q=[Y(F[0],"BCDice")].concat(H),A=[Y(Q[0],"DiceTable")].concat(j),i=e.$r(A),p=A,C=[u=G(A[0],i("D66GridTable"),"D66HalfGridTable")].concat(p),r=e.$r(C),K(u,"$from_i18n",function(k,M){var R=h;return R=r("I18n").$t(k,c(["locale","raise"],{locale:M,raise:!0})),this.$new(R["$[]"]("name"),R["$[]"]("items_1_2_3"),R["$[]"]("items_4_5_6"))}),P(u,"$initialize",function(k,M,N){return this.name=k,this.items=[M,M,M,N,N,N].$freeze()})},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(e){var H,j,p,u,C,r,A,i,Q,Y=e.module,G=e.klass,c=e.hash2,K=e.defs,P=e.def,F=[],h=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),H=F,j=Q=[Y(F[0],"BCDice")].concat(H),A=[Y(Q[0],"DiceTable")].concat(j),i=e.$r(A),p=A,C=[u=G(A[0],i("D66GridTable"),"D66OneThirdTable")].concat(p),r=e.$r(C),K(u,"$from_i18n",function(k,M){var R=h;return R=r("I18n").$t(k,c(["locale","raise"],{locale:M,raise:!0})),this.$new(R["$[]"]("name"),R["$[]"]("items_1_2"),R["$[]"]("items_3_4"),R["$[]"]("items_5_6"))}),P(u,"$initialize",function(k,M,N,R){return this.name=k,this.items=[M,M,N,N,R,R].$freeze()})},Opal.modules["bcdice/dice_table/d66_table"]=function(e){var j,I,r,n,k,M,N,p,A,Y=e.module,G=e.klass,c=e.hash2,K=e.defs,P=e.def,f=e.eqeqeq,F=e.rb_plus,h=e.rb_times,z=e.truthy,H=[],E=e.nil,Q=e.$$$;return j=H,I=A=[Y(H[0],"BCDice")].concat(j),r=p=[Y(A[0],"DiceTable")].concat(I),k=[n=G(p[0],null,"D66Table")].concat(r),M=e.$r(k),(N=n.$$prototype).sort_type=N.items=N.name=E,K(n,"$from_i18n",function(x,D){var s,g=E;return g=M("I18n").$t(x,c(["locale"],{locale:D})),s=M("D66SortType").$const_get(g["$[]"]("d66_sort_type")),this.$new(g["$[]"]("name"),s,g["$[]"]("items"))}),P(n,"$initialize",function(x,D,w){var g=this;return g.name=x,g.sort_type=D,g.items=w.$freeze()}),P(n,"$roll",function(x){var D=this,w=E,g=E,s=E,d=E;return w=x.$roll_barabara(2,6),f(Q(M("D66SortType"),"ASC"),g=D.sort_type)?w["$sort!"]():f(Q(M("D66SortType"),"DESC"),g)&&w["$sort!"]()["$reverse!"](),s=F(h(w["$[]"](0),10),w["$[]"](1)),d=z(g=D.items["$[]"](s))?g:D.items["$[]"](s.$to_s()),z(d["$respond_to?"]("roll"))&&(d=d.$roll(x)),M("RollResult").$new(D.name,s,d)}),P(n,"$choice",function(x){return M("RollResult").$new(this.name,x,this.items["$[]"](x))})},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(e){var U,l,u,C,i,Y=e.module,G=e.klass,c=e.hash2,K=e.send,P=e.to_ary,f=e.rb_plus,F=e.rb_times,h=e.send2,z=e.find_super,H=e.def,Q=[],V=e.nil;return e.top.$require("bcdice/dice_table/d66_table"),U=Q,l=i=[Y(Q[0],"BCDice")].concat(U),u=[Y(i[0],"DiceTable")].concat(l),C=e.$r(u),H(G(u[0],C("D66Table"),"D66LeftRangeTable"),"$initialize",function M(N,R,x){var g;return M.$$p=null,g=c([],{}),K(x,"each",[],function(d){var o,b;return null==d&&(d=V),o=P(d),b=null==o[1]?V:o[1],K(null==o[0]?V:o[0],"each",[],function(q){return null==q&&(q=V),K(b,"each_with_index",[],function(v,$){var ee,te;return null==v&&(v=V),null==$&&($=V),te=f(F(q,10),f($,1)),K(g,"[]=",ee=[te,v]),ee[ee.length-1]})})}),h(this,z(this,"initialize",M,!1,!0),"initialize",[N,R,g],null)})},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(e){var V,i,C,r,n,k,M,l,U,Y=e.module,G=e.klass,c=e.hash2,K=e.defs,P=e.def,f=e.truthy,F=e.rb_minus,h=e.rb_plus,z=e.rb_times,H=[],E=e.nil;return V=H,i=U=[Y(H[0],"BCDice")].concat(V),C=l=[Y(U[0],"DiceTable")].concat(i),n=[r=G(l[0],null,"D66ParityTable")].concat(C),k=e.$r(n),(M=r.$$prototype).odd=M.even=M.name=E,K(r,"$from_i18n",function(R,x){var w=E;return w=k("I18n").$t(R,c(["locale","raise"],{locale:x,raise:!0})),this.$new(w["$[]"]("name"),w["$[]"]("odd"),w["$[]"]("even"))}),P(r,"$initialize",function(R,x,D){var w=this;return w.name=R,w.odd=x.$freeze(),w.even=D.$freeze()}),P(r,"$roll",function(R){var w,s,d,x=this,D=E;return D=R.$roll_once(6),w=R.$roll_once(6),s=(f(D["$odd?"]())?x.odd:x.even)["$[]"](F(w,1)),d=h(z(D,10),w),k("RollResult").$new(x.name,d,s)})},Opal.modules["bcdice/dice_table/d66_range_table"]=function(e){var H,j,l,p,u,C,r,A,Q,Y=e.module,G=e.klass,c=e.def,K=e.rb_plus,P=e.rb_times,f=e.send,F=[],h=e.nil;return H=F,j=Q=[Y(F[0],"BCDice")].concat(H),l=A=[Y(Q[0],"DiceTable")].concat(j),u=[p=G(A[0],null,"D66RangeTable")].concat(l),C=e.$r(u),(r=p.$$prototype).items=r.name=h,c(p,"$initialize",function(k,M){return this.name=k,this.items=M.$freeze()}),c(p,"$roll",function(k){var N,R,x,D=h;return N=k.$roll_once(6),R=k.$roll_once(6),x=K(P(N,10),R),D=f(this.items,"find",[],function(g){return null==g&&(g=h),g["$[]"](0)["$include?"](x)}),C("RollResult").$new(this.name,x,D["$[]"](1))})},Opal.modules["bcdice/dice_table/range_table"]=function(e){var V,i,C,r,n,k,M,l,U,Y=e.module,G=e.klass,c=e.const_set,K=e.send,P=e.truthy,f=e.def,F=e.eqeqeq,h=e.rb_times,z=e.rb_plus,H=[],E=e.nil;return V=H,i=U=[Y(H[0],"BCDice")].concat(V),C=l=[Y(U[0],"DiceTable")].concat(i),n=[r=G(l[0],null,"RangeTable")].concat(C),k=e.$r(n),(M=r.$$prototype).name=M.items=M.num_of_dice=M.num_of_sides=M.formatter=E,c(n[0],"RollResult",K(k("Struct"),"new",["sum","values","content","formatted"],function N(){return(null==N.$$s?this:N.$$s).$alias_method("to_s","formatted")},{$$s:r})),c(n[0],"Item",k("Struct").$new("range","content")),c(n[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),c(n[0],"DEFAULT_FORMATTER",K(r,"lambda",[],function(R,x){return null==R&&(R=E),null==x&&(x=E),R.$name()+"("+x.$sum()+") \uff1e "+x.$content()})),r.$attr_reader("name"),r.$attr_reader("num_of_dice"),r.$attr_reader("num_of_sides"),f(r,"$initialize",function N(R,x,D){var s,w=N.$$p||E,g=this,d=E;return N.$$p=null,g.name=R.$freeze(),g.formatter=P(s=w)?s:k("DEFAULT_FORMATTER"),d=k("DICE_ROLL_METHOD_RE").$match(x),P(d)||g.$raise(k("ArgumentError"),g.name+": invalid dice roll method: "+x),g.num_of_dice=d["$[]"](1).$to_i(),g.num_of_sides=d["$[]"](2).$to_i(),g.$store(D)}),f(r,"$fetch",function(R){var D,x=this;return D=K(x.items,"find",[],function(g){return null==g&&(g=E),g.$range()["$include?"](R)}),P(D)||x.$raise(k("RangeError"),x.name+": value is out of range: "+R),D}),f(r,"$roll",function(R){var w,x=this,D=E,g=E;return w=(D=R.$roll_barabara(x.num_of_dice,x.num_of_sides)).$sum(),(g=k("RollResult").$new(w,D,x.$fetch(w).$content()))["$formatted="](x.formatter["$[]"](x,g)),g}),r.$private(),f(r,"$store",function(R){var D,w,x=this;return D=K(R,"map",[],function g(s,d){return null==s&&(s=E),null==d&&(d=E),[(null==g.$$s?this:g.$$s).$coerce_to_int_range(s),d]},{$$s:x}),w=K(D,"sort_by",[],function(s,d){return null==s&&(s=E),null==d&&(d=E),s.$min()}),x.$assert_min_sum_is_covered(w),x.$assert_max_sum_is_covered(w),x.$assert_no_gap_or_overlap_in_ranges(w),x.items=K(w,"map",[],function(s,d){return null==s&&(s=E),null==d&&(d=E),k("Item").$new(s,d.$freeze()).$freeze()}).$freeze(),x}),f(r,"$coerce_to_int_range",function(R){var D;return F(k("Integer"),D=R)?k("Range").$new(R,R):F(k("Range"),D)&&P(R.$begin()["$is_a?"](k("Integer")))&&P(R.$end()["$is_a?"](k("Integer")))?R:this.$raise(k("TypeError"),this.name+": "+R+" ("+R.$class()+") must be an Integer or a Range with Integers ")}),f(r,"$assert_min_sum_is_covered",function(R){var D,x=this,w=E;return D=x.num_of_dice,w=R.$first()["$[]"](0),P(w["$include?"](D))||x.$raise(k("RangeError"),x.name+": min value ("+D+") is not covered: "+w),x}),f(r,"$assert_max_sum_is_covered",function(R){var D,x=this,w=E;return D=h(x.num_of_dice,x.num_of_sides),w=R.$last()["$[]"](0),P(w["$include?"](D))||x.$raise(k("RangeError"),x.name+": max value ("+D+") is not covered: "+w),x}),f(r,"$assert_no_gap_or_overlap_in_ranges",function(R){return K(R,"each_cons",[2],function D(w,g){var T,_,s=null==D.$$s?this:D.$$s,d=E,o=E;return null==s.name&&(s.name=E),null==w&&(w=E),null==g&&(g=E),d=w["$[]"](0),o=g["$[]"](0),T=d.$max(),_=z(T,1),P(o["$include?"](T))&&s.$raise(k("RangeError"),s.name+": Range overlap: "+d+" and "+o),P(o["$include?"](_))?E:s.$raise(k("RangeError"),s.name+": Range gap: "+d+" and "+o)},{$$s:this}),this})},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(e){var E,U,p,k,M,N,R,C,i,V,Y=e.module,G=e.klass,c=e.send,K=e.def,P=e.rb_minus,f=e.return_ivar,F=[],h=e.nil,z=e.$$$;return E=F,U=V=[Y(F[0],"BCDice")].concat(E),p=i=[Y(V[0],"DiceTable")].concat(U),k=C=[G(i[0],null,"SaiFicSkillTable")].concat(p),N=[M=G(C[0],null,"Category")].concat(k),R=e.$r(N),K(M,"$initialize",function(D,w,g,s){var d=this;return d.name=D,d.skills=c(w.$map(),"with_index",[2],function(T,_){return null==T&&(T=h),null==_&&(_=h),z(R("SaiFicSkillTable"),"Skill").$new(D,T,g,_,s)}),d.dice=g}),K(M,"$roll",function(D){return this.$skills()["$[]"](P(D.$roll_sum(2,6),2))}),K(M,"$to_s",f("name")),M.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(e){var h,Q,i,C,r,l,j,H,Y=e.module,G=e.klass,c=e.def,K=e.hash2,P=[],f=e.nil;return h=P,Q=H=[Y(P[0],"BCDice")].concat(h),i=j=[Y(H[0],"DiceTable")].concat(Q),l=[G(j[0],null,"SaiFicSkillTable")].concat(i),(r=(C=G(l[0],null,"Skill")).$$prototype).s_format=r.category_dice=r.row_dice=r.category_name=r.name=f,c(C,"$initialize",function(k,M,N,R,x){var D=this;return D.category_name=k,D.name=M,D.category_dice=N,D.row_dice=R,D.s_format=x}),c(C,"$to_s",function(){var k=this;return k.$format(k.s_format,K(["category_dice","row_dice","category_name","skill_name"],{category_dice:k.category_dice,row_dice:k.row_dice,category_name:k.category_name,skill_name:k.name}))}),C.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(e){var l,r,R,x,D,w,g,k,u,Y=e.module,G=e.klass,c=e.ensure_kwargs,K=e.hash2,P=e.send,F=e.defs,h=e.const_set,z=e.to_ary,H=e.def,E=e.truthy,Q=e.rb_minus,V=e.rb_plus,j=e.top,U=[],A=e.nil,i=e.$$$;return j.$require("bcdice/dice_table/sai_fic_skill_table/category"),j.$require("bcdice/dice_table/sai_fic_skill_table/skill"),l=U,r=u=[Y(U[0],"BCDice")].concat(l),R=k=[Y(u[0],"DiceTable")].concat(r),D=[x=G(k[0],null,"SaiFicSkillTable")].concat(R),w=e.$r(D),(g=x.$$prototype).rtt=g.rtt_format=g.rct=g.rct_format=g.rttn=g.rttn_format=g.categories=A,F(x,"$from_i18n",function(d,o,T){var _,b,t,$,v=A;return null==(_=(T=c(T)).$$smap.rtt)&&(_=A),null==(b=T.$$smap.rct)&&(b=A),null==(t=T.$$smap.rttn)&&(t=A),$=(v=w("I18n").$t("RTT",K(["locale","raise","default"],{locale:o,raise:!1,default:K([],{})})).$merge(w("I18n").$t(d,K(["locale","raise"],{locale:o,raise:!0}))))["$[]"]("items"),v=P(v,"select",[],function(te,re){return null==te&&(te=A),null==re&&(re=A),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](te)}),this.$new($,e.to_hash(v).$merge(K(["rtt","rct","rttn"],{rtt:_,rct:b,rttn:t})))},-3),h(D[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),h(D[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),h(D[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),h(D[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),H(x,"$initialize",function(d,o){var T,_,b,t,q,a,v,$=this;return null==(T=(o=c(o)).$$smap.rtt)&&(T=A),null==(_=o.$$smap.rct)&&(_=A),null==(b=o.$$smap.rttn)&&(b=A),null==(t=o.$$smap.rtt_format)&&(t=w("DEFAULT_RTT")),null==(q=o.$$smap.rct_format)&&(q=w("DEFAULT_RCT")),null==(a=o.$$smap.rttn_format)&&(a=w("DEFAULT_RTTN")),null==(v=o.$$smap.s_format)&&(v=w("DEFAULT_S")),$.categories=P(d.$map(),"with_index",[1],function(te,re){var $e,le,ae;return null==te&&(te=A),null==re&&(re=A),le=null==($e=z(te))[0]?A:$e[0],ae=null==$e[1]?A:$e[1],i(w("SaiFicSkillTable"),"Category").$new(le,ae,re,v)},{$$has_top_level_mlhs_arg:!0}),$.rtt=T,$.rct=_,$.rttn=b.$to_a(),$.rtt_format=t,$.rct_format=q,$.rttn_format=a},-2),h(D[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),x.$attr_reader("categories"),H(x,"$roll_command",function(d,o){var _,T=this,b=A,t=A;return E(["RTT",T.rtt]["$include?"](_=o))?T.$format_skill(T.rtt_format,T.$roll_skill(d)):E(["RCT",T.rct]["$include?"](_))?(b=T.$roll_category(d),T.$format(T.rct_format,K(["category_dice","category_name"],{category_dice:b.$dice(),category_name:b.$name()}))):E(t=w("RTTN").$index(_))||E(t=T.rttn.$index(_))?T.$format_skill(T.rttn_format,T.categories["$[]"](t).$roll(d)):A}),H(x,"$roll_category",function(d){return this.categories["$[]"](Q(d.$roll_once(6),1))}),H(x,"$roll_skill",function(d){return this.$roll_category(d).$roll(d)}),H(x,"$prefixes",function(){var d=this;return V(["RTT[1-6]?","RCT",d.rtt,d.rct],d.rttn).$compact()}),x.$private(),H(x,"$format_skill",function(d,o){return this.$format(d,K(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:o.$category_dice(),row_dice:o.$row_dice(),category_name:o.$category_name(),skill_name:o.$name(),text:o.$to_s()}))})},Opal.modules["bcdice/dice_table/table"]=function(e){var E,U,p,u,C,r,n,i,V,Y=e.module,G=e.klass,c=e.hash2,K=e.defs,P=e.truthy,f=e.def,F=e.rb_minus,h=[],z=e.nil;return E=h,U=V=[Y(h[0],"BCDice")].concat(E),p=i=[Y(V[0],"DiceTable")].concat(U),C=[u=G(i[0],null,"Table")].concat(p),r=e.$r(C),(n=u.$$prototype).times=n.sides=n.name=n.items=z,K(u,"$from_i18n",function(M,N){var x=z;return x=r("I18n").$t(M,c(["locale"],{locale:N})),this.$new(x["$[]"]("name"),x["$[]"]("type"),x["$[]"]("items"))}),f(u,"$initialize",function(M,N,R){var x=this,D=z;return x.name=M,x.items=R.$freeze(),D=/(\d+)D(\d+)/i.$match(N),P(D)||x.$raise(r("ArgumentError"),"Unexpected table type: "+N),x.times=D["$[]"](1).$to_i(),x.sides=D["$[]"](2).$to_i()}),f(u,"$roll",function(M){var R,N=this;return R=M.$roll_sum(N.times,N.sides),N.$choice(R)}),f(u,"$choice",function(M){var R,N=this;return R=F(M,N.times),r("RollResult").$new(N.name,M,N.items["$[]"](R))})},Opal.modules["bcdice/dice_table"]=function(e){var Y=e.top;return Y.$require("bcdice/dice_table/roll_result"),Y.$require("bcdice/dice_table/chain_table"),Y.$require("bcdice/dice_table/d66_grid_table"),Y.$require("bcdice/dice_table/d66_half_grid_table"),Y.$require("bcdice/dice_table/d66_one_third_table"),Y.$require("bcdice/dice_table/d66_left_range_table"),Y.$require("bcdice/dice_table/d66_parity_table"),Y.$require("bcdice/dice_table/d66_range_table"),Y.$require("bcdice/dice_table/d66_table"),Y.$require("bcdice/dice_table/range_table"),Y.$require("bcdice/dice_table/sai_fic_skill_table"),Y.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(e){var f,H,Q,h,Y=e.module,G=e.const_set,c=[];return f=c,H=h=[Y(c[0],"BCDice")].concat(f),Q=[Y(h[0],"D66SortType")].concat(H),G(Q[0],"NO_SORT","no_sort"),G(Q[0],"ASC","asc"),G(Q[0],"DESC","desc"),function(z,H){var Q=[Y(z,"RoundType")].concat(H);return G(Q[0],"CEIL","ceil"),G(Q[0],"FLOOR","floor"),G(Q[0],"ROUND","round")}(h[0],h)},Opal.modules["bcdice/translate"]=function(e){var H,j,U,A,i,Q,Y=e.module,G=e.ensure_kwargs,c=e.kwrestargs,P=e.hash2,f=e.def,F=[],h=e.nil;return H=F,j=Q=[Y(F[0],"BCDice")].concat(H),A=[U=Y(Q[0],"Translate")].concat(j),i=e.$r(A),f(U,"$translate",function(l,p){var u,C=this;return null==C.locale&&(C.locale=h),p=G(p),u=c(p,{}),i("I18n").$translate(l,P(["locale","raise"],{locale:C.locale,raise:!0}).$merge(e.to_hash(u)))},-2)},Opal.modules["bcdice/result"]=function(e){var U,I,A,H,Q,G=e.klass,c=e.send,K=e.def,P=e.return_val,f=e.return_ivar,F=[],h=e.nil;return H=F,U=Q=[(0,e.module)(F[0],"BCDice")].concat(H),[A=G(Q[0],null,"Result")].concat(U),K(I=e.get_singleton_class(A),"$success",function(u){return c(this.$new(),"tap",[],function(n){var k;return null==n&&(n=h),n["$text="](u),c(n,"success=",k=[!0]),k[k.length-1]})}),K(I,"$failure",function(u){return c(this.$new(),"tap",[],function(n){var k;return null==n&&(n=h),n["$text="](u),c(n,"failure=",k=[!0]),k[k.length-1]})}),K(I,"$critical",function(u){return c(this.$new(),"tap",[],function(n){var k;return null==n&&(n=h),n["$text="](u),n["$critical="](!0),c(n,"success=",k=[!0]),k[k.length-1]})}),K(I,"$fumble",function(u){return c(this.$new(),"tap",[],function(n){var k;return null==n&&(n=h),n["$text="](u),n["$fumble="](!0),c(n,"failure=",k=[!0]),k[k.length-1]})}),K(I,"$nothing",P("nothing")),K(A,"$initialize",function(l){var p=this;return null==l&&(l=h),p.text=l,p.rands=h,p.detailed_rands=h,p.secret=!1,p.success=!1,p.failure=!1,p.critical=!1,p.fumble=!1},-1),A.$attr_accessor("text","rands","detailed_rands"),A.$attr_writer("secret","success","failure","critical","fumble"),K(A,"$secret?",f("secret")),K(A,"$success?",f("success")),K(A,"$failure?",f("failure")),K(A,"$critical?",f("critical")),K(A,"$fumble?",f("fumble")),K(A,"$condition=",function(l){return this.success=l,this.failure=l["$!"]()})},Opal.modules["racc/parser"]=function(e){var M,R,x,Y=e.module,G=e.klass,c=e.truthy,K=e.const_set,P=e.defs,f=e.gvars,F=e.rb_lt,h=e.def,z=e.to_ary,H=e.send,E=e.neqeq,Q=e.rb_plus,V=e.eqeq,j=e.rb_ge,U=e.rb_gt,A=e.rb_minus,i=e.rb_le,I=e.rb_times,l=e.assign_ivar_val,u=[],C=e.$r(u),r=e.nil,n=e.$$$;return M=u,R=[Y(u[0],"Racc")].concat(M),x=e.$r(R),G(R[0],x("StandardError"),"ParseError"),c(n("::","ParseError","skip_raise")?"constant":r)||K(u[0],"ParseError",n(C("Racc"),"ParseError")),function(k,M){var s,d,o,T,_,x=[Y(k,"Racc")].concat(M),D=e.$r(x);return c(D("Racc_No_Extensions","skip_raise")?"constant":r)||K(x[0],"Racc_No_Extensions",!1),s=x,o=[d=G(x[0],null,"Parser")].concat(s),T=e.$r(o),(_=d.$$prototype).yydebug=_.racc_debug_out=_.racc_error_status=_.racc_t=_.racc_vstack=_.racc_val=_.racc_state=_.racc_tstack=r,K(o[0],"Racc_Runtime_Version","1.4.6"),K(o[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),K(o[0],"Racc_Runtime_Core_Version_R","1.4.6"),K(o[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),K(o[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),K(o[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),K(o[0],"Racc_Runtime_Core_Version",T("Racc_Runtime_Core_Version_R")),K(o[0],"Racc_Runtime_Core_Revision",T("Racc_Runtime_Core_Revision_R")),K(o[0],"Racc_Runtime_Type","ruby"),P(T("Parser"),"$racc_runtime_type",function(){return T("Racc_Runtime_Type")}),h(d,"$_racc_setup",function(){var t,q,a=this,v=r,$=r;return null==f.stderr&&(f.stderr=r),c(n(a.$class(),"Racc_debug_parser"))||(a.yydebug=!1),c(null!=(t=a.yydebug)&&t!==r?"instance-variable":r)||(a.yydebug=!1),c(a.yydebug)&&(c(null!=(q=a.racc_debug_out)&&q!==r?"instance-variable":r)||(a.racc_debug_out=f.stderr),a.racc_debug_out=c(v=a.racc_debug_out)?v:f.stderr),$=n(a.$class(),"Racc_arg"),c(F($.$size(),14))&&$["$[]="](13,!0),$}),h(d,"$_racc_init_sysvars",function(){var t=this;return t.racc_state=[0],t.racc_tstack=[],t.racc_vstack=[],t.racc_t=r,t.racc_val=r,t.racc_read_next=!0,t.racc_user_yyerror=!1,t.racc_error_status=0}),h(d,"$do_parse",function(){return this.$__send__(T("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),h(d,"$next_token",function(){return this.$raise(T("NotImplementedError"),this.$class()+"#next_token is not defined")}),h(d,"$_racc_do_parse_rb",function(t,q){var a,$=this,ee=r,te=r,re=r,$e=r,le=r,ae=r,se=r,ue=r;return a=z(t),ee=null==a[0]?r:a[0],te=null==a[1]?r:a[1],re=null==a[2]?r:a[2],$e=null==a[3]?r:a[3],le=null==a[10]?r:a[10],$.$_racc_init_sysvars(),ae=se=ue=r,H($,"catch",["racc_end_parse"],function J(){var B,Z,y=null==J.$$s?this:J.$$s,S=r;for(null==y.racc_state&&(y.racc_state=r),null==y.racc_read_next&&(y.racc_read_next=r),null==y.racc_t&&(y.racc_t=r),null==y.yydebug&&(y.yydebug=r),null==y.racc_val&&(y.racc_val=r);c(!0);)for(c(ue=$e["$[]"](y.racc_state["$[]"](-1)))?(c(y.racc_read_next)&&E(y.racc_t,0)&&(Z=y.$next_token(),B=z(Z),ae=null==B[0]?r:B[0],y.racc_val=null==B[1]?r:B[1],y.racc_t=c(ae)?c(S=le["$[]"](ae))?S:1:0,c(y.yydebug)&&y.$racc_read_token(y.racc_t,ae,y.racc_val),y.racc_read_next=!1),ue=Q(ue,y.racc_t),c(j(ue,0))&&c(se=ee["$[]"](ue))&&V(te["$[]"](ue),y.racc_state["$[]"](-1))||(se=re["$[]"](y.racc_state["$[]"](-1)))):se=re["$[]"](y.racc_state["$[]"](-1));c(se=y.$_racc_evalact(se,t)););},{$$s:$})}),h(d,"$yyparse",function(t,q){return this.$__send__(T("Racc_YY_Parse_Method"),t,q,this.$_racc_setup(),!0)}),h(d,"$_racc_yyparse_rb",function(t,q,a,v){var $,re=r,$e=r,_e=r,le=r,se=r,ue=r,J=r;return $=z(a),re=null==$[0]?r:$[0],$e=null==$[1]?r:$[1],_e=null==$[2]?r:$[2],le=null==$[3]?r:$[3],se=null==$[10]?r:$[10],this.$_racc_init_sysvars(),ue=r,J=r,H(this,"catch",["racc_end_parse"],function B(){var Z=null==B.$$s?this:B.$$s;for(null==Z.racc_state&&(Z.racc_state=r);!c(J=le["$[]"](Z.racc_state["$[]"](-1)));)for(;c(ue=Z.$_racc_evalact(_e["$[]"](Z.racc_state["$[]"](-1)),a)););return H(t,"__send__",[q],function y(S,O){var m=null==y.$$s?this:y.$$s,L=r,X=r;for(null==m.racc_t&&(m.racc_t=r),null==m.racc_state&&(m.racc_state=r),null==m.racc_read_next&&(m.racc_read_next=r),null==S&&(S=r),null==O&&(O=r),m.racc_t=c(S)?c(L=se["$[]"](S))?L:1:0,m.racc_val=O,m.racc_read_next=!1,J=Q(J,m.racc_t),c(j(J,0))&&c(ue=re["$[]"](J))&&V($e["$[]"](J),m.racc_state["$[]"](-1))||(ue=_e["$[]"](m.racc_state["$[]"](-1)));c(ue=m.$_racc_evalact(ue,a)););for(;c(c(L=c(X=(J=le["$[]"](m.racc_state["$[]"](-1)))["$!"]())?X:m.racc_read_next["$!"]())?L:m.racc_t["$=="](0));)for(c(J)&&c(J=Q(J,m.racc_t))&&c(j(J,0))&&c(ue=re["$[]"](J))&&V($e["$[]"](J),m.racc_state["$[]"](-1))||(ue=_e["$[]"](m.racc_state["$[]"](-1)));c(ue=m.$_racc_evalact(ue,a)););},{$$s:Z})},{$$s:this})}),h(d,"$_racc_evalact",function(t,q){var a,_e,$=this,ee=r,te=r,$e=r,le=r,ae=r,se=r;if(ee=null==(a=z(q))[0]?r:a[0],te=null==a[1]?r:a[1],$e=null==a[3]?r:a[3],_e=null==a[11]?r:a[11],le=null==a[12]?r:a[12],c(U(t,0))&&c(F(t,_e)))c(U($.racc_error_status,0))&&(V($.racc_t,1)||($.racc_error_status=A($.racc_error_status,1))),$.racc_vstack.$push($.racc_val),$.racc_state.$push(t),$.racc_read_next=!0,c($.yydebug)&&($.racc_tstack.$push($.racc_t),$.$racc_shift($.racc_t,$.racc_tstack,$.racc_vstack));else if(c(F(t,0))&&c(U(t,le["$-@"]()))){if(ae=H($,"catch",["racc_jump"],function ue(){var J=null==ue.$$s?this:ue.$$s;return null==J.racc_state&&(J.racc_state=r),J.racc_state.$push(J.$_racc_do_reduce(q,t)),!1},{$$s:$}),c(ae))switch(ae){case 1:return $.racc_user_yyerror=!0,le["$-@"]();case 2:return _e;default:$.$raise("[Racc Bug] unknown jump code")}}else if(V(t,_e))c($.yydebug)&&$.$racc_accept(),$.$throw("racc_end_parse",$.racc_vstack["$[]"](0));else{if(V(t,le["$-@"]())){switch($.racc_error_status){case 0:c(q["$[]"](21))||$.$on_error($.racc_t,$.racc_val,$.racc_vstack);break;case 3:V($.racc_t,0)&&$.$throw("racc_end_parse",r),$.racc_read_next=!0}for($.racc_user_yyerror=!1,$.racc_error_status=3;c(!0)&&!(c(se=$e["$[]"]($.racc_state["$[]"](-1)))&&(se=Q(se,1),c(j(se,0))&&c(t=ee["$[]"](se))&&V(te["$[]"](se),$.racc_state["$[]"](-1))));)c(i($.racc_state.$size(),1))&&$.$throw("racc_end_parse",r),$.racc_state.$pop(),$.racc_vstack.$pop(),c($.yydebug)&&($.racc_tstack.$pop(),$.$racc_e_pop($.racc_state,$.racc_tstack,$.racc_vstack));return t}$.$raise("[Racc Bug] unknown action "+t.$inspect())}return c($.yydebug)&&$.$racc_next_state($.racc_state["$[]"](-1),$.racc_state),r}),h(d,"$_racc_do_reduce",function(t,q){var a,le,se,S,O,m,W,$=this,te=r,re=r,$e=r,_e=r,ae=r,ue=r,J=r,B=r,Z=r,y=r,L=r,X=r,ne=r;return te=null==(a=z(t))[4]?r:a[4],re=null==a[5]?r:a[5],$e=null==a[6]?r:a[6],_e=null==a[7]?r:a[7],le=null==a[8]?r:a[8],ae=null==a[9]?r:a[9],se=null==a[13]?r:a[13],ue=$.racc_state,J=$.racc_vstack,B=$.racc_tstack,Z=I(q,-3),y=ae["$[]"](Z),S=ae["$[]"](Q(Z,1)),O=ae["$[]"](Q(Z,2)),m=[],c($.yydebug)&&(L=B["$[]"](y["$-@"](),y)),X=J["$[]"](y["$-@"](),y),c($.yydebug)&&B["$[]="](y["$-@"](),y,m),J["$[]="](y["$-@"](),y,m),ue["$[]="](y["$-@"](),y,m),c(se)?J.$push($.$__send__(O,X,J,X["$[]"](0))):J.$push($.$__send__(O,X,J)),B.$push(S),c($.yydebug)&&$.$racc_reduce(L,S,B,J),W=A(S,le),c(Z=_e["$[]"](W))&&(Z=Q(Z,ue["$[]"](-1)),c(j(Z,0))&&c(ne=te["$[]"](Z))&&V(re["$[]"](Z),W))?ne:$e["$[]"](W)}),h(d,"$on_error",function(t,q,a){var $,v=this;return v.$raise(T("ParseError"),v.$sprintf("\nparse error on value %s (%s)",q.$inspect(),c($=v.$token_to_str(t))?$:"?"))}),h(d,"$yyerror",function(){return this.$throw("racc_jump",1)}),h(d,"$yyaccept",function(){return this.$throw("racc_jump",2)}),h(d,"$yyerrok",l("racc_error_status",0)),h(d,"$racc_read_token",function(t,q,a){var v=this;return v.racc_debug_out.$print("read    "),v.racc_debug_out.$print(q.$inspect(),"(",v.$racc_token2str(t),") "),v.racc_debug_out.$puts(a.$inspect()),v.racc_debug_out.$puts()}),h(d,"$racc_shift",function(t,q,a){var v=this;return v.racc_debug_out.$puts("shift   "+v.$racc_token2str(t)),v.$racc_print_stacks(q,a),v.racc_debug_out.$puts()}),h(d,"$racc_reduce",function(t,q,a,v){var $=this,ee=r;return(ee=$.racc_debug_out).$print("reduce "),c(t["$empty?"]())?ee.$print(" <none>"):H(t,"each",[],function te(re){return null==re&&(re=r),ee.$print(" ",(null==te.$$s?this:te.$$s).$racc_token2str(re))},{$$s:$}),ee.$puts(" --\x3e "+$.$racc_token2str(q)),$.$racc_print_stacks(a,v),$.racc_debug_out.$puts()}),h(d,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),h(d,"$racc_e_pop",function(t,q,a){var v=this;return v.racc_debug_out.$puts("error recovering mode: pop token"),v.$racc_print_states(t),v.$racc_print_stacks(q,a),v.racc_debug_out.$puts()}),h(d,"$racc_next_state",function(t,q){var a=this;return a.racc_debug_out.$puts("goto    "+t),a.$racc_print_states(q),a.racc_debug_out.$puts()}),h(d,"$racc_print_stacks",function(t,q){var v=r;return(v=this.racc_debug_out).$print("        ["),H(t,"each_index",[],function $(ee){return null==ee&&(ee=r),v.$print(" (",(null==$.$$s?this:$.$$s).$racc_token2str(t["$[]"](ee))," ",q["$[]"](ee).$inspect(),")")},{$$s:this}),v.$puts(" ]")}),h(d,"$racc_print_states",function(t){var a=r;return(a=this.racc_debug_out).$print("        ["),H(t,"each",[],function($){return null==$&&($=r),a.$print(" ",$)}),a.$puts(" ]")}),h(d,"$racc_token2str",function(t){var a;return c(a=n(this.$class(),"Racc_token_to_s_table")["$[]"](t))?a:this.$raise("[Racc Bug] can't convert token "+t+" to string")}),h(d,"$token_to_str",function(t){return n(this.$class(),"Racc_token_to_s_table")["$[]"](t)})}(u[0],u)},Opal.modules["bcdice/arithmetic/node"]=function(e){var l,r,N,s,d,x,D,k,u,Y=e.module,G=e.klass,c=e.def,K=e.thrower,P=e.return_ivar,f=e.send2,F=e.find_super,h=e.eqeq,z=e.const_set,H=e.eqeqeq,E=e.rb_divide,Q=e.truthy,V=e.assign_ivar,j=e.alias,U=[],A=e.nil,i=e.$$$;return l=U,r=u=[Y(U[0],"BCDice")].concat(l),N=k=[Y(u[0],"Arithmetic")].concat(r),x=[Y(k[0],"Node")].concat(N),D=e.$r(x),(d=(s=G(x[0],null,"BinaryOp")).$$prototype).lhs=d.rhs=d.op=A,c(s,"$initialize",function(T,_,b){var t=this;return t.lhs=T,t.op=_,t.rhs=b}),c(s,"$eval",function(T){try{K("eval_return");var q,b=this,t=A;return t=b.lhs.$eval(T),q=b.rhs.$eval(T),t.$send(b.op,q)}catch(a){if(a===e.t_eval_return)return a.$v;throw a}}),c(s,"$output",function(){var T=this;return""+T.lhs.$output()+T.op+T.rhs.$output()}),c(s,"$s_exp",function(){var T=this;return"("+T.$op_for_s_exp()+" "+T.lhs.$s_exp()+" "+T.rhs.$s_exp()+")"}),c(s,"$op_for_s_exp",P("op")),function(w,g,s){var d=G(w,g,"DivideBase"),o=[d].concat(s),T=e.$r(o),_=d.$$prototype;_.lhs=_.rhs=_.op=A,c(d,"$initialize",function b(t,q){return b.$$p=null,f(this,F(this,"initialize",b,!1,!0),"initialize",[t,"/",q],null)}),c(d,"$eval",function(t){try{K("eval_return");var v,$,a=this;return v=a.lhs.$eval(t),$=a.rhs.$eval(t),h($,0)&&a.$raise(T("ZeroDivisionError")),a.$divide_and_round(v,$,t)}catch(ee){if(ee===e.t_eval_return)return ee.$v;throw ee}}),c(d,"$output",function b(){var t=b.$$p||A,q=this;return b.$$p=null,""+f(q,F(q,"output",b,!1,!0),"output",[],t)+q.$rounding_method()}),d.$private(),c(d,"$rounding_method",function(){return i(this.$class(),"ROUNDING_METHOD")}),c(d,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),c(d,"$divide_and_round",function(t,q,a){return this.$raise(T("NotImplementedError"))})}(x[0],D("BinaryOp"),x),function(w,g,s){var d=G(w,g,"DivideWithGameSystemDefault"),o=[d].concat(s),T=e.$r(o);z(o[0],"ROUNDING_METHOD",""),d.$private(),c(d,"$divide_and_round",function(b,t,q){var a,v=A;return H(i(T("RoundType"),"CEIL"),a=q)?E(b.$to_f(),t).$ceil():H(i(T("RoundType"),"ROUND"),a)?(v=E(b.$to_f(),t),Q(v["$negative?"]())?v.$abs().$round()["$-@"]():v.$round()):E(b,t).$floor()})}(x[0],D("DivideBase"),x),function(w,g,s){var d=G(w,g,"DivideWithCeil"),o=[d].concat(s);z(o[0],"ROUNDING_METHOD","C"),d.$private(),c(d,"$divide_and_round",function(_,b,t){return E(_.$to_f(),b).$ceil()})}(x[0],D("DivideBase"),x),function(w,g,s){var d=G(w,g,"DivideWithRound"),o=[d].concat(s);z(o[0],"ROUNDING_METHOD","R"),d.$private(),c(d,"$divide_and_round",function(_,b,t){var q=A;return q=E(_.$to_f(),b),Q(q["$negative?"]())?q.$abs().$round()["$-@"]():q.$round()})}(x[0],D("DivideBase"),x),function(w,g,s){var d=G(w,g,"DivideWithFloor"),o=[d].concat(s);z(o[0],"ROUNDING_METHOD","F"),d.$private(),c(d,"$divide_and_round",function(_,b,t){return E(_,b).$floor()})}(x[0],D("DivideBase"),x),function(w,g){var s=G(w,null,"Negative");s.$$prototype.body=A,c(s,"$initialize",V("body")),c(s,"$eval",function(T){try{return K("eval_return"),this.body.$eval(T)["$-@"]()}catch(t){if(t===e.t_eval_return)return t.$v;throw t}}),c(s,"$output",function(){return"-"+this.body.$output()}),c(s,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(x[0]),function(w,g){var s=G(w,null,"Parenthesis");s.$$prototype.expr=A,c(s,"$initialize",V("expr")),c(s,"$eval",function(T){try{return K("eval_return"),this.expr.$eval(T)}catch(t){if(t===e.t_eval_return)return t.$v;throw t}}),c(s,"$output",function(){return"("+this.expr.$output()+")"}),c(s,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(x[0]),function(w,g){var s=G(w,null,"Number");return s.$$prototype.value=A,c(s,"$initialize",V("value")),c(s,"$eval",P("value")),c(s,"$output",function(){return this.value.$to_s()}),j(s,"s_exp","output")}(x[0])},Opal.modules.strscan=function(e){var V,j,U,A,i,G=e.def,c=e.truthy,K=e.eqeqeq,P=e.Opal,f=e.return_ivar,F=e.send,h=e.alias,z=[],H=e.nil;return V=z,U=[j=(0,e.klass)(z[0],null,"StringScanner")].concat(V),A=e.$r(U),(i=j.$$prototype).pos=i.string=i.working=i.matched=i.prev_pos=i.match=H,j.$attr_reader("pos","matched"),G(j,"$initialize",function(l){var p=this;return p.string=l,p.pos=0,p.matched=H,p.working=l,p.match=[]}),j.$attr_reader("string"),G(j,"$beginning_of_line?",function(){var l=this;return 0===l.pos||"\n"===l.string.charAt(l.pos-1)}),G(j,"$scan",function(l){var p=this,u=(l=p.$anchor(l)).exec(p.working);return null==u?p.matched=H:(p.prev_pos=p.pos,p.pos+=u[0].length,p.working=p.working.substring(u[0].length),p.matched=u[0],p.match=u,u[0])}),G(j,"$scan_until",function(l){var p=this;l=p.$anchor(l);for(var u=p.working,C=0;u.length!=C;++C){var r=l.exec(u.substr(C));if(null!==r){var n=C+r[0].length,k=u.substr(0,n);return p.matched=r[0],p.match=r,p.prev_pos=p.pos+C,p.pos+=n,p.working=u.substr(n),k}}return p.matched=H}),G(j,"$[]",function(l){var u;if(c(this.match["$empty?"]()))return H;K(A("Symbol"),u=l)?l=l.$to_s():K(A("String"),u)||(l=P["$coerce_to!"](l,A("Integer"),"to_int"));var C=this.match;return l<0&&(l+=C.length),l<0||l>=C.length||null==C[l]?H:C[l]}),G(j,"$check",function(l){var p=this,u=(l=p.$anchor(l)).exec(p.working);return p.matched=null==u?H:u[0]}),G(j,"$check_until",function(l){var p=this,u=p.prev_pos,C=p.pos,r=p.working,n=p.$scan_until(l);return p.prev_pos=u,p.pos=C,p.working=r,n}),G(j,"$peek",function(l){return this.working.substring(0,l)}),G(j,"$eos?",function(){return 0===this.working.length}),G(j,"$exist?",function(l){var u=l.exec(this.working);return null==u?H:0==u.index?0:u.index+1}),G(j,"$skip",function(l){var p=this,u=(l=p.$anchor(l)).exec(p.working);if(null==u)return p.match=[],p.matched=H;var C=u[0],r=C.length;return p.matched=C,p.match=u,p.prev_pos=p.pos,p.pos+=r,p.working=p.working.substring(r),r}),G(j,"$skip_until",function(l){var u=this.$scan_until(l);return u===H?H:(this.matched=u.substr(-1),u.length)}),G(j,"$get_byte",function(){var l=this,p=H;return l.pos<l.string.length?(l.prev_pos=l.pos,l.pos+=1,p=l.matched=l.working.substring(0,1),l.working=l.working.substring(1)):l.matched=H,p}),G(j,"$match?",function(l){var p=this,u=(l=p.$anchor(l)).exec(p.working);return null==u?H:(p.prev_pos=p.pos,u[0].length)}),G(j,"$pos=",function(l){var p=this;return l<0&&(l+=p.string.$length()),p.pos=l,p.working=p.string.slice(l)}),G(j,"$matched_size",function(){return this.matched===H?H:this.matched.length}),G(j,"$post_match",function(){var l=this;return l.matched===H?H:l.string.substr(l.pos)}),G(j,"$pre_match",function(){var l=this;return l.matched===H?H:l.string.substr(0,l.prev_pos)}),G(j,"$reset",function(){var l=this;return l.working=l.string,l.matched=H,l.pos=0}),G(j,"$rest",f("working")),G(j,"$rest?",function(){return 0!==this.working.length}),G(j,"$rest_size",function(){return this.$rest().$size()}),G(j,"$terminate",function(){var l,p=this;return p.match=H,l=[p.string.$length()],F(p,"pos=",l),l[l.length-1]}),G(j,"$unscan",function(){var l=this;return l.pos=l.prev_pos,l.prev_pos=H,l.match=H,l}),h(j,"bol?","beginning_of_line?"),h(j,"getch","get_byte"),j.$private(),G(j,"$anchor",function(l){var p=l.toString().match(/\/([^\/]+)$/);return p=p?p[1]:void 0,new RegExp("^(?:"+l.source+")",p)})},Opal.modules["bcdice/normalize"]=function(e){var h,Q,H,Y=e.module,G=e.eqeqeq,c=e.def,K=e.eqeq,P=[],f=e.nil;return h=P,H=[Y(P[0],"BCDice")].concat(h),(Q=Y(H[0],"Normalize")).$module_function(),c(Q,"$comparison_operator",function(j){var U;return G(/<=|=</,U=j)?"<=":G(/>=|=>/,U)?">=":G(/<>|!=|=!/,U)?"!=":G(/</,U)?"<":G(/>/,U)?">":G(/=/,U)?"==":f}),c(Q,"$target_number",function(j){return K(j,"?")?j:j.$to_i()})},Opal.modules["bcdice/command/lexer"]=function(e){var V,i,C,r,n,k,M,l,U,Y=e.module,G=e.klass,c=e.const_set,K=e.hash2,P=e.truthy,f=e.send,F=e.def,h=e.thrower,z=e.top,H=[],E=e.nil;return z.$require("strscan"),z.$require("bcdice/normalize"),V=H,i=U=[Y(H[0],"BCDice")].concat(V),C=l=[Y(U[0],"Command")].concat(i),n=[r=G(l[0],null,"Lexer")].concat(C),k=e.$r(n),(M=r.$$prototype).scanner=M.notations=E,c(n[0],"SYMBOLS",K(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),F(r,"$initialize",function(R,x){var D,w,s;return R=P(s=(D=(w=R)===E||null==w?E:w.$split(" ",2))===E||null==D?E:D.$first())?s:"",this.scanner=k("StringScanner").$new(R),this.notations=f(x,"map",[],function(o){return null==o&&(o=E),P(o["$is_a?"](k("String")))?k("Regexp").$new(o):o})}),F(r,"$next_token",function(){try{var R=h("return"),x=this,D=E,w=E,s=E,d=E;return P(x.scanner["$eos?"]())?[!1,"$"]:(f(x.notations,"each",[],function o(T){var b,_=null==o.$$s?this:o.$$s;if(null==_.scanner&&(_.scanner=E),null==T&&(T=E),b=_.scanner.$scan(T),!P(b))return E;R.$throw(["NOTATION",b])},{$$s:x,$$ret:R}),P(D=x.scanner.$scan(/\d+/))?["NUMBER",D.$to_i()]:P(w=x.scanner.$scan(/[<>!=]+/))?(w=k("Normalize").$comparison_operator(w),[P(w)?"CMP_OP":"ILLEGAL",w]):(s=x.scanner.$getch().$upcase(),[P(d=k("SYMBOLS")["$[]"](s))?d:s.$to_sym(),s]))}catch(o){if(o===R)return o.$v;throw o}}),F(r,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/command/parsed"]=function(e){var z,V,I,l,p,u,C,U,E,Y=e.module,G=e.klass,c=e.def,K=e.return_ivar,P=e.truthy,f=[],F=e.nil;return z=f,V=E=[Y(f[0],"BCDice")].concat(z),I=U=[Y(E[0],"Command")].concat(V),p=[l=G(U[0],null,"Parsed")].concat(I),u=e.$r(p),(C=l.$$prototype).critical=C.fumble=C.dollar=C.modify_number=C.question_target=C.target_number=C.prefix_number=C.command=C.suffix_number=C.cmp_op=F,l.$attr_accessor("command"),l.$attr_accessor("prefix_number"),l.$attr_accessor("suffix_number"),l.$attr_accessor("critical"),l.$attr_accessor("fumble"),l.$attr_accessor("dollar"),l.$attr_accessor("modify_number"),l.$attr_accessor("cmp_op"),l.$attr_accessor("target_number"),l.$attr_writer("question_target"),c(l,"$initialize",function(){var n=this;return n.prefix_number=F,n.suffix_number=F,n.critical=F,n.fumble=F,n.dollar=F,n.cmp_op=F,n.target_number=F,n.question_target=!1}),c(l,"$question_target?",K("question_target")),c(l,"$to_s",function(n){var k=this,M=F,N=F,R=F,x=F,D=F;switch(null==n&&(n="after_command"),M=P(k.critical)?"@"+k.critical:F,N=P(k.fumble)?"#"+k.fumble:F,R=P(k.dollar)?"$"+k.dollar:F,x=u("Format").$modifier(k.modify_number),D=P(k.question_target)?"?":k.target_number,n){case"after_command":return[k.prefix_number,k.command,k.suffix_number,M,N,R,x,k.cmp_op,D].$join();case"after_modify_number":return[k.prefix_number,k.command,k.suffix_number,x,M,N,R,k.cmp_op,D].$join();case"after_target_number":return[k.prefix_number,k.command,k.suffix_number,x,k.cmp_op,D,M,N,R].$join();default:return F}},-1)},Opal.modules["bcdice/command/parser"]=function(e){var n,R,d,b,t,q,a,v,$,ee,te,re,le,o,T,_,ue,D,w,M,Y=e.klass,G=e.module,c=e.slice,K=e.extract_kwargs,P=e.ensure_kwargs,f=e.get_kwarg,F=e.send2,h=e.find_super,z=e.def,H=e.send,E=e.eqeq,Q=e.thrower,V=e.hash,j=e.const_set,U=e.truthy,A=e.to_ary,i=e.hash2,I=e.top,l=[],p=e.$r(l),u=e.nil,C=e.$$$;return I.$require("racc/parser.rb"),I.$require("bcdice/arithmetic/node"),I.$require("bcdice/command/lexer"),I.$require("bcdice/command/parsed"),Y(C(p("BCDice"),"Command"),C(p("Racc"),"Parser"),"Parser"),n=l,R=M=[G(l[0],"BCDice")].concat(n),D=[G(M[0],"Command")].concat(R),w=e.$r(D),d=D,T=[o=Y(D[0],C(w("Racc"),"Parser"),"Parser")].concat(d),_=e.$r(T),(ue=o.$$prototype).notations=ue.lexer=ue.modifier=ue.suffix_number=ue.prefix_number=ue.need_suffix_number=ue.need_prefix_number=ue.critical=ue.fumble=ue.dollar=ue.allowed_cmp_op=ue.question_target=u,z(o,"$initialize",function J(B,Z){var y,S,O,m,X=this;return J.$$p=null,y=c(arguments),S=K(y),S=P(S),O=y,m=f(S,"round_type"),F(X,h(X,"initialize",J,!1,!0),"initialize",[],null),X.notations=O,X.round_type=m,X.prefix_number=!1,X.suffix_number=!1,X.need_prefix_number=!1,X.need_suffix_number=!1,X.modifier=!0,X.critical=!1,X.fumble=!1,X.dollar=!1,X.allowed_cmp_op=[u,">=",">","<=","<","==","!="],X.question_target=!1},-2),z(o,"$disable_modifier",function(){return this.modifier=!1,this}),z(o,"$enable_prefix_number",function(){return this.prefix_number=!0,this}),z(o,"$enable_suffix_number",function(){return this.suffix_number=!0,this}),z(o,"$has_prefix_number",function(){var B=this;return B.prefix_number=!0,B.need_prefix_number=!0,B}),z(o,"$has_suffix_number",function(){var B=this;return B.suffix_number=!0,B.need_suffix_number=!0,B}),z(o,"$enable_critical",function(){return this.critical=!0,this}),z(o,"$enable_fumble",function(){return this.fumble=!0,this}),z(o,"$enable_dollar",function(){return this.dollar=!0,this}),z(o,"$restrict_cmp_op_to",function(B){var Z;return Z=c(arguments),this.allowed_cmp_op=Z,this},-1),z(o,"$enable_question_target",function(){return this.question_target=!0,this}),z(o,"$parse",function(B){var Z=this;try{return Z.lexer=_("Lexer").$new(B,Z.notations),Z.$do_parse()}catch(y){if(!e.rescue(y,[_("ParseError"),_("ZeroDivisionError")]))throw y;try{return u}finally{e.pop_exception()}}}),o.$private(),z(o,"$parsed",function(B,Z,y,S){try{return Q("eval_return"),H(_("Parsed").$new(),"tap",[],function L(X){var W,ne,ie,ce,fe,oe,de,me=null==L.$$s?this:L.$$s;return null==me.round_type&&(me.round_type=u),null==X&&(X=u),X["$command="](B["$[]"]("command")),X["$prefix_number="]((W=B["$[]"]("prefix"))===u||null==W?u:W.$eval(me.round_type)),X["$suffix_number="]((ne=B["$[]"]("suffix"))===u||null==ne?u:ne.$eval(me.round_type)),X["$critical="]((ie=Z["$[]"]("critical"))===u||null==ie?u:ie.$eval(me.round_type)),X["$fumble="]((ce=Z["$[]"]("fumble"))===u||null==ce?u:ce.$eval(me.round_type)),X["$dollar="]((fe=Z["$[]"]("dollar"))===u||null==fe?u:fe.$eval(me.round_type)),X["$modify_number="](y.$eval(me.round_type)),X["$cmp_op="](S["$[]"]("cmp_op")),E(S["$[]"]("target"),"?")?(X["$question_target="](!0),H(X,"target_number=",oe=[0]),oe[oe.length-1]):(X["$question_target="](!1),oe=[(de=S["$[]"]("target"),de===u||null==de?u:de.$eval(me.round_type))],H(X,"target_number=",oe),oe[oe.length-1])},{$$s:this})}catch(L){if(L===e.t_eval_return)return L.$v;throw L}}),z(o,"$next_token",function(){return this.lexer.$next_token()}),b=e.large_array_unpack("6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,33,34,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,,,17,18,6,,5,,,17,18,,,5,23,24,25,26,56,54,55,57"),t=e.large_array_unpack("0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,,17,15,15,18,18,23,,18,30,30,23,23,24,,23,31,31,24,24,25,,24,44,44,25,25,28,,25,47,47,28,28,29,,28,48,48,29,29,33,,29,49,49,33,33,34,,33,50,50,34,34,36,,34,,,36,36,37,,36,,,37,37,,,37,27,27,27,27,52,52,52,52"),q=e.large_array_unpack("-2,4,16,-3,-1,11,,33,13,35,23,30,1,,28,40,,37,44,,,-2,,51,58,65,0,106,72,79,47,54,,86,93,,100,107,,,,,,,63,,,68,75,82,89,,120,,,,,"),a=e.large_array_unpack("-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29"),v=e.large_array_unpack("30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,,,21,47,48,40,51,52,49,50,44,46,3,,,,13,,,,,,,,32"),$=e.large_array_unpack("8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,,,4,8,8,5,7,7,8,8,9,5,6,,,,6,,,,,,,,6"),ee=[u,6,13,3,9,-1,27,-15,-10,-1,-38],te=[u,u,u,u,u,u,19,16,15,u,u],re=e.large_array_unpack("0,0,racc_error,4,20,_reduce_1,4,20,_reduce_2,3,20,_reduce_3,3,21,_reduce_4,2,21,_reduce_5,2,21,_reduce_6,1,21,_reduce_7,0,22,_reduce_8,3,22,_reduce_9,3,22,_reduce_10,3,22,_reduce_11,2,23,_reduce_12,2,23,_reduce_13,3,23,_reduce_14,3,23,_reduce_15,0,24,_reduce_16,2,24,_reduce_17,2,24,_reduce_18,3,28,_reduce_19,3,28,_reduce_20,1,28,_reduce_none,3,27,_reduce_22,4,27,_reduce_23,1,27,_reduce_none,0,29,_reduce_25,1,29,_reduce_26,1,29,_reduce_27,1,29,_reduce_28,1,29,_reduce_29,2,26,_reduce_30,2,26,_reduce_31,1,26,_reduce_none,3,25,_reduce_33,1,25,_reduce_34"),le=V(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),j(T[0],"Racc_arg",[b,t,a,q,v,$,te,ee,19,re,le,58,35,!0]),j(T[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),j(T[0],"Racc_debug_parser",!1),z(o,"$_reduce_1",function(B,Z,y){var S,m=this;return U(m.modifier)||m.$raise(_("ParseError")),S=A(B),m.$parsed(null==S[0]?u:S[0],null==S[1]?u:S[1],null==S[2]?u:S[2],null==S[3]?u:S[3])}),z(o,"$_reduce_2",function(B,Z,y){var S,m=this;return U(m.modifier)||m.$raise(_("ParseError")),S=A(B),m.$parsed(null==S[0]?u:S[0],null==S[2]?u:S[2],null==S[1]?u:S[1],null==S[3]?u:S[3])}),z(o,"$_reduce_3",function(B,Z,y){var S,W;return W=null==(S=A(B))[2]?u:S[2],this.$parsed(null==S[0]?u:S[0],null==S[1]?u:S[1],C(C(_("Arithmetic"),"Node"),"Number").$new(0),W)}),z(o,"$_reduce_4",function(B,Z,y){var S=this;return U(S.prefix_number)&&U(S.suffix_number)||S.$raise(_("ParseError")),i(["command","prefix","suffix"],{command:B["$[]"](1),prefix:B["$[]"](0),suffix:B["$[]"](2)})}),z(o,"$_reduce_5",function(B,Z,y){var S=this;return U(S.prefix_number)||S.$raise(_("ParseError")),U(S.need_suffix_number)&&S.$raise(_("ParseError")),i(["command","prefix"],{command:B["$[]"](1),prefix:B["$[]"](0)})}),z(o,"$_reduce_6",function(B,Z,y){var S=this;return U(S.suffix_number)||S.$raise(_("ParseError")),U(S.need_prefix_number)&&S.$raise(_("ParseError")),i(["command","suffix"],{command:B["$[]"](0),suffix:B["$[]"](1)})}),z(o,"$_reduce_7",function(B,Z,y){var S=this;return(U(S.need_prefix_number)||U(S.need_suffix_number))&&S.$raise(_("ParseError")),i(["command"],{command:B["$[]"](0)})}),z(o,"$_reduce_8",function(B,Z,y){return i([],{})}),z(o,"$_reduce_9",function(B,Z,y){var S,W,L=u;return L=null==(S=A(B))[0]?u:S[0],W=null==S[2]?u:S[2],U(this.critical)&&U(L["$[]"]("critical")["$nil?"]())||this.$raise(_("ParseError")),L["$[]="]("critical",W),L}),z(o,"$_reduce_10",function(B,Z,y){var S,W,L=u;return L=null==(S=A(B))[0]?u:S[0],W=null==S[2]?u:S[2],U(this.fumble)&&U(L["$[]"]("fumble")["$nil?"]())||this.$raise(_("ParseError")),L["$[]="]("fumble",W),L}),z(o,"$_reduce_11",function(B,Z,y){var S,W,L=u;return L=null==(S=A(B))[0]?u:S[0],W=null==S[2]?u:S[2],U(this.dollar)&&U(L["$[]"]("dollar")["$nil?"]())||this.$raise(_("ParseError")),L["$[]="]("dollar",W),L}),z(o,"$_reduce_12",function(B,Z,y){return B["$[]"](1)}),z(o,"$_reduce_13",function(B,Z,y){return C(C(_("Arithmetic"),"Node"),"Negative").$new(B["$[]"](1))}),z(o,"$_reduce_14",function(B,Z,y){return C(C(_("Arithmetic"),"Node"),"BinaryOp").$new(B["$[]"](0),"+",B["$[]"](2))}),z(o,"$_reduce_15",function(B,Z,y){return C(C(_("Arithmetic"),"Node"),"BinaryOp").$new(B["$[]"](0),"-",B["$[]"](2))}),z(o,"$_reduce_16",function(B,Z,y){return U(this.allowed_cmp_op["$include?"](u))||this.$raise(_("ParseError")),i([],{})}),z(o,"$_reduce_17",function(B,Z,y){var S,L,X;return X=null==(S=A(B))[1]?u:S[1],U(this.allowed_cmp_op["$include?"](L=null==S[0]?u:S[0]))||this.$raise(_("ParseError")),i(["cmp_op","target"],{cmp_op:L,target:X})}),z(o,"$_reduce_18",function(B,Z,y){var O,S=this;return O=B["$[]"](0),U(S.question_target)||S.$raise(_("ParseError")),U(S.allowed_cmp_op["$include?"](O))||S.$raise(_("ParseError")),i(["cmp_op","target"],{cmp_op:O,target:"?"})}),z(o,"$_reduce_19",function(B,Z,y){return C(C(_("Arithmetic"),"Node"),"BinaryOp").$new(B["$[]"](0),"+",B["$[]"](2))}),z(o,"$_reduce_20",function(B,Z,y){return C(C(_("Arithmetic"),"Node"),"BinaryOp").$new(B["$[]"](0),"-",B["$[]"](2))}),z(o,"$_reduce_22",function(B,Z,y){return C(C(_("Arithmetic"),"Node"),"BinaryOp").$new(B["$[]"](0),"*",B["$[]"](2))}),z(o,"$_reduce_23",function(B,Z,y){return B["$[]"](3).$new(B["$[]"](0),B["$[]"](2))}),z(o,"$_reduce_25",function(B,Z,y){return C(C(_("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),z(o,"$_reduce_26",function(B,Z,y){return C(C(_("Arithmetic"),"Node"),"DivideWithCeil")}),z(o,"$_reduce_27",function(B,Z,y){return C(C(_("Arithmetic"),"Node"),"DivideWithCeil")}),z(o,"$_reduce_28",function(B,Z,y){return C(C(_("Arithmetic"),"Node"),"DivideWithRound")}),z(o,"$_reduce_29",function(B,Z,y){return C(C(_("Arithmetic"),"Node"),"DivideWithFloor")}),z(o,"$_reduce_30",function(B,Z,y){return B["$[]"](1)}),z(o,"$_reduce_31",function(B,Z,y){return C(C(_("Arithmetic"),"Node"),"Negative").$new(B["$[]"](1))}),z(o,"$_reduce_33",function(B,Z,y){return B["$[]"](1)}),z(o,"$_reduce_34",function(B,Z,y){return C(C(_("Arithmetic"),"Node"),"Number").$new(B["$[]"](0))}),z(o,"$_reduce_none",function(B,Z,y){return B["$[]"](0)})},Opal.modules["bcdice/deprecated/checker"]=function(e){var H,j,I,l,p,u,A,Q,Y=e.module,G=e.send,c=e.eqeqeq,K=e.truthy,P=e.def,f=e.return_val,F=[],h=e.nil;return H=F,j=Q=[Y(F[0],"BCDice")].concat(H),I=A=[Y(Q[0],"Deprecated")].concat(j),p=[l=Y(A[0],"Checker")].concat(I),u=e.$r(p),l.$private(),P(l,"$check_result_legacy",function(r,n,k,M){var D,N=this,R=h,x=h,w=h,g=h;return R=G(n,"map",[],"sides".$to_proc()),D=(x=G(n,"map",[],"value".$to_proc())).$sum(),w=c([100],g=R)?N.$check_1D100(r,D,k,M):c([20],g)?N.$check_1D20(r,D,k,M):c([6,6],g)?N.$check_2D6(r,D,x,k,M):h,(K(w["$nil?"]())||K(w["$empty?"]()))&&(w=c([10],g=R.$uniq())?N.$check_nD10(r,D,x,k,M):c([6],g)?N.$check_nD6(r,D,x,k,M):h,K(w["$nil?"]())||K(w["$empty?"]()))?h:u("Result").$new(w.$delete_prefix(" \uff1e "))}),P(l,"$check_1D100",f(h)),P(l,"$check_1D20",f(h)),P(l,"$check_nD10",f(h)),P(l,"$check_2D6",f(h)),P(l,"$check_nD6",f(h))},Opal.modules["bcdice/base"]=function(e){var p,N,g,_,t,q,s,d,o,T,x,Y=e.module,G=e.klass,c=e.slice,K=e.rb_plus,P=e.truthy,f=e.def,F=e.regexp,h=e.send,z=e.thrower,H=e.return_ivar,E=e.assign_ivar_val,Q=e.eqeqeq,V=e.eqeq,j=e.return_val,U=e.range,A=e.rb_minus,i=e.rb_divide,I=e.rb_times,l=e.rb_ge,u=e.top,C=[],r=e.$r(C),n=e.nil,k=e.$$$;return u.$require("i18n"),u.$require("i18n/backend/fallbacks"),u.$require("bcdice/randomizer"),u.$require("bcdice/dice_table"),u.$require("bcdice/enum"),u.$require("bcdice/translate"),u.$require("bcdice/result"),u.$require("bcdice/command/parser"),u.$require("bcdice/deprecated/checker"),N=C,g=x=[Y(C[0],"BCDice")].concat(N),d=[s=G(x[0],null,"Base")].concat(g),o=e.$r(d),(T=s.$$prototype).raw_input=T.randomizer=T.enabled_upcase_input=T.debug=n,t=[_=e.get_singleton_class(s)].concat(d),q=e.$r(t),_.$attr_reader("prefixes"),f(_,"$register_prefix",function(v){var ee,re;return null==this.prefixes&&(this.prefixes=n),ee=c(arguments),this.prefixes=K(P(re=this.prefixes)?re:[],ee.$flatten())},-1),f(_,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())}),f(_,"$prefixes_pattern",function(){var v=this,$=n;return null==v.prefixes_pattern&&(v.prefixes_pattern=n),null==v.prefixes&&(v.prefixes=n),v.prefixes_pattern=P($=v.prefixes_pattern)?$:n,P(v.prefixes_pattern)?v.prefixes_pattern:(v.prefixes=P($=v.prefixes)?$:[],v.prefixes.$freeze(),v.prefixes_pattern=(P(v.prefixes["$empty?"]())?/(?!)/:F(["^(S)?(",v.prefixes.$join("|"),")"],"i")).$freeze())}),f(_,"$command_pattern",function(){var v=this,$=n,ee=n;return null==v.command_pattern&&(v.command_pattern=n),null==v.prefixes&&(v.prefixes=n),v.command_pattern=P($=v.command_pattern)?$:n,P(v.command_pattern)?v.command_pattern:(v.prefixes=P($=v.prefixes)?$:[],v.prefixes.$freeze(),ee=K(h(k(q("CommonCommand"),"COMMANDS"),"map",[],function(re){return null==re&&(re=n),k(re,"PREFIX_PATTERN").$source()}),v.prefixes),v.command_pattern=F(["^S?(",ee.$join("|"),")"],"i").$freeze())}),f(_,"$eval",function(v){try{return z("eval_return"),this.$new(v).$eval()}catch(te){if(te===e.t_eval_return)return te.$v;throw te}}),s.$include(o("Translate")),s.$include(k(o("Deprecated"),"Checker")),f(s,"$initialize",function(b){var t=this;return t.raw_input=b,t.sort_add_dice=!1,t.sort_barabara_dice=!1,t.d66_sort_type=k(o("D66SortType"),"NO_SORT"),t.enabled_d9=!1,t.round_type=k(o("RoundType"),"FLOOR"),t.sides_implicit_d=6,t.upper_dice_reroll_threshold=n,t.reroll_dice_reroll_threshold=n,t.default_cmp_op=n,t.default_target_number=n,t.enabled_upcase_input=!0,t.locale="ja_jp",t.randomizer=k(o("BCDice"),"Randomizer").$new(),t.debug=!1}),s.$attr_accessor("randomizer"),s.$attr_reader("d66_sort_type"),s.$attr_reader("round_type"),s.$attr_reader("sides_implicit_d"),s.$attr_reader("upper_dice_reroll_threshold"),s.$attr_reader("reroll_dice_reroll_threshold"),s.$attr_reader("default_cmp_op"),s.$attr_reader("default_target_number"),f(s,"$sort_add_dice?",H("sort_add_dice")),f(s,"$sort_barabara_dice?",H("sort_barabara_dice")),f(s,"$enabled_d9?",H("enabled_d9")),f(s,"$enable_debug",E("debug",!0)),f(s,"$eval",function(){var t,a,b=this,q=n;return t=k(o("BCDice"),"Preprocessor").$process(b.raw_input,b),q=P(a=b.$dice_command(t))?a:b.$eval_common_command(b.raw_input),P(q)?(q["$rands="](b.randomizer.$rand_results()),q["$detailed_rands="](b.randomizer.$detailed_rand_results()),q):n}),f(s,"$change_text",function(b){return b}),f(s,"$check_result",function(b,t,q,a){var v=this,$=n,ee=n,te=n,re=n,$e=n;return $=v.$check_result_legacy(b,t,q,a),P($)?$:(ee=h(t,"map",[],"sides".$to_proc()),re=(te=h(t,"map",[],"value".$to_proc())).$sum(),$=Q([100],$e=ee)?v.$result_1d100(b,re,q,a):Q([20],$e)?v.$result_1d20(b,re,q,a):Q([6,6],$e)?v.$result_2d6(b,re,te,q,a):n,V($,o("Result").$nothing())?n:P($)?$:($=Q([10],$e=ee.$uniq())?v.$result_nd10(b,re,te,q,a):Q([6],$e)?v.$result_nd6(b,re,te,q,a):n,V($,o("Result").$nothing())?n:P($)?$:v.$result_ndx(b,q,a)))}),f(s,"$grich_text",j(n)),s.$private(),f(s,"$eval_common_command",function(b){try{z("eval_return");var q=z("return");return b=this.$change_text(b),h(k(o("CommonCommand"),"COMMANDS"),"each",[],function v($){var te,ee=null==v.$$s?this:v.$$s;if(null==ee.randomizer&&(ee.randomizer=n),null==$&&($=n),te=$.$eval(b,ee,ee.randomizer),!P(te))return n;q.$throw(te)},{$$s:this,$$ret:q}),n}catch(v){if(v===e.t_eval_return||v===q)return v.$v;throw v}}),f(s,"$dice_command",function(b){var t=this,q=n,a=n,v=n,$=n;return P(t.enabled_upcase_input)&&(b=b.$upcase()),q=t.$class().$prefixes_pattern().$match(b),P(q)?(a=q["$[]"](1)["$nil?"]()["$!"](),P(a)&&(b=b["$[]"](U(1,-1,!1))),v=t.$eval_game_system_specific_command(b),P(v["$is_a?"](o("Result")))?(v["$secret="](P($=v["$secret?"]())?$:a),v):P(v["$nil?"]())||P(v["$empty?"]())||V(v,"1")?n:h(o("Result").$new(),"tap",[],function(te){var re;return null==te&&(te=n),te["$text="](v.$to_s()),h(te,"secret=",re=[a]),re[re.length-1]})):n}),f(s,"$eval_game_system_specific_command",j(n)),f(s,"$result_ndx",function(b,t,q){return P(q["$is_a?"](o("String")))?n:P(b.$send(t,q))?o("Result").$success(this.$translate("success")):o("Result").$failure(this.$translate("failure"))}),f(s,"$result_1d100",j(n)),f(s,"$result_1d20",j(n)),f(s,"$result_nd10",j(n)),f(s,"$result_2d6",j(n)),f(s,"$result_nd6",j(n)),f(s,"$get_table_by_2d6",function(b){return this.$get_table_by_nD6(b,2)}),f(s,"$get_table_by_1d6",function(b){return this.$get_table_by_nD6(b,1)}),f(s,"$get_table_by_nD6",function(b,t){return this.$get_table_by_nDx(b,t,6)}),f(s,"$get_table_by_nDx",function(b,t,q){var v,$=n;return v=this.randomizer.$roll_sum(t,q),$=this.$get_table_value(b["$[]"](A(v,t))),P($["$nil?"]())?["1",0]:[$,v]}),f(s,"$get_table_by_1d3",function(b){var a,v,t=this,$=n;return t.$debug("get_table_by_1d3"),a=t.randomizer.$roll_sum(1,6),t.$debug("num",a),v=i(A(a,1),2).$to_i(),t.$debug("index",v),$=b["$[]"](v),P($["$nil?"]())?["1",0]:[$,a]}),f(s,"$get_table_by_d66_swap",function(b){var q;return q=this.randomizer.$roll_d66(k(o("D66SortType"),"ASC")),[this.$get_table_by_number(q,b),q]}),f(s,"$get_table_by_d66",function(b){var q,a,v,ee,$=n;return q=this.randomizer.$roll_once(6),a=this.randomizer.$roll_once(6),v=K(I(A(q,1),6),A(a,1)),$=b["$[]"](v),ee=""+q+a,P($["$nil?"]())?["1",ee]:[$,ee]}),f(s,"$get_table_by_number",function(b,t,q){try{var a=z("return");return null==q&&(q="1"),h(t,"each",[],function $(ee){var re,te=null==$.$$s?this:$.$$s;if(null==ee&&(ee=n),re=ee["$[]"](0),!P(l(re,b)))return n;a.$throw(te.$get_table_value(ee["$[]"](1)))},{$$s:this,$$ret:a}),this.$get_table_value(q)}catch($){if($===a)return $.$v;throw $}},-3),f(s,"$get_table_value",function(b){return P(b["$is_a?"](o("Proc")))?b.$call():b}),f(s,"$roll_tables",function(b,t){var a=n;return a=t["$[]"](b),P(a)?a.$roll(this.randomizer).$to_s():n}),f(s,"$debug",function(b,t){var a,v=this,$=n,ee=n;return a=c(arguments,1),P(v.debug)?($=P(b["$is_a?"](o("String")))?b:b.$inspect(),P(a["$empty?"]())?v.$warn($):(ee=h(a,"map",[],function(re){return null==re&&(re=n),P(re["$is_a?"](o("String")))?'"'+re+'"':re.$inspect()}),v.$warn($+": "+ee.$join(", ")))):n},-2),k(k(r("I18n"),"Backend"),"Simple").$include(k(k(r("I18n"),"Backend"),"Fallbacks")),r("I18n").$load_path()["$<<"](r("Dir")["$[]"](r("File").$join("bcdice","../../i18n/**/*.yml"))),r("I18n")["$default_locale="]("ja_jp"),p=[["ja_jp"]],h(r("I18n").$fallbacks(),"defaults=",p),p[p.length-1]},Opal.modules["bcdice/game_system/sword_world/rating_lexer"]=function(e){var E,U,u,M,N,R,x,r,i,I,V,Y=e.module,G=e.klass,c=e.const_set,K=e.hash2,P=e.truthy,f=e.def,h=[],z=e.nil;return e.top.$require("strscan"),E=h,U=V=[Y(h[0],"BCDice")].concat(E),i=[Y(V[0],"GameSystem")].concat(U),I=e.$r(i),u=i,M=r=[G(i[0],I("Base"),"SwordWorld")].concat(u),R=[N=G(r[0],null,"RatingLexer")].concat(M),x=e.$r(R),N.$$prototype.scanner=z,c(R[0],"SYMBOLS",K(["+","-","*","/","(",")","[","]","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),f(N,"$initialize",function(g){var s,d,T;return g=P(T=(s=(d=g)===z||null==d?z:d.$split(" ",2))===z||null==s?z:s.$first())?T:"",this.scanner=x("StringScanner").$new(g)}),f(N,"$next_token",function(){var g=this,s=z,d=z,T=z;return P(g.scanner["$eos?"]())?[!1,"$"]:P(s=g.scanner.$scan(/\d+/))?["NUMBER",s.$to_i()]:(d=g.scanner.$getch().$upcase(),[P(T=x("SYMBOLS")["$[]"](d))?T:d.$to_sym(),d])}),f(N,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/game_system/sword_world/rating_parsed"]=function(e){var Q,A,C,N,R,x,D,w,n,I,l,j,Y=e.module,G=e.klass,c=e.def,K=e.truthy,P=e.rb_le,f=e.rb_plus,F=e.rb_lt,h=e.neqeq,z=[],H=e.nil;return Q=z,A=j=[Y(z[0],"BCDice")].concat(Q),I=[Y(j[0],"GameSystem")].concat(A),l=e.$r(I),C=I,N=n=[G(I[0],l("Base"),"SwordWorld")].concat(C),x=[R=G(n[0],null,"RatingParsed")].concat(N),D=e.$r(x),(w=R.$$prototype).modifier_after_half=w.modifier_after_one_and_a_half=w.semi_fixed_val=w.kept_modify=w.rate=w.greatest_fortune=w.modifier=H,R.$attr_accessor("rate"),R.$attr_accessor("critical"),R.$attr_accessor("kept_modify"),R.$attr_accessor("first_to"),R.$attr_accessor("first_modify"),R.$attr_accessor("rateup"),R.$attr_accessor("greatest_fortune"),R.$attr_accessor("semi_fixed_val"),R.$attr_accessor("tmp_fixed_val"),R.$attr_accessor("modifier"),R.$attr_accessor("modifier_after_half"),R.$attr_accessor("modifier_after_one_and_a_half"),c(R,"$initialize",function(s,d){var o=this;return o.rate=s,o.modifier=d,o.critical=13,o.kept_modify=0,o.first_to=0,o.first_modify=0,o.greatest_fortune=!1,o.rateup=0,o.semi_fixed_val=0,o.tmp_fixed_val=0,o.modifier_after_half=H,o.modifier_after_one_and_a_half=H}),c(R,"$half",function(){return this.modifier_after_half["$nil?"]()["$!"]()}),c(R,"$one_and_a_half",function(){return this.modifier_after_one_and_a_half["$nil?"]()["$!"]()}),c(R,"$min_critical",function(){var s=this;return K(P(s.semi_fixed_val,1))?3:f(f(s.semi_fixed_val,s.kept_modify),2).$clamp(3,13)}),c(R,"$infinite_roll?",function(){return F(this.$critical(),this.$min_critical())}),c(R,"$to_s",function(){var s=this,d=H;return d="KeyNo."+s.rate,K(F(s.$critical(),13))&&(d=f(d,"c["+s.$critical()+"]")),h(s.$first_modify(),0)&&(d=f(d,"m["+D("Format").$modifier(s.$first_modify())+"]")),h(s.$first_to(),0)&&(d=f(d,"m["+s.$first_to()+"]")),h(s.$rateup(),0)&&(d=f(d,"r["+s.$rateup()+"]")),K(s.greatest_fortune)&&(d=f(d,"gf")),h(s.$semi_fixed_val(),0)&&(d=f(d,"sf["+s.$semi_fixed_val()+"]")),h(s.$tmp_fixed_val(),0)&&(d=f(d,"tf["+s.$tmp_fixed_val()+"]")),h(s.$kept_modify(),0)&&(d=f(d,"a["+D("Format").$modifier(s.$kept_modify())+"]")),h(s.modifier,0)&&(d=f(d,D("Format").$modifier(s.modifier))),d})},Opal.modules["bcdice/game_system/sword_world/rating_options"]=function(e){var h,Q,I,r,p,j,U,H,Y=e.module,G=e.klass,c=e.truthy,K=e.def,P=[];return h=P,Q=H=[Y(P[0],"BCDice")].concat(h),j=[Y(H[0],"GameSystem")].concat(Q),U=e.$r(j),I=j,p=[G(j[0],U("Base"),"SwordWorld")].concat(I),(r=G(p[0],null,"RatingOptions")).$attr_accessor("critical"),r.$attr_accessor("kept_modify"),r.$attr_accessor("first_to"),r.$attr_accessor("first_modify"),r.$attr_accessor("rateup"),r.$attr_accessor("greatest_fortune"),r.$attr_accessor("semi_fixed_val"),r.$attr_accessor("tmp_fixed_val"),r.$attr_accessor("modifier"),r.$attr_accessor("modifier_after_half"),r.$attr_accessor("modifier_after_one_and_a_half"),K(r,"$settable_first_roll_adjust_option?",function(){var M;return c(M=this.$first_modify()["$nil?"]())?this.$first_to()["$nil?"]():M}),K(r,"$settable_non_2d_roll_option?",function(){var M,N,k=this;return c(M=c(N=k.$greatest_fortune()["$nil?"]())?k.$semi_fixed_val()["$nil?"]():N)?k.$tmp_fixed_val()["$nil?"]():M})},Opal.modules["bcdice/game_system/sword_world/rating_parser"]=function(e){var p,n,D,T,q,a,v,$,ee,te,re,$e,_e,se,_,b,t,B,g,s,M,N,C,Y=e.module,G=e.klass,c=e.ensure_kwargs,K=e.send2,P=e.find_super,f=e.def,F=e.send,h=e.truthy,z=e.not,H=e.thrower,E=e.hash,Q=e.const_set,V=e.to_ary,j=e.eqeq,U=e.top,A=[],i=e.nil,I=e.$$$;return U.$require("racc/parser.rb"),U.$require("bcdice/arithmetic/node"),U.$require("bcdice/enum"),U.$require("bcdice/game_system/sword_world/rating_lexer"),U.$require("bcdice/game_system/sword_world/rating_parsed"),U.$require("bcdice/game_system/sword_world/rating_options"),p=A,n=C=[Y(A[0],"BCDice")].concat(p),M=[Y(C[0],"GameSystem")].concat(n),N=e.$r(M),D=M,g=[G(M[0],N("Base"),"SwordWorld")].concat(D),s=e.$r(g),T=g,b=[_=G(g[0],I(s("Racc"),"Parser"),"RatingParser")].concat(T),t=e.$r(b),(B=_.$$prototype).lexer=B.round_type=B.version=i,f(_,"$initialize",function Z(y){var S,O,L=this;return Z.$$p=null,null==(S=(y=c(y)).$$smap.version)&&(S="v1_0"),null==(O=y.$$smap.round_type)&&(O=I(t("RoundType"),"CEIL")),K(L,P(L,"initialize",Z,!1,!0),"initialize",[],null),L.version=S,L.round_type=O},-1),f(_,"$set_debug",function(){return this.yydebug=!0,this}),f(_,"$parse",function(y){try{return this.lexer=t("RatingLexer").$new(y),this.$do_parse()}catch(O){if(!e.rescue(O,[t("ParseError"),t("ZeroDivisionError")]))throw O;try{return i}finally{e.pop_exception()}}}),_.$private(),f(_,"$parsed",function(y,S,O){try{return H("eval_return"),F(t("RatingParsed").$new(y,S),"tap",[],function X(W){var ne,ie,ce,fe,oe,de,me,be,he,ge=null==X.$$s?this:X.$$s,ve=i;return null==ge.round_type&&(ge.round_type=i),null==W&&(W=i),W["$kept_modify="](h(ve=(ne=O.$kept_modify())===i||null==ne?i:ne.$eval(ge.round_type))?ve:0),W["$first_to="](h(ve=O.$first_to())?ve:0),W["$first_modify="](h(ve=O.$first_modify())?ve:0),W["$rateup="](h(ve=(ie=O.$rateup())===i||null==ie?i:ie.$eval(ge.round_type))?ve:0),z(O.$greatest_fortune()["$nil?"]())&&W["$greatest_fortune="](O.$greatest_fortune()),W["$semi_fixed_val="](h(ve=(ce=O.$semi_fixed_val())===i||null==ce?i:ce.$clamp(1,6))?ve:0),W["$tmp_fixed_val="](h(ve=(fe=O.$tmp_fixed_val())===i||null==fe?i:fe.$clamp(1,6))?ve:0),W["$modifier_after_half="]((oe=O.$modifier_after_half())===i||null==oe?i:oe.$eval(ge.round_type)),W["$modifier_after_one_and_a_half="]((de=O.$modifier_after_one_and_a_half())===i||null==de?i:de.$eval(ge.round_type)),me=[h((he=O.$critical(),be=he===i||null==he?i:he.$eval(ge.round_type),ve=be===i||null==be?i:be.$clamp(0,13)))?ve:h(W.$half())||h(W.$one_and_a_half())?13:10],F(W,"critical=",me),me[me.length-1]},{$$s:this})}catch(X){if(X===e.t_eval_return)return X.$v;throw X}}),f(_,"$next_token",function(){return this.lexer.$next_token()}),q=e.large_array_unpack("18,16,17,19,6,20,21,23,24,64,65,27,28,13,66,14,22,15,18,16,17,19,5,20,21,23,24,5,9,3,4,13,10,14,22,15,18,16,17,19,11,20,21,23,24,34,5,34,40,13,42,14,22,15,30,31,30,31,33,34,33,34,62,63,62,63,34,43,30,31,30,31,33,34,33,30,31,44,34,33,34,52,30,31,57,34,33,30,31,30,31,33,34,33,30,31,58,34,33,34,60,30,31,61,34,33,30,31,30,31,33,34,33,30,31,,34,33,34,,30,31,,34,33,30,31,30,31,33,36,33,30,31,62,63,33,62,63,37,38,62,63,62,63,62,63"),a=e.large_array_unpack("7,7,7,7,1,7,7,7,7,55,55,12,12,7,55,7,7,7,25,25,25,25,3,25,25,25,25,0,4,0,0,25,5,25,25,25,49,49,49,49,6,49,49,49,49,13,9,14,17,49,19,49,49,49,13,13,14,14,13,16,14,18,46,46,48,48,22,20,16,16,18,18,16,23,18,22,22,21,24,22,27,29,23,23,37,28,23,24,24,27,27,24,30,27,28,28,38,31,28,33,43,30,30,44,40,30,31,31,33,33,31,62,33,40,40,,63,40,64,,62,62,,65,62,63,63,64,64,63,15,64,65,65,50,50,65,51,51,15,15,56,56,69,69,70,70"),v=e.large_array_unpack("24,4,,19,23,30,40,-4,,43,,,0,43,45,128,57,43,59,42,59,69,64,71,76,14,,78,83,63,90,95,,97,,,,82,94,,102,,,98,101,,49,,51,32,121,124,,,,-2,128,,,,,,109,114,116,121,,,,130,132"),$=e.large_array_unpack("-36,-36,-5,-36,-36,-36,-36,-1,-5,-36,-4,71,-6,-36,-36,-36,-12,-36,-36,-36,-36,-36,-36,-36,-36,-2,-5,-36,-36,-36,-36,-36,-33,-36,-35,-8,-9,-36,-36,-13,-14,-16,-17,-36,-36,-20,-21,-30,-22,-3,-23,-24,-7,-31,-32,-36,-27,-10,-11,-15,-18,-19,-36,-36,-36,-36,-34,-28,-29,-25,-26"),ee=e.large_array_unpack("29,35,7,39,1,41,46,48,25,45,50,51,2,55,,8,56,53,54,,,26,,,,,49,59,,,,,,,,,,,,,,,,,,,,69,70,67,68"),te=e.large_array_unpack("5,5,3,5,1,5,6,6,3,5,6,6,2,7,,2,6,5,5,,,2,,,,,3,5,,,,,,,,,,,,,,,,,,,,6,6,5,5"),re=[i,4,12,0,i,-13,-17,-20,i],$e=[i,i,i,i,12,47,i,i,32],_e=e.large_array_unpack("0,0,racc_error,2,23,_reduce_1,3,23,_reduce_2,4,23,_reduce_3,2,24,_reduce_4,0,25,_reduce_5,2,25,_reduce_6,4,25,_reduce_7,3,25,_reduce_8,3,25,_reduce_9,4,25,_reduce_10,4,25,_reduce_11,2,25,_reduce_12,3,25,_reduce_13,3,25,_reduce_14,4,25,_reduce_15,3,25,_reduce_16,3,25,_reduce_17,4,25,_reduce_18,4,25,_reduce_19,3,25,_reduce_20,2,26,_reduce_21,2,26,_reduce_22,3,26,_reduce_23,3,26,_reduce_24,3,29,_reduce_25,3,29,_reduce_26,1,29,_reduce_none,3,28,_reduce_28,3,28,_reduce_29,1,28,_reduce_none,2,27,_reduce_31,2,27,_reduce_32,1,27,_reduce_none,3,30,_reduce_34,1,30,_reduce_35"),se=E(!1,0,"error",1,"NUMBER",2,"K",3,"R",4,"H",5,"O",6,"G",7,"F",8,"S",9,"T",10,"PLUS",11,"MINUS",12,"ASTERISK",13,"SLASH",14,"PARENL",15,"PARENR",16,"BRACKETL",17,"BRACKETR",18,"AT",19,"SHARP",20,"DOLLAR",21),Q(b[0],"Racc_arg",[q,a,$,v,ee,te,$e,re,22,_e,se,71,36,!0]),Q(b[0],"Racc_token_to_s_table",["$end","error","NUMBER","K","R","H","O","G","F","S","T","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","AT","SHARP","DOLLAR","$start","expr","rate","option","modifier","unary","mul","add","term"]),Q(b[0],"Racc_debug_parser",!1),f(_,"$_reduce_1",function(y,S,O){try{H("eval_return");var L,ne,fe,ie=i,ce=i;return ne=null==(L=V(y))[0]?i:L[0],ce=h(fe=(ie=null==L[1]?i:L[1]).$modifier())?fe:I(I(t("Arithmetic"),"Node"),"Number").$new(0),this.$parsed(ne,ce.$eval(this.round_type),ie)}catch(oe){if(oe===e.t_eval_return)return oe.$v;throw oe}}),f(_,"$_reduce_2",function(y,S,O){try{H("eval_return");var L,ie,fe,W=this,ce=i,oe=i;return ie=null==(L=V(y))[1]?i:L[1],h((ce=null==L[2]?i:L[2]).$modifier_after_one_and_a_half())&&W.$raise(t("ParseError")),h(ce.$modifier_after_half())||ce["$modifier_after_half="](I(I(t("Arithmetic"),"Node"),"Number").$new(0)),oe=h(fe=ce.$modifier())?fe:I(I(t("Arithmetic"),"Node"),"Number").$new(0),W.$parsed(ie,oe.$eval(W.round_type),ce)}catch(de){if(de===e.t_eval_return)return de.$v;throw de}}),f(_,"$_reduce_3",function(y,S,O){try{H("eval_return");var L,ie,fe,W=this,ce=i,oe=i;return ie=null==(L=V(y))[2]?i:L[2],h((ce=null==L[3]?i:L[3]).$modifier_after_half())&&W.$raise(t("ParseError")),h(ce.$modifier_after_one_and_a_half())||ce["$modifier_after_one_and_a_half="](I(I(t("Arithmetic"),"Node"),"Number").$new(0)),oe=h(fe=ce.$modifier())?fe:I(I(t("Arithmetic"),"Node"),"Number").$new(0),W.$parsed(ie,oe.$eval(W.round_type),ce)}catch(de){if(de===e.t_eval_return)return de.$v;throw de}}),f(_,"$_reduce_4",function(y,S,O){return y["$[]"](1).$to_i()}),f(_,"$_reduce_5",function(y,S,O){return t("RatingOptions").$new()}),f(_,"$_reduce_6",function(y,S,O){var m,ne,W=i;return ne=null==(m=V(y))[1]?i:m[1],h((W=null==m[0]?i:m[0]).$modifier()["$nil?"]())||this.$raise(t("ParseError")),W["$modifier="](ne),W}),f(_,"$_reduce_7",function(y,S,O){var m,ie,W=i;return ie=null==(m=V(y))[2]?i:m[2],h((W=null==m[0]?i:m[0]).$critical()["$nil?"]())||this.$raise(t("ParseError")),W["$critical="](ie),W}),f(_,"$_reduce_8",function(y,S,O){var m,ie,W=i;return ie=null==(m=V(y))[2]?i:m[2],h((W=null==m[0]?i:m[0]).$critical()["$nil?"]())||this.$raise(t("ParseError")),W["$critical="](ie),W}),f(_,"$_reduce_9",function(y,S,O){var m,W=i,ie=i;return ie=null==(m=V(y))[2]?i:m[2],h((W=null==m[0]?i:m[0])["$settable_first_roll_adjust_option?"]())||this.$raise(t("ParseError")),W["$first_to="](ie.$to_i()),W}),f(_,"$_reduce_10",function(y,S,O){var m,W=i,ie=i;return ie=null==(m=V(y))[3]?i:m[3],h((W=null==m[0]?i:m[0])["$settable_first_roll_adjust_option?"]())||this.$raise(t("ParseError")),W["$first_modify="](ie.$to_i()),W}),f(_,"$_reduce_11",function(y,S,O){var m,W=i,ie=i;return ie=null==(m=V(y))[3]?i:m[3],h((W=null==m[0]?i:m[0])["$settable_first_roll_adjust_option?"]())||this.$raise(t("ParseError")),W["$first_modify="](ie.$to_i()["$-@"]()),W}),f(_,"$_reduce_12",function(y,S,O){var m,W=i;return m=V(y),h((W=null==m[0]?i:m[0]).$modifier_after_half()["$nil?"]())||this.$raise(t("ParseError")),W["$modifier_after_half="](I(I(t("Arithmetic"),"Node"),"Number").$new(0)),W}),f(_,"$_reduce_13",function(y,S,O){var m,ie,W=i;return ie=null==(m=V(y))[2]?i:m[2],h((W=null==m[0]?i:m[0]).$modifier_after_half()["$nil?"]())||this.$raise(t("ParseError")),W["$modifier_after_half="](ie),W}),f(_,"$_reduce_14",function(y,S,O){var m,W=i;return m=V(y),h((W=null==m[0]?i:m[0]).$modifier_after_one_and_a_half())&&this.$raise(t("ParseError")),W["$modifier_after_one_and_a_half="](I(I(t("Arithmetic"),"Node"),"Number").$new(0)),W}),f(_,"$_reduce_15",function(y,S,O){var m,ie,W=i;return ie=null==(m=V(y))[3]?i:m[3],h((W=null==m[0]?i:m[0]).$modifier_after_one_and_a_half())&&this.$raise(t("ParseError")),W["$modifier_after_one_and_a_half="](ie),W}),f(_,"$_reduce_16",function(y,S,O){var m,ie,W=i;return W=null==(m=V(y))[0]?i:m[0],ie=null==m[2]?i:m[2],h(["v2_5","v2_0"]["$include?"](this.version))&&h(W.$rateup()["$nil?"]())||this.$raise(t("ParseError")),W["$rateup="](ie),W}),f(_,"$_reduce_17",function(y,S,O){var m,W=i;return W=null==(m=V(y))[0]?i:m[0],h(["v2_5","v2_0"]["$include?"](this.version))&&h(W["$settable_non_2d_roll_option?"]())||this.$raise(t("ParseError")),W["$greatest_fortune="](!0),W}),f(_,"$_reduce_18",function(y,S,O){var m,W=i,ie=i;return W=null==(m=V(y))[0]?i:m[0],ie=null==m[3]?i:m[3],h(["v2_5","v2_0"]["$include?"](this.version))&&h(W["$settable_non_2d_roll_option?"]())||this.$raise(t("ParseError")),W["$semi_fixed_val="](ie.$to_i()),W}),f(_,"$_reduce_19",function(y,S,O){var m,W=i,ie=i;return W=null==(m=V(y))[0]?i:m[0],ie=null==m[3]?i:m[3],h(["v2_5","v2_0"]["$include?"](this.version))&&h(W["$settable_non_2d_roll_option?"]())||this.$raise(t("ParseError")),W["$tmp_fixed_val="](ie.$to_i()),W}),f(_,"$_reduce_20",function(y,S,O){var m,ie,W=i;return W=null==(m=V(y))[0]?i:m[0],ie=null==m[2]?i:m[2],j(this.version,"v2_5")&&h(W.$kept_modify()["$nil?"]())||this.$raise(t("ParseError")),W["$kept_modify="](ie),W}),f(_,"$_reduce_21",function(y,S,O){return y["$[]"](1)}),f(_,"$_reduce_22",function(y,S,O){return I(I(t("Arithmetic"),"Node"),"Negative").$new(y["$[]"](1))}),f(_,"$_reduce_23",function(y,S,O){return I(I(t("Arithmetic"),"Node"),"BinaryOp").$new(y["$[]"](0),"+",y["$[]"](2))}),f(_,"$_reduce_24",function(y,S,O){return I(I(t("Arithmetic"),"Node"),"BinaryOp").$new(y["$[]"](0),"-",y["$[]"](2))}),f(_,"$_reduce_25",function(y,S,O){return I(I(t("Arithmetic"),"Node"),"BinaryOp").$new(y["$[]"](0),"+",y["$[]"](2))}),f(_,"$_reduce_26",function(y,S,O){return I(I(t("Arithmetic"),"Node"),"BinaryOp").$new(y["$[]"](0),"-",y["$[]"](2))}),f(_,"$_reduce_28",function(y,S,O){return I(I(t("Arithmetic"),"Node"),"BinaryOp").$new(y["$[]"](0),"*",y["$[]"](2))}),f(_,"$_reduce_29",function(y,S,O){return I(I(t("Arithmetic"),"Node"),"DivideWithGameSystemDefault").$new(y["$[]"](0),y["$[]"](2))}),f(_,"$_reduce_31",function(y,S,O){return y["$[]"](1)}),f(_,"$_reduce_32",function(y,S,O){return I(I(t("Arithmetic"),"Node"),"Negative").$new(y["$[]"](1))}),f(_,"$_reduce_34",function(y,S,O){return y["$[]"](1)}),f(_,"$_reduce_35",function(y,S,O){return I(I(t("Arithmetic"),"Node"),"Number").$new(y["$[]"](0))}),f(_,"$_reduce_none",function(y,S,O){return y["$[]"](0)})},Opal.modules["bcdice/game_system/SwordWorld"]=function(e){var M,D,T,_,b,t,q,g,s,R,Y=e.module,G=e.klass,c=e.const_set,K=e.send2,P=e.find_super,f=e.def,F=e.truthy,h=e.rb_ge,z=e.rb_le,H=e.eqeq,E=e.neqeq,Q=e.rb_minus,V=e.rb_gt,j=e.hash2,U=e.send,A=e.to_ary,i=e.rb_plus,I=e.rb_lt,l=e.rb_times,p=e.thrower,u=e.rb_divide,C=e.top,r=[],n=e.nil;return C.$require("bcdice/base"),C.$require("bcdice/game_system/sword_world/rating_parser"),M=r,D=R=[Y(r[0],"BCDice")].concat(M),g=[Y(R[0],"GameSystem")].concat(D),s=e.$r(g),T=g,b=[_=G(g[0],s("Base"),"SwordWorld")].concat(T),t=e.$r(b),(q=_.$$prototype).rating_table=q.randomizer=n,c(b[0],"ID","SwordWorld"),c(b[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c9RPG"),c(b[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u3068"),c(b[0],"HELP_MESSAGE","\u30fbSW\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx[c]+m$f) (x:\u30ad\u30fc, c:\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024, m:\u30dc\u30fc\u30ca\u30b9, f:\u51fa\u76ee\u4fee\u6b63)\n"),_.$register_prefix("H?K"),f(_,"$initialize",function a(v){return a.$$p=null,K(this,P(this,"initialize",a,!1,!0),"initialize",[v],null),this.rating_table=0}),f(_,"$result_2d6",function(v,$,ee,te,re){return F(h($,12))?t("Result").$critical(this.$translate("SwordWorld.critical")):F(z($,2))?t("Result").$fumble(this.$translate("SwordWorld.fumble")):E(te,">=")||H(re,"?")?n:F(h(v,re))?t("Result").$success(this.$translate("success")):t("Result").$failure(this.$translate("failure"))}),f(_,"$eval_game_system_specific_command",function(v){return this.$rating(v)}),_.$private(),f(_,"$rating_parser",function(){return t("RatingParser").$new()}),f(_,"$rating",function(v){var $,ee,te=this,re=n,$e=n,_e=n,le=n,ae=n,se=n,ue=n,J=n,B=n,Z=n,y=n,S=n,O=n,m=n,X=n,W=n;return te.$debug("rating string",v),re=te.$rating_parser().$parse(v),F(re)?($e=te.$getSW2_0_RatingTable(),_e=Q($e.$length(),1),te.$debug("keyMax",_e),F(V(re.$rate(),_e))?t("Result").$new(te.$translate("SwordWorld.keynumber_exceeds",j(["keyMax"],{keyMax:_e}))):F(re["$infinite_roll?"]())?t("Result").$new(te.$translate("SwordWorld.infinite_critical",j(["min_critical"],{min_critical:re.$min_critical()}))):(le=te.$getNewRates($e),ae=re+" \uff1e ",se=[],ue=[],J=[],B=0,Z=0,y=0,S=0,O=re.$first_to(),m=re.$first_modify(),function(){try{var ne=p("break");return U(te,"loop",[],function ie(){var ce,fe,be,he,oe=null==ie.$$s?this:ie.$$s,de=n,me=n;if(fe=oe.$rollDice(re,S),me=null==(ce=A(fe))[1]?n:ce[1],B=de=null==ce[0]?n:ce[0],E(O,0)?(B=de=O,O=0):E(m,0)&&(B=i(B,m),m=0),F(z(de,2))&&(se["$<<"](de.$to_s()),ue["$<<"](me.$to_s()),J["$<<"]("**"),S=i(S,1),ne.$throw()),E(re.$kept_modify(),0)&&E(B,2)&&(B=i(B,re.$kept_modify())),F(I(B,2))&&(B=2),F(V(B,12))&&(B=12),be=[i(re.$rate(),l(S,re.$rateup())),_e].$min(),oe.$debug("currentKey",be),he=le["$[]"](B)["$[]"](be),oe.$debug("rateValue",he),y=i(y,he),Z=i(Z,B),se["$<<"](B.$to_s()),ue["$<<"](me.$to_s()),J["$<<"](F(V(B,2))?he:"**"),S=i(S,1),F(h(B,re.$critical())))return n;ne.$throw()},{$$s:te})}catch(ie){if(ie===ne)return ie.$v;throw ie}}(),ee=te.$getResultText(y,re,ue,se,J,Z,S),$=A(ee),X=null==$[1]?n:$[1],W=null==$[2]?n:$[2],ae=i(ae,null==$[0]?n:$[0]),U(t("Result").$new(),"tap",[],function(ie){var ce;return null==ie&&(ie=n),ie["$text="](ae),ie["$critical="](X),U(ie,"fumble=",ce=[W]),ce[ce.length-1]}))):(te.$debug("not matched"),"1")}),f(_,"$getSW2_0_RatingTable",function(){return["*,0,0,0,1,2,2,3,3,4,4","*,0,0,0,1,2,3,3,3,4,4","*,0,0,0,1,2,3,4,4,4,4","*,0,0,1,1,2,3,4,4,4,5","*,0,0,1,2,2,3,4,4,5,5","*,0,1,1,2,2,3,4,5,5,5","*,0,1,1,2,3,3,4,5,5,5","*,0,1,1,2,3,4,4,5,5,6","*,0,1,2,2,3,4,4,5,6,6","*,0,1,2,3,3,4,4,5,6,7","*,1,1,2,3,3,4,5,5,6,7","*,1,2,2,3,3,4,5,6,6,7","*,1,2,2,3,4,4,5,6,6,7","*,1,2,3,3,4,4,5,6,7,7","*,1,2,3,4,4,4,5,6,7,8","*,1,2,3,4,4,5,5,6,7,8","*,1,2,3,4,4,5,6,7,7,8","*,1,2,3,4,5,5,6,7,7,8","*,1,2,3,4,5,6,6,7,7,8","*,1,2,3,4,5,6,7,7,8,9","*,1,2,3,4,5,6,7,8,9,10","*,1,2,3,4,6,6,7,8,9,10","*,1,2,3,5,6,6,7,8,9,10","*,2,2,3,5,6,7,7,8,9,10","*,2,3,4,5,6,7,7,8,9,10","*,2,3,4,5,6,7,8,8,9,10","*,2,3,4,5,6,8,8,9,9,10","*,2,3,4,6,6,8,8,9,9,10","*,2,3,4,6,6,8,9,9,10,10","*,2,3,4,6,7,8,9,9,10,10","*,2,4,4,6,7,8,9,10,10,10","*,2,4,5,6,7,8,9,10,10,11","*,3,4,5,6,7,8,10,10,10,11","*,3,4,5,6,8,8,10,10,10,11","*,3,4,5,6,8,9,10,10,11,11","*,3,4,5,7,8,9,10,10,11,12","*,3,5,5,7,8,9,10,11,11,12","*,3,5,6,7,8,9,10,11,12,12","*,3,5,6,7,8,10,10,11,12,13","*,4,5,6,7,8,10,11,11,12,13","*,4,5,6,7,9,10,11,11,12,13","*,4,6,6,7,9,10,11,12,12,13","*,4,6,7,7,9,10,11,12,13,13","*,4,6,7,8,9,10,11,12,13,14","*,4,6,7,8,10,10,11,12,13,14","*,4,6,7,9,10,10,11,12,13,14","*,4,6,7,9,10,10,12,13,13,14","*,4,6,7,9,10,11,12,13,13,15","*,4,6,7,9,10,12,12,13,13,15","*,4,6,7,10,10,12,12,13,14,15","*,4,6,8,10,10,12,12,13,15,15","*,5,7,8,10,10,12,12,13,15,15","*,5,7,8,10,11,12,12,13,15,15","*,5,7,9,10,11,12,12,14,15,15","*,5,7,9,10,11,12,13,14,15,16","*,5,7,10,10,11,12,13,14,16,16","*,5,8,10,10,11,12,13,15,16,16","*,5,8,10,11,11,12,13,15,16,17","*,5,8,10,11,12,12,13,15,16,17","*,5,9,10,11,12,12,14,15,16,17","*,5,9,10,11,12,13,14,15,16,18","*,5,9,10,11,12,13,14,16,17,18","*,5,9,10,11,13,13,14,16,17,18","*,5,9,10,11,13,13,15,17,17,18","*,5,9,10,11,13,14,15,17,17,18","*,5,9,10,12,13,14,15,17,18,18","*,5,9,10,12,13,15,15,17,18,19","*,5,9,10,12,13,15,16,17,19,19","*,5,9,10,12,14,15,16,17,19,19","*,5,9,10,12,14,16,16,17,19,19","*,5,9,10,12,14,16,17,18,19,19","*,5,9,10,13,14,16,17,18,19,20","*,5,9,10,13,15,16,17,18,19,20","*,5,9,10,13,15,16,17,19,20,21","*,6,9,10,13,15,16,18,19,20,21","*,6,9,10,13,16,16,18,19,20,21","*,6,9,10,13,16,17,18,19,20,21","*,6,9,10,13,16,17,18,20,21,22","*,6,9,10,13,16,17,19,20,22,23","*,6,9,10,13,16,18,19,20,22,23","*,6,9,10,13,16,18,20,21,22,23","*,6,9,10,13,17,18,20,21,22,23","*,6,9,10,14,17,18,20,21,22,24","*,6,9,11,14,17,18,20,21,23,24","*,6,9,11,14,17,19,20,21,23,24","*,6,9,11,14,17,19,21,22,23,24","*,7,10,11,14,17,19,21,22,23,25","*,7,10,12,14,17,19,21,22,24,25","*,7,10,12,14,18,19,21,22,24,25","*,7,10,12,15,18,19,21,22,24,26","*,7,10,12,15,18,19,21,23,25,26","*,7,11,13,15,18,19,21,23,25,26","*,7,11,13,15,18,20,21,23,25,27","*,8,11,13,15,18,20,22,23,25,27","*,8,11,13,16,18,20,22,23,25,28","*,8,11,14,16,18,20,22,23,26,28","*,8,11,14,16,19,20,22,23,26,28","*,8,12,14,16,19,20,22,24,26,28","*,8,12,15,16,19,20,22,24,27,28","*,8,12,15,17,19,20,22,24,27,29","*,8,12,15,18,19,20,22,24,27,30"]}),f(_,"$getNewRates",function(v){var $,ee,re=n,$e=n,_e=n,le=n,ae=n,se=n,ue=n,J=n,B=n,Z=n,y=n;return re=[],$e=[],_e=[],le=[],ae=[],se=[],ue=[],J=[],B=[],Z=[],y=[],U(v,"each",[],function(m){var L=n;return null==m&&(m=n),L=m.$split(/,/),y.$push(0),re.$push(L["$[]"](1).$to_i()),$e.$push(L["$[]"](2).$to_i()),_e.$push(L["$[]"](3).$to_i()),le.$push(L["$[]"](4).$to_i()),ae.$push(L["$[]"](5).$to_i()),se.$push(L["$[]"](6).$to_i()),ue.$push(L["$[]"](7).$to_i()),J.$push(L["$[]"](8).$to_i()),B.$push(L["$[]"](9).$to_i()),Z.$push(L["$[]"](10).$to_i())}),H(this.rating_table,1)&&Z["$[]="](31,($=[32,(ee=[33,10],U(Z,"[]=",ee),ee[ee.length-1])],U(Z,"[]=",$),$[$.length-1])),[y,y,y,re,$e,_e,le,ae,se,ue,J,B,Z]}),f(_,"$rollDice",function(v,$){var te=n;return[(te=this.randomizer.$roll_barabara(2,6)).$sum(),te.$join(",")]}),f(_,"$getResultText",function(v,$,ee,te,re,$e,_e){var ae=n,se=n,ue=n,J=n,B=n;return(ae=[]).$push("2D:["+ee.$join(" ")+"]="+te.$join(",")),F(z($e,2))?(ae.$push(re.$join(",")),ae.$push(this.$translate("SwordWorld.fumble")),[ae.$join(" \uff1e "),!1,!0]):(F(V(re.$size(),1))||E($.$modifier(),0)?(se=i(re.$join(","),t("Format").$modifier($.$modifier())),F($.$half())?(se="("+se+")/2",E($.$modifier_after_half(),0)&&(se=i(se,t("Format").$modifier($.$modifier_after_half())))):F($.$one_and_a_half())&&(se="("+se+")*1.5",E($.$modifier_after_one_and_a_half(),0)&&(se=i(se,t("Format").$modifier($.$modifier_after_one_and_a_half())))),ae.$push(se)):F($.$half())?(se=re.$first()+"/2",E($.$modifier_after_half(),0)&&(se=i(se,t("Format").$modifier($.$modifier_after_half()))),ae.$push(se)):F($.$one_and_a_half())&&(se=re.$first()+"*1.5",E($.$modifier_after_one_and_a_half(),0)&&(se=i(se,t("Format").$modifier($.$modifier_after_one_and_a_half()))),ae.$push(se)),F(V(_e,1))&&(ue=this.$translate("SwordWorld.round_text",j(["reroll_count"],{reroll_count:Q(_e,1)})),ae.$push(ue)),J=i(v,$.$modifier()),F($.$half())?(J=u(J,2).$ceil(),E($.$modifier_after_half(),0)&&(J=i(J,$.$modifier_after_half()))):F($.$one_and_a_half())&&(J=l(J,1.5).$ceil(),E($.$modifier_after_one_and_a_half(),0)&&(J=i(J,$.$modifier_after_one_and_a_half()))),B=J.$to_s(),ae.$push(B),[ae.$join(" \uff1e "),V(_e,1),!1])})},Opal.modules["bcdice/game_system/sword_world/transcendent_test"]=function(e){var j,I,n,x,D,w,g,s,M,p,u,A,Y=e.module,G=e.klass,c=e.def,K=e.truthy,P=e.rb_lt,f=e.hash2,F=e.rb_ge,h=e.rb_plus,z=e.send,H=e.top,E=[],Q=e.nil;return H.$require("bcdice/result"),H.$require("bcdice/translate"),j=E,I=A=[Y(E[0],"BCDice")].concat(j),p=[Y(A[0],"GameSystem")].concat(I),u=e.$r(p),n=p,x=M=[G(p[0],u("SwordWorld"),"SwordWorld2_0")].concat(n),w=[D=G(M[0],null,"TranscendentTest")].concat(x),g=e.$r(w),(s=D.$$prototype).modifier=s.critical_value=s.expression=s.modifier_str=s.target=s.cmp_op=Q,D.$include(g("Translate")),c(D,"$initialize",function(o,T,_,b,t){var q=this;return q.critical_value=o,q.modifier=T,q.cmp_op=_,q.target=b,q.locale=t,q.modifier_str=g("Format").$modifier(q.modifier),q.expression=q.$node_expression()}),c(D,"$execute",function(o){var t,q,a,T=this,_=Q,b=Q,v=Q,$=Q,ee=Q,te=Q;if(K(P(T.critical_value,3)))return T.$translate("SwordWorld2_0.transcendent_critical_too_small",f(["expression"],{expression:T.expression}));if(b=[_=o.$roll_barabara(2,6)],t=_["$=="]([1,1]),q=_["$=="]([6,6]),!K(t))for(;K(F(T.$sum_of_dice(b.$last()),T.critical_value));)b.$push(o.$roll_barabara(2,6));return a=T.$sum_of_dice(b),v=h(a,T.modifier),$=T.$result_status(v,b.$length(),t,q),ee=f(["success","failure","super_success","critical","fumble"],{success:T.$translate("success"),failure:T.$translate("failure"),super_success:T.$translate("SwordWorld2_0.super_success"),critical:T.$translate("SwordWorld.critical"),fumble:T.$translate("SwordWorld.fumble")}).$freeze()["$[]"]($),te=["("+T.expression+")",""+T.$dice_str(b,a)+T.modifier_str,v,ee].$compact(),z(g("Result").$new(),"tap",[],function($e){var _e;return null==$e&&($e=Q),$e["$text="](te.$join(" \uff1e ")),$e["$fumble="]($["$=="]("fumble")),$e["$critical="]($["$=="]("critical")),$e["$success="](["success","super_success","critical"]["$include?"]($)),_e=[["failure","fumble"]["$include?"]($)],z($e,"failure=",_e),_e[_e.length-1]})}),D.$private(),c(D,"$node_expression",function(){var T,o=this;return T="2D6@"+o.critical_value+o.modifier_str,K(o.target)?""+T+o.cmp_op+o.target:T}),c(D,"$sum_of_dice",function(o){return o.$flatten().$sum()}),c(D,"$dice_str",function(o,T){return""+T+z(o,"map",[],function(t){return null==t&&(t=Q),"["+t.$join(",")+"]"}).$join()}),c(D,"$result_status",function(o,T,_,b){var t=this;return K(t.target)?K(_)?"fumble":K(b)?"critical":K(o.$send(t.cmp_op,t.target))?K(F(T,2))&&K(F(o,41))?"super_success":"success":"failure":"no_target"})},Opal.modules["bcdice/game_system/SwordWorld2_0"]=function(e){var u,k,w,g,s,d,o,N,R,r,Y=e.module,G=e.klass,c=e.const_set,K=e.send2,P=e.find_super,f=e.def,F=e.eqeqeq,h=e.truthy,z=e.hash2,H=e.rb_gt,E=e.rb_plus,Q=e.eqeq,V=e.rb_times,j=e.send,U=e.neqeq,A=e.top,i=[],I=e.nil,l=e.$$$;return A.$require("bcdice/arithmetic_evaluator"),A.$require("bcdice/game_system/SwordWorld"),A.$require("bcdice/game_system/sword_world/transcendent_test"),u=i,k=r=[Y(i[0],"BCDice")].concat(u),N=[Y(r[0],"GameSystem")].concat(k),R=e.$r(N),w=N,s=[g=G(N[0],R("SwordWorld"),"SwordWorld2_0")].concat(w),d=e.$r(s),(o=g.$$prototype).locale=o.randomizer=I,c(s[0],"ID","SwordWorld2.0"),c(s[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.0"),c(s[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u30682.0"),c(s[0],"HELP_MESSAGE",'\u81ea\u52d5\u7684\u6210\u529f\u3001\u6210\u529f\u3001\u5931\u6557\u3001\u81ea\u52d5\u7684\u5931\u6557\u306e\u81ea\u52d5\u5224\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx)\n\u3000"K\u30ad\u30fc\u30ca\u30f3\u30d0\u30fc+\u30dc\u30fc\u30ca\u30b9"\u306e\u5f62\u3067\u8a18\u5165\u3057\u307e\u3059\u3002\n\u3000\u30dc\u30fc\u30ca\u30b9\u306e\u90e8\u5206\u306b\u300cK20+K30\u300d\u306e\u3088\u3046\u306b\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u53d6\u308b\u3053\u3068\u306f\u51fa\u6765\u307e\u305b\u3093\u3002\n\u3000\u307e\u305f\u3001\u30dc\u30fc\u30ca\u30b9\u306f\u8907\u6570\u53d6\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3082\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u3068\u540c\u69d8\u306b\u3001\u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306b\u96a0\u308c\u3066\u30ed\u30fc\u30eb\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20\u3000\u3000\u3000K10+5\u3000\u3000\u3000k30\u3000\u3000\u3000k10+10\u3000\u3000\u3000Sk10-1\u3000\u3000\u3000k10+5+2\n\n\u30fb\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306e\u8a2d\u5b9a\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306f"[\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024]"\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u3000\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u306f\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502410\u3068\u3057\u307e\u3059\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u51e6\u7406\u304c\u5fc5\u8981\u306a\u3044\u3068\u304d\u306f13\u306a\u3069\u3068\u3057\u3066\u304f\u3060\u3055\u3044\u3002(\u9632\u5fa1\u6642\u306a\u3069\u306e\u5bfe\u5fdc)\n\u3000\u307e\u305f\u30bf\u30a4\u30d7\u306e\u8efd\u6e1b\u5316\u306e\u305f\u3081\u306b\u672b\u5c3e\u306b\u300c@\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u300d\u3067\u3082\u51e6\u7406\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\u3000\u4f8b\uff09K20[10]\u3000\u3000\u3000K10+5[9]\u3000\u3000\u3000k30[10]\u3000\u3000\u3000k10[9]+10\u3000\u3000\u3000k10-5@9\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u534a\u6e1b (HKx, KxH+N)\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u5148\u982d\u307e\u305f\u306f\u672b\u5c3e\u306b"H"\u3092\u3064\u3051\u308b\u3068\u3001\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3092\u632f\u3063\u3066\u6700\u7d42\u7d50\u679c\u3092\u534a\u6e1b\u3055\u305b\u307e\u3059\u3002\n\u3000\u672b\u5c3e\u306b\u3064\u3051\u305f\u5834\u5408\u3001\u76f4\u5f8c\u306b\u4fee\u6b63\u3092\u3092\u3064\u3051\u308b\u3053\u3068\u3067\u3001\u534a\u6e1b\u5f8c\u306e\u52a0\u6e1b\u7b97\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3000\u3053\u306e\u969b\u3001\u8907\u6570\u306e\u9805\u306b\u3088\u308b\u4fee\u6b63\u306b\u306f\u30ab\u30c3\u30b3\u3067\u56f2\u3046\u3053\u3068\u304c\u5fc5\u8981\u3067\u3059\uff08\u30ab\u30c3\u30b3\u304c\u306a\u3044\u3068\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3059\uff09\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3092\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u306a\u3057\u3068\u6271\u308f\u308c\u307e\u3059\u3002\n\u3000\u4f8b\uff09HK20\u3000\u3000K20h\u3000\u3000HK10-5@9\u3000\u3000K10-5@9H\u3000\u3000K20gfH\u3000\u3000K20+8H+2\u3000\u3000K20+8H(1+1)\n\n\u30fb\u30c0\u30a4\u30b9\u76ee\u306e\u4fee\u6b63\uff08\u904b\u547d\u5909\u8ee2\u3084\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30ec\u30a4\u7528\uff09\n\u3000\u672b\u5c3e\u306b\u300c$\u4fee\u6b63\u5024\u300d\u3067\u30c0\u30a4\u30b9\u76ee\u306b\u4fee\u6b63\u304c\u304b\u304b\u308a\u307e\u3059\u3002\n\u3000$\uff0b\uff11\u3068\u4fee\u6b63\u8868\u8a18\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u306b\uff0b\u4fee\u6b63\u3001\uff04\uff19\u306e\u3088\u3046\u306b\u56fa\u5b9a\u5024\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u3092\u305d\u306e\u51fa\u76ee\u306b\u5dee\u3057\u66ff\u3048\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3057\u305f\u5834\u5408\u3067\u3082\u56fa\u5b9a\u5024\u3084\u4fee\u6b63\u5024\u306e\u9069\u7528\u306f\u6700\u521d\u306e\u4e00\u56de\u3060\u3051\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20$+1\u3000\u3000\u3000K10+5$9\u3000\u3000\u3000k10-5@9$+2\u3000\u3000\u3000k10[9]+10$9\n\n\u30fb\u9996\u5207\u308a\u5200\u7528\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u4e0a\u6607 r10\n\u3000\u4f8b\uff09K20r10\u3000K30+24@8R10\u3000K40+24@8$12r10\n\n\u30fb\u30b0\u30ec\u30a4\u30c6\u30b9\u30c8\u30d5\u30a9\u30fc\u30c1\u30e5\u30f3\u306f\u672b\u5c3e\u306b gf\n\u3000\u4f8b\uff09K20gf\u3000K30+24@8GF\u3000K40+24@8$12r10gf\n\n\u30fb\u5a01\u529b\u8868\u30921d+sf\u3067\u53c2\u7167 \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5f8c\u3082\u7d99\u7d9a sf4\n\u3000\u4f8b\uff09k10sf4\u3000k0+5SF4@13\u3000k70+26sf3@9\n\n\u30fb\u5a01\u529b\u8868\u30921d+tf\u3067\u53c2\u7167 \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5f8c\u306f2d\u3067\u53c2\u7167 tf3\n\u3000\u4f8b\uff09k10tf3\u3000k0+5TF4@13\u3000k70+26tf3@9\n\n\u30fb\u8d85\u8d8a\u5224\u5b9a\u7528\u306b2d6\u30ed\u30fc\u30eb\u306b 2D6@10 \u66f8\u5f0f\u3067\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u4ed8\u4e0e\u304c\u53ef\u80fd\u306b\u3002\n\u3000\u4f8b\uff092D6@10\u30002D6@10+11>=30\n\n\u30fb\u6210\u9577\u3000(Gr)\n\u3000\u672b\u5c3e\u306b\u6570\u5b57\u3092\u4ed8\u52a0\u3059\u308b\u3053\u3068\u3067\u3001\u8907\u6570\u56de\u306e\u6210\u9577\u3092\u307e\u3068\u3081\u3066\u884c\u3048\u307e\u3059\u3002\n\u3000\u4f8b\uff09Gr3\n\n\u30fb\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3000(FT)\n\u3000\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30fb\u7d61\u307f\u52b9\u679c\u8868\u3000(TT)\n\u3000\u7d61\u307f\u52b9\u679c\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n'),g.$register_prefix("H?K","Gr","2D6?@\\d+","FT","TT"),f(g,"$initialize",function T(_){var t=this;return T.$$p=null,K(t,P(t,"initialize",T,!1,!0),"initialize",[_],null),t.rating_table=2}),f(g,"$eval_game_system_specific_command",function T(_){var q,t=this,v=I;return T.$$p=null,F(/^Gr(\d+)?/i,q=_)?h(_["$=~"](/^Gr(\d+)/i))?t.$growth(d("Regexp").$last_match(1).$to_i()):t.$growth():F(/^2D6?@\d+/i,q)?(v=l(d("Command"),"Parser").$new(/2D6?/i,z(["round_type"],{round_type:l(l(d("BCDice"),"RoundType"),"CEIL")})).$enable_critical().$restrict_cmp_op_to(I,">=",">").$parse(_),h(v)?d("TranscendentTest").$new(v.$critical(),v.$modify_number(),v.$cmp_op(),v.$target_number(),t.locale).$execute(t.randomizer):I):F("FT",q)?t.$get_fumble_table():F("TT",q)?t.$get_tangle_table():K(t,P(t,"eval_game_system_specific_command",T,!1,!0),"eval_game_system_specific_command",[_],null)}),f(g,"$rating_parser",function(){return d("RatingParser").$new(z(["version"],{version:"v2_0"}))}),f(g,"$rollDice",function T(_,b){var q=this,a=I;return T.$$p=null,h(H(_.$semi_fixed_val(),0))?(a=q.randomizer.$roll_once(6),[E(a,_.$semi_fixed_val()),a+","+_.$semi_fixed_val()]):Q(b,0)&&h(H(_.$tmp_fixed_val(),0))?(a=q.randomizer.$roll_once(6),[E(a,_.$tmp_fixed_val()),a+","+_.$tmp_fixed_val()]):h(_.$greatest_fortune())?(a=q.randomizer.$roll_once(6),[V(a,2),a+","+a]):K(q,P(q,"rollDice",T,!1,!0),"rollDice",[_,b],null)}),f(g,"$growth",function(_){return null==_&&(_=1),j(e.Range.$new(1,_,!1),"map",[],function t(){return(null==t.$$s?this:t.$$s).$growth_step()},{$$s:this}).$join(" | ")},-1),f(g,"$growth_step",function(){var _=this,b=I,t=I,q=I;return t=(b=l(d("DiceTable"),"Table").$from_i18n("SwordWorld2_0.GrowthTable",_.locale)).$roll(_.randomizer),q=b.$roll(_.randomizer),U(t.$value(),q.$value())?"["+t.$value()+","+q.$value()+"]->("+t.$body()+" or "+q.$body()+")":"["+t.$value()+","+q.$value()+"]->("+t.$body()+")"}),f(g,"$get_fumble_table",function(){return l(d("DiceTable"),"Table").$from_i18n("SwordWorld2_0.FumbleTable",this.locale).$roll(this.randomizer)}),f(g,"$get_tangle_table",function(){return l(d("DiceTable"),"Table").$from_i18n("SwordWorld2_0.TangleTable",this.locale).$roll(this.randomizer)})},Opal.queue(function(e){var E,U,u,C,r,i,I,V,Y=e.module,G=e.klass,c=e.const_set,K=e.send2,P=e.find_super,f=e.def,h=[];return e.top.$require("bcdice/game_system/SwordWorld2_0"),E=h,U=V=[Y(h[0],"BCDice")].concat(E),i=[Y(V[0],"GameSystem")].concat(U),I=e.$r(i),u=i,c((r=[C=G(i[0],I("SwordWorld2_0"),"SwordWorld2_0_SimplifiedChinese")].concat(u))[0],"ID","SwordWorld2.0:SimplifiedChinese"),c(r[0],"NAME","\u5251\u4e16\u754c2.0"),c(r[0],"SORT_KEY","\u56fd\u969b\u5316:Simplified Chinese:\u5251\u4e16\u754c2.0"),c(r[0],"HELP_MESSAGE","\u81ea\u52a8\u6210\u529f\u3001\u6210\u529f\u3001\u5931\u8d25\u3001\u81ea\u52a8\u5931\u8d25\u4f1a\u81ea\u52a8\u5224\u5b9a\u3002\n\n  \u30fb\u5a01\u529b\u8868\u3000(Kx)\n  \u3000\u6307\u4ee4\u4e3a\u201cK\u5a01\u529b\u503c+\u52a0\u503c\u201d\u7684\u683c\u5f0f\u3002\n  \u3000\u52a0\u503c\u7684\u90e8\u5206\u4e0d\u80fd\u662f\u50cf\u201cK20+K30\u201d\u8fd9\u6837\u7684\u5a01\u529b\u7684\u5199\u6cd5\u3002\n  \u3000\u53e6\u5916\uff0c\u52a0\u503c\u53ef\u4ee5\u6709\u591a\u4e2a\u3002\n  \u3000\u5a01\u529b\u8868\u548c\u9ab0\u70b9\u4e00\u6837\uff0c\u53ef\u4ee5\u5bf9\u5176\u4ed6\u73a9\u5bb6\u9690\u85cf\u3002\n  \u3000\u4f8b\uff09K20\u3000\u3000\u3000K10+5\u3000\u3000\u3000k30\u3000\u3000\u3000k10+10\u3000\u3000\u3000Sk10-1\u3000\u3000\u3000k10+5+2\n\n  \u30fb\u66b4\u51fb\u503c\u7684\u8bbe\u5b9a\n  \u3000\u66b4\u51fb\u503c\u901a\u8fc7\u201c[\u66b4\u51fb\u503c]\u201d\u6307\u5b9a\u3002\n  \u3000\u6ca1\u6709\u6307\u5b9a\u66b4\u51fb\u503c\u65f6\u9ed8\u8ba4\u4e3a10\u3002\n  \u3000\u5982\u679c\u4e0d\u9700\u8981\u53d1\u751f\u66b4\u51fb\uff0c\u8bf7\u8bbe\u5b9a\u4e3a13\u3002\uff08\u4f8b\u5982\u9632\u5fa1\u65f6\uff09\n  \u3000\u53e6\u5916\u4e5f\u53ef\u5199\u6210\u7ed3\u5c3e\u7684\u201c@\u66b4\u51fb\u503c\u201d\u7684\u5f62\u5f0f\u3002\n  \u3000\u4f8b\uff09K20[10]\u3000\u3000\u3000K10+5[9]\u3000\u3000\u3000k30[10]\u3000\u3000\u3000k10[9]+10\u3000\u3000\u3000k10-5@9\n\n  \u30fb\u5a01\u529b\u8868\u7684\u51cf\u534a (HKx, KxH+N)\n  \u3000\u5728\u5a01\u529b\u8868\u5f00\u5934\u6216\u672b\u5c3e\u52a0\u4e0a\u201cH\u201d\uff0c\u9ab0\u5a01\u529b\u8868\u7684\u6700\u7ec8\u7ed3\u679c\u5c31\u4f1a\u51cf\u534a\u3002\n  \u3000H\u5199\u5728\u5a01\u529b\u8868\u672b\u5c3e\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u5728\u540e\u9762\u76f4\u63a5\u8ddf\u7740\u4fee\u6b63\uff0c\u4f1a\u5728\u51cf\u534a\u540e\u8fdb\u884c\u52a0\u51cf\u8fd0\u7b97\u3002\n  \u3000\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u591a\u4e2a\u4fee\u6b63\u9700\u8981\u7528\u62ec\u53f7\u62ec\u8d77\u6765\uff08\u5426\u5219\u4f1a\u89e3\u6790\u5931\u8d25\uff09\n  \u3000\u6ca1\u6709\u6307\u5b9a\u66b4\u51fb\u503c\u7684\u60c5\u51b5\u4e0b\uff0c\u5219\u89c6\u4e3a\u6ca1\u6709\u66b4\u51fb\u503c\u3002\n  \u3000\u4f8b\uff09HK20\u3000\u3000K20h\u3000\u3000HK10-5@9\u3000\u3000K10-5@9H\u3000\u3000K20gfH\u3000\u3000K20+8H+2\u3000\u3000K20+8H+(1+1)\n\n  \u30fb\u9ab0\u5b50\u51fa\u76ee\u4fee\u6b63\uff08\u547d\u8fd0\u53d8\u8f6c\u6216\u91cd\u51fb\u5149\u8f89\u7528\uff09\n  \u3000\u5728\u6307\u4ee4\u672b\u5c3e\u6dfb\u52a0\u201c$\u4fee\u6b63\u503c\u201d\u6765\u6539\u53d8\u9ab0\u5b50\u51fa\u76ee\u3002\n  \u3000\u53ef\u4ee5\u4f7f\u7528$+1\u7684\u683c\u5f0f\u5728\u9ab0\u5b50\u51fa\u76ee\u4e0a+\u4fee\u6b63\uff0c\u6216\u4f7f\u7528$9\u7684\u683c\u5f0f\u628a\u9ab0\u5b50\u51fa\u76ee\u66ff\u6362\u4e3a\u56fa\u5b9a\u503c\u3002\n  \u3000\u66b4\u51fb\u65f6\u53ea\u6709\u7b2c\u4e00\u6b21\u51fa\u76ee\u5e94\u7528\u8fd9\u4e2a\u4fee\u6b63\u3002\n  \u3000\u4f8b\uff09K20$+1\u3000\u3000\u3000K10+5$9\u3000\u3000\u3000k10-5@9$+2\u3000\u3000\u3000k10[9]+10$9\n\n  \u30fb\u5a01\u529b\u4e0a\u5347\uff08\u65a9\u9996\u5200\u7528\uff09 r10\n  \u3000r\u540e\u8ddf\u4e0a\u5347\u503c\uff0c\u66b4\u51fb\u540e\u5a01\u529b\u4e0a\u5347r\u540e\u6240\u586b\u5199\u7684\u4e0a\u5347\u503c\u70b9\n  \u3000\u4f8b\uff09K20r10\u3000K30+24@8R10\u3000K40+24@8$12r10\n\n  \u30fb\u6781\u9650\u547d\u8fd0\u5728\u672b\u5c3e\u52a0\u4e0a gf\n  \u3000\u4f8b\uff09K20gf\u3000K30+24@8GF\u3000K40+24@8$12r5gf\n\n  \u30fb\u5a01\u529b\u8868\u4f7f\u75281d+\u56fa\u5b9a\u503c\u5bf9\u5e94 \u66b4\u51fb\u540e\u4ecd\u7ee7\u7eed sf4\n  \u3000\u4f8b\uff09k10sf4\u3000k0+5sf4@13\u3000k70+26sf3@9\n\n  \u30fb\u5a01\u529b\u8868\u4f7f\u75281d+\u56fa\u5b9a\u503c\u5bf9\u5e94 \u66b4\u51fb\u540e\u53d8\u56de\u4f7f\u75282d\u5bf9\u5e94 tf3\n  \u3000\u4f8b\uff09k10tf3\u3000k0+5tf4@13\u3000k70+26tf3@9\n\n  \u30fb\u8d85\u8d8a\u5224\u5b9a\u75282d6\u53ef\u5199\u6210 2d6@10 \u7684\u683c\u5f0f\u52a0\u4e0a\u66b4\u51fb\u503c\u3002\n  \u3000\u4f8b\uff092D6@10\u30002D6@10+11>=30\n\n  \u30fb\u6210\u957f\u3000(Gr)\n  \u3000\u5728Gr\u540e\u9762\u52a0\u4e0a\u6570\u5b57\u53ef\u4ee5\u8fdb\u884c\u591a\u6b21\u6210\u957f\u3002\n  \u3000\u4f8b\uff09Gr3\n\n  \u30fb\u9632\u5fa1\u5927\u5931\u8d25\u8868\u3000(FT)\n  \u3000\u62bd\u53d6\u9632\u5fa1\u5927\u5931\u8d25\u8868\u3002\n\n  \u30fb\u7f20\u7ed5\u6548\u679c\u8868\u3000(TT)\n  \u3000\u62bd\u53d6\u7f20\u7ed5\u6548\u679c\u8868\u3002\n"),C.$register_prefix_from_super_class(),f(C,"$initialize",function n(k){var N=this;return n.$$p=null,K(N,P(N,"initialize",n,!1,!0),"initialize",[k],null),N.locale="zh_hans"})})}}]);