(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[179],{383:(E,le,_e)=>{"use strict";_e.r(le),_e.d(le,{default:()=>_});var d=_e(5861),H=_e(3604),J=_e.n(H);class _ extends(J()){dynamicImportI18n(O,x){return(0,d.Z)(function*(){return(yield _e(6507)(`./${O}.${x}.json`)).default})()}dynamicImport(O){return(0,d.Z)(function*(){yield _e(85)(`./${O}`)})()}}},113:(E,le,_e)=>{"use strict";function d(t){return"function"==typeof t}function H(t){const e=t(i=>{Error.call(i),i.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const J=H(t=>function(e){t(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function _(t,n){if(t){const e=t.indexOf(n);0<=e&&t.splice(e,1)}}class w{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const o of e)o.remove(this);else e.remove(this);const{initialTeardown:i}=this;if(d(i))try{i()}catch(o){n=o instanceof J?o.errors:[o]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const o of r)try{K(o)}catch(s){n=n??[],s instanceof J?n=[...n,...s.errors]:n.push(s)}}if(n)throw new J(n)}}add(n){var e;if(n&&n!==this)if(this.closed)K(n);else{if(n instanceof w){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(n)}}_hasParent(n){const{_parentage:e}=this;return e===n||Array.isArray(e)&&e.includes(n)}_addParent(n){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(n),e):e?[e,n]:n}_removeParent(n){const{_parentage:e}=this;e===n?this._parentage=null:Array.isArray(e)&&_(e,n)}remove(n){const{_finalizers:e}=this;e&&_(e,n),n instanceof w&&n._removeParent(this)}}w.EMPTY=(()=>{const t=new w;return t.closed=!0,t})();const O=w.EMPTY;function x(t){return t instanceof w||t&&"closed"in t&&d(t.remove)&&d(t.add)&&d(t.unsubscribe)}function K(t){d(t)?t():t.unsubscribe()}const V={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},A={setTimeout(t,n,...e){const{delegate:i}=A;return i?.setTimeout?i.setTimeout(t,n,...e):setTimeout(t,n,...e)},clearTimeout(t){const{delegate:n}=A;return(n?.clearTimeout||clearTimeout)(t)},delegate:void 0};function U(t){A.setTimeout(()=>{const{onUnhandledError:n}=V;if(!n)throw t;n(t)})}function N(){}const Y=re("C",void 0,void 0);function re(t,n,e){return{kind:t,value:n,error:e}}let z=null;function q(t){if(V.useDeprecatedSynchronousErrorHandling){const n=!z;if(n&&(z={errorThrown:!1,error:null}),t(),n){const{errorThrown:e,error:i}=z;if(z=null,e)throw i}}else t()}class M extends w{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,x(n)&&n.add(this)):this.destination=B}static create(n,e,i){return new S(n,e,i)}next(n){this.isStopped?P(function j(t){return re("N",t,void 0)}(n),this):this._next(n)}error(n){this.isStopped?P(function T(t){return re("E",void 0,t)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?P(Y,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const I=Function.prototype.bind;function X(t,n){return I.call(t,n)}class L{constructor(n){this.partialObserver=n}next(n){const{partialObserver:e}=this;if(e.next)try{e.next(n)}catch(i){k(i)}}error(n){const{partialObserver:e}=this;if(e.error)try{e.error(n)}catch(i){k(i)}else k(n)}complete(){const{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(e){k(e)}}}class S extends M{constructor(n,e,i){let r;if(super(),d(n)||!n)r={next:n??void 0,error:e??void 0,complete:i??void 0};else{let o;this&&V.useDeprecatedNextContext?(o=Object.create(n),o.unsubscribe=()=>this.unsubscribe(),r={next:n.next&&X(n.next,o),error:n.error&&X(n.error,o),complete:n.complete&&X(n.complete,o)}):r=n}this.destination=new L(r)}}function k(t){V.useDeprecatedSynchronousErrorHandling?function Z(t){V.useDeprecatedSynchronousErrorHandling&&z&&(z.errorThrown=!0,z.error=t)}(t):U(t)}function P(t,n){const{onStoppedNotification:e}=V;e&&A.setTimeout(()=>e(t,n))}const B={closed:!0,next:N,error:function v(t){throw t},complete:N},te="function"==typeof Symbol&&Symbol.observable||"@@observable";function D(t){return t}function fe(...t){return R(t)}function R(t){return 0===t.length?D:1===t.length?t[0]:function(e){return t.reduce((i,r)=>r(i),e)}}let F=(()=>{class t{constructor(e){e&&(this._subscribe=e)}lift(e){const i=new t;return i.source=this,i.operator=e,i}subscribe(e,i,r){const o=function c(t){return t&&t instanceof M||function l(t){return t&&d(t.next)&&d(t.error)&&d(t.complete)}(t)&&x(t)}(e)?e:new S(e,i,r);return q(()=>{const{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(e){try{return this._subscribe(e)}catch(i){e.error(i)}}forEach(e,i){return new(i=g(i))((r,o)=>{const s=new S({next:a=>{try{e(a)}catch(h){o(h),s.unsubscribe()}},error:o,complete:r});this.subscribe(s)})}_subscribe(e){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(e)}[te](){return this}pipe(...e){return R(e)(this)}toPromise(e){return new(e=g(e))((i,r)=>{let o;this.subscribe(s=>o=s,s=>r(s),()=>i(o))})}}return t.create=n=>new t(n),t})();function g(t){var n;return null!==(n=t??V.Promise)&&void 0!==n?n:Promise}const f=H(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let u=(()=>{class t extends F{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const i=new p(this,this);return i.operator=e,i}_throwIfClosed(){if(this.closed)throw new f}next(e){q(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(e)}})}error(e){q(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:i}=this;for(;i.length;)i.shift().error(e)}})}complete(){q(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:i,isStopped:r,observers:o}=this;return i||r?O:(this.currentObservers=null,o.push(e),new w(()=>{this.currentObservers=null,_(o,e)}))}_checkFinalizedStatuses(e){const{hasError:i,thrownError:r,isStopped:o}=this;i?e.error(r):o&&e.complete()}asObservable(){const e=new F;return e.source=this,e}}return t.create=(n,e)=>new p(n,e),t})();class p extends u{constructor(n,e){super(),this.destination=n,this.source=e}next(n){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===i||i.call(e,n)}error(n){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===i||i.call(e,n)}complete(){var n,e;null===(e=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===e||e.call(n)}_subscribe(n){var e,i;return null!==(i=null===(e=this.source)||void 0===e?void 0:e.subscribe(n))&&void 0!==i?i:O}}function m(t){return d(t?.lift)}function C(t){return n=>{if(m(n))return n.lift(function(e){try{return t(e,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function $(t,n,e,i,r){return new ie(t,n,e,i,r)}class ie extends M{constructor(n,e,i,r,o,s){super(n),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=e?function(a){try{e(a)}catch(h){n.error(h)}}:super._next,this._error=r?function(a){try{r(a)}catch(h){n.error(h)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){n.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}}function se(t,n){return C((e,i)=>{let r=0;e.subscribe($(i,o=>{i.next(t.call(n,o,r++))}))})}var Ee=function(t,n){return(Ee=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])})(t,n)};function Ie(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}Ee(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}var ce=function(){return ce=Object.assign||function(n){for(var e,i=1,r=arguments.length;i<r;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n},ce.apply(this,arguments)};function $e(t,n,e,i){var s,r=arguments.length,o=r<3?n:null===i?i=Object.getOwnPropertyDescriptor(n,e):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,n,e,i);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(n,e,o):s(n,e))||o);return r>3&&o&&Object.defineProperty(n,e,o),o}function It(t){return this instanceof It?(this.v=t,this):new It(t)}function At(t,n,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=e.apply(t,n||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(ge){i[ge]&&(r[ge]=function(xe){return new Promise(function(ke,Pe){o.push([ge,xe,ke,Pe])>1||a(ge,xe)})})}function a(ge,xe){try{!function h(ge){ge.value instanceof It?Promise.resolve(ge.value.v).then(b,ee):de(o[0][2],ge)}(i[ge](xe))}catch(ke){de(o[0][3],ke)}}function b(ge){a("next",ge)}function ee(ge){a("throw",ge)}function de(ge,xe){ge(xe),o.shift(),o.length&&a(o[0][0],o[0][1])}}function Jt(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=function we(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],i=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(o){e[o]=t[o]&&function(s){return new Promise(function(a,h){!function r(o,s,a,h){Promise.resolve(h).then(function(b){o({value:b,done:a})},s)}(a,h,(s=t[o](s)).done,s.value)})}}}const or=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function Ic(t){return d(t?.then)}function Ml(t){return d(t[te])}function Ha(t){return Symbol.asyncIterator&&d(t?.[Symbol.asyncIterator])}function Va(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Mc=function Qu(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function kc(t){return d(t?.[Mc])}function kl(t){return At(this,arguments,function*(){const e=t.getReader();try{for(;;){const{value:i,done:r}=yield It(e.read());if(r)return yield It(void 0);yield yield It(i)}}finally{e.releaseLock()}})}function Dc(t){return d(t?.getReader)}function br(t){if(t instanceof F)return t;if(null!=t){if(Ml(t))return function Ju(t){return new F(n=>{const e=t[te]();if(d(e.subscribe))return e.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(or(t))return function Ga(t){return new F(n=>{for(let e=0;e<t.length&&!n.closed;e++)n.next(t[e]);n.complete()})}(t);if(Ic(t))return function ed(t){return new F(n=>{t.then(e=>{n.closed||(n.next(e),n.complete())},e=>n.error(e)).then(null,U)})}(t);if(Ha(t))return Dl(t);if(kc(t))return function Ac(t){return new F(n=>{for(const e of t)if(n.next(e),n.closed)return;n.complete()})}(t);if(Dc(t))return function Al(t){return Dl(kl(t))}(t)}throw Va(t)}function Dl(t){return new F(n=>{(function td(t,n){var e,i,r,o;return function Ce(t,n,e,i){return new(e||(e=Promise))(function(o,s){function a(ee){try{b(i.next(ee))}catch(de){s(de)}}function h(ee){try{b(i.throw(ee))}catch(de){s(de)}}function b(ee){ee.done?o(ee.value):function r(o){return o instanceof e?o:new e(function(s){s(o)})}(ee.value).then(a,h)}b((i=i.apply(t,n||[])).next())})}(this,void 0,void 0,function*(){try{for(e=Jt(t);!(i=yield e.next()).done;)if(n.next(i.value),n.closed)return}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=e.return)&&(yield o.call(e))}finally{if(r)throw r.error}}n.complete()})})(t,n).catch(e=>n.error(e))})}function uo(t,n,e,i=0,r=!1){const o=n.schedule(function(){e(),r?t.add(this.schedule(null,i)):this.unsubscribe()},i);if(t.add(o),!r)return o}function Ls(t,n,e=1/0){return d(n)?Ls((i,r)=>se((o,s)=>n(i,o,r,s))(br(t(i,r))),e):("number"==typeof n&&(e=n),C((i,r)=>function nd(t,n,e,i,r,o,s,a){const h=[];let b=0,ee=0,de=!1;const ge=()=>{de&&!h.length&&!b&&n.complete()},xe=Pe=>b<i?ke(Pe):h.push(Pe),ke=Pe=>{o&&n.next(Pe),b++;let Oe=!1;br(e(Pe,ee++)).subscribe($(n,je=>{r?.(je),o?xe(je):n.next(je)},()=>{Oe=!0},void 0,()=>{if(Oe)try{for(b--;h.length&&b<i;){const je=h.shift();s?uo(n,s,()=>ke(je)):ke(je)}ge()}catch(je){n.error(je)}}))};return t.subscribe($(n,xe,()=>{de=!0,ge()})),()=>{a?.()}}(i,r,t,e)))}function Pl(t=1/0){return Ls(D,t)}const qa=new F(t=>t.complete());function qo(t){return t&&d(t.schedule)}function ms(t){return t[t.length-1]}function Wo(t){return d(ms(t))?t.pop():void 0}function Ko(t){return qo(ms(t))?t.pop():void 0}function Fl(t,n=0){return C((e,i)=>{e.subscribe($(i,r=>uo(i,t,()=>i.next(r),n),()=>uo(i,t,()=>i.complete(),n),r=>uo(i,t,()=>i.error(r),n)))})}function Bs(t,n=0){return C((e,i)=>{i.add(t.schedule(()=>e.subscribe(i),n))})}function Ar(t,n){if(!t)throw new Error("Iterable cannot be null");return new F(e=>{uo(e,n,()=>{const i=t[Symbol.asyncIterator]();uo(e,n,()=>{i.next().then(r=>{r.done?e.complete():e.next(r.value)})},0,!0)})})}function Qi(t,n){return n?function fo(t,n){if(null!=t){if(Ml(t))return function ha(t,n){return br(t).pipe(Bs(n),Fl(n))}(t,n);if(or(t))return function zs(t,n){return new F(e=>{let i=0;return n.schedule(function(){i===t.length?e.complete():(e.next(t[i++]),e.closed||this.schedule())})})}(t,n);if(Ic(t))return function Wi(t,n){return br(t).pipe(Bs(n),Fl(n))}(t,n);if(Ha(t))return Ar(t,n);if(kc(t))return function Yr(t,n){return new F(e=>{let i;return uo(e,n,()=>{i=t[Mc](),uo(e,n,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(s){return void e.error(s)}o?e.complete():e.next(r)},0,!0)}),()=>d(i?.return)&&i.return()})}(t,n);if(Dc(t))return function pa(t,n){return Ar(kl(t),n)}(t,n)}throw Va(t)}(t,n):br(t)}function ga(...t){const n=Ko(t),e=function Ol(t,n){return"number"==typeof ms(t)?t.pop():n}(t,1/0),i=t;return i.length?1===i.length?br(i[0]):Pl(e)(Qi(i,n)):qa}function Be(t,n,...e){if(!0===n)return void t();if(!1===n)return;const i=new S({next:()=>{i.unsubscribe(),t()}});return n(...e).subscribe(i)}function Ke(t){for(let n in t)if(t[n]===Ke)return n;throw Error("Could not find renamed property on target object.")}function Ge(t,n){for(const e in n)n.hasOwnProperty(e)&&!t.hasOwnProperty(e)&&(t[e]=n[e])}function Xe(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(Xe).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const n=t.toString();if(null==n)return""+n;const e=n.indexOf("\n");return-1===e?n:n.substring(0,e)}function ot(t,n){return null==t||""===t?null===n?"":n:null==n||""===n?t:t+" "+n}const Je=Ke({__forward_ref__:Ke});function $t(t){return t.__forward_ref__=$t,t.toString=function(){return Xe(this())},t}function gt(t){return Nt(t)?t():t}function Nt(t){return"function"==typeof t&&t.hasOwnProperty(Je)&&t.__forward_ref__===$t}class et extends Error{constructor(n,e){super(function Kt(t,n){return`NG0${Math.abs(t)}${n?": "+n.trim():""}`}(n,e)),this.code=n}}function zt(t){return"string"==typeof t?t:null==t?"":String(t)}function Ze(t,n){throw new et(-201,!1)}function xo(t,n){null==t&&function ui(t,n,e,i){throw new Error(`ASSERTION ERROR: ${t}`+(null==i?"":` [Expected=> ${e} ${i} ${n} <=Actual]`))}(n,t,null,"!=")}function $n(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Eo(t){return{providers:t.providers||[],imports:t.imports||[]}}function Kf(t){return Kv(t,Yf)||Kv(t,Zv)}function Kv(t,n){return t.hasOwnProperty(n)?t[n]:null}function Yv(t){return t&&(t.hasOwnProperty(jg)||t.hasOwnProperty(pM))?t[jg]:null}const Yf=Ke({\u0275prov:Ke}),jg=Ke({\u0275inj:Ke}),Zv=Ke({ngInjectableDef:Ke}),pM=Ke({ngInjectorDef:Ke});var yn=(()=>((yn=yn||{})[yn.Default=0]="Default",yn[yn.Host=1]="Host",yn[yn.Self=2]="Self",yn[yn.SkipSelf=4]="SkipSelf",yn[yn.Optional=8]="Optional",yn))();let Ug;function Yo(t){const n=Ug;return Ug=t,n}function Xv(t,n,e){const i=Kf(t);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:e&yn.Optional?null:void 0!==n?n:void Ze(Xe(t))}function Wa(t){return{toString:t}.toString()}var _s=(()=>((_s=_s||{})[_s.OnPush=0]="OnPush",_s[_s.Default=1]="Default",_s))(),$s=(()=>{return(t=$s||($s={}))[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",$s;var t})();const wi=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Nc={},li=[],Zf=Ke({\u0275cmp:Ke}),Hg=Ke({\u0275dir:Ke}),Vg=Ke({\u0275pipe:Ke}),Qv=Ke({\u0275mod:Ke}),ma=Ke({\u0275fac:Ke}),rd=Ke({__NG_ELEMENT_ID__:Ke});let mM=0;function fn(t){return Wa(()=>{const e=!0===t.standalone,i={},r={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:i,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===_s.OnPush,directiveDefs:null,pipeDefs:null,standalone:e,dependencies:e&&t.dependencies||null,getStandaloneInjector:null,selectors:t.selectors||li,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||$s.Emulated,id:"c"+mM++,styles:t.styles||li,_:null,setInput:null,schemas:t.schemas||null,tView:null},o=t.dependencies,s=t.features;return r.inputs=t1(t.inputs,i),r.outputs=t1(t.outputs),s&&s.forEach(a=>a(r)),r.directiveDefs=o?()=>("function"==typeof o?o():o).map(Jv).filter(e1):null,r.pipeDefs=o?()=>("function"==typeof o?o():o).map(Xr).filter(e1):null,r})}function Gg(t,n,e){const i=t.\u0275cmp;i.directiveDefs=()=>("function"==typeof n?n():n).map(Jv),i.pipeDefs=()=>("function"==typeof e?e():e).map(Xr)}function Jv(t){return hi(t)||Zr(t)}function e1(t){return null!==t}function Zo(t){return Wa(()=>({type:t.type,bootstrap:t.bootstrap||li,declarations:t.declarations||li,imports:t.imports||li,exports:t.exports||li,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function t1(t,n){if(null==t)return Nc;const e={};for(const i in t)if(t.hasOwnProperty(i)){let r=t[i],o=r;Array.isArray(r)&&(o=r[1],r=r[0]),e[r]=i,n&&(n[r]=o)}return e}const hn=fn;function Pr(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,standalone:!0===t.standalone,onDestroy:t.type.prototype.ngOnDestroy||null}}function hi(t){return t[Zf]||null}function Zr(t){return t[Hg]||null}function Xr(t){return t[Vg]||null}function po(t){return Array.isArray(t)&&"object"==typeof t[1]}function bs(t){return Array.isArray(t)&&!0===t[1]}function Kg(t){return 0!=(8&t.flags)}function eh(t){return 2==(2&t.flags)}function th(t){return 1==(1&t.flags)}function ys(t){return null!==t.template}function yM(t){return 0!=(256&t[2])}function jl(t,n){return t.hasOwnProperty(ma)?t[ma]:null}class xM{constructor(n,e,i){this.previousValue=n,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}}function Cs(){return r1}function r1(t){return t.type.prototype.ngOnChanges&&(t.setInput=TM),EM}function EM(){const t=s1(this),n=t?.current;if(n){const e=t.previous;if(e===Nc)t.previous=n;else for(let i in n)e[i]=n[i];t.current=null,this.ngOnChanges(n)}}function TM(t,n,e,i){const r=s1(t)||function SM(t,n){return t[o1]=n}(t,{previous:Nc,current:null}),o=r.current||(r.current={}),s=r.previous,a=this.declaredInputs[e],h=s[a];o[a]=new xM(h&&h.currentValue,n,s===Nc),t[i]=n}Cs.ngInherit=!0;const o1="__ngSimpleChanges__";function s1(t){return t[o1]||null}function er(t){for(;Array.isArray(t);)t=t[0];return t}function nh(t,n){return er(n[t])}function Io(t,n){return er(n[t.index])}function Jg(t,n){return t.data[n]}function Lc(t,n){return t[n]}function Mo(t,n){const e=n[t];return po(e)?e:e[0]}function ih(t){return 64==(64&t[2])}function Ka(t,n){return null==n?null:t[n]}function a1(t){t[18]=0}function em(t,n){t[5]+=n;let e=t,i=t[3];for(;null!==i&&(1===n&&1===e[5]||-1===n&&0===e[5]);)i[5]+=n,e=i,i=i[3]}const Sn={lFrame:_1(null),bindingsEnabled:!0};function c1(){return Sn.bindingsEnabled}function kt(){return Sn.lFrame.lView}function ei(){return Sn.lFrame.tView}function Re(t){return Sn.lFrame.contextLView=t,t[8]}function Le(t){return Sn.lFrame.contextLView=null,t}function sr(){let t=u1();for(;null!==t&&64===t.type;)t=t.parent;return t}function u1(){return Sn.lFrame.currentTNode}function js(t,n){const e=Sn.lFrame;e.currentTNode=t,e.isParent=n}function tm(){return Sn.lFrame.isParent}function nm(){Sn.lFrame.isParent=!1}function Qr(){const t=Sn.lFrame;let n=t.bindingRootIndex;return-1===n&&(n=t.bindingRootIndex=t.tView.bindingStartIndex),n}function Bc(){return Sn.lFrame.bindingIndex++}function $a(t){const n=Sn.lFrame,e=n.bindingIndex;return n.bindingIndex=n.bindingIndex+t,e}function UM(t,n){const e=Sn.lFrame;e.bindingIndex=e.bindingRootIndex=t,im(n)}function im(t){Sn.lFrame.currentDirectiveIndex=t}function p1(){return Sn.lFrame.currentQueryIndex}function om(t){Sn.lFrame.currentQueryIndex=t}function VM(t){const n=t[1];return 2===n.type?n.declTNode:1===n.type?t[6]:null}function g1(t,n,e){if(e&yn.SkipSelf){let r=n,o=t;for(;!(r=r.parent,null!==r||e&yn.Host||(r=VM(o),null===r||(o=o[15],10&r.type))););if(null===r)return!1;n=r,t=o}const i=Sn.lFrame=m1();return i.currentTNode=n,i.lView=t,!0}function sm(t){const n=m1(),e=t[1];Sn.lFrame=n,n.currentTNode=e.firstChild,n.lView=t,n.tView=e,n.contextLView=t,n.bindingIndex=e.bindingStartIndex,n.inI18n=!1}function m1(){const t=Sn.lFrame,n=null===t?null:t.child;return null===n?_1(t):n}function _1(t){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=n),n}function $1(){const t=Sn.lFrame;return Sn.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const v1=$1;function am(){const t=$1();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function Jr(){return Sn.lFrame.selectedIndex}function Ya(t){Sn.lFrame.selectedIndex=t}function zi(){const t=Sn.lFrame;return Jg(t.tView,t.selectedIndex)}function rh(t,n){for(let e=n.directiveStart,i=n.directiveEnd;e<i;e++){const o=t.data[e].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:h,ngAfterViewChecked:b,ngOnDestroy:ee}=o;s&&(t.contentHooks||(t.contentHooks=[])).push(-e,s),a&&((t.contentHooks||(t.contentHooks=[])).push(e,a),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(e,a)),h&&(t.viewHooks||(t.viewHooks=[])).push(-e,h),b&&((t.viewHooks||(t.viewHooks=[])).push(e,b),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(e,b)),null!=ee&&(t.destroyHooks||(t.destroyHooks=[])).push(e,ee)}}function oh(t,n,e){b1(t,n,3,e)}function sh(t,n,e,i){(3&t[2])===e&&b1(t,n,e,i)}function lm(t,n){let e=t[2];(3&e)===n&&(e&=2047,e+=1,t[2]=e)}function b1(t,n,e,i){const o=i??-1,s=n.length-1;let a=0;for(let h=void 0!==i?65535&t[18]:0;h<s;h++)if("number"==typeof n[h+1]){if(a=n[h],null!=i&&a>=i)break}else n[h]<0&&(t[18]+=65536),(a<o||-1==o)&&(JM(t,e,n,h),t[18]=(4294901760&t[18])+h+2),h++}function JM(t,n,e,i){const r=e[i]<0,o=e[i+1],a=t[r?-e[i]:e[i]];if(r){if(t[2]>>11<t[18]>>16&&(3&t[2])===n){t[2]+=2048;try{o.call(a)}finally{}}}else try{o.call(a)}finally{}}class dd{constructor(n,e,i){this.factory=n,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=i}}function ah(t,n,e){let i=0;for(;i<e.length;){const r=e[i];if("number"==typeof r){if(0!==r)break;i++;const o=e[i++],s=e[i++],a=e[i++];t.setAttribute(n,s,a,o)}else{const o=r,s=e[++i];C1(o)?t.setProperty(n,o,s):t.setAttribute(n,o,s),i++}}return i}function y1(t){return 3===t||4===t||6===t}function C1(t){return 64===t.charCodeAt(0)}function lh(t,n){if(null!==n&&0!==n.length)if(null===t||0===t.length)t=n.slice();else{let e=-1;for(let i=0;i<n.length;i++){const r=n[i];"number"==typeof r?e=r:0===e||w1(t,e,r,null,-1===e||2===e?n[++i]:null)}}return t}function w1(t,n,e,i,r){let o=0,s=t.length;if(-1===n)s=-1;else for(;o<t.length;){const a=t[o++];if("number"==typeof a){if(a===n){s=-1;break}if(a>n){s=o-1;break}}}for(;o<t.length;){const a=t[o];if("number"==typeof a)break;if(a===e){if(null===i)return void(null!==r&&(t[o+1]=r));if(i===t[o+1])return void(t[o+2]=r)}o++,null!==i&&o++,null!==r&&o++}-1!==s&&(t.splice(s,0,n),o=s+1),t.splice(o++,0,e),null!==i&&t.splice(o++,0,i),null!==r&&t.splice(o++,0,r)}function x1(t){return-1!==t}function zc(t){return 32767&t}function jc(t,n){let e=function rk(t){return t>>16}(t),i=n;for(;e>0;)i=i[15],e--;return i}let um=!0;function ch(t){const n=um;return um=t,n}let ok=0;const Us={};function hd(t,n){const e=fm(t,n);if(-1!==e)return e;const i=n[1];i.firstCreatePass&&(t.injectorIndex=n.length,dm(i.data,t),dm(n,null),dm(i.blueprint,null));const r=uh(t,n),o=t.injectorIndex;if(x1(r)){const s=zc(r),a=jc(r,n),h=a[1].data;for(let b=0;b<8;b++)n[o+b]=a[s+b]|h[s+b]}return n[o+8]=r,o}function dm(t,n){t.push(0,0,0,0,0,0,0,0,n)}function fm(t,n){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===n[t.injectorIndex+8]?-1:t.injectorIndex}function uh(t,n){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let e=0,i=null,r=n;for(;null!==r;){if(i=P1(r),null===i)return-1;if(e++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|e<<16}return-1}function dh(t,n,e){!function sk(t,n,e){let i;"string"==typeof e?i=e.charCodeAt(0)||0:e.hasOwnProperty(rd)&&(i=e[rd]),null==i&&(i=e[rd]=ok++);const r=255&i;n.data[t+(r>>5)]|=1<<r}(t,n,e)}function S1(t,n,e){if(e&yn.Optional||void 0!==t)return t;Ze()}function I1(t,n,e,i){if(e&yn.Optional&&void 0===i&&(i=null),0==(e&(yn.Self|yn.Host))){const r=t[9],o=Yo(void 0);try{return r?r.get(n,i,e&yn.Optional):Xv(n,i,e&yn.Optional)}finally{Yo(o)}}return S1(i,0,e)}function M1(t,n,e,i=yn.Default,r){if(null!==t){if(1024&n[2]){const s=function dk(t,n,e,i,r){let o=t,s=n;for(;null!==o&&null!==s&&1024&s[2]&&!(256&s[2]);){const a=k1(o,s,e,i|yn.Self,Us);if(a!==Us)return a;let h=o.parent;if(!h){const b=s[21];if(b){const ee=b.get(e,Us,i);if(ee!==Us)return ee}h=P1(s),s=s[15]}o=h}return r}(t,n,e,i,Us);if(s!==Us)return s}const o=k1(t,n,e,i,Us);if(o!==Us)return o}return I1(n,e,i,r)}function k1(t,n,e,i,r){const o=function ck(t){if("string"==typeof t)return t.charCodeAt(0)||0;const n=t.hasOwnProperty(rd)?t[rd]:void 0;return"number"==typeof n?n>=0?255&n:uk:n}(e);if("function"==typeof o){if(!g1(n,t,i))return i&yn.Host?S1(r,0,i):I1(n,e,i,r);try{const s=o(i);if(null!=s||i&yn.Optional)return s;Ze()}finally{v1()}}else if("number"==typeof o){let s=null,a=fm(t,n),h=-1,b=i&yn.Host?n[16][6]:null;for((-1===a||i&yn.SkipSelf)&&(h=-1===a?uh(t,n):n[a+8],-1!==h&&A1(i,!1)?(s=n[1],a=zc(h),n=jc(h,n)):a=-1);-1!==a;){const ee=n[1];if(D1(o,a,ee.data)){const de=lk(a,n,e,s,i,b);if(de!==Us)return de}h=n[a+8],-1!==h&&A1(i,n[1].data[a+8]===b)&&D1(o,a,n)?(s=ee,a=zc(h),n=jc(h,n)):a=-1}}return r}function lk(t,n,e,i,r,o){const s=n[1],a=s.data[t+8],ee=fh(a,s,e,null==i?eh(a)&&um:i!=s&&0!=(3&a.type),r&yn.Host&&o===a);return null!==ee?pd(n,s,ee,a):Us}function fh(t,n,e,i,r){const o=t.providerIndexes,s=n.data,a=1048575&o,h=t.directiveStart,ee=o>>20,ge=r?a+ee:t.directiveEnd;for(let xe=i?a:a+ee;xe<ge;xe++){const ke=s[xe];if(xe<h&&e===ke||xe>=h&&ke.type===e)return xe}if(r){const xe=s[h];if(xe&&ys(xe)&&xe.type===e)return h}return null}function pd(t,n,e,i){let r=t[e];const o=n.data;if(function ek(t){return t instanceof dd}(r)){const s=r;s.resolving&&function ri(t,n){const e=n?`. Dependency path: ${n.join(" > ")} > ${t}`:"";throw new et(-200,`Circular dependency in DI detected for ${t}${e}`)}(function en(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():zt(t)}(o[e]));const a=ch(s.canSeeViewProviders);s.resolving=!0;const h=s.injectImpl?Yo(s.injectImpl):null;g1(t,i,yn.Default);try{r=t[e]=s.factory(void 0,o,t,i),n.firstCreatePass&&e>=i.directiveStart&&function QM(t,n,e){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=n.type.prototype;if(i){const s=r1(n);(e.preOrderHooks||(e.preOrderHooks=[])).push(t,s),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(t,s)}r&&(e.preOrderHooks||(e.preOrderHooks=[])).push(0-t,r),o&&((e.preOrderHooks||(e.preOrderHooks=[])).push(t,o),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(t,o))}(e,o[e],n)}finally{null!==h&&Yo(h),ch(a),s.resolving=!1,v1()}}return r}function D1(t,n,e){return!!(e[n+(t>>5)]&1<<t)}function A1(t,n){return!(t&yn.Self||t&yn.Host&&n)}class Uc{constructor(n,e){this._tNode=n,this._lView=e}get(n,e,i){return M1(this._tNode,this._lView,n,i,e)}}function uk(){return new Uc(sr(),kt())}function Fr(t){return Wa(()=>{const n=t.prototype.constructor,e=n[ma]||hm(n),i=Object.prototype;let r=Object.getPrototypeOf(t.prototype).constructor;for(;r&&r!==i;){const o=r[ma]||hm(r);if(o&&o!==e)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function hm(t){return Nt(t)?()=>{const n=hm(gt(t));return n&&n()}:jl(t)}function P1(t){const n=t[1],e=n.type;return 2===e?n.declTNode:1===e?t[6]:null}const Vc="__parameters__";function qc(t,n,e){return Wa(()=>{const i=function gm(t){return function(...e){if(t){const i=t(...e);for(const r in i)this[r]=i[r]}}}(n);function r(...o){if(this instanceof r)return i.apply(this,o),this;const s=new r(...o);return a.annotation=s,a;function a(h,b,ee){const de=h.hasOwnProperty(Vc)?h[Vc]:Object.defineProperty(h,Vc,{value:[]})[Vc];for(;de.length<=ee;)de.push(null);return(de[ee]=de[ee]||[]).push(s),h}}return e&&(r.prototype=Object.create(e.prototype)),r.prototype.ngMetadataName=t,r.annotationCls=r,r})}class An{constructor(n,e){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=$n({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function ko(t,n){void 0===n&&(n=t);for(let e=0;e<t.length;e++){let i=t[e];Array.isArray(i)?(n===t&&(n=t.slice(0,e)),ko(i,n)):n!==t&&n.push(i)}return n}function va(t,n){t.forEach(e=>Array.isArray(e)?va(e,n):n(e))}function O1(t,n,e){n>=t.length?t.push(e):t.splice(n,0,e)}function hh(t,n){return n>=t.length-1?t.pop():t.splice(n,1)[0]}function _d(t,n){const e=[];for(let i=0;i<t;i++)e.push(n);return e}function Do(t,n,e){let i=Wc(t,n);return i>=0?t[1|i]=e:(i=~i,function gk(t,n,e,i){let r=t.length;if(r==n)t.push(e,i);else if(1===r)t.push(i,t[0]),t[0]=e;else{for(r--,t.push(t[r-1],t[r]);r>n;)t[r]=t[r-2],r--;t[n]=e,t[n+1]=i}}(t,i,n,e)),i}function _m(t,n){const e=Wc(t,n);if(e>=0)return t[1|e]}function Wc(t,n){return function L1(t,n,e){let i=0,r=t.length>>e;for(;r!==i;){const o=i+(r-i>>1),s=t[o<<e];if(n===s)return o<<e;s>n?r=o:i=o+1}return~(r<<e)}(t,n,1)}const $d={},vm="__NG_DI_FLAG__",gh="ngTempTokenPath",wk=/\n/gm,B1="__source";let vd;function Kc(t){const n=vd;return vd=t,n}function Ek(t,n=yn.Default){if(void 0===vd)throw new et(-203,!1);return null===vd?Xv(t,void 0,n):vd.get(t,n&yn.Optional?null:void 0,n)}function pn(t,n=yn.Default){return(function gM(){return Ug}()||Ek)(gt(t),n)}function bm(t){const n=[];for(let e=0;e<t.length;e++){const i=gt(t[e]);if(Array.isArray(i)){if(0===i.length)throw new et(900,!1);let r,o=yn.Default;for(let s=0;s<i.length;s++){const a=i[s],h=Sk(a);"number"==typeof h?-1===h?r=a.token:o|=h:r=a}n.push(pn(r,o))}else n.push(pn(i))}return n}function bd(t,n){return t[vm]=n,t.prototype[vm]=n,t}function Sk(t){return t[vm]}const mh=bd(qc("Optional"),8),_h=bd(qc("SkipSelf"),4);var go=(()=>((go=go||{})[go.Important=1]="Important",go[go.DashCase=2]="DashCase",go))();const Em=new Map;let Gk=0;const Sm="__ngContext__";function Rr(t,n){po(n)?(t[Sm]=n[20],function Wk(t){Em.set(t[20],t)}(n)):t[Sm]=n}function Mm(t,n){return undefined(t,n)}function xd(t){const n=t[3];return bs(n)?n[3]:n}function km(t){return sb(t[13])}function Dm(t){return sb(t[4])}function sb(t){for(;null!==t&&!bs(t);)t=t[4];return t}function Zc(t,n,e,i,r){if(null!=i){let o,s=!1;bs(i)?o=i:po(i)&&(s=!0,i=i[0]);const a=er(i);0===t&&null!==e?null==r?fb(n,e,a):Ul(n,e,a,r||null,!0):1===t&&null!==e?Ul(n,e,a,r||null,!0):2===t?function Lm(t,n,e){const i=bh(t,n);i&&function gD(t,n,e,i){t.removeChild(n,e,i)}(t,i,n,e)}(n,a,s):3===t&&n.destroyNode(a),null!=o&&function $D(t,n,e,i,r){const o=e[7];o!==er(e)&&Zc(n,t,i,o,r);for(let a=10;a<e.length;a++){const h=e[a];Ed(h[1],h,t,n,i,o)}}(n,t,o,e,r)}}function Pm(t,n,e){return t.createElement(n,e)}function lb(t,n){const e=t[9],i=e.indexOf(n),r=n[3];512&n[2]&&(n[2]&=-513,em(r,-1)),e.splice(i,1)}function Nm(t,n){if(t.length<=10)return;const e=10+n,i=t[e];if(i){const r=i[17];null!==r&&r!==t&&lb(r,i),n>0&&(t[e-1][4]=i[4]);const o=hh(t,10+n);!function aD(t,n){Ed(t,n,n[11],2,null,null),n[0]=null,n[6]=null}(i[1],i);const s=o[19];null!==s&&s.detachView(o[1]),i[3]=null,i[4]=null,i[2]&=-65}return i}function cb(t,n){if(!(128&n[2])){const e=n[11];e.destroyNode&&Ed(t,n,e,3,null,null),function uD(t){let n=t[13];if(!n)return Om(t[1],t);for(;n;){let e=null;if(po(n))e=n[13];else{const i=n[10];i&&(e=i)}if(!e){for(;n&&!n[4]&&n!==t;)po(n)&&Om(n[1],n),n=n[3];null===n&&(n=t),po(n)&&Om(n[1],n),e=n&&n[4]}n=e}}(n)}}function Om(t,n){if(!(128&n[2])){n[2]&=-65,n[2]|=128,function pD(t,n){let e;if(null!=t&&null!=(e=t.destroyHooks))for(let i=0;i<e.length;i+=2){const r=n[e[i]];if(!(r instanceof dd)){const o=e[i+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){const a=r[o[s]],h=o[s+1];try{h.call(a)}finally{}}else try{o.call(r)}finally{}}}}(t,n),function hD(t,n){const e=t.cleanup,i=n[7];let r=-1;if(null!==e)for(let o=0;o<e.length-1;o+=2)if("string"==typeof e[o]){const s=e[o+1],a="function"==typeof s?s(n):er(n[s]),h=i[r=e[o+2]],b=e[o+3];"boolean"==typeof b?a.removeEventListener(e[o],h,b):b>=0?i[r=b]():i[r=-b].unsubscribe(),o+=2}else{const s=i[r=e[o+1]];e[o].call(s)}if(null!==i){for(let o=r+1;o<i.length;o++)(0,i[o])();n[7]=null}}(t,n),1===n[1].type&&n[11].destroy();const e=n[17];if(null!==e&&bs(n[3])){e!==n[3]&&lb(e,n);const i=n[19];null!==i&&i.detachView(t)}!function Kk(t){Em.delete(t[20])}(n)}}function ub(t,n,e){return function db(t,n,e){let i=n;for(;null!==i&&40&i.type;)i=(n=i).parent;if(null===i)return e[0];if(2&i.flags){const r=t.data[i.directiveStart].encapsulation;if(r===$s.None||r===$s.Emulated)return null}return Io(i,e)}(t,n.parent,e)}function Ul(t,n,e,i,r){t.insertBefore(n,e,i,r)}function fb(t,n,e){t.appendChild(n,e)}function hb(t,n,e,i,r){null!==i?Ul(t,n,e,i,r):fb(t,n,e)}function bh(t,n){return t.parentNode(n)}function pb(t,n,e){return mb(t,n,e)}let wh,Um,xh,mb=function gb(t,n,e){return 40&t.type?Io(t,e):null};function yh(t,n,e,i){const r=ub(t,i,n),o=n[11],a=pb(i.parent||n[6],i,n);if(null!=r)if(Array.isArray(e))for(let h=0;h<e.length;h++)hb(o,r,e[h],a,!1);else hb(o,r,e,a,!1)}function Ch(t,n){if(null!==n){const e=n.type;if(3&e)return Io(n,t);if(4&e)return Rm(-1,t[n.index]);if(8&e){const i=n.child;if(null!==i)return Ch(t,i);{const r=t[n.index];return bs(r)?Rm(-1,r):er(r)}}if(32&e)return Mm(n,t)()||er(t[n.index]);{const i=$b(t,n);return null!==i?Array.isArray(i)?i[0]:Ch(xd(t[16]),i):Ch(t,n.next)}}return null}function $b(t,n){return null!==n?t[16][6].projection[n.projection]:null}function Rm(t,n){const e=10+t+1;if(e<n.length){const i=n[e],r=i[1].firstChild;if(null!==r)return Ch(i,r)}return n[7]}function Bm(t,n,e,i,r,o,s){for(;null!=e;){const a=i[e.index],h=e.type;if(s&&0===n&&(a&&Rr(er(a),i),e.flags|=4),64!=(64&e.flags))if(8&h)Bm(t,n,e.child,i,r,o,!1),Zc(n,t,r,a,o);else if(32&h){const b=Mm(e,i);let ee;for(;ee=b();)Zc(n,t,r,ee,o);Zc(n,t,r,a,o)}else 16&h?vb(t,n,i,e,r,o):Zc(n,t,r,a,o);e=s?e.projectionNext:e.next}}function Ed(t,n,e,i,r,o){Bm(e,i,t.firstChild,n,r,o,!1)}function vb(t,n,e,i,r,o){const s=e[16],h=s[6].projection[i.projection];if(Array.isArray(h))for(let b=0;b<h.length;b++)Zc(n,t,r,h[b],o);else Bm(t,n,h,s[3],r,o,!0)}function bb(t,n,e){t.setAttribute(n,"style",e)}function zm(t,n,e){""===e?t.removeAttribute(n,"class"):t.setAttribute(n,"class",e)}function Hl(t){return function jm(){if(void 0===wh&&(wh=null,wi.trustedTypes))try{wh=wi.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return wh}()?.createHTML(t)||t}function Cb(t){return function Hm(){if(void 0===xh&&(xh=null,wi.trustedTypes))try{xh=wi.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return xh}()?.createHTML(t)||t}class Vl{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class xD extends Vl{getTypeName(){return"HTML"}}class ED extends Vl{getTypeName(){return"Style"}}class TD extends Vl{getTypeName(){return"Script"}}class SD extends Vl{getTypeName(){return"URL"}}class ID extends Vl{getTypeName(){return"ResourceURL"}}function Ao(t){return t instanceof Vl?t.changingThisBreaksApplicationSecurity:t}function Hs(t,n){const e=function MD(t){return t instanceof Vl&&t.getTypeName()||null}(t);if(null!=e&&e!==n){if("ResourceURL"===e&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${e} (see https://g.co/ng/security#xss)`)}return e===n}class OD{constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{const e=(new window.DOMParser).parseFromString(Hl(n),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(n):(e.removeChild(e.firstChild),e)}catch{return null}}}class FD{constructor(n){if(this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e);const i=this.inertDocument.createElement("body");e.appendChild(i)}}getInertBodyElement(n){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=Hl(n),e;const i=this.inertDocument.createElement("body");return i.innerHTML=Hl(n),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(i),i}stripCustomNsAttrs(n){const e=n.attributes;for(let r=e.length-1;0<r;r--){const s=e.item(r).name;("xmlns:ns1"===s||0===s.indexOf("ns1:"))&&n.removeAttribute(s)}let i=n.firstChild;for(;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}const LD=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;function Eh(t){return(t=String(t)).match(LD)?t:"unsafe:"+t}function ba(t){const n={};for(const e of t.split(","))n[e]=!0;return n}function Td(...t){const n={};for(const e of t)for(const i in e)e.hasOwnProperty(i)&&(n[i]=!0);return n}const Tb=ba("area,br,col,hr,img,wbr"),Sb=ba("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Ib=ba("rp,rt"),Vm=Td(Tb,Td(Sb,ba("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Td(Ib,ba("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Td(Ib,Sb)),Gm=ba("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Mb=Td(Gm,ba("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),ba("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),BD=ba("script,style,template");class zD{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(n){let e=n.firstChild,i=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?i=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,i&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let r=this.checkClobberedElement(e,e.nextSibling);if(r){e=r;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(n){const e=n.nodeName.toLowerCase();if(!Vm.hasOwnProperty(e))return this.sanitizedSomething=!0,!BD.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const i=n.attributes;for(let r=0;r<i.length;r++){const o=i.item(r),s=o.name,a=s.toLowerCase();if(!Mb.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let h=o.value;Gm[a]&&(h=Eh(h)),this.buf.push(" ",s,'="',kb(h),'"')}return this.buf.push(">"),!0}endElement(n){const e=n.nodeName.toLowerCase();Vm.hasOwnProperty(e)&&!Tb.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(n){this.buf.push(kb(n))}checkClobberedElement(n,e){if(e&&(n.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${n.outerHTML}`);return e}}const jD=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,UD=/([^\#-~ |!])/g;function kb(t){return t.replace(/&/g,"&amp;").replace(jD,function(n){return"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";"}).replace(UD,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Th;function Db(t,n){let e=null;try{Th=Th||function Eb(t){const n=new FD(t);return function RD(){try{return!!(new window.DOMParser).parseFromString(Hl(""),"text/html")}catch{return!1}}()?new OD(n):n}(t);let i=n?String(n):"";e=Th.getInertBodyElement(i);let r=5,o=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=o,o=e.innerHTML,e=Th.getInertBodyElement(i)}while(i!==o);return Hl((new zD).sanitizeChildren(qm(e)||e))}finally{if(e){const i=qm(e)||e;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function qm(t){return"content"in t&&function HD(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var Ei=(()=>((Ei=Ei||{})[Ei.NONE=0]="NONE",Ei[Ei.HTML=1]="HTML",Ei[Ei.STYLE=2]="STYLE",Ei[Ei.SCRIPT=3]="SCRIPT",Ei[Ei.URL=4]="URL",Ei[Ei.RESOURCE_URL=5]="RESOURCE_URL",Ei))();function lr(t){const n=Sd();return n?Cb(n.sanitize(Ei.HTML,t)||""):Hs(t,"HTML")?Cb(Ao(t)):Db(function yb(){return void 0!==Um?Um:typeof document<"u"?document:void 0}(),zt(t))}function vn(t){const n=Sd();return n?n.sanitize(Ei.URL,t)||"":Hs(t,"URL")?Ao(t):Eh(zt(t))}function Sd(){const t=kt();return t&&t[12]}const Pb=new An("ENVIRONMENT_INITIALIZER"),Nb=new An("INJECTOR",-1),Ob=new An("INJECTOR_DEF_TYPES");class Fb{get(n,e=$d){if(e===$d){const i=new Error(`NullInjectorError: No provider for ${Xe(n)}!`);throw i.name="NullInjectorError",i}return e}}function ZD(...t){return{\u0275providers:Rb(0,t)}}function Rb(t,...n){const e=[],i=new Set;let r;return va(n,o=>{const s=o;Wm(s,e,[],i)&&(r||(r=[]),r.push(s))}),void 0!==r&&Lb(r,e),e}function Lb(t,n){for(let e=0;e<t.length;e++){const{providers:r}=t[e];va(r,o=>{n.push(o)})}}function Wm(t,n,e,i){if(!(t=gt(t)))return!1;let r=null,o=Yv(t);const s=!o&&hi(t);if(o||s){if(s&&!s.standalone)return!1;r=t}else{const h=t.ngModule;if(o=Yv(h),!o)return!1;r=h}const a=i.has(r);if(s){if(a)return!1;if(i.add(r),s.dependencies){const h="function"==typeof s.dependencies?s.dependencies():s.dependencies;for(const b of h)Wm(b,n,e,i)}}else{if(!o)return!1;{if(null!=o.imports&&!a){let b;i.add(r);try{va(o.imports,ee=>{Wm(ee,n,e,i)&&(b||(b=[]),b.push(ee))})}finally{}void 0!==b&&Lb(b,n)}if(!a){const b=jl(r)||(()=>new r);n.push({provide:r,useFactory:b,deps:li},{provide:Ob,useValue:r,multi:!0},{provide:Pb,useValue:()=>pn(r),multi:!0})}const h=o.providers;null==h||a||va(h,ee=>{n.push(ee)})}}return r!==t&&void 0!==t.providers}const XD=Ke({provide:String,useValue:Ke});function Km(t){return null!==t&&"object"==typeof t&&XD in t}function Gl(t){return"function"==typeof t}const Ym=new An("Set Injector scope."),Sh={},JD={};let Zm;function Ih(){return void 0===Zm&&(Zm=new Fb),Zm}class Xc{}class jb extends Xc{constructor(n,e,i,r){super(),this.parent=e,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Qm(n,s=>this.processProvider(s)),this.records.set(Nb,Qc(void 0,this)),r.has("environment")&&this.records.set(Xc,Qc(void 0,this));const o=this.records.get(Ym);null!=o&&"string"==typeof o.value&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(Ob.multi,li,yn.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const n of this._ngOnDestroyHooks)n.ngOnDestroy();for(const n of this._onDestroyHooks)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(n){this._onDestroyHooks.push(n)}runInContext(n){this.assertNotDestroyed();const e=Kc(this),i=Yo(void 0);try{return n()}finally{Kc(e),Yo(i)}}get(n,e=$d,i=yn.Default){this.assertNotDestroyed();const r=Kc(this),o=Yo(void 0);try{if(!(i&yn.SkipSelf)){let a=this.records.get(n);if(void 0===a){const h=function rA(t){return"function"==typeof t||"object"==typeof t&&t instanceof An}(n)&&Kf(n);a=h&&this.injectableDefInScope(h)?Qc(Xm(n),Sh):null,this.records.set(n,a)}if(null!=a)return this.hydrate(n,a)}return(i&yn.Self?Ih():this.parent).get(n,e=i&yn.Optional&&e===$d?null:e)}catch(s){if("NullInjectorError"===s.name){if((s[gh]=s[gh]||[]).unshift(Xe(n)),r)throw s;return function Ik(t,n,e,i){const r=t[gh];throw n[B1]&&r.unshift(n[B1]),t.message=function Mk(t,n,e,i=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.slice(2):t;let r=Xe(n);if(Array.isArray(n))r=n.map(Xe).join(" -> ");else if("object"==typeof n){let o=[];for(let s in n)if(n.hasOwnProperty(s)){let a=n[s];o.push(s+":"+("string"==typeof a?JSON.stringify(a):Xe(a)))}r=`{${o.join(", ")}}`}return`${e}${i?"("+i+")":""}[${r}]: ${t.replace(wk,"\n  ")}`}("\n"+t.message,r,e,i),t.ngTokenPath=r,t[gh]=null,t}(s,n,"R3InjectorError",this.source)}throw s}finally{Yo(o),Kc(r)}}resolveInjectorInitializers(){const n=Kc(this),e=Yo(void 0);try{const i=this.get(Pb.multi,li,yn.Self);for(const r of i)r()}finally{Kc(n),Yo(e)}}toString(){const n=[],e=this.records;for(const i of e.keys())n.push(Xe(i));return`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new et(205,!1)}processProvider(n){let e=Gl(n=gt(n))?n:gt(n&&n.provide);const i=function tA(t){return Km(t)?Qc(void 0,t.useValue):Qc(Ub(t),Sh)}(n);if(Gl(n)||!0!==n.multi)this.records.get(e);else{let r=this.records.get(e);r||(r=Qc(void 0,Sh,!0),r.factory=()=>bm(r.multi),this.records.set(e,r)),e=n,r.multi.push(n)}this.records.set(e,i)}hydrate(n,e){return e.value===Sh&&(e.value=JD,e.value=e.factory()),"object"==typeof e.value&&e.value&&function iA(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}injectableDefInScope(n){if(!n.providedIn)return!1;const e=gt(n.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}}function Xm(t){const n=Kf(t),e=null!==n?n.factory:jl(t);if(null!==e)return e;if(t instanceof An)throw new et(204,!1);if(t instanceof Function)return function eA(t){const n=t.length;if(n>0)throw _d(n,"?"),new et(204,!1);const e=function fM(t){const n=t&&(t[Yf]||t[Zv]);if(n){const e=function hM(t){if(t.hasOwnProperty("name"))return t.name;const n=(""+t).match(/^function\s*([^\s(]+)/);return null===n?"":n[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${e}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${e}" class.`),n}return null}(t);return null!==e?()=>e.factory(t):()=>new t}(t);throw new et(204,!1)}function Ub(t,n,e){let i;if(Gl(t)){const r=gt(t);return jl(r)||Xm(r)}if(Km(t))i=()=>gt(t.useValue);else if(function zb(t){return!(!t||!t.useFactory)}(t))i=()=>t.useFactory(...bm(t.deps||[]));else if(function Bb(t){return!(!t||!t.useExisting)}(t))i=()=>pn(gt(t.useExisting));else{const r=gt(t&&(t.useClass||t.provide));if(!function nA(t){return!!t.deps}(t))return jl(r)||Xm(r);i=()=>new r(...bm(t.deps))}return i}function Qc(t,n,e=!1){return{factory:t,value:n,multi:e?[]:void 0}}function oA(t){return!!t.\u0275providers}function Qm(t,n){for(const e of t)Array.isArray(e)?Qm(e,n):oA(e)?Qm(e.\u0275providers,n):n(e)}class Hb{}class lA{resolveComponentFactory(n){throw function aA(t){const n=Error(`No component factory found for ${Xe(t)}. Did you add it to @NgModule.entryComponents?`);return n.ngComponent=t,n}(n)}}let Mh=(()=>{class t{}return t.NULL=new lA,t})();function cA(){return Jc(sr(),kt())}function Jc(t,n){return new Ai(Io(t,n))}let Ai=(()=>{class t{constructor(e){this.nativeElement=e}}return t.__NG_ELEMENT_ID__=cA,t})();function uA(t){return t instanceof Ai?t.nativeElement:t}class Id{}let ql=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>function dA(){const t=kt(),e=Mo(sr().index,t);return(po(e)?e:t)[11]}(),t})(),fA=(()=>{class t{}return t.\u0275prov=$n({token:t,providedIn:"root",factory:()=>null}),t})();class kh{constructor(n){this.full=n,this.major=n.split(".")[0],this.minor=n.split(".")[1],this.patch=n.split(".").slice(2).join(".")}}const hA=new kh("14.2.12"),Jm={};function t_(t){return t.ngOriginalError}class eu{constructor(){this._console=console}handleError(n){const e=this._findOriginalError(n);this._console.error("ERROR",n),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(n){let e=n&&t_(n);for(;e&&t_(e);)e=t_(e);return e||null}}function Dh(t){return t.ownerDocument}function qb(t,n,e){let i=t.length;for(;;){const r=t.indexOf(n,e);if(-1===r)return r;if(0===r||t.charCodeAt(r-1)<=32){const o=n.length;if(r+o===i||t.charCodeAt(r+o)<=32)return r}e=r+1}}const Wb="ng-template";function wA(t,n,e){let i=0;for(;i<t.length;){let r=t[i++];if(e&&"class"===r){if(r=t[i],-1!==qb(r.toLowerCase(),n,0))return!0}else if(1===r){for(;i<t.length&&"string"==typeof(r=t[i++]);)if(r.toLowerCase()===n)return!0;return!1}}return!1}function Kb(t){return 4===t.type&&t.value!==Wb}function xA(t,n,e){return n===(4!==t.type||e?t.value:Wb)}function EA(t,n,e){let i=4;const r=t.attrs||[],o=function IA(t){for(let n=0;n<t.length;n++)if(y1(t[n]))return n;return t.length}(r);let s=!1;for(let a=0;a<n.length;a++){const h=n[a];if("number"!=typeof h){if(!s)if(4&i){if(i=2|1&i,""!==h&&!xA(t,h,e)||""===h&&1===n.length){if(ws(i))return!1;s=!0}}else{const b=8&i?h:n[++a];if(8&i&&null!==t.attrs){if(!wA(t.attrs,b,e)){if(ws(i))return!1;s=!0}continue}const de=TA(8&i?"class":h,r,Kb(t),e);if(-1===de){if(ws(i))return!1;s=!0;continue}if(""!==b){let ge;ge=de>o?"":r[de+1].toLowerCase();const xe=8&i?ge:null;if(xe&&-1!==qb(xe,b,0)||2&i&&b!==ge){if(ws(i))return!1;s=!0}}}}else{if(!s&&!ws(i)&&!ws(h))return!1;if(s&&ws(h))continue;s=!1,i=h|1&i}}return ws(i)||s}function ws(t){return 0==(1&t)}function TA(t,n,e,i){if(null===n)return-1;let r=0;if(i||!e){let o=!1;for(;r<n.length;){const s=n[r];if(s===t)return r;if(3===s||6===s)o=!0;else{if(1===s||2===s){let a=n[++r];for(;"string"==typeof a;)a=n[++r];continue}if(4===s)break;if(0===s){r+=4;continue}}r+=o?1:2}return-1}return function MA(t,n){let e=t.indexOf(4);if(e>-1)for(e++;e<t.length;){const i=t[e];if("number"==typeof i)return-1;if(i===n)return e;e++}return-1}(n,t)}function Yb(t,n,e=!1){for(let i=0;i<n.length;i++)if(EA(t,n[i],e))return!0;return!1}function kA(t,n){e:for(let e=0;e<n.length;e++){const i=n[e];if(t.length===i.length){for(let r=0;r<t.length;r++)if(t[r]!==i[r])continue e;return!0}}return!1}function Zb(t,n){return t?":not("+n.trim()+")":n}function DA(t){let n=t[0],e=1,i=2,r="",o=!1;for(;e<t.length;){let s=t[e];if("string"==typeof s)if(2&i){const a=t[++e];r+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+s:4&i&&(r+=" "+s);else""!==r&&!ws(s)&&(n+=Zb(o,r),r=""),i=s,o=o||!ws(i);e++}return""!==r&&(n+=Zb(o,r)),n}const Mn={};function G(t){Xb(ei(),kt(),Jr()+t,!1)}function Xb(t,n,e,i){if(!i)if(3==(3&n[2])){const o=t.preOrderCheckHooks;null!==o&&oh(n,o,e)}else{const o=t.preOrderHooks;null!==o&&sh(n,o,0,e)}Ya(e)}function ty(t,n=null,e=null,i){const r=ny(t,n,e,i);return r.resolveInjectorInitializers(),r}function ny(t,n=null,e=null,i,r=new Set){const o=[e||li,ZD(t)];return i=i||("object"==typeof t?void 0:Xe(t)),new jb(o,n||Ih(),i||null,r)}let xs=(()=>{class t{static create(e,i){if(Array.isArray(e))return ty({name:""},i,e,"");{const r=e.name??"";return ty({name:r},e.parent,e.providers,r)}}}return t.THROW_IF_NOT_FOUND=$d,t.NULL=new Fb,t.\u0275prov=$n({token:t,providedIn:"any",factory:()=>pn(Nb)}),t.__NG_ELEMENT_ID__=-1,t})();function He(t,n=yn.Default){const e=kt();return null===e?pn(t,n):M1(sr(),e,gt(t),n)}function Ph(t,n){return t<<17|n<<2}function Es(t){return t>>17&32767}function s_(t){return 2|t}function Ca(t){return(131068&t)>>2}function a_(t,n){return-131069&t|n<<2}function l_(t){return 1|t}function vy(t,n){const e=t.contentQueries;if(null!==e)for(let i=0;i<e.length;i+=2){const r=e[i],o=e[i+1];if(-1!==o){const s=t.data[o];om(r),s.contentQueries(2,n[o],o)}}}function Fh(t,n,e,i,r,o,s,a,h,b,ee){const de=n.blueprint.slice();return de[0]=r,de[2]=76|i,(null!==ee||t&&1024&t[2])&&(de[2]|=1024),a1(de),de[3]=de[15]=t,de[8]=e,de[10]=s||t&&t[10],de[11]=a||t&&t[11],de[12]=h||t&&t[12]||null,de[9]=b||t&&t[9]||null,de[6]=o,de[20]=function qk(){return Gk++}(),de[21]=ee,de[16]=2==n.type?t[16]:de,de}function iu(t,n,e,i,r){let o=t.data[n];if(null===o)o=function m_(t,n,e,i,r){const o=u1(),s=tm(),h=t.data[n]=function pP(t,n,e,i,r,o){return{type:e,index:i,insertBeforeIndex:null,injectorIndex:n?n.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?o:o&&o.parent,e,n,i,r);return null===t.firstChild&&(t.firstChild=h),null!==o&&(s?null==o.child&&null!==h.parent&&(o.child=h):null===o.next&&(o.next=h)),h}(t,n,e,i,r),function jM(){return Sn.lFrame.inI18n}()&&(o.flags|=64);else if(64&o.type){o.type=e,o.value=i,o.attrs=r;const s=function ud(){const t=Sn.lFrame,n=t.currentTNode;return t.isParent?n:n.parent}();o.injectorIndex=null===s?-1:s.injectorIndex}return js(o,!0),o}function ru(t,n,e,i){if(0===e)return-1;const r=n.length;for(let o=0;o<e;o++)n.push(i),t.blueprint.push(i),t.data.push(null);return r}function __(t,n,e){sm(n);try{const i=t.viewQuery;null!==i&&E_(1,i,e);const r=t.template;null!==r&&by(t,n,r,1,e),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&vy(t,n),t.staticViewQueries&&E_(2,t.viewQuery,e);const o=t.components;null!==o&&function dP(t,n){for(let e=0;e<n.length;e++)kP(t,n[e])}(n,o)}catch(i){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),i}finally{n[2]&=-5,am()}}function Rh(t,n,e,i){const r=n[2];if(128!=(128&r)){sm(n);try{a1(n),function f1(t){return Sn.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==e&&by(t,n,e,2,i);const s=3==(3&r);if(s){const b=t.preOrderCheckHooks;null!==b&&oh(n,b,null)}else{const b=t.preOrderHooks;null!==b&&sh(n,b,0,null),lm(n,0)}if(function IP(t){for(let n=km(t);null!==n;n=Dm(n)){if(!n[2])continue;const e=n[9];for(let i=0;i<e.length;i++){const r=e[i],o=r[3];0==(512&r[2])&&em(o,1),r[2]|=512}}}(n),function SP(t){for(let n=km(t);null!==n;n=Dm(n))for(let e=10;e<n.length;e++){const i=n[e],r=i[1];ih(i)&&Rh(r,i,r.template,i[8])}}(n),null!==t.contentQueries&&vy(t,n),s){const b=t.contentCheckHooks;null!==b&&oh(n,b)}else{const b=t.contentHooks;null!==b&&sh(n,b,1),lm(n,1)}!function cP(t,n){const e=t.hostBindingOpCodes;if(null!==e)try{for(let i=0;i<e.length;i++){const r=e[i];if(r<0)Ya(~r);else{const o=r,s=e[++i],a=e[++i];UM(s,o),a(2,n[o])}}}finally{Ya(-1)}}(t,n);const a=t.components;null!==a&&function uP(t,n){for(let e=0;e<n.length;e++)MP(t,n[e])}(n,a);const h=t.viewQuery;if(null!==h&&E_(2,h,i),s){const b=t.viewCheckHooks;null!==b&&oh(n,b)}else{const b=t.viewHooks;null!==b&&sh(n,b,2),lm(n,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),n[2]&=-41,512&n[2]&&(n[2]&=-513,em(n[3],-1))}finally{am()}}}function by(t,n,e,i,r){const o=Jr(),s=2&i;try{Ya(-1),s&&n.length>22&&Xb(t,n,22,!1),e(i,r)}finally{Ya(o)}}function yy(t,n,e){if(Kg(n)){const r=n.directiveEnd;for(let o=n.directiveStart;o<r;o++){const s=t.data[o];s.contentQueries&&s.contentQueries(1,e[o],o)}}}function $_(t,n,e){!c1()||(function vP(t,n,e,i){const r=e.directiveStart,o=e.directiveEnd;t.firstCreatePass||hd(e,n),Rr(i,n);const s=e.initialInputs;for(let a=r;a<o;a++){const h=t.data[a],b=ys(h);b&&xP(n,e,h);const ee=pd(n,t,a,e);Rr(ee,n),null!==s&&EP(0,a-r,ee,h,0,s),b&&(Mo(e.index,n)[8]=ee)}}(t,n,e,Io(e,n)),128==(128&e.flags)&&function bP(t,n,e){const i=e.directiveStart,r=e.directiveEnd,o=e.index,s=function HM(){return Sn.lFrame.currentDirectiveIndex}();try{Ya(o);for(let a=i;a<r;a++){const h=t.data[a],b=n[a];im(a),(null!==h.hostBindings||0!==h.hostVars||null!==h.hostAttrs)&&Iy(h,b)}}finally{Ya(-1),im(s)}}(t,n,e))}function v_(t,n,e=Io){const i=n.localNames;if(null!==i){let r=n.index+1;for(let o=0;o<i.length;o+=2){const s=i[o+1],a=-1===s?e(n,t):t[s];t[r++]=a}}}function Cy(t){const n=t.tView;return null===n||n.incompleteFirstPass?t.tView=b_(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):n}function b_(t,n,e,i,r,o,s,a,h,b){const ee=22+i,de=ee+r,ge=function fP(t,n){const e=[];for(let i=0;i<n;i++)e.push(i<t?null:Mn);return e}(ee,de),xe="function"==typeof b?b():b;return ge[1]={type:t,blueprint:ge,template:e,queries:null,viewQuery:a,declTNode:n,data:ge.slice().fill(null,ee),bindingStartIndex:ee,expandoStartIndex:de,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:h,consts:xe,incompleteFirstPass:!1}}function wy(t,n,e,i){const r=Py(n);null===e?r.push(i):(r.push(e),t.firstCreatePass&&Ny(t).push(i,r.length-1))}function xy(t,n,e){for(let i in t)if(t.hasOwnProperty(i)){const r=t[i];(e=null===e?{}:e).hasOwnProperty(i)?e[i].push(n,r):e[i]=[n,r]}return e}function Ey(t,n){const i=n.directiveEnd,r=t.data,o=n.attrs,s=[];let a=null,h=null;for(let b=n.directiveStart;b<i;b++){const ee=r[b],de=ee.inputs,ge=null===o||Kb(n)?null:TP(de,o);s.push(ge),a=xy(de,b,a),h=xy(ee.outputs,b,h)}null!==a&&(a.hasOwnProperty("class")&&(n.flags|=16),a.hasOwnProperty("style")&&(n.flags|=32)),n.initialInputs=s,n.inputs=a,n.outputs=h}function Po(t,n,e,i,r,o,s,a){const h=Io(n,e);let ee,b=n.inputs;!a&&null!=b&&(ee=b[i])?(T_(t,e,ee,i,r),eh(n)&&Ty(e,n.index)):3&n.type&&(i=function gP(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(i),r=null!=s?s(r,n.value||"",i):r,o.setProperty(h,i,r))}function Ty(t,n){const e=Mo(n,t);16&e[2]||(e[2]|=32)}function y_(t,n,e,i){let r=!1;if(c1()){const o=function yP(t,n,e){const i=t.directiveRegistry;let r=null;if(i)for(let o=0;o<i.length;o++){const s=i[o];Yb(e,s.selectors,!1)&&(r||(r=[]),dh(hd(e,n),t,s.type),ys(s)?(My(t,e),r.unshift(s)):r.push(s))}return r}(t,n,e),s=null===i?null:{"":-1};if(null!==o){r=!0,ky(e,t.data.length,o.length);for(let ee=0;ee<o.length;ee++){const de=o[ee];de.providersResolver&&de.providersResolver(de)}let a=!1,h=!1,b=ru(t,n,o.length,null);for(let ee=0;ee<o.length;ee++){const de=o[ee];e.mergedAttrs=lh(e.mergedAttrs,de.hostAttrs),Dy(t,e,n,b,de),wP(b,de,s),null!==de.contentQueries&&(e.flags|=8),(null!==de.hostBindings||null!==de.hostAttrs||0!==de.hostVars)&&(e.flags|=128);const ge=de.type.prototype;!a&&(ge.ngOnChanges||ge.ngOnInit||ge.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(e.index),a=!0),!h&&(ge.ngOnChanges||ge.ngDoCheck)&&((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(e.index),h=!0),b++}Ey(t,e)}s&&function CP(t,n,e){if(n){const i=t.localNames=[];for(let r=0;r<n.length;r+=2){const o=e[n[r+1]];if(null==o)throw new et(-301,!1);i.push(n[r],o)}}}(e,i,s)}return e.mergedAttrs=lh(e.mergedAttrs,e.attrs),r}function Sy(t,n,e,i,r,o){const s=o.hostBindings;if(s){let a=t.hostBindingOpCodes;null===a&&(a=t.hostBindingOpCodes=[]);const h=~n.index;(function $P(t){let n=t.length;for(;n>0;){const e=t[--n];if("number"==typeof e&&e<0)return e}return 0})(a)!=h&&a.push(h),a.push(i,r,s)}}function Iy(t,n){null!==t.hostBindings&&t.hostBindings(1,n)}function My(t,n){n.flags|=2,(t.components||(t.components=[])).push(n.index)}function wP(t,n,e){if(e){if(n.exportAs)for(let i=0;i<n.exportAs.length;i++)e[n.exportAs[i]]=t;ys(n)&&(e[""]=t)}}function ky(t,n,e){t.flags|=1,t.directiveStart=n,t.directiveEnd=n+e,t.providerIndexes=n}function Dy(t,n,e,i,r){t.data[i]=r;const o=r.factory||(r.factory=jl(r.type)),s=new dd(o,ys(r),He);t.blueprint[i]=s,e[i]=s,Sy(t,n,0,i,ru(t,e,r.hostVars,Mn),r)}function xP(t,n,e){const i=Io(n,t),r=Cy(e),o=t[10],s=Lh(t,Fh(t,r,null,e.onPush?32:16,i,n,o,o.createRenderer(i,e),null,null,null));t[n.index]=s}function Vs(t,n,e,i,r,o){const s=Io(t,n);!function C_(t,n,e,i,r,o,s){if(null==o)t.removeAttribute(n,r,e);else{const a=null==s?zt(o):s(o,i||"",r);t.setAttribute(n,r,a,e)}}(n[11],s,o,t.value,e,i,r)}function EP(t,n,e,i,r,o){const s=o[n];if(null!==s){const a=i.setInput;for(let h=0;h<s.length;){const b=s[h++],ee=s[h++],de=s[h++];null!==a?i.setInput(e,de,b,ee):e[ee]=de}}}function TP(t,n){let e=null,i=0;for(;i<n.length;){const r=n[i];if(0!==r)if(5!==r){if("number"==typeof r)break;t.hasOwnProperty(r)&&(null===e&&(e=[]),e.push(r,t[r],n[i+1])),i+=2}else i+=2;else i+=4}return e}function Ay(t,n,e,i){return new Array(t,!0,!1,n,null,0,i,e,null,null)}function MP(t,n){const e=Mo(n,t);if(ih(e)){const i=e[1];48&e[2]?Rh(i,e,i.template,e[8]):e[5]>0&&w_(e)}}function w_(t){for(let i=km(t);null!==i;i=Dm(i))for(let r=10;r<i.length;r++){const o=i[r];if(ih(o))if(512&o[2]){const s=o[1];Rh(s,o,s.template,o[8])}else o[5]>0&&w_(o)}const e=t[1].components;if(null!==e)for(let i=0;i<e.length;i++){const r=Mo(e[i],t);ih(r)&&r[5]>0&&w_(r)}}function kP(t,n){const e=Mo(n,t),i=e[1];(function DP(t,n){for(let e=n.length;e<t.blueprint.length;e++)n.push(t.blueprint[e])})(i,e),__(i,e,e[8])}function Lh(t,n){return t[13]?t[14][4]=n:t[13]=n,t[14]=n,n}function x_(t){for(;t;){t[2]|=32;const n=xd(t);if(yM(t)&&!n)return t;t=n}return null}function Bh(t,n,e,i=!0){const r=n[10];r.begin&&r.begin();try{Rh(t,n,t.template,e)}catch(s){throw i&&Fy(n,s),s}finally{r.end&&r.end()}}function E_(t,n,e){om(0),n(t,e)}function Py(t){return t[7]||(t[7]=[])}function Ny(t){return t.cleanup||(t.cleanup=[])}function Fy(t,n){const e=t[9],i=e?e.get(eu,null):null;i&&i.handleError(n)}function T_(t,n,e,i,r){for(let o=0;o<e.length;){const s=e[o++],a=e[o++],h=n[s],b=t.data[s];null!==b.setInput?b.setInput(h,r,i,a):h[a]=r}}function wa(t,n,e){const i=nh(n,t);!function ab(t,n,e){t.setValue(n,e)}(t[11],i,e)}function zh(t,n,e){let i=e?t.styles:null,r=e?t.classes:null,o=0;if(null!==n)for(let s=0;s<n.length;s++){const a=n[s];"number"==typeof a?o=a:1==o?r=ot(r,a):2==o&&(i=ot(i,a+": "+n[++s]+";"))}e?t.styles=i:t.stylesWithoutHost=i,e?t.classes=r:t.classesWithoutHost=r}function jh(t,n,e,i,r=!1){for(;null!==e;){const o=n[e.index];if(null!==o&&i.push(er(o)),bs(o))for(let a=10;a<o.length;a++){const h=o[a],b=h[1].firstChild;null!==b&&jh(h[1],h,b,i)}const s=e.type;if(8&s)jh(t,n,e.child,i);else if(32&s){const a=Mm(e,n);let h;for(;h=a();)i.push(h)}else if(16&s){const a=$b(n,e);if(Array.isArray(a))i.push(...a);else{const h=xd(n[16]);jh(h[1],h,a,i,!0)}}e=r?e.projectionNext:e.next}return i}class Md{constructor(n,e){this._lView=n,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const n=this._lView,e=n[1];return jh(e,n,e.firstChild,[])}get context(){return this._lView[8]}set context(n){this._lView[8]=n}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[3];if(bs(n)){const e=n[8],i=e?e.indexOf(this):-1;i>-1&&(Nm(n,i),hh(e,i))}this._attachedToViewContainer=!1}cb(this._lView[1],this._lView)}onDestroy(n){wy(this._lView[1],this._lView,null,n)}markForCheck(){x_(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){Bh(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new et(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function cD(t,n){Ed(t,n,n[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new et(902,!1);this._appRef=n}}class AP extends Md{constructor(n){super(n),this._view=n}detectChanges(){const n=this._view;Bh(n[1],n,n[8],!1)}checkNoChanges(){}get context(){return null}}class S_ extends Mh{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const e=hi(n);return new kd(e,this.ngModule)}}function Ry(t){const n=[];for(let e in t)t.hasOwnProperty(e)&&n.push({propName:t[e],templateName:e});return n}class NP{constructor(n,e){this.injector=n,this.parentInjector=e}get(n,e,i){const r=this.injector.get(n,Jm,i);return r!==Jm||e===Jm?r:this.parentInjector.get(n,e,i)}}class kd extends Hb{constructor(n,e){super(),this.componentDef=n,this.ngModule=e,this.componentType=n.type,this.selector=function AA(t){return t.map(DA).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return Ry(this.componentDef.inputs)}get outputs(){return Ry(this.componentDef.outputs)}create(n,e,i,r){let o=(r=r||this.ngModule)instanceof Xc?r:r?.injector;o&&null!==this.componentDef.getStandaloneInjector&&(o=this.componentDef.getStandaloneInjector(o)||o);const s=o?new NP(n,o):n,a=s.get(Id,null);if(null===a)throw new et(407,!1);const h=s.get(fA,null),b=a.createRenderer(null,this.componentDef),ee=this.componentDef.selectors[0][0]||"div",de=i?function hP(t,n,e){return t.selectRootElement(n,e===$s.ShadowDom)}(b,i,this.componentDef.encapsulation):Pm(b,ee,function PP(t){const n=t.toLowerCase();return"svg"===n?"svg":"math"===n?"math":null}(ee)),ge=this.componentDef.onPush?288:272,xe=b_(0,null,null,1,0,null,null,null,null,null),ke=Fh(null,xe,null,ge,null,null,a,b,h,s,null);let Pe,Oe;sm(ke);try{const je=function RP(t,n,e,i,r,o){const s=e[1];e[22]=t;const h=iu(s,22,2,"#host",null),b=h.mergedAttrs=n.hostAttrs;null!==b&&(zh(h,b,!0),null!==t&&(ah(r,t,b),null!==h.classes&&zm(r,t,h.classes),null!==h.styles&&bb(r,t,h.styles)));const ee=i.createRenderer(t,n),de=Fh(e,Cy(n),null,n.onPush?32:16,e[22],h,i,ee,o||null,null,null);return s.firstCreatePass&&(dh(hd(h,e),s,n.type),My(s,h),ky(h,e.length,1)),Lh(e,de),e[22]=de}(de,this.componentDef,ke,a,b);if(de)if(i)ah(b,de,["ng-version",hA.full]);else{const{attrs:qe,classes:Ve}=function PA(t){const n=[],e=[];let i=1,r=2;for(;i<t.length;){let o=t[i];if("string"==typeof o)2===r?""!==o&&n.push(o,t[++i]):8===r&&e.push(o);else{if(!ws(r))break;r=o}i++}return{attrs:n,classes:e}}(this.componentDef.selectors[0]);qe&&ah(b,de,qe),Ve&&Ve.length>0&&zm(b,de,Ve.join(" "))}if(Oe=Jg(xe,22),void 0!==e){const qe=Oe.projection=[];for(let Ve=0;Ve<this.ngContentSelectors.length;Ve++){const We=e[Ve];qe.push(null!=We?Array.from(We):null)}}Pe=function LP(t,n,e,i){const r=e[1],o=function _P(t,n,e){const i=sr();t.firstCreatePass&&(e.providersResolver&&e.providersResolver(e),Dy(t,i,n,ru(t,n,1,null),e),Ey(t,i));const r=pd(n,t,i.directiveStart,i);Rr(r,n);const o=Io(i,n);return o&&Rr(o,n),r}(r,e,n);if(t[8]=e[8]=o,null!==i)for(const a of i)a(o,n);if(n.contentQueries){const a=sr();n.contentQueries(1,o,a.directiveStart)}const s=sr();return!r.firstCreatePass||null===n.hostBindings&&null===n.hostAttrs||(Ya(s.index),Sy(e[1],s,0,s.directiveStart,s.directiveEnd,n),Iy(n,o)),o}(je,this.componentDef,ke,[BP]),__(xe,ke,null)}finally{am()}return new FP(this.componentType,Pe,Jc(Oe,ke),ke,Oe)}}class FP extends class sA{}{constructor(n,e,i,r,o){super(),this.location=i,this._rootLView=r,this._tNode=o,this.instance=e,this.hostView=this.changeDetectorRef=new AP(r),this.componentType=n}setInput(n,e){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[n])){const o=this._rootLView;T_(o[1],o,r,n,e),Ty(o,this._tNode.index)}}get injector(){return new Uc(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}function BP(){const t=sr();rh(kt()[1],t)}function pi(t){let n=function Ly(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),e=!0;const i=[t];for(;n;){let r;if(ys(t))r=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new et(903,!1);r=n.\u0275dir}if(r){if(e){i.push(r);const s=t;s.inputs=I_(t.inputs),s.declaredInputs=I_(t.declaredInputs),s.outputs=I_(t.outputs);const a=r.hostBindings;a&&HP(t,a);const h=r.viewQuery,b=r.contentQueries;if(h&&jP(t,h),b&&UP(t,b),Ge(t.inputs,r.inputs),Ge(t.declaredInputs,r.declaredInputs),Ge(t.outputs,r.outputs),ys(r)&&r.data.animation){const ee=t.data;ee.animation=(ee.animation||[]).concat(r.data.animation)}}const o=r.features;if(o)for(let s=0;s<o.length;s++){const a=o[s];a&&a.ngInherit&&a(t),a===pi&&(e=!1)}}n=Object.getPrototypeOf(n)}!function zP(t){let n=0,e=null;for(let i=t.length-1;i>=0;i--){const r=t[i];r.hostVars=n+=r.hostVars,r.hostAttrs=lh(r.hostAttrs,e=lh(e,r.hostAttrs))}}(i)}function I_(t){return t===Nc?{}:t===li?[]:t}function jP(t,n){const e=t.viewQuery;t.viewQuery=e?(i,r)=>{n(i,r),e(i,r)}:n}function UP(t,n){const e=t.contentQueries;t.contentQueries=e?(i,r,o)=>{n(i,r,o),e(i,r,o)}:n}function HP(t,n){const e=t.hostBindings;t.hostBindings=e?(i,r)=>{n(i,r),e(i,r)}:n}let Uh=null;function Wl(){if(!Uh){const t=wi.Symbol;if(t&&t.iterator)Uh=t.iterator;else{const n=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<n.length;++e){const i=n[e];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(Uh=i)}}}return Uh}function Dd(t){return!!M_(t)&&(Array.isArray(t)||!(t instanceof Map)&&Wl()in t)}function M_(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Gs(t,n,e){return t[n]=e}function Ad(t,n){return t[n]}function Lr(t,n,e){return!Object.is(t[n],e)&&(t[n]=e,!0)}function Kl(t,n,e,i){const r=Lr(t,n,e);return Lr(t,n+1,i)||r}function Hh(t,n,e,i,r){const o=Kl(t,n,e,i);return Lr(t,n+2,r)||o}function Jo(t,n,e,i,r,o){const s=Kl(t,n,e,i);return Kl(t,n+2,r,o)||s}function Qt(t,n,e,i){const r=kt();return Lr(r,Bc(),n)&&(ei(),Vs(zi(),r,t,n,e,i)),Qt}function su(t,n,e,i){return Lr(t,Bc(),e)?n+zt(e)+i:Mn}function au(t,n,e,i,r,o){const a=Kl(t,function _a(){return Sn.lFrame.bindingIndex}(),e,r);return $a(2),a?n+zt(e)+i+zt(r)+o:Mn}function k_(t,n,e,i,r,o){const s=kt(),a=su(s,n,e,i);return a!==Mn&&Vs(zi(),s,t,a,r,o),k_}function Te(t,n,e,i,r,o,s,a){const h=kt(),b=ei(),ee=t+22,de=b.firstCreatePass?function XP(t,n,e,i,r,o,s,a,h){const b=n.consts,ee=iu(n,t,4,s||null,Ka(b,a));y_(n,e,ee,Ka(b,h)),rh(n,ee);const de=ee.tViews=b_(2,ee,i,r,o,n.directiveRegistry,n.pipeRegistry,null,n.schemas,b);return null!==n.queries&&(n.queries.template(n,ee),de.queries=n.queries.embeddedTView(ee)),ee}(ee,b,h,n,e,i,r,o,s):b.data[ee];js(de,!1);const ge=h[11].createComment("");yh(b,h,ge,de),Rr(ge,h),Lh(h,h[ee]=Ay(ge,h,ge,de)),th(de)&&$_(b,h,de),null!=s&&v_(h,de,a)}function cn(t){return Lc(function zM(){return Sn.lFrame.contextLView}(),22+t)}function oe(t,n,e){const i=kt();return Lr(i,Bc(),n)&&Po(ei(),zi(),i,t,n,i[11],e,!1),oe}function D_(t,n,e,i,r){const s=r?"class":"style";T_(t,e,n.inputs[s],s,i)}function Q(t,n,e,i){const r=kt(),o=ei(),s=22+t,a=r[11],h=r[s]=Pm(a,n,function XM(){return Sn.lFrame.currentNamespace}()),b=o.firstCreatePass?function JP(t,n,e,i,r,o,s){const a=n.consts,b=iu(n,t,2,r,Ka(a,o));return y_(n,e,b,Ka(a,s)),null!==b.attrs&&zh(b,b.attrs,!1),null!==b.mergedAttrs&&zh(b,b.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,b),b}(s,o,r,0,n,e,i):o.data[s];js(b,!0);const ee=b.mergedAttrs;null!==ee&&ah(a,h,ee);const de=b.classes;null!==de&&zm(a,h,de);const ge=b.styles;return null!==ge&&bb(a,h,ge),64!=(64&b.flags)&&yh(o,r,h,b),0===function OM(){return Sn.lFrame.elementDepthCount}()&&Rr(h,r),function FM(){Sn.lFrame.elementDepthCount++}(),th(b)&&($_(o,r,b),yy(o,b,r)),null!==i&&v_(r,b),Q}function ne(){let t=sr();tm()?nm():(t=t.parent,js(t,!1));const n=t;!function RM(){Sn.lFrame.elementDepthCount--}();const e=ei();return e.firstCreatePass&&(rh(e,t),Kg(t)&&e.queries.elementEnd(t)),null!=n.classesWithoutHost&&function nk(t){return 0!=(16&t.flags)}(n)&&D_(e,n,kt(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function ik(t){return 0!=(32&t.flags)}(n)&&D_(e,n,kt(),n.stylesWithoutHost,!1),ne}function mt(t,n,e,i){return Q(t,n,e,i),ne(),mt}function it(t,n,e){const i=kt(),r=ei(),o=t+22,s=r.firstCreatePass?function e4(t,n,e,i,r){const o=n.consts,s=Ka(o,i),a=iu(n,t,8,"ng-container",s);return null!==s&&zh(a,s,!0),y_(n,e,a,Ka(o,r)),null!==n.queries&&n.queries.elementStart(n,a),a}(o,r,i,n,e):r.data[o];js(s,!0);const a=i[o]=i[11].createComment("");return yh(r,i,a,s),Rr(a,i),th(s)&&($_(r,i,s),yy(r,s,i)),null!=e&&v_(i,s),it}function rt(){let t=sr();const n=ei();return tm()?nm():(t=t.parent,js(t,!1)),n.firstCreatePass&&(rh(n,t),Kg(t)&&n.queries.elementEnd(t)),rt}function Pn(t,n,e){return it(t,n,e),rt(),Pn}function ft(){return kt()}function Vh(t){return!!t&&"function"==typeof t.then}const Ky=function Wy(t){return!!t&&"function"==typeof t.subscribe};function Ae(t,n,e,i){const r=kt(),o=ei(),s=sr();return function Zy(t,n,e,i,r,o,s,a){const h=th(i),ee=t.firstCreatePass&&Ny(t),de=n[8],ge=Py(n);let xe=!0;if(3&i.type||a){const Oe=Io(i,n),je=a?a(Oe):Oe,qe=ge.length,Ve=a?vt=>a(er(vt[i.index])):i.index;let We=null;if(!a&&h&&(We=function t4(t,n,e,i){const r=t.cleanup;if(null!=r)for(let o=0;o<r.length-1;o+=2){const s=r[o];if(s===e&&r[o+1]===i){const a=n[7],h=r[o+2];return a.length>h?a[h]:null}"string"==typeof s&&(o+=2)}return null}(t,n,r,i.index)),null!==We)(We.__ngLastListenerFn__||We).__ngNextListenerFn__=o,We.__ngLastListenerFn__=o,xe=!1;else{o=Qy(i,n,de,o,!1);const vt=e.listen(je,r,o);ge.push(o,vt),ee&&ee.push(r,Ve,qe,qe+1)}}else o=Qy(i,n,de,o,!1);const ke=i.outputs;let Pe;if(xe&&null!==ke&&(Pe=ke[r])){const Oe=Pe.length;if(Oe)for(let je=0;je<Oe;je+=2){const nt=n[Pe[je]][Pe[je+1]].subscribe(o),_t=ge.length;ge.push(o,nt),ee&&ee.push(r,i.index,_t,-(_t+1))}}}(o,r,r[11],s,t,n,0,i),Ae}function Xy(t,n,e,i){try{return!1!==e(i)}catch(r){return Fy(t,r),!1}}function Qy(t,n,e,i,r){return function o(s){if(s===Function)return i;x_(2&t.flags?Mo(t.index,n):n);let h=Xy(n,0,i,s),b=o.__ngNextListenerFn__;for(;b;)h=Xy(n,0,b,s)&&h,b=b.__ngNextListenerFn__;return r&&!1===h&&(s.preventDefault(),s.returnValue=!1),h}}function me(t=1){return function GM(t){return(Sn.lFrame.contextLView=function qM(t,n){for(;t>0;)n=n[15],t--;return n}(t,Sn.lFrame.contextLView))[8]}(t)}function n4(t,n){let e=null;const i=function SA(t){const n=t.attrs;if(null!=n){const e=n.indexOf(5);if(0==(1&e))return n[e+1]}return null}(t);for(let r=0;r<n.length;r++){const o=n[r];if("*"!==o){if(null===i?Yb(t,o,!0):kA(i,o))return r}else e=r}return e}function A_(t){const n=kt()[16][6];if(!n.projection){const i=n.projection=_d(t?t.length:1,null),r=i.slice();let o=n.child;for(;null!==o;){const s=t?n4(o,t):0;null!==s&&(r[s]?r[s].projectionNext=o:i[s]=o,r[s]=o),o=o.next}}}function P_(t,n=0,e){const i=kt(),r=ei(),o=iu(r,22+t,16,null,e||null);null===o.projection&&(o.projection=n),nm(),64!=(64&o.flags)&&function _D(t,n,e){vb(n[11],0,n,e,ub(t,e,n),pb(e.parent||n[6],e,n))}(r,i,o)}function xt(t,n,e){return cr(t,"",n,"",e),xt}function cr(t,n,e,i,r){const o=kt(),s=su(o,n,e,i);return s!==Mn&&Po(ei(),zi(),o,t,s,o[11],r,!1),cr}function aC(t,n,e,i,r){const o=t[e+1],s=null===n;let a=i?Es(o):Ca(o),h=!1;for(;0!==a&&(!1===h||s);){const ee=t[a+1];o4(t[a],n)&&(h=!0,t[a+1]=i?l_(ee):s_(ee)),a=i?Es(ee):Ca(ee)}h&&(t[e+1]=i?s_(o):l_(o))}function o4(t,n){return null===t||null==n||(Array.isArray(t)?t[1]:t)===n||!(!Array.isArray(t)||"string"!=typeof n)&&Wc(t,n)>=0}const ur={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function lC(t){return t.substring(ur.key,ur.keyEnd)}function s4(t){return t.substring(ur.value,ur.valueEnd)}function cC(t,n){const e=ur.textEnd;return e===n?-1:(n=ur.keyEnd=function c4(t,n,e){for(;n<e&&t.charCodeAt(n)>32;)n++;return n}(t,ur.key=n,e),pu(t,n,e))}function uC(t,n){const e=ur.textEnd;let i=ur.key=pu(t,n,e);return e===i?-1:(i=ur.keyEnd=function u4(t,n,e){let i;for(;n<e&&(45===(i=t.charCodeAt(n))||95===i||(-33&i)>=65&&(-33&i)<=90||i>=48&&i<=57);)n++;return n}(t,i,e),i=fC(t,i,e),i=ur.value=pu(t,i,e),i=ur.valueEnd=function d4(t,n,e){let i=-1,r=-1,o=-1,s=n,a=s;for(;s<e;){const h=t.charCodeAt(s++);if(59===h)return a;34===h||39===h?a=s=hC(t,h,s,e):n===s-4&&85===o&&82===r&&76===i&&40===h?a=s=hC(t,41,s,e):h>32&&(a=s),o=r,r=i,i=-33&h}return a}(t,i,e),fC(t,i,e))}function dC(t){ur.key=0,ur.keyEnd=0,ur.value=0,ur.valueEnd=0,ur.textEnd=t.length}function pu(t,n,e){for(;n<e&&t.charCodeAt(n)<=32;)n++;return n}function fC(t,n,e,i){return(n=pu(t,n,e))<e&&n++,n}function hC(t,n,e,i){let r=-1,o=e;for(;o<i;){const s=t.charCodeAt(o++);if(s==n&&92!==r)return o;r=92==s&&92===r?0:s}throw new Error}function ut(t,n,e){return Ts(t,n,e,!1),ut}function Gh(t,n){return Ts(t,n,null,!0),Gh}function Sr(t){Ss(mC,f4,t,!1)}function f4(t,n){for(let e=function l4(t){return dC(t),uC(t,pu(t,0,ur.textEnd))}(n);e>=0;e=uC(n,e))mC(t,lC(n),s4(n))}function Pd(t){Ss(Do,qs,t,!0)}function qs(t,n){for(let e=function a4(t){return dC(t),cC(t,pu(t,0,ur.textEnd))}(n);e>=0;e=cC(n,e))Do(t,lC(n),!0)}function Ts(t,n,e,i){const r=kt(),o=ei(),s=$a(2);o.firstUpdatePass&&gC(o,t,s,i),n!==Mn&&Lr(r,s,n)&&_C(o,o.data[Jr()],r,r[11],t,r[s+1]=function v4(t,n){return null==t||("string"==typeof n?t+=n:"object"==typeof t&&(t=Xe(Ao(t)))),t}(n,e),i,s)}function Ss(t,n,e,i){const r=ei(),o=$a(2);r.firstUpdatePass&&gC(r,null,o,i);const s=kt();if(e!==Mn&&Lr(s,o,e)){const a=r.data[Jr()];if(vC(a,i)&&!pC(r,o)){let h=i?a.classesWithoutHost:a.stylesWithoutHost;null!==h&&(e=ot(h,e||"")),D_(r,a,s,e,i)}else!function $4(t,n,e,i,r,o,s,a){r===Mn&&(r=li);let h=0,b=0,ee=0<r.length?r[0]:null,de=0<o.length?o[0]:null;for(;null!==ee||null!==de;){const ge=h<r.length?r[h+1]:void 0,xe=b<o.length?o[b+1]:void 0;let Pe,ke=null;ee===de?(h+=2,b+=2,ge!==xe&&(ke=de,Pe=xe)):null===de||null!==ee&&ee<de?(h+=2,ke=ee):(b+=2,ke=de,Pe=xe),null!==ke&&_C(t,n,e,i,ke,Pe,s,a),ee=h<r.length?r[h]:null,de=b<o.length?o[b]:null}}(r,a,s,s[11],s[o+1],s[o+1]=function _4(t,n,e){if(null==e||""===e)return li;const i=[],r=Ao(e);if(Array.isArray(r))for(let o=0;o<r.length;o++)t(i,r[o],!0);else if("object"==typeof r)for(const o in r)r.hasOwnProperty(o)&&t(i,o,r[o]);else"string"==typeof r&&n(i,r);return i}(t,n,e),i,o)}}function pC(t,n){return n>=t.expandoStartIndex}function gC(t,n,e,i){const r=t.data;if(null===r[e+1]){const o=r[Jr()],s=pC(t,e);vC(o,i)&&null===n&&!s&&(n=!1),n=function h4(t,n,e,i){const r=function rm(t){const n=Sn.lFrame.currentDirectiveIndex;return-1===n?null:t[n]}(t);let o=i?n.residualClasses:n.residualStyles;if(null===r)0===(i?n.classBindings:n.styleBindings)&&(e=Nd(e=N_(null,t,n,e,i),n.attrs,i),o=null);else{const s=n.directiveStylingLast;if(-1===s||t[s]!==r)if(e=N_(r,t,n,e,i),null===o){let h=function p4(t,n,e){const i=e?n.classBindings:n.styleBindings;if(0!==Ca(i))return t[Es(i)]}(t,n,i);void 0!==h&&Array.isArray(h)&&(h=N_(null,t,n,h[1],i),h=Nd(h,n.attrs,i),function g4(t,n,e,i){t[Es(e?n.classBindings:n.styleBindings)]=i}(t,n,i,h))}else o=function m4(t,n,e){let i;const r=n.directiveEnd;for(let o=1+n.directiveStylingLast;o<r;o++)i=Nd(i,t[o].hostAttrs,e);return Nd(i,n.attrs,e)}(t,n,i)}return void 0!==o&&(i?n.residualClasses=o:n.residualStyles=o),e}(r,o,n,i),function i4(t,n,e,i,r,o){let s=o?n.classBindings:n.styleBindings,a=Es(s),h=Ca(s);t[i]=e;let ee,b=!1;if(Array.isArray(e)){const de=e;ee=de[1],(null===ee||Wc(de,ee)>0)&&(b=!0)}else ee=e;if(r)if(0!==h){const ge=Es(t[a+1]);t[i+1]=Ph(ge,a),0!==ge&&(t[ge+1]=a_(t[ge+1],i)),t[a+1]=function JA(t,n){return 131071&t|n<<17}(t[a+1],i)}else t[i+1]=Ph(a,0),0!==a&&(t[a+1]=a_(t[a+1],i)),a=i;else t[i+1]=Ph(h,0),0===a?a=i:t[h+1]=a_(t[h+1],i),h=i;b&&(t[i+1]=s_(t[i+1])),aC(t,ee,i,!0),aC(t,ee,i,!1),function r4(t,n,e,i,r){const o=r?t.residualClasses:t.residualStyles;null!=o&&"string"==typeof n&&Wc(o,n)>=0&&(e[i+1]=l_(e[i+1]))}(n,ee,t,i,o),s=Ph(a,h),o?n.classBindings=s:n.styleBindings=s}(r,o,n,e,s,i)}}function N_(t,n,e,i,r){let o=null;const s=e.directiveEnd;let a=e.directiveStylingLast;for(-1===a?a=e.directiveStart:a++;a<s&&(o=n[a],i=Nd(i,o.hostAttrs,r),o!==t);)a++;return null!==t&&(e.directiveStylingLast=a),i}function Nd(t,n,e){const i=e?1:2;let r=-1;if(null!==n)for(let o=0;o<n.length;o++){const s=n[o];"number"==typeof s?r=s:r===i&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),Do(t,s,!!e||n[++o]))}return void 0===t?null:t}function mC(t,n,e){Do(t,n,Ao(e))}function _C(t,n,e,i,r,o,s,a){if(!(3&n.type))return;const h=t.data,b=h[a+1];qh(function dy(t){return 1==(1&t)}(b)?$C(h,n,e,r,Ca(b),s):void 0)||(qh(o)||function uy(t){return 2==(2&t)}(b)&&(o=$C(h,null,e,r,a,s)),function vD(t,n,e,i,r){if(n)r?t.addClass(e,i):t.removeClass(e,i);else{let o=-1===i.indexOf("-")?void 0:go.DashCase;null==r?t.removeStyle(e,i,o):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=go.Important),t.setStyle(e,i,r,o))}}(i,s,nh(Jr(),e),r,o))}function $C(t,n,e,i,r,o){const s=null===n;let a;for(;r>0;){const h=t[r],b=Array.isArray(h),ee=b?h[1]:h,de=null===ee;let ge=e[r+1];ge===Mn&&(ge=de?li:void 0);let xe=de?_m(ge,i):ee===i?ge:void 0;if(b&&!qh(xe)&&(xe=_m(h,i)),qh(xe)&&(a=xe,s))return a;const ke=t[r+1];r=s?Es(ke):Ca(ke)}if(null!==n){let h=o?n.residualClasses:n.residualStyles;null!=h&&(a=_m(h,i))}return a}function qh(t){return void 0!==t}function vC(t,n){return 0!=(t.flags&(n?16:32))}function ve(t,n=""){const e=kt(),i=ei(),r=t+22,o=i.firstCreatePass?iu(i,r,1,n,null):i.data[r],s=e[r]=function Am(t,n){return t.createText(n)}(e[11],n);yh(i,e,s,o),js(o,!1)}function lt(t){return Zn("",t,""),lt}function Zn(t,n,e){const i=kt(),r=su(i,t,n,e);return r!==Mn&&wa(i,Jr(),r),Zn}function Ja(t,n,e,i,r){const o=kt(),s=au(o,t,n,e,i,r);return s!==Mn&&wa(o,Jr(),s),Ja}const Yl=void 0;var B4=["en",[["a","p"],["AM","PM"],Yl],[["AM","PM"],Yl,Yl],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Yl,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Yl,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Yl,"{1} 'at' {0}",Yl],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function L4(t){const e=Math.floor(Math.abs(t)),i=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===i?1:5}];let gu={};function to(t){const n=function z4(t){return t.toLowerCase().replace(/_/g,"-")}(t);let e=BC(n);if(e)return e;const i=n.split("-")[0];if(e=BC(i),e)return e;if("en"===i)return B4;throw new et(701,!1)}function BC(t){return t in gu||(gu[t]=wi.ng&&wi.ng.common&&wi.ng.common.locales&&wi.ng.common.locales[t]),gu[t]}var Wt=(()=>((Wt=Wt||{})[Wt.LocaleId=0]="LocaleId",Wt[Wt.DayPeriodsFormat=1]="DayPeriodsFormat",Wt[Wt.DayPeriodsStandalone=2]="DayPeriodsStandalone",Wt[Wt.DaysFormat=3]="DaysFormat",Wt[Wt.DaysStandalone=4]="DaysStandalone",Wt[Wt.MonthsFormat=5]="MonthsFormat",Wt[Wt.MonthsStandalone=6]="MonthsStandalone",Wt[Wt.Eras=7]="Eras",Wt[Wt.FirstDayOfWeek=8]="FirstDayOfWeek",Wt[Wt.WeekendRange=9]="WeekendRange",Wt[Wt.DateFormat=10]="DateFormat",Wt[Wt.TimeFormat=11]="TimeFormat",Wt[Wt.DateTimeFormat=12]="DateTimeFormat",Wt[Wt.NumberSymbols=13]="NumberSymbols",Wt[Wt.NumberFormats=14]="NumberFormats",Wt[Wt.CurrencyCode=15]="CurrencyCode",Wt[Wt.CurrencySymbol=16]="CurrencySymbol",Wt[Wt.CurrencyName=17]="CurrencyName",Wt[Wt.Currencies=18]="Currencies",Wt[Wt.Directionality=19]="Directionality",Wt[Wt.PluralCase=20]="PluralCase",Wt[Wt.ExtraData=21]="ExtraData",Wt))();const mu="en-US";let zC=mu;function R_(t,n,e,i,r){if(t=gt(t),Array.isArray(t))for(let o=0;o<t.length;o++)R_(t[o],n,e,i,r);else{const o=ei(),s=kt();let a=Gl(t)?t:gt(t.provide),h=Ub(t);const b=sr(),ee=1048575&b.providerIndexes,de=b.directiveStart,ge=b.providerIndexes>>20;if(Gl(t)||!t.multi){const xe=new dd(h,r,He),ke=B_(a,n,r?ee:ee+ge,de);-1===ke?(dh(hd(b,s),o,a),L_(o,t,n.length),n.push(a),b.directiveStart++,b.directiveEnd++,r&&(b.providerIndexes+=1048576),e.push(xe),s.push(xe)):(e[ke]=xe,s[ke]=xe)}else{const xe=B_(a,n,ee+ge,de),ke=B_(a,n,ee,ee+ge),Pe=xe>=0&&e[xe],Oe=ke>=0&&e[ke];if(r&&!Oe||!r&&!Pe){dh(hd(b,s),o,a);const je=function RN(t,n,e,i,r){const o=new dd(t,e,He);return o.multi=[],o.index=n,o.componentProviders=0,d2(o,r,i&&!e),o}(r?FN:ON,e.length,r,i,h);!r&&Oe&&(e[ke].providerFactory=je),L_(o,t,n.length,0),n.push(a),b.directiveStart++,b.directiveEnd++,r&&(b.providerIndexes+=1048576),e.push(je),s.push(je)}else L_(o,t,xe>-1?xe:ke,d2(e[r?ke:xe],h,!r&&i));!r&&i&&Oe&&e[ke].componentProviders++}}}function L_(t,n,e,i){const r=Gl(n),o=function QD(t){return!!t.useClass}(n);if(r||o){const h=(o?gt(n.useClass):n).prototype.ngOnDestroy;if(h){const b=t.destroyHooks||(t.destroyHooks=[]);if(!r&&n.multi){const ee=b.indexOf(e);-1===ee?b.push(e,[i,h]):b[ee+1].push(i,h)}else b.push(e,h)}}}function d2(t,n,e){return e&&t.componentProviders++,t.multi.push(n)-1}function B_(t,n,e,i){for(let r=e;r<i;r++)if(n[r]===t)return r;return-1}function ON(t,n,e,i){return z_(this.multi,[])}function FN(t,n,e,i){const r=this.multi;let o;if(this.providerFactory){const s=this.providerFactory.componentProviders,a=pd(e,e[1],this.providerFactory.index,i);o=a.slice(0,s),z_(r,o);for(let h=s;h<a.length;h++)o.push(a[h])}else o=[],z_(r,o);return o}function z_(t,n){for(let e=0;e<t.length;e++)n.push((0,t[e])());return n}function Ti(t,n=[]){return e=>{e.providersResolver=(i,r)=>function NN(t,n,e){const i=ei();if(i.firstCreatePass){const r=ys(t);R_(e,i.data,i.blueprint,r,!0),R_(n,i.data,i.blueprint,r,!1)}}(i,r?r(t):t,n)}}class _u{}class f2 extends _u{constructor(n,e){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new S_(this);const i=function To(t,n){const e=t[Qv]||null;if(!e&&!0===n)throw new Error(`Type ${Xe(t)} does not have '\u0275mod' property.`);return e}(n);this._bootstrapComponents=function ya(t){return t instanceof Function?t():t}(i.bootstrap),this._r3Injector=ny(n,e,[{provide:_u,useValue:this},{provide:Mh,useValue:this.componentFactoryResolver}],Xe(n),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(n)}get injector(){return this._r3Injector}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class j_ extends class LN{}{constructor(n){super(),this.moduleType=n}create(n){return new f2(this.moduleType,n)}}function xa(t,n,e){const i=Qr()+t,r=kt();return r[i]===Mn?Gs(r,i,e?n.call(e):n()):Ad(r,i)}function wt(t,n,e,i){return function b2(t,n,e,i,r,o){const s=n+e;return Lr(t,s,r)?Gs(t,s+1,o?i.call(o,r):i(r)):zd(t,s+1)}(kt(),Qr(),t,n,e,i)}function un(t,n,e,i,r){return y2(kt(),Qr(),t,n,e,i,r)}function mo(t,n,e,i,r,o){return function C2(t,n,e,i,r,o,s,a){const h=n+e;return Hh(t,h,r,o,s)?Gs(t,h+3,a?i.call(a,r,o,s):i(r,o,s)):zd(t,h+3)}(kt(),Qr(),t,n,e,i,r,o)}function Is(t,n,e,i,r,o,s){return function w2(t,n,e,i,r,o,s,a,h){const b=n+e;return Jo(t,b,r,o,s,a)?Gs(t,b+4,h?i.call(h,r,o,s,a):i(r,o,s,a)):zd(t,b+4)}(kt(),Qr(),t,n,e,i,r,o,s)}function H_(t,n,e,i,r,o,s,a,h){const b=Qr()+t,ee=kt(),de=Jo(ee,b,e,i,r,o);return Kl(ee,b+4,s,a)||de?Gs(ee,b+6,h?n.call(h,e,i,r,o,s,a):n(e,i,r,o,s,a)):Ad(ee,b+6)}function $u(t,n,e,i,r,o,s,a,h,b){const ee=Qr()+t,de=kt();let ge=Jo(de,ee,e,i,r,o);return Hh(de,ee+4,s,a,h)||ge?Gs(de,ee+7,b?n.call(b,e,i,r,o,s,a,h):n(e,i,r,o,s,a,h)):Ad(de,ee+7)}function Ms(t,n,e,i,r,o,s,a,h,b,ee){const de=Qr()+t,ge=kt(),xe=Jo(ge,de,e,i,r,o);return Jo(ge,de+4,s,a,h,b)||xe?Gs(ge,de+8,ee?n.call(ee,e,i,r,o,s,a,h,b):n(e,i,r,o,s,a,h,b)):Ad(ge,de+8)}function zd(t,n){const e=t[n];return e===Mn?void 0:e}function y2(t,n,e,i,r,o,s){const a=n+e;return Kl(t,a,r,o)?Gs(t,a+2,s?i.call(s,r,o):i(r,o)):zd(t,a+2)}function Lt(t,n){const e=ei();let i;const r=t+22;e.firstCreatePass?(i=function JN(t,n){if(n)for(let e=n.length-1;e>=0;e--){const i=n[e];if(t===i.name)return i}}(n,e.pipeRegistry),e.data[r]=i,i.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(r,i.onDestroy)):i=e.data[r];const o=i.factory||(i.factory=jl(i.type)),s=Yo(He);try{const a=ch(!1),h=o();return ch(a),function QP(t,n,e,i){e>=t.data.length&&(t.data[e]=null,t.blueprint[e]=null),n[e]=i}(e,kt(),r,h),h}finally{Yo(s)}}function Bt(t,n,e,i){const r=t+22,o=kt(),s=Lc(o,r);return function jd(t,n){return t[1].data[n].pure}(o,r)?y2(o,Qr(),n,s.transform,e,i,s):s.transform(e,i)}function V_(t){return n=>{setTimeout(t,void 0,n)}}const Hn=class r5 extends u{constructor(n=!1){super(),this.__isAsync=n}emit(n){super.next(n)}subscribe(n,e,i){let r=n,o=e||(()=>null),s=i;if(n&&"object"==typeof n){const h=n;r=h.next?.bind(h),o=h.error?.bind(h),s=h.complete?.bind(h)}this.__isAsync&&(o=V_(o),r&&(r=V_(r)),s&&(s=V_(s)));const a=super.subscribe({next:r,error:o,complete:s});return n instanceof w&&n.add(a),a}};function o5(){return this._results[Wl()]()}class G_{constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=Wl(),i=G_.prototype;i[e]||(i[e]=o5)}get changes(){return this._changes||(this._changes=new Hn)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,e){return this._results.reduce(n,e)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,e){const i=this;i.dirty=!1;const r=ko(n);(this._changesDetected=!function hk(t,n,e){if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++){let r=t[i],o=n[i];if(e&&(r=e(r),o=e(o)),o!==r)return!1}return!0}(i._results,r,e))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let Ea=(()=>{class t{}return t.__NG_ELEMENT_ID__=l5,t})();const s5=Ea,a5=class extends s5{constructor(n,e,i){super(),this._declarationLView=n,this._declarationTContainer=e,this.elementRef=i}createEmbeddedView(n,e){const i=this._declarationTContainer.tViews,r=Fh(this._declarationLView,i,n,16,null,i.declTNode,null,null,null,null,e||null);r[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(r[19]=s.createEmbeddedView(i)),__(i,r,n),new Md(r)}};function l5(){return Xh(sr(),kt())}function Xh(t,n){return 4&t.type?new a5(n,t,Jc(t,n)):null}let no=(()=>{class t{}return t.__NG_ELEMENT_ID__=c5,t})();function c5(){return S2(sr(),kt())}const u5=no,E2=class extends u5{constructor(n,e,i){super(),this._lContainer=n,this._hostTNode=e,this._hostLView=i}get element(){return Jc(this._hostTNode,this._hostLView)}get injector(){return new Uc(this._hostTNode,this._hostLView)}get parentInjector(){const n=uh(this._hostTNode,this._hostLView);if(x1(n)){const e=jc(n,this._hostLView),i=zc(n);return new Uc(e[1].data[i+8],e)}return new Uc(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const e=T2(this._lContainer);return null!==e&&e[n]||null}get length(){return this._lContainer.length-10}createEmbeddedView(n,e,i){let r,o;"number"==typeof i?r=i:null!=i&&(r=i.index,o=i.injector);const s=n.createEmbeddedView(e||{},o);return this.insert(s,r),s}createComponent(n,e,i,r,o){const s=n&&!function md(t){return"function"==typeof t}(n);let a;if(s)a=e;else{const de=e||{};a=de.index,i=de.injector,r=de.projectableNodes,o=de.environmentInjector||de.ngModuleRef}const h=s?n:new kd(hi(n)),b=i||this.parentInjector;if(!o&&null==h.ngModule){const ge=(s?b:this.parentInjector).get(Xc,null);ge&&(o=ge)}const ee=h.create(b,r,void 0,o);return this.insert(ee.hostView,a),ee}insert(n,e){const i=n._lView,r=i[1];if(function NM(t){return bs(t[3])}(i)){const ee=this.indexOf(n);if(-1!==ee)this.detach(ee);else{const de=i[3],ge=new E2(de,de[6],de[3]);ge.detach(ge.indexOf(n))}}const o=this._adjustIndex(e),s=this._lContainer;!function dD(t,n,e,i){const r=10+i,o=e.length;i>0&&(e[r-1][4]=n),i<o-10?(n[4]=e[r],O1(e,10+i,n)):(e.push(n),n[4]=null),n[3]=e;const s=n[17];null!==s&&e!==s&&function fD(t,n){const e=t[9];n[16]!==n[3][3][16]&&(t[2]=!0),null===e?t[9]=[n]:e.push(n)}(s,n);const a=n[19];null!==a&&a.insertView(t),n[2]|=64}(r,i,s,o);const a=Rm(o,s),h=i[11],b=bh(h,s[7]);return null!==b&&function lD(t,n,e,i,r,o){i[0]=r,i[6]=n,Ed(t,i,e,1,r,o)}(r,s[6],h,i,b,a),n.attachToViewContainerRef(),O1(q_(s),o,n),n}move(n,e){return this.insert(n,e)}indexOf(n){const e=T2(this._lContainer);return null!==e?e.indexOf(n):-1}remove(n){const e=this._adjustIndex(n,-1),i=Nm(this._lContainer,e);i&&(hh(q_(this._lContainer),e),cb(i[1],i))}detach(n){const e=this._adjustIndex(n,-1),i=Nm(this._lContainer,e);return i&&null!=hh(q_(this._lContainer),e)?new Md(i):null}_adjustIndex(n,e=0){return n??this.length+e}};function T2(t){return t[8]}function q_(t){return t[8]||(t[8]=[])}function S2(t,n){let e;const i=n[t.index];if(bs(i))e=i;else{let r;if(8&t.type)r=er(i);else{const o=n[11];r=o.createComment("");const s=Io(t,n);Ul(o,bh(o,s),r,function mD(t,n){return t.nextSibling(n)}(o,s),!1)}n[t.index]=e=Ay(i,n,r,t),Lh(n,e)}return new E2(e,t,n)}class W_{constructor(n){this.queryList=n,this.matches=null}clone(){return new W_(this.queryList)}setDirty(){this.queryList.setDirty()}}class K_{constructor(n=[]){this.queries=n}createEmbeddedView(n){const e=n.queries;if(null!==e){const i=null!==n.contentQueries?n.contentQueries[0]:e.length,r=[];for(let o=0;o<i;o++){const s=e.getByIndex(o);r.push(this.queries[s.indexInDeclarationView].clone())}return new K_(r)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let e=0;e<this.queries.length;e++)null!==A2(n,e).matches&&this.queries[e].setDirty()}}class I2{constructor(n,e,i=null){this.predicate=n,this.flags=e,this.read=i}}class Y_{constructor(n=[]){this.queries=n}elementStart(n,e){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(n,e)}elementEnd(n){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(n)}embeddedTView(n){let e=null;for(let i=0;i<this.length;i++){const r=null!==e?e.length:0,o=this.getByIndex(i).embeddedTView(n,r);o&&(o.indexInDeclarationView=i,null!==e?e.push(o):e=[o])}return null!==e?new Y_(e):null}template(n,e){for(let i=0;i<this.queries.length;i++)this.queries[i].template(n,e)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class Z_{constructor(n,e=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(n,e){this.isApplyingToNode(e)&&this.matchTNode(n,e)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,e){this.elementStart(n,e)}embeddedTView(n,e){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,e),new Z_(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let i=n.parent;for(;null!==i&&8&i.type&&i.index!==e;)i=i.parent;return e===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(n,e){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const o=i[r];this.matchTNodeWithReadOption(n,e,h5(e,o)),this.matchTNodeWithReadOption(n,e,fh(e,n,o,!1,!1))}else i===Ea?4&e.type&&this.matchTNodeWithReadOption(n,e,-1):this.matchTNodeWithReadOption(n,e,fh(e,n,i,!1,!1))}matchTNodeWithReadOption(n,e,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===Ai||r===no||r===Ea&&4&e.type)this.addMatch(e.index,-2);else{const o=fh(e,n,r,!1,!1);null!==o&&this.addMatch(e.index,o)}else this.addMatch(e.index,i)}}addMatch(n,e){null===this.matches?this.matches=[n,e]:this.matches.push(n,e)}}function h5(t,n){const e=t.localNames;if(null!==e)for(let i=0;i<e.length;i+=2)if(e[i]===n)return e[i+1];return null}function g5(t,n,e,i){return-1===e?function p5(t,n){return 11&t.type?Jc(t,n):4&t.type?Xh(t,n):null}(n,t):-2===e?function m5(t,n,e){return e===Ai?Jc(n,t):e===Ea?Xh(n,t):e===no?S2(n,t):void 0}(t,n,i):pd(t,t[1],e,n)}function M2(t,n,e,i){const r=n[19].queries[i];if(null===r.matches){const o=t.data,s=e.matches,a=[];for(let h=0;h<s.length;h+=2){const b=s[h];a.push(b<0?null:g5(n,o[b],s[h+1],e.metadata.read))}r.matches=a}return r.matches}function X_(t,n,e,i){const r=t.queries.getByIndex(e),o=r.matches;if(null!==o){const s=M2(t,n,r,e);for(let a=0;a<o.length;a+=2){const h=o[a];if(h>0)i.push(s[a/2]);else{const b=o[a+1],ee=n[-h];for(let de=10;de<ee.length;de++){const ge=ee[de];ge[17]===ge[3]&&X_(ge[1],ge,b,i)}if(null!==ee[9]){const de=ee[9];for(let ge=0;ge<de.length;ge++){const xe=de[ge];X_(xe[1],xe,b,i)}}}}}return i}function Cn(t){const n=kt(),e=ei(),i=p1();om(i+1);const r=A2(e,i);if(t.dirty&&function PM(t){return 4==(4&t[2])}(n)===(2==(2&r.metadata.flags))){if(null===r.matches)t.reset([]);else{const o=r.crossesNgTemplate?X_(e,n,i,[]):M2(e,n,r,i);t.reset(o,uA),t.notifyOnChanges()}return!0}return!1}function wn(t,n,e){const i=ei();i.firstCreatePass&&(function D2(t,n,e){null===t.queries&&(t.queries=new Y_),t.queries.track(new Z_(n,e))}(i,new I2(t,n,e),-1),2==(2&n)&&(i.staticViewQueries=!0)),function k2(t,n,e){const i=new G_(4==(4&e));wy(t,n,i,i.destroy),null===n[19]&&(n[19]=new K_),n[19].queries.push(new W_(i))}(i,kt(),n)}function xn(){return function $5(t,n){return t[19].queries[n].queryList}(kt(),p1())}function A2(t,n){return t.queries.getByIndex(n)}function ti(t,n){return Xh(t,n)}function Jh(...t){}const n$=new An("Application Initializer");let ep=(()=>{class t{constructor(e){this.appInits=e,this.resolve=Jh,this.reject=Jh,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const e=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const o=this.appInits[r]();if(Vh(o))e.push(o);else if(Ky(o)){const s=new Promise((a,h)=>{o.subscribe({complete:a,error:h})});e.push(s)}}Promise.all(e).then(()=>{i()}).catch(r=>{this.reject(r)}),0===e.length&&i(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)(pn(n$,8))},t.\u0275prov=$n({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Hd=new An("AppId",{providedIn:"root",factory:function X2(){return`${i$()}${i$()}${i$()}`}});function i$(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Q2=new An("Platform Initializer"),Vd=new An("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),B5=new An("appBootstrapListener"),J2=new An("AnimationModuleType"),Ta=new An("LocaleId",{providedIn:"root",factory:()=>function Tk(t,n=yn.Default){return"number"!=typeof n&&(n=0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)),pn(t,n)}(Ta,yn.Optional|yn.SkipSelf)||function z5(){return typeof $localize<"u"&&$localize.locale||mu}()}),G5=(()=>Promise.resolve(0))();function r$(t){typeof Zone>"u"?G5.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class Nn{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Hn(!1),this.onMicrotaskEmpty=new Hn(!1),this.onStable=new Hn(!1),this.onError=new Hn(!1),typeof Zone>"u")throw new et(908,!1);Zone.assertZonePatched();const r=this;if(r._nesting=0,r._outer=r._inner=Zone.current,Zone.AsyncStackTaggingZoneSpec){const o=Zone.AsyncStackTaggingZoneSpec;r._inner=r._inner.fork(new o("Angular"))}Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&e,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function q5(){let t=wi.requestAnimationFrame,n=wi.cancelAnimationFrame;if(typeof Zone<"u"&&t&&n){const e=t[Zone.__symbol__("OriginalDelegate")];e&&(t=e);const i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:n}}().nativeRequestAnimationFrame,function Y5(t){const n=()=>{!function K5(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(wi,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,s$(t),t.isCheckStableRunning=!0,o$(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),s$(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,i,r,o,s,a)=>{try{return nw(t),e.invokeTask(r,o,s,a)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||t.shouldCoalesceRunChangeDetection)&&n(),iw(t)}},onInvoke:(e,i,r,o,s,a,h)=>{try{return nw(t),e.invoke(r,o,s,a,h)}finally{t.shouldCoalesceRunChangeDetection&&n(),iw(t)}},onHasTask:(e,i,r,o)=>{e.hasTask(r,o),i===r&&("microTask"==o.change?(t._hasPendingMicrotasks=o.microTask,s$(t),o$(t)):"macroTask"==o.change&&(t.hasPendingMacrotasks=o.macroTask))},onHandleError:(e,i,r,o)=>(e.handleError(r,o),t.runOutsideAngular(()=>t.onError.emit(o)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Nn.isInAngularZone())throw new et(909,!1)}static assertNotInAngularZone(){if(Nn.isInAngularZone())throw new et(909,!1)}run(n,e,i){return this._inner.run(n,e,i)}runTask(n,e,i,r){const o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+r,n,W5,Jh,Jh);try{return o.runTask(s,e,i)}finally{o.cancelTask(s)}}runGuarded(n,e,i){return this._inner.runGuarded(n,e,i)}runOutsideAngular(n){return this._outer.run(n)}}const W5={};function o$(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function s$(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function nw(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function iw(t){t._nesting--,o$(t)}class Z5{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Hn,this.onMicrotaskEmpty=new Hn,this.onStable=new Hn,this.onError=new Hn}run(n,e,i){return n.apply(e,i)}runGuarded(n,e,i){return n.apply(e,i)}runOutsideAngular(n){return n()}runTask(n,e,i,r){return n.apply(e,i)}}const rw=new An(""),tp=new An("");let c$,a$=(()=>{class t{constructor(e,i,r){this._ngZone=e,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,c$||(function X5(t){c$=t}(r),r.addToWindow(i)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Nn.assertNotInAngularZone(),r$(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())r$(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(e)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,i,r){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(s=>s.timeoutId!==o),e(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:e,timeoutId:o,updateCb:r})}whenStable(e,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,i,r){return[]}}return t.\u0275fac=function(e){return new(e||t)(pn(Nn),pn(l$),pn(tp))},t.\u0275prov=$n({token:t,factory:t.\u0275fac}),t})(),l$=(()=>{class t{constructor(){this._applications=new Map}registerApplication(e,i){this._applications.set(e,i)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,i=!0){return c$?.findTestabilityInTree(this,e,i)??null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=$n({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})(),el=null;const ow=new An("AllowMultipleToken"),u$=new An("PlatformDestroyListeners");function aw(t,n,e=[]){const i=`Platform: ${n}`,r=new An(i);return(o=[])=>{let s=d$();if(!s||s.injector.get(ow,!1)){const a=[...e,...o,{provide:r,useValue:!0}];t?t(a):function eO(t){if(el&&!el.get(ow,!1))throw new et(400,!1);el=t;const n=t.get(cw);(function sw(t){const n=t.get(Q2,null);n&&n.forEach(e=>e())})(t)}(function lw(t=[],n){return xs.create({name:n,providers:[{provide:Ym,useValue:"platform"},{provide:u$,useValue:new Set([()=>el=null])},...t]})}(a,i))}return function nO(t){const n=d$();if(!n)throw new et(401,!1);return n}()}}function d$(){return el?.get(cw)??null}let cw=(()=>{class t{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,i){const r=function dw(t,n){let e;return e="noop"===t?new Z5:("zone.js"===t?void 0:t)||new Nn(n),e}(i?.ngZone,function uw(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!t||!t.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!t||!t.ngZoneRunCoalescing)||!1}}(i)),o=[{provide:Nn,useValue:r}];return r.run(()=>{const s=xs.create({providers:o,parent:this.injector,name:e.moduleType.name}),a=e.create(s),h=a.injector.get(eu,null);if(!h)throw new et(402,!1);return r.runOutsideAngular(()=>{const b=r.onError.subscribe({next:ee=>{h.handleError(ee)}});a.onDestroy(()=>{np(this._modules,a),b.unsubscribe()})}),function fw(t,n,e){try{const i=e();return Vh(i)?i.catch(r=>{throw n.runOutsideAngular(()=>t.handleError(r)),r}):i}catch(i){throw n.runOutsideAngular(()=>t.handleError(i)),i}}(h,r,()=>{const b=a.injector.get(ep);return b.runInitializers(),b.donePromise.then(()=>(function jC(t){xo(t,"Expected localeId to be defined"),"string"==typeof t&&(zC=t.toLowerCase().replace(/_/g,"-"))}(a.injector.get(Ta,mu)||mu),this._moduleDoBootstrap(a),a))})})}bootstrapModule(e,i=[]){const r=hw({},i);return function Q5(t,n,e){const i=new j_(e);return Promise.resolve(i)}(0,0,e).then(o=>this.bootstrapModuleFactory(o,r))}_moduleDoBootstrap(e){const i=e.injector.get(Gd);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!e.instance.ngDoBootstrap)throw new et(403,!1);e.instance.ngDoBootstrap(i)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new et(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const e=this._injector.get(u$,null);e&&(e.forEach(i=>i()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)(pn(xs))},t.\u0275prov=$n({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();function hw(t,n){return Array.isArray(n)?n.reduce(hw,t):{...t,...n}}let Gd=(()=>{class t{constructor(e,i,r){this._zone=e,this._injector=i,this._exceptionHandler=r,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const o=new F(a=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{a.next(this._stable),a.complete()})}),s=new F(a=>{let h;this._zone.runOutsideAngular(()=>{h=this._zone.onStable.subscribe(()=>{Nn.assertNotInAngularZone(),r$(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,a.next(!0))})})});const b=this._zone.onUnstable.subscribe(()=>{Nn.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{a.next(!1)}))});return()=>{h.unsubscribe(),b.unsubscribe()}});this.isStable=ga(o,s.pipe(function Pc(t={}){const{connector:n=(()=>new u),resetOnError:e=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=t;return o=>{let s,a,h,b=0,ee=!1,de=!1;const ge=()=>{a?.unsubscribe(),a=void 0},xe=()=>{ge(),s=h=void 0,ee=de=!1},ke=()=>{const Pe=s;xe(),Pe?.unsubscribe()};return C((Pe,Oe)=>{b++,!de&&!ee&&ge();const je=h=h??n();Oe.add(()=>{b--,0===b&&!de&&!ee&&(a=Be(ke,r))}),je.subscribe(Oe),!s&&b>0&&(s=new S({next:qe=>je.next(qe),error:qe=>{de=!0,ge(),a=Be(xe,e,qe),je.error(qe)},complete:()=>{ee=!0,ge(),a=Be(xe,i),je.complete()}}),br(Pe).subscribe(s))})(o)}}()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(e,i){const r=e instanceof Hb;if(!this._injector.get(ep).done)throw!r&&function od(t){const n=hi(t)||Zr(t)||Xr(t);return null!==n&&n.standalone}(e),new et(405,false);let s;s=r?e:this._injector.get(Mh).resolveComponentFactory(e),this.componentTypes.push(s.componentType);const a=function J5(t){return t.isBoundToModule}(s)?void 0:this._injector.get(_u),b=s.create(xs.NULL,[],i||s.selector,a),ee=b.location.nativeElement,de=b.injector.get(rw,null);return de?.registerApplication(ee),b.onDestroy(()=>{this.detachView(b.hostView),np(this.components,b),de?.unregisterApplication(ee)}),this._loadComponent(b),b}tick(){if(this._runningTick)throw new et(101,!1);try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const i=e;this._views.push(i),i.attachToAppRef(this)}detachView(e){const i=e;np(this._views,i),i.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(B5,[]).concat(this._bootstrapListeners).forEach(r=>r(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>np(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new et(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return t.\u0275fac=function(e){return new(e||t)(pn(Nn),pn(Xc),pn(eu))},t.\u0275prov=$n({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function np(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}let gw=!0,Ki=(()=>{class t{}return t.__NG_ELEMENT_ID__=oO,t})();function oO(t){return function sO(t,n,e){if(eh(t)&&!e){const i=Mo(t.index,n);return new Md(i,i)}return 47&t.type?new Md(n[16],n):null}(sr(),kt(),16==(16&t))}class bw{constructor(){}supports(n){return Dd(n)}create(n){return new fO(n)}}const dO=(t,n)=>n;class fO{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||dO}forEachItem(n){let e;for(e=this._itHead;null!==e;e=e._next)n(e)}forEachOperation(n){let e=this._itHead,i=this._removalsHead,r=0,o=null;for(;e||i;){const s=!i||e&&e.currentIndex<Cw(i,r,o)?e:i,a=Cw(s,r,o),h=s.currentIndex;if(s===i)r--,i=i._nextRemoved;else if(e=e._next,null==s.previousIndex)r++;else{o||(o=[]);const b=a-r,ee=h-r;if(b!=ee){for(let ge=0;ge<b;ge++){const xe=ge<o.length?o[ge]:o[ge]=0,ke=xe+ge;ee<=ke&&ke<b&&(o[ge]=xe+1)}o[s.previousIndex]=ee-b}}a!==h&&n(s,a,h)}}forEachPreviousItem(n){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachMovedItem(n){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}forEachIdentityChange(n){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)n(e)}diff(n){if(null==n&&(n=[]),!Dd(n))throw new et(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let r,o,s,e=this._itHead,i=!1;if(Array.isArray(n)){this.length=n.length;for(let a=0;a<this.length;a++)o=n[a],s=this._trackByFn(a,o),null!==e&&Object.is(e.trackById,s)?(i&&(e=this._verifyReinsertion(e,o,s,a)),Object.is(e.item,o)||this._addIdentityChange(e,o)):(e=this._mismatch(e,o,s,a),i=!0),e=e._next}else r=0,function KP(t,n){if(Array.isArray(t))for(let e=0;e<t.length;e++)n(t[e]);else{const e=t[Wl()]();let i;for(;!(i=e.next()).done;)n(i.value)}}(n,a=>{s=this._trackByFn(r,a),null!==e&&Object.is(e.trackById,s)?(i&&(e=this._verifyReinsertion(e,a,s,r)),Object.is(e.item,a)||this._addIdentityChange(e,a)):(e=this._mismatch(e,a,s,r),i=!0),e=e._next,r++}),this.length=r;return this._truncate(e),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,e,i,r){let o;return null===n?o=this._itTail:(o=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._reinsertAfter(n,o,r)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._moveAfter(n,o,r)):n=this._addAfter(new hO(e,i),o,r),n}_verifyReinsertion(n,e,i,r){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==o?n=this._reinsertAfter(o,n._prev,r):n.currentIndex!=r&&(n.currentIndex=r,this._addToMoves(n,r)),n}_truncate(n){for(;null!==n;){const e=n._next;this._addToRemovals(this._unlink(n)),n=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,e,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const r=n._prevRemoved,o=n._nextRemoved;return null===r?this._removalsHead=o:r._nextRemoved=o,null===o?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(n,e,i),this._addToMoves(n,i),n}_moveAfter(n,e,i){return this._unlink(n),this._insertAfter(n,e,i),this._addToMoves(n,i),n}_addAfter(n,e,i){return this._insertAfter(n,e,i),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,e,i){const r=null===e?this._itHead:e._next;return n._next=r,n._prev=e,null===r?this._itTail=n:r._prev=n,null===e?this._itHead=n:e._next=n,null===this._linkedRecords&&(this._linkedRecords=new yw),this._linkedRecords.put(n),n.currentIndex=i,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const e=n._prev,i=n._next;return null===e?this._itHead=i:e._next=i,null===i?this._itTail=e:i._prev=e,n}_addToMoves(n,e){return n.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new yw),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,e){return n.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class hO{constructor(n,e){this.item=n,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class pO{constructor(){this._head=null,this._tail=null}add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,e){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===e||e<=i.currentIndex)&&Object.is(i.trackById,n))return i;return null}remove(n){const e=n._prevDup,i=n._nextDup;return null===e?this._head=i:e._nextDup=i,null===i?this._tail=e:i._prevDup=e,null===this._head}}class yw{constructor(){this.map=new Map}put(n){const e=n.trackById;let i=this.map.get(e);i||(i=new pO,this.map.set(e,i)),i.add(n)}get(n,e){const r=this.map.get(n);return r?r.get(n,e):null}remove(n){const e=n.trackById;return this.map.get(e).remove(n)&&this.map.delete(e),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function Cw(t,n,e){const i=t.previousIndex;if(null===i)return i;let r=0;return e&&i<e.length&&(r=e[i]),i+n+r}class ww{constructor(){}supports(n){return n instanceof Map||M_(n)}create(){return new gO}}class gO{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(n){let e;for(e=this._mapHead;null!==e;e=e._next)n(e)}forEachPreviousItem(n){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)n(e)}forEachChangedItem(n){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}diff(n){if(n){if(!(n instanceof Map||M_(n)))throw new et(900,!1)}else n=new Map;return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(n,(i,r)=>{if(e&&e.key===r)this._maybeAddToChanges(e,i),this._appendAfter=e,e=e._next;else{const o=this._getOrCreateRecordForKey(r,i);e=this._insertBeforeOrAppend(e,o)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let i=e;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,e){if(n){const i=n._prev;return e._next=n,e._prev=i,n._prev=e,i&&(i._next=e),n===this._mapHead&&(this._mapHead=e),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(n,e){if(this._records.has(n)){const r=this._records.get(n);this._maybeAddToChanges(r,e);const o=r._prev,s=r._next;return o&&(o._next=s),s&&(s._prev=o),r._next=null,r._prev=null,r}const i=new mO(n);return this._records.set(n,i),i.currentValue=e,this._addToAdditions(i),i}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;null!==n;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;null!=n;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,e){Object.is(e,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=e,this._addToChanges(n))}_addToAdditions(n){null===this._additionsHead?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){null===this._changesHead?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,e){n instanceof Map?n.forEach(e):Object.keys(n).forEach(i=>e(n[i],i))}}class mO{constructor(n){this.key=n,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function xw(){return new op([new bw])}let op=(()=>{class t{constructor(e){this.factories=e}static create(e,i){if(null!=i){const r=i.factories.slice();e=e.concat(r)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>t.create(e,i||xw()),deps:[[t,new _h,new mh]]}}find(e){const i=this.factories.find(r=>r.supports(e));if(null!=i)return i;throw new et(901,!1)}}return t.\u0275prov=$n({token:t,providedIn:"root",factory:xw}),t})();function Ew(){return new qd([new ww])}let qd=(()=>{class t{constructor(e){this.factories=e}static create(e,i){if(i){const r=i.factories.slice();e=e.concat(r)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>t.create(e,i||Ew()),deps:[[t,new _h,new mh]]}}find(e){const i=this.factories.find(r=>r.supports(e));if(i)return i;throw new et(901,!1)}}return t.\u0275prov=$n({token:t,providedIn:"root",factory:Ew}),t})();const vO=aw(null,"core",[]);let bO=(()=>{class t{constructor(e){}}return t.\u0275fac=function(e){return new(e||t)(pn(Gd))},t.\u0275mod=Zo({type:t}),t.\u0275inj=Eo({}),t})();function m$(t){return"boolean"==typeof t?t:null!=t&&"false"!==t}let sp=null;function Xl(){return sp}const No=new An("DocumentToken");var Yi=(()=>((Yi=Yi||{})[Yi.Format=0]="Format",Yi[Yi.Standalone=1]="Standalone",Yi))(),Kn=(()=>((Kn=Kn||{})[Kn.Narrow=0]="Narrow",Kn[Kn.Abbreviated=1]="Abbreviated",Kn[Kn.Wide=2]="Wide",Kn[Kn.Short=3]="Short",Kn))(),ji=(()=>((ji=ji||{})[ji.Short=0]="Short",ji[ji.Medium=1]="Medium",ji[ji.Long=2]="Long",ji[ji.Full=3]="Full",ji))(),dn=(()=>((dn=dn||{})[dn.Decimal=0]="Decimal",dn[dn.Group=1]="Group",dn[dn.List=2]="List",dn[dn.PercentSign=3]="PercentSign",dn[dn.PlusSign=4]="PlusSign",dn[dn.MinusSign=5]="MinusSign",dn[dn.Exponential=6]="Exponential",dn[dn.SuperscriptingExponent=7]="SuperscriptingExponent",dn[dn.PerMille=8]="PerMille",dn[dn.Infinity=9]="Infinity",dn[dn.NaN=10]="NaN",dn[dn.TimeSeparator=11]="TimeSeparator",dn[dn.CurrencyDecimal=12]="CurrencyDecimal",dn[dn.CurrencyGroup=13]="CurrencyGroup",dn))();function ap(t,n){return ts(to(t)[Wt.DateFormat],n)}function lp(t,n){return ts(to(t)[Wt.TimeFormat],n)}function cp(t,n){return ts(to(t)[Wt.DateTimeFormat],n)}function es(t,n){const e=to(t),i=e[Wt.NumberSymbols][n];if(typeof i>"u"){if(n===dn.CurrencyDecimal)return e[Wt.NumberSymbols][dn.Decimal];if(n===dn.CurrencyGroup)return e[Wt.NumberSymbols][dn.Group]}return i}function Iw(t){if(!t[Wt.ExtraData])throw new Error(`Missing extra locale data for the locale "${t[Wt.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function ts(t,n){for(let e=n;e>-1;e--)if(typeof t[e]<"u")return t[e];throw new Error("Locale data API: locale data undefined")}function $$(t){const[n,e]=t.split(":");return{hours:+n,minutes:+e}}const LO=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Wd={},BO=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var dr=(()=>((dr=dr||{})[dr.Short=0]="Short",dr[dr.ShortGMT=1]="ShortGMT",dr[dr.Long=2]="Long",dr[dr.Extended=3]="Extended",dr))(),_n=(()=>((_n=_n||{})[_n.FullYear=0]="FullYear",_n[_n.Month=1]="Month",_n[_n.Date=2]="Date",_n[_n.Hours=3]="Hours",_n[_n.Minutes=4]="Minutes",_n[_n.Seconds=5]="Seconds",_n[_n.FractionalSeconds=6]="FractionalSeconds",_n[_n.Day=7]="Day",_n))(),jn=(()=>((jn=jn||{})[jn.DayPeriods=0]="DayPeriods",jn[jn.Days=1]="Days",jn[jn.Months=2]="Months",jn[jn.Eras=3]="Eras",jn))();function Kd(t,n,e,i){let r=function KO(t){if(Dw(t))return t;if("number"==typeof t&&!isNaN(t))return new Date(t);if("string"==typeof t){if(t=t.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(t)){const[r,o=1,s=1]=t.split("-").map(a=>+a);return up(r,o-1,s)}const e=parseFloat(t);if(!isNaN(t-e))return new Date(e);let i;if(i=t.match(LO))return function YO(t){const n=new Date(0);let e=0,i=0;const r=t[8]?n.setUTCFullYear:n.setFullYear,o=t[8]?n.setUTCHours:n.setHours;t[9]&&(e=Number(t[9]+t[10]),i=Number(t[9]+t[11])),r.call(n,Number(t[1]),Number(t[2])-1,Number(t[3]));const s=Number(t[4]||0)-e,a=Number(t[5]||0)-i,h=Number(t[6]||0),b=Math.floor(1e3*parseFloat("0."+(t[7]||0)));return o.call(n,s,a,h,b),n}(i)}const n=new Date(t);if(!Dw(n))throw new Error(`Unable to convert "${t}" into a date`);return n}(t);n=Ia(e,n)||n;let a,s=[];for(;n;){if(a=BO.exec(n),!a){s.push(n);break}{s=s.concat(a.slice(1));const ee=s.pop();if(!ee)break;n=ee}}let h=r.getTimezoneOffset();i&&(h=kw(i,h),r=function WO(t,n,e){const i=e?-1:1,r=t.getTimezoneOffset();return function qO(t,n){return(t=new Date(t.getTime())).setMinutes(t.getMinutes()+n),t}(t,i*(kw(n,r)-r))}(r,i,!0));let b="";return s.forEach(ee=>{const de=function GO(t){if(b$[t])return b$[t];let n;switch(t){case"G":case"GG":case"GGG":n=Si(jn.Eras,Kn.Abbreviated);break;case"GGGG":n=Si(jn.Eras,Kn.Wide);break;case"GGGGG":n=Si(jn.Eras,Kn.Narrow);break;case"y":n=nr(_n.FullYear,1,0,!1,!0);break;case"yy":n=nr(_n.FullYear,2,0,!0,!0);break;case"yyy":n=nr(_n.FullYear,3,0,!1,!0);break;case"yyyy":n=nr(_n.FullYear,4,0,!1,!0);break;case"Y":n=pp(1);break;case"YY":n=pp(2,!0);break;case"YYY":n=pp(3);break;case"YYYY":n=pp(4);break;case"M":case"L":n=nr(_n.Month,1,1);break;case"MM":case"LL":n=nr(_n.Month,2,1);break;case"MMM":n=Si(jn.Months,Kn.Abbreviated);break;case"MMMM":n=Si(jn.Months,Kn.Wide);break;case"MMMMM":n=Si(jn.Months,Kn.Narrow);break;case"LLL":n=Si(jn.Months,Kn.Abbreviated,Yi.Standalone);break;case"LLLL":n=Si(jn.Months,Kn.Wide,Yi.Standalone);break;case"LLLLL":n=Si(jn.Months,Kn.Narrow,Yi.Standalone);break;case"w":n=v$(1);break;case"ww":n=v$(2);break;case"W":n=v$(1,!0);break;case"d":n=nr(_n.Date,1);break;case"dd":n=nr(_n.Date,2);break;case"c":case"cc":n=nr(_n.Day,1);break;case"ccc":n=Si(jn.Days,Kn.Abbreviated,Yi.Standalone);break;case"cccc":n=Si(jn.Days,Kn.Wide,Yi.Standalone);break;case"ccccc":n=Si(jn.Days,Kn.Narrow,Yi.Standalone);break;case"cccccc":n=Si(jn.Days,Kn.Short,Yi.Standalone);break;case"E":case"EE":case"EEE":n=Si(jn.Days,Kn.Abbreviated);break;case"EEEE":n=Si(jn.Days,Kn.Wide);break;case"EEEEE":n=Si(jn.Days,Kn.Narrow);break;case"EEEEEE":n=Si(jn.Days,Kn.Short);break;case"a":case"aa":case"aaa":n=Si(jn.DayPeriods,Kn.Abbreviated);break;case"aaaa":n=Si(jn.DayPeriods,Kn.Wide);break;case"aaaaa":n=Si(jn.DayPeriods,Kn.Narrow);break;case"b":case"bb":case"bbb":n=Si(jn.DayPeriods,Kn.Abbreviated,Yi.Standalone,!0);break;case"bbbb":n=Si(jn.DayPeriods,Kn.Wide,Yi.Standalone,!0);break;case"bbbbb":n=Si(jn.DayPeriods,Kn.Narrow,Yi.Standalone,!0);break;case"B":case"BB":case"BBB":n=Si(jn.DayPeriods,Kn.Abbreviated,Yi.Format,!0);break;case"BBBB":n=Si(jn.DayPeriods,Kn.Wide,Yi.Format,!0);break;case"BBBBB":n=Si(jn.DayPeriods,Kn.Narrow,Yi.Format,!0);break;case"h":n=nr(_n.Hours,1,-12);break;case"hh":n=nr(_n.Hours,2,-12);break;case"H":n=nr(_n.Hours,1);break;case"HH":n=nr(_n.Hours,2);break;case"m":n=nr(_n.Minutes,1);break;case"mm":n=nr(_n.Minutes,2);break;case"s":n=nr(_n.Seconds,1);break;case"ss":n=nr(_n.Seconds,2);break;case"S":n=nr(_n.FractionalSeconds,1);break;case"SS":n=nr(_n.FractionalSeconds,2);break;case"SSS":n=nr(_n.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":n=fp(dr.Short);break;case"ZZZZZ":n=fp(dr.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":n=fp(dr.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":n=fp(dr.Long);break;default:return null}return b$[t]=n,n}(ee);b+=de?de(r,e,h):"''"===ee?"'":ee.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),b}function up(t,n,e){const i=new Date(0);return i.setFullYear(t,n,e),i.setHours(0,0,0),i}function Ia(t,n){const e=function TO(t){return to(t)[Wt.LocaleId]}(t);if(Wd[e]=Wd[e]||{},Wd[e][n])return Wd[e][n];let i="";switch(n){case"shortDate":i=ap(t,ji.Short);break;case"mediumDate":i=ap(t,ji.Medium);break;case"longDate":i=ap(t,ji.Long);break;case"fullDate":i=ap(t,ji.Full);break;case"shortTime":i=lp(t,ji.Short);break;case"mediumTime":i=lp(t,ji.Medium);break;case"longTime":i=lp(t,ji.Long);break;case"fullTime":i=lp(t,ji.Full);break;case"short":const r=Ia(t,"shortTime"),o=Ia(t,"shortDate");i=dp(cp(t,ji.Short),[r,o]);break;case"medium":const s=Ia(t,"mediumTime"),a=Ia(t,"mediumDate");i=dp(cp(t,ji.Medium),[s,a]);break;case"long":const h=Ia(t,"longTime"),b=Ia(t,"longDate");i=dp(cp(t,ji.Long),[h,b]);break;case"full":const ee=Ia(t,"fullTime"),de=Ia(t,"fullDate");i=dp(cp(t,ji.Full),[ee,de])}return i&&(Wd[e][n]=i),i}function dp(t,n){return n&&(t=t.replace(/\{([^}]+)}/g,function(e,i){return null!=n&&i in n?n[i]:e})),t}function Ds(t,n,e="-",i,r){let o="";(t<0||r&&t<=0)&&(r?t=1-t:(t=-t,o=e));let s=String(t);for(;s.length<n;)s="0"+s;return i&&(s=s.slice(s.length-n)),o+s}function nr(t,n,e=0,i=!1,r=!1){return function(o,s){let a=function jO(t,n){switch(t){case _n.FullYear:return n.getFullYear();case _n.Month:return n.getMonth();case _n.Date:return n.getDate();case _n.Hours:return n.getHours();case _n.Minutes:return n.getMinutes();case _n.Seconds:return n.getSeconds();case _n.FractionalSeconds:return n.getMilliseconds();case _n.Day:return n.getDay();default:throw new Error(`Unknown DateType value "${t}".`)}}(t,o);if((e>0||a>-e)&&(a+=e),t===_n.Hours)0===a&&-12===e&&(a=12);else if(t===_n.FractionalSeconds)return function zO(t,n){return Ds(t,3).substring(0,n)}(a,n);const h=es(s,dn.MinusSign);return Ds(a,n,h,i,r)}}function Si(t,n,e=Yi.Format,i=!1){return function(r,o){return function UO(t,n,e,i,r,o){switch(e){case jn.Months:return function MO(t,n,e){const i=to(t),o=ts([i[Wt.MonthsFormat],i[Wt.MonthsStandalone]],n);return ts(o,e)}(n,r,i)[t.getMonth()];case jn.Days:return function IO(t,n,e){const i=to(t),o=ts([i[Wt.DaysFormat],i[Wt.DaysStandalone]],n);return ts(o,e)}(n,r,i)[t.getDay()];case jn.DayPeriods:const s=t.getHours(),a=t.getMinutes();if(o){const b=function PO(t){const n=to(t);return Iw(n),(n[Wt.ExtraData][2]||[]).map(i=>"string"==typeof i?$$(i):[$$(i[0]),$$(i[1])])}(n),ee=function NO(t,n,e){const i=to(t);Iw(i);const o=ts([i[Wt.ExtraData][0],i[Wt.ExtraData][1]],n)||[];return ts(o,e)||[]}(n,r,i),de=b.findIndex(ge=>{if(Array.isArray(ge)){const[xe,ke]=ge,Pe=s>=xe.hours&&a>=xe.minutes,Oe=s<ke.hours||s===ke.hours&&a<ke.minutes;if(xe.hours<ke.hours){if(Pe&&Oe)return!0}else if(Pe||Oe)return!0}else if(ge.hours===s&&ge.minutes===a)return!0;return!1});if(-1!==de)return ee[de]}return function SO(t,n,e){const i=to(t),o=ts([i[Wt.DayPeriodsFormat],i[Wt.DayPeriodsStandalone]],n);return ts(o,e)}(n,r,i)[s<12?0:1];case jn.Eras:return function kO(t,n){return ts(to(t)[Wt.Eras],n)}(n,i)[t.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(r,o,t,n,e,i)}}function fp(t){return function(n,e,i){const r=-1*i,o=es(e,dn.MinusSign),s=r>0?Math.floor(r/60):Math.ceil(r/60);switch(t){case dr.Short:return(r>=0?"+":"")+Ds(s,2,o)+Ds(Math.abs(r%60),2,o);case dr.ShortGMT:return"GMT"+(r>=0?"+":"")+Ds(s,1,o);case dr.Long:return"GMT"+(r>=0?"+":"")+Ds(s,2,o)+":"+Ds(Math.abs(r%60),2,o);case dr.Extended:return 0===i?"Z":(r>=0?"+":"")+Ds(s,2,o)+":"+Ds(Math.abs(r%60),2,o);default:throw new Error(`Unknown zone width "${t}"`)}}}function Mw(t){return up(t.getFullYear(),t.getMonth(),t.getDate()+(4-t.getDay()))}function v$(t,n=!1){return function(e,i){let r;if(n){const o=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,s=e.getDate();r=1+Math.floor((s+o)/7)}else{const o=Mw(e),s=function VO(t){const n=up(t,0,1).getDay();return up(t,0,1+(n<=4?4:11)-n)}(o.getFullYear()),a=o.getTime()-s.getTime();r=1+Math.round(a/6048e5)}return Ds(r,t,es(i,dn.MinusSign))}}function pp(t,n=!1){return function(e,i){return Ds(Mw(e).getFullYear(),t,es(i,dn.MinusSign),n)}}const b$={};function kw(t,n){t=t.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+t)/6e4;return isNaN(e)?n:e}function Dw(t){return t instanceof Date&&!isNaN(t.valueOf())}let si=(()=>{class t{constructor(e,i,r,o){this._iterableDiffers=e,this._keyValueDiffers=i,this._ngEl=r,this._renderer=o,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(Dd(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(i=>this._toggleClass(i.key,i.currentValue)),e.forEachChangedItem(i=>this._toggleClass(i.key,i.currentValue)),e.forEachRemovedItem(i=>{i.previousValue&&this._toggleClass(i.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(i=>{if("string"!=typeof i.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${Xe(i.item)}`);this._toggleClass(i.item,!0)}),e.forEachRemovedItem(i=>this._toggleClass(i.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(i=>this._toggleClass(i,!0)):Object.keys(e).forEach(i=>this._toggleClass(i,!!e[i])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(i=>this._toggleClass(i,!1)):Object.keys(e).forEach(i=>this._toggleClass(i,!1)))}_toggleClass(e,i){(e=e.trim())&&e.split(/\s+/g).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return t.\u0275fac=function(e){return new(e||t)(He(op),He(qd),He(Ai),He(ql))},t.\u0275dir=hn({type:t,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),t})();class cF{constructor(n,e,i,r){this.$implicit=n,this.ngForOf=e,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let _i=(()=>{class t{constructor(e,i,r){this._viewContainer=e,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const i=this._viewContainer;e.forEachOperation((r,o,s)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new cF(r.item,this._ngForOf,-1,-1),null===s?void 0:s);else if(null==s)i.remove(null===o?void 0:o);else if(null!==o){const a=i.get(o);i.move(a,s),Rw(a,r)}});for(let r=0,o=i.length;r<o;r++){const a=i.get(r).context;a.index=r,a.count=o,a.ngForOf=this._ngForOf}e.forEachIdentityChange(r=>{Rw(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(e,i){return!0}}return t.\u0275fac=function(e){return new(e||t)(He(no),He(Ea),He(op))},t.\u0275dir=hn({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),t})();function Rw(t,n){t.context.$implicit=n.item}let Bn=(()=>{class t{constructor(e,i){this._viewContainer=e,this._context=new dF,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){Lw("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){Lw("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,i){return!0}}return t.\u0275fac=function(e){return new(e||t)(He(no),He(Ea))},t.\u0275dir=hn({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),t})();class dF{constructor(){this.$implicit=null,this.ngIf=null}}function Lw(t,n){if(n&&!n.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${Xe(n)}'.`)}class T${constructor(n,e){this._viewContainerRef=n,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(n){n&&!this._created?this.create():!n&&this._created&&this.destroy()}}let Ql=(()=>{class t{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(e)}_matchCase(e){const i=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||i,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),i}_updateDefaultCases(e){if(this._defaultViews&&e!==this._defaultUsed){this._defaultUsed=e;for(let i=0;i<this._defaultViews.length;i++)this._defaultViews[i].enforceState(e)}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=hn({type:t,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0}),t})(),Zd=(()=>{class t{constructor(e,i,r){this.ngSwitch=r,r._addCase(),this._view=new T$(e,i)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return t.\u0275fac=function(e){return new(e||t)(He(no),He(Ea),He(Ql,9))},t.\u0275dir=hn({type:t,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0}),t})(),Xd=(()=>{class t{constructor(e,i,r){r._addDefault(new T$(e,i))}}return t.\u0275fac=function(e){return new(e||t)(He(no),He(Ea),He(Ql,9))},t.\u0275dir=hn({type:t,selectors:[["","ngSwitchDefault",""]],standalone:!0}),t})(),fr=(()=>{class t{constructor(e,i,r){this._ngEl=e,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,i){const[r,o]=e.split("."),s=-1===r.indexOf("-")?void 0:go.DashCase;null!=i?this._renderer.setStyle(this._ngEl.nativeElement,r,o?`${i}${o}`:i,s):this._renderer.removeStyle(this._ngEl.nativeElement,r,s)}_applyChanges(e){e.forEachRemovedItem(i=>this._setStyle(i.key,null)),e.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),e.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}}return t.\u0275fac=function(e){return new(e||t)(He(Ai),He(qd),He(ql))},t.\u0275dir=hn({type:t,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0}),t})(),Jl=(()=>{class t{constructor(e){this._viewContainerRef=e,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(e){if(e.ngTemplateOutlet||e.ngTemplateOutletInjector){const i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:r,ngTemplateOutletContext:o,ngTemplateOutletInjector:s}=this;this._viewRef=i.createEmbeddedView(r,o,s?{injector:s}:void 0)}else this._viewRef=null}else this._viewRef&&e.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return t.\u0275fac=function(e){return new(e||t)(He(no))},t.\u0275dir=hn({type:t,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[Cs]}),t})();const CF=new An("DATE_PIPE_DEFAULT_TIMEZONE");let zw=(()=>{class t{constructor(e,i){this.locale=e,this.defaultTimezone=i}transform(e,i="mediumDate",r,o){if(null==e||""===e||e!=e)return null;try{return Kd(e,i,o||this.locale,r??this.defaultTimezone??void 0)}catch(s){throw function As(t,n){return new et(2100,!1)}()}}}return t.\u0275fac=function(e){return new(e||t)(He(Ta,16),He(CF,24))},t.\u0275pipe=Pr({name:"date",type:t,pure:!0,standalone:!0}),t})(),Uw=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zo({type:t}),t.\u0275inj=Eo({}),t})();const Hw="browser";function M$(t){return t===Hw}class A$ extends class tR extends class wO{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function CO(t){sp||(sp=t)}(new A$)}onAndCancel(n,e,i){return n.addEventListener(e,i,!1),()=>{n.removeEventListener(e,i,!1)}}dispatchEvent(n,e){n.dispatchEvent(e)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,e){return(e=e||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,e){return"window"===e?window:"document"===e?n:"body"===e?n.body:null}getBaseHref(n){const e=function nR(){return Jd=Jd||document.querySelector("base"),Jd?Jd.getAttribute("href"):null}();return null==e?null:function iR(t){_p=_p||document.createElement("a"),_p.setAttribute("href",t);const n=_p.pathname;return"/"===n.charAt(0)?n:`/${n}`}(e)}resetBaseElement(){Jd=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return function aF(t,n){n=encodeURIComponent(n);for(const e of t.split(";")){const i=e.indexOf("="),[r,o]=-1==i?[e,""]:[e.slice(0,i),e.slice(i+1)];if(r.trim()===n)return decodeURIComponent(o)}return null}(document.cookie,n)}}let _p,Jd=null;const Kw=new An("TRANSITION_ID"),oR=[{provide:n$,useFactory:function rR(t,n,e){return()=>{e.get(ep).donePromise.then(()=>{const i=Xl(),r=n.querySelectorAll(`style[ng-transition="${t}"]`);for(let o=0;o<r.length;o++)i.remove(r[o])})}},deps:[Kw,No,xs],multi:!0}];let aR=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=$n({token:t,factory:t.\u0275fac}),t})();const $p=new An("EventManagerPlugins");let vp=(()=>{class t{constructor(e,i){this._zone=i,this._eventNameToPlugin=new Map,e.forEach(r=>r.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,i,r){return this._findPluginFor(i).addEventListener(e,i,r)}addGlobalEventListener(e,i,r){return this._findPluginFor(i).addGlobalEventListener(e,i,r)}getZone(){return this._zone}_findPluginFor(e){const i=this._eventNameToPlugin.get(e);if(i)return i;const r=this._plugins;for(let o=0;o<r.length;o++){const s=r[o];if(s.supports(e))return this._eventNameToPlugin.set(e,s),s}throw new Error(`No event manager plugin found for event ${e}`)}}return t.\u0275fac=function(e){return new(e||t)(pn($p),pn(Nn))},t.\u0275prov=$n({token:t,factory:t.\u0275fac}),t})();class Yw{constructor(n){this._doc=n}addGlobalEventListener(n,e,i){const r=Xl().getGlobalEventTarget(this._doc,n);if(!r)throw new Error(`Unsupported event target ${r} for event ${e}`);return this.addEventListener(r,e,i)}}let Zw=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(e){const i=new Set;e.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=$n({token:t,factory:t.\u0275fac}),t})(),ef=(()=>{class t extends Zw{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,i,r){e.forEach(o=>{const s=this._doc.createElement("style");s.textContent=o,r.push(i.appendChild(s))})}addHost(e){const i=[];this._addStylesToHost(this._stylesSet,e,i),this._hostNodes.set(e,i)}removeHost(e){const i=this._hostNodes.get(e);i&&i.forEach(Xw),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(e,r,i)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(Xw))}}return t.\u0275fac=function(e){return new(e||t)(pn(No))},t.\u0275prov=$n({token:t,factory:t.\u0275fac}),t})();function Xw(t){Xl().remove(t)}const P$={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},N$=/%COMP%/g;function bp(t,n,e){for(let i=0;i<n.length;i++){let r=n[i];Array.isArray(r)?bp(t,r,e):(r=r.replace(N$,t),e.push(r))}return e}function ex(t){return n=>{if("__ngUnwrap__"===n)return t;!1===t(n)&&(n.preventDefault(),n.returnValue=!1)}}let yp=(()=>{class t{constructor(e,i,r){this.eventManager=e,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new O$(e)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;switch(i.encapsulation){case $s.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new hR(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(e),r}case 1:case $s.ShadowDom:return new pR(this.eventManager,this.sharedStylesHost,e,i);default:if(!this.rendererByCompId.has(i.id)){const r=bp(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)(pn(vp),pn(ef),pn(Hd))},t.\u0275prov=$n({token:t,factory:t.\u0275fac}),t})();class O${constructor(n){this.eventManager=n,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(n,e){return e?document.createElementNS(P$[e]||e,n):document.createElement(n)}createComment(n){return document.createComment(n)}createText(n){return document.createTextNode(n)}appendChild(n,e){(nx(n)?n.content:n).appendChild(e)}insertBefore(n,e,i){n&&(nx(n)?n.content:n).insertBefore(e,i)}removeChild(n,e){n&&n.removeChild(e)}selectRootElement(n,e){let i="string"==typeof n?document.querySelector(n):n;if(!i)throw new Error(`The selector "${n}" did not match any elements`);return e||(i.textContent=""),i}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,e,i,r){if(r){e=r+":"+e;const o=P$[r];o?n.setAttributeNS(o,e,i):n.setAttribute(e,i)}else n.setAttribute(e,i)}removeAttribute(n,e,i){if(i){const r=P$[i];r?n.removeAttributeNS(r,e):n.removeAttribute(`${i}:${e}`)}else n.removeAttribute(e)}addClass(n,e){n.classList.add(e)}removeClass(n,e){n.classList.remove(e)}setStyle(n,e,i,r){r&(go.DashCase|go.Important)?n.style.setProperty(e,i,r&go.Important?"important":""):n.style[e]=i}removeStyle(n,e,i){i&go.DashCase?n.style.removeProperty(e):n.style[e]=""}setProperty(n,e,i){n[e]=i}setValue(n,e){n.nodeValue=e}listen(n,e,i){return"string"==typeof n?this.eventManager.addGlobalEventListener(n,e,ex(i)):this.eventManager.addEventListener(n,e,ex(i))}}function nx(t){return"TEMPLATE"===t.tagName&&void 0!==t.content}class hR extends O${constructor(n,e,i,r){super(n),this.component=i;const o=bp(r+"-"+i.id,i.styles,[]);e.addStyles(o),this.contentAttr=function uR(t){return"_ngcontent-%COMP%".replace(N$,t)}(r+"-"+i.id),this.hostAttr=function dR(t){return"_nghost-%COMP%".replace(N$,t)}(r+"-"+i.id)}applyToHost(n){super.setAttribute(n,this.hostAttr,"")}createElement(n,e){const i=super.createElement(n,e);return super.setAttribute(i,this.contentAttr,""),i}}class pR extends O${constructor(n,e,i,r){super(n),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const o=bp(r.id,r.styles,[]);for(let s=0;s<o.length;s++){const a=document.createElement("style");a.textContent=o[s],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(n,e){return super.appendChild(this.nodeOrShadowRoot(n),e)}insertBefore(n,e,i){return super.insertBefore(this.nodeOrShadowRoot(n),e,i)}removeChild(n,e){return super.removeChild(this.nodeOrShadowRoot(n),e)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}}let gR=(()=>{class t extends Yw{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,r){return e.addEventListener(i,r,!1),()=>this.removeEventListener(e,i,r)}removeEventListener(e,i,r){return e.removeEventListener(i,r)}}return t.\u0275fac=function(e){return new(e||t)(pn(No))},t.\u0275prov=$n({token:t,factory:t.\u0275fac}),t})();const ix=["alt","control","meta","shift"],mR={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},_R={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let $R=(()=>{class t extends Yw{constructor(e){super(e)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,i,r){const o=t.parseEventName(i),s=t.eventCallback(o.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Xl().onAndCancel(e,o.domEventName,s))}static parseEventName(e){const i=e.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const o=t._normalizeKey(i.pop());let s="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),s="code."),ix.forEach(b=>{const ee=i.indexOf(b);ee>-1&&(i.splice(ee,1),s+=b+".")}),s+=o,0!=i.length||0===o.length)return null;const h={};return h.domEventName=r,h.fullKey=s,h}static matchEventFullKeyCode(e,i){let r=mR[e.key]||e.key,o="";return i.indexOf("code.")>-1&&(r=e.code,o="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),ix.forEach(s=>{s!==r&&(0,_R[s])(e)&&(o+=s+".")}),o+=r,o===i)}static eventCallback(e,i,r){return o=>{t.matchEventFullKeyCode(o,e)&&r.runGuarded(()=>i(o))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return t.\u0275fac=function(e){return new(e||t)(pn(No))},t.\u0275prov=$n({token:t,factory:t.\u0275fac}),t})();const ox=[{provide:Vd,useValue:Hw},{provide:Q2,useValue:function vR(){A$.makeCurrent()},multi:!0},{provide:No,useFactory:function yR(){return function wD(t){Um=t}(document),document},deps:[]}],CR=aw(vO,"browser",ox),sx=new An(""),ax=[{provide:tp,useClass:class sR{addToWindow(n){wi.getAngularTestability=(i,r=!0)=>{const o=n.findTestabilityInTree(i,r);if(null==o)throw new Error("Could not find testability for element.");return o},wi.getAllAngularTestabilities=()=>n.getAllTestabilities(),wi.getAllAngularRootElements=()=>n.getAllRootElements(),wi.frameworkStabilizers||(wi.frameworkStabilizers=[]),wi.frameworkStabilizers.push(i=>{const r=wi.getAllAngularTestabilities();let o=r.length,s=!1;const a=function(h){s=s||h,o--,0==o&&i(s)};r.forEach(function(h){h.whenStable(a)})})}findTestabilityInTree(n,e,i){return null==e?null:n.getTestability(e)??(i?Xl().isShadowRoot(e)?this.findTestabilityInTree(n,e.host,!0):this.findTestabilityInTree(n,e.parentElement,!0):null)}},deps:[]},{provide:rw,useClass:a$,deps:[Nn,l$,tp]},{provide:a$,useClass:a$,deps:[Nn,l$,tp]}],lx=[{provide:Ym,useValue:"root"},{provide:eu,useFactory:function bR(){return new eu},deps:[]},{provide:$p,useClass:gR,multi:!0,deps:[No,Nn,Vd]},{provide:$p,useClass:$R,multi:!0,deps:[No]},{provide:yp,useClass:yp,deps:[vp,ef,Hd]},{provide:Id,useExisting:yp},{provide:Zw,useExisting:ef},{provide:ef,useClass:ef,deps:[No]},{provide:vp,useClass:vp,deps:[$p,Nn]},{provide:class RF{},useClass:aR,deps:[]},[]];let cx=(()=>{class t{constructor(e){}static withServerTransition(e){return{ngModule:t,providers:[{provide:Hd,useValue:e.appId},{provide:Kw,useExisting:Hd},oR]}}}return t.\u0275fac=function(e){return new(e||t)(pn(sx,12))},t.\u0275mod=Zo({type:t}),t.\u0275inj=Eo({providers:[...lx,...ax],imports:[Uw,bO]}),t})();typeof window<"u"&&window;let fx=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=$n({token:t,factory:function(e){let i=null;return i=e?new(e||t):pn(hx),i},providedIn:"root"}),t})(),hx=(()=>{class t extends fx{constructor(e){super(),this._doc=e}sanitize(e,i){if(null==i)return null;switch(e){case Ei.NONE:return i;case Ei.HTML:return Hs(i,"HTML")?Ao(i):Db(this._doc,String(i)).toString();case Ei.STYLE:return Hs(i,"Style")?Ao(i):i;case Ei.SCRIPT:if(Hs(i,"Script"))return Ao(i);throw new Error("unsafe value used in a script context");case Ei.URL:return Hs(i,"URL")?Ao(i):Eh(String(i));case Ei.RESOURCE_URL:if(Hs(i,"ResourceURL"))return Ao(i);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${e} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(e){return function kD(t){return new xD(t)}(e)}bypassSecurityTrustStyle(e){return function DD(t){return new ED(t)}(e)}bypassSecurityTrustScript(e){return function AD(t){return new TD(t)}(e)}bypassSecurityTrustUrl(e){return function PD(t){return new SD(t)}(e)}bypassSecurityTrustResourceUrl(e){return function ND(t){return new ID(t)}(e)}}return t.\u0275fac=function(e){return new(e||t)(pn(No))},t.\u0275prov=$n({token:t,factory:function(e){let i=null;return i=e?new e:function DR(t){return new hx(t.get(No))}(pn(xs)),i},providedIn:"root"}),t})();_e(5386);const{isArray:AR}=Array,{getPrototypeOf:PR,prototype:NR,keys:OR}=Object;function px(t){if(1===t.length){const n=t[0];if(AR(n))return{args:n,keys:null};if(function FR(t){return t&&"object"==typeof t&&PR(t)===NR}(n)){const e=OR(n);return{args:e.map(i=>n[i]),keys:e}}}return{args:t,keys:null}}const{isArray:RR}=Array;function tf(t){return se(n=>function LR(t,n){return RR(n)?t(...n):t(n)}(t,n))}function gx(t,n){return t.reduce((e,i,r)=>(e[i]=n[r],e),{})}let mx=(()=>{class t{constructor(e,i){this._renderer=e,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return t.\u0275fac=function(e){return new(e||t)(He(ql),He(Ai))},t.\u0275dir=hn({type:t}),t})(),ec=(()=>{class t extends mx{}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Fr(t)))(i||t)}}(),t.\u0275dir=hn({type:t,features:[pi]}),t})();const Ws=new An("NgValueAccessor"),zR={provide:Ws,useExisting:$t(()=>Oo),multi:!0};let Oo=(()=>{class t extends ec{writeValue(e){this.setProperty("checked",e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Fr(t)))(i||t)}}(),t.\u0275dir=hn({type:t,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(e,i){1&e&&Ae("change",function(o){return i.onChange(o.target.checked)})("blur",function(){return i.onTouched()})},features:[Ti([zR]),pi]}),t})();const jR={provide:Ws,useExisting:$t(()=>Ii),multi:!0},_x=new An("CompositionEventMode");let Ii=(()=>{class t extends mx{constructor(e,i,r){super(e,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function UR(){const t=Xl()?Xl().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return t.\u0275fac=function(e){return new(e||t)(He(ql),He(Ai),He(_x,8))},t.\u0275dir=hn({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,i){1&e&&Ae("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},features:[Ti([jR]),pi]}),t})();function nl(t){return null==t||("string"==typeof t||Array.isArray(t))&&0===t.length}function $x(t){return null!=t&&"number"==typeof t.length}const zr=new An("NgValidators"),il=new An("NgAsyncValidators");function yx(t){return nl(t.value)?{required:!0}:null}function Cp(t){return null}function Sx(t){return null!=t}function Ix(t){return Vh(t)?Qi(t):t}function Mx(t){let n={};return t.forEach(e=>{n=null!=e?{...n,...e}:n}),0===Object.keys(n).length?null:n}function kx(t,n){return n.map(e=>e(t))}function Dx(t){return t.map(n=>function GR(t){return!t.validate}(n)?n:e=>n.validate(e))}function L$(t){return null!=t?function Ax(t){if(!t)return null;const n=t.filter(Sx);return 0==n.length?null:function(e){return Mx(kx(e,n))}}(Dx(t)):null}function B$(t){return null!=t?function Px(t){if(!t)return null;const n=t.filter(Sx);return 0==n.length?null:function(e){return function BR(...t){const n=Wo(t),{args:e,keys:i}=px(t),r=new F(o=>{const{length:s}=e;if(!s)return void o.complete();const a=new Array(s);let h=s,b=s;for(let ee=0;ee<s;ee++){let de=!1;br(e[ee]).subscribe($(o,ge=>{de||(de=!0,b--),a[ee]=ge},()=>h--,void 0,()=>{(!h||!de)&&(b||o.next(i?gx(i,a):a),o.complete())}))}});return n?r.pipe(tf(n)):r}(kx(e,n).map(Ix)).pipe(se(Mx))}}(Dx(t)):null}function Nx(t,n){return null===t?[n]:Array.isArray(t)?[...t,n]:[t,n]}function z$(t){return t?Array.isArray(t)?t:[t]:[]}function wp(t,n){return Array.isArray(t)?t.includes(n):t===n}function Rx(t,n){const e=z$(n);return z$(t).forEach(r=>{wp(e,r)||e.push(r)}),e}function Lx(t,n){return z$(n).filter(e=>!wp(t,e))}class Bx{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=L$(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=B$(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n){this.control&&this.control.reset(n)}hasError(n,e){return!!this.control&&this.control.hasError(n,e)}getError(n,e){return this.control?this.control.getError(n,e):null}}class ro extends Bx{get formDirective(){return null}get path(){return null}}class rl extends Bx{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class zx{constructor(n){this._cd=n}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let Mi=(()=>{class t extends zx{constructor(e){super(e)}}return t.\u0275fac=function(e){return new(e||t)(He(rl,2))},t.\u0275dir=hn({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,i){2&e&&Gh("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[pi]}),t})(),tc=(()=>{class t extends zx{constructor(e){super(e)}}return t.\u0275fac=function(e){return new(e||t)(He(ro,10))},t.\u0275dir=hn({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,i){2&e&&Gh("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[pi]}),t})();const nf="VALID",Ep="INVALID",yu="PENDING",rf="DISABLED";function V$(t){return(Tp(t)?t.validators:t)||null}function Ux(t){return Array.isArray(t)?L$(t):t||null}function G$(t,n){return(Tp(n)?n.asyncValidators:t)||null}function Hx(t){return Array.isArray(t)?B$(t):t||null}function Tp(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class qx{constructor(n,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=n,this._rawAsyncValidators=e,this._composedValidatorFn=Ux(this._rawValidators),this._composedAsyncValidatorFn=Hx(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get valid(){return this.status===nf}get invalid(){return this.status===Ep}get pending(){return this.status==yu}get disabled(){return this.status===rf}get enabled(){return this.status!==rf}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._rawValidators=n,this._composedValidatorFn=Ux(n)}setAsyncValidators(n){this._rawAsyncValidators=n,this._composedAsyncValidatorFn=Hx(n)}addValidators(n){this.setValidators(Rx(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(Rx(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(Lx(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(Lx(n,this._rawAsyncValidators))}hasValidator(n){return wp(this._rawValidators,n)}hasAsyncValidator(n){return wp(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){this.touched=!0,this._parent&&!n.onlySelf&&this._parent.markAsTouched(n)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(n=>n.markAllAsTouched())}markAsUntouched(n={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}markAsDirty(n={}){this.pristine=!1,this._parent&&!n.onlySelf&&this._parent.markAsDirty(n)}markAsPristine(n={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}markAsPending(n={}){this.status=yu,!1!==n.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!n.onlySelf&&this._parent.markAsPending(n)}disable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=rf,this.errors=null,this._forEachChild(i=>{i.disable({...n,onlySelf:!0})}),this._updateValue(),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...n,skipPristineCheck:e}),this._onDisabledChange.forEach(i=>i(!0))}enable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=nf,this._forEachChild(i=>{i.enable({...n,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors({...n,skipPristineCheck:e}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(n){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===nf||this.status===yu)&&this._runAsyncValidator(n.emitEvent)),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(n)}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?rf:nf}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n){if(this.asyncValidator){this.status=yu,this._hasOwnPendingAsyncValidator=!0;const e=Ix(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:n})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(n,e={}){this.errors=n,this._updateControlsErrors(!1!==e.emitEvent)}get(n){let e=n;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((i,r)=>i&&i._find(r),this)}getError(n,e){const i=e?this.get(e):this;return i&&i.errors?i.errors[n]:null}hasError(n,e){return!!this.getError(n,e)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(n)}_initObservables(){this.valueChanges=new Hn,this.statusChanges=new Hn}_calculateStatus(){return this._allControlsDisabled()?rf:this.errors?Ep:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(yu)?yu:this._anyControlsHaveStatus(Ep)?Ep:nf}_anyControlsHaveStatus(n){return this._anyControls(e=>e.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n={}){this.pristine=!this._anyControlsDirty(),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}_updateTouched(n={}){this.touched=this._anyControlsTouched(),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){Tp(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(n){return null}}class q$ extends qx{constructor(n,e,i){super(V$(e),G$(i,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,e){return this.controls[n]?this.controls[n]:(this.controls[n]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(n,e,i={}){this.registerControl(n,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(n,e={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(n,e,i={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],e&&this.registerControl(n,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,e={}){(function Gx(t,n,e){t._forEachChild((i,r)=>{if(void 0===e[r])throw new et(1002,"")})})(this,0,n),Object.keys(n).forEach(i=>{(function Vx(t,n,e){const i=t.controls;if(!(n?Object.keys(i):i).length)throw new et(1e3,"");if(!i[e])throw new et(1001,"")})(this,!0,i),this.controls[i].setValue(n[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){null!=n&&(Object.keys(n).forEach(i=>{const r=this.controls[i];r&&r.patchValue(n[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n={},e={}){this._forEachChild((i,r)=>{i.reset(n[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(n,e,i)=>(n[i]=e.getRawValue(),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(e,i)=>!!i._syncPendingControls()||e);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(e=>{const i=this.controls[e];i&&n(i,e)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(const[e,i]of Object.entries(this.controls))if(this.contains(e)&&n(i))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,i,r)=>((i.enabled||this.disabled)&&(e[r]=i.value),e))}_reduceChildren(n,e){let i=n;return this._forEachChild((r,o)=>{i=e(i,r,o)}),i}_allControlsDisabled(){for(const n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(n){return this.controls.hasOwnProperty(n)?this.controls[n]:null}}function of(t,n){W$(t,n),n.valueAccessor.writeValue(t.value),t.disabled&&n.valueAccessor.setDisabledState?.(!0),function e6(t,n){n.valueAccessor.registerOnChange(e=>{t._pendingValue=e,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&Wx(t,n)})}(t,n),function n6(t,n){const e=(i,r)=>{n.valueAccessor.writeValue(i),r&&n.viewToModelUpdate(i)};t.registerOnChange(e),n._registerOnDestroy(()=>{t._unregisterOnChange(e)})}(t,n),function t6(t,n){n.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&Wx(t,n),"submit"!==t.updateOn&&t.markAsTouched()})}(t,n),function JR(t,n){if(n.valueAccessor.setDisabledState){const e=i=>{n.valueAccessor.setDisabledState(i)};t.registerOnDisabledChange(e),n._registerOnDestroy(()=>{t._unregisterOnDisabledChange(e)})}}(t,n)}function Mp(t,n){t.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(n)})}function W$(t,n){const e=function Ox(t){return t._rawValidators}(t);null!==n.validator?t.setValidators(Nx(e,n.validator)):"function"==typeof e&&t.setValidators([e]);const i=function Fx(t){return t._rawAsyncValidators}(t);null!==n.asyncValidator?t.setAsyncValidators(Nx(i,n.asyncValidator)):"function"==typeof i&&t.setAsyncValidators([i]);const r=()=>t.updateValueAndValidity();Mp(n._rawValidators,r),Mp(n._rawAsyncValidators,r)}function Wx(t,n){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}const a6={provide:ro,useExisting:$t(()=>Ma)},sf=(()=>Promise.resolve())();let Ma=(()=>{class t extends ro{constructor(e,i){super(),this.submitted=!1,this._directives=new Set,this.ngSubmit=new Hn,this.form=new q$({},L$(e),B$(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){sf.then(()=>{const i=this._findContainer(e.path);e.control=i.registerControl(e.name,e.control),of(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){sf.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){sf.then(()=>{const i=this._findContainer(e.path),r=new q$({});(function Kx(t,n){W$(t,n)})(r,e),i.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){sf.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,i){sf.then(()=>{this.form.get(e.path).setValue(i)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,function Zx(t,n){t._syncPendingControls(),n.forEach(e=>{const i=e.control;"submit"===i.updateOn&&i._pendingChange&&(e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}(this.form,this._directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return t.\u0275fac=function(e){return new(e||t)(He(zr,10),He(il,10))},t.\u0275dir=hn({type:t,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,i){1&e&&Ae("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Ti([a6]),pi]}),t})();function Xx(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}function Qx(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}const Jx=class extends qx{constructor(n=null,e,i){super(V$(e),G$(i,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Tp(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=Qx(n)?n.value:n)}setValue(n,e={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(n,e={}){this.setValue(n,e)}reset(n=this.defaultValue,e={}){this._applyFormState(n),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){Xx(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){Xx(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){Qx(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}},u6={provide:rl,useExisting:$t(()=>yi)},nE=(()=>Promise.resolve())();let yi=(()=>{class t extends rl{constructor(e,i,r,o,s){super(),this._changeDetectorRef=s,this.control=new Jx,this._registered=!1,this.update=new Hn,this._parent=e,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function Y$(t,n){if(!n)return null;let e,i,r;return Array.isArray(n),n.forEach(o=>{o.constructor===Ii?e=o:function o6(t){return Object.getPrototypeOf(t.constructor)===ec}(o)?i=o:r=o}),r||i||e||null}(0,o)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const i=e.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),function K$(t,n){if(!t.hasOwnProperty("model"))return!1;const e=t.model;return!!e.isFirstChange()||!Object.is(n,e.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){of(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){nE.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const i=e.isDisabled.currentValue,r=0!==i&&m$(i);nE.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?function Sp(t,n){return[...n.path,t]}(e,this._parent):[e]}}return t.\u0275fac=function(e){return new(e||t)(He(ro,9),He(zr,10),He(il,10),He(Ws,10),He(Ki,8))},t.\u0275dir=hn({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Ti([u6]),pi,Cs]}),t})(),nc=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=hn({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),t})();const d6={provide:Ws,useExisting:$t(()=>Fo),multi:!0};let Fo=(()=>{class t extends ec{writeValue(e){this.setProperty("value",e??"")}registerOnChange(e){this.onChange=i=>{e(""==i?null:parseFloat(i))}}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Fr(t)))(i||t)}}(),t.\u0275dir=hn({type:t,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(e,i){1&e&&Ae("input",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},features:[Ti([d6]),pi]}),t})();const f6={provide:Ws,useExisting:$t(()=>ol),multi:!0};let iE=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zo({type:t}),t.\u0275inj=Eo({}),t})(),h6=(()=>{class t{constructor(){this._accessors=[]}add(e,i){this._accessors.push([e,i])}remove(e){for(let i=this._accessors.length-1;i>=0;--i)if(this._accessors[i][1]===e)return void this._accessors.splice(i,1)}select(e){this._accessors.forEach(i=>{this._isSameGroup(i,e)&&i[1]!==e&&i[1].fireUncheck(e.value)})}_isSameGroup(e,i){return!!e[0].control&&e[0]._parent===i._control._parent&&e[1].name===i.name}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=$n({token:t,factory:t.\u0275fac,providedIn:iE}),t})(),ol=(()=>{class t extends ec{constructor(e,i,r,o){super(e,i),this._registry=r,this._injector=o,this.onChange=()=>{}}ngOnInit(){this._control=this._injector.get(rl),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(e){this._state=e===this.value,this.setProperty("checked",this._state)}registerOnChange(e){this._fn=e,this.onChange=()=>{e(this.value),this._registry.select(this)}}fireUncheck(e){this.writeValue(e)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}}return t.\u0275fac=function(e){return new(e||t)(He(ql),He(Ai),He(h6),He(xs))},t.\u0275dir=hn({type:t,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(e,i){1&e&&Ae("change",function(){return i.onChange()})("blur",function(){return i.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[Ti([f6]),pi]}),t})();const p6={provide:Ws,useExisting:$t(()=>Ro),multi:!0};let Ro=(()=>{class t extends ec{writeValue(e){this.setProperty("value",parseFloat(e))}registerOnChange(e){this.onChange=i=>{e(""==i?null:parseFloat(i))}}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Fr(t)))(i||t)}}(),t.\u0275dir=hn({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,i){1&e&&Ae("change",function(o){return i.onChange(o.target.value)})("input",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},features:[Ti([p6]),pi]}),t})();const b6={provide:Ws,useExisting:$t(()=>$o),multi:!0};function lE(t,n){return null==t?`${n}`:(n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let $o=(()=>{class t extends ec{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const r=lE(this._getOptionId(e),e);this.setProperty("value",r)}registerOnChange(e){this.onChange=i=>{this.value=this._getOptionValue(i),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i),e))return i;return null}_getOptionValue(e){const i=function y6(t){return t.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i):e}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Fr(t)))(i||t)}}(),t.\u0275dir=hn({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,i){1&e&&Ae("change",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[Ti([b6]),pi]}),t})(),oo=(()=>{class t{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(lE(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(He(Ai),He(ql),He($o,9))},t.\u0275dir=hn({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();const C6={provide:Ws,useExisting:$t(()=>J$),multi:!0};function cE(t,n){return null==t?`${n}`:("string"==typeof n&&(n=`'${n}'`),n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let J$=(()=>{class t extends ec{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let i;if(this.value=e,Array.isArray(e)){const r=e.map(o=>this._getOptionId(o));i=(o,s)=>{o._setSelected(r.indexOf(s.toString())>-1)}}else i=(r,o)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(e){this.onChange=i=>{const r=[],o=i.selectedOptions;if(void 0!==o){const s=o;for(let a=0;a<s.length;a++){const b=this._getOptionValue(s[a].value);r.push(b)}}else{const s=i.options;for(let a=0;a<s.length;a++){const h=s[a];if(h.selected){const b=this._getOptionValue(h.value);r.push(b)}}}this.value=r,e(r)}}_registerOption(e){const i=(this._idCounter++).toString();return this._optionMap.set(i,e),i}_getOptionId(e){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i)._value,e))return i;return null}_getOptionValue(e){const i=function w6(t){return t.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i)._value:e}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Fr(t)))(i||t)}}(),t.\u0275dir=hn({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,i){1&e&&Ae("change",function(o){return i.onChange(o.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[Ti([C6]),pi]}),t})(),so=(()=>{class t{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(cE(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(cE(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(He(Ai),He(ql),He(J$,9))},t.\u0275dir=hn({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();function uE(t){return"number"==typeof t?t:parseInt(t,10)}function dE(t){return"number"==typeof t?t:parseFloat(t)}let ic=(()=>{class t{constructor(){this._validator=Cp}ngOnChanges(e){if(this.inputName in e){const i=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):Cp,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=hn({type:t,features:[Cs]}),t})();const x6={provide:zr,useExisting:$t(()=>Ks),multi:!0};let Ks=(()=>{class t extends ic{constructor(){super(...arguments),this.inputName="max",this.normalizeInput=e=>dE(e),this.createValidator=e=>function bx(t){return n=>{if(nl(n.value)||nl(t))return null;const e=parseFloat(n.value);return!isNaN(e)&&e>t?{max:{max:t,actual:n.value}}:null}}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Fr(t)))(i||t)}}(),t.\u0275dir=hn({type:t,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Qt("max",i._enabled?i.max:null)},inputs:{max:"max"},features:[Ti([x6]),pi]}),t})();const E6={provide:zr,useExisting:$t(()=>Ys),multi:!0};let Ys=(()=>{class t extends ic{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=e=>dE(e),this.createValidator=e=>function vx(t){return n=>{if(nl(n.value)||nl(t))return null;const e=parseFloat(n.value);return!isNaN(e)&&e<t?{min:{min:t,actual:n.value}}:null}}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Fr(t)))(i||t)}}(),t.\u0275dir=hn({type:t,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Qt("min",i._enabled?i.min:null)},inputs:{min:"min"},features:[Ti([E6]),pi]}),t})();const T6={provide:zr,useExisting:$t(()=>Dp),multi:!0};let Dp=(()=>{class t extends ic{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=m$,this.createValidator=e=>yx}enabled(e){return e}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Fr(t)))(i||t)}}(),t.\u0275dir=hn({type:t,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,i){2&e&&Qt("required",i._enabled?"":null)},inputs:{required:"required"},features:[Ti([T6]),pi]}),t})();const M6={provide:zr,useExisting:$t(()=>e0),multi:!0};let e0=(()=>{class t extends ic{constructor(){super(...arguments),this.inputName="minlength",this.normalizeInput=e=>uE(e),this.createValidator=e=>function xx(t){return n=>nl(n.value)||!$x(n.value)?null:n.value.length<t?{minlength:{requiredLength:t,actualLength:n.value.length}}:null}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Fr(t)))(i||t)}}(),t.\u0275dir=hn({type:t,selectors:[["","minlength","","formControlName",""],["","minlength","","formControl",""],["","minlength","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Qt("minlength",i._enabled?i.minlength:null)},inputs:{minlength:"minlength"},features:[Ti([M6]),pi]}),t})();const k6={provide:zr,useExisting:$t(()=>t0),multi:!0};let t0=(()=>{class t extends ic{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=e=>uE(e),this.createValidator=e=>function Ex(t){return n=>$x(n.value)&&n.value.length>t?{maxlength:{requiredLength:t,actualLength:n.value.length}}:null}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Fr(t)))(i||t)}}(),t.\u0275dir=hn({type:t,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Qt("maxlength",i._enabled?i.maxlength:null)},inputs:{maxlength:"maxlength"},features:[Ti([k6]),pi]}),t})(),A6=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zo({type:t}),t.\u0275inj=Eo({imports:[iE]}),t})(),P6=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zo({type:t}),t.\u0275inj=Eo({imports:[A6]}),t})();class gE{}const ka="*";function Vn(t,n){return{type:7,name:t,definitions:n,options:{}}}function Zt(t,n=null){return{type:4,styles:n,timings:t}}function mE(t,n=null){return{type:2,steps:t,options:n}}function dt(t){return{type:6,styles:t,offset:null}}function Ap(t,n,e){return{type:0,name:t,styles:n,options:e}}function bn(t){return{type:5,steps:t}}function tn(t,n,e=null){return{type:1,expr:t,animation:n,options:e}}function _E(t){Promise.resolve().then(t)}class af{constructor(n=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=n+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){_E(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(n=>n()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(n){this._position=this.totalTime?n*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class $E{constructor(n){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=n;let e=0,i=0,r=0;const o=this.players.length;0==o?_E(()=>this._onFinish()):this.players.forEach(s=>{s.onDone(()=>{++e==o&&this._onFinish()}),s.onDestroy(()=>{++i==o&&this._onDestroy()}),s.onStart(()=>{++r==o&&this._onStart()})}),this.totalTime=this.players.reduce((s,a)=>Math.max(s,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this.players.forEach(n=>n.init())}onStart(n){this._onStartFns.push(n)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(n=>n()),this._onStartFns=[])}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(n=>n.play())}pause(){this.players.forEach(n=>n.pause())}restart(){this.players.forEach(n=>n.restart())}finish(){this._onFinish(),this.players.forEach(n=>n.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(n=>n.destroy()),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this.players.forEach(n=>n.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(n){const e=n*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,e/i.totalTime):1;i.setPosition(r)})}getPosition(){const n=this.players.reduce((e,i)=>null===e||i.totalTime>e.totalTime?i:e,null);return null!=n?n.getPosition():0}beforeDestroy(){this.players.forEach(n=>{n.beforeDestroy&&n.beforeDestroy()})}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}function vE(t){return new et(3e3,!1)}function m8(){return typeof window<"u"&&typeof window.document<"u"}function r0(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function sl(t){switch(t.length){case 0:return new af;case 1:return t[0];default:return new $E(t)}}function bE(t,n,e,i,r=new Map,o=new Map){const s=[],a=[];let h=-1,b=null;if(i.forEach(ee=>{const de=ee.get("offset"),ge=de==h,xe=ge&&b||new Map;ee.forEach((ke,Pe)=>{let Oe=Pe,je=ke;if("offset"!==Pe)switch(Oe=n.normalizePropertyName(Oe,s),je){case"!":je=r.get(Pe);break;case ka:je=o.get(Pe);break;default:je=n.normalizeStyleValue(Pe,Oe,je,s)}xe.set(Oe,je)}),ge||a.push(xe),b=xe,h=de}),s.length)throw function r8(t){return new et(3502,!1)}();return a}function o0(t,n,e,i){switch(n){case"start":t.onStart(()=>i(e&&s0(e,"start",t)));break;case"done":t.onDone(()=>i(e&&s0(e,"done",t)));break;case"destroy":t.onDestroy(()=>i(e&&s0(e,"destroy",t)))}}function s0(t,n,e){const o=a0(t.element,t.triggerName,t.fromState,t.toState,n||t.phaseName,e.totalTime??t.totalTime,!!e.disabled),s=t._data;return null!=s&&(o._data=s),o}function a0(t,n,e,i,r="",o=0,s){return{element:t,triggerName:n,fromState:e,toState:i,phaseName:r,totalTime:o,disabled:!!s}}function Lo(t,n,e){let i=t.get(n);return i||t.set(n,i=e),i}function yE(t){const n=t.indexOf(":");return[t.substring(1,n),t.slice(n+1)]}let l0=(t,n)=>!1,CE=(t,n,e)=>[],wE=null;function c0(t){const n=t.parentNode||t.host;return n===wE?null:n}(r0()||typeof Element<"u")&&(m8()?(wE=(()=>document.documentElement)(),l0=(t,n)=>{for(;n;){if(n===t)return!0;n=c0(n)}return!1}):l0=(t,n)=>t.contains(n),CE=(t,n,e)=>{if(e)return Array.from(t.querySelectorAll(n));const i=t.querySelector(n);return i?[i]:[]});let rc=null,xE=!1;const EE=l0,TE=CE;let SE=(()=>{class t{validateStyleProperty(e){return function $8(t){rc||(rc=function v8(){return typeof document<"u"?document.body:null}()||{},xE=!!rc.style&&"WebkitAppearance"in rc.style);let n=!0;return rc.style&&!function _8(t){return"ebkit"==t.substring(1,6)}(t)&&(n=t in rc.style,!n&&xE&&(n="Webkit"+t.charAt(0).toUpperCase()+t.slice(1)in rc.style)),n}(e)}matchesElement(e,i){return!1}containsElement(e,i){return EE(e,i)}getParentElement(e){return c0(e)}query(e,i,r){return TE(e,i,r)}computeStyle(e,i,r){return r||""}animate(e,i,r,o,s,a=[],h){return new af(r,o)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=$n({token:t,factory:t.\u0275fac}),t})(),u0=(()=>{class t{}return t.NOOP=new SE,t})();const d0="ng-enter",Pp="ng-leave",Np="ng-trigger",Op=".ng-trigger",ME="ng-animating",f0=".ng-animating";function Da(t){if("number"==typeof t)return t;const n=t.match(/^(-?[\.\d]+)(m?s)/);return!n||n.length<2?0:h0(parseFloat(n[1]),n[2])}function h0(t,n){return"s"===n?1e3*t:t}function Fp(t,n,e){return t.hasOwnProperty("duration")?t:function C8(t,n,e){let r,o=0,s="";if("string"==typeof t){const a=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return n.push(vE()),{duration:0,delay:0,easing:""};r=h0(parseFloat(a[1]),a[2]);const h=a[3];null!=h&&(o=h0(parseFloat(h),a[4]));const b=a[5];b&&(s=b)}else r=t;if(!e){let a=!1,h=n.length;r<0&&(n.push(function F6(){return new et(3100,!1)}()),a=!0),o<0&&(n.push(function R6(){return new et(3101,!1)}()),a=!0),a&&n.splice(h,0,vE())}return{duration:r,delay:o,easing:s}}(t,n,e)}function lf(t,n={}){return Object.keys(t).forEach(e=>{n[e]=t[e]}),n}function kE(t){const n=new Map;return Object.keys(t).forEach(e=>{n.set(e,t[e])}),n}function al(t,n=new Map,e){if(e)for(let[i,r]of e)n.set(i,r);for(let[i,r]of t)n.set(i,r);return n}function AE(t,n,e){return e?n+":"+e+";":""}function PE(t){let n="";for(let e=0;e<t.style.length;e++){const i=t.style.item(e);n+=AE(0,i,t.style.getPropertyValue(i))}for(const e in t.style)t.style.hasOwnProperty(e)&&!e.startsWith("_")&&(n+=AE(0,T8(e),t.style[e]));t.setAttribute("style",n)}function Zs(t,n,e){t.style&&(n.forEach((i,r)=>{const o=g0(r);e&&!e.has(r)&&e.set(r,t.style[o]),t.style[o]=i}),r0()&&PE(t))}function oc(t,n){t.style&&(n.forEach((e,i)=>{const r=g0(i);t.style[r]=""}),r0()&&PE(t))}function cf(t){return Array.isArray(t)?1==t.length?t[0]:mE(t):t}const p0=new RegExp("{{\\s*(.+?)\\s*}}","g");function NE(t){let n=[];if("string"==typeof t){let e;for(;e=p0.exec(t);)n.push(e[1]);p0.lastIndex=0}return n}function uf(t,n,e){const i=t.toString(),r=i.replace(p0,(o,s)=>{let a=n[s];return null==a&&(e.push(function B6(t){return new et(3003,!1)}()),a=""),a.toString()});return r==i?t:r}function Rp(t){const n=[];let e=t.next();for(;!e.done;)n.push(e.value),e=t.next();return n}const E8=/-+([a-z0-9])/g;function g0(t){return t.replace(E8,(...n)=>n[1].toUpperCase())}function T8(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Bo(t,n,e){switch(n.type){case 7:return t.visitTrigger(n,e);case 0:return t.visitState(n,e);case 1:return t.visitTransition(n,e);case 2:return t.visitSequence(n,e);case 3:return t.visitGroup(n,e);case 4:return t.visitAnimate(n,e);case 5:return t.visitKeyframes(n,e);case 6:return t.visitStyle(n,e);case 8:return t.visitReference(n,e);case 9:return t.visitAnimateChild(n,e);case 10:return t.visitAnimateRef(n,e);case 11:return t.visitQuery(n,e);case 12:return t.visitStagger(n,e);default:throw function z6(t){return new et(3004,!1)}()}}function OE(t,n){return window.getComputedStyle(t)[n]}function A8(t,n){const e=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(i=>function P8(t,n,e){if(":"==t[0]){const h=function N8(t,n){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,i)=>parseFloat(i)>parseFloat(e);case":decrement":return(e,i)=>parseFloat(i)<parseFloat(e);default:return n.push(function e8(t){return new et(3016,!1)}()),"* => *"}}(t,e);if("function"==typeof h)return void n.push(h);t=h}const i=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return e.push(function J6(t){return new et(3015,!1)}()),n;const r=i[1],o=i[2],s=i[3];n.push(FE(r,s));"<"==o[0]&&!("*"==r&&"*"==s)&&n.push(FE(s,r))}(i,e,n)):e.push(t),e}const jp=new Set(["true","1"]),Up=new Set(["false","0"]);function FE(t,n){const e=jp.has(t)||Up.has(t),i=jp.has(n)||Up.has(n);return(r,o)=>{let s="*"==t||t==r,a="*"==n||n==o;return!s&&e&&"boolean"==typeof r&&(s=r?jp.has(t):Up.has(t)),!a&&i&&"boolean"==typeof o&&(a=o?jp.has(n):Up.has(n)),s&&a}}const O8=new RegExp("s*:selfs*,?","g");function m0(t,n,e,i){return new F8(t).build(n,e,i)}class F8{constructor(n){this._driver=n}build(n,e,i){const r=new B8(e);return this._resetContextStyleTimingState(r),Bo(this,cf(n),r)}_resetContextStyleTimingState(n){n.currentQuerySelector="",n.collectedStyles=new Map,n.collectedStyles.set("",new Map),n.currentTime=0}visitTrigger(n,e){let i=e.queryCount=0,r=e.depCount=0;const o=[],s=[];return"@"==n.name.charAt(0)&&e.errors.push(function U6(){return new et(3006,!1)}()),n.definitions.forEach(a=>{if(this._resetContextStyleTimingState(e),0==a.type){const h=a,b=h.name;b.toString().split(/\s*,\s*/).forEach(ee=>{h.name=ee,o.push(this.visitState(h,e))}),h.name=b}else if(1==a.type){const h=this.visitTransition(a,e);i+=h.queryCount,r+=h.depCount,s.push(h)}else e.errors.push(function H6(){return new et(3007,!1)}())}),{type:7,name:n.name,states:o,transitions:s,queryCount:i,depCount:r,options:null}}visitState(n,e){const i=this.visitStyle(n.styles,e),r=n.options&&n.options.params||null;if(i.containsDynamicStyles){const o=new Set,s=r||{};i.styles.forEach(a=>{a instanceof Map&&a.forEach(h=>{NE(h).forEach(b=>{s.hasOwnProperty(b)||o.add(b)})})}),o.size&&(Rp(o.values()),e.errors.push(function V6(t,n){return new et(3008,!1)}()))}return{type:0,name:n.name,style:i,options:r?{params:r}:null}}visitTransition(n,e){e.queryCount=0,e.depCount=0;const i=Bo(this,cf(n.animation),e);return{type:1,matchers:A8(n.expr,e.errors),animation:i,queryCount:e.queryCount,depCount:e.depCount,options:sc(n.options)}}visitSequence(n,e){return{type:2,steps:n.steps.map(i=>Bo(this,i,e)),options:sc(n.options)}}visitGroup(n,e){const i=e.currentTime;let r=0;const o=n.steps.map(s=>{e.currentTime=i;const a=Bo(this,s,e);return r=Math.max(r,e.currentTime),a});return e.currentTime=r,{type:3,steps:o,options:sc(n.options)}}visitAnimate(n,e){const i=function j8(t,n){if(t.hasOwnProperty("duration"))return t;if("number"==typeof t)return _0(Fp(t,n).duration,0,"");const e=t;if(e.split(/\s+/).some(o=>"{"==o.charAt(0)&&"{"==o.charAt(1))){const o=_0(0,0,"");return o.dynamic=!0,o.strValue=e,o}const r=Fp(e,n);return _0(r.duration,r.delay,r.easing)}(n.timings,e.errors);e.currentAnimateTimings=i;let r,o=n.styles?n.styles:dt({});if(5==o.type)r=this.visitKeyframes(o,e);else{let s=n.styles,a=!1;if(!s){a=!0;const b={};i.easing&&(b.easing=i.easing),s=dt(b)}e.currentTime+=i.duration+i.delay;const h=this.visitStyle(s,e);h.isEmptyStep=a,r=h}return e.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(n,e){const i=this._makeStyleAst(n,e);return this._validateStyleAst(i,e),i}_makeStyleAst(n,e){const i=[],r=Array.isArray(n.styles)?n.styles:[n.styles];for(let a of r)"string"==typeof a?a===ka?i.push(a):e.errors.push(new et(3002,!1)):i.push(kE(a));let o=!1,s=null;return i.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(s=a.get("easing"),a.delete("easing")),!o))for(let h of a.values())if(h.toString().indexOf("{{")>=0){o=!0;break}}),{type:6,styles:i,easing:s,offset:n.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(n,e){const i=e.currentAnimateTimings;let r=e.currentTime,o=e.currentTime;i&&o>0&&(o-=i.duration+i.delay),n.styles.forEach(s=>{"string"!=typeof s&&s.forEach((a,h)=>{const b=e.collectedStyles.get(e.currentQuerySelector),ee=b.get(h);let de=!0;ee&&(o!=r&&o>=ee.startTime&&r<=ee.endTime&&(e.errors.push(function q6(t,n,e,i,r){return new et(3010,!1)}()),de=!1),o=ee.startTime),de&&b.set(h,{startTime:o,endTime:r}),e.options&&function x8(t,n,e){const i=n.params||{},r=NE(t);r.length&&r.forEach(o=>{i.hasOwnProperty(o)||e.push(function L6(t){return new et(3001,!1)}())})}(a,e.options,e.errors)})})}visitKeyframes(n,e){const i={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function W6(){return new et(3011,!1)}()),i;let o=0;const s=[];let a=!1,h=!1,b=0;const ee=n.steps.map(je=>{const qe=this._makeStyleAst(je,e);let Ve=null!=qe.offset?qe.offset:function z8(t){if("string"==typeof t)return null;let n=null;if(Array.isArray(t))t.forEach(e=>{if(e instanceof Map&&e.has("offset")){const i=e;n=parseFloat(i.get("offset")),i.delete("offset")}});else if(t instanceof Map&&t.has("offset")){const e=t;n=parseFloat(e.get("offset")),e.delete("offset")}return n}(qe.styles),We=0;return null!=Ve&&(o++,We=qe.offset=Ve),h=h||We<0||We>1,a=a||We<b,b=We,s.push(We),qe});h&&e.errors.push(function K6(){return new et(3012,!1)}()),a&&e.errors.push(function Y6(){return new et(3200,!1)}());const de=n.steps.length;let ge=0;o>0&&o<de?e.errors.push(function Z6(){return new et(3202,!1)}()):0==o&&(ge=1/(de-1));const xe=de-1,ke=e.currentTime,Pe=e.currentAnimateTimings,Oe=Pe.duration;return ee.forEach((je,qe)=>{const Ve=ge>0?qe==xe?1:ge*qe:s[qe],We=Ve*Oe;e.currentTime=ke+Pe.delay+We,Pe.duration=We,this._validateStyleAst(je,e),je.offset=Ve,i.styles.push(je)}),i}visitReference(n,e){return{type:8,animation:Bo(this,cf(n.animation),e),options:sc(n.options)}}visitAnimateChild(n,e){return e.depCount++,{type:9,options:sc(n.options)}}visitAnimateRef(n,e){return{type:10,animation:this.visitReference(n.animation,e),options:sc(n.options)}}visitQuery(n,e){const i=e.currentQuerySelector,r=n.options||{};e.queryCount++,e.currentQuery=n;const[o,s]=function R8(t){const n=!!t.split(/\s*,\s*/).find(e=>":self"==e);return n&&(t=t.replace(O8,"")),t=t.replace(/@\*/g,Op).replace(/@\w+/g,e=>Op+"-"+e.slice(1)).replace(/:animating/g,f0),[t,n]}(n.selector);e.currentQuerySelector=i.length?i+" "+o:o,Lo(e.collectedStyles,e.currentQuerySelector,new Map);const a=Bo(this,cf(n.animation),e);return e.currentQuery=null,e.currentQuerySelector=i,{type:11,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:s,animation:a,originalSelector:n.selector,options:sc(n.options)}}visitStagger(n,e){e.currentQuery||e.errors.push(function X6(){return new et(3013,!1)}());const i="full"===n.timings?{duration:0,delay:0,easing:"full"}:Fp(n.timings,e.errors,!0);return{type:12,animation:Bo(this,cf(n.animation),e),timings:i,options:null}}}class B8{constructor(n){this.errors=n,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function sc(t){return t?(t=lf(t)).params&&(t.params=function L8(t){return t?lf(t):null}(t.params)):t={},t}function _0(t,n,e){return{duration:t,delay:n,easing:e}}function $0(t,n,e,i,r,o,s=null,a=!1){return{type:1,element:t,keyframes:n,preStyleProps:e,postStyleProps:i,duration:r,delay:o,totalTime:r+o,easing:s,subTimeline:a}}class Hp{constructor(){this._map=new Map}get(n){return this._map.get(n)||[]}append(n,e){let i=this._map.get(n);i||this._map.set(n,i=[]),i.push(...e)}has(n){return this._map.has(n)}clear(){this._map.clear()}}const V8=new RegExp(":enter","g"),q8=new RegExp(":leave","g");function v0(t,n,e,i,r,o=new Map,s=new Map,a,h,b=[]){return(new W8).buildKeyframes(t,n,e,i,r,o,s,a,h,b)}class W8{buildKeyframes(n,e,i,r,o,s,a,h,b,ee=[]){b=b||new Hp;const de=new b0(n,e,b,r,o,ee,[]);de.options=h;const ge=h.delay?Da(h.delay):0;de.currentTimeline.delayNextStep(ge),de.currentTimeline.setStyles([s],null,de.errors,h),Bo(this,i,de);const xe=de.timelines.filter(ke=>ke.containsAnimation());if(xe.length&&a.size){let ke;for(let Pe=xe.length-1;Pe>=0;Pe--){const Oe=xe[Pe];if(Oe.element===e){ke=Oe;break}}ke&&!ke.allowOnlyTimelineStyles()&&ke.setStyles([a],null,de.errors,h)}return xe.length?xe.map(ke=>ke.buildKeyframes()):[$0(e,[],[],[],0,ge,"",!1)]}visitTrigger(n,e){}visitState(n,e){}visitTransition(n,e){}visitAnimateChild(n,e){const i=e.subInstructions.get(e.element);if(i){const r=e.createSubContext(n.options),o=e.currentTimeline.currentTime,s=this._visitSubInstructions(i,r,r.options);o!=s&&e.transformIntoNewTimeline(s)}e.previousNode=n}visitAnimateRef(n,e){const i=e.createSubContext(n.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([n.options,n.animation.options],e,i),this.visitReference(n.animation,i),e.transformIntoNewTimeline(i.currentTimeline.currentTime),e.previousNode=n}_applyAnimationRefDelays(n,e,i){for(const r of n){const o=r?.delay;if(o){const s="number"==typeof o?o:Da(uf(o,r?.params??{},e.errors));i.delayNextStep(s)}}}_visitSubInstructions(n,e,i){let o=e.currentTimeline.currentTime;const s=null!=i.duration?Da(i.duration):null,a=null!=i.delay?Da(i.delay):null;return 0!==s&&n.forEach(h=>{const b=e.appendInstructionToTimeline(h,s,a);o=Math.max(o,b.duration+b.delay)}),o}visitReference(n,e){e.updateOptions(n.options,!0),Bo(this,n.animation,e),e.previousNode=n}visitSequence(n,e){const i=e.subContextCount;let r=e;const o=n.options;if(o&&(o.params||o.delay)&&(r=e.createSubContext(o),r.transformIntoNewTimeline(),null!=o.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Vp);const s=Da(o.delay);r.delayNextStep(s)}n.steps.length&&(n.steps.forEach(s=>Bo(this,s,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),e.previousNode=n}visitGroup(n,e){const i=[];let r=e.currentTimeline.currentTime;const o=n.options&&n.options.delay?Da(n.options.delay):0;n.steps.forEach(s=>{const a=e.createSubContext(n.options);o&&a.delayNextStep(o),Bo(this,s,a),r=Math.max(r,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(s=>e.currentTimeline.mergeTimelineCollectedStyles(s)),e.transformIntoNewTimeline(r),e.previousNode=n}_visitTiming(n,e){if(n.dynamic){const i=n.strValue;return Fp(e.params?uf(i,e.params,e.errors):i,e.errors)}return{duration:n.duration,delay:n.delay,easing:n.easing}}visitAnimate(n,e){const i=e.currentAnimateTimings=this._visitTiming(n.timings,e),r=e.currentTimeline;i.delay&&(e.incrementTime(i.delay),r.snapshotCurrentStyles());const o=n.style;5==o.type?this.visitKeyframes(o,e):(e.incrementTime(i.duration),this.visitStyle(o,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=n}visitStyle(n,e){const i=e.currentTimeline,r=e.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const o=r&&r.easing||n.easing;n.isEmptyStep?i.applyEmptyStep(o):i.setStyles(n.styles,o,e.errors,e.options),e.previousNode=n}visitKeyframes(n,e){const i=e.currentAnimateTimings,r=e.currentTimeline.duration,o=i.duration,a=e.createSubContext().currentTimeline;a.easing=i.easing,n.styles.forEach(h=>{a.forwardTime((h.offset||0)*o),a.setStyles(h.styles,h.easing,e.errors,e.options),a.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(a),e.transformIntoNewTimeline(r+o),e.previousNode=n}visitQuery(n,e){const i=e.currentTimeline.currentTime,r=n.options||{},o=r.delay?Da(r.delay):0;o&&(6===e.previousNode.type||0==i&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=Vp);let s=i;const a=e.invokeQuery(n.selector,n.originalSelector,n.limit,n.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=a.length;let h=null;a.forEach((b,ee)=>{e.currentQueryIndex=ee;const de=e.createSubContext(n.options,b);o&&de.delayNextStep(o),b===e.element&&(h=de.currentTimeline),Bo(this,n.animation,de),de.currentTimeline.applyStylesToKeyframe(),s=Math.max(s,de.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(s),h&&(e.currentTimeline.mergeTimelineCollectedStyles(h),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=n}visitStagger(n,e){const i=e.parentContext,r=e.currentTimeline,o=n.timings,s=Math.abs(o.duration),a=s*(e.currentQueryTotal-1);let h=s*e.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":h=a-h;break;case"full":h=i.currentStaggerTime}const ee=e.currentTimeline;h&&ee.delayNextStep(h);const de=ee.currentTime;Bo(this,n.animation,e),e.previousNode=n,i.currentStaggerTime=r.currentTime-de+(r.startTime-i.currentTimeline.startTime)}}const Vp={};class b0{constructor(n,e,i,r,o,s,a,h){this._driver=n,this.element=e,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=o,this.errors=s,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Vp,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=h||new Gp(this._driver,e,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(n,e){if(!n)return;const i=n;let r=this.options;null!=i.duration&&(r.duration=Da(i.duration)),null!=i.delay&&(r.delay=Da(i.delay));const o=i.params;if(o){let s=r.params;s||(s=this.options.params={}),Object.keys(o).forEach(a=>{(!e||!s.hasOwnProperty(a))&&(s[a]=uf(o[a],s,this.errors))})}}_copyOptions(){const n={};if(this.options){const e=this.options.params;if(e){const i=n.params={};Object.keys(e).forEach(r=>{i[r]=e[r]})}}return n}createSubContext(n=null,e,i){const r=e||this.element,o=new b0(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(n),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(n){return this.previousNode=Vp,this.currentTimeline=this.currentTimeline.fork(this.element,n),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(n,e,i){const r={duration:e??n.duration,delay:this.currentTimeline.currentTime+(i??0)+n.delay,easing:""},o=new K8(this._driver,n.element,n.keyframes,n.preStyleProps,n.postStyleProps,r,n.stretchStartingKeyframe);return this.timelines.push(o),r}incrementTime(n){this.currentTimeline.forwardTime(this.currentTimeline.duration+n)}delayNextStep(n){n>0&&this.currentTimeline.delayNextStep(n)}invokeQuery(n,e,i,r,o,s){let a=[];if(r&&a.push(this.element),n.length>0){n=(n=n.replace(V8,"."+this._enterClassName)).replace(q8,"."+this._leaveClassName);let b=this._driver.query(this.element,n,1!=i);0!==i&&(b=i<0?b.slice(b.length+i,b.length):b.slice(0,i)),a.push(...b)}return!o&&0==a.length&&s.push(function Q6(t){return new et(3014,!1)}()),a}}class Gp{constructor(n,e,i,r){this._driver=n,this.element=e,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(n){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+n),e&&this.snapshotCurrentStyles()):this.startTime+=n}fork(n,e){return this.applyStylesToKeyframe(),new Gp(this._driver,n,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(n){this.applyStylesToKeyframe(),this.duration=n,this._loadKeyframe()}_updateStyle(n,e){this._localTimelineStyles.set(n,e),this._globalTimelineStyles.set(n,e),this._styleSummary.set(n,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(n){n&&this._previousKeyframe.set("easing",n);for(let[e,i]of this._globalTimelineStyles)this._backFill.set(e,i||ka),this._currentKeyframe.set(e,ka);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(n,e,i,r){e&&this._previousKeyframe.set("easing",e);const o=r&&r.params||{},s=function Y8(t,n){const e=new Map;let i;return t.forEach(r=>{if("*"===r){i=i||n.keys();for(let o of i)e.set(o,ka)}else al(r,e)}),e}(n,this._globalTimelineStyles);for(let[a,h]of s){const b=uf(h,o,i);this._pendingStyles.set(a,b),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??ka),this._updateStyle(a,b)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((n,e)=>{this._currentKeyframe.set(e,n)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((n,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,n)}))}snapshotCurrentStyles(){for(let[n,e]of this._localTimelineStyles)this._pendingStyles.set(n,e),this._updateStyle(n,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const n=[];for(let e in this._currentKeyframe)n.push(e);return n}mergeTimelineCollectedStyles(n){n._styleSummary.forEach((e,i)=>{const r=this._styleSummary.get(i);(!r||e.time>r.time)&&this._updateStyle(i,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const n=new Set,e=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,h)=>{const b=al(a,new Map,this._backFill);b.forEach((ee,de)=>{"!"===ee?n.add(de):ee===ka&&e.add(de)}),i||b.set("offset",h/this.duration),r.push(b)});const o=n.size?Rp(n.values()):[],s=e.size?Rp(e.values()):[];if(i){const a=r[0],h=new Map(a);a.set("offset",0),h.set("offset",1),r=[a,h]}return $0(this.element,r,o,s,this.duration,this.startTime,this.easing,!1)}}class K8 extends Gp{constructor(n,e,i,r,o,s,a=!1){super(n,e,s.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=o,this._stretchStartingKeyframe=a,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let n=this.keyframes,{delay:e,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const o=[],s=i+e,a=e/s,h=al(n[0]);h.set("offset",0),o.push(h);const b=al(n[0]);b.set("offset",BE(a)),o.push(b);const ee=n.length-1;for(let de=1;de<=ee;de++){let ge=al(n[de]);const xe=ge.get("offset");ge.set("offset",BE((e+xe*i)/s)),o.push(ge)}i=s,e=0,r="",n=o}return $0(this.element,n,this.preStyleProps,this.postStyleProps,i,e,r,!0)}}function BE(t,n=3){const e=Math.pow(10,n-1);return Math.round(t*e)/e}class y0{}const Z8=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class X8 extends y0{normalizePropertyName(n,e){return g0(n)}normalizeStyleValue(n,e,i,r){let o="";const s=i.toString().trim();if(Z8.has(e)&&0!==i&&"0"!==i)if("number"==typeof i)o="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function j6(t,n){return new et(3005,!1)}())}return s+o}}function zE(t,n,e,i,r,o,s,a,h,b,ee,de,ge){return{type:0,element:t,triggerName:n,isRemovalTransition:r,fromState:e,fromStyles:o,toState:i,toStyles:s,timelines:a,queriedElements:h,preStyleProps:b,postStyleProps:ee,totalTime:de,errors:ge}}const C0={};class jE{constructor(n,e,i){this._triggerName=n,this.ast=e,this._stateStyles=i}match(n,e,i,r){return function Q8(t,n,e,i,r){return t.some(o=>o(n,e,i,r))}(this.ast.matchers,n,e,i,r)}buildStyles(n,e,i){let r=this._stateStyles.get("*");return void 0!==n&&(r=this._stateStyles.get(n?.toString())||r),r?r.buildStyles(e,i):new Map}build(n,e,i,r,o,s,a,h,b,ee){const de=[],ge=this.ast.options&&this.ast.options.params||C0,ke=this.buildStyles(i,a&&a.params||C0,de),Pe=h&&h.params||C0,Oe=this.buildStyles(r,Pe,de),je=new Set,qe=new Map,Ve=new Map,We="void"===r,vt={params:J8(Pe,ge),delay:this.ast.options?.delay},nt=ee?[]:v0(n,e,this.ast.animation,o,s,ke,Oe,vt,b,de);let _t=0;if(nt.forEach(ht=>{_t=Math.max(ht.duration+ht.delay,_t)}),de.length)return zE(e,this._triggerName,i,r,We,ke,Oe,[],[],qe,Ve,_t,de);nt.forEach(ht=>{const yt=ht.element,Tt=Lo(qe,yt,new Set);ht.preStyleProps.forEach(rn=>Tt.add(rn));const nn=Lo(Ve,yt,new Set);ht.postStyleProps.forEach(rn=>nn.add(rn)),yt!==e&&je.add(yt)});const Mt=Rp(je.values());return zE(e,this._triggerName,i,r,We,ke,Oe,nt,Mt,qe,Ve,_t)}}function J8(t,n){const e=lf(n);for(const i in t)t.hasOwnProperty(i)&&null!=t[i]&&(e[i]=t[i]);return e}class eL{constructor(n,e,i){this.styles=n,this.defaultParams=e,this.normalizer=i}buildStyles(n,e){const i=new Map,r=lf(this.defaultParams);return Object.keys(n).forEach(o=>{const s=n[o];null!==s&&(r[o]=s)}),this.styles.styles.forEach(o=>{"string"!=typeof o&&o.forEach((s,a)=>{s&&(s=uf(s,r,e));const h=this.normalizer.normalizePropertyName(a,e);s=this.normalizer.normalizeStyleValue(a,h,s,e),i.set(h,s)})}),i}}class nL{constructor(n,e,i){this.name=n,this.ast=e,this._normalizer=i,this.transitionFactories=[],this.states=new Map,e.states.forEach(r=>{this.states.set(r.name,new eL(r.style,r.options&&r.options.params||{},i))}),UE(this.states,"true","1"),UE(this.states,"false","0"),e.transitions.forEach(r=>{this.transitionFactories.push(new jE(n,r,this.states))}),this.fallbackTransition=function iL(t,n,e){return new jE(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[(s,a)=>!0],options:null,queryCount:0,depCount:0},n)}(n,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(n,e,i,r){return this.transitionFactories.find(s=>s.match(n,e,i,r))||null}matchStyles(n,e,i){return this.fallbackTransition.buildStyles(n,e,i)}}function UE(t,n,e){t.has(n)?t.has(e)||t.set(e,t.get(n)):t.has(e)&&t.set(n,t.get(e))}const rL=new Hp;class oL{constructor(n,e,i){this.bodyNode=n,this._driver=e,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(n,e){const i=[],o=m0(this._driver,e,i,[]);if(i.length)throw function o8(t){return new et(3503,!1)}();this._animations.set(n,o)}_buildPlayer(n,e,i){const r=n.element,o=bE(0,this._normalizer,0,n.keyframes,e,i);return this._driver.animate(r,o,n.duration,n.delay,n.easing,[],!0)}create(n,e,i={}){const r=[],o=this._animations.get(n);let s;const a=new Map;if(o?(s=v0(this._driver,e,o,d0,Pp,new Map,new Map,i,rL,r),s.forEach(ee=>{const de=Lo(a,ee.element,new Map);ee.postStyleProps.forEach(ge=>de.set(ge,null))})):(r.push(function s8(){return new et(3300,!1)}()),s=[]),r.length)throw function a8(t){return new et(3504,!1)}();a.forEach((ee,de)=>{ee.forEach((ge,xe)=>{ee.set(xe,this._driver.computeStyle(de,xe,ka))})});const b=sl(s.map(ee=>{const de=a.get(ee.element);return this._buildPlayer(ee,new Map,de)}));return this._playersById.set(n,b),b.onDestroy(()=>this.destroy(n)),this.players.push(b),b}destroy(n){const e=this._getPlayer(n);e.destroy(),this._playersById.delete(n);const i=this.players.indexOf(e);i>=0&&this.players.splice(i,1)}_getPlayer(n){const e=this._playersById.get(n);if(!e)throw function l8(t){return new et(3301,!1)}();return e}listen(n,e,i,r){const o=a0(e,"","","");return o0(this._getPlayer(n),i,o,r),()=>{}}command(n,e,i,r){if("register"==i)return void this.register(n,r[0]);if("create"==i)return void this.create(n,e,r[0]||{});const o=this._getPlayer(n);switch(i){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(n)}}}const HE="ng-animate-queued",w0="ng-animate-disabled",uL=[],VE={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},dL={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},ns="__ng_removed";class x0{constructor(n,e=""){this.namespaceId=e;const i=n&&n.hasOwnProperty("value");if(this.value=function gL(t){return t??null}(i?n.value:n),i){const o=lf(n);delete o.value,this.options=o}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(n){const e=n.params;if(e){const i=this.options.params;Object.keys(e).forEach(r=>{null==i[r]&&(i[r]=e[r])})}}}const df="void",E0=new x0(df);class fL{constructor(n,e,i){this.id=n,this.hostElement=e,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+n,is(e,this._hostClassName)}listen(n,e,i,r){if(!this._triggers.has(e))throw function c8(t,n){return new et(3302,!1)}();if(null==i||0==i.length)throw function u8(t){return new et(3303,!1)}();if(!function mL(t){return"start"==t||"done"==t}(i))throw function d8(t,n){return new et(3400,!1)}();const o=Lo(this._elementListeners,n,[]),s={name:e,phase:i,callback:r};o.push(s);const a=Lo(this._engine.statesByElement,n,new Map);return a.has(e)||(is(n,Np),is(n,Np+"-"+e),a.set(e,E0)),()=>{this._engine.afterFlush(()=>{const h=o.indexOf(s);h>=0&&o.splice(h,1),this._triggers.has(e)||a.delete(e)})}}register(n,e){return!this._triggers.has(n)&&(this._triggers.set(n,e),!0)}_getTrigger(n){const e=this._triggers.get(n);if(!e)throw function f8(t){return new et(3401,!1)}();return e}trigger(n,e,i,r=!0){const o=this._getTrigger(e),s=new T0(this.id,e,n);let a=this._engine.statesByElement.get(n);a||(is(n,Np),is(n,Np+"-"+e),this._engine.statesByElement.set(n,a=new Map));let h=a.get(e);const b=new x0(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&h&&b.absorbOptions(h.options),a.set(e,b),h||(h=E0),b.value!==df&&h.value===b.value){if(!function vL(t,n){const e=Object.keys(t),i=Object.keys(n);if(e.length!=i.length)return!1;for(let r=0;r<e.length;r++){const o=e[r];if(!n.hasOwnProperty(o)||t[o]!==n[o])return!1}return!0}(h.params,b.params)){const Pe=[],Oe=o.matchStyles(h.value,h.params,Pe),je=o.matchStyles(b.value,b.params,Pe);Pe.length?this._engine.reportError(Pe):this._engine.afterFlush(()=>{oc(n,Oe),Zs(n,je)})}return}const ge=Lo(this._engine.playersByElement,n,[]);ge.forEach(Pe=>{Pe.namespaceId==this.id&&Pe.triggerName==e&&Pe.queued&&Pe.destroy()});let xe=o.matchTransition(h.value,b.value,n,b.params),ke=!1;if(!xe){if(!r)return;xe=o.fallbackTransition,ke=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:e,transition:xe,fromState:h,toState:b,player:s,isFallbackTransition:ke}),ke||(is(n,HE),s.onStart(()=>{Cu(n,HE)})),s.onDone(()=>{let Pe=this.players.indexOf(s);Pe>=0&&this.players.splice(Pe,1);const Oe=this._engine.playersByElement.get(n);if(Oe){let je=Oe.indexOf(s);je>=0&&Oe.splice(je,1)}}),this.players.push(s),ge.push(s),s}deregister(n){this._triggers.delete(n),this._engine.statesByElement.forEach(e=>e.delete(n)),this._elementListeners.forEach((e,i)=>{this._elementListeners.set(i,e.filter(r=>r.name!=n))})}clearElementCache(n){this._engine.statesByElement.delete(n),this._elementListeners.delete(n);const e=this._engine.playersByElement.get(n);e&&(e.forEach(i=>i.destroy()),this._engine.playersByElement.delete(n))}_signalRemovalForInnerTriggers(n,e){const i=this._engine.driver.query(n,Op,!0);i.forEach(r=>{if(r[ns])return;const o=this._engine.fetchNamespacesByElement(r);o.size?o.forEach(s=>s.triggerLeaveAnimation(r,e,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(n,e,i,r){const o=this._engine.statesByElement.get(n),s=new Map;if(o){const a=[];if(o.forEach((h,b)=>{if(s.set(b,h.value),this._triggers.has(b)){const ee=this.trigger(n,b,df,r);ee&&a.push(ee)}}),a.length)return this._engine.markElementAsRemoved(this.id,n,!0,e,s),i&&sl(a).onDone(()=>this._engine.processLeaveNode(n)),!0}return!1}prepareLeaveAnimationListeners(n){const e=this._elementListeners.get(n),i=this._engine.statesByElement.get(n);if(e&&i){const r=new Set;e.forEach(o=>{const s=o.name;if(r.has(s))return;r.add(s);const h=this._triggers.get(s).fallbackTransition,b=i.get(s)||E0,ee=new x0(df),de=new T0(this.id,s,n);this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:s,transition:h,fromState:b,toState:ee,player:de,isFallbackTransition:!0})})}}removeNode(n,e){const i=this._engine;if(n.childElementCount&&this._signalRemovalForInnerTriggers(n,e),this.triggerLeaveAnimation(n,e,!0))return;let r=!1;if(i.totalAnimations){const o=i.players.length?i.playersByQueriedElement.get(n):[];if(o&&o.length)r=!0;else{let s=n;for(;s=s.parentNode;)if(i.statesByElement.get(s)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(n),r)i.markElementAsRemoved(this.id,n,!1,e);else{const o=n[ns];(!o||o===VE)&&(i.afterFlush(()=>this.clearElementCache(n)),i.destroyInnerAnimations(n),i._onRemovalComplete(n,e))}}insertNode(n,e){is(n,this._hostClassName)}drainQueuedTransitions(n){const e=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const o=i.element,s=this._elementListeners.get(o);s&&s.forEach(a=>{if(a.name==i.triggerName){const h=a0(o,i.triggerName,i.fromState.value,i.toState.value);h._data=n,o0(i.player,a.phase,h,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(i)}),this._queue=[],e.sort((i,r)=>{const o=i.transition.ast.depCount,s=r.transition.ast.depCount;return 0==o||0==s?o-s:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(n){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,n)}elementContainsData(n){let e=!1;return this._elementListeners.has(n)&&(e=!0),e=!!this._queue.find(i=>i.element===n)||e,e}}class hL{constructor(n,e,i){this.bodyNode=n,this.driver=e,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,o)=>{}}_onRemovalComplete(n,e){this.onRemovalComplete(n,e)}get queuedPlayers(){const n=[];return this._namespaceList.forEach(e=>{e.players.forEach(i=>{i.queued&&n.push(i)})}),n}createNamespace(n,e){const i=new fL(n,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(i,e):(this.newHostElements.set(e,i),this.collectEnterElement(e)),this._namespaceLookup[n]=i}_balanceNamespaceList(n,e){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let s=!1,a=this.driver.getParentElement(e);for(;a;){const h=r.get(a);if(h){const b=i.indexOf(h);i.splice(b+1,0,n),s=!0;break}a=this.driver.getParentElement(a)}s||i.unshift(n)}else i.push(n);return r.set(e,n),n}register(n,e){let i=this._namespaceLookup[n];return i||(i=this.createNamespace(n,e)),i}registerTrigger(n,e,i){let r=this._namespaceLookup[n];r&&r.register(e,i)&&this.totalAnimations++}destroy(n,e){if(!n)return;const i=this._fetchNamespace(n);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[n];const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>i.destroy(e))}_fetchNamespace(n){return this._namespaceLookup[n]}fetchNamespacesByElement(n){const e=new Set,i=this.statesByElement.get(n);if(i)for(let r of i.values())if(r.namespaceId){const o=this._fetchNamespace(r.namespaceId);o&&e.add(o)}return e}trigger(n,e,i,r){if(qp(e)){const o=this._fetchNamespace(n);if(o)return o.trigger(e,i,r),!0}return!1}insertNode(n,e,i,r){if(!qp(e))return;const o=e[ns];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;const s=this.collectedLeaveElements.indexOf(e);s>=0&&this.collectedLeaveElements.splice(s,1)}if(n){const s=this._fetchNamespace(n);s&&s.insertNode(e,i)}r&&this.collectEnterElement(e)}collectEnterElement(n){this.collectedEnterElements.push(n)}markElementAsDisabled(n,e){e?this.disabledNodes.has(n)||(this.disabledNodes.add(n),is(n,w0)):this.disabledNodes.has(n)&&(this.disabledNodes.delete(n),Cu(n,w0))}removeNode(n,e,i,r){if(qp(e)){const o=n?this._fetchNamespace(n):null;if(o?o.removeNode(e,r):this.markElementAsRemoved(n,e,!1,r),i){const s=this.namespacesByHostElement.get(e);s&&s.id!==n&&s.removeNode(e,r)}}else this._onRemovalComplete(e,r)}markElementAsRemoved(n,e,i,r,o){this.collectedLeaveElements.push(e),e[ns]={namespaceId:n,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:o}}listen(n,e,i,r,o){return qp(e)?this._fetchNamespace(n).listen(e,i,r,o):()=>{}}_buildInstruction(n,e,i,r,o){return n.transition.build(this.driver,n.element,n.fromState.value,n.toState.value,i,r,n.fromState.options,n.toState.options,e,o)}destroyInnerAnimations(n){let e=this.driver.query(n,Op,!0);e.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(n,f0,!0),e.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(n){const e=this.playersByElement.get(n);e&&e.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(n){const e=this.playersByQueriedElement.get(n);e&&e.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(n=>{if(this.players.length)return sl(this.players).onDone(()=>n());n()})}processLeaveNode(n){const e=n[ns];if(e&&e.setForRemoval){if(n[ns]=VE,e.namespaceId){this.destroyInnerAnimations(n);const i=this._fetchNamespace(e.namespaceId);i&&i.clearElementCache(n)}this._onRemovalComplete(n,e.setForRemoval)}n.classList?.contains(w0)&&this.markElementAsDisabled(n,!1),this.driver.query(n,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(n=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)is(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{e=this._flushAnimations(i,n)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],e.length?sl(e).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(n){throw function h8(t){return new et(3402,!1)}()}_flushAnimations(n,e){const i=new Hp,r=[],o=new Map,s=[],a=new Map,h=new Map,b=new Map,ee=new Set;this.disabledNodes.forEach(Rt=>{ee.add(Rt);const Ut=this.driver.query(Rt,".ng-animate-queued",!0);for(let jt=0;jt<Ut.length;jt++)ee.add(Ut[jt])});const de=this.bodyNode,ge=Array.from(this.statesByElement.keys()),xe=WE(ge,this.collectedEnterElements),ke=new Map;let Pe=0;xe.forEach((Rt,Ut)=>{const jt=d0+Pe++;ke.set(Ut,jt),Rt.forEach(Yt=>is(Yt,jt))});const Oe=[],je=new Set,qe=new Set;for(let Rt=0;Rt<this.collectedLeaveElements.length;Rt++){const Ut=this.collectedLeaveElements[Rt],jt=Ut[ns];jt&&jt.setForRemoval&&(Oe.push(Ut),je.add(Ut),jt.hasAnimation?this.driver.query(Ut,".ng-star-inserted",!0).forEach(Yt=>je.add(Yt)):qe.add(Ut))}const Ve=new Map,We=WE(ge,Array.from(je));We.forEach((Rt,Ut)=>{const jt=Pp+Pe++;Ve.set(Ut,jt),Rt.forEach(Yt=>is(Yt,jt))}),n.push(()=>{xe.forEach((Rt,Ut)=>{const jt=ke.get(Ut);Rt.forEach(Yt=>Cu(Yt,jt))}),We.forEach((Rt,Ut)=>{const jt=Ve.get(Ut);Rt.forEach(Yt=>Cu(Yt,jt))}),Oe.forEach(Rt=>{this.processLeaveNode(Rt)})});const vt=[],nt=[];for(let Rt=this._namespaceList.length-1;Rt>=0;Rt--)this._namespaceList[Rt].drainQueuedTransitions(e).forEach(jt=>{const Yt=jt.player,Fn=jt.element;if(vt.push(Yt),this.collectedEnterElements.length){const Bi=Fn[ns];if(Bi&&Bi.setForMove){if(Bi.previousTriggersValues&&Bi.previousTriggersValues.has(jt.triggerName)){const Rs=Bi.previousTriggersValues.get(jt.triggerName),Dr=this.statesByElement.get(jt.element);if(Dr&&Dr.has(jt.triggerName)){const za=Dr.get(jt.triggerName);za.value=Rs,Dr.set(jt.triggerName,za)}}return void Yt.destroy()}}const Jn=!de||!this.driver.containsElement(de,Fn),oi=Ve.get(Fn),Di=ke.get(Fn),Gn=this._buildInstruction(jt,i,Di,oi,Jn);if(Gn.errors&&Gn.errors.length)return void nt.push(Gn);if(Jn)return Yt.onStart(()=>oc(Fn,Gn.fromStyles)),Yt.onDestroy(()=>Zs(Fn,Gn.toStyles)),void r.push(Yt);if(jt.isFallbackTransition)return Yt.onStart(()=>oc(Fn,Gn.fromStyles)),Yt.onDestroy(()=>Zs(Fn,Gn.toStyles)),void r.push(Yt);const Dt=[];Gn.timelines.forEach(Bi=>{Bi.stretchStartingKeyframe=!0,this.disabledNodes.has(Bi.element)||Dt.push(Bi)}),Gn.timelines=Dt,i.append(Fn,Gn.timelines),s.push({instruction:Gn,player:Yt,element:Fn}),Gn.queriedElements.forEach(Bi=>Lo(a,Bi,[]).push(Yt)),Gn.preStyleProps.forEach((Bi,Rs)=>{if(Bi.size){let Dr=h.get(Rs);Dr||h.set(Rs,Dr=new Set),Bi.forEach((za,Il)=>Dr.add(Il))}}),Gn.postStyleProps.forEach((Bi,Rs)=>{let Dr=b.get(Rs);Dr||b.set(Rs,Dr=new Set),Bi.forEach((za,Il)=>Dr.add(Il))})});if(nt.length){const Rt=[];nt.forEach(Ut=>{Rt.push(function p8(t,n){return new et(3505,!1)}())}),vt.forEach(Ut=>Ut.destroy()),this.reportError(Rt)}const _t=new Map,Mt=new Map;s.forEach(Rt=>{const Ut=Rt.element;i.has(Ut)&&(Mt.set(Ut,Ut),this._beforeAnimationBuild(Rt.player.namespaceId,Rt.instruction,_t))}),r.forEach(Rt=>{const Ut=Rt.element;this._getPreviousPlayers(Ut,!1,Rt.namespaceId,Rt.triggerName,null).forEach(Yt=>{Lo(_t,Ut,[]).push(Yt),Yt.destroy()})});const ht=Oe.filter(Rt=>YE(Rt,h,b)),yt=new Map;qE(yt,this.driver,qe,b,ka).forEach(Rt=>{YE(Rt,h,b)&&ht.push(Rt)});const nn=new Map;xe.forEach((Rt,Ut)=>{qE(nn,this.driver,new Set(Rt),h,"!")}),ht.forEach(Rt=>{const Ut=yt.get(Rt),jt=nn.get(Rt);yt.set(Rt,new Map([...Array.from(Ut?.entries()??[]),...Array.from(jt?.entries()??[])]))});const rn=[],En=[],Wn={};s.forEach(Rt=>{const{element:Ut,player:jt,instruction:Yt}=Rt;if(i.has(Ut)){if(ee.has(Ut))return jt.onDestroy(()=>Zs(Ut,Yt.toStyles)),jt.disabled=!0,jt.overrideTotalTime(Yt.totalTime),void r.push(jt);let Fn=Wn;if(Mt.size>1){let oi=Ut;const Di=[];for(;oi=oi.parentNode;){const Gn=Mt.get(oi);if(Gn){Fn=Gn;break}Di.push(oi)}Di.forEach(Gn=>Mt.set(Gn,Fn))}const Jn=this._buildAnimation(jt.namespaceId,Yt,_t,o,nn,yt);if(jt.setRealPlayer(Jn),Fn===Wn)rn.push(jt);else{const oi=this.playersByElement.get(Fn);oi&&oi.length&&(jt.parentPlayer=sl(oi)),r.push(jt)}}else oc(Ut,Yt.fromStyles),jt.onDestroy(()=>Zs(Ut,Yt.toStyles)),En.push(jt),ee.has(Ut)&&r.push(jt)}),En.forEach(Rt=>{const Ut=o.get(Rt.element);if(Ut&&Ut.length){const jt=sl(Ut);Rt.setRealPlayer(jt)}}),r.forEach(Rt=>{Rt.parentPlayer?Rt.syncPlayerEvents(Rt.parentPlayer):Rt.destroy()});for(let Rt=0;Rt<Oe.length;Rt++){const Ut=Oe[Rt],jt=Ut[ns];if(Cu(Ut,Pp),jt&&jt.hasAnimation)continue;let Yt=[];if(a.size){let Jn=a.get(Ut);Jn&&Jn.length&&Yt.push(...Jn);let oi=this.driver.query(Ut,f0,!0);for(let Di=0;Di<oi.length;Di++){let Gn=a.get(oi[Di]);Gn&&Gn.length&&Yt.push(...Gn)}}const Fn=Yt.filter(Jn=>!Jn.destroyed);Fn.length?_L(this,Ut,Fn):this.processLeaveNode(Ut)}return Oe.length=0,rn.forEach(Rt=>{this.players.push(Rt),Rt.onDone(()=>{Rt.destroy();const Ut=this.players.indexOf(Rt);this.players.splice(Ut,1)}),Rt.play()}),rn}elementContainsData(n,e){let i=!1;const r=e[ns];return r&&r.setForRemoval&&(i=!0),this.playersByElement.has(e)&&(i=!0),this.playersByQueriedElement.has(e)&&(i=!0),this.statesByElement.has(e)&&(i=!0),this._fetchNamespace(n).elementContainsData(e)||i}afterFlush(n){this._flushFns.push(n)}afterFlushAnimationsDone(n){this._whenQuietFns.push(n)}_getPreviousPlayers(n,e,i,r,o){let s=[];if(e){const a=this.playersByQueriedElement.get(n);a&&(s=a)}else{const a=this.playersByElement.get(n);if(a){const h=!o||o==df;a.forEach(b=>{b.queued||!h&&b.triggerName!=r||s.push(b)})}}return(i||r)&&(s=s.filter(a=>!(i&&i!=a.namespaceId||r&&r!=a.triggerName))),s}_beforeAnimationBuild(n,e,i){const o=e.element,s=e.isRemovalTransition?void 0:n,a=e.isRemovalTransition?void 0:e.triggerName;for(const h of e.timelines){const b=h.element,ee=b!==o,de=Lo(i,b,[]);this._getPreviousPlayers(b,ee,s,a,e.toState).forEach(xe=>{const ke=xe.getRealPlayer();ke.beforeDestroy&&ke.beforeDestroy(),xe.destroy(),de.push(xe)})}oc(o,e.fromStyles)}_buildAnimation(n,e,i,r,o,s){const a=e.triggerName,h=e.element,b=[],ee=new Set,de=new Set,ge=e.timelines.map(ke=>{const Pe=ke.element;ee.add(Pe);const Oe=Pe[ns];if(Oe&&Oe.removedBeforeQueried)return new af(ke.duration,ke.delay);const je=Pe!==h,qe=function $L(t){const n=[];return KE(t,n),n}((i.get(Pe)||uL).map(_t=>_t.getRealPlayer())).filter(_t=>!!_t.element&&_t.element===Pe),Ve=o.get(Pe),We=s.get(Pe),vt=bE(0,this._normalizer,0,ke.keyframes,Ve,We),nt=this._buildPlayer(ke,vt,qe);if(ke.subTimeline&&r&&de.add(Pe),je){const _t=new T0(n,a,Pe);_t.setRealPlayer(nt),b.push(_t)}return nt});b.forEach(ke=>{Lo(this.playersByQueriedElement,ke.element,[]).push(ke),ke.onDone(()=>function pL(t,n,e){let i=t.get(n);if(i){if(i.length){const r=i.indexOf(e);i.splice(r,1)}0==i.length&&t.delete(n)}return i}(this.playersByQueriedElement,ke.element,ke))}),ee.forEach(ke=>is(ke,ME));const xe=sl(ge);return xe.onDestroy(()=>{ee.forEach(ke=>Cu(ke,ME)),Zs(h,e.toStyles)}),de.forEach(ke=>{Lo(r,ke,[]).push(xe)}),xe}_buildPlayer(n,e,i){return e.length>0?this.driver.animate(n.element,e,n.duration,n.delay,n.easing,i):new af(n.duration,n.delay)}}class T0{constructor(n,e,i){this.namespaceId=n,this.triggerName=e,this.element=i,this._player=new af,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(n){this._containsRealPlayer||(this._player=n,this._queuedCallbacks.forEach((e,i)=>{e.forEach(r=>o0(n,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(n.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(n){this.totalTime=n}syncPlayerEvents(n){const e=this._player;e.triggerCallback&&n.onStart(()=>e.triggerCallback("start")),n.onDone(()=>this.finish()),n.onDestroy(()=>this.destroy())}_queueEvent(n,e){Lo(this._queuedCallbacks,n,[]).push(e)}onDone(n){this.queued&&this._queueEvent("done",n),this._player.onDone(n)}onStart(n){this.queued&&this._queueEvent("start",n),this._player.onStart(n)}onDestroy(n){this.queued&&this._queueEvent("destroy",n),this._player.onDestroy(n)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(n){this.queued||this._player.setPosition(n)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(n){const e=this._player;e.triggerCallback&&e.triggerCallback(n)}}function qp(t){return t&&1===t.nodeType}function GE(t,n){const e=t.style.display;return t.style.display=n??"none",e}function qE(t,n,e,i,r){const o=[];e.forEach(h=>o.push(GE(h)));const s=[];i.forEach((h,b)=>{const ee=new Map;h.forEach(de=>{const ge=n.computeStyle(b,de,r);ee.set(de,ge),(!ge||0==ge.length)&&(b[ns]=dL,s.push(b))}),t.set(b,ee)});let a=0;return e.forEach(h=>GE(h,o[a++])),s}function WE(t,n){const e=new Map;if(t.forEach(a=>e.set(a,[])),0==n.length)return e;const r=new Set(n),o=new Map;function s(a){if(!a)return 1;let h=o.get(a);if(h)return h;const b=a.parentNode;return h=e.has(b)?b:r.has(b)?1:s(b),o.set(a,h),h}return n.forEach(a=>{const h=s(a);1!==h&&e.get(h).push(a)}),e}function is(t,n){t.classList?.add(n)}function Cu(t,n){t.classList?.remove(n)}function _L(t,n,e){sl(e).onDone(()=>t.processLeaveNode(n))}function KE(t,n){for(let e=0;e<t.length;e++){const i=t[e];i instanceof $E?KE(i.players,n):n.push(i)}}function YE(t,n,e){const i=e.get(t);if(!i)return!1;let r=n.get(t);return r?i.forEach(o=>r.add(o)):n.set(t,i),e.delete(t),!0}class Wp{constructor(n,e,i){this.bodyNode=n,this._driver=e,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,o)=>{},this._transitionEngine=new hL(n,e,i),this._timelineEngine=new oL(n,e,i),this._transitionEngine.onRemovalComplete=(r,o)=>this.onRemovalComplete(r,o)}registerTrigger(n,e,i,r,o){const s=n+"-"+r;let a=this._triggerCache[s];if(!a){const h=[],ee=m0(this._driver,o,h,[]);if(h.length)throw function i8(t,n){return new et(3404,!1)}();a=function tL(t,n,e){return new nL(t,n,e)}(r,ee,this._normalizer),this._triggerCache[s]=a}this._transitionEngine.registerTrigger(e,r,a)}register(n,e){this._transitionEngine.register(n,e)}destroy(n,e){this._transitionEngine.destroy(n,e)}onInsert(n,e,i,r){this._transitionEngine.insertNode(n,e,i,r)}onRemove(n,e,i,r){this._transitionEngine.removeNode(n,e,r||!1,i)}disableAnimations(n,e){this._transitionEngine.markElementAsDisabled(n,e)}process(n,e,i,r){if("@"==i.charAt(0)){const[o,s]=yE(i);this._timelineEngine.command(o,e,s,r)}else this._transitionEngine.trigger(n,e,i,r)}listen(n,e,i,r,o){if("@"==i.charAt(0)){const[s,a]=yE(i);return this._timelineEngine.listen(s,e,a,o)}return this._transitionEngine.listen(n,e,i,r,o)}flush(n=-1){this._transitionEngine.flush(n)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let yL=(()=>{class t{constructor(e,i,r){this._element=e,this._startStyles=i,this._endStyles=r,this._state=0;let o=t.initialStylesByElement.get(e);o||t.initialStylesByElement.set(e,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&Zs(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Zs(this._element,this._initialStyles),this._endStyles&&(Zs(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(oc(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(oc(this._element,this._endStyles),this._endStyles=null),Zs(this._element,this._initialStyles),this._state=3)}}return t.initialStylesByElement=new WeakMap,t})();function S0(t){let n=null;return t.forEach((e,i)=>{(function CL(t){return"display"===t||"position"===t})(i)&&(n=n||new Map,n.set(i,e))}),n}class ZE{constructor(n,e,i,r){this.element=n,this.keyframes=e,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const n=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,n,this.options),this._finalKeyframe=n.length?n[n.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(n){const e=[];return n.forEach(i=>{e.push(Object.fromEntries(i))}),e}_triggerWebAnimation(n,e,i){return n.animate(this._convertKeyframesToObject(e),i)}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(n=>n()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}setPosition(n){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=n*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const n=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&n.set(r,this._finished?i:OE(this.element,r))}),this.currentSnapshot=n}triggerCallback(n){const e="start"===n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class wL{validateStyleProperty(n){return!0}validateAnimatableStyleProperty(n){return!0}matchesElement(n,e){return!1}containsElement(n,e){return EE(n,e)}getParentElement(n){return c0(n)}query(n,e,i){return TE(n,e,i)}computeStyle(n,e,i){return window.getComputedStyle(n)[e]}animate(n,e,i,r,o,s=[]){const h={duration:i,delay:r,fill:0==r?"both":"forwards"};o&&(h.easing=o);const b=new Map,ee=s.filter(xe=>xe instanceof ZE);(function S8(t,n){return 0===t||0===n})(i,r)&&ee.forEach(xe=>{xe.currentSnapshot.forEach((ke,Pe)=>b.set(Pe,ke))});let de=function w8(t){return t.length?t[0]instanceof Map?t:t.map(n=>kE(n)):[]}(e).map(xe=>al(xe));de=function I8(t,n,e){if(e.size&&n.length){let i=n[0],r=[];if(e.forEach((o,s)=>{i.has(s)||r.push(s),i.set(s,o)}),r.length)for(let o=1;o<n.length;o++){let s=n[o];r.forEach(a=>s.set(a,OE(t,a)))}}return n}(n,de,b);const ge=function bL(t,n){let e=null,i=null;return Array.isArray(n)&&n.length?(e=S0(n[0]),n.length>1&&(i=S0(n[n.length-1]))):n instanceof Map&&(e=S0(n)),e||i?new yL(t,e,i):null}(n,de);return new ZE(n,de,h,ge)}}let xL=(()=>{class t extends gE{constructor(e,i){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(i.body,{id:"0",encapsulation:$s.None,styles:[],data:{animation:[]}})}build(e){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(e)?mE(e):e;return XE(this._renderer,null,i,"register",[r]),new EL(i,this._renderer)}}return t.\u0275fac=function(e){return new(e||t)(pn(Id),pn(No))},t.\u0275prov=$n({token:t,factory:t.\u0275fac}),t})();class EL extends class O6{}{constructor(n,e){super(),this._id=n,this._renderer=e}create(n,e){return new TL(this._id,n,e||{},this._renderer)}}class TL{constructor(n,e,i,r){this.id=n,this.element=e,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(n,e){return this._renderer.listen(this.element,`@@${this.id}:${n}`,e)}_command(n,...e){return XE(this._renderer,this.element,this.id,n,e)}onDone(n){this._listen("done",n)}onStart(n){this._listen("start",n)}onDestroy(n){this._listen("destroy",n)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(n){this._command("setPosition",n)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function XE(t,n,e,i,r){return t.setProperty(n,`@@${e}:${i}`,r)}const QE="@.disabled";let SL=(()=>{class t{constructor(e,i,r){this.delegate=e,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(o,s)=>{const a=s?.parentNode(o);a&&s.removeChild(a,o)}}createRenderer(e,i){const o=this.delegate.createRenderer(e,i);if(!(e&&i&&i.data&&i.data.animation)){let ee=this._rendererCache.get(o);return ee||(ee=new JE("",o,this.engine,()=>this._rendererCache.delete(o)),this._rendererCache.set(o,ee)),ee}const s=i.id,a=i.id+"-"+this._currentId;this._currentId++,this.engine.register(a,e);const h=ee=>{Array.isArray(ee)?ee.forEach(h):this.engine.registerTrigger(s,a,e,ee.name,ee)};return i.data.animation.forEach(h),new IL(this,a,o,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,i,r){e>=0&&e<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(o=>{const[s,a]=o;s(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return t.\u0275fac=function(e){return new(e||t)(pn(Id),pn(Wp),pn(Nn))},t.\u0275prov=$n({token:t,factory:t.\u0275fac}),t})();class JE{constructor(n,e,i,r){this.namespaceId=n,this.delegate=e,this.engine=i,this._onDestroy=r,this.destroyNode=this.delegate.destroyNode?o=>e.destroyNode(o):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(n,e){return this.delegate.createElement(n,e)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}appendChild(n,e){this.delegate.appendChild(n,e),this.engine.onInsert(this.namespaceId,e,n,!1)}insertBefore(n,e,i,r=!0){this.delegate.insertBefore(n,e,i),this.engine.onInsert(this.namespaceId,e,n,r)}removeChild(n,e,i){this.engine.onRemove(this.namespaceId,e,this.delegate,i)}selectRootElement(n,e){return this.delegate.selectRootElement(n,e)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,e,i,r){this.delegate.setAttribute(n,e,i,r)}removeAttribute(n,e,i){this.delegate.removeAttribute(n,e,i)}addClass(n,e){this.delegate.addClass(n,e)}removeClass(n,e){this.delegate.removeClass(n,e)}setStyle(n,e,i,r){this.delegate.setStyle(n,e,i,r)}removeStyle(n,e,i){this.delegate.removeStyle(n,e,i)}setProperty(n,e,i){"@"==e.charAt(0)&&e==QE?this.disableAnimations(n,!!i):this.delegate.setProperty(n,e,i)}setValue(n,e){this.delegate.setValue(n,e)}listen(n,e,i){return this.delegate.listen(n,e,i)}disableAnimations(n,e){this.engine.disableAnimations(n,e)}}class IL extends JE{constructor(n,e,i,r,o){super(e,i,r,o),this.factory=n,this.namespaceId=e}setProperty(n,e,i){"@"==e.charAt(0)?"."==e.charAt(1)&&e==QE?this.disableAnimations(n,i=void 0===i||!!i):this.engine.process(this.namespaceId,n,e.slice(1),i):this.delegate.setProperty(n,e,i)}listen(n,e,i){if("@"==e.charAt(0)){const r=function ML(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(n);let o=e.slice(1),s="";return"@"!=o.charAt(0)&&([o,s]=function kL(t){const n=t.indexOf(".");return[t.substring(0,n),t.slice(n+1)]}(o)),this.engine.listen(this.namespaceId,r,o,s,a=>{this.factory.scheduleListenerCallback(a._data||-1,i,a)})}return this.delegate.listen(n,e,i)}}let DL=(()=>{class t extends Wp{constructor(e,i,r,o){super(e.body,i,r)}ngOnDestroy(){this.flush()}}return t.\u0275fac=function(e){return new(e||t)(pn(No),pn(u0),pn(y0),pn(Gd))},t.\u0275prov=$n({token:t,factory:t.\u0275fac}),t})();const e3=[{provide:gE,useClass:xL},{provide:y0,useFactory:function AL(){return new X8}},{provide:Wp,useClass:DL},{provide:Id,useFactory:function PL(t,n,e){return new SL(t,n,e)},deps:[yp,Wp,Nn]}],I0=[{provide:u0,useFactory:()=>new wL},{provide:J2,useValue:"BrowserAnimations"},...e3],t3=[{provide:u0,useClass:SE},{provide:J2,useValue:"NoopAnimations"},...e3];let NL=(()=>{class t{static withConfig(e){return{ngModule:t,providers:e.disableAnimations?t3:I0}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zo({type:t}),t.\u0275inj=Eo({providers:I0,imports:[cx]}),t})(),ff=(()=>{class t{constructor(){this.count=0,this.animeState="active"}ngOnChanges(){this.animeState="inactive",queueMicrotask(()=>{this.animeState="active"})}animationShuffleDone(e){this.animeState="inactive"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=fn({type:t,selectors:[["badge"]],inputs:{count:"count"},features:[Cs],decls:2,vars:2,consts:[[1,"badge"]],template:function(e,i){1&e&&(Q(0,"div",0),ve(1),ne()),2&e&&(oe("@bounce",i.animeState),G(1),lt(i.count))},styles:[".badge[_ngcontent-%COMP%]{min-width:8px;min-height:8px;font-size:8px;padding:2px 4px;border-radius:100px;text-align:center;color:#eee;background-color:#cf5252}"],data:{animation:[Vn("bounce",[Ap("active",dt({transform:""})),tn("* => active",[Zt("600ms ease",bn([dt({transform:"scale3d(0.5, 0.5, 0.5)",offset:0}),dt({transform:"scale3d(2, 2, 2)",offset:.5}),dt({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),dt({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),dt({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])])]}}),t})();var M0,gn=_e(5861);(M0||(M0={})).resize=function n(e,i,r,o){let s=e.width,a=e.height,h=s/(i=Math.round(i)),b=a/(r=Math.round(r)),ee=Math.ceil(h/2),de=Math.ceil(b/2),ge=e.getContext("2d"),xe=ge.getImageData(0,0,s,a),ke=ge.createImageData(i,r),Pe=xe.data,Oe=ke.data;for(let je=0;je<r;je++)for(let qe=0;qe<i;qe++){let Ve=4*(qe+je*i),We=0,vt=0,nt=0,_t=0,Mt=0,ht=0,yt=0,Tt=(je+.5)*b,nn=Math.floor(je*b),rn=Math.ceil((je+1)*b);for(let En=nn;En<rn;En++){let Wn=Math.abs(Tt-(En+.5))/de,Rt=(qe+.5)*h,Ut=Wn*Wn,jt=Math.floor(qe*h),Yt=Math.ceil((qe+1)*h);for(let Fn=jt;Fn<Yt;Fn++){let Jn=Math.abs(Rt-(Fn+.5))/ee,oi=Math.sqrt(Ut+Jn*Jn);if(oi>=1)continue;We=2*oi*oi*oi-3*oi*oi+1;let Di=4*(Fn+En*s);yt+=We*Pe[Di+3],nt+=We,Pe[Di+3]<255&&(We=We*Pe[Di+3]/250),_t+=We*Pe[Di],Mt+=We*Pe[Di+1],ht+=We*Pe[Di+2],vt+=We}}Oe[Ve]=_t/vt,Oe[Ve+1]=Mt/vt,Oe[Ve+2]=ht/vt,Oe[Ve+3]=yt/nt}!0===o?(e.width=i,e.height=r):ge.clearRect(0,0,s,a),ge.putImageData(ke,0,0)};var Ps,OL=_e(7412),n3=_e(1817);!function(t){function r(){return(r=(0,gn.Z)(function*(h){return h instanceof Blob?o(h):a(h)})).apply(this,arguments)}function o(h){return s.apply(this,arguments)}function s(){return(s=(0,gn.Z)(function*(h){return a(yield t.readAsArrayBufferAsync(h))})).apply(this,arguments)}function a(h){let b=OL.create(h);return n3(b).toString()}t.readAsArrayBufferAsync=function n(h){return new Promise((b,ee)=>{let de=new FileReader;de.onload=ge=>{b(de.result)},de.onabort=de.onerror=ge=>{ee(ge)},de.readAsArrayBuffer(h)})},t.readAsTextAsync=function e(h){return new Promise((b,ee)=>{let de=new FileReader;de.onload=ge=>{b(de.result)},de.onabort=de.onerror=ge=>{ee(ge)},de.readAsText(h)})},t.calcSHA256Async=function i(h){return r.apply(this,arguments)}}(Ps||(Ps={}));var Gi=(()=>(function(t){t[t.NULL=0]="NULL",t[t.THUMBNAIL=1]="THUMBNAIL",t[t.COMPLETE=2]="COMPLETE",t[t.URL=1e3]="URL"}(Gi||(Gi={})),Gi))();class on{constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:"",thumbnail:{blob:null,type:"",url:""}}}get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob?this.context.blob:this.context.thumbnail.blob}get url(){return this.context.url?this.context.url:this.context.thumbnail.url}get thumbnail(){return this.context.thumbnail}get state(){return this.url||this.blob?this.url&&!this.blob?Gi.URL:this.blob===this.thumbnail.blob?Gi.THUMBNAIL:Gi.COMPLETE:Gi.NULL}get isEmpty(){return this.state<=Gi.NULL}static createEmpty(n){let e=new on;return e.context.identifier=n,e}static create(n){if("string"==typeof n){let e=new on;return e.context.identifier=n,e.context.name=n,e.context.url=n,e}{let e=new on;return e.apply(n),e}}static createAsync(n){return(0,gn.Z)(function*(){return n instanceof File?yield on._createAsync(n,n.name):n instanceof Blob?yield on._createAsync(n):void 0})()}static _createAsync(n,e){return(0,gn.Z)(function*(){let i=yield Ps.readAsArrayBufferAsync(n),r=new on;r.context.identifier=yield Ps.calcSHA256Async(i),r.context.name=e,r.context.blob=new Blob([i],{type:n.type}),r.context.url=window.URL.createObjectURL(r.context.blob);try{r.context.thumbnail=yield on.createThumbnailAsync(r.context)}catch(o){throw o}return null!=r.context.name&&(r.context.name=r.context.identifier),r})()}destroy(){this.revokeURLs()}apply(n){!this.context.identifier&&n.identifier&&(this.context.identifier=n.identifier),!this.context.name&&n.name&&(this.context.name=n.name),!this.context.blob&&n.blob&&(this.context.blob=n.blob),!this.context.type&&n.type&&(this.context.type=n.type),!this.context.url&&n.url&&(this.state!==Gi.URL&&window.URL.revokeObjectURL(this.context.url),this.context.url=n.url),!this.context.thumbnail.blob&&n.thumbnail.blob&&(this.context.thumbnail.blob=n.thumbnail.blob),!this.context.thumbnail.type&&n.thumbnail.type&&(this.context.thumbnail.type=n.thumbnail.type),!this.context.thumbnail.url&&n.thumbnail.url&&(this.state!==Gi.URL&&window.URL.revokeObjectURL(this.context.thumbnail.url),this.context.thumbnail.url=n.thumbnail.url),this.createURLs()}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url,thumbnail:{blob:this.context.thumbnail.blob,type:this.context.thumbnail.type,url:this.context.thumbnail.url}}}createURLs(){this.state!==Gi.URL&&(this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob)),this.context.thumbnail.blob&&""===this.context.thumbnail.url&&(this.context.thumbnail.url=window.URL.createObjectURL(this.context.thumbnail.blob)))}revokeURLs(){this.state!==Gi.URL&&(window.URL.revokeObjectURL(this.context.url),window.URL.revokeObjectURL(this.context.thumbnail.url))}static createThumbnailAsync(n){return new Promise((e,i)=>{let r=new Image;r.onload=o=>{let s=Math.min(128/Math.max(r.width,r.height),1),a=r.width*s,h=r.height*s,b=document.createElement("canvas"),ee=b.getContext("2d");b.width=r.width,b.height=r.height,ee.drawImage(r,0,0),M0.resize(b,a,h,!0),b.toBlob(de=>{let ge={type:de.type,blob:de,url:window.URL.createObjectURL(de)};e(ge)},n.blob.type)},r.onabort=r.onerror=()=>{i()},r.src=n.url})}}on.Empty=on.createEmpty("null");let wu=0;const hf=new Map,Yp=new MessageChannel;function jr(t){if(4294967296===wu&&(wu=0),++wu in hf)throw new Error("setZeroTimeout queue overflow.");return hf.set(wu,t),Yp.port2.postMessage(wu),wu}Yp.port1.onmessage=function(t){const n=hf.get(t.data);hf.delete(t.data),n&&n()},Yp.port1.start(),Yp.port2.start();class i3{}var r3=_e(8497),ll=(()=>(function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LOW=1]="LOW",t[t.MIDDLE=2]="MIDDLE",t[t.HIGH=3]="HIGH"}(ll||(ll={})),ll))();const LL=function RL(t){if(t.length>=255)throw new TypeError("Alphabet too long");const n=new Uint8Array(256);for(let b=0;b<n.length;b++)n[b]=255;for(let b=0;b<t.length;b++){const ee=t.charAt(b),de=ee.charCodeAt(0);if(255!==n[de])throw new TypeError(ee+" is ambiguous");n[de]=b}const e=t.length,i=t.charAt(0),r=Math.log(e)/Math.log(256),o=Math.log(256)/Math.log(e);function a(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;let ee=0;if(" "===b[ee])return;let de=0,ge=0;for(;b[ee]===i;)de++,ee++;const xe=(b.length-ee)*r+1>>>0,ke=new Uint8Array(xe);for(;b[ee];){let qe=n[b.charCodeAt(ee)];if(255===qe)return;let Ve=0;for(let We=xe-1;(0!==qe||Ve<ge)&&-1!==We;We--,Ve++)qe+=e*ke[We]>>>0,ke[We]=qe%256>>>0,qe=qe/256>>>0;if(0!==qe)throw new Error("Non-zero carry");ge=Ve,ee++}if(" "===b[ee])return;let Pe=xe-ge;for(;Pe!==xe&&0===ke[Pe];)Pe++;const Oe=new Uint8Array(de+(xe-Pe));let je=de;for(;Pe!==xe;)Oe[je++]=ke[Pe++];return Oe}return{encode:function s(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";let ee=0,de=0,ge=0;const xe=b.length;for(;ge!==xe&&0===b[ge];)ge++,ee++;const ke=(xe-ge)*o+1>>>0,Pe=new Uint8Array(ke);for(;ge!==xe;){let qe=b[ge],Ve=0;for(let We=ke-1;(0!==qe||Ve<de)&&-1!==We;We--,Ve++)qe+=256*Pe[We]>>>0,Pe[We]=qe%e>>>0,qe=qe/e>>>0;if(0!==qe)throw new Error("Non-zero carry");de=Ve,ge++}let Oe=ke-de;for(;Oe!==ke&&0===Pe[Oe];)Oe++;let je=i.repeat(ee);for(;Oe<ke;++Oe)je+=t.charAt(Pe[Oe]);return je},decodeUnsafe:a,decode:function h(b){const ee=a(b);if(ee)return ee;throw new Error("Non-base"+e+" character")}}}("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),BL=/^(\w{6})(\w{3})(\w*)-(\w*)/i;class ki{constructor(n){this.peerId="",this.userId="",this.roomId="",this.roomName="",this.password="",this.digestUserId="",this.digestPassword="",this.isOpen=!1,this.session={grade:ll.UNSPECIFIED,ping:0,health:0,speed:0,description:""},this.parse(n)}get isRoom(){return 0<this.roomId.length}get hasPassword(){return 0<this.password.length+this.digestPassword.length}parse(n){try{this.peerId=n;let e=BL.exec(n);if(null!=e)return this.digestUserId=e[1],this.roomId=e[2],this.roomName=r3.L(e[3]),void(this.digestPassword=e[4])}catch(e){console.warn(e)}this.digestUserId=n}verifyPassword(n){return o3(this.roomId,n)===this.digestPassword}static parse(n){return new ki(n)}static create(...n){return n.length<=1?ki._create.apply(this,n):ki._createRoom.apply(this,n)}static _create(n=""){let e=function zL(t){return null==t?"":s3(t)}(n),i=new ki(e);return i.userId=n,i}static _createRoom(n="",e="",i="",r=""){let o=this.generateId("******"),s=o3(e,r),a=`${o}${e}${r3.n(i)}-${s}`,h=new ki(a);return h.userId=n,h.password=r,h}static generateId(n="********"){const e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";let i=n;return i=n.replace(/\*/g,r=>e[Math.floor(Math.random()*e.length)]),i}}function o3(t,n){return null==t||null==n?"":0<n.length?s3(t+n,7):""}function s3(t,n=-1){if(null==t)return"";let e=n3(t),i=new Uint8Array(Uint32Array.from(e.words).buffer),r=LL.encode(i);return n<0&&(n=r.length),r.length<n&&(n=r.length),r=r.slice(0,n),r}function xu(t){let n=t.length;for(;--n>=0;)t[n]=0}const N0=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Zp=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),KL=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),p3=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Aa=new Array(576);xu(Aa);const mf=new Array(60);xu(mf);const _f=new Array(512);xu(_f);const $f=new Array(256);xu($f);const O0=new Array(29);xu(O0);const Xp=new Array(30);function F0(t,n,e,i,r){this.static_tree=t,this.extra_bits=n,this.extra_base=e,this.elems=i,this.max_length=r,this.has_stree=t&&t.length}let g3,m3,_3;function R0(t,n){this.dyn_tree=t,this.max_code=0,this.stat_desc=n}xu(Xp);const $3=t=>t<256?_f[t]:_f[256+(t>>>7)],vf=(t,n)=>{t.pending_buf[t.pending++]=255&n,t.pending_buf[t.pending++]=n>>>8&255},vo=(t,n,e)=>{t.bi_valid>16-e?(t.bi_buf|=n<<t.bi_valid&65535,vf(t,t.bi_buf),t.bi_buf=n>>16-t.bi_valid,t.bi_valid+=e-16):(t.bi_buf|=n<<t.bi_valid&65535,t.bi_valid+=e)},Xs=(t,n,e)=>{vo(t,e[2*n],e[2*n+1])},v3=(t,n)=>{let e=0;do{e|=1&t,t>>>=1,e<<=1}while(--n>0);return e>>>1},b3=(t,n,e)=>{const i=new Array(16);let o,s,r=0;for(o=1;o<=15;o++)r=r+e[o-1]<<1,i[o]=r;for(s=0;s<=n;s++){let a=t[2*s+1];0!==a&&(t[2*s]=v3(i[a]++,a))}},y3=t=>{let n;for(n=0;n<286;n++)t.dyn_ltree[2*n]=0;for(n=0;n<30;n++)t.dyn_dtree[2*n]=0;for(n=0;n<19;n++)t.bl_tree[2*n]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},C3=t=>{t.bi_valid>8?vf(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},w3=(t,n,e,i)=>{const r=2*n,o=2*e;return t[r]<t[o]||t[r]===t[o]&&i[n]<=i[e]},L0=(t,n,e)=>{const i=t.heap[e];let r=e<<1;for(;r<=t.heap_len&&(r<t.heap_len&&w3(n,t.heap[r+1],t.heap[r],t.depth)&&r++,!w3(n,i,t.heap[r],t.depth));)t.heap[e]=t.heap[r],e=r,r<<=1;t.heap[e]=i},x3=(t,n,e)=>{let i,r,s,a,o=0;if(0!==t.sym_next)do{i=255&t.pending_buf[t.sym_buf+o++],i+=(255&t.pending_buf[t.sym_buf+o++])<<8,r=t.pending_buf[t.sym_buf+o++],0===i?Xs(t,r,n):(s=$f[r],Xs(t,s+256+1,n),a=N0[s],0!==a&&(r-=O0[s],vo(t,r,a)),i--,s=$3(i),Xs(t,s,e),a=Zp[s],0!==a&&(i-=Xp[s],vo(t,i,a)))}while(o<t.sym_next);Xs(t,256,n)},B0=(t,n)=>{const e=n.dyn_tree,i=n.stat_desc.static_tree,r=n.stat_desc.has_stree,o=n.stat_desc.elems;let s,a,b,h=-1;for(t.heap_len=0,t.heap_max=573,s=0;s<o;s++)0!==e[2*s]?(t.heap[++t.heap_len]=h=s,t.depth[s]=0):e[2*s+1]=0;for(;t.heap_len<2;)b=t.heap[++t.heap_len]=h<2?++h:0,e[2*b]=1,t.depth[b]=0,t.opt_len--,r&&(t.static_len-=i[2*b+1]);for(n.max_code=h,s=t.heap_len>>1;s>=1;s--)L0(t,e,s);b=o;do{s=t.heap[1],t.heap[1]=t.heap[t.heap_len--],L0(t,e,1),a=t.heap[1],t.heap[--t.heap_max]=s,t.heap[--t.heap_max]=a,e[2*b]=e[2*s]+e[2*a],t.depth[b]=(t.depth[s]>=t.depth[a]?t.depth[s]:t.depth[a])+1,e[2*s+1]=e[2*a+1]=b,t.heap[1]=b++,L0(t,e,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,n)=>{const e=n.dyn_tree,i=n.max_code,r=n.stat_desc.static_tree,o=n.stat_desc.has_stree,s=n.stat_desc.extra_bits,a=n.stat_desc.extra_base,h=n.stat_desc.max_length;let b,ee,de,ge,xe,ke,Pe=0;for(ge=0;ge<=15;ge++)t.bl_count[ge]=0;for(e[2*t.heap[t.heap_max]+1]=0,b=t.heap_max+1;b<573;b++)ee=t.heap[b],ge=e[2*e[2*ee+1]+1]+1,ge>h&&(ge=h,Pe++),e[2*ee+1]=ge,!(ee>i)&&(t.bl_count[ge]++,xe=0,ee>=a&&(xe=s[ee-a]),ke=e[2*ee],t.opt_len+=ke*(ge+xe),o&&(t.static_len+=ke*(r[2*ee+1]+xe)));if(0!==Pe){do{for(ge=h-1;0===t.bl_count[ge];)ge--;t.bl_count[ge]--,t.bl_count[ge+1]+=2,t.bl_count[h]--,Pe-=2}while(Pe>0);for(ge=h;0!==ge;ge--)for(ee=t.bl_count[ge];0!==ee;)de=t.heap[--b],!(de>i)&&(e[2*de+1]!==ge&&(t.opt_len+=(ge-e[2*de+1])*e[2*de],e[2*de+1]=ge),ee--)}})(t,n),b3(e,h,t.bl_count)},E3=(t,n,e)=>{let i,o,r=-1,s=n[1],a=0,h=7,b=4;for(0===s&&(h=138,b=3),n[2*(e+1)+1]=65535,i=0;i<=e;i++)o=s,s=n[2*(i+1)+1],!(++a<h&&o===s)&&(a<b?t.bl_tree[2*o]+=a:0!==o?(o!==r&&t.bl_tree[2*o]++,t.bl_tree[32]++):a<=10?t.bl_tree[34]++:t.bl_tree[36]++,a=0,r=o,0===s?(h=138,b=3):o===s?(h=6,b=3):(h=7,b=4))},T3=(t,n,e)=>{let i,o,r=-1,s=n[1],a=0,h=7,b=4;for(0===s&&(h=138,b=3),i=0;i<=e;i++)if(o=s,s=n[2*(i+1)+1],!(++a<h&&o===s)){if(a<b)do{Xs(t,o,t.bl_tree)}while(0!=--a);else 0!==o?(o!==r&&(Xs(t,o,t.bl_tree),a--),Xs(t,16,t.bl_tree),vo(t,a-3,2)):a<=10?(Xs(t,17,t.bl_tree),vo(t,a-3,3)):(Xs(t,18,t.bl_tree),vo(t,a-11,7));a=0,r=o,0===s?(h=138,b=3):o===s?(h=6,b=3):(h=7,b=4)}};let S3=!1;const I3=(t,n,e,i)=>{vo(t,0+(i?1:0),3),C3(t),vf(t,e),vf(t,~e),e&&t.pending_buf.set(t.window.subarray(n,n+e),t.pending),t.pending+=e};var dB={_tr_init:t=>{S3||((()=>{let t,n,e,i,r;const o=new Array(16);for(e=0,i=0;i<28;i++)for(O0[i]=e,t=0;t<1<<N0[i];t++)$f[e++]=i;for($f[e-1]=i,r=0,i=0;i<16;i++)for(Xp[i]=r,t=0;t<1<<Zp[i];t++)_f[r++]=i;for(r>>=7;i<30;i++)for(Xp[i]=r<<7,t=0;t<1<<Zp[i]-7;t++)_f[256+r++]=i;for(n=0;n<=15;n++)o[n]=0;for(t=0;t<=143;)Aa[2*t+1]=8,t++,o[8]++;for(;t<=255;)Aa[2*t+1]=9,t++,o[9]++;for(;t<=279;)Aa[2*t+1]=7,t++,o[7]++;for(;t<=287;)Aa[2*t+1]=8,t++,o[8]++;for(b3(Aa,287,o),t=0;t<30;t++)mf[2*t+1]=5,mf[2*t]=v3(t,5);g3=new F0(Aa,N0,257,286,15),m3=new F0(mf,Zp,0,30,15),_3=new F0(new Array(0),KL,0,19,7)})(),S3=!0),t.l_desc=new R0(t.dyn_ltree,g3),t.d_desc=new R0(t.dyn_dtree,m3),t.bl_desc=new R0(t.bl_tree,_3),t.bi_buf=0,t.bi_valid=0,y3(t)},_tr_stored_block:I3,_tr_flush_block:(t,n,e,i)=>{let r,o,s=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),B0(t,t.l_desc),B0(t,t.d_desc),s=(t=>{let n;for(E3(t,t.dyn_ltree,t.l_desc.max_code),E3(t,t.dyn_dtree,t.d_desc.max_code),B0(t,t.bl_desc),n=18;n>=3&&0===t.bl_tree[2*p3[n]+1];n--);return t.opt_len+=3*(n+1)+5+5+4,n})(t),r=t.opt_len+3+7>>>3,o=t.static_len+3+7>>>3,o<=r&&(r=o)):r=o=e+5,e+4<=r&&-1!==n?I3(t,n,e,i):4===t.strategy||o===r?(vo(t,2+(i?1:0),3),x3(t,Aa,mf)):(vo(t,4+(i?1:0),3),((t,n,e,i)=>{let r;for(vo(t,n-257,5),vo(t,e-1,5),vo(t,i-4,4),r=0;r<i;r++)vo(t,t.bl_tree[2*p3[r]+1],3);T3(t,t.dyn_ltree,n-1),T3(t,t.dyn_dtree,e-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,s+1),x3(t,t.dyn_ltree,t.dyn_dtree)),y3(t),i&&C3(t)},_tr_tally:(t,n,e)=>(t.pending_buf[t.sym_buf+t.sym_next++]=n,t.pending_buf[t.sym_buf+t.sym_next++]=n>>8,t.pending_buf[t.sym_buf+t.sym_next++]=e,0===n?t.dyn_ltree[2*e]++:(t.matches++,n--,t.dyn_ltree[2*($f[e]+256+1)]++,t.dyn_dtree[2*$3(n)]++),t.sym_next===t.sym_end),_tr_align:t=>{vo(t,2,3),Xs(t,256,Aa),(t=>{16===t.bi_valid?(vf(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}},bf=(t,n,e,i)=>{let r=65535&t|0,o=t>>>16&65535|0,s=0;for(;0!==e;){s=e>2e3?2e3:e,e-=s;do{r=r+n[i++]|0,o=o+r|0}while(--s);r%=65521,o%=65521}return r|o<<16|0};const hB=new Uint32Array((()=>{let t,n=[];for(var e=0;e<256;e++){t=e;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;n[e]=t}return n})());var wr=(t,n,e,i)=>{const r=hB,o=i+e;t^=-1;for(let s=i;s<o;s++)t=t>>>8^r[255&(t^n[s])];return-1^t},lc={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},cc={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:pB,_tr_stored_block:z0,_tr_flush_block:gB,_tr_tally:cl,_tr_align:mB}=dB,{Z_NO_FLUSH:ul,Z_PARTIAL_FLUSH:_B,Z_FULL_FLUSH:$B,Z_FINISH:rs,Z_BLOCK:M3,Z_OK:Ir,Z_STREAM_END:k3,Z_STREAM_ERROR:Qs,Z_DATA_ERROR:vB,Z_BUF_ERROR:j0,Z_DEFAULT_COMPRESSION:bB,Z_FILTERED:yB,Z_HUFFMAN_ONLY:Qp,Z_RLE:CB,Z_FIXED:wB,Z_DEFAULT_STRATEGY:xB,Z_UNKNOWN:EB,Z_DEFLATED:Jp}=cc,Js=262,fc=(t,n)=>(t.msg=lc[n],n),D3=t=>2*t-(t>4?9:0),fl=t=>{let n=t.length;for(;--n>=0;)t[n]=0},FB=t=>{let n,e,i,r=t.w_size;n=t.hash_size,i=n;do{e=t.head[--i],t.head[i]=e>=r?e-r:0}while(--n);n=r,i=n;do{e=t.prev[--i],t.prev[i]=e>=r?e-r:0}while(--n)};let hl=(t,n,e)=>(n<<t.hash_shift^e)&t.hash_mask;const zo=t=>{const n=t.state;let e=n.pending;e>t.avail_out&&(e=t.avail_out),0!==e&&(t.output.set(n.pending_buf.subarray(n.pending_out,n.pending_out+e),t.next_out),t.next_out+=e,n.pending_out+=e,t.total_out+=e,t.avail_out-=e,n.pending-=e,0===n.pending&&(n.pending_out=0))},jo=(t,n)=>{gB(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,n),t.block_start=t.strstart,zo(t.strm)},ci=(t,n)=>{t.pending_buf[t.pending++]=n},Cf=(t,n)=>{t.pending_buf[t.pending++]=n>>>8&255,t.pending_buf[t.pending++]=255&n},K0=(t,n,e,i)=>{let r=t.avail_in;return r>i&&(r=i),0===r?0:(t.avail_in-=r,n.set(t.input.subarray(t.next_in,t.next_in+r),e),1===t.state.wrap?t.adler=bf(t.adler,n,r,e):2===t.state.wrap&&(t.adler=wr(t.adler,n,r,e)),t.next_in+=r,t.total_in+=r,r)},A3=(t,n)=>{let r,o,e=t.max_chain_length,i=t.strstart,s=t.prev_length,a=t.nice_match;const h=t.strstart>t.w_size-Js?t.strstart-(t.w_size-Js):0,b=t.window,ee=t.w_mask,de=t.prev,ge=t.strstart+258;let xe=b[i+s-1],ke=b[i+s];t.prev_length>=t.good_match&&(e>>=2),a>t.lookahead&&(a=t.lookahead);do{if(r=n,b[r+s]===ke&&b[r+s-1]===xe&&b[r]===b[i]&&b[++r]===b[i+1]){i+=2,r++;do{}while(b[++i]===b[++r]&&b[++i]===b[++r]&&b[++i]===b[++r]&&b[++i]===b[++r]&&b[++i]===b[++r]&&b[++i]===b[++r]&&b[++i]===b[++r]&&b[++i]===b[++r]&&i<ge);if(o=258-(ge-i),i=ge-258,o>s){if(t.match_start=n,s=o,o>=a)break;xe=b[i+s-1],ke=b[i+s]}}}while((n=de[n&ee])>h&&0!=--e);return s<=t.lookahead?s:t.lookahead},Mu=t=>{const n=t.w_size;let e,i,r;do{if(i=t.window_size-t.lookahead-t.strstart,t.strstart>=n+(n-Js)&&(t.window.set(t.window.subarray(n,n+n-i),0),t.match_start-=n,t.strstart-=n,t.block_start-=n,t.insert>t.strstart&&(t.insert=t.strstart),FB(t),i+=n),0===t.strm.avail_in)break;if(e=K0(t.strm,t.window,t.strstart+t.lookahead,i),t.lookahead+=e,t.lookahead+t.insert>=3)for(r=t.strstart-t.insert,t.ins_h=t.window[r],t.ins_h=hl(t,t.ins_h,t.window[r+1]);t.insert&&(t.ins_h=hl(t,t.ins_h,t.window[r+3-1]),t.prev[r&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=r,r++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<Js&&0!==t.strm.avail_in)},P3=(t,n)=>{let i,r,o,e=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,s=0,a=t.strm.avail_in;do{if(i=65535,o=t.bi_valid+42>>3,t.strm.avail_out<o||(o=t.strm.avail_out-o,r=t.strstart-t.block_start,i>r+t.strm.avail_in&&(i=r+t.strm.avail_in),i>o&&(i=o),i<e&&(0===i&&n!==rs||n===ul||i!==r+t.strm.avail_in)))break;s=n===rs&&i===r+t.strm.avail_in?1:0,z0(t,0,0,s),t.pending_buf[t.pending-4]=i,t.pending_buf[t.pending-3]=i>>8,t.pending_buf[t.pending-2]=~i,t.pending_buf[t.pending-1]=~i>>8,zo(t.strm),r&&(r>i&&(r=i),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+r),t.strm.next_out),t.strm.next_out+=r,t.strm.avail_out-=r,t.strm.total_out+=r,t.block_start+=r,i-=r),i&&(K0(t.strm,t.strm.output,t.strm.next_out,i),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i)}while(0===s);return a-=t.strm.avail_in,a&&(a>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=a&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-a,t.strm.next_in),t.strstart),t.strstart+=a,t.insert+=a>t.w_size-t.insert?t.w_size-t.insert:a),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),s?4:n!==ul&&n!==rs&&0===t.strm.avail_in&&t.strstart===t.block_start?2:(o=t.window_size-t.strstart,t.strm.avail_in>o&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,o+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),o>t.strm.avail_in&&(o=t.strm.avail_in),o&&(K0(t.strm,t.window,t.strstart,o),t.strstart+=o,t.insert+=o>t.w_size-t.insert?t.w_size-t.insert:o),t.high_water<t.strstart&&(t.high_water=t.strstart),o=t.bi_valid+42>>3,o=t.pending_buf_size-o>65535?65535:t.pending_buf_size-o,e=o>t.w_size?t.w_size:o,r=t.strstart-t.block_start,(r>=e||(r||n===rs)&&n!==ul&&0===t.strm.avail_in&&r<=o)&&(i=r>o?o:r,s=n===rs&&0===t.strm.avail_in&&i===r?1:0,z0(t,t.block_start,i,s),t.block_start+=i,zo(t.strm)),s?3:1)},Y0=(t,n)=>{let e,i;for(;;){if(t.lookahead<Js){if(Mu(t),t.lookahead<Js&&n===ul)return 1;if(0===t.lookahead)break}if(e=0,t.lookahead>=3&&(t.ins_h=hl(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==e&&t.strstart-e<=t.w_size-Js&&(t.match_length=A3(t,e)),t.match_length>=3)if(i=cl(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=hl(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=hl(t,t.ins_h,t.window[t.strstart+1]);else i=cl(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(jo(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,n===rs?(jo(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(jo(t,!1),0===t.strm.avail_out)?1:2},ku=(t,n)=>{let e,i,r;for(;;){if(t.lookahead<Js){if(Mu(t),t.lookahead<Js&&n===ul)return 1;if(0===t.lookahead)break}if(e=0,t.lookahead>=3&&(t.ins_h=hl(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==e&&t.prev_length<t.max_lazy_match&&t.strstart-e<=t.w_size-Js&&(t.match_length=A3(t,e),t.match_length<=5&&(t.strategy===yB||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-3,i=cl(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=hl(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,i&&(jo(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(i=cl(t,0,t.window[t.strstart-1]),i&&jo(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=cl(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,n===rs?(jo(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(jo(t,!1),0===t.strm.avail_out)?1:2};function ea(t,n,e,i,r){this.good_length=t,this.max_lazy=n,this.nice_length=e,this.max_chain=i,this.func=r}const wf=[new ea(0,0,0,0,P3),new ea(4,4,8,4,Y0),new ea(4,5,16,8,Y0),new ea(4,6,32,32,Y0),new ea(4,4,16,16,ku),new ea(8,16,32,32,ku),new ea(8,16,128,128,ku),new ea(8,32,128,256,ku),new ea(32,128,258,1024,ku),new ea(32,258,258,4096,ku)];function zB(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Jp,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),fl(this.dyn_ltree),fl(this.dyn_dtree),fl(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),fl(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),fl(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const xf=t=>{if(!t)return 1;const n=t.state;return!n||n.strm!==t||42!==n.status&&57!==n.status&&69!==n.status&&73!==n.status&&91!==n.status&&103!==n.status&&113!==n.status&&666!==n.status?1:0},N3=t=>{if(xf(t))return fc(t,Qs);t.total_in=t.total_out=0,t.data_type=EB;const n=t.state;return n.pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=2===n.wrap?57:n.wrap?42:113,t.adler=2===n.wrap?0:1,n.last_flush=-2,pB(n),Ir},O3=t=>{const n=N3(t);return n===Ir&&(t=>{t.window_size=2*t.w_size,fl(t.head),t.max_lazy_match=wf[t.level].max_lazy,t.good_match=wf[t.level].good_length,t.nice_match=wf[t.level].nice_length,t.max_chain_length=wf[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0})(t.state),n},F3=(t,n,e,i,r,o)=>{if(!t)return Qs;let s=1;if(n===bB&&(n=6),i<0?(s=0,i=-i):i>15&&(s=2,i-=16),r<1||r>9||e!==Jp||i<8||i>15||n<0||n>9||o<0||o>wB||8===i&&1!==s)return fc(t,Qs);8===i&&(i=9);const a=new zB;return t.state=a,a.strm=t,a.status=42,a.wrap=s,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=r+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<r+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=n,a.strategy=o,a.method=e,O3(t)};var Ef_deflateInit2=F3,Ef_deflateSetHeader=(t,n)=>xf(t)||2!==t.state.wrap?Qs:(t.state.gzhead=n,Ir),Ef_deflate=(t,n)=>{if(xf(t)||n>M3||n<0)return t?fc(t,Qs):Qs;const e=t.state;if(!t.output||0!==t.avail_in&&!t.input||666===e.status&&n!==rs)return fc(t,0===t.avail_out?j0:Qs);const i=e.last_flush;if(e.last_flush=n,0!==e.pending){if(zo(t),0===t.avail_out)return e.last_flush=-1,Ir}else if(0===t.avail_in&&D3(n)<=D3(i)&&n!==rs)return fc(t,j0);if(666===e.status&&0!==t.avail_in)return fc(t,j0);if(42===e.status&&0===e.wrap&&(e.status=113),42===e.status){let r=Jp+(e.w_bits-8<<4)<<8,o=-1;if(o=e.strategy>=Qp||e.level<2?0:e.level<6?1:6===e.level?2:3,r|=o<<6,0!==e.strstart&&(r|=32),r+=31-r%31,Cf(e,r),0!==e.strstart&&(Cf(e,t.adler>>>16),Cf(e,65535&t.adler)),t.adler=1,e.status=113,zo(t),0!==e.pending)return e.last_flush=-1,Ir}if(57===e.status)if(t.adler=0,ci(e,31),ci(e,139),ci(e,8),e.gzhead)ci(e,(e.gzhead.text?1:0)+(e.gzhead.hcrc?2:0)+(e.gzhead.extra?4:0)+(e.gzhead.name?8:0)+(e.gzhead.comment?16:0)),ci(e,255&e.gzhead.time),ci(e,e.gzhead.time>>8&255),ci(e,e.gzhead.time>>16&255),ci(e,e.gzhead.time>>24&255),ci(e,9===e.level?2:e.strategy>=Qp||e.level<2?4:0),ci(e,255&e.gzhead.os),e.gzhead.extra&&e.gzhead.extra.length&&(ci(e,255&e.gzhead.extra.length),ci(e,e.gzhead.extra.length>>8&255)),e.gzhead.hcrc&&(t.adler=wr(t.adler,e.pending_buf,e.pending,0)),e.gzindex=0,e.status=69;else if(ci(e,0),ci(e,0),ci(e,0),ci(e,0),ci(e,0),ci(e,9===e.level?2:e.strategy>=Qp||e.level<2?4:0),ci(e,3),e.status=113,zo(t),0!==e.pending)return e.last_flush=-1,Ir;if(69===e.status){if(e.gzhead.extra){let r=e.pending,o=(65535&e.gzhead.extra.length)-e.gzindex;for(;e.pending+o>e.pending_buf_size;){let a=e.pending_buf_size-e.pending;if(e.pending_buf.set(e.gzhead.extra.subarray(e.gzindex,e.gzindex+a),e.pending),e.pending=e.pending_buf_size,e.gzhead.hcrc&&e.pending>r&&(t.adler=wr(t.adler,e.pending_buf,e.pending-r,r)),e.gzindex+=a,zo(t),0!==e.pending)return e.last_flush=-1,Ir;r=0,o-=a}let s=new Uint8Array(e.gzhead.extra);e.pending_buf.set(s.subarray(e.gzindex,e.gzindex+o),e.pending),e.pending+=o,e.gzhead.hcrc&&e.pending>r&&(t.adler=wr(t.adler,e.pending_buf,e.pending-r,r)),e.gzindex=0}e.status=73}if(73===e.status){if(e.gzhead.name){let o,r=e.pending;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>r&&(t.adler=wr(t.adler,e.pending_buf,e.pending-r,r)),zo(t),0!==e.pending)return e.last_flush=-1,Ir;r=0}o=e.gzindex<e.gzhead.name.length?255&e.gzhead.name.charCodeAt(e.gzindex++):0,ci(e,o)}while(0!==o);e.gzhead.hcrc&&e.pending>r&&(t.adler=wr(t.adler,e.pending_buf,e.pending-r,r)),e.gzindex=0}e.status=91}if(91===e.status){if(e.gzhead.comment){let o,r=e.pending;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>r&&(t.adler=wr(t.adler,e.pending_buf,e.pending-r,r)),zo(t),0!==e.pending)return e.last_flush=-1,Ir;r=0}o=e.gzindex<e.gzhead.comment.length?255&e.gzhead.comment.charCodeAt(e.gzindex++):0,ci(e,o)}while(0!==o);e.gzhead.hcrc&&e.pending>r&&(t.adler=wr(t.adler,e.pending_buf,e.pending-r,r))}e.status=103}if(103===e.status){if(e.gzhead.hcrc){if(e.pending+2>e.pending_buf_size&&(zo(t),0!==e.pending))return e.last_flush=-1,Ir;ci(e,255&t.adler),ci(e,t.adler>>8&255),t.adler=0}if(e.status=113,zo(t),0!==e.pending)return e.last_flush=-1,Ir}if(0!==t.avail_in||0!==e.lookahead||n!==ul&&666!==e.status){let r=0===e.level?P3(e,n):e.strategy===Qp?((t,n)=>{let e;for(;;){if(0===t.lookahead&&(Mu(t),0===t.lookahead)){if(n===ul)return 1;break}if(t.match_length=0,e=cl(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,e&&(jo(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,n===rs?(jo(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(jo(t,!1),0===t.strm.avail_out)?1:2})(e,n):e.strategy===CB?((t,n)=>{let e,i,r,o;const s=t.window;for(;;){if(t.lookahead<=258){if(Mu(t),t.lookahead<=258&&n===ul)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(r=t.strstart-1,i=s[r],i===s[++r]&&i===s[++r]&&i===s[++r])){o=t.strstart+258;do{}while(i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&r<o);t.match_length=258-(o-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(e=cl(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(e=cl(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),e&&(jo(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,n===rs?(jo(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(jo(t,!1),0===t.strm.avail_out)?1:2})(e,n):wf[e.level].func(e,n);if((3===r||4===r)&&(e.status=666),1===r||3===r)return 0===t.avail_out&&(e.last_flush=-1),Ir;if(2===r&&(n===_B?mB(e):n!==M3&&(z0(e,0,0,!1),n===$B&&(fl(e.head),0===e.lookahead&&(e.strstart=0,e.block_start=0,e.insert=0))),zo(t),0===t.avail_out))return e.last_flush=-1,Ir}return n!==rs?Ir:e.wrap<=0?k3:(2===e.wrap?(ci(e,255&t.adler),ci(e,t.adler>>8&255),ci(e,t.adler>>16&255),ci(e,t.adler>>24&255),ci(e,255&t.total_in),ci(e,t.total_in>>8&255),ci(e,t.total_in>>16&255),ci(e,t.total_in>>24&255)):(Cf(e,t.adler>>>16),Cf(e,65535&t.adler)),zo(t),e.wrap>0&&(e.wrap=-e.wrap),0!==e.pending?Ir:k3)},Ef_deflateEnd=t=>{if(xf(t))return Qs;const n=t.state.status;return t.state=null,113===n?fc(t,vB):Ir},Ef_deflateSetDictionary=(t,n)=>{let e=n.length;if(xf(t))return Qs;const i=t.state,r=i.wrap;if(2===r||1===r&&42!==i.status||i.lookahead)return Qs;if(1===r&&(t.adler=bf(t.adler,n,e,0)),i.wrap=0,e>=i.w_size){0===r&&(fl(i.head),i.strstart=0,i.block_start=0,i.insert=0);let h=new Uint8Array(i.w_size);h.set(n.subarray(e-i.w_size,e),0),n=h,e=i.w_size}const o=t.avail_in,s=t.next_in,a=t.input;for(t.avail_in=e,t.next_in=0,t.input=n,Mu(i);i.lookahead>=3;){let h=i.strstart,b=i.lookahead-2;do{i.ins_h=hl(i,i.ins_h,i.window[h+3-1]),i.prev[h&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=h,h++}while(--b);i.strstart=h,i.lookahead=2,Mu(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,t.next_in=s,t.input=a,t.avail_in=o,i.wrap=r,Ir};const t9=(t,n)=>Object.prototype.hasOwnProperty.call(t,n);var eg_assign=function(t){const n=Array.prototype.slice.call(arguments,1);for(;n.length;){const e=n.shift();if(e){if("object"!=typeof e)throw new TypeError(e+"must be non-object");for(const i in e)t9(e,i)&&(t[i]=e[i])}}return t},eg_flattenChunks=t=>{let n=0;for(let i=0,r=t.length;i<r;i++)n+=t[i].length;const e=new Uint8Array(n);for(let i=0,r=0,o=t.length;i<o;i++){let s=t[i];e.set(s,r),r+=s.length}return e};let R3=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{R3=!1}const Tf=new Uint8Array(256);for(let t=0;t<256;t++)Tf[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Tf[254]=Tf[254]=1;var Sf_string2buf=t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let n,e,i,r,o,s=t.length,a=0;for(r=0;r<s;r++)e=t.charCodeAt(r),55296==(64512&e)&&r+1<s&&(i=t.charCodeAt(r+1),56320==(64512&i)&&(e=65536+(e-55296<<10)+(i-56320),r++)),a+=e<128?1:e<2048?2:e<65536?3:4;for(n=new Uint8Array(a),o=0,r=0;o<a;r++)e=t.charCodeAt(r),55296==(64512&e)&&r+1<s&&(i=t.charCodeAt(r+1),56320==(64512&i)&&(e=65536+(e-55296<<10)+(i-56320),r++)),e<128?n[o++]=e:e<2048?(n[o++]=192|e>>>6,n[o++]=128|63&e):e<65536?(n[o++]=224|e>>>12,n[o++]=128|e>>>6&63,n[o++]=128|63&e):(n[o++]=240|e>>>18,n[o++]=128|e>>>12&63,n[o++]=128|e>>>6&63,n[o++]=128|63&e);return n},Sf_buf2string=(t,n)=>{const e=n||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,n));let i,r;const o=new Array(2*e);for(r=0,i=0;i<e;){let s=t[i++];if(s<128){o[r++]=s;continue}let a=Tf[s];if(a>4)o[r++]=65533,i+=a-1;else{for(s&=2===a?31:3===a?15:7;a>1&&i<e;)s=s<<6|63&t[i++],a--;a>1?o[r++]=65533:s<65536?o[r++]=s:(s-=65536,o[r++]=55296|s>>10&1023,o[r++]=56320|1023&s)}}return((t,n)=>{if(n<65534&&t.subarray&&R3)return String.fromCharCode.apply(null,t.length===n?t:t.subarray(0,n));let e="";for(let i=0;i<n;i++)e+=String.fromCharCode(t[i]);return e})(o,r)},Sf_utf8border=(t,n)=>{(n=n||t.length)>t.length&&(n=t.length);let e=n-1;for(;e>=0&&128==(192&t[e]);)e--;return e<0||0===e?n:e+Tf[t[e]]>n?e:n},L3=function l9(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const B3=Object.prototype.toString,{Z_NO_FLUSH:c9,Z_SYNC_FLUSH:u9,Z_FULL_FLUSH:d9,Z_FINISH:f9,Z_OK:tg,Z_STREAM_END:h9,Z_DEFAULT_COMPRESSION:p9,Z_DEFAULT_STRATEGY:g9,Z_DEFLATED:m9}=cc;function If(t){this.options=eg_assign({level:p9,method:m9,chunkSize:16384,windowBits:15,memLevel:8,strategy:g9},t||{});let n=this.options;n.raw&&n.windowBits>0?n.windowBits=-n.windowBits:n.gzip&&n.windowBits>0&&n.windowBits<16&&(n.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new L3,this.strm.avail_out=0;let e=Ef_deflateInit2(this.strm,n.level,n.method,n.windowBits,n.memLevel,n.strategy);if(e!==tg)throw new Error(lc[e]);if(n.header&&Ef_deflateSetHeader(this.strm,n.header),n.dictionary){let i;if(i="string"==typeof n.dictionary?Sf_string2buf(n.dictionary):"[object ArrayBuffer]"===B3.call(n.dictionary)?new Uint8Array(n.dictionary):n.dictionary,e=Ef_deflateSetDictionary(this.strm,i),e!==tg)throw new Error(lc[e]);this._dict_set=!0}}function Z0(t,n){const e=new If(n);if(e.push(t,!0),e.err)throw e.msg||lc[e.err];return e.result}If.prototype.push=function(t,n){const e=this.strm,i=this.options.chunkSize;let r,o;if(this.ended)return!1;for(o=n===~~n?n:!0===n?f9:c9,e.input="string"==typeof t?Sf_string2buf(t):"[object ArrayBuffer]"===B3.call(t)?new Uint8Array(t):t,e.next_in=0,e.avail_in=e.input.length;;)if(0===e.avail_out&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),(o===u9||o===d9)&&e.avail_out<=6)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else{if(r=Ef_deflate(e,o),r===h9)return e.next_out>0&&this.onData(e.output.subarray(0,e.next_out)),r=Ef_deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===tg;if(0!==e.avail_out){if(o>0&&e.next_out>0)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else if(0===e.avail_in)break}else this.onData(e.output)}return!0},If.prototype.onData=function(t){this.chunks.push(t)},If.prototype.onEnd=function(t){t===tg&&(this.result=eg_flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var x9={Deflate:If,deflate:Z0,deflateRaw:function _9(t,n){return(n=n||{}).raw=!0,Z0(t,n)},gzip:function $9(t,n){return(n=n||{}).gzip=!0,Z0(t,n)},constants:cc};const ng=16209;var T9=function(n,e){let i,r,o,s,a,h,b,ee,de,ge,xe,ke,Pe,Oe,je,qe,Ve,We,vt,nt,_t,Mt,ht,yt;const Tt=n.state;i=n.next_in,ht=n.input,r=i+(n.avail_in-5),o=n.next_out,yt=n.output,s=o-(e-n.avail_out),a=o+(n.avail_out-257),h=Tt.dmax,b=Tt.wsize,ee=Tt.whave,de=Tt.wnext,ge=Tt.window,xe=Tt.hold,ke=Tt.bits,Pe=Tt.lencode,Oe=Tt.distcode,je=(1<<Tt.lenbits)-1,qe=(1<<Tt.distbits)-1;e:do{ke<15&&(xe+=ht[i++]<<ke,ke+=8,xe+=ht[i++]<<ke,ke+=8),Ve=Pe[xe&je];t:for(;;){if(We=Ve>>>24,xe>>>=We,ke-=We,We=Ve>>>16&255,0===We)yt[o++]=65535&Ve;else{if(!(16&We)){if(0==(64&We)){Ve=Pe[(65535&Ve)+(xe&(1<<We)-1)];continue t}if(32&We){Tt.mode=16191;break e}n.msg="invalid literal/length code",Tt.mode=ng;break e}vt=65535&Ve,We&=15,We&&(ke<We&&(xe+=ht[i++]<<ke,ke+=8),vt+=xe&(1<<We)-1,xe>>>=We,ke-=We),ke<15&&(xe+=ht[i++]<<ke,ke+=8,xe+=ht[i++]<<ke,ke+=8),Ve=Oe[xe&qe];n:for(;;){if(We=Ve>>>24,xe>>>=We,ke-=We,We=Ve>>>16&255,!(16&We)){if(0==(64&We)){Ve=Oe[(65535&Ve)+(xe&(1<<We)-1)];continue n}n.msg="invalid distance code",Tt.mode=ng;break e}if(nt=65535&Ve,We&=15,ke<We&&(xe+=ht[i++]<<ke,ke+=8,ke<We&&(xe+=ht[i++]<<ke,ke+=8)),nt+=xe&(1<<We)-1,nt>h){n.msg="invalid distance too far back",Tt.mode=ng;break e}if(xe>>>=We,ke-=We,We=o-s,nt>We){if(We=nt-We,We>ee&&Tt.sane){n.msg="invalid distance too far back",Tt.mode=ng;break e}if(_t=0,Mt=ge,0===de){if(_t+=b-We,We<vt){vt-=We;do{yt[o++]=ge[_t++]}while(--We);_t=o-nt,Mt=yt}}else if(de<We){if(_t+=b+de-We,We-=de,We<vt){vt-=We;do{yt[o++]=ge[_t++]}while(--We);if(_t=0,de<vt){We=de,vt-=We;do{yt[o++]=ge[_t++]}while(--We);_t=o-nt,Mt=yt}}}else if(_t+=de-We,We<vt){vt-=We;do{yt[o++]=ge[_t++]}while(--We);_t=o-nt,Mt=yt}for(;vt>2;)yt[o++]=Mt[_t++],yt[o++]=Mt[_t++],yt[o++]=Mt[_t++],vt-=3;vt&&(yt[o++]=Mt[_t++],vt>1&&(yt[o++]=Mt[_t++]))}else{_t=o-nt;do{yt[o++]=yt[_t++],yt[o++]=yt[_t++],yt[o++]=yt[_t++],vt-=3}while(vt>2);vt&&(yt[o++]=yt[_t++],vt>1&&(yt[o++]=yt[_t++]))}break}}break}}while(i<r&&o<a);vt=ke>>3,i-=vt,ke-=vt<<3,xe&=(1<<ke)-1,n.next_in=i,n.next_out=o,n.avail_in=i<r?r-i+5:5-(i-r),n.avail_out=o<a?a-o+257:257-(o-a),Tt.hold=xe,Tt.bits=ke};const S9=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),I9=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),M9=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),k9=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Mf=(t,n,e,i,r,o,s,a)=>{const h=a.bits;let Ve,We,vt,nt,_t,ht,b=0,ee=0,de=0,ge=0,xe=0,ke=0,Pe=0,Oe=0,je=0,qe=0,Mt=null;const yt=new Uint16Array(16),Tt=new Uint16Array(16);let rn,En,Wn,nn=null;for(b=0;b<=15;b++)yt[b]=0;for(ee=0;ee<i;ee++)yt[n[e+ee]]++;for(xe=h,ge=15;ge>=1&&0===yt[ge];ge--);if(xe>ge&&(xe=ge),0===ge)return r[o++]=20971520,r[o++]=20971520,a.bits=1,0;for(de=1;de<ge&&0===yt[de];de++);for(xe<de&&(xe=de),Oe=1,b=1;b<=15;b++)if(Oe<<=1,Oe-=yt[b],Oe<0)return-1;if(Oe>0&&(0===t||1!==ge))return-1;for(Tt[1]=0,b=1;b<15;b++)Tt[b+1]=Tt[b]+yt[b];for(ee=0;ee<i;ee++)0!==n[e+ee]&&(s[Tt[n[e+ee]]++]=ee);if(0===t?(Mt=nn=s,ht=20):1===t?(Mt=S9,nn=I9,ht=257):(Mt=M9,nn=k9,ht=0),qe=0,ee=0,b=de,_t=o,ke=xe,Pe=0,vt=-1,je=1<<xe,nt=je-1,1===t&&je>852||2===t&&je>592)return 1;for(;;){rn=b-Pe,s[ee]+1<ht?(En=0,Wn=s[ee]):s[ee]>=ht?(En=nn[s[ee]-ht],Wn=Mt[s[ee]-ht]):(En=96,Wn=0),Ve=1<<b-Pe,We=1<<ke,de=We;do{We-=Ve,r[_t+(qe>>Pe)+We]=rn<<24|En<<16|Wn|0}while(0!==We);for(Ve=1<<b-1;qe&Ve;)Ve>>=1;if(0!==Ve?(qe&=Ve-1,qe+=Ve):qe=0,ee++,0==--yt[b]){if(b===ge)break;b=n[e+s[ee]]}if(b>xe&&(qe&nt)!==vt){for(0===Pe&&(Pe=xe),_t+=de,ke=b-Pe,Oe=1<<ke;ke+Pe<ge&&(Oe-=yt[ke+Pe],!(Oe<=0));)ke++,Oe<<=1;if(je+=1<<ke,1===t&&je>852||2===t&&je>592)return 1;vt=qe&nt,r[vt]=xe<<24|ke<<16|_t-o|0}}return 0!==qe&&(r[_t+qe]=b-Pe<<24|64<<16|0),a.bits=xe,0};const{Z_FINISH:q3,Z_BLOCK:A9,Z_TREES:ig,Z_OK:hc,Z_STREAM_END:P9,Z_NEED_DICT:N9,Z_STREAM_ERROR:os,Z_DATA_ERROR:W3,Z_MEM_ERROR:K3,Z_BUF_ERROR:O9,Z_DEFLATED:Y3}=cc,rg=16180,og=16190,Pa=16191,sg=16199,ag=16200,Fi=16209,vT=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function B9(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const pc=t=>{if(!t)return 1;const n=t.state;return!n||n.strm!==t||n.mode<rg||n.mode>16211?1:0},bT=t=>{if(pc(t))return os;const n=t.state;return t.total_in=t.total_out=n.total=0,t.msg="",n.wrap&&(t.adler=1&n.wrap),n.mode=rg,n.last=0,n.havedict=0,n.flags=-1,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new Int32Array(852),n.distcode=n.distdyn=new Int32Array(592),n.sane=1,n.back=-1,hc},yT=t=>{if(pc(t))return os;const n=t.state;return n.wsize=0,n.whave=0,n.wnext=0,bT(t)},CT=(t,n)=>{let e;if(pc(t))return os;const i=t.state;return n<0?(e=0,n=-n):(e=5+(n>>4),n<48&&(n&=15)),n&&(n<8||n>15)?os:(null!==i.window&&i.wbits!==n&&(i.window=null),i.wrap=e,i.wbits=n,yT(t))},wT=(t,n)=>{if(!t)return os;const e=new B9;t.state=e,e.strm=t,e.window=null,e.mode=rg;const i=CT(t,n);return i!==hc&&(t.state=null),i};let tv,nv,xT=!0;const j9=t=>{if(xT){tv=new Int32Array(512),nv=new Int32Array(32);let n=0;for(;n<144;)t.lens[n++]=8;for(;n<256;)t.lens[n++]=9;for(;n<280;)t.lens[n++]=7;for(;n<288;)t.lens[n++]=8;for(Mf(1,t.lens,0,288,tv,0,t.work,{bits:9}),n=0;n<32;)t.lens[n++]=5;Mf(2,t.lens,0,32,nv,0,t.work,{bits:5}),xT=!1}t.lencode=tv,t.lenbits=9,t.distcode=nv,t.distbits=5},ET=(t,n,e,i)=>{let r;const o=t.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),i>=o.wsize?(o.window.set(n.subarray(e-o.wsize,e),0),o.wnext=0,o.whave=o.wsize):(r=o.wsize-o.wnext,r>i&&(r=i),o.window.set(n.subarray(e-i,e-i+r),o.wnext),(i-=r)?(o.window.set(n.subarray(e-i,e),0),o.wnext=i,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0};var Na_inflateReset=yT,Na_inflateInit2=wT,Na_inflate=(t,n)=>{let e,i,r,o,s,a,h,b,ee,de,ge,xe,ke,Pe,je,qe,Ve,We,vt,nt,_t,Mt,Oe=0;const ht=new Uint8Array(4);let yt,Tt;const nn=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(pc(t)||!t.output||!t.input&&0!==t.avail_in)return os;e=t.state,e.mode===Pa&&(e.mode=16192),s=t.next_out,r=t.output,h=t.avail_out,o=t.next_in,i=t.input,a=t.avail_in,b=e.hold,ee=e.bits,de=a,ge=h,Mt=hc;e:for(;;)switch(e.mode){case rg:if(0===e.wrap){e.mode=16192;break}for(;ee<16;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}if(2&e.wrap&&35615===b){0===e.wbits&&(e.wbits=15),e.check=0,ht[0]=255&b,ht[1]=b>>>8&255,e.check=wr(e.check,ht,2,0),b=0,ee=0,e.mode=16181;break}if(e.head&&(e.head.done=!1),!(1&e.wrap)||(((255&b)<<8)+(b>>8))%31){t.msg="incorrect header check",e.mode=Fi;break}if((15&b)!==Y3){t.msg="unknown compression method",e.mode=Fi;break}if(b>>>=4,ee-=4,_t=8+(15&b),0===e.wbits&&(e.wbits=_t),_t>15||_t>e.wbits){t.msg="invalid window size",e.mode=Fi;break}e.dmax=1<<e.wbits,e.flags=0,t.adler=e.check=1,e.mode=512&b?16189:Pa,b=0,ee=0;break;case 16181:for(;ee<16;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}if(e.flags=b,(255&e.flags)!==Y3){t.msg="unknown compression method",e.mode=Fi;break}if(57344&e.flags){t.msg="unknown header flags set",e.mode=Fi;break}e.head&&(e.head.text=b>>8&1),512&e.flags&&4&e.wrap&&(ht[0]=255&b,ht[1]=b>>>8&255,e.check=wr(e.check,ht,2,0)),b=0,ee=0,e.mode=16182;case 16182:for(;ee<32;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}e.head&&(e.head.time=b),512&e.flags&&4&e.wrap&&(ht[0]=255&b,ht[1]=b>>>8&255,ht[2]=b>>>16&255,ht[3]=b>>>24&255,e.check=wr(e.check,ht,4,0)),b=0,ee=0,e.mode=16183;case 16183:for(;ee<16;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}e.head&&(e.head.xflags=255&b,e.head.os=b>>8),512&e.flags&&4&e.wrap&&(ht[0]=255&b,ht[1]=b>>>8&255,e.check=wr(e.check,ht,2,0)),b=0,ee=0,e.mode=16184;case 16184:if(1024&e.flags){for(;ee<16;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}e.length=b,e.head&&(e.head.extra_len=b),512&e.flags&&4&e.wrap&&(ht[0]=255&b,ht[1]=b>>>8&255,e.check=wr(e.check,ht,2,0)),b=0,ee=0}else e.head&&(e.head.extra=null);e.mode=16185;case 16185:if(1024&e.flags&&(xe=e.length,xe>a&&(xe=a),xe&&(e.head&&(_t=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(i.subarray(o,o+xe),_t)),512&e.flags&&4&e.wrap&&(e.check=wr(e.check,i,xe,o)),a-=xe,o+=xe,e.length-=xe),e.length))break e;e.length=0,e.mode=16186;case 16186:if(2048&e.flags){if(0===a)break e;xe=0;do{_t=i[o+xe++],e.head&&_t&&e.length<65536&&(e.head.name+=String.fromCharCode(_t))}while(_t&&xe<a);if(512&e.flags&&4&e.wrap&&(e.check=wr(e.check,i,xe,o)),a-=xe,o+=xe,_t)break e}else e.head&&(e.head.name=null);e.length=0,e.mode=16187;case 16187:if(4096&e.flags){if(0===a)break e;xe=0;do{_t=i[o+xe++],e.head&&_t&&e.length<65536&&(e.head.comment+=String.fromCharCode(_t))}while(_t&&xe<a);if(512&e.flags&&4&e.wrap&&(e.check=wr(e.check,i,xe,o)),a-=xe,o+=xe,_t)break e}else e.head&&(e.head.comment=null);e.mode=16188;case 16188:if(512&e.flags){for(;ee<16;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}if(4&e.wrap&&b!==(65535&e.check)){t.msg="header crc mismatch",e.mode=Fi;break}b=0,ee=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),t.adler=e.check=0,e.mode=Pa;break;case 16189:for(;ee<32;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}t.adler=e.check=vT(b),b=0,ee=0,e.mode=og;case og:if(0===e.havedict)return t.next_out=s,t.avail_out=h,t.next_in=o,t.avail_in=a,e.hold=b,e.bits=ee,N9;t.adler=e.check=1,e.mode=Pa;case Pa:if(n===A9||n===ig)break e;case 16192:if(e.last){b>>>=7&ee,ee-=7&ee,e.mode=16206;break}for(;ee<3;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}switch(e.last=1&b,b>>>=1,ee-=1,3&b){case 0:e.mode=16193;break;case 1:if(j9(e),e.mode=sg,n===ig){b>>>=2,ee-=2;break e}break;case 2:e.mode=16196;break;case 3:t.msg="invalid block type",e.mode=Fi}b>>>=2,ee-=2;break;case 16193:for(b>>>=7&ee,ee-=7&ee;ee<32;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}if((65535&b)!=(b>>>16^65535)){t.msg="invalid stored block lengths",e.mode=Fi;break}if(e.length=65535&b,b=0,ee=0,e.mode=16194,n===ig)break e;case 16194:e.mode=16195;case 16195:if(xe=e.length,xe){if(xe>a&&(xe=a),xe>h&&(xe=h),0===xe)break e;r.set(i.subarray(o,o+xe),s),a-=xe,o+=xe,h-=xe,s+=xe,e.length-=xe;break}e.mode=Pa;break;case 16196:for(;ee<14;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}if(e.nlen=257+(31&b),b>>>=5,ee-=5,e.ndist=1+(31&b),b>>>=5,ee-=5,e.ncode=4+(15&b),b>>>=4,ee-=4,e.nlen>286||e.ndist>30){t.msg="too many length or distance symbols",e.mode=Fi;break}e.have=0,e.mode=16197;case 16197:for(;e.have<e.ncode;){for(;ee<3;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}e.lens[nn[e.have++]]=7&b,b>>>=3,ee-=3}for(;e.have<19;)e.lens[nn[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,yt={bits:e.lenbits},Mt=Mf(0,e.lens,0,19,e.lencode,0,e.work,yt),e.lenbits=yt.bits,Mt){t.msg="invalid code lengths set",e.mode=Fi;break}e.have=0,e.mode=16198;case 16198:for(;e.have<e.nlen+e.ndist;){for(;Oe=e.lencode[b&(1<<e.lenbits)-1],je=Oe>>>24,qe=Oe>>>16&255,Ve=65535&Oe,!(je<=ee);){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}if(Ve<16)b>>>=je,ee-=je,e.lens[e.have++]=Ve;else{if(16===Ve){for(Tt=je+2;ee<Tt;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}if(b>>>=je,ee-=je,0===e.have){t.msg="invalid bit length repeat",e.mode=Fi;break}_t=e.lens[e.have-1],xe=3+(3&b),b>>>=2,ee-=2}else if(17===Ve){for(Tt=je+3;ee<Tt;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}b>>>=je,ee-=je,_t=0,xe=3+(7&b),b>>>=3,ee-=3}else{for(Tt=je+7;ee<Tt;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}b>>>=je,ee-=je,_t=0,xe=11+(127&b),b>>>=7,ee-=7}if(e.have+xe>e.nlen+e.ndist){t.msg="invalid bit length repeat",e.mode=Fi;break}for(;xe--;)e.lens[e.have++]=_t}}if(e.mode===Fi)break;if(0===e.lens[256]){t.msg="invalid code -- missing end-of-block",e.mode=Fi;break}if(e.lenbits=9,yt={bits:e.lenbits},Mt=Mf(1,e.lens,0,e.nlen,e.lencode,0,e.work,yt),e.lenbits=yt.bits,Mt){t.msg="invalid literal/lengths set",e.mode=Fi;break}if(e.distbits=6,e.distcode=e.distdyn,yt={bits:e.distbits},Mt=Mf(2,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,yt),e.distbits=yt.bits,Mt){t.msg="invalid distances set",e.mode=Fi;break}if(e.mode=sg,n===ig)break e;case sg:e.mode=ag;case ag:if(a>=6&&h>=258){t.next_out=s,t.avail_out=h,t.next_in=o,t.avail_in=a,e.hold=b,e.bits=ee,T9(t,ge),s=t.next_out,r=t.output,h=t.avail_out,o=t.next_in,i=t.input,a=t.avail_in,b=e.hold,ee=e.bits,e.mode===Pa&&(e.back=-1);break}for(e.back=0;Oe=e.lencode[b&(1<<e.lenbits)-1],je=Oe>>>24,qe=Oe>>>16&255,Ve=65535&Oe,!(je<=ee);){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}if(qe&&0==(240&qe)){for(We=je,vt=qe,nt=Ve;Oe=e.lencode[nt+((b&(1<<We+vt)-1)>>We)],je=Oe>>>24,qe=Oe>>>16&255,Ve=65535&Oe,!(We+je<=ee);){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}b>>>=We,ee-=We,e.back+=We}if(b>>>=je,ee-=je,e.back+=je,e.length=Ve,0===qe){e.mode=16205;break}if(32&qe){e.back=-1,e.mode=Pa;break}if(64&qe){t.msg="invalid literal/length code",e.mode=Fi;break}e.extra=15&qe,e.mode=16201;case 16201:if(e.extra){for(Tt=e.extra;ee<Tt;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}e.length+=b&(1<<e.extra)-1,b>>>=e.extra,ee-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=16202;case 16202:for(;Oe=e.distcode[b&(1<<e.distbits)-1],je=Oe>>>24,qe=Oe>>>16&255,Ve=65535&Oe,!(je<=ee);){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}if(0==(240&qe)){for(We=je,vt=qe,nt=Ve;Oe=e.distcode[nt+((b&(1<<We+vt)-1)>>We)],je=Oe>>>24,qe=Oe>>>16&255,Ve=65535&Oe,!(We+je<=ee);){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}b>>>=We,ee-=We,e.back+=We}if(b>>>=je,ee-=je,e.back+=je,64&qe){t.msg="invalid distance code",e.mode=Fi;break}e.offset=Ve,e.extra=15&qe,e.mode=16203;case 16203:if(e.extra){for(Tt=e.extra;ee<Tt;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}e.offset+=b&(1<<e.extra)-1,b>>>=e.extra,ee-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){t.msg="invalid distance too far back",e.mode=Fi;break}e.mode=16204;case 16204:if(0===h)break e;if(xe=ge-h,e.offset>xe){if(xe=e.offset-xe,xe>e.whave&&e.sane){t.msg="invalid distance too far back",e.mode=Fi;break}xe>e.wnext?(xe-=e.wnext,ke=e.wsize-xe):ke=e.wnext-xe,xe>e.length&&(xe=e.length),Pe=e.window}else Pe=r,ke=s-e.offset,xe=e.length;xe>h&&(xe=h),h-=xe,e.length-=xe;do{r[s++]=Pe[ke++]}while(--xe);0===e.length&&(e.mode=ag);break;case 16205:if(0===h)break e;r[s++]=e.length,h--,e.mode=ag;break;case 16206:if(e.wrap){for(;ee<32;){if(0===a)break e;a--,b|=i[o++]<<ee,ee+=8}if(ge-=h,t.total_out+=ge,e.total+=ge,4&e.wrap&&ge&&(t.adler=e.check=e.flags?wr(e.check,r,ge,s-ge):bf(e.check,r,ge,s-ge)),ge=h,4&e.wrap&&(e.flags?b:vT(b))!==e.check){t.msg="incorrect data check",e.mode=Fi;break}b=0,ee=0}e.mode=16207;case 16207:if(e.wrap&&e.flags){for(;ee<32;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}if(4&e.wrap&&b!==(4294967295&e.total)){t.msg="incorrect length check",e.mode=Fi;break}b=0,ee=0}e.mode=16208;case 16208:Mt=P9;break e;case Fi:Mt=W3;break e;case 16210:return K3;default:return os}return t.next_out=s,t.avail_out=h,t.next_in=o,t.avail_in=a,e.hold=b,e.bits=ee,(e.wsize||ge!==t.avail_out&&e.mode<Fi&&(e.mode<16206||n!==q3))&&ET(t,t.output,t.next_out,ge-t.avail_out),de-=t.avail_in,ge-=t.avail_out,t.total_in+=de,t.total_out+=ge,e.total+=ge,4&e.wrap&&ge&&(t.adler=e.check=e.flags?wr(e.check,r,ge,t.next_out-ge):bf(e.check,r,ge,t.next_out-ge)),t.data_type=e.bits+(e.last?64:0)+(e.mode===Pa?128:0)+(e.mode===sg||16194===e.mode?256:0),(0===de&&0===ge||n===q3)&&Mt===hc&&(Mt=O9),Mt},Na_inflateEnd=t=>{if(pc(t))return os;let n=t.state;return n.window&&(n.window=null),t.state=null,hc},Na_inflateGetHeader=(t,n)=>{if(pc(t))return os;const e=t.state;return 0==(2&e.wrap)?os:(e.head=n,n.done=!1,hc)},Na_inflateSetDictionary=(t,n)=>{const e=n.length;let i,r,o;return pc(t)||(i=t.state,0!==i.wrap&&i.mode!==og)?os:i.mode===og&&(r=1,r=bf(r,n,e,0),r!==i.check)?W3:(o=ET(t,n,e,e),o?(i.mode=16210,K3):(i.havedict=1,hc))},iz=function nz(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const TT=Object.prototype.toString,{Z_NO_FLUSH:rz,Z_FINISH:oz,Z_OK:kf,Z_STREAM_END:iv,Z_NEED_DICT:rv,Z_STREAM_ERROR:sz,Z_DATA_ERROR:ST,Z_MEM_ERROR:az}=cc;function Df(t){this.options=eg_assign({chunkSize:65536,windowBits:15,to:""},t||{});const n=this.options;n.raw&&n.windowBits>=0&&n.windowBits<16&&(n.windowBits=-n.windowBits,0===n.windowBits&&(n.windowBits=-15)),n.windowBits>=0&&n.windowBits<16&&!(t&&t.windowBits)&&(n.windowBits+=32),n.windowBits>15&&n.windowBits<48&&0==(15&n.windowBits)&&(n.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new L3,this.strm.avail_out=0;let e=Na_inflateInit2(this.strm,n.windowBits);if(e!==kf)throw new Error(lc[e]);if(this.header=new iz,Na_inflateGetHeader(this.strm,this.header),n.dictionary&&("string"==typeof n.dictionary?n.dictionary=Sf_string2buf(n.dictionary):"[object ArrayBuffer]"===TT.call(n.dictionary)&&(n.dictionary=new Uint8Array(n.dictionary)),n.raw&&(e=Na_inflateSetDictionary(this.strm,n.dictionary),e!==kf)))throw new Error(lc[e])}function ov(t,n){const e=new Df(n);if(e.push(t),e.err)throw e.msg||lc[e.err];return e.result}Df.prototype.push=function(t,n){const e=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let o,s,a;if(this.ended)return!1;for(s=n===~~n?n:!0===n?oz:rz,e.input="[object ArrayBuffer]"===TT.call(t)?new Uint8Array(t):t,e.next_in=0,e.avail_in=e.input.length;;){for(0===e.avail_out&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),o=Na_inflate(e,s),o===rv&&r&&(o=Na_inflateSetDictionary(e,r),o===kf?o=Na_inflate(e,s):o===ST&&(o=rv));e.avail_in>0&&o===iv&&e.state.wrap>0&&0!==t[e.next_in];)Na_inflateReset(e),o=Na_inflate(e,s);switch(o){case sz:case ST:case rv:case az:return this.onEnd(o),this.ended=!0,!1}if(a=e.avail_out,e.next_out&&(0===e.avail_out||o===iv))if("string"===this.options.to){let h=Sf_utf8border(e.output,e.next_out),b=e.next_out-h,ee=Sf_buf2string(e.output,h);e.next_out=b,e.avail_out=i-b,b&&e.output.set(e.output.subarray(h,h+b),0),this.onData(ee)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(o!==kf||0!==a){if(o===iv)return o=Na_inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===e.avail_in)break}}return!0},Df.prototype.onData=function(t){this.chunks.push(t)},Df.prototype.onEnd=function(t){t===kf&&(this.result="string"===this.options.to?this.chunks.join(""):eg_flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var pz={Inflate:Df,inflate:ov,inflateRaw:function lz(t,n){return(n=n||{}).raw=!0,ov(t,n)},ungzip:ov,constants:cc};const{Deflate:gz}=x9,{Inflate:vz}=pz;var IT=gz,MT=vz;function sv(){return sv=(0,gn.Z)(function*(t,n){const e=new IT({level:2,gzip:!0});try{return yield kT(e,t,n),e.result}catch(i){console.error(i)}return null}),sv.apply(this,arguments)}function av(){return av=(0,gn.Z)(function*(t,n){const e=new MT;try{return yield kT(e,t,n),e.result}catch(i){console.error(i)}return null}),av.apply(this,arguments)}function kT(t,n){return lv.apply(this,arguments)}function lv(){return lv=(0,gn.Z)(function*(t,n,e=16384){let i=Math.ceil(n.byteLength/e),r=null;for(let o=0;o<i;o++)yield Az(),r=n.slice(o*e,(o+1)*e),t.push(r,i<=o+1);if(t.err)throw new Error(`error: ${t.err}`);return t}),lv.apply(this,arguments)}function Az(){return new Promise(t=>jr(t))}var Uo,DT=_e(2391);!function(t){t.encode=function n(i){try{return DT.encode(i)}catch(r){console.error(r,i)}return null},t.decode=function e(i){try{return DT.decode(i)}catch(r){console.error(r,i)}return null}}(Uo||(Uo={}));var bo,Pz=_e(9069);!function(t){let n=[];for(let i=0;i<256;i++)n[i]=(i<16?"0":"")+i.toString(16);t.generateUuid=function e(){const i=new Uint32Array(4);window.crypto.getRandomValues(i);const r=i[0],o=i[1],s=i[2],a=i[3];return n[255&r]+n[r>>8&255]+n[r>>16&255]+n[r>>24&255]+"-"+n[255&o]+n[o>>8&255]+"-"+n[o>>16&15|64]+n[o>>24&255]+"-"+n[63&s|128]+n[s>>8&255]+"-"+n[s>>16&255]+n[s>>24&255]+n[255&a]+n[a>>8&255]+n[a>>16&255]+n[a>>24&255]}}(bo||(bo={}));class Oa{constructor(n,e){this.timerMilliSecond=0,this.timeoutDate=0,this.isStopped=!1,this.callback=n,this.timerMilliSecond=e,this.reset()}get isActive(){return null!=this.timeoutTimer}stop(){this.isStopped=!0}clear(){this.callback=null,this.timerMilliSecond=0,this.timeoutDate=0,this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.isStopped=!1}reset(...n){1===n.length?this.timerMilliSecond=n[0]:1<n.length&&(this.callback=n[0],this.timerMilliSecond=n[1]),this.isStopped=!1;let e=this.timeoutDate;this.timeoutDate=performance.now()+this.timerMilliSecond,!(this.timeoutTimer&&e<=this.timeoutDate)&&this.setTimeout()}setTimeout(){this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.callback&&(this.timeoutTimer=setTimeout(()=>{this.timeoutTimer=null,!this.isStopped&&(performance.now()<this.timeoutDate?this.setTimeout():this.callback&&this.callback())},this.timeoutDate-performance.now()))}}class lg{constructor(){}static add(n){this.monitoringConnections.add(n),n.updateStatsAsync(),this.restart()}static remove(n){this.monitoringConnections.delete(n)}static restart(){null==this.updateWebRTCStatsTimer?this.updateWebRTCStatsTimer=new Oa(()=>this.doMonitoringAsync(),this.calcIntervalTime()):this.updateWebRTCStatsTimer.isActive||this.updateWebRTCStatsTimer.reset(this.calcIntervalTime())}static calcIntervalTime(){return Math.min(2e3+1e3*this.monitoringConnections.size,1e4)}static doMonitoringAsync(){var n=this;return(0,gn.Z)(function*(){for(let e of n.monitoringConnections)e.open?yield e.updateStatsAsync():n.remove(e);n.monitoringConnections.size<1?n.updateWebRTCStatsTimer=null:n.restart()})()}}lg.updateWebRTCStatsTimer=null,lg.monitoringConnections=new Set;var ss=(()=>(function(t){t.UNKNOWN="unknown",t.RELAY="relay",t.PRFLX="prflx",t.SRFLX="srflx",t.HOST="host"}(ss||(ss={})),ss))();class Nz{constructor(n){this.peerConnection=n,this.candidateType=ss.UNKNOWN}updateAsync(){var n=this;return(0,gn.Z)(function*(){let e=null;try{e=yield n.peerConnection.getStats()}catch(ge){console.warn(ge)}if(null==e)return void(n.candidateType=ss.UNKNOWN);let i=[],r=[],o=[],s=[],a=[],h=[],b=[];e.forEach(ge=>{0<=ge.type.indexOf("candidate-pair")&&i.push(ge),0<=ge.type.indexOf("local-candidate")&&r.push(ge),0<=ge.type.indexOf("remote-candidate")&&o.push(ge)}),i.forEach(ge=>{"succeeded"===ge.state&&(s.push(ge.localCandidateId),a.push(ge.remoteCandidateId))}),r.forEach(ge=>{s.includes(ge.id)&&h.push(ge)}),o.forEach(ge=>{a.includes(ge.id)&&b.push(ge)});let ee=ss.UNKNOWN,de=Object.values(ss);h.concat(b).forEach(ge=>{let xe=de.indexOf(ge.candidateType);de.indexOf(ee)<xe&&(ee=de[xe])}),n.candidateType=ee})()}}class AT extends Pz.EventEmitter{constructor(n){super(),this.conn=n,this.chunkSize=15872,this.receivedMap=new Map,this.timeoutTimer=null,this._timestamp=performance.now(),this._ping=0,this._candidateType=ss.UNKNOWN,n.on("data",e=>this.onData(e)),n.on("open",()=>{this.stats=new Nz(this.getPeerConnection()),this.clearTimeoutTimer(),function Oz(t){t._dc&&t._sendBuffer&&(t._startSendLoop=Fz)}(n),this.emit("open"),this.startMonitoring()}),n.on("close",()=>{this.clearTimeoutTimer(),this.emit("close")}),n.on("error",e=>{this.clearTimeoutTimer(),this.emit("error",e)}),this.setTimeoutTimer()}get open(){return this.conn.open}get remoteId(){return this.conn.remoteId}get metadata(){return this.conn.metadata}get bufferedAmount(){return this.conn._dc?.bufferedAmount??0}get timestamp(){return this._timestamp}set timestamp(n){this._timestamp=n}get ping(){return this._ping}set ping(n){this._ping=n}get candidateType(){return this._candidateType}set candidateType(n){this._candidateType=n}close(){this.clearTimeoutTimer(),this.stopMonitoring(),this.conn.close()}send(n){let e=Uo.encode(n),i=Math.ceil(e.byteLength/this.chunkSize);if(i<=1)return void this.conn.send(e);let r=bo.generateUuid(),o=null,s=null;for(let a=0;a<i;a++)o=e.slice(a*this.chunkSize,(a+1)*this.chunkSize),s={id:r,data:o,index:a,total:i},this.conn.send(Uo.encode(s))}getPeerConnection(){return this.conn.getPeerConnection()}startMonitoring(){lg.add(this)}stopMonitoring(){lg.remove(this)}updateStatsAsync(){var n=this;return(0,gn.Z)(function*(){null!=n.stats&&(n.sendPing(),yield n.stats.updateAsync(),n.candidateType=n.stats.candidateType,n.emit("stats",n.stats))})()}sendPing(){let n=Uo.encode({from:this.remoteId,ping:performance.now()});this.conn.send(n)}receivePing(n){if(n.from===this.remoteId){let i=performance.now()-n.ping;this.ping=i<=this.ping?.5*this.ping+.5*i:i}else{let e=Uo.encode(n);this.conn.send(e)}}onData(n){this.timestamp=performance.now();let e=Uo.decode(new Uint8Array(n));if(null!=e.ping)return void this.receivePing(e);let r=e;if(null==r.id)return void this.emit("data",e);let o=this.receivedMap.get(r.id);if(null==o&&(o={id:r.id,chanks:new Array(r.total),length:0,byteLength:0},this.receivedMap.set(r.id,o)),null!=o.chanks[r.index]||(o.length++,o.byteLength+=r.data.byteLength,o.chanks[r.index]=r.data,o.length<r.total))return;this.receivedMap.delete(r.id);let s=new Uint8Array(o.byteLength),a=0;for(let b of o.chanks)s.set(b,a),a+=b.byteLength;let h=Uo.decode(s);this.emit("data",h)}setTimeoutTimer(){this.clearTimeoutTimer(),this.timeoutTimer=setTimeout(()=>{console.warn(`timeout ${this.conn.remoteId}`),this.timeoutTimer=null,this.emit("close")},15e3)}clearTimeoutTimer(){null!=this.timeoutTimer&&(clearTimeout(this.timeoutTimer),this.timeoutTimer=null)}}function Fz(){this.sendInterval||(this.sendInterval=jr(PT.bind(this)))}function PT(){const t=this._sendBuffer.shift();try{this._dc.send(t)}catch{this._sendBuffer.push(t)}this.sendInterval=0===this._sendBuffer.length?void 0:jr(PT.bind(this))}class Rz{constructor(){this._peerIds=[],this.peerContext=ki.parse("???"),this.peerContexts=[],this.callback=new i3,this.bandwidthUsage=0,this.key="",this.connections=[],this.listAllPeersCache=[],this.httpRequestInterval=performance.now()+500,this.outboundQueue=Promise.resolve(),this.inboundQueue=Promise.resolve(),this.relayingPeerIds=new Map,this.maybeUnavailablePeerIds=new Set}get peerId(){return this.peerContext?this.peerContext.peerId:"???"}get peerIds(){return this._peerIds}open(...n){console.log("open",n),this.peerContext=0===n.length?ki.create(ki.generateId()):1===n.length?ki.create(n[0]):ki.create(n[0],n[1],n[2],n[3]),this.openPeer()}close(){this.peer&&this.peer.destroy(),this.disconnectAll(),this.peer=null,this.peerContext=ki.parse("???")}connect(n){if(!this.shouldConnect(n))return!1;let e=new AT(this.peer.connect(n,{serialization:"none",metadata:{sendFrom:this.peerId}}));return this.openDataConnection(e),!0}shouldConnect(n){return this.peerContext&&this.peer&&this.peerId?this.peerId===n?(console.log("connect() is Fail. "+n+" is me."),!1):this.findDataConnection(n)?(console.log("connect() is Fail. <"+n+"> is already connecting."),!1):!(!n||!n.length||n===this.peerId):(console.log("connect() is Fail. ID\u304c\u5272\u308a\u632f\u3089\u308c\u308b\u307e\u3067\u5f85\u3066\u3084"),!1)}disconnect(n){let e=this.findDataConnection(n);return!!e&&(this.closeDataConnection(e),!0)}disconnectAll(){console.log("<closeAllDataConnection()>");for(let n of this.connections.concat())this.closeDataConnection(n)}send(n,e){var i=this;if(this.connections.length<1)return;let r={data:Uo.encode(n),ttl:1},o=r.data.byteLength;this.bandwidthUsage+=o,this.outboundQueue=this.outboundQueue.then(()=>new Promise((s,a)=>{jr((0,gn.Z)(function*(){if(1024<r.data.byteLength&&Array.isArray(n)&&1<n.length){let h=yield function kz(t,n){return sv.apply(this,arguments)}(r.data);h.byteLength<r.data.byteLength&&(r.data=h,r.isCompressed=!0)}return e?i.sendUnicast(r,e):i.sendBroadcast(r),i.bandwidthUsage-=o,s()}))}))}sendUnicast(n,e){n.ttl=0;let i=this.findDataConnection(e);i&&i.open&&i.send(n)}sendBroadcast(n){for(let e of this.connections)e.open&&e.send(n)}setApiKey(n){this.key!==n&&console.log("Key Change"),this.key=n}listAllPeers(){return new Promise((n,e)=>{if(!this.peer)return n([]);let i=performance.now();if(i<this.httpRequestInterval)return console.warn("httpRequestInterval... "+(this.httpRequestInterval-i)),void n(this.listAllPeersCache.concat());this.httpRequestInterval=i+6e3,this.peer.listAllPeers(r=>{this.listAllPeersCache=r.concat(),n(r)})})}openPeer(){this.peer&&(console.warn("It is already opened."),this.close());let n=new Peer(this.peerContext.peerId,{key:this.key});n.on("open",e=>{console.log("My peer ID is: "+e),(!this.peerContext||this.peerContext.peerId!==e)&&(this.peerContext=ki.parse(e)),this.peerContext.isOpen=!0,console.log("My peer Context",this.peerContext),this.callback.onOpen&&this.callback.onOpen(this.peerId)}),n.on("close",()=>{console.log("Peer close"),this.peerContext&&this.peerContext.isOpen&&(this.peerContext.isOpen=!1,this.callback.onClose&&this.callback.onClose(this.peerId))}),n.on("connection",e=>{this.openDataConnection(new AT(e))}),n.on("error",e=>{console.error("<"+this.peerId+"> "+e.type+" => "+e.message);let i=`${this.getSkyWayErrorMessage(e.type)}\n\n${e.type}: ${e.message}`;switch(e.type){case"peer-unavailable":let r=/"(.+)"/.exec(e.message)[1];this.disconnect(r);break;case"disconnected":case"socket-error":case"unavailable-id":case"authentication":case"server-error":this.peerContext&&this.peerContext.isOpen&&(this.close(),this.callback.onClose&&this.callback.onClose(this.peerId))}this.callback.onError&&this.callback.onError(this.peerId,e.type,i,e)}),this.peer=n}openDataConnection(n){if(!1===this.addDataConnection(n))return;let e=this.connections.indexOf(n),i=null;0<=e&&(i=this.peerContexts[e]),this.maybeUnavailablePeerIds.add(n.remoteId),n.on("data",r=>{this.onData(n,r)}),n.on("open",()=>{this.maybeUnavailablePeerIds.delete(n.remoteId),i&&(i.isOpen=!0),this.updatePeerList(),this.callback.onConnect&&this.callback.onConnect(n.remoteId)}),n.on("close",()=>{this.closeDataConnection(n)}),n.on("error",()=>{this.closeDataConnection(n)}),n.on("stats",()=>{let r=performance.now()-n.timestamp,o=r<=1e4?1:5e3/(r-1e4+5e3),s=o<1?r:n.ping,a=500/(s+500);switch(i.session.health=o,i.session.ping=s,i.session.speed=a*o,n.candidateType){case ss.HOST:i.session.grade=ll.HIGH;break;case ss.SRFLX:case ss.PRFLX:i.session.grade=ll.MIDDLE;break;case ss.RELAY:i.session.grade=ll.LOW;break;default:i.session.grade=ll.UNSPECIFIED}i.session.description=n.candidateType,i.session.health<.2&&this.closeDataConnection(n)})}closeDataConnection(n){n.close();let e=this.connections.indexOf(n);0<=e&&(console.log(n.remoteId+" is \u3048\u3093\u3044\u30fcindex:"+e+" length:"+this.connections.length),this.connections.splice(e,1),this.peerContexts.splice(e,1)),this.relayingPeerIds.delete(n.remoteId),this.relayingPeerIds.forEach(i=>{let r=i.indexOf(n.remoteId);0<=r&&i.splice(r,1)}),console.log("<close()> Peer:"+n.remoteId+" length:"+this.connections.length+":"+this.peerContexts.length),this.updatePeerList(),0<=e&&this.callback.onDisconnect&&this.callback.onDisconnect(n.remoteId)}addDataConnection(n){let e=this.findDataConnection(n.remoteId);if(null!==e){if(console.log("add() is Fail. "+n.remoteId+" is already connecting."),e!==n){if(!(e.metadata.sendFrom<n.metadata.sendFrom))return this.closeDataConnection(e),this.addDataConnection(n),!0;this.closeDataConnection(n)}return!1}return this.connections.push(n),this.peerContexts.push(ki.parse(n.remoteId)),console.log("<add()> Peer:"+n.remoteId+" length:"+this.connections.length),!0}findDataConnection(n){for(let e of this.connections)if(e.remoteId===n)return e;return null}onData(n,e){var i=this;if(e.peers&&0<e.peers.length&&this.onUpdatePeerList(n,e),0<e.ttl&&this.onRelay(n,e),this.callback.onData){let r=e.data.byteLength;this.bandwidthUsage+=r,this.inboundQueue=this.inboundQueue.then(()=>new Promise((o,s)=>{jr((0,gn.Z)(function*(){let a=e.isCompressed?yield function Dz(t,n){return av.apply(this,arguments)}(e.data):e.data;return i.callback.onData(n.remoteId,Uo.decode(a)),i.bandwidthUsage-=r,o()}))}))}}onRelay(n,e){e.ttl--;let i=this.relayingPeerIds.get(n.remoteId);if(null!=i)for(let r of i){let o=this.findDataConnection(r);o&&o.open&&(console.log("<"+r+"> \u8ee2\u9001\u3057\u306a\u304d\u3083\u30fb\u30fb\u30fb"),o.send(e))}}onUpdatePeerList(n,e){let i=[],r=[],o=function Lz(t,n){let e=[],i=[],r=!1,o=!1;for(let s of t.concat(n))r=t.includes(s),o=n.includes(s),r&&!o?e.push(s):!r&&o&&i.push(s);return{diff1:e,diff2:i}}(this._peerIds,e.peers);if(i=o.diff1,r=o.diff2,this.relayingPeerIds.set(n.remoteId,i),e.peers=e.peers.concat(i),r.length)for(let s of r)!this.maybeUnavailablePeerIds.has(s)&&this.connect(s)&&console.log("auto connect to unknown Peer <"+s+">")}updatePeerList(){let n=[];for(let e of this.connections)e.open&&n.push(e.remoteId);return n.push(this.peerId),n.sort(function(e,i){return e>i?1:e<i?-1:0}),this._peerIds=n,console.log("<update()>",n),this.notifyPeerList(),n}notifyPeerList(){if(this.connections.length<1)return;let n={data:Uo.encode([]),peers:this._peerIds,ttl:1};this.sendBroadcast(n)}getSkyWayErrorMessage(n){switch(n){case"room-error":return"SkyWay Room API \u306b\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002";case"permission":return"\u8a72\u5f53\u306e SkyWay Room \u306e\u5229\u7528\u304c\u8a31\u53ef\u3055\u308c\u3066\u307e\u305b\u3093\u3002";case"list-error":return"SkyWay listAllPeers API \u304c Disabled \u3067\u3059\u3002";case"disconnected":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u306b\u63a5\u7d9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002";case"socket-error":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u3068\u306e\u901a\u4fe1\u3067\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002";case"invalid-id":return"Peer ID \u304c\u4e0d\u6b63\u3067\u3059\u3002";case"unavailable-id":return"\u305d\u306e Peer ID \u3059\u3067\u306b\u4f7f\u7528\u3055\u308c\u3066\u3044\u307e\u3059\u3002";case"peer-unavailable":return"\u305d\u306e Peer ID \u306f\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002";case"invalid-key":return"SkyWay API \u30ad\u30fc\u304c\u7121\u52b9\u3067\u3059\u3002";case"invalid-domain":return"SkyWay API \u30ad\u30fc\u306b\u306f\u73fe\u5728\u306e\u30c9\u30e1\u30a4\u30f3\u306f\u767b\u9332\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002";case"authentication":return"\u8a8d\u8a3c\u30a8\u30e9\u30fc\u3067\u3059\u3002";case"server-error":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u3068\u306e\u63a5\u7d9a\u4e2d\u306b\u554f\u984c\u304c\u3042\u308a\u307e\u3057\u305f\u3002 \u5c11\u3057\u5f85\u3063\u3066\u3001\u30ea\u30c8\u30e9\u30a4\u3057\u3066\u304f\u3060\u3055\u3044\u3002";case"sfu-client-not-supported":return"\u3053\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306f SFU \u306e\u4f7f\u7528\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u6700\u65b0\u306e Google Chrome \u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044";case"peer-unavailable":return"Peer \u3078\u30c7\u30fc\u30bf\u3092\u9001\u4fe1\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002Peer ID \u304c\u6b63\u3057\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002";case"signaling-limited":return"\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u56de\u6570\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u5168\u3066\u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09";case"sfu-limited":return"SFU \u30b5\u30fc\u30d0\u306e\u5229\u7528\u91cf\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001SFU \u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09";case"turn-limited":return"TURN \u30b5\u30fc\u30d0\u306e\u5229\u7528\u91cf\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001TURN \u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09\n\u3053\u306e\u72b6\u614b\u3067\u306f\u3001\u4e00\u90e8\u306e\u30e6\u30fc\u30b6\u306e\u63a5\u7d9a\u306b\u554f\u984c\u304c\u767a\u751f\u3059\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002";case"peer-unavailable":return"\u305d\u306ePeer ID\u306f\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002";default:return"SkyWay\u306b\u95a2\u3059\u308b\u4e0d\u660e\u306a\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002"}}}const NT=ki.parse("???");class ta{constructor(){this.callback=new i3,this.key="",this.queue=new Set,this.sendInterval=null,this.sendCallback=()=>{this.sendQueue()},this.callbackUnload=n=>{this.close()},console.log("Network ready...")}static get instance(){return ta._instance||(ta._instance=new ta),ta._instance}get peerId(){return this.connection?this.connection.peerId:NT.peerId}get peerIds(){return this.connection?this.connection.peerIds.concat():[]}get peerContexts(){return this.connection?this.connection.peerContexts.concat():[]}get peerContext(){return this.connection?this.connection.peerContext:NT}get isOpen(){return!(!this.connection||!this.connection.peerContext)&&this.connection.peerContext.isOpen}get bandwidthUsage(){return this.connection?this.connection.bandwidthUsage:0}open(...n){this.connection&&this.connection.peerContext&&(console.warn("It is already opened."),this.close()),console.log("Network open...",n),this.connection=this.initializeConnection(),this.connection.open.apply(this.connection,n),window.addEventListener("unload",this.callbackUnload,!1)}close(){this.connection&&this.connection.close(),this.connection=null,window.removeEventListener("unload",this.callbackUnload,!1),console.log("Network close...")}connect(n){return!!this.connection&&this.connection.connect(n)}disconnect(n){!this.connection||this.connection.disconnect(n)&&(console.log("<disconnectPeer()> Peer:"+n),this.disconnect(n))}send(n,e){this.queue.add({data:n,sendTo:e}),null===this.sendInterval&&(this.sendInterval=jr(this.sendCallback))}sendQueue(){let n=[],e={},i=[],r=this.queue.size<128?this.queue.size:128;for(let o of this.queue){if(r<=0)break;r--,this.queue.delete(o),null==o.sendTo?n.push(o.data):o.sendTo===this.peerId?i.push(o.data):(o.sendTo in e||(e[o.sendTo]=[]),e[o.sendTo].push(o.data))}if(this.connection){n.length&&this.connection.send(n);for(let o in e)this.connection.send(e[o],o)}this.callback.onData&&(this.callback.onData(null,n),this.callback.onData(this.peerId,i)),this.sendInterval=0<this.queue.size?jr(this.sendCallback):null}setApiKey(n){this.key!==n&&console.log("Key Change"),this.key=n}listAllPeers(){return this.connection?this.connection.listAllPeers():Promise.resolve([])}initializeConnection(){let n=new Rz;return n.setApiKey(this.key),n.callback.onOpen=e=>{this.callback.onOpen&&this.callback.onOpen(e)},n.callback.onClose=e=>{this.callback.onClose&&this.callback.onClose(e)},n.callback.onConnect=e=>{this.callback.onConnect&&this.callback.onConnect(e)},n.callback.onDisconnect=e=>{this.callback.onDisconnect&&this.callback.onDisconnect(e)},n.callback.onData=(e,i)=>{this.callback.onData&&this.callback.onData(e,i)},n.callback.onError=(e,i,r,o)=>{this.callback.onError&&this.callback.onError(e,i,r,o)},0<this.queue.size&&null===this.sendInterval&&(this.sendInterval=jr(this.sendCallback)),n}}class cg{constructor(n,e,i=ta.instance.peerId){this.eventName=n,this.data=e,this.sendFrom=i,this.isSendFromSelf=!1,this.isSendFromSelf=this.sendFrom===ta.instance.peerId}toContext(){return{sendFrom:this.sendFrom,eventName:this.eventName,data:this.data}}}class cv{constructor(n,e){this._priority=0,this._isRegistered=!1,this._subject=n,this._key=e}get subject(){return this._subject}get key(){return this._key}get eventName(){return this._eventName}get priority(){return this._priority}get callback(){return this._callback}get isOnlyOnce(){return this._isOnlyOnce}get isRegistered(){return this._isRegistered}on(...n){return this._isOnlyOnce=!1,2===n.length?this.register(n[0],0,n[1]):this.register(n[0],n[1],n[2])}once(...n){let e=this.on.apply(this,n);return this._isOnlyOnce=!0,e}register(n,e,i){return this.isRegistered&&this.unregister(),this._eventName=n||"*",this._priority=e,this._callback=i,this.subject.registerListener(this),this._isRegistered=!0,new cv(this.subject,this.key)}unregister(){return this.subject.unregisterListener(this),this._callback=null,this._isRegistered=!1,this}trigger(n){this.callback&&this.isRegistered&&(this.callback.apply(this.key,[n,this]),this.isOnlyOnce&&this.unregister())}isEqual(n,e,i){return!(null!=n&&n!==this.key||null!=e&&e!==this.eventName||null!=i&&i!==this.callback)}}class gc{constructor(){this.listenerMap=new Map,console.log("EventSystem ready...")}static get instance(){return gc._instance||(gc._instance=new gc,gc._instance.initializeNetworkEvent()),gc._instance}register(n){return new cv(this,n)}unregister(...n){1===n.length?this._unregister(n[0],null,null):2===n.length?"string"==typeof n[1]?this._unregister(n[0],n[1],null):this._unregister(n[0],null,n[1]):this._unregister(n[0],n[1],n[2])}_unregister(n=this,e,i){let r=this.listenerMap.values();for(let o of r)for(let s of o.concat())s.isEqual(n,e,i)&&s.unregister()}registerListener(n){let e=this.getListeners(n.eventName);return e.push(n),e.sort((i,r)=>r.priority-i.priority),this.listenerMap.set(n.eventName,e),n}unregisterListener(n){let e=this.getListeners(n.eventName),i=e.indexOf(n);return i<0?null:(e.splice(i,1),n.unregister(),e.length<1&&this.listenerMap.delete(n.eventName),n)}call(...n){"string"==typeof n[0]?this._call(new cg(n[0],n[1]),n[2]):this._call(n[0],n[1])}_call(n,e){let i=n.toContext();ta.instance.send(i,e)}trigger(...n){if(2!==n.length)return this._trigger(n[0]instanceof cg?n[0]:new cg(n[0].eventName,n[0].data,n[0].sendFrom));this._trigger(new cg(n[0],n[1]))}_trigger(n){let e=this.getListeners(n.eventName).concat(this.getListeners("*"));for(let i of e)i.trigger(n);return n}getListeners(n){return this.listenerMap.has(n)?this.listenerMap.get(n):[]}initializeNetworkEvent(){let n=ta.instance.callback;n.onOpen=e=>{this.trigger("OPEN_NETWORK",{peerId:e})},n.onClose=e=>{this.trigger("CLOSE_NETWORK",{peerId:e})},n.onConnect=e=>{this.sendSystemMessage("<"+e+"> connect <DataConnection>"),this.trigger("CONNECT_PEER",{peerId:e})},n.onDisconnect=e=>{this.sendSystemMessage("<"+e+"> disconnect <DataConnection>"),this.trigger("DISCONNECT_PEER",{peerId:e})},n.onData=(e,i)=>{for(let r of i)this.trigger(r)},n.onError=(e,i,r,o)=>{this.sendSystemMessage("<"+e+"> "+r),this.trigger("NETWORK_ERROR",{peerId:e,errorType:i,errorMessage:r,errorObject:o})}}sendSystemMessage(n){console.log(n)}}const Ue=gc.instance,Ot=ta.instance;class Ct{constructor(){this.identifierMap=new Map,this.aliasNameMap=new Map,this.garbageMap=new Map,this.queueMap=new Map,this.updateInterval=null,this.garbageCollectionInterval=null,this.updateCallback=()=>{this.updateQueue()},console.log("ObjectStore ready...")}static get instance(){return Ct._instance||(Ct._instance=new Ct),Ct._instance}add(n,e=!0){return null!=this.get(n.identifier)||this.isDeleted(n.identifier)?null:(this.identifierMap.set(n.identifier,n),(this.aliasNameMap.has(n.aliasName)?this.aliasNameMap.get(n.aliasName):this.aliasNameMap.set(n.aliasName,new Map).get(n.aliasName)).set(n.identifier,n),n.onStoreAdded(),e&&this.update(n.toContext()),n)}remove(n){if(!this.identifierMap.has(n.identifier))return null;this.identifierMap.delete(n.identifier);let e=this.aliasNameMap.get(n.aliasName);return e&&e.delete(n.identifier),n.onStoreRemoved(),n}delete(n,e=!0){let i=null,r=null;return"string"==typeof n?(i=this.get(n),r=n):(i=n,r=n.identifier),this.markForDelete(r),null==i?null:this._delete(i,e)}_delete(n,e){return null===this.remove(n)?null:(e&&Ue.call("DELETE_GAME_OBJECT",{aliasName:n.aliasName,identifier:n.identifier}),n)}markForDelete(n){this.garbageMap.set(n,performance.now()),this.garbageCollection(6e5)}get(n){return this.identifierMap.has(n)?this.identifierMap.get(n):null}getObjects(n){if(null==n)return Array.from(this.identifierMap.values());let e="";return e="string"==typeof n?n:n.aliasName,this.aliasNameMap.has(e)?Array.from(this.aliasNameMap.get(e).values()):[]}update(n){let e=null;if("string"==typeof n){let i=this.get(n);i&&(e=i.toContext())}else e=n;if(e){if(this.queueMap.has(e.identifier)){let i=this.queueMap.get(e.identifier);for(let r in e)i[r]=e[r];return}Ue.call("UPDATE_GAME_OBJECT",e),this.queueMap.set(e.identifier,e),null===this.updateInterval&&(this.updateInterval=jr(this.updateCallback))}}updateQueue(){this.queueMap.clear(),this.updateInterval=null}isDeleted(n){return null!=this.garbageMap.get(n)}getCatalog(){let n=[];for(let e of this.identifierMap.values())n.push({identifier:e.identifier,version:e.version});return n}clearDeleteHistory(){this.garbageMap.clear()}garbageCollection(n){"number"==typeof n?null===this.garbageCollectionInterval&&(this.garbageCollectionInterval=setTimeout(()=>{this.garbageCollectionInterval=null},1e3),this._garbageCollection(n)):this.garbageMap.delete(n.identifier)}_garbageCollection(n){let e=performance.now(),i=this.garbageMap.size-1e5;if(i<1)return;let r=this.garbageMap.entries();for(;i<1;){i--;let o=r.next();if(o.done)break;let s=o.value[0];o.value[1]+n<e||this.garbageMap.delete(s)}}}var Fa,Bz=_e(383);class na{constructor(){this.constructorMap=new Map,this.aliasMap=new Map,console.log("ObjectFactory ready...")}static get instance(){return na._instance||(na._instance=new na),na._instance}register(n,e){e||(e=n.name??n.toString().match(/function\s*([^(]*)\(/)?.[1]??""),this.constructorMap.has(e)?console.error("\u305d\u306e alias<"+e+"> \u306f\u3059\u3067\u306b\u5272\u308a\u5f53\u3066\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f"):this.aliasMap.has(n)?console.error("\u305d\u306e constructor \u306f\u3059\u3067\u306b\u767b\u9332\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f",n):(console.log("addGameObjectFactory -> "+e),this.constructorMap.set(e,n),this.aliasMap.set(n,e))}create(n,e){let i=this.constructorMap.get(n);return i?new i(e):(console.error(n+"\u3068\u3044\u3046\u540d\u306eGameObject\u30af\u30e9\u30b9\u306f\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),null)}getAlias(n){return this.aliasMap.get(n)??""}}function OT(t){return n=>{na.instance.register(n,t)}}function Au(){return(t,n)=>{Object.defineProperty(t,n,{get:function e(){return this.context.syncData[n]},set:function i(r){this.context.syncData[n]=r,this.update()},enumerable:!0,configurable:!0})}}!function(t){const n=/&|<|>|"|'/g,e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"},i=/&amp;|&lt;|&gt;|&quot;|&apos;/g,r={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'"},o=/((?:[\0-\x08\x0B\f\x0E-\x1F\uFFFD\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))/g;function ee(ge){return e[ge]}function de(ge){return r[ge]}t.xml2element=function s(ge){let xe=new DOMParser,ke=null;try{ge=function b(ge){return ge.replace(o,"").trim()}(ge),ke=xe.parseFromString(ge,"application/xml"),ke.getElementsByTagName("parsererror").length&&(console.error("XML\u306e\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3057\u305f",ke.documentElement),ke=null)}catch(Pe){console.error(Pe)}return ke?ke.documentElement:null},t.encodeEntityReference=function a(ge){return ge.replace(n,ee)},t.decodeEntityReference=function h(ge){return ge.replace(i,de)}}(Fa||(Fa={}));const jz=Object.getOwnPropertyNames(Object.prototype);Object.getOwnPropertyNames(Array.prototype);class gi{constructor(){console.log("ObjectSerializer ready...")}static get instance(){return gi._instance||(gi._instance=new gi),gi._instance}toXml(n){let e="",i="toAttributes"in n?n.toAttributes():gi.toAttributes(n.toContext().syncData),r=n.aliasName,o="";for(let s in i){let a=Fa.encodeEntityReference(i[s]+"");null!=a&&(o+=" "+s+'="'+a+'"')}return e+=`<${r+o}>`,e+="innerXml"in n?n.innerXml():"",e+=`</${r}>`,e}static toAttributes(n){let e={};for(let i in n){let s=gi.make2Attributes(n[i],i);for(let a in s)e[a]=s[a]}return e}static make2Attributes(n,e){let i={};if(Array.isArray(n)){let r=gi.array2attributes(n,e);for(let o in r)i[o]=r[o]}else if("object"==typeof n){let r=gi.object2attributes(n,e);for(let o in r)i[o]=r[o]}else i[e]=n;return i}static object2attributes(n,e){let i={};for(let r in n){let a=gi.make2Attributes(n[r],e+"."+r);for(let h in a)i[h]=a[h]}return i}static array2attributes(n,e){let i={},r=n.length;for(let o=0;o<r;o++){let h=gi.make2Attributes(n[o],e+"."+o);for(let b in h)i[b]=h[b]}return i}parseXml(n){let e=null;if(e="string"==typeof n?Fa.xml2element(n):n,!e)return console.error("xmlElement\u304c\u7a7a\u3067\u3059"),null;let i=na.instance.create(e.tagName);if(!i)return null;if("parseAttributes"in i)i.parseAttributes(e.attributes);else{let r=i.toContext();gi.parseAttributes(r.syncData,e.attributes),i.apply(r)}i.initialize(),"parseInnerXml"in i&&i.parseInnerXml(e);try{i.complement()}catch(r){console.log(r)}return i}static parseAttributes(n,e){let i=e.length;for(let r=0;r<i;r++){let o=e[r].value;o=Fa.decodeEntityReference(o);let s=e[r].name.split("."),a=s[0],h=n,b=s.find(de=>jz.includes(de));null==b?1<s.length&&(({obj:h,key:a}=gi.attributes2object(s,h,a)),null==a)||("string"!=typeof h[a]&&null!=h[a]&&(o=JSON.parse(o)),h[a]=o):console.log(`skip invalid key (${b})`)}return n}static attributes2object(n,e,i){let r=null,o=n.length;for(let s=0;s<o;s++){let a=parseInt(n[s]);if(r&&!Number.isNaN(a)&&!Array.isArray(e)&&Object.keys(r).length&&(r[i]=[],e=r[i]),i=Number.isNaN(a)?n[s]:a,Array.isArray(e)&&"number"!=typeof i)return console.warn("Array\u306b\u306findex\u306e\u633f\u5165\u3057\u304b\u8a31\u53ef\u3057\u306a\u3044"),{obj:e,key:null};s+1<o&&(null==e[i]&&(e[i]="number"==typeof i?[]:{}),r=e,e=e[i])}return{obj:e,key:i}}static parseInnerXml(n){return null}}class pl{constructor(n=bo.generateUuid()){this.context={aliasName:this.constructor.aliasName,identifier:"",majorVersion:0,minorVersion:0,syncData:{}},this.context.identifier=n}static get aliasName(){return na.instance.getAlias(this)}get aliasName(){return this.context.aliasName}get identifier(){return this.context.identifier}get version(){return this.context.majorVersion+this.context.minorVersion}initialize(){Ct.instance.add(this)}destroy(){Ct.instance.delete(this)}onStoreAdded(){}onStoreRemoved(){}update(){this.versionUp(),Ct.instance.update(this.identifier)}versionUp(){this.context.majorVersion+=1,this.context.minorVersion=Math.random()}apply(n){null!==n&&this.identifier===n.identifier&&(this.context.majorVersion=n.majorVersion,this.context.minorVersion=n.minorVersion,this.context.syncData=n.syncData)}clone(){const n=this.toXml();return gi.instance.parseXml(n)}complement(){}toContext(){return{aliasName:this.context.aliasName,identifier:this.context.identifier,majorVersion:this.context.majorVersion,minorVersion:this.context.minorVersion,syncData:FT(this.context.syncData)}}toXml(){return gi.instance.toXml(this)}}function FT(t){if(null==t)return t;let n=Array.isArray(t)?[]:{},e=Object.getOwnPropertyNames(t);for(let i of e){let r=typeof t[i];null!=t[i]&&"object"===r?n[i]=FT(t[i]):"function"!==r&&(n[i]=t[i])}return n}var ia;let ni=ia=class extends pl{constructor(){super(...arguments),this.value="",this.attributes={},this.parentIdentifier="",this.majorIndex=0,this.minorIndex=Math.random(),this._children=[],this.needsSort=!0}get index(){return this.majorIndex+this.minorIndex}set index(n){this.majorIndex=0|n,this.minorIndex=n-this.majorIndex,this.parent&&(this.parent.needsSort=!0)}get parent(){return Ct.instance.get(this.parentIdentifier)}get parentId(){return this.parentIdentifier}get parentIsAssigned(){return 0<this.parentIdentifier.length}get parentIsUnknown(){return this.parentIsAssigned&&null==Ct.instance.get(this.parentIdentifier)}get parentIsDestroyed(){return this.parentIsAssigned&&Ct.instance.isDeleted(this.parentIdentifier)}get children(){return this.needsSort&&(this.needsSort=!1,this._children.sort((n,e)=>n.index-e.index)),this._children.concat()}destroy(){super.destroy();for(let n of this._children.concat())n.destroy();this._children=[]}onStoreAdded(){super.onStoreAdded(),this.initializeChildren()}onStoreRemoved(){super.onStoreRemoved(),this.parent&&this.parent.removeChild(this)}onChildAdded(n){}onChildRemoved(n){}_onChildAdded(n){let e=this;for(;e&&(e.onChildAdded(n),e=e.parent,e!==this););}_onChildRemoved(n){let e=this;for(;e&&(e.onChildRemoved(n),e=e.parent,e!==this););}initializeChildren(){if(null==ia.unknownNodes[this.identifier])return;let n=ia.unknownNodes[this.identifier];for(let e of n)e.parent===this&&this.updateChildren(e);ia.unknownNodes[this.identifier]&&delete ia.unknownNodes[this.identifier]}updateChildren(n=this){let e=this._children.indexOf(n),i=!1,r=n.parent===this;if(e<0&&r)this._children.push(n),e=this._children.length-1,i=!0;else{if(0<=e&&!r)return this._children.splice(e,1),void this._onChildRemoved(n);if(e<0&&!r)return}let o=this._children.length;o&&((this._children[e-1<0?0:e-1].index>n.index||n.index>this._children[o-1<e+1?o-1:e+1].index)&&(this.needsSort=!0),i&&this._onChildAdded(n))}updateIndexs(){let n=this.children;for(let e=0;e<n.length;e++)n[e].majorIndex=e,n[e].minorIndex=Math.random()}appendChild(n){if(n.contains(this))return null;n.parent&&n.parent!==this&&n.parent.removeChild(n);let e=0<this.children.length?this.children[this.children.length-1].majorIndex+1:0;return n.parentIdentifier=this.identifier,n.majorIndex=e,n.minorIndex=Math.random(),this.updateChildren(n),n}insertBefore(n,e){if(n.contains(this))return null;if(n===e&&n.parent===this)return n;n.parent&&n.parent!==this&&n.parent.removeChild(n);let i=this.children.indexOf(e);if(i<0)return this.appendChild(n);n.parentIdentifier=this.identifier;let r=0<i?this.children[i-1].index:0,o=e.index-r,s=r+o*(.45+.1*Math.random());return n.majorIndex=0|s,n.minorIndex=s-n.majorIndex,this.updateChildren(n),o<1e-7&&this.updateIndexs(),n}removeChild(n){return this.children.indexOf(n)<0?null:(n.parentIdentifier="",n.majorIndex=0,n.minorIndex=Math.random(),this.updateChildren(n),n)}contains(n){let e=n.parent;for(;e;){if(e===n)return console.error("\u3042 \u3084\u3063\u3079\u3001\u5faa\u74b0\u53c2\u7167",n),!1;if(e===this)return!0;e=e.parent}return!1}setAttribute(n,e){this.attributes[n]=e,this.update()}getAttribute(n){return this.attributes[n]??""}removeAttribute(n){delete this.attributes[n],this.update()}toAttributes(){return gi.toAttributes(this.attributes)}parseAttributes(n){gi.parseAttributes(this.attributes,n)}innerXml(){let n="";n+=Fa.encodeEntityReference(this.value+"");for(let e of this.children)n+=gi.instance.toXml(e);return n}parseInnerXml(n){let e=n.children,i=e.length;if(0<i)for(let r=0;r<i;r++){let o=gi.instance.parseXml(e[r]);o instanceof ia&&this.appendChild(o)}else this.value=Fa.decodeEntityReference(n.innerHTML)}apply(n){let e=this.parent;super.apply(n),e&&this.parent!==e&&e.updateChildren(this),this.parent?this.parent.updateChildren(this):this.parentIsAssigned&&(this.parentIdentifier in ia.unknownNodes||(ia.unknownNodes[this.parentIdentifier]=[]),ia.unknownNodes[this.parentIdentifier].push(this))}};function mi(t){return n=>{OT(t)(n)}}function bt(){return(t,n)=>{t instanceof ni?function zz(){return(t,n)=>{Object.defineProperty(t,n,{get:function e(){return this.getAttribute(n)},set:function i(r){this.setAttribute(n,r)},enumerable:!0,configurable:!0})}}()(t,n):Au()(t,n)}}ni.unknownNodes={},$e([Au()],ni.prototype,"value",void 0),$e([Au()],ni.prototype,"attributes",void 0),$e([Au()],ni.prototype,"parentIdentifier",void 0),$e([Au()],ni.prototype,"majorIndex",void 0),$e([Au()],ni.prototype,"minorIndex",void 0),ni=ia=$e([OT("node")],ni);class RT{constructor(n="Queue"){this.name=n,this.queue=Promise.resolve(),this._length=0}get length(){return this._length}add(n){this._length++,console.log(`${this.name} add: ${this._length}`),this.queue=this.queue.then("function"==typeof n.then?()=>n:0<n.length?()=>new Promise(n):n);let e=this.queue;return this.queue=this.queue.catch(i=>{console.error(i)}),this.queue=this.queue.then(()=>{this._length--,console.log(`${this.name} done: ${this._length}`)}),e}}var pt;!function(t){const n=new RegExp(["\ud83c[\udf00-\udfff]","\ud83d[\udc00-\ude4f]","\ud83d[\ude80-\udeff]","\ud7c9[\ude00-\udeff]","[\u2600-\u27bf]"].join("|"));t.toHalfWidth=function e(ge){return ge.replace(/[\uff01-\uff5e]/g,xe=>String.fromCharCode(xe.charCodeAt(0)-65248))},t.isEmote=function i(ge){return!!ge&&(ge=this.cr(ge).replace(/[\s\r\n]/g,""),Array.from(ge).length<=3&&!/[\u300c\u300d]/.test(ge)&&(n.test(ge)||/[$\uff04\\\uffe5\uff01\uff1f\u2755\u2762\u203d\u203c/!/?\u2665\u266a\u266c\u2669\u266b\u263a\ud83e\udd2e\u2764\ufe0f\u2620\ufe0f]/.test(ge)))},t.cr=function r(ge){if(!ge)return"";let xe="",ke="";return[...ge].forEach(Pe=>{if(ke){switch(Pe){case"n":case"\uff4e":xe+="\n";break;case"\\":case"\uffe5":xe+=Pe;break;default:xe+=ke+Pe}ke=""}else"\\"==Pe||"\uffe5"==Pe?ke=Pe:xe+=Pe}),xe},t.validUrl=function o(ge){if(!ge)return!1;try{new URL(ge.trim())}catch{return!1}return/^https?\:\/\//.test(ge.trim())},t.sameOrigin=function s(ge){if(!ge)return!1;try{return new URL(ge).origin===window.location.origin}catch{return!1}},t.escapeHtml=function a(ge){return"string"!=typeof ge&&(ge=ge.toString()),ge.replace(/[&'`"<>]/g,function(xe){return{"&":"&amp;","'":"&#x27;","`":"&#x60;",'"':"&quot;","<":"&lt;",">":"&gt;"}[xe]})},t.rubyToHtml=function h(ge){return"string"!=typeof ge&&(ge=ge.toString()),ge.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g,"<ruby>$1<rp>(</rp><rt>$2</rt><rp>)</rp></ruby>")},t.rubyToText=function b(ge){return"string"!=typeof ge&&(ge=ge.toString()),ge.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g,"$1($2)")},t.aliasNameToClassName=function ee(ge){switch(ge){case"character":return"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc";case"cut-in":return"\u30ab\u30c3\u30c8\u30a4\u30f3";case"dice-roll-table":return"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868";case"terrain":return"\u5730\u5f62";case"table-mask":return"\u30de\u30c3\u30d7\u30de\u30b9\u30af";case"text-note":return"\u5171\u6709\u30e1\u30e2";case"card":return"\u30ab\u30fc\u30c9";case"dice-symbol":return"\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb";case"card-stack":return"\u5c71\u672d";case"game-table":return"\u30c6\u30fc\u30d6\u30eb";case"chat-tab":return"\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6";case"range":return"\u5c04\u7a0b\u30fb\u7bc4\u56f2";default:return ge}},t.textShadowColor=function de(ge,xe="#ffffff",ke="#333333"){return ge&&/^\#[0-9a-f]{6}$/i.test(ge)&&ge.substring(1,7).match(/.{2}/g).reduce((Pe,Oe)=>Pe+parseInt(Oe,16),0)>510?ke:xe}}(pt||(pt={}));class Gt{constructor(){this.imageHash={},console.log("ImageStorage ready...")}static get instance(){return Gt._instance||(Gt._instance=new Gt),Gt._instance}get images(){let n=[];for(let e in this.imageHash)n.push(this.imageHash[e]);return n}destroy(){for(let n in this.imageHash)this.delete(n)}addAsync(n){var e=this;return(0,gn.Z)(function*(){let i=yield on.createAsync(n);return e._add(i)})()}add(n){let e;if("string"==typeof n)e=on.create(n);else if(n instanceof on)e=n;else{if(this.update(n))return this.imageHash[n.identifier];e=on.create(n)}return this._add(e)}_add(n){return Gi.COMPLETE<=n.state&&this.lazySynchronize(100),this.update(n)?this.imageHash[n.identifier]:(this.imageHash[n.identifier]=n,console.log("add Image: "+n.identifier),n)}update(n){let e;e=n instanceof on?n.toContext():n;let i=this.imageHash[n.identifier];return!!i&&(i.apply(n),!0)}delete(n){let e=this.imageHash[n];return!!e&&(e.destroy(),delete this.imageHash[n],!0)}get(n){return this.imageHash[n]||null}synchronize(n){this.lazyTimer&&this.lazyTimer.stop(),Ue.call("SYNCHRONIZE_FILE_LIST",this.getCatalog(),n)}lazySynchronize(n,e){null==this.lazyTimer&&(this.lazyTimer=new Oa(()=>this.synchronize(e),n)),this.lazyTimer.reset(n)}getCatalog(){let n=[];for(let e of this.images)Gi.COMPLETE<=e.state&&n.push({identifier:e.identifier,state:e.state});return n}}var mn,kn=_e(4424);let Qe=mn=class extends pl{constructor(){super(...arguments),this.userId="",this.peerId="",this.name="",this.imageIdentifier="",this.color=mn.CHAT_DEFAULT_COLOR,this.isGMMode=!1}get isMine(){return mn.myCursor&&mn.myCursor===this}get image(){return Gt.instance.get(this.imageIdentifier)}onStoreAdded(){super.onStoreAdded(),this.isMine||Ue.register(this).on("DISCONNECT_PEER",n=>{n.data.peerId===this.peerId&&setTimeout(()=>{Ot.peerIds.includes(this.peerId)||(mn.userIdMap.delete(this.userId),mn.peerIdMap.delete(this.peerId),Ct.instance.remove(this))},3e4)})}onStoreRemoved(){super.onStoreRemoved(),Ue.unregister(this),mn.userIdMap.delete(this.userId),mn.peerIdMap.delete(this.peerId)}static findByUserId(n){return this.find(mn.userIdMap,n,!0)}static findByPeerId(n){return this.find(mn.peerIdMap,n,!1)}static find(n,e,i){let r=n.get(e);if(null!=r&&Ct.instance.get(r))return Ct.instance.get(r);let o=Ct.instance.getObjects(mn);for(let s of o){let a=i?s.userId:s.peerId;if(a===e)return n.set(a,s.identifier),s}return null}static createMyCursor(){return(0,gn.Z)(function*(){if(mn.myCursor)return console.warn("It is already created."),mn.myCursor;mn.myCursor=new mn,mn.myCursor.peerId=Ot.peerId,mn.myCursor.initialize();try{try{window.localStorage&&localStorage.getItem(mn.CHAT_MY_NAME_LOCAL_STORAGE_KEY)&&(mn.myCursor.name=localStorage.getItem(mn.CHAT_MY_NAME_LOCAL_STORAGE_KEY),yield kn.setItem(mn.CHAT_MY_NAME_LOCAL_STORAGE_KEY,mn.myCursor.name,()=>{localStorage.removeItem(mn.CHAT_MY_NAME_LOCAL_STORAGE_KEY)}))}catch(n){console.log(n)}try{window.localStorage&&localStorage.getItem(mn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)&&(mn.myCursor.color=localStorage.getItem(mn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY),yield kn.setItem(mn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY,mn.myCursor.color,()=>{localStorage.removeItem(mn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)}))}catch(n){console.log(n)}yield kn.getItem(mn.CHAT_MY_NAME_LOCAL_STORAGE_KEY).then(n=>{"string"==typeof n?mn.myCursor.name=n:void 0!==n&&kn.removeItem(mn.CHAT_MY_NAME_LOCAL_STORAGE_KEY)}),yield kn.getItem(mn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY).then(n=>{"string"==typeof n&&/^\#[0-9a-f]{6}$/.test(n.trim().toLowerCase())?mn.myCursor.color=n.trim().toLowerCase():void 0!==n&&kn.removeItem(mn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)});try{yield kn.getItem(mn.CHAT_MY_ICON_LOCAL_STORAGE_KEY).then(n=>{let e=null;if("string"==typeof n)if(n.startsWith("data:image/")){const i=n.substring(5,n.indexOf(";")),r=atob(n.replace(/^.*,/,""));let o=new Uint8Array(r.length);for(let s=0;s<r.length;s++)o[s]=r.charCodeAt(s);e=new Blob([o.buffer],{type:i})}else Gt.instance.images.find(r=>r.identifier===n)?mn.myCursor.imageIdentifier=n:kn.removeItem(mn.CHAT_MY_ICON_LOCAL_STORAGE_KEY);else n instanceof Blob?e=n:kn.removeItem(mn.CHAT_MY_ICON_LOCAL_STORAGE_KEY);e&&on.createAsync(e).then(i=>{i.state===Gi.COMPLETE?(Gt.instance.add(i),mn.myCursor.imageIdentifier=i.identifier):kn.removeItem(mn.CHAT_MY_ICON_LOCAL_STORAGE_KEY)})}).catch(n=>{throw n})}catch(n){console.log(n),kn.removeItem(mn.CHAT_MY_ICON_LOCAL_STORAGE_KEY)}}catch(n){console.log(n),yield kn.removeItem(mn.CHAT_MY_NAME_LOCAL_STORAGE_KEY).catch(e=>console.log(e)),yield kn.removeItem(mn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY).catch(e=>console.log(e))}return mn.myCursor})()}apply(n){let e=n.syncData.userId,i=n.syncData.peerId;e!==this.userId&&(mn.userIdMap.set(e,this.identifier),mn.userIdMap.delete(this.userId)),i!==this.peerId&&(mn.peerIdMap.set(i,this.identifier),mn.peerIdMap.delete(this.peerId)),super.apply(n)}isPeerAUdon(){return null!=/u.*d.*o.*n/gi.exec(this.peerId)}};Qe.isGMHold=!1,Qe.CHAT_MY_NAME_LOCAL_STORAGE_KEY="udonanaumu-chat-my-name-local-storage",Qe.CHAT_MY_COLOR_LOCAL_STORAGE_KEY="udonanaumu-chat-my-color-local-storage",Qe.CHAT_MY_ICON_LOCAL_STORAGE_KEY="udonanaumu-chat-my-icon-local-storage",Qe.CHAT_DEFAULT_COLOR="#444444",Qe.CHAT_DEFAULT_NAME="\u30d7\u30ec\u30a4\u30e4\u30fc",Qe.CHAT_TRANSPARENT_COLOR="#ffffff",Qe.myCursor=null,Qe.userIdMap=new Map,Qe.peerIdMap=new Map,$e([bt()],Qe.prototype,"userId",void 0),$e([bt()],Qe.prototype,"peerId",void 0),$e([bt()],Qe.prototype,"name",void 0),$e([bt()],Qe.prototype,"imageIdentifier",void 0),$e([bt()],Qe.prototype,"color",void 0),$e([bt()],Qe.prototype,"isGMMode",void 0),Qe=mn=$e([mi("PeerCursor")],Qe);let Pu=class extends ni{constructor(){super(...arguments),this.dicebot="",this.paletteColor="",this._palettes=[],this._paletteLines=[],this._paletteVariables=[],this.isAnalized=!1}get color(){return this.paletteColor&&this.paletteColor!=Qe.CHAT_TRANSPARENT_COLOR?this.paletteColor:Qe.myCursor&&Qe.myCursor.color!=Qe.CHAT_TRANSPARENT_COLOR?Qe.myCursor.color:Qe.CHAT_DEFAULT_COLOR}set color(n){this.paletteColor=n}get paletteLines(){return this.isAnalized||this.parse(this.value),this._paletteLines}get paletteVariables(){return this.isAnalized||this.parse(this.value),this._paletteVariables}getPalette(){return this.isAnalized||this.parse(this.value),this._palettes}setPalette(n){this.value=n,this.isAnalized=!1}evaluate(n,e){let i="";i="string"==typeof n?n:n.palette;let o=0,s=!0;for(;s;)o++,s=!1,i=i.replace(/[{\uff5b]\s*([^{}\uff5b\uff5d]+)\s*[}\uff5d]/g,(a,h)=>{s=!0;let b="";for(let ee of this.paletteVariables)pt.toHalfWidth(ee.name.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).toLowerCase()===pt.toHalfWidth(h.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).toLowerCase()&&(b=ee.value);if(e){let ee=e.getFirstElementByNameUnsensitive(h);return ee?(b=ee.isNumberResource?ee.currentValue:ee.isCheckProperty?ee.checkValue():ee.isAbilityScore?ee.calcAbilityScore():ee.value,null==b&&(b="")):(ee=e.getFirstElementByNameUnsensitive(h,/^\u6700\u5927/)||e.getFirstElementByNameUnsensitive(h,/^Max[\:\_\-\s]*/i)||e.getFirstElementByNameUnsensitive(h,/^\u521d\u671f/)||e.getFirstElementByNameUnsensitive(h,/\u521d\u671f\u5024$/)||e.getFirstElementByNameUnsensitive(h,/\u6700\u5927\u5024$/))&&(ee.isNumberResource||ee.isAbilityScore)||(ee=e.getFirstElementByNameUnsensitive(h,/^\u57fa\u672c/)||e.getFirstElementByNameUnsensitive(h,/^\u539f/)||e.getFirstElementByNameUnsensitive(h,/^\^/)||e.getFirstElementByNameUnsensitive(h,/\u57fa\u672c\u5024$/)||e.getFirstElementByNameUnsensitive(h,/\u539f\u70b9$/))&&(ee.isNumberResource||ee.isAbilityScore)?b=ee.value:(ee=e.getFirstElementByNameUnsensitive(h,/\u4fee\u6b63\u5024?$/)||e.getFirstElementByNameUnsensitive(h,/\s*Mod(ifier|\.)?$/i)||e.getFirstElementByNameUnsensitive(h,/\u30dc\u30fc\u30ca\u30b9$/))&&ee.isAbilityScore&&(b=ee.calcAbilityScore()),b+""}return""}),128<o&&(s=!1);return i}parse(n){this._palettes=n.split("\n"),this._paletteLines=[],this._paletteVariables=[];for(let e of this._palettes){let i=this.parseVariable(e);i?this._paletteVariables.push(i):this._paletteLines.push({palette:e})}this.isAnalized=!0}parseVariable(n){let e=/^\s*[/\uff0f]{2}([^=\uff1d{}\uff5b\uff5d\s]+)\s*[=\uff1d]\s*(.+)\s*/gi.exec(n);return e?{name:pt.toHalfWidth(e[1]),value:e[2]}:null}apply(n){super.apply(n),this.isAnalized=!1}};var gl;$e([bt()],Pu.prototype,"dicebot",void 0),$e([bt()],Pu.prototype,"paletteColor",void 0),Pu=$e([mi("chat-palette")],Pu);let St=gl=class extends ni{get isSimpleNumber(){return null!=this.type&&"simpleNumber"===this.type}get isNumberResource(){return null!=this.type&&"numberResource"===this.type}get isCheckProperty(){return null!=this.type&&"checkProperty"===this.type}get isNote(){return null!=this.type&&"note"===this.type}get isAbilityScore(){return null!=this.type&&"abilityScore"===this.type}get isUrl(){return null!=this.type&&"url"===this.type}static create(n,e="",i={},r=""){let o;return o=r&&0<r.length?new gl(r):new gl,o.attributes=i,o.name=n,o.value=e,o.initialize(),o}getElementsByName(n){let e=[];for(let i of this.children)i instanceof gl&&(i.getAttribute("name")===n&&e.push(i),Array.prototype.push.apply(e,i.getElementsByName(n)));return e}getElementsByType(n){let e=[];for(let i of this.children)i instanceof gl&&(i.getAttribute("type")===n&&e.push(i),Array.prototype.push.apply(e,i.getElementsByType(n)));return e}getFirstElementByName(n){for(let e of this.children)if(e instanceof gl){if(e.getAttribute("name")===n)return e;let i=e.getFirstElementByName(n);if(i)return i}return null}getFirstElementByNameUnsensitive(n,e=null,i=""){for(let r of this.children)if(r instanceof gl){let o=pt.toHalfWidth(n.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).toLowerCase();if(null!=e&&(o=o.replace(e,i)),pt.toHalfWidth(r.getAttribute("name").replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).toLowerCase()===o)return r;let s=r.getFirstElementByNameUnsensitive(n,e,i);if(s)return s}return null}calcAbilityScore(){if(!this.isAbilityScore||!this.value)return 0;let n;return(n=this.currentValue.toString().match(/^div(\d+)$/))?Math.floor(+this.value/+n[1]):(n=this.currentValue.toString().match(/^DnD/))?Math.floor((+this.value-10)/2):+this.value}checkValue(){if(!this.isCheckProperty)return"0";let n=(this.currentValue+"").trim().split(/[|\uff5c]/g,2);return null==n[1]&&(n[1]="0",(null==n[0]||""===n[0].trim()&&!/[|\uff5c]/.test(this.currentValue+""))&&(n[0]="1")),n[this.value?0:1].trim()}};$e([bt()],St.prototype,"name",void 0),$e([bt()],St.prototype,"type",void 0),$e([bt()],St.prototype,"currentValue",void 0),St=gl=$e([mi("data")],St);let Pi=class extends ni{constructor(){super(...arguments),this.location={name:"table",x:0,y:0},this.posZ=0,this._imageFile=on.Empty,this._shadowImageFile=on.Empty,this._dataElements={},this.currntImageIndex=0,this.isUseIconToOverviewImage=!1,this.currntIconIndex=0,this.isAltitudeIndicate=!1,this.isInverse=!1,this.isHollow=!1,this.isBlackPaint=!1,this.aura=-1,this.isNotRide=!0,this.isInventoryIndicate=!0}get isVisibleOnTable(){return"table"===this.location.name}get rootDataElement(){for(let n of this.children)if(n.getAttribute("name")===this.aliasName)return n;return null}get imageDataElement(){return this.getElement("image")}get commonDataElement(){return this.getElement("common")}get detailDataElement(){return this.getElement("detail")}get imageElement(){if(!this.imageDataElement)return null;let n=this.imageDataElement.getElementsByName("imageIdentifier");return n[this.currntImageIndex<0?0:this.currntImageIndex>=n.length?n.length-1:this.currntImageIndex]}get imageFile(){if(!this.imageDataElement)return this._imageFile;let n=this.imageElement;if(n&&this._imageFile.identifier!==n.value){let e=Gt.instance.get(n.value);this._imageFile=e||on.Empty}return this._imageFile}get imageFiles(){return this.imageDataElement?this.imageDataElement.getElementsByName("imageIdentifier").map(e=>Gt.instance.get(e.value)||null).filter(e=>null!=e):[]}get faceIcon(){if(!this.imageDataElement)return null;let n=this.imageDataElement.getElementsByName("faceIcon");if(n){let e=n[this.currntIconIndex];return this.currntIconIndex<0&&(this.currntIconIndex=0),e?Gt.instance.get(e.value):null}return null}get faceIcons(){return this.imageDataElement?this.imageDataElement.getElementsByName("faceIcon").map(e=>Gt.instance.get(e.value)||null).filter(e=>null!=e):[]}get shadowImageFile(){if(!this.imageDataElement)return this._shadowImageFile;let n=this.imageDataElement.getFirstElementByName("shadowImageIdentifier");if(n&&this._shadowImageFile.identifier!==n.value){let e=Gt.instance.get(n.value);this._shadowImageFile=e||on.Empty}else{let e=this.imageElement;if(e&&this._shadowImageFile.identifier!==e.currentValue){let i=Gt.instance.get(e.currentValue);this._shadowImageFile=i||on.Empty}}return this._shadowImageFile}get altitude(){let n=this.getElement("altitude",this.commonDataElement),e=n?+n.value:0;return Number.isNaN(e)?0:e}set altitude(n){let e=this.getElement("altitude",this.commonDataElement);e&&(e.value=n)}get isHaveAltitude(){return!!this.getElement("altitude",this.commonDataElement)}get isGMMode(){return!!Qe.myCursor&&Qe.myCursor.isGMMode}createDataElements(){this.initialize();let n=this.aliasName;if(!this.rootDataElement){let e=St.create(n,"",{},n+"_"+this.identifier);this.appendChild(e)}this.imageDataElement||(this.rootDataElement.appendChild(St.create("image","",{},"image_"+this.identifier)),this.imageDataElement.appendChild(St.create("imageIdentifier","",{type:"image"},"imageIdentifier_"+this.identifier))),this.commonDataElement||this.rootDataElement.appendChild(St.create("common","",{},"common_"+this.identifier)),this.detailDataElement||this.rootDataElement.appendChild(St.create("detail","",{},"detail_"+this.identifier))}getElement(n,e=this.rootDataElement){if(!e)return null;let i=this._dataElements[n]?Ct.instance.get(this._dataElements[n]):null;return(!i||!e.contains(i))&&(i=e.getFirstElementByName(n),this._dataElements[n]=i?i.identifier:null),i}getCommonValue(n,e){let i=this.getElement(n,this.commonDataElement);if(!i)return e;if("number"==typeof e){let r=+i.value;return Number.isNaN(r)?e:r}return i.value+""}getUrls(){return this.rootDataElement.getElementsByType("url")}setCommonValue(n,e){let i=this.getElement(n,this.commonDataElement);!i||(i.value=e)}getImageFile(n){if(!this.imageDataElement)return null;let e=this.getElement(n,this.imageDataElement);return e?Gt.instance.get(e.value):null}setImageFile(n,e){let i=e?this.getElement(n,this.imageDataElement):null;!i||(i.value=e.identifier)}setLocation(n){this.location.name=n,this.update()}};$e([bt()],Pi.prototype,"location",void 0),$e([bt()],Pi.prototype,"posZ",void 0),$e([bt()],Pi.prototype,"currntImageIndex",void 0),$e([bt()],Pi.prototype,"isUseIconToOverviewImage",void 0),$e([bt()],Pi.prototype,"currntIconIndex",void 0),$e([bt()],Pi.prototype,"isAltitudeIndicate",void 0),$e([bt()],Pi.prototype,"isInverse",void 0),$e([bt()],Pi.prototype,"isHollow",void 0),$e([bt()],Pi.prototype,"isBlackPaint",void 0),$e([bt()],Pi.prototype,"aura",void 0),$e([bt()],Pi.prototype,"isNotRide",void 0),$e([bt()],Pi.prototype,"isInventoryIndicate",void 0),Pi=$e([mi("TabletopObject")],Pi);var Ui=(()=>(function(t){t[t.Default=1]="Default",t[t.Image=2]="Image",t[t.Postfix=3]="Postfix",t[t.PostfixOrImage=4]="PostfixOrImage",t[t.PostfixAndImage=5]="PostfixAndImage",t[t.NotConditionStandUp=6]="NotConditionStandUp"}(Ui||(Ui={})),Ui))();let ml=class extends St{constructor(){super(...arguments),this.position=5,this.height=35,this.overviewIndex=-1}get standElements(){return this.getElementsByName("stand")}add(n){let e=this.getFirstElementByName("stand")?Ui.NotConditionStandUp:Ui.Default,i=St.create("stand");i.appendChild(St.create("name","",{},"name_"+i.identifier)),i.appendChild(St.create("imageIdentifier",n&&n!=on.Empty.identifier?n:"stand_no_image",{type:"image"},"imageIdentifier_"+i.identifier)),i.appendChild(St.create("conditionType",e,{},"conditionType_"+i.identifier)),i.appendChild(St.create("height",0,{currentValue:0},"height_"+i.identifier)),i.appendChild(St.create("applyImageEffect","",{},"applyImageEffect_"+i.identifier)),i.appendChild(St.create("applyRoll","",{},"applyRoll_"+i.identifier)),i.appendChild(St.create("applyDialog","applyDialog",{},"applyDialog_"+i.identifier)),i.appendChild(St.create("showName","showName",{},"showName_"+i.identifier)),i.appendChild(St.create("postfix","",{},"postfix_"+i.identifier)),i.appendChild(St.create("position",0,{currentValue:""},"position_"+i.identifier)),i.appendChild(St.create("speakingImageIdentifier","",{type:"image"},"speakingImageIdentifier_"+i.identifier)),this.appendChild(i)}remove(n){this.removeChild(n)}matchStandInfo(n,e,i=null){const r=e instanceof on?e.identifier:e;let o="",s=!1,a=[];["\uff20\u9000\u53bb","@farewell"].forEach(xe=>{pt.toHalfWidth(n).trimRight().toUpperCase().endsWith(pt.toHalfWidth(xe).toUpperCase())&&(("@"==xe.slice(0,1)||"\uff20"==xe.slice(0,1))&&o.length<xe.length&&(o=xe),s=!0)});for(const xe of this.standElements){const ke=xe.getFirstElementByName("name");ke&&ke.value.toString()==i&&a.push(xe)}let h=1,b=!0,ee=[],de=[];for(const xe of this.standElements){if(!xe.getFirstElementByName("imageIdentifier")||!xe.getFirstElementByName("conditionType"))continue;const ke=xe.getFirstElementByName("conditionType").value;if(ke!=Ui.NotConditionStandUp)if(ke==Ui.Default)ee.push(xe);else{const Pe=xe.getFirstElementByName("postfix")?xe.getFirstElementByName("postfix").value.toString():null,Oe=xe.getFirstElementByName("targetImageIdentifier")?xe.getElementsByName("targetImageIdentifier").map(Ve=>Ve.value):[];let je=!1,qe=!1;if(Pe&&(ke==Ui.Postfix||ke==Ui.PostfixOrImage||ke==Ui.PostfixAndImage))for(let Ve of Pe.split(/[\r\n]+/g))null==Ve||0==Ve.trim().length||pt.toHalfWidth(n).toUpperCase().trimRight().endsWith(pt.toHalfWidth(Ve).trimRight().toUpperCase())&&(("@"==Ve.slice(0,1)||"\uff20"==Ve.slice(0,1))&&o.length<Ve.length&&(o=Ve),je=!0);Oe.length>0&&(ke==Ui.Image||ke==Ui.PostfixOrImage||ke==Ui.PostfixAndImage)&&(qe=r&&Oe.indexOf(r)>=0),(je&&(ke==Ui.Postfix||ke==Ui.PostfixOrImage)||qe&&(ke==Ui.Image||ke==Ui.PostfixOrImage)||je&&qe&&ke==Ui.PostfixAndImage)&&(b=!1,de.push(xe),h<+ke&&(h=+ke))}}i||(a=b?ee:de.filter(xe=>+xe.getFirstElementByName("conditionType").value==h));let ge={standElementIdentifier:null,matchMostLongText:o,farewell:s};return a&&a.length>0&&(ge.standElementIdentifier=a[Math.floor(Math.random()*a.length)].identifier),ge}};var ug;$e([bt()],ml.prototype,"position",void 0),$e([bt()],ml.prototype,"height",void 0),$e([bt()],ml.prototype,"overviewIndex",void 0),ml=$e([mi("stand-list")],ml);let sn=ug=class extends Pi{constructor(n=bo.generateUuid()){super(n),this.rotate=0,this.roll=0,this.isDropShadow=!0,this.isShowChatBubble=!0,this.owner="",this.text="",this.isEmote=!1,this.isLoaded=!1,this.chatBubbleAltitude=0,this.isAltitudeIndicate=!0}get name(){return this.getCommonValue("name","")}set name(n){this.setCommonValue("name",n)}get size(){return this.getCommonValue("size",1)}get height(){let n=this.getElement("height",this.commonDataElement),e=n?+n.value:0;return n&&n.currentValue&&(e=(Number.isNaN(e)?0:e)*this.size),Number.isNaN(e)?0:e}get chatPalette(){for(let n of this.children)if(n instanceof Pu)return n;return null}get ownerName(){let n=Qe.findByUserId(this.owner);return n?n.name:null}get ownerColor(){let n=Qe.findByUserId(this.owner);return n?n.color:"#444444"}get standList(){for(let e of this.children)if(e instanceof ml)return e;let n=new ml("StandList_"+this.identifier);return n.initialize(),this.appendChild(n),n}static create(n,e,i){let r=new ug;return r.createDataElements(),r.initialize(),r.createTestGameDataElement(n,e,i),r}get isHideIn(){return!!this.owner}get isVisible(){return!this.owner||Ot.peerContext.userId===this.owner}static get isStealthMode(){for(const n of Ct.instance.getObjects(ug))if(n.isHideIn&&n.isVisible&&"table"===n.location.name)return!0;return!1}complement(){let n=this.getElement("altitude",this.commonDataElement);!n&&this.commonDataElement&&this.commonDataElement.appendChild(St.create("altitude",0,{},"altitude_"+this.identifier)),n=this.getElement("height",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.insertBefore(St.create("height",0,{currentValue:""},"height_"+this.identifier),this.getElement("altitude",this.commonDataElement))}createTestGameDataElement(n,e,i){this.createDataElements();let r=St.create("name",n,{},"name_"+this.identifier),o=St.create("size",e,{},"size_"+this.identifier),s=St.create("height",0,{currentValue:""},"height_"+this.identifier),a=St.create("altitude",0,{},"altitude_"+this.identifier);this.imageDataElement.getFirstElementByName("imageIdentifier")&&(this.imageDataElement.getFirstElementByName("imageIdentifier").value=i);let h=St.create("\u30ea\u30bd\u30fc\u30b9","",{},"\u30ea\u30bd\u30fc\u30b9"+this.identifier),b=St.create("HP",200,{type:"numberResource",currentValue:"200"},"HP_"+this.identifier),ee=St.create("MP",100,{type:"numberResource",currentValue:"100"},"MP_"+this.identifier);this.commonDataElement.appendChild(r),this.commonDataElement.appendChild(o),this.commonDataElement.appendChild(s),this.commonDataElement.appendChild(a),this.detailDataElement.appendChild(h),h.appendChild(b),h.appendChild(ee);let de=St.create("\u60c5\u5831","",{},"\u60c5\u5831"+this.identifier);this.detailDataElement.appendChild(de),de.appendChild(St.create("\u8aac\u660e","\u3053\u3053\u306b\u8aac\u660e\u3092\u66f8\u304f\n\u3042\u3044\u3046\u3048\u304a",{type:"note"},"\u8aac\u660e"+this.identifier)),de.appendChild(St.create("\u30e1\u30e2","\u4efb\u610f\u306e\u6587\u5b57\u5217\n\uff11\n\uff12\n\uff13\n\uff14\n\uff15",{type:"note"},"\u30e1\u30e2"+this.identifier)),de.appendChild(St.create("\u53c2\u7167URL","https://www.example.com",{type:"url"},"\u53c2\u7167URL"+this.identifier)),de=St.create("\u80fd\u529b","",{},"\u80fd\u529b"+this.identifier),this.detailDataElement.appendChild(de),de.appendChild(St.create("\u5668\u7528\u5ea6",24,{type:"abilityScore",currentValue:"div6"},"\u5668\u7528\u5ea6"+this.identifier)),de.appendChild(St.create("\u654f\u6377\u5ea6",24,{type:"abilityScore",currentValue:"div6"},"\u654f\u6377\u5ea6"+this.identifier)),de.appendChild(St.create("\u7b4b\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u7b4b\u529b"+this.identifier)),de.appendChild(St.create("\u751f\u547d\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u751f\u547d\u529b"+this.identifier)),de.appendChild(St.create("\u77e5\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u77e5\u529b"+this.identifier)),de.appendChild(St.create("\u7cbe\u795e\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u7cbe\u795e\u529b"+this.identifier)),de=St.create("\u6226\u95d8\u7279\u6280","",{},"\u6226\u95d8\u7279\u6280"+this.identifier),this.detailDataElement.appendChild(de),de.appendChild(St.create("Lv1","\u5168\u529b\u653b\u6483",{},"Lv1"+this.identifier)),de.appendChild(St.create("Lv3","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9",{},"Lv3"+this.identifier)),de.appendChild(St.create("Lv5","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9\u2161",{},"Lv5"+this.identifier)),de.appendChild(St.create("Lv7","\u9811\u5f37",{},"Lv7"+this.identifier)),de.appendChild(St.create("Lv9","\u8599\u304e\u6255\u3044",{},"Lv9"+this.identifier)),de.appendChild(St.create("\u81ea\u52d5","\u6cbb\u7652\u9069\u6b63",{},"\u81ea\u52d5"+this.identifier)),(new DOMParser).parseFromString(this.rootDataElement.toXml(),"application/xml");let ke=new Pu("ChatPalette_"+this.identifier);ke.setPalette("\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u5165\u529b\u4f8b\uff1a\n2d6+1 \u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\n\uff11\uff44\uff12\uff10\uff0b{\u654f\u6377}\uff0b\uff5b\u683c\u95d8\uff5d\u3000{name}\u306e\u683c\u95d8\uff01\n//\u654f\u6377=10+{\u654f\u6377A}\n//\u654f\u6377A=10\n//\u683c\u95d8\uff1d\uff11"),ke.initialize(),this.appendChild(ke);let Pe=new ml("StandList_"+this.identifier);Pe.initialize(),this.appendChild(Pe)}};$e([bt()],sn.prototype,"rotate",void 0),$e([bt()],sn.prototype,"roll",void 0),$e([bt()],sn.prototype,"isDropShadow",void 0),$e([bt()],sn.prototype,"isShowChatBubble",void 0),$e([bt()],sn.prototype,"owner",void 0),sn=ug=$e([mi("character")],sn);let Ra=class extends ni{constructor(){super(...arguments),this.name="",this.command="",this.dice=""}parseText(){return this.value?this.value.split(/[\r\n]+/).map(n=>{let e=null;if(e=(n=n.trim()).match(/([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[\-\u2015\uff0d~\uff5e][\s\u3000]*([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[:\uff1a](.+)/)){const i=+pt.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-")),r=+pt.toHalfWidth(e[2].replace(/[\-\uff0d\u2010]/,"-"));return i<=r?{range:{start:i,end:r},result:e[3]}:{range:{start:r,end:i},result:e[3]}}if(e=n.match(/([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[\-\u2015\uff0d~\uff5e][\s\u3000]*[\*\uff0a][\s\u3000]*[:\uff1a](.+)/))return{range:{start:+pt.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-")),end:null},result:e[2]};if(e=n.match(/[\*\uff0a][\s\u3000]*[\-\u2015\uff0d~\uff5e][\s\u3000]*([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[:\uff1a](.+)/))return{range:{start:null,end:+pt.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-"))},result:e[2]};if(e=n.match(/([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[:\uff1a](.+)/)){const i=+pt.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-"));return{range:{start:i,end:i},result:e[2]}}return(e=n.match(/[\*\uff0a][\s\u3000]*[\-\u2015\uff0d~\uff5e][\*\uff0a][\s\u3000]*[:\uff1a](.+)/))||(e=n.match(/[\*\uff0a][\s\u3000]*[:\uff1a](.+)/))?{range:{start:null,end:null},result:e[1]}:null}).filter(n=>n):[]}};var as;$e([bt()],Ra.prototype,"name",void 0),$e([bt()],Ra.prototype,"command",void 0),$e([bt()],Ra.prototype,"dice",void 0),Ra=$e([mi("dice-roll-table")],Ra);let Ns=as=class extends ni{static get instance(){return as._instance||(as._instance=new as("DiceRollTableList"),as._instance.initialize()),as._instance}get diceRollTables(){return this.children}addDiceRollTable(...n){let e=null;if(n[0]instanceof Ra)e=n[0];else{let i=n[0];e=new Ra(n[1]),e.name=i,e.initialize()}return this.appendChild(e)}parseInnerXml(n){for(let i of as.instance.children)i.destroy();let e=as.instance.toContext();e.syncData=this.toContext().syncData,as.instance.apply(e),as.instance.update(),super.parseInnerXml.apply(as.instance,[n]),this.destroy()}};Ns=as=$e([mi("dice-roll-table-list")],Ns);var Mr=(()=>(function(t){t[t.NULL=0]="NULL",t[t.THUMBNAIL=1]="THUMBNAIL",t[t.COMPLETE=2]="COMPLETE",t[t.URL=1e3]="URL"}(Mr||(Mr={})),Mr))();class Ho{constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:""},this.isHidden=!1}get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob}get url(){return this.context.url}get isReady(){return Mr.NULL<this.state}get state(){return this.url||this.blob?this.url&&!this.blob?Mr.URL:Mr.COMPLETE:Mr.NULL}static createEmpty(n){let e=new Ho;return e.context.identifier=n,e}static create(n){if("string"==typeof n){let e=new Ho;return e.context.identifier=n,e.context.name=n,e.context.url=n,e}{let e=new Ho;return e.apply(n),e}}static createAsync(n){return(0,gn.Z)(function*(){return n instanceof File?yield Ho._createAsync(n,n.name):n instanceof Blob?yield Ho._createAsync(n):void 0})()}static _createAsync(n,e){return(0,gn.Z)(function*(){let i=yield Ps.readAsArrayBufferAsync(n),r=new Ho;return r.context.identifier=yield Ps.calcSHA256Async(i),r.context.name=e,r.context.blob=new Blob([i],{type:n.type}),r.context.type=r.context.blob.type,r.context.url=window.URL.createObjectURL(r.context.blob),r.context.name||(r.context.name=r.context.identifier),r})()}destroy(){this.revokeURLs()}apply(n){!this.context.identifier&&n.identifier&&(this.context.identifier=n.identifier),n.name&&(this.context.name=n.name),!this.context.blob&&n.blob&&(this.context.blob=n.blob),!this.context.type&&n.type&&(this.context.type=n.type),!this.context.url&&n.url&&(this.state!==Mr.URL&&window.URL.revokeObjectURL(this.context.url),this.context.url=n.url),this.createURLs()}createURLs(){this.state!==Mr.URL&&this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob))}revokeURLs(){this.state!==Mr.URL&&window.URL.revokeObjectURL(this.context.url)}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url}}}var Vo=(()=>(function(t){t[t.MASTER=0]="MASTER",t[t.AUDITION=1]="AUDITION",t[t.SOUND_EFFECT=2]="SOUND_EFFECT",t[t.NOTICE=3]="NOTICE"}(Vo||(Vo={})),Vo))();class tt{constructor(n){this.volumeType=Vo.MASTER,this.audio=n}static get audioContext(){return tt._audioContext||(tt._audioContext=new(window.AudioContext||window.webkitAudioContext)),tt._audioContext}static get isMute(){return tt._isMute}static set isMute(n){tt._isMute=n,tt.volume=tt._volume}static get volume(){return tt._volume}static set volume(n){tt._volume=n,tt.masterGainNode.gain.setTargetAtTime(tt.isMute?0:tt._volume,tt.audioContext.currentTime,.01)}static get isAuditionMute(){return tt._isAuditionMute}static set isAuditionMute(n){tt._isAuditionMute=n,tt.auditionVolume=tt._auditionVolume}static get auditionVolume(){return tt._auditionVolume}static set auditionVolume(n){tt._auditionVolume=n,tt.auditionGainNode.gain.setTargetAtTime(tt.isAuditionMute?0:tt._auditionVolume,tt.audioContext.currentTime,.01)}static get isSoundEffectMute(){return tt._isSoundEffectMute}static set isSoundEffectMute(n){tt._isSoundEffectMute=n,tt.soundEffectVolume=tt._soundEffectVolume}static get soundEffectVolume(){return tt._soundEffectVolume}static set soundEffectVolume(n){tt._soundEffectVolume=n,tt.soundEffectGainNode.gain.setTargetAtTime(tt.isSoundEffectMute?0:tt._soundEffectVolume,tt.audioContext.currentTime,.01)}static get isNoticeMute(){return tt._isNoticeMute}static set isNoticeMute(n){tt._isNoticeMute=n,tt.noticeVolume=tt._noticeVolume}static get noticeVolume(){return tt._noticeVolume}static set noticeVolume(n){tt._noticeVolume=n,tt.noticeGainNode.gain.setTargetAtTime(tt.isNoticeMute?0:tt._noticeVolume,tt.audioContext.currentTime,.01)}static get masterGainNode(){if(!tt._masterGainNode){let n=tt.audioContext.createGain();n.gain.setValueAtTime(tt._volume,tt.audioContext.currentTime),n.connect(tt.audioContext.destination),tt._masterGainNode=n}return tt._masterGainNode}static get auditionGainNode(){if(!tt._auditionGainNode){let n=tt.audioContext.createGain();n.gain.setValueAtTime(tt._auditionVolume,tt.audioContext.currentTime),n.connect(tt.audioContext.destination),tt._auditionGainNode=n}return tt._auditionGainNode}static get soundEffectGainNode(){if(!tt._soundEffectGainNode){let n=tt.audioContext.createGain();n.gain.setValueAtTime(tt._soundEffectVolume,tt.audioContext.currentTime),n.connect(tt.audioContext.destination),tt._soundEffectGainNode=n}return tt._soundEffectGainNode}static get noticeGainNode(){if(!tt._noticeGainNode){let n=tt.audioContext.createGain();n.gain.setValueAtTime(tt._noticeVolume,tt.audioContext.currentTime),n.connect(tt.audioContext.destination),tt._noticeGainNode=n}return tt._noticeGainNode}static get rootNode(){return tt.masterGainNode}static get auditionNode(){return tt.auditionGainNode}static get soundEffectNode(){return tt.soundEffectGainNode}static get noticeNode(){return tt.noticeGainNode}get audioElm(){return this._audioElm||(this._audioElm=new Audio,this._audioElm.onplay=()=>{},this._audioElm.onpause=()=>{this.mediaElementSource.disconnect()},this._audioElm.onended=()=>{this.mediaElementSource.disconnect()}),this._audioElm}get mediaElementSource(){return this._mediaElementSource||(this._mediaElementSource=tt.audioContext.createMediaElementSource(this.audioElm)),this._mediaElementSource}get volume(){return this.audioElm.volume}set volume(n){this.audioElm.volume=n}get loop(){return this.audioElm.loop}set loop(n){this.audioElm.loop=n}get paused(){return this.audioElm.paused}static play(n,e=1){this.playBufferAsync(n,e)}static playSoundEffect(n,e=1){this.playBufferAsyncBase(tt.soundEffectNode,n,e)}play(n=this.audio){if(this.stop(),this.audio=n,!this.audio)return;let e=this.audio.url;n.state===Mr.URL&&(tt.cacheMap.has(n.identifier)?e=tt.cacheMap.get(n.identifier).url:tt.createCacheAsync(n)),this.mediaElementSource.connect(this.getConnectingAudioNode()),this.audioElm.src=e,this.audioElm.load(),this.audioElm.play().catch(i=>{console.warn(i)})}pause(){this.audioElm.pause()}stop(){!this.audioElm||(this.pause(),this.audioElm.currentTime=0,this.audioElm.src="",this.audioElm.load(),this.mediaElementSource.disconnect())}getConnectingAudioNode(){switch(this.volumeType){case Vo.AUDITION:return tt.auditionNode;case Vo.SOUND_EFFECT:return tt.soundEffectNode;case Vo.NOTICE:return tt.noticeNode;default:return tt.rootNode}}static playBufferAsync(n,e=1){return(0,gn.Z)(function*(){tt.playBufferAsyncBase(tt.rootNode,n,e)})()}static playBufferAsyncBase(n,e,i=1){return(0,gn.Z)(function*(){let r=yield tt.createBufferSourceAsync(e);if(!r)return;let o=tt.audioContext.createGain();o.gain.setValueAtTime(i,tt.audioContext.currentTime),o.connect(n),r.connect(o),r.onended=()=>{r.stop(),r.disconnect(),o.disconnect(),r.buffer=null},r.start()})()}static createBufferSourceAsync(n){var e=this;return(0,gn.Z)(function*(){if(!n)return null;try{let i=n.blob;if(n.state===Mr.URL)if(tt.cacheMap.has(n.identifier))i=tt.cacheMap.get(n.identifier).blob;else{let s=yield tt.createCacheAsync(n);i=s&&s.blob?s.blob:null}if(!i)return null;let r=yield e.decodeAudioDataAsync(i),o=tt.audioContext.createBufferSource();return o.buffer=r,o}catch(i){return console.warn(i),null}})()}static decodeAudioDataAsync(n){return new Promise(function(){var e=(0,gn.Z)(function*(i,r){tt.audioContext.decodeAudioData(yield Ps.readAsArrayBufferAsync(n),o=>i(o),o=>r(o))});return function(i,r){return e.apply(this,arguments)}}())}static getBlobAsync(n){return(0,gn.Z)(function*(){if(n.blob)return n.blob;if(n.url.length<1)throw new Error("\u3048\u3063 \u306a\u306b\u305d\u308c\u6016\u3044");try{let e=yield fetch(n.url);if(!e.ok)throw new Error("Network response was not ok.");return yield e.blob()}catch(e){throw console.warn("There has been a problem with your fetch operation: ",e.message),e}})()}static createCacheAsync(n){return(0,gn.Z)(function*(){let e={url:n.url,blob:null};try{e.blob=yield tt.getBlobAsync(n)}catch(i){return console.error(i),e}return tt.cacheMap.has(n.identifier)?tt.cacheMap.get(n.identifier):(e.url=URL.createObjectURL(e.blob),tt.cacheMap.set(n.identifier,e),e)})()}static resumeAudioContext(){tt.audioContext.resume();let n=()=>{tt.audioContext.resume(),document.removeEventListener("touchstart",n,!0),document.removeEventListener("mousedown",n,!0),console.log("resumeAudioContext")};document.addEventListener("touchstart",n,!0),document.addEventListener("mousedown",n,!0)}}tt.AUDITION_VOLUME_LOCAL_STORAGE_KEY="udonanaumu-audio-player-audition-volume-local-storage",tt.MAIN_VOLUME_LOCAL_STORAGE_KEY="udonanaumu-audio-player-main-volume-local-storage",tt.SOUND_EFFECT_VOLUME_LOCAL_STORAGE_KEY="udonanaumu-audio-player-sound-effect-volume-local-storage",tt.NOTICE_VOLUME_LOCAL_STORAGE_KEY="udonanaumu-audio-player-notice-volume-local-storage",tt.AUDITION_IS_MUTE_LOCAL_STORAGE_KEY="udonanaumu-audio-player-audition-is-mute-local-storage",tt.MAIN_IS_MUTE_LOCAL_STORAGE_KEY="udonanaumu-audio-player-main-is-mute-local-storage",tt.SOUND_EFFECT_IS_MUTE_LOCAL_STORAGE_KEY="udonanaumu-audio-player-sound-effect-is-mute-local-storage",tt.NOTICE_IS_MUTE_LOCAL_STORAGE_KEY="udonanaumu-audio-player-notice-is-mute-local-storage",tt._isMute=!1,tt._volume=.5,tt._isAuditionMute=!1,tt._auditionVolume=.5,tt._isSoundEffectMute=!1,tt._soundEffectVolume=.5,tt._isNoticeMute=!1,tt._noticeVolume=.5,tt.cacheMap=new Map;class Xt{constructor(){this.hash={},console.log("AudioStorage ready...")}static get instance(){return Xt._instance||(Xt._instance=new Xt),Xt._instance}get audios(){let n=[];for(let e in this.hash)n.push(this.hash[e]);return n}destroy(){for(let n in this.hash)this.delete(n)}addAsync(n){var e=this;return(0,gn.Z)(function*(){let i=yield Ho.createAsync(n);return e._add(i)})()}add(n){let e;if("string"==typeof n)e=Ho.create(n);else if(n instanceof Ho)e=n;else{if(this.update(n))return this.hash[n.identifier];e=Ho.create(n)}return this._add(e)}_add(n){return Mr.COMPLETE<=n.state&&this.lazySynchronize(100),this.update(n)?this.hash[n.identifier]:(this.hash[n.identifier]=n,console.log("add Audio: "+n.identifier),n)}update(n){let e;e=n instanceof Ho?n.toContext():n;let i=this.hash[n.identifier];return!!i&&(i.apply(n),!0)}delete(n){let e=this.hash[n];return!!e&&(e.destroy(),delete this.hash[n],!0)}get(n){return this.hash[n]||null}synchronize(n){this.lazyTimer&&this.lazyTimer.stop(),Ue.call("SYNCHRONIZE_AUDIO_LIST",this.getCatalog(),n)}lazySynchronize(n,e){null==this.lazyTimer&&(this.lazyTimer=new Oa(()=>this.synchronize(e),n)),this.lazyTimer.reset(n)}getCatalog(){let n=[];for(let e of Xt.instance.audios)Mr.COMPLETE<=e.state&&n.push({identifier:e.identifier,state:e.state});return n}}var dg=(()=>(function(t){t.ACTION="action",t.SEPARATOR="separator"}(dg||(dg={})),dg))();const Ht={name:"",disabled:!0,type:dg.SEPARATOR};let hr=(()=>{class t{constructor(){this.title="",this.actions=[],this.position={x:0,y:0},this.titleColor=Qe.CHAT_DEFAULT_COLOR,this.titleBold=!1}get isShow(){return!!this.panelComponentRef}open(e,i,r,o,s,a){let h;this.close(),o||(o=t.defaultParentViewContainerRef,console.log("Context Open")),h=o.createComponent(t.ContextMenuComponentClass,{index:o.length,injector:o.injector});const b=h.injector.get(t);b.panelComponentRef=h,i&&(b.actions=i),e&&(b.position.x=e.x,b.position.y=e.y),b.titleColor=s||Qe.CHAT_DEFAULT_COLOR,b.titleBold=a,b.title=r??"",h.onDestroy(()=>{b.panelComponentRef=null})}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}}return t.ContextMenuComponentClass=null,t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=$n({token:t,factory:t.\u0275fac}),t})(),Ci=(()=>{class t{constructor(e){this.ngZone=e,this.callbackOnPointerDown=i=>this.onPointerDown(i),this.callbackOnPointerMove=i=>this.onPointerMove(i),this.callbackOnPointerUp=i=>this.onPointerUp(i),this.callbackOnContextMenu=i=>this.onContextMenu(i),this._isAllowedToOpenContextMenu=!1,this.pointers=[{x:0,y:0,z:0,identifier:-1}],this.startPostion=this.pointers[0],this.primaryPointer=this.pointers[0],this._isDragging=!1}get isAllowedToOpenContextMenu(){return this._isAllowedToOpenContextMenu}get pointer(){return this.primaryPointer}get pointerX(){return this.primaryPointer.x}get pointerY(){return this.primaryPointer.y}get isDragging(){return this._isDragging}set isDragging(e){e!==this._isDragging&&this.ngZone.run(()=>this._isDragging=e)}initialize(){this.addEventListeners()}destroy(){this.removeEventListeners()}onPointerDown(e){this.onPointerMove(e),this._isAllowedToOpenContextMenu=!0,this.startPostion=this.pointers[0]}onPointerMove(e){e.touches?this.onTouchMove(e):this.onMouseMove(e),this.targetElement=e.target}onPointerUp(e){this.onPointerMove(e)}onMouseMove(e){let i={x:e.pageX,y:e.pageY,z:0,identifier:-9999};this.isSyntheticEvent(i)||(this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(i),this.pointers=[i],this.primaryPointer=i)}onTouchMove(e){let i=e.touches.length;if(!(i<1)){this.pointers=[];for(let r=0;r<i;r++){let o=e.touches[r],s={x:o.pageX,y:o.pageY,z:0,identifier:o.identifier};this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(s),this.pointers.push(s)}this.primaryPointer=this.pointers[0]}}onContextMenu(e){this._isAllowedToOpenContextMenu=!0,this.onPointerUp(e)}preventContextMenuIfNeeded(e,i=3){i**2<(e.x-this.startPostion.x)**2+(e.y-this.startPostion.y)**2&&(this._isAllowedToOpenContextMenu=!1)}isSyntheticEvent(e,i=15){for(let r of this.pointers)if(r.identifier!==e.identifier&&(e.x-r.x)**2+(e.y-r.y)**2<i**2)return!0;return!1}addEventListeners(){this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.addEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.addEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.addEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.addEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.addEventListener("touchend",this.callbackOnPointerUp,!0),document.body.addEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.addEventListener("drop",this.callbackOnPointerUp,!0),document.body.addEventListener("contextmenu",this.callbackOnContextMenu,!0)})}removeEventListeners(){document.body.removeEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.removeEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.removeEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.removeEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.removeEventListener("touchend",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.removeEventListener("drop",this.callbackOnPointerUp,!0),document.body.removeEventListener("contextmenu",this.callbackOnContextMenu,!0)}}return t.\u0275fac=function(e){return new(e||t)(pn(Nn))},t.\u0275prov=$n({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();class _l extends u{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){const e=super._subscribe(n);return!e.closed&&n.next(this._value),e}getValue(){const{hasError:n,thrownError:e,_value:i}=this;if(n)throw e;return this._throwIfClosed(),i}next(n){super.next(this._value=n)}}function $l(...t){return Qi(t,Ko(t))}function LT(t,n,e){return e?LT(t,n).pipe(tf(e)):new F(i=>{const r=(...s)=>i.next(1===s.length?s[0]:s),o=t(r);return d(n)?()=>n(r,o):void 0})}function vl(...t){const n=Ko(t),e=Wo(t),{args:i,keys:r}=px(t);if(0===i.length)return Qi([],n);const o=new F(BT(i,n,r?s=>gx(r,s):D));return e?o.pipe(tf(e)):o}function BT(t,n,e=D){return i=>{zT(n,()=>{const{length:r}=t,o=new Array(r);let s=r,a=r;for(let h=0;h<r;h++)zT(n,()=>{const b=Qi(t[h],n);let ee=!1;b.subscribe($(i,de=>{o[h]=de,ee||(ee=!0,a--),a||i.next(e(o.slice()))},()=>{--s||i.complete()}))},i)},i)}}function zT(t,n,e){t?uo(e,t,n):n()}function ra(t){return t<=0?()=>qa:C((n,e)=>{let i=0;n.subscribe($(e,r=>{++i<=t&&(e.next(r),t<=i&&e.complete())}))})}function fg(...t){return function Hz(){return Pl(1)}()(Qi(t,Ko(t)))}function jT(...t){const n=Ko(t);return C((e,i)=>{(n?fg(t,e,n):fg(t,e)).subscribe(i)})}function UT(t,n,e){const i=d(t)||n||e?{next:t,error:n,complete:e}:t;return i?C((r,o)=>{var s;null===(s=i.subscribe)||void 0===s||s.call(i);let a=!0;r.subscribe($(o,h=>{var b;null===(b=i.next)||void 0===b||b.call(i,h),o.next(h)},()=>{var h;a=!1,null===(h=i.complete)||void 0===h||h.call(i),o.complete()},h=>{var b;a=!1,null===(b=i.error)||void 0===b||b.call(i,h),o.error(h)},()=>{var h,b;a&&(null===(h=i.unsubscribe)||void 0===h||h.call(i)),null===(b=i.finalize)||void 0===b||b.call(i)}))}):D}function uv(t){return C((n,e)=>{br(t).subscribe($(e,()=>e.complete(),N)),!e.closed&&n.subscribe(e)})}class Gz extends F{constructor(n,e){super(),this.source=n,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,m(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){const n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:n}=this;this._subject=this._connection=null,n?.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new w;const e=this.getSubject();n.add(this.source.subscribe($(e,void 0,()=>{this._teardown(),e.complete()},i=>{this._teardown(),e.error(i)},()=>this._teardown()))),n.closed&&(this._connection=null,n=w.EMPTY)}return n}refCount(){return function Vz(){return C((t,n)=>{let e=null;t._refCount++;const i=$(n,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount)return void(e=null);const r=t._connection,o=e;e=null,r&&(!o||r===o)&&r.unsubscribe(),n.unsubscribe()});t.subscribe(i),i.closed||(e=t.connect())})}()(this)}}const Wz={connector:()=>new u};function HT(t,n=Wz){const{connector:e}=n;return C((i,r)=>{const o=e();br(t(function qz(t){return new F(n=>t.subscribe(n))}(o))).subscribe(r),r.add(i.subscribe(o))})}function VT(t){return t?n=>HT(t)(n):n=>function Kz(t,n){const e=d(t)?t:()=>t;return d(n)?HT(n,{connector:e}):i=>new Gz(i,e)}(new u)(n)}function Af(t,n){return C((e,i)=>{let r=null,o=0,s=!1;const a=()=>s&&!r&&i.complete();e.subscribe($(i,h=>{r?.unsubscribe();let b=0;const ee=o++;br(t(h,ee)).subscribe(r=$(i,de=>i.next(n?n(h,de,ee,b++):de),()=>{r=null,a()}))},()=>{s=!0,a()}))})}function dv(...t){const n=Wo(t);return C((e,i)=>{const r=t.length,o=new Array(r);let s=t.map(()=>!1),a=!1;for(let h=0;h<r;h++)br(t[h]).subscribe($(i,b=>{o[h]=b,!a&&!s[h]&&(s[h]=!0,(a=s.every(D))&&(s=null))},N));e.subscribe($(i,h=>{if(a){const b=[h,...o];i.next(n?n(...b):b)}}))})}function Yz(t,n,e,i,r){return(o,s)=>{let a=e,h=n,b=0;o.subscribe($(s,ee=>{const de=b++;h=a?t(h,ee,de):(a=!0,ee),i&&s.next(h)},r&&(()=>{a&&s.next(h),s.complete()})))}}function Qz(t,n){return t===n}const{isArray:Jz}=Array;function e7(t){return 1===t.length&&Jz(t[0])?t[0]:t}function GT(...t){const n=Wo(t);return n?fe(GT(...t),tf(n)):C((e,i)=>{BT([e,...e7(t)])(i)})}function mc(t,n){return C((e,i)=>{let r=0;e.subscribe($(i,o=>t.call(n,o,r++)&&i.next(o)))})}const n7=["youtubeContainer"];let KT=(()=>{class t{constructor(e,i){this._ngZone=e,this._youtubeContainer=new u,this._destroyed=new u,this._playerChanges=new _l(void 0),this._videoId=new _l(void 0),this._height=new _l(390),this._width=new _l(640),this._startSeconds=new _l(void 0),this._endSeconds=new _l(void 0),this._suggestedQuality=new _l(void 0),this._playerVars=new _l(void 0),this.ready=this._getLazyEmitter("onReady"),this.stateChange=this._getLazyEmitter("onStateChange"),this.error=this._getLazyEmitter("onError"),this.apiChange=this._getLazyEmitter("onApiChange"),this.playbackQualityChange=this._getLazyEmitter("onPlaybackQualityChange"),this.playbackRateChange=this._getLazyEmitter("onPlaybackRateChange"),this._isBrowser=M$(i)}get videoId(){return this._videoId.value}set videoId(e){this._videoId.next(e)}get height(){return this._height.value}set height(e){this._height.next(e||390)}get width(){return this._width.value}set width(e){this._width.next(e||640)}set startSeconds(e){this._startSeconds.next(e)}set endSeconds(e){this._endSeconds.next(e)}set suggestedQuality(e){this._suggestedQuality.next(e)}get playerVars(){return this._playerVars.value}set playerVars(e){this._playerVars.next(e)}ngOnInit(){if(!this._isBrowser)return;let e=$l(!0);if(!window.YT||!window.YT.Player){const r=new u;this._existingApiReadyCallback=window.onYouTubeIframeAPIReady,window.onYouTubeIframeAPIReady=()=>{this._existingApiReadyCallback&&this._existingApiReadyCallback(),this._ngZone.run(()=>r.next(!0))},e=r.pipe(ra(1),jT(!1))}const i=function s7(t,n,e,i,r,o,s){const a=vl([n,o]).pipe(dv(vl([i,r])),se(([h,b])=>{const[ee,de]=h,[ge,xe]=b;return ee?{videoId:ee,playerVars:de,width:ge,height:xe}:void 0}));return vl([t,a,$l(s)]).pipe(function a7(t){return fe(GT(t),function t7(t){return C((n,e)=>{let i=!1,r=0;n.subscribe($(e,o=>(i||(i=!t(o,r++)))&&e.next(o)))})}(([n,e])=>!e),se(([n])=>n))}(e),function Zz(t,n){return C(Yz(t,n,arguments.length>=2,!0))}(l7,void 0),function Xz(t,n=D){return t=t??Qz,C((e,i)=>{let r,o=!0;e.subscribe($(i,s=>{const a=n(s);(o||!t(r,a))&&(o=!1,r=a,i.next(s))}))})}())}(this._youtubeContainer,this._videoId,e,this._width,this._height,this._playerVars,this._ngZone).pipe(UT(r=>{this._playerChanges.next(r)}),function o7(t){return Ls(n=>n?ZT(n)?$l(n):new F(e=>{let i=!1,r=!1;const o=s=>{r=!0,i||(s.target.removeEventListener("onReady",o),e.next(s.target))};return n.addEventListener("onReady",o),()=>{i=!0,r||t(n)}}).pipe(ra(1),jT(void 0)):$l(void 0))}(r=>{ZT(r)||r.destroy()}),uv(this._destroyed),VT());i.subscribe(r=>{this._player=r,r&&this._pendingPlayerState&&this._initializePlayer(r,this._pendingPlayerState),this._pendingPlayerState=void 0}),function i7(t,n,e){vl([t,n,e]).subscribe(([i,r,o])=>i&&i.setSize(r,o))}(i,this._width,this._height),function r7(t,n){vl([t,n]).subscribe(([e,i])=>e&&i&&e.setPlaybackQuality(i))}(i,this._suggestedQuality),function c7(t,n,e,i,r,o){const s=vl([e,i]).pipe(se(([ee,de])=>({startSeconds:ee,endSeconds:de}))),a=s.pipe(fv(t,ee=>!!ee&&!function u7(t){const n=t.getPlayerState();return n!==YT.PlayerState.UNSTARTED&&n!==YT.PlayerState.CUED}(ee))),h=n.pipe(fv(t,(ee,de)=>!!ee&&ee.videoId!==de));ga(t.pipe(fv(vl([n,s]),([ee,de],ge)=>!(!ge||ee==ge.videoId&&!de.startSeconds&&!de.endSeconds))),h,a).pipe(dv(vl([t,n,s,r])),se(([ee,de])=>de),uv(o)).subscribe(([ee,de,ge,xe])=>{!de||!ee||(ee.videoId=de,ee.cueVideoById({videoId:de,suggestedQuality:xe,...ge}))})}(i,this._videoId,this._startSeconds,this._endSeconds,this._suggestedQuality,this._destroyed),i.connect()}ngAfterViewInit(){this._youtubeContainer.next(this.youtubeContainer.nativeElement)}ngOnDestroy(){this._player&&(this._player.destroy(),window.onYouTubeIframeAPIReady=this._existingApiReadyCallback),this._playerChanges.complete(),this._videoId.complete(),this._height.complete(),this._width.complete(),this._startSeconds.complete(),this._endSeconds.complete(),this._suggestedQuality.complete(),this._youtubeContainer.complete(),this._playerVars.complete(),this._destroyed.next(),this._destroyed.complete()}playVideo(){this._player?this._player.playVideo():this._getPendingState().playbackState=YT.PlayerState.PLAYING}pauseVideo(){this._player?this._player.pauseVideo():this._getPendingState().playbackState=YT.PlayerState.PAUSED}stopVideo(){this._player?this._player.stopVideo():this._getPendingState().playbackState=YT.PlayerState.CUED}seekTo(e,i){this._player?this._player.seekTo(e,i):this._getPendingState().seek={seconds:e,allowSeekAhead:i}}mute(){this._player?this._player.mute():this._getPendingState().muted=!0}unMute(){this._player?this._player.unMute():this._getPendingState().muted=!1}isMuted(){return this._player?this._player.isMuted():!!this._pendingPlayerState&&!!this._pendingPlayerState.muted}setVolume(e){this._player?this._player.setVolume(e):this._getPendingState().volume=e}getVolume(){return this._player?this._player.getVolume():this._pendingPlayerState&&null!=this._pendingPlayerState.volume?this._pendingPlayerState.volume:0}setPlaybackRate(e){if(this._player)return this._player.setPlaybackRate(e);this._getPendingState().playbackRate=e}getPlaybackRate(){return this._player?this._player.getPlaybackRate():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackRate?this._pendingPlayerState.playbackRate:0}getAvailablePlaybackRates(){return this._player?this._player.getAvailablePlaybackRates():[]}getVideoLoadedFraction(){return this._player?this._player.getVideoLoadedFraction():0}getPlayerState(){if(this._isBrowser&&window.YT)return this._player?this._player.getPlayerState():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackState?this._pendingPlayerState.playbackState:YT.PlayerState.UNSTARTED}getCurrentTime(){return this._player?this._player.getCurrentTime():this._pendingPlayerState&&this._pendingPlayerState.seek?this._pendingPlayerState.seek.seconds:0}getPlaybackQuality(){return this._player?this._player.getPlaybackQuality():"default"}getAvailableQualityLevels(){return this._player?this._player.getAvailableQualityLevels():[]}getDuration(){return this._player?this._player.getDuration():0}getVideoUrl(){return this._player?this._player.getVideoUrl():""}getVideoEmbedCode(){return this._player?this._player.getVideoEmbedCode():""}_getPendingState(){return this._pendingPlayerState||(this._pendingPlayerState={}),this._pendingPlayerState}_initializePlayer(e,i){const{playbackState:r,playbackRate:o,volume:s,muted:a,seek:h}=i;switch(r){case YT.PlayerState.PLAYING:e.playVideo();break;case YT.PlayerState.PAUSED:e.pauseVideo();break;case YT.PlayerState.CUED:e.stopVideo()}null!=o&&e.setPlaybackRate(o),null!=s&&e.setVolume(s),null!=a&&(a?e.mute():e.unMute()),null!=h&&e.seekTo(h.seconds,h.allowSeekAhead)}_getLazyEmitter(e){return this._playerChanges.pipe(Af(i=>i?LT(r=>{i.addEventListener(e,r)},r=>{try{i.removeEventListener&&i.removeEventListener(e,r)}catch{}}):$l()),i=>new F(r=>i.subscribe({next:o=>this._ngZone.run(()=>r.next(o)),error:o=>r.error(o),complete:()=>r.complete()})),uv(this._destroyed))}}return t.\u0275fac=function(e){return new(e||t)(He(Nn),He(Vd))},t.\u0275cmp=fn({type:t,selectors:[["youtube-player"]],viewQuery:function(e,i){if(1&e&&wn(n7,5),2&e){let r;Cn(r=xn())&&(i.youtubeContainer=r.first)}},inputs:{videoId:"videoId",height:"height",width:"width",startSeconds:"startSeconds",endSeconds:"endSeconds",suggestedQuality:"suggestedQuality",playerVars:"playerVars",showBeforeIframeApiLoads:"showBeforeIframeApiLoads"},outputs:{ready:"ready",stateChange:"stateChange",error:"error",apiChange:"apiChange",playbackQualityChange:"playbackQualityChange",playbackRateChange:"playbackRateChange"},decls:2,vars:0,consts:[["youtubeContainer",""]],template:function(e,i){1&e&&mt(0,"div",null,0)},encapsulation:2,changeDetection:0}),t})();function l7(t,[n,e,i]){if(t&&e&&t.playerVars!==e.playerVars)t.destroy();else{if(!e)return void(t&&t.destroy());if(t)return t}const r=i.runOutsideAngular(()=>new YT.Player(n,e));return r.videoId=e.videoId,r.playerVars=e.playerVars,r}function ZT(t){return"getPlayerStatus"in t}function fv(t,n){return fe(dv(t),mc(([e,i])=>n(i,e)),se(([e])=>e))}let d7=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zo({type:t}),t.\u0275inj=Eo({}),t})();var Zi;!function(t){function e(i,r=0){return i=parseFloat(i),isNaN(i)?r:i}t.relation=function n(i,r,o=0){return"number"==typeof i?i:"string"==typeof i?(i=i.trim().toLowerCase()).indexOf("%")>0?e(i.replace("%",""),o)/100*r:i.indexOf("px")>0||i.indexOf("pt")>0?e(i.replace("px",""),o):i.indexOf("vw")>0?e(i.replace("vw",""),o)/100*window.innerWidth:i.indexOf("vh")>0?e(i.replace("vh",""),o)/100*window.innerHeight:i.indexOf("vm")>0?e(i.replace("vm",""),o)/100*Math.min(window.innerWidth,window.innerHeight):i.indexOf("em")>0?e(i.replace("em",""),o):"top"===i||"left"===i?0:"center"===i||"middle"===i?.5*r:"bottom"===i||"right"===i?r:o:o},t.parse=e}(Zi||(Zi={}));class ls{constructor(n,e={capture:!1,passive:!1,always:!1}){this.target=n,this.callbackOnMouse=this.onMouse.bind(this),this.callbackOnTouch=this.onTouch.bind(this),this.callbackOnMenu=this.onMenu.bind(this),this.lastPointers=[],this.primaryPointer={x:0,y:0,z:0,identifier:-9999},this._isDragging=!1,this._isGrabbing=!1,this._isDestroyed=!1,this.option=null,this.option={capture:!0===e.capture,passive:!0===e.passive,always:!0===e.always},this.initialize()}get pointer(){return this.primaryPointer}get isDragging(){return this._isDragging}get isGrabbing(){return this._isGrabbing}get isDestroyed(){return this._isDestroyed}initialize(){this.target.addEventListener("mousedown",this.callbackOnMouse,this.option.capture),this.target.addEventListener("touchstart",this.callbackOnTouch,this.option.capture),this.option.always&&this.addEventListeners()}destroy(){this.cancel(),this._isDestroyed=!0,this.target.removeEventListener("mousedown",this.callbackOnMouse,this.option.capture),this.target.removeEventListener("touchstart",this.callbackOnTouch,this.option.capture),this.removeEventListeners()}cancel(){this._isDragging=this._isGrabbing=!1,this.option.always||this.removeEventListeners()}onMouse(n){let e={x:n.pageX,y:n.pageY,z:0,identifier:-9999};this.isSyntheticEvent(e)||(this.lastPointers=[e],this.primaryPointer=e,this.onPointer(n))}onTouch(n){let e=n.changedTouches.length;if(!(e<1)){this.lastPointers=[];for(let i=0;i<e;i++){let r=n.changedTouches[i];this.lastPointers.push({x:r.pageX,y:r.pageY,z:0,identifier:r.identifier})}if("touchstart"===n.type)this.primaryPointer=this.lastPointers[0];else{let r=Array.from(n.changedTouches).find(s=>s.identifier===this.primaryPointer.identifier);if(null==r)return void(null!=Array.from(n.touches).find(a=>a.identifier===this.primaryPointer.identifier)||(this.onEnd&&this.onEnd(n),this.cancel()));this.primaryPointer={x:r.pageX,y:r.pageY,z:0,identifier:r.identifier}}this.onPointer(n)}}onPointer(n){switch(n.type){case"mousedown":case"touchstart":this._isGrabbing=!0,this._isDragging=!1,this.addEventListeners(),this.onStart&&this.onStart(n);break;case"mousemove":case"touchmove":this.onMove&&this.onMove(n),this._isDragging=this._isGrabbing;break;default:this.onEnd&&this.onEnd(n),this.cancel()}}onMenu(n){this.onContextMenu&&this.onContextMenu(n)}isSyntheticEvent(n,e=15){for(let i of this.lastPointers)if(i.identifier!==n.identifier&&(n.x-i.x)**2+(n.y-i.y)**2<e**2)return!0;return!1}addEventListeners(){let n={capture:this.option.capture,passive:this.option.passive};this.target.ownerDocument.addEventListener("mousemove",this.callbackOnMouse,n),this.target.ownerDocument.addEventListener("mouseup",this.callbackOnMouse,n),this.target.ownerDocument.addEventListener("touchmove",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("touchend",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("touchcancel",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("contextmenu",this.callbackOnMenu,n),this.target.ownerDocument.addEventListener("drop",this.callbackOnMouse,n)}removeEventListeners(){let n={capture:this.option.capture};this.target.ownerDocument.removeEventListener("mousemove",this.callbackOnMouse,n),this.target.ownerDocument.removeEventListener("mouseup",this.callbackOnMouse,n),this.target.ownerDocument.removeEventListener("touchmove",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("touchend",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("touchcancel",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("contextmenu",this.callbackOnMenu,n),this.target.ownerDocument.removeEventListener("drop",this.callbackOnMouse,n)}}let hv=(()=>{class t{constructor(e,i){this.ngZone=e,this.elementRef=i,this.isDisable=!1,this.boundsSelector="body",this.handleSelector="",this.unhandleSelector="input,textarea,button,select,option,span",this.stackSelector="",this.opacity=.7,this.allowOverHalf=!1,this.onstart=new Hn,this.onmove=new Hn,this.onend=new Hn,this.callbackOnResize=this.adjustPosition.bind(this),this.input=null,this.startPosition={x:0,y:0,z:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={x:0,y:0,z:0}}ngAfterViewInit(){this.initialize(),this.adjustPosition(),this.setForeground()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.input=new ls(this.elementRef.nativeElement),window.addEventListener("resize",this.callbackOnResize,!1)}),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this)}cancel(){this.input.cancel()}destroy(){window.removeEventListener("resize",this.callbackOnResize,!1),this.input.destroy()}onInputStart(e){if(this.isDisable)return this.cancel();if(1===e.button||2===e.button)return this.cancel();this.setForeground(),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=this.input.pointer,this.prevTrans={x:0,y:0,z:0};let i=this.isHandleElement(e.target),r=this.isUnhandleElement(e.target),o=null!=e.touches&&this.isScrollableElement(e.target);!i||r||o?this.cancel():(this.elementRef.nativeElement.style.cursor="grabbing",e.stopPropagation())}onInputMove(e){let i={x:this.input.pointer.x-this.startPointer.x,y:this.input.pointer.y-this.startPointer.y,z:this.input.pointer.z-this.startPointer.z},o=this.calcCorrectionPosition({x:i.x-this.prevTrans.x,y:i.y-this.prevTrans.y,z:i.z-this.prevTrans.z});i.x+=o.x,i.y+=o.y,i.z+=o.z,0<i.x**2+i.y**2+i.z**2&&(this.elementRef.nativeElement.style.opacity=this.opacity+""),this.elementRef.nativeElement.style.willChange="top, left",this.elementRef.nativeElement.style.left=i.x+this.startPosition.x+"px",this.elementRef.nativeElement.style.top=i.y+this.startPosition.y+"px",this.elementRef.nativeElement.style.cursor="grabbing",this.prevTrans=i,e.cancelable&&e.preventDefault(),e.stopPropagation()}onInputEnd(e){this.elementRef.nativeElement.style.opacity=null,this.elementRef.nativeElement.style.cursor=null,this.elementRef.nativeElement.style.willChange=null,this.input.isDragging&&e.cancelable&&(this.preventClickIfNeeded(e),e.preventDefault()),e.stopPropagation()}onContextMenu(e){e.stopPropagation()}preventClickIfNeeded(e){if(null!=e.touches)return;if(225>(this.input.pointer.x-this.startPointer.x)**2+(this.input.pointer.y-this.startPointer.y)**2+(this.input.pointer.z-this.startPointer.z)**2)return;let a=h=>{h.cancelable&&h.preventDefault(),h.stopPropagation()};this.elementRef.nativeElement.addEventListener("click",a,!0),queueMicrotask(()=>this.elementRef.nativeElement.removeEventListener("click",a,!0))}adjustPosition(){let e=this.calcElementPosition(this.elementRef.nativeElement),i=this.calcCorrectionPosition();this.elementRef.nativeElement.style.left=i.x+e.x+"px",this.elementRef.nativeElement.style.top=i.y+e.y+"px"}isHandleElement(e){return this.handleSelector.length<1||this.isContainsElement(e,this.handleSelector)}isUnhandleElement(e){return!(this.unhandleSelector.length<1)&&this.isContainsElement(e,this.unhandleSelector)}isContainsElement(e,i){let r=this.elementRef.nativeElement.querySelectorAll(i);for(let o=0;o<r.length;o++)if(r[o].contains(e))return!0;return!1}isScrollableElement(e){let i=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector),r=e,o=["scroll","auto"],s=["fixed","sticky","-webkit-sticky"];for(;r&&i!==r&&this.elementRef.nativeElement!==r;){let a=window.getComputedStyle(r);if(0<=o.indexOf(a.overflowY)&&r.offsetHeight<r.scrollHeight)return!0;if(0<=s.indexOf(a.position))return!1;r=r.parentElement}return!1}calcCorrectionPosition(e={x:0,y:0,z:0}){let i={x:0,y:0,z:0},r=this.elementRef.nativeElement.getBoundingClientRect(),o=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();if(this.allowOverHalf){const s=r.right-r.left,a=r.bottom-r.top;o.right+s/2<r.right+e.x&&(i.x+=o.right+s/2-(r.right+e.x)),r.left+e.x<o.left-s/2&&(i.x+=o.left-s/2-(r.left+e.x)),o.bottom+a/2<r.bottom+e.y&&(i.y+=o.bottom+a/2-(r.bottom+e.y)),r.top+e.y<o.top-a/2&&(i.y+=o.top-a/2-(r.top+e.y))}else o.right<r.right+e.x&&(i.x+=o.right-(r.right+e.x)),r.left+e.x<o.left&&(i.x+=o.left-(r.left+e.x)),o.bottom<r.bottom+e.y&&(i.y+=o.bottom-(r.bottom+e.y)),r.top+e.y<o.top&&(i.y+=o.top-(r.top+e.y));return i}calcElementPosition(e){let i=window.getComputedStyle(e);return{x:Zi.relation(i.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),y:Zi.relation(i.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),z:0}}setForeground(){if(this.stackSelector.length<1)return;let e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),i=0,r=99999;e.forEach(o=>{let s=parseInt(o.style.zIndex);i<s&&(i=s),s<r&&(r=s)}),!(i<=parseInt(this.elementRef.nativeElement.style.zIndex))&&(e.forEach(o=>{o.style.zIndex=parseInt(o.style.zIndex)-r+""}),this.elementRef.nativeElement.style.zIndex=i+1+"")}}return t.\u0275fac=function(e){return new(e||t)(He(Nn),He(Ai))},t.\u0275dir=hn({type:t,selectors:[["","appDraggable",""]],inputs:{isDisable:["draggable.disable","isDisable"],boundsSelector:["draggable.bounds","boundsSelector"],handleSelector:["draggable.handle","handleSelector"],unhandleSelector:["draggable.unhandle","unhandleSelector"],stackSelector:["draggable.stack","stackSelector"],opacity:["draggable.opacity","opacity"],allowOverHalf:["draggable.allowOverHalf","allowOverHalf"]},outputs:{onstart:"draggable.start",onmove:"draggable.move",onend:"draggable.end"}}),t})(),$i=(()=>{class t{constructor(e){this._sanitizer=e}transform(e,i="html"){switch(i){case"html":return this._sanitizer.bypassSecurityTrustHtml(e);case"style":return this._sanitizer.bypassSecurityTrustStyle(e);case"script":return this._sanitizer.bypassSecurityTrustScript(e);case"url":return this._sanitizer.bypassSecurityTrustUrl(e);case"resourceUrl":return this._sanitizer.bypassSecurityTrustResourceUrl(e);default:throw new Error(`Invalid safe type specified: ${i}`)}}}return t.\u0275fac=function(e){return new(e||t)(He(fx,16))},t.\u0275pipe=Pr({name:"safe",type:t,pure:!0}),t})();const f7=["cutInImageElement"],h7=["videoPlayerComponent"];function p7(t,n){1&t&&Pn(0)}const Pf=function(t,n,e,i,r,o,s){return{video:t,test:n,secret:e,minimaize:i,"is-bordered":r,"is-grab":o,"is-grabbing":s}};function g7(t,n){if(1&t){const e=ft();Q(0,"div",2,3),Ae("@cutInNone.done",function(){Re(e);const r=me();return Le(r.isVisible?null:r.end())})("dblclick",function(){return Re(e),Le(me().stop())})("mousedown",function(){return Re(e),Le(me().draggstart())})("mouseup",function(){return Re(e),Le(me().draggend())})("mouseleave",function(){return Re(e),Le(me().draggend())})("mouseout",function(){return Re(e),Le(me().draggend())})("mousemove",function(){Re(e);const r=me();return Le(!!r.isPointerDragging&&r.draggstart())}),Te(2,p7,1,0,"ng-container",4),ne()}if(2&t){const e=me(),i=cn(6);ut("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible&&!e.videoId?"auto":"none"),oe("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInNone",void 0)("ngClass",$u(17,Pf,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),G(2),oe("ngTemplateOutlet",i)}}function m7(t,n){1&t&&Pn(0)}function _7(t,n){if(1&t){const e=ft();Q(0,"div",2,3),Ae("@cutInFadeInOut.done",function(){Re(e);const r=me();return Le(r.isVisible?null:r.end())})("dblclick",function(){return Re(e),Le(me().stop())})("mousedown",function(){return Re(e),Le(me().draggstart())})("mouseup",function(){return Re(e),Le(me().draggend())})("mouseleave",function(){return Re(e),Le(me().draggend())})("mouseout",function(){return Re(e),Le(me().draggend())})("mousemove",function(){Re(e);const r=me();return Le(!!r.isPointerDragging&&r.draggstart())}),Te(2,m7,1,0,"ng-container",4),ne()}if(2&t){const e=me(),i=cn(6);ut("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible&&!e.videoId?"auto":"none"),oe("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInFadeInOut",void 0)("ngClass",$u(17,Pf,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),G(2),oe("ngTemplateOutlet",i)}}function $7(t,n){1&t&&Pn(0)}function v7(t,n){if(1&t){const e=ft();Q(0,"div",2,3),Ae("@cutInBounceInOut.done",function(){Re(e);const r=me();return Le(r.isVisible?null:r.end())})("dblclick",function(){return Re(e),Le(me().stop())})("mousedown",function(){return Re(e),Le(me().draggstart())})("mouseup",function(){return Re(e),Le(me().draggend())})("mouseleave",function(){return Re(e),Le(me().draggend())})("mouseout",function(){return Re(e),Le(me().draggend())})("mousemove",function(){Re(e);const r=me();return Le(!!r.isPointerDragging&&r.draggstart())}),Te(2,$7,1,0,"ng-container",4),ne()}if(2&t){const e=me(),i=cn(6);ut("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible?"auto":"none"),oe("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInBounceInOut",void 0)("ngClass",$u(17,Pf,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),G(2),oe("ngTemplateOutlet",i)}}function b7(t,n){1&t&&Pn(0)}function y7(t,n){if(1&t){const e=ft();Q(0,"div",2,3),Ae("@cutInOpenInOut.done",function(){Re(e);const r=me();return Le(r.isVisible?null:r.end())})("dblclick",function(){return Re(e),Le(me().stop())})("mousedown",function(){return Re(e),Le(me().draggstart())})("mouseup",function(){return Re(e),Le(me().draggend())})("mouseleave",function(){return Re(e),Le(me().draggend())})("mouseout",function(){return Re(e),Le(me().draggend())})("mousemove",function(){Re(e);const r=me();return Le(!!r.isPointerDragging&&r.draggstart())}),Te(2,b7,1,0,"ng-container",4),ne()}if(2&t){const e=me(),i=cn(6);ut("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible?"auto":"none"),oe("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInOpenInOut",void 0)("ngClass",$u(17,Pf,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),G(2),oe("ngTemplateOutlet",i)}}function C7(t,n){1&t&&Pn(0)}function w7(t,n){if(1&t){const e=ft();Q(0,"div",2,3),Ae("@cutInOpenInOut2.done",function(){Re(e);const r=me();return Le(r.isVisible?null:r.end())})("dblclick",function(){return Re(e),Le(me().stop())})("mousedown",function(){return Re(e),Le(me().draggstart())})("mouseup",function(){return Re(e),Le(me().draggend())})("mouseleave",function(){return Re(e),Le(me().draggend())})("mouseout",function(){return Re(e),Le(me().draggend())})("mousemove",function(){Re(e);const r=me();return Le(!!r.isPointerDragging&&r.draggstart())}),Te(2,C7,1,0,"ng-container",4),ne()}if(2&t){const e=me(),i=cn(6);ut("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible?"auto":"none"),oe("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInOpenInOut2",void 0)("ngClass",$u(17,Pf,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),G(2),oe("ngTemplateOutlet",i)}}function x7(t,n){1&t&&(Q(0,"div",21),ve(1,"TEST"),ne())}function E7(t,n){1&t&&(Q(0,"div",22),ve(1,"TEST"),ne())}function T7(t,n){1&t&&(Q(0,"div",23),ve(1,"TEST"),ne())}function S7(t,n){1&t&&(Q(0,"div",24),ve(1,"TEST"),ne())}function I7(t,n){1&t&&(Q(0,"div",25)(1,"i",26),ve(2,"visibility"),ne(),ve(3," For Your Eyes Only"),ne())}function M7(t,n){1&t&&(Q(0,"div",27),ve(1,"For Your Eyes Only "),Q(2,"i",26),ve(3,"visibility"),ne()())}function k7(t,n){if(1&t&&(Q(0,"div",28)(1,"span")(2,"span",29),ve(3),ne()()()),2&t){const e=me(2);G(1),ut("color",e.senderColor),G(1),ut("width",e.pixcelWidth-(e.isBordered?6:0),"px"),G(1),Ja("",e.senderName,"",e.isMine?"\uff08\u3042\u306a\u305f\uff09":"","")}}function D7(t,n){if(1&t&&(Q(0,"div",30)(1,"span")(2,"span",29),ve(3),ne()()()),2&t){const e=me(2);G(1),ut("color",e.senderColor),G(1),ut("width",e.pixcelWidth-(e.isBordered?6:0),"px"),G(1),Ja("",e.senderName,"",e.isMine?"\uff08\u3042\u306a\u305f\uff09":"","")}}function A7(t,n){if(1&t){const e=ft();Q(0,"div",31),Ae("contextmenu",function(r){return Re(e),Le(me(2).onContextMenu(r))}),ne()}if(2&t){const e=me(2);ut("width",e.pixcelWidth,"px")("height",e.pixcelHeight,"px")}}const P7=function(t,n,e,i){return{autoplay:1,controls:0,start:t,loop:n,playsinline:1,rel:0,listType:"playlist",list:e,playlist:i,disablekb:1,fs:0,iv_load_policy:3,modestbranding:1}};function N7(t,n){if(1&t){const e=ft();Q(0,"youtube-player",32,33),Ae("ready",function(r){return Re(e),Le(me(2).onPlayerReady(r))})("stateChange",function(r){return Re(e),Le(me(2).onPlayerStateChange(r))}),ne()}if(2&t){const e=me(2);ut("visibility",e.videoId&&!e.isSoundOnly?"visible":"hidden"),oe("videoId",e.videoId)("width",e.pixcelWidth-(e.isBordered?6:0))("height",e.pixcelHeight-(e.isBordered?6:0))("playerVars",Is(6,P7,e.cutIn.videoStart,e.cutIn&&e.cutIn.isLoop?1:0,e.playListId?e.playListId:null,e.playListId?null:e.videoId))}}function O7(t,n){if(1&t){const e=ft();Q(0,"img",34,35),Ae("error",function(){return Re(e),Le(me(2).onErrorFallback())}),ne()}if(2&t){const e=me(2);ut("object-fit",e.objectFit),oe("src","https://img.youtube.com/vi/"+e.videoId+"/hqdefault.jpg",vn)}}function F7(t,n){if(1&t){const e=ft();Q(0,"img",36,35),Ae("load",function(){return Re(e),Le(me(2).onImageLoad())})("contextmenu",function(r){return Re(e),Le(me(2).onContextMenu(r))}),Lt(2,"safe"),ne()}if(2&t){const e=me(2);ut("object-fit",e.objectFit),oe("src",Bt(2,3,e.cutInImage.url,"resourceUrl"),vn)}}const hg=function(t){return{transform:t}};function R7(t,n){if(1&t){const e=ft();Te(0,x7,2,0,"div",5),Te(1,E7,2,0,"div",6),Te(2,T7,2,0,"div",7),Te(3,S7,2,0,"div",8),Te(4,I7,4,0,"div",9),Te(5,M7,4,0,"div",10),Te(6,k7,4,6,"div",11),Te(7,D7,4,6,"div",12),Q(8,"div",13),Ae("contextmenu",function(r){return Re(e),Le(me().onContextMenu(r))}),ne(),Q(9,"div",14),Ae("contextmenu",function(r){return Re(e),Le(me().onContextMenu(r))}),ne(),Q(10,"div",15),Ae("contextmenu",function(r){return Re(e),Le(me().onContextMenu(r))}),ne(),Q(11,"div",16),Ae("contextmenu",function(r){return Re(e),Le(me().onContextMenu(r))}),ne(),Te(12,A7,1,4,"div",17),Te(13,N7,2,11,"youtube-player",18),Te(14,O7,2,3,"img",19),Te(15,F7,3,6,"img",20)}if(2&t){const e=me();oe("ngIf",e.isTest),G(1),oe("ngIf",e.isTest),G(1),oe("ngIf",e.isTest),G(1),oe("ngIf",e.isTest),G(1),oe("ngIf",e.isSecret),G(1),oe("ngIf",e.isSecret),G(1),oe("ngIf",e.isIndicateSender),G(1),oe("ngIf",e.isIndicateSender),G(1),ut("width",e.pixcelWidth+3,"px")("height",19,"px"),oe("ngStyle",wt(32,hg,"translateX(-"+(e.isBordered?6:3)+"px) translateY(-"+(e.isBordered?6:3)+"px)")),G(1),ut("width",e.pixcelWidth+3,"px")("height",19,"px"),oe("ngStyle",wt(34,hg,"translateX("+(e.isBordered?6:3)+"px) translateY("+(e.isBordered?6:3)+"px)")),G(1),ut("width",19,"px")("height",e.pixcelHeight+3,"px"),oe("ngStyle",wt(36,hg,"translateX(-"+(e.isBordered?6:3)+"px) translateY(-"+(e.isBordered?6:3)+"px)")),G(1),ut("width",19,"px")("height",e.pixcelHeight+3,"px"),oe("ngStyle",wt(38,hg,"translateX("+(e.isBordered?6:3)+"px) translateY("+(e.isBordered?6:3)+"px)")),G(1),oe("ngIf",!e.videoId),G(1),oe("ngIf",e.videoId),G(1),oe("ngIf",e.videoId&&!e.isSoundOnly),G(1),oe("ngIf",!e.videoId||e.isSoundOnly)}}let QT=(()=>{class t{constructor(e,i,r){this.pointerDeviceService=e,this.contextMenuService=i,this.ngZone=r,this.animationType=0,this._imageFile=on.Empty,this._isVisible=!1,this._isEnd=!1,this.videoStateTransition=!1,this.isMinimize=!1,this.isBackyard=!1,this.isSecret=!1,this.isTest=!1,this.isIndicateSender=!1,this.sender="",this.videoId="",this.playListId="",this.cutInImageTransformOrigin="center",this._naturalWidth=0,this._naturalHeight=0,this._dragging=!1,this.audioPlayer=new tt}get naturalWidth(){return this.videoId&&!this.isSoundOnly?480:this._naturalWidth}get naturalHeight(){return this.videoId&&!this.isSoundOnly?270:this._naturalHeight}ngOnInit(){Ue.register(this).on("CHANGE_JUKEBOX_VOLUME",-100,e=>{this.videoPlayer&&this.videoPlayer.setVolume(this.videoVolume)}).on("PLAY_VIDEO_CUT_IN",-1e3,e=>{this.cutIn&&this.cutIn.identifier!=e.data.identifier&&this.videoId&&this.stop()})}ngOnDestroy(){Ue.unregister(this,"UPDATE_AUDIO_RESOURE"),Ue.unregister(this,"CHANGE_JUKEBOX_VOLUME"),Ue.unregister(this,"PLAY_VIDEO_CUT_IN"),clearTimeout(this._timeoutId),clearTimeout(this._timeoutIdVideo)}get isPointerDragging(){return this._dragging}draggstart(){this.ngZone.run(()=>{this._dragging=!0})}draggend(){this.ngZone.run(()=>{this._dragging=!1})}get isVisible(){return this.cutIn&&this._isVisible}set isVisible(e){this._isVisible=e}get isEnd(){return!this.cutIn||this._isEnd}get cutInImage(){if(!this.cutIn)return this._imageFile;if(this._imageFile.identifier!==this.cutIn.imageIdentifier){let e=Gt.instance.get(this.cutIn.imageIdentifier);this._imageFile=e||on.Empty}return this._imageFile}get pixcelWidthPreAdjust(){if(this.isMinimize)return t.MIN_SIZE;let e=0;return this.cutIn&&(e=this.cutIn.width<=0&&this.cutIn.height<=0?this.naturalWidth:this.cutIn.width<=0?document.documentElement.offsetHeight*this.cutIn.height*(this.naturalWidth/this.naturalHeight)/100:document.documentElement.clientWidth*this.cutIn.width/100),e}get pixcelWidth(){let e=this.pixcelWidthPreAdjust;return(this.cutIn.isPreventOutBounds||this.videoId)&&(this.isAjustAspect?this.isAjustAspectWidth?e=document.documentElement.clientWidth:e*=document.documentElement.offsetHeight/this.pixcelHeightPreAdjust:e>document.documentElement.clientWidth&&(e=document.documentElement.clientWidth)),!this.isMinimize&&(this.cutIn.width<=0||this.cutIn.height<=0)&&this.pixelWidthAspectMinimun>e?e=this.pixelWidthAspectMinimun:e<t.MIN_SIZE&&(e=t.MIN_SIZE),e}get pixcelHeightPreAdjust(){if(this.isMinimize)return t.MIN_SIZE;let e=0;return this.cutIn&&(e=this.cutIn.width<=0&&this.cutIn.height<=0?this.naturalHeight:this.cutIn.height<=0?document.documentElement.clientWidth*this.cutIn.width*(this.naturalHeight/this.naturalWidth)/100:document.documentElement.offsetHeight*this.cutIn.height/100),e}get pixelWidthAspectMinimun(){let e=t.MIN_SIZE;return this.cutIn&&this.naturalWidth>this.naturalHeight&&(e=t.MIN_SIZE*this.naturalWidth/this.naturalHeight),e}get pixcelHeight(){let e=this.pixcelHeightPreAdjust;return(this.cutIn.isPreventOutBounds||this.videoId)&&(this.isAjustAspect?this.isAjustAspectWidth?e*=document.documentElement.offsetWidth/this.pixcelWidthPreAdjust:e=document.documentElement.offsetHeight:e>document.documentElement.offsetHeight&&(e=document.documentElement.offsetHeight)),!this.isMinimize&&(this.cutIn.width<=0||this.cutIn.height<=0)&&this.pixelHeightAspectMinimun>e?e=this.pixelHeightAspectMinimun:e<t.MIN_SIZE&&(e=t.MIN_SIZE),e}get pixelHeightAspectMinimun(){let e=t.MIN_SIZE;return this.cutIn&&this.naturalWidth<this.naturalHeight&&(e=t.MIN_SIZE*this.naturalHeight/this.naturalWidth),e}get isAjustAspect(){return(this.cutIn.width<=0||this.cutIn.height<=0)&&(this.pixcelWidthPreAdjust>document.documentElement.clientWidth||this.pixcelHeightPreAdjust>document.documentElement.offsetHeight)}get isAjustAspectWidth(){const e=this.pixcelWidthPreAdjust;return e>document.documentElement.clientWidth?!(document.documentElement.offsetHeight<this.pixcelHeightPreAdjust*(document.documentElement.clientWidth/e)):(document,!1)}get pixcelPosX(){let e=0;if(!this.cutIn)return e;if(e=document.documentElement.clientWidth*this.cutIn.posX/100-this.pixcelWidth/2,this.cutIn.isPreventOutBounds||this.videoId){const i=this.pixcelWidth/2-document.documentElement.clientWidth*this.cutIn.posX/100;i>0&&(e+=i);const r=-(document.documentElement.clientWidth-document.documentElement.clientWidth*this.cutIn.posX/100-this.pixcelWidth/2);r>0&&(e-=r)}return e}get pixcelPosY(){let e=0;if(!this.cutIn)return e;if(e=document.documentElement.offsetHeight*this.cutIn.posY/100-this.pixcelHeight/2,this.cutIn.isPreventOutBounds||this.videoId){const i=this.pixcelHeight/2-document.documentElement.offsetHeight*this.cutIn.posY/100;i>0&&(e+=i);const r=-(document.documentElement.offsetHeight-document.documentElement.offsetHeight*this.cutIn.posY/100-this.pixcelHeight/2);r>0&&(e-=r)}return e}get zIndex(){return!this.cutIn||this.isBackyard?0:(this.cutIn.isFrontOfStand||this.videoId?15e5:5e5)+this.cutIn.zIndex+(this.videoId?1e3:0)}get objectFit(){return this.cutIn?this.isMinimize||this.videoId&&!this.isSoundOnly||2==this.cutIn.objectFitType?"contain":1==this.cutIn.objectFitType?"cover":"fill":"none"}get videoVolume(){return this.isTest?tt.isAuditionMute?0:100*tt.auditionVolume:tt.isMute?0:100*tt.volume}get isBordered(){return this.cutIn&&this.cutIn.borderStyle>0}get isSoundOnly(){return this.cutIn&&this.cutIn.isSoundOnly}get senderName(){let e="";if(!this.sender)return e;let i=Qe.findByPeerId(this.sender);return i instanceof Qe&&(e=i.name),e}get isMine(){return this.sender===Qe.myCursor.peerId}get senderColor(){let e=Qe.CHAT_DEFAULT_COLOR;if(!this.sender)return e;let i=Qe.findByPeerId(this.sender);return i instanceof Qe&&(e=i.color),e}play(){this.isEnd||(this._isVisible?this.cutIn.videoId||this.audioPlayer.play():(this.ngZone.run(()=>{this._isVisible=!0,this.cutIn.videoId||this._play()}),this.cutIn.duration>0&&(this._timeoutId=setTimeout(()=>{this.stop(),clearTimeout(this._timeoutId),this._timeoutId=null},1e3*(this.cutIn.videoId?12:this.cutIn.duration)))))}_play(){if(this.isEnd)return;const e=Xt.instance.get(this.cutIn.audioIdentifier);e&&e.isReady?(this.audioPlayer.volumeType=this.isTest?Vo.AUDITION:Vo.MASTER,this.audioPlayer.loop=this.cutIn.isLoop,this.cutIn.videoId||this.audioPlayer.play(e)):Ue.register(this).on("UPDATE_AUDIO_RESOURE",-100,i=>{this.cutIn.videoId||this._play()})}pause(){this.cutIn.videoId||this.audioPlayer.pause()}stop(){Ue.unregister(this,"UPDATE_AUDIO_RESOURE"),this.ngZone.run(()=>{this._isVisible=!1,this._dragging=!1,this.audioPlayer.stop()})}end(){this._isEnd=!0,this.audioPlayer.stop()}onImageLoad(){this._naturalWidth=this.cutInImageElement.nativeElement.naturalWidth,this._naturalHeight=this.cutInImageElement.nativeElement.naturalHeight}onPlayerReady(e){e.target.setVolume(this.videoVolume),e.target.playVideo()}onPlayerStateChange(e){const i=e.data;if(1==i){if(this.videoStateTransition=!0,this._timeoutIdVideo=setTimeout(()=>{this.ngZone.run(()=>{this.videoStateTransition=!1,this._timeoutIdVideo=null})},200),this.cutIn.duration>0){clearTimeout(this._timeoutId);const r=this.cutIn.duration-this.videoPlayer.getCurrentTime()+(this.cutIn.videoStart?parseInt(this.cutIn.videoStart):0);r<=0?this.stop():this._timeoutId=setTimeout(()=>{this.stop(),clearTimeout(this._timeoutId),this._timeoutId=null},1e3*(this.cutIn.duration>r?r:this.cutIn.duration))}this.cutIn&&Ue.trigger("PLAY_VIDEO_CUT_IN",{identifier:this.cutIn.identifier})}2==i&&(this.videoStateTransition=!0,this._timeoutIdVideo=setTimeout(()=>{this.ngZone.run(()=>{this.videoStateTransition=!1,this._timeoutIdVideo=null})},200)),5==i&&(this.videoStateTransition=!0,this._timeoutIdVideo=setTimeout(()=>{this.ngZone.run(()=>{this.videoStateTransition=!1,this._timeoutIdVideo=null})},200))}onErrorFallback(){console.log("fallback"),this.videoId&&(this.cutInImageElement.nativeElement.src="https://img.youtube.com/vi/"+this.videoId+"/default.jpg")}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:"\u9589\u3058\u308b\uff08\u81ea\u5206\u306e\u307f\u505c\u6b62\uff09",action:()=>{this.stop()},default:!0,selfOnly:!0},Ht,{name:(this.isIndicateSender?"\u2611":"\u2610")+"\u9001\u4fe1\u8005\u3092\u8868\u793a",action:()=>{this.isIndicateSender=!this.isIndicateSender},selfOnly:!0},{name:(this.isBackyard?"\u2611":"\u2610")+"\u30a6\u30a3\u30f3\u30c9\u30a6\u306e\u80cc\u5f8c\u306b\u8868\u793a",action:()=>{this.isBackyard=!this.isBackyard},selfOnly:!0},{name:(this.isMinimize?"\u2611":"\u2610")+"\u6700\u5c0f\u5316",action:()=>{this.isMinimize=!this.isMinimize},selfOnly:!0}],this.cutIn.name)}}return t.MIN_SIZE=250,t.\u0275fac=function(e){return new(e||t)(He(Ci),He(hr),He(Nn))},t.\u0275cmp=fn({type:t,selectors:[["cut-in"]],viewQuery:function(e,i){if(1&e&&(wn(f7,5),wn(h7,5)),2&e){let r;Cn(r=xn())&&(i.cutInImageElement=r.first),Cn(r=xn())&&(i.videoPlayer=r.first)}},hostBindings:function(e,i){1&e&&Ae("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{cutIn:"cutIn",animationType:"animationType"},decls:7,vars:5,consts:[["appDraggable","","class","container","style","position: absolute",3,"draggable.allowOverHalf","draggable.unhandle","width","height","left","top","z-index","pointer-events","ngClass","dblclick","mousedown","mouseup","mouseleave","mouseout","mousemove",4,"ngIf"],["image",""],["appDraggable","",1,"container",2,"position","absolute",3,"draggable.allowOverHalf","draggable.unhandle","ngClass","dblclick","mousedown","mouseup","mouseleave","mouseout","mousemove"],["cutInContainerElement",""],[4,"ngTemplateOutlet"],["class","test-indicator grow left-top",4,"ngIf"],["class","test-indicator grow right-top",4,"ngIf"],["class","test-indicator grow left-bottom",4,"ngIf"],["class","test-indicator grow right-bottom",4,"ngIf"],["class","secret-indicator grow left-top",4,"ngIf"],["class","secret-indicator grow right-bottom","style","text-align: right",4,"ngIf"],["class","name-indicator grow right-top","style","text-align: right",4,"ngIf"],["class","name-indicator grow left-bottom",4,"ngIf"],[1,"handler","top",3,"ngStyle","contextmenu"],[1,"handler","bottom",3,"ngStyle","contextmenu"],[1,"handler","left",3,"ngStyle","contextmenu"],[1,"handler","right",3,"ngStyle","contextmenu"],["style","pointer-events: auto","class","handler",3,"width","height","contextmenu",4,"ngIf"],["style","position: absolute; pointer-events: auto","suggestedQuality","default",3,"visibility","videoId","width","height","playerVars","ready","stateChange",4,"ngIf"],["style","pointer-events: auto","draggable","false",3,"object-fit","src","error",4,"ngIf"],["style","pointer-events: none","draggable","false",3,"object-fit","src","load","contextmenu",4,"ngIf"],[1,"test-indicator","grow","left-top"],[1,"test-indicator","grow","right-top"],[1,"test-indicator","grow","left-bottom"],[1,"test-indicator","grow","right-bottom"],[1,"secret-indicator","grow","left-top"],[1,"material-icons",2,"font-size","smaller"],[1,"secret-indicator","grow","right-bottom",2,"text-align","right"],[1,"name-indicator","grow","right-top",2,"text-align","right"],[2,"display","inline-block","white-space","nowrap","overflow","hidden","text-overflow","ellipsis"],[1,"name-indicator","grow","left-bottom"],[1,"handler",2,"pointer-events","auto",3,"contextmenu"],["suggestedQuality","default",2,"position","absolute","pointer-events","auto",3,"videoId","width","height","playerVars","ready","stateChange"],["videoPlayerComponent",""],["draggable","false",2,"pointer-events","auto",3,"src","error"],["cutInImageElement",""],["draggable","false",2,"pointer-events","none",3,"src","load","contextmenu"]],template:function(e,i){1&e&&(Te(0,g7,3,25,"div",0),Te(1,_7,3,25,"div",0),Te(2,v7,3,25,"div",0),Te(3,y7,3,25,"div",0),Te(4,w7,3,25,"div",0),Te(5,R7,16,40,"ng-template",null,1,ti)),2&e&&(oe("ngIf",i.isVisible&&-1==i.animationType),G(1),oe("ngIf",i.isVisible&&0==i.animationType),G(1),oe("ngIf",i.isVisible&&1==i.animationType),G(1),oe("ngIf",i.isVisible&&2==i.animationType),G(1),oe("ngIf",i.isVisible&&3==i.animationType))},dependencies:[si,Bn,Jl,fr,KT,hv,$i],styles:[".container[_ngcontent-%COMP%]{margin:0;padding:0}.container.video[_ngcontent-%COMP%]{background-color:#000}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}img[_ngcontent-%COMP%]{margin:0;padding:0;width:100%;height:100%}.container[_ngcontent-%COMP%]:hover{outline:3px dotted #22F}.container.minimaize[_ngcontent-%COMP%]{outline:3px solid #22F}.container.is-bordered[_ngcontent-%COMP%]{border:3px ridge #dde}.container.is-bordered[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:1px solid black;box-sizing:border-box}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.test-indicator[_ngcontent-%COMP%]{position:absolute;pointer-events:none;z-index:5;color:#00f;font-size:smaller;padding:0 3px 1px;font-weight:bolder}.secret-indicator[_ngcontent-%COMP%]{position:absolute;pointer-events:none;z-index:5;color:gray;font-size:smaller;padding:0 3px 2px;font-weight:bolder;opacity:.6}.name-indicator[_ngcontent-%COMP%]{position:absolute;pointer-events:none;z-index:10;padding:0 3px 0 6px;font-weight:bolder;font-size:smaller}.left-top[_ngcontent-%COMP%]{left:0;top:0}.left-bottom[_ngcontent-%COMP%]{left:0;bottom:0}.right-top[_ngcontent-%COMP%]{right:0;top:0}.right-bottom[_ngcontent-%COMP%]{right:0;bottom:0}.handler[_ngcontent-%COMP%]{position:absolute;z-index:20;pointer-events:auto}.handler.top[_ngcontent-%COMP%]{top:0;left:0}.handler.bottom[_ngcontent-%COMP%]{bottom:0;right:0}.handler.left[_ngcontent-%COMP%]{top:0;left:0}.handler.right[_ngcontent-%COMP%]{right:0;bottom:0}"],data:{animation:[Vn("cutInNone",[tn("void => *",[Zt("10ms ease-in",bn([dt({opacity:0,offset:0}),dt({opacity:1,offset:1})]))]),tn("* => void",[Zt("10ms ease-in",bn([dt({opacity:0,offset:1})]))])]),Vn("cutInFadeInOut",[tn("void => *",[Zt("330ms ease-in",bn([dt({opacity:0,offset:0}),dt({opacity:1,offset:1})]))]),tn("* => void",[Zt("330ms ease-in",bn([dt({opacity:1,offset:0}),dt({opacity:0,offset:1})]))])]),Vn("cutInBounceInOut",[tn("void => *",[Zt("600ms ease",bn([dt({transform:"scale3d(0, 0, 0)",offset:0}),dt({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),dt({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),dt({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),dt({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),tn("* => void",[Zt(100,dt({transform:"scale3d(0, 0, 0)"}))])]),Vn("cutInOpenInOut",[tn("void => *",[Zt("262ms ease",bn([dt({opacity:0,transform:"scale3d(0, 1.0, 1.0)",offset:0}),dt({opacity:1,transform:"scale3d(1.1, 1.0, 1.0)",offset:.875}),dt({opacity:1,transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),tn("* => void",[Zt(100,dt({opacity:0,transform:"scale3d(0, 1.0, 1.0)"}))])]),Vn("cutInOpenInOut2",[tn("void => *",[Zt("262ms ease",bn([dt({opacity:0,transform:"scale3d(1.0, 0, 1.0)",offset:0}),dt({opacity:1,transform:"scale3d(1.0, 1.1, 1.0)",offset:.875}),dt({opacity:1,transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),tn("* => void",[Zt(100,dt({opacity:0,transform:"scale3d(1.0, 0, 1.0)"}))])])]}}),t})(),pg=(()=>{class t{constructor(){}static nowShowingIdentifiers(){return this.cutInComponentRefQueue.filter(e=>e&&e.instance&&e.instance.cutIn&&e.instance.isVisible).map(e=>e.instance.cutIn.identifier)}play(e,i=!1,r=!1,o=null){if(!e)return;for(const a of t.cutInComponentRefQueue)if(a&&a.instance){const h=a.instance;if(h.isEnd)a.destroy();else{const b=h.cutIn;(e.identifier===b.identifier||e.videoId&&b.videoId||null!=e.tag&&""!=e.tag.trim()&&null!=b.tag&&""!=b.tag.trim()&&pt.toHalfWidth(e.tag).toUpperCase().trim()==pt.toHalfWidth(b.tag).toUpperCase().trim())&&h.stop()}}t.cutInComponentRefQueue=t.cutInComponentRefQueue.filter(a=>a&&a.instance);const s=t.defaultParentViewContainerRef.createComponent(QT);s.instance.cutIn=e,s.instance.animationType=e.animationType,s.instance.videoId=e.videoId,s.instance.playListId=e.playListId,s.instance.isSecret=i,s.instance.isTest=r,s.instance.sender=o,s.instance.play(),t.cutInComponentRefQueue.push(s)}stop(e){if(e){e instanceof Ni&&(e=e.identifier);for(const i of t.cutInComponentRefQueue)if(i&&i.instance){const r=i.instance;r.isEnd?i.destroy():e===r.cutIn.identifier&&r.stop()}t.cutInComponentRefQueue=t.cutInComponentRefQueue.filter(i=>i&&i.instance)}}}return t.cutInComponentRefQueue=[],t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=$n({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Ni=class extends ni{constructor(){super(...arguments),this.name="",this.tag="",this.duration=6,this.width=0,this.height=0,this.posX=50,this.posY=50,this.zIndex=0,this.objectFitType=0,this.animationType=0,this.borderStyle=0,this.isFrontOfStand=!1,this.isPreventOutBounds=!1,this.imageIdentifier=on.Empty.identifier,this.isVideoCutIn=!1,this.videoUrl="",this.isSoundOnly=!1,this.audioFileName="",this.audioIdentifier="",this.isLoop=!1}get videoId(){if(!this.isVideoCutIn||!this.videoUrl)return"";let n="";if(!pt.validUrl(this.videoUrl))return"";{const e=new URL(this.videoUrl).hostname;if("youtube.com"==e||"www.youtube.com"==e){let i=this.videoUrl.split("v=");i[1]&&(n=encodeURI(i[1].split(/[\?\&\#\/]/)[0]))}else{if("youtu.be"!=e)return"";{let i=this.videoUrl.split("youtu.be/");i[1]&&(n=encodeURI(i[1].split(/[\?\&\#\/]/)[0]))}}}return n.replace(/[\<\>\/\:\s\r\n]/g,"")}get videoStart(){if(!this.isVideoCutIn||!this.videoUrl||!this.videoId)return null;const n=/[\&\?](?:start|t)\=([\dhms]+)/i.exec(this.videoUrl);return n&&n[1]?this._sec(n[1]):null}_sec(n){if(!n)return null;let e=null;if(e=/^(\d+)$/.exec(n))return e[1];if(e=/^(?:(\d+)h)?(?:(\d+)m)?(?:(\d+)s)?$/i.exec(n)){let i=0;return e[1]&&(i+=60*+e[1]*60),e[2]&&(i+=60*+e[2]),e[3]&&(i+=+e[3]),""+i}return null}get playListId(){if(!this.isVideoCutIn||!this.videoId)return"";let n="";if(!pt.validUrl(this.videoUrl))return"";{let e=this.videoUrl.split("list=");e[1]&&(n=encodeURI(e[1].split(/[\&\#\/]/)[0]))}return n.replace(/[\<\>\/\:\s\r\n]/g,"")}get isValidAudio(){return 0==this.audioFileName.length||0==this.audioIdentifier.length||!!Xt.instance.get(this.audioIdentifier)}get postfixes(){return null==this.value||""==(this.value+"").trim()?[]:Array.from(new Set(this.value.split(/[\r\n]+/g).map(n=>null!=n?n.trimRight():""))).filter(n=>""!=n)}get isPlayingNow(){return pg.nowShowingIdentifiers().includes(this.identifier)}};var cs;$e([bt()],Ni.prototype,"name",void 0),$e([bt()],Ni.prototype,"tag",void 0),$e([bt()],Ni.prototype,"duration",void 0),$e([bt()],Ni.prototype,"width",void 0),$e([bt()],Ni.prototype,"height",void 0),$e([bt()],Ni.prototype,"posX",void 0),$e([bt()],Ni.prototype,"posY",void 0),$e([bt()],Ni.prototype,"zIndex",void 0),$e([bt()],Ni.prototype,"objectFitType",void 0),$e([bt()],Ni.prototype,"animationType",void 0),$e([bt()],Ni.prototype,"borderStyle",void 0),$e([bt()],Ni.prototype,"isFrontOfStand",void 0),$e([bt()],Ni.prototype,"isPreventOutBounds",void 0),$e([bt()],Ni.prototype,"imageIdentifier",void 0),$e([bt()],Ni.prototype,"isVideoCutIn",void 0),$e([bt()],Ni.prototype,"videoUrl",void 0),$e([bt()],Ni.prototype,"audioFileName",void 0),$e([bt()],Ni.prototype,"audioIdentifier",void 0),$e([bt()],Ni.prototype,"isLoop",void 0),Ni=$e([mi("cut-in")],Ni);let Os=cs=class extends ni{static get instance(){return cs._instance||(cs._instance=new cs("CutInList"),cs._instance.initialize()),cs._instance}get cutIns(){return this.children}addCutIn(...n){let e=null;if(n[0]instanceof Ni)e=n[0];else{let i=n[0];e=new Ni(n[1]),e.name=i,e.initialize()}return this.appendChild(e)}parseInnerXml(n){for(let i of cs.instance.children)i.destroy();let e=cs.instance.toContext();e.syncData=this.toContext().syncData,cs.instance.apply(e),cs.instance.update(),super.parseInnerXml.apply(cs.instance,[n]),this.destroy()}matchCutInInfo(n){n=pt.toHalfWidth(n).toUpperCase().trimRight();let e="",i=new Map;const r=[];for(const a of this.cutIns.map(h=>[Math.random(),h]).sort((h,b)=>h[0]-b[0]).map(h=>h[1])){if(!a)continue;let h=!1;for(const b of a.postfixes)n.endsWith(pt.toHalfWidth(b).toUpperCase().trimRight())&&(h=!0,("@"==b.slice(0,1)||"\uff20"==b.slice(0,1))&&e.length<b.length&&(e=b));if(h){const b=a.tag;null!=b&&b.trim().length>0?i.set(pt.toHalfWidth(b).toUpperCase().trim(),a):r.push(a)}}r.push(...i.values());const s=r.map(a=>[Math.random(),a]).sort((a,h)=>a[0]-h[0]);return{names:s.map(a=>a[1].name),identifiers:s.map(a=>a[1].identifier),matchMostLongText:e}}};var In;Os=cs=$e([mi("cut-in-list")],Os);let ii=In=class extends pl{constructor(n,e=null){super(n),this.chatMessageService=e}onStoreAdded(){var n=this;super.onStoreAdded(),Ue.register(this).on("SEND_MESSAGE",function(){var e=(0,gn.Z)(function*(i){const r=Ct.instance.get(i.data.messageIdentifier);if(!r||!r.isSendFromSelf||r.isSystem||r.isOperationLog)return;const o=pt.toHalfWidth(r.text).replace("\u200b","");let s=r.tag.replace("noface","").trim();s=s||"DiceBot";try{const a=/^((srepeat|repeat|srep|rep|sx|x)?(\d+)?[ \u3000]+)?([^\n]*)?/gi.exec(o),h=a[2],b=h&&0===h.toUpperCase().indexOf("S"),ee=null!=a[3]?Number(a[3]):1;let de=null!=a[4]?a[4]:o;if(!de||ee<=0)return;let ge={id:"DiceBot",result:"",isSecret:!1,isDiceRollTable:!1,isEmptyDice:!0,isSuccess:!1,isFailure:!0,isCritical:!1,isFumble:!1},xe=!1;for(const ke of Ns.instance.diceRollTables){if(null==ke.command)continue;let Pe=!1,Oe=0,je="",qe=!1;const Ve=pt.toHalfWidth(ke.command.replace(/[\u2015\u30fc\u2014\u2010]/g,"-").trim()).toUpperCase(),We=pt.toHalfWidth(de.replace(/[\u2015\u30fc\u2014\u2010]/g,"-").trim()).toUpperCase();if(!We.startsWith("S"+Ve)||We[("S"+Ve).length]&&!/[ \=\+\-]/.test(We.charAt(("S"+Ve).length))?We.startsWith(Ve)&&(!We[Ve.length]||/[ \=\+\-]/.test(We.charAt(Ve.length)))&&(xe=!0,We[Ve.length]&&" "!=We[Ve.length]&&(je=We.substring(Ve.length))):(xe=!0,Pe=!0,We[("S"+Ve).length]&&" "!=We[("S"+Ve).length]&&(je=We.substring(("S"+Ve).length))),je)if(je=je.split(" ")[0],/^[\+\-]\d+$/.test(je))Oe=+je,je=` (\u4fee\u6b63${je})`;else{if(!/^\=\-?\d+$/.test(je)){xe=!1;continue}qe=!0}if(xe){ge.isFailure=!1,ge.isDiceRollTable=!0,ge.tableName=ke.name&&ke.name.length>0?ke.name:"(\u7121\u540d\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868)",ge.isSecret=Pe||b;const vt=ke.parseText();for(let nt=0;nt<ee&&nt<32;nt++){let _t=null,Mt=yield In.diceRollAsync(qe?`C(${je.substring(1)})`:pt.toHalfWidth(ke.dice).replace(/[\u216e\xd0]/g,"D").replace(/\\xd7/g,"*").replace(/\\xf7/g,"/").replace(/[\u2015\u30fc\u2014\u2010]/g,"-"),"DiceBot",1);ge.isEmptyDice=ge.isEmptyDice&&Mt.isEmptyDice,Mt.result&&(Mt.result=n.formatRollResult(Mt.result));let ht=null;Mt.result.length>0&&(ht=Mt.result.match(/\s\u2192\s(?:\u6210\u529f\u6570|\u8a08\u7b97\u7d50\u679c)?(\-?\d+)$/))&&(_t=+ht[1]);let yt=!1;if(null!=_t)for(const Tt of vt)if((null===Tt.range.start||Tt.range.start<=_t+Oe)&&(null===Tt.range.end||_t+Oe<=Tt.range.end)){ge.result+=qe?"\u6307\u5b9a="+_t+"\n"+pt.cr(Tt.result):Mt.result+je+(je?` \u2192 ${_t+Oe}`:"")+"\n"+pt.cr(Tt.result),yt=!0;break}yt||(ge.result+=null==_t?"\uff08\u30a8\u30e9\u30fc\uff1a\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u304b\u3089\u6570\u5b57\u304c\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\uff09\n(\u7d50\u679c\u306a\u3057)":qe?"\u6307\u5b9a="+_t+"\n(\u7d50\u679c\u306a\u3057)":Mt.result+je+(je?` \u2192 ${_t+Oe}`:"")+"\n(\u7d50\u679c\u306a\u3057)"),1<ee&&(ge.result+=` #${nt+1}`),nt<ee-1&&(ge.result+="\n")}break}}if(!xe){if(!In.apiUrl&&!(yield In.loadGameSystemAsync(s)).COMMAND_PATTERN.test(de))return;let Pe,ke=!1;if((Pe=/^(S?CHOICE\d*)[ \u3000]+([^ \u3000]*)/gi.exec(de.trim()))&&(de=de.trim().replace(/[\u3000\s]+/g," "),ke=!0),ke||((Pe=/^(S?CHOICE\d*\[[^\[\]]+\])/gi.exec(de.trim()))||(Pe=/^(S?CHOICE\d*\([^\(\)]+\))/gi.exec(de.trim())))&&(Ns.instance.diceRollTables.map(Oe=>Oe.command).some(Oe=>null!=Oe&&Oe.trim().toUpperCase()===Pe[1].toUpperCase())||(de=Pe[1],ke=!0)),ke||(de=de.trim().split(/\s+/)[0].replace(/[\u216e\xd0]/g,"D").replace(/\\xd7/g,"*").replace(/\\xf7/g,"/").replace(/[\u2015\u30fc\u2014\u2010]/g,"-")),In.apiUrl){if(!ke&&!/choice\d*\[.*\]/i.test(de)&&!/^[a-zA-Z0-9!-/:-@\xa5[-`{-~\}]+$/.test(de))return;ge=yield In.diceRollAsync(de,s,ee),ge.isSecret=ge.isSecret||b}else for(let Oe=0;Oe<ee&&Oe<32;Oe++){let je=yield In.diceRollAsync(de,s,ee);if(je.result.length<1)break;ge.id=je.id,ge.result+=je.result,ge.isSecret=ge.isSecret||je.isSecret||b,ge.isEmptyDice=ge.isEmptyDice&&je.isEmptyDice,ge.isSuccess=ge.isSuccess||je.isSuccess,ge.isFailure=ge.isFailure&&je.isFailure,ge.isCritical=ge.isCritical||je.isCritical,ge.isFumble=ge.isFumble||je.isFumble,1<ee&&(ge.result+=` #${Oe+1}\n`)}}if(!ge.result)return;ge.result=ge.result.trimRight(),n.sendResultMessage(ge,r)}catch(a){console.error(a)}});return function(i){return e.apply(this,arguments)}}())}onStoreRemoved(){super.onStoreRemoved(),Ue.unregister(this)}sendResultMessage(n,e){let i=n.id.split(":")[0],r=n.result;const o=n.isSecret,s=n.isEmptyDice,a=n.isSuccess,h=n.isFailure,b=n.isCritical,ee=n.isFumble;if(r.length<1)return;n.isDiceRollTable||(r=this.formatRollResult(r,i));let de="system";o&&(de+=" secret"),s&&(de+=" empty"),a&&(de+=" success"),h&&(de+=" failure"),b&&(de+=" critical"),ee&&(de+=" fumble");let ge={identifier:"",tabIdentifier:e.tabIdentifier,originFrom:e.from,from:n.isDiceRollTable?"Dice-Roll Table":In.apiUrl?`BCDice-API(${In.apiUrl})`:"System-BCDice",timestamp:e.timestamp+1,imageIdentifier:"",tag:de,name:`${n.isDiceRollTable?n.tableName:i} : ${e.name}${o?" (Secret)":""}`,text:r,color:e.color,isUseStandImage:e.isUseStandImage},xe="";const ke=Ct.instance.get(e.characterIdentifier);if(ke instanceof sn){const je=ke.standList.matchStandInfo(r,e.imageIdentifier);if(!o&&!e.standName&&e.isUseStandImage)if(je.farewell){const qe={characterIdentifier:ke.identifier};if(e.to){const Ve=Qe.findByUserId(e.to);Ve&&(Ve.peerId!=Qe.myCursor.peerId&&Ue.call("FAREWELL_STAND_IMAGE",qe,Ve.peerId),Ue.call("FAREWELL_STAND_IMAGE",qe,Qe.myCursor.peerId))}else Ue.call("FAREWELL_STAND_IMAGE",qe)}else if(je&&je.standElementIdentifier){const qe=Ct.instance.get(je.standElementIdentifier);if(qe&&qe.getFirstElementByName("conditionType")){const Ve=+qe.getFirstElementByName("conditionType").value;if(Ve==Ui.Postfix||Ve==Ui.PostfixOrImage||Ve==Ui.PostfixAndImage){const We={characterIdentifier:ke.identifier,standIdentifier:je.standElementIdentifier,color:e.color,secret:!!e.to};if(We.secret){const vt=Qe.findByUserId(e.to);vt&&(vt.peerId!=Qe.myCursor.peerId&&Ue.call("POPUP_STAND_IMAGE",We,vt.peerId),Ue.call("POPUP_STAND_IMAGE",We,Qe.myCursor.peerId))}else Ue.call("POPUP_STAND_IMAGE",We)}}}xe=je.matchMostLongText}const Pe=Ct.instance.get(e.tabIdentifier),Oe=Os.instance.matchCutInInfo(r);if(!o&&Pe.isUseStandImage&&Oe){for(const je of Oe.identifiers){const qe={identifier:je,secret:!!e.to,sender:Qe.myCursor.peerId};if(qe.secret){const Ve=Qe.findByUserId(e.to);Ve&&(Ve.peerId!=Qe.myCursor.peerId&&Ue.call("PLAY_CUT_IN",qe,Ve.peerId),Ue.call("PLAY_CUT_IN",qe,Qe.myCursor.peerId))}else Ue.call("PLAY_CUT_IN",qe)}if(Oe.names&&Oe.names.length&&!e.to&&this.chatMessageService){const je=new Map;for(const Ve of Oe.names){let We=je.get(Ve)||0;We+=1,je.set(""==Ve?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":Ve,We)}const qe=`${[...je.keys()].map(Ve=>je.get(Ve)>1?`${Ve}\xd7${je.get(Ve)}`:Ve).join("\u3001")}`;this.chatMessageService.sendOperationLog(qe+" \u304c\u8d77\u52d5\u3057\u305f")}}xe.length<Oe.matchMostLongText.length&&(xe=Oe.matchMostLongText),xe&&ge.text&&(ge.text=ge.text.slice(0,ge.text.length-xe.length)),null!=e.to&&0<e.to.length&&(ge.to=e.to,e.to.indexOf(e.from)<0&&(ge.to+=" "+e.from)),Pe&&Pe.addMessage(ge)}static diceRollAsync(n,e,i=1){return(0,gn.Z)(function*(){if(e=e||"DiceBot",In.apiUrl){const r=1==In.apiVersion?In.apiUrl+"/v1/diceroll?system="+(e?encodeURIComponent(e):"DiceBot")+"&command="+encodeURIComponent(n):`${In.apiUrl}/v2/game_system/${e?encodeURIComponent(e):"DiceBot"}/roll?command=${encodeURIComponent(n)}`,o=[];for(let s=1;s<=i;s++)o.push(fetch(r,{mode:"cors"}).then(a=>{if(a.ok)return a.json();throw new Error(a.statusText)}).then(a=>({id:e,result:(1==In.apiVersion?a.result:a.text)+(i>1?` #${s}\n`:""),isSecret:a.secret,isEmptyDice:1==In.apiVersion?a.dices&&0==a.dices.length:a.rands&&0==a.rands.length,isSuccess:a.success,isFailure:a.failure,isCritical:a.critical,isFumble:a.fumble})).catch(a=>({id:e,result:"",isSecret:!1,isEmptyDice:!0})));return Promise.all(o).then(s=>s.reduce((a,h)=>({id:e,result:a.result+h.result,isSecret:a.isSecret||h.isSecret,isEmptyDice:a.isEmptyDice&&h.isEmptyDice,isSuccess:a.isSuccess||h.isSuccess,isFailure:a.isFailure&&h.isFailure,isCritical:a.isCritical||h.isCritical,isFumble:a.isFumble||h.isFumble}),{id:e,result:"",isSecret:!1,isEmptyDice:!0,isSuccess:!1,isFailure:!0,isCritical:!1,isFumble:!1}))}try{let r=yield In.loadGameSystemAsync(e);const o=r.eval(n);return o?(console.log("diceRoll!!!",o),console.log("isSecret!!!",o.secret),console.log("isEmptyDice!!!",!o.rands||0==o.rands.length),{id:r.ID,result:o.text,isSecret:o.secret,isEmptyDice:!o.rands||0==o.rands.length,isSuccess:o.success,isFailure:o.failure,isCritical:o.critical,isFumble:o.fumble}):{id:e,result:"",isSecret:!1,isEmptyDice:!0}}catch(r){console.error(r)}return{id:e,result:"",isSecret:!1,isEmptyDice:!0}})()}static getHelpMessage(n){return(0,gn.Z)(function*(){if(n=n||"DiceBot",In.apiUrl){const e=[fetch(1==In.apiVersion?In.apiUrl+"/v1/systeminfo?system=DiceBot":`${In.apiUrl}/v2/game_system/DiceBot`,{mode:"cors"}).then(i=>i.json())];return n&&"DiceBot"!=n&&e.push(fetch(1==In.apiVersion?In.apiUrl+"/v1/systeminfo?system="+encodeURIComponent(n):`${In.apiUrl}/v2/game_system/${encodeURIComponent(n)}`,{mode:"cors"}).then(i=>i.json())),Promise.all(e).then(i=>i.map(r=>1==In.apiVersion&&r.systeminfo&&r.systeminfo.info?r.systeminfo.info.replace("\u90e8\u5c4b\u306e\u30b7\u30b9\u30c6\u30e0\u540d","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306a\u3069\u306e\u30b7\u30b9\u30c6\u30e0\u540d"):r.help_message?r.help_message.replace("\u90e8\u5c4b\u306e\u30b7\u30b9\u30c6\u30e0\u540d","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306a\u3069\u306e\u30b7\u30b9\u30c6\u30e0\u540d"):"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u60c5\u5831\u304c\u3042\u308a\u307e\u305b\u3093\u3002"))}{let e=[""];try{if(e=[(yield In.loadGameSystemAsync("DiceBot")).HELP_MESSAGE],n&&""!=n&&"DiceBot"!=n){let i=yield In.loadGameSystemAsync(n);e.push(i&&"DiceBot"!=i.ID&&i.HELP_MESSAGE?i.HELP_MESSAGE.replace("\u90e8\u5c4b\u306e\u30b7\u30b9\u30c6\u30e0\u540d","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306a\u3069\u306e\u30b7\u30b9\u30c6\u30e0\u540d"):"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u60c5\u5831\u304c\u3042\u308a\u307e\u305b\u3093\u3002")}}catch(i){console.error(i)}return e}})()}static loadGameSystemAsync(n){var e=this;return(0,gn.Z)(function*(){return yield In.queue.add(()=>{const i=e.diceBotInfos.some(r=>r.id===n)?n:"DiceBot";try{return In.loader.getGameSystemClass(i)}catch{return In.loader.dynamicLoad(i)}})})()}static initializeDiceBotQueue(){let n=new RT("DiceBotQueue");return n.add((0,gn.Z)(function*(){In.loader=new((yield Promise.resolve().then(_e.bind(_e,383))).default),In.diceBotInfos=In.loader.listAvailableGameSystems().filter(e=>"DiceBot"!=e.id).sort((e,i)=>{const r=e.sortKey,o=i.sortKey;return r<o?-1:r>o?1:0}).map(e=>{const i=/.+\:(.+)/.exec(e.id);let r;return i&&i[1]&&(r="ChineseTraditional"==i[1]?"\u6b63\u9ad4\u4e2d\u6587":"Korean"==i[1]?"\ud55c\uad6d\uc5b4":"English"==i[1]?"English":"SimplifiedChinese"==i[1]?"\u7b80\u4f53\u4e2d\u6587":"Other"),{id:e.id,game:e.name,lang:r,sort_key:e.sortKey}})})),n}formatRollResult(n,e="DiceBot"){return null==n?"":n.split("\n").map(i=>{let r=[],o=[],s=[],a=[];return i.split(" \uff1e ").map((h,b,ee)=>{if(1===ee.length)return h;if(0==b){const ge=In.apiUrl&&1==In.apiVersion?/^(?:\: )\((CHOICE(?:\d+)?[\[\( ].+)\)$/i:/^\((CHOICE(?:\d+)?[\[\( ].+)\)$/i,xe=h.match(In.apiUrl&&1==In.apiVersion?/^(?:\: )\(([A-Z\d\+\-\*\/=\(\),\[\]\<\>@]+)\)$/i:/^\(([A-Z\d\+\-\*\/=\(\),\[\]\<\>@]+)\)$/i)||h.match(ge);return xe&&!xe[1].toUpperCase().startsWith("CHOICE")&&(r=[...h.matchAll(/(?<diceCount>\d+)D\d+(?:(?<keepDrop>[KD][HL])(?<keepDropCount>\d+))?/gi)],r.length||(o=[...h.matchAll(/\d+B\d+(?:\+\d+B\d+)*(?:\[6\]Limit\[\d+\])?(?<sign><=|>=|<>|==|!=|<|>|=)(?<criteria>\d+)/gi)],o.length||(s=[...h.matchAll(/\d+R\d+(?:\+\d+R\d+)*\[(?<rerollSign><=|>=|<>|==|!=|<|>|=)?(?<rerollCriteria>\d+)\](?:(?<sign><=|>=|<>|==|!=|<|>|=)(?<criteria>\d+))?/gi)],s.length||(a=[...h.matchAll(/\d+U\d+(?:\+\d+U\d+)*\[(?<rerollCriteria>\d+)\](?<modifier>[\-+]\d+)?(?:(?<sign><=|>=|<>|==|!=|<|>|=)(?<criteria>\d+))?/gi)])))),xe?"\u{1f3b2}"+xe[1]:h}if(b==ee.length-1)return h;if(1==b&&(r.length||o.length||s.length||a.length))try{let de=h;const xe=[...h.matchAll(r.length?/(?<total>\d+)\[(?<diceArrayString>\d+(?:,\d+)*)?\]/gi:a.length?/(?:(?<total>\d+)\[(?<diceArrayString>\d+(?:,\d+)*)?\])|(?<modifier2>[\-+]\d+)|(?<dieString>\d+)/gi:/(?<diceArrayString>\d+(?:,\d+)*)/gi)];if(xe.length){let Pe,ke=0;xe.forEach((Oe,je)=>{if(Pe=Oe[0],r.length){const{diceCount:Ve,keepDrop:We,keepDropCount:vt}=r[je].groups,{total:nt,diceArrayString:_t}=Oe.groups;if(We){const Mt=null!=_t?_t.split(",").sort((Tt,nn)=>+Tt-+nn):[],ht=We.startsWith("K")?vt:Ve-vt;("KH"===We||"DL"===We)&&Mt.reverse();const yt=Mt.map((Tt,nn)=>nn+1<=ht?`${Tt}`:`~~~${Tt}~~~`);("DH"===We||"DL"===We)&&yt.reverse(),Pe=`${nt}[${yt.join(",")}]`}}else if(o.length){const{sign:Ve,criteria:We}=o[0].groups,{diceArrayString:vt}=Oe.groups;Pe=vt.split(",").map(nt=>In.isPass(nt,Ve,We)?`${nt}`:`~~~${nt}~~~`).join(",")}else if(s.length){let{rerollSign:Ve,rerollCriteria:We,sign:vt,criteria:nt}=s[0].groups;Ve||(Ve=vt),We||(We=nt);const{diceArrayString:_t}=Oe.groups;Pe=_t.split(",").map(Mt=>In.isPass(Mt,Ve,We)?`###${Mt}###`:Mt).map(Mt=>In.isPass(Mt,vt,nt,!1)?Mt:`~~~${Mt}~~~`).join(",")}else if(a.length){const{rerollCriteria:Ve,modifier:We,sign:vt,criteria:nt}=a[0].groups,{total:_t,diceArrayString:Mt,modifier2:ht,dieString:yt}=Oe.groups;if(console.log(a[0],Oe),ht)Pe=` (${ht})`;else if(_t)Pe=_t+"["+Mt.split(",").map(Tt=>In.isPass(Tt,">=",Ve)?`###${Tt}###`:Tt).join(",")+"]",In.isPass(+_t+(We?+We:0),vt,nt)||(Pe=`~~~${Pe}~~~`);else{let Tt=Pe;Pe=In.isPass(yt,">=",Ve)?`###${yt}###`:yt,In.isPass(+Tt+(We?+We:0),vt,nt)||(Pe=`~~~${Pe}~~~`)}}const qe=de.indexOf(Oe[0],ke);Pe!=Oe[0]&&(de=de.substring(0,qe)+Pe+de.substring(qe+Oe[0].length)),ke=qe+Pe.length})}h=de}catch(de){console.error(de)}else if(1==b&&"DungeonsAndDragons5"==e&&(ee[0].startsWith("(AT")||ee[0].startsWith("(AR"))){const de=ee[0].startsWith("(AT"),ge=ee[0].endsWith("A)"),xe=ee[0].endsWith("D)");if(ge||xe){const ke=h.match(/\[(?<diceArrayString>\d+(?:,\d+)*)?\](?<modifier>[\-+]\d+)?/i);if(!ke)return h;const{diceArrayString:Pe,modifier:Oe}=ke.groups,je=Pe.split(",").map(We=>parseInt(We)),qe=ge?Math.max(...je):Math.min(...je);let Ve=!1;h="["+je.map(We=>{let vt=!de||20!==We&&1!==We?We.toString():`###${We}###`;return Ve||We!==qe?vt=`~~~${vt}~~~`:Ve=!0,vt}).join(",")+"]"+(Oe||"")}else if(de){const ke=h.match(/(?<diceString>\d+)?(?<modifier>[\-+]\d+)?/i);if(ke){const{diceString:Pe,modifier:Oe}=ke.groups;Pe&&(20===parseInt(Pe)||1===parseInt(Pe))&&(h=`###${Pe}###${Oe||""}`)}}}return h}).join(" \u2192 ")}).join("\n")}static isPass(n,e,i,r=!0){if(null==n)return r;let o=n.toString().match(/(\d+)/);o&&(n=o[1]);let s=r;switch(e){case"==":case"=":s=+n==+i;break;case"!=":case"<>":s=+n!=+i;break;case">=":s=+n>=+i;break;case"<=":s=+n<=+i;break;case"<":s=+n<+i;break;case">":s=+n>+i}return s}};function JT(t,n){if(Array.prototype.indexOf)return t.indexOf(n);for(var e=0,i=t.length;e<i;e++)if(t[e]===n)return e;return-1}function _c(t,n){for(var e=t.length-1;e>=0;e--)!0===n(t[e])&&t.splice(e,1)}function pv(t){throw new Error("Unhandled case for value: '".concat(t,"'"))}ii.queue=In.initializeDiceBotQueue(),ii.loader=new Bz.default,ii.apiUrl=null,ii.apiVersion=1,ii.adminUrl=null,ii.diceBotInfos=[],ii.diceBotInfosIndexed=[],ii.replaceData=[["\u65b0\u30af\u30c8\u30a5\u30eb\u30d5","\u30b7\u30f3\u30af\u30c8\u30a6\u30eb\u30d5\u30b7\u30f3\u30efTRPG","\u65b0\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG"],["\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG","\u30af\u30c8\u30a6\u30eb\u30d5\u30b7\u30f3\u30efTRPG","(\u65e7) \u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG"],["\ud06c\ud234\ub8e8","\ud06c\ud234\ub8e8\uc758 \ubd80\ub984 6\ud310","\ud06c\ud234\ub8e8\uc758 \ubd80\ub984 6\ud310"],["\u514b\u8607\u9b6f\u795e\u8a71","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c\u516d\u7248","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c\u516d\u7248"],["\u514b\u8607\u9b6f\u795e\u8a71\u7b2c7\u7248","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c7\u7248","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c\u4e03\u7248"],["\u30c0\u30d6\u30eb\u30af\u30ed\u30b92nd,3rd","\u30bf\u30d5\u30eb\u30af\u30ed\u30b9 The 2nd Edition/The 3rd Edtion","\u30c0\u30d6\u30eb\u30af\u30ed\u30b9 The 2nd Edition, The 3rd Edtion"],["\u30c8\u30fc\u30b0","\u30c8\u30aa\u30af","\u30c8\u30fc\u30b0\uff08TORG\uff09"],["\u30ef\u30fc\u30d7\u30b9","\u30ef\u30a2\u30d5\u30b9","WARPS"],["\u30c8\u30fc\u30b01.5\u7248","\u30c8\u30aa\u30af1.5\u30cf\u30f3","\u30c8\u30fc\u30b0\uff08TORG\uff09 1.5\u7248"],["\u30c8\u30fc\u30b0 \u30a8\u30bf\u30cb\u30c6\u30a3","\u30c8\u30aa\u30af\u30a8\u30bf\u30cb\u30c6\u30a4","\u30c8\u30fc\u30b0\uff08TORG\uff09 \u30a8\u30bf\u30cb\u30c6\u30a3"],["\u5fc3\u885d\u60f3\u6a5fTRPG\u30a2\u30eb\u30c8\u30ec\u30a4\u30ba","\u30b7\u30f3\u30b7\u30e8\u30a6\u30bd\u30a6\u30adTRPG\u30a2\u30eb\u30c8\u30ec\u30a4\u30b9","\u5fc3\u885d\u60f3\u6a5fTRPG \u30a2\u30eb\u30c8\u30ec\u30a4\u30ba"],["\u30d1\u30e9\u30b5\u30a4\u30c8\u30d6\u30e9\u30c3\u30c9RPG","\u30cf\u30e9\u30b5\u30a4\u30c8\u30d5\u30e9\u30c4\u30c8","\u30d1\u30e9\u30b5\u30a4\u30c8\u30d6\u30e9\u30c3\u30c9"],["\u72af\u7f6a\u6d3b\u5287RPG\u30d0\u30c3\u30c9\u30e9\u30a4\u30d5","\u30cf\u30f3\u30b5\u30a4\u30ab\u30c4\u30b1\u30adRPG\u30cf\u30c4\u30c8\u30e9\u30a4\u30d5","\u72af\u7f6a\u6d3b\u5287RPG\u30d0\u30c3\u30c9\u30e9\u30a4\u30d5"],["\u6643\u5929\u306e\u30a4\u30eb\u30fc\u30b8\u30aa","\u30b3\u30a6\u30c6\u30f3\u30ce\u30a4\u30eb\u30a6\u30b7\u30aa","\u6643\u5929\u306e\u30a4\u30eb\u30fc\u30b8\u30aa"],["\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb","\u30cf\u30af\u30eb\u30de\u30ce\u30c8\u30a6\u30ce\u30b9\u30ab\u30a4\u30ce\u30aa\u30c4","\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb"],["\u5728\u308a\u3066\u904d\u304f\u30aa\u30eb\u30ac\u30ec\u30a4\u30f3","\u30a2\u30ea\u30c6\u30a2\u30de\u30cd\u30af\u30aa\u30eb\u30ab\u30ec\u30a4\u30f3","\u5728\u308a\u3066\u904d\u304f\u30aa\u30eb\u30ac\u30ec\u30a4\u30f3"],["Pathfinder","\u30cf\u30b9\u30d5\u30a2\u30a4\u30f3\u30bf\u30a2RPG","\u30d1\u30b9\u30d5\u30a1\u30a4\u30f3\u30c0\u30fcRPG"],["\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG\u3000\u899a\u9192\u7de8","\u30b7\u30f3\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4TRPG\u30ab\u30af\u30bb\u30a4\u30d8\u30f3","\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG \u899a\u9192\u7bc7"],["\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG\u3000\u899a\u9192\u7bc7","\u30b7\u30f3\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4TRPG\u30ab\u30af\u30bb\u30a4\u30d8\u30f3","\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG \u899a\u9192\u7bc7"],["YearZeroEngine","\u30a4\u30e4\u30a2\u30bb\u30ed\u30a8\u30f3\u30b7\u30f3","Year Zero Engine"],["Year Zero Engine","\u30a4\u30e4\u30a2\u30bb\u30ed\u30a8\u30f3\u30b7\u30f3","Year Zero Engine"],["ADVANCED FIGHTING FANTASY 2nd Edition","\u30a2\u30c8\u30cf\u30f3\u30b9\u30c8\u30d5\u30a1\u30a4\u30c6\u30a4\u30f3\u30af\u30d5\u30a1\u30f3\u30bf\u30b7\u30a4\u30bf\u30a42\u30cf\u30f3","\u30a2\u30c9\u30d0\u30f3\u30b9\u30c8\u30fb\u30d5\u30a1\u30a4\u30c6\u30a3\u30f3\u30b0\u30fb\u30d5\u30a1\u30f3\u30bf\u30b8\u30fc \u7b2c2\u7248"],["Vampire: The Masquerade 5th Edition","\u30a6\u30a2\u30f3\u30cf\u30a4\u30a2\u30b5\u30de\u30b9\u30ab\u30ec\u30a8\u30c8\u30bf\u30a45\u30cf\u30f3","\u30f4\u30a1\u30f3\u30d1\u30a4\u30a2\uff1a\u30b6\u30fb\u30de\u30b9\u30ab\u30ec\u30fc\u30c9 \u7b2c5\u7248"],["\u30ef\u30fc\u30eb\u30c9\u30aa\u30d6\u30c0\u30fc\u30af\u30cd\u30b9","\u30ef\u30a2\u30eb\u30c8\u30aa\u30d5\u30bf\u30a2\u30af\u30cd\u30b9","\u30ef\u30fc\u30eb\u30c9\u30fb\u30aa\u30d6\u30fb\u30c0\u30fc\u30af\u30cd\u30b9"],["\u30e2\u30ce\u30c8\u30fc\u30f3\u30fb\u30df\u30e5\u30fc\u30b8\u30a2\u30e0","\u30e2\u30ce\u30c8\u30aa\u30f3\u30df\u30e6\u30a6\u30b7\u30a2\u30e0","\u30e2\u30ce\u30c8\u30fc\u30f3\u30df\u30e5\u30fc\u30b8\u30a2\u30e0"],["\u5263\u306e\u8857\u306e\u7570\u90a6\u4ebaTRPG","\u30c4\u30eb\u30ad\u30ce\u30de\u30c1\u30ce\u30a4\u30db\u30a6\u30b7\u30f3TRPG"],["\u58ca\u308c\u305f\u4e16\u754c\u306e\u30dd\u30b9\u30c8\u30de\u30f3","\u30b3\u30ef\u30ec\u30bf\u30bb\u30ab\u30a4\u30ce\u30db\u30b9\u30c8\u30de\u30f3","\u58ca\u308c\u305f\u4e16\u754c\u306e\u30dd\u30b9\u30c8\u30de\u30f3"],["\u7d2b\u7e1e\u306e\u30ea\u30f4\u30e9\u30c9\u30fc\u30eb","\u30b7\u30b7\u30de\u30ce\u30ea\u30d5\u30e9\u30c8\u30aa\u30eb","\u7d2b\u7e1e\u306e\u30ea\u30f4\u30e9\u30c9\u30fc\u30eb"],["SRS\u6c4e\u7528(\u6539\u9020\u7248)","\u30b9\u30bf\u30f3\u30bf\u30a2\u30c8RPG\u30b7\u30b9\u30c6\u30e0\u30aa\u30eb\u30bf\u30ca\u30c6\u30a4\u30d5\u30cf\u30f3","SRS\u6c4e\u7528 \u30aa\u30eb\u30bf\u30ca\u30c6\u30a3\u30f4"],["Standard RPG System","\u30b9\u30bf\u30f3\u30bf\u30a2\u30c8RPG\u30b7\u30b9\u30c6\u30e0","\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0\uff08SRS\uff09"],["\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0","\u30b9\u30bf\u30f3\u30bf\u30a2\u30c8RPG\u30b7\u30b9\u30c6\u30e0","\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0\uff08SRS\uff09"],["NJSLYRBATTLE","\u30cb\u30f3\u30b7\u30e4\u30b9\u30ec\u30a4\u30e4\u30a2\u30cf\u30c8\u30eb"],["Record of Steam","\u30ec\u30b3\u30aa\u30c8\u30aa\u30d5\u30b9\u30c1\u30a4\u30e0"],["\u8a69\u7247\u306e\u30a2\u30eb\u30bb\u30c3\u30c8","\u30a6\u30bf\u30ab\u30bf\u30ce\u30a2\u30eb\u30bb\u30c4\u30c8"],["Shared\u2020Fantasia","\u30b7\u30a8\u30a2\u30a2\u30c8\u30d5\u30a2\u30f3\u30bf\u30b7\u30a2"],["\u771f\u30fb\u5973\u795e\u8ee2\u751f","\u30b7\u30f3\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4"],["\u5973\u795e\u8ee2\u751f","\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4"],["\u899a\u9192\u7bc7","\u30ab\u30af\u30bb\u30a4\u30d8\u30f3"],["Chill","\u30c1\u30eb"],["BBNTRPG","\u30d2\u30a4\u30d2\u30a4\u30a8\u30ccTRPG","BBNTRPG (Black Black Network TRPG)"],["TORG Eternity","\u30c8\u30aa\u30af\u30a8\u30bf\u30a2\u30cb\u30c6\u30a4"],["\u30ac\u30fc\u30d7\u30b9","\u30ab\u30a2\u30d5\u30b9","GURPS"],["\u30ac\u30fc\u30d7\u30b9\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba","\u30ab\u30a2\u30d5\u30b9\u30d5\u30a4\u30eb\u30c8\u30a6\u30a4\u30b9","GURPS\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba"],["\u7d76\u5bfe\u96b7\u5974","\u30bb\u30c4\u30bf\u30a4\u30ec\u30a4\u30c8"],["\u30bb\u30e9\u30d5\u30a3\u30b6\u30a4\u30f3","\u30bb\u30a4\u30b7\u30e6\u30f3\u30b7\u30c4\u30ab\u30f3TRPG\u30bb\u30e9\u30d5\u30a4\u30b5\u30a4\u30f3","\u9752\u6625\u75be\u60a3TRPG \u30bb\u30e9\u30d5\u30a3\u30b6\u30a4\u30f3"],["\u8266\u3053\u308c","\u30ab\u30f3\u30b3\u30ec"],["\u795e\u6211\u72e9","\u30ab\u30df\u30ab\u30ab\u30ea"],["\u9d7a\u93e1","\u30cc\u30a8\u30ab\u30ab\u30df"],["\u30c8\u30fc\u30ad\u30e7\u30fc","\u30c8\u30aa\u30ad\u30e8\u30a6"],["\uff2e\u25ce\uff36\uff21","\u30ce\u30a6\u30a2"],["\u521d\u97f3\u30df\u30af","\u30cf\u30c4\u30cd\u30df\u30af"],["\u6731\u306e\u5b64\u5854","\u30a2\u30b1\u30ce\u30b3\u30c8\u30a6"],["\u5728\u308a\u3066\u904d\u304f","\u30a2\u30ea\u30c6\u30a2\u30de\u30cd\u30af"],["\u592e\u83ef\u5c01\u795e","\u30aa\u30a6\u30ab\u30db\u30a6\u30b7\u30f3"],["\u5fc3\u885d\u60f3\u6a5f","\u30b7\u30f3\u30b7\u30e8\u30a6\u30bd\u30a6\u30ad"],["\u80ce\u3088\u308a\u60f3\u3048","\u30cf\u30e9\u30e8\u30ea\u30aa\u30e2\u30a8"],["\u5c55\u721b\u4f1a","\u30c6\u30f3\u30e9\u30f3\u30ab\u30a4"],["\u58ca\u308c\u305f","\u30b3\u30ef\u30ec\u30bf"],["\u6bd4\u53e1\u5c71","\u30d2\u30a8\u30a4\u30b5\u30f3"],["\u4e16\u754c\u6a39","\u30bb\u30ab\u30a4\u30b7\u30e6"],["\u7570\u90a6\u4eba","\u30a4\u30db\u30a6\u30b7\u30f3"],["\u8ee2\u653b\u751f","\u30c6\u30f3\u30b3\u30a6\u30bb\u30a4"],["\u63a2\u7a7a\u58eb","\u30b9\u30ab\u30a4\u30ce\u30aa\u30c4"],["\u5263\u306e\u8857","\u30c4\u30eb\u30ad\u30ce\u30de\u30c1"],["\u9ed2\u7d62","\u30b3\u30c4\u30b1\u30f3"],["\u7d2b\u7e1e","\u30b7\u30b7\u30de"],["\u7834\u754c","\u30cf\u30ab\u30a4"],["\u9280\u5263","\u30ad\u30f3\u30b1\u30f3"],["\u6771\u4eac","\u30c8\u30a6\u30ad\u30e8\u30a6"],["\u7247\u9053","\u30ab\u30bf\u30df\u30c1"],["\u52c7\u8005","\u30e6\u30a6\u30b7\u30e4"],["\u5c11\u5973","\u30b7\u30e8\u30a6\u30b7\u30e8"],["\u771f\u7a7a","\u30b7\u30f3\u30af\u30a6"],["\u5b66\u5712","\u30ab\u30af\u30a8\u30f3"],["\u4e16\u754c","\u30bb\u30ab\u30a4"],["\u9752\u6625","\u30bb\u30a4\u30b7\u30e6\u30f3"],["\u75be\u60a3","\u30b7\u30c4\u30ab\u30f3"],["\u8ff7\u5bae","\u30e1\u30a4\u30ad\u30e6\u30a6"],["\u6b6f\u8eca","\u30cf\u30af\u30eb\u30de"],["\u84bc\u5929","\u30bd\u30a6\u30c6\u30f3"],["\u589c\u843d","\u30c4\u30a4\u30e9\u30af"],["\u7279\u547d","\u30c8\u30af\u30e1\u30a4"],["\u6643\u5929","\u30b3\u30a6\u30c6\u30f3"],["\u53db\u9006","\u30cf\u30f3\u30ad\u30e4\u30af"],["\u72af\u7f6a","\u30cf\u30f3\u30b5\u30a4"],["\u6d3b\u5287","\u30ab\u30c4\u30b1\u30ad"],["\u78a7\u7a7a","\u30d8\u30ad\u30af\u30a6"],["\u84ec\u83b1","\u30db\u30a6\u30e9\u30a4"],["\u5192\u967a","\u30db\u30a6\u30b1\u30f3"],["\u516d\u9580","\u30ed\u30af\u30e2\u30f3"],["\u708e\u4e0a","\u30a8\u30f3\u30b7\u30e8\u30a6"],["\u7121\u9650","\u30e0\u30b1\u30f3"],["\u5854","\u30c8\u30a6"],["\u7363","\u30b1\u30e2\u30ce"],["\u7378","\u30b1\u30e2\u30ce"],["\u68ee","\u30e2\u30ea"],["&","\u30a2\u30f3\u30c8"],["\uff06","\u30a2\u30f3\u30c8"],["\u30f4\u30a1","\u30cf"],["\u30f4\u30a3","\u30d2"],["\u30f4\u30a7","\u30d8"],["\u30f4\u30a9","\u30db"],["\u30f4","\u30d5"],["\u30a1","\u30a2"],["\u30a3","\u30a4"],["\u30a5","\u30a6"],["\u30a7","\u30a8"],["\u30a9","\u30aa"],["\u30e3","\u30e4"],["\u30e5","\u30e6"],["\u30e7","\u30e8"],["\u30c3","\u30c4"],["\u30f2","\u30aa"],["\u30ac","\u30ab"],["\u30ae","\u30ad"],["\u30b0","\u30af"],["\u30b2","\u30b1"],["\u30b4","\u30b3"],["\u30b6","\u30b5"],["\u30b8","\u30b7"],["\u30ba","\u30b9"],["\u30bc","\u30bb"],["\u30be","\u30bd"],["\u30c0","\u30bf"],["\u30c2","\u30c1"],["\u30c5","\u30c4"],["\u30c7","\u30c6"],["\u30c9","\u30c8"],["\u30d0","\u30cf"],["\u30d3","\u30d2"],["\u30d6","\u30d5"],["\u30d9","\u30d8"],["\u30dc","\u30db"],["\u30d1","\u30cf"],["\u30d4","\u30d2"],["\u30d7","\u30d5"],["\u30da","\u30d8"],["\u30dd","\u30db"]],ii=In=$e([mi("dice-bot")],ii);var e,gv=function(){function t(n){void 0===n&&(n={}),this.tagName="",this.attrs={},this.innerHTML="",this.whitespaceRegex=/\s+/,this.tagName=n.tagName||"",this.attrs=n.attrs||{},this.innerHTML=n.innerHtml||n.innerHTML||""}return t.prototype.setTagName=function(n){return this.tagName=n,this},t.prototype.getTagName=function(){return this.tagName||""},t.prototype.setAttr=function(n,e){return this.getAttrs()[n]=e,this},t.prototype.getAttr=function(n){return this.getAttrs()[n]},t.prototype.setAttrs=function(n){return Object.assign(this.getAttrs(),n),this},t.prototype.getAttrs=function(){return this.attrs||(this.attrs={})},t.prototype.setClass=function(n){return this.setAttr("class",n)},t.prototype.addClass=function(n){for(var s,e=this.getClass(),i=this.whitespaceRegex,r=e?e.split(i):[],o=n.split(i);s=o.shift();)-1===JT(r,s)&&r.push(s);return this.getAttrs().class=r.join(" "),this},t.prototype.removeClass=function(n){for(var s,e=this.getClass(),i=this.whitespaceRegex,r=e?e.split(i):[],o=n.split(i);r.length&&(s=o.shift());){var a=JT(r,s);-1!==a&&r.splice(a,1)}return this.getAttrs().class=r.join(" "),this},t.prototype.getClass=function(){return this.getAttrs().class||""},t.prototype.hasClass=function(n){return-1!==(" "+this.getClass()+" ").indexOf(" "+n+" ")},t.prototype.setInnerHTML=function(n){return this.innerHTML=n,this},t.prototype.setInnerHtml=function(n){return this.setInnerHTML(n)},t.prototype.getInnerHTML=function(){return this.innerHTML||""},t.prototype.getInnerHtml=function(){return this.getInnerHTML()},t.prototype.toAnchorString=function(){var n=this.getTagName(),e=this.buildAttrsStr();return["<",n,e=e?" "+e:"",">",this.getInnerHtml(),"</",n,">"].join("")},t.prototype.buildAttrsStr=function(){if(!this.attrs)return"";var n=this.getAttrs(),e=[];for(var i in n)n.hasOwnProperty(i)&&e.push(i+'="'+n[i]+'"');return e.join(" ")},t}(),eS=function(){function t(n){void 0===n&&(n={}),this.newWindow=!1,this.truncate={},this.className="",this.newWindow=n.newWindow||!1,this.truncate=n.truncate||{},this.className=n.className||""}return t.prototype.build=function(n){return new gv({tagName:"a",attrs:this.createAttrs(n),innerHtml:this.processAnchorText(n.getAnchorText())})},t.prototype.createAttrs=function(n){var e={href:n.getAnchorHref()},i=this.createCssClass(n);return i&&(e.class=i),this.newWindow&&(e.target="_blank",e.rel="noopener noreferrer"),this.truncate&&this.truncate.length&&this.truncate.length<n.getAnchorText().length&&(e.title=n.getAnchorHref()),e},t.prototype.createCssClass=function(n){var e=this.className;if(e){for(var i=[e],r=n.getCssClassSuffixes(),o=0,s=r.length;o<s;o++)i.push(e+"-"+r[o]);return i.join(" ")}return""},t.prototype.processAnchorText=function(n){return this.doTruncate(n)},t.prototype.doTruncate=function(n){var e=this.truncate;if(!e||!e.length)return n;var i=e.length,r=e.location;return"smart"===r?function U7(t,n,e){var i,r;null==e?(e="&hellip;",r=3,i=8):(r=e.length,i=e.length);var s=function(qe){var Ve="";return qe.scheme&&qe.host&&(Ve+=qe.scheme+"://"),qe.host&&(Ve+=qe.host),qe.path&&(Ve+="/"+qe.path),qe.query&&(Ve+="?"+qe.query),qe.fragment&&(Ve+="#"+qe.fragment),Ve},a=function(qe,Ve){var We=Ve/2,vt=Math.ceil(We),nt=-1*Math.floor(We),_t="";return nt<0&&(_t=qe.substr(nt)),qe.substr(0,vt)+e+_t};if(t.length<=n)return t;var Ve,We,vt,h=n-r,b=(Ve={},(vt=(We=t).match(/^([a-z]+):\/\//i))&&(Ve.scheme=vt[1],We=We.substr(vt[0].length)),(vt=We.match(/^(.*?)(?=(\?|#|\/|$))/i))&&(Ve.host=vt[1],We=We.substr(vt[0].length)),(vt=We.match(/^\/(.*?)(?=(\?|#|$))/i))&&(Ve.path=vt[1],We=We.substr(vt[0].length)),(vt=We.match(/^\?(.*?)(?=(#|$))/i))&&(Ve.query=vt[1],We=We.substr(vt[0].length)),(vt=We.match(/^#(.*?)$/i))&&(Ve.fragment=vt[1]),Ve);if(b.query){var ee=b.query.match(/^(.*?)(?=(\?|\#))(.*?)$/i);ee&&(b.query=b.query.substr(0,ee[1].length),t=s(b))}if(t.length<=n||(b.host&&(b.host=b.host.replace(/^www\./,""),t=s(b)),t.length<=n))return t;var de="";if(b.host&&(de+=b.host),de.length>=h)return b.host.length==n?(b.host.substr(0,n-r)+e).substr(0,h+i):a(de,h).substr(0,h+i);var ge="";if(b.path&&(ge+="/"+b.path),b.query&&(ge+="?"+b.query),ge){if((de+ge).length>=h)return(de+ge).length==n?(de+ge).substr(0,n):(de+a(ge,h-de.length)).substr(0,h+i);de+=ge}if(b.fragment){var ke="#"+b.fragment;if((de+ke).length>=h)return(de+ke).length==n?(de+ke).substr(0,n):(de+a(ke,h-de.length)).substr(0,h+i);de+=ke}if(b.scheme&&b.host){var Oe=b.scheme+"://";if((de+Oe).length<h)return(Oe+de).substr(0,n)}if(de.length<=n)return de;var je="";return h>0&&(je=de.substr(-1*Math.floor(h/2))),(de.substr(0,Math.ceil(h/2))+e+je).substr(0,h+i)}(n,i):"middle"===r?function H7(t,n,e){if(t.length<=n)return t;var i,r;null==e?(e="&hellip;",i=8,r=3):(i=e.length,r=e.length);var o=n-r,s="";return o>0&&(s=t.substr(-1*Math.floor(o/2))),(t.substr(0,Math.ceil(o/2))+e+s).substr(0,o+i)}(n,i):function V7(t,n,e){return function z7(t,n,e){var i;return t.length>n&&(null==e?(e="&hellip;",i=3):i=e.length,t=t.substring(0,n-i)+e),t}(t,n,e)}(n,i)},t}(),Nu=function(){function t(n){this.__jsduckDummyDocProp=null,this.matchedText="",this.offset=0,this.tagBuilder=n.tagBuilder,this.matchedText=n.matchedText,this.offset=n.offset}return t.prototype.getMatchedText=function(){return this.matchedText},t.prototype.setOffset=function(n){this.offset=n},t.prototype.getOffset=function(){return this.offset},t.prototype.getCssClassSuffixes=function(){return[this.getType()]},t.prototype.buildTag=function(){return this.tagBuilder.build(this)},t}(),tS=function(t){function n(e){var i=t.call(this,e)||this;return i.email="",i.email=e.email,i}return Ie(n,t),n.prototype.getType=function(){return"email"},n.prototype.getEmail=function(){return this.email},n.prototype.getAnchorHref=function(){return"mailto:"+this.email},n.prototype.getAnchorText=function(){return this.email},n}(Nu),nS=function(t){function n(e){var i=t.call(this,e)||this;return i.serviceName="",i.hashtag="",i.serviceName=e.serviceName,i.hashtag=e.hashtag,i}return Ie(n,t),n.prototype.getType=function(){return"hashtag"},n.prototype.getServiceName=function(){return this.serviceName},n.prototype.getHashtag=function(){return this.hashtag},n.prototype.getAnchorHref=function(){var e=this.serviceName,i=this.hashtag;switch(e){case"twitter":return"https://twitter.com/hashtag/"+i;case"facebook":return"https://www.facebook.com/hashtag/"+i;case"instagram":return"https://instagram.com/explore/tags/"+i;case"tiktok":return"https://www.tiktok.com/tag/"+i;default:throw new Error("Unknown service name to point hashtag to: "+e)}},n.prototype.getAnchorText=function(){return"#"+this.hashtag},n}(Nu),iS=function(t){function n(e){var i=t.call(this,e)||this;return i.serviceName="twitter",i.mention="",i.mention=e.mention,i.serviceName=e.serviceName,i}return Ie(n,t),n.prototype.getType=function(){return"mention"},n.prototype.getMention=function(){return this.mention},n.prototype.getServiceName=function(){return this.serviceName},n.prototype.getAnchorHref=function(){switch(this.serviceName){case"twitter":return"https://twitter.com/"+this.mention;case"instagram":return"https://instagram.com/"+this.mention;case"soundcloud":return"https://soundcloud.com/"+this.mention;case"tiktok":return"https://www.tiktok.com/@"+this.mention;default:throw new Error("Unknown service name to point mention to: "+this.serviceName)}},n.prototype.getAnchorText=function(){return"@"+this.mention},n.prototype.getCssClassSuffixes=function(){var e=t.prototype.getCssClassSuffixes.call(this),i=this.getServiceName();return i&&e.push(i),e},n}(Nu),rS=function(t){function n(e){var i=t.call(this,e)||this;return i.number="",i.plusSign=!1,i.number=e.number,i.plusSign=e.plusSign,i}return Ie(n,t),n.prototype.getType=function(){return"phone"},n.prototype.getPhoneNumber=function(){return this.number},n.prototype.getNumber=function(){return this.getPhoneNumber()},n.prototype.getAnchorHref=function(){return"tel:"+(this.plusSign?"+":"")+this.number},n.prototype.getAnchorText=function(){return this.matchedText},n}(Nu),oS=function(t){function n(e){var i=t.call(this,e)||this;return i.url="",i.urlMatchType="scheme",i.protocolUrlMatch=!1,i.protocolRelativeMatch=!1,i.stripPrefix={scheme:!0,www:!0},i.stripTrailingSlash=!0,i.decodePercentEncoding=!0,i.schemePrefixRegex=/^(https?:\/\/)?/i,i.wwwPrefixRegex=/^(https?:\/\/)?(www\.)?/i,i.protocolRelativeRegex=/^\/\//,i.protocolPrepended=!1,i.urlMatchType=e.urlMatchType,i.url=e.url,i.protocolUrlMatch=e.protocolUrlMatch,i.protocolRelativeMatch=e.protocolRelativeMatch,i.stripPrefix=e.stripPrefix,i.stripTrailingSlash=e.stripTrailingSlash,i.decodePercentEncoding=e.decodePercentEncoding,i}return Ie(n,t),n.prototype.getType=function(){return"url"},n.prototype.getUrlMatchType=function(){return this.urlMatchType},n.prototype.getUrl=function(){var e=this.url;return!this.protocolRelativeMatch&&!this.protocolUrlMatch&&!this.protocolPrepended&&(e=this.url="http://"+e,this.protocolPrepended=!0),e},n.prototype.getAnchorHref=function(){return this.getUrl().replace(/&amp;/g,"&")},n.prototype.getAnchorText=function(){var e=this.getMatchedText();return this.protocolRelativeMatch&&(e=this.stripProtocolRelativePrefix(e)),this.stripPrefix.scheme&&(e=this.stripSchemePrefix(e)),this.stripPrefix.www&&(e=this.stripWwwPrefix(e)),this.stripTrailingSlash&&(e=this.removeTrailingSlash(e)),this.decodePercentEncoding&&(e=this.removePercentEncoding(e)),e},n.prototype.stripSchemePrefix=function(e){return e.replace(this.schemePrefixRegex,"")},n.prototype.stripWwwPrefix=function(e){return e.replace(this.wwwPrefixRegex,"$1")},n.prototype.stripProtocolRelativePrefix=function(e){return e.replace(this.protocolRelativeRegex,"")},n.prototype.removeTrailingSlash=function(e){return"/"===e.charAt(e.length-1)&&(e=e.slice(0,-1)),e},n.prototype.removePercentEncoding=function(e){var i=e.replace(/%22/gi,"&quot;").replace(/%26/gi,"&amp;").replace(/%27/gi,"&#39;").replace(/%3C/gi,"&lt;").replace(/%3E/gi,"&gt;");try{return decodeURIComponent(i)}catch{return i}},n}(Nu),Ou=function t(n){this.__jsduckDummyDocProp=null,this.tagBuilder=n.tagBuilder},mv=/[A-Za-z]/,G7=/[\d]/,q7=/[\D]/,$c=/\s/,_v=/['"]/,W7=/[\x00-\x1F\x7F]/,sS=/A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC/.source,aS=sS+/\u2700-\u27bf\udde6-\uddff\ud800-\udbff\udc00-\udfff\ufe0e\ufe0f\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0\ud83c\udffb-\udfff\u200d\u3299\u3297\u303d\u3030\u24c2\ud83c\udd70-\udd71\udd7e-\udd7f\udd8e\udd91-\udd9a\udde6-\uddff\ude01-\ude02\ude1a\ude2f\ude32-\ude3a\ude50-\ude51\u203c\u2049\u25aa-\u25ab\u25b6\u25c0\u25fb-\u25fe\u00a9\u00ae\u2122\u2139\udc04\u2600-\u26FF\u2b05\u2b06\u2b07\u2b1b\u2b1c\u2b50\u2b55\u231a\u231b\u2328\u23cf\u23e9-\u23f3\u23f8-\u23fa\udccf\u2935\u2934\u2190-\u21ff/.source+/\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D4-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D01-\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF8\u1CF9\u1DC0-\u1DF5\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F/.source,gg=/0-9\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19/.source,Z7=aS+gg,Ri=aS+gg,Nf=new RegExp("[".concat(Ri,"]")),X7="(?:["+gg+"]{1,3}\\.){3}["+gg+"]{1,3}",Q7="["+Ri+"](?:["+Ri+"\\-_]{0,61}["+Ri+"])?",lS=function(t){return"(?=("+Q7+"))\\"+t},$v=function(t){return"(?:"+lS(t)+"(?:\\."+lS(t+1)+"){0,126}|"+X7+")"},mg=(new RegExp("["+Ri+".\\-]*["+Ri+"\\-]"),Nf),cS=/(?:xn--vermgensberatung-pwb|xn--vermgensberater-ctb|xn--clchc0ea0b2g2a9gcd|xn--w4r85el8fhu5dnra|northwesternmutual|travelersinsurance|verm\xf6gensberatung|xn--5su34j936bgsg|xn--bck1b9a5dre4c|xn--mgbah1a3hjkrd|xn--mgbai9azgqp6j|xn--mgberp4a5d4ar|xn--xkc2dl3a5ee0h|verm\xf6gensberater|xn--fzys8d69uvgm|xn--mgba7c0bbn0a|xn--mgbcpq6gpa1a|xn--xkc2al3hye2a|americanexpress|kerryproperties|sandvikcoromant|xn--i1b6b1a6a2e|xn--kcrx77d1x4a|xn--lgbbat1ad8j|xn--mgba3a4f16a|xn--mgbaakc7dvf|xn--mgbc0a9azcg|xn--nqv7fs00ema|americanfamily|bananarepublic|cancerresearch|cookingchannel|kerrylogistics|weatherchannel|xn--54b7fta0cc|xn--6qq986b3xl|xn--80aqecdr1a|xn--b4w605ferd|xn--fiq228c5hs|xn--h2breg3eve|xn--jlq480n2rg|xn--jlq61u9w7b|xn--mgba3a3ejt|xn--mgbaam7a8h|xn--mgbayh7gpa|xn--mgbbh1a71e|xn--mgbca7dzdo|xn--mgbi4ecexp|xn--mgbx4cd0ab|xn--rvc1e0am3e|international|lifeinsurance|travelchannel|wolterskluwer|xn--cckwcxetd|xn--eckvdtc9d|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--h2brj9c8c|xn--tiq49xqyj|xn--yfro4i67o|xn--ygbi2ammx|construction|lplfinancial|scholarships|versicherung|xn--3e0b707e|xn--45br5cyl|xn--4dbrk0ce|xn--80adxhks|xn--80asehdb|xn--8y0a063a|xn--gckr3f0f|xn--mgb9awbf|xn--mgbab2bd|xn--mgbgu82a|xn--mgbpl2fh|xn--mgbt3dhd|xn--mk1bu44c|xn--ngbc5azd|xn--ngbe9e0a|xn--ogbpf8fl|xn--qcka1pmc|accountants|barclaycard|blackfriday|blockbuster|bridgestone|calvinklein|contractors|creditunion|engineering|enterprises|foodnetwork|investments|kerryhotels|lamborghini|motorcycles|olayangroup|photography|playstation|productions|progressive|redumbrella|williamhill|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--3bst00m|xn--3ds443g|xn--3hcrj9c|xn--42c2d9a|xn--45brj9c|xn--55qw42g|xn--6frz82g|xn--80ao21a|xn--9krt00a|xn--cck2b3b|xn--czr694b|xn--d1acj3b|xn--efvy88h|xn--fct429k|xn--fjq720a|xn--flw351e|xn--g2xx48c|xn--gecrj9c|xn--gk3at1e|xn--h2brj9c|xn--hxt814e|xn--imr513n|xn--j6w193g|xn--jvr189m|xn--kprw13d|xn--kpry57d|xn--mgbbh1a|xn--mgbtx2b|xn--mix891f|xn--nyqy26a|xn--otu796d|xn--pgbs0dh|xn--q9jyb4c|xn--rhqv96g|xn--rovu88b|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--vuq861b|xn--w4rs40l|xn--xhq521b|xn--zfr164b|\u0b9a\u0bbf\u0b99\u0bcd\u0b95\u0baa\u0bcd\u0baa\u0bc2\u0bb0\u0bcd|accountant|apartments|associates|basketball|bnpparibas|boehringer|capitalone|consulting|creditcard|cuisinella|eurovision|extraspace|foundation|healthcare|immobilien|industries|management|mitsubishi|nextdirect|properties|protection|prudential|realestate|republican|restaurant|schaeffler|tatamotors|technology|university|vlaanderen|volkswagen|xn--30rr7y|xn--3pxu8k|xn--45q11c|xn--4gbrim|xn--55qx5d|xn--5tzm5g|xn--80aswg|xn--90a3ac|xn--9dbq2a|xn--9et52u|xn--c2br7g|xn--cg4bki|xn--czrs0t|xn--czru2d|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--io0a7i|xn--kput3i|xn--mxtq1m|xn--o3cw4h|xn--pssy2u|xn--q7ce6a|xn--unup4y|xn--wgbh1c|xn--wgbl6a|xn--y9a3aq|accenture|alfaromeo|allfinanz|amsterdam|analytics|aquarelle|barcelona|bloomberg|christmas|community|directory|education|equipment|fairwinds|financial|firestone|fresenius|frontdoor|furniture|goldpoint|hisamitsu|homedepot|homegoods|homesense|institute|insurance|kuokgroup|lancaster|landrover|lifestyle|marketing|marshalls|melbourne|microsoft|panasonic|passagens|pramerica|richardli|shangrila|solutions|statebank|statefarm|stockholm|travelers|vacations|xn--90ais|xn--c1avg|xn--d1alf|xn--e1a4c|xn--fhbei|xn--j1aef|xn--j1amh|xn--l1acc|xn--ngbrx|xn--nqv7f|xn--p1acf|xn--qxa6a|xn--tckwe|xn--vhquv|yodobashi|\u0645\u0648\u0631\u064a\u062a\u0627\u0646\u064a\u0627|abudhabi|airforce|allstate|attorney|barclays|barefoot|bargains|baseball|boutique|bradesco|broadway|brussels|builders|business|capetown|catering|catholic|cipriani|cityeats|cleaning|clinique|clothing|commbank|computer|delivery|deloitte|democrat|diamonds|discount|discover|download|engineer|ericsson|etisalat|exchange|feedback|fidelity|firmdale|football|frontier|goodyear|grainger|graphics|guardian|hdfcbank|helsinki|holdings|hospital|infiniti|ipiranga|istanbul|jpmorgan|lighting|lundbeck|marriott|maserati|mckinsey|memorial|merckmsd|mortgage|observer|partners|pharmacy|pictures|plumbing|property|redstone|reliance|saarland|samsclub|security|services|shopping|showtime|softbank|software|stcgroup|supplies|training|vanguard|ventures|verisign|woodside|xn--90ae|xn--node|xn--p1ai|xn--qxam|yokohama|\u0627\u0644\u0633\u0639\u0648\u062f\u064a\u0629|abogado|academy|agakhan|alibaba|android|athleta|auction|audible|auspost|avianca|banamex|bauhaus|bentley|bestbuy|booking|brother|bugatti|capital|caravan|careers|channel|charity|chintai|citadel|clubmed|college|cologne|comcast|company|compare|contact|cooking|corsica|country|coupons|courses|cricket|cruises|dentist|digital|domains|exposed|express|farmers|fashion|ferrari|ferrero|finance|fishing|fitness|flights|florist|flowers|forsale|frogans|fujitsu|gallery|genting|godaddy|grocery|guitars|hamburg|hangout|hitachi|holiday|hosting|hoteles|hotmail|hyundai|ismaili|jewelry|juniper|kitchen|komatsu|lacaixa|lanxess|lasalle|latrobe|leclerc|limited|lincoln|markets|monster|netbank|netflix|network|neustar|okinawa|oldnavy|organic|origins|philips|pioneer|politie|realtor|recipes|rentals|reviews|rexroth|samsung|sandvik|schmidt|schwarz|science|shiksha|singles|staples|storage|support|surgery|systems|temasek|theater|theatre|tickets|tiffany|toshiba|trading|walmart|wanggou|watches|weather|website|wedding|whoswho|windows|winners|xfinity|yamaxun|youtube|zuerich|\u043a\u0430\u0442\u043e\u043b\u0438\u043a|\u0627\u062a\u0635\u0627\u0644\u0627\u062a|\u0627\u0644\u0628\u062d\u0631\u064a\u0646|\u0627\u0644\u062c\u0632\u0627\u0626\u0631|\u0627\u0644\u0639\u0644\u064a\u0627\u0646|\u067e\u0627\u06a9\u0633\u062a\u0627\u0646|\u0643\u0627\u062b\u0648\u0644\u064a\u0643|\u0b87\u0ba8\u0bcd\u0ba4\u0bbf\u0baf\u0bbe|abarth|abbott|abbvie|africa|agency|airbus|airtel|alipay|alsace|alstom|amazon|anquan|aramco|author|bayern|beauty|berlin|bharti|bostik|boston|broker|camera|career|casino|center|chanel|chrome|church|circle|claims|clinic|coffee|comsec|condos|coupon|credit|cruise|dating|datsun|dealer|degree|dental|design|direct|doctor|dunlop|dupont|durban|emerck|energy|estate|events|expert|family|flickr|futbol|gallup|garden|george|giving|global|google|gratis|health|hermes|hiphop|hockey|hotels|hughes|imamat|insure|intuit|jaguar|joburg|juegos|kaufen|kinder|kindle|kosher|lancia|latino|lawyer|lefrak|living|locker|london|luxury|madrid|maison|makeup|market|mattel|mobile|monash|mormon|moscow|museum|mutual|nagoya|natura|nissan|nissay|norton|nowruz|office|olayan|online|oracle|orange|otsuka|pfizer|photos|physio|pictet|quebec|racing|realty|reisen|repair|report|review|rocher|rogers|ryukyu|safety|sakura|sanofi|school|schule|search|secure|select|shouji|soccer|social|stream|studio|supply|suzuki|swatch|sydney|taipei|taobao|target|tattoo|tennis|tienda|tjmaxx|tkmaxx|toyota|travel|unicom|viajes|viking|villas|virgin|vision|voting|voyage|vuelos|walter|webcam|xihuan|yachts|yandex|zappos|\u043c\u043e\u0441\u043a\u0432\u0430|\u043e\u043d\u043b\u0430\u0439\u043d|\u0627\u0628\u0648\u0638\u0628\u064a|\u0627\u0631\u0627\u0645\u0643\u0648|\u0627\u0644\u0627\u0631\u062f\u0646|\u0627\u0644\u0645\u063a\u0631\u0628|\u0627\u0645\u0627\u0631\u0627\u062a|\u0641\u0644\u0633\u0637\u064a\u0646|\u0645\u0644\u064a\u0633\u064a\u0627|\u092d\u093e\u0930\u0924\u092e\u094d|\u0b87\u0bb2\u0b99\u0bcd\u0b95\u0bc8|\u30d5\u30a1\u30c3\u30b7\u30e7\u30f3|actor|adult|aetna|amfam|amica|apple|archi|audio|autos|azure|baidu|beats|bible|bingo|black|boats|bosch|build|canon|cards|chase|cheap|cisco|citic|click|cloud|coach|codes|crown|cymru|dabur|dance|deals|delta|drive|dubai|earth|edeka|email|epson|faith|fedex|final|forex|forum|gallo|games|gifts|gives|glass|globo|gmail|green|gripe|group|gucci|guide|homes|honda|horse|house|hyatt|ikano|irish|jetzt|koeln|kyoto|lamer|lease|legal|lexus|lilly|linde|lipsy|loans|locus|lotte|lotto|macys|mango|media|miami|money|movie|music|nexus|nikon|ninja|nokia|nowtv|omega|osaka|paris|parts|party|phone|photo|pizza|place|poker|praxi|press|prime|promo|quest|radio|rehab|reise|ricoh|rocks|rodeo|rugby|salon|sener|seven|sharp|shell|shoes|skype|sling|smart|smile|solar|space|sport|stada|store|study|style|sucks|swiss|tatar|tires|tirol|tmall|today|tokyo|tools|toray|total|tours|trade|trust|tunes|tushu|ubank|vegas|video|vodka|volvo|wales|watch|weber|weibo|works|world|xerox|yahoo|\u05d9\u05e9\u05e8\u05d0\u05dc|\u0627\u06cc\u0631\u0627\u0646|\u0628\u0627\u0632\u0627\u0631|\u0628\u06be\u0627\u0631\u062a|\u0633\u0648\u062f\u0627\u0646|\u0633\u0648\u0631\u064a\u0629|\u0647\u0645\u0631\u0627\u0647|\u092d\u093e\u0930\u094b\u0924|\u0938\u0902\u0917\u0920\u0928|\u09ac\u09be\u0982\u09b2\u09be|\u0c2d\u0c3e\u0c30\u0c24\u0c4d|\u0d2d\u0d3e\u0d30\u0d24\u0d02|\u5609\u91cc\u5927\u9152\u5e97|aarp|able|adac|aero|akdn|ally|amex|arab|army|arpa|arte|asda|asia|audi|auto|baby|band|bank|bbva|beer|best|bike|bing|blog|blue|bofa|bond|book|buzz|cafe|call|camp|care|cars|casa|case|cash|cbre|cern|chat|citi|city|club|cool|coop|cyou|data|date|dclk|deal|dell|desi|diet|dish|docs|dvag|erni|fage|fail|fans|farm|fast|fiat|fido|film|fire|fish|flir|food|ford|free|fund|game|gbiz|gent|ggee|gift|gmbh|gold|golf|goog|guge|guru|hair|haus|hdfc|help|here|hgtv|host|hsbc|icbc|ieee|imdb|immo|info|itau|java|jeep|jobs|jprs|kddi|kids|kiwi|kpmg|kred|land|lego|lgbt|lidl|life|like|limo|link|live|loan|loft|love|ltda|luxe|maif|meet|meme|menu|mini|mint|mobi|moda|moto|name|navy|news|next|nico|nike|ollo|open|page|pars|pccw|pics|ping|pink|play|plus|pohl|porn|post|prod|prof|qpon|read|reit|rent|rest|rich|room|rsvp|ruhr|safe|sale|sarl|save|saxo|scot|seat|seek|sexy|shaw|shia|shop|show|silk|sina|site|skin|sncf|sohu|song|sony|spot|star|surf|talk|taxi|team|tech|teva|tiaa|tips|town|toys|tube|vana|visa|viva|vivo|vote|voto|wang|weir|wien|wiki|wine|work|xbox|yoga|zara|zero|zone|\u0434\u0435\u0442\u0438|\u0441\u0430\u0439\u0442|\u0628\u0627\u0631\u062a|\u0628\u064a\u062a\u0643|\u0680\u0627\u0631\u062a|\u062a\u0648\u0646\u0633|\u0634\u0628\u0643\u0629|\u0639\u0631\u0627\u0642|\u0639\u0645\u0627\u0646|\u0645\u0648\u0642\u0639|\u092d\u093e\u0930\u0924|\u09ad\u09be\u09b0\u09a4|\u09ad\u09be\u09f0\u09a4|\u0a2d\u0a3e\u0a30\u0a24|\u0aad\u0abe\u0ab0\u0aa4|\u0b2d\u0b3e\u0b30\u0b24|\u0cad\u0cbe\u0cb0\u0ca4|\u0dbd\u0d82\u0d9a\u0dcf|\u30a2\u30de\u30be\u30f3|\u30b0\u30fc\u30b0\u30eb|\u30af\u30e9\u30a6\u30c9|\u30dd\u30a4\u30f3\u30c8|\u7ec4\u7ec7\u673a\u6784|\u96fb\u8a0a\u76c8\u79d1|\u9999\u683c\u91cc\u62c9|aaa|abb|abc|aco|ads|aeg|afl|aig|anz|aol|app|art|aws|axa|bar|bbc|bbt|bcg|bcn|bet|bid|bio|biz|bms|bmw|bom|boo|bot|box|buy|bzh|cab|cal|cam|car|cat|cba|cbn|cbs|ceo|cfa|cfd|com|cpa|crs|dad|day|dds|dev|dhl|diy|dnp|dog|dot|dtv|dvr|eat|eco|edu|esq|eus|fan|fit|fly|foo|fox|frl|ftr|fun|fyi|gal|gap|gay|gdn|gea|gle|gmo|gmx|goo|gop|got|gov|hbo|hiv|hkt|hot|how|ibm|ice|icu|ifm|inc|ing|ink|int|ist|itv|jcb|jio|jll|jmp|jnj|jot|joy|kfh|kia|kim|kpn|krd|lat|law|lds|llc|llp|lol|lpl|ltd|man|map|mba|med|men|mil|mit|mlb|mls|mma|moe|moi|mom|mov|msd|mtn|mtr|nab|nba|nec|net|new|nfl|ngo|nhk|now|nra|nrw|ntt|nyc|obi|one|ong|onl|ooo|org|ott|ovh|pay|pet|phd|pid|pin|pnc|pro|pru|pub|pwc|red|ren|ril|rio|rip|run|rwe|sap|sas|sbi|sbs|sca|scb|ses|sew|sex|sfr|ski|sky|soy|spa|srl|stc|tab|tax|tci|tdk|tel|thd|tjx|top|trv|tui|tvs|ubs|uno|uol|ups|vet|vig|vin|vip|wed|win|wme|wow|wtc|wtf|xin|xxx|xyz|you|yun|zip|\u0431\u0435\u043b|\u043a\u043e\u043c|\u049b\u0430\u0437|\u043c\u043a\u0434|\u043c\u043e\u043d|\u043e\u0440\u0433|\u0440\u0443\u0441|\u0441\u0440\u0431|\u0443\u043a\u0440|\u0570\u0561\u0575|\u05e7\u05d5\u05dd|\u0639\u0631\u0628|\u0642\u0637\u0631|\u0643\u0648\u0645|\u0645\u0635\u0631|\u0915\u0949\u092e|\u0928\u0947\u091f|\u0e04\u0e2d\u0e21|\u0e44\u0e17\u0e22|\u0ea5\u0eb2\u0ea7|\u30b9\u30c8\u30a2|\u30bb\u30fc\u30eb|\u307f\u3093\u306a|\u4e2d\u6587\u7f51|\u4e9a\u9a6c\u900a|\u5929\u4e3b\u6559|\u6211\u7231\u4f60|\u65b0\u52a0\u5761|\u6de1\u9a6c\u9521|\u8bfa\u57fa\u4e9a|\u98de\u5229\u6d66|ac|ad|ae|af|ag|ai|al|am|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|\u03b5\u03bb|\u03b5\u03c5|\u0431\u0433|\u0435\u044e|\u0440\u0444|\u10d2\u10d4|\ub2f7\ub137|\ub2f7\ucef4|\uc0bc\uc131|\ud55c\uad6d|\u30b3\u30e0|\u4e16\u754c|\u4e2d\u4fe1|\u4e2d\u56fd|\u4e2d\u570b|\u4f01\u4e1a|\u4f5b\u5c71|\u4fe1\u606f|\u5065\u5eb7|\u516b\u5366|\u516c\u53f8|\u516c\u76ca|\u53f0\u6e7e|\u53f0\u7063|\u5546\u57ce|\u5546\u5e97|\u5546\u6807|\u5609\u91cc|\u5728\u7ebf|\u5927\u62ff|\u5a31\u4e50|\u5bb6\u96fb|\u5e7f\u4e1c|\u5fae\u535a|\u6148\u5584|\u624b\u673a|\u62db\u8058|\u653f\u52a1|\u653f\u5e9c|\u65b0\u95fb|\u65f6\u5c1a|\u66f8\u7c4d|\u673a\u6784|\u6e38\u620f|\u6fb3\u9580|\u70b9\u770b|\u79fb\u52a8|\u7f51\u5740|\u7f51\u5e97|\u7f51\u7ad9|\u7f51\u7edc|\u8054\u901a|\u8c37\u6b4c|\u8d2d\u7269|\u901a\u8ca9|\u96c6\u56e2|\u98df\u54c1|\u9910\u5385|\u9999\u6e2f)/,J7=new RegExp("[".concat(Ri,"!#$%&'*+/=?^_`{|}~-]")),ej=new RegExp("^".concat(cS.source,"$")),uS=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.localPartCharRegex=J7,e.strictTldRegex=ej,e}return Ie(n,t),n.prototype.parseMatches=function(e){for(var i=this.tagBuilder,r=this.localPartCharRegex,o=this.strictTldRegex,s=[],a=e.length,h=new _g,b={m:"a",a:"i",i:"l",l:"t",t:"o",o:":"},ee=0,de=0,ge=h;ee<a;){var xe=e.charAt(ee);switch(de){case 0:"m"===(ht=xe)?nt(1):r.test(ht)&&nt();break;case 1:Pe(e.charAt(ee-1),xe);break;case 2:Oe(xe);break;case 3:je(xe);break;case 4:qe(xe);break;case 5:Ve(xe);break;case 6:We(xe);break;case 7:vt(xe);break;default:pv(de)}ee++}var ht;return Mt(),s;function Pe(ht,yt){":"===ht?r.test(yt)?(de=2,ge=new _g(ce(ce({},ge),{hasMailtoPrefix:!0}))):_t():b[ht]===yt||(r.test(yt)?de=2:"."===yt?de=3:"@"===yt?de=4:_t())}function Oe(ht){"."===ht?de=3:"@"===ht?de=4:r.test(ht)||_t()}function je(ht){"."===ht||"@"===ht?_t():r.test(ht)?de=2:_t()}function qe(ht){mg.test(ht)?de=5:_t()}function Ve(ht){"."===ht?de=7:"-"===ht?de=6:mg.test(ht)||Mt()}function We(ht){"-"===ht||"."===ht?Mt():mg.test(ht)?de=5:Mt()}function vt(ht){"."===ht||"-"===ht?Mt():mg.test(ht)?(de=5,ge=new _g(ce(ce({},ge),{hasDomainDot:!0}))):Mt()}function nt(ht){void 0===ht&&(ht=2),de=ht,ge=new _g({idx:ee})}function _t(){de=0,ge=h}function Mt(){if(ge.hasDomainDot){var ht=e.slice(ge.idx,ee);/[-.]$/.test(ht)&&(ht=ht.slice(0,-1));var yt=ge.hasMailtoPrefix?ht.slice(7):ht;(function Tt(nn){var En=(nn.split(".").pop()||"").toLowerCase();return o.test(En)})(yt)&&s.push(new tS({tagBuilder:i,matchedText:ht,offset:ge.idx,email:yt}))}_t()}},n}(Ou),_g=function t(n){void 0===n&&(n={}),this.idx=void 0!==n.idx?n.idx:-1,this.hasMailtoPrefix=!!n.hasMailtoPrefix,this.hasDomainDot=!!n.hasDomainDot},tj=function(){function t(){}return t.isValid=function(n,e){return!(e&&!this.isValidUriScheme(e)||this.urlMatchDoesNotHaveProtocolOrDot(n,e)||this.urlMatchDoesNotHaveAtLeastOneWordChar(n,e)&&!this.isValidIpAddress(n)||this.containsMultipleDots(n))},t.isValidIpAddress=function(n){var e=new RegExp(this.hasFullProtocolRegex.source+this.ipRegex.source);return null!==n.match(e)},t.containsMultipleDots=function(n){var e=n;return this.hasFullProtocolRegex.test(n)&&(e=n.split("://")[1]),e.split("/")[0].indexOf("..")>-1},t.isValidUriScheme=function(n){var e=n.match(this.uriSchemeRegex),i=e&&e[0].toLowerCase();return"javascript:"!==i&&"vbscript:"!==i},t.urlMatchDoesNotHaveProtocolOrDot=function(n,e){return!(!n||e&&this.hasFullProtocolRegex.test(e)||-1!==n.indexOf("."))},t.urlMatchDoesNotHaveAtLeastOneWordChar=function(n,e){return!(!n||!e||this.hasFullProtocolRegex.test(e)||this.hasWordCharAfterProtocolRegex.test(n))},t.hasFullProtocolRegex=/^[A-Za-z][-.+A-Za-z0-9]*:\/\//,t.uriSchemeRegex=/^[A-Za-z][-.+A-Za-z0-9]*:/,t.hasWordCharAfterProtocolRegex=new RegExp(":[^\\s]*?["+sS+"]"),t.ipRegex=/[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?(:[0-9]*)?\/?$/,t}(),nj=(e=new RegExp("[/?#](?:["+Ri+"\\-+&@#/%=~_()|'$*\\[\\]{}?!:,.;^\u2713]*["+Ri+"\\-+&@#/%=~_()|'$*\\[\\]{}\u2713])?"),new RegExp(["(?:","(",/(?:[A-Za-z][-.+A-Za-z0-9]{0,63}:(?![A-Za-z][-.+A-Za-z0-9]{0,63}:\/\/)(?!\d+\/?)(?:\/\/)?)/.source,$v(2),")","|","(","(//)?",/(?:www\.)/.source,$v(6),")","|","(","(//)?",$v(10)+"\\.",cS.source,"(?![-"+Z7+"])",")",")","(?::[0-9]+)?","(?:"+e.source+")?"].join(""),"gi")),ij=new RegExp("["+Ri+"]"),dS=function(t){function n(e){var i=t.call(this,e)||this;return i.stripPrefix={scheme:!0,www:!0},i.stripTrailingSlash=!0,i.decodePercentEncoding=!0,i.matcherRegex=nj,i.wordCharRegExp=ij,i.stripPrefix=e.stripPrefix,i.stripTrailingSlash=e.stripTrailingSlash,i.decodePercentEncoding=e.decodePercentEncoding,i}return Ie(n,t),n.prototype.parseMatches=function(e){for(var b,i=this.matcherRegex,r=this.stripPrefix,o=this.stripTrailingSlash,s=this.decodePercentEncoding,a=this.tagBuilder,h=[],ee=function(){var ge=b[0],xe=b[1],ke=b[4],je=b.index,qe=b[5]||b[9],Ve=e.charAt(je-1);if(!tj.isValid(ge,xe)||je>0&&"@"===Ve||je>0&&qe&&de.wordCharRegExp.test(Ve))return"continue";if(/\?$/.test(ge)&&(ge=ge.substr(0,ge.length-1)),de.matchHasUnbalancedClosingParen(ge))ge=ge.substr(0,ge.length-1);else{var We=de.matchHasInvalidCharAfterTld(ge,xe);We>-1&&(ge=ge.substr(0,We))}var vt=["http://","https://"].find(function(ht){return!!xe&&-1!==xe.indexOf(ht)});if(vt){var nt=ge.indexOf(vt);ge=ge.substr(nt),xe=xe.substr(nt),je+=nt}h.push(new oS({tagBuilder:a,matchedText:ge,offset:je,urlMatchType:xe?"scheme":ke?"www":"tld",url:ge,protocolUrlMatch:!!xe,protocolRelativeMatch:!!qe,stripPrefix:r,stripTrailingSlash:o,decodePercentEncoding:s}))},de=this;null!==(b=i.exec(e));)ee();return h},n.prototype.matchHasUnbalancedClosingParen=function(e){var r,i=e.charAt(e.length-1);if(")"===i)r="(";else if("]"===i)r="[";else{if("}"!==i)return!1;r="{"}for(var o=0,s=0,a=e.length-1;s<a;s++){var h=e.charAt(s);h===r?o++:h===i&&(o=Math.max(o-1,0))}return 0===o},n.prototype.matchHasInvalidCharAfterTld=function(e,i){if(!e)return-1;var r=0;i&&(r=e.indexOf(":"),e=e.slice(r));var s=new RegExp("^((.?//)?[-."+Ri+"]*[-"+Ri+"]\\.[-"+Ri+"]+)").exec(e);return null===s?-1:(r+=s[1].length,e=e.slice(s[1].length),/^[^-.A-Za-z0-9:\/?#]/.test(e)?r:-1)},n}(Ou),fS=new RegExp("[_".concat(Ri,"]")),hS=function(t){function n(e){var i=t.call(this,e)||this;return i.serviceName="twitter",i.serviceName=e.serviceName,i}return Ie(n,t),n.prototype.parseMatches=function(e){for(var i=this.tagBuilder,r=this.serviceName,o=[],s=e.length,a=0,h=-1,b=0;a<s;){var ee=e.charAt(a);switch(b){case 0:"#"===(Oe=ee)?(b=2,h=a):Nf.test(Oe)&&(b=1);break;case 1:ge(ee);break;case 2:xe(ee);break;case 3:ke(ee);break;default:pv(b)}a++}var Oe;return Pe(),o;function ge(Oe){Nf.test(Oe)||(b=0)}function xe(Oe){b=fS.test(Oe)?3:Nf.test(Oe)?1:0}function ke(Oe){fS.test(Oe)||(Pe(),h=-1,b=Nf.test(Oe)?1:0)}function Pe(){if(h>-1&&a-h<=140){var Oe=e.slice(h,a),je=new nS({tagBuilder:i,matchedText:Oe,offset:h,serviceName:r,hashtag:Oe.slice(1)});o.push(je)}}},n}(Ou),rj=["twitter","facebook","instagram","tiktok"],aj=new RegExp("".concat(/(?:(?:(?:(\+)?\d{1,3}[-\040.]?)?\(?\d{3}\)?[-\040.]?\d{3}[-\040.]?\d{4})|(?:(\+)(?:9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)[-\040.]?(?:\d[-\040.]?){6,12}\d+))([,;]+[0-9]+#?)*/.source,"|").concat(/(0([1-9]{1}-?[1-9]\d{3}|[1-9]{2}-?\d{3}|[1-9]{2}\d{1}-?\d{2}|[1-9]{2}\d{2}-?\d{1})-?\d{4}|0[789]0-?\d{4}-?\d{4}|050-?\d{4}-?\d{4})/.source),"g"),pS=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.matcherRegex=aj,e}return Ie(n,t),n.prototype.parseMatches=function(e){for(var s,i=this.matcherRegex,r=this.tagBuilder,o=[];null!==(s=i.exec(e));){var a=s[0],h=a.replace(/[^0-9,;#]/g,""),b=!(!s[1]&&!s[2]),ee=0==s.index?"":e.substr(s.index-1,1),de=e.substr(s.index+a.length,1),ge=!ee.match(/\d/)&&!de.match(/\d/);this.testMatch(s[3])&&this.testMatch(a)&&ge&&o.push(new rS({tagBuilder:r,matchedText:a,offset:s.index,number:h,plusSign:b}))}return o},n.prototype.testMatch=function(e){return q7.test(e)},n}(Ou),lj=new RegExp("@[_".concat(Ri,"]{1,50}(?![_").concat(Ri,"])"),"g"),cj=new RegExp("@[_.".concat(Ri,"]{1,30}(?![_").concat(Ri,"])"),"g"),uj=new RegExp("@[-_.".concat(Ri,"]{1,50}(?![-_").concat(Ri,"])"),"g"),dj=new RegExp("@[_.".concat(Ri,"]{1,23}[_").concat(Ri,"](?![_").concat(Ri,"])"),"g"),fj=new RegExp("[^"+Ri+"]"),gS=function(t){function n(e){var i=t.call(this,e)||this;return i.serviceName="twitter",i.matcherRegexes={twitter:lj,instagram:cj,soundcloud:uj,tiktok:dj},i.nonWordCharRegex=fj,i.serviceName=e.serviceName,i}return Ie(n,t),n.prototype.parseMatches=function(e){var h,i=this.serviceName,r=this.matcherRegexes[this.serviceName],o=this.nonWordCharRegex,s=this.tagBuilder,a=[];if(!r)return a;for(;null!==(h=r.exec(e));){var b=h.index,ee=e.charAt(b-1);if(0===b||o.test(ee)){var de=h[0].replace(/\.+$/g,""),ge=de.slice(1);a.push(new iS({tagBuilder:s,matchedText:de,offset:b,serviceName:i,mention:ge}))}}return a},n}(Ou);var oa=function t(n){void 0===n&&(n={}),this.idx=void 0!==n.idx?n.idx:-1,this.type=n.type||"tag",this.name=n.name||"",this.isOpening=!!n.isOpening,this.isClosing=!!n.isClosing},pj=function(){function t(n){void 0===n&&(n={}),this.version=t.version,this.urls={},this.email=!0,this.phone=!0,this.hashtag=!1,this.mention=!1,this.newWindow=!0,this.stripPrefix={scheme:!0,www:!0},this.stripTrailingSlash=!0,this.decodePercentEncoding=!0,this.truncate={length:0,location:"end"},this.className="",this.replaceFn=null,this.context=void 0,this.sanitizeHtml=!1,this.matchers=null,this.tagBuilder=null,this.urls=this.normalizeUrlsCfg(n.urls),this.email="boolean"==typeof n.email?n.email:this.email,this.phone="boolean"==typeof n.phone?n.phone:this.phone,this.hashtag=n.hashtag||this.hashtag,this.mention=n.mention||this.mention,this.newWindow="boolean"==typeof n.newWindow?n.newWindow:this.newWindow,this.stripPrefix=this.normalizeStripPrefixCfg(n.stripPrefix),this.stripTrailingSlash="boolean"==typeof n.stripTrailingSlash?n.stripTrailingSlash:this.stripTrailingSlash,this.decodePercentEncoding="boolean"==typeof n.decodePercentEncoding?n.decodePercentEncoding:this.decodePercentEncoding,this.sanitizeHtml=n.sanitizeHtml||!1;var e=this.mention;if(!1!==e&&-1===["twitter","instagram","soundcloud","tiktok"].indexOf(e))throw new Error("invalid `mention` cfg '".concat(e,"' - see docs"));var i=this.hashtag;if(!1!==i&&-1===rj.indexOf(i))throw new Error("invalid `hashtag` cfg '".concat(i,"' - see docs"));this.truncate=this.normalizeTruncateCfg(n.truncate),this.className=n.className||this.className,this.replaceFn=n.replaceFn||this.replaceFn,this.context=n.context||this}return t.link=function(n,e){return new t(e).link(n)},t.parse=function(n,e){return new t(e).parse(n)},t.prototype.normalizeUrlsCfg=function(n){return null==n&&(n=!0),"boolean"==typeof n?{schemeMatches:n,wwwMatches:n,tldMatches:n}:{schemeMatches:"boolean"!=typeof n.schemeMatches||n.schemeMatches,wwwMatches:"boolean"!=typeof n.wwwMatches||n.wwwMatches,tldMatches:"boolean"!=typeof n.tldMatches||n.tldMatches}},t.prototype.normalizeStripPrefixCfg=function(n){return null==n&&(n=!0),"boolean"==typeof n?{scheme:n,www:n}:{scheme:"boolean"!=typeof n.scheme||n.scheme,www:"boolean"!=typeof n.www||n.www}},t.prototype.normalizeTruncateCfg=function(n){return"number"==typeof n?{length:n,location:"end"}:function B7(t,n){for(var e in n)n.hasOwnProperty(e)&&void 0===t[e]&&(t[e]=n[e]);return t}(n||{},{length:Number.POSITIVE_INFINITY,location:"end"})},t.prototype.parse=function(n){var e=this,i=["a","style","script"],r=0,o=[];return function hj(t,n){for(var e=n.onOpenTag,i=n.onCloseTag,r=n.onText,o=n.onComment,s=n.onDoctype,a=new oa,h=0,b=t.length,ee=0,de=0,ge=a;h<b;){var xe=t.charAt(h);switch(ee){case 0:"<"===xe&&Fn();break;case 1:"!"===(Dt=xe)?ee=13:"/"===Dt?(ee=2,ge=new oa(ce(ce({},ge),{isClosing:!0}))):"<"===Dt?Fn():mv.test(Dt)?(ee=3,ge=new oa(ce(ce({},ge),{isOpening:!0}))):(ee=0,ge=a);break;case 2:je(xe);break;case 3:Oe(xe);break;case 4:qe(xe);break;case 5:Ve(xe);break;case 6:We(xe);break;case 7:vt(xe);break;case 8:nt(xe);break;case 9:_t(xe);break;case 10:Mt(xe);break;case 11:ht(xe);break;case 12:yt(xe);break;case 13:"--"===t.substr(h,2)?(h+=2,ge=new oa(ce(ce({},ge),{type:"comment"})),ee=14):"DOCTYPE"===t.substr(h,7).toUpperCase()?(h+=7,ge=new oa(ce(ce({},ge),{type:"doctype"})),ee=20):Yt();break;case 14:nn(xe);break;case 15:rn(xe);break;case 16:En(xe);break;case 17:Wn(xe);break;case 18:Rt(xe);break;case 19:Ut(xe);break;case 20:jt(xe);break;default:pv(ee)}h++}var Dt;function Oe(Dt){$c.test(Dt)?(ge=new oa(ce(ce({},ge),{name:Di()})),ee=4):"<"===Dt?Fn():"/"===Dt?(ge=new oa(ce(ce({},ge),{name:Di()})),ee=12):">"===Dt?(ge=new oa(ce(ce({},ge),{name:Di()})),Jn()):!mv.test(Dt)&&!G7.test(Dt)&&":"!==Dt&&Yt()}function je(Dt){">"===Dt?Yt():mv.test(Dt)?ee=3:Yt()}function qe(Dt){$c.test(Dt)||("/"===Dt?ee=12:">"===Dt?Jn():"<"===Dt?Fn():"="===Dt||_v.test(Dt)||W7.test(Dt)?Yt():ee=5)}function Ve(Dt){$c.test(Dt)?ee=6:"/"===Dt?ee=12:"="===Dt?ee=7:">"===Dt?Jn():"<"===Dt?Fn():_v.test(Dt)&&Yt()}function We(Dt){$c.test(Dt)||("/"===Dt?ee=12:"="===Dt?ee=7:">"===Dt?Jn():"<"===Dt?Fn():_v.test(Dt)?Yt():ee=5)}function vt(Dt){$c.test(Dt)||('"'===Dt?ee=8:"'"===Dt?ee=9:/[>=`]/.test(Dt)?Yt():"<"===Dt?Fn():ee=10)}function nt(Dt){'"'===Dt&&(ee=11)}function _t(Dt){"'"===Dt&&(ee=11)}function Mt(Dt){$c.test(Dt)?ee=4:">"===Dt?Jn():"<"===Dt&&Fn()}function ht(Dt){$c.test(Dt)?ee=4:"/"===Dt?ee=12:">"===Dt?Jn():"<"===Dt?Fn():(ee=4,function Gn(){h--}())}function yt(Dt){">"===Dt?(ge=new oa(ce(ce({},ge),{isClosing:!0})),Jn()):ee=4}function nn(Dt){"-"===Dt?ee=15:">"===Dt?Yt():ee=16}function rn(Dt){"-"===Dt?ee=18:">"===Dt?Yt():ee=16}function En(Dt){"-"===Dt&&(ee=17)}function Wn(Dt){ee="-"===Dt?18:16}function Rt(Dt){">"===Dt?Jn():"!"===Dt?ee=19:"-"===Dt||(ee=16)}function Ut(Dt){"-"===Dt?ee=17:">"===Dt?Jn():ee=16}function jt(Dt){">"===Dt?Jn():"<"===Dt&&Fn()}function Yt(){ee=0,ge=a}function Fn(){ee=1,ge=new oa({idx:h})}function Jn(){var Dt=t.slice(de,ge.idx);Dt&&r(Dt,de),"comment"===ge.type?o(ge.idx):"doctype"===ge.type?s(ge.idx):(ge.isOpening&&e(ge.name,ge.idx),ge.isClosing&&i(ge.name,ge.idx)),Yt(),de=h+1}function Di(){return t.slice(ge.idx+(ge.isClosing?2:1),h).toLowerCase()}de<h&&function oi(){var Dt=t.slice(de,h);r(Dt,de),de=h+1}()}(n,{onOpenTag:function(s){i.indexOf(s)>=0&&r++},onText:function(s,a){if(0===r){var b=function j7(t,n){if(!n.global)throw new Error("`splitRegex` must have the 'g' flag set");for(var r,e=[],i=0;r=n.exec(t);)e.push(t.substring(i,r.index)),e.push(r[0]),i=r.index+r[0].length;return e.push(t.substring(i)),e}(s,/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi),ee=a;b.forEach(function(de,ge){if(ge%2==0){var xe=e.parseText(de,ee);o.push.apply(o,xe)}ee+=de.length})}},onCloseTag:function(s){i.indexOf(s)>=0&&(r=Math.max(r-1,0))},onComment:function(s){},onDoctype:function(s){}}),o=this.compactMatches(o),o=this.removeUnwantedMatches(o)},t.prototype.compactMatches=function(n){n.sort(function(h,b){return h.getOffset()-b.getOffset()});for(var e=0;e<n.length-1;){var i=n[e],r=i.getOffset(),o=i.getMatchedText().length,s=r+o;if(e+1<n.length){if(n[e+1].getOffset()===r){var a=n[e+1].getMatchedText().length>o?e:e+1;n.splice(a,1);continue}if(n[e+1].getOffset()<s){n.splice(e+1,1);continue}}e++}return n},t.prototype.removeUnwantedMatches=function(n){return this.hashtag||_c(n,function(e){return"hashtag"===e.getType()}),this.email||_c(n,function(e){return"email"===e.getType()}),this.phone||_c(n,function(e){return"phone"===e.getType()}),this.mention||_c(n,function(e){return"mention"===e.getType()}),this.urls.schemeMatches||_c(n,function(e){return"url"===e.getType()&&"scheme"===e.getUrlMatchType()}),this.urls.wwwMatches||_c(n,function(e){return"url"===e.getType()&&"www"===e.getUrlMatchType()}),this.urls.tldMatches||_c(n,function(e){return"url"===e.getType()&&"tld"===e.getUrlMatchType()}),n},t.prototype.parseText=function(n,e){void 0===e&&(e=0),e=e||0;for(var i=this.getMatchers(),r=[],o=0,s=i.length;o<s;o++){for(var a=i[o].parseMatches(n),h=0,b=a.length;h<b;h++)a[h].setOffset(e+a[h].getOffset());r.push.apply(r,a)}return r},t.prototype.link=function(n){if(!n)return"";this.sanitizeHtml&&(n=n.replace(/</g,"&lt;").replace(/>/g,"&gt;"));for(var e=this.parse(n),i=[],r=0,o=0,s=e.length;o<s;o++){var a=e[o];i.push(n.substring(r,a.getOffset())),i.push(this.createMatchReturnVal(a)),r=a.getOffset()+a.getMatchedText().length}return i.push(n.substring(r)),i.join("")},t.prototype.createMatchReturnVal=function(n){var e;return this.replaceFn&&(e=this.replaceFn.call(this.context,n)),"string"==typeof e?e:!1===e?n.getMatchedText():e instanceof gv?e.toAnchorString():n.buildTag().toAnchorString()},t.prototype.getMatchers=function(){if(this.matchers)return this.matchers;var n=this.getTagBuilder(),e=[new hS({tagBuilder:n,serviceName:this.hashtag}),new uS({tagBuilder:n}),new pS({tagBuilder:n}),new gS({tagBuilder:n,serviceName:this.mention}),new dS({tagBuilder:n,stripPrefix:this.stripPrefix,stripTrailingSlash:this.stripTrailingSlash,decodePercentEncoding:this.decodePercentEncoding})];return this.matchers=e},t.prototype.getTagBuilder=function(){var n=this.tagBuilder;return n||(n=this.tagBuilder=new eS({newWindow:this.newWindow,truncate:this.truncate,className:this.className})),n},t.version="3.16.2",t.AnchorTagBuilder=eS,t.HtmlTag=gv,t.matcher={Email:uS,Hashtag:hS,Matcher:Ou,Mention:gS,Phone:pS,Url:dS},t.match={Email:tS,Hashtag:nS,Match:Nu,Mention:iS,Phone:rS,Url:oS},t}();const mS=pj,vv=mS;let qn=(()=>{class t{constructor(){this.title="\u7121\u540d\u306e\u30d1\u30cd\u30eb",this.left=0,this.top=0,this.width=100,this.height=100,this.isAbleMinimizeButton=!0,this.isAbleFullScreenButton=!0,this.isAbleCloseButton=!0,this.isAbleRotateButton=!1,this.scrollablePanel=null}get isShow(){return!!this.panelComponentRef}open(e,i,r){let o;r||(r=t.defaultParentViewContainerRef),o=r.createComponent(t.UIPanelComponentClass,{index:r.length,injector:r.injector});let s=o.instance.content.createComponent(e);const a=o.injector.get(t);return a.panelComponentRef=o,i&&(i.title&&(a.title=i.title),i.top&&(a.top=i.top),i.left&&(a.left=i.left),i.width&&(a.width=i.width),i.height&&(a.height=i.height)),o.onDestroy(()=>{a.panelComponentRef=null}),s.instance}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}}return t.UIPanelComponentClass=null,t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=$n({token:t,factory:t.\u0275fac}),t})();class gj{constructor(n,e,i){this._resolve=n,this._reject=e,this.option=i}resolve(n){this._resolve(n),this._resolve=null}reject(n){this._reject(n),this._reject=null}}let Yn=(()=>{class t{constructor(){this.modalContext=null,this.count=0,this.title="\u7121\u540d\u306e\u30e2\u30fc\u30c0\u30eb"}get option(){return this.modalContext?this.modalContext.option:null}get isShow(){return this.count>0}open(e,i,r){let o;return r||(r=t.defaultParentViewContainerRef),new Promise((s,a)=>{const ee=new t;ee.modalContext=new gj(ge=>{o&&(o.destroy(),s(ge),this.count--)},ge=>{o&&(o.destroy(),a(ge),this.count--)},i);const de=xs.create({providers:[{provide:t,useValue:ee}],parent:r.injector});o=r.createComponent(t.ModalComponentClass,{index:r.length,injector:de}),o.instance.content.createComponent(e),o.onDestroy(()=>{this.count--}),this.count++})}resolve(e){this.modalContext&&(this.modalContext.resolve(e),this.modalContext=null)}reject(e){this.modalContext&&(this.modalContext.reject(e),this.modalContext=null)}}return t.ModalComponentClass=null,t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=$n({token:t,factory:t.\u0275fac}),t})();const mj=function(t){return{outer:t}};function _j(t,n){if(1&t&&(Q(0,"div",5),ve(1),Q(2,"span",6),ve(3),ne(),ve(4),Q(5,"span",7),ve(6),ne()()),2&t){const e=me();G(1),Zn("",e.urlObj.protocol,"//"),G(1),oe("ngClass",wt(6,mj,e.isOuter)),G(1),lt(e.urlObj.host),G(1),lt(e.urlObj.pathname),G(2),Ja("",e.urlObj.search,"",e.urlObj.hash,"")}}function $j(t,n){if(1&t&&(Q(0,"div",5),ve(1),ne()),2&t){const e=me();G(1),lt(e.url)}}function vj(t,n){1&t&&(Q(0,"div"),ve(1,"\u3053\u306eURL\u3092\u958b\u304d\u307e\u3059\u304b\uff1f\uff08\u5225\u30a6\u30a3\u30f3\u30c9\u30a6\u3067\u958b\u304d\u307e\u3059\u3001\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u3092\u8a31\u53ef\u3057\u3066\u304f\u3060\u3055\u3044\uff09"),ne())}function bj(t,n){1&t&&(Q(0,"div"),ve(1,"\u26a0\ufe0fURL\u304c\u4e0d\u6b63\u3067\u3059\u3002"),ne())}let lo=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.url="",this.title="",this.subTitle="",this.url=i.option.url?i.option.url:"",this.title=i.option.title?i.option.title:"",this.subTitle=i.option.subTitle?i.option.subTitle:"",this.urlObj=this.isValid?new URL(this.url):null}get isValid(){return pt.validUrl(this.url.trim())}get isOuter(){return!!this.isValid&&window.location.origin!=this.urlObj.origin}ngOnInit(){Promise.resolve().then(()=>{let e="\u5916\u90e8URL\u3092\u958b\u304f";this.title?e+="\u3008"+this.title+(this.subTitle?`\uff1a${this.subTitle}`:"")+"\u3009":this.subTitle&&(e+=`\u3008${this.subTitle}\u3009`),this.modalService.title=this.panelService.title=e}),Ue.register(this)}ngOnDestroy(){Ue.unregister(this)}openUrl(){window.open(this.url.trim(),"_blank","noopener"),this.modalService.resolve(!0)}cancel(){this.modalService.resolve(!1)}}return t.\u0275fac=function(e){return new(e||t)(He(qn),He(Yn))},t.\u0275cmp=fn({type:t,selectors:[["open-url"]],decls:11,vars:5,consts:[["class","url",4,"ngIf"],[1,"help"],[4,"ngIf"],["type","submit",3,"disabled","click"],["type","button",3,"click"],[1,"url"],[3,"ngClass"],[1,"opt"]],template:function(e,i){1&e&&(Q(0,"div"),Te(1,_j,7,8,"div",0),Te(2,$j,2,1,"div",0),mt(3,"hr"),Q(4,"div",1),Te(5,vj,2,0,"div",2),Te(6,bj,2,0,"div",2),ne()(),Q(7,"button",3),Ae("click",function(){return i.openUrl()}),ve(8,"\u958b\u304f"),ne(),Q(9,"button",4),Ae("click",function(){return i.cancel()}),ve(10,"\u30ad\u30e3\u30f3\u30bb\u30eb"),ne()),2&e&&(G(1),oe("ngIf",i.isValid),G(1),oe("ngIf",!i.isValid),G(3),oe("ngIf",i.isValid),G(1),oe("ngIf",!i.isValid),G(1),oe("disabled",!i.isValid))},dependencies:[si,Bn],styles:[".url[_ngcontent-%COMP%]{word-break:break-all}.url[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]{font-weight:700}.opt[_ngcontent-%COMP%]{color:gray}.help[_ngcontent-%COMP%]{font-size:smaller}"]}),t})();const yj=["message"];function Cj(t,n){if(1&t&&(Q(0,"span")(1,"pre",1),ve(2),ne()()),2&t){const e=me();G(2),lt(e.text)}}function wj(t,n){1&t&&mt(0,"hr")}function xj(t,n){if(1&t){const e=ft();Q(0,"pre",1)(1,"span",3,4),Ae("click",function(r){return Re(e),Le(me(2).onLinkClick(r))}),Lt(3,"safe"),ne(),Te(4,wj,1,0,"hr",0),ne()}if(2&t){const e=n.$implicit,i=n.last,r=me(2);G(1),oe("innerHTML",Bt(3,2,r.htmlEscapeLinking(e),"html"),lr),G(3),oe("ngIf",!i)}}function Ej(t,n){if(1&t&&(Q(0,"span"),Te(1,xj,5,5,"pre",2),ne()),2&t){const e=me();G(1),oe("ngForOf",e.text)}}let Fu=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.text="",this.title="",this.stringUtil=pt}ngOnInit(){Promise.resolve().then(()=>{this.panelService.title=this.title,this.modalService.option&&null!=this.modalService.option.title&&(this.modalService.title=this.modalService.option.title?this.modalService.option.title:"",this.text=this.modalService.option.text?this.modalService.option.text:"")})}htmlEscapeLinking(e,i=!1){return vv.link(pt.escapeHtml(e),{urls:{schemeMatches:!0,wwwMatches:!0,tldMatches:!1},truncate:{length:96,location:"end"},decodePercentEncoding:i,stripPrefix:i,stripTrailingSlash:i,email:!1,phone:!1,replaceFn:function(r){if("url"==r.getType()&&pt.validUrl(r.getAnchorHref())){if(pt.sameOrigin(r.getAnchorHref()))return!0;{const o=r.buildTag();return o.setAttr("rel","nofollow"),o.addClass("outer-link"),o}}return!1}})}isObj(e){return"object"==typeof e}onLinkClick(e){if(e&&"A"==e.target.tagName){const i=e.target.getAttribute("href");if(!pt.sameOrigin(i))return e.preventDefault(),this.modalService.open(lo,{url:e.target.getAttribute("href")}),!1}return!0}}return t.\u0275fac=function(e){return new(e||t)(He(qn),He(Yn))},t.\u0275cmp=fn({type:t,selectors:[["text-view"]],viewQuery:function(e,i){if(1&e&&wn(yj,5),2&e){let r;Cn(r=xn())&&(i.messageElm=r.first)}},inputs:{text:"text",title:"title"},decls:2,vars:2,consts:[[4,"ngIf"],[1,"text"],["class","text",4,"ngFor","ngForOf"],[3,"innerHTML","click"],["message",""]],template:function(e,i){1&e&&(Te(0,Cj,3,1,"span",0),Te(1,Ej,2,1,"span",0)),2&e&&(oe("ngIf",!i.isObj(i.text)),G(1),oe("ngIf",i.isObj(i.text)))},dependencies:[_i,Bn,$i],styles:["[_nghost-%COMP%]{display:block}.text[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;font-size:12px;white-space:pre-wrap;margin:0;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}"]}),t})();var Ru;let st=(()=>{class t{}return t.dicePick="",t.dicePut="",t.diceRoll1="",t.diceRoll2="",t.cardDraw="",t.cardPick="",t.cardPut="",t.cardShuffle="",t.piecePick="",t.piecePut="",t.blockPick="",t.blockPut="",t.lock="",t.unlock="",t.sweep="",t.puyon="",t.surprise="",t.coinToss="",t})(),Et=Ru=class extends pl{onStoreAdded(){super.onStoreAdded(),Ue.register(this).on("SOUND_EFFECT",n=>{tt.playSoundEffect(Xt.instance.get(n.data))}).on("SEND_MESSAGE",n=>{let e=Ct.instance.get(n.data.messageIdentifier);!e||!e.isSendFromSelf||e.isEmptyDice||(Math.random()<.5?Ru.play(st.diceRoll1):Ru.play(st.diceRoll2))})}onStoreRemoved(){super.onStoreRemoved(),Ue.unregister(this)}play(n){Ru.play(n)}static play(n){let e="";e="string"==typeof n?n:n.identifier,Ru._play(e)}static _play(n){Ue.call("SOUND_EFFECT",n)}};var Of;Et=Ru=$e([mi("sound-effect")],Et);let Un=Of=class extends ni{constructor(){super(...arguments),this.imageIdentifier="",this.tag="",this.hide=!1}get words(){return(null==this.tag||""==this.tag.trim())&&(this.tag=""),""===this.tag.trim()?[]:(this.tag=pt.toHalfWidth(this.tag).toLowerCase(),this.tag.trim().split(/\s+/))}containsWords(n,e=!0){if("string"==typeof n&&(n=n.trim().split(/\s+/)),0==n.length)return!1;if(n=n.concat(),e){for(const i of n)if(` ${this.tag} `.indexOf(` ${pt.toHalfWidth(i).toLowerCase()} `)>=0)return!0;return!1}for(const i of n)if(` ${this.tag} `.indexOf(` ${pt.toHalfWidth(i).toLowerCase()} `)<0)return!1;return!0}addWords(n){"string"==typeof n&&(n=n.trim().split(/\s+/)),n=n.concat();const e=Array.from(new Set(n.map(i=>pt.toHalfWidth(i).toLowerCase())));return this.tag=Array.from(new Set(e.concat(this.words))).sort().join(" "),Ue.call("OPERATE_IMAGE_TAGS",this.identifier),e}removeWords(n){"string"==typeof n&&(n=n.trim().split(/\s+/)),n=n.concat();const e=Array.from(new Set(n.map(i=>pt.toHalfWidth(i).toLowerCase())));return this.tag=this.words.filter(i=>!e.includes(pt.toHalfWidth(i).toLowerCase())).sort().join(" "),Ue.call("OPERATE_IMAGE_TAGS",this.identifier),e}static get(n){return Ct.instance.get(`imagetag_${n}`)}static create(n){const e=new Of(`imagetag_${n}`);return e.imageIdentifier=n,e.initialize(),e}parseInnerXml(n){let e=Of.get(this.imageIdentifier);e||(e=Of.create(this.imageIdentifier));const i=e.toContext();i.syncData=this.toContext().syncData,e.apply(i),e.update(),this.destroy()}};var vc;$e([bt()],Un.prototype,"imageIdentifier",void 0),$e([bt()],Un.prototype,"tag",void 0),$e([bt()],Un.prototype,"hide",void 0),Un=Of=$e([mi("image-tag")],Un);let Ur=vc=class extends ni{constructor(){super(...arguments),this.identifiers=[]}static searchImages(n,e,i,r){"string"==typeof n&&(n=n.trim().split(/\s+/));const o=vc.allImagesOwnWords(r);return n=n.filter(a=>o.includes(a)),this.allImages(r).filter(a=>{const h=Un.get(a.identifier);return e&&(i||0===n.length)&&(!h||null==h.tag||""===h.tag.trim())||(!e||i)&&h&&h.containsWords(n,i)})}static allImages(n){return Gt.instance.images.filter(i=>{if(n)return!0;const r=Un.get(i.identifier);return!r||!r.hide})}static allImagesOwnWords(n){return vc.imagesOwnWords(this.allImages(n))}static imagesOwnWords(n,e=!1){if(e){if(0===n.length)return[];const i=n.map(o=>Un.get(o.identifier));if(!i[0])return[];let r=i[0].words;for(let o=1;o<i.length;o++){if(!i[o])return[];if(r=r.filter(s=>i[o].words.includes(s)),0===r.length)return r}return r.sort()}{const i=[];for(const r of n){const o=Un.get(r.identifier);o&&i.push(...o.words)}return Array.from(new Set(i)).sort()}}static countAllImagesHasWord(n,e){let i=0;if(null!=n&&""===n.trim())return i;for(const r of vc.allImages(e)){const o=Un.get(r.identifier);null==n?(!o||null==o.tag||""==o.tag.trim())&&i++:o&&o.containsWords(n.trim(),!1)&&i++}return i}static imagesIsHidden(n){for(const e of n){const i=Un.get(e.identifier);if(!i||!i.hide)return!1}return!0}static sortImagesByWords(n,e){const i=n.map(r=>{const o=Un.get(r.identifier);return{image:r,tag:o&&null!=o.tag?o.tag:""}});return i.sort((r,o)=>{let s=0;return e.some(a=>(s=vc._sortByWordCriteria(r,o,a),!!s)),s}),i.map(r=>r.image)}static _sortByWordCriteria(n,e,i){if(null==i)return""==n.tag&&""==e.tag?0:""==n.tag?-1:""==e.tag?1:0;const r=` ${n.tag} `.indexOf(` ${i} `),o=` ${e.tag} `.indexOf(` ${i} `);return-1==r&&-1==o?0:r>=0&&-1==o?-1:-1==r&&o>=0?1:0}onStoreAdded(){super.onStoreAdded(),Ct.instance.remove(this)}innerXml(){return Array.from(new Set(this.identifiers)).map(n=>Un.get(n)).filter(n=>n).map(n=>n.toXml()).join("")}static create(n){const e=new vc;return e.identifiers=n.map(i=>i.identifier),e}};Ur=vc=$e([mi("image-tag-list")],Ur);var bc,_S=_e(4327),$S=_e(5650);!function(t){const n={avif:"image/avif",gif:"image/gif",jpg:"image/jpeg",jpeg:"image/jpeg",jpe:"image/jpeg",jfif:"image/jpeg",pjpeg:"image/jpeg",pjp:"image/jpeg",png:"image/png",apng:"image/apng",webp:"image/webp",svg:"image/svg+xml",svgz:"image/svg+xml",ico:"image/x-icon",cur:"image/x-icon",bmp:"image/bmp",html:"text/html",htm:"text/html",shtml:"text/html",xml:"text/xml",yml:"text/yaml",yaml:"text/yaml",json:"application/json",map:"application/json",zip:"application/zip",mp3:"audio/mp3",wav:"audio/wav",m4a:"audio/aac",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",mp4:"video/mp4",webm:"video/webm"};t.type=function e(r){let o=r.replace(/.*[\.\/\\]/,"").toLowerCase();return n[o]?n[o]:""},t.extension=function i(r){for(let o in n)if(n[o]===r)return o;return r.split("/")[1]}}(bc||(bc={}));class sa{constructor(){this.maxImageSize=2097152,this.maxAudioeSize=10485760,console.log("FileArchiver ready...")}static get instance(){return sa._instance||(sa._instance=new sa),sa._instance}initialize(){this.destroy(),this.addEventListeners()}destroy(){this.removeEventListeners()}addEventListeners(){this.removeEventListeners(),this.callbackOnDragEnter=n=>this.onDragEnter(n),this.callbackOnDragOver=n=>this.onDragOver(n),this.callbackOnDrop=n=>this.onDrop(n),document.body.addEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.addEventListener("dragover",this.callbackOnDragOver,!1),document.body.addEventListener("drop",this.callbackOnDrop,!1)}removeEventListeners(){document.body.removeEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.removeEventListener("dragover",this.callbackOnDragOver,!1),document.body.removeEventListener("drop",this.callbackOnDrop,!1),this.callbackOnDragEnter=null,this.callbackOnDragOver=null,this.callbackOnDrop=null}onDragEnter(n){n.preventDefault()}onDragOver(n){n.preventDefault()}onDrop(n){n.preventDefault(),console.log("onDrop",n.dataTransfer),this.load(n.dataTransfer.files)}load(n){var e=this;return(0,gn.Z)(function*(){if(!n)return;let i=n instanceof FileList?bS(n):n;for(let r of i)yield e.handleImage(r),yield e.handleAudio(r),yield e.handleText(r),yield e.handleZip(r),Ue.trigger("FILE_LOADED",{file:r})})()}handleImage(n){var e=this;return(0,gn.Z)(function*(){if(!(n.type.indexOf("image/")<0)){if(e.maxImageSize<n.size)return void console.warn(`File size limit exceeded. -> ${n.name} (${(n.size/1024/1024).toFixed(2)}MB)`);console.log(n.name+" type:"+n.type),yield Gt.instance.addAsync(n)}})()}handleAudio(n){var e=this;return(0,gn.Z)(function*(){if(!(n.type.indexOf("audio/")<0)){if(e.maxAudioeSize<n.size)return void console.warn(`File size limit exceeded. -> ${n.name} (${(n.size/1024/1024).toFixed(2)}MB)`);console.log(n.name+" type:"+n.type),yield Xt.instance.addAsync(n)}})()}handleText(n){return(0,gn.Z)(function*(){if(!(n.type.indexOf("text/")<0)){console.log(n.name+" type:"+n.type);try{let e=Fa.xml2element(yield Ps.readAsTextAsync(n));e&&Ue.trigger("XML_LOADED",{xmlElement:e})}catch(e){console.warn(e)}}})()}handleZip(n){var e=this;return(0,gn.Z)(function*(){if(!(0<=n.type.indexOf("application/")||n.type.length<1))return;let i=new $S;try{i=yield i.loadAsync(n)}catch(o){return void console.warn(o)}let r=[];i.forEach((o,s)=>r.push(s));for(let o of r)try{let s=yield o.async("arraybuffer");console.log(o.name+" \u89e3\u51cd..."),yield e.load([new File([s],o.name,{type:bc.type(o.name)})])}catch(s){console.warn(s)}})()}saveAsync(n,e,i){return(0,gn.Z)(function*(){if(!n)return;let r=n instanceof FileList?bS(n):n,o=new $S;for(let a of r)o.file(a.name,a);let s=yield o.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}},i);(0,_S.saveAs)(s,e+".zip")})()}}function bS(t){let n=[],e=t.length;for(let i=0;i<e;i++)n.push(t[i]);return n}function Tj(t,n){if(1&t&&(Q(0,"i",6),ve(1),ne()),2&t){const e=me();G(1),lt(e.materialIcon)}}function Sj(t,n){if(1&t&&(Q(0,"div",7),ve(1),ne()),2&t){const e=me();G(1),lt(e.help)}}function Ij(t,n){1&t&&(mt(0,"div",8),Lt(1,"safe")),2&t&&oe("innerHTML",Bt(1,1,me().helpHtml,"html"),lr)}function Mj(t,n){if(1&t){const e=ft();Q(0,"button",9),Ae("click",function(){return Re(e),Le(me().cancel())}),ve(1,"\u30ad\u30e3\u30f3\u30bb\u30eb"),ne()}}let pr=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.title="",this.subTitle="",this.text="",this.help="",this.helpHtml="",this.materialIcon="",this.type=Li.OK,this.action=null,this.cancelAction=null,this.title=i.option.title?i.option.title:"",this.subTitle=i.option.subTitle?i.option.subTitle:"",this.text=i.option.text?i.option.text:"",this.help=i.option.help?i.option.help:"",this.helpHtml=i.option.helpHtml?i.option.helpHtml:"",this.materialIcon=i.option.materialIcon?i.option.materialIcon:"",this.type=i.option.type?i.option.type:Li.OK,this.action=i.option.action?i.option.action:null,this.cancelAction=i.option.cancelAction?i.option.cancelAction:null}ngOnInit(){Promise.resolve().then(()=>{let e="\u78ba\u8a8d";this.title?e+="\u3008"+this.title+(this.subTitle?`\uff1a${this.subTitle}`:"")+"\u3009":this.subTitle&&(e+=`\u3008${this.subTitle}\u3009`),this.modalService.title=this.panelService.title=e}),Ue.register(this)}ngOnDestroy(){Ue.unregister(this)}ok(){this.modalService.resolve(!0),this.action&&this.action()}cancel(){this.modalService.resolve(!1),this.cancelAction&&this.cancelAction()}}return t.\u0275fac=function(e){return new(e||t)(He(qn),He(Yn))},t.\u0275cmp=fn({type:t,selectors:[["app-confirmation"]],decls:9,vars:5,consts:[[1,"text"],["class","material-icons icon",4,"ngIf"],["class","help",4,"ngIf"],["class","help",3,"innerHTML",4,"ngIf"],["type","submit",3,"click"],["type","button",3,"click",4,"ngIf"],[1,"material-icons","icon"],[1,"help"],[1,"help",3,"innerHTML"],["type","button",3,"click"]],template:function(e,i){1&e&&(Q(0,"div",0),Te(1,Tj,2,1,"i",1),ve(2),ne(),mt(3,"hr"),Te(4,Sj,2,1,"div",2),Te(5,Ij,2,4,"div",3),Q(6,"button",4),Ae("click",function(){return i.ok()}),ve(7,"\uff2f\uff2b"),ne(),Te(8,Mj,2,0,"button",5)),2&e&&(G(1),oe("ngIf",i.materialIcon),G(1),lt(i.text),G(2),oe("ngIf",i.help&&!i.helpHtml),G(1),oe("ngIf",i.helpHtml),G(3),oe("ngIf",i.type>1))},dependencies:[Bn,$i],styles:[".text[_ngcontent-%COMP%]{font-weight:bolder;white-space:pre-wrap;word-break:break-all}.icon[_ngcontent-%COMP%]{display:inline-block;font-size:2.5rem;vertical-align:middle;margin-right:4px;padding:2px;text-shadow:2px 2px 2px #555}.help[_ngcontent-%COMP%]{font-size:smaller;white-space:pre-wrap;word-break:break-all;margin-bottom:3px}"]}),t})();var Li=(()=>(function(t){t[t.OK=1]="OK",t[t.OK_CANCEL=2]="OK_CANCEL"}(Li||(Li={})),Li))();function kj(t,n){1&t&&mt(0,"badge",12),2&t&&oe("count",me(2).countImagesHasWord(null))("@.disabled",!0)}function Dj(t,n){if(1&t){const e=ft();Q(0,"label")(1,"input",25),Ae("ngModelChange",function(r){return Re(e),Le(me().searchNoTagImage=r)})("change",function(){Re(e);const r=me();return Le(r.searchNoTagImage=!!r.searchNoTagImage)}),ne(),Q(2,"div",26)(3,"s"),ve(4,"No Tag"),ne(),Te(5,kj,1,2,"badge",27),ne()()}if(2&t){const e=me();G(1),xt("checked",e.searchNoTagImage?"checked":""),oe("ngModel",e.searchNoTagImage),G(4),oe("ngIf",e.countImagesHasWord(null)>0)}}function Aj(t,n){if(1&t&&mt(0,"badge",12),2&t){const e=me().$implicit;oe("count",me().countImagesHasWord(e))("@.disabled",!0)}}function Pj(t,n){if(1&t){const e=ft();Q(0,"label")(1,"input",28),Ae("change",function(){const o=Re(e).$implicit;return Le(me().onSelectedWord(o))}),ne(),Q(2,"div"),ve(3),Te(4,Aj,1,2,"badge",27),ne()()}if(2&t){const e=n.$implicit,i=me();G(1),xt("value",e),oe("checked",i.searchWords.includes(e)),G(2),lt(e),G(1),oe("ngIf",i.countImagesHasWord(e)>0)}}function Nj(t,n){1&t&&Pn(0)}function Oj(t,n){if(1&t&&(Q(0,"label",40),ve(1),ne()),2&t){const e=me().$implicit;G(1),lt(e)}}function Fj(t,n){1&t&&(Q(0,"span",41),ve(1,"\u2026"),ne())}function Rj(t,n){if(1&t&&(it(0),Te(1,Oj,2,1,"label",38),Te(2,Fj,2,0,"span",39),rt()),2&t){const e=n.index;G(1),oe("ngIf",e<6),G(1),oe("ngIf",6==e)}}function Lj(t,n){if(1&t&&(Q(0,"div",37),Te(1,Rj,3,2,"ng-container",14),ne()),2&t){const e=me().$implicit,i=me();G(1),oe("ngForOf",i.getTagWords(e))}}function Bj(t,n){1&t&&(Q(0,"div",37)(1,"s",42),ve(2,"No Tag"),ne()())}function zj(t,n){1&t&&(Q(0,"div",43)(1,"i",44),ve(2,"visibility"),ne()())}function jj(t,n){if(1&t){const e=ft();Q(0,"img",45),Ae("click",function(){Re(e);const r=me().$implicit;return Le(me().onSelectedFile(r))}),Lt(1,"safe"),ne()}if(2&t){const e=me().$implicit;oe("src",Bt(1,2,e.url,"resourceUrl"),vn)("alt",e.name)}}function Uj(t,n){1&t&&mt(0,"img",46),2&t&&xt("alt",me().$implicit.name)}const Hj=function(t){return{selected:t}};function Vj(t,n){if(1&t&&(Q(0,"div",29)(1,"div",30),Te(2,Nj,1,0,"ng-container",31),Te(3,Lj,2,1,"ng-template",null,32,ti),Te(5,Bj,3,0,"ng-template",null,33,ti),ne(),Te(7,zj,3,0,"div",34),Te(8,jj,2,5,"img",35),Te(9,Uj,1,1,"img",36),ne()),2&t){const e=n.$implicit,i=cn(4),r=cn(6),o=me();oe("@scaleInOut",void 0)("ngClass",wt(8,Hj,o.selected(e))),G(2),oe("ngIf",o.getTagWords(e).length>0)("ngIfThen",i)("ngIfElse",r),G(5),oe("ngIf",o.getHidden(e)),G(1),oe("ngIf",0<e.url.length),G(1),oe("ngIf",e.url.length<=0)}}function Gj(t,n){if(1&t){const e=ft();Q(0,"label",56),Ae("click",function(){const o=Re(e).$implicit;return Le(me(3).removeTagWord(o))}),ve(1),Q(2,"sup",57),ve(3,"\xd7"),ne()()}if(2&t){const e=n.$implicit;G(1),lt(e)}}function qj(t,n){if(1&t&&(it(0),Te(1,Gj,4,1,"label",55),rt()),2&t){const e=me(2);G(1),oe("ngForOf",e.selectedImagesOwnWords())}}function Wj(t,n){1&t&&(it(0),Q(1,"span",58)(2,"s"),ve(3,"No Tag"),ne()(),rt())}function Kj(t,n){if(1&t&&(Q(0,"option",59),ve(1),ne()),2&t){const e=n.$implicit;xt("value",e),G(1),lt(e)}}const yS=function(t){return{"red-eye":t}};function Yj(t,n){if(1&t){const e=ft();Q(0,"div",47)(1,"div")(2,"div",48)(3,"button",49),Ae("click",function(){Re(e);const r=me();return Le(r.setectedImagesToHidden(!r.selectedImagesIsHidden))}),Q(4,"i",8),ve(5),ne()()(),Q(6,"button",50),Ae("click",function(){return Re(e),Le(me().onUnselect())}),ve(7),ne(),Q(8,"input",51),Ae("ngModelChange",function(r){return Re(e),Le(me().addingTagWord=r)}),ne(),Q(9,"button",52),Ae("click",function(){return Re(e),Le(me().addTagWord())}),ve(10,"\u30bf\u30b0\u8ffd\u52a0 \u27a1"),ne(),Te(11,qj,2,1,"ng-container",13),Te(12,Wj,4,0,"ng-container",13),ne(),Q(13,"datalist",53),Te(14,Kj,2,2,"option",54),ne()()}if(2&t){const e=me();oe("@fadeAndUpInOut",void 0),G(3),Qt("title",e.selectedImagesIsHidden?"\u9078\u629e\u753b\u50cf\u3092\u8868\u793a\u8a2d\u5b9a\u306b\u3059\u308b":"\u9078\u629e\u753b\u50cf\u3092\u975e\u8868\u793a\u8a2d\u5b9a\u306b\u3059\u308b"),G(1),oe("ngClass",wt(12,yS,e.selectedImagesIsHidden)),G(1),lt(e.selectedImagesIsHidden?"visibility":"visibility_off"),G(2),Zn("\u9078\u629e\u89e3\u9664 (",e.selectedImageFiles.length," \u9078\u629e\u4e2d)"),G(1),k_("list","",e.panelId,"_suggest"),oe("ngModel",e.addingTagWord),G(1),oe("disabled",null==e.addingTagWord||""===e.addingTagWord.trim()),G(2),oe("ngIf",e.selectedImagesOwnWords().length>0),G(1),oe("ngIf",0==e.selectedImagesOwnWords().length),G(1),cr("id","",e.panelId,"_suggest"),G(1),oe("ngForOf",e.suggestWords())}}const Zj=function(t){return{selecter:t}};let us=(()=>{class t{constructor(e,i,r){this.changeDetector=e,this.panelService=i,this.modalService=r,this._searchNoTagImage=!0,this.serchCondIsOr=!0,this.addingTagWord="",this.searchWords=[],this.deletedWords=[],this.selectedImageFiles=[],this.isSort=!0,this.isShowHideImages=!1}get images(){const e=Ur.searchImages(this.searchWords,this.searchNoTagImage&&this.countAllImagesHasWord(null)>0,this.serchCondIsOr,this.isShowHideImages),i=e.map(r=>r.identifier);return this.selectedImageFiles=this.selectedImageFiles.filter(r=>i.includes(r.identifier)),this.isSort?Ur.sortImagesByWords(e,t.sortOrder):e}get searchNoTagImage(){return this._searchNoTagImage}set searchNoTagImage(e){e?t.sortOrder.unshift(null):t.sortOrder=t.sortOrder.filter(i=>null!=i),t.sortOrder=Array.from(new Set(t.sortOrder)),this._searchNoTagImage=e,Ue.trigger("CHANGE_SORT_ORDER",null)}get searchAllImage(){if(!this.searchNoTagImage&&this.countAllImagesHasWord(null)>0)return!1;for(const e of this.allImagesOwnWords)if(!this.searchWords.includes(e))return!1;return!0}get isSelected(){let e=this.selectedImageFiles.length>0;return e||(this.addingTagWord=""),e}get selectedImagesIsHidden(){return Ur.imagesIsHidden(this.selectedImageFiles)}get allImagesOwnWords(){return Ur.allImagesOwnWords(this.isShowHideImages)}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7"),this.searchWords=this.allImagesOwnWords,this.panelId=bo.generateUuid()}ngAfterViewInit(){Ue.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("OPERATE_IMAGE_TAGS",e=>{this.changeDetector.markForCheck()}).on("CHANGE_SORT_ORDER",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){Ue.unregister(this)}allImages(){return Ur.allImages(this.isShowHideImages)}countAllImagesHasWord(e){return Ur.countAllImagesHasWord(e,this.isShowHideImages)}countImagesHasWord(e){let i=0;if(null!=e&&""===e.trim())return i;for(const r of this.images){const o=Un.get(r.identifier);null==e?(!o||null==o.tag||""==o.tag.trim())&&i++:o&&o.containsWords(e.trim(),!1)&&i++}return i}handleFileSelect(e){let i=e.target,r=i.files;r.length&&sa.instance.load(r),i.value=""}selected(e){return this.selectedImageFiles.map(i=>i.identifier).includes(e.identifier)}selectedImagesOwnWords(e=!1){return Ur.imagesOwnWords(this.selectedImageFiles,e)}onSelectedWord(e){null==e||""===e.trim()||(this.searchWords.includes(e)?(this.searchWords=this.searchWords.filter(i=>e!==i),t.sortOrder=t.sortOrder.filter(i=>e!==i)):(this.searchWords.push(e),t.sortOrder.unshift(e)),t.sortOrder=Array.from(new Set(t.sortOrder)),Ue.trigger("CHANGE_SORT_ORDER",e))}onSelectedFile(e){this.selected(e)?this.selectedImageFiles=this.selectedImageFiles.filter(i=>i.identifier!==e.identifier):this.selectedImageFiles.push(e)}getTagWords(e){const i=Un.get(e.identifier);return i?i.words:[]}getHidden(e){const i=Un.get(e.identifier);return!!i&&i.hide}onSearchAllImage(){this.searchAllImage?(this.searchWords=[],this._searchNoTagImage=!1):(this.searchWords=this.allImagesOwnWords,this._searchNoTagImage=!0)}onUnselect(){this.selectedImageFiles=[]}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(pr,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:Li.OK_CANCEL,materialIcon:"visibility",action:()=>{this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}setectedImagesToHidden(e){this.modalService.open(pr,{title:e?"\u975e\u8868\u793a\u306b\u8a2d\u5b9a":"\u975e\u8868\u793a\u8a2d\u5b9a\u3092\u89e3\u9664",text:`\u753b\u50cf${e?"\u3092\u975e\u8868\u793a\u306b\u8a2d\u5b9a":"\u306e\u975e\u8868\u793a\u8a2d\u5b9a\u3092\u89e3\u9664"}\u3057\u307e\u3059\u304b\uff1f`,help:e?"\u9078\u629e\u3057\u305f\u753b\u50cf\u3092\u975e\u8868\u793a\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u3053\u308c\u306f\u300c\u610f\u56f3\u305b\u305a\u306b\u30cd\u30bf\u30d0\u30ec\u3092\u898b\u3066\u3057\u307e\u3046\u300d\u3053\u3068\u306a\u3069\u3092\u9632\u3050\u3082\u306e\u3067\u3042\u308a\u3001\u4ed6\u8005\u304b\u3089\u5b8c\u5168\u306b\u96a0\u3059\u3082\u306e\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002":"\u9078\u629e\u3057\u305f\u753b\u50cf\u306e\u975e\u8868\u793a\u8a2d\u5b9a\u3092\u89e3\u9664\u3057\u307e\u3059\u3002",type:Li.OK_CANCEL,materialIcon:e?"visibility_off":"visibility",action:()=>{for(const i of this.selectedImageFiles){const r=Un.get(i.identifier)||Un.create(i.identifier);r.hide=e,Ue.call("OPERATE_IMAGE_TAGS",r.identifier)}}})}addTagWord(){if(null==this.addingTagWord||""==this.addingTagWord.trim())return;const e=this.addingTagWord.trim().split(/\s+/);this.modalService.open(pr,{title:"\u753b\u50cf\u306b\u30bf\u30b0\u3092\u8ffd\u52a0",text:"\u753b\u50cf\u306b\u30bf\u30b0\u3092\u8ffd\u52a0\u3057\u307e\u3059\u304b\uff1f",helpHtml:"\u9078\u629e\u3057\u305f\u753b\u50cf\u306b "+e.map(i=>`<b class="word-tag">${pt.escapeHtml(i)}</b>`).join(" ")+" \u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002",type:Li.OK_CANCEL,materialIcon:"sell",action:()=>{let i=null;for(const r of this.selectedImageFiles)i=(Un.get(r.identifier)||Un.create(r.identifier)).addWords(e);i&&(this.serchCondIsOr&&this.searchWords.push(...i),t.sortOrder.unshift(...i)),this.serchCondIsOr&&(this.searchWords=Array.from(new Set(this.searchWords)).sort()),t.sortOrder=Array.from(new Set(t.sortOrder)),Ue.trigger("CHANGE_SORT_ORDER",i),this.addingTagWord=""}})}removeTagWord(e){this.modalService.open(pr,{title:"\u753b\u50cf\u304b\u3089\u30bf\u30b0\u3092\u524a\u9664",text:"\u753b\u50cf\u304b\u3089\u30bf\u30b0\u3092\u524a\u9664\u3057\u307e\u3059\u304b\uff1f",helpHtml:`\u9078\u629e\u3057\u305f\u753b\u50cf\u304b\u3089 <b class="word-tag">${pt.escapeHtml(e)}</b> \u3092\u524a\u9664\u3057\u307e\u3059\u3002`,type:Li.OK_CANCEL,materialIcon:"sell",action:()=>{if(null==e||""==e.trim())return;for(const r of this.selectedImageFiles){let o=Un.get(r.identifier);o&&o.removeWords(e)}const i=this.allImagesOwnWords;this.searchWords=this.searchWords.filter(r=>i.includes(r)),this.deletedWords.push(e),this.deletedWords=Array.from(new Set(this.deletedWords)),Ue.trigger("CHANGE_SORT_ORDER",this.deletedWords)}})}identify(e,i){return i.identifier}suggestWords(){const e=this.selectedImagesOwnWords(!0);return Array.from(new Set(this.allImagesOwnWords.concat(this.deletedWords))).filter(i=>0!==i.indexOf("*")&&!e.includes(i))}}return t.sortOrder=[],t.\u0275fac=function(e){return new(e||t)(He(Ki),He(qn),He(Yn))},t.\u0275cmp=fn({type:t,selectors:[["file-storage"]],decls:41,vars:19,consts:[[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","image/*",2,"display","none",3,"change"],[1,"sticky-top"],[2,"float","right","margin-top","3px","margin-right","3px"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[1,"word-selecter"],["name","word-selecter","type","checkbox","value","ALL",3,"checked","click"],[1,"all-tags"],[1,"badge",3,"count"],[4,"ngIf"],[4,"ngFor","ngForOf"],[2,"white-space","nowrap"],[2,"margin-left","3px",3,"ngModel","ngModelChange"],["value","true"],["value",""],["sytle","white-space: nowrap","title","\u6700\u8fd1\u4f7f\u3063\u305f\u30bf\u30b0\u306e\u753b\u50cf\u3092\u524d\u306b"],["name","is-sort","value","Sort","type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"font-size","smaller","margin-right","3px"],["id","file-list",2,"padding-top","3px",3,"ngClass"],["class","image","style","text-align: center; min-width: 100px; height: 120px; position: relative;",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["class","sticky-bottom",4,"ngIf"],["name","word-selecter","type","checkbox","value","No Tag",3,"ngModel","checked","ngModelChange","change"],[1,"no-tag"],["class","badge",3,"count",4,"ngIf"],["name","word-selecter","type","checkbox",3,"value","checked","change"],[1,"image",2,"text-align","center","min-width","100px","height","120px","position","relative",3,"ngClass"],[2,"position","absolute","font-size","xx-small","text-align","left","bottom","0px","width","100%","height","100%","overflow","hidden","pointer-events","none"],[4,"ngIf","ngIfThen","ngIfElse"],["tagsBlock",""],["noTagBlock",""],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["height","120",3,"src","alt","click",4,"ngIf"],["src","assets/images/loading.gif",3,"alt",4,"ngIf"],[2,"position","absolute","bottom","0px","z-index","5"],["class","word-tag grow","style","display: block; width: 88px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],["class","grow","style","display: block; width: 88px; overflow: hidden; padding-left: 2px; font-weight: bold; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],[1,"word-tag","grow",2,"display","block","width","88px","overflow","hidden","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"display","block","width","88px","overflow","hidden","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"color","gray","display","block","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons","red-eye",2,"margin-right","2px","font-size","16px","display","block"],["height","120",3,"src","alt","click"],["src","assets/images/loading.gif",3,"alt"],[1,"sticky-bottom"],[2,"margin-left","3px","float","right"],[2,"padding","2px 0.5em",3,"click"],[2,"font-size","x-small","margin-right","2em",3,"click"],["type","text","placeholder","\u30b9\u30da\u30fc\u30b9 \u533a\u5207\u308a\u3067 \u8907\u6570\u53ef\u80fd",2,"width","14em",3,"ngModel","ngModelChange"],[2,"font-size","x-small",3,"disabled","click"],[3,"id"],[3,"value",4,"ngFor","ngForOf"],["class","word-tag","style","cursor: pointer; font-size: smaller",3,"click",4,"ngFor","ngForOf"],[1,"word-tag",2,"cursor","pointer","font-size","smaller",3,"click"],[2,"font-size","xx-small","color","red"],[2,"font-size","smaller","font-weight","bolder","margin-left","3px","color","gray"],[3,"value"]],template:function(e,i){1&e&&(Q(0,"label")(1,"div",0)(2,"div")(3,"i",1),ve(4,"add_photo_alternate"),ne()(),Q(5,"div"),ve(6,"\u3053\u3053\u306b\u753b\u50cf\u3092\u30c9\u30ed\u30c3\u30d7"),ne(),Q(7,"div",2),ve(8,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),ne(),Q(9,"input",3),Ae("change",function(o){return i.handleFileSelect(o)}),ne(),Q(10,"div",2),mt(11,"br"),ve(12,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d2MB\u307e\u3067"),ne()()(),Q(13,"div",4)(14,"div",5)(15,"label",6)(16,"input",7),Ae("click",function(o){return i.onShowHiddenImages(o)}),ne(),Q(17,"i",8),ve(18),ne()()(),Q(19,"span",9)(20,"label")(21,"input",10),Ae("click",function(){return i.onSearchAllImage()}),ne(),Q(22,"div",11)(23,"b"),ve(24,"ALL"),ne(),mt(25,"badge",12),ne()(),Te(26,Dj,6,3,"label",13),Te(27,Pj,5,4,"label",14),ne(),Q(28,"span",15)(29,"select",16),Ae("ngModelChange",function(o){return i.serchCondIsOr=o}),Q(30,"option",17),ve(31,"\u3044\u305a\u308c\u304b (OR)"),ne(),Q(32,"option",18),ve(33,"\u3059\u3079\u3066 (AND)"),ne()(),Q(34,"label",19)(35,"input",20),Ae("ngModelChange",function(o){return i.isSort=o})("change",function(){return i.isSort=!!i.isSort}),ne(),Q(36,"b",21),ve(37,"\u30bd\u30fc\u30c8"),ne()()()(),Q(38,"div",22),Te(39,Vj,10,10,"div",23),ne(),Te(40,Yj,15,14,"div",24)),2&e&&(G(16),xt("checked",i.isShowHideImages?"checked":""),G(1),oe("ngClass",wt(15,yS,i.isShowHideImages)),G(1),lt(i.isShowHideImages?"visibility":"visibility_off"),G(3),xt("checked",i.searchAllImage?"checked":""),G(4),oe("count",i.images.length)("@.disabled",!0),G(1),oe("ngIf",i.countAllImagesHasWord(null)>0),G(1),oe("ngForOf",i.allImagesOwnWords),G(2),oe("ngModel",i.serchCondIsOr),G(6),xt("checked",i.isSort?"checked":""),oe("ngModel",i.isSort),G(3),oe("ngClass",wt(17,Zj,i.isSelected)),G(1),oe("ngForOf",i.images)("ngForTrackBy",i.identify),G(1),oe("ngIf",i.isSelected))},dependencies:[si,_i,Bn,oo,so,Ii,Oo,$o,Mi,yi,ff,$i],styles:['[_nghost-%COMP%]{display:block}.drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.image[_ngcontent-%COMP%]{font-size:0;display:inline-block;border:2px solid transparent;margin-right:-2px;cursor:pointer}.image[_ngcontent-%COMP%]:hover{border:2px dotted red;transform:scale(1.08);z-index:150;transition-duration:60ms}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom;transition-duration:.12s}.image.selected[_ngcontent-%COMP%]{border:2px solid red}.selecter[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]:not(.selected)   img[_ngcontent-%COMP%]{filter:saturate(40%) opacity(90%) blur(2px)}.image[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(1px);backdrop-filter:blur(1px);filter:none!important}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.sticky-top[_ngcontent-%COMP%]{position:sticky;top:0;background-color:#f0dabde6;border-bottom:1px dotted #666;z-index:100}.sticky-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;background-color:#f0dabde6;border-top:1px dotted #666;z-index:200}.word-tag[_ngcontent-%COMP%]{margin-right:3px;display:inline-block;color:#000;font-weight:bolder}.word-tag[_ngcontent-%COMP%]:hover{color:red}.word-selecter[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.word-selecter[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{display:none}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div.all-tags[_ngcontent-%COMP%]{background-color:#eee;color:#008b8b}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}'],data:{animation:[Vn("scaleInOut",[tn("void => *",[Zt("200ms ease",bn([dt({transform:"scale3d(0, 0, 0)",offset:0}),dt({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),tn("* => void",[Zt("180ms ease",dt({transform:"scale3d(0, 0, 0)"}))])]),Vn("fadeAndUpInOut",[tn("void => *",[Zt("100ms ease-in-out",bn([dt({"transform-origin":"center bottom",transform:"translateY(8px) scaleY(0)",opacity:.6}),dt({"transform-origin":"center bottom",transform:"translateY(0px) scaleY(1.0)",opacity:1})]))]),tn("* => void",[Zt("100ms ease-in-out",dt({"transform-origin":"center bottom",transform:"translateY(0px) scaleY(1.0)",opacity:1})),Zt("100ms ease-in-out",dt({"transform-origin":"center bottom",transform:"translateY(8px) scaleY(0)",opacity:.6}))])])]},changeDetection:0}),t})();function Xj(t,n){1&t&&mt(0,"badge",8),2&t&&oe("count",me(2).countImagesHasWord(null))("@.disabled",!0)}function Qj(t,n){if(1&t){const e=ft();Q(0,"label")(1,"input",21),Ae("ngModelChange",function(r){return Re(e),Le(me().searchNoTagImage=r)})("change",function(){Re(e);const r=me();return Le(r.searchNoTagImage=!!r.searchNoTagImage)}),ne(),Q(2,"div",22)(3,"s"),ve(4,"No Tag"),ne(),Te(5,Xj,1,2,"badge",23),ne()()}if(2&t){const e=me();G(1),xt("checked",e.searchNoTagImage?"checked":""),oe("ngModel",e.searchNoTagImage),G(4),oe("ngIf",e.countImagesHasWord(null)>0)}}function Jj(t,n){if(1&t&&mt(0,"badge",8),2&t){const e=me().$implicit;oe("count",me().countImagesHasWord(e))("@.disabled",!0)}}function eU(t,n){if(1&t){const e=ft();Q(0,"label")(1,"input",24),Ae("change",function(){const o=Re(e).$implicit;return Le(me().onSelectedWord(o))}),ne(),Q(2,"div"),ve(3),Te(4,Jj,1,2,"badge",23),ne()()}if(2&t){const e=n.$implicit,i=me();G(1),xt("value",e),oe("checked",i.searchWords.includes(e)),G(2),lt(e),G(1),oe("ngIf",i.countImagesHasWord(e)>0)}}function tU(t,n){if(1&t){const e=ft();Q(0,"span",25)(1,"button",26),Ae("click",function(){Re(e);const r=me();return Le(r.onSelectedFile(r.empty))}),ve(2,"\u753b\u50cf\u306a\u3057"),mt(3,"br"),ve(4,"/\u8a2d\u5b9a\u89e3\u9664"),ne()()}}function nU(t,n){1&t&&Pn(0)}function iU(t,n){if(1&t&&(Q(0,"label",39),ve(1),ne()),2&t){const e=me().$implicit;G(1),lt(e)}}function rU(t,n){1&t&&(Q(0,"span",40),ve(1,"\u2026"),ne())}function oU(t,n){if(1&t&&(it(0),Te(1,iU,2,1,"label",37),Te(2,rU,2,0,"span",38),rt()),2&t){const e=n.index;G(1),oe("ngIf",e<6),G(1),oe("ngIf",6==e)}}function sU(t,n){if(1&t&&(Q(0,"div",36),Te(1,oU,3,2,"ng-container",10),ne()),2&t){const e=me().$implicit,i=me();G(1),oe("ngForOf",i.getTagWords(e))}}function aU(t,n){1&t&&(Q(0,"div",36)(1,"s",41),ve(2,"No Tag"),ne()())}function lU(t,n){1&t&&(Q(0,"div",42)(1,"i",43),ve(2,"visibility"),ne()())}function cU(t,n){1&t&&(Q(0,"div",44)(1,"b",45),ve(2,"\u8a2d\u5b9a\u4e2d"),ne()())}function uU(t,n){if(1&t){const e=ft();Q(0,"img",46),Ae("click",function(){Re(e);const r=me().$implicit,o=me();return Le(!o.getCurrent(r)&&o.onSelectedFile(r))}),Lt(1,"safe"),ne()}if(2&t){const e=me().$implicit;oe("src",Bt(1,2,e.url,"resourceUrl"),vn)("alt",e.name)}}function dU(t,n){1&t&&mt(0,"img",47),2&t&&xt("alt",me().$implicit.name)}const fU=function(t){return{"current-images":t}};function hU(t,n){if(1&t&&(Q(0,"div",27)(1,"div",28),Te(2,nU,1,0,"ng-container",29),Te(3,sU,2,1,"ng-template",null,30,ti),Te(5,aU,3,0,"ng-template",null,31,ti),ne(),Te(7,lU,3,0,"div",32),Te(8,cU,3,0,"div",33),Te(9,uU,2,5,"img",34),Te(10,dU,1,1,"img",35),ne()),2&t){const e=n.$implicit,i=cn(4),r=cn(6),o=me();oe("@scaleInOut",void 0)("ngClass",wt(9,fU,o.getCurrent(e))),G(2),oe("ngIf",o.getTagWords(e).length>0)("ngIfThen",i)("ngIfElse",r),G(5),oe("ngIf",o.getHidden(e)),G(1),oe("ngIf",o.getCurrent(e)),G(1),oe("ngIf",0<e.url.length),G(1),oe("ngIf",e.url.length<=0)}}const pU=function(t){return{"red-eye":t}};let aa=(()=>{class t{constructor(e,i,r){this.changeDetector=e,this.panelService=i,this.modalService=r,this.isAllowedEmpty=!1,this.currentImageIdentifires=[],this._searchNoTagImage=!0,this.serchCondIsOr=!0,this.addingTagWord="",this.searchWords=[],this.isSort=!0,this.isShowHideImages=!1,this.isAllowedEmpty=!(!this.modalService.option||!this.modalService.option.isAllowedEmpty),this.modalService.option&&this.modalService.option.currentImageIdentifires&&(this.currentImageIdentifires=this.modalService.option.currentImageIdentifires)}get images(){const e=Ur.searchImages(this.searchWords,this.searchNoTagImage&&this.countAllImagesHasWord(null)>0,this.serchCondIsOr,this.isShowHideImages);return this.isSort?Ur.sortImagesByWords(e,us.sortOrder).sort((i,r)=>this.getCurrent(i)?this.getCurrent(r)?0:-1:this.getCurrent(r)?1:0):e}get empty(){return on.Empty}get searchNoTagImage(){return this._searchNoTagImage}set searchNoTagImage(e){e?us.sortOrder.unshift(null):us.sortOrder=us.sortOrder.filter(i=>null!=i),us.sortOrder=Array.from(new Set(us.sortOrder)),this._searchNoTagImage=e,Ue.trigger("CHANGE_SORT_ORDER",null)}get searchAllImage(){if(!this.searchNoTagImage&&this.countAllImagesHasWord(null)>0)return!1;for(const e of this.allImagesOwnWords)if(!this.searchWords.includes(e))return!1;return!0}get allImagesOwnWords(){return Ur.allImagesOwnWords(this.isShowHideImages)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7"),this.searchWords=this.allImagesOwnWords}ngAfterViewInit(){Ue.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("OPERATE_IMAGE_TAGS",e=>{this.changeDetector.markForCheck()}).on("CHANGE_SORT_ORDER",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){Ue.unregister(this)}allImages(){return Ur.allImages(this.isShowHideImages)}countAllImagesHasWord(e){return Ur.countAllImagesHasWord(e,this.isShowHideImages)}countImagesHasWord(e){let i=0;if(null!=e&&""===e.trim())return i;for(const r of this.images){const o=Un.get(r.identifier);null==e?(!o||null==o.tag||""==o.tag.trim())&&i++:o&&o.containsWords(e.trim(),!1)&&i++}return i}getTagWords(e){const i=Un.get(e.identifier);return i?i.words:[]}getHidden(e){const i=Un.get(e.identifier);return!!i&&i.hide}getCurrent(e){return!!this.currentImageIdentifires&&this.currentImageIdentifires.includes(e.identifier)}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(pr,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:Li.OK_CANCEL,materialIcon:"visibility",action:()=>{this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}onSelectedFile(e){this.modalService.resolve(e.identifier)}onSearchAllImage(){this.searchAllImage?(this.searchWords=[],this._searchNoTagImage=!1):(this.searchWords=this.allImagesOwnWords,this._searchNoTagImage=!0)}onSelectedWord(e){null==e||""===e.trim()||(this.searchWords.includes(e)?(this.searchWords=this.searchWords.filter(i=>e!==i),us.sortOrder=us.sortOrder.filter(i=>e!==i)):(this.searchWords.push(e),us.sortOrder.unshift(e)),us.sortOrder=Array.from(new Set(us.sortOrder)),Ue.trigger("CHANGE_SORT_ORDER",e))}cancel(){this.modalService.resolve(!1)}identify(e,i){return i.identifier}}return t.\u0275fac=function(e){return new(e||t)(He(Ki),He(qn),He(Yn))},t.\u0275cmp=fn({type:t,selectors:[["file-selector"]],inputs:{isAllowedEmpty:"isAllowedEmpty",currentImageIdentifires:"currentImageIdentifires"},decls:28,vars:16,consts:[[1,"sticky-top"],[2,"float","right","margin-top","3px","margin-right","3px"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[1,"word-selecter"],["name","word-selecter","type","checkbox","value","ALL",3,"checked","click"],[1,"all-tags"],[1,"badge",3,"count"],[4,"ngIf"],[4,"ngFor","ngForOf"],[2,"white-space","nowrap"],[2,"margin-left","3px",3,"ngModel","ngModelChange"],["value","true"],["value",""],["sytle","white-space: nowrap","title","\u6700\u8fd1\u4f7f\u3063\u305f\u30bf\u30b0\u306e\u753b\u50cf\u3092\u524d\u306b"],["name","is-sort","value","Sort","type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"font-size","smaller","margin-right","3px"],["id","file-list",2,"min-height","250px","margin-left","1px","padding-top","3px"],["class","empty","style","display: inline-block;",4,"ngIf"],["class","image","style","text-align: center; min-width: 100px; height: 120px; position: relative",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["name","word-selecter","type","checkbox","value","No Tag",3,"ngModel","checked","ngModelChange","change"],[1,"no-tag"],["class","badge",3,"count",4,"ngIf"],["name","word-selecter","type","checkbox",3,"value","checked","change"],[1,"empty",2,"display","inline-block"],[2,"min-width","100px","margin-left","-1px","margin-right","3px",3,"click"],[1,"image",2,"text-align","center","min-width","100px","height","120px","position","relative",3,"ngClass"],[2,"position","absolute","font-size","xx-small","text-align","left","bottom","0px","width","100%","height","100%","overflow","hidden","pointer-events","none"],[4,"ngIf","ngIfThen","ngIfElse"],["tagsBlock",""],["noTagBlock",""],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["style","position: absolute; top: 0px; left: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["height","120",3,"src","alt","click",4,"ngIf"],["src","assets/images/loading.gif",3,"alt",4,"ngIf"],[2,"position","absolute","bottom","0px","z-index","5"],["class","word-tag grow","style","display: block; width: 88px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],["class","grow","style","display: block; width: 88px; overflow: hidden; padding-left: 2px; font-weight: bold; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],[1,"word-tag","grow",2,"display","block","width","88px","overflow","hidden","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"display","block","width","88px","overflow","hidden","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"color","gray","display","block","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons","red-eye",2,"z-index","5","margin-right","2px","font-size","16px","display","block"],[2,"position","absolute","top","0px","left","0px","pointer-events","none","z-index","5"],[1,"grow",2,"font-size","13px","color","red","padding-left","2px"],["height","120",3,"src","alt","click"],["src","assets/images/loading.gif",3,"alt"]],template:function(e,i){1&e&&(Q(0,"div",0)(1,"div",1)(2,"label",2)(3,"input",3),Ae("click",function(o){return i.onShowHiddenImages(o)}),ne(),Q(4,"i",4),ve(5),ne()()(),Q(6,"span",5)(7,"label")(8,"input",6),Ae("click",function(){return i.onSearchAllImage()}),ne(),Q(9,"div",7)(10,"b"),ve(11,"ALL"),ne(),mt(12,"badge",8),ne()(),Te(13,Qj,6,3,"label",9),Te(14,eU,5,4,"label",10),ne(),Q(15,"span",11)(16,"select",12),Ae("ngModelChange",function(o){return i.serchCondIsOr=o}),Q(17,"option",13),ve(18,"\u3044\u305a\u308c\u304b (OR)"),ne(),Q(19,"option",14),ve(20,"\u3059\u3079\u3066 (AND)"),ne()(),Q(21,"label",15)(22,"input",16),Ae("ngModelChange",function(o){return i.isSort=o})("change",function(){return i.isSort=!!i.isSort}),ne(),Q(23,"b",17),ve(24,"\u30bd\u30fc\u30c8"),ne()()()(),Q(25,"div",18),Te(26,tU,5,0,"span",19),Te(27,hU,11,11,"div",20),ne()),2&e&&(G(3),xt("checked",i.isShowHideImages?"checked":""),G(1),oe("ngClass",wt(14,pU,i.isShowHideImages)),G(1),lt(i.isShowHideImages?"visibility":"visibility_off"),G(3),xt("checked",i.searchAllImage?"checked":""),G(4),oe("count",i.images.length)("@.disabled",!0),G(1),oe("ngIf",i.countAllImagesHasWord(null)>0),G(1),oe("ngForOf",i.allImagesOwnWords),G(2),oe("ngModel",i.serchCondIsOr),G(6),xt("checked",i.isSort?"checked":""),oe("ngModel",i.isSort),G(4),oe("ngIf",i.isAllowedEmpty),G(1),oe("ngForOf",i.images)("ngForTrackBy",i.identify))},dependencies:[si,_i,Bn,oo,so,Oo,$o,Mi,yi,ff,$i],styles:["[_nghost-%COMP%]{display:block}.image[_ngcontent-%COMP%]{font-size:0;display:inline-block;border:2px solid transparent;margin-left:-2px}.image[_ngcontent-%COMP%]:not(.current-images){cursor:pointer}.image[_ngcontent-%COMP%]:not(.current-images):hover{border:2px dotted red;transform:scale(1.08);z-index:200;transition-duration:60ms}.current-images[_ngcontent-%COMP%]{border:2px solid red}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom;transition-duration:.12s}.image[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(1px);backdrop-filter:blur(1px);filter:none!important}.empty[_ngcontent-%COMP%]{line-height:120px;vertical-align:top}.empty[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:120px;margin:1px;box-sizing:border-box;vertical-align:top}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.sticky-top[_ngcontent-%COMP%]{position:sticky;top:0;background-color:#f0dabde6;border-top:1px dotted #666;border-bottom:1px dotted #666;z-index:100}.word-tag[_ngcontent-%COMP%]{margin-right:3px;display:inline-block;color:#000;font-weight:bolder}.word-tag[_ngcontent-%COMP%]:hover{color:red}.word-selecter[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.word-selecter[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{display:none}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div.all-tags[_ngcontent-%COMP%]{background-color:#eee;color:#008b8b}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}"],data:{animation:[Vn("scaleInOut",[tn("void => *",[Zt("200ms ease",bn([dt({transform:"scale3d(0, 0, 0)",offset:0}),dt({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),tn("* => void",[Zt("180ms ease",dt({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),t})();function bv(t,n=[]){let e=Ct.instance.getObjects(t.aliasName);n.forEach(o=>e=e.concat(Ct.instance.getObjects(o))),e=e.filter(o=>o.isVisibleOnTable);let i=-1,r=!1;for(let o=0;o<e.length;o++)i===e[o].zindex?r=!0:i<e[o].zindex&&(i=e[o].zindex,r=!1);if((i!==t.zindex||r)&&(t.zindex=i+1,!(t.zindex<e.length+256))){e.sort((o,s)=>o.zindex-s.zindex);for(let o=0;o<e.length;o++)e[o].zindex=o}}var $g,Go=(()=>(function(t){t[t.FRONT=0]="FRONT",t[t.BACK=1]="BACK"}(Go||(Go={})),Go))();let Qn=$g=class extends Pi{constructor(){super(...arguments),this.state=Go.FRONT,this.rotate=0,this.owner="",this.zindex=0,this.isLocked=!1}get isVisibleOnTable(){return"table"===this.location.name&&(!this.parentIsAssigned||this.parentIsDestroyed)}get name(){return this.getCommonValue("name","")}get size(){return this.getCommonValue("size",2)}set size(n){this.setCommonValue("size",n)}get frontImage(){return this.getImageFile("front")}get backImage(){return this.getImageFile("back")}get imageFile(){return this.isVisible?this.frontImage:this.backImage}get fontsize(){let n=this.getElement("fontsize",this.commonDataElement);return n?+n.value:18}set fontsize(n){this.setCommonValue("fontsize",n)}get text(){let n=this.getElement("text",this.commonDataElement);return n?n.value+"":""}set text(n){this.setCommonValue("text",n)}get color(){return this.getCommonValue("color","#555555")}set color(n){this.setCommonValue("color",n)}get ownerName(){let n=Qe.findByUserId(this.owner);return n?n.name:""}get ownerColor(){let n=Qe.findByUserId(this.owner);return n?n.color:"#444444"}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return!!this.hasOwner&&(Ot.peerContext.userId===this.owner&&Ot.peerContext.isOpen||Ot.peerContexts.some(n=>{const e=Qe.findByPeerId(n.peerId);return e&&e.userId===this.owner&&n.isOpen}))}get isHand(){return Ot.peerContext.userId===this.owner}get isFront(){return this.state===Go.FRONT}get isVisible(){return this.isHand||this.isFront}complement(){let n=this.getElement("fontsize",this.commonDataElement);!n&&this.commonDataElement&&this.commonDataElement.appendChild(St.create("fontsize",18,{},"fontsize_"+this.identifier)),n=this.getElement("text",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.appendChild(St.create("text","",{type:"note",currentValue:""},"text_"+this.identifier)),n=this.getElement("color",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.appendChild(St.create("color","#555555",{type:"color"},"color_"+this.identifier))}faceUp(){this.state=Go.FRONT,this.owner=""}faceDown(){this.state=Go.BACK,this.owner=""}toTopmost(){bv(this,["card-stack"])}static create(n,e,i,r=2,o){let s=null;return s=o?new $g(o):new $g,s.createDataElements(),s.commonDataElement.appendChild(St.create("name",n,{},"name_"+s.identifier)),s.commonDataElement.appendChild(St.create("size",r,{},"size_"+s.identifier)),s.imageDataElement.appendChild(St.create("front",e,{type:"image"},"front_"+s.identifier)),s.imageDataElement.appendChild(St.create("back",i,{type:"image"},"back_"+s.identifier)),s.commonDataElement.appendChild(St.create("fontsize",18,{},"fontsize_"+s.identifier)),s.commonDataElement.appendChild(St.create("text","",{type:"note",currentValue:""},"text_"+s.identifier)),s.commonDataElement.appendChild(St.create("color","#555555",{type:"color"},"ccolor_"+s.identifier)),s.initialize(),s}};var vg;$e([bt()],Qn.prototype,"state",void 0),$e([bt()],Qn.prototype,"rotate",void 0),$e([bt()],Qn.prototype,"owner",void 0),$e([bt()],Qn.prototype,"zindex",void 0),$e([bt()],Qn.prototype,"isLocked",void 0),Qn=$g=$e([mi("card")],Qn);let ai=vg=class extends Pi{constructor(){super(...arguments),this.rotate=0,this.zindex=0,this.owner="",this.isShowTotal=!0,this.isLocked=!1}get name(){return this.getCommonValue("name","")}get ownerName(){let n=Qe.findByUserId(this.owner);return n?n.name:""}get ownerColor(){let n=Qe.findByUserId(this.owner);return n?n.color:"#444444"}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return!!this.hasOwner&&(Ot.peerContext.userId===this.owner&&Ot.peerContext.isOpen||Ot.peerContexts.some(n=>{const e=Qe.findByPeerId(n.peerId);return e&&e.userId===this.owner&&n.isOpen}))}get cardRoot(){for(let n of this.children)if("cardRoot"===n.getAttribute("name"))return n;return null}get cards(){return this.cardRoot?this.cardRoot.children:[]}get topCard(){return this.isEmpty?null:this.cards[0]}get isEmpty(){return this.cards.length<1}get imageFile(){return this.topCard?this.topCard.imageFile:null}complement(){this.cards.forEach(n=>n.complement())}onChildRemoved(n){super.onChildRemoved(n),n instanceof Qn&&Ue.trigger("CARD_STACK_DECREASED",{cardStackIdentifier:this.identifier,cardIdentifier:n.identifier})}shuffle(){if(!this.cardRoot)return;let n=this.cardRoot.children.length;for(let e of this.cards)e.index=Math.random()*n,e.rotate=180*Math.floor(2*Math.random()),this.setSamePositionFor(e);return this.cards}drawCard(){let n=this.topCard?this.cardRoot.removeChild(this.topCard):null;return n&&(n.rotate+=this.rotate,360<n.rotate&&(n.rotate-=360),this.setSamePositionFor(n),n.toTopmost()),n}drawCardAll(){let n=this.cards;for(let e of n)this.cardRoot.removeChild(e),e.rotate+=this.rotate,this.setSamePositionFor(e),360<e.rotate&&(e.rotate-=360);return n}faceUp(){this.topCard&&(this.topCard.faceUp(),this.setSamePositionFor(this.topCard))}faceDown(){this.topCard&&(this.topCard.faceDown(),this.setSamePositionFor(this.topCard))}faceUpAll(){for(let n of this.cards)n.faceUp(),this.setSamePositionFor(n)}faceDownAll(){for(let n of this.cards)n.faceDown(),this.setSamePositionFor(n)}uprightAll(){for(let n of this.cards)n.rotate=0,this.setSamePositionFor(n)}inverse(){const n=[];for(;;){let e=this.topCard?this.cardRoot.removeChild(this.topCard):null;if(null==e)break;n.unshift(e),e.state=e.state==Go.FRONT?Go.BACK:Go.FRONT}for(let e of n)this.putOnBottom(e)}unifyCardsSize(n){for(const e of this.cards)e.size!==n&&(e.size=n)}putOnTop(n){if(!this.cardRoot)return null;if(!this.topCard)return this.putOnBottom(n);n.owner="",n.zindex=0;let e=Math.abs(n.rotate-this.rotate);return 180<e&&(e=360-e),n.rotate=e<=90?0:180,this.setSamePositionFor(n),this.cardRoot.insertBefore(n,this.topCard)}putOnBottom(n){if(!this.cardRoot)return null;n.owner="",n.zindex=0;let e=Math.abs(n.rotate-this.rotate);return 180<e&&(e=360-e),n.rotate=e<=90?0:180,this.setSamePositionFor(n),this.cardRoot.appendChild(n)}toTopmost(){bv(this,["card"])}setLocation(n){super.setLocation(n);let e=this.cards;for(let i of e)i.setLocation(n)}setSamePositionFor(n){n.location.name=this.location.name,n.location.x=this.location.x,n.location.y=this.location.y,n.posZ=this.posZ}static create(n,e){let i=null;i=e?new vg(e):new vg,i.createDataElements(),i.commonDataElement.appendChild(St.create("name",n,{},"name_"+i.identifier));let r=new ni("cardRoot_"+i.identifier);return r.setAttribute("name","cardRoot"),r.initialize(),i.appendChild(r),i.initialize(),i}};$e([bt()],ai.prototype,"rotate",void 0),$e([bt()],ai.prototype,"zindex",void 0),$e([bt()],ai.prototype,"owner",void 0),$e([bt()],ai.prototype,"isShowTotal",void 0),$e([bt()],ai.prototype,"isLocked",void 0),ai=vg=$e([mi("card-stack")],ai);var bg,qi=(()=>(function(t){t[t.D2=0]="D2",t[t.D4=1]="D4",t[t.D6=2]="D6",t[t.D8=3]="D8",t[t.D10=4]="D10",t[t.D10_10TIMES=5]="D10_10TIMES",t[t.D12=6]="D12",t[t.D20=7]="D20"}(qi||(qi={})),qi))();let xr=bg=class extends Pi{constructor(){super(...arguments),this.face="0",this.owner="",this.rotate=0,this.isDropShadow=!0,this.isLock=!1}get name(){return this.getCommonValue("name","")}set name(n){this.setCommonValue("name",n)}get size(){return this.getCommonValue("size",1)}set size(n){this.setCommonValue("size",n)}get faces(){return this.imageDataElement?this.imageDataElement.children.filter(n=>"nothing"!=n.currentValue).map(n=>n.name):[]}get imageFile(){return this.isVisible?this.getImageFile(this.face):this.faces.length?this.getImageFile(this.faces[0]):null}get backFaceImageFile(){return this.isCoin?this.getImageFile(this.isVisible?"\u8868"==this.face?"\u88cf":"\u8868":this.faces[1]):this.imageFile}get nothingFaces(){return this.imageDataElement.children.filter(n=>"nothing"==n.currentValue).map(n=>n.name)}get ownerName(){let n=Qe.findByUserId(this.owner);return n?n.name:""}get ownerColor(){let n=Qe.findByUserId(this.owner);return n?n.color:"#444444"}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return this.hasOwner&&Ot.peerContexts.some(n=>n.userId===this.owner&&n.isOpen)}get isMine(){return Ot.peerContext.userId===this.owner}get isVisible(){return!this.hasOwner||this.isMine||this.isGMMode}get isCoin(){return 2===this.faces.length}diceRoll(){let n=this.faces;return this.face=0<n.length?n[Math.floor(Math.random()*n.length)]:"",this.face}setDicetype(n){this.makeDiceFace(n)}makeDiceFace(n,e){let i=1,r=[],o=s=>s+1+"";switch(n){case qi.D2:i=2,o=a=>0===a?"\u8868":"\u88cf";break;case qi.D4:i=4;break;case qi.D6:i=6,r.push(St.create("\u306a\u3057","",{type:"image",currentValue:"nothing"},null!=e?"nothing_"+e:null));break;case qi.D8:i=8;break;case qi.D10_10TIMES:o=a=>a+1+"0";case qi.D10:i=10;break;case qi.D12:i=12;break;case qi.D20:i=20;break;default:i=2}for(let s=0;s<i;s++){let a=o(s);r.push(St.create(a,"",{type:"image"},null!=e?a+"_"+e:null))}return this.imageDataElement.children.forEach(s=>s.destroy()),r.forEach(s=>this.imageDataElement.appendChild(s)),this.face=this.faces[0],r}static create(n,e,i,r){let o=r?new bg(r):new bg;return o.createDataElements(),o.commonDataElement.appendChild(St.create("name",n,{},"name_"+o.identifier)),o.commonDataElement.appendChild(St.create("size",i,{},"size_"+o.identifier)),o.makeDiceFace(e,o.identifier),o.initialize(),o}};var yv;$e([bt()],xr.prototype,"face",void 0),$e([bt()],xr.prototype,"owner",void 0),$e([bt()],xr.prototype,"rotate",void 0),$e([bt()],xr.prototype,"isDropShadow",void 0),$e([bt()],xr.prototype,"isLock",void 0),xr=bg=$e([mi("dice-symbol")],xr);let di=yv=class extends ni{constructor(){super(...arguments),this.toName="",this.toImageIdentifier="",this.toColor="",this.aura=-1,this.lastUpdate=0,this.isAnimated=!1,this._sendTo=[],this._tags=[],this.locale="en-US"}get tabIdentifier(){return this.parent.identifier}get text(){return this.value}set text(n){this.value=n??""}get timestamp(){let n=this.getAttribute("timestamp"),e=n?+n:0;return Number.isNaN(e)?1:e}get sendTo(){return this._to!==this.to&&(this._to=this.to,this._sendTo=null!=this.to&&0<this.to.trim().length?this.to.trim().split(/\s+/):[]),this._sendTo}get isEdited(){return this.lastUpdate>0}get tags(){return this._tag!==this.tag&&(this._tag=this.tag,this._tags=null!=this.tag&&0<this.tag.trim().length?this.tag.trim().split(/\s+/):[]),this._tags}get image(){return Gt.instance.get(this.imageIdentifier)}get toImage(){return Gt.instance.get(this.toImageIdentifier)}get index(){return this.minorIndex+this.timestamp}get isDirect(){return 0<this.sendTo.length||-1<this.tags.indexOf("direct")}get isSendFromSelf(){return this.from===Ot.peerContext.userId||this.originFrom===Ot.peerContext.userId||-1<this.tags.indexOf("mine")}get isRelatedToMe(){return-1<this.sendTo.indexOf(Ot.peerContext.userId)||this.isSendFromSelf||this.isGMMode}get isDisplayable(){return!this.isDirect||this.isRelatedToMe}get isSystem(){return-1<this.tags.indexOf("system")}get isDicebot(){return this.isSystem&&this.from.indexOf("Dice")>=0&&!/^C\(.+\) \u2192/i.test(this.text)}get isCalculate(){return this.isSystem&&this.from.indexOf("Dice")>=0&&/^C\(.+\) \u2192/i.test(this.text)}get isSecret(){return-1<this.tags.indexOf("secret")}get isEmptyDice(){return!this.isDicebot||-1<this.tags.indexOf("empty")}get isSpecialColor(){return this.isDirect||this.isSecret||this.isSystem||this.isOperationLog||this.isDicebot||this.isCalculate}get isEditable(){return!this.isSystem&&!this.isOperationLog&&this.from===Ot.peerContext.userId}get isFaceIcon(){return!this.isSystem&&(!this.characterIdentifier||this.tags.indexOf("noface")<0)}get isOperationLog(){return-1<this.tags.indexOf("opelog")}get isSuccess(){return this.isDicebot&&-1<this.tags.indexOf("success")}get isFailure(){return this.isDicebot&&-1<this.tags.indexOf("failure")}get isCritical(){return this.isDicebot&&-1<this.tags.indexOf("critical")}get isFumble(){return this.isDicebot&&-1<this.tags.indexOf("fumble")}get isGMMode(){return!!Qe.myCursor&&Qe.myCursor.isGMMode}plainText(){if(this.isSecret&&!this.isSendFromSelf)return"\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09";let n=pt.rubyToText(this.text);return this.isDicebot&&(n=n.replace(/###(.+?)###/g,"*$1").replace(/\~\~\~(.+?)\~\~\~/g,"~$1")),n}logFragment(n,e=null,i="HH:mm",r=!0){return 0==n?this.logFragmentText(e,i):this.logFragmentHtml(e,i,2!=n)}logFragmentText(n=null,e="HH:mm"){n=n&&""!=n.trim()?`[${n}] `:"";const i=""==e?"":Kd(new Date(this.timestamp),e,this.locale)+"\uff1a",r=this.isEdited?""==e?" (\u7de8\u96c6\u6e08)":` (\u7de8\u96c6\u6e08 ${Kd(new Date(this.lastUpdate),e,this.locale)})`:"";let o=pt.rubyToText(this.text);return this.isDicebot&&(o=o.replace(/###(.+?)###/g,"*$1").replace(/\~\~\~(.+?)\~\~\~/g,"~$1")),o.lastIndexOf("\n")==o.length-1&&!r&&(o+="\n"),`${n}${i}${this.name}${this.toColor?" \u27a1 "+this.toName:""}\uff1a${this.isSecret&&!this.isSendFromSelf?"\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09":o+r}`}logFragmentHtml(n=null,e="HH:mm",i=!0){const r=pt.escapeHtml(this.color?this.color:Qe.CHAT_DEFAULT_COLOR),o=` style="color: ${r}"`,s=this.toColor?pt.escapeHtml(this.toColor):"",a=this.toColor?` style="color: ${s}"`:"",h=this.isDirect||this.isSecret?' class="grow"':"",b=n&&""!=n.trim()?`<span class="tab-name">${pt.escapeHtml(n)}</span> `:"",ee=new Date(this.timestamp),de=""==e?"":`<time datetime="${ee.toISOString()}">${pt.escapeHtml(Kd(ee,e,this.locale))}</time>\uff1a`,ge=`<span${h}${o}>${pt.escapeHtml(this.name)}</span>`+(this.toColor?` \u27a1 <span${h}${a}>${pt.escapeHtml(this.toName)}</span>`:"");let xe=["message"];(this.isDirect||this.isSecret)&&xe.push("direct-message"),this.isSystem&&xe.push("system-message"),(this.isDicebot||this.isCalculate)&&xe.push("dicebot-message"),this.isOperationLog&&xe.push("operation-log");let ke=["msg-text"];(!this.isSecret||this.isSendFromSelf)&&(this.isSuccess&&ke.push("is-success"),this.isFailure&&ke.push("is-failure"),this.isCritical&&ke.push("is-critical"),this.isFumble&&ke.push("is-fumble"));let Pe=this.isSecret&&!this.isSendFromSelf?"<s>\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09</s>":mS.link(this.isOperationLog?pt.escapeHtml(this.text):pt.rubyToHtml(pt.escapeHtml(this.text)),{urls:{schemeMatches:!0,wwwMatches:!0,tldMatches:!1},truncate:{length:96,location:"end"},decodePercentEncoding:!1,stripPrefix:!1,stripTrailingSlash:!1,email:!1,phone:!1,className:"outer-link",replaceFn:function(je){return"url"==je.getType()&&pt.validUrl(je.getAnchorHref())}});this.isDicebot&&(Pe=yv.decorationDiceResult(Pe));let Oe="";if(this.isEdited)if(""==e)Oe='<span class="is-edited">\u7de8\u96c6\u6e08</span>';else{const je=new Date(this.lastUpdate);Oe=`<span class="is-edited"><b>\u7de8\u96c6\u6e08</b> <time datetime="${je.toISOString()}">${pt.escapeHtml(Kd(je,e,this.locale))}</time></span>`}return Pe.lastIndexOf("\n")==Pe.length-1&&!Oe&&(Pe+="\n"),`<div class="${xe.join(" ")}" style="border-left-color: ${r}">\n  <div class="msg-header">${b}${de}<span class="msg-name">${ge}</span>\uff1a</div>\n  <div class="${ke.join(" ")}"><span${this.isSpecialColor?"":o}>${Pe}</span>${Oe}</div>\n</div>`}static logCss(n=!0){return"body {\n  color: #444;\n  background-color: #FFF;\n}\n.message {\n  display: flex;\n  width: 100%;\n  word-wrap: break-word;\n  overflow-wrap: anywhere;\n  word-break: break-word;\n  border-left: 4px solid transparent;\n  margin-top: 1px;\n}\n.direct-message {\n  background-color: #555;\n  color: #CCC;\n}\n.dicebot-message .msg-text {\n  color: #11F;\n}\n.direct-message.dicebot-message .msg-text {\n  color: #CCF;\n}\n.dicebot-message .msg-text.is-success {\n  color: #17f;\n}\n.dicebot-message .msg-text.is-failure {\n  color: #F05;\n}\n.direct-message.dicebot-message .msg-text.is-success {\n  color: #adF;\n}\n.direct-message.dicebot-message .msg-text.is-failure {\n  color: #F66;\n}\n.operation-log {\n  color: #666;\n  background-color: #CCCCCCAA;\n}\n.dicebot-message .msg-name,\n.dicebot-message .msg-text,\n.operation-log .msg-name,\n.operation-log .msg-text {\n  font-style: oblique;\n}\n.tab-name {\n  display: inline-block;\n}\n.tab-name::before {\n  content: '[';\n}\n.tab-name::after {\n  content: ']';\n}\n.msg-header {\n  white-space: nowrap;\n  border-left: 1px solid #FFF;\n  padding-left: 2px;\n}\n.msg-name {\n  font-weight: bolder;\n}\n.msg-text {\n  white-space: pre-wrap;\n  width: 100%\n}\n.is-edited {\n  margin-left: 2px;\n  font-size: 8px;\n}\n.is-edited::before {\n  content: '(';\n}\n.is-edited::after {\n  content: ')';\n}\na[target=_blank] {\n  text-decoration: none;\n  word-break: break-all;\n}\na[target=_blank]:hover {\n  text-decoration: underline;\n}\na.outer-link::after {\n  margin-right: 2px;\n  margin-left: 2px;\n  font-family: 'Material Icons';\n  content: '\\e89e';\n  font-weight: bolder;\n  text-decoration: none;\n  display: inline-block;\n  font-size: smaller;\n  vertical-align: 25%;\n}\n.direct-message a[href] {\n  color: #CCF;\n}\n.direct-message a[href]:visited {\n  color: #99D;\n}\nruby {\n  ruby-align: space-between;\n}\ns.drop-dice .dropped {\n  color: #999;\n}\n.grow {\n  text-shadow: \n       1px  0px 1px #ffffff,\n       0px  1px 1px #ffffff,\n      -1px  0px 1px #ffffff,\n       0px -1px 1px #ffffff; \n}"}static decorationDiceResult(n){return n.replace(/###(.+?)###/g,'<b class="special-dice">$1</b>').replace(/\~\~\~(.+?)\~\~\~/g,'<s class="drop-dice"><span class="dropped">$1</span></s>')}};$e([bt()],di.prototype,"originFrom",void 0),$e([bt()],di.prototype,"from",void 0),$e([bt()],di.prototype,"to",void 0),$e([bt()],di.prototype,"name",void 0),$e([bt()],di.prototype,"toName",void 0),$e([bt()],di.prototype,"tag",void 0),$e([bt()],di.prototype,"dicebot",void 0),$e([bt()],di.prototype,"imageIdentifier",void 0),$e([bt()],di.prototype,"toImageIdentifier",void 0),$e([bt()],di.prototype,"color",void 0),$e([bt()],di.prototype,"toColor",void 0),$e([bt()],di.prototype,"isInverseIcon",void 0),$e([bt()],di.prototype,"isHollowIcon",void 0),$e([bt()],di.prototype,"isBlackPaint",void 0),$e([bt()],di.prototype,"aura",void 0),$e([bt()],di.prototype,"characterIdentifier",void 0),$e([bt()],di.prototype,"standIdentifier",void 0),$e([bt()],di.prototype,"standName",void 0),$e([bt()],di.prototype,"isUseStandImage",void 0),$e([bt()],di.prototype,"lastUpdate",void 0),di=yv=$e([mi("chat")],di);let bl=class extends ni{constructor(){super(...arguments),this.name="\u30bf\u30d6",this.isUseStandImage=!0,this.recieveOperationLogLevel=0,this._unreadLength=0}get chatMessages(){return this.children}get unreadLength(){return this._unreadLength}get hasUnread(){return 0<this.unreadLength}get latestTimeStamp(){let n=this.chatMessages.length-1;return n<0?0:this.chatMessages[n].timestamp}onChildAdded(n){super.onChildAdded(n),n.parent===this&&n instanceof di&&n.isDisplayable&&(this._unreadLength++,Ue.trigger("MESSAGE_ADDED",{tabIdentifier:this.identifier,messageIdentifier:n.identifier}),!n.isSendFromSelf&&!n.isOperationLog&&!n.isSystem&&Ue.trigger("MESSAGE_NORTIFICATION",{tabIdentifier:this.identifier,messageIdentifier:n.identifier}))}addMessage(n){n.tabIdentifier=this.identifier;let e=new di;for(let i in n)if("identifier"!==i&&"tabIdentifier"!==i){if("text"===i){e.value=n[i];continue}null==n[i]||""===n[i]||e.setAttribute(i,n[i])}return e.initialize(),Ue.trigger("SEND_MESSAGE",{tabIdentifier:this.identifier,messageIdentifier:e.identifier}),this.appendChild(e),e}markForRead(){this._unreadLength=0}innerXml(){let n="";for(let e of this.children)e instanceof di&&!e.isDisplayable||(n+=gi.instance.toXml(e));return n}parseInnerXml(n){return super.parseInnerXml(n)}log(n,e,i=!0){const r=this.chatMessages.filter(o=>o.isDisplayable&&(i||!o.isOperationLog)).sort((o,s)=>o.index-s.index).map(o=>o.logFragment(n,null,e)).join("\n");return 0==n?r:`<!DOCTYPE html>\n<html lang="ja-JP">\n<head>\n<meta charset="UTF-8">\n<title>Udonarium with Fly\uff1a\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0\uff1a${pt.escapeHtml(""==this.name?"(\u7121\u540d\u306e\u30bf\u30d6)":this.name)}</title>\n<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">\n<style>\n${di.logCss()}\n</style>\n</head>\n<body>\n${r}\n</body>\n</html>`}};var ds;$e([bt()],bl.prototype,"name",void 0),$e([bt()],bl.prototype,"isUseStandImage",void 0),$e([bt()],bl.prototype,"recieveOperationLogLevel",void 0),bl=$e([mi("chat-tab")],bl);let Fs=ds=class extends ni{static get instance(){return ds._instance||(ds._instance=new ds("ChatTabList"),ds._instance.initialize()),ds._instance}get chatTabs(){return this.children}addChatTab(...n){let e=null;if(n[0]instanceof bl)e=n[0];else{let i=n[0];e=new bl(n[1]),e.name=i,e.initialize()}return this.appendChild(e)}parseInnerXml(n){for(let i of ds.instance.children)i.destroy();let e=ds.instance.toContext();e.syncData=this.toContext().syncData,ds.instance.apply(e),ds.instance.update(),super.parseInnerXml.apply(ds.instance,[n]),this.destroy()}log(n,e,i=!0){if(!this.chatTabs)return"";const r=this.chatTabs.reduce((o,s)=>(s&&o.push(...s.chatMessages.filter(a=>a.isDisplayable&&(i||!a.isOperationLog)).map(a=>({index:a.index,tabName:s.name,chatMessage:a}))),o),[]).sort((o,s)=>o.index-s.index).map(o=>o.chatMessage.logFragment(n,o.tabName,e)).join("\n");return 0==n?r:`<!DOCTYPE html>\n<html lang="ja-JP">\n<head>\n<meta charset="UTF-8">\n<title>Udonarium with Fly\uff1a\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0\uff1a\u5168\u3066\u306e\u30bf\u30d6</title>\n<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">\n<style>\n${di.logCss()}\n</style>\n</head>\n<body>\n${r}\n</body>\n</html>`}};Fs=ds=$e([mi("chat-tab-list")],Fs);let Hr=(()=>{class t{constructor(){this.intervalTimer=null,this.timeOffset=Date.now(),this.performanceOffset=performance.now(),this.ntpApiUrls=["https://worldtimeapi.org/api/ip"],this.gameType=""}get chatTabs(){return Fs.instance.chatTabs}calibrateTimeOffset(){if(null!=this.intervalTimer)return void console.log("calibrateTimeOffset was canceled.");let e=Math.floor(Math.random()*this.ntpApiUrls.length),i=this.ntpApiUrls[e],r=performance.now();fetch(i).then(o=>{if(o.ok)return o.json();throw new Error("Network response was not ok.")}).then(o=>{let s=performance.now(),a=(s-r)/2,b=new Date(o.utc_datetime).getTime();this.timeOffset=b+a,this.performanceOffset=s,console.log("latency: "+a+"ms"),console.log("st: "+b),console.log("timeOffset: "+this.timeOffset),console.log("performanceOffset: "+this.performanceOffset),this.setIntervalTimer()}).catch(o=>{console.warn("There has been a problem with your fetch operation: ",o.message),this.setIntervalTimer()}),this.setIntervalTimer()}setIntervalTimer(){null!=this.intervalTimer&&clearTimeout(this.intervalTimer),this.intervalTimer=setTimeout(()=>{this.intervalTimer=null,this.calibrateTimeOffset()},216e5)}getTime(){return Math.floor(this.timeOffset+(performance.now()-this.performanceOffset))}sendMessage(e,i,r,o,s,a,h,b,ee,de,ge,xe,ke,Pe,Oe){let je=!(ge&&this.findFaceIconIdentifier(o)),qe={from:Ot.peerContext.userId,to:t.findId(s),name:this.findObjectName(o),toName:s?this.findObjectName(s):"",imageIdentifier:this.findImageIdentifier(o,ge),toImageIdentifier:s?this.findImageIdentifier(s):"",timestamp:this.calcTimeStamp(e),tag:je?`${r} noface`:r,text:pt.cr(i),color:a,toColor:s?this.findObjectColor(s):"",isInverseIcon:je&&h?1:0,isHollowIcon:je&&b?1:0,isBlackPaint:je&&ee?1:0,aura:je?de:-1,characterIdentifier:xe,standIdentifier:ke,standName:Pe,isUseStandImage:Oe};return e.addMessage(qe)}sendOperationLog(e,i=1){for(const r of this.chatTabs){if(r.recieveOperationLogLevel<i)continue;let o={from:Ot.peerContext.userId,name:Qe.myCursor.name,imageIdentifier:Qe.myCursor.imageIdentifier,timestamp:this.calcTimeStamp(r),tag:"opelog",text:pt.cr(e),color:Qe.myCursor.color};r.addMessage(o)}}static findId(e){let i=Ct.instance.get(e);return i instanceof sn?i.identifier:i instanceof Qe?i.userId:null}findObjectName(e){let i=Ct.instance.get(e);return i instanceof sn?i.name&&i.name.length?i.name:"\uff08\u7121\u540d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\uff09":i instanceof Qe?i.name&&i.name.length?i.name:"\uff08\u7121\u540d\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\uff09":e}findObjectColor(e){let i=Ct.instance.get(e);return i instanceof sn?i.chatPalette.color:i instanceof Qe?i.color:null}makeMessageName(e,i){let r=this.findObjectName(e);return null==i||i.length<1?r:r+" \u27a1 "+this.findObjectName(i)}findImageIdentifier(e,i=!1){let r=Ct.instance.get(e);return r instanceof sn?i&&r.faceIcon&&0<r.faceIcon.url.length?r.faceIcon.identifier:r.imageFile?r.imageFile.identifier:"":r instanceof Qe?r.imageIdentifier:e}findFaceIconIdentifier(e){let i=Ct.instance.get(e);return i instanceof sn&&i.faceIcon&&0<i.faceIcon.url.length?i.faceIcon.identifier:""}calcTimeStamp(e){let i=this.getTime(),r=e.latestTimeStamp;return i<=r?r+1:i}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=$n({token:t,factory:t.\u0275fac}),t})();const mU=["chatInput"],_U=["chatPlette"];function $U(t,n){1&t&&(Q(0,"i",13),ve(1,"how_to_reg"),ne())}function vU(t,n){1&t&&(Q(0,"i",13),ve(1,"history_edu"),ne())}function bU(t,n){1&t&&mt(0,"badge",14),2&t&&oe("count",me().$implicit.unreadLength)}function yU(t,n){if(1&t){const e=ft();Q(0,"label")(1,"input",10),Ae("ngModelChange",function(r){return Re(e),Le(me().chatTabidentifier=r)}),ne(),Q(2,"div")(3,"span"),ve(4),ne(),Te(5,$U,2,0,"i",11),Te(6,vU,2,0,"i",11),Te(7,bU,1,1,"badge",12),ne()()}if(2&t){const e=n.$implicit,i=me();G(1),xt("value",e.identifier),oe("ngModel",i.chatTabidentifier),G(2),ut("cursor",i.chatTabidentifier!=e.identifier?"pointer":"")("color",""==e.name&&i.chatTabidentifier!=e.identifier?"gray":""),G(1),lt(""==e.name?"(\u7121\u540d\u306e\u30bf\u30d6)":e.name),G(1),oe("ngIf",e.isUseStandImage),G(1),oe("ngIf",e.recieveOperationLogLevel>0),G(1),oe("ngIf",e.hasUnread)}}function CU(t,n){1&t&&(Q(0,"div",15)(1,"i",16),ve(2,"info_outline"),ne(),ve(3," \u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u7de8\u96c6\u4e2d\u3067\u3059"),ne())}function wU(t,n){if(1&t&&(Q(0,"option",21),ve(1),ne()),2&t){const e=me().$implicit;ut("color",me(3).color),xt("value",e),G(1),lt(e)}}function xU(t,n){if(1&t&&(it(0),Te(1,wU,2,4,"option",20),rt()),2&t){const e=n.$implicit,i=me(3);G(1),oe("ngIf",i.filter(e))}}function EU(t,n){if(1&t&&(it(0),Te(1,xU,2,1,"ng-container",3),rt()),2&t){const e=me(2);G(1),oe("ngForOf",e.palette.getPalette())}}function TU(t,n){if(1&t){const e=ft();Q(0,"div",17)(1,"select",18,19),Ae("input",function(r){return Re(e),Le(me().selectPalette(r.target.value))})("click",function(r){return Re(e),Le(me().clickPalette(r.target.value))}),Te(3,EU,2,1,"ng-container",9),ne()()}if(2&t){const e=me();G(3),oe("ngIf",e.palette)}}function SU(t,n){if(1&t){const e=ft();Q(0,"div",17)(1,"textarea",22),Ae("ngModelChange",function(r){return Re(e),Le(me().editPalette=r)}),ne()()}if(2&t){const e=me();G(1),oe("ngModel",e.editPalette)}}function IU(t,n){1&t&&(Q(0,"span"),ve(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u7de8\u96c6"),ne())}function MU(t,n){1&t&&(Q(0,"span"),ve(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u78ba\u5b9a"),ne())}let Lu=(()=>{class t{constructor(e,i){this.chatMessageService=e,this.panelService=i,this.character=null,this._gameType="",this.chatTabidentifier="",this.text="",this.sendTo="",this.isEdit=!1,this.editPalette="",this.filterText="",this.doubleClickTimer=null,this.selectedPaletteIndex=-1}get palette(){return this.character.chatPalette}get color(){return this.chatInputComponent.color}get gameType(){return this._gameType?this._gameType:"DiceBot"}set gameType(e){this._gameType=e,this.character.chatPalette&&(this.character.chatPalette.dicebot=e)}get sendFrom(){return this.character.identifier}set sendFrom(e){this.onSelectedCharacter(e)}get diceBotInfos(){return ii.diceBotInfos}get chatTab(){return Ct.instance.get(this.chatTabidentifier)}get myPeer(){return Qe.myCursor}get otherPeers(){return Ct.instance.getObjects(Qe)}ngOnInit(){Promise.resolve().then(()=>this.updatePanelTitle()),this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"",this.gameType=this.character.chatPalette?this.character.chatPalette.dicebot:"",Ue.register(this).on("DELETE_GAME_OBJECT",e=>{this.character&&this.character.identifier===e.data.identifier&&this.panelService.close(),this.chatTabidentifier===e.data.identifier&&(this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"")})}ngOnDestroy(){Ue.unregister(this),this.isEdit&&this.toggleEditMode()}updatePanelTitle(){this.panelService.title=this.character.name+" \u306e\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8"}onSelectedCharacter(e){this.isEdit&&this.toggleEditMode();let i=Ct.instance.get(e);if(i instanceof sn){this.character=i;let r=this.character.chatPalette?this.character.chatPalette.dicebot:"";0<r.length&&(this.gameType=r)}this.updatePanelTitle()}selectPalette(e){this.text=e}clickPalette(e){if(!this.chatPletteElementRef.nativeElement)return;const i=this.palette.evaluate(e,this.character.rootDataElement);this.doubleClickTimer&&this.selectedPaletteIndex===this.chatPletteElementRef.nativeElement.selectedIndex?(clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.chatInputComponent.sendChat(null)):(this.selectedPaletteIndex=this.chatPletteElementRef.nativeElement.selectedIndex,this.text=i,this.chatInputComponent.textAreaElementRef.nativeElement.value=this.text,this.doubleClickTimer=setTimeout(()=>{this.doubleClickTimer=null},400))}sendChat(e){if(this.chatTab){let i=this.palette.evaluate(e.text,this.character.rootDataElement);this.chatMessageService.sendMessage(this.chatTab,i,e.gameType,e.sendFrom,e.sendTo,e.color,e.isInverse,e.isHollow,e.isBlackPaint,e.aura,e.isUseFaceIcon,e.characterIdentifier,e.standIdentifier,e.standName,e.isUseStandImage),this.filterText=""}}resetPletteSelect(){!this.chatPletteElementRef.nativeElement||(this.chatPletteElementRef.nativeElement.selectedIndex=-1)}toggleEditMode(){this.isEdit=!this.isEdit,this.isEdit?this.editPalette=this.palette.value+"":this.palette.setPalette(this.editPalette)}filter(e){return null==this.filterText||""==this.filterText.trim()||e.search(this.filterText)>=0}}return t.\u0275fac=function(e){return new(e||t)(He(Hr),He(qn))},t.\u0275cmp=fn({type:t,selectors:[["chat-palette"]],viewQuery:function(e,i){if(1&e&&(wn(mU,7),wn(_U,5)),2&e){let r;Cn(r=xn())&&(i.chatInputComponent=r.first),Cn(r=xn())&&(i.chatPletteElementRef=r.first)}},inputs:{character:"character"},decls:14,vars:11,consts:[[1,"flex-container"],[2,"flex-grow","0"],[1,"chat-tab"],[4,"ngFor","ngForOf"],[3,"onlyCharacters","chatTabidentifier","gameType","sendFrom","text","gameTypeChange","sendFromChange","textChange","chat"],["chatInput",""],["class","edit-info",4,"ngIf"],["style","flex-grow: 1; height: 0; min-height: 100px;",4,"ngIf"],["type","submit",3,"click"],[4,"ngIf"],["name","chat-tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],["class","material-icons small-font",4,"ngIf"],["class","badge",3,"count",4,"ngIf"],[1,"material-icons","small-font"],[1,"badge",3,"count"],[1,"edit-info"],[1,"material-icons",2,"vertical-align","bottom","size","0.8rem"],[2,"flex-grow","1","height","0","min-height","100px"],["size","5",1,"palette",2,"overflow-y","auto",3,"input","click"],["chatPlette",""],[3,"value","color",4,"ngIf"],[3,"value"],["placeholder","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8",1,"palette",2,"resize","none",3,"ngModel","ngModelChange"]],template:function(e,i){1&e&&(Q(0,"div",0)(1,"div",1)(2,"form")(3,"div",2),Te(4,yU,8,10,"label",3),ne()(),Q(5,"chat-input",4,5),Ae("gameTypeChange",function(o){return i.gameType=o})("sendFromChange",function(o){return i.sendFrom=o})("textChange",function(o){return i.text=o})("chat",function(o){return i.sendChat(o)}),ne(),Te(7,CU,4,0,"div",6),ne(),Te(8,TU,4,1,"div",7),Te(9,SU,2,1,"div",7),Q(10,"div",1)(11,"button",8),Ae("click",function(){return i.toggleEditMode()}),Te(12,IU,2,0,"span",9),Te(13,MU,2,0,"span",9),ne()()()),2&e&&(G(4),oe("ngForOf",i.chatMessageService.chatTabs),G(1),oe("onlyCharacters",!0)("chatTabidentifier",i.chatTabidentifier)("gameType",i.gameType)("sendFrom",i.sendFrom)("text",i.text),G(2),oe("ngIf",i.isEdit),G(1),oe("ngIf",!i.isEdit),G(1),oe("ngIf",i.isEdit),G(3),oe("ngIf",!i.isEdit),G(1),oe("ngIf",i.isEdit))},styles:["[_nghost-%COMP%]{display:block;height:100%}.edit-info[_ngcontent-%COMP%]{width:100%;text-align:center;color:#ccc;background-color:#1e1e1ecc}.palette[_ngcontent-%COMP%]{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;width:100%;height:100%}.flex-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.chat-tab[_ngcontent-%COMP%]{padding:0 5px 5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:8px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:top;font-size:.6rem}"]}),t})();function kU(t,n){if(1&t&&(Q(0,"div",11),ve(1),ne()),2&t){const e=me(2);G(1),lt(e.isSpeaking?"\u{1f603}":"\u{1f910}")}}const DU=function(t){return{transform:t}},AU=function(t){return{inverse:t}},PU=function(t,n,e,i,r,o,s,a){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}},NU=function(t,n){return{"black-paint":t,hollow:n}};function OU(t,n){if(1&t){const e=ft();it(0),Q(1,"div")(2,"div",5)(3,"div",6)(4,"span",7)(5,"img",8),Ae("dblclick",function(){return Re(e),Le(me().openModal())}),Lt(6,"safe"),ne()()()(),Q(7,"button",9),Ae("click",function(){return Re(e),Le(me().openModal())}),Q(8,"b"),ve(9),ne()(),Te(10,kU,2,1,"div",10),ne(),rt()}if(2&t){const e=me();G(2),oe("ngStyle",wt(10,DU,e.isApplyRoll?"rotate("+e.gameCharacter.roll+"deg)":"")),G(1),oe("ngClass",wt(12,AU,e.isApplyImageEffect&&e.gameCharacter.isInverse)),G(1),oe("ngClass",Ms(14,PU,e.isApplyImageEffect&&0==e.gameCharacter.aura,e.isApplyImageEffect&&1==e.gameCharacter.aura,e.isApplyImageEffect&&2==e.gameCharacter.aura,e.isApplyImageEffect&&3==e.gameCharacter.aura,e.isApplyImageEffect&&4==e.gameCharacter.aura,e.isApplyImageEffect&&5==e.gameCharacter.aura,e.isApplyImageEffect&&6==e.gameCharacter.aura,e.isApplyImageEffect&&7==e.gameCharacter.aura)),G(1),oe("src",Bt(6,7,e.standImage.url,"resourceUrl"),vn)("ngClass",un(23,NU,e.isApplyImageEffect&&e.gameCharacter.isBlackPaint,e.isApplyImageEffect&&e.gameCharacter.isHollow)),G(4),Zn("",e.isSpeakable?"\u901a\u5e38":"","\u753b\u50cf\u5909\u66f4"),G(1),oe("ngIf",e.isSpeakable)}}function FU(t,n){if(1&t){const e=ft();it(0),Q(1,"span",12)(2,"input",13),Ae("ngModelChange",function(r){return Re(e),Le(me().nameElement.value=r)}),ne()(),rt()}if(2&t){const e=me();G(2),oe("ngModel",e.nameElement.value)}}function RU(t,n){if(1&t){const e=ft();it(0),Q(1,"b",12),ve(2,"\u3000Cond: "),ne(),Q(3,"select",14),Ae("ngModelChange",function(r){return Re(e),Le(me().conditionTypeElement.value=r)}),Q(4,"option",15),ve(5,"\u30c7\u30d5\u30a9\u30eb\u30c8"),ne(),Q(6,"option",15),ve(7,"\u6307\u5b9a\u753b\u50cf"),ne(),Q(8,"option",15),ve(9,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e"),ne(),Q(10,"option",15),ve(11,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e \u307e\u305f\u306f \u6307\u5b9a\u753b\u50cf"),ne(),Q(12,"option",15),ve(13,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e \u304b\u3064 \u6307\u5b9a\u753b\u50cf"),ne(),Q(14,"option",15),ve(15,"\u9078\u629e\u6642\u306e\u307f"),ne()(),rt()}if(2&t){const e=me();G(3),oe("ngModel",e.conditionTypeElement.value),G(1),xt("value",e.standConditionType.Default),G(2),xt("value",e.standConditionType.Image),G(2),xt("value",e.standConditionType.Postfix),G(2),xt("value",e.standConditionType.PostfixOrImage),G(2),xt("value",e.standConditionType.PostfixAndImage),G(2),xt("value",e.standConditionType.NotConditionStandUp)}}function LU(t,n){if(1&t){const e=ft();it(0),Q(1,"span",12)(2,"b",16),ve(3,"Tag: "),ne(),Q(4,"input",17),Ae("ngModelChange",function(r){return Re(e),Le(me().nameElement.currentValue=r)}),ne()(),rt()}if(2&t){const e=me();G(4),oe("ngModel",e.nameElement.currentValue)}}function BU(t,n){if(1&t){const e=ft();it(0),Q(1,"label",18)(2,"input",19),Ae("ngModelChange",function(r){return Re(e),Le(me().showNameElement.value=r)})("change",function(){Re(e);const r=me();return Le(r.showNameElement.value=r.showNameElement.value?"showName":"")}),ne(),Q(3,"b",12),ve(4,"\u30cd\u30fc\u30e0\u30bf\u30b0"),ne()(),rt()}if(2&t){const e=me();G(2),xt("checked",e.showNameElement.value?"checked":""),oe("ngModel",e.showNameElement.value)}}function zU(t,n){if(1&t){const e=ft();it(0),Q(1,"label",18)(2,"input",19),Ae("ngModelChange",function(r){return Re(e),Le(me().applyImageEffectElement.value=r)})("change",function(){Re(e);const r=me();return Le(r.applyImageEffectElement.value=r.applyImageEffectElement.value?"applyImageEffect":"")}),ne(),Q(3,"b",12),ve(4,"\u753b\u50cf\u52b9\u679c\u53cd\u6620"),ne()(),rt()}if(2&t){const e=me();G(2),xt("checked",e.applyImageEffectElement.value?"checked":""),oe("ngModel",e.applyImageEffectElement.value)}}function jU(t,n){if(1&t){const e=ft();it(0),Q(1,"label",18)(2,"input",19),Ae("ngModelChange",function(r){return Re(e),Le(me().applyRollElement.value=r)})("change",function(){Re(e);const r=me();return Le(r.applyRollElement.value=r.applyRollElement.value?"applyRoll":"")}),ne(),Q(3,"b",12),ve(4,"\u56de\u8ee2\u53cd\u6620"),ne()(),rt()}if(2&t){const e=me();G(2),xt("checked",e.applyRollElement.value?"checked":""),oe("ngModel",e.applyRollElement.value)}}function UU(t,n){if(1&t){const e=ft();it(0),Q(1,"label",20)(2,"input",19),Ae("ngModelChange",function(r){return Re(e),Le(me().applyDialogElement.value=r)})("change",function(){Re(e);const r=me();return Le(r.applyDialogElement.value=r.applyDialogElement.value?"applyDialog":"")}),ne(),Q(3,"b",12),ve(4,"\u{1f4ad}"),ne()(),rt()}if(2&t){const e=me();G(2),xt("checked",e.applyDialogElement.value?"checked":""),oe("ngModel",e.applyDialogElement.value)}}const HU=function(t){return{"disabled-text":t}};function VU(t,n){if(1&t){const e=ft();it(0),mt(1,"br"),Q(2,"button",21),Ae("click",function(){return Re(e),Le(me().testStandUp())}),Q(3,"b"),ve(4,"\u30c6\u30b9\u30c8 (\u81ea\u5206\u3060\u3051\u898b\u308b)"),Q(5,"sup",22),ve(6,"*"),ne()()(),Q(7,"label",23)(8,"input",19),Ae("ngModelChange",function(r){return Re(e),Le(me().positionElement.currentValue=r)})("change",function(){Re(e);const r=me();return Le(r.positionElement.currentValue=r.positionElement.currentValue?"posSpecialize":"")}),ne(),Q(9,"b",12),ve(10,"Pos\u500b\u5225\u6307\u5b9a: "),ne()(),Q(11,"span",24)(12,"input",25),Ae("ngModelChange",function(r){return Re(e),Le(me().positionElement.value=r)}),ne(),Q(13,"input",26),Ae("ngModelChange",function(r){return Re(e),Le(me().positionElement.value=r)}),ne(),Q(14,"b",27),ve(15,"%"),ne()(),rt()}if(2&t){const e=me();G(8),xt("checked",e.positionElement.currentValue?"checked":""),oe("ngModel",e.positionElement.currentValue),G(4),oe("ngModel",e.positionElement.value)("disabled",!e.positionElement.currentValue),G(1),oe("ngModel",e.positionElement.value)("disabled",!e.positionElement.currentValue),G(1),oe("ngClass",wt(7,HU,!e.positionElement.currentValue))}}function GU(t,n){if(1&t){const e=ft();it(0),mt(1,"br"),Q(2,"span",24)(3,"b",28),ve(4,"Height (0=\u6307\u5b9a\u306a\u3057): "),ne(),Q(5,"input",29),Ae("ngModelChange",function(r){return Re(e),Le(me().heightElement.value=r)}),ne(),Q(6,"input",30),Ae("ngModelChange",function(r){return Re(e),Le(me().heightElement.value=r)}),ne(),Q(7,"b",31),ve(8,"%"),ne()(),Q(9,"span",32)(10,"b",28),ve(11,"AdjY: "),ne(),Q(12,"input",33),Ae("ngModelChange",function(r){return Re(e),Le(me().heightElement.currentValue=r)}),ne(),Q(13,"b",31),ve(14,"%"),ne()(),rt()}if(2&t){const e=me();G(5),oe("ngModel",e.heightElement.value),G(1),oe("ngModel",e.heightElement.value),G(6),oe("ngModel",e.heightElement.currentValue)}}function qU(t,n){if(1&t){const e=ft();Q(0,"div")(1,"textarea",34),Ae("ngModelChange",function(r){return Re(e),Le(me().postfixElement.value=r)}),ne()()}if(2&t){const e=me();G(1),oe("ngModel",e.postfixElement.value)}}const WU=function(t){return{"current-icon":t}};function KU(t,n){if(1&t){const e=ft();Q(0,"div",39)(1,"img",40),Ae("click",function(){Re(e);const r=me().$implicit;return Le(me(3).selectImage(r.identifier))}),Lt(2,"safe"),ne()()}if(2&t){const e=me().$implicit,i=me(3);oe("ngClass",wt(6,WU,i.isSelectedImage(e.identifier))),G(1),oe("src",Bt(2,3,e.url,"resourceUrl"),vn)("alt",e.name)}}function YU(t,n){if(1&t&&(it(0),Te(1,KU,3,8,"div",38),rt()),2&t){const e=n.$implicit;G(1),oe("ngIf",0<e.url.length)}}function ZU(t,n){if(1&t&&(Q(0,"div",36),Te(1,YU,2,1,"ng-container",37),ne()),2&t){const e=me(2);G(1),oe("ngForOf",e.imageList)}}function XU(t,n){1&t&&(Q(0,"div"),ve(1,"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u753b\u50cf\u3001\u9854IC\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),ne())}function QU(t,n){if(1&t&&(Q(0,"div"),Te(1,ZU,2,1,"div",35),Te(2,XU,2,0,"div",2),ne()),2&t){const e=me();G(1),oe("ngIf",e.imageList&&e.imageList.length>0),G(1),oe("ngIf",!e.imageList||0==e.imageList.length)}}let CS=(()=>{class t{constructor(e){this.modalService=e,this.standElement=null,this.imageList=[],this.gameCharacter=null,this.isSpeaking=!1,this._imageFile=on.Empty,this.standConditionType=Ui}ngOnInit(){}get standImage(){if(!this.standElement)return this._imageFile;let e=null;if(this.isSpeaking&&(e=this.standElement.getFirstElementByName("speakingImageIdentifier"),e||(e=this.standElement.appendChild(St.create("speakingImageIdentifier",on.Empty.identifier,{type:"image"},"speakingImageIdentifier_"+this.standElement.identifier)))),(!e||!e.value||e.value==on.Empty.identifier)&&(e=this.standElement.getFirstElementByName("imageIdentifier")),e){if(this._imageFile.identifier!==e.value){let i=Gt.instance.get(e.value);this._imageFile=i||on.Empty}}else{let i=on.createEmpty("stand_no_image").toContext();i.url="./assets/images/nc96424.png",this._imageFile=Gt.instance.add(i),this.standElement.appendChild(St.create("imageIdentifier",this._imageFile.identifier,{type:"image"},"imageIdentifier_"+this.standElement.identifier))}return this._imageFile}get nameElement(){return this.standElement?this.standElement.getFirstElementByName("name")||this.standElement.appendChild(St.create("name","",{},"name_"+this.standElement.identifier)):null}get heightElement(){return this.standElement?this.standElement.getFirstElementByName("height")||this.standElement.appendChild(St.create("height",0,{currentValue:0},"height_"+this.standElement.identifier)):null}get conditionTypeElement(){return this.standElement?this.standElement.getFirstElementByName("conditionType")||this.standElement.appendChild(St.create("conditionType",Ui.Default,{},"conditionType_"+this.standElement.identifier)):null}get postfixElement(){return this.standElement?this.standElement.getFirstElementByName("postfix")||this.standElement.appendChild(St.create("postfix","",{},"postfix_"+this.standElement.identifier)):null}get applyImageEffectElement(){return this.standElement?this.standElement.getFirstElementByName("applyImageEffect")||this.standElement.appendChild(St.create("applyImageEffect","",{},"applyImageEffect_"+this.standElement.identifier)):null}get applyRollElement(){return this.standElement?this.standElement.getFirstElementByName("applyRoll")||this.standElement.appendChild(St.create("applyRoll","",{},"applyRoll_"+this.standElement.identifier)):null}get applyDialogElement(){return this.standElement?this.standElement.getFirstElementByName("applyDialog")||this.standElement.appendChild(St.create("applyDialog","applyDialog",{},"applyDialog_"+this.standElement.identifier)):null}get showNameElement(){return this.standElement?this.standElement.getFirstElementByName("showName")||this.standElement.appendChild(St.create("showName","showName",{},"showName_"+this.standElement.identifier)):null}get positionElement(){return this.standElement?this.standElement.getFirstElementByName("position")||this.standElement.appendChild(St.create("position",0,{currentValue:""},"position_"+this.standElement.identifier)):null}get isApplyImageEffect(){let e=this.applyImageEffectElement;return!(!e||!e.value)}get isApplyRoll(){let e=this.applyRollElement;return!(!e||!e.value)}get isApplyDialog(){let e=this.applyDialogElement;return!(!e||!e.value)}get isShowName(){let e=this.showNameElement;return!(!e||!e.value)}get isSpeakable(){if(!this.standElement)return!1;const e=this.standElement.getFirstElementByName("speakingImageIdentifier");return e&&e.value&&e.value!==on.Empty.identifier}openModal(e="imageIdentifier",i=!1){if(!this.standElement)return;let r=[],o=this.standElement.getFirstElementByName(e);o?r=[o.value+""]:o=this.standElement.appendChild(St.create(e,"",{type:"image"},e+"_"+this.standElement.identifier)),this.modalService.open(aa,{isAllowedEmpty:i,currentImageIdentifires:r}).then(s=>{!s||(o.value=s)})}openSpeakingModal(){this.openModal("speakingImageIdentifier",!0)}remove(){!this.standElement||this.standElement.parent.removeChild(this.standElement)}selectImage(e){if(!this.standElement)return;let i=!1;for(let r of this.standElement.getElementsByName("targetImageIdentifier")){let o=!0;for(let s of this.imageList)if(s.identifier==r.value){o=!1;break}o?this.standElement.removeChild(r):r.value==e&&(i=!0,this.standElement.removeChild(r))}i||this.standElement.appendChild(St.create("targetImageIdentifier",e,{},"targetImageIdentifier_"+bo.generateUuid()))}isSelectedImage(e){let i=this.standElement.getElementsByName("targetImageIdentifier");for(let r of i)if(r.value==e)return!0;return!1}testStandUp(){Ue.trigger("POPUP_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier,standIdentifier:this.standElement.identifier,color:this.gameCharacter.chatPalette?this.gameCharacter.chatPalette.color:null}),Ue.trigger("POPUP_CHAT_BALLOON",{characterIdentifier:this.gameCharacter.identifier,text:"\u3053\u308c\u306f\u30c6\u30b9\u30c8\u3067\u3059\u3001\u3042\u306a\u305f\u306b\u3060\u3051\u898b\u3048\u3066\u3044\u307e\u3059\u3002\u30b9\u30bf\u30f3\u30c9\u306e\u8a2d\u5b9a\u3092\u884c\u3046\u969b\u306f\u3001\u30e1\u30cb\u30e5\u30fc\u306e\u300c\u500b\u4eba\u8a2d\u5b9a\u300d\u304b\u3089\u300c\u900f\u660e\u5316\u3001\u81ea\u52d5\u9000\u53bb\u300d\u3092\u30aa\u30d5\u306b\u3059\u308b\u3068\u5fae\u8abf\u6574\u304c\u884c\u3044\u3084\u3059\u304f\u306a\u308a\u307e\u3059\u3002",color:this.gameCharacter.chatPalette?this.gameCharacter.chatPalette.color:null,dialogTest:!0})}}return t.\u0275fac=function(e){return new(e||t)(He(Yn))},t.\u0275cmp=fn({type:t,selectors:[["stand-element"]],inputs:{standElement:"standElement",imageList:"imageList",gameCharacter:"gameCharacter",isSpeaking:"isSpeaking"},decls:20,vars:14,consts:[[1,"stand-container"],[1,"stand-image-container"],[4,"ngIf"],[2,"display","flex","flex-direction","column","padding-left","3px","width","100%"],[2,"font-size","9px",3,"click"],[3,"ngStyle"],[1,"inverser",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"stand-image",3,"src","ngClass","dblclick"],[1,"stand-image-button",2,"font-size","smaller","padding","2px 3px",3,"click"],["style","position: absolute; margin-top: -26px; margin-left: 120px; font-size: 22px; filter: grayscale(100%); opacity: 0.5; cursor: default;",4,"ngIf"],[2,"position","absolute","margin-top","-26px","margin-left","120px","font-size","22px","filter","grayscale(100%)","opacity","0.5","cursor","default"],[2,"font-size","smaller"],["type","text","placeholder","Name",2,"width","7em",3,"ngModel","ngModelChange"],[2,"width","15.5em",3,"ngModel","ngModelChange"],[3,"value"],[2,"margin-left","1em"],["type","text","placeholder","Tag",2,"width","3em",3,"ngModel","ngModelChange"],[2,"margin-right","0.6em"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"margin-right","0.2em"],[2,"font-size","9px","margin-right","1em",3,"click"],[1,"self-only"],[2,"margin-right","0.3em"],[2,"white-space","nowrap","font-size","smaller"],["type","range","min","0","max","100",2,"width","140px",3,"ngModel","disabled","ngModelChange"],["type","number","min","0","max","100",2,"width","3em","text-align","right",3,"ngModel","disabled","ngModelChange"],[2,"display","inline-block","font-size","smaller","margin-left","3px",3,"ngClass"],[2,"display","inline-block","margin-left","3px"],["type","range","min","0","max","100",2,"width","130px",3,"ngModel","ngModelChange"],["type","number","min","0","max","200",2,"width","3em","text-align","right",3,"ngModel","ngModelChange"],[2,"display","inline-block","font-size","smaller","margin-left","3px"],[2,"white-space","nowrap","margin-left","0.8em","font-size","smaller"],["type","number","min","-100","max","100",2,"width","3.4em","text-align","right",3,"ngModel","ngModelChange"],["placeholder","1\u884c\u306b\u4e00\u3064\u3001\u5192\u982d@\u3092\u4ed8\u3051\u308b\u3068\u30de\u30c3\u30c1\u6642\u306b\u30c6\u30ad\u30b9\u30c8\u304b\u3089\u5207\u308a\u53d6\u308a\r\n@\u6012\u308a\r\n@\u5fc5\u6bba\u6280",2,"width","100%","margin-top","3px","height","2.4rem",3,"ngModel","ngModelChange"],["style","display: flex; flex-wrap: wrap; margin-right: -30px;",4,"ngIf"],[2,"display","flex","flex-wrap","wrap","margin-right","-30px"],[4,"ngFor","ngForOf"],["class","icon-image-box",3,"ngClass",4,"ngIf"],[1,"icon-image-box",3,"ngClass"],[3,"src","alt","click"]],template:function(e,i){1&e&&(Q(0,"div")(1,"div",0)(2,"div",1),Te(3,OU,11,26,"ng-container",2),ne(),Q(4,"div",3)(5,"div"),Te(6,FU,3,1,"ng-container",2),Te(7,RU,16,7,"ng-container",2),Te(8,LU,5,1,"ng-container",2),ne(),Q(9,"div"),Te(10,BU,5,2,"ng-container",2),Te(11,zU,5,2,"ng-container",2),Te(12,jU,5,2,"ng-container",2),Te(13,UU,5,2,"ng-container",2),Q(14,"button",4),Ae("click",function(){return i.openSpeakingModal()}),ve(15,"\u53e3\u30d1\u30af\u753b\u50cf (APNG\u306a\u3069)"),ne(),Te(16,VU,16,9,"ng-container",2),Te(17,GU,15,3,"ng-container",2),ne(),Te(18,qU,2,1,"div",2),Te(19,QU,3,2,"div",2),ne()()()),2&e&&(G(3),oe("ngIf",i.standImage),G(3),oe("ngIf",i.nameElement),G(1),oe("ngIf",i.conditionTypeElement),G(1),oe("ngIf",i.nameElement),G(2),oe("ngIf",i.showNameElement),G(1),oe("ngIf",i.applyImageEffectElement),G(1),oe("ngIf",i.applyRollElement),G(1),oe("ngIf",i.applyDialogElement),G(1),ut("font-weight",i.isSpeakable?"bolder":"normal"),G(2),oe("ngIf",i.positionElement),G(1),oe("ngIf",i.heightElement),G(1),oe("ngIf",i.postfixElement&&(i.conditionTypeElement.value==i.standConditionType.Postfix||i.conditionTypeElement.value==i.standConditionType.PostfixOrImage||i.conditionTypeElement.value==i.standConditionType.PostfixAndImage)),G(1),oe("ngIf",i.conditionTypeElement.value==i.standConditionType.Image||i.conditionTypeElement.value==i.standConditionType.PostfixOrImage||i.conditionTypeElement.value==i.standConditionType.PostfixAndImage))},dependencies:[si,_i,Bn,fr,oo,so,Ii,Fo,Ro,Oo,$o,Mi,Ys,Ks,yi,$i],styles:[".stand-container[_ngcontent-%COMP%]{display:flex;flex-direction:row}.stand-image-container[_ngcontent-%COMP%]{width:150px;height:150px}.stand-image[_ngcontent-%COMP%]{width:150px;height:150px;-o-object-fit:contain;object-fit:contain;transform-origin:bottom;z-index:5}.stand-image-button[_ngcontent-%COMP%]{display:block;margin-top:-154px;margin-left:-4px;position:relative;z-index:10}.postfix-text[_ngcontent-%COMP%]{width:8em}.position-indicate[_ngcontent-%COMP%]{display:inline-block;font-size:smaller;width:3em}.remove-button[_ngcontent-%COMP%]{font-weight:bolder;color:red;background-color:transparent}.remove-button[_ngcontent-%COMP%]:hover{background-color:#eee}.icon-image-box[_ngcontent-%COMP%]{position:relative;width:50px;height:50px;max-width:50px;max-height:50px;border-radius:.5rem;color:#000;z-index:100;margin-top:1px;margin-bottom:1px;margin-left:2px}.icon-image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:.5rem;border:2px solid transparent}.icon-image-box[_ngcontent-%COMP%]:hover{z-index:600}.icon-image-box[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{border:2px dotted rgba(255,0,0,40)}.icon-image-box.current-icon[_ngcontent-%COMP%]{z-index:500}.icon-image-box.current-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid red}.icon-image-box[_ngcontent-%COMP%]:not(.current-icon){z-index:400}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #fff)}.disabled-text[_ngcontent-%COMP%]{color:gray}.self-only[_ngcontent-%COMP%]{color:red}"]}),t})();function JU(t,n){if(1&t){const e=ft();Q(0,"div",14)(1,"div",15)(2,"div",16)(3,"input",17),Ae("click",function(){const o=Re(e).index;return Le(me().overviewIndex=o)}),ne()(),Q(4,"div",18),mt(5,"stand-element",19,20),ne(),Q(7,"div",21)(8,"button",22),Ae("click",function(){const r=Re(e),o=r.$implicit,s=r.index;return Le(me().delele(o,s))}),ve(9,"\xd7"),ne(),Q(10,"button",23),Ae("click",function(){const o=Re(e).$implicit;return Le(me().upStandIndex(o))}),ve(11,"\u2191"),ne(),Q(12,"button",24),Ae("click",function(){const o=Re(e).$implicit;return Le(me().downStandIndex(o))}),ve(13,"\u2193"),ne()()(),mt(14,"hr"),ne()}if(2&t){const e=n.$implicit,i=n.index,r=me();G(1),ut("border-color",r.overviewIndex==i?"red":"transparent"),G(2),cr("name","",r.panelId,"_overviewIndex"),xt("value",i),oe("checked",r.overviewIndex==i),G(2),oe("standElement",e)("imageList",r.imageList)("gameCharacter",r.character)}}function eH(t,n){if(1&t){const e=ft();Q(0,"button",12),Ae("click",function(){return Re(e),Le(me().restore())}),ve(1,"\u76f4\u524d\u306b\u524a\u9664\u3057\u305f\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u3092\u623b\u3059"),ne()}}let yg=(()=>{class t{constructor(e,i,r){this.panelService=e,this.pointerDeviceService=i,this.modalService=r,this.character=null,this.standSettingXML="",this.isSpeaking=!1}get standElements(){return this.character.standList.standElements}get imageList(){if(!this.character)return[];let e=[],i={};const o=this.character.imageDataElement.getElementsByName("imageIdentifier").concat(this.character.imageDataElement.getElementsByName("faceIcon"));for(let s of o){if(i[s.value])continue;let a=this.imageElementToFile(s);a&&(i[s.value]=!0,e.push(a))}return e}get position(){return this.character&&this.character.standList?this.character.standList.position:0}set position(e){!this.character||!this.character.standList||(this.character.standList.position=e)}get height(){return this.character&&this.character.standList?this.character.standList.height:0}set height(e){!this.character||!this.character.standList||(this.character.standList.height=e)}get overviewIndex(){return this.character&&this.character.standList?this.character.standList.overviewIndex:-1}set overviewIndex(e){!this.character||!this.character.standList||(this.character.standList.overviewIndex=e)}ngOnInit(){Promise.resolve().then(()=>this.updatePanelTitle()),Ue.register(this).on("DELETE_GAME_OBJECT",-1e3,e=>{this.character&&this.character.identifier===e.data.identifier&&this.panelService.close()}),this.panelId=bo.generateUuid()}ngAfterViewInit(){this._intervalId=setInterval(()=>{this.isSpeaking=!this.isSpeaking,this.standElementComponents.forEach(e=>{e.isSpeaking=this.isSpeaking})},3600)}ngOnDestroy(){clearInterval(this._intervalId),Ue.unregister(this)}updatePanelTitle(){this.panelService.title=this.character.name+" \u306e\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a"}add(){this.character.standList.add(this.character.imageFile.identifier),this.standSettingXML=""}delele(e,i){Ue.call("DELETE_STAND_IMAGE",{characterIdentifier:this.character.identifier,identifier:e.identifier}),this.character&&this.character.standList&&this.modalService.open(pr,{title:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u306e\u524a\u9664",text:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u3092\u524a\u9664\u3057\u307e\u3059\u304b\uff1f",type:Li.OK_CANCEL,materialIcon:"person_off",action:()=>{this.standSettingXML=e.toXml(),this.character.standList.removeChild(e)&&(this.character.standList.overviewIndex==i?this.character.standList.overviewIndex=-1:this.character.standList.overviewIndex>i&&(this.character.standList.overviewIndex-=1))}})}restore(){if(!this.standSettingXML)return;let e=gi.instance.parseXml(this.standSettingXML);this.character.standList.appendChild(e),this.standSettingXML=""}upStandIndex(e){this.standSettingXML="";let i=this.character.standList,r=i.children.indexOf(e);0<r&&(i.insertBefore(e,i.children[r-1]),this.character.standList.overviewIndex==r?this.character.standList.overviewIndex-=1:this.character.standList.overviewIndex==r-1&&(this.character.standList.overviewIndex+=1))}downStandIndex(e){this.standSettingXML="";let i=this.character.standList,r=i.children.indexOf(e);r<i.children.length-1&&(i.insertBefore(i.children[r+1],e),this.character.standList.overviewIndex==r?this.character.standList.overviewIndex+=1:this.character.standList.overviewIndex==r+1&&(this.character.standList.overviewIndex-=1))}helpStandSeteing(){let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(Fu,{left:e.x,top:e.y,width:600,height:590});r.title="\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u30d8\u30eb\u30d7",r.text='\u3000\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306e\u30b9\u30bf\u30f3\u30c9\u306e\u540d\u524d\u3001\u4f4d\u7f6e\u3068\u753b\u50cf\u306e\u9ad8\u3055\uff08\u305d\u308c\u305e\u308c\u753b\u9762\u30b5\u30a4\u30ba\u306b\u5bfe\u3059\u308b\u76f8\u5bfe\u6307\u5b9a\uff09\u3001\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u306b\u30b9\u30bf\u30f3\u30c9\u304c\u8868\u793a\u3055\u308c\u308b\u6761\u4ef6\u3092\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\n\n\u3000\u30b9\u30bf\u30f3\u30c9\u306b\u540d\u524d\u3092\u8a2d\u5b9a\u3057\u305f\u5834\u5408\u3001\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3001\u30c1\u30e3\u30c3\u30c8\u30d1\u30cd\u30eb\u306e\u30ea\u30b9\u30c8\u306b\u8868\u793a\u3055\u308c\u3001\u9078\u629e\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\u307e\u305f\u3001\u30bf\u30b0\u3092\u8a2d\u5b9a\u3057\u305f\u5834\u5408\u3001\u7570\u306a\u308b\u30bf\u30b0\u3067\u306f\u540c\u3058\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3067\u3042\u3063\u3066\u3082\u767b\u5834\u3001\u9000\u53bb\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u304c\u884c\u308f\u308c\u307e\u3059\u3002\n\n\u3000\u753b\u50cf\u306e\u4f4d\u7f6e\u3068\u9ad8\u3055\u306f\u500b\u5225\u6307\u5b9a\u3082\u53ef\u80fd\u3067\u3059\u3001\u4f4d\u7f6e\u306e\u500b\u5225\u6307\u5b9a\u306f\u30c1\u30a7\u30c3\u30af\u306a\u3057\u3001\u9ad8\u3055\u306f0\u3068\u3057\u305f\u5834\u5408\u306b\u5168\u4f53\u306e\u8a2d\u5b9a\u304c\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002\u7e26\u4f4d\u7f6e\u8abf\u6574(AdjY)\u306f\u3001\u30b9\u30bf\u30f3\u30c9\u753b\u50cf\u306e\u9ad8\u3055\u306b\u5bfe\u3059\u308b\u76f8\u5bfe\u6307\u5b9a\u3068\u306a\u308a\u307e\u3059\uff08\u4f8b\u3048\u3070\u3001-50%\u3068\u3059\u308b\u3068\u753b\u50cf\u306e\u4e0b\u534a\u5206\u304c\u753b\u9762\u7aef\u3088\u308a\u4e0b\u306b\u96a0\u308c\u307e\u3059\uff09\u3002\n\n\u3000\u6761\u4ef6\u306e\u300c\u6307\u5b9a\u753b\u50cf\u300d\u306f\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u753b\u50cf\u3042\u308b\u3044\u306f\u9854IC\u3067\u3059\u3002\u307e\u305f\u3001\u7279\u5225\u306a\u6761\u4ef6\u3068\u3057\u3066\u5e38\u306b\u3001\u30c1\u30e3\u30c3\u30c8\u30c6\u30ad\u30b9\u30c8\u306e\u672b\u5c3e\u304c"@\u9000\u53bb"\u307e\u305f\u306f"@farewell"\u306e\u5834\u5408\u306f\u3001\u305d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306e\u30b9\u30bf\u30f3\u30c9\u3092\u9000\u53bb\u3055\u305b\u307e\u3059\u3002\n\n\u3000\u512a\u5148\u9806\u4f4d\u306f\u9ad8\u3044\u3082\u306e\u304b\u3089\n\n\u3000\u3000\uff11. "@\u9000\u53bb"\u3001"@farewell"\u306b\u3088\u308b\u9000\u53bb\n\u3000\u3000\uff12. \u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3001\u30c1\u30e3\u30c3\u30c8\u30d1\u30cd\u30eb\u306e\u30ea\u30b9\u30c8\u3067\u9078\u629e\u3057\u305f\u540d\u524d\n\u3000\u3000\uff13. \u300c\u6307\u5b9a\u753b\u50cf \u304b\u3064 \u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u300d\n\u3000\u3000\uff14. \u300c\u6307\u5b9a\u753b\u50cf \u307e\u305f\u306f \u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u300d\n\u3000\u3000\uff15. \u300c\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u300d\n\u3000\u3000\uff16. \u300c\u6307\u5b9a\u753b\u50cf\u300d\n\n\u3000\u3069\u306e\u6761\u4ef6\u3082\u6e80\u305f\u3055\u306a\u3044\u5834\u5408\u300c\u30c7\u30d5\u30a9\u30eb\u30c8\u300d\u306e\u3082\u306e\u304c\u4f7f\u7528\u3055\u308c\u3001\u540c\u3058\u512a\u5148\u9806\u4f4d\u306e\u6761\u4ef6\u304c\u8907\u6570\u3042\u308b\u5834\u5408\u306f\u30e9\u30f3\u30c0\u30e0\u30671\u3064\u304c\u9078\u629e\u3055\u308c\u307e\u3059\u3002\n\n\u3000\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u4e00\u81f4\u3092\u5224\u5b9a\u3059\u308b\u969b\u3001\u5168\u89d2\u534a\u89d2\u3001\u30a2\u30eb\u30d5\u30a1\u3079\u30c3\u30c8\u306e\u5927\u6587\u5b57\u5c0f\u6587\u5b57\u306f\u533a\u5225\u3055\u308c\u307e\u305b\u3093\u3002\n\u3000\u307e\u305f\u3001"@\u9000\u53bb"\u3001"@farewell"\u306b\u3088\u308b\u9000\u53bb\u6642\u3001\u3042\u308b\u3044\u306f"@\u7b11\u3044"\u306e\u3088\u3046\u306b\u5148\u982d\u304c"@"\u3067\u59cb\u307e\u308b\u6761\u4ef6\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u5834\u5408\u3001\uff08\u30b9\u30bf\u30f3\u30c9\u306e\u6709\u52b9\u7121\u52b9\u3001\u6761\u4ef6\u3092\u6e80\u305f\u3059\u304b\u306b\u95a2\u308f\u3089\u305a\uff09\u305d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3067\u306e\u9001\u4fe1\u6642\u306b\u3001\u6761\u4ef6\u306b\u4e00\u81f4\u3059\u308b\u30c1\u30e3\u30c3\u30c8\u30c6\u30ad\u30b9\u30c8\u672b\u5c3e\u306e@\u4ee5\u4e0b\u306f\u5207\u308a\u843d\u3068\u3055\u308c\u307e\u3059\u3002'}imageElementToFile(e){return e?Gt.instance.get(e.value):null}}return t.\u0275fac=function(e){return new(e||t)(He(qn),He(Ci),He(Yn))},t.\u0275cmp=fn({type:t,selectors:[["app-stand-setting"]],viewQuery:function(e,i){if(1&e&&wn(CS,5),2&e){let r;Cn(r=xn())&&(i.standElementComponents=r)}},inputs:{character:"character"},decls:27,vars:10,consts:[[2,"margin-bottom","4px"],[2,"float","right",3,"click"],[1,"position-indicate"],["type","range","min","0","max","100",2,"width","350px",3,"ngModel","ngModelChange"],["type","number","min","0","max","100",2,"width","3em","text-align","right","margin-right","3px",3,"ngModel","ngModelChange"],["sytle","margin-left: 3px; margin-right: 1em "],["type","number","min","0","max","200",2,"width","3em","text-align","right","margin-right","3px",3,"ngModel","ngModelChange"],[1,"overview-selecter",2,"padding","0px","width","695px"],[2,"font-size","smaller","font-weight","bolder"],["type","radio","value","-1",3,"name","checked","click"],[2,"display","flex","flex-direction","row","flex-wrap","wrap"],["style","width: 700px",4,"ngFor","ngForOf"],[3,"click"],[3,"click",4,"ngIf"],[2,"width","700px"],[1,"overview-selecter",2,"display","flex","flex-direction","row","justify-content","space-between"],[2,"display","flex","align-items","center","justify-content","center"],["type","radio",2,"z-index","10",3,"name","value","checked","click"],[2,"margin-left","-1em","margin-right","-1em"],[3,"standElement","imageList","gameCharacter"],["standElementComponent",""],[2,"text-align","right","width","3em"],[1,"remove-button","danger",3,"click"],[1,"remove-button",2,"margin-top","5px",3,"click"],[1,"remove-button",2,"margin-top","2px",3,"click"]],template:function(e,i){1&e&&(Q(0,"div",0)(1,"button",1),Ae("click",function(){return i.helpStandSeteing()}),ve(2,"?"),ne(),Q(3,"div",2)(4,"b"),ve(5,"Pos: "),ne(),Q(6,"input",3),Ae("ngModelChange",function(o){return i.position=o}),ne(),Q(7,"input",4),Ae("ngModelChange",function(o){return i.position=o}),ne(),Q(8,"b",5),ve(9,"\uff05\u3000"),ne()(),Q(10,"div",2)(11,"b"),ve(12,"Height (0=\u5143\u753b\u50cf\u306e\u307e\u307e): "),ne(),Q(13,"input",3),Ae("ngModelChange",function(o){return i.height=o}),ne(),Q(14,"input",6),Ae("ngModelChange",function(o){return i.height=o}),ne(),Q(15,"b",5),ve(16,"\uff05"),ne()()(),Q(17,"div",7)(18,"label",8)(19,"input",9),Ae("click",function(){return i.overviewIndex=-1}),ne(),ve(20," \u30b9\u30bf\u30f3\u30c9\u753b\u50cf\u3092\u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u4f7f\u7528\u3057\u306a\u3044"),ne()(),mt(21,"hr"),Q(22,"div",10),Te(23,JU,15,8,"div",11),ne(),Q(24,"button",12),Ae("click",function(){return i.add()}),ve(25,"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u306e\u8ffd\u52a0"),ne(),Te(26,eH,2,0,"button",13)),2&e&&(G(6),oe("ngModel",i.position),G(1),oe("ngModel",i.position),G(6),oe("ngModel",i.height),G(1),oe("ngModel",i.height),G(3),ut("border-color",-1==i.overviewIndex?"red":"transparent"),G(2),cr("name","",i.panelId,"_overviewIndex"),oe("checked",-1==i.overviewIndex),G(4),oe("ngForOf",i.standElements),G(3),oe("ngIf",i.standSettingXML))},dependencies:[_i,Bn,Ii,Fo,Ro,Mi,Ys,Ks,yi,CS],styles:[".position-indicate[_ngcontent-%COMP%]{display:inline-block;font-size:smaller}.description[_ngcontent-%COMP%]{font-size:smaller}.remove-button[_ngcontent-%COMP%]{display:inline-block;font-weight:bolder;font-size:smaller;margin-top:-4px;margin-right:-1px}.overview-selecter[_ngcontent-%COMP%]{border:2px solid red;border-radius:8px;padding-top:1px;padding-bottom:4px}input[type=radio][_ngcontent-%COMP%]{width:1.5em;height:1.5em}"]}),t})();var Cg;let vi=Cg=class extends Pi{constructor(n=bo.generateUuid()){super(n),this.isLocked=!1,this.rotate=0,this.followingCharctorIdentifier=null,this.followingCounterDummy=0,this.offSetX=!1,this.offSetY=!1,this.type="CORN",this.subDivisionSnapPolygonal=!0,this.fillType=1,this.isExpandByFollowing=!1,this.isFollowAltitude=!1,this.followingCharactorCache=null,this.gridSize=50,this.isAltitudeIndicate=!0,this.followingCharctorIdentifier=null}get name(){return this.getCommonValue("name","")}get length(){return this.getCommonValue("length",1)}get width(){return this.getCommonValue("width",1)}get opacity(){let n=this.getElement("opacity",this.commonDataElement),e=n?n.currentValue/n.value:1;return Number.isNaN(e)?1:e}get rangeColor(){let n=this.getElement("color",this.commonDataElement);return n?n.value+"":"#ff0000"}set rangeColor(n){this.setCommonValue("color",n)}get gridColor(){let n=this.getElement("color",this.commonDataElement);return n?n.currentValue+"":"#ffff00"}set gridColor(n){let e=this.getElement("color",this.commonDataElement);e&&(e.currentValue=n)}get isApplyWidth(){return"LINE"===this.type||"CORN"===this.type}get followingCharactor(){if(this.followingCharctorIdentifier){if(!this.followingCharactorCache||this.followingCharactorCache.identifier!==this.followingCharctorIdentifier){let n=Ct.instance.get(this.followingCharctorIdentifier);n&&n instanceof sn?this.followingCharactorCache=n:(this.followingCharctorIdentifier=null,this.followingCharactorCache=null)}}else this.followingCharactorCache=null;return this.followingCharactorCache}set followingCharactor(n){n?(this.followingCharactorCache=n,this.followingCharctorIdentifier=n.identifier):(this.followingCharactorCache=null,this.followingCharctorIdentifier=null)}followingCounterDummyCount(){this.followingCounterDummy++,this.followingCounterDummy>=50&&(this.followingCounterDummy=0)}following(){this.followingCharactor&&!this.followingCharactor.isHideIn?(this.location.x=this.followingCharactor.location.x+this.gridSize*this.followingCharactor.size/2,this.location.y=this.followingCharactor.location.y+this.gridSize*this.followingCharactor.size/2,this.isFollowAltitude&&(this.altitude=this.followingCharactor.altitude,this.posZ=this.followingCharactor.posZ),this.followingCounterDummyCount()):this.followingCharactor=null}static create(n,e,i,r,o){let s=null;return s=o?new Cg(o):new Cg,s.createDataElements(),s.commonDataElement.appendChild(St.create("name",n,{},"name_"+s.identifier)),s.commonDataElement.appendChild(St.create("length",i,{},"length_"+s.identifier)),s.commonDataElement.appendChild(St.create("width",e,{},"width_"+s.identifier)),s.commonDataElement.appendChild(St.create("opacity",r,{type:"numberResource",currentValue:r},"opacity_"+s.identifier)),s.commonDataElement.appendChild(St.create("color","#ff0000",{type:"colors",currentValue:"#ffff00"},"ccolor_"+s.identifier)),s.commonDataElement.appendChild(St.create("altitude",0,{},"altitude_"+s.identifier)),s.initialize(),s}};$e([bt()],vi.prototype,"isLocked",void 0),$e([bt()],vi.prototype,"rotate",void 0),$e([bt()],vi.prototype,"followingCharctorIdentifier",void 0),$e([bt()],vi.prototype,"followingCounterDummy",void 0),$e([bt()],vi.prototype,"offSetX",void 0),$e([bt()],vi.prototype,"offSetY",void 0),$e([bt()],vi.prototype,"type",void 0),$e([bt()],vi.prototype,"subDivisionSnapPolygonal",void 0),$e([bt()],vi.prototype,"fillType",void 0),$e([bt()],vi.prototype,"isExpandByFollowing",void 0),$e([bt()],vi.prototype,"isFollowAltitude",void 0),vi=Cg=$e([mi("range")],vi);var la,Ff=(()=>(function(t){t.ASC="ASC",t.DESC="DESC"}(Ff||(Ff={})),Ff))();let ca=la=class extends pl{constructor(){super(...arguments),this.sortTag="name",this.sortOrder=Ff.ASC,this.dataTag="HP MP \u654f\u6377\u5ea6 \u751f\u547d\u529b \u7cbe\u795e\u529b"}static get instance(){return la._instance||(la._instance=new la("DataSummarySetting"),la._instance.initialize()),la._instance}get dataTags(){return this._dataTag!==this.dataTag&&(this._dataTag=this.dataTag,this._dataTags=null!=this.dataTag&&0<this.dataTag.trim().length?this.dataTag.trim().split(/[\u3000\s]+/):[]),this._dataTags}innerXml(){return""}parseInnerXml(n){let e=la.instance.toContext();e.syncData=this.toContext().syncData,la.instance.apply(e),la.instance.update(),this.destroy()}};var wg;$e([bt()],ca.prototype,"sortTag",void 0),$e([bt()],ca.prototype,"sortOrder",void 0),$e([bt()],ca.prototype,"dataTag",void 0),ca=la=$e([mi("summary-setting")],ca);let yo=wg=class extends Pi{constructor(){super(...arguments),this.isLock=!1,this.blendType=0,this.isTransparentOnGMMode=!1}get name(){return this.getCommonValue("name","")}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get opacity(){let n=this.getElement("opacity",this.commonDataElement),e=n?n.currentValue/n.value:1;return Number.isNaN(e)?1:e}get fontsize(){let n=this.getElement("fontsize",this.commonDataElement);return n?+n.value:18}set fontsize(n){this.setCommonValue("fontsize",n)}get text(){let n=this.getElement("text",this.commonDataElement);return n?n.value+"":""}set text(n){this.setCommonValue("text",n)}get color(){let n=this.getElement("color",this.commonDataElement);return n?n.value+"":"#555555"}set color(n){this.setCommonValue("color",n)}get bgcolor(){let n=this.getElement("color",this.commonDataElement);return n?n.currentValue+"":"#0a0a0a"}set bgcolor(n){let e=this.getElement("color",this.commonDataElement);e&&(e.currentValue=n)}complement(){let n=this.getElement("fontsize",this.commonDataElement);!n&&this.commonDataElement&&this.commonDataElement.appendChild(St.create("fontsize",18,{},"fontsize_"+this.identifier)),n=this.getElement("text",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.appendChild(St.create("text","",{type:"note",currentValue:""},"text_"+this.identifier)),n=this.getElement("color",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.appendChild(St.create("color","#555555",{type:"colors",currentValue:"#0a0a0a"},"color_"+this.identifier)),n=this.getElement("altitude",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.appendChild(St.create("altitude",0,{},"altitude_"+this.identifier))}static create(n,e,i,r,o){let s=null;return s=o?new wg(o):new wg,s.createDataElements(),s.commonDataElement.appendChild(St.create("name",n,{},"name_"+s.identifier)),s.commonDataElement.appendChild(St.create("width",e,{},"width_"+s.identifier)),s.commonDataElement.appendChild(St.create("height",i,{},"height_"+s.identifier)),s.commonDataElement.appendChild(St.create("opacity",r,{type:"numberResource",currentValue:r},"opacity_"+s.identifier)),s.commonDataElement.appendChild(St.create("fontsize",18,{},"fontsize_"+s.identifier)),s.commonDataElement.appendChild(St.create("text","",{type:"note",currentValue:""},"text_"+s.identifier)),s.commonDataElement.appendChild(St.create("color","#555555",{type:"colors",currentValue:"#0a0a0a"},"ccolor_"+s.identifier)),s.commonDataElement.appendChild(St.create("altitude",0,{},"altitude_"+s.identifier)),s.initialize(),s}};$e([bt()],yo.prototype,"isLock",void 0),$e([bt()],yo.prototype,"blendType",void 0),$e([bt()],yo.prototype,"isTransparentOnGMMode",void 0),yo=wg=$e([mi("table-mask")],yo);var xg,La=(()=>(function(t){t[t.NULL=0]="NULL",t[t.FLOOR=1]="FLOOR",t[t.WALL=2]="WALL",t[t.ALL=3]="ALL"}(La||(La={})),La))(),bi=(()=>(function(t){t[t.NONE=0]="NONE",t[t.TOP=1]="TOP",t[t.BOTTOM=2]="BOTTOM",t[t.LEFT=3]="LEFT",t[t.RIGHT=4]="RIGHT"}(bi||(bi={})),bi))();let Er=xg=class extends Pi{constructor(){super(...arguments),this.isLocked=!1,this.mode=La.ALL,this.rotate=0,this.isDropShadow=!0,this.isSurfaceShading=!0,this.isInteract=!0,this.isSlope=!1,this.slopeDirection=bi.NONE}get width(){return this.getCommonValue("width",1)}set width(n){this.setCommonValue("width",n)}get height(){return this.getCommonValue("height",1)}set height(n){this.setCommonValue("height",n)}get depth(){return this.getCommonValue("depth",1)}set depth(n){this.setCommonValue("depth",n)}get name(){return this.getCommonValue("name","")}set name(n){this.setCommonValue("name",n)}get wallImage(){return this.getImageFile("wall")}get floorImage(){return this.getImageFile("floor")}get hasWall(){return!!(this.mode&La.WALL)}get hasFloor(){return!!(this.mode&La.FLOOR)}complement(){!this.getElement("altitude",this.commonDataElement)&&this.commonDataElement&&this.commonDataElement.appendChild(St.create("altitude",0,{},"altitude_"+this.identifier))}static create(n,e,i,r,o,s,a){let h=null;return h=a?new xg(a):new xg,h.createDataElements(),h.commonDataElement.appendChild(St.create("name",n,{},"name_"+h.identifier)),h.commonDataElement.appendChild(St.create("width",e,{},"width_"+h.identifier)),h.commonDataElement.appendChild(St.create("height",r,{},"height_"+h.identifier)),h.commonDataElement.appendChild(St.create("depth",i,{},"depth_"+h.identifier)),h.commonDataElement.appendChild(St.create("altitude",0,{},"altitude_"+h.identifier)),h.imageDataElement.appendChild(St.create("wall",o,{type:"image"},"wall_"+h.identifier)),h.imageDataElement.appendChild(St.create("floor",s,{type:"image"},"floor_"+h.identifier)),h.initialize(),h}};$e([bt()],Er.prototype,"isLocked",void 0),$e([bt()],Er.prototype,"mode",void 0),$e([bt()],Er.prototype,"rotate",void 0),$e([bt()],Er.prototype,"isDropShadow",void 0),$e([bt()],Er.prototype,"isSurfaceShading",void 0),$e([bt()],Er.prototype,"isInteract",void 0),$e([bt()],Er.prototype,"isSlope",void 0),$e([bt()],Er.prototype,"slopeDirection",void 0),Er=xg=$e([mi("terrain")],Er);var fs=(()=>(function(t){t[t.NONE=-1]="NONE",t[t.SQUARE=0]="SQUARE",t[t.HEX_VERTICAL=1]="HEX_VERTICAL",t[t.HEX_HORIZONTAL=2]="HEX_HORIZONTAL"}(fs||(fs={})),fs))(),Eg=(()=>(function(t){t.NONE="",t.WHITE="white",t.BLACK="black"}(Eg||(Eg={})),Eg))();let ir=class extends ni{constructor(){super(...arguments),this.name="\u30c6\u30fc\u30d6\u30eb",this.width=20,this.height=20,this.gridSize=50,this.imageIdentifier="imageIdentifier",this.backgroundImageIdentifier="imageIdentifier",this.backgroundFilterType=Eg.NONE,this.selected=!1,this.gridType=fs.SQUARE,this.gridColor="#000000e6",this.isShowNumber=!0,this.gridHeight=0}get terrains(){let n=[];return this.children.forEach(e=>{e instanceof Er&&n.push(e)}),n}get masks(){let n=[];return this.children.forEach(e=>{e instanceof yo&&n.push(e)}),n}onStoreAdded(){super.onStoreAdded(),this.selected&&Ue.trigger("SELECT_GAME_TABLE",{identifier:this.identifier})}};var Tg;$e([bt()],ir.prototype,"name",void 0),$e([bt()],ir.prototype,"width",void 0),$e([bt()],ir.prototype,"height",void 0),$e([bt()],ir.prototype,"gridSize",void 0),$e([bt()],ir.prototype,"imageIdentifier",void 0),$e([bt()],ir.prototype,"backgroundImageIdentifier",void 0),$e([bt()],ir.prototype,"backgroundFilterType",void 0),$e([bt()],ir.prototype,"selected",void 0),$e([bt()],ir.prototype,"gridType",void 0),$e([bt()],ir.prototype,"gridColor",void 0),$e([bt()],ir.prototype,"isShowNumber",void 0),ir=$e([mi("game-table")],ir);let Vr=Tg=class extends Pi{constructor(){super(...arguments),this.rotate=0,this.zindex=0,this.password="",this.isUpright=!0,this.isLocked=!1,this.isWhiteOut=!1}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get fontSize(){return this.getCommonValue("fontsize",1)}get title(){return this.getCommonValue("title","")}get text(){return this.getCommonValue("text","")}set text(n){this.setCommonValue("text",n)}get color(){return this.getCommonValue("color","#444444")}set color(n){this.setCommonValue("color",n)}complement(){let n=this.getElement("color",this.commonDataElement);!n&&this.commonDataElement&&this.commonDataElement.appendChild(St.create("color","#555555",{type:"color"},"color_"+this.identifier)),n=this.getElement("altitude",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.appendChild(St.create("altitude",0,{},"altitude_"+this.identifier))}toTopmost(){bv(this)}static create(n,e,i=16,r=1,o=1,s){let a=s?new Tg(s):new Tg;return a.createDataElements(),a.commonDataElement.appendChild(St.create("width",r,{},"width_"+a.identifier)),a.commonDataElement.appendChild(St.create("height",o,{},"height_"+a.identifier)),a.commonDataElement.appendChild(St.create("fontsize",i,{},"fontsize_"+a.identifier)),a.commonDataElement.appendChild(St.create("title",n,{},"title_"+a.identifier)),a.commonDataElement.appendChild(St.create("text",e,{type:"note",currentValue:e},"text_"+a.identifier)),a.commonDataElement.appendChild(St.create("color","#444444",{type:"color"},"ccolor_"+a.identifier)),a.commonDataElement.appendChild(St.create("altitude",0,{},"altitude_"+a.identifier)),a.initialize(),a}};$e([bt()],Vr.prototype,"rotate",void 0),$e([bt()],Vr.prototype,"zindex",void 0),$e([bt()],Vr.prototype,"password",void 0),$e([bt()],Vr.prototype,"isUpright",void 0),$e([bt()],Vr.prototype,"isLocked",void 0),$e([bt()],Vr.prototype,"isWhiteOut",void 0),Vr=Tg=$e([mi("text-note")],Vr);let Cv=class extends pl{onStoreAdded(){super.onStoreAdded(),Ct.instance.remove(this)}innerXml(){let n="",e=[];e=e.concat(Ct.instance.getObjects(ir)),e=e.concat(Ct.instance.getObjects(sn)),e=e.concat(Ct.instance.getObjects(vi)),e=e.concat(Ct.instance.getObjects(Vr)),e=e.concat(Ct.instance.getObjects(ai)),e=e.concat(Ct.instance.getObjects(Qn).filter(i=>null===i.parent)),e=e.concat(Ct.instance.getObjects(xr));for(let i of e)n+=i.toXml();return n}parseInnerXml(n){let e=[];e=e.concat(Ct.instance.getObjects(ir)),e=e.concat(Ct.instance.getObjects(yo)),e=e.concat(Ct.instance.getObjects(Er)),e=e.concat(Ct.instance.getObjects(sn)),e=e.concat(Ct.instance.getObjects(vi)),e=e.concat(Ct.instance.getObjects(Vr)),e=e.concat(Ct.instance.getObjects(ai)),e=e.concat(Ct.instance.getObjects(Qn)),e=e.concat(Ct.instance.getObjects(xr));for(let i of e)i.destroy();for(let i=0;i<n.children.length;i++)gi.instance.parseXml(n.children[i])}};Cv=$e([mi("room")],Cv);var tH=_e(1203);class Gr{constructor(n,e){this.ngZone=n,this.chatMessageService=e}saveRoomAsync(n="fly_\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",e){return this.chatMessageService.sendOperationLog(`\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf ${n}.zip \u3092\u4fdd\u5b58`),Gr.queue.add((i,r)=>i(this._saveRoomAsync(n,e)))}_saveRoomAsync(n="fly_\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",e){let i=[],r=this.convertToXml(new Cv),o=this.convertToXml(Fs.instance),s=this.convertToXml(Ns.instance),a=this.convertToXml(Os.instance),h=this.convertToXml(ca.instance);i.push(new File([r],"fly_data.xml",{type:"text/plain"})),i.push(new File([o],"fly_chat.xml",{type:"text/plain"})),i.push(new File([s],"fly_rollTable.xml",{type:"text/plain"})),i.push(new File([a],"fly_cutIn.xml",{type:"text/plain"})),i.push(new File([h],"summary.xml",{type:"text/plain"}));let b=[];b=b.concat(this.searchImageFiles(r)),b=b.concat(this.searchImageFiles(o)),b=b.concat(this.searchImageFiles(a));for(const de of b)de.state===Gi.COMPLETE&&i.push(new File([de.blob],de.identifier+"."+bc.extension(de.blob.type),{type:de.blob.type}));let ee=this.convertToXml(Ur.create(b));return i.push(new File([ee],"fly_imageTag.xml",{type:"text/plain"})),this.saveAsync(i,this.appendTimestamp(n),e)}saveGameObjectAsync(n,e="fly_xml_data",i){return this.chatMessageService.sendOperationLog(`${pt.aliasNameToClassName(n.aliasName)}\u306e\u30c7\u30fc\u30bf ${e}.zip \u3092\u4fdd\u5b58`),Gr.queue.add((r,o)=>r(this._saveGameObjectAsync(n,e,i)))}_saveGameObjectAsync(n,e="fly_xml_data",i){let r=[],o=this.convertToXml(n);r.push(new File([o],"fly_data.xml",{type:"text/plain"}));let s=[];s=s.concat(this.searchImageFiles(o));for(const h of s)h.state===Gi.COMPLETE&&r.push(new File([h.blob],h.identifier+"."+bc.extension(h.blob.type),{type:h.blob.type}));let a=this.convertToXml(Ur.create(s));return r.push(new File([a],"fly_imageTag.xml",{type:"text/plain"})),this.saveAsync(r,this.appendTimestamp(e),i)}saveAsync(n,e,i){let r=-1;return sa.instance.saveAsync(n,e,o=>{let s=0|o.percent;s<=r||(r=s,this.ngZone.run(()=>i(r)))})}convertToXml(n){return'<?xml version="1.0" encoding="UTF-8"?>\n'+tH.xml(n.toXml(),2)}searchImageFiles(n){let e=Fa.xml2element(n),i=[];if(!e)return i;let r={},o=e.ownerDocument.querySelectorAll('*[type="image"]');for(let s=0;s<o.length;s++){let a=o[s].innerHTML;r[a]=Gt.instance.get(a);let h=o[s].getAttribute("currentValue");h&&(r[h]=Gt.instance.get(h))}o=e.ownerDocument.querySelectorAll("*[imageIdentifier], *[toImageIdentifier], *[backgroundImageIdentifier]");for(let s=0;s<o.length;s++){let a=o[s].getAttribute("imageIdentifier");a&&(r[a]=Gt.instance.get(a));let h=o[s].getAttribute("toImageIdentifier");h&&(r[a]=Gt.instance.get(h));let b=o[s].getAttribute("backgroundImageIdentifier");b&&(r[b]=Gt.instance.get(b))}for(let s in r){let a=r[s];a&&i.push(a)}return i}appendTimestamp(n){let e=new Date;return n+`_${e.getFullYear()}-${("00"+(e.getMonth()+1)).slice(-2)}-${("00"+e.getDate()).slice(-2)}_${("00"+e.getHours()).slice(-2)}${("00"+e.getMinutes()).slice(-2)}`}saveChatLog(n,e,i=null,r="HH:mm",o=!0){const s=0==n?"text/plain":"text/html",a=0==n?".txt":".html",h="fly_"+this.appendTimestamp(e)+a;this.chatMessageService.sendOperationLog(`\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0 ${h} \u3092\u4fdd\u5b58`),_S(new Blob([i?i.log(n,r,o):Fs.instance.log(n,r,o)],{type:`${s};charset=utf-8`}),h)}}Gr.queue=new RT("SaveDataServiceQueue"),Gr.\u0275fac=function(n){return new(n||Gr)(pn(Nn),pn(Hr))},Gr.\u0275prov=$n({token:Gr,factory:Gr.\u0275fac,providedIn:"root"});class hs{constructor(n,e){this.elementRef=n,this.chatMessageService=e,this.isDisable=!1,this.timeout=666,this.showValue=!0,this.type="\u30aa\u30d6\u30b8\u30a7\u30af\u30c8"}ngAfterViewInit(){let n=this.dataElement;for(;(n=n.parent)&&(n instanceof Qn&&(this.type="\u30ab\u30fc\u30c9"),n instanceof ai&&(this.type="\u5c71\u672d"),n instanceof xr&&(this.type=n.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9"),n instanceof sn&&(this.type="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc"),n instanceof yo&&(this.type="\u30de\u30c3\u30d7\u30de\u30b9\u30af"),n instanceof Er&&(this.type="\u5730\u5f62"),n instanceof Vr&&(this.type="\u5171\u6709\u30e1\u30e2"),n instanceof vi&&(this.type="\u5c04\u7a0b\u30fb\u7bc4\u56f2"),n.parentIsAssigned&&!n.parentIsUnknown););const e=hs.LoggingValueMap,i=this.dataElement.identifier,r=this.elementRef.nativeElement;e.set(i,{oldValue:this.loggingValue}),r.addEventListener("input",()=>{e.get(i).timerId&&clearTimeout(e.get(i).timerId),e.get(i).timerId=setTimeout(()=>{this.doLogging()},this.timeout)})}ngOnDestroy(){const n=hs.LoggingValueMap,e=this.dataElement.identifier;n.get(e)&&n.get(e).timerId&&this.doLogging()}doLogging(){const n=hs.LoggingValueMap,e=this.dataElement.identifier;n.get(e).timerId&&(clearTimeout(n.get(e).timerId),n.get(e).timerId=null);const i=n.get(e).oldValue,r=this.loggingValue,o=this.dataElement;if(!this.isDisable&&r!=i){let s=`${""==this.name?`(\u7121\u540d\u306e${this.type})`:this.name} \u306e ${""==o.name?"(\u7121\u540d\u306e\u5909\u6570)":o.name} \u3092\u5909\u66f4`;this.showValue&&(o.isSimpleNumber||o.isNumberResource||o.isAbilityScore)?s+=` ${i} \u2192 ${r}`:o.isCheckProperty&&(s+=` ${r}`),this.chatMessageService.sendOperationLog(s)}n.get(e).oldValue=r}get loggingValue(){const n=this.dataElement;if(!n)return;let e;if(n.isSimpleNumber)e=`${n.value}`;else if(n.isNumberResource)e=`${n.currentValue}/${n.value&&0!=n.value?n.value:"???"}`;else if(n.isCheckProperty)e=n.value?" \u2192 \u2714ON":" \u2192 OFF";else if(n.isAbilityScore){const i=n.calcAbilityScore();e=`${n.value}`,n.currentValue&&(e+=`(${i>=0?"+":""}${i})`)}else e=n.value?n.value.toString():"";return e}}function nH(t,n){1&t&&Pn(0)}function iH(t,n){if(1&t){const e=ft();Q(0,"div",3),Te(1,nH,1,0,"ng-container",5),Q(2,"select",6),Ae("change",function(r){return Re(e),Le(me(3).setElementType(r.target.value))}),Q(3,"option",7),ve(4,"\u901a\u5e38"),ne(),Q(5,"option",8),ve(6,"\u6570\u5024"),ne(),Q(7,"option",9),ve(8,"\u30ea\u30bd\u30fc\u30b9"),ne(),Q(9,"option",10),ve(10,"\u80fd\u529b\u5024"),ne(),Q(11,"option",11),ve(12,"\u30c1\u30a7\u30c3\u30af"),ne(),Q(13,"option",12),ve(14,"\u30ce\u30fc\u30c8"),ne(),Q(15,"option",13),ve(16,"\u53c2\u7167URL"),ne()()()}if(2&t){const e=me(3),i=cn(2);G(1),oe("ngTemplateOutlet",i),G(1),oe("ngModel",e.gameDataElement.type)}}function rH(t,n){1&t&&(it(0),mt(1,"br"),Q(2,"span",15),ve(3,"0=\u753b\u50cf\u4f9d\u5b58"),ne(),rt())}function oH(t,n){if(1&t&&(it(0),Q(1,"span",14),ve(2),ne(),Te(3,rH,4,0,"ng-container",0),rt()),2&t){const e=me(3);G(2),lt(e.name),G(1),oe("ngIf","character"===e.descriptionType&&"height"===e.name)}}function sH(t,n){if(1&t){const e=ft();it(0),Q(1,"div",16),ve(2),ne(),Q(3,"input",17),Ae("ngModelChange",function(r){return Re(e),Le(me(3).name=r)}),ne(),rt()}if(2&t){const e=me(3);G(2),lt(e.name),G(1),oe("ngModel",e.name)}}function aH(t,n){if(1&t){const e=ft();it(0),Q(1,"input",21),Ae("ngModelChange",function(r){return Re(e),Le(me(4).currentValue=r)}),Lt(2,"safe"),ne(),mt(3,"br"),Q(4,"input",22),Ae("ngModelChange",function(r){return Re(e),Le(me(4).currentValue=r)}),ne(),Q(5,"b",23),ve(6,"%"),ne(),rt()}if(2&t){const e=me(4);G(1),Sr(Bt(2,5,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),cr("title","",e.currentValue,"%"),oe("ngModel",e.currentValue),G(3),oe("ngModel",e.currentValue)}}function lH(t,n){if(1&t){const e=ft();it(0),Q(1,"label",24)(2,"input",25),Ae("ngModelChange",function(r){return Re(e),Le(me(5).value=r)}),ne(),Q(3,"div",26),ve(4),ne()(),Q(5,"label",27)(6,"input",25),Ae("ngModelChange",function(r){return Re(e),Le(me(5).currentValue=r)}),ne(),Q(7,"div",26),ve(8),ne()(),rt()}if(2&t){const e=me(5);G(1),ut("color",e.value)("background-color",e.currentValue)("text-shadow",e.colorSampleTextShadowCss),G(1),oe("ngModel",e.value),G(2),lt(e.value),G(1),ut("color",e.value)("background-color",e.currentValue)("text-shadow",e.colorSampleTextShadowCss),G(1),oe("ngModel",e.currentValue),G(2),Zn("(",e.currentValue,")")}}function cH(t,n){if(1&t){const e=ft();it(0),Q(1,"label",24)(2,"input",25),Ae("ngModelChange",function(r){return Re(e),Le(me(5).value=r)}),ne(),ve(3),ne(),rt()}if(2&t){const e=me(5);G(1),ut("color",e.value)("text-shadow",e.colorSampleTextShadowCss),G(1),oe("ngModel",e.value),G(1),Zn(" ",e.value,"")}}function uH(t,n){if(1&t&&(it(0),Te(1,lH,9,16,"ng-container",0),Te(2,cH,4,6,"ng-container",0),rt()),2&t){const e=me(4);G(1),oe("ngIf","colors"===e.gameDataElement.type),G(1),oe("ngIf","color"===e.gameDataElement.type)}}function dH(t,n){if(1&t){const e=ft();Q(0,"dev",31)(1,"label")(2,"input",32),Ae("ngModelChange",function(r){return Re(e),Le(me(5).currentValue=r)})("change",function(){Re(e);const r=me(5);return Le(r.currentValue=r.currentValue?r.name:"")}),ne(),ve(3,"\xd7 size"),ne()()}if(2&t){const e=me(5);G(2),xt("checked",e.currentValue?"checked":""),oe("ngModel",e.currentValue)}}function fH(t,n){if(1&t){const e=ft();it(0),Q(1,"input",28),Ae("ngModelChange",function(r){return Re(e),Le(me(4).value=r)}),Lt(2,"safe"),ne(),mt(3,"br"),Q(4,"input",29),Ae("ngModelChange",function(r){return Re(e),Le(me(4).value=r)}),ne(),Te(5,dH,4,2,"dev",30),rt()}if(2&t){const e=me(4);G(1),Sr(Bt(2,11,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),xt("title",e.value),xt("min","altitude"===e.name?-12:"fontsize"===e.name||"length"===e.name?1:0),xt("max","fontsize"===e.name?128:12),xt("step","fontsize"===e.name?1:.5),oe("ngModel",e.value),G(3),xt("min","altitude"===e.name?-24:"fontsize"===e.name||"length"===e.name?1:0),xt("step","fontsize"===e.name?1:.1),oe("ngModel",e.value),G(1),oe("ngIf","character"===e.descriptionType&&"height"===e.name)}}function hH(t,n){if(1&t&&(it(0)(1,18),Te(2,aH,7,8,"ng-container",19),Te(3,uH,3,2,"ng-container",19),Te(4,fH,6,14,"ng-container",20),rt()()),2&t){const e=me(3);G(1),oe("ngSwitch",e.gameDataElement.name),G(1),oe("ngSwitchCase","opacity"),G(1),oe("ngSwitchCase","color")}}function pH(t,n){if(1&t){const e=ft();it(0),Q(1,"div",33),ve(2),ne(),Q(3,"input",34),Ae("ngModelChange",function(r){return Re(e),Le(me(4).value=r)}),ne(),rt()}if(2&t){const e=me(4);G(2),lt(e.value),G(1),xt("type",e.isNum(e.value)?"number":"text"),oe("logging.name",e.tabletopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.value)}}function gH(t,n){if(1&t){const e=ft();it(0),Q(1,"input",35),Ae("ngModelChange",function(r){return Re(e),Le(me(4).currentValue=r)}),Lt(2,"safe"),ne(),mt(3,"br"),Q(4,"input",36),Ae("ngModelChange",function(r){return Re(e),Le(me(4).currentValue=r)}),ne(),ve(5," / "),Q(6,"input",37),Ae("ngModelChange",function(r){return Re(e),Le(me(4).value=r)}),ne(),rt()}if(2&t){const e=me(4);G(1),Sr(Bt(2,16,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),xt("title",e.currentValue),xt("max",e.isNum(e.value)?e.value:1e3),oe("logging.name",e.tabletopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.currentValue),G(3),oe("logging.name",e.tabletopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.currentValue),G(2),oe("logging.name",e.tabletopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.value)}}function mH(t,n){if(1&t){const e=ft();it(0),Q(1,"select",39),Ae("ngModelChange",function(r){return Re(e),Le(me(5).currentValue=r)}),Q(2,"option",7),ve(3,"\u306a\u3057"),ne(),Q(4,"option",40),ve(5,"\xf72"),ne(),Q(6,"option",41),ve(7,"\xf73 SRS,LHZ"),ne(),Q(8,"option",42),ve(9,"\xf74"),ne(),Q(10,"option",43),ve(11,"\xf75"),ne(),Q(12,"option",44),ve(13,"\xf76 SW"),ne(),Q(14,"option",45),ve(15,"\xf710"),ne(),Q(16,"option",46),ve(17,"D&D 3e\uff5e"),ne()(),rt()}if(2&t){const e=me(5);G(1),oe("ngModel",e.currentValue)}}function _H(t,n){if(1&t&&(it(0),Q(1,"span",47),ve(2),ne(),rt()),2&t){const e=me(5);G(2),lt("("+(e.abilityScore>=0?"+":"")+e.abilityScore+")")}}function $H(t,n){if(1&t){const e=ft();it(0),Q(1,"input",38),Ae("ngModelChange",function(r){return Re(e),Le(me(4).value=r)}),ne(),Te(2,mH,18,1,"ng-container",0),Te(3,_H,3,1,"ng-container",0),rt()}if(2&t){const e=me(4);G(1),xt("type",e.isNum(e.value)?"number":"text"),oe("logging.name",e.tabletopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.value),G(1),oe("ngIf",e.isEdit),G(1),oe("ngIf",!e.isEdit&&e.currentValue)}}function vH(t,n){if(1&t){const e=ft();Q(0,"input",51),Ae("ngModelChange",function(r){return Re(e),Le(me(5).currentValue=r)}),ne()}2&t&&oe("ngModel",me(5).currentValue)}function bH(t,n){if(1&t&&(Q(0,"span",52),ve(1),ne()),2&t){const e=me(5);G(1),lt(e.checkValue)}}function yH(t,n){if(1&t){const e=ft();it(0),Q(1,"input",48),Ae("ngModelChange",function(r){return Re(e),Le(me(4).value=r)})("change",function(){Re(e);const r=me(4);return Le(r.value=r.value?r.name:"")}),ne(),Te(2,vH,1,1,"input",49),Te(3,bH,2,1,"span",50),rt()}if(2&t){const e=me(4);G(1),xt("checked",e.value?"checked":""),oe("logging.name",e.tabletopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.value),G(1),oe("ngIf",e.isEdit),G(1),oe("ngIf",!e.isEdit)}}function CH(t,n){if(1&t){const e=ft();it(0),Q(1,"textarea",53),Ae("ngModelChange",function(r){return Re(e),Le(me(4).value=r)}),ne(),rt()}if(2&t){const e=me(4);G(1),oe("ngModel",e.value)}}function wH(t,n){if(1&t){const e=ft();it(0),Q(1,"div",33),ve(2),ne(),Q(3,"span",54)(4,"input",55),Ae("ngModelChange",function(r){return Re(e),Le(me(4).value=r)}),ne(),Q(5,"button",56),Ae("click",function(){Re(e);const r=me(4);return Le(!!r.stringUtil.validUrl(r.value)&&r.openUrl(r.value))}),Q(6,"i",57),ve(7),ne()()(),rt()}if(2&t){const e=me(4);G(2),lt(e.value),G(2),oe("ngModel",e.value),G(1),Qt("disabled",e.stringUtil.validUrl(e.value)?null:""),G(2),lt(e.stringUtil.validUrl(e.value)?e.stringUtil.sameOrigin(e.value)?"link":"open_in_new":"link_off")}}function xH(t,n){if(1&t){const e=ft();Q(0,"input",60),Ae("ngModelChange",function(r){return Re(e),Le(me(5).value=r)}),ne()}2&t&&oe("ngModel",me(5).value)}function EH(t,n){1&t&&(Q(0,"span",61),ve(1,"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09"),ne())}function TH(t,n){if(1&t&&(it(0),Q(1,"div",33),ve(2),ne(),Te(3,xH,1,1,"input",58),Te(4,EH,2,0,"span",59),rt()),2&t){const e=me(4);G(2),lt(e.value),G(1),oe("ngIf",!(e.isHideText&&e.isTabletopObjectName)),G(1),oe("ngIf",e.isHideText&&e.isTabletopObjectName)}}function SH(t,n){if(1&t&&(it(0)(1,18),Te(2,pH,4,6,"ng-container",19),Te(3,gH,7,19,"ng-container",19),Te(4,$H,4,7,"ng-container",19),Te(5,yH,4,7,"ng-container",19),Te(6,CH,2,1,"ng-container",19),Te(7,wH,8,4,"ng-container",19),Te(8,TH,5,3,"ng-container",20),rt()()),2&t){const e=me(3);G(1),oe("ngSwitch",e.gameDataElement.type),G(1),oe("ngSwitchCase","simpleNumber"),G(1),oe("ngSwitchCase","numberResource"),G(1),oe("ngSwitchCase","abilityScore"),G(1),oe("ngSwitchCase","checkProperty"),G(1),oe("ngSwitchCase","note"),G(1),oe("ngSwitchCase","url")}}function IH(t,n){if(1&t&&(it(0),Te(1,iH,17,2,"div",2),Q(2,"div",3),Te(3,oH,4,2,"ng-container",0),Te(4,sH,4,2,"ng-container",0),ne(),Q(5,"div",4),Te(6,hH,5,3,"ng-container",0),Te(7,SH,9,7,"ng-container",0),ne(),rt()),2&t){const e=me(2);G(1),oe("ngIf",e.isEdit),G(2),oe("ngIf",e.isTagLocked),G(1),oe("ngIf",!e.isTagLocked),G(2),oe("ngIf",e.isCommonValue),G(1),oe("ngIf",!e.isCommonValue)}}function MH(t,n){1&t&&Pn(0)}function kH(t,n){if(1&t&&(Q(0,"div",67),Te(1,MH,1,0,"ng-container",5),ne()),2&t){me(3);const e=cn(2);G(1),oe("ngTemplateOutlet",e)}}function DH(t,n){if(1&t&&(it(0),Q(1,"div",68),ve(2),ne(),rt()),2&t){const e=me(3);G(2),lt(e.name)}}function AH(t,n){if(1&t){const e=ft();it(0),Q(1,"input",69),Ae("ngModelChange",function(r){return Re(e),Le(me(3).name=r)}),ne(),rt()}if(2&t){const e=me(3);G(1),oe("ngModel",e.name)}}function PH(t,n){if(1&t&&mt(0,"div",72),2&t){const e=n.$implicit,i=me(4);oe("gameDataElement",e)("tabletopObject",i.tabletopObject)("isEdit",i.isEdit)("isTagLocked",i.isTagLocked)("isHideText",i.isHideText)("isNoLogging",i.isNoLogging)("descriptionType",i.descriptionType)}}function NH(t,n){if(1&t&&(Q(0,"div",70),Te(1,PH,1,7,"div",71),ne()),2&t){const e=me(3);G(1),oe("ngForOf",e.gameDataElement.children)}}function OH(t,n){if(1&t&&(it(0),Te(1,kH,2,1,"div",62),mt(2,"div",63),Q(3,"div",64)(4,"div",65),Te(5,DH,3,1,"ng-container",0),Te(6,AH,2,1,"ng-container",0),ne(),Te(7,NH,2,1,"div",66),ne(),rt()),2&t){const e=me(2);G(1),oe("ngIf",e.isEdit),G(3),ut("border-color",e.isTagLocked&&"common"===e.name?"transparent":""),G(1),oe("ngIf",e.isTagLocked&&"common"!=e.name),G(1),oe("ngIf",!e.isTagLocked),G(1),oe("ngIf",0<e.gameDataElement.children.length)}}function FH(t,n){if(1&t&&(it(0),Te(1,IH,8,5,"ng-container",0),Te(2,OH,8,6,"ng-container",0),rt()),2&t){const e=me();G(1),oe("ngIf",e.gameDataElement.children.length<1),G(1),oe("ngIf",0<e.gameDataElement.children.length)}}function RH(t,n){if(1&t){const e=ft();Q(0,"button",73),Ae("click",function(){return Re(e),Le(me().addElement())}),Q(1,"i",74),ve(2,"add_circle"),ne()(),Q(3,"button",73),Ae("click",function(){return Re(e),Le(me().upElement())}),Q(4,"i",74),ve(5,"arrow_upward"),ne()(),mt(6,"br"),Q(7,"button",73),Ae("click",function(){return Re(e),Le(me().deleteElement())}),Q(8,"i",74),ve(9,"remove_circle_outline"),ne()(),Q(10,"button",73),Ae("click",function(){return Re(e),Le(me().downElement())}),Q(11,"i",74),ve(12,"arrow_downward"),ne()()}}hs.LoggingValueMap=new Map,hs.\u0275fac=function(n){return new(n||hs)(He(Ai),He(Hr))},hs.\u0275dir=hn({type:hs,selectors:[["","appLogging",""]],inputs:{isDisable:["logging.disable","isDisable"],timeout:["logging.timeout","timeout"],name:["logging.name","name"],dataElement:["logging.dataElement","dataElement"],showValue:["logging.loggingValue","showValue"]}});let LH=(()=>{class t{constructor(e,i){this.changeDetector=e,this.modalService=i,this.tabletopObject=null,this.gameDataElement=null,this.isEdit=!1,this.isTagLocked=!1,this.isValueLocked=!1,this.isHideText=!1,this.isNoLogging=!1,this.stringUtil=pt,this._name="",this._value=0,this._currentValue=0,this.updateTimer=null}get name(){return this._name}set name(e){this._name=e,this.setUpdateTimer()}get value(){return this._value}set value(e){this._value=e,this.setUpdateTimer()}get currentValue(){return this._currentValue}set currentValue(e){this._currentValue=e,this.setUpdateTimer()}get abilityScore(){return this.gameDataElement.calcAbilityScore()}get isTabletopObjectName(){return this.isTagLocked&&"name"===this.gameDataElement.name}get tabletopObjectName(){let e=this.tabletopObject.commonDataElement.getFirstElementByName("name")||this.tabletopObject.commonDataElement.getFirstElementByName("title");return e?e.value:""}get checkValue(){if(null==this.currentValue)return"";let e=this.currentValue.toString().split(/[|\uff5c]/,2);if(e.length<=1)return null==this.value||""==this.value?"":this.currentValue.toString();let i=null==this.value||""==this.value?e[1]:e[0];return this.tabletopObject instanceof sn&&this.tabletopObject.chatPalette&&(i=this.tabletopObject.chatPalette.evaluate(i,this.tabletopObject.rootDataElement)),i}get isCommonValue(){return!!this.gameDataElement&&this.isTagLocked&&("size"===this.gameDataElement.name||"width"===this.gameDataElement.name||"height"===this.gameDataElement.name||"depth"===this.gameDataElement.name||"length"===this.gameDataElement.name||"fontsize"===this.gameDataElement.name||"opacity"===this.gameDataElement.name||"altitude"===this.gameDataElement.name||"color"===this.gameDataElement.name)}get isNotApplicable(){return this.isCommonValue&&"range-not-width"===this.descriptionType&&"width"===this.gameDataElement.name}get colorSampleTextShadowCss(){const e=pt.textShadowColor(this.value.toString());return`${e} -1px -1px 0px, \n      ${e} 0px -1px 0px, \n      ${e} 1px -1px 0px, \n      ${e} -1px 0px 0px, \n      ${e} 1px 0px 0px,\n      ${e} -1px 1px 0px,\n      ${e} 0px 1px 0px,\n      ${e} 1px 1px 0px`}get identifier(){return this.gameDataElement.identifier}ngOnInit(){this.gameDataElement&&this.setValues(this.gameDataElement),Ue.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=!1;this.gameDataElement&&e.data.identifier===this.gameDataElement.identifier?(this.setValues(this.gameDataElement),i=!0):this.tabletopObject&&this.tabletopObject.contains(this.gameDataElement)&&(i=!0),i&&this.changeDetector.markForCheck()}).on("DELETE_GAME_OBJECT",e=>{this.gameDataElement&&this.gameDataElement.identifier===e.data.identifier&&this.changeDetector.markForCheck()})}ngOnDestroy(){Ue.unregister(this)}ngAfterViewInit(){}addElement(){this.gameDataElement.appendChild(St.create("\u30bf\u30b0","",{}))}deleteElement(){this.gameDataElement.destroy()}upElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);0<i&&e.insertBefore(this.gameDataElement,e.children[i-1])}downElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.gameDataElement)}setElementType(e){this.gameDataElement.setAttribute("type",e)}isNum(e){return isFinite(e)}openUrl(e){pt.sameOrigin(e)?window.open(e.trim(),"_blank","noopener"):this.modalService.open(lo,{url:e,title:this.tabletopObjectName,subTitle:this.name})}setValues(e){this._name=e.name,this._currentValue=e.currentValue,this._value=e.value}setUpdateTimer(){clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>{this.gameDataElement.name!==this.name&&(this.gameDataElement.name=this.name),this.gameDataElement.currentValue!==this.currentValue&&(this.gameDataElement.currentValue=this.currentValue),this.gameDataElement.value!==this.value&&(this.gameDataElement.value=this.value),this.updateTimer=null},66)}}return t.\u0275fac=function(e){return new(e||t)(He(Ki),He(Yn))},t.\u0275cmp=fn({type:t,selectors:[["game-data-element"],["","game-data-element",""]],inputs:{tabletopObject:"tabletopObject",gameDataElement:"gameDataElement",isEdit:"isEdit",isTagLocked:"isTagLocked",isValueLocked:"isValueLocked",isHideText:"isHideText",isNoLogging:"isNoLogging",descriptionType:"descriptionType"},decls:3,vars:1,consts:[[4,"ngIf"],["editButtons",""],["class","table-cell table-cell_solid",4,"ngIf"],[1,"table-cell","table-cell_solid"],[1,"table-cell"],[4,"ngTemplateOutlet"],[3,"ngModel","change"],["value",""],["value","simpleNumber"],["value","numberResource"],["value","abilityScore"],["value","checkProperty"],["value","note"],["value","url"],[2,"font-family","Cambria, Georgia","font-size","0.9rem"],[2,"font-size","0.4rem"],[1,"hidden-spacer",2,"font-family","Cambria, Georgia","font-size","0.9rem"],["size","1","placeholder","Value",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","0.9rem",3,"ngModel","ngModelChange"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["type","range","min","0","max","100","step","1",2,"width","90%",3,"ngModel","title","ngModelChange"],["type","number","min","0","max","100","step","1","size","1","placeholder","Opacity",2,"margin-left","3.5em","width","4em","text-align","right",3,"ngModel","ngModelChange"],[1,"move",2,"font-size","small"],[1,"color-sample",2,"padding","0px 2px 0px 0xp","width","6.5em"],["type","color",2,"width","1em",3,"ngModel","ngModelChange"],[2,"display","inline-block","box-sizing","border-box","width","calc(100% - 1em)","text-align","center"],[1,"color-sample",2,"padding","0px 2px 0px 0xp","width","7.5em"],["type","range",2,"width","90%",3,"ngModel","title","min","max","step","ngModelChange"],["type","number","size","1","placeholder","Value",2,"width","35%","max-width","4em","text-align","right",3,"min","step","ngModel","ngModelChange"],["style","color: #444; font-family: Cambria, Georgia; font-size: 0.9rem; display: inline-block; margin-left: 3px",4,"ngIf"],[2,"color","#444","font-family","Cambria, Georgia","font-size","0.9rem","display","inline-block","margin-left","3px"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[1,"hidden-spacer",2,"font-size","1.0em","font-family","Cambria, Georgia"],["appLogging","","size","1","placeholder","Number",2,"width","40%","min-width","3em","max-width","8em","text-align","right",3,"logging.name","logging.dataElement","logging.disable","type","ngModel","ngModelChange"],["appLogging","","type","range","min","0",3,"logging.name","logging.dataElement","logging.disable","ngModel","title","max","ngModelChange"],["appLogging","","size","1","type","number","placeholder","Value",2,"width","5em","text-align","right",3,"logging.name","logging.dataElement","logging.disable","ngModel","ngModelChange"],["appLogging","","size","1","type","number","placeholder","Value",2,"width","5em",3,"logging.name","logging.dataElement","logging.disable","ngModel","ngModelChange"],["appLogging","","size","1","placeholder","Value",2,"width","40%","max-width","5em","text-align","right",3,"logging.name","logging.dataElement","logging.disable","type","ngModel","ngModelChange"],[1,"modeifire-type",2,"width","40%","max-width","5em",3,"ngModel","ngModelChange"],["value","div2"],["value","div3"],["value","div4"],["value","div5"],["value","div6"],["value","div10"],["value","DnD3"],[2,"font-size","smaller"],["appLogging","","type","checkbox",2,"width","30%","max-width","4em",3,"logging.name","logging.dataElement","logging.disable","ngModel","checked","ngModelChange","change"],["style","width:50%; max-width:4em","type","text","size","1","placeholder","Option",3,"ngModel","ngModelChange",4,"ngIf"],["style","font-size: 1.0em; font-family: Cambria, Georgia; color: #555",4,"ngIf"],["type","text","size","1","placeholder","Option",2,"width","50%","max-width","4em",3,"ngModel","ngModelChange"],[2,"font-size","1.0em","font-family","Cambria, Georgia","color","#555"],["placeholder","Note",2,"width","100%","height","5em","min-width","50px","resize","bose","font-size","0.8em",3,"ngModel","ngModelChange"],[2,"white-space","nowrap"],["type","url","size","1","placeholder","https://www.example.com",2,"width","calc(100% - 1.6rem)","min-width","10px",3,"ngModel","ngModelChange"],[2,"width","1.6rem",3,"click"],[1,"material-icons",2,"font-size","1.0rem"],["style","width:100%; min-width:10px;","size","1","placeholder","",3,"ngModel","ngModelChange",4,"ngIf"],["style","color: gray; font-size: 1.0em; font-family: Cambria, Georgia;",4,"ngIf"],["size","1","placeholder","",2,"width","100%","min-width","10px",3,"ngModel","ngModelChange"],[2,"color","gray","font-size","1.0em","font-family","Cambria, Georgia"],["class","table-cell table-cell_solid","style","vertical-align: top;",4,"ngIf"],[1,"table-cell","table-cell_inner-table",2,"padding","0","width","0"],[1,"table-cell_inner-table"],[1,"table-cell_inner-table-title"],["class","table",4,"ngIf"],[1,"table-cell","table-cell_solid",2,"vertical-align","top"],[2,"padding","2px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold"],["size","1","placeholder","Value",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold",3,"ngModel","ngModelChange"],[1,"table"],["game-data-element","","class","table-row",3,"gameDataElement","tabletopObject","isEdit","isTagLocked","isHideText","isNoLogging","descriptionType",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","tabletopObject","isEdit","isTagLocked","isHideText","isNoLogging","descriptionType"],[3,"click"],[1,"material-icons"]],template:function(e,i){1&e&&(Te(0,FH,3,2,"ng-container",0),Te(1,RH,13,0,"ng-template",null,1,ti)),2&e&&oe("ngIf",i.gameDataElement&&!i.isNotApplicable&&!(i.isHideText&&("text"==i.name||"fontsize"==i.name||"color"==i.name)))},dependencies:[_i,Bn,Jl,Ql,Zd,Xd,oo,so,Ii,Fo,Ro,Oo,$o,Mi,Ys,Ks,yi,t,hs,$i],styles:[".game-data-element[_ngcontent-%COMP%]{margin-left:10px}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{padding-top:10px;display:table-row;box-sizing:border-box}.table-cell[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.5em 0 .1em .5em;border-bottom:1px dotted #888;box-sizing:border-box}.table-cell_solid[_ngcontent-%COMP%]{width:10px;white-space:nowrap}.table-cell_inner-table[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.2em 0 .1em .5em;border:none;box-sizing:border-box}.table-cell_inner-table-title[_ngcontent-%COMP%]{border-bottom:1px solid #444;border-left:8px solid #444;padding-left:8px}.box[_ngcontent-%COMP%]{display:inline-block;margin:10px}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;max-width:20em;overflow:hidden;padding:0 3px;box-sizing:border-box}input[_ngcontent-%COMP%], button[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}input[_ngcontent-%COMP%]:hover, textarea[_ngcontent-%COMP%]:hover, select[_ngcontent-%COMP%]:hover{background:#EEE}input[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{background:#FFF}button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}.table-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.5rem}button[_ngcontent-%COMP%]:disabled{color:gray}button[_ngcontent-%COMP%]:disabled:hover{background-color:transparent}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.modeifire-type[_ngcontent-%COMP%]{font-size:smaller}input[type=color][_ngcontent-%COMP%]:hover, input[type=color][_ngcontent-%COMP%]:not(:hover){-webkit-appearance:auto;-moz-appearance:auto;appearance:auto;width:44px;height:22px;background-color:#efefef;cursor:default;color:#000;border-width:1px;border-style:solid;border-color:#767676;-o-border-image:none;border-image:none;-o-border-image:initial;border-image:initial;padding:1px 2px}@media (prefers-color-scheme: dark){input[type=color][_ngcontent-%COMP%]:hover, input[type=color][_ngcontent-%COMP%]:not(:hover){background-color:#3b3b3b;color:#fff;border-color:#858585}}.color-sample[_ngcontent-%COMP%]{display:inline-block;font-weight:bolder;width:6em;text-shadow:#eee -1px -1px 0px,#eee 0px -1px 0px,#eee 1px -1px 0px,#eee -1px 0px 0px,#eee 1px 0px 0px,#eee -1px 1px 0px,#eee 0px 1px 0px,#eee 1px 1px 0px}input[_ngcontent-%COMP%] + .move[_ngcontent-%COMP%]{display:inline-block;transform:translate(-1em);transition:transform 18ms}input[_ngcontent-%COMP%]:hover + .move[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:active + .move[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:focus + .move[_ngcontent-%COMP%]{display:inline-block;transform:translate(0);transition:transform 18ms}@supports (-moz-user-select: -moz-none){input[_ngcontent-%COMP%] + .move[_ngcontent-%COMP%]{transform:translate(0)}}"],changeDetection:0}),t})();const BH=["mainImage"];function zH(t,n){1&t&&Pn(0)}function jH(t,n){if(1&t){const e=ft();it(0),Q(1,"button",4),Ae("click",function(){return Re(e),Le(me().openModal("front"))}),ve(2,"\u8868\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),ne(),Q(3,"button",0),Ae("click",function(){return Re(e),Le(me().openModal("back"))}),ve(4,"\u88cf\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),ne(),rt()}if(2&t){const e=me();G(1),oe("disabled",!e.isVisible)}}function UH(t,n){if(1&t){const e=ft();it(0),Q(1,"button",0),Ae("click",function(){return Re(e),Le(me().openModalChangeAllCardImages())}),ve(2,"\u5168\u30ab\u30fc\u30c9\u306e\u88cf\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),ne(),rt()}}function HH(t,n){if(1&t){const e=ft();it(0),Q(1,"button",0),Ae("click",function(){return Re(e),Le(me().openModal("floor"))}),ve(2,"\u5e8a\u306e\u753b\u50cf\u3092\u5909\u66f4"),ne(),Q(3,"button",0),Ae("click",function(){return Re(e),Le(me().openModal("wall"))}),ve(4,"\u58c1\u306e\u753b\u50cf\u3092\u5909\u66f4"),ne(),rt()}}function VH(t,n){if(1&t){const e=ft();it(0),Q(1,"button",4),Ae("click",function(){Re(e);const r=me();return Le(r.openModal(r.tabletopObject.face))}),ve(2,"\u30c0\u30a4\u30b9\u76ee\u306e\u753b\u50cf\u3092\u5909\u66f4"),ne(),rt()}if(2&t){const e=me();G(1),oe("disabled",!e.isVisible)}}function GH(t,n){if(1&t){const e=ft();it(0),Q(1,"button",0),Ae("click",function(){Re(e);const r=me();return Le(r.openModalReplaceImage(r.tabletopObject.imageFiles.length>1||0<(null==r.tabletopObject.imageFile?null:r.tabletopObject.imageFile.url.length)))}),ve(2),ne(),Q(3,"button",4),Ae("click",function(){return Re(e),Le(me().openModal("faceIcon"))}),ve(4),ne(),rt()}if(2&t){const e=me();G(2),Zn("\u753b\u50cf",(null==e.tabletopObject.imageFiles?null:e.tabletopObject.imageFiles.length)>1?"\u7f6e\u63db/\u524a\u9664":"\u8a2d\u5b9a",""),G(1),oe("disabled",(null==e.tabletopObject.faceIcons?null:e.tabletopObject.faceIcons.length)>=e.MAX_IMAGE_ICON_COUNT),G(1),Zn("\u9854IC",(null==e.tabletopObject.faceIcons?null:e.tabletopObject.faceIcons.length)>0?"\u8ffd\u52a0":"\u8a2d\u5b9a","")}}function qH(t,n){if(1&t){const e=ft();it(0),Q(1,"button",0),Ae("click",function(){Re(e);const r=me(2);return Le(r.openModal("imageIdentifier",r.tabletopObject.imageFile&&r.tabletopObject.imageFile.url.length>0))}),ve(2,"\u753b\u50cf\u5909\u66f4"),ne(),rt()}}function WH(t,n){if(1&t&&(it(0),Te(1,qH,3,0,"ng-container",8),rt()),2&t){const e=me();G(1),oe("ngIf","range"!==e.tabletopObject.aliasName)}}function KH(t,n){if(1&t&&(Q(0,"div",10),ve(1),ne()),2&t){const e=me();G(1),Zn("",e.progresPercent,"%")}}function YH(t,n){if(1&t){const e=ft();Q(0,"select",12),Ae("change",function(r){return Re(e),Le(me(2).setLocation(r.target.value))}),Q(1,"option",13),ve(2,"\u30c6\u30fc\u30d6\u30eb"),ne(),Q(3,"option",14),ve(4,"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),ne(),Q(5,"option",15),ve(6,"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),ne(),Q(7,"option",16),ve(8,"\u5893\u5730"),ne()()}if(2&t){const e=me(2);oe("ngModel",e.tabletopObject.location.name),G(5),xt("value",e.networkService.peerId)}}function ZH(t,n){if(1&t){const e=ft();it(0),Te(1,YH,9,2,"select",11),Q(2,"button",4),Ae("click",function(){Re(e);const r=me();return Le(r.openModal("shadowImageIdentifier",r.tabletopObject.shadowImageFile.url.length>0))}),ve(3,"\u753b\u50cf\u306e\u5f71\u306e\u5909\u66f4"),ne(),rt()}if(2&t){const e=me();G(1),oe("ngIf",e.tabletopObject),G(1),oe("disabled",!e.tabletopObject.imageElement||"null"==e.tabletopObject.imageElement.value)}}function XH(t,n){if(1&t){const e=ft();Q(0,"button",35),Ae("click",function(){Re(e);const r=me(2),o=r.index,s=r.$implicit;return Le(me(3).deleteIcon(o,s.identifier))}),Q(1,"b",36),ve(2,"close"),ne()()}}const QH=function(t){return{"current-icon":t}};function JH(t,n){if(1&t){const e=ft();Q(0,"div",32)(1,"img",33),Ae("click",function(){Re(e);const r=me().index;return Le(me(3).selectIcon(r))}),Lt(2,"safe"),ne(),Te(3,XH,3,0,"button",34),ne()}if(2&t){const e=me(),i=e.index,r=e.$implicit,o=me(3);oe("@bounceInOut",void 0)("ngClass",wt(8,QH,o.tabletopObject.currntIconIndex==i)),G(1),oe("src",Bt(2,5,r.url,"resourceUrl"),vn)("alt",r.name),G(2),oe("ngIf",o.tabletopObject.currntIconIndex==i)}}function eV(t,n){if(1&t&&(Q(0,"div",5),Te(1,JH,4,10,"div",31),ne()),2&t){const e=n.$implicit,i=n.index;ut("top",-me(3).showIconOffset(i),"px"),G(1),oe("ngIf",0<e.url.length)}}const tV=function(t){return{hide:t}};function nV(t,n){if(1&t){const e=ft();Q(0,"span",37)(1,"img",33),Ae("click",function(){const o=Re(e).index;return Le(me(3).selectImage(o))}),Lt(2,"safe"),ne()()}if(2&t){const e=n.$implicit,i=n.index,r=me(3);ut("left",50*(r.tabletopObject.currntImageIndex<=i?i-1:i)-r.showCaseOffset(i),"px"),oe("ngClass",wt(9,tV,r.tabletopObject.currntImageIndex==i)),G(1),oe("@bounceInOut",void 0)("src",Bt(2,6,e.url,"resourceUrl"),vn)("alt",e.name)}}function iV(t,n){if(1&t){const e=ft();Q(0,"button",38),Ae("click",function(){return Re(e),Le(me(3).openModalAddImage())}),ve(1),ne()}if(2&t){const e=me(3);ut("left",e.tabletopObject.imageFiles.length<0?-5:45*(e.tabletopObject.imageFiles.length-1)-5-e.showCaseOffset(e.tabletopObject.imageFiles.length-2),"px"),G(1),lt(e.tabletopObject.imageFiles.length<2?"\u5207\u308a\u66ff\u3048\u753b\u50cf\u8a2d\u5b9a":"\uff0b")}}const rV=function(t){return{transform:t}};function oV(t,n){if(1&t&&(Q(0,"div",39),mt(1,"div",40),Lt(2,"safe"),ne()),2&t){const e=me(3);ut("width",e.imageAreaRreact.width,"px")("height",e.imageAreaRreact.height,"px"),oe("ngStyle",wt(15,rV,"scale("+e.imageAreaRreact.scale+")")),G(1),ut("font-size",e.cardFontSize,"px")("color",e.cardColor)("text-shadow",e.cardTextShadowCss),oe("innerHTML",Bt(2,12,e.cardText,"html"),lr)}}const sV=function(t){return{inverse:t}},aV=function(t,n,e,i,r,o,s,a){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}},lV=function(t,n,e){return{"black-paint":t,hollow:n,small:e}};function cV(t,n){if(1&t){const e=ft();Q(0,"div",20)(1,"div",21),Te(2,eV,2,3,"div",22),ne(),Q(3,"div",23),Te(4,nV,3,11,"span",24),Te(5,iV,2,3,"button",25),ne(),Te(6,oV,3,17,"div",26),Q(7,"span",27)(8,"span",28)(9,"img",29,30),Ae("dblclick",function(){return Re(e),Le(me(2).openMainImageModal())})("load",function(){return Re(e),Le(me(2).onMainImageLoad())}),Lt(11,"safe"),ne()()()()}if(2&t){const e=me(2);G(2),oe("ngForOf",e.tabletopObject.faceIcons)("ngForTrackBy",e.identify),G(2),oe("ngForOf",e.tabletopObject.imageFiles),G(1),oe("ngIf","character"==e.tabletopObject.aliasName&&e.tabletopObject.imageFiles.length<e.MAX_IMAGE_ICON_COUNT&&(e.tabletopObject.imageFiles.length>1||0<(null==e.tabletopObject.imageFile?null:e.tabletopObject.imageFile.url.length))),G(1),oe("ngIf","card"==e.tabletopObject.aliasName&&(e.tabletopObject.isFront||e.tabletopObject.isHand||e.isVisible)||"card-stack"==e.tabletopObject.aliasName&&e.tabletopObject.topCard.isFront),G(1),oe("ngClass",wt(14,sV,e.tabletopObject.isInverse)),G(1),oe("ngClass",Ms(16,aV,0==e.tabletopObject.aura,1==e.tabletopObject.aura,2==e.tabletopObject.aura,3==e.tabletopObject.aura,4==e.tabletopObject.aura,5==e.tabletopObject.aura,6==e.tabletopObject.aura,7==e.tabletopObject.aura)),G(1),oe("src",Bt(11,11,e.imageFile.url,"resourceUrl"),vn)("alt",e.imageFile.name)("ngClass",mo(25,lV,e.isBlackPaint,e.tabletopObject.isHollow,""==e.tabletopObject.aliasName))("@switchImage",e.tabletopObject.currntImageIndex)}}function uV(t,n){if(1&t){const e=ft();Q(0,"div",45)(1,"button",46),Ae("click",function(){return Re(e),Le(me(3).showChatPalette())}),ve(2,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a"),ne(),Q(3,"button",46),Ae("click",function(){return Re(e),Le(me(3).showStandSetting())}),ve(4,"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a"),ne()()}}function dV(t,n){if(1&t&&(it(0),Q(1,"div",41)(2,"div",42),mt(3,"div",43),ne(),Te(4,uV,5,0,"div",44),ne(),rt()),2&t){const e=me(2);G(3),oe("gameDataElement",e.tabletopObject.commonDataElement)("tabletopObject",e.tabletopObject)("isTagLocked",!0)("isHideText","card"===e.tabletopObject.aliasName&&!e.tabletopObject.isFront&&!e.tabletopObject.isHand&&!e.tabletopObject.isGMMode)("isNoLogging",e.isNoLogging)("descriptionType",e.descriptionType),G(1),oe("ngIf","character"===e.tabletopObject.aliasName)}}function fV(t,n){if(1&t&&(Q(0,"div",41)(1,"div",42),mt(2,"div",48),ne()()),2&t){const e=n.$implicit,i=me(3);G(2),oe("gameDataElement",e)("tabletopObject",i.tabletopObject)("isEdit",i.isEdit)("isNoLogging",i.isNoLogging)}}function hV(t,n){if(1&t&&(it(0),Te(1,fV,3,4,"div",47),rt()),2&t){const e=me(2);G(1),oe("ngForOf",e.tabletopObject.detailDataElement.children)}}function pV(t,n){if(1&t){const e=ft();it(0),Q(1,"div",41)(2,"button",49),Ae("click",function(){return Re(e),Le(me(2).addDataElement())}),ve(3,"\u65b0\u3057\u3044\u9805\u76ee\u3092\u8ffd\u52a0"),ne()(),rt()}}function gV(t,n){if(1&t){const e=ft();Q(0,"div",17)(1,"img",18),Ae("click",function(){return Re(e),Le(me().openModal("shadowImageIdentifier",!0))}),Lt(2,"safe"),ne(),Te(3,cV,12,29,"div",19),Te(4,dV,5,7,"ng-container",8),Te(5,hV,2,1,"ng-container",8),Te(6,pV,4,0,"ng-container",8),ne()}if(2&t){const e=me();G(1),oe("src",Bt(2,6,e.tabletopObject.shadowImageFile.url,"resourceUrl"),vn)("alt",e.tabletopObject.shadowImageFile.name),G(2),oe("ngIf",(0<(null==e.tabletopObject.imageFile?null:e.tabletopObject.imageFile.url.length)||0<(null==e.tabletopObject.faceIcons?null:e.tabletopObject.faceIcons.length))&&"table-mask"!=e.tabletopObject.aliasName),G(1),oe("ngIf",e.tabletopObject.commonDataElement),G(1),oe("ngIf",e.tabletopObject.detailDataElement),G(1),oe("ngIf",e.isEdit)}}const mV=function(t){return{"is-hidden":t}};let ps=(()=>{class t{constructor(e,i,r,o){this.saveDataService=e,this.panelService=i,this.modalService=r,this.pointerDeviceService=o,this.tabletopObject=null,this.isEdit=!1,this.networkService=Ot,this.MAX_IMAGE_ICON_COUNT=8,this.isSaveing=!1,this.progresPercent=0,this.gridSize=50,this.naturalWidth=0,this.naturalHeight=0,this.mainImageWidth=0,this.mainImageHeight=0}ngOnInit(){Ue.register(this).on("DELETE_GAME_OBJECT",e=>{this.tabletopObject&&this.tabletopObject.identifier===e.data.identifier&&this.panelService.close()}).on("UPDATE_GAME_OBJECT",-1e3,e=>{if(this.tabletopObject&&this.tabletopObject.identifier===e.data.identifier)switch(this.tabletopObject.aliasName){case"terrain":this.panelService.title=`\u5730\u5f62\u8a2d\u5b9a - ${this.tabletopObjectName}`;break;case"card":const i=this.tabletopObject;i instanceof Qn&&(this.panelService.title=`\u30ab\u30fc\u30c9\u8a2d\u5b9a - ${i.isFront?this.tabletopObjectName:"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09"}`);break;case"card-stack":this.panelService.title=`\u5c71\u672d\u8a2d\u5b9a - ${this.tabletopObjectName}`;break;case"table-mask":this.panelService.title=`\u30de\u30c3\u30d7\u30de\u30b9\u30af\u8a2d\u5b9a - ${this.tabletopObjectName}`;break;case"text-note":this.panelService.title=`\u5171\u6709\u30e1\u30e2\u8a2d\u5b9a - ${this.tabletopObjectName}`;break;case"dice-symbol":this.panelService.title=`\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u8a2d\u5b9a - ${this.tabletopObjectName}`;break;case"character":this.panelService.title=`\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8 - ${this.tabletopObjectName}`;break;case"range":this.panelService.title=`\u5c04\u7a0b\u30fb\u7bc4\u56f2\u8a2d\u5b9a - ${this.tabletopObjectName}`}})}ngAfterViewInit(){}ngOnDestroy(){Ue.unregister(this)}toggleEditMode(){this.isEdit=!this.isEdit}addDataElement(){if(this.tabletopObject.detailDataElement){let e=St.create("\u898b\u51fa\u3057","",{}),i=St.create("\u30bf\u30b0","",{});e.appendChild(i),this.tabletopObject.detailDataElement.appendChild(e)}}clone(){let e=this.tabletopObject.clone();switch(e.location.x+=50,e.location.y+=50,this.tabletopObject.parent&&this.tabletopObject.parent.appendChild(e),e.update(),this.tabletopObject.aliasName){case"terrain":Et.play(st.blockPut),e.isLocked=!1;break;case"card":case"card-stack":e.owner="",e.toTopmost();case"table-mask":e.isLock=!1,Et.play(st.cardPut);break;case"text-note":e.toTopmost(),Et.play(st.cardPut);break;case"dice-symbol":Et.play(st.dicePut);default:Et.play(st.piecePut)}}get tabletopObjectName(){let e=this.tabletopObject.commonDataElement.getFirstElementByName("name")||this.tabletopObject.commonDataElement.getFirstElementByName("title");return e?e.value:""}get imageFile(){const e=this.tabletopObject;return e?e instanceof Qn&&this.isVisible?e.frontImage:e.imageFile:on.Empty}get descriptionType(){return this.tabletopObject instanceof vi&&!this.tabletopObject.isApplyWidth?"range-not-width":this.tabletopObject.aliasName}saveToXML(){var e=this;return(0,gn.Z)(function*(){if(!e.tabletopObject||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i=e.tabletopObjectName;yield e.saveDataService.saveGameObjectAsync(e.tabletopObject,"fly_xml_"+i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}setLocation(e){Ue.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.tabletopObject.identifier}),Et.play("graveyard"==e?st.sweep:st.piecePut),this.tabletopObject.setLocation(e)}openModal(e="",i=!1){let r=[];if("shadowImageIdentifier"==e){const o=this.tabletopObject.imageElement;o&&"null"!=o.value&&o.currentValue&&(r=[o.currentValue+""])}else{const o=this.tabletopObject.imageDataElement.getElementsByName(e);o&&o.length>0&&(r=o.map(s=>s.value+""))}this.modalService.open(aa,{isAllowedEmpty:i,currentImageIdentifires:r}).then(o=>{if(this.tabletopObject&&this.tabletopObject.imageDataElement&&o)if("shadowImageIdentifier"==e){const s=this.tabletopObject.imageElement;if(s){"null"!=s.value&&(s.currentValue=o);const a=this.tabletopObject.imageDataElement.getElementsByName("shadowImageIdentifier");for(const h of a)this.tabletopObject.imageDataElement.removeChild(h)}}else if("faceIcon"===e){let s=this.tabletopObject.imageDataElement.getElementsByName(e);if(s.length>=this.MAX_IMAGE_ICON_COUNT){for(let a=this.MAX_IMAGE_ICON_COUNT;a<s.length;a++)this.deleteIcon(a);s[this.MAX_IMAGE_ICON_COUNT-1].value=o}else this.tabletopObject.imageDataElement.appendChild(St.create(e,o,{type:"image"},e+bo.generateUuid()));this.tabletopObject.currntIconIndex<0&&(this.tabletopObject.currntIconIndex=0)}else{let s=this.tabletopObject.imageDataElement.getFirstElementByName(e);if(!s)return;s.value=o}})}openModalAddImage(){let e=[];const i=this.tabletopObject.imageDataElement.getElementsByName("imageIdentifier");i.length>0&&(e=i.map(r=>r.value+"")),this.modalService.open(aa,{currentImageIdentifires:e}).then(r=>{if(!this.tabletopObject||!this.tabletopObject.imageDataElement||!r)return;let o=this.tabletopObject.imageDataElement.getElementsByName("imageIdentifier");if(o.length>=this.MAX_IMAGE_ICON_COUNT){for(let s=this.MAX_IMAGE_ICON_COUNT;s<o.length;s++)this.deleteImage(s);o[this.MAX_IMAGE_ICON_COUNT-1].value=r}else this.tabletopObject.imageDataElement.appendChild(St.create("imageIdentifier",r,{type:"image"},name+bo.generateUuid()));this.tabletopObject.currntImageIndex<0&&(this.tabletopObject.currntImageIndex=0)})}openModalReplaceImage(e=!1){let i=[];const r=this.tabletopObject.imageDataElement.getElementsByName("imageIdentifier");r.length>0&&(i=r.map(o=>o.value+"")),this.modalService.open(aa,{isAllowedEmpty:e,currentImageIdentifires:i}).then(o=>{!this.tabletopObject||!this.tabletopObject.imageDataElement||!o||("null"==o?this.tabletopObject.imageElement&&1==this.tabletopObject.imageFiles.length?(this.tabletopObject.imageElement.value=o,this.tabletopObject.imageElement.currentValue=o):this.deleteImage(this.tabletopObject.currntImageIndex):this.tabletopObject.imageElement&&(this.tabletopObject.imageElement.value=o))})}openModalChangeAllCardImages(){this.modalService.open(aa,{isAllowedEmpty:!1}).then(e=>{!this.tabletopObject||!this.tabletopObject||!(this.tabletopObject instanceof ai)||!e||this.tabletopObject.cards.forEach(i=>{let r=i.imageDataElement.getFirstElementByName("back");r&&(r.value=e)})})}selectImage(e,i="imageIdentifier"){this.tabletopObject.currntImageIndex!=e&&(this.tabletopObject.currntImageIndex=e,Et.play(st.surprise),Ue.trigger("UPDATE_INVENTORY",null))}selectIcon(e){this.tabletopObject.currntIconIndex!=e&&(this.tabletopObject.currntIconIndex=e)}deleteImage(e=0,i="imageIdentifier"){if(!this.tabletopObject||!this.tabletopObject.imageDataElement)return;let r=this.tabletopObject.imageDataElement.getElementsByName(i);r&&0<r.length&&e<r.length&&(this.tabletopObject.currntImageIndex>e&&(this.tabletopObject.currntImageIndex-=1),this.tabletopObject.imageDataElement.removeChild(r[e]),this.tabletopObject.currntImageIndex>=r.length-1&&(this.tabletopObject.currntImageIndex=r.length-2),this.tabletopObject.currntImageIndex<0&&(this.tabletopObject.currntImageIndex=0))}deleteIcon(e=0,i=""){if(!this.tabletopObject||!this.tabletopObject.imageDataElement)return;let r=this.tabletopObject.imageDataElement.getElementsByName("faceIcon");r&&0<r.length&&e<r.length&&(!i||r[e].value===i)&&(this.tabletopObject.currntIconIndex>e&&(this.tabletopObject.currntIconIndex-=1),this.tabletopObject.imageDataElement.removeChild(r[e]),this.tabletopObject.currntIconIndex>=r.length-1&&(this.tabletopObject.currntIconIndex=r.length-2),this.tabletopObject.currntIconIndex<0&&(this.tabletopObject.currntIconIndex=0))}openMainImageModal(){this.tabletopObject instanceof ai||(this.tabletopObject instanceof Qn?this.openModal(this.tabletopObject.isVisible?"front":"back"):this.tabletopObject instanceof xr?this.openModal(this.tabletopObject.face):this.tabletopObject instanceof sn?this.openModalReplaceImage(this.tabletopObject.imageFiles.length>1||0<this.tabletopObject.imageFile?.url.length):this.openModal("imageIdentifier",this.tabletopObject.imageFile&&this.tabletopObject.imageFile.url.length>0))}showChatPalette(){if(!(this.tabletopObject instanceof sn))return;let e=this.pointerDeviceService.pointers[0];this.panelService.open(Lu,{left:e.x-250,top:e.y-175,width:620,height:350}).character=this.tabletopObject}showStandSetting(){if(!(this.tabletopObject instanceof sn))return;let e=this.pointerDeviceService.pointers[0];this.panelService.open(yg,{left:e.x-400,top:e.y-175,width:720,height:572}).character=this.tabletopObject}onMainImageLoad(){!this.mainImageElement||(this.mainImageWidth=this.mainImageElement.nativeElement.clientWidth,this.mainImageHeight=this.mainImageElement.nativeElement.clientHeight,this.naturalWidth=this.mainImageElement.nativeElement.naturalWidth,this.naturalHeight=this.mainImageElement.nativeElement.naturalHeight)}identify(e,i){return i.identifier}get imageAreaRreact(){return this.calcImageAreaRect(this.mainImageWidth,this.mainImageHeight,0)}calcImageAreaRect(e,i,r){const o={width:0,height:0,top:r,left:r,scale:1};if(0==this.naturalWidth||0==this.naturalHeight)return o;const s=e-2*r,a=i-2*r;this.naturalHeight*s/this.naturalWidth>a?(o.width=this.naturalWidth*a/this.naturalHeight,o.height=a,o.left=r+(s-o.width)/2):(o.width=s,o.height=this.naturalHeight*s/this.naturalWidth,o.top=r+(a-o.height)/2);let h=null;return this.tabletopObject instanceof ai?h=this.tabletopObject.topCard:this.tabletopObject instanceof Qn&&(h=this.tabletopObject),h&&(o.scale=o.width/(h.size*this.gridSize),o.width=h.size*this.gridSize,o.height=o.width*this.naturalHeight/this.naturalWidth),o}get cardColor(){let e=null;return this.tabletopObject instanceof ai?e=this.tabletopObject.topCard:this.tabletopObject instanceof Qn&&(e=this.tabletopObject),e?e.color:"#555555"}get cardFontSize(){let e=null;return this.tabletopObject instanceof ai?e=this.tabletopObject.topCard:this.tabletopObject instanceof Qn&&(e=this.tabletopObject),e?e.fontsize+9:18}get cardText(){let e=null;return this.tabletopObject instanceof ai?e=this.tabletopObject.topCard:this.tabletopObject instanceof Qn&&(e=this.tabletopObject),e?pt.rubyToHtml(pt.escapeHtml(e.text)):""}get cardTextShadowCss(){const e=pt.textShadowColor(this.cardColor);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}get isVisible(){return!!this.tabletopObject&&(!(!Qe.myCursor||!Qe.myCursor.isGMMode)||(this.tabletopObject instanceof Qn?this.tabletopObject.isFront||this.tabletopObject.isHand:!(this.tabletopObject instanceof xr)||this.tabletopObject.isVisible))}get isBlackPaint(){return this.tabletopObject instanceof sn?this.tabletopObject.isBlackPaint:this.tabletopObject instanceof xr&&!this.isVisible}get isNoLogging(){return this.tabletopObject instanceof Qn?!this.tabletopObject.isFront:this.tabletopObject instanceof xr&&this.tabletopObject.hasOwner}showCaseOffset(e){let i=this.tabletopObject.imageFiles.length;return i<=5?0:(50-160/(i-2))*(this.tabletopObject.currntImageIndex<=e?e-1:e)}showIconOffset(e){let i=this.tabletopObject.faceIcons.length;return i<=5?0:(50-200/(i-1))*e+2}}return t.\u0275fac=function(e){return new(e||t)(He(Gr),He(qn),He(Yn),He(Ci))},t.\u0275cmp=fn({type:t,selectors:[["game-character-sheet"]],viewQuery:function(e,i){if(1&e&&wn(BH,5),2&e){let r;Cn(r=xn())&&(i.mainImageElement=r.first)}},inputs:{tabletopObject:"tabletopObject"},decls:19,vars:14,consts:[[3,"click"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[4,"ngIf"],["class","flex-container",4,"ngIf"],[1,"progress"],[3,"ngModel","change",4,"ngIf"],[3,"ngModel","change"],["value","table"],["value","common"],[3,"value"],["value","graveyard"],[1,"flex-container"],[1,"shadow-image",3,"src","alt","click"],["class","box main-image-box",4,"ngIf"],[1,"box","main-image-box"],[1,"icons-box"],["style","position: relative",3,"top",4,"ngFor","ngForOf","ngForTrackBy"],[1,"image-showcase",2,"position","absolute","height","50px","top","300px"],["class","image-thumbnail","style","position: absolute;",3,"ngClass","left",4,"ngFor","ngForOf"],["style","position: relative; bottom: 30px; z-index: 700;",3,"left","click",4,"ngIf"],["class","text",3,"width","height","ngStyle",4,"ngIf"],[1,"inverser",2,"display","inline-block",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"main-image",3,"src","alt","ngClass","dblclick","load"],["mainImage",""],["class","icon-image-box",3,"ngClass",4,"ngIf"],[1,"icon-image-box",3,"ngClass"],[3,"src","alt","click"],["class","button-delete-icon","title","\u9854IC\u524a\u9664",3,"click",4,"ngIf"],["title","\u9854IC\u524a\u9664",1,"button-delete-icon",3,"click"],[1,"material-icons",2,"font-size","1rem"],[1,"image-thumbnail",2,"position","absolute",3,"ngClass"],[2,"position","relative","bottom","30px","z-index","700",3,"click"],[1,"text",3,"ngStyle"],[3,"innerHTML"],[1,"flex-item"],[1,"table"],["game-data-element","",1,"table-row",3,"gameDataElement","tabletopObject","isTagLocked","isHideText","isNoLogging","descriptionType"],["style","margin-top: 3px; text-align: right",4,"ngIf"],[2,"margin-top","3px","text-align","right"],[2,"font-size","11px","color","#444",3,"click"],["class","flex-item",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","tabletopObject","isEdit","isNoLogging"],[2,"width","100%","color","#555",3,"click"]],template:function(e,i){1&e&&(Q(0,"button",0),Ae("click",function(){return i.toggleEditMode()}),ve(1,"\u7de8\u96c6\u5207\u308a\u66ff\u3048"),ne(),it(2,1),Te(3,zH,1,0,"ng-container",2),Te(4,jH,5,1,"ng-container",2),Te(5,UH,3,0,"ng-container",2),Te(6,HH,5,0,"ng-container",2),Te(7,VH,3,1,"ng-container",2),Te(8,GH,5,3,"ng-container",2),Te(9,WH,2,1,"ng-container",3),rt(),Q(10,"button",0),Ae("click",function(){return i.clone()}),ve(11,"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b"),ne(),Q(12,"button",4),Ae("click",function(){return i.saveToXML()}),Q(13,"div",5)(14,"div",6),ve(15,"\u4fdd\u5b58"),ne(),Te(16,KH,2,1,"div",7),ne()(),Te(17,ZH,4,2,"ng-container",8),Te(18,gV,7,9,"div",9)),2&e&&(G(2),oe("ngSwitch",i.tabletopObject.aliasName),G(1),oe("ngSwitchCase","numberResource"),G(1),oe("ngSwitchCase","card"),G(1),oe("ngSwitchCase","card-stack"),G(1),oe("ngSwitchCase","terrain"),G(1),oe("ngSwitchCase","dice-symbol"),G(1),oe("ngSwitchCase","character"),G(4),oe("disabled",i.isSaveing),G(2),oe("ngClass",wt(12,mV,i.isSaveing)),G(2),oe("ngIf",i.isSaveing),G(1),oe("ngIf","character"===i.tabletopObject.aliasName),G(1),oe("ngIf",i.tabletopObject))},dependencies:[si,_i,Bn,fr,Ql,Zd,Xd,oo,so,$o,Mi,yi,LH,$i],styles:["[_nghost-%COMP%]{display:block}.main-image-box[_ngcontent-%COMP%]{width:250px;height:250px;z-index:0}.main-image[_ngcontent-%COMP%]{width:250px;-o-object-position:center bottom;object-position:center bottom}.image-showcase[_ngcontent-%COMP%]{vertical-align:top;text-align:left;position:absolute;display:inline-block;vertical-align:bottom;transform-origin:center bottom}.image-thumbnail[_ngcontent-%COMP%]{color:#000;filter:drop-shadow(1px 1px 0px rgb(255,244,232)) drop-shadow(-1px 1px 0px rgb(255,244,232)) drop-shadow(-1px -1px 0px rgb(255,244,232)) drop-shadow(1px -1px 0px rgb(255,244,232));z-index:100;vertical-align:bottom;transform-origin:center bottom;transition:all 132ms ease-in-out}.image-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;max-height:100px;position:absolute;left:0;right:0;bottom:0;margin:auto;-o-object-fit:contain;object-fit:contain;-o-object-position:center bottom;object-position:center bottom;transform-origin:center bottom}.image-thumbnail[_ngcontent-%COMP%]:hover{z-index:600}.image-thumbnail[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{width:75px;max-height:150px;left:-12px;transition:all 132ms ease-in-out}.image-thumbnail.hide[_ngcontent-%COMP%]{transform:scale3d(0,0,0)}.icons-box[_ngcontent-%COMP%]{vertical-align:top;text-align:center;position:absolute;left:216px;z-index:2}.icon-image-box[_ngcontent-%COMP%]{position:relative;width:50px;height:50px;max-width:50px;max-height:50px;border-radius:.5rem;color:#000;filter:drop-shadow(1px 1px 0px rgb(255,244,232)) drop-shadow(-1px 1px 0px rgb(255,244,232)) drop-shadow(-1px -1px 0px rgb(255,244,232)) drop-shadow(1px -1px 0px rgb(255,244,232));z-index:100;margin-top:1px;margin-left:-3px}.icon-image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:.5rem;border:2px solid transparent}.icon-image-box[_ngcontent-%COMP%]:hover{z-index:600}.icon-image-box[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{border:2px dotted rgba(255,0,0,40)}.icon-image-box.current-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid red}.icon-image-box[_ngcontent-%COMP%]{z-index:400}.shadow-image[_ngcontent-%COMP%]{position:absolute;width:50px;filter:brightness(0) blur(1px) drop-shadow(0px 0px 1px #fff);opacity:.7;margin-top:6px;margin-left:6px;z-index:5}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{display:table-row;box-sizing:border-box}.table-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:table-cell;border:1px solid #FFF;vertical-align:top;box-sizing:border-box}.box[_ngcontent-%COMP%]{display:inline-block;margin:5px;box-sizing:border-box}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px 0;padding:10px;flex:1 0 auto;box-sizing:border-box;min-width:25px;background-color:#eac99dcc;background-color:#f0dabdcc;color:#444;z-index:1}.flex-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{color:#ccc}.button-delete-icon[_ngcontent-%COMP%]{display:inline-block;position:absolute;margin:0;padding:2px 0 0;background-color:transparent;right:-3px;top:1px;height:18px;width:18px;font-size:8px;color:red}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #fff)}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}.text[_ngcontent-%COMP%]{transform-origin:left top;position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}"],data:{animation:[Vn("switchImage",[tn(":increment, :decrement",[Zt("200ms ease",bn([dt({transform:"scale3d(0, 0, 0)"}),dt({transform:"scale3d(0, 1.2, 1.2)"}),dt({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),Vn("showcase",[tn(":increment, :decrement",[Zt("200ms 200ms ease-in",bn([dt({transform:"scale3d(0, 1.0, 1.0)"}),dt({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),Vn("showcaseItem",[tn(":enter",[Zt("200ms ease",bn([dt({transform:"scale3d(0, 0, 0)"}),dt({transform:"scale3d(1.0, 1.0, 1.0)"})]))]),tn(":leave",[Zt("200ms ease",bn([dt({transform:"scale3d(1.0, 1.0, 1.0)"}),dt({transform:"scale3d(0, 0, 0)"})]))])]),Vn("bounceInOut",[tn("void => *",[Zt("600ms ease",bn([dt({transform:"scale3d(0, 0, 0)",offset:0}),dt({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),dt({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),dt({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),dt({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),tn("* => void",[Zt(100,dt({transform:"scale3d(0, 0, 0)"}))])])]}}),t})();const _V=["passwordInput"],$V=function(){return{standalone:!0}};let vV=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.password="",this.help="",this.targetPeerContext=null,this.title="",this.targetPeerContext=ki.parse(i.option.peerId?i.option.peerId:"???"),this.title=i.option.title?i.option.title:""}get peerId(){return Ot.peerId}get isConnected(){return!(Ot.peerIds.length<=1)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title=`\u30d1\u30b9\u30ef\u30fc\u30c9\u3008${this.title}\u3009`),Ue.register(this)}ngAfterViewInit(){this.passwordInputElementRef.nativeElement.focus()}ngOnDestroy(){Ue.unregister(this)}onInputChange(e){this.help=""}submit(){this.targetPeerContext.verifyPassword(this.password)&&this.modalService.resolve(this.password),this.help="\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u9055\u3044\u307e\u3059"}}return t.\u0275fac=function(e){return new(e||t)(He(qn),He(Yn))},t.\u0275cmp=fn({type:t,selectors:[["password-check"]],viewQuery:function(e,i){if(1&e&&wn(_V,7),2&e){let r;Cn(r=xn())&&(i.passwordInputElementRef=r.first)}},decls:11,vars:4,consts:[["passwordForm","ngForm"],["placeholder","\u30d1\u30b9\u30ef\u30fc\u30c9",3,"ngModel","ngModelOptions","ngModelChange","input"],["passwordInput",""],["type","submit",3,"click"],[2,"font-size","12px"]],template:function(e,i){1&e&&(Q(0,"form",null,0)(2,"div"),ve(3,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),Q(4,"input",1,2),Ae("ngModelChange",function(o){return i.password=o})("input",function(o){return i.onInputChange(o.target.value)}),ne()(),Q(6,"button",3),Ae("click",function(){return i.submit()}),ve(7,"\u5165\u5ba4"),ne()(),Q(8,"div")(9,"span",4),ve(10),ne()()),2&e&&(G(4),oe("ngModel",i.password)("ngModelOptions",xa(3,$V)),G(6),lt(i.help))},dependencies:[nc,Ii,Mi,tc,yi,Ma],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}"]}),t})();function bV(t,n){if(1&t&&(Q(0,"div")(1,"div",9),ve(2," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),ne(),Q(3,"div",9),ve(4," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),ne(),Q(5,"div",9),ve(6," \u30eb\u30fc\u30e0\u540d\u524d\u306e\u9577\u3055\u306f128\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),ne()()),2&t){me();const e=cn(4);G(1),oe("hidden",!e.errors.required),G(2),oe("hidden",!e.errors.minlength),G(2),oe("hidden",!e.errors.maxlength)}}function yV(t,n){if(1&t&&(Q(0,"div")(1,"div",9),ve(2," \u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u306f12\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),ne()()),2&t){me();const e=cn(8);G(1),oe("hidden",!e.errors.maxlength)}}function CV(t,n){1&t&&(Q(0,"div"),ve(1," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5408\u8a08\u304c\u9577\u3059\u304e\u308b\u3088\u3046\u3067\u3059\u3002\u3069\u3061\u3089\u304b\u3092\u5c11\u3057\u77ed\u304f\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002 "),ne())}function wV(t,n){if(1&t){const e=ft();Q(0,"div")(1,"div"),ve(2,"\u30eb\u30fc\u30e0\u540d : "),Q(3,"input",3,4),Ae("input",function(r){Re(e);const o=me();return Le(o.calcPeerId(r.target.value,o.password))})("ngModelChange",function(r){return Re(e),Le(me().roomName=r)}),ne()(),Q(5,"div"),ve(6,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),Q(7,"input",5,6),Ae("input",function(r){Re(e);const o=me();return Le(o.calcPeerId(o.roomName,r.target.value))})("ngModelChange",function(r){return Re(e),Le(me().password=r)}),ne()(),mt(9,"hr"),Te(10,bV,7,3,"div",7),Te(11,yV,3,1,"div",7),Te(12,CV,2,0,"div",7),Q(13,"div")(14,"button",8),Ae("click",function(){return Re(e),Le(me().createRoom())}),ve(15,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210"),ne()()()}if(2&t){const e=cn(4),i=cn(8),r=me();G(3),oe("ngModel",r.roomName),G(4),oe("ngModel",r.password),G(3),oe("ngIf",e.errors&&(e.dirty||e.touched)),G(1),oe("ngIf",i.errors&&(i.dirty||i.touched)),G(1),oe("ngIf",!r.validateLength),G(2),oe("disabled",!e.valid||!i.valid||!r.validateLength)}}function xV(t,n){1&t&&(Q(0,"span",1),ve(1,"\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u63a5\u7d9a\u3057\u305f\u307e\u307e\u3067\u306f\u30eb\u30fc\u30e0\u4f5c\u6210\u3092\u884c\u3048\u307e\u305b\u3093\u3002"),mt(2,"br"),ve(3,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),mt(4,"br"),ve(5,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),ne())}let EV=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.peers=[],this.isReloading=!1,this.roomName="\u3075\u3064\u3046\u306e\u90e8\u5c4b",this.password="",this.isPrivate=!1,this.validateLength=!1}get peerId(){return Ot.peerId}get isConnected(){return!(Ot.peerIds.length<=1)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30eb\u30fc\u30e0\u4f5c\u6210"),Ue.register(this),this.calcPeerId(this.roomName,this.password)}ngOnDestroy(){Ue.unregister(this)}calcPeerId(e,i){let r=Ot.peerContext?Ot.peerContext.userId:ki.generateId(),o=ki.create(r,ki.generateId("***"),e,i);this.validateLength=o.peerId.length<64}createRoom(){let e=Ot.peerContext?Ot.peerContext.userId:ki.generateId();Ot.open(e,ki.generateId("***"),this.roomName,this.password),Qe.myCursor.peerId=Ot.peerId,this.modalService.resolve()}}return t.\u0275fac=function(e){return new(e||t)(He(qn),He(Yn))},t.\u0275cmp=fn({type:t,selectors:[["room-setting"]],decls:6,vars:2,consts:[[4,"ngIf","ngIfElse"],[2,"font-size","12px"],["other_content",""],["required","","minlength","1","maxlength","128","placeholder","\u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808",1,"input",3,"ngModel","input","ngModelChange"],["roomNameValidation","ngModel"],["maxlength","12","placeholder","\u7a7a\u306a\u3089\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u3057",1,"input",3,"ngModel","input","ngModelChange"],["passwordValidation","ngModel"],[4,"ngIf"],[3,"disabled","click"],[3,"hidden"]],template:function(e,i){if(1&e&&(Te(0,wV,16,6,"div",0),Q(1,"div")(2,"span",1),ve(3,"\u203b\u4f5c\u6210\u3057\u305f\u30eb\u30fc\u30e0\u306f\u53c2\u52a0\u8005\u304c0\u4eba\u306b\u306a\u3063\u305f\u6642\u70b9\u3067\u89e3\u6563\u3057\u307e\u3059\u3002\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),ne()(),Te(4,xV,6,0,"ng-template",null,2,ti)),2&e){const r=cn(5);oe("ngIf",!i.isConnected)("ngIfElse",r)}},dependencies:[Bn,Ii,Mi,Dp,e0,t0,yi],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.input[_ngcontent-%COMP%]{width:100%}"]}),t})();function TV(t,n){1&t&&(Q(0,"td")(1,"i",11),ve(2,"lock"),ne()())}function SV(t,n){1&t&&(Q(0,"td"),ve(1,"-"),ne())}function IV(t,n){if(1&t){const e=ft();Q(0,"button",12),Ae("click",function(){Re(e);const r=me().$implicit;return Le(me(3).connect(r.peerContexts))}),ve(1,"\u63a5\u7d9a"),ne()}if(2&t){const e=me().$implicit,i=me(3);oe("disabled",(null==e.peerContexts[0]?null:e.peerContexts[0].roomId)===i.currentRoom)}}function MV(t,n){if(1&t&&(it(0),Q(1,"tr")(2,"td",9),ve(3),ne(),Q(4,"td",7),ve(5),ne(),Te(6,TV,3,0,"td",4),Te(7,SV,2,0,"td",4),Q(8,"td"),ve(9),ne(),Q(10,"td"),Te(11,IV,2,1,"button",10),ne()(),rt()),2&t){const e=n.$implicit;G(3),lt(null==e.peerContexts[0]?null:e.peerContexts[0].roomId),G(2),lt(e.roomName),G(1),oe("ngIf",e.peerContexts[0].hasPassword),G(1),oe("ngIf",!e.peerContexts[0].hasPassword),G(2),Zn("",e.peerContexts.length,"\u4eba"),G(2),oe("ngIf",0<e.alias.length)}}function kV(t,n){if(1&t&&(it(0),Q(1,"table",6)(2,"tr")(3,"th"),ve(4,"\u30eb\u30fc\u30e0ID"),ne(),Q(5,"th",7),ve(6,"\u30eb\u30fc\u30e0\u540d"),ne(),Q(7,"th"),ve(8,"\u30d1\u30b9\u30ef\u30fc\u30c9"),ne(),Q(9,"th"),ve(10,"\u53c2\u52a0\u8005"),ne(),mt(11,"th"),ne(),Te(12,MV,12,6,"ng-container",8),ne(),rt()),2&t){const e=me(2);G(12),oe("ngForOf",e.rooms)}}function DV(t,n){if(1&t&&(Q(0,"span",13),ve(1),ne()),2&t){const e=me(2);G(1),lt(e.help)}}function AV(t,n){if(1&t){const e=ft();Q(0,"div")(1,"button",2),Ae("click",function(){return Re(e),Le(me().reload())}),ve(2,"\u4e00\u89a7\u3092\u66f4\u65b0"),ne(),Q(3,"button",3),Ae("click",function(){return Re(e),Le(me().showRoomSetting())}),ve(4,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b"),ne(),mt(5,"hr"),Te(6,kV,13,1,"ng-container",4),Te(7,DV,2,1,"span",5),ne()}if(2&t){const e=me();G(1),oe("disabled",e.isReloading),G(5),oe("ngIf",e.rooms.length),G(1),oe("ngIf",e.rooms.length<1)}}function PV(t,n){1&t&&(Q(0,"span",13),ve(1,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),mt(2,"br"),ve(3,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),ne())}let NV=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.rooms=[],this.isReloading=!1,this.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"}get currentRoom(){return Ot.peerContext.roomId}get peerId(){return Ot.peerId}get isConnected(){return!(Ot.peerIds.length<=1)}ngOnInit(){Promise.resolve().then(()=>this.changeTitle()),Ue.register(this).on("OPEN_NETWORK",e=>{this.changeTitle()}).on("CONNECT_PEER",e=>{this.changeTitle()}),this.reload()}changeTitle(){this.modalService.title=this.panelService.title="\u30ed\u30d3\u30fc",Ot.peerContext.roomName.length&&(this.modalService.title=this.panelService.title="\u3008"+Ot.peerContext.roomName+"/"+Ot.peerContext.roomId+"\u3009")}ngOnDestroy(){Ue.unregister(this)}reload(){var e=this;return(0,gn.Z)(function*(){e.isReloading=!0,e.help="\u691c\u7d22\u4e2d...",e.rooms=[];let i={},r=yield Ot.listAllPeers();for(let o of r){let s=ki.parse(o);if(s.isRoom){let a=s.roomId+s.roomName;a in i||(i[a]=[]),i[a].push(s)}}for(let o in i)e.rooms.push({alias:o,roomName:i[o][0].roomName,peerContexts:i[o]});e.rooms.sort((o,s)=>o.alias<s.alias?-1:o.alias>s.alias?1:0),e.help="\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u300c\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b\u300d\u3067\u65b0\u898f\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002",e.isReloading=!1})()}connect(e){var i=this;return(0,gn.Z)(function*(){let r=e[0],o="";if(r.hasPassword&&(o=yield i.modalService.open(vV,{peerId:r.peerId,title:`${r.roomName}/${r.roomId}`}),null==o&&(o="")),!r.verifyPassword(o))return;let s=Ot.peerContext?Ot.peerContext.userId:ki.generateId();Ot.open(s,r.roomId,r.roomName,o),Qe.myCursor.peerId=Ot.peerId;let a=[];Ue.register(a).on("OPEN_NETWORK",h=>{console.log("LobbyComponent OPEN_PEER",h.data.peerId),Ue.unregister(a),Ct.instance.clearDeleteHistory();for(let b of e)Ot.connect(b.peerId);Ue.register(a).on("CONNECT_PEER",b=>{console.log("\u63a5\u7d9a\u6210\u529f\uff01",b.data.peerId),a.push(b.data.peerId),console.log("\u63a5\u7d9a\u6210\u529f "+a.length+"/"+e.length),e.length<=a.length&&(i.resetNetwork(),Ue.unregister(a),i.closeIfConnected())}).on("DISCONNECT_PEER",b=>{console.warn("\u63a5\u7d9a\u5931\u6557",b.data.peerId),a.push(b.data.peerId),console.warn("\u63a5\u7d9a\u5931\u6557 "+a.length+"/"+e.length),e.length<=a.length&&(i.resetNetwork(),Ue.unregister(a),i.closeIfConnected())})})})()}resetNetwork(){Ot.peerContexts.length<1&&(Ot.open(),Qe.myCursor.peerId=Ot.peerId)}closeIfConnected(){0<Ot.peerContexts.length&&this.modalService.resolve()}showRoomSetting(){var e=this;return(0,gn.Z)(function*(){yield e.modalService.open(EV,{width:700,height:400,left:0,top:400}),e.reload(),e.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"})()}}return t.\u0275fac=function(e){return new(e||t)(He(qn),He(Yn))},t.\u0275cmp=fn({type:t,selectors:[["lobby"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["other_content",""],[3,"disabled","click"],[3,"click"],[4,"ngIf"],["style","font-size: 12px;",4,"ngIf"],[1,"room-list"],[1,"room-name"],[4,"ngFor","ngForOf"],[1,"is-small-font"],["type","submit",3,"disabled","click",4,"ngIf"],[1,"material-icons",2,"vertical-align","middle","font-size","0.9rem"],["type","submit",3,"disabled","click"],[2,"font-size","12px"]],template:function(e,i){if(1&e&&(Te(0,AV,8,3,"div",0),Te(1,PV,4,0,"ng-template",null,1,ti)),2&e){const r=cn(2);oe("ngIf",!i.isConnected)("ngIfElse",r)}},dependencies:[_i,Bn],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.room-list[_ngcontent-%COMP%]{font-size:12px;border:0;border-spacing:0;padding:0;width:100%;max-width:100%;white-space:nowrap}.room-list[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:1px .5em;text-align:center}.room-name[_ngcontent-%COMP%]{white-space:normal;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;min-width:50%}.is-small-font[_ngcontent-%COMP%]{font-size:10px}"]}),t})();var gr_isObject=function OV(t){return"object"==typeof t&&null!==t},gr_repeat=function LV(t,n){var i,e="";for(i=0;i<n;i+=1)e+=t;return e},gr_isNegativeZero=function BV(t){return 0===t&&Number.NEGATIVE_INFINITY===1/t};function xS(t,n){var e="",i=t.reason||"(unknown reason)";return t.mark?(t.mark.name&&(e+='in "'+t.mark.name+'" '),e+="("+(t.mark.line+1)+":"+(t.mark.column+1)+")",!n&&t.mark.snippet&&(e+="\n\n"+t.mark.snippet),i+" "+e):i}function Rf(t,n){Error.call(this),this.name="YAMLException",this.reason=t,this.mark=n,this.message=xS(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}(Rf.prototype=Object.create(Error.prototype)).constructor=Rf,Rf.prototype.toString=function(n){return this.name+": "+xS(this,n)};var co=Rf;function wv(t,n,e,i,r){var o="",s="",a=Math.floor(r/2)-1;return i-n>a&&(n=i-a+(o=" ... ").length),e-i>a&&(e=i+a-(s=" ...").length),{str:o+t.slice(n,e).replace(/\t/g,"\u2192")+s,pos:i-n+o.length}}function xv(t,n){return gr_repeat(" ",n-t.length)+t}var KV=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],YV=["scalar","sequence","mapping"],kr=function XV(t,n){if(n=n||{},Object.keys(n).forEach(function(e){if(-1===KV.indexOf(e))throw new co('Unknown option "'+e+'" is met in definition of "'+t+'" YAML type.')}),this.options=n,this.tag=t,this.kind=n.kind||null,this.resolve=n.resolve||function(){return!0},this.construct=n.construct||function(e){return e},this.instanceOf=n.instanceOf||null,this.predicate=n.predicate||null,this.represent=n.represent||null,this.representName=n.representName||null,this.defaultStyle=n.defaultStyle||null,this.multi=n.multi||!1,this.styleAliases=function ZV(t){var n={};return null!==t&&Object.keys(t).forEach(function(e){t[e].forEach(function(i){n[String(i)]=e})}),n}(n.styleAliases||null),-1===YV.indexOf(this.kind))throw new co('Unknown kind "'+this.kind+'" is specified for "'+t+'" YAML type.')};function ES(t,n){var e=[];return t[n].forEach(function(i){var r=e.length;e.forEach(function(o,s){o.tag===i.tag&&o.kind===i.kind&&o.multi===i.multi&&(r=s)}),e[r]=i}),e}function Ev(t){return this.extend(t)}Ev.prototype.extend=function(n){var e=[],i=[];if(n instanceof kr)i.push(n);else if(Array.isArray(n))i=i.concat(n);else{if(!n||!Array.isArray(n.implicit)&&!Array.isArray(n.explicit))throw new co("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");n.implicit&&(e=e.concat(n.implicit)),n.explicit&&(i=i.concat(n.explicit))}e.forEach(function(o){if(!(o instanceof kr))throw new co("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(o.loadKind&&"scalar"!==o.loadKind)throw new co("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(o.multi)throw new co("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),i.forEach(function(o){if(!(o instanceof kr))throw new co("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var r=Object.create(Ev.prototype);return r.implicit=(this.implicit||[]).concat(e),r.explicit=(this.explicit||[]).concat(i),r.compiledImplicit=ES(r,"implicit"),r.compiledExplicit=ES(r,"explicit"),r.compiledTypeMap=function QV(){var n,e,t={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function i(r){r.multi?(t.multi[r.kind].push(r),t.multi.fallback.push(r)):t[r.kind][r.tag]=t.fallback[r.tag]=r}for(n=0,e=arguments.length;n<e;n+=1)arguments[n].forEach(i);return t}(r.compiledImplicit,r.compiledExplicit),r};var TS=Ev,SS=new kr("tag:yaml.org,2002:str",{kind:"scalar",construct:function(t){return null!==t?t:""}}),IS=new kr("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(t){return null!==t?t:[]}}),MS=new kr("tag:yaml.org,2002:map",{kind:"mapping",construct:function(t){return null!==t?t:{}}}),kS=new TS({explicit:[SS,IS,MS]}),DS=new kr("tag:yaml.org,2002:null",{kind:"scalar",resolve:function JV(t){if(null===t)return!0;var n=t.length;return 1===n&&"~"===t||4===n&&("null"===t||"Null"===t||"NULL"===t)},construct:function eG(){return null},predicate:function tG(t){return null===t},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"}),AS=new kr("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function nG(t){if(null===t)return!1;var n=t.length;return 4===n&&("true"===t||"True"===t||"TRUE"===t)||5===n&&("false"===t||"False"===t||"FALSE"===t)},construct:function iG(t){return"true"===t||"True"===t||"TRUE"===t},predicate:function rG(t){return"[object Boolean]"===Object.prototype.toString.call(t)},represent:{lowercase:function(t){return t?"true":"false"},uppercase:function(t){return t?"TRUE":"FALSE"},camelcase:function(t){return t?"True":"False"}},defaultStyle:"lowercase"});function oG(t){return 48<=t&&t<=57||65<=t&&t<=70||97<=t&&t<=102}function sG(t){return 48<=t&&t<=55}function aG(t){return 48<=t&&t<=57}var PS=new kr("tag:yaml.org,2002:int",{kind:"scalar",resolve:function lG(t){if(null===t)return!1;var r,n=t.length,e=0,i=!1;if(!n)return!1;if(("-"===(r=t[e])||"+"===r)&&(r=t[++e]),"0"===r){if(e+1===n)return!0;if("b"===(r=t[++e])){for(e++;e<n;e++)if("_"!==(r=t[e])){if("0"!==r&&"1"!==r)return!1;i=!0}return i&&"_"!==r}if("x"===r){for(e++;e<n;e++)if("_"!==(r=t[e])){if(!oG(t.charCodeAt(e)))return!1;i=!0}return i&&"_"!==r}if("o"===r){for(e++;e<n;e++)if("_"!==(r=t[e])){if(!sG(t.charCodeAt(e)))return!1;i=!0}return i&&"_"!==r}}if("_"===r)return!1;for(;e<n;e++)if("_"!==(r=t[e])){if(!aG(t.charCodeAt(e)))return!1;i=!0}return!(!i||"_"===r)},construct:function cG(t){var i,n=t,e=1;if(-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),("-"===(i=n[0])||"+"===i)&&("-"===i&&(e=-1),i=(n=n.slice(1))[0]),"0"===n)return 0;if("0"===i){if("b"===n[1])return e*parseInt(n.slice(2),2);if("x"===n[1])return e*parseInt(n.slice(2),16);if("o"===n[1])return e*parseInt(n.slice(2),8)}return e*parseInt(n,10)},predicate:function uG(t){return"[object Number]"===Object.prototype.toString.call(t)&&t%1==0&&!gr_isNegativeZero(t)},represent:{binary:function(t){return t>=0?"0b"+t.toString(2):"-0b"+t.toString(2).slice(1)},octal:function(t){return t>=0?"0o"+t.toString(8):"-0o"+t.toString(8).slice(1)},decimal:function(t){return t.toString(10)},hexadecimal:function(t){return t>=0?"0x"+t.toString(16).toUpperCase():"-0x"+t.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),dG=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),pG=/^[-+]?[0-9]+e/,NS=new kr("tag:yaml.org,2002:float",{kind:"scalar",resolve:function fG(t){return!(null===t||!dG.test(t)||"_"===t[t.length-1])},construct:function hG(t){var n,e;return e="-"===(n=t.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(n[0])>=0&&(n=n.slice(1)),".inf"===n?1===e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===n?NaN:e*parseFloat(n,10)},predicate:function mG(t){return"[object Number]"===Object.prototype.toString.call(t)&&(t%1!=0||gr_isNegativeZero(t))},represent:function gG(t,n){var e;if(isNaN(t))switch(n){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===t)switch(n){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===t)switch(n){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(gr_isNegativeZero(t))return"-0.0";return e=t.toString(10),pG.test(e)?e.replace("e",".e"):e},defaultStyle:"lowercase"}),FS=kS.extend({implicit:[DS,AS,PS,NS]}),RS=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),LS=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$"),BS=new kr("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function _G(t){return null!==t&&(null!==RS.exec(t)||null!==LS.exec(t))},construct:function $G(t){var n,e,i,r,o,s,a,ge,h=0,b=null;if(null===(n=RS.exec(t))&&(n=LS.exec(t)),null===n)throw new Error("Date resolve error");if(e=+n[1],i=+n[2]-1,r=+n[3],!n[4])return new Date(Date.UTC(e,i,r));if(o=+n[4],s=+n[5],a=+n[6],n[7]){for(h=n[7].slice(0,3);h.length<3;)h+="0";h=+h}return n[9]&&(b=6e4*(60*+n[10]+ +(n[11]||0)),"-"===n[9]&&(b=-b)),ge=new Date(Date.UTC(e,i,r,o,s,a,h)),b&&ge.setTime(ge.getTime()-b),ge},instanceOf:Date,represent:function vG(t){return t.toISOString()}}),zS=new kr("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function bG(t){return"<<"===t||null===t}}),Tv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r",jS=new kr("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function yG(t){if(null===t)return!1;var n,e,i=0,r=t.length,o=Tv;for(e=0;e<r;e++)if(!((n=o.indexOf(t.charAt(e)))>64)){if(n<0)return!1;i+=6}return i%8==0},construct:function CG(t){var n,e,i=t.replace(/[\r\n=]/g,""),r=i.length,o=Tv,s=0,a=[];for(n=0;n<r;n++)n%4==0&&n&&(a.push(s>>16&255),a.push(s>>8&255),a.push(255&s)),s=s<<6|o.indexOf(i.charAt(n));return 0==(e=r%4*6)?(a.push(s>>16&255),a.push(s>>8&255),a.push(255&s)):18===e?(a.push(s>>10&255),a.push(s>>2&255)):12===e&&a.push(s>>4&255),new Uint8Array(a)},predicate:function xG(t){return"[object Uint8Array]"===Object.prototype.toString.call(t)},represent:function wG(t){var i,r,n="",e=0,o=t.length,s=Tv;for(i=0;i<o;i++)i%3==0&&i&&(n+=s[e>>18&63],n+=s[e>>12&63],n+=s[e>>6&63],n+=s[63&e]),e=(e<<8)+t[i];return 0==(r=o%3)?(n+=s[e>>18&63],n+=s[e>>12&63],n+=s[e>>6&63],n+=s[63&e]):2===r?(n+=s[e>>10&63],n+=s[e>>4&63],n+=s[e<<2&63],n+=s[64]):1===r&&(n+=s[e>>2&63],n+=s[e<<4&63],n+=s[64],n+=s[64]),n}}),EG=Object.prototype.hasOwnProperty,TG=Object.prototype.toString,US=new kr("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function SG(t){if(null===t)return!0;var e,i,r,o,s,n=[],a=t;for(e=0,i=a.length;e<i;e+=1){if(s=!1,"[object Object]"!==TG.call(r=a[e]))return!1;for(o in r)if(EG.call(r,o)){if(s)return!1;s=!0}if(!s)return!1;if(-1!==n.indexOf(o))return!1;n.push(o)}return!0},construct:function IG(t){return null!==t?t:[]}}),MG=Object.prototype.toString,HS=new kr("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function kG(t){if(null===t)return!0;var n,e,i,r,o,s=t;for(o=new Array(s.length),n=0,e=s.length;n<e;n+=1){if("[object Object]"!==MG.call(i=s[n])||1!==(r=Object.keys(i)).length)return!1;o[n]=[r[0],i[r[0]]]}return!0},construct:function DG(t){if(null===t)return[];var n,e,i,r,o,s=t;for(o=new Array(s.length),n=0,e=s.length;n<e;n+=1)i=s[n],r=Object.keys(i),o[n]=[r[0],i[r[0]]];return o}}),AG=Object.prototype.hasOwnProperty,VS=new kr("tag:yaml.org,2002:set",{kind:"mapping",resolve:function PG(t){if(null===t)return!0;var n,e=t;for(n in e)if(AG.call(e,n)&&null!==e[n])return!1;return!0},construct:function NG(t){return null!==t?t:{}}}),Sv=FS.extend({implicit:[BS,zS],explicit:[jS,US,HS,VS]}),yl=Object.prototype.hasOwnProperty,FG=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,RG=/[\x85\u2028\u2029]/,LG=/[,\[\]\{\}]/,KS=/^(?:!|!!|![a-z\-]+!)$/i,YS=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function ZS(t){return Object.prototype.toString.call(t)}function ua(t){return 10===t||13===t}function yc(t){return 9===t||32===t}function Co(t){return 9===t||32===t||10===t||13===t}function Bu(t){return 44===t||91===t||93===t||123===t||125===t}function BG(t){var n;return 48<=t&&t<=57?t-48:97<=(n=32|t)&&n<=102?n-97+10:-1}function zG(t){return 120===t?2:117===t?4:85===t?8:0}function jG(t){return 48<=t&&t<=57?t-48:-1}function XS(t){return 48===t?"\0":97===t?"\x07":98===t?"\b":116===t||9===t?"\t":110===t?"\n":118===t?"\v":102===t?"\f":114===t?"\r":101===t?"\x1b":32===t?" ":34===t?'"':47===t?"/":92===t?"\\":78===t?"\x85":95===t?"\xa0":76===t?"\u2028":80===t?"\u2029":""}function UG(t){return t<=65535?String.fromCharCode(t):String.fromCharCode(55296+(t-65536>>10),56320+(t-65536&1023))}for(var QS=new Array(256),JS=new Array(256),zu=0;zu<256;zu++)QS[zu]=XS(zu)?1:0,JS[zu]=XS(zu);function HG(t,n){this.input=t,this.filename=n.filename||null,this.schema=n.schema||Sv,this.onWarning=n.onWarning||null,this.legacy=n.legacy||!1,this.json=n.json||!1,this.listener=n.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=t.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function eI(t,n){var e={name:t.filename,buffer:t.input.slice(0,-1),position:t.position,line:t.line,column:t.position-t.lineStart};return e.snippet=function qV(t,n){if(n=Object.create(n||null),!t.buffer)return null;n.maxLength||(n.maxLength=79),"number"!=typeof n.indent&&(n.indent=1),"number"!=typeof n.linesBefore&&(n.linesBefore=3),"number"!=typeof n.linesAfter&&(n.linesAfter=2);for(var o,e=/\r?\n|\r|\0/g,i=[0],r=[],s=-1;o=e.exec(t.buffer);)r.push(o.index),i.push(o.index+o[0].length),t.position<=o.index&&s<0&&(s=i.length-2);s<0&&(s=i.length-1);var h,b,a="",ee=Math.min(t.line+n.linesAfter,r.length).toString().length,de=n.maxLength-(n.indent+ee+3);for(h=1;h<=n.linesBefore&&!(s-h<0);h++)b=wv(t.buffer,i[s-h],r[s-h],t.position-(i[s]-i[s-h]),de),a=gr_repeat(" ",n.indent)+xv((t.line-h+1).toString(),ee)+" | "+b.str+"\n"+a;for(b=wv(t.buffer,i[s],r[s],t.position,de),a+=gr_repeat(" ",n.indent)+xv((t.line+1).toString(),ee)+" | "+b.str+"\n",a+=gr_repeat("-",n.indent+ee+3+b.pos)+"^\n",h=1;h<=n.linesAfter&&!(s+h>=r.length);h++)b=wv(t.buffer,i[s+h],r[s+h],t.position-(i[s]-i[s+h]),de),a+=gr_repeat(" ",n.indent)+xv((t.line+h+1).toString(),ee)+" | "+b.str+"\n";return a.replace(/\n$/,"")}(e),new co(n,e)}function an(t,n){throw eI(t,n)}function Mg(t,n){t.onWarning&&t.onWarning.call(null,eI(t,n))}var tI={YAML:function(n,e,i){var r,o,s;null!==n.version&&an(n,"duplication of %YAML directive"),1!==i.length&&an(n,"YAML directive accepts exactly one argument"),null===(r=/^([0-9]+)\.([0-9]+)$/.exec(i[0]))&&an(n,"ill-formed argument of the YAML directive"),o=parseInt(r[1],10),s=parseInt(r[2],10),1!==o&&an(n,"unacceptable YAML version of the document"),n.version=i[0],n.checkLineBreaks=s<2,1!==s&&2!==s&&Mg(n,"unsupported YAML version of the document")},TAG:function(n,e,i){var r,o;2!==i.length&&an(n,"TAG directive accepts exactly two arguments"),o=i[1],KS.test(r=i[0])||an(n,"ill-formed tag handle (first argument) of the TAG directive"),yl.call(n.tagMap,r)&&an(n,'there is a previously declared suffix for "'+r+'" tag handle'),YS.test(o)||an(n,"ill-formed tag prefix (second argument) of the TAG directive");try{o=decodeURIComponent(o)}catch{an(n,"tag prefix is malformed: "+o)}n.tagMap[r]=o}};function Cl(t,n,e,i){var r,o,s,a;if(n<e){if(a=t.input.slice(n,e),i)for(r=0,o=a.length;r<o;r+=1)9===(s=a.charCodeAt(r))||32<=s&&s<=1114111||an(t,"expected valid JSON character");else FG.test(a)&&an(t,"the stream contains non-printable characters");t.result+=a}}function nI(t,n,e,i){var r,o,s,a;for(gr_isObject(e)||an(t,"cannot merge mappings; the provided source object is unacceptable"),s=0,a=(r=Object.keys(e)).length;s<a;s+=1)yl.call(n,o=r[s])||(n[o]=e[o],i[o]=!0)}function ju(t,n,e,i,r,o,s,a,h){var b,ee;if(Array.isArray(r))for(b=0,ee=(r=Array.prototype.slice.call(r)).length;b<ee;b+=1)Array.isArray(r[b])&&an(t,"nested arrays are not supported inside keys"),"object"==typeof r&&"[object Object]"===ZS(r[b])&&(r[b]="[object Object]");if("object"==typeof r&&"[object Object]"===ZS(r)&&(r="[object Object]"),r=String(r),null===n&&(n={}),"tag:yaml.org,2002:merge"===i)if(Array.isArray(o))for(b=0,ee=o.length;b<ee;b+=1)nI(t,n,o[b],e);else nI(t,n,o,e);else!t.json&&!yl.call(e,r)&&yl.call(n,r)&&(t.line=s||t.line,t.lineStart=a||t.lineStart,t.position=h||t.position,an(t,"duplicated mapping key")),"__proto__"===r?Object.defineProperty(n,r,{configurable:!0,enumerable:!0,writable:!0,value:o}):n[r]=o,delete e[r];return n}function Mv(t){var n;10===(n=t.input.charCodeAt(t.position))?t.position++:13===n?(t.position++,10===t.input.charCodeAt(t.position)&&t.position++):an(t,"a line break is expected"),t.line+=1,t.lineStart=t.position,t.firstTabInLine=-1}function rr(t,n,e){for(var i=0,r=t.input.charCodeAt(t.position);0!==r;){for(;yc(r);)9===r&&-1===t.firstTabInLine&&(t.firstTabInLine=t.position),r=t.input.charCodeAt(++t.position);if(n&&35===r)do{r=t.input.charCodeAt(++t.position)}while(10!==r&&13!==r&&0!==r);if(!ua(r))break;for(Mv(t),r=t.input.charCodeAt(t.position),i++,t.lineIndent=0;32===r;)t.lineIndent++,r=t.input.charCodeAt(++t.position)}return-1!==e&&0!==i&&t.lineIndent<e&&Mg(t,"deficient indentation"),i}function kg(t){var e,n=t.position;return!(45!==(e=t.input.charCodeAt(n))&&46!==e||e!==t.input.charCodeAt(n+1)||e!==t.input.charCodeAt(n+2)||(n+=3,e=t.input.charCodeAt(n),0!==e&&!Co(e)))}function kv(t,n){1===n?t.result+=" ":n>1&&(t.result+=gr_repeat("\n",n-1))}function iI(t,n){var e,h,i=t.tag,r=t.anchor,o=[],a=!1;if(-1!==t.firstTabInLine)return!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=o),h=t.input.charCodeAt(t.position);0!==h&&(-1!==t.firstTabInLine&&(t.position=t.firstTabInLine,an(t,"tab characters must not be used in indentation")),45===h&&Co(t.input.charCodeAt(t.position+1)));)if(a=!0,t.position++,rr(t,!0,-1)&&t.lineIndent<=n)o.push(null),h=t.input.charCodeAt(t.position);else if(e=t.line,Uu(t,n,3,!1,!0),o.push(t.result),rr(t,!0,-1),h=t.input.charCodeAt(t.position),(t.line===e||t.lineIndent>n)&&0!==h)an(t,"bad indentation of a sequence entry");else if(t.lineIndent<n)break;return!!a&&(t.tag=i,t.anchor=r,t.kind="sequence",t.result=o,!0)}function ZG(t){var n,r,o,s,e=!1,i=!1;if(33!==(s=t.input.charCodeAt(t.position)))return!1;if(null!==t.tag&&an(t,"duplication of a tag property"),60===(s=t.input.charCodeAt(++t.position))?(e=!0,s=t.input.charCodeAt(++t.position)):33===s?(i=!0,r="!!",s=t.input.charCodeAt(++t.position)):r="!",n=t.position,e){do{s=t.input.charCodeAt(++t.position)}while(0!==s&&62!==s);t.position<t.length?(o=t.input.slice(n,t.position),s=t.input.charCodeAt(++t.position)):an(t,"unexpected end of the stream within a verbatim tag")}else{for(;0!==s&&!Co(s);)33===s&&(i?an(t,"tag suffix cannot contain exclamation marks"):(r=t.input.slice(n-1,t.position+1),KS.test(r)||an(t,"named tag handle cannot contain such characters"),i=!0,n=t.position+1)),s=t.input.charCodeAt(++t.position);o=t.input.slice(n,t.position),LG.test(o)&&an(t,"tag suffix cannot contain flow indicator characters")}o&&!YS.test(o)&&an(t,"tag name cannot contain such characters: "+o);try{o=decodeURIComponent(o)}catch{an(t,"tag name is malformed: "+o)}return e?t.tag=o:yl.call(t.tagMap,r)?t.tag=t.tagMap[r]+o:"!"===r?t.tag="!"+o:"!!"===r?t.tag="tag:yaml.org,2002:"+o:an(t,'undeclared tag handle "'+r+'"'),!0}function XG(t){var n,e;if(38!==(e=t.input.charCodeAt(t.position)))return!1;for(null!==t.anchor&&an(t,"duplication of an anchor property"),e=t.input.charCodeAt(++t.position),n=t.position;0!==e&&!Co(e)&&!Bu(e);)e=t.input.charCodeAt(++t.position);return t.position===n&&an(t,"name of an anchor node must contain at least one character"),t.anchor=t.input.slice(n,t.position),!0}function Uu(t,n,e,i,r){var o,s,a,de,ge,xe,ke,Pe,Oe,h=1,b=!1,ee=!1;if(null!==t.listener&&t.listener("open",t),t.tag=null,t.anchor=null,t.kind=null,t.result=null,o=s=a=4===e||3===e,i&&rr(t,!0,-1)&&(b=!0,t.lineIndent>n?h=1:t.lineIndent===n?h=0:t.lineIndent<n&&(h=-1)),1===h)for(;ZG(t)||XG(t);)rr(t,!0,-1)?(b=!0,a=o,t.lineIndent>n?h=1:t.lineIndent===n?h=0:t.lineIndent<n&&(h=-1)):a=!1;if(a&&(a=b||r),(1===h||4===e)&&(Pe=1===e||2===e?n:n+1,Oe=t.position-t.lineStart,1===h?a&&(iI(t,Oe)||function YG(t,n,e){var i,r,o,s,a,h,qe,b=t.tag,ee=t.anchor,de={},ge=Object.create(null),xe=null,ke=null,Pe=null,Oe=!1,je=!1;if(-1!==t.firstTabInLine)return!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=de),qe=t.input.charCodeAt(t.position);0!==qe;){if(!Oe&&-1!==t.firstTabInLine&&(t.position=t.firstTabInLine,an(t,"tab characters must not be used in indentation")),i=t.input.charCodeAt(t.position+1),o=t.line,63!==qe&&58!==qe||!Co(i)){if(s=t.line,a=t.lineStart,h=t.position,!Uu(t,e,2,!1,!0))break;if(t.line===o){for(qe=t.input.charCodeAt(t.position);yc(qe);)qe=t.input.charCodeAt(++t.position);if(58===qe)Co(qe=t.input.charCodeAt(++t.position))||an(t,"a whitespace character is expected after the key-value separator within a block mapping"),Oe&&(ju(t,de,ge,xe,ke,null,s,a,h),xe=ke=Pe=null),je=!0,Oe=!1,r=!1,xe=t.tag,ke=t.result;else{if(!je)return t.tag=b,t.anchor=ee,!0;an(t,"can not read an implicit mapping pair; a colon is missed")}}else{if(!je)return t.tag=b,t.anchor=ee,!0;an(t,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===qe?(Oe&&(ju(t,de,ge,xe,ke,null,s,a,h),xe=ke=Pe=null),je=!0,Oe=!0,r=!0):Oe?(Oe=!1,r=!0):an(t,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),t.position+=1,qe=i;if((t.line===o||t.lineIndent>n)&&(Oe&&(s=t.line,a=t.lineStart,h=t.position),Uu(t,n,4,!0,r)&&(Oe?ke=t.result:Pe=t.result),Oe||(ju(t,de,ge,xe,ke,Pe,s,a,h),xe=ke=Pe=null),rr(t,!0,-1),qe=t.input.charCodeAt(t.position)),(t.line===o||t.lineIndent>n)&&0!==qe)an(t,"bad indentation of a mapping entry");else if(t.lineIndent<n)break}return Oe&&ju(t,de,ge,xe,ke,null,s,a,h),je&&(t.tag=b,t.anchor=ee,t.kind="mapping",t.result=de),je}(t,Oe,Pe))||function WG(t,n){var i,r,o,a,ee,de,ge,xe,Pe,Oe,je,qe,e=!0,s=t.tag,h=t.anchor,ke=Object.create(null);if(91===(qe=t.input.charCodeAt(t.position)))ee=93,xe=!1,a=[];else{if(123!==qe)return!1;ee=125,xe=!0,a={}}for(null!==t.anchor&&(t.anchorMap[t.anchor]=a),qe=t.input.charCodeAt(++t.position);0!==qe;){if(rr(t,!0,n),(qe=t.input.charCodeAt(t.position))===ee)return t.position++,t.tag=s,t.anchor=h,t.kind=xe?"mapping":"sequence",t.result=a,!0;e?44===qe&&an(t,"expected the node content, but found ','"):an(t,"missed comma between flow collection entries"),je=null,de=ge=!1,63===qe&&Co(t.input.charCodeAt(t.position+1))&&(de=ge=!0,t.position++,rr(t,!0,n)),i=t.line,r=t.lineStart,o=t.position,Uu(t,n,1,!1,!0),Oe=t.tag,Pe=t.result,rr(t,!0,n),qe=t.input.charCodeAt(t.position),(ge||t.line===i)&&58===qe&&(de=!0,qe=t.input.charCodeAt(++t.position),rr(t,!0,n),Uu(t,n,1,!1,!0),je=t.result),xe?ju(t,a,ke,Oe,Pe,je,i,r,o):a.push(de?ju(t,null,ke,Oe,Pe,je,i,r,o):Pe),rr(t,!0,n),44===(qe=t.input.charCodeAt(t.position))?(e=!0,qe=t.input.charCodeAt(++t.position)):e=!1}an(t,"unexpected end of the stream within a flow collection")}(t,Pe)?ee=!0:(s&&function KG(t,n){var e,i,ee,de,r=1,o=!1,s=!1,a=n,h=0,b=!1;if(124===(de=t.input.charCodeAt(t.position)))i=!1;else{if(62!==de)return!1;i=!0}for(t.kind="scalar",t.result="";0!==de;)if(43===(de=t.input.charCodeAt(++t.position))||45===de)1===r?r=43===de?3:2:an(t,"repeat of a chomping mode identifier");else{if(!((ee=jG(de))>=0))break;0===ee?an(t,"bad explicit indentation width of a block scalar; it cannot be less than one"):s?an(t,"repeat of an indentation width identifier"):(a=n+ee-1,s=!0)}if(yc(de)){do{de=t.input.charCodeAt(++t.position)}while(yc(de));if(35===de)do{de=t.input.charCodeAt(++t.position)}while(!ua(de)&&0!==de)}for(;0!==de;){for(Mv(t),t.lineIndent=0,de=t.input.charCodeAt(t.position);(!s||t.lineIndent<a)&&32===de;)t.lineIndent++,de=t.input.charCodeAt(++t.position);if(!s&&t.lineIndent>a&&(a=t.lineIndent),ua(de))h++;else{if(t.lineIndent<a){3===r?t.result+=gr_repeat("\n",o?1+h:h):1===r&&o&&(t.result+="\n");break}for(i?yc(de)?(b=!0,t.result+=gr_repeat("\n",o?1+h:h)):b?(b=!1,t.result+=gr_repeat("\n",h+1)):0===h?o&&(t.result+=" "):t.result+=gr_repeat("\n",h):t.result+=gr_repeat("\n",o?1+h:h),o=!0,s=!0,h=0,e=t.position;!ua(de)&&0!==de;)de=t.input.charCodeAt(++t.position);Cl(t,e,t.position,!1)}}return!0}(t,Pe)||function GG(t,n){var e,i,r;if(39!==(e=t.input.charCodeAt(t.position)))return!1;for(t.kind="scalar",t.result="",t.position++,i=r=t.position;0!==(e=t.input.charCodeAt(t.position));)if(39===e){if(Cl(t,i,t.position,!0),39!==(e=t.input.charCodeAt(++t.position)))return!0;i=t.position,t.position++,r=t.position}else ua(e)?(Cl(t,i,r,!0),kv(t,rr(t,!1,n)),i=r=t.position):t.position===t.lineStart&&kg(t)?an(t,"unexpected end of the document within a single quoted scalar"):(t.position++,r=t.position);an(t,"unexpected end of the stream within a single quoted scalar")}(t,Pe)||function qG(t,n){var e,i,r,o,s,a;if(34!==(a=t.input.charCodeAt(t.position)))return!1;for(t.kind="scalar",t.result="",t.position++,e=i=t.position;0!==(a=t.input.charCodeAt(t.position));){if(34===a)return Cl(t,e,t.position,!0),t.position++,!0;if(92===a){if(Cl(t,e,t.position,!0),ua(a=t.input.charCodeAt(++t.position)))rr(t,!1,n);else if(a<256&&QS[a])t.result+=JS[a],t.position++;else if((s=zG(a))>0){for(r=s,o=0;r>0;r--)(s=BG(a=t.input.charCodeAt(++t.position)))>=0?o=(o<<4)+s:an(t,"expected hexadecimal character");t.result+=UG(o),t.position++}else an(t,"unknown escape sequence");e=i=t.position}else ua(a)?(Cl(t,e,i,!0),kv(t,rr(t,!1,n)),e=i=t.position):t.position===t.lineStart&&kg(t)?an(t,"unexpected end of the document within a double quoted scalar"):(t.position++,i=t.position)}an(t,"unexpected end of the stream within a double quoted scalar")}(t,Pe)?ee=!0:function QG(t){var n,e,i;if(42!==(i=t.input.charCodeAt(t.position)))return!1;for(i=t.input.charCodeAt(++t.position),n=t.position;0!==i&&!Co(i)&&!Bu(i);)i=t.input.charCodeAt(++t.position);return t.position===n&&an(t,"name of an alias node must contain at least one character"),e=t.input.slice(n,t.position),yl.call(t.anchorMap,e)||an(t,'unidentified alias "'+e+'"'),t.result=t.anchorMap[e],rr(t,!0,-1),!0}(t)?(ee=!0,(null!==t.tag||null!==t.anchor)&&an(t,"alias node should not have any properties")):function VG(t,n,e){var r,o,s,a,h,b,ee,xe,de=t.kind,ge=t.result;if(Co(xe=t.input.charCodeAt(t.position))||Bu(xe)||35===xe||38===xe||42===xe||33===xe||124===xe||62===xe||39===xe||34===xe||37===xe||64===xe||96===xe||(63===xe||45===xe)&&(Co(r=t.input.charCodeAt(t.position+1))||e&&Bu(r)))return!1;for(t.kind="scalar",t.result="",o=s=t.position,a=!1;0!==xe;){if(58===xe){if(Co(r=t.input.charCodeAt(t.position+1))||e&&Bu(r))break}else if(35===xe){if(Co(t.input.charCodeAt(t.position-1)))break}else{if(t.position===t.lineStart&&kg(t)||e&&Bu(xe))break;if(ua(xe)){if(h=t.line,b=t.lineStart,ee=t.lineIndent,rr(t,!1,-1),t.lineIndent>=n){a=!0,xe=t.input.charCodeAt(t.position);continue}t.position=s,t.line=h,t.lineStart=b,t.lineIndent=ee;break}}a&&(Cl(t,o,s,!1),kv(t,t.line-h),o=s=t.position,a=!1),yc(xe)||(s=t.position+1),xe=t.input.charCodeAt(++t.position)}return Cl(t,o,s,!1),!!t.result||(t.kind=de,t.result=ge,!1)}(t,Pe,1===e)&&(ee=!0,null===t.tag&&(t.tag="?")),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):0===h&&(ee=a&&iI(t,Oe))),null===t.tag)null!==t.anchor&&(t.anchorMap[t.anchor]=t.result);else if("?"===t.tag){for(null!==t.result&&"scalar"!==t.kind&&an(t,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+t.kind+'"'),de=0,ge=t.implicitTypes.length;de<ge;de+=1)if((ke=t.implicitTypes[de]).resolve(t.result)){t.result=ke.construct(t.result),t.tag=ke.tag,null!==t.anchor&&(t.anchorMap[t.anchor]=t.result);break}}else if("!"!==t.tag){if(yl.call(t.typeMap[t.kind||"fallback"],t.tag))ke=t.typeMap[t.kind||"fallback"][t.tag];else for(ke=null,de=0,ge=(xe=t.typeMap.multi[t.kind||"fallback"]).length;de<ge;de+=1)if(t.tag.slice(0,xe[de].tag.length)===xe[de].tag){ke=xe[de];break}ke||an(t,"unknown tag !<"+t.tag+">"),null!==t.result&&ke.kind!==t.kind&&an(t,"unacceptable node kind for !<"+t.tag+'> tag; it should be "'+ke.kind+'", not "'+t.kind+'"'),ke.resolve(t.result,t.tag)?(t.result=ke.construct(t.result,t.tag),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):an(t,"cannot resolve a node with !<"+t.tag+"> explicit tag")}return null!==t.listener&&t.listener("close",t),null!==t.tag||null!==t.anchor||ee}function JG(t){var e,i,r,s,n=t.position,o=!1;for(t.version=null,t.checkLineBreaks=t.legacy,t.tagMap=Object.create(null),t.anchorMap=Object.create(null);0!==(s=t.input.charCodeAt(t.position))&&(rr(t,!0,-1),s=t.input.charCodeAt(t.position),!(t.lineIndent>0||37!==s));){for(o=!0,s=t.input.charCodeAt(++t.position),e=t.position;0!==s&&!Co(s);)s=t.input.charCodeAt(++t.position);for(r=[],(i=t.input.slice(e,t.position)).length<1&&an(t,"directive name must not be less than one character in length");0!==s;){for(;yc(s);)s=t.input.charCodeAt(++t.position);if(35===s){do{s=t.input.charCodeAt(++t.position)}while(0!==s&&!ua(s));break}if(ua(s))break;for(e=t.position;0!==s&&!Co(s);)s=t.input.charCodeAt(++t.position);r.push(t.input.slice(e,t.position))}0!==s&&Mv(t),yl.call(tI,i)?tI[i](t,i,r):Mg(t,'unknown document directive "'+i+'"')}rr(t,!0,-1),0===t.lineIndent&&45===t.input.charCodeAt(t.position)&&45===t.input.charCodeAt(t.position+1)&&45===t.input.charCodeAt(t.position+2)?(t.position+=3,rr(t,!0,-1)):o&&an(t,"directives end mark is expected"),Uu(t,t.lineIndent-1,4,!1,!0),rr(t,!0,-1),t.checkLineBreaks&&RG.test(t.input.slice(n,t.position))&&Mg(t,"non-ASCII line breaks are interpreted as content"),t.documents.push(t.result),t.position===t.lineStart&&kg(t)?46===t.input.charCodeAt(t.position)&&(t.position+=3,rr(t,!0,-1)):t.position<t.length-1&&an(t,"end of the stream or a document separator is expected")}function rI(t,n){n=n||{},0!==(t=String(t)).length&&(10!==t.charCodeAt(t.length-1)&&13!==t.charCodeAt(t.length-1)&&(t+="\n"),65279===t.charCodeAt(0)&&(t=t.slice(1)));var e=new HG(t,n),i=t.indexOf("\0");for(-1!==i&&(e.position=i,an(e,"null byte is not allowed in input")),e.input+="\0";32===e.input.charCodeAt(e.position);)e.lineIndent+=1,e.position+=1;for(;e.position<e.length-1;)JG(e);return e.documents}var oI_load=function tq(t,n){var e=rI(t,n);if(0!==e.length){if(1===e.length)return e[0];throw new co("expected a single document in the stream, but found more")}};function Fv(t,n){return function(){throw new Error("Function yaml."+t+" is removed in js-yaml 4. Use yaml."+n+" instead, which is now safe by default.")}}var EI=oI_load;Fv("safeLoad","load"),Fv("safeLoadAll","loadAll"),Fv("safeDump","dump");const TI=Object.getOwnPropertyNames(Object.prototype),Jq=Object.getOwnPropertyNames(Array.prototype);let Rv=(()=>{class t{constructor(){this.peerHistory=[],this.isOpen=!1}initialize(){this.initAppConfig()}initAppConfig(){var e=this;return(0,gn.Z)(function*(){try{console.log("YAML\u8aad\u307f\u8fbc\u307f...");let i=yield e.loadYaml(),r=EI(i);t.applyConfig(r)}catch(i){console.warn(i)}Ue.trigger("LOAD_CONFIG",t.appConfig)})()}loadYaml(){return(0,gn.Z)(function*(){let e=document.querySelector('script[type$="yaml"]');if(!e)return console.warn("loadYaml element not found."),"";let i=e.getAttribute("src");return null==i?(console.warn("loadYaml url undefined."),e.textContent):(yield fetch(i)).text()})()}static applyConfig(e,i=t.appConfig){if(null==e)return i;let r=Object.getOwnPropertyNames(e);for(let o of r)(Array.isArray(e)||Array.isArray(i)?TI.concat(Jq):TI).includes(o)?console.log(`skip invalid key (${o})`):null!=e[o]&&"object"==typeof e[o]?(null==i[o]&&(i[o]=Array.isArray(e[o])?[]:{}),t.applyConfig(e[o],i[o])):"function"!=typeof e[o]&&"function"!=typeof i[o]&&(i[o]=e[o]);return i}}return t.appConfig={webrtc:{key:""},app:{title:"",mode:""},dice:{url:"",api:1}},t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=$n({token:t,factory:t.\u0275fac}),t})();function eW(t,n){if(1&t){const e=ft();Q(0,"div",12),Ae("click",function(){return Re(e),Le(me(2).changeIcon())}),Lt(1,"safe"),ne()}2&t&&ut("background-image",Bt(1,2,"url("+me(2).myPeer.image.url+")","style"))}const tW=function(t){return{"i-am-gm":t}};function nW(t,n){if(1&t){const e=ft();Q(0,"div")(1,"div",3),Te(2,eW,2,5,"div",4),Q(3,"div")(4,"label",5)(5,"b",6)(6,"input",7),Ae("click",function(r){return Re(e),Le(me().onGMMode(r))}),ne(),ve(7),ne()(),mt(8,"br"),Q(9,"button",8),Ae("click",function(){return Re(e),Le(me().changeIcon())}),ve(10,"\u30d7\u30ec\u30a4\u30e4\u30fc\u30a2\u30a4\u30b3\u30f3\u5909\u66f4"),ne()()(),Q(11,"div"),ve(12," \u3042\u306a\u305f\u306e\u8272\u3068\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\uff1a"),Q(13,"input",9),Ae("ngModelChange",function(r){return Re(e),Le(me().myPeerColor=r)}),ne(),Q(14,"input",10),Ae("ngModelChange",function(r){return Re(e),Le(me().myPeerName=r)}),ne(),mt(15,"br"),Q(16,"small"),ve(17,"\u203b\u6700\u5f8c\u306b\u4f7f\u3063\u305f\u30a2\u30a4\u30b3\u30f3\u3001\u8272\u3001\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\u3092\u30d6\u30e9\u30a6\u30b6\u306b\u4fdd\u5b58\u3057\u307e\u3059\u3002"),ne(),mt(18,"br"),Q(19,"span",11),ve(20,"\u8272\u3092\u521d\u671f\u5024\u306b\u623b\u3059\u969b\u306f\u767d(255,255,255)\u3092\u9078\u629e\u3002"),ne()()()}if(2&t){const e=me();G(2),oe("ngIf",e.myPeer.image),G(2),oe("ngClass",wt(8,tW,e.isGMMode||e.isGMHold)),G(2),xt("checked",e.isGMMode||e.isGMHold?"checked":""),G(1),lt(e.isGMMode?"\u73fe\u5728GM\u30e2\u30fc\u30c9\u3067\u3059":e.isGMHold?"GM\u30e2\u30fc\u30c9\u4fdd\u7559\u4e2d":"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b"),G(6),oe("ngModel",e.myPeerColor),G(1),ut("color",e.myPeerColor),oe("ngModel",e.myPeerName)}}function iW(t,n){if(1&t){const e=ft();Q(0,"button",18),Ae("click",function(){return Re(e),Le(me(2).copyPeerId())}),Q(1,"b",19),ve(2,"content_copy"),ne()()}2&t&&oe("disabled",me(2).isCopied)}function rW(t,n){if(1&t&&(it(0),Q(1,"span",13)(2,"span",14),ve(3),ne(),mt(4,"input",15),ne(),Te(5,iW,3,1,"button",16),Q(6,"span",17),ve(7),ne(),rt()),2&t){const e=me();G(3),lt(e.networkService.peerContext.userId),G(1),xt("value",e.networkService.peerContext.userId),G(1),oe("ngIf",e.isAbleClipboardCopy),G(1),ut("color",e.myPeerColor),oe("@fadeInOut",e.isCopied),G(1),Zn(" ",e.isCopied?"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002":"","")}}function oW(t,n){1&t&&(Q(0,"span",20),ve(1,"???"),ne())}function sW(t,n){if(1&t){const e=ft();Q(0,"button",18),Ae("click",function(){return Re(e),Le(me(3).copyRoomName())}),Q(1,"b",19),ve(2,"content_copy"),ne()()}2&t&&oe("disabled",me(3).isRoomNameCopied)}function aW(t,n){if(1&t&&(it(0),Q(1,"span",13)(2,"span",21),ve(3),ne(),mt(4,"input",22),ne(),Te(5,sW,3,1,"button",16),Q(6,"span",17),ve(7),ne(),rt()),2&t){const e=me(2);G(3),Ja("",e.networkService.peerContext.roomName,"/",e.networkService.peerContext.roomId,""),G(1),xt("value",e.networkService.peerContext.roomName+"/"+e.networkService.peerContext.roomId),G(1),oe("ngIf",e.isAbleClipboardCopy),G(1),ut("color",e.myPeerColor),oe("@fadeInOut",e.isRoomNameCopied),G(1),Zn(" ",e.isRoomNameCopied?"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002":"","")}}function lW(t,n){if(1&t&&(Q(0,"span",13)(1,"span",21),ve(2),ne(),mt(3,"input",22),ne()),2&t){const e=me(3);G(2),lt(e.networkService.peerContext.password),G(1),xt("value",e.networkService.peerContext.password)}}function cW(t,n){if(1&t&&(Q(0,"div",29),ve(1),ne()),2&t){const e=me(3);G(1),lt(e.maskedPassword)}}function uW(t,n){if(1&t){const e=ft();Q(0,"button",18),Ae("click",function(){return Re(e),Le(me(3).copyPassword())}),Q(1,"b",19),ve(2,"content_copy"),ne()()}2&t&&oe("disabled",me(3).isPasswordCopied)}const dW=function(t){return{"red-eye":t}};function fW(t,n){if(1&t){const e=ft();it(0),Q(1,"div"),ve(2," \u30d1\u30b9\u30ef\u30fc\u30c9 "),Q(3,"label",23)(4,"input",24),Ae("click",function(r){return Re(e),Le(me(2).onPasswordOpen(r))}),ne(),Q(5,"b",25),ve(6),ne(),ve(7,"\uff1a "),ne(),Q(8,"div",26),Te(9,lW,4,2,"span",27),Te(10,cW,2,1,"div",28),Te(11,uW,3,1,"button",16),Q(12,"span",17),ve(13),ne()()(),rt()}if(2&t){const e=me(2);G(4),xt("checked",e.isPasswordOpen?"checked":""),G(1),oe("ngClass",wt(10,dW,e.isPasswordOpen)),G(1),lt(e.isPasswordOpen?"visibility":"visibility_off"),G(3),oe("ngIf",e.isPasswordOpen),G(1),oe("ngIf",!e.isPasswordOpen),G(1),oe("ngIf",e.isAbleClipboardCopy&&e.isPasswordOpen),G(1),ut("color",e.myPeerColor),oe("@fadeInOut",e.isPasswordCopied),G(1),Zn(" ",e.isPasswordCopied?"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002":"","")}}function hW(t,n){if(1&t&&(it(0),mt(1,"hr"),Q(2,"div"),ve(3,"\u30eb\u30fc\u30e0\u540d\uff1a "),Q(4,"span"),Te(5,aW,8,8,"ng-container",0),ne()(),Te(6,fW,14,12,"ng-container",0),rt()),2&t){const e=me();G(5),oe("ngIf",e.networkService.isOpen),G(1),oe("ngIf",e.networkService.peerContext.password)}}function pW(t,n){1&t&&(Q(0,"div",20),ve(1,"\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u63a5\u7d9a\u72b6\u614b"),Q(2,"span",35),ve(3,"\uff08\u826f\u597d "),ne(),Q(4,"i",36),ve(5,"sentiment_very_satisfied"),ne(),Q(6,"span",35),ve(7," \uff1e "),ne(),Q(8,"i",37),ve(9,"sentiment_dissatisfied"),ne(),Q(10,"span",35),ve(11," \uff1e "),ne(),Q(12,"i",38),ve(13,"mood_bad"),ne(),Q(14,"span",35),ve(15," \uff1e "),ne(),Q(16,"i",39),ve(17,"sentiment_very_dissatisfied"),ne(),Q(18,"span",35),ve(19," \u4e0d\u826f\uff09"),ne(),ve(20,"\uff1a"),ne())}function gW(t,n){1&t&&(Q(0,"div"),ve(1,"[\u63a5\u7d9a\u4e2d]"),ne())}function mW(t,n){if(1&t&&(Q(0,"div",40),Lt(1,"safe"),ne()),2&t){const e=me().$implicit;ut("background-image",Bt(1,2,"url("+me().findPeerImageUrl(e.peerId)+")","style"))}}const _W=function(t){return{"is-gm-mode":t}};function $W(t,n){if(1&t&&(Q(0,"div"),Te(1,pW,21,0,"div",30),Q(2,"div"),Te(3,gW,2,0,"div",0),Q(4,"div",31)(5,"i",32),ve(6),ne(),Q(7,"span",33),ve(8),ne(),ve(9,"["),Te(10,mW,2,5,"div",34),Q(11,"span")(12,"b"),ve(13),ne()(),ve(14,"]"),ne()()()),2&t){const e=n.$implicit,i=n.index,r=me();G(1),oe("ngIf",0==i),G(2),oe("ngIf",!e.isOpen),G(1),oe("ngClass",wt(12,_W,r.findPeerIsGMMode(e.peerId))),G(1),Pd("material-icons health "+r.healthClass(e.session.health)),G(1),lt(r.healthIcon(e.session.health)),G(2),lt(r.findUserId(e.peerId)),G(2),oe("ngIf",r.findPeerImageUrl(e.peerId)),G(2),ut("color",r.findPeerColor(e.peerId)),G(1),lt(r.findPeerName(e.peerId))}}function vW(t,n){if(1&t){const e=ft();it(0),Q(1,"input",41),Ae("ngModelChange",function(r){return Re(e),Le(me(2).targetUserId=r)}),ne(),Q(2,"button",18),Ae("click",function(){return Re(e),Le(me(2).connectPeer())}),ve(3,"\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a"),ne(),mt(4,"br"),rt()}if(2&t){const e=me(2);G(1),oe("ngModel",e.targetUserId)("disabled",e.isDisableConnect),G(1),oe("disabled",!e.networkService.isOpen||null==e.targetUserId||""==e.targetUserId||e.isDisableConnect)}}function bW(t,n){if(1&t){const e=ft();Q(0,"button",18),Ae("click",function(){return Re(e),Le(me(2).showLobby())}),ve(1,"\u30ed\u30d3\u30fc\uff08\u30eb\u30fc\u30e0\u4e00\u89a7\uff09\u3092\u8868\u793a"),ne()}if(2&t){const e=me(2);oe("disabled",!e.networkService.isOpen||e.isDisableConnect)}}function yW(t,n){if(1&t&&(Q(0,"div"),Te(1,vW,5,3,"ng-container",0),Te(2,bW,2,1,"button",16),ne()),2&t){const e=me();G(1),oe("ngIf",!e.networkService.peerContext.isRoom),G(1),oe("ngIf",e.networkService.peerIds.length<=1)}}function CW(t,n){1&t&&(Q(0,"div",43),ve(1,"\u203b\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306f\u3001\u304a\u4e92\u3044\u306eID\u3092\u30e6\u30c9\u30ca\u30ea\u30a6\u30e0\u5916\u3067\u5171\u6709\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),ne())}function wW(t,n){1&t&&(Q(0,"div",43),ve(1,"\u203b\u4e00\u4eba\u3067\u52d5\u4f5c\u78ba\u8a8d\u3092\u884c\u3044\u305f\u3044\u5834\u5408\u306f\u30d6\u30e9\u30a6\u30b6\u30922\u3064\u958b\u304f\u3068\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u3002"),ne())}function xW(t,n){if(1&t&&(it(0),Te(1,CW,2,0,"div",42),Te(2,wW,2,0,"div",42),rt()),2&t){const e=me(2);G(1),oe("ngIf",e.networkService.peerContexts.length<1),G(1),oe("ngIf",e.networkService.peerContexts.length<1)}}function EW(t,n){1&t&&(it(0),Q(1,"div",43),ve(2,"\u203b\u30eb\u30fc\u30e0\u6a5f\u80fd\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u6642\u306f\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002"),ne(),rt())}function TW(t,n){if(1&t&&(it(0),Te(1,xW,3,2,"ng-container",0),Te(2,EW,3,0,"ng-container",0),rt()),2&t){const e=me();G(1),oe("ngIf",!e.networkService.peerContext.isRoom),G(1),oe("ngIf",e.networkService.peerContext.isRoom)}}function SW(t,n){1&t&&(it(0),Q(1,"div",43),ve(2,"\u203bGM\u30e2\u30fc\u30c9\u4e2d\uff08\u4fdd\u7559\u4e2d\u542b\u3080\uff09\u306f\u81ea\u5206\u304b\u3089\u63a5\u7d9a\u3092\u884c\u3048\u307e\u305b\u3093\u3002"),ne(),rt())}let Lv=(()=>{class t{constructor(e,i,r,o){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.appConfigService=o,this.targetUserId="",this.networkService=Ot,this.gameRoomService=Ct.instance,this.isCopied=!1,this.isRoomNameCopied=!1,this.isPasswordCopied=!1,this.isPasswordOpen=!1,this.help=""}get myPeer(){return Qe.myCursor}get myPeerName(){return Qe.myCursor?Qe.myCursor.name:null}set myPeerName(e){Qe.myCursor&&(Qe.myCursor.name=e,Qe.myCursor.name===Qe.CHAT_DEFAULT_NAME?kn.removeItem(Qe.CHAT_MY_NAME_LOCAL_STORAGE_KEY).catch(i=>console.log(i)):kn.setItem(Qe.CHAT_MY_NAME_LOCAL_STORAGE_KEY,Qe.myCursor.name).catch(i=>console.log(i)))}get myPeerColor(){return Qe.myCursor?Qe.myCursor.color:Qe.CHAT_DEFAULT_COLOR}set myPeerColor(e){if(e&&Qe.myCursor){if(e=e.trim().toLowerCase(),!/^\#[0-9a-f]{6}$/.test(e))return;Qe.myCursor.color=e==Qe.CHAT_TRANSPARENT_COLOR?Qe.CHAT_DEFAULT_COLOR:e,Qe.myCursor.color===Qe.CHAT_DEFAULT_COLOR?kn.removeItem(Qe.CHAT_MY_COLOR_LOCAL_STORAGE_KEY).catch(i=>console.log(i)):kn.setItem(Qe.CHAT_MY_COLOR_LOCAL_STORAGE_KEY,Qe.myCursor.color).catch(i=>console.log(i))}}get isGMMode(){return!!Qe.myCursor&&Qe.myCursor.isGMMode}set isGMMode(e){Qe.myCursor&&(Qe.myCursor.isGMMode=e)}get isGMHold(){return Qe.isGMHold}get isDisableConnect(){return this.isGMHold||this.isGMMode}get maskedPassword(){return"\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf"}ngOnInit(){Promise.resolve().then(()=>{this.panelService.title="\u63a5\u7d9a\u60c5\u5831",this.panelService.isAbleFullScreenButton=!1})}ngOnDestroy(){clearTimeout(this._timeOutId),clearTimeout(this._timeOutId2),clearTimeout(this._timeOutId3),Ue.unregister(this)}changeIcon(){let e=[];this.myPeer&&this.myPeer.imageIdentifier&&(e=[this.myPeer.imageIdentifier]),this.modalService.open(aa,{currentImageIdentifires:e}).then(i=>{if(!this.myPeer||!i)return;this.myPeer.imageIdentifier=i;let r=Gt.instance.get(i);r&&(r.state===Gi.COMPLETE?kn.setItem(Qe.CHAT_MY_ICON_LOCAL_STORAGE_KEY,r.blob).catch(o=>console.log(o)):"none_icon"===i?kn.removeItem(Qe.CHAT_MY_ICON_LOCAL_STORAGE_KEY).catch(o=>console.log(o)):kn.setItem(Qe.CHAT_MY_ICON_LOCAL_STORAGE_KEY,i).catch(o=>console.log(o)))})}connectPeer(){let e=this.targetUserId;if(this.targetUserId="",e.length<1)return;let i=ki.create(e);i.isRoom||(Ct.instance.clearDeleteHistory(),Ot.connect(i.peerId),(Qe.isGMHold||this.isGMMode)&&(Qe.isGMHold=!1,this.isGMMode=!1,this.isGMMode&&(this.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664"),Ue.trigger("CHANGE_GM_MODE",null))))}showLobby(){(Qe.isGMHold||this.isGMMode)&&(Qe.isGMHold=!1,this.isGMMode=!1,this.isGMMode&&(this.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664"),Ue.trigger("CHANGE_GM_MODE",null))),this.modalService.open(NV,{width:700,height:400,left:0,top:400})}findUserId(e){const i=Qe.findByPeerId(e);return i?i.userId:""}findPeerName(e){const i=Qe.findByPeerId(e);return i?i.name:""}findPeerColor(e){const i=Qe.findByPeerId(e);return i?i.color:""}findPeerImageUrl(e){const i=Qe.findByPeerId(e);return i?i.image.url:""}findPeerIsGMMode(e){const i=Qe.findByPeerId(e);return!!i&&i.isGMMode}copyPeerId(){navigator.clipboard&&(navigator.clipboard.writeText(this.networkService.peerContext.userId),this.isCopied=!0,clearTimeout(this._timeOutId),this._timeOutId=setTimeout(()=>{this.isCopied=!1},1e3))}copyRoomName(){navigator.clipboard&&(navigator.clipboard.writeText(this.networkService.peerContext.roomName+"/"+this.networkService.peerContext.roomId),this.isRoomNameCopied=!0,clearTimeout(this._timeOutId2),this._timeOutId2=setTimeout(()=>{this.isRoomNameCopied=!1},1e3))}copyPassword(){navigator.clipboard&&(navigator.clipboard.writeText(this.networkService.peerContext.password),this.isPasswordCopied=!0,clearTimeout(this._timeOutId3),this._timeOutId2=setTimeout(()=>{this.isPasswordCopied=!1},1e3),this.isPasswordOpen=!1)}isAbleClipboardCopy(){return!!navigator.clipboard}onPasswordOpen(e){this.isPasswordOpen?this.isPasswordOpen=!1:(e.preventDefault(),this.modalService.open(pr,{title:"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u8868\u793a",text:"\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",type:Li.OK_CANCEL,materialIcon:"visibility",action:()=>{this.isPasswordOpen=!0,e.target.checked=!0}}))}onGMMode(e){Qe.isGMHold||this.isGMMode?this.isGMMode?(e.preventDefault(),this.modalService.open(pr,{title:"GM\u30e2\u30fc\u30c9\u89e3\u9664",text:"GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664\u3057\u307e\u3059\u304b\uff1f",type:Li.OK_CANCEL,materialIcon:"person_remove",action:()=>{Qe.isGMHold=!1,this.isGMMode=!1,e.target.checked=!1,this.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664"),Ue.trigger("CHANGE_GM_MODE",null),sn.isStealthMode&&this.modalService.open(pr,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:Li.OK,materialIcon:"disabled_visible"})}})):(Qe.isGMHold=!1,this.isGMMode=!1):(e.preventDefault(),this.modalService.open(pr,{title:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b",text:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u304b\uff1f\nGM\u30e2\u30fc\u30c9\u4e2d\uff08\u4fdd\u7559\u4e2d\u542b\u3080\uff09\u306f\u3042\u306a\u305f\u304b\u3089\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3001\u30eb\u30fc\u30e0\u3078\u306e\u63a5\u7d9a\u306f\u884c\u3048\u307e\u305b\u3093\u3002",helpHtml:"GM\u30e2\u30fc\u30c9\u3067\u306f\u3001<b>\u79d8\u8a71</b>\u3001\u88cf\u5411\u304d\u306e<b>\u30ab\u30fc\u30c9</b>\u3001\u516c\u958b\u3055\u308c\u3066\u3044\u306a\u3044<b>\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb</b>\u3001<b>\u30ad\u30e3\u30e9\u30af\u30bf\u30fc</b>\u4f4d\u7f6e\u3001<b>\u30ab\u30fc\u30bd\u30eb</b>\u4f4d\u7f6e\u3092\u3059\u3079\u3066\u898b\u308b\u3053\u3068\u304c\u3067\u304d\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u3089\u306a\u304f\u306a\u308a\u307e\u3059\u3002\n\n<b><big>\u2014With great power comes great responsibility.</big></b>",type:Li.OK_CANCEL,materialIcon:"person_add",action:()=>{Qe.isGMHold=!0,this.isGMMode=!1,e.target.checked=!0,this.modalService.open(pr,{title:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b",text:"\u307e\u3060GM\u30e2\u30fc\u30c9\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002",helpHtml:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b\u306b\u306f\u3001\u30c1\u30e3\u30c3\u30c8\u304b\u3089 <b>GM\u306b\u306a\u308b</b> \u307e\u305f\u306f <b>GM\u306b\u306a\u308a\u307e\u3059</b> \u3092\u542b\u3080\u6587\u3092\u9001\u4fe1\u3057\u307e\u3059\u3002",type:Li.OK,materialIcon:"person_add"})}}))}healthIcon(e){return e>=.99?"sentiment_very_satisfied":e>.97?"sentiment_dissatisfied":e>.95?"mood_bad":"sentiment_very_dissatisfied"}healthClass(e){return e>=.99?"health-blue":e>.97?"health-green":e>.95?"health-yellow":"health-red"}}return t.\u0275fac=function(e){return new(e||t)(He(Yn),He(qn),He(Hr),He(Rv))},t.\u0275cmp=fn({type:t,selectors:[["peer-menu"]],decls:13,vars:8,consts:[[4,"ngIf"],["style","font-weight: bold;",4,"ngIf"],[4,"ngFor","ngForOf"],[2,"display","flex","align-items","flex-end","margin-bottom","4px"],["class","image cover","style","cursor: pointer",3,"background-image","click",4,"ngIf"],[2,"display","inline-block","margin-bottom","2px",3,"ngClass"],[2,"font-size","smaller"],["type","checkbox","name","i-am-gamemaster","value","I'm Gamemaster",3,"checked","click"],[3,"click"],["type","color",2,"width","1em","margin-right","0.5em",3,"ngModel","ngModelChange"],["placeholder","\u30cb\u30c3\u30af\u30cd\u30fc\u30e0",2,"font-weight","bolder",3,"ngModel","ngModelChange"],[2,"font-size","smaller","margin-left","1em"],[1,"image","cover",2,"cursor","pointer",3,"click"],[1,"id-input-container"],[1,"id-spacer"],["type","text","readonly","",1,"id-input",3,"value"],[3,"disabled","click",4,"ngIf"],[1,"copied"],[3,"disabled","click"],[1,"material-icons",2,"font-size","1em","vertical-align","bottom"],[2,"font-weight","bold"],[1,"id-spacer","room-data"],["type","text","readonly","",1,"id-input","room-data",3,"value"],["sytle","white-space: nowrap"],["name","show-hide-password","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[2,"display","inline"],["class","id-input-container",4,"ngIf"],["style","display: inline","class","masked-password","draggable","false",4,"ngIf"],["draggable","false",1,"masked-password",2,"display","inline"],["style","font-weight: bold",4,"ngIf"],[3,"ngClass"],[2,"margin-right","2px"],[2,"margin-right","3px"],["class","cover mini-icon",3,"background-image",4,"ngIf"],[1,"health"],[1,"material-icons","health","health-blue"],[1,"material-icons","health","health-green"],[1,"material-icons","health","health-yellow"],[1,"material-icons","health","health-red"],[1,"cover","mini-icon"],["placeholder","\u63a5\u7d9a\u3057\u305f\u3044\u76f8\u624b\u306eID","name","targetUserId",3,"ngModel","disabled","ngModelChange"],["style","font-size: 12px",4,"ngIf"],[2,"font-size","12px"]],template:function(e,i){1&e&&(Te(0,nW,21,10,"div",0),Q(1,"div")(2,"div"),ve(3,"\u3042\u306a\u305f\u306eID\uff1a "),Q(4,"span"),Te(5,rW,8,7,"ng-container",0),ne(),Te(6,oW,2,0,"span",1),ne()(),Te(7,hW,7,2,"ng-container",0),mt(8,"hr"),Te(9,$W,15,14,"div",2),Te(10,yW,3,2,"div",0),Te(11,TW,3,2,"ng-container",0),Te(12,SW,3,0,"ng-container",0)),2&e&&(oe("ngIf",i.myPeer),G(5),oe("ngIf",i.networkService.isOpen),G(1),oe("ngIf",!i.networkService.isOpen),G(1),oe("ngIf",i.networkService.peerContext.isRoom),G(2),oe("ngForOf",i.networkService.peerContexts),G(1),oe("ngIf",!i.isGMMode&&!i.isGMHold),G(1),oe("ngIf",!i.isGMMode&&!i.isGMHold),G(1),oe("ngIf",i.isGMMode||i.isGMHold))},dependencies:[si,_i,Bn,Ii,Mi,yi,$i],styles:['[_nghost-%COMP%]{display:block}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:table-cell;vertical-align:top;border-radius:.6rem}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto;height:auto;max-width:100%;max-height:100%;vertical-align:bottom}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}.id-input-container[_ngcontent-%COMP%]{display:inline-block;position:relative}.id-spacer[_ngcontent-%COMP%]{visibility:hidden;display:inline-block;pointer-events:none;padding:0 3px;box-sizing:border-box;border-color:transparent;border-radius:3px;border-width:2px;border-style:solid;font-family:Cambria,Georgia;font-size:larger;font-weight:bolder}.id-input[_ngcontent-%COMP%]{top:0;left:-4px;width:100%;position:absolute;background:none;border:none;outline:none;color:#444;font-family:Cambria,Georgia;font-size:larger;padding:2px;box-sizing:border-box;border-color:transparent;border-radius:3px;border-width:2px;border-style:solid;font-weight:bolder}.room-data[_ngcontent-%COMP%]{font-size:medium}.masked-password[_ngcontent-%COMP%]{font-weight:bolder;color:#444;font-family:Cambria,Georgia;-webkit-user-select:none;-moz-user-select:none;user-select:none;display:inline-block}.id-input[_ngcontent-%COMP%]:active, .id-input[_ngcontent-%COMP%]:hover{border-color:#444}.copied[_ngcontent-%COMP%]{font-size:smaller;opacity:0;white-space:nowrap}.health[_ngcontent-%COMP%]{font-size:14px;font-weight:400}.health-blue[_ngcontent-%COMP%]{color:#00f;filter:drop-shadow(0px 0px 2px skyblue)}.health-green[_ngcontent-%COMP%]{color:green;filter:drop-shadow(0px 0px 1px greenyellow)}.health-yellow[_ngcontent-%COMP%]{color:#757532;filter:drop-shadow(0px 0px 1px yellow)}.health-red[_ngcontent-%COMP%]{color:#8b0000;filter:drop-shadow(0px 0px 2px red)}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}.mini-icon[_ngcontent-%COMP%]{display:inline-block;padding:0;width:16px;height:16px;vertical-align:middle;border-radius:.2rem;margin-right:2px}.is-gm-mode[_ngcontent-%COMP%]:after{content:"\\3010GM\\3011";color:red}.i-am-gm[_ngcontent-%COMP%]{color:red;text-shadow:1px 1px 0px #eee,-1px 1px 0px #eee,1px -1px 0px #eee,-1px -1px 0px #eee,1px 0px 0px #eee,0px 1px 0px #eee,-1px 0px 0px #eee,0px -1px 0px #eee,0px 0px 2px crimson}'],data:{animation:[Vn("fadeInOut",[tn("false => true",[Zt("50ms ease-in-out",dt({opacity:1})),Zt("900ms ease-in-out",dt({opacity:0}))])])]}}),t})(),Pg=(()=>{class t{constructor(e){this.ngZone=e,this.batchTask=new Map,this.batchTaskTimer=null,this.needsChangeDetection=!1}add(e,i={}){this.batchTask.set(i,e),this.startTimer()}remove(e={}){this.batchTask.delete(e)}requireChangeDetection(){this.needsChangeDetection=!0,this.startTimer()}startTimer(){null==this.batchTaskTimer&&this.ngZone.runOutsideAngular(()=>{jr(()=>this.execBatch()),this.batchTaskTimer=setInterval(()=>{0<this.batchTask.size?this.execBatch():(clearInterval(this.batchTaskTimer),this.batchTaskTimer=null)},66)})}execBatch(){this.batchTask.forEach(e=>e()),this.batchTask.clear(),this.needsChangeDetection&&(this.needsChangeDetection=!1,this.ngZone.run(()=>{}))}}return t.\u0275fac=function(e){return new(e||t)(pn(Nn))},t.\u0275prov=$n({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const IW=["textArea"];function MW(t,n){1&t&&(mt(0,"img",27),Lt(1,"safe")),2&t&&oe("src",Bt(1,1,me(2).imageFile.url,"resourceUrl"),vn)}function kW(t,n){if(1&t&&(Q(0,"div",25),Te(1,MW,2,4,"img",26),ne()),2&t){const e=me();G(1),oe("ngIf",0<e.imageFile.url.length)}}function DW(t,n){if(1&t&&(Q(0,"div",25),mt(1,"img",27),Lt(2,"safe"),ne()),2&t){const e=me(2);G(1),oe("src",Bt(2,1,null==e.character.faceIcon?null:e.character.faceIcon.url,"resourceUrl"),vn)}}const AW=function(t,n){return{inverse:t,hollow:n}},PW=function(t,n,e,i,r,o,s,a){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}},NW=function(t){return{"black-paint":t}};function OW(t,n){if(1&t&&(Q(0,"div",30)(1,"span",31),mt(2,"img",32),Lt(3,"safe"),ne()()),2&t){const e=me(3);oe("ngClass",un(7,AW,e.character.isInverse,e.character.isHollow)),G(1),oe("ngClass",Ms(10,PW,0==e.character.aura,1==e.character.aura,2==e.character.aura,3==e.character.aura,4==e.character.aura,5==e.character.aura,6==e.character.aura,7==e.character.aura)),G(1),oe("src",Bt(3,4,e.character.imageFile.url,"resourceUrl"),vn)("ngClass",wt(19,NW,e.character.isBlackPaint))}}function FW(t,n){if(1&t&&Te(0,OW,4,21,"div",29),2&t){const e=me(2);oe("ngIf",e.character&&null!=e.character.imageFile&&0<e.character.imageFile.url.length)}}function RW(t,n){if(1&t&&(Te(0,DW,3,4,"div",2),Te(1,FW,1,1,"ng-template",null,28,ti)),2&t){const e=cn(2),i=me();oe("ngIf",i.isUseFaceIcon&&i.character&&null!=i.character.faceIcon&&0<(null==i.character.faceIcon||null==i.character.faceIcon.url?null:i.character.faceIcon.url.length))("ngIfElse",e)}}function LW(t,n){if(1&t){const e=ft();Q(0,"input",33),Ae("ngModelChange",function(r){return Re(e),Le(me().isUseFaceIcon=r)})("change",function(){Re(e);const r=me();return Le(r.isUseFaceIcon=!!r.isUseFaceIcon)}),ne()}if(2&t){const e=me();xt("checked",e.isUseFaceIcon?"checked":""),oe("ngModel",e.isUseFaceIcon)}}function BW(t,n){1&t&&(Q(0,"b",34),ve(1,"\u9854IC"),ne())}function zW(t,n){if(1&t&&(Q(0,"option",35),ve(1),ne()),2&t){const e=me();ut("color",e.myColor),xt("value",null==e.myPeer?null:e.myPeer.identifier),G(1),Zn("",null==e.myPeer?null:e.myPeer.name,"\uff08\u3042\u306a\u305f\uff09")}}function jW(t,n){if(1&t&&(Q(0,"option",36),ve(1),ne()),2&t){const e=n.$implicit;ut("color",e.chatPalette&&e.chatPalette.color&&"#ffffff"!=e.chatPalette.color?e.chatPalette.color:"#444"),xt("value",e.identifier),G(1),lt(e.name)}}function UW(t,n){1&t&&(it(0),ve(1,"\uff08\u3042\u306a\u305f\uff09"),rt())}function HW(t,n){if(1&t&&(Q(0,"option",35),ve(1),Te(2,UW,2,0,"ng-container",24),ne()),2&t){const e=n.$implicit,i=me();ut("color",e.color),xt("value",e.identifier),G(1),Zn("",e.name," "),G(1),oe("ngIf",e===i.myPeer)}}function VW(t,n){if(1&t&&(Q(0,"option",42),ve(1),ne()),2&t){const e=n.$implicit;xt("value",e.script),G(1),lt(e.game)}}function GW(t,n){if(1&t&&(Q(0,"optgroup",40),Te(1,VW,2,2,"option",41),ne()),2&t){const e=n.$implicit;xt("label",e.index),G(1),oe("ngForOf",e.infos)}}const Uf=function(){return{standalone:!0}},Ng=function(t){return{"not-specified":t}};function qW(t,n){if(1&t){const e=ft();Q(0,"select",37),Ae("change",function(r){return Re(e),Le(me().loadDiceBot(r.target.value))})("ngModelChange",function(r){return Re(e),Le(me().gameType=r)}),Q(1,"option",38),ve(2,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u6307\u5b9a\u306a\u3057"),ne(),Te(3,GW,2,2,"optgroup",39),ne()}if(2&t){const e=me();oe("ngModel",e.gameType)("ngModelOptions",xa(4,Uf))("ngClass",wt(5,Ng,"DiceBot"==e.gameType||""==e.gameType)),G(3),oe("ngForOf",e.diceBotInfosIndexed)}}function WW(t,n){if(1&t){const e=ft();Q(0,"select",43),Ae("change",function(r){return Re(e),Le(me().loadDiceBot(r.target.value))})("ngModelChange",function(r){return Re(e),Le(me().gameType=r)}),Q(1,"option",38),ve(2,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8aad\u8fbc\u4e2d\u2026"),ne()()}if(2&t){const e=me();oe("ngModel",e.gameType)("ngModelOptions",xa(3,Uf))("ngClass",wt(4,Ng,"DiceBot"==e.gameType||""==e.gameType))}}function KW(t,n){if(1&t&&(Q(0,"option",42),ve(1),ne()),2&t){const e=n.$implicit;xt("value",e),G(1),lt(e)}}const YW=function(t){return{"disabled-stand":t}};function ZW(t,n){if(1&t){const e=ft();Q(0,"div",44)(1,"label",45)(2,"input",33),Ae("ngModelChange",function(r){return Re(e),Le(me().isUseStandImage=r)})("change",function(){Re(e);const r=me();return Le(r.isUseStandImage=!!r.isUseStandImage)}),ne(),Q(3,"b",34),ve(4,"Stand: "),ne()(),Q(5,"select",46),Ae("change",function(){return Re(e),Le(me().isUseStandImage=!0)})("ngModelChange",function(r){return Re(e),Le(me().standName=r)}),Q(6,"option",13),ve(7,"\u672a\u9078\u629e"),ne(),Te(8,KW,2,2,"option",41),ne(),Q(9,"span",47)(10,"b",34),ve(11,"Pos: "),ne(),Q(12,"input",48),Ae("change",function(){return Re(e),Le(me().isUseStandImage=!0)})("ngModelChange",function(r){return Re(e),Le(me().character.standList.position=r)}),ne(),Q(13,"input",49),Ae("change",function(){return Re(e),Le(me().isUseStandImage=!0)})("ngModelChange",function(r){return Re(e),Le(me().character.standList.position=r)}),ne(),Q(14,"b",34),ve(15,"\uff05"),ne()(),Q(16,"button",50),Ae("click",function(){return Re(e),Le(me().farewellStand())}),ve(17,"\u9000\u53bb"),ne()()}if(2&t){const e=me();oe("ngClass",wt(14,YW,!e.isUseStandImageOnChatTab)),G(2),xt("checked",e.isUseStandImage?"checked":""),oe("ngModel",e.isUseStandImage),Qt("disabled",e.isUseStandImageOnChatTab?null:""),G(3),oe("ngModel",e.standName)("ngModelOptions",xa(16,Uf))("ngClass",wt(17,Ng,""==e.standName)),Qt("disabled",e.isUseStandImageOnChatTab?null:""),G(3),oe("ngForOf",e.standNameList),G(4),oe("ngModel",e.character.standList.position),Qt("disabled",e.isUseStandImageOnChatTab?null:""),G(1),oe("ngModel",e.character.standList.position),Qt("disabled",e.isUseStandImageOnChatTab?null:""),G(3),Qt("disabled",e.isUseStandImageOnChatTab?null:"")}}function XW(t,n){if(1&t){const e=ft();Q(0,"input",51),Ae("ngModelChange",function(r){return Re(e),Le(me().paletteColor=r)}),ne()}2&t&&oe("ngModel",me().paletteColor)("ngModelOptions",xa(2,Uf))}function QW(t,n){1&t&&(Q(0,"div",58),Lt(1,"safe"),ne()),2&t&&ut("background-image",Bt(1,2,"url("+me().$implicit.imageUrl+")","style"))}function JW(t,n){1&t&&(Q(0,"span",59),ve(1,", "),ne())}function eK(t,n){if(1&t&&(Q(0,"div",53),Te(1,QW,2,5,"div",54),Q(2,"div",55)(3,"span",56),Lt(4,"safe"),ve(5),ne(),Te(6,JW,2,0,"span",57),ne()()),2&t){const e=n.$implicit,i=n.index,r=me(2);G(1),oe("ngIf",e.imageUrl),G(2),ut("color",Bt(4,5,e.color,"style")),G(2),lt(e.name),G(1),oe("ngIf",r.writingPeerNameAndColors.length!==i+1)}}function tK(t,n){if(1&t&&(it(0),Te(1,eK,7,8,"div",52),ve(2," \u304c\u5165\u529b\u4e2d... "),rt()),2&t){const e=me();G(1),oe("ngForOf",e.writingPeerNameAndColors)}}const nK=function(t){return{"direct-message":t}},SI=function(t,n){return{color:t,"font-weight":n}};class mr{constructor(n,e,i,r,o,s){this.ngZone=n,this.chatMessageService=e,this.batchService=i,this.panelService=r,this.pointerDeviceService=o,this.contextMenuService=s,this.onlyCharacters=!1,this.chatTabidentifier="",this._gameType="",this.gameTypeChange=new Hn,this._sendFrom=this.myPeer?this.myPeer.identifier:"",this.sendFromChange=new Hn,this._sendTo="",this.sendToChange=new Hn,this._text="",this.textChange=new Hn,this.chat=new Hn,this.gameHelp="",this.isUseFaceIcon=!0,this.isUseStandImage=!0,this.currentHistoryIndex=-1,this.standName="",this.shouldUpdateCharacterList=!0,this._gameCharacters=[],this.writingEventInterval=null,this.previousWritingLength=0,this.writingPeers=new Map,this.writingPeerNameAndColors=[]}get isUseStandImageOnChatTab(){const n=Ct.instance.get(this.chatTabidentifier);return n&&n.isUseStandImage}get gameType(){return this._gameType}set gameType(n){this._gameType=n,this.gameTypeChange.emit(n)}get sendFrom(){return this._sendFrom}set sendFrom(n){this._sendFrom=n,this.sendFromChange.emit(n)}get sendTo(){return this._sendTo}set sendTo(n){this._sendTo=n,this.sendToChange.emit(n)}get text(){return this._text}set text(n){this._text=n,this.textChange.emit(n)}get isDirect(){return!(null==this.sendTo||!this.sendTo.length)}get character(){let n=Ct.instance.get(this.sendFrom);return n instanceof sn?n:null}get hasStand(){return!(!this.character||!this.character.standList)&&this.character.standList.standElements.length>0}get standNameList(){if(!this.hasStand)return[];let n=[];for(let e of this.character.standList.standElements){let i=e.getFirstElementByName("name");i&&i.value&&n.indexOf(i.value.toString())<0&&n.push(i.value.toString())}return n.sort()}get standListNoGroup(){return[]}get standListWithGroup(){if(!this.hasStand)return[];let n={};const e=this.character.standList.standElements.map(i=>i.getFirstElementByName("name")).filter(i=>i);e.sort((i,r)=>i.currentValue===r.currentValue?0:i.currentValue>r.currentValue?-1:1);for(const i of e)if(i&&i.value){const r=i.currentValue&&i.currentValue.toString().length>0?i.currentValue.toString():"";r&&(n[r]||(n[r]=[]),n[r].indexOf(i.value.toString())<0&&n[r].push(i.value.toString()))}return Object.keys(n).sort().map(i=>({name:i,stands:n[i].sort()})).filter(i=>i.stands.length>0)}get imageFile(){let n=Ct.instance.get(this.sendFrom),e=null;return n instanceof sn?e=n.imageFile:n instanceof Qe&&(e=n.image),e||on.Empty}get paletteColor(){return this.character&&this.character.chatPalette&&this.character.chatPalette.paletteColor?this.character.chatPalette.paletteColor:Qe.CHAT_TRANSPARENT_COLOR}set paletteColor(n){this.character.chatPalette.color=n||Qe.CHAT_TRANSPARENT_COLOR}get myColor(){return Qe.myCursor&&Qe.myCursor.color&&Qe.myCursor.color!=Qe.CHAT_TRANSPARENT_COLOR?Qe.myCursor.color:Qe.CHAT_DEFAULT_COLOR}get color(){return this.paletteColor&&this.paletteColor!=Qe.CHAT_TRANSPARENT_COLOR?this.paletteColor:this.myColor}get sendToColor(){let n=Ct.instance.get(this.sendTo);return n instanceof Qe?n.color:Qe.CHAT_DEFAULT_COLOR}get gameCharacters(){return this.shouldUpdateCharacterList&&(this.shouldUpdateCharacterList=!1,this._gameCharacters=Ct.instance.getObjects(sn).filter(n=>this.allowsChat(n))),this._gameCharacters}get diceBotInfos(){return ii.diceBotInfos}get myPeer(){return Qe.myCursor}get otherPeers(){return Ct.instance.getObjects(Qe)}get diceBotInfosIndexed(){return ii.diceBotInfosIndexed}ngOnInit(){Ue.register(this).on("MESSAGE_ADDED",n=>{if(n.data.tabIdentifier!==this.chatTabidentifier)return;let e=Ct.instance.get(n.data.messageIdentifier),i=Ct.instance.getObjects(Qe).find(o=>o.userId===e.from),r=i?i.peerId:"?";this.writingPeers.has(r)&&(this.writingPeers.get(r).stop(),this.writingPeers.delete(r),this.updateWritingPeerNameAndColors())}).on("UPDATE_GAME_OBJECT",n=>{if(n.data.aliasName!==sn.aliasName||(this.shouldUpdateCharacterList=!0,n.data.identifier!==this.sendFrom))return;let e=Ct.instance.get(n.data.identifier);e&&!this.allowsChat(e)&&(this.sendFrom=0<this.gameCharacters.length&&this.onlyCharacters?this.gameCharacters[0].identifier:this.myPeer.identifier)}).on("DISCONNECT_PEER",n=>{let e=Ct.instance.get(this.sendTo);e instanceof Qe&&e.peerId===n.data.peerId&&(this.sendTo="")}).on("WRITING_A_MESSAGE",n=>{n.isSendFromSelf||n.data!==this.chatTabidentifier||(this.writingPeers.has(n.sendFrom)||this.writingPeers.set(n.sendFrom,new Oa(()=>{this.writingPeers.delete(n.sendFrom),this.updateWritingPeerNameAndColors(),this.ngZone.run(()=>{})},2e3)),this.writingPeers.get(n.sendFrom).reset(),this.updateWritingPeerNameAndColors(),this.batchService.requireChangeDetection())})}ngOnDestroy(){Ue.unregister(this),this.batchService.remove(this)}updateWritingPeerNameAndColors(){this.writingPeerNameAndColors=Array.from(this.writingPeers.keys()).map(n=>{let e=Qe.findByPeerId(n);return{name:e?e.name:"",color:e?e.color:Qe.CHAT_TRANSPARENT_COLOR,imageUrl:e?e.image.url:""}})}onInput(){if(null===this.writingEventInterval&&this.previousWritingLength<=this.text.length){let n=null;if(this.isDirect){let e=Ct.instance.get(this.sendTo);if(e instanceof Qe){let i=ki.parse(e.peerId);i&&(n=i.peerId)}}Ue.call("WRITING_A_MESSAGE",this.chatTabidentifier,n),this.writingEventInterval=setTimeout(()=>{this.writingEventInterval=null},200)}this.previousWritingLength=this.text.length,this.calcFitHeight()}moveHistory(n,e){if(n&&n.preventDefault(),this.currentHistoryIndex<0&&(this.tmpText=this.text),e<0&&this.currentHistoryIndex<0)this.currentHistoryIndex=-1;else{if(e>0&&this.currentHistoryIndex>=mr.history.length-1)return void(this.currentHistoryIndex=mr.history.length-1);this.currentHistoryIndex=this.currentHistoryIndex+e}let i;this.currentHistoryIndex<0?(this.currentHistoryIndex=-1,i=this.tmpText&&this.tmpText.length?this.tmpText:""):i=mr.history[this.currentHistoryIndex],this.text=i,this.previousWritingLength=this.text.length,this.textAreaElementRef.nativeElement.value=i,this.calcFitHeight()}sendChat(n){if(n&&n.preventDefault(),n&&13!==n.keyCode)return;this.sendFrom.length||(this.sendFrom=this.myPeer.identifier);let e=this.text,i="",r=null;if(this.character&&(pt.cr(e).trim()||this.standName)&&(e=this.character.chatPalette.evaluate(this.text,this.character.rootDataElement),this.character.standList)){let a=null;a=this.isUseFaceIcon&&this.character.faceIcon?this.character.faceIcon.identifier:this.character.imageFile?this.character.imageFile.identifier:null;const h=this.character.standList.matchStandInfo(e,a,this.standName);if(this.isUseStandImage&&this.isUseStandImageOnChatTab)if(h.farewell)this.farewellStand();else if(h.standElementIdentifier){r=h.standElementIdentifier;const b={characterIdentifier:this.character.identifier,standIdentifier:h.standElementIdentifier,color:this.character.chatPalette?this.character.chatPalette.color:Qe.CHAT_DEFAULT_COLOR,secret:!!this.sendTo};if(b.secret){const ee=Ct.instance.get(this.sendTo);ee&&(ee.peerId!=Qe.myCursor.peerId&&Ue.call("POPUP_STAND_IMAGE",b,ee.peerId),Ue.call("POPUP_STAND_IMAGE",b,Qe.myCursor.peerId))}else Ue.call("POPUP_STAND_IMAGE",b)}i=h.matchMostLongText}const o=Os.instance.matchCutInInfo(e);if(this.isUseStandImageOnChatTab&&o){for(const a of o.identifiers){const h={identifier:a,secret:!!this.sendTo,sender:Qe.myCursor.peerId};if(h.secret){const b=Ct.instance.get(this.sendTo);b&&(b.peerId!=Qe.myCursor.peerId&&Ue.call("PLAY_CUT_IN",h,b.peerId),Ue.call("PLAY_CUT_IN",h,Qe.myCursor.peerId))}else Ue.call("PLAY_CUT_IN",h)}if(o.names&&o.names.length&&!this.sendTo){const a=new Map;for(const b of o.names){let ee=a.get(b)||0;ee+=1,a.set(""==b?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":b,ee)}const h=`${[...a.keys()].map(b=>a.get(b)>1?`${b}\xd7${a.get(b)}`:b).join("\u3001")}`;this.chatMessageService.sendOperationLog(h+" \u304c\u8d77\u52d5\u3057\u305f")}}if(i.length<o.matchMostLongText.length&&(i=o.matchMostLongText),e=e.slice(0,e.length-i.length),this.isUseStandImageOnChatTab&&this.character&&pt.cr(e).trim()){const a=/^((srepeat|repeat|srep|rep|sx|x)?(\d+)?[ \u3000]+)?([^\n]*)?/gi.exec(e);let b,h=null!=a[4]?a[4].trim():e.trim();/^(S?CHOICE\d*)[ \u3000]+([^ \u3000]*)/gi.test(h)?h="":((b=/^(S?CHOICE\d*\[[^\[\]]+\])/gi.exec(h))||(b=/^(S?CHOICE\d*\([^\(\)]+\))/gi.exec(h)))&&(h=h.slice(b[1].length));const ee=/\u300c+([\s\S]+?)\u300d/gm;let de,ge=[];for(;null!==(de=ee.exec(h));)ge.push(de[1]);if(0===ge.length){const xe=h.split(/[\s\u3000]/).slice(-1)[0];pt.isEmote(xe)&&ge.push(xe)}if(ge.length>0){const xe={characterIdentifier:this.character.identifier,text:ge.join("\n\n"),faceIconIdentifier:this.isUseFaceIcon&&this.character.faceIcon?this.character.faceIcon.identifier:null,color:this.color,secret:!!this.sendTo};if(xe.secret){const ke=Ct.instance.get(this.sendTo);ke&&(ke.peerId!=Qe.myCursor.peerId&&Ue.call("POPUP_CHAT_BALLOON",xe,ke.peerId),Ue.call("POPUP_CHAT_BALLOON",xe,Qe.myCursor.peerId))}else Ue.call("POPUP_CHAT_BALLOON",xe)}else pt.cr(e).trim()&&this.character.text&&Ue.call("FAREWELL_CHAT_BALLOON",{characterIdentifier:this.character.identifier})}Qe.isGMHold&&!this.sendTo&&!Qe.myCursor.isGMMode&&/GM(?:\u30e2\u30fc\u30c9)?\u306b\u306a(?:\u308a\u307e\u3059|\u308b)/i.test(pt.toHalfWidth(e))&&(Qe.myCursor.isGMMode=!0,this.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u306b\u306a\u3063\u305f"),Ue.trigger("CHANGE_GM_MODE",null)),pt.cr(e).trim()&&(mr.history=mr.history.filter(a=>a!==this.text),mr.history.unshift(this.text),mr.history.length>=mr.MAX_HISTORY_NUM&&mr.history.pop(),this.currentHistoryIndex=-1,this.tmpText=null,this.chat.emit({text:e,gameType:this.gameType,sendFrom:this.sendFrom,sendTo:this.sendTo,color:this.color,isInverse:!!this.character&&this.character.isInverse,isHollow:!!this.character&&this.character.isHollow,isBlackPaint:!!this.character&&this.character.isBlackPaint,aura:this.character?this.character.aura:-1,isUseFaceIcon:this.isUseFaceIcon,characterIdentifier:this.character?this.character.identifier:null,standIdentifier:r,standName:this.standName,isUseStandImage:this.isUseStandImage&&this.isUseStandImageOnChatTab})),this.text="",this.previousWritingLength=this.text.length,this.textAreaElementRef.nativeElement.value="",this.calcFitHeight(),Ue.trigger("MESSAGE_EDITING_START",null)}calcFitHeight(){let n=this.textAreaElementRef.nativeElement;n.style.height="",n.scrollHeight>=n.offsetHeight&&(n.style.height=n.scrollHeight+"px")}loadDiceBot(n){console.log("onChangeGameType ready"),ii.getHelpMessage(n).then(e=>{console.log("onChangeGameType done\n"+e)})}showDicebotHelp(){ii.getHelpMessage(this.gameType).then(n=>{this.gameHelp=n;let e="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8";for(let s of ii.diceBotInfos)s.id===this.gameType&&(e="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3008"+s.game+"\u3009");e+="\u4f7f\u7528\u6cd5";let i=this.pointerDeviceService.pointers[0],o=this.panelService.open(Fu,{left:i.x,top:i.y,width:600,height:500});o.title=e,o.text=this.gameHelp})}onContextMenu(n){if(n.stopPropagation(),n.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let e=this.pointerDeviceService.pointers[0];if(!this.character)return void this.contextMenuService.open(e,[{name:"\u63a5\u7d9a\u60c5\u5831...",action:()=>{this.panelService.open(Lv,{width:520,height:600,top:e.y-100,left:e.x-100})}}],Qe.myCursor.name,null,Qe.myCursor.color,!0);let i=[{name:"\u300c\u300d\u3092\u5165\u529b",action:()=>{let r=this.textAreaElementRef.nativeElement,o=this.text.trim();"\u300c"!=o.slice(0,1)&&(o="\u300c"+o),"\u300d"!=o.slice(-1)&&(o+="\u300d"),this.text=o,r.value=this.text,r.selectionStart=this.text.length-1,r.selectionEnd=this.text.length-1,r.focus()}}];this.character&&(this.isUseFaceIcon&&this.character.faceIcon?(i.push(Ht),i.push({name:"\u9854\u30a2\u30a4\u30b3\u30f3\u306e\u5207\u308a\u66ff\u3048",action:null,subActions:this.character.faceIcons.map((r,o)=>({name:this.character.currntIconIndex==o?"\u25c9":"\u25cb",action:()=>{this.character.currntIconIndex!=o&&(this.character.currntIconIndex=o)},default:this.character.currntIconIndex==o,icon:r})),disabled:this.character.faceIcons.length<=1})):(this.character.imageFiles.length>1&&(i.push(Ht),i.push({name:"\u753b\u50cf\u5207\u308a\u66ff\u3048",action:null,subActions:this.character.imageFiles.map((r,o)=>({name:this.character.currntImageIndex==o?"\u25c9":"\u25cb",action:()=>{this.character.currntImageIndex=o,Et.play(st.surprise),Ue.trigger("UPDATE_INVENTORY",null)},default:this.character.currntImageIndex==o,icon:r}))})),i.push(Ht),i.push({name:"\u753b\u50cf\u52b9\u679c",action:null,subActions:[this.character.isInverse?{name:"\u2611 \u53cd\u8ee2",action:()=>{this.character.isInverse=!1,Ue.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u53cd\u8ee2",action:()=>{this.character.isInverse=!0,Ue.trigger("UPDATE_INVENTORY",null)}},this.character.isHollow?{name:"\u2611 \u307c\u304b\u3057",action:()=>{this.character.isHollow=!1,Ue.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u307c\u304b\u3057",action:()=>{this.character.isHollow=!0,Ue.trigger("UPDATE_INVENTORY",null)}},this.character.isBlackPaint?{name:"\u2611 \u9ed2\u5857\u308a",action:()=>{this.character.isBlackPaint=!1,Ue.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ed2\u5857\u308a",action:()=>{this.character.isBlackPaint=!0,Ue.trigger("UPDATE_INVENTORY",null)}},{name:"\u30aa\u30fc\u30e9",action:null,subActions:[{name:(-1==this.character.aura?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{this.character.aura=-1,Ue.trigger("UPDATE_INVENTORY",null)}},Ht].concat(["\u30d6\u30e9\u30c3\u30af","\u30d6\u30eb\u30fc","\u30b0\u30ea\u30fc\u30f3","\u30b7\u30a2\u30f3","\u30ec\u30c3\u30c9","\u30de\u30bc\u30f3\u30bf","\u30a4\u30a8\u30ed\u30fc","\u30db\u30ef\u30a4\u30c8"].map((r,o)=>({name:`${this.character.aura==o?"\u25c9":"\u25cb"} ${r}`,action:()=>{this.character.aura=o,Ue.trigger("UPDATE_INVENTORY",null)}})))},Ht,{name:"\u30ea\u30bb\u30c3\u30c8",action:()=>{this.character.isInverse=!1,this.character.isHollow=!1,this.character.isBlackPaint=!1,this.character.aura=-1,Ue.trigger("UPDATE_INVENTORY",null)},disabled:!this.character.isInverse&&!this.character.isHollow&&!this.character.isBlackPaint&&-1==this.character.aura}]})),i.push(Ht),i.push({name:"\u8a73\u7d30\u3092\u8868\u793a...",action:()=>{this.showDetail(this.character)}}),this.onlyCharacters||i.push({name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a...",action:()=>{this.showChatPalette(this.character)}}),i.push({name:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a...",action:()=>{this.showStandSetting(this.character)}})),this.contextMenuService.open(e,i,this.character.name)}farewellStand(){if(this.character){const n={characterIdentifier:this.character.identifier};if(this.sendTo){const e=Ct.instance.get(this.sendTo);e&&(e.peerId!=Qe.myCursor.peerId&&Ue.call("FAREWELL_STAND_IMAGE",n,e.peerId),Ue.call("FAREWELL_STAND_IMAGE",n,Qe.myCursor.peerId))}else Ue.call("FAREWELL_STAND_IMAGE",n)}}showDetail(n){let e=this.pointerDeviceService.pointers[0],i="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";n.name.length&&(i+=" - "+n.name),this.panelService.open(ps,{title:i,left:e.x-400,top:e.y-300,width:800,height:600}).tabletopObject=n}showChatPalette(n){let e=this.pointerDeviceService.pointers[0];this.panelService.open(Lu,{left:e.x-250,top:e.y-175,width:620,height:350}).character=n}showStandSetting(n){let e=this.pointerDeviceService.pointers[0];this.panelService.open(yg,{left:e.x-400,top:e.y-175,width:730,height:572}).character=n}allowsChat(n){switch(n.location.name){case"table":case this.myPeer.peerId:return!0;case"graveyard":return!1;default:for(const e of Ot.peerContexts)if(e.isOpen&&n.location.name===e.peerId)return!1;return!0}}}mr.history=new Array,mr.MAX_HISTORY_NUM=1e3,mr.\u0275fac=function(n){return new(n||mr)(He(Nn),He(Hr),He(Pg),He(qn),He(Ci),He(hr))},mr.\u0275cmp=fn({type:mr,selectors:[["chat-input"]],viewQuery:function(n,e){if(1&n&&wn(IW,7),2&n){let i;Cn(i=xn())&&(e.textAreaElementRef=i.first)}},inputs:{onlyCharacters:"onlyCharacters",chatTabidentifier:"chatTabidentifier",_gameType:["gameType","_gameType"],_sendFrom:["sendFrom","_sendFrom"],_sendTo:["sendTo","_sendTo"],_text:["text","_text"]},outputs:{gameTypeChange:"gameTypeChange",sendFromChange:"sendFromChange",sendToChange:"sendToChange",textChange:"textChange",chat:"chat"},decls:35,vars:34,consts:[[1,"table",3,"ngClass"],[1,"table-cell","imagebox",2,"cursor","context-menu","padding-left","4px",3,"contextmenu"],["class","imagebox",4,"ngIf","ngIfElse"],["isCharacter",""],[1,"table-cell"],[2,"margin-right","5px"],["type","checkbox",3,"ngModel","checked","ngModelChange","change",4,"ngIf"],["style","font-size: smaller;",4,"ngIf"],[3,"ngModel","ngStyle","ngModelChange","change"],["style","font-weight: bolder;",3,"value","color",4,"ngIf"],["style","font-weight: normal;",3,"color","value",4,"ngFor","ngForOf"],[2,"white-space","nowrap"],[2,"max-width","9.5em",3,"ngModel","ngClass","ngStyle","ngModelChange"],["value","",1,"not-specified"],["style","font-weight: bolder;",3,"value","color",4,"ngFor","ngForOf"],["style","width: 12em;",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange",4,"ngIf"],["style","width: 12em;","disabled","",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange",4,"ngIf"],[3,"click"],["style","font-size: smaller",3,"ngClass",4,"ngIf"],["type","color","style","width:1em; margin-left: 3px",3,"ngModel","ngModelOptions","ngModelChange",4,"ngIf"],[1,"chat-input",3,"placeholder","ngModel","ngModelOptions","ngModelChange","input","keydown.enter","keydown.control.arrowup","keydown.control.arrowdown"],["textArea",""],["type","submit",3,"click"],[1,"writing-info"],[4,"ngIf"],[1,"imagebox"],["class","image face-icon",3,"src",4,"ngIf"],[1,"image","face-icon",3,"src"],["noFaceIcon",""],["class","inverser",3,"ngClass",4,"ngIf"],[1,"inverser",3,"ngClass"],[1,"aura","imagebox",3,"ngClass"],[1,"image",3,"src","ngClass"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"font-size","smaller"],[2,"font-weight","bolder",3,"value"],[2,"font-weight","normal",3,"value"],[2,"width","12em",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange"],["value","DiceBot",1,"not-specified"],["class","dice-bot-group",3,"label",4,"ngFor","ngForOf"],[1,"dice-bot-group",3,"label"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["disabled","",2,"width","12em",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange"],[2,"font-size","smaller",3,"ngClass"],[2,"margin-right","2px"],[2,"width","8em","margin-right","6px",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange"],[2,"white-space","nowrap","margin-left","1em","display","inline-block"],["type","range","min","0","max","100",2,"width","186px",3,"ngModel","change","ngModelChange"],["type","number","min","0","max","100",2,"width","3em","text-align","right","margin-right","3px",3,"ngModel","change","ngModelChange"],["type","button",2,"margin-left","1.3em","font-size","smaller",3,"click"],["type","color",2,"width","1em","margin-left","3px",3,"ngModel","ngModelOptions","ngModelChange"],["style","display: inline; white-space: pre",4,"ngFor","ngForOf"],[2,"display","inline","white-space","pre"],["class","cover mini-icon",3,"background-image",4,"ngIf"],[2,"font-weight","bold","display","inline"],[1,"peer-name"],["style","user-select: none",4,"ngIf"],[1,"cover","mini-icon"],[2,"user-select","none"]],template:function(n,e){if(1&n&&(Q(0,"div",0)(1,"div",1),Ae("contextmenu",function(r){return e.onContextMenu(r)}),Te(2,kW,2,1,"div",2),Te(3,RW,3,2,"ng-template",null,3,ti),ne(),Q(5,"div",4)(6,"div")(7,"label",5),Te(8,LW,1,2,"input",6),Te(9,BW,2,0,"b",7),ne(),Q(10,"select",8),Ae("ngModelChange",function(r){return e.sendFrom=r})("change",function(){return e.standName=""}),Te(11,zW,2,4,"option",9),Te(12,jW,2,4,"option",10),ne(),Q(13,"span",11),ve(14," \u27a1 "),Q(15,"select",12),Ae("ngModelChange",function(r){return e.sendTo=r}),Q(16,"option",13),ve(17,"\u5168\u54e1"),ne(),Te(18,HW,3,5,"option",14),ne()(),Q(19,"span",11),Te(20,qW,4,7,"select",15),Te(21,WW,3,6,"select",16),Q(22,"button",17),Ae("click",function(){return e.showDicebotHelp()}),ve(23,"?"),ne()()(),Te(24,ZW,18,19,"div",18),Q(25,"div")(26,"form"),Te(27,XW,1,3,"input",19),Q(28,"textarea",20,21),Ae("ngModelChange",function(r){return e.text=r})("input",function(){return e.onInput()})("keydown.enter",function(r){return e.sendChat(r)})("keydown.control.arrowup",function(r){return e.moveHistory(r,1)})("keydown.control.arrowdown",function(r){return e.moveHistory(r,-1)}),ne(),Q(30,"button",22),Ae("click",function(){return e.sendChat(null)}),Q(31,"b"),ve(32,"SEND"),ne()()()(),Q(33,"div",23),Te(34,tK,3,1,"ng-container",24),ne()()()),2&n){const i=cn(4);oe("ngClass",wt(23,nK,e.isDirect)),G(2),oe("ngIf",!e.character)("ngIfElse",i),G(6),oe("ngIf",e.character),G(1),oe("ngIf",e.character),G(1),ut("max-width",e.character?"9.5em":"13em"),oe("ngModel",e.sendFrom)("ngStyle",un(25,SI,e.color,e.sendFrom!=(null==e.myPeer?null:e.myPeer.identifier)?"normal":"bolder")),G(1),oe("ngIf",!e.onlyCharacters),G(1),oe("ngForOf",e.gameCharacters),G(3),oe("ngModel",e.sendTo)("ngClass",wt(28,Ng,""==e.sendTo))("ngStyle",un(30,SI,""==e.sendTo?null:e.sendToColor,""==e.sendTo?"normal":"bolder")),G(3),oe("ngForOf",e.otherPeers),G(2),oe("ngIf",e.diceBotInfosIndexed.length>0),G(1),oe("ngIf",e.diceBotInfosIndexed.length<1),G(3),oe("ngIf",e.hasStand),G(3),oe("ngIf",e.onlyCharacters),G(1),oe("placeholder",e.onlyCharacters?"Ctrl+\u21c5:\u5c65\u6b74 \u23ce:\u9001\u4fe1 Shift+\u23ce:\u6539\u884c\u3000\u767d(255,255,255):\u3042\u306a\u305f\u306e\u8272":"Ctrl+\u21c5:\u5c65\u6b74 \u23ce:\u9001\u4fe1 Shift+\u23ce:\u6539\u884c\u3000\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u8272\u3092\u512a\u5148")("ngModel",e.text)("ngModelOptions",xa(33,Uf)),G(6),oe("ngIf",0<e.writingPeerNameAndColors.length)}},dependencies:[si,_i,Bn,fr,nc,oo,so,Ii,Fo,Ro,Oo,$o,Mi,tc,Ys,Ks,yi,Ma,$i],styles:['[_nghost-%COMP%]{display:block}.table[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px;display:table;width:100%}.table[_ngcontent-%COMP%]   .table-cell[_ngcontent-%COMP%]{display:table-cell}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:50px;height:50px;max-width:50px;max-height:50px;vertical-align:top;text-align:center}.image[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%}.image.face-icon[_ngcontent-%COMP%]{border-radius:.5rem}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #00f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 6px #ccc) drop-shadow(0 -4px 4px #fff)}.chat-input[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,"M+ 1p",sans-serif;line-height:1.3;font-size:13px;width:calc(100% - 100px);height:calc(1em + 4px);min-height:calc(1em + 7px);max-height:calc(6em + 7px);overflow-y:auto;padding:1px;margin:5px;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;vertical-align:bottom}.writing-info[_ngcontent-%COMP%]{font-size:8px;height:1.3em;margin-bottom:1px}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.not-specified[_ngcontent-%COMP%]{color:gray}.dice-bot-group[_ngcontent-%COMP%]{color:#f5f5f5;background-color:#555}option[_ngcontent-%COMP%]{color:#000;background-color:#fff}.disabled-stand[_ngcontent-%COMP%]{color:gray}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}.direct-message[_ngcontent-%COMP%]   .writing-info[_ngcontent-%COMP%]{color:#eee}.mini-icon[_ngcontent-%COMP%]{display:inline-block;padding:0;width:.9rem;height:.9rem;vertical-align:middle;border-radius:.2rem;margin-right:1px;-o-object-fit:cover;object-fit:cover}.direct-message[_ngcontent-%COMP%]   .mini-icon[_ngcontent-%COMP%]{filter:drop-shadow(1px 1px 1px #ffffff) drop-shadow(-1px -1px 1px #ffffff)}.direct-message[_ngcontent-%COMP%]   .peer-name[_ngcontent-%COMP%]{text-shadow:1px 0px 1px #ffffff,0px 1px 1px #ffffff,-1px 0px 1px #ffffff,0px -1px 1px #ffffff}']});let Bv=(()=>{class t{constructor(){this.tableInventory=new Og(e=>"table"===e.location.name),this.commonInventory=new Og(e=>!this.isAnyLocation(e.location.name)),this.privateInventory=new Og(e=>e.location.name===Ot.peerId),this.graveyardInventory=new Og(e=>"graveyard"===e.location.name),this.indicateAll=!1,this._sortStop=!1,this.locationMap=new Map,this.tagNameMap=new Map,this.newLineStrings="/\uff0f",this.newLineDataElement=St.create(this.newLineStrings),this.initialize()}get summarySetting(){return ca.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(e){this.summarySetting.sortTag=e}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(e){this.summarySetting.sortOrder=e}get dataTag(){return this.summarySetting.dataTag}set dataTag(e){this.summarySetting.dataTag=e}get dataTags(){return this.summarySetting.dataTags}get sortStop(){return this._sortStop}set sortStop(e){const i=this._sortStop;this._sortStop=e,i&&!this._sortStop&&this.refresh()}initialize(){Ue.register(this).on("OPEN_NETWORK",e=>{this.refresh()}).on("CONNECT_PEER",e=>{this.refresh()}).on("DISCONNECT_PEER",e=>{this.refresh()}).on("UPDATE_GAME_OBJECT",e=>{let i=Ct.instance.get(e.data.identifier);if(i)if(i instanceof sn){let r=this.locationMap.get(i.identifier);i.location.name!==r&&(this.locationMap.set(i.identifier,i.location.name),this.refresh())}else if(i instanceof St){if(!this.containsInGameCharacter(i))return;let r=this.tagNameMap.get(i.identifier);(this.dataTags.includes(r)||this.dataTags.includes(i.name))&&i.name!==r&&(this.tagNameMap.set(i.identifier,i.name),this.refreshDataElements()),0<i.children.length&&this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate()}else i instanceof ca&&(this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate())}).on("DELETE_GAME_OBJECT",e=>{this.locationMap.delete(e.data.identifier),this.tagNameMap.delete(e.data.identifier),this.refresh()}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.callInventoryUpdate()})}containsInGameCharacter(e){let i=e.parent,r=sn.aliasName;for(;i;){if(i.aliasName===r)return!0;i=i.parent}return!1}refresh(){this.refreshObjects(),this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate()}refreshObjects(){this.tableInventory.refreshObjects(),this.commonInventory.refreshObjects(),this.privateInventory.refreshObjects(),this.graveyardInventory.refreshObjects()}refreshDataElements(){this.tableInventory.refreshDataElements(),this.commonInventory.refreshDataElements(),this.privateInventory.refreshDataElements(),this.graveyardInventory.refreshDataElements()}refreshSort(){this.sortStop||(this.tableInventory.refreshSort(),this.commonInventory.refreshSort(),this.privateInventory.refreshSort(),this.graveyardInventory.refreshSort())}callInventoryUpdate(){Ue.trigger("UPDATE_INVENTORY",null)}isAnyLocation(e){if("table"===e||e===Ot.peerId||"graveyard"===e)return!0;for(let i of Ot.peerContexts)if(i.isOpen&&e===i.peerId)return!0;return!1}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=$n({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();class Og{constructor(n){this.classifier=n,this.newLineStrings="/\uff0f",this.newLineDataElement=St.create(this.newLineStrings),this._tabletopObjects=[],this._dataElementMap=new Map,this.needsRefreshObjects=!0,this.needsRefreshElements=!0,this.needsSort=!0}get summarySetting(){return ca.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(n){this.summarySetting.sortTag=n}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(n){this.summarySetting.sortOrder=n}get dataTag(){return this.summarySetting.dataTag}set dataTag(n){this.summarySetting.dataTag=n}get dataTags(){return this.summarySetting.dataTags}get tabletopObjects(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this.needsSort&&(this._tabletopObjects=this.sortTabletopObjects(this._tabletopObjects),this.needsSort=!1),this._tabletopObjects}get length(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this._tabletopObjects.length}get dataElementMap(){if(this.needsRefreshElements){this._dataElementMap.clear();let n=this.tabletopObjects;for(let e of n){if(!e.detailDataElement)continue;let i=this.dataTags.map(r=>this.newLineStrings.includes(r)?this.newLineDataElement:e.detailDataElement.getFirstElementByNameUnsensitive(r));this._dataElementMap.set(e.identifier,i)}this.needsRefreshElements=!1}return this._dataElementMap}refreshObjects(){this.needsRefreshObjects=!0}refreshDataElements(){this.needsRefreshElements=!0}refreshSort(){this.needsSort=!0}searchTabletopObjects(){let n=Ct.instance.getObjects(sn),e=[];for(let i of n)this.classifier(i)&&e.push(i);return e}sortTabletopObjects(n){let e=this.sortTag.length?this.sortTag.trim():"",i="ASC"===this.sortOrder?-1:1;return e.length<1||n.sort((r,o)=>{let s=r.rootDataElement?.getFirstElementByNameUnsensitive(e),a=o.rootDataElement?.getFirstElementByNameUnsensitive(e);if(!s&&!a)return 0;if(!a)return-1;if(!s)return 1;let h=this.convertToSortableValue(s,r),b=this.convertToSortableValue(a,o);return h<b?i:h>b?-1*i:0}),n}convertToSortableValue(n,e=null){let i=this.evaluate(n,e),r=pt.toHalfWidth((i+"").replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).toLowerCase().trim(),o=+r;return Number.isNaN(o)?r:o}evaluate(n,e=null){let i;if(n.isCheckProperty){let r=n.currentValue.toString().split(/[|\uff5c]/,2);if(r.length<=1)return null==n.value||""==n.value?"":n.currentValue.toString();i=null==n.value||""==n.value?r[1]:r[0]}else i=n.isAbilityScore?n.calcAbilityScore:n.isNumberResource?n.currentValue:n.value;return null!=i&&e instanceof sn&&e.chatPalette&&(i=e.chatPalette.evaluate(i+"",e.rootDataElement)),i}}var Cc;let Tr=Cc=class extends pl{constructor(){super(...arguments),this.viewTableIdentifier="",this.gridShow=!1,this.gridSnap=!0}static get instance(){return Cc._instance||(Cc._instance=new Cc("TableSelecter"),Cc._instance.initialize()),Cc._instance}onStoreAdded(){super.onStoreAdded(),Ue.register(this).on("SELECT_GAME_TABLE",n=>{console.log("SELECT_GAME_TABLE "+this.identifier),this.viewTable&&(this.viewTable.selected=!1),this.viewTableIdentifier=n.data.identifier,this.viewTable&&(this.viewTable.selected=!0)})}onStoreRemoved(){super.onStoreRemoved(),Ue.unregister(this)}get viewTable(){let n=Ct.instance.get(this.viewTableIdentifier);return n||(n=Ct.instance.getObjects(ir)[0],n&&(this.viewTableIdentifier.length<1||Ct.instance.isDeleted(this.viewTableIdentifier))&&(this.viewTableIdentifier=n.identifier,Ue.trigger("SELECT_GAME_TABLE",{identifier:n.identifier}))),n}};$e([bt()],Tr.prototype,"viewTableIdentifier",void 0),Tr=Cc=$e([mi("TableSelecter")],Tr);class _r{constructor(){this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1}static create(n,e=null,i=new _r){return n&&n.ownerDocument?i.setCSS((e||window.getComputedStyle(n)).transform):i.identity()}setData(n){if(null==n)return;let e=n.length;return 16==e?(this.m11=n[0],this.m12=n[1],this.m13=n[2],this.m14=n[3],this.m21=n[4],this.m22=n[5],this.m23=n[6],this.m24=n[7],this.m31=n[8],this.m32=n[9],this.m33=n[10],this.m34=n[11],this.m41=n[12],this.m42=n[13],this.m43=n[14],this.m44=n[15]):6==e?(this.m11=n[0],this.m12=n[1],this.m13=0,this.m14=0,this.m21=n[2],this.m22=n[3],this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=n[4],this.m42=n[5],this.m43=0,this.m44=1):9==e&&(this.m11=n[0],this.m12=n[1],this.m13=0,this.m14=n[2],this.m21=n[3],this.m22=n[4],this.m23=0,this.m24=n[5],this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=n[6],this.m42=n[7],this.m43=0,this.m44=n[8]),this}identity(){return this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1,this}scalar(n){return this.m11*=n,this.m12*=n,this.m13*=n,this.m14*=n,this.m21*=n,this.m22*=n,this.m23*=n,this.m24*=n,this.m31*=n,this.m32*=n,this.m33*=n,this.m34*=n,this.m41*=n,this.m42*=n,this.m43*=n,this.m44*=n,this}unproject(n,e={x:0,y:0,z:0,w:1}){let i=n.x*this.m11+n.y*this.m21+this.m41,r=n.x*this.m12+n.y*this.m22+this.m42,o=n.x*this.m13+n.y*this.m23+this.m43,s=n.x*this.m14+n.y*this.m24+this.m44,a=i+this.m31,h=r+this.m32,b=o+this.m33,ee=s+this.m34;0==s&&(s=1e-4),i/=s,r/=s,o/=s,0==ee&&(ee=1e-4),a/=ee,h/=ee,b/=ee;let de=b-o;if(0==de)return e.x=i,e.y=r,e.z=o,e.w=o,e;let ge=-o/de;return i+=ge*(a-i),r+=ge*(h-r),e.x=i,e.y=r,e.z=o,e.w=o,e}project(n,e={x:0,y:0,z:0,w:1}){let i=n.z,r=n.x*this.m14+n.y*this.m24+i*this.m34+this.m44,o=n.x*this.m11+n.y*this.m21+i*this.m31+this.m41,s=n.x*this.m12+n.y*this.m22+i*this.m32+this.m42;return 0==r&&(r=1e-4),o/=r,s/=r,r<0&&(o-=this.m41,s-=this.m42,o*=1/r,s*=1/r,o+=this.m41,s+=this.m42),e.x=o,e.y=s,e.z=i,e.w=i,e}append(n){return _r.multiply(this,n,this)}setPosition(n){return this.m41=n.x,this.m42=n.y,this.m43=n.z,this}getPosition(n={x:0,y:0,z:0,w:1}){return n.x=this.m41,n.y=this.m42,n.z=this.m43,n}static makePosition(n,e=new _r){return e.identity(),e.setPosition(n),e}appendPosition(...n){let e;return e=1===n.length?n[0]:{x:n[0],y:n[1],z:n[2],w:1},this.append(_r.makePosition(e,_r.MATRIX3D))}static makePerspective(n,e=new _r){return e.identity(),e.m34=n?-1/n:0,e}appendPerspective(n){return n?this.append(_r.makePerspective(n,_r.MATRIX3D)):this}invert(n){n=n||this;let e=[],i=this.m11,r=this.m12,o=this.m13,s=this.m14,a=this.m21,h=this.m22,b=this.m23,ee=this.m24,de=this.m31,ge=this.m32,xe=this.m33,ke=this.m34,Pe=this.m41,Oe=this.m42,je=this.m43,qe=this.m44;e[0]=b*ke*Oe-ee*xe*Oe+ee*ge*je-h*ke*je-b*ge*qe+h*xe*qe,e[1]=s*xe*Oe-o*ke*Oe-s*ge*je+r*ke*je+o*ge*qe-r*xe*qe,e[2]=o*ee*Oe-s*b*Oe+s*h*je-r*ee*je-o*h*qe+r*b*qe,e[3]=s*b*ge-o*ee*ge-s*h*xe+r*ee*xe+o*h*ke-r*b*ke;let Ve=i*e[0]+a*e[1]+de*e[2]+Pe*e[3];return 0==Ve?(console.warn("Can not invert matrix, determinant is 0"),this):(e[4]=ee*xe*Pe-b*ke*Pe-ee*de*je+a*ke*je+b*de*qe-a*xe*qe,e[5]=o*ke*Pe-s*xe*Pe+s*de*je-i*ke*je-o*de*qe+i*xe*qe,e[6]=s*b*Pe-o*ee*Pe-s*a*je+i*ee*je+o*a*qe-i*b*qe,e[7]=o*ee*de-s*b*de+s*a*xe-i*ee*xe-o*a*ke+i*b*ke,e[8]=h*ke*Pe-ee*ge*Pe+ee*de*Oe-a*ke*Oe-h*de*qe+a*ge*qe,e[9]=s*ge*Pe-r*ke*Pe-s*de*Oe+i*ke*Oe+r*de*qe-i*ge*qe,e[10]=r*ee*Pe-s*h*Pe+s*a*Oe-i*ee*Oe-r*a*qe+i*h*qe,e[11]=s*h*de-r*ee*de-s*a*ge+i*ee*ge+r*a*ke-i*h*ke,e[12]=b*ge*Pe-h*xe*Pe-b*de*Oe+a*xe*Oe+h*de*je-a*ge*je,e[13]=r*xe*Pe-o*ge*Pe+o*de*Oe-i*xe*Oe-r*de*je+i*ge*je,e[14]=o*h*Pe-r*b*Pe-o*a*Oe+i*b*Oe+r*a*je-i*h*je,e[15]=r*b*de-o*h*de+o*a*ge-i*b*ge-r*a*xe+i*h*xe,n.setData(e),n.scalar(1/Ve),n)}setCSS(n){if(!n||"none"==n)return this.identity();let e=n.replace("matrix3d(","").replace("matrix(","").replace(")","").split(","),i=e.length;for(let r=0;r<i;++r)e[r]=Zi.parse(e[r]);return this.setData(e)}appendCSS(n,e=!1){return n&&"none"!=n?e&&n.indexOf("matrix3d")>=0?this.append(_r.MATRIX3D.setCSS(n).flatten()):this.append(_r.MATRIX3D.setCSS(n)):this}flatten(){return this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m44=1,this.m14=0,this.m24=0,this.m43=0,this}static multiply(n,e,i=new _r){let o=n.m11*e.m12+n.m12*e.m22+n.m13*e.m32+n.m14*e.m42,s=n.m11*e.m13+n.m12*e.m23+n.m13*e.m33+n.m14*e.m43,a=n.m11*e.m14+n.m12*e.m24+n.m13*e.m34+n.m14*e.m44,h=n.m21*e.m11+n.m22*e.m21+n.m23*e.m31+n.m24*e.m41,b=n.m21*e.m12+n.m22*e.m22+n.m23*e.m32+n.m24*e.m42,ee=n.m21*e.m13+n.m22*e.m23+n.m23*e.m33+n.m24*e.m43,de=n.m21*e.m14+n.m22*e.m24+n.m23*e.m34+n.m24*e.m44,ge=n.m31*e.m11+n.m32*e.m21+n.m33*e.m31+n.m34*e.m41,xe=n.m31*e.m12+n.m32*e.m22+n.m33*e.m32+n.m34*e.m42,ke=n.m31*e.m13+n.m32*e.m23+n.m33*e.m33+n.m34*e.m43,Pe=n.m31*e.m14+n.m32*e.m24+n.m33*e.m34+n.m34*e.m44,Oe=n.m41*e.m11+n.m42*e.m21+n.m43*e.m31+n.m44*e.m41,je=n.m41*e.m12+n.m42*e.m22+n.m43*e.m32+n.m44*e.m42,qe=n.m41*e.m13+n.m42*e.m23+n.m43*e.m33+n.m44*e.m43,Ve=n.m41*e.m14+n.m42*e.m24+n.m43*e.m34+n.m44*e.m44;return i.m11=n.m11*e.m11+n.m12*e.m21+n.m13*e.m31+n.m14*e.m41,i.m12=o,i.m13=s,i.m14=a,i.m21=h,i.m22=b,i.m23=ee,i.m24=de,i.m31=ge,i.m32=xe,i.m33=ke,i.m34=Pe,i.m41=Oe,i.m42=je,i.m43=qe,i.m44=Ve,i}toString(n=3){return"m11="+this.m11.toFixed(n)+"\tm21="+this.m21.toFixed(n)+"\tm31="+this.m31.toFixed(n)+"\tm41="+this.m41.toFixed(n)+"\nm12="+this.m12.toFixed(n)+"\tm22="+this.m22.toFixed(n)+"\tm32="+this.m32.toFixed(n)+"\tm42="+this.m42.toFixed(n)+"\nm13="+this.m13.toFixed(n)+"\tm23="+this.m23.toFixed(n)+"\tm33="+this.m33.toFixed(n)+"\tm43="+this.m43.toFixed(n)+"\nm14="+this.m14.toFixed(n)+"\tm24="+this.m24.toFixed(n)+"\tm34="+this.m34.toFixed(n)+"\tm44="+this.m44.toFixed(n)}}_r.MATRIX3D=new _r;class Hf{constructor(n){this.matrix=new _r,this.sceneTransform=new _r,this.inverseSceneTransform=new _r,this.initialize(n)}clear(){return this.element=null,this.matrix.identity(),this}initialize(n){if(!n)return;this.element=n;let e=window.getComputedStyle(n),i=0,r=0;return this.element.parentElement?(i=this.element.parentElement.clientWidth,r=this.element.parentElement.clientHeight):(i=window.innerWidth,r=window.innerHeight),this.paddingLeft=Zi.relation(e.paddingTop,i),this.paddingTop=Zi.relation(e.paddingTop,r),this.marginLeft=Zi.relation(e.marginLeft,i),this.marginTop=Zi.relation(e.marginTop,r),this.borderLeft=Zi.relation(e.borderLeft,i),this.borderTop=Zi.relation(e.borderTop,r),this.matrix.setCSS(e.transform),this.sceneTransform.identity(),this.extract(this,this.sceneTransform),this.sceneTransform.invert(this.inverseSceneTransform),this}globalToLocal(n,e,i=0){let r={x:n,y:e,z:i,w:1};return this.inverseSceneTransform.unproject(r,r),this.fromBorderBox(r),r}localToGlobal(n,e,i=0){let r={x:n,y:e,z:i,w:1};return this.sceneTransform.project(r,r),this.fromBorderBox(r),r}localToLocal(n,e,i,r){let o_x=n,o_y=e,o_z=i,s=new Hf(r),a=_r.multiply(this.sceneTransform,s.inverseSceneTransform),h={x:0,y:0,z:0,w:1};return h.x=o_x*a.m11+o_y*a.m21+o_z*a.m31+1*a.m41,h.y=o_x*a.m12+o_y*a.m22+o_z*a.m32+1*a.m42,h.z=o_x*a.m13+o_y*a.m23+o_z*a.m33+1*a.m43,h.w=o_x*a.m14+o_y*a.m24+o_z*a.m34+1*a.m44,s.clear(),this.toBorderBox(h),h}extract(n,e){let r=n.element;for(;r;)this.extractMatrix(r,e),r&&"fixed"===r.style.position&&(console.warn("fixed\u9818\u57df\u306f\u8a08\u7b97\u304c\u4e0d\u6b63\u78ba"),e.appendPosition(window.pageXOffset,window.pageYOffset,0)),r=r.parentElement}extractMatrix(n,e=null){if(e||(e=new _r),!n)return e;let i=n,r=window.getComputedStyle(n);if("none"!=r.transform){let a=r.transformOrigin?r.transformOrigin.split(" "):[],h=Zi.relation(a[0],i.offsetWidth,.5*i.offsetWidth),b=Zi.relation(a[1],i.offsetHeight,.5*i.offsetHeight),ee=Zi.relation(a[2],0,0);e.appendPosition(-h,-b,-ee),e.appendCSS(r.transform),e.appendPosition(h,b,ee)}let o=this.getPosition(n);e.appendPosition(o.x,o.y,0);let s=0;if(n.parentElement){let a=window.getComputedStyle(n.parentElement);s=Zi.parse(a.perspective)}if(n.parentElement&&s){let h=window.getComputedStyle(n.parentElement).perspectiveOrigin.split(" "),b=Zi.relation(h[0],i.parentElement.offsetWidth),ee=Zi.relation(h[1],i.parentElement.offsetHeight);e.appendPosition(-b,-ee,0),e.appendPerspective(s),e.appendPosition(b,ee,0)}return e}getPosition(n){let e={x:0,y:0};return e.x=n.offsetParent?n.parentElement===n.offsetParent?n.offsetLeft:n.parentElement.offsetParent===n.offsetParent?n.offsetLeft-n.parentElement.offsetLeft:0:n.offsetLeft,e.y=n.offsetParent?n.parentElement===n.offsetParent?n.offsetTop:n.parentElement.offsetParent===n.offsetParent?n.offsetTop-n.parentElement.offsetTop:0:n.offsetTop,e.x+=n.offsetParent?n.offsetParent.clientLeft:0,e.y+=n.offsetParent?n.offsetParent.clientTop:0,e}fromBorderBox(n){n.x+=this.paddingLeft,n.y+=this.paddingTop,n.x-=this.marginLeft,n.y-=this.marginTop,n.x-=this.borderLeft,n.y-=this.borderTop}toBorderBox(n){n.x-=this.paddingLeft,n.y-=this.paddingTop,n.x+=this.marginLeft,n.y+=this.marginTop,n.x+=this.borderLeft,n.y+=this.borderTop}}let wl=(()=>{class t{constructor(e){this.pointerDeviceService=e,this.tabletopOriginElement=document.body}convertToLocal(e,i=document.body){let r=new Hf(i),o=r.globalToLocal(e.x,e.y,e.z?e.z:0);return r.clear(),{x:o.x,y:o.y,z:o.z}}convertToGlobal(e,i=document.body){let r=new Hf(i),o=r.localToGlobal(e.x,e.y,e.z?e.z:0);return r.clear(),{x:o.x,y:o.y,z:o.z}}convertLocalToLocal(e,i,r){let o=new Hf(i),s=o.globalToLocal(e.x,e.y,e.z?e.z:0),a=o.localToLocal(s.x,s.y,0,r);return o.clear(),{x:a.x,y:a.y,z:a.z}}calcTabletopLocalCoordinate(e={x:this.pointerDeviceService.pointers[0].x,y:this.pointerDeviceService.pointers[0].y,z:0},i=this.pointerDeviceService.targetElement){return i.contains(this.tabletopOriginElement)?(e=this.convertToLocal(e,this.tabletopOriginElement)).z=0:e=this.convertLocalToLocal(e,i,this.tabletopOriginElement),{x:e.x,y:e.y,z:0<e.z?e.z:0}}}return t.\u0275fac=function(e){return new(e||t)(pn(Ci))},t.\u0275prov=$n({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Vu=(()=>{class t{constructor(e){this.coordinateService=e,this._emptyTable=new ir(""),this.locationMap=new Map,this.parentMap=new Map,this.characterCache=new xl(()=>Ct.instance.getObjects(sn).filter(i=>i.isVisibleOnTable)),this.cardCache=new xl(()=>Ct.instance.getObjects(Qn).filter(i=>i.isVisibleOnTable)),this.cardStackCache=new xl(()=>Ct.instance.getObjects(ai).filter(i=>i.isVisibleOnTable)),this.tableMaskCache=new xl(()=>{let i=this.tableSelecter.viewTable;return i?i.masks:[]}),this.rangeCache=new xl(()=>Ct.instance.getObjects(vi).filter(i=>i.isVisibleOnTable)),this.terrainCache=new xl(()=>{let i=this.tableSelecter.viewTable;return i?i.terrains:[]}),this.textNoteCache=new xl(()=>Ct.instance.getObjects(Vr)),this.diceSymbolCache=new xl(()=>Ct.instance.getObjects(xr)),this.initialize()}get tableSelecter(){return Tr.instance}get currentTable(){return this.tableSelecter.viewTable||this._emptyTable}get characters(){return this.characterCache.objects}get cards(){return this.cardCache.objects}get cardStacks(){return this.cardStackCache.objects}get tableMasks(){return this.tableMaskCache.objects}get ranges(){return this.rangeCache.objects}get terrains(){return this.terrainCache.objects}get textNotes(){return this.textNoteCache.objects}get diceSymbols(){return this.diceSymbolCache.objects}get peerCursors(){return Ct.instance.getObjects(Qe)}initialize(){this.refreshCacheAll(),Ue.register(this).on("UPDATE_GAME_OBJECT",e=>{if(e.data.identifier===this.currentTable.identifier||e.data.identifier===this.tableSelecter.identifier)return this.refreshCache(yo.aliasName),void this.refreshCache(Er.aliasName);let i=Ct.instance.get(e.data.identifier);i&&i instanceof Pi?this.shouldRefreshCache(i)&&(this.refreshCache(e.data.aliasName),this.updateMap(i)):this.refreshCache(e.data.aliasName)}).on("DELETE_GAME_OBJECT",e=>{let i=e.data.aliasName;i?this.refreshCache(i):this.refreshCacheAll()}).on("XML_LOADED",e=>{let r=gi.instance.parseXml(e.data.xmlElement);if(r instanceof Pi){let o=this.coordinateService.calcTabletopLocalCoordinate();r.location.x=o.x-25,r.location.y=o.y-25,r.posZ=o.z,this.placeToTabletop(r),Et.play(st.piecePut)}else r instanceof bl?Fs.instance.addChatTab(r):r instanceof Ra?Ns.instance.addDiceRollTable(r):r instanceof Ni&&Os.instance.addCutIn(r)})}findCache(e){switch(e){case sn.aliasName:return this.characterCache;case Qn.aliasName:return this.cardCache;case ai.aliasName:return this.cardStackCache;case yo.aliasName:return this.tableMaskCache;case Er.aliasName:return this.terrainCache;case Vr.aliasName:return this.textNoteCache;case xr.aliasName:return this.diceSymbolCache;case vi.aliasName:return this.rangeCache;default:return null}}refreshCache(e){let i=this.findCache(e);i&&i.refresh()}refreshCacheAll(){this.characterCache.refresh(),this.cardCache.refresh(),this.cardStackCache.refresh(),this.tableMaskCache.refresh(),this.terrainCache.refresh(),this.textNoteCache.refresh(),this.diceSymbolCache.refresh(),this.rangeCache.refresh(),this.clearMap()}shouldRefreshCache(e){return this.locationMap.get(e.identifier)!==e.location.name||this.parentMap.get(e.identifier)!==e.parentId}updateMap(e){this.locationMap.set(e.identifier,e.location.name),this.parentMap.set(e.identifier,e.parentId)}clearMap(){this.locationMap.clear(),this.parentMap.clear()}placeToTabletop(e){switch(e.aliasName){case yo.aliasName:e instanceof yo&&(e.isLock=!1);case Er.aliasName:if(e instanceof Er&&(e.isLocked=!1),!this.tableSelecter||!this.tableSelecter.viewTable)return;this.tableSelecter.viewTable.appendChild(e);break;case Qn.aliasName:case ai.aliasName:case vi.aliasName:case Vr.aliasName:(e instanceof Qn||e instanceof ai||e instanceof vi||e instanceof Vr)&&(e.isLocked=!1),e instanceof vi&&(e.followingCharctorIdentifier=null);default:e.setLocation("table")}}}return t.\u0275fac=function(e){return new(e||t)(pn(wl))},t.\u0275prov=$n({token:t,factory:t.\u0275fac}),t})();class xl{constructor(n){this.refreshCollector=n,this.needsRefresh=!0,this._objects=[]}get objects(){return this.needsRefresh&&(this._objects=this.refreshCollector(),this._objects=this._objects?this._objects:[],this.needsRefresh=!1),this._objects}refresh(){this.needsRefresh=!0}}class wc{constructor(n,e,i){this.chanks=[],this.chankSize=32768,this.chankReceiveCount=0,this.sentChankIndex=0,this.bufferingChankRange=4,this.completedChankIndex=0,this.startTime=0,this.isCanceled=!1,this.identifier=n,this.sendTo=e,this.data=i}static createSendTask(n,e,i){let r=new wc(n,e,i);return r.onstart=()=>r.initializeSend(),r}static createReceiveTask(n){let e=new wc(n);return e.onstart=()=>e.initializeReceive(),e}start(n){this.onstart?(this.data=n,this.onstart(),this.onstart=null):console.warn("\u518d\u8d77\u52d5\u3059\u308b\u4ed5\u69d8\u306a\u3069\u7121\u3044\u3002")}progress(n,e){this.onprogress&&this.onprogress(this,n,e)}finish(){this.isCanceled||(this.isCanceled=!0,this.onfinish&&this.onfinish(this,this.data),this.dispose())}timeout(){this.isCanceled||(this.isCanceled=!0,this.ontimeout&&this.ontimeout(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}cancel(){this.isCanceled||(null!=this.sendTo&&Ue.call("CANCEL_TASK_"+this.identifier,null,this.sendTo),this._cancel())}_cancel(){this.isCanceled||(this.isCanceled=!0,this.oncancel&&this.oncancel(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}dispose(){Ue.unregister(this),this.sendChankTimer&&function FL(t){hf.delete(t)}(this.sendChankTimer),this.timeoutTimer&&this.timeoutTimer.clear(),this.sendChankTimer=null,this.timeoutTimer=null,this.onprogress=this.onfinish=this.ontimeout=this.oncancel=null}initializeSend(){this.uint8Array=Uo.encode(this.data);let n=Math.ceil(this.uint8Array.byteLength/this.chankSize);this.chanks=new Array(n),console.log("\u30c1\u30e3\u30f3\u30af\u5206\u5272 "+this.identifier,this.chanks.length),Ue.register(this).on("FILE_MORE_CHANK_"+this.identifier,e=>{this.sendTo===e.sendFrom&&(this.completedChankIndex=e.data,null==this.sendChankTimer&&this.sentChankIndex+1<this.chanks.length&&this.sendChank(this.sentChankIndex+1),this.resetTimeout())}).on("DISCONNECT_PEER",e=>{e.data.peerId===this.sendTo&&(console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,e.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,e=>{console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,e.sendFrom),this._cancel()}),this.sentChankIndex=this.completedChankIndex=0,this.startTime=performance.now(),jr(()=>this.sendChank(0))}sendChank(n){let e=this.uint8Array.slice(n*this.chankSize,(n+1)*this.chankSize);Ue.call("FILE_SEND_CHANK_"+this.identifier,{index:n,length:this.chanks.length,chank:e},this.sendTo),this.sentChankIndex=n,this.sendChankTimer=null,this.chanks.length<=n+1?(console.log("\u30d0\u30c3\u30d5\u30a1\u9001\u4fe1\u5b8c\u4e86",this.identifier),this.outputTransferRate(this.uint8Array.byteLength),jr(()=>this.finish())):this.completedChankIndex+this.bufferingChankRange<=n?this.resetTimeout():this.sendChankTimer=jr(()=>{this.sendChank(this.sentChankIndex+1)})}initializeReceive(){this.resetTimeout(),this.startTime=performance.now(),this.chankReceiveCount=0,Ue.register(this).on("FILE_SEND_CHANK_"+this.identifier,n=>{this.chanks.length<1&&(this.chanks=new Array(n.data.length)),null==this.chanks[n.data.index]?(this.chankReceiveCount++,this.chanks[n.data.index]=n.data.chank,this.progress(n.data.index,n.data.length),this.chanks.length<=this.chankReceiveCount?this.finishReceive():(this.resetTimeout(),Ue.call("FILE_MORE_CHANK_"+this.identifier,n.data.index,n.sendFrom))):console.log(`already received. [${n.data.index}] <${this.identifier}>`)}).on("DISCONNECT_PEER",n=>{n.data.peerId===this.sendTo&&(console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,n.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,n=>{console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,n.sendFrom),this._cancel()})}finishReceive(){console.log("\u30d0\u30c3\u30d5\u30a1\u53d7\u4fe1\u5b8c\u4e86",this.identifier);let n=0;for(let r of this.chanks)n+=r.byteLength;this.outputTransferRate(n);let e=new Uint8Array(n),i=0;for(let r of this.chanks)e.set(r,i),i+=r.byteLength;this.data=Uo.decode(e),this.finish()}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new Oa(()=>this.timeout(),1e4)),this.timeoutTimer.reset()}outputTransferRate(n){let e=performance.now()-this.startTime,i=n/1024/1024/(e/1e3);console.log(`${(n/1024).toFixed(2)}KB ${(e/1e3).toFixed(2)}\u79d2 \u8ee2\u9001\u901f\u5ea6: ${i.toFixed(2)}MB/s`)}}class Gu{constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4}static get instance(){return Gu._instance||(Gu._instance=new Gu),Gu._instance}initialize(){console.log("AudioSharingSystem ready..."),this.destroy(),Ue.register(this).on("CONNECT_PEER",-1,n=>{!n.isSendFromSelf||(console.log("CONNECT_PEER AudioStorageService !!!",n.data.peerId),Xt.instance.synchronize())}).on("SYNCHRONIZE_AUDIO_LIST",n=>{if(n.isSendFromSelf)return;console.log("SYNCHRONIZE_AUDIO_LIST "+n.sendFrom);let e=n.data,i=[];console.log("SYNCHRONIZE_AUDIO_LIST active tasks ",this.sendTaskMap.size+this.receiveTaskMap.size);for(let o of e){let s=Xt.instance.get(o.identifier);null===s&&(s=Ho.createEmpty(o.identifier),Xt.instance.add(s)),s.state<Mr.COMPLETE&&!this.receiveTaskMap.has(o.identifier)&&i.push({identifier:o.identifier,state:s.state})}if(i.length<1&&!this.hasActiveTask()&&e.length<Xt.instance.getCatalog().length&&Xt.instance.synchronize(n.sendFrom),i.length<1||this.isLimitReceiveTask())return;let r=Math.floor(Math.random()*i.length);this.request([i[r]],n.sendFrom)}).on("REQUEST_AUDIO_RESOURE",n=>{if(n.isSendFromSelf)return;let e=n.data.identifiers,i=[];for(let r of e){let o=Xt.instance.get(r.identifier);o&&r.state<o.state&&i.push({identifier:r.identifier,state:r.state})}if(!1===this.isLimitSendTask()&&0<i.length&&!this.existsSendTask(n.data.receiver)){console.log("REQUEST_AUDIO_RESOURE Send!!! "+n.data.receiver+" -> "+i);let r=Math.floor(Math.random()*i.length),s=Xt.instance.get(i[r].identifier);this.startSendTask(s,n.data.receiver)}else{let r=n.data.candidatePeers,o=r.indexOf(Ot.peerId);-1<o&&r.splice(o,1);for(let s of r)return console.log("REQUEST_AUDIO_RESOURE AudioStorageService Relay!!! "+s+" -> "+n.data.identifiers),void Ue.call(n,s);console.log("REQUEST_FILE_RESOURE AudioStorageService \u3042\u3076\u308c\u305f..."+n.data.receiver,i.length)}}).on("UPDATE_AUDIO_RESOURE",1e3,n=>{let e=n.data;console.log("UPDATE_AUDIO_RESOURE AudioStorageService "+n.sendFrom+" -> ",e);for(let i of e)i.blob&&(i.blob=new Blob([i.blob],{type:i.type})),Xt.instance.add(i)}).on("START_AUDIO_TRANSMISSION",n=>{console.log("START_AUDIO_TRANSMISSION "+n.data.fileIdentifier);let e=n.data.fileIdentifier,i=Xt.instance.get(e);this.receiveTaskMap.has(e)||i&&Mr.COMPLETE<=i.state?(console.warn("CANCEL_TASK_ "+e),Ue.call("CANCEL_TASK_"+e,null,n.sendFrom)):this.startReceiveTask(e)})}destroy(){Ue.unregister(this)}startSendTask(n,e){var i=this;return(0,gn.Z)(function*(){let r=wc.createSendTask(n.identifier,e);i.sendTaskMap.set(n.identifier,r),Ue.call("START_AUDIO_TRANSMISSION",{fileIdentifier:n.identifier},e);let o={identifier:n.identifier,name:n.name,blob:null,type:"",url:null};n.state===Mr.URL?o.url=n.url:(o.blob=yield Ps.readAsArrayBufferAsync(n.blob),o.type=n.blob.type),r.onfinish=()=>{i.stopSendTask(r.identifier),Xt.instance.synchronize()},r.start(o)})()}startReceiveTask(n){let e=Xt.instance.get(n),i=wc.createReceiveTask(n);this.receiveTaskMap.set(n,i),i.onprogress=(r,o,s)=>{let a=e.toContext();a.name=(100*o/s).toFixed(1)+"%",e.apply(a)},i.onfinish=(r,o)=>{this.stopReceiveTask(r.identifier),o&&Ue.trigger("UPDATE_AUDIO_RESOURE",[o]),Xt.instance.synchronize()},i.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(n){let e=this.sendTaskMap.get(n);e&&e.cancel(),this.sendTaskMap.delete(n),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(n){let e=this.receiveTaskMap.get(n);e&&e.cancel(),this.receiveTaskMap.delete(n),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(n,e){console.log("requestFile() "+e);let i=Ot.peerIds;i.splice(i.indexOf(Ot.peerId),1),Ue.call("REQUEST_AUDIO_RESOURE",{identifiers:n,receiver:Ot.peerId,candidatePeers:i},e)}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(n){for(let e of this.sendTaskMap.values())if(e&&e.sendTo===n)return!0;return!1}}class qu{constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4,console.log("FileSharingSystem ready...")}static get instance(){return qu._instance||(qu._instance=new qu),qu._instance}initialize(){var n=this;Ue.register(this).on("CONNECT_PEER",1,e=>{!e.isSendFromSelf||(console.log("CONNECT_PEER ImageStorageService !!!",e.data.peerId),Gt.instance.synchronize())}).on("XML_LOADED",e=>{!function iK(t){let n=[],e=t.querySelectorAll('*[type="image"]');for(let i=0;i<e.length;i++){let r=e[i].innerHTML;!Gt.instance.get(r)&&0<bc.type(r).length&&n.push(r)}e=t.querySelectorAll("*[imageIdentifier]");for(let i=0;i<e.length;i++){let r=e[i].getAttribute("imageIdentifier");!Gt.instance.get(r)&&0<bc.type(r).length&&n.push(r)}for(let i of n)Gt.instance.add(i)}(e.data.xmlElement)}).on("SYNCHRONIZE_FILE_LIST",e=>{if(e.isSendFromSelf)return;console.log("SYNCHRONIZE_FILE_LIST ImageStorageService "+e.sendFrom);let i=e.data,r=[];for(let o of i){let s=Gt.instance.get(o.identifier);null===s&&(s=on.createEmpty(o.identifier),Gt.instance.add(s)),s.state<Gi.COMPLETE&&!this.receiveTaskMap.has(o.identifier)&&r.push({identifier:o.identifier,state:s.state})}r.length<1&&!this.hasActiveTask()&&i.length<Gt.instance.getCatalog().length&&Gt.instance.synchronize(e.sendFrom),!(r.length<1||this.isLimitReceiveTask())&&this.request(r,e.sendFrom)}).on("REQUEST_FILE_RESOURE",function(){var e=(0,gn.Z)(function*(i){if(i.isSendFromSelf)return;let r=i.data.identifiers,o=[];for(let s of r){let a=Gt.instance.get(s.identifier);a&&s.state<a.state&&o.push({identifier:s.identifier,state:s.state})}if(!1===n.isLimitSendTask()&&0<o.length&&!n.existsSendTask(i.data.receiver)){let s=n.makeSendUpdateImages(o);console.log("REQUEST_FILE_RESOURE ImageStorageService Send!!! "+i.data.receiver+" -> "+s.length),n.startSendTask(s,i.data.receiver)}else{let s=i.data.candidatePeers,a=s.indexOf(Ot.peerId);-1<a&&s.splice(a,1);for(let h of s)return console.log("REQUEST_FILE_RESOURE ImageStorageService Relay!!! "+h+" -> "+i.data.identifiers),void Ue.call(i,h);console.log("REQUEST_FILE_RESOURE ImageStorageService \u3042\u3076\u308c\u305f..."+i.data.receiver,o.length)}});return function(i){return e.apply(this,arguments)}}()).on("UPDATE_FILE_RESOURE",1e3,e=>{let i=e.data.updateImages;console.log("UPDATE_FILE_RESOURE ImageStorageService "+e.sendFrom+" -> ",i);for(let r of i)r.blob&&(r.blob=new Blob([r.blob],{type:r.type})),r.thumbnail.blob&&(r.thumbnail.blob=new Blob([r.thumbnail.blob],{type:r.thumbnail.type})),Gt.instance.add(r)}).on("START_FILE_TRANSMISSION",e=>{console.log("START_FILE_TRANSMISSION "+e.data.taskIdentifier);let i=e.data.taskIdentifier,r=Gt.instance.get(i);this.receiveTaskMap.has(i)||r&&Gi.COMPLETE<=r.state?(console.warn("CANCEL_TASK_ "+i),Ue.call("CANCEL_TASK_"+i,null,e.sendFrom)):this.startReceiveTask(i)})}destroy(){Ue.unregister(this)}startSendTask(n,e){var i=this;return(0,gn.Z)(function*(){let r=1===n.length?n[0].identifier:bo.generateUuid(),o=wc.createSendTask(r,e);i.sendTaskMap.set(o.identifier,o),Ue.call("START_FILE_TRANSMISSION",{taskIdentifier:r},e);for(let s of n)s.thumbnail.blob?s.thumbnail.blob=yield Ps.readAsArrayBufferAsync(s.thumbnail.blob):s.blob&&(s.blob=yield Ps.readAsArrayBufferAsync(s.blob));o.onfinish=(s,a)=>{i.stopSendTask(s.identifier),Gt.instance.synchronize()},o.start(n)})()}startReceiveTask(n){let e=wc.createReceiveTask(n);this.receiveTaskMap.set(n,e),e.onfinish=(i,r)=>{this.stopReceiveTask(i.identifier),r&&Ue.trigger("UPDATE_FILE_RESOURE",{identifier:i.identifier,updateImages:r}),Gt.instance.synchronize()},e.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(n){let e=this.sendTaskMap.get(n);e&&e.cancel(),this.sendTaskMap.delete(n),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(n){let e=this.receiveTaskMap.get(n);e&&e.cancel(),this.receiveTaskMap.delete(n),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(n,e){console.log("requestFile() "+e);let i=Ot.peerIds;i.splice(i.indexOf(Ot.peerId),1),Ue.call("REQUEST_FILE_RESOURE",{identifiers:n,receiver:Ot.peerId,candidatePeers:i},e)}makeSendUpdateImages(n,e=524288){let i=[],r=0;for(let o=n.length-1;0<=o;o--){let s=Math.floor(Math.random()*(o+1));[n[o],n[s]]=[n[s],n[o]]}n.sort((o,s)=>o.state<s.state?-1:o.state>s.state?1:0);for(let o=0;o<n.length;o++){let s=n[o],a=Gt.instance.get(s.identifier),h={identifier:a.identifier,name:a.name,type:"",blob:null,url:null,thumbnail:{type:"",blob:null,url:null}};a.state===Gi.URL?h.url=a.url:s.state===Gi.NULL?(h.thumbnail.blob=a.thumbnail.blob,h.thumbnail.type=a.thumbnail.type):(h.blob=a.blob,h.type=a.blob.type);let b=h.blob?h.blob.size:h.thumbnail.blob?h.thumbnail.blob.size:100;if(i.push(h),r+=b,e<r)break}return i}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(n){for(let e of this.sendTaskMap.values())if(e&&e.sendTo===n)return!0;return!1}}class Xi{constructor(n){this.peerId=n,this.requestMap=new Map}static create(n,e){Xi.tasksMap.size<1&&Ue.register(Xi.key).on("DISCONNECT_PEER",r=>{Xi.onDisconnect(r.data.peerId)}).on("UPDATE_GAME_OBJECT",r=>{r.isSendFromSelf||Xi.onUpdate(r.data.identifier)}).on("DELETE_GAME_OBJECT",r=>{r.isSendFromSelf||Xi.onUpdate(r.data.identifier)});let i=new Xi(n);return i.initialize(e),i}cancel(){this.timeoutTimer&&this.timeoutTimer.clear(),this.timeoutTimer=null,this.onsynchronize=this.onfinish=this.ontimeout=null;for(let n of this.requestMap.values())this.deleteTasksMap(n.identifier);this.requestMap.clear()}initialize(n){for(let e of n){e.ttl--,this.requestMap.set(e.identifier,e);let i=Xi.tasksMap.get(e.identifier);null==i&&(i=[]),i.push(this),Xi.tasksMap.set(e.identifier,i);let r=null!=this.peerId&&e.holderIds.includes(this.peerId)?this.peerId:null;Ue.call("REQUEST_GAME_OBJECT",e.identifier,r)}this.requestMap.size<1?setTimeout(()=>this.finish()):this.resetTimeout()}finish(){this.onfinish&&this.onfinish(this),this.cancel()}timeout(){this.ontimeout&&this.ontimeout(this,Array.from(this.requestMap.values()).filter(n=>0<=n.ttl)),this.finish()}static onDisconnect(n){for(let e of Xi.tasksMap.values())for(let i of e.concat())i.peerId===n&&i.timeout();Xi.tasksMap.size<1&&Ue.unregister(Xi.key)}static onUpdate(n){if(!Xi.tasksMap.has(n))return;let e=Xi.tasksMap.get(n);for(let i of e.concat())i.onUpdate(n);Xi.tasksMap.size<1&&Ue.unregister(Xi.key)}onUpdate(n){this.requestMap.delete(n),this.onsynchronize&&this.onsynchronize(this,n),this.requestMap.size<1?this.finish():this.resetTimeout()}deleteTasksMap(n){let e=Xi.tasksMap.get(n),i=e.indexOf(this);-1<i&&e.splice(i,1),e.length<1&&Xi.tasksMap.delete(n)}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new Oa(()=>this.timeout(),3e4)),this.timeoutTimer.reset()}}Xi.key={},Xi.tasksMap=new Map;class Wu{constructor(){this.requestMap=new Map,this.peerMap=new Map,this.tasks=[]}static get instance(){return Wu._instance||(Wu._instance=new Wu),Wu._instance}initialize(){this.destroy(),console.log("ObjectSynchronizer ready..."),Ue.register(this).on("CONNECT_PEER",2,n=>{!n.isSendFromSelf||(console.log("CONNECT_PEER GameRoomService !!!",n.data.peerId),this.sendCatalog(n.data.peerId))}).on("DISCONNECT_PEER",n=>{this.removePeerMap(n.data.peerId)}).on("SYNCHRONIZE_GAME_OBJECT",n=>{if(n.isSendFromSelf)return;console.log("SYNCHRONIZE_GAME_OBJECT "+n.sendFrom);let e=n.data;for(let i of e)Ct.instance.isDeleted(i.identifier)?Ue.call("DELETE_GAME_OBJECT",{aliasName:"",identifier:i.identifier},n.sendFrom):this.addRequestMap(i,n.sendFrom);this.synchronize()}).on("REQUEST_GAME_OBJECT",n=>{if(!n.isSendFromSelf)if(Ct.instance.isDeleted(n.data))Ue.call("DELETE_GAME_OBJECT",{aliasName:"",identifier:n.data},n.sendFrom);else{let e=Ct.instance.get(n.data);e&&Ue.call("UPDATE_GAME_OBJECT",e.toContext(),n.sendFrom)}}).on("UPDATE_GAME_OBJECT",1e3,n=>{let e=n.data,i=Ct.instance.get(e.identifier);i?n.isSendFromSelf||this.updateObject(i,e):Ct.instance.isDeleted(e.identifier)?Ue.call("DELETE_GAME_OBJECT",{aliasName:e.aliasName,identifier:e.identifier},n.sendFrom):this.createObject(e)}).on("DELETE_GAME_OBJECT",1e3,n=>{Ct.instance.delete(n.data.identifier,!1)})}destroy(){Ue.unregister(this)}updateObject(n,e){e.majorVersion+e.minorVersion>n.version&&n.apply(e)}createObject(n){let e=na.instance.create(n.aliasName,n.identifier);e?(Ct.instance.add(e,!1),e.apply(n)):console.warn(n.aliasName+" is Unknown...?",n)}sendCatalog(n){let e=Ct.instance.getCatalog(),i=setInterval(()=>{Ue.call("SYNCHRONIZE_GAME_OBJECT",e.splice(0,e.length<2048?e.length:2048),n),e.length<1&&clearInterval(i)})}addRequestMap(n,e){let i=this.requestMap.get(n.identifier);i&&i.version===n.version?(i.holderIds.push(e),this.addPeerMap(e)):(!i||i.version<n.version)&&(this.requestMap.set(n.identifier,{identifier:n.identifier,version:n.version,holderIds:[e],ttl:2}),this.addPeerMap(e))}addPeerMap(n){this.peerMap.has(n)||this.peerMap.set(n,[])}removePeerMap(n){this.peerMap.delete(n)}synchronize(){for(;0<this.requestMap.size&&this.tasks.length<32;)this.runSynchronizeTask()}runSynchronizeTask(){let n=this.getTargetPeerId(),e=this.makeRequestList(n);if(e.length<1)return void this.removePeerMap(n);let i=Xi.create(n,e);this.tasks.push(i);let r=this.peerMap.get(n);r&&r.push(i),i.onfinish=o=>{this.tasks.splice(this.tasks.indexOf(o),1);let s=this.peerMap.get(n);s&&s.splice(s.indexOf(o),1),this.synchronize()},i.ontimeout=(o,s)=>{console.log("GameObject synchronize \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8"),s.forEach(a=>this.requestMap.set(a.identifier,a))}}makeRequestList(n,e=32){let i=[];for(let[r,o]of this.requestMap){if(e<=i.length)break;if(!o.holderIds.includes(n))continue;let s=Ct.instance.get(o.identifier);(!s||s.version<o.version)&&i.push(o),this.requestMap.delete(r)}return i}getTargetPeerId(){let n=9999,e=null,i=Ot.peerContexts;for(let r=i.length-1;0<=r;r--){let o=Math.floor(Math.random()*(r+1));[i[r],i[o]]=[i[o],i[r]]}for(let r of i){let o=this.peerMap.get(r.peerId);r.isOpen&&o&&o.length<n&&(n=o.length,e=r.peerId)}return e}}let xc=class extends pl{constructor(){super(...arguments),this.audioIdentifier="",this.startTime=0,this.isLoop=!1,this.isPlaying=!1,this.audioPlayer=new tt}get audio(){return Xt.instance.get(this.audioIdentifier)}onStoreAdded(){super.onStoreAdded(),this.unlockAfterUserInteraction()}onStoreRemoved(){super.onStoreRemoved(),this._stop()}play(n,e=!1){let i=Xt.instance.get(n);!i||!i.isReady||(this.audioIdentifier=n,this.isPlaying=!0,this.isLoop=e,this._play())}_play(){this._stop(),this.audio&&this.audio.isReady?(this.audioPlayer.loop=!0,this.audioPlayer.play(this.audio)):this.playAfterFileUpdate()}stop(){this.audioIdentifier="",this.isPlaying=!1,this._stop()}_stop(){this.unregisterEvent(),this.audioPlayer.stop()}playAfterFileUpdate(){Ue.register(this).on("UPDATE_AUDIO_RESOURE",n=>{this._play()})}unlockAfterUserInteraction(){let n=()=>{document.body.removeEventListener("touchstart",n,!0),document.body.removeEventListener("mousedown",n,!0),this.audioPlayer.stop(),this.isPlaying&&this._play()};document.body.addEventListener("touchstart",n,!0),document.body.addEventListener("mousedown",n,!0)}unregisterEvent(){Ue.unregister(this,"UPDATE_AUDIO_RESOURE")}apply(n){let e=this.audioIdentifier,i=this.isPlaying;super.apply(n),e===this.audioIdentifier&&i||!this.isPlaying?i!==this.isPlaying&&!this.isPlaying&&this._stop():this._play()}};function rK(t,n){if(1&t&&(Q(0,"option",6),ve(1),ne()),2&t){const e=n.$implicit;xt("value",e.identifier),G(1),lt(e.name)}}function oK(t,n){if(1&t){const e=ft();it(0),Q(1,"div",7)(2,"div"),ve(3," \u30bf\u30d6"),Q(4,"sup",8),ve(5,"*"),ne(),ve(6,"\uff1a "),Q(7,"label")(8,"input",9),Ae("ngModelChange",function(r){return Re(e),Le(me().isAllTabs=r)}),ne(),ve(9,"\u9078\u629e\u3057\u305f\u30bf\u30d6"),ne(),Q(10,"label")(11,"input",9),Ae("ngModelChange",function(r){return Re(e),Le(me().isAllTabs=r)}),ne(),ve(12,"\u5168\u3066\u306e\u30bf\u30d6"),ne()(),Q(13,"div"),ve(14," \u5f62\u5f0f"),Q(15,"sup",8),ve(16,"*"),ne(),ve(17,"\uff1a "),Q(18,"label")(19,"input",9),Ae("ngModelChange",function(r){return Re(e),Le(me().logFormat=r)}),ne(),ve(20,"\u30c6\u30ad\u30b9\u30c8"),ne(),Q(21,"label")(22,"input",9),Ae("ngModelChange",function(r){return Re(e),Le(me().logFormat=r)}),ne(),ve(23,"HTML"),ne()(),Q(24,"div"),ve(25," \u6642\u523b"),Q(26,"sup",8),ve(27,"*"),ne(),ve(28,"\uff1a "),Q(29,"label")(30,"input",9),Ae("ngModelChange",function(r){return Re(e),Le(me().dateFormat=r)}),ne(),ve(31,"\u306a\u3057"),ne(),Q(32,"label")(33,"input",9),Ae("ngModelChange",function(r){return Re(e),Le(me().dateFormat=r)}),ne(),ve(34,"\u6642\uff1a\u5206"),ne(),Q(35,"label")(36,"input",9),Ae("ngModelChange",function(r){return Re(e),Le(me().dateFormat=r)}),ne(),ve(37,"\u65e5\u4ed8\u6642\u523b"),ne()()(),mt(38,"hr"),Q(39,"div",10)(40,"div")(41,"label",11)(42,"input",12),Ae("ngModelChange",function(r){return Re(e),Le(me().isWriteOerationLog=r)}),ne(),ve(43,"\u64cd\u4f5c\u30ed\u30b0\u3092\u542b\u3081\u308b"),Q(44,"sup",8),ve(45,"*"),ne()()(),Q(46,"div",13)(47,"button",14),Ae("click",function(){return Re(e),Le(me().saveLog())}),ve(48,"\u30ed\u30b0\u51fa\u529b"),ne()()(),rt()}if(2&t){const e=me();G(8),cr("name","",e.panelId,"-log-output-tab"),oe("ngModel",e.isAllTabs)("checked",!e.isAllTabs)("value",!1),G(3),cr("name","",e.panelId,"-log-output-tab"),oe("ngModel",e.isAllTabs)("checked",e.isAllTabs)("value",!0),G(8),cr("name","",e.panelId,"-log-output-format"),oe("ngModel",e.logFormat)("checked",0==e.logFormat)("value",0),G(3),cr("name","",e.panelId,"-log-output-format"),oe("ngModel",e.logFormat)("checked",1==e.logFormat)("value",1),G(8),cr("name","",e.panelId,"-log-output-timestamp-type"),oe("ngModel",e.dateFormat)("checked",""==e.dateFormat)("value",""),G(3),cr("name","",e.panelId,"-log-output-timestamp-type"),oe("ngModel",e.dateFormat)("checked","HH:mm"==e.dateFormat)("value","HH:mm"),G(3),cr("name","",e.panelId,"-log-output-timestamp-type"),oe("ngModel",e.dateFormat)("checked","yyyy/MM/dd HH:mm"==e.dateFormat)("value","yyyy/MM/dd HH:mm"),G(6),xt("checked",e.isWriteOerationLog?"checked":""),oe("ngModel",e.isWriteOerationLog),G(5),oe("disabled",e.isDiable)}}function sK(t,n){1&t&&(it(0),Q(1,"div",15),ve(2,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002"),ne(),rt())}$e([bt()],xc.prototype,"audioIdentifier",void 0),$e([bt()],xc.prototype,"startTime",void 0),$e([bt()],xc.prototype,"isLoop",void 0),$e([bt()],xc.prototype,"isPlaying",void 0),xc=$e([mi("jukebox")],xc);let II=(()=>{class t{constructor(e,i,r,o){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.saveDataService=o,this.selectedTab=null}get isAllTabs(){return t.isAllTabs}set isAllTabs(e){t.isAllTabs=e}get logFormat(){return t.logFormat}set logFormat(e){t.logFormat=e}get dateFormat(){return t.dateFormat}set dateFormat(e){t.dateFormat=e}get isWriteOerationLog(){return t.isWriteOerationLog}set isWriteOerationLog(e){t.isWriteOerationLog=e}get tabName(){return this.selectedTab.name}set tabName(e){this.selectedTab.name=e}get chatTabs(){return this.chatMessageService.chatTabs}get isEmpty(){return this.chatMessageService.chatTabs.length<1}get isDeleted(){return!!this.selectedTab&&null==Ct.instance.get(this.selectedTab.identifier)}get isDiable(){return this.isEmpty||!this.isAllTabs&&(!this.selectedTab||this.isDeleted)}get roomName(){return Ot.peerContext&&0<Ot.peerContext.roomName.length?Ot.peerContext.roomName:"\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf"}ngOnInit(){Promise.resolve().then(()=>{this.modalService.title=this.panelService.title="\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0\u51fa\u529b",this.panelService.isAbleFullScreenButton=!1}),Ue.register(this).on("DELETE_GAME_OBJECT",1e3,e=>{this.selectedTab&&e.data.identifier===this.selectedTab.identifier&&Ct.instance.get(e.data.identifier)}),this.panelId=bo.generateUuid()}ngOnDestroy(){Ue.unregister(this)}onChangeSelectTab(e){this.selectedTab=Ct.instance.get(e)}saveLog(){this.isDiable||this.saveDataService.saveChatLog(this.logFormat,this.roomName+"_chatLog_"+(this.isAllTabs?"\u5168\u3066\u306e\u30bf\u30d6":this.selectedTab.name),this.isAllTabs?null:this.selectedTab,this.dateFormat,this.isWriteOerationLog)}}return t.isAllTabs=!1,t.logFormat=1,t.dateFormat="HH:mm",t.isWriteOerationLog=!0,t.\u0275fac=function(e){return new(e||t)(He(Yn),He(qn),He(Hr),He(Gr))},t.\u0275cmp=fn({type:t,selectors:[["app-chat-log-output"]],decls:7,vars:5,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],["size","10",2,"width","140px",3,"ngModel","disabled","change"],[3,"value",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[3,"value"],[2,"font-weight","bolder","font-size","smaller","padding-top","3px"],[1,"self-only"],["type","radio",3,"name","ngModel","checked","value","ngModelChange"],[2,"width","100%","display","flex"],[2,"font-weight","bolder","font-size","smaller","padding-top","3px","padding-right","1em"],["type","checkbox",3,"ngModel","checked","ngModelChange"],[2,"flex-grow","1","text-align","right"],[2,"font-size","smaller",3,"disabled","click"],[2,"font-size","12px"]],template:function(e,i){1&e&&(Q(0,"div",0)(1,"div",1)(2,"select",2),Ae("change",function(o){return i.onChangeSelectTab(o.target.value)}),Te(3,rK,2,2,"option",3),ne()(),Q(4,"div",4),Te(5,oK,49,31,"ng-container",5),ne()(),Te(6,sK,3,0,"ng-container",5)),2&e&&(G(2),oe("ngModel",null==i.selectedTab?null:i.selectedTab.identifier)("disabled",i.isAllTabs),G(1),oe("ngForOf",i.chatTabs),G(2),oe("ngIf",!i.isEmpty),G(1),oe("ngIf",i.isEmpty))},dependencies:[_i,Bn,oo,so,Ii,Oo,$o,ol,Mi,yi],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}label[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]{margin-left:.5em}.self-only[_ngcontent-%COMP%]{color:red}.log-sample-text[_ngcontent-%COMP%], .log-sample-html[_ngcontent-%COMP%]{background-color:#fff;font-size:smaller;overflow-y:hidden;width:100%;min-height:1.6em}select[_ngcontent-%COMP%]:disabled   option[_ngcontent-%COMP%]{color:HighlightText;background-color:Highlight}"]}),t})();function aK(t,n){if(1&t&&(Q(0,"option",7),ve(1),ne()),2&t){const e=n.$implicit;ut("color",""==e.name?"gray":""),xt("value",e.identifier),xt("title",e.name),G(1),lt(""==e.name?"(\u7121\u540d\u306e\u30bf\u30d6)":e.name)}}function lK(t,n){if(1&t&&(Q(0,"div",20),ve(1),ne()),2&t){const e=me(3);G(1),Zn("",e.progresPercent,"%")}}const cK=function(t){return{"is-hidden":t}};function uK(t,n){if(1&t){const e=ft();it(0),Q(1,"button",12),Ae("click",function(){return Re(e),Le(me(2).upTabIndex())}),ve(2,"\u2191"),ne(),Q(3,"button",12),Ae("click",function(){return Re(e),Le(me(2).downTabIndex())}),ve(4,"\u2193"),ne(),Q(5,"div",13)(6,"button",12),Ae("click",function(){return Re(e),Le(me(2).showLogOutput())}),Q(7,"i",14),ve(8,"history_edu"),ne(),ve(9,"\u30ed\u30b0"),ne(),Q(10,"button",15),Ae("click",function(){return Re(e),Le(me(2).save())}),Q(11,"div",16)(12,"div",17),ve(13,"\u4fdd\u5b58"),ne(),Te(14,lK,2,1,"div",18),ne()(),Q(15,"button",19),Ae("click",function(){return Re(e),Le(me(2).delete())}),ve(16,"\u524a\u9664"),ne()(),rt()}if(2&t){const e=me(2);G(10),oe("disabled",e.isSaveing),G(2),oe("ngClass",wt(4,cK,e.isSaveing)),G(2),oe("ngIf",e.isSaveing),G(1),Qt("disabled",e.chatTabs.length<=1?"":null)}}function dK(t,n){if(1&t){const e=ft();it(0),Q(1,"button",12),Ae("click",function(){return Re(e),Le(me(2).restore())}),ve(2,"\u5143\u306b\u623b\u3059"),ne(),rt()}}function fK(t,n){if(1&t){const e=ft();it(0),Q(1,"div")(2,"label")(3,"b",8),ve(4,"\u30bf\u30d6\u540d: "),ne(),Q(5,"input",9),Ae("ngModelChange",function(r){return Re(e),Le(me().tabName=r)}),ne()()(),Q(6,"div",10)(7,"label")(8,"input",11),Ae("ngModelChange",function(r){return Re(e),Le(me().isUseStandImage=r)})("change",function(){Re(e);const r=me();return Le(r.isUseStandImage=!!r.isUseStandImage)}),ne(),ve(9," \u{1f4ad}\u3001\u30ab\u30c3\u30c8\u30a4\u30f3\u3001\u30b9\u30bf\u30f3\u30c9\u6709\u52b9 "),ne()(),Q(10,"div",10)(11,"label")(12,"input",11),Ae("ngModelChange",function(r){return Re(e),Le(me().recieveOperationLogLevel=r)})("change",function(){Re(e);const r=me();return Le(r.recieveOperationLogLevel=r.recieveOperationLogLevel>0?1:0)}),ne(),ve(13," \u64cd\u4f5c\u30ed\u30b0\u3092\u53d7\u4fe1\u3059\u308b "),ne()(),mt(14,"hr"),Q(15,"div"),Te(16,uK,17,6,"ng-container",6),Te(17,dK,3,0,"ng-container",6),ne(),rt()}if(2&t){const e=me();G(5),oe("ngModel",e.tabName),Qt("disabled",e.isEditable?null:""),G(3),xt("checked",e.isUseStandImage?"checked":""),oe("ngModel",e.isUseStandImage),Qt("disabled",e.isEditable?null:""),G(4),xt("checked",e.recieveOperationLogLevel>0?"checked":""),oe("ngModel",e.recieveOperationLogLevel),Qt("disabled",e.isEditable?null:""),G(4),oe("ngIf",!e.isDeleted),G(1),oe("ngIf",e.isDeleted)}}function hK(t,n){1&t&&(it(0),Q(1,"div",21),ve(2,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b\u300d\u304b\u3089\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),ne(),rt())}let pK=(()=>{class t{constructor(e,i,r,o,s){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.saveDataService=o,this.pointerDeviceService=s,this.selectedTab=null,this.selectedTabXml="",this.isSaveing=!1,this.progresPercent=0}get tabName(){return this.selectedTab.name}set tabName(e){this.isEditable&&(this.selectedTab.name=e)}get isUseStandImage(){return this.selectedTab.isUseStandImage}set isUseStandImage(e){this.isEditable&&(this.selectedTab.isUseStandImage=e)}get recieveOperationLogLevel(){return this.selectedTab.recieveOperationLogLevel}set recieveOperationLogLevel(e){this.isEditable&&(this.selectedTab.recieveOperationLogLevel=e)}get chatTabs(){return this.chatMessageService.chatTabs}get isEmpty(){return this.chatMessageService.chatTabs.length<1}get isDeleted(){return!!this.selectedTab&&null==Ct.instance.get(this.selectedTab.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}get roomName(){return Ot.peerContext&&0<Ot.peerContext.roomName.length?Ot.peerContext.roomName:"\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf"}ngOnInit(){Promise.resolve().then(()=>{this.modalService.title=this.panelService.title="\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u8a2d\u5b9a",this.panelService.isAbleFullScreenButton=!1}),Ue.register(this).on("DELETE_GAME_OBJECT",2e3,e=>{if(!this.selectedTab||e.data.identifier!==this.selectedTab.identifier)return;let i=Ct.instance.get(e.data.identifier);null!==i&&(this.selectedTabXml=i.toXml())})}ngOnDestroy(){Ue.unregister(this)}onChangeSelectTab(e){this.selectedTab=Ct.instance.get(e),this.selectedTabXml=""}create(){Fs.instance.addChatTab("\u30bf\u30d6")}save(){var e=this;return(0,gn.Z)(function*(){if(!e.selectedTab||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i="fly_chat_"+e.selectedTab.name;yield e.saveDataService.saveGameObjectAsync(e.selectedTab,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}delete(){!this.isEmpty&&this.selectedTab&&(this.selectedTabXml=this.selectedTab.toXml(),this.selectedTab.destroy())}restore(){if(this.selectedTab&&this.selectedTabXml){let e=gi.instance.parseXml(this.selectedTabXml);Fs.instance.addChatTab(e),this.selectedTabXml=""}}upTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,i=e.children.indexOf(this.selectedTab);0<i&&e.insertBefore(this.selectedTab,e.children[i-1])}downTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,i=e.children.indexOf(this.selectedTab);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.selectedTab)}showLogOutput(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(II,{left:e.x-250,top:e.y-175,width:450,height:300}).selectedTab=this.selectedTab}}return t.\u0275fac=function(e){return new(e||t)(He(Yn),He(qn),He(Hr),He(Gr),He(Ci))},t.\u0275cmp=fn({type:t,selectors:[["app-chat-tab-setting"]],decls:10,vars:4,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[2,"font-size","smaller","margin-bottom","2px",3,"click"],["size","10",2,"width","100%","max-width","140px",3,"ngModel","change"],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[3,"value","title"],[2,"font-size","smaller"],["placeholder","Name",2,"width","200px",3,"ngModel","ngModelChange"],[2,"font-weight","bolder","font-size","smaller","padding-top","3px"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[3,"click"],[2,"float","right"],[1,"material-icons","small-font"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,i){1&e&&(Q(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Ae("click",function(){return i.create()}),ve(4,"\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b"),ne()(),Q(5,"select",3),Ae("change",function(o){return i.onChangeSelectTab(o.target.value)}),Te(6,aK,2,5,"option",4),ne()(),Q(7,"div",5),Te(8,fK,18,10,"ng-container",6),ne()(),Te(9,hK,3,0,"ng-container",6)),2&e&&(G(5),oe("ngModel",null==i.selectedTab?null:i.selectedTab.identifier),G(1),oe("ngForOf",i.chatTabs),G(2),oe("ngIf",!i.isEmpty&&i.selectedTab),G(1),oe("ngIf",i.isEmpty))},dependencies:[si,_i,Bn,oo,so,Ii,Oo,$o,Mi,yi],styles:["[_nghost-%COMP%]{display:block}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}.small-font[_ngcontent-%COMP%]{font-size:16px;vertical-align:middle}"]}),t})();const gK=["edit"];function mK(t,n){1&t&&Pn(0)}function _K(t,n){if(1&t&&(it(0),Te(1,mK,1,0,"ng-container",11),rt()),2&t){me();const e=cn(11);G(1),oe("ngTemplateOutlet",e)}}function $K(t,n){1&t&&Pn(0)}function vK(t,n){if(1&t&&(it(0),Te(1,$K,1,0,"ng-container",11),rt()),2&t){me();const e=cn(13);G(1),oe("ngTemplateOutlet",e)}}function bK(t,n){1&t&&Pn(0)}function yK(t,n){1&t&&Pn(0)}function CK(t,n){if(1&t&&(Q(0,"div"),Te(1,yK,1,0,"ng-container",11),ne()),2&t){me();const e=cn(19);G(1),oe("ngTemplateOutlet",e)}}function wK(t,n){1&t&&Pn(0)}function xK(t,n){if(1&t&&(it(0),Te(1,wK,1,0,"ng-container",11),rt()),2&t){me();const e=cn(13);G(1),oe("ngTemplateOutlet",e)}}function EK(t,n){1&t&&Pn(0)}function TK(t,n){if(1&t&&(it(0),Te(1,EK,1,0,"ng-container",11),rt()),2&t){me();const e=cn(11);G(1),oe("ngTemplateOutlet",e)}}const SK=function(t,n){return{"black-paint":t,"face-icon":n}};function IK(t,n){if(1&t&&(mt(0,"img",15),Lt(1,"safe")),2&t){const e=me(2);oe("src",Bt(1,2,null==e.imageFile?null:e.imageFile.url,"resourceUrl"),vn)("ngClass",un(5,SK,1==e.chatMessage.isBlackPaint,e.chatMessage.isFaceIcon))}}const MK=function(t,n){return{inverse:t,hollow:n}},kK=function(t,n,e,i,r,o,s,a){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}};function DK(t,n){if(1&t&&(Q(0,"div",12)(1,"span",13),Te(2,IK,2,8,"img",14),ne()()),2&t){const e=me();oe("ngClass",un(3,MK,1==e.chatMessage.isInverseIcon,1==e.chatMessage.isHollowIcon)),G(1),oe("ngClass",Ms(6,kK,0==e.chatMessage.aura,1==e.chatMessage.aura,2==e.chatMessage.aura,3==e.chatMessage.aura,4==e.chatMessage.aura,5==e.chatMessage.aura,6==e.chatMessage.aura,7==e.chatMessage.aura)),G(1),oe("ngIf",0<(null==e.imageFile||null==e.imageFile.url?null:e.imageFile.url.length))}}function AK(t,n){if(1&t&&(it(0),Q(1,"span",19),ve(2),Lt(3,"date"),ne(),rt()),2&t){const e=me(2);G(2),lt(Bt(3,1,e.chatMessage.timestamp,"H:mm"))}}function PK(t,n){if(1&t&&(mt(0,"img",22),Lt(1,"safe")),2&t){const e=me(3);oe("src",Bt(1,1,null==e.toImageFile?null:e.toImageFile.url,"resourceUrl"),vn)}}const zv=function(t){return{grow:t}};function NK(t,n){if(1&t&&(it(0),Te(1,PK,2,4,"img",20),Q(2,"span",18),ve(3),ne(),Q(4,"span",21),ve(5,"\u27a1"),ne(),rt()),2&t){const e=me(2);G(1),oe("ngIf",0<(null==e.toImageFile||null==e.toImageFile.url?null:e.toImageFile.url.length)),G(1),ut("color",e.chatMessage.toColor&&"#ffffff"!=e.chatMessage.toColor?e.chatMessage.toColor:""),oe("ngClass",wt(5,zv,e.chatMessage.isDirect||e.chatMessage.isSecret)),G(1),lt(e.chatMessage.toName)}}function OK(t,n){if(1&t&&(mt(0,"img",22),Lt(1,"safe")),2&t){const e=me(3);oe("src",Bt(1,1,null==e.toImageFile?null:e.toImageFile.url,"resourceUrl"),vn)}}function FK(t,n){if(1&t&&(it(0),Q(1,"span",23),ve(2,"\u27a1"),ne(),Te(3,OK,2,4,"img",20),Q(4,"span",18),ve(5),ne(),rt()),2&t){const e=me(2);G(3),oe("ngIf",0<(null==e.toImageFile||null==e.toImageFile.url?null:e.toImageFile.url.length)),G(1),ut("color",e.chatMessage.toColor&&"#ffffff"!=e.chatMessage.toColor?e.chatMessage.toColor:""),oe("ngClass",wt(5,zv,e.chatMessage.isDirect||e.chatMessage.isSecret)),G(1),lt(e.chatMessage.toName)}}function RK(t,n){if(1&t){const e=ft();Q(0,"span",27),Ae("click",function(r){return Re(e),Le(me(3).onLinkClick(r))}),Lt(1,"safe"),ne()}2&t&&oe("innerHTML",Bt(1,1,me(3).htmlEscapedFrom,"html"),lr)}function LK(t,n){if(1&t&&(Q(0,"span",19),ve(1),Lt(2,"date"),ne()),2&t){const e=me(3);G(1),lt(Bt(2,1,e.chatMessage.timestamp,"y/M/d H:mm"))}}function BK(t,n){if(1&t&&(Q(0,"span",19),ve(1),Lt(2,"date"),ne()),2&t){const e=me(3);G(1),lt(Bt(2,1,e.chatMessage.timestamp,"H:mm"))}}function zK(t,n){1&t&&Pn(0)}function jK(t,n){if(1&t&&(it(0),Te(1,RK,2,4,"span",24),Te(2,LK,3,4,"span",25),Te(3,BK,3,4,"span",25),Te(4,zK,1,0,"ng-container",26),rt()),2&t){const e=me(2),i=cn(19);G(1),oe("ngIf",!e.isCompact),G(1),oe("ngIf",!e.isCompact&&e.chatMessage.timestamp),G(1),oe("ngIf",e.isCompact&&e.chatMessage.timestamp),G(1),oe("ngIf",!(e.isEditable&&!e.isCompact))("ngIfElse",i)}}function UK(t,n){if(1&t&&(Q(0,"div",16),Te(1,AK,4,4,"ng-container",2),Q(2,"span",17),Te(3,NK,6,7,"ng-container",2),Q(4,"span",18),ve(5),ne(),Te(6,FK,6,7,"ng-container",2),ne(),Te(7,jK,5,5,"ng-container",2),ne()),2&t){const e=me();G(1),oe("ngIf",e.isCompact&&!e.isMine&&e.chatMessage.timestamp),G(2),oe("ngIf",!e.isMine&&e.chatMessage.toColor),G(1),ut("color",e.chatMessage.color&&"#ffffff"!=e.chatMessage.color?e.chatMessage.color:""),oe("ngClass",wt(8,zv,e.chatMessage.isDirect||e.chatMessage.isSecret)),G(1),lt(e.chatMessage.name),G(1),oe("ngIf",e.isMine&&e.chatMessage.toColor),G(1),oe("ngIf",!e.isCompact||e.isMine)}}function HK(t,n){if(1&t){const e=ft();Q(0,"div",33)(1,"span",34),ve(2),ne(),Q(3,"textarea",35,36),Ae("ngModelChange",function(r){return Re(e),Le(me(2).editingText=r)})("keydown.enter",function(r){return Re(e),Le(me(2).editEnd(r))})("keydown.escape",function(){return Re(e),Le(me(2).editCancel())}),ne()()}if(2&t){const e=me(2);G(2),lt(e.lastNewLineAdjust(e.editingText)),G(1),oe("ngModel",e.editingText)}}function VK(t,n){if(1&t&&(Q(0,"span",37)(1,"b",38),ve(2,"\u7de8\u96c6\u6e08"),ne(),ve(3),Lt(4,"date"),ne()),2&t){const e=me(2);G(3),Zn(" ",Bt(4,1,e.chatMessage.lastUpdate,"M/d H:mm"),"")}}function GK(t,n){if(1&t){const e=ft();Q(0,"button",39),Ae("click",function(){return Re(e),Le(me(2).discloseMessage())}),ve(1,"\u7d50\u679c\u3092\u516c\u958b"),ne()}}function qK(t,n){if(1&t){const e=ft();Te(0,HK,5,2,"div",28),Q(1,"div")(2,"span",29)(3,"span",30),Ae("click",function(r){return Re(e),Le(me().onLinkClick(r))}),Lt(4,"safe"),ne(),Te(5,VK,5,4,"span",31),Te(6,GK,2,0,"button",32),ne()()}if(2&t){const e=me();oe("ngIf",e.isEditing),G(1),ut("display",e.isEditing?"none":"block"),G(2),ut("color",!e.chatMessage.isSpecialColor&&e.chatMessage.color&&"#ffffff"!=e.chatMessage.color?e.chatMessage.color:""),oe("innerHTML",Bt(4,8,e.htmlEscapedText,"html"),lr),G(2),oe("ngIf",!e.isEditing&&e.chatMessage.isEdited),G(1),oe("ngIf",e.chatMessage.isSecret)}}function WK(t,n){1&t&&(Q(0,"span")(1,"s"),ve(2,"\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09"),ne()())}function KK(t,n){if(1&t){const e=ft();Q(0,"button",45),Ae("click",function(){return Re(e),Le(me(2).editStart())}),Q(1,"i",46),ve(2,"edit"),ne()()}}function YK(t,n){1&t&&(Q(0,"button",47)(1,"i",46),ve(2,"clear"),ne()())}function ZK(t,n){if(1&t){const e=ft();Q(0,"button",48),Ae("click",function(){return Re(e),Le(me(2).editEnd())}),Q(1,"i",46),ve(2,"done"),ne()()}2&t&&oe("disabled",0==me(2).editingText.trim().length)}function XK(t,n){if(1&t){const e=ft();Q(0,"button",49),Ae("click",function(){return Re(e),Le(me(2).editCancel())}),Q(1,"i",46),ve(2,"clear"),ne()()}}function QK(t,n){if(1&t&&(Q(0,"span",40),Te(1,KK,3,0,"button",41),Te(2,YK,3,0,"button",42),Te(3,ZK,3,1,"button",43),Te(4,XK,3,0,"button",44),ne()),2&t){const e=me();ut("visibility",e.isEditing?"visible":""),G(1),oe("ngIf",!e.isEditing),G(1),oe("ngIf",!e.isEditing),G(1),oe("ngIf",e.isEditing),G(1),oe("ngIf",e.isEditing)}}const JK=function(t,n){return{compact:t,editing:n}},eY=function(t,n,e,i,r,o){return{"is-mine":t,"is-others":n,"direct-message":e,"system-message":i,"dicebot-message":r,"operation-log":o}},tY=function(t,n,e,i){return{"is-success":t,"is-failure":n,"is-critical":e,"is-fumble":i}};let nY=(()=>{class t{constructor(e,i,r){this.chatMessageService=e,this.modalService=i,this.changeDetector=r,this.compact=!1,this.imageFile=on.Empty,this.animeState="inactive",this.isEditing=!1,this.editingText="",this.stringUtil=pt}ngOnInit(){Ue.register(this).on("MESSAGE_EDITING_START",-1e3,r=>{r.isSendFromSelf&&(!r.data||r.data.messageIdentifier!==this.chatMessage.identifier)&&this.editCancel()}).on("CHANGE_GM_MODE",r=>{this.changeDetector.markForCheck()});let e=this.chatMessage.image;e&&(this.imageFile=e),e=this.chatMessage.toImage,e&&(this.toImageFile=e),this.chatMessageService.getTime()-1e4<this.chatMessage.timestamp&&(this.animeState="active")}ngAfterViewInit(){this.chatMessage.isAnimated=!0}get isMine(){return this.chatMessage.isSendFromSelf}get isEditable(){return this.chatMessage.isEditable}get isCompact(){return this.compact||this.chatMessage.isOperationLog}get htmlEscapedFrom(){return this._htmlEscapeLinking(this.chatMessage.from,!0)}get htmlEscapedText(){let e=this._htmlEscapeLinking(this.chatMessage.text,!1,!this.chatMessage.isOperationLog);return this.chatMessage.isDicebot&&(e=di.decorationDiceResult(e)),e}_htmlEscapeLinking(e,i=!1,r=!1){return e=pt.escapeHtml(e),r&&(e=pt.rubyToHtml(e)),vv.link(this.lastNewLineAdjust(e),{urls:{schemeMatches:!0,wwwMatches:!0,tldMatches:!1},truncate:{length:48,location:"end"},decodePercentEncoding:i,stripPrefix:i,stripTrailingSlash:i,email:!1,phone:!1,replaceFn:function(o){if("url"==o.getType()&&pt.validUrl(o.getAnchorHref())){if(pt.sameOrigin(o.getAnchorHref()))return!0;{const s=o.buildTag();return s.setAttr("rel","nofollow"),s.addClass("outer-link"),s}}return!1}})}discloseMessage(){this.chatMessage.tag=this.chatMessage.tag.replace("secret","")}editStart(){Ue.trigger("MESSAGE_EDITING_START",{messageIdentifier:this.chatMessage.identifier}),this.editingText=this.chatMessage.text,this.isEditing=!0,setTimeout(()=>{this.editElm.nativeElement&&this.editElm.nativeElement.focus()})}editEnd(e=null){e&&e.preventDefault(),(!e||13===e.keyCode)&&(this.isEditable&&this.editingText.trim().length>0&&this.chatMessage.text!=this.editingText?(this.chatMessage.isSecret||(this.chatMessage.lastUpdate=Date.now()),this.chatMessage.text=this.editingText,this.isEditing=!1):this.editCancel())}editCancel(){this.isEditing=!1}lastNewLineAdjust(e){return null==e?"":!this.isEditing&&(this.chatMessage.isEdited||this.chatMessage.isSecret)||e.lastIndexOf("\n")!=e.length-1?e:e+"\n"}onLinkClick(e){if(e&&"A"==e.target.tagName){const i=e.target.getAttribute("href");if(!pt.sameOrigin(i))return e.preventDefault(),this.modalService.open(lo,{url:e.target.getAttribute("href")}),!1}return!0}}return t.\u0275fac=function(e){return new(e||t)(He(Hr),He(Yn),He(Ki))},t.\u0275cmp=fn({type:t,selectors:[["chat-message"]],viewQuery:function(e,i){if(1&e&&wn(gK,5),2&e){let r;Cn(r=xn())&&(i.editElm=r.first)}},inputs:{chatMessage:"chatMessage",compact:"compact"},features:[Ti([{provide:_x,useValue:!1}])],decls:20,vars:36,consts:[[1,"container",3,"ngClass"],[1,"message",3,"ngClass"],[4,"ngIf"],[1,"body"],[1,"text","msg-text",3,"ngClass"],[4,"ngIf","ngIfThen","ngIfElse"],["image",""],["title",""],["visible",""],["secret",""],["editor",""],[4,"ngTemplateOutlet"],[1,"image",3,"ngClass"],[1,"aura",3,"ngClass"],["draggable","false",3,"src","ngClass",4,"ngIf"],["draggable","false",3,"src","ngClass"],[1,"title"],[1,"msg-name"],[3,"ngClass"],[1,"tip","msg-timestamp"],["draggable","false","class","mini-icon",3,"src",4,"ngIf"],[2,"display","inline-block","margin","0px 6px","user-select","none","transform","rotateY(180deg)"],["draggable","false",1,"mini-icon",3,"src"],[2,"display","inline-block","margin","0px 6px","user-select","none"],["class","tip msg-from",3,"innerHTML","click",4,"ngIf"],["class","tip msg-timestamp",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"tip","msg-from",3,"innerHTML","click"],["style","position: relative",4,"ngIf"],[2,"display","inline-block"],[3,"innerHTML","click"],["class","is-edited",4,"ngIf"],["style","padding-top: 1px; padding-bottom: 1px; margin-left: 3px;",3,"click",4,"ngIf"],[2,"position","relative"],["aria-hidden","true",2,"visibility","hidden","display","inline-block"],[2,"position","absolute","top","0px","left","0px","width","100%","height","100%",3,"ngModel","ngModelChange","keydown.enter","keydown.escape"],["edit",""],[1,"is-edited"],[2,"white-space","nowrap"],[2,"padding-top","1px","padding-bottom","1px","margin-left","3px",3,"click"],[1,"edit-buttons",2,"margin-left","4px","white-space","nowrap"],["class","edit-button","title","\u7de8\u96c6",3,"click",4,"ngIf"],["class","edit-button","aria-hidden","true","style","visibility: hidden",4,"ngIf"],["class","edit-button","title","\u78ba\u5b9a",3,"disabled","click",4,"ngIf"],["class","edit-button","title","\u30ad\u30e3\u30f3\u30bb\u30eb",3,"click",4,"ngIf"],["title","\u7de8\u96c6",1,"edit-button",3,"click"],[1,"material-icons","small-font"],["aria-hidden","true",1,"edit-button",2,"visibility","hidden"],["title","\u78ba\u5b9a",1,"edit-button",3,"disabled","click"],["title","\u30ad\u30e3\u30f3\u30bb\u30eb",1,"edit-button",3,"click"]],template:function(e,i){if(1&e&&(Q(0,"div",0)(1,"div",1),Te(2,_K,2,1,"ng-container",2),Q(3,"div",3),Te(4,vK,2,1,"ng-container",2),Q(5,"div",4),Te(6,bK,1,0,"ng-container",5),ne(),Te(7,CK,2,1,"div",2),Te(8,xK,2,1,"ng-container",2),ne(),Te(9,TK,2,1,"ng-container",2),ne()(),Te(10,DK,3,15,"ng-template",null,6,ti),Te(12,UK,8,10,"ng-template",null,7,ti),Te(14,qK,7,11,"ng-template",null,8,ti),Te(16,WK,3,0,"ng-template",null,9,ti),Te(18,QK,5,6,"ng-template",null,10,ti)),2&e){const r=cn(15),o=cn(17);oe("ngClass",un(21,JK,i.isCompact,i.isEditing)),G(1),ut("border-left-color",!i.chatMessage.isSystem||i.chatMessage.isDicebot||i.chatMessage.isCalculate?i.chatMessage.color:"#444444")("border-right-color",!i.chatMessage.isSystem||i.chatMessage.isDicebot||i.chatMessage.isCalculate?i.chatMessage.color:"#444444"),oe("ngClass",H_(24,eY,i.isMine,!i.isMine,i.chatMessage.isDirect||i.chatMessage.isSecret,i.chatMessage.isSystem,i.chatMessage.isDicebot||i.chatMessage.isCalculate,i.chatMessage.isOperationLog))("@flyInOut",i.isMine?null:"active")("@flyInOutMe",i.isMine?"active":null),G(1),oe("ngIf",i.isMine&&!i.isCompact),G(1),ut("justify-content",i.isCompact&&!i.isMine?"flex-end":"flex-start"),G(1),oe("ngIf",!i.isCompact||i.isMine),G(1),ut("flex-grow",i.isCompact&&!i.isEditing?0:1),oe("ngClass",Is(31,tY,(!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf)&&i.chatMessage.isSuccess,(!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf)&&i.chatMessage.isFailure,(!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf)&&i.chatMessage.isCritical,(!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf)&&i.chatMessage.isFumble)),G(1),oe("ngIf",!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf||i.chatMessage.isGMMode)("ngIfThen",r)("ngIfElse",o),G(1),oe("ngIf",i.isEditable&&i.isCompact),G(1),oe("ngIf",i.isCompact&&!i.isMine),G(1),oe("ngIf",!i.isMine&&!i.isCompact)}},dependencies:[si,Bn,Jl,Ii,Mi,yi,zw,$i],styles:['[_nghost-%COMP%]{display:block}.container[_ngcontent-%COMP%]{width:100%;overflow-x:hidden;box-sizing:border-box}.message[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;box-sizing:border-box;padding:5px;width:100%;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;border-bottom:1px dotted #999}.is-mine.message[_ngcontent-%COMP%]{border-left:4px solid #555}.is-others.message[_ngcontent-%COMP%]{border-right:4px solid #555}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc;border-bottom:1px dotted #CCC}.is-mine.direct-message[_ngcontent-%COMP%]{border-left:4px solid #555}.is-others.direct-message[_ngcontent-%COMP%]{border-right:4px solid #555}.operation-log[_ngcontent-%COMP%]{color:#666;background-color:#cccc}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{padding:0;width:50px;height:50px;flex-shrink:0;vertical-align:top;pointer-events:none}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img.face-icon[_ngcontent-%COMP%]{border-radius:.5rem}.message[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{flex-grow:1}.message[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{vertical-align:top;font-size:14px;padding-left:12px;padding-right:12px}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.message[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{vertical-align:top;padding:2px 12px 0;font-size:14px}.message[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{font-size:8px;padding-left:12px}.msg-name[_ngcontent-%COMP%]{font-weight:700}.msg-text[_ngcontent-%COMP%]{white-space:pre-wrap}.dicebot-message[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%]{font-size:8px}.dicebot-message[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{color:#11f}.direct-message.dicebot-message[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{color:#ccf}.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-success[_ngcontent-%COMP%]{color:#17f}.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-failure[_ngcontent-%COMP%]{color:#f05}.direct-message.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-success[_ngcontent-%COMP%]{color:#adf}.direct-message.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-failure[_ngcontent-%COMP%]{color:#f66}.dicebot-message[_ngcontent-%COMP%]{border-left:4px transparent}.dicebot-message[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%], .dicebot-message[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%], .operation-log[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%], .operation-log[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{font-style:oblique}.is-others[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .is-others[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{text-align:right}.is-others[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-align:left;max-width:100%}.is-edited[_ngcontent-%COMP%]{margin-left:2px;font-size:8px;vertical-align:bottom}.is-edited[_ngcontent-%COMP%]:before{content:"("}.is-edited[_ngcontent-%COMP%]:after{content:")"}.edit-button[_ngcontent-%COMP%]{padding:0 6px;vertical-align:10%;margin:0 1px 0 0}.edit-buttons[_ngcontent-%COMP%]{visibility:hidden}.container[_ngcontent-%COMP%]:hover   .edit-buttons[_ngcontent-%COMP%]{visibility:visible}textarea[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,"M+ 1p",sans-serif;margin:-3px;font-size:14px;resize:none}.small-font[_ngcontent-%COMP%]{font-size:14px;vertical-align:bottom}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #00f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 6px #ccc) drop-shadow(0 -4px 4px #fff)}.msg-timestamp[_ngcontent-%COMP%]{white-space:nowrap}.container.compact[_ngcontent-%COMP%]{overflow:hidden}.container.compact.editing[_ngcontent-%COMP%]{padding-top:1px}.container.compact[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{padding:2px!important}.container.compact[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap}.container.compact[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{min-width:6em}.container.compact[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .container.compact[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .container.compact[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{padding:0 3px;text-align:left}.container.compact[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%]{flex-grow:0}.container.compact[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{flex-grow:1}.container.compact[_ngcontent-%COMP%]   .edit-buttons[_ngcontent-%COMP%]{display:none}.container.compact[_ngcontent-%COMP%]:hover   .edit-buttons[_ngcontent-%COMP%], .container.compact.editing[_ngcontent-%COMP%]   .edit-buttons[_ngcontent-%COMP%]{display:inline-block}.container.compact[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{margin:-3px}.grow[_ngcontent-%COMP%]{text-shadow:1px 0px 1px #ffffff,0px 1px 1px #ffffff,-1px 0px 1px #ffffff,0px -1px 1px #ffffff}.mini-icon[_ngcontent-%COMP%]{display:inline-block;padding:0;width:1rem;height:1rem;vertical-align:middle;border-radius:.2rem;-o-object-fit:cover;object-fit:cover;margin-right:2px;filter:drop-shadow(1px 1px 1px #ffffff) drop-shadow(-1px -1px 1px #ffffff)}'],data:{animation:[Vn("flyInOut",[tn("* => active",[Zt("200ms ease-out",bn([dt({transform:"translateX(100px)",opacity:"0",offset:0}),dt({transform:"translateX(0)",opacity:"1",offset:1})]))]),tn("void => *",[Zt("200ms ease-out",bn([dt({opacity:"0",offset:0}),dt({opacity:"1",offset:1})]))])]),Vn("flyInOutMe",[tn("* => active",[Zt("200ms ease-out",bn([dt({transform:"translateX(-100px)",opacity:"0",offset:0}),dt({transform:"translateX(0)",opacity:"1",offset:1})]))]),tn("void => *",[Zt("200ms ease-out",bn([dt({opacity:"0",offset:0}),dt({opacity:"1",offset:1})]))])])]}}),t})();const iY=["logContainer"],rY=["messageContainer"];function oY(t,n){if(1&t&&mt(0,"chat-message",7),2&t){const e=me().$implicit,i=me(2);oe("chatMessage",e)("compact",i.compact)("@.disabled",i.compact||e.isAnimated)}}function sY(t,n){if(1&t&&(it(0),Te(1,oY,1,3,"chat-message",6),rt()),2&t){const e=n.$implicit;G(1),oe("ngIf",e.isDisplayable)}}function aY(t,n){if(1&t&&(it(0),Te(1,sY,2,1,"ng-container",5),rt()),2&t){const e=me();G(1),oe("ngForOf",e.chatMessages)("ngForTrackBy",e.trackByChatMessage)}}function lY(t,n){if(1&t&&mt(0,"chat-message",7),2&t){const e=n.$implicit,i=me(2);oe("chatMessage",e)("compact",i.compact)("@.disabled",i.compact||e.isAnimated)}}function cY(t,n){if(1&t&&(it(0),Te(1,lY,1,3,"chat-message",8),rt()),2&t){const e=me();G(1),oe("ngForOf",e.sampleMessages)}}const jv=window.navigator.userAgent.toLowerCase(),MI=jv.indexOf("iphone")>-1||jv.indexOf("ipad")>-1||jv.indexOf("macintosh")>-1&&"ontouchend"in document;let uY=(()=>{class t{constructor(e,i,r){this.ngZone=e,this.changeDetector=i,this.panelService=r,this.compact=!1,this.sampleMessages=[{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",tag:"mine",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u30b5\u30fc\u30d0\u30fc\u3092\u4f7f\u7528\u3057\u306a\u3044TRPG\u30aa\u30f3\u30bb\u30c4\u30fc\u30eb\u3067\u3059\u3002\u53c2\u52a0\u8005\u540c\u58eb\u3067\u63a5\u7d9a\u3057\u3001\u30b3\u30de\u3084\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u306a\u3069\u3092\u540c\u671f\u3057\u307e\u3059\u3002"},{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",tag:"mine",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u5168\u3066\u306e\u30c7\u30fc\u30bf\u304c\u5404\u53c2\u52a0\u8005\u306e\u30d6\u30e9\u30a6\u30b6\u5185\u306b\u3042\u308b\u305f\u3081\u3001\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3092\u5b9f\u884c\u3057\u3066\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u3092\u751f\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u4fdd\u5b58\u3057\u305fzip\u306e\u8aad\u307f\u8fbc\u307f\u306f\u30d6\u30e9\u30a6\u30b6\u753b\u9762\u3078\u306e\u30d5\u30a1\u30a4\u30eb\u30c9\u30ed\u30c3\u30d7\u3067\u884c\u3048\u307e\u3059\u3002"},{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",toColor:"#444444",tag:"mine direct",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",toName:"\u30d7\u30ec\u30a4\u30e4\u30fc",text:"\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\uff08\u79d8\u5bc6\u4f1a\u8a71\uff09\u306f\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\u306b\u8a18\u9332\u3055\u308c\u307e\u305b\u3093\u3002"},{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",toColor:"#444444",tag:"mine direct",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",toName:"\u30d7\u30ec\u30a4\u30e4\u30fc",text:"\u307e\u305f\u3001\u904e\u53bb\u306e\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u3042\u306a\u305f\u306eID\u304c\u66f4\u65b0\u3055\u308c\u308b\u3068\u540c\u3058\u30eb\u30fc\u30e0\u5185\u3067\u3042\u3063\u3066\u3082\u898b\u3048\u306a\u304f\u306a\u308a\u307e\u3059\u3002\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002"},{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",tag:"mine",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u52d5\u4f5c\u63a8\u5968\u74b0\u5883\u306f\u30c7\u30b9\u30af\u30c8\u30c3\u30d7Chrome\u3067\u3059\u3002\u4eca\u306e\u3068\u3053\u308d\u3001\u30b9\u30de\u30db\u304b\u3089\u3060\u3068\u4e0a\u624b\u304f\u64cd\u4f5c\u3067\u304d\u307e\u305b\u3093\u3002"},{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",tag:"mine",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u4ee5\u4e0a\u3067\u3059\u3002\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u6700\u521d\u306e\u30c1\u30e3\u30c3\u30c8\u3092\u5165\u529b\u3059\u308b\u3068\u975e\u8868\u793a\u306b\u306a\u308a\u307e\u3059\u3002"}],this.topTimestamp=0,this.botomTimestamp=0,this.needUpdate=!0,this.topElm=null,this.bottomElm=null,this.topElmBox=null,this.bottomElmBox=null,this.topIndex=0,this.bottomIndex=0,this.preScrollTop=0,this.scrollSpeed=0,this._chatMessages=[],this.scrollEventShortTimer=null,this.scrollEventLongTimer=null,this.addMessageEventTimer=null,this.callbackOnScroll=()=>this.onScroll(),this.callbackOnScrollToBottom=()=>this.resetMessages(),this.onAddMessage=new Hn}get minMessageHeight(){if(this.compact)return 26;let e=this.chatTab.chatMessages[this.chatTab.chatMessages.length-1];return e&&e.isOperationLog?26:61}get chatMessages(){if(!this.chatTab)return[];if(this.needUpdate){this.needUpdate=!1;let e=this.chatTab?this.chatTab.chatMessages:[];this.adjustIndex(),this._chatMessages=e.slice(this.topIndex,this.bottomIndex+1),this.topTimestamp=0<this._chatMessages.length?this._chatMessages[0].timestamp:0,this.botomTimestamp=0<this._chatMessages.length?this._chatMessages[this._chatMessages.length-1].timestamp:0}return this._chatMessages}get minScrollHeight(){return this.chatTab.chatMessages.reduce((i,r)=>i+(r.isDisplayable?this.compact||r.isOperationLog?26:61:0),0)}get topSpace(){return this.minScrollHeight-this.bottomSpace}get bottomSpace(){return 0<this.chatMessages.length?(this.chatTab.chatMessages.length-this.bottomIndex-1)*this.minMessageHeight:0}get isEmpty(){return this.chatTab.chatMessages.every(e=>!e.isDisplayable)}ngOnInit(){let e=[];for(let i of this.sampleMessages){let r=new di;for(let o in i)if("identifier"!==o&&"tabIdentifier"!==o){if("text"===o){r.value=i[o];continue}null==i[o]||""===i[o]||r.setAttribute(o,i[o])}e.push(r)}this.sampleMessages=e,Ue.register(this).on("MESSAGE_ADDED",i=>{let r=Ct.instance.get(i.data.messageIdentifier);!r||!this.chatTab.contains(r)||this.topTimestamp<=r.timestamp&&(this.changeDetector.markForCheck(),this.needUpdate=!0,this.onMessageInit())}).on("UPDATE_GAME_OBJECT",i=>{let r=Ct.instance.get(i.data.identifier);r&&r instanceof di&&this.topTimestamp<=r.timestamp&&r.timestamp<=this.botomTimestamp&&this.chatTab.contains(r)&&this.changeDetector.markForCheck()})}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.scrollEventShortTimer=new Oa(()=>this.lazyScrollUpdate(),33),this.scrollEventLongTimer=new Oa(()=>this.lazyScrollUpdate(!1),66),this.onScroll(),this.panelService.scrollablePanel.addEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.addEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1)})}ngOnDestroy(){Ue.unregister(this),this.panelService.scrollablePanel.removeEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.removeEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1),this.scrollEventShortTimer.clear(),this.scrollEventLongTimer.clear(),this.addMessageEventTimer&&clearTimeout(this.addMessageEventTimer),this.addMessageEventTimer=null}ngOnChanges(){Promise.resolve().then(()=>this.resetMessages())}ngAfterViewChecked(){!this.topElm||!this.bottomElm||this.ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>this.adjustScrollPosition())})}onMessageInit(){null==this.addMessageEventTimer&&this.ngZone.runOutsideAngular(()=>{this.addMessageEventTimer=setTimeout(()=>{this.addMessageEventTimer=null,this.ngZone.run(()=>this.onAddMessage.emit())},0)})}resetMessages(){let e=this.chatTab.chatMessages.length-1;this.topIndex=e-Math.floor(this.panelService.scrollablePanel.clientHeight/this.minMessageHeight),this.bottomIndex=e,this.needUpdate=!0,this.preScrollTop=-1,this.scrollSpeed=0,this.topElm=this.bottomElm=null,this.adjustIndex(),this.changeDetector.markForCheck()}trackByChatMessage(e,i){return i.identifier}adjustIndex(){let e=this.chatTab?this.chatTab.chatMessages:[],i=0<e.length?e.length-1:0;this.topIndex<0&&(this.topIndex=0),i<this.bottomIndex&&(this.bottomIndex=i),this.topIndex<0&&(this.topIndex=0),this.bottomIndex<0&&(this.bottomIndex=0),i<this.topIndex&&(this.topIndex=i),i<this.bottomIndex&&(this.bottomIndex=i)}getScrollPosition(){let e=this.panelService.scrollablePanel.scrollTop,i=this.panelService.scrollablePanel.clientHeight,r=this.panelService.scrollablePanel.scrollHeight;return e<0&&(e=0),r-i<e&&(e=r-i),{top:e,bottom:e+i,clientHeight:i,scrollHeight:r}}adjustScrollPosition(){if(!this.topElm||!this.bottomElm)return;let e=this.logContainerRef.nativeElement.contains(this.topElm),i=this.logContainerRef.nativeElement.contains(this.bottomElm),{hasTopBlank:r,hasBotomBlank:o}=this.checkBlank(e,i);this.topElm=this.bottomElm=null,(r||o||!e&&!i)&&jr(()=>this.lazyScrollUpdate())}checkBlank(e,i){let r=!e,o=!i;if(!e&&!i)return{hasTopBlank:r,hasBotomBlank:o};let s=null,a=null,h=null,b=0;i?(s=this.bottomElm,a=this.bottomElmBox):e&&(s=this.topElm,a=this.topElmBox),h=s.getBoundingClientRect(),b=a.top-h.top-this.scrollSpeed,(!r||!o)&&.25<b**2&&(this.panelService.scrollablePanel.scrollTop-=b);let ee=this.logContainerRef.nativeElement.getBoundingClientRect(),de=this.messageContainerRef.nativeElement.getBoundingClientRect(),ge=de.top-ee.top,xe=ge+de.height,ke=this.getScrollPosition();return r=ke.top<ge,o=xe<ke.bottom&&ke.bottom<ke.scrollHeight,{hasTopBlank:r,hasBotomBlank:o}}markForReadIfNeeded(){if(!this.chatTab.hasUnread)return;let e=this.getScrollPosition();e.scrollHeight<=e.bottom+100&&jr(()=>{this.chatTab.markForRead(),this.changeDetector.markForCheck(),this.ngZone.run(()=>{})})}onScroll(){this.scrollEventShortTimer.reset(),this.scrollEventLongTimer.isActive||this.scrollEventLongTimer.reset()}lazyScrollUpdate(e=!0){this.scrollEventShortTimer.stop(),this.scrollEventLongTimer.stop();let i=this.messageContainerRef.nativeElement.querySelectorAll("chat-message"),r=this.messageContainerRef.nativeElement.offsetTop,o=r+this.messageContainerRef.nativeElement.clientHeight,s=this.topIndex,a=this.bottomIndex,h=this.getScrollPosition();this.scrollSpeed=h.top-this.preScrollTop,this.preScrollTop=h.top;let b=h.top<r,ee=o<h.bottom&&h.bottom<h.scrollHeight;if(e||this.scrollEventShortTimer.reset(),!e&&!b&&!ee)return;let de=h.top-(!e&&b?100:1200),ge=h.bottom+(!e&&ee?100:1200);this.markForReadIfNeeded(),this.calcItemIndexRange(r,o,de,ge,h,i),(this.topIndex!=s||this.bottomIndex!=a)&&(this.needUpdate=!0,this.topElm=i[0],this.bottomElm=i[i.length-1],this.topElmBox=this.topElm.getBoundingClientRect(),this.bottomElmBox=this.bottomElm.getBoundingClientRect(),jr(()=>{let ke=this.getScrollPosition();this.scrollSpeed=ke.top-this.preScrollTop,this.preScrollTop=ke.top,this.changeDetector.markForCheck(),this.ngZone.run(()=>{})}))}calcElementMaxHeight(e){let i=this.minMessageHeight;for(let r=e.length-1;0<=r;r--){let o=e[r].clientHeight;i<o&&(i=o)}return i}calcItemIndexRange(e,i,r,o,s,a){if(r>=i||e>=o)this.bottomIndex=this.chatTab.chatMessages.length-1-Math.floor((s.scrollHeight-s.top-s.clientHeight)/this.minMessageHeight),this.topIndex=this.bottomIndex-Math.floor(s.clientHeight/this.minMessageHeight),this.bottomIndex+=1,this.topIndex-=1;else{let h=this.calcElementMaxHeight(a);r<e?this.topIndex-=Math.floor((e-r)/h)+1:r>e&&(MI||(this.topIndex+=Math.floor((r-e)/h))),i>o?MI||(this.bottomIndex-=Math.floor((i-o)/h)):i<o&&(this.bottomIndex+=Math.floor((o-i)/h)+1)}this.adjustIndex()}}return t.\u0275fac=function(e){return new(e||t)(He(Nn),He(Ki),He(qn))},t.\u0275cmp=fn({type:t,selectors:[["chat-tab"]],viewQuery:function(e,i){if(1&e&&(wn(iY,7),wn(rY,7)),2&e){let r;Cn(r=xn())&&(i.logContainerRef=r.first),Cn(r=xn())&&(i.messageContainerRef=r.first)}},inputs:{compact:"compact",chatTab:"chatTab"},outputs:{onAddMessage:"onAddMessage"},features:[Cs],decls:6,vars:6,consts:[[1,"log"],["logContainer",""],[1,"virtual-scroll-container"],["messageContainer",""],[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"chatMessage","compact",4,"ngIf"],[3,"chatMessage","compact"],[3,"chatMessage","compact",4,"ngFor","ngForOf"]],template:function(e,i){1&e&&(Q(0,"div",0,1)(2,"div",2,3),Te(4,aY,2,2,"ng-container",4),Te(5,cY,2,1,"ng-container",4),ne()()),2&e&&(ut("min-height",i.minScrollHeight,"px"),G(2),ut("margin-bottom",i.bottomSpace,"px"),G(2),oe("ngIf",!i.isEmpty),G(1),oe("ngIf",i.isEmpty))},dependencies:[_i,Bn,nY],styles:["[_nghost-%COMP%]{display:block}.log[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:flex-end;align-items:flex-end;width:100%;height:100%}.virtual-scroll-container[_ngcontent-%COMP%]{flex-shrink:0;width:100%}"],changeDetection:0}),t})();const dY=["chatTabComponemt"];function fY(t,n){if(1&t){const e=ft();Q(0,"chat-tab",15,16),Ae("onAddMessage",function(){return Re(e),Le(me().scrollToBottom())}),ne()}if(2&t){const e=me();oe("chatTab",e.chatTab)("compact",e.isCompact)}}function hY(t,n){1&t&&(Q(0,"div"),ve(1,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u306e\u5185\u5bb9\u304c\u66f4\u65b0\u3055\u308c\u307e\u3057\u305f\u3002\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u9078\u629e\u3057\u306a\u304a\u3059\u304b\u3001\u3053\u306e\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u958b\u304d\u306a\u304a\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),ne())}function pY(t,n){1&t&&(Q(0,"i",8),ve(1,"how_to_reg"),ne())}function gY(t,n){1&t&&(Q(0,"i",8),ve(1,"history_edu"),ne())}function mY(t,n){1&t&&mt(0,"badge",21),2&t&&oe("count",me().$implicit.unreadLength)}function _Y(t,n){if(1&t){const e=ft();Q(0,"label",17)(1,"input",18),Ae("ngModelChange",function(r){return Re(e),Le(me().chatTabidentifier=r)}),ne(),Q(2,"div")(3,"span"),ve(4),ne(),Te(5,pY,2,0,"i",19),Te(6,gY,2,0,"i",19),Te(7,mY,1,1,"badge",20),ne()()}if(2&t){const e=n.$implicit,i=me();G(1),xt("value",e.identifier),oe("ngModel",i.chatTabidentifier),G(2),ut("cursor",i.chatTabidentifier!=e.identifier?"pointer":"")("color",""==e.name&&i.chatTabidentifier!=e.identifier?"gray":""),G(1),lt(""==e.name?"(\u7121\u540d\u306e\u30bf\u30d6)":e.name),G(1),oe("ngIf",e.isUseStandImage),G(1),oe("ngIf",e.recieveOperationLogLevel>0),G(1),oe("ngIf",e.hasUnread)}}const kI=function(t){return{"is-active":t}};let Ku=(()=>{class t{constructor(e,i,r){this.chatMessageService=e,this.panelService=i,this.pointerDeviceService=r,this.sendFrom="Guest",this._isCompact=!1,this._chatTabidentifier="",this.isAutoScroll=!0,this.scrollToBottomTimer=null}get isNoticeOn(){return t.isNoticeOn}set isNoticeOn(e){t.isNoticeOn=e}get isCompact(){return this._isCompact}set isCompact(e){this._isCompact=e,this.chatTabComponemt.onScroll()}get gameType(){return this.chatMessageService.gameType?this.chatMessageService.gameType:"DiceBot"}set gameType(e){this.chatMessageService.gameType=e}get chatTabidentifier(){return this._chatTabidentifier}set chatTabidentifier(e){let i=this._chatTabidentifier!==e;this._chatTabidentifier=e,this.updatePanelTitle(),i&&this.scrollToBottom(!0)}get chatTab(){return Ct.instance.get(this.chatTabidentifier)}ngOnInit(){this.sendFrom=Qe.myCursor.identifier,this._chatTabidentifier=0<this.chatMessageService.chatTabs.length?this.chatMessageService.chatTabs[0].identifier:"",Ue.register(this).on("MESSAGE_ADDED",e=>{if(e.data.tabIdentifier!==this.chatTabidentifier)return;let i=Ct.instance.get(e.data.messageIdentifier);i&&i.isSendFromSelf?this.isAutoScroll=!0:this.checkAutoScroll(),this.isAutoScroll&&this.chatTab&&this.chatTab.markForRead()}),Promise.resolve().then(()=>this.updatePanelTitle())}ngAfterViewInit(){queueMicrotask(()=>this.scrollToBottom(!0))}ngOnDestroy(){Ue.unregister(this)}scrollToBottom(e=!1){if(e&&(this.isAutoScroll=!0),!this.isAutoScroll)return;let i=new CustomEvent("scrolltobottom",{});this.panelService.scrollablePanel.dispatchEvent(i),null==this.scrollToBottomTimer&&(this.scrollToBottomTimer=setTimeout(()=>{this.chatTab&&this.chatTab.markForRead(),this.scrollToBottomTimer=null,this.isAutoScroll=!1,this.panelService.scrollablePanel&&(this.panelService.scrollablePanel.scrollTop=this.panelService.scrollablePanel.scrollHeight)},0))}checkAutoScroll(){this.panelService.scrollablePanel&&(this.isAutoScroll=this.panelService.scrollablePanel.scrollHeight-this.panelService.scrollablePanel.clientHeight-150<=this.panelService.scrollablePanel.scrollTop)}updatePanelTitle(){this.panelService.title=this.chatTab&&""!==this.chatTab.name?"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6 - "+this.chatTab.name:"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6"}onSelectedTab(e){this.updatePanelTitle()}showTabSetting(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(pK,{left:e.x-250,top:e.y-175,width:460,height:330}).selectedTab=this.chatTab}showLogOutput(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(II,{left:e.x-250,top:e.y-175,width:460,height:300}).selectedTab=this.chatTab}sendChat(e){this.chatTab&&this.chatMessageService.sendMessage(this.chatTab,e.text,e.gameType,e.sendFrom,e.sendTo,e.color,e.isInverse,e.isHollow,e.isBlackPaint,e.aura,e.isUseFaceIcon,e.characterIdentifier,e.standIdentifier,e.standName,e.isUseStandImage)}trackByChatTab(e,i){return i.identifier}}return t.isNoticeOn=!1,t.\u0275fac=function(e){return new(e||t)(He(Hr),He(qn),He(Ci))},t.\u0275cmp=fn({type:t,selectors:[["chat-window"]],viewQuery:function(e,i){if(1&e&&wn(dY,5),2&e){let r;Cn(r=xn())&&(i.chatTabComponemt=r.first)}},decls:28,vars:15,consts:[[1,"component"],[1,"log"],[3,"chatTab","compact","onAddMessage",4,"ngIf"],[4,"ngIf"],[1,"sticky-bottom"],[1,"chat-tab"],["class","tab",4,"ngFor","ngForOf","ngForTrackBy"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[2,"float","right","padding","1px 4px 1px 2px","margin-left","2px","height","24px","box-sizing","border-box"],["title","\u53d7\u4fe1\u6642\u306b\u97f3\u3067\u901a\u77e5",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"ngClass","click"],[1,"material-icons",2,"font-size","1em"],[2,"color","red"],["title","\u7c21\u6613\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"ngClass","click"],[3,"chatTabidentifier","gameType","sendFrom","gameTypeChange","sendFromChange","chat"],[3,"chatTab","compact","onAddMessage"],["chatTabComponemt",""],[1,"tab"],["name","chat-tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],["class","material-icons small-font",4,"ngIf"],["class","badge",3,"count",4,"ngIf"],[1,"badge",3,"count"]],template:function(e,i){1&e&&(Q(0,"div",0)(1,"div",1),Te(2,fY,2,2,"chat-tab",2),Te(3,hY,2,0,"div",3),ne(),Q(4,"div",4)(5,"form")(6,"div",5),Te(7,_Y,8,10,"label",6),Q(8,"button",7),Ae("click",function(){return i.showTabSetting()}),Q(9,"i",8),ve(10,"settings"),ne(),ve(11,"\u30bf\u30d6"),ne(),Q(12,"button",7),Ae("click",function(){return i.showLogOutput()}),Q(13,"i",8),ve(14,"history_edu"),ne(),ve(15,"\u30ed\u30b0"),ne(),Q(16,"div",9)(17,"button",10),Ae("click",function(){return i.isNoticeOn=!i.isNoticeOn}),Q(18,"i",11),ve(19),ne(),Q(20,"sup",12),ve(21,"*"),ne()(),Q(22,"button",13),Ae("click",function(){return i.isCompact=!i.isCompact}),Q(23,"i",11),ve(24),ne(),Q(25,"sup",12),ve(26,"*"),ne()()()()(),Q(27,"chat-input",14),Ae("gameTypeChange",function(o){return i.gameType=o})("sendFromChange",function(o){return i.sendFrom=o})("chat",function(o){return i.sendChat(o)}),ne()()()),2&e&&(G(2),oe("ngIf",i.chatTab),G(1),oe("ngIf",!i.chatTab),G(4),oe("ngForOf",i.chatMessageService.chatTabs)("ngForTrackBy",i.trackByChatTab),G(10),oe("ngClass",wt(11,kI,i.isNoticeOn)),G(2),lt(i.isNoticeOn?"notifications_active":"notifications_off"),G(3),oe("ngClass",wt(13,kI,i.isCompact)),G(2),lt(i.isCompact?"list":"forum"),G(3),oe("chatTabidentifier",i.chatTabidentifier)("gameType",i.gameType)("sendFrom",i.sendFrom))},dependencies:[si,_i,Bn,nc,Ii,ol,Mi,tc,yi,Ma,ff,uY,mr],styles:["[_nghost-%COMP%]{display:block;height:100%}.loop-anime[_ngcontent-%COMP%]{animation:anime1 1.3s infinite ease-in-out}.component[_ngcontent-%COMP%]{min-height:100%;display:flex;flex-direction:column;justify-content:space-between;align-content:space-between}.sticky-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;width:100%;background-color:#f0dabdcc;border-top:1px dotted #666;margin-bottom:0}.chat-tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 4px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}label.compact[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.tab[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{vertical-align:top;font-size:.8rem}button.indicate[_ngcontent-%COMP%]{margin:0 0 0 1px}button.indicate[_ngcontent-%COMP%]:disabled{border-color:transparent}button.indicate[_ngcontent-%COMP%]:disabled   .material-icons[_ngcontent-%COMP%]{color:#000}button.indicate[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:.5}button.indicate.is-active[_ngcontent-%COMP%]{background-color:#fff}button.indicate.is-active[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:1}button.indicate[_ngcontent-%COMP%]   sup[_ngcontent-%COMP%]{display:inline-block;top:2px;position:relative}"]}),t})();const $Y=["root"],vY=["altitudeSlider"];function bY(t,n){if(1&t){const e=ft();Q(0,"span",12),ve(1," (\u9ad8\u5ea6 "),Q(2,"input",13),Ae("ngModelChange",function(r){return Re(e),Le(me(2).altitudeHande.altitude=r)}),ne(),ve(3,")"),ne()}if(2&t){const e=me(2);G(2),oe("ngModel",e.altitudeHande.altitude)("disabled",!e.altitudeHande.isHaveAltitude)}}function yY(t,n){if(1&t&&(Q(0,"div")(1,"div",10),ve(2),Te(3,bY,4,2,"span",11),ne()()),2&t){const e=me();G(1),ut("color",e.titleColor)("font-weight",e.titleBold?"bolder":"normal"),G(1),lt(e.title),G(1),oe("ngIf",e.altitudeHande)}}function CY(t,n){1&t&&(Q(0,"div",14)(1,"div",15),ve(2,"\u9ad8"),ne(),Q(3,"div",16),ve(4,"0"),ne(),Q(5,"div",17),ve(6,"\u4f4e"),ne()())}function wY(t,n){if(1&t){const e=ft();Q(0,"div",18)(1,"input",19,20),Ae("ngModelChange",function(r){return Re(e),Le(me().altitudeHande.altitude=r)}),ne()()}if(2&t){const e=me();G(1),xt("title",e.altitudeHande.altitude),oe("ngModel",e.altitudeHande.altitude)("disabled",!e.altitudeHande.isHaveAltitude)}}function xY(t,n){1&t&&Pn(0)}const EY=function(t){return{action:t}};function TY(t,n){if(1&t&&(it(0),Te(1,xY,1,0,"ng-container",21),rt()),2&t){const e=me().$implicit;me();const i=cn(12),r=cn(10);G(1),oe("ngTemplateOutlet","separator"===(null==e?null:e.type)?i:r)("ngTemplateOutletContext",wt(2,EY,e))}}function SY(t,n){if(1&t&&(it(0),Te(1,TY,2,4,"ng-container",2),rt()),2&t){const e=n.$implicit;G(1),oe("ngIf",e)}}function IY(t,n){1&t&&(Q(0,"span",43),ve(1,"\u26a0\ufe0f"),ne()),2&t&&xt("title",me().action.error)}function MY(t,n){1&t&&mt(0,"input",44),2&t&&oe("disabled",me().action.disabled)}function kY(t,n){1&t&&mt(0,"input",45),2&t&&oe("disabled",me().action.disabled)}function DY(t,n){1&t&&mt(0,"input",46),2&t&&oe("disabled",me().action.disabled)}function AY(t,n){1&t&&mt(0,"input",47),2&t&&oe("disabled",me().action.disabled)}function PY(t,n){1&t&&(Q(0,"span",48),ve(1,"\u25a0"),ne())}function NY(t,n){1&t&&(Q(0,"span",49),ve(1,"\u25a0"),ne())}function OY(t,n){1&t&&(Q(0,"span",50),ve(1,"\u25a0"),ne())}function FY(t,n){1&t&&(Q(0,"span",51),ve(1,"\u25a0"),ne())}function RY(t,n){1&t&&(Q(0,"span",52),ve(1,"\u25a0"),ne())}function LY(t,n){1&t&&(Q(0,"span",53),ve(1,"\u25a0"),ne())}function BY(t,n){1&t&&(Q(0,"span",54),ve(1,"\u25a0"),ne())}function zY(t,n){1&t&&(Q(0,"span",55),ve(1,"\u25a0"),ne())}function jY(t,n){if(1&t&&(Q(0,"span",56)(1,"i",57),ve(2),ne()()),2&t){const e=me().action;G(2),lt(e.materialIcon)}}function UY(t,n){1&t&&(Q(0,"sup",58),ve(1,"*"),ne())}function HY(t,n){if(1&t&&(Q(0,"span",59),mt(1,"img",60),Lt(2,"safe"),ne()),2&t){const e=me().action;G(1),oe("src",Bt(2,1,e.icon.url,"resourceUrl"),vn)}}function VY(t,n){1&t&&(Q(0,"i",61),ve(1,"open_in_new"),ne())}function GY(t,n){1&t&&(Q(0,"div",62)(1,"i",63),ve(2,"arrow_forward_ios"),ne()())}function qY(t,n){if(1&t&&mt(0,"context-menu",64),2&t){const e=me().action,i=me();oe("title",e.name)("actions",i.subMenu)("isSubmenu",!0)}}const WY=function(t,n){return{hasHighlight:t,disabled:n}},KY=function(t,n){return{"icon-menu":t,default:n}};function YY(t,n){if(1&t){const e=ft();Q(0,"li",22),Ae("click",function(){const o=Re(e).action,s=me();return Le(!(o.disabled||o.altitudeHande&&0==o.altitudeHande.altitude)&&s.doAction(o))})("mouseenter",function(){const o=Re(e).action,s=me();return Le(!(o.disabled||o.altitudeHande&&0==o.altitudeHande.altitude)&&s.showSubMenu(o))}),Q(1,"div",23),Te(2,IY,2,1,"span",24),Te(3,MY,1,1,"input",25),Te(4,kY,1,1,"input",26),Te(5,DY,1,1,"input",27),Te(6,AY,1,1,"input",28),Te(7,PY,2,0,"span",29),Te(8,NY,2,0,"span",30),Te(9,OY,2,0,"span",31),Te(10,FY,2,0,"span",32),Te(11,RY,2,0,"span",33),Te(12,LY,2,0,"span",34),Te(13,BY,2,0,"span",35),Te(14,zY,2,0,"span",36),Te(15,jY,3,1,"span",37),ve(16),Te(17,UY,2,0,"sup",38),Te(18,HY,3,4,"span",39),Te(19,VY,2,0,"i",40),ne(),Te(20,GY,3,0,"div",41),Te(21,qY,1,3,"context-menu",42),ne()}if(2&t){const e=n.action,i=me();ut("padding-left",e.icon?0:(e.level?e.level+1.5:1.5)-(i.altitudeHande?.5:0),"em")("color",e.color?e.color:"")("text-align",e.center?"center":""),oe("ngClass",un(28,WY,!(e.disabled||e.icon||e.altitudeHande&&0==e.altitudeHande.altitude),e.disabled||e.altitudeHande&&0==e.altitudeHande.altitude)),G(1),oe("ngClass",un(31,KY,e.icon,e.default)),G(1),oe("ngIf",e.error),G(1),oe("ngIf",e.name&&0==e.name.indexOf("\u2611")),G(1),oe("ngIf",e.name&&0==e.name.indexOf("\u2610")),G(1),oe("ngIf",e.name&&0==e.name.indexOf("\u25c9")),G(1),oe("ngIf",e.name&&0==e.name.indexOf("\u25cb")),G(1),oe("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30d6\u30e9\u30c3\u30af")),G(1),oe("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30d6\u30eb\u30fc")),G(1),oe("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30b0\u30ea\u30fc\u30f3")),G(1),oe("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30b7\u30a2\u30f3")),G(1),oe("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30ec\u30c3\u30c9")),G(1),oe("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30de\u30bc\u30f3\u30bf")),G(1),oe("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30a4\u30a8\u30ed\u30fc")),G(1),oe("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30db\u30ef\u30a4\u30c8")),G(1),oe("ngIf",e.materialIcon),G(1),Zn(" ",e.name.replace("\u2611","").replace("\u2610","").replace("\u25c9","").replace("\u25cb",""),""),G(1),oe("ngIf",e.selfOnly),G(1),oe("ngIf",e.icon&&0<(null==e.icon?null:e.icon.url.length)),G(1),oe("ngIf",e.isOuterLink),G(1),oe("ngIf",e.subActions&&!e.disabled),G(1),oe("ngIf",i.subMenu&&i.parentMenu===e)}}function ZY(t,n){1&t&&(Q(0,"li"),mt(1,"hr",65),ne())}const XY=function(t,n,e,i){return{"icons-panel":t,"submenu-panel":n,"is-max-limit":e,"pointer-events-none":i}};let QY=(()=>{class t{constructor(e,i,r){this.elementRef=e,this.contextMenuService=i,this.pointerDeviceService=r,this.title="",this.actions=[],this.titleColor=Qe.CHAT_DEFAULT_COLOR,this.titleBold=!1,this.isSubmenu=!1,this.callbackOnOutsideClick=o=>this.onOutsideClick(o)}get isPointerDragging(){return this.pointerDeviceService.isDragging}get altitudeHande(){for(let e of this.actions)if(e&&e.altitudeHande)return e.altitudeHande;return null}get isIconsMenu(){for(let e of this.actions)if(!e||!e.icon)return!1;return!0}ngOnInit(){this.isSubmenu||(this.title=this.contextMenuService.title,this.actions=this.contextMenuService.actions,this.titleColor=this.contextMenuService.titleColor,this.titleBold=this.contextMenuService.titleBold)}ngAfterViewInit(){this.isSubmenu?this.adjustPositionSub():(this.adjustPositionRoot(),document.addEventListener("touchstart",this.callbackOnOutsideClick,!0),document.addEventListener("mousedown",this.callbackOnOutsideClick,!0))}ngOnDestroy(){document.removeEventListener("touchstart",this.callbackOnOutsideClick,!0),document.removeEventListener("mousedown",this.callbackOnOutsideClick,!0)}onOutsideClick(e){!1===this.rootElementRef.nativeElement.contains(e.target)&&this.close()}onContextMenu(e){e.stopPropagation(),e.preventDefault()}adjustPositionRoot(){let e=this.rootElementRef.nativeElement;e.style.left=this.contextMenuService.position.x+"px",e.style.top=this.contextMenuService.position.y+"px";let i=e.getBoundingClientRect(),r=0,o=0;window.innerWidth<i.right+r&&(r+=window.innerWidth-(i.right+r)),i.left+r<0&&(r+=0-(i.left+r)),window.innerHeight<i.bottom+o&&(o+=window.innerHeight-(i.bottom+o)),i.top+o<0&&(o+=0-(i.top+o)),e.style.left=e.offsetLeft+r+"px",e.style.top=e.offsetTop+o+"px",this.altitudeSlider&&(this.altitudeSlider.nativeElement.style.height=e.clientHeight-72+"px")}adjustPositionSub(){let i=this.rootElementRef.nativeElement,r=this.elementRef.nativeElement.parentElement.getBoundingClientRect(),o=i.getBoundingClientRect(),s=0,a=0;window.innerWidth<o.right+s&&(s-=r.width+o.width,s+=8),o.left+s<0&&(s+=0-(o.left+s)),window.innerHeight<o.bottom+a&&(a+=window.innerHeight-(o.bottom+a)),o.top+a<0&&(a+=0-(o.top+a)),i.style.left=i.offsetLeft+s+"px",i.style.top=i.offsetTop+a+"px"}doAction(e){this.showSubMenu(e),null!=e.action&&(e.action(),this.close())}showSubMenu(e){this.hideSubMenu(),clearTimeout(this.showSubMenuTimer),!(null==e.subActions||e.subActions.length<1)&&(this.showSubMenuTimer=setTimeout(()=>{this.parentMenu=e,this.subMenu=e.subActions,clearTimeout(this.hideSubMenuTimer)},250))}hideSubMenu(){clearTimeout(this.hideSubMenuTimer),this.hideSubMenuTimer=setTimeout(()=>{this.subMenu=null},1200)}close(){this.contextMenuService&&this.contextMenuService.close()}}return t.\u0275fac=function(e){return new(e||t)(He(Ai),He(hr),He(Ci))},t.\u0275cmp=fn({type:t,selectors:[["context-menu"]],viewQuery:function(e,i){if(1&e&&(wn($Y,7),wn(vY,5)),2&e){let r;Cn(r=xn())&&(i.rootElementRef=r.first),Cn(r=xn())&&(i.altitudeSlider=r.first)}},hostBindings:function(e,i){1&e&&Ae("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{title:"title",actions:"actions",titleColor:"titleColor",titleBold:"titleBold",isSubmenu:"isSubmenu"},decls:13,vars:10,consts:[[1,"component",2,"display","flex","flex-direction","column",3,"ngClass","mouseleave"],["root",""],[4,"ngIf"],[2,"display","flex","align-items","center"],["class","altitude ruler","style","display: flex; align-self: stretch; flex-direction: column; align-content: center",4,"ngIf"],["class","altitude",4,"ngIf"],[2,"flex-grow","1"],[4,"ngFor","ngForOf"],["actionMenu",""],["separator",""],[1,"title"],["style","font-size: small;",4,"ngIf"],[2,"font-size","small"],["type","number","step","0.1",2,"font-size","small","width","3.6em","text-align","right",3,"ngModel","disabled","ngModelChange"],[1,"altitude","ruler",2,"display","flex","align-self","stretch","flex-direction","column","align-content","center"],[2,"margin-top","2em"],[2,"align-self","center","margin-top","auto","margin-bottom","auto"],[2,"margin-bottom","2em"],[1,"altitude"],["type","range","max","12","min","-12","step","0.5","orient","vertical",1,"altitude",3,"title","ngModel","disabled","ngModelChange"],["altitudeSlider",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngClass","click","mouseenter"],[1,"menu-title",3,"ngClass"],[3,"title",4,"ngIf"],["type","checkbox","checked","",3,"disabled",4,"ngIf"],["type","checkbox",3,"disabled",4,"ngIf"],["type","radio","checked","",3,"disabled",4,"ngIf"],["type","radio",3,"disabled",4,"ngIf"],["class","color-indicator","style","color: #000",4,"ngIf"],["class","color-indicator","style","color: #00f",4,"ngIf"],["class","color-indicator","style","color: #0f0",4,"ngIf"],["class","color-indicator","style","color: #0ff",4,"ngIf"],["class","color-indicator","style","color: #f00",4,"ngIf"],["class","color-indicator","style","color: #f0f",4,"ngIf"],["class","color-indicator","style","color: #ff0",4,"ngIf"],["class","color-indicator","style","color: #fff",4,"ngIf"],["style","vertical-align: top",4,"ngIf"],["class","self-only",4,"ngIf"],["class","imagebox",4,"ngIf"],["class","material-icons","style","font-size: 1rem",4,"ngIf"],["class","sub-menu-arrow",4,"ngIf"],[3,"title","actions","isSubmenu",4,"ngIf"],[3,"title"],["type","checkbox","checked","",3,"disabled"],["type","checkbox",3,"disabled"],["type","radio","checked","",3,"disabled"],["type","radio",3,"disabled"],[1,"color-indicator",2,"color","#000"],[1,"color-indicator",2,"color","#00f"],[1,"color-indicator",2,"color","#0f0"],[1,"color-indicator",2,"color","#0ff"],[1,"color-indicator",2,"color","#f00"],[1,"color-indicator",2,"color","#f0f"],[1,"color-indicator",2,"color","#ff0"],[1,"color-indicator",2,"color","#fff"],[2,"vertical-align","top"],[1,"material-icons",2,"font-size","150%","padding-left","2px"],[1,"self-only"],[1,"imagebox"],[1,"image",3,"src"],[1,"material-icons",2,"font-size","1rem"],[1,"sub-menu-arrow"],[1,"material-icons",2,"font-size","1em","vertical-align","bottom"],[3,"title","actions","isSubmenu"],[1,"separator"]],template:function(e,i){1&e&&(Q(0,"div",0,1),Ae("mouseleave",function(){return i.hideSubMenu()}),Te(2,yY,4,6,"div",2),Q(3,"div",3),Te(4,CY,7,0,"div",4),Te(5,wY,3,3,"div",5),Q(6,"div",6)(7,"ul"),Te(8,SY,2,1,"ng-container",7),ne()()()(),Te(9,YY,22,34,"ng-template",null,8,ti),Te(11,ZY,2,0,"ng-template",null,9,ti)),2&e&&(oe("ngClass",Is(5,XY,i.isIconsMenu,i.isSubmenu,!i.isSubmenu,i.isPointerDragging)),G(2),oe("ngIf",!i.isIconsMenu&&0<i.title.length||i.altitudeHande),G(2),oe("ngIf",i.altitudeHande),G(1),oe("ngIf",i.altitudeHande),G(3),oe("ngForOf",i.actions))},dependencies:[si,_i,Bn,Jl,Ii,Fo,Ro,Mi,yi,t,$i],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;padding:0;white-space:nowrap;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;z-index:2000000}.submenu-panel[_ngcontent-%COMP%]{position:absolute;left:calc(100% - 4px);top:-16px}.icons-panel[_ngcontent-%COMP%]{padding-bottom:2px}.icons-panel[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{width:54px;padding:1px}.icons-panel[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{padding:1px 0}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-max-limit[_ngcontent-%COMP%]{max-height:100%;max-width:100%}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em;font-size:12px;text-align:center;padding:4px 16px;margin:0 2px;color:#444;border-bottom:1px solid #AAA}.menu-title[_ngcontent-%COMP%]{display:inline-block}hr.separator[_ngcontent-%COMP%]{margin:.1em -12px;height:1px;border:0;background-color:#aaa}.sub-menu-arrow[_ngcontent-%COMP%]{display:inline-block;position:absolute;top:2px;bottom:0;right:1px}ul[_ngcontent-%COMP%]{list-style:none;padding:2px 0;margin:0}ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:relative;cursor:-moz-default;cursor:-webkit-default;cursor:default;padding:2px 20px;font-size:12px;color:#444}ul[_ngcontent-%COMP%] > li.hasHighlight[_ngcontent-%COMP%]:hover{color:#ccc;background-color:#1e1e1ecc}.menu-title[_ngcontent-%COMP%]:not(.icon-menu){overflow:hidden;max-width:16.5em;text-overflow:ellipsis}td.altitude[_ngcontent-%COMP%]{vertical-align:middle}input.altitude[_ngcontent-%COMP%]{writing-mode:bt-lr;-webkit-appearance:slider-vertical;-moz-appearance:slider-vertical;appearance:slider-vertical;width:8px;height:100%;padding:3px}.disabled[_ngcontent-%COMP%]   .menu-title[_ngcontent-%COMP%], .disabled[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{color:gray}.altitude-view[_ngcontent-%COMP%]{color:#000;vertical-align:top;width:3em;text-align:right}.ruler[_ngcontent-%COMP%]{color:#444;font-size:small;padding-left:4px;padding-right:2px}.default[_ngcontent-%COMP%]{font-weight:bolder}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:50px;height:50px;max-width:50px;max-height:50px;vertical-align:top;margin-left:auto;margin-right:auto;text-align:center}.image[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:middle;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:.5rem}.icon-menu[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none}.icon-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid transparent;z-index:400}.icon-menu[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{border:2px dotted rgba(255,0,0,40);z-index:600}.icon-menu.default[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid red;z-index:500}.color-indicator[_ngcontent-%COMP%]{font-size:larger;text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff;margin-right:-.2rem}.self-only[_ngcontent-%COMP%]{color:red}"]}),t})(),JY=(()=>{class t{constructor(e,i,r){this.viewContainerRef=e,this.modalService=i,this.panelService=r,this.name="\u30b2\u30fc\u30e0\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",this.size=1,this.xml="",this.minSize=1,this.maxSize=20,this.tableBackgroundImage=on.createEmpty("null")}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u30fc"),Ue.register(this).on("SELECT_FILE",e=>{console.log("SELECT_FILE GameCharacterGeneratorComponent "+e.data.fileIdentifier);let r=Gt.instance.get(e.data.fileIdentifier);r&&(this.tableBackgroundImage=r)})}ngAfterViewInit(){}ngOnDestroy(){Ue.unregister(this)}createGameCharacter(){sn.create(this.name,this.size,this.tableBackgroundImage.identifier)}createGameTableMask(){let e=Tr.instance.viewTable;if(!e)return;let i=yo.create("\u30de\u30c3\u30d7\u30de\u30b9\u30af",5,5,100);e.appendChild(i)}createGameCharacterForXML(e){gi.instance.parseXml(e)}openModal(){this.modalService.open(aa)}}return t.\u0275fac=function(e){return new(e||t)(He(no),He(Yn),He(qn))},t.\u0275cmp=fn({type:t,selectors:[["game-character-generator"]],decls:15,vars:12,consts:[[3,"click"],["height","120",3,"src"],["placeholder","Name","name","name",3,"ngModel","ngModelChange"],["type","range","name","size",3,"ngModel","title","min","max","ngModelChange"],["type","number",3,"ngModel","min","max","ngModelChange"]],template:function(e,i){1&e&&(Q(0,"button",0),Ae("click",function(){return i.openModal()}),ve(1,"\u753b\u50cf\u3092\u9078\u3076"),ne(),Q(2,"div"),mt(3,"img",1),Lt(4,"safe"),ne(),Q(5,"input",2),Ae("ngModelChange",function(o){return i.name=o}),ne(),Q(6,"div")(7,"div")(8,"input",3),Ae("ngModelChange",function(o){return i.size=o}),ne(),ve(9," Size : "),Q(10,"input",4),Ae("ngModelChange",function(o){return i.size=o}),ne()(),Q(11,"button",0),Ae("click",function(){return i.createGameCharacter()}),ve(12,"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u4f5c\u308b"),ne(),Q(13,"button",0),Ae("click",function(){return i.createGameTableMask()}),ve(14,"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u4f5c\u308b"),ne()()),2&e&&(G(3),oe("src",Bt(4,9,i.tableBackgroundImage.url,"resourceUrl"),vn),G(2),oe("ngModel",i.name),G(3),xt("title",i.size),xt("min",i.minSize),xt("max",i.maxSize),oe("ngModel",i.size),G(2),xt("min",i.minSize),xt("max",i.maxSize),oe("ngModel",i.size))},dependencies:[Ii,Fo,Ro,Mi,Ys,Ks,yi,$i]}),t})();function eZ(t,n){1&t&&Pn(0)}function tZ(t,n){1&t&&Pn(0)}function nZ(t,n){if(1&t&&(Q(0,"div"),ve(1),ne()),2&t){const e=me();G(1),Zn("",e.getTabTitle(e.selectTab),"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306f\u7a7a\u3067\u3059")}}function iZ(t,n){if(1&t&&(Q(0,"div",12),ve(1),ne()),2&t){const e=me().$implicit;ut("background-color",e.ownerColor),G(1),lt(e.ownerName?e.ownerName:"\uff08\u7121\u540d\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\uff09")}}function rZ(t,n){1&t&&Pn(0)}const oZ=function(t,n,e){return{box:!0,selected:t,"is-hide-in":n,"is-inventory-no-indicate":e}},sZ=function(t){return{gameObject:t}};function aZ(t,n){if(1&t){const e=ft();Q(0,"div",9),Ae("contextmenu",function(r){const s=Re(e).$implicit;return Le(me().onContextMenu(r,s))})("click",function(){const o=Re(e).$implicit;return Le(me().selectGameObject(o))})("dblclick",function(r){const s=Re(e).$implicit;return Le(me().focusGameObject(s,r))}),Te(1,iZ,2,3,"div",10),Te(2,rZ,1,0,"ng-container",11),ne()}if(2&t){const e=n.$implicit,i=me(),r=cn(11);oe("ngClass",mo(4,oZ,i.selectedIdentifier===e.identifier,e.isHideIn,!e.isInventoryIndicate)),G(1),oe("ngIf",e.isHideIn&&null!=e.ownerName),G(1),oe("ngTemplateOutlet",r)("ngTemplateOutletContext",wt(8,sZ,e))}}function lZ(t,n){if(1&t){const e=ft();Q(0,"div",13)(1,"button",14),Ae("click",function(){return Re(e),Le(me().cleanInventory())}),ve(2,"\u5893\u5834\u3092\u7a7a\u306b\u3059\u308b"),ne()()}if(2&t){const e=me();G(1),Qt("disabled",e.getGameObjects(e.selectTab).length<1?"":null)}}function cZ(t,n){if(1&t){const e=ft();Q(0,"label")(1,"input",18),Ae("ngModelChange",function(r){return Re(e),Le(me(2).selectTab=r)}),ne(),Q(2,"div"),ve(3),ne()()}if(2&t){const e=n.$implicit,i=me(2);G(1),xt("value",e),oe("ngModel",i.selectTab),G(2),Ja("",i.getTabTitle(e)," (",i.getGameObjects(e).length,")")}}function uZ(t,n){if(1&t&&(Q(0,"form",15)(1,"div",16),Te(2,cZ,4,4,"label",17),ne()()),2&t){const e=me();G(2),oe("ngForOf",e.inventoryTypes)}}function dZ(t,n){if(1&t){const e=ft();it(0),Q(1,"div")(2,"div",19)(3,"b"),ve(4,"\u4e26\u3073\u9806: "),ne()(),Q(5,"input",20),Ae("ngModelChange",function(r){return Re(e),Le(me(2).sortTag=r)}),ne(),Q(6,"select",21),Ae("ngModelChange",function(r){return Re(e),Le(me(2).sortOrder=r)}),Q(7,"option",22),ve(8,"\u6607\u9806"),ne(),Q(9,"option",23),ve(10,"\u964d\u9806"),ne()()(),Q(11,"div",24)(12,"b"),ve(13,"\u8868\u793a\u9805\u76ee: "),ne()(),Q(14,"input",25),Ae("ngModelChange",function(r){return Re(e),Le(me(2).dataTag=r)}),ne(),Q(15,"div",13)(16,"button",26),Ae("click",function(){return Re(e),Le(me(2).toggleEdit())}),Q(17,"i",27),ve(18,"settings"),ne(),ve(19,"\u5b8c\u4e86"),ne()(),rt()}if(2&t){const e=me(2);G(5),oe("ngModel",e.sortTag),G(1),oe("ngModel",e.sortOrder),G(8),oe("ngModel",e.dataTag)}}function fZ(t,n){if(1&t&&(it(0),Q(1,"span"),ve(2),ne(),rt()),2&t){const e=me(3);G(2),Ja("",e.sortTag," (",e.sortOrderName,")")}}function hZ(t,n){1&t&&(it(0),ve(1,"-"),rt())}function pZ(t,n){if(1&t){const e=ft();Q(0,"label",32)(1,"input",33),Ae("ngModelChange",function(r){return Re(e),Le(me(3).indicateAll=r)}),ne(),Q(2,"b"),ve(3,"\u3059\u3079\u3066\u8868\u793a"),Q(4,"sup",34),ve(5,"*"),ne()()()}if(2&t){const e=me(3);G(1),oe("ngModel",e.indicateAll)}}function gZ(t,n){if(1&t){const e=ft();it(0),Q(1,"table",28)(2,"tr")(3,"th",29),ve(4,"\u4e26\u3073\u9806:"),ne(),Q(5,"td",29),Te(6,fZ,3,2,"ng-container",2),Te(7,hZ,2,0,"ng-container",2),ne(),Q(8,"td",30)(9,"button",26),Ae("click",function(){return Re(e),Le(me(2).toggleEdit())}),Q(10,"i",27),ve(11,"settings"),ne(),ve(12,"\u8a2d\u5b9a"),ne(),Te(13,pZ,6,1,"label",31),ne()()(),rt()}if(2&t){const e=me(2);G(6),oe("ngIf",0<e.sortTag.length),G(1),oe("ngIf",e.sortTag.length<1),G(6),oe("ngIf","table"===e.selectTab)}}function mZ(t,n){if(1&t&&(Te(0,dZ,20,3,"ng-container",2),Te(1,gZ,14,3,"ng-container",2)),2&t){const e=me();oe("ngIf",e.isEdit),G(1),oe("ngIf",!e.isEdit)}}function _Z(t,n){if(1&t&&(Q(0,"i",56),mt(1,"img",57),Lt(2,"safe"),ne()),2&t){const e=me().gameObject;G(1),oe("src",Bt(2,1,e.faceIcon.url,"resourceUrl"),vn)}}function $Z(t,n){1&t&&(Q(0,"i",42),ve(1,"emoji_emotions"),ne())}const vZ=function(t){return{opacity:t}};function bZ(t,n){if(1&t&&(Q(0,"i",56),mt(1,"img",58),Lt(2,"safe"),ne()),2&t){const e=me().gameObject;G(1),oe("ngStyle",wt(5,vZ,e.isDropShadow?.7:.3))("src",Bt(2,2,e.shadowImageFile.url,"resourceUrl"),vn)}}function yZ(t,n){if(1&t&&(Q(0,"i",42),ve(1),ne()),2&t){const e=me().gameObject;G(1),lt(e.isDropShadow?"star_half":"star_border")}}function CZ(t,n){if(1&t){const e=ft();Q(0,"button",59),Ae("click",function(r){Re(e);const o=me().gameObject;return Le(me().onContextMenu(r,o))}),Q(1,"i",60),ve(2,"settings"),ne()()}}const wZ=function(t,n,e,i){return{inverse:t,hollow:n,"is-hide-in":e,"black-paint":i}};function xZ(t,n){if(1&t&&(mt(0,"img",61),Lt(1,"safe")),2&t){const e=me().gameObject;oe("src",Bt(1,2,e.imageFile.url,"resourceUrl"),vn)("ngClass",Is(5,wZ,e.isInverse,e.isHollow,e.isHideIn,e.isBlackPaint))}}function EZ(t,n){1&t&&Pn(0)}const TZ=function(t,n){return{dataElm:t,name:n}};function SZ(t,n){if(1&t&&(it(0),Te(1,EZ,1,0,"ng-container",11),rt()),2&t){const e=n.$implicit,i=me(2).gameObject;me();const r=cn(13);G(1),oe("ngTemplateOutlet",r)("ngTemplateOutletContext",un(2,TZ,e,i.name))}}function IZ(t,n){if(1&t&&(Q(0,"div"),Te(1,SZ,2,5,"ng-container",62),ne()),2&t){const e=me().gameObject,i=me();G(1),oe("ngForOf",i.getInventoryTags(e))("ngForTrackBy",i.trackByGameObject)}}const Yu=function(t){return{"is-active":t}},DI=function(t){return{"is-hide-in":t}},MZ=function(t,n,e,i,r,o,s,a){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}};function kZ(t,n){if(1&t){const e=ft();Q(0,"div",35)(1,"div",36)(2,"button",37),Ae("click",function(){const o=Re(e).gameObject;return Le(o.isUseIconToOverviewImage=!o.isUseIconToOverviewImage)}),Te(3,_Z,3,4,"i",38),Te(4,$Z,2,0,"ng-template",null,39,ti),ne(),Q(6,"span",40),ve(7),ne(),Q(8,"button",41),Ae("click",function(){const o=Re(e).gameObject;return Le(o.isShowChatBubble=!o.isShowChatBubble)}),Q(9,"i",42),ve(10),ne()(),Q(11,"button",43),Ae("click",function(){const o=Re(e).gameObject;return Le(o.isDropShadow=!o.isDropShadow)}),Te(12,bZ,3,7,"i",38),Te(13,yZ,2,1,"ng-template",null,44,ti),ne(),Q(15,"button",45),Ae("click",function(){const o=Re(e).gameObject;return Le(o.isNotRide=!o.isNotRide)}),Q(16,"i",42),ve(17),ne()(),Q(18,"button",46),Ae("click",function(){const o=Re(e).gameObject;return Le(o.isAltitudeIndicate=!o.isAltitudeIndicate)}),Q(19,"i",47),ve(20,"straighten"),ne(),Q(21,"span",48),ve(22),ne()(),Q(23,"button",49),Ae("click",function(){const o=Re(e).gameObject;return Le(o.isInventoryIndicate=!o.isInventoryIndicate)}),Q(24,"i",42),ve(25,"all_inbox"),ne()(),Te(26,CZ,3,0,"button",50),ne(),Q(27,"div",51)(28,"div",52)(29,"span",53),Te(30,xZ,2,10,"img",54),ne()(),Q(31,"div",55),Te(32,IZ,2,2,"div",2),ne()()()}if(2&t){const e=n.gameObject,i=cn(5),r=cn(14),o=me();G(2),oe("disabled",o.selectedIdentifier!==e.identifier)("ngClass",wt(26,Yu,e.isUseIconToOverviewImage)),G(1),oe("ngIf",e.faceIcon&&0<(null==e.faceIcon?null:e.faceIcon.url.length))("ngIfElse",i),G(4),lt(e.name),G(1),oe("disabled",o.selectedIdentifier!==e.identifier)("ngClass",wt(28,Yu,e.isShowChatBubble)),G(2),lt(e.isShowChatBubble?"textsms":"speaker_notes_off"),G(1),oe("disabled",o.selectedIdentifier!==e.identifier)("ngClass",wt(30,Yu,e.isDropShadow)),G(1),oe("ngIf",e.shadowImageFile&&0<e.shadowImageFile.url.length)("ngIfElse",r),G(3),oe("disabled",o.selectedIdentifier!==e.identifier)("ngClass",wt(32,Yu,!e.isNotRide)),G(2),lt(e.isNotRide?"directions_run":"directions_bike"),G(1),oe("disabled",o.selectedIdentifier!==e.identifier)("ngClass",wt(34,Yu,e.isAltitudeIndicate)),G(4),lt(e.altitude),G(1),oe("disabled",o.selectedIdentifier!==e.identifier)("ngClass",wt(36,Yu,e.isInventoryIndicate)),G(3),oe("ngIf",o.selectedIdentifier===e.identifier),G(1),oe("ngClass",wt(38,DI,e.isHideIn)),G(1),oe("ngClass",wt(40,DI,e.isHideIn)),G(1),oe("ngClass",Ms(42,MZ,0==e.aura,1==e.aura,2==e.aura,3==e.aura,4==e.aura,5==e.aura,6==e.aura,7==e.aura)),G(1),oe("ngIf",e.imageFile.url),G(2),oe("ngIf",e.rootDataElement)}}function DZ(t,n){1&t&&(it(0),mt(1,"br"),rt())}function AZ(t,n){if(1&t){const e=ft();it(0),Q(1,"div",68)(2,"span"),ve(3),ne()(),Q(4,"div",69)(5,"div",70)(6,"div",71)(7,"div",72),ve(8),ne(),Q(9,"input",73),Ae("ngModelChange",function(r){return Re(e),Le(me(2).dataElm.value=r)}),ne()()()(),rt()}if(2&t){const e=me(2),i=e.dataElm,r=e.name;G(3),lt(i.name),G(5),lt(i.value),G(1),xt("type",i.value&&i.value==+i.value?"number":"text"),oe("logging.name",r)("logging.dataElement",i)("ngModel",i.value)}}const PZ=function(){return{"background-color":"green"}};function NZ(t,n){if(1&t){const e=ft();it(0),Q(1,"div",74)(2,"div",75)(3,"span"),ve(4),ne()(),Q(5,"input",76),Ae("ngModelChange",function(r){return Re(e),Le(me(2).dataElm.currentValue=r)}),ne()(),Q(6,"div",74)(7,"input",77),Ae("ngModelChange",function(r){return Re(e),Le(me(2).dataElm.currentValue=r)}),Lt(8,"safe"),ne()(),rt()}if(2&t){const e=me(2),i=e.dataElm,r=e.name;G(4),lt(i.name),G(1),oe("logging.name",r)("logging.dataElement",i)("ngModel",i.currentValue),Qt("data-init-value",i.currentValue),G(2),Sr(Bt(8,14,"font-size: 0.8em; min-width: 1em; width:"+(i.name.length+4.5)+"em; --min: 0; --max: "+i.value+"; --val:"+i.currentValue+";","style")),xt("title",i.currentValue),xt("max",+i.value?i.value:1e3),oe("logging.name",r)("logging.dataElement",i)("ngStyle",xa(17,PZ))("ngModel",i.currentValue),Qt("data-init-value",i.currentValue)}}function OZ(t,n){if(1&t){const e=ft();it(0),Q(1,"div",68)(2,"span"),ve(3),ne()(),Q(4,"div",69)(5,"div",70)(6,"div",71)(7,"input",78),Ae("ngModelChange",function(r){return Re(e),Le(me(2).dataElm.value=r)})("change",function(){Re(e);const r=me(2).dataElm;return Le(r.value=r.value?r.name:"")}),ne()()()(),rt()}if(2&t){const e=me(2),i=e.dataElm,r=e.name;G(1),ut("text-decoration",i.value?"none":"line-through"),G(2),lt(i.name),G(4),xt("checked",i.value?"checked":""),oe("logging.name",r)("logging.dataElement",i)("ngModel",i.value)}}function FZ(t,n){if(1&t&&(Q(0,"span",80),ve(1),ne()),2&t){const e=me(3).dataElm;G(1),Zn("(",(e.calcAbilityScore()>=0?"+":"")+e.calcAbilityScore(),")")}}function RZ(t,n){if(1&t){const e=ft();it(0),Q(1,"div",68)(2,"span"),ve(3),ne()(),Q(4,"div",69)(5,"div",70)(6,"div",71)(7,"div",72),ve(8),ne(),Q(9,"input",73),Ae("ngModelChange",function(r){return Re(e),Le(me(2).dataElm.value=r)}),ne(),Te(10,FZ,2,1,"span",79),ne()()(),rt()}if(2&t){const e=me(2),i=e.dataElm,r=e.name;G(3),lt(i.name),G(5),lt(i.value),G(1),xt("type",i.value&&i.value==+i.value?"number":"text"),oe("logging.name",r)("logging.dataElement",i)("ngModel",i.value),G(1),oe("ngIf",i.currentValue)}}const LZ=function(t){return{"outer-link":t}};function BZ(t,n){if(1&t){const e=ft();it(0),Q(1,"div",68)(2,"a",81),Ae("click",function(){Re(e);const r=me(2),o=r.dataElm,s=r.name,a=me();return Le(!!a.stringUtil.validUrl(o.value)&&a.openUrl(o.value,s,o.name))}),Lt(3,"safe"),Q(4,"span",82),ve(5),ne()()(),rt()}if(2&t){const e=me(2).dataElm,i=me();G(2),oe("ngClass",wt(8,LZ,!i.stringUtil.sameOrigin(e.value))),Qt("title",e.value)("href",Bt(3,5,i.stringUtil.validUrl(e.value)?e.value:"","url"),vn)("disabled",i.stringUtil.validUrl(e.value)?null:""),G(3),lt(e.name)}}function zZ(t,n){1&t&&Pn(0)}function jZ(t,n){1&t&&Pn(0)}function UZ(t,n){1&t&&Pn(0)}function HZ(t,n){if(1&t){const e=ft();it(0),Q(1,"div",68)(2,"span"),ve(3),ne()(),Q(4,"div",69)(5,"div",70)(6,"div",71)(7,"div",72),ve(8),ne(),Q(9,"input",83),Ae("ngModelChange",function(r){return Re(e),Le(me(3).dataElm.value=r)}),ne()()()(),rt()}if(2&t){const e=me(3).dataElm;G(3),lt(e.name),G(5),lt(e.value),G(1),xt("type","size"===e.name||"altitude"===e.name?"number":"text"),xt("min","size"===e.name?"0":""),oe("ngModel",e.value)}}function VZ(t,n){if(1&t&&(it(0),Te(1,HZ,10,5,"ng-container",2),rt()),2&t){const e=me(2).dataElm;G(1),oe("ngIf",0==e.children.length)}}function GZ(t,n){if(1&t&&(Q(0,"div",64),it(1,65),Te(2,AZ,10,6,"ng-container",66),Te(3,NZ,9,18,"ng-container",66),Te(4,OZ,8,7,"ng-container",66),Te(5,RZ,11,7,"ng-container",66),Te(6,BZ,6,10,"ng-container",66),Te(7,zZ,1,0,"ng-container",66),Te(8,jZ,1,0,"ng-container",66),Te(9,UZ,1,0,"ng-container",66),Te(10,VZ,2,1,"ng-container",67),rt(),ne()),2&t){const e=me().dataElm;G(1),oe("ngSwitch",e.attributes.type),G(1),oe("ngSwitchCase","simpleNumber"),G(1),oe("ngSwitchCase","numberResource"),G(1),oe("ngSwitchCase","checkProperty"),G(1),oe("ngSwitchCase","abilityScore"),G(1),oe("ngSwitchCase","url"),G(1),oe("ngSwitchCase","colors"),G(1),oe("ngSwitchCase","color"),G(1),oe("ngSwitchCase","note")}}function qZ(t,n){if(1&t&&(Te(0,DZ,2,0,"ng-container",2),Te(1,GZ,11,9,"div",63)),2&t){const e=n.dataElm,i=me();oe("ngIf",e&&i.newLineStrings.includes(e.name)),G(1),oe("ngIf",e&&!i.newLineStrings.includes(e.name))}}let WZ=(()=>{class t{constructor(e,i,r,o,s,a){this.changeDetector=e,this.panelService=i,this.inventoryService=r,this.contextMenuService=o,this.pointerDeviceService=s,this.modalService=a,this.inventoryTypes=["table","common","graveyard"],this.selectTab="table",this.selectedIdentifier="",this.isEdit=!1,this.stringUtil=pt,this.sortStopTimerId=null}get sortTag(){return this.inventoryService.sortTag}set sortTag(e){this.inventoryService.sortTag=e}get sortOrder(){return this.inventoryService.sortOrder}set sortOrder(e){this.inventoryService.sortOrder=e}get dataTag(){return this.inventoryService.dataTag}set dataTag(e){this.inventoryService.dataTag=e}get dataTags(){return this.inventoryService.dataTags}get indicateAll(){return this.inventoryService.indicateAll}set indicateAll(e){this.inventoryService.indicateAll=e}get sortOrderName(){return this.sortOrder===Ff.ASC?"\u6607\u9806":"\u964d\u9806"}get newLineStrings(){return this.inventoryService.newLineStrings}get isGMMode(){return!!Qe.myCursor&&Qe.myCursor.isGMMode}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),Ue.register(this).on("SELECT_TABLETOP_OBJECT",e=>{Ct.instance.get(e.data.identifier)instanceof Pi&&(this.selectedIdentifier=e.data.identifier,this.changeDetector.markForCheck())}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("UPDATE_INVENTORY",e=>{(e.isSendFromSelf||e.data)&&this.changeDetector.markForCheck()}).on("OPEN_NETWORK",e=>{this.inventoryTypes=["table","common",Ot.peerId,"graveyard"],this.inventoryTypes.includes(this.selectTab)||(this.selectTab=Ot.peerId)}),this.inventoryTypes=["table","common",Ot.peerId,"graveyard"]}ngOnDestroy(){Ue.unregister(this),this.sortStopTimerId&&clearTimeout(this.sortStopTimerId)}getTabTitle(e){switch(e){case"table":return"\u30c6\u30fc\u30d6\u30eb";case Ot.peerId:return"\u500b\u4eba";case"graveyard":return"\u5893\u5834";default:return"\u5171\u6709"}}getInventory(e){switch(e){case"table":return this.inventoryService.tableInventory;case Ot.peerId:return this.inventoryService.privateInventory;case"graveyard":return this.inventoryService.graveyardInventory;default:return this.inventoryService.commonInventory}}getGameObjects(e){return this.getInventory(e).tabletopObjects.filter(i=>"table"!=e||this.indicateAll||i.isInventoryIndicate)}getInventoryTags(e){return this.getInventory(e.location.name).dataElementMap.get(e.identifier)}onContextMenu(e,i){if(document.activeElement instanceof HTMLInputElement&&"range"!==document.activeElement.getAttribute("type")||(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;this.selectGameObject(i);const r=e.target;let o;if(r&&"BUTTON"===r.tagName){const h=r.getBoundingClientRect();o={x:window.pageXOffset+h.left+r.clientWidth,y:window.pageYOffset+h.top}}else o=this.pointerDeviceService.pointers[0];let s=[];"table"===i.location.name&&(this.isGMMode||i.isVisible)&&s.push({name:"\u30c6\u30fc\u30d6\u30eb\u4e0a\u304b\u3089\u63a2\u3059",action:()=>{"table"===i.location.name&&Ue.trigger("FOCUS_TABLETOP_OBJECT",{x:i.location.x,y:i.location.y,z:i.posZ+(i.altitude>0?50*i.altitude:0)})},default:"table"===i.location.name,disabled:"table"!==i.location.name,selfOnly:!0}),i.isHideIn&&s.push({name:"\u4f4d\u7f6e\u3092\u516c\u958b\u3059\u308b",action:()=>{i.owner="",Et.play(st.piecePut),Ue.trigger("UPDATE_INVENTORY",null)}}),(!i.isHideIn||!i.isVisible)&&s.push({name:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u308b\uff08\u30b9\u30c6\u30eb\u30b9\uff09",action:()=>{"table"===i.location.name&&!sn.isStealthMode&&!Qe.myCursor.isGMMode&&this.modalService.open(pr,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:Li.OK,materialIcon:"disabled_visible"}),i.owner=Ot.peerContext.userId,Et.play(st.sweep),Ue.call("UPDATE_INVENTORY",!0)}}),s.push(Ht),i.imageFiles.length>1&&(s.push({name:"\u753b\u50cf\u5207\u308a\u66ff\u3048",action:null,subActions:i.imageFiles.map((h,b)=>({name:i.currntImageIndex==b?"\u25c9":"\u25cb",action:()=>{i.currntImageIndex=b,Et.play(st.surprise),Ue.trigger("UPDATE_INVENTORY",null)},default:i.currntImageIndex==b,icon:h}))}),s.push(Ht)),s.push(i.isUseIconToOverviewImage?{name:"\u2611 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{i.isUseIconToOverviewImage=!1,Ue.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{i.isUseIconToOverviewImage=!0,Ue.trigger("UPDATE_INVENTORY",null)}}),s.push(i.isShowChatBubble?{name:"\u2611 \u{1f4ad}\u306e\u8868\u793a",action:()=>{i.isShowChatBubble=!1,Ue.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u{1f4ad}\u306e\u8868\u793a",action:()=>{i.isShowChatBubble=!0,Ue.trigger("UPDATE_INVENTORY",null)}}),s.push(i.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{i.isDropShadow=!1,Ue.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{i.isDropShadow=!0,Ue.trigger("UPDATE_INVENTORY",null)}}),s.push({name:"\u753b\u50cf\u52b9\u679c",action:null,subActions:[i.isInverse?{name:"\u2611 \u53cd\u8ee2",action:()=>{i.isInverse=!1,Ue.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u53cd\u8ee2",action:()=>{i.isInverse=!0,Ue.trigger("UPDATE_INVENTORY",null)}},i.isHollow?{name:"\u2611 \u307c\u304b\u3057",action:()=>{i.isHollow=!1,Ue.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u307c\u304b\u3057",action:()=>{i.isHollow=!0,Ue.trigger("UPDATE_INVENTORY",null)}},i.isBlackPaint?{name:"\u2611 \u9ed2\u5857\u308a",action:()=>{i.isBlackPaint=!1,Ue.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ed2\u5857\u308a",action:()=>{i.isBlackPaint=!0,Ue.trigger("UPDATE_INVENTORY",null)}},{name:"\u30aa\u30fc\u30e9",action:null,subActions:[{name:(-1==i.aura?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{i.aura=-1,Ue.trigger("UPDATE_INVENTORY",null)}},Ht].concat(["\u30d6\u30e9\u30c3\u30af","\u30d6\u30eb\u30fc","\u30b0\u30ea\u30fc\u30f3","\u30b7\u30a2\u30f3","\u30ec\u30c3\u30c9","\u30de\u30bc\u30f3\u30bf","\u30a4\u30a8\u30ed\u30fc","\u30db\u30ef\u30a4\u30c8"].map((h,b)=>({name:`${i.aura==b?"\u25c9":"\u25cb"} ${h}`,action:()=>{i.aura=b,Ue.trigger("UPDATE_INVENTORY",null)}})))},Ht,{name:"\u30ea\u30bb\u30c3\u30c8",action:()=>{i.isInverse=!1,i.isHollow=!1,i.isBlackPaint=!1,i.aura=-1,Ue.trigger("UPDATE_INVENTORY",null)},disabled:!i.isInverse&&!i.isHollow&&!i.isBlackPaint&&-1==i.aura}]}),s.push(Ht),s.push(i.isNotRide?{name:"\u2610 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{i.isNotRide=!1,Ue.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2611 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{i.isNotRide=!0,Ue.trigger("UPDATE_INVENTORY",null)}}),s.push(i.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{i.isAltitudeIndicate=!1,Ue.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{i.isAltitudeIndicate=!0,Ue.trigger("UPDATE_INVENTORY",null)}}),s.push({name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=i.altitude&&(i.altitude=0,"table"===i.location.name&&Et.play(st.sweep))},altitudeHande:i}),s.push(Ht),s.push({name:"\u8a73\u7d30\u3092\u8868\u793a...",action:()=>{this.showDetail(i)}}),s.push({name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a...",action:()=>{this.showChatPalette(i)},disabled:"graveyard"===i.location.name}),s.push({name:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a...",action:()=>{this.showStandSetting(i)}}),s.push(Ht),s.push({name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:i.getUrls().map(h=>{const b=h.value.toString();return{name:h.name?h.name:b,action:()=>{pt.sameOrigin(b)?window.open(b.trim(),"_blank","noopener"):this.modalService.open(lo,{url:b,title:i.name,subTitle:h.name})},disabled:!pt.validUrl(b),error:pt.validUrl(b)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:pt.validUrl(b)&&!pt.sameOrigin(b)}}),disabled:i.getUrls().length<=0}),s.push(Ht),s.push(i.isInventoryIndicate?{name:"\u2611 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{i.isInventoryIndicate=!1,Ue.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{i.isInventoryIndicate=!0,Ue.trigger("UPDATE_INVENTORY",null)}});let a=[{name:"table",alias:"\u30c6\u30fc\u30d6\u30eb"},{name:"common",alias:"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"},{name:Ot.peerId,alias:"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"},{name:"graveyard",alias:"\u5893\u5834"}];s.push({name:`${(a.find(h=>h.name==i.location.name)||a[1]).alias}\u304b\u3089\u79fb\u52d5`,action:null,subActions:a.filter((h,b)=>!(i.location.name==h.name||1==b&&!a.map(ee=>ee.name).includes(i.location.name))).map(h=>({name:`${h.alias}`,action:()=>{let b=sn.isStealthMode;Ue.call("FAREWELL_STAND_IMAGE",{characterIdentifier:i.identifier}),i.setLocation(h.name),"table"===h.name&&i.isHideIn&&i.isVisible&&!b&&!Qe.myCursor.isGMMode&&this.modalService.open(pr,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:Li.OK,materialIcon:"disabled_visible"}),Et.play("graveyard"==h.name?st.sweep:st.piecePut),Ue.call("UPDATE_INVENTORY",!0)}})),disabled:!i.isVisible&&!this.isGMMode}),s.push(Ht),s.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{this.cloneGameObject(i),Et.play(st.piecePut)},disabled:!i.isVisible&&!this.isGMMode}),s.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b\uff08\u81ea\u52d5\u63a1\u756a\uff09",action:()=>{const h=i.clone(),b=h.name.split("_");let ee;ee=b.length>1&&/\d+/.test(b[b.length-1])?b.slice(0,b.length-1).join("_"):b.join("_");let de=0;for(const ge of Ct.instance.getObjects(sn)){if(!ge.name.startsWith(ee))continue;let xe=ge.name.match(/_(\d+)$/)?+RegExp.$1:0;xe>de&&(de=xe)}h.name=ee+"_"+(de+1),h.update(),Et.play(st.piecePut)},disabled:!i.isVisible&&!this.isGMMode}),"graveyard"===i.location.name?(s.push(Ht),s.push({name:"\u524a\u9664\u3059\u308b\uff08\u5b8c\u5168\u306b\u524a\u9664\uff09",action:()=>{this.deleteGameObject(i),Et.play(st.sweep)}})):(s.push(Ht),s.push({name:"\u524a\u9664\u3059\u308b\uff08\u5893\u5834\u3078\u79fb\u52d5\uff09",action:()=>{Ue.call("FAREWELL_STAND_IMAGE",{characterIdentifier:i.identifier}),i.setLocation("graveyard"),Et.play(st.sweep)}})),this.contextMenuService.open(o,s,i.name)}toggleEdit(){this.isEdit=!this.isEdit}cleanInventory(){let e=this.getTabTitle(this.selectTab),i=this.getGameObjects(this.selectTab);this.modalService.open(pr,{title:"\u5893\u5834\u3092\u7a7a\u306b\u3059\u308b",text:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u5b8c\u5168\u306b\u524a\u9664\u3057\u307e\u3059\u304b\uff1f",helpHtml:`<b>${pt.escapeHtml(e)}</b>\u306b\u5b58\u5728\u3059\u308b <b>${i.length}</b> \u4f53\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u5b8c\u5168\u306b\u524a\u9664\u3057\u307e\u3059\u3002`,type:Li.OK_CANCEL,materialIcon:"delete_forever",action:()=>{for(const r of i)this.deleteGameObject(r);Et.play(st.sweep)}})}cloneGameObject(e){e.clone()}showDetail(e){Ue.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(r+=" - "+e.name),this.panelService.open(ps,{title:r,left:i.x-800,top:i.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(Lu,{left:i.x-250,top:i.y-175,width:620,height:350}).character=e}selectGameObject(e){Ue.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName,highlighting:!0})}focusGameObject(e,i){i.target instanceof HTMLElement&&(new Set(["input","button"]).has(i.target.tagName.toLowerCase())||"table"!==e.location.name||!e.isVisible&&!this.isGMMode||Ue.trigger("FOCUS_TABLETOP_OBJECT",{x:e.location.x,y:e.location.y,z:e.posZ+(e.altitude>0?50*e.altitude:0)}))}deleteGameObject(e){e.destroy(),this.changeDetector.markForCheck()}showStandSetting(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(yg,{left:i.x-400,top:i.y-175,width:730,height:572}).character=e}trackByGameObject(e,i){return i?i.identifier:e}openUrl(e,i=null,r=null){return pt.sameOrigin(e)?window.open(e.trim(),"_blank","noopener"):this.modalService.open(lo,{url:e,title:i,subTitle:r}),!1}onInput(){this.inventoryService.sortStop=!0,this.sortStopTimerId&&clearTimeout(this.sortStopTimerId),this.sortStopTimerId=setTimeout(()=>{this.inventoryService.sortStop=!1},666)}}return t.\u0275fac=function(e){return new(e||t)(He(Ki),He(qn),He(Bv),He(hr),He(Ci),He(Yn))},t.\u0275cmp=fn({type:t,selectors:[["game-object-inventory"]],decls:14,vars:6,consts:[[1,"component",3,"input"],[4,"ngTemplateOutlet"],[4,"ngIf"],["class","object-container",3,"ngClass","contextmenu","click","dblclick",4,"ngFor","ngForOf","ngForTrackBy"],["style","padding-top: 6px;",4,"ngIf"],["inventoryTab",""],["inventoryViewSetting",""],["gameObjectTags",""],["dataElmTag",""],[1,"object-container",3,"ngClass","contextmenu","click","dblclick"],["class","owner-tag",3,"background-color",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"owner-tag"],[2,"padding-top","6px"],[1,"danger",3,"click"],[1,"is-sticky-top"],[1,"tab"],[4,"ngFor","ngForOf"],["name","tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],[2,"font-size","12px"],["placeholder","\u30bf\u30b0\u540d",1,"order-control",3,"ngModel","ngModelChange"],[1,"order-control",3,"ngModel","ngModelChange"],["value","ASC"],["value","DESC"],[2,"font-size","12px","padding-top","6px"],["placeholder","\u30b9\u30da\u30fc\u30b9\u533a\u5207\u308a\u3067\u30bf\u30b0\u540d \u30b9\u30e9\u30c3\u30b7\u30e5\u3067\u6539\u884c ex.\u300cHP MP / \u30e1\u30e2\u300d",2,"width","100%","box-sizing","border-box",3,"ngModel","ngModelChange"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[2,"font-size","0.8em"],["nowrap","",2,"vertical-align","middle"],["width","100%","nowrap",""],["style","float: right; font-size: smaller",4,"ngIf"],[2,"float","right","font-size","smaller"],["type","checkbox",3,"ngModel","ngModelChange"],[1,"self_only"],[1,"inventory-object"],[1,"object-name"],["title","\u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854\u30a2\u30a4\u30b3\u30f3\u3092\u4f7f\u7528",1,"indicate",2,"font-size","0.8em","padding","1px","width","24px","height","16px","margin-bottom","1px",3,"disabled","ngClass","click"],["class","face-icon",4,"ngIf","ngIfElse"],["altImage",""],[1,"game-object-name",2,"margin-left","3px","margin-right","3px"],["title","\u{1f4ad}\u306e\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"disabled","ngClass","click"],[1,"material-icons",2,"font-size","1em"],["title","\u5f71\u306e\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","1px","width","24px","height","16px","margin-bottom","1px",3,"disabled","ngClass","click"],["altShadow",""],["title","\u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"disabled","ngClass","click"],["title","\u9ad8\u5ea6\u306e\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"disabled","ngClass","click"],[1,"material-icons","rotate",2,"font-size","1em"],[2,"display","inline-block","text-align","center","font-size","xx-small","color","gray","min-width","2em"],["title","\u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"disabled","ngClass","click"],["style","font-size: 0.8em; padding: 2px 5px;","title","\u30e1\u30cb\u30e5\u30fc",3,"click",4,"ngIf"],[1,"object-tags-box",3,"ngClass"],[1,"table-cell","image-box",3,"ngClass"],[1,"aura",3,"ngClass"],["class","inverser","draggable","false",3,"src","ngClass",4,"ngIf"],[1,"table-cell"],[1,"face-icon"],["alt","",3,"src"],["alt","",2,"filter","brightness(0)",3,"ngStyle","src"],["title","\u30e1\u30cb\u30e5\u30fc",2,"font-size","0.8em","padding","2px 5px",3,"click"],[1,"material-icons",2,"font-size","1em","pointer-events","none"],["draggable","false",1,"inverser",3,"src","ngClass"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","object-tag",4,"ngIf"],[1,"object-tag"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"tag-name"],[2,"text-align","center"],[2,"display","inline-block"],[1,"tag-value-box"],[1,"hidden-spacer",2,"font-weight","bold"],["appLogging","","size","1","placeholder","",1,"input","tag-value",3,"logging.name","logging.dataElement","type","ngModel","ngModelChange"],[1,"resource-tag"],[2,"font-size","0.8em","display","inline-block","margin-right","0.5em"],["appLogging","","type","number","size","1","placeholder","Value",1,"input","resource-value",3,"logging.name","logging.dataElement","ngModel","ngModelChange"],["appLogging","","type","range","min","0",3,"logging.name","logging.dataElement","title","max","ngStyle","ngModel","ngModelChange"],["appLogging","","type","checkbox",3,"logging.name","logging.dataElement","ngModel","checked","ngModelChange","change"],["style","font-size: smaller;",4,"ngIf"],[2,"font-size","smaller"],["target","_blank",3,"ngClass","click"],[1,"url-link"],["size","1",1,"input","tag-value",2,"min-width","4em",3,"type","min","ngModel","ngModelChange"]],template:function(e,i){if(1&e&&(Q(0,"div",0),Ae("input",function(){return i.onInput()}),Te(1,eZ,1,0,"ng-container",1),Te(2,tZ,1,0,"ng-container",1),Te(3,nZ,2,1,"div",2),Te(4,aZ,3,10,"div",3),Te(5,lZ,3,1,"div",4),ne(),Te(6,uZ,3,1,"ng-template",null,5,ti),Te(8,mZ,2,2,"ng-template",null,6,ti),Te(10,kZ,33,51,"ng-template",null,7,ti),Te(12,qZ,2,2,"ng-template",null,8,ti)),2&e){const r=cn(7),o=cn(9);G(1),oe("ngTemplateOutlet",r),G(1),oe("ngTemplateOutlet",o),G(1),oe("ngIf",i.getGameObjects(i.selectTab).length<1),G(1),oe("ngForOf",i.getGameObjects(i.selectTab))("ngForTrackBy",i.trackByGameObject),G(1),oe("ngIf","graveyard"===i.selectTab)}},dependencies:[si,_i,Bn,Jl,fr,Ql,Zd,Xd,nc,oo,so,Ii,Fo,Ro,Oo,$o,ol,Mi,tc,yi,Ma,hs,$i],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{width:100%}.box[_ngcontent-%COMP%]{border:transparent 2px solid;border-left:transparent 6px solid;margin-top:2px;padding:2px 2px 3px;box-sizing:border-box;border-bottom:1px dotted #666}.selected[_ngcontent-%COMP%]{padding:2px;border:2px dotted #666;border-left:6px solid #EFBC70}.selected.is-inventory-no-indicate[_ngcontent-%COMP%]{border-left-color:#80ccee}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;font-size:1em;min-width:1em;max-width:12em;overflow:hidden;padding:0 2px;box-sizing:border-box;white-space:nowrap}.input[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;padding:2px;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#EEE}.input[_ngcontent-%COMP%]:focus{background:#FFF}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.tab[_ngcontent-%COMP%]{padding:0;border:solid 1px #555;border-radius:.3em;overflow:hidden;display:flex;flex-flow:row nowrap;justify-content:space-around;align-items:stretch;text-align:center;margin:0;max-width:500px;background-color:#f0dabde6}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;flex:1 0 auto;flex-grow:1}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:checked{background:#555;color:#ccc}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{vertical-align:middle;outline:0;font-size:.6em;background-color:transparent;color:#444;box-sizing:border-box;margin:0;padding:2px 8px;cursor:pointer}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.is-sticky-top[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10000}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.table-cell[_ngcontent-%COMP%]{display:table-cell}.image-box[_ngcontent-%COMP%]{padding:0;width:32px;height:32px;display:table-cell;vertical-align:top}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%}.inventory-object[_ngcontent-%COMP%]{font-size:14px;display:inline-block;vertical-align:text-top}.object-name[_ngcontent-%COMP%]{font-size:.8em;font-weight:700;padding:0 .25em}.object-tags-box[_ngcontent-%COMP%]{display:table;table-layout:fixed}.object-tag[_ngcontent-%COMP%]{display:inline-block;padding:0 .25em;vertical-align:middle}.resource-tag[_ngcontent-%COMP%]{text-align:center;vertical-align:bottom;overflow:hidden;white-space:nowrap}.resource-value[_ngcontent-%COMP%]{font-weight:700;width:4em;text-align:right;font-family:inherit}.tag-name[_ngcontent-%COMP%]{font-size:.8em;text-align:left;vertical-align:bottom;min-width:1em;max-width:12em;overflow:hidden;white-space:nowrap}.tag-value-box[_ngcontent-%COMP%]{display:table-cell;width:10px}.tag-value[_ngcontent-%COMP%]{font-size:1em;font-weight:700;width:100%;min-width:1em;max-width:12em;text-align:center;font-family:inherit}.tag-value[type=number][_ngcontent-%COMP%]{min-width:3.4em;text-align:right}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.5}.inverser.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.inverser.is-hide-in[_ngcontent-%COMP%]{filter:invert(100%)}.inverser.black-paint.is-hide-in[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #00f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 3px #aaa) drop-shadow(0 -2px 2px #fff)}.material-icons.rotate[_ngcontent-%COMP%]{transform:rotate(90deg)}button.indicate[_ngcontent-%COMP%]:disabled{border-color:transparent}button.indicate[_ngcontent-%COMP%]:disabled   .material-icons[_ngcontent-%COMP%]{color:#000}button.indicate[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:.5}button.is-active[_ngcontent-%COMP%]{background-color:#fff}button.is-active[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:1}button.link[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}button.link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button.link[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}button.link[_ngcontent-%COMP%]:disabled{color:gray}button.link[_ngcontent-%COMP%]:disabled:hover{background-color:transparent}.face-icon[_ngcontent-%COMP%]{display:inline-block;width:12px;height:12px;max-width:12px;max-height:12px;vertical-align:middle;overflow:hidden}.face-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:.2rem}.self_only[_ngcontent-%COMP%]{color:red}.order-control[_ngcontent-%COMP%]{box-sizing:border-box;height:1.6em}.object-container.is-hide-in[_ngcontent-%COMP%]{background-color:#34549966}.object-container.is-hide-in[_ngcontent-%COMP%]   .game-object-name[_ngcontent-%COMP%], .object-tags-box.is-hide-in[_ngcontent-%COMP%]{color:#ddd;filter:invert(85%)}.image-box.is-hide-in[_ngcontent-%COMP%]{filter:invert(100%)}.object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:#ddd}.object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active, .object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{color:#222}.object-container[_ngcontent-%COMP%]{position:relative}.owner-tag[_ngcontent-%COMP%]{position:absolute;font-size:8px;width:-moz-min-content;width:min-content;max-width:100%;overflow:hidden;color:#f5f5f5;background-color:#1e1e1e;box-sizing:border-box;padding:2px 6px;border-radius:6px;white-space:nowrap;text-overflow:ellipsis;opacity:.9;top:1px;right:1px;pointer-events:none}.url-link[_ngcontent-%COMP%]{cursor:pointer}"],changeDetection:0}),t})();const KZ=on.create("./assets/images/skeleton.png");let Zu=(()=>{class t{constructor(){}getSkeletonOr(e){let i=e instanceof on?e:Gt.instance.get(e);return i&&!i.isEmpty?i:KZ}getEmptyOr(e){let i=e instanceof on?e:Gt.instance.get(e);return i&&!i.isEmpty?i:on.Empty}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=$n({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function YZ(t,n){if(1&t&&(Q(0,"option",11),ve(1),ne()),2&t){const e=n.$implicit;ut("color",""==e.name?"gray":""),xt("value",e.identifier),xt("title",e.name),G(1),lt(""==e.name?"(\u7121\u540d\u306e\u30c6\u30fc\u30d6\u30eb)":e.name)}}function ZZ(t,n){if(1&t&&(Q(0,"div",41)(1,"i",42),ve(2),ne()()),2&t){const e=me(2);G(1),Pd(e.isShowHideImages?"red-eye":"grow"),G(1),lt(e.isShowHideImages?"visibility":"visibility_off")}}function XZ(t,n){if(1&t){const e=ft();Q(0,"div")(1,"button",43),Ae("click",function(){return Re(e),Le(me(2).openDistanceViewImageModal())}),ve(2,"\u80cc\u666f\u753b\u50cf\u3092\u8ffd\u52a0"),ne()()}if(2&t){const e=me(2);G(1),oe("disabled",!e.isEditable)}}function QZ(t,n){if(1&t&&(Q(0,"div",41)(1,"i",42),ve(2),ne()()),2&t){const e=me(3);G(1),Pd(e.isShowHideImages?"red-eye":"grow"),G(1),lt(e.isShowHideImages?"visibility":"visibility_off")}}const AI=function(t){return{blackout:t}};function JZ(t,n){if(1&t){const e=ft();Q(0,"div",13),Ae("click",function(){return Re(e),Le(me(2).openDistanceViewImageModal())}),Te(1,QZ,3,3,"div",14),mt(2,"img",15),Lt(3,"safe"),ne()}if(2&t){const e=me(2);G(1),oe("ngIf",e.getHidden(e.tableDistanceviewImage)),G(1),oe("ngClass",wt(6,AI,!e.isShowHideImages&&e.getHidden(e.tableDistanceviewImage)))("src",Bt(3,3,e.tableDistanceviewImage.url,"resourceUrl"),vn)}}function eX(t,n){if(1&t&&(Q(0,"div",48),ve(1),ne()),2&t){const e=me(3);G(1),Zn("",e.progresPercent,"%")}}const tX=function(t){return{"is-hidden":t}};function nX(t,n){if(1&t){const e=ft();it(0),Q(1,"button",44),Ae("click",function(){return Re(e),Le(me(2).save())}),Q(2,"div",45)(3,"div",32),ve(4,"\u4fdd\u5b58"),ne(),Te(5,eX,2,1,"div",46),ne()(),Q(6,"button",47),Ae("click",function(){return Re(e),Le(me(2).delete())}),ve(7,"\u524a\u9664"),ne(),rt()}if(2&t){const e=me(2);G(1),oe("disabled",e.isSaveing),G(2),oe("ngClass",wt(4,tX,e.isSaveing)),G(2),oe("ngIf",e.isSaveing),G(1),oe("disabled",e.getGameTables().length<=1)}}function iX(t,n){if(1&t){const e=ft();it(0),Q(1,"button",49),Ae("click",function(){return Re(e),Le(me(2).restore())}),ve(2,"\u5143\u306b\u623b\u3059"),ne(),rt()}}const rX=function(t){return{disabled:t}};function oX(t,n){if(1&t){const e=ft();it(0),Q(1,"div",12)(2,"div")(3,"b"),ve(4,"\u753b\u50cf"),ne(),Q(5,"div",13),Ae("click",function(){return Re(e),Le(me().openBgImageModal())}),Te(6,ZZ,3,3,"div",14),mt(7,"img",15),Lt(8,"safe"),ne()(),Q(9,"div")(10,"b"),ve(11,"\u80cc\u666f"),ne(),Te(12,XZ,3,1,"div",10),Te(13,JZ,4,8,"div",16),ne()(),Q(14,"div")(15,"label",17),ve(16,"Name\uff1a"),Q(17,"input",18),Ae("ngModelChange",function(r){return Re(e),Le(me().tableName=r)}),ne()()(),Q(18,"div")(19,"label",17),ve(20,"Width\uff1a"),Q(21,"input",19),Ae("ngModelChange",function(r){return Re(e),Le(me().tableWidth=r)}),ne()(),Q(22,"input",20),Ae("ngModelChange",function(r){return Re(e),Le(me().tableWidth=r)}),ne()(),Q(23,"div")(24,"label",17),ve(25,"Height\uff1a"),Q(26,"input",21),Ae("ngModelChange",function(r){return Re(e),Le(me().tableHeight=r)}),ne()(),Q(27,"input",20),Ae("ngModelChange",function(r){return Re(e),Le(me().tableHeight=r)}),ne()(),Q(28,"div")(29,"label",17),ve(30,"\u30b0\u30ea\u30c3\u30c9\uff1a "),Q(31,"select",22),Ae("ngModelChange",function(r){return Re(e),Le(me().tableGridType=r)}),Q(32,"option",23),ve(33,"\u306a\u3057"),ne(),Q(34,"option",24),ve(35,"\u30b9\u30af\u30a8\u30a2"),ne(),Q(36,"option",25),ve(37,"\u30d8\u30af\u30b9\uff08\u7e26\u63c3\u3048\uff09"),ne(),Q(38,"option",26),ve(39,"\u30d8\u30af\u30b9\uff08\u6a2a\u63c3\u3048\uff09"),ne()()(),Q(40,"label",27),ve(41,"\u8272\uff1a "),Q(42,"select",28),Ae("ngModelChange",function(r){return Re(e),Le(me().tableGridColor=r)}),Q(43,"option",29),ve(44,"\u9ed2"),ne(),Q(45,"option",30),ve(46,"\u767d"),ne()()()(),Q(47,"div")(48,"label",17)(49,"input",31),Ae("ngModelChange",function(r){return Re(e),Le(me().tableGridNumberShow=r)}),ne(),Q(50,"span",32),ve(51,"\u30b0\u30ea\u30c3\u30c9\u306e\u5ea7\u6a19\u756a\u53f7\u3092\u8868\u793a"),ne()()(),Q(52,"div")(53,"label",17),ve(54,"\u80cc\u666f\u30d5\u30a3\u30eb\u30bf\uff1a "),Q(55,"select",33),Ae("ngModelChange",function(r){return Re(e),Le(me().tableDistanceviewFilter=r)}),Q(56,"option",34),ve(57,"\u306a\u3057"),ne(),Q(58,"option",35),ve(59,"\u30db\u30ef\u30a4\u30c8"),ne(),Q(60,"option",36),ve(61,"\u30d6\u30e9\u30c3\u30af"),ne()()()(),mt(62,"hr"),Q(63,"div")(64,"label",17)(65,"input",37),Ae("ngModelChange",function(r){return Re(e),Le(me().tableGridShow=r)}),ne(),ve(66," \u30b0\u30ea\u30c3\u30c9\u3092\u5e38\u306b\u8868\u793a"),Q(67,"sup",38),ve(68,"*"),ne()(),Q(69,"label",39)(70,"input",40),Ae("ngModelChange",function(r){return Re(e),Le(me().tableGridSnap=r)}),ne(),ve(71," \u30b9\u30ca\u30c3\u30d7"),Q(72,"sup",38),ve(73,"*"),ne()(),Te(74,nX,8,6,"ng-container",10),Te(75,iX,3,0,"ng-container",10),ne(),rt()}if(2&t){const e=me();G(6),oe("ngIf",e.getHidden(e.tableBackgroundImage)),G(1),oe("ngClass",wt(41,AI,!e.isShowHideImages&&e.getHidden(e.tableBackgroundImage)))("src",Bt(8,38,e.tableBackgroundImage.url,"resourceUrl"),vn),G(5),oe("ngIf",!e.tableDistanceviewImage.url),G(1),oe("ngIf",e.tableDistanceviewImage.url),G(4),oe("ngModel",e.tableName)("disabled",!e.isEditable),G(4),xt("title",e.tableWidth),xt("min",e.minSize),xt("max",e.maxSize),oe("ngModel",e.tableWidth)("disabled",!e.isEditable),G(1),xt("min",e.minSize),xt("max",e.maxSize),oe("ngModel",e.tableWidth)("disabled",!e.isEditable),G(4),xt("title",e.tableHeight),xt("min",e.minSize),xt("max",e.maxSize),oe("ngModel",e.tableHeight)("disabled",!e.isEditable),G(1),xt("min",e.minSize),xt("max",e.maxSize),oe("ngModel",e.tableHeight)("disabled",!e.isEditable),G(4),oe("ngModel",e.tableGridType)("disabled",!e.isEditable),G(11),oe("ngModel",e.tableGridColor)("disabled",!e.isEditable||-1==e.tableGridType),G(7),oe("ngModel",e.tableGridNumberShow)("disabled",!e.isEditable||-1==e.tableGridType),G(1),oe("ngClass",wt(43,rX,!e.isEditable||-1==e.tableGridType)),G(5),oe("ngModel",e.tableDistanceviewFilter)("disabled",!e.isEditable),G(10),oe("ngModel",e.tableGridShow),G(5),oe("ngModel",e.tableGridSnap),G(4),oe("ngIf",!e.isDeleted),G(1),oe("ngIf",e.isDeleted)}}function sX(t,n){1&t&&(it(0),Q(1,"div",50),ve(2,"\u203b\u30c6\u30fc\u30d6\u30eb\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b\u300d\u304b\u3089\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),ne(),rt())}const aX=function(t){return{"red-eye":t}};let PI=(()=>{class t{constructor(e,i,r,o,s){this.changeDetector=e,this.modalService=i,this.saveDataService=r,this.imageService=o,this.panelService=s,this.minSize=1,this.maxSize=100,this.isShowHideImages=!1,this.selectedTable=null,this.selectedTableXml="",this.isSaveing=!1,this.progresPercent=0}get tableBackgroundImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.imageIdentifier:null)}get tableDistanceviewImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.backgroundImageIdentifier:null)}get tableName(){return this.selectedTable.name}set tableName(e){this.isEditable&&(this.selectedTable.name=e)}get tableWidth(){return this.selectedTable.width}set tableWidth(e){this.isEditable&&(this.selectedTable.width=e)}get tableHeight(){return this.selectedTable.height}set tableHeight(e){this.isEditable&&(this.selectedTable.height=e)}get tableGridColor(){return this.selectedTable.gridColor}set tableGridColor(e){this.isEditable&&(this.selectedTable.gridColor=e)}get tableGridShow(){return this.tableSelecter.gridShow}set tableGridShow(e){this.tableSelecter.gridShow=e,Ue.trigger("UPDATE_GAME_OBJECT",this.tableSelecter.toContext())}get tableGridSnap(){return this.tableSelecter.gridSnap}set tableGridSnap(e){this.tableSelecter.gridSnap=e}get tableGridType(){return this.selectedTable.gridType}set tableGridType(e){this.isEditable&&(this.selectedTable.gridType=Number(e))}get tableGridNumberShow(){return this.selectedTable.isShowNumber}set tableGridNumberShow(e){this.selectedTable.isShowNumber=e,Ue.trigger("UPDATE_GAME_OBJECT",this.tableSelecter.toContext())}get tableDistanceviewFilter(){return this.selectedTable.backgroundFilterType}set tableDistanceviewFilter(e){this.isEditable&&(this.selectedTable.backgroundFilterType=e)}get tableSelecter(){return Tr.instance}get isEmpty(){return!this.tableSelecter||!this.tableSelecter.viewTable}get isDeleted(){return!this.selectedTable||null==Ct.instance.get(this.selectedTable.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}ngOnInit(){Promise.resolve().then(()=>{this.modalService.title=this.panelService.title="\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a"}),this.selectedTable=this.tableSelecter.viewTable,Ue.register(this).on("DELETE_GAME_OBJECT",2e3,e=>{if(!this.selectedTable||e.data.identifier!==this.selectedTable.identifier)return;let i=Ct.instance.get(e.data.identifier);null!==i&&(this.selectedTableXml=i.toXml())})}ngAfterViewInit(){}ngOnDestroy(){Ue.unregister(this)}selectGameTable(e){Ue.call("SELECT_GAME_TABLE",{identifier:e},Ot.peerId),this.selectedTable=Ct.instance.get(e),this.selectedTableXml=""}getGameTables(){return Ct.instance.getObjects(ir)}createGameTable(){let e=new ir;e.name="\u767d\u7d19\u306e\u30c6\u30fc\u30d6\u30eb",e.imageIdentifier="testTableBackgroundImage_image",e.initialize(),this.selectGameTable(e.identifier)}save(){var e=this;return(0,gn.Z)(function*(){!e.selectedTable||e.isSaveing||(e.isSaveing=!0,e.progresPercent=0,e.selectedTable.selected=!0,yield e.saveDataService.saveGameObjectAsync(e.selectedTable,"fly_map_"+e.selectedTable.name,i=>{e.progresPercent=i}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500))})()}delete(){!this.isEmpty&&this.selectedTable&&(this.selectedTableXml=this.selectedTable.toXml(),this.selectedTable.destroy())}restore(){if(this.selectedTable&&this.selectedTableXml){let e=gi.instance.parseXml(this.selectedTableXml);this.selectGameTable(e.identifier),this.selectedTableXml=""}}getHidden(e){const i=Un.get(e.identifier);return!!i&&i.hide}openBgImageModal(){if(this.isDeleted)return;let e=[];this.selectedTable&&this.selectedTable.imageIdentifier&&(e=[this.selectedTable.imageIdentifier]),this.modalService.open(aa,{currentImageIdentifires:e}).then(i=>{!this.selectedTable||!i||(this.selectedTable.imageIdentifier=i)})}openDistanceViewImageModal(){if(this.isDeleted)return;let e=[];this.selectedTable&&this.selectedTable.backgroundImageIdentifier&&(e=[this.selectedTable.backgroundImageIdentifier]),this.modalService.open(aa,{isAllowedEmpty:!0,currentImageIdentifires:e}).then(i=>{!this.selectedTable||!i||(this.selectedTable.backgroundImageIdentifier=i)})}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(pr,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:Li.OK_CANCEL,materialIcon:"visibility",action:()=>{this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}}return t.\u0275fac=function(e){return new(e||t)(He(Ki),He(Yn),He(Gr),He(Zu),He(qn))},t.\u0275cmp=fn({type:t,selectors:[["game-table-setting"]],decls:15,vars:9,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[2,"margin-bottom","2px","font-size","smaller",3,"click"],["size","10",2,"width","100%","max-width","155px",3,"ngModel","change"],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[2,"float","right","margin-top","3px","margin-right","3px"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[4,"ngIf"],[3,"value","title"],[1,"images-select"],[2,"position","relative","overflow","hidden","cursor","pointer",3,"click"],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["height","120",3,"ngClass","src"],["style","position: relative; overflow: hidden; cursor: pointer",3,"click",4,"ngIf"],[1,"self-setting"],["placeholder","Name",3,"ngModel","disabled","ngModelChange"],["type","range","name","tableWidth",3,"ngModel","title","min","max","disabled","ngModelChange"],["type","number",2,"width","5em",3,"ngModel","min","max","disabled","ngModelChange"],["type","range","name","tableHeight",3,"ngModel","title","min","max","disabled","ngModelChange"],["name","tableGridType",3,"ngModel","disabled","ngModelChange"],["value","-1"],["value","0"],["value","1"],["value","2"],[1,"self-setting",2,"margin-left","3px"],["name","tableGridColor",3,"ngModel","disabled","ngModelChange"],["value","#000000e6"],["value","#dddddde6"],["type","checkbox","name","tableGridNumberShow",3,"ngModel","disabled","ngModelChange"],[3,"ngClass"],["name","tableDistanceviewFilter",3,"ngModel","disabled","ngModelChange"],["value",""],["value","white"],["value","black"],["type","checkbox","name","tableGridShow",3,"ngModel","ngModelChange"],[1,"self-only"],[1,"self-setting",2,"margin-left","1em"],["type","checkbox","name","tableGridSnap",3,"ngModel","ngModelChange"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons",2,"margin-right","2px","font-size","16px","display","block"],[2,"height","120px",3,"disabled","click"],[2,"margin-left","2em",3,"disabled","click"],[2,"position","relative"],["class","progress",4,"ngIf"],[1,"danger",3,"disabled","click"],[1,"progress"],[3,"click"],[2,"font-size","12px"]],template:function(e,i){1&e&&(Q(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Ae("click",function(){return i.createGameTable()}),ve(4,"\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b"),ne()(),Q(5,"select",3),Ae("change",function(o){return i.selectGameTable(o.target.value)}),Te(6,YZ,2,5,"option",4),ne()(),Q(7,"div",5)(8,"div",6)(9,"label",7)(10,"input",8),Ae("click",function(o){return i.onShowHiddenImages(o)}),ne(),Q(11,"i",9),ve(12),ne()()(),Te(13,oX,76,45,"ng-container",10),ne()(),Te(14,sX,3,0,"ng-container",10)),2&e&&(G(5),oe("ngModel",null==i.selectedTable?null:i.selectedTable.identifier),G(1),oe("ngForOf",i.getGameTables()),G(4),xt("checked",i.isShowHideImages?"checked":""),G(1),oe("ngClass",wt(7,aX,i.isShowHideImages)),G(1),lt(i.isShowHideImages?"visibility":"visibility_off"),G(1),oe("ngIf",!i.isEmpty||i.selectedTable),G(1),oe("ngIf",i.isEmpty))},dependencies:[si,_i,Bn,oo,so,Ii,Fo,Ro,Oo,$o,Mi,Ys,Ks,yi,$i],styles:["[_nghost-%COMP%]{display:block}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.images-select[_ngcontent-%COMP%]{display:flex}input[type=number][_ngcontent-%COMP%]{text-align:right}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.blackout[_ngcontent-%COMP%]{filter:blur(12px) grayscale(70%)}.self-only[_ngcontent-%COMP%]{color:red}img[_ngcontent-%COMP%]{transition:all .1s 0s ease}.self-setting[_ngcontent-%COMP%]{font-weight:bolder;font-size:smaller}.disabled[_ngcontent-%COMP%]{color:gray;font-weight:400}"]}),t})();function lX(t,n){if(1&t){const e=ft();Q(0,"button",33),Ae("click",function(){Re(e);const r=me().$implicit;return Le(me().play(r))}),Q(1,"i",34),ve(2,"play_arrow"),ne(),ve(3,"\u8a66\u8074"),Q(4,"sup",27),ve(5,"*"),ne()()}2&t&&oe("disabled",!me().$implicit.isReady)}function cX(t,n){if(1&t){const e=ft();Q(0,"button",33),Ae("click",function(){return Re(e),Le(me(2).stop())}),Q(1,"i",34),ve(2,"stop"),ne(),ve(3,"\u8a66\u8074"),Q(4,"sup",27),ve(5,"*"),ne()()}2&t&&oe("disabled",!me().$implicit.isReady)}function uX(t,n){if(1&t){const e=ft();Q(0,"button",33),Ae("click",function(){Re(e);const r=me().$implicit;return Le(me().playBGM(r))}),Q(1,"i",34),ve(2,"loop"),ne(),ve(3,"\uff22\uff27\uff2d"),ne()}2&t&&oe("disabled",!me().$implicit.isReady)}function dX(t,n){if(1&t){const e=ft();Q(0,"button",33),Ae("click",function(){Re(e);const r=me().$implicit;return Le(me().stopBGM(r))}),Q(1,"i",34),ve(2,"stop"),ne(),ve(3,"\uff22\uff27\uff2d"),ne()}2&t&&oe("disabled",!me().$implicit.isReady)}function fX(t,n){1&t&&(Q(0,"span",32)(1,"b"),ve(2,"\u3010\u8a66\u8074\u4e2d\u3011"),ne()())}function hX(t,n){1&t&&(Q(0,"span",32)(1,"i",35),ve(2,"volume_up"),ne()())}function pX(t,n){1&t&&(Q(0,"span",32)(1,"i",35),ve(2,"volume_up"),ne(),Q(3,"b"),ve(4,"\u3010\u8a66\u8074\u4e2d\u3011"),ne()())}function gX(t,n){if(1&t&&(it(0),Te(1,hX,3,0,"span",30),Te(2,pX,5,0,"span",30),rt()),2&t){const e=me().$implicit,i=me();G(1),oe("ngIf",e!=(null==i.auditionPlayer?null:i.auditionPlayer.audio)||e==(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&(null==i.auditionPlayer?null:i.auditionPlayer.paused)),G(1),oe("ngIf",e===(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&!(null!=i.auditionPlayer&&i.auditionPlayer.paused))}}const mX=function(t){return{last:t}};function _X(t,n){if(1&t&&(Q(0,"div",28),Te(1,lX,6,1,"button",29),Te(2,cX,6,1,"button",29),Te(3,uX,4,1,"button",29),Te(4,dX,4,1,"button",29),Te(5,fX,3,0,"span",30),Te(6,gX,3,2,"ng-container",31),Q(7,"span",32),ve(8),ne()()),2&t){const e=n.$implicit,i=n.last,r=me();oe("ngClass",wt(10,mX,i)),G(1),oe("ngIf",e!==(null==r.auditionPlayer?null:r.auditionPlayer.audio)||(null==r.auditionPlayer?null:r.auditionPlayer.paused)),G(1),oe("ngIf",e===(null==r.auditionPlayer?null:r.auditionPlayer.audio)&&!(null!=r.auditionPlayer&&r.auditionPlayer.paused)),G(1),oe("ngIf",e!==(null==r.jukebox?null:r.jukebox.audio)),G(1),oe("ngIf",e===(null==r.jukebox?null:r.jukebox.audio)),G(1),oe("ngIf",e===(null==r.auditionPlayer?null:r.auditionPlayer.audio)&&!(null!=r.auditionPlayer&&r.auditionPlayer.paused)&&e!=(null==r.jukebox?null:r.jukebox.audio)),G(1),oe("ngIf",e===(null==r.jukebox?null:r.jukebox.audio)),G(1),ut("font-weight",e===(null==r.jukebox?null:r.jukebox.audio)?"bolder":"normal"),G(1),lt(e.name)}}function $X(t,n){1&t&&(Q(0,"div",36)(1,"small")(2,"b"),ve(3,"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u3053\u3053\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002"),ne()()())}let vX=(()=>{class t{constructor(e,i,r,o){this.modalService=e,this.panelService=i,this.ngZone=r,this.contextMenuService=o,this.auditionPlayer=new tt,this.lazyUpdateTimer=null,this.soundTestPlayer=new tt,this.noticeTestPlayer=new tt,this.soundTestPlayer.volumeType=Vo.SOUND_EFFECT,this.noticeTestPlayer.volumeType=Vo.NOTICE}get isMute(){return tt.isMute}set isMute(e){tt.isMute=e,Ue.trigger("CHANGE_JUKEBOX_VOLUME",null),e?kn.setItem(tt.MAIN_IS_MUTE_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i)):kn.removeItem(tt.MAIN_IS_MUTE_LOCAL_STORAGE_KEY).catch(i=>console.log(i))}get volume(){return tt.volume}set volume(e){this.isMute=0==e,tt.volume=e,Ue.trigger("CHANGE_JUKEBOX_VOLUME",null),.5==tt.volume?kn.removeItem(tt.MAIN_VOLUME_LOCAL_STORAGE_KEY).catch(i=>console.log(i)):kn.setItem(tt.MAIN_VOLUME_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i))}get isAuditionMute(){return tt.isAuditionMute}set isAuditionMute(e){tt.isAuditionMute=e,Ue.trigger("CHANGE_JUKEBOX_VOLUME",null),e?kn.setItem(tt.AUDITION_IS_MUTE_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i)):kn.removeItem(tt.AUDITION_IS_MUTE_LOCAL_STORAGE_KEY).catch(i=>console.log(i))}get auditionVolume(){return tt.auditionVolume}set auditionVolume(e){this.isAuditionMute=0==e,tt.auditionVolume=e,Ue.trigger("CHANGE_JUKEBOX_VOLUME",null),.5==tt.auditionVolume?kn.removeItem(tt.AUDITION_VOLUME_LOCAL_STORAGE_KEY).catch(i=>console.log(i)):kn.setItem(tt.AUDITION_VOLUME_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i))}get isSoundEffectMute(){return tt.isSoundEffectMute}set isSoundEffectMute(e){tt.isSoundEffectMute=e,e?kn.setItem(tt.SOUND_EFFECT_IS_MUTE_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i)):kn.removeItem(tt.SOUND_EFFECT_IS_MUTE_LOCAL_STORAGE_KEY).catch(i=>console.log(i))}get soundEffectVolume(){return tt.soundEffectVolume}set soundEffectVolume(e){this.isSoundEffectMute=0==e,tt.soundEffectVolume=e,.5==tt.soundEffectVolume?kn.removeItem(tt.SOUND_EFFECT_VOLUME_LOCAL_STORAGE_KEY).catch(i=>console.log(i)):kn.setItem(tt.SOUND_EFFECT_VOLUME_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i))}get isNoticeMute(){return tt.isNoticeMute}set isNoticeMute(e){tt.isNoticeMute=e,e?kn.setItem(tt.NOTICE_IS_MUTE_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i)):kn.removeItem(tt.NOTICE_IS_MUTE_LOCAL_STORAGE_KEY).catch(i=>console.log(i))}get noticeVolume(){return tt.noticeVolume}set noticeVolume(e){this.isNoticeMute=0==e,tt.noticeVolume=e,.5==tt.noticeVolume?kn.removeItem(tt.NOTICE_VOLUME_LOCAL_STORAGE_KEY).catch(i=>console.log(i)):kn.setItem(tt.NOTICE_VOLUME_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i))}get audios(){return Xt.instance.audios.filter(e=>!e.isHidden)}get jukebox(){return Ct.instance.get("Jukebox")}get percentVolume(){return Math.floor(100*this.volume)}set percentVolume(e){this.volume=e/100}get percentAuditionVolume(){return Math.floor(100*this.auditionVolume)}set percentAuditionVolume(e){this.auditionVolume=e/100}get percentSoundEffectVolume(){return Math.floor(100*this.soundEffectVolume)}set percentSoundEffectVolume(e){this.soundEffectVolume=e/100}get percentNoticeVolume(){return Math.floor(100*this.noticeVolume)}set percentNoticeVolume(e){this.noticeVolume=e/100}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30b8\u30e5\u30fc\u30af\u30dc\u30c3\u30af\u30b9"),this.auditionPlayer.volumeType=Vo.AUDITION,Ue.register(this).on("*",e=>{e.eventName.startsWith("FILE_")&&this.lazyNgZoneUpdate()})}ngOnDestroy(){Ue.unregister(this),this.stop()}play(e){this.auditionPlayer.play(e)}stop(){this.auditionPlayer.stop()}playBGM(e){this.jukebox.play(e.identifier,!0)}stopBGM(e){this.jukebox.audio===e&&this.jukebox.stop()}handleFileSelect(e){let i=e.target,r=i.files;r.length&&sa.instance.load(r),i.value=""}noticeTest(e=st.puyon){const i=Xt.instance.get(e);i&&i.isReady&&this.noticeTestPlayer.play(i)}soundTest(e){const i=e.target,r=i.getBoundingClientRect(),o={x:window.pageXOffset+r.left+i.clientWidth,y:window.pageYOffset+r.top};this.contextMenuService.open(o,[{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30fb\u5730\u5f62",subActions:[{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306e\u79fb\u52d5\u958b\u59cb",action:()=>{this.playSETest(st.piecePick)}},{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u7f6e\u304f",action:()=>{this.playSETest(st.piecePut)}},{name:"\u5730\u5f62\u306e\u79fb\u52d5\u958b\u59cb\uff0f\u7d42\u4e86",action:()=>{this.playSETest(st.blockPick)}}]},{name:"\u30c0\u30a4\u30b9\u30fb\u30b3\u30a4\u30f3",subActions:[{name:"\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u3092\u53d6\u308b",action:()=>{this.playSETest(st.dicePick)}},{name:"\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u3092\u7f6e\u304f",action:()=>{this.playSETest(st.dicePut)}},{name:"\u30c0\u30a4\u30b9\u3092\u632f\u308b\uff11",action:()=>{this.playSETest(st.diceRoll1)}},{name:"\u30c0\u30a4\u30b9\u3092\u632f\u308b\uff12",action:()=>{this.playSETest(st.diceRoll2)}},{name:"\u30b3\u30a4\u30f3\u30c8\u30b9",action:()=>{this.playSETest(st.coinToss)}}]},{name:"\u30ab\u30fc\u30c9\u30fb\u5c71\u672d",subActions:[{name:"\u30ab\u30fc\u30c9\u3092\u5f15\u304f\uff0f\u88cf\u8fd4\u3059",action:()=>{this.playSETest(st.cardDraw)}},{name:"\u30ab\u30fc\u30c9\u30fb\u5c71\u672d\u3092\u53d6\u308b",action:()=>{this.playSETest(st.cardPick)}},{name:"\u30ab\u30fc\u30c9\u30fb\u5c71\u672d\u3092\u7f6e\u304f",action:()=>{this.playSETest(st.cardPut)}},{name:"\u5c71\u672d\u3092\u30b7\u30e3\u30c3\u30d5\u30eb",action:()=>{this.playSETest(st.cardShuffle)}}]},{name:"\u305d\u306e\u4ed6",subActions:[{name:"\u56fa\u5b9a\u30fb\u30ed\u30c3\u30af\uff0f\u89e3\u9664",action:()=>{this.playSETest(st.lock)}},{name:"\u843d\u4e0b\uff0f\u53d6\u308a\u9664\u304f\uff0f\u524a\u9664",action:()=>{this.playSETest(st.sweep)}},{name:"\u5909\u8eab\uff01",action:()=>{this.playSETest(st.surprise)}}]}],"SE\u30c6\u30b9\u30c8")}playSETest(e){const i=Xt.instance.get(e);i&&i.isReady?(Ue.unregister(this,"UPDATE_AUDIO_RESOURE"),this.isSoundEffectMute||this.soundTestPlayer.play(i)):Ue.register(this).on("UPDATE_AUDIO_RESOURE",-100,r=>{this.playSETest(e)})}lazyNgZoneUpdate(){null===this.lazyUpdateTimer&&(this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,this.ngZone.run(()=>{})},100))}}return t.\u0275fac=function(e){return new(e||t)(He(Yn),He(qn),He(Nn),He(hr))},t.\u0275cmp=fn({type:t,selectors:[["app-jukebox"]],decls:111,vars:18,consts:[[2,"margin-bottom","2px","min-height","4em"],["class","box","style","white-space: nowrap; text-overflow: ellipsis; overflow: hidden",3,"ngClass",4,"ngFor","ngForOf"],["style","padding: 1em 0px; text-align: center",4,"ngIf"],[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","audio/*",2,"display","none",3,"change"],[2,"font-size","12px","margin-top","3px"],[1,"self-only"],[2,"font-size","12px"],[2,"font-size","12px","margin-bottom","8px"],[1,"footer",2,"position","sticky","bottom","0px","padding","2px 0px 0px 3px"],[2,"display","flex"],[2,"flex-basis","auto"],[2,"white-space","nowrap"],[1,"button-mute",3,"click"],[1,"material-icons",2,"font-size","22px"],[2,"flex-basis","100%"],["type","range","min","0","max","1","step","0.01",2,"width","100%",3,"ngModel","title","ngModelChange"],[2,"flex-basis","auto","padding-right","1em"],[2,"white-space","nowrap","padding-left","4px"],["type","number","min","0","max","100","step","1",2,"width","3.2em",3,"ngModel","ngModelChange"],[2,"font-size","smaller","padding-left","3px"],["type","range","min","0","max","1","step","0.01",2,"width","100%",3,"ngModel","title","ngModelChange","change"],["type","number","min","0","max","100","step","1",2,"width","3.2em",3,"ngModel","change","ngModelChange"],[2,"display","flex","justify-content","space-between","padding-bottom","2px"],[2,"font-size","xx-small","font-weight","bolder","margin-right","2em","white-space","nowrap",3,"click"],[1,"self-only",2,"font-size","larger"],[1,"box",2,"white-space","nowrap","text-overflow","ellipsis","overflow","hidden",3,"ngClass"],[3,"disabled","click",4,"ngIf"],["style","padding-left: 2px",4,"ngIf"],[4,"ngIf"],[2,"padding-left","2px"],[3,"disabled","click"],[1,"material-icons"],[1,"material-icons",2,"font-size","16px","vertical-align","middle"],[2,"padding","1em 0px","text-align","center"]],template:function(e,i){1&e&&(Q(0,"div",0),Te(1,_X,9,12,"div",1),Te(2,$X,4,0,"div",2),ne(),Q(3,"label")(4,"div",3)(5,"div")(6,"i",4),ve(7,"playlist_add"),ne()(),Q(8,"div"),ve(9,"\u3053\u3053\u306b\u97f3\u697d\u3092\u30c9\u30ed\u30c3\u30d7"),ne(),Q(10,"div",5),ve(11,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),ne(),Q(12,"input",6),Ae("change",function(o){return i.handleFileSelect(o)}),ne(),Q(13,"div",5),mt(14,"br"),ve(15,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d10MB\u307e\u3067"),ne()()(),Q(16,"div",7),ve(17,"\u203b\u300c\u8a66\u8074"),Q(18,"sup",8),ve(19,"*"),ne(),ve(20,"\u300d\u300cSE\u30c6\u30b9\u30c8"),Q(21,"sup",8),ve(22,"*"),ne(),ve(23,"\u300d\u306f\u81ea\u5206\u306e\u74b0\u5883\u3067\u97f3\u697d\u30921\u56de\u518d\u751f\u3057\u307e\u3059\u3002"),ne(),Q(24,"div",9),ve(25,"\u203b\u300cBGM\u300d\u306f\u30eb\u30fc\u30e0\u5185\u306e\u5168\u54e1\u30671\u3064\u306e\u97f3\u697d\u3092\u30eb\u30fc\u30d7\u518d\u751f\u3057\u307e\u3059\u3002"),ne(),Q(26,"div",10),ve(27,"\u203b\u73fe\u884c\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u306b\u306f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u542b\u307e\u308c\u307e\u305b\u3093\u3002\uff08\u6bce\u56de\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u304c\u5fc5\u8981\u3067\u3059\uff09"),ne(),Q(28,"div",11)(29,"div",12)(30,"div",13)(31,"b",14),ve(32,"\u8a66\u8074\u97f3\u91cf"),Q(33,"sup",8),ve(34,"*"),ne(),ve(35,"\uff1a"),ne()(),Q(36,"div",13)(37,"button",15),Ae("click",function(){return i.isAuditionMute=!i.isAuditionMute}),Q(38,"i",16),ve(39),ne()()(),Q(40,"div",17)(41,"input",18),Ae("ngModelChange",function(o){return i.auditionVolume=o}),ne()(),Q(42,"div",19)(43,"span",20)(44,"input",21),Ae("ngModelChange",function(o){return i.percentAuditionVolume=o}),ne(),Q(45,"b",22),ve(46,"%"),ne()()()(),Q(47,"div",12)(48,"div",13)(49,"b",14),ve(50,"\u518d\u751f\u97f3\u91cf"),Q(51,"sup",8),ve(52,"*"),ne(),ve(53,"\uff1a"),ne()(),Q(54,"div",13)(55,"button",15),Ae("click",function(){return i.isMute=!i.isMute}),Q(56,"i",16),ve(57),ne()()(),Q(58,"div",17)(59,"input",18),Ae("ngModelChange",function(o){return i.volume=o}),ne()(),Q(60,"div",19)(61,"span",20)(62,"input",21),Ae("ngModelChange",function(o){return i.percentVolume=o}),ne(),Q(63,"b",22),ve(64,"%"),ne()()()(),mt(65,"hr"),Q(66,"div",12)(67,"div",13)(68,"b",14),ve(69,"\u901a\u77e5\u97f3\u91cf"),Q(70,"sup",8),ve(71,"*"),ne(),ve(72,"\uff1a"),ne()(),Q(73,"div",13)(74,"button",15),Ae("click",function(){return i.isNoticeMute=!i.isNoticeMute}),Q(75,"i",16),ve(76),ne()()(),Q(77,"div",17)(78,"input",23),Ae("ngModelChange",function(o){return i.noticeVolume=o})("change",function(){return i.noticeTest()}),ne()(),Q(79,"div",19)(80,"span",20)(81,"input",24),Ae("change",function(){return i.noticeTest()})("ngModelChange",function(o){return i.percentNoticeVolume=o}),ne(),Q(82,"b",22),ve(83,"%"),ne()()()(),Q(84,"div",12)(85,"div",13)(86,"b",14),ve(87,"\uff33\uff25\u97f3\u91cf"),Q(88,"sup",8),ve(89,"*"),ne(),ve(90,"\uff1a"),ne()(),Q(91,"div",13)(92,"button",15),Ae("click",function(){return i.isSoundEffectMute=!i.isSoundEffectMute}),Q(93,"i",16),ve(94),ne()()(),Q(95,"div",17)(96,"input",18),Ae("ngModelChange",function(o){return i.soundEffectVolume=o}),ne()(),Q(97,"div",19)(98,"span",20)(99,"input",21),Ae("ngModelChange",function(o){return i.percentSoundEffectVolume=o}),ne(),Q(100,"b",22),ve(101,"%"),ne()()()(),Q(102,"div",25)(103,"div")(104,"small"),ve(105,"\u203b\u8a2d\u5b9a\u3057\u305f\u97f3\u91cf\u306f\u30d6\u30e9\u30a6\u30b6\u306b\u4fdd\u5b58\u3055\u308c\u307e\u3059\u3002"),ne()(),Q(106,"div")(107,"button",26),Ae("click",function(o){return i.soundTest(o)}),ve(108,"\uff33\uff25\u30c6\u30b9\u30c8"),Q(109,"sup",27),ve(110,"*"),ne()()()()()),2&e&&(G(1),oe("ngForOf",i.audios),G(1),oe("ngIf",i.audios.length<1),G(37),lt(i.isAuditionMute?"volume_off":0==i.auditionVolume?"volume_mute":i.auditionVolume<=.5?"volume_down":"volume_up"),G(2),oe("ngModel",i.auditionVolume)("title",i.isAuditionMute?"":i.percentAuditionVolume+"%"),G(3),oe("ngModel",i.percentAuditionVolume),G(13),lt(i.isMute?"volume_off":0==i.volume?"volume_mute":i.volume<=.5?"volume_down":"volume_up"),G(2),oe("ngModel",i.volume)("title",i.isMute?"":i.percentVolume+"%"),G(3),oe("ngModel",i.percentVolume),G(14),lt(i.isNoticeMute?"volume_off":0==i.noticeVolume?"volume_mute":i.noticeVolume<=.5?"volume_down":"volume_up"),G(2),oe("ngModel",i.noticeVolume)("title",i.isNoticeMute?"":i.percentNoticeVolume+"%"),G(3),oe("ngModel",i.percentNoticeVolume),G(13),lt(i.isSoundEffectMute?"volume_off":0==i.soundEffectVolume?"volume_mute":i.soundEffectVolume<=.5?"volume_down":"volume_up"),G(2),oe("ngModel",i.soundEffectVolume)("title",i.isSoundEffectMute?"":i.percentSoundEffectVolume+"%"),G(3),oe("ngModel",i.percentSoundEffectVolume))},dependencies:[si,_i,Bn,Ii,Fo,Ro,Mi,Ys,Ks,yi],styles:['[_nghost-%COMP%]{display:block;height:100%}.drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.box[_ngcontent-%COMP%]{font-size:smaller;border-bottom:1px dotted #888;vertical-align:baseline}.box.last[_ngcontent-%COMP%]{border-bottom:0px none transparent}.volume[_ngcontent-%COMP%]{display:inline-block;width:3em;text-align:right}input[type=number][_ngcontent-%COMP%]{text-align:right}.self-only[_ngcontent-%COMP%]{color:red}button[_ngcontent-%COMP%]   .self-only[_ngcontent-%COMP%]{vertical-align:text-top}.box[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:12px;height:26px;width:5.6em;margin-left:0;margin-right:0}button[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:12px}.footer[_ngcontent-%COMP%]{background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border-top:dotted 1px #888}.button-mute[_ngcontent-%COMP%]{box-sizing:border-box;width:25px;height:25px;padding:1px;display:inline-block;background-color:transparent;border-color:transparent}.button-mute[_ngcontent-%COMP%]::-moz-selection{background-color:#eee;border-color:#ccc}.button-mute[_ngcontent-%COMP%]:hover, .button-mute[_ngcontent-%COMP%]:active, .button-mute[_ngcontent-%COMP%]::selection{background-color:#eee;border-color:#ccc}']}),t})();const bX=["content"],yX=["*"];let CX=(()=>{class t{constructor(e){this.modalService=e}clickBackground(e){e.target===e.currentTarget&&this.resolve()}resolve(){this.modalService.resolve(null)}reject(){this.modalService.reject()}}return t.\u0275fac=function(e){return new(e||t)(He(Yn))},t.\u0275cmp=fn({type:t,selectors:[["modal"]],viewQuery:function(e,i){if(1&e&&wn(bX,7,no),2&e){let r;Cn(r=xn())&&(i.content=r.first)}},ngContentSelectors:yX,decls:13,vars:3,consts:[[1,"component"],[1,"modal-background",3,"click"],[1,"modal-panel"],[1,"title"],[1,"title-button"],[3,"click"],[1,"material-icons",2,"font-size","14px"],[1,"scrollable-panel"],["content",""]],template:function(e,i){1&e&&(A_(),Q(0,"div",0)(1,"div",1),Ae("click",function(o){return i.clickBackground(o)}),ne(),Q(2,"div",2)(3,"div",3)(4,"div",4)(5,"button",5),Ae("click",function(){return i.resolve()}),Q(6,"i",6),ve(7,"close"),ne()()(),ve(8),ne(),Q(9,"div",7),P_(10),mt(11,"div",null,8),ne()()()),2&e&&(G(1),oe("@bgInOut","in"),G(1),oe("@flyInOut","in"),G(6),Zn(" ",i.modalService.title," "))},styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;inset:0;z-index:1899999;display:flex;align-items:center;justify-content:center;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.modal-background[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;color:#ccc;background-color:#1e1e1e4d;inset:0;z-index:-1}.modal-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:hidden;color:#444;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;height:auto;max-height:calc(100% - 10px);width:800px;max-width:100%}.title[_ngcontent-%COMP%]{position:relative;overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;padding:2px 5px;width:100%;background-color:#ccc;color:#444}.title-button[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#444}.header[_ngcontent-%COMP%], .content[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]{padding:10px}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;max-height:calc(100vh - 41px);width:100%;padding:8px}"],data:{animation:[Vn("flyInOut",[tn("void => *",[Zt("100ms ease-out",bn([dt({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),dt({transform:"scale(1.0, 1.0)",opacity:"1.0",offset:1})]))]),tn("* => void",[Zt(100,dt({transform:"scale(0, 0)"}))])]),Vn("bgInOut",[Ap("in",dt({"background-color":"rgba(30, 30, 30, 0.4)"})),tn("void => *",[dt({"background-color":"rgba(30, 30, 30, 0.0)"}),Zt(200)]),tn("* => void",[Zt(200,dt({"background-color":"rgba(30, 30, 30, 0.0)"}))])])]}}),t})();var On=(()=>(function(t){t.N="n",t.E="e",t.W="w",t.S="s",t.NE="ne",t.NW="nw",t.SE="se",t.SW="sw"}(On||(On={})),On))();class wX{constructor(n,e){this.target=n,this.type=e,this.input=null,this.handle=null,this.width=12,this.initialize()}initialize(){this.handle=this.target.ownerDocument.createElement("div"),this.handle.classList.add("ui-resize-handler-"+this.type),this.input=new ls(this.handle),this.target.appendChild(this.handle);let n=this.handle.style;switch(n.position="absolute",n.zIndex="1",n.backgroundColor="transparent",this.type){case On.N:n.top=3*-this.width/4+"px",n.left="0px",n.right="0px",n.height=`${this.width}px`;break;case On.E:n.top="0px",n.bottom="0px",n.right=3*-this.width/4+"px",n.width=`${this.width}px`;break;case On.W:n.top="0px",n.bottom="0px",n.left=3*-this.width/4+"px",n.width=`${this.width}px`;break;case On.S:n.bottom=3*-this.width/4+"px",n.left="0px",n.right="0px",n.height=`${this.width}px`;break;case On.NE:n.top=3*-this.width/4+"px",n.right=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.zIndex="2";break;case On.NW:n.top=3*-this.width/4+"px",n.left=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.zIndex="2";break;case On.SE:n.bottom=3*-this.width/4+"px",n.right=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.zIndex="2";break;case On.SW:n.bottom=3*-this.width/4+"px",n.left=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.zIndex="2"}this.cursor(!0)}destroy(){this.handle.remove(),this.input.destroy()}cursor(n){let e=this.handle.style;if(n)switch(this.type){case On.N:e.cursor="ns-resize";break;case On.E:case On.W:e.cursor="ew-resize";break;case On.S:e.cursor="ns-resize";break;case On.NE:e.cursor="nesw-resize";break;case On.NW:case On.SE:e.cursor="nwse-resize";break;case On.SW:e.cursor="nesw-resize"}else e.cursor="default"}}let xX=(()=>{class t{constructor(e,i){this.ngZone=e,this.elementRef=i,this.boundsSelector="body",this.stackSelector="",this.minWidth=100,this.minHeight=100,this.ostart=new Hn,this.onmove=new Hn,this.onend=new Hn,this.handleMap=new Map,this._isDisable=!1,this._align="normal",this.startPosition={left:0,top:0,width:0,height:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={left:0,top:0,width:0,height:0}}set isDisable(e){this._isDisable=e,this.initialize()}set align(e){this._align=e,this.initialize()}get handleTypes(){return this._isDisable||"none"===this._align?[]:"horizontal"===this._align?[On.E,On.W]:"vertical"===this._align?[On.N,On.S]:[On.N,On.E,On.W,On.S,On.NE,On.NW,On.SE,On.SW]}ngAfterViewInit(){this.initialize(),this.setForeground()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.handleMap.forEach(e=>e.destroy()),this.handleMap.clear(),this.handleTypes.forEach(e=>{let i=new wX(this.elementRef.nativeElement,e);this.handleMap.set(e,i),i.input.onStart=r=>this.onResizeStart(r,i),i.input.onMove=r=>this.onResizeMove(r,i),i.input.onEnd=r=>this.onResizeEnd(r,i),i.input.onContextMenu=r=>this.onContextMenu(r,i)})})}cancel(){this.handleMap.forEach(e=>e.input.cancel())}destroy(){this.handleMap.forEach(e=>e.destroy()),this.handleMap.clear()}onResizeStart(e,i){if(this._isDisable||1===e.button||2===e.button)return this.cancel();this.setForeground(),this.handleMap.forEach(r=>{r!==i&&r.input.cancel()}),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=i.input.pointer,this.prevTrans={left:0,top:0,width:0,height:0},e.stopPropagation()}onResizeMove(e,i){let r={left:0,top:0,width:i.input.pointer.x-this.startPointer.x,height:i.input.pointer.y-this.startPointer.y};switch(i.type){case On.N:case On.S:r.width=0;break;case On.E:case On.W:r.height=0}switch(i.type){case On.SW:r.left=r.width,r.width*=-1;break;case On.NE:r.top=r.height,r.height*=-1;break;case On.E:case On.S:case On.SE:break;case On.N:case On.W:case On.NW:r.left=r.width,r.top=r.height,r.width*=-1,r.height*=-1}r.width+this.startPosition.width<this.minWidth&&(r.width=this.minWidth-this.startPosition.width,r.left=0!==r.left?-r.width:r.left),r.height+this.startPosition.height<this.minHeight&&(r.height=this.minHeight-this.startPosition.height,r.top=0!==r.top?-r.height:r.top);let s=this.calcCorrectionPosition({left:r.left-this.prevTrans.left,top:r.top-this.prevTrans.top,width:r.width-this.prevTrans.width,height:r.height-this.prevTrans.height});r.left+=s.left,r.top+=s.top,r.width+=s.width,r.height+=s.height,this.elementRef.nativeElement.style.left=r.left+this.startPosition.left+"px",this.elementRef.nativeElement.style.top=r.top+this.startPosition.top+"px",this.elementRef.nativeElement.style.width=r.width+this.startPosition.width+"px",this.elementRef.nativeElement.style.height=r.height+this.startPosition.height+"px",this.prevTrans=r,e.cancelable&&e.preventDefault(),e.stopPropagation()}onResizeEnd(e,i){i.input.isDragging&&e.cancelable&&e.preventDefault(),e.stopPropagation()}onContextMenu(e,i){e.stopPropagation()}calcCorrectionPosition(e={left:0,top:0,width:0,height:0}){let i={left:0,top:0,width:0,height:0},r=this.elementRef.nativeElement.getBoundingClientRect(),o=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();return o.right<r.right+e.left+e.width&&(i.width+=o.right-(r.right+e.left+e.width)),r.left+e.left<o.left&&(i.left+=o.left-(r.left+e.left),i.width-=i.left),o.bottom<r.bottom+e.top+e.height&&(i.height+=o.bottom-(r.bottom+e.top+e.height)),r.top+e.top<o.top&&(i.top+=o.top-(r.top+e.top),i.height-=i.top),i}calcElementPosition(e){let i=window.getComputedStyle(e);return{left:Zi.relation(i.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),top:Zi.relation(i.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),width:Zi.relation(i.width,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),height:Zi.relation(i.height,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight)}}setForeground(){if(this.stackSelector.length<1)return;let e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),i=0,r=99999;e.forEach(o=>{let s=parseInt(o.style.zIndex);i<s&&(i=s),s<r&&(r=s)}),!(i<=parseInt(this.elementRef.nativeElement.style.zIndex))&&(e.forEach(o=>{o.style.zIndex=parseInt(o.style.zIndex)-r+""}),this.elementRef.nativeElement.style.zIndex=i+1+"")}}return t.\u0275fac=function(e){return new(e||t)(He(Nn),He(Ai))},t.\u0275dir=hn({type:t,selectors:[["","appResizable",""]],inputs:{boundsSelector:["resizable.bounds","boundsSelector"],stackSelector:["resizable.stack","stackSelector"],minWidth:["resizable.minWidth","minWidth"],minHeight:["resizable.minHeight","minHeight"],isDisable:["resizable.disable","isDisable"],align:["resizable.align","align"]},outputs:{ostart:"resizable.start",onmove:"resizable.move",onend:"resizable.end"}}),t})();const EX=["draggablePanel"],TX=["scrollablePanel"],SX=["content"],IX=["titleBar"];function MX(t,n){if(1&t){const e=ft();Q(0,"button",11),Ae("click",function(){return Re(e),Le(me().toggleRotate())}),Q(1,"i",12),ve(2,"pivot_table_chart"),ne()()}}function kX(t,n){if(1&t){const e=ft();Q(0,"button",13),Ae("click",function(){return Re(e),Le(me().toggleMinimize())}),Q(1,"i",14),ve(2),ne()()}if(2&t){const e=me();G(1),ut("font-size",e.isMinimized?12:14,"px"),G(1),lt(e.isMinimized?"crop_din":"minimize")}}function DX(t,n){if(1&t){const e=ft();Q(0,"button",13),Ae("click",function(){return Re(e),Le(me().toggleFullScreen())}),Q(1,"i",14),ve(2),ne()()}if(2&t){const e=me();G(1),ut("font-size",e.isFullScreen&&!e.isMinimized?12:14,"px"),G(1),lt(e.isFullScreen?e.isMinimized?"minimize":"crop_din":"fullscreen")}}function AX(t,n){if(1&t){const e=ft();Q(0,"button",13),Ae("click",function(){return Re(e),Le(me().close())}),Q(1,"i",12),ve(2,"close"),ne()()}}const PX=function(t,n,e,i){return{"pointer-events-none":t,"is-full-screen":n,"is-minimized":e,"i-am-gm":i}},NX=function(t){return{rotateble:t}},OX=function(t,n){return{overlay:t,horizontal:n}},FX=["*"];let NI=(()=>{class t{constructor(e,i){this.panelService=e,this.pointerDeviceService=i,this.rotateEvent=new Hn,this.showTitleButtons=!0,this.preLeft=0,this.preTop=0,this.preWidth=100,this.preHeight=100,this.horizontalWidth=1032,this.horizontalHeight=100,this.verticalWidth=0,this.verticalHeight=0,this.isMinimized=!1,this.isFullScreen=!1,this.isHorizontal=!1}set title(e){this.panelService.title=e}set left(e){this.panelService.left=e}set top(e){this.panelService.top=e}set width(e){this.panelService.width=e}set height(e){this.panelService.height=e}set isAbleMinimizeButton(e){this.panelService.isAbleMinimizeButton=e}set isAbleFullScreenButton(e){this.panelService.isAbleFullScreenButton=e}set isAbleCloseButton(e){this.panelService.isAbleCloseButton=e}set isAbleRotateButton(e){this.panelService.isAbleRotateButton=e}get title(){return this.panelService.title}get left(){return this.panelService.left}get top(){return this.panelService.top}get width(){return this.panelService.width}get height(){return this.panelService.height}get isAbleMinimizeButton(){return this.panelService.isAbleMinimizeButton}get isAbleFullScreenButton(){return this.panelService.isAbleFullScreenButton}get isAbleCloseButton(){return this.panelService.isAbleCloseButton}get isAbleRotateButton(){return this.panelService.isAbleRotateButton}get isGMMode(){return!!Qe.myCursor&&Qe.myCursor.isGMMode}get isPointerDragging(){return this.pointerDeviceService.isDragging}ngOnInit(){this.panelService.scrollablePanel=this.scrollablePanel.nativeElement}toggleMinimize(){const e=this.draggablePanel.nativeElement,i=this.scrollablePanel.nativeElement;if(e.style.transition="width 0.1s ease-in-out, height 0.1s ease-in-out",i.style.overflowY="hidden",setTimeout(()=>{e.style.transition=null,i.style.overflowY=null},100),!this.isMinimized&&!this.isFullScreen){const r=e.offsetWidth,o=e.offsetHeight;this.isHorizontal?(this.horizontalWidth=r,this.horizontalHeight=o):(this.verticalWidth=r,this.verticalHeight=o)}this.isMinimized=!this.isMinimized,this.isFullScreen=!1}toggleFullScreen(){const e=this.draggablePanel.nativeElement,i=this.scrollablePanel.nativeElement;if(e.style.transition="width 0.1s ease-in-out, height 0.1s ease-in-out",i.style.overflowY="hidden",setTimeout(()=>{e.style.transition=null,i.style.overflowY=null},100),!this.isMinimized&&!this.isFullScreen){const r=e.offsetWidth,o=e.offsetHeight;this.isHorizontal?(this.horizontalWidth=r,this.horizontalHeight=o):(this.verticalWidth=r,this.verticalHeight=o)}this.isFullScreen=!this.isFullScreen}toggleRotate(){const e=this.draggablePanel.nativeElement,i=this.scrollablePanel.nativeElement;e.style.transition="width 0.1s ease-in-out, height 0.1s ease-in-out",i.style.overflowY="hidden",setTimeout(()=>{e.style.transition=null,i.style.overflowY=null},100);const r=e.offsetWidth,o=e.offsetHeight;this.isHorizontal?(this.isHorizontal=!1,e.style.width=(this.verticalWidth<100?100:this.verticalWidth)+"px",e.style.height=(this.verticalHeight<100?100:this.verticalHeight)+"px",!this.isMinimized&&!this.isFullScreen&&(this.horizontalWidth=r,this.horizontalHeight=o)):(this.isHorizontal=!0,e.style.width=(this.horizontalWidth<100?100:this.horizontalWidth)+"px",e.style.height=(this.horizontalHeight<100?100:this.horizontalHeight)+"px",!this.isMinimized&&!this.isFullScreen&&(this.verticalWidth=r,this.verticalHeight=o)),this.isMinimized=!1,this.isFullScreen=!1,this.rotateEvent.emit(this.isHorizontal)}close(){this.panelService&&this.panelService.close()}}return t.\u0275fac=function(e){return new(e||t)(He(qn),He(Ci))},t.\u0275cmp=fn({type:t,selectors:[["ui-panel"]],viewQuery:function(e,i){if(1&e&&(wn(EX,7),wn(TX,7),wn(SX,7,no),wn(IX,7)),2&e){let r;Cn(r=xn())&&(i.draggablePanel=r.first),Cn(r=xn())&&(i.scrollablePanel=r.first),Cn(r=xn())&&(i.content=r.first),Cn(r=xn())&&(i.titleBar=r.first)}},inputs:{title:"title",left:"left",top:"top",width:"width",height:"height",isAbleMinimizeButton:"isAbleMinimizeButton",isAbleFullScreenButton:"isAbleFullScreenButton",isAbleCloseButton:"isAbleCloseButton",isAbleRotateButton:"isAbleRotateButton",showTitleButtons:"showTitleButtons"},outputs:{rotateEvent:"rotateEvent"},features:[Ti([qn])],ngContentSelectors:FX,decls:16,vars:34,consts:[["appDraggable","","appResizable","",1,"draggable-panel",3,"ngClass","resizable.disable","resizable.align","draggable.disable","draggable.stack","resizable.stack"],["draggablePanel",""],[1,"title"],["titleBar",""],["style","padding: 0px; height: 14px; margin-top: 3px; margin-left: 1px",3,"click",4,"ngIf"],[3,"ngClass"],[1,"title-button"],[3,"click",4,"ngIf"],[1,"scrollable-panel",3,"ngClass"],["scrollablePanel",""],["content",""],[2,"padding","0px","height","14px","margin-top","3px","margin-left","1px",3,"click"],[1,"material-icons",2,"font-size","14px"],[3,"click"],[1,"material-icons"]],template:function(e,i){1&e&&(A_(),Q(0,"div",0,1)(2,"div",2,3),Te(4,MX,3,0,"button",4),Q(5,"div",5),ve(6),ne(),Q(7,"div",6),Te(8,kX,3,3,"button",7),Te(9,DX,3,3,"button",7),Te(10,AX,3,0,"button",7),ne()(),Q(11,"div",8,9),P_(13),mt(14,"div",null,10),ne()()),2&e&&(ut("left",i.left,"px")("top",i.top,"px")("width",i.width,"px")("height",i.height,"px"),oe("@flyInOut","in")("ngClass",Is(24,PX,i.isPointerDragging,i.isFullScreen,i.isMinimized&&!i.isFullScreen,i.isGMMode))("resizable.disable",i.isMinimized||i.isFullScreen)("resizable.align",i.isAbleRotateButton?i.isHorizontal?"horizontal":"vertical":"normal")("draggable.disable",i.isFullScreen)("draggable.stack",".draggable-panel")("resizable.stack",".draggable-panel"),G(4),oe("ngIf",i.isAbleRotateButton),G(1),oe("ngClass",wt(29,NX,i.isAbleRotateButton)),G(1),lt(i.panelService.title),G(2),oe("ngIf",i.isAbleMinimizeButton),G(1),oe("ngIf",i.isAbleFullScreenButton),G(1),oe("ngIf",i.isAbleCloseButton),G(1),ut("display",i.isMinimized&&!i.isFullScreen?"none":null),oe("ngClass",un(31,OX,i.isAbleRotateButton,i.isHorizontal)))},dependencies:[si,Bn,hv,xX],styles:["[_nghost-%COMP%]{display:block}.draggable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;color:#444;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;padding:0;top:200px;height:200px;width:300px;max-height:100%;max-width:100%;cursor:grab}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;position:absolute;top:25px;bottom:0;width:100%;padding:8px;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;padding:2px 5px;width:100%;background-color:#555;color:#ccc;-webkit-user-select:none;-moz-user-select:none;user-select:none}.title-button[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#ccc}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}@media screen and (-webkit-min-device-pixel-ratio: 0){.scrollable-panel.overlay[_ngcontent-%COMP%]{overflow:overlay}}.scrollable-panel.horizontal[_ngcontent-%COMP%]{overflow-x:auto;overflow-y:hidden}.rotateble[_ngcontent-%COMP%]{display:inline;top:-3px;position:relative}.is-minimized[_ngcontent-%COMP%]{height:27px!important}.is-full-screen[_ngcontent-%COMP%]{left:0!important;top:0!important;width:100vw!important;height:100vh!important;cursor:default}.draggable-panel.is-full-screen[_ngcontent-%COMP%]{border:0px none}.draggable-panel.i-am-gm[_ngcontent-%COMP%]{background:linear-gradient(-30deg,rgba(240,208,208,.9),rgba(255,236,236,.9))}"],data:{animation:[Vn("flyInOut",[tn("void => *",[Zt("100ms ease-out",bn([dt({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),dt({transform:"scale(1.0, 1.0)",opacity:"1",offset:1})]))]),tn("* => void",[Zt(100,dt({transform:"scale(0, 0)"}))])])]}}),t})();const RX=["standImageElement"],LX=["dialogElement"],BX=function(t){return{"emote-secret":t}};function zX(t,n){if(1&t&&(Q(0,"div",12),ve(1),ne()),2&t){const e=me(3);ut("visibility",e.isShowStand&&e.isApplyDialog?"visible":"hidden")("width",e.imageWidth,"px")("font-size",e.imageWidth/4.5>16?e.imageWidth/4.5:16,"px")("color",e.color?e.color:"#444")("bottom",e.emoteCssBottom,"px"),oe("@fadeAndScaleInOut",void 0)("ngClass",wt(13,BX,e.isSecret)),G(1),lt(e.gameCharacter.text)}}const jX=function(t,n){return{"transform-origin":t,transform:n}},UX=function(t){return{inverse:t}},HX=function(t,n,e,i,r,o,s,a){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}},VX=function(t,n){return{"black-paint":t,hollow:n}};function GX(t,n){if(1&t){const e=ft();it(0),Te(1,zX,2,15,"div",5),Q(2,"div",6)(3,"div",7)(4,"div",8)(5,"div",9)(6,"img",10,11),Ae("load",function(){return Re(e),Le(me(2).onImageLoad())}),Lt(8,"safe"),ne()()()()(),rt()}if(2&t){const e=me(2);G(1),oe("ngIf",!e.isBackyard&&e.gameCharacter.isEmote),G(1),oe("ngStyle",un(11,jX,e.standImageTransformOrigin,e.isApplyRoll?"rotate("+e.gameCharacter.roll+"deg)":"")),G(1),oe("ngClass",wt(14,UX,e.isApplyImageEffect&&e.gameCharacter.isInverse)),G(1),oe("ngClass",Ms(16,HX,e.isApplyImageEffect&&0==e.gameCharacter.aura,e.isApplyImageEffect&&1==e.gameCharacter.aura,e.isApplyImageEffect&&2==e.gameCharacter.aura,e.isApplyImageEffect&&3==e.gameCharacter.aura,e.isApplyImageEffect&&4==e.gameCharacter.aura,e.isApplyImageEffect&&5==e.gameCharacter.aura,e.isApplyImageEffect&&6==e.gameCharacter.aura,e.isApplyImageEffect&&7==e.gameCharacter.aura)),G(2),ut("height",e.height>0?e.height+"vh":"auto"),oe("src",Bt(8,8,e.standImage.url,"resourceUrl"),vn)("ngClass",un(25,VX,e.isApplyImageEffect&&e.gameCharacter.isBlackPaint,e.isApplyImageEffect&&e.gameCharacter.isHollow))}}const qX=function(t,n,e,i){return{"is-can-be-gone":t,"is-ghostly":n,backyard:e,secret:i}};function WX(t,n){if(1&t){const e=ft();Q(0,"div",3),Ae("click",function(){Re(e);const r=me();return r.toGhostly(),Le(r.toBackyard())}),Te(1,GX,9,28,"ng-container",4),ne()}if(2&t){const e=me();ut("left",e.position+"%")("height",0==e.height?"":e.height+"vh")("margin-left",-e.imageWidth/2,"px")("margin-bottom",e.adjustY,"px"),oe("@standInOut",e.groupValue)("ngClass",Is(11,qX,e.isCanBeGone,e.isGhostly,e.isBackyard,e.isSecret)),G(1),oe("ngIf",e.gameCharacter&&e.standImage.url&&e.standImage.url.length>0)}}const KX=function(t,n,e){return{"is-can-be-gone":t,"is-ghostly":n,backyard:e}};function YX(t,n){if(1&t&&(Q(0,"span",13)(1,"b"),ve(2),ne()()),2&t){const e=me();ut("color",e.color?e.color:"#444")("left",e.position+"%")("margin-bottom",e.adjustY>0?e.adjustY:0,"px")("border-color",e.color?e.color:"#444")("margin-left",e.nameTagCSSMarginLeft,"px"),oe("ngClass",mo(12,KX,e.isCanBeGone,e.isGhostly,e.isBackyard)),G(2),lt(e.gameCharacter.name)}}const ZX=function(t,n,e){return{left:t,right:n,"transform-origin":e}},XX=function(t,n,e,i,r,o){return{"is-can-be-gone":t,"is-ghostly":n,backyard:e,"dialog-secret":i,"is-position-right":r,"is-position-left":o}};function QX(t,n){if(1&t){const e=ft();Q(0,"div",14,15),Ae("click",function(){Re(e);const r=me();return r.toGhostly(),Le(r.toBackyard())}),Q(2,"p",16),Ae("@dialogShake.start",function(r){return Re(e),Le(me().onSpeaking(r))}),Lt(3,"safe"),ne()()}if(2&t){const e=me();ut("visibility",e.isShowStand&&e.isApplyDialog?"visible":"hidden")("color",e.isSecret?"#ccc":e.color?e.color:"#444")("left",e.dialogBoxCSSLeft,"px")("bottom",e.dialogBoxCssBottom>12?e.dialogBoxCssBottom:12,"px")("max-width",e.dialogBoxCSSMaxWidth,"px")("border-color",e.color?e.color:"#444"),oe("@fadeAndScaleInOut",void 0)("ngStyle",mo(20,ZX,e.position<=50?e.dialogBoxCSSLeft+"px":"auto",e.position>50?e.dialogBoxCSSRight+"px":"auto",e.position<=50?"12px calc(100% + 12px)":"calc(100% - 12px) calc(100% + 12px)"))("ngClass",H_(24,XX,e.isCanBeGone,e.isGhostly,e.isBackyard,e.isSecret,e.position<=50,e.position>50)),G(2),oe("@dialogShake",e.math.floor(e.dialogText.length/2))("innerHTML",Bt(3,17,e.dialogText,"html"),lr)}}let da=(()=>{class t{constructor(e){this.ngZone=e,this._imageFile=on.Empty,this.isFarewell=!1,this.isGhostly=!1,this.isBackyard=!1,this.isVisible=!1,this.isSecret=!1,this.standImageTransformOrigin="center",this.naturalWidth=0,this.naturalHeight=0,this.isSpeaking=!1,this.math=Math}onSpeaking(e){this.gameCharacter&&this.gameCharacter.text&&(this.isApplyDialog||this.isSpeakable||this.gameCharacter.isShowChatBubble)&&(clearTimeout(this._timeoutId),this._timeoutId=setTimeout(()=>{this.ngZone.run(()=>{this.isVisible=!1})},12e3)),this.isSpeakable&&(clearTimeout(this._dialogTimeoutId),this.gameCharacter&&this.gameCharacter.text&&(this.isSpeaking=!0),this._dialogTimeoutId=setTimeout(()=>{this.ngZone.run(()=>{this.isSpeaking=!1})},300))}get isShowStand(){return t.isShowStand}get isShowNameTag(){return t.isShowNameTag&&this.isShowName}get isCanBeGone(){return t.isCanBeGone}set dialog(e){if(!this.gameCharacter||"table"===this.gameCharacter.location.name&&!this.gameCharacter.isHideIn||"graveyard"===this.gameCharacter.location.name)return;clearTimeout(this._dialogTimeoutId);let i=pt.cr(e.text);const r=pt.isEmote(i),o=[],s=/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g;let a,h=0,b=0;if(!r)for(i=i.replace(/[\u3002\u3001]{3}/g,"\u2026").replace(/[\u3002\u3001]{2}/g,"\u2025").replace(/(\u3002|[\r\n]{2,})/g,"$1                            ").trimEnd();null!==(a=s.exec(i));){let je=a.index-3*h;o.push({base:a[1],ruby:a[2],start:je-b,end:je+a[1].length-b-1}),h++,b+=a[2].length}let ee=1e3/Array.from(i).length>36?1e3/Array.from(i).length:36;ee>200&&(ee=200),this._dialogTimeoutId=setTimeout(()=>{this.gameCharacter.text="",this.gameCharacter.isEmote=!1},Array.from(i).length*ee+6e3),this.gameCharacter.isEmote=r,h=0;let de=0,ge=0,xe="",ke=o.shift(),Pe="",Oe=!1;if(r)this.gameCharacter.text=i;else{const je=Array.from(i.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a.+?\u300b/g,"$1"));this._chatIntervalId=setInterval(()=>{let qe=je[h],Ve=qe.length>1;if(qe){if(!Oe&&ke&&de>=ke.start&&(xe+="<ruby>",Oe=!0,ge=0),xe+=pt.escapeHtml(qe),Oe){ge+=1;let We=ke.ruby;Pe="<rt>"+pt.escapeHtml(Array.from(We).slice(0,Math.ceil(Array.from(We).length*(ge/Array.from(ke.base).length))).join(""))+"</rt>"}Oe&&ke&&de>=ke.end-(Ve?1:0)&&(xe+=Pe+"</ruby>",Oe=!1,ke=o.shift()),de+=qe.length}h+=1,this.gameCharacter.text=xe+(Oe?Pe+"</ruby>":""),h>=je.length&&clearInterval(this._chatIntervalId)},ee)}}get dialogText(){return this.gameCharacter&&this.gameCharacter.text?this.gameCharacter.text.replace(/[\r\n]{2,}/g,"\n\n").replace(/                            /g,"").trim():""}get standImage(){if(!this.standElement)return this._imageFile;let e=null;if(this.isSpeaking&&(e=this.standElement.getFirstElementByName("speakingImageIdentifier")),(!e||!e.value||e.value==on.Empty.identifier)&&(e=this.standElement.getFirstElementByName("imageIdentifier")),e&&this._imageFile.identifier!==e.value){let i=Gt.instance.get(e.value);this._imageFile=i||on.Empty}return this._imageFile}get isSpeakable(){if(!this.standElement)return!1;let e=this.standElement.getFirstElementByName("speakingImageIdentifier");return e&&e.value&&e.value!==on.Empty.identifier}ngOnInit(){Ue.register(this).on("POPUP_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&this.ngZone.run(()=>{this.dialog=e.data})}).on("FAREWELL_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&(this.ngZone.run(()=>{this.dialog=null,this.gameCharacter.text="",this.gameCharacter.isEmote=!1}),clearTimeout(this._dialogTimeoutId),clearInterval(this._chatIntervalId))})}ngOnDestroy(){clearTimeout(this._timeoutId),clearTimeout(this._dialogTimeoutId)}get group(){if(!this.gameCharacter)return"";let e=this.standElement.getFirstElementByName("name");return e.currentValue&&e.currentValue.toString().length>0?e.currentValue.toString():""}get groupValue(){let e=0;const i=this.group;for(let r=0;r<i.length;r++)e=(e<<5)-e+i.charCodeAt(r),e|=0;return e}get position(){if(!this.gameCharacter)return 0;let e=this.standElement.getFirstElementByName("position");return e&&e.currentValue?+e.value:this.gameCharacter.standList.position}get adjustY(){if(!this.gameCharacter)return 0;let e=this.standElement.getFirstElementByName("height");return this.imageHeight*(e&&e.currentValue?+e.currentValue:0)/100}get height(){if(!this.gameCharacter||!this.standElement)return 0;let e=this.standElement.getFirstElementByName("height");return e&&0!=+e.value||!this.gameCharacter.standList?e?+e.value:0:this.gameCharacter.standList.height}get imageHeight(){return 0==this.height?this.naturalHeight:document.documentElement.offsetHeight*this.height/100}get imageWidth(){return this.imageHeight*this.naturalWidth/this.naturalHeight}get dialogBoxCSSLeft(){return this.imageWidth*(this.position>50?.33:.66)-this.imageWidth/2-12+this.position*document.documentElement.clientWidth/100-(this.position>50?this.dialogBoxCSSMaxWidth:0)}get dialogBoxCSSRight(){return document.documentElement.clientWidth-this.dialogBoxCSSLeft-this.dialogBoxCSSMaxWidth}get dialogBoxCSSMaxWidth(){let e=this.imageWidth/document.documentElement.clientWidth;return e/=2,e<.14&&(e=.14),e*document.documentElement.clientWidth}get dialogBoxCssBottom(){let e=.66*this.imageHeight+this.adjustY;return e<48&&(e=48),this.dialogElement&&e>document.documentElement.offsetHeight-this.dialogElement.nativeElement.clientHeight&&(e=document.documentElement.offsetHeight-this.dialogElement.nativeElement.clientHeight),e}get emoteCssBottom(){let e=.66*this.imageHeight+(this.imageWidth/4.5>16?this.imageWidth/4.5:16);return e<0&&(e=0),e}get nameTagCSSMarginLeft(){let e=this.imageWidth/2-this.position*document.documentElement.clientWidth/100;return e<32&&(e=32),-this.imageWidth/2+e}get isApplyImageEffect(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("applyImageEffect");return!(!e||!e.value)}get isApplyRoll(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("applyRoll");return!(!e||!e.value)}get isApplyDialog(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("applyDialog");return!(!e||!e.value)}get isShowName(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("showName");return!(!e||!e.value)}calcStandImageTransformOrigin(){return"center 66%"}toGhostly(){this.ngZone.run(()=>{this.isGhostly=!0})}toBackyard(){this.ngZone.run(()=>{this.isBackyard=!0})}toFront(){this.ngZone.run(()=>{this.isFarewell=!1,this.isGhostly=!1,this.isBackyard=!1,this.isVisible=!0}),clearTimeout(this._timeoutId),this._timeoutId=setTimeout(()=>{this.ngZone.run(()=>{this.isVisible=!1})},12e3)}toFarewell(){this.ngZone.run(()=>{this.isFarewell=!0,this.isVisible=!1})}onImageLoad(){this.naturalWidth=this.standImageElement.nativeElement.naturalWidth,this.naturalHeight=this.standImageElement.nativeElement.naturalHeight,this.standImageTransformOrigin=this.calcStandImageTransformOrigin()}}return t.isShowStand=!0,t.isShowNameTag=!0,t.isCanBeGone=!0,t.\u0275fac=function(e){return new(e||t)(He(Nn))},t.\u0275cmp=fn({type:t,selectors:[["stand-image"]],viewQuery:function(e,i){if(1&e&&(wn(RX,5),wn(LX,5)),2&e){let r;Cn(r=xn())&&(i.standImageElement=r.first),Cn(r=xn())&&(i.dialogElement=r.first)}},inputs:{gameCharacter:"gameCharacter",standElement:"standElement",color:"color"},decls:4,vars:7,consts:[["class","stand-image-container",3,"left","height","margin-left","margin-bottom","ngClass","click",4,"ngIf"],["class","name-tag","style","pointer-events: none;",3,"color","ngClass","left","margin-bottom","border-color","margin-left",4,"ngIf"],["class","name-tag dialog chat-bubble-buyo","style","margin-left: 12px; min-width: 5em; white-space: pre-wrap; font-size: 14px; pointer-events: none;",3,"visibility","color","left","bottom","max-width","ngStyle","ngClass","border-color","click",4,"ngIf"],[1,"stand-image-container",3,"ngClass","click"],[4,"ngIf"],["class","emote chat-bubble-buyo","style","position: absolute; pointer-events: none; text-align: center; margin-top: -1em",3,"visibility","width","font-size","color","bottom","ngClass",4,"ngIf"],[3,"ngStyle"],[1,"inverser",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"color-fillter"],["draggable","false",1,"stand-image",3,"src","ngClass","load"],["standImageElement",""],[1,"emote","chat-bubble-buyo",2,"position","absolute","pointer-events","none","text-align","center","margin-top","-1em",3,"ngClass"],[1,"name-tag",2,"pointer-events","none",3,"ngClass"],[1,"name-tag","dialog","chat-bubble-buyo",2,"margin-left","12px","min-width","5em","white-space","pre-wrap","font-size","14px","pointer-events","none",3,"ngStyle","ngClass","click"],["dialogElement",""],[2,"width","100%",3,"innerHTML"]],template:function(e,i){1&e&&(Q(0,"div"),Te(1,WX,2,16,"div",0),Te(2,YX,3,16,"span",1),Te(3,QX,4,31,"div",2),ne()),2&e&&(ut("visibility",i.isShowStand?"visible":"hidden")("pointer-events",i.isShowStand?"auto":"none"),G(1),oe("ngIf",!i.isFarewell&&(i.isVisible||!i.isCanBeGone)),G(1),oe("ngIf",i.isShowStand&&!i.isFarewell&&(i.isVisible||!i.isCanBeGone)&&i.isShowNameTag&&i.gameCharacter&&i.gameCharacter.name),G(1),oe("ngIf",!i.isFarewell&&i.isVisible&&!i.isBackyard&&i.gameCharacter&&i.gameCharacter.text&&!i.gameCharacter.isEmote))},dependencies:[si,Bn,fr,$i],styles:['.stand-image-container[_ngcontent-%COMP%]{position:absolute;display:inline-block;bottom:-.1%;z-index:1000000;transition:opacity .1s ease-in}.is-ghostly[_ngcontent-%COMP%]{z-index:900000}.is-can-be-gone.is-ghostly[_ngcontent-%COMP%]{opacity:.5;filter:brightness(.5)}.backyard[_ngcontent-%COMP%]{pointer-events:none;z-index:0}.name-tag[_ngcontent-%COMP%]{color:#444;background-color:#f5f5f5;border:2px solid #444;border-radius:24px;padding:4px 12px;bottom:2px;display:inline-block;white-space:nowrap;position:absolute;font-size:16px;opacity:.9;z-index:1000005}.name-tag.is-ghostly[_ngcontent-%COMP%]{z-index:900005}.is-can-be-gone.name-tag.is-ghostly[_ngcontent-%COMP%]{opacity:.5}.name-tag.backyard[_ngcontent-%COMP%]{z-index:1}.is-can-be-gone.is-ghostly.backyard[_ngcontent-%COMP%]{opacity:.25}.secret[_ngcontent-%COMP%]   .color-fillter[_ngcontent-%COMP%]{filter:grayscale(80%)}.name-tag.dialog[_ngcontent-%COMP%]{border-radius:24px 24px 24px 12px}.name-tag.dialog-secret[_ngcontent-%COMP%]{border-radius:24px 12px;background:rgba(85,85,85,.9)}.name-tag.dialog.is-position-left[_ngcontent-%COMP%]{border-radius:24px 24px 12px}.name-tag.dialog.dialog-secret.is-position-left[_ngcontent-%COMP%]{border-radius:12px 24px}.emote[_ngcontent-%COMP%]{text-align:center;font-size:48px;font-weight:700;border:none;background:none;-webkit-text-stroke:2px whitesmoke;white-space:pre-wrap;word-break:break-word}.emote.emote-secret[_ngcontent-%COMP%]{-webkit-text-stroke:2px #555}.emote.emote-secret.is-ghostly[_ngcontent-%COMP%]{z-index:900005}.emote[_ngcontent-%COMP%]{z-index:1000005}.emote.is-ghostly[_ngcontent-%COMP%]{z-index:900005}.dialog[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{overflow-wrap:anywhere;word-break:break-word;display:inline-block;margin-top:.5em;margin-bottom:.5em}.dialog.is-position-right[_ngcontent-%COMP%]:after{box-sizing:border-box;content:"";position:absolute;padding:0;line-height:1;vertical-align:baseline;bottom:-25px;border:12px solid transparent;border-top-color:inherit;left:17px;margin:0 0 0 -12px}.dialog.is-position-left[_ngcontent-%COMP%]:before{box-sizing:border-box;content:"";position:absolute;margin:0 -12px 0 0;padding:0;line-height:1;vertical-align:baseline;bottom:-25px;border:12px solid transparent;border-top-color:inherit;right:17px}.chat-bubble-buyo[_ngcontent-%COMP%]{transition:transform .2s ease;animation:chat-bubble-buyo 1.2s ease-in-out .1s infinite alternate;transform:scale3d(.9,.9,.9)}.chat-bubble-buyo.emote[_ngcontent-%COMP%]{animation-duration:.6s;transform-origin:center bottom}@keyframes chat-bubble-buyo{0%{transform:scale3d(.9,.9,.9)}to{transform:scaleZ(1)}}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #fff)}'],data:{animation:[Vn("standInOut",[tn("void => *,:increment,:decrement",[Zt("132ms cubic-bezier(.21,.97,.75,1.25)",bn([dt({opacity:.6,transform:"translateY(48px) scale(0.9)",offset:0}),dt({opacity:1,transform:"translateY(0px) scale(1.0)",offset:1})]))]),tn("* => void,:increment,:decrement",[Zt("132ms ease-out",bn([dt({transform:"translateY(0px) scale(1.0)",offset:0}),dt({opacity:0,transform:"translateY(96px) scale(0.9)",offset:1})]))])]),Vn("dialogShake",[tn(":increment",[Zt("19ms ease",bn([dt({transform:"translateX(1px)"})])),Zt("19ms ease",bn([dt({transform:"translateX(-1px)"})]))])]),Vn("fadeAndScaleInOut",[tn("void => *, true => false",[Zt("200ms ease-in-out",bn([dt({transform:"scale3d(0, 0, 0)",opacity:0}),dt({transform:"scale3d(0.9, 0.9, 0.9)",opacity:.9})]))]),tn("* => void, true => false",[Zt("100ms ease-in-out",dt({transform:"scale3d(0, 0, 0)",opacity:0}))])])]}}),t})();class $r{constructor(){}show(n,e,i=null,r=!1){let o=!0;for(const s of $r.currentStandImageShowing){const a=s[0],h=s[1];if(!h)continue;const b=h.instance;b.isVisible&&n.identifier!=a?b.toGhostly():n.identifier==a&&"graveyard"!=n.location.name?(b.standElement=e,b.color=i||n.chatPalette.color,b.isSecret=r,b.toFront(),o=!1):(b.isFarewell||da.isCanBeGone)&&(h.destroy(),$r.currentStandImageShowing.delete(a))}if(o&&"graveyard"!=n.location.name){const s=$r.defaultParentViewContainerRef.createComponent(da);s.instance.gameCharacter=n,s.instance.standElement=e,s.instance.color=i||n.chatPalette.color,s.instance.isSecret=r,s.instance.toFront(),$r.currentStandImageShowing.set(n.identifier,s)}}farewell(n){n instanceof sn&&(n=n.identifier);const e=$r.currentStandImageShowing.get(n);e&&e.instance&&e.instance.toFarewell()}destroy(n,e){n instanceof sn&&(n=n.identifier),e instanceof St&&(e=e.identifier);for(const i of $r.currentStandImageShowing){const r=i[1];!r||(!r.instance||!r.instance.standElement||r.instance.standElement.identifier==e)&&(r.destroy(),$r.currentStandImageShowing.delete(n))}}destroyAll(){for(const n of $r.currentStandImageShowing){const e=n[0],i=n[1];!i||(i.destroy(),$r.currentStandImageShowing.delete(e))}}}$r.currentStandImageShowing=new Map,$r.\u0275fac=function(n){return new(n||$r)},$r.\u0275prov=$n({token:$r,factory:$r.\u0275fac,providedIn:"root"});const JX=["diceRollTableSelecter"];function eQ(t,n){if(1&t&&(Q(0,"option",9),ve(1),ne()),2&t){const e=n.$implicit;ut("color",""==e.name?"gray":""),xt("value",e.identifier),xt("title",e.name),G(1),lt(""==e.name?"(\u7121\u540d\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868)":e.name)}}function tQ(t,n){if(1&t&&(Q(0,"div",25),ve(1),ne()),2&t){const e=me(3);G(1),Zn("",e.progresPercent,"%")}}const nQ=function(t){return{"is-hidden":t}};function iQ(t,n){if(1&t){const e=ft();it(0),Q(1,"button",18),Ae("click",function(){return Re(e),Le(me(2).upTabIndex())}),ve(2,"\u2191"),ne(),Q(3,"button",18),Ae("click",function(){return Re(e),Le(me(2).downTabIndex())}),ve(4,"\u2193"),ne(),Q(5,"div",19)(6,"button",20),Ae("click",function(){return Re(e),Le(me(2).save())}),Q(7,"div",21)(8,"div",22),ve(9,"\u4fdd\u5b58"),ne(),Te(10,tQ,2,1,"div",23),ne()(),Q(11,"button",24),Ae("click",function(){return Re(e),Le(me(2).delete())}),ve(12,"\u524a\u9664"),ne()(),rt()}if(2&t){const e=me(2);G(6),oe("disabled",e.isSaveing),G(2),oe("ngClass",wt(3,nQ,e.isSaveing)),G(2),oe("ngIf",e.isSaveing)}}function rQ(t,n){if(1&t){const e=ft();it(0),Q(1,"button",18),Ae("click",function(){return Re(e),Le(me(2).restore())}),ve(2,"\u5143\u306b\u623b\u3059"),ne(),rt()}}function oQ(t,n){if(1&t){const e=ft();it(0),Q(1,"div",10)(2,"div",11)(3,"b"),ve(4,"name: "),ne(),Q(5,"input",12),Ae("ngModelChange",function(r){return Re(e),Le(me().diceRollTableName=r)}),ne()(),Q(6,"div")(7,"span",13)(8,"b"),ve(9,"command: "),ne(),Q(10,"input",14),Ae("ngModelChange",function(r){return Re(e),Le(me().diceRollTableCommand=r)}),ne()(),Q(11,"span",15)(12,"b"),ve(13,"dice: "),ne(),Q(14,"input",16),Ae("ngModelChange",function(r){return Re(e),Le(me().diceRollTableDice=r)}),ne()()()(),Q(15,"div")(16,"textarea",17),Ae("ngModelChange",function(r){return Re(e),Le(me().diceRollTableText=r)}),ne()(),mt(17,"hr"),Q(18,"div"),Te(19,iQ,13,5,"ng-container",8),Te(20,rQ,3,0,"ng-container",8),ne(),rt()}if(2&t){const e=me();G(5),oe("ngModel",e.diceRollTableName),Qt("disabled",e.isEditable?null:""),G(5),oe("ngModel",e.diceRollTableCommand),Qt("disabled",e.isEditable?null:""),G(4),oe("ngModel",e.diceRollTableDice),Qt("disabled",e.isEditable?null:""),G(2),oe("ngModel",e.diceRollTableText),Qt("disabled",e.isEditable?null:""),G(3),oe("ngIf",!e.isDeleted),G(1),oe("ngIf",e.isDeleted&&e.selectedDiceRollTableXml)}}function sQ(t,n){if(1&t){const e=ft();it(0),Q(1,"button",18),Ae("click",function(){return Re(e),Le(me(2).restore())}),ve(2,"\u5143\u306b\u623b\u3059"),ne(),rt()}}function aQ(t,n){if(1&t&&(it(0),Q(1,"div",26),ve(2," \u203b\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u304c\u3042\u308a\u307e\u305b\u3093\u3002 "),Te(3,sQ,3,0,"ng-container",8),ne(),rt()),2&t){const e=me();G(3),oe("ngIf",e.isDeleted&&e.selectedDiceRollTableXml)}}let lQ=(()=>{class t{constructor(e,i,r,o){this.pointerDeviceService=e,this.modalService=i,this.panelService=r,this.saveDataService=o,this.selectedDiceRollTable=null,this.selectedDiceRollTableXml="",this.isSaveing=!1,this.progresPercent=0}get diceRollTableName(){return this.selectedDiceRollTable.name}set diceRollTableName(e){this.isEditable&&(this.selectedDiceRollTable.name=e)}get diceRollTableDice(){return this.selectedDiceRollTable.dice}set diceRollTableDice(e){this.isEditable&&(this.selectedDiceRollTable.dice=e)}get diceRollTableCommand(){return this.selectedDiceRollTable.command}set diceRollTableCommand(e){this.isEditable&&(this.selectedDiceRollTable.command=e)}get diceRollTableText(){return this.selectedDiceRollTable.value}set diceRollTableText(e){this.isEditable&&(this.selectedDiceRollTable.value=e)}get diceRollTables(){return Ns.instance.children}get isEmpty(){return this.diceRollTables.length<1}get isDeleted(){return!!this.selectedDiceRollTable&&null==Ct.instance.get(this.selectedDiceRollTable.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u8a2d\u5b9a"),Ue.register(this).on("DELETE_GAME_OBJECT",1e3,e=>{if(!this.selectedDiceRollTable||e.data.identifier!==this.selectedDiceRollTable.identifier)return;let i=Ct.instance.get(e.data.identifier);null!==i&&(this.selectedDiceRollTableXml=i.toXml())})}ngAfterViewInit(){this.diceRollTables.length>0&&queueMicrotask(()=>{this.onChangeDiceRollTable(this.diceRollTables[0].identifier),this.diceRollTableSelecter.nativeElement.selectedIndex=0})}ngOnDestroy(){Ue.unregister(this)}onChangeDiceRollTable(e){this.selectedDiceRollTable=Ct.instance.get(e),this.selectedDiceRollTableXml=""}create(e="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868"){return Ns.instance.addDiceRollTable(e)}add(){const e=this.create();queueMicrotask(()=>{this.onChangeDiceRollTable(e.identifier),this.diceRollTableSelecter.nativeElement.value=e.identifier})}save(){var e=this;return(0,gn.Z)(function*(){if(!e.selectedDiceRollTable||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i="fly_rollTable_"+e.selectedDiceRollTable.name;yield e.saveDataService.saveGameObjectAsync(e.selectedDiceRollTable,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}saveAll(){var e=this;return(0,gn.Z)(function*(){e.isSaveing||(e.isSaveing=!0,e.progresPercent=0,yield e.saveDataService.saveGameObjectAsync(Ns.instance,"fly_rollTable_All",i=>{e.progresPercent=i}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500))})()}delete(){!this.isEmpty&&this.selectedDiceRollTable&&(this.selectedDiceRollTableXml=this.selectedDiceRollTable.toXml(),this.selectedDiceRollTable.destroy())}restore(){if(this.selectedDiceRollTable&&this.selectedDiceRollTableXml){let e=gi.instance.parseXml(this.selectedDiceRollTableXml);Ns.instance.addDiceRollTable(e),this.selectedDiceRollTableXml="",queueMicrotask(()=>{const i=this.diceRollTables;this.onChangeDiceRollTable(i[i.length-1].identifier),this.diceRollTableSelecter.nativeElement.selectedIndex=i.length-1})}}upTabIndex(){if(!this.selectedDiceRollTable)return;let e=this.selectedDiceRollTable.parent,i=e.children.indexOf(this.selectedDiceRollTable);0<i&&e.insertBefore(this.selectedDiceRollTable,e.children[i-1])}downTabIndex(){if(!this.selectedDiceRollTable)return;let e=this.selectedDiceRollTable.parent,i=e.children.indexOf(this.selectedDiceRollTable);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.selectedDiceRollTable)}helpDiceRollTable(){let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(Fu,{left:e.x,top:e.y,width:600,height:788});r.title="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u30d8\u30eb\u30d7",r.text="\u3000\u540d\u524d\u3001\u30b3\u30de\u30f3\u30c9\u3001\u632f\u308b\u30c0\u30a4\u30b9\u3092\u8a2d\u5b9a\u3057\u3001\u30c0\u30a4\u30b9\u306e\u6570\u5b57\u3067\u8868\u3092\u53c2\u7167\u3057\u3001\u8868\u793a\u3057\u307e\u3059\u3002\n\u3000\u30c1\u30e3\u30c3\u30c8\u3067\u30b3\u30de\u30f3\u30c9\u3092\u9001\u4fe1\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3068\u540c\u69d8\u306b\u7d50\u679c\u304c\u9001\u4fe1\u3055\u308c\u307e\u3059\u3002\n\u3000\u8868\u306f1\u884c\u3054\u3068\u306b\u6570\u5b57\u3068\u7d50\u679c\u3092:\uff08\u30b3\u30ed\u30f3\uff09\u3067\u533a\u5207\u308a\u300c\u6570\u5b57:\u7d50\u679c\u300d\u306e\u5f62\u3067\u8a18\u8ff0\u3057\u307e\u3059\uff08\u3088\u3063\u3066\u3001\u30c0\u30a4\u30b9\u306f\u6700\u5f8c\u306b\u4e00\u3064\u306e\u6570\u5b57\u3092\u8fd4\u3059\u3082\u306e\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3001\u30d0\u30e9\u30d0\u30e9\u30c0\u30a4\u30b9 nBm\u3001\u500b\u6570\u632f\u308a\u8db3\u3057\u30c0\u30a4\u30b9 nRm\u3001\u4e0a\u65b9\u7121\u9650\u30ed\u30fc\u30eb nUm \u306e\u6210\u529f\u6570\u306b\u3082\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\uff09\u3002\n\u3000\n\u3000-\uff08\u30cf\u30a4\u30d5\u30f3\uff09\u307e\u305f\u306f\uff5e\u3067\u533a\u5207\u3063\u3066\u6570\u5b57\u306e\u7bc4\u56f2\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\u3000\u8868\u306b \\n \u3068\u66f8\u304f\u3068\u3001\u305d\u3053\u3067\u6539\u884c\u3057\u307e\u3059\uff08\\n\u306f\u8868\u793a\u3055\u308c\u307e\u305b\u3093\uff09\u3002\n\n\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u4f8b\uff09\n\u3000name: \u906d\u9047\u8266\u7a2e\u3000\n\u3000command: ShipType\u3000\u3000dice: 1d6\n\n\u3000\u30001:\u6226\u8266\n\u3000\u30002:\u7a7a\u6bcd\n\u3000\u30003:\u91cd\u5de1\u6d0b\u8266\n\u3000\u30004:\u8efd\u5de1\u6d0b\u8266\n\u3000\u30005-6:\u99c6\u9010\u8266\n\n\u3000\u8868\u3092\u53c2\u7167\u3059\u308b\u969b\u306f\u5148\u306b\u3042\u308b\u3082\u306e\u304c\u512a\u5148\u3055\u308c\u307e\u3059\u3001\u4e0a\u8a18\u306e\u4f8b\u3067\u306f\u6700\u5f8c\u306e\u884c\u3092\u300c1-6:\u99c6\u9010\u8266\u300d\u306a\u3069\u3068\u3057\u3066\u3082\u540c\u3058\u7d50\u679c\u306b\u306a\u308a\u307e\u3059\uff08\u304c\u3001\u5206\u304b\u308a\u3084\u3059\u3044\u8a18\u8ff0\u3092\u304a\u52e7\u3081\u3057\u307e\u3059\uff09\u3002\n\u3000\u30c7\u30d5\u30a9\u30eb\u30c8\u306e D66 \u306f\u30bd\u30fc\u30c8\u3055\u308c\u307e\u305b\u3093\u306e\u3067\u3001\u5fc5\u8981\u306a\u5834\u5408\uff08\u30b5\u30a4\u30b3\u30ed\u30fb\u30d5\u30a3\u30af\u30b7\u30e7\u30f3\u306e\u540d\u524d\u8868\u306a\u3069\uff09\u306f\u3001 D66S \u3068\u3057\u3066\u30bd\u30fc\u30c8\u3057\u305f\u6570\u5b57\u3092\u5f97\u3066\u304f\u3060\u3055\u3044\u3002\n\u3000\u6570\u5b57\u306e\u8a18\u8ff0\u306e\u969b *\uff08\u30a2\u30b9\u30bf\u30ea\u30b9\u30af\uff09\u3092\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\uff08\u4efb\u610f\u306e\u6570\u5b57\uff09\u3068\u3057\u3066\u4f7f\u7528\u53ef\u80fd\u3067\u3059\u3001\u4f8b\u3048\u3070 *-1 \u3068\u3059\u308c\u30701\u4ee5\u4e0b\u30016-* \u3068\u3059\u308c\u30706\u4ee5\u4e0a\u306e\u4efb\u610f\u306e\u6570\u5b57\u3067\u3059\uff08*\u5358\u72ec\u306f\u3059\u3079\u3066\u306e\u6570\u5b57\u3068\u306a\u308a\u3001\u5148\u306b\u3042\u308b\u3082\u306e\u304b\u3089\u53c2\u7167\u3055\u308c\u307e\u3059\u306e\u3067\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u9014\u4e2d\u306e\u884c\u306b\u66f8\u3044\u305f\u5834\u5408\u305d\u308c\u3088\u308a\u5148\u306e\u884c\u304c\u53c2\u7167\u3055\u308c\u306a\u304f\u306a\u308a\u307e\u3059\uff09\u3002\u5f8c\u8ff0\u306e\u4fee\u6b63\u306b\u3088\u308a\u8868\u304b\u3089\u306f\u307f\u51fa\u3057\u3066\u3082\u7d50\u679c\u3092\u5f97\u3089\u308c\u308b\u3088\u3046\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u3000\u30c1\u30e3\u30c3\u30c8\u304b\u3089\u306e\u30b3\u30de\u30f3\u30c9\u306e\u969b\u3001\u5168\u89d2\u534a\u89d2\u3001\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u306e\u5927\u6587\u5b57\u5c0f\u6587\u5b57\u306f\u7121\u8996\u3055\u308c\u307e\u3059\u3002\u307e\u305f\u30c0\u30a4\u30b9\u306b\u4fee\u6b63\u3092\u8db3\u3057\u5f15\u304d\u3059\u308b\u3001\u3042\u308b\u3044\u306f\u4efb\u610f\u306e\u6570\u5b57\u3067\u53c2\u7167\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\u30b3\u30de\u30f3\u30c9\u306e\u5f8c\u306b +\u4fee\u6b63\u5024 \u307e\u305f\u306f -\u4fee\u6b63\u5024 \u3092\u8a18\u8ff0\u3059\u308b\u3053\u3068\u3067\u632f\u3089\u308c\u305f\u30c0\u30a4\u30b9\u306e\u6570\u5b57\u3092\u4fee\u6b63\u3057\u307e\u3059\u3002\u307e\u305f =\u6307\u5b9a\u5024 \u3068\u8a18\u8f09\u3059\u308b\u3053\u3068\u3067\u3001\u305d\u306e\u6570\u5b57\u3067\u30b3\u30de\u30f3\u30c9\u306b\u5bfe\u5fdc\u3059\u308b\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u3092\u53c2\u7167\u3057\u307e\u3059\u3002\u4fee\u6b63\u5024\u3001\u6307\u5b9a\u5024\u306f\u4efb\u610f\u306e\u6574\u6570\u3067\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\u306e\u4f8b\uff09\n\u3000ShipType=3\n\u3000\u524d\u8ff0\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u4f8b\u300c\u906d\u9047\u8266\u7a2e\u300d\u3092\u6570\u5b573\u6307\u5b9a\u3067\u53c2\u7167\u3057\u307e\u3059\u3001\u7d50\u679c\u300c\u91cd\u5de1\u6d0b\u8266\u300d\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\u3082\u3057\u30011\u672a\u6e80\u30846\u3092\u8d85\u3048\u308b\u6570\u5b57\u3092\u6307\u5b9a\u3057\u305f\u5834\u5408\u300c\uff08\u7d50\u679c\u306a\u3057\uff09\u300d\u3068\u306a\u308b\u3067\u3057\u3087\u3046\u3002\n\n\u3000ShipType+2\n\u3000\u524d\u8ff0\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u4f8b\u300c\u906d\u9047\u8266\u7a2e\u300d\u30921d6\u306e\u7d50\u679c\u306b+2\u3057\u305f\u6570\u5b57\u3067\u53c2\u7167\u3057\u307e\u3059\u3002\u300c\u906d\u9047\u8266\u7a2e\u300d\u306b\u306f7\u4ee5\u964d\u306e\u8a18\u8f09\u304c\u3042\u308a\u307e\u305b\u3093\u3001\u305d\u306e\u5834\u5408\u300c\uff08\u7d50\u679c\u306a\u3057\uff09\u300d\u3068\u306a\u308b\u3067\u3057\u3087\u3046\u3001\u305d\u308c\u3092\u907f\u3051\u305f\u3044\u5834\u5408\u306f\u524d\u8ff0\u306e\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9 * \u3092\u4f7f\u7528\u3057\u307e\u3059\u3002"}}return t.\u0275fac=function(e){return new(e||t)(He(Ci),He(Yn),He(qn),He(Gr))},t.\u0275cmp=fn({type:t,selectors:[["dice-roll-table-setting"]],viewQuery:function(e,i){if(1&e&&wn(JX,5),2&e){let r;Cn(r=xn())&&(i.diceRollTableSelecter=r.first)}},decls:13,vars:3,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[2,"font-size","smaller","margin-bottom","3px",3,"click"],["size","15",2,"width","14em",3,"change"],["diceRollTableSelecter",""],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[2,"float","right",3,"click"],[4,"ngIf"],[3,"value","title"],[2,"font-size","smaller"],[2,"margin-bottom","3px"],["placeholder","Name",2,"width","60%","min-width","5em",3,"ngModel","ngModelChange"],[2,"white-space","nowrap"],["placeholder","Command",2,"width","7em",3,"ngModel","ngModelChange"],[2,"white-space","nowrap","margin-left","1em"],["placeholder","Dice",2,"width","3.3em","text-align","center",3,"ngModel","ngModelChange"],["placeholder","1:\u6570\u5b57\u3068\u7d50\u679c\u3092:\uff08\u30b3\u30ed\u30f3\uff09\u3067\u533a\u5207\u3063\u3066\u8a18\u8ff0\r\n2:\u7d50\u679c\uff12\r\n3:\u7d50\u679c\uff13\r\n4:\u2026",2,"width","100%","height","20em","margin-top","3px","resize","vertical",3,"ngModel","ngModelChange"],[3,"click"],[2,"float","right"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,i){1&e&&(Q(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Ae("click",function(){return i.add()}),ve(4,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u8ffd\u52a0"),ne()(),Q(5,"select",3,4),Ae("change",function(o){return i.onChangeDiceRollTable(o.target.value)}),Te(7,eQ,2,5,"option",5),ne()(),Q(8,"div",6)(9,"button",7),Ae("click",function(){return i.helpDiceRollTable()}),ve(10,"?"),ne(),Te(11,oQ,21,10,"ng-container",8),ne()(),Te(12,aQ,4,1,"ng-container",8)),2&e&&(G(7),oe("ngForOf",i.diceRollTables),G(4),oe("ngIf",!i.isEmpty&&i.selectedDiceRollTable),G(1),oe("ngIf",i.isEmpty))},dependencies:[si,_i,Bn,oo,so,Ii,Mi,yi],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}"]}),t})();const cQ=["cutInSelecter"];function uQ(t,n){if(1&t&&(Q(0,"option",10),ve(1),ne()),2&t){const e=n.$implicit;ut("color",e.isValidAudio?""==e.name?"gray":"":"red"),xt("value",e.identifier),xt("title",e.name),G(1),lt((e.isPlayingNow?"\u25b6 ":"\u25a0 ")+(e.isValidAudio?"":"\u26a0\ufe0f")+(""==e.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":e.name))}}function dQ(t,n){if(1&t&&(Q(0,"div",66)(1,"i",67),ve(2),ne()()),2&t){const e=me(2);G(1),Pd(e.isShowHideImages?"red-eye":"grow"),G(1),lt(e.isShowHideImages?"visibility":"visibility_off")}}function fQ(t,n){if(1&t){const e=ft();Q(0,"button",8),Ae("click",function(){return Re(e),Le(me(3).openModal())}),Q(1,"b"),ve(2,"\u753b\u50cf\u5909\u66f4"),ne()()}}function hQ(t,n){if(1&t&&(Q(0,"div",68),Te(1,fQ,3,0,"button",69),ne()),2&t){const e=me(2);G(1),oe("ngIf",!e.cutInVideoId||e.cutInisSoundOnly)}}function pQ(t,n){if(1&t&&(Q(0,"div",70)(1,"i",71),ve(2),ne()()),2&t){const e=me(2);G(2),lt(e.cutInPlayListId?"featured_play_list":"movie")}}function gQ(t,n){1&t&&(it(0),ve(1,"\uff08\u3042\u306a\u305f\uff09"),rt())}function mQ(t,n){if(1&t&&(Q(0,"option",72),ve(1),Te(2,gQ,2,0,"ng-container",9),ne()),2&t){const e=n.$implicit,i=me(2);ut("color",e.color),xt("value",e.identifier),G(1),Zn("",e.name," "),G(1),oe("ngIf",e===i.myPeer)}}function _Q(t,n){if(1&t&&(Q(0,"option",73),ve(1),ne()),2&t){const e=n.$implicit;xt("value",e.identifier),G(1),lt(e.name)}}function $Q(t,n){1&t&&(Q(0,"span",48)(1,"i",76),ve(2,"check"),ne(),Q(3,"span",77),ve(4,"Link OK"),ne()())}function vQ(t,n){if(1&t&&(Q(0,"span",78),mt(1,"i",79),Q(2,"span",80),ve(3,"\u26a0\ufe0fLink NG:"),ne(),ve(4),ne()),2&t){const e=me(3);G(4),Zn(" ",e.cutInAudioFileName,"")}}function bQ(t,n){if(1&t&&(it(0),Te(1,$Q,5,0,"span",74),Te(2,vQ,5,1,"span",75),rt()),2&t){const e=me(2);G(1),oe("ngIf",e.isValidAudio),G(1),oe("ngIf",!e.isValidAudio)}}function yQ(t,n){if(1&t&&(Q(0,"div",86),ve(1),ne()),2&t){const e=me(3);G(1),Zn("",e.progresPercent,"%")}}const CQ=function(t){return{"is-hidden":t}};function wQ(t,n){if(1&t){const e=ft();it(0),Q(1,"button",8),Ae("click",function(){return Re(e),Le(me(2).upTabIndex())}),ve(2,"\u2191"),ne(),Q(3,"button",8),Ae("click",function(){return Re(e),Le(me(2).downTabIndex())}),ve(4,"\u2193"),ne(),Q(5,"div",19)(6,"button",81),Ae("click",function(){return Re(e),Le(me(2).save())}),Q(7,"div",82)(8,"div",83),ve(9,"\u4fdd\u5b58"),ne(),Te(10,yQ,2,1,"div",84),ne()(),Q(11,"button",85),Ae("click",function(){return Re(e),Le(me(2).delete())}),ve(12,"\u524a\u9664"),ne()(),rt()}if(2&t){const e=me(2);G(6),oe("disabled",e.isSaveing),G(2),oe("ngClass",wt(3,CQ,e.isSaveing)),G(2),oe("ngIf",e.isSaveing)}}function xQ(t,n){if(1&t){const e=ft();it(0),Q(1,"button",8),Ae("click",function(){return Re(e),Le(me(2).restore())}),ve(2,"\u5143\u306b\u623b\u3059"),ne(),rt()}}const EQ=function(t){return{blackout:t}},TQ=function(t){return{"red-eye":t}},OI=function(t){return{"not-specified":t}},SQ=function(t,n){return{color:t,"font-weight":n}};function IQ(t,n){if(1&t){const e=ft();it(0),Q(1,"div",11)(2,"div")(3,"div",12),Ae("dblclick",function(){Re(e);const r=me();return Le(!(!r.isEditable||r.cutInVideoId&&!r.cutInisSoundOnly)&&r.openModal())}),Te(4,dQ,3,3,"div",13),Te(5,hQ,2,1,"div",14),Te(6,pQ,3,1,"div",15),mt(7,"img",16),Lt(8,"safe"),ne()(),Q(9,"div",17)(10,"div",18)(11,"div",19)(12,"label",20)(13,"input",21),Ae("click",function(r){return Re(e),Le(me().onShowHiddenImages(r))}),ne(),Q(14,"i",22),ve(15),ne()()()(),Q(16,"div",23)(17,"b",24),ve(18,"Name: "),ne(),Q(19,"input",25),Ae("ngModelChange",function(r){return Re(e),Le(me().cutInName=r)}),ne(),Q(20,"b",26),ve(21,"Tag: "),ne(),Q(22,"input",27),Ae("ngModelChange",function(r){return Re(e),Le(me().cutInTag=r)}),ne()(),Q(23,"div",28)(24,"b",24),ve(25,"Duration (0=\u7121\u5236\u9650): "),ne(),Q(26,"input",29),Ae("ngModelChange",function(r){return Re(e),Le(me().cutInDuration=r)}),ne(),Q(27,"b",30),ve(28,"sec."),ne()(),Q(29,"div",23)(30,"b",24),ve(31,"Cut In: "),ne(),Q(32,"select",31),Ae("ngModelChange",function(r){return Re(e),Le(me().cutInType=r)}),Q(33,"option",32),ve(34,"\u5373\u6642\u51fa\u73fe"),ne(),Q(35,"option",32),ve(36,"\u6d6e\u304d\u51fa\u308b"),ne(),Q(37,"option",32),ve(38,"\u98db\u3073\u51fa\u3059"),ne(),Q(39,"option",32),ve(40,"\u958b\u304f\uff08\u5de6\u53f3\uff09"),ne(),Q(41,"option",32),ve(42,"\u958b\u304f\uff08\u4e0a\u4e0b\uff09"),ne()(),Q(43,"label",33)(44,"input",34),Ae("click",function(){Re(e);const r=me();return Le(r.borderStyle=0==r.borderStyle?1:0)}),ne(),Q(45,"b"),ve(46,"\u67a0\u3042\u308a"),ne()()(),Q(47,"div",23)(48,"b",24),ve(49,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e: "),ne(),mt(50,"br"),Q(51,"textarea",35),Ae("ngModelChange",function(r){return Re(e),Le(me().cutInCond=r)}),ne()()()(),Q(52,"div",36)(53,"div")(54,"button",8),Ae("click",function(){return Re(e),Le(me().testCutIn())}),Q(55,"b"),ve(56,"\u30c6\u30b9\u30c8 (\u81ea\u5206\u3060\u3051\u898b\u308b)"),Q(57,"sup",37),ve(58,"*"),ne()()(),Q(59,"span",38)(60,"button",39),Ae("click",function(){return Re(e),Le(me().playCutIn())}),Q(61,"b")(62,"i",40),ve(63,"play_arrow"),ne(),ve(64,"\u518d\u751f"),ne()(),Q(65,"button",41),Ae("click",function(){return Re(e),Le(me().stopCutIn())}),Q(66,"b")(67,"i",40),ve(68,"stop"),ne(),ve(69,"\u505c\u6b62"),ne()(),Q(70,"span",42),ve(71," \u27a1 "),Q(72,"select",43),Ae("ngModelChange",function(r){return Re(e),Le(me().sendTo=r)}),Q(73,"option",44),ve(74,"\u5168\u54e1"),ne(),Te(75,mQ,3,5,"option",45),ne()()()(),Q(76,"div",46)(77,"div")(78,"b",47),ve(79,"\u4f4d\u7f6e"),ne(),Q(80,"label",48)(81,"input",49),Ae("ngModelChange",function(r){return Re(e),Le(me().cutInIsPreventOutBounds=r)}),ne(),Q(82,"b"),ve(83,"\u898b\u5207\u308c\u9632\u6b62"),ne()()(),Q(84,"div",50)(85,"b"),ve(86,"PosX: "),ne(),Q(87,"input",51),Ae("ngModelChange",function(r){return Re(e),Le(me().cutInPosX=r)}),ne(),Q(88,"input",52),Ae("ngModelChange",function(r){return Re(e),Le(me().cutInPosX=r)}),ne(),Q(89,"b",23),ve(90,"%"),ne()(),Q(91,"div",50)(92,"b"),ve(93,"PosY: "),ne(),Q(94,"input",53),Ae("ngModelChange",function(r){return Re(e),Le(me().cutInPosY=r)}),ne(),Q(95,"input",52),Ae("ngModelChange",function(r){return Re(e),Le(me().cutInPosY=r)}),ne(),Q(96,"b",23),ve(97,"%"),ne()(),Q(98,"div",50)(99,"b"),ve(100,"Z-Index (\u5927\u304d\u3044\u3082\u306e\u304c\u524d): "),ne(),Q(101,"input",52),Ae("ngModelChange",function(r){return Re(e),Le(me().cutInZIndex=r)}),ne(),Q(102,"label",48)(103,"input",54),Ae("ngModelChange",function(r){return Re(e),Le(me().cutInIsFrontOfStand=r)}),ne(),Q(104,"b"),ve(105,"\u30b9\u30bf\u30f3\u30c9\u306e\u524d\u9762\u306b\u8868\u793a"),ne()()()(),Q(106,"div",46)(107,"div")(108,"b",47),ve(109,"\u30b5\u30a4\u30ba\uff08\u5e45\u3001\u9ad8\u3055\u5171\u306b0\u306e\u5834\u5408\u306f\u5143\u753b\u50cf\u306e\u307e\u307e\uff09"),ne()(),Q(110,"div",50)(111,"b"),ve(112,"Width (0=\u6307\u5b9a\u306a\u3057): "),ne(),Q(113,"input",55),Ae("ngModelChange",function(r){return Re(e),Le(me().cutInWidth=r)}),ne(),Q(114,"input",52),Ae("ngModelChange",function(r){return Re(e),Le(me().cutInWidth=r)}),ne(),Q(115,"b",23),ve(116,"%"),ne()(),Q(117,"div",50)(118,"b"),ve(119,"Height (0=\u6307\u5b9a\u306a\u3057): "),ne(),Q(120,"input",56),Ae("ngModelChange",function(r){return Re(e),Le(me().cutInHeight=r)}),ne(),Q(121,"input",52),Ae("ngModelChange",function(r){return Re(e),Le(me().cutInHeight=r)}),ne(),Q(122,"b",23),ve(123,"%"),ne()(),Q(124,"div",50)(125,"b"),ve(126,"\u5143\u753b\u50cf\u3068\u7e26\u6a2a\u6bd4\u304c\u7570\u306a\u308b\u5834\u5408: "),ne(),Q(127,"select",57),Ae("ngModelChange",function(r){return Re(e),Le(me().objectFitType=r)}),Q(128,"option",32),ve(129,"\u4f38\u7e2e\u3059\u308b"),ne(),Q(130,"option",32),ve(131,"\u5207\u308a\u53d6\u308b"),ne()()()(),Q(132,"div",46)(133,"div")(134,"b",47),ve(135,"\u52b9\u679c\u97f3\u30fb\u52d5\u753b"),ne(),Q(136,"label",48)(137,"input",58),Ae("ngModelChange",function(r){return Re(e),Le(me().cutInSEIsLoop=r)}),ne(),Q(138,"b"),ve(139,"\u7e70\u308a\u8fd4\u3057"),ne()()(),Q(140,"div",50)(141,"input",59),Ae("ngModelChange",function(r){return Re(e),Le(me().cutInIsVideo=r)}),ne(),Q(142,"label",60)(143,"b"),ve(144,"\u97f3\u697d\u30d5\u30a1\u30a4\u30eb: "),ne()(),Q(145,"select",61),Ae("ngModelChange",function(r){return Re(e),Le(me().cutInAudioIdentifier=r)})("change",function(r){return Re(e),Le(me().onAudioFileChange(r.target.value))}),Q(146,"option",44),ve(147,"\u52b9\u679c\u97f3\u306a\u3057"),ne(),Te(148,_Q,2,2,"option",62),ne(),Te(149,bQ,3,2,"ng-container",9),ne(),Q(150,"div",50)(151,"input",59),Ae("ngModelChange",function(r){return Re(e),Le(me().cutInIsVideo=r)}),ne(),Q(152,"label",60)(153,"b"),ve(154,"\u52d5\u753bURL: "),ne()(),Q(155,"input",63),Ae("ngModelChange",function(r){return Re(e),Le(me().cutInVideoURL=r)}),ne()(),Q(156,"div",64)(157,"a",65),Ae("click",function(){return Re(e),Le(me().openYouTubeTerms())}),ve(158,"YouTube \u5229\u7528\u898f\u7d04"),ne()()()(),mt(159,"hr"),Q(160,"div"),Te(161,wQ,13,5,"ng-container",9),Te(162,xQ,3,0,"ng-container",9),ne(),rt()}if(2&t){const e=me();G(4),oe("ngIf",(!e.cutInVideoId||e.cutInisSoundOnly)&&e.getHidden(e.cutInImage)),G(1),oe("ngIf",e.isEditable),G(1),oe("ngIf",e.cutInVideoId&&!e.cutInisSoundOnly),G(1),oe("ngClass",wt(125,EQ,(!e.cutInVideoId||e.cutInisSoundOnly)&&!e.isShowHideImages&&e.getHidden(e.cutInImage)))("src",Bt(8,122,e.cutInImageUrl,"resourceUrl"),vn),G(6),xt("checked",e.isShowHideImages?"checked":""),G(1),oe("ngClass",wt(127,TQ,e.isShowHideImages)),G(1),lt(e.isShowHideImages?"visibility":"visibility_off"),G(4),oe("ngModel",e.cutInName),Qt("disabled",e.isEditable?null:""),G(3),oe("ngModel",e.cutInTag),Qt("disabled",e.isEditable?null:""),G(4),oe("ngModel",e.cutInDuration),Qt("disabled",!e.isEditable||e.isPlaying?"":null),G(6),oe("ngModel",e.cutInType),Qt("disabled",e.isEditable?null:""),G(1),oe("value",-1)("selected",-1==e.cutInType),G(2),oe("value",0)("selected",0==e.cutInType),G(2),oe("value",1)("selected",1==e.cutInType),G(2),oe("value",2)("selected",2==e.cutInType),G(2),oe("value",3)("selected",3==e.cutInType),G(3),oe("checked",1==e.borderStyle),Qt("disabled",e.isEditable?null:""),G(7),oe("ngModel",e.cutInCond),Qt("disabled",e.isEditable?null:""),G(3),Qt("disabled",e.isEditable?null:""),G(6),Qt("disabled",e.isEditable?null:""),G(5),Qt("disabled",e.isEditable?null:""),G(7),oe("ngModel",e.sendTo)("ngClass",wt(129,OI,""==e.sendTo))("ngStyle",un(131,SQ,""==e.sendTo?null:e.sendToColor,""==e.sendTo?"normal":"bolder")),G(3),oe("ngForOf",e.otherPeers),G(6),oe("ngModel",e.cutInIsPreventOutBounds)("checked",e.cutInIsPreventOutBounds)("value",!0),Qt("disabled",!e.isEditable||e.cutInVideoId?"":null),G(6),xt("title",e.cutInPosX),xt("min",e.minSize),xt("max",e.maxSize),oe("ngModel",e.cutInPosX),Qt("disabled",e.isEditable?null:""),G(1),xt("min",e.minSize),xt("max",e.maxSize),oe("ngModel",e.cutInPosX),Qt("disabled",e.isEditable?null:""),G(6),xt("title",e.cutInPosY),xt("min",e.minSize),xt("max",e.maxSize),oe("ngModel",e.cutInPosY),Qt("disabled",e.isEditable?null:""),G(1),xt("min",e.minSize),xt("max",e.maxSize),oe("ngModel",e.cutInPosY),Qt("disabled",e.isEditable?null:""),G(6),xt("min",-e.maxSize),xt("max",e.maxSize),oe("ngModel",e.cutInZIndex),Qt("disabled",!e.isEditable||e.cutInVideoId?"":null),G(2),oe("ngModel",e.cutInIsFrontOfStand)("checked",e.cutInIsFrontOfStand)("value",!0),Qt("disabled",!e.isEditable||e.cutInVideoId?"":null),G(10),xt("title",e.cutInWidth),xt("min",e.minSize),xt("max",e.maxSize),oe("ngModel",e.cutInWidth),Qt("disabled",e.isEditable?null:""),G(1),xt("min",e.minSize),xt("max",2*e.maxSize),oe("ngModel",e.cutInWidth),Qt("disabled",e.isEditable?null:""),G(6),xt("title",e.cutInHeight),xt("min",e.minSize),xt("max",e.maxSize),oe("ngModel",e.cutInHeight),Qt("disabled",e.isEditable?null:""),G(1),xt("min",e.minSize),xt("max",2*e.maxSize),oe("ngModel",e.cutInHeight),Qt("disabled",e.isEditable?null:""),G(6),oe("ngModel",e.objectFitType),Qt("disabled",e.cutInVideoId&&!e.cutInisSoundOnly||!e.isEditable?"":null),G(1),oe("value",0)("selected",0==e.objectFitType),G(2),oe("value",1)("selected",1==e.objectFitType),G(7),oe("ngModel",e.cutInSEIsLoop)("checked",e.cutInSEIsLoop)("value",!0),Qt("disabled",!e.isEditable||e.isPlaying?"":null),G(4),cr("name","",e.panelId,"-media")("id","",e.panelId,"-media-sound"),oe("ngModel",e.cutInIsVideo)("checked",!e.cutInIsVideo)("value",!1),Qt("disabled",!e.isEditable||e.isPlaying?"":null),G(1),cr("for","",e.panelId,"-media-sound"),G(3),ut("min-width",e.isValidAudio?10:5,"em")("max-width",e.isValidAudio?20:5,"em"),oe("ngModel",e.cutInAudioIdentifier)("ngClass",wt(134,OI,""==e.cutInAudioIdentifier)),Qt("disabled",e.cutInIsVideo||!e.isEditable||e.isPlaying?"":null),G(3),oe("ngForOf",e.audios),G(1),oe("ngIf",e.isEditable&&e.cutInAudioFileName.length>0),G(2),cr("name","",e.panelId,"-media")("id","",e.panelId,"-media-video"),oe("ngModel",e.cutInIsVideo)("checked",e.cutInIsVideo)("value",!0),Qt("disabled",!e.isEditable||e.isPlaying?"":null),G(1),cr("for","",e.panelId,"-media-video"),G(3),oe("ngModel",e.cutInVideoURL),Qt("disabled",e.cutInIsVideo&&e.isEditable&&!e.isPlaying?null:""),G(6),oe("ngIf",!e.isDeleted),G(1),oe("ngIf",e.isDeleted&&e.selectedCutInXml)}}function MQ(t,n){if(1&t){const e=ft();it(0),Q(1,"button",8),Ae("click",function(){return Re(e),Le(me(2).restore())}),ve(2,"\u5143\u306b\u623b\u3059"),ne(),rt()}}function kQ(t,n){if(1&t&&(it(0),Q(1,"div",87),ve(2," \u203b\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u3042\u308a\u307e\u305b\u3093\u3002 "),Te(3,MQ,3,0,"ng-container",9),ne(),rt()),2&t){const e=me();G(3),oe("ngIf",e.isDeleted&&e.selectedCutInXml)}}let DQ=(()=>{class t{constructor(e,i,r,o,s,a){this.changeDetector=e,this.pointerDeviceService=i,this.modalService=r,this.panelService=o,this.saveDataService=s,this.chatMessageService=a,this.minSize=0,this.maxSize=100,this.isShowHideImages=!1,this.selectedCutIn=null,this.selectedCutInXml="",this.sendTo="",this.isSaveing=!1,this.progresPercent=0}get cutIns(){return Os.instance.cutIns}get cutInName(){return this.selectedCutIn.name}set cutInName(e){this.isEditable&&(this.selectedCutIn.name=e)}get cutInTag(){return this.selectedCutIn.tag}set cutInTag(e){this.isEditable&&(this.selectedCutIn.tag=e)}get cutInDuration(){return this.selectedCutIn.duration}set cutInDuration(e){this.isEditable&&(this.selectedCutIn.duration=e)}get cutInCond(){return this.selectedCutIn.value+""}set cutInCond(e){this.isEditable&&(this.selectedCutIn.value=e)}get cutInIsPreventOutBounds(){return this.selectedCutIn.isPreventOutBounds}set cutInIsPreventOutBounds(e){this.isEditable&&(this.selectedCutIn.isPreventOutBounds=e)}get cutInWidth(){return this.selectedCutIn.width}set cutInWidth(e){this.isEditable&&(this.selectedCutIn.width=e)}get cutInHeight(){return this.selectedCutIn.height}set cutInHeight(e){this.isEditable&&(this.selectedCutIn.height=e)}get objectFitType(){return this.selectedCutIn.objectFitType}set objectFitType(e){this.isEditable&&(this.selectedCutIn.objectFitType=e)}get cutInPosX(){return this.selectedCutIn.posX}set cutInPosX(e){this.isEditable&&(this.selectedCutIn.posX=e)}get cutInPosY(){return this.selectedCutIn.posY}set cutInPosY(e){this.isEditable&&(this.selectedCutIn.posY=e)}get cutInZIndex(){return this.selectedCutIn.zIndex}set cutInZIndex(e){this.isEditable&&(this.selectedCutIn.zIndex=e)}get cutInIsFrontOfStand(){return this.selectedCutIn.isFrontOfStand}set cutInIsFrontOfStand(e){this.isEditable&&(this.selectedCutIn.isFrontOfStand=e)}get cutInAudioIdentifier(){return this.selectedCutIn.audioIdentifier}set cutInAudioIdentifier(e){this.isEditable&&(this.selectedCutIn.audioIdentifier=e)}get cutInAudioFileName(){return this.selectedCutIn.audioFileName}set cutInAudioFileName(e){this.isEditable&&(this.selectedCutIn.audioFileName=e)}get cutInSEIsLoop(){return this.selectedCutIn.isLoop}set cutInSEIsLoop(e){this.isEditable&&(this.selectedCutIn.isLoop=e)}get cutInType(){return this.selectedCutIn.animationType}set cutInType(e){this.isEditable&&(this.selectedCutIn.animationType=e)}get borderStyle(){return this.selectedCutIn.borderStyle}set borderStyle(e){this.isEditable&&(this.selectedCutIn.borderStyle=e)}get isEmpty(){return this.cutIns.length<1}get isDeleted(){return!!this.selectedCutIn&&null==Ct.instance.get(this.selectedCutIn.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}get cutInIsVideo(){return this.selectedCutIn.isVideoCutIn}set cutInIsVideo(e){this.isEditable&&(this.selectedCutIn.isVideoCutIn=e)}get cutInVideoURL(){return this.selectedCutIn.videoUrl}set cutInVideoURL(e){this.isEditable&&(this.selectedCutIn.videoUrl=e)}get cutInisSoundOnly(){return this.selectedCutIn.isSoundOnly}set cutInisSoundOnly(e){this.isEditable&&(this.selectedCutIn.isSoundOnly=e)}get cutInVideoId(){return this.selectedCutIn?this.selectedCutIn.videoId:""}get cutInPlayListId(){return this.cutInVideoId?this.selectedCutIn.playListId:""}get cutInImage(){return this.selectedCutIn&&Gt.instance.get(this.selectedCutIn.imageIdentifier)||on.Empty}get cutInImageUrl(){return this.selectedCutIn?!this.selectedCutIn.videoId||this.cutInisSoundOnly?this.cutInImage.url:`https://img.youtube.com/vi/${this.selectedCutIn.videoId}/hqdefault.jpg`:on.Empty.url}get isPlaying(){return!!this.selectedCutIn&&pg.nowShowingIdentifiers().includes(this.selectedCutIn.identifier)}get isValidAudio(){return!this.selectedCutIn||this.selectedCutIn.isValidAudio}get myPeer(){return Qe.myCursor}get otherPeers(){return Ct.instance.getObjects(Qe)}get myColor(){return Qe.myCursor&&Qe.myCursor.color&&Qe.myCursor.color!=Qe.CHAT_TRANSPARENT_COLOR?Qe.myCursor.color:Qe.CHAT_DEFAULT_COLOR}get sendToColor(){let e=Ct.instance.get(this.sendTo);return e instanceof Qe?e.color:Qe.CHAT_DEFAULT_COLOR}get audios(){return Xt.instance.audios.filter(e=>!e.isHidden)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30ab\u30c3\u30c8\u30a4\u30f3\u8a2d\u5b9a"),Ue.register(this).on("SYNCHRONIZE_AUDIO_LIST",-1e3,e=>{this.onAudioFileChange()}),this.panelId=bo.generateUuid()}ngAfterViewInit(){this.cutIns.length>0&&queueMicrotask(()=>{this.onChangeCutIn(this.cutIns[0].identifier),this.cutInSelecter.nativeElement.selectedIndex=0})}ngOnDestroy(){Ue.unregister(this)}onChangeCutIn(e){this.selectedCutIn=Ct.instance.get(e),this.selectedCutInXml=""}create(e="\u30ab\u30c3\u30c8\u30a4\u30f3"){return Os.instance.addCutIn(e)}add(){const e=this.create();e.imageIdentifier="stand_no_image",queueMicrotask(()=>{this.onChangeCutIn(e.identifier),this.cutInSelecter.nativeElement.value=e.identifier})}save(){var e=this;return(0,gn.Z)(function*(){if(!e.selectedCutIn||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i="fly_cutIn_"+e.selectedCutIn.name;yield e.saveDataService.saveGameObjectAsync(e.selectedCutIn,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}delete(){!this.selectedCutIn||(Ue.call("STOP_CUT_IN",{identifier:this.selectedCutIn.identifier}),this.isEmpty||(this.selectedCutInXml=this.selectedCutIn.toXml(),this.selectedCutIn.destroy()))}restore(){if(this.selectedCutIn&&this.selectedCutInXml){let e=gi.instance.parseXml(this.selectedCutInXml);Os.instance.addCutIn(e),this.selectedCutInXml="",queueMicrotask(()=>{const i=this.cutIns;this.onChangeCutIn(i[i.length-1].identifier),this.cutInSelecter.nativeElement.selectedIndex=i.length-1})}}getHidden(e){const i=Un.get(e.identifier);return!!i&&i.hide}upTabIndex(){if(!this.selectedCutIn)return;let e=this.selectedCutIn.parent,i=e.children.indexOf(this.selectedCutIn);0<i&&e.insertBefore(this.selectedCutIn,e.children[i-1])}downTabIndex(){if(!this.selectedCutIn)return;let e=this.selectedCutIn.parent,i=e.children.indexOf(this.selectedCutIn);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.selectedCutIn)}openModal(){if(this.isDeleted)return;let e=[];this.selectedCutIn&&this.selectedCutIn.imageIdentifier&&(e=[this.selectedCutIn.imageIdentifier]),this.modalService.open(aa,{currentImageIdentifires:e}).then(i=>{!this.selectedCutIn||!i||(this.selectedCutIn.imageIdentifier=i)})}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(pr,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:Li.OK_CANCEL,materialIcon:"visibility",action:()=>{this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}playCutIn(){const e=this.selectedCutIn;if(!e)return;const i={identifier:e.identifier,secret:!!this.sendTo,sender:Qe.myCursor.peerId};if(i.secret){const r=Ct.instance.get(this.sendTo);r&&(r.peerId!=Qe.myCursor.peerId&&Ue.call("PLAY_CUT_IN",i,r.peerId),Ue.call("PLAY_CUT_IN",i,Qe.myCursor.peerId))}else Ue.call("PLAY_CUT_IN",i),this.chatMessageService.sendOperationLog((""==e.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":e.name)+" \u3092\u518d\u751f\u3057\u305f")}stopCutIn(){if(!this.selectedCutIn)return;const e={identifier:this.selectedCutIn.identifier,secret:!!this.sendTo,sender:Qe.myCursor.peerId};if(e.secret){const i=Ct.instance.get(this.sendTo);i&&(i.peerId!=Qe.myCursor.peerId&&Ue.call("STOP_CUT_IN",e,i.peerId),Ue.call("STOP_CUT_IN",e,Qe.myCursor.peerId))}else Ue.call("STOP_CUT_IN",e)}testCutIn(){!this.selectedCutIn||queueMicrotask(()=>{Ue.trigger("PLAY_CUT_IN",{identifier:this.selectedCutIn.identifier,test:!0})})}onAudioFileChange(e=""){if(!e&&this.selectedCutIn&&(e=this.selectedCutIn.audioIdentifier),""==e)return void(this.cutInAudioFileName="");const i=Xt.instance.get(e);this.cutInAudioFileName=i?i.name:""}openYouTubeTerms(){return this.modalService.open(lo,{url:"https://www.youtube.com/terms",title:"YouTube \u5229\u7528\u898f\u7d04"}),!1}helpCutIn(){let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(Fu,{left:e.x,top:e.y,width:600,height:620});r.title="\u30ab\u30c3\u30c8\u30a4\u30f3\u30d8\u30eb\u30d7",r.text=`\u3000\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u540d\u524d\u3001\u8868\u793a\u6642\u9593\u3001\u4f4d\u7f6e\u3068\u5e45\u3068\u9ad8\u3055\uff08\u305d\u308c\u305e\u308c\u753b\u9762\u30b5\u30a4\u30ba\u306b\u5bfe\u3059\u308b\u76f8\u5bfe\u6307\u5b9a\uff09\u3001\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u306b\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u8868\u793a\u3055\u308c\u308b\u6761\u4ef6\u3092\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\u307e\u305f\u3001\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u5834\u5408\u304a\u3088\u3073\u300c\u898b\u5207\u308c\u9632\u6b62\u300d\u306b\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u305f\u5834\u5408\u3001\u753b\u9762\u5185\u306b\u53ce\u307e\u308b\u3088\u3046\u306b\u4f4d\u7f6e\u3068\u30b5\u30a4\u30ba\u304c\u8abf\u6574\u3055\u308c\u307e\u3059\u3002\n\u3000\n\u3000\u6a2a\u4f4d\u7f6e\uff08PosX\uff09\u3068\u7e26\u4f4d\u7f6e\uff08PosY\uff09\u306f\u3001\u753b\u9762\u306e\u5de6\u4e0a\u9685\u304b\u3089\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u4e2d\u5fc3\u4f4d\u7f6e\u307e\u3067\u306e\u8ddd\u96e2\u3068\u306a\u308a\u307e\u3059\u3002\u30b5\u30a4\u30ba\u306e\u5e45\uff08Width\uff09\u3068\u9ad8\u3055\uff08Height\uff09\u306e\u3069\u3061\u3089\u304b\u30920\u3068\u3057\u305f\u5834\u5408\u3001\u5143\u753b\u50cf\u306e\u7e26\u6a2a\u6bd4\u3092\u4fdd\u3063\u3066\u62e1\u5927\u7e2e\u5c0f\u3057\u307e\u3059\uff08\u305f\u3060\u3057\u3001\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u6700\u5c0f\u5e45\u3001\u9ad8\u3055\u306f${QT.MIN_SIZE}\u30d4\u30af\u30bb\u30eb\u3068\u306a\u308a\u307e\u3059\uff09\u3002\n\u3000\n\u3000\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u5fc5\u305a\u524d\u9762\u3001\u305d\u306e\u4ed6\u306f\u5f8c\u304b\u3089\u8868\u793a\u3055\u308c\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u753b\u50cf\u304c\u3088\u308a\u524d\u9762\u306b\u306a\u308a\u307e\u3059\u304c\u3001\u91cd\u306a\u308a\u9806\uff08Z-Index\uff09\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3067\u5236\u5fa1\u53ef\u80fd\u3067\u3059\u3002\u540c\u3058\u30ab\u30c3\u30c8\u30a4\u30f3\u3001\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u3001\u540c\u3058\u30bf\u30b0\u304c\u6307\u5b9a\u3055\u308c\u305f\u30ab\u30c3\u30c8\u30a4\u30f3\u3092\u518d\u751f\u3059\u308b\u5834\u5408\u306f\u3001\u4ee5\u524d\u306e\u3082\u306e\u306f\u505c\u6b62\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u6761\u4ef6\u3092\u6e80\u305f\u3059\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u8907\u6570\u3042\u308b\u5834\u5408\u3001\n\n\u3000\u3000\u30fb\u30bf\u30b0\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3082\u306e\u306f\u3059\u3079\u3066\n\u3000\u3000\u30fb\u30bf\u30b0\u304c\u8a2d\u5b9a\u3055\u308c\u305f\u3082\u306e\u306f\u3001\u540c\u3058\u30bf\u30b0\u306e\u3082\u306e\u306e\u4e2d\u304b\u3089\u30e9\u30f3\u30c0\u30e0\u306b1\u3064\n\u3000\u3000\u30fb\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u4e0a\u8a18\u306e\u4e2d\u304b\u3089\u30e9\u30f3\u30c0\u30e0\u306b1\u3064\u3092\u9078\u629e\n\n\u3068\u306a\u308a\u307e\u3059\u3002\n\n\u3000\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u30c9\u30e9\u30c3\u30b0\u306b\u3088\u3063\u3066\u79fb\u52d5\u53ef\u80fd\u3067\u3059\uff08\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u7aef\u3092\u30c9\u30e9\u30c3\u30b0\uff09\u3002\u307e\u305f\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af\u3067\u9589\u3058\u308b\uff08\u81ea\u5206\u3060\u3051\u505c\u6b62\uff09\u3001\u53f3\u30af\u30ea\u30c3\u30af\u3067\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u64cd\u4f5c\u304c\u53ef\u80fd\u3067\u3059\uff08\u300c\u9589\u3058\u308b\u300d\u300c\u30a6\u30a3\u30f3\u30c9\u30a6\u306e\u80cc\u9762\u306b\u8868\u793a\u300d\u300c\u6700\u5c0f\u5316\u300d\u304c\u53ef\u80fd\u3001\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u7aef\u3067\u53d7\u4ed8\uff09\u3002\n\n\u3000\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u3092\u30ab\u30c3\u30c8\u30a4\u30f3\u8868\u793a\u6642\u306e\u52b9\u679c\u97f3\u3068\u3057\u3066\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\u97f3\u91cf\u306b\u306f\u30b8\u30e5\u30fc\u30af\u30dc\u30c3\u30af\u30b9\u306e\u8a2d\u5b9a\uff08\u300c\u30c6\u30b9\u30c8 (\u81ea\u5206\u3060\u3051\u898b\u308b)\u300d\u306e\u5834\u5408\u306f\u8a66\u8074\u97f3\u91cf\uff09\u304c\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002\u8868\u793a\u6642\u9593\u3084\u624b\u52d5\u64cd\u4f5c\u306b\u3088\u3063\u3066\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u505c\u6b62\u3057\u305f\u969b\u306b\u306f\u3001\u9014\u4e2d\u3067\u3042\u3063\u3066\u3082\u97f3\u58f0\u3082\u505c\u6b62\u3057\u307e\u3059\u3002\u30ab\u30c3\u30c8\u30a4\u30f3\u3084\u90e8\u5c4b\u306e\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u306b\u306f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u542b\u307e\u308c\u307e\u305b\u3093\u306e\u3067\u3001\u5fc5\u8981\u3067\u3057\u305f\u3089\u5225\u9014\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u304f\u3060\u3055\u3044\uff08\u30ab\u30c3\u30c8\u30a4\u30f3\u3068\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306e\u30ea\u30f3\u30af\u306f\u30d5\u30a1\u30a4\u30eb\u306e\u5185\u5bb9\u306b\u3088\u308a\u307e\u3059\u3001\u540c\u540d\u306e\u5225\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u3082\u518d\u30ea\u30f3\u30af\u3055\u308c\u307e\u305b\u3093\uff09\u3002\n\n\u3000\u30ab\u30c3\u30c8\u30a4\u30f3\u306b\u52d5\u753b\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u3001URL\u306f\u73fe\u5728YouTube\u306e\u3082\u306e\u306e\u307f\u6709\u52b9\u3067\u3059\u3002\u52d5\u753b\u3092\u5229\u7528\u3059\u308b\u969b\u306f\u6a29\u5229\u8005\u304a\u3088\u3073YouTube\u306e\u5b9a\u3081\u305f\u5229\u7528\u898f\u7d04\u3092\u53c2\u7167\u3057\u3001\u9806\u5b88\u3057\u3066\u304f\u3060\u3055\u3044\u3002`}}return t.\u0275fac=function(e){return new(e||t)(He(Ki),He(Ci),He(Yn),He(qn),He(Gr),He(Hr))},t.\u0275cmp=fn({type:t,selectors:[["app-cut-in-setting"]],viewQuery:function(e,i){if(1&e&&wn(cQ,5),2&e){let r;Cn(r=xn())&&(i.cutInSelecter=r.first)}},decls:14,vars:3,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[2,"font-size","smaller","margin-bottom","3px",3,"click"],["size","15",2,"width","12em",3,"change"],["cutInSelecter",""],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[2,"float","right","margin-top","3px","margin-right","3px"],[3,"click"],[4,"ngIf"],[3,"value","title"],[2,"display","flex"],[2,"position","relative","overflow","hidden",3,"dblclick"],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["style","position: absolute; top: 1px; left: -1px; z-index: 5",4,"ngIf"],["class","grow","style","opacity: 0.8; position: absolute; bottom: 1px; right: -1px; z-index: 5",4,"ngIf"],[2,"width","160px","height","160px","object-fit","contain",3,"ngClass","src"],[2,"display","flex","flex-direction","column","width","100%"],[2,"padding-bottom","2px"],[2,"float","right"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[2,"padding-left","2px"],[2,"font-size","smaller"],["type","text","placeholder","Name",2,"width","8em",3,"ngModel","ngModelChange"],[2,"font-size","smaller","margin-left","1em"],["type","text","placeholder","Tag",2,"width","3em",3,"ngModel","ngModelChange"],[2,"padding-left","2px","padding-top","2px"],["type","number","min","0","max","1000",2,"width","3.5em",3,"ngModel","ngModelChange"],[2,"font-size","smaller","padding-left","2px"],[2,"min-width","8em",3,"ngModel","ngModelChange"],[3,"value","selected"],[2,"margin-left","1em","font-size","smaller"],["name","borderStyle","type","checkbox",3,"checked","click"],["placeholder","1\u884c\u306b\u4e00\u3064\u3001\u5192\u982d@\u3067\u30de\u30c3\u30c1\u6642\u306b\u30c6\u30ad\u30b9\u30c8\u304b\u3089\u5207\u308a\u53d6\u308a\r\n@\u8857\u4e26\u307f",2,"width","100%","height","3em",3,"ngModel","ngModelChange"],[2,"font-size","smaller","display","flex","flex-direction","column","width","100%"],[1,"self-only"],[2,"margin-left","2em"],[2,"margin-right","0px",3,"click"],[1,"material-icons",2,"font-size","smaller"],[2,"margin-left","0px",3,"click"],[2,"white-space","nowrap"],[2,"max-width","10em",3,"ngModel","ngClass","ngStyle","ngModelChange"],["value","",1,"not-specified"],["style","font-weight: bolder;",3,"value","color",4,"ngFor","ngForOf"],[1,"section"],[1,"header"],[2,"margin-left","0.6em"],["name","cutInIsPreventOutBounds","type","checkbox",3,"ngModel","checked","value","ngModelChange"],[2,"padding-left","1em"],["type","range","name","cutInPosX",2,"width","180px",3,"ngModel","title","min","max","ngModelChange"],["type","number",2,"width","3.5em",3,"ngModel","min","max","ngModelChange"],["type","range","name","cutInPosY",2,"width","180px",3,"ngModel","title","min","max","ngModelChange"],["name","cutInIsFrontOfStand","type","checkbox",3,"ngModel","checked","value","ngModelChange"],["type","range","name","cutInWidth",2,"width","180px",3,"ngModel","title","min","max","ngModelChange"],["type","range","name","cutIHeight",2,"width","180px",3,"ngModel","title","min","max","ngModelChange"],[3,"ngModel","ngModelChange"],["name","cutInSEIsLoop","type","checkbox",3,"ngModel","checked","value","ngModelChange"],["type","radio",3,"name","id","ngModel","checked","value","ngModelChange"],[3,"for"],[3,"ngModel","ngClass","ngModelChange","change"],["style","color: black",3,"value",4,"ngFor","ngForOf"],["type","text",2,"width","24em",3,"ngModel","ngModelChange"],[2,"padding-left","2.5em"],["href","https://www.youtube.com/terms","target","_blank",1,"outer-link",3,"click"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons",2,"margin-right","2px","font-size","16px","display","block"],[2,"position","absolute","top","1px","left","-1px","z-index","5"],[3,"click",4,"ngIf"],[1,"grow",2,"opacity","0.8","position","absolute","bottom","1px","right","-1px","z-index","5"],[1,"material-icons",2,"font-size","32px"],[2,"font-weight","bolder",3,"value"],[2,"color","black",3,"value"],["style","margin-left: 0.6em",4,"ngIf"],["style","margin-left: 0.6em; color: red; display:inline-block; white-space: nowrap; max-width: 20em; overflow: hidden; text-overflow: ellipsis",4,"ngIf"],[1,"material-icons",2,"font-size","14px"],[2,"color","blue"],[2,"margin-left","0.6em","color","red","display","inline-block","white-space","nowrap","max-width","20em","overflow","hidden","text-overflow","ellipsis"],[1,"material-icons"],[2,"font-weight","bolder"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,i){1&e&&(Q(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Ae("click",function(){return i.add()}),ve(4,"\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u8ffd\u52a0"),ne()(),Q(5,"select",3,4),Ae("change",function(o){return i.onChangeCutIn(o.target.value)}),Te(7,uQ,2,5,"option",5),ne()(),Q(8,"div",6)(9,"div",7)(10,"button",8),Ae("click",function(){return i.helpCutIn()}),ve(11,"?"),ne()(),Te(12,IQ,163,136,"ng-container",9),ne()(),Te(13,kQ,4,1,"ng-container",9)),2&e&&(G(7),oe("ngForOf",i.cutIns),G(5),oe("ngIf",!i.isEmpty&&i.selectedCutIn),G(1),oe("ngIf",i.isEmpty))},dependencies:[si,_i,Bn,fr,oo,so,Ii,Fo,Ro,Oo,$o,ol,Mi,Ys,Ks,yi,$i],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.header[_ngcontent-%COMP%]{margin-top:3px}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.blackout[_ngcontent-%COMP%]{filter:blur(12px) grayscale(70%)}.self-only[_ngcontent-%COMP%]{color:red}img[_ngcontent-%COMP%]{transition:all .1s 0s ease}.self-setting[_ngcontent-%COMP%]{font-weight:bolder;font-size:smaller}input[type=number][_ngcontent-%COMP%]{text-align:right}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.not-specified[_ngcontent-%COMP%]{color:gray}.self-only[_ngcontent-%COMP%]{color:red;vertical-align:text-top}.section[_ngcontent-%COMP%]{margin-top:.4em}"]}),t})();function FI(t){return new F(n=>{br(t()).subscribe(n)})}const PQ=["addListener","removeListener"],NQ=["addEventListener","removeEventListener"],OQ=["on","off"];function Fg(t,n,e,i){if(d(e)&&(i=e,e=void 0),i)return Fg(t,n,e).pipe(tf(i));const[r,o]=function LQ(t){return d(t.addEventListener)&&d(t.removeEventListener)}(t)?NQ.map(s=>a=>t[s](n,a,e)):function FQ(t){return d(t.addListener)&&d(t.removeListener)}(t)?PQ.map(RI(t,n)):function RQ(t){return d(t.on)&&d(t.off)}(t)?OQ.map(RI(t,n)):[];if(!r&&or(t))return Ls(s=>Fg(s,n,e))(br(t));if(!r)throw new TypeError("Invalid event target");return new F(s=>{const a=(...h)=>s.next(1<h.length?h:h[0]);return r(a),()=>o(a)})}function RI(t,n){return e=>i=>t[e](n,i)}const El=new F(N);class BQ extends w{constructor(n,e){super()}schedule(n,e=0){return this}}const Rg={setInterval(t,n,...e){const{delegate:i}=Rg;return i?.setInterval?i.setInterval(t,n,...e):setInterval(t,n,...e)},clearInterval(t){const{delegate:n}=Rg;return(n?.clearInterval||clearInterval)(t)},delegate:void 0},LI={now:()=>(LI.delegate||Date).now(),delegate:void 0};class Vf{constructor(n,e=Vf.now){this.schedulerActionCtor=n,this.now=e}schedule(n,e=0,i){return new this.schedulerActionCtor(this,n).schedule(i,e)}}Vf.now=LI.now;const BI=new class jQ extends Vf{constructor(n,e=Vf.now){super(n,e),this.actions=[],this._active=!1}flush(n){const{actions:e}=this;if(this._active)return void e.push(n);let i;this._active=!0;do{if(i=n.execute(n.state,n.delay))break}while(n=e.shift());if(this._active=!1,i){for(;n=e.shift();)n.unsubscribe();throw i}}}(class zQ extends BQ{constructor(n,e){super(n,e),this.scheduler=n,this.work=e,this.pending=!1}schedule(n,e=0){var i;if(this.closed)return this;this.state=n;const r=this.id,o=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(o,r,e)),this.pending=!0,this.delay=e,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(o,this.id,e),this}requestAsyncId(n,e,i=0){return Rg.setInterval(n.flush.bind(n,this),i)}recycleAsyncId(n,e,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return e;null!=e&&Rg.clearInterval(e)}execute(n,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(n,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,e){let r,i=!1;try{this.work(n)}catch(o){i=!0,r=o||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:n,scheduler:e}=this,{actions:i}=e;this.work=this.state=this.scheduler=null,this.pending=!1,_(i,this),null!=n&&(this.id=this.recycleAsyncId(e,n,null)),this.delay=null,super.unsubscribe()}}}),UQ=BI;function zI(t,n){return n?e=>fg(n.pipe(ra(1),function HQ(){return C((t,n)=>{t.subscribe($(n,N))})}()),e.pipe(zI(t))):Ls((e,i)=>t(e,i).pipe(ra(1),function VQ(t){return se(()=>t)}(e)))}const Gf="Service workers are disabled or not supported by this browser";class Lg{constructor(n){if(this.serviceWorker=n,n){const i=Fg(n,"controllerchange").pipe(se(()=>n.controller)),o=fg(FI(()=>$l(n.controller)),i);this.worker=o.pipe(mc(ee=>!!ee)),this.registration=this.worker.pipe(Af(()=>n.getRegistration()));const b=Fg(n,"message").pipe(se(ee=>ee.data)).pipe(mc(ee=>ee&&ee.type)).pipe(VT());b.connect(),this.events=b}else this.worker=this.events=this.registration=function KQ(t){return FI(()=>function AQ(t,n){const e=d(t)?t:()=>t,i=r=>r.error(e());return new F(n?r=>n.schedule(i,0,r):i)}(new Error(t)))}(Gf)}postMessage(n,e){return this.worker.pipe(ra(1),UT(i=>{i.postMessage({action:n,...e})})).toPromise().then(()=>{})}postMessageWithOperation(n,e,i){const r=this.waitForOperationCompleted(i),o=this.postMessage(n,e);return Promise.all([o,r]).then(([,s])=>s)}generateNonce(){return Math.round(1e7*Math.random())}eventsOfType(n){let e;return e="string"==typeof n?i=>i.type===n:i=>n.includes(i.type),this.events.pipe(mc(e))}nextEventOfType(n){return this.eventsOfType(n).pipe(ra(1))}waitForOperationCompleted(n){return this.eventsOfType("OPERATION_COMPLETED").pipe(mc(e=>e.nonce===n),ra(1),se(e=>{if(void 0!==e.result)return e.result;throw new Error(e.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}}let YQ=(()=>{class t{constructor(e){if(this.sw=e,this.subscriptionChanges=new u,!e.isEnabled)return this.messages=El,this.notificationClicks=El,void(this.subscription=El);this.messages=this.sw.eventsOfType("PUSH").pipe(se(r=>r.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(se(r=>r.data)),this.pushManager=this.sw.registration.pipe(se(r=>r.pushManager));const i=this.pushManager.pipe(Af(r=>r.getSubscription()));this.subscription=ga(i,this.subscriptionChanges)}get isEnabled(){return this.sw.isEnabled}requestSubscription(e){if(!this.sw.isEnabled)return Promise.reject(new Error(Gf));const i={userVisibleOnly:!0};let r=this.decodeBase64(e.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),o=new Uint8Array(new ArrayBuffer(r.length));for(let s=0;s<r.length;s++)o[s]=r.charCodeAt(s);return i.applicationServerKey=o,this.pushManager.pipe(Af(s=>s.subscribe(i)),ra(1)).toPromise().then(s=>(this.subscriptionChanges.next(s),s))}unsubscribe(){return this.sw.isEnabled?this.subscription.pipe(ra(1),Af(i=>{if(null===i)throw new Error("Not subscribed to push notifications.");return i.unsubscribe().then(r=>{if(!r)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})})).toPromise():Promise.reject(new Error(Gf))}decodeBase64(e){return atob(e)}}return t.\u0275fac=function(e){return new(e||t)(pn(Lg))},t.\u0275prov=$n({token:t,factory:t.\u0275fac}),t})(),jI=(()=>{class t{constructor(e){if(this.sw=e,!e.isEnabled)return this.versionUpdates=El,this.available=El,this.activated=El,void(this.unrecoverable=El);this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.available=this.versionUpdates.pipe(mc(i=>"VERSION_READY"===i.type),se(i=>({type:"UPDATE_AVAILABLE",current:i.currentVersion,available:i.latestVersion}))),this.activated=this.sw.eventsOfType("UPDATE_ACTIVATED"),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}get isEnabled(){return this.sw.isEnabled}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(Gf));const e=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:e},e)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(Gf));const e=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:e},e)}}return t.\u0275fac=function(e){return new(e||t)(pn(Lg))},t.\u0275prov=$n({token:t,factory:t.\u0275fac}),t})();class Uv{}const UI=new An("NGSW_REGISTER_SCRIPT");function ZQ(t,n,e,i){return()=>{if(!M$(i)||!("serviceWorker"in navigator)||!1===e.enabled)return;let r;if(navigator.serviceWorker.addEventListener("controllerchange",()=>{null!==navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({action:"INITIALIZE"})}),"function"==typeof e.registrationStrategy)r=e.registrationStrategy();else{const[s,...a]=(e.registrationStrategy||"registerWhenStable:30000").split(":");switch(s){case"registerImmediately":r=$l(null);break;case"registerWithDelay":r=HI(+a[0]||0);break;case"registerWhenStable":r=a[0]?ga(VI(t),HI(+a[0])):VI(t);break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${e.registrationStrategy}`)}}t.get(Nn).runOutsideAngular(()=>r.pipe(ra(1)).subscribe(()=>navigator.serviceWorker.register(n,{scope:e.scope}).catch(s=>console.error("Service worker registration failed with:",s))))}}function HI(t){return $l(null).pipe(function WQ(t,n=BI){const e=function qQ(t=0,n,e=UQ){let i=-1;return null!=n&&(qo(n)?e=n:i=n),new F(r=>{let o=function GQ(t){return t instanceof Date&&!isNaN(t)}(t)?+t-e.now():t;o<0&&(o=0);let s=0;return e.schedule(function(){r.closed||(r.next(s++),0<=i?this.schedule(void 0,i):r.complete())},o)})}(t,n);return zI(()=>e)}(t))}function VI(t){return t.get(Gd).isStable.pipe(mc(e=>e))}function XQ(t,n){return new Lg(M$(n)&&!1!==t.enabled?navigator.serviceWorker:void 0)}let QQ=(()=>{class t{static register(e,i={}){return{ngModule:t,providers:[{provide:UI,useValue:e},{provide:Uv,useValue:i},{provide:Lg,useFactory:XQ,deps:[Uv,Vd]},{provide:n$,useFactory:ZQ,deps:[xs,UI,Uv,Vd],multi:!0}]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zo({type:t}),t.\u0275inj=Eo({providers:[YQ,jI]}),t})();class JQ{constructor(n){this.canvasElement=n}makeBrush(n,e,i){n.strokeStyle=i,n.fillStyle=n.strokeStyle,n.lineWidth=1;let r=Math.floor(e/5);return n.font=`bold ${r}px sans-serif`,n.textBaseline="top",n.textAlign="center",n}render(n,e,i=50,r=fs.SQUARE,o="#000000e6",s=!0){this.canvasElement.width=n*i,this.canvasElement.height=e*i;let a=this.canvasElement.getContext("2d");if(r<0)return;let h=this.generateCalcGridPositionFunc(r);this.makeBrush(a,i,o);for(let b=0;b<=e;b++)for(let ee=0;ee<=n;ee++){let{gx:de,gy:ge}=h(ee,b,i);this.strokeSquare(a,de,ge,i),s&&a.fillText((ee+1).toString()+"-"+(b+1).toString(),de+i/2,ge+i/2)}}generateCalcGridPositionFunc(n){switch(n){case fs.HEX_VERTICAL:return(e,i,r)=>e%2==1?{gx:e*r,gy:i*r}:{gx:e*r,gy:i*r+r/2};case fs.HEX_HORIZONTAL:return(e,i,r)=>i%2==1?{gx:e*r,gy:i*r}:{gx:e*r+r/2,gy:i*r};default:return(e,i,r)=>({gx:e*r,gy:i*r})}}strokeSquare(n,e,i,r){n.beginPath(),n.strokeRect(e,i,r,r)}strokeHex(n,e,i,r,o){let s=o===fs.HEX_HORIZONTAL?-30:0,a=r/Math.sqrt(3),h=e+r/2,b=i+r/2;n.beginPath();for(let ee=0;ee<6;ee++){s+=60;let de=Math.PI/180*s,ge=Math.cos(de)*a+h,xe=Math.sin(de)*a+b;n.lineTo(ge,xe)}n.closePath(),n.stroke()}}var Ec=(()=>(function(t){t.DRAG="drag",t.ZOOM="zoom",t.ROTATE="rotate",t.KEYBOARD="keyboard"}(Ec||(Ec={})),Ec))(),gs=(()=>(function(t){t.ArrowLeft="ArrowLeft",t.ArrowUp="ArrowUp",t.ArrowRight="ArrowRight",t.ArrowDown="ArrowDown"}(gs||(gs={})),gs))();class eJ{constructor(n){this.targetElement=n,this.currentPositionX=0,this.currentPositionY=0,this.buttonCode=0,this.input=null,this.callbackOnWheel=e=>this.onWheel(e),this.callbackOnKeydown=e=>this.onKeydown(e),this.onstart=null,this.onend=null,this.ontransform=null,this.initialize()}get isGrabbing(){return this.input.isGrabbing}get isDragging(){return this.input.isDragging}initialize(){this.input=new ls(this.targetElement,{capture:!0}),this.addEventListeners(),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this)}cancel(){this.input.cancel()}destroy(){this.input.destroy(),this.removeEventListeners()}onInputStart(n){this.currentPositionX=this.input.pointer.x,this.currentPositionY=this.input.pointer.y,this.buttonCode=n.button,this.onstart&&this.onstart(n)}onInputEnd(n){this.onend&&this.onend(n)}onInputMove(n){let e=this.input.pointer.x,i=this.input.pointer.y,r=e-this.currentPositionX,o=i-this.currentPositionY,s=0,a=0,b=0,de=0,ge=Ec.DRAG;2===this.buttonCode?(ge=Ec.ROTATE,de=-r/5,b=-o/5):(s=r,a=o),this.currentPositionX=e,this.currentPositionY=i,this.ontransform&&this.ontransform(s,a,0,b,0,de,ge,n)}onWheel(n){let e=0;switch(n.deltaMode){case WheelEvent.DOM_DELTA_LINE:e=16*n.deltaY;break;case WheelEvent.DOM_DELTA_PAGE:e=n.deltaY*window.innerHeight;break;default:e=n.deltaY}let o=0;o=-1.5*e,9e4<o**2&&(o=Math.min(Math.max(o,-300),300)),this.ontransform&&this.ontransform(0,0,o,0,0,0,Ec.ZOOM,n)}onKeydown(n){let e=0,i=0,r=0,o=0,a=0,h=this.getKeyName(n);switch(h){case gs.ArrowLeft:n.shiftKey?a=-2:e=10;break;case gs.ArrowUp:n.shiftKey?o=-2:n.ctrlKey?r=150:i=10;break;case gs.ArrowRight:n.shiftKey?a=2:e=-10;break;case gs.ArrowDown:n.shiftKey?o=2:n.ctrlKey?r=-150:i=-10}null!=gs[h]&&this.ontransform&&this.ontransform(e,i,r,o,0,a,Ec.KEYBOARD,n)}getKeyName(n){if(n.key)return n.key;switch(n.keyCode){case 37:return gs.ArrowLeft;case 38:return gs.ArrowUp;case 39:return gs.ArrowRight;case 40:return gs.ArrowDown;default:return""}}addEventListeners(){this.targetElement.addEventListener("wheel",this.callbackOnWheel,!1),document.body.addEventListener("keydown",this.callbackOnKeydown,!1)}removeEventListeners(){this.targetElement.removeEventListener("wheel",this.callbackOnWheel,!1),document.body.removeEventListener("keydown",this.callbackOnKeydown,!1)}}var Tl=(()=>(function(t){t.PAN="pan",t.TAP_PINCH="tappinch",t.PINCH="pinch",t.ROTATE="rotate"}(Tl||(Tl={})),Tl))();class tJ{constructor(n,e){this.targetElement=n,this.ngZone=e,this.hammer=null,this.deltaHammerDeltaX=0,this.deltaHammerDeltaY=1,this.deltaHammerScale=1,this.deltaHammerRotation=0,this.prevHammerDeltaX=0,this.prevHammerDeltaY=0,this.prevHammerScale=0,this.prevHammerRotation=0,this.tappedPanTimer=null,this.tappedPanCenter={x:0,y:0},this.onstart=null,this.onend=null,this.ongesture=null,this.ontransform=null,this.initializeHammer()}destroy(){this.clearTappedPanTimer(),this.hammer.destroy()}initializeHammer(){this.hammer=new Hammer.Manager(this.targetElement,{inputClass:Hammer.TouchInput});let n=new Hammer.Tap,e=new Hammer.Pan({event:"pan1p",pointers:1,threshold:0}),i=new Hammer.Pan({event:"pan2p",pointers:2,threshold:0}),r=new Hammer.Pinch,o=new Hammer.Rotate;e.recognizeWith(i),e.recognizeWith(o),e.recognizeWith(r),i.recognizeWith(r),i.recognizeWith(o),r.recognizeWith(o),this.hammer.add([n,e,i,r,o]),this.hammer.on("hammer.input",this.onHammer.bind(this)),this.hammer.on("tap",this.onTap.bind(this)),this.hammer.on("pan1pstart",this.onTappedPanStart.bind(this)),this.hammer.on("pan1pmove",this.onTappedPanMove.bind(this)),this.hammer.on("pan1pend",this.onTappedPanEnd.bind(this)),this.hammer.on("pan1pcancel",this.onTappedPanEnd.bind(this)),this.hammer.on("pan2pmove",this.onPanMove.bind(this)),this.hammer.on("pinchmove",this.onPinchMove.bind(this)),this.hammer.on("rotatemove",this.onRotateMove.bind(this));let s=window.navigator.userAgent.toLowerCase();(s.indexOf("iphone")>-1||s.indexOf("ipad")>-1||s.indexOf("macintosh")>-1&&"ontouchend"in document)&&(this.hammer.add(new Hammer.Press({time:251})),this.hammer.on("press",h=>{let b=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,clientX:h.center.x,clientY:h.center.y});this.ngZone.run(()=>h.srcEvent.target.dispatchEvent(b))}))}onHammer(n){n.isFirst?(this.deltaHammerScale=n.scale,this.deltaHammerRotation=n.rotation,this.deltaHammerDeltaX=n.deltaX,this.deltaHammerDeltaY=n.deltaY,this.onstart&&this.onstart(n.srcEvent)):n.isFinal?this.onend&&this.onend(n.srcEvent):(this.deltaHammerScale=n.scale-this.prevHammerScale,this.deltaHammerRotation=n.rotation-this.prevHammerRotation,this.deltaHammerDeltaX=n.deltaX-this.prevHammerDeltaX,this.deltaHammerDeltaY=n.deltaY-this.prevHammerDeltaY),this.prevHammerScale=n.scale,this.prevHammerRotation=n.rotation,this.prevHammerDeltaX=n.deltaX,this.prevHammerDeltaY=n.deltaY,null!=this.tappedPanTimer&&n.eventType==Hammer.INPUT_START&&2500<(this.tappedPanCenter.x-n.center.x)**2+(this.tappedPanCenter.y-n.center.y)**2&&this.clearTappedPanTimer()}onTap(n){this.tappedPanCenter=n.center,this.tappedPanTimer=setTimeout(()=>{this.tappedPanTimer=null},400),this.ongesture&&this.ongesture(n.srcEvent)}onTappedPanStart(n){null!=this.tappedPanTimer&&(this.clearTappedPanTimer(!1),this.ongesture&&this.ongesture(n.srcEvent))}onTappedPanEnd(n){this.clearTappedPanTimer()}onTappedPanMove(n){if(null==this.tappedPanTimer){let e=this.deltaHammerDeltaX,i=this.deltaHammerDeltaY,r=0;this.ontransform&&this.ontransform(e,i,r,0,0,0,Tl.PAN,n.srcEvent)}else{this.clearTappedPanTimer(!1);let i=7.5*this.deltaHammerDeltaY;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,i,0,0,0,Tl.TAP_PINCH,n.srcEvent)}}onPanMove(n){this.clearTappedPanTimer();let e=-this.deltaHammerDeltaY/window.innerHeight*100;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,0,e,0,0,Tl.ROTATE,n.srcEvent)}onPinchMove(n){this.clearTappedPanTimer();let e=500*this.deltaHammerScale;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,e,0,0,0,Tl.PINCH,n.srcEvent)}onRotateMove(n){this.clearTappedPanTimer();let e=this.deltaHammerRotation;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,0,0,0,e,Tl.ROTATE,n.srcEvent)}clearTappedPanTimer(n=!0){clearTimeout(this.tappedPanTimer),n&&(this.tappedPanTimer=null)}}let Bg=(()=>{class t{constructor(){}createGameCharacter(e){let i=sn.create("\u65b0\u3057\u3044\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",1,"");return i.location.x=e.x-25,i.location.y=e.y-25,i.posZ=e.z,i}createGameTableMask(e){let i=this.getViewTable();if(!i)return;let r=yo.create("\u30de\u30c3\u30d7\u30de\u30b9\u30af",5,5,100);return r.location.x=e.x-25,r.location.y=e.y-25,r.posZ=e.z,i.appendChild(r),r}createTerrain(e){let i="./assets/images/tex.jpg",r=Gt.instance.get(i);r||(r=Gt.instance.add(i),Un.create(r.identifier).tag="*default \u5730\u5f62");let o=this.getViewTable();if(!o)return;let s=Er.create("\u5730\u5f62",2,2,2,r.identifier,r.identifier);return s.location.x=e.x-50,s.location.y=e.y-50,s.posZ=e.z,o.appendChild(s),s}createTextNote(e){let i=Vr.create("\u5171\u6709\u30e1\u30e2","\u30c6\u30ad\u30b9\u30c8\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044",5,4,3);return i.location.x=e.x,i.location.y=e.y,i.posZ=e.z,i}createDiceSymbol(e,i,r,o){let s=xr.create(i,r,1),a=null;return s.nothingFaces.forEach(h=>{let b=`./assets/images/dice/${o}/${o}[0].png`;a=Gt.instance.get(b),a||(a=Gt.instance.add(b),Un.create(a.identifier).tag="*default "+(r===qi.D2?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")),s.imageDataElement.getFirstElementByName(h).value=a.identifier}),s.faces.forEach(h=>{let b=`./assets/images/dice/${o}/${o}[${h}].png`;a=Gt.instance.get(b),a||(a=Gt.instance.add(b),Un.create(a.identifier).tag="*default "+(r===qi.D2?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")),s.imageDataElement.getFirstElementByName(h).value=a.identifier}),s.location.x=e.x-25,s.location.y=e.y-25,s.posZ=e.z,s}createBlankCard(e){const i="./assets/images/trump/blank_card.png",r="./assets/images/trump/z01.gif";let o,s;o=Gt.instance.get(i),o||(o=Gt.instance.add(i),Un.create(o.identifier).tag="*default \u30ab\u30fc\u30c9"),s=Gt.instance.get(r),s||(s=Gt.instance.add(r),Un.create(s.identifier).tag="*default \u30ab\u30fc\u30c9");let a=Qn.create("\u30ab\u30fc\u30c9",o.identifier,s.identifier);return a.location.x=e.x-25,a.location.y=e.y-25,a.posZ=e.z,a}cardName(e){let i="";const r=e.slice(0,1),o=parseInt(e.substring(1,3));switch(r){case"c":i="\u30af\u30e9\u30d6";break;case"d":i="\u30c0\u30a4\u30e4";break;case"h":i="\u30cf\u30fc\u30c8";break;case"s":i="\u30b9\u30da\u30fc\u30c9";break;case"x":i="\u30b8\u30e7\u30fc\u30ab\u30fc"}return i+="x"==r?`\uff08${1==o?"\u8d64":"\u9ed2"}\uff09`:`\u306e${1==o?"\u30a8\u30fc\u30b9":o>=11?["\u30b8\u30e3\u30c3\u30af","\u30af\u30a4\u30fc\u30f3","\u30ad\u30f3\u30b0"][o-11]:o}`,i}createTrump(e){let i=ai.create("\u30c8\u30e9\u30f3\u30d7\u5c71\u672d");i.location.x=e.x-25,i.location.y=e.y-25,i.posZ=e.z;let r="./assets/images/trump/z02.gif";if(!Gt.instance.get(r)){const a=Gt.instance.add(r);Un.create(a.identifier).tag="*default \u30ab\u30fc\u30c9"}let o=["c","d","h","s"],s=[];for(let a of o)for(let h=1;h<=13;h++)s.push(a+("00"+h).slice(-2));s.push("x01"),s.push("x02");for(let a of s){let h="./assets/images/trump/"+a+".gif";if(!Gt.instance.get(h)){const ee=Gt.instance.add(h);Un.create(ee.identifier).tag="*default \u30ab\u30fc\u30c9"}let b=Qn.create(this.cardName(a),h,r);i.putOnBottom(b)}return i}createRangeArea(e,i){let r;switch(i){case"LINE":r=vi.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u76f4\u7dda)",1,6,100);break;case"CIRCLE":r=vi.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u5186)",3,3,100);break;case"SQUARE":r=vi.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u6b63\u65b9\u5f62)",3,3,100);break;case"DIAMOND":r=vi.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u30c0\u30a4\u30e4)",3,3,100);break;default:r=vi.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u9310\u5f62)",6,6,100)}return r.location.x=e.x,r.location.y=e.y,r.posZ=e.z,r.type=i,r.commonDataElement.getFirstElementByName("opacity").currentValue=60,r}makeDefaultTable(){let e=new ir("gameTable"),i=null,r=on.createEmpty("testTableBackgroundImage_image").toContext();r.url="./assets/images/BG10a_80.jpg",i=Gt.instance.add(r),Un.create(i.identifier).tag="*default \u30c6\u30fc\u30d6\u30eb",e.name="\u6700\u521d\u306e\u30c6\u30fc\u30d6\u30eb",e.imageIdentifier=i.identifier,e.width=20,e.height=15,e.initialize(),Tr.instance.viewTableIdentifier=e.identifier}makeDefaultTabletopObjects(){let e=null,i=null,r=null;e=new sn("testCharacter_1"),r=on.createEmpty("testCharacter_1_image").toContext(),r.url="./assets/images/mon_052.gif",i=Gt.instance.add(r),Un.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=250,e.location.y=450,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcA",1,i.identifier),e=new sn("testCharacter_2"),e.location.x=400,e.location.y=400,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcB",1,i.identifier),e=new sn("testCharacter_3"),r=on.createEmpty("testCharacter_3_image").toContext(),r.url="./assets/images/mon_128.gif",i=Gt.instance.add(r),Un.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=200,e.location.y=100,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcC",3,i.identifier),e=new sn("testCharacter_4"),r=on.createEmpty("testCharacter_4_image").toContext(),r.url="./assets/images/mon_150.gif",i=Gt.instance.add(r),Un.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=300,e.location.y=550,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcA",1,i.identifier),e=new sn("testCharacter_5"),r=on.createEmpty("testCharacter_5_image").toContext(),r.url="./assets/images/mon_211.gif",i=Gt.instance.add(r),Un.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=600,e.location.y=600,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcB",1,i.identifier),e=new sn("testCharacter_6"),r=on.createEmpty("testCharacter_6_image").toContext(),r.url="./assets/images/mon_135.gif",i=Gt.instance.add(r),Un.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.initialize(),e.location.x=250,e.location.y=650,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcC",1,i.identifier)}makeDefaultContextMenuActions(e){return[this.getCreateCharacterMenu(e),this.getCreateTableMaskMenu(e),this.getCreateTerrainMenu(e),this.getCreateTextNoteMenu(e),this.getCreateBlankCardMenu(e),this.getCreateTrumpMenu(e),this.getCreateDiceSymbolMenu(e),this.getCreateRangeMenu(e)]}getCreateCharacterMenu(e){return{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u4f5c\u6210",action:()=>{let i=this.createGameCharacter(e);Ue.trigger("SELECT_TABLETOP_OBJECT",{identifier:i.identifier,className:i.aliasName}),Et.play(st.piecePut)}}}getCreateTableMaskMenu(e){return{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u4f5c\u6210",action:()=>{this.createGameTableMask(e),Et.play(st.cardPut)}}}getCreateTerrainMenu(e){return{name:"\u5730\u5f62\u3092\u4f5c\u6210",action:()=>{this.createTerrain(e),Et.play(st.blockPut)}}}getCreateTextNoteMenu(e){return{name:"\u5171\u6709\u30e1\u30e2\u3092\u4f5c\u6210",action:()=>{this.createTextNote(e),Et.play(st.cardPut)}}}getCreateBlankCardMenu(e){return{name:"\u30d6\u30e9\u30f3\u30af\u30ab\u30fc\u30c9\u3092\u4f5c\u6210",action:()=>{this.createBlankCard(e),Et.play(st.cardPut)}}}getCreateTrumpMenu(e){return{name:"\u30c8\u30e9\u30f3\u30d7\u306e\u5c71\u672d\u3092\u4f5c\u6210",action:()=>{this.createTrump(e),Et.play(st.cardPut)}}}getCreateDiceSymbolMenu(e){let r=[];return[{menuName:"\u30b3\u30a4\u30f3 (\u8868/\u88cf)",diceName:"\u30b3\u30a4\u30f3",type:qi.D2,imagePathPrefix:"2_coin"},{menuName:"D4",diceName:"D4",type:qi.D4,imagePathPrefix:"4_dice"},{menuName:"D6",diceName:"D6",type:qi.D6,imagePathPrefix:"6_dice"},{menuName:"D6 (Black)",diceName:"D6",type:qi.D6,imagePathPrefix:"6_dice_black"},{menuName:"D8",diceName:"D8",type:qi.D8,imagePathPrefix:"8_dice"},{menuName:"D10",diceName:"D10",type:qi.D10,imagePathPrefix:"10_dice"},{menuName:"D10 (00-90)",diceName:"D10",type:qi.D10_10TIMES,imagePathPrefix:"100_dice"},{menuName:"D12",diceName:"D12",type:qi.D12,imagePathPrefix:"12_dice"},{menuName:"D20",diceName:"D20",type:qi.D20,imagePathPrefix:"20_dice"}].forEach(o=>{r.push({name:o.menuName,action:()=>{this.createDiceSymbol(e,o.diceName,o.type,o.imagePathPrefix),Et.play(st.dicePut)}})}),{name:"\u30c0\u30a4\u30b9\u3092\u4f5c\u6210",action:null,subActions:r}}getCreateRangeMenu(e){let r=[];return[{menuName:"\u9310\u5f62",typeName:"CORN"},{menuName:"\u76f4\u7dda",typeName:"LINE"},{menuName:"\u5186",typeName:"CIRCLE"},{menuName:"\u6b63\u65b9\u5f62",typeName:"SQUARE"},{menuName:"\u30c0\u30a4\u30e4\u30e2\u30f3\u30c9",typeName:"DIAMOND"}].forEach(o=>{r.push({name:o.menuName,action:()=>{this.createRangeArea(e,o.typeName),Et.play(st.dicePut)}})}),{name:"\u5c04\u7a0b\u30fb\u7bc4\u56f2\u3092\u4f5c\u6210",action:null,subActions:r}}getViewTable(){return Tr.instance.viewTable}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=$n({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Sl=(()=>{class t{constructor(e,i,r,o,s,a){this.ngZone=e,this.elementRef=i,this.batchService=r,this.pointerDeviceService=o,this.coordinateService=s,this.tabletopService=a,this.layerName="",this.colideLayers=[],this.transformCssOffset="",this.isDisable=!1,this.isInteract=!0,this.onstart=new Hn,this.ondragstart=new Hn,this.ondrag=new Hn,this.ondragend=new Hn,this.onend=new Hn,this._posX=0,this._posY=0,this._posZ=0,this.pointerOffset2d={x:0,y:0,z:0},this.pointerStart3d={x:0,y:0,z:0},this.height=0,this.width=0,this.ratio=1,this.updateTimer=null,this.collidableElements=[],this.input=null}set option(e){this.tabletopObject=null!=e.tabletopObject?e.tabletopObject:this.tabletopObject,this.layerName=null!=e.layerName?e.layerName:this.layerName,this.colideLayers=null!=e.colideLayers?e.colideLayers:this.colideLayers,this.transformCssOffset=null!=e.transformCssOffset?e.transformCssOffset:this.transformCssOffset}get nativeElement(){return this.elementRef.nativeElement}get posX(){return this._posX}set posX(e){this._posX=e,this.setUpdateTimer()}get posY(){return this._posY}set posY(e){this._posY=e,this.setUpdateTimer()}get posZ(){return this._posZ}set posZ(e){this._posZ=e,this.setUpdateTimer()}get isGridSnap(){return Tr.instance.gridSnap}ngAfterViewInit(){this.batchService.add(()=>this.initialize(),this.elementRef),this.setPosition(this.tabletopObject)}ngOnDestroy(){this.cancel(),this.input.destroy(),this.unregister(),Ue.unregister(this),this.batchService.remove(this),this.batchService.remove(this.elementRef)}initialize(){this.input=new ls(this.nativeElement),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),Ue.register(this).on("UPDATE_GAME_OBJECT",e=>{e.isSendFromSelf&&this.input.isGrabbing||e.data.identifier!==this.tabletopObject.identifier||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.stopTransition(),this.setPosition(this.tabletopObject)},this)}),this.layerName.length<1&&this.tabletopObject&&(this.layerName=this.tabletopObject.aliasName),this.register(),this.findCollidableElements(),this.setPosition(this.tabletopObject)}cancel(){this.input.cancel(),this.setPointerEvents(!0),this.setAnimatedTransition(!0),this.setCollidableLayer(!1),this.tabletopService.tableSelecter.viewTable&&(this.tabletopService.tableSelecter.viewTable.gridHeight=0)}onInputStart(e){if(this.callSelectedEvent(),this.collidableElements.length<1&&this.findCollidableElements(),this.isDisable||1===e.button||2===e.button)return this.cancel();this.onstart.emit(e),this.setPointerEvents(!1),this.setAnimatedTransition(!1),this.setCollidableLayer(this.isInteract),this.width=this.nativeElement.clientWidth,this.height=this.nativeElement.clientHeight;let i={x:this.posX+this.width/2,y:this.posY+this.height/2,z:this.posZ},r=this.coordinateService.convertToGlobal(i,this.coordinateService.tabletopOriginElement);this.setPointerEvents(!0),this.pointerOffset2d.x=r.x-this.input.pointer.x,this.pointerOffset2d.y=r.y-this.input.pointer.y,this.pointerOffset2d.z=r.z-this.input.pointer.z,this.pointerStart3d.x=i.x,this.pointerStart3d.y=i.y,this.pointerStart3d.z=i.z,this.targetStartRect=this.nativeElement.getBoundingClientRect(),this.ratio=1,this.tabletopService.tableSelecter.viewTable.gridHeight=this.posZ+.5,this.setUpdateTimer()}onInputMove(e){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();e.cancelable&&e.preventDefault(),this.input.isDragging||this.setPointerEvents(!1);let i={x:this.input.pointer.x+this.pointerOffset2d.x*this.ratio,y:this.input.pointer.y+this.pointerOffset2d.y*this.ratio,z:0};i.x=Math.min(window.innerWidth-.1,Math.max(i.x,.1)),i.y=Math.min(window.innerHeight-.1,Math.max(i.y,.1));let r=document.elementFromPoint(i.x,i.y);if(null==r)return;let o=this.coordinateService.calcTabletopLocalCoordinate(i,r);if(o.x-=this.width/2,o.y-=this.height/2,this.posX===o.x&&this.posY===o.y&&this.posZ===o.z)return;this.input.isDragging||this.ondragstart.emit(e),this.ondrag.emit(e);let a=this.nativeElement.getBoundingClientRect().width/this.targetStartRect.width;a<this.ratio&&(this.ratio+=.1*(a-this.ratio)),this.posX=o.x,this.posY=o.y,this.posZ=o.z,Tr.instance.viewTable.gridHeight=this.posZ+.5}onInputEnd(e){if(this.isDisable)return this.cancel();this.input.isDragging&&this.ondragend.emit(e),this.isGridSnap&&this.input.isDragging&&this.snapToGrid(),this.cancel(),this.onend.emit(e)}onContextMenu(e){if(this.isDisable)return this.cancel();e.cancelable&&e.preventDefault(),this.isGridSnap&&this.input.isDragging&&this.snapToGrid();let i=this.input.isGrabbing&&e.isTrusted;if(this.cancel(),i){e.stopPropagation();let r=new MouseEvent(e.type,e);this.ngZone.run(()=>this.nativeElement.dispatchEvent(r))}}callSelectedEvent(){this.tabletopObject&&Ue.trigger("SELECT_TABLETOP_OBJECT",{identifier:this.tabletopObject.identifier,className:this.tabletopObject.aliasName})}snapToGrid(e=25){this.posX=this.calcSnapNum(this.posX,e),this.posY=this.calcSnapNum(this.posY,e)}calcSnapNum(e,i){return i<=0?e:(e=e<0?e-i/2:e+i/2)-e%i}setPosition(e){this._posX=e.location.x,this._posY=e.location.y,this._posZ=e.posZ,this.updateTransformCss()}setUpdateTimer(){null===this.updateTimer&&this.tabletopObject&&(this.updateTimer=setTimeout(()=>{this.tabletopObject.location.x=this.posX,this.tabletopObject.location.y=this.posY,this.tabletopObject.posZ=this.posZ,this.updateTimer=null},66)),this.updateTransformCss()}findCollidableElements(){this.collidableElements=[],"none"===getComputedStyle(this.nativeElement).pointerEvents?this.findNestedCollidableElements(this.nativeElement):this.collidableElements=[this.nativeElement]}findNestedCollidableElements(e){let i=e.children;for(let r=0;r<i.length;r++){let o=i[r];o instanceof HTMLElement&&"none"!==getComputedStyle(o).pointerEvents&&this.collidableElements.push(o)}if(this.collidableElements.length<1)for(let r=0;r<i.length;r++){let o=i[r];o instanceof HTMLElement&&this.findNestedCollidableElements(o)}}setPointerEvents(e){let i=e?"auto":"none";this.collidableElements.forEach(r=>r.style.pointerEvents=i)}setAnimatedTransition(e){this.nativeElement.style.transition=e?"transform 132ms linear":""}shouldTransition(e){return e.location.x!==this.posX||e.location.y!==this.posY||e.posZ!==this.posZ}stopTransition(){this.nativeElement.style.transform=window.getComputedStyle(this.nativeElement).transform}updateTransformCss(){let e=`${this.transformCssOffset} translate3d(${this.posX.toFixed(4)}px, ${this.posY.toFixed(4)}px, ${this.posZ.toFixed(4)}px)`;this.nativeElement.style.transform=e}setCollidableLayer(e){let i=e;for(let r in t.layerHash)i=-1<this.colideLayers.indexOf(r)?"character"==r?!this.input.isGrabbing||e&&!this.tabletopObject.isNotRide:!this.input.isGrabbing||e:!e,t.layerHash[r].forEach(o=>{o===this||o.input.isGrabbing||o.setPointerEvents(i)})}register(){this.layerName in t.layerHash||(t.layerHash[this.layerName]=[]),t.layerHash[this.layerName].indexOf(this)<0&&t.layerHash[this.layerName].push(this)}unregister(){if(!(this.layerName in t.layerHash))return;let e=t.layerHash[this.layerName].indexOf(this);-1<e&&t.layerHash[this.layerName].splice(e,1)}}return t.layerHash={},t.\u0275fac=function(e){return new(e||t)(He(Nn),He(Ai),He(Pg),He(Ci),He(wl),He(Vu))},t.\u0275dir=hn({type:t,selectors:[["","appMovable",""]],inputs:{option:["movable.option","option"],isDisable:["movable.disable","isDisable"],isInteract:["movable.interact","isInteract"]},outputs:{onstart:"movable.onstart",ondragstart:"movable.ondragstart",ondrag:"movable.ondrag",ondragend:"movable.ondragend",onend:"movable.onend"}}),t})(),Tc=(()=>{class t{constructor(e,i,r,o,s){this.elementRef=e,this.batchService=i,this.pointerDeviceService=r,this.coordinateService=o,this.tabletopService=s,this.transformCssOffset="",this.grabbingSelecter=".rotate-grab",this.isDisable=!1,this.polygonal=24,this.onstart=new Hn,this.ondragstart=new Hn,this.ondrag=new Hn,this.ondragend=new Hn,this.onend=new Hn,this._rotate=0,this.valueChange=new Hn,this.rotateOffset=0,this.updateTimer=null,this.grabbingElement=null,this.input=null}set option(e){this.tabletopObject=null!=e.tabletopObject?e.tabletopObject:this.tabletopObject,this.grabbingSelecter=null!=e.grabbingSelecter?e.grabbingSelecter:this.grabbingSelecter,this.transformCssOffset=null!=e.transformCssOffset?e.transformCssOffset:this.transformCssOffset}get nativeElement(){return this.elementRef.nativeElement}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.setUpdateTimer()}set value(e){this._rotate=e,this.updateTransformCss()}get isAllowedToRotate(){if(!this.grabbingElement||!this.nativeElement)return!1;if(this.grabbingSelecter.length<1)return!0;let e=this.nativeElement.querySelectorAll(this.grabbingSelecter),i=!1;for(let r=0;r<e.length;r++)if(i=e[r].contains(this.grabbingElement),i)return!0;return!1}ngAfterViewInit(){this.batchService.add(()=>this.initialize(),this.elementRef),this.tabletopObject?this.setRotate(this.tabletopObject):this.updateTransformCss()}ngOnDestroy(){this.cancel(),this.input.destroy(),Ue.unregister(this),this.batchService.remove(this),this.batchService.remove(this.elementRef)}initialize(){this.input=new ls(this.nativeElement),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),this.tabletopObject?(Ue.register(this).on("UPDATE_GAME_OBJECT",e=>{e.isSendFromSelf&&this.input.isGrabbing||e.data.identifier!==this.tabletopObject.identifier||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.stopTransition(),this.setRotate(this.tabletopObject)},this)}),this.setRotate(this.tabletopObject)):this.updateTransformCss()}cancel(){this.input.cancel(),this.grabbingElement=null,this.setAnimatedTransition(!0),this.tabletopService.tableSelecter.viewTable&&(this.tabletopService.tableSelecter.viewTable.gridHeight=0)}onInputStart(e){if(this.grabbingElement=e.target,this.isDisable||!this.isAllowedToRotate||1===e.button||2===e.button)return this.cancel();e.stopPropagation(),this.onstart.emit(e);let i=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.nativeElement.parentElement);this.rotateOffset=this.calcRotate(i,this.rotate),this.setAnimatedTransition(!1),this.tabletopObject&&(this.tabletopService.tableSelecter.viewTable.gridHeight=this.tabletopObject.posZ+.5,this.setUpdateTimer())}onInputMove(e){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();e.cancelable&&e.preventDefault(),e.stopPropagation();let i=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.nativeElement.parentElement),r=this.calcRotate(i,this.rotateOffset);this.input.isDragging||this.ondragstart.emit(e),this.ondrag.emit(e),this.rotate=r}onInputEnd(e){if(this.isDisable)return this.cancel();e.stopPropagation(),this.input.isDragging&&this.ondragend.emit(e),this.cancel(),this.snapToPolygonal(this.polygonal),this.onend.emit(e)}onContextMenu(e){if(this.isDisable)return this.cancel();e.cancelable&&e.preventDefault(),this.cancel(),this.snapToPolygonal(this.polygonal)}calcRotate(e,i){return(180*Math.atan2(e.y-this.nativeElement.clientHeight/2,e.x-this.nativeElement.clientWidth/2)/Math.PI-i)%360}snapToPolygonal(e=24){e<=1||(this.rotate=this.rotate<0?this.rotate-180/e:this.rotate+180/e,this.rotate-=this.rotate%(360/e))}setUpdateTimer(){null===this.updateTimer&&(this.updateTimer=setTimeout(()=>{this.valueChange.emit(this.rotate),this.tabletopObject&&(this.tabletopObject.rotate=this.rotate),this.updateTimer=null},66)),this.updateTransformCss()}setRotate(e){e&&(this._rotate=e.rotate),this.updateTransformCss()}setAnimatedTransition(e){this.nativeElement.style.transition=e?"transform 132ms linear":""}shouldTransition(e){return e.rotate!==this.rotate}stopTransition(){this.nativeElement.style.transform=window.getComputedStyle(this.nativeElement).transform}updateTransformCss(){let e=`${this.transformCssOffset} rotateZ(${this.rotate.toFixed(4)}deg)`;this.nativeElement.style.transform=e}}return t.\u0275fac=function(e){return new(e||t)(He(Ai),He(Pg),He(Ci),He(wl),He(Vu))},t.\u0275dir=hn({type:t,selectors:[["","appRotable",""]],inputs:{option:["rotable.option","option"],isDisable:["rotable.disable","isDisable"],polygonal:["rotable.polygonal","polygonal"],value:["rotable.value","value"]},outputs:{onstart:"rotable.onstart",ondragstart:"rotable.ondragstart",ondrag:"rotable.ondrag",ondragend:"rotable.ondragend",onend:"rotable.onend",valueChange:"rotable.valueChange"}}),t})();function nJ(t,n){if(1&t&&(Q(0,"div",8),mt(1,"div",9),Lt(2,"safe"),ne()),2&t){const e=me();ut("opacity",e.isFront?1:.8)("transform",e.isFront?"":"scale(0.9)"),oe("@flipOpen",void 0),G(1),ut("font-size",e.fontSize+9,"px")("color",e.color)("text-shadow",e.textShadowCss),oe("@inverse",e.state)("innerHTML",Bt(2,13,e.rubiedText,"html"),lr)}}function iJ(t,n){if(1&t&&(mt(0,"img",10),Lt(1,"safe")),2&t){const e=me();oe("@inverse",e.state)("src",Bt(1,2,e.isFront?e.frontImage.url:e.backImage.url,"resourceUrl"),vn)}}const rJ=function(t,n){return{"background-color":t,transform:n}};function oJ(t,n){if(1&t&&(Q(0,"div",11)(1,"span",12)(2,"b"),ve(3),ne()()()),2&t){const e=me();oe("ngStyle",un(2,rJ,e.ownerColor,"translateY(-75%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),G(3),lt(e.ownerName)}}function sJ(t,n){1&t&&(mt(0,"img",13),Lt(1,"safe")),2&t&&oe("src",Bt(1,1,me().frontImage.url,"resourceUrl"),vn)}function aJ(t,n){if(1&t&&(it(0),Q(1,"div",14)(2,"i",15),ve(3),ne()(),Q(4,"div",16)(5,"i",15),ve(6),ne()(),Q(7,"div",17)(8,"i",15),ve(9),ne()(),Q(10,"div",18)(11,"i",15),ve(12),ne()(),mt(13,"div",19),rt()),2&t){const e=me();G(3),lt(e.isLocked?"lock":"autorenew"),G(3),lt(e.isLocked?"lock":"autorenew"),G(3),lt(e.isLocked?"lock":"autorenew"),G(3),lt(e.isLocked?"lock":"autorenew")}}const lJ=function(t){return{"is-grab":t}};let cJ=(()=>{class t{constructor(e,i,r,o,s,a,h,b,ee,de){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.elementRef=o,this.changeDetector=s,this.tabletopService=a,this.imageService=h,this.pointerDeviceService=b,this.modalService=ee,this.chatMessageService=de,this.card=null,this.is3D=!1,this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null}get name(){return this.card.name}get state(){return this.card.state}set state(e){this.card.state=e}get rotate(){return this.card.rotate}set rotate(e){this.card.rotate=e}get owner(){return this.card.owner}set owner(e){this.card.owner=e}get zindex(){return this.card.zindex}get size(){return this.adjustMinBounds(this.card.size)}get fontSize(){return this.card.fontsize}set fontSize(e){this.card.fontsize=e}get text(){return this.card.text}set text(e){this.card.text=e}get color(){return this.card.color}set color(e){this.card.color=e}get textShadowCss(){const e=pt.textShadowColor(this.color);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}get isHand(){return this.card.isHand}get isFront(){return this.card.isFront}get isVisible(){return this.card.isVisible}get hasOwner(){return this.card.hasOwner}get ownerIsOnline(){return this.card.ownerIsOnline}get ownerName(){return this.card.ownerName}get ownerColor(){return this.card.ownerColor}get isGMMode(){return this.card.isGMMode}get imageFile(){return this.imageService.getSkeletonOr(this.card.imageFile)}get frontImage(){return this.imageService.getSkeletonOr(this.card.frontImage)}get backImage(){return this.imageService.getSkeletonOr(this.card.backImage)}get isIconHidden(){return null!=this.iconHiddenTimer}get rubiedText(){return pt.rubyToHtml(pt.escapeHtml(this.text))}get isLocked(){return!!this.card&&this.card.isLocked}set isLocked(e){this.card&&(this.card.isLocked=e)}ngOnInit(){Ue.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Ct.instance.get(e.data.identifier);!this.card||!i||(this.card===i||i instanceof ni&&this.card.contains(i)||i instanceof Qe&&i.userId===this.card.owner)&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=Qe.findByPeerId(e.data.peerId);(!i||this.card.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.card,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain","text-note"]},this.rotableOption={tabletopObject:this.card}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new ls(this.elementRef.nativeElement)}),this.input.onStart=e=>this.ngZone.run(()=>this.onInputStart(e))}ngOnDestroy(){this.input.destroy(),Ue.unregister(this)}onCardDrop(e){if(this.card!==e.detail&&(e.detail instanceof Qn||e.detail instanceof ai)&&(e.stopPropagation(),e.preventDefault(),e.detail instanceof ai)){if(this.isLocked)return;let i=e.detail;(i.location.x-this.card.location.x)**2+(i.location.y-this.card.location.y)**2+(i.posZ-this.card.posZ)**2<625&&(i.location.x=this.card.location.x,i.location.y=this.card.location.y,i.posZ=this.card.posZ,i.putOnBottom(this.card),this.isLocked=!1)}}startDoubleClickTimer(e){if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(()=>this.stopDoubleClickTimer(),e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}stopDoubleClickTimer(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}onDoubleClick(){if(!this.isLocked&&(this.stopDoubleClickTimer(),(this.doubleClickPoint.x-this.input.pointer.x)**2+(this.doubleClickPoint.y-this.input.pointer.y)**2<100)){if(console.log("onDoubleClick !!!!"),this.ownerIsOnline&&!this.isHand)return;this.state=this.isVisible&&!this.isHand?Go.BACK:Go.FRONT,this.owner="",this.state===Go.FRONT&&this.chatMessageService.sendOperationLog((""==this.card.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.card.name)+" \u3092\u516c\u958b"),Et.play(st.cardDraw)}}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.startDoubleClickTimer(e),this.card.toTopmost(),this.startIconHiddenTimer(),this.isLocked&&Ue.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,Et.play(st.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,Et.play(st.lock)}},Ht,!this.isVisible||this.isHand?{name:this.isHand?"\u8868\u5411\u304d\u3067\u51fa\u3059\uff08\u516c\u958b\u3059\u308b\uff09":this.ownerIsOnline?"\u8868\u306b\u3059\u308b\uff08\u516c\u958b\u3059\u308b\uff09":"\u8868\u306b\u3059\u308b",action:()=>{this.card.faceUp(),this.chatMessageService.sendOperationLog((""==this.card.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.card.name)+" \u3092\u516c\u958b"),Et.play(st.cardDraw)},default:!this.isLocked&&(!this.ownerIsOnline||this.isHand)}:{name:"\u88cf\u306b\u3059\u308b",action:()=>{this.card.faceDown(),Et.play(st.cardDraw)},default:!this.card.isLocked&&(!this.ownerIsOnline||this.isHand)},this.isHand?{name:"\u88cf\u5411\u304d\u3067\u51fa\u3059",action:()=>{this.card.faceDown(),Et.play(st.cardDraw)}}:{name:"\u81ea\u5206\u3060\u3051\u898b\u308b\uff08\u624b\u672d\u306b\u3059\u308b\uff09",action:()=>{Et.play(st.cardDraw),this.chatMessageService.sendOperationLog(`${this.card.isFront?""==this.card.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.card.name:"(\u4f0f\u305b\u305f\u30ab\u30fc\u30c9)"} \u3092\u81ea\u5206\u3060\u3051\u898b\u305f`),this.card.faceDown(),this.owner=Ot.peerContext.userId}},Ht,{name:"\u91cd\u306a\u3063\u305f\u30ab\u30fc\u30c9\u3067\u5c71\u672d\u3092\u4f5c\u308b",action:()=>{this.createStack(),Et.play(st.cardPut)},disabled:this.isLocked},Ht,{name:"\u30ab\u30fc\u30c9\u3092\u7de8\u96c6...",action:()=>{this.showDetail(this.card)}},this.isVisible&&this.card.getUrls().length>0?{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.card.getUrls().map(r=>{const o=r.value.toString();return{name:r.name?r.name:o,action:()=>{pt.sameOrigin(o)?window.open(o.trim(),"_blank","noopener"):this.modalService.open(lo,{url:o,title:this.card.name,subTitle:r.name})},disabled:!pt.validUrl(o),error:pt.validUrl(o)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:pt.validUrl(o)&&!pt.sameOrigin(o)}})}:null,this.isVisible&&this.card.getUrls().length>0?Ht:null,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.card.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.toTopmost(),r.isLocked=!1,Et.play(st.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.card.destroy(),Et.play(st.sweep)}}],this.isVisible?this.name:"\u30ab\u30fc\u30c9")}onMove(){this.input.cancel(),Et.play(st.cardPick)}onMoved(){Et.play(st.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}createStack(){let e=this.tabletopService.cards.filter(r=>(r.location.x-this.card.location.x)**2+(r.location.y-this.card.location.y)**2+(r.posZ-this.card.posZ)**2<1e4&&!r.isLocked);if(0==e.length)return;let i=ai.create("\u5c71\u672d");i.location.x=this.card.location.x,i.location.y=this.card.location.y,i.posZ=this.card.posZ,i.location.name=this.card.location.name,i.rotate=this.rotate,i.zindex=this.card.zindex,e.sort((r,o)=>r.zindex<o.zindex?1:r.zindex>o.zindex?-1:0);for(let r of e)i.putOnBottom(r)}dispatchCardDropEvent(){console.log("dispatchCardDropEvent");let r=this.elementRef.nativeElement.parentElement.children,o=new CustomEvent("carddrop",{detail:this.card,bubbles:!0});for(let s=0;s<r.length;s++)r[s].dispatchEvent(o)}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){Ue.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(r+=" - "+(this.isVisible?e.name:"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09")),this.panelService.open(ps,{title:r,left:i.x-300,top:i.y-300,width:600,height:490}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(He(Nn),He(hr),He(qn),He(Ai),He(Ki),He(Vu),He(Zu),He(Ci),He(Yn),He(Hr))},t.\u0275cmp=fn({type:t,selectors:[["card"]],hostBindings:function(e,i){1&e&&Ae("carddrop",function(o){return i.onCardDrop(o)})("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{card:"card",is3D:"is3D"},decls:8,vars:15,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],[1,"is-pointer-events-none","is-3d"],["appRotable","",1,"component-content","is-pointer-events-auto","is-3d",3,"rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],["class","text is-3d","style","width: 100%; height: 100%",3,"opacity","transform",4,"ngIf"],["class","card-image is-3d chrome-smooth-image-trick",3,"src",4,"ngIf"],["class","name-tag is-nowrap has-length-limit is-black-background is-3d",3,"ngStyle",4,"ngIf"],["class","card-image thumbnail-transform is-translucent is-3d chrome-smooth-image-trick",3,"src",4,"ngIf"],[4,"ngIf"],[1,"text","is-3d",2,"width","100%","height","100%"],[1,"is-3d",3,"innerHTML"],[1,"card-image","is-3d","chrome-smooth-image-trick",3,"src"],[1,"name-tag","is-nowrap","has-length-limit","is-black-background","is-3d",3,"ngStyle"],[1,"is-3d"],[1,"card-image","thumbnail-transform","is-translucent","is-3d","chrome-smooth-image-trick",3,"src"],[1,"rotate-grab","of-left-top","is-3d"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","is-3d"],[1,"rotate-grab","of-right-bottom","is-3d"],[1,"rotate-grab","of-right-top","is-3d"],[1,"border-bg","is-pointer-events-none","is-3d"]],template:function(e,i){1&e&&(Q(0,"div",0),Ae("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),Q(1,"div",1)(2,"div",2),Ae("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Te(3,nJ,3,16,"div",3),Te(4,iJ,2,5,"img",4),Te(5,oJ,4,5,"div",5),Te(6,sJ,2,4,"img",6),Te(7,aJ,14,4,"ng-container",7),ne()()()),2&e&&(ut("width",i.size*i.gridSize,"px"),oe("ngClass",wt(13,lJ,!i.isLocked))("movable.option",i.movableOption)("movable.disable",i.isLocked),G(1),oe("@slidInOut",void 0),G(1),oe("rotable.option",i.rotableOption)("rotable.disable",i.isLocked),G(1),oe("ngIf",i.isFront||i.isHand||i.isGMMode),G(1),oe("ngIf",i.imageFile),G(1),oe("ngIf",!i.isFront&&i.ownerIsOnline&&0<i.ownerName.length),G(1),oe("ngIf",!i.isFront&&(i.isHand||i.isGMMode)&&i.frontImage),G(1),oe("ngIf",!i.isIconHidden))},dependencies:[si,Bn,fr,Sl,Tc,$i],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:auto;width:auto;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;min-width:25px;min-height:25px}.component-content[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;height:100%;width:100%;box-sizing:border-box}.card-image[_ngcontent-%COMP%]{display:block;inset:0;margin:auto;height:auto;width:100%}.thumbnail-transform[_ngcontent-%COMP%]{position:absolute;transform:scale(.9)}.is-translucent[_ngcontent-%COMP%]{filter:opacity(.8)}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;z-index:11}.rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-10px;left:-10px;border-radius:14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-10px;left:-10px;border-radius:14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-10px;right:-10px;border-radius:14px}.of-right-top[_ngcontent-%COMP%]{top:-10px;right:-10px;border-radius:14px}.border-bg[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;border-radius:8px;background-color:#cccccc80;inset:-2px;z-index:-1}.border-bg[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .border-bg[_ngcontent-%COMP%]{display:block}.component[_ngcontent-%COMP%]:active   .border-bg[_ngcontent-%COMP%]{display:none}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:0;color:#f5f5f5!important;opacity:.9;z-index:10}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.text[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}"],data:{animation:[Vn("inverse",[Ap("inverse",dt({transform:""})),tn(":increment, :decrement",[Zt("200ms ease",bn([dt({transform:"scale3d(1.0, 1.0, 1.0)",offset:0}),dt({transform:"scale3d(0.6, 1.2, 1.2)",offset:.5}),dt({transform:"scale3d(0, 0.75, 0.75)",offset:.75}),dt({transform:"scale3d(0.5, 1.125, 1.125)",offset:.875}),dt({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])]),Vn("flipOpen",[tn(":enter",[Zt("200ms ease",bn([dt({transform:"scale3d(0, 1.0, 1.0)",offset:0}),dt({transform:"scale3d(0, 1.2, 1.2)",offset:.5}),dt({transform:"scale3d(0, 0.75, 0.75)",offset:.75}),dt({transform:"scale3d(0.5, 1.125, 1.125)",offset:.875}),dt({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])]),Vn("slidInOut",[tn("void => *",[Zt("200ms ease",bn([dt({"transform-origin":"left center",transform:"scale3d(0, 1.0, 1.0)",offset:0}),dt({"transform-origin":"left center",transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),tn("* => void",[Zt(100,dt({"transform-origin":"left center",transform:"scale3d(0, 1.0, 1.0)"}))])])]},changeDetection:0}),t})();const uJ=["draggablePanel"],dJ=["cardImage"],fJ=["fullCardImage"],hJ=["textArea"];function pJ(t,n){1&t&&Pn(0)}function gJ(t,n){1&t&&Pn(0)}const GI=function(t){return{card:t}};function mJ(t,n){if(1&t&&(it(0),Te(1,gJ,1,0,"ng-container",14),rt()),2&t){const e=me(),i=cn(13);G(1),oe("ngTemplateOutlet",i)("ngTemplateOutletContext",wt(2,GI,e.tabletopObject))}}function _J(t,n){1&t&&Pn(0)}function $J(t,n){if(1&t&&(it(0),Te(1,_J,1,0,"ng-container",14),rt()),2&t){const e=me(),i=cn(13);G(1),oe("ngTemplateOutlet",i)("ngTemplateOutletContext",wt(2,GI,e.tabletopObject))}}function vJ(t,n){1&t&&Pn(0)}const bJ=function(t){return{note:t}};function yJ(t,n){if(1&t&&(it(0),Te(1,vJ,1,0,"ng-container",14),rt()),2&t){const e=me(),i=cn(15);G(1),oe("ngTemplateOutlet",i)("ngTemplateOutletContext",wt(2,bJ,e.tabletopObject))}}function CJ(t,n){1&t&&Pn(0)}const wJ=function(t){return{character:t}};function xJ(t,n){if(1&t&&(it(0),Te(1,CJ,1,0,"ng-container",14),rt()),2&t){const e=me(),i=cn(17);G(1),oe("ngTemplateOutlet",i)("ngTemplateOutletContext",wt(2,wJ,e.tabletopObject))}}function EJ(t,n){1&t&&Pn(0)}const TJ=function(t){return{dice:t}};function SJ(t,n){if(1&t&&(it(0),Te(1,EJ,1,0,"ng-container",14),rt()),2&t){const e=me(),i=cn(19);G(1),oe("ngTemplateOutlet",i)("ngTemplateOutletContext",wt(2,TJ,e.tabletopObject))}}function IJ(t,n){1&t&&Pn(0)}const MJ=function(t){return{range:t}};function kJ(t,n){if(1&t&&(it(0),Te(1,IJ,1,0,"ng-container",14),rt()),2&t){const e=me(),i=cn(21);G(1),oe("ngTemplateOutlet",i)("ngTemplateOutletContext",wt(2,MJ,e.tabletopObject))}}function DJ(t,n){1&t&&Pn(0)}const AJ=function(t){return{object:t}};function PJ(t,n){if(1&t&&(it(0),Te(1,DJ,1,0,"ng-container",14),rt()),2&t){const e=me(),i=cn(23);G(1),oe("ngTemplateOutlet",i)("ngTemplateOutletContext",wt(2,AJ,e.tabletopObject))}}function NJ(t,n){1&t&&Pn(0)}function OJ(t,n){if(1&t&&(it(0),Te(1,NJ,1,0,"ng-container",15),rt()),2&t){me();const e=cn(27);G(1),oe("ngTemplateOutlet",e)}}const qI=function(t){return{transform:t}};function FJ(t,n){if(1&t&&(Q(0,"div",28),mt(1,"div",29),Lt(2,"safe"),ne()),2&t){const e=me(3);ut("width",e.imageAreaRect.width,"px")("height",e.imageAreaRect.height,"px")("left",e.imageAreaRect.left,"px"),oe("ngStyle",wt(17,qI,"scale("+e.imageAreaRect.scale+")")),G(1),ut("font-size",e.cardFontSize,"px")("color",e.cardColor)("text-shadow",e.cardTextShadowCss),oe("innerHTML",Bt(2,14,e.cardText,"html"),lr)}}const WI=function(t){return{"with-button-marign":t}};function RJ(t,n){if(1&t&&(Q(0,"div",30)(1,"div",31),ve(2),ne()()),2&t){const e=me(2).card,i=me();oe("ngClass",wt(4,WI,i.hasImage)),G(1),ut("background-color",e.ownerColor),G(1),lt(e.ownerName)}}function LJ(t,n){if(1&t){const e=ft();Q(0,"div",21),Te(1,FJ,3,19,"div",22),Q(2,"img",23,24),Ae("load",function(){return Re(e),Le(me(2).onCardImageLoad())}),Lt(4,"safe"),ne(),Q(5,"button",25),Ae("click",function(){return Re(e),Le(me(2).chanageImageView(!0))}),Q(6,"i",26),ve(7,"zoom_in"),ne()(),Te(8,RJ,3,6,"div",27),ne()}if(2&t){const e=me().card,i=me();G(1),oe("ngIf","card"==e.aliasName&&(e.isFront||e.isHand||e.isGMMode)||"card-stack"==e.aliasName&&e.topCard.isFront),G(1),oe("src",Bt(4,3,i.imageUrl,"resourceUrl"),vn),G(6),oe("ngIf",e.ownerIsOnline&&0<e.ownerName.length)}}function BJ(t,n){if(1&t&&(it(0),ve(1),rt()),2&t){const e=me().card;G(1),lt(e.name)}}function zJ(t,n){1&t&&(it(0),ve(1," \u306e\u30c8\u30c3\u30d7"),rt())}function jJ(t,n){1&t&&(it(0),ve(1,"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09"),rt())}function UJ(t,n){1&t&&Pn(0)}const Xu=function(t,n){return{dataElm:t,name:n}};function HJ(t,n){if(1&t&&(it(0),Te(1,UJ,1,0,"ng-container",14),rt()),2&t){const e=n.$implicit,i=me(2).card;me();const r=cn(25);G(1),oe("ngTemplateOutlet",r)("ngTemplateOutletContext",un(2,Xu,e,i.name))}}function VJ(t,n){if(1&t&&(Q(0,"div",32)(1,"div",33),Te(2,HJ,2,5,"ng-container",34),ne()()),2&t){const e=me(2);G(2),oe("ngForOf",e.dataElms)}}const Wr=function(t,n){return{"is-pointer-events-auto":t,"pointer-events-none":n}};function GJ(t,n){if(1&t&&(Q(0,"div",16),Te(1,LJ,9,6,"div",17),Q(2,"div",18),Te(3,BJ,2,1,"ng-container",5),Te(4,zJ,2,0,"ng-container",5),Te(5,jJ,2,0,"ng-container",5),ne(),Q(6,"div",19),Te(7,VJ,3,1,"div",20),ne()()),2&t){const e=n.card,i=me();oe("ngClass",un(7,Wr,!i.isPointerDragging,i.isPointerDragging)),G(1),oe("ngIf",i.hasImage),G(1),oe("ngClass",wt(10,WI,i.hasImage)),G(1),oe("ngIf",null==e.isVisible||e.isVisible||e.isGMMode),G(1),oe("ngIf","card-stack"==e.aliasName&&!e.isEmpty),G(1),oe("ngIf",null!=e.isVisible&&!e.isVisible&&!e.isGMMode),G(2),oe("ngIf",i.hasDataElms&&(e.isVisible||e.isGMMode))}}const qJ=function(t){return{"hide-text-area":t}},WJ=function(t){return{"hide-area":t}};function KJ(t,n){if(1&t){const e=ft();Q(0,"div",35)(1,"div",36),ve(2),ne(),Q(3,"div",37)(4,"div",38),Ae("mousedown",function(){return Re(e),Le(me().textAreaActivate())}),Q(5,"div",39)(6,"textarea",40,41),Ae("ngModelChange",function(r){return Le(Re(e).note.text=r)}),ne()(),mt(8,"div",42),Lt(9,"safe"),mt(10,"div",43),Lt(11,"safe"),ne()()()}if(2&t){const e=n.note,i=me();oe("ngClass",un(13,Wr,!i.isPointerDragging,i.isPointerDragging)),G(2),lt(e.title),G(4),oe("ngModel",e.text)("ngClass",wt(16,qJ,!i.isSelected)),G(2),oe("innerHTML",Bt(9,7,i.adjustedRubiedNote(e.text),"html"),lr)("ngClass",wt(18,WJ,i.isSelected)),G(2),oe("innerHTML",Bt(11,10,i.adjustedRubiedNote(e.text,!i.isSelected),"html"),lr)}}const YJ=function(t){return{transform:t}},KI=function(t,n){return{inverse:t,hollow:n}},YI=function(t,n,e,i,r,o,s,a){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}},ZI=function(t){return{"black-paint":t}};function ZJ(t,n){if(1&t&&(it(0),Q(1,"div",51)(2,"div",52)(3,"span",53),mt(4,"img",54),Lt(5,"safe"),ne()()(),rt()),2&t){const e=me(3);G(1),oe("ngStyle",wt(8,YJ,"rotate("+e.roll+"deg)")),G(1),oe("ngClass",un(10,KI,e.isInverse,e.isHollow)),G(1),oe("ngClass",Ms(13,YI,0==e.aura,1==e.aura,2==e.aura,3==e.aura,4==e.aura,5==e.aura,6==e.aura,7==e.aura)),G(1),oe("ngClass",wt(22,ZI,e.isBlackPaint))("src",Bt(5,5,e.imageUrl,"resourceUrl"),vn)}}function XJ(t,n){if(1&t&&(it(0),mt(1,"img",55),Lt(2,"safe"),rt()),2&t){const e=me(3);G(1),oe("src",Bt(2,1,e.imageUrl,"resourceUrl"),vn)}}const QJ=function(t,n,e){return{"has-icon":t,"is-pointer-events-auto":n,"pointer-events-none":e}};function JJ(t,n){if(1&t&&(Q(0,"div",50),Te(1,ZJ,6,24,"ng-container",5),Te(2,XJ,3,4,"ng-container",5),ne()),2&t){const e=me(2);oe("ngClass",mo(3,QJ,e.isUseIcon,!e.isPointerDragging,e.isPointerDragging)),G(1),oe("ngIf",!e.isUseIcon),G(1),oe("ngIf",e.isUseIcon)}}function eee(t,n){1&t&&Pn(0)}function tee(t,n){if(1&t&&(it(0),Q(1,"div",33),Te(2,eee,1,0,"ng-container",14),ne(),rt()),2&t){const e=me().$implicit,i=me(2).character;me();const r=cn(25);G(2),oe("ngTemplateOutlet",r)("ngTemplateOutletContext",un(2,Xu,e,i.name))}}function nee(t,n){if(1&t&&(it(0),Te(1,tee,3,5,"ng-container",5),rt()),2&t){const e=n.$implicit,i=me(3);G(1),oe("ngIf",e&&!i.newLineStrings.includes(e.name))}}function iee(t,n){if(1&t&&(Q(0,"div",32),Te(1,nee,2,1,"ng-container",34),ne()),2&t){const e=me(2);G(1),oe("ngForOf",e.inventoryDataElms)}}function ree(t,n){if(1&t&&(Q(0,"div",44),mt(1,"div",45),Te(2,JJ,3,7,"div",46),Q(3,"div",47),ve(4),ne(),mt(5,"div",48),Q(6,"div",49),Te(7,iee,2,1,"div",20),ne()()),2&t){const e=n.character,i=me();G(1),oe("ngClass",un(6,Wr,!i.isPointerDragging,i.isPointerDragging)),G(1),oe("ngIf",i.hasImage),G(1),oe("ngClass",un(9,Wr,!i.isPointerDragging,i.isPointerDragging)),G(1),lt(e.name),G(2),oe("ngClass",un(12,Wr,!i.isPointerDragging,i.isPointerDragging)),G(1),oe("ngIf",i.hasDataElms)}}function oee(t,n){if(1&t&&(it(0),ve(1),rt()),2&t){const e=me().dice;G(1),Zn("",e.name,":")}}function see(t,n){if(1&t&&(it(0),ve(1),rt()),2&t){const e=me().dice;G(1),lt(e.face)}}function aee(t,n){1&t&&(it(0),ve(1,"???"),rt())}function lee(t,n){if(1&t&&(Q(0,"div",57)(1,"div",31),ve(2),ne()()),2&t){const e=me().dice,i=me();oe("ngClass",un(4,Wr,!i.isPointerDragging,i.isPointerDragging)),G(1),ut("background-color",e.ownerColor),G(1),Zn("",e.ownerName," ")}}const cee=function(t,n){return{"is-black-mask":t,"is-harf-black-mask":n}};function uee(t,n){if(1&t&&(Q(0,"div",50),mt(1,"img",58),Lt(2,"safe"),ne()),2&t){const e=me().dice,i=me();oe("ngClass",un(6,Wr,!i.isPointerDragging,i.isPointerDragging)),G(1),oe("ngClass",un(9,cee,!e.isVisible,e.isMine||e.isGMMode&&e.hasOwner))("src",Bt(2,3,i.imageUrl,"resourceUrl"),vn)}}function dee(t,n){1&t&&Pn(0)}function fee(t,n){if(1&t&&(it(0),Te(1,dee,1,0,"ng-container",14),rt()),2&t){const e=me().$implicit,i=me(2).dice;me();const r=cn(25);G(1),oe("ngTemplateOutlet",r)("ngTemplateOutletContext",un(2,Xu,e,i.name))}}function hee(t,n){if(1&t&&(it(0),Te(1,fee,2,5,"ng-container",5),rt()),2&t){const e=n.$implicit,i=me(3);G(1),oe("ngIf",e&&!i.newLineStrings.includes(e.name))}}function pee(t,n){if(1&t&&(Q(0,"div",32)(1,"div",33),Te(2,hee,2,1,"ng-container",34),ne()()),2&t){const e=me(2);G(2),oe("ngForOf",e.dataElms)}}function gee(t,n){if(1&t&&(Q(0,"div",44),mt(1,"div",45),Q(2,"div",47),Te(3,oee,2,1,"ng-container",5),Te(4,see,2,1,"ng-container",5),Te(5,aee,2,0,"ng-container",5),ne(),Te(6,lee,3,7,"div",56),Te(7,uee,3,12,"div",46),mt(8,"div",48),Q(9,"div",49),Te(10,pee,3,1,"div",20),ne()()),2&t){const e=n.dice,i=me();G(1),oe("ngClass",un(9,Wr,!i.isPointerDragging,i.isPointerDragging)),G(1),oe("ngClass",un(12,Wr,!i.isPointerDragging,i.isPointerDragging)),G(1),oe("ngIf",0<(null==e||null==e.name?null:e.name.length)),G(1),oe("ngIf",e.isVisible),G(1),oe("ngIf",!e.isVisible),G(1),oe("ngIf",e.hasOwner&&0<e.ownerName.length),G(1),oe("ngIf",i.hasImage),G(2),oe("ngClass",un(15,Wr,!i.isPointerDragging,i.isPointerDragging)),G(1),oe("ngIf",i.hasDataElms&&e.isVisible)}}function mee(t,n){if(1&t){const e=ft();it(0),Q(1,"div",60),ve(2),ne(),Q(3,"div",61)(4,"div",62)(5,"div",63),ve(6),ne(),Q(7,"input",64),Ae("ngModelChange",function(r){return Re(e),Le(me().$implicit.value=r)}),ne()()(),Q(8,"div",65)(9,"input",66),Ae("ngModelChange",function(r){return Re(e),Le(me().$implicit.value=r)}),Lt(10,"safe"),ne()(),rt()}if(2&t){const e=me().$implicit;G(1),Qt("title",e.name),G(1),lt(e.name),G(4),lt(e.value),G(1),oe("ngModel",e.value),G(2),Sr(Bt(10,9,"font-size: 0.8em; width: 100%; --min: 0; --max:"+e.value+"; --val:"+e.currentValue+";","style")),xt("title",e.value),oe("min","length"==e.name?1:0)("ngModel",e.value)}}function _ee(t,n){if(1&t){const e=ft();it(0),Q(1,"div",60),ve(2),ne(),Q(3,"div",61)(4,"div",62)(5,"div",63),ve(6),ne(),Q(7,"input",67),Ae("ngModelChange",function(r){return Re(e),Le(me().$implicit.currentValue=r)}),ne(),Q(8,"b",68),ve(9,"%"),ne()()(),Q(10,"div",65)(11,"input",69),Ae("ngModelChange",function(r){return Re(e),Le(me().$implicit.currentValue=r)}),Lt(12,"safe"),ne()(),rt()}if(2&t){const e=me().$implicit;G(1),Qt("title",e.name),G(1),lt(e.name),G(4),lt(e.currentValue),G(1),oe("ngModel",e.currentValue),G(4),Sr(Bt(12,8,"font-size: 0.8em; width: 100%; --min: 0; --max:"+e.value+"; --val:"+e.currentValue+";","style")),cr("title","",e.currentValue,"%"),oe("ngModel",e.currentValue)}}function $ee(t,n){if(1&t&&(it(0),Te(1,mee,11,12,"ng-container",5),Te(2,_ee,13,11,"ng-container",5),rt()),2&t){const e=n.$implicit;G(1),oe("ngIf","length"==e.name||"width"==e.name),G(1),oe("ngIf","opacity"==e.name)}}function vee(t,n){if(1&t&&(it(0),Q(1,"div",70),ve(2),ne(),Q(3,"div",71)(4,"div",72)(5,"span",73),mt(6,"img",74),Lt(7,"safe"),ne()()(),rt()),2&t){const e=me(2).range;G(2),Zn("\u27a1 ",e.followingCharactor.name,""),G(2),oe("ngClass",un(8,KI,e.followingCharactor.isInverse,e.followingCharactor.isHollow)),G(1),oe("ngClass",Ms(11,YI,0==e.followingCharactor.aura,1==e.followingCharactor.aura,2==e.followingCharactor.aura,3==e.followingCharactor.aura,4==e.followingCharactor.aura,5==e.followingCharactor.aura,6==e.followingCharactor.aura,7==e.followingCharactor.aura)),G(1),oe("ngClass",wt(20,ZI,e.followingCharactor.isBlackPaint))("src",Bt(7,5,e.followingCharactor.imageFile.url,"resourceUrl"),vn)}}function bee(t,n){1&t&&mt(0,"div",75)}function yee(t,n){1&t&&Pn(0)}function Cee(t,n){if(1&t&&(it(0),Te(1,yee,1,0,"ng-container",14),rt()),2&t){const e=me().$implicit,i=me(2).range;me();const r=cn(25);G(1),oe("ngTemplateOutlet",r)("ngTemplateOutletContext",un(2,Xu,e,i.name))}}function wee(t,n){if(1&t&&(it(0),Te(1,Cee,2,5,"ng-container",5),rt()),2&t){const e=n.$implicit,i=me(3);G(1),oe("ngIf",e&&!i.newLineStrings.includes(e.name))}}function xee(t,n){if(1&t&&(Q(0,"div",32)(1,"div",33),Te(2,$ee,3,2,"ng-container",34),Te(3,vee,8,22,"ng-container",5),Te(4,bee,1,0,"div",59),Te(5,wee,2,1,"ng-container",34),ne()()),2&t){const e=me().range,i=me();G(2),oe("ngForOf",i.rangeElms),G(1),oe("ngIf",e.followingCharactor),G(1),oe("ngIf",i.dataElms.length>0),G(1),oe("ngForOf",i.dataElms)}}function Eee(t,n){if(1&t&&(Q(0,"div",44),mt(1,"div",45),Q(2,"div",47),ve(3),ne(),mt(4,"div",48),Q(5,"div",49),Te(6,xee,6,4,"div",20),ne()()),2&t){const e=n.range,i=me();G(1),oe("ngClass",un(5,Wr,!i.isPointerDragging,i.isPointerDragging)),G(1),oe("ngClass",un(8,Wr,!i.isPointerDragging,i.isPointerDragging)),G(1),lt(e.name),G(2),oe("ngClass",un(11,Wr,!i.isPointerDragging,i.isPointerDragging)),G(1),oe("ngIf",i.rangeElms.length>0)}}function Tee(t,n){1&t&&Pn(0)}function See(t,n){if(1&t&&(it(0),Te(1,Tee,1,0,"ng-container",14),rt()),2&t){const e=me().$implicit,i=me().object;me();const r=cn(25);G(1),oe("ngTemplateOutlet",r)("ngTemplateOutletContext",un(2,Xu,e,i.name))}}function Iee(t,n){if(1&t&&(it(0),Te(1,See,2,5,"ng-container",5),rt()),2&t){const e=n.$implicit,i=me(2);G(1),oe("ngIf",e&&!i.newLineStrings.includes(e.name))}}function Mee(t,n){if(1&t&&(Q(0,"div",44),mt(1,"div",45),Q(2,"div",47),ve(3),ne(),mt(4,"div",48),Q(5,"div",49)(6,"div",32)(7,"div",33),Te(8,Iee,2,1,"ng-container",34),ne()()()()),2&t){const e=n.object,i=me();G(1),oe("ngClass",un(5,Wr,!i.isPointerDragging,i.isPointerDragging)),G(1),oe("ngClass",un(8,Wr,!i.isPointerDragging,i.isPointerDragging)),G(1),lt(e.name),G(2),oe("ngClass",un(11,Wr,!i.isPointerDragging,i.isPointerDragging)),G(3),oe("ngForOf",i.dataElms)}}function kee(t,n){1&t&&Pn(0)}function Dee(t,n){if(1&t&&(Q(0,"div",82),ve(1),ne()),2&t){const e=me(2).dataElm;Qt("title",e.name),G(1),lt(e.name)}}function Aee(t,n){1&t&&Pn(0)}function Pee(t,n){if(1&t&&(it(0),Te(1,Aee,1,0,"ng-container",14),rt()),2&t){const e=n.$implicit,i=me(2).name;me();const r=cn(25);G(1),oe("ngTemplateOutlet",r)("ngTemplateOutletContext",un(2,Xu,e,i))}}function Nee(t,n){if(1&t&&(Q(0,"div",79),Te(1,Dee,2,2,"div",80),Q(2,"div",81),Te(3,Pee,2,5,"ng-container",34),ne()()),2&t){const e=me().dataElm;G(1),oe("ngIf",0<e.name.trim().length),G(2),oe("ngForOf",e.children)}}function Oee(t,n){if(1&t){const e=ft();it(0),Q(1,"div",84)(2,"div"),ve(3),ne(),Q(4,"div",85)(5,"div",39)(6,"textarea",86),Ae("ngModelChange",function(r){return Re(e),Le(me(2).dataElm.value=r)}),ne()(),Q(7,"div",87),ve(8),ne()()(),rt()}if(2&t){const e=me(2).dataElm;G(2),Qt("title",e.name),G(1),lt(e.name),G(3),oe("ngModel",e.value),G(2),lt(e.value)}}function Fee(t,n){if(1&t){const e=ft();it(0),Q(1,"div",70),ve(2),ne(),Q(3,"div",61)(4,"div",88),ve(5),ne(),Q(6,"input",89),Ae("ngModelChange",function(r){return Re(e),Le(me(2).dataElm.value=r)}),ne()(),rt()}if(2&t){const e=me(2),i=e.dataElm,r=e.name,o=me();G(1),Qt("title",i.name),G(1),lt(i.name),G(3),lt(i.value),G(1),xt("type",i.value&&i.value==+i.value?"number":"text"),oe("logging.name",r)("logging.dataElement",i)("logging.disable",o.isNoLogging)("ngModel",i.value)}}function Ree(t,n){if(1&t){const e=ft();it(0),Q(1,"div",60),ve(2),ne(),Q(3,"div",61)(4,"div",62)(5,"div",63),ve(6),ne(),Q(7,"input",90),Ae("ngModelChange",function(r){return Re(e),Le(me(2).dataElm.currentValue=r)}),ne()(),Q(8,"div",91),ve(9),ne()(),Q(10,"div",65)(11,"input",92),Ae("ngModelChange",function(r){return Re(e),Le(me(2).dataElm.currentValue=r)}),Lt(12,"safe"),ne()(),rt()}if(2&t){const e=me(2),i=e.dataElm,r=e.name,o=me();G(1),Qt("title",i.name),G(1),lt(i.name),G(4),lt(i.currentValue),G(1),oe("logging.name",r)("logging.dataElement",i)("logging.disable",o.isNoLogging)("ngModel",i.currentValue),G(2),Zn(" / ",+i.value?i.value:"???",""),G(2),Sr(Bt(12,16,"font-size: 0.8em; width: 100%; --min: 0; --max:"+i.value+"; --val:"+i.currentValue+";","style")),xt("title",i.currentValue),xt("max",+i.value?i.value:1e3),oe("logging.name",r)("logging.dataElement",i)("logging.disable",o.isNoLogging)("ngModel",i.currentValue)}}function Lee(t,n){if(1&t){const e=ft();it(0),Q(1,"div",70)(2,"span"),ve(3),ne(),ve(4),ne(),Q(5,"div",61)(6,"input",93),Ae("ngModelChange",function(r){return Re(e),Le(me(2).dataElm.value=r)})("change",function(){Re(e);const r=me(2).dataElm;return Le(r.value=r.value?r.name:"")}),ne()(),rt()}if(2&t){const e=me(2),i=e.dataElm,r=e.name,o=me();G(1),Qt("title",i.name),G(1),ut("text-decoration",i.value?"none":"line-through"),G(1),lt(i.name),G(1),Zn(" ",o.checkValue(i),""),G(2),xt("checked",i.value?"checked":""),oe("logging.name",r)("logging.dataElement",i)("logging.disable",o.isNoLogging)("ngModel",i.value)}}function Bee(t,n){if(1&t&&(Q(0,"span",95),ve(1),ne()),2&t){const e=me(3).dataElm;G(1),Zn("(",(e.calcAbilityScore()>=0?"+":"")+e.calcAbilityScore(),")")}}function zee(t,n){if(1&t){const e=ft();it(0),Q(1,"div",70),ve(2),ne(),Q(3,"div",61)(4,"div",88),ve(5),ne(),Q(6,"input",89),Ae("ngModelChange",function(r){return Re(e),Le(me(2).dataElm.value=r)}),ne(),Te(7,Bee,2,1,"span",94),ne(),rt()}if(2&t){const e=me(2),i=e.dataElm,r=e.name,o=me();G(1),Qt("title",i.name),G(1),lt(i.name),G(3),lt(i.value),G(1),xt("type",i.value&&i.value==+i.value?"number":"text"),oe("logging.name",r)("logging.dataElement",i)("logging.disable",o.isNoLogging)("ngModel",i.value),G(1),oe("ngIf",i.currentValue)}}function jee(t,n){if(1&t){const e=ft();it(0),Q(1,"div",70),ve(2),ne(),Q(3,"div",61)(4,"div",88),ve(5),ne(),Q(6,"input",96),Ae("ngModelChange",function(r){return Re(e),Le(me(2).dataElm.value=r)}),ne(),Q(7,"button",97),Ae("click",function(){Re(e);const r=me(2),o=r.dataElm,s=r.name,a=me();return Le(!!a.stringUtil.validUrl(o.value)&&a.openUrl(o.value,s,o.name))}),Q(8,"i",98),ve(9),ne()()(),rt()}if(2&t){const e=me(2).dataElm,i=me();G(1),Qt("title",e.name),G(1),lt(e.name),G(3),lt(e.value),G(1),oe("ngModel",e.value),G(1),Qt("disabled",i.stringUtil.validUrl(e.value)?null:""),G(2),lt(i.stringUtil.validUrl(e.value)?i.stringUtil.sameOrigin(e.value)?"link":"open_in_new":"link_off")}}function Uee(t,n){if(1&t&&(Q(0,"div",70),ve(1),ne()),2&t){const e=me(3).dataElm;Qt("title",e.name),G(1),lt(e.name)}}function Hee(t,n){if(1&t&&(Q(0,"div",88),ve(1),ne()),2&t){const e=me(3).dataElm;G(1),lt(e.value)}}const Vee=function(t){return{"min-width":t}};function Gee(t,n){if(1&t){const e=ft();it(0),Te(1,Uee,2,2,"div",99),Q(2,"div",61),Te(3,Hee,2,1,"div",100),Q(4,"input",101),Ae("ngModelChange",function(r){return Re(e),Le(me(2).dataElm.value=r)}),ne()(),rt()}if(2&t){const e=me(2).dataElm;G(1),oe("ngIf",e.name),G(2),oe("ngIf",e.name),G(1),xt("type","size"===e.name||"altitude"===e.name?"number":"text"),xt("min","size"===e.name?"0":""),oe("ngStyle",wt(6,Vee,e.name?"8em":"100%"))("ngModel",e.value)}}function qee(t,n){1&t&&(it(0,2),Te(1,Oee,9,4,"ng-container",3),Te(2,Fee,7,8,"ng-container",3),Te(3,Ree,13,19,"ng-container",3),Te(4,Lee,7,10,"ng-container",3),Te(5,zee,8,9,"ng-container",3),Te(6,jee,10,6,"ng-container",3),Te(7,Gee,5,8,"ng-container",4),rt(),mt(8,"div",83)),2&t&&(oe("ngSwitch",me().dataElm.type),G(1),oe("ngSwitchCase","note"),G(1),oe("ngSwitchCase","simpleNumber"),G(1),oe("ngSwitchCase","numberResource"),G(1),oe("ngSwitchCase","checkProperty"),G(1),oe("ngSwitchCase","abilityScore"),G(1),oe("ngSwitchCase","url"))}function Wee(t,n){if(1&t&&(Te(0,kee,1,0,"ng-container",76),Te(1,Nee,4,2,"ng-template",null,77,ti),Te(3,qee,9,7,"ng-template",null,78,ti)),2&t){const e=n.dataElm,i=cn(2),r=cn(4);oe("ngIf",0<e.children.length)("ngIfThen",i)("ngIfElse",r)}}function Kee(t,n){if(1&t&&(Q(0,"div",107),mt(1,"div",29),Lt(2,"safe"),ne()),2&t){const e=me(2);ut("width",e.fullImageAreaRect.width,"px")("height",e.fullImageAreaRect.height,"px")("left",e.fullImageAreaRect.left,"px")("top",e.fullImageAreaRect.top,"px"),oe("ngStyle",wt(19,qI,"scale("+e.fullImageAreaRect.scale+")")),G(1),ut("font-size",e.cardFontSize,"px")("color",e.cardColor)("text-shadow",e.cardTextShadowCss),oe("innerHTML",Bt(2,16,e.cardText,"html"),lr)}}function Yee(t,n){if(1&t){const e=ft();Q(0,"div",102),Ae("click",function(){return Re(e),Le(me().chanageImageView(!1))}),Te(1,Kee,3,21,"div",103),Q(2,"div",104)(3,"i",26),ve(4,"close"),ne()(),mt(5,"img",105,106),Lt(7,"safe"),ne()}if(2&t){const e=me();oe("@fadeInOut","in"),G(1),oe("ngIf","card"==e.tabletopObject.aliasName&&(e.tabletopObject.isFront||e.tabletopObject.isHand||e.tabletopObject.isGMMode)||"card-stack"==e.tabletopObject.aliasName&&e.tabletopObject.topCard.isFront),G(4),oe("src",Bt(7,3,e.imageUrl,"resourceUrl"),vn)}}let Zee=(()=>{class t{constructor(e,i,r,o){this.inventoryService=e,this.changeDetector=i,this.pointerDeviceService=r,this.modalService=o,this.tabletopObject=null,this.left=0,this.top=0,this.gridSize=50,this.naturalWidth=0,this.naturalHeight=0,this.stringUtil=pt,this._imageFile=on.Empty,this.isOpenImageView=!1}get imageUrl(){if(!this.tabletopObject)return"";if(this.isUseIcon)return this.tabletopObject.faceIcon.url;if(this.tabletopObject instanceof sn&&this.tabletopObject.standList&&this.tabletopObject.standList.overviewIndex>-1){const e=this.tabletopObject.standList.standElements[this.tabletopObject.standList.overviewIndex];if(!e)return"";try{const i=e.getFirstElementByName("imageIdentifier");if(!i)return"";if(this._imageFile.identifier!=i.value){const r=Gt.instance.get(i.value);this._imageFile=r||on.Empty}}catch(i){console.log(i)}return this._imageFile.url}return this.tabletopObject instanceof Qn&&this.tabletopObject.isGMMode?this.tabletopObject.frontImage?this.tabletopObject.frontImage.url:"":this.tabletopObject.imageFile?this.tabletopObject.imageFile.url:""}get hasImage(){return 0<this.imageUrl.length}get isUseIcon(){return this.tabletopObject instanceof sn&&this.tabletopObject.isUseIconToOverviewImage&&this.tabletopObject.faceIcon&&0<this.tabletopObject.faceIcon.url.length}get roll(){if(this.tabletopObject instanceof sn){if(this.tabletopObject.standList&&this.tabletopObject.standList.overviewIndex>-1){const e=this.tabletopObject.standList.standElements[this.tabletopObject.standList.overviewIndex];if(!e)return 0;try{const i=e.getFirstElementByName("applyRoll");return i&&i.value?this.tabletopObject.roll:0}catch(i){console.log(i)}}return this.tabletopObject.roll}return 0}get applyImageEffect(){if(this.tabletopObject instanceof sn){if(this.tabletopObject.standList&&this.tabletopObject.standList.overviewIndex>-1){const e=this.tabletopObject.standList.standElements[this.tabletopObject.standList.overviewIndex];if(!e)return!1;try{const i=e.getFirstElementByName("applyImageEffect");return!(!i||!i.value)}catch(i){console.log(i)}}return!0}return!1}get isInverse(){return!!(this.tabletopObject instanceof sn&&this.applyImageEffect)&&this.tabletopObject.isInverse}get isHollow(){return!!(this.tabletopObject instanceof sn&&this.applyImageEffect)&&this.tabletopObject.isHollow}get isBlackPaint(){return!!(this.tabletopObject instanceof sn&&this.applyImageEffect)&&this.tabletopObject.isBlackPaint}get aura(){return this.tabletopObject instanceof sn&&this.applyImageEffect?this.tabletopObject.aura:-1}get inventoryDataElms(){return this.tabletopObject?this.getInventoryTags(this.tabletopObject):[]}get dataElms(){return this.tabletopObject&&this.tabletopObject.detailDataElement?this.tabletopObject.detailDataElement.children:[]}get hasDataElms(){return 0<this.dataElms.length}get newLineStrings(){return this.inventoryService.newLineStrings}get isPointerDragging(){return this.pointerDeviceService.isDragging}get pointerEventsStyle(){return{"is-pointer-events-auto":!this.isPointerDragging,"pointer-events-none":this.isPointerDragging}}checkValue(e){if(!e||null==e.currentValue)return"";let i=e.currentValue.toString().split(/[|\uff5c]/,2);if(i.length<=1)return null==e.value||""==e.value?"":e.currentValue.toString();let r=null==e.value||""==e.value?i[1]:i[0];return this.tabletopObject instanceof sn&&this.tabletopObject.chatPalette&&(r=this.tabletopObject.chatPalette.evaluate(r,this.tabletopObject.rootDataElement)),r}ngAfterViewInit(){this.initPanelPosition(),setTimeout(()=>{this.adjustPositionRoot()},16),Ue.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Ct.instance.get(e.data.identifier);!this.tabletopObject||!i||!(i instanceof ni)||(this.tabletopObject===i||this.tabletopObject.contains(i))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()})}ngOnDestroy(){Ue.unregister(this)}initPanelPosition(){let e=this.draggablePanel.nativeElement,i=e.offsetWidth,o=this.left+100,s=this.top-e.offsetHeight-50,a=!1;window.innerWidth<o+i&&(o=window.innerWidth-i,a=!0),s<=0&&(s=0),a&&(o=this.left-i-100),o<0&&(o=0),s<0&&(s=0),e.style.left=o+"px",e.style.top=s+"px"}adjustPositionRoot(){let e=this.draggablePanel.nativeElement,i=e.getBoundingClientRect(),r=0,o=0;window.innerWidth<i.right+r&&(r+=window.innerWidth-(i.right+r)),i.left+r<0&&(r+=0-(i.left+r)),window.innerHeight<i.bottom+o&&(o+=window.innerHeight-(i.bottom+o)),i.top+o<0&&(o+=0-(i.top+o)),e.style.left=e.offsetLeft+r+"px",e.style.top=e.offsetTop+o+"px"}chanageImageView(e){this.isOpenImageView=e}openUrl(e,i=null,r=null){pt.sameOrigin(e)?window.open(e.trim(),"_blank","noopener"):this.modalService.open(lo,{url:e,title:i,subTitle:r})}getInventoryTags(e){return this.inventoryService.tableInventory.dataElementMap.get(e.identifier)}onCardImageLoad(){!this.cardImageElement||(this.naturalWidth=this.cardImageElement.nativeElement.naturalWidth,this.naturalHeight=this.cardImageElement.nativeElement.naturalHeight)}onFullCardImageLoad(){!this.cardImageElement||(this.naturalWidth=this.cardImageElement.nativeElement.naturalWidth,this.naturalHeight=this.cardImageElement.nativeElement.naturalHeight)}get imageAreaRect(){return this.calcImageAreaRect(250,330,8)}get fullImageAreaRect(){return this.calcImageAreaRect(document.documentElement.clientWidth,document.documentElement.offsetHeight,16)}calcImageAreaRect(e,i,r){const o={width:0,height:0,top:r,left:r,scale:1};if(0==this.naturalWidth||0==this.naturalHeight)return o;const s=e-2*r,a=i-2*r;this.naturalHeight*s/this.naturalWidth>a?(o.width=this.naturalWidth*a/this.naturalHeight,o.height=a,o.left=r+(s-o.width)/2):(o.width=s,o.height=this.naturalHeight*s/this.naturalWidth,o.top=r+(a-o.height)/2);let h=null;return this.tabletopObject instanceof ai?h=this.tabletopObject.topCard:this.tabletopObject instanceof Qn&&(h=this.tabletopObject),h&&(o.scale=o.width/(h.size*this.gridSize),o.width=h.size*this.gridSize,o.height=o.width*this.naturalHeight/this.naturalWidth),o}get cardColor(){let e=null;return this.tabletopObject instanceof ai?e=this.tabletopObject.topCard:this.tabletopObject instanceof Qn&&(e=this.tabletopObject),e?e.color:"#555555"}get cardFontSize(){let e=null;return this.tabletopObject instanceof ai?e=this.tabletopObject.topCard:this.tabletopObject instanceof Qn&&(e=this.tabletopObject),e?e.fontsize+9:18}get cardText(){let e=null;return this.tabletopObject instanceof ai?e=this.tabletopObject.topCard:this.tabletopObject instanceof Qn&&(e=this.tabletopObject),e?pt.rubyToHtml(pt.escapeHtml(e.text)):""}get cardTextShadowCss(){const e=pt.textShadowColor(this.cardColor);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}get rangeElms(){let e=[];return!this.tabletopObject||!(this.tabletopObject instanceof vi)||!this.tabletopObject.commonDataElement||(this.tabletopObject.commonDataElement.getFirstElementByName("length")&&e.push(this.tabletopObject.commonDataElement.getFirstElementByName("length")),("CORN"===this.tabletopObject.type||"LINE"===this.tabletopObject.type)&&this.tabletopObject.commonDataElement.getFirstElementByName("width")&&e.push(this.tabletopObject.commonDataElement.getFirstElementByName("width")),this.tabletopObject.commonDataElement.getFirstElementByName("opacity")&&e.push(this.tabletopObject.commonDataElement.getFirstElementByName("opacity"))),e}get isNoLogging(){return this.tabletopObject instanceof Qn?!this.tabletopObject.isFront:this.tabletopObject instanceof xr&&this.tabletopObject.hasOwner}get isSelected(){return this.textAreaElementRef&&document.activeElement===this.textAreaElementRef.nativeElement}adjustedRubiedNote(e,i=!0){if(!e)return"";let r=pt.escapeHtml(e);return i&&(r=pt.rubyToHtml(r)),r.lastIndexOf("\n")==r.length-1?r+"\n":r}textAreaActivate(){this.textAreaElementRef&&this.textAreaElementRef.nativeElement&&this.textAreaElementRef.nativeElement.focus()}}return t.\u0275fac=function(e){return new(e||t)(He(Bv),He(Ki),He(Ci),He(Yn))},t.\u0275cmp=fn({type:t,selectors:[["overview-panel"]],viewQuery:function(e,i){if(1&e&&(wn(uJ,7),wn(dJ,5),wn(fJ,5),wn(hJ,5)),2&e){let r;Cn(r=xn())&&(i.draggablePanel=r.first),Cn(r=xn())&&(i.cardImageElement=r.first),Cn(r=xn())&&(i.fullCardImageElement=r.first),Cn(r=xn())&&(i.textAreaElementRef=r.first)}},inputs:{tabletopObject:"tabletopObject",left:"left",top:"top"},decls:28,vars:10,consts:[["appDraggable","",1,"component","is-pointer-events-none"],["draggablePanel",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngIf"],["overviewCard",""],["overviewNote",""],["overviewCharacter",""],["overviewDiceSymbol",""],["overviewRange",""],["overviewTabletop",""],["dataElement",""],["imageView",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngTemplateOutlet"],[1,"component-content","is-small-size",3,"ngClass"],["style","position: relative;",4,"ngIf"],[1,"component-title","title-background",3,"ngClass"],[1,"component-background"],["class","grid-container-root",4,"ngIf"],[2,"position","relative"],["class","text","style","z-index: 5; top: 8px",3,"width","height","left","ngStyle",4,"ngIf"],["draggable","false",1,"card-image",3,"src","load"],["cardImage",""],[1,"zoom-button",2,"z-index","10",3,"click"],[1,"material-icons"],["class","component-owner position-right-bottom","style","z-index: 10",3,"ngClass",4,"ngIf"],[1,"text",2,"z-index","5","top","8px",3,"ngStyle"],[3,"innerHTML"],[1,"component-owner","position-right-bottom",2,"z-index","10",3,"ngClass"],[1,"owner-tag"],[1,"grid-container-root"],[1,"grid-container"],[4,"ngFor","ngForOf"],[1,"component-content","is-large-size",3,"ngClass"],[1,"component-title","title-background"],[1,"component-background","text-note-container"],[2,"position","relative",3,"mousedown"],[1,"is-fill"],["spellcheck","false",1,"textarea",2,"resize","none",3,"ngModel","ngClass","ngModelChange"],["textArea",""],[1,"note-text",2,"pointer-events","none","position","absolute",3,"innerHTML","ngClass"],[1,"textarea-spacer",2,"pointer-events","none",3,"innerHTML"],[1,"component-content","character-grid-container","is-middle-size"],[1,"title-bg-area","title-background",3,"ngClass"],["class","image-area character-image-box",3,"ngClass",4,"ngIf"],[1,"title-area","component-title",3,"ngClass"],[1,"void-area","is-pointer-events-none"],[1,"dataElm-area","component-background",3,"ngClass"],[1,"image-area","character-image-box",3,"ngClass"],[3,"ngStyle"],[1,"inverser",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"character-image",2,"pointer-events","none",3,"ngClass","src"],[1,"character-image",2,"pointer-events","none",3,"src"],["class","owner-name-area component-owner",3,"ngClass",4,"ngIf"],[1,"owner-name-area","component-owner",3,"ngClass"],["draggable","false",1,"character-image",3,"ngClass","src"],["class","section border","style","padding-top: 2px",4,"ngIf"],[1,"tag",2,"min-width","100px"],[1,"value"],[2,"display","inline-block","width","min-content"],[1,"hidden-spacer",2,"margin-right","2em"],["type","number","step","0.1","size","1",1,"input",2,"width","4em",3,"ngModel","ngModelChange"],[1,"section",2,"line-height","1em"],["type","range","max","12","step","0.5",3,"title","min","ngModel","ngModelChange"],["type","number","size","1",1,"input",2,"width","4em",3,"ngModel","ngModelChange"],[1,"move",2,"font-size","small"],["type","range","min","0","max","100",3,"title","ngModel","ngModelChange"],[1,"tag"],[1,"value",2,"margin-top","3px","pointer-events","none"],[1,"inverser",2,"min-width","32px","min-height","32px","max-width","32px","max-height","32px","margin-left","auto","margin-right","0px",3,"ngClass"],[1,"aura-following",3,"ngClass"],["draggable","false",1,"character-image",2,"pointer-events","none",3,"ngClass","src"],[1,"section","border",2,"padding-top","2px"],[4,"ngIf","ngIfThen","ngIfElse"],["thenBlock",""],["elseBlock",""],[1,"section",2,"padding-top","0.5em"],["class","section-text",4,"ngIf"],[1,"grid-container","indetnt"],[1,"section-text"],[1,"section","border"],[1,"section"],[1,"note",2,"position","relative"],["spellcheck","false",1,"textarea",3,"ngModel","ngModelChange"],[1,"textarea-spacer"],[1,"hidden-spacer"],["appLogging","","size","1",1,"input",2,"width","4em",3,"logging.name","logging.dataElement","logging.disable","type","ngModel","ngModelChange"],["appLogging","","type","number","size","1",1,"input",2,"width","4em",3,"logging.name","logging.dataElement","logging.disable","ngModel","ngModelChange"],[2,"display","inline"],["appLogging","","type","range","min","0",3,"logging.name","logging.dataElement","logging.disable","title","max","ngModel","ngModelChange"],["appLogging","","type","checkbox",2,"width","2em","margin-right","1em",3,"logging.name","logging.dataElement","logging.disable","ngModel","checked","ngModelChange","change"],["style","font-size: smaller;",4,"ngIf"],[2,"font-size","smaller"],["type","url","size","1",1,"input",2,"width","calc(8em - 1.6rem)",3,"ngModel","ngModelChange"],[1,"link",2,"width","1.6rem",3,"click"],[1,"material-icons",2,"font-size","1.0rem"],["class","tag",4,"ngIf"],["class","hidden-spacer",4,"ngIf"],["size","1",1,"input",3,"ngStyle","type","min","ngModel","ngModelChange"],[1,"image-view-background","is-fill",3,"click"],["class","text","style","z-index: 5",3,"width","height","left","top","ngStyle",4,"ngIf"],[1,"close-button","is-pointer-events-none",2,"z-index","10"],["draggable","false",1,"contain-image",3,"src"],["fullCardImage",""],[1,"text",2,"z-index","5",3,"ngStyle"]],template:function(e,i){1&e&&(Q(0,"div",0,1),it(2,2),Te(3,pJ,1,0,"ng-container",3),Te(4,mJ,2,4,"ng-container",3),Te(5,$J,2,4,"ng-container",3),Te(6,yJ,2,4,"ng-container",3),Te(7,xJ,2,4,"ng-container",3),Te(8,SJ,2,4,"ng-container",3),Te(9,kJ,2,4,"ng-container",3),Te(10,PJ,2,4,"ng-container",4),rt(),ne(),Te(11,OJ,2,1,"ng-container",5),Te(12,GJ,8,12,"ng-template",null,6,ti),Te(14,KJ,12,20,"ng-template",null,7,ti),Te(16,ree,8,15,"ng-template",null,8,ti),Te(18,gee,11,18,"ng-template",null,9,ti),Te(20,Eee,7,14,"ng-template",null,10,ti),Te(22,Mee,9,14,"ng-template",null,11,ti),Te(24,Wee,5,3,"ng-template",null,12,ti),Te(26,Yee,8,6,"ng-template",null,13,ti)),2&e&&(oe("@fadeInOut","in"),G(2),oe("ngSwitch",i.tabletopObject.aliasName),G(1),oe("ngSwitchCase","numberResource"),G(1),oe("ngSwitchCase","card"),G(1),oe("ngSwitchCase","card-stack"),G(1),oe("ngSwitchCase","text-note"),G(1),oe("ngSwitchCase","character"),G(1),oe("ngSwitchCase","dice-symbol"),G(1),oe("ngSwitchCase","range"),G(2),oe("ngIf",i.isOpenImageView))},dependencies:[si,_i,Bn,Jl,fr,Ql,Zd,Xd,Ii,Fo,Ro,Oo,Mi,yi,hv,hs,$i],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;max-height:100%;max-width:100%;box-sizing:border-box;overflow:visible;color:#444;z-index:9000;overscroll-behavior:contain;-webkit-overflow-scrolling:touch;cursor:grab}.component-content[_ngcontent-%COMP%]{font-size:12px}.is-large-size[_ngcontent-%COMP%]{max-width:350px}.is-middle-size[_ngcontent-%COMP%]{max-width:270px}.is-small-size[_ngcontent-%COMP%]{max-width:250px}.is-middle-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:270px}.is-small-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:250px}.component-background[_ngcontent-%COMP%]{background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border-bottom:solid 1px #999}.component-title[_ngcontent-%COMP%]{color:#ccc;font-size:1em;text-align:right;vertical-align:middle;height:32px;line-height:32px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 1em}.title-background[_ngcontent-%COMP%]{background-color:#555;border-top:solid 1px #999;border-left:solid 1px #999;border-right:solid 1px #999}.component-owner[_ngcontent-%COMP%]{font-size:.8em;color:#ccc;vertical-align:middle;overflow:hidden;text-align:right;padding:2px 1em;max-width:100%;box-sizing:border-box}.owner-tag[_ngcontent-%COMP%]{width:-moz-min-content;width:min-content;max-width:100%;margin-left:auto;margin-right:0;overflow:hidden;color:#f5f5f5;background-color:#1e1e1e;box-sizing:border-box;padding:3px 9px;border-radius:6px;white-space:nowrap;text-overflow:ellipsis;opacity:.9}.card-image[_ngcontent-%COMP%]{width:250px;max-height:330px;padding:8px;vertical-align:bottom;-o-object-fit:contain;object-fit:contain;box-sizing:border-box;background-color:#cccccc80}.zoom-button[_ngcontent-%COMP%]{position:absolute;left:8px;bottom:-21px;width:42px;height:42px;border-radius:100px;padding:4px}.zoom-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:24px;vertical-align:bottom}.position-right-bottom[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0}.image-view-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1e4d;z-index:9900}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{position:absolute;right:16px;top:16px}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:36px}.contain-image[_ngcontent-%COMP%]{width:100%;height:100%;box-sizing:border-box;padding:16px;vertical-align:bottom;-o-object-fit:contain;object-fit:contain}.text-note-container[_ngcontent-%COMP%]{width:100%;max-height:400px;padding:.6em 1.2em;box-sizing:border-box;overflow:hidden auto;line-height:1.8;border-left:solid 1px #999;border-right:solid 1px #999}.character-image-box[_ngcontent-%COMP%]{width:100px;vertical-align:bottom;margin-left:.5em;margin-bottom:-6px;z-index:1;overflow:visible}.character-image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:150px;vertical-align:bottom;-o-object-fit:contain;object-fit:contain;-o-object-position:bottom center;object-position:bottom center}.character-image-box.has-icon[_ngcontent-%COMP%]{width:100px;height:100px;max-width:100px;max-height:100px;transform:translateY(-16px);margin-top:16px}.character-image-box.has-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:1em}.character-image[_ngcontent-%COMP%]{padding:0;width:100%;vertical-align:bottom}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.character-grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:min-content auto;grid-template-rows:1fr auto auto auto}.title-bg-area[_ngcontent-%COMP%]{grid-area:3 / 1 / 4 / 3}.title-area[_ngcontent-%COMP%]{grid-area:3 / 2 / 4 / 3}.owner-name-area[_ngcontent-%COMP%]{grid-area:2 / 2 / 3 / 3}.image-area[_ngcontent-%COMP%]{grid-area:1 / 1 / 4 / 2}.void-area[_ngcontent-%COMP%]{grid-area:1 / 2 / 3 / 3}.dataElm-area[_ngcontent-%COMP%]{grid-area:4 / 1 / 5 / 3}.grid-container-root[_ngcontent-%COMP%]{padding:.5em 1.2em;max-height:250px;overflow:hidden auto;box-sizing:border-box;border-left:solid 1px #999;border-right:solid 1px #999}.grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr fit-content(80%)}.grid-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{box-sizing:border-box;line-height:24px}.indetnt[_ngcontent-%COMP%]{padding-left:.5em}.section[_ngcontent-%COMP%]{max-width:100%;grid-column:1 / span 2}.section-text[_ngcontent-%COMP%]{font-size:1.1em;font-weight:700;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.note[_ngcontent-%COMP%]{margin-left:.5em;font-size:1em;line-height:1.8}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box;resize:none;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.textarea[_ngcontent-%COMP%]:hover{background:#EEE}.textarea[_ngcontent-%COMP%]:focus{background:#FFF}.tag[_ngcontent-%COMP%]{padding-right:1em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;min-width:7em}.value[_ngcontent-%COMP%]{font-size:1.2em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;text-align:right}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0px;min-width:3em;overflow:hidden;white-space:pre-wrap}.textarea-spacer[_ngcontent-%COMP%]{visibility:hidden;min-width:3em;height:auto;min-height:24px;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.input[_ngcontent-%COMP%]{min-width:3em;text-align:right;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#EEE}.input[_ngcontent-%COMP%]:focus{background:#FFF}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}.border[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.separator[_ngcontent-%COMP%]{padding:2px 0;border-bottom:1px solid #888}.with-button-marign[_ngcontent-%COMP%]{padding-left:60px}.is-fill[_ngcontent-%COMP%]{position:absolute;inset:0}.is-bold[_ngcontent-%COMP%]{font-weight:700}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #fff)}.aura-following.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px black)}.aura-following.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #33f)}.aura-following.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3f3)}.aura-following.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3ff)}.aura-following.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f00)}.aura-following.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f0f)}.aura-following.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #ff3)}.aura-following.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #fff)}button.link[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}button.link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button.link[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}button.link[_ngcontent-%COMP%]:disabled{color:gray}button.link[_ngcontent-%COMP%]:disabled:hover{background-color:transparent}.text[_ngcontent-%COMP%]{transform-origin:left top;position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.hide-area[_ngcontent-%COMP%]{overflow:hidden!important;font-size:0pt!important;width:0px!important;height:0px!important;margin:0!important;padding:0!important;border:0px none!important}.note-text[_ngcontent-%COMP%]{color:#444;min-width:3em;height:auto;min-height:24px;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.hide-text-area[_ngcontent-%COMP%]{color:transparent}input[_ngcontent-%COMP%] + .move[_ngcontent-%COMP%]{display:inline-block;transform:translate(-1em);transition:transform 18ms}input[_ngcontent-%COMP%]:hover + .move[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:active + .move[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:focus + .move[_ngcontent-%COMP%]{display:inline-block;transform:translate(0);transition:transform 18ms}@supports (-moz-user-select: -moz-none){input[_ngcontent-%COMP%] + .move[_ngcontent-%COMP%]{transform:translate(0)}}"],data:{animation:[Vn("fadeInOut",[tn("void => *",[Zt("100ms ease-out",bn([dt({opacity:0,offset:0}),dt({opacity:1,offset:1})]))]),tn("* => void",[Zt("100ms ease-in",bn([dt({opacity:1,offset:0}),dt({opacity:0,offset:1})]))])])]},changeDetection:0}),t})(),XI=(()=>{class t{constructor(e,i,r){this.ngZone=e,this.viewContainerRef=i,this.pointerDeviceService=r,this.callbackOnMouseEnter=o=>this.onMouseEnter(o),this.callbackOnMouseLeave=o=>this.onMouseLeave(o),this.callbackOnMouseDown=o=>this.onMouseDown(o)}ngOnInit(){}ngAfterViewInit(){this.addEventListeners(this.viewContainerRef.element.nativeElement)}ngOnDestroy(){this.removeEventListeners(this.viewContainerRef.element.nativeElement),this.clearTimer(),this.close()}onMouseEnter(e){this.clearTimer(),this.tooltipComponentRef||this.startOpenTimer()}onMouseLeave(e){this.clearTimer(),this.tooltipComponentRef&&this.startCloseTimer()}onMouseDown(e){!this.tooltipComponentRef||!this.tooltipComponentRef.location.nativeElement.contains(e.target)&&!this.viewContainerRef.element.nativeElement.contains(e.target)&&this.ngZone.run(()=>this.closeAll())}startOpenTimer(){let e=this.pointerDeviceService.pointerX,i=this.pointerDeviceService.pointerY;this.openTooltipTimer=setTimeout(()=>{this.openTooltipTimer=null,4<(e-this.pointerDeviceService.pointerX)**2+(i-this.pointerDeviceService.pointerY)**2?this.startOpenTimer():this.ngZone.run(()=>this.open())},100)}startCloseTimer(){this.closeTooltipTimer=setTimeout(()=>{this.closeTooltipTimer=null,this.tooltipComponentRef&&this.tooltipComponentRef.location.nativeElement.contains(document.activeElement)?this.startCloseTimer():this.ngZone.run(()=>this.closeAll())},400)}clearTimer(){this.closeTooltipTimer&&clearTimeout(this.closeTooltipTimer),this.openTooltipTimer&&clearTimeout(this.openTooltipTimer),this.closeTooltipTimer=this.openTooltipTimer=null}open(){if(this.closeAll(),this.pointerDeviceService.isDragging)return;let e=hr.defaultParentViewContainerRef;this.tooltipComponentRef=e.createComponent(Zee,{index:e.length,injector:e.injector}),this.tooltipComponentRef.instance.tabletopObject=this.tabletopObject,this.tooltipComponentRef.instance.left=this.pointerDeviceService.pointerX,this.tooltipComponentRef.instance.top=this.pointerDeviceService.pointerY,this.addEventListeners(this.tooltipComponentRef.location.nativeElement),this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.addEventListener("mousedown",this.callbackOnMouseDown,!0)}),Ue.register(this).on("DELETE_GAME_OBJECT",i=>{this.tabletopObject&&this.tabletopObject.identifier===i.data.identifier&&this.closeAll()}),this.tooltipComponentRef.onDestroy(()=>{this.removeEventListeners(this.tooltipComponentRef.location.nativeElement),document.body.removeEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.removeEventListener("mousedown",this.callbackOnMouseDown,!0),this.clearTimer(),this.tooltipComponentRef=null,Ue.unregister(this)}),t.activeTooltips.push(this.tooltipComponentRef)}close(){if(!this.tooltipComponentRef)return;let e=t.activeTooltips.indexOf(this.tooltipComponentRef);0<=e&&t.activeTooltips.splice(e,1),this.tooltipComponentRef.destroy(),this.tooltipComponentRef=null}closeAll(){t.activeTooltips.forEach(e=>e.destroy()),t.activeTooltips=[],this.close()}addEventListeners(e){this.ngZone.runOutsideAngular(()=>{e.addEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.addEventListener("mouseleave",this.callbackOnMouseLeave,!1)})}removeEventListeners(e){e.removeEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.removeEventListener("mouseleave",this.callbackOnMouseLeave,!1)}}return t.activeTooltips=[],t.\u0275fac=function(e){return new(e||t)(He(Nn),He(no),He(Ci))},t.\u0275dir=hn({type:t,selectors:[["","appTooltip",""]],inputs:{tabletopObject:["appTooltip","tabletopObject"]}}),t})();const Xee=["cardImage"],Qee=function(t){return{transform:t}};let Jee=(()=>{class t{constructor(){this.card=null,this.gridSize=50,this.naturalWidth=0,this.naturalHeight=0}ngOnInit(){}onCardImageLoad(){!this.cardImageElement||(this.naturalWidth=this.cardImageElement.nativeElement.naturalWidth,this.naturalHeight=this.cardImageElement.nativeElement.naturalHeight)}get rubiedText(){return this.card?pt.rubyToHtml(pt.escapeHtml(this.card.text)):""}get imageAreaRect(){return this.calcImageAreaRect(64,64,0)}calcImageAreaRect(e,i,r){const o={width:0,height:0,top:r,left:r,scale:1};if(0==this.naturalWidth||0==this.naturalHeight)return o;const s=e-2*r,a=i-2*r;return this.naturalHeight*s/this.naturalWidth>a?(o.width=this.naturalWidth*a/this.naturalHeight,o.height=a,o.left=r+(s-o.width)/2):(o.width=s,o.height=this.naturalHeight*s/this.naturalWidth,o.top=r+(a-o.height)/2),this.card&&(o.scale=o.width/(this.card.size*this.gridSize),o.width=this.card.size*this.gridSize,o.height=o.width*this.naturalHeight/this.naturalWidth),o}get cardColor(){return this.card?this.card.color:"#555555"}get cardFontSize(){return this.card?this.card.fontsize+9:18}get cardText(){return this.card?this.card.text:""}get textShadowCss(){const e=pt.textShadowColor(this.cardColor);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=fn({type:t,selectors:[["card-list-image"]],viewQuery:function(e,i){if(1&e&&wn(Xee,7),2&e){let r;Cn(r=xn())&&(i.cardImageElement=r.first)}},inputs:{card:"card"},decls:11,vars:30,consts:[[1,"image-box",2,"position","relative",3,"appTooltip"],[1,"text",2,"z-index","5",3,"ngStyle"],[3,"innerHTML"],[1,"image","contain"],[3,"src","load"],["cardImage",""],[3,"src"]],template:function(e,i){1&e&&(Q(0,"div",0)(1,"div",1),mt(2,"div",2),Lt(3,"safe"),ne(),Q(4,"div",3)(5,"img",4,5),Ae("load",function(){return i.onCardImageLoad()}),Lt(7,"safe"),ne()(),Q(8,"div",3),mt(9,"img",6),Lt(10,"safe"),ne()()),2&e&&(oe("appTooltip",i.card),G(1),ut("width",i.imageAreaRect.width,"px")("height",i.imageAreaRect.height,"px")("left",i.imageAreaRect.left,"px")("top",i.imageAreaRect.top,"px"),oe("ngStyle",wt(28,Qee,"scale("+i.imageAreaRect.scale+")")),G(1),ut("font-size",i.cardFontSize,"px")("color",i.cardColor)("text-shadow",i.textShadowCss),oe("innerHTML",Bt(3,19,i.rubiedText,"html"),lr),G(3),oe("src",Bt(7,22,null==i.card||null==i.card.frontImage?null:i.card.frontImage.url,"resourceUrl"),vn),G(4),oe("src",Bt(10,25,null==i.card||null==i.card.backImage?null:i.card.backImage.url,"resourceUrl"),vn))},dependencies:[fr,XI,$i],styles:[".image-box[_ngcontent-%COMP%]{display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:64px;height:64px;-o-object-fit:contain;object-fit:contain}.text[_ngcontent-%COMP%]{transform-origin:left top;position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}"]}),t})();function ete(t,n){if(1&t){const e=ft();Q(0,"div",2),mt(1,"card-list-image",3),Q(2,"div",4)(3,"button",5),Ae("click",function(){const o=Re(e).$implicit;return Le(me().drawCard(o))}),ve(4,"\u5c71\u672d\u304b\u3089\u51fa\u3059"),ne(),Q(5,"button",0),Ae("click",function(){const o=Re(e).$implicit;return Le(me().showDetail(o))}),Q(6,"i",6),ve(7,"settings"),ne(),ve(8,"\u7de8\u96c6"),ne(),mt(9,"br"),Q(10,"button",0),Ae("click",function(){const o=Re(e).$implicit;return Le(me().up(o))}),ve(11,"\u2191"),ne(),Q(12,"button",0),Ae("click",function(){const o=Re(e).$implicit;return Le(me().down(o))}),ve(13,"\u2193"),ne(),mt(14,"br"),ne()()}if(2&t){const e=n.$implicit;G(1),oe("card",e)}}let tte=(()=>{class t{constructor(e,i,r){this.panelService=e,this.changeDetector=i,this.chatMessageService=r,this.cardStack=null,this.owner=Ot.peerContext.userId}ngOnInit(){Promise.resolve().then(()=>this.panelService.title=this.cardStack.name+" \u306e\u30ab\u30fc\u30c9\u4e00\u89a7"),Ue.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Ct.instance.get(e.data.identifier);!this.cardStack||!i||((this.cardStack===i||i instanceof ni&&this.cardStack.contains(i))&&this.changeDetector.markForCheck(),e.data.identifier===this.cardStack.identifier&&this.cardStack.owner!==this.owner&&this.panelService.close())}).on("DELETE_GAME_OBJECT",e=>{this.cardStack&&this.cardStack.identifier===e.data.identifier&&this.panelService.close()})}ngOnDestroy(){Ue.unregister(this),this.cardStack.owner===this.owner&&(this.cardStack.owner="")}drawCard(e){e.parent.removeChild(e),e.location.x=this.cardStack.location.x+100+50*Math.random(),e.location.y=this.cardStack.location.y+25+50*Math.random(),e.location.name=this.cardStack.location.name,e.rotate+=this.cardStack.rotate,360<e.rotate&&(e.rotate-=360),e.toTopmost(),Et.play(st.cardDraw),this.chatMessageService.sendOperationLog(e.isFront?`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${""==e.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":e.name} \u3092\u53d6\u308a\u51fa\u3057\u305f`:`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 1\u679a\u53d6\u308a\u51fa\u3057\u3066\u4f0f\u305b\u305f`)}up(e){let i=e.parent,r=i.children.indexOf(e);0<r&&i.insertBefore(e,i.children[r-1])}down(e){let i=e.parent,r=i.children.indexOf(e);r<i.children.length-1&&i.insertBefore(i.children[r+1],e)}close(e=!1){e&&(this.cardStack.shuffle(),Ue.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier}),Et.play(st.cardShuffle)),this.panelService.close()}showDetail(e){let r="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(ps,{title:r,left:this.panelService.left+10,top:this.panelService.top+20,width:600,height:600}).tabletopObject=e}trackByCard(e,i){return i.identifier}}return t.\u0275fac=function(e){return new(e||t)(He(qn),He(Ki),He(Hr))},t.\u0275cmp=fn({type:t,selectors:[["card-stack-list"]],inputs:{cardStack:"cardStack"},decls:5,vars:2,consts:[[3,"click"],["class","box",4,"ngFor","ngForOf","ngForTrackBy"],[1,"box"],[3,"card"],[2,"display","inline-block"],["type","submit",3,"click"],[1,"material-icons",2,"font-size","1.1em","vertical-align","text-bottom"]],template:function(e,i){1&e&&(Q(0,"div")(1,"button",0),Ae("click",function(){return i.close(!0)}),ve(2,"\u30b7\u30e3\u30c3\u30d5\u30eb\u3057\u3066\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b"),ne(),mt(3,"hr"),Te(4,ete,15,1,"div",1),ne()),2&e&&(G(4),oe("ngForOf",i.cardStack.cards)("ngForTrackBy",i.trackByCard))},dependencies:[_i,Jee],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image-box[_ngcontent-%COMP%]{display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}"],changeDetection:0}),t})();const Hv=function(t){return{transform:t}};function nte(t,n){if(1&t&&(Q(0,"div",9),mt(1,"div",10),Lt(2,"safe"),ne()),2&t){const e=me(2);oe("ngStyle",wt(11,Hv,"rotateZ("+e.topCard.rotate+"deg)")),G(1),ut("font-size",e.topCard.fontsize+9,"px")("color",e.topCard.color)("text-shadow",e.textShadowCss(e.topCard.color)),oe("innerHTML",Bt(2,8,e.rubiedText,"html"),lr)}}function ite(t,n){if(1&t){const e=ft();Q(0,"div",6),Ae("@shuffle.start",function(r){return Re(e),Le(me().animationShuffleStarted(r))})("@shuffle.done",function(r){return Re(e),Le(me().animationShuffleDone(r))}),Te(1,nte,3,13,"div",7),mt(2,"img",8),Lt(3,"safe"),ne()}if(2&t){const e=me();oe("@bounceInOut",void 0)("@shuffle",e.animeState),G(1),oe("ngIf",e.topCard.isFront),G(1),oe("ngStyle",wt(8,Hv,"rotateZ("+e.topCard.rotate+"deg)"))("src",Bt(3,5,e.imageFile.url,"resourceUrl"),vn)}}function rte(t,n){if(1&t&&(it(0),Q(1,"div",11)(2,"i",12),ve(3),ne()(),Q(4,"div",13)(5,"i",12),ve(6),ne()(),Q(7,"div",14)(8,"i",12),ve(9),ne()(),Q(10,"div",15)(11,"i",12),ve(12),ne()(),rt()),2&t){const e=me();G(3),lt(e.isLocked?"lock":"autorenew"),G(3),lt(e.isLocked?"lock":"autorenew"),G(3),lt(e.isLocked?"lock":"autorenew"),G(3),lt(e.isLocked?"lock":"autorenew")}}const QI=function(t){return{"is-inverse":t}};function ote(t,n){if(1&t&&(Q(0,"div",16)(1,"span",17),ve(2),ne()()),2&t){const e=me();oe("ngStyle",wt(3,Hv,"translateY(-50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateZ("+(e.isInverse?180:0)+"deg)")),G(1),oe("ngClass",wt(5,QI,e.isInverse)),G(1),Zn("",e.cards.length,"\u679a")}}const ste=function(t,n){return{"background-color":t,transform:n}};function ate(t,n){if(1&t&&(Q(0,"div",18)(1,"span",17)(2,"b"),ve(3),ne(),ve(4," \u304c\u78ba\u8a8d\u4e2d"),ne()()),2&t){const e=me();oe("ngStyle",un(3,ste,e.ownerColor,"translateY(50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateZ("+(e.isInverse?180:0)+"deg)")),G(1),oe("ngClass",wt(6,QI,e.isInverse)),G(2),lt(e.ownerName)}}const lte=function(t){return{"is-empty":t}},cte=function(t){return{"is-grab":t}};let ute=(()=>{class t{constructor(e,i,r,o,s,a,h,b,ee){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.elementRef=o,this.changeDetector=s,this.imageService=a,this.pointerDeviceService=h,this.modalService=b,this.chatMessageService=ee,this.cardStack=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.viewRotateZ=10,this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null}get name(){return this.cardStack.name}get rotate(){return this.cardStack.rotate}set rotate(e){this.cardStack.rotate=e}get zindex(){return this.cardStack.zindex}get isShowTotal(){return this.cardStack.isShowTotal}get cards(){return this.cardStack.cards}get isEmpty(){return this.cardStack.isEmpty}get size(){let e=this.cardStack.topCard;return e?e.size:2}get hasOwner(){return this.cardStack.hasOwner}get ownerIsOnline(){return this.cardStack.ownerIsOnline}get ownerName(){return this.cardStack.ownerName}get ownerColor(){return this.cardStack.ownerColor}get topCard(){return this.cardStack.topCard}get imageFile(){return this.imageService.getSkeletonOr(this.cardStack.imageFile)}get isIconHidden(){return null!=this.iconHiddenTimer}get rubiedText(){return pt.rubyToHtml(pt.escapeHtml(this.topCard.text))}get isLocked(){return!!this.cardStack&&this.cardStack.isLocked}set isLocked(e){this.cardStack&&(this.cardStack.isLocked=e)}get isInverse(){const e=Math.abs(this.viewRotateZ+this.rotate)%360;return 90<e&&e<270}ngOnInit(){Ue.register(this).on("SHUFFLE_CARD_STACK",e=>{e.data.identifier===this.cardStack.identifier&&(this.animeState="active",this.changeDetector.markForCheck())}).on("INVERSE_CARD_STACK",e=>{e.data.identifier===this.cardStack.identifier&&(this.animeState="inverse",this.changeDetector.markForCheck())}).on("UPDATE_GAME_OBJECT",e=>{let i=Ct.instance.get(e.data.identifier);!this.cardStack||!i||(this.cardStack===i||i instanceof ni&&this.cardStack.contains(i)||i instanceof Qe&&i.userId===this.cardStack.owner)&&this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on("CARD_STACK_DECREASED",e=>{e.data.cardStackIdentifier===this.cardStack.identifier&&this.cardStack&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=Qe.findByPeerId(e.data.peerId);(!i||this.cardStack.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.cardStack,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain","text-note"]},this.rotableOption={tabletopObject:this.cardStack}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new ls(this.elementRef.nativeElement)}),this.input.onStart=e=>this.ngZone.run(()=>this.onInputStart(e))}ngOnDestroy(){this.input.destroy(),Ue.unregister(this)}animationShuffleStarted(e){}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onCardDrop(e){if(this.cardStack!==e.detail&&(e.detail instanceof Qn||e.detail instanceof ai))if(e.stopPropagation(),e.preventDefault(),e.detail instanceof Qn){let i=e.detail;(i.location.x-this.cardStack.location.x)**2+(i.location.y-this.cardStack.location.y)**2+(i.posZ-this.cardStack.posZ)**2<2500&&(this.chatMessageService.sendOperationLog(`${i.isFront?""==i.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":i.name:"\u4f0f\u305b\u305f\u30ab\u30fc\u30c9"} \u3092 ${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306b\u4e57\u305b\u305f`),this.cardStack.putOnTop(i))}else if(e.detail instanceof ai){let i=e.detail;(i.location.x-this.cardStack.location.x)**2+(i.location.y-this.cardStack.location.y)**2+(i.posZ-this.cardStack.posZ)**2<625&&(this.chatMessageService.sendOperationLog(`${""==i.name?"(\u7121\u540d\u306e\u5c71\u672d)":i.name} \u3092\u5168\u3066 ${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306b\u4e57\u305b\u305f`),this.concatStack(i))}}startDoubleClickTimer(e){if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(()=>this.stopDoubleClickTimer(),e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}stopDoubleClickTimer(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}onDoubleClick(){if(this.stopDoubleClickTimer(),(this.doubleClickPoint.x-this.input.pointer.x)**2+(this.doubleClickPoint.y-this.input.pointer.y)**2<100){console.log("onDoubleClick !!!!");const i=this.drawCard();if(i){let r;Et.play(st.cardDraw),r=i.isFront?`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${""==i.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":i.name} \u3092\u5f15\u3044\u305f`:`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 1\u679a\u5f15\u3044\u3066\u4f0f\u305b\u305f`,this.chatMessageService.sendOperationLog(r)}}}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.startDoubleClickTimer(e),this.cardStack.toTopmost(),this.startIconHiddenTimer(),this.isLocked&&Ue.trigger("DRAG_LOCKED_OBJECT",{}),Ue.trigger("SELECT_TABLETOP_OBJECT",{identifier:this.cardStack.identifier,className:"GameCharacter"})}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,Et.play(st.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,Et.play(st.lock)}},Ht,{name:"\u30ab\u30fc\u30c9\u3092\uff11\u679a\u5f15\u304f",action:()=>{const r=this.drawCard();if(r){let o;Et.play(st.cardDraw),o=r.isFront?`${this.cardStack.name} \u304b\u3089 ${""==r.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":r.name} \u3092\u5f15\u3044\u305f`:`${this.cardStack.name} \u304b\u3089 1\u679a\u5f15\u3044\u3066\u4f0f\u305b\u305f`,this.chatMessageService.sendOperationLog(o)}},default:this.cards.length>0,disabled:0==this.cards.length},{name:"\u30ab\u30fc\u30c9\u3092\u5f15\u304f",action:null,subActions:[2,3,4,5,10].map(r=>({name:`${r}\u679a`,action:()=>{const o=[];for(let s=0;s<r;s++){const a=this.drawCard();a&&(o.push(a),(0==s||3==s||9==s)&&Et.play(st.cardDraw))}if(o.length>0){const s=o.filter(a=>a.isFront);if(0==s.length)this.chatMessageService.sendOperationLog(`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${o.length}\u679a\u5f15\u3044\u3066\u4f0f\u305b\u305f`);else{const a=new Map;for(const b of s){let ee=a.get(b.name)||0;ee+=1,a.set(""==b.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":b.name,ee)}let h=`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${[...a.keys()].map(b=>`${b} \u3092 ${a.get(b)}\u679a`).join("\u3001")}`;h+=s.length===o.length?"\u5f15\u3044\u305f":`\u5f15\u304d\u3001${o.length-s.length}\u679a\u3092\u4f0f\u305b\u305f`,this.chatMessageService.sendOperationLog(h)}}}})),disabled:0==this.cards.length},Ht,0!=this.cards.length&&this.cardStack.topCard.isFront?{name:"\u4e00\u756a\u4e0a\u3092\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDown(),Et.play(st.cardDraw)},disabled:0==this.cards.length}:{name:"\u4e00\u756a\u4e0a\u3092\u8868\u306b\u3059\u308b",action:()=>{!this.cardStack.topCard||(this.cardStack.topCard.isFront||this.chatMessageService.sendOperationLog(`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306e\u4e00\u756a\u4e0a\u306e ${""==this.cardStack.topCard.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.cardStack.topCard.name} \u3092\u516c\u958b\u3057\u305f`),this.cardStack.faceUp(),Et.play(st.cardDraw))},disabled:0==this.cards.length},Ht,{name:"\u3059\u3079\u3066\u8868\u306b\u3059\u308b",action:()=>{this.cardStack.faceUpAll(),Et.play(st.cardDraw)},disabled:0==this.cards.length},{name:"\u3059\u3079\u3066\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDownAll(),Et.play(st.cardDraw)},disabled:0==this.cards.length},{name:"\u3059\u3079\u3066\u6b63\u4f4d\u7f6e\u306b\u3059\u308b",action:()=>{this.cardStack.uprightAll(),Et.play(st.cardDraw)},disabled:0==this.cards.length},Ht,{name:"\u30b7\u30e3\u30c3\u30d5\u30eb",action:()=>{this.cardStack.shuffle(),Et.play(st.cardShuffle),Ue.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier})},disabled:0==this.cards.length},{name:"\u30ab\u30fc\u30c9\u4e00\u89a7\u3092\u898b\u308b...",action:()=>{this.showStackList(this.cardStack),this.chatMessageService.sendOperationLog(`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306e\u30ab\u30fc\u30c9\u4e00\u89a7\u3092\u898b\u305f`)},disabled:0==this.cards.length},Ht,this.isShowTotal?{name:"\u2611 \u679a\u6570\u3092\u8868\u793a",action:()=>{this.cardStack.isShowTotal=!1}}:{name:"\u2610 \u679a\u6570\u3092\u8868\u793a",action:()=>{this.cardStack.isShowTotal=!0}},{name:"\u30ab\u30fc\u30c9\u30b5\u30a4\u30ba\u3092\u63c3\u3048\u308b",action:()=>{this.cardStack.topCard&&this.cardStack.unifyCardsSize(this.cardStack.topCard.size)},disabled:0==this.cards.length},Ht,{name:"\u5c71\u672d\u3092\u5206\u5272\u3059\u308b",subActions:[{name:"\u4eba\u6570\u3067\u5206\u5272",action:()=>{this.splitStack(Ot.peerIds.length),Et.play(st.cardDraw)}},Ht,...[2,3,4,5,6].map(r=>({name:`${r}\u3064\u306b\u5206\u5272`,action:()=>{this.splitStack(r),Et.play(st.cardDraw)}}))],disabled:0==this.cards.length},{name:"\u5c71\u672d\u3092\u5d29\u3059",action:()=>{this.breakStack(),Et.play(st.cardShuffle)},disabled:0==this.cards.length},{name:"\u5c71\u672d\u5168\u4f53\u3092\u88cf\u8fd4\u3059",action:()=>{this.cardStack.inverse(),Et.play(st.cardDraw),Et.play(st.cardDraw),Ue.call("INVERSE_CARD_STACK",{identifier:this.cardStack.identifier})},disabled:0==this.cards.length},Ht,{name:"\u8a73\u7d30\u3092\u8868\u793a...",action:()=>{this.showDetail(this.cardStack)}},this.cardStack.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.cardStack.getUrls().map(r=>{const o=r.value.toString();return{name:r.name?r.name:o,action:()=>{pt.sameOrigin(o)?window.open(o.trim(),"_blank","noopener"):this.modalService.open(lo,{url:o,title:this.cardStack.name,subTitle:r.name})},disabled:!pt.validUrl(o),error:pt.validUrl(o)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:pt.validUrl(o)&&!pt.sameOrigin(o)}})},this.cardStack.getUrls().length<=0?null:Ht,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.cardStack.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.owner="",r.isLocked=!1,r.toTopmost(),Et.play(st.cardPut)}},{name:"\u5c71\u672d\u3092\u524a\u9664\u3059\u308b",action:()=>{this.cardStack.setLocation("graveyard"),this.cardStack.destroy(),Et.play(st.sweep)}}],this.name)}onMove(){Et.play(st.cardPick)}onMoved(){Et.play(st.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}drawCard(){let e=this.cardStack.drawCard();return e&&(this.cardStack.update(),e.location.x+=100+50*Math.random(),e.location.y+=25+50*Math.random(),e.setLocation(this.cardStack.location.name)),e}textShadowCss(e){const i=pt.textShadowColor(e);return`${i} 0px 0px 2px, \n    ${i} 0px 0px 2px, \n    ${i} 0px 0px 2px, \n    ${i} 0px 0px 2px, \n    ${i} 0px 0px 2px, \n    ${i} 0px 0px 2px,\n    ${i} 0px 0px 2px,\n    ${i} 0px 0px 2px`}breakStack(){let e=this.cardStack.drawCardAll().reverse();for(let i of e)i.location.x+=25-50*Math.random(),i.location.y+=25-50*Math.random(),i.toTopmost(),i.setLocation(this.cardStack.location.name);this.cardStack.setLocation("graveyard"),this.cardStack.destroy()}splitStack(e){if(e<2)return;let i=[];for(let a=0;a<e;a++){let h=ai.create(`${this.cardStack.name}_${("0"+(a+1).toString()).slice(-2)}`);h.location.x=this.cardStack.location.x+50-100*Math.random(),h.location.y=this.cardStack.location.y+50-100*Math.random(),h.posZ=this.cardStack.posZ,h.location.name=this.cardStack.location.name,h.rotate=this.rotate,h.toTopmost(),i.push(h)}let r=this.cardStack.drawCardAll();this.cardStack.setLocation("graveyard"),this.cardStack.destroy();let o=0,s=r.length/e*(o+1);for(let a=0;a<r.length;a++)i[o].putOnBottom(r[a]),s<=a+1&&(o++,s=r.length/e*(o+1))}concatStack(e,i=this.cardStack){let r=ai.create(i.name);r.location.name=i.location.name,r.location.x=i.location.x,r.location.y=i.location.y,r.posZ=i.posZ,r.zindex=e.zindex,r.rotate=i.rotate;let o=i.drawCardAll(),s=e.drawCardAll();for(let a of s.concat(o))r.putOnBottom(a);i.setLocation(""),i.destroy(),e.setLocation(""),e.destroy()}dispatchCardDropEvent(){let r=this.elementRef.nativeElement.parentElement.children,o=new CustomEvent("carddrop",{detail:this.cardStack,bubbles:!0});for(let s=0;s<r.length;s++)r[s].dispatchEvent(o)}showDetail(e){Ue.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5c71\u672d\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(ps,{title:r,left:i.x-300,top:i.y-300,width:600,height:490}).tabletopObject=e}showStackList(e){Ue.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r={left:i.x-200,top:i.y-300,width:400,height:600};this.cardStack.owner=Ot.peerContext.userId,this.panelService.open(tte,r).cardStack=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}}return t.\u0275fac=function(e){return new(e||t)(He(Nn),He(hr),He(qn),He(Ai),He(Ki),He(Zu),He(Ci),He(Yn),He(Hr))},t.\u0275cmp=fn({type:t,selectors:[["card-stack"]],hostBindings:function(e,i){1&e&&Ae("carddrop",function(o){return i.onCardDrop(o)})("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{cardStack:"cardStack",is3D:"is3D"},decls:6,vars:16,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-pointer-events-auto","is-3d",3,"ngClass","rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],["class","is-3d",4,"ngIf"],[4,"ngIf"],["class","name-tag is-nowrap is-black-background is-3d number-of-cards","style","z-index: 10",3,"ngStyle",4,"ngIf"],["class","name-tag has-length-limit is-nowrap is-black-background is-3d","style","z-index: 10; color: whitesmoke",3,"ngStyle",4,"ngIf"],[1,"is-3d"],["class","text is-3d","style","width: 100%; height: 100%",3,"ngStyle",4,"ngIf"],[1,"card-image","chrome-smooth-image-trick",3,"ngStyle","src"],[1,"text","is-3d",2,"width","100%","height","100%",3,"ngStyle"],[1,"is-3d",3,"innerHTML"],[1,"rotate-grab","of-left-top","is-3d"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","is-3d"],[1,"rotate-grab","of-right-bottom","is-3d"],[1,"rotate-grab","of-right-top","is-3d"],[1,"name-tag","is-nowrap","is-black-background","is-3d","number-of-cards",2,"z-index","10",3,"ngStyle"],[3,"ngClass"],[1,"name-tag","has-length-limit","is-nowrap","is-black-background","is-3d",2,"z-index","10","color","whitesmoke",3,"ngStyle"]],template:function(e,i){1&e&&(Q(0,"div",0),Ae("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),Q(1,"div",1),Ae("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Te(2,ite,4,10,"div",2),Te(3,rte,13,4,"ng-container",3),Te(4,ote,3,7,"div",4),Te(5,ate,5,8,"div",5),ne()()),2&e&&(ut("width",i.size*i.gridSize,"px"),oe("ngClass",wt(12,lte,i.isEmpty))("movable.option",i.movableOption)("movable.disable",i.isLocked),G(1),oe("ngClass",wt(14,cte,!i.isLocked))("rotable.option",i.rotableOption)("rotable.disable",i.isLocked),G(1),oe("ngIf",i.topCard&&i.imageFile),G(1),oe("ngIf",!i.isIconHidden),G(1),oe("ngIf",i.isShowTotal),G(1),oe("ngIf",i.ownerIsOnline))},dependencies:[si,Bn,fr,Sl,Tc,$i],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.is-empty[_ngcontent-%COMP%]{height:100px;width:100px}.component[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;margin-top:-5px;margin-left:-5px;border:solid 5px #CCCCCC;border-radius:5px;background-color:#ccc;-webkit-backface-visibility:hidden;backface-visibility:hidden}.card-image[_ngcontent-%COMP%]{display:block;inset:0;margin:auto;height:auto;width:100%}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.rotate-grab[_ngcontent-%COMP%]{display:none;z-index:11}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:50%;opacity:.9}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.text[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.component[_ngcontent-%COMP%]:not(.is-empty):hover   .number-of-cards[_ngcontent-%COMP%]{visibility:hidden}.is-inverse[_ngcontent-%COMP%]{transform:rotate(180deg)}"],data:{animation:[Vn("shuffle",[Ap("active",dt({transform:""})),tn("* => active",[Zt("800ms ease",bn([dt({transform:"scale3d(0, 0, 0) rotateZ(0deg)",offset:0}),dt({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(360deg)",offset:.5}),dt({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(520deg)",offset:.75}),dt({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(630deg)",offset:.875}),dt({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(720deg)",offset:1})]))]),tn("* => inverse",[Zt("200ms ease",bn([dt({transform:"scale3d(1.0, 1.0, 1.0)",offset:0}),dt({transform:"scale3d(0.6, 1.2, 1.2)",offset:.5}),dt({transform:"scale3d(0, 0.75, 0.75)",offset:.75}),dt({transform:"scale3d(0.5, 1.125, 1.125)",offset:.875}),dt({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])]),Vn("bounceInOut",[tn("void => *",[Zt("600ms ease",bn([dt({transform:"scale3d(0, 0, 0)",offset:0}),dt({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),dt({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),dt({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),dt({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),tn("* => void",[Zt(100,dt({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),t})();const dte=["characterImage"],fte=["chatBubble"],hte=function(t){return{opacity:t}};function pte(t,n){if(1&t&&(mt(0,"img",31),Lt(1,"safe")),2&t){const e=me();ut("height",e.characterShadowImageHeight,"px")("filter","brightness(0) blur(1px)"+(e.isHideIn?" invert(85%)":"")),oe("src",Bt(1,7,0<e.shadowImageFile.url.length?e.shadowImageFile.url:e.imageFile.url,"resourceUrl"),vn)("ngStyle",wt(10,hte,(e.isHollow?.5:.7)*(e.isHideIn?.85:1)))("@switchImageShadow",e.gameCharacter.currntImageIndex)}}const gte=function(t,n){return{"background-color":t,transform:n}};function mte(t,n){if(1&t&&(Q(0,"div",32)(1,"div",33)(2,"b"),ve(3),ne()(),Q(4,"div",34)(5,"b"),ve(6),ne()()()),2&t){const e=me();oe("ngStyle",un(3,gte,e.ownerColor+"dd","translateX(-50%) translateX("+e.size*e.gridSize/2+"px) translateY(6px) rotateX("+e.nameTagRotate+"deg)")),G(3),lt(e.ownerName),G(3),lt(e.ownerName)}}const _te=function(t){return{"is-hide-in-tag":t}},qf=function(t){return{transform:t}};function $te(t,n){if(1&t&&(Q(0,"div",35)(1,"div",36),ve(2),ne(),Q(3,"div",37),ve(4),ne()()),2&t){const e=me();oe("ngClass",wt(4,_te,e.isHideIn))("ngStyle",wt(6,qf,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateX("+e.nameTagRotate+"deg)")),G(2),lt(e.name),G(2),lt(e.name)}}const vte=function(t){return{"is-hide-in":t}};function bte(t,n){if(1&t){const e=ft();Q(0,"img",38,39),Ae("load",function(){return Re(e),Le(me().onImageLoad())}),Lt(2,"safe"),ne()}if(2&t){const e=me();ut("height",e.characterImageHeight,"px"),oe("src",Bt(2,4,e.imageFile.url,"resourceUrl"),vn)("ngClass",wt(7,vte,e.isHideIn))}}function yte(t,n){if(1&t&&(Q(0,"span",46),mt(1,"img",47),Lt(2,"safe"),ne()),2&t){const e=me(2);G(1),ut("border-color",e.dialogColor),oe("src",Bt(2,3,e.dialogFaceIcon.url,"resourceUrl"),vn)}}function Cte(t,n){if(1&t&&(Q(0,"span",46),mt(1,"img",47),Lt(2,"safe"),ne()),2&t){const e=me(2);G(1),ut("border-color",e.dialogColor),oe("src",Bt(2,3,e.dialogFaceIcon.url,"resourceUrl"),vn)}}const JI=function(t,n,e){return{emote:t,rubied:n,"is-whisper":e}};function wte(t,n){if(1&t&&(Q(0,"div",40)(1,"div",41)(2,"p",42),Te(3,yte,3,6,"span",43),mt(4,"span",44),Lt(5,"safe"),ne(),Q(6,"p",45),Te(7,Cte,3,6,"span",43),mt(8,"span",44),Lt(9,"safe"),ne()()()),2&t){const e=me();ut("color",!e.isEmote&&e.isWhisper?"#ccc":e.dialogColor),oe("@fadeAndScaleInOut",e.isEmote),G(2),ut("min-width",e.dialogChatBubbleMinWidth,"px")("border-color",e.dialogColor),oe("ngClass",mo(23,JI,e.isEmote,e.isRubied,e.isWhisper)),G(1),oe("ngIf",!e.isEmote&&e.isUseFaceIcon&&0<(null==e.dialogFaceIcon?null:e.dialogFaceIcon.url.length)),G(1),oe("innerHTML",Bt(5,17,e.dialogText,"html"),lr),G(2),ut("min-width",e.dialogChatBubbleMinWidth,"px")("border-color",e.dialogColor),oe("ngClass",mo(27,JI,e.isEmote,e.isRubied,e.isWhisper)),G(1),oe("ngIf",!e.isEmote&&e.isUseFaceIcon&&0<(null==e.dialogFaceIcon?null:e.dialogFaceIcon.url.length)),G(1),oe("innerHTML",Bt(9,20,e.dialogText,"html"),lr)}}const eM=function(t){return{transform:t}};function xte(t,n){if(1&t&&(Q(0,"div",48)(1,"div",41)(2,"span",49)(3,"i"),ve(4),ne()(),Q(5,"span",50)(6,"i"),ve(7),ne()()(),Q(8,"div",41)(9,"span",51),ve(10),ne(),Q(11,"span",52),ve(12),ne()(),Q(13,"div",53)(14,"span",49)(15,"i"),ve(16),ne()(),Q(17,"span",50)(18,"i"),ve(19),ne()()()()),2&t){const e=me();ut("height",e.math.abs(e.altitude*e.gridSize)-(e.altitude>0?0:e.chatBubbleAltitude+4),"px"),oe("ngStyle",wt(14,eM,"translateX("+e.size*e.gridSize/2+"px) translateY("+-e.size*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),G(1),ut("visibility",e.altitude>0?"visible":"hidden"),G(3),lt(e.elevation),G(3),lt(e.elevation),G(3),lt(e.math.abs(e.altitude)),G(2),lt(e.math.abs(e.altitude)),G(1),ut("visibility",e.altitude<0?"visible":"hidden"),oe("ngStyle",wt(16,eM,"translateY("+(e.chatBubbleAltitude+4)+"px)")),G(3),lt(e.elevation),G(3),lt(e.elevation)}}const Ete=function(t,n,e){return{selected:t,"not-inventory":n,"is-hide-in-pedestal":e}},tM=function(t,n,e,i,r,o,s,a){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}},Tte=function(t){return{fall:t}},Ste=function(t,n,e){return{inverse:t,"black-paint":n,hollow:e}},Ite=function(t,n,e){return{bottom:t,transform:n,visibility:e}};let Mte=(()=>{class t{constructor(e,i,r,o,s,a){this.contextMenuService=e,this.panelService=i,this.changeDetector=r,this.pointerDeviceService=o,this.ngZone=s,this.modalService=a,this.gameCharacter=null,this.is3D=!1,this.gridSize=50,this.math=Math,this.stringUtil=pt,this.viewRotateX=50,this.viewRotateZ=10,this.heightWidthRatio=1.5,this.selected=!1,this._dialog=null,this.dialogTimeOutId=null,this.chatIntervalId=null,this.naturalImageWidth=0,this.naturalImageHeight=0,this.naturaHeightWidthRatio=1,this.movableOption={},this.rotableOption={}}get name(){return this.gameCharacter.name}get size(){return this.adjustMinBounds(this.gameCharacter.size)}get altitude(){return this.gameCharacter.altitude}set altitude(e){this.gameCharacter.altitude=e}get height(){return this.adjustMinBounds(this.gameCharacter.height)}get imageFile(){return this.gameCharacter.imageFile}get rotate(){return this.gameCharacter.rotate}set rotate(e){this.gameCharacter.rotate=e}get roll(){return this.gameCharacter.roll}set roll(e){this.gameCharacter.roll=e}get isDropShadow(){return this.gameCharacter.isDropShadow}set isDropShadow(e){this.gameCharacter.isDropShadow=e}get isAltitudeIndicate(){return this.gameCharacter.isAltitudeIndicate}set isAltitudeIndicate(e){this.gameCharacter.isAltitudeIndicate=e}get isInverse(){return this.gameCharacter.isInverse}set isInverse(e){this.gameCharacter.isInverse=e}get isHollow(){return this.gameCharacter.isHollow}set isHollow(e){this.gameCharacter.isHollow=e}get isBlackPaint(){return this.gameCharacter.isBlackPaint}set isBlackPaint(e){this.gameCharacter.isBlackPaint=e}get aura(){return this.gameCharacter.aura}set aura(e){this.gameCharacter.aura=e}get isNotRide(){return this.gameCharacter.isNotRide}set isNotRide(e){this.gameCharacter.isNotRide=e}get isUseIconToOverviewImage(){return this.gameCharacter.isUseIconToOverviewImage}set isUseIconToOverviewImage(e){this.gameCharacter.isUseIconToOverviewImage=e}get ownerName(){return this.gameCharacter.ownerName}get ownerColor(){return this.gameCharacter.ownerColor}get isHideIn(){return!!this.gameCharacter.owner}get isVisible(){return this.gameCharacter.isVisible}get isGMMode(){return!!Qe.myCursor&&Qe.myCursor.isGMMode}get faceIcon(){return this.gameCharacter.faceIcon}get dialogFaceIcon(){return this.dialog&&this.dialog.faceIconIdentifier?Gt.instance.get(this.dialog.faceIconIdentifier):null}get shadowImageFile(){return this.gameCharacter.shadowImageFile}get elevation(){return+((this.gameCharacter.posZ+this.altitude*this.gridSize)/this.gridSize).toFixed(1)}set dialog(e){if(!this.gameCharacter||this.gameCharacter.isHideIn)return;clearTimeout(this.dialogTimeOutId),clearInterval(this.chatIntervalId);let i=pt.cr(e.text);const r=pt.isEmote(i),o=[],s=/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g;let a,h=0,b=0;if(!r)for(i=i.replace(/[\u3002\u3001]{3}/g,"\u2026").replace(/[\u3002\u3001]{2}/g,"\u2025").replace(/(\u3002|[\r\n]{2,})/g,"$1                            ").trimEnd();null!==(a=s.exec(i));){let je=a.index-3*h;o.push({base:a[1],ruby:a[2],start:je-b,end:je+a[1].length-b-1}),h++,b+=a[2].length}let ee=1e3/Array.from(i).length>36?1e3/Array.from(i).length:36;ee>200&&(ee=200),this.dialogTimeOutId=setTimeout(()=>{this._dialog=null,this.gameCharacter.text="",this.gameCharacter.isEmote=!1,this.changeDetector.markForCheck()},Array.from(i).length*ee+6e3),this._dialog=e,this.gameCharacter.isEmote=r,h=0;let de=0,ge=0,xe="",ke=o.shift(),Pe="",Oe=!1;if(r)this.gameCharacter.text=i,this.changeDetector.markForCheck();else{const je=Array.from(i.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a.+?\u300b/g,"$1"));this.chatIntervalId=setInterval(()=>{let qe=je[h],Ve=qe.length>1;if(qe){if(!Oe&&ke&&de>=ke.start&&(xe+="<ruby>",Oe=!0,ge=0),xe+=pt.escapeHtml(qe),Oe){ge+=1;let We=ke.ruby;Pe="<rt>"+pt.escapeHtml(Array.from(We).slice(0,Math.ceil(Array.from(We).length*(ge/Array.from(ke.base).length))).join(""))+"</rt>"}Oe&&ke&&de>=ke.end-(Ve?1:0)&&(xe+=Pe+"</ruby>",Oe=!1,ke=o.shift()),de+=qe.length}h+=1,this.gameCharacter.text=xe+(Oe?Pe+"</ruby>":""),this.changeDetector.markForCheck(),h>=je.length&&clearInterval(this.chatIntervalId)},ee)}}get dialogText(){if(!this.gameCharacter||!this.gameCharacter.text)return"";const e=this.gameCharacter.text.replace(/\u3002/g,"\u3002\n\n").split(/[\r\n]{2,}/g).filter(i=>i.trim());return e.length>0?e.reverse()[0].trim():""}get isRubied(){return!(!this.gameCharacter||!this.gameCharacter.text)&&-1<this.dialogText.indexOf("<ruby>")}get dialogChatBubbleMinWidth(){const e=this.characterImageWidth+2.1*this.gridSize,i=this.isUseFaceIcon&&this.dialogFaceIcon&&this.dialogFaceIcon.url,r=11*Array.from(this.dialogText).length+52+(i?32:0);return e<r?e:r}get dialog(){return this._dialog}get chatBubbleXDeg(){let e=90-this.viewRotateX;return e<0&&(e=360+e),e%=360,e>180&&(e=-(180-(e-180))),e>90&&(e=90),e<-90&&(e=-90),e/1.5}get characterImageHeight(){if(!this.characterImage||!this.naturalImageHeight)return 0;if(this.height>0)return this.gridSize*this.height;let e=this.naturaHeightWidthRatio;return e>this.heightWidthRatio&&(e=this.heightWidthRatio),e*this.gridSize*this.size}get characterImageWidth(){if(!this.characterImage||!this.naturalImageWidth)return 0;if(this.height<=0)return this.gridSize*this.size;let e=this.naturaHeightWidthRatio;return e>this.heightWidthRatio&&(e=this.heightWidthRatio),this.gridSize*this.height/e}get characterShadowImageHeight(){return this.characterImageHeight}get characterShadowImageWidth(){return this.characterImageWidth}get characterShadowOffset(){let e=0;return.2<this.height&&this.height<=.3?e=.09:.1<this.height&&this.height<=.2?e=.19:0<this.height&&this.height<=.1&&(e=.29),this.gridSize*this.size/2-.99*this.characterShadowImageHeight-this.gridSize*e}get chatBubbleAltitude(){let e=Math.cos(this.roll*Math.PI/180),i=Math.abs(Math.sin(this.roll*Math.PI/180));e<.5&&(e=.5),i<.5&&(i=.5);const r=(this.characterImageHeight+(""!=this.name?24:0))*e+4,o=this.characterImageWidth/2*i+4+this.characterImageWidth/2;let s=r>o?r:o;return this.gameCharacter.chatBubbleAltitude=s,s}get nameTagRotate(){let e=this.viewRotateX%360-90,i=(this.viewRotateZ+this.rotate)%360,r=this.roll%360;return i=i>0?i:360+i,r=r>0?r:360+r,(e>0?e:360+e)*(90<i&&i<270?1:-1)*(90<=r&&r<=270?-1:1)}get isListen(){return this.dialog&&this.dialog.text&&!this.dialog.dialogTest&&this.dialog.text.trim().length>0}get isWhisper(){return this.dialog&&this.dialog.secret}get isEmote(){return this.gameCharacter.isEmote}get isUseFaceIcon(){return this.dialog&&this.dialog.faceIconIdentifier}get dialogColor(){return this.dialog&&this.dialog.color?this.dialog.color:Qe.CHAT_DEFAULT_COLOR}ngOnInit(){Ue.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Ct.instance.get(e.data.identifier);!this.gameCharacter||!i||(this.gameCharacter===i||i instanceof ni&&this.gameCharacter.contains(i))&&(this.gameCharacter.imageFiles.length<=0&&(this.naturalImageHeight=0,this.naturalImageWidth=0,this.naturaHeightWidthRatio=1),this.changeDetector.markForCheck())}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateX=e.data.x,this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on("SELECT_TABLETOP_OBJECT",-1e3,e=>{this.ngZone.run(()=>{this.selected=!(!e.data.highlighting||e.data.identifier!==this.gameCharacter.identifier),this.changeDetector.markForCheck()})}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on("POPUP_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&this.ngZone.run(()=>{this.dialog=e.data,this.changeDetector.markForCheck()})}).on("FAREWELL_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&(this.ngZone.run(()=>{this._dialog=null,this.gameCharacter.text="",this.gameCharacter.isEmote=!1,this.changeDetector.markForCheck()}),clearTimeout(this.dialogTimeOutId),clearInterval(this.chatIntervalId))}),this.movableOption={tabletopObject:this.gameCharacter,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain","text-note","character"]},this.rotableOption={tabletopObject:this.gameCharacter}}ngAfterViewInit(){queueMicrotask(()=>{this.gameCharacter.isLoaded=!0})}ngOnDestroy(){clearTimeout(this.dialogTimeOutId),clearInterval(this.chatIntervalId),this.gameCharacter&&(this.gameCharacter.text="",this.gameCharacter.isEmote=!1),Ue.unregister(this)}onDragstart(e){console.log("Dragstart Cancel !!!!"),e.stopPropagation(),e.preventDefault()}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:this.isHideIn?"\u4f4d\u7f6e\u3092\u516c\u958b\u3059\u308b":"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u308b\uff08\u30b9\u30c6\u30eb\u30b9\uff09",action:()=>{this.isHideIn?(this.gameCharacter.owner="",Et.play(st.piecePut)):(!sn.isStealthMode&&!Qe.myCursor.isGMMode&&this.modalService.open(pr,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:Li.OK,materialIcon:"disabled_visible"}),this.gameCharacter.owner=Ot.peerContext.userId,Et.play(st.sweep),Ue.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier})),Ue.call("UPDATE_INVENTORY",!0)}},Ht,this.gameCharacter.imageFiles.length<=1?null:{name:"\u753b\u50cf\u5207\u308a\u66ff\u3048",action:null,subActions:this.gameCharacter.imageFiles.map((r,o)=>({name:this.gameCharacter.currntImageIndex==o?"\u25c9":"\u25cb",action:()=>{this.changeImage(o)},default:this.gameCharacter.currntImageIndex==o,icon:r}))},this.gameCharacter.imageFiles.length<=1?null:Ht,this.isUseIconToOverviewImage?{name:"\u2611 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{this.isUseIconToOverviewImage=!1,Ue.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{this.isUseIconToOverviewImage=!0,Ue.trigger("UPDATE_INVENTORY",null)}},this.gameCharacter.isShowChatBubble?{name:"\u2611 \u{1f4ad}\u306e\u8868\u793a",action:()=>{this.gameCharacter.isShowChatBubble=!1,Ue.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u{1f4ad}\u306e\u8868\u793a",action:()=>{this.gameCharacter.isShowChatBubble=!0,Ue.trigger("UPDATE_INVENTORY",null)}},this.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!1,Ue.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!0,Ue.trigger("UPDATE_INVENTORY",null)}},{name:"\u753b\u50cf\u52b9\u679c",action:null,subActions:[this.isInverse?{name:"\u2611 \u53cd\u8ee2",action:()=>{this.isInverse=!1,Ue.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u53cd\u8ee2",action:()=>{this.isInverse=!0,Ue.trigger("UPDATE_INVENTORY",null)}},this.isHollow?{name:"\u2611 \u307c\u304b\u3057",action:()=>{this.isHollow=!1,Ue.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u307c\u304b\u3057",action:()=>{this.isHollow=!0,Ue.trigger("UPDATE_INVENTORY",null)}},this.isBlackPaint?{name:"\u2611 \u9ed2\u5857\u308a",action:()=>{this.isBlackPaint=!1,Ue.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ed2\u5857\u308a",action:()=>{this.isBlackPaint=!0,Ue.trigger("UPDATE_INVENTORY",null)}},{name:"\u30aa\u30fc\u30e9",action:null,subActions:[{name:(-1==this.aura?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{this.aura=-1,Ue.trigger("UPDATE_INVENTORY",null)}},Ht].concat(["\u30d6\u30e9\u30c3\u30af","\u30d6\u30eb\u30fc","\u30b0\u30ea\u30fc\u30f3","\u30b7\u30a2\u30f3","\u30ec\u30c3\u30c9","\u30de\u30bc\u30f3\u30bf","\u30a4\u30a8\u30ed\u30fc","\u30db\u30ef\u30a4\u30c8"].map((r,o)=>({name:`${this.aura==o?"\u25c9":"\u25cb"} ${r}`,colorSample:!0,action:()=>{this.aura=o,Ue.trigger("UPDATE_INVENTORY",null)}})))},Ht,{name:"\u30ea\u30bb\u30c3\u30c8",action:()=>{this.isInverse=!1,this.isHollow=!1,this.isBlackPaint=!1,this.aura=-1,Ue.trigger("UPDATE_INVENTORY",null)},disabled:!this.isInverse&&!this.isHollow&&!this.isBlackPaint&&-1==this.aura}]},Ht,this.isNotRide?{name:"\u2610 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{this.isNotRide=!1,Ue.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2611 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{this.isNotRide=!0,Ue.trigger("UPDATE_INVENTORY",null)}},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1,Ue.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0,Ue.trigger("UPDATE_INVENTORY",null)}},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,this.isHideIn||Et.play(st.sweep))},altitudeHande:this.gameCharacter},Ht,{name:"\u8a73\u7d30\u3092\u8868\u793a...",action:()=>{this.showDetail(this.gameCharacter)}},{name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a...",action:()=>{this.showChatPalette(this.gameCharacter)}},{name:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a...",action:()=>{this.showStandSetting(this.gameCharacter)}},Ht,{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.gameCharacter.getUrls().map(r=>{const o=r.value.toString();return{name:r.name?r.name:o,action:()=>{pt.sameOrigin(o)?window.open(o.trim(),"_blank","noopener"):this.modalService.open(lo,{url:o,title:this.gameCharacter.name,subTitle:r.name})},disabled:!pt.validUrl(o),error:pt.validUrl(o)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:pt.validUrl(o)&&!pt.sameOrigin(o)}}),disabled:this.gameCharacter.getUrls().length<=0},Ht,this.gameCharacter.isInventoryIndicate?{name:"\u2611 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{this.gameCharacter.isInventoryIndicate=!1,Ue.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{this.gameCharacter.isInventoryIndicate=!0,Ue.trigger("UPDATE_INVENTORY",null)}},{name:"\u30c6\u30fc\u30d6\u30eb\u304b\u3089\u79fb\u52d5",action:null,subActions:[{name:"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea",action:()=>{Ue.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation("common"),Et.play(st.piecePut)}},{name:"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea",action:()=>{Ue.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation(Ot.peerId),Et.play(st.piecePut)}},{name:"\u5893\u5834",action:()=>{Ue.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation("graveyard"),Et.play(st.sweep)}}]},Ht,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.gameCharacter.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.update(),Et.play(st.piecePut)}},{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b\uff08\u81ea\u52d5\u63a1\u756a\uff09",action:()=>{const r=this.gameCharacter.clone(),o=r.name.split("_");let s;s=o.length>1&&/\d+/.test(o[o.length-1])?o.slice(0,o.length-1).join("_"):o.join("_");let a=0;for(const h of Ct.instance.getObjects(sn)){if(!h.name.startsWith(s))continue;let b=h.name.match(/_(\d+)$/)?+RegExp.$1:0;b>a&&(a=b)}r.name=s+"_"+(a+1),r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.update(),Et.play(st.piecePut)}},Ht,{name:"\u524a\u9664\u3059\u308b\uff08\u5893\u5834\u3078\u79fb\u52d5\uff09",action:()=>{Ue.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation("graveyard"),Et.play(st.sweep)}}],this.name)}onMove(){this.isHideIn||Et.play(st.piecePick)}onMoved(){this.gameCharacter&&this.gameCharacter.text&&Ue.call("FAREWELL_CHAT_BALLOON",{characterIdentifier:this.gameCharacter.identifier}),this.isHideIn||Et.play(st.piecePut),this.selected=!1}onImageLoad(){this.naturalImageWidth=this.characterImage.nativeElement.naturalWidth,this.naturalImageHeight=this.characterImage.nativeElement.naturalHeight,this.naturaHeightWidthRatio=this.naturalImageWidth&&this.naturalImageHeight?this.naturalImageHeight/this.naturalImageWidth:1}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(r+=" - "+e.name),this.panelService.open(ps,{title:r,left:i.x-400,top:i.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(Lu,{left:i.x-250,top:i.y-175,width:620,height:350}).character=e}showStandSetting(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(yg,{left:i.x-400,top:i.y-175,width:730,height:572}).character=e}changeImage(e){this.gameCharacter.currntImageIndex!=e&&(this.gameCharacter.currntImageIndex=e,this.isHideIn||Et.play(st.surprise),Ue.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),Ue.trigger("UPDATE_INVENTORY",null))}nextImage(){this.gameCharacter.imageFiles.length<=1||this.changeImage(this.gameCharacter.currntImageIndex+1>=this.gameCharacter.imageFiles.length?0:this.gameCharacter.currntImageIndex+1)}}return t.\u0275fac=function(e){return new(e||t)(He(hr),He(qn),He(Ki),He(Ci),He(Nn),He(Yn))},t.\u0275cmp=fn({type:t,selectors:[["game-character"]],viewQuery:function(e,i){if(1&e&&(wn(dte,5),wn(fte,5)),2&e){let r;Cn(r=xn())&&(i.characterImage=r.first),Cn(r=xn())&&(i.chatBubble=r.first)}},hostBindings:function(e,i){1&e&&Ae("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{gameCharacter:"gameCharacter",is3D:"is3D"},decls:36,vars:85,consts:[["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.option","movable.ondragstart","movable.ondragend"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[1,"pedestal-inner",3,"ngClass"],[1,"pedestal-outer"],[1,"pedestal-grab","rotate-grab"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"is-pointer-events-none","is-3d",2,"transform-origin","center bottom"],[1,"image-box","is-3d",2,"transform-origin","center 66%"],[1,"aura","is-3d",2,"pointer-events","none",3,"ngClass"],[1,"is-3d",2,"pointer-events","none","transition","transform 132ms 0s ease",3,"ngStyle"],["class","image drop-shadow is-3d  chrome-smooth-image-trick","style","pointer-events: none",3,"height","src","filter","ngStyle",4,"ngIf"],[1,"upright-transform","is-fit-width","is-3d",3,"ngClass","ngStyle","dblclick"],["appRotable","",1,"rotate-frame","is-3d",2,"position","absolute",3,"rotable.value","rotable.valueChange","rotable.ondragstart","rotable.ondragend"],[1,"rotate-inner","is-3d"],["class","owner-tag is-nowrap is-black-background is-3d",3,"ngStyle",4,"ngIf"],["class","name-tag is-nowrap is-black-background is-3d",3,"ngClass","ngStyle",4,"ngIf"],[1,"is-pointer-events-none","is-3d","aura",3,"ngClass"],[1,"inverser","is-3d",3,"ngClass"],[1,"image-box","is-3d"],["class","image is-3d chrome-smooth-image-trick",3,"src","ngClass","height","load",4,"ngIf"],[1,"grab-group","is-3d"],[1,"rotate-grab","rotate-grab-icon","of-top","is-3d",3,"ngStyle"],[1,"material-icons"],[1,"rotate-grab","rotate-grab-icon","of-bottom","is-3d",3,"ngStyle"],[1,"chat-bubble","is-3d",3,"ngStyle"],["chatBubble",""],["class","is-3d","style","transform-origin: center bottom;",3,"color",4,"ngIf"],["class","is-3d","style","display: flex; flex-flow: column nowrap; justify-content: space-between; border-left: 2px dashed black; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],[1,"image","drop-shadow","is-3d","chrome-smooth-image-trick",2,"pointer-events","none",3,"src","ngStyle"],[1,"owner-tag","is-nowrap","is-black-background","is-3d",3,"ngStyle"],[1,"fornt-tag","is-3d",2,"color","whitesmoke"],[1,"back-tag","is-3d",2,"color","whitesmoke"],[1,"name-tag","is-nowrap","is-black-background","is-3d",3,"ngClass","ngStyle"],[1,"fornt-tag","has-length-limit","is-3d"],[1,"back-tag","has-length-limit","is-3d"],[1,"image","is-3d","chrome-smooth-image-trick",3,"src","ngClass","load"],["characterImage",""],[1,"is-3d",2,"transform-origin","center bottom"],[1,"is-3d"],[1,"is-3d","chat-bubble-buyo",2,"position","absolute","backface-visibility","hidden",3,"ngClass"],["class","face-icon-box is-3d",4,"ngIf"],[3,"innerHTML"],[1,"is-3d","chat-bubble-buyo","back",2,"backface-visibility","hidden","transform","rotateY(-180deg)",3,"ngClass"],[1,"face-icon-box","is-3d"],[1,"face-icon","is-3d",3,"src"],[1,"is-3d",2,"display","flex","flex-flow","column nowrap","justify-content","space-between","border-left","2px dashed black","transform-origin","top left",3,"ngStyle"],[1,"elevation-indicator","is-3d",2,"position","absolute"],[1,"elevation-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"is-3d",3,"ngStyle"]],template:function(e,i){1&e&&(Q(0,"div",0),Ae("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),Q(1,"div",1)(2,"div",2),Ae("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),mt(3,"div",3)(4,"div",4),Q(5,"div",5)(6,"div",6)(7,"div",7),ve(8,"autorenew"),ne(),Q(9,"div",8),ve(10,"autorenew"),ne()()(),Q(11,"div",9)(12,"div",10)(13,"div",11)(14,"div",12),Te(15,pte,2,12,"img",13),ne()()()(),Q(16,"div",14),Ae("dblclick",function(){return i.nextImage()}),Q(17,"div",15),Ae("rotable.valueChange",function(o){return i.roll=o})("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Q(18,"div",16),Te(19,mte,7,6,"div",17),Te(20,$te,5,8,"div",18),Q(21,"div",19)(22,"div",20)(23,"span",21),Te(24,bte,3,9,"img",22),ne()()(),Q(25,"div",23)(26,"div",24)(27,"i",25),ve(28,"autorenew"),ne()(),Q(29,"div",26)(30,"i",25),ve(31,"autorenew"),ne()()()()(),Q(32,"div",27,28),Te(34,wte,10,31,"div",29),ne()()(),Te(35,xte,20,18,"div",30),ne()()),2&e&&(ut("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),oe("movable.option",i.movableOption),G(1),oe("@bounceInOut","in"),G(1),oe("rotable.option",i.rotableOption),G(1),oe("@switchImagePedestal",i.gameCharacter.currntImageIndex)("ngClass",mo(45,Ete,i.selected,!i.gameCharacter.isInventoryIndicate,i.isHideIn)),G(1),oe("@switchImagePedestal",i.gameCharacter.currntImageIndex),G(7),ut("transform","translateX("+(i.size*i.gridSize-i.characterShadowImageWidth)/2+"px) translateY("+i.characterShadowOffset+"px) scale(1.0, 0.66)"),G(1),ut("width",i.characterShadowImageWidth,"px")("height",i.characterShadowImageHeight,"px")("transform","rotateZ("+i.roll+"deg)"),G(1),oe("ngClass",Ms(49,tM,0==i.aura,1==i.aura,2==i.aura,3==i.aura,4==i.aura,5==i.aura,6==i.aura,7==i.aura)),G(1),oe("ngStyle",wt(58,qf,"scaleX("+(i.isInverse?"-1":"1")+")")),G(1),oe("ngIf",i.isDropShadow&&(0<i.imageFile.url.length||0<i.shadowImageFile.url.length)),G(1),oe("ngClass",wt(60,Tte,0==i.altitude))("ngStyle",wt(62,qf,"rotateY(90deg) rotateZ(-90deg) rotateY(-90deg) translateY(-50%) translateY("+-i.altitude*i.gridSize+"px)")),G(1),ut("transform-origin","center "+.333*-i.characterImageHeight+"px"),oe("rotable.value",i.roll),G(1),ut("transform","translateZ("+-i.size*i.gridSize/2+"px)"),G(1),oe("ngIf",i.isGMMode&&i.isHideIn&&0<i.ownerName.length),G(1),oe("ngIf",0<i.name.length),G(1),oe("@switchImage",i.gameCharacter.currntImageIndex)("ngClass",Ms(64,tM,0==i.aura,1==i.aura,2==i.aura,3==i.aura,4==i.aura,5==i.aura,6==i.aura,7==i.aura)),G(1),oe("ngClass",mo(73,Ste,i.isInverse,i.isBlackPaint,i.isHollow)),G(1),ut("width",i.characterImageWidth,"px")("height",i.characterImageHeight,"px")("transform","translateX("+(i.size*i.gridSize-i.characterImageWidth)/2+"px)"),G(1),oe("ngIf",0<i.imageFile.url.length),G(2),oe("ngStyle",wt(77,qf,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px) translateY("+(-i.characterImageHeight-(i.isGMMode&&i.isHideIn?20:0))+"px)")),G(3),oe("ngStyle",wt(79,qf,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px")),G(3),oe("ngStyle",mo(81,Ite,i.chatBubbleAltitude-(i.isEmote?i.gridSize/2:0)-4+"px","translateZ("+-i.size*i.gridSize/2+"px) translateX(-50%) translateX("+i.size*i.gridSize/2+"px) rotateY("+(i.rotate+i.viewRotateZ)+"deg) rotateX("+i.chatBubbleXDeg+"deg)",i.gameCharacter.isShowChatBubble?"visible":"hidden")),G(2),oe("ngIf",i.isListen),G(1),oe("ngIf",i.isAltitudeIndicate&&(i.altitude<=-.5||.5<=i.altitude)))},dependencies:[si,Bn,fr,Sl,Tc,$i],styles:['[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.upright-transform.fall[_ngcontent-%COMP%]{transition:transform 132ms cubic-bezier(.21,.97,.75,1.25)}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:100%;box-sizing:border-box;border-top:solid 28px #999;border-left:solid 12px #999;border-right:solid 12px #CCC;border-bottom:solid 28px #CCC;border-radius:37px}.pedestal-inner[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 6px #FFCC80;border-radius:25px}.pedestal-inner.not-inventory[_ngcontent-%COMP%]{border-color:#80ccee}.pedestal-outer[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 2px #212121;border-radius:25px}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{bottom:0;left:0;right:0;margin:auto;width:100%;height:auto;vertical-align:bottom}.image-box[_ngcontent-%COMP%]{display:inline-block;text-align:center}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{-o-object-fit:contain;object-fit:contain;-o-object-position:50% 100%;object-position:50% 100%;margin-bottom:0;margin-top:auto;image-rendering:-webkit-optimize-contrast;image-rendering:crisp-edges}.inverse[_ngcontent-%COMP%]{transform:rotateY(-180deg)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #fff)}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:13px;padding:2px 8px;border-radius:12px;position:absolute;top:-26px;transform-origin:center bottom}.owner-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:11px;padding:2px 9px;border-radius:6px;position:absolute;top:-55px;transform-origin:center bottom}.rotate-frame[_ngcontent-%COMP%]{bottom:0;left:0;right:0;overflow:visible}.rotate-inner[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;width:100%;height:auto;overflow:visible}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.is-black-background.is-hide-in-tag[_ngcontent-%COMP%]{color:#1e1e1e;background-color:#e9e9e9cc}.fornt-tag[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.back-tag[_ngcontent-%COMP%]{position:absolute;top:3px;-webkit-backface-visibility:hidden;backface-visibility:hidden;transform:rotateY(-180deg)}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:24em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;bottom:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{position:absolute;width:24px;top:0;left:0;right:0;margin:auto;color:#444}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.altitude-indicator[_ngcontent-%COMP%]{font-size:10px}.elevation-indicator[_ngcontent-%COMP%], .altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;color:#000;text-shadow:#f5f5f5 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.elevation-indicator[_ngcontent-%COMP%]{font-weight:bolder;font-size:12px}.chat-bubble[_ngcontent-%COMP%]{position:absolute;pointer-events:none;transform-origin:center calc(100% + 12px)}.chat-bubble[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{box-sizing:border-box;display:inline-block;max-width:100%;min-width:130px;font-size:13px;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:1px solid;border-radius:24px;margin:0;padding:6px 12px;white-space:pre-wrap;word-break:break-word;overflow-wrap:anywhere;text-align:center}.chat-bubble[_ngcontent-%COMP%]   p.rubied[_ngcontent-%COMP%]{padding-top:12px}.chat-bubble[_ngcontent-%COMP%]   p.emote[_ngcontent-%COMP%]{text-align:center;font-size:38px;font-weight:700;border:none;background:none;min-width:300px;-webkit-text-stroke:1px rgb(240,218,189);letter-spacing:-2px;white-space:pre}.chat-bubble[_ngcontent-%COMP%]   p.is-whisper[_ngcontent-%COMP%]{border-radius:24px 12px;font-size:13px;background:rgba(85,85,85,.8);box-shadow:0 0 2px #ccc}.chat-bubble[_ngcontent-%COMP%]   p.is-whisper.emote[_ngcontent-%COMP%]{font-size:38px;font-weight:700;border:none;background:none;min-width:200px;-webkit-text-stroke:2px #555;box-shadow:none}.chat-bubble[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:after{box-sizing:border-box;content:"";position:absolute;padding:0;line-height:1;vertical-align:baseline;left:50%;margin:0 0 0 -8px;bottom:-17px;border:8px solid transparent;border-top-color:inherit}.chat-bubble[_ngcontent-%COMP%]   p.emote[_ngcontent-%COMP%]:after{border:0px none transparent}.chat-bubble[_ngcontent-%COMP%]   p.is-whisper.emote[_ngcontent-%COMP%]:after{content:none}.chat-bubble-buyo[_ngcontent-%COMP%]{transform-origin:center calc(100% + 8px);transition:all .2s ease;animation:chat-bubble-buyo 1.2s ease-in-out .1s infinite alternate;transform:scale3d(.9,.9,.9)}.chat-bubble-buyo.back[_ngcontent-%COMP%]{transform-origin:center calc(100% + 8px);transition:all .2s ease;animation:chat-bubble-buyo-back 1.2s ease-in-out .1s infinite alternate;transform:rotateY(-180deg) scale3d(.9,.9,.9)}.chat-bubble-buyo.emote[_ngcontent-%COMP%]{animation-duration:.6s}@keyframes chat-bubble-buyo{0%{transform:scale3d(.9,.9,.9)}to{transform:scaleZ(1)}}@keyframes chat-bubble-buyo-back{0%{transform:rotateY(-180deg) scale3d(.9,.9,.9)}to{transform:rotateY(-180deg) scaleZ(1)}}.drop-shadow[_ngcontent-%COMP%]{pointer-events:none}.face-icon-box[_ngcontent-%COMP%]{display:block;position:relative;border:0px none;width:36px;height:36px;max-width:36px;max-height:36px;overflow:hidden;left:-20px;top:-18px;margin-right:-16px;margin-bottom:-22px;float:left;-webkit-backface-visibility:hidden;backface-visibility:hidden}p.rubied[_ngcontent-%COMP%]   .face-icon-box[_ngcontent-%COMP%]{top:-21px}.face-icon-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:.4em}.selected[_ngcontent-%COMP%]{filter:drop-shadow(0px 0px 8px yellow) drop-shadow(0px 0px 4px yellow);transition:all .2s ease-in}.is-hide-in-pedestal[_ngcontent-%COMP%]{filter:grayscale(70%)}.is-hide-in-pedestal.selected[_ngcontent-%COMP%]{filter:grayscale(70%) drop-shadow(0px 0px 8px yellow) drop-shadow(0px 0px 4px yellow)}.is-hide-in[_ngcontent-%COMP%]{filter:invert(85%) opacity(85%)}'],data:{animation:[Vn("switchImage",[tn(":increment, :decrement",[Zt("400ms ease",bn([dt({transform:"scale3d(0.8, 0.8, 0.8) rotateY(0deg)"}),dt({transform:"scale3d(1.2, 1.2, 1.2) rotateY(180deg)"}),dt({transform:"scale3d(1.0, 1.0, 1.0) rotateY(360deg)"})]))])]),Vn("switchImageShadow",[tn(":increment, :decrement",[Zt("400ms ease",bn([dt({transform:"scale3d(0.8, 0.8, 0.8)"}),dt({transform:"scale3d(0, 1.2, 1.2)"}),dt({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),Vn("switchImagePedestal",[tn(":increment, :decrement",[Zt("400ms ease",bn([dt({transform:"scale3d(0, 0, 0)"}),dt({transform:"scale3d(1.2, 1.2, 1.2)"}),dt({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),Vn("bounceInOut",[tn("void => *",[Zt("600ms ease",bn([dt({transform:"scale3d(0, 0, 0)",offset:0}),dt({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),dt({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),dt({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),dt({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),tn("* => void",[Zt(100,dt({transform:"scale3d(0, 0, 0)"}))])]),Vn("fadeAndScaleInOut",[tn("void => *, true => false",[Zt("200ms ease-in-out",bn([dt({transform:"scale3d(0, 0, 0)",opacity:0}),dt({transform:"scale3d(1.0, 1.0, 1.0)",opacity:.8})]))]),tn("* => void, true => false",[Zt("100ms ease-in-out",dt({transform:"scale3d(0, 0, 0)",opacity:0}))])])]},changeDetection:0}),t})();function kte(t,n){if(1&t&&(mt(0,"img",9),Lt(1,"safe")),2&t){const e=me();ut("mix-blend-mode",1==e.blendType?null:"hard-light"),oe("src",Bt(1,3,e.imageFile.url,"resourceUrl"),vn)}}const Dte=function(t){return{transform:t}};function Ate(t,n){if(1&t&&(Q(0,"div",10)(1,"div",11)(2,"span",12),ve(3),ne(),Q(4,"span",13),ve(5),ne()()()),2&t){const e=me();ut("height",e.math.abs(e.gameTableMaskAltitude*e.gridSize),"px"),oe("ngStyle",wt(5,Dte,"translateX("+e.width*e.gridSize/2+"px) translateY("+-e.height*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),G(3),lt(e.math.abs(e.gameTableMaskAltitude)),G(2),lt(e.gameTableMaskAltitude)}}const Pte=function(t){return{"is-grab":t}},Vv=function(t){return{fall:t}},nM=function(t){return{transform:t}},Nte=function(t){return{"is-inverse":t}},Ote=function(t,n){return{"border-width":t,transform:n}},Fte=function(t){return{image:t}};let Rte=(()=>{class t{constructor(e,i,r,o,s,a,h,b,ee){this.ngZone=e,this.tabletopActionService=i,this.contextMenuService=r,this.elementRef=o,this.panelService=s,this.changeDetector=a,this.pointerDeviceService=h,this.modalService=b,this.coordinateService=ee,this.gameTableMask=null,this.is3D=!1,this.gridSize=50,this.math=Math,this.viewRotateZ=10,this.movableOption={},this.input=null}get name(){return this.gameTableMask.name}get width(){return this.adjustMinBounds(this.gameTableMask.width)}get height(){return this.adjustMinBounds(this.gameTableMask.height)}get opacity(){return this.gameTableMask.opacity}get imageFile(){return this.gameTableMask.imageFile}get isLock(){return this.gameTableMask.isLock}set isLock(e){this.gameTableMask.isLock=e}get blendType(){return this.gameTableMask.blendType}set blendType(e){this.gameTableMask.blendType=e}get fontSize(){return this.gameTableMask.fontsize}set fontSize(e){this.gameTableMask.fontsize=e}get text(){return this.gameTableMask.text}set text(e){this.gameTableMask.text=e}get color(){return this.gameTableMask.color}set color(e){this.gameTableMask.color=e}get bgcolor(){return this.gameTableMask.bgcolor}set bgcolor(e){this.gameTableMask.bgcolor=e}get textShadowCss(){const e=pt.textShadowColor(this.color);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}get altitude(){return this.gameTableMask.altitude}set altitude(e){this.gameTableMask.altitude=e}get isAltitudeIndicate(){return this.gameTableMask.isAltitudeIndicate}set isAltitudeIndicate(e){this.gameTableMask.isAltitudeIndicate=e}get gameTableMaskAltitude(){return+this.altitude.toFixed(1)}get rubiedText(){return pt.rubyToHtml(pt.escapeHtml(this.text))}get isInverse(){return 90<Math.abs(this.viewRotateZ)%360&&Math.abs(this.viewRotateZ)%360<270}get isGMMode(){return this.gameTableMask.isGMMode}ngOnInit(){Ue.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Ct.instance.get(e.data.identifier);!this.gameTableMask||!i||(this.gameTableMask===i||i instanceof ni&&this.gameTableMask.contains(i))&&this.changeDetector.markForCheck()}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.gameTableMask,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new ls(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this.input.destroy(),Ue.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLock&&Ue.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate();this.contextMenuService.open(i,[this.isGMMode?this.gameTableMask.isTransparentOnGMMode?{name:"\u2611 GM\u30e2\u30fc\u30c9\u6642\u900f\u904e",action:()=>{this.gameTableMask.isTransparentOnGMMode=!1,Et.play(st.lock)}}:{name:"\u2610 GM\u30e2\u30fc\u30c9\u6642\u900f\u904e",action:()=>{this.gameTableMask.isTransparentOnGMMode=!0,Et.play(st.unlock)}}:null,this.isGMMode?Ht:null,this.isLock?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLock=!1,Et.play(st.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLock=!0,Et.play(st.lock)}},{name:"\u753b\u50cf\u3068\u8272",subActions:[{name:(0==this.blendType?"\u25c9":"\u25cb")+" \u753b\u50cf\u306e\u307f",action:()=>{this.blendType=0,Et.play(st.cardDraw)}},{name:(1==this.blendType?"\u25c9":"\u25cb")+" \u80cc\u666f\u8272\u3068\u91cd\u306d\u308b",action:()=>{this.blendType=1,Et.play(st.cardDraw)}},{name:(2==this.blendType?"\u25c9":"\u25cb")+" \u80cc\u666f\u8272\u3068\u6df7\u305c\u308b",action:()=>{this.blendType=2,Et.play(st.cardDraw)}},Ht,{name:"\u8272\u306e\u521d\u671f\u5316",action:()=>{this.color="#555555",this.bgcolor="#0a0a0a",Et.play(st.cardDraw)}}]},Ht,this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0}},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,Et.play(st.sweep))},altitudeHande:this.gameTableMask},Ht,{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u7de8\u96c6...",action:()=>{this.showDetail(this.gameTableMask)}},this.gameTableMask.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.gameTableMask.getUrls().map(o=>{const s=o.value.toString();return{name:o.name?o.name:s,action:()=>{pt.sameOrigin(s)?window.open(s.trim(),"_blank","noopener"):this.modalService.open(lo,{url:s,title:this.gameTableMask.name,subTitle:o.name})},disabled:!pt.validUrl(s),error:pt.validUrl(s)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:pt.validUrl(s)&&!pt.sameOrigin(s)}})},this.gameTableMask.getUrls().length<=0?null:Ht,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let o=this.gameTableMask.clone();console.log("\u30b3\u30d4\u30fc",o),o.location.x+=this.gridSize,o.location.y+=this.gridSize,o.isLock=!1,this.gameTableMask.parent&&this.gameTableMask.parent.appendChild(o),Et.play(st.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.gameTableMask.destroy(),Et.play(st.sweep)}},Ht,{name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(r)}],this.name)}onMove(){Et.play(st.cardPick)}onMoved(){Et.play(st.cardPut)}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u30de\u30c3\u30d7\u30de\u30b9\u30af\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(ps,{title:r,left:i.x-200,top:i.y-150,width:400,height:530}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(He(Nn),He(Bg),He(hr),He(Ai),He(qn),He(Ki),He(Ci),He(Yn),He(wl))},t.\u0275cmp=fn({type:t,selectors:[["game-table-mask"]],hostBindings:function(e,i){1&e&&Ae("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{gameTableMask:"gameTableMask",is3D:"is3D"},decls:10,vars:52,consts:[["appMovable","",1,"component","is-3d",2,"pointer-events","none",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],[1,"is-3d","text",2,"left","2px","top","2px","backface-visibility","hidden",3,"ngClass","ngStyle"],[1,"is-3d",2,"z-index","5","pointer-events","none",3,"ngClass","innerHtml"],[1,"border","is-fit-full",2,"backface-visibility","hidden",3,"ngClass","ngStyle"],[1,"is-fit-full","is-3d","chrome-smooth-image-trick",2,"pointer-events","auto",3,"ngClass"],["class","is-fit-full is-3d chrome-smooth-image-trick","style","pointer-events: none; position: absolute;",3,"mix-blend-mode","src",4,"ngIf"],[1,"lock-icon","is-center","is-3d",2,"pointer-events","none","z-index","10",3,"ngClass","ngStyle"],[1,"material-icons","is-3d",2,"pointer-events","none","backface-visibility","hidden"],["class","is-3d","style","display: flex; align-items: center; border-left: 2px dashed blanchedalmond; transform-origin: top left; pointer-events: none",3,"height","ngStyle",4,"ngIf"],[1,"is-fit-full","is-3d","chrome-smooth-image-trick",2,"pointer-events","none","position","absolute",3,"src"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","transform-origin","top left","pointer-events","none",3,"ngStyle"],[1,"is-3d",2,"pointer-events","none"],[1,"altitude-indicator","is-3d",2,"position","absolute","pointer-events","none"],[1,"altitude-indicator","is-3d",2,"position","absolute","pointer-events","none","transform","rotateY(-180deg)"]],template:function(e,i){1&e&&(Q(0,"div",0),Ae("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),Q(1,"div",1),mt(2,"div",2),ne(),Q(3,"div",3)(4,"div",4),Te(5,kte,2,6,"img",5),ne()(),Q(6,"div",6)(7,"i",7),ve(8),ne()(),Te(9,Ate,6,7,"div",8),ne()),2&e&&(ut("width",i.width*i.gridSize,"px")("height",i.height*i.gridSize,"px"),oe("ngClass",wt(33,Pte,!i.isLock))("movable.option",i.movableOption)("movable.disable",i.isLock),G(1),ut("width",i.width*i.gridSize-4,"px")("height",i.height*i.gridSize-4,"px"),oe("ngClass",wt(35,Vv,0==i.altitude))("ngStyle",wt(37,nM,"translateZ("+i.altitude*i.gridSize+"px)")),G(1),ut("font-size",i.fontSize+9,"px")("color",i.color)("text-shadow",i.textShadowCss),oe("ngClass",wt(39,Nte,i.isInverse))("innerHtml",i.rubiedText,lr),G(1),oe("ngClass",wt(41,Vv,0==i.altitude))("ngStyle",un(43,Ote,i.isLock?"0px":"2px","translateZ("+i.altitude*i.gridSize+"px)")),G(1),ut("opacity",i.opacity*(i.isGMMode&&i.gameTableMask.isTransparentOnGMMode?.6:1))("background-color",i.imageFile.url.length<1||i.blendType>0?i.bgcolor:null),oe("ngClass",wt(46,Fte,i.imageFile.url.length>=1)),G(1),oe("ngIf",i.imageFile.url.length>=1),G(1),oe("ngClass",wt(48,Vv,0==i.altitude))("ngStyle",wt(50,nM,"translateZ("+i.altitude*i.gridSize+"px)")),G(2),lt(i.isLock?"lock":"open_with"),G(1),oe("ngIf",i.isAltitudeIndicate&&i.math.abs(i.gameTableMaskAltitude)>=.5))},dependencies:[si,Bn,fr,Sl,$i],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.image[_ngcontent-%COMP%]{display:block;box-sizing:border-box}.lock-icon[_ngcontent-%COMP%]{background-color:#ccc;border-radius:100%;color:#444;width:25px;height:25px;visibility:hidden}.component[_ngcontent-%COMP%]:hover   .lock-icon[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .lock-icon[_ngcontent-%COMP%]{visibility:visible}.is-center[_ngcontent-%COMP%]{position:absolute;inset:0;margin:auto}.border[_ngcontent-%COMP%]{box-sizing:border-box;border:2px solid transparent}.image.border[_ngcontent-%COMP%]{border-width:0px}.component[_ngcontent-%COMP%]:hover   .border[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .border[_ngcontent-%COMP%], .is-grab[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{border:2px solid #cccccc!important}.is-fit-full[_ngcontent-%COMP%]{height:100%;width:100%}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.fall[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.text[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.is-inverse[_ngcontent-%COMP%]{transform:rotate(180deg)}"],changeDetection:0}),t})();const iM=function(t){return{"blinking-animation":t}};function Lte(t,n){if(1&t&&(Q(0,"div",6),Lt(1,"safe"),ne()),2&t){const e=me(2);ut("background-image",Bt(1,3,"url("+e.floorImage.url+")","style")),oe("ngClass",wt(6,iM,!e.isLocked))}}function Bte(t,n){if(1&t&&(it(0),Te(1,Lte,2,8,"div",5),rt()),2&t){const e=me();G(1),oe("ngIf",e.isDropShadow&&(0!=e.terreinAltitude||e.isSlope&&!e.hasWall))}}const zte=function(t,n,e){return{"backface-visibility":t,transform:n,filter:e}};function jte(t,n){if(1&t&&(it(0),Q(1,"div",7),Lt(2,"safe"),ne(),rt()),2&t){const e=me();G(1),ut("background-image",Bt(2,4,"url("+e.floorImage.url+")","style")),oe("ngClass",wt(7,iM,!e.isLocked))("ngStyle",mo(9,zte,e.isSlope?"visible":"hidden","translateZ("+e.height/(e.isSlope?2:1)*e.gridSize+"px)"+e.floorModCss,"brightness("+e.floorBrightness+")"))}}const zg=function(t,n,e,i){return{"blinking-animation":t,"no-shadow":n,"is-slope":e,"is-inverse-slope":i}};function Ute(t,n){if(1&t&&(Q(0,"div",9),Lt(1,"safe"),ne()),2&t){const e=me(3);ut("background-image",Bt(1,7,"url("+e.wallImage.url+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),oe("ngClass",Is(10,zg,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.LEFT,e.slopeDirection==e.slopeDirectionState.RIGHT))}}function Hte(t,n){if(1&t&&(it(0),Te(1,Ute,2,15,"div",8),rt()),2&t){const e=me(2);G(1),oe("ngIf",e.isVisibleWallTopBottom)}}function Vte(t,n){if(1&t&&(Q(0,"div",11),Lt(1,"safe"),ne()),2&t){const e=me(3);ut("background-image",Bt(1,7,"url("+e.wallImage.url+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),oe("ngClass",Is(10,zg,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.LEFT,e.slopeDirection==e.slopeDirectionState.RIGHT))}}function Gte(t,n){if(1&t&&(it(0),Te(1,Vte,2,15,"div",10),rt()),2&t){const e=me(2);G(1),oe("ngIf",e.isVisibleWallTopBottom)}}function qte(t,n){if(1&t&&(Q(0,"div",13),Lt(1,"safe"),ne()),2&t){const e=me(3);ut("background-image",Bt(1,7,"url("+e.wallImage.url+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),oe("ngClass",Is(10,zg,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.BOTTOM,e.slopeDirection==e.slopeDirectionState.TOP))}}function Wte(t,n){if(1&t&&(it(0),Te(1,qte,2,15,"div",12),rt()),2&t){const e=me(2);G(1),oe("ngIf",e.isVisibleWallLeftRight)}}function Kte(t,n){if(1&t&&(Q(0,"div",15),Lt(1,"safe"),ne()),2&t){const e=me(3);ut("background-image",Bt(1,7,"url("+e.wallImage.url+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),oe("ngClass",Is(10,zg,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.BOTTOM,e.slopeDirection==e.slopeDirectionState.TOP))}}function Yte(t,n){if(1&t&&(it(0),Te(1,Kte,2,15,"div",14),rt()),2&t){const e=me(2);G(1),oe("ngIf",e.isVisibleWallLeftRight)}}function Zte(t,n){if(1&t&&(it(0),Te(1,Hte,2,1,"ng-container",2),Te(2,Gte,2,1,"ng-container",2),Te(3,Wte,2,1,"ng-container",2),Te(4,Yte,2,1,"ng-container",2),rt()),2&t){const e=me();G(1),oe("ngIf",e.slopeDirection!=e.slopeDirectionState.TOP),G(1),oe("ngIf",e.slopeDirection!=e.slopeDirectionState.BOTTOM),G(1),oe("ngIf",e.slopeDirection!=e.slopeDirectionState.LEFT),G(1),oe("ngIf",e.slopeDirection!=e.slopeDirectionState.RIGHT)}}function Xte(t,n){if(1&t&&(it(0),Q(1,"div",16),mt(2,"div",17),Q(3,"div",18)(4,"i",19),ve(5,"autorenew"),ne()(),Q(6,"div",20)(7,"i",19),ve(8,"autorenew"),ne()(),Q(9,"div",21)(10,"i",19),ve(11,"autorenew"),ne()(),Q(12,"div",22)(13,"i",19),ve(14,"autorenew"),ne()()(),rt()),2&t){const e=me();G(1),ut("opacity",e.isInteract?"1.0":"0.5")("height",e.depth*e.gridSize,"px")}}const rM=function(t){return{transform:t}};function Qte(t,n){if(1&t&&(Q(0,"div",23)(1,"div",24),ve(2),ne(),Q(3,"div",25),ve(4),ne()()),2&t){const e=me();ut("height",e.math.abs(e.terreinAltitude*e.gridSize),"px"),oe("ngStyle",wt(5,rM,"translateX("+e.width*e.gridSize/2+"px) translateY("+-e.depth*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.terreinAltitude>0?-(e.altitude+(e.isSlope||e.isWallExist?0:e.height))*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),G(2),lt(e.math.abs(e.terreinAltitude)),G(2),lt(e.math.abs(e.terreinAltitude))}}const Jte=function(t){return{"is-grab":t}},ene=function(t,n){return{"upright-transform":t,fall:n}};let tne=(()=>{class t{constructor(e,i,r,o,s,a,h,b,ee,de){this.ngZone=e,this.imageService=i,this.tabletopActionService=r,this.contextMenuService=o,this.elementRef=s,this.panelService=a,this.changeDetector=h,this.pointerDeviceService=b,this.modalService=ee,this.coordinateService=de,this.terrain=null,this.is3D=!1,this.gridSize=50,this.movableOption={},this.rotableOption={},this.math=Math,this.slopeDirectionState=bi,this.input=null,this.viewRotateZ=10}get name(){return this.terrain.name}get mode(){return this.terrain.mode}set mode(e){this.terrain.mode=e}get isLocked(){return this.terrain.isLocked}set isLocked(e){this.terrain.isLocked=e}get hasWall(){return this.terrain.hasWall}get hasFloor(){return this.terrain.hasFloor}get wallImage(){return this.imageService.getSkeletonOr(this.terrain.wallImage)}get floorImage(){return this.imageService.getSkeletonOr(this.terrain.floorImage)}get height(){return this.adjustMinBounds(this.terrain.height)}get width(){return this.adjustMinBounds(this.terrain.width)}get depth(){return this.adjustMinBounds(this.terrain.depth)}get altitude(){return this.terrain.altitude}set altitude(e){this.terrain.altitude=e}get isDropShadow(){return this.terrain.isDropShadow}set isDropShadow(e){this.terrain.isDropShadow=e}get isSurfaceShading(){return this.terrain.isSurfaceShading}set isSurfaceShading(e){this.terrain.isSurfaceShading=e}get isInteract(){return this.terrain.isInteract}set isInteract(e){this.terrain.isInteract=e}get isSlope(){return this.terrain.isSlope}set isSlope(e){this.terrain.isSlope=e,e||(this.terrain.slopeDirection=bi.NONE)}get slopeDirection(){return this.terrain.isSlope?this.terrain.isSlope&&this.terrain.slopeDirection===bi.NONE?bi.BOTTOM:this.terrain.slopeDirection:bi.NONE}set slopeDirection(e){this.terrain.isSlope=e!=bi.NONE,this.terrain.slopeDirection=e}get isAltitudeIndicate(){return this.terrain.isAltitudeIndicate}set isAltitudeIndicate(e){this.terrain.isAltitudeIndicate=e}get isVisibleFloor(){return 0<this.width*this.depth}get isVisibleWallTopBottom(){return 0<this.width*this.height}get isVisibleWallLeftRight(){return 0<this.depth*this.height}get isWallExist(){return this.hasWall&&this.wallImage&&this.wallImage.url&&this.wallImage.url.length>0}get terreinAltitude(){let e=this.altitude;return(this.altitude<0||!this.isSlope&&!this.isWallExist)&&(e+=this.height),e}ngOnInit(){Ue.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Ct.instance.get(e.data.identifier);!this.terrain||!i||(this.terrain===i||i instanceof ni&&this.terrain.contains(i))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.terrain,colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.terrain}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new ls(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this.input.destroy(),Ue.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLocked&&Ue.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate();this.contextMenuService.open(i,[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,Et.play(st.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,Et.play(st.lock)}},Ht,{name:"\u50be\u659c",action:null,subActions:[{name:(this.slopeDirection==bi.NONE?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{this.slopeDirection=bi.NONE}},Ht,{name:(this.slopeDirection==bi.TOP?"\u25c9":"\u25cb")+" \u4e0a\uff08\u5317\uff09",action:()=>{this.slopeDirection=bi.TOP}},{name:(this.slopeDirection==bi.BOTTOM?"\u25c9":"\u25cb")+" \u4e0b\uff08\u5357\uff09",action:()=>{this.slopeDirection=bi.BOTTOM}},{name:(this.slopeDirection==bi.LEFT?"\u25c9":"\u25cb")+" \u5de6\uff08\u897f\uff09",action:()=>{this.slopeDirection=bi.LEFT}},{name:(this.slopeDirection==bi.RIGHT?"\u25c9":"\u25cb")+" \u53f3\uff08\u6771\uff09",action:()=>{this.slopeDirection=bi.RIGHT}}]},{name:"\u58c1\u306e\u8868\u793a",action:null,subActions:[{name:(this.hasWall&&this.isSurfaceShading?"\u25c9":"\u25cb")+" \u901a\u5e38",action:()=>{this.mode=La.ALL,this.isSurfaceShading=!0}},{name:(this.hasWall&&!this.isSurfaceShading?"\u25c9":"\u25cb")+" \u9670\u5f71\u306a\u3057",action:()=>{this.mode=La.ALL,this.isSurfaceShading=!1}},{name:(this.hasWall?"\u25cb":"\u25c9")+" \u975e\u8868\u793a",action:()=>{this.mode=La.FLOOR,this.depth*this.width==0&&(this.terrain.width=this.width<=0?1:this.width,this.terrain.depth=this.depth<=0?1:this.depth)}}]},Ht,this.isDropShadow?{name:"\u2611 \u5f71\u3092\u843d\u3068\u3059",action:()=>{this.isDropShadow=!1}}:{name:"\u2610 \u5f71\u3092\u843d\u3068\u3059",action:()=>{this.isDropShadow=!0}},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0}},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,Et.play(st.sweep))},altitudeHande:this.terrain},Ht,{name:"\u5730\u5f62\u8a2d\u5b9a\u3092\u7de8\u96c6...",action:()=>{this.showDetail(this.terrain)}},this.terrain.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.terrain.getUrls().map(o=>{const s=o.value.toString();return{name:o.name?o.name:s,action:()=>{pt.sameOrigin(s)?window.open(s.trim(),"_blank","noopener"):this.modalService.open(lo,{url:s,title:this.terrain.name,subTitle:o.name})},disabled:!pt.validUrl(s),error:pt.validUrl(s)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:pt.validUrl(s)&&!pt.sameOrigin(s)}})},this.terrain.getUrls().length<=0?null:Ht,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let o=this.terrain.clone();o.location.x+=this.gridSize,o.location.y+=this.gridSize,o.isLocked=!1,this.terrain.parent&&this.terrain.parent.appendChild(o),Et.play(st.blockPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.terrain.destroy(),Et.play(st.sweep)}},Ht,{name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(r)}],this.name)}onMove(){Et.play(st.blockPick)}onMoved(){Et.play(st.blockPut)}get floorModCss(){let e="",i=0;switch(this.slopeDirection){case bi.TOP:i=Math.atan(this.height/this.depth),e=" rotateX("+i+"rad) scaleY("+1/Math.cos(i)+")";break;case bi.BOTTOM:i=Math.atan(this.height/this.depth),e=" rotateX("+-i+"rad) scaleY("+1/Math.cos(i)+")";break;case bi.LEFT:i=Math.atan(this.height/this.width),e=" rotateY("+-i+"rad) scaleX("+1/Math.cos(i)+")";break;case bi.RIGHT:i=Math.atan(this.height/this.width),e=" rotateY("+i+"rad) scaleX("+1/Math.cos(i)+")"}return e}get floorBrightness(){let e=1;if(!this.isSurfaceShading)return e;switch(this.slopeDirection){case bi.TOP:e=.4;break;case bi.BOTTOM:e=1;break;case bi.LEFT:e=.6;break;case bi.RIGHT:e=.9}return e}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){Ue.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5730\u5f62\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(ps,{title:r,left:i.x-250,top:i.y-150,width:550,height:380}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(He(Nn),He(Zu),He(Bg),He(hr),He(Ai),He(qn),He(Ki),He(Ci),He(Yn),He(wl))},t.\u0275cmp=fn({type:t,selectors:[["terrain"]],hostBindings:function(e,i){1&e&&Ae("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{terrain:"terrain",is3D:"is3D"},decls:8,vars:24,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.option","movable.disable","movable.interact","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"ngClass","rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],[4,"ngIf"],[1,"is-3d","texture",2,"z-index","1",3,"ngClass","ngStyle"],["class","is-3d","style","display:flex; align-items: center; border-left: 2px dashed blanchedalmond; position: absolute; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],["style","opacity: 0.7; filter: brightness(0) blur(1px); transform: translateZ(0.3px) scale(0.98); backface-visibility: visible","class","is-3d texture chrome-smooth-image-trick",3,"ngClass","background-image",4,"ngIf"],[1,"is-3d","texture","chrome-smooth-image-trick",2,"opacity","0.7","filter","brightness(0) blur(1px)","transform","translateZ(0.3px) scale(0.98)","backface-visibility","visible",3,"ngClass"],[1,"is-3d","texture","chrome-smooth-image-trick",3,"ngClass","ngStyle"],["class","is-3d texture of-wall-top chrome-smooth-image-trick","style","transform: translateY(-100%) rotateX(90deg) rotateZ(180deg) scaleX(-1.0)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-top","chrome-smooth-image-trick",2,"transform","translateY(-100%) rotateX(90deg) rotateZ(180deg) scaleX(-1.0)",3,"ngClass"],["class","is-3d texture of-wall-bottom chrome-smooth-image-trick","style","transform: rotateX(-90deg)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-bottom","chrome-smooth-image-trick",2,"transform","rotateX(-90deg)",3,"ngClass"],["class","is-3d texture of-wall-left chrome-smooth-image-trick","style","transform: rotateZ(90deg) rotateX(-90deg) scaleX(-1.0) translateX(-100%) translateY(-100%)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-left","chrome-smooth-image-trick",2,"transform","rotateZ(90deg) rotateX(-90deg) scaleX(-1.0) translateX(-100%) translateY(-100%)",3,"ngClass"],["class","is-3d texture of-wall-right chrome-smooth-image-trick","style","transform: rotateZ(-90deg) rotateX(-90deg) translateY(-100%)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-right","chrome-smooth-image-trick",2,"transform","rotateZ(-90deg) rotateX(-90deg) translateY(-100%)",3,"ngClass"],[1,"is-3d",2,"z-index","0"],[1,"pedestal-grab","rotate-grab","is-3d"],[1,"rotate-grab","of-left-top","rotate-grab-icon","is-3d"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","rotate-grab-icon","is-3d"],[1,"rotate-grab","of-right-bottom","rotate-grab-icon","is-3d"],[1,"rotate-grab","of-right-top","rotate-grab-icon","is-3d"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","position","absolute","transform-origin","top left",3,"ngStyle"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"]],template:function(e,i){1&e&&(Q(0,"div",0),Ae("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),Q(1,"div",1),Ae("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Te(2,Bte,2,1,"ng-container",2),Q(3,"div",3),Te(4,jte,3,13,"ng-container",2),Te(5,Zte,5,4,"ng-container",2),ne(),Te(6,Xte,15,4,"ng-container",2),ne(),Te(7,Qte,5,7,"div",4),ne()),2&e&&(ut("width",i.width*i.gridSize,"px")("height",i.depth*i.gridSize,"px"),oe("movable.option",i.movableOption)("movable.disable",i.isLocked)("movable.interact",i.isInteract),G(1),oe("ngClass",wt(17,Jte,!i.isLocked))("rotable.option",i.rotableOption)("rotable.disable",i.isLocked),G(1),oe("ngIf",i.hasFloor&&i.isVisibleFloor&&0<(null==i.floorImage?null:i.floorImage.url.length)),G(1),oe("ngClass",un(19,ene,i.height<.5&&0==i.altitude,i.height>=.5&&0==i.altitude))("ngStyle",wt(22,rM,"translateZ("+i.altitude*i.gridSize+"px)")),G(1),oe("ngIf",i.hasFloor&&i.isVisibleFloor&&0<(null==i.floorImage?null:i.floorImage.url.length)),G(1),oe("ngIf",i.isWallExist),G(1),oe("ngIf",!i.isLocked),G(1),oe("ngIf",i.isAltitudeIndicate&&!((i.isSlope||i.isWallExist)&&-i.height<i.altitude&&i.altitude<0)&&(i.terreinAltitude<=-.5||.5<=i.terreinAltitude)))},dependencies:[si,Bn,fr,Sl,Tc,$i],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{height:100%;width:100%}.texture[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;background-repeat:no-repeat;background-size:100% 100%;height:100%;width:100%}.of-wall-top[_ngcontent-%COMP%]{top:0;left:0;transform-origin:50% 100%;transform:translateY(-100%) rotateX(90deg) rotate(180deg) scaleX(-1);filter:brightness(.3)}.of-wall-bottom[_ngcontent-%COMP%]{bottom:0;left:0;transform-origin:50% 100%;transform:rotateX(-90deg)}.of-wall-left[_ngcontent-%COMP%]{top:0;left:0;transform-origin:0% 0%;transform:rotate(90deg) rotateX(-90deg) scaleX(-1) translate(-100%) translateY(-100%);filter:brightness(.5)}.of-wall-right[_ngcontent-%COMP%]{top:0;right:0;transform-origin:100% 0%;transform:rotate(-90deg) rotateX(-90deg) translateY(-100%);filter:brightness(.8)}.of-wall-top.is-slope[_ngcontent-%COMP%], .of-wall-bottom.is-slope[_ngcontent-%COMP%], .of-wall-left.is-slope[_ngcontent-%COMP%], .of-wall-right.is-slope[_ngcontent-%COMP%]{-webkit-clip-path:polygon(100% 0%,0% 100%,100% 100%);clip-path:polygon(100% 0%,0% 100%,100% 100%)}.of-wall-top.is-inverse-slope[_ngcontent-%COMP%], .of-wall-bottom.is-inverse-slope[_ngcontent-%COMP%], .of-wall-left.is-inverse-slope[_ngcontent-%COMP%], .of-wall-right.is-inverse-slope[_ngcontent-%COMP%]{-webkit-clip-path:polygon(0% 0%,100% 100%,0% 100%);clip-path:polygon(0% 0%,100% 100%,0% 100%)}.of-wall-top.no-shadow[_ngcontent-%COMP%], .of-wall-left.no-shadow[_ngcontent-%COMP%], .of-wall-right.no-shadow[_ngcontent-%COMP%]{filter:brightness(1)}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;position:absolute;inset:-14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.rotate-grab[_ngcontent-%COMP%]{opacity:0;z-index:-1}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;border:solid 2px #CCCCCC;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:0;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;transform-style:preserve-3d;transform:translateZ(.1px)}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px;border-radius:14px 7px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px;border-radius:7px 14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px;border-radius:14px 7px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px;border-radius:7px 14px}.blinking-animation[_ngcontent-%COMP%]{animation:blink 1s linear infinite alternate}@keyframes blink{0%{opacity:.9}to{opacity:.5}}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.upright-transform[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.fall[_ngcontent-%COMP%]{transition:transform 132ms cubic-bezier(.21,.97,.75,1.25)}"],changeDetection:0}),t})();const nne=["cursor"],ine=["rotate"],rne=["opacity"];function one(t,n){if(1&t&&(Q(0,"div",7,8)(2,"div",9),Lt(3,"safe"),Q(4,"div",10)(5,"span",11),ve(6),ne()()()()),2&t){const e=n.$implicit,i=me(2);ut("background-image","radial-gradient(circle, transparent 17px, "+i.color+" 18px), radial-gradient(circle, transparent 16px, rgba(240, 218, 189) 17px)"),oe("ngClass",e),G(2),ut("background-image",Bt(3,8,"url("+i.iconUrl+")","style")),G(2),ut("background-color",i.color),G(2),lt(i.name)}}const sne=function(){return["is-front","is-back"]};function ane(t,n){1&t&&(it(0),Q(1,"div",1,2)(3,"div",3,4)(5,"div",5),Te(6,one,7,11,"div",6),ne()()(),rt()),2&t&&(G(6),oe("ngForOf",xa(1,sne)))}class Kr{constructor(n,e,i,r){this.changeDetector=n,this.batchService=e,this.coordinateService=i,this.ngZone=r,this.cursor=Qe.myCursor,this.cursorElement=null,this.opacityElements=[],this.rotateElement=null,this.fadeOutTimer=null,this.updateInterval=null,this.callcack=o=>this.onMouseMove(o),this._x=0,this._y=0}get iconUrl(){return this.cursor.image.url}get name(){return this.cursor.name}get isMine(){return this.cursor.isMine}get color(){return this.cursor.color&&"#ffffff"!=this.cursor.color?this.cursor.color:"#f0dabd"}get rotateZ(){return Kr.viewRotateZ}get nameTagRotate(){let n=Kr.viewRotateX%360-90;return-(n>0?n:360+n)}get delayMs(){let n=16.6*Ot.peerIds.length;return n<100?100:n}ngOnInit(){this.isMine||Ue.register(this).on("CURSOR_MOVE",n=>{n.sendFrom===this.cursor.peerId&&this.batchService.add(()=>{this.stopTransition(),this.setAnimatedTransition(),this.setPosition(n.data[0],n.data[1],n.data[2]),this.setRotate(),this.resetFadeOut(),this.changeDetector.markForCheck()},this)}).on("TABLE_VIEW_ROTATE",-1e3,n=>{this.ngZone.run(()=>{Kr.viewRotateX=n.data.x,Kr.viewRotateZ=n.data.z,this.rotateElement&&this.setRotate(),this.changeDetector.markForCheck()})})}ngAfterViewInit(){this.isMine?this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousemove",this.callcack),document.body.addEventListener("touchmove",this.callcack)}):(this.cursorElement=this.cursorElementRef.nativeElement,this.opacityElements=this.opacityElementRefs.map(n=>n.nativeElement),this.rotateElement=this.rotateElementRef.nativeElement,this.setAnimatedTransition(),this.setPosition(0,0,0),this.rotateElement&&this.setRotate(),this.resetFadeOut())}ngOnDestroy(){document.body.removeEventListener("mousemove",this.callcack),document.body.removeEventListener("touchmove",this.callcack),Ue.unregister(this),this.batchService.remove(this),this.fadeOutTimer&&this.fadeOutTimer.clear()}onMouseMove(n){let e=n.touches?n.changedTouches[0].pageX:n.pageX,i=n.touches?n.changedTouches[0].pageY:n.pageY;e===this._x&&i===this._y||(this._x=e,this._y=i,this._target=n.target,this.updateInterval||(this.updateInterval=setTimeout(()=>{this.updateInterval=null,this.calcLocalCoordinate(this._x,this._y,this._target)},this.delayMs)))}calcLocalCoordinate(n,e,i){if(!document.getElementById("app-table-layer").contains(i))return;let r={x:n,y:e,z:0};r=this.coordinateService.calcTabletopLocalCoordinate(r,i),Ue.call("CURSOR_MOVE",[r.x,r.y,r.z])}resetFadeOut(){this.opacityElements.forEach(n=>{n.style.opacity="0.8"}),null==this.fadeOutTimer&&(this.fadeOutTimer=new Oa(()=>{this.opacityElements.forEach(n=>{n.style.opacity="0.0"})},3e3)),this.fadeOutTimer.reset()}stopTransition(){this.cursorElement.style.transform=window.getComputedStyle(this.cursorElement).transform}setAnimatedTransition(){this.cursorElement.style.transition=`transform ${this.delayMs+33}ms linear, opacity 0.5s ease-out`}setPosition(n,e,i){this.cursorElement.style.transform=`translateX(${n.toFixed(4)}px) translateY(${e.toFixed(4)}px) translateZ(${i.toFixed(4)}px)`}setRotate(){this.rotateElement.style.transform=`rotateZ(${-this.rotateZ}deg) rotateX(${this.nameTagRotate}deg)`}}Kr.viewRotateX=50,Kr.viewRotateZ=10,Kr.ctor=void Ue.register(Kr).on("TABLE_VIEW_ROTATE",-1e3,t=>{Kr.viewRotateX=t.data.x,Kr.viewRotateZ=t.data.z}),Kr.\u0275fac=function(n){return new(n||Kr)(He(Ki),He(Pg),He(wl),He(Nn))},Kr.\u0275cmp=fn({type:Kr,selectors:[["peer-cursor"],["","peer-cursor",""]],viewQuery:function(n,e){if(1&n&&(wn(nne,5),wn(ine,5),wn(rne,5)),2&n){let i;Cn(i=xn())&&(e.cursorElementRef=i.first),Cn(i=xn())&&(e.rotateElementRef=i.first),Cn(i=xn())&&(e.opacityElementRefs=i)}},inputs:{cursor:"cursor"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"component","is-3d","is-transition","is-pointer-events-none"],["cursor",""],[1,"is-3d"],["rotate",""],[1,"upright-transform","is-3d"],["class","peer-cursor is-3d is-opacity-transition",3,"ngClass","background-image",4,"ngFor","ngForOf"],[1,"peer-cursor","is-3d","is-opacity-transition",3,"ngClass"],["opacity",""],[1,"icon","is-3d"],[1,"name","is-center","is-3d"],[1,"is-3d",2,"white-space","nowrap","color","whitesmoke"]],template:function(n,e){1&n&&Te(0,ane,7,2,"ng-container",0),2&n&&oe("ngIf",!e.isMine)},dependencies:[si,_i,Bn,$i],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;overflow:visible;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.is-transition[_ngcontent-%COMP%]{transition:transform 133ms linear}.is-opacity-transition[_ngcontent-%COMP%]{transition:opacity .5s ease-out}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.peer-cursor[_ngcontent-%COMP%]{height:45px;width:45px;position:absolute;left:0;top:0;box-sizing:border-box;border:solid 1px rgba(240,218,189);border-radius:50% 50% 5%;transform-origin:100% 100%;-webkit-backface-visibility:hidden;backface-visibility:hidden}.is-front[_ngcontent-%COMP%]{transform:translate(-100%) translateY(-100%) rotateX(-90deg) rotate(45deg)}.is-back[_ngcontent-%COMP%]{transform:translate(-100%) translateY(-100%) rotateX(-90deg) rotateY(180deg) rotate(45deg)}.icon[_ngcontent-%COMP%]{overflow:visible;height:100%;width:100%;border-radius:100%;background-position:top,center;background-repeat:no-repeat;background-size:cover;background-color:transparent;transform:rotate(-45deg) scale(.85)}.name[_ngcontent-%COMP%]{box-sizing:border-box;font-size:7px;padding:2px 5px;border-radius:14px;color:#ccc;background-color:#1e1e1ecc;transform-origin:center}.is-center[_ngcontent-%COMP%]{position:absolute;left:50%;top:-26px;transform:translate(-50%)}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}"]});const lne=["textArea"];function cne(t,n){if(1&t&&(Q(0,"div",20),ve(1),ne()),2&t){const e=me();G(1),lt(e.title)}}function une(t,n){if(1&t&&(Q(0,"div",20),ve(1),ne()),2&t){const e=me();G(1),lt(e.title)}}const dne=function(t){return{"is-grab":t}},Gv=function(t){return{transform:t}};function fne(t,n){if(1&t&&mt(0,"div",21),2&t){const e=me();ut("width",(e.width-1)*e.gridSize,"px")("min-height",e.gridSize/2,"px"),oe("ngClass",wt(6,dne,!e.isLocked))("ngStyle",wt(8,Gv,"translateX("+e.gridSize/2+"px) translateY("+-e.gridSize/4+"px)"))}}function hne(t,n){1&t&&(Q(0,"div")(1,"div",15)(2,"i",16),ve(3,"autorenew"),ne()(),Q(4,"div",17)(5,"i",16),ve(6,"autorenew"),ne()()())}const pne=function(t){return{transform:t}};function gne(t,n){if(1&t&&(Q(0,"div",22)(1,"div",23)(2,"span",24),ve(3),ne(),Q(4,"span",25),ve(5),ne()()()),2&t){const e=me();ut("height",e.math.abs(e.textNoteAltitude*e.gridSize),"px"),oe("ngStyle",wt(5,pne,"rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),G(3),lt(e.math.abs(e.textNoteAltitude)),G(2),lt(e.textNoteAltitude)}}const mne=function(t,n){return{"is-transition":t,fall:n}},oM=function(t){return{"is-bg-filter":t}},_ne=function(t,n,e){return{"is-pointer-events-none":t,"is-pointer-events-auto":n,"hide-area":e}},$ne=function(t){return{"hide-area":t}};let vne=(()=>{class t{constructor(e,i,r,o,s,a,h){this.ngZone=e,this.contextMenuService=i,this.elementRef=r,this.panelService=o,this.changeDetector=s,this.pointerDeviceService=a,this.modalService=h,this.textNote=null,this.is3D=!1,this.callbackOnMouseUp=b=>this.onMouseUp(b),this.gridSize=50,this.math=Math,this._transitionTimeout=null,this._transition=!1,this._fallTimeout=null,this._fall=!1,this.calcFitHeightTimer=null,this.movableOption={},this.rotableOption={},this.viewRotateZ=10,this.input=null}get title(){return this.textNote.title}get text(){return this.calcFitHeightIfNeeded(),this.textNote.text}set text(e){this.calcFitHeightIfNeeded(),this.textNote.text=e}get color(){return this.textNote.color}set color(e){this.textNote.color=e}get textShadowCss(){const e=pt.textShadowColor(this.color,"#f2f2f2","#000000");return`${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px,\n    ${e} 0px 0px 0.5px,\n    ${e} 0px 0px 0.5px`}get fontSize(){return this.calcFitHeightIfNeeded(),this.textNote.fontSize}get imageFile(){return this.textNote.imageFile}get rotate(){return this.textNote.rotate}set rotate(e){this.textNote.rotate=e}get height(){return this.adjustMinBounds(this.textNote.height)}get width(){return this.adjustMinBounds(this.textNote.width)}get altitude(){return this.textNote.altitude}set altitude(e){this.textNote.altitude=e}get textNoteAltitude(){let e=this.altitude;if(this.isUpright&&this.altitude<0){if(-this.height<=this.altitude)return 0;e+=this.height}return+e.toFixed(1)}get isUpright(){return this.textNote.isUpright}set isUpright(e){this.textNote.isUpright=e}get isAltitudeIndicate(){return this.textNote.isAltitudeIndicate}set isAltitudeIndicate(e){this.textNote.isAltitudeIndicate=e}get isLocked(){return this.textNote.isLocked}set isLocked(e){this.textNote.isLocked=e}get isWhiteOut(){return this.textNote.isWhiteOut}set isWhiteOut(e){this.textNote.isWhiteOut=e}get isSelected(){return document.activeElement===this.textAreaElementRef.nativeElement}get rubiedText(){return pt.rubyToHtml(pt.escapeHtml(this.text))}get transition(){return this._transition}set transition(e){this._transition=e,this._transitionTimeout&&clearTimeout(this._transitionTimeout),this._transitionTimeout=e?setTimeout(()=>{this._transition=!1},132):null}get fall(){return this._fall}set fall(e){this._fall=e,this._fallTimeout&&clearTimeout(this._fallTimeout),this._fallTimeout=e?setTimeout(()=>{this._fall=!1},132):null}ngOnInit(){Ue.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Ct.instance.get(e.data.identifier);!this.textNote||!i||(this.textNote===i||i instanceof ni&&this.textNote.contains(i))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.textNote,transformCssOffset:"translateZ(0.17px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.textNote}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new ls(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this._transitionTimeout&&clearTimeout(this._transitionTimeout),this._fallTimeout&&clearTimeout(this._fallTimeout),Ue.unregister(this)}onInputStart(e){this.input.cancel(),this.textNote.isLocked&&Ue.trigger("DRAG_LOCKED_OBJECT",{})}onDragstart(e){e.stopPropagation(),e.preventDefault()}onMouseDown(e){if(!this.isSelected){if(e.preventDefault(),this.textNote.toTopmost(),2===e.button)return void Ue.trigger("DRAG_LOCKED_OBJECT",{});this.addMouseEventListeners()}}onMouseUp(e){if(this.pointerDeviceService.isAllowedToOpenContextMenu){let i=window.getSelection();i.isCollapsed||i.removeAllRanges(),this.textAreaElementRef.nativeElement.focus()}this.removeMouseEventListeners(),e.preventDefault()}onRotateMouseDown(e){e.stopPropagation(),e.preventDefault()}onContextMenu(e){this.removeMouseEventListeners(),!this.isSelected&&(e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu)&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,Et.play(st.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,Et.play(st.lock)}},Ht,this.isUpright?{name:"\u2611 \u76f4\u7acb",action:()=>{this.transition=!0,this.isUpright=!1}}:{name:"\u2610 \u76f4\u7acb",action:()=>{this.transition=!0,this.isUpright=!0}},this.isWhiteOut?{name:"\u2611 \u753b\u50cf\u306e\u8272\u629c\u304d",action:()=>{this.isWhiteOut=!1}}:{name:"\u2610 \u753b\u50cf\u306e\u8272\u629c\u304d",action:()=>{this.isWhiteOut=!0}},Ht,this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0}},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.isUpright?this.fall=!0:this.transition=!0,this.altitude=0,Et.play(st.sweep))},altitudeHande:this.textNote},Ht,{name:"\u30e1\u30e2\u3092\u7de8\u96c6...",action:()=>{this.showDetail(this.textNote)}},this.textNote.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.textNote.getUrls().map(r=>{const o=r.value.toString();return{name:r.name?r.name:o,action:()=>{pt.sameOrigin(o)?window.open(o.trim(),"_blank","noopener"):this.modalService.open(lo,{url:o,title:this.textNote.title,subTitle:r.name})},disabled:!pt.validUrl(o),error:pt.validUrl(o)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:pt.validUrl(o)&&!pt.sameOrigin(o)}})},this.textNote.getUrls().length<=0?null:Ht,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.textNote.clone();r.isLocked=!1,console.log("\u30b3\u30d4\u30fc",r),r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.toTopmost(),Et.play(st.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.textNote.destroy(),Et.play(st.sweep)}}],this.title)}onMove(){Et.play(st.cardPick)}onMoved(){Et.play(st.cardPut)}calcFitHeightIfNeeded(){this.calcFitHeightTimer||this.ngZone.runOutsideAngular(()=>{this.calcFitHeightTimer=setTimeout(()=>{this.calcFitHeight(),this.calcFitHeightTimer=null},0)})}calcFitHeight(){let e=this.textAreaElementRef.nativeElement;e.style.height="0",e.scrollHeight>e.offsetHeight&&(e.style.height=e.scrollHeight+"px")}lastNewLineAdjust(e){return null==e?"":this.isSelected||e.lastIndexOf("\n")!=e.length-1?e:e+"\n"}adjustMinBounds(e,i=0){return e<i?i:e}addMouseEventListeners(){document.body.addEventListener("mouseup",this.callbackOnMouseUp,!1)}removeMouseEventListeners(){document.body.removeEventListener("mouseup",this.callbackOnMouseUp,!1)}showDetail(e){Ue.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5171\u6709\u30e1\u30e2\u8a2d\u5b9a";e.title.length&&(r+=" - "+e.title),this.panelService.open(ps,{title:r,left:i.x-350,top:i.y-200,width:560,height:470}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(He(Nn),He(hr),He(Ai),He(qn),He(Ki),He(Ci),He(Yn))},t.\u0275cmp=fn({type:t,selectors:[["text-note"]],viewQuery:function(e,i){if(1&e&&wn(lne,7),2&e){let r;Cn(r=xn())&&(i.textAreaElementRef=r.first)}},hostBindings:function(e,i){1&e&&Ae("dragstart",function(o){return i.onDragstart(o)})("mousedown",function(o){return i.onMouseDown(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{textNote:"textNote",is3D:"is3D"},decls:28,vars:77,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.option","movable.disable","movable.ondragstart","movable.ondragend"],["appRotable","",1,"is-3d",3,"rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],[1,"component-content","is-3d","is-pointer-events-auto"],[1,"is-3d",3,"ngClass","ngStyle"],[1,"upright-transform","is-3d","is-bg-color","is-front","is-bg-texture","chrome-smooth-image-trick",3,"ngClass"],["class","title is-3d is-black-background is-pointer-events-none",4,"ngIf"],["spellcheck","false",1,"textarea","is-3d",3,"ngClass","ngModel","input","ngModelChange"],["textArea",""],[1,"is-3d","is-outline-text","note-text",2,"margin-top","-18px",3,"ngClass","innerHTML"],[1,"upright-transform","is-3d","is-back","is-bg-color","is-bg-texture","chrome-smooth-image-trick",3,"ngClass"],[1,"is-3d","is-pointer-events-none",2,"visibility","hidden"],["spellcheck","false","readonly","",1,"textarea","is-3d","hide-area","is-pointer-events-none",3,"ngModel","ngModelChange"],[1,"is-3d","is-outline-text","note-text","is-pointer-events-none",2,"margin-top","-18px",3,"innerHTML"],["class","grand-grabing-area","style","position: absolute",3,"ngClass","ngStyle","width","min-height",4,"ngIf"],[3,"ngStyle"],[1,"rotate-grab","of-left-top"],[1,"material-icons"],[1,"rotate-grab","of-right-top"],[4,"ngIf"],["class","is-3d","style","display: flex; align-items: center; border-left: 2px dashed blanchedalmond; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],[1,"title","is-3d","is-black-background","is-pointer-events-none"],[1,"grand-grabing-area",2,"position","absolute",3,"ngClass","ngStyle"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","transform-origin","top left",3,"ngStyle"],[1,"is-3d"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"]],template:function(e,i){1&e&&(Q(0,"div",0),Ae("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),Q(1,"div",1),Ae("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Q(2,"div",2)(3,"div",3)(4,"div",4),Lt(5,"safe"),Te(6,cne,2,1,"div",5),Q(7,"textarea",6,7),Ae("input",function(){return i.calcFitHeight()})("ngModelChange",function(o){return i.text=o}),ne(),mt(9,"div",8),Lt(10,"safe"),ne(),Q(11,"div",9),Lt(12,"safe"),Q(13,"div",10),Te(14,une,2,1,"div",5),Q(15,"textarea",11),Ae("ngModelChange",function(o){return i.text=o}),ne(),mt(16,"div",12),Lt(17,"safe"),ne()()(),Te(18,fne,1,10,"div",13),Q(19,"div",14)(20,"div",15)(21,"i",16),ve(22),ne()(),Q(23,"div",17)(24,"i",16),ve(25),ne()()(),Te(26,hne,7,0,"div",18),ne()(),Te(27,gne,6,7,"div",19),ne()),2&e&&(oe("movable.option",i.movableOption)("movable.disable",i.isSelected||i.isLocked),G(1),oe("rotable.option",i.rotableOption)("rotable.disable",i.isLocked),G(1),ut("width",i.width*i.gridSize,"px"),G(1),oe("ngClass",un(60,mne,i.transition,i.fall))("ngStyle",wt(63,Gv,"translateZ("+i.altitude*i.gridSize+"px) rotateY(90deg) rotateZ("+(i.isUpright?0:90)+"deg) rotateY(-90deg)")),G(1),ut("background-image",Bt(5,48,"url("+(null==i.imageFile?null:i.imageFile.url)+")","style"))("width",i.width*i.gridSize,"px")("min-height",i.height*i.gridSize,"px"),oe("ngClass",wt(65,oM,i.isWhiteOut&&(null==i.imageFile?null:i.imageFile.url.length)>0)),G(2),oe("ngIf",i.title.length),G(1),ut("font-size",i.fontSize+9,"px"),oe("ngClass",mo(67,_ne,!i.isSelected,i.isSelected,!i.isSelected))("ngModel",i.text),G(2),ut("font-size",i.fontSize+9,"px")("color",i.color)("text-shadow",i.textShadowCss),oe("ngClass",wt(71,$ne,i.isSelected))("innerHTML",Bt(10,51,i.lastNewLineAdjust(i.rubiedText),"html"),lr),G(2),ut("background-image",Bt(12,54,"url("+(null==i.imageFile?null:i.imageFile.url)+")","style"))("width",i.width*i.gridSize,"px")("min-height",i.height*i.gridSize,"px"),oe("ngClass",wt(73,oM,i.isWhiteOut&&(null==i.imageFile?null:i.imageFile.url.length)>0)),G(3),oe("ngIf",i.title.length),G(1),ut("font-size",i.fontSize+9,"px"),oe("ngModel",i.text),G(1),ut("font-size",i.fontSize+9,"px"),oe("innerHTML",Bt(17,57,i.lastNewLineAdjust(i.rubiedText),"html"),lr),G(2),oe("ngIf",!i.isLocked),G(1),oe("ngStyle",wt(75,Gv,"translateZ("+i.altitude*i.gridSize+"px)")),G(3),lt(i.isLocked?"lock":"autorenew"),G(3),lt(i.isLocked?"lock":"autorenew"),G(1),oe("ngIf",!i.isLocked),G(1),oe("ngIf",i.isAltitudeIndicate&&i.math.abs(i.textNoteAltitude)>=.5))},dependencies:[si,Bn,fr,Ii,Mi,yi,Sl,Tc,$i],styles:['[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;width:1px;height:0}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;transform:translate(-50%)}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;-webkit-backface-visibility:hidden;backface-visibility:hidden}.is-front[_ngcontent-%COMP%]{transform-origin:50% 100%;transform:rotateX(-90deg)}.is-back[_ngcontent-%COMP%]{transform-origin:50% 100%;transform:rotateX(-90deg) rotateY(180deg)}.is-bg-texture[_ngcontent-%COMP%]{background-repeat:no-repeat;background-size:100% 100%}.is-bg-filter[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:rgba(255,255,255,.7);transition:background-color .2s}.is-bg-color[_ngcontent-%COMP%]{box-sizing:border-box;color:#444;background-color:#f0dabde6;border:solid 1px #999}.title[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;-webkit-backface-visibility:hidden;backface-visibility:hidden}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;resize:none;overflow:hidden;box-sizing:border-box;background:none;border:none;border-radius:0;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1rem;padding:2px;margin:0;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;-webkit-backface-visibility:hidden;backface-visibility:hidden}.textarea[_ngcontent-%COMP%]:focus{background:rgba(255,255,255,.75)}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.is-outline-text[_ngcontent-%COMP%]{font-size:24px;color:#444;text-shadow:#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:42px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;text-align:center;padding:2px;background-color:#ccc;border-radius:28px;color:#444;font-size:8px}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-21px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-21px}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.fall[_ngcontent-%COMP%]{transition:transform 132ms cubic-bezier(.21,.97,.75,1.25)}.hide-area[_ngcontent-%COMP%]{overflow:hidden!important;font-size:0pt!important;width:0px!important;height:0px!important;margin:0!important;padding:0!important;border:0px none!important}.note-text[_ngcontent-%COMP%]{font-family:Cambria,Georgia;padding:2px;white-space:pre-wrap;-webkit-backface-visibility:hidden;backface-visibility:hidden;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}'],changeDetection:0}),t})();function bne(t,n){1&t&&(it(0),Q(1,"div",20)(2,"div",21)(3,"div",22),ve(4,"autorenew"),ne(),Q(5,"div",23),ve(6,"autorenew"),ne()()(),rt())}function yne(t,n){1&t&&(Q(0,"i",24),ve(1,"lock"),ne())}function Cne(t,n){1&t&&(Q(0,"span"),ve(1,"\uff1a"),ne())}function wne(t,n){if(1&t&&(Q(0,"span"),ve(1),ne()),2&t){const e=me();G(1),lt(e.face)}}function xne(t,n){1&t&&(Q(0,"span"),ve(1,"???"),ne())}function Ene(t,n){1&t&&(Q(0,"i",24),ve(1,"lock"),ne())}function Tne(t,n){1&t&&(Q(0,"span"),ve(1,"\uff1a"),ne())}function Sne(t,n){if(1&t&&(Q(0,"span"),ve(1),ne()),2&t){const e=me();G(1),lt(e.face)}}function Ine(t,n){1&t&&(Q(0,"span"),ve(1,"???"),ne())}const Mne=function(t,n){return{"background-color":t,transform:n}};function kne(t,n){if(1&t&&(Q(0,"div",25)(1,"div",26)(2,"b"),ve(3),ne()(),Q(4,"div",27)(5,"b"),ve(6),ne()()()),2&t){const e=me();oe("ngStyle",un(3,Mne,e.ownerColor+"dd","translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateX("+e.nameTagRotate+"deg)")),G(3),lt(e.ownerName),G(3),lt(e.ownerName)}}const sM=function(t,n){return{"is-black-mask":t,"is-harf-black-mask":n}};function Dne(t,n){if(1&t&&(mt(0,"img",28),Lt(1,"safe")),2&t){const e=me();oe("src",Bt(1,2,e.imageFile.url,"resourceUrl"),vn)("ngClass",un(5,sM,!e.isVisible,e.isMine||e.isGMMode&&e.hasOwner))}}function Ane(t,n){if(1&t&&(mt(0,"img",29),Lt(1,"safe")),2&t){const e=me();oe("src",Bt(1,2,e.backFaceImageFile.url,"resourceUrl"),vn)("ngClass",un(5,sM,!e.isVisible,e.isMine||e.isGMMode&&e.hasOwner||e.isVisible&&e.isCoin))}}function Pne(t,n){1&t&&(mt(0,"img",30),Lt(1,"safe")),2&t&&oe("src",Bt(1,1,me().imageFile.url,"resourceUrl"),vn)}function Nne(t,n){if(1&t&&(mt(0,"img",30),Lt(1,"safe")),2&t){const e=me();ut("transform",e.isCoin?"scaleX(-1)":"scaleX(-1) scaleY(-1)"),oe("src",Bt(1,3,e.backFaceImageFile.url,"resourceUrl"),vn)}}const One=function(t){return{"is-gray-border":t}},Fne=function(t){return{transform:t}};let Rne=(()=>{class t{constructor(e,i,r,o,s,a,h,b,ee){this.ngZone=e,this.panelService=i,this.contextMenuService=r,this.elementRef=o,this.changeDetector=s,this.pointerDeviceService=a,this.imageService=h,this.modalService=b,this.chatMessageService=ee,this.diceSymbol=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null,this.viewRotateX=50,this.viewRotateZ=10}get face(){return this.diceSymbol.face}set face(e){this.diceSymbol.face=e}get owner(){return this.diceSymbol.owner}set owner(e){this.diceSymbol.owner=e}get rotate(){return this.diceSymbol.rotate}set rotate(e){this.diceSymbol.rotate=e}get name(){return this.diceSymbol.name}set name(e){this.diceSymbol.name=e}get size(){return this.adjustMinBounds(this.diceSymbol.size)}get faces(){return this.diceSymbol.faces}get nothingFaces(){return this.diceSymbol.nothingFaces}get imageFile(){return this.imageService.getEmptyOr(this.diceSymbol.imageFile)}get backFaceImageFile(){return this.imageService.getEmptyOr(this.diceSymbol.backFaceImageFile)}get isGMMode(){return this.diceSymbol.isGMMode}get isMine(){return this.diceSymbol.isMine}get hasOwner(){return this.diceSymbol.hasOwner}get ownerName(){return this.diceSymbol.ownerName}get ownerColor(){return this.diceSymbol.ownerColor}get isVisible(){return this.diceSymbol.isVisible}get isDropShadow(){return this.diceSymbol.isDropShadow}set isDropShadow(e){this.diceSymbol.isDropShadow=e}get isLock(){return this.diceSymbol.isLock}set isLock(e){this.diceSymbol.isLock=e}get isCoin(){return this.diceSymbol.isCoin}get isIconHidden(){return null!=this.iconHiddenTimer}get nameTagRotate(){let e=this.viewRotateX%360-90,i=(this.viewRotateZ+this.rotate)%360;return i=i>0?i:360+i,(e>0?e:360+e)*(this.isFlip?1:-1)}get isFlip(){let e=(this.viewRotateZ+this.rotate)%360;return e=e>0?e:360+e,90<e&&e<270}ngOnInit(){Ue.register(this).on("ROLL_DICE_SYMBOL",e=>{e.data.identifier===this.diceSymbol.identifier&&this.ngZone.run(()=>{this.animeState="inactive",this.changeDetector.markForCheck(),queueMicrotask(()=>{this.animeState="active",this.changeDetector.markForCheck()})})}).on("UPDATE_GAME_OBJECT",e=>{let i=Ct.instance.get(e.data.identifier);!this.diceSymbol||!i||(this.diceSymbol===i||i instanceof ni&&this.diceSymbol.contains(i)||i instanceof Qe&&i.userId===this.diceSymbol.owner)&&this.changeDetector.markForCheck()}).on("DICE_ALL_OPEN",e=>{this.owner&&!this.isLock&&(this.owner="",Et.play(st.unlock),this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u306e${this.isCoin?"\u8868\uff0f\u88cf":"\u76ee"}\u3092\u516c\u958b \u2192 ${this.face}`))}).on("TABLE_VIEW_ROTATE",e=>{this.ngZone.run(()=>{this.viewRotateX=e.data.x,this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=Qe.findByPeerId(e.data.peerId);(!i||this.diceSymbol.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.diceSymbol,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain","text-note","character"]},this.rotableOption={tabletopObject:this.diceSymbol}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new ls(this.elementRef.nativeElement)}),this.input.onStart=e=>this.ngZone.run(()=>this.onInputStart(e))}ngOnDestroy(){this.input.destroy(),Ue.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onInputStart(e){this.startDoubleClickTimer(e),this.startIconHiddenTimer()}startDoubleClickTimer(e){if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(()=>this.stopDoubleClickTimer(),e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}stopDoubleClickTimer(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}onDoubleClick(){this.stopDoubleClickTimer(),(this.doubleClickPoint.x-this.input.pointer.x)**2+(this.doubleClickPoint.y-this.input.pointer.y)**2<100&&this.isVisible&&this.diceRoll()}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];if(r.push({name:this.isCoin?"\u30b3\u30a4\u30f3\u30c8\u30b9":"\u30c0\u30a4\u30b9\u3092\u632f\u308b",action:()=>{this.diceRoll()},disabled:!this.isVisible,default:this.isVisible}),r.push(Ht),(this.isMine||this.hasOwner)&&r.push({name:(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+"\u3092\u516c\u958b",action:()=>{this.owner="",Et.play(st.unlock),this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u306e${this.isCoin?"\u8868\uff0f\u88cf":"\u76ee"}\u3092\u516c\u958b \u2192 ${this.face}`)}}),this.isMine||r.push({name:"\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{this.owner=Ot.peerContext.userId,this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u3092\u81ea\u5206\u3060\u3051\u898b\u305f`),Et.play(st.lock)}}),r.push(this.isLock?{name:"\u2611 \u4e00\u6589\u516c\u958b\u3057\u306a\u3044",action:()=>{this.isLock=!1,Et.play(st.unlock)},disabled:this.hasOwner&&!this.isVisible}:{name:"\u2610 \u4e00\u6589\u516c\u958b\u3057\u306a\u3044",action:()=>{this.isLock=!0,Et.play(st.lock)},disabled:this.hasOwner&&!this.isVisible}),this.isVisible){let o=[],s=this.nothingFaces;s.length>0&&(s.forEach(a=>{o.push({name:`${this.face==a?"\u25c9":"\u25cb"} ${a}\u3000`,action:()=>{Et.play(st.dicePut),this.face=a}})}),o.push(Ht)),this.faces.forEach(a=>{o.push({name:`${this.face==a?"\u25c9":"\u25cb"} ${a}\u3000`,action:()=>{""===this.owner&&Et.play(st.dicePut),""===this.owner&&this.face!=a&&this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u306e${this.isCoin?"\u8868\uff0f\u88cf":"\u76ee"}\u3092\u5909\u66f4 \u2192 ${a}`),this.face=a}})}),r.push({name:this.isCoin?"\u8868\uff0f\u88cf":"\u30c0\u30a4\u30b9\u76ee",action:null,subActions:o})}r.push(Ht),r.push(this.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!1}}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!0}}),r.push(Ht),r.push({name:"\u8a73\u7d30\u3092\u8868\u793a...",action:()=>{this.showDetail(this.diceSymbol)}}),this.diceSymbol.getUrls().length>0&&(r.push({name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.diceSymbol.getUrls().map(o=>{const s=o.value.toString();return{name:o.name?o.name:s,action:()=>{pt.sameOrigin(s)?window.open(s.trim(),"_blank","noopener"):this.modalService.open(lo,{url:s,title:this.diceSymbol.name,subTitle:o.name})},disabled:!pt.validUrl(s),error:pt.validUrl(s)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:pt.validUrl(s)&&!pt.sameOrigin(s)}})}),r.push(Ht)),r.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let o=this.diceSymbol.clone();o.location.x+=this.gridSize,o.location.y+=this.gridSize,o.update(),Et.play(st.dicePut)}}),r.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.diceSymbol.destroy(),Et.play(st.sweep)}}),this.contextMenuService.open(i,r,this.name)}onMove(){Et.play(st.dicePick)}onMoved(){Et.play(st.dicePut)}diceRoll(){Ue.call("ROLL_DICE_SYMBOL",{identifier:this.diceSymbol.identifier}),Et.play(this.isCoin?st.coinToss:st.diceRoll1);let e=this.diceSymbol.diceRoll(),i=`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u3092${this.isCoin?"\u30c8\u30b9\u3057\u305f":"\u632f\u3063\u305f"}`;return""===this.owner&&(i+=` \u2192 ${e}`),this.chatMessageService.sendOperationLog(i),e}showDetail(e){Ue.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(ps,{title:r,left:i.x-300,top:i.y-300,width:600,height:490}).tabletopObject=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}adjustMinBounds(e,i=0){return e<i?i:e}}return t.\u0275fac=function(e){return new(e||t)(He(Nn),He(qn),He(hr),He(Ai),He(Ki),He(Ci),He(Zu),He(Yn),He(Hr))},t.\u0275cmp=fn({type:t,selectors:[["dice-symbol"]],hostBindings:function(e,i){1&e&&Ae("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{diceSymbol:"diceSymbol",is3D:"is3D"},decls:31,vars:48,consts:[["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.option","movable.ondragstart","movable.ondragend"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[1,"pedestal-inner",3,"ngClass"],[1,"pedestal-outer"],[4,"ngIf"],[1,"upright-transform","is-fit-width","is-3d"],[1,"rotate-frame","is-3d"],[1,"rotate-inner","is-3d"],[1,"is-3d",3,"ngStyle"],[1,"name-tag","is-nowrap","is-black-background","is-3d",2,"transform","translateX(-50%)"],[1,"fornt-tag","is-3d"],["class","material-icons lock-icon",4,"ngIf"],[1,"back-tag","is-3d"],["class","owner-tag is-nowrap is-black-background is-3d",3,"ngStyle",4,"ngIf"],["class","image front-face is-3d chrome-smooth-image-trick",3,"src","ngClass",4,"ngIf"],["class","image back-face is-3d chrome-smooth-image-trick","style","transform: rotateY(-180deg)",3,"src","ngClass",4,"ngIf"],[1,"is-3d",2,"position","relative","top","-20%"],["class","image shadow is-3d","style","opacity: 0.7; filter: brightness(0) blur(1px)",3,"src",4,"ngIf"],["class","image shadow is-3d","style","opacity: 0.7; filter: brightness(0) blur(1px)",3,"src","transform",4,"ngIf"],[1,"pedestal-grab","rotate-grab","is-3d"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"material-icons","lock-icon"],[1,"owner-tag","is-nowrap","is-black-background","is-3d",3,"ngStyle"],[1,"fornt-tag","is-3d",2,"color","whitesmoke"],[1,"back-tag","is-3d",2,"color","whitesmoke"],[1,"image","front-face","is-3d","chrome-smooth-image-trick",3,"src","ngClass"],[1,"image","back-face","is-3d","chrome-smooth-image-trick",2,"transform","rotateY(-180deg)",3,"src","ngClass"],[1,"image","shadow","is-3d",2,"opacity","0.7","filter","brightness(0) blur(1px)",3,"src"]],template:function(e,i){1&e&&(Q(0,"div",0),Ae("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),Q(1,"div",1)(2,"div",2),Ae("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),mt(3,"div",3)(4,"div",4),Te(5,bne,7,0,"ng-container",5),Q(6,"div",1)(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"div",10),Ae("@diceRollNameTag.done",function(o){return i.animationShuffleDone(o)}),Q(12,"div",11),Te(13,yne,2,0,"i",12),ve(14),Te(15,Cne,2,0,"span",5),Te(16,wne,2,1,"span",5),Te(17,xne,2,0,"span",5),ne(),Q(18,"div",13),Te(19,Ene,2,0,"i",12),ve(20),Te(21,Tne,2,0,"span",5),Te(22,Sne,2,1,"span",5),Te(23,Ine,2,0,"span",5),ne()()(),Te(24,kne,7,6,"div",14),Q(25,"div",1),Ae("@diceRoll.done",function(o){return i.animationShuffleDone(o)})("@coinFlip.done",function(o){return i.animationShuffleDone(o)}),Te(26,Dne,2,8,"img",15),Te(27,Ane,2,8,"img",16),ne()()()(),Q(28,"div",17),Ae("@diceRoll.done",function(o){return i.animationShuffleDone(o)}),Te(29,Pne,2,4,"img",18),Te(30,Nne,2,6,"img",19),ne()()()()()),2&e&&(ut("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),oe("movable.option",i.movableOption),G(1),oe("@bounceInOut","in"),G(1),oe("rotable.option",i.rotableOption),G(1),oe("ngClass",wt(44,One,i.hasOwner)),G(2),oe("ngIf",!i.isIconHidden),G(3),ut("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),G(2),oe("ngStyle",wt(46,Fne,"translateX("+i.size*i.gridSize/2+"px) rotateX("+i.nameTagRotate+"deg)")),G(1),oe("@changeFaceNameTag",i.isVisible?i.face:null)("@diceRollNameTag",i.animeState),G(2),oe("ngIf",i.isLock&&i.hasOwner),G(1),lt(i.name),G(1),oe("ngIf",0<i.name.length),G(1),oe("ngIf",i.isVisible),G(1),oe("ngIf",!i.isVisible),G(2),oe("ngIf",i.isLock&&i.hasOwner),G(1),lt(i.name),G(1),oe("ngIf",0<i.name.length),G(1),oe("ngIf",i.isVisible),G(1),oe("ngIf",!i.isVisible),G(1),oe("ngIf",i.hasOwner&&0<i.ownerName.length),G(1),ut("transform",i.isCoin?"rotateX(30deg)":""),oe("@changeFace",!i.isCoin&&i.isVisible?i.face:null)("@changeFaceCoin",i.isCoin&&i.isVisible?"\u88cf"==i.face?0:1:null)("@diceRoll",!i.isCoin&&i.animeState)("@coinFlip",i.isCoin&&i.animeState),G(1),oe("ngIf",0<i.imageFile.url.length),G(1),oe("ngIf",0<i.backFaceImageFile.url.length),G(1),ut("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),oe("@changeFace",!i.isCoin&&i.isVisible?i.face:null)("@changeFaceCoin",i.isCoin&&i.isVisible?"\u8868"==i.face?1:2:null)("@diceRoll",i.animeState),G(1),oe("ngIf",!i.isFlip&&i.isDropShadow&&0<i.imageFile.url.length),G(1),oe("ngIf",i.isFlip&&i.isDropShadow&&0<i.backFaceImageFile.url.length))},dependencies:[si,Bn,fr,Sl,Tc,$i],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:100%;box-sizing:border-box;border-top:solid 28px #999;border-left:solid 12px #999;border-right:solid 12px #CCC;border-bottom:solid 28px #CCC;border-radius:22px}.pedestal-inner[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 6px rgb(216,139,75);border-radius:5px}.is-gray-border[_ngcontent-%COMP%]{border-color:#999}.pedestal-outer[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 2px #212121;border-radius:5px}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{bottom:0;left:0;right:0;margin:auto;width:100%;height:auto;vertical-align:bottom}.image.shadow[_ngcontent-%COMP%]{width:100%;height:100%}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:6px;position:absolute;top:-30px;transform-origin:center bottom}.owner-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:12px;padding:3px 9px;border-radius:6px;position:absolute;top:-55px;transform-origin:center bottom}.rotate-frame[_ngcontent-%COMP%]{bottom:0;left:0;right:0}.rotate-inner[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;width:100%;height:auto}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.fornt-tag[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.back-tag[_ngcontent-%COMP%]{position:absolute;top:3px;-webkit-backface-visibility:hidden;backface-visibility:hidden;transform:rotateY(-180deg)}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;bottom:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{position:absolute;width:24px;top:0;left:0;right:0;margin:auto;color:#444}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.material-icons.lock-icon[_ngcontent-%COMP%]{display:inline-block;font-size:smaller;margin-right:2px}.front-face[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.back-face[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;transform:rotateY(-180deg)}"],data:{animation:[Vn("diceRoll",[tn("* => active",[Zt("800ms ease",bn([dt({transform:"scale3d(0.8, 0.8, 0.8) rotateZ(-0deg)",offset:0}),dt({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(-360deg)",offset:.5}),dt({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(-520deg)",offset:.75}),dt({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(-630deg)",offset:.875}),dt({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(-720deg)",offset:1})]))])]),Vn("coinFlip",[tn("* => active",[Zt("800ms ease-out",bn([dt({transform:"scale3d(0.8, 0.8, 0.8) translateY(0%) rotateX(60deg) rotateX(-0deg) rotateY(-0deg)",offset:0}),dt({transform:"scale3d(1.2, 1.2, 1.2)  translateY(-28%) rotateX(60deg) rotateX(-360deg) rotateY(-360deg)",offset:.5}),dt({transform:"scale3d(0.75, 0.75, 0.75) translateY(-40%) rotateX(60deg) rotateX(-520deg) rotateY(-520deg)",offset:.75}),dt({transform:"scale3d(1.125, 1.125, 1.125) translateY(-28%) rotateX(60deg) rotateX(-630deg) rotateY(-630deg)",offset:.875}),dt({transform:"scale3d(1.0, 1.0, 1.0) translateY(0%) rotateX(60deg) rotateX(-720deg) rotateY(-720deg)",offset:1})]))])]),Vn("diceRollNameTag",[tn("* => active",[Zt("800ms ease",bn([dt({transform:"translateX(-50%) scale3d(0.8, 0.8, 0.8) rotateY(0deg)",offset:0}),dt({transform:"translateX(-50%) scale3d(1.2, 1.2, 1.2) rotateY(360deg)",offset:.5}),dt({transform:"translateX(-50%) scale3d(0.75, 0.75, 0.75) rotateY(520deg)",offset:.75}),dt({transform:"translateX(-50%) scale3d(1.125, 1.125, 1.125) rotateY(630deg)",offset:.875}),dt({transform:"translateX(-50%) scale3d(1.0, 1.0, 1.0) rotateY(720deg)",offset:1})]))])]),Vn("changeFace",[tn(":increment,:decrement",[Zt("200ms ease",bn([dt({transform:"scale3d(0.8, 0.8, 0.8) rotateZ(0deg)",offset:0}),dt({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(-360deg)",offset:1})]))])]),Vn("changeFaceCoin",[tn(":increment,:decrement",[Zt("200ms ease",bn([dt({transform:"scale3d(0.8, 0.8, 0.8) rotateX(0deg)",offset:0}),dt({transform:"scale3d(1.0, 1.0, 1.0) rotateX(-720deg)",offset:1})]))])]),Vn("changeFaceNameTag",[tn(":increment,:decrement",[Zt("200ms ease",bn([dt({transform:"translateX(-50%) scale3d(0.8, 0.8, 0.8) rotateY(0deg)",offset:0}),dt({transform:"translateX(-50%) scale3d(1.0, 1.0, 1.0) rotateY(360deg)",offset:1})]))])]),Vn("bounceInOut",[tn("void => *",[Zt("600ms ease",bn([dt({transform:"scale3d(0, 0, 0)",offset:0}),dt({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),dt({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),dt({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),dt({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),tn("* => void",[Zt(100,dt({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),t})();class Wf{constructor(n,e,i){this.canvasElement=n,this.canvasElementRange=e,this.canvasElementCenter=i}makeBrush(n,e,i){n.strokeStyle=i,n.fillStyle=n.strokeStyle,n.lineWidth=1;let r=Math.floor(e/5);return n.font=`bold ${r}px sans-serif`,n.textBaseline="top",n.textAlign="center",n}chkOuterProduct(n,e,i,r,o,s){return(i-n)*(s-e)-(r-e)*(o-n)>=-.01}chkInCircle(n,e,i){return n*n>=e*e+i*i}renderCircle(n){let e=n.gridSize,i=n.areaWidth*e/2,r=n.areaHeight*e/2,s=(Math,-n.centerX%e),a=-n.centerY%e;s>0&&(s-=e),a>0&&(a-=e),n.offSetX&&(s<-.5?s+=e/2:s-=e/2),n.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=n.areaWidth*e,this.canvasElement.height=n.areaHeight*e;let h=this.canvasElement.getContext("2d"),b=0,ee=0,de=this.generateCalcGridPositionFunc(n.gridType,n.centerX,n.centerY,n.areaWidth,n.areaHeight);if(0==n.fillType)this.makeBrush(h,e,n.gridColor),h.beginPath(),h.arc(i,r,n.range*e,0,2*Math.PI,!0),h.fill();else{this.makeBrush(h,e,n.gridColor);for(let ge=0;ge<=n.areaHeight+1;ge++)for(let xe=0;xe<=n.areaWidth+1;xe++){let{gx:ke,gy:Pe}=de(xe,ge,e);if(1==n.fillType)b=ke+s+e/2-i,ee=Pe+a+e/2-r,this.chkInCircle(n.range*e,b,ee)&&this.fillSquare(h,ke+s,Pe+a,e);else{let Oe=0;for(let je=0;je<e;je++)for(let qe=0;qe<e;qe++)b=ke+s+je-i+.5,ee=Pe+a+qe-r+.5,this.chkInCircle(n.range*e,b,ee)&&Oe++;(2==n.fillType&&Oe>=1||3==n.fillType&&Oe>=e*e/2||4==n.fillType&&Oe>=e*e)&&this.fillSquare(h,ke+s,Pe+a,e)}}}this.canvasElementRange.width=n.areaWidth*e,this.canvasElementRange.height=n.areaHeight*e,h=this.canvasElementRange.getContext("2d"),this.makeBrush(h,e,n.rangeColor),h.beginPath(),h.lineWidth=2,h.arc(i,r,n.range*e,0,2*Math.PI,!0),h.stroke(),n.isDocking?(h.beginPath(),h.strokeRect(i-6,r-6,12,12)):(h.beginPath(),h.arc(i,i,5,0,2*Math.PI,!0),h.fill()),this.canvasElementCenter.width=n.areaWidth*e,this.canvasElementCenter.height=n.areaHeight*e,h=this.canvasElementCenter.getContext("2d"),this.makeBrush(h,e,n.rangeColor),n.isDocking?(h.beginPath(),h.strokeRect(i-6,r-6,12,12)):(h.beginPath(),h.arc(i,i,5,0,2*Math.PI,!0),h.fill())}renderLine(n){let e=n.gridSize,i=n.areaWidth*e/2,r=n.areaHeight*e/2,o=Math.PI/180*n.degree,s=-n.centerX%e,a=-n.centerY%e;s>0&&(s-=e),a>0&&(a-=e),n.offSetX&&(s<-.5?s+=e/2:s-=e/2),n.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=n.areaWidth*e,this.canvasElement.height=n.areaHeight*e;let h=this.canvasElement.getContext("2d"),ee=.5*n.width*e,ge=-.5*n.width*e,xe=n.range*e,ke=-.5*n.width*e,Pe=n.range*e,Oe=.5*n.width*e,je=0-e*Math.sqrt(2),qe=ee+e*Math.sqrt(2),Ve=0-e*Math.sqrt(2),We=ge-e*Math.sqrt(2),vt=xe+e*Math.sqrt(2),nt=ke-e*Math.sqrt(2),_t=Pe+e*Math.sqrt(2),Mt=Oe+e*Math.sqrt(2),ht=0*Math.cos(o)-ee*Math.sin(o),yt=0*Math.sin(o)+ee*Math.cos(o),Tt=0*Math.cos(o)-ge*Math.sin(o),nn=0*Math.sin(o)+ge*Math.cos(o),rn=xe*Math.cos(o)-ke*Math.sin(o),En=xe*Math.sin(o)+ke*Math.cos(o),Wn=Pe*Math.cos(o)-Oe*Math.sin(o),Rt=Pe*Math.sin(o)+Oe*Math.cos(o),Ut={clip01x:je*Math.cos(o)-qe*Math.sin(o),clip01y:je*Math.sin(o)+qe*Math.cos(o),clip02x:Ve*Math.cos(o)-We*Math.sin(o),clip02y:Ve*Math.sin(o)+We*Math.cos(o),clip03x:vt*Math.cos(o)-nt*Math.sin(o),clip03y:vt*Math.sin(o)+nt*Math.cos(o),clip04x:_t*Math.cos(o)-Mt*Math.sin(o),clip04y:_t*Math.sin(o)+Mt*Math.cos(o)},jt=0,Yt=0,Fn=this.generateCalcGridPositionFunc(n.gridType,n.centerX,n.centerY,n.areaWidth,n.areaHeight);if(this.makeBrush(h,e,n.gridColor),0==n.fillType)this.makeBrush(h,e,n.gridColor),h.beginPath(),h.moveTo(ht+i,yt+r),h.lineTo(Tt+i,nn+r),h.lineTo(rn+i,En+r),h.lineTo(Wn+i,Rt+r),h.lineTo(ht+i,yt+r),h.fill();else{this.makeBrush(h,e,n.gridColor);for(let Jn=0;Jn<=n.areaHeight+1;Jn++)for(let oi=0;oi<=n.areaWidth+1;oi++){let{gx:Di,gy:Gn}=Fn(oi,Jn,e);if(1==n.fillType)jt=Di+s+e/2-i,Yt=Gn+a+e/2-r,this.chkOuterProduct(ht,yt,Tt,nn,jt,Yt)&&this.chkOuterProduct(Tt,nn,rn,En,jt,Yt)&&this.chkOuterProduct(rn,En,Wn,Rt,jt,Yt)&&this.chkOuterProduct(Wn,Rt,ht,yt,jt,Yt)&&this.fillSquare(h,Di+s,Gn+a,e);else{let Dt=0;for(let Sc=0;Sc<e;Sc++)for(let Bi=0;Bi<e;Bi++)jt=Di+s+Sc-i+.5,Yt=Gn+a+Bi-r+.5,this.chkOuterProduct(ht,yt,Tt,nn,jt,Yt)&&this.chkOuterProduct(Tt,nn,rn,En,jt,Yt)&&this.chkOuterProduct(rn,En,Wn,Rt,jt,Yt)&&this.chkOuterProduct(Wn,Rt,ht,yt,jt,Yt)&&Dt++;(2==n.fillType&&Dt>=1||3==n.fillType&&Dt>=e*e/2||4==n.fillType&&Dt>=e*e)&&this.fillSquare(h,Di+s,Gn+a,e)}}}return this.canvasElementRange.width=n.areaWidth*e,this.canvasElementRange.height=n.areaHeight*e,h=this.canvasElementRange.getContext("2d"),this.makeBrush(h,e,n.rangeColor),h.beginPath(),h.lineWidth=2,h.moveTo(ht+i,yt+r),h.lineTo(Tt+i,nn+r),h.lineTo(rn+i,En+r),h.lineTo(Wn+i,Rt+r),h.lineTo(ht+i,yt+r),h.stroke(),h.beginPath(),h.arc(i,i,5,0,2*Math.PI,!0),h.fill(),this.canvasElementCenter.width=n.areaWidth*e,this.canvasElementCenter.height=n.areaHeight*e,h=this.canvasElementCenter.getContext("2d"),this.makeBrush(h,e,n.rangeColor),h.beginPath(),h.arc(i,i,5,0,2*Math.PI,!0),h.fill(),Ut}static gripAreaPathLine(n){let e=n.gridSize,i=Math.PI/180*n.degree,xe=.5*n.width*e,Pe=-.5*n.width*e,Oe=n.range*e,je=-.5*n.width*e,qe=n.range*e,Ve=.5*n.width*e;return{clip01x:0*Math.cos(i)-xe*Math.sin(i),clip01y:0*Math.sin(i)+xe*Math.cos(i),clip02x:0*Math.cos(i)-Pe*Math.sin(i),clip02y:0*Math.sin(i)+Pe*Math.cos(i),clip03x:Oe*Math.cos(i)-je*Math.sin(i),clip03y:Oe*Math.sin(i)+je*Math.cos(i),clip04x:qe*Math.cos(i)-Ve*Math.sin(i),clip04y:qe*Math.sin(i)+Ve*Math.cos(i)}}renderSquare(n){let e=n.gridSize,i=n.areaWidth*e/2,r=n.areaHeight*e/2,s=(Math,-n.centerX%e),a=-n.centerY%e;s>0&&(s-=e),a>0&&(a-=e),n.offSetX&&(s<-.5?s+=e/2:s-=e/2),n.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=n.areaWidth*e,this.canvasElement.height=n.areaHeight*e;let h=this.canvasElement.getContext("2d"),b=-n.range*e,ee=n.range*e,de=-n.range*e,ge=-n.range*e,xe=n.range*e,ke=-n.range*e,Pe=n.range*e,Oe=n.range*e,ht={clip01x:b-1*e,clip01y:ee+1*e,clip02x:de-1*e,clip02y:ge-1*e,clip03x:xe+1*e,clip03y:ke-1*e,clip04x:Pe+1*e,clip04y:Oe+1*e},yt=0,Tt=0,nn=this.generateCalcGridPositionFunc(n.gridType,n.centerX,n.centerY,n.areaWidth,n.areaHeight);if(this.makeBrush(h,e,n.gridColor),0==n.fillType)this.makeBrush(h,e,n.gridColor),h.beginPath(),h.moveTo(b+i,ee+r),h.lineTo(de+i,ge+r),h.lineTo(xe+i,ke+r),h.lineTo(Pe+i,Oe+r),h.lineTo(b+i,ee+r),h.fill();else{this.makeBrush(h,e,n.gridColor);for(let rn=0;rn<=n.areaHeight+1;rn++)for(let En=0;En<=n.areaWidth+1;En++){let{gx:Wn,gy:Rt}=nn(En,rn,e);if(1==n.fillType)yt=Wn+s+e/2-i,Tt=Rt+a+e/2-r,this.chkOuterProduct(b,ee,de,ge,yt,Tt)&&this.chkOuterProduct(de,ge,xe,ke,yt,Tt)&&this.chkOuterProduct(xe,ke,Pe,Oe,yt,Tt)&&this.chkOuterProduct(Pe,Oe,b,ee,yt,Tt)&&this.fillSquare(h,Wn+s,Rt+a,e);else{let Ut=0;for(let jt=0;jt<e;jt++)for(let Yt=0;Yt<e;Yt++)yt=Wn+s+jt-i+.5,Tt=Rt+a+Yt-r+.5,this.chkOuterProduct(b,ee,de,ge,yt,Tt)&&this.chkOuterProduct(de,ge,xe,ke,yt,Tt)&&this.chkOuterProduct(xe,ke,Pe,Oe,yt,Tt)&&this.chkOuterProduct(Pe,Oe,b,ee,yt,Tt)&&Ut++;(2==n.fillType&&Ut>=1||3==n.fillType&&Ut>=e*e/2||4==n.fillType&&Ut>=e*e)&&this.fillSquare(h,Wn+s,Rt+a,e)}}}return this.canvasElementRange.width=n.areaWidth*e,this.canvasElementRange.height=n.areaHeight*e,h=this.canvasElementRange.getContext("2d"),this.makeBrush(h,e,n.rangeColor),h.beginPath(),h.lineWidth=2,h.moveTo(b+i,ee+r),h.lineTo(de+i,ge+r),h.lineTo(xe+i,ke+r),h.lineTo(Pe+i,Oe+r),h.lineTo(b+i,ee+r),h.stroke(),n.isDocking?(h.beginPath(),h.strokeRect(i-6,r-6,12,12)):(h.beginPath(),h.arc(i,i,5,0,2*Math.PI,!0),h.fill()),this.canvasElementCenter.width=n.areaWidth*e,this.canvasElementCenter.height=n.areaHeight*e,h=this.canvasElementCenter.getContext("2d"),this.makeBrush(h,e,n.rangeColor),n.isDocking?(h.beginPath(),h.strokeRect(i-6,r-6,12,12)):(h.beginPath(),h.arc(i,i,5,0,2*Math.PI,!0),h.fill()),ht}static gripAreaPathSquare(n){let e=n.gridSize;return Math,{clip01x:-n.range*e,clip01y:n.range*e,clip02x:-n.range*e,clip02y:-n.range*e,clip03x:n.range*e,clip03y:-n.range*e,clip04x:n.range*e,clip04y:n.range*e}}renderDiamond(n){let e=n.gridSize,i=n.areaWidth*e/2,r=n.areaHeight*e/2,o=-n.centerX%e,s=-n.centerY%e;o>0&&(o-=e),s>0&&(s-=e),n.offSetX&&(o<-.5?o+=e/2:o-=e/2),n.offSetY&&(s<-.5?s+=e/2:s-=e/2),this.canvasElement.width=n.areaWidth*e,this.canvasElement.height=n.areaHeight*e;let a=this.canvasElement.getContext("2d"),h=-n.range*e,de=-n.range*e,ge=n.range*e,Pe=n.range*e,Mt={clip01x:h-2*e,clip01y:0,clip02x:0,clip02y:de-2*e,clip03x:ge+2*e,clip03y:0,clip04x:0,clip04y:Pe+2*e},ht=0,yt=0,Tt=this.generateCalcGridPositionFunc(n.gridType,n.centerX,n.centerY,n.areaWidth,n.areaHeight);if(this.makeBrush(a,e,n.gridColor),0==n.fillType)this.makeBrush(a,e,n.gridColor),a.beginPath(),a.moveTo(h+i,0+r),a.lineTo(0+i,de+r),a.lineTo(ge+i,0+r),a.lineTo(0+i,Pe+r),a.lineTo(h+i,0+r),a.fill();else{this.makeBrush(a,e,n.gridColor);for(let nn=0;nn<=n.areaHeight+1;nn++)for(let rn=0;rn<=n.areaWidth+1;rn++){let{gx:En,gy:Wn}=Tt(rn,nn,e);if(1==n.fillType)ht=En+o+e/2-i,yt=Wn+s+e/2-r,this.chkOuterProduct(h,0,0,de,ht,yt)&&this.chkOuterProduct(0,de,ge,0,ht,yt)&&this.chkOuterProduct(ge,0,0,Pe,ht,yt)&&this.chkOuterProduct(0,Pe,h,0,ht,yt)&&this.fillSquare(a,En+o,Wn+s,e);else{let Rt=0;for(let Ut=0;Ut<e;Ut++)for(let jt=0;jt<e;jt++)ht=En+o+Ut-i+.5,yt=Wn+s+jt-r+.5,this.chkOuterProduct(h,0,0,de,ht,yt)&&this.chkOuterProduct(0,de,ge,0,ht,yt)&&this.chkOuterProduct(ge,0,0,Pe,ht,yt)&&this.chkOuterProduct(0,Pe,h,0,ht,yt)&&Rt++;(2==n.fillType&&Rt>=1||3==n.fillType&&Rt>=e*e/2||4==n.fillType&&Rt>=e*e)&&this.fillSquare(a,En+o,Wn+s,e)}}}return this.canvasElementRange.width=n.areaWidth*e,this.canvasElementRange.height=n.areaHeight*e,a=this.canvasElementRange.getContext("2d"),this.makeBrush(a,e,n.rangeColor),a.beginPath(),a.lineWidth=2,a.moveTo(h+i,0+r),a.lineTo(0+i,de+r),a.lineTo(ge+i,0+r),a.lineTo(0+i,Pe+r),a.lineTo(h+i,0+r),a.stroke(),n.isDocking?(a.beginPath(),a.strokeRect(i-6,r-6,12,12)):(a.beginPath(),a.arc(i,i,5,0,2*Math.PI,!0),a.fill()),this.canvasElementCenter.width=n.areaWidth*e,this.canvasElementCenter.height=n.areaHeight*e,a=this.canvasElementCenter.getContext("2d"),this.makeBrush(a,e,n.rangeColor),n.isDocking?(a.beginPath(),a.strokeRect(i-6,r-6,12,12)):(a.beginPath(),a.arc(i,i,5,0,2*Math.PI,!0),a.fill()),Mt}static gripAreaPathDiamond(n){let e=n.gridSize;return{clip01x:-n.range*e,clip01y:0,clip02x:0,clip02y:-n.range*e,clip03x:n.range*e,clip03y:0,clip04x:0,clip04y:n.range*e}}renderCorn(n){let e=n.gridSize,i=n.areaWidth*e/2,r=n.areaHeight*e/2,o=Math.PI/180*n.degree,s=-n.centerX%e,a=-n.centerY%e;s>0&&(s-=e),a>0&&(a-=e),n.offSetX&&(s<-.5?s+=e/2:s-=e/2),n.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=n.areaWidth*e,this.canvasElement.height=n.areaHeight*e;let h=this.canvasElement.getContext("2d"),de=n.range*e,ge=-.5*n.width*e,xe=n.range*e,ke=.5*n.width*e,Pe=0-e*Math.sqrt(2),je=0-e*Math.sqrt(2),qe=0-e*Math.sqrt(2),Ve=de-e*Math.sqrt(2),We=ge-e*Math.sqrt(2),vt=de,nt=ge-e*Math.sqrt(2),_t=de+e*Math.sqrt(2),Mt=ge-e*Math.sqrt(2),ht=_t,yt=-Mt,Tt=vt,nn=-nt,rn=Ve,En=-We,Wn=je,Rt=-qe,Yt=de*Math.cos(o)-ge*Math.sin(o),Fn=de*Math.sin(o)+ge*Math.cos(o),Jn=xe*Math.cos(o)-ke*Math.sin(o),oi=xe*Math.sin(o)+ke*Math.cos(o),Di={clip01x:Pe*Math.cos(o)-0*Math.sin(o),clip01y:Pe*Math.sin(o)+0*Math.cos(o),clip02x:je*Math.cos(o)-qe*Math.sin(o),clip02y:je*Math.sin(o)+qe*Math.cos(o),clip03x:Ve*Math.cos(o)-We*Math.sin(o),clip03y:Ve*Math.sin(o)+We*Math.cos(o),clip04x:vt*Math.cos(o)-nt*Math.sin(o),clip04y:vt*Math.sin(o)+nt*Math.cos(o),clip05x:_t*Math.cos(o)-Mt*Math.sin(o),clip05y:_t*Math.sin(o)+Mt*Math.cos(o),clip06x:ht*Math.cos(o)-yt*Math.sin(o),clip06y:ht*Math.sin(o)+yt*Math.cos(o),clip07x:Tt*Math.cos(o)-nn*Math.sin(o),clip07y:Tt*Math.sin(o)+nn*Math.cos(o),clip08x:rn*Math.cos(o)-En*Math.sin(o),clip08y:rn*Math.sin(o)+En*Math.cos(o),clip09x:Wn*Math.cos(o)-Rt*Math.sin(o),clip09y:Wn*Math.sin(o)+Rt*Math.cos(o)},Gn=0,Dt=0,Sc=this.generateCalcGridPositionFunc(n.gridType,n.centerX,n.centerY,n.areaWidth,n.areaHeight);if(0==n.fillType)this.makeBrush(h,e,n.gridColor),h.beginPath(),h.moveTo(0+i,0+r),h.lineTo(Yt+i,Fn+r),h.lineTo(Jn+i,oi+r),h.lineTo(0+i,0+r),h.fill();else{this.makeBrush(h,e,n.gridColor);for(let Bi=0;Bi<=n.areaHeight+1;Bi++)for(let Rs=0;Rs<=n.areaWidth+1;Rs++){let{gx:Dr,gy:za}=Sc(Rs,Bi,e);if(1==n.fillType)Gn=Dr+s+e/2-i,Dt=za+a+e/2-r,this.chkOuterProduct(0,0,Yt,Fn,Gn,Dt)&&this.chkOuterProduct(Yt,Fn,Jn,oi,Gn,Dt)&&this.chkOuterProduct(Jn,oi,0,0,Gn,Dt)&&this.fillSquare(h,Dr+s,za+a,e);else{let Il=0;for(let qv=0;qv<e;qv++)for(let Wv=0;Wv<e;Wv++)Gn=Dr+s+qv-i+.5,Dt=za+a+Wv-r+.5,this.chkOuterProduct(0,0,Yt,Fn,Gn,Dt)&&this.chkOuterProduct(Yt,Fn,Jn,oi,Gn,Dt)&&this.chkOuterProduct(Jn,oi,0,0,Gn,Dt)&&Il++;(2==n.fillType&&Il>=1||3==n.fillType&&Il>=e*e/2||4==n.fillType&&Il>=e*e)&&this.fillSquare(h,Dr+s,za+a,e)}}}return this.canvasElementRange.width=n.areaWidth*e,this.canvasElementRange.height=n.areaHeight*e,h=this.canvasElementRange.getContext("2d"),this.makeBrush(h,e,n.rangeColor),h.beginPath(),h.lineWidth=2,h.moveTo(0+i,0+r),h.lineTo(Yt+i,Fn+r),h.lineTo(Jn+i,oi+r),h.lineTo(0+i,0+r),h.stroke(),h.beginPath(),h.arc(i,i,5,0,2*Math.PI,!0),h.fill(),this.canvasElementCenter.width=n.areaWidth*e,this.canvasElementCenter.height=n.areaHeight*e,h=this.canvasElementCenter.getContext("2d"),this.makeBrush(h,e,n.rangeColor),h.beginPath(),h.arc(i,i,5,0,2*Math.PI,!0),h.fill(),Di}static gripAreaPathCorn(n){let e=n.gridSize,i=Math.PI/180*n.degree,s=n.range*e,a=-.5*n.width*e,ge=s,xe=a,ke=s,Pe=a,Oe=s,je=a,qe=Oe,Ve=-je,We=ke,vt=-Pe,nt=ge,_t=-xe;return{clip01x:0*Math.cos(i)-0*Math.sin(i),clip01y:0*Math.sin(i)+0*Math.cos(i),clip02x:0*Math.cos(i)-0*Math.sin(i),clip02y:0*Math.sin(i)+0*Math.cos(i),clip03x:ge*Math.cos(i)-xe*Math.sin(i),clip03y:ge*Math.sin(i)+xe*Math.cos(i),clip04x:ke*Math.cos(i)-Pe*Math.sin(i),clip04y:ke*Math.sin(i)+Pe*Math.cos(i),clip05x:Oe*Math.cos(i)-je*Math.sin(i),clip05y:Oe*Math.sin(i)+je*Math.cos(i),clip06x:qe*Math.cos(i)-Ve*Math.sin(i),clip06y:qe*Math.sin(i)+Ve*Math.cos(i),clip07x:We*Math.cos(i)-vt*Math.sin(i),clip07y:We*Math.sin(i)+vt*Math.cos(i),clip08x:nt*Math.cos(i)-_t*Math.sin(i),clip08y:nt*Math.sin(i)+_t*Math.cos(i),clip09x:0*Math.cos(i)- -0*Math.sin(i),clip09y:0*Math.sin(i)+-0*Math.cos(i)}}generateCalcGridPositionFunc(n,e,i,r,o){switch(n){case fs.HEX_VERTICAL:return(s,a,h)=>(s+(e%(2*h)<h?1:0)+(r%4==0?1:0))%2==1?{gx:s*h,gy:a*h}:{gx:s*h,gy:a*h+h/2};case fs.HEX_HORIZONTAL:return(s,a,h)=>(a+(i%(2*h)<h?1:0)+(o%4==0?1:0))%2==1?{gx:s*h,gy:a*h}:{gx:s*h+h/2,gy:a*h};default:return(s,a,h)=>({gx:s*h,gy:a*h})}}fillSquare(n,e,i,r){n.beginPath(),n.fillRect(e,i,r,r)}strokeSquare(n,e,i,r){n.beginPath(),n.strokeStyle="#55555533",n.strokeRect(e,i,r,r)}strokeHex(n,e,i,r,o){let s=o===fs.HEX_HORIZONTAL?-30:0,a=r/Math.sqrt(3),h=e+r/2,b=i+r/2;n.beginPath();for(let ee=0;ee<6;ee++){s+=60;let de=Math.PI/180*s,ge=Math.cos(de)*a+h,xe=Math.sin(de)*a+b;n.lineTo(ge,xe)}n.closePath(),n.stroke()}}const Lne=["gridCanvas"],Bne=["rangeCanvas"],zne=["centerPunch"],jne=["rotate"];function Une(t,n){if(1&t&&(Q(0,"div",15)(1,"i",16),ve(2),ne()()),2&t){const e=me();G(2),lt(e.isLocked?"lock":"open_with")}}function Hne(t,n){if(1&t&&(it(0),Q(1,"div",21)(2,"i",16),ve(3),ne()(),rt()),2&t){const e=n.$implicit,i=me(2);G(1),ut("left",i.math.ceil((e-.3)*i.gridSize),"px"),G(2),lt(i.isLocked?"lock":"autorenew")}}function Vne(t,n){if(1&t&&(it(0),Q(1,"div",17),Te(2,Hne,4,3,"ng-container",18),Q(3,"div",19)(4,"i",16),ve(5),ne()(),Q(6,"div",20)(7,"i",16),ve(8),ne()()(),rt()),2&t){const e=me();G(2),oe("ngForOf",e.rotateHandlesLeftPos),G(3),lt(e.isLocked?"lock":"autorenew"),G(3),lt(e.isLocked?"lock":"autorenew")}}const aM=function(t){return{transform:t}};function Gne(t,n){if(1&t&&(Q(0,"div",22)(1,"div",23)(2,"span",24)(3,"i"),ve(4),ne()(),Q(5,"span",25)(6,"i"),ve(7),ne()()(),Q(8,"div",23)(9,"span",26),ve(10),ne(),Q(11,"span",27),ve(12),ne()(),Q(13,"div",28)(14,"span",24)(15,"i"),ve(16),ne()(),Q(17,"span",25)(18,"i"),ve(19),ne()()()()),2&t){const e=me();ut("border-left-color",e.range.rangeColor)("height",e.math.abs(e.altitude*e.gridSize)-(e.altitude>0||!e.isFollowed?0:e.followingCharactor.chatBubbleAltitude+4),"px"),oe("ngStyle",wt(40,aM,"rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),G(1),ut("visibility",e.altitude>0?"visible":"hidden"),G(1),ut("color",e.range.rangeColor)("text-shadow",e.textShadowCss),G(2),lt(e.elevation),G(1),ut("color",e.range.rangeColor)("text-shadow",e.textShadowCss),G(2),lt(e.elevation),G(2),ut("color",e.range.rangeColor)("text-shadow",e.textShadowCss),G(1),lt(e.math.abs(e.altitude)),G(1),ut("color",e.range.rangeColor)("text-shadow",e.textShadowCss),G(1),lt(e.math.abs(e.altitude)),G(1),ut("visibility",e.altitude<0?"visible":"hidden"),oe("ngStyle",wt(42,aM,"translateY("+(e.isFollowed?e.followingCharactor.chatBubbleAltitude+4:0)+"px)")),G(1),ut("color",e.range.rangeColor)("text-shadow",e.textShadowCss),G(2),lt(e.elevation),G(1),ut("color",e.range.rangeColor)("text-shadow",e.textShadowCss),G(2),lt(e.elevation)}}const qne=function(t){return{"is-grab":t}},Wne=function(t){return{fall:t}};let Kne=(()=>{class t{constructor(e,i,r,o,s,a,h,b,ee,de){this.ngZone=e,this.tabletopActionService=i,this.contextMenuService=r,this.elementRef=o,this.panelService=s,this.changeDetector=a,this.pointerDeviceService=h,this.coordinateService=b,this.tabletopService=ee,this.modalService=de,this.range=null,this.is3D=!1,this.clipAreaCorn={clip01x:0,clip01y:0,clip02x:100,clip02y:0,clip03x:100,clip03y:100,clip04x:0,clip04y:100,clip05x:0,clip05y:0,clip06x:0,clip06y:0,clip07x:0,clip07y:0,clip08x:0,clip08y:0,clip09x:0,clip09y:0},this.gripAreaCorn={clip01x:0,clip01y:0,clip02x:100,clip02y:0,clip03x:100,clip03y:100,clip04x:0,clip04y:100,clip05x:0,clip05y:0,clip06x:0,clip06y:0,clip07x:0,clip07y:0,clip08x:0,clip08y:0,clip09x:0,clip09y:0},this.clipAreaLine={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.gripAreaLine={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.clipAreaSquare={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.gripAreaSquare={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.clipAreaDiamond={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.gripAreaDiamond={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.gridSize=50,this.movableOption={},this.rotableOption={},this.viewRotateZ=10,this.isMoving=!1,this.math=Math,this.input=null}get clipPathText(){let e="";switch(this.range.type){case"LINE":e=this.clipLine;break;case"CIRCLE":e=this.clipCircle;break;case"SQUARE":e=this.clipSquare;break;case"DIAMOND":e=this.clipDiamond;break;default:e=this.clipCorn}return e}get gripPathText(){let e="";switch(this.range.type){case"LINE":e=this.gripLine;break;case"CIRCLE":e=this.gripCircle;break;case"SQUARE":e=this.gripSquare;break;case"DIAMOND":e=this.gripDiamond;break;default:e=this.gripCorn}return e}get clipCircle(){return"circle("+(this.rangeLength+1.5)*this.gridSize+"px)"}get gripCircle(){return"circle("+(this.rangeLength>1?this.rangeLength:1)*this.gridSize+"px)"}get clipCorn(){return this.clipCornPath(this.clipAreaCorn)}get gripCorn(){return this.clipCornPath(this.gripAreaCorn)}clipCornPath(e){let i="polygon("+e.clip01x+"px "+e.clip01y+"px, ";return i+=e.clip02x+"px "+e.clip02y+"px, ",i+=e.clip03x+"px "+e.clip03y+"px, ",i+=e.clip04x+"px "+e.clip04y+"px, ",i+=e.clip05x+"px "+e.clip05y+"px, ",i+=e.clip06x+"px "+e.clip06y+"px, ",i+=e.clip07x+"px "+e.clip07y+"px, ",i+=e.clip08x+"px "+e.clip08y+"px, ",i+=e.clip09x+"px "+e.clip09y+"px)",i}get clipLine(){return this.clipLinePath(this.clipAreaLine)}get gripLine(){return this.clipLinePath(this.gripAreaLine)}clipLinePath(e){let i="polygon("+e.clip01x+"px "+e.clip01y+"px, ";return i+=e.clip02x+"px "+e.clip02y+"px, ",i+=e.clip03x+"px "+e.clip03y+"px, ",i+=e.clip04x+"px "+e.clip04y+"px)",i}get clipSquare(){return this.clipSquarePath(this.clipAreaSquare)}get gripSquare(){return this.clipSquarePath(this.gripAreaSquare)}clipSquarePath(e){let i="polygon("+e.clip01x+"px "+e.clip01y+"px, ";return i+=e.clip02x+"px "+e.clip02y+"px, ",i+=e.clip03x+"px "+e.clip03y+"px, ",i+=e.clip04x+"px "+e.clip04y+"px)",i}get clipDiamond(){return this.clipDiamondPath(this.clipAreaDiamond)}get gripDiamond(){return this.clipDiamondPath(this.gripAreaDiamond)}clipDiamondPath(e){let i="polygon("+e.clip01x+"px "+e.clip01y+"px, ";return i+=e.clip02x+"px "+e.clip02y+"px, ",i+=e.clip03x+"px "+e.clip03y+"px, ",i+=e.clip04x+"px "+e.clip04y+"px)",i}get gripLength(){return this.rangeLength>1?this.rangeLength:1}get gripWidth(){return"CIRCLE"==this.range.type||"SQUARE"==this.range.type||"DIAMOND"==this.range.type?this.gripLength:this.range.width>this.gripLength?this.range.width:this.gripLength}get tableSelecter(){return this.tabletopService.tableSelecter}get currentTable(){return this.tabletopService.currentTable}get name(){return this.range.name}get width(){return this.adjustMinBounds(this.range.width)}get length(){return this.adjustMinBounds(this.range.length)}get opacity(){return this.range.opacity}get imageFile(){return this.range.imageFile}get isLocked(){return this.range.isLocked}set isLocked(e){this.range.isLocked=e}get areaQuadrantSize(){let e=this.width<1?1:this.width,i=this.rangeLength<1?1:this.rangeLength;return Math.ceil(Math.sqrt(e*e+i*i))+1}get rotateDeg(){let e="0.0";return this.rotate&&this.rotate.nativeElement&&this.rotate.nativeElement.style&&this.rotate.nativeElement.style.transform?(e=this.rotate.nativeElement.style.transform.replace(/[^0-9\.\-]/g,""),e||(e="0.0"),parseFloat(e)):0}get altitude(){return this.range.altitude}set altitude(e){this.range.altitude=e}get elevation(){return+((this.range.posZ+this.altitude*this.gridSize)/this.gridSize).toFixed(1)}get isAltitudeIndicate(){return this.range.isAltitudeIndicate}set isAltitudeIndicate(e){this.range.isAltitudeIndicate=e}get textShadowCss(){return`${pt.textShadowColor(this.range.rangeColor,"#f5f5f5")} 0px 0px 3px`}get followingCharactor(){return this.range.followingCharactor}set followingCharactor(e){this.range.followingCharactor=e}get isFollowed(){return this.followingCharactor&&this.followingCharactor.location.x<=this.range.location.x&&this.range.location.x<=this.followingCharactor.location.x+this.followingCharactor.size*this.gridSize&&this.followingCharactor.location.y<=this.range.location.y&&this.range.location.y<=this.followingCharactor.location.y+this.followingCharactor.size*this.gridSize&&this.followingCharactor.altitude+this.followingCharactor.posZ-.5<=this.range.altitude+this.range.posZ&&this.range.altitude+this.range.posZ<=this.followingCharactor.altitude+this.followingCharactor.posZ+.5}get dockableCharacters(){let e=this.tabletopService.characters.filter(i=>"table"===i.location.name&&!i.isHideIn&&[{x:0,y:0},{x:i.size*this.gridSize,y:0},{x:0,y:i.size*this.gridSize},{x:i.size*this.gridSize,y:i.size*this.gridSize}].some(r=>this.range.location.x-this.rangeLength*this.gridSize<=i.location.x+r.x&&i.location.x+r.x<=this.range.location.x+this.rangeLength*this.gridSize&&this.range.location.y-this.rangeLength*this.gridSize<=i.location.y+r.y&&i.location.y+r.y<=this.range.location.y+this.rangeLength*this.gridSize));return this.followingCharactor&&!e.some(i=>i===this.followingCharactor)&&e.push(this.followingCharactor),e.sort((i,r)=>i.name.localeCompare(r.name,"ja"))}get rangeLength(){let e=this.length<1?1:this.length;return this.followingCharactor&&this.range.isExpandByFollowing&&(e+=this.followingCharactor.size/2),e}get rotateHandlesLeftPos(){let e=[];for(let i=1;i<Math.ceil(this.rangeLength/6);i++)e.push(this.rangeLength*i/Math.ceil(this.rangeLength/6));return e.push(this.rangeLength),e}ngOnInit(){Ue.register(this).on("UPDATE_GAME_OBJECT",-1e3,e=>{let i=Ct.instance.get(e.data.identifier);if(!this.range||!i)return;let r=!1;(this.range===i||i instanceof ni&&this.range.contains(i))&&(this.ngZone.run(()=>{this.setRange()}),r=!0),this.followingCharactor&&(i.identifier===this.followingCharactor.identifier||i instanceof ni&&this.followingCharactor.contains(i))&&(this.ngZone.run(()=>{this.range.following(),this.setRange()}),r=!0),r&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",-1e3,e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.range,transformCssOffset:"translateZ(0.25px)",colideLayers:["terrain","text-note"]},this.rotableOption={tabletopObject:this.range},this.setRange()}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new ls(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this),this.setRange(),queueMicrotask(()=>{this.changeDetector.markForCheck()})}ngOnDestroy(){this.input.destroy(),Ue.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLocked&&Ue.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate(),o=[];if(o.push(this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,Et.play(st.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,Et.play(st.lock)}}),o.push({name:"\u5f71\u97ff\u30b0\u30ea\u30c3\u30c9\u306e\u5224\u5b9a\u65b9\u6cd5",action:null,subActions:[{name:(0==this.range.fillType?"\u25c9":"\u25cb")+" \u5224\u5b9a\u306a\u3057 (\u8f2a\u90ed\u5185\u3092\u5857\u308a\u3064\u3076\u3059)",action:()=>{this.range.fillType=0}},Ht,{name:(1==this.range.fillType?"\u25c9":"\u25cb")+" \u30b0\u30ea\u30c3\u30c9\u306e\u4e2d\u5fc3\u3092\u8986\u3046",action:()=>{this.range.fillType=1}},{name:(2==this.range.fillType?"\u25c9":"\u25cb")+" \u30b0\u30ea\u30c3\u30c9\u306e\u4e00\u90e8\u3067\u3082\u8986\u3046",action:()=>{this.range.fillType=2}},{name:(3==this.range.fillType?"\u25c9":"\u25cb")+" \u30b0\u30ea\u30c3\u30c9\u306e\u534a\u5206\u4ee5\u4e0a\u3092\u8986\u3046",action:()=>{this.range.fillType=3}},{name:(4==this.range.fillType?"\u25c9":"\u25cb")+" \u30b0\u30ea\u30c3\u30c9\u5168\u4f53\u3092\u8986\u3046",action:()=>{this.range.fillType=4}}]}),o.push(Ht),"CIRCLE"==this.range.type||"SQUARE"==this.range.type||"DIAMOND"==this.range.type){let s=this.dockableCharacters.length<=0?this.followingCharactor?[]:[{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c\u3044\u307e\u305b\u3093",action:null,disabled:!0,center:!0}]:this.dockableCharacters.map(a=>({name:`${this.followingCharactor&&this.followingCharactor.identifier===a.identifier?"\u25c9":"\u25cb"} ${a.name}`,action:()=>{this.followingCharactor=a,this.ngZone.run(()=>{this.range.following()}),Et.play(st.lock)}}));0!=s.length&&s.push(Ht),s.push({name:"\u8ffd\u5f93\u3092\u89e3\u9664\u3059\u308b",action:()=>{Et.play(st.unlock),this.followingCharactor=null},disabled:!this.followingCharactor}),o.push({name:"\u4ed8\u8fd1\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u8ffd\u5f93",action:null,subActions:s}),o.push(this.range.isExpandByFollowing?{name:"\u2611 \u8ffd\u5f93\u6642\u30b5\u30a4\u30ba\u306b\u5408\u308f\u305b\u3066\u62e1\u5927",action:()=>{this.range.isExpandByFollowing=!1}}:{name:"\u2610 \u8ffd\u5f93\u6642\u30b5\u30a4\u30ba\u306b\u5408\u308f\u305b\u3066\u62e1\u5927",action:()=>{this.range.isExpandByFollowing=!0}}),o.push(this.range.isFollowAltitude?{name:"\u2611 \u9ad8\u3055\u30fb\u9ad8\u5ea6\u306b\u3082\u8ffd\u5f93",action:()=>{this.range.isFollowAltitude=!1}}:{name:"\u2610 \u9ad8\u3055\u30fb\u9ad8\u5ea6\u306b\u3082\u8ffd\u5f93",action:()=>{this.range.isFollowAltitude=!0,this.followingCharactor&&this.range.following()}})}else o.push(this.range.subDivisionSnapPolygonal?{name:"\u2611 \u7d30\u304b\u3044\u89d2\u5ea6\u3067\u56de\u8ee2",action:()=>{this.range.subDivisionSnapPolygonal=!1}}:{name:"\u2610 \u7d30\u304b\u3044\u89d2\u5ea6\u3067\u56de\u8ee2",action:()=>{this.range.subDivisionSnapPolygonal=!0}});o.push(Ht),o.push(this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0}}),o.push({name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,Et.play(st.sweep))},altitudeHande:this.range}),o.push(Ht),o.push({name:"\u5c04\u7a0b\u30fb\u7bc4\u56f2\u3092\u7de8\u96c6...",action:()=>{this.showDetail(this.range)}}),this.range.getUrls().length>0&&(o.push({name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.range.getUrls().map(s=>{const a=s.value.toString();return{name:s.name?s.name:a,action:()=>{pt.sameOrigin(a)?window.open(a.trim(),"_blank","noopener"):this.modalService.open(lo,{url:a,title:this.range.name,subTitle:s.name})},disabled:!pt.validUrl(a),error:pt.validUrl(a)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:pt.validUrl(a)&&!pt.sameOrigin(a)}})}),o.push(Ht)),o.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let s=this.range.clone();console.log("\u30b3\u30d4\u30fc",s),s.location.x+=this.gridSize,s.location.y+=this.gridSize,s.isLocked=!1,s.followingCharctorIdentifier=null,this.range.parent&&this.range.parent.appendChild(s),Et.play(st.cardPut)}}),o.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.range.destroy(),Et.play(st.sweep)}}),o.push(Ht),o.push({name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(r)}),this.contextMenuService.open(i,o,this.name)}onMove(){this.isMoving=!0,Et.play(st.cardPick)}onMoved(){this.isMoving=!1,Et.play(st.cardPut)}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u5c04\u7a0b\u30fb\u7bc4\u56f2\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(ps,{title:r,left:i.x-200,top:i.y-150,width:400,height:390}).tabletopObject=e}setRange(){let e=new Wf(this.gridCanvas.nativeElement,this.rangeCanvas.nativeElement,this.centerPunch.nativeElement),i={areaWidth:2*this.areaQuadrantSize,areaHeight:2*this.areaQuadrantSize,range:this.rangeLength,width:this.width<.1?.1:this.width,centerX:this.range.location.x,centerY:this.range.location.y,gridSize:this.gridSize,type:this.range.type,gridColor:this.range.gridColor,rangeColor:this.range.rangeColor,fanDegree:0,degree:this.rotateDeg,offSetX:this.range.offSetX,offSetY:this.range.offSetY,gridType:this.currentTable.gridType,isDocking:!!this.followingCharactor,fillType:this.range.fillType};switch(this.range.type){case"LINE":this.clipAreaLine=e.renderLine(i),this.gripAreaLine=Wf.gripAreaPathLine(i);break;case"CIRCLE":e.renderCircle(i);break;case"SQUARE":this.clipAreaSquare=e.renderSquare(i),this.gripAreaSquare=Wf.gripAreaPathSquare(i);break;case"DIAMOND":this.clipAreaDiamond=e.renderDiamond(i),this.gripAreaDiamond=Wf.gripAreaPathDiamond(i);break;default:this.clipAreaCorn=e.renderCorn(i),this.gripAreaCorn=Wf.gripAreaPathCorn(i)}this.gridCanvas.nativeElement.style.opacity=this.range.opacity+""}}return t.\u0275fac=function(e){return new(e||t)(He(Nn),He(Bg),He(hr),He(Ai),He(qn),He(Ki),He(Ci),He(wl),He(Vu),He(Yn))},t.\u0275cmp=fn({type:t,selectors:[["range"]],viewQuery:function(e,i){if(1&e&&(wn(Lne,7),wn(Bne,7),wn(zne,7),wn(jne,5)),2&e){let r;Cn(r=xn())&&(i.gridCanvas=r.first),Cn(r=xn())&&(i.rangeCanvas=r.first),Cn(r=xn())&&(i.centerPunch=r.first),Cn(r=xn())&&(i.rotate=r.first)}},hostBindings:function(e,i){1&e&&Ae("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{range:"range",is3D:"is3D"},decls:19,vars:48,consts:[["appMovable","",1,"component","is-3d",2,"pointer-events","none",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],[1,"is-3d",3,"ngClass"],[1,"is-3d",2,"position","absolute"],[1,"is-fill",2,"position","absolute","pointer-events","auto","top","-100%"],[1,"is-3d",2,"position","absolute","pointer-events","none"],[1,"is-3d",2,"position","absolute","z-index","0"],[1,"is-fill","is-3d"],["gridCanvas",""],["rangeCanvas",""],["appRotable","",1,"component-content","is-3d",2,"transform","rotateZ(0deg)",3,"rotable.option","rotable.polygonal","rotable.disable","rotable.ondragstart","rotable.ondragend"],["rotate",""],["class","is-3d","class","lock-icon is-center",4,"ngIf"],[4,"ngIf"],["class","is-3d","style","display: flex; flex-flow: column nowrap; justify-content: space-between; border-left: 2px dashed black; transform-origin: top left",3,"border-left-color","height","ngStyle",4,"ngIf"],["centerPunch",""],[1,"lock-icon","is-center"],[1,"material-icons"],[1,"is-3d",2,"position","absolute","width","28px","pointer-events","auto"],[4,"ngFor","ngForOf"],[1,"rotate-grab","of-corn-bottom","rotate-grab-icon","is-3d","will-change"],[1,"rotate-grab","of-corn-top","rotate-grab-icon","is-3d","will-change"],[1,"rotate-grab","of-corn-tip","rotate-grab-icon","is-3d","will-change",2,"position","absolute"],[1,"is-3d",2,"display","flex","flex-flow","column nowrap","justify-content","space-between","border-left","2px dashed black","transform-origin","top left",3,"ngStyle"],[1,"is-3d"],[1,"elevation-indicator","is-3d",2,"position","absolute"],[1,"elevation-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"is-3d",3,"ngStyle"]],template:function(e,i){1&e&&(Q(0,"div",0),Ae("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),Q(1,"div",1)(2,"div",2),mt(3,"div",3),ne(),Q(4,"div",4)(5,"div",5),mt(6,"canvas",6,7),ne(),Q(8,"div",2),mt(9,"canvas",6,8),ne(),Q(11,"div",9,10),Ae("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Te(13,Une,3,1,"div",11),Te(14,Vne,9,3,"ng-container",12),ne()()(),Te(15,Gne,20,44,"div",13),Q(16,"div",5),mt(17,"canvas",6,14),ne()()),2&e&&(oe("ngClass",wt(44,qne,!i.isLocked))("movable.option",i.movableOption)("movable.disable",i.isLocked),G(1),ut("transform","translateZ("+i.altitude*i.gridSize+"px)"),oe("ngClass",wt(46,Wne,0==i.altitude)),G(1),ut("clip-path",i.gripPathText),G(1),ut("left",1.5*-i.gripLength*i.gridSize,"px")("width",3*i.gripLength*i.gridSize,"px")("height",3*i.gripWidth*i.gridSize,"px"),G(1),ut("width",0,"px")("height",0,"px")("clip-path",i.clipPathText),G(1),ut("top",0,"px")("left",-1*i.areaQuadrantSize*i.gridSize,"px"),G(3),ut("z-index",i.isMoving?5:0)("top",0,"px")("left",-1*i.areaQuadrantSize*i.gridSize,"px"),G(3),ut("opacity",i.isMoving?.7:1),oe("rotable.option",i.rotableOption)("rotable.polygonal",i.range.subDivisionSnapPolygonal?360:24)("rotable.disable",i.isLocked),G(2),oe("ngIf","CIRCLE"==i.range.type||"SQUARE"==i.range.type||"DIAMOND"==i.range.type),G(1),oe("ngIf","CIRCLE"!=i.range.type&&"SQUARE"!=i.range.type&&"DIAMOND"!=i.range.type),G(1),oe("ngIf",i.isAltitudeIndicate&&(i.altitude<=-.5||.5<=i.altitude)),G(1),ut("visibility",0!=i.altitude?"visible":"hidden")("top",0,"px")("left",-1*i.areaQuadrantSize*i.gridSize,"px"))},dependencies:[si,_i,Bn,fr,Sl,Tc],styles:[".is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.image[_ngcontent-%COMP%]{display:block}.lock-icon[_ngcontent-%COMP%]{background-color:#ccc;border-radius:100%;color:#444;width:25px;height:25px;visibility:hidden}.component[_ngcontent-%COMP%]:hover   .lock-icon[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .lock-icon[_ngcontent-%COMP%]{visibility:visible}.is-center[_ngcontent-%COMP%]{position:absolute;top:-12.5px;left:-12.5px;margin:auto}.border[_ngcontent-%COMP%]{box-sizing:border-box;border:solid 2px #CCCCCC}.is-fit-full[_ngcontent-%COMP%]{height:100%;width:100%}.pedestal-grab-corn[_ngcontent-%COMP%]{z-index:-1;position:absolute;inset:-14px 14px -14px -14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;position:absolute;inset:-14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:1}.rotate-grab[_ngcontent-%COMP%]{opacity:0;z-index:-1}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:30px;height:30px;box-sizing:border-box;border:solid 2px #CCCCCC;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:0;background-color:#ccc;border-radius:100%;color:#444;font-size:24px;transform-style:preserve-3d;transform:translateZ(.1px)}.will-change[_ngcontent-%COMP%]{will-change:opacity}.of-corn-top[_ngcontent-%COMP%]{top:-30px;left:-15px;border-radius:15px 15px 0 0}.of-corn-bottom[_ngcontent-%COMP%]{bottom:-30px;left:-15px;border-radius:0 0 15px 15px}.of-corn-tip[_ngcontent-%COMP%]{top:-15px;left:-15px;border-radius:15px}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px;border-radius:14px 7px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px;border-radius:7px 14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px;border-radius:14px 7px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px;border-radius:7px 14px}.is-fill[_ngcontent-%COMP%]{display:block;position:absolute;inset:0;margin:auto}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.fall[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.altitude-indicator[_ngcontent-%COMP%]{font-size:10px}.elevation-indicator[_ngcontent-%COMP%], .altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;color:#000;text-shadow:whitesmoke 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.elevation-indicator[_ngcontent-%COMP%]{font-weight:bolder;font-size:12px}"],changeDetection:0}),t})();const Yne=["root"],Zne=["gameTable"],Xne=["gameObjects"],Qne=["gridCanvas"];function Jne(t,n){if(1&t&&(it(0),mt(1,"terrain",18),rt()),2&t){const e=me().$implicit;G(1),ut("z-index",e.height>0?0:1),oe("terrain",e)("appTooltip",e)}}function eie(t,n){if(1&t&&(it(0),mt(1,"terrain",19),rt()),2&t){const e=me().$implicit;G(1),ut("z-index",e.height>0?0:1),oe("terrain",e)}}function tie(t,n){if(1&t&&(it(0),Te(1,Jne,2,4,"ng-container",17),Te(2,eie,2,3,"ng-container",17),rt()),2&t){const e=n.$implicit;G(1),oe("ngIf",e.detailDataElement&&0<e.detailDataElement.children.length),G(1),oe("ngIf",!e.detailDataElement||e.detailDataElement.children.length<=0)}}function nie(t,n){if(1&t&&(it(0),mt(1,"game-table-mask",20),rt()),2&t){const e=me().$implicit;G(1),oe("gameTableMask",e)("appTooltip",e)}}function iie(t,n){if(1&t&&(it(0),mt(1,"game-table-mask",21),rt()),2&t){const e=me().$implicit;G(1),oe("gameTableMask",e)}}function rie(t,n){if(1&t&&(it(0),Te(1,nie,2,2,"ng-container",17),Te(2,iie,2,1,"ng-container",17),rt()),2&t){const e=n.$implicit;G(1),oe("ngIf",e.detailDataElement&&0<e.detailDataElement.children.length),G(1),oe("ngIf",!e.detailDataElement||e.detailDataElement.children.length<=0)}}const oie=function(t){return{"z-index":t}};function sie(t,n){if(1&t&&mt(0,"text-note",22),2&t){const e=n.$implicit;oe("textNote",e)("appTooltip",e)("ngStyle",wt(3,oie,e.zindex))}}const lM=function(t,n){return{"z-index":t,transform:n}};function aie(t,n){if(1&t&&mt(0,"card-stack",23),2&t){const e=n.$implicit;oe("cardStack",e)("appTooltip",e)("ngStyle",un(3,lM,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function lie(t,n){if(1&t&&mt(0,"card",24),2&t){const e=n.$implicit;oe("card",e)("appTooltip",e)("ngStyle",un(3,lM,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function cie(t,n){if(1&t&&mt(0,"range",25),2&t){const e=n.$implicit;oe("range",e)("appTooltip",e)}}function uie(t,n){if(1&t&&mt(0,"dice-symbol",26),2&t){const e=n.$implicit;oe("diceSymbol",e)("appTooltip",e)}}function die(t,n){if(1&t&&(it(0),mt(1,"game-character",27),rt()),2&t){const e=me().$implicit;G(1),ut("display",e.isLoaded?"":"none"),oe("gameCharacter",e)("appTooltip",e)}}function fie(t,n){if(1&t&&(it(0),Te(1,die,2,4,"ng-container",17),rt()),2&t){const e=n.$implicit,i=me();G(1),oe("ngIf",e&&(e.isVisible||i.isGMMode))}}function hie(t,n){if(1&t&&mt(0,"peer-cursor",28),2&t){const e=n.$implicit,i=me();ut("display",i.isCursorHidIn(e)&&!i.isGMMode?"none":""),oe("cursor",e)}}const pie=function(t,n,e){return[t,n,e]},gie=function(t){return{"is-grabbing":t}},mie=function(t){return{transform:t}};let _ie=(()=>{class t{constructor(e,i,r,o,s,a,h,b){this.ngZone=e,this.contextMenuService=i,this.pointerDeviceService=r,this.coordinateService=o,this.imageService=s,this.tabletopService=a,this.tabletopActionService=h,this.modalService=b,this.isTableTransformMode=!1,this.isTableTransformed=!1,this.viewPotisonX=100,this.viewPotisonY=0,this.viewPotisonZ=0,this.viewRotateX=50,this.viewRotateY=0,this.viewRotateZ=10,this.mouseGesture=null,this.touchGesture=null}get tableSelecter(){return this.tabletopService.tableSelecter}get currentTable(){return this.tabletopService.currentTable}get gridHeight(){return this.tabletopService.currentTable.gridHeight}get tableImage(){return this.imageService.getSkeletonOr(this.currentTable.imageIdentifier)}get backgroundImage(){return this.imageService.getEmptyOr(this.currentTable.backgroundImageIdentifier)}get backgroundFilterType(){return this.currentTable.backgroundFilterType}get isPointerDragging(){return this.pointerDeviceService.isDragging}get characters(){return this.tabletopService.characters}get tableMasks(){return this.tabletopService.tableMasks}get cards(){return this.tabletopService.cards}get cardStacks(){return this.tabletopService.cardStacks}get ranges(){return this.tabletopService.ranges}get terrains(){return this.tabletopService.terrains}get textNotes(){return this.tabletopService.textNotes}get diceSymbols(){return this.tabletopService.diceSymbols}get peerCursors(){return this.tabletopService.peerCursors}get isStealthMode(){return sn.isStealthMode}get isGMMode(){return Qe.myCursor&&Qe.myCursor.isGMMode}ngOnInit(){Ue.register(this).on("UPDATE_GAME_OBJECT",e=>{e.data.identifier!==this.currentTable.identifier&&e.data.identifier!==this.tableSelecter.identifier||(console.log("UPDATE_GAME_OBJECT GameTableComponent "+this.currentTable.identifier),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor,this.currentTable.isShowNumber))}).on("DRAG_LOCKED_OBJECT",e=>{this.isTableTransformMode=!0,this.pointerDeviceService.isDragging=!1,this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}).on("RESET_POINT_OF_VIEW",e=>{this.isTableTransformMode=!1,this.pointerDeviceService.isDragging=!1,this.setTransform(this.viewPotisonX,this.viewPotisonY,this.viewPotisonZ,this._rightRotate(this.viewRotateX),this._rightRotate(this.viewRotateY,!0),this._rightRotate(this.viewRotateZ),!0),setTimeout(()=>{this.gridCanvas.nativeElement.style.opacity="0.0",this.gameTable.nativeElement.style.transition="0.1s ease-out",setTimeout(()=>{this.gameTable.nativeElement.style.transition=null},100),e&&"top"==e.data?this.setTransform(0,0,0,0,0,0,!0):this.setTransform(100,0,0,50,0,10,!0)},50),this.removeFocus()}).on("FOCUS_TABLETOP_OBJECT",e=>{setTimeout(()=>{console.log(`move table to focus (${e.data.x}, ${e.data.y})`),this.gameTable.nativeElement.style.transition="0.1s ease-out",setTimeout(()=>{this.gameTable.nativeElement.style.transition=null},100);let o=e.data.x-this.gridCanvas.nativeElement.clientWidth/2,s=e.data.y-this.gridCanvas.nativeElement.clientHeight/2,a=e.data.z,h=this.viewRotateZ/180*Math.PI,b=o*Math.cos(h)-s*Math.sin(h),ee=o*Math.sin(h)+s*Math.cos(h),de=this.viewRotateX/180*Math.PI,ge=ee*Math.cos(de),xe=ee*Math.sin(de)+a;this.setTransform(100-b-this.viewPotisonX,-ge-this.viewPotisonY,-xe-this.viewPotisonZ,0,0,0)},50)}),this.tabletopActionService.makeDefaultTable(),this.tabletopActionService.makeDefaultTabletopObjects()}_rightRotate(e,i=!1){let r=e%360;return i||(r>180?r-=360:r<-180&&(r+=360)),r}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.initializeTableTouchGesture(),this.initializeTableMouseGesture()}),this.cancelInput(),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor),this.setTransform(0,0,0,0,0,0),this.coordinateService.tabletopOriginElement=this.gameObjects.nativeElement}ngOnDestroy(){Ue.unregister(this),this.mouseGesture.destroy(),this.touchGesture.destroy()}initializeTableTouchGesture(){this.touchGesture=new tJ(this.rootElementRef.nativeElement,this.ngZone),this.touchGesture.onstart=this.onTableTouchStart.bind(this),this.touchGesture.onend=this.onTableTouchEnd.bind(this),this.touchGesture.ongesture=this.onTableTouchGesture.bind(this),this.touchGesture.ontransform=this.onTableTouchTransform.bind(this)}initializeTableMouseGesture(){this.mouseGesture=new eJ(this.rootElementRef.nativeElement),this.mouseGesture.onstart=this.onTableMouseStart.bind(this),this.mouseGesture.onend=this.onTableMouseEnd.bind(this),this.mouseGesture.ontransform=this.onTableMouseTransform.bind(this)}onTableTouchStart(){this.mouseGesture.cancel()}onTableTouchEnd(){this.cancelInput()}onTableTouchGesture(){this.cancelInput()}onTableTouchTransform(e,i,r,o,s,a,h,b){if(!this.isTableTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),b.cancelable&&b.preventDefault();let ee=(1e3+Math.abs(this.viewPotisonZ))/1e3;80<o+this.viewRotateX&&(o+=80-(o+this.viewRotateX)),o+this.viewRotateX<0&&(o+=0-(o+this.viewRotateX)),750<r+this.viewPotisonZ&&(r+=750-(r+this.viewPotisonZ)),this.setTransform(e*=ee,i*=ee,r,o,s,a),this.isTableTransformed=!0}onTableMouseStart(e){e.target.contains(this.gameObjects.nativeElement)||1===e.button||2===e.button?this.isTableTransformMode=!0:(this.isTableTransformMode=!1,this.pointerDeviceService.isDragging=!0,this.gridCanvas.nativeElement.style.opacity="1"),document.activeElement.contains(e.target)||(this.removeSelectionRanges(),this.removeFocus())}onTableMouseEnd(e){this.cancelInput()}onTableMouseTransform(e,i,r,o,s,a,h,b){if(!this.isTableTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),b.cancelable&&b.preventDefault();let ee=(1e3+Math.abs(this.viewPotisonZ))/1e3;this.setTransform(e*=ee,i*=ee,r,o,s,a),this.isTableTransformed=!0}cancelInput(){this.mouseGesture.cancel(),this.isTableTransformMode=!0,this.pointerDeviceService.isDragging=!1,this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}onContextMenu(e){if(!document.activeElement.contains(this.gameObjects.nativeElement)||(e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate(),o=[];Array.prototype.push.apply(o,this.tabletopActionService.makeDefaultContextMenuActions(r)),o.push(Ht),o.push({name:"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a...",action:()=>{this.modalService.open(PI)}}),this.contextMenuService.open(i,o,this.currentTable.name)}onDocumentMouseDown(e){this.isTableTransformed=!1}onDocumentTouchStart(e){this.isTableTransformed=!1}onDocumentContextMenu(e){this.isTableTransformed&&!this.pointerDeviceService.isAllowedToOpenContextMenu&&e.preventDefault()}setTransform(e,i,r,o,s,a,h=!1){h?(this.viewRotateX=o,this.viewRotateY=s,this.viewRotateZ=a,this.viewPotisonX=e,this.viewPotisonY=i,this.viewPotisonZ=r):(this.viewRotateX+=o,this.viewRotateY+=s,this.viewRotateZ+=a,this.viewPotisonX+=e,this.viewPotisonY+=i,this.viewPotisonZ+=r),(h||0!=o||0!=s||0!=o)&&this.ngZone.run(()=>{Ue.trigger("TABLE_VIEW_ROTATE",{x:this.viewRotateX,y:this.viewRotateY,z:this.viewRotateZ})}),this.gameTable.nativeElement.style.transform=`translateZ(${this.viewPotisonZ.toFixed(4)}px) translateY(${this.viewPotisonY.toFixed(4)}px) translateX(${this.viewPotisonX.toFixed(4)}px) rotateY(${this.viewRotateY.toFixed(4)}deg) rotateX(${this.viewRotateX.toFixed(4)+"deg) rotateZ("+this.viewRotateZ.toFixed(4)}deg)`}setGameTableGrid(e,i,r=50,o=fs.SQUARE,s="#000000e6",a=!0){this.gameTable.nativeElement.style.width=e*r+"px",this.gameTable.nativeElement.style.height=i*r+"px",new JQ(this.gridCanvas.nativeElement).render(e,i,r,o,s,a),this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}removeSelectionRanges(){let e=window.getSelection();e.isCollapsed||e.removeAllRanges()}removeFocus(){document.activeElement instanceof HTMLElement&&document.activeElement.blur()}trackByGameObject(e,i){return i.identifier}isCursorHidIn(e){if(e.isGMMode)return!0;for(let i of this.characters)if(i.isHideIn&&"table"===i.location.name&&i.owner===e.userId)return!0;return!1}}return t.\u0275fac=function(e){return new(e||t)(He(Nn),He(hr),He(Ci),He(wl),He(Zu),He(Vu),He(Bg),He(Yn))},t.\u0275cmp=fn({type:t,selectors:[["game-table"]],viewQuery:function(e,i){if(1&e&&(wn(Yne,7),wn(Zne,7),wn(Xne,7),wn(Qne,7)),2&e){let r;Cn(r=xn())&&(i.rootElementRef=r.first),Cn(r=xn())&&(i.gameTable=r.first),Cn(r=xn())&&(i.gameObjects=r.first),Cn(r=xn())&&(i.gridCanvas=r.first)}},hostBindings:function(e,i){1&e&&Ae("contextmenu",function(o){return i.onContextMenu(o)})("mousedown",function(o){return i.onDocumentMouseDown(o)},!1,Dh)("touchstart",function(o){return i.onDocumentTouchStart(o)},!1,Dh)("contextmenu",function(o){return i.onDocumentContextMenu(o)},!1,Dh)},decls:21,vars:39,consts:[[1,"background-image","is-pointer-events-none",3,"ngClass"],[1,"component","is-fill","is-perspective",3,"ngClass"],["root",""],[1,"component-content","is-fill","is-3d"],["gameTable",""],["id","app-game-table",1,"game-table","table-image","is-3d"],["gameObjects",""],[1,"grid-canvas","is-fill","is-pointer-events-none",3,"ngStyle"],["gridCanvas",""],[1,"is-fill","is-3d","is-pointer-events-none"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"textNote","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"cardStack","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"card","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"range","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"diceSymbol","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"cursor","display",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],[1,"is-3d",3,"terrain","appTooltip"],[1,"is-3d",3,"terrain"],[1,"is-3d",3,"gameTableMask","appTooltip"],[1,"is-3d",3,"gameTableMask"],[1,"is-3d",3,"textNote","appTooltip","ngStyle"],[1,"is-3d",3,"cardStack","appTooltip","ngStyle"],[1,"is-3d",3,"card","appTooltip","ngStyle"],[1,"is-3d",3,"range","appTooltip"],[1,"is-3d",3,"diceSymbol","appTooltip"],[1,"is-3d",3,"gameCharacter","appTooltip"],[1,"is-3d",3,"cursor"]],template:function(e,i){1&e&&(Q(0,"div",0),Lt(1,"safe"),ne(),Q(2,"div",1,2)(4,"div",3,4)(6,"div",5,6),Lt(8,"safe"),mt(9,"canvas",7,8),Q(11,"div",9),Te(12,tie,3,2,"ng-container",10),ne(),Te(13,rie,3,2,"ng-container",10),Te(14,sie,1,5,"text-note",11),Te(15,aie,1,6,"card-stack",12),Te(16,lie,1,6,"card",13),Te(17,cie,1,2,"range",14),Te(18,uie,1,2,"dice-symbol",15),Te(19,fie,2,1,"ng-container",10),Te(20,hie,1,3,"peer-cursor",16),ne()()()),2&e&&(ut("background-image",Bt(1,25,"url("+i.backgroundImage.url+")","style")),oe("ngClass",mo(31,pie,i.backgroundFilterType?"is-filter":"",i.isStealthMode&&!i.isGMMode?"is-hide-in":"",i.backgroundFilterType)),G(2),oe("ngClass",wt(35,gie,i.isPointerDragging)),G(4),ut("background-image",Bt(8,28,"url("+i.tableImage.url+")","style")),G(3),oe("ngStyle",wt(37,mie,"translateZ("+(i.gridHeight+.1)+"px)")),G(3),oe("ngForOf",i.terrains)("ngForTrackBy",i.trackByGameObject),G(1),oe("ngForOf",i.tableMasks)("ngForTrackBy",i.trackByGameObject),G(1),oe("ngForOf",i.textNotes)("ngForTrackBy",i.trackByGameObject),G(1),oe("ngForOf",i.cardStacks)("ngForTrackBy",i.trackByGameObject),G(1),oe("ngForOf",i.cards)("ngForTrackBy",i.trackByGameObject),G(1),oe("ngForOf",i.ranges)("ngForTrackBy",i.trackByGameObject),G(1),oe("ngForOf",i.diceSymbols)("ngForTrackBy",i.trackByGameObject),G(1),oe("ngForOf",i.characters)("ngForTrackBy",i.trackByGameObject),G(1),oe("ngForOf",i.peerCursors)("ngForTrackBy",i.trackByGameObject))},dependencies:[si,_i,Bn,fr,cJ,ute,Mte,Rte,tne,Kr,vne,Rne,XI,Kne,$i],styles:['[_nghost-%COMP%]{display:block}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-perspective[_ngcontent-%COMP%]{perspective:1000px}.is-fill[_ngcontent-%COMP%]{display:block;position:absolute;inset:0;margin:auto}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.component[_ngcontent-%COMP%]{-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;touch-action:manipulation;height:100%;width:100%;overflow:hidden}.component-content[_ngcontent-%COMP%]{height:2000px;width:2000px}.grid-canvas[_ngcontent-%COMP%]{opacity:0;transform:translateZ(.15px);transition:.1s ease-out;-webkit-backface-visibility:hidden;backface-visibility:hidden}.game-table[_ngcontent-%COMP%]{height:100%;width:100%}.table-image[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;background-repeat:no-repeat;background-size:100% 100%}.background-image[_ngcontent-%COMP%]{position:absolute;inset:0;margin:-5px;background-repeat:no-repeat;background-position:center;background-size:cover;transition:filter .2s ease-in-out}.background-image.is-filter[_ngcontent-%COMP%]{will-change:filter}.background-image.is-filter.white[_ngcontent-%COMP%], .background-image.is-filter.black[_ngcontent-%COMP%]{filter:blur(5px)}.background-image.is-filter[_ngcontent-%COMP%]:after{display:block;content:"";width:100%;height:100%}.background-image.is-filter.white[_ngcontent-%COMP%]:after{background-color:#f7f7f7;filter:opacity(.2)}.background-image.is-filter.black[_ngcontent-%COMP%]:after{background-color:#1a1a1a;filter:opacity(.3)}.background-image.is-filter.is-hide-in.white[_ngcontent-%COMP%]:after{background-color:#1a1a1a;filter:opacity(.3)}.background-image.is-filter.is-hide-in.black[_ngcontent-%COMP%]:after{background-color:#f7f7f7;filter:opacity(.2)}.background-image.is-filter.is-hide-in[_ngcontent-%COMP%]{filter:invert(85%) blur(5px);-webkit-backdrop-filter:invert(85%);backdrop-filter:invert(85%)}.background-image.is-hide-in[_ngcontent-%COMP%]{filter:invert(85%);-webkit-backdrop-filter:invert(85%);backdrop-filter:invert(85%);background-color:#ffcc80}']}),t})(),$ie=(()=>{class t{constructor(e){this.elementRef=e,this.timer=null,this.needRepeat=!1}ngAfterViewInit(){let e=()=>{this.needRepeat?(this.timer=setTimeout(e,650),this.needRepeat=!1):(this.timer=null,this.elementRef.nativeElement.style.display="none")};Ue.register(this).on("*",i=>{this.needRepeat||Ot.bandwidthUsage<3072||(null===this.timer?(this.elementRef.nativeElement.style.display="block",this.timer=setTimeout(e,650)):this.needRepeat=!0)})}ngOnDestroy(){Ue.unregister(this)}}return t.\u0275fac=function(e){return new(e||t)(He(Ai))},t.\u0275cmp=fn({type:t,selectors:[["network-indicator"]],decls:12,vars:0,consts:[[1,"sk-cube-grid"],[1,"sk-cube","sk-cube1"],[1,"sk-cube","sk-cube2"],[1,"sk-cube","sk-cube3"],[1,"sk-cube","sk-cube4"],[1,"sk-cube","sk-cube5"],[1,"sk-cube","sk-cube6"],[1,"sk-cube","sk-cube7"],[1,"sk-cube","sk-cube8"],[1,"sk-cube","sk-cube9"],[1,"sk-title"]],template:function(e,i){1&e&&(Q(0,"div",0),mt(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9),Q(10,"div",10),ve(11,"sync"),ne()())},styles:["[_nghost-%COMP%]{display:block}.sk-cube-grid[_ngcontent-%COMP%]{font-size:8px;color:#444;height:100%;width:100%;background-color:#f7f7f799}.sk-cube[_ngcontent-%COMP%]{background-color:#555}.sk-title[_ngcontent-%COMP%]{padding:2px 0;background-color:#f7f7f799}"]}),t})();const vie=["modalLayer"];function bie(t,n){if(1&t){const e=ft();Q(0,"li",3),Ae("click",function(){return Re(e),Le(me().save())}),Q(1,"a",4)(2,"div")(3,"i",6),ve(4,"sd_storage"),ne()(),Q(5,"div"),ve(6,"\u4fdd\u5b58"),ne()()()}}function yie(t,n){if(1&t&&(Q(0,"li",15)(1,"a")(2,"div")(3,"i",16),ve(4,"sd_storage"),ne()(),Q(5,"div"),ve(6),ne()()()),2&t){const e=me();G(6),Zn("",e.progresPercent,"%")}}const Cie=function(t){return{horizontal:t}};let wie=(()=>{class t{constructor(e,i,r,o,s,a,h,b,ee,de,ge){var xe=this;this.swUpdate=e,this.modalService=i,this.panelService=r,this.pointerDeviceService=o,this.chatMessageService=s,this.appConfigService=a,this.saveDataService=h,this.ngZone=b,this.contextMenuService=ee,this.standImageService=de,this.cutInService=ge,this.immediateUpdateTimer=null,this.lazyUpdateTimer=null,this.openPanelCount=0,this.isSaveing=!1,this.progresPercent=0,this.isHorizontal=!1,this.isLoggedin=!1,this.isUpdateCanceled=!1,this.noticeIntervalTimer=null,this.ngZone.runOutsideAngular(()=>{sa.instance.initialize(),qu.instance.initialize(),Gu.instance.initialize(),Wu.instance.initialize()}),this.appConfigService.initialize(),this.pointerDeviceService.initialize(),Tr.instance.initialize(),Fs.instance.initialize(),ca.instance.initialize(),new ii("DiceBot",this.chatMessageService).initialize(),ii.getHelpMessage("").then(()=>this.lazyNgZoneUpdate(!0)),new xc("Jukebox").initialize(),new Et("SoundEffect").initialize(),Fs.instance.addChatTab("\u30e1\u30a4\u30f3\u30bf\u30d6","MainTab"),Fs.instance.addChatTab("\u30b5\u30d6\u30bf\u30d6","SubTab").recieveOperationLogLevel=1,Os.instance.initialize();let qe=new Ra("SampleDiceRollTable");qe.initialize(),qe.name="\u30b5\u30f3\u30d7\u30eb\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868",qe.command="SAMPLE",qe.dice="1d6",qe.value="1:\u3053\u308c\u306f\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u30b5\u30f3\u30d7\u30eb\u3067\u3059\n2:\u6570\u5b57\u3068\u5bfe\u5fdc\u3059\u308b\u7d50\u679c\u30921\u884c\u306b1\u3064\u3065\u3064:\uff08\u30b3\u30ed\u30f3\uff09\u3067\u533a\u5207\u308a\n3:\u6570\u5b57:\u7d50\u679c\u306e\u3088\u3046\u306b\u8a18\u8ff0\u3057\u307e\u3059\n4:\\\\n  \\n\u3067\u6539\u884c\u3057\u307e\u3059\n5-6:\u307e\u305f\u3001-\uff08\u30cf\u30a4\u30d5\u30f3\uff09\u3067\u533a\u5207\u3063\u3066\u6570\u5b57\u306e\u7bc4\u56f2\u3092\u6307\u5b9a\u53ef\u80fd\u3067\u3059",Ns.instance.addDiceRollTable(qe);let Ve=on.createEmpty("none_icon").toContext();Ve.url="./assets/images/ic_account_circle_black_24dp_2x.png";let We=Gt.instance.add(Ve);Un.create(We.identifier).tag="*default \u30a2\u30a4\u30b3\u30f3",Ve=on.createEmpty("stand_no_image").toContext(),Ve.url="./assets/images/nc96424.png";let vt=Gt.instance.add(Ve);Un.create(vt.identifier).tag="*default \u30b9\u30bf\u30f3\u30c9";try{kn.getItem(tt.MAIN_VOLUME_LOCAL_STORAGE_KEY).then(nt=>{"number"==typeof nt&&0<=nt&&nt<=1&&(tt.volume=nt)}),kn.getItem(tt.AUDITION_VOLUME_LOCAL_STORAGE_KEY).then(nt=>{"number"==typeof nt&&0<=nt&&nt<=1&&(tt.auditionVolume=nt)}),kn.getItem(tt.SOUND_EFFECT_VOLUME_LOCAL_STORAGE_KEY).then(nt=>{"number"==typeof nt&&0<=nt&&nt<=1&&(tt.soundEffectVolume=nt)}),kn.getItem(tt.NOTICE_VOLUME_LOCAL_STORAGE_KEY).then(nt=>{"number"==typeof nt&&0<=nt&&nt<=1&&(tt.noticeVolume=nt)}),kn.getItem(tt.MAIN_IS_MUTE_LOCAL_STORAGE_KEY).then(nt=>tt.isMute=!!nt),kn.getItem(tt.AUDITION_IS_MUTE_LOCAL_STORAGE_KEY).then(nt=>tt.isAuditionMute=!!nt),kn.getItem(tt.SOUND_EFFECT_IS_MUTE_LOCAL_STORAGE_KEY).then(nt=>tt.isSoundEffectMute=!!nt),kn.getItem(tt.NOTICE_IS_MUTE_LOCAL_STORAGE_KEY).then(nt=>tt.isNoticeMute=!!nt)}catch(nt){console.log(nt)}tt.resumeAudioContext(),st.dicePick=Xt.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,st.dicePut=Xt.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,st.diceRoll1=Xt.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu01.mp3").identifier,st.diceRoll2=Xt.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu02.mp3").identifier,st.cardDraw=Xt.instance.add("./assets/sounds/soundeffect-lab/card-turn-over1.mp3").identifier,st.cardPick=Xt.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,st.cardPut=Xt.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,st.cardShuffle=Xt.instance.add("./assets/sounds/soundeffect-lab/card-open1.mp3").identifier,st.piecePick=Xt.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,st.piecePut=Xt.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,st.blockPick=Xt.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,st.blockPut=Xt.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,st.lock=Xt.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,st.unlock=Xt.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,st.sweep=Xt.instance.add("./assets/sounds/tm2/tm2_swing003.wav").identifier,st.puyon=Xt.instance.add("./assets/sounds/soundeffect-lab/puyon1.mp3").identifier,st.surprise=Xt.instance.add("./assets/sounds/otologic/Onmtp-Surprise02-1.mp3").identifier,st.coinToss=Xt.instance.add("./assets/sounds/niconicomons/nc146227.mp3").identifier,Xt.instance.get(st.dicePick).isHidden=!0,Xt.instance.get(st.dicePut).isHidden=!0,Xt.instance.get(st.diceRoll1).isHidden=!0,Xt.instance.get(st.diceRoll2).isHidden=!0,Xt.instance.get(st.cardDraw).isHidden=!0,Xt.instance.get(st.cardPick).isHidden=!0,Xt.instance.get(st.cardPut).isHidden=!0,Xt.instance.get(st.cardShuffle).isHidden=!0,Xt.instance.get(st.piecePick).isHidden=!0,Xt.instance.get(st.piecePut).isHidden=!0,Xt.instance.get(st.blockPick).isHidden=!0,Xt.instance.get(st.blockPut).isHidden=!0,Xt.instance.get(st.lock).isHidden=!0,Xt.instance.get(st.unlock).isHidden=!0,Xt.instance.get(st.sweep).isHidden=!0,Xt.instance.get(st.puyon).isHidden=!0,Xt.instance.get(st.surprise).isHidden=!0,Xt.instance.get(st.coinToss).isHidden=!0,Qe.createMyCursor().then(()=>{(null==Qe.myCursor.name||""===Qe.myCursor.name)&&(Qe.myCursor.name=Qe.CHAT_DEFAULT_NAME),Qe.myCursor.imageIdentifier||(Qe.myCursor.imageIdentifier=We.identifier)}),Ue.register(this).on("UPDATE_GAME_OBJECT",nt=>{this.lazyNgZoneUpdate(nt.isSendFromSelf)}).on("DELETE_GAME_OBJECT",nt=>{this.lazyNgZoneUpdate(nt.isSendFromSelf)}).on("SYNCHRONIZE_AUDIO_LIST",nt=>{nt.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("SYNCHRONIZE_FILE_LIST",nt=>{nt.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("LOAD_CONFIG",nt=>{if(console.log("LOAD_CONFIG !!!",nt.data),nt.data.dice&&nt.data.dice.url){const _t=nt.data.dice.api;fetch(nt.data.dice.url+(1==_t?"/v1/names":"/v2/game_system"),{mode:"cors"}).then(Mt=>Mt.json()).then(Mt=>{let ht=nt.data.dice.url;ii.apiUrl=ht.endsWith("/")?ht.substring(0,ht.length-1):ht,ii.apiVersion=_t,ii.diceBotInfos=[];let yt=(1==_t?Mt.names:Mt.game_system).filter(Tt=>"DiceBot"!=(1==_t?Tt.system:Tt.id)).map(Tt=>{let nn=Tt.sort_key&&Tt.sort_key.indexOf("\u56fd\u969b\u5316")<0?Tt.sort_key:Tt.name.normalize("NFKD");for(let rn of ii.replaceData)rn[2]&&Tt.name===rn[0]&&(nn=rn[1],Tt.name=rn[2]),nn=nn.split(rn[0].normalize("NFKD")).join(rn[1].normalize("NFKD"));return Tt.normalize=nn.replace(/[\u3041-\u3096]/g,rn=>String.fromCharCode(rn.charCodeAt(0)+96)).replace(/\u7b2c(.+?)\u7248/g,"\u30bf\u30a4$1\u30cf\u30f3").replace(/[\u30fb!?\uff01\uff1f\s\u3000:\uff1a=\uff1d\/\uff0f\uff08\uff09\(\)]+/g,"").replace(/([\u30a2\u30ab\u30b5\u30bf\u30ca\u30cf\u30de\u30e4\u30e9\u30ef])\u30fc+/g,"$1\u30a2").replace(/([\u30a4\u30ad\u30b7\u30c1\u30cb\u30d2\u30df\u30ea])\u30fc+/g,"$1\u30a4").replace(/([\u30a6\u30af\u30b9\u30c4\u30cc\u30d5\u30e0\u30e6\u30eb])\u30fc+/g,"$1\u30a6").replace(/([\u30a8\u30b1\u30bb\u30c6\u30cd\u30d8\u30e1\u30ec])\u30fc+/g,"$1\u30a8").replace(/([\u30aa\u30b3\u30bd\u30c8\u30ce\u30db\u30e2\u30e8\u30ed])\u30fc+/g,"$1\u30aa").replace(/\u30f3+\u30fc+/g,"\u30f3").replace(/\u30f3+/g,"\u30f3"),Tt}).map(Tt=>{const nn=/.+\:(.+)/.exec(1==_t?Tt.system:Tt.id);return Tt.lang=nn?nn[1]:"A",Tt}).sort((Tt,nn)=>Tt.lang<nn.lang?-1:Tt.lang>nn.lang?1:Tt.normalize==nn.normalize?0:Tt.normalize<nn.normalize?-1:1);if(ii.diceBotInfos.push(...yt.map(Tt=>({script:1==_t?Tt.system:Tt.id,game:Tt.name}))),yt.length>0){let Tt=yt[0].normalize.substring(0,1),nn={index:yt[0].normalize.substring(0,1),infos:[]};for(let rn of yt){let En="Other"==rn.lang?"\u305d\u306e\u4ed6":"ChineseTraditional"==rn.lang?"\u6b63\u9ad4\u4e2d\u6587":"Korean"==rn.lang?"\ud55c\uad6d\uc5b4":"English"==rn.lang?"English":"SimplifiedChinese"==rn.lang?"\u7b80\u4f53\u4e2d\u6587":rn.normalize.substring(0,1);En!==Tt&&(Tt=En,ii.diceBotInfosIndexed.push(nn),nn={index:En,infos:[]}),nn.infos.push({script:1==_t?rn.system:rn.id,game:rn.name})}ii.diceBotInfosIndexed.push(nn),ii.diceBotInfosIndexed.sort((rn,En)=>rn.index==En.index?0:rn.index<En.index?-1:1)}})}else{ii.diceBotInfos.forEach(ht=>{let yt=ht.sort_key.normalize("NFKD");for(let Tt of ii.replaceData)Tt[2]&&ht.game===Tt[0]&&(yt=Tt[1],ht.game=Tt[2]),yt=yt.split(Tt[0].normalize("NFKD")).join(Tt[1].normalize("NFKD"));yt=yt.replace(/[\u3041-\u3096]/g,Tt=>String.fromCharCode(Tt.charCodeAt(0)+96)).replace(/\u7b2c(.+?)\u7248/g,"\u30bf\u30a4$1\u30cf\u30f3").replace(/[\u30fb!?\uff01\uff1f\s\u3000:\uff1a=\uff1d\/\uff0f\uff08\uff09\(\)]+/g,"").replace(/([\u30a2\u30ab\u30b5\u30bf\u30ca\u30cf\u30de\u30e4\u30e9\u30ef])\u30fc+/g,"$1\u30a2").replace(/([\u30a4\u30ad\u30b7\u30c1\u30cb\u30d2\u30df\u30ea])\u30fc+/g,"$1\u30a4").replace(/([\u30a6\u30af\u30b9\u30c4\u30cc\u30d5\u30e0\u30e6\u30eb])\u30fc+/g,"$1\u30a6").replace(/([\u30a8\u30b1\u30bb\u30c6\u30cd\u30d8\u30e1\u30ec])\u30fc+/g,"$1\u30a8").replace(/([\u30aa\u30b3\u30bd\u30c8\u30ce\u30db\u30e2\u30e8\u30ed])\u30fc+/g,"$1\u30aa").replace(/\u30f3+\u30fc+/g,"\u30f3").replace(/\u30f3+/g,"\u30f3"),ht.sort_key=ht.lang?ht.lang:yt.normalize("NFKD")}),ii.diceBotInfos.sort((ht,yt)=>"Other"==ht.sort_key&&"Other"==yt.sort_key?0:"Other"==ht.sort_key?1:"Other"==yt.sort_key?-1:ht.sort_key==yt.sort_key?0:ht.sort_key<yt.sort_key?-1:1);let _t=ii.diceBotInfos[0].sort_key[0],Mt={index:_t,infos:[]};for(let ht of ii.diceBotInfos)"Other"==ht.lang&&(ht.lang="\u7b80\u4f53\u4e2d\u6587"),(ht.lang?ht.lang:ht.sort_key[0])!==_t&&(_t=ht.lang?ht.lang:ht.sort_key[0],ii.diceBotInfosIndexed.push(Mt),Mt={index:_t,infos:[]}),Mt.infos.push({script:ht.id,game:ht.game});ii.diceBotInfosIndexed.push(Mt)}ii.diceBotInfosIndexed.sort((_t,Mt)=>_t.index==Mt.index?0:_t.index<Mt.index?-1:1),Ot.setApiKey(nt.data.webrtc.key),Ot.open()}).on("FILE_LOADED",nt=>{this.lazyNgZoneUpdate(!1)}).on("OPEN_NETWORK",nt=>{console.log("OPEN_NETWORK",nt.data.peerId),Qe.myCursor.peerId=Ot.peerContext.peerId,Qe.myCursor.userId=Ot.peerContext.userId,this.isLoggedin=!1}).on("NETWORK_ERROR",nt=>{console.log("NETWORK_ERROR",nt.data.peerId);let _t=nt.data.errorType,Mt=nt.data.errorMessage;this.ngZone.run((0,gn.Z)(function*(){["peer-unavailable"].includes(_t)||(yield xe.modalService.open(Fu,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:Mt}),["disconnected","socket-error","unavailable-id","authentication","server-error"].includes(_t)&&(yield xe.modalService.open(Fu,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:"\u3053\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b\u3068\u518d\u63a5\u7d9a\u3092\u8a66\u307f\u307e\u3059\u3002"}),Ot.open(),xe.isLoggedin=!1))}))}).on("CONNECT_PEER",nt=>{nt.isSendFromSelf&&(this.chatMessageService.calibrateTimeOffset(),this.isLoggedin||(this.isLoggedin=!0,s.sendOperationLog((Ot.peerContext.isRoom?Ot.peerContext.roomName+" \u306b":"\u4ed6\u8005\u3068")+"\u63a5\u7d9a\u3057\u305f"))),this.lazyNgZoneUpdate(nt.isSendFromSelf)}).on("DISCONNECT_PEER",nt=>{this.lazyNgZoneUpdate(nt.isSendFromSelf),nt.isSendFromSelf&&(this.isLoggedin=!1)}).on("MESSAGE_NORTIFICATION",nt=>{Ku.isNoticeOn?this.noticeIntervalTimer||(this.noticeIntervalTimer=setTimeout(()=>{clearTimeout(this.noticeIntervalTimer),this.noticeIntervalTimer=null},100),this.notice()):this.noticeIntervalTimer&&(clearTimeout(this.noticeIntervalTimer),this.noticeIntervalTimer=null)}).on("PLAY_CUT_IN",-1e3,nt=>{let _t=Ct.instance.get(nt.data.identifier);this.cutInService.play(_t,!!nt.data.secret&&nt.data.secret,!!nt.data.test&&nt.data.test,nt.data.sender)}).on("STOP_CUT_IN",-1e3,nt=>{this.cutInService.stop(nt.data.identifier)}).on("POPUP_STAND_IMAGE",-1e3,nt=>{let _t=Ct.instance.get(nt.data.standIdentifier),Mt=Ct.instance.get(nt.data.characterIdentifier);this.standImageService.show(Mt,_t,nt.data.color?nt.data.color:null,nt.data.secret)}).on("FAREWELL_STAND_IMAGE",-1e3,nt=>{this.standImageService.farewell(nt.data.characterIdentifier)}).on("DELETE_STAND_IMAGE",-1e3,nt=>{this.standImageService.destroy(nt.data.characterIdentifier,nt.data.identifier)}).on("DESTORY_STAND_IMAGE_ALL",-1e3,nt=>{this.standImageService.destroyAll()})}get otherPeers(){return Ct.instance.getObjects(Qe)}static get noticePlayer(){return t._noticePlayer||(t._noticePlayer=new tt,t._noticePlayer.volumeType=Vo.NOTICE),t._noticePlayer}notice(e=st.puyon){const i=Xt.instance.get(e);i&&i.isReady?(Ue.unregister(this,"UPDATE_AUDIO_RESOURE"),t.noticePlayer.play(i)):Ue.register(this).on("UPDATE_AUDIO_RESOURE",-100,r=>{this.notice(e)})}ngOnInit(){window.addEventListener("beforeunload",t.beforeUnloadProc)}ngAfterViewInit(){qn.defaultParentViewContainerRef=Yn.defaultParentViewContainerRef=hr.defaultParentViewContainerRef=$r.defaultParentViewContainerRef=pg.defaultParentViewContainerRef=this.modalLayerViewContainerRef,queueMicrotask(()=>{this.panelService.open(Lv,{width:520,height:450,left:100}),this.panelService.open(Ku,{width:700,height:400,left:100,top:450})}),this.swUpdate.versionUpdates.subscribe(e=>{switch(e.type){case"VERSION_DETECTED":console.log(`Downloading new app version: ${e.version.hash}`);break;case"VERSION_READY":console.log(`Current app version: ${e.currentVersion.hash}`),console.log(`New app version ready for use: ${e.latestVersion.hash}`),this.isUpdateCanceled||this.modalService.open(pr,{title:"Udonarium with Fly \u306e\u66f4\u65b0",text:"Udonarium with Fly \u306e\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u516c\u958b\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u66f4\u65b0\u3092\u884c\u3044\u307e\u3059\u304b\uff1f",help:"\u66f4\u65b0\u306e\u969b\u306b\u30da\u30fc\u30b8\u3092\u518d\u8aad\u307f\u8fbc\u307f\u3057\u307e\u3059\u3002\u624b\u52d5\u3067\u518d\u8aad\u307f\u8fbc\u307f\u3092\u884c\u3046\u3053\u3068\u3067\u3082\u66f4\u65b0\u53ef\u80fd\u3067\u3059\u3002",type:Li.OK_CANCEL,materialIcon:"browser_updated",action:()=>{this.swUpdate.activateUpdate().then(()=>{window.removeEventListener("beforeunload",t.beforeUnloadProc),document.location.reload()})},cancelAction:()=>{this.isUpdateCanceled=!0}});break;case"VERSION_INSTALLATION_FAILED":console.log(`Failed to install app version '${e.version.hash}': ${e.error}`)}})}ngOnDestroy(){Ue.unregister(this),this.noticeIntervalTimer&&clearTimeout(this.noticeIntervalTimer)}open(e){let i=null,r={width:450,height:600,left:100};switch(e){case"PeerMenuComponent":r.width=520,i=Lv;break;case"ChatWindowComponent":i=Ku,r.width=700;break;case"GameTableSettingComponent":i=PI,r={width:610,height:400,left:100};break;case"FileStorageComponent":i=us,r.width=700;break;case"GameCharacterSheetComponent":i=ps;break;case"JukeboxComponent":i=vX,r.height=540;break;case"GameCharacterGeneratorComponent":i=JY,r={width:500,height:300,left:100};break;case"GameObjectInventoryComponent":i=WZ;break;case"DiceRollTableSettingComponent":i=lQ,r={width:645,height:475};break;case"CutInSettingComponent":i=DQ,r={width:700,height:600}}i&&(r.top=20*(this.openPanelCount%10+1),r.left=100+5*(this.openPanelCount%20+1),this.openPanelCount=this.openPanelCount+1,this.panelService.open(i,r))}save(){var e=this;return(0,gn.Z)(function*(){if(e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i=Ot.peerContext&&0<Ot.peerContext.roomName.length?Ot.peerContext.roomName:"fly_\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf";yield e.saveDataService.saveRoomAsync(i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}handleFileSelect(e){let i=e.target,r=i.files;r.length&&sa.instance.load(r),i.value=""}lazyNgZoneUpdate(e){if(e){if(null!==this.immediateUpdateTimer)return;this.immediateUpdateTimer=setTimeout(()=>{this.immediateUpdateTimer=null,null!=this.lazyUpdateTimer&&(clearTimeout(this.lazyUpdateTimer),this.lazyUpdateTimer=null),this.ngZone.run(()=>{})},0)}else{if(null!==this.lazyUpdateTimer)return;this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,null!=this.immediateUpdateTimer&&(clearTimeout(this.immediateUpdateTimer),this.immediateUpdateTimer=null),this.ngZone.run(()=>{})},100)}}toolBox(e){const i=e.target,r=i.getBoundingClientRect(),o={x:window.pageXOffset+r.left+(this.isHorizontal?0:.9*i.clientWidth),y:window.pageYOffset+r.top+(this.isHorizontal?.9*i.clientHeight:0)},s=[],a=Os.instance.cutIns;s.push({name:"\u30ab\u30c3\u30c8\u30a4\u30f3\u518d\u751f",materialIcon:"play_arrow",action:null,subActions:0===a.length?[{name:"(\u30ab\u30c3\u30c8\u30a4\u30f3\u306a\u3057)",disabled:!0,center:!0}]:a.map(h=>({name:`${h.isValidAudio?"":"\u26a0\ufe0f"}${""==h.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":h.name}`,subActions:[{name:"\u5168\u54e1",action:()=>{Ue.call("PLAY_CUT_IN",{identifier:h.identifier,secret:!1,sender:Qe.myCursor.peerId}),this.chatMessageService.sendOperationLog((""==h.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":h.name)+" \u3092\u518d\u751f\u3057\u305f")}},Ht,...this.otherPeers.map(b=>({name:b.name+(b===Qe.myCursor?" (\u3042\u306a\u305f)":""),color:b.color,default:!0,action:()=>{b!==Qe.myCursor&&Ue.call("PLAY_CUT_IN",{identifier:h.identifier,secret:!0,sender:Qe.myCursor.peerId},b.peerId),Ue.call("PLAY_CUT_IN",{identifier:h.identifier,secret:!0,sender:Qe.myCursor.peerId},Qe.myCursor.peerId)}}))]}))}),s.push(Ht),s.push({name:"\u30ab\u30c3\u30c8\u30a4\u30f3\u8a2d\u5b9a...",materialIcon:"movie_creation",action:()=>this.open("CutInSettingComponent")}),s.push({name:"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u8a2d\u5b9a...",materialIcon:"table_rows",action:()=>this.open("DiceRollTableSettingComponent")}),this.contextMenuService.open(o,s,"\u30c4\u30fc\u30eb\u30dc\u30c3\u30af\u30b9")}resetPointOfView(e){const i=e.target,r=i.getBoundingClientRect(),o={x:window.pageXOffset+r.left+(this.isHorizontal?0:.9*i.clientWidth),y:window.pageYOffset+r.top+(this.isHorizontal?.9*i.clientHeight:0)};this.contextMenuService.open(o,[{name:"\u521d\u671f\u8996\u70b9\u306b\u623b\u3059",action:()=>Ue.trigger("RESET_POINT_OF_VIEW",null)},{name:"\u771f\u4e0a\u304b\u3089\u8996\u308b",action:()=>Ue.trigger("RESET_POINT_OF_VIEW","top")}],"\u8996\u70b9\u30ea\u30bb\u30c3\u30c8")}standSetteings(e){const i=e.target,r=i.getBoundingClientRect(),o={x:window.pageXOffset+r.left+(this.isHorizontal?0:.9*i.clientWidth),y:window.pageYOffset+r.top+(this.isHorizontal?.9*i.clientHeight:0)},s=da.isShowStand,a=da.isShowNameTag,h=da.isCanBeGone;this.contextMenuService.open(o,[{name:(Tr.instance.gridShow?"\u2611":"\u2610")+"\u30c6\u30fc\u30d6\u30eb\u30b0\u30ea\u30c3\u30c9\u3092\u5e38\u306b\u8868\u793a",action:()=>{Tr.instance.gridShow=!Tr.instance.gridShow,Ue.trigger("UPDATE_GAME_OBJECT",Tr.instance.toContext())}},{name:(Tr.instance.gridSnap?"\u2611":"\u2610")+"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u79fb\u52d5\u6642\u306b\u30b9\u30ca\u30c3\u30d7",action:()=>{Tr.instance.gridSnap=!Tr.instance.gridSnap}},Ht,{name:(Ku.isNoticeOn?"\u2611":"\u2610")+"\u30c1\u30e3\u30c3\u30c8\u53d7\u4fe1\u6642\u306b\u97f3\u3067\u901a\u77e5",action:()=>{Ku.isNoticeOn=!Ku.isNoticeOn}},Ht,{name:(s?"\u2611":"\u2610")+"\u30b9\u30bf\u30f3\u30c9\u8868\u793a",action:()=>{da.isShowStand=!s}},{name:(a?"\u2611":"\u2610")+"\u30cd\u30fc\u30e0\u30bf\u30b0\u8868\u793a",action:()=>{da.isShowNameTag=!a},level:1,disabled:!da.isShowStand},{name:(h?"\u2611":"\u2610")+"\u900f\u660e\u5316\u3001\u81ea\u52d5\u9000\u53bb",action:()=>{da.isCanBeGone=!h},level:1,disabled:!da.isShowStand},Ht,{name:"\u8868\u793a\u30b9\u30bf\u30f3\u30c9\u5168\u6d88\u53bb",action:()=>Ue.trigger("DESTORY_STAND_IMAGE_ALL",null)}],"\u500b\u4eba\u8a2d\u5b9a")}diceAllOpne(){this.modalService.open(pr,{title:"\u30c0\u30a4\u30b9\u4e00\u6589\u516c\u958b",text:"\u30c6\u30fc\u30d6\u30eb\u4e0a\u306e\u30c0\u30a4\u30b9\u3001\u30b3\u30a4\u30f3\u3092\u516c\u958b\u3057\u307e\u3059\u304b\uff1f",help:"\u300c\u4e00\u6589\u516c\u958b\u3057\u306a\u3044\u300d\u8a2d\u5b9a\u306e\u3082\u306e\u306f\u516c\u958b\u3055\u308c\u307e\u305b\u3093\u3002",type:Li.OK_CANCEL,materialIcon:"all_out",action:()=>{Ue.trigger("DICE_ALL_OPEN",null)}})}deleteGameObject(e){throw new Error("Method not implemented.")}rotateChange(e){this.isHorizontal=e}}return t.beforeUnloadProc=n=>{n.preventDefault(),n.returnValue=""},t.\u0275fac=function(e){return new(e||t)(He(jI),He(Yn),He(qn),He(Ci),He(Hr),He(Rv),He(Gr),He(Nn),He(hr),He($r),He(pg))},t.\u0275cmp=fn({type:t,selectors:[["app-root"]],viewQuery:function(e,i){if(1&e&&wn(vie,7,no),2&e){let r;Cn(r=xn())&&(i.modalLayerViewContainerRef=r.first)}},decls:98,vars:13,consts:[["id","app-table-layer",2,"position","absolute","width","100%","height","100%","overflow","hidden"],[3,"top","left","width","height","title","isAbleFullScreenButton","isAbleCloseButton","isAbleRotateButton","rotateEvent"],[3,"ngClass"],[3,"click"],["routerLink","/","routerLinkActive","active"],[1,"material-icons","icon-size"],[1,"material-icons"],["routerLink","/","routerLinkActive","active",2,"pointer-events","none"],[1,"self-only"],["type","file","multiple","","accept","application/xml,text/xml,application/zip",2,"display","none",3,"change"],[3,"click",4,"ngIf"],["style","pointer-events: none;",4,"ngIf"],[1,"self-only-indicater",2,"font-size","8px","text-align","center"],["modalLayer",""],[1,"networkIndicator"],[2,"pointer-events","none"],[1,"material-icons","vibration-amine"]],template:function(e,i){1&e&&(Q(0,"div",0),mt(1,"game-table"),ne(),Q(2,"ui-panel",1),Ae("rotateEvent",function(o){return i.rotateChange(o)}),Q(3,"nav",2)(4,"ul")(5,"li",3),Ae("click",function(){return i.open("PeerMenuComponent")}),Q(6,"a",4)(7,"div")(8,"i",5),ve(9,"people"),ne()(),Q(10,"div"),ve(11,"\u63a5\u7d9a"),ne()()(),Q(12,"li",3),Ae("click",function(){return i.open("ChatWindowComponent")}),Q(13,"a",4)(14,"div")(15,"i",5),ve(16,"speaker_notes"),ne()(),Q(17,"div"),ve(18,"\u30c1\u30e3\u30c3\u30c8\u753b\u9762"),ne()()(),Q(19,"li",3),Ae("click",function(){return i.open("GameTableSettingComponent")}),Q(20,"a",4)(21,"div")(22,"i",5),ve(23,"layers"),ne()(),Q(24,"div"),ve(25,"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a"),ne()()(),Q(26,"li",3),Ae("click",function(){return i.open("FileStorageComponent")}),Q(27,"a",4)(28,"div")(29,"i",5),ve(30,"photo_library"),ne()(),Q(31,"div"),ve(32,"\u753b\u50cf"),ne()()(),Q(33,"li",3),Ae("click",function(){return i.open("JukeboxComponent")}),Q(34,"a",4)(35,"div")(36,"i",6),ve(37,"queue_music"),ne()(),Q(38,"div"),ve(39,"\u97f3\u697d"),ne()()(),Q(40,"li",3),Ae("click",function(o){return i.toolBox(o)}),Q(41,"a",7)(42,"div")(43,"i",6),ve(44,"build"),ne()(),Q(45,"div"),ve(46,"\u30c4\u30fc\u30eb\u30dc\u30c3\u30af\u30b9"),ne()()(),Q(47,"li",3),Ae("click",function(){return i.open("GameObjectInventoryComponent")}),Q(48,"a",4)(49,"div")(50,"i",5),ve(51,"folder_shared"),ne()(),Q(52,"div"),ve(53,"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),ne()()(),Q(54,"li",3),Ae("click",function(){return i.diceAllOpne()}),Q(55,"a",4)(56,"div")(57,"i",5),ve(58,"all_out"),ne()(),Q(59,"div"),ve(60,"\u30c0\u30a4\u30b9\u4e00\u6589\u516c\u958b"),ne()()(),Q(61,"li",3),Ae("click",function(o){return i.standSetteings(o)}),Q(62,"a",7)(63,"div")(64,"i",5),ve(65,"how_to_reg"),ne()(),Q(66,"div"),ve(67,"\u500b\u4eba\u8a2d\u5b9a"),Q(68,"sup",8),ve(69,"*"),ne()()()(),Q(70,"li",3),Ae("click",function(o){return i.resetPointOfView(o)}),Q(71,"a",7)(72,"div")(73,"i",5),ve(74,"remove_red_eye"),ne()(),Q(75,"div"),ve(76,"\u8996\u70b9\u30ea\u30bb\u30c3\u30c8"),Q(77,"sup",8),ve(78,"*"),ne()()()(),Q(79,"li")(80,"a",4)(81,"label")(82,"div")(83,"i",6),ve(84,"open_in_browser"),ne()(),Q(85,"div"),ve(86,"ZIP\u8aad\u8fbc"),ne(),Q(87,"input",9),Ae("change",function(o){return i.handleFileSelect(o)}),ne()()()(),Te(88,bie,7,0,"li",10),Te(89,yie,7,1,"li",11),ne(),Q(90,"div",12)(91,"b")(92,"sup",8),ve(93,"*"),ne(),ve(94,"\u306f\u81ea\u5206\u306e\u307f"),ne()()()(),mt(95,"div",null,13)(97,"network-indicator",14)),2&e&&(G(2),oe("top",0)("left",0)("width",100)("height",710)("title","\u30e1\u30cb\u30e5\u30fc")("isAbleFullScreenButton",!1)("isAbleCloseButton",!1)("isAbleRotateButton",!0),G(1),oe("ngClass",wt(11,Cie,i.isHorizontal)),G(85),oe("ngIf",!i.isSaveing),G(1),oe("ngIf",i.isSaveing))},dependencies:[si,Bn,_ie,NI,$ie],styles:["[_nghost-%COMP%]{display:block}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{text-align:center;padding:5px;color:#ccc;color:#444;cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:hover{color:#ccc;background-color:#1e1e1ecc}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{height:128px;width:128px;font-size:8px;-webkit-user-select:none;-moz-user-select:none;user-select:none}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:24px}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{text-decoration:none}.icon-size[_ngcontent-%COMP%]{font-size:40px}.side-menu[_ngcontent-%COMP%]{top:0;left:0;box-sizing:border-box;overflow:auto;position:absolute;color:#ccc;background-color:#1e1e1ecc;border:solid 1px #999;padding:0;height:100%;width:300px}.networkIndicator[_ngcontent-%COMP%]{display:none;z-index:9999;pointer-events:none;position:absolute;top:3px;right:3px;height:30px;width:30px}.vibration-amine[_ngcontent-%COMP%]{animation:vibration .2s infinite}@keyframes vibration{0%{transform:scale(1) translate(0)}50%{transform:scale(1.02,.95) translateY(5%)}to{transform:scale(1) translate(0)}}.self-only[_ngcontent-%COMP%]{color:red}.horizontal[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap}.horizontal[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{display:inline-block;width:74px}[_ngcontent-%COMP%]:not(.horizontal)   .self-only-indicater[_ngcontent-%COMP%]{margin-top:2em}.horizontal[_ngcontent-%COMP%]   .self-only-indicater[_ngcontent-%COMP%]{display:none}"]}),t})();qn.UIPanelComponentClass=NI,hr.ContextMenuComponentClass=QY,Yn.ModalComponentClass=CX;let xie=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zo({type:t}),t.\u0275inj=Eo({}),t})(),Eie=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zo({type:t,bootstrap:[wie]}),t.\u0275inj=Eo({providers:[Rv,Hr,hr,Yn,Bv,qn,Ci,Vu,$r],imports:[cx,NL,Uw,P6,xie,d7,QQ.register("ngsw-worker.js",{enabled:true})]}),t})();Gg(Lu,function(){return[_i,Bn,nc,oo,so,Ii,ol,Mi,tc,yi,Ma,ff,mr]},[]),Gg(Lu,function(){return[_i,Bn,nc,oo,so,Ii,ol,Mi,tc,yi,Ma,ff,mr]},[]),function rO(){gw=!1}(),CR().bootstrapModule(Eie).catch(t=>console.error(t))},5904:(E,le,_e)=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0}),_e(8827),_e(4748),_e(9202),_e(8465);var d=_e(3583),H=_e(3693),J=function(){function _(w,O){this.internal=O??d.BCDice.Base.$new(w)}return _.eval=function(w){var O=d.BCDice.Base.$eval(w);return H.parseResult(O)},Object.defineProperty(_.prototype,"randomizer",{get:function(){return this.internal.randomizer},enumerable:!1,configurable:!0}),_.prototype.eval=function(){var w=this.internal.$eval();return H.parseResult(w)},_}();le.default=J},8827:(E,le,_e)=>{_e(9993),Opal.queue(function(d){var U,j,q,M,I,re,z,Y,H=d.module,J=d.ensure_kwargs,_=d.truthy,w=d.thrower,O=d.def,x=[],K=d.nil,V=d.$$$;return U=x,j=Y=[H(x[0],"BCDice")].concat(U),z=[re=H(Y[0],"ArithmeticEvaluator")].concat(j),M=[q=d.get_singleton_class(re)].concat(z),I=d.$r(M),O(q,"$eval",function(L,S){try{w("eval_return");var v,P=K;return null==(v=(S=J(S)).$$smap.round_type)&&(v=V(I("RoundType"),"FLOOR")),_(L)&&_(P=I("Arithmetic").$eval(L,v))?P:0}catch(B){if(B===d.t_eval_return)return B.$v;throw B}},-2)})},9202:(E,le,_e)=>{_e(9993),Opal.modules.json=function(d){var z,re,H=d.module,J=d.klass,_=d.send,w=d.Object,O=d.hash2,x=d.eqeqeq,K=d.defs,V=d.truthy,A=d.def,U=d.return_val,N=[],Y=d.nil,T=d.$$$;return function(j,re){var q,z=H(j,"JSON"),Z=[z].concat(re),M=d.$r(Z);J(Z[0],M("StandardError"),"JSONError"),J(Z[0],M("JSONError"),"ParserError");var I=d.hasOwnProperty;function X(S){try{return JSON.parse(S)}catch(k){z.$raise(T(M("JSON"),"ParserError"),k.message)}}function L(S,k){var v,P,B,te,D,fe;switch(typeof S){case"string":case"number":return S;case"boolean":return!!S;case"undefined":return Y;case"object":if(!S)return Y;if(S.$$is_array){for(P=k.array_class.$new(),te=0,D=S.length;te<D;te++)P.$push(L(S[te],k));return P}for(fe in B=k.object_class.$new(),S)I.call(S,fe)&&(q=[fe,L(S[fe],k)],_(B,"[]=",q));return k.parse||(v=B["$[]"](M("JSON").$create_id()))==Y?B:w.$const_get(v).$json_create(B)}}d.get_singleton_class(z).$attr_accessor("create_id"),z["$create_id="]("json_class"),K(z,"$[]",function(k,v){return null==v&&(v=O([],{})),x(M("String"),k)?this.$parse(k,v):this.$generate(k,v)},-2),K(z,"$parse",function(k,v){return null==v&&(v=O([],{})),this.$from_object(X(k),v.$merge(O(["parse"],{parse:!0})))},-2),K(z,"$parse!",function(k,v){return null==v&&(v=O([],{})),this.$parse(k,v)},-2),K(z,"$load",function(k,v){return null==v&&(v=O([],{})),this.$from_object(X(k),v)},-2),K(z,"$from_object",function(k,v){return null==v&&(v=O([],{})),V(v["$[]"]("object_class"))||v["$[]="]("object_class",M("Hash")),V(v["$[]"]("array_class"))||v["$[]="]("array_class",M("Array")),L(k,v.$$smap)},-2),K(z,"$generate",function(k,v){return null==v&&(v=O([],{})),k.$to_json(v)},-2),K(z,"$dump",function(k,v,P){var te;return null==v&&(v=Y),null==P&&(P=Y),te=this.$generate(k),V(v)?(V(v["$responds_to?"]("to_io"))&&(v=v.$to_io()),v.$write(te),v):te},-2)}(N[0],N),z=J(N[0],null,"Object"),A(z,"$to_json",function(){return this.$to_s().$to_json()}),re=H(N[0],"Enumerable"),A(re,"$to_json",function(){return this.$to_a().$to_json()}),function(j,re){var z=J(j,null,"Array");A(z,"$to_json",function(){for(var M=[],I=0,X=this.length;I<X;I++)M.push(this[I].$to_json());return"["+M.join(",")+"]"})}(N[0]),function(j,re){var z=J(j,null,"Boolean");A(z,"$to_json",function(){return 1==this?"true":"false"})}(N[0]),function(j,re){var z=J(j,null,"Hash");A(z,"$to_json",function(){for(var S,k,M=[],I=0,X=this.$$keys,L=X.length;I<L;I++)(S=X[I]).$$is_string?k=this.$$smap[S]:(k=S.value,S=S.key),M.push(S.$to_s().$to_json()+":"+k.$to_json());return"{"+M.join(",")+"}"})}(N[0]),function(j,re){var z=J(j,null,"NilClass");A(z,"$to_json",U("null"))}(N[0]),function(j,re){var z=J(j,null,"Numeric");A(z,"$to_json",function(){return this.toString()})}(N[0]),function(j,re){var z=J(j,null,"String");A(z,"$to_json",function(){return JSON.stringify(this)})}(N[0]),function(j,re){var z=J(j,null,"Time");A(z,"$to_json",function(){return this.$strftime("%FT%T%z").$to_json()})}(N[0]),function(j,re){var z=J(j,null,"Date");return A(z,"$to_json",function(){return this.$to_s().$to_json()}),A(z,"$as_json",function(){return this.$to_s()})}(N[0])},Opal.modules.i18n=function(d){var I,S,v,P,X,L,H=d.module,J=d.class_variable_set,_=d.class_variable_get,w=d.def,O=d.truthy,x=d.hash2,K=d.send,V=d.ensure_kwargs,A=d.kwrestargs,U=d.to_a,Y=d.alias,T=d.klass,j=d.return_val,z=[],q=d.nil,Z=d.$$$;return d.top.$require("json"),I=z,L=[X=H(z[0],"I18n")].concat(I),S=d.get_singleton_class(X),v=[S].concat(L),P=d.$r(v),J(v[1],"@@load_path",[]),J(v[1],"@@table",q),w(S,"$load_path",function(){return _(v[1],"@@load_path",!1)}),w(S,"$default_locale",function(){return _(v[1],"@@default_locale",!1)}),w(S,"$default_locale=",function(te){return J(v[1],"@@default_locale",te)}),w(S,"$fallbacks",function(){return Z(Z(P("I18n"),"Locale"),"Fallbacks").$new()}),w(S,"$load_default_translation",function(){return O(_(v[1],"@@table",!1)["$nil?"]())?(J(v[1],"@@table",x([],{})),this.$load_translation(JSON.stringify(_e(6884)))):q}),w(S,"$load_translation",function(te){var fe;return this.$load_default_translation(),fe=P("JSON").$parse(te,x(["symbolize_names"],{symbolize_names:!0})),J(v[1],"@@table",K(_(v[1],"@@table",!1),"merge",[fe],function(F,g,l){return null==F&&(F=q),null==g&&(g=q),null==l&&(l=q),g.$merge(l)}))}),w(S,"$clear_translate_table",function(){return J(v[1],"@@table",q)}),w(S,"$translate",function(te,D){var fe,R,g,l,c=q,f=q,u=q;null==(fe=(D=V(D)).$$smap.locale)&&(fe=q),R=A(D,{locale:!0}),this.$load_default_translation(),g=K(te.$split("."),"map",[],"to_sym".$to_proc()),l=_(v[1],"@@table",!1),c=_(v[1],"@@default_locale",!1),f=O(u=K(l,"dig",[fe].concat(U(g))))?u:K(l,"dig",[c].concat(U(g)));try{O(f["$is_a?"](P("String")))&&(f=this.$format(f,d.to_hash(R)))}catch(p){if(!d.rescue(p,[P("ArgumentError"),P("KeyError")]))throw p;d.pop_exception()}return O(u=f)?u:R["$[]"]("default")},-2),Y(S,"t","translate"),function(S,k){var te,D,fe,P=[H(S,"Locale")].concat(k),B=d.$r(P);te=P[0],D=B("Hash"),fe=T(te,D,"Fallbacks"),w(fe,"$defaults=",j(q))}(L[0],L),function(S,k){var P=[H(S,"Backend")].concat(k);H(P[0],"Simple")}(L[0],L),function(S,k){var B,v=H(S,"Thread");return[v].concat(k),B=d.get_singleton_class(v),w(B,"$current",function(){return x(["i18n_fallbacks"],{i18n_fallbacks:q})})}(L[0],L)},Opal.modules["i18n/backend/fallbacks"]=function(d){var Z,X,S,k,M,I,H=d.module,J=d.class_variable_set,_=d.truthy,w=d.class_variable_get,O=d.def,x=d.send,K=d.send2,V=d.find_super,A=d.hash2,U=d.find_block_super,N=d.neqeq,Y=d.thrower,T=d.return_val,j=[],re=d.nil,z=d.$$$;return Z=j,I=[M=H(j[0],"I18n")].concat(Z),J(I[0],"@@fallbacks",re),X=d.get_singleton_class(M),S=[X].concat(I),k=d.$r(S),O(X,"$fallbacks",function(){var B=re;return J(S[1],"@@fallbacks",_(null!=S[1].$$cvars["@@fallbacks"]?"class variable":re)&&_(B=w(S[1],"@@fallbacks",!1))?B:z(z(k("I18n"),"Locale"),"Fallbacks").$new()),_(B=k("Thread").$current()["$[]"]("i18n_fallbacks"))?B:w(S[1],"@@fallbacks",!1)}),O(X,"$fallbacks=",function(P){var B;return J(S[1],"@@fallbacks",_(P["$is_a?"](k("Array")))?z(z(k("I18n"),"Locale"),"Fallbacks").$new(P):P),B=["i18n_fallbacks",w(S[1],"@@fallbacks",!1)],x(k("Thread").$current(),"[]=",B),B[B.length-1]}),function(X,L){var P,B,te,D,k=[H(X,"Backend")].concat(L);return P=k,te=[B=H(k[0],"Fallbacks")].concat(P),D=d.$r(te),O(B,"$translate",function fe(R,F,g){try{var l=Y("return"),c=fe.$$p||re,f=this,u=re,p=re;return fe.$$p=null,null==g&&(g=D("EMPTY_HASH")),_(g.$fetch("fallback",!0))?_(g["$[]"]("fallback_in_progress"))?K(f,V(f,"translate",fe,!1,!0),"translate",[R,F,g],c):(_(g["$[]"]("default"))&&(u=f["$extract_non_symbol_default!"](g)),p=g.$merge(A(["fallback_in_progress"],{fallback_in_progress:!0})),x(D("I18n").$fallbacks()["$[]"](R),"each",[],function m(C){var $=m.$$s??this;null==C&&(C=re);try{return x($,"catch",["exception"],function ie(){var se=ie.$$s??this,Ee=re;if(Ee=K(se,U(se,"translate",ie.$$def||m.$$def||fe,!1,!1),"translate",[C,F,p],null),_(Ee["$nil?"]()))return re;N(R.$to_s(),C.$to_s())&&se.$on_fallback(R,C,F,g),l.$throw(Ee)},{$$s:$,$$ret:l})}catch(ie){if(!d.rescue(ie,[z(D("I18n"),"InvalidLocale")]))throw ie;try{return re}finally{d.pop_exception()}}},{$$s:f}),_(g["$key?"]("default"))&&_(g["$[]"]("default")["$nil?"]())?re:_(u)?K(f,V(f,"translate",fe,!1,!0),"translate",[R,re,g.$merge(A(["default"],{default:u}))],null):f.$throw("exception",z(D("I18n"),"MissingTranslation").$new(R,F,g))):K(f,V(f,"translate",fe,!1,!0),"translate",[R,F,g],c)}catch(m){if(m===l)return m.$v;throw m}},-3),O(B,"$extract_non_symbol_default!",function(R){var g,F=re;return F=[R["$[]"]("default")].$flatten(),g=x(F,"detect",[],function(c){return null==c&&(c=re),c["$is_a?"](D("Symbol"))["$!"]()}),_(g)&&R["$[]="]("default",F["$[]"](0,F.$index(g))),g}),O(B,"$exists?",function fe(R,F,g){try{var l=Y("return"),c=fe.$$p||re,f=this;return fe.$$p=null,null==g&&(g=D("EMPTY_HASH")),_(g.$fetch("fallback",!0))?(x(D("I18n").$fallbacks()["$[]"](R),"each",[],function u(p){var m=u.$$s??this;null==p&&(p=re);try{if(!_(K(m,U(m,"exists?",u.$$def||fe,!1,!1),"exists?",[p,F],null)))return re;l.$throw(!0)}catch(C){if(!d.rescue(C,[z(D("I18n"),"InvalidLocale")]))throw C;try{return re}finally{d.pop_exception()}}},{$$s:f,$$ret:l}),!1):K(f,V(f,"exists?",fe,!1,!0),"exists?",[R,F,g],c)}catch(u){if(u===l)return u.$v;throw u}},-3),B.$private(),O(B,"$on_fallback",T(re))}(I[0],I)},Opal.modules["bcdice/randomizer"]=function(d){var M,v,P,B,te,D,X,L,J=d.klass,_=d.const_set,w=d.def,O=d.truthy,x=d.rb_gt,K=d.rb_plus,V=d.rb_le,A=d.send,U=d.rb_minus,N=d.eqeq,Y=d.rb_times,T=d.eqeqeq,j=d.rb_ge,re=[],z=d.nil,q=d.$$$;return M=re,X=[(0,d.module)(re[0],"BCDice")].concat(M),L=d.$r(X),v=X,B=[P=J(X[0],null,"Randomizer")].concat(v),te=d.$r(B),(D=P.$$prototype).rand_results=D.detailed_rand_results=z,_(B[0],"UPPER_LIMIT_DICE_TIMES",200),_(B[0],"UPPER_LIMIT_DICE_SIDES",1e4),_(B[0],"UPPER_LIMIT_RANDS",1e4),w(P,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]}),P.$attr_reader("rand_results"),P.$attr_reader("detailed_rand_results"),_(B[0],"DetailedRandResult",te("Struct").$new("kind","sides","value")),w(P,"$roll_barabara",function(R,F){var g=this;return O(x(K(g.rand_results.$size(),R),te("UPPER_LIMIT_RANDS")))&&g.$raise(te("TooManyRandsError")),O(V(R,0))||O(x(R,te("UPPER_LIMIT_DICE_TIMES")))?[]:A(te("Array"),"new",[R],function l(){return(l.$$s??this).$roll_once(F)},{$$s:g})}),w(P,"$roll_sum",function(R,F){return this.$roll_barabara(R,F).$sum()}),w(P,"$roll_once",function(R){var g=z;return O(V(R,0))||O(x(R,te("UPPER_LIMIT_DICE_SIDES")))?0:(g=this.$rand_inner(R),this.$push_to_detail("normal",R,g),g)}),w(P,"$roll_index",function(R){return U(this.$roll_once(R),1)}),w(P,"$roll_tens_d10",function(){var g,F=z;return F=this.$rand_inner(10),N(F,10)&&(F=0),g=Y(F,10),this.$push_to_detail("tens_d10",10,g),g}),w(P,"$roll_d9",function(){var F;return F=U(this.$rand_inner(10),1),this.$push_to_detail("d9",10,F),F}),w(P,"$roll_d66",function(R){var l,g=z;return g=A(te("Array"),"new",[2],function c(){return(c.$$s??this).$roll_once(6)},{$$s:this}),T(q(te("D66SortType"),"ASC"),l=R)?g["$sort!"]():T(q(te("D66SortType"),"DESC"),l)&&g["$sort!"]()["$reverse!"](),K(Y(g["$[]"](0),10),g["$[]"](1))}),P.$private(),w(P,"$rand_inner",function(R){var g,F=this;return O(j(F.rand_results.$size(),te("UPPER_LIMIT_RANDS")))&&F.$raise(te("TooManyRandsError")),g=F.$random(R),F.rand_results["$<<"]([g,R]),g}),w(P,"$random",function(R){return K(te("Kernel").$rand(R),1)}),w(P,"$push_to_detail",function(R,F,g){var c;return c=te("DetailedRandResult").$new(R,F,g),this.detailed_rand_results.$push(c)}),J(X[0],L("StandardError"),"TooManyRandsError"),z},Opal.modules["bcdice/dice_table/roll_result"]=function(d){var A,T,Z,M,I,X,L,re,N,H=d.module,J=d.klass,_=d.def,w=d.truthy,O=d.return_val,x=[],K=d.nil;return A=x,T=N=[H(x[0],"BCDice")].concat(A),Z=re=[H(N[0],"DiceTable")].concat(T),I=[M=J(re[0],null,"RollResult")].concat(Z),X=d.$r(I),(L=M.$$prototype).table_name=L.value=L.body=K,_(M,"$initialize",function(k,v,P){var B=this;return B.table_name=k,B.value=v,B.body=P}),M.$attr_reader("table_name"),M.$attr_reader("value"),M.$attr_reader("body"),_(M,"$to_s",function(){var k=this;return k.table_name+"("+k.value+") \uff1e "+k.body}),_(M,"$last_body",function(){var k=this;return w(k.body["$is_a?"](X("RollResult")))?k.body.$last_body():k.body}),_(M,"$empty?",O(!1))},Opal.modules["bcdice/dice_table/chain_table"]=function(d){var A,T,Z,M,I,X,L,re,N,H=d.module,J=d.klass,_=d.truthy,w=d.def,O=d.rb_minus,x=[],K=d.nil;return A=x,T=N=[H(x[0],"BCDice")].concat(A),Z=re=[H(N[0],"DiceTable")].concat(T),I=[M=J(re[0],null,"ChainTable")].concat(Z),X=d.$r(I),(L=M.$$prototype).times=L.sides=L.items=L.name=K,w(M,"$initialize",function(k,v,P){var B=this,te=K;return B.name=k,B.items=P.$freeze(),te=/(\d+)D(\d+)/i.$match(v),_(te)||B.$raise(X("ArgumentError"),"Unexpected table type: "+v),B.times=te["$[]"](1).$to_i(),B.sides=te["$[]"](2).$to_i()}),w(M,"$roll",function(k){var P,B,v=this,te=K;return P=k.$roll_sum(v.times,v.sides),B=O(P,v.times),te=v.items["$[]"](B),_(te["$respond_to?"]("roll"))&&(te=te.$roll(k)),X("RollResult").$new(v.name,P,te)})},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(d){var Y,z,X,L,S,k,v,Z,j,H=d.module,J=d.klass,_=d.hash2,w=d.defs,O=d.def,x=d.rb_plus,K=d.rb_times,V=d.rb_minus,A=[],U=d.nil;return Y=A,z=j=[H(A[0],"BCDice")].concat(Y),X=Z=[H(j[0],"DiceTable")].concat(z),S=[L=J(Z[0],null,"D66GridTable")].concat(X),k=d.$r(S),(v=L.$$prototype).name=v.items=U,w(L,"$from_i18n",function(B,te){var fe=U;return fe=k("I18n").$t(B,_(["locale","raise"],{locale:te,raise:!0})),this.$new(fe["$[]"]("name"),fe["$[]"]("items"))}),O(L,"$initialize",function(B,te){return this.name=B,this.items=te.$freeze()}),O(L,"$roll",function(B){var D,fe,R,F,g;return D=B.$roll_once(6),fe=B.$roll_once(6),R=x(K(D,10),fe),F=V(D,1),g=V(fe,1),k("RollResult").$new(this.name,R,this.items["$[]"](F)["$[]"](g))})},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(d){var U,j,I,X,L,S,z,q,Y,H=d.module,J=d.klass,_=d.hash2,w=d.defs,O=d.def,K=[],V=d.nil;return d.top.$require("bcdice/dice_table/d66_grid_table"),U=K,j=Y=[H(K[0],"BCDice")].concat(U),z=[H(Y[0],"DiceTable")].concat(j),q=d.$r(z),I=z,L=[X=J(z[0],q("D66GridTable"),"D66HalfGridTable")].concat(I),S=d.$r(L),w(X,"$from_i18n",function(v,P){var te=V;return te=S("I18n").$t(v,_(["locale","raise"],{locale:P,raise:!0})),this.$new(te["$[]"]("name"),te["$[]"]("items_1_2_3"),te["$[]"]("items_4_5_6"))}),O(X,"$initialize",function(v,P,B){return this.name=v,this.items=[P,P,P,B,B,B].$freeze()})},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(d){var U,j,I,X,L,S,z,q,Y,H=d.module,J=d.klass,_=d.hash2,w=d.defs,O=d.def,K=[],V=d.nil;return d.top.$require("bcdice/dice_table/d66_grid_table"),U=K,j=Y=[H(K[0],"BCDice")].concat(U),z=[H(Y[0],"DiceTable")].concat(j),q=d.$r(z),I=z,L=[X=J(z[0],q("D66GridTable"),"D66OneThirdTable")].concat(I),S=d.$r(L),w(X,"$from_i18n",function(v,P){var te=V;return te=S("I18n").$t(v,_(["locale","raise"],{locale:P,raise:!0})),this.$new(te["$[]"]("name"),te["$[]"]("items_1_2"),te["$[]"]("items_3_4"),te["$[]"]("items_5_6"))}),O(X,"$initialize",function(v,P,B,te){return this.name=v,this.items=[P,P,B,B,te,te].$freeze()})},Opal.modules["bcdice/dice_table/d66_table"]=function(d){var j,Z,S,k,v,P,B,I,z,H=d.module,J=d.klass,_=d.hash2,w=d.defs,O=d.def,x=d.eqeqeq,K=d.rb_plus,V=d.rb_times,A=d.truthy,U=[],N=d.nil,Y=d.$$$;return j=U,Z=z=[H(U[0],"BCDice")].concat(j),S=I=[H(z[0],"DiceTable")].concat(Z),v=[k=J(I[0],null,"D66Table")].concat(S),P=d.$r(v),(B=k.$$prototype).sort_type=B.items=B.name=N,w(k,"$from_i18n",function(D,fe){var g,F=N;return F=P("I18n").$t(D,_(["locale"],{locale:fe})),g=P("D66SortType").$const_get(F["$[]"]("d66_sort_type")),this.$new(F["$[]"]("name"),g,F["$[]"]("items"))}),O(k,"$initialize",function(D,fe,R){var F=this;return F.name=D,F.sort_type=fe,F.items=R.$freeze()}),O(k,"$roll",function(D){var R=N,F=N,g=N,l=N;return R=D.$roll_barabara(2,6),x(Y(P("D66SortType"),"ASC"),F=this.sort_type)?R["$sort!"]():x(Y(P("D66SortType"),"DESC"),F)&&R["$sort!"]()["$reverse!"](),g=K(V(R["$[]"](0),10),R["$[]"](1)),l=A(F=this.items["$[]"](g))?F:this.items["$[]"](g.$to_s()),A(l["$respond_to?"]("roll"))&&(l=l.$roll(D)),P("RollResult").$new(this.name,g,l)}),O(k,"$choice",function(D){return P("RollResult").$new(this.name,D,this.items["$[]"](D))})},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(d){var re,M,X,L,q,H=d.module,J=d.klass,_=d.hash2,w=d.send,O=d.to_ary,x=d.rb_plus,K=d.rb_times,V=d.send2,A=d.find_super,U=d.def,Y=[],T=d.nil;return d.top.$require("bcdice/dice_table/d66_table"),re=Y,M=q=[H(Y[0],"BCDice")].concat(re),X=[H(q[0],"DiceTable")].concat(M),L=d.$r(X),U(J(X[0],L("D66Table"),"D66LeftRangeTable"),"$initialize",function P(B,te,D){var F;return P.$$p=null,F=_([],{}),w(D,"each",[],function(l){var c,p;return null==l&&(l=T),c=O(l),p=c[1]??T,w(c[0]??T,"each",[],function(C){return null==C&&(C=T),w(p,"each_with_index",[],function(ie,se){var Ee,Ie;return null==ie&&(ie=T),null==se&&(se=T),Ie=x(K(C,10),x(se,1)),w(F,"[]=",Ee=[Ie,ie]),Ee[Ee.length-1]})})}),V(this,A(this,"initialize",P,!1,!0),"initialize",[B,te,F],null)})},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(d){var T,q,L,S,k,v,P,M,re,H=d.module,J=d.klass,_=d.hash2,w=d.defs,O=d.def,x=d.truthy,K=d.rb_minus,V=d.rb_plus,A=d.rb_times,U=[],N=d.nil;return T=U,q=re=[H(U[0],"BCDice")].concat(T),L=M=[H(re[0],"DiceTable")].concat(q),k=[S=J(M[0],null,"D66ParityTable")].concat(L),v=d.$r(k),(P=S.$$prototype).odd=P.even=P.name=N,w(S,"$from_i18n",function(te,D){var R=N;return R=v("I18n").$t(te,_(["locale","raise"],{locale:D,raise:!0})),this.$new(R["$[]"]("name"),R["$[]"]("odd"),R["$[]"]("even"))}),O(S,"$initialize",function(te,D,fe){var R=this;return R.name=te,R.odd=D.$freeze(),R.even=fe.$freeze()}),O(S,"$roll",function(te){var R,g,l,D=this,fe=N;return fe=te.$roll_once(6),R=te.$roll_once(6),g=(x(fe["$odd?"]())?D.odd:D.even)["$[]"](K(R,1)),l=V(A(fe,10),R),v("RollResult").$new(D.name,l,g)})},Opal.modules["bcdice/dice_table/d66_range_table"]=function(d){var U,j,M,I,X,L,S,z,Y,H=d.module,J=d.klass,_=d.def,w=d.rb_plus,O=d.rb_times,x=d.send,K=[],V=d.nil;return U=K,j=Y=[H(K[0],"BCDice")].concat(U),M=z=[H(Y[0],"DiceTable")].concat(j),X=[I=J(z[0],null,"D66RangeTable")].concat(M),L=d.$r(X),(S=I.$$prototype).items=S.name=V,_(I,"$initialize",function(v,P){return this.name=v,this.items=P.$freeze()}),_(I,"$roll",function(v){var B,te,D,fe=V;return B=v.$roll_once(6),te=v.$roll_once(6),D=w(O(B,10),te),fe=x(this.items,"find",[],function(F){return null==F&&(F=V),F["$[]"](0)["$include?"](D)}),L("RollResult").$new(this.name,D,fe["$[]"](1))})},Opal.modules["bcdice/dice_table/range_table"]=function(d){var T,q,L,S,k,v,P,M,re,H=d.module,J=d.klass,_=d.const_set,w=d.send,O=d.truthy,x=d.def,K=d.eqeqeq,V=d.rb_times,A=d.rb_plus,U=[],N=d.nil;return T=U,q=re=[H(U[0],"BCDice")].concat(T),L=M=[H(re[0],"DiceTable")].concat(q),k=[S=J(M[0],null,"RangeTable")].concat(L),v=d.$r(k),(P=S.$$prototype).name=P.items=P.num_of_dice=P.num_of_sides=P.formatter=N,_(k[0],"RollResult",w(v("Struct"),"new",["sum","values","content","formatted"],function B(){return(B.$$s??this).$alias_method("to_s","formatted")},{$$s:S})),_(k[0],"Item",v("Struct").$new("range","content")),_(k[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),_(k[0],"DEFAULT_FORMATTER",w(S,"lambda",[],function(te,D){return null==te&&(te=N),null==D&&(D=N),te.$name()+"("+D.$sum()+") \uff1e "+D.$content()})),S.$attr_reader("name"),S.$attr_reader("num_of_dice"),S.$attr_reader("num_of_sides"),x(S,"$initialize",function B(te,D,fe){var g,R=B.$$p||N,F=this,l=N;return B.$$p=null,F.name=te.$freeze(),F.formatter=O(g=R)?g:v("DEFAULT_FORMATTER"),l=v("DICE_ROLL_METHOD_RE").$match(D),O(l)||F.$raise(v("ArgumentError"),F.name+": invalid dice roll method: "+D),F.num_of_dice=l["$[]"](1).$to_i(),F.num_of_sides=l["$[]"](2).$to_i(),F.$store(fe)}),x(S,"$fetch",function(te){var fe,D=this;return fe=w(D.items,"find",[],function(F){return null==F&&(F=N),F.$range()["$include?"](te)}),O(fe)||D.$raise(v("RangeError"),D.name+": value is out of range: "+te),fe}),x(S,"$roll",function(te){var R,D=this,fe=N,F=N;return R=(fe=te.$roll_barabara(D.num_of_dice,D.num_of_sides)).$sum(),(F=v("RollResult").$new(R,fe,D.$fetch(R).$content()))["$formatted="](D.formatter["$[]"](D,F)),F}),S.$private(),x(S,"$store",function(te){var fe,R,D=this;return fe=w(te,"map",[],function F(g,l){return null==g&&(g=N),null==l&&(l=N),[(F.$$s??this).$coerce_to_int_range(g),l]},{$$s:D}),R=w(fe,"sort_by",[],function(g,l){return null==g&&(g=N),null==l&&(l=N),g.$min()}),D.$assert_min_sum_is_covered(R),D.$assert_max_sum_is_covered(R),D.$assert_no_gap_or_overlap_in_ranges(R),D.items=w(R,"map",[],function(g,l){return null==g&&(g=N),null==l&&(l=N),v("Item").$new(g,l.$freeze()).$freeze()}).$freeze(),D}),x(S,"$coerce_to_int_range",function(te){var fe;return K(v("Integer"),fe=te)?v("Range").$new(te,te):K(v("Range"),fe)&&O(te.$begin()["$is_a?"](v("Integer")))&&O(te.$end()["$is_a?"](v("Integer")))?te:this.$raise(v("TypeError"),this.name+": "+te+" ("+te.$class()+") must be an Integer or a Range with Integers ")}),x(S,"$assert_min_sum_is_covered",function(te){var fe,D=this,R=N;return fe=D.num_of_dice,R=te.$first()["$[]"](0),O(R["$include?"](fe))||D.$raise(v("RangeError"),D.name+": min value ("+fe+") is not covered: "+R),D}),x(S,"$assert_max_sum_is_covered",function(te){var fe,D=this,R=N;return fe=V(D.num_of_dice,D.num_of_sides),R=te.$last()["$[]"](0),O(R["$include?"](fe))||D.$raise(v("RangeError"),D.name+": max value ("+fe+") is not covered: "+R),D}),x(S,"$assert_no_gap_or_overlap_in_ranges",function(te){return w(te,"each_cons",[2],function fe(R,F){var f,u,g=fe.$$s??this,l=N,c=N;return null==g.name&&(g.name=N),null==R&&(R=N),null==F&&(F=N),l=R["$[]"](0),c=F["$[]"](0),f=l.$max(),u=A(f,1),O(c["$include?"](f))&&g.$raise(v("RangeError"),g.name+": Range overlap: "+l+" and "+c),O(c["$include?"](u))?N:g.$raise(v("RangeError"),g.name+": Range gap: "+l+" and "+c)},{$$s:this}),this})},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(d){var N,re,I,v,P,B,te,L,q,T,H=d.module,J=d.klass,_=d.send,w=d.def,O=d.rb_minus,x=d.return_ivar,K=[],V=d.nil,A=d.$$$;return N=K,re=T=[H(K[0],"BCDice")].concat(N),I=q=[H(T[0],"DiceTable")].concat(re),v=L=[J(q[0],null,"SaiFicSkillTable")].concat(I),B=[P=J(L[0],null,"Category")].concat(v),te=d.$r(B),w(P,"$initialize",function(fe,R,F,g){var l=this;return l.name=fe,l.skills=_(R.$map(),"with_index",[2],function(f,u){return null==f&&(f=V),null==u&&(u=V),A(te("SaiFicSkillTable"),"Skill").$new(fe,f,F,u,g)}),l.dice=F}),w(P,"$roll",function(fe){return this.$skills()["$[]"](O(fe.$roll_sum(2,6),2))}),w(P,"$to_s",x("name")),P.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(d){var V,Y,q,L,S,M,j,U,H=d.module,J=d.klass,_=d.def,w=d.hash2,O=[],x=d.nil;return V=O,Y=U=[H(O[0],"BCDice")].concat(V),q=j=[H(U[0],"DiceTable")].concat(Y),M=[J(j[0],null,"SaiFicSkillTable")].concat(q),(S=(L=J(M[0],null,"Skill")).$$prototype).s_format=S.category_dice=S.row_dice=S.category_name=S.name=x,_(L,"$initialize",function(v,P,B,te,D){var fe=this;return fe.category_name=v,fe.name=P,fe.category_dice=B,fe.row_dice=te,fe.s_format=D}),_(L,"$to_s",function(){var v=this;return v.$format(v.s_format,w(["category_dice","row_dice","category_name","skill_name"],{category_dice:v.category_dice,row_dice:v.row_dice,category_name:v.category_name,skill_name:v.name}))}),L.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(d){var M,S,te,D,fe,R,F,v,X,H=d.module,J=d.klass,_=d.ensure_kwargs,w=d.hash2,O=d.send,K=d.defs,V=d.const_set,A=d.to_ary,U=d.def,N=d.truthy,Y=d.rb_minus,T=d.rb_plus,j=d.top,re=[],z=d.nil,q=d.$$$;return j.$require("bcdice/dice_table/sai_fic_skill_table/category"),j.$require("bcdice/dice_table/sai_fic_skill_table/skill"),M=re,S=X=[H(re[0],"BCDice")].concat(M),te=v=[H(X[0],"DiceTable")].concat(S),fe=[D=J(v[0],null,"SaiFicSkillTable")].concat(te),R=d.$r(fe),(F=D.$$prototype).rtt=F.rtt_format=F.rct=F.rct_format=F.rttn=F.rttn_format=F.categories=z,K(D,"$from_i18n",function(l,c,f){var u,p,m,se,ie=z;return null==(u=(f=_(f)).$$smap.rtt)&&(u=z),null==(p=f.$$smap.rct)&&(p=z),null==(m=f.$$smap.rttn)&&(m=z),se=(ie=R("I18n").$t("RTT",w(["locale","raise","default"],{locale:c,raise:!1,default:w([],{})})).$merge(R("I18n").$t(l,w(["locale","raise"],{locale:c,raise:!0}))))["$[]"]("items"),ie=O(ie,"select",[],function(Ie,ce){return null==Ie&&(Ie=z),null==ce&&(ce=z),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](Ie)}),this.$new(se,d.to_hash(ie).$merge(w(["rtt","rct","rttn"],{rtt:u,rct:p,rttn:m})))},-3),V(fe[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),V(fe[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),V(fe[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),V(fe[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),U(D,"$initialize",function(l,c){var f,u,p,m,C,$,ie,se=this;return null==(f=(c=_(c)).$$smap.rtt)&&(f=z),null==(u=c.$$smap.rct)&&(u=z),null==(p=c.$$smap.rttn)&&(p=z),null==(m=c.$$smap.rtt_format)&&(m=R("DEFAULT_RTT")),null==(C=c.$$smap.rct_format)&&(C=R("DEFAULT_RCT")),null==($=c.$$smap.rttn_format)&&($=R("DEFAULT_RTTN")),null==(ie=c.$$smap.s_format)&&(ie=R("DEFAULT_S")),se.categories=O(l.$map(),"with_index",[1],function(Ie,ce){var Me,ye,he;return null==Ie&&(Ie=z),null==ce&&(ce=z),ye=(Me=A(Ie))[0]??z,he=Me[1]??z,q(R("SaiFicSkillTable"),"Category").$new(ye,he,ce,ie)},{$$has_top_level_mlhs_arg:!0}),se.rtt=f,se.rct=u,se.rttn=p.$to_a(),se.rtt_format=m,se.rct_format=C,se.rttn_format=$},-2),V(fe[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),D.$attr_reader("categories"),U(D,"$roll_command",function(l,c){var u,f=this,p=z,m=z;return N(["RTT",f.rtt]["$include?"](u=c))?f.$format_skill(f.rtt_format,f.$roll_skill(l)):N(["RCT",f.rct]["$include?"](u))?(p=f.$roll_category(l),f.$format(f.rct_format,w(["category_dice","category_name"],{category_dice:p.$dice(),category_name:p.$name()}))):N(m=R("RTTN").$index(u))||N(m=f.rttn.$index(u))?f.$format_skill(f.rttn_format,f.categories["$[]"](m).$roll(l)):z}),U(D,"$roll_category",function(l){return this.categories["$[]"](Y(l.$roll_once(6),1))}),U(D,"$roll_skill",function(l){return this.$roll_category(l).$roll(l)}),U(D,"$prefixes",function(){var l=this;return T(["RTT[1-6]?","RCT",l.rtt,l.rct],l.rttn).$compact()}),D.$private(),U(D,"$format_skill",function(l,c){return this.$format(l,w(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:c.$category_dice(),row_dice:c.$row_dice(),category_name:c.$category_name(),skill_name:c.$name(),text:c.$to_s()}))})},Opal.modules["bcdice/dice_table/table"]=function(d){var N,re,I,X,L,S,k,q,T,H=d.module,J=d.klass,_=d.hash2,w=d.defs,O=d.truthy,x=d.def,K=d.rb_minus,V=[],A=d.nil;return N=V,re=T=[H(V[0],"BCDice")].concat(N),I=q=[H(T[0],"DiceTable")].concat(re),L=[X=J(q[0],null,"Table")].concat(I),S=d.$r(L),(k=X.$$prototype).times=k.sides=k.name=k.items=A,w(X,"$from_i18n",function(P,B){var D=A;return D=S("I18n").$t(P,_(["locale"],{locale:B})),this.$new(D["$[]"]("name"),D["$[]"]("type"),D["$[]"]("items"))}),x(X,"$initialize",function(P,B,te){var D=this,fe=A;return D.name=P,D.items=te.$freeze(),fe=/(\d+)D(\d+)/i.$match(B),O(fe)||D.$raise(S("ArgumentError"),"Unexpected table type: "+B),D.times=fe["$[]"](1).$to_i(),D.sides=fe["$[]"](2).$to_i()}),x(X,"$roll",function(P){var te,B=this;return te=P.$roll_sum(B.times,B.sides),B.$choice(te)}),x(X,"$choice",function(P){var te,B=this;return te=K(P,B.times),S("RollResult").$new(B.name,P,B.items["$[]"](te))})},Opal.modules["bcdice/dice_table"]=function(d){var H=d.top;return H.$require("bcdice/dice_table/roll_result"),H.$require("bcdice/dice_table/chain_table"),H.$require("bcdice/dice_table/d66_grid_table"),H.$require("bcdice/dice_table/d66_half_grid_table"),H.$require("bcdice/dice_table/d66_one_third_table"),H.$require("bcdice/dice_table/d66_left_range_table"),H.$require("bcdice/dice_table/d66_parity_table"),H.$require("bcdice/dice_table/d66_range_table"),H.$require("bcdice/dice_table/d66_table"),H.$require("bcdice/dice_table/range_table"),H.$require("bcdice/dice_table/sai_fic_skill_table"),H.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(d){var x,U,Y,V,H=d.module,J=d.const_set,_=[];return x=_,U=V=[H(_[0],"BCDice")].concat(x),Y=[H(V[0],"D66SortType")].concat(U),J(Y[0],"NO_SORT","no_sort"),J(Y[0],"ASC","asc"),J(Y[0],"DESC","desc"),function(A,U){var Y=[H(A,"RoundType")].concat(U);return J(Y[0],"CEIL","ceil"),J(Y[0],"FLOOR","floor"),J(Y[0],"ROUND","round")}(V[0],V)},Opal.modules["bcdice/translate"]=function(d){var U,j,re,z,q,Y,H=d.module,J=d.ensure_kwargs,_=d.kwrestargs,O=d.hash2,x=d.def,K=[],V=d.nil;return U=K,j=Y=[H(K[0],"BCDice")].concat(U),z=[re=H(Y[0],"Translate")].concat(j),q=d.$r(z),x(re,"$translate",function(M,I){var X,L=this;return null==L.locale&&(L.locale=V),I=J(I),X=_(I,{}),q("I18n").$translate(M,O(["locale","raise"],{locale:L.locale,raise:!0}).$merge(d.to_hash(X)))},-2)},Opal.modules["bcdice/result"]=function(d){var re,Z,z,U,Y,J=d.klass,_=d.send,w=d.def,O=d.return_val,x=d.return_ivar,K=[],V=d.nil;return U=K,re=Y=[(0,d.module)(K[0],"BCDice")].concat(U),[z=J(Y[0],null,"Result")].concat(re),w(Z=d.get_singleton_class(z),"$success",function(X){return _(this.$new(),"tap",[],function(k){var v;return null==k&&(k=V),k["$text="](X),_(k,"success=",v=[!0]),v[v.length-1]})}),w(Z,"$failure",function(X){return _(this.$new(),"tap",[],function(k){var v;return null==k&&(k=V),k["$text="](X),_(k,"failure=",v=[!0]),v[v.length-1]})}),w(Z,"$critical",function(X){return _(this.$new(),"tap",[],function(k){var v;return null==k&&(k=V),k["$text="](X),k["$critical="](!0),_(k,"success=",v=[!0]),v[v.length-1]})}),w(Z,"$fumble",function(X){return _(this.$new(),"tap",[],function(k){var v;return null==k&&(k=V),k["$text="](X),k["$fumble="](!0),_(k,"failure=",v=[!0]),v[v.length-1]})}),w(Z,"$nothing",O("nothing")),w(z,"$initialize",function(M){var I=this;return null==M&&(M=V),I.text=M,I.rands=V,I.detailed_rands=V,I.secret=!1,I.success=!1,I.failure=!1,I.critical=!1,I.fumble=!1},-1),z.$attr_accessor("text","rands","detailed_rands"),z.$attr_writer("secret","success","failure","critical","fumble"),w(z,"$secret?",x("secret")),w(z,"$success?",x("success")),w(z,"$failure?",x("failure")),w(z,"$critical?",x("critical")),w(z,"$fumble?",x("fumble")),w(z,"$condition=",function(M){return this.success=M,this.failure=M["$!"]()})},Opal.modules["racc/parser"]=function(d){var P,te,D,H=d.module,J=d.klass,_=d.truthy,w=d.const_set,O=d.defs,x=d.gvars,K=d.rb_lt,V=d.def,A=d.to_ary,U=d.send,N=d.neqeq,Y=d.rb_plus,T=d.eqeq,j=d.rb_ge,re=d.rb_gt,z=d.rb_minus,q=d.rb_le,Z=d.rb_times,M=d.assign_ivar_val,X=[],L=d.$r(X),S=d.nil,k=d.$$$;return P=X,te=[H(X[0],"Racc")].concat(P),D=d.$r(te),J(te[0],D("StandardError"),"ParseError"),_(k("::","ParseError","skip_raise")?"constant":S)||w(X[0],"ParseError",k(L("Racc"),"ParseError")),function(v,P){var g,l,c,f,u,D=[H(v,"Racc")].concat(P),fe=d.$r(D);return _(fe("Racc_No_Extensions","skip_raise")?"constant":S)||w(D[0],"Racc_No_Extensions",!1),g=D,c=[l=J(D[0],null,"Parser")].concat(g),f=d.$r(c),(u=l.$$prototype).yydebug=u.racc_debug_out=u.racc_error_status=u.racc_t=u.racc_vstack=u.racc_val=u.racc_state=u.racc_tstack=S,w(c[0],"Racc_Runtime_Version","1.4.6"),w(c[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),w(c[0],"Racc_Runtime_Core_Version_R","1.4.6"),w(c[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),w(c[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),w(c[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),w(c[0],"Racc_Runtime_Core_Version",f("Racc_Runtime_Core_Version_R")),w(c[0],"Racc_Runtime_Core_Revision",f("Racc_Runtime_Core_Revision_R")),w(c[0],"Racc_Runtime_Type","ruby"),O(f("Parser"),"$racc_runtime_type",function(){return f("Racc_Runtime_Type")}),V(l,"$_racc_setup",function(){var m,C,$=this,ie=S,se=S;return null==x.stderr&&(x.stderr=S),_(k($.$class(),"Racc_debug_parser"))||($.yydebug=!1),_(null!=(m=$.yydebug)&&m!==S?"instance-variable":S)||($.yydebug=!1),_($.yydebug)&&(_(null!=(C=$.racc_debug_out)&&C!==S?"instance-variable":S)||($.racc_debug_out=x.stderr),$.racc_debug_out=_(ie=$.racc_debug_out)?ie:x.stderr),se=k($.$class(),"Racc_arg"),_(K(se.$size(),14))&&se["$[]="](13,!0),se}),V(l,"$_racc_init_sysvars",function(){var m=this;return m.racc_state=[0],m.racc_tstack=[],m.racc_vstack=[],m.racc_t=S,m.racc_val=S,m.racc_read_next=!0,m.racc_user_yyerror=!1,m.racc_error_status=0}),V(l,"$do_parse",function(){return this.$__send__(f("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),V(l,"$next_token",function(){return this.$raise(f("NotImplementedError"),this.$class()+"#next_token is not defined")}),V(l,"$_racc_do_parse_rb",function(m,C){var $,Ee=S,Ie=S,ce=S,Me=S,ye=S,he=S,Se=S,be=S;return $=A(m),Ee=$[0]??S,Ie=$[1]??S,ce=$[2]??S,Me=$[3]??S,ye=$[10]??S,this.$_racc_init_sysvars(),he=Se=be=S,U(this,"catch",["racc_end_parse"],function ae(){var ue,Ce,y=ae.$$s??this,W=S;for(null==y.racc_state&&(y.racc_state=S),null==y.racc_read_next&&(y.racc_read_next=S),null==y.racc_t&&(y.racc_t=S),null==y.yydebug&&(y.yydebug=S),null==y.racc_val&&(y.racc_val=S);_(!0);)for(_(be=Me["$[]"](y.racc_state["$[]"](-1)))?(_(y.racc_read_next)&&N(y.racc_t,0)&&(Ce=y.$next_token(),ue=A(Ce),he=ue[0]??S,y.racc_val=ue[1]??S,y.racc_t=_(he)?_(W=ye["$[]"](he))?W:1:0,_(y.yydebug)&&y.$racc_read_token(y.racc_t,he,y.racc_val),y.racc_read_next=!1),be=Y(be,y.racc_t),_(j(be,0))&&_(Se=Ee["$[]"](be))&&T(Ie["$[]"](be),y.racc_state["$[]"](-1))||(Se=ce["$[]"](y.racc_state["$[]"](-1)))):Se=ce["$[]"](y.racc_state["$[]"](-1));_(Se=y.$_racc_evalact(Se,m)););},{$$s:this})}),V(l,"$yyparse",function(m,C){return this.$__send__(f("Racc_YY_Parse_Method"),m,C,this.$_racc_setup(),!0)}),V(l,"$_racc_yyparse_rb",function(m,C,$,ie){var se,ce=S,Me=S,$e=S,ye=S,Se=S,be=S,ae=S;return se=A($),ce=se[0]??S,Me=se[1]??S,$e=se[2]??S,ye=se[3]??S,Se=se[10]??S,this.$_racc_init_sysvars(),be=S,ae=S,U(this,"catch",["racc_end_parse"],function ue(){var Ce=ue.$$s??this;for(null==Ce.racc_state&&(Ce.racc_state=S);!_(ae=ye["$[]"](Ce.racc_state["$[]"](-1)));)for(;_(be=Ce.$_racc_evalact($e["$[]"](Ce.racc_state["$[]"](-1)),$)););return U(m,"__send__",[C],function y(W,pe){var we=y.$$s??this,De=S,Fe=S;for(null==we.racc_t&&(we.racc_t=S),null==we.racc_state&&(we.racc_state=S),null==we.racc_read_next&&(we.racc_read_next=S),null==W&&(W=S),null==pe&&(pe=S),we.racc_t=_(W)?_(De=Se["$[]"](W))?De:1:0,we.racc_val=pe,we.racc_read_next=!1,ae=Y(ae,we.racc_t),_(j(ae,0))&&_(be=ce["$[]"](ae))&&T(Me["$[]"](ae),we.racc_state["$[]"](-1))||(be=$e["$[]"](we.racc_state["$[]"](-1)));_(be=we.$_racc_evalact(be,$)););for(;_(_(De=_(Fe=(ae=ye["$[]"](we.racc_state["$[]"](-1)))["$!"]())?Fe:we.racc_read_next["$!"]())?De:we.racc_t["$=="](0));)for(_(ae)&&_(ae=Y(ae,we.racc_t))&&_(j(ae,0))&&_(be=ce["$[]"](ae))&&T(Me["$[]"](ae),we.racc_state["$[]"](-1))||(be=$e["$[]"](we.racc_state["$[]"](-1)));_(be=we.$_racc_evalact(be,$)););},{$$s:Ce})},{$$s:this})}),V(l,"$_racc_evalact",function(m,C){var $,$e,se=this,Ee=S,Ie=S,Me=S,ye=S,he=S,Se=S;if(Ee=($=A(C))[0]??S,Ie=$[1]??S,Me=$[3]??S,$e=$[11]??S,ye=$[12]??S,_(re(m,0))&&_(K(m,$e)))_(re(se.racc_error_status,0))&&(T(se.racc_t,1)||(se.racc_error_status=z(se.racc_error_status,1))),se.racc_vstack.$push(se.racc_val),se.racc_state.$push(m),se.racc_read_next=!0,_(se.yydebug)&&(se.racc_tstack.$push(se.racc_t),se.$racc_shift(se.racc_t,se.racc_tstack,se.racc_vstack));else if(_(K(m,0))&&_(re(m,ye["$-@"]()))){if(he=U(se,"catch",["racc_jump"],function be(){var ae=be.$$s??this;return null==ae.racc_state&&(ae.racc_state=S),ae.racc_state.$push(ae.$_racc_do_reduce(C,m)),!1},{$$s:se}),_(he))switch(he){case 1:return se.racc_user_yyerror=!0,ye["$-@"]();case 2:return $e;default:se.$raise("[Racc Bug] unknown jump code")}}else if(T(m,$e))_(se.yydebug)&&se.$racc_accept(),se.$throw("racc_end_parse",se.racc_vstack["$[]"](0));else{if(T(m,ye["$-@"]())){switch(se.racc_error_status){case 0:_(C["$[]"](21))||se.$on_error(se.racc_t,se.racc_val,se.racc_vstack);break;case 3:T(se.racc_t,0)&&se.$throw("racc_end_parse",S),se.racc_read_next=!0}for(se.racc_user_yyerror=!1,se.racc_error_status=3;_(!0)&&!(_(Se=Me["$[]"](se.racc_state["$[]"](-1)))&&(Se=Y(Se,1),_(j(Se,0))&&_(m=Ee["$[]"](Se))&&T(Ie["$[]"](Se),se.racc_state["$[]"](-1))));)_(q(se.racc_state.$size(),1))&&se.$throw("racc_end_parse",S),se.racc_state.$pop(),se.racc_vstack.$pop(),_(se.yydebug)&&(se.racc_tstack.$pop(),se.$racc_e_pop(se.racc_state,se.racc_tstack,se.racc_vstack));return m}se.$raise("[Racc Bug] unknown action "+m.$inspect())}return _(se.yydebug)&&se.$racc_next_state(se.racc_state["$[]"](-1),se.racc_state),S}),V(l,"$_racc_do_reduce",function(m,C){var $,ye,Se,W,pe,we,Ye,se=this,Ie=S,ce=S,Me=S,$e=S,he=S,be=S,ae=S,ue=S,Ce=S,y=S,De=S,Fe=S,at=S;return Ie=($=A(m))[4]??S,ce=$[5]??S,Me=$[6]??S,$e=$[7]??S,ye=$[8]??S,he=$[9]??S,Se=$[13]??S,be=se.racc_state,ae=se.racc_vstack,ue=se.racc_tstack,Ce=Z(C,-3),y=he["$[]"](Ce),W=he["$[]"](Y(Ce,1)),pe=he["$[]"](Y(Ce,2)),we=[],_(se.yydebug)&&(De=ue["$[]"](y["$-@"](),y)),Fe=ae["$[]"](y["$-@"](),y),_(se.yydebug)&&ue["$[]="](y["$-@"](),y,we),ae["$[]="](y["$-@"](),y,we),be["$[]="](y["$-@"](),y,we),_(Se)?ae.$push(se.$__send__(pe,Fe,ae,Fe["$[]"](0))):ae.$push(se.$__send__(pe,Fe,ae)),ue.$push(W),_(se.yydebug)&&se.$racc_reduce(De,W,ue,ae),Ye=z(W,ye),_(Ce=$e["$[]"](Ye))&&(Ce=Y(Ce,be["$[]"](-1)),_(j(Ce,0))&&_(at=Ie["$[]"](Ce))&&T(ce["$[]"](Ce),Ye))?at:Me["$[]"](Ye)}),V(l,"$on_error",function(m,C,$){var se;return this.$raise(f("ParseError"),this.$sprintf("\nparse error on value %s (%s)",C.$inspect(),_(se=this.$token_to_str(m))?se:"?"))}),V(l,"$yyerror",function(){return this.$throw("racc_jump",1)}),V(l,"$yyaccept",function(){return this.$throw("racc_jump",2)}),V(l,"$yyerrok",M("racc_error_status",0)),V(l,"$racc_read_token",function(m,C,$){var ie=this;return ie.racc_debug_out.$print("read    "),ie.racc_debug_out.$print(C.$inspect(),"(",ie.$racc_token2str(m),") "),ie.racc_debug_out.$puts($.$inspect()),ie.racc_debug_out.$puts()}),V(l,"$racc_shift",function(m,C,$){return this.racc_debug_out.$puts("shift   "+this.$racc_token2str(m)),this.$racc_print_stacks(C,$),this.racc_debug_out.$puts()}),V(l,"$racc_reduce",function(m,C,$,ie){var se=this,Ee=S;return(Ee=se.racc_debug_out).$print("reduce "),_(m["$empty?"]())?Ee.$print(" <none>"):U(m,"each",[],function Ie(ce){return null==ce&&(ce=S),Ee.$print(" ",(Ie.$$s??this).$racc_token2str(ce))},{$$s:se}),Ee.$puts(" --\x3e "+se.$racc_token2str(C)),se.$racc_print_stacks($,ie),se.racc_debug_out.$puts()}),V(l,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),V(l,"$racc_e_pop",function(m,C,$){return this.racc_debug_out.$puts("error recovering mode: pop token"),this.$racc_print_states(m),this.$racc_print_stacks(C,$),this.racc_debug_out.$puts()}),V(l,"$racc_next_state",function(m,C){var $=this;return $.racc_debug_out.$puts("goto    "+m),$.$racc_print_states(C),$.racc_debug_out.$puts()}),V(l,"$racc_print_stacks",function(m,C){var ie=S;return(ie=this.racc_debug_out).$print("        ["),U(m,"each_index",[],function se(Ee){return null==Ee&&(Ee=S),ie.$print(" (",(se.$$s??this).$racc_token2str(m["$[]"](Ee))," ",C["$[]"](Ee).$inspect(),")")},{$$s:this}),ie.$puts(" ]")}),V(l,"$racc_print_states",function(m){var $=S;return($=this.racc_debug_out).$print("        ["),U(m,"each",[],function(se){return null==se&&(se=S),$.$print(" ",se)}),$.$puts(" ]")}),V(l,"$racc_token2str",function(m){var $;return _($=k(this.$class(),"Racc_token_to_s_table")["$[]"](m))?$:this.$raise("[Racc Bug] can't convert token "+m+" to string")}),V(l,"$token_to_str",function(m){return k(this.$class(),"Racc_token_to_s_table")["$[]"](m)})}(X[0],X)},Opal.modules["bcdice/arithmetic/node"]=function(d){var M,S,B,g,l,D,fe,v,X,H=d.module,J=d.klass,_=d.def,w=d.thrower,O=d.return_ivar,x=d.send2,K=d.find_super,V=d.eqeq,A=d.const_set,U=d.eqeqeq,N=d.rb_divide,Y=d.truthy,T=d.assign_ivar,j=d.alias,re=[],z=d.nil,q=d.$$$;return M=re,S=X=[H(re[0],"BCDice")].concat(M),B=v=[H(X[0],"Arithmetic")].concat(S),D=[H(v[0],"Node")].concat(B),fe=d.$r(D),(l=(g=J(D[0],null,"BinaryOp")).$$prototype).lhs=l.rhs=l.op=z,_(g,"$initialize",function(f,u,p){var m=this;return m.lhs=f,m.op=u,m.rhs=p}),_(g,"$eval",function(f){try{w("eval_return");var C,p=this,m=z;return m=p.lhs.$eval(f),C=p.rhs.$eval(f),m.$send(p.op,C)}catch($){if($===d.t_eval_return)return $.$v;throw $}}),_(g,"$output",function(){var f=this;return""+f.lhs.$output()+f.op+f.rhs.$output()}),_(g,"$s_exp",function(){var f=this;return"("+f.$op_for_s_exp()+" "+f.lhs.$s_exp()+" "+f.rhs.$s_exp()+")"}),_(g,"$op_for_s_exp",O("op")),function(R,F,g){var l=J(R,F,"DivideBase"),c=[l].concat(g),f=d.$r(c),u=l.$$prototype;u.lhs=u.rhs=u.op=z,_(l,"$initialize",function p(m,C){return p.$$p=null,x(this,K(this,"initialize",p,!1,!0),"initialize",[m,"/",C],null)}),_(l,"$eval",function(m){try{w("eval_return");var ie,se,$=this;return ie=$.lhs.$eval(m),se=$.rhs.$eval(m),V(se,0)&&$.$raise(f("ZeroDivisionError")),$.$divide_and_round(ie,se,m)}catch(Ee){if(Ee===d.t_eval_return)return Ee.$v;throw Ee}}),_(l,"$output",function p(){var m=p.$$p||z,C=this;return p.$$p=null,""+x(C,K(C,"output",p,!1,!0),"output",[],m)+C.$rounding_method()}),l.$private(),_(l,"$rounding_method",function(){return q(this.$class(),"ROUNDING_METHOD")}),_(l,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),_(l,"$divide_and_round",function(m,C,$){return this.$raise(f("NotImplementedError"))})}(D[0],fe("BinaryOp"),D),function(R,F,g){var l=J(R,F,"DivideWithGameSystemDefault"),c=[l].concat(g),f=d.$r(c);A(c[0],"ROUNDING_METHOD",""),l.$private(),_(l,"$divide_and_round",function(p,m,C){var $,ie=z;return U(q(f("RoundType"),"CEIL"),$=C)?N(p.$to_f(),m).$ceil():U(q(f("RoundType"),"ROUND"),$)?(ie=N(p.$to_f(),m),Y(ie["$negative?"]())?ie.$abs().$round()["$-@"]():ie.$round()):N(p,m).$floor()})}(D[0],fe("DivideBase"),D),function(R,F,g){var l=J(R,F,"DivideWithCeil"),c=[l].concat(g);A(c[0],"ROUNDING_METHOD","C"),l.$private(),_(l,"$divide_and_round",function(u,p,m){return N(u.$to_f(),p).$ceil()})}(D[0],fe("DivideBase"),D),function(R,F,g){var l=J(R,F,"DivideWithRound"),c=[l].concat(g);A(c[0],"ROUNDING_METHOD","R"),l.$private(),_(l,"$divide_and_round",function(u,p,m){var C=z;return C=N(u.$to_f(),p),Y(C["$negative?"]())?C.$abs().$round()["$-@"]():C.$round()})}(D[0],fe("DivideBase"),D),function(R,F,g){var l=J(R,F,"DivideWithFloor"),c=[l].concat(g);A(c[0],"ROUNDING_METHOD","F"),l.$private(),_(l,"$divide_and_round",function(u,p,m){return N(u,p).$floor()})}(D[0],fe("DivideBase"),D),function(R,F){var g=J(R,null,"Negative");g.$$prototype.body=z,_(g,"$initialize",T("body")),_(g,"$eval",function(f){try{return w("eval_return"),this.body.$eval(f)["$-@"]()}catch(m){if(m===d.t_eval_return)return m.$v;throw m}}),_(g,"$output",function(){return"-"+this.body.$output()}),_(g,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(D[0]),function(R,F){var g=J(R,null,"Parenthesis");g.$$prototype.expr=z,_(g,"$initialize",T("expr")),_(g,"$eval",function(f){try{return w("eval_return"),this.expr.$eval(f)}catch(m){if(m===d.t_eval_return)return m.$v;throw m}}),_(g,"$output",function(){return"("+this.expr.$output()+")"}),_(g,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(D[0]),function(R,F){var g=J(R,null,"Number");return g.$$prototype.value=z,_(g,"$initialize",T("value")),_(g,"$eval",O("value")),_(g,"$output",function(){return this.value.$to_s()}),j(g,"s_exp","output")}(D[0])},Opal.modules.strscan=function(d){var T,j,re,z,q,J=d.def,_=d.truthy,w=d.eqeqeq,O=d.Opal,x=d.return_ivar,K=d.send,V=d.alias,A=[],U=d.nil;return T=A,re=[j=(0,d.klass)(A[0],null,"StringScanner")].concat(T),z=d.$r(re),(q=j.$$prototype).pos=q.string=q.working=q.matched=q.prev_pos=q.match=U,j.$attr_reader("pos","matched"),J(j,"$initialize",function(M){var I=this;return I.string=M,I.pos=0,I.matched=U,I.working=M,I.match=[]}),j.$attr_reader("string"),J(j,"$beginning_of_line?",function(){var M=this;return 0===M.pos||"\n"===M.string.charAt(M.pos-1)}),J(j,"$scan",function(M){var I=this,X=(M=I.$anchor(M)).exec(I.working);return null==X?I.matched=U:(I.prev_pos=I.pos,I.pos+=X[0].length,I.working=I.working.substring(X[0].length),I.matched=X[0],I.match=X,X[0])}),J(j,"$scan_until",function(M){var I=this;M=I.$anchor(M);for(var X=I.working,L=0;X.length!=L;++L){var S=M.exec(X.substr(L));if(null!==S){var k=L+S[0].length,v=X.substr(0,k);return I.matched=S[0],I.match=S,I.prev_pos=I.pos+L,I.pos+=k,I.working=X.substr(k),v}}return I.matched=U}),J(j,"$[]",function(M){var X;if(_(this.match["$empty?"]()))return U;w(z("Symbol"),X=M)?M=M.$to_s():w(z("String"),X)||(M=O["$coerce_to!"](M,z("Integer"),"to_int"));var L=this.match;return M<0&&(M+=L.length),M<0||M>=L.length||null==L[M]?U:L[M]}),J(j,"$check",function(M){var I=this,X=(M=I.$anchor(M)).exec(I.working);return I.matched=null==X?U:X[0]}),J(j,"$check_until",function(M){var I=this,X=I.prev_pos,L=I.pos,S=I.working,k=I.$scan_until(M);return I.prev_pos=X,I.pos=L,I.working=S,k}),J(j,"$peek",function(M){return this.working.substring(0,M)}),J(j,"$eos?",function(){return 0===this.working.length}),J(j,"$exist?",function(M){var X=M.exec(this.working);return null==X?U:0==X.index?0:X.index+1}),J(j,"$skip",function(M){var I=this,X=(M=I.$anchor(M)).exec(I.working);if(null==X)return I.match=[],I.matched=U;var L=X[0],S=L.length;return I.matched=L,I.match=X,I.prev_pos=I.pos,I.pos+=S,I.working=I.working.substring(S),S}),J(j,"$skip_until",function(M){var X=this.$scan_until(M);return X===U?U:(this.matched=X.substr(-1),X.length)}),J(j,"$get_byte",function(){var M=this,I=U;return M.pos<M.string.length?(M.prev_pos=M.pos,M.pos+=1,I=M.matched=M.working.substring(0,1),M.working=M.working.substring(1)):M.matched=U,I}),J(j,"$match?",function(M){var I=this,X=(M=I.$anchor(M)).exec(I.working);return null==X?U:(I.prev_pos=I.pos,X[0].length)}),J(j,"$pos=",function(M){var I=this;return M<0&&(M+=I.string.$length()),I.pos=M,I.working=I.string.slice(M)}),J(j,"$matched_size",function(){return this.matched===U?U:this.matched.length}),J(j,"$post_match",function(){var M=this;return M.matched===U?U:M.string.substr(M.pos)}),J(j,"$pre_match",function(){var M=this;return M.matched===U?U:M.string.substr(0,M.prev_pos)}),J(j,"$reset",function(){var M=this;return M.working=M.string,M.matched=U,M.pos=0}),J(j,"$rest",x("working")),J(j,"$rest?",function(){return 0!==this.working.length}),J(j,"$rest_size",function(){return this.$rest().$size()}),J(j,"$terminate",function(){var M,I=this;return I.match=U,M=[I.string.$length()],K(I,"pos=",M),M[M.length-1]}),J(j,"$unscan",function(){var M=this;return M.pos=M.prev_pos,M.prev_pos=U,M.match=U,M}),V(j,"bol?","beginning_of_line?"),V(j,"getch","get_byte"),j.$private(),J(j,"$anchor",function(M){var I=M.toString().match(/\/([^\/]+)$/);return I=I?I[1]:void 0,new RegExp("^(?:"+M.source+")",I)})},Opal.modules["bcdice/normalize"]=function(d){var V,Y,U,H=d.module,J=d.eqeqeq,_=d.def,w=d.eqeq,O=[],x=d.nil;return V=O,U=[H(O[0],"BCDice")].concat(V),(Y=H(U[0],"Normalize")).$module_function(),_(Y,"$comparison_operator",function(j){var re;return J(/<=|=</,re=j)?"<=":J(/>=|=>/,re)?">=":J(/<>|!=|=!/,re)?"!=":J(/</,re)?"<":J(/>/,re)?">":J(/=/,re)?"==":x}),_(Y,"$target_number",function(j){return w(j,"?")?j:j.$to_i()})},Opal.modules["bcdice/command/lexer"]=function(d){var T,q,L,S,k,v,P,M,re,H=d.module,J=d.klass,_=d.const_set,w=d.hash2,O=d.truthy,x=d.send,K=d.def,V=d.thrower,A=d.top,U=[],N=d.nil;return A.$require("strscan"),A.$require("bcdice/normalize"),T=U,q=re=[H(U[0],"BCDice")].concat(T),L=M=[H(re[0],"Command")].concat(q),k=[S=J(M[0],null,"Lexer")].concat(L),v=d.$r(k),(P=S.$$prototype).scanner=P.notations=N,_(k[0],"SYMBOLS",w(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),K(S,"$initialize",function(te,D){var fe,R,g;return te=O(g=(fe=(R=te)===N||null==R?N:R.$split(" ",2))===N||null==fe?N:fe.$first())?g:"",this.scanner=v("StringScanner").$new(te),this.notations=x(D,"map",[],function(c){return null==c&&(c=N),O(c["$is_a?"](v("String")))?v("Regexp").$new(c):c})}),K(S,"$next_token",function(){try{var te=V("return"),D=this,fe=N,R=N,g=N,l=N;return O(D.scanner["$eos?"]())?[!1,"$"]:(x(D.notations,"each",[],function c(f){var p,u=c.$$s??this;if(null==u.scanner&&(u.scanner=N),null==f&&(f=N),p=u.scanner.$scan(f),!O(p))return N;te.$throw(["NOTATION",p])},{$$s:D,$$ret:te}),O(fe=D.scanner.$scan(/\d+/))?["NUMBER",fe.$to_i()]:O(R=D.scanner.$scan(/[<>!=]+/))?(R=v("Normalize").$comparison_operator(R),[O(R)?"CMP_OP":"ILLEGAL",R]):(g=D.scanner.$getch().$upcase(),[O(l=v("SYMBOLS")["$[]"](g))?l:g.$to_sym(),g]))}catch(c){if(c===te)return c.$v;throw c}}),K(S,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/command/parsed"]=function(d){var A,T,Z,M,I,X,L,re,N,H=d.module,J=d.klass,_=d.def,w=d.return_ivar,O=d.truthy,x=[],K=d.nil;return A=x,T=N=[H(x[0],"BCDice")].concat(A),Z=re=[H(N[0],"Command")].concat(T),I=[M=J(re[0],null,"Parsed")].concat(Z),X=d.$r(I),(L=M.$$prototype).critical=L.fumble=L.dollar=L.modify_number=L.question_target=L.target_number=L.prefix_number=L.command=L.suffix_number=L.cmp_op=K,M.$attr_accessor("command"),M.$attr_accessor("prefix_number"),M.$attr_accessor("suffix_number"),M.$attr_accessor("critical"),M.$attr_accessor("fumble"),M.$attr_accessor("dollar"),M.$attr_accessor("modify_number"),M.$attr_accessor("cmp_op"),M.$attr_accessor("target_number"),M.$attr_writer("question_target"),_(M,"$initialize",function(){var k=this;return k.prefix_number=K,k.suffix_number=K,k.critical=K,k.fumble=K,k.dollar=K,k.cmp_op=K,k.target_number=K,k.question_target=!1}),_(M,"$question_target?",w("question_target")),_(M,"$to_s",function(k){var v=this,P=K,B=K,te=K,D=K,fe=K;switch(null==k&&(k="after_command"),P=O(v.critical)?"@"+v.critical:K,B=O(v.fumble)?"#"+v.fumble:K,te=O(v.dollar)?"$"+v.dollar:K,D=X("Format").$modifier(v.modify_number),fe=O(v.question_target)?"?":v.target_number,k){case"after_command":return[v.prefix_number,v.command,v.suffix_number,P,B,te,D,v.cmp_op,fe].$join();case"after_modify_number":return[v.prefix_number,v.command,v.suffix_number,D,P,B,te,v.cmp_op,fe].$join();case"after_target_number":return[v.prefix_number,v.command,v.suffix_number,D,v.cmp_op,fe,P,B,te].$join();default:return K}},-1)},Opal.modules["bcdice/command/parser"]=function(d){var k,te,l,p,m,C,$,ie,se,Ee,Ie,ce,ye,c,f,u,be,fe,R,P,H=d.klass,J=d.module,_=d.slice,w=d.extract_kwargs,O=d.ensure_kwargs,x=d.get_kwarg,K=d.send2,V=d.find_super,A=d.def,U=d.send,N=d.eqeq,Y=d.thrower,T=d.hash,j=d.const_set,re=d.truthy,z=d.to_ary,q=d.hash2,Z=d.top,M=[],I=d.$r(M),X=d.nil,L=d.$$$;return Z.$require("racc/parser.rb"),Z.$require("bcdice/arithmetic/node"),Z.$require("bcdice/command/lexer"),Z.$require("bcdice/command/parsed"),H(L(I("BCDice"),"Command"),L(I("Racc"),"Parser"),"Parser"),k=M,te=P=[J(M[0],"BCDice")].concat(k),fe=[J(P[0],"Command")].concat(te),R=d.$r(fe),l=fe,f=[c=H(fe[0],L(R("Racc"),"Parser"),"Parser")].concat(l),u=d.$r(f),(be=c.$$prototype).notations=be.lexer=be.modifier=be.suffix_number=be.prefix_number=be.need_suffix_number=be.need_prefix_number=be.critical=be.fumble=be.dollar=be.allowed_cmp_op=be.question_target=X,A(c,"$initialize",function ae(ue,Ce){var y,W,pe,we,Fe=this;return ae.$$p=null,y=_(arguments),W=w(y),W=O(W),pe=y,we=x(W,"round_type"),K(Fe,V(Fe,"initialize",ae,!1,!0),"initialize",[],null),Fe.notations=pe,Fe.round_type=we,Fe.prefix_number=!1,Fe.suffix_number=!1,Fe.need_prefix_number=!1,Fe.need_suffix_number=!1,Fe.modifier=!0,Fe.critical=!1,Fe.fumble=!1,Fe.dollar=!1,Fe.allowed_cmp_op=[X,">=",">","<=","<","==","!="],Fe.question_target=!1},-2),A(c,"$disable_modifier",function(){return this.modifier=!1,this}),A(c,"$enable_prefix_number",function(){return this.prefix_number=!0,this}),A(c,"$enable_suffix_number",function(){return this.suffix_number=!0,this}),A(c,"$has_prefix_number",function(){return this.prefix_number=!0,this.need_prefix_number=!0,this}),A(c,"$has_suffix_number",function(){return this.suffix_number=!0,this.need_suffix_number=!0,this}),A(c,"$enable_critical",function(){return this.critical=!0,this}),A(c,"$enable_fumble",function(){return this.fumble=!0,this}),A(c,"$enable_dollar",function(){return this.dollar=!0,this}),A(c,"$restrict_cmp_op_to",function(ue){var Ce,W=this;return Ce=_(arguments),W.allowed_cmp_op=Ce,W},-1),A(c,"$enable_question_target",function(){return this.question_target=!0,this}),A(c,"$parse",function(ue){try{return this.lexer=u("Lexer").$new(ue,this.notations),this.$do_parse()}catch(y){if(!d.rescue(y,[u("ParseError"),u("ZeroDivisionError")]))throw y;try{return X}finally{d.pop_exception()}}}),c.$private(),A(c,"$parsed",function(ue,Ce,y,W){try{return Y("eval_return"),U(u("Parsed").$new(),"tap",[],function De(Fe){var Ye,at,It,At,ln,Jt,Dn,Tn=De.$$s??this;return null==Tn.round_type&&(Tn.round_type=X),null==Fe&&(Fe=X),Fe["$command="](ue["$[]"]("command")),Fe["$prefix_number="]((Ye=ue["$[]"]("prefix"))===X||null==Ye?X:Ye.$eval(Tn.round_type)),Fe["$suffix_number="]((at=ue["$[]"]("suffix"))===X||null==at?X:at.$eval(Tn.round_type)),Fe["$critical="]((It=Ce["$[]"]("critical"))===X||null==It?X:It.$eval(Tn.round_type)),Fe["$fumble="]((At=Ce["$[]"]("fumble"))===X||null==At?X:At.$eval(Tn.round_type)),Fe["$dollar="]((ln=Ce["$[]"]("dollar"))===X||null==ln?X:ln.$eval(Tn.round_type)),Fe["$modify_number="](y.$eval(Tn.round_type)),Fe["$cmp_op="](W["$[]"]("cmp_op")),N(W["$[]"]("target"),"?")?(Fe["$question_target="](!0),U(Fe,"target_number=",Jt=[0]),Jt[Jt.length-1]):(Fe["$question_target="](!1),Jt=[(Dn=W["$[]"]("target"),Dn===X||null==Dn?X:Dn.$eval(Tn.round_type))],U(Fe,"target_number=",Jt),Jt[Jt.length-1])},{$$s:this})}catch(De){if(De===d.t_eval_return)return De.$v;throw De}}),A(c,"$next_token",function(){return this.lexer.$next_token()}),p=d.large_array_unpack("6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,33,34,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,,,17,18,6,,5,,,17,18,,,5,23,24,25,26,56,54,55,57"),m=d.large_array_unpack("0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,,17,15,15,18,18,23,,18,30,30,23,23,24,,23,31,31,24,24,25,,24,44,44,25,25,28,,25,47,47,28,28,29,,28,48,48,29,29,33,,29,49,49,33,33,34,,33,50,50,34,34,36,,34,,,36,36,37,,36,,,37,37,,,37,27,27,27,27,52,52,52,52"),C=d.large_array_unpack("-2,4,16,-3,-1,11,,33,13,35,23,30,1,,28,40,,37,44,,,-2,,51,58,65,0,106,72,79,47,54,,86,93,,100,107,,,,,,,63,,,68,75,82,89,,120,,,,,"),$=d.large_array_unpack("-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29"),ie=d.large_array_unpack("30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,,,21,47,48,40,51,52,49,50,44,46,3,,,,13,,,,,,,,32"),se=d.large_array_unpack("8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,,,4,8,8,5,7,7,8,8,9,5,6,,,,6,,,,,,,,6"),Ee=[X,6,13,3,9,-1,27,-15,-10,-1,-38],Ie=[X,X,X,X,X,X,19,16,15,X,X],ce=d.large_array_unpack("0,0,racc_error,4,20,_reduce_1,4,20,_reduce_2,3,20,_reduce_3,3,21,_reduce_4,2,21,_reduce_5,2,21,_reduce_6,1,21,_reduce_7,0,22,_reduce_8,3,22,_reduce_9,3,22,_reduce_10,3,22,_reduce_11,2,23,_reduce_12,2,23,_reduce_13,3,23,_reduce_14,3,23,_reduce_15,0,24,_reduce_16,2,24,_reduce_17,2,24,_reduce_18,3,28,_reduce_19,3,28,_reduce_20,1,28,_reduce_none,3,27,_reduce_22,4,27,_reduce_23,1,27,_reduce_none,0,29,_reduce_25,1,29,_reduce_26,1,29,_reduce_27,1,29,_reduce_28,1,29,_reduce_29,2,26,_reduce_30,2,26,_reduce_31,1,26,_reduce_none,3,25,_reduce_33,1,25,_reduce_34"),ye=T(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),j(f[0],"Racc_arg",[p,m,$,C,ie,se,Ie,Ee,19,ce,ye,58,35,!0]),j(f[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),j(f[0],"Racc_debug_parser",!1),A(c,"$_reduce_1",function(ue,Ce,y){var W;return re(this.modifier)||this.$raise(u("ParseError")),W=z(ue),this.$parsed(W[0]??X,W[1]??X,W[2]??X,W[3]??X)}),A(c,"$_reduce_2",function(ue,Ce,y){var W;return re(this.modifier)||this.$raise(u("ParseError")),W=z(ue),this.$parsed(W[0]??X,W[2]??X,W[1]??X,W[3]??X)}),A(c,"$_reduce_3",function(ue,Ce,y){var W,Ye;return Ye=(W=z(ue))[2]??X,this.$parsed(W[0]??X,W[1]??X,L(L(u("Arithmetic"),"Node"),"Number").$new(0),Ye)}),A(c,"$_reduce_4",function(ue,Ce,y){var W=this;return re(W.prefix_number)&&re(W.suffix_number)||W.$raise(u("ParseError")),q(["command","prefix","suffix"],{command:ue["$[]"](1),prefix:ue["$[]"](0),suffix:ue["$[]"](2)})}),A(c,"$_reduce_5",function(ue,Ce,y){var W=this;return re(W.prefix_number)||W.$raise(u("ParseError")),re(W.need_suffix_number)&&W.$raise(u("ParseError")),q(["command","prefix"],{command:ue["$[]"](1),prefix:ue["$[]"](0)})}),A(c,"$_reduce_6",function(ue,Ce,y){var W=this;return re(W.suffix_number)||W.$raise(u("ParseError")),re(W.need_prefix_number)&&W.$raise(u("ParseError")),q(["command","suffix"],{command:ue["$[]"](0),suffix:ue["$[]"](1)})}),A(c,"$_reduce_7",function(ue,Ce,y){var W=this;return(re(W.need_prefix_number)||re(W.need_suffix_number))&&W.$raise(u("ParseError")),q(["command"],{command:ue["$[]"](0)})}),A(c,"$_reduce_8",function(ue,Ce,y){return q([],{})}),A(c,"$_reduce_9",function(ue,Ce,y){var W,Ye,De=X;return De=(W=z(ue))[0]??X,Ye=W[2]??X,re(this.critical)&&re(De["$[]"]("critical")["$nil?"]())||this.$raise(u("ParseError")),De["$[]="]("critical",Ye),De}),A(c,"$_reduce_10",function(ue,Ce,y){var W,Ye,De=X;return De=(W=z(ue))[0]??X,Ye=W[2]??X,re(this.fumble)&&re(De["$[]"]("fumble")["$nil?"]())||this.$raise(u("ParseError")),De["$[]="]("fumble",Ye),De}),A(c,"$_reduce_11",function(ue,Ce,y){var W,Ye,De=X;return De=(W=z(ue))[0]??X,Ye=W[2]??X,re(this.dollar)&&re(De["$[]"]("dollar")["$nil?"]())||this.$raise(u("ParseError")),De["$[]="]("dollar",Ye),De}),A(c,"$_reduce_12",function(ue,Ce,y){return ue["$[]"](1)}),A(c,"$_reduce_13",function(ue,Ce,y){return L(L(u("Arithmetic"),"Node"),"Negative").$new(ue["$[]"](1))}),A(c,"$_reduce_14",function(ue,Ce,y){return L(L(u("Arithmetic"),"Node"),"BinaryOp").$new(ue["$[]"](0),"+",ue["$[]"](2))}),A(c,"$_reduce_15",function(ue,Ce,y){return L(L(u("Arithmetic"),"Node"),"BinaryOp").$new(ue["$[]"](0),"-",ue["$[]"](2))}),A(c,"$_reduce_16",function(ue,Ce,y){return re(this.allowed_cmp_op["$include?"](X))||this.$raise(u("ParseError")),q([],{})}),A(c,"$_reduce_17",function(ue,Ce,y){var W,De,Fe;return Fe=(W=z(ue))[1]??X,re(this.allowed_cmp_op["$include?"](De=W[0]??X))||this.$raise(u("ParseError")),q(["cmp_op","target"],{cmp_op:De,target:Fe})}),A(c,"$_reduce_18",function(ue,Ce,y){var pe,W=this;return pe=ue["$[]"](0),re(W.question_target)||W.$raise(u("ParseError")),re(W.allowed_cmp_op["$include?"](pe))||W.$raise(u("ParseError")),q(["cmp_op","target"],{cmp_op:pe,target:"?"})}),A(c,"$_reduce_19",function(ue,Ce,y){return L(L(u("Arithmetic"),"Node"),"BinaryOp").$new(ue["$[]"](0),"+",ue["$[]"](2))}),A(c,"$_reduce_20",function(ue,Ce,y){return L(L(u("Arithmetic"),"Node"),"BinaryOp").$new(ue["$[]"](0),"-",ue["$[]"](2))}),A(c,"$_reduce_22",function(ue,Ce,y){return L(L(u("Arithmetic"),"Node"),"BinaryOp").$new(ue["$[]"](0),"*",ue["$[]"](2))}),A(c,"$_reduce_23",function(ue,Ce,y){return ue["$[]"](3).$new(ue["$[]"](0),ue["$[]"](2))}),A(c,"$_reduce_25",function(ue,Ce,y){return L(L(u("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),A(c,"$_reduce_26",function(ue,Ce,y){return L(L(u("Arithmetic"),"Node"),"DivideWithCeil")}),A(c,"$_reduce_27",function(ue,Ce,y){return L(L(u("Arithmetic"),"Node"),"DivideWithCeil")}),A(c,"$_reduce_28",function(ue,Ce,y){return L(L(u("Arithmetic"),"Node"),"DivideWithRound")}),A(c,"$_reduce_29",function(ue,Ce,y){return L(L(u("Arithmetic"),"Node"),"DivideWithFloor")}),A(c,"$_reduce_30",function(ue,Ce,y){return ue["$[]"](1)}),A(c,"$_reduce_31",function(ue,Ce,y){return L(L(u("Arithmetic"),"Node"),"Negative").$new(ue["$[]"](1))}),A(c,"$_reduce_33",function(ue,Ce,y){return ue["$[]"](1)}),A(c,"$_reduce_34",function(ue,Ce,y){return L(L(u("Arithmetic"),"Node"),"Number").$new(ue["$[]"](0))}),A(c,"$_reduce_none",function(ue,Ce,y){return ue["$[]"](0)})},Opal.modules["bcdice/deprecated/checker"]=function(d){var U,j,Z,M,I,X,z,Y,H=d.module,J=d.send,_=d.eqeqeq,w=d.truthy,O=d.def,x=d.return_val,K=[],V=d.nil;return U=K,j=Y=[H(K[0],"BCDice")].concat(U),Z=z=[H(Y[0],"Deprecated")].concat(j),I=[M=H(z[0],"Checker")].concat(Z),X=d.$r(I),M.$private(),O(M,"$check_result_legacy",function(S,k,v,P){var fe,B=this,te=V,D=V,R=V,F=V;return te=J(k,"map",[],"sides".$to_proc()),fe=(D=J(k,"map",[],"value".$to_proc())).$sum(),R=_([100],F=te)?B.$check_1D100(S,fe,v,P):_([20],F)?B.$check_1D20(S,fe,v,P):_([6,6],F)?B.$check_2D6(S,fe,D,v,P):V,(w(R["$nil?"]())||w(R["$empty?"]()))&&(R=_([10],F=te.$uniq())?B.$check_nD10(S,fe,D,v,P):_([6],F)?B.$check_nD6(S,fe,D,v,P):V,w(R["$nil?"]())||w(R["$empty?"]()))?V:X("Result").$new(R.$delete_prefix(" \uff1e "))}),O(M,"$check_1D100",x(V)),O(M,"$check_1D20",x(V)),O(M,"$check_nD10",x(V)),O(M,"$check_2D6",x(V)),O(M,"$check_nD6",x(V))},Opal.queue(function(d){var I,B,F,u,m,C,g,l,c,f,D,H=d.module,J=d.klass,_=d.slice,w=d.rb_plus,O=d.truthy,x=d.def,K=d.regexp,V=d.send,A=d.thrower,U=d.return_ivar,N=d.assign_ivar_val,Y=d.eqeqeq,T=d.eqeq,j=d.return_val,re=d.range,z=d.rb_minus,q=d.rb_divide,Z=d.rb_times,M=d.rb_ge,X=d.top,L=[],S=d.$r(L),k=d.nil,v=d.$$$;return X.$require("i18n"),X.$require("i18n/backend/fallbacks"),X.$require("bcdice/randomizer"),X.$require("bcdice/dice_table"),X.$require("bcdice/enum"),X.$require("bcdice/translate"),X.$require("bcdice/result"),X.$require("bcdice/command/parser"),X.$require("bcdice/deprecated/checker"),B=L,F=D=[H(L[0],"BCDice")].concat(B),l=[g=J(D[0],null,"Base")].concat(F),c=d.$r(l),(f=g.$$prototype).raw_input=f.randomizer=f.enabled_upcase_input=f.debug=k,m=[u=d.get_singleton_class(g)].concat(l),C=d.$r(m),u.$attr_reader("prefixes"),x(u,"$register_prefix",function(ie){var Ee,Ie=this,ce=k;return null==Ie.prefixes&&(Ie.prefixes=k),Ee=_(arguments),Ie.prefixes=w(O(ce=Ie.prefixes)?ce:[],Ee.$flatten())},-1),x(u,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())}),x(u,"$prefixes_pattern",function(){var ie=this,se=k;return null==ie.prefixes_pattern&&(ie.prefixes_pattern=k),null==ie.prefixes&&(ie.prefixes=k),ie.prefixes_pattern=O(se=ie.prefixes_pattern)?se:k,O(ie.prefixes_pattern)?ie.prefixes_pattern:(ie.prefixes=O(se=ie.prefixes)?se:[],ie.prefixes.$freeze(),ie.prefixes_pattern=(O(ie.prefixes["$empty?"]())?/(?!)/:K(["^(S)?(",ie.prefixes.$join("|"),")"],"i")).$freeze())}),x(u,"$command_pattern",function(){var ie=this,se=k,Ee=k;return null==ie.command_pattern&&(ie.command_pattern=k),null==ie.prefixes&&(ie.prefixes=k),ie.command_pattern=O(se=ie.command_pattern)?se:k,O(ie.command_pattern)?ie.command_pattern:(ie.prefixes=O(se=ie.prefixes)?se:[],ie.prefixes.$freeze(),Ee=w(V(v(C("CommonCommand"),"COMMANDS"),"map",[],function(ce){return null==ce&&(ce=k),v(ce,"PREFIX_PATTERN").$source()}),ie.prefixes),ie.command_pattern=K(["^S?(",Ee.$join("|"),")"],"i").$freeze())}),x(u,"$eval",function(ie){try{return A("eval_return"),this.$new(ie).$eval()}catch(Ie){if(Ie===d.t_eval_return)return Ie.$v;throw Ie}}),g.$include(c("Translate")),g.$include(v(c("Deprecated"),"Checker")),x(g,"$initialize",function(p){var m=this;return m.raw_input=p,m.sort_add_dice=!1,m.sort_barabara_dice=!1,m.d66_sort_type=v(c("D66SortType"),"NO_SORT"),m.enabled_d9=!1,m.round_type=v(c("RoundType"),"FLOOR"),m.sides_implicit_d=6,m.upper_dice_reroll_threshold=k,m.reroll_dice_reroll_threshold=k,m.default_cmp_op=k,m.default_target_number=k,m.enabled_upcase_input=!0,m.locale="ja_jp",m.randomizer=v(c("BCDice"),"Randomizer").$new(),m.debug=!1}),g.$attr_accessor("randomizer"),g.$attr_reader("d66_sort_type"),g.$attr_reader("round_type"),g.$attr_reader("sides_implicit_d"),g.$attr_reader("upper_dice_reroll_threshold"),g.$attr_reader("reroll_dice_reroll_threshold"),g.$attr_reader("default_cmp_op"),g.$attr_reader("default_target_number"),x(g,"$sort_add_dice?",U("sort_add_dice")),x(g,"$sort_barabara_dice?",U("sort_barabara_dice")),x(g,"$enabled_d9?",U("enabled_d9")),x(g,"$enable_debug",N("debug",!0)),x(g,"$eval",function(){var m,$,p=this,C=k;return m=v(c("BCDice"),"Preprocessor").$process(p.raw_input,p),C=O($=p.$dice_command(m))?$:p.$eval_common_command(p.raw_input),O(C)?(C["$rands="](p.randomizer.$rand_results()),C["$detailed_rands="](p.randomizer.$detailed_rand_results()),C):k}),x(g,"$change_text",function(p){return p}),x(g,"$check_result",function(p,m,C,$){var ie=this,se=k,Ee=k,Ie=k,ce=k,Me=k;return se=ie.$check_result_legacy(p,m,C,$),O(se)?se:(Ee=V(m,"map",[],"sides".$to_proc()),ce=(Ie=V(m,"map",[],"value".$to_proc())).$sum(),se=Y([100],Me=Ee)?ie.$result_1d100(p,ce,C,$):Y([20],Me)?ie.$result_1d20(p,ce,C,$):Y([6,6],Me)?ie.$result_2d6(p,ce,Ie,C,$):k,T(se,c("Result").$nothing())?k:O(se)?se:(se=Y([10],Me=Ee.$uniq())?ie.$result_nd10(p,ce,Ie,C,$):Y([6],Me)?ie.$result_nd6(p,ce,Ie,C,$):k,T(se,c("Result").$nothing())?k:O(se)?se:ie.$result_ndx(p,C,$)))}),x(g,"$grich_text",j(k)),g.$private(),x(g,"$eval_common_command",function(p){try{A("eval_return");var C=A("return");return p=this.$change_text(p),V(v(c("CommonCommand"),"COMMANDS"),"each",[],function ie(se){var Ie,Ee=ie.$$s??this;if(null==Ee.randomizer&&(Ee.randomizer=k),null==se&&(se=k),Ie=se.$eval(p,Ee,Ee.randomizer),!O(Ie))return k;C.$throw(Ie)},{$$s:this,$$ret:C}),k}catch(ie){if(ie===d.t_eval_return||ie===C)return ie.$v;throw ie}}),x(g,"$dice_command",function(p){var m=this,C=k,$=k,ie=k,se=k;return O(m.enabled_upcase_input)&&(p=p.$upcase()),C=m.$class().$prefixes_pattern().$match(p),O(C)?($=C["$[]"](1)["$nil?"]()["$!"](),O($)&&(p=p["$[]"](re(1,-1,!1))),ie=m.$eval_game_system_specific_command(p),O(ie["$is_a?"](c("Result")))?(ie["$secret="](O(se=ie["$secret?"]())?se:$),ie):O(ie["$nil?"]())||O(ie["$empty?"]())||T(ie,"1")?k:V(c("Result").$new(),"tap",[],function(Ie){var ce;return null==Ie&&(Ie=k),Ie["$text="](ie.$to_s()),V(Ie,"secret=",ce=[$]),ce[ce.length-1]})):k}),x(g,"$eval_game_system_specific_command",j(k)),x(g,"$result_ndx",function(p,m,C){return O(C["$is_a?"](c("String")))?k:O(p.$send(m,C))?c("Result").$success(this.$translate("success")):c("Result").$failure(this.$translate("failure"))}),x(g,"$result_1d100",j(k)),x(g,"$result_1d20",j(k)),x(g,"$result_nd10",j(k)),x(g,"$result_2d6",j(k)),x(g,"$result_nd6",j(k)),x(g,"$get_table_by_2d6",function(p){return this.$get_table_by_nD6(p,2)}),x(g,"$get_table_by_1d6",function(p){return this.$get_table_by_nD6(p,1)}),x(g,"$get_table_by_nD6",function(p,m){return this.$get_table_by_nDx(p,m,6)}),x(g,"$get_table_by_nDx",function(p,m,C){var ie,se=k;return ie=this.randomizer.$roll_sum(m,C),se=this.$get_table_value(p["$[]"](z(ie,m))),O(se["$nil?"]())?["1",0]:[se,ie]}),x(g,"$get_table_by_1d3",function(p){var $,ie,m=this,se=k;return m.$debug("get_table_by_1d3"),$=m.randomizer.$roll_sum(1,6),m.$debug("num",$),ie=q(z($,1),2).$to_i(),m.$debug("index",ie),se=p["$[]"](ie),O(se["$nil?"]())?["1",0]:[se,$]}),x(g,"$get_table_by_d66_swap",function(p){var C;return C=this.randomizer.$roll_d66(v(c("D66SortType"),"ASC")),[this.$get_table_by_number(C,p),C]}),x(g,"$get_table_by_d66",function(p){var C,$,ie,Ee,se=k;return C=this.randomizer.$roll_once(6),$=this.randomizer.$roll_once(6),ie=w(Z(z(C,1),6),z($,1)),se=p["$[]"](ie),Ee=""+C+$,O(se["$nil?"]())?["1",Ee]:[se,Ee]}),x(g,"$get_table_by_number",function(p,m,C){try{var $=A("return");return null==C&&(C="1"),V(m,"each",[],function se(Ee){var ce,Ie=se.$$s??this;if(null==Ee&&(Ee=k),ce=Ee["$[]"](0),!O(M(ce,p)))return k;$.$throw(Ie.$get_table_value(Ee["$[]"](1)))},{$$s:this,$$ret:$}),this.$get_table_value(C)}catch(se){if(se===$)return se.$v;throw se}},-3),x(g,"$get_table_value",function(p){return O(p["$is_a?"](c("Proc")))?p.$call():p}),x(g,"$roll_tables",function(p,m){var $=k;return $=m["$[]"](p),O($)?$.$roll(this.randomizer).$to_s():k}),x(g,"$debug",function(p,m){var $,ie=this,se=k,Ee=k;return $=_(arguments,1),O(ie.debug)?(se=O(p["$is_a?"](c("String")))?p:p.$inspect(),O($["$empty?"]())?ie.$warn(se):(Ee=V($,"map",[],function(ce){return null==ce&&(ce=k),O(ce["$is_a?"](c("String")))?'"'+ce+'"':ce.$inspect()}),ie.$warn(se+": "+Ee.$join(", ")))):k},-2),v(v(S("I18n"),"Backend"),"Simple").$include(v(v(S("I18n"),"Backend"),"Fallbacks")),S("I18n").$load_path()["$<<"](S("Dir")["$[]"](S("File").$join("bcdice","../../i18n/**/*.yml"))),S("I18n")["$default_locale="]("ja_jp"),I=[["ja_jp"]],V(S("I18n").$fallbacks(),"defaults=",I),I[I.length-1]})},4748:(E,le,_e)=>{_e(9993),Opal.modules["bcdice/normalize"]=function(d){var V,Y,U,H=d.module,J=d.eqeqeq,_=d.def,w=d.eqeq,O=[],x=d.nil;return V=O,U=[H(O[0],"BCDice")].concat(V),(Y=H(U[0],"Normalize")).$module_function(),_(Y,"$comparison_operator",function(j){var re;return J(/<=|=</,re=j)?"<=":J(/>=|=>/,re)?">=":J(/<>|!=|=!/,re)?"!=":J(/</,re)?"<":J(/>/,re)?">":J(/=/,re)?"==":x}),_(Y,"$target_number",function(j){return w(j,"?")?j:j.$to_i()})},Opal.modules["racc/parser"]=function(d){var P,te,D,H=d.module,J=d.klass,_=d.truthy,w=d.const_set,O=d.defs,x=d.gvars,K=d.rb_lt,V=d.def,A=d.to_ary,U=d.send,N=d.neqeq,Y=d.rb_plus,T=d.eqeq,j=d.rb_ge,re=d.rb_gt,z=d.rb_minus,q=d.rb_le,Z=d.rb_times,M=d.assign_ivar_val,X=[],L=d.$r(X),S=d.nil,k=d.$$$;return P=X,te=[H(X[0],"Racc")].concat(P),D=d.$r(te),J(te[0],D("StandardError"),"ParseError"),_(k("::","ParseError","skip_raise")?"constant":S)||w(X[0],"ParseError",k(L("Racc"),"ParseError")),function(v,P){var g,l,c,f,u,D=[H(v,"Racc")].concat(P),fe=d.$r(D);return _(fe("Racc_No_Extensions","skip_raise")?"constant":S)||w(D[0],"Racc_No_Extensions",!1),g=D,c=[l=J(D[0],null,"Parser")].concat(g),f=d.$r(c),(u=l.$$prototype).yydebug=u.racc_debug_out=u.racc_error_status=u.racc_t=u.racc_vstack=u.racc_val=u.racc_state=u.racc_tstack=S,w(c[0],"Racc_Runtime_Version","1.4.6"),w(c[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),w(c[0],"Racc_Runtime_Core_Version_R","1.4.6"),w(c[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),w(c[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),w(c[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),w(c[0],"Racc_Runtime_Core_Version",f("Racc_Runtime_Core_Version_R")),w(c[0],"Racc_Runtime_Core_Revision",f("Racc_Runtime_Core_Revision_R")),w(c[0],"Racc_Runtime_Type","ruby"),O(f("Parser"),"$racc_runtime_type",function(){return f("Racc_Runtime_Type")}),V(l,"$_racc_setup",function(){var m,C,$=this,ie=S,se=S;return null==x.stderr&&(x.stderr=S),_(k($.$class(),"Racc_debug_parser"))||($.yydebug=!1),_(null!=(m=$.yydebug)&&m!==S?"instance-variable":S)||($.yydebug=!1),_($.yydebug)&&(_(null!=(C=$.racc_debug_out)&&C!==S?"instance-variable":S)||($.racc_debug_out=x.stderr),$.racc_debug_out=_(ie=$.racc_debug_out)?ie:x.stderr),se=k($.$class(),"Racc_arg"),_(K(se.$size(),14))&&se["$[]="](13,!0),se}),V(l,"$_racc_init_sysvars",function(){var m=this;return m.racc_state=[0],m.racc_tstack=[],m.racc_vstack=[],m.racc_t=S,m.racc_val=S,m.racc_read_next=!0,m.racc_user_yyerror=!1,m.racc_error_status=0}),V(l,"$do_parse",function(){return this.$__send__(f("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),V(l,"$next_token",function(){return this.$raise(f("NotImplementedError"),this.$class()+"#next_token is not defined")}),V(l,"$_racc_do_parse_rb",function(m,C){var $,Ee=S,Ie=S,ce=S,Me=S,ye=S,he=S,Se=S,be=S;return $=A(m),Ee=$[0]??S,Ie=$[1]??S,ce=$[2]??S,Me=$[3]??S,ye=$[10]??S,this.$_racc_init_sysvars(),he=Se=be=S,U(this,"catch",["racc_end_parse"],function ae(){var ue,Ce,y=ae.$$s??this,W=S;for(null==y.racc_state&&(y.racc_state=S),null==y.racc_read_next&&(y.racc_read_next=S),null==y.racc_t&&(y.racc_t=S),null==y.yydebug&&(y.yydebug=S),null==y.racc_val&&(y.racc_val=S);_(!0);)for(_(be=Me["$[]"](y.racc_state["$[]"](-1)))?(_(y.racc_read_next)&&N(y.racc_t,0)&&(Ce=y.$next_token(),ue=A(Ce),he=ue[0]??S,y.racc_val=ue[1]??S,y.racc_t=_(he)?_(W=ye["$[]"](he))?W:1:0,_(y.yydebug)&&y.$racc_read_token(y.racc_t,he,y.racc_val),y.racc_read_next=!1),be=Y(be,y.racc_t),_(j(be,0))&&_(Se=Ee["$[]"](be))&&T(Ie["$[]"](be),y.racc_state["$[]"](-1))||(Se=ce["$[]"](y.racc_state["$[]"](-1)))):Se=ce["$[]"](y.racc_state["$[]"](-1));_(Se=y.$_racc_evalact(Se,m)););},{$$s:this})}),V(l,"$yyparse",function(m,C){return this.$__send__(f("Racc_YY_Parse_Method"),m,C,this.$_racc_setup(),!0)}),V(l,"$_racc_yyparse_rb",function(m,C,$,ie){var se,ce=S,Me=S,$e=S,ye=S,Se=S,be=S,ae=S;return se=A($),ce=se[0]??S,Me=se[1]??S,$e=se[2]??S,ye=se[3]??S,Se=se[10]??S,this.$_racc_init_sysvars(),be=S,ae=S,U(this,"catch",["racc_end_parse"],function ue(){var Ce=ue.$$s??this;for(null==Ce.racc_state&&(Ce.racc_state=S);!_(ae=ye["$[]"](Ce.racc_state["$[]"](-1)));)for(;_(be=Ce.$_racc_evalact($e["$[]"](Ce.racc_state["$[]"](-1)),$)););return U(m,"__send__",[C],function y(W,pe){var we=y.$$s??this,De=S,Fe=S;for(null==we.racc_t&&(we.racc_t=S),null==we.racc_state&&(we.racc_state=S),null==we.racc_read_next&&(we.racc_read_next=S),null==W&&(W=S),null==pe&&(pe=S),we.racc_t=_(W)?_(De=Se["$[]"](W))?De:1:0,we.racc_val=pe,we.racc_read_next=!1,ae=Y(ae,we.racc_t),_(j(ae,0))&&_(be=ce["$[]"](ae))&&T(Me["$[]"](ae),we.racc_state["$[]"](-1))||(be=$e["$[]"](we.racc_state["$[]"](-1)));_(be=we.$_racc_evalact(be,$)););for(;_(_(De=_(Fe=(ae=ye["$[]"](we.racc_state["$[]"](-1)))["$!"]())?Fe:we.racc_read_next["$!"]())?De:we.racc_t["$=="](0));)for(_(ae)&&_(ae=Y(ae,we.racc_t))&&_(j(ae,0))&&_(be=ce["$[]"](ae))&&T(Me["$[]"](ae),we.racc_state["$[]"](-1))||(be=$e["$[]"](we.racc_state["$[]"](-1)));_(be=we.$_racc_evalact(be,$)););},{$$s:Ce})},{$$s:this})}),V(l,"$_racc_evalact",function(m,C){var $,$e,se=this,Ee=S,Ie=S,Me=S,ye=S,he=S,Se=S;if(Ee=($=A(C))[0]??S,Ie=$[1]??S,Me=$[3]??S,$e=$[11]??S,ye=$[12]??S,_(re(m,0))&&_(K(m,$e)))_(re(se.racc_error_status,0))&&(T(se.racc_t,1)||(se.racc_error_status=z(se.racc_error_status,1))),se.racc_vstack.$push(se.racc_val),se.racc_state.$push(m),se.racc_read_next=!0,_(se.yydebug)&&(se.racc_tstack.$push(se.racc_t),se.$racc_shift(se.racc_t,se.racc_tstack,se.racc_vstack));else if(_(K(m,0))&&_(re(m,ye["$-@"]()))){if(he=U(se,"catch",["racc_jump"],function be(){var ae=be.$$s??this;return null==ae.racc_state&&(ae.racc_state=S),ae.racc_state.$push(ae.$_racc_do_reduce(C,m)),!1},{$$s:se}),_(he))switch(he){case 1:return se.racc_user_yyerror=!0,ye["$-@"]();case 2:return $e;default:se.$raise("[Racc Bug] unknown jump code")}}else if(T(m,$e))_(se.yydebug)&&se.$racc_accept(),se.$throw("racc_end_parse",se.racc_vstack["$[]"](0));else{if(T(m,ye["$-@"]())){switch(se.racc_error_status){case 0:_(C["$[]"](21))||se.$on_error(se.racc_t,se.racc_val,se.racc_vstack);break;case 3:T(se.racc_t,0)&&se.$throw("racc_end_parse",S),se.racc_read_next=!0}for(se.racc_user_yyerror=!1,se.racc_error_status=3;_(!0)&&!(_(Se=Me["$[]"](se.racc_state["$[]"](-1)))&&(Se=Y(Se,1),_(j(Se,0))&&_(m=Ee["$[]"](Se))&&T(Ie["$[]"](Se),se.racc_state["$[]"](-1))));)_(q(se.racc_state.$size(),1))&&se.$throw("racc_end_parse",S),se.racc_state.$pop(),se.racc_vstack.$pop(),_(se.yydebug)&&(se.racc_tstack.$pop(),se.$racc_e_pop(se.racc_state,se.racc_tstack,se.racc_vstack));return m}se.$raise("[Racc Bug] unknown action "+m.$inspect())}return _(se.yydebug)&&se.$racc_next_state(se.racc_state["$[]"](-1),se.racc_state),S}),V(l,"$_racc_do_reduce",function(m,C){var $,ye,Se,W,pe,we,Ye,se=this,Ie=S,ce=S,Me=S,$e=S,he=S,be=S,ae=S,ue=S,Ce=S,y=S,De=S,Fe=S,at=S;return Ie=($=A(m))[4]??S,ce=$[5]??S,Me=$[6]??S,$e=$[7]??S,ye=$[8]??S,he=$[9]??S,Se=$[13]??S,be=se.racc_state,ae=se.racc_vstack,ue=se.racc_tstack,Ce=Z(C,-3),y=he["$[]"](Ce),W=he["$[]"](Y(Ce,1)),pe=he["$[]"](Y(Ce,2)),we=[],_(se.yydebug)&&(De=ue["$[]"](y["$-@"](),y)),Fe=ae["$[]"](y["$-@"](),y),_(se.yydebug)&&ue["$[]="](y["$-@"](),y,we),ae["$[]="](y["$-@"](),y,we),be["$[]="](y["$-@"](),y,we),_(Se)?ae.$push(se.$__send__(pe,Fe,ae,Fe["$[]"](0))):ae.$push(se.$__send__(pe,Fe,ae)),ue.$push(W),_(se.yydebug)&&se.$racc_reduce(De,W,ue,ae),Ye=z(W,ye),_(Ce=$e["$[]"](Ye))&&(Ce=Y(Ce,be["$[]"](-1)),_(j(Ce,0))&&_(at=Ie["$[]"](Ce))&&T(ce["$[]"](Ce),Ye))?at:Me["$[]"](Ye)}),V(l,"$on_error",function(m,C,$){var se;return this.$raise(f("ParseError"),this.$sprintf("\nparse error on value %s (%s)",C.$inspect(),_(se=this.$token_to_str(m))?se:"?"))}),V(l,"$yyerror",function(){return this.$throw("racc_jump",1)}),V(l,"$yyaccept",function(){return this.$throw("racc_jump",2)}),V(l,"$yyerrok",M("racc_error_status",0)),V(l,"$racc_read_token",function(m,C,$){var ie=this;return ie.racc_debug_out.$print("read    "),ie.racc_debug_out.$print(C.$inspect(),"(",ie.$racc_token2str(m),") "),ie.racc_debug_out.$puts($.$inspect()),ie.racc_debug_out.$puts()}),V(l,"$racc_shift",function(m,C,$){return this.racc_debug_out.$puts("shift   "+this.$racc_token2str(m)),this.$racc_print_stacks(C,$),this.racc_debug_out.$puts()}),V(l,"$racc_reduce",function(m,C,$,ie){var se=this,Ee=S;return(Ee=se.racc_debug_out).$print("reduce "),_(m["$empty?"]())?Ee.$print(" <none>"):U(m,"each",[],function Ie(ce){return null==ce&&(ce=S),Ee.$print(" ",(Ie.$$s??this).$racc_token2str(ce))},{$$s:se}),Ee.$puts(" --\x3e "+se.$racc_token2str(C)),se.$racc_print_stacks($,ie),se.racc_debug_out.$puts()}),V(l,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),V(l,"$racc_e_pop",function(m,C,$){return this.racc_debug_out.$puts("error recovering mode: pop token"),this.$racc_print_states(m),this.$racc_print_stacks(C,$),this.racc_debug_out.$puts()}),V(l,"$racc_next_state",function(m,C){var $=this;return $.racc_debug_out.$puts("goto    "+m),$.$racc_print_states(C),$.racc_debug_out.$puts()}),V(l,"$racc_print_stacks",function(m,C){var ie=S;return(ie=this.racc_debug_out).$print("        ["),U(m,"each_index",[],function se(Ee){return null==Ee&&(Ee=S),ie.$print(" (",(se.$$s??this).$racc_token2str(m["$[]"](Ee))," ",C["$[]"](Ee).$inspect(),")")},{$$s:this}),ie.$puts(" ]")}),V(l,"$racc_print_states",function(m){var $=S;return($=this.racc_debug_out).$print("        ["),U(m,"each",[],function(se){return null==se&&(se=S),$.$print(" ",se)}),$.$puts(" ]")}),V(l,"$racc_token2str",function(m){var $;return _($=k(this.$class(),"Racc_token_to_s_table")["$[]"](m))?$:this.$raise("[Racc Bug] can't convert token "+m+" to string")}),V(l,"$token_to_str",function(m){return k(this.$class(),"Racc_token_to_s_table")["$[]"](m)})}(X[0],X)},Opal.modules.strscan=function(d){var T,j,re,z,q,J=d.def,_=d.truthy,w=d.eqeqeq,O=d.Opal,x=d.return_ivar,K=d.send,V=d.alias,A=[],U=d.nil;return T=A,re=[j=(0,d.klass)(A[0],null,"StringScanner")].concat(T),z=d.$r(re),(q=j.$$prototype).pos=q.string=q.working=q.matched=q.prev_pos=q.match=U,j.$attr_reader("pos","matched"),J(j,"$initialize",function(M){var I=this;return I.string=M,I.pos=0,I.matched=U,I.working=M,I.match=[]}),j.$attr_reader("string"),J(j,"$beginning_of_line?",function(){var M=this;return 0===M.pos||"\n"===M.string.charAt(M.pos-1)}),J(j,"$scan",function(M){var I=this,X=(M=I.$anchor(M)).exec(I.working);return null==X?I.matched=U:(I.prev_pos=I.pos,I.pos+=X[0].length,I.working=I.working.substring(X[0].length),I.matched=X[0],I.match=X,X[0])}),J(j,"$scan_until",function(M){var I=this;M=I.$anchor(M);for(var X=I.working,L=0;X.length!=L;++L){var S=M.exec(X.substr(L));if(null!==S){var k=L+S[0].length,v=X.substr(0,k);return I.matched=S[0],I.match=S,I.prev_pos=I.pos+L,I.pos+=k,I.working=X.substr(k),v}}return I.matched=U}),J(j,"$[]",function(M){var X;if(_(this.match["$empty?"]()))return U;w(z("Symbol"),X=M)?M=M.$to_s():w(z("String"),X)||(M=O["$coerce_to!"](M,z("Integer"),"to_int"));var L=this.match;return M<0&&(M+=L.length),M<0||M>=L.length||null==L[M]?U:L[M]}),J(j,"$check",function(M){var I=this,X=(M=I.$anchor(M)).exec(I.working);return I.matched=null==X?U:X[0]}),J(j,"$check_until",function(M){var I=this,X=I.prev_pos,L=I.pos,S=I.working,k=I.$scan_until(M);return I.prev_pos=X,I.pos=L,I.working=S,k}),J(j,"$peek",function(M){return this.working.substring(0,M)}),J(j,"$eos?",function(){return 0===this.working.length}),J(j,"$exist?",function(M){var X=M.exec(this.working);return null==X?U:0==X.index?0:X.index+1}),J(j,"$skip",function(M){var I=this,X=(M=I.$anchor(M)).exec(I.working);if(null==X)return I.match=[],I.matched=U;var L=X[0],S=L.length;return I.matched=L,I.match=X,I.prev_pos=I.pos,I.pos+=S,I.working=I.working.substring(S),S}),J(j,"$skip_until",function(M){var X=this.$scan_until(M);return X===U?U:(this.matched=X.substr(-1),X.length)}),J(j,"$get_byte",function(){var M=this,I=U;return M.pos<M.string.length?(M.prev_pos=M.pos,M.pos+=1,I=M.matched=M.working.substring(0,1),M.working=M.working.substring(1)):M.matched=U,I}),J(j,"$match?",function(M){var I=this,X=(M=I.$anchor(M)).exec(I.working);return null==X?U:(I.prev_pos=I.pos,X[0].length)}),J(j,"$pos=",function(M){var I=this;return M<0&&(M+=I.string.$length()),I.pos=M,I.working=I.string.slice(M)}),J(j,"$matched_size",function(){return this.matched===U?U:this.matched.length}),J(j,"$post_match",function(){var M=this;return M.matched===U?U:M.string.substr(M.pos)}),J(j,"$pre_match",function(){var M=this;return M.matched===U?U:M.string.substr(0,M.prev_pos)}),J(j,"$reset",function(){var M=this;return M.working=M.string,M.matched=U,M.pos=0}),J(j,"$rest",x("working")),J(j,"$rest?",function(){return 0!==this.working.length}),J(j,"$rest_size",function(){return this.$rest().$size()}),J(j,"$terminate",function(){var M,I=this;return I.match=U,M=[I.string.$length()],K(I,"pos=",M),M[M.length-1]}),J(j,"$unscan",function(){var M=this;return M.pos=M.prev_pos,M.prev_pos=U,M.match=U,M}),V(j,"bol?","beginning_of_line?"),V(j,"getch","get_byte"),j.$private(),J(j,"$anchor",function(M){var I=M.toString().match(/\/([^\/]+)$/);return I=I?I[1]:void 0,new RegExp("^(?:"+M.source+")",I)})},Opal.modules["bcdice/common_command/lexer"]=function(d){var N,re,I,X,L,S,q,T,H=d.module,J=d.klass,_=d.const_set,w=d.hash2,O=d.truthy,x=d.def,K=d.top,V=[],A=d.nil;return K.$require("strscan"),K.$require("bcdice/normalize"),N=V,re=T=[H(V[0],"BCDice")].concat(N),I=q=[H(T[0],"CommonCommand")].concat(re),L=[X=J(q[0],null,"Lexer")].concat(I),S=d.$r(L),X.$$prototype.scanner=A,_(L[0],"SYMBOLS",w(["+","-","*","/","(",")","[","]","?","@"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","?":"QUESTION","@":"AT"}).$freeze()),x(X,"$initialize",function(P){var te;return P=O(te=P.$split(" ",2).$first())?te:"",this.scanner=S("StringScanner").$new(P)}),x(X,"$next_token",function(){var P=this,B=A,te=A,D=A,R=A;return O(P.scanner["$eos?"]())?[!1,"$"]:O(B=P.scanner.$scan(/\d+/))?["NUMBER",B.$to_i()]:O(te=P.scanner.$scan(/[<>!=]+/))?["CMP_OP",S("Normalize").$comparison_operator(te)]:(D=P.scanner.$getch().$upcase(),[O(R=S("SYMBOLS")["$[]"](D))?R:D.$to_sym(),D])}),x(X,"$source",function(){return this.scanner.$string()})},Opal.modules.singleton=function(d){var N,z,q,Z,M,Y,T,j,H=d.module,J=d.def,_=d.send2,w=d.find_super,O=d.send,x=d.truthy,K=d.defs,V=[],A=d.nil;return N=V,T=[Y=H(V[0],"Singleton")].concat(N),j=d.$r(T),J(Y,"$clone",function(){return this.$raise(j("TypeError"),"can't clone instance of singleton "+this.$class())}),J(Y,"$dup",function(){return this.$raise(j("TypeError"),"can't dup instance of singleton "+this.$class())}),z=T,Z=[q=H(T[0],"SingletonClassMethods")].concat(z),M=d.$r(Z),J(q,"$clone",function I(){var X=I.$$p||A;return I.$$p=null,M("Singleton").$__init__(_(this,w(this,"clone",I,!1,!0),"clone",[],X))}),J(q,"$inherited",function I(X){var L=I.$$p||A;return I.$$p=null,_(this,w(this,"inherited",I,!1,!0),"inherited",[X],L),M("Singleton").$__init__(X)}),function(re,z){var q=[re].concat(z),Z=d.$r(q);return J(re,"$__init__",function(I){return O(I,"instance_eval",[],function L(){return(L.$$s??this).singleton__instance__=A},{$$s:this}),K(I,"$instance",function(){var S=this;return null==S.singleton__instance__&&(S.singleton__instance__=A),x(S.singleton__instance__)?S.singleton__instance__:S.singleton__instance__=S.$new()}),I}),J(re,"$included",function M(I){var X=M.$$p||A;return M.$$p=null,_(this,w(this,"included",M,!1,!0),"included",[I],X),I.$extend(Z("SingletonClassMethods")),Z("Singleton").$__init__(I)})}(d.get_singleton_class(j("Singleton")),T)},Opal.modules["bcdice/common_command/add_dice/node"]=function(d){var v,D,g,u,se,Ee,Ie,ce,Me,m,C,c,R,B,H=d.module,J=d.klass,_=d.def,w=d.rb_plus,O=d.thrower,x=d.truthy,K=d.rb_le,V=d.send,A=d.return_val,U=d.alias,N=d.return_ivar,Y=d.send2,T=d.find_super,j=d.const_set,re=d.eqeqeq,z=d.rb_divide,q=d.assign_ivar,Z=d.not,M=d.neqeq,X=[],L=d.nil,S=d.$$$;return d.top.$require("singleton"),v=X,D=B=[H(X[0],"BCDice")].concat(v),g=R=[H(B[0],"CommonCommand")].concat(D),u=c=[H(R[0],"AddDice")].concat(g),m=[H(c[0],"Node")].concat(u),C=d.$r(m),se=m,Ie=[Ee=J(m[0],null,"Command")].concat(se),ce=d.$r(Ie),(Me=Ee.$$prototype).lhs=Me.rhs=Me.cmp_op=L,Ee.$attr_reader("lhs"),Ee.$attr_reader("cmp_op"),Ee.$attr_reader("rhs"),_(Ee,"$initialize",function(ye,he,Se,be){return null==Se&&(Se=L),null==be&&(be=L),this.secret=ye,this.lhs=he,this.cmp_op=Se,this.rhs=be},-3),_(Ee,"$expr",function(ye){try{var Se;return O("eval_return"),w(w(this.lhs.$expr(ye),this.$cmp_op_text()),(Se=this.rhs,Se===L||null==Se?L:Se.$eval(ye,L)).$to_s())}catch(ae){if(ae===d.t_eval_return)return ae.$v;throw ae}}),_(Ee,"$s_exp",function(){var ye=this;return x(ye.cmp_op)?"(Command ("+ye.cmp_op+" "+ye.lhs.$s_exp()+" "+ye.rhs.$s_exp()+"))":"(Command "+ye.lhs.$s_exp()+")"}),_(Ee,"$eval",function(ye,he){try{O("eval_return");var be,pe,ae=this,ue=L,Ce=L,y=L,W=L,we=L;return he=ce("Randomizer").$new(he,ye),ue=ae.lhs.$eval(ye,he),Ce=x(K(he.$rand_results().$size(),1))&&x(ae.lhs["$is_a?"](S(ce("Node"),"DiceRoll")))?L:ae.lhs.$output(),y=x(ae.cmp_op)?(W=ae.rhs.$eval(ye,L),ye.$check_result(ue,he.$rand_results(),ae.cmp_op,W)):L,y=x(pe=y)?pe:ce("Result").$new(),we=["("+ae.$expr(ye)+")",Ce,ue,(be=y,be===L||null==be?L:be.$text())].$compact(),V(y,"tap",[],function De(Fe){var Ye,at=De.$$s??this;return null==at.secret&&(at.secret=L),null==Fe&&(Fe=L),Fe["$secret="](at.secret),Ye=[we.$join(" \uff1e ")],V(Fe,"text=",Ye),Ye[Ye.length-1]},{$$s:ae})}catch(De){if(De===d.t_eval_return)return De.$v;throw De}}),Ee.$private(),_(Ee,"$cmp_op_text",function(){switch(this.cmp_op){case"!=":return"<>";case"==":return"=";default:return this.cmp_op.$to_s()}}),function($,ie,se){var Ee=J($,null,"UndecidedTarget"),Ie=[Ee].concat(se),ce=d.$r(Ie);Ee.$include(ce("Singleton")),_(Ee,"$eval",A("?")),_(Ee,"$include_dice?",A(!1)),_(Ee,"$expr",A("?")),_(Ee,"$output",A("?")),U(Ee,"s_exp","output")}(m[0],0,m),function($,ie){var se=J($,null,"BinaryOp"),Ee=se.$$prototype;Ee.lhs=Ee.rhs=Ee.op=L,_(se,"$initialize",function(ce,Me,$e){return this.lhs=ce,this.op=Me,this.rhs=$e}),_(se,"$eval",function(ce,Me){try{var he,Se;return O("eval_return"),he=this.lhs.$eval(ce,Me),Se=this.rhs.$eval(ce,Me),this.$calc(he,Se,ce.$round_type()).$to_i()}catch(be){if(be===d.t_eval_return)return be.$v;throw be}}),_(se,"$include_dice?",function(){var Me;return x(Me=this.lhs["$include_dice?"]())?Me:this.rhs["$include_dice?"]()}),_(se,"$expr",function(ce){var $e,ye;return $e=this.lhs.$expr(ce),ye=this.rhs.$expr(ce),""+$e+this.op+ye}),_(se,"$output",function(){return""+this.lhs.$output()+this.op+this.rhs.$output()}),_(se,"$s_exp",function(){return"("+this.$op_for_s_exp()+" "+this.lhs.$s_exp()+" "+this.rhs.$s_exp()+")"}),se.$private(),_(se,"$calc",function(ce,Me,$e){return ce.$send(this.op,Me).$to_i()}),_(se,"$op_for_s_exp",N("op"))}(m[0]),function($,ie,se){var Ee=J($,ie,"DivideBase"),Ie=[Ee].concat(se),ce=d.$r(Ie);Ee.$$prototype.op=L,_(Ee,"$initialize",function $e(ye,he){return $e.$$p=null,Y(this,T(this,"initialize",$e,!1,!0),"initialize",[ye,"/",he],null)}),_(Ee,"$expr",function $e(ye){return $e.$$p=null,""+Y(this,T(this,"expr",$e,!1,!0),"expr",[ye],null)+this.$rounding_method()}),_(Ee,"$output",function $e(){var ye=$e.$$p||L;return $e.$$p=null,""+Y(this,T(this,"output",$e,!1,!0),"output",[],ye)+this.$rounding_method()}),Ee.$private(),_(Ee,"$rounding_method",function(){return S(this.$class(),"ROUNDING_METHOD")}),_(Ee,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),_(Ee,"$calc",function(ye,he,Se){return x(he["$zero?"]())?1:this.$divide_and_round(ye,he,Se).$to_i()}),_(Ee,"$divide_and_round",function(ye,he,Se){return this.$raise(ce("NotImplementedError"))})}(m[0],C("BinaryOp"),m),function($,ie,se){var Ee=J($,ie,"DivideWithGameSystemDefault"),Ie=[Ee].concat(se),ce=d.$r(Ie);j(Ie[0],"ROUNDING_METHOD",""),Ee.$private(),_(Ee,"$divide_and_round",function($e,ye,he){var Se,be=L;return re(S(ce("RoundType"),"CEIL"),Se=he)?z($e.$to_f(),ye).$ceil():re(S(ce("RoundType"),"ROUND"),Se)?(be=z($e.$to_f(),ye),x(be["$negative?"]())?be.$abs().$round()["$-@"]():be.$round()):z($e,ye).$floor()})}(m[0],C("DivideBase"),m),function($,ie,se){var Ee=J($,ie,"DivideWithRoundingUp"),Ie=[Ee].concat(se);j(Ie[0],"ROUNDING_METHOD","U"),Ee.$private(),_(Ee,"$divide_and_round",function(Me,$e,ye){return z(Me.$to_f(),$e).$ceil()})}(m[0],C("DivideBase"),m),function($,ie,se){var Ee=J($,ie,"DivideWithRoundingOff"),Ie=[Ee].concat(se);j(Ie[0],"ROUNDING_METHOD","R"),Ee.$private(),_(Ee,"$divide_and_round",function(Me,$e,ye){var he=L;return he=z(Me.$to_f(),$e),x(he["$negative?"]())?he.$abs().$round()["$-@"]():he.$round()})}(m[0],C("DivideBase"),m),function($,ie,se){var Ee=J($,ie,"DivideWithRoundingDown"),Ie=[Ee].concat(se);j(Ie[0],"ROUNDING_METHOD","F"),Ee.$private(),_(Ee,"$divide_and_round",function(Me,$e,ye){return z(Me,$e).$floor()})}(m[0],C("DivideBase"),m),function($,ie){var se=J($,null,"Negate");se.$$prototype.body=L,se.$attr_reader("body"),_(se,"$initialize",q("body")),_(se,"$eval",function(ce,Me){try{return O("eval_return"),this.body.$eval(ce,Me).$to_i()["$-@"]()}catch(he){if(he===d.t_eval_return)return he.$v;throw he}}),_(se,"$include_dice?",function(){return this.body["$include_dice?"]()}),_(se,"$expr",function(ce){return"-"+this.body.$expr(ce)}),_(se,"$output",function(){return"-"+this.body.$output()}),_(se,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(m[0]),function($,ie){var se=J($,null,"DiceRoll"),Ee=se.$$prototype;Ee.times=Ee.sides=L,_(se,"$initialize",function(ce,Me){return this.times=ce,this.sides=Me,this.text=L}),_(se,"$eval",function(ce,Me){try{O("eval_return");var he,Se,be=L,ae=L;return he=this.times.$eval(ce,L),Se=this.$eval_sides(ce),ae=(be=Me.$roll(he,Se)).$sum(),this.text=ae+"["+be.$join(",")+"]",ae.$to_i()}catch(ue){if(ue===d.t_eval_return)return ue.$v;throw ue}}),_(se,"$include_dice?",A(!0)),_(se,"$expr",function(ce){try{return O("eval_return"),this.times.$eval(ce,L)+"D"+this.$eval_sides(ce)}catch(Se){if(Se===d.t_eval_return)return Se.$v;throw Se}}),_(se,"$output",N("text")),_(se,"$s_exp",function(){return"(DiceRoll "+this.times.$s_exp()+" "+this.sides.$s_exp()+")"}),se.$private(),_(se,"$eval_sides",function(ce){try{return O("eval_return"),this.sides.$eval(ce,L)}catch(ye){if(ye===d.t_eval_return)return ye.$v;throw ye}})}(m[0]),function($,ie){var se=J($,ie,"ImplicitSidesDiceRoll");se.$$prototype.times=L,_(se,"$initialize",function(ce){return this.times=ce,this.text=L}),_(se,"$s_exp",function(){return"(ImplicitSidesDiceRoll "+this.times.$s_exp()+")"}),se.$private(),_(se,"$eval_sides",function(ce){return ce.$sides_implicit_d()})}(m[0],C("DiceRoll")),function($,ie,se){var Ee=J($,null,"DiceRollWithFilter"),Ie=[Ee].concat(se),ce=d.$r(Ie),Me=Ee.$$prototype;Me.times=Me.n_filtering=Me.filter=Me.sides=L,j(Ie[0],"Filter",ce("Struct").$new("abbr","apply")),j(Ie[0],"KEEP_HIGHEST",ce("Filter").$new("KH",V(Ee,"lambda",[],function(ye,he){return null==ye&&(ye=L),null==he&&(he=L),ye.$reverse().$take(he)})).$freeze()),j(Ie[0],"KEEP_LOWEST",ce("Filter").$new("KL",V(Ee,"lambda",[],function(ye,he){return null==ye&&(ye=L),null==he&&(he=L),ye.$take(he)})).$freeze()),j(Ie[0],"DROP_HIGHEST",ce("Filter").$new("DH",V(Ee,"lambda",[],function(ye,he){return null==ye&&(ye=L),null==he&&(he=L),ye.$reverse().$drop(he)})).$freeze()),j(Ie[0],"DROP_LOWEST",ce("Filter").$new("DL",V(Ee,"lambda",[],function(ye,he){return null==ye&&(ye=L),null==he&&(he=L),ye.$drop(he)})).$freeze()),_(Ee,"$initialize",function(ye,he,Se,be){var ae=this;return M(he,"implicit")&&Z(he["$respond_to?"]("eval"))&&ae.$raise(ce("TypeError"),"sides must be a Node or :implicit ("+he.$inspect()+")"),ae.times=ye,ae.sides=he,ae.n_filtering=Se,ae.filter=be,ae.text=L}),_(Ee,"$eval",function(ye,he){try{O("eval_return");var ae,ue,Ce,be=this,y=L,W=L;return ae=be.times.$eval(ye,L),ue=be.$eval_sides(ye),Ce=be.n_filtering.$eval(ye,L),y=he.$roll(ae,ue).$sort(),W=be.filter.$apply()["$[]"](y,Ce).$sum(),be.text=W+"["+y.$join(",")+"]",W.$to_i()}catch(pe){if(pe===d.t_eval_return)return pe.$v;throw pe}}),_(Ee,"$include_dice?",A(!0)),_(Ee,"$implicit_sides?",function(){return this.sides["$=="]("implicit")}),_(Ee,"$expr",function(ye){try{var be,ae,ue;return O("eval_return"),be=this.times.$eval(ye,L),ae=this.$eval_sides(ye),ue=this.n_filtering.$eval(ye,L),be+"D"+ae+this.filter.$abbr()+ue}catch(Ce){if(Ce===d.t_eval_return)return Ce.$v;throw Ce}}),_(Ee,"$output",N("text")),_(Ee,"$s_exp",function(){var he,ye=this;return he=x(ye["$implicit_sides?"]())?ye.sides.$inspect():ye.sides.$s_exp(),"(DiceRollWithFilter "+ye.times.$s_exp()+" "+he+" "+ye.filter.$abbr().$inspect()+" "+ye.n_filtering.$s_exp()+")"}),Ee.$private(),_(Ee,"$eval_sides",function(ye){try{return O("eval_return"),x(this["$implicit_sides?"]())?ye.$sides_implicit_d():this.sides.$eval(ye,L)}catch(be){if(be===d.t_eval_return)return be.$v;throw be}})}(m[0],0,m),function($,ie){var se=J($,null,"Parenthesis");se.$$prototype.expr=L,_(se,"$initialize",q("expr")),_(se,"$eval",function(ce,Me){try{return O("eval_return"),this.expr.$eval(ce,Me).$to_i()}catch(he){if(he===d.t_eval_return)return he.$v;throw he}}),_(se,"$include_dice?",function(){return this.expr["$include_dice?"]()}),_(se,"$expr",function(ce){return"("+this.expr.$expr(ce)+")"}),_(se,"$output",function(){return"("+this.expr.$output()+")"}),_(se,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(m[0]),function($,ie,se){var Ee=J($,null,"Number"),Ie=[Ee].concat(se),ce=d.$r(Ie);return Ee.$$prototype.literal=L,Ee.$attr_reader("literal"),_(Ee,"$initialize",function(ye){return this.literal=ye.$to_i()}),_(Ee,"$negate",function(){return ce("Number").$new(this.literal["$-@"]())}),_(Ee,"$eval",function(ye,he){return this.literal.$to_i()}),_(Ee,"$include_dice?",A(!1)),_(Ee,"$expr",function(ye){return this.literal.$to_s()}),_(Ee,"$output",function(){return this.literal.$to_s()}),U(Ee,"s_exp","output")}(m[0],0,m)},Opal.modules["bcdice/common_command/add_dice/parser"]=function(d){var M,S,B,g,u,p,m,C,$,ie,se,Ee,Ie,$e,l,c,f,D,fe,v,X,H=d.module,J=d.klass,_=d.defs,w=d.def,O=d.truthy,x=d.eqeq,K=d.hash,V=d.const_set,A=d.to_ary,U=d.not,N=d.return_val,Y=d.neqeq,T=d.hash2,j=d.top,re=[],z=d.nil,q=d.$$$;return j.$require("racc/parser.rb"),j.$require("bcdice/common_command/lexer"),j.$require("bcdice/common_command/add_dice/node"),M=re,S=X=[H(re[0],"BCDice")].concat(M),B=v=[H(X[0],"CommonCommand")].concat(S),D=[H(v[0],"AddDice")].concat(B),fe=d.$r(D),g=D,c=[l=J(D[0],q(fe("Racc"),"Parser"),"Parser")].concat(g),f=d.$r(c),l.$$prototype.lexer=z,_(l,"$parse",function(ae){return this.$new().$parse(ae)}),w(l,"$parse",function(ae){try{return this.lexer=f("Lexer").$new(ae),this.$do_parse()}catch(Ce){if(!d.rescue(Ce,[f("ParseError")]))throw Ce;try{return z}finally{d.pop_exception()}}}),l.$private(),w(l,"$next_token",function(){return this.lexer.$next_token()}),w(l,"$expand_negate",function(ae,ue){if(O(ue["$is_a?"](q(f("Node"),"Negate")))){if(x(ae,"+"))return["-",ue.$body()];if(x(ae,"-"))return["+",ue.$body()]}return[ae,ue]}),u=d.large_array_unpack("14,14,50,12,51,19,20,14,14,14,12,3,12,17,18,14,8,9,12,4,13,13,28,8,9,8,9,13,13,13,14,8,9,12,15,13,14,23,14,12,56,12,19,20,57,14,8,9,12,,13,,8,9,8,9,13,14,13,,12,8,9,14,16,13,-27,-27,19,20,-27,17,18,8,9,,42,13,,17,18,40,39,13,,38,-28,-28,40,39,-28,,38,45,47,44,46,52,53,54,55"),p=d.large_array_unpack("16,12,38,16,38,6,6,2,36,8,2,0,8,27,27,9,16,16,9,1,16,12,16,2,2,8,8,2,36,8,13,9,9,13,4,9,17,11,18,17,50,18,29,29,51,19,13,13,19,,13,,17,17,18,18,17,20,18,,20,19,19,23,5,19,23,23,30,30,23,25,25,20,20,,25,20,,5,5,24,24,23,,24,33,33,34,34,33,,34,32,32,32,32,39,39,40,40"),m=d.large_array_unpack("7,19,5,,34,61,-15,,7,13,,32,-1,28,,,-2,34,36,43,55,,,61,76,53,,-5,,22,48,,79,81,83,,6,,-8,90,92,,,,,,,,,,29,31,,,,,,"),C=d.large_array_unpack("-3,-41,-41,-4,-41,-1,-9,-12,-41,-41,-20,-26,-41,-41,-40,58,-41,-41,-41,-41,-41,-18,-19,-22,-24,-41,-2,-5,-6,-7,-8,-10,-13,-21,-41,-25,-37,-30,-41,-41,-41,-38,-39,-11,-14,-15,-16,-17,-23,-29,-41,-41,-33,-34,-35,-36,-31,-32"),$=[24,5,21,22,29,30,35,1,2,26,43,33,25,31,32,27,48,34,z,z,z,z,z,z,49],ie=[9,3,6,6,5,5,11,1,2,4,7,9,3,6,6,3,11,10,z,z,z,z,z,z,9],se=[z,7,8,-1,-7,-13,-6,-22,z,-12,-6,-18,z,z,z],Ee=[z,z,z,z,z,6,7,z,10,11,z,z,36,37,41],Ie=d.large_array_unpack("0,0,racc_error,2,26,_reduce_1,4,26,_reduce_2,0,27,_reduce_3,1,27,_reduce_4,1,29,_reduce_none,1,29,_reduce_6,3,28,_reduce_7,3,28,_reduce_8,1,28,_reduce_none,3,30,_reduce_10,4,30,_reduce_11,1,30,_reduce_none,0,32,_reduce_13,1,32,_reduce_14,1,32,_reduce_15,1,32,_reduce_16,1,32,_reduce_17,2,31,_reduce_18,2,31,_reduce_19,1,31,_reduce_none,3,33,_reduce_21,2,33,_reduce_22,4,33,_reduce_23,2,33,_reduce_24,3,33,_reduce_25,1,33,_reduce_none,0,35,_reduce_27,1,35,_reduce_28,2,36,_reduce_29,1,36,_reduce_30,3,39,_reduce_31,3,39,_reduce_32,2,37,_reduce_33,2,37,_reduce_34,2,37,_reduce_35,2,37,_reduce_36,1,38,_reduce_none,1,38,_reduce_none,3,34,_reduce_39,1,34,_reduce_40"),$e=K(!1,0,"error",1,"NUMBER",2,"CMP_OP",3,"S",4,"D",5,"K",6,"H",7,"L",8,"M",9,"A",10,"X",11,"I",12,"N",13,"U",14,"R",15,"F",16,"C",17,"PLUS",18,"MINUS",19,"ASTERISK",20,"SLASH",21,"PARENL",22,"PARENR",23,"QUESTION",24),V(c[0],"Racc_arg",[u,p,C,m,$,ie,Ee,se,25,Ie,$e,58,41,!0]),V(c[0],"Racc_token_to_s_table",d.large_array_unpack("$end,error,NUMBER,CMP_OP,S,D,K,H,L,M,A,X,I,N,U,R,F,C,PLUS,MINUS,ASTERISK,SLASH,PARENL,PARENR,QUESTION,$start,command,secret,add,target,mul,unary,round_type,dice,term,explicit_or_implicit_sides,filter,filter_type,filter_type_with_shorthand,filter_shorthand")),V(c[0],"Racc_debug_parser",!1),w(l,"$_reduce_1",function(ae,ue,Ce){var y,we,De=z;return we=(y=A(ae))[0]??z,O((De=y[1]??z)["$include_dice?"]())||this.$raise(f("ParseError")),q(f("Node"),"Command").$new(we,De)}),w(l,"$_reduce_2",function(ae,ue,Ce){var y,we,De=z,Fe=z,Ye=z;return we=(y=A(ae))[0]??z,Fe=y[2]??z,Ye=y[3]??z,(U((De=y[1]??z)["$include_dice?"]())||O(Ye["$include_dice?"]())||O(Fe["$nil?"]()))&&this.$raise(f("ParseError")),q(f("Node"),"Command").$new(we,De,Fe,Ye)}),w(l,"$_reduce_3",N(!1)),w(l,"$_reduce_4",N(!0)),w(l,"$_reduce_6",function(ae,ue,Ce){return q(f("Node"),"UndecidedTarget").$instance()}),w(l,"$_reduce_7",function(ae,ue,Ce){var y,W,we,De,Fe;return we=ae["$[]"](0),W=this.$expand_negate("+",ae["$[]"](2)),De=(y=A(W))[0]??z,Fe=y[1]??z,q(f("Node"),"BinaryOp").$new(we,De,Fe)}),w(l,"$_reduce_8",function(ae,ue,Ce){var y,W,we,De,Fe;return we=ae["$[]"](0),W=this.$expand_negate("-",ae["$[]"](2)),De=(y=A(W))[0]??z,Fe=y[1]??z,q(f("Node"),"BinaryOp").$new(we,De,Fe)}),w(l,"$_reduce_10",function(ae,ue,Ce){var y,W;return y=ae["$[]"](0),W=ae["$[]"](2),q(f("Node"),"BinaryOp").$new(y,"*",W)}),w(l,"$_reduce_11",function(ae,ue,Ce){var y,W;return y=ae["$[]"](0),W=ae["$[]"](2),ae["$[]"](3).$new(y,W)}),w(l,"$_reduce_13",function(ae,ue,Ce){return q(f("Node"),"DivideWithGameSystemDefault")}),w(l,"$_reduce_14",function(ae,ue,Ce){return q(f("Node"),"DivideWithRoundingDown")}),w(l,"$_reduce_15",function(ae,ue,Ce){return q(f("Node"),"DivideWithRoundingUp")}),w(l,"$_reduce_16",function(ae,ue,Ce){return q(f("Node"),"DivideWithRoundingUp")}),w(l,"$_reduce_17",function(ae,ue,Ce){return q(f("Node"),"DivideWithRoundingOff")}),w(l,"$_reduce_18",function(ae,ue,Ce){return ae["$[]"](1)}),w(l,"$_reduce_19",function(ae,ue,Ce){var y=z;return y=ae["$[]"](1),O(y["$is_a?"](q(f("Node"),"Negate")))?y.$body():q(f("Node"),"Negate").$new(y)}),w(l,"$_reduce_21",function(ae,ue,Ce){var W=z,pe=z;return W=ae["$[]"](0),pe=ae["$[]"](2),(O(W["$include_dice?"]())||O(pe["$include_dice?"]()))&&this.$raise(f("ParseError")),q(f("Node"),"DiceRoll").$new(W,pe)}),w(l,"$_reduce_22",function(ae,ue,Ce){var W=z;return W=ae["$[]"](0),O(W["$include_dice?"]())&&this.$raise(f("ParseError")),q(f("Node"),"ImplicitSidesDiceRoll").$new(W)}),w(l,"$_reduce_23",function(ae,ue,Ce){var we,W=z,pe=z,De=z;return W=ae["$[]"](0),pe=ae["$[]"](2),we=ae["$[]"](3)["$[]"]("filter"),De=ae["$[]"](3)["$[]"]("n_filtering"),Y(pe,"implicit")&&O(pe["$include_dice?"]())&&this.$raise(f("ParseError")),(O(W["$include_dice?"]())||O(De["$include_dice?"]()))&&this.$raise(f("ParseError")),q(f("Node"),"DiceRollWithFilter").$new(W,pe,De,we)}),w(l,"$_reduce_24",function(ae,ue,Ce){var W,pe=z;return W=q(f("Node"),"Number").$new(1),pe=ae["$[]"](1),O(pe["$include_dice?"]())&&this.$raise(f("ParseError")),O(pe["$instance_of?"](q(f("Node"),"Number")))&&x(pe.$literal(),66)&&this.$raise(f("ParseError")),q(f("Node"),"DiceRoll").$new(W,pe)}),w(l,"$_reduce_25",function(ae,ue,Ce){var W,we,y=this,pe=z,De=z;return W=q(f("Node"),"Number").$new(1),pe=ae["$[]"](1),we=ae["$[]"](2)["$[]"]("filter"),De=ae["$[]"](2)["$[]"]("n_filtering"),Y(pe,"implicit")&&O(pe["$include_dice?"]())&&y.$raise(f("ParseError")),O(De["$include_dice?"]())&&y.$raise(f("ParseError")),O(pe["$instance_of?"](q(f("Node"),"Number")))&&x(pe.$literal(),66)&&y.$raise(f("ParseError")),q(f("Node"),"DiceRollWithFilter").$new(W,pe,De,we)}),w(l,"$_reduce_27",N("implicit")),w(l,"$_reduce_28",function(ae,ue,Ce){return ae["$[]"](0)}),w(l,"$_reduce_29",function(ae,ue,Ce){return T(["filter","n_filtering"],{filter:ae["$[]"](0),n_filtering:ae["$[]"](1)})}),w(l,"$_reduce_30",function(ae,ue,Ce){return T(["filter","n_filtering"],{filter:ae["$[]"](0),n_filtering:q(f("Node"),"Number").$new(1)})}),w(l,"$_reduce_31",function(ae,ue,Ce){return q(q(f("Node"),"DiceRollWithFilter"),"KEEP_HIGHEST")}),w(l,"$_reduce_32",function(ae,ue,Ce){return q(q(f("Node"),"DiceRollWithFilter"),"KEEP_LOWEST")}),w(l,"$_reduce_33",function(ae,ue,Ce){return q(q(f("Node"),"DiceRollWithFilter"),"KEEP_HIGHEST")}),w(l,"$_reduce_34",function(ae,ue,Ce){return q(q(f("Node"),"DiceRollWithFilter"),"KEEP_LOWEST")}),w(l,"$_reduce_35",function(ae,ue,Ce){return q(q(f("Node"),"DiceRollWithFilter"),"DROP_HIGHEST")}),w(l,"$_reduce_36",function(ae,ue,Ce){return q(q(f("Node"),"DiceRollWithFilter"),"DROP_LOWEST")}),w(l,"$_reduce_39",function(ae,ue,Ce){return q(f("Node"),"Parenthesis").$new(ae["$[]"](1))}),w(l,"$_reduce_40",function(ae,ue,Ce){return q(f("Node"),"Number").$new(ae["$[]"](0))}),w(l,"$_reduce_none",function(ae,ue,Ce){return ae["$[]"](0)})},Opal.modules["bcdice/common_command/add_dice/randomizer"]=function(d){var N,re,M,k,v,P,B,te,X,q,T,H=d.module,J=d.klass,_=d.const_set,w=d.def,O=d.eqeq,x=d.send,K=d.truthy,V=[],A=d.nil;return N=V,re=T=[H(V[0],"BCDice")].concat(N),M=q=[H(T[0],"CommonCommand")].concat(re),k=X=[H(q[0],"AddDice")].concat(M),P=[v=J(X[0],null,"Randomizer")].concat(k),B=d.$r(P),(te=v.$$prototype).game_system=te.rand_source=te.rand_results=A,v.$attr_reader("rand_results"),_(P[0],"RandResult",B("Struct").$new("sides","value")),w(v,"$initialize",function(fe,R){var F=this;return F.rand_source=fe,F.game_system=R,F.rand_results=[]}),w(v,"$roll",function(fe,R){var l,F=this,g=A;return g=O(R,66)?x(B("Array"),"new",[fe],function c(){var f=c.$$s??this;return null==f.rand_source&&(f.rand_source=A),null==f.game_system&&(f.game_system=A),f.rand_source.$roll_d66(f.game_system.$d66_sort_type())},{$$s:F}):O(R,9)&&K(F.game_system["$enabled_d9?"]())?x(B("Array"),"new",[fe],function c(){var f=c.$$s??this;return null==f.rand_source&&(f.rand_source=A),f.rand_source.$roll_d9()},{$$s:F}):F.rand_source.$roll_barabara(fe,R),K(F.game_system["$sort_add_dice?"]())&&g["$sort!"](),l=x(g,"map",[],function(f){return null==f&&(f=A),B("RandResult").$new(R,f)}),F.rand_results.$concat(l),g})},Opal.modules["bcdice/common_command/add_dice"]=function(d){var A,T,q,I,L,S,Z,M,re,N,H=d.module,J=d.const_set,_=d.thrower,w=d.def,O=d.top,x=[],K=d.nil;return O.$require("bcdice/normalize"),O.$require("bcdice/common_command/add_dice/parser"),O.$require("bcdice/common_command/add_dice/randomizer"),A=x,T=N=[H(x[0],"BCDice")].concat(A),q=re=[H(N[0],"CommonCommand")].concat(T),J((M=[Z=H(re[0],"AddDice")].concat(q))[0],"PREFIX_PATTERN",/[+\-(]*(\d+|D\d+)/.$freeze()),L=[I=d.get_singleton_class(Z)].concat(M),S=d.$r(L),w(I,"$eval",function(v,P,B){try{var D;return _("eval_return"),(D=S("Parser").$parse(v))===K||null==D?K:D.$eval(P,B)}catch(R){if(R===d.t_eval_return)return R.$v;throw R}})},Opal.modules["bcdice/common_command/reroll_dice/node"]=function(d){var Z,L,P,fe,c,f,u,p,m,F,te,k,I,H=d.module,J=d.klass,_=d.ensure_kwargs,w=d.get_kwarg,O=d.def,x=d.truthy,K=d.send,V=d.thrower,A=d.rb_lt,U=d.rb_plus,N=d.rb_gt,Y=d.eqeq,T=d.rb_le,j=d.rb_ge,re=[],z=d.nil;return Z=re,L=I=[H(re[0],"BCDice")].concat(Z),P=k=[H(I[0],"CommonCommand")].concat(L),fe=te=[H(k[0],"RerollDice")].concat(P),c=F=[H(te[0],"Node")].concat(fe),u=[f=J(F[0],null,"Command")].concat(c),p=d.$r(u),(m=f.$$prototype).cmp_op=m.reroll_cmp_op=m.target_number_node=m.reroll_threshold_node=m.notations=m.source=z,O(f,"$initialize",function($){var ie,se,Ee,Ie,ce,Me,$e,ye=this;return $=_($),ie=w($,"secret"),se=w($,"notations"),Ee=w($,"source"),null==(Ie=$.$$smap.cmp_op)&&(Ie=z),null==(ce=$.$$smap.target_number)&&(ce=z),null==(Me=$.$$smap.reroll_cmp_op)&&(Me=z),null==($e=$.$$smap.reroll_threshold)&&($e=z),ye.secret=ie,ye.notations=se,ye.cmp_op=Ie,ye.target_number_node=ce,ye.reroll_cmp_op=Me,ye.reroll_threshold_node=$e,ye.source=Ee}),O(f,"$eval",function($,ie){try{V("eval_return");var Ee,Ie,Me,$e,he,be,ae,Ce,ce=this,ye=z,Se=z,ue=z,y=z,W=z,pe=z,we=z,De=z;return Me=$.$round_type(),$e=x(ye=ce.cmp_op)?ye:$.$default_cmp_op(),he=x(ye=x(Se=ce.reroll_cmp_op)?Se:$e)?ye:">=",be=x(ye=(Ee=ce.target_number_node)===z||null==Ee?z:Ee.$eval(Me))?ye:$.$default_target_number(),ae=x(ye=x(Se=(Ie=ce.reroll_threshold_node)===z||null==Ie?z:Ie.$eval(Me))?Se:$.$reroll_dice_reroll_threshold())?ye:be,ue=p("RerollCondition").$new(he,ae),Ce=K(ce.notations,"map",[],function(Ye){return null==Ye&&(Ye=z),Ye.$to_dice(Me)}),x(K(Ce,"all?",[],function(Ye){return null==Ye&&(Ye=z),ue["$valid?"](Ye.$sides())}))?(W=(y=ce.$roll(Ce,ie,ue,$["$sort_barabara_dice?"]())).$flatten(),pe=y.$take(ce.notations.$size()).$flatten().$count(1),we=x($e)?K(W,"count",[],function(Ye){return null==Ye&&(Ye=z),Ye.$send($e,be)}):0,De=[ce.$expr(Me,ue,$e,be),K(y,"map",[],function(Ye){return null==Ye&&(Ye=z),Ye.$join(",")}).$join(" + "),"\u6210\u529f\u6570"+we,$.$grich_text(pe,W.$size(),we)].$compact(),ce.$result_with_text(De.$join(" \uff1e "))):ce.$result_with_text(ce.source+" \uff1e \u6761\u4ef6\u304c\u9593\u9055\u3063\u3066\u3044\u307e\u3059\u30022R6>=5 \u3042\u308b\u3044\u306f 2R6[5] \u306e\u3088\u3046\u306b\u632f\u308a\u8db3\u3057\u76ee\u6a19\u5024\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002")}catch(Fe){if(Fe===d.t_eval_return)return Fe.$v;throw Fe}}),f.$private(),O(f,"$roll",function($,ie,se,Ee){var Ie=z,ce=z,Me=z,$e=z,ye=z,he=z;for(Ie=[],ce=0;x(x(Me=$["$empty?"]()["$!"]())?A(ce,p("REROLL_LIMIT")):Me);)$e=$.$shift(),ce=U(ce,1),ye=$e.$roll(ie),x(Ee)&&ye["$sort!"](),Ie.$push(ye),he=K(ye,"count",[],function(be){return null==be&&(be=z),se["$reroll?"](be)}),x(N(he,0))&&$.$push(p("Dice").$new(he,$e.$sides()));return Ie}),O(f,"$expr",function($,ie,se,Ee){var ce,Me,$e;return ce=K(this.notations,"map",[],function(he){return null==he&&(he=z),he.$to_dice($)}).$join("+"),Me=Y(ie.$cmp_op(),se)?"":p("Format").$comparison_operator(ie.$cmp_op()),$e=p("Format").$comparison_operator(se),"("+ce+"["+Me+ie.$threshold()+"]"+$e+Ee+")"}),O(f,"$result_with_text",function($){return K(p("Result").$new(),"tap",[],function se(Ee){var Ie,ce=se.$$s??this;return null==ce.secret&&(ce.secret=z),null==Ee&&(Ee=z),Ee["$secret="](ce.secret),K(Ee,"text=",Ie=[$]),Ie[Ie.length-1]},{$$s:this})}),function(g,l){var c=J(g,null,"RerollCondition"),f=c.$$prototype;f.threshold=f.cmp_op=z,c.$attr_reader("cmp_op"),c.$attr_reader("threshold"),O(c,"$initialize",function(p,m){return this.cmp_op=p,this.threshold=m}),O(c,"$valid?",function(p){var m=this;if(!x(m.threshold))return!1;switch(m.cmp_op){case"<=":return A(m.threshold,p);case"<":return T(m.threshold,p);case">=":return N(m.threshold,1);case">":return j(m.threshold,1);case"!=":return d.Range.$new(1,p,!1)["$include?"](m.threshold);default:return!0}}),O(c,"$reroll?",function(p){return p.$send(this.cmp_op,this.threshold)})}(F[0]),function(g,l,c){var f=J(g,null,"Notation"),u=[f].concat(c),p=d.$r(u),m=f.$$prototype;m.times=m.sides=z,O(f,"$initialize",function($,ie){return this.times=$,this.sides=ie}),O(f,"$to_dice",function($){try{var Ee,Ie;return V("eval_return"),Ee=this.times.$eval($),Ie=this.sides.$eval($),p("Dice").$new(Ee,Ie)}catch(ce){if(ce===d.t_eval_return)return ce.$v;throw ce}})}(F[0],0,F),function(g,l){var c=J(g,null,"Dice");return c.$attr_reader("times","sides"),O(c,"$initialize",function(u,p){return this.times=u,this.sides=p}),O(c,"$roll",function(u){return u.$roll_barabara(this.$times(),this.$sides())}),O(c,"$to_s",function(){return this.$times()+"R"+this.$sides()})}(F[0])},Opal.modules["bcdice/arithmetic/node"]=function(d){var M,S,B,g,l,D,fe,v,X,H=d.module,J=d.klass,_=d.def,w=d.thrower,O=d.return_ivar,x=d.send2,K=d.find_super,V=d.eqeq,A=d.const_set,U=d.eqeqeq,N=d.rb_divide,Y=d.truthy,T=d.assign_ivar,j=d.alias,re=[],z=d.nil,q=d.$$$;return M=re,S=X=[H(re[0],"BCDice")].concat(M),B=v=[H(X[0],"Arithmetic")].concat(S),D=[H(v[0],"Node")].concat(B),fe=d.$r(D),(l=(g=J(D[0],null,"BinaryOp")).$$prototype).lhs=l.rhs=l.op=z,_(g,"$initialize",function(f,u,p){var m=this;return m.lhs=f,m.op=u,m.rhs=p}),_(g,"$eval",function(f){try{w("eval_return");var C,p=this,m=z;return m=p.lhs.$eval(f),C=p.rhs.$eval(f),m.$send(p.op,C)}catch($){if($===d.t_eval_return)return $.$v;throw $}}),_(g,"$output",function(){var f=this;return""+f.lhs.$output()+f.op+f.rhs.$output()}),_(g,"$s_exp",function(){var f=this;return"("+f.$op_for_s_exp()+" "+f.lhs.$s_exp()+" "+f.rhs.$s_exp()+")"}),_(g,"$op_for_s_exp",O("op")),function(R,F,g){var l=J(R,F,"DivideBase"),c=[l].concat(g),f=d.$r(c),u=l.$$prototype;u.lhs=u.rhs=u.op=z,_(l,"$initialize",function p(m,C){return p.$$p=null,x(this,K(this,"initialize",p,!1,!0),"initialize",[m,"/",C],null)}),_(l,"$eval",function(m){try{w("eval_return");var ie,se,$=this;return ie=$.lhs.$eval(m),se=$.rhs.$eval(m),V(se,0)&&$.$raise(f("ZeroDivisionError")),$.$divide_and_round(ie,se,m)}catch(Ee){if(Ee===d.t_eval_return)return Ee.$v;throw Ee}}),_(l,"$output",function p(){var m=p.$$p||z,C=this;return p.$$p=null,""+x(C,K(C,"output",p,!1,!0),"output",[],m)+C.$rounding_method()}),l.$private(),_(l,"$rounding_method",function(){return q(this.$class(),"ROUNDING_METHOD")}),_(l,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),_(l,"$divide_and_round",function(m,C,$){return this.$raise(f("NotImplementedError"))})}(D[0],fe("BinaryOp"),D),function(R,F,g){var l=J(R,F,"DivideWithGameSystemDefault"),c=[l].concat(g),f=d.$r(c);A(c[0],"ROUNDING_METHOD",""),l.$private(),_(l,"$divide_and_round",function(p,m,C){var $,ie=z;return U(q(f("RoundType"),"CEIL"),$=C)?N(p.$to_f(),m).$ceil():U(q(f("RoundType"),"ROUND"),$)?(ie=N(p.$to_f(),m),Y(ie["$negative?"]())?ie.$abs().$round()["$-@"]():ie.$round()):N(p,m).$floor()})}(D[0],fe("DivideBase"),D),function(R,F,g){var l=J(R,F,"DivideWithCeil"),c=[l].concat(g);A(c[0],"ROUNDING_METHOD","C"),l.$private(),_(l,"$divide_and_round",function(u,p,m){return N(u.$to_f(),p).$ceil()})}(D[0],fe("DivideBase"),D),function(R,F,g){var l=J(R,F,"DivideWithRound"),c=[l].concat(g);A(c[0],"ROUNDING_METHOD","R"),l.$private(),_(l,"$divide_and_round",function(u,p,m){var C=z;return C=N(u.$to_f(),p),Y(C["$negative?"]())?C.$abs().$round()["$-@"]():C.$round()})}(D[0],fe("DivideBase"),D),function(R,F,g){var l=J(R,F,"DivideWithFloor"),c=[l].concat(g);A(c[0],"ROUNDING_METHOD","F"),l.$private(),_(l,"$divide_and_round",function(u,p,m){return N(u,p).$floor()})}(D[0],fe("DivideBase"),D),function(R,F){var g=J(R,null,"Negative");g.$$prototype.body=z,_(g,"$initialize",T("body")),_(g,"$eval",function(f){try{return w("eval_return"),this.body.$eval(f)["$-@"]()}catch(m){if(m===d.t_eval_return)return m.$v;throw m}}),_(g,"$output",function(){return"-"+this.body.$output()}),_(g,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(D[0]),function(R,F){var g=J(R,null,"Parenthesis");g.$$prototype.expr=z,_(g,"$initialize",T("expr")),_(g,"$eval",function(f){try{return w("eval_return"),this.expr.$eval(f)}catch(m){if(m===d.t_eval_return)return m.$v;throw m}}),_(g,"$output",function(){return"("+this.expr.$output()+")"}),_(g,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(D[0]),function(R,F){var g=J(R,null,"Number");return g.$$prototype.value=z,_(g,"$initialize",T("value")),_(g,"$eval",O("value")),_(g,"$output",function(){return this.value.$to_s()}),j(g,"s_exp","output")}(D[0])},Opal.modules["bcdice/common_command/barabara_dice/parser"]=function(d){var z,I,k,fe,l,c,f,u,p,m,C,$,ie,Ie,R,F,g,P,B,L,Z,H=d.module,J=d.klass,_=d.defs,w=d.def,O=d.hash,x=d.const_set,K=d.hash2,V=d.return_val,A=d.to_ary,U=d.truthy,N=d.top,Y=[],T=d.nil,j=d.$$$;return N.$require("racc/parser.rb"),N.$require("bcdice/common_command/lexer"),N.$require("bcdice/common_command/reroll_dice/node"),N.$require("bcdice/arithmetic/node"),z=Y,I=Z=[H(Y[0],"BCDice")].concat(z),k=L=[H(Z[0],"CommonCommand")].concat(I),P=[H(L[0],"BarabaraDice")].concat(k),B=d.$r(P),fe=P,F=[R=J(P[0],j(B("Racc"),"Parser"),"Parser")].concat(fe),g=d.$r(F),R.$$prototype.lexer=T,_(R,"$parse",function(he){return this.$new().$parse(he)}),w(R,"$parse",function(he){try{return this.lexer=g("Lexer").$new(he),this.$do_parse()}catch(be){if(!d.rescue(be,[g("ParseError")]))throw be;try{return T}finally{d.pop_exception()}}}),R.$private(),w(R,"$next_token",function(){return this.lexer.$next_token()}),l=d.large_array_unpack("13,9,3,9,24,25,9,9,9,26,18,19,8,12,8,18,19,8,8,8,9,4,9,38,36,37,39,18,19,18,19,8,9,8,9,27,28,24,25,18,19,18,19,8,9,8,9,27,28,27,28,18,19,18,19,8,10,8,14"),c=d.large_array_unpack("5,2,0,8,15,15,13,14,12,15,8,8,2,5,8,12,12,13,14,12,18,1,19,34,34,34,34,18,18,19,19,18,24,19,25,16,16,21,21,24,24,25,25,24,27,25,28,31,31,32,32,27,27,28,28,27,4,28,7"),f=d.large_array_unpack("-6,21,-1,,56,-9,,55,1,,,,6,4,5,-5,24,,18,20,,28,,,30,32,,42,44,,,36,38,,19,,,,,"),u=d.large_array_unpack("-2,-25,-25,-3,-25,-4,-7,-25,-25,-24,40,-1,-25,-25,-25,-25,-11,-14,-25,-25,-22,-5,-6,-8,-25,-25,-23,-25,-25,-20,-21,-9,-10,-12,-15,-13,-16,-17,-18,-19"),p=[7,1,6,15,2,29,30,21,31,32,5,7,23,22,33,34,11,35],m=[7,1,6,5,2,9,9,5,8,8,3,7,7,6,9,9,4,10],C=[T,1,4,8,11,-5,0,-2,-16,-13,-17],$=[T,T,T,T,T,T,T,20,16,17,T],ie=d.large_array_unpack("0,0,racc_error,3,24,_reduce_1,0,25,_reduce_2,1,25,_reduce_3,0,27,_reduce_4,2,27,_reduce_5,3,26,_reduce_6,1,26,_reduce_7,3,29,_reduce_8,3,28,_reduce_9,3,28,_reduce_10,1,28,_reduce_none,3,31,_reduce_12,4,31,_reduce_13,1,31,_reduce_none,0,33,_reduce_15,1,33,_reduce_16,1,33,_reduce_17,1,33,_reduce_18,1,33,_reduce_19,2,32,_reduce_20,2,32,_reduce_21,1,32,_reduce_none,3,30,_reduce_23,1,30,_reduce_24"),Ie=O(!1,0,"error",1,"NUMBER",2,"B",3,"R",4,"U",5,"C",6,"F",7,"S",8,"PLUS",9,"MINUS",10,"ASTERISK",11,"SLASH",12,"PARENL",13,"PARENR",14,"BRACKETL",15,"BRACKETR",16,"LESS",17,"GREATER",18,"EQUAL",19,"NOT",20,"AT",21,"CMP_OP",22),x(F[0],"Racc_arg",[l,c,u,f,p,m,$,C,23,ie,Ie,40,25,!0]),x(F[0],"Racc_token_to_s_table",d.large_array_unpack("$end,error,NUMBER,B,R,U,C,F,S,PLUS,MINUS,ASTERISK,SLASH,PARENL,PARENR,BRACKETL,BRACKETR,LESS,GREATER,EQUAL,NOT,AT,CMP_OP,$start,expr,secret,notations,target,add,dice,term,mul,unary,round_type")),x(F[0],"Racc_debug_parser",!1),w(R,"$_reduce_1",function(he,Se,be){return j(g("Node"),"Command").$new(K(["secret","notations","cmp_op","target_number"],{secret:he["$[]"](0),notations:he["$[]"](1),cmp_op:he["$[]"](2)["$[]"]("cmp_op"),target_number:he["$[]"](2)["$[]"]("target")}))}),w(R,"$_reduce_2",V(!1)),w(R,"$_reduce_3",V(!0)),w(R,"$_reduce_4",function(he,Se,be){return K([],{})}),w(R,"$_reduce_5",function(he,Se,be){var ae,y,W;return W=(ae=A(he))[1]??T,U(y=ae[0]??T)||this.$raise(g("ParseError")),K(["cmp_op","target"],{cmp_op:y,target:W})}),w(R,"$_reduce_6",function(he,Se,be){var ae=T;return(ae=he["$[]"](0)).$push(he["$[]"](2)),ae}),w(R,"$_reduce_7",function(he,Se,be){return[he["$[]"](0)]}),w(R,"$_reduce_8",function(he,Se,be){var ae,ue;return ae=he["$[]"](0),ue=he["$[]"](2),j(g("Node"),"Notation").$new(ae,ue)}),w(R,"$_reduce_9",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"+",he["$[]"](2))}),w(R,"$_reduce_10",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"-",he["$[]"](2))}),w(R,"$_reduce_12",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"*",he["$[]"](2))}),w(R,"$_reduce_13",function(he,Se,be){return he["$[]"](3).$new(he["$[]"](0),he["$[]"](2))}),w(R,"$_reduce_15",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),w(R,"$_reduce_16",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"DivideWithCeil")}),w(R,"$_reduce_17",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"DivideWithCeil")}),w(R,"$_reduce_18",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"DivideWithRound")}),w(R,"$_reduce_19",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"DivideWithFloor")}),w(R,"$_reduce_20",function(he,Se,be){return he["$[]"](1)}),w(R,"$_reduce_21",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"Negative").$new(he["$[]"](1))}),w(R,"$_reduce_23",function(he,Se,be){return he["$[]"](1)}),w(R,"$_reduce_24",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"Number").$new(he["$[]"](0))}),w(R,"$_reduce_none",function(he,Se,be){return he["$[]"](0)})},Opal.modules["bcdice/common_command/barabara_dice"]=function(d){var A,T,q,I,L,S,Z,M,re,N,H=d.module,J=d.const_set,_=d.thrower,w=d.def,x=[],K=d.nil;return d.top.$require("bcdice/common_command/barabara_dice/parser"),A=x,T=N=[H(x[0],"BCDice")].concat(A),q=re=[H(N[0],"CommonCommand")].concat(T),J((M=[Z=H(re[0],"BarabaraDice")].concat(q))[0],"PREFIX_PATTERN",/\d+B\d+/.$freeze()),L=[I=d.get_singleton_class(Z)].concat(M),S=d.$r(L),w(I,"$eval",function(v,P,B){try{var D;return _("eval_return"),(D=S("Parser").$parse(v))===K||null==D?K:D.$eval(P,B)}catch(R){if(R===d.t_eval_return)return R.$v;throw R}})},Opal.modules["bcdice/result"]=function(d){var re,Z,z,U,Y,J=d.klass,_=d.send,w=d.def,O=d.return_val,x=d.return_ivar,K=[],V=d.nil;return U=K,re=Y=[(0,d.module)(K[0],"BCDice")].concat(U),[z=J(Y[0],null,"Result")].concat(re),w(Z=d.get_singleton_class(z),"$success",function(X){return _(this.$new(),"tap",[],function(k){var v;return null==k&&(k=V),k["$text="](X),_(k,"success=",v=[!0]),v[v.length-1]})}),w(Z,"$failure",function(X){return _(this.$new(),"tap",[],function(k){var v;return null==k&&(k=V),k["$text="](X),_(k,"failure=",v=[!0]),v[v.length-1]})}),w(Z,"$critical",function(X){return _(this.$new(),"tap",[],function(k){var v;return null==k&&(k=V),k["$text="](X),k["$critical="](!0),_(k,"success=",v=[!0]),v[v.length-1]})}),w(Z,"$fumble",function(X){return _(this.$new(),"tap",[],function(k){var v;return null==k&&(k=V),k["$text="](X),k["$fumble="](!0),_(k,"failure=",v=[!0]),v[v.length-1]})}),w(Z,"$nothing",O("nothing")),w(z,"$initialize",function(M){var I=this;return null==M&&(M=V),I.text=M,I.rands=V,I.detailed_rands=V,I.secret=!1,I.success=!1,I.failure=!1,I.critical=!1,I.fumble=!1},-1),z.$attr_accessor("text","rands","detailed_rands"),z.$attr_writer("secret","success","failure","critical","fumble"),w(z,"$secret?",x("secret")),w(z,"$success?",x("success")),w(z,"$failure?",x("failure")),w(z,"$critical?",x("critical")),w(z,"$fumble?",x("fumble")),w(z,"$condition=",function(M){return this.success=M,this.failure=M["$!"]()})},Opal.modules["bcdice/common_command/tally_dice/node"]=function(d){var M,S,B,R,f,u,p,m,g,D,v,X,H=d.module,J=d.klass,_=d.const_set,w=d.ensure_kwargs,O=d.get_kwarg,x=d.def,K=d.truthy,V=d.rb_gt,A=d.send,U=d.not,N=d.eqeq,Y=d.hash2,T=d.thrower,j=d.alias,z=[],q=d.nil;return d.top.$require("bcdice/result"),M=z,S=X=[H(z[0],"BCDice")].concat(M),B=v=[H(X[0],"CommonCommand")].concat(S),R=D=[H(v[0],"TallyDice")].concat(B),f=g=[H(D[0],"Node")].concat(R),p=[u=J(g[0],null,"Command")].concat(f),m=d.$r(p),u.$$prototype.notation=q,_(p[0],"MAX_SIDES",20),x(u,"$initialize",function(ie){var se,Ee;return ie=w(ie),se=O(ie,"secret"),Ee=O(ie,"notation"),this.secret=se,this.notation=Ee}),x(u,"$eval",function(ie,se){var Ie=q,ce=q,Me=q,$e=q,ye=q,he=q;return Ie=this.notation.$to_dice(ie.$round_type()),K(Ie["$valid?"]())?K(V(Ie.$sides(),m("MAX_SIDES")))?m("Result").$new("("+Ie+") \uff1e \u9762\u6570\u306f1\u4ee5\u4e0a\u3001"+m("MAX_SIDES")+"\u4ee5\u4e0b\u3068\u3057\u3066\u304f\u3060\u3055\u3044"):(ce=Ie.$roll(se),Me=(K(ie["$sort_barabara_dice?"]())?ce.$sort():ce).$join(","),$e=A(A(ce,"group_by",[],"itself".$to_proc()),"transform_values",[],"length".$to_proc()),ye=A(d.Range.$new(1,Ie.$sides(),!1),"map",[],function(be){var ae;return null==be&&(be=q),ae=$e.$fetch(be,0),N(ae,0)&&U(Ie["$show_zeros?"]())?q:"["+be+"]\xd7"+$e.$fetch(be,0)}),he=["("+Ie+")",Me,ye.$compact().$join(", ")].$compact(),A(m("Result").$new(),"tap",[],function Se(be){var ae,ue=Se.$$s??this;return null==ue.secret&&(ue.secret=q),null==be&&(be=q),be["$secret="](ue.secret),ae=[he.$join(" \uff1e ")],A(be,"text=",ae),ae[ae.length-1]},{$$s:this})):q}),function(l,c,f){var u=J(l,null,"Notation"),p=[u].concat(f),m=d.$r(p),C=u.$$prototype;C.times=C.sides=C.show_zeros=q,u.$attr_reader("times"),u.$attr_reader("sides"),u.$attr_reader("show_zeros"),x(u,"$initialize",function(ie){var se,Ee,Ie;return ie=w(ie),se=O(ie,"times"),Ee=O(ie,"sides"),Ie=O(ie,"show_zeros"),this.times=se,this.sides=Ee,this.show_zeros=Ie}),x(u,"$to_dice",function(ie){try{var Ie,ce;return T("eval_return"),Ie=this.times.$eval(ie),ce=this.sides.$eval(ie),m("Dice").$new(Y(["times","sides","show_zeros"],{times:Ie,sides:ce,show_zeros:this.show_zeros}))}catch(Me){if(Me===d.t_eval_return)return Me.$v;throw Me}})}(g[0],0,g),function(l,c){var f=J(l,null,"Dice"),u=f.$$prototype;return u.times=u.sides=u.show_zeros=q,f.$attr_reader("times"),f.$attr_reader("sides"),f.$attr_reader("show_zeros"),j(f,"show_zeros?","show_zeros"),x(f,"$initialize",function(m){var C,$,ie;return m=w(m),C=O(m,"times"),$=O(m,"sides"),ie=O(m,"show_zeros"),this.times=C,this.sides=$,this.show_zeros=ie}),x(f,"$valid?",function(){var C;return K(C=V(this.times,0))?V(this.sides,0):C}),x(f,"$roll",function(m){return m.$roll_barabara(this.times,this.sides)}),x(f,"$to_s",function(){var C,m=this;return C=K(m.show_zeros)?"Z":"Y",m.times+"T"+C+m.sides})}(g[0])},Opal.modules["bcdice/common_command/tally_dice/parser"]=function(d){var j,Z,L,te,F,g,l,c,f,u,p,m,C,se,D,fe,R,k,v,I,z,H=d.module,J=d.klass,_=d.defs,w=d.def,O=d.hash,x=d.const_set,K=d.hash2,V=d.return_val,A=d.top,U=[],N=d.nil,Y=d.$$$;return A.$require("racc/parser.rb"),A.$require("bcdice/common_command/lexer"),A.$require("bcdice/common_command/tally_dice/node"),A.$require("bcdice/arithmetic/node"),j=U,Z=z=[H(U[0],"BCDice")].concat(j),L=I=[H(z[0],"CommonCommand")].concat(Z),k=[H(I[0],"TallyDice")].concat(L),v=d.$r(k),te=k,fe=[D=J(k[0],Y(v("Racc"),"Parser"),"Parser")].concat(te),R=d.$r(fe),D.$$prototype.lexer=N,_(D,"$parse",function($e){return this.$new().$parse($e)}),w(D,"$parse",function($e){try{return this.lexer=R("Lexer").$new($e),this.$do_parse()}catch(he){if(!d.rescue(he,[R("ParseError")]))throw he;try{return N}finally{d.pop_exception()}}}),D.$private(),w(D,"$next_token",function(){return this.lexer.$next_token()}),F=d.large_array_unpack("8,8,18,19,20,21,8,8,8,22,14,15,3,7,7,14,15,14,15,7,7,7,8,4,8,35,33,34,36,8,9,14,15,14,15,7,8,7,14,15,23,24,7,23,24,14,15,23,24,7,10"),g=d.large_array_unpack("2,7,10,10,11,11,14,17,15,11,7,7,0,2,7,14,14,15,15,14,17,15,20,1,21,31,31,31,31,23,4,20,20,21,21,20,24,21,23,23,12,12,23,28,28,24,24,29,29,24,6"),l=d.large_array_unpack("2,23,-2,,30,,47,-1,,,-2,-7,27,,4,6,,5,,,20,22,,27,34,,,,30,34,,19,,,,,"),c=d.large_array_unpack("-2,-23,-23,-3,-23,-1,-23,-23,-22,37,-23,-23,-9,-12,-23,-23,-20,-23,-5,-6,-23,-23,-21,-23,-23,-18,-19,-4,-7,-8,-10,-13,-11,-14,-15,-16,-17"),f=[6,25,26,12,1,2,5,17,11,32,30,31,N,N,N,27,28,29],u=[4,8,8,7,1,2,3,5,6,9,8,8,N,N,N,4,7,7],p=[N,4,5,4,-2,-3,1,-4,-13,-22],m=[N,N,N,N,16,N,N,N,13,N],C=d.large_array_unpack("0,0,racc_error,2,18,_reduce_1,0,19,_reduce_2,1,19,_reduce_3,4,20,_reduce_4,1,22,_reduce_5,1,22,_reduce_6,3,23,_reduce_7,3,23,_reduce_8,1,23,_reduce_none,3,24,_reduce_10,4,24,_reduce_11,1,24,_reduce_none,0,26,_reduce_13,1,26,_reduce_14,1,26,_reduce_15,1,26,_reduce_16,1,26,_reduce_17,2,25,_reduce_18,2,25,_reduce_19,1,25,_reduce_none,3,21,_reduce_21,1,21,_reduce_22"),se=O(!1,0,"error",1,"NUMBER",2,"T",3,"Y",4,"Z",5,"R",6,"U",7,"C",8,"F",9,"S",10,"PLUS",11,"MINUS",12,"ASTERISK",13,"SLASH",14,"PARENL",15,"PARENR",16),x(fe[0],"Racc_arg",[F,g,c,l,f,u,m,p,17,C,se,37,23,!0]),x(fe[0],"Racc_token_to_s_table",["$end","error","NUMBER","T","Y","Z","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","$start","expr","secret","notation","term","show_zeros","add","mul","unary","round_type"]),x(fe[0],"Racc_debug_parser",!1),w(D,"$_reduce_1",function($e,ye,he){return Y(R("Node"),"Command").$new(K(["secret","notation"],{secret:$e["$[]"](0),notation:$e["$[]"](1)}))}),w(D,"$_reduce_2",V(!1)),w(D,"$_reduce_3",V(!0)),w(D,"$_reduce_4",function($e,ye,he){return Y(R("Node"),"Notation").$new(K(["times","sides","show_zeros"],{times:$e["$[]"](0),sides:$e["$[]"](3),show_zeros:$e["$[]"](2)}))}),w(D,"$_reduce_5",V(!1)),w(D,"$_reduce_6",V(!0)),w(D,"$_reduce_7",function($e,ye,he){return Y(Y(R("Arithmetic"),"Node"),"BinaryOp").$new($e["$[]"](0),"+",$e["$[]"](2))}),w(D,"$_reduce_8",function($e,ye,he){return Y(Y(R("Arithmetic"),"Node"),"BinaryOp").$new($e["$[]"](0),"-",$e["$[]"](2))}),w(D,"$_reduce_10",function($e,ye,he){return Y(Y(R("Arithmetic"),"Node"),"BinaryOp").$new($e["$[]"](0),"*",$e["$[]"](2))}),w(D,"$_reduce_11",function($e,ye,he){return $e["$[]"](3).$new($e["$[]"](0),$e["$[]"](2))}),w(D,"$_reduce_13",function($e,ye,he){return Y(Y(R("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),w(D,"$_reduce_14",function($e,ye,he){return Y(Y(R("Arithmetic"),"Node"),"DivideWithCeil")}),w(D,"$_reduce_15",function($e,ye,he){return Y(Y(R("Arithmetic"),"Node"),"DivideWithCeil")}),w(D,"$_reduce_16",function($e,ye,he){return Y(Y(R("Arithmetic"),"Node"),"DivideWithRound")}),w(D,"$_reduce_17",function($e,ye,he){return Y(Y(R("Arithmetic"),"Node"),"DivideWithFloor")}),w(D,"$_reduce_18",function($e,ye,he){return $e["$[]"](1)}),w(D,"$_reduce_19",function($e,ye,he){return Y(Y(R("Arithmetic"),"Node"),"Negative").$new($e["$[]"](1))}),w(D,"$_reduce_21",function($e,ye,he){return $e["$[]"](1)}),w(D,"$_reduce_22",function($e,ye,he){return Y(Y(R("Arithmetic"),"Node"),"Number").$new($e["$[]"](0))}),w(D,"$_reduce_none",function($e,ye,he){return $e["$[]"](0)})},Opal.modules["bcdice/common_command/tally_dice"]=function(d){var A,T,q,I,L,S,Z,M,re,N,H=d.module,J=d.const_set,_=d.thrower,w=d.def,x=[],K=d.nil;return d.top.$require("bcdice/common_command/tally_dice/parser"),A=x,T=N=[H(x[0],"BCDice")].concat(A),q=re=[H(N[0],"CommonCommand")].concat(T),J((M=[Z=H(re[0],"TallyDice")].concat(q))[0],"PREFIX_PATTERN",/\d+T[YZ]\d+/.$freeze()),L=[I=d.get_singleton_class(Z)].concat(M),S=d.$r(L),w(I,"$eval",function(v,P,B){try{var D;return _("eval_return"),(D=S("Parser").$parse(v))===K||null==D?K:D.$eval(P,B)}catch(R){if(R===d.t_eval_return)return R.$v;throw R}})},Opal.modules["bcdice/common_command/calc/node"]=function(d){var j,Z,L,P,R,F,g,l,te,k,I,z,H=d.module,J=d.klass,_=d.ensure_kwargs,w=d.get_kwarg,O=d.def,x=d.truthy,K=d.send,V=d.thrower,U=[],N=d.nil,Y=d.$$$;return d.top.$require("bcdice/arithmetic/node"),j=U,Z=z=[H(U[0],"BCDice")].concat(j),L=I=[H(z[0],"CommonCommand")].concat(Z),P=k=[H(I[0],"Calc")].concat(L),R=te=[H(k[0],"Node")].concat(P),g=[F=J(te[0],null,"Command")].concat(R),l=d.$r(g),F.$$prototype.expr=N,O(F,"$initialize",function(u){var p,m;return u=_(u),p=w(u,"secret"),m=w(u,"expr"),this.secret=p,this.expr=m}),O(F,"$eval",function(u){try{V("eval_return");var C,$,m=this;return C=function(){try{return m.expr.$eval(u).$to_i()}catch(ie){if(!d.rescue(ie,[l("ZeroDivisionError")]))throw ie;try{return"\u30bc\u30ed\u9664\u7b97\u304c\u767a\u751f\u3057\u305f\u305f\u3081\u8a08\u7b97\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f"}finally{d.pop_exception()}}}(),$=x(m.expr["$is_a?"](Y(Y(l("Arithmetic"),"Node"),"Parenthesis")))?m.expr.$output():"("+m.expr.$output()+")",K(l("Result").$new(),"tap",[],function ie(se){var Ee,Ie=ie.$$s??this;return null==Ie.secret&&(Ie.secret=N),null==se&&(se=N),se["$secret="](Ie.secret),K(se,"text=",Ee=["c"+$+" \uff1e "+C]),Ee[Ee.length-1]},{$$s:m})}catch(ie){if(ie===d.t_eval_return)return ie.$v;throw ie}})},Opal.modules["bcdice/common_command/calc/parser"]=function(d){var j,Z,L,te,F,g,l,c,f,u,p,m,C,se,D,fe,R,k,v,I,z,H=d.module,J=d.klass,_=d.defs,w=d.def,O=d.hash,x=d.const_set,K=d.hash2,V=d.return_val,A=d.top,U=[],N=d.nil,Y=d.$$$;return A.$require("racc/parser.rb"),A.$require("bcdice/common_command/lexer"),A.$require("bcdice/common_command/calc/node"),A.$require("bcdice/arithmetic/node"),j=U,Z=z=[H(U[0],"BCDice")].concat(j),L=I=[H(z[0],"CommonCommand")].concat(Z),k=[H(I[0],"Calc")].concat(L),v=d.$r(k),te=k,fe=[D=J(k[0],Y(v("Racc"),"Parser"),"Parser")].concat(te),R=d.$r(fe),D.$$prototype.lexer=N,_(D,"$parse",function($e){return this.$new().$parse($e)}),w(D,"$parse",function($e){try{return this.lexer=R("Lexer").$new($e),this.$do_parse()}catch(he){if(!d.rescue(he,[R("ParseError")]))throw he;try{return N}finally{d.pop_exception()}}}),D.$private(),w(D,"$next_token",function(){return this.lexer.$next_token()}),F=d.large_array_unpack("14,3,14,15,16,4,10,11,10,11,13,14,13,14,17,18,5,10,11,10,11,13,14,13,14,17,18,6,10,11,10,11,13,14,13,14,17,18,,10,11,10,11,13,,13,15,16,,,,26,30,28,29,31"),g=d.large_array_unpack("5,0,10,7,7,1,5,5,10,10,5,11,10,13,8,8,2,11,11,13,13,11,15,13,16,22,22,4,15,15,16,16,15,17,16,18,23,23,,17,17,18,18,17,,18,21,21,,,,21,25,25,25,25"),l=[-6,5,11,N,27,-2,N,-5,4,N,0,9,N,11,N,20,22,31,33,N,N,38,15,26,N,49,N,N,N,N,N,N],c=[-2,-20,-20,-3,-20,-20,32,-1,-6,-9,-20,-20,-17,-20,-19,-20,-20,-20,-20,-15,-16,-20,-4,-5,-7,-10,-18,-8,-11,-12,-13,-14],f=[7,1,19,20,22,23,2,27,21,24,25],u=[3,1,5,5,4,4,2,6,3,5,5],p=[N,1,6,-5,-11,-8,-18,N],m=[N,N,N,N,8,9,N,12],C=d.large_array_unpack("0,0,racc_error,3,15,_reduce_1,0,16,_reduce_2,1,16,_reduce_3,3,17,_reduce_4,3,17,_reduce_5,1,17,_reduce_none,3,18,_reduce_7,4,18,_reduce_8,1,18,_reduce_none,0,20,_reduce_10,1,20,_reduce_11,1,20,_reduce_12,1,20,_reduce_13,1,20,_reduce_14,2,19,_reduce_15,2,19,_reduce_16,1,19,_reduce_none,3,21,_reduce_18,1,21,_reduce_19"),se=O(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"S",7,"PLUS",8,"MINUS",9,"ASTERISK",10,"SLASH",11,"PARENL",12,"PARENR",13),x(fe[0],"Racc_arg",[F,g,c,l,f,u,m,p,14,C,se,32,20,!0]),x(fe[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","$start","expr","secret","add","mul","unary","round_type","term"]),x(fe[0],"Racc_debug_parser",!1),w(D,"$_reduce_1",function($e,ye,he){return Y(R("Node"),"Command").$new(K(["secret","expr"],{secret:$e["$[]"](0),expr:$e["$[]"](2)}))}),w(D,"$_reduce_2",V(!1)),w(D,"$_reduce_3",V(!0)),w(D,"$_reduce_4",function($e,ye,he){return Y(Y(R("Arithmetic"),"Node"),"BinaryOp").$new($e["$[]"](0),"+",$e["$[]"](2))}),w(D,"$_reduce_5",function($e,ye,he){return Y(Y(R("Arithmetic"),"Node"),"BinaryOp").$new($e["$[]"](0),"-",$e["$[]"](2))}),w(D,"$_reduce_7",function($e,ye,he){return Y(Y(R("Arithmetic"),"Node"),"BinaryOp").$new($e["$[]"](0),"*",$e["$[]"](2))}),w(D,"$_reduce_8",function($e,ye,he){return $e["$[]"](3).$new($e["$[]"](0),$e["$[]"](2))}),w(D,"$_reduce_10",function($e,ye,he){return Y(Y(R("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),w(D,"$_reduce_11",function($e,ye,he){return Y(Y(R("Arithmetic"),"Node"),"DivideWithCeil")}),w(D,"$_reduce_12",function($e,ye,he){return Y(Y(R("Arithmetic"),"Node"),"DivideWithCeil")}),w(D,"$_reduce_13",function($e,ye,he){return Y(Y(R("Arithmetic"),"Node"),"DivideWithRound")}),w(D,"$_reduce_14",function($e,ye,he){return Y(Y(R("Arithmetic"),"Node"),"DivideWithFloor")}),w(D,"$_reduce_15",function($e,ye,he){return $e["$[]"](1)}),w(D,"$_reduce_16",function($e,ye,he){return Y(Y(R("Arithmetic"),"Node"),"Negative").$new($e["$[]"](1))}),w(D,"$_reduce_18",function($e,ye,he){return Y(Y(R("Arithmetic"),"Node"),"Parenthesis").$new($e["$[]"](1))}),w(D,"$_reduce_19",function($e,ye,he){return Y(Y(R("Arithmetic"),"Node"),"Number").$new($e["$[]"](0))}),w(D,"$_reduce_none",function($e,ye,he){return $e["$[]"](0)})},Opal.modules["bcdice/common_command/calc"]=function(d){var A,T,q,I,L,S,Z,M,re,N,H=d.module,J=d.const_set,_=d.thrower,w=d.def,x=[],K=d.nil;return d.top.$require("bcdice/common_command/calc/parser"),A=x,T=N=[H(x[0],"BCDice")].concat(A),q=re=[H(N[0],"CommonCommand")].concat(T),J((M=[Z=H(re[0],"Calc")].concat(q))[0],"PREFIX_PATTERN",/C[+\-(]*\d+/.$freeze()),L=[I=d.get_singleton_class(Z)].concat(M),S=d.$r(L),w(I,"$eval",function(v,P,B){try{var D;return _("eval_return"),(D=S("Parser").$parse(v))===K||null==D?K:D.$eval(P.$round_type())}catch(R){if(R===d.t_eval_return)return R.$v;throw R}})},Opal.modules["bcdice/common_command/choice"]=function(d){var I,k,D,c,u,fe,R,F,g,P,L,H=d.module,J=d.klass,_=d.const_set,w=d.hash2,O=d.def,x=d.truthy,K=d.eqeq,V=d.eqeqeq,A=d.send,U=d.rb_lt,N=d.thrower,Y=d.rb_gt,T=d.ensure_kwargs,j=d.get_kwarg,z=[],q=d.nil,Z=d.$$$;return d.top.$require("strscan"),I=z,k=L=[H(z[0],"BCDice")].concat(I),D=P=[H(L[0],"CommonCommand")].concat(k),R=[fe=J(P[0],null,"Choice")].concat(D),F=d.$r(R),(g=fe.$$prototype).items=g.takes=g.block_delimiter=q,_(R[0],"PREFIX_PATTERN",/choice/.$freeze()),c=R,_((u=[H(R[0],"BlockDelimiter")].concat(c))[0],"BRACKET","bracket"),_(u[0],"PAREN","paren"),_(u[0],"SPACE","space"),_(R[0],"DELIMITER",w(["bracket","paren","space"],{bracket:/,/,paren:/,/,space:/\s+/}).$freeze()),_(R[0],"DELIMITER_CHAR",w(["bracket","paren","space"],{bracket:", ",paren:", ",space:" "}).$freeze()),_(R[0],"TERMINATION",w(["bracket","paren","space"],{bracket:/\]/,paren:/\)/,space:/$/}).$freeze()),_(R[0],"SUFFIX",w(["bracket","paren","space"],{bracket:"]",paren:")",space:""}).$freeze()),function(l,c){var f=[l].concat(c),u=d.$r(f);O(l,"$eval",function(m,C,$){var ie;return(ie=this.$parse(m))===q||null==ie?q:ie.$roll($)}),l.$private(),O(l,"$parse",function(m){try{var $,Ee,Me,$e,ye,C=N("return"),se=q,Ie=q,ce=q,he=q,Se=q,be=q;if((se=u("StringScanner").$new(m)).$skip(/\s+/),Ee=se.$scan(/S/i)["$nil?"]()["$!"](),!x(se.$scan(/choice/i))||(Ie=x(ce=($=se.$scan(/\d+/))===q||null==$?q:$.$to_i())?ce:1,K(Ie,0)))return q;for(Me=V("[",ce=se.$scan(/\(|\[|\s+/))?Z(u("BlockDelimiter"),"BRACKET"):V("(",ce)?Z(u("BlockDelimiter"),"PAREN"):V(u("String"),ce)?Z(u("BlockDelimiter"),"SPACE"):void C.$throw(),$e=u("DELIMITER")["$[]"](Me),ye=u("TERMINATION")["$[]"](Me),he=[];x(Se=se.$scan_until($e));)he.$push(Se.$delete_suffix(","));return be=se.$scan_until(ye),!x(be)||(he.$push(be.$delete_suffix(u("SUFFIX")["$[]"](Me))),he=A(A(he,"map",[],"strip".$to_proc()),"reject",[],"empty?".$to_proc()),K(he.$size(),1)&&(he=this.$parse_multi_item_shorthand(he.$first())),x(he["$empty?"]())||x(U(he.$size(),Ie)))?q:this.$new(w(["secret","block_delimiter","takes","items"],{secret:Ee,block_delimiter:Me,takes:Ie,items:he}))}catch(ae){if(ae===C)return ae.$v;throw ae}}),O(l,"$parse_multi_item_shorthand",function(m){var $,ie;return x($=x(ie=this.$parse_multi_nums_shorthand(m))?ie:this.$parse_multi_chars_shorthand(m))?$:[]}),O(l,"$parse_multi_nums_shorthand",function(m){var C=q,$=q,ie=q;return C=/^(\d+)-(\d+)$/.$match(m),!x(C)||($=C["$[]"](1).$to_i(),ie=C["$[]"](2).$to_i(),x(Y($,ie)))?q:$.$upto(ie).$to_a()}),O(l,"$parse_multi_chars_shorthand",function(m){var $,C=q,ie=q,se=q;return C=x($=/^([a-z])-([a-z])$/.$match(m))?$:/^([A-Z])-([A-Z])$/.$match(m),!x(C)||(ie=C["$[]"](1),se=C["$[]"](2),x(Y(ie,se)))?q:ie.$upto(se).$to_a()})}(d.get_singleton_class(fe),R),O(fe,"$initialize",function(c){var f,u,p,m,C=this;return c=T(c),f=j(c,"secret"),u=j(c,"block_delimiter"),p=j(c,"takes"),m=j(c,"items"),C.secret=f,C.block_delimiter=u,C.takes=p,C.items=m}),O(fe,"$roll",function(c){var f=this,u=q,p=q;return x(Y(f.items.$size(),100))?F("Result").$new("\u9805\u76ee\u6570\u306f100\u4ee5\u4e0b\u3068\u3057\u3066\u304f\u3060\u3055\u3044"):(u=f.items.$dup(),p=[],A(f.takes,"times",[],function(){var C;return C=c.$roll_index(u.$size()),p["$<<"](u.$delete_at(C))}),A(F("Result").$new(),"tap",[],function m(C){var $,se,ie=m.$$s??this;return null==ie.block_delimiter&&(ie.block_delimiter=q),null==ie.secret&&(ie.secret=q),null==C&&(C=q),se=p.$join(F("DELIMITER_CHAR")["$[]"](ie.block_delimiter)),C["$secret="](ie.secret),$=["("+ie.$expr()+") \uff1e "+se],A(C,"text=",$),$[$.length-1]},{$$s:f}))}),O(fe,"$expr",function(){var f,u,c=this;return f=K(c.takes,1)?q:c.takes,V(Z(F("BlockDelimiter"),"SPACE"),u=c.block_delimiter)?"choice"+f+" "+c.items.$join(" "):V(Z(F("BlockDelimiter"),"BRACKET"),u)?"choice"+f+"["+c.items.$join(",")+"]":V(Z(F("BlockDelimiter"),"PAREN"),u)?"choice"+f+"("+c.items.$join(",")+")":q})},Opal.modules["bcdice/common_command/d66_dice"]=function(d){var Z,L,B,F,l,c,te,D,fe,k,I,H=d.module,J=d.klass,_=d.const_set,w=d.thrower,O=d.def,x=d.truthy,K=d.hash2,V=d.ensure_kwargs,A=d.get_kwarg,U=d.send,N=d.eqeqeq,Y=d.rb_plus,T=d.rb_times,j=[],re=d.nil,z=d.$$$;return Z=j,L=I=[H(j[0],"BCDice")].concat(Z),B=k=[H(I[0],"CommonCommand")].concat(L),D=[te=J(k[0],null,"D66Dice")].concat(B),fe=d.$r(D),te.$$prototype.sort_type=re,_(D[0],"PREFIX_PATTERN",/D66/.$freeze()),l=[F=d.get_singleton_class(te)].concat(D),c=d.$r(l),O(F,"$eval",function(u,p,m){try{var $;return w("eval_return"),($=this.$parse(u,p))===re||null==$?re:$.$eval(m)}catch(Ee){if(Ee===d.t_eval_return)return Ee.$v;throw Ee}}),F.$private(),O(F,"$parse",function(u,p){var C=re,$=re;return u=u.$split(" ",2).$first(),C=/^(S)?D66([ANSD])?$/i.$match(u.$upcase()),x(C)?this.$new(K(["secret","sort_type","suffix"],{secret:C["$[]"](1)["$nil?"]()["$!"](),sort_type:x($=this.$sort_type_from_suffix(C["$[]"](2)))?$:p.$d66_sort_type(),suffix:C["$[]"](2)})):re}),O(F,"$sort_type_from_suffix",function(u){switch(u){case"A":case"S":return z(c("D66SortType"),"ASC");case"D":return z(c("D66SortType"),"DESC");case"N":return z(c("D66SortType"),"NO_SORT");default:return re}}),O(te,"$initialize",function(g){var l,c,f,u=this;return g=V(g),l=A(g,"secret"),c=A(g,"sort_type"),f=A(g,"suffix"),u.secret=l,u.sort_type=c,u.suffix=f}),O(te,"$eval",function(g){var c;return c=this.$roll(g),U(fe("Result").$new(),"tap",[],function f(u){var p,m=f.$$s??this;return null==m.secret&&(m.secret=re),null==m.suffix&&(m.suffix=re),null==u&&(u=re),u["$secret="](m.secret),U(u,"text=",p=["(D66"+m.suffix+") \uff1e "+c]),p[p.length-1]},{$$s:this})}),te.$private(),O(te,"$roll",function(g){var f,c=re;return c=U(fe("Array"),"new",[2],function(){return g.$roll_once(6)}),N(z(fe("D66SortType"),"ASC"),f=this.sort_type)?c["$sort!"]():N(z(fe("D66SortType"),"DESC"),f)&&c["$sort!"]()["$reverse!"](),Y(T(c["$[]"](0),10),c["$[]"](1))})},Opal.modules["bcdice/common_command/repeat"]=function(d){var q,X,P,R,g,l,B,te,D,fe,S,M,H=d.module,J=d.klass,_=d.const_set,w=d.def,O=d.truthy,x=d.hash2,K=d.ensure_kwargs,V=d.get_kwarg,A=d.send,U=d.eqeq,N=d.thrower,Y=d.rb_lt,j=[],re=d.nil;return d.top.$require("strscan"),q=j,X=M=[H(j[0],"BCDice")].concat(q),P=S=[H(M[0],"CommonCommand")].concat(X),te=[B=J(S[0],null,"Repeat")].concat(P),D=d.$r(te),(fe=B.$$prototype).times=fe.trailer=fe.secret=re,_(te[0],"PREFIX_PATTERN",/(repeat|rep|x)\d+/.$freeze()),_(te[0],"REPEAT_LIMIT",100),g=[R=d.get_singleton_class(B)].concat(te),l=d.$r(g),w(R,"$eval",function(f,u,p){var m;return(m=this.$parse(f))===re||null==m?re:m.$roll(u,p)}),R.$private(),w(R,"$parse",function(f){var u,C,m=re,$=re,ie=re,se=re,Ee=re;return C=(m=l("StringScanner").$new(f)).$scan(/s/i)["$nil?"]()["$!"](),$=m.$scan(/repeat|rep|x/i),ie=(u=m.$scan(/\d+/))===re||null==u?re:u.$to_i(),se=m.$scan(/\s+/),O($["$nil?"]())||O(ie["$nil?"]())||O(se["$nil?"]())||(Ee=m.$post_match(),O(Ee["$nil?"]())||O(Ee["$empty?"]()))?re:this.$new(x(["secret","times","trailer"],{secret:C,times:ie,trailer:Ee}))}),w(B,"$initialize",function(F){var g,l,c,f=this;return F=K(F),g=V(F,"secret"),l=V(F,"times"),c=V(F,"trailer"),f.secret=g,f.times=l,f.trailer=c}),w(B,"$roll",function(F,g){try{N("eval_return");var f,c=this,u=re,p=re,m=re,C=re;return f=c.$validate(),O(f)?f:(u=A(D("Array"),"new",[c.times],function $(){var ie=$.$$s??this,se=re;return null==ie.trailer&&(ie.trailer=re),(se=F.$class().$new(ie.trailer))["$randomizer="](g),se.$eval()},{$$s:c}),U(A(u,"count",[],function(ie){return null==ie&&(ie=re),ie["$=="](re)}),c.times)?c.$result_with_text("\u7e70\u308a\u8fd4\u3057\u5bfe\u8c61\u306e\u30b3\u30de\u30f3\u30c9\u304c\u5b9f\u884c\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f ("+c.trailer+")"):(p=A(u.$map(),"with_index",[1],function(ie,se){return null==ie&&(ie=re),null==se&&(se=re),"#"+se+"\n"+ie.$text()}).$join("\n\n"),m=O(C=c.secret)?C:A(u,"any?",[],"secret?".$to_proc()),A(D("Result").$new(),"tap",[],function(ie){var se;return null==ie&&(ie=re),ie["$secret="](m),A(ie,"text=",se=[p]),se[se.length-1]})))}catch($){if($===d.t_eval_return)return $.$v;throw $}}),B.$private(),w(B,"$validate",function(){var F=this;return O(/^(repeat|rep|x)\d+/["$match?"](F.trailer))?F.$result_with_text("Repeat\u30b3\u30de\u30f3\u30c9\u306e\u91cd\u8907\u306f\u3067\u304d\u307e\u305b\u3093"):O(Y(F.times,1))||O(Y(D("REPEAT_LIMIT"),F.times))?F.$result_with_text("\u7e70\u308a\u8fd4\u3057\u56de\u6570\u306f1\u4ee5\u4e0a\u3001"+D("REPEAT_LIMIT")+"\u4ee5\u4e0b\u3068\u3057\u3066\u304f\u3060\u3055\u3044"):re}),w(B,"$result_with_text",function(F){return A(D("Result").$new(),"tap",[],function l(c){var f,u=l.$$s??this;return null==u.secret&&(u.secret=re),null==c&&(c=re),c["$secret="](u.secret),A(c,"text=",f=[F]),f[f.length-1]},{$$s:this})})},Opal.modules["bcdice/format"]=function(d){var U,j,re,z,q,Y,H=d.module,J=d.eqeqeq,_=d.def,w=d.truthy,O=d.eqeq,x=d.rb_gt,K=[],V=d.nil;return U=K,j=Y=[H(K[0],"BCDice")].concat(U),z=[re=H(Y[0],"Format")].concat(j),q=d.$r(z),re.$module_function(),_(re,"$comparison_operator",function(M){var I;return J("==",I=M)?"=":J("!=",I)?"<>":J(q("Symbol"),I)?M.$to_s():V}),_(re,"$modifier",function(M){return w(M["$nil?"]())?V:O(M,0)?"":w(x(M,0))?"+"+M:M.$to_s()})},Opal.modules["bcdice/common_command/barabara_dice/result"]=function(d){var N,re,M,k,q,T,H=d.module,J=d.klass,_=d.send2,w=d.find_super,O=d.def,K=[],V=d.nil,A=d.$$$;return d.top.$require("bcdice/result"),N=K,re=T=[H(K[0],"BCDice")].concat(N),M=q=[H(T[0],"CommonCommand")].concat(re),(k=J([H(q[0],"BarabaraDice")].concat(M)[0],A(A("BCDice"),"Result"),"Result")).$attr_accessor("last_dice_list_list"),k.$attr_accessor("last_dice_list"),k.$attr_accessor("success_num"),O(k,"$initialize",function v(P){var te=this;return v.$$p=null,null==P&&(P=V),_(te,w(te,"initialize",v,!1,!0),"initialize",[P],null),te.last_dice_list_list=[],te.last_dice_list=[],te.success_num=0},-1)},Opal.modules["bcdice/common_command/barabara_dice/node"]=function(d){var T,q,X,v,fe,R,F,g,l,B,S,M,re,H=d.module,J=d.klass,_=d.ensure_kwargs,w=d.get_kwarg,O=d.def,x=d.send,K=d.truthy,V=d.thrower,A=d.top,U=[],N=d.nil;return A.$require("bcdice/format"),A.$require("bcdice/common_command/barabara_dice/result"),T=U,q=re=[H(U[0],"BCDice")].concat(T),X=M=[H(re[0],"CommonCommand")].concat(q),v=S=[H(M[0],"BarabaraDice")].concat(X),fe=B=[H(S[0],"Node")].concat(v),F=[R=J(B[0],null,"Command")].concat(fe),g=d.$r(F),(l=R.$$prototype).notations=l.cmp_op=l.target_number=N,O(R,"$initialize",function(f){var u,p,m,C,$=this;return f=_(f),u=w(f,"secret"),p=w(f,"notations"),m=w(f,"cmp_op"),C=w(f,"target_number"),$.secret=u,$.notations=p,$.cmp_op=m,$.target_number=C}),O(R,"$eval",function(f,u){try{V("eval_return");var m,$,se,Ie,$e,ye,C=this,ie=N,Ee=N,ce=N,Me=N,he=N,Se=N;return $=f.$round_type(),ie=x(C.notations,"map",[],function(ae){return null==ae&&(ae=N),ae.$to_dice($)}),se=K(Ee=C.cmp_op)?Ee:f.$default_cmp_op(),Ie=K(Ee=(m=C.target_number)===N||null==m?N:m.$eval($))?Ee:f.$default_target_number(),ce=x(ie,"map",[],function(ae){return null==ae&&(ae=N),ae.$roll(u)}),K(f["$sort_barabara_dice?"]())&&x(ce,"map!",[],"sort".$to_proc()),$e=(Me=ce.$flatten()).$count(1),ye=K(se)?x(Me,"count",[],function(ae){return null==ae&&(ae=N),ae.$send(se,Ie)}):0,K(se)&&(he="\u6210\u529f\u6570"+ye),Se=["("+ie.$join("+")+g("Format").$comparison_operator(se)+Ie+")",Me.$join(","),he,f.$grich_text($e,Me.$size(),ye)].$compact(),x(g("Result").$new(),"tap",[],function be(ae){var ue,Ce=be.$$s??this;return null==Ce.secret&&(Ce.secret=N),null==ae&&(ae=N),ae["$secret="](Ce.secret),ae["$text="](Se.$join(" \uff1e ")),ae["$last_dice_list_list="](ce),ae["$last_dice_list="](Me),x(ae,"success_num=",ue=[ye]),ue[ue.length-1]},{$$s:C})}catch(be){if(be===d.t_eval_return)return be.$v;throw be}}),function(te,D,fe){var R=J(te,null,"Notation"),F=[R].concat(fe),g=d.$r(F),l=R.$$prototype;l.times=l.sides=N,O(R,"$initialize",function(f,u){return this.times=f,this.sides=u}),O(R,"$to_dice",function(f){try{var m,C;return V("eval_return"),m=this.times.$eval(f),C=this.sides.$eval(f),g("Dice").$new(m,C)}catch($){if($===d.t_eval_return)return $.$v;throw $}})}(B[0],0,B),function(te,D){var fe=J(te,null,"Dice"),R=fe.$$prototype;return R.times=R.sides=N,O(fe,"$initialize",function(g,l){return this.times=g,this.sides=l}),O(fe,"$roll",function(g){return g.$roll_barabara(this.times,this.sides)}),O(fe,"$to_s",function(){return this.times+"B"+this.sides})}(B[0])},Opal.modules["bcdice/common_command/reroll_dice/parser"]=function(d){var z,I,k,fe,l,c,f,u,p,m,C,$,ie,Ie,R,F,g,P,B,L,Z,H=d.module,J=d.klass,_=d.defs,w=d.def,O=d.hash,x=d.const_set,K=d.hash2,V=d.return_val,A=d.to_ary,U=d.truthy,N=d.top,Y=[],T=d.nil,j=d.$$$;return N.$require("racc/parser.rb"),N.$require("bcdice/common_command/lexer"),N.$require("bcdice/common_command/barabara_dice/node"),N.$require("bcdice/arithmetic/node"),z=Y,I=Z=[H(Y[0],"BCDice")].concat(z),k=L=[H(Z[0],"CommonCommand")].concat(I),P=[H(L[0],"RerollDice")].concat(k),B=d.$r(P),fe=P,F=[R=J(P[0],j(B("Racc"),"Parser"),"Parser")].concat(fe),g=d.$r(F),R.$$prototype.lexer=T,_(R,"$parse",function(he){return this.$new().$parse(he)}),w(R,"$parse",function(he){try{return this.lexer=g("Lexer").$new(he),this.$do_parse()}catch(be){if(!d.rescue(be,[g("ParseError")]))throw be;try{return T}finally{d.pop_exception()}}}),R.$private(),w(R,"$next_token",function(){return this.lexer.$next_token()}),l=d.large_array_unpack("9,3,9,9,9,15,20,21,20,21,8,14,8,8,8,9,9,4,13,28,10,39,20,21,9,8,8,31,32,9,20,21,33,16,8,20,21,9,24,8,34,35,9,20,21,31,32,8,20,21,9,13,8,31,32,9,20,21,34,35,8,20,21,9,,8,34,35,9,20,21,31,32,8,20,21,9,,8,,31,32,20,21,31,32,8,40,,,,47,51,49,50,52"),c=d.large_array_unpack("14,0,24,2,15,5,14,14,24,24,14,5,24,2,15,16,8,1,5,14,4,24,8,8,13,16,8,17,17,20,13,13,17,7,13,20,20,21,11,20,18,18,28,21,21,26,26,21,28,28,31,12,28,38,38,32,31,31,42,42,31,32,32,34,,32,43,43,35,34,34,46,46,34,35,35,39,,35,,27,27,39,39,41,41,39,27,,,,41,45,45,45,45"),f=d.large_array_unpack("-6,17,1,,20,-3,,30,14,,,18,30,22,-2,2,13,19,30,,27,35,,,0,,37,72,40,,,48,53,,61,66,,,45,74,,76,48,56,,89,63,,,,,,"),u=d.large_array_unpack("-4,-31,-31,-5,-31,-6,-13,-31,-31,-30,53,-1,-6,-31,-31,-31,-31,-31,-17,-20,-31,-31,-28,-3,-31,-2,-7,-31,-31,-12,-14,-31,-31,-29,-31,-31,-26,-27,-10,-31,-8,-31,-15,-16,-18,-21,-11,-9,-19,-22,-23,-24,-25"),p=[17,7,11,36,37,26,27,1,6,25,42,43,2,5,7,30,38,44,45,12,41,29,23,48,T,T,T,T,T,T,T,46],m=[7,9,4,11,11,7,7,1,8,4,10,10,2,3,9,9,7,11,11,5,7,8,6,12,T,T,T,T,T,T,T,7],C=[T,7,12,11,-3,14,11,-8,6,-1,-21,-17,-22],$=[T,T,T,T,T,T,T,T,T,22,18,19,T],ie=d.large_array_unpack("0,0,racc_error,3,23,_reduce_1,4,23,_reduce_2,4,23,_reduce_3,0,24,_reduce_4,1,24,_reduce_5,0,26,_reduce_6,2,26,_reduce_7,3,27,_reduce_8,4,27,_reduce_9,2,28,_reduce_10,3,28,_reduce_11,3,25,_reduce_12,1,25,_reduce_13,3,30,_reduce_14,3,29,_reduce_15,3,29,_reduce_16,1,29,_reduce_none,3,32,_reduce_18,4,32,_reduce_19,1,32,_reduce_none,0,34,_reduce_21,1,34,_reduce_22,1,34,_reduce_23,1,34,_reduce_24,1,34,_reduce_25,2,33,_reduce_26,2,33,_reduce_27,1,33,_reduce_none,3,31,_reduce_29,1,31,_reduce_30"),Ie=O(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"S",7,"PLUS",8,"MINUS",9,"ASTERISK",10,"SLASH",11,"PARENL",12,"PARENR",13,"BRACKETL",14,"BRACKETR",15,"LESS",16,"GREATER",17,"EQUAL",18,"NOT",19,"AT",20,"CMP_OP",21),x(F[0],"Racc_arg",[l,c,u,f,p,m,$,C,22,ie,Ie,53,31,!0]),x(F[0],"Racc_token_to_s_table",d.large_array_unpack("$end,error,NUMBER,R,U,C,F,S,PLUS,MINUS,ASTERISK,SLASH,PARENL,PARENR,BRACKETL,BRACKETR,LESS,GREATER,EQUAL,NOT,AT,CMP_OP,$start,expr,secret,notations,target,bracket,at,add,dice,term,mul,unary,round_type")),x(F[0],"Racc_debug_parser",!1),w(R,"$_reduce_1",function(he,Se,be){return j(g("Node"),"Command").$new(K(["secret","notations","cmp_op","target_number","source"],{secret:he["$[]"](0),notations:he["$[]"](1),cmp_op:he["$[]"](2)["$[]"]("cmp_op"),target_number:he["$[]"](2)["$[]"]("target"),source:this.lexer.$source()}))}),w(R,"$_reduce_2",function(he,Se,be){var ue=T,Ce=T;return ue=he["$[]"](3),Ce=he["$[]"](2),j(g("Node"),"Command").$new(K(["secret","notations","cmp_op","target_number","reroll_cmp_op","reroll_threshold","source"],{secret:he["$[]"](0),notations:he["$[]"](1),cmp_op:ue["$[]"]("cmp_op"),target_number:ue["$[]"]("target"),reroll_cmp_op:Ce["$[]"]("cmp_op"),reroll_threshold:Ce["$[]"]("threshold"),source:this.lexer.$source()}))}),w(R,"$_reduce_3",function(he,Se,be){var ue=T,Ce=T;return ue=he["$[]"](2),Ce=he["$[]"](3),j(g("Node"),"Command").$new(K(["secret","notations","cmp_op","target_number","reroll_cmp_op","reroll_threshold","source"],{secret:he["$[]"](0),notations:he["$[]"](1),cmp_op:ue["$[]"]("cmp_op"),target_number:ue["$[]"]("target"),reroll_cmp_op:Ce["$[]"]("cmp_op"),reroll_threshold:Ce["$[]"]("threshold"),source:this.lexer.$source()}))}),w(R,"$_reduce_4",V(!1)),w(R,"$_reduce_5",V(!0)),w(R,"$_reduce_6",function(he,Se,be){return K([],{})}),w(R,"$_reduce_7",function(he,Se,be){var ae,y,W;return W=(ae=A(he))[1]??T,U(y=ae[0]??T)||this.$raise(g("ParseError")),K(["cmp_op","target"],{cmp_op:y,target:W})}),w(R,"$_reduce_8",function(he,Se,be){return K(["threshold"],{threshold:he["$[]"](1)})}),w(R,"$_reduce_9",function(he,Se,be){var ue,Ce;return ue=he["$[]"](1),Ce=he["$[]"](2),U(ue)||this.$raise(g("ParseError")),K(["cmp_op","threshold"],{cmp_op:ue,threshold:Ce})}),w(R,"$_reduce_10",function(he,Se,be){return K(["threshold"],{threshold:he["$[]"](1)})}),w(R,"$_reduce_11",function(he,Se,be){var ue,Ce;return ue=he["$[]"](1),Ce=he["$[]"](2),U(ue)||this.$raise(g("ParseError")),K(["cmp_op","threshold"],{cmp_op:ue,threshold:Ce})}),w(R,"$_reduce_12",function(he,Se,be){var ae=T;return(ae=he["$[]"](0)).$push(he["$[]"](2)),ae}),w(R,"$_reduce_13",function(he,Se,be){return[he["$[]"](0)]}),w(R,"$_reduce_14",function(he,Se,be){var ae,ue;return ae=he["$[]"](0),ue=he["$[]"](2),j(g("Node"),"Notation").$new(ae,ue)}),w(R,"$_reduce_15",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"+",he["$[]"](2))}),w(R,"$_reduce_16",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"-",he["$[]"](2))}),w(R,"$_reduce_18",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"*",he["$[]"](2))}),w(R,"$_reduce_19",function(he,Se,be){return he["$[]"](3).$new(he["$[]"](0),he["$[]"](2))}),w(R,"$_reduce_21",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),w(R,"$_reduce_22",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"DivideWithCeil")}),w(R,"$_reduce_23",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"DivideWithCeil")}),w(R,"$_reduce_24",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"DivideWithRound")}),w(R,"$_reduce_25",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"DivideWithFloor")}),w(R,"$_reduce_26",function(he,Se,be){return he["$[]"](1)}),w(R,"$_reduce_27",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"Negative").$new(he["$[]"](1))}),w(R,"$_reduce_29",function(he,Se,be){return he["$[]"](1)}),w(R,"$_reduce_30",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"Number").$new(he["$[]"](0))}),w(R,"$_reduce_none",function(he,Se,be){return he["$[]"](0)})},Opal.modules["bcdice/common_command/reroll_dice"]=function(d){var A,T,q,I,L,S,Z,M,re,N,H=d.module,J=d.const_set,_=d.thrower,w=d.def,O=d.top,x=[],K=d.nil;return O.$require("bcdice/normalize"),O.$require("bcdice/format"),O.$require("bcdice/common_command/reroll_dice/parser"),A=x,T=N=[H(x[0],"BCDice")].concat(A),q=re=[H(N[0],"CommonCommand")].concat(T),J((M=[Z=H(re[0],"RerollDice")].concat(q))[0],"PREFIX_PATTERN",/\d+R\d+/.$freeze()),J(M[0],"REROLL_LIMIT",1e4),L=[I=d.get_singleton_class(Z)].concat(M),S=d.$r(L),w(I,"$eval",function(v,P,B){try{var D;return _("eval_return"),(D=S("Parser").$parse(v))===K||null==D?K:D.$eval(P,B)}catch(R){if(R===d.t_eval_return)return R.$v;throw R}})},Opal.modules["bcdice/common_command/upper_dice/node"]=function(d){var q,X,v,D,l,c,f,u,p,R,B,S,M,H=d.module,J=d.klass,_=d.ensure_kwargs,w=d.get_kwarg,O=d.def,x=d.send,K=d.truthy,V=d.rb_le,A=d.thrower,U=d.rb_plus,N=d.eqeq,Y=d.hash2,T=d.rb_lt,j=[],re=d.nil;return q=j,X=M=[H(j[0],"BCDice")].concat(q),v=S=[H(M[0],"CommonCommand")].concat(X),D=B=[H(S[0],"UpperDice")].concat(v),l=R=[H(B[0],"Node")].concat(D),f=[c=J(R[0],null,"Command")].concat(l),u=d.$r(f),(p=c.$$prototype).notations=p.reroll_threshold=p.modifier=p.target_number=p.cmp_op=re,O(c,"$initialize",function(C){var $,ie,se,Ee,Ie,ce,Me=this;return C=_(C),$=w(C,"secret"),ie=w(C,"notations"),se=w(C,"modifier"),Ee=w(C,"cmp_op"),Ie=w(C,"target_number"),null==(ce=C.$$smap.reroll_threshold)&&(ce=re),Me.secret=$,Me.notations=ie,Me.modifier=se,Me.cmp_op=Ee,Me.target_number=Ie,Me.reroll_threshold=ce}),O(c,"$eval",function(C,$){try{A("eval_return");var se,Ee,Ie,Me,$e,ye,be,ue,Se,ae,ce=this,he=re,Ce=re,y=re,W=re;return Me=C.$round_type(),$e=x(ce.notations,"map",[],function(we){return null==we&&(we=re),we.$to_dice(Me)}),ye=K(he=K(Se=(se=ce.reroll_threshold)===re||null==se?re:se.$eval(Me))?Se:C.$upper_dice_reroll_threshold())?he:0,be=K(he=(Ee=ce.modifier)===re||null==Ee?re:Ee.$eval(Me))?he:0,ae=(Ie=ce.target_number)===re||null==Ie?re:Ie.$eval(Me),ue=ce.$expr($e,ye,be,ae),K(V(ye,1))?ce.$result_with_text("("+ue+") \uff1e \u7121\u9650\u30ed\u30fc\u30eb\u306e\u6761\u4ef6\u304c\u307e\u3061\u304c\u3063\u3066\u3044\u307e\u3059"):(Ce=x($e,"map",[],function(we){return null==we&&(we=re),we.$roll($,ye,C["$sort_barabara_dice?"]())}).$reduce([],"concat"),y=K(ce.cmp_op)?ce.$result_success_count(Ce,be,ae):ce.$result_max_sum(Ce,be),W=["("+ue+")",ce.$interlim_expr(Ce,be),y],ce.$result_with_text(W.$join(" \uff1e ")))}catch(pe){if(pe===d.t_eval_return)return pe.$v;throw pe}}),c.$private(),O(c,"$result_success_count",function(C,$,ie){return"\u6210\u529f\u6570"+x(C,"count",[],function Ie(ce){var Me=Ie.$$s??this;return null==Me.cmp_op&&(Me.cmp_op=re),null==ce&&(ce=re),U(ce["$[]"]("sum"),$).$send(Me.cmp_op,ie)},{$$s:this})}),O(c,"$result_max_sum",function(C,$){var se,ie=re;return ie=x(C,"map",[],function(ce){return null==ce&&(ce=re),ce["$[]"]("sum")}),se=U(ie.$sum(),$),x(ie,"map",[],function(ce){return null==ce&&(ce=re),U(ce,$)}).$max()+"/"+se+"(\u6700\u5927/\u5408\u8a08)"}),O(c,"$interlim_expr",function(C,$){var ie;return ie=x(C,"map",[],function(Ee){return null==Ee&&(Ee=re),N(Ee["$[]"]("list").$size(),1)?Ee["$[]"]("sum"):Ee["$[]"]("sum")+"["+Ee["$[]"]("list").$join(",")+"]"}).$join(","),U(ie,u("Format").$modifier($))}),O(c,"$expr",function(C,$,ie,se){var Ie,ce;return Ie=u("Format").$comparison_operator(this.cmp_op),ce=u("Format").$modifier(ie),C.$join("+")+"["+$+"]"+ce+Ie+se}),O(c,"$result_with_text",function(C){return x(u("Result").$new(),"tap",[],function ie(se){var Ee,Ie=ie.$$s??this;return null==Ie.secret&&(Ie.secret=re),null==se&&(se=re),se["$secret="](Ie.secret),x(se,"text=",Ee=[C]),Ee[Ee.length-1]},{$$s:this})}),function(F,g,l){var c=J(F,null,"Notation"),f=[c].concat(l),u=d.$r(f),p=c.$$prototype;p.roll_times=p.sides=re,O(c,"$initialize",function(C,$){return this.roll_times=C,this.sides=$}),O(c,"$to_dice",function(C){try{var se,Ee;return A("eval_return"),se=this.roll_times.$eval(C),Ee=this.sides.$eval(C),u("Dice").$new(se,Ee)}catch(Ie){if(Ie===d.t_eval_return)return Ie.$v;throw Ie}})}(R[0],0,R),function(F,g,l){var c=J(F,null,"Dice"),f=[c].concat(l),u=d.$r(f),p=c.$$prototype;return p.roll_times=p.sides=re,O(c,"$initialize",function(C,$){return this.roll_times=C,this.sides=$}),O(c,"$roll",function(C,$,ie){var Ee=re;return Ee=x(u("Array"),"new",[this.roll_times],function Ie(){var Me=re;return Me=(Ie.$$s??this).$roll_ones(C,$),Y(["sum","list"],{sum:Me.$sum(),list:Me})},{$$s:this}),K(ie)&&(Ee=x(Ee,"sort_by",[],function(ce){return null==ce&&(ce=re),ce["$[]"]("sum")})),Ee}),O(c,"$to_s",function(){return this.roll_times+"U"+this.sides}),c.$private(),O(c,"$roll_ones",function(C,$){var ie=this,se=re;return se=[],function(){try{var Ee=A("break");x(ie,"loop",[],function Ie(){var Me,ce=Ie.$$s??this;if(null==ce.sides&&(ce.sides=re),Me=C.$roll_once(ce.sides),se.$push(Me),!K(T(Me,$)))return re;Ee.$throw()},{$$s:ie})}catch(Ie){if(Ie===Ee)return Ie.$v;throw Ie}}(),se})}(R[0],0,R)},Opal.modules["bcdice/common_command/upper_dice/parser"]=function(d){var z,I,k,fe,l,c,f,u,p,m,C,$,ie,Ie,R,F,g,P,B,L,Z,H=d.module,J=d.klass,_=d.defs,w=d.def,O=d.hash,x=d.const_set,K=d.hash2,V=d.return_val,A=d.to_ary,U=d.truthy,N=d.top,Y=[],T=d.nil,j=d.$$$;return N.$require("racc/parser.rb"),N.$require("bcdice/common_command/lexer"),N.$require("bcdice/common_command/upper_dice/node"),N.$require("bcdice/arithmetic/node"),z=Y,I=Z=[H(Y[0],"BCDice")].concat(z),k=L=[H(Z[0],"CommonCommand")].concat(I),P=[H(L[0],"UpperDice")].concat(k),B=d.$r(P),fe=P,F=[R=J(P[0],j(B("Racc"),"Parser"),"Parser")].concat(fe),g=d.$r(F),R.$$prototype.lexer=T,_(R,"$parse",function(he){return this.$new().$parse(he)}),w(R,"$parse",function(he){try{return this.lexer=g("Lexer").$new(he),this.$do_parse()}catch(be){if(!d.rescue(be,[g("ParseError")]))throw be;try{return T}finally{d.pop_exception()}}}),R.$private(),w(R,"$next_token",function(){return this.lexer.$next_token()}),l=d.large_array_unpack("9,9,36,37,3,9,9,21,22,49,8,8,21,22,9,8,8,14,15,9,21,22,4,16,8,21,22,9,10,8,36,37,9,21,22,38,17,8,21,22,9,25,8,27,15,9,21,22,28,29,8,21,22,9,44,8,39,40,9,21,22,39,40,8,21,22,9,25,8,39,40,9,21,22,36,37,8,21,22,9,17,8,39,40,9,21,22,39,40,8,21,22,9,,8,39,40,,21,22,39,40,8,58,56,57,59,36,37"),c=d.large_array_unpack("2,8,34,34,0,17,14,8,8,34,2,8,14,14,15,17,14,5,5,16,15,15,1,5,15,16,16,21,4,16,18,18,22,21,21,18,7,21,22,22,25,11,22,12,12,27,25,25,13,13,25,27,27,28,24,27,19,19,29,28,28,30,30,28,29,29,36,26,29,33,33,37,36,36,45,45,36,37,37,39,32,37,47,47,40,39,39,48,48,39,40,40,44,,40,50,50,,44,44,51,51,44,53,53,53,53,54,54"),f=d.large_array_unpack("-3,22,-2,,28,9,,32,-1,,,20,35,40,4,12,17,3,22,46,,25,30,,34,38,46,43,51,56,51,,76,59,-6,,64,69,,77,82,,,,90,66,,72,77,,85,90,,100,99,,,,,"),u=d.large_array_unpack("-4,-35,-35,-5,-35,-6,-17,-35,-35,-34,60,-12,-6,-7,-35,-35,-35,-35,-35,-21,-24,-35,-35,-32,-1,-35,-12,-35,-35,-35,-8,-16,-32,-9,-35,-18,-35,-35,-33,-35,-35,-30,-31,-3,-35,-13,-2,-10,-11,-14,-19,-20,-22,-25,-15,-23,-26,-27,-28,-29"),p=d.large_array_unpack("18,30,33,41,42,24,6,1,34,2,5,12,11,7,30,47,48,45,31,26,46,52,53,50,51,32,43,55,35,,,,,,,,54"),m=d.large_array_unpack("10,9,9,13,13,5,11,1,10,2,3,6,4,12,9,9,9,10,11,4,5,13,13,9,9,12,7,14,12,,,,,,,,10"),C=[T,7,9,8,7,-6,6,2,T,-13,-8,4,11,-18,-26],$=[T,T,T,T,T,T,T,T,13,19,T,T,23,20,T],ie=d.large_array_unpack("0,0,racc_error,4,23,_reduce_1,5,23,_reduce_2,5,23,_reduce_3,0,24,_reduce_4,1,24,_reduce_5,0,26,_reduce_6,1,26,_reduce_7,2,30,_reduce_8,2,30,_reduce_9,3,30,_reduce_10,3,30,_reduce_11,0,27,_reduce_12,2,27,_reduce_13,3,28,_reduce_14,2,29,_reduce_15,3,25,_reduce_16,1,25,_reduce_17,3,33,_reduce_18,3,32,_reduce_19,3,32,_reduce_20,1,32,_reduce_none,3,31,_reduce_22,4,31,_reduce_23,1,31,_reduce_none,0,36,_reduce_25,1,36,_reduce_26,1,36,_reduce_27,1,36,_reduce_28,1,36,_reduce_29,2,35,_reduce_30,2,35,_reduce_31,1,35,_reduce_none,3,34,_reduce_33,1,34,_reduce_34"),Ie=O(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"S",7,"PLUS",8,"MINUS",9,"ASTERISK",10,"SLASH",11,"PARENL",12,"PARENR",13,"BRACKETL",14,"BRACKETR",15,"LESS",16,"GREATER",17,"EQUAL",18,"NOT",19,"AT",20,"CMP_OP",21),x(F[0],"Racc_arg",[l,c,u,f,p,m,$,C,22,ie,Ie,60,35,!0]),x(F[0],"Racc_token_to_s_table",d.large_array_unpack("$end,error,NUMBER,R,U,C,F,S,PLUS,MINUS,ASTERISK,SLASH,PARENL,PARENR,BRACKETL,BRACKETR,LESS,GREATER,EQUAL,NOT,AT,CMP_OP,$start,expr,secret,notations,modifier,target,bracket,at,modifier_expr,mul,add,dice,term,unary,round_type")),x(F[0],"Racc_debug_parser",!1),w(R,"$_reduce_1",function(he,Se,be){return j(j(g("UpperDice"),"Node"),"Command").$new(K(["secret","notations","modifier","cmp_op","target_number"],{secret:he["$[]"](0),notations:he["$[]"](1),modifier:he["$[]"](2),cmp_op:he["$[]"](3)["$[]"]("cmp_op"),target_number:he["$[]"](3)["$[]"]("target")}))}),w(R,"$_reduce_2",function(he,Se,be){return j(j(g("UpperDice"),"Node"),"Command").$new(K(["secret","notations","modifier","cmp_op","target_number","reroll_threshold"],{secret:he["$[]"](0),notations:he["$[]"](1),modifier:he["$[]"](3),cmp_op:he["$[]"](4)["$[]"]("cmp_op"),target_number:he["$[]"](4)["$[]"]("target"),reroll_threshold:he["$[]"](2)}))}),w(R,"$_reduce_3",function(he,Se,be){return j(j(g("UpperDice"),"Node"),"Command").$new(K(["secret","notations","modifier","cmp_op","target_number","reroll_threshold"],{secret:he["$[]"](0),notations:he["$[]"](1),modifier:he["$[]"](2),cmp_op:he["$[]"](3)["$[]"]("cmp_op"),target_number:he["$[]"](3)["$[]"]("target"),reroll_threshold:he["$[]"](4)}))}),w(R,"$_reduce_4",V(!1)),w(R,"$_reduce_5",V(!0)),w(R,"$_reduce_6",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"Number").$new(0)}),w(R,"$_reduce_7",function(he,Se,be){return he["$[]"](0)}),w(R,"$_reduce_8",function(he,Se,be){return he["$[]"](1)}),w(R,"$_reduce_9",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"Negative").$new(he["$[]"](1))}),w(R,"$_reduce_10",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"+",he["$[]"](2))}),w(R,"$_reduce_11",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"-",he["$[]"](2))}),w(R,"$_reduce_12",function(he,Se,be){return K([],{})}),w(R,"$_reduce_13",function(he,Se,be){var ae,y,W;return W=(ae=A(he))[1]??T,U(y=ae[0]??T)||this.$raise(g("ParseError")),K(["cmp_op","target"],{cmp_op:y,target:W})}),w(R,"$_reduce_14",function(he,Se,be){return he["$[]"](1)}),w(R,"$_reduce_15",function(he,Se,be){return he["$[]"](1)}),w(R,"$_reduce_16",function(he,Se,be){var ae=T;return(ae=he["$[]"](0)).$push(he["$[]"](2)),ae}),w(R,"$_reduce_17",function(he,Se,be){return[he["$[]"](0)]}),w(R,"$_reduce_18",function(he,Se,be){var ae,ue;return ae=he["$[]"](0),ue=he["$[]"](2),j(j(g("UpperDice"),"Node"),"Notation").$new(ae,ue)}),w(R,"$_reduce_19",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"+",he["$[]"](2))}),w(R,"$_reduce_20",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"-",he["$[]"](2))}),w(R,"$_reduce_22",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"*",he["$[]"](2))}),w(R,"$_reduce_23",function(he,Se,be){return he["$[]"](3).$new(he["$[]"](0),he["$[]"](2))}),w(R,"$_reduce_25",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),w(R,"$_reduce_26",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"DivideWithCeil")}),w(R,"$_reduce_27",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"DivideWithCeil")}),w(R,"$_reduce_28",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"DivideWithRound")}),w(R,"$_reduce_29",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"DivideWithFloor")}),w(R,"$_reduce_30",function(he,Se,be){return he["$[]"](1)}),w(R,"$_reduce_31",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"Negative").$new(he["$[]"](1))}),w(R,"$_reduce_33",function(he,Se,be){return he["$[]"](1)}),w(R,"$_reduce_34",function(he,Se,be){return j(j(g("Arithmetic"),"Node"),"Number").$new(he["$[]"](0))}),w(R,"$_reduce_none",function(he,Se,be){return he["$[]"](0)})},Opal.modules["bcdice/common_command/upper_dice"]=function(d){var A,T,q,I,L,S,Z,M,re,N,H=d.module,J=d.const_set,_=d.thrower,w=d.def,x=[],K=d.nil;return d.top.$require("bcdice/common_command/upper_dice/parser"),A=x,T=N=[H(x[0],"BCDice")].concat(A),q=re=[H(N[0],"CommonCommand")].concat(T),J((M=[Z=H(re[0],"UpperDice")].concat(q))[0],"PREFIX_PATTERN",/\d+U\d+/.$freeze()),L=[I=d.get_singleton_class(Z)].concat(M),S=d.$r(L),w(I,"$eval",function(v,P,B){try{var D;return _("eval_return"),(D=S("Parser").$parse(v))===K||null==D?K:D.$eval(P,B)}catch(R){if(R===d.t_eval_return)return R.$v;throw R}})},Opal.modules["bcdice/common_command/version"]=function(d){var U,j,Z,X,S,k,M,I,z,Y,H=d.module,J=d.const_set,_=d.truthy,w=d.send,O=d.def,x=[],K=d.nil,V=d.$$$;return U=x,j=Y=[H(x[0],"BCDice")].concat(U),Z=z=[H(Y[0],"CommonCommand")].concat(j),J((I=[M=H(z[0],"Version")].concat(Z))[0],"PREFIX_PATTERN",/BCDiceVersion/.$freeze()),S=[X=d.get_singleton_class(M)].concat(I),k=d.$r(S),O(X,"$eval",function(P,B,te){return P=P.$split(" ",2).$first(),_(P["$match?"](/^BCDiceVersion$/i))?w(k("Result").$new(),"tap",[],function(fe){var R;return null==fe&&(fe=K),R=["BCDice "+V(k("BCDice"),"VERSION")],w(fe,"text=",R),R[R.length-1]}):K})},Opal.queue(function(d){var K,N,T,j,A,H=d.module,J=d.const_set,_=d.top,w=[];return _.$require("bcdice/common_command/add_dice"),_.$require("bcdice/common_command/barabara_dice"),_.$require("bcdice/common_command/tally_dice"),_.$require("bcdice/common_command/calc"),_.$require("bcdice/common_command/choice"),_.$require("bcdice/common_command/d66_dice"),_.$require("bcdice/common_command/repeat"),_.$require("bcdice/common_command/reroll_dice"),_.$require("bcdice/common_command/upper_dice"),_.$require("bcdice/common_command/version"),K=w,N=A=[H(w[0],"BCDice")].concat(K),T=[H(A[0],"CommonCommand")].concat(N),j=d.$r(T),J(T[0],"COMMANDS",[j("AddDice"),j("BarabaraDice"),j("TallyDice"),j("Calc"),j("Choice"),j("D66Dice"),j("Repeat"),j("RerollDice"),j("UpperDice"),j("Version")].$freeze())})},9993:function(){(function(E){"use strict";var le;if(typeof globalThis<"u"?E=globalThis:typeof global<"u"?E=global:typeof window<"u"&&(E=window),null==E.console&&(E.console={}),"log"in(le="object"==typeof E.console?E.console:{})||(le.log=function(){}),"warn"in le||(le.warn=le.log),typeof E.Opal<"u")return le.warn("Opal already loaded. Loading twice can cause troubles, please fix your setup."),E.Opal;var _e,d,H,J,_,w,O,x=E.Opal={};x.global=E,x.config={missing_require_severity:"error",unsupported_features_severity:"warning",experimental_features_severity:"warning",enable_stack_trace:!0};var K=Function.prototype.call,V=Function.prototype.bind,A=Object.hasOwn||K.bind(Object.prototype.hasOwnProperty),U=Object.setPrototypeOf,N=K.bind(Array.prototype.slice),Y=K.bind(Array.prototype.splice),j=4;function re(){return j+=2}x.uid=re,x.id=function(y){return y.$$is_number?2*y+1:(null==y.$$id&&Z(y,"$$id",re()),y.$$id)};var z=x.gvars={};function q(y,W){if(y||(y=x.Exception||Error),!O||!O.$raise)throw y.$new?y.$new(W):new y(W);arguments.length>2?O.$raise(y.$new.apply(y,N(arguments,1))):O.$raise(y,W)}function Z(y,W,pe){"string"==typeof y?y[W]=pe:Object.defineProperty(y,W,{value:pe,enumerable:!1,configurable:!0,writable:!0})}x.exit=function(y){z.DEBUG&&le.log("Exited with status "+y)},x.exceptions=[],x.pop_exception=function(){var y=x.exceptions.pop();y?(z["!"]=y,z["@"]=y.$backtrace()):z["!"]=z["@"]=_e},x.prop=Z,x.defineProperty=x.prop,x.slice=N;var M=x.truthy=function(y){return!(!1===y||_e===y||null==y||y instanceof Boolean&&!0!==y.valueOf())};function I(y){var W,pe,we;for(W=0,pe=x.tracers_for_class.length;W<pe;W++)(we=x.tracers_for_class[W]).trace_object=y,we.block.$call(we)}function X(y,W){if(y.$$autoload[W].loaded){if(y.$$autoload[W].loaded&&!y.$$autoload[W].required&&y.$$autoload[W].exception)throw y.$$autoload[W].exception}else{y.$$autoload[W].loaded=!0;try{x.Kernel.$require(y.$$autoload[W].path)}catch(pe){throw y.$$autoload[W].exception=pe,pe}if(y.$$autoload[W].required=!0,null!=y.$$const[W])return y.$$autoload[W].success=!0,y.$$const[W]}}function L(y,W){if(y){if(null!=y.$$const[W])return y.$$const[W];if(y.$$autoload&&y.$$autoload[W])return X(y,W)}}function k(y,W){var pe,we,De;if(null!=y)for(pe=0,we=(De=se(y)).length;pe<we;pe++){if(De[pe].$$const&&A(De[pe].$$const,W))return De[pe].$$const[W];if(De[pe].$$autoload&&De[pe].$$autoload[W])return X(De[pe],W)}}function P(y,W){return(y||H).$const_missing(W)}function B(y,W,pe){var we=!0;return(null==y||"::"===y)&&(y=H),pe.$$is_a_module&&((null==pe.$$name||pe.$$name===_e)&&(pe.$$name=W),null==pe.$$base_module&&(pe.$$base_module=y)),y.$$const=y.$$const||Object.create(null),(W in y.$$const||"$$autoload"in y&&W in y.$$autoload)&&(we=!1),y.$$const[W]=pe,y.$$=y.$$const,x.const_cache_version++,y===H&&(x[W]=pe),Z(y,W,pe),we&&y.$const_added&&!y.$const_added.$$pristine&&y.$const_added(W),pe}function te(y,W,pe){var we;if(we=null!=W&&W.$$bridge?function(){var at=N(arguments),It=new(V.apply(W.$$constructor,[null].concat(at)));return U(It,we.$$prototype),It}:function(){},y&&y!==_e&&Z(we,"displayName","::"+y),Z(we,"$$name",y),Z(we,"$$constructor",we),Z(we,"$$prototype",we.prototype),Z(we,"$$const",{}),Z(we,"$$is_class",!0),Z(we,"$$is_a_module",!0),Z(we,"$$super",W),Z(we,"$$cvars",{}),Z(we,"$$own_included_modules",[]),Z(we,"$$own_prepended_modules",[]),Z(we,"$$ancestors",[]),Z(we,"$$ancestors_cache_version",null),Z(we,"$$subclasses",[]),Z(we.$$prototype,"$$class",we),x.Class&&U(we,x.Class.prototype),null!=W){if(U(we.$$prototype,W.$$prototype),!0!==pe)if(typeof WeakRef<"u"){var De,Fe,Ye=[];for(De=0;De<W.$$subclasses.length;De++)void 0!==(Fe=W.$$subclasses[De]).deref()&&Ye.push(Fe);Ye.push(new WeakRef(we)),W.$$subclasses=Ye}else W.$$subclasses.push(we);W.$$meta&&x.build_class_singleton_class(we)}return we}function R(y){var W=function(){},pe=W;return y&&Z(W,"displayName",y+".constructor"),Z(pe,"$$name",y),Z(pe,"$$prototype",W.prototype),Z(pe,"$$const",{}),Z(pe,"$$is_module",!0),Z(pe,"$$is_a_module",!0),Z(pe,"$$cvars",{}),Z(pe,"$$iclasses",[]),Z(pe,"$$own_included_modules",[]),Z(pe,"$$own_prepended_modules",[]),Z(pe,"$$ancestors",[pe]),Z(pe,"$$ancestors_cache_version",null),U(pe,x.Module.prototype),pe}function g(y,W){y.hasOwnProperty("$$meta")?y.$$meta=W:Z(y,"$$meta",W),y.$$frozen?y.$$meta.$freeze():U(y,W.$$prototype)}function l(y){return y.hasOwnProperty("$$iclass")&&y.hasOwnProperty("$$root")}function p(y){var W=m(y);return y.$$is_module&&y.$$iclasses.push(W),W}function m(y){var W={},pe=y.$$prototype;pe.hasOwnProperty("$$dummy")&&(pe=pe.$$define_methods_on);var Fe,we=Object.getOwnPropertyNames(pe),De=we.length;for(Fe=0;Fe<De;Fe++){var Ye=we[Fe];Z(W,Ye,pe[Ye])}return Z(W,"$$iclass",!0),Z(W,"$$module",y),W}function C(y){var W=y.length,pe=y[0];if(Z(pe,"$$root",!0),1===W)return{first:pe,last:pe};for(var we=pe,De=1;De<W;De++){var Fe=y[De];U(we,Fe),we=Fe}return{first:y[0],last:y[W-1]}}function $(y){if(!y.hasOwnProperty("$$dummy")){if(y.hasOwnProperty("$$iclass"))return y.$$module;if(y.hasOwnProperty("$$class"))return y.$$class}}function se(y){if(!y)return[];if(y.$$ancestors_cache_version===x.const_cache_version)return y.$$ancestors;var pe,we,De,W=[];for(pe=0,we=function ie(y){return y.$$own_prepended_modules.concat([y]).concat(y.$$own_included_modules)}(y),De=we.length;pe<De;pe++)W.push(we[pe]);if(y.$$super)for(pe=0,De=(we=se(y.$$super)).length;pe<De;pe++)W.push(we[pe]);return y.$$ancestors_cache_version=x.const_cache_version,y.$$ancestors=W,W}function Ee(y){return y.hasOwnProperty("$$meta")&&null!==y.$$meta?se(y.$$meta):se(y.$$class)}function Ie(y,W){"number"==typeof W?y.$$arity=W:"object"==typeof W&&Object.assign(y,W)}x.falsy=function(y){return!M(y)},x.type_error=function(y,W,pe,we){y=y.$$class,q(x.TypeError,we&&pe?"can't convert "+y+" into "+W+" ("+y+"#"+pe+" gives "+(we=we.$$class)+")":"no implicit conversion of "+y+" into "+W)},x.coerce_to=function(y,W,pe,we){var De;return"to_int"===pe&&W===x.Integer&&y.$$is_number?y<0?Math.ceil(y):Math.floor(y):"to_str"===pe&&W===x.String&&y.$$is_string||x.is_a(y,W)?y:y["$respond_to?"].$$pristine&&y.$method_missing.$$pristine?((null==(De=y[Me(pe)])||De.$$stub)&&x.type_error(y,W),De.apply(y,we)):(y["$respond_to?"](pe)||x.type_error(y,W),null==we&&(we=[]),x.send(y,pe,we))},x.respond_to=function(y,W,pe){if(null==y||!y.$$class)return!1;pe=!!pe;var we=y[W];return y["$respond_to?"].$$pristine?"function"==typeof we&&!we.$$stub||(y["$respond_to_missing?"].$$pristine?void 0:x.send(y,y["$respond_to_missing?"],[W.substr(1),pe])):x.send(y,y["$respond_to?"],[W.substr(1),pe])},x.trace_class=!1,x.tracers_for_class=[],x.const_get_local=function(y,W,pe){var we;if(null!=y)return"::"===y&&(y=H),!y.$$is_module&&!y.$$is_class&&q(x.TypeError,y.toString()+" is not a class/module"),null!=(we=L(y,W))||pe?we:P(y,W)},x.const_get_qualified=function(y,W,pe){var we,De,Fe,Ye=x.const_cache_version;return null==W?(we=L(H,y))??x.const_get_qualified(H,y,pe):null!=y?("::"===y&&(y=H),!y.$$is_module&&!y.$$is_class&&q(x.TypeError,y.toString()+" is not a class/module"),null==(De=y.$$const_cache)&&(Z(y,"$$const_cache",Object.create(null)),De=y.$$const_cache),null==(Fe=De[W])||Fe[0]!==Ye?(null!=(we=L(y,W))||(we=k(y,W)),De[W]=[Ye,we]):we=Fe[1],null!=we||pe?we:P(y,W)):void 0},x.const_cache_version=1,x.const_get_relative=function(y,W,pe){var De,Ye,at,we=y[0],Fe=x.const_cache_version;return null==(Ye=y.$$const_cache)&&(Z(y,"$$const_cache",Object.create(null)),Ye=y.$$const_cache),null==(at=Ye[W])||at[0]!==Fe?(null!=(De=L(we,W))||null!=(De=function S(y,W){var pe,we,De;if(0!==y.length)for(pe=0,we=y.length;pe<we;pe++){if(null!=(De=y[pe].$$const[W]))return De;if(y[pe].$$autoload&&y[pe].$$autoload[W])return X(y[pe],W)}}(y,W))||null!=(De=k(we,W))||(De=function v(y,W){if(null==y||y.$$is_module)return k(H,W)}(we,W)),Ye[W]=[Fe,De]):De=at[1],null!=De||pe?De:P(we,W)},x.const_set=B,x.constants=function(y,W){null==W&&(W=!0);var pe,De,Fe,at,we=[y],Ye={};for(W&&(we=we.concat(se(y))),W&&y.$$is_module&&(we=we.concat([x.Object]).concat(se(x.Object))),De=0,Fe=we.length;De<Fe&&(pe=we[De],y===H||pe!=H);De++){for(at in pe.$$const)Ye[at]=!0;if(pe.$$autoload)for(at in pe.$$autoload)Ye[at]=!0}return Object.keys(Ye)},x.const_remove=function(y,W){if(x.const_cache_version++,null!=y.$$const[W]){var pe=y.$$const[W];return delete y.$$const[W],pe}if(y.$$autoload&&y.$$autoload[W])return delete y.$$autoload[W],_e;q(x.NameError,"constant "+y+"::"+y.$name()+" not defined")},x.const_get_relative_factory=function(y){return function(W,pe){return x.$$(y,W,pe)}},x.$$=x.const_get_relative,x.$$$=x.const_get_qualified,x.$r=x.const_get_relative_factory,x.allocate_class=te,x.klass=function(y,W,pe){var we;null==y||"::"==y?y=H:!y.$$is_class&&!y.$$is_module&&(y=y.$$class),null!=W&&(!W.hasOwnProperty||W.hasOwnProperty&&!W.hasOwnProperty("$$is_class"))&&(W.constructor&&"Function"==W.constructor.name?(we=W,W=H):q(x.TypeError,"superclass must be a Class ("+(W.constructor&&(W.constructor.name||W.constructor.$$name)||typeof W)+" given)"));var De=function D(y,W){var pe=L(y,W);if(pe)return pe.$$is_class||q(x.TypeError,W+" is not a class"),pe}(y,pe);return null!=De?W&&function fe(y,W){y.$$super!==W&&q(x.TypeError,"superclass mismatch for class "+y.$$name)}(De,W):(null==W&&(W=H),B(y,pe,De=te(pe,W)),W.$inherited&&W.$inherited(De),we&&x.bridge(we,De)),x.trace_class&&I(De),De},x.allocate_module=R,x.module=function(y,W){var pe;return null==y||"::"==y?y=H:!y.$$is_class&&!y.$$is_module&&(y=y.$$class),pe=function F(y,W){var pe=L(y,W);return null==pe&&y===H&&(pe=k(H,W)),pe&&!pe.$$is_module&&pe!==H&&q(x.TypeError,W+" is not a module"),pe}(y,W),null==pe&&B(y,W,pe=R(W)),x.trace_class&&I(pe),pe},x.get_singleton_class=function(y){return y.$$meta?y.$$meta:y.hasOwnProperty("$$is_class")?x.build_class_singleton_class(y):y.hasOwnProperty("$$is_module")?x.build_module_singleton_class(y):x.build_object_singleton_class(y)},x.build_class_singleton_class=function(y){if(y.$$meta)return y.$$meta;var pe=te(null,y===d?_:x.get_singleton_class(y.$$super),!0);return Z(pe,"$$is_singleton",!0),Z(pe,"$$singleton_of",y),g(y,pe),Z(y,"$$class",x.Class),pe},x.build_module_singleton_class=function(y){if(y.$$meta)return y.$$meta;var W=te(null,x.Module,!0);return Z(W,"$$is_singleton",!0),Z(W,"$$singleton_of",y),g(y,W),Z(y,"$$class",x.Module),W},x.build_object_singleton_class=function(y){var pe=te(_e,y.$$class,!0);return Z(pe,"$$is_singleton",!0),Z(pe,"$$singleton_of",y),delete pe.$$prototype.$$class,g(y,pe),pe},x.is_method=function(y){return"$"===y[0]&&"$"!==y[1]},x.instance_methods=function(y){for(var W=[],pe=[],we=se(y),De=0,Fe=we.length;De<Fe;De++){var at=we[De].$$prototype;at.hasOwnProperty("$$dummy")&&(at=at.$$define_methods_on);for(var It=Object.getOwnPropertyNames(at),At=0,ln=It.length;At<ln;At++){var Jt=It[At];if(x.is_method(Jt)){var Dn=Jt.slice(1),Tn=at[Jt];Tn.$$stub&&-1===W.indexOf(Dn)&&W.push(Dn),!Tn.$$stub&&-1===pe.indexOf(Dn)&&-1===W.indexOf(Dn)&&pe.push(Dn)}}}return pe},x.own_instance_methods=function(y){var W=[],pe=y.$$prototype;pe.hasOwnProperty("$$dummy")&&(pe=pe.$$define_methods_on);for(var we=Object.getOwnPropertyNames(pe),De=0,Fe=we.length;De<Fe;De++){var Ye=we[De];if(x.is_method(Ye)&&!pe[Ye].$$stub){var It=Ye.slice(1);W.push(It)}}return W},x.methods=function(y){return x.instance_methods(y.$$meta||y.$$class)},x.own_methods=function(y){return y.$$meta?x.own_instance_methods(y.$$meta):[]},x.receiver_methods=function(y){var W=x.get_singleton_class(y),pe=x.own_instance_methods(W),we=x.own_instance_methods(W.$$super);return pe.concat(we)},x.class_variables=function(y){var pe,W=se(y),De={};for(pe=W.length-1;pe>=0;pe--){var Fe=W[pe];for(var Ye in Fe.$$cvars)De[Ye]=Fe.$$cvars[Ye]}return De},x.class_variable_set=function(y,W,pe){var De,we=se(y);for(De=we.length-2;De>=0;De--){var Ye=we[De];if(A(Ye.$$cvars,W))return Ye.$$cvars[W]=pe,pe}return y.$$cvars[W]=pe,pe},x.class_variable_get=function(y,W,pe){if(A(y.$$cvars,W))return y.$$cvars[W];var De,we=se(y),Fe=we.length;for(De=0;De<Fe;De++){var Ye=we[De];if(A(Ye.$$cvars,W))return Ye.$$cvars[W]}return pe||q(x.NameError,"uninitialized class variable "+W+" in "+y.$name()),_e},x.append_features=function(y,W){var pe=se(y),we=[];-1!==pe.indexOf(W)&&q(x.ArgumentError,"cyclic include detected");for(var De=0,Fe=pe.length;De<Fe;De++){var at=p(pe[De]);Z(at,"$$included",!0),we.push(at)}var ln,Jt,It=se(W),At=C(we);if(-1===It.indexOf(y))ln=W.$$prototype,Jt=Object.getPrototypeOf(W.$$prototype);else{for(var Dn=W.$$prototype,Tn=Object.getPrototypeOf(Dn);null!=Tn&&(Tn.$$module!==y||!l(Tn));)Dn=Tn,Tn=Object.getPrototypeOf(Tn);if(Tn){for(var vr=Object.getPrototypeOf(Tn);vr.hasOwnProperty("$$iclass")&&!l(vr);)vr=Object.getPrototypeOf(vr);ln=Dn,Jt=vr}else ln=W.$$prototype,Jt=Object.getPrototypeOf(W.$$prototype)}U(ln,At.first),U(At.last,Jt),W.$$own_included_modules=function c(y){for(var pe,W=[],we=Object.getPrototypeOf(y.$$prototype);we&&!we.hasOwnProperty("$$class");)(pe=$(we))&&W.push(pe),we=Object.getPrototypeOf(we);return W}(W),x.const_cache_version++},x.prepend_features=function(y,W){var pe=se(y),we=[];-1!==pe.indexOf(W)&&q(x.ArgumentError,"cyclic prepend detected");for(var De=0,Fe=pe.length;De<Fe;De++){var at=p(pe[De]);Z(at,"$$prepended",!0),we.push(at)}var Jt,Dn,Tn,It=C(we),At=W.$$prototype,ln=Object.getPrototypeOf(At);if(At.hasOwnProperty("$$dummy")?Jt=At.$$define_methods_on:(Jt=m(W),function u(y){for(var W=y.$$prototype,pe=Object.getOwnPropertyNames(W),we=0;we<pe.length;we++){var De=pe[we];x.is_method(De)&&delete W[De]}}(W),Z(At,"$$dummy",!0),Z(At,"$$define_methods_on",Jt),U(At,Jt),U(Jt,ln)),-1===se(W).indexOf(y))for(Dn=At,Tn=Object.getPrototypeOf(At);null!=Tn&&!Tn.hasOwnProperty("$$root")&&Tn!==Jt&&Tn.hasOwnProperty("$$iclass");)Tn=Object.getPrototypeOf(Tn);else q(x.RuntimeError,"Prepending a module multiple times is not supported");U(Dn,It.first),U(It.last,Tn),W.$$own_prepended_modules=function f(y){var pe,W=[],we=Object.getPrototypeOf(y.$$prototype);if(y.$$prototype.hasOwnProperty("$$dummy"))for(;we&&we!==y.$$prototype.$$define_methods_on;)(pe=$(we))&&W.push(pe),we=Object.getPrototypeOf(we);return W}(W),x.const_cache_version++},x.bridge=function(y,W){y.hasOwnProperty("$$bridge")&&q(x.ArgumentError,"already bridged"),Z(y,"$$bridge",W),U(y.prototype,(W.$$super||x.Object).$$prototype),Z(W,"$$prototype",y.prototype),Z(W.$$prototype,"$$class",W),Z(W,"$$constructor",y),Z(W,"$$bridge",!0)},x.ancestors=se,x.included_modules=function(y){for(var W=[],pe=null,we=Object.getPrototypeOf(y.$$prototype);we&&Object.getPrototypeOf(we);we=Object.getPrototypeOf(we))(pe=$(we))&&pe.$$is_module&&we.$$iclass&&we.$$included&&W.push(pe);return W},x.add_stubs=function(y){for(var pe,we,W=x.BasicObject.$$prototype,De=0,Fe=(y=y.split(",")).length;De<Fe;De++)(null==(we=W[pe=Me(y[De])])||we.$$stub)&&x.add_stub_for(W,pe)},x.add_stub_for=function(y,W){Z(y,W,x.stub_for(W))},x.stub_for=function(y){function W(){this.$method_missing.$$p=W.$$p,W.$$p=null;for(var pe=new Array(arguments.length),we=0,De=pe.length;we<De;we++)pe[we]=arguments[we];return this.$method_missing.apply(this,[y.slice(1)].concat(pe))}return W.$$stub=!0,W},x.ac=function(y,W,pe,we){var De="";De+=pe.$$is_a_module?pe.$$name+".":pe.$$class.$$name+"#",q(x.ArgumentError,"["+(De+=we)+"] wrong number of arguments (given "+y+", expected "+W+")")},x.block_ac=function(y,W,pe){q(x.ArgumentError,"`block in "+pe+"': wrong number of arguments (given "+y+", expected "+W+")")},x.find_super=function(y,W,pe,we,De){for(var Ye,at,Fe=Me(W),At=(Ye=Ee(y)).indexOf(pe.$$owner)+1;At<Ye.length;At++){var Jt=Ye[At].$$prototype;if(Jt.hasOwnProperty("$$dummy")&&(Jt=Jt.$$define_methods_on),Jt.hasOwnProperty(Fe)){at=Jt[Fe];break}}return!we&&at&&at.$$stub&&y.$method_missing.$$pristine&&q(x.NoMethodError,"super: no superclass method `"+W+"' for "+y,W),at.$$stub&&!De?null:at},x.find_block_super=function(y,W,pe,we,De){var Fe=W;return pe||q(x.RuntimeError,"super called outside of method"),De&&pe.$$define_meth&&q(x.RuntimeError,"implicit argument passing of super from method defined by define_method() is not supported. Specify all arguments explicitly"),pe.$$def&&(Fe=pe.$$jsid),x.find_super(y,Fe,pe,we)},x.find_super_dispatcher=x.find_super,x.find_iter_super_dispatcher=x.find_block_super,x.yield1=function(y,W){"function"!=typeof y&&q(x.LocalJumpError,"no block given");var we=y.$$has_trailing_comma_in_args;return(y.length>1||(y.$$has_top_level_mlhs_arg||we)&&1===y.length)&&(W=x.to_ary(W)),(y.length>1||we&&1===y.length)&&W.$$is_array?y.apply(null,W):y(W)},x.yieldX=function(y,W){if("function"!=typeof y&&q(x.LocalJumpError,"no block given"),y.length>1&&1===W.length&&W[0].$$is_array)return y.apply(null,W[0]);if(!W.$$is_array){for(var pe=new Array(W.length),we=0,De=pe.length;we<De;we++)pe[we]=W[we];return y.apply(null,pe)}return y.apply(null,W)},x.rescue=function(y,W){for(var pe=0;pe<W.length;pe++){var we=W[pe];if(we.$$is_array){var De=x.rescue(y,we);if(De)return De}else if(we===x.JS.Error||we["$==="](y))return we}return null},x.is_a=function(y,W){return null!=W&&y.$$meta===W||y.$$class===W||(y.$$is_number&&W.$$is_number_class?!W.$$is_integer_class||y%1==0:-1!==se(y.$$is_class?x.get_singleton_class(y):y.$$meta||y.$$class).indexOf(W))},x.to_hash=function(y){if(y.$$is_hash)return y;if(y["$respond_to?"]("to_hash",!0)){var W=y.$to_hash();if(W.$$is_hash)return W;q(x.TypeError,"Can't convert "+y.$$class+" to Hash ("+y.$$class+"#to_hash gives "+W.$$class+")")}else q(x.TypeError,"no implicit conversion of "+y.$$class+" into Hash")},x.to_ary=function(y){if(y.$$is_array)return y;if(!y["$respond_to?"]("to_ary",!0))return[y];var W=y.$to_ary();return W===_e?[y]:W.$$is_array?W:void q(x.TypeError,"Can't convert "+y.$$class+" to Array ("+y.$$class+"#to_ary gives "+W.$$class+")")},x.to_a=function(y){if(y.$$is_array)return y.slice();if(!y["$respond_to?"]("to_a",!0))return[y];var W=y.$to_a();return W===_e?[y]:W.$$is_array?W:void q(x.TypeError,"Can't convert "+y.$$class+" to Array ("+y.$$class+"#to_a gives "+W.$$class+")")},x.extract_kwargs=function(y){var W=y[y.length-1];if(null!=W&&x.respond_to(W,"$to_hash",!0))return Y(y,y.length-1),W},x.kwrestargs=function(y,W){var De,pe=[],we={},Fe=y.$$smap;for(De in Fe)W[De]||(pe.push(De),we[De]=Fe[De]);return x.hash2(pe,we)};var ce={};function Me(y){return ce[y]||(ce[y]="$"+y)}function $e(y){return"function"==typeof y&&!y.$$stub}x.jsid=Me,x.send=function(y,W,pe,we,De){var Fe;return"function"==typeof W?(Fe=W,W=null):"string"==typeof W?Fe=y[Me(W)]:q(x.NameError,"Passed method should be a string or a function"),x.send2(y,Fe,W,pe,we,De)},x.send2=function(y,W,pe,we,De,Fe){return null==W&&null!=pe&&y.$method_missing&&(W=y.$method_missing,we=[pe].concat(we)),Ie(De,Fe),"function"==typeof De&&(W.$$p=De),W.apply(y,we)},x.refined_send=function(y,W,pe,we,De,Fe){var Ye,at,It,At,ln,Jt,Dn,Tn,vr,fa;for(At=Ee(W),Ye=0;Ye<At.length;Ye++)for(ln=x.id(At[Ye]),at=0;at<y.length;at++)for(It=(Jt=y[at]).length-1;It>=0;It--)if(!(typeof(Dn=Jt[It]).$$refine_modules>"u")&&!(typeof(Tn=Dn.$$refine_modules)[ln]>"u")&&typeof(vr=Tn[ln]).$$prototype[Me(pe)]<"u")return fa=vr.$$prototype[Me(pe)],x.send2(W,fa,pe,we,De,Fe);return x.send(W,pe,we,De,Fe)},x.lambda=function(y,W){return y.$$is_lambda=!0,Ie(y,W),y},x.def=function(y,W,pe,we){return Ie(pe,we),y===x.top?x.defn(x.Object,W,pe):!y.$$eval&&y.$$is_a_module?x.defn(y,W,pe):x.defs(y,W,pe)},x.defn=function(y,W,pe){he(y),pe.displayName=W,pe.$$owner=y;var we=W.substr(1),De=y.$$prototype;if(De.hasOwnProperty("$$dummy")&&(De=De.$$define_methods_on),Z(De,W,pe),y.$$is_module){y.$$module_function&&x.defs(y,W,pe);for(var Fe=0,Ye=y.$$iclasses,at=Ye.length;Fe<at;Fe++)Z(Ye[Fe],W,pe)}var At=y.$$singleton_of;return!y.$method_added||y.$method_added.$$stub||At?At&&At.$singleton_method_added&&!At.$singleton_method_added.$$stub&&At.$singleton_method_added(we):y.$method_added(we),we},x.defs=function(y,W,pe,we){return Ie(pe,we),(y.$$is_string||y.$$is_number)&&q(x.TypeError,"can't define singleton"),x.defn(x.get_singleton_class(y),W,pe)},x.rdef=function(y,W){A(y.$$prototype,W)||q(x.NameError,"method '"+W.substr(1)+"' not defined in "+y.$name()),delete y.$$prototype[W],y.$$is_singleton?y.$$prototype.$singleton_method_removed&&!y.$$prototype.$singleton_method_removed.$$stub&&y.$$prototype.$singleton_method_removed(W.substr(1)):y.$method_removed&&!y.$method_removed.$$stub&&y.$method_removed(W.substr(1))},x.udef=function(y,W){(!y.$$prototype[W]||y.$$prototype[W].$$stub)&&q(x.NameError,"method '"+W.substr(1)+"' not defined in "+y.$name()),x.add_stub_for(y.$$prototype,W),y.$$is_singleton?y.$$prototype.$singleton_method_undefined&&!y.$$prototype.$singleton_method_undefined.$$stub&&y.$$prototype.$singleton_method_undefined(W.substr(1)):y.$method_undefined&&!y.$method_undefined.$$stub&&y.$method_undefined(W.substr(1))},x.alias=function(y,W,pe){var Fe,Ye,we=Me(W),De=Me(pe);if(typeof y.$$prototype>"u"&&(y=x.Object),Fe=y.$$prototype[De],y.$$eval)return x.alias(x.get_singleton_class(y),W,pe);if(!$e(Fe)){for(var at=y.$$super;"function"!=typeof Fe&&at;)Fe=at[De],at=at.$$super;!$e(Fe)&&y.$$is_module&&(Fe=x.Object.$$prototype[De]),$e(Fe)||q(x.NameError,"undefined method `"+pe+"' for class `"+y.$name()+"'")}Fe.$$alias_of&&(Fe=Fe.$$alias_of),Ye=function(){var At,ln,Jt,It=Ye.$$p;for(At=new Array(arguments.length),ln=0,Jt=arguments.length;ln<Jt;ln++)At[ln]=arguments[ln];return Ye.$$p=null,x.send(this,Fe,At,It)};try{Object.defineProperty(Ye,"length",{value:Fe.length})}catch{}return Ye.displayName=W,Ye.$$arity=Fe.$$arity??Fe.length,Ye.$$parameters=Fe.$$parameters,Ye.$$source_location=Fe.$$source_location,Ye.$$alias_of=Fe,Ye.$$alias_name=W,x.defn(y,we,Ye),y},x.alias_gvar=function(y,W){return Object.defineProperty(z,y,{configurable:!0,enumerable:!0,get:function(){return z[W]},set:function(pe){z[W]=pe}}),_e},x.alias_native=function(y,W,pe){var we=Me(W),De=y.$$prototype[pe];return("function"!=typeof De||De.$$stub)&&q(x.NameError,"undefined native method `"+pe+"' for class `"+y.$name()+"'"),x.defn(y,we,De),y},x.hash_init=function(y){y.$$smap=Object.create(null),y.$$map=Object.create(null),y.$$keys=[]},x.hash_clone=function(y,W){W.$$none=y.$$none,W.$$proc=y.$$proc;for(var Ye,at,pe=0,we=y.$$keys,De=y.$$smap,Fe=we.length;pe<Fe;pe++)(Ye=we[pe]).$$is_string?at=De[Ye]:(at=Ye.value,Ye=Ye.key),x.hash_put(W,Ye,at)},x.hash_put=function(y,W,pe){if(W.$$is_string)return A(y.$$smap,W)||y.$$keys.push(W),void(y.$$smap[W]=pe);var we,De,Fe;if(we=y.$$by_identity?x.id(W):W.$hash(),!A(y.$$map,we))return y.$$keys.push(De={key:W,key_hash:we,value:pe}),void(y.$$map[we]=De);for(De=y.$$map[we];De;){if(W===De.key||W["$eql?"](De.key)){Fe=void 0,De.value=pe;break}Fe=De,De=De.next}Fe&&(y.$$keys.push(De={key:W,key_hash:we,value:pe}),Fe.next=De)},x.hash_get=function(y,W){if(W.$$is_string)return A(y.$$smap,W)?y.$$smap[W]:void 0;var pe,we;if(pe=y.$$by_identity?x.id(W):W.$hash(),A(y.$$map,pe))for(we=y.$$map[pe];we;){if(W===we.key||W["$eql?"](we.key))return we.value;we=we.next}},x.hash_delete=function(y,W){var pe,Fe,Ye,we=y.$$keys,De=we.length;if(W.$$is_string){if("string"!=typeof W&&(W=W.valueOf()),!A(y.$$smap,W))return;for(pe=0;pe<De;pe++)if((Ye=we[pe]).$$is_string&&"string"!=typeof Ye&&(Ye=Ye.valueOf()),Ye===W){we.splice(pe,1);break}return Fe=y.$$smap[W],delete y.$$smap[W],Fe}var at=W.$hash();if(A(y.$$map,at))for(var At,It=y.$$map[at];It;){if(W===It.key||W["$eql?"](It.key)){for(Fe=It.value,pe=0;pe<De;pe++)if(we[pe]===It){we.splice(pe,1);break}return At&&It.next?At.next=It.next:At?delete At.next:It.next?y.$$map[at]=It.next:delete y.$$map[at],Fe}At=It,It=It.next}},x.hash_rehash=function(y){for(var we,De,Fe,W=0,pe=y.$$keys.length;W<pe;W++)if(!y.$$keys[W].$$is_string&&(we=y.$$keys[W].key.$hash())!==y.$$keys[W].key_hash){for(De=y.$$map[y.$$keys[W].key_hash],Fe=void 0;De;){if(De===y.$$keys[W]){Fe&&De.next?Fe.next=De.next:Fe?delete Fe.next:De.next?y.$$map[y.$$keys[W].key_hash]=De.next:delete y.$$map[y.$$keys[W].key_hash];break}Fe=De,De=De.next}if(y.$$keys[W].key_hash=we,!A(y.$$map,we)){y.$$map[we]=y.$$keys[W];continue}for(De=y.$$map[we],Fe=void 0;De;){if(De===y.$$keys[W]){Fe=void 0;break}Fe=De,De=De.next}Fe&&(Fe.next=y.$$keys[W])}},x.hash=function(){var W,pe,we,De,Fe,y=arguments.length;if(1===y&&arguments[0].$$is_hash)return arguments[0];if(pe=new x.Hash,x.hash_init(pe),1===y){if(W=arguments[0],arguments[0].$$is_array){for(De=W.length,we=0;we<De;we++)2!==W[we].length&&q(x.ArgumentError,"value not of length 2: "+W[we].$inspect()),x.hash_put(pe,Fe=W[we][0],W[we][1]);return pe}for(Fe in W=arguments[0])A(W,Fe)&&x.hash_put(pe,Fe,W[Fe]);return pe}for(y%2!=0&&q(x.ArgumentError,"odd number of arguments for Hash"),we=0;we<y;we+=2)x.hash_put(pe,Fe=arguments[we],arguments[we+1]);return pe},x.hash2=function(y,W){var pe=new x.Hash;return pe.$$smap=W,pe.$$map=Object.create(null),pe.$$keys=y,pe},x.range=function(y,W,pe){var we=new x.Range;return we.begin=y,we.end=W,we.excl=pe,we};var ye=["constructor","displayName","__count__","__noSuchMethod__","__parent__","__proto__","hasOwnProperty","valueOf"];function he(y){y.$$frozen&&q(x.FrozenError,"can't modify frozen "+y.$class()+": "+y,x.hash2(["receiver"],{receiver:y}))}function Se(y,W){return"number"==typeof y&&"number"==typeof W}function be(y,W){return"number"==typeof y&&"number"==typeof W||"string"==typeof y&&"string"==typeof W}function ue(y){return function(){return y}}x.ivar=function(y){return-1!==ye.indexOf(y)&&(y+="$"),y},x.deny_frozen_access=he,x.freeze=function(y){return Z(y,"$$frozen",!0),y.hasOwnProperty("$$id")||Z(y,"$$id",re()),y.hasOwnProperty("$$meta")?y.$$meta.$freeze():Z(y,"$$meta",null),y.hasOwnProperty("$$comparable")||Z(y,"$$comparable",null),Object.seal(y),y},x.freeze_props=function(y){var W,pe,we;for(W in y)("string"!=(pe=typeof W)&&"object"!==pe||"$"!==W[0])&&(we=Object.getOwnPropertyDescriptor(y,W))&&we.enumerable&&we.writable&&function(){var De=y[W];Object.defineProperty(y,W,{get:function(){return De},set:function(Fe){he(y)},enumerable:!0})}()},x.escape_regexp=function(y){return y.replace(/([-[\]\/{}()*+?.^$\\| ])/g,"\\$1").replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r").replace(/[\f]/g,"\\f").replace(/[\t]/g,"\\t")},x.global_regexp=function(y){return y.global?y:(null==y.$$g?y.$$g=new RegExp(y.source,(y.multiline?"gm":"g")+(y.ignoreCase?"i":"")):y.$$g.lastIndex=null,y.$$g)},x.global_multiline_regexp=function(y){var W,pe;return y.global&&y.multiline?y:(pe="gm"+(y.ignoreCase?"i":""),y.multiline?(null==y.$$g&&(y.$$g=new RegExp(y.source,pe)),W=y.$$g):(null==y.$$gm&&(y.$$gm=new RegExp(y.source,pe)),W=y.$$gm),W.lastIndex=null,W)},x.regexp=function(y,W){for(var pe,we=typeof W<"u"&&W&&W.indexOf("i")>=0,De=0,Fe=y.length;De<Fe;De++)(pe=y[De])instanceof RegExp&&(pe.ignoreCase!==we&&x.Kernel.$warn("ignore case doesn't match for "+pe.source.$inspect(),x.hash({uplevel:1})),pe=pe.source),""===pe&&(pe="(?:"+pe+")"),y[De]=pe;return W?new RegExp(y.join(""),W):new RegExp(y.join(""))},x.modules={},x.loaded_features=["corelib/runtime"],x.current_dir=".",x.require_table={"corelib/runtime":!0},x.normalize=function(y){var W,pe,we=[];"."!==x.current_dir&&(y=x.current_dir.replace(/\/*$/,"/")+y);for(var Fe=0,Ye=(W=(y=(y=y.replace(/^\.\//,"")).replace(/\.(rb|opal|js)$/,"")).split("/")).length;Fe<Ye;Fe++)""!==(pe=W[Fe])&&(".."===pe?we.pop():we.push(pe));return we.join("/")},x.loaded=function(y){var W,pe,we;for(W=0,pe=y.length;W<pe;W++)we=x.normalize(y[W]),!x.require_table[we]&&(x.loaded_features.push(we),x.require_table[we]=!0)},x.load_normalized=function(y){x.loaded([y]);var W=x.modules[y];if(W){var pe=W(x);if(typeof Promise<"u"&&pe instanceof Promise)return pe.then(ue(!0))}else{var we=x.config.missing_require_severity,De="cannot load such file -- "+y;"error"===we?q(x.LoadError,De):"warning"===we&&le.warn("WARNING: LoadError: "+De)}return!0},x.load=function(y){return y=x.normalize(y),x.load_normalized(y)},x.require=function(y){return y=x.normalize(y),!x.require_table[y]&&x.load_normalized(y)},x.encodings=Object.create(null),x.set_encoding=function(y,W,pe){typeof pe>"u"&&(pe="encoding"),("string"==typeof y||!0===y.$$frozen)&&q(x.FrozenError,"can't modify frozen String");var we=x.find_encoding(W);return we===y[pe]||(y[pe]=we),y},x.find_encoding=function(y){var W=x.encodings,pe=W[y]||W[y.toUpperCase()];return pe||q(x.ArgumentError,"unknown encoding name - "+y),pe},x.enc=function(y,W){var pe=new String(y);return(pe=x.set_encoding(pe,W)).internal_encoding=pe.encoding,pe},x.binary=function(y){var W=new String(y);return x.set_encoding(W,"binary","internal_encoding")},x.last_promise=null,x.promise_unhandled_exception=!1,x.queue=function(y){if(x.last_promise)return x.last_promise=x.last_promise.then(function(){if(!x.promise_unhandled_exception)return y(x)}).catch(function(pe){x.respond_to(pe,"$full_message")&&(pe=pe.$full_message()),le.error(pe),x.promise_unhandled_exception=!0,x.exit(1)}),x.last_promise;var W=y(x);return"function"==typeof Promise&&"object"==typeof W&&W instanceof Promise&&(x.last_promise=W),W},x.rb_plus=function(y,W){return Se(y,W)?y+W:y["$+"](W)},x.rb_minus=function(y,W){return Se(y,W)?y-W:y["$-"](W)},x.rb_times=function(y,W){return Se(y,W)?y*W:y["$*"](W)},x.rb_divide=function(y,W){return Se(y,W)?y/W:y["$/"](W)},x.rb_lt=function(y,W){return Se(y,W)?y<W:y["$<"](W)},x.rb_gt=function(y,W){return Se(y,W)?y>W:y["$>"](W)},x.rb_le=function(y,W){return Se(y,W)?y<=W:y["$<="](W)},x.rb_ge=function(y,W){return Se(y,W)?y>=W:y["$>="](W)},x.eqeq=function ae(y,W){return be(y,W)?y===W:M(y["$=="](W))},x.eqeqeq=function(y,W){return be(y,W)?y===W:M(y["$==="](W))},x.neqeq=function(y,W){return be(y,W)?y!==W:M(y["$!="](W))},x.not=function(y){return null==y||!1===y||_e===y||!0!==y&&!y["$!"].$$pristine&&M(y["$!"]())},x.return_val=ue,x.return_self=function(){return this},x.return_ivar=function(y){return function(){return this[y]??_e}},x.assign_ivar=function(y){return function(W){return he(this),this[y]=W}},x.assign_ivar_val=function(y,W){return function(){return he(this),this[y]=W}},x.ensure_kwargs=function(y){return null==y?x.hash2([],{}):y.$$is_hash?y:void q(x.ArgumentError,"expected kwargs")},x.get_kwarg=function(y,W){return A(y.$$smap,W)||q(x.ArgumentError,"missing keyword: "+W),y.$$smap[W]},x.large_array_unpack=function(y){var we,W=y.split(","),pe=W.length;for(we=0;we<pe;we++)switch(W[we][0]){case void 0:W[we]=_e;break;case"-":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":W[we]=+W[we]}return W},x.BasicObject=d=te("BasicObject",null),x.Object=H=te("Object",x.BasicObject),x.Module=J=te("Module",x.Object),x.Class=_=te("Class",x.Module),x.Opal=w=R("Opal"),x.Kernel=O=R("Kernel"),U(x.BasicObject,x.Class.$$prototype),U(x.Object,x.Class.$$prototype),U(x.Module,x.Class.$$prototype),U(x.Class,x.Class.$$prototype),d.$$const.BasicObject=d,B(H,"BasicObject",d),B(H,"Object",H),B(H,"Module",J),B(H,"Class",_),B(H,"Opal",w),B(H,"Kernel",O),d.$$class=_,H.$$class=_,J.$$class=_,_.$$class=_,w.$$class=J,O.$$class=J,Z(H.$$prototype,"toString",function(){var y=this.$to_s();return y.$$is_string&&"object"==typeof y?y.valueOf():y}),Z(H.$$prototype,"$require",x.require),x.top=new H,x.top.$to_s=x.top.$inspect=ue("main"),x.top.$define_method=function Ce(){var y=N(arguments),W=Ce.$$p;return Ce.$$p=null,x.send(H,"define_method",y,W)},x.NilClass=te("NilClass",x.Object),B(H,"NilClass",x.NilClass),(_e=x.nil=new x.NilClass).$$id=4,_e.call=_e.apply=function(){q(x.LocalJumpError,"no block given")},_e.$$frozen=!0,_e.$$comparable=!1,Object.seal(_e),x.thrower=function(y){var W=new Error("unexpected "+y);return W.$thrower_type=y,W.$throw=function(pe){throw null==pe&&(pe=_e),W.$v=pe,W},W},x.t_eval_return=x.thrower("return"),TypeError.$$super=Error,x.file_sources={}}).call(this),Opal.loaded(["corelib/runtime.js"]),Opal.modules["corelib/helpers"]=function(E){var le=E.type_error,_e=E.coerce_to,d=E.module,H=E.defs,J=E.slice,_=E.eqeqeq,w=E.Kernel,O=E.truthy,x=E.Opal,K=E.nil,V=E.$$$;return function(A){var U=d("::","Opal");H(U,"$bridge",function(T,j){return E.bridge(T,j)}),H(U,"$coerce_to!",function(T,j,re,z){var q,M=K;return q=J(arguments,3),M=_e(T,j,re,q),_(j,M)||w.$raise(le(T,j,re,M)),M},-4),H(U,"$coerce_to?",function(T,j,re,z){var Z,M=K;return Z=J(arguments,3),!O(T["$respond_to?"](re))||(M=_e(T,j,re,Z),O(M["$nil?"]()))?K:(_(j,M)||w.$raise(le(T,j,re,M)),M)},-4),H(U,"$try_convert",function(T,j,re){return _(j,T)?T:O(T["$respond_to?"](re))?T.$__send__(re):K}),H(U,"$compare",function(T,j){var re;return re=T["$<=>"](j),O(re===K)&&w.$raise(V("ArgumentError"),"comparison of "+T.$class()+" with "+j.$class()+" failed"),re}),H(U,"$destructure",function(T){if(1==T.length)return T[0];if(T.$$is_array)return T;for(var j=new Array(T.length),re=0,z=j.length;re<z;re++)j[re]=T[re];return j}),H(U,"$respond_to?",function(T,j,re){return null==re&&(re=!1),!(null==T||!T.$$class)&&T["$respond_to?"](j,re)},-3),H(U,"$instance_variable_name!",function(T){return T=x["$coerce_to!"](T,V("String"),"to_str"),O(/^@[a-zA-Z_][a-zA-Z0-9_]*?$/.test(T))||w.$raise(V("NameError").$new("'"+T+"' is not allowed as an instance variable name",T)),T}),H(U,"$class_variable_name!",function(T){return T=x["$coerce_to!"](T,V("String"),"to_str"),O(T.length<3||"@@"!==T.slice(0,2))&&w.$raise(V("NameError").$new("`"+T+"' is not allowed as a class variable name",T)),T}),H(U,"$const_name?",function(T){return"string"!=typeof T&&(T=x["$coerce_to!"](T,V("String"),"to_str")),T[0]===T[0].toUpperCase()}),H(U,"$const_name!",function(T){return O(V("::","String","skip_raise")?"constant":K)&&(T=x["$coerce_to!"](T,V("String"),"to_str")),(!T||T[0]!=T[0].toUpperCase())&&this.$raise(V("NameError"),"wrong constant name "+T),T}),H(U,"$pristine",function(T,j){for(var z,Z,M=(z=J(arguments,1)).length-1;M>=0;M--)(Z=T.$$prototype[E.jsid(z[M])])&&!Z.$$stub&&(Z.$$pristine=!0);return K},-2);var N=[];return H(U,"$inspect",function(T){var re=!1;return function(){try{try{return null===T?"null":void 0===T?"undefined":typeof T.$$class>"u"?Object.prototype.toString.apply(T):"function"!=typeof T.$inspect||T.$inspect.$$stub||-1!==N.indexOf(T.$__id__())?"#<"+T.$$class+":0x"+T.$__id__().$to_s(16)+">":(N.push(T.$__id__()),re=!0,T.$inspect())}catch(z){if(!E.rescue(z,[V("Exception")]))throw z;try{return"#<"+T.$$class+":0x"+T.$__id__().$to_s(16)+">"}finally{E.pop_exception()}}}finally{re&&N.pop()}}()},-1)}()},Opal.modules["corelib/module"]=function(E){var l,c,f,u,le=E.truthy,_e=E.coerce_to,d=E.const_set,H=E.Object,J=E.return_ivar,_=E.assign_ivar,w=E.ivar,O=E.deny_frozen_access,x=E.freeze,K=E.prop,V=E.jsid,A=E.klass,U=E.defs,N=E.send,Y=E.def,T=E.eqeqeq,j=E.Module,re=E.Kernel,z=E.rb_lt,q=E.rb_gt,Z=E.slice,M=E.to_a,I=E.hash2,X=E.Opal,L=E.return_val,S=E.eqeq,k=E.lambda,v=E.range,P=E.send2,B=E.find_super,te=E.alias,fe=E.nil,R=E.$$$;return l=[],c=A("::",null,"Module"),f=[c].concat(l),u=E.$r(f),U(c,"$allocate",function(){var C=E.allocate_module(fe,function(){});return this!==E.Module&&Object.setPrototypeOf(C,this.$$prototype),C}),Y(c,"$initialize",function p(){var m=p.$$p||fe;return p.$$p=null,m!==fe?N(this,"module_eval",[],m.$to_proc()):fe}),Y(c,"$===",function(m){return!le(null==m)&&E.is_a(m,this)}),Y(c,"$<",function(m){var ie,se,Ee,C=this;if(T(j,m)||re.$raise(R("TypeError"),"compared with non class/module"),C===m)return!1;for(se=0,Ee=(ie=E.ancestors(C)).length;se<Ee;se++)if(ie[se]===m)return!0;for(se=0,Ee=(ie=E.ancestors(m)).length;se<Ee;se++)if(ie[se]===C)return!1;return fe}),Y(c,"$<=",function(m){var $;return le($=this["$equal?"](m))?$:z(this,m)}),Y(c,"$>",function(m){return T(j,m)||re.$raise(R("TypeError"),"compared with non class/module"),z(m,this)}),Y(c,"$>=",function(m){var $;return le($=this["$equal?"](m))?$:q(this,m)}),Y(c,"$<=>",function(m){var $=fe;return this===m?0:!T(j,m)||($=z(this,m),le($["$nil?"]()))?fe:le($)?-1:1}),Y(c,"$alias_method",function(m,C){var $=this;return O($),m=_e(m,R("String"),"to_str"),C=_e(C,R("String"),"to_str"),E.alias($,m,C),$}),Y(c,"$alias_native",function(m,C){var $=this;return null==C&&(C=m),O($),E.alias_native($,m,C),$},-2),Y(c,"$ancestors",function(){return E.ancestors(this)}),Y(c,"$append_features",function(m){return O(m),E.append_features(this,m),this}),Y(c,"$attr_accessor",function(m){var C,$,ie=this;return C=Z(arguments),N(ie,"attr_reader",M($=C)),N(ie,"attr_writer",M($))},-1),Y(c,"$attr",function(m){var $,ie=this;return 2!=($=Z(arguments)).length||!0!==$[1]&&!1!==$[1]?N(ie,"attr_reader",M($)):(ie.$warn("optional boolean argument is obsoleted",I(["uplevel"],{uplevel:1})),$[1]?ie.$attr_accessor($[0]):ie.$attr_reader($[0]),fe)},-1),Y(c,"$attr_reader",function(m){var $,ie=this;$=Z(arguments),O(ie);for(var se=ie.$$prototype,Ee=$.length-1;Ee>=0;Ee--){var Ie=$[Ee],ce=V(Ie),Me=w(Ie),$e=J(Me);E.prop(se,Me,fe),$e.$$parameters=[],$e.$$arity=0,E.defn(ie,ce,$e)}return fe},-1),Y(c,"$attr_writer",function(m){var $,ie=this;$=Z(arguments),O(ie);for(var se=ie.$$prototype,Ee=$.length-1;Ee>=0;Ee--){var Ie=$[Ee],ce=V(Ie+"="),Me=w(Ie),$e=_(Me);$e.$$parameters=[["req"]],$e.$$arity=1,E.prop(se,Me,fe),E.defn(ie,ce,$e)}return fe},-1),Y(c,"$autoload",function(m,C){var $=this;return O($),u("Opal")["$const_name?"](m)||re.$raise(R("NameError"),"autoload must be constant name: "+m),""==C&&re.$raise(R("ArgumentError"),"empty file name"),$.$$const.hasOwnProperty(m)||($.$$autoload||($.$$autoload={}),E.const_cache_version++,$.$$autoload[m]={path:C,loaded:!1,required:!1,success:!1,exception:!1},$.$const_added&&!$.$const_added.$$pristine&&$.$const_added(m)),fe}),Y(c,"$autoload?",function(m){var C=this;if(C.$$autoload&&C.$$autoload[m]&&!C.$$autoload[m].required&&!C.$$autoload[m].success)return C.$$autoload[m].path;for(var $=C.$ancestors(),ie=0,se=$.length;ie<se;ie++)if($[ie].$$autoload&&$[ie].$$autoload[m]&&!$[ie].$$autoload[m].required&&!$[ie].$$autoload[m].success)return $[ie].$$autoload[m].path;return fe}),Y(c,"$class_variables",function(){return Object.keys(E.class_variables(this))}),Y(c,"$class_variable_get",function(m){return m=X["$class_variable_name!"](m),E.class_variable_get(this,m,!1)}),Y(c,"$class_variable_set",function(m,C){return O(this),m=X["$class_variable_name!"](m),E.class_variable_set(this,m,C)}),Y(c,"$class_variable_defined?",function(m){return m=X["$class_variable_name!"](m),E.class_variables(this).hasOwnProperty(m)}),Y(c,"$const_added",L(fe)),X.$pristine(c,"const_added"),Y(c,"$remove_class_variable",function(m){var C=this;if(O(C),m=X["$class_variable_name!"](m),E.hasOwnProperty.call(C.$$cvars,m)){var $=C.$$cvars[m];return delete C.$$cvars[m],$}re.$raise(R("NameError"),"cannot remove "+m+" for "+C)}),Y(c,"$constants",function(m){return null==m&&(m=!0),E.constants(this,m)},-1),U(c,"$constants",function(m){if(null==m){var ie,Ee,Ie,$=(this.$$nesting||[]).concat(H),se={};for(Ee=0,Ie=$.length;Ee<Ie;Ee++)for(ie in $[Ee].$$const)se[ie]=!0;return Object.keys(se)}return E.constants(this,m)},-1),U(c,"$nesting",function(){return this.$$nesting||[]}),Y(c,"$const_defined?",function(m,C){var $=this;null==C&&(C=!0),m=u("Opal")["$const_name!"](m),le(m["$=~"](R(X,"CONST_NAME_REGEXP")))||re.$raise(R("NameError").$new("wrong constant name "+m,m));var ie,Ie,ce,se=[$];for(C&&(se=se.concat(E.ancestors($)),$.$$is_module&&(se=se.concat([H]).concat(E.ancestors(H)))),Ie=0,ce=se.length;Ie<ce;Ie++)if(null!=(ie=se[Ie]).$$const[m]||ie.$$autoload&&ie.$$autoload[m]&&!ie.$$autoload[m].required&&!ie.$$autoload[m].success)return!0;return!1},-2),Y(c,"$const_get",function(m,C){var $=this;return null==C&&(C=!0),0===(m=u("Opal")["$const_name!"](m)).indexOf("::")&&"::"!==m&&(m=m.slice(2)),le(-1!=m.indexOf("::")&&"::"!=m)?N(m.$split("::"),"inject",[$],function(se,Ee){return null==se&&(se=fe),null==Ee&&(Ee=fe),se.$const_get(Ee)}):(le(m["$=~"](R(X,"CONST_NAME_REGEXP")))||re.$raise(R("NameError").$new("wrong constant name "+m,m)),C?E.$$([$],m):E.const_get_local($,m))},-2),Y(c,"$const_missing",function(m){var $;return $=S(this,H)?m:this+"::"+m,re.$raise(R("NameError").$new("uninitialized constant "+$,m))}),Y(c,"$const_set",function(m,C){return O(this),m=X["$const_name!"](m),(le(m["$!~"](R(X,"CONST_NAME_REGEXP")))||le(m["$start_with?"]("::")))&&re.$raise(R("NameError").$new("wrong constant name "+m,m)),d(this,m,C),C}),Y(c,"$public_constant",L(fe)),Y(c,"$define_method",function p(m,C){var se,$=p.$$p||fe,Ee=fe;return p.$$p=null,O(this),void 0===C&&$===fe&&re.$raise(R("ArgumentError"),"tried to create a Proc object without a block"),$=le(se=$)?se:T(R("Proc"),Ee=C)?C:T(R("Method"),Ee)?C.$to_proc().$$unbound:T(R("UnboundMethod"),Ee)?k(function ce(Me){var ye,he=ce.$$s??this,Se=fe;return ye=Z(arguments),Se=C.$bind(he),N(Se,"call",M(ye))},{$$arity:-1,$$s:this}):re.$raise(R("TypeError"),"wrong argument type "+$.$class()+" (expected Proc/Method)"),typeof Proxy<"u"&&($.$$proxy_target=$,$=new Proxy($,{apply:function(ce,Me,$e){var ye=ce.$$jsid;ce.$$jsid=m;try{return ce.apply(Me,$e)}catch(he){if(he===ce.$$brk||he===ce.$$ret)return he.$v;throw he}finally{ce.$$jsid=ye}}})),$.$$jsid=m,$.$$s=null,$.$$def=$,$.$$define_meth=!0,E.defn(this,V(m),$)},-2),Y(c,"$freeze",function(){var m=this;return le(m["$frozen?"]())?m:(m.hasOwnProperty("$$base_module")||K(m,"$$base_module",null),x(m))}),Y(c,"$remove_method",function(m){var $,ie=this;$=Z(arguments);for(var se=0;se<$.length;se++){var Ee=$[se];"string"==typeof Ee||Ee.$$is_string||ie.$raise(R("TypeError"),ie.$name()+" is not a symbol nor a string"),O(ie),E.rdef(ie,"$"+Ee)}return ie},-1),Y(c,"$singleton_class?",function(){return!!this.$$is_singleton}),Y(c,"$include",function(m){for(var $,ie=this,se=($=Z(arguments)).length-1;se>=0;se--){var Ee=$[se];Ee.$$is_module||re.$raise(R("TypeError"),"wrong argument type "+Ee.$class()+" (expected Module)"),Ee.$append_features(ie),Ee.$included(ie)}return ie},-1),Y(c,"$included_modules",function(){return E.included_modules(this)}),Y(c,"$include?",function(m){m.$$is_module||re.$raise(R("TypeError"),"wrong argument type "+m.$class()+" (expected Module)");var $,ie,se,Ee=E.ancestors(this);for($=0,ie=Ee.length;$<ie;$++)if((se=Ee[$])===m&&se!==this)return!0;return!1}),Y(c,"$instance_method",function(m){var C=this,$=C.$$prototype[V(m)];return(!$||$.$$stub)&&re.$raise(R("NameError").$new("undefined method `"+m+"' for class `"+C.$name()+"'",m)),R("UnboundMethod").$new(C,$.$$owner||C,$,m)}),Y(c,"$instance_methods",function(m){return null==m&&(m=!0),le(m)?E.instance_methods(this):E.own_instance_methods(this)},-1),Y(c,"$included",L(fe)),Y(c,"$extended",L(fe)),Y(c,"$extend_object",function(m){return O(m),fe}),Y(c,"$method_added",function(m){return Z(arguments),fe},-1),Y(c,"$method_removed",function(m){return Z(arguments),fe},-1),Y(c,"$method_undefined",function(m){return Z(arguments),fe},-1),Y(c,"$module_eval",function p(m){var ie,se,C=p.$$p||fe,Ee=this,Ie=fe,$e=fe,ye=fe,he=fe,Se=fe;p.$$p=null,ie=Z(arguments),le(C["$nil?"]())&&le(!!E.compile)?(le(v(1,3,!1)["$cover?"](ie.$size()))||re.$raise(R("ArgumentError"),"wrong number of arguments (0 for 1..3)"),Ie=(se=[].concat(M(ie)))[0]??fe,$e=I(["file","eval"],{file:le(ye=se[1]??fe)?ye:"(eval)",eval:!0}),he=E.hash({arity_check:!1}).$merge($e),Se=X.$compile(Ie,he),C=N(re,"proc",[],function ue(){var Ce=ue.$$s??this;return new Function("Opal,self","return "+Se)(E,Ce)},{$$s:Ee})):le(ie["$any?"]())&&re.$raise(R("ArgumentError"),"wrong number of arguments ("+ie.$size()+" for 0)\n\n  NOTE:If you want to enable passing a String argument please add \"require 'opal-parser'\" to your script\n");var ae,be=C.$$s;return C.$$s=null,ae=C.apply(Ee,[Ee]),C.$$s=be,ae},-1),Y(c,"$module_exec",function p(m){var ie,C=p.$$p||fe,se=this;p.$$p=null,ie=Z(arguments),C===fe&&re.$raise(R("LocalJumpError"),"no block given");var Ie,Ee=C.$$s;return C.$$s=null,Ie=C.apply(se,ie),C.$$s=Ee,Ie},-1),Y(c,"$method_defined?",function(m){var $=this.$$prototype[V(m)];return!!$&&!$.$$stub}),Y(c,"$module_function",function(m){var $,ie=this;if($=Z(arguments),O(ie),0===$.length)return ie.$$module_function=!0,fe;for(var se=0,Ee=$.length;se<Ee;se++){var Ie=$[se],ce=V(Ie),Me=ie.$$prototype[ce];E.defs(ie,ce,Me)}return 1===$.length?$[0]:$},-1),Y(c,"$name",function(){var m=this;if(m.$$full_name)return m.$$full_name;for(var C=[],$=m;$;){if($.$$name===fe||null==$.$$name)return fe;if(C.unshift($.$$name),($=$.$$base_module)===H)break}return 0===C.length?fe:m.$$full_name=C.join("::")}),Y(c,"$prepend",function(m){var $,ie=this;0===($=Z(arguments)).length&&re.$raise(R("ArgumentError"),"wrong number of arguments (given 0, expected 1+)");for(var se=$.length-1;se>=0;se--){var Ee=$[se];Ee.$$is_module||re.$raise(R("TypeError"),"wrong argument type "+Ee.$class()+" (expected Module)"),Ee.$prepend_features(ie),Ee.$prepended(ie)}return ie},-1),Y(c,"$prepend_features",function(m){var C=this;return O(m),C.$$is_module||re.$raise(R("TypeError"),"wrong argument type "+C.$class()+" (expected Module)"),E.prepend_features(C,m),C}),Y(c,"$prepended",L(fe)),Y(c,"$remove_const",function(m){return O(this),E.const_remove(this,m)}),Y(c,"$to_s",function(){var C,m=this;return le(C=E.Module.$name.call(m))?C:"#<"+(m.$$is_module?"Module":"Class")+":0x"+m.$__id__().$to_s(16)+">"}),Y(c,"$undef_method",function(m){var $,ie=this;$=Z(arguments);for(var se=0;se<$.length;se++){var Ee=$[se];"string"==typeof Ee||Ee.$$is_string||ie.$raise(R("TypeError"),ie.$name()+" is not a symbol nor a string"),O(ie),E.udef(ie,"$"+$[se])}return ie},-1),Y(c,"$instance_variables",function(){var m=this,C=fe;E.Module.$$nesting=f,C=m.$constants();var $=[];for(var ie in m)m.hasOwnProperty(ie)&&"$"!==ie.charAt(0)&&"constructor"!==ie&&!C["$include?"](ie)&&$.push("@"+ie);return $}),Y(c,"$dup",function p(){var m=p.$$p||fe,C=this,$=fe;return p.$$p=null,($=P(C,B(C,"dup",p,!1,!0),"dup",[],m)).$copy_class_variables(C),$.$copy_constants(C),$}),Y(c,"$copy_class_variables",function(m){for(var $ in m.$$cvars)this.$$cvars[$]=m.$$cvars[$]}),Y(c,"$copy_constants",function(m){var $,ie=m.$$const;for($ in ie)d(this,$,ie[$])}),Y(c,"$refine",function p(m){var $,se,Ie,C=p.$$p||fe,ie=this,Ee=fe;return p.$$p=null,se=($=[ie,fe,fe])[0],Ee=$[1],Ie=E.id(m),typeof ie.$$refine_modules>"u"&&(ie.$$refine_modules=Object.create(null)),(Ee=typeof ie.$$refine_modules[Ie]>"u"?ie.$$refine_modules[Ie]=R("Refinement").$new():ie.$$refine_modules[Ie]).refinement_module=se,Ee.refined_class=m,N(Ee,"class_exec",[],C.$to_proc()),Ee}),Y(c,"$refinements",function(){var C=this.$$refine_modules,$=I([],{});if(typeof C>"u")return $;for(var ie in C)$["$[]="](C[ie].refined_class,C[ie]);return $}),Y(c,"$using",function(m){return re.$raise("Module#using is not permitted in methods")}),te(c,"class_eval","module_eval"),te(c,"class_exec","module_exec"),te(c,"inspect","to_s"),function(F,g){var l=A("::",g,"Refinement"),c=l.$$prototype;return c.refinement_module=c.refined_class=fe,l.$attr_reader("refined_class"),Y(l,"$inspect",function f(){var u=f.$$p||fe,p=this;return f.$$p=null,le(p.refinement_module)?"#<refinement:"+p.refined_class.$inspect()+"@"+p.refinement_module.$inspect()+">":P(p,B(p,"inspect",f,!1,!0),"inspect",[],u)})}(0,j)},Opal.modules["corelib/class"]=function(E){var re,z,q,Z,le=E.klass,_e=E.send,d=E.defs,H=E.def,J=E.rb_plus,_=E.return_val,w=E.slice,O=E.send2,x=E.find_super,K=E.Kernel,V=E.alias,N=E.nil,Y=E.$$$;return E.top.$require("corelib/module"),re=[],q=[z=le("::",null,"Class")].concat(re),Z=E.$r(q),d(z,"$new",function M(I){var X=M.$$p||N;if(M.$$p=null,null==I&&(I=Z("Object")),!I.$$is_class)throw E.TypeError.$new("superclass must be a Class");var L=E.allocate_class(N,I);return I.$inherited(L),X!==N&&_e(L,"class_eval",[],X.$to_proc()),L},-1),H(z,"$allocate",function(){var X=new this.$$constructor;return X.$$id=E.uid(),X}),H(z,"$descendants",function(){return J(this.$subclasses(),_e(this.$subclasses(),"map",[],"descendants".$to_proc()).$flatten())}),H(z,"$inherited",_(N)),H(z,"$initialize_dup",function(I){var X=this;X.$initialize_copy(I),X.$$name=null,X.$$full_name=null}),H(z,"$new",function M(I){var S,X=M.$$p||N,k=this;M.$$p=null,S=w(arguments);var v=k.$allocate();return E.send(v,v.$initialize,S,X),v},-1),H(z,"$subclasses",function(){var I=this;if(typeof WeakRef<"u"){var X,L,S=[];for(X=0;X<I.$$subclasses.length;X++)void 0!==(L=I.$$subclasses[X].deref())&&S.push(L);return S}return I.$$subclasses}),H(z,"$superclass",function(){return this.$$super||N}),H(z,"$to_s",function M(){var X=this;M.$$p=null;var L=X.$$singleton_of;return L&&L.$$is_a_module?"#<Class:"+L.$name()+">":L?"#<Class:#<"+L.$$class.$name()+":0x"+E.id(L).$to_s(16)+">>":O(X,x(X,"to_s",M,!1,!0),"to_s",[],null)}),H(z,"$attached_object",function(){var I=this;if(null!=I.$$singleton_of)return I.$$singleton_of;K.$raise(Y("TypeError"),"`"+I+"' is not a singleton class")}),V(z,"inspect","to_s")},Opal.modules["corelib/basic_object"]=function(E){"use strict";var z,_e=E.slice,d=E.def,H=E.alias,J=E.return_val,_=E.Opal,w=E.truthy,O=E.range,x=E.Kernel,K=E.to_a,V=E.hash2,A=E.send,U=E.eqeq,N=E.rb_ge,Y=E.nil,T=E.$$$;return d(z=(0,E.klass)("::",null,"BasicObject"),"$initialize",function(Z){return _e(arguments),Y},-1),d(z,"$==",function(Z){return this===Z}),d(z,"$eql?",function(Z){return this["$=="](Z)}),H(z,"equal?","=="),d(z,"$__id__",function(){var Z=this;return null!=Z.$$id||E.prop(Z,"$$id",E.uid()),Z.$$id}),d(z,"$__send__",function q(Z,M){var L,I=q.$$p||Y,S=this;q.$$p=null,L=_e(arguments,1),Z.$$is_string||S.$raise(T("TypeError"),S.$inspect()+" is not a symbol nor a string");var k=S[E.jsid(Z)];return k?(I!==Y&&(k.$$p=I),k.apply(S,L)):(I!==Y&&(S.$method_missing.$$p=I),S.$method_missing.apply(S,[Z].concat(L)))},-2),d(z,"$!",J(!1)),_.$pristine("!"),d(z,"$!=",function(Z){return this["$=="](Z)["$!"]()}),d(z,"$instance_eval",function q(Z){var X,L,M=q.$$p||Y,S=this,k=Y,B=Y,te=Y,D=Y,fe=Y;if(q.$$p=null,X=_e(arguments),w(M["$nil?"]())&&w(!!E.compile))w(O(1,3,!1)["$cover?"](X.$size()))||x.$raise(T("ArgumentError"),"wrong number of arguments (0 for 1..3)"),k=(L=[].concat(K(X)))[0]??Y,B=V(["file","eval"],{file:w(te=L[1]??Y)?te:"(eval)",eval:!0}),D=E.hash({arity_check:!1}).$merge(B),fe=_.$compile(k,D),M=A(x,"proc",[],function g(){var l=g.$$s??this;return new Function("Opal,self","return "+fe)(E,l)},{$$s:S});else{if(w(M["$nil?"]())&&w(N(X.$length(),1))&&U(X.$first()["$[]"](0),"@"))return S.$instance_variable_get(X.$first());w(X["$any?"]())&&x.$raise(T("ArgumentError"),"wrong number of arguments ("+X.$size()+" for 0)")}var F,R=M.$$s;if(M.$$s=null,S.$$is_a_module){S.$$eval=!0;try{F=M.call(S,S)}finally{S.$$eval=!1}}else F=M.call(S,S);return M.$$s=R,F},-1),d(z,"$instance_exec",function q(Z){var X,M=q.$$p||Y,L=this;q.$$p=null,X=_e(arguments),w(M)||x.$raise(T("ArgumentError"),"no block given");var k,S=M.$$s;if(M.$$s=null,L.$$is_a_module){L.$$eval=!0;try{k=M.apply(L,X)}finally{L.$$eval=!1}}else k=M.apply(L,X);return M.$$s=S,k},-1),d(z,"$singleton_method_added",function(Z){return _e(arguments),Y},-1),d(z,"$singleton_method_removed",function(Z){return _e(arguments),Y},-1),d(z,"$singleton_method_undefined",function(Z){return _e(arguments),Y},-1),d(z,"$method_missing",function q(Z,M){var L,S=this,k=Y;return q.$$p=null,L=_e(arguments,1),k=_.$inspect(S),x.$raise(T("NoMethodError").$new("undefined method `"+Z+"' for "+k,Z,L),Y,x.$caller(1))},-2),_.$pristine(z,"method_missing"),d(z,"$respond_to_missing?",function(Z,M){return null==M&&(M=!1),!1},-2)},Opal.modules["corelib/kernel"]=function(E){"use strict";var R,le=E.truthy,_e=E.coerce_to,d=E.respond_to,H=E.Opal,J=E.deny_frozen_access,_=E.freeze,w=E.freeze_props,O=E.jsid,x=E.module,K=E.return_val,V=E.def,A=E.Kernel,U=E.gvars,N=E.slice,Y=E.send,T=E.to_a,j=E.ensure_kwargs,re=E.eqeq,z=E.hash2,q=E.rb_plus,Z=E.eqeqeq,M=E.return_self,I=E.rb_le,X=E.extract_kwargs,L=E.rb_lt,S=E.Object,k=E.alias,v=E.klass,B=E.nil,te=E.$$$;return function(D,fe){var R=x("::","Kernel"),F=[R].concat([]),g=E.$r(F);V(R,"$=~",K(!1)),V(R,"$!~",function(f){return this["$=~"](f)["$!"]()}),V(R,"$===",function(f){var p;return le(p=this.$object_id()["$=="](f.$object_id()))?p:this["$=="](f)}),V(R,"$<=>",function(f){this.$$comparable=!0;var p=this["$=="](f);return p&&p!==B?0:B}),V(R,"$method",function(f){var u=this,p=u[O(f)];return(!p||p.$$stub)&&A.$raise(te("NameError").$new("undefined method `"+f+"' for class `"+u.$class()+"'",f)),te("Method").$new(u,p.$$owner||u.$class(),p,f)}),V(R,"$methods",function(f){return null==f&&(f=!0),le(f)?E.methods(this):E.own_methods(this)},-1),V(R,"$public_methods",function(f){return null==f&&(f=!0),le(f)?E.methods(this):E.receiver_methods(this)},-1),V(R,"$Array",function(f){var u;return f===B?[]:f.$$is_array?f:(u=H["$coerce_to?"](f,te("Array"),"to_ary"))!==B||(u=H["$coerce_to?"](f,te("Array"),"to_a"))!==B?u:[f]}),V(R,"$at_exit",function c(){var u,f=c.$$p||B;return null==U.__at_exit__&&(U.__at_exit__=B),c.$$p=null,U.__at_exit__=le(u=U.__at_exit__)?u:[],U.__at_exit__["$<<"](f),f}),V(R,"$caller",function(f,u){var p,m;null==f&&(f=1),null==u&&(u=B),m=[];for(var C=f+1,$=(p=(new Error).$backtrace()).length;C<$;C++)p[C].match(/runtime\.js/)||m.push(p[C]);return u!=B&&(m=m.slice(0,u)),m},-1),V(R,"$caller_locations",function(f){var u,m=this;return u=N(arguments),Y(Y(m,"caller",T(u)),"map",[],function($){return null==$&&($=B),te(te(te("Thread"),"Backtrace"),"Location").$new($)})},-1),V(R,"$class",function(){return this.$$class}),V(R,"$copy_instance_variables",function(f){var m,C,$,p=Object.keys(f);for(m=0,C=p.length;m<C;m++)"$"!==($=p[m]).charAt(0)&&f.hasOwnProperty($)&&(this[$]=f[$])}),V(R,"$copy_singleton_methods",function(f){var p,m,C,$;if(f.hasOwnProperty("$$meta")&&null!==f.$$meta){var ie=E.get_singleton_class(f),se=E.get_singleton_class(this);for(p=0,$=(C=Object.getOwnPropertyNames(ie.$$prototype)).length;p<$;p++)E.is_method(m=C[p])&&(se.$$prototype[m]=ie.$$prototype[m]);se.$$const=Object.assign({},ie.$$const),Object.setPrototypeOf(se.$$prototype,Object.getPrototypeOf(ie.$$prototype))}for(p=0,$=(C=Object.getOwnPropertyNames(f)).length;p<$;p++)"$"===(m=C[p]).charAt(0)&&"$"!==m.charAt(1)&&f.hasOwnProperty(m)&&(this[m]=f[m])}),V(R,"$clone",function(f){var u,p=this,m=B;return null==(u=(f=j(f)).$$smap.freeze)&&(u=B),le(u["$nil?"]())||re(u,!0)||re(u,!1)||p.$raise(g("ArgumentError"),"unexpected value for freeze: "+u.$class()),(m=p.$class().$allocate()).$copy_instance_variables(p),m.$copy_singleton_methods(p),m.$initialize_clone(p,z(["freeze"],{freeze:u})),(re(u,!0)||le(u["$nil?"]())&&le(p["$frozen?"]()))&&m.$freeze(),m},-1),V(R,"$initialize_clone",function(f,u){return u=j(u),this.$initialize_copy(f),this},-2),V(R,"$define_singleton_method",function c(f,u){var p=c.$$p||B;return c.$$p=null,Y(this.$singleton_class(),"define_method",[f,u],p.$to_proc())},-2),V(R,"$dup",function(){var f=this,u=B;return(u=f.$class().$allocate()).$copy_instance_variables(f),u.$initialize_dup(f),u}),V(R,"$initialize_dup",function(f){return this.$initialize_copy(f)}),V(R,"$enum_for",function c(f,u){var m,C,$,p=c.$$p||B,ie=this;return c.$$p=null,(m=N(arguments)).length>0&&(C=m.shift()),null==C&&(C="each"),$=m,Y(te("Enumerator"),"for",[ie,C].concat(T($)),p.$to_proc())},-1),V(R,"$equal?",function(f){return this===f}),V(R,"$exit",function(f){var u;for(null==U.__at_exit__&&(U.__at_exit__=B),null==f&&(f=!0),U.__at_exit__=le(u=U.__at_exit__)?u:[];!le(U.__at_exit__["$empty?"]());)U.__at_exit__.$pop().$call();return f=f.$$is_boolean?f?0:1:_e(f,te("Integer"),"to_int"),E.exit(f),B},-1),V(R,"$extend",function(f){var p,m=this;0==(p=N(arguments)).length&&m.$raise(te("ArgumentError"),"wrong number of arguments (given 0, expected 1+)"),J(m);for(var C=m.$singleton_class(),$=p.length-1;$>=0;$--){var ie=p[$];ie.$$is_module||A.$raise(te("TypeError"),"wrong argument type "+ie.$class()+" (expected Module)"),ie.$append_features(C),ie.$extend_object(m),ie.$extended(m)}return m},-1),V(R,"$freeze",function(){var f=this;return le(f["$frozen?"]())?f:"object"==typeof f?(w(f),_(f)):f}),V(R,"$frozen?",function(){switch(typeof this){case"string":case"symbol":case"number":case"boolean":return!0;case"object":return this.$$frozen||!1;default:return!1}}),V(R,"$gets",function(f){var u;return null==U.stdin&&(U.stdin=B),u=N(arguments),Y(U.stdin,"gets",T(u))},-1),V(R,"$hash",function(){return this.$__id__()}),V(R,"$initialize_copy",K(B));var l=[];V(R,"$inspect",function(){var f=this,u=B,p=B,m=B;return function(){try{try{return u="",p=f.$__id__(),le(l["$include?"](p))?u=" ...":(l["$<<"](p),m=!0,Y(f.$instance_variables(),"each",[],function $(ie){var Ee,Ie;return null==ie&&(ie=B),Ee=($.$$s??this).$instance_variable_get(ie),Ie=g("Opal").$inspect(Ee),u=q(u," "+ie+"="+Ie)},{$$s:f})),"#<"+f.$class()+":0x"+p.$to_s(16)+u+">"}catch($){if(!E.rescue($,[g("StandardError")]))throw $;try{return"#<"+f.$class()+":0x"+p.$to_s(16)+">"}finally{E.pop_exception()}}}finally{le(m)&&l.$pop()}}()}),V(R,"$instance_of?",function(f){return!f.$$is_class&&!f.$$is_module&&A.$raise(te("TypeError"),"class or module required"),this.$$class===f}),V(R,"$instance_variable_defined?",function(f){return f=H["$instance_variable_name!"](f),E.hasOwnProperty.call(this,f.substr(1))}),V(R,"$instance_variable_get",function(f){return f=H["$instance_variable_name!"](f),this[E.ivar(f.substr(1))]??B}),V(R,"$instance_variable_set",function(f,u){return J(this),f=H["$instance_variable_name!"](f),this[E.ivar(f.substr(1))]=u}),V(R,"$remove_instance_variable",function(f){var u=this;f=H["$instance_variable_name!"](f);var m,p=E.ivar(f.substr(1));return u.hasOwnProperty(p)?(m=u[p],delete u[p],m):A.$raise(te("NameError"),"instance variable "+f+" not defined")}),V(R,"$instance_variables",function(){var p,u=[];for(var m in this)this.hasOwnProperty(m)&&"$"!==m.charAt(0)&&(p="$"===m.substr(-1)?m.slice(0,m.length-1):m,u.push("@"+p));return u}),V(R,"$Integer",function(f,u){var p,m,C;return f.$$is_string?"0"===f?0:(void 0===u?u=0:(1===(u=_e(u,te("Integer"),"to_int"))||u<0||u>36)&&A.$raise(te("ArgumentError"),"invalid radix "+u),m=(m=(m=f.toLowerCase()).replace(/(\d)_(?=\d)/g,"$1")).replace(/^(\s*[+-]?)(0[bodx]?)/,function($,ie,se){switch(se){case"0b":if(0===u||2===u)return u=2,ie;case"0":case"0o":if(0===u||8===u)return u=8,ie;case"0d":if(0===u||10===u)return u=10,ie;case"0x":if(0===u||16===u)return u=16,ie}A.$raise(te("ArgumentError"),'invalid value for Integer(): "'+f+'"')}),C="0-"+((u=0===u?10:u)<=10?u-1:"9a-"+String.fromCharCode(u-11+97)),new RegExp("^\\s*[+-]?["+C+"]+\\s*$").test(m)||A.$raise(te("ArgumentError"),'invalid value for Integer(): "'+f+'"'),p=parseInt(m,u),isNaN(p)&&A.$raise(te("ArgumentError"),'invalid value for Integer(): "'+f+'"'),p):(void 0!==u&&A.$raise(te("ArgumentError"),"base specified for non string value"),f===B&&A.$raise(te("TypeError"),"can't convert nil into Integer"),f.$$is_number?((f===1/0||f===-1/0||isNaN(f))&&A.$raise(te("FloatDomainError"),f),Math.floor(f)):f["$respond_to?"]("to_int")&&(p=f.$to_int())!==B?p:H["$coerce_to!"](f,te("Integer"),"to_i"))},-2),V(R,"$Float",function(f){var u;return f===B&&A.$raise(te("TypeError"),"can't convert nil into Float"),f.$$is_string?(u=(u=f.toString()).replace(/(\d)_(?=\d)/g,"$1"),/^\s*[-+]?0[xX][0-9a-fA-F]+\s*$/.test(u)?A.$Integer(u):(/^\s*[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?\s*$/.test(u)||A.$raise(te("ArgumentError"),'invalid value for Float(): "'+f+'"'),parseFloat(u))):H["$coerce_to!"](f,te("Float"),"to_f")}),V(R,"$Hash",function(f){return le(f["$nil?"]())||re(f,[])?z([],{}):Z(te("Hash"),f)?f:H["$coerce_to!"](f,te("Hash"),"to_hash")}),V(R,"$is_a?",function(f){return!f.$$is_class&&!f.$$is_module&&A.$raise(te("TypeError"),"class or module required"),E.is_a(this,f)}),V(R,"$itself",M),V(R,"$lambda",function c(){var f=c.$$p||B;return c.$$p=null,E.lambda(f)}),V(R,"$load",function(f){return f=H["$coerce_to!"](f,te("String"),"to_str"),E.load(f)}),V(R,"$loop",function c(){var f=c.$$p||B,p=B;if(c.$$p=null,f===B)return Y(this,"enum_for",["loop"],function(){return te(te("Float"),"INFINITY")});for(;le(!0);)try{E.yieldX(f,[])}catch(m){if(!E.rescue(m,[te("StopIteration")]))throw m;p=m;try{return p.$result()}finally{E.pop_exception()}}return this}),V(R,"$nil?",K(!1)),V(R,"$printf",function(f){var u,p,m=this;return u=N(arguments),le((p=u)["$any?"]())&&m.$print(Y(m,"format",T(p))),B},-1),V(R,"$proc",function c(){var f=c.$$p||B;return c.$$p=null,le(f)||A.$raise(te("ArgumentError"),"tried to create Proc object without a block"),f.$$is_lambda=!1,f}),V(R,"$puts",function(f){var u;return null==U.stdout&&(U.stdout=B),u=N(arguments),Y(U.stdout,"puts",T(u))},-1),V(R,"$p",function(f){var u,p;return u=N(arguments),Y(p=u,"each",[],function(C){return null==U.stdout&&(U.stdout=B),null==C&&(C=B),U.stdout.$puts(C.$inspect())}),le(I(p.$length(),1))?p["$[]"](0):p},-1),V(R,"$print",function(f){var u;return null==U.stdout&&(U.stdout=B),u=N(arguments),Y(U.stdout,"print",T(u))},-1),V(R,"$readline",function(f){var u;return null==U.stdin&&(U.stdin=B),u=N(arguments),Y(U.stdin,"readline",T(u))},-1),V(R,"$warn",function(f,u){var p,m,C,$,ie,se,Ee=this,Ie=B;return null==U.VERBOSE&&(U.VERBOSE=B),null==U.stderr&&(U.stderr=B),p=N(arguments),m=X(p),C=p,null==($=(m=j(m)).$$smap.uplevel)&&($=B),le($)&&($=H["$coerce_to!"]($,te("Integer"),"to_str"),le(L($,0))&&A.$raise(te("ArgumentError"),"negative level ("+$+")"),ie=(se=Ee.$caller(q($,1),1).$first())===B||null==se?B:se.$split(":in `"),Ie=ie===B||null==ie?B:ie.$first(),le(Ie)&&(Ie+=": "),C=Y(C,"map",[],function(Me){return null==Me&&(Me=B),Ie+"warning: "+Me})),le(U.VERBOSE["$nil?"]())||le(C["$empty?"]())?B:Y(U.stderr,"puts",T(C))},-1),V(R,"$raise",function(f,u,p){throw null==U["!"]&&(U["!"]=B),null==U["@"]&&(U["@"]=B),null==u&&(u=B),null==p&&(p=B),null==f&&U["!"]!==B?U["!"]:(null==f?f=te("RuntimeError").$new(""):d(f,"$to_str")?f=te("RuntimeError").$new(f.$to_str()):f.$$is_class&&d(f,"$exception")?f=f.$exception(u):f.$$is_exception||(f=te("TypeError").$new("exception class/object expected")),p!==B&&f.$set_backtrace(p),U["!"]!==B&&E.exceptions.push(U["!"]),U["!"]=f,U["@"]=f.$backtrace(),f)},-1),V(R,"$rand",function(f){return void 0===f?te(te("Random"),"DEFAULT").$rand():(f.$$is_number&&(f<0&&(f=Math.abs(f)),f%1!=0&&(f=f.$to_i()),0===f&&(f=void 0)),te(te("Random"),"DEFAULT").$rand(f))},-1),V(R,"$respond_to?",function(f,u){var p=this;null==u&&(u=!1);var m=p[O(f)];return"function"==typeof m&&!m.$$stub||!0!==p["$respond_to_missing?"].$$pristine&&p["$respond_to_missing?"](f,u)},-2),V(R,"$respond_to_missing?",function(f,u){return null==u&&(u=!1),!1},-2),H.$pristine(R,"respond_to?","respond_to_missing?"),V(R,"$require",function(f){return"string"!=typeof f&&E.String&&E.Array&&(f=H["$coerce_to!"](f,te("String"),"to_str")),E.require(f)}),V(R,"$require_relative",function(f){return H["$try_convert!"](f,te("String"),"to_str"),f=te("File").$expand_path(te("File").$join(E.current_file,"..",f)),E.require(f)}),V(R,"$require_tree",function(f,u){var p;null==(p=(u=j(u)).$$smap.autoload)&&(p=!1);var m=[];for(var C in f=te("File").$expand_path(f),"."===(f=E.normalize(f))&&(f=""),E.modules)C["$start_with?"](f)&&m.push(p?[C,!0]:[C,E.require(C)]);return m},-2),V(R,"$singleton_class",function(){return E.get_singleton_class(this)}),V(R,"$sleep",function(f){null==f&&(f=B),f===B&&A.$raise(te("TypeError"),"can't convert NilClass into time interval"),f.$$is_number||A.$raise(te("TypeError"),"can't convert "+f.$class()+" into time interval"),f<0&&A.$raise(te("ArgumentError"),"time interval must be positive");for(var u=E.global.performance?function(){return performance.now()}:function(){return new Date},p=u();u()-p<=1e3*f;);return Math.round(f)},-1),V(R,"$srand",function(f){return null==f&&(f=g("Random").$new_seed()),te("Random").$srand(f)},-1),V(R,"$String",function(f){var u;return le(u=H["$coerce_to?"](f,te("String"),"to_str"))?u:H["$coerce_to!"](f,te("String"),"to_s")}),V(R,"$tap",function c(){var f=c.$$p||B;return c.$$p=null,E.yield1(f,this),this}),V(R,"$to_proc",M),V(R,"$to_s",function(){return"#<"+this.$class()+":0x"+this.$__id__().$to_s(16)+">"}),V(R,"$catch",function c(f){var u=c.$$p||B,p=B,m=B;c.$$p=null,null==f&&(f=B);try{return f=le(p=f)?p:S.$new(),E.yield1(u,f)}catch(C){if(!E.rescue(C,[te("UncaughtThrowError")]))throw C;m=C;try{return re(m.$tag(),f)?m.$value():A.$raise()}finally{E.pop_exception()}}},-1),V(R,"$throw",function(f,u){return null==u&&(u=B),A.$raise(te("UncaughtThrowError").$new(f,u))},-2),V(R,"$open",function c(f){var m,u=c.$$p||B;return c.$$p=null,m=N(arguments),Y(te("File"),"open",T(m),u.$to_proc())},-1),V(R,"$yield_self",function c(){var f=c.$$p||B;return c.$$p=null,f===B?Y(this,"enum_for",["yield_self"],K(1)):E.yield1(f,this)}),k(R,"fail","raise"),k(R,"kind_of?","is_a?"),k(R,"object_id","__id__"),k(R,"public_send","__send__"),k(R,"send","__send__"),k(R,"then","yield_self"),k(R,"to_enum","enum_for")}(),R=v("::",null,"Object"),delete S.$$prototype.$require,R.$include(A)},Opal.modules["corelib/main"]=function(E){var x,le=E.return_val,_e=E.def,d=E.Object,H=E.slice,J=E.Kernel;return _e(x=E.get_singleton_class(E.top),"$to_s",le("main")),_e(x,"$include",function(A){return d.$include(A)}),_e(x,"$autoload",function(A){var U;return U=H(arguments),E.Object.$autoload.apply(E.Object,U)},-1),_e(x,"$using",function(A){return J.$raise("main.using is permitted only at toplevel")})},Opal.modules["corelib/error/errno"]=function(E){var A,U,N,le=E.module,_e=E.truthy,d=E.rb_plus,H=E.send2,J=E.find_super,_=E.def,w=E.klass,O=[],x=E.nil,K=E.$$$;return function(V,A){var Y,j,U=le("::","Errno"),T=([U].concat(A),x);for(Y=[["EINVAL","Invalid argument",22],["EEXIST","File exists",17],["EISDIR","Is a directory",21],["EMFILE","Too many open files",24],["ESPIPE","Illegal seek",29],["EACCES","Permission denied",13],["EPERM","Operation not permitted",1],["ENOENT","No such file or directory",2],["ENAMETOOLONG","File name too long",36]],T=x,j=0;j<Y.length;j++)!function(){var Z,z=Y[j][1],q=Y[j][2];(T=E.klass(U,E.SystemCallError,Y[j][0])).errno=q,Z=E.get_singleton_class(T),_(Z,"$new",function I(X){var k=x;return I.$$p=null,null==X&&(X=x),k=z,_e(X)&&(k=d(k," - "+X)),H(this,J(this,"new",I,!1,!0),"new",[k],null)},-1)}()}(0,O),A=K("StandardError"),U=O,[N=w("::",A,"SystemCallError")].concat(U),_(N,"$errno",function(){return this.$class().$errno()}),E.get_singleton_class(N).$attr_reader("errno")},Opal.modules["corelib/error"]=function(E){var I,X,le=E.klass,_e=E.slice,d=E.gvars,H=E.defs,J=E.send,_=E.to_a,w=E.def,O=E.truthy,x=E.hash2,K=E.Kernel,V=E.not,A=E.rb_plus,U=E.eqeq,N=E.Object,Y=E.ensure_kwargs,T=E.send2,j=E.find_super,re=E.module,z=[],q=E.nil,Z=E.$$$;return function(M,I,X){var P,L=le("::",I,"Exception"),S=[L].concat(X),k=E.$r(S);function B(te){for(var fe,D=[],R=0;R<te.length;R++){var F=te[R];!F||!F.$$is_string||((fe=F.match(/^    at (.*?) \((.*?)\)$/))?D.push(fe[2]+":in `"+fe[1]+"'"):(fe=F.match(/^    at (.*?)$/))?D.push(fe[1]+":in `undefined'"):(fe=F.match(/^  from (.*?)$/))?D.push(fe[1]):(fe=F.match(/^(.*?)@(.*?)$/))&&D.push(fe[2]+":in `"+fe[1]+"'"))}return D}L.$$prototype.message=q,E.prop(L.$$prototype,"$$is_exception",!0),Error.stackTraceLimit=100,H(L,"$new",function(D){var R,F=this;null==d["!"]&&(d["!"]=q);var g=(R=_e(arguments)).length>0?R[0]:q,l=new F.$$constructor(g);return l.name=F.$$name,l.message=g,l.cause=d["!"],E.send(l,l.$initialize,R),E.config.enable_stack_trace&&Error.captureStackTrace&&Error.captureStackTrace(l,P),l},-1),P=L.$new,H(L,"$exception",function(D){var fe,F=this;return fe=_e(arguments),J(F,"new",_(fe))},-1),w(L,"$initialize",function(D){var fe,R,F=this;return fe=_e(arguments),F.message=(R=fe).length>0?R[0]:q},-1),w(L,"$backtrace",function(){var D=this;if(D.backtrace)return D.backtrace;var fe=D.stack;return typeof fe<"u"&&fe.$$is_string?D.backtrace=B(fe.split("\n")):fe?D.backtrace=B(fe):[]}),w(L,"$backtrace_locations",function(){var D;return this.backtrace_locations||(this.backtrace_locations=(D=this.$backtrace())===q||null==D?q:J(D,"map",[],function(F){return null==F&&(F=q),Z(Z(Z("Thread"),"Backtrace"),"Location").$new(F)})),this.backtrace_locations}),w(L,"$cause",function(){return this.cause||q}),w(L,"$exception",function(D){var fe=this;if(null==D&&(D=q),D===q||fe===D)return fe;var R=fe.$clone();return R.message=D,fe.backtrace&&(R.backtrace=fe.backtrace.$dup()),R.stack=fe.stack,R.cause=fe.cause,R},-1),w(L,"$message",function(){return this.$to_s()}),w(L,"$full_message",function(D){var R,F=this,g=q,l=q,c=q,f=q,u=q,p=q,m=q,C=q,$=q;return null==d.stderr&&(d.stderr=q),null==D&&(D=q),O(k("Hash","skip_raise")?"constant":q)?(c=(R=[(D=x(["highlight","order"],{highlight:d.stderr["$tty?"](),order:"top"}).$merge(O(g=D)?g:x([],{})))["$[]"]("highlight"),D["$[]"]("order")])[1],O([!0,!1]["$include?"](l=R[0]))||K.$raise(Z("ArgumentError"),"expected true or false as highlight: "+l),O(["top","bottom"]["$include?"](c))||K.$raise(Z("ArgumentError"),"expected :top or :bottom as order: "+c),O(l)?(f="\x1b[1;4m",u="\x1b[1m",p="\x1b[m"):f=u=p="",m=F.$backtrace().$dup(),(V(m)||O(m["$empty?"]()))&&(m=F.$caller()),C=m.$shift(),$=A($=C+": ",""+u+F.$to_s()+" ("+f+F.$class()+p+u+")"+p+"\n"),$=A($,J(m,"map",[],function(se){return null==se&&(se=q),"\tfrom "+se+"\n"}).$join()),O(F.$cause())&&($=A($,F.$cause().$full_message(x(["highlight"],{highlight:l})))),U(c,"bottom")&&($=$.$split("\n").$reverse().$join("\n"),$=A(u+"Traceback"+p+" (most recent call last):\n",$)),$):F.message+"\n"+F.stack},-1),w(L,"$inspect",function(){var D=this,fe=q;return fe=D.$to_s(),O(fe["$empty?"]())?D.$class().$to_s():"#<"+D.$class().$to_s()+": "+D.$to_s()+">"}),w(L,"$set_backtrace",function(D){var F,g,fe=this,R=!0;if(D===q)fe.backtrace=q,fe.stack="";else if(D.$$is_string)fe.backtrace=[D],fe.stack="  from "+D;else{if(D.$$is_array){for(F=0,g=D.length;F<g;F++)if(!D[F].$$is_string){R=!1;break}}else R=!1;!1===R&&K.$raise(Z("TypeError"),"backtrace must be Array of String"),fe.backtrace=D,fe.stack=J(D,"map",[],function(c){return null==c&&(c=q),A("  from ",c)}).join("\n")}return D}),w(L,"$to_s",function(){var fe,R,D=this;return O(fe=O(R=D.message)?D.message.$to_s():R)?fe:D.$class().$to_s()})}(0,Error,z),le("::",Z("Exception"),"ScriptError"),le("::",Z("ScriptError"),"SyntaxError"),le("::",Z("ScriptError"),"LoadError"),le("::",Z("ScriptError"),"NotImplementedError"),le("::",Z("Exception"),"SystemExit"),le("::",Z("Exception"),"NoMemoryError"),le("::",Z("Exception"),"SignalException"),le("::",Z("SignalException"),"Interrupt"),le("::",Z("Exception"),"SecurityError"),le("::",Z("Exception"),"SystemStackError"),le("::",Z("Exception"),"StandardError"),le("::",Z("StandardError"),"EncodingError"),le("::",Z("StandardError"),"ZeroDivisionError"),le("::",Z("StandardError"),"NameError"),le("::",Z("NameError"),"NoMethodError"),le("::",Z("StandardError"),"RuntimeError"),le("::",Z("RuntimeError"),"FrozenError"),le("::",Z("StandardError"),"LocalJumpError"),le("::",Z("StandardError"),"TypeError"),le("::",Z("StandardError"),"ArgumentError"),le("::",Z("ArgumentError"),"UncaughtThrowError"),le("::",Z("StandardError"),"IndexError"),le("::",Z("IndexError"),"StopIteration"),le("::",Z("StopIteration"),"ClosedQueueError"),le("::",Z("IndexError"),"KeyError"),le("::",Z("StandardError"),"RangeError"),le("::",Z("RangeError"),"FloatDomainError"),le("::",Z("StandardError"),"IOError"),le("::",Z("IOError"),"EOFError"),le("::",Z("StandardError"),"SystemCallError"),le("::",Z("StandardError"),"RegexpError"),le("::",Z("StandardError"),"ThreadError"),le("::",Z("StandardError"),"FiberError"),N.$autoload("Errno","corelib/error/errno"),I=Z("RuntimeError"),(X=le("::",I,"FrozenError")).$attr_reader("receiver"),w(X,"$initialize",function L(S,k){var v,B=this;return L.$$p=null,null==(v=(k=Y(k)).$$smap.receiver)&&(v=q),T(B,j(B,"initialize",L,!1,!0),"initialize",[S],null),B.receiver=v},-2),function(M,I){var X=le("::",I,"UncaughtThrowError");X.$$prototype.tag=q,X.$attr_reader("tag","value"),w(X,"$initialize",function S(k,v){var B=this;return S.$$p=null,null==v&&(v=q),B.tag=k,B.value=v,T(B,j(B,"initialize",S,!1,!0),"initialize",["uncaught throw "+B.tag.$inspect()],null)},-2)}(0,Z("ArgumentError")),function(M,I){var X=le("::",null,"NameError");X.$attr_reader("name"),w(X,"$initialize",function L(S,k){var P=this;return L.$$p=null,null==k&&(k=q),T(P,j(P,"initialize",L,!1,!0),"initialize",[S],null),P.name=k},-2)}(),function(M,I){var X=le("::",null,"NoMethodError");X.$attr_reader("args"),w(X,"$initialize",function L(S,k,v){var B=this;return L.$$p=null,null==k&&(k=q),null==v&&(v=[]),T(B,j(B,"initialize",L,!1,!0),"initialize",[S,k],null),B.args=v},-2)}(),le("::",null,"StopIteration").$attr_reader("result"),function(M,I){var X=le("::",null,"KeyError"),L=X.$$prototype;L.receiver=L.key=q,w(X,"$initialize",function S(k,v){var P,B,D=this;return S.$$p=null,null==(P=(v=Y(v)).$$smap.receiver)&&(P=q),null==(B=v.$$smap.key)&&(B=q),T(D,j(D,"initialize",S,!1,!0),"initialize",[k],null),D.receiver=P,D.key=B},-2),w(X,"$receiver",function(){var v;return O(v=this.receiver)?v:K.$raise(Z("ArgumentError"),"no receiver is available")}),w(X,"$key",function(){var v;return O(v=this.key)?v:K.$raise(Z("ArgumentError"),"no key is available")})}(),function(M,I){var L=[re("::","JS")].concat(I);return le(L[0],null,"Error"),q}(0,z)},Opal.modules["corelib/constants"]=function(E){var le=E.const_set,d=E.$$$;return le("::","RUBY_PLATFORM","opal"),le("::","RUBY_ENGINE","opal"),le("::","RUBY_VERSION","3.2.0"),le("::","RUBY_ENGINE_VERSION","1.7.1"),le("::","RUBY_RELEASE_DATE","2023-01-06"),le("::","RUBY_PATCHLEVEL",0),le("::","RUBY_REVISION","0"),le("::","RUBY_COPYRIGHT","opal - Copyright (C) 2013-2022 Adam Beynon and the Opal contributors"),le("::","RUBY_DESCRIPTION","opal "+d("RUBY_ENGINE_VERSION")+" ("+d("RUBY_RELEASE_DATE")+" revision "+d("RUBY_REVISION")+")")},Opal.modules["opal/base"]=function(E){var le=E.Object;return le.$require("corelib/runtime"),le.$require("corelib/helpers"),le.$require("corelib/module"),le.$require("corelib/class"),le.$require("corelib/basic_object"),le.$require("corelib/kernel"),le.$require("corelib/main"),le.$require("corelib/error"),le.$require("corelib/constants")},Opal.modules["corelib/nil"]=function(E){var z,j,_e=E.Kernel,d=E.def,H=E.return_val,J=E.ensure_kwargs,_=E.NilClass,w=E.slice,O=E.truthy,x=E.rb_gt,K=E.alias,A=E.nil,U=E.$$$;return[j=(0,E.klass)("::",null,"NilClass")].concat([]),j.$$prototype.$$meta=j,z=E.get_singleton_class(j),d(z,"$allocate",function(){return _e.$raise(U("TypeError"),"allocator undefined for "+this.$name())}),E.udef(z,"$new"),d(j,"$!",H(!0)),d(j,"$&",H(!1)),d(j,"$|",function(q){return!1!==q&&q!==A}),d(j,"$^",function(q){return!1!==q&&q!==A}),d(j,"$==",function(q){return q===A}),d(j,"$dup",H(A)),d(j,"$clone",function(q){return q=J(q),A},-1),d(j,"$inspect",H("nil")),d(j,"$nil?",H(!0)),d(j,"$singleton_class",function(){return _}),d(j,"$to_a",function(){return[]}),d(j,"$to_h",function(){return E.hash()}),d(j,"$to_i",H(0)),d(j,"$to_s",H("")),d(j,"$to_c",function(){return U("Complex").$new(0,0)}),d(j,"$rationalize",function(q){var Z;return Z=w(arguments),O(x(Z.$length(),1))&&_e.$raise(U("ArgumentError")),_e.$Rational(0,1)},-1),d(j,"$to_r",function(){return _e.$Rational(0,1)}),d(j,"$instance_variables",function(){return[]}),K(j,"to_f","to_i")},Opal.modules["corelib/boolean"]=function(E){"use strict";var le=E.klass,_e=E.Kernel,d=E.def,H=E.return_self,J=E.ensure_kwargs,_=E.slice,w=E.truthy,O=E.send2,x=E.find_super,K=E.to_a,V=E.alias,U=E.nil,N=E.$$$;return function(Y,T,j){var M,re=le("::",T,"Boolean");[re].concat([]),E.prop(re.$$prototype,"$$is_boolean",!0);for(var q=["$$class","$$meta"],Z=0;Z<q.length;Z++)Object.defineProperty(re.$$prototype,q[Z],{configurable:!0,enumerable:!1,get:function(){return 1==this?E.TrueClass:0==this?E.FalseClass:E.Boolean}});Object.defineProperty(re.$$prototype,"$$id",{configurable:!0,enumerable:!1,get:function(){return 1==this?2:0==this?0:U}}),M=E.get_singleton_class(re),d(M,"$allocate",function(){return _e.$raise(N("TypeError"),"allocator undefined for "+this.$name())}),E.udef(M,"$new"),d(re,"$__id__",function(){return this.valueOf()?2:0}),d(re,"$!",function(){return 1!=this}),d(re,"$&",function(I){return 1==this&&!1!==I&&I!==U}),d(re,"$|",function(I){return 1==this||!1!==I&&I!==U}),d(re,"$^",function(I){return 1==this?!1===I||I===U:!1!==I&&I!==U}),d(re,"$==",function(I){return 1==this===I.valueOf()}),d(re,"$singleton_class",function(){return this.$$meta}),d(re,"$to_s",function(){return 1==this?"true":"false"}),d(re,"$dup",H),d(re,"$clone",function(I){return I=J(I),this},-1),d(re,"$method_missing",function M(I,X){var k,L=M.$$p||U,v=this;M.$$p=null,k=_(arguments,1);var P=v.$$class.$$prototype[E.jsid(I)];return w(typeof P<"u"&&!P.$$stub)||O(v,x(v,"method_missing",M,!1,!0),"method_missing",[I].concat(K(k)),L),E.send(v,P,k,L)},-2),d(re,"$respond_to_missing?",function(I,X){null==X&&(X=!1);var S=this.$$class.$$prototype[E.jsid(I)];return typeof S<"u"&&!S.$$stub},-2),V(re,"eql?","=="),V(re,"equal?","=="),V(re,"inspect","to_s"),V(re,"object_id","__id__")}(0,Boolean),le("::",N("Boolean"),"TrueClass"),le("::",N("Boolean"),"FalseClass"),U},Opal.modules["corelib/comparable"]=function(E){var le=E.truthy,_e=E.module,d=E.rb_gt,H=E.rb_lt,J=E.eqeqeq,_=E.Kernel,w=E.def,O=E.nil,x=E.$$$;return function(K){var V=_e("::","Comparable"),A=O;function U(T){return E.is_a(T,E.Integer)?T:d(T,0)?1:H(T,0)?-1:0}function Y(T,j){var re=T["$<=>"](j);return le(re)||function N(T,j){var re;re=J(O,A=j)||J(!0,A)||J(!1,A)||J(x("Integer"),A)||J(x("Float"),A)?j.$inspect():j.$$class,_.$raise(x("ArgumentError"),"comparison of "+T.$class()+" with "+re+" failed")}(T,j),U(re)}return w(V,"$==",function(j){var re=this,z=O;return!!le(re["$equal?"](j))||re["$<=>"]!=E.Kernel["$<=>"]&&(re.$$comparable?(re.$$comparable=!1,!1):!!le(z=re["$<=>"](j))&&0==U(z))}),w(V,"$>",function(j){return Y(this,j)>0}),w(V,"$>=",function(j){return Y(this,j)>=0}),w(V,"$<",function(j){return Y(this,j)<0}),w(V,"$<=",function(j){return Y(this,j)<=0}),w(V,"$between?",function(j,re){return!(H(this,j)||d(this,re))}),w(V,"$clamp",function(j,re){var q,Z,z=this;if(null==re&&(re=O),re===O&&(E.is_a(j,E.Range)||_.$raise(x("TypeError"),"wrong argument type "+j.$class()+" (expected Range)"),Z=j.excl,re=j.end,j=j.begin,re!==O&&Z&&_.$raise(x("ArgumentError"),"cannot clamp with an exclusive range")),j!==O&&re!==O&&Y(j,re)>0&&_.$raise(x("ArgumentError"),"min argument must be smaller than max argument"),j!==O){if(0==(q=Y(z,j)))return z;if(q<0)return j}return re!==O&&(q=Y(z,re))>0?re:z},-2)}()},Opal.modules["corelib/regexp"]=function(E){var v,P,fe,F,g,B,te,D,le=E.coerce_to,_e=E.prop,d=E.freeze,H=E.klass,J=E.const_set,_=E.send2,w=E.find_super,O=E.def,x=E.truthy,K=E.gvars,V=E.slice,A=E.Kernel,U=E.Opal,N=E.alias,Y=E.send,T=E.hash2,j=E.rb_plus,re=E.ensure_kwargs,z=E.rb_ge,q=E.to_a,Z=E.eqeqeq,M=E.rb_minus,I=E.return_ivar,X=[],L=E.nil,S=E.$$$;return H("::",S("StandardError"),"RegexpError"),v=RegExp,P=X,te=[B=H("::",v,"Regexp")].concat(P),D=E.$r(te),J(B,"IGNORECASE",1),J(B,"EXTENDED",2),J(B,"MULTILINE",4),E.prop(B.$$prototype,"$$is_regexp",!0),F=[fe=E.get_singleton_class(B)].concat(te),g=E.$r(F),O(fe,"$allocate",function l(){var c=l.$$p||L,u=L;return l.$$p=null,(u=_(this,w(this,"allocate",l,!1,!0),"allocate",[],c)).uninitialized=!0,u}),O(fe,"$escape",function(c){return E.escape_regexp(c)}),O(fe,"$last_match",function(c){return null==K["~"]&&(K["~"]=L),null==c&&(c=L),x(c["$nil?"]())?K["~"]:x(K["~"])?K["~"]["$[]"](c):L},-1),O(fe,"$union",function(c){var u,m,C,$,ie,se,p=this;if(0==(u=V(arguments)).length)return/(?!)/;if(1==u.length&&u[0].$$is_regexp)return u[0];m=u[0].$$is_array,u.length>1&&m&&A.$raise(S("TypeError"),"no implicit conversion of Array into String"),m&&(u=u[0]),ie=void 0,C=[];for(var Ee=0;Ee<u.length;Ee++)($=u[Ee]).$$is_string?C.push(p.$escape($)):$.$$is_regexp?(se=$.$options(),null!=ie&&ie!=se&&A.$raise(S("TypeError"),"All expressions must use the same options"),ie=se,C.push("("+$.source+")")):C.push(p.$escape($.$to_str()));return p.$new(C.$join("|"),ie)},-1),O(fe,"$new",function(c,f){if(c.$$is_regexp)return new RegExp(c);if("\\"===(c=U["$coerce_to!"](c,S("String"),"to_str")).charAt(c.length-1)&&"\\"!==c.charAt(c.length-2)&&A.$raise(S("RegexpError"),"too short escape sequence: /"+c+"/"),c=c.replace("\\A","^").replace("\\z","$"),void 0===f||f["$!"]())return new RegExp(c);if(f.$$is_number){var u="";g("IGNORECASE")&f&&(u+="i"),g("MULTILINE")&f&&(u+="m"),f=u}else f="i";return new RegExp(c,f)},-2),N(fe,"compile","new"),N(fe,"quote","escape"),O(B,"$==",function(R){return R instanceof RegExp&&this.toString()===R.toString()}),O(B,"$===",function(R){return this.$match(U["$coerce_to?"](R,S("String"),"to_str"))!==L}),O(B,"$=~",function(R){var g;return null==K["~"]&&(K["~"]=L),x(g=this.$match(R))?K["~"].$begin(0):g}),O(B,"$freeze",function(){var R=this;return x(R["$frozen?"]())?R:(R.hasOwnProperty("$$g")||_e(R,"$$g",null),R.hasOwnProperty("$$gm")||_e(R,"$$gm",null),d(R))}),O(B,"$inspect",function(){var g=this.toString(),l=/^\/(.*)\/([^\/]*)$/.exec(g);if(l){for(var f=l[2],u=l[1].split(""),p=u.length,m=!1,C="",$=0;$<p;$++){var ie=u[$];!m&&"/"==ie&&(C=C.concat("\\")),C=C.concat(ie),m="\\"==ie&&!m}return"/"+C+"/"+f}return g}),O(B,"$match",function fe(R,F){var g=fe.$$p||L,l=this;if(null==K["~"]&&(K["~"]=L),fe.$$p=null,l.uninitialized&&A.$raise(S("TypeError"),"uninitialized Regexp"),void 0===F){if(R===L)return K["~"]=L;var c=l.exec(le(R,S("String"),"to_str"));return c?(K["~"]=S("MatchData").$new(l,c),g===L?K["~"]:E.yield1(g,K["~"])):K["~"]=L}if(F=le(F,S("Integer"),"to_int"),R===L||(R=le(R,S("String"),"to_str"),F<0&&(F+=R.length)<0))return K["~"]=L;for(var f,u=E.global_regexp(l);;){if(null===(f=u.exec(R)))return K["~"]=L;if(f.index>=F)return K["~"]=S("MatchData").$new(u,f),g===L?K["~"]:E.yield1(g,K["~"]);u.lastIndex=f.index+1}},-2),O(B,"$match?",function(R,F){var l,g=this;return g.uninitialized&&A.$raise(S("TypeError"),"uninitialized Regexp"),void 0===F?R!==L&&g.test(le(R,S("String"),"to_str")):(F=le(F,S("Integer"),"to_int"),!(R===L||(R=le(R,S("String"),"to_str"),F<0&&(F+=R.length)<0)||null===(l=E.global_regexp(g).exec(R))||l.index<F))},-2),O(B,"$names",function(){return Y(this.$source().$scan(/\(?<(\w+)>/,T(["no_matchdata"],{no_matchdata:!0})),"map",[],"first".$to_proc()).$uniq()}),O(B,"$named_captures",function(){return Y(Y(Y(this.$source().$scan(/\(?<(\w+)>/,T(["no_matchdata"],{no_matchdata:!0})),"map",[],"first".$to_proc()).$each_with_index(),"group_by",[],"first".$to_proc()),"transform_values",[],function(g){return null==g&&(g=L),Y(g,"map",[],function(c){return null==c&&(c=L),j(c.$last(),1)})})}),O(B,"$~",function(){return null==K._&&(K._=L),this["$=~"](K._)}),O(B,"$source",function(){return this.source}),O(B,"$options",function(){var R=this;R.uninitialized&&A.$raise(S("TypeError"),"uninitialized Regexp");var F=0;return R.multiline&&(F|=D("MULTILINE")),R.ignoreCase&&(F|=D("IGNORECASE")),F}),O(B,"$casefold?",function(){return this.ignoreCase}),N(B,"eql?","=="),N(B,"to_s","source"),function(k,v,P){var B=H(k,null,"MatchData"),te=[B].concat(P),D=E.$r(te);return B.$$prototype.matches=L,B.$attr_reader("post_match","pre_match","regexp","string"),O(B,"$initialize",function(F,g,l){var c,f=this;null==(c=(l=re(l)).$$smap.no_matchdata)&&(c=!1),x(c)||(K["~"]=f),f.regexp=F,f.begin=g.index,f.string=g.input,f.pre_match=g.input.slice(0,g.index),f.post_match=g.input.slice(g.index+g[0].length),f.matches=[];for(var u=0,p=g.length;u<p;u++){f.matches.push(g[u]??L)}},-3),O(B,"$match",function(F){var l;return x(l=this["$[]"](F))?l:x(F["$is_a?"](D("Integer")))&&x(z(F,this.$length()))?A.$raise(S("IndexError"),"index "+F+" out of matches"):L}),O(B,"$match_length",function(F){var g;return(g=this.$match(F))===L||null==g?L:g.$length()}),O(B,"$[]",function(F){var l,c=this;return(l=V(arguments))[0].$$is_string?(c.$regexp().$names()["$include?"](l["$[]"](0))["$!"]()&&A.$raise(S("IndexError"),"undefined group name reference: "+l["$[]"](0)),c.$named_captures()["$[]"](l["$[]"](0))):Y(c.matches,"[]",q(l))},-1),O(B,"$offset",function(F){var g=this;return 0!==F&&A.$raise(S("ArgumentError"),"MatchData#offset only supports 0th element"),[g.begin,g.begin+g.matches[F].length]}),O(B,"$==",function(F){var g=this,l=L,c=L,f=L,u=L;return!!Z(S("MatchData"),F)&&(x(l=x(c=x(f=x(u=g.string==F.string)?g.regexp.toString()==F.regexp.toString():u)?g.pre_match==F.pre_match:f)?g.post_match==F.post_match:c)?g.begin==F.begin:l)}),O(B,"$begin",function(F){return 0!==F&&A.$raise(S("ArgumentError"),"MatchData#begin only supports 0th element"),this.begin}),O(B,"$end",function(F){return 0!==F&&A.$raise(S("ArgumentError"),"MatchData#end only supports 0th element"),this.begin+this.matches[F].length}),O(B,"$captures",function(){return this.matches.slice(1)}),O(B,"$named_captures",function(){var g=L;return g=this.$captures(),Y(this.$regexp().$named_captures(),"transform_values",[],function(c){return null==c&&(c=L),g["$[]"](M(c.$last(),1))})}),O(B,"$names",function(){return this.$regexp().$names()}),O(B,"$inspect",function(){var F=this,g="#<MatchData "+F.matches[0].$inspect();if(F.$regexp().$names()["$empty?"]())for(var l=1,c=F.matches.length;l<c;l++)g+=" "+l+":"+F.matches[l].$inspect();else Y(F.$named_captures(),"each",[],function(u,p){return null==u&&(u=L),null==p&&(p=L),g+=" "+u+":"+p.$inspect()});return g+">"}),O(B,"$length",function(){return this.matches.length}),O(B,"$to_a",I("matches")),O(B,"$to_s",function(){return this.matches[0]}),O(B,"$values_at",function(F){var l,c=this;l=V(arguments);var f,u,p,m=[];for(f=0;f<l.length;f++)l[f].$$is_range&&((u=l[f].$to_a()).unshift(f,1),Array.prototype.splice.apply(l,u)),(p=U["$coerce_to!"](l[f],S("Integer"),"to_int"))<0&&(p+=c.matches.length)<0?m.push(L):m.push(c.matches[p]);return m},-1),N(B,"eql?","=="),N(B,"size","length")}(X[0],0,X)},Opal.modules["corelib/string"]=function(E){var le=E.coerce_to,_e=E.respond_to,d=E.global_multiline_regexp,H=E.prop,J=E.klass,_=E.def,w=E.Opal,O=E.defs,x=E.slice,K=E.send,V=E.to_a,A=E.extract_kwargs,U=E.ensure_kwargs,N=E.eqeqeq,Y=E.Kernel,T=E.truthy,j=E.gvars,re=E.rb_divide,z=E.rb_plus,q=E.eqeq,Z=E.hash2,M=E.alias,I=E.const_set,X=E.top,L=[],S=E.$r(L),k=E.nil,v=E.$$$;return X.$require("corelib/comparable"),X.$require("corelib/regexp"),function(P,B,te){var D=J("::",String,"String"),fe=[D].concat(te),R=E.$r(fe);function F(g){function l(Ee){var ce,$e,ye,he,Se,be,Ie="",Me=Ee.length;for(ce=0;ce<Me;ce++)if("-"===($e=Ee.charAt(ce))&&ce>0&&ce<Me-1&&!ye){for((he=Ee.charCodeAt(ce-1))>(Se=Ee.charCodeAt(ce+1))&&Y.$raise(v("ArgumentError"),'invalid range "'+he+"-"+Se+'" in string transliteration'),be=he+1;be<Se+1;be++)Ie+=String.fromCharCode(be);ye=!0,ce++}else ye="\\"===$e,Ie+=$e;return Ie}function c(Ee,Ie){if(0===Ee.length)return Ie;var Me,ye,ce="",$e=Ee.length;for(Me=0;Me<$e;Me++)ye=Ee.charAt(Me),-1!==Ie.indexOf(ye)&&(ce+=ye);return ce}var f,u,p,m,C,$,ie="",se="";for(f=0,u=g.length;f<u;f++)m="^"===(p=le(g[f],v("String"),"to_str")).charAt(0)&&p.length>1,p=l(m?p.slice(1):p),m?se=c(se,p):ie=c(ie,p);if(ie.length>0&&se.length>0){for($="",f=0,u=ie.length;f<u;f++)C=ie.charAt(f),-1===se.indexOf(C)&&($+=C);ie=$,se=""}return ie.length>0?"["+v("Regexp").$escape(ie)+"]":se.length>0?"[^"+v("Regexp").$escape(se)+"]":null}D.$include(v("Comparable")),E.prop(D.$$prototype,"$$is_string",!0),_(D,"$__id__",function(){return this.toString()}),O(D,"$try_convert",function(l){return w["$coerce_to?"](l,v("String"),"to_str")}),O(D,"$new",function(l){var f,u=this,p=(f=x(arguments))[0]||"",m=f[f.length-1];return p=le(p,v("String"),"to_str"),m&&m.$$is_hash&&m.$$smap.encoding&&(p=p.$force_encoding(m.$$smap.encoding)),(p=new u.$$constructor(p)).$initialize.$$pristine||K(p,"initialize",V(f)),p},-1),_(D,"$initialize",function(l,c){var f,u;return f=x(arguments),u=A(f),u=U(u),f.length>0&&f.shift(),k},-1),_(D,"$%",function(l){var c=this;return N(v("Array"),l)?K(c,"format",[c].concat(V(l))):c.$format(c,l)}),_(D,"$*",function(l){if((l=le(l,v("Integer"),"to_int"))<0&&Y.$raise(v("ArgumentError"),"negative argument"),0===l)return"";var f="",u=this.toString();for(u.length*l>=1<<28&&Y.$raise(v("RangeError"),"multiply count must not overflow maximum string size");1==(1&l)&&(f+=u),0!=(l>>>=1);)u+=u;return f}),_(D,"$+",function(l){var c=this;if(""==(l=le(l,v("String"),"to_str"))&&c.$$class===E.String)return c;if(""==c&&l.$$class===E.String)return l;var f=c+l;return c.encoding===f.encoding&&l.encoding===f.encoding||"UTF-8"===c.encoding.name||"UTF-8"===l.encoding.name?f:E.enc(f,c.encoding)}),_(D,"$<=>",function(l){var c=this;if(T(l["$respond_to?"]("to_str")))return c>(l=l.$to_str().$to_s())?1:c<l?-1:0;var f=l["$<=>"](c);return f===k?k:f>0?-1:f<0?1:0}),_(D,"$==",function(l){return l.$$is_string?this.toString()===l.toString():!!_e(l,"$to_str")&&l["$=="](this)}),_(D,"$=~",function(l){return l.$$is_string&&Y.$raise(v("TypeError"),"type mismatch: String given"),l["$=~"](this)}),_(D,"$[]",function(l,c){var p,m,f=this,u=f.length;if(l.$$is_range)return p=l.excl,m=l,c=l.end===k?-1:le(l.end,v("Integer"),"to_int"),l=l.begin===k?0:le(l.begin,v("Integer"),"to_int"),Math.abs(l)>u?k:(l<0&&(l+=u),c<0&&(c+=u),(!p||m.end===k)&&(c+=1),(c-=l)<0&&(c=0),f.substr(l,c));if(l.$$is_string)return null!=c&&Y.$raise(v("TypeError")),-1!==f.indexOf(l)?l:k;if(l.$$is_regexp){var C=f.match(l);return null===C?(j["~"]=k,k):(j["~"]=v("MatchData").$new(l,C),null==c?C[0]:(c=le(c,v("Integer"),"to_int"))<0&&-c<C.length?C[c+=C.length]:c>=0&&c<C.length?C[c]:k)}return(l=le(l,v("Integer"),"to_int"))<0&&(l+=u),null==c?l>=u||l<0?k:f.substr(l,1):(c=le(c,v("Integer"),"to_int"))<0||l>u||l<0?k:f.substr(l,c)},-2),_(D,"$b",function(){return new String(this).$force_encoding("binary")}),_(D,"$capitalize",function(){return this.charAt(0).toUpperCase()+this.substr(1).toLowerCase()}),_(D,"$casecmp",function(l){var c=this;if(!T(l["$respond_to?"]("to_str")))return k;l=le(l,v("String"),"to_str").$to_s();var f=/^[\x00-\x7F]*$/;return f.test(c)&&f.test(l)&&(c=c.toLowerCase(),l=l.toLowerCase()),c["$<=>"](l)}),_(D,"$casecmp?",function(l){var f=this.$casecmp(l);return f===k?k:0===f}),_(D,"$center",function(l,c){var f=this;if(null==c&&(c=" "),l=le(l,v("Integer"),"to_int"),c=le(c,v("String"),"to_str").$to_s(),T(c["$empty?"]())&&Y.$raise(v("ArgumentError"),"zero width padding"),T(l<=f.length))return f;var u=f.$ljust(re(z(l,f.length),2).$ceil(),c);return f.$rjust(re(z(l,f.length),2).$floor(),c)+u.slice(f.length)},-2),_(D,"$chomp",function(l){var f,c=this;return null==j["/"]&&(j["/"]=k),null==l&&(l=j["/"]),T(l===k||0===c.length)?c:("\n"===(l=w["$coerce_to!"](l,v("String"),"to_str").$to_s())?f=c.replace(/\r?\n?$/,""):""===l?f=c.replace(/(\r?\n)+$/,""):c.length>=l.length&&c.substr(c.length-l.length,l.length)===l&&(f=c.substr(0,c.length-l.length)),f??c)},-1),_(D,"$chop",function(){var l=this,c=l.length;return c<=1?"":"\n"===l.charAt(c-1)&&"\r"===l.charAt(c-2)?l.substr(0,c-2):l.substr(0,c-1)}),_(D,"$chr",function(){return this.charAt(0)}),_(D,"$clone",function(l){var c,f=this,u=k;return null==(c=(l=U(l)).$$smap.freeze)&&(c=k),T(c["$nil?"]())||q(c,!0)||q(c,!1)||f.$raise(R("ArgumentError"),"unexpected value for freeze: "+c.$class()),(u=new String(f)).$copy_singleton_methods(f),u.$initialize_clone(f,Z(["freeze"],{freeze:c})),q(c,!0)?u.$$frozen||(u.$$frozen=!0):T(c["$nil?"]())&&f.$$frozen&&(u.$$frozen=!0),u},-1),_(D,"$dup",function(){var c=k;return(c=new String(this)).$initialize_dup(this),c}),_(D,"$count",function(l){var f,u=this;0===(f=x(arguments)).length&&Y.$raise(v("ArgumentError"),"ArgumentError: wrong number of arguments (0 for 1+)");var p=F(f);return null===p?0:u.length-u.replace(new RegExp(p,"g"),"").length},-1),_(D,"$delete",function(l){var f,u=this;0===(f=x(arguments)).length&&Y.$raise(v("ArgumentError"),"ArgumentError: wrong number of arguments (0 for 1+)");var p=F(f);return null===p?u:u.replace(new RegExp(p,"g"),"")},-1),_(D,"$delete_prefix",function(l){var c=this;return l.$$is_string||(l=le(l,v("String"),"to_str")),c.slice(0,l.length)===l?c.slice(l.length):c}),_(D,"$delete_suffix",function(l){var c=this;return l.$$is_string||(l=le(l,v("String"),"to_str")),c.slice(c.length-l.length)===l?c.slice(0,c.length-l.length):c}),_(D,"$downcase",function(){return this.toLowerCase()}),_(D,"$each_line",function g(l,c){var u,p,m,C,ie,se,Ee,Ie,ce,Me,$e,ye,f=g.$$p||k,$=this;if(null==j["/"]&&(j["/"]=k),g.$$p=null,u=x(arguments),p=A(u),p=U(p),u.length>0&&(m=u.shift()),null==m&&(m=j["/"]),null==(C=p.$$smap.chomp)&&(C=!1),f===k)return $.$enum_for("each_line",m,Z(["chomp"],{chomp:C}));if(m===k)return E.yield1(f,$),$;if(0===(m=le(m,v("String"),"to_str")).length){for(se=0,Ee=(ie=$.split(/((?:\r?\n){2})(?:(?:\r?\n)*)/)).length;se<Ee;se+=2)(ie[se]||ie[se+1])&&(ye=(ie[se]||"")+(ie[se+1]||""),C&&(ye=ye.$chomp("\n")),E.yield1(f,ye));return $}for(ce=$.$chomp(m),Me=$.length!=ce.length,se=0,Ie=($e=ce.split(m)).length;se<Ie;se++)ye=$e[se],(se<Ie-1||Me)&&(ye+=m),C&&(ye=ye.$chomp(m)),E.yield1(f,ye);return $},-1),_(D,"$empty?",function(){return 0===this.length}),_(D,"$end_with?",function(l){for(var f,u=this,p=0,m=(f=x(arguments)).length;p<m;p++){var C=le(f[p],v("String"),"to_str").$to_s();if(u.length>=C.length&&u.substr(u.length-C.length,C.length)==C)return!0}return!1},-1),_(D,"$gsub",function g(l,c){var f=g.$$p||k,u=this;if(g.$$p=null,void 0===c&&f===k)return u.$enum_for("gsub",l);var $,ie,se,p="",m=k,C=0;for(l.$$is_regexp?l=d(l):(l=le(l,v("String"),"to_str"),l=new RegExp(l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"));;){if(null===($=l.exec(u))){j["~"]=k,p+=u.slice(C);break}m=v("MatchData").$new(l,$),void 0===c?(se=l.lastIndex,ie=f($[0]),l.lastIndex=se):c.$$is_hash?ie=c["$[]"]($[0]).$to_s():(c.$$is_string||(c=le(c,v("String"),"to_str")),ie=c.replace(/([\\]+)([0-9+&`'])/g,function(Ee,Ie,ce){if(Ie.length%2==0)return Ee;switch(ce){case"+":for(var Me=$.length-1;Me>0;Me--)if(void 0!==$[Me])return Ie.slice(1)+$[Me];return"";case"&":return Ie.slice(1)+$[0];case"`":return Ie.slice(1)+u.slice(0,$.index);case"'":return Ie.slice(1)+u.slice($.index+$[0].length);default:return Ie.slice(1)+($[ce]||"")}}).replace(/\\\\/g,"\\")),l.lastIndex===$.index?(p+=u.slice(C,$.index)+ie+(u[$.index]||""),l.lastIndex+=1):p+=u.slice(C,$.index)+ie,C=l.lastIndex}return j["~"]=m,p},-2),_(D,"$hash",function(){return this.toString()}),_(D,"$hex",function(){return this.$to_i(16)}),_(D,"$include?",function(l){return l.$$is_string||(l=le(l,v("String"),"to_str")),-1!==this.indexOf(l)}),_(D,"$index",function(l,c){var u,p,m,f=this;if(void 0===c)c=0;else if((c=le(c,v("Integer"),"to_int"))<0&&(c+=f.length)<0)return k;if(l.$$is_regexp)for(m=d(l);;){if(null===(p=m.exec(f))){j["~"]=k,u=-1;break}if(p.index>=c){j["~"]=v("MatchData").$new(m,p),u=p.index;break}m.lastIndex=p.index+1}else u=0===(l=le(l,v("String"),"to_str")).length&&c>f.length?-1:f.indexOf(l,c);return-1===u?k:u},-2),_(D,"$inspect",function(){var l=this,f={"\x07":"\\a","\x1b":"\\e","\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\v":"\\v",'"':'\\"',"\\":"\\\\"};return'"'+l.replace(/[\\\"\x00-\x1f\u007F-\u009F\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,function(p){return f[p]?f[p]:(p=p.charCodeAt(0))<=255&&(l.encoding["$binary?"]()||l.internal_encoding["$binary?"]())?"\\x"+("00"+p.toString(16).toUpperCase()).slice(-2):"\\u"+("0000"+p.toString(16).toUpperCase()).slice(-4)}).replace(/\#[\$\@\{]/g,"\\$&")+'"'}),_(D,"$intern",function(){return this.toString()}),_(D,"$length",function(){return this.length}),M(D,"size","length"),_(D,"$lines",function g(l,c){var u,p,m,C,f=g.$$p||k,$=this,ie=k;return null==j["/"]&&(j["/"]=k),g.$$p=null,u=x(arguments),p=A(u),p=U(p),u.length>0&&(m=u.shift()),null==m&&(m=j["/"]),null==(C=p.$$smap.chomp)&&(C=!1),ie=K($,"each_line",[m,Z(["chomp"],{chomp:C})],f.$to_proc()),T(f)?$:ie.$to_a()},-1),_(D,"$ljust",function(l,c){var f=this;if(null==c&&(c=" "),l=le(l,v("Integer"),"to_int"),c=le(c,v("String"),"to_str").$to_s(),T(c["$empty?"]())&&Y.$raise(v("ArgumentError"),"zero width padding"),T(l<=f.length))return f;var u=-1,p="";for(l-=f.length;++u<l;)p+=c;return f+p.slice(0,l)},-2),_(D,"$lstrip",function(){return this.replace(/^[\u0000\s]*/,"")}),_(D,"$ascii_only?",function(){return!!this.encoding.ascii&&/^[\x00-\x7F]*$/.test(this)}),_(D,"$match",function g(l,c){var f=g.$$p||k;return g.$$p=null,(N(R("String"),l)||T(l["$respond_to?"]("to_str")))&&(l=v("Regexp").$new(l.$to_str())),N(v("Regexp"),l)||Y.$raise(v("TypeError"),"wrong argument type "+l.$class()+" (expected Regexp)"),K(l,"match",[this,c],f.$to_proc())},-2),_(D,"$match?",function(l,c){return(N(R("String"),l)||T(l["$respond_to?"]("to_str")))&&(l=v("Regexp").$new(l.$to_str())),N(v("Regexp"),l)||Y.$raise(v("TypeError"),"wrong argument type "+l.$class()+" (expected Regexp)"),l["$match?"](this,c)},-2),_(D,"$next",function(){var l=this,c=l.length;if(0===c)return"";for(var m,f=l,u=l.search(/[a-zA-Z0-9]/),p=!1;c--;){if((m=l.charCodeAt(c))>=48&&m<=57||m>=65&&m<=90||m>=97&&m<=122)switch(m){case 57:p=!0,m=48;break;case 90:p=!0,m=65;break;case 122:p=!0,m=97;break;default:p=!1,m+=1}else-1===u?255===m?(p=!0,m=0):(p=!1,m+=1):p=!0;if(f=f.slice(0,c)+String.fromCharCode(m)+f.slice(c+1),p&&(0===c||c===u)){switch(m){case 65:case 97:break;default:m+=1}f=0===c?String.fromCharCode(m)+f:f.slice(0,c)+String.fromCharCode(m)+f.slice(c),p=!1}if(!p)break}return f}),_(D,"$oct",function(){var c,f=this,u=8;return/^\s*_/.test(f)?0:(f=f.replace(/^(\s*[+-]?)(0[bodx]?)(.+)$/i,function(p,m,C,$){switch($.charAt(0)){case"+":case"-":return p;case"0":if("x"===$.charAt(1)&&"0x"===C)return p}switch(C){case"0b":u=2;break;case"0":case"0o":u=8;break;case"0d":u=10;break;case"0x":u=16}return m+$}),c=parseInt(f.replace(/_(?!_)/g,""),u),isNaN(c)?0:c)}),_(D,"$ord",function(){var l=this;return"function"==typeof l.codePointAt?l.codePointAt(0):l.charCodeAt(0)}),_(D,"$partition",function(l){var f,u,c=this;return l.$$is_regexp?null===(u=l.exec(c))?f=-1:(v("MatchData").$new(l,u),l=u[0],f=u.index):(l=le(l,v("String"),"to_str"),f=c.indexOf(l)),-1===f?[c,"",""]:[c.slice(0,f),c.slice(f,f+l.length),c.slice(f+l.length)]}),_(D,"$reverse",function(){return this.split("").reverse().join("")}),_(D,"$rindex",function(l,c){var u,p,m,C,f=this;if(void 0===c)c=f.length;else if((c=le(c,v("Integer"),"to_int"))<0&&(c+=f.length)<0)return k;if(l.$$is_regexp){for(p=null,m=d(l);!(null===(C=m.exec(f))||C.index>c);)m.lastIndex=(p=C).index+1;null===p?(j["~"]=k,u=-1):(v("MatchData").$new(m,p),u=p.index)}else l=le(l,v("String"),"to_str"),u=f.lastIndexOf(l,c);return-1===u?k:u},-2),_(D,"$rjust",function(l,c){var f=this;if(null==c&&(c=" "),l=le(l,v("Integer"),"to_int"),c=le(c,v("String"),"to_str").$to_s(),T(c["$empty?"]())&&Y.$raise(v("ArgumentError"),"zero width padding"),T(l<=f.length))return f;var u=Math.floor(l-f.length),p=Math.floor(u/c.length),m=Array(p+1).join(c);return m+c.slice(0,u-m.length)+f},-2),_(D,"$rpartition",function(l){var f,u,p,m,c=this;if(l.$$is_regexp){for(u=null,p=d(l);null!==(m=p.exec(c));)p.lastIndex=(u=m).index+1;null===u?f=-1:(v("MatchData").$new(p,u),l=u[0],f=u.index)}else l=le(l,v("String"),"to_str"),f=c.lastIndexOf(l);return-1===f?["","",c]:[c.slice(0,f),c.slice(f,f+l.length),c.slice(f+l.length)]}),_(D,"$rstrip",function(){return this.replace(/[\s\u0000]*$/,"")}),_(D,"$scan",function g(l,c){var u,f=g.$$p||k;g.$$p=null,null==(u=(c=U(c)).$$smap.no_matchdata)&&(u=!1);var $,m=[],C=k;for(l.$$is_regexp?l=d(l):(l=le(l,v("String"),"to_str"),l=new RegExp(l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"));null!=($=l.exec(this));)C=v("MatchData").$new(l,$,Z(["no_matchdata"],{no_matchdata:u})),f===k?m.push(1==$.length?$[0]:C.$captures()):E.yield1(f,1==$.length?$[0]:C.$captures()),l.lastIndex===$.index&&(l.lastIndex+=1);return u||(j["~"]=C),f!==k?this:m},-2),_(D,"$singleton_class",function(){return E.get_singleton_class(this)}),_(D,"$split",function(l,c){var f=this,u=k;if(null==j[";"]&&(j[";"]=k),0===f.length)return[];if(void 0===c)c=0;else if(1===(c=w["$coerce_to!"](c,v("Integer"),"to_int")))return[f];(void 0===l||l===k)&&(l=T(u=j[";"])?u:" ");var $,ie,se,p=[],m=f.toString(),C=0;if(l.$$is_regexp?l=d(l):" "===(l=le(l,v("String"),"to_str").$to_s())?(l=/\s+/gm,m=m.replace(/^\s+/,"")):l=new RegExp(l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"),1===(p=m.split(l)).length&&p[0]===m)return[p[0]];for(;-1!==(ie=p.indexOf(void 0));)p.splice(ie,1);if(0===c){for(;""===p[p.length-1];)p.length-=1;return p}if($=l.exec(m),c<0){if(null!==$&&""===$[0]&&-1===l.source.indexOf("(?="))for(ie=0,se=$.length;ie<se;ie++)p.push("");return p}if(null!==$&&""===$[0])return p.splice(c-1,p.length-1,p.slice(c-1).join("")),p;if(c>=p.length)return p;for(ie=0;null!==$&&(ie++,C=l.lastIndex,ie+1!==c);)$=l.exec(m);return p.splice(c-1,p.length-1,m.slice(C)),p},-1),_(D,"$squeeze",function(l){var f,u=this;if(0===(f=x(arguments)).length)return u.replace(/(.)\1+/g,"$1");var p=F(f);return null===p?u:u.replace(new RegExp("("+p+")\\1+","g"),"$1")},-1),_(D,"$start_with?",function(l){for(var f,u=this,p=0,m=(f=x(arguments)).length;p<m;p++)if(f[p].$$is_regexp){var C=f[p],$=C.exec(u);if(null!=$&&0===$.index)return j["~"]=v("MatchData").$new(C,$),!0;j["~"]=k}else{var ie=le(f[p],v("String"),"to_str").$to_s();if(0===u.indexOf(ie))return!0}return!1},-1),_(D,"$strip",function(){return this.replace(/^[\s\u0000]*|[\s\u0000]*$/g,"")}),_(D,"$sub",function g(l,c){var f=g.$$p||k,u=this;g.$$p=null,l.$$is_regexp||(l=le(l,v("String"),"to_str"),l=new RegExp(l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")));var p,m=l.exec(u);return null===m?(j["~"]=k,p=u.toString()):(v("MatchData").$new(l,m),void 0===c?(f===k&&Y.$raise(v("ArgumentError"),"wrong number of arguments (1 for 2)"),p=u.slice(0,m.index)+f(m[0])+u.slice(m.index+m[0].length)):c.$$is_hash?p=u.slice(0,m.index)+c["$[]"](m[0]).$to_s()+u.slice(m.index+m[0].length):(c=(c=le(c,v("String"),"to_str")).replace(/([\\]+)([0-9+&`'])/g,function(C,$,ie){if($.length%2==0)return C;switch(ie){case"+":for(var se=m.length-1;se>0;se--)if(void 0!==m[se])return $.slice(1)+m[se];return"";case"&":return $.slice(1)+m[0];case"`":return $.slice(1)+u.slice(0,m.index);case"'":return $.slice(1)+u.slice(m.index+m[0].length);default:return $.slice(1)+(m[ie]||"")}}).replace(/\\\\/g,"\\"),p=u.slice(0,m.index)+c+u.slice(m.index+m[0].length))),p},-2),_(D,"$sum",function(l){null==l&&(l=16),l=le(l,v("Integer"),"to_int");for(var f=0,u=this.length,p=0;p<u;p++)f+=this.charCodeAt(p);return l<=0?f:f&Math.pow(2,l)-1},-1),_(D,"$swapcase",function(){return this.replace(/([a-z]+)|([A-Z]+)/g,function(f,u,p){return u?f.toUpperCase():f.toLowerCase()})}),_(D,"$to_f",function(){if("_"===this.charAt(0))return 0;var c=parseFloat(this.replace(/_/g,""));return isNaN(c)||c==1/0||c==-1/0?0:c}),_(D,"$to_i",function(l){null==l&&(l=10);var f,u=this.toLowerCase(),p=le(l,v("Integer"),"to_int");return(1===p||p<0||p>36)&&Y.$raise(v("ArgumentError"),"invalid radix "+p),/^\s*_/.test(u)?0:(u=u.replace(/^(\s*[+-]?)(0[bodx]?)(.+)$/,function(m,C,$,ie){switch(ie.charAt(0)){case"+":case"-":return m;case"0":if("x"===ie.charAt(1)&&"0x"===$&&(0===p||16===p))return m}switch($){case"0b":if(0===p||2===p)return p=2,C+ie;break;case"0":case"0o":if(0===p||8===p)return p=8,C+ie;break;case"0d":if(0===p||10===p)return p=10,C+ie;break;case"0x":if(0===p||16===p)return p=16,C+ie}return m}),f=parseInt(u.replace(/_(?!_)/g,""),p),isNaN(f)?0:f)},-1),_(D,"$to_proc",function g(){var f,u,p=k;return g.$$p=null,f=this.valueOf(),u=E.jsid(f),p=K(Y,"proc",[],function m(C){var se,$=m.$$p||k;m.$$p=null,0===(se=x(arguments)).length&&Y.$raise(v("ArgumentError"),"no receiver given");var Ee=se[0];null==Ee&&(Ee=k);var Ie=Ee[u];return Ie?se=se.slice(1):(Ie=Ee.$method_missing,se[0]=f),"function"==typeof $&&(Ie.$$p=$),0===se.length?Ie.call(Ee):Ie.apply(Ee,se)},-1),p.$$source_location=k,p}),_(D,"$to_s",function(){return this.toString()}),_(D,"$tr",function(l,c){var f=this;if(l=le(l,v("String"),"to_str").$to_s(),c=le(c,v("String"),"to_str").$to_s(),0==l.length||l===c)return f;var u,p,m,C,$,ie,se,Ee={},Ie=l.split(""),ce=Ie.length,Me=c.split(""),$e=Me.length,ye=!1,he=null;"^"===Ie[0]&&Ie.length>1&&(ye=!0,Ie.shift(),he=Me[$e-1],ce-=1);var Se=[],be=null;for(p=!1,u=0;u<ce;u++)if(C=Ie[u],null==be)be=C,Se.push(C);else if("-"===C)"-"===be?(Se.push("-"),Se.push("-")):u==ce-1?Se.push("-"):p=!0;else if(p){for(($=be.charCodeAt(0))>(ie=C.charCodeAt(0))&&Y.$raise(v("ArgumentError"),'invalid range "'+String.fromCharCode($)+"-"+String.fromCharCode(ie)+'" in string transliteration'),m=$+1;m<ie;m++)Se.push(String.fromCharCode(m));Se.push(C),p=null,be=null}else Se.push(C);if(ce=(Ie=Se).length,ye)for(u=0;u<ce;u++)Ee[Ie[u]]=!0;else{if($e>0){var ae=[],ue=null;for(p=!1,u=0;u<$e;u++)if(C=Me[u],null==ue)ue=C,ae.push(C);else if("-"===C)"-"===ue?(ae.push("-"),ae.push("-")):u==$e-1?ae.push("-"):p=!0;else if(p){for(($=ue.charCodeAt(0))>(ie=C.charCodeAt(0))&&Y.$raise(v("ArgumentError"),'invalid range "'+String.fromCharCode($)+"-"+String.fromCharCode(ie)+'" in string transliteration'),m=$+1;m<ie;m++)ae.push(String.fromCharCode(m));ae.push(C),p=null,ue=null}else ae.push(C);$e=(Me=ae).length}var Ce=ce-$e;if(Ce>0){var y=$e>0?Me[$e-1]:"";for(u=0;u<Ce;u++)Me.push(y)}for(u=0;u<ce;u++)Ee[Ie[u]]=Me[u]}var W="";for(u=0,se=f.length;u<se;u++){var pe=Ee[C=f.charAt(u)];W+=ye?null==pe?he:C:pe??C}return W}),_(D,"$tr_s",function(l,c){var f=this;if(l=le(l,v("String"),"to_str").$to_s(),c=le(c,v("String"),"to_str").$to_s(),0==l.length)return f;var u,p,m,C,$,ie,se,Ee={},Ie=l.split(""),ce=Ie.length,Me=c.split(""),$e=Me.length,ye=!1,he=null;"^"===Ie[0]&&Ie.length>1&&(ye=!0,Ie.shift(),he=Me[$e-1],ce-=1);var Se=[],be=null;for(p=!1,u=0;u<ce;u++)if(C=Ie[u],null==be)be=C,Se.push(C);else if("-"===C)"-"===be?(Se.push("-"),Se.push("-")):u==ce-1?Se.push("-"):p=!0;else if(p){for(($=be.charCodeAt(0))>(ie=C.charCodeAt(0))&&Y.$raise(v("ArgumentError"),'invalid range "'+String.fromCharCode($)+"-"+String.fromCharCode(ie)+'" in string transliteration'),m=$+1;m<ie;m++)Se.push(String.fromCharCode(m));Se.push(C),p=null,be=null}else Se.push(C);if(ce=(Ie=Se).length,ye)for(u=0;u<ce;u++)Ee[Ie[u]]=!0;else{if($e>0){var ae=[];for(p=!1,u=0;u<$e;u++)if(C=Me[u],null==be)be=C,ae.push(C);else if("-"===C)u==$e-1?ae.push("-"):p=!0;else if(p){for(($=be.charCodeAt(0))>(ie=C.charCodeAt(0))&&Y.$raise(v("ArgumentError"),'invalid range "'+String.fromCharCode($)+"-"+String.fromCharCode(ie)+'" in string transliteration'),m=$+1;m<ie;m++)ae.push(String.fromCharCode(m));ae.push(C),p=null,be=null}else ae.push(C);$e=(Me=ae).length}var Ce=ce-$e;if(Ce>0){var y=$e>0?Me[$e-1]:"";for(u=0;u<Ce;u++)Me.push(y)}for(u=0;u<ce;u++)Ee[Ie[u]]=Me[u]}var W="",pe=null;for(u=0,se=f.length;u<se;u++){var we=Ee[C=f.charAt(u)];ye?null==we?null==pe&&(W+=he,pe=!0):(W+=C,pe=null):null!=we?(null==pe||pe!==we)&&(W+=we,pe=we):(W+=C,pe=null)}return W}),_(D,"$upcase",function(){return this.toUpperCase()}),_(D,"$upto",function g(l,c){var f=g.$$p||k,u=this;if(g.$$p=null,null==c&&(c=!1),f===k)return u.$enum_for("upto",l,c);var p,m,C=u.toString();if(l=le(l,v("String"),"to_str"),1===C.length&&1===l.length)for(p=C.charCodeAt(0),m=l.charCodeAt(0);p<=m&&(!c||p!==m);)f(String.fromCharCode(p)),p+=1;else if(parseInt(C,10).toString()===C&&parseInt(l,10).toString()===l)for(p=parseInt(C,10),m=parseInt(l,10);p<=m&&(!c||p!==m);)f(p.toString()),p+=1;else for(;C.length<=l.length&&C<=l&&(!c||C!==l);)f(C),C=C.$succ();return u},-2),_(D,"$instance_variables",function(){return[]}),O(D,"$_load",function(l){var c,u=this;return c=x(arguments),K(u,"new",V(c))},-1),_(D,"$unicode_normalize",function(l){return null==l&&(l="nfc"),T(["nfc","nfd","nfkc","nfkd"]["$include?"](l))||Y.$raise(v("ArgumentError"),"Invalid normalization form "+l),this.normalize(l.$upcase())},-1),_(D,"$unicode_normalized?",function(l){return null==l&&(l="nfc"),this.$unicode_normalize(l)["$=="](this)},-1),_(D,"$unpack",function(l){return Y.$raise("To use String#unpack, you must first require 'corelib/string/unpack'.")}),_(D,"$unpack1",function(l){return Y.$raise("To use String#unpack1, you must first require 'corelib/string/unpack'.")}),_(D,"$freeze",function(){var l=this;return"string"==typeof l||H(l,"$$frozen",!0),l}),_(D,"$-@",function(){var l=this;return"string"==typeof l||l.$$frozen?l:"UTF-8"==l.encoding.name&&"UTF-8"==l.internal_encoding.name?l.toString():l.$dup().$freeze()}),_(D,"$frozen?",function(){return"string"==typeof this||!0===this.$$frozen}),M(D,"+@","dup"),M(D,"===","=="),M(D,"byteslice","[]"),M(D,"eql?","=="),M(D,"equal?","==="),M(D,"object_id","__id__"),M(D,"slice","[]"),M(D,"succ","next"),M(D,"to_str","to_s"),M(D,"to_sym","intern"),w.$pristine(D,"initialize")}(0,0,L),I(L[0],"Symbol",S("String"))},Opal.modules["corelib/enumerable"]=function(E){var le=E.truthy,_e=E.coerce_to,d=E.yield1,H=E.yieldX,J=E.deny_frozen_access,_=E.module,w=E.send,O=E.slice,x=E.to_a,K=E.Opal,V=E.thrower,A=E.def,U=E.Kernel,N=E.return_val,Y=E.rb_gt,T=E.rb_times,j=E.rb_lt,re=E.eqeq,z=E.rb_plus,q=E.rb_minus,Z=E.rb_divide,M=E.rb_le,I=E.hash2,X=E.lambda,L=E.not,S=E.alias,v=E.nil,P=E.$$$;return function(B,te){var D=_("::","Enumerable"),fe=[D].concat([]),R=E.$r(fe);function F(g){return 0===g.length&&(g=[v]),g.length>1&&(g=[g]),g}return A(D,"$all?",function g(l){try{var c=V("return"),f=g.$$p||v;return g.$$p=null,le(void 0!==l)?w(this,"each",[],function(m){var ie=v;if(ie=F(O(arguments)),le(w(l,"public_send",["==="].concat(x(ie)))))return v;c.$throw(!1)},{$$arity:-1,$$ret:c}):w(this,"each",[],f!==v?function(m){var C;if(C=O(arguments),le(E.yieldX(f,x(C))))return v;c.$throw(!1)}:function(m){var C;if(C=O(arguments),le(K.$destructure(C)))return v;c.$throw(!1)},{$$arity:-1,$$ret:c}),!0}catch(p){if(p===c)return p.$v;throw p}},-1),A(D,"$any?",function g(l){try{var c=V("return"),f=g.$$p||v;return g.$$p=null,le(void 0!==l)?w(this,"each",[],function(m){var ie=v;if(ie=F(O(arguments)),!le(w(l,"public_send",["==="].concat(x(ie)))))return v;c.$throw(!0)},{$$arity:-1,$$ret:c}):w(this,"each",[],f!==v?function(m){var C;if(C=O(arguments),!le(E.yieldX(f,x(C))))return v;c.$throw(!0)}:function(m){var C;if(C=O(arguments),!le(K.$destructure(C)))return v;c.$throw(!0)},{$$arity:-1,$$ret:c}),!1}catch(p){if(p===c)return p.$v;throw p}},-1),A(D,"$chunk",function g(){var l=g.$$p||v,c=this;return g.$$p=null,l===v?w(c,"to_enum",["chunk"],function f(){return(f.$$s??this).$enumerator_size()},{$$s:c}):w(P("Enumerator"),"new",[],function f(u){var p=f.$$s??this;null==u&&(u=v);var m=v,C=[];function $(){C.length>0&&u.$yield(m,C)}p.$each.$$p=function(ie){var se=d(l,ie);se===v?($(),C=[],m=v):(m===v||m===se?C.push(ie):($(),C=[ie]),m=se)},p.$each(),$()},{$$s:c})}),A(D,"$chunk_while",function g(){var l=g.$$p||v;return g.$$p=null,l===v&&U.$raise(P("ArgumentError"),"no block given"),w(this,"slice_when",[],function(u,p){return null==u&&(u=v),null==p&&(p=v),E.yieldX(l,[u,p])["$!"]()})}),A(D,"$collect",function g(){var l=g.$$p||v,c=this;if(g.$$p=null,l===v)return w(c,"enum_for",["collect"],function u(){return(u.$$s??this).$enumerator_size()},{$$s:c});var f=[];return c.$each.$$p=function(){var u=H(l,arguments);f.push(u)},c.$each(),f}),A(D,"$collect_concat",function g(){var l=g.$$p||v,c=this;return g.$$p=null,l===v?w(c,"enum_for",["collect_concat"],function f(){return(f.$$s??this).$enumerator_size()},{$$s:c}):w(c,"map",[],l.$to_proc()).$flatten(1)}),A(D,"$compact",function(){return this.$to_a().$compact()}),A(D,"$count",function g(l){var c=g.$$p||v,u=v;return g.$$p=null,u=0,null!=l&&c!==v&&this.$warn("warning: given block not used"),le(null!=l)?c=w(U,"proc",[],function(m){var C;return C=O(arguments),K.$destructure(C)["$=="](l)},-1):le(c["$nil?"]())&&(c=w(U,"proc",[],N(!0))),w(this,"each",[],function(m){var C;return C=O(arguments),le(H(c,C))?u++:v},-1),u},-1),A(D,"$cycle",function g(l){var c=g.$$p||v,f=this;if(g.$$p=null,null==l&&(l=v),c===v)return w(f,"enum_for",["cycle",l],function $(){var ie=$.$$s??this;return le(l["$nil?"]())?le(ie["$respond_to?"]("size"))?P(P("Float"),"INFINITY"):v:(l=K["$coerce_to!"](l,P("Integer"),"to_int"),le(Y(l,0))?T(ie.$enumerator_size(),l):0)},{$$s:f});if(!le(l["$nil?"]())&&(l=K["$coerce_to!"](l,P("Integer"),"to_int"),le(l<=0)))return v;var p,m,u=[];if(f.$each.$$p=function(){var $=K.$destructure(arguments);d(c,$),u.push($)},f.$each(),0===u.length)return v;if(l===v)for(;;)for(p=0,m=u.length;p<m;p++)d(c,u[p]);else for(;l>1;){for(p=0,m=u.length;p<m;p++)d(c,u[p]);l--}},-1),A(D,"$detect",function g(l){try{var c=V("return"),f=g.$$p||v;return g.$$p=null,f===v?this.$enum_for("detect",l):(w(this,"each",[],function(m){var C,ie=v;if(C=O(arguments),ie=K.$destructure(C),!le(E.yield1(f,ie)))return v;c.$throw(ie)},{$$arity:-1,$$ret:c}),void 0!==l?"function"==typeof l?l():l:v)}catch(p){if(p===c)return p.$v;throw p}},-1),A(D,"$drop",function(l){l=_e(l,P("Integer"),"to_int"),le(l<0)&&U.$raise(P("ArgumentError"),"attempt to drop negative size");var f=[],u=0;return this.$each.$$p=function(){l<=u&&f.push(K.$destructure(arguments)),u++},this.$each(),f}),A(D,"$drop_while",function g(){var l=g.$$p||v,c=this;if(g.$$p=null,l===v)return c.$enum_for("drop_while");var f=[],u=!0;return c.$each.$$p=function(){var p=K.$destructure(arguments);if(u){var m=d(l,p);le(m)||(u=!1,f.push(p))}else f.push(p)},c.$each(),f}),A(D,"$each_cons",function g(l){var c=g.$$p||v,f=this;if(g.$$p=null,le(1!=arguments.length)&&U.$raise(P("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 1)"),l=K.$try_convert(l,P("Integer"),"to_int"),le(l<=0)&&U.$raise(P("ArgumentError"),"invalid size"),c===v)return w(f,"enum_for",["each_cons",l],function p(){var C=v;return C=(p.$$s??this).$enumerator_size(),le(C["$nil?"]())?v:re(C,0)||le(j(C,l))?0:z(q(C,l),1)},{$$s:f});var u=[];return f.$each.$$p=function(){var p=K.$destructure(arguments);u.push(p),u.length>l&&u.shift(),u.length==l&&d(c,u.slice(0,l))},f.$each(),f}),A(D,"$each_entry",function g(l){var u,c=g.$$p||v,p=this;return g.$$p=null,u=O(arguments),c===v?w(p,"to_enum",["each_entry"].concat(x(u)),function m(){return(m.$$s??this).$enumerator_size()},{$$s:p}):(p.$each.$$p=function(){var m=K.$destructure(arguments);d(c,m)},p.$each.apply(p,u),p)},-1),A(D,"$each_slice",function g(l){var c=g.$$p||v,f=this;if(g.$$p=null,l=_e(l,P("Integer"),"to_int"),le(l<=0)&&U.$raise(P("ArgumentError"),"invalid slice size"),c===v)return w(f,"enum_for",["each_slice",l],function p(){var m=p.$$s??this;return le(m["$respond_to?"]("size"))?Z(m.$size(),l).$ceil():v},{$$s:f});var u=[];return f.$each.$$p=function(){var p=K.$destructure(arguments);u.push(p),u.length===l&&(d(c,u),u=[])},f.$each(),u.length>0&&d(c,u),f}),A(D,"$each_with_index",function g(l){var u,c=g.$$p||v,p=this;if(g.$$p=null,u=O(arguments),c===v)return w(p,"enum_for",["each_with_index"].concat(x(u)),function C(){return(C.$$s??this).$enumerator_size()},{$$s:p});var m=0;return p.$each.$$p=function(){var C=K.$destructure(arguments);c(C,m),m++},p.$each.apply(p,u),p},-1),A(D,"$each_with_object",function g(l){var c=g.$$p||v,f=this;return g.$$p=null,c===v?w(f,"enum_for",["each_with_object",l],function u(){return(u.$$s??this).$enumerator_size()},{$$s:f}):(f.$each.$$p=function(){var u=K.$destructure(arguments);c(u,l)},f.$each(),l)}),A(D,"$entries",function(l){var f,u=this;f=O(arguments);var p=[];return u.$each.$$p=function(){p.push(K.$destructure(arguments))},u.$each.apply(u,f),p},-1),A(D,"$filter_map",function g(){var l=g.$$p||v,c=this;return g.$$p=null,l===v?w(c,"enum_for",["filter_map"],function f(){return(f.$$s??this).$enumerator_size()},{$$s:c}):w(w(c,"map",[],l.$to_proc()),"select",[],"itself".$to_proc())}),A(D,"$find_all",function g(){var l=g.$$p||v,c=this;if(g.$$p=null,l===v)return w(c,"enum_for",["find_all"],function u(){return(u.$$s??this).$enumerator_size()},{$$s:c});var f=[];return c.$each.$$p=function(){var u=K.$destructure(arguments),p=d(l,u);le(p)&&f.push(u)},c.$each(),f}),A(D,"$find_index",function g(l){try{var c=V("return"),f=g.$$p||v,u=this,p=v;return g.$$p=null,le(void 0===l&&f===v)?u.$enum_for("find_index"):(null!=l&&f!==v&&u.$warn("warning: given block not used"),p=0,le(null!=l)?w(u,"each",[],function(C){var $;return $=O(arguments),re(K.$destructure($),l)&&c.$throw(p),p+=1},{$$arity:-1,$$ret:c}):w(u,"each",[],function(C){var $;return $=O(arguments),le(E.yieldX(f,x($)))&&c.$throw(p),p+=1},{$$arity:-1,$$ret:c}),v)}catch(m){if(m===c)return m.$v;throw m}},-1),A(D,"$first",function(l){try{var c=V("return"),u=v,p=v;return le(void 0===l)?w(this,"each",[],function(C){null==C&&(C=v),c.$throw(C)},{$$ret:c}):(u=[],l=_e(l,P("Integer"),"to_int"),le(l<0)&&U.$raise(P("ArgumentError"),"attempt to take negative size"),le(0==l)?[]:(p=0,w(this,"each",[],function(C){var $;if($=O(arguments),u.push(K.$destructure($)),!le(l<=++p))return v;c.$throw(u)},{$$arity:-1,$$ret:c}),u))}catch(m){if(m===c)return m.$v;throw m}},-1),A(D,"$grep",function g(l){var c=g.$$p||v,u=v;return g.$$p=null,u=[],w(this,"each",[],function(m){var $,ie=v;return ie=F($=O(arguments)),le(w(l,"__send__",["==="].concat(x(ie))))?(c!==v?(le(Y($.$length(),1))&&($=[$]),$=E.yieldX(c,x($))):le(M($.$length(),1))&&($=$["$[]"](0)),u.$push($)):v},-1),u}),A(D,"$grep_v",function g(l){var c=g.$$p||v,u=v;return g.$$p=null,u=[],w(this,"each",[],function(m){var $,ie=v;return ie=F($=O(arguments)),le(w(l,"__send__",["==="].concat(x(ie))))?v:(c!==v?(le(Y($.$length(),1))&&($=[$]),$=E.yieldX(c,x($))):le(M($.$length(),1))&&($=$["$[]"](0)),u.$push($))},-1),u}),A(D,"$group_by",function g(){var c,l=g.$$p||v,f=this,u=v,p=v;return g.$$p=null,l===v?w(f,"enum_for",["group_by"],function C(){return(C.$$s??this).$enumerator_size()},{$$s:f}):(u=I([],{}),f.$each.$$p=function(){var C=K.$destructure(arguments),$=d(l,C);(le(p=u["$[]"]($))?p:(c=[$,[]],w(u,"[]=",c),c[c.length-1]))["$<<"](C)},f.$each(),u)}),A(D,"$include?",function(l){try{var c=V("return");return w(this,"each",[],function(p){var m;if(m=O(arguments),!re(K.$destructure(m),l))return v;c.$throw(!0)},{$$arity:-1,$$ret:c}),!1}catch(u){if(u===c)return u.$v;throw u}}),A(D,"$inject",function g(l,c){var f=g.$$p||v,u=this;g.$$p=null;var p=l;return f!==v&&void 0===c?u.$each.$$p=function(){var m=K.$destructure(arguments);void 0!==p?(m=H(f,[p,m]),p=m):p=m}:(void 0===c&&(P("Symbol")["$==="](l)||U.$raise(P("TypeError"),l.$inspect()+" is not a Symbol"),c=l,p=void 0),u.$each.$$p=function(){var m=K.$destructure(arguments);p=void 0!==p?p.$__send__(c,m):m}),u.$each(),p??v},-1),A(D,"$lazy",function(){return w(P(P("Enumerator"),"Lazy"),"new",[this,this.$enumerator_size()],function(f,u){var p;return null==f&&(f=v),p=O(arguments,1),w(f,"yield",x(p))},-2)}),A(D,"$enumerator_size",function(){return le(this["$respond_to?"]("size"))?this.$size():v}),A(D,"$max",function g(l){var u,p,c=g.$$p||v,f=this;return g.$$p=null,void 0===l||l===v?(f.$each.$$p=function(){var m=K.$destructure(arguments);void 0!==u?((p=c!==v?H(c,[m,u]):m["$<=>"](u))===v&&U.$raise(P("ArgumentError"),"comparison failed"),p>0&&(u=m)):u=m},f.$each(),void 0===u?v:u):(l=_e(l,P("Integer"),"to_int"),w(f,"sort",[],c.$to_proc()).$reverse().$first(l))},-1),A(D,"$max_by",function g(l){var u,p,c=g.$$p||v,f=this;return g.$$p=null,null==l&&(l=v),le(c)?le(l["$nil?"]())?(f.$each.$$p=function(){var m=K.$destructure(arguments),C=d(c,m);if(void 0===u)return u=m,void(p=C);C["$<=>"](p)>0&&(u=m,p=C)},f.$each(),void 0===u?v:u):w(f,"sort_by",[],c.$to_proc()).$reverse().$take(l):w(f,"enum_for",["max_by",l],function m(){return(m.$$s??this).$enumerator_size()},{$$s:f})},-1),A(D,"$min",function g(l){var u,c=g.$$p||v,f=this;return g.$$p=null,null==l&&(l=v),le(l["$nil?"]())?(f.$each.$$p=c!==v?function(){var p=K.$destructure(arguments);if(void 0!==u){var m=c(p,u);m===v&&U.$raise(P("ArgumentError"),"comparison failed"),m<0&&(u=p)}else u=p}:function(){var p=K.$destructure(arguments);void 0!==u?K.$compare(p,u)<0&&(u=p):u=p},f.$each(),void 0===u?v:u):c!==v?w(f,"sort",[],function(m,C){return null==m&&(m=v),null==C&&(C=v),E.yieldX(c,[m,C])}).$take(l):f.$sort().$take(l)},-1),A(D,"$min_by",function g(l){var u,p,c=g.$$p||v,f=this;return g.$$p=null,null==l&&(l=v),le(c)?le(l["$nil?"]())?(f.$each.$$p=function(){var m=K.$destructure(arguments),C=d(c,m);if(void 0===u)return u=m,void(p=C);C["$<=>"](p)<0&&(u=m,p=C)},f.$each(),void 0===u?v:u):w(f,"sort_by",[],c.$to_proc()).$take(l):w(f,"enum_for",["min_by",l],function m(){return(m.$$s??this).$enumerator_size()},{$$s:f})},-1),A(D,"$minmax",function g(){var f,l=g.$$p||v;g.$$p=null,l=le(f=l)?f:w(U,"proc",[],function($,ie){return null==$&&($=v),null==ie&&(ie=v),$["$<=>"](ie)});var u=v,p=v,m=!0;return this.$each.$$p=function(){var C=K.$destructure(arguments);if(m)u=p=C,m=!1;else{var $=l.$call(u,C);$===v?U.$raise(P("ArgumentError"),"comparison failed"):$>0&&(u=C);var ie=l.$call(p,C);ie===v?U.$raise(P("ArgumentError"),"comparison failed"):ie<0&&(p=C)}},this.$each(),[u,p]}),A(D,"$minmax_by",function g(){var l=g.$$p||v,c=this;if(g.$$p=null,!le(l))return w(c,"enum_for",["minmax_by"],function C(){return(C.$$s??this).$enumerator_size()},{$$s:c});var p,m,f=v,u=v;return c.$each.$$p=function(){var C=K.$destructure(arguments),$=d(l,C);(void 0===p||$["$<=>"](p)<0)&&(f=C,p=$),(void 0===m||$["$<=>"](m)>0)&&(u=C,m=$)},c.$each(),[f,u]}),A(D,"$none?",function g(l){try{var c=V("return"),f=g.$$p||v;return g.$$p=null,le(void 0!==l)?w(this,"each",[],function(m){var ie=v;if(ie=F(O(arguments)),!le(w(l,"public_send",["==="].concat(x(ie)))))return v;c.$throw(!1)},{$$arity:-1,$$ret:c}):w(this,"each",[],f!==v?function(m){var C;if(C=O(arguments),!le(E.yieldX(f,x(C))))return v;c.$throw(!1)}:function(m){var C,ie=v;if(C=O(arguments),ie=K.$destructure(C),!le(ie))return v;c.$throw(!1)},{$$arity:-1,$$ret:c}),!0}catch(p){if(p===c)return p.$v;throw p}},-1),A(D,"$one?",function g(l){try{var c=V("return"),f=g.$$p||v,p=v;return g.$$p=null,p=0,le(void 0!==l)?w(this,"each",[],function(C){var se=v;return se=F(O(arguments)),le(w(l,"public_send",["==="].concat(x(se))))?(p=z(p,1),le(Y(p,1))?void c.$throw(!1):v):v},{$$arity:-1,$$ret:c}):w(this,"each",[],f!==v?function(C){var $;return $=O(arguments),le(E.yieldX(f,x($)))?(p=z(p,1),le(Y(p,1))?void c.$throw(!1):v):v}:function(C){var $;return $=O(arguments),le(K.$destructure($))?(p=z(p,1),le(Y(p,1))?void c.$throw(!1):v):v},{$$arity:-1,$$ret:c}),p["$=="](1)}catch(m){if(m===c)return m.$v;throw m}},-1),A(D,"$partition",function g(){var l=g.$$p||v,c=this;if(g.$$p=null,l===v)return w(c,"enum_for",["partition"],function m(){return(m.$$s??this).$enumerator_size()},{$$s:c});var f=[],u=[];return c.$each.$$p=function(){var m=K.$destructure(arguments),C=d(l,m);le(C)?f.push(m):u.push(m)},c.$each(),[f,u]}),A(D,"$reject",function g(){var l=g.$$p||v,c=this;if(g.$$p=null,l===v)return w(c,"enum_for",["reject"],function u(){return(u.$$s??this).$enumerator_size()},{$$s:c});var f=[];return c.$each.$$p=function(){var u=K.$destructure(arguments),p=d(l,u);le(p)||f.push(u)},c.$each(),f}),A(D,"$reverse_each",function g(){var l=g.$$p||v,c=this;if(g.$$p=null,l===v)return w(c,"enum_for",["reverse_each"],function p(){return(p.$$s??this).$enumerator_size()},{$$s:c});var f=[];c.$each.$$p=function(){f.push(arguments)},c.$each();for(var u=f.length-1;u>=0;u--)H(l,f[u]);return f}),A(D,"$slice_before",function g(l){var c=g.$$p||v,f=this;return g.$$p=null,le(void 0===l&&c===v)&&U.$raise(P("ArgumentError"),"both pattern and block are given"),le(void 0!==l&&c!==v||arguments.length>1)&&U.$raise(P("ArgumentError"),"wrong number of arguments ("+arguments.length+" expected 1)"),w(P("Enumerator"),"new",[],function u(p){var m=u.$$s??this;null==p&&(p=v);var C=[];m.$each.$$p=c!==v?void 0===l?function(){var $=K.$destructure(arguments),ie=d(c,$);le(ie)&&C.length>0&&(p["$<<"](C),C=[]),C.push($)}:function(){var $=K.$destructure(arguments),ie=c($,l.$dup());le(ie)&&C.length>0&&(p["$<<"](C),C=[]),C.push($)}:function(){var $=K.$destructure(arguments),ie=l["$==="]($);le(ie)&&C.length>0&&(p["$<<"](C),C=[]),C.push($)},m.$each(),C.length>0&&p["$<<"](C)},{$$s:f})},-1),A(D,"$slice_after",function g(l){var c=g.$$p||v,f=this;return g.$$p=null,le(void 0===l&&c===v)&&U.$raise(P("ArgumentError"),"both pattern and block are given"),le(void 0!==l&&c!==v||arguments.length>1)&&U.$raise(P("ArgumentError"),"wrong number of arguments ("+arguments.length+" expected 1)"),le(void 0!==l)&&(c=w(U,"proc",[],function(p){return null==p&&(p=v),l["$==="](p)})),w(P("Enumerator"),"new",[],function u(p){var C,m=u.$$s??this;null==p&&(p=v),m.$each.$$p=function(){var $=K.$destructure(arguments),ie=d(c,$);null==C&&(C=[]),le(ie)?(C.push($),p.$yield(C),C=null):C.push($)},m.$each(),null!=C&&p.$yield(C)},{$$s:f})},-1),A(D,"$slice_when",function g(){var l=g.$$p||v;return g.$$p=null,l===v&&U.$raise(P("ArgumentError"),"wrong number of arguments (0 for 1)"),w(P("Enumerator"),"new",[],function f(u){var p=f.$$s??this;null==u&&(u=v);var m=v,C=v;p.$each_cons.$$p=function(){var $=K.$destructure(arguments),ie=$[0],se=$[1],Ee=H(l,[ie,se]);C=se,m===v&&(m=[]),le(Ee)?(m.push(ie),u.$yield(m),m=[]):m.push(ie)},p.$each_cons(2),m!==v&&(m.push(C),u.$yield(m))},{$$s:this})}),A(D,"$sort",function g(){var f,l=g.$$p||v;return g.$$p=null,f=this.$to_a(),l===v&&(l=X(function(p,m){return null==p&&(p=v),null==m&&(m=v),p["$<=>"](m)})),w(f,"sort",[],l.$to_proc())}),A(D,"$sort_by",function g(){var l=g.$$p||v,c=this,f=v;return g.$$p=null,l===v?w(c,"enum_for",["sort_by"],function u(){return(u.$$s??this).$enumerator_size()},{$$s:c}):(f=w(c,"map",[],function(){var p=v;return p=K.$destructure(arguments),[E.yield1(l,p),p]}),w(f,"sort!",[],function(p,m){return null==p&&(p=v),null==m&&(m=v),p[0]["$<=>"](m[0])}),w(f,"map!",[],function(p){return null==p&&(p=v),p[1]}))}),A(D,"$sum",function g(l){var c=g.$$p||v,u=v,p=v;return g.$$p=null,null==l&&(l=0),u=l,p=0,w(this,"each",[],function(C){var ie,se=v,Ee=v,Ie=v;return ie=O(arguments),se=c!==v?E.yieldX(c,x(ie)):K.$destructure(ie),L([P(P("Float"),"INFINITY"),P(P("Float"),"INFINITY")["$-@"]()]["$include?"](se))&&le(se["$respond_to?"]("-"))?(Ee=q(se,p),Ie=z(u,Ee),p=q(q(Ie,u),Ee),u=Ie):u=z(u,se)},-1),u},-1),A(D,"$take",function(l){return this.$first(l)}),A(D,"$take_while",function g(){try{var l=V("return"),c=g.$$p||v,u=v;return g.$$p=null,le(c)?(u=[],w(this,"each",[],function(m){var C,ie=v;return C=O(arguments),ie=K.$destructure(C),le(E.yield1(c,ie))||l.$throw(u),u.push(ie)},{$$arity:-1,$$ret:l})):this.$enum_for("take_while")}catch(p){if(p===l)return p.$v;throw p}}),A(D,"$uniq",function g(){var l=g.$$p||v,f=v;return g.$$p=null,f=I([],{}),w(this,"each",[],function(p){var m,$,ie=v,se=v;return m=O(arguments),ie=K.$destructure(m),se=l!==v?E.yield1(l,ie):ie,le(f["$key?"](se))?v:(w(f,"[]=",$=[se,ie]),$[$.length-1])},-1),f.$values()}),A(D,"$tally",function(l){var f;return l&&l!==v&&J(l),f=w(w(this,"group_by",[],"itself".$to_proc()),"transform_values",[],"count".$to_proc()),le(l)?(w(f,"each",[],function(p,m){var C;return null==p&&(p=v),null==m&&(m=v),C=[p,z(l.$fetch(p,0),m)],w(l,"[]=",C),C[C.length-1]}),l):f},-1),A(D,"$to_h",function g(l){var u,c=g.$$p||v,p=this;if(g.$$p=null,u=O(arguments),c!==v)return w(w(p,"map",[],c.$to_proc()),"to_h",x(u));var m=I([],{});return p.$each.$$p=function(){var C=K.$destructure(arguments),$=K["$coerce_to?"](C,P("Array"),"to_ary");$.$$is_array||U.$raise(P("TypeError"),"wrong element type "+$.$class()+" (expected array)"),2!==$.length&&U.$raise(P("ArgumentError"),"wrong array length (expected 2, was "+$.$length()+")"),E.hash_put(m,$[0],$[1])},p.$each.apply(p,u),m},-1),A(D,"$to_set",function g(l,c){var u,p,f=g.$$p||v,C=this;return g.$$p=null,(u=O(arguments)).length>0&&(p=u.shift()),null==p&&(p=R("Set")),w(p,"new",[C].concat(x(u)),f.$to_proc())},-1),A(D,"$zip",function g(l){var u,p=this;return g.$$p=null,u=O(arguments),w(p.$to_a(),"zip",x(u))},-1),S(D,"find","detect"),S(D,"filter","find_all"),S(D,"flat_map","collect_concat"),S(D,"map","collect"),S(D,"member?","include?"),S(D,"reduce","inject"),S(D,"select","find_all"),S(D,"to_a","entries")}()},Opal.modules["corelib/enumerator/arithmetic_sequence"]=function(E){var I,X,L,le=E.klass,_e=E.truthy,d=E.to_a,H=E.eqeq,J=E.Kernel,_=E.def,w=E.rb_gt,O=E.rb_lt,x=E.rb_le,K=E.rb_ge,V=E.rb_plus,A=E.rb_minus,U=E.eqeqeq,N=E.not,Y=E.rb_times,T=E.rb_divide,j=E.alias,z=E.nil,q=E.$$$;return I=[],L=[X=le("::",null,"Enumerator")].concat(I),function(S,k,v){var P=le(S,k,"ArithmeticSequence"),B=[P].concat(v),te=E.$r(B),D=P.$$prototype;D.step_arg2=D.receiver_num=D.step_arg1=D.step=D.range=D.topfx=D.bypfx=D.creation_method=D.skipped_arg=z,E.prop(P.$$prototype,"$$is_arithmetic_seq",!0);var fe=1/0;return _(P,"$initialize",function(F,g,l){var c,f=this,u=z;return null==l&&(l="step"),f.creation_method=l,_e(F["$is_a?"](q("Array")))?(c=[].concat(d(F)),f.step_arg1=c[0]??z,f.step_arg2=c[1]??z,f.topfx=c[2]??z,f.bypfx=c[3]??z,f.receiver_num=g,f.step=1,f.range=_e(f.step_arg2)?(f.step=f.step_arg2,E.Range.$new(f.receiver_num,f.step_arg1,!1)):_e(f.step_arg1)?E.Range.$new(f.receiver_num,f.step_arg1,!1):E.Range.$new(f.receiver_num,z,!1)):(_e(g)||(f.skipped_arg=!0),c=[F,_e(u=g)?u:1],f.range=c[0],f.step=c[1]),f.object=f,H(f.step,0)&&J.$raise(te("ArgumentError"),"step can't be 0"),_e(f.step["$respond_to?"]("to_int"))?z:J.$raise(te("ArgumentError"),"no implicit conversion of "+f.step.$class()+" into Integer")},-2),P.$attr_reader("step"),_(P,"$begin",function(){return this.range.$begin()}),_(P,"$end",function(){return this.range.$end()}),_(P,"$exclude_end?",function(){return this.range["$exclude_end?"]()}),_(P,"$_lesser_than_end?",function(F){var l,c,g=this;return l=_e(c=g.$end())?c:fe,_e(w(g.$step(),0))?_e(g["$exclude_end?"]())?O(F,l):x(F,l):_e(g["$exclude_end?"]())?w(F,l):K(F,l)}),_(P,"$_greater_than_begin?",function(F){var l,c;return l=_e(c=this.$begin())?c:fe["$-@"](),_e(w(this.$step(),0))?w(F,l):O(F,l)}),_(P,"$first",function(F){var g=this,l=z,c=z,f=z;if(l=_e(c=g.$begin())?c:fe["$-@"](),!_e(F))return _e(g["$_lesser_than_end?"](l))?l:z;for(f=[];_e(_e(c=g["$_lesser_than_end?"](l))?w(F,0):c);)f["$<<"](l),l=V(l,g.$step()),F=A(F,1);return f},-1),_(P,"$each",function R(){var l,F=R.$$p||z,g=this,c=z;if(R.$$p=null,F===z)return g;for(U(z,g.$begin())&&J.$raise(te("TypeError"),"nil can't be coerced into Integer"),c=_e(l=g.$begin())?l:fe["$-@"]();_e(g["$_lesser_than_end?"](c));)E.yield1(F,c),c=V(c,g.$step());return g}),_(P,"$last",function(F){var g=this,l=z,c=z,f=z;if(U(fe,l=g.$end())||U(fe["$-@"](),l)?J.$raise(q("FloatDomainError"),g.$end()):U(z,l)&&J.$raise(q("RangeError"),"cannot get the last element of endless arithmetic sequence"),c=A(g.$end(),A(g.$end(),g.$begin())["$%"](g.$step())),_e(g["$_lesser_than_end?"](c))||(c=A(c,g.$step())),!_e(F))return _e(g["$_greater_than_begin?"](c))?c:z;for(f=[];_e(_e(l=g["$_greater_than_begin?"](c))?w(F,0):l);)f["$<<"](c),c=A(c,g.$step()),F=A(F,1);return f.$reverse()},-1),_(P,"$size",function(){var g,F=this,l=z;return g=_e(w(F.$step(),0))?1:-1,N(F["$_lesser_than_end?"](F.$begin()))?0:_e([fe["$-@"](),fe]["$include?"](F.$step()))?1:_e([Y(fe["$-@"](),g),z]["$include?"](F.$begin()))||_e([Y(fe,g),z]["$include?"](F.$end()))?fe:(l=A(F.$end(),A(F.$end(),F.$begin())["$%"](F.$step())),_e(F["$_lesser_than_end?"](l))||(l=A(l,F.$step())),V(T(A(l,F.$begin()),F.$step()).$abs().$to_i(),1))}),_(P,"$==",function(F){var l,c,f,u,g=this;return _e(l=_e(c=_e(f=_e(u=g.$class()["$=="](F.$class()))?g.$begin()["$=="](F.$begin()):u)?g.$end()["$=="](F.$end()):f)?g.$step()["$=="](F.$step()):c)?g["$exclude_end?"]()["$=="](F["$exclude_end?"]()):l}),_(P,"$hash",function(){var F=this;return[F.$begin(),F.$end(),F.$step(),F["$exclude_end?"]()].$hash()}),_(P,"$inspect",function(){var F=this,g=z;return _e(F.receiver_num)?(g=_e(F.step_arg2)?"("+F.topfx+F.step_arg1.$inspect()+", "+F.bypfx+F.step_arg2.$inspect()+")":_e(F.step_arg1)?"("+F.topfx+F.step_arg1.$inspect()+")":z,"("+F.receiver_num.$inspect()+"."+F.creation_method+g+")"):(g=_e(F.skipped_arg)?z:"("+F.step+")","(("+F.range.$inspect()+")."+F.creation_method+g+")")}),j(P,"===","=="),j(P,"eql?","==")}(X,X,L)},Opal.modules["corelib/enumerator/chain"]=function(E){var j,re,N,le=E.deny_frozen_access,_e=E.klass,d=E.slice,H=E.def,J=E.send,_=E.to_a,w=E.truthy,O=E.rb_plus,x=E.thrower,K=E.nil,V=E.$$$;return N=_e("::",null,"Enumerator"),(re=(j=_e(N,N,"Chain")).$$prototype).enums=re.iterated=K,H(j,"$initialize",function(q){var M,I=this;return M=d(arguments),le(I),I.enums=M,I.iterated=[],I.object=I},-1),H(j,"$each",function z(q){var M,I,Z=z.$$p||K,X=this;return z.$$p=null,M=d(arguments),I=M,Z===K?J(X,"to_enum",["each"].concat(_(I)),function L(){return(L.$$s??this).$size()},{$$s:X}):(J(X.enums,"each",[],function L(S){var k=L.$$s??this;return null==k.iterated&&(k.iterated=K),null==S&&(S=K),k.iterated["$<<"](S),J(S,"each",_(I),Z.$to_proc())},{$$s:X}),X)},-1),H(j,"$size",function(q){try{var M,I,Z=x("return"),X=this,L=K;return M=d(arguments),I=M,L=0,J(X.enums,"each",[],function(k){var v;return null==k&&(k=K),v=J(k,"size",_(I)),w([K,V(V("Float"),"INFINITY")]["$include?"](v))&&Z.$throw(v),L=O(L,v)},{$$ret:Z}),L}catch(S){if(S===Z)return S.$v;throw S}},-1),H(j,"$rewind",function(){var q=this;return J(q.iterated,"reverse_each",[],function(M){return null==M&&(M=K),w(M["$respond_to?"]("rewind"))?M.$rewind():K}),q.iterated=[],q}),H(j,"$inspect",function(){return"#<Enumerator::Chain: "+this.enums.$inspect()+">"})},Opal.modules["corelib/enumerator/generator"]=function(E){var U,re,z,q,Z,Y,le=E.deny_frozen_access,_e=E.klass,d=E.truthy,H=E.Kernel,J=E.def,_=E.slice,w=E.send,O=[],x=E.nil,K=E.$$$;return U=O,re=Y=[_e(O[0],null,"Enumerator")].concat(U),q=[z=_e(Y[0],null,"Generator")].concat(re),Z=E.$r(q),z.$$prototype.block=x,z.$include(K("Enumerable")),J(z,"$initialize",function I(){var X=I.$$p||x;return I.$$p=null,le(this),d(X)||H.$raise(K("LocalJumpError"),"no block given"),this.block=X}),J(z,"$each",function I(X){var k,L=I.$$p||x,v=this,P=x;I.$$p=null,k=_(arguments),P=w(Z("Yielder"),"new",[],L.$to_proc());try{k.unshift(P),E.yieldX(v.block,k)}catch(B){if(B&&"breaker"==B.$thrower_type)return B.$v;throw B}return v},-1)},Opal.modules["corelib/enumerator/lazy"]=function(E){var S,te,D,fe,R,k,le=E.truthy,_e=E.coerce_to,d=E.yield1,H=E.yieldX,J=E.deny_frozen_access,_=E.klass,w=E.slice,O=E.send2,x=E.find_super,K=E.to_a,V=E.defs,A=E.Kernel,U=E.send,N=E.def,Y=E.return_self,T=E.Opal,j=E.rb_lt,re=E.eqeqeq,z=E.rb_plus,q=E.alias,M=E.nil,I=E.$$$;return S=[],te=[k=_("::",null,"Enumerator")].concat(S),fe=[D=_(k,k,"Lazy")].concat(te),R=E.$r(fe),D.$$prototype.enumerator=M,_(D,I("Exception"),"StopLazyError"),V(D,"$for",function g(l,c){var u,p=g.$$p||M,m=this,C=M;return g.$$p=null,u=w(arguments,1),(C=O(m,x(m,"for",g,!1,!0),"for",[l].concat(K(u)),p)).enumerator=l,C},-2),N(D,"$initialize",function g(l,c){var f=g.$$p||M,u=this;return g.$$p=null,null==c&&(c=M),J(u),f===M&&A.$raise(I("ArgumentError"),"tried to call lazy new without a block"),u.enumerator=l,O(u,x(u,"initialize",g,!1,!0),"initialize",[c],function(m,C){var ie;null==m&&(m=M),ie=w(arguments,1);try{return U(l,"each",K(ie),function(Ee){var ce;(ce=w(arguments)).unshift(m),H(f,ce)},-1)}catch(se){if(!E.rescue(se,[R("StopLazyError")]))throw se;try{return M}finally{E.pop_exception()}}},-2)},-2),N(D,"$lazy",Y),N(D,"$collect",function g(){var l=g.$$p||M;return g.$$p=null,le(l)||A.$raise(I("ArgumentError"),"tried to call lazy map without a block"),U(R("Lazy"),"new",[this,this.$enumerator_size()],function(u,p){var m;null==u&&(u=M),m=w(arguments,1);var $=H(l,m);u.$yield($)},-2)}),N(D,"$collect_concat",function g(){var l=g.$$p||M;return g.$$p=null,le(l)||A.$raise(I("ArgumentError"),"tried to call lazy map without a block"),U(R("Lazy"),"new",[this,M],function(u,p){var m;null==u&&(u=M),m=w(arguments,1);var $=H(l,m);if($["$respond_to?"]("force")&&$["$respond_to?"]("each"))U($,"each",[],function(Ee){return null==Ee&&(Ee=M),u.$yield(Ee)});else{var ie=T.$try_convert($,I("Array"),"to_ary");ie===M?u.$yield($):U($,"each",[],function(Ee){return null==Ee&&(Ee=M),u.$yield(Ee)})}},-2)}),N(D,"$drop",function(l){var f,u,p=M;return l=_e(l,I("Integer"),"to_int"),le(j(l,0))&&A.$raise(I("ArgumentError"),"attempt to drop negative size"),f=this.$enumerator_size(),u=re(I("Integer"),f)&&le(j(l,f))?l:f,p=0,U(R("Lazy"),"new",[this,u],function(C,$){var se;return null==C&&(C=M),se=w(arguments,1),le(j(p,l))?p=z(p,1):U(C,"yield",K(se))},-2)}),N(D,"$drop_while",function g(){var l=g.$$p||M,f=M;return g.$$p=null,le(l)||A.$raise(I("ArgumentError"),"tried to call lazy drop_while without a block"),f=!0,U(R("Lazy"),"new",[this,M],function(p,m){var $;if(null==p&&(p=M),$=w(arguments,1),!le(f))return U(p,"yield",K($));var ie=H(l,$);le(ie)||(f=!1,U(p,"yield",K($)))},-2)}),N(D,"$enum_for",function g(l,c){var u,p,m,f=g.$$p||M,C=this;return g.$$p=null,(u=w(arguments)).length>0&&(p=u.shift()),null==p&&(p="each"),m=u,U(C.$class(),"for",[C,p].concat(K(m)),f.$to_proc())},-1),N(D,"$find_all",function g(){var l=g.$$p||M;return g.$$p=null,le(l)||A.$raise(I("ArgumentError"),"tried to call lazy select without a block"),U(R("Lazy"),"new",[this,M],function(u,p){var m,C;null==u&&(u=M),m=w(arguments,1);var $=H(l,C=m);le($)&&U(u,"yield",K(C))},-2)}),N(D,"$grep",function g(l){var c=g.$$p||M;return g.$$p=null,le(c)?U(R("Lazy"),"new",[this,M],function(p,m){var C;null==p&&(p=M),C=w(arguments,1);var ie=T.$destructure(C),se=l["$==="](ie);le(se)&&(se=d(c,ie),p.$yield(d(c,ie)))},-2):U(R("Lazy"),"new",[this,M],function(p,m){var C;null==p&&(p=M),C=w(arguments,1);var ie=T.$destructure(C),se=l["$==="](ie);le(se)&&p.$yield(ie)},-2)}),N(D,"$reject",function g(){var l=g.$$p||M;return g.$$p=null,le(l)||A.$raise(I("ArgumentError"),"tried to call lazy reject without a block"),U(R("Lazy"),"new",[this,M],function(u,p){var m,C;null==u&&(u=M),m=w(arguments,1);var $=H(l,C=m);le($)||U(u,"yield",K(C))},-2)}),N(D,"$take",function(l){var f,u,p=M;return l=_e(l,I("Integer"),"to_int"),le(j(l,0))&&A.$raise(I("ArgumentError"),"attempt to take negative size"),f=this.$enumerator_size(),u=re(I("Integer"),f)&&le(j(l,f))?l:f,p=0,U(R("Lazy"),"new",[this,u],function(C,$){var se;return null==C&&(C=M),se=w(arguments,1),le(j(p,l))?(U(C,"yield",K(se)),p=z(p,1)):A.$raise(R("StopLazyError"))},-2)}),N(D,"$take_while",function g(){var l=g.$$p||M;return g.$$p=null,le(l)||A.$raise(I("ArgumentError"),"tried to call lazy take_while without a block"),U(R("Lazy"),"new",[this,M],function(u,p){var m,C;null==u&&(u=M),m=w(arguments,1);var $=H(l,C=m);le($)?U(u,"yield",K(C)):A.$raise(R("StopLazyError"))},-2)}),N(D,"$inspect",function(){return"#<"+this.$class()+": "+this.enumerator.$inspect()+">"}),q(D,"force","to_a"),q(D,"filter","find_all"),q(D,"flat_map","collect_concat"),q(D,"map","collect"),q(D,"select","find_all"),q(D,"to_enum","enum_for")},Opal.modules["corelib/enumerator/yielder"]=function(E){var K,Y,A,le=E.klass,_e=E.def,d=E.slice,H=E.send,J=E.to_a,_=[],w=E.nil;return K=_,A=[le(_[0],null,"Enumerator")].concat(K),(Y=le(A[0],null,"Yielder")).$$prototype.block=w,_e(Y,"$initialize",function j(){var re=j.$$p||w;return j.$$p=null,this.block=re,this}),_e(Y,"$yield",function(re){var z,Z=this;z=d(arguments);var M=E.yieldX(Z.block,z);if(M&&"break"==M.$thrower_type)throw M;return M},-1),_e(Y,"$<<",function(re){return this.$yield(re),this}),_e(Y,"$to_proc",function(){return H(this,"proc",[],function z(q){var Z,I=z.$$s??this;return Z=d(arguments),H(I,"yield",J(Z))},{$$arity:-1,$$s:this})})},Opal.modules["corelib/enumerator"]=function(E){var L,S,k,v,P,le=E.slice,_e=E.coerce_to,d=E.deny_frozen_access,H=E.klass,J=E.defs,_=E.truthy,w=E.send,O=E.not,x=E.def,K=E.rb_plus,V=E.to_a,A=E.Opal,U=E.send2,N=E.find_super,Y=E.rb_ge,T=E.Kernel,j=E.rb_le,re=E.alias,Z=E.nil,M=E.$$$;return E.top.$require("corelib/enumerable"),L=[],k=[S=H("::",null,"Enumerator")].concat(L),v=E.$r(k),(P=S.$$prototype).size=P.args=P.object=P.method=P.values=P.cursor=Z,S.$include(M("Enumerable")),S.$$prototype.$$is_enumerator=!0,J(S,"$for",function B(te,D,fe){var F,g,l,R=B.$$p||Z,c=this;B.$$p=null,(F=le(arguments,1)).length>0&&(g=F.shift()),null==g&&(g="each"),l=F;var f=c.$allocate();return f.object=te,f.size=R,f.method=g,f.args=l,f.cursor=0,f},-2),x(S,"$initialize",function B(te){var D=B.$$p||Z,F=this;return B.$$p=null,le(arguments),d(F),F.cursor=0,_(D)?(F.object=w(v("Generator"),"new",[],D.$to_proc()),F.method="each",F.args=[],F.size=arguments[0]||Z,_(F.size)&&O(F.size["$respond_to?"]("call"))?F.size=_e(F.size,M("Integer"),"to_int"):Z):(F.object=arguments[0],F.method=arguments[1]||"each",F.args=le(arguments,2),F.size=Z)},-1),x(S,"$each",function B(te){var R,D=B.$$p||Z,F=this;return B.$$p=null,R=le(arguments),_(D["$nil?"]())&&_(R["$empty?"]())?F:(R=K(F.args,R),_(D["$nil?"]())?w(F.$class(),"new",[F.object,F.method].concat(V(R))):w(F.object,"__send__",[F.method].concat(V(R)),D.$to_proc()))},-1),x(S,"$size",function(){return _(this.size["$respond_to?"]("call"))?w(this.size,"call",V(this.args)):this.size}),x(S,"$with_index",function B(te){var D=B.$$p||Z;if(B.$$p=null,null==te&&(te=0),te=_(te)?_e(te,M("Integer"),"to_int"):0,!_(D))return w(this,"enum_for",["with_index",te],function g(){return(g.$$s??this).$size()},{$$s:this});var F=te;return this.$each.$$p=function(){var g=A.$destructure(arguments),l=D(g,F);return F++,l},this.$each()},-1),x(S,"$each_with_index",function B(){var te=B.$$p||Z,D=this;return B.$$p=null,te===Z?w(D,"enum_for",["each_with_index"],function fe(){return(fe.$$s??this).$size()},{$$s:D}):(U(D,N(D,"each_with_index",B,!1,!0),"each_with_index",[],te),D.object)}),x(S,"$rewind",function(){return this.cursor=0,this}),x(S,"$peek_values",function(){var D,te=this;return te.values=_(D=te.values)?D:w(te,"map",[],function(R){return le(arguments)},-1),_(Y(te.cursor,te.values.$length()))&&T.$raise(M("StopIteration"),"iteration reached an end"),te.values["$[]"](te.cursor)}),x(S,"$peek",function(){var D=Z;return D=this.$peek_values(),_(j(D.$length(),1))?D["$[]"](0):D}),x(S,"$next_values",function(){var D;return D=this.$peek_values(),this.cursor=K(this.cursor,1),D}),x(S,"$next",function(){var D=Z;return D=this.$next_values(),_(j(D.$length(),1))?D["$[]"](0):D}),x(S,"$feed",function(te){return this.$raise(v("NotImplementedError"),"Opal doesn't support Enumerator#feed")}),x(S,"$+",function(te){return M(M("Enumerator"),"Chain").$new(this,te)}),x(S,"$inspect",function(){var te=this,D=Z;return D="#<"+te.$class()+": "+te.object.$inspect()+":"+te.method,_(te.args["$any?"]())&&(D=K(D,"("+te.args.$inspect()["$[]"](M("Range").$new(1,-2))+")")),K(D,">")}),re(S,"with_object","each_with_object"),S.$autoload("ArithmeticSequence","corelib/enumerator/arithmetic_sequence"),S.$autoload("Chain","corelib/enumerator/chain"),S.$autoload("Generator","corelib/enumerator/generator"),S.$autoload("Lazy","corelib/enumerator/lazy"),S.$autoload("Yielder","corelib/enumerator/yielder")},Opal.modules["corelib/numeric"]=function(E){var P,le=E.klass,_e=E.truthy,d=E.Kernel,H=E.def,J=E.to_ary,_=E.return_self,w=E.rb_minus,O=E.rb_times,x=E.rb_lt,K=E.eqeq,V=E.rb_divide,A=E.return_val,U=E.Opal,N=E.slice,Y=E.extract_kwargs,T=E.ensure_kwargs,j=E.not,re=E.send,z=E.rb_ge,q=E.rb_le,Z=E.rb_plus,M=E.rb_gt,I=E.alias,L=E.nil,S=E.$$$;return E.top.$require("corelib/comparable"),(P=le("::",null,"Numeric")).$include(S("Comparable")),H(P,"$coerce",function(te){var D=this;return _e(te["$instance_of?"](D.$class()))?[te,D]:[d.$Float(te),d.$Float(D)]}),H(P,"$__coerced__",function(te,D){var fe,R;if(_e(D["$respond_to?"]("coerce")))return R=D.$coerce(this),((fe=J(R))[0]??L).$__send__(te,fe[1]??L);switch(te){case"+":case"-":case"*":case"/":case"%":case"&":case"|":case"^":case"**":return d.$raise(S("TypeError"),D.$class()+" can't be coerced into Numeric");case">":case">=":case"<":case"<=":case"<=>":return d.$raise(S("ArgumentError"),"comparison of "+this.$class()+" with "+D.$class()+" failed");default:return L}}),H(P,"$<=>",function(te){return _e(this["$equal?"](te))?0:L}),H(P,"$+@",_),H(P,"$-@",function(){return w(0,this)}),H(P,"$%",function(te){return w(this,O(te,this.$div(te)))}),H(P,"$abs",function(){return x(this,0)?this["$-@"]():this}),H(P,"$abs2",function(){return O(this,this)}),H(P,"$angle",function(){return x(this,0)?S(S("Math"),"PI"):0}),H(P,"$ceil",function(te){return null==te&&(te=0),this.$to_f().$ceil(te)},-1),H(P,"$conj",_),H(P,"$denominator",function(){return this.$to_r().$denominator()}),H(P,"$div",function(te){return K(te,0)&&d.$raise(S("ZeroDivisionError"),"divided by o"),V(this,te).$floor()}),H(P,"$divmod",function(te){return[this.$div(te),this["$%"](te)]}),H(P,"$fdiv",function(te){return V(this.$to_f(),te)}),H(P,"$floor",function(te){return null==te&&(te=0),this.$to_f().$floor(te)},-1),H(P,"$i",function(){return d.$Complex(0,this)}),H(P,"$imag",A(0)),H(P,"$integer?",A(!1)),H(P,"$nonzero?",function(){return _e(this["$zero?"]())?L:this}),H(P,"$numerator",function(){return this.$to_r().$numerator()}),H(P,"$polar",function(){return[this.$abs(),this.$arg()]}),H(P,"$quo",function(te){return V(U["$coerce_to!"](this,S("Rational"),"to_r"),te)}),H(P,"$real",_),H(P,"$real?",A(!0)),H(P,"$rect",function(){return[this,0]}),H(P,"$round",function(te){return this.$to_f().$round(te)},-1),H(P,"$step",function B(te,D,fe){var F,g,l,c,f,u,R=B.$$p||L,p=this,m=L;function C(){c===L&&d.$raise(S("TypeError"),"step must be numeric"),null!=c&&c["$=="](0)&&d.$raise(S("ArgumentError"),"step can't be 0"),(c===L||null==c)&&(c=1);var he=c["$<=>"](0);he===L&&d.$raise(S("ArgumentError"),"0 can't be coerced into "+c.$class()),(l===L||null==l)&&(l=he>0?S(S("Float"),"INFINITY"):S(S("Float"),"INFINITY")["$-@"]()),U.$compare(p,l)}function $(){if(c>0&&p>l||c<0&&p<l)return 0;if(c===1/0||c===-1/0)return 1;var he=Math.abs,Se=Math.floor,be=(he(p)+he(l)+he(l-p))/he(c)*S(S("Float"),"EPSILON");return be===1/0||be===-1/0?0:(be>.5&&(be=.5),Se((l-p)/c+be)+1)}function ie(){if(C(),0===c)return 1/0;if(c%1!=0)return $();if(c>0&&p>l||c<0&&p<l)return 0;var he=Math.ceil,Se=Math.abs;return he((Se(p-l)+1)/Se(c))}if(B.$$p=null,F=N(arguments),g=Y(F),g=T(g),F.length>0&&(l=F.shift()),F.length>0&&(c=F.shift()),f=g.$$smap.to,u=g.$$smap.by,void 0!==l&&void 0!==f&&d.$raise(S("ArgumentError"),"to is given twice"),void 0!==c&&void 0!==u&&d.$raise(S("ArgumentError"),"step is given twice"),void 0!==f&&(l=f),void 0!==u&&(c=u),void 0===l&&(l=L),R===L)return(j(l)||_e(l["$is_a?"](S("Numeric"))))&&(j(c)||_e(c["$is_a?"](S("Numeric"))))?S(S("Enumerator"),"ArithmeticSequence").$new([l,c,_e(f)?"to: ":L,_e(u)?"by: ":L],p):re(p,"enum_for",["step",l,c],ie.$to_proc());C();var se=c["$negative?"](),Ee=c["$=="](0)||l===1/0&&!se||l===-1/0&&se;if(p.$$is_number&&c.$$is_number&&l.$$is_number){if(p%1!=0||!Ee&&l%1!=0||c%1!=0){var ce=p.$to_f().valueOf();c=c.$to_f().valueOf(),l=l.$to_f().valueOf();var Me=$();if(isFinite(c))if(0===c)for(;;)R(ce);else for(var $e=0;$e<Me;$e++){var ye=$e*c+p;(c>=0?l<ye:l>ye)&&(ye=l),R(ye)}else 0!==Me&&R(ce);return p}var Ie=p;if(Ee)for(;;Ie+=c)R(Ie);else if(se)for(;Ie>=l;Ie+=c)R(Ie);else for(;Ie<=l;Ie+=c)R(Ie);return p}for(m=p;_e(se?z(m,l):q(m,l));)E.yield1(R,m),m=Z(m,c)},-1),H(P,"$to_c",function(){return d.$Complex(this,0)}),H(P,"$to_int",function(){return this.$to_i()}),H(P,"$truncate",function(te){return null==te&&(te=0),this.$to_f().$truncate(te)},-1),H(P,"$zero?",function(){return this["$=="](0)}),H(P,"$positive?",function(){return M(this,0)}),H(P,"$negative?",function(){return x(this,0)}),H(P,"$dup",_),H(P,"$clone",function(te){return te=T(te),this},-1),H(P,"$finite?",A(!0)),H(P,"$infinite?",A(L)),I(P,"arg","angle"),I(P,"conjugate","conj"),I(P,"imaginary","imag"),I(P,"magnitude","abs"),I(P,"modulo","%"),I(P,"phase","arg"),I(P,"rectangular","rect")},Opal.modules["corelib/array"]=function(E){var le=E.truthy,_e=E.falsy,d=E.hash_ids,H=E.yield1,J=E.hash_get,_=E.hash_put,w=E.hash_delete,O=E.coerce_to,x=E.respond_to,K=E.deny_frozen_access,V=E.freeze,A=E.klass,U=E.slice,N=E.defs,Y=E.Kernel,T=E.def,j=E.Opal,re=E.eqeqeq,z=E.hash2,q=E.send2,Z=E.find_super,M=E.send,I=E.rb_gt,X=E.rb_times,L=E.eqeq,S=E.rb_minus,k=E.to_a,v=E.to_ary,P=E.gvars,B=E.rb_ge,te=E.assign_ivar,D=E.rb_lt,fe=E.return_self,R=E.neqeq,F=E.alias,g=E.top,c=E.nil,f=E.$$$;return g.$require("corelib/enumerable"),g.$require("corelib/numeric"),function(u,p,m){var C=A("::",Array,"Array"),$=[C].concat([]),ie=E.$r($);function Ee(be,ae){return ae.$$name===E.Array?be:ae.$allocate().$replace(be.$to_a())}function Ie(be,ae,ue){for(var Ce,y=null,W=new Array(be.length),pe=0,we=0,De=be.length;pe<De;pe++){if(!y)try{Ce=H(ue,be[pe])}catch(Fe){y=Fe}(y||ae(Ce))&&(W[we]=be[pe],we+=1)}if(we!==pe&&(be.splice.apply(be,[0,W.length].concat(W)),be.splice(we,W.length)),y)throw y}function ce(be,ae){var Ce,y,W,ue=be.length;return Ce=ae.excl,y=ae.begin===c?0:O(ae.begin,E.Integer,"to_int"),W=ae.end===c?-1:O(ae.end,E.Integer,"to_int"),y<0&&(y+=ue)<0||(ae.excl_rev&&ae.begin!==c&&(y+=1),y>ue)?c:W<0&&(W+=ue)<0?[]:((!Ce||ae.end===c)&&(W+=1),be.slice(y,W))}function ye(be,ae){return be===ae||0===ae?1:ae>0&&be>ae?ye(be-1,ae-1)+ye(be-1,ae):0}C.$include(f("Enumerable")),E.prop(C.$$prototype,"$$is_array",!0),N(C,"$[]",function(ae){var y=this;return Ee(U(arguments),y)},-1),T(C,"$initialize",function be(ae,ue){var W,pe,Ce=be.$$p||c,y=this;if(be.$$p=null,null==ae&&(ae=c),null==ue&&(ue=c),K(y),ue!==c&&Ce!==c&&Y.$warn("warning: block supersedes default value argument"),ae>f(f("Integer"),"MAX")&&Y.$raise(f("ArgumentError"),"array size too big"),arguments.length>2&&Y.$raise(f("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..2)"),0===arguments.length)return y.splice(0,y.length),y;if(1===arguments.length){if(ae.$$is_array)return y.$replace(ae.$to_a()),y;if(ae["$respond_to?"]("to_ary"))return y.$replace(ae.$to_ary()),y}if((ae=O(ae,f("Integer"),"to_int"))<0&&Y.$raise(f("ArgumentError"),"negative array size"),y.splice(0,y.length),Ce===c)for(W=0;W<ae;W++)y.push(ue);else for(W=0;W<ae;W++)pe=Ce(W),y[W]=pe;return y},-1),N(C,"$try_convert",function(ae){return j["$coerce_to?"](ae,f("Array"),"to_ary")}),T(C,"$&",function(ae){ae=re(f("Array"),ae)?ae.$to_a():O(ae,f("Array"),"to_ary").$to_a();var W,pe,we,Ce=[],y=z([],{});for(W=0,pe=ae.length;W<pe;W++)_(y,ae[W],!0);for(W=0,pe=this.length;W<pe;W++)void 0!==w(y,we=this[W])&&Ce.push(we);return Ce}),T(C,"$|",function(ae){ae=re(f("Array"),ae)?ae.$to_a():O(ae,f("Array"),"to_ary").$to_a();var y,W,Ce=z([],{});for(y=0,W=this.length;y<W;y++)_(Ce,this[y],!0);for(y=0,W=ae.length;y<W;y++)_(Ce,ae[y],!0);return Ce.$keys()}),T(C,"$*",function(ae){if(le(ae["$respond_to?"]("to_str")))return this.$join(ae.$to_str());ae=O(ae,f("Integer"),"to_int"),le(ae<0)&&Y.$raise(f("ArgumentError"),"negative argument");for(var Ce=[],y=this.$to_a(),W=0;W<ae;W++)Ce=Ce.concat(y);return Ce}),T(C,"$+",function(ae){return ae=re(f("Array"),ae)?ae.$to_a():O(ae,f("Array"),"to_ary").$to_a(),this.concat(ae)}),T(C,"$-",function(ae){if(ae=re(f("Array"),ae)?ae.$to_a():O(ae,f("Array"),"to_ary").$to_a(),le(0===this.length))return[];if(le(0===ae.length))return this.slice();var W,pe,we,Ce=[],y=z([],{});for(W=0,pe=ae.length;W<pe;W++)_(y,ae[W],!0);for(W=0,pe=this.length;W<pe;W++)void 0===J(y,we=this[W])&&Ce.push(we);return Ce}),T(C,"$<<",function(ae){return K(this),this.push(ae),this}),T(C,"$<=>",function(ae){if(re(f("Array"),ae))ae=ae.$to_a();else{if(!le(ae["$respond_to?"]("to_ary")))return c;ae=ae.$to_ary().$to_a()}if(this.$hash()===ae.$hash())return 0;for(var Ce=Math.min(this.length,ae.length),y=0;y<Ce;y++){var W=this[y]["$<=>"](ae[y]);if(0!==W)return W}return this.length["$<=>"](ae.length)}),T(C,"$==",function(ae){var Ce={};return function y(W,pe){var we,De,Fe,Ye;if(W===pe)return!0;if(!pe.$$is_array)return!!x(pe,"$to_ary")&&pe["$=="](W);if(W.$$constructor!==Array&&(W=W.$to_a()),pe.$$constructor!==Array&&(pe=pe.$to_a()),W.length!==pe.length)return!1;for(Ce[W.$object_id()]=!0,we=0,De=W.length;we<De;we++)if(Ye=pe[we],(Fe=W[we]).$$is_array){if(Ye.$$is_array&&Ye.length!==Fe.length||!Ce.hasOwnProperty(Fe.$object_id())&&!y(Fe,Ye))return!1}else if(!Fe["$=="](Ye))return!1;return!0}(this,ae)}),T(C,"$[]",function(ae,ue){return ae.$$is_range?ce(this,ae):ae.$$is_arithmetic_seq?function Me(be,ae){var ue,Ce=[],y=0;for(ue=ae.step<0?ce(be,{begin:ae.range.end,end:ae.range.begin,excl:!1,excl_rev:ae.range.excl}).$reverse():ce(be,ae.range);y<ue.length;)Ce.push(ue[y]),y+=Math.abs(ae.step);return Ce}(this,ae):function $e(be,ae,ue){var Ce=be.length;return(ae=O(ae,E.Integer,"to_int"))<0&&(ae+=Ce)<0?c:void 0===ue?ae>=Ce||ae<0?c:be[ae]:(ue=O(ue,E.Integer,"to_int"))<0||ae>Ce||ae<0?c:be.slice(ae,ae+ue)}(this,ae,ue)},-2),T(C,"$[]=",function(ae,ue,Ce){var y=this,W=c,pe=c;K(y),W=c;var we,It,De=y.length;if(ae.$$is_range){W=ue.$$is_array?ue.$to_a():ue["$respond_to?"]("to_ary")?ue.$to_ary().$to_a():[ue];var Fe=ae.excl,Ye=ae.begin===c?0:O(ae.begin,E.Integer,"to_int"),at=ae.end===c?-1:O(ae.end,E.Integer,"to_int");if(Ye<0&&(Ye+=De)<0&&Y.$raise(f("RangeError"),ae.$inspect()+" out of range"),at<0&&(at+=De),(!Fe||ae.end===c)&&(at+=1),Ye>De)for(we=De;we<Ye;we++)y[we]=c;return y.splice.apply(y,at<0?[Ye,0].concat(W):[Ye,at-Ye].concat(W)),ue}if(void 0===Ce?pe=1:(pe=ue,W=(ue=Ce).$$is_array?ue.$to_a():ue["$respond_to?"]("to_ary")?ue.$to_ary().$to_a():[ue]),ae=O(ae,f("Integer"),"to_int"),pe=O(pe,f("Integer"),"to_int"),ae<0&&(It=ae,(ae+=De)<0&&Y.$raise(f("IndexError"),"index "+It+" too small for array; minimum "+-y.length)),pe<0&&Y.$raise(f("IndexError"),"negative length ("+pe+")"),ae>De)for(we=De;we<ae;we++)y[we]=c;return void 0===Ce?y[ae]=ue:y.splice.apply(y,[ae,pe].concat(W)),ue},-3),T(C,"$any?",function be(ae){var ue=be.$$p||c;return be.$$p=null,0!==this.length&&q(this,Z(this,"any?",be,!1,!0),"any?",[ae],ue)},-1),T(C,"$assoc",function(ae){for(var W,Ce=0,y=this.length;Ce<y;Ce++)if((W=this[Ce]).length&&W[0]["$=="](ae))return W;return c}),T(C,"$at",function(ae){return(ae=O(ae,f("Integer"),"to_int"))<0&&(ae+=this.length),ae<0||ae>=this.length?c:this[ae]}),T(C,"$bsearch_index",function be(){var ae=be.$$p||c;if(be.$$p=null,ae===c)return this.$enum_for("bsearch_index");for(var W,we,Ce=0,y=this.length,De=!1,Fe=c;Ce<y;){if(W=Ce+Math.floor((y-Ce)/2),!0===(we=H(ae,this[W])))Fe=W,De=!0;else if(!1===we||we===c)De=!1;else if(we.$$is_number){if(0===we)return W;De=we<0}else Y.$raise(f("TypeError"),"wrong argument type "+we.$class()+" (must be numeric, true, false or nil)");De?y=W:Ce=W+1}return Fe}),T(C,"$bsearch",function be(){var ae=be.$$p||c,Ce=c;return be.$$p=null,ae===c?this.$enum_for("bsearch"):null!=(Ce=M(this,"bsearch_index",[],ae.$to_proc()))&&Ce.$$is_number?this[Ce]:Ce}),T(C,"$cycle",function be(ae){var y,W,ue=be.$$p||c,Ce=this;if(be.$$p=null,null==ae&&(ae=c),ue===c)return M(Ce,"enum_for",["cycle",ae],function we(){var De=we.$$s??this;return le(ae["$nil?"]())?f(f("Float"),"INFINITY"):(ae=j["$coerce_to!"](ae,f("Integer"),"to_int"),le(I(ae,0))?X(De.$enumerator_size(),ae):0)},{$$s:Ce});if(le(Ce["$empty?"]())||L(ae,0))return c;if(ae===c)for(;;)for(y=0,W=Ce.length;y<W;y++)H(ue,Ce[y]);else{if((ae=j["$coerce_to!"](ae,f("Integer"),"to_int"))<=0)return Ce;for(;ae>0;){for(y=0,W=Ce.length;y<W;y++)H(ue,Ce[y]);ae--}}return Ce},-1),T(C,"$clear",function(){return K(this),this.splice(0,this.length),this}),T(C,"$count",function be(ae){var ue=be.$$p||c;return be.$$p=null,le(void 0!==ae)||le(ue)?q(this,Z(this,"count",be,!1,!0),"count",[ae],ue):this.$size()},-1),T(C,"$initialize_copy",function(ae){return this.$replace(ae)}),T(C,"$collect",function be(){var ae=be.$$p||c;if(be.$$p=null,ae===c)return M(this,"enum_for",["collect"],function we(){return(we.$$s??this).$size()},{$$s:this});for(var Ce=[],y=0,W=this.length;y<W;y++){var pe=H(ae,this[y]);Ce.push(pe)}return Ce}),T(C,"$collect!",function be(){var ae=be.$$p||c,ue=this;if(be.$$p=null,ae===c)return M(ue,"enum_for",["collect!"],function pe(){return(pe.$$s??this).$size()},{$$s:ue});K(ue);for(var Ce=0,y=ue.length;Ce<y;Ce++){var W=H(ae,ue[Ce]);ue[Ce]=W}return ue}),T(C,"$combination",function be(ae){var y,W,pe,we,De,Fe,Ye,at,ue=be.$$p||c,Ce=this;if(be.$$p=null,y=j["$coerce_to!"](ae,f("Integer"),"to_int"),ue===c)return M(Ce,"enum_for",["combination",y],function It(){return ye((It.$$s??this).length,y)},{$$s:Ce});if(0===y)E.yield1(ue,[]);else if(1===y)for(W=0,pe=Ce.length;W<pe;W++)E.yield1(ue,[Ce[W]]);else if(y===Ce.length)E.yield1(ue,Ce.slice());else if(y>=0&&y<Ce.length){for(we=[],W=0;W<=y+1;W++)we.push(0);for(De=[],Fe=0,Ye=!1,we[0]=-1;!Ye;){for(De[Fe]=Ce[we[Fe+1]];Fe<y-1;)at=we[1+ ++Fe]=we[Fe]+1,De[Fe]=Ce[at];E.yield1(ue,De.slice()),Fe++;do{Ye=0===Fe,we[Fe]++,Fe--}while(we[Fe+1]+y===Ce.length+Fe+1)}}return Ce}),T(C,"$repeated_combination",function be(ae){var y,ue=be.$$p||c;return be.$$p=null,y=j["$coerce_to!"](ae,f("Integer"),"to_int"),ue===c?M(this,"enum_for",["repeated_combination",y],function pe(){return ye((pe.$$s??this).length+y-1,y)},{$$s:this}):(y>=0&&function W(pe,we,De,Fe){if(De.length!=pe)for(var at=we;at<Fe.length;at++)De.push(Fe[at]),W(pe,at,De,Fe),De.pop();else{var Ye=De.slice();E.yield1(ue,Ye)}}(y,0,[],this),this)}),T(C,"$compact",function(){for(var W,ue=[],Ce=0,y=this.length;Ce<y;Ce++)(W=this[Ce])!==c&&ue.push(W);return ue}),T(C,"$compact!",function(){var ae=this;K(ae);for(var ue=ae.length,Ce=0,y=ae.length;Ce<y;Ce++)ae[Ce]===c&&(ae.splice(Ce,1),y--,Ce--);return ae.length===ue?c:ae}),T(C,"$concat",function(ae){var Ce,y=this;return Ce=U(arguments),K(y),Ce=M(Ce,"map",[],function W(pe){var we=W.$$s??this;return null==pe&&(pe=c),pe=re(f("Array"),pe)?pe.$to_a():O(pe,f("Array"),"to_ary").$to_a(),le(pe["$equal?"](we))&&(pe=pe.$dup()),pe},{$$s:y}),M(Ce,"each",[],function W(pe){var we=W.$$s??this;null==pe&&(pe=c);for(var De=0,Fe=pe.length;De<Fe;De++)we.push(pe[De])},{$$s:y}),y},-1),T(C,"$delete",function be(ae){var ue=be.$$p||c,Ce=this;be.$$p=null;for(var y=Ce.length,W=0,pe=y;W<pe;W++)Ce[W]["$=="](ae)&&(K(Ce),Ce.splice(W,1),pe--,W--);return Ce.length===y?ue!==c?E.yieldX(ue,[]):c:ae}),T(C,"$delete_at",function(ae){var ue=this;if(K(ue),(ae=O(ae,f("Integer"),"to_int"))<0&&(ae+=ue.length),ae<0||ae>=ue.length)return c;var Ce=ue[ae];return ue.splice(ae,1),Ce}),T(C,"$delete_if",function be(){var ae=be.$$p||c,ue=this;return be.$$p=null,ae===c?M(ue,"enum_for",["delete_if"],function Ce(){return(Ce.$$s??this).$size()},{$$s:ue}):(K(ue),Ie(ue,_e,ae),ue)}),T(C,"$difference",function(ae){var ue,y=this;return ue=U(arguments),M(ue,"reduce",[y.$to_a().$dup()],function(pe,we){return null==pe&&(pe=c),null==we&&(we=c),S(pe,we)})},-1),T(C,"$dig",function(ae,ue){var y,W=this,pe=c;return y=U(arguments,1),(pe=W["$[]"](ae))===c||0===y.length?pe:(le(pe["$respond_to?"]("dig"))||Y.$raise(f("TypeError"),pe.$class()+" does not have #dig method"),M(pe,"dig",k(y)))},-2),T(C,"$drop",function(ae){return(ae=O(ae,f("Integer"),"to_int"))<0&&Y.$raise(f("ArgumentError")),this.slice(ae)}),T(C,"$dup",function be(){var ae=be.$$p||c,ue=this;return be.$$p=null,ue.$$class===E.Array&&ue.$$class.$allocate.$$pristine&&ue.$copy_instance_variables.$$pristine&&ue.$initialize_dup.$$pristine?ue.slice(0):q(ue,Z(ue,"dup",be,!1,!0),"dup",[],ae)}),T(C,"$each",function be(){var ae=be.$$p||c,ue=this;if(be.$$p=null,ae===c)return M(ue,"enum_for",["each"],function pe(){return(pe.$$s??this).$size()},{$$s:ue});for(var Ce=0,y=ue.length;Ce<y;Ce++)H(ae,ue[Ce]);return ue}),T(C,"$each_index",function be(){var ae=be.$$p||c;if(be.$$p=null,ae===c)return M(this,"enum_for",["each_index"],function pe(){return(pe.$$s??this).$size()},{$$s:this});for(var Ce=0,y=this.length;Ce<y;Ce++)H(ae,Ce);return this}),T(C,"$empty?",function(){return 0===this.length}),T(C,"$eql?",function(ae){var Ce={};return function y(W,pe){var we,De,Fe,Ye;if(!pe.$$is_array||(pe=pe.$to_a(),W.length!==pe.length))return!1;for(Ce[W.$object_id()]=!0,we=0,De=W.length;we<De;we++)if(Ye=pe[we],(Fe=W[we]).$$is_array){if(Ye.$$is_array&&Ye.length!==Fe.length||!Ce.hasOwnProperty(Fe.$object_id())&&!y(Fe,Ye))return!1}else if(!Fe["$eql?"](Ye))return!1;return!0}(this,ae)}),T(C,"$fetch",function be(ae,ue){var Ce=be.$$p||c,y=this;be.$$p=null;var W=ae;return(ae=O(ae,f("Integer"),"to_int"))<0&&(ae+=y.length),ae>=0&&ae<y.length?y[ae]:(Ce!==c&&null!=ue&&y.$warn("warning: block supersedes default value argument"),Ce!==c?Ce(W):null!=ue?ue:void Y.$raise(f("IndexError"),0===y.length?"index "+W+" outside of array bounds: 0...0":"index "+W+" outside of array bounds: -"+y.length+"..."+y.length))},-2),T(C,"$fill",function be(ae){var y,W,At,Jt,ue=be.$$p||c,we=this,De=c,Fe=c,Ye=c,at=c,It=c;if(be.$$p=null,y=U(arguments),K(we),le(ue)?(le(y.length>2)&&Y.$raise(f("ArgumentError"),"wrong number of arguments ("+y.$length()+" for 0..2)"),De=(W=v(y))[0]??c,Fe=W[1]??c):(le(0==y.length)?Y.$raise(f("ArgumentError"),"wrong number of arguments (0 for 1..3)"):le(y.length>3)&&Y.$raise(f("ArgumentError"),"wrong number of arguments ("+y.$length()+" for 1..3)"),Ye=(W=v(y))[0]??c,De=W[1]??c,Fe=W[2]??c),re(f("Range"),De)){if(le(Fe)&&Y.$raise(f("TypeError"),"length invalid with range"),at=De.begin===c?0:O(De.begin,f("Integer"),"to_int"),le(at<0)&&(at+=this.length),le(at<0)&&Y.$raise(f("RangeError"),De.$inspect()+" out of range"),It=De.end===c?-1:O(De.end,f("Integer"),"to_int"),le(It<0)&&(It+=this.length),le(De["$exclude_end?"]())||(It+=1),le(It<=at))return we}else if(le(De))if(at=O(De,f("Integer"),"to_int"),le(at<0)&&(at+=this.length),le(at<0)&&(at=0),le(Fe)){if(It=O(Fe,f("Integer"),"to_int"),le(0==It))return we;It+=at}else It=this.length;else at=0,It=this.length;if(le(at>this.length))for(At=this.length;At<It;At++)we[At]=c;if(le(It>this.length)&&(this.length=It),le(ue))for(;at<It;at++)Jt=ue(at),we[at]=Jt;else for(;at<It;at++)we[at]=Ye;return we},-1),T(C,"$first",function(ae){return null==ae?0===this.length?c:this[0]:((ae=O(ae,f("Integer"),"to_int"))<0&&Y.$raise(f("ArgumentError"),"negative array size"),this.slice(0,ae))},-1),T(C,"$flatten",function(ae){var ue=this;return void 0!==ae&&(ae=O(ae,f("Integer"),"to_int")),function Ce(y,W){var we,De,Fe,Ye,pe=[];for(we=0,De=(y=y.$to_a()).length;we<De;we++)if(x(Fe=y[we],"$to_ary",!0))if((Ye=Fe.$to_ary())!==c)switch(Ye.$$is_array||Y.$raise(f("TypeError")),Ye===ue&&Y.$raise(f("ArgumentError")),W){case void 0:pe=pe.concat(Ce(Ye));break;case 0:pe.push(Ye);break;default:pe.push.apply(pe,Ce(Ye,W-1))}else pe.push(Fe);else pe.push(Fe);return pe}(ue,ae)},-1),T(C,"$flatten!",function(ae){var ue=this;K(ue);var Ce=ue.$flatten(ae);if(ue.length==Ce.length){for(var y=0,W=ue.length;y<W&&ue[y]===Ce[y];y++);if(y==W)return c}return ue.$replace(Ce),ue},-1),T(C,"$freeze",function(){return le(this["$frozen?"]())?this:V(this)}),T(C,"$hash",function(){var pe,we,ae=this,ue=void 0===d,Ce=["A"],y=ae.$object_id();try{if(ue&&(d=Object.create(null)),d[y])return"self";for(we in d)if(ae["$eql?"](d[we]))return"self";for(d[y]=ae,pe=0;pe<ae.length;pe++)Ce.push(ae[pe].$hash());return Ce.join(",")}finally{ue&&(d=void 0)}}),T(C,"$include?",function(ae){for(var Ce=0,y=this.length;Ce<y;Ce++)if(this[Ce]["$=="](ae))return!0;return!1}),T(C,"$index",function be(ae){var y,W,pe,ue=be.$$p||c,Ce=this;if(be.$$p=null,null!=ae&&ue!==c&&Ce.$warn("warning: given block not used"),null!=ae){for(y=0,W=Ce.length;y<W;y++)if(Ce[y]["$=="](ae))return y}else{if(ue===c)return Ce.$enum_for("index");for(y=0,W=Ce.length;y<W;y++)if(!1!==(pe=ue(Ce[y]))&&pe!==c)return y}return c},-1),T(C,"$insert",function(ae,ue){var y,W=this;if(y=U(arguments,1),K(W),ae=O(ae,f("Integer"),"to_int"),y.length>0){if(ae<0&&(ae+=W.length+1)<0&&Y.$raise(f("IndexError"),ae+" is out of bounds"),ae>W.length)for(var pe=W.length;pe<ae;pe++)W.push(c);W.splice.apply(W,[ae,0].concat(y))}return W},-2);var ue,he=[];return T(C,"$inspect",function(){var ae=this,ue=[],Ce=ae.$__id__(),y=!0;return function(){try{if(-1!==he.indexOf(Ce))return y=!1,"[...]";he.push(Ce);for(var W=0,pe=ae.length;W<pe;W++){var we=ae["$[]"](W);ue.push(ie("Opal").$inspect(we))}return"["+ue.join(", ")+"]"}finally{y&&he.pop()}}()}),T(C,"$intersection",function(ae){var ue,y=this;return ue=U(arguments),M(ue,"reduce",[y.$to_a().$dup()],function(pe,we){return null==pe&&(pe=c),null==we&&(we=c),pe["$&"](we)})},-1),T(C,"$intersect?",function(ae){return this.$intersection(ae)["$empty?"]()["$!"]()}),T(C,"$join",function(ae){var ue=this;if(null==P[","]&&(P[","]=c),null==ae&&(ae=c),le(0===ue.length))return"";le(ae===c)&&(ae=P[","]);var y,W,pe,we,Ce=[];for(y=0,W=ue.length;y<W;y++)x(pe=ue[y],"$to_str")&&(we=pe.$to_str())!==c?Ce.push(we.$to_s()):x(pe,"$to_ary")&&((we=pe.$to_ary())===ue&&Y.$raise(f("ArgumentError")),we!==c)?Ce.push(we.$join(ae)):x(pe,"$to_s")&&(we=pe.$to_s())!==c?Ce.push(we):Y.$raise(f("NoMethodError").$new(ie("Opal").$inspect(ue.$item())+" doesn't respond to #to_str, #to_ary or #to_s","to_str"));return Ce.join(ae===c?"":j["$coerce_to!"](ae,f("String"),"to_str").$to_s())},-1),T(C,"$keep_if",function be(){var ae=be.$$p||c,ue=this;return be.$$p=null,ae===c?M(ue,"enum_for",["keep_if"],function Ce(){return(Ce.$$s??this).$size()},{$$s:ue}):(K(ue),Ie(ue,le,ae),ue)}),T(C,"$last",function(ae){var ue=this;return null==ae?0===ue.length?c:ue[ue.length-1]:((ae=O(ae,f("Integer"),"to_int"))<0&&Y.$raise(f("ArgumentError"),"negative array size"),ae>ue.length&&(ae=ue.length),ue.slice(ue.length-ae,ue.length))},-1),T(C,"$length",function(){return this.length}),T(C,"$max",function be(ae){var ue=be.$$p||c;return be.$$p=null,M(this.$each(),"max",[ae],ue.$to_proc())},-1),T(C,"$min",function be(){var ae=be.$$p||c;return be.$$p=null,M(this.$each(),"min",[],ae.$to_proc())}),T(C,"$permutation",function be(ae){var pe,we,De,ue=be.$$p||c,Ce=this,y=c,W=c;if(be.$$p=null,ue===c)return M(Ce,"enum_for",["permutation",ae],function Ye(){var at=Ye.$$s??this;return function Se(be,ae){for(var ue=ae>=0?1:0;ae;)ue*=be,be--,ae--;return ue}(at.length,void 0===ae?at.length:ae)},{$$s:Ce});if(!((ae=void 0===ae?Ce.length:O(ae,f("Integer"),"to_int"))<0||Ce.length<ae))if(0===ae)E.yield1(ue,[]);else if(1===ae)for(var Fe=0;Fe<Ce.length;Fe++)E.yield1(ue,[Ce[Fe]]);else y=ie("Array").$new(ae),W=ie("Array").$new(Ce.length,!1),pe=function(Ye,at,It,At,ln){Ce=this;for(var Jt=0;Jt<Ce.length;Jt++)if(At["$[]"](Jt)["$!"]())if(at[It]=Jt,It<Ye-1)At[Jt]=!0,pe.call(Ce,Ye,at,It+1,At,ln),At[Jt]=!1;else{De=[];for(var Dn=0;Dn<at.length;Dn++)De.push(Ce[at[Dn]]);H(ln,De)}},ue!==c?(we=Ce.slice(),pe.call(we,ae,y,0,W,ue)):pe.call(Ce,ae,y,0,W,ue);return Ce},-1),T(C,"$repeated_permutation",function be(ae){var y,ue=be.$$p||c;return be.$$p=null,y=j["$coerce_to!"](ae,f("Integer"),"to_int"),ue===c?M(this,"enum_for",["repeated_permutation",y],function pe(){var we=pe.$$s??this;return le(B(y,0))?we.$size()["$**"](y):0},{$$s:this}):(function W(pe,we,De){if(we.length!=pe)for(var Ye=0;Ye<De.length;Ye++)we.push(De[Ye]),W(pe,we,De),we.pop();else{var Fe=we.slice();E.yield1(ue,Fe)}}(y,[],this.slice()),this)}),T(C,"$pop",function(ae){var ue=this;return K(ue),le(void 0===ae)?le(0===ue.length)?c:ue.pop():(ae=O(ae,f("Integer"),"to_int"),le(ae<0)&&Y.$raise(f("ArgumentError"),"negative array size"),le(0===ue.length)?[]:le(1===ae)?[ue.pop()]:le(ae>ue.length)?ue.splice(0,ue.length):ue.splice(ue.length-ae,ue.length))},-1),T(C,"$product",function be(ae){var Ce,y,ue=be.$$p||c,W=this;be.$$p=null,Ce=U(arguments);var at,It,At,ln,pe=ue!==c?null:[],we=(y=Ce).length+1,De=new Array(we),Fe=new Array(we),Ye=new Array(we),Jt=1;for(Ye[0]=W,at=1;at<we;at++)Ye[at]=O(y[at-1],f("Array"),"to_ary");for(at=0;at<we;at++){if(0===(ln=Ye[at].length))return pe||W;(Jt*=ln)>2147483647&&Y.$raise(f("RangeError"),"too big to product"),Fe[at]=ln,De[at]=0}e:for(;;){for(At=[],at=0;at<we;at++)At.push(Ye[at][De[at]]);for(pe?pe.push(At):E.yield1(ue,At),De[It=we-1]++;De[It]===Fe[It];){if(De[It]=0,--It<0)break e;De[It]++}}return pe||W},-1),T(C,"$push",function(ae){var Ce,y=this;Ce=U(arguments),K(y);for(var W=0,pe=Ce.length;W<pe;W++)y.push(Ce[W]);return y},-1),T(C,"$rassoc",function(ae){for(var W,Ce=0,y=this.length;Ce<y;Ce++)if((W=this[Ce]).length&&void 0!==W[1]&&W[1]["$=="](ae))return W;return c}),T(C,"$reject",function be(){var ae=be.$$p||c,ue=this;if(be.$$p=null,ae===c)return M(ue,"enum_for",["reject"],function we(){return(we.$$s??this).$size()},{$$s:ue});for(var pe,Ce=[],y=0,W=ue.length;y<W;y++)(!1===(pe=ae(ue[y]))||pe===c)&&Ce.push(ue[y]);return Ce}),T(C,"$reject!",function be(){var ae=be.$$p||c,ue=this,Ce=c;return be.$$p=null,ae===c?M(ue,"enum_for",["reject!"],function y(){return(y.$$s??this).$size()},{$$s:ue}):(K(ue),Ce=ue.$length(),M(ue,"delete_if",[],ae.$to_proc()),L(ue.$length(),Ce)?c:ue)}),T(C,"$replace",function(ae){var ue=this;return K(ue),ae=re(f("Array"),ae)?ae.$to_a():O(ae,f("Array"),"to_ary").$to_a(),ue.splice(0,ue.length),ue.push.apply(ue,ae),ue}),T(C,"$reverse",function(){return this.slice(0).reverse()}),T(C,"$reverse!",function(){return K(this),this.reverse()}),T(C,"$reverse_each",function be(){var ae=be.$$p||c;return be.$$p=null,ae===c?M(this,"enum_for",["reverse_each"],function Ce(){return(Ce.$$s??this).$size()},{$$s:this}):(M(this.$reverse(),"each",[],ae.$to_proc()),this)}),T(C,"$rindex",function be(ae){var y,W,ue=be.$$p||c,Ce=this;if(be.$$p=null,null!=ae&&ue!==c&&Ce.$warn("warning: given block not used"),null!=ae){for(y=Ce.length-1;y>=0&&!(y>=Ce.length);y--)if(Ce[y]["$=="](ae))return y}else if(ue!==c){for(y=Ce.length-1;y>=0&&!(y>=Ce.length);y--)if(!1!==(W=ue(Ce[y]))&&W!==c)return y}else if(null==ae)return Ce.$enum_for("rindex");return c},-1),T(C,"$rotate",function(ae){var Ce,y,W,pe;return null==ae&&(ae=1),ae=O(ae,f("Integer"),"to_int"),1===this.length?this.slice():0===this.length?[]:(W=(Ce=this.slice()).slice(y=ae%Ce.length),pe=Ce.slice(0,y),W.concat(pe))},-1),T(C,"$rotate!",function(ae){var ue=this,Ce=c;return null==ae&&(ae=1),K(ue),0===ue.length||1===ue.length?ue:(ae=O(ae,f("Integer"),"to_int"),Ce=ue.$rotate(ae),ue.$replace(Ce))},-1),(ue=A(C,null,"SampleRandom")).$$prototype.rng=c,T(ue,"$initialize",te("rng")),T(ue,"$rand",function(W){var we;return we=O(this.rng.$rand(W),f("Integer"),"to_int"),le(we<0)&&Y.$raise(f("RangeError"),"random value must be >= 0"),le(we<W)||Y.$raise(f("RangeError"),"random value must be less than Array size"),we}),T(C,"$sample",function(ae,ue){var pe,we,De,Fe,Ye,at,It,At,Ce=this,y=c,W=c;if(le(void 0===ae))return Ce.$at(Y.$rand(Ce.length));if(le(void 0===ue)?le(y=j["$coerce_to?"](ae,f("Hash"),"to_hash"))?(ue=y,ae=c):(ue=c,ae=O(ae,f("Integer"),"to_int")):(ae=O(ae,f("Integer"),"to_int"),ue=O(ue,f("Hash"),"to_hash")),le(ae)&&le(ae<0)&&Y.$raise(f("ArgumentError"),"count must be greater than 0"),le(ue)&&(W=ue["$[]"]("random")),W=le(W)&&le(W["$respond_to?"]("rand"))?ie("SampleRandom").$new(W):Y,!le(ae))return Ce[W.$rand(Ce.length)];switch(ae>Ce.length&&(ae=Ce.length),ae){case 0:return[];case 1:return[Ce[W.$rand(Ce.length)]];case 2:return(Fe=W.$rand(Ce.length))===(Ye=W.$rand(Ce.length))&&(Ye=0===Fe?Fe+1:Fe-1),[Ce[Fe],Ce[Ye]];default:if(Ce.length/ae>3){for(pe=!1,we=0,Fe=1,(De=ie("Array").$new(ae))[0]=W.$rand(Ce.length);Fe<ae;){for(at=W.$rand(Ce.length),Ye=0;Ye<Fe;){for(;at===De[Ye];){if(++we>100){pe=!0;break}at=W.$rand(Ce.length)}if(pe)break;Ye++}if(pe)break;De[Fe]=at,Fe++}if(!pe){for(Fe=0;Fe<ae;)De[Fe]=Ce[De[Fe]],Fe++;return De}}De=Ce.slice();for(var ln=0;ln<ae;ln++)It=W.$rand(Ce.length),At=De[ln],De[ln]=De[It],De[It]=At;return ae===Ce.length?De:De["$[]"](0,ae)}},-1),T(C,"$select",function be(){var ae=be.$$p||c;if(be.$$p=null,ae===c)return M(this,"enum_for",["select"],function De(){return(De.$$s??this).$size()},{$$s:this});for(var pe,we,Ce=[],y=0,W=this.length;y<W;y++)we=H(ae,pe=this[y]),le(we)&&Ce.push(pe);return Ce}),T(C,"$select!",function be(){var ae=be.$$p||c,ue=this;if(be.$$p=null,ae===c)return M(ue,"enum_for",["select!"],function y(){return(y.$$s??this).$size()},{$$s:ue});K(ue);var Ce=ue.length;return M(ue,"keep_if",[],ae.$to_proc()),ue.length===Ce?c:ue}),T(C,"$shift",function(ae){var ue=this;return K(ue),le(void 0===ae)?le(0===ue.length)?c:function se(be){for(var ae=be[0],ue=1,Ce=be.length;ue<Ce;ue++)be[ue-1]=be[ue];return be.pop(),ae}(ue):(ae=O(ae,f("Integer"),"to_int"),le(ae<0)&&Y.$raise(f("ArgumentError"),"negative array size"),le(0===ue.length)?[]:ue.splice(0,ae))},-1),T(C,"$shuffle",function(ae){return this.$dup().$to_a()["$shuffle!"](ae)},-1),T(C,"$shuffle!",function(ae){var ue=this;K(ue);var Ce,W,pe,y=ue.length;for(void 0!==ae&&(ae=j["$coerce_to?"](ae,f("Hash"),"to_hash"))!==c&&(ae=ae["$[]"]("random"))!==c&&ae["$respond_to?"]("rand")&&(Ce=ae);y;)Ce?((W=Ce.$rand(y).$to_int())<0&&Y.$raise(f("RangeError"),"random number too small "+W),W>=y&&Y.$raise(f("RangeError"),"random number too big "+W)):W=ue.$rand(y),pe=ue[--y],ue[y]=ue[W],ue[W]=pe;return ue},-1),T(C,"$slice!",function(ae,ue){var Ce=this,y=c,W=c,pe=c,we=c,De=c;if(K(Ce),y=c,le(void 0===ue))if(re(f("Range"),ae)){y=Ce["$[]"](W=ae),pe=W.begin===c?0:O(W.begin,f("Integer"),"to_int"),we=W.end===c?-1:O(W.end,f("Integer"),"to_int"),pe<0&&(pe+=Ce.length),we<0?we+=Ce.length:we>=Ce.length&&(we=Ce.length-1,W.excl&&(we+=1));var Fe=we-pe;W.excl&&W.end!==c?we-=1:Fe+=1,pe<Ce.length&&pe>=0&&we<Ce.length&&we>=0&&Fe>0&&Ce.splice(pe,Fe)}else{if((De=O(ae,f("Integer"),"to_int"))<0&&(De+=Ce.length),De<0||De>=Ce.length)return c;y=Ce[De],0===De?Ce.shift():Ce.splice(De,1)}else{if(De=O(ae,f("Integer"),"to_int"),(ue=O(ue,f("Integer"),"to_int"))<0)return c;y=Ce["$[]"](De,ue),De<0&&(De+=Ce.length),De+ue>Ce.length&&(ue=Ce.length-De),De<Ce.length&&De>=0&&Ce.splice(De,ue)}return y},-2),T(C,"$sort",function be(){var ae=be.$$p||c;return be.$$p=null,le(this.length>1)?(ae===c&&(ae=function(Ce,y){return Ce["$<=>"](y)}),this.slice().sort(function(Ce,y){var W=ae(Ce,y);return W===c&&Y.$raise(f("ArgumentError"),"comparison of "+Ce.$inspect()+" with "+y.$inspect()+" failed"),I(W,0)?1:D(W,0)?-1:0})):this}),T(C,"$sort!",function be(){var Ce,ae=be.$$p||c,ue=this;be.$$p=null,K(ue),Ce=ae!==c?M(ue.slice(),"sort",[],ae.$to_proc()):ue.slice().$sort(),ue.length=0;for(var y=0,W=Ce.length;y<W;y++)ue.push(Ce[y]);return ue}),T(C,"$sort_by!",function be(){var ae=be.$$p||c,ue=this;return be.$$p=null,ae===c?M(ue,"enum_for",["sort_by!"],function Ce(){return(Ce.$$s??this).$size()},{$$s:ue}):(K(ue),ue.$replace(M(ue,"sort_by",[],ae.$to_proc())))}),T(C,"$take",function(ae){return ae<0&&Y.$raise(f("ArgumentError")),this.slice(0,ae)}),T(C,"$take_while",function be(){var ae=be.$$p||c;be.$$p=null;for(var pe,we,Ce=[],y=0,W=this.length;y<W;y++){if(!1===(we=ae(pe=this[y]))||we===c)return Ce;Ce.push(pe)}return Ce}),T(C,"$to_a",function(){return this.$$class===E.Array?this:E.Array.$new(this)}),T(C,"$to_ary",fe),T(C,"$to_h",function be(){var ae=be.$$p||c,Ce=c;be.$$p=null,Ce=this,ae!==c&&(Ce=M(Ce,"map",[],ae.$to_proc()));var y,pe,W=Ce.length,Fe=z([],{});for(y=0;y<W;y++)(pe=j["$coerce_to?"](Ce[y],f("Array"),"to_ary")).$$is_array||Y.$raise(f("TypeError"),"wrong element type "+pe.$class()+" at "+y+" (expected array)"),2!==pe.length&&Y.$raise(f("ArgumentError"),"wrong array length at "+y+" (expected 2, was "+pe.$length()+")"),_(Fe,pe[0],pe[1]);return Fe}),T(C,"$transpose",function(){var ue=c,Ce=c;return le(this["$empty?"]())?[]:(ue=[],Ce=c,M(this,"each",[],function(W){var pe=c;return null==W&&(W=c),W=re(f("Array"),W)?W.$to_a():O(W,f("Array"),"to_ary").$to_a(),Ce=le(pe=Ce)?pe:W.length,R(W.length,Ce)&&Y.$raise(f("IndexError"),"element size differs ("+W.length+" should be "+Ce+")"),M(W.length,"times",[],function(De){var Fe;return null==De&&(De=c),(le(pe=ue["$[]"](De))?pe:(M(ue,"[]=",Fe=[De,[]]),Fe[Fe.length-1]))["$<<"](W.$at(De))})}),ue)}),T(C,"$union",function(ae){var ue,y=this;return ue=U(arguments),M(ue,"reduce",[y.$uniq()],function(pe,we){return null==pe&&(pe=c),null==we&&(we=c),pe["$|"](we)})},-1),T(C,"$uniq",function be(){var ae=be.$$p||c;be.$$p=null;var y,W,pe,we,Ce=z([],{});if(ae===c)for(y=0,W=this.length;y<W;y++)void 0===J(Ce,pe=this[y])&&_(Ce,pe,pe);else for(y=0,W=this.length;y<W;y++)we=H(ae,pe=this[y]),void 0===J(Ce,we)&&_(Ce,we,pe);return Ce.$values()}),T(C,"$uniq!",function be(){var ae=be.$$p||c,ue=this;be.$$p=null,K(ue);var W,pe,we,De,Ce=ue.length,y=z([],{});for(W=0,pe=Ce;W<pe;W++)we=ue[W],De=ae===c?we:H(ae,we),void 0!==J(y,De)?(ue.splice(W,1),pe--,W--):_(y,De,we);return ue.length===Ce?c:ue}),T(C,"$unshift",function(ae){var Ce,y=this;Ce=U(arguments),K(y);var W=y.length,pe=Ce.length;if(0==pe)return y;for(var we=W-pe,De=0;De<pe;De++)y.push(y[we+De]);for(var Fe=W-1;Fe-pe>=0;)y[Fe]=y[Fe-pe],Fe--;for(var Ye=0;Ye<pe;Ye++)y[Ye]=Ce[Ye];return y},-1),T(C,"$values_at",function(ae){var ue,y=this,W=c;return ue=U(arguments),W=[],M(ue,"each",[],function pe(we){var De=pe.$$s??this,Fe=c,Ye=c,at=c;return null==we&&(we=c),le(we["$is_a?"](f("Range")))?(Fe=we.$end()===c?-1:O(we.$end(),f("Integer"),"to_int"),(Ye=we.$begin()===c?0:O(we.$begin(),f("Integer"),"to_int"))<0?(Ye+=De.length,c):(Fe<0&&(Fe+=De.length),we["$exclude_end?"]()&&we.$end()!==c&&Fe--,Fe<Ye?c:M(Ye,"upto",[Fe],function It(At){return null==At&&(At=c),W["$<<"]((It.$$s??this).$at(At))},{$$s:De}))):(at=O(we,f("Integer"),"to_int"),W["$<<"](De.$at(at)))},{$$s:y}),W},-1),T(C,"$zip",function be(ae){var Ce,y,ue=be.$$p||c,W=this,pe=c;be.$$p=null,Ce=U(arguments);var Fe,Ye,at,It,At,we=[],De=W.length;for(It=0,At=(y=Ce).length;It<At;It++)if(!(Ye=y[It]).$$is_array){if(Ye.$$is_range||Ye.$$is_enumerator){y[It]=Ye.$take(De);continue}y[It]=(le(pe=j["$coerce_to?"](Ye,f("Array"),"to_ary"))?pe:j["$coerce_to!"](Ye,f("Enumerator"),"to_enum","each")).$to_a()}for(at=0;at<De;at++){for(Fe=[W[at]],It=0,At=y.length;It<At;It++)null==(Ye=y[It][at])&&(Ye=c),Fe[It+1]=Ye;we[at]=Fe}if(ue!==c){for(at=0;at<De;at++)E.yield1(ue,we[at]);return c}return we},-1),N(C,"$inherited",function(ae){ae.$$prototype.$to_a=function(){return this.slice(0,this.length)}}),T(C,"$instance_variables",function be(){var ae=be.$$p||c;return be.$$p=null,M(q(this,Z(this,"instance_variables",be,!1,!0),"instance_variables",[],ae),"reject",[],function(y){var W;return null==y&&(y=c),le(W=/^@\d+$/.test(y))?W:y["$=="]("@length")})}),T(C,"$pack",function(ae){return U(arguments),Y.$raise("To use Array#pack, you must first require 'corelib/array/pack'.")},-1),F(C,"append","push"),F(C,"filter","select"),F(C,"filter!","select!"),F(C,"map","collect"),F(C,"map!","collect!"),F(C,"prepend","unshift"),F(C,"size","length"),F(C,"slice","[]"),F(C,"to_s","inspect"),j.$pristine(C.$singleton_class(),"allocate"),j.$pristine(C,"copy_instance_variables","initialize_dup")}()},Opal.modules["corelib/hash"]=function(E){var P,fe,B,te,D,le=E.yield1,_e=E.hash,d=E.hash_init,H=E.hash_get,J=E.hash_put,_=E.hash_delete,w=E.deny_frozen_access,O=E.freeze,x=E.klass,K=E.slice,V=E.Opal,A=E.Kernel,U=E.defs,N=E.def,Y=E.send,T=E.rb_ge,j=E.rb_gt,re=E.hash2,z=E.truthy,q=E.to_a,Z=E.return_self,M=E.alias,L=E.nil,S=E.$$$;return E.top.$require("corelib/enumerable"),P=[],te=[B=x("::",null,"Hash")].concat(P),D=E.$r(te),B.$include(S("Enumerable")),B.$$prototype.$$is_hash=!0,U(B,"$[]",function(F){var l,f,p,c=this,u=(l=K(arguments)).length;if(1===u){if((f=V["$coerce_to?"](l["$[]"](0),S("Hash"),"to_hash"))!==L)return c.$allocate()["$merge!"](f);for((l=V["$coerce_to?"](l["$[]"](0),S("Array"),"to_ary"))===L&&A.$raise(S("ArgumentError"),"odd number of arguments for Hash"),u=l.length,f=c.$allocate(),p=0;p<u;p++)if(l[p].$$is_array)switch(l[p].length){case 1:f.$store(l[p][0],L);break;case 2:f.$store(l[p][0],l[p][1]);break;default:A.$raise(S("ArgumentError"),"invalid number of elements ("+l[p].length+" for 1..2)")}return f}for(u%2!=0&&A.$raise(S("ArgumentError"),"odd number of arguments for Hash"),f=c.$allocate(),p=0;p<u;p+=2)f.$store(l[p],l[p+1]);return f},-1),U(B,"$allocate",function(){var g=new this.$$constructor;return d(g),g.$$none=L,g.$$proc=L,g}),U(B,"$try_convert",function(F){return V["$coerce_to?"](F,S("Hash"),"to_hash")}),N(B,"$initialize",function R(F){var g=R.$$p||L,l=this;return R.$$p=null,w(l),void 0!==F&&g!==L&&A.$raise(S("ArgumentError"),"wrong number of arguments (1 for 0)"),l.$$none=void 0===F?L:F,l.$$proc=g,l},-1),N(B,"$==",function(F){var g=this;if(g===F)return!0;if(!F.$$is_hash||g.$$keys.length!==F.$$keys.length)return!1;for(var u,p,m,l=0,c=g.$$keys,f=c.length;l<f;l++)if((u=c[l]).$$is_string?(p=g.$$smap[u],m=F.$$smap[u]):(p=u.value,m=H(F,u.key)),void 0===m||!p["$eql?"](m))return!1;return!0}),N(B,"$>=",function(F){var l=L;return F=V["$coerce_to!"](F,S("Hash"),"to_hash"),!(this.$$keys.length<F.$$keys.length)&&(l=!0,Y(F,"each",[],function c(f,u){var m;null==f&&(f=L),null==u&&(u=L),null!=(m=(c.$$s??this).$fetch(f,null))&&m===u||(l=!1)},{$$s:this}),l)}),N(B,"$>",function(F){return F=V["$coerce_to!"](F,S("Hash"),"to_hash"),!(this.$$keys.length<=F.$$keys.length)&&T(this,F)}),N(B,"$<",function(F){return F=V["$coerce_to!"](F,S("Hash"),"to_hash"),j(F,this)}),N(B,"$<=",function(F){return F=V["$coerce_to!"](F,S("Hash"),"to_hash"),T(F,this)}),N(B,"$[]",function(F){var l=H(this,F);return void 0!==l?l:this.$default(F)}),N(B,"$[]=",function(F,g){return w(this),J(this,F,g),g}),N(B,"$assoc",function(F){for(var u,l=0,c=this.$$keys,f=c.length;l<f;l++)if((u=c[l]).$$is_string){if(u["$=="](F))return[u,this.$$smap[u]]}else if(u.key["$=="](F))return[u.key,u.value];return L}),N(B,"$clear",function(){var F=this;return w(F),d(F),F}),N(B,"$clone",function(){var g=new this.$$class;return d(g),E.hash_clone(this,g),g}),N(B,"$compact",function(){for(var u,p,g=_e(),l=0,c=this.$$keys,f=c.length;l<f;l++)(u=c[l]).$$is_string?p=this.$$smap[u]:(p=u.value,u=u.key),p!==L&&J(g,u,p);return g}),N(B,"$compact!",function(){var F=this;w(F);for(var u,p,g=!1,l=0,c=F.$$keys,f=c.length;l<f;l++)(u=c[l]).$$is_string?p=F.$$smap[u]:(p=u.value,u=u.key),p===L&&void 0!==_(F,u)&&(g=!0,f--,l--);return g?F:L}),N(B,"$compare_by_identity",function(){var F=this;w(F);var g,l,c,u,f=F.$$keys;if(F.$$by_identity)return F;if(0===F.$$keys.length)return F.$$by_identity=!0,F;for(u=re([],{}).$compare_by_identity(),g=0,l=f.length;g<l;g++)(c=f[g]).$$is_string||(c=c.key),J(u,c,H(F,c));return F.$$by_identity=!0,F.$$map=u.$$map,F.$$smap=u.$$smap,F}),N(B,"$compare_by_identity?",function(){return!0===this.$$by_identity}),N(B,"$default",function(F){var g=this;return void 0!==F&&g.$$proc!==L&&void 0!==g.$$proc?g.$$proc.$call(g,F):void 0===g.$$none?L:g.$$none},-1),N(B,"$default=",function(F){var g=this;return w(g),g.$$proc=L,g.$$none=F,F}),N(B,"$default_proc",function(){return void 0!==this.$$proc?this.$$proc:L}),N(B,"$default_proc=",function(F){var g=this;w(g);var l=F;return l!==L&&(l=V["$coerce_to!"](l,S("Proc"),"to_proc"))["$lambda?"]()&&2!==l.$arity().$abs()&&A.$raise(S("TypeError"),"default_proc takes two arguments"),g.$$none=L,g.$$proc=l,F}),N(B,"$delete",function R(F){var g=R.$$p||L;R.$$p=null,w(this);var c=_(this,F);return void 0!==c?c:g!==L?E.yield1(g,F):L}),N(B,"$delete_if",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,!z(F))return Y(g,"enum_for",["delete_if"],function C(){return(C.$$s??this).$size()},{$$s:g});w(g);for(var u,p,m,l=0,c=g.$$keys,f=c.length;l<f;l++)(u=c[l]).$$is_string?p=g.$$smap[u]:(p=u.value,u=u.key),!1!==(m=F(u,p))&&m!==L&&void 0!==_(g,u)&&(f--,l--);return g}),N(B,"$dig",function(F,g){var c,f=this,u=L;return c=K(arguments,1),(u=f["$[]"](F))===L||0===c.length?u:(z(u["$respond_to?"]("dig"))||A.$raise(S("TypeError"),u.$class()+" does not have #dig method"),Y(u,"dig",q(c)))},-2),N(B,"$each",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,!z(F))return Y(g,"enum_for",["each"],function m(){return(m.$$s??this).$size()},{$$s:g});for(var u,p,l=0,c=g.$$keys.slice(),f=c.length;l<f;l++)(u=c[l]).$$is_string?p=g.$$smap[u]:(p=u.value,u=u.key),le(F,[u,p]);return g}),N(B,"$each_key",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,!z(F))return Y(g,"enum_for",["each_key"],function p(){return(p.$$s??this).$size()},{$$s:g});for(var u,l=0,c=g.$$keys.slice(),f=c.length;l<f;l++)F((u=c[l]).$$is_string?u:u.key);return g}),N(B,"$each_value",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,!z(F))return Y(g,"enum_for",["each_value"],function p(){return(p.$$s??this).$size()},{$$s:g});for(var u,l=0,c=g.$$keys.slice(),f=c.length;l<f;l++)F((u=c[l]).$$is_string?g.$$smap[u]:u.value);return g}),N(B,"$empty?",function(){return 0===this.$$keys.length}),N(B,"$except",function(F){var l,c=this;return l=K(arguments),Y(c.$dup(),"except!",q(l))},-1),N(B,"$except!",function(F){var g,c=this;return g=K(arguments),Y(g,"each",[],function f(u){return null==u&&(u=L),(f.$$s??this).$delete(u)},{$$s:c}),c},-1),N(B,"$fetch",function R(F,g){var l=R.$$p||L;R.$$p=null;var f=H(this,F);return void 0!==f?f:l!==L?l(F):void 0!==g?g:A.$raise(S("KeyError").$new("key not found: "+F.$inspect(),re(["key","receiver"],{key:F,receiver:this})))},-2),N(B,"$fetch_values",function R(F){var l,g=R.$$p||L,f=this;return R.$$p=null,l=K(arguments),Y(l,"map",[],function u(p){return null==p&&(p=L),Y(u.$$s??this,"fetch",[p],g.$to_proc())},{$$s:f})},-1),N(B,"$flatten",function(F){null==F&&(F=1),F=V["$coerce_to!"](F,S("Integer"),"to_int");for(var p,m,l=[],c=0,f=this.$$keys,u=f.length;c<u;c++)if((p=f[c]).$$is_string?m=this.$$smap[p]:(m=p.value,p=p.key),l.push(p),m.$$is_array){if(1===F){l.push(m);continue}l=l.concat(m.$flatten(F-2))}else l.push(m);return l},-1),N(B,"$freeze",function(){var F=this;return z(F["$frozen?"]())?F:O(F)}),N(B,"$has_key?",function(F){return void 0!==H(this,F)}),N(B,"$has_value?",function(F){for(var u,l=0,c=this.$$keys,f=c.length;l<f;l++)if(((u=c[l]).$$is_string?this.$$smap[u]:u.value)["$=="](F))return!0;return!1}),N(B,"$hash",function(){var f,F=this,g=void 0===E.hash_ids,l=F.$object_id(),c=["Hash"];try{if(g&&(E.hash_ids=Object.create(null)),E[l])return"self";for(f in E.hash_ids)if(F["$eql?"](E.hash_ids[f]))return"self";E.hash_ids[l]=F;for(var p=0,m=F.$$keys,C=m.length;p<C;p++)c.push((f=m[p]).$$is_string?[f,F.$$smap[f].$hash()]:[f.key_hash,f.value.$hash()]);return c.sort().join()}finally{g&&(E.hash_ids=void 0)}}),N(B,"$index",function(F){for(var u,p,l=0,c=this.$$keys,f=c.length;l<f;l++)if((u=c[l]).$$is_string?p=this.$$smap[u]:(p=u.value,u=u.key),p["$=="](F))return u;return L}),N(B,"$indexes",function(F){for(var l,C,c=this,f=[],u=0,p=(l=K(arguments)).length;u<p;u++)void 0!==(C=H(c,l[u]))?f.push(C):f.push(c.$default());return f},-1),N(B,"$inspect",function(){var F=this,g=void 0===fe,l=F.$object_id(),c=[];return function(){try{if(g&&(fe={}),fe.hasOwnProperty(l))return"{...}";fe[l]=!0;for(var m,C,f=0,u=F.$$keys,p=u.length;f<p;f++)(m=u[f]).$$is_string?C=F.$$smap[m]:(C=m.value,m=m.key),m=D("Opal").$inspect(m),C=D("Opal").$inspect(C),c.push(m+"=>"+C);return"{"+c.join(", ")+"}"}finally{g&&(fe=void 0)}}()}),N(B,"$invert",function(){for(var u,p,g=_e(),l=0,c=this.$$keys,f=c.length;l<f;l++)(u=c[l]).$$is_string?p=this.$$smap[u]:(p=u.value,u=u.key),J(g,p,u);return g}),N(B,"$keep_if",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,!z(F))return Y(g,"enum_for",["keep_if"],function C(){return(C.$$s??this).$size()},{$$s:g});w(g);for(var u,p,m,l=0,c=g.$$keys,f=c.length;l<f;l++)(u=c[l]).$$is_string?p=g.$$smap[u]:(p=u.value,u=u.key),(!1===(m=F(u,p))||m===L)&&void 0!==_(g,u)&&(f--,l--);return g}),N(B,"$keys",function(){for(var u,g=[],l=0,c=this.$$keys,f=c.length;l<f;l++)g.push((u=c[l]).$$is_string?u:u.key);return g}),N(B,"$length",function(){return this.$$keys.length}),N(B,"$merge",function R(F){var c,g=R.$$p||L,f=this;return R.$$p=null,c=K(arguments),Y(f.$dup(),"merge!",q(c),g.$to_proc())},-1),N(B,"$merge!",function R(F){var c,u,p,m,C,$,ie,se,Ee,g=R.$$p||L,f=this;for(R.$$p=null,c=K(arguments),w(f),u=0;u<c.length;++u)if($=(C=(m=V["$coerce_to!"](c[u],S("Hash"),"to_hash")).$$keys).length,g===L)for(p=0;p<$;p++)(ie=C[p]).$$is_string?Ee=m.$$smap[ie]:(Ee=ie.value,ie=ie.key),J(f,ie,Ee);else for(p=0;p<$;p++)(ie=C[p]).$$is_string?Ee=m.$$smap[ie]:(Ee=ie.value,ie=ie.key),void 0!==(se=H(f,ie))?J(f,ie,g(ie,se,Ee)):J(f,ie,Ee);return f},-1),N(B,"$rassoc",function(F){for(var u,p,l=0,c=this.$$keys,f=c.length;l<f;l++)if((u=c[l]).$$is_string?p=this.$$smap[u]:(p=u.value,u=u.key),p["$=="](F))return[u,p];return L}),N(B,"$rehash",function(){var F=this;return w(F),E.hash_rehash(F),F}),N(B,"$reject",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,!z(F))return Y(g,"enum_for",["reject"],function $(){return($.$$s??this).$size()},{$$s:g});for(var p,m,C,l=_e(),c=0,f=g.$$keys,u=f.length;c<u;c++)(p=f[c]).$$is_string?m=g.$$smap[p]:(m=p.value,p=p.key),(!1===(C=F(p,m))||C===L)&&J(l,p,m);return l}),N(B,"$reject!",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,!z(F))return Y(g,"enum_for",["reject!"],function $(){return($.$$s??this).$size()},{$$s:g});w(g);for(var p,m,C,l=!1,c=0,f=g.$$keys,u=f.length;c<u;c++)(p=f[c]).$$is_string?m=g.$$smap[p]:(m=p.value,p=p.key),!1!==(C=F(p,m))&&C!==L&&void 0!==_(g,p)&&(l=!0,u--,c--);return l?g:L}),N(B,"$replace",function(F){var g=this;w(g),F=V["$coerce_to!"](F,S("Hash"),"to_hash"),d(g);for(var u,m,l=0,c=F.$$keys,f=c.length;l<f;l++)(u=c[l]).$$is_string?m=F.$$smap[u]:(m=u.value,u=u.key),J(g,u,m);return z(F.$default_proc())?g["$default_proc="](F.$default_proc()):g["$default="](F.$default()),g}),N(B,"$select",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,!z(F))return Y(g,"enum_for",["select"],function $(){return($.$$s??this).$size()},{$$s:g});for(var p,m,C,l=_e(),c=0,f=g.$$keys,u=f.length;c<u;c++)(p=f[c]).$$is_string?m=g.$$smap[p]:(m=p.value,p=p.key),!1!==(C=F(p,m))&&C!==L&&J(l,p,m);return l}),N(B,"$select!",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,!z(F))return Y(g,"enum_for",["select!"],function $(){return($.$$s??this).$size()},{$$s:g});w(g);for(var p,m,C,l=L,c=0,f=g.$$keys,u=f.length;c<u;c++)(p=f[c]).$$is_string?m=g.$$smap[p]:(m=p.value,p=p.key),(!1===(C=F(p,m))||C===L)&&(void 0!==_(g,p)&&(u--,c--),l=g);return l}),N(B,"$shift",function(){var F=this;w(F);var l,g=F.$$keys;return g.length>0?[l=(l=g[0]).$$is_string?l:l.key,_(F,l)]:L}),N(B,"$slice",function(F){var l,c=this;l=K(arguments);for(var f=_e(),u=0,p=l.length;u<p;u++){var m=l[u],C=H(c,m);void 0!==C&&J(f,m,C)}return f},-1),N(B,"$to_a",function(){for(var u,p,g=[],l=0,c=this.$$keys,f=c.length;l<f;l++)(u=c[l]).$$is_string?p=this.$$smap[u]:(p=u.value,u=u.key),g.push([u,p]);return g}),N(B,"$to_h",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,F!==L)return Y(g,"map",[],F.$to_proc()).$to_h();if(g.$$class===E.Hash)return g;var l=new E.Hash;return d(l),E.hash_clone(g,l),l}),N(B,"$to_hash",Z),N(B,"$to_proc",function(){return Y(this,"proc",[],function g(l){var c=g.$$s??this;return null==l&&A.$raise(S("ArgumentError"),"no key given"),c["$[]"](l)},{$$arity:-1,$$s:this})}),N(B,"$transform_keys",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,!z(F))return Y(g,"enum_for",["transform_keys"],function C(){return(C.$$s??this).$size()},{$$s:g});for(var p,m,l=_e(),c=0,f=g.$$keys,u=f.length;c<u;c++)(p=f[c]).$$is_string?m=g.$$smap[p]:(m=p.value,p=p.key),p=le(F,p),J(l,p,m);return l}),N(B,"$transform_keys!",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,!z(F))return Y(g,"enum_for",["transform_keys!"],function C(){return(C.$$s??this).$size()},{$$s:g});w(g);var c,u,p,m,l=E.slice(g.$$keys),f=l.length;for(c=0;c<f;c++)(u=l[c]).$$is_string?p=g.$$smap[u]:(p=u.value,u=u.key),m=le(F,u),_(g,u),J(g,m,p);return g}),N(B,"$transform_values",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,!z(F))return Y(g,"enum_for",["transform_values"],function C(){return(C.$$s??this).$size()},{$$s:g});for(var p,m,l=_e(),c=0,f=g.$$keys,u=f.length;c<u;c++)(p=f[c]).$$is_string?m=g.$$smap[p]:(m=p.value,p=p.key),m=le(F,m),J(l,p,m);return l}),N(B,"$transform_values!",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,!z(F))return Y(g,"enum_for",["transform_values!"],function m(){return(m.$$s??this).$size()},{$$s:g});w(g);for(var u,p,l=0,c=g.$$keys,f=c.length;l<f;l++)(u=c[l]).$$is_string?p=g.$$smap[u]:(p=u.value,u=u.key),p=le(F,p),J(g,u,p);return g}),N(B,"$values",function(){for(var u,g=[],l=0,c=this.$$keys,f=c.length;l<f;l++)g.push((u=c[l]).$$is_string?this.$$smap[u]:u.value);return g}),M(B,"dup","clone"),M(B,"each_pair","each"),M(B,"eql?","=="),M(B,"filter","select"),M(B,"filter!","select!"),M(B,"include?","has_key?"),M(B,"indices","indexes"),M(B,"key","index"),M(B,"key?","has_key?"),M(B,"member?","has_key?"),M(B,"size","length"),M(B,"store","[]="),M(B,"to_s","inspect"),M(B,"update","merge!"),M(B,"value?","has_value?"),M(B,"values_at","indexes")},Opal.modules["corelib/number"]=function(E){var B,te,R,g,l,D,fe,le=E.klass,_e=E.Opal,d=E.Kernel,H=E.def,J=E.eqeqeq,_=E.truthy,w=E.rb_gt,O=E.not,x=E.rb_lt,K=E.alias,V=E.send2,A=E.find_super,U=E.send,N=E.rb_plus,Y=E.rb_minus,T=E.eqeq,j=E.return_self,re=E.rb_divide,z=E.to_ary,q=E.rb_times,Z=E.rb_le,M=E.rb_ge,I=E.return_val,X=E.const_set,S=[],k=E.nil,v=E.$$$;return E.top.$require("corelib/numeric"),function(P,B,te){var f,D=le("::",B,"Number");function F(f){var u=new Uint8Array(8);return new DataView(u.buffer).setFloat64(0,f,!0),u}function g(f){return new DataView(f.buffer).getFloat64(0,!0)}function l(f){for(var u=F(f),p=0;p<u.length;p++){if(255!==u[p]){u[p]++;break}u[p]=0}return g(u)}function c(f){for(var u=F(f),p=0;p<u.length;p++){if(0!==u[p]){u[p]--;break}u[p]=255}return g(u)}[D].concat(te),_e.$bridge(Number,D),E.prop(D.$$prototype,"$$is_number",!0),D.$$is_number_class=!0,f=E.get_singleton_class(D),H(f,"$allocate",function(){return d.$raise(v("TypeError"),"allocator undefined for "+this.$name())}),E.udef(f,"$new"),H(D,"$coerce",function(u){var p=this;if(u===k)d.$raise(v("TypeError"),"can't convert "+u.$class()+" into Float");else{if(u.$$is_string)return[d.$Float(u),p];if(u["$respond_to?"]("to_f"))return[_e["$coerce_to!"](u,v("Float"),"to_f"),p];if(u.$$is_number)return[u,p];d.$raise(v("TypeError"),"can't convert "+u.$class()+" into Float")}}),H(D,"$__id__",function(){return 2*this+1}),H(D,"$+",function(u){return u.$$is_number?this+u:this.$__coerced__("+",u)}),H(D,"$-",function(u){return u.$$is_number?this-u:this.$__coerced__("-",u)}),H(D,"$*",function(u){return u.$$is_number?this*u:this.$__coerced__("*",u)}),H(D,"$/",function(u){return u.$$is_number?this/u:this.$__coerced__("/",u)}),H(D,"$%",function(u){var p=this;return u.$$is_number?u==-1/0?u:0!=u?u<0||p<0?(p%u+u)%u:p%u:void d.$raise(v("ZeroDivisionError"),"divided by 0"):p.$__coerced__("%",u)}),H(D,"$&",function(u){return u.$$is_number?this&u:this.$__coerced__("&",u)}),H(D,"$|",function(u){return u.$$is_number?this|u:this.$__coerced__("|",u)}),H(D,"$^",function(u){return u.$$is_number?this^u:this.$__coerced__("^",u)}),H(D,"$<",function(u){return u.$$is_number?this<u:this.$__coerced__("<",u)}),H(D,"$<=",function(u){return u.$$is_number?this<=u:this.$__coerced__("<=",u)}),H(D,"$>",function(u){return u.$$is_number?this>u:this.$__coerced__(">",u)}),H(D,"$>=",function(u){return u.$$is_number?this>=u:this.$__coerced__(">=",u)}),H(D,"$<=>",function(u){try{return function(f,u){return u.$$is_number?isNaN(f)||isNaN(u)?k:f>u?1:f<u?-1:0:f.$__coerced__("<=>",u)}(this,u)}catch(m){if(!E.rescue(m,[v("ArgumentError")]))throw m;try{return k}finally{E.pop_exception()}}}),H(D,"$<<",function(u){return(u=_e["$coerce_to!"](u,v("Integer"),"to_int"))>0?this<<u:this>>-u}),H(D,"$>>",function(u){return(u=_e["$coerce_to!"](u,v("Integer"),"to_int"))>0?this>>u:this<<-u}),H(D,"$[]",function(u){return(u=_e["$coerce_to!"](u,v("Integer"),"to_int"))<0?0:u>=32?this<0?1:0:this>>u&1}),H(D,"$+@",function(){return+this}),H(D,"$-@",function(){return-this}),H(D,"$~",function(){return~this}),H(D,"$**",function(u){var p=this;return J(v("Integer"),u)?O(v("Integer")["$==="](p))||_(w(u,0))?Math.pow(p,u):v("Rational").$new(p,1)["$**"](u):x(p,0)&&(J(v("Float"),u)||J(v("Rational"),u))?v("Complex").$new(p,0)["$**"](u.$to_f()):_(null!=u.$$is_number)?Math.pow(p,u):p.$__coerced__("**",u)}),H(D,"$==",function(u){return u.$$is_number?this.valueOf()===u.valueOf():!!u["$respond_to?"]("==")&&u["$=="](this)}),K(D,"===","=="),H(D,"$abs",function(){return Math.abs(this)}),H(D,"$abs2",function(){return Math.abs(this*this)}),H(D,"$allbits?",function(u){return(this&(u=_e["$coerce_to!"](u,v("Integer"),"to_int")))==u}),H(D,"$anybits?",function(u){return 0!=(this&_e["$coerce_to!"](u,v("Integer"),"to_int"))}),H(D,"$angle",function(){var u=this;return _(u["$nan?"]())?u:0==u?1/u>0?0:Math.PI:u<0?Math.PI:0}),H(D,"$bit_length",function(){var u=this;if(J(v("Integer"),u)||d.$raise(v("NoMethodError").$new("undefined method `bit_length` for "+u+":Float","bit_length")),0===u||-1===u)return 0;for(var p=0,m=u<0?~u:u;0!=m;)p+=1,m>>>=1;return p}),H(D,"$ceil",function(u){null==u&&(u=0);var m=this.$to_f();if(m%1==0&&u>=0)return m;var C=Math.pow(10,u),$=Math.ceil(m*C)/C;return m%1==0&&($=Math.round($)),$},-1),H(D,"$chr",function(u){return E.enc(String.fromCharCode(this),u||"BINARY")},-1),H(D,"$denominator",function f(){var u=f.$$p||k,p=this;return f.$$p=null,_(p["$nan?"]())||_(p["$infinite?"]())?1:V(p,A(p,"denominator",f,!1,!0),"denominator",[],u)}),H(D,"$downto",function f(u){var p=f.$$p||k,m=this;if(f.$$p=null,p===k)return U(m,"enum_for",["downto",u],function $(){var ie=$.$$s??this;return J(v("Numeric"),u)||d.$raise(v("ArgumentError"),"comparison of "+ie.$class()+" with "+u.$class()+" failed"),_(w(u,ie))?0:N(Y(ie,u),1)},{$$s:m});u.$$is_number||d.$raise(v("ArgumentError"),"comparison of "+m.$class()+" with "+u.$class()+" failed");for(var C=m;C>=u;C--)p(C);return m}),H(D,"$equal?",function(u){var m;return _(m=this["$=="](u))?m:isNaN(this)&&isNaN(u)}),H(D,"$even?",function(){return this%2==0}),H(D,"$floor",function(u){null==u&&(u=0);var m=this.$to_f();if(m%1==0&&u>=0)return m;var C=Math.pow(10,u),$=Math.floor(m*C)/C;return m%1==0&&($=Math.round($)),$},-1),H(D,"$gcd",function(u){J(v("Integer"),u)||d.$raise(v("TypeError"),"not an integer");for(var m=Math.abs(this),C=Math.abs(u);m>0;){var $=m;m=C%m,C=$}return C}),H(D,"$gcdlcm",function(u){return[this.$gcd(u),this.$lcm(u)]}),H(D,"$integer?",function(){return this%1==0}),H(D,"$is_a?",function f(u){var p=f.$$p||k,m=this;return f.$$p=null,!!(T(u,v("Integer"))&&J(v("Integer"),m)||T(u,v("Integer"))&&J(v("Integer"),m)||T(u,v("Float"))&&J(v("Float"),m))||V(m,A(m,"is_a?",f,!1,!0),"is_a?",[u],p)}),H(D,"$instance_of?",function f(u){var p=f.$$p||k,m=this;return f.$$p=null,!!(T(u,v("Integer"))&&J(v("Integer"),m)||T(u,v("Integer"))&&J(v("Integer"),m)||T(u,v("Float"))&&J(v("Float"),m))||V(m,A(m,"instance_of?",f,!1,!0),"instance_of?",[u],p)}),H(D,"$lcm",function(u){var p=this;return J(v("Integer"),u)||d.$raise(v("TypeError"),"not an integer"),0==p||0==u?0:Math.abs(p*u/p.$gcd(u))}),H(D,"$next",function(){return this+1}),H(D,"$nobits?",function(u){return 0==(this&_e["$coerce_to!"](u,v("Integer"),"to_int"))}),H(D,"$nonzero?",function(){return 0==this?k:this}),H(D,"$numerator",function f(){var u=f.$$p||k,p=this;return f.$$p=null,_(p["$nan?"]())||_(p["$infinite?"]())?p:V(p,A(p,"numerator",f,!1,!0),"numerator",[],u)}),H(D,"$odd?",function(){return this%2!=0}),H(D,"$ord",j),H(D,"$pow",function(u,p){var m=this;return 0==m&&d.$raise(v("ZeroDivisionError"),"divided by 0"),void 0===p?m["$**"](u):(v("Integer")["$==="](u)||d.$raise(v("TypeError"),"Integer#pow() 2nd argument not allowed unless a 1st argument is integer"),u<0&&d.$raise(v("TypeError"),"Integer#pow() 1st argument cannot be negative when 2nd argument specified"),v("Integer")["$==="](p)||d.$raise(v("TypeError"),"Integer#pow() 2nd argument not allowed unless all arguments are integers"),0===p&&d.$raise(v("ZeroDivisionError"),"divided by 0"),m["$**"](u)["$%"](p))},-2),H(D,"$pred",function(){return this-1}),H(D,"$quo",function f(u){var p=f.$$p||k,m=this;return f.$$p=null,J(v("Integer"),m)?V(m,A(m,"quo",f,!1,!0),"quo",[u],p):re(m,u)}),H(D,"$rationalize",function(u){var p,m,C=this,$=k,ie=k;return arguments.length>1&&d.$raise(v("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),J(v("Integer"),C)?v("Rational").$new(C,1):_(C["$infinite?"]())?d.$raise(v("FloatDomainError"),"Infinity"):_(C["$nan?"]())?d.$raise(v("FloatDomainError"),"NaN"):_(null==u)?(m=v("Math").$frexp(C),$=(p=z(m))[0]??k,ie=p[1]??k,$=v("Math").$ldexp($,v(v("Float"),"MANT_DIG")).$to_i(),ie=Y(ie,v(v("Float"),"MANT_DIG")),v("Rational").$new(q(2,$),1["$<<"](Y(1,ie))).$rationalize(v("Rational").$new(1,1["$<<"](Y(1,ie))))):C.$to_r().$rationalize(u)},-1),H(D,"$remainder",function(u){return Y(this,q(u,re(this,u).$truncate()))}),H(D,"$round",function(u){var m,ie,C=this;if(J(v("Integer"),C)){if(_(null==u)||(J(v("Float"),u)&&_(u["$infinite?"]())&&d.$raise(v("RangeError"),"Infinity"),u=_e["$coerce_to!"](u,v("Integer"),"to_int"),_(x(u,v(v("Integer"),"MIN")))&&d.$raise(v("RangeError"),"out of bounds"),_(u>=0)))return C;if(.415241*(u=u["$-@"]())-.125>C.$size())return 0;var se=Math.pow(10,u),Ee=Math.floor((Math.abs(C)+se/2)/se)*se;return C<0?-Ee:Ee}if(_(C["$nan?"]())&&_(null==u)&&d.$raise(v("FloatDomainError"),"NaN"),u=_e["$coerce_to!"](u||0,v("Integer"),"to_int"),_(Z(u,0)))_(C["$nan?"]())?d.$raise(v("RangeError"),"NaN"):_(C["$infinite?"]())&&d.$raise(v("FloatDomainError"),"Infinity");else{if(T(u,0))return Math.round(C);if(_(C["$nan?"]())||_(C["$infinite?"]()))return C}return m=v("Math").$frexp(C),ie=z(m)[1]??k,_(M(u,Y(N(v(v("Float"),"DIG"),2),_(w(ie,0))?re(ie,4):Y(re(ie,3),1))))?C:_(x(u,(_(w(ie,0))?N(re(ie,3),1):re(ie,4))["$-@"]()))?0:Math.round(C*Math.pow(10,u))/Math.pow(10,u)},-1),H(D,"$times",function f(){var u=f.$$p||k,p=this;if(f.$$p=null,!_(u))return U(p,"enum_for",["times"],function C(){return C.$$s??this},{$$s:p});for(var m=0;m<p;m++)u(m);return p}),H(D,"$to_f",j),H(D,"$to_i",function(){var u=this;return u<0?Math.ceil(u):Math.floor(u)}),H(D,"$to_r",function(){var u,p,m=this,C=k,$=k;return J(v("Integer"),m)?v("Rational").$new(m,1):(p=v("Math").$frexp(m),C=(u=z(p))[0]??k,$=u[1]??k,C=v("Math").$ldexp(C,v(v("Float"),"MANT_DIG")).$to_i(),$=Y($,v(v("Float"),"MANT_DIG")),q(C,v(v("Float"),"RADIX")["$**"]($)).$to_r())}),H(D,"$to_s",function(u){var p=this;return null==u&&(u=10),u=_e["$coerce_to!"](u,v("Integer"),"to_int"),(_(x(u,2))||_(w(u,36)))&&d.$raise(v("ArgumentError"),"invalid radix "+u),T(p,0)&&_(1/p==-1/0)?"-0.0":p.toString(u)},-1),H(D,"$truncate",function(u){null==u&&(u=0);var m=this.$to_f();if(m%1==0&&u>=0)return m;var C=Math.pow(10,u),$=parseInt(m*C,10)/C;return m%1==0&&($=Math.round($)),$},-1),H(D,"$digits",function(u){var p=this;null==u&&(u=10),x(p,0)&&d.$raise(v(v("Math"),"DomainError"),"out of domain"),u=_e["$coerce_to!"](u,v("Integer"),"to_int"),_(x(u,2))&&d.$raise(v("ArgumentError"),"invalid radix "+u),p!=parseInt(p)&&d.$raise(v("NoMethodError"),"undefined method `digits' for "+p.$inspect());var m=p,C=[];if(0==p)return[0];for(;0!=m;)C.push(m%u),m=parseInt(m/u,10);return C},-1),H(D,"$divmod",function f(u){var p=f.$$p||k,m=this;return f.$$p=null,_(m["$nan?"]())||_(u["$nan?"]())?d.$raise(v("FloatDomainError"),"NaN"):_(m["$infinite?"]())?d.$raise(v("FloatDomainError"),"Infinity"):V(m,A(m,"divmod",f,!1,!0),"divmod",[u],p)}),H(D,"$upto",function f(u){var p=f.$$p||k,m=this;if(f.$$p=null,p===k)return U(m,"enum_for",["upto",u],function $(){var ie=$.$$s??this;return J(v("Numeric"),u)||d.$raise(v("ArgumentError"),"comparison of "+ie.$class()+" with "+u.$class()+" failed"),_(x(u,ie))?0:N(Y(u,ie),1)},{$$s:m});u.$$is_number||d.$raise(v("ArgumentError"),"comparison of "+m.$class()+" with "+u.$class()+" failed");for(var C=m;C<=u;C++)p(C);return m}),H(D,"$zero?",function(){return 0==this}),H(D,"$size",I(4)),H(D,"$nan?",function(){return isNaN(this)}),H(D,"$finite?",function(){var u=this;return u!=1/0&&u!=-1/0&&!isNaN(u)}),H(D,"$infinite?",function(){return this==1/0?1:this==-1/0?-1:k}),H(D,"$positive?",function(){var u=this;return 0!=u&&(u==1/0||1/u>0)}),H(D,"$negative?",function(){return this==-1/0||1/this<0}),H(D,"$next_float",function(){var u=this;return T(u,v(v("Float"),"INFINITY"))?v(v("Float"),"INFINITY"):_(u["$nan?"]())?v(v("Float"),"NAN"):M(u,0)?l(Math.abs(u)):c(u)}),H(D,"$prev_float",function(){var u=this;return T(u,v(v("Float"),"INFINITY")["$-@"]())?v(v("Float"),"INFINITY")["$-@"]():_(u["$nan?"]())?v(v("Float"),"NAN"):w(u,0)?c(u):-l(Math.abs(u))}),K(D,"arg","angle"),K(D,"eql?","=="),K(D,"fdiv","/"),K(D,"inspect","to_s"),K(D,"kind_of?","is_a?"),K(D,"magnitude","abs"),K(D,"modulo","%"),K(D,"object_id","__id__"),K(D,"phase","angle"),K(D,"succ","next"),K(D,"to_int","to_i")}(0,v("Numeric"),S),X("::","Fixnum",v("Number")),B=v("Numeric"),te=S,fe=[D=le("::",B,"Integer")].concat(te),D.$$is_number_class=!0,D.$$is_integer_class=!0,g=[R=E.get_singleton_class(D)].concat(fe),l=E.$r(g),H(R,"$allocate",function(){return d.$raise(v("TypeError"),"allocator undefined for "+this.$name())}),E.udef(R,"$new"),H(R,"$sqrt",function(f){return(f=_e["$coerce_to!"](f,v("Integer"),"to_int"))<0&&d.$raise(v(v("Math"),"DomainError"),'Numerical argument is out of domain - "isqrt"'),parseInt(Math.sqrt(f),10)}),H(R,"$try_convert",function(f){return l("Opal")["$coerce_to?"](f,this,"to_int")}),X(D,"MAX",Math.pow(2,30)-1),X(D,"MIN",-Math.pow(2,30)),function(P,B,te){var D=le("::",B,"Float");return[D].concat(te),D.$$is_number_class=!0,function(R,F){H(R,"$allocate",function(){return d.$raise(v("TypeError"),"allocator undefined for "+this.$name())}),E.udef(R,"$new"),H(R,"$===",function(l){return!!l.$$is_number})}(E.get_singleton_class(D)),X(D,"INFINITY",1/0),X(D,"MAX",Number.MAX_VALUE),X(D,"MIN",Number.MIN_VALUE),X(D,"NAN",NaN),X(D,"DIG",15),X(D,"MANT_DIG",53),X(D,"RADIX",2),X(D,"EPSILON",Number.EPSILON||2220446049250313e-31)}(0,v("Numeric"),S)},Opal.modules["corelib/range"]=function(E){var le=E.klass,_e=E.truthy,d=E.Kernel,H=E.def,J=E.not,_=E.send2,w=E.find_super,O=E.rb_lt,x=E.rb_le,K=E.send,V=E.eqeq,A=E.eqeqeq,U=E.return_ivar,N=E.rb_gt,Y=E.rb_minus,T=E.Opal,j=E.rb_divide,re=E.rb_plus,z=E.rb_times,q=E.rb_ge,Z=E.thrower,M=E.alias,L=E.nil,S=E.$$$;return E.top.$require("corelib/enumerable"),function(k,v,P){var B=le("::",null,"Range"),te=[B].concat([]),D=E.$r(te),fe=B.$$prototype;function R(F){return F.begin===L||F.end===L||F.begin===-1/0||F.end===1/0||F.begin===1/0||F.end===-1/0}return fe.begin=fe.end=fe.excl=L,B.$include(S("Enumerable")),B.$$prototype.$$is_range=!0,B.$attr_reader("begin","end"),H(B,"$initialize",function(g,l,c){var f=this;return null==c&&(c=!1),_e(f.begin)&&d.$raise(S("NameError"),"'initialize' called twice"),_e(g["$<=>"](l))||_e(g["$nil?"]())||_e(l["$nil?"]())||d.$raise(S("ArgumentError"),"bad value for range"),f.begin=g,f.end=l,f.excl=c},-3),H(B,"$===",function(g){return this["$include?"](g)}),H(B,"$count",function F(){var g=F.$$p||L,l=this;return F.$$p=null,J(g!==L)&&_e(R(l))?S(S("Float"),"INFINITY"):_(l,w(l,"count",F,!1,!0),"count",[],g)}),H(B,"$to_a",function F(){var g=F.$$p||L,l=this;return F.$$p=null,_e(R(l))&&d.$raise(S("TypeError"),"cannot convert endless range to an array"),_(l,w(l,"to_a",F,!1,!0),"to_a",[],g)}),H(B,"$cover?",function(g){var c,m,l=this,f=L,u=L,p=L;return c=_e(f=_e(u=_e(p=l.begin["$nil?"]())?-1:p)?u:l.begin["$<=>"](g))&&f,m=_e(f=_e(u=_e(p=l.end["$nil?"]())?-1:p)?u:g["$<=>"](l.end))&&f,_e(f=_e(u=_e(l.excl)?_e(p=m)?O(m,0):p:_e(p=m)?x(m,0):p)?c:u)?x(c,0):f}),H(B,"$each",function F(){var f,p,m,g=F.$$p||L,l=this,c=L,u=L;if(F.$$p=null,g===L)return K(l,"enum_for",["each"],function C(){return(C.$$s??this).$size()},{$$s:l});if(l.begin.$$is_number&&l.end.$$is_number){for((l.begin%1!=0||l.end%1!=0)&&d.$raise(S("TypeError"),"can't iterate from Float"),p=l.begin,m=l.end+(_e(l.excl)?0:1);p<m;p++)g(p);return l}if(l.begin.$$is_string&&l.end.$$is_string)return K(l.begin,"upto",[l.end,l.excl],g.$to_proc()),l;for(f=l.end,_e((c=l.begin)["$respond_to?"]("succ"))||d.$raise(S("TypeError"),"can't iterate from "+c.$class());_e(_e(u=l.end["$nil?"]())?u:O(c["$<=>"](f),0));)E.yield1(g,c),c=c.$succ();return J(l.excl)&&V(c,f)&&E.yield1(g,c),l}),H(B,"$eql?",function(g){var l=this,c=L,f=L;return!!A(S("Range"),g)&&(_e(c=_e(f=l.excl["$==="](g["$exclude_end?"]()))?l.begin["$eql?"](g.$begin()):f)?l.end["$eql?"](g.$end()):c)}),H(B,"$exclude_end?",U("excl")),H(B,"$first",function F(g){var l=F.$$p||L,c=this;return F.$$p=null,_e(c.begin["$nil?"]())&&d.$raise(S("RangeError"),"cannot get the minimum of beginless range"),_e(null==g)?c.begin:_(c,w(c,"first",F,!1,!0),"first",[g],l)},-1),H(B,"$last",function(g){var l=this;return _e(l.end["$nil?"]())&&d.$raise(S("RangeError"),"cannot get the maximum of endless range"),_e(null==g)?l.end:l.$to_a().$last(g)},-1),H(B,"$max",function F(){var g=F.$$p||L,l=this;return F.$$p=null,_e(l.end["$nil?"]())?d.$raise(S("RangeError"),"cannot get the maximum of endless range"):g!==L?_(l,w(l,"max",F,!1,!0),"max",[],g):J(l.begin["$nil?"]())&&(_e(N(l.begin,l.end))||_e(l.excl)&&V(l.begin,l.end))?L:l.excl?l.end-1:l.end}),H(B,"$min",function F(){var g=F.$$p||L,l=this;return F.$$p=null,_e(l.begin["$nil?"]())?d.$raise(S("RangeError"),"cannot get the minimum of beginless range"):g!==L?_(l,w(l,"min",F,!1,!0),"min",[],g):J(l.end["$nil?"]())&&(_e(N(l.begin,l.end))||_e(l.excl)&&V(l.begin,l.end))?L:l.begin}),H(B,"$size",function(){var g=this,l=L,c=L,f=L;return l=S(S("Float"),"INFINITY"),V(g.begin,l)&&J(g.end["$nil?"]())||V(g.end,l["$-@"]())&&J(g.begin["$nil?"]())?0:_e(R(g))?l:A(S("Numeric"),g.begin)&&A(S("Numeric"),g.end)?(c=g.begin,f=g.end,_e(g.excl)&&(f=Y(f,1)),_e(O(f,c))?0:(Math.abs(f-c)+1).$to_i()):L}),H(B,"$step",function F(g){var l=F.$$p||L,c=this,f=L,u=L;function p(){null==g?g=1:g.$$is_number||(g=T["$coerce_to!"](g,S("Integer"),"to_int")),g<0?d.$raise(S("ArgumentError"),"step can't be negative"):0===g&&d.$raise(S("ArgumentError"),"step can't be 0")}return F.$$p=null,l===L?(_e(c.begin["$is_a?"](D("Numeric")))||_e(c.begin["$nil?"]()))&&(_e(c.end["$is_a?"](D("Numeric")))||_e(c.end["$nil?"]()))&&J(_e(f=c.begin["$nil?"]())?c.end["$nil?"]():f)?S(S("Enumerator"),"ArithmeticSequence").$new(c,g,"step"):K(c,"enum_for",["step",g],function(){return p(),function m(){if(!c.begin["$respond_to?"]("succ")||c.begin.$$is_string&&c.end.$$is_string)return L;if(g%1==0)return j(c.$size(),g).$ceil();var Ie,C=c.begin,$=c.end,ie=Math.abs,se=Math.floor,Ee=(ie(C)+ie($)+ie($-C))/ie(g)*S(S("Float"),"EPSILON");return Ee>.5&&(Ee=.5),c.excl?(Ie=se(($-C)/g-Ee))*g+C<$&&Ie++:Ie=se(($-C)/g+Ee)+1,Ie}()}):(p(),_e(c.begin.$$is_number&&c.end.$$is_number)?(u=0,function(){try{var C=Z("break");K(c,"loop",[],function $(){var se,ie=$.$$s??this;return null==ie.begin&&(ie.begin=L),null==ie.excl&&(ie.excl=L),null==ie.end&&(ie.end=L),se=re(ie.begin,z(u,g)),_e(ie.excl)?_e(q(se,ie.end))&&C.$throw():_e(N(se,ie.end))&&C.$throw(),E.yield1(l,se),u=re(u,1)},{$$s:c})}catch($){if($===C)return $.$v;throw $}}()):(c.begin.$$is_string&&c.end.$$is_string&&g%1!=0&&d.$raise(S("TypeError"),"no implicit conversion to float from string"),K(c,"each_with_index",[],function($,ie){return null==$&&($=L),null==ie&&(ie=L),V(ie["$%"](g),0)?E.yield1(l,$):L})),c)},-1),H(B,"$%",function(g){var l=this;return _e(l.begin["$is_a?"](D("Numeric")))&&_e(l.end["$is_a?"](D("Numeric")))?S(S("Enumerator"),"ArithmeticSequence").$new(l,g,"%"):l.$step(g)}),H(B,"$bsearch",function F(){var g=F.$$p||L,l=this;return F.$$p=null,g===L?l.$enum_for("bsearch"):(_e(R(l)&&(l.begin.$$is_number||l.end.$$is_number))&&d.$raise(S("NotImplementedError"),"Can't #bsearch an infinite range"),_e(l.begin.$$is_number&&l.end.$$is_number)||d.$raise(S("TypeError"),"can't do binary search for "+l.begin.$class()),K(l.$to_a(),"bsearch",[],g.$to_proc()))}),H(B,"$to_s",function(){var g=this,l=L;return(_e(l=g.begin)?l:"")+(_e(g.excl)?"...":"..")+(_e(l=g.end)?l:"")}),H(B,"$inspect",function(){var g=this,l=L;return(_e(l=g.begin)?g.begin.$inspect():l)+(_e(g.excl)?"...":"..")+(_e(l=g.end)?g.end.$inspect():l)}),H(B,"$marshal_load",function(g){var l=this;return l.begin=g["$[]"]("begin"),l.end=g["$[]"]("end"),l.excl=g["$[]"]("excl")}),H(B,"$hash",function(){var g=this;return[g.begin,g.end,g.excl].$hash()}),M(B,"==","eql?"),M(B,"include?","cover?"),M(B,"member?","cover?")}()},Opal.modules["corelib/proc"]=function(E){var j,le=E.slice,d=E.truthy,H=E.Kernel,J=E.defs,_=E.def,w=E.send,O=E.to_a,x=E.return_self,K=E.ensure_kwargs,V=E.Opal,A=E.alias,U=E.nil,N=E.$$$;return j=(0,E.klass)("::",Function,"Proc"),E.prop(j.$$prototype,"$$is_proc",!0),E.prop(j.$$prototype,"$$is_lambda",!1),J(j,"$new",function re(){var z=re.$$p||U;return re.$$p=null,d(z)||H.$raise(N("ArgumentError"),"tried to create a Proc object without a block"),z}),_(j,"$call",function re(z){var M,q=re.$$p||U,I=this;re.$$p=null,M=le(arguments),q!==U&&(I.$$p=q);var X,L=I.$$brk,S=I.$$ret;if(L||S&&I.$$is_lambda)try{X=I.$$is_lambda?I.apply(null,M):E.yieldX(I,M)}catch(k){if(k===L)return k.$v;if(I.$$is_lambda&&k===S)return k.$v;throw k}else X=I.$$is_lambda?I.apply(null,M):E.yieldX(I,M);return X},-1),_(j,"$>>",function re(z){return re.$$p=null,w(H,"proc",[],function M(I){var L,X=M.$$p||U,k=M.$$s??this,v=U;return M.$$p=null,L=le(arguments),v=w(k,"call",O(L),X.$to_proc()),z.$call(v)},{$$arity:-1,$$s:this})}),_(j,"$<<",function re(z){return re.$$p=null,w(H,"proc",[],function M(I){var L,X=M.$$p||U,k=M.$$s??this,v=U;return M.$$p=null,L=le(arguments),v=w(z,"call",O(L),X.$to_proc()),k.$call(v)},{$$arity:-1,$$s:this})}),_(j,"$to_proc",x),_(j,"$lambda?",function(){return!!this.$$is_lambda}),_(j,"$arity",function(){var z=this;return z.$$is_curried?-1:null!=z.$$arity?z.$$arity:z.length}),_(j,"$source_location",function(){var q=U;return this.$$is_curried?U:d(q=this.$$source_location)?q:U}),_(j,"$binding",function(){var q=this;return q.$$is_curried&&H.$raise(N("ArgumentError"),"Can't create Binding"),d(N("::","Binding","skip_raise")?"constant":U)?N("Binding").$new(U,[],q.$$s,q.$source_location()):U}),_(j,"$parameters",function(z){var Z=this;if(z=K(z),Z.$$is_curried)return[["rest"]];if(Z.$$parameters){if(z.$$smap.lambda??Z.$$is_lambda)return Z.$$parameters;var I,X,M=[];for(I=0,X=Z.$$parameters.length;I<X;I++){var L=Z.$$parameters[I];"req"===L[0]&&(L=["opt",L[1]]),M.push(L)}return M}return[]},-1),_(j,"$curry",function(z){var q=this;function Z(){var X,M=le(arguments),I=M.length;return I>z&&q.$$is_lambda&&!q.$$is_curried&&H.$raise(N("ArgumentError"),"wrong number of arguments ("+I+" for "+z+")"),I>=z?q.$call.apply(q,M):(X=function(){return Z.apply(null,M.concat(le(arguments)))},X.$$is_lambda=q.$$is_lambda,X.$$is_curried=!0,X)}return void 0===z?z=q.length:(z=V["$coerce_to!"](z,N("Integer"),"to_int"),q.$$is_lambda&&z!==q.length&&H.$raise(N("ArgumentError"),"wrong number of arguments ("+z+" for "+q.length+")")),Z.$$is_lambda=q.$$is_lambda,Z.$$is_curried=!0,Z},-1),_(j,"$dup",function(){var z=this,q=z.$$original_proc||z,Z=function(){return q.apply(this,arguments)};for(var M in z)z.hasOwnProperty(M)&&(Z[M]=z[M]);return Z}),A(j,"===","call"),A(j,"clone","dup"),A(j,"yield","call"),A(j,"[]","call")},Opal.modules["corelib/method"]=function(E){var U,N,le=E.klass,_e=E.def,d=E.truthy,H=E.slice,J=E.alias,_=E.Kernel,w=E.send,O=E.to_a,x=E.nil,K=E.$$$;return(N=(U=le("::",null,"Method")).$$prototype).method=N.receiver=N.owner=N.name=x,U.$attr_reader("owner","receiver","name"),_e(U,"$initialize",function(T,j,re,z){var q=this;return q.receiver=T,q.owner=j,q.name=z,q.method=re}),_e(U,"$arity",function(){return this.method.$arity()}),_e(U,"$parameters",function(){return this.method.$$parameters}),_e(U,"$source_location",function(){var j;return d(j=this.method.$$source_location)?j:["(eval)",0]}),_e(U,"$comments",function(){var j;return d(j=this.method.$$comments)?j:[]}),_e(U,"$call",function Y(T){var z,j=Y.$$p||x,q=this;return Y.$$p=null,z=H(arguments),q.method.$$p=j,q.method.apply(q.receiver,z)},-1),_e(U,"$curry",function(T){return this.method.$curry(T)},-1),_e(U,"$>>",function(T){return this.method["$>>"](T)}),_e(U,"$<<",function(T){return this.method["$<<"](T)}),_e(U,"$unbind",function(){var T=this;return K("UnboundMethod").$new(T.receiver.$class(),T.owner,T.method,T.name)}),_e(U,"$to_proc",function(){var T=this,j=T.$call.bind(T);return j.$$unbound=T.method,j.$$is_lambda=!0,j.$$arity=T.method.$$arity??T.method.length,j.$$parameters=T.method.$$parameters,j}),_e(U,"$inspect",function(){var T=this;return"#<"+T.$class()+": "+T.receiver.$class()+"#"+T.name+" (defined in "+T.owner+" in "+T.$source_location().$join(":")+")>"}),J(U,"[]","call"),J(U,"===","call"),function(V,A){var U=le("::",null,"UnboundMethod"),N=U.$$prototype;return N.method=N.owner=N.name=N.source=x,U.$attr_reader("source","owner","name"),_e(U,"$initialize",function(T,j,re,z){var q=this;return q.source=T,q.owner=j,q.method=re,q.name=z}),_e(U,"$arity",function(){return this.method.$arity()}),_e(U,"$parameters",function(){return this.method.$$parameters}),_e(U,"$source_location",function(){var j;return d(j=this.method.$$source_location)?j:["(eval)",0]}),_e(U,"$comments",function(){var j;return d(j=this.method.$$comments)?j:[]}),_e(U,"$bind",function(T){var j=this;if(j.owner.$$is_module||E.is_a(T,j.owner))return K("Method").$new(T,j.owner,j.method,j.name);_.$raise(K("TypeError"),"can't bind singleton method to a different class (expected "+T+".kind_of?("+j.owner+" to be true)")}),_e(U,"$bind_call",function Y(T,j){var q,re=Y.$$p||x,Z=this;return Y.$$p=null,q=H(arguments,1),w(Z.$bind(T),"call",O(q),re.$to_proc())},-2),_e(U,"$inspect",function(){var T=this;return"#<"+T.$class()+": "+T.source+"#"+T.name+" (defined in "+T.owner+" in "+T.$source_location().$join(":")+")>"})}()},Opal.modules["corelib/variables"]=function(E){var le=E.gvars,_e=E.const_set,d=E.Object,H=E.hash2,J=E.nil;return le["&"]=le["~"]=le["`"]=le["'"]=J,le.LOADED_FEATURES=le['"']=E.loaded_features,le.LOAD_PATH=le[":"]=[],le["/"]="\n",le[","]=J,_e("::","ARGV",[]),_e("::","ARGF",d.$new()),_e("::","ENV",H([],{})),le.VERBOSE=!1,le.DEBUG=!1,le.SAFE=0},Opal.modules["corelib/io"]=function(E){var M,v,P,_e=E.const_set,d=E.not,H=E.truthy,J=E.def,_=E.return_ivar,w=E.return_val,O=E.slice,x=E.Kernel,K=E.gvars,V=E.send,A=E.to_a,U=E.rb_plus,N=E.neqeq,Y=E.range,T=E.hash2,j=E.eqeq,re=E.to_ary,z=E.rb_gt,q=E.assign_ivar_val,Z=E.alias,I=E.nil,X=E.$$$;(P=(v=(0,E.klass)("::",null,"IO")).$$prototype).read_buffer=P.closed=I,_e(v,"SEEK_SET",0),_e(v,"SEEK_CUR",1),_e(v,"SEEK_END",2),_e(v,"SEEK_DATA",3),_e(v,"SEEK_HOLE",4),_e(v,"READABLE",1),_e(v,"WRITABLE",4),v.$attr_reader("eof"),v.$attr_accessor("read_proc","sync","tty","write_proc"),J(v,"$initialize",function(te,D){var fe=this;return null==D&&(D="r"),fe.fd=te,fe.flags=D,fe.eof=!1,H(D["$include?"]("r"))&&d(D["$match?"](/[wa+]/))?fe.closed="write":H(D["$match?"](/[wa]/))&&d(D["$match?"](/[r+]/))?fe.closed="read":I},-2),J(v,"$fileno",_("fd")),J(v,"$tty?",function(){return 1==this.tty}),J(v,"$write",function(te){return this.write_proc(te),te.$size()}),J(v,"$flush",w(I)),J(v,"$<<",function(te){return this.$write(te),this}),J(v,"$print",function(te){var fe,R=this;null==K[","]&&(K[","]=I);for(var F=0,g=(fe=O(arguments)).length;F<g;F++)fe[F]=x.$String(fe[F]);return R.$write(fe.join(K[","])),I},-1),J(v,"$puts",function(te){var fe,F,R=this;if(0===(fe=O(arguments)).length)return R.$write("\n"),I;for(var g=0,l=fe.length;g<l;g++)if(fe[g].$$is_array){var c=fe[g].$flatten();c.length>0&&V(R,"puts",A(c))}else(F=fe[g].$$is_string?fe[g].valueOf():x.$String(fe[g])).endsWith("\n")||(F+="\n"),R.$write(F);return I},-1),J(v,"$getc",function(){var D,te=this,fe=I,R=I;te.read_buffer=H(D=te.read_buffer)?D:"",fe="";do{if(te.read_buffer=U(te.read_buffer,fe),N(te.read_buffer,""))return R=te.read_buffer["$[]"](0),te.read_buffer=te.read_buffer["$[]"](Y(1,-1,!1)),R}while(H(fe=te.$sysread_noraise(1)));return I}),J(v,"$getbyte",function(){var te;return(te=this.$getc())===I||null==te?I:te.$ord()}),J(v,"$readbyte",function(){return this.$readchar().$ord()}),J(v,"$readchar",function(){var D;return H(D=this.$getc())?D:x.$raise(X("EOFError"),"end of file reached")}),J(v,"$readline",function(te){var D,R=this,F=I;return D=O(arguments),H(F=V(R,"gets",A(D)))?F:x.$raise(X("EOFError"),"end of file reached")},-1),J(v,"$gets",function(te,D,fe){var R,F,l,f,g=this,c=I,u=I,p=I,m=I;null==K["/"]&&(K["/"]=I),null==te&&(te=!1),null==D&&(D=I),null==fe&&(fe=T([],{})),H(te.$$is_number)&&d(D)&&(te=(R=[!1,te,D])[0],D=R[1],fe=R[2]),H(te.$$is_hash)&&d(D)&&j(fe,T([],{}))?(te=(R=[!1,I,te])[0],D=R[1],fe=R[2]):H(D.$$is_hash)&&j(fe,T([],{}))&&(te=(R=[te,I,D])[0],D=R[1],fe=R[2]),l=te,j(te,!1)&&(te=K["/"]),j(te,"")&&(te=/\r?\n\r?\n/),te=H(c=te)?c:"",j(l,"")||(te=te.$to_str()),f=j(l,"")?2:te.$length(),j(te," ")&&(te=/ /),g.read_buffer=H(c=g.read_buffer)?c:"",u="",p=I;do{if(g.read_buffer=U(g.read_buffer,u),N(te,"")&&H(H(te.$$is_regexp)?g.read_buffer["$match?"](te):g.read_buffer["$include?"](te))){m=g.read_buffer,F=g.read_buffer.$split(te,2),p=(R=re(F))[0]??I,g.read_buffer=R[1]??I,N(p,m)&&(p=U(p,m["$[]"](p.$length(),f)));break}}while(H(u=g.$sysread_noraise(j(te,"")?65536:1)));return H(p)||(p=(R=[H(c=g.read_buffer)?c:"",""])[0],g.read_buffer=R[1],j(p,"")&&(p=I)),H(p)&&(H(D)&&(p=p["$[]"](E.Range.$new(0,D,!0)),g.read_buffer=U(p["$[]"](E.Range.$new(D,-1,!1)),g.read_buffer)),H(fe["$[]"]("chomp"))&&(p=p.$sub(/\r?\n$/,"")),j(l,"")&&(p=p.$sub(/^[\r\n]+/,""))),j(l,!1)&&(K._=p),p},-1),J(v,"$sysread",function(te){var fe;return H(fe=this.read_proc(te))?fe:(this.eof=!0,x.$raise(X("EOFError"),"end of file reached"))}),J(v,"$sysread_noraise",function(te){try{return this.$sysread(te)}catch(fe){if(!E.rescue(fe,[X("EOFError")]))throw fe;try{return I}finally{E.pop_exception()}}}),J(v,"$readpartial",function(te){var D,F,fe=this,R=I,g=I;return fe.read_buffer=H(R=fe.read_buffer)?R:"",F=fe.$sysread(te),g=(D=[U(fe.read_buffer,H(R=F)?R:""),""])[0],fe.read_buffer=D[1],j(g,"")&&(g=I),g}),J(v,"$read",function(te){var D,fe=this,R=I,F=I,g=I;null==te&&(te=I),fe.read_buffer=H(R=fe.read_buffer)?R:"",F="",g=I;do{if(fe.read_buffer=U(fe.read_buffer,F),H(te)&&H(z(fe.read_buffer.$length(),te)))return g=(D=[fe.read_buffer["$[]"](E.Range.$new(0,te,!0)),fe.read_buffer["$[]"](E.Range.$new(te,-1,!1))])[0],fe.read_buffer=D[1],g}while(H(F=fe.$sysread_noraise(H(R=te)?R:65536)));return g=(D=[fe.read_buffer,""])[0],fe.read_buffer=D[1],g},-1),J(v,"$readlines",function(te){return null==K["/"]&&(K["/"]=I),null==te&&(te=K["/"]),this.$each_line(te).$to_a()},-1),J(v,"$each",function B(te,D){var R,F,g,fe=B.$$p||I,l=this,c=I;if(null==K["/"]&&(K["/"]=I),B.$$p=null,(R=O(arguments)).length>0&&(F=R.shift()),null==F&&(F=K["/"]),g=R,fe===I)return V(l,"enum_for",["each",F].concat(A(g)));for(;H(c=V(l,"gets",[F].concat(A(g))));)E.yield1(fe,c);return l},-1),J(v,"$each_byte",function B(){var te=B.$$p||I,D=this,fe=I;if(B.$$p=null,te===I)return D.$enum_for("each_byte");for(;H(fe=D.$getbyte());)E.yield1(te,fe);return D}),J(v,"$each_char",function B(){var te=B.$$p||I,D=this,fe=I;if(B.$$p=null,te===I)return D.$enum_for("each_char");for(;H(fe=D.$getc());)E.yield1(te,fe);return D}),J(v,"$close",q("closed","both")),J(v,"$close_read",function(){return this.closed=j(this.closed,"write")?"both":"read"}),J(v,"$close_write",function(){return this.closed=j(this.closed,"read")?"both":"write"}),J(v,"$closed?",function(){return this.closed["$=="]("both")}),J(v,"$closed_read?",function(){var D;return H(D=this.closed["$=="]("read"))?D:this.closed["$=="]("both")}),J(v,"$closed_write?",function(){var D;return H(D=this.closed["$=="]("write"))?D:this.closed["$=="]("both")}),J(v,"$check_writable",function(){return H(this["$closed_write?"]())?x.$raise(X("IOError"),"not opened for writing"):I}),J(v,"$check_readable",function(){return H(this["$closed_read?"]())?x.$raise(X("IOError"),"not opened for reading"):I}),Z(v,"each_line","each"),Z(v,"eof?","eof"),_e("::","STDIN",K.stdin=X("IO").$new(0,"r")),_e("::","STDOUT",K.stdout=X("IO").$new(1,"w")),_e("::","STDERR",K.stderr=X("IO").$new(2,"w"));var L=E.global.console;return X("STDOUT")["$write_proc="]("object"==typeof process&&"object"==typeof process.stdout?function(S){process.stdout.write(S)}:function(S){L.log(S)}),X("STDERR")["$write_proc="]("object"==typeof process&&"object"==typeof process.stderr?function(S){process.stderr.write(S)}:function(S){L.warn(S)}),M=[function(S){var k=prompt();return null!==k?k+"\n":I}],V(X("STDIN"),"read_proc=",M),M[M.length-1]},Opal.modules["opal/regexp_anchors"]=function(E){var w,O,x,K,_e=E.const_set,d=[],J=E.$$$;return w=d,x=[O=(0,E.module)(d[0],"Opal")].concat(w),K=E.$r(x),_e(O,"REGEXP_START","^"),_e(O,"REGEXP_END","$"),_e(O,"FORBIDDEN_STARTING_IDENTIFIER_CHARS","\\u0001-\\u002F\\u003A-\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),_e(O,"FORBIDDEN_ENDING_IDENTIFIER_CHARS","\\u0001-\\u0020\\u0022-\\u002F\\u003A-\\u003E\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),_e(O,"INLINE_IDENTIFIER_REGEXP",K("Regexp").$new("[^"+J(O,"FORBIDDEN_STARTING_IDENTIFIER_CHARS")+"]*[^"+J(O,"FORBIDDEN_ENDING_IDENTIFIER_CHARS")+"]")),_e(O,"FORBIDDEN_CONST_NAME_CHARS","\\u0001-\\u0020\\u0021-\\u002F\\u003B-\\u003F\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),_e(O,"CONST_NAME_REGEXP",K("Regexp").$new(J(O,"REGEXP_START")+"(::)?[A-Z][^"+J(O,"FORBIDDEN_CONST_NAME_CHARS")+"]*"+J(O,"REGEXP_END")))},Opal.modules["opal/mini"]=function(E){var le=E.Object;return le.$require("opal/base"),le.$require("corelib/nil"),le.$require("corelib/boolean"),le.$require("corelib/string"),le.$require("corelib/comparable"),le.$require("corelib/enumerable"),le.$require("corelib/enumerator"),le.$require("corelib/array"),le.$require("corelib/hash"),le.$require("corelib/number"),le.$require("corelib/range"),le.$require("corelib/proc"),le.$require("corelib/method"),le.$require("corelib/regexp"),le.$require("corelib/variables"),le.$require("corelib/io"),le.$require("opal/regexp_anchors")},Opal.modules["corelib/kernel/format"]=function(E){var N,le=E.coerce_to,d=E.slice,H=E.truthy,J=E.eqeq,_=E.Opal,w=E.Kernel,O=E.gvars,K=E.alias,V=E.nil,A=E.$$$;return(0,E.def)(N=(0,E.module)("::","Kernel"),"$format",function(T,j){var re,z,q=V;null==O.DEBUG&&(O.DEBUG=V),re=d(arguments,1),J((z=re).$length(),1)&&H(z["$[]"](0)["$respond_to?"]("to_ary"))&&(q=_["$coerce_to?"](z["$[]"](0),A("Array"),"to_ary"),H(q["$nil?"]())||(z=q.$to_a()));var I,X,S,k,v,P,B,te,D,fe,R,F,g,l,c,p,Z="",M=0,L=T.length,f=1,u=0,m=0,C=1,$=2,ie=4,se=8,Ee=16,Ie=32,ce=64,Me=128;function $e(){p&Ie&&w.$raise(A("ArgumentError"),"flag after width"),p&Me&&w.$raise(A("ArgumentError"),"flag after precision")}function ye(){p&Ie&&w.$raise(A("ArgumentError"),"width given twice"),p&Me&&w.$raise(A("ArgumentError"),"width after precision")}function he(y){return y>=z.length&&w.$raise(A("ArgumentError"),"too few arguments"),z[y]}function Se(){switch(u){case-1:w.$raise(A("ArgumentError"),"unnumbered("+f+") mixed with numbered");case-2:w.$raise(A("ArgumentError"),"unnumbered("+f+") mixed with named")}return he((u=f++)-1)}function be(y){return u>0&&w.$raise(A("ArgumentError"),"numbered("+y+") after unnumbered("+u+")"),-2===u&&w.$raise(A("ArgumentError"),"numbered("+y+") after named"),y<1&&w.$raise(A("ArgumentError"),"invalid index - "+y+"$"),u=-1,he(y-1)}function ae(){return void 0===c?Se():c}function ue(y){for(var W,pe="";;X++){if(X===L&&w.$raise(A("ArgumentError"),"malformed format string - %*[0-9]"),T.charCodeAt(X)<48||T.charCodeAt(X)>57)return X--,(W=parseInt(pe,10)||0)>2147483647&&w.$raise(A("ArgumentError"),y+" too big"),W;pe+=T.charAt(X)}}function Ce(y){var W,pe=ue(y);return"$"===T.charAt(X+1)?(X++,W=be(pe)):W=Se(),W.$to_int()}for(X=T.indexOf("%");-1!==X;X=T.indexOf("%",X)){switch(k=void 0,p=m,P=-1,B=-1,c=void 0,I=X,X++,T.charAt(X)){case"%":M=X;case"":case"\n":case"\0":X++;continue}e:for(;X<L;X++)switch(T.charAt(X)){case" ":$e(),p|=Ee;continue e;case"#":$e(),p|=C;continue e;case"+":$e(),p|=ie;continue e;case"-":$e(),p|=$;continue e;case"0":$e(),p|=se;continue e;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":if(te=ue("width"),"$"===T.charAt(X+1)){if(X+2===L){k="%",X++;break e}void 0!==c&&w.$raise(A("ArgumentError"),"value given twice - %"+te+"$"),c=be(te),X++}else ye(),p|=Ie,P=te;continue e;case"<":case"{":for(fe="<"===T.charAt(X)?">":"}",D="",X++;;X++){if(X===L&&w.$raise(A("ArgumentError"),"malformed name - unmatched parenthesis"),T.charAt(X)===fe){if(u>0&&w.$raise(A("ArgumentError"),"named "+D+" after unnumbered("+u+")"),-1===u&&w.$raise(A("ArgumentError"),"named "+D+" after numbered"),u=-2,(void 0===z[0]||!z[0].$$is_hash)&&w.$raise(A("ArgumentError"),"one hash required"),c=z[0].$fetch(D),">"===fe)continue e;if(k=c.toString(),-1!==B&&(k=k.slice(0,B)),p&$)for(;k.length<P;)k+=" ";else for(;k.length<P;)k=" "+k;break e}D+=T.charAt(X)}case"*":X++,ye(),p|=Ie,(P=Ce("width"))<0&&(p|=$,P=-P);continue e;case".":if(p&Me&&w.$raise(A("ArgumentError"),"precision given twice"),p|=ce|Me,B=0,X++,"*"===T.charAt(X)){X++,(B=Ce("precision"))<0&&(p&=~ce);continue e}B=ue("precision");continue e;case"d":case"i":case"u":if((S=w.$Integer(ae()))>=0){for(k=S.toString();k.length<B;)k="0"+k;if(p&$)for((p&ie||p&Ee)&&(k=(p&ie?"+":" ")+k);k.length<P;)k+=" ";else if(p&se&&-1===B){for(;k.length<P-(p&ie||p&Ee?1:0);)k="0"+k;(p&ie||p&Ee)&&(k=(p&ie?"+":" ")+k)}else for((p&ie||p&Ee)&&(k=(p&ie?"+":" ")+k);k.length<P;)k=" "+k}else{for(k=(-S).toString();k.length<B;)k="0"+k;if(p&$)for(k="-"+k;k.length<P;)k+=" ";else if(p&se&&-1===B){for(;k.length<P-1;)k="0"+k;k="-"+k}else for(k="-"+k;k.length<P;)k=" "+k}break e;case"b":case"B":case"o":case"x":case"X":switch(T.charAt(X)){case"b":case"B":R=2,F="0b",g=/^1+/,l="1";break;case"o":R=8,F="0",g=/^3?7+/,l="7";break;case"x":case"X":R=16,F="0x",g=/^f+/,l="f"}if((S=w.$Integer(ae()))>=0){for(k=S.toString(R);k.length<B;)k="0"+k;if(p&$)for((p&ie||p&Ee)&&(k=(p&ie?"+":" ")+k),p&C&&0!==S&&(k=F+k);k.length<P;)k+=" ";else if(p&se&&-1===B){for(;k.length<P-(p&ie||p&Ee?1:0)-(p&C&&0!==S?F.length:0);)k="0"+k;p&C&&0!==S&&(k=F+k),(p&ie||p&Ee)&&(k=(p&ie?"+":" ")+k)}else for(p&C&&0!==S&&(k=F+k),(p&ie||p&Ee)&&(k=(p&ie?"+":" ")+k);k.length<P;)k=" "+k}else if(p&ie||p&Ee){for(k=(-S).toString(R);k.length<B;)k="0"+k;if(p&$)for(p&C&&(k=F+k),k="-"+k;k.length<P;)k+=" ";else if(p&se&&-1===B){for(;k.length<P-1-(p&C?2:0);)k="0"+k;p&C&&(k=F+k),k="-"+k}else for(p&C&&(k=F+k),k="-"+k;k.length<P;)k=" "+k}else{for(k=(S>>>0).toString(R).replace(g,l);k.length<B-2;)k=l+k;if(p&$)for(k=".."+k,p&C&&(k=F+k);k.length<P;)k+=" ";else if(p&se&&-1===B){for(;k.length<P-2-(p&C?F.length:0);)k=l+k;k=".."+k,p&C&&(k=F+k)}else for(k=".."+k,p&C&&(k=F+k);k.length<P;)k=" "+k}T.charAt(X)===T.charAt(X).toUpperCase()&&(k=k.toUpperCase());break e;case"f":case"e":case"E":case"g":case"G":if((S=w.$Float(ae()))>=0||isNaN(S)){if(S===1/0)k="Inf";else switch(T.charAt(X)){case"f":k=S.toFixed(-1===B?6:B);break;case"e":case"E":k=S.toExponential(-1===B?6:B);break;case"g":case"G":k=S.toExponential(),(v=parseInt(k.split("e")[1],10))<-4||v>=(-1===B?6:B)||(k=S.toPrecision(-1===B?p&C?6:void 0:B))}if(p&$)for((p&ie||p&Ee)&&(k=(p&ie?"+":" ")+k);k.length<P;)k+=" ";else if(p&se&&S!==1/0&&!isNaN(S)){for(;k.length<P-(p&ie||p&Ee?1:0);)k="0"+k;(p&ie||p&Ee)&&(k=(p&ie?"+":" ")+k)}else for((p&ie||p&Ee)&&(k=(p&ie?"+":" ")+k);k.length<P;)k=" "+k}else{if(S===-1/0)k="Inf";else switch(T.charAt(X)){case"f":k=(-S).toFixed(-1===B?6:B);break;case"e":case"E":k=(-S).toExponential(-1===B?6:B);break;case"g":case"G":k=(-S).toExponential(),(v=parseInt(k.split("e")[1],10))<-4||v>=(-1===B?6:B)||(k=(-S).toPrecision(-1===B?p&C?6:void 0:B))}if(p&$)for(k="-"+k;k.length<P;)k+=" ";else if(p&se&&S!==-1/0){for(;k.length<P-1;)k="0"+k;k="-"+k}else for(k="-"+k;k.length<P;)k=" "+k}T.charAt(X)===T.charAt(X).toUpperCase()&&S!==1/0&&S!==-1/0&&!isNaN(S)&&(k=k.toUpperCase()),k=k.replace(/([eE][-+]?)([0-9])$/,"$10$2");break e;case"a":case"A":w.$raise(A("NotImplementedError"),"`A` and `a` format field types are not implemented in Opal yet");case"c":if((S=ae())["$respond_to?"]("to_ary")&&(S=S.$to_ary()[0]),1!==(k=S["$respond_to?"]("to_str")?S.$to_str():String.fromCharCode(le(S,A("Integer"),"to_int"))).length&&w.$raise(A("ArgumentError"),"%c requires a character"),p&$)for(;k.length<P;)k+=" ";else for(;k.length<P;)k=" "+k;break e;case"p":if(k=ae().$inspect(),-1!==B&&(k=k.slice(0,B)),p&$)for(;k.length<P;)k+=" ";else for(;k.length<P;)k=" "+k;break e;case"s":if(k=ae().$to_s(),-1!==B&&(k=k.slice(0,B)),p&$)for(;k.length<P;)k+=" ";else for(;k.length<P;)k=" "+k;break e;default:w.$raise(A("ArgumentError"),"malformed format string - %"+T.charAt(X))}void 0===k&&w.$raise(A("ArgumentError"),"malformed format string - %"),Z+=T.slice(M,I)+k,M=X+1}return O.DEBUG&&u>=0&&f<z.length&&w.$raise(A("ArgumentError"),"too many arguments for format string"),Z+T.slice(M)},-2),K(N,"sprintf","format")},Opal.modules["corelib/string/encoding"]=function(E){var Y,I,X,le=E.klass,_e=E.hash2,d=E.rb_plus,H=E.truthy,J=E.send,_=E.defs,w=E.eqeq,O=E.def,x=E.return_ivar,K=E.return_val,V=E.slice,A=E.Kernel,U=E.Opal,N=E.rb_lt,T=E.top,re=E.$r([]),z=E.nil,q=E.$$$;return T.$require("corelib/string"),(X=(I=le("::",null,"Encoding")).$$prototype).name=X.dummy=z,_(I,"$register",function L(S,k){var B,D,fe,v=L.$$p||z,te=z,R=z,F=z;return L.$$p=null,null==k&&(k=_e([],{})),B=d([S],H(te=k["$[]"]("aliases"))?te:[]),D=H(te=k["$[]"]("ascii"))&&te,fe=H(te=k["$[]"]("dummy"))&&te,H(k["$[]"]("inherits"))?(R=k["$[]"]("inherits").$clone()).$initialize(S,B,D,fe):R=this.$new(S,B,D,fe),v!==z&&J(R,"instance_eval",[],v.$to_proc()),F=E.encodings,J(B,"each",[],function g(l){return null==l&&(l=z),(g.$$s??this).$const_set(l.$tr("-","_"),R),F[l]=R},{$$s:this})},-2),_(I,"$find",function(S){return w(S,"default_external")?this.$default_external():E.find_encoding(S)}),I.$singleton_class().$attr_accessor("default_external"),I.$attr_reader("name","names"),O(I,"$initialize",function(S,k,v,P){var B=this;return B.name=S,B.names=k,B.ascii=v,B.dummy=P}),O(I,"$ascii_compatible?",x("ascii")),O(I,"$dummy?",x("dummy")),O(I,"$binary?",K(!1)),O(I,"$to_s",x("name")),O(I,"$inspect",function(){return"#<Encoding:"+this.name+(H(this.dummy)?" (dummy)":z)+">"}),O(I,"$charsize",function(S){for(var k=0,v=0,P=S.length;v<P;v++){var B=S.charCodeAt(v);B>=55296&&B<=56319||k++}return k}),O(I,"$each_char",function L(S){var k=L.$$p||z;L.$$p=null;for(var v="",P=0,B=S.length;P<B;P++){var te=S.charCodeAt(P),D=S.charAt(P);te>=56320&&te<=57343?v=D:(te>=55296&&te<=56319&&(D=v+D),"UTF-8"!=S.encoding.name&&((D=new String(D)).encoding=S.encoding),E.yield1(k,D))}}),O(I,"$each_byte",function(S){return V(arguments),A.$raise(q("NotImplementedError"))},-1),O(I,"$bytesize",function(S){return V(arguments),A.$raise(q("NotImplementedError"))},-1),le("::",q("StandardError"),"EncodingError"),le("::",q("EncodingError"),"CompatibilityError"),J(q("Encoding"),"register",["UTF-8",_e(["aliases","ascii"],{aliases:["CP65001"],ascii:!0})],function Z(){var M=Z.$$s??this;return O(M,"$each_byte",function I(X){var L=I.$$p||z;I.$$p=null;for(var k,S=1/0,v=X.length,P=null,B=0;B<v;++B){if((k=X.charCodeAt(B))>55295&&k<57344){if(!P){if(k>56319){(S-=3)>-1&&(E.yield1(L,239),E.yield1(L,191),E.yield1(L,189));continue}if(B+1===v){(S-=3)>-1&&(E.yield1(L,239),E.yield1(L,191),E.yield1(L,189));continue}P=k;continue}if(k<56320){(S-=3)>-1&&(E.yield1(L,239),E.yield1(L,191),E.yield1(L,189)),P=k;continue}k=65536+(P-55296<<10|k-56320)}else P&&(S-=3)>-1&&(E.yield1(L,239),E.yield1(L,191),E.yield1(L,189));if(P=null,k<128){if((S-=1)<0)break;E.yield1(L,k)}else if(k<2048){if((S-=2)<0)break;E.yield1(L,k>>6|192),E.yield1(L,63&k|128)}else if(k<65536){if((S-=3)<0)break;E.yield1(L,k>>12|224),E.yield1(L,k>>6&63|128),E.yield1(L,63&k|128)}else if(k<1114112){if((S-=4)<0)break;E.yield1(L,k>>18|240),E.yield1(L,k>>12&63|128),E.yield1(L,k>>6&63|128),E.yield1(L,63&k|128)}}}),O(M,"$bytesize",function(X){return X.$bytes().$length()})},{$$s:T}),J(q("Encoding"),"register",["UTF-16LE"],function Z(){var M=Z.$$s??this;return O(M,"$each_byte",function I(X){var L=I.$$p||z;I.$$p=null;for(var S=0,k=X.length;S<k;S++){var v=X.charCodeAt(S);E.yield1(L,255&v),E.yield1(L,v>>8)}}),O(M,"$bytesize",function(X){return 2*X.length})},{$$s:T}),J(q("Encoding"),"register",["UTF-16BE",_e(["inherits"],{inherits:q(q("Encoding"),"UTF_16LE")})],function Z(){return O(Z.$$s??this,"$each_byte",function I(X){var L=I.$$p||z;I.$$p=null;for(var S=0,k=X.length;S<k;S++){var v=X.charCodeAt(S);E.yield1(L,v>>8),E.yield1(L,255&v)}})},{$$s:T}),J(q("Encoding"),"register",["UTF-32LE"],function Z(){var M=Z.$$s??this;return O(M,"$each_byte",function I(X){var L=I.$$p||z;I.$$p=null;for(var S=0,k=X.length;S<k;S++){var v=X.charCodeAt(S);E.yield1(L,255&v),E.yield1(L,v>>8),E.yield1(L,0),E.yield1(L,0)}}),O(M,"$bytesize",function(X){return 4*X.length})},{$$s:T}),J(q("Encoding"),"register",["UTF-32BE",_e(["inherits"],{inherits:q(q("Encoding"),"UTF_32LE")})],function Z(){return O(Z.$$s??this,"$each_byte",function I(X){var L=I.$$p||z;I.$$p=null;for(var S=0,k=X.length;S<k;S++){var v=X.charCodeAt(S);E.yield1(L,0),E.yield1(L,0),E.yield1(L,v>>8),E.yield1(L,255&v)}})},{$$s:T}),J(q("Encoding"),"register",["ASCII-8BIT",_e(["aliases","ascii"],{aliases:["BINARY"],ascii:!0})],function Z(){var M=Z.$$s??this;return O(M,"$each_char",function I(X){var L=I.$$p||z;I.$$p=null;for(var S=0,k=X.length;S<k;S++){var v=new String(X.charAt(S));v.encoding=X.encoding,E.yield1(L,v)}}),O(M,"$charsize",function(X){return X.length}),O(M,"$each_byte",function I(X){var L=I.$$p||z;I.$$p=null;for(var S=0,k=X.length;S<k;S++){var v=X.charCodeAt(S);E.yield1(L,255&v)}}),O(M,"$bytesize",function(X){return X.length}),O(M,"$binary?",K(!0))},{$$s:T}),q("Encoding").$register("ISO-8859-1",_e(["aliases","ascii","inherits"],{aliases:["ISO8859-1"],ascii:!0,inherits:q(q("Encoding"),"ASCII_8BIT")})),q("Encoding").$register("US-ASCII",_e(["aliases","ascii","inherits"],{aliases:["ASCII"],ascii:!0,inherits:q(q("Encoding"),"ASCII_8BIT")})),function(Z,M){var I=le("::",null,"String"),X=I.$$prototype;X.internal_encoding=X.bytes=X.encoding=z,I.$attr_reader("encoding"),I.$attr_reader("internal_encoding"),E.prop(String.prototype,"bytes",z),E.prop(String.prototype,"encoding",q(q("Encoding"),"UTF_8")),E.prop(String.prototype,"internal_encoding",q(q("Encoding"),"UTF_8")),O(I,"$b",function(){return this.$dup().$force_encoding("binary")}),O(I,"$bytesize",function(){return this.internal_encoding.$bytesize(this)}),O(I,"$each_byte",function L(){var S=L.$$p||z,k=this;return L.$$p=null,S===z?J(k,"enum_for",["each_byte"],function v(){return(v.$$s??this).$bytesize()},{$$s:k}):(J(k.internal_encoding,"each_byte",[k],S.$to_proc()),k)}),O(I,"$bytes",function(){var S=this,k=z;return"string"==typeof S?new String(S).$each_byte().$to_a():(S.bytes=H(k=S.bytes)?k:S.$each_byte().$to_a(),S.bytes.$dup())}),O(I,"$each_char",function L(){var S=L.$$p||z,k=this;return L.$$p=null,S===z?J(k,"enum_for",["each_char"],function v(){return(v.$$s??this).$length()},{$$s:k}):(J(k.encoding,"each_char",[k],S.$to_proc()),k)}),O(I,"$chars",function L(){var S=L.$$p||z;return L.$$p=null,H(S)?J(this,"each_char",[],S.$to_proc()):this.$each_char().$to_a()}),O(I,"$each_codepoint",function L(){var S=L.$$p||z,k=this;if(L.$$p=null,S===z)return k.$enum_for("each_codepoint");for(var v=0,P=k.length;v<P;v++)E.yield1(S,k.codePointAt(v));return k}),O(I,"$codepoints",function L(){var S=L.$$p||z;return L.$$p=null,S!==z?J(this,"each_codepoint",[],S.$to_proc()):this.$each_codepoint().$to_a()}),O(I,"$encode",function(S){return E.enc(this,S)}),O(I,"$force_encoding",function(S){var v=this;return S===v.encoding||(S=U["$coerce_to!"](S,q("String"),"to_s"),(S=q("Encoding").$find(S))===v.encoding)||(v=E.set_encoding(v,S)),v}),O(I,"$getbyte",function(S){var v=z;return v=this.$bytes(),S=U["$coerce_to!"](S,q("Integer"),"to_int"),H(N(v.$length(),S))?z:v["$[]"](S)}),O(I,"$initialize_copy",function(S){return"\n      self.encoding = other.encoding;\n      self.internal_encoding = other.internal_encoding;\n    "}),O(I,"$valid_encoding?",K(!0))}(),Y=[q(re("Encoding"),"UTF_8")],J(q("Encoding"),"default_external=",Y),Y[Y.length-1]},Opal.modules["corelib/math"]=function(E){var re,z,q,Z,le=E.type_error,d=E.const_set,H=E.Class,J=E.slice,_=E.Kernel,w=E.defs,O=E.truthy,x=E.send,K=E.def,V=E.rb_minus,A=E.eqeqeq,U=E.rb_divide,Y=E.nil,T=E.$$$;return re=[],q=[z=(0,E.module)("::","Math")].concat(re),Z=E.$r(q),d(z,"E",Math.E),d(z,"PI",Math.PI),d(z,"DomainError",H.$new(T("StandardError"))),w(z,"$checked",function(I,X){var S;if(S=J(arguments,1),isNaN(S[0])||2==S.length&&isNaN(S[1]))return NaN;var k=Math[I].apply(null,S);return isNaN(k)&&_.$raise(Z("DomainError"),'Numerical argument is out of domain - "'+I+'"'),k},-2),w(z,"$float!",function(I){try{return _.$Float(I)}catch(X){if(!E.rescue(X,[T("ArgumentError")]))throw X;try{return _.$raise(le(I,T("Float")))}finally{E.pop_exception()}}}),w(z,"$integer!",function(I){try{return _.$Integer(I)}catch(X){if(!E.rescue(X,[T("ArgumentError")]))throw X;try{return _.$raise(le(I,T("Integer")))}finally{E.pop_exception()}}}),z.$module_function(),O(typeof Math.erf<"u")||E.prop(Math,"erf",function(M){var P=1;M<0&&(P=-1);var B=1/(1+.3275911*(M=Math.abs(M)));return P*(1-((((1.061405429*B-1.453152027)*B+1.421413741)*B-.284496736)*B+.254829592)*B*Math.exp(-M*M))}),O(typeof Math.erfc<"u")||E.prop(Math,"erfc",function(M){var I=Math.abs(M),X=1/(.5*I+1),F=X*Math.exp(-I*I-1.26551223+X*(X*(X*(X*(X*(X*(X*(X*(.17087277*X-.82215223)+1.48851587)-1.13520398)+.27886807)-.18628806)+.09678418)+.37409196)+1.00002368));return M<0?2-F:F}),x(["acos","acosh","asin","asinh","atan","atanh","cbrt","cos","cosh","erf","erfc","exp","sin","sinh","sqrt","tanh"],"each",[],function M(I){return null==I&&(I=Y),x(M.$$s??this,"define_method",[I],function(S){return null==S&&(S=Y),T("Math").$checked(I,T("Math")["$float!"](S))})},{$$s:z}),K(z,"$atan2",function(I,X){return T("Math").$checked("atan2",T("Math")["$float!"](I),T("Math")["$float!"](X))}),K(z,"$hypot",function(I,X){return T("Math").$checked("hypot",T("Math")["$float!"](I),T("Math")["$float!"](X))}),K(z,"$frexp",function(I){if(I=Z("Math")["$float!"](I),isNaN(I))return[NaN,0];var X=Math.floor(Math.log(Math.abs(I))/Math.log(2))+1;return[I/Math.pow(2,X),X]}),K(z,"$gamma",function(I){I=Z("Math")["$float!"](I);var X,L,S,k,v,P,B,te,D,R=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];if(isNaN(I))return NaN;if(0===I&&1/I<0)return-1/0;if((-1===I||I===-1/0)&&_.$raise(Z("DomainError"),'Numerical argument is out of domain - "gamma"'),Z("Integer")["$==="](I)){if(I<=0)return isFinite(I)?1/0:NaN;if(I>171)return 1/0;for(k=I-2,v=I-1;k>1;)v*=k,k--;return 0==v&&(v=1),v}if(I<.5)return Math.PI/(Math.sin(Math.PI*I)*T("Math").$gamma(V(1,I)));if(I>=171.35)return 1/0;if(I>85)return D=(te=(B=(P=I*I)*I)*I)*I,Math.sqrt(2*Math.PI/I)*Math.pow(I/Math.E,I)*(1+1/(12*I)+1/(288*P)-139/(51840*B)-571/(2488320*te)+163879/(209018880*D)+5246819/(75246796800*D*I));for(I-=1,S=R[0],X=1;X<R.length;++X)S+=R[X]/(I+X);return L=I+4.7421875+.5,Math.sqrt(2*Math.PI)*Math.pow(L,I+.5)*Math.exp(-L)*S}),K(z,"$ldexp",function(I,X){return I=Z("Math")["$float!"](I),X=Z("Math")["$integer!"](X),isNaN(X)&&_.$raise(T("RangeError"),"float NaN out of range of integer"),I*Math.pow(2,X)}),K(z,"$lgamma",function(I){return-1==I?[1/0,1]:[Math.log(Math.abs(T("Math").$gamma(I))),T("Math").$gamma(I)<0?-1:1]}),K(z,"$log",function(I,X){return A(T("String"),I)&&_.$raise(le(I,T("Float"))),O(null==X)?T("Math").$checked("log",T("Math")["$float!"](I)):(A(T("String"),X)&&_.$raise(le(X,T("Float"))),U(T("Math").$checked("log",T("Math")["$float!"](I)),T("Math").$checked("log",T("Math")["$float!"](X))))},-2),K(z,"$log10",function(I){return A(T("String"),I)&&_.$raise(le(I,T("Float"))),T("Math").$checked("log10",T("Math")["$float!"](I))}),K(z,"$log2",function(I){return A(T("String"),I)&&_.$raise(le(I,T("Float"))),T("Math").$checked("log2",T("Math")["$float!"](I))}),K(z,"$tan",function(I){return I=T("Math")["$float!"](I),O(I["$infinite?"]())?T(T("Float"),"NAN"):T("Math").$checked("tan",T("Math")["$float!"](I))})},Opal.modules["corelib/complex/base"]=function(E){var O,x,K,V,_e=E.truthy,d=E.def,H=E.klass,J=[],_=E.nil;return O=J,K=[x=(0,E.module)("::","Kernel")].concat(O),V=E.$r(K),d(x,"$Complex",function(U,N){return null==N&&(N=_),_e(N)?V("Complex").$new(U,N):V("Complex").$new(U,0)},-2),function(w,O,x){var K=H("::",null,"String"),V=[K].concat(x),A=E.$r(V);return d(K,"$to_c",function(){return A("Complex").$from_string(this)})}(0,0,J)},Opal.modules["corelib/complex"]=function(E){var X,L,S,k,v,le=E.klass,_e=E.truthy,d=E.eqeqeq,H=E.Kernel,J=E.defs,_=E.rb_times,w=E.def,O=E.rb_plus,x=E.rb_minus,K=E.rb_divide,V=E.eqeq,A=E.to_ary,U=E.rb_gt,N=E.neqeq,Y=E.return_val,T=E.const_set,j=E.alias,re=E.top,q=E.nil,Z=E.$$$;return re.$require("corelib/numeric"),re.$require("corelib/complex/base"),X=[],S=[L=le("::",Z("Numeric"),"Complex")].concat(X),k=E.$r(S),(v=L.$$prototype).real=v.imag=q,J(L,"$rect",function(B,te){return null==te&&(te=0),d(Z("Numeric"),B)&&_e(B["$real?"]())&&d(Z("Numeric"),te)&&_e(te["$real?"]())||H.$raise(Z("TypeError"),"not a real"),this.$new(B,te)},-2),J(L,"$polar",function(B,te){return null==te&&(te=0),d(Z("Numeric"),B)&&_e(B["$real?"]())&&d(Z("Numeric"),te)&&_e(te["$real?"]())||H.$raise(Z("TypeError"),"not a real"),this.$new(_(B,Z("Math").$cos(te)),_(B,Z("Math").$sin(te)))},-2),L.$attr_reader("real","imag"),w(L,"$initialize",function(B,te){var D=this;return null==te&&(te=0),D.real=B,D.imag=te,D.$freeze()},-2),w(L,"$coerce",function(B){return d(Z("Complex"),B)?[B,this]:d(Z("Numeric"),B)&&_e(B["$real?"]())?[Z("Complex").$new(B,0),this]:H.$raise(Z("TypeError"),B.$class()+" can't be coerced into Complex")}),w(L,"$==",function(B){var te=this,D=q;return d(Z("Complex"),B)?_e(D=te.real["$=="](B.$real()))?te.imag["$=="](B.$imag()):D:d(Z("Numeric"),B)&&_e(B["$real?"]())?_e(D=te.real["$=="](B))?te.imag["$=="](0):D:B["$=="](te)}),w(L,"$-@",function(){return H.$Complex(this.real["$-@"](),this.imag["$-@"]())}),w(L,"$+",function(B){var te=this;return d(Z("Complex"),B)?H.$Complex(O(te.real,B.$real()),O(te.imag,B.$imag())):d(Z("Numeric"),B)&&_e(B["$real?"]())?H.$Complex(O(te.real,B),te.imag):te.$__coerced__("+",B)}),w(L,"$-",function(B){var te=this;return d(Z("Complex"),B)?H.$Complex(x(te.real,B.$real()),x(te.imag,B.$imag())):d(Z("Numeric"),B)&&_e(B["$real?"]())?H.$Complex(x(te.real,B),te.imag):te.$__coerced__("-",B)}),w(L,"$*",function(B){var te=this;return d(Z("Complex"),B)?H.$Complex(x(_(te.real,B.$real()),_(te.imag,B.$imag())),O(_(te.real,B.$imag()),_(te.imag,B.$real()))):d(Z("Numeric"),B)&&_e(B["$real?"]())?H.$Complex(_(te.real,B),_(te.imag,B)):te.$__coerced__("*",B)}),w(L,"$/",function(B){var te=this;return d(Z("Complex"),B)?d(Z("Number"),te.real)&&_e(te.real["$nan?"]())||d(Z("Number"),te.imag)&&_e(te.imag["$nan?"]())||d(Z("Number"),B.$real())&&_e(B.$real()["$nan?"]())||d(Z("Number"),B.$imag())&&_e(B.$imag()["$nan?"]())?Z("Complex").$new(Z(Z("Float"),"NAN"),Z(Z("Float"),"NAN")):K(_(te,B.$conj()),B.$abs2()):d(Z("Numeric"),B)&&_e(B["$real?"]())?H.$Complex(te.real.$quo(B),te.imag.$quo(B)):te.$__coerced__("/",B)}),w(L,"$**",function(B){var te,D,fe=this,R=q,F=q,g=q,l=q,c=q,f=q,u=q,p=q,m=q,C=q,$=q;if(V(B,0))return Z("Complex").$new(1,0);if(d(Z("Complex"),B))return D=fe.$polar(),R=(te=A(D))[0]??q,F=te[1]??q,g=B.$real(),l=B.$imag(),c=Z("Math").$exp(x(_(g,Z("Math").$log(R)),_(l,F))),f=O(_(F,g),_(l,Z("Math").$log(R))),Z("Complex").$polar(c,f);if(d(Z("Integer"),B)){if(_e(U(B,0))){for(p=u=fe,m=x(B,1);N(m,0);){for(D=m.$divmod(2),C=(te=A(D))[0]??q,$=te[1]??q;V($,0);)u=H.$Complex(x(_(u.$real(),u.$real()),_(u.$imag(),u.$imag())),_(_(2,u.$real()),u.$imag())),D=(m=C).$divmod(2),C=(te=A(D))[0]??q,$=te[1]??q;p=_(p,u),m=x(m,1)}return p}return K(Z("Rational").$new(1,1),fe)["$**"](B["$-@"]())}return d(Z("Float"),B)||d(Z("Rational"),B)?(D=fe.$polar(),R=(te=A(D))[0]??q,F=te[1]??q,Z("Complex").$polar(R["$**"](B),_(F,B))):fe.$__coerced__("**",B)}),w(L,"$abs",function(){return Z("Math").$hypot(this.real,this.imag)}),w(L,"$abs2",function(){var B=this;return O(_(B.real,B.real),_(B.imag,B.imag))}),w(L,"$angle",function(){return Z("Math").$atan2(this.imag,this.real)}),w(L,"$conj",function(){return H.$Complex(this.real,this.imag["$-@"]())}),w(L,"$denominator",function(){return this.real.$denominator().$lcm(this.imag.$denominator())}),w(L,"$eql?",function(B){var D,fe;return _e(D=_e(fe=k("Complex")["$==="](B))?this.real.$class()["$=="](this.imag.$class()):fe)?this["$=="](B):D}),w(L,"$fdiv",function(B){return d(Z("Numeric"),B)||H.$raise(Z("TypeError"),B.$class()+" can't be coerced into Complex"),K(this,B)}),w(L,"$finite?",function(){var te;return _e(te=this.real["$finite?"]())?this.imag["$finite?"]():te}),w(L,"$hash",function(){return"Complex:"+this.real+":"+this.imag}),w(L,"$infinite?",function(){var te;return _e(te=this.real["$infinite?"]())?te:this.imag["$infinite?"]()}),w(L,"$inspect",function(){return"("+this+")"}),w(L,"$numerator",function(){var te,B=this;return te=B.$denominator(),H.$Complex(_(B.real.$numerator(),K(te,B.real.$denominator())),_(B.imag.$numerator(),K(te,B.imag.$denominator())))}),w(L,"$polar",function(){return[this.$abs(),this.$arg()]}),w(L,"$rationalize",function(B){var te=this;return arguments.length>1&&H.$raise(Z("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),N(te.imag,0)&&H.$raise(Z("RangeError"),"can't convert "+te+" into Rational"),te.$real().$rationalize(B)},-1),w(L,"$real?",Y(!1)),w(L,"$rect",function(){return[this.real,this.imag]}),w(L,"$to_f",function(){var B=this;return V(B.imag,0)||H.$raise(Z("RangeError"),"can't convert "+B+" into Float"),B.real.$to_f()}),w(L,"$to_i",function(){var B=this;return V(B.imag,0)||H.$raise(Z("RangeError"),"can't convert "+B+" into Integer"),B.real.$to_i()}),w(L,"$to_r",function(){var B=this;return V(B.imag,0)||H.$raise(Z("RangeError"),"can't convert "+B+" into Rational"),B.real.$to_r()}),w(L,"$to_s",function(){var B=this,te=q;return te=B.real.$inspect(),te=O(te,d(Z("Number"),B.imag)&&_e(B.imag["$nan?"]())||_e(B.imag["$positive?"]())||_e(B.imag["$zero?"]())?"+":"-"),te=O(te,B.imag.$abs().$inspect()),d(Z("Number"),B.imag)&&(_e(B.imag["$nan?"]())||_e(B.imag["$infinite?"]()))&&(te=O(te,"*")),O(te,"i")}),T(S[0],"I",L.$new(0,1)),J(L,"$from_string",function(B){var fe,R,te=/[+-]?[\d_]+(\.[\d_]+)?(e\d+)?/;function g(){return te.test(B)}function l(){var u=B.match(te)[0];return B=B.slice(u.length),u.replace(/_/g,"")}function c(){if(g()){var f=parseFloat(l());if("/"===B[0]){if(B=B.slice(1),g()){var u=parseFloat(l());return H.$Rational(f,u)}return B="/"+B,f}return f}return null}return B.match(te),(fe=c())?(R=c())?H.$Complex(fe,R):"i"===B[0]?H.$Complex(0,fe):H.$Complex(fe,0):H.$Complex(0,"i"===B[0]?1:"-"===B[0]&&"i"===B[1]?-1:"+"===B[0]&&"i"===B[1]?1:0)}),j(E.get_singleton_class(L),"rectangular","rect"),j(L,"arg","angle"),j(L,"conjugate","conj"),j(L,"divide","/"),j(L,"imaginary","imag"),j(L,"magnitude","abs"),j(L,"phase","arg"),j(L,"quo","/"),j(L,"rectangular","rect"),E.udef(L,"$negative?"),E.udef(L,"$positive?"),E.udef(L,"$step"),q},Opal.modules["corelib/rational/base"]=function(E){var _e=E.def,d=E.klass,J=E.$$$;return _e((0,E.module)("::","Kernel"),"$Rational",function(x,K){return null==K&&(K=1),J("Rational").$convert(x,K)},-2),_e(d("::",null,"String"),"$to_r",function(){return J("Rational").$from_string(this)})},Opal.modules["corelib/rational"]=function(E){var L,S,le=E.klass,_e=E.eqeq,d=E.Kernel,H=E.truthy,J=E.rb_lt,_=E.rb_divide,w=E.defs,O=E.eqeqeq,x=E.not,K=E.Opal,V=E.def,A=E.return_ivar,U=E.rb_minus,N=E.rb_times,Y=E.rb_plus,T=E.rb_gt,j=E.rb_le,re=E.return_self,z=E.alias,q=E.top,Z=E.nil,M=E.$$$;return q.$require("corelib/numeric"),q.$require("corelib/rational/base"),(S=(L=le("::",M("Numeric"),"Rational")).$$prototype).num=S.den=Z,w(L,"$reduce",function(v,P){var te;if(v=v.$to_i(),P=P.$to_i(),_e(P,0))d.$raise(M("ZeroDivisionError"),"divided by 0");else if(H(J(P,0)))v=v["$-@"](),P=P["$-@"]();else if(_e(P,1))return this.$new(v,P);return te=v.$gcd(P),this.$new(_(v,te),_(P,te))}),w(L,"$convert",function(v,P){return(H(v["$nil?"]())||H(P["$nil?"]()))&&d.$raise(M("TypeError"),"cannot convert nil into Rational"),O(M("Integer"),v)&&O(M("Integer"),P)?this.$reduce(v,P):((O(M("Float"),v)||O(M("String"),v)||O(M("Complex"),v))&&(v=v.$to_r()),(O(M("Float"),P)||O(M("String"),P)||O(M("Complex"),P))&&(P=P.$to_r()),H(P["$equal?"](1))&&x(M("Integer")["$==="](v))?K["$coerce_to!"](v,M("Rational"),"to_r"):O(M("Numeric"),v)&&O(M("Numeric"),P)?_(v,P):this.$reduce(v,P))}),V(L,"$initialize",function(v,P){var B=this;return B.num=v,B.den=P,B.$freeze()}),V(L,"$numerator",A("num")),V(L,"$denominator",A("den")),V(L,"$coerce",function(v){var B,P=this;return O(M("Rational"),B=v)?[v,P]:O(M("Integer"),B)?[v.$to_r(),P]:O(M("Float"),B)?[v,P.$to_f()]:Z}),V(L,"$==",function(v){var B,P=this,te=Z;return O(M("Rational"),B=v)?H(te=P.num["$=="](v.$numerator()))?P.den["$=="](v.$denominator()):te:O(M("Integer"),B)?H(te=P.num["$=="](v))?P.den["$=="](1):te:O(M("Float"),B)?P.$to_f()["$=="](v):v["$=="](P)}),V(L,"$<=>",function(v){var B,P=this;return O(M("Rational"),B=v)?U(N(P.num,v.$denominator()),N(P.den,v.$numerator()))["$<=>"](0):O(M("Integer"),B)?U(P.num,N(P.den,v))["$<=>"](0):O(M("Float"),B)?P.$to_f()["$<=>"](v):P.$__coerced__("<=>",v)}),V(L,"$+",function(v){var B,P=this,te=Z,D=Z;return O(M("Rational"),B=v)?(te=Y(N(P.num,v.$denominator()),N(P.den,v.$numerator())),D=N(P.den,v.$denominator()),d.$Rational(te,D)):O(M("Integer"),B)?d.$Rational(Y(P.num,N(v,P.den)),P.den):O(M("Float"),B)?Y(P.$to_f(),v):P.$__coerced__("+",v)}),V(L,"$-",function(v){var B,P=this,te=Z,D=Z;return O(M("Rational"),B=v)?(te=U(N(P.num,v.$denominator()),N(P.den,v.$numerator())),D=N(P.den,v.$denominator()),d.$Rational(te,D)):O(M("Integer"),B)?d.$Rational(U(P.num,N(v,P.den)),P.den):O(M("Float"),B)?U(P.$to_f(),v):P.$__coerced__("-",v)}),V(L,"$*",function(v){var B,P=this,te=Z,D=Z;return O(M("Rational"),B=v)?(te=N(P.num,v.$numerator()),D=N(P.den,v.$denominator()),d.$Rational(te,D)):O(M("Integer"),B)?d.$Rational(N(P.num,v),P.den):O(M("Float"),B)?N(P.$to_f(),v):P.$__coerced__("*",v)}),V(L,"$/",function(v){var B,P=this,te=Z,D=Z;return O(M("Rational"),B=v)?(te=N(P.num,v.$denominator()),D=N(P.den,v.$numerator()),d.$Rational(te,D)):O(M("Integer"),B)?_e(v,0)?_(P.$to_f(),0):d.$Rational(P.num,N(P.den,v)):O(M("Float"),B)?_(P.$to_f(),v):P.$__coerced__("/",v)}),V(L,"$**",function(v){var B,P=this;return O(M("Integer"),B=v)?_e(P,0)&&H(J(v,0))?M(M("Float"),"INFINITY"):H(T(v,0))?d.$Rational(P.num["$**"](v),P.den["$**"](v)):H(J(v,0))?d.$Rational(P.den["$**"](v["$-@"]()),P.num["$**"](v["$-@"]())):d.$Rational(1,1):O(M("Float"),B)?P.$to_f()["$**"](v):O(M("Rational"),B)?_e(v,0)?d.$Rational(1,1):_e(v.$denominator(),1)?H(J(v,0))?d.$Rational(P.den["$**"](v.$numerator().$abs()),P.num["$**"](v.$numerator().$abs())):d.$Rational(P.num["$**"](v.$numerator()),P.den["$**"](v.$numerator())):_e(P,0)&&H(J(v,0))?d.$raise(M("ZeroDivisionError"),"divided by 0"):P.$to_f()["$**"](v):P.$__coerced__("**",v)}),V(L,"$abs",function(){return d.$Rational(this.num.$abs(),this.den.$abs())}),V(L,"$ceil",function(v){var P=this;return null==v&&(v=0),_e(v,0)?_(P.num["$-@"](),P.den)["$-@"]().$ceil():P.$with_precision("ceil",v)},-1),V(L,"$floor",function(v){var P=this;return null==v&&(v=0),_e(v,0)?_(P.num["$-@"](),P.den)["$-@"]().$floor():P.$with_precision("floor",v)},-1),V(L,"$hash",function(){return"Rational:"+this.num+":"+this.den}),V(L,"$inspect",function(){return"("+this+")"}),V(L,"$rationalize",function(v){var P=this;if(arguments.length>1&&d.$raise(M("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),null==v)return P;for(var l,c,f,u,p,B=v.$abs(),te=U(P,B),D=Y(P,B),fe=0,R=1,F=1,g=0;f=te.$ceil(),!j(f,D);)l=(u=f-1)*R+fe,c=u*g+F,p=_(1,U(D,u)),D=_(1,U(te,u)),te=p,fe=R,F=g,R=l,g=c;return d.$Rational(f*R+fe,f*g+F)},-1),V(L,"$round",function(v){var P=this,B=Z,te=Z,D=Z;return null==v&&(v=0),_e(v,0)?_e(P.num,0)?0:_e(P.den,1)?P.num:(B=Y(N(P.num.$abs(),2),P.den),te=N(P.den,2),D=_(B,te).$truncate(),H(J(P.num,0))?D["$-@"]():D):P.$with_precision("round",v)},-1),V(L,"$to_f",function(){return _(this.num,this.den)}),V(L,"$to_i",function(){return this.$truncate()}),V(L,"$to_r",re),V(L,"$to_s",function(){return this.num+"/"+this.den}),V(L,"$truncate",function(v){var P=this;return null==v&&(v=0),_e(v,0)?H(J(P.num,0))?P.$ceil():P.$floor():P.$with_precision("truncate",v)},-1),V(L,"$with_precision",function(v,P){var te,D=Z;return O(M("Integer"),P)||d.$raise(M("TypeError"),"not an Integer"),te=10["$**"](P),D=N(this,te),H(J(P,1))?_(D.$send(v),te).$to_i():d.$Rational(D.$send(v),te)}),w(L,"$from_string",function(v){var D,fe,P=v.trimLeft(),B=/^[+-]?[\d_]+(\.[\d_]+)?/;function R(){return B.test(P)}function F(){var l=P.match(B)[0];return P=P.slice(l.length),l.replace(/_/g,"")}return P.match(B),R()?(D=parseFloat(F()),"/"===P[0]?(P=P.slice(1),R()?(fe=parseFloat(F()),d.$Rational(D,fe)):d.$Rational(D,1)):d.$Rational(D,1)):d.$Rational(0,1)}),z(L,"divide","/"),z(L,"quo","/")},Opal.modules["corelib/time"]=function(E){var le=E.slice,_e=E.deny_frozen_access,d=E.klass,H=E.Kernel,J=E.Opal,_=E.defs,w=E.eqeqeq,O=E.def,x=E.truthy,K=E.rb_gt,V=E.rb_lt,A=E.send,U=E.rb_plus,N=E.rb_divide,Y=E.rb_minus,T=E.range,j=E.neqeq,re=E.rb_le,z=E.eqeq,q=E.alias,I=E.nil,X=E.$$$;return E.top.$require("corelib/comparable"),function(L,S,k){var v=d("::",S,"Time"),P=[v].concat([]),B=E.$r(P);v.$include(X("Comparable"));var g,te=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],D=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],fe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],R=["January","February","March","April","May","June","July","August","September","October","November","December"];function F(g,l,c,f,u,p){if(g=g.$$is_string?parseInt(g,10):J["$coerce_to!"](g,X("Integer"),"to_int"),l===I)l=1;else if(!l.$$is_number)if(l["$respond_to?"]("to_str"))switch(l=l.$to_str(),l.toLowerCase()){case"jan":l=1;break;case"feb":l=2;break;case"mar":l=3;break;case"apr":l=4;break;case"may":l=5;break;case"jun":l=6;break;case"jul":l=7;break;case"aug":l=8;break;case"sep":l=9;break;case"oct":l=10;break;case"nov":l=11;break;case"dec":l=12;break;default:l=l.$to_i()}else l=J["$coerce_to!"](l,X("Integer"),"to_int");return(l<1||l>12)&&H.$raise(X("ArgumentError"),"month out of range: "+l),l-=1,((c=c===I?1:c.$$is_string?parseInt(c,10):J["$coerce_to!"](c,X("Integer"),"to_int"))<1||c>31)&&H.$raise(X("ArgumentError"),"day out of range: "+c),((f=f===I?0:f.$$is_string?parseInt(f,10):J["$coerce_to!"](f,X("Integer"),"to_int"))<0||f>24)&&H.$raise(X("ArgumentError"),"hour out of range: "+f),((u=u===I?0:u.$$is_string?parseInt(u,10):J["$coerce_to!"](u,X("Integer"),"to_int"))<0||u>59)&&H.$raise(X("ArgumentError"),"min out of range: "+u),p===I?p=0:p.$$is_number||(p=p.$$is_string?parseInt(p,10):J["$coerce_to!"](p,X("Integer"),"to_int")),(p<0||p>60)&&H.$raise(X("ArgumentError"),"sec out of range: "+p),[g,l,c,f,u,p]}return _(v,"$at",function(l,c){var f;return X("Time")["$==="](l)?(void 0!==c&&H.$raise(X("TypeError"),"can't convert Time into an exact number"),(f=new Date(l.getTime())).timezone=l.timezone,f):(l.$$is_number||(l=J["$coerce_to!"](l,X("Integer"),"to_int")),void 0===c?new Date(1e3*l):(c.$$is_number||(c=J["$coerce_to!"](c,X("Integer"),"to_int")),new Date(1e3*l+c/1e3)))},-2),_(v,"$new",function(l,c,f,u,p,m,C){var ie,se,Ee,Ie;return null==c&&(c=I),null==f&&(f=I),null==u&&(u=I),null==p&&(p=I),null==m&&(m=I),null==C&&(C=I),void 0===l?new Date:(l=(ie=F(l,c,f,u,p,m))[0],c=ie[1],f=ie[2],u=ie[3],p=ie[4],m=ie[5],C===I?(se=new Date(l,c,f,u,p,0,1e3*m),l<100&&se.setFullYear(l),se):(Ee=this.$_parse_offset(C),Ie=new Date(Date.UTC(l,c,f,u,p,0,1e3*m)),l<100&&Ie.setUTCFullYear(l),(se=new Date(Ie.getTime()-36e5*Ee)).timezone=Ee,se))},-1),_(v,"$_parse_offset",function(l){var c;return l.$$is_string?"UTC"==l?c=0:/^[+-]\d\d:[0-5]\d$/.test(l)?c=("-"==l[0]?-1:1)*(+(l[1]+l[2])+ +(l[4]+l[5])/60):H.$raise(X("ArgumentError"),'"+HH:MM", "-HH:MM", "UTC" expected for utc_offset: '+l):l.$$is_number?c=l/3600:H.$raise(X("ArgumentError"),"Opal doesn't support other types for a timezone argument than Integer and String"),c}),_(v,"$local",function(l,c,f,u,p,m,C,$,ie,se){var Ee,Ie;return null==c&&(c=I),null==f&&(f=I),null==u&&(u=I),null==p&&(p=I),null==m&&(m=I),null==C&&(C=I),null==$&&($=I),null==ie&&(ie=I),null==se&&(se=I),10===arguments.length&&(l=(Ee=le(arguments))[5],c=Ee[4],f=Ee[3],u=Ee[2],p=Ee[1],m=Ee[0]),l=(Ee=F(l,c,f,u,p,m))[0],c=Ee[1],f=Ee[2],u=Ee[3],p=Ee[4],m=Ee[5],Ie=new Date(l,c,f,u,p,0,1e3*m),l<100&&Ie.setFullYear(l),Ie},-2),_(v,"$gm",function(l,c,f,u,p,m,C,$,ie,se){var Ee,Ie;return null==c&&(c=I),null==f&&(f=I),null==u&&(u=I),null==p&&(p=I),null==m&&(m=I),null==C&&(C=I),null==$&&($=I),null==ie&&(ie=I),null==se&&(se=I),10===arguments.length&&(l=(Ee=le(arguments))[5],c=Ee[4],f=Ee[3],u=Ee[2],p=Ee[1],m=Ee[0]),l=(Ee=F(l,c,f,u,p,m))[0],c=Ee[1],f=Ee[2],u=Ee[3],p=Ee[4],m=Ee[5],Ie=new Date(Date.UTC(l,c,f,u,p,0,1e3*m)),l<100&&Ie.setUTCFullYear(l),Ie.timezone=0,Ie},-2),_(v,"$now",function(){return this.$new()}),O(v,"$+",function(l){w(X("Time"),l)&&H.$raise(X("TypeError"),"time + time?"),l.$$is_number||(l=J["$coerce_to!"](l,X("Integer"),"to_int"));var f=new Date(this.getTime()+1e3*l);return f.timezone=this.timezone,f}),O(v,"$-",function(l){var c=this;if(w(X("Time"),l))return(c.getTime()-l.getTime())/1e3;l.$$is_number||(l=J["$coerce_to!"](l,X("Integer"),"to_int"));var f=new Date(c.getTime()-1e3*l);return f.timezone=c.timezone,f}),O(v,"$<=>",function(l){var f=I;return w(X("Time"),l)?this.$to_f()["$<=>"](l.$to_f()):(f=l["$<=>"](this),x(f["$nil?"]())?I:x(K(f,0))?-1:x(V(f,0))?1:0)}),O(v,"$==",function(l){var f;return x(f=X("Time")["$==="](l))?this.$to_f()===l.$to_f():f}),O(v,"$asctime",function(){return this.$strftime("%a %b %e %H:%M:%S %Y")}),A([["year","getFullYear","getUTCFullYear"],["mon","getMonth","getUTCMonth",1],["wday","getDay","getUTCDay"],["day","getDate","getUTCDate"],["hour","getHours","getUTCHours"],["min","getMinutes","getUTCMinutes"],["sec","getSeconds","getUTCSeconds"]],"each",[],function g(l,c,f,u){var p=g.$$s??this;return null==l&&(l=I),null==c&&(c=I),null==f&&(f=I),null==u&&(u=0),A(p,"define_method",[l],function m(){var C=m.$$s??this;return u+(null!=C.timezone?new Date(C.getTime()+36e5*C.timezone)[f]():C[c]())},{$$s:p})},{$$arity:-4,$$s:v}),O(v,"$yday",function(){var c,f,l=this;return c=B("Time").$new(l.$year()).$to_i(),f=B("Time").$new(l.$year(),l.$month(),l.$day()).$to_i(),U(N(Y(f,c),86400).$round(),1)}),O(v,"$isdst",function(){var l=this,c=new Date(l.getFullYear(),0,1),f=new Date(l.getFullYear(),6,1);return l.getTimezoneOffset()<Math.max(c.getTimezoneOffset(),f.getTimezoneOffset())}),O(v,"$dup",function(){var l=this,c=I;return(c=new Date(l.getTime())).$copy_instance_variables(l),c.$initialize_dup(l),c}),O(v,"$eql?",function(l){var f;return x(f=l["$is_a?"](X("Time")))?this["$<=>"](l)["$zero?"]():f}),A([["sunday?",0],["monday?",1],["tuesday?",2],["wednesday?",3],["thursday?",4],["friday?",5],["saturday?",6]],"each",[],function g(l,c){var f=g.$$s??this;return null==l&&(l=I),null==c&&(c=I),A(f,"define_method",[l],function u(){return(u.$$s??this).$wday()===c},{$$s:f})},{$$s:v}),O(v,"$hash",function(){return"Time:"+this.getTime()}),O(v,"$inspect",function(){var l=this;return x(l["$utc?"]())?l.$strftime("%Y-%m-%d %H:%M:%S UTC"):l.$strftime("%Y-%m-%d %H:%M:%S %z")}),O(v,"$succ",function(){var c=new Date(this.getTime()+1e3);return c.timezone=this.timezone,c}),O(v,"$usec",function(){return 1e3*this.getMilliseconds()}),O(v,"$zone",function(){var l=this;if(0===l.timezone)return"UTC";if(null!=l.timezone)return I;var f,c=l.toString();return"GMT"==(f=-1==c.indexOf("(")?c.match(/[A-Z]{3,4}/)[0]:c.match(/\((.+)\)(?:\s|$)/)[1])&&/(GMT\W*\d{4})/.test(c)?RegExp.$1:f}),O(v,"$getgm",function(){var c=new Date(this.getTime());return c.timezone=0,c}),O(v,"$gmtime",function(){var l=this;return 0!==l.timezone&&(_e(l),l.timezone=0),l}),O(v,"$gmt?",function(){return 0===this.timezone}),O(v,"$gmt_offset",function(){var l=this;return null!=l.timezone?60*l.timezone:60*-l.getTimezoneOffset()}),O(v,"$strftime",function(l){var c=this;return l.replace(/%([\-_#^0]*:{0,2})(\d+)?([EO]*)(.)/g,function(f,u,p,m,C){var ie,se,Ee,$="",Ie=-1!==u.indexOf("0"),ce=-1===u.indexOf("-"),Me=-1!==u.indexOf("_"),$e=-1!==u.indexOf("^"),ye=-1!==u.indexOf("#"),he=(u.match(":")||[]).length;switch(p=parseInt(p,10),Ie&&Me&&(u.indexOf("0")<u.indexOf("_")?Ie=!1:Me=!1),C){case"Y":$+=c.$year();break;case"C":Ie=!Me,$+=Math.round(c.$year()/100);break;case"y":Ie=!Me,$+=c.$year()%100;break;case"m":Ie=!Me,$+=c.$mon();break;case"B":$+=R[c.$mon()-1];break;case"b":case"h":Me=!Ie,$+=fe[c.$mon()-1];break;case"d":Ie=!Me,$+=c.$day();break;case"e":Me=!Ie,$+=c.$day();break;case"j":Ie=!Me,p=isNaN(p)?3:p,$+=c.$yday();break;case"H":Ie=!Me,$+=c.$hour();break;case"k":Me=!Ie,$+=c.$hour();break;case"I":Ie=!Me,$+=c.$hour()%12||12;break;case"l":Me=!Ie,$+=c.$hour()%12||12;break;case"P":$+=c.$hour()>=12?"pm":"am";break;case"p":$+=c.$hour()>=12?"PM":"AM";break;case"M":Ie=!Me,$+=c.$min();break;case"S":Ie=!Me,$+=c.$sec();break;case"L":Ie=!Me,p=isNaN(p)?3:p,$+=c.getMilliseconds();break;case"N":p=isNaN(p)?9:p,$=($+=c.getMilliseconds().toString().$rjust(3,"0")).$ljust(p,"0");break;case"z":var Se=null==c.timezone?c.getTimezoneOffset():60*-c.timezone,be=Math.floor(Math.abs(Se)/60),ae=Math.abs(Se)%60;$+=Se<0?"+":"-",$+=be<10?"0":"",$+=be,he>0&&($+=":"),$+=ae<10?"0":"",$+=ae,he>1&&($+=":00");break;case"Z":$+=c.$zone();break;case"A":$+=te[c.$wday()];break;case"a":$+=D[c.$wday()];break;case"u":$+=c.$wday()+1;break;case"w":$+=c.$wday();break;case"V":$+=c.$cweek_cyear()["$[]"](0).$to_s().$rjust(2,"0");break;case"G":$+=c.$cweek_cyear()["$[]"](1);break;case"g":$+=c.$cweek_cyear()["$[]"](1)["$[]"](T(-2,-1,!1));break;case"s":$+=c.$to_i();break;case"n":$+="\n";break;case"t":$+="\t";break;case"%":$+="%";break;case"c":$+=c.$strftime("%a %b %e %T %Y");break;case"D":case"x":$+=c.$strftime("%m/%d/%y");break;case"F":$+=c.$strftime("%Y-%m-%d");break;case"v":$+=c.$strftime("%e-%^b-%4Y");break;case"r":$+=c.$strftime("%I:%M:%S %p");break;case"R":$+=c.$strftime("%H:%M");break;case"T":case"X":$+=c.$strftime("%H:%M:%S");break;case"J":if((ie=c.$to_date().$jd())<2405160){$+=c.$strftime("%Y-%m-%d");break}ie<2419614?(se="M",Ee=1867):ie<2424875?(se="T",Ee=1911):ie<2447535?(se="S",Ee=1925):ie<2458605?(se="H",Ee=1988):(se="R",Ee=2018),$+=c.$format("%c%02d",se,Y(c.$year(),Ee)),$+=c.$strftime("-%m-%d");break;default:return f}return $e&&($=$.toUpperCase()),ye&&($=$.replace(/[A-Z]/,function(ue){ue.toLowerCase()}).replace(/[a-z]/,function(ue){ue.toUpperCase()})),ce&&(Ie||Me)&&($=$.$rjust(isNaN(p)?2:p,Me?" ":"0")),$})}),O(v,"$to_a",function(){var l=this;return[l.$sec(),l.$min(),l.$hour(),l.$day(),l.$month(),l.$year(),l.$wday(),l.$yday(),l.$isdst(),l.$zone()]}),O(v,"$to_f",function(){return this.getTime()/1e3}),O(v,"$to_i",function(){return parseInt(this.getTime()/1e3,10)}),O(v,"$cweek_cyear",function(){var f,l=this,p=I,m=I,C=I,ie=I;return f=X("Time").$new(l.$year(),1,1).$wday(),p=l.$year(),x(re(f,4))&&j(f,0)?m=Y(f,1):(m=Y(Y(f,7),1),z(m,-8)&&(m=-1)),C=N(U(l.$yday(),m),7).$ceil(),x(re(C,0))?X("Time").$new(Y(l.$year(),1),12,31).$cweek_cyear():(z(C,53)&&(ie=X("Time").$new(l.$year(),12,31).$wday(),x(re(ie,3))&&j(ie,0)&&(C=1,p=U(p,1))),[C,p])}),g=E.get_singleton_class(v),q(g,"mktime","local"),q(g,"utc","gm"),q(v,"ctime","asctime"),q(v,"dst?","isdst"),q(v,"getutc","getgm"),q(v,"gmtoff","gmt_offset"),q(v,"mday","day"),q(v,"month","mon"),q(v,"to_s","inspect"),q(v,"tv_sec","to_i"),q(v,"tv_usec","usec"),q(v,"utc","gmtime"),q(v,"utc?","gmt?"),q(v,"utc_offset","gmt_offset")}(0,Date)},Opal.modules["corelib/struct"]=function(E){var le=E.klass,_e=E.slice,d=E.extract_kwargs,H=E.ensure_kwargs,J=E.truthy,_=E.neqeq,w=E.eqeq,O=E.Opal,x=E.send,K=E.Class,V=E.to_a,A=E.def,U=E.defs,N=E.Kernel,Y=E.hash2,T=E.rb_gt,j=E.rb_minus,re=E.eqeqeq,z=E.rb_lt,q=E.rb_ge,Z=E.rb_plus,M=E.alias,L=E.nil,S=E.$$$;return E.top.$require("corelib/enumerable"),function(k,v,P){var B=le("::",null,"Struct"),te=[B].concat([]),D=E.$r(te);B.$include(S("Enumerable")),U(B,"$new",function R(F,g,l){var f,u,p,m,c=R.$$p||L,C=this,$=L;if(R.$$p=null,f=_e(arguments,1),u=d(f),u=H(u),p=f,null==(m=u.$$smap.keyword_init)&&(m=!1),J(F))if(w(F.$class(),S("String"))&&_(F["$[]"](0).$upcase(),F["$[]"](0)))p.$unshift(F),F=L;else try{F=O["$const_name!"](F)}catch(ie){if(!E.rescue(ie,[S("TypeError"),S("NameError")]))throw ie;try{p.$unshift(F),F=L}finally{E.pop_exception()}}return x(p,"map",[],function(se){return null==se&&(se=L),O["$coerce_to!"](se,S("String"),"to_str")}),$=x(K,"new",[C],function ie(){var Ee,se=ie.$$s??this;return x(p,"each",[],function Ee(Ie){return null==Ie&&(Ie=L),(Ee.$$s??this).$define_struct_attribute(Ie)},{$$s:se}),Ee=E.get_singleton_class(se),A(Ee,"$new",function(Me){var ye,he=this,Se=L;return ye=_e(arguments),(Se=he.$allocate()).$$data={},x(Se,"initialize",V(ye)),Se},-1),Ee.$alias_method("[]","new")},{$$s:C}),J(c)&&x($,"module_eval",[],c.$to_proc()),$.$$keyword_init=m,J(F)&&S("Struct").$const_set(F,$),$},-2),U(B,"$define_struct_attribute",function(F){var g=this;return w(g,S("Struct"))&&N.$raise(S("ArgumentError"),"you cannot define attributes to the Struct class"),g.$members()["$<<"](F),x(g,"define_method",[F],function l(){return(l.$$s??this).$$data[F]},{$$s:g}),x(g,"define_method",[F+"="],function l(c){return null==c&&(c=L),(l.$$s??this).$$data[F]=c},{$$s:g})}),U(B,"$members",function(){var g,F=this;return null==F.members&&(F.members=L),w(F,S("Struct"))&&N.$raise(S("ArgumentError"),"the Struct class has no members"),F.members=J(g=F.members)?g:[]}),U(B,"$inherited",function(F){var l,g=this;return null==g.members&&(g.members=L),l=g.members,x(F,"instance_eval",[],function c(){return(c.$$s??this).members=l},{$$s:g})}),A(B,"$initialize",function(F){var g,l,c=this,f=L,u=L,p=L;return g=_e(arguments),l=g,J(c.$class().$$keyword_init)?(f=J(u=l.$last())?u:Y([],{}),(J(T(l.$length(),1))||J(1===l.length&&!f.$$is_hash))&&N.$raise(S("ArgumentError"),"wrong number of arguments (given "+l.$length()+", expected 0)"),p=j(f.$keys(),c.$class().$members()),J(p["$any?"]())&&N.$raise(S("ArgumentError"),"unknown keywords: "+p.$join(", ")),x(c.$class().$members(),"each",[],function m(C){var $,ie=m.$$s??this;return null==C&&(C=L),$=[C,f["$[]"](C)],x(ie,"[]=",$),$[$.length-1]},{$$s:c})):(J(T(l.$length(),c.$class().$members().$length()))&&N.$raise(S("ArgumentError"),"struct size differs"),x(c.$class().$members(),"each_with_index",[],function m(C,$){var ie,se=m.$$s??this;return null==C&&(C=L),null==$&&($=L),ie=[C,l["$[]"]($)],x(se,"[]=",ie),ie[ie.length-1]},{$$s:c}))},-1),A(B,"$initialize_copy",function(F){this.$$data={};var c,f,u,l=Object.keys(F.$$data);for(c=0,f=l.length;c<f;c++)this.$$data[u=l[c]]=F.$$data[u]}),U(B,"$keyword_init?",function(){return this.$$keyword_init}),A(B,"$members",function(){return this.$class().$members()}),A(B,"$hash",function(){return D("Hash").$new(this.$$data).$hash()}),A(B,"$[]",function(F){var g=this;return re(S("Integer"),F)?(J(z(F,g.$class().$members().$size()["$-@"]()))&&N.$raise(S("IndexError"),"offset "+F+" too small for struct(size:"+g.$class().$members().$size()+")"),J(q(F,g.$class().$members().$size()))&&N.$raise(S("IndexError"),"offset "+F+" too large for struct(size:"+g.$class().$members().$size()+")"),F=g.$class().$members()["$[]"](F)):re(S("String"),F)?g.$$data.hasOwnProperty(F)||N.$raise(S("NameError").$new("no member '"+F+"' in struct",F)):N.$raise(S("TypeError"),"no implicit conversion of "+F.$class()+" into Integer"),F=O["$coerce_to!"](F,S("String"),"to_str"),g.$$data[F]}),A(B,"$[]=",function(F,g){var l=this;return re(S("Integer"),F)?(J(z(F,l.$class().$members().$size()["$-@"]()))&&N.$raise(S("IndexError"),"offset "+F+" too small for struct(size:"+l.$class().$members().$size()+")"),J(q(F,l.$class().$members().$size()))&&N.$raise(S("IndexError"),"offset "+F+" too large for struct(size:"+l.$class().$members().$size()+")"),F=l.$class().$members()["$[]"](F)):re(S("String"),F)?J(l.$class().$members()["$include?"](F.$to_sym()))||N.$raise(S("NameError").$new("no member '"+F+"' in struct",F)):N.$raise(S("TypeError"),"no implicit conversion of "+F.$class()+" into Integer"),F=O["$coerce_to!"](F,S("String"),"to_str"),l.$$data[F]=g}),A(B,"$==",function(F){if(!J(F["$instance_of?"](this.$class())))return!1;var l={},c={};return function f(u,p){var m,C,$;for(m in l[u.$__id__()]=!0,c[p.$__id__()]=!0,u.$$data)if(C=u.$$data[m],$=p.$$data[m],S("Struct")["$==="](C)){if(!(l.hasOwnProperty(C.$__id__())&&c.hasOwnProperty($.$__id__())||f(C,$)))return!1}else if(!C["$=="]($))return!1;return!0}(this,F)}),A(B,"$eql?",function(F){if(!J(F["$instance_of?"](this.$class())))return!1;var l={},c={};return function f(u,p){var m,C,$;for(m in l[u.$__id__()]=!0,c[p.$__id__()]=!0,u.$$data)if(C=u.$$data[m],$=p.$$data[m],S("Struct")["$==="](C)){if(!(l.hasOwnProperty(C.$__id__())&&c.hasOwnProperty($.$__id__())||f(C,$)))return!1}else if(!C["$eql?"]($))return!1;return!0}(this,F)}),A(B,"$each",function R(){var F=R.$$p||L,g=this;return R.$$p=null,F===L?x(g,"enum_for",["each"],function l(){return(l.$$s??this).$size()},{$$s:g}):(x(g.$class().$members(),"each",[],function l(c){return null==c&&(c=L),E.yield1(F,(l.$$s??this)["$[]"](c))},{$$s:g}),g)}),A(B,"$each_pair",function R(){var F=R.$$p||L,g=this;return R.$$p=null,F===L?x(g,"enum_for",["each_pair"],function l(){return(l.$$s??this).$size()},{$$s:g}):(x(g.$class().$members(),"each",[],function l(c){return null==c&&(c=L),E.yield1(F,[c,(l.$$s??this)["$[]"](c)])},{$$s:g}),g)}),A(B,"$length",function(){return this.$class().$members().$length()}),A(B,"$to_a",function(){return x(this.$class().$members(),"map",[],function g(l){return null==l&&(l=L),(g.$$s??this)["$[]"](l)},{$$s:this})});var fe=[];return A(B,"$inspect",function(){var F=this,g=L,l=L;return function(){try{return g="#<struct ",J(fe["$include?"](F.$__id__()))?Z(g,":...>"):(fe["$<<"](F.$__id__()),l=!0,re(S("Struct"),F)&&J(F.$class().$name())&&(g=Z(g,F.$class()+" ")),g=Z(g,x(F.$each_pair(),"map",[],function(f,u){return null==f&&(f=L),null==u&&(u=L),f+"="+D("Opal").$inspect(u)}).$join(", ")),g=Z(g,">"))}finally{J(l)&&fe.pop()}}()}),A(B,"$to_h",function R(){var F=R.$$p||L,g=this;return R.$$p=null,F!==L?x(x(g,"map",[],F.$to_proc()),"to_h",V(g.$args())):x(g.$class().$members(),"each_with_object",[Y([],{})],function l(c,f){var u;return null==c&&(c=L),null==f&&(f=L),u=[c,(l.$$s??this)["$[]"](c)],x(f,"[]=",u),u[u.length-1]},{$$s:g})}),A(B,"$values_at",function(F){var g,l,c=this;g=_e(arguments);for(var f=[],u=0,p=(l=x(l=g,"map",[],function(C){return null==C&&(C=L),C.$$is_range?C.$to_a():C}).$flatten()).length;u<p;u++)l[u].$$is_number||N.$raise(S("TypeError"),"no implicit conversion of "+l[u].$class()+" into Integer"),f.push(c["$[]"](l[u]));return f},-1),A(B,"$dig",function(F,g){var c,f=this,u=L;return c=_e(arguments,1),(u=J(F.$$is_string&&f.$$data.hasOwnProperty(F))&&f.$$data[F]||L)===L||0===c.length?u:(J(u["$respond_to?"]("dig"))||N.$raise(S("TypeError"),u.$class()+" does not have #dig method"),x(u,"dig",V(c)))},-2),M(B,"size","length"),M(B,"to_s","inspect"),M(B,"values","to_a")}()},Opal.modules["corelib/set"]=function(E){var le=E.freeze,_e=E.klass,d=E.slice,H=E.defs,J=E.hash2,_=E.truthy,w=E.eqeqeq,O=E.Kernel,x=E.send,K=E.def,V=E.eqeq,A=E.rb_lt,U=E.rb_le,N=E.alias,T=E.nil,j=E.$$$;return function(re,z,q){var Z=_e("::",null,"Set"),M=[Z].concat([]),I=E.$r(M);function S(k){_(k["$is_a?"](j("Set")))||O.$raise(j("ArgumentError"),"value must be a set")}return Z.$$prototype.hash=T,Z.$include(j("Enumerable")),H(Z,"$[]",function(v){var P,te=this;return P=d(arguments),te.$new(P)},-1),K(Z,"$initialize",function k(v){var P=k.$$p||T,B=this;return k.$$p=null,null==v&&(v=T),B.hash=J([],{}),_(v["$nil?"]())?T:(w(j("Enumerable"),v)||O.$raise(j("ArgumentError"),"value must be enumerable"),_(P)?x(v,"each",[],function te(D){return null==D&&(D=T),(te.$$s??this).$add(E.yield1(P,D))},{$$s:B}):B.$merge(v))},-1),K(Z,"$dup",function(){return this.$class().$new().$merge(this)}),K(Z,"$-",function(v){return _(v["$respond_to?"]("each"))||O.$raise(j("ArgumentError"),"value must be enumerable"),this.$dup().$subtract(v)}),K(Z,"$inspect",function(){return"#<Set: {"+this.$to_a().$join(",")+"}>"}),K(Z,"$==",function(v){var P=this;return!!_(P["$equal?"](v))||(_(v["$instance_of?"](P.$class()))?P.hash["$=="](v.$instance_variable_get("@hash")):!(!_(v["$is_a?"](j("Set")))||!V(P.$size(),v.$size()))&&x(v,"all?",[],function B(te){var D=B.$$s??this;return null==D.hash&&(D.hash=T),null==te&&(te=T),D.hash["$include?"](te)},{$$s:P}))}),K(Z,"$add",function(v){return this.hash["$[]="](v,!0),this}),K(Z,"$classify",function k(){var v=k.$$p||T,P=this,B=T;return k.$$p=null,v===T?P.$enum_for("classify"):(B=x(j("Hash"),"new",[],function te(D,fe){var R;return null==D&&(D=T),null==fe&&(fe=T),R=[fe,(te.$$s??this).$class().$new()],x(D,"[]=",R),R[R.length-1]},{$$s:P}),x(P,"each",[],function(D){return null==D&&(D=T),B["$[]"](E.yield1(v,D)).$add(D)}),B)}),K(Z,"$collect!",function k(){var v=k.$$p||T,P=this,B=T;return k.$$p=null,v===T?P.$enum_for("collect!"):(B=P.$class().$new(),x(P,"each",[],function(D){return null==D&&(D=T),B["$<<"](E.yield1(v,D))}),P.$replace(B))}),K(Z,"$compare_by_identity",function(){var v=this;return _(v.hash["$respond_to?"]("compare_by_identity"))?(v.hash.$compare_by_identity(),v):v.$raise(I("NotImplementedError"),v.$class().$name()+"#compare_by_identity is not implemented")}),K(Z,"$compare_by_identity?",function(){var P;return _(P=this.hash["$respond_to?"]("compare_by_identity?"))?this.hash["$compare_by_identity?"]():P}),K(Z,"$delete",function(v){return this.hash.$delete(v),this}),K(Z,"$delete?",function(v){var P=this;return _(P["$include?"](v))?(P.$delete(v),P):T}),K(Z,"$delete_if",function k(){var v=k.$$p||T,P=this;return k.$$p=null,v===T?P.$enum_for("delete_if"):(x(x(P,"select",[],function(te){return null==te&&(te=T),E.yield1(v,te)}),"each",[],function B(te){var D=B.$$s??this;return null==D.hash&&(D.hash=T),null==te&&(te=T),D.hash.$delete(te)},{$$s:P}),P)}),K(Z,"$freeze",function(){var v=this;return _(v["$frozen?"]())?v:(v.hash.$freeze(),le(v))}),K(Z,"$keep_if",function k(){var v=k.$$p||T,P=this;return k.$$p=null,v===T?P.$enum_for("keep_if"):(x(x(P,"reject",[],function(te){return null==te&&(te=T),E.yield1(v,te)}),"each",[],function B(te){var D=B.$$s??this;return null==D.hash&&(D.hash=T),null==te&&(te=T),D.hash.$delete(te)},{$$s:P}),P)}),K(Z,"$reject!",function k(){var v=k.$$p||T,P=this,B=T;return k.$$p=null,v===T?P.$enum_for("reject!"):(B=P.$size(),x(P,"delete_if",[],v.$to_proc()),V(P.$size(),B)?T:P)}),K(Z,"$select!",function k(){var v=k.$$p||T,P=this,B=T;return k.$$p=null,v===T?P.$enum_for("select!"):(B=P.$size(),x(P,"keep_if",[],v.$to_proc()),V(P.$size(),B)?T:P)}),K(Z,"$add?",function(v){return _(this["$include?"](v))?T:this.$add(v)}),K(Z,"$each",function k(){var v=k.$$p||T,P=this;return k.$$p=null,v===T?P.$enum_for("each"):(x(P.hash,"each_key",[],v.$to_proc()),P)}),K(Z,"$empty?",function(){return this.hash["$empty?"]()}),K(Z,"$eql?",function(v){return this.hash["$eql?"](x(v,"instance_eval",[],function B(){var te=B.$$s??this;return null==te.hash&&(te.hash=T),te.hash},{$$s:this}))}),K(Z,"$clear",function(){return this.hash.$clear(),this}),K(Z,"$include?",function(v){return this.hash["$include?"](v)}),K(Z,"$merge",function(v){return x(v,"each",[],function B(te){return null==te&&(te=T),(B.$$s??this).$add(te)},{$$s:this}),this}),K(Z,"$replace",function(v){var P=this;return P.$clear(),P.$merge(v),P}),K(Z,"$size",function(){return this.hash.$size()}),K(Z,"$subtract",function(v){return x(v,"each",[],function B(te){return null==te&&(te=T),(B.$$s??this).$delete(te)},{$$s:this}),this}),K(Z,"$|",function(v){return _(v["$respond_to?"]("each"))||O.$raise(j("ArgumentError"),"value must be enumerable"),this.$dup().$merge(v)}),K(Z,"$superset?",function(v){return S(v),!_(A(this.$size(),v.$size()))&&x(v,"all?",[],function B(te){return null==te&&(te=T),(B.$$s??this)["$include?"](te)},{$$s:this})}),K(Z,"$proper_superset?",function(v){return S(v),!_(U(this.$size(),v.$size()))&&x(v,"all?",[],function B(te){return null==te&&(te=T),(B.$$s??this)["$include?"](te)},{$$s:this})}),K(Z,"$subset?",function(v){return S(v),!_(A(v.$size(),this.$size()))&&x(this,"all?",[],function(te){return null==te&&(te=T),v["$include?"](te)})}),K(Z,"$proper_subset?",function(v){return S(v),!_(U(v.$size(),this.$size()))&&x(this,"all?",[],function(te){return null==te&&(te=T),v["$include?"](te)})}),K(Z,"$intersect?",function(v){var P=this;return S(v),_(A(P.$size(),v.$size()))?x(P,"any?",[],function(te){return null==te&&(te=T),v["$include?"](te)}):x(v,"any?",[],function B(te){return null==te&&(te=T),(B.$$s??this)["$include?"](te)},{$$s:P})}),K(Z,"$disjoint?",function(v){return this["$intersect?"](v)["$!"]()}),K(Z,"$to_a",function(){return this.hash.$keys()}),N(Z,"+","|"),N(Z,"<","proper_subset?"),N(Z,"<<","add"),N(Z,"<=","subset?"),N(Z,">","proper_superset?"),N(Z,">=","superset?"),N(Z,"difference","-"),N(Z,"filter!","select!"),N(Z,"length","size"),N(Z,"map!","collect!"),N(Z,"member?","include?"),N(Z,"union","|")}()},Opal.modules["corelib/dir"]=function(E){var U,V,_e=E.def,d=E.truthy,H=E.alias,_=E.nil,w=E.$$$;return[V=(0,E.klass)("::",null,"Dir")].concat([]),U=E.get_singleton_class(V),_e(U,"$chdir",function Y(T){var j=Y.$$p||_,re=_;return Y.$$p=null,function(){try{return re=E.current_dir,E.current_dir=T,E.yieldX(j,[])}finally{E.current_dir=re}}()}),_e(U,"$pwd",function(){return E.current_dir||"."}),_e(U,"$home",function(){var T;return d(T=w("ENV")["$[]"]("HOME"))?T:"."}),H(U,"getwd","pwd")},Opal.modules["corelib/file"]=function(E){var Z,M,I,X,le=E.truthy,d=E.const_set,H=E.Opal,J=E.regexp,_=E.rb_plus,w=E.def,O=E.Kernel,x=E.eqeq,K=E.rb_lt,V=E.rb_minus,A=E.range,U=E.send,N=E.slice,Y=E.alias,j=E.nil,re=E.$$$;return Z=[],I=[M=(0,E.klass)("::",re("IO"),"File")].concat(Z),X=j,d(I[0],"Separator",d(I[0],"SEPARATOR","/")),d(I[0],"ALT_SEPARATOR",j),d(I[0],"PATH_SEPARATOR",":"),d(I[0],"FNM_SYSCASE",0),X=/^[a-zA-Z]:(?:\\|\/)/,function(L,S){var k=[L].concat(S),v=E.$r(k);function P(te){return le(te["$respond_to?"]("to_path"))&&(te=te.$to_path()),H["$coerce_to!"](te,re("String"),"to_str")}function B(){return v("ALT_SEPARATOR")===j?E.escape_regexp(v("SEPARATOR")):E.escape_regexp(_(v("SEPARATOR"),v("ALT_SEPARATOR")))}return w(L,"$absolute_path",function(D,fe){var R,F,l,c,f,g=j,u=j,p=j,m=j,C=j;null==fe&&(fe=j),R=v("SEPARATOR"),F=B(),g=[],D=le(D["$respond_to?"]("to_path"))?D.$to_path():D,D=H["$coerce_to!"](D,re("String"),"to_str"),fe=le(l=fe)?l:re("Dir").$pwd(),c=D.substr(0,R.length)===R||X.test(D),f=fe.substr(0,R.length)===R||X.test(fe),le(c)?(u=D.$split(J(["[",F,"]"])),p=X.test(D)?"":D.$sub(J(["^([",F,"]+).*$"]),"\\1"),m=!0):(u=_(fe.$split(J(["[",F,"]"])),D.$split(J(["[",F,"]"]))),p=X.test(fe)?"":fe.$sub(J(["^([",F,"]+).*$"]),"\\1"),m=f);for(var $,ie=0,se=u.length;ie<se;ie++)($=u[ie])!==j&&(""!==$||0!==g.length&&!m)&&("."!==$||0!==g.length&&!m)&&(".."===$?g.pop():g.push($));return!m&&"."!==u[0]&&g.$unshift("."),C=g.$join(R),le(m)&&(C=_(p,C)),C},-2),w(L,"$expand_path",function(D,fe){var F,g,l=j,c=j,f=j;return null==fe&&(fe=j),F=v("SEPARATOR"),g=B(),le("~"===D[0]||fe&&"~"===fe[0])&&(l=v("Dir").$home(),le(l)||O.$raise(re("ArgumentError"),"couldn't find HOME environment -- expanding `~'"),c=X.test(l)?"":l.$sub(J(["^([",g,"]+).*$"]),"\\1"),le(l["$start_with?"](c))||O.$raise(re("ArgumentError"),"non-absolute home"),l=_(l,F),f=J(["^\\~(?:",F,"|$)"]),D=D.$sub(f,l),le(fe)&&(fe=fe.$sub(f,l))),this.$absolute_path(D,fe)},-2),w(L,"$dirname",function(D,fe){var F;if(null==fe&&(fe=1),x(fe,0))return D;le(K(fe,0))&&O.$raise(re("ArgumentError"),"level can't be negative"),F=B();var l,g=(D=P(D)).match(new RegExp("^["+F+"]"));return l=""===(D=(D=(D=D.replace(new RegExp("["+F+"]+$"),"")).replace(new RegExp("[^"+F+"]+$"),"")).replace(new RegExp("["+F+"]+$"),""))?g?"/":".":D,1==fe?l:this.$dirname(l,V(fe,1))},-2),w(L,"$basename",function(D,fe){var R;return null==fe&&(fe=j),R=B(),0==(D=P(D)).length||(fe=fe!==j?H["$coerce_to!"](fe,re("String"),"to_str"):null,D=(D=D.replace(new RegExp("(.)["+R+"]*$"),"$1")).replace(new RegExp("^(?:.*["+R+"])?([^"+R+"]+)$"),"$1"),".*"===fe?D=D.replace(/\.[^\.]+$/,""):null!==fe&&(fe=E.escape_regexp(fe),D=D.replace(new RegExp(fe+"$"),""))),D},-2),w(L,"$extname",function(D){var R=j,F=j;return D=P(D),R=this.$basename(D),le(R["$empty?"]())||(F=R["$[]"](A(1,-1,!1)).$rindex("."),le(F["$nil?"]())||x(_(F,1),V(R.$length(),1)))?"":R["$[]"](E.Range.$new(_(F,1),-1,!1))}),w(L,"$exist?",function(D){return null!=E.modules[D]}),w(L,"$directory?",function(D){var fe=j;for(var R in fe=[],E.modules)fe.push(R);return D=D.$gsub(J(["(^.",v("SEPARATOR"),"+|",v("SEPARATOR"),"+$)"])),U(fe,"find",[],function(g){return null==g&&(g=j),g["$=~"](J(["^",D]))})}),w(L,"$join",function(D){var fe,R,F=j;return fe=N(arguments),le((R=fe)["$empty?"]())?"":(F="",R=U(R.$flatten().$each_with_index(),"map",[],function(l,c){return null==l&&(l=j),null==c&&(c=j),x(c,0)&&le(l["$empty?"]())||x(R.$length(),_(c,1))&&le(l["$empty?"]())?v("SEPARATOR"):l}),R=U(R,"reject",[],"empty?".$to_proc()),U(R,"each_with_index",[],function(l,c){var f=j;return null==l&&(l=j),null==c&&(c=j),f=R["$[]"](_(c,1)),le(f["$nil?"]())?F=""+F+l:(le(l["$end_with?"](v("SEPARATOR")))&&le(f["$start_with?"](v("SEPARATOR")))&&(l=l.$sub(J([v("SEPARATOR"),"+$"]),"")),F=le(l["$end_with?"](v("SEPARATOR")))||le(f["$start_with?"](v("SEPARATOR")))?""+F+l:""+F+l+v("SEPARATOR"))}),F)},-1),w(L,"$split",function(D){return D.$split(v("SEPARATOR"))}),Y(L,"realpath","expand_path"),Y(L,"exists?","exist?")}(E.get_singleton_class(M),I)},Opal.modules["corelib/process/base"]=function(E){var O,le=E.klass,_e=E.slice,d=E.defs,H=E.return_val,J=E.nil;return O=le("::",null,"Signal"),d(O,"$trap",function(K){return _e(arguments),J},-1),function(_,w){var O=le("::",null,"GC");return d(O,"$start",H(J))}()},Opal.modules["corelib/process"]=function(E){var le=E.module,_e=E.defs,d=E.truthy,H=E.return_val,J=E.Kernel,_=E.nil,w=E.$$$;return function(O){var x=le("::","Process"),K=_;if(x.__clocks__=[],_e(x,"$__register_clock__",function(U,N){var Y=this;return null==Y.__clocks__&&(Y.__clocks__=_),Y.$const_set(U,Y.__clocks__.$size()),Y.__clocks__["$<<"](N)}),x.$__register_clock__("CLOCK_REALTIME",function(){return Date.now()}),K=!1,E.global.performance)K=function(){return performance.now()};else if(E.global.process&&process.hrtime){var V=process.hrtime();K=function(){var A=process.hrtime(V);return 1e3*A[0]+(A[1]/1e3|0)/1e3}}return d(K)&&x.$__register_clock__("CLOCK_MONOTONIC",K),_e(x,"$pid",H(0)),_e(x,"$times",function(){var U;return U=w("Time").$now().$to_f(),w(w("Benchmark"),"Tms").$new(U,U,U,U,U)}),_e(x,"$clock_gettime",function(U,N){var Y=this,j=_;null==Y.__clocks__&&(Y.__clocks__=_),null==N&&(N="float_second"),d(j=Y.__clocks__["$[]"](U))||J.$raise(w(w("Errno"),"EINVAL"),"clock_gettime("+U+") "+Y.__clocks__["$[]"](U));var re=j();switch(N){case"float_second":return re/1e3;case"float_millisecond":return re/1;case"float_microsecond":return 1e3*re;case"second":return re/1e3|0;case"millisecond":return re/1|0;case"microsecond":return 1e3*re|0;case"nanosecond":return 1e6*re|0;default:J.$raise(w("ArgumentError"),"unexpected unit: "+N)}},-2)}()},Opal.modules["corelib/random/formatter"]=function(E){var N,re,z,q,Z,Y,_e=E.module,d=E.def,H=E.range,J=E.send,_=E.rb_divide,w=E.Kernel,O=E.Opal,K=E.nil,V=E.$$$;return N=[],re=[Y=(0,E.klass)("::",null,"Random")].concat(N),q=[z=_e(Y,"Formatter")].concat(re),Z=E.$r(q),d(z,"$hex",function(I){null==I&&(I=K),I=V("Random").$_verify_count(I);for(var L=this.$bytes(I),S="",k=0;k<I;k++)S+=L.charCodeAt(k).toString(16).padStart(2,"0");return S.$encode("US-ASCII")},-1),d(z,"$random_bytes",function(I){return null==I&&(I=K),this.$bytes(I)},-1),d(z,"$base64",function(I){return null==I&&(I=K),V("Base64").$strict_encode64(this.$random_bytes(I)).$encode("US-ASCII")},-1),d(z,"$urlsafe_base64",function(I,X){return null==I&&(I=K),null==X&&(X=!1),V("Base64").$urlsafe_encode64(this.$random_bytes(I),X).$encode("US-ASCII")},-1),d(z,"$uuid",function(){var X=K;return(X=this.$hex(16).$split(""))["$[]="](12,"4"),X["$[]="](16,(3&parseInt(X["$[]"](16),16)|8).toString(16)),X=[X["$[]"](H(0,8,!0)),X["$[]"](H(8,12,!0)),X["$[]"](H(12,16,!0)),X["$[]"](H(16,20,!0)),X["$[]"](H(20,32,!0))],(X=J(X,"map",[],"join".$to_proc())).$join("-")}),d(z,"$random_float",function(){var X=K,L=K;return X=this.$bytes(4),L=0,J(4,"times",[],function(k){return null==k&&(k=K),L=(L=L["$<<"](8))["$|"](X["$[]"](k).$ord())}),_(L.$abs(),2147483647)}),d(z,"$random_number",function(I){var X=this;function L(){return X.$random_float()}function S(v){return Math.floor(L()*v)}return null==I?L():I.$$is_range?function k(){var v=I.begin,P=I.end;if(v===K||P===K)return K;var B=P-v;return B<0?K:0===B?v:(P%1==0&&v%1==0&&!I.excl&&B++,S(B)+v)}():I.$$is_number?(I<=0&&w.$raise(V("ArgumentError"),"invalid argument - "+I),I%1==0?S(I):L()*I):((I=O["$coerce_to!"](I,V("Integer"),"to_int"))<=0&&w.$raise(V("ArgumentError"),"invalid argument - "+I),S(I))},-1),d(z,"$alphanumeric",function(I){var L=K;return null==I&&(I=K),I=Z("Random").$_verify_count(I),L=J([H("0","9",!1),H("a","z",!1),H("A","Z",!1)],"map",[],"to_a".$to_proc()).$flatten(),J(V("Array"),"new",[I],function S(k){return null==k&&(k=K),L["$[]"]((S.$$s??this).$random_number(L.$length()))},{$$s:this}).$join()},-1),Y.$include(V(V("Random"),"Formatter")),Y.$extend(V(V("Random"),"Formatter"))},Opal.modules["corelib/random/mersenne_twister"]=function(E){var K,x,V,le=E.klass,_e=E.const_set,d=E.send,J=E.$$$,_=E.nil;return _=function(){var w=624,O=397,U=function(q,Z){return function(q,Z){return 2147483648&q|2147483647&Z}(q,Z)>>>1^(1&Z?2567483615:0)};function j(q){var Z;return--q.left<=0&&function T(q){var I,Z=0,M=q.state;for(q.left=w,q.next=0,I=228;--I;Z++)M[Z]=M[Z+O]^U(M[Z+0],M[Z+1]);for(I=O;--I;Z++)M[Z]=M[Z+(O-w)]^U(M[Z+0],M[Z+1]);M[Z]=M[Z+(O-w)]^U(M[Z+0],M[0])}(q),Z=q.state[q.next++],Z^=Z>>>11,Z^=Z<<7&2636928640,Z^=Z<<15&4022730752,(Z^=Z>>>18)>>>0}return{genrand_real:function z(q){return function re(q,Z){return(67108864*(q>>>=5)+(Z>>>=6))*(1/9007199254740992)}(j(q),j(q))},init:function N(q){var Z={left:0,next:w,state:new Array(w)};return function Y(q,Z){var M;for(q.state[0]=Z>>>0,M=1;M<w;M++)q.state[M]=1812433253*(q.state[M-1]^q.state[M-1]>>30>>>0)+M,q.state[M]&=4294967295;q.left=1,q.next=w}(Z,q),Z}}}(),x=le("::",null,"Random"),V=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1,_e(x,"MERSENNE_TWISTER_GENERATOR",{new_seed:function(){return Math.round(Math.random()*V)},reseed:function(A){return _.init(A)},rand:function(A){return _.genrand_real(A)}}),d(x,"generator=",K=[J(x,"MERSENNE_TWISTER_GENERATOR")]),K[K.length-1]},Opal.modules["corelib/random"]=function(E){var N,le=E.truthy,_e=E.klass,d=E.Kernel,H=E.defs,J=E.Opal,_=E.def,w=E.eqeqeq,O=E.send,x=E.top,K=E.nil,V=E.$$$;return x.$require("corelib/random/formatter"),(N=_e("::",null,"Random")).$attr_reader("seed","state"),H(N,"$_verify_count",function(T){return le(T)||(T=16),"number"!=typeof T&&(T=T.$to_int()),T<0&&d.$raise(V("ArgumentError"),"negative string size (or size too big)"),Math.floor(T)}),_(N,"$initialize",function(T){return null==T&&(T=V("Random").$new_seed()),T=J["$coerce_to!"](T,V("Integer"),"to_int"),this.state=T,this.$reseed(T)},-1),_(N,"$reseed",function(T){return this.seed=T,this.$rng=E.$$rand.reseed(T)}),H(N,"$new_seed",function(){return E.$$rand.new_seed()}),H(N,"$rand",function(T){return V(this,"DEFAULT").$rand(T)},-1),H(N,"$srand",function(T){var re;return null==T&&(T=V("Random").$new_seed()),T=J["$coerce_to!"](T,V("Integer"),"to_int"),re=V(this,"DEFAULT").$seed(),V(this,"DEFAULT").$reseed(T),re},-1),H(N,"$urandom",function(T){return V("SecureRandom").$bytes(T)}),_(N,"$==",function(T){var re=K;return!!w(V("Random"),T)&&(le(re=this.$seed()["$=="](T.$seed()))?this.$state()["$=="](T.$state()):re)}),_(N,"$bytes",function(T){return T=V("Random").$_verify_count(T),O(V("Array"),"new",[T],function re(){return(re.$$s??this).$rand(255).$chr()},{$$s:this}).$join().$encode("ASCII-8BIT")}),H(N,"$bytes",function(T){return V(this,"DEFAULT").$bytes(T)}),_(N,"$rand",function(T){return this.$random_number(T)},-1),_(N,"$random_float",function(){return this.state++,E.$$rand.rand(this.$rng)}),H(N,"$random_float",function(){return V(this,"DEFAULT").$random_float()}),H(N,"$generator=",function(T){var j=this;return E.$$rand=T,le(j["$const_defined?"]("DEFAULT"))?V(j,"DEFAULT").$reseed():j.$const_set("DEFAULT",j.$new(j.$new_seed()))}),x.$require("corelib/random/mersenne_twister")},Opal.modules["corelib/unsupported"]=function(E){var re,z,q,le=E.Kernel,_e=E.klass,d=E.send,H=E.slice,J=E.module,_=E.def,w=E.return_val,O=E.alias,x=E.defs,K=E.top,A=E.nil,U=E.$$$,N={};function Y(j){switch(E.config.unsupported_features_severity){case"error":le.$raise(U("NotImplementedError"),j);break;case"warning":!function T(j){N[j]||(N[j]=!0,K.$warn(j))}(j)}}return z=_e("::",null,"String"),q="String#%s not supported. Mutable String methods are not supported in Opal.",d(["<<","capitalize!","chomp!","chop!","downcase!","gsub!","lstrip!","next!","reverse!","slice!","squeeze!","strip!","sub!","succ!","swapcase!","tr!","tr_s!","upcase!","prepend","[]=","clear","encode!","unicode_normalize!"],"each",[],function Z(M){return null==M&&(M=A),d(Z.$$s??this,"define_method",[M],function(L){return H(arguments),le.$raise(U("NotImplementedError"),q["$%"](M))},-1)},{$$s:z}),function(j){var re=J("::","Kernel"),z="Object tainting is not supported by Opal";_(re,"$taint",function(){return Y(z),this}),_(re,"$untaint",function(){return Y(z),this}),_(re,"$tainted?",function(){return Y(z),!1})}(),function(j,re){var z=_e("::",null,"Module");_(z,"$public",function(Z){var I,X=this;return 0===(I=H(arguments)).length?(X.$$module_function=!1,A):1===I.length?I[0]:I},-1),_(z,"$private_class_method",function(Z){var I;return 1===(I=H(arguments)).length?I[0]:I},-1),_(z,"$private_method_defined?",w(!1)),_(z,"$private_constant",function(Z){return H(arguments),A},-1),O(z,"nesting","public"),O(z,"private","public"),O(z,"protected","public"),O(z,"protected_method_defined?","private_method_defined?"),O(z,"public_class_method","private_class_method"),O(z,"public_instance_method","instance_method"),O(z,"public_instance_methods","instance_methods"),O(z,"public_method_defined?","method_defined?")}(),re=J("::","Kernel"),_(re,"$private_methods",function(q){return H(arguments),[]},-1),O(re,"protected_methods","private_methods"),O(re,"private_instance_methods","private_methods"),O(re,"protected_instance_methods","private_methods"),function(j,re){var z=J("::","Kernel"),q=[z].concat([]),Z=E.$r(q);_(z,"$eval",function(I){return H(arguments),le.$raise(U("NotImplementedError"),"To use Kernel#eval, you must first require 'opal-parser'. See https://github.com/opal/opal/blob/"+Z("RUBY_ENGINE_VERSION")+"/docs/opal_parser.md for details.")},-1)}(),x(K,"$public",function(re){var q;return 1===(q=H(arguments)).length?q[0]:q},-1),x(K,"$private",function(re){var q;return 1===(q=H(arguments)).length?q[0]:q},-1)},Opal.modules["corelib/binding"]=function(E){var z,q,_e=E.truthy,d=E.def,H=E.slice,J=E.send,_=E.to_a,w=E.Kernel,O=E.return_ivar,x=E.eqeq,K=E.thrower,V=E.module,A=E.const_set,U=E.top,Y=E.nil,T=E.$$$;return(q=(z=(0,E.klass)("::",null,"Binding")).$$prototype).jseval=q.scope_variables=Y,d(z,"$initialize",function(M,I,X,L){var S,k=this;return null==I&&(I=[]),null==L&&(L=Y),k.jseval=(S=[M,I,X,L])[0],k.scope_variables=S[1],k.receiver=S[2],k.source_location=S[3],_e(void 0!==typeof X)?Y:X=k.$js_eval("self")},-2),d(z,"$js_eval",function(M){var X,L=this;return X=H(arguments),_e(L.jseval)?J(L.jseval,"call",_(X)):w.$raise("Evaluation on a Proc#binding is not supported")},-1),d(z,"$local_variable_get",function(M){try{return this.$js_eval(M)}catch(X){if(!E.rescue(X,[T("Exception")]))throw X;try{return w.$raise(T("NameError"),"local variable `"+M+"' is not defined for "+this.$inspect())}finally{E.pop_exception()}}}),d(z,"$local_variable_set",function(M,I){return E.Binding.tmp_value=I,this.$js_eval(M+" = Opal.Binding.tmp_value"),delete E.Binding.tmp_value,I}),d(z,"$local_variables",O("scope_variables")),d(z,"$local_variable_defined?",function(M){return this.scope_variables["$include?"](M)}),d(z,"$eval",function(M,I,X){try{return K("eval_return"),null==I&&(I=Y),null==X&&(X=Y),x(M,"self")?this.$receiver():w.$eval(M,this,I,X)}catch(k){if(k===E.t_eval_return)return k.$v;throw k}},-2),z.$attr_reader("receiver","source_location"),d(V("::","Kernel"),"$binding",function(){return w.$raise("Opal doesn't support dynamic calls to binding")}),A([][0],"TOPLEVEL_BINDING",T("Binding").$new(function(j){return new Function("self","return "+j)(U)},[],U,["<main>",0]))},Opal.modules["corelib/irb"]=function(E){var Z,L,te,D,S,k,v,I,le=E.module,_e=E.truthy,d=E.Kernel,H=E.defs,J=E.hash,_=E.gvars,w=E.lambda,O=E.send,x=E.rb_plus,K=E.const_set,V=E.klass,A=E.def,U=E.Opal,N=E.range,Y=E.eqeq,T=E.thrower,j=[],re=E.nil,z=E.$$$;Z=j,L=I=[le(j[0],"Opal")].concat(Z),k=[S=le(I[0],"IRB")].concat(L),v=E.$r(k),H(S,"$ensure_loaded",function(B){var D,fe;if(_e(E.loaded_features["$include?"](B)))return re;if(D="https://cdn.opalrb.com/opal/"+(_e(v("RUBY_ENGINE_VERSION")["$include?"]("dev"))?"master":v("RUBY_ENGINE_VERSION"))+"/"+B+".js",typeof XMLHttpRequest<"u"){var R=new XMLHttpRequest;R.open("GET",D,!1),R.send(""),fe=R.responseText}else d.$raise("You need to provision "+B+" yourself in this environment");return new Function("Opal",fe)(E),E.require(B),_e(E.loaded_features["$include?"](B))?re:d.$raise("Could not load "+B+" for some reason")}),S.$singleton_class().$attr_accessor("output"),H(S,"$prepare_console",function P(){var B=P.$$p||re,D=this,fe=re,R=re;return null==_.stdout&&(_.stdout=re),null==_.stderr&&(_.stderr=re),null==_.stdin&&(_.stdin=re),P.$$p=null,function(){try{return D["$output="](""),fe=J(_.stdout,w(function(g){return null==g&&(g=re),_.stdout=g}),_.stderr,w(function(g){return null==g&&(g=re),_.stderr=g})),_e(D["$browser?"]())&&(O(fe,"each",[],function F(g,l){var c=F.$$s??this,f=re;return null==g&&(g=re),null==l&&(l=re),(f=g.$dup())["$write_proc="](O(c,"proc",[],function u(p){var m=u.$$s??this;return null==p&&(p=re),m["$output="](x(m.$output(),p)),m["$output="](m.$output().$split("\n").$last(30).$join("\n")),_e(p["$end_with?"]("\n"))&&m["$output="](x(m.$output(),"\n")),g.$write_proc().$call(p)},{$$s:c})),f["$tty="](!1),l.$call(f)},{$$s:D}),R=_.stdin.$read_proc(),_.stdin["$read_proc="](function(F){var g=prompt(D.$output());return null!==g?g+"\n":re})),E.yieldX(B,[])}finally{O(fe,"each",[],function(g,l){return null==g&&(g=re),null==l&&(l=re),l.$call(g)}),O(_.stdin,"read_proc=",[R]),O(D,"output=",[""])}}()}),H(S,"$browser?",function(){return typeof document<"u"&&typeof prompt<"u"}),K(k[0],"LINEBREAKS",["unexpected token $end","unterminated string meets end of file"].$freeze()),(D=(te=V(k[0],null,"Silencer")).$$prototype).collector=D.stderr=re,A(te,"$initialize",function(){return null==_.stderr&&(_.stderr=re),this.stderr=_.stderr}),A(te,"$silence",function fe(){var R=fe.$$p||re,F=this;return fe.$$p=null,function(){try{return F.collector=z("StringIO").$new(),_.stderr=F.collector,E.yieldX(R,[])}finally{_.stderr=F.stderr}}()}),A(te,"$warnings",function(){return this.collector.$string()}),function(q,Z,M){var I=V("::",null,"Binding"),X=[I].concat(M),L=E.$r(X);A(I,"$irb",function(){try{var k=T("return"),P=re;return z(U,"IRB").$ensure_loaded("opal-replutils"),P=z(z(U,"IRB"),"Silencer").$new(),O(z(U,"IRB"),"prepare_console",[],function B(){var te=B.$$s??this;return function(){try{var D=T("break");return O(te,"loop",[],function fe(){var R=fe.$$s??this,F=re,g=re,l=re,c=re,f=re;for(R.$print(">> "),F=R.$gets(),_e(F)||D.$throw(),g="",_e(z(U,"IRB")["$browser?"]())&&R.$puts(F),_e(F["$start_with?"]("ls "))?(g=F["$[]"](N(3,-1,!1)),l="ls"):Y(F,"ls\n")?(g="self",l="ls"):_e(F["$start_with?"]("show "))?(g=F["$[]"](N(5,-1,!1)),l="show"):(g=F,l="inspect"),c=re;;){try{O(P,"silence",[],function(){return c=E.compile(g,{irb:!0})})}catch(u){if(!E.rescue(u,[L("SyntaxError")]))throw u;f=u;try{if(_e(z(z(U,"IRB"),"LINEBREAKS")["$include?"](f.$message()))){R.$print(".. "),F=R.$gets(),_e(F)||k.$throw(),_e(z(U,"IRB")["$browser?"]())&&R.$puts(F),g=x(g,F);continue}_e(P.$warnings()["$empty?"]())?R.$warn(f.$full_message()):R.$warn(P.$warnings())}finally{E.pop_exception()}}break}return Y(l,"show")&&(R.$puts(c),k.$throw()),R.$puts(z("REPLUtils").$eval_and_print(c,l,!1,R))},{$$s:te,$$ret:k})}catch(fe){if(fe===D)return fe.$v;throw fe}}()},{$$s:this})}catch(B){if(B===k)return B.$v;throw B}})}(0,0,j),E.irb=function(q){z("Binding").$new(q).$irb()},E.load_parser=function(){E.Opal.IRB.$ensure_loaded("opal-parser")},typeof E.eval>"u"&&(E.eval=function(q){return E.load_parser(),E.eval(q)}),typeof E.compile>"u"&&(E.compile=function(q,Z){return E.load_parser(),E.compile(q,Z)})},Opal.queue(function(E){var le=E.Object;return le.$require("opal/base"),le.$require("opal/mini"),le.$require("corelib/kernel/format"),le.$require("corelib/string/encoding"),le.$autoload("Math","corelib/math"),le.$require("corelib/complex/base"),le.$autoload("Complex","corelib/complex"),le.$require("corelib/rational/base"),le.$autoload("Rational","corelib/rational"),le.$require("corelib/time"),le.$autoload("Struct","corelib/struct"),le.$autoload("Set","corelib/set"),le.$autoload("Dir","corelib/dir"),le.$autoload("File","corelib/file"),le.$require("corelib/process/base"),le.$autoload("Process","corelib/process"),le.$autoload("Random","corelib/random"),le.$require("corelib/unsupported"),le.$require("corelib/binding"),le.$require("corelib/irb")}),Opal.queue(function(E){var B,F,g,l,c,te,D,fe,le=E.module,_e=E.defs,d=E.slice,H=E.truthy,J=E.send,_=E.Kernel,w=E.extract_kwargs,O=E.ensure_kwargs,x=E.range,K=E.to_a,V=E.def,A=E.return_ivar,U=E.alias,N=E.klass,Y=E.rb_minus,T=E.return_val,j=E.hash2,re=E.send2,z=E.find_super,q=E.eqeqeq,Z=E.rb_ge,M=E.return_self,I=E.gvars,X=E.top,L=[],S=E.$r(L),k=E.nil,v=E.$$$;return B=L,D=[te=le(L[0],"Native")].concat(B),fe=E.$r(D),_e(te,"$is_a?",function(F,g){try{return F instanceof this.$try_convert(g)}catch{return!1}}),_e(te,"$try_convert",function(F,g){return null==g&&(g=k),this["$native?"](F)?F:F["$respond_to?"]("to_n")?F.$to_n():g},-2),_e(te,"$convert",function(F){return this["$native?"](F)?F:F["$respond_to?"]("to_n")?F.$to_n():void this.$raise(fe("ArgumentError"),F.$inspect()+" isn't native")}),_e(te,"$call",function R(F,g,l){var u,c=R.$$p||k,p=this;R.$$p=null,u=d(arguments,2);var m=F[g];if(m instanceof Function){for(var C=new Array(u.length),$=0,ie=u.length;$<ie;$++){var se=u[$],Ee=p.$try_convert(se);C[$]=Ee===k?se:Ee}return c!==k&&C.push(c),p.$Native(m.apply(F,C))}return p.$Native(m)},-3),_e(te,"$proc",function R(){var F=R.$$p||k;return R.$$p=null,H(F)||this.$raise(fe("LocalJumpError"),"no block given"),J(_,"proc",[],function l(c){var f,u,p=l.$$s??this,m=k;if(f=d(arguments),J(u=f,"map!",[],function $(ie){return null==ie&&(ie=k),($.$$s??this).$Native(ie)},{$$s:p}),m=p.$Native(this),this===E.global)return F.apply(p,u);var C=F.$$s;F.$$s=null;try{return F.apply(m,u)}finally{F.$$s=C}},{$$arity:-1,$$s:this})}),F=D,l=[g=le(D[0],"Helpers")].concat(F),c=E.$r(l),V(g,"$alias_native",function f(u,p,m){var C,$,ie,se,Ie=this;return f.$$p=null,C=d(arguments,1),$=w(C),$=O($),C.length>0&&(ie=C.shift()),null==ie&&(ie=u),null==(se=$.$$smap.as)&&(se=k),H(ie["$end_with?"]("="))?J(Ie,"define_method",[u],function ce(Me){var $e=ce.$$s??this;return null==$e.native&&($e.native=k),null==Me&&(Me=k),$e.native[ie["$[]"](x(0,-2,!1))]=c("Native").$convert(Me),Me},{$$s:Ie}):H(se)?J(Ie,"define_method",[u],function ce(Me){var he,$e=ce.$$p||k,Se=ce.$$s??this,be=k;return null==Se.native&&(Se.native=k),ce.$$p=null,he=d(arguments),be=J(c("Native"),"call",[Se.native,ie].concat(K(he)),$e.$to_proc()),H(be)?se.$new(be.$to_n()):k},{$$arity:-1,$$s:Ie}):J(Ie,"define_method",[u],function ce(Me){var he,$e=ce.$$p||k,Se=ce.$$s??this;return null==Se.native&&(Se.native=k),ce.$$p=null,he=d(arguments),J(c("Native"),"call",[Se.native,ie].concat(K(he)),$e.$to_proc())},{$$arity:-1,$$s:Ie})},-2),V(g,"$native_reader",function(u){var p,C=this;return p=d(arguments),J(p,"each",[],function $(ie){var se=$.$$s??this;return null==ie&&(ie=k),J(se,"define_method",[ie],function Ee(){var Ie=Ee.$$s??this;return null==Ie.native&&(Ie.native=k),Ie.$Native(Ie.native[ie])},{$$s:se})},{$$s:C})},-1),V(g,"$native_writer",function(u){var p,C=this;return p=d(arguments),J(p,"each",[],function $(ie){var se=$.$$s??this;return null==ie&&(ie=k),J(se,"define_method",[ie+"="],function Ee(Ie){var ce=Ee.$$s??this;return null==ce.native&&(ce.native=k),null==Ie&&(Ie=k),ce.$Native(ce.native[ie]=Ie)},{$$s:se})},{$$s:C})},-1),V(g,"$native_accessor",function(u){var p,m,C=this;return p=d(arguments),J(C,"native_reader",K(m=p)),J(C,"native_writer",K(m))},-1),function(R,F){var g=le(R,"Wrapper"),l=[g].concat(F),c=E.$r(l);V(g,"$initialize",function(u){return H(_["$native?"](u))||_.$raise(c("ArgumentError"),u.$inspect()+" isn't native"),this.native=u}),V(g,"$to_n",A("native")),_e(g,"$included",function(u){return u.$extend(c("Helpers"))})}(D[0],D),_e(te,"$included",function(F){return this.$warn("Including ::Native is deprecated. Please include Native::Wrapper instead."),F.$include(fe("Wrapper"))}),function(P,B){var te=le(P,"Kernel"),D=[te].concat(B),fe=E.$r(D);V(te,"$native?",function(F){return null==F||!F.$$class}),V(te,"$Native",function R(F){var l=this;return R.$$p=null,H(null==F)?k:H(l["$native?"](F))?v(fe("Native"),"Object").$new(F):H(F["$is_a?"](fe("Array")))?J(F,"map",[],function c(f){return null==f&&(f=k),(c.$$s??this).$Native(f)},{$$s:l}):H(F["$is_a?"](fe("Proc")))?J(l,"proc",[],function c(f){var p,u=c.$$p||k,C=c.$$s??this;return c.$$p=null,p=d(arguments),C.$Native(J(F,"call",K(p),u.$to_proc()))},{$$arity:-1,$$s:l}):F}),U(te,"_Array","Array"),V(te,"$Array",function R(F,g){var f,l=R.$$p||k,u=this;return R.$$p=null,f=d(arguments,1),H(u["$native?"](F))?J(v(fe("Native"),"Array"),"new",[F].concat(K(f)),l.$to_proc()).$to_a():u.$_Array(F)},-2)}(L[0],L),function(P,B){var te=N(P,B,"Object");te.$$prototype.native=k,te.$include(v(v("Native"),"Wrapper")),V(te,"$==",function(R){return this.native===v("Native").$try_convert(R)}),V(te,"$has_key?",function(R){return E.hasOwnProperty.call(this.native,R)}),V(te,"$each",function fe(R){var g,l=fe.$$p||k,c=this;if(fe.$$p=null,g=d(arguments),l!==k){for(var f in c.native)E.yieldX(l,[f,c.native[f]]);return c}return J(c,"method_missing",["each"].concat(K(g)))},-1),V(te,"$[]",function(R){var g=this.native[R];return g instanceof Function?g:v("Native").$call(this.native,R)}),V(te,"$[]=",function(R,F){var l;return l=v("Native").$try_convert(F),this.native[R]=H(l===k)?F:l}),V(te,"$merge!",function(R){for(var g in R=v("Native").$convert(R))this.native[g]=R[g];return this}),V(te,"$respond_to?",function(R,F){return null==F&&(F=!1),_.$instance_method("respond_to?").$bind(this).$call(R,F)},-2),V(te,"$respond_to_missing?",function(R,F){return null==F&&(F=!1),E.hasOwnProperty.call(this.native,R)},-2),V(te,"$method_missing",function fe(R,F){var c,f,g=fe.$$p||k,u=this;return fe.$$p=null,c=d(arguments,1),"="===R.charAt(R.length-1)?(f=[R.$slice(0,Y(R.$length(),1)),c["$[]"](0)],J(u,"[]=",f),f[f.length-1]):J(v("Native"),"call",[u.native,R].concat(K(c)),g.$to_proc())},-2),V(te,"$nil?",T(!1)),V(te,"$is_a?",function(R){return E.is_a(this,R)}),V(te,"$instance_of?",function(R){return this.$$class===R}),V(te,"$class",function(){return this.$$class}),V(te,"$to_a",function fe(R){var F=fe.$$p||k;return fe.$$p=null,null==R&&(R=j([],{})),J(v(v("Native"),"Array"),"new",[this.native,R],F.$to_proc()).$to_a()},-1),V(te,"$inspect",function(){return"#<Native:"+String(this.native)+">"}),U(te,"include?","has_key?"),U(te,"key?","has_key?"),U(te,"kind_of?","is_a?"),U(te,"member?","has_key?")}(S("Native"),S("BasicObject")),function(P,B,te){var D=N(P,null,"Array"),fe=[D].concat(te),R=E.$r(fe),F=D.$$prototype;F.named=F.native=F.get=F.block=F.set=F.length=k,D.$include(v(R("Native"),"Wrapper")),D.$include(R("Enumerable")),V(D,"$initialize",function g(l,c){var f=g.$$p||k,u=this,p=k;return g.$$p=null,null==c&&(c=j([],{})),re(u,z(u,"initialize",g,!1,!0),"initialize",[l],null),u.get=H(p=c["$[]"]("get"))?p:c["$[]"]("access"),u.named=c["$[]"]("named"),u.set=H(p=c["$[]"]("set"))?p:c["$[]"]("access"),u.length=H(p=c["$[]"]("length"))?p:"length",u.block=f,H(null==u.$length())?u.$raise(R("ArgumentError"),"no length found on the array-like object"):k},-2),V(D,"$each",function g(){var l=g.$$p||k,c=this;if(g.$$p=null,!H(l))return c.$enum_for("each");for(var f=0,u=c.$length();f<u;f++)E.yield1(l,c["$[]"](f));return c}),V(D,"$[]",function(l){var f,u,c=this;return f=q(R("String"),u=l)||q(R("Symbol"),u)?H(c.named)?c.native[c.named](l):c.native[l]:q(R("Integer"),u)?H(c.get)?c.native[c.get](l):c.native[l]:k,H(f)?H(c.block)?c.block.$call(f):c.$Native(f):k}),V(D,"$[]=",function(l,c){var f=this;return H(f.set)?f.native[f.set](l,R("Native").$convert(c)):f.native[l]=R("Native").$convert(c)}),V(D,"$last",function(l){var c=this,f=k,u=k;if(null==l&&(l=k),H(l)){for(f=Y(c.$length(),1),u=[];H(Z(f,0));)u["$<<"](c["$[]"](f)),f=Y(f,1);return u}return c["$[]"](Y(c.$length(),1))},-1),V(D,"$length",function(){return this.native[this.length]}),V(D,"$inspect",function(){return this.$to_a().$inspect()}),U(D,"to_ary","to_a")}(S("Native"),0,L),function(P,B){var te=N(P,null,"Numeric");V(te,"$to_n",function(){return this.valueOf()})}(L[0]),function(P,B){var te=N(P,null,"Proc");V(te,"$to_n",M)}(L[0]),function(P,B){var te=N(P,null,"String");V(te,"$to_n",function(){return this.valueOf()})}(L[0]),function(P,B){var te=N(P,null,"Regexp");V(te,"$to_n",function(){return this.valueOf()})}(L[0]),function(P,B){var te=N(P,null,"MatchData");V(te,"$to_n",A("matches"))}(L[0]),function(P,B,te){var D=N(P,null,"Struct"),fe=[D].concat(te),R=E.$r(fe);V(D,"$to_n",function(){var l=k;return l={},J(this,"each_pair",[],function(f,u){return null==f&&(f=k),null==u&&(u=k),l[f]=R("Native").$try_convert(u,u)}),l})}(L[0],0,L),function(P,B,te){var D=N(P,null,"Array"),fe=[D].concat(te),R=E.$r(fe);V(D,"$to_n",function(){for(var l=[],c=0,f=this.length;c<f;c++){var u=this[c];l.push(R("Native").$try_convert(u,u))}return l})}(L[0],0,L),function(P,B){var te=N(P,null,"Boolean");V(te,"$to_n",function(){return this.valueOf()})}(L[0]),function(P,B){var te=N(P,null,"Time");V(te,"$to_n",M)}(L[0]),function(P,B){var te=N(P,null,"NilClass");V(te,"$to_n",function(){return null})}(L[0]),H(S("Hash")["$method_defined?"]("_initialize"))||function(P,B,te){var D=N(P,null,"Hash"),fe=[D].concat(te),R=E.$r(fe);U(D,"_initialize","initialize"),V(D,"$initialize",function F(g){var l=F.$$p||k,c=this;if(F.$$p=null,null!=g&&(void 0===g.constructor||g.constructor===Object)){var p,m,f=c.$$smap,u=c.$$keys;for(p in g)!(m=g[p])||void 0!==m.constructor&&m.constructor!==Object?m&&m.$$is_array?(m=m.map(function(C){return!C||void 0!==C.constructor&&C.constructor!==Object?c.$Native(C):R("Hash").$new(C)}),f[p]=m):f[p]=c.$Native(m):f[p]=R("Hash").$new(m),u.push(p);return c}return J(c,"_initialize",[g],l.$to_proc())},-1),V(D,"$to_n",function(){for(var u,p,l={},c=this.$$keys,f=this.$$smap,m=0,C=c.length;m<C;m++)p=(u=c[m]).$$is_string?f[u]:(u=u.key).value,l[u]=R("Native").$try_convert(p,p);return l})}(L[0],0,L),function(P,B){var te=N(P,null,"Module");V(te,"$native_module",function(){return E.global[this.$name()]=this})}(L[0]),function(P,B,te){var D=N(P,null,"Class"),fe=[D].concat(te),R=E.$r(fe);V(D,"$native_alias",function(g,l){var c=this,f=c.prototype[E.jsid(l)];f||c.$raise(R("NameError").$new("undefined method `"+l+"' for class `"+c.$inspect()+"'",l)),c.prototype[g]=f}),V(D,"$native_class",function(){var g=this;return g.$native_module(),g.new=g.$new})}(L[0],0,L),I.$=I.global=X.$Native(E.global)}),Opal.modules.strscan=function(E){var U,N,Y,T,j,_e=E.def,d=E.truthy,H=E.eqeqeq,J=E.Opal,_=E.return_ivar,w=E.send,O=E.alias,x=[],K=E.nil;return U=x,Y=[N=(0,E.klass)(x[0],null,"StringScanner")].concat(U),T=E.$r(Y),(j=N.$$prototype).pos=j.string=j.working=j.matched=j.prev_pos=j.match=K,N.$attr_reader("pos","matched"),_e(N,"$initialize",function(z){var q=this;return q.string=z,q.pos=0,q.matched=K,q.working=z,q.match=[]}),N.$attr_reader("string"),_e(N,"$beginning_of_line?",function(){var z=this;return 0===z.pos||"\n"===z.string.charAt(z.pos-1)}),_e(N,"$scan",function(z){var q=this,Z=(z=q.$anchor(z)).exec(q.working);return null==Z?q.matched=K:(q.prev_pos=q.pos,q.pos+=Z[0].length,q.working=q.working.substring(Z[0].length),q.matched=Z[0],q.match=Z,Z[0])}),_e(N,"$scan_until",function(z){var q=this;z=q.$anchor(z);for(var Z=q.working,M=0;Z.length!=M;++M){var I=z.exec(Z.substr(M));if(null!==I){var X=M+I[0].length,L=Z.substr(0,X);return q.matched=I[0],q.match=I,q.prev_pos=q.pos+M,q.pos+=X,q.working=Z.substr(X),L}}return q.matched=K}),_e(N,"$[]",function(z){var Z;if(d(this.match["$empty?"]()))return K;H(T("Symbol"),Z=z)?z=z.$to_s():H(T("String"),Z)||(z=J["$coerce_to!"](z,T("Integer"),"to_int"));var M=this.match;return z<0&&(z+=M.length),z<0||z>=M.length||null==M[z]?K:M[z]}),_e(N,"$check",function(z){var q=this,Z=(z=q.$anchor(z)).exec(q.working);return q.matched=null==Z?K:Z[0]}),_e(N,"$check_until",function(z){var q=this,Z=q.prev_pos,M=q.pos,I=q.working,X=q.$scan_until(z);return q.prev_pos=Z,q.pos=M,q.working=I,X}),_e(N,"$peek",function(z){return this.working.substring(0,z)}),_e(N,"$eos?",function(){return 0===this.working.length}),_e(N,"$exist?",function(z){var Z=z.exec(this.working);return null==Z?K:0==Z.index?0:Z.index+1}),_e(N,"$skip",function(z){var q=this,Z=(z=q.$anchor(z)).exec(q.working);if(null==Z)return q.match=[],q.matched=K;var M=Z[0],I=M.length;return q.matched=M,q.match=Z,q.prev_pos=q.pos,q.pos+=I,q.working=q.working.substring(I),I}),_e(N,"$skip_until",function(z){var Z=this.$scan_until(z);return Z===K?K:(this.matched=Z.substr(-1),Z.length)}),_e(N,"$get_byte",function(){var z=this,q=K;return z.pos<z.string.length?(z.prev_pos=z.pos,z.pos+=1,q=z.matched=z.working.substring(0,1),z.working=z.working.substring(1)):z.matched=K,q}),_e(N,"$match?",function(z){var q=this,Z=(z=q.$anchor(z)).exec(q.working);return null==Z?K:(q.prev_pos=q.pos,Z[0].length)}),_e(N,"$pos=",function(z){var q=this;return z<0&&(z+=q.string.$length()),q.pos=z,q.working=q.string.slice(z)}),_e(N,"$matched_size",function(){return this.matched===K?K:this.matched.length}),_e(N,"$post_match",function(){var z=this;return z.matched===K?K:z.string.substr(z.pos)}),_e(N,"$pre_match",function(){var z=this;return z.matched===K?K:z.string.substr(0,z.prev_pos)}),_e(N,"$reset",function(){var z=this;return z.working=z.string,z.matched=K,z.pos=0}),_e(N,"$rest",_("working")),_e(N,"$rest?",function(){return 0!==this.working.length}),_e(N,"$rest_size",function(){return this.$rest().$size()}),_e(N,"$terminate",function(){var z,q=this;return q.match=K,z=[q.string.$length()],w(q,"pos=",z),z[z.length-1]}),_e(N,"$unscan",function(){var z=this;return z.pos=z.prev_pos,z.prev_pos=K,z.match=K,z}),O(N,"bol?","beginning_of_line?"),O(N,"getch","get_byte"),N.$private(),_e(N,"$anchor",function(z){var q=z.toString().match(/\/([^\/]+)$/);return q=q?q[1]:void 0,new RegExp("^(?:"+z.source+")",q)})},Opal.queue(function(E){var x,K,U,V,le=E.klass,_e=E.def,d=E.module,H=E.top,J=[],_=E.$r(J),w=E.nil;return H.$require("strscan"),K=J,[V=le(J[0],null,"Dir")].concat(K),U=E.get_singleton_class(V),_e(U,"$[]",function(){return[]}),x=d(J[0],"StringScannerPatch"),_e(x,"$scan_until",function(V){var A=this;V=(A=this).$anchor(V);for(var Y,U=A.pos,N=A.working;;){var T=0===N.length;if(Y=V.exec(N),U+=1,N=N.substr(1),null!=Y)return A.matched=A.string.substr(A.pos,U-A.pos-1+Y[0].length),A.prev_pos=U-1,A.pos=U,A.working=N.substr(Y[0].length-1),A.matched;if(T)return A.matched=w}}),_("StringScanner").$prepend(_("StringScannerPatch")),E.top.$__dir__=()=>"/",w})},8465:(E,le,_e)=>{_e(9993),Opal.modules["bcdice/arithmetic/node"]=function(d){var M,S,B,g,l,D,fe,v,X,H=d.module,J=d.klass,_=d.def,w=d.thrower,O=d.return_ivar,x=d.send2,K=d.find_super,V=d.eqeq,A=d.const_set,U=d.eqeqeq,N=d.rb_divide,Y=d.truthy,T=d.assign_ivar,j=d.alias,re=[],z=d.nil,q=d.$$$;return M=re,S=X=[H(re[0],"BCDice")].concat(M),B=v=[H(X[0],"Arithmetic")].concat(S),D=[H(v[0],"Node")].concat(B),fe=d.$r(D),(l=(g=J(D[0],null,"BinaryOp")).$$prototype).lhs=l.rhs=l.op=z,_(g,"$initialize",function(f,u,p){var m=this;return m.lhs=f,m.op=u,m.rhs=p}),_(g,"$eval",function(f){try{w("eval_return");var C,p=this,m=z;return m=p.lhs.$eval(f),C=p.rhs.$eval(f),m.$send(p.op,C)}catch($){if($===d.t_eval_return)return $.$v;throw $}}),_(g,"$output",function(){var f=this;return""+f.lhs.$output()+f.op+f.rhs.$output()}),_(g,"$s_exp",function(){var f=this;return"("+f.$op_for_s_exp()+" "+f.lhs.$s_exp()+" "+f.rhs.$s_exp()+")"}),_(g,"$op_for_s_exp",O("op")),function(R,F,g){var l=J(R,F,"DivideBase"),c=[l].concat(g),f=d.$r(c),u=l.$$prototype;u.lhs=u.rhs=u.op=z,_(l,"$initialize",function p(m,C){return p.$$p=null,x(this,K(this,"initialize",p,!1,!0),"initialize",[m,"/",C],null)}),_(l,"$eval",function(m){try{w("eval_return");var ie,se,$=this;return ie=$.lhs.$eval(m),se=$.rhs.$eval(m),V(se,0)&&$.$raise(f("ZeroDivisionError")),$.$divide_and_round(ie,se,m)}catch(Ee){if(Ee===d.t_eval_return)return Ee.$v;throw Ee}}),_(l,"$output",function p(){var m=p.$$p||z,C=this;return p.$$p=null,""+x(C,K(C,"output",p,!1,!0),"output",[],m)+C.$rounding_method()}),l.$private(),_(l,"$rounding_method",function(){return q(this.$class(),"ROUNDING_METHOD")}),_(l,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),_(l,"$divide_and_round",function(m,C,$){return this.$raise(f("NotImplementedError"))})}(D[0],fe("BinaryOp"),D),function(R,F,g){var l=J(R,F,"DivideWithGameSystemDefault"),c=[l].concat(g),f=d.$r(c);A(c[0],"ROUNDING_METHOD",""),l.$private(),_(l,"$divide_and_round",function(p,m,C){var $,ie=z;return U(q(f("RoundType"),"CEIL"),$=C)?N(p.$to_f(),m).$ceil():U(q(f("RoundType"),"ROUND"),$)?(ie=N(p.$to_f(),m),Y(ie["$negative?"]())?ie.$abs().$round()["$-@"]():ie.$round()):N(p,m).$floor()})}(D[0],fe("DivideBase"),D),function(R,F,g){var l=J(R,F,"DivideWithCeil"),c=[l].concat(g);A(c[0],"ROUNDING_METHOD","C"),l.$private(),_(l,"$divide_and_round",function(u,p,m){return N(u.$to_f(),p).$ceil()})}(D[0],fe("DivideBase"),D),function(R,F,g){var l=J(R,F,"DivideWithRound"),c=[l].concat(g);A(c[0],"ROUNDING_METHOD","R"),l.$private(),_(l,"$divide_and_round",function(u,p,m){var C=z;return C=N(u.$to_f(),p),Y(C["$negative?"]())?C.$abs().$round()["$-@"]():C.$round()})}(D[0],fe("DivideBase"),D),function(R,F,g){var l=J(R,F,"DivideWithFloor"),c=[l].concat(g);A(c[0],"ROUNDING_METHOD","F"),l.$private(),_(l,"$divide_and_round",function(u,p,m){return N(u,p).$floor()})}(D[0],fe("DivideBase"),D),function(R,F){var g=J(R,null,"Negative");g.$$prototype.body=z,_(g,"$initialize",T("body")),_(g,"$eval",function(f){try{return w("eval_return"),this.body.$eval(f)["$-@"]()}catch(m){if(m===d.t_eval_return)return m.$v;throw m}}),_(g,"$output",function(){return"-"+this.body.$output()}),_(g,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(D[0]),function(R,F){var g=J(R,null,"Parenthesis");g.$$prototype.expr=z,_(g,"$initialize",T("expr")),_(g,"$eval",function(f){try{return w("eval_return"),this.expr.$eval(f)}catch(m){if(m===d.t_eval_return)return m.$v;throw m}}),_(g,"$output",function(){return"("+this.expr.$output()+")"}),_(g,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(D[0]),function(R,F){var g=J(R,null,"Number");return g.$$prototype.value=z,_(g,"$initialize",T("value")),_(g,"$eval",O("value")),_(g,"$output",function(){return this.value.$to_s()}),j(g,"s_exp","output")}(D[0])},Opal.modules["racc/parser"]=function(d){var P,te,D,H=d.module,J=d.klass,_=d.truthy,w=d.const_set,O=d.defs,x=d.gvars,K=d.rb_lt,V=d.def,A=d.to_ary,U=d.send,N=d.neqeq,Y=d.rb_plus,T=d.eqeq,j=d.rb_ge,re=d.rb_gt,z=d.rb_minus,q=d.rb_le,Z=d.rb_times,M=d.assign_ivar_val,X=[],L=d.$r(X),S=d.nil,k=d.$$$;return P=X,te=[H(X[0],"Racc")].concat(P),D=d.$r(te),J(te[0],D("StandardError"),"ParseError"),_(k("::","ParseError","skip_raise")?"constant":S)||w(X[0],"ParseError",k(L("Racc"),"ParseError")),function(v,P){var g,l,c,f,u,D=[H(v,"Racc")].concat(P),fe=d.$r(D);return _(fe("Racc_No_Extensions","skip_raise")?"constant":S)||w(D[0],"Racc_No_Extensions",!1),g=D,c=[l=J(D[0],null,"Parser")].concat(g),f=d.$r(c),(u=l.$$prototype).yydebug=u.racc_debug_out=u.racc_error_status=u.racc_t=u.racc_vstack=u.racc_val=u.racc_state=u.racc_tstack=S,w(c[0],"Racc_Runtime_Version","1.4.6"),w(c[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),w(c[0],"Racc_Runtime_Core_Version_R","1.4.6"),w(c[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),w(c[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),w(c[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),w(c[0],"Racc_Runtime_Core_Version",f("Racc_Runtime_Core_Version_R")),w(c[0],"Racc_Runtime_Core_Revision",f("Racc_Runtime_Core_Revision_R")),w(c[0],"Racc_Runtime_Type","ruby"),O(f("Parser"),"$racc_runtime_type",function(){return f("Racc_Runtime_Type")}),V(l,"$_racc_setup",function(){var m,C,$=this,ie=S,se=S;return null==x.stderr&&(x.stderr=S),_(k($.$class(),"Racc_debug_parser"))||($.yydebug=!1),_(null!=(m=$.yydebug)&&m!==S?"instance-variable":S)||($.yydebug=!1),_($.yydebug)&&(_(null!=(C=$.racc_debug_out)&&C!==S?"instance-variable":S)||($.racc_debug_out=x.stderr),$.racc_debug_out=_(ie=$.racc_debug_out)?ie:x.stderr),se=k($.$class(),"Racc_arg"),_(K(se.$size(),14))&&se["$[]="](13,!0),se}),V(l,"$_racc_init_sysvars",function(){var m=this;return m.racc_state=[0],m.racc_tstack=[],m.racc_vstack=[],m.racc_t=S,m.racc_val=S,m.racc_read_next=!0,m.racc_user_yyerror=!1,m.racc_error_status=0}),V(l,"$do_parse",function(){return this.$__send__(f("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),V(l,"$next_token",function(){return this.$raise(f("NotImplementedError"),this.$class()+"#next_token is not defined")}),V(l,"$_racc_do_parse_rb",function(m,C){var $,Ee=S,Ie=S,ce=S,Me=S,ye=S,he=S,Se=S,be=S;return $=A(m),Ee=$[0]??S,Ie=$[1]??S,ce=$[2]??S,Me=$[3]??S,ye=$[10]??S,this.$_racc_init_sysvars(),he=Se=be=S,U(this,"catch",["racc_end_parse"],function ae(){var ue,Ce,y=ae.$$s??this,W=S;for(null==y.racc_state&&(y.racc_state=S),null==y.racc_read_next&&(y.racc_read_next=S),null==y.racc_t&&(y.racc_t=S),null==y.yydebug&&(y.yydebug=S),null==y.racc_val&&(y.racc_val=S);_(!0);)for(_(be=Me["$[]"](y.racc_state["$[]"](-1)))?(_(y.racc_read_next)&&N(y.racc_t,0)&&(Ce=y.$next_token(),ue=A(Ce),he=ue[0]??S,y.racc_val=ue[1]??S,y.racc_t=_(he)?_(W=ye["$[]"](he))?W:1:0,_(y.yydebug)&&y.$racc_read_token(y.racc_t,he,y.racc_val),y.racc_read_next=!1),be=Y(be,y.racc_t),_(j(be,0))&&_(Se=Ee["$[]"](be))&&T(Ie["$[]"](be),y.racc_state["$[]"](-1))||(Se=ce["$[]"](y.racc_state["$[]"](-1)))):Se=ce["$[]"](y.racc_state["$[]"](-1));_(Se=y.$_racc_evalact(Se,m)););},{$$s:this})}),V(l,"$yyparse",function(m,C){return this.$__send__(f("Racc_YY_Parse_Method"),m,C,this.$_racc_setup(),!0)}),V(l,"$_racc_yyparse_rb",function(m,C,$,ie){var se,ce=S,Me=S,$e=S,ye=S,Se=S,be=S,ae=S;return se=A($),ce=se[0]??S,Me=se[1]??S,$e=se[2]??S,ye=se[3]??S,Se=se[10]??S,this.$_racc_init_sysvars(),be=S,ae=S,U(this,"catch",["racc_end_parse"],function ue(){var Ce=ue.$$s??this;for(null==Ce.racc_state&&(Ce.racc_state=S);!_(ae=ye["$[]"](Ce.racc_state["$[]"](-1)));)for(;_(be=Ce.$_racc_evalact($e["$[]"](Ce.racc_state["$[]"](-1)),$)););return U(m,"__send__",[C],function y(W,pe){var we=y.$$s??this,De=S,Fe=S;for(null==we.racc_t&&(we.racc_t=S),null==we.racc_state&&(we.racc_state=S),null==we.racc_read_next&&(we.racc_read_next=S),null==W&&(W=S),null==pe&&(pe=S),we.racc_t=_(W)?_(De=Se["$[]"](W))?De:1:0,we.racc_val=pe,we.racc_read_next=!1,ae=Y(ae,we.racc_t),_(j(ae,0))&&_(be=ce["$[]"](ae))&&T(Me["$[]"](ae),we.racc_state["$[]"](-1))||(be=$e["$[]"](we.racc_state["$[]"](-1)));_(be=we.$_racc_evalact(be,$)););for(;_(_(De=_(Fe=(ae=ye["$[]"](we.racc_state["$[]"](-1)))["$!"]())?Fe:we.racc_read_next["$!"]())?De:we.racc_t["$=="](0));)for(_(ae)&&_(ae=Y(ae,we.racc_t))&&_(j(ae,0))&&_(be=ce["$[]"](ae))&&T(Me["$[]"](ae),we.racc_state["$[]"](-1))||(be=$e["$[]"](we.racc_state["$[]"](-1)));_(be=we.$_racc_evalact(be,$)););},{$$s:Ce})},{$$s:this})}),V(l,"$_racc_evalact",function(m,C){var $,$e,se=this,Ee=S,Ie=S,Me=S,ye=S,he=S,Se=S;if(Ee=($=A(C))[0]??S,Ie=$[1]??S,Me=$[3]??S,$e=$[11]??S,ye=$[12]??S,_(re(m,0))&&_(K(m,$e)))_(re(se.racc_error_status,0))&&(T(se.racc_t,1)||(se.racc_error_status=z(se.racc_error_status,1))),se.racc_vstack.$push(se.racc_val),se.racc_state.$push(m),se.racc_read_next=!0,_(se.yydebug)&&(se.racc_tstack.$push(se.racc_t),se.$racc_shift(se.racc_t,se.racc_tstack,se.racc_vstack));else if(_(K(m,0))&&_(re(m,ye["$-@"]()))){if(he=U(se,"catch",["racc_jump"],function be(){var ae=be.$$s??this;return null==ae.racc_state&&(ae.racc_state=S),ae.racc_state.$push(ae.$_racc_do_reduce(C,m)),!1},{$$s:se}),_(he))switch(he){case 1:return se.racc_user_yyerror=!0,ye["$-@"]();case 2:return $e;default:se.$raise("[Racc Bug] unknown jump code")}}else if(T(m,$e))_(se.yydebug)&&se.$racc_accept(),se.$throw("racc_end_parse",se.racc_vstack["$[]"](0));else{if(T(m,ye["$-@"]())){switch(se.racc_error_status){case 0:_(C["$[]"](21))||se.$on_error(se.racc_t,se.racc_val,se.racc_vstack);break;case 3:T(se.racc_t,0)&&se.$throw("racc_end_parse",S),se.racc_read_next=!0}for(se.racc_user_yyerror=!1,se.racc_error_status=3;_(!0)&&!(_(Se=Me["$[]"](se.racc_state["$[]"](-1)))&&(Se=Y(Se,1),_(j(Se,0))&&_(m=Ee["$[]"](Se))&&T(Ie["$[]"](Se),se.racc_state["$[]"](-1))));)_(q(se.racc_state.$size(),1))&&se.$throw("racc_end_parse",S),se.racc_state.$pop(),se.racc_vstack.$pop(),_(se.yydebug)&&(se.racc_tstack.$pop(),se.$racc_e_pop(se.racc_state,se.racc_tstack,se.racc_vstack));return m}se.$raise("[Racc Bug] unknown action "+m.$inspect())}return _(se.yydebug)&&se.$racc_next_state(se.racc_state["$[]"](-1),se.racc_state),S}),V(l,"$_racc_do_reduce",function(m,C){var $,ye,Se,W,pe,we,Ye,se=this,Ie=S,ce=S,Me=S,$e=S,he=S,be=S,ae=S,ue=S,Ce=S,y=S,De=S,Fe=S,at=S;return Ie=($=A(m))[4]??S,ce=$[5]??S,Me=$[6]??S,$e=$[7]??S,ye=$[8]??S,he=$[9]??S,Se=$[13]??S,be=se.racc_state,ae=se.racc_vstack,ue=se.racc_tstack,Ce=Z(C,-3),y=he["$[]"](Ce),W=he["$[]"](Y(Ce,1)),pe=he["$[]"](Y(Ce,2)),we=[],_(se.yydebug)&&(De=ue["$[]"](y["$-@"](),y)),Fe=ae["$[]"](y["$-@"](),y),_(se.yydebug)&&ue["$[]="](y["$-@"](),y,we),ae["$[]="](y["$-@"](),y,we),be["$[]="](y["$-@"](),y,we),_(Se)?ae.$push(se.$__send__(pe,Fe,ae,Fe["$[]"](0))):ae.$push(se.$__send__(pe,Fe,ae)),ue.$push(W),_(se.yydebug)&&se.$racc_reduce(De,W,ue,ae),Ye=z(W,ye),_(Ce=$e["$[]"](Ye))&&(Ce=Y(Ce,be["$[]"](-1)),_(j(Ce,0))&&_(at=Ie["$[]"](Ce))&&T(ce["$[]"](Ce),Ye))?at:Me["$[]"](Ye)}),V(l,"$on_error",function(m,C,$){var se;return this.$raise(f("ParseError"),this.$sprintf("\nparse error on value %s (%s)",C.$inspect(),_(se=this.$token_to_str(m))?se:"?"))}),V(l,"$yyerror",function(){return this.$throw("racc_jump",1)}),V(l,"$yyaccept",function(){return this.$throw("racc_jump",2)}),V(l,"$yyerrok",M("racc_error_status",0)),V(l,"$racc_read_token",function(m,C,$){var ie=this;return ie.racc_debug_out.$print("read    "),ie.racc_debug_out.$print(C.$inspect(),"(",ie.$racc_token2str(m),") "),ie.racc_debug_out.$puts($.$inspect()),ie.racc_debug_out.$puts()}),V(l,"$racc_shift",function(m,C,$){return this.racc_debug_out.$puts("shift   "+this.$racc_token2str(m)),this.$racc_print_stacks(C,$),this.racc_debug_out.$puts()}),V(l,"$racc_reduce",function(m,C,$,ie){var se=this,Ee=S;return(Ee=se.racc_debug_out).$print("reduce "),_(m["$empty?"]())?Ee.$print(" <none>"):U(m,"each",[],function Ie(ce){return null==ce&&(ce=S),Ee.$print(" ",(Ie.$$s??this).$racc_token2str(ce))},{$$s:se}),Ee.$puts(" --\x3e "+se.$racc_token2str(C)),se.$racc_print_stacks($,ie),se.racc_debug_out.$puts()}),V(l,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),V(l,"$racc_e_pop",function(m,C,$){return this.racc_debug_out.$puts("error recovering mode: pop token"),this.$racc_print_states(m),this.$racc_print_stacks(C,$),this.racc_debug_out.$puts()}),V(l,"$racc_next_state",function(m,C){var $=this;return $.racc_debug_out.$puts("goto    "+m),$.$racc_print_states(C),$.racc_debug_out.$puts()}),V(l,"$racc_print_stacks",function(m,C){var ie=S;return(ie=this.racc_debug_out).$print("        ["),U(m,"each_index",[],function se(Ee){return null==Ee&&(Ee=S),ie.$print(" (",(se.$$s??this).$racc_token2str(m["$[]"](Ee))," ",C["$[]"](Ee).$inspect(),")")},{$$s:this}),ie.$puts(" ]")}),V(l,"$racc_print_states",function(m){var $=S;return($=this.racc_debug_out).$print("        ["),U(m,"each",[],function(se){return null==se&&(se=S),$.$print(" ",se)}),$.$puts(" ]")}),V(l,"$racc_token2str",function(m){var $;return _($=k(this.$class(),"Racc_token_to_s_table")["$[]"](m))?$:this.$raise("[Racc Bug] can't convert token "+m+" to string")}),V(l,"$token_to_str",function(m){return k(this.$class(),"Racc_token_to_s_table")["$[]"](m)})}(X[0],X)},Opal.modules.strscan=function(d){var T,j,re,z,q,J=d.def,_=d.truthy,w=d.eqeqeq,O=d.Opal,x=d.return_ivar,K=d.send,V=d.alias,A=[],U=d.nil;return T=A,re=[j=(0,d.klass)(A[0],null,"StringScanner")].concat(T),z=d.$r(re),(q=j.$$prototype).pos=q.string=q.working=q.matched=q.prev_pos=q.match=U,j.$attr_reader("pos","matched"),J(j,"$initialize",function(M){var I=this;return I.string=M,I.pos=0,I.matched=U,I.working=M,I.match=[]}),j.$attr_reader("string"),J(j,"$beginning_of_line?",function(){var M=this;return 0===M.pos||"\n"===M.string.charAt(M.pos-1)}),J(j,"$scan",function(M){var I=this,X=(M=I.$anchor(M)).exec(I.working);return null==X?I.matched=U:(I.prev_pos=I.pos,I.pos+=X[0].length,I.working=I.working.substring(X[0].length),I.matched=X[0],I.match=X,X[0])}),J(j,"$scan_until",function(M){var I=this;M=I.$anchor(M);for(var X=I.working,L=0;X.length!=L;++L){var S=M.exec(X.substr(L));if(null!==S){var k=L+S[0].length,v=X.substr(0,k);return I.matched=S[0],I.match=S,I.prev_pos=I.pos+L,I.pos+=k,I.working=X.substr(k),v}}return I.matched=U}),J(j,"$[]",function(M){var X;if(_(this.match["$empty?"]()))return U;w(z("Symbol"),X=M)?M=M.$to_s():w(z("String"),X)||(M=O["$coerce_to!"](M,z("Integer"),"to_int"));var L=this.match;return M<0&&(M+=L.length),M<0||M>=L.length||null==L[M]?U:L[M]}),J(j,"$check",function(M){var I=this,X=(M=I.$anchor(M)).exec(I.working);return I.matched=null==X?U:X[0]}),J(j,"$check_until",function(M){var I=this,X=I.prev_pos,L=I.pos,S=I.working,k=I.$scan_until(M);return I.prev_pos=X,I.pos=L,I.working=S,k}),J(j,"$peek",function(M){return this.working.substring(0,M)}),J(j,"$eos?",function(){return 0===this.working.length}),J(j,"$exist?",function(M){var X=M.exec(this.working);return null==X?U:0==X.index?0:X.index+1}),J(j,"$skip",function(M){var I=this,X=(M=I.$anchor(M)).exec(I.working);if(null==X)return I.match=[],I.matched=U;var L=X[0],S=L.length;return I.matched=L,I.match=X,I.prev_pos=I.pos,I.pos+=S,I.working=I.working.substring(S),S}),J(j,"$skip_until",function(M){var X=this.$scan_until(M);return X===U?U:(this.matched=X.substr(-1),X.length)}),J(j,"$get_byte",function(){var M=this,I=U;return M.pos<M.string.length?(M.prev_pos=M.pos,M.pos+=1,I=M.matched=M.working.substring(0,1),M.working=M.working.substring(1)):M.matched=U,I}),J(j,"$match?",function(M){var I=this,X=(M=I.$anchor(M)).exec(I.working);return null==X?U:(I.prev_pos=I.pos,X[0].length)}),J(j,"$pos=",function(M){var I=this;return M<0&&(M+=I.string.$length()),I.pos=M,I.working=I.string.slice(M)}),J(j,"$matched_size",function(){return this.matched===U?U:this.matched.length}),J(j,"$post_match",function(){var M=this;return M.matched===U?U:M.string.substr(M.pos)}),J(j,"$pre_match",function(){var M=this;return M.matched===U?U:M.string.substr(0,M.prev_pos)}),J(j,"$reset",function(){var M=this;return M.working=M.string,M.matched=U,M.pos=0}),J(j,"$rest",x("working")),J(j,"$rest?",function(){return 0!==this.working.length}),J(j,"$rest_size",function(){return this.$rest().$size()}),J(j,"$terminate",function(){var M,I=this;return I.match=U,M=[I.string.$length()],K(I,"pos=",M),M[M.length-1]}),J(j,"$unscan",function(){var M=this;return M.pos=M.prev_pos,M.prev_pos=U,M.match=U,M}),V(j,"bol?","beginning_of_line?"),V(j,"getch","get_byte"),j.$private(),J(j,"$anchor",function(M){var I=M.toString().match(/\/([^\/]+)$/);return I=I?I[1]:void 0,new RegExp("^(?:"+M.source+")",I)})},Opal.modules["bcdice/normalize"]=function(d){var V,Y,U,H=d.module,J=d.eqeqeq,_=d.def,w=d.eqeq,O=[],x=d.nil;return V=O,U=[H(O[0],"BCDice")].concat(V),(Y=H(U[0],"Normalize")).$module_function(),_(Y,"$comparison_operator",function(j){var re;return J(/<=|=</,re=j)?"<=":J(/>=|=>/,re)?">=":J(/<>|!=|=!/,re)?"!=":J(/</,re)?"<":J(/>/,re)?">":J(/=/,re)?"==":x}),_(Y,"$target_number",function(j){return w(j,"?")?j:j.$to_i()})},Opal.modules["bcdice/common_command/lexer"]=function(d){var N,re,I,X,L,S,q,T,H=d.module,J=d.klass,_=d.const_set,w=d.hash2,O=d.truthy,x=d.def,K=d.top,V=[],A=d.nil;return K.$require("strscan"),K.$require("bcdice/normalize"),N=V,re=T=[H(V[0],"BCDice")].concat(N),I=q=[H(T[0],"CommonCommand")].concat(re),L=[X=J(q[0],null,"Lexer")].concat(I),S=d.$r(L),X.$$prototype.scanner=A,_(L[0],"SYMBOLS",w(["+","-","*","/","(",")","[","]","?","@"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","?":"QUESTION","@":"AT"}).$freeze()),x(X,"$initialize",function(P){var te;return P=O(te=P.$split(" ",2).$first())?te:"",this.scanner=S("StringScanner").$new(P)}),x(X,"$next_token",function(){var P=this,B=A,te=A,D=A,R=A;return O(P.scanner["$eos?"]())?[!1,"$"]:O(B=P.scanner.$scan(/\d+/))?["NUMBER",B.$to_i()]:O(te=P.scanner.$scan(/[<>!=]+/))?["CMP_OP",S("Normalize").$comparison_operator(te)]:(D=P.scanner.$getch().$upcase(),[O(R=S("SYMBOLS")["$[]"](D))?R:D.$to_sym(),D])}),x(X,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/arithmetic/parser"]=function(d){var Y,z,L,P,B,te,D,fe,R,F,g,l,u,S,k,v,Z,M,j,H=d.module,J=d.klass,_=d.defs,w=d.def,O=d.hash,x=d.const_set,K=d.top,V=[],A=d.nil,U=d.$$$;return K.$require("racc/parser.rb"),K.$require("bcdice/common_command/lexer"),K.$require("bcdice/arithmetic/node"),Y=V,z=j=[H(V[0],"BCDice")].concat(Y),Z=[H(j[0],"Arithmetic")].concat(z),M=d.$r(Z),L=Z,k=[S=J(Z[0],U(M("Racc"),"Parser"),"Parser")].concat(L),v=d.$r(k),S.$$prototype.lexer=A,_(S,"$parse",function(ie){return this.$new().$parse(ie)}),w(S,"$parse",function(ie){try{return this.lexer=U(U(v("BCDice"),"CommonCommand"),"Lexer").$new(ie),this.$do_parse()}catch(Ee){if(!d.rescue(Ee,[v("ParseError")]))throw Ee;try{return A}finally{d.pop_exception()}}}),S.$private(),w(S,"$next_token",function(){return this.lexer.$next_token()}),P=d.large_array_unpack("8,17,8,12,13,4,5,4,5,7,8,7,8,12,13,4,5,4,5,7,8,7,8,12,13,4,5,4,5,7,8,7,8,,,4,5,4,5,7,9,7,,,10,11,,10,11,22,26,24,25,27"),B=d.large_array_unpack("0,9,4,2,2,0,0,4,4,0,5,4,7,18,18,5,5,7,7,5,10,7,11,19,19,10,10,11,11,10,12,11,13,,,12,12,13,13,12,1,13,,,16,16,,1,1,16,21,21,21,21"),te=[-2,40,-6,A,0,8,A,10,A,1,18,20,28,30,A,A,37,A,4,14,A,47,A,A,A,A,A,A],D=[-17,-17,-3,-6,-17,-17,-14,-17,-16,-17,-17,-17,-17,-17,-12,-13,-17,28,-1,-2,-4,-7,-15,-5,-8,-9,-10,-11],fe=[14,15,23,1,18,19,A,A,20,21,16],R=[3,3,4,1,2,2,A,A,3,3,1],F=[A,3,-6,-4,-19,A],g=[A,A,2,3,A,6],l=d.large_array_unpack("0,0,racc_error,3,14,_reduce_1,3,14,_reduce_2,1,14,_reduce_none,3,15,_reduce_4,4,15,_reduce_5,1,15,_reduce_none,0,17,_reduce_7,1,17,_reduce_8,1,17,_reduce_9,1,17,_reduce_10,1,17,_reduce_11,2,16,_reduce_12,2,16,_reduce_13,1,16,_reduce_none,3,18,_reduce_15,1,18,_reduce_16"),u=O(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12),x(k[0],"Racc_arg",[P,B,D,te,fe,R,g,F,13,l,u,28,17,!0]),x(k[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","$start","add","mul","unary","round_type","term"]),x(k[0],"Racc_debug_parser",!1),w(S,"$_reduce_1",function(ie,se,Ee){return U(U(v("Arithmetic"),"Node"),"BinaryOp").$new(ie["$[]"](0),"+",ie["$[]"](2))}),w(S,"$_reduce_2",function(ie,se,Ee){return U(U(v("Arithmetic"),"Node"),"BinaryOp").$new(ie["$[]"](0),"-",ie["$[]"](2))}),w(S,"$_reduce_4",function(ie,se,Ee){return U(U(v("Arithmetic"),"Node"),"BinaryOp").$new(ie["$[]"](0),"*",ie["$[]"](2))}),w(S,"$_reduce_5",function(ie,se,Ee){return ie["$[]"](3).$new(ie["$[]"](0),ie["$[]"](2))}),w(S,"$_reduce_7",function(ie,se,Ee){return U(U(v("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),w(S,"$_reduce_8",function(ie,se,Ee){return U(U(v("Arithmetic"),"Node"),"DivideWithCeil")}),w(S,"$_reduce_9",function(ie,se,Ee){return U(U(v("Arithmetic"),"Node"),"DivideWithCeil")}),w(S,"$_reduce_10",function(ie,se,Ee){return U(U(v("Arithmetic"),"Node"),"DivideWithRound")}),w(S,"$_reduce_11",function(ie,se,Ee){return U(U(v("Arithmetic"),"Node"),"DivideWithFloor")}),w(S,"$_reduce_12",function(ie,se,Ee){return ie["$[]"](1)}),w(S,"$_reduce_13",function(ie,se,Ee){return U(U(v("Arithmetic"),"Node"),"Negative").$new(ie["$[]"](1))}),w(S,"$_reduce_15",function(ie,se,Ee){return ie["$[]"](1)}),w(S,"$_reduce_16",function(ie,se,Ee){return U(U(v("Arithmetic"),"Node"),"Number").$new(ie["$[]"](0))}),w(S,"$_reduce_none",function(ie,se,Ee){return ie["$[]"](0)})},Opal.modules["bcdice/arithmetic"]=function(d){var V,Y,re,q,Z,T,j,U,H=d.module,J=d.thrower,_=d.def,w=d.top,O=[],x=d.nil;return w.$require("bcdice/arithmetic/node"),w.$require("bcdice/arithmetic/parser"),V=O,Y=U=[H(O[0],"BCDice")].concat(V),j=[T=H(U[0],"Arithmetic")].concat(Y),q=[re=d.get_singleton_class(T)].concat(j),Z=d.$r(q),_(re,"$eval",function(I,X){try{var S;J("eval_return");try{return(S=Z("Parser").$parse(I))===x||null==S?x:S.$eval(X)}catch(v){if(!d.rescue(v,[Z("ZeroDivisionError")]))throw v;try{return x}finally{d.pop_exception()}}}catch(v){if(v===d.t_eval_return)return v.$v;throw v}})},Opal.queue(function(d){var T,Z,M,I,X,L,re,H=d.module,J=d.klass,_=d.defs,w=d.def,O=d.send,x=d.truthy,K=d.eqeq,V=d.thrower,U=[],N=d.nil;return d.top.$require("bcdice/arithmetic"),T=U,Z=re=[H(U[0],"BCDice")].concat(T),I=[M=J(re[0],null,"Preprocessor")].concat(Z),X=d.$r(I),(L=M.$$prototype).game_system=L.text=N,_(M,"$process",function(k,v){return X("Preprocessor").$new(k,v).$process()}),w(M,"$initialize",function(k,v){return this.text=k,this.game_system=v}),w(M,"$process",function(){var k=this;return k.$trim_after_whitespace(),k.$replace_parentheses(),k.text=k.game_system.$change_text(k.text),k.$replace_implicit_d(),k.text}),M.$private(),w(M,"$trim_after_whitespace",function(){return this.text=this.text.$strip().$split(/\s/,2).$first()}),w(M,"$replace_parentheses",function(){try{V("eval_return");var v=this;return function(){try{var P=V("break");return O(v,"loop",[],function B(){var D,te=B.$$s??this;if(null==te.text&&(te.text=N),D=te.text,te.text=O(te.text,"gsub",[/\([\d\/+*\-CURF]+\)/],function fe(R){var g,F=fe.$$s??this;return null==F.game_system&&(F.game_system=N),null==R&&(R=N),x(g=X("Arithmetic").$eval(R,F.game_system.$round_type()))?g:R},{$$s:te}),!K(D,te.text))return N;P.$throw()},{$$s:v})}catch(B){if(B===P)return B.$v;throw B}}()}catch(P){if(P===d.t_eval_return)return P.$v;throw P}}),w(M,"$replace_implicit_d",function(){var k=this;return k.text=O(k.text,"gsub",[/(\d+)D([^\w]|$)/i],function v(){var P=v.$$s??this;return null==P.game_system&&(P.game_system=N),X("Regexp").$last_match(1)+"D"+P.game_system.$sides_implicit_d()+X("Regexp").$last_match(2)},{$$s:k})})})},6956:(E,le,_e)=>{_e(9993),Opal.queue(function(d){var x,_=[];return x=_,(0,d.const_set)([(0,d.module)(_[0],"BCDice")].concat(x)[0],"VERSION","3.8.0")})},3583:function(E,le,_e){"use strict";var d=this&&this.__importDefault||function(_){return _&&_.__esModule?_:{default:_}};Object.defineProperty(le,"__esModule",{value:!0}),le.Opal=le.I18n=le.BCDice=void 0,_e(6956);var H=d(_e(8459));le.BCDice=H.default.module(null,"BCDice"),le.I18n=H.default.module(null,"I18n");var J=_e(8459);Object.defineProperty(le,"Opal",{enumerable:!0,get:function(){return d(J).default}})},8459:(E,le,_e)=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0}),le.nilToNull=void 0,_e(9993),Opal.config.unsupported_features_severity="ignore",le.default=Opal,le.nilToNull=function d(H){return H===Opal.nil?null:H}},3604:function(E,le,_e){"use strict";var N,d=this&&this.__extends||(N=function(Y,T){return(N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(j,re){j.__proto__=re}||function(j,re){for(var z in re)Object.prototype.hasOwnProperty.call(re,z)&&(j[z]=re[z])})(Y,T)},function(Y,T){function j(){this.constructor=Y}N(Y,T),Y.prototype=null===T?Object.create(T):(j.prototype=T.prototype,new j)}),H=this&&this.__awaiter||function(N,Y,T,j){return new(T||(T=Promise))(function(z,q){function Z(X){try{I(j.next(X))}catch(L){q(L)}}function M(X){try{I(j.throw(X))}catch(L){q(L)}}function I(X){X.done?z(X.value):function re(z){return z instanceof T?z:new T(function(q){q(z)})}(X.value).then(Z,M)}I((j=j.apply(N,Y||[])).next())})},J=this&&this.__generator||function(N,Y){var j,re,z,q,T={label:0,sent:function(){if(1&z[0])throw z[1];return z[1]},trys:[],ops:[]};return q={next:Z(0),throw:Z(1),return:Z(2)},"function"==typeof Symbol&&(q[Symbol.iterator]=function(){return this}),q;function Z(I){return function(X){return function M(I){if(j)throw new TypeError("Generator is already executing.");for(;T;)try{if(j=1,re&&(z=2&I[0]?re.return:I[0]?re.throw||((z=re.return)&&z.call(re),0):re.next)&&!(z=z.call(re,I[1])).done)return z;switch(re=0,z&&(I=[2&I[0],z.value]),I[0]){case 0:case 1:z=I;break;case 4:return T.label++,{value:I[1],done:!1};case 5:T.label++,re=I[1],I=[0];continue;case 7:I=T.ops.pop(),T.trys.pop();continue;default:if(!(z=(z=T.trys).length>0&&z[z.length-1])&&(6===I[0]||2===I[0])){T=0;continue}if(3===I[0]&&(!z||I[1]>z[0]&&I[1]<z[3])){T.label=I[1];break}if(6===I[0]&&T.label<z[1]){T.label=z[1],z=I;break}if(z&&T.label<z[2]){T.label=z[2],T.ops.push(I);break}z[2]&&T.ops.pop(),T.trys.pop();continue}I=Y.call(N,T)}catch(X){I=[6,X],re=0}finally{j=z=0}if(5&I[0])throw I[1];return{value:I[0]?I[1]:void 0,done:!0}}([I,X])}}},_=this&&this.__importDefault||function(N){return N&&N.__esModule?N:{default:N}};Object.defineProperty(le,"__esModule",{value:!0}),le.getGameSystemClass=void 0;var w=_(_e(5904)),O=_e(3583),x=_e(3693),K=_(_e(4682)),V=_(_e(3034));function A(N){var Y;return(Y=function(T){function j(re,z){return T.call(this,re,z??N.$new(re))||this}return d(j,T),j.eval=function(re){return x.parseResult(N.$eval(re))},j}(w.default)).ID=N.$const_get("ID"),Y.NAME=N.$const_get("NAME"),Y.SORT_KEY=N.$const_get("SORT_KEY"),Y.HELP_MESSAGE=N.$const_get("HELP_MESSAGE"),Y.COMMAND_PATTERN=N.$command_pattern(),Y}le.getGameSystemClass=A;var U=function(){function N(){}return N.prototype.getGameSystemIdByName=function(Y){var T,j=null===(T=this.listAvailableGameSystems().find(function(re){return re.name===Y}))||void 0===T?void 0:T.id;if(!j)throw new Error("GameSystem named "+Y+" does not exists");return j},N.prototype.getGameSystemInfo=function(Y){var T=this.listAvailableGameSystems().find(function(j){return j.id===Y});if(!T)throw new Error("GameSystem is not found");return T},N.prototype.getGameSystemClass=function(Y){var T=this.listLoadedGameSystems().find(function(j){return j.ID===Y});if(!T)throw new Error("GameSystem "+Y+" is not loaded");return T},N.prototype.getI18nInfos=function(Y){var T=Y.replace(/_[^0-9].*$/g,""),j=this.listAvailabletI18nInfoList().find(function(q){return q.baseClassName===T||q.baseClassName===Y}),re=j?[j]:[],z=this.listAvailableGameSystems().find(function(q){return q.className===Y});return z?Array.from(new Set(this.getI18nInfos(z.superClassName).concat(re))):re},N.prototype.listLoadedGameSystems=function(){var Y,T,j;return null!==(j=null===(T=null===(Y=O.BCDice.GameSystem)||void 0===Y?void 0:Y.$constants())||void 0===T?void 0:T.map(function(re){return A(O.BCDice.GameSystem[re])}))&&void 0!==j?j:[]},N.prototype.listAvailableGameSystems=function(){return K.default.gameSystems},N.prototype.listAvailabletI18nInfoList=function(){return V.default.i18nList},N.prototype.dynamicLoad=function(Y){var T;return H(this,void 0,void 0,function(){var j,re,z,q,Z,M,I,X,L,k,v,P,B;return J(this,function(te){switch(te.label){case 0:if(j=this.getGameSystemInfo(Y),!(re=null!==(T=j?.className)&&void 0!==T?T:Y).match(/^[A-Z]\w*$/))throw new Error("Invalid id");z=this.getI18nInfos(re),q=0,Z=z,te.label=1;case 1:if(!(q<Z.length))return[3,6];I=(M=Z[q]).locales.filter(function(D){return D===j.locale||D===O.I18n.$default_locale()}),X=0,L=I,te.label=2;case 2:return X<L.length?(P=(v=JSON).stringify,[4,this.dynamicImportI18n(M.baseClassName,L[X])]):[3,5];case 3:k=P.apply(v,[te.sent()]),O.I18n.$load_translation(k),te.label=4;case 4:return X++,[3,2];case 5:return q++,[3,1];case 6:return[4,this.dynamicImport(re)];case 7:if(te.sent(),!(B=O.BCDice.GameSystem.$const_get(re)))throw new Error("Failed to load game system");return[2,A(B)]}})})},N.prototype.dynamicImportI18n=function(Y,T){throw new Error("Not implemented")},N.prototype.dynamicImport=function(Y){throw new Error("Not implemented")},N}();le.default=U},3693:function(E,le,_e){"use strict";var d=this&&this.__assign||function(){return d=Object.assign||function(w){for(var O,x=1,K=arguments.length;x<K;x++)for(var V in O=arguments[x])Object.prototype.hasOwnProperty.call(O,V)&&(w[V]=O[V]);return w},d.apply(this,arguments)},H=this&&this.__rest||function(w,O){var x={};for(var K in w)Object.prototype.hasOwnProperty.call(w,K)&&O.indexOf(K)<0&&(x[K]=w[K]);if(null!=w&&"function"==typeof Object.getOwnPropertySymbols){var V=0;for(K=Object.getOwnPropertySymbols(w);V<K.length;V++)O.indexOf(K[V])<0&&Object.prototype.propertyIsEnumerable.call(w,K[V])&&(x[K[V]]=w[K[V]])}return x};Object.defineProperty(le,"__esModule",{value:!0}),le.parseResult=void 0;var J=_e(3583);le.parseResult=function _(w){if(w===J.Opal.nil)return null;var O=w.detailed_rands,x=H(w,["detailed_rands"]);return d(d({},x),{detailedRands:O.map(function(K){return K.$to_n()})})}},7585:function(E,le,_e){var d;E.exports=(d=d||function(H,J){var _;if(typeof window<"u"&&window.crypto&&(_=window.crypto),typeof self<"u"&&self.crypto&&(_=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(_=globalThis.crypto),!_&&typeof window<"u"&&window.msCrypto&&(_=window.msCrypto),!_&&typeof global<"u"&&global.crypto&&(_=global.crypto),!_)try{_=_e(2480)}catch{}var w=function(){if(_){if("function"==typeof _.getRandomValues)try{return _.getRandomValues(new Uint32Array(1))[0]}catch{}if("function"==typeof _.randomBytes)try{return _.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},O=Object.create||function(){function q(){}return function(Z){var M;return q.prototype=Z,M=new q,q.prototype=null,M}}(),x={},K=x.lib={},V=K.Base={extend:function(q){var Z=O(this);return q&&Z.mixIn(q),(!Z.hasOwnProperty("init")||this.init===Z.init)&&(Z.init=function(){Z.$super.init.apply(this,arguments)}),Z.init.prototype=Z,Z.$super=this,Z},create:function(){var q=this.extend();return q.init.apply(q,arguments),q},init:function(){},mixIn:function(q){for(var Z in q)q.hasOwnProperty(Z)&&(this[Z]=q[Z]);q.hasOwnProperty("toString")&&(this.toString=q.toString)},clone:function(){return this.init.prototype.extend(this)}},A=K.WordArray=V.extend({init:function(q,Z){q=this.words=q||[],this.sigBytes=null!=Z?Z:4*q.length},toString:function(q){return(q||N).stringify(this)},concat:function(q){var Z=this.words,M=q.words,I=this.sigBytes,X=q.sigBytes;if(this.clamp(),I%4)for(var L=0;L<X;L++)Z[I+L>>>2]|=(M[L>>>2]>>>24-L%4*8&255)<<24-(I+L)%4*8;else for(var k=0;k<X;k+=4)Z[I+k>>>2]=M[k>>>2];return this.sigBytes+=X,this},clamp:function(){var q=this.words,Z=this.sigBytes;q[Z>>>2]&=4294967295<<32-Z%4*8,q.length=H.ceil(Z/4)},clone:function(){var q=V.clone.call(this);return q.words=this.words.slice(0),q},random:function(q){for(var Z=[],M=0;M<q;M+=4)Z.push(w());return new A.init(Z,q)}}),U=x.enc={},N=U.Hex={stringify:function(q){for(var Z=q.words,M=q.sigBytes,I=[],X=0;X<M;X++){var L=Z[X>>>2]>>>24-X%4*8&255;I.push((L>>>4).toString(16)),I.push((15&L).toString(16))}return I.join("")},parse:function(q){for(var Z=q.length,M=[],I=0;I<Z;I+=2)M[I>>>3]|=parseInt(q.substr(I,2),16)<<24-I%8*4;return new A.init(M,Z/2)}},Y=U.Latin1={stringify:function(q){for(var Z=q.words,M=q.sigBytes,I=[],X=0;X<M;X++)I.push(String.fromCharCode(Z[X>>>2]>>>24-X%4*8&255));return I.join("")},parse:function(q){for(var Z=q.length,M=[],I=0;I<Z;I++)M[I>>>2]|=(255&q.charCodeAt(I))<<24-I%4*8;return new A.init(M,Z)}},T=U.Utf8={stringify:function(q){try{return decodeURIComponent(escape(Y.stringify(q)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(q){return Y.parse(unescape(encodeURIComponent(q)))}},j=K.BufferedBlockAlgorithm=V.extend({reset:function(){this._data=new A.init,this._nDataBytes=0},_append:function(q){"string"==typeof q&&(q=T.parse(q)),this._data.concat(q),this._nDataBytes+=q.sigBytes},_process:function(q){var Z,M=this._data,I=M.words,X=M.sigBytes,L=this.blockSize,k=X/(4*L),v=(k=q?H.ceil(k):H.max((0|k)-this._minBufferSize,0))*L,P=H.min(4*v,X);if(v){for(var B=0;B<v;B+=L)this._doProcessBlock(I,B);Z=I.splice(0,v),M.sigBytes-=P}return new A.init(Z,P)},clone:function(){var q=V.clone.call(this);return q._data=this._data.clone(),q},_minBufferSize:0}),z=(K.Hasher=j.extend({cfg:V.extend(),init:function(q){this.cfg=this.cfg.extend(q),this.reset()},reset:function(){j.reset.call(this),this._doReset()},update:function(q){return this._append(q),this._process(),this},finalize:function(q){return q&&this._append(q),this._doFinalize()},blockSize:16,_createHelper:function(q){return function(Z,M){return new q.init(M).finalize(Z)}},_createHmacHelper:function(q){return function(Z,M){return new z.HMAC.init(q,M).finalize(Z)}}}),x.algo={});return x}(Math),d)},7412:function(E,le,_e){var d;E.exports=(d=_e(7585),function(){if("function"==typeof ArrayBuffer){var _=d.lib.WordArray,w=_.init,O=_.init=function(x){if(x instanceof ArrayBuffer&&(x=new Uint8Array(x)),(x instanceof Int8Array||typeof Uint8ClampedArray<"u"&&x instanceof Uint8ClampedArray||x instanceof Int16Array||x instanceof Uint16Array||x instanceof Int32Array||x instanceof Uint32Array||x instanceof Float32Array||x instanceof Float64Array)&&(x=new Uint8Array(x.buffer,x.byteOffset,x.byteLength)),x instanceof Uint8Array){for(var K=x.byteLength,V=[],A=0;A<K;A++)V[A>>>2]|=x[A]<<24-A%4*8;w.call(this,V,K)}else w.apply(this,arguments)};O.prototype=_}}(),d.lib.WordArray)},1817:function(E,le,_e){var d;E.exports=(d=_e(7585),function(H){var J=d,_=J.lib,w=_.WordArray,O=_.Hasher,x=J.algo,K=[],V=[];!function(){function N(re){for(var z=H.sqrt(re),q=2;q<=z;q++)if(!(re%q))return!1;return!0}function Y(re){return 4294967296*(re-(0|re))|0}for(var T=2,j=0;j<64;)N(T)&&(j<8&&(K[j]=Y(H.pow(T,.5))),V[j]=Y(H.pow(T,1/3)),j++),T++}();var A=[],U=x.SHA256=O.extend({_doReset:function(){this._hash=new w.init(K.slice(0))},_doProcessBlock:function(N,Y){for(var T=this._hash.words,j=T[0],re=T[1],z=T[2],q=T[3],Z=T[4],M=T[5],I=T[6],X=T[7],L=0;L<64;L++){if(L<16)A[L]=0|N[Y+L];else{var S=A[L-15],v=A[L-2];A[L]=((S<<25|S>>>7)^(S<<14|S>>>18)^S>>>3)+A[L-7]+((v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10)+A[L-16]}var te=j&re^j&z^re&z,R=X+((Z<<26|Z>>>6)^(Z<<21|Z>>>11)^(Z<<7|Z>>>25))+(Z&M^~Z&I)+V[L]+A[L];X=I,I=M,M=Z,Z=q+R|0,q=z,z=re,re=j,j=R+(((j<<30|j>>>2)^(j<<19|j>>>13)^(j<<10|j>>>22))+te)|0}T[0]=T[0]+j|0,T[1]=T[1]+re|0,T[2]=T[2]+z|0,T[3]=T[3]+q|0,T[4]=T[4]+Z|0,T[5]=T[5]+M|0,T[6]=T[6]+I|0,T[7]=T[7]+X|0},_doFinalize:function(){var N=this._data,Y=N.words,T=8*this._nDataBytes,j=8*N.sigBytes;return Y[j>>>5]|=128<<24-j%32,Y[14+(j+64>>>9<<4)]=H.floor(T/4294967296),Y[15+(j+64>>>9<<4)]=T,N.sigBytes=4*Y.length,this._process(),this._hash},clone:function(){var N=O.clone.call(this);return N._hash=this._hash.clone(),N}});J.SHA256=O._createHelper(U),J.HmacSHA256=O._createHmacHelper(U)}(Math),d.SHA256)},6654:E=>{!function(_e){E.exports=_e;var d="listeners",H={on:function _(V,A){return K(this,V).push(A),this},once:function w(V,A){var U=this;return N.originalListener=A,K(U,V).push(N),U;function N(){O.call(U,V,N),A.apply(this,arguments)}},off:O,emit:function x(V,A){var U=this,N=K(U,V,!0);if(!N)return!1;var Y=arguments.length;if(1===Y)N.forEach(j);else if(2===Y)N.forEach(re);else{var T=Array.prototype.slice.call(arguments,1);N.forEach(z)}return!!N.length;function j(q){q.call(U)}function re(q){q.call(U,A)}function z(q){q.apply(U,T)}}};function J(V){for(var A in H)V[A]=H[A];return V}function O(V,A){var N,U=this;if(arguments.length){if(A){if(N=K(U,V,!0)){if(!(N=N.filter(Y)).length)return O.call(U,V);U[d][V]=N}}else if((N=U[d])&&(delete N[V],!Object.keys(N).length))return O.call(U)}else delete U[d];return U;function Y(T){return T!==A&&T.originalListener!==A}}function K(V,A,U){if(!U||V[d]){var N=V[d]||(V[d]={});return N[A]||(N[A]=[])}}J(_e.prototype),_e.mixin=J}(function le(){if(!(this instanceof le))return new le})},9069:E=>{"use strict";var d,le="object"==typeof Reflect?Reflect:null,_e=le&&"function"==typeof le.apply?le.apply:function(M,I,X){return Function.prototype.apply.call(M,I,X)};d=le&&"function"==typeof le.ownKeys?le.ownKeys:Object.getOwnPropertySymbols?function(M){return Object.getOwnPropertyNames(M).concat(Object.getOwnPropertySymbols(M))}:function(M){return Object.getOwnPropertyNames(M)};var J=Number.isNaN||function(M){return M!=M};function _(){_.init.call(this)}E.exports=_,E.exports.once=function re(Z,M){return new Promise(function(I,X){function L(k){Z.removeListener(M,S),X(k)}function S(){"function"==typeof Z.removeListener&&Z.removeListener("error",L),I([].slice.call(arguments))}q(Z,M,S,{once:!0}),"error"!==M&&function z(Z,M,I){"function"==typeof Z.on&&q(Z,"error",M,I)}(Z,L,{once:!0})})},_.EventEmitter=_,_.prototype._events=void 0,_.prototype._eventsCount=0,_.prototype._maxListeners=void 0;var w=10;function O(Z){if("function"!=typeof Z)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof Z)}function x(Z){return void 0===Z._maxListeners?_.defaultMaxListeners:Z._maxListeners}function K(Z,M,I,X){var L,S,k;if(O(I),void 0===(S=Z._events)?(S=Z._events=Object.create(null),Z._eventsCount=0):(void 0!==S.newListener&&(Z.emit("newListener",M,I.listener?I.listener:I),S=Z._events),k=S[M]),void 0===k)k=S[M]=I,++Z._eventsCount;else if("function"==typeof k?k=S[M]=X?[I,k]:[k,I]:X?k.unshift(I):k.push(I),(L=x(Z))>0&&k.length>L&&!k.warned){k.warned=!0;var v=new Error("Possible EventEmitter memory leak detected. "+k.length+" "+String(M)+" listeners added. Use emitter.setMaxListeners() to increase limit");v.name="MaxListenersExceededWarning",v.emitter=Z,v.type=M,v.count=k.length,function H(Z){console&&console.warn&&console.warn(Z)}(v)}return Z}function V(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function A(Z,M,I){var X={fired:!1,wrapFn:void 0,target:Z,type:M,listener:I},L=V.bind(X);return L.listener=I,X.wrapFn=L,L}function U(Z,M,I){var X=Z._events;if(void 0===X)return[];var L=X[M];return void 0===L?[]:"function"==typeof L?I?[L.listener||L]:[L]:I?function j(Z){for(var M=new Array(Z.length),I=0;I<M.length;++I)M[I]=Z[I].listener||Z[I];return M}(L):Y(L,L.length)}function N(Z){var M=this._events;if(void 0!==M){var I=M[Z];if("function"==typeof I)return 1;if(void 0!==I)return I.length}return 0}function Y(Z,M){for(var I=new Array(M),X=0;X<M;++X)I[X]=Z[X];return I}function q(Z,M,I,X){if("function"==typeof Z.on)X.once?Z.once(M,I):Z.on(M,I);else{if("function"!=typeof Z.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof Z);Z.addEventListener(M,function L(S){X.once&&Z.removeEventListener(M,L),I(S)})}}Object.defineProperty(_,"defaultMaxListeners",{enumerable:!0,get:function(){return w},set:function(Z){if("number"!=typeof Z||Z<0||J(Z))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+Z+".");w=Z}}),_.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},_.prototype.setMaxListeners=function(M){if("number"!=typeof M||M<0||J(M))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+M+".");return this._maxListeners=M,this},_.prototype.getMaxListeners=function(){return x(this)},_.prototype.emit=function(M){for(var I=[],X=1;X<arguments.length;X++)I.push(arguments[X]);var L="error"===M,S=this._events;if(void 0!==S)L=L&&void 0===S.error;else if(!L)return!1;if(L){var k;if(I.length>0&&(k=I[0]),k instanceof Error)throw k;var v=new Error("Unhandled error."+(k?" ("+k.message+")":""));throw v.context=k,v}var P=S[M];if(void 0===P)return!1;if("function"==typeof P)_e(P,this,I);else{var B=P.length,te=Y(P,B);for(X=0;X<B;++X)_e(te[X],this,I)}return!0},_.prototype.on=_.prototype.addListener=function(M,I){return K(this,M,I,!1)},_.prototype.prependListener=function(M,I){return K(this,M,I,!0)},_.prototype.once=function(M,I){return O(I),this.on(M,A(this,M,I)),this},_.prototype.prependOnceListener=function(M,I){return O(I),this.prependListener(M,A(this,M,I)),this},_.prototype.off=_.prototype.removeListener=function(M,I){var X,L,S,k,v;if(O(I),void 0===(L=this._events))return this;if(void 0===(X=L[M]))return this;if(X===I||X.listener===I)0==--this._eventsCount?this._events=Object.create(null):(delete L[M],L.removeListener&&this.emit("removeListener",M,X.listener||I));else if("function"!=typeof X){for(S=-1,k=X.length-1;k>=0;k--)if(X[k]===I||X[k].listener===I){v=X[k].listener,S=k;break}if(S<0)return this;0===S?X.shift():function T(Z,M){for(;M+1<Z.length;M++)Z[M]=Z[M+1];Z.pop()}(X,S),1===X.length&&(L[M]=X[0]),void 0!==L.removeListener&&this.emit("removeListener",M,v||I)}return this},_.prototype.removeAllListeners=function(M){var I,X,L;if(void 0===(X=this._events))return this;if(void 0===X.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==X[M]&&(0==--this._eventsCount?this._events=Object.create(null):delete X[M]),this;if(0===arguments.length){var k,S=Object.keys(X);for(L=0;L<S.length;++L)"removeListener"!==(k=S[L])&&this.removeAllListeners(k);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(I=X[M]))this.removeListener(M,I);else if(void 0!==I)for(L=I.length-1;L>=0;L--)this.removeListener(M,I[L]);return this},_.prototype.listeners=function(M){return U(this,M,!0)},_.prototype.rawListeners=function(M){return U(this,M,!1)},_.listenerCount=function(Z,M){return"function"==typeof Z.listenerCount?Z.listenerCount(M):N.call(Z,M)},_.prototype.listenerCount=N,_.prototype.eventNames=function(){return this._eventsCount>0?d(this._events):[]}},4327:function(E,le){var H;void 0!==(H=function(){"use strict";function _(A,U,N){var Y=new XMLHttpRequest;Y.open("GET",A),Y.responseType="blob",Y.onload=function(){V(Y.response,U,N)},Y.onerror=function(){console.error("could not download file")},Y.send()}function w(A){var U=new XMLHttpRequest;U.open("HEAD",A,!1);try{U.send()}catch{}return 200<=U.status&&299>=U.status}function O(A){try{A.dispatchEvent(new MouseEvent("click"))}catch{var U=document.createEvent("MouseEvents");U.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),A.dispatchEvent(U)}}var x="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,K=x.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),V=x.saveAs||("object"!=typeof window||window!==x?function(){}:"download"in HTMLAnchorElement.prototype&&!K?function(A,U,N){var Y=x.URL||x.webkitURL,T=document.createElement("a");T.download=U=U||A.name||"download",T.rel="noopener","string"==typeof A?(T.href=A,T.origin===location.origin?O(T):w(T.href)?_(A,U,N):O(T,T.target="_blank")):(T.href=Y.createObjectURL(A),setTimeout(function(){Y.revokeObjectURL(T.href)},4e4),setTimeout(function(){O(T)},0))}:"msSaveOrOpenBlob"in navigator?function(A,U,N){if(U=U||A.name||"download","string"!=typeof A)navigator.msSaveOrOpenBlob(function J(A,U){return typeof U>"u"?U={autoBom:!1}:"object"!=typeof U&&(console.warn("Deprecated: Expected third argument to be a object"),U={autoBom:!U}),U.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(A.type)?new Blob(["\ufeff",A],{type:A.type}):A}(A,N),U);else if(w(A))_(A,U,N);else{var Y=document.createElement("a");Y.href=A,Y.target="_blank",setTimeout(function(){O(Y)})}}:function(A,U,N,Y){if((Y=Y||open("","_blank"))&&(Y.document.title=Y.document.body.innerText="downloading..."),"string"==typeof A)return _(A,U,N);var T="application/octet-stream"===A.type,j=/constructor/i.test(x.HTMLElement)||x.safari,re=/CriOS\/[\d]+/.test(navigator.userAgent);if((re||T&&j||K)&&typeof FileReader<"u"){var z=new FileReader;z.onloadend=function(){var M=z.result;M=re?M:M.replace(/^data:[^;]*;/,"data:attachment/file;"),Y?Y.location.href=M:location=M,Y=null},z.readAsDataURL(A)}else{var q=x.URL||x.webkitURL,Z=q.createObjectURL(A);Y?Y.location=Z:location.href=Z,Y=null,setTimeout(function(){q.revokeObjectURL(Z)},4e4)}});x.saveAs=V.saveAs=V,E.exports=V}.apply(le,[]))&&(E.exports=H)},5386:(E,le,_e)=>{var d;!function(H,J,_,w){"use strict";var re,O=["","webkit","Moz","MS","ms","o"],x=J.createElement("div"),V=Math.round,A=Math.abs,U=Date.now;function N(Ne,ze,Ze){return setTimeout(M(Ne,Ze),ze)}function Y(Ne,ze,Ze){return!!Array.isArray(Ne)&&(T(Ne,Ze[ze],Ze),!0)}function T(Ne,ze,Ze){var ct;if(Ne)if(Ne.forEach)Ne.forEach(ze,Ze);else if(Ne.length!==w)for(ct=0;ct<Ne.length;)ze.call(Ze,Ne[ct],ct,Ne),ct++;else for(ct in Ne)Ne.hasOwnProperty(ct)&&ze.call(Ze,Ne[ct],ct,Ne)}function j(Ne,ze,Ze){var ct="DEPRECATED METHOD: "+ze+"\n"+Ze+" AT \n";return function(){var Pt=new Error("get-stack-trace"),qt=Pt&&Pt.stack?Pt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Rn=H.console&&(H.console.warn||H.console.log);return Rn&&Rn.call(H.console,ct,qt),Ne.apply(this,arguments)}}re="function"!=typeof Object.assign?function(ze){if(ze===w||null===ze)throw new TypeError("Cannot convert undefined or null to object");for(var Ze=Object(ze),ct=1;ct<arguments.length;ct++){var Pt=arguments[ct];if(Pt!==w&&null!==Pt)for(var qt in Pt)Pt.hasOwnProperty(qt)&&(Ze[qt]=Pt[qt])}return Ze}:Object.assign;var z=j(function(ze,Ze,ct){for(var Pt=Object.keys(Ze),qt=0;qt<Pt.length;)(!ct||ct&&ze[Pt[qt]]===w)&&(ze[Pt[qt]]=Ze[Pt[qt]]),qt++;return ze},"extend","Use `assign`."),q=j(function(ze,Ze){return z(ze,Ze,!0)},"merge","Use `assign`.");function Z(Ne,ze,Ze){var Pt,ct=ze.prototype;(Pt=Ne.prototype=Object.create(ct)).constructor=Ne,Pt._super=ct,Ze&&re(Pt,Ze)}function M(Ne,ze){return function(){return Ne.apply(ze,arguments)}}function I(Ne,ze){return"function"==typeof Ne?Ne.apply(ze&&ze[0]||w,ze):Ne}function X(Ne,ze){return Ne===w?ze:Ne}function L(Ne,ze,Ze){T(P(ze),function(ct){Ne.addEventListener(ct,Ze,!1)})}function S(Ne,ze,Ze){T(P(ze),function(ct){Ne.removeEventListener(ct,Ze,!1)})}function k(Ne,ze){for(;Ne;){if(Ne==ze)return!0;Ne=Ne.parentNode}return!1}function v(Ne,ze){return Ne.indexOf(ze)>-1}function P(Ne){return Ne.trim().split(/\s+/g)}function B(Ne,ze,Ze){if(Ne.indexOf&&!Ze)return Ne.indexOf(ze);for(var ct=0;ct<Ne.length;){if(Ze&&Ne[ct][Ze]==ze||!Ze&&Ne[ct]===ze)return ct;ct++}return-1}function te(Ne){return Array.prototype.slice.call(Ne,0)}function D(Ne,ze,Ze){for(var ct=[],Pt=[],qt=0;qt<Ne.length;){var Rn=ze?Ne[qt][ze]:Ne[qt];B(Pt,Rn)<0&&ct.push(Ne[qt]),Pt[qt]=Rn,qt++}return Ze&&(ct=ze?ct.sort(function(Ji,yr){return Ji[ze]>yr[ze]}):ct.sort()),ct}function fe(Ne,ze){for(var Ze,ct,Pt=ze[0].toUpperCase()+ze.slice(1),qt=0;qt<O.length;){if((ct=(Ze=O[qt])?Ze+Pt:ze)in Ne)return ct;qt++}return w}var R=1;function g(Ne){var ze=Ne.ownerDocument||Ne;return ze.defaultView||ze.parentWindow||H}var c="ontouchstart"in H,f=fe(H,"PointerEvent")!==w,u=c&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),p="touch",C="mouse",Ce=["x","y"],y=["clientX","clientY"];function W(Ne,ze){var Ze=this;this.manager=Ne,this.callback=ze,this.element=Ne.element,this.target=Ne.options.inputTarget,this.domHandler=function(ct){I(Ne.options.enable,[Ne])&&Ze.handler(ct)},this.init()}function we(Ne,ze,Ze){var ct=Ze.pointers.length,Pt=Ze.changedPointers.length,qt=1&ze&&ct-Pt==0,Rn=12&ze&&ct-Pt==0;Ze.isFirst=!!qt,Ze.isFinal=!!Rn,qt&&(Ne.session={}),Ze.eventType=ze,function De(Ne,ze){var Ze=Ne.session,ct=ze.pointers,Pt=ct.length;Ze.firstInput||(Ze.firstInput=at(ze)),Pt>1&&!Ze.firstMultiple?Ze.firstMultiple=at(ze):1===Pt&&(Ze.firstMultiple=!1);var qt=Ze.firstInput,Rn=Ze.firstMultiple,fi=Rn?Rn.center:qt.center,Ji=ze.center=It(ct);ze.timeStamp=U(),ze.deltaTime=ze.timeStamp-qt.timeStamp,ze.angle=Dn(fi,Ji),ze.distance=Jt(fi,Ji),function Fe(Ne,ze){var Ze=ze.center,ct=Ne.offsetDelta||{},Pt=Ne.prevDelta||{},qt=Ne.prevInput||{};(1===ze.eventType||4===qt.eventType)&&(Pt=Ne.prevDelta={x:qt.deltaX||0,y:qt.deltaY||0},ct=Ne.offsetDelta={x:Ze.x,y:Ze.y}),ze.deltaX=Pt.x+(Ze.x-ct.x),ze.deltaY=Pt.y+(Ze.y-ct.y)}(Ze,ze),ze.offsetDirection=ln(ze.deltaX,ze.deltaY);var yr=At(ze.deltaTime,ze.deltaX,ze.deltaY);ze.overallVelocityX=yr.x,ze.overallVelocityY=yr.y,ze.overallVelocity=A(yr.x)>A(yr.y)?yr.x:yr.y,ze.scale=Rn?function vr(Ne,ze){return Jt(ze[0],ze[1],y)/Jt(Ne[0],Ne[1],y)}(Rn.pointers,ct):1,ze.rotation=Rn?function Tn(Ne,ze){return Dn(ze[1],ze[0],y)+Dn(Ne[1],Ne[0],y)}(Rn.pointers,ct):0,ze.maxPointers=Ze.prevInput?ze.pointers.length>Ze.prevInput.maxPointers?ze.pointers.length:Ze.prevInput.maxPointers:ze.pointers.length,function Ye(Ne,ze){var Pt,qt,Rn,fi,Ze=Ne.lastInterval||ze,ct=ze.timeStamp-Ze.timeStamp;if(8!=ze.eventType&&(ct>25||Ze.velocity===w)){var Ji=ze.deltaX-Ze.deltaX,yr=ze.deltaY-Ze.deltaY,ho=At(ct,Ji,yr);qt=ho.x,Rn=ho.y,Pt=A(ho.x)>A(ho.y)?ho.x:ho.y,fi=ln(Ji,yr),Ne.lastInterval=ze}else Pt=Ze.velocity,qt=Ze.velocityX,Rn=Ze.velocityY,fi=Ze.direction;ze.velocity=Pt,ze.velocityX=qt,ze.velocityY=Rn,ze.direction=fi}(Ze,ze);var ho=Ne.element;k(ze.srcEvent.target,ho)&&(ho=ze.srcEvent.target),ze.target=ho}(Ne,Ze),Ne.emit("hammer.input",Ze),Ne.recognize(Ze),Ne.session.prevInput=Ze}function at(Ne){for(var ze=[],Ze=0;Ze<Ne.pointers.length;)ze[Ze]={clientX:V(Ne.pointers[Ze].clientX),clientY:V(Ne.pointers[Ze].clientY)},Ze++;return{timeStamp:U(),pointers:ze,center:It(ze),deltaX:Ne.deltaX,deltaY:Ne.deltaY}}function It(Ne){var ze=Ne.length;if(1===ze)return{x:V(Ne[0].clientX),y:V(Ne[0].clientY)};for(var Ze=0,ct=0,Pt=0;Pt<ze;)Ze+=Ne[Pt].clientX,ct+=Ne[Pt].clientY,Pt++;return{x:V(Ze/ze),y:V(ct/ze)}}function At(Ne,ze,Ze){return{x:ze/Ne||0,y:Ze/Ne||0}}function ln(Ne,ze){return Ne===ze?1:A(Ne)>=A(ze)?Ne<0?2:4:ze<0?8:16}function Jt(Ne,ze,Ze){Ze||(Ze=Ce);var ct=ze[Ze[0]]-Ne[Ze[0]],Pt=ze[Ze[1]]-Ne[Ze[1]];return Math.sqrt(ct*ct+Pt*Pt)}function Dn(Ne,ze,Ze){return Ze||(Ze=Ce),180*Math.atan2(ze[Ze[1]]-Ne[Ze[1]],ze[Ze[0]]-Ne[Ze[0]])/Math.PI}W.prototype={handler:function(){},init:function(){this.evEl&&L(this.element,this.evEl,this.domHandler),this.evTarget&&L(this.target,this.evTarget,this.domHandler),this.evWin&&L(g(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&S(this.element,this.evEl,this.domHandler),this.evTarget&&S(this.target,this.evTarget,this.domHandler),this.evWin&&S(g(this.element),this.evWin,this.domHandler)}};var fa={mousedown:1,mousemove:2,mouseup:4},ja="mousedown",Ua="mousemove mouseup";function wo(){this.evEl=ja,this.evWin=Ua,this.pressed=!1,W.apply(this,arguments)}Z(wo,W,{handler:function(ze){var Ze=fa[ze.type];1&Ze&&0===ze.button&&(this.pressed=!0),2&Ze&&1!==ze.which&&(Ze=4),this.pressed&&(4&Ze&&(this.pressed=!1),this.callback(this.manager,Ze,{pointers:[ze],changedPointers:[ze],pointerType:C,srcEvent:ze}))}});var or={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},Ic={2:p,3:"pen",4:C,5:"kinect"},Ml="pointerdown",Ha="pointermove pointerup pointercancel";function Va(){this.evEl=Ml,this.evWin=Ha,W.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}H.MSPointerEvent&&!H.PointerEvent&&(Ml="MSPointerDown",Ha="MSPointerMove MSPointerUp MSPointerCancel"),Z(Va,W,{handler:function(ze){var Ze=this.store,ct=!1,Pt=ze.type.toLowerCase().replace("ms",""),qt=or[Pt],Rn=Ic[ze.pointerType]||ze.pointerType,fi=Rn==p,Ji=B(Ze,ze.pointerId,"pointerId");1&qt&&(0===ze.button||fi)?Ji<0&&(Ze.push(ze),Ji=Ze.length-1):12&qt&&(ct=!0),!(Ji<0)&&(Ze[Ji]=ze,this.callback(this.manager,qt,{pointers:Ze,changedPointers:[ze],pointerType:Rn,srcEvent:ze}),ct&&Ze.splice(Ji,1))}});var Qu={touchstart:1,touchmove:2,touchend:4,touchcancel:8},Mc="touchstart",kc="touchstart touchmove touchend touchcancel";function kl(){this.evTarget=Mc,this.evWin=kc,this.started=!1,W.apply(this,arguments)}function Dc(Ne,ze){var Ze=te(Ne.touches),ct=te(Ne.changedTouches);return 12&ze&&(Ze=D(Ze.concat(ct),"identifier",!0)),[Ze,ct]}Z(kl,W,{handler:function(ze){var Ze=Qu[ze.type];if(1===Ze&&(this.started=!0),this.started){var ct=Dc.call(this,ze,Ze);12&Ze&&ct[0].length-ct[1].length==0&&(this.started=!1),this.callback(this.manager,Ze,{pointers:ct[0],changedPointers:ct[1],pointerType:p,srcEvent:ze})}}});var br={touchstart:1,touchmove:2,touchend:4,touchcancel:8},Ju="touchstart touchmove touchend touchcancel";function Ga(){this.evTarget=Ju,this.targetIds={},W.apply(this,arguments)}function ed(Ne,ze){var Ze=te(Ne.touches),ct=this.targetIds;if(3&ze&&1===Ze.length)return ct[Ze[0].identifier]=!0,[Ze,Ze];var Pt,qt,Rn=te(Ne.changedTouches),fi=[],Ji=this.target;if(qt=Ze.filter(function(yr){return k(yr.target,Ji)}),1===ze)for(Pt=0;Pt<qt.length;)ct[qt[Pt].identifier]=!0,Pt++;for(Pt=0;Pt<Rn.length;)ct[Rn[Pt].identifier]&&fi.push(Rn[Pt]),12&ze&&delete ct[Rn[Pt].identifier],Pt++;return fi.length?[D(qt.concat(fi),"identifier",!0),fi]:void 0}function Al(){W.apply(this,arguments);var Ne=M(this.handler,this);this.touch=new Ga(this.manager,Ne),this.mouse=new wo(this.manager,Ne),this.primaryTouch=null,this.lastTouches=[]}function td(Ne,ze){1&Ne?(this.primaryTouch=ze.changedPointers[0].identifier,uo.call(this,ze)):12&Ne&&uo.call(this,ze)}function uo(Ne){var ze=Ne.changedPointers[0];if(ze.identifier===this.primaryTouch){var Ze={x:ze.clientX,y:ze.clientY};this.lastTouches.push(Ze);var ct=this.lastTouches;setTimeout(function(){var qt=ct.indexOf(Ze);qt>-1&&ct.splice(qt,1)},2500)}}function nd(Ne){for(var ze=Ne.srcEvent.clientX,Ze=Ne.srcEvent.clientY,ct=0;ct<this.lastTouches.length;ct++){var Pt=this.lastTouches[ct],qt=Math.abs(ze-Pt.x),Rn=Math.abs(Ze-Pt.y);if(qt<=25&&Rn<=25)return!0}return!1}Z(Ga,W,{handler:function(ze){var Ze=br[ze.type],ct=ed.call(this,ze,Ze);!ct||this.callback(this.manager,Ze,{pointers:ct[0],changedPointers:ct[1],pointerType:p,srcEvent:ze})}}),Z(Al,W,{handler:function(ze,Ze,ct){var qt=ct.pointerType==C;if(!(qt&&ct.sourceCapabilities&&ct.sourceCapabilities.firesTouchEvents)){if(ct.pointerType==p)td.call(this,Ze,ct);else if(qt&&nd.call(this,ct))return;this.callback(ze,Ze,ct)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Ls=fe(x.style,"touchAction"),Pl=Ls!==w,qa="compute",Nl="manipulation",qo="none",ms="pan-x",Wo="pan-y",Ko=function Bs(){if(!Pl)return!1;var Ne={},ze=H.CSS&&H.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Ze){Ne[Ze]=!ze||H.CSS.supports("touch-action",Ze)}),Ne}();function Ol(Ne,ze){this.manager=Ne,this.set(ze)}function Qi(Ne){this.options=re({},this.defaults,Ne||{}),this.id=function F(){return R++}(),this.manager=null,this.options.enable=X(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function ga(Ne){return 16&Ne?"cancel":8&Ne?"end":4&Ne?"move":2&Ne?"start":""}function Pc(Ne){return 16==Ne?"down":8==Ne?"up":2==Ne?"left":4==Ne?"right":""}function Be(Ne,ze){var Ze=ze.manager;return Ze?Ze.get(Ne):Ne}function Ke(){Qi.apply(this,arguments)}function Ge(){Ke.apply(this,arguments),this.pX=null,this.pY=null}function Xe(){Ke.apply(this,arguments)}function ot(){Qi.apply(this,arguments),this._timer=null,this._input=null}function Je(){Ke.apply(this,arguments)}function $t(){Ke.apply(this,arguments)}function gt(){Qi.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Nt(Ne,ze){return(ze=ze||{}).recognizers=X(ze.recognizers,Nt.defaults.preset),new Kt(Ne,ze)}function Kt(Ne,ze){this.options=re({},Nt.defaults,ze||{}),this.options.inputTarget=this.options.inputTarget||Ne,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Ne,this.input=function pe(Ne){return new(Ne.options.inputClass||(f?Va:u?Ga:c?Al:wo))(Ne,we)}(this),this.touchAction=new Ol(this,this.options.touchAction),zt(this,!0),T(this.options.recognizers,function(Ze){var ct=this.add(new Ze[0](Ze[1]));Ze[2]&&ct.recognizeWith(Ze[2]),Ze[3]&&ct.requireFailure(Ze[3])},this)}function zt(Ne,ze){var ct,Ze=Ne.element;Ze.style&&(T(Ne.options.cssProps,function(Pt,qt){ct=fe(Ze.style,qt),ze?(Ne.oldCssProps[ct]=Ze.style[ct],Ze.style[ct]=Pt):Ze.style[ct]=Ne.oldCssProps[ct]||""}),ze||(Ne.oldCssProps={}))}Ol.prototype={set:function(Ne){Ne==qa&&(Ne=this.compute()),Pl&&this.manager.element.style&&Ko[Ne]&&(this.manager.element.style[Ls]=Ne),this.actions=Ne.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Ne=[];return T(this.manager.recognizers,function(ze){I(ze.options.enable,[ze])&&(Ne=Ne.concat(ze.getTouchAction()))}),function Fl(Ne){if(v(Ne,qo))return qo;var ze=v(Ne,ms),Ze=v(Ne,Wo);return ze&&Ze?qo:ze||Ze?ze?ms:Wo:v(Ne,Nl)?Nl:"auto"}(Ne.join(" "))},preventDefaults:function(Ne){var ze=Ne.srcEvent,Ze=Ne.offsetDirection;if(!this.manager.session.prevented){var ct=this.actions,Pt=v(ct,qo)&&!Ko[qo],qt=v(ct,Wo)&&!Ko[Wo],Rn=v(ct,ms)&&!Ko[ms];if(Pt&&1===Ne.pointers.length&&Ne.distance<2&&Ne.deltaTime<250)return;return Rn&&qt||!(Pt||qt&&6&Ze||Rn&&24&Ze)?void 0:this.preventSrc(ze)}ze.preventDefault()},preventSrc:function(Ne){this.manager.session.prevented=!0,Ne.preventDefault()}},Qi.prototype={defaults:{},set:function(Ne){return re(this.options,Ne),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Ne){if(Y(Ne,"recognizeWith",this))return this;var ze=this.simultaneous;return ze[(Ne=Be(Ne,this)).id]||(ze[Ne.id]=Ne,Ne.recognizeWith(this)),this},dropRecognizeWith:function(Ne){return Y(Ne,"dropRecognizeWith",this)||(Ne=Be(Ne,this),delete this.simultaneous[Ne.id]),this},requireFailure:function(Ne){if(Y(Ne,"requireFailure",this))return this;var ze=this.requireFail;return-1===B(ze,Ne=Be(Ne,this))&&(ze.push(Ne),Ne.requireFailure(this)),this},dropRequireFailure:function(Ne){if(Y(Ne,"dropRequireFailure",this))return this;Ne=Be(Ne,this);var ze=B(this.requireFail,Ne);return ze>-1&&this.requireFail.splice(ze,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Ne){return!!this.simultaneous[Ne.id]},emit:function(Ne){var ze=this,Ze=this.state;function ct(Pt){ze.manager.emit(Pt,Ne)}Ze<8&&ct(ze.options.event+ga(Ze)),ct(ze.options.event),Ne.additionalEvent&&ct(Ne.additionalEvent),Ze>=8&&ct(ze.options.event+ga(Ze))},tryEmit:function(Ne){if(this.canEmit())return this.emit(Ne);this.state=32},canEmit:function(){for(var Ne=0;Ne<this.requireFail.length;){if(!(33&this.requireFail[Ne].state))return!1;Ne++}return!0},recognize:function(Ne){var ze=re({},Ne);if(!I(this.options.enable,[this,ze]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(ze),30&this.state&&this.tryEmit(ze)},process:function(Ne){},getTouchAction:function(){},reset:function(){}},Z(Ke,Qi,{defaults:{pointers:1},attrTest:function(Ne){var ze=this.options.pointers;return 0===ze||Ne.pointers.length===ze},process:function(Ne){var ze=this.state,Ze=Ne.eventType,ct=6&ze,Pt=this.attrTest(Ne);return ct&&(8&Ze||!Pt)?16|ze:ct||Pt?4&Ze?8|ze:2&ze?4|ze:2:32}}),Z(Ge,Ke,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var Ne=this.options.direction,ze=[];return 6&Ne&&ze.push(Wo),24&Ne&&ze.push(ms),ze},directionTest:function(Ne){var ze=this.options,Ze=!0,ct=Ne.distance,Pt=Ne.direction,qt=Ne.deltaX,Rn=Ne.deltaY;return Pt&ze.direction||(6&ze.direction?(Pt=0===qt?1:qt<0?2:4,Ze=qt!=this.pX,ct=Math.abs(Ne.deltaX)):(Pt=0===Rn?1:Rn<0?8:16,Ze=Rn!=this.pY,ct=Math.abs(Ne.deltaY))),Ne.direction=Pt,Ze&&ct>ze.threshold&&Pt&ze.direction},attrTest:function(Ne){return Ke.prototype.attrTest.call(this,Ne)&&(2&this.state||!(2&this.state)&&this.directionTest(Ne))},emit:function(Ne){this.pX=Ne.deltaX,this.pY=Ne.deltaY;var ze=Pc(Ne.direction);ze&&(Ne.additionalEvent=this.options.event+ze),this._super.emit.call(this,Ne)}}),Z(Xe,Ke,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[qo]},attrTest:function(Ne){return this._super.attrTest.call(this,Ne)&&(Math.abs(Ne.scale-1)>this.options.threshold||2&this.state)},emit:function(Ne){1!==Ne.scale&&(Ne.additionalEvent=this.options.event+(Ne.scale<1?"in":"out")),this._super.emit.call(this,Ne)}}),Z(ot,Qi,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(Ne){var ze=this.options,Ze=Ne.pointers.length===ze.pointers,ct=Ne.distance<ze.threshold,Pt=Ne.deltaTime>ze.time;if(this._input=Ne,!ct||!Ze||12&Ne.eventType&&!Pt)this.reset();else if(1&Ne.eventType)this.reset(),this._timer=N(function(){this.state=8,this.tryEmit()},ze.time,this);else if(4&Ne.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(Ne){8===this.state&&(Ne&&4&Ne.eventType?this.manager.emit(this.options.event+"up",Ne):(this._input.timeStamp=U(),this.manager.emit(this.options.event,this._input)))}}),Z(Je,Ke,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[qo]},attrTest:function(Ne){return this._super.attrTest.call(this,Ne)&&(Math.abs(Ne.rotation)>this.options.threshold||2&this.state)}}),Z($t,Ke,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Ge.prototype.getTouchAction.call(this)},attrTest:function(Ne){var Ze,ze=this.options.direction;return 30&ze?Ze=Ne.overallVelocity:6&ze?Ze=Ne.overallVelocityX:24&ze&&(Ze=Ne.overallVelocityY),this._super.attrTest.call(this,Ne)&&ze&Ne.offsetDirection&&Ne.distance>this.options.threshold&&Ne.maxPointers==this.options.pointers&&A(Ze)>this.options.velocity&&4&Ne.eventType},emit:function(Ne){var ze=Pc(Ne.offsetDirection);ze&&this.manager.emit(this.options.event+ze,Ne),this.manager.emit(this.options.event,Ne)}}),Z(gt,Qi,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Nl]},process:function(Ne){var ze=this.options,Ze=Ne.pointers.length===ze.pointers,ct=Ne.distance<ze.threshold,Pt=Ne.deltaTime<ze.time;if(this.reset(),1&Ne.eventType&&0===this.count)return this.failTimeout();if(ct&&Pt&&Ze){if(4!=Ne.eventType)return this.failTimeout();var qt=!this.pTime||Ne.timeStamp-this.pTime<ze.interval,Rn=!this.pCenter||Jt(this.pCenter,Ne.center)<ze.posThreshold;if(this.pTime=Ne.timeStamp,this.pCenter=Ne.center,Rn&&qt?this.count+=1:this.count=1,this._input=Ne,0==this.count%ze.taps)return this.hasRequireFailures()?(this._timer=N(function(){this.state=8,this.tryEmit()},ze.interval,this),2):8}return 32},failTimeout:function(){return this._timer=N(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Nt.VERSION="2.0.7",Nt.defaults={domEvents:!1,touchAction:qa,enable:!0,inputTarget:null,inputClass:null,preset:[[Je,{enable:!1}],[Xe,{enable:!1},["rotate"]],[$t,{direction:6}],[Ge,{direction:6},["swipe"]],[gt],[gt,{event:"doubletap",taps:2},["tap"]],[ot]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Kt.prototype={set:function(Ne){return re(this.options,Ne),Ne.touchAction&&this.touchAction.update(),Ne.inputTarget&&(this.input.destroy(),this.input.target=Ne.inputTarget,this.input.init()),this},stop:function(Ne){this.session.stopped=Ne?2:1},recognize:function(Ne){var ze=this.session;if(!ze.stopped){this.touchAction.preventDefaults(Ne);var Ze,ct=this.recognizers,Pt=ze.curRecognizer;(!Pt||Pt&&8&Pt.state)&&(Pt=ze.curRecognizer=null);for(var qt=0;qt<ct.length;)Ze=ct[qt],2===ze.stopped||Pt&&Ze!=Pt&&!Ze.canRecognizeWith(Pt)?Ze.reset():Ze.recognize(Ne),!Pt&&14&Ze.state&&(Pt=ze.curRecognizer=Ze),qt++}},get:function(Ne){if(Ne instanceof Qi)return Ne;for(var ze=this.recognizers,Ze=0;Ze<ze.length;Ze++)if(ze[Ze].options.event==Ne)return ze[Ze];return null},add:function(Ne){if(Y(Ne,"add",this))return this;var ze=this.get(Ne.options.event);return ze&&this.remove(ze),this.recognizers.push(Ne),Ne.manager=this,this.touchAction.update(),Ne},remove:function(Ne){if(Y(Ne,"remove",this))return this;if(Ne=this.get(Ne)){var ze=this.recognizers,Ze=B(ze,Ne);-1!==Ze&&(ze.splice(Ze,1),this.touchAction.update())}return this},on:function(Ne,ze){if(Ne!==w&&ze!==w){var Ze=this.handlers;return T(P(Ne),function(ct){Ze[ct]=Ze[ct]||[],Ze[ct].push(ze)}),this}},off:function(Ne,ze){if(Ne!==w){var Ze=this.handlers;return T(P(Ne),function(ct){ze?Ze[ct]&&Ze[ct].splice(B(Ze[ct],ze),1):delete Ze[ct]}),this}},emit:function(Ne,ze){this.options.domEvents&&function en(Ne,ze){var Ze=J.createEvent("Event");Ze.initEvent(Ne,!0,!0),Ze.gesture=ze,ze.target.dispatchEvent(Ze)}(Ne,ze);var Ze=this.handlers[Ne]&&this.handlers[Ne].slice();if(Ze&&Ze.length){ze.type=Ne,ze.preventDefault=function(){ze.srcEvent.preventDefault()};for(var ct=0;ct<Ze.length;)Ze[ct](ze),ct++}},destroy:function(){this.element&&zt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},re(Nt,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Kt,Input:W,TouchAction:Ol,TouchInput:Ga,MouseInput:wo,PointerEventInput:Va,TouchMouseInput:Al,SingleTouchInput:kl,Recognizer:Qi,AttrRecognizer:Ke,Tap:gt,Pan:Ge,Swipe:$t,Pinch:Xe,Rotate:Je,Press:ot,on:L,off:S,each:T,merge:q,extend:z,assign:re,inherit:Z,bindFn:M,prefixed:fe}),(typeof H<"u"?H:typeof self<"u"?self:{}).Hammer=Nt,(d=function(){return Nt}.call(le,_e,le,E))!==w&&(E.exports=d)}(window,document)},8461:(E,le)=>{le.read=function(_e,d,H,J,_){var w,O,x=8*_-J-1,K=(1<<x)-1,V=K>>1,A=-7,U=H?_-1:0,N=H?-1:1,Y=_e[d+U];for(U+=N,w=Y&(1<<-A)-1,Y>>=-A,A+=x;A>0;w=256*w+_e[d+U],U+=N,A-=8);for(O=w&(1<<-A)-1,w>>=-A,A+=J;A>0;O=256*O+_e[d+U],U+=N,A-=8);if(0===w)w=1-V;else{if(w===K)return O?NaN:1/0*(Y?-1:1);O+=Math.pow(2,J),w-=V}return(Y?-1:1)*O*Math.pow(2,w-J)},le.write=function(_e,d,H,J,_,w){var O,x,K,V=8*w-_-1,A=(1<<V)-1,U=A>>1,N=23===_?Math.pow(2,-24)-Math.pow(2,-77):0,Y=J?0:w-1,T=J?1:-1,j=d<0||0===d&&1/d<0?1:0;for(d=Math.abs(d),isNaN(d)||d===1/0?(x=isNaN(d)?1:0,O=A):(O=Math.floor(Math.log(d)/Math.LN2),d*(K=Math.pow(2,-O))<1&&(O--,K*=2),(d+=O+U>=1?N/K:N*Math.pow(2,1-U))*K>=2&&(O++,K/=2),O+U>=A?(x=0,O=A):O+U>=1?(x=(d*K-1)*Math.pow(2,_),O+=U):(x=d*Math.pow(2,U-1)*Math.pow(2,_),O=0));_>=8;_e[H+Y]=255&x,Y+=T,x/=256,_-=8);for(O=O<<_|x,V+=_;V>0;_e[H+Y]=255&O,Y+=T,O/=256,V-=8);_e[H+Y-T]|=128*j}},6256:function(E,le){!function(_){var Y,w="undefined",O=w!==typeof Buffer&&Buffer,x=w!==typeof Uint8Array&&Uint8Array,K=w!==typeof ArrayBuffer&&ArrayBuffer,V=[0,0,0,0,0,0,0,0],A=Array.isArray||function k(v){return!!v&&"[object Array]"==Object.prototype.toString.call(v)},U=4294967296;function T(v,P,B){var te=P?0:4,D=P?4:0,fe=P?0:3,R=P?1:2,F=P?2:1,g=P?3:0,l=P?I:L,c=P?X:S,f=m.prototype,u="is"+v,p="_"+u;return f.buffer=void 0,f.offset=0,f[p]=!0,f.toNumber=se,f.toString=function Ee(Me){var $e=this.buffer,ye=this.offset,he=ce($e,ye+te),Se=ce($e,ye+D),be="",ae=!B&&2147483648&he;for(ae&&(he=~he,Se=U-Se),Me=Me||10;;){var ue=he%Me*U+Se;if(he=Math.floor(he/Me),Se=Math.floor(ue/Me),be=(ue%Me).toString(Me)+be,!he&&!Se)break}return ae&&(be="-"+be),be},f.toJSON=se,f.toArray=j,O&&(f.toBuffer=re),x&&(f.toArrayBuffer=z),m[u]=function C(Me){return!(!Me||!Me[p])},_[v]=m,m;function m(Me,$e,ye,he){return this instanceof m?function $(Me,$e,ye,he,Se){x&&K&&($e instanceof K&&($e=new x($e)),he instanceof K&&(he=new x(he))),$e||ye||he||Y?(q($e,ye)||(Se=ye,he=$e,ye=0,$e=new(Y||Array)(8)),Me.buffer=$e,Me.offset=ye|=0,w!==typeof he&&("string"==typeof he?function ie(Me,$e,ye,he){var Se=0,be=ye.length,ae=0,ue=0;"-"===ye[0]&&Se++;for(var Ce=Se;Se<be;){var y=parseInt(ye[Se++],he);if(!(y>=0))break;ue=ue*he+y,ae=ae*he+Math.floor(ue/U),ue%=U}Ce&&(ae=~ae,ue?ue=U-ue:ae++),Ie(Me,$e+te,ae),Ie(Me,$e+D,ue)}($e,ye,he,Se||10):q(he,Se)?Z($e,ye,he,Se):"number"==typeof Se?(Ie($e,ye+te,he),Ie($e,ye+D,Se)):he>0?l($e,ye,he):he<0?c($e,ye,he):Z($e,ye,V,0))):Me.buffer=M(V,0)}(this,Me,$e,ye,he):new m(Me,$e,ye,he)}function se(){var Me=this.buffer,$e=this.offset,ye=ce(Me,$e+te),he=ce(Me,$e+D);return B||(ye|=0),ye?ye*U+he:he}function Ie(Me,$e,ye){Me[$e+g]=255&ye,Me[$e+F]=255&(ye>>=8),Me[$e+R]=255&(ye>>=8),Me[$e+fe]=255&(ye>>=8)}function ce(Me,$e){return 16777216*Me[$e+fe]+(Me[$e+R]<<16)+(Me[$e+F]<<8)+Me[$e+g]}}function j(v){var P=this.buffer,B=this.offset;return Y=null,!1!==v&&0===B&&8===P.length&&A(P)?P:M(P,B)}function re(v){var P=this.buffer,B=this.offset;if(Y=O,!1!==v&&0===B&&8===P.length&&Buffer.isBuffer(P))return P;var te=new O(8);return Z(te,0,P,B),te}function z(v){var P=this.buffer,B=this.offset,te=P.buffer;if(Y=x,!1!==v&&0===B&&te instanceof K&&8===te.byteLength)return te;var D=new x(8);return Z(D,0,P,B),D.buffer}function q(v,P){var B=v&&v.length;return P|=0,B&&P+8<=B&&"string"!=typeof v[P]}function Z(v,P,B,te){P|=0,te|=0;for(var D=0;D<8;D++)v[P++]=255&B[te++]}function M(v,P){return Array.prototype.slice.call(v,P,P+8)}function I(v,P,B){for(var te=P+8;te>P;)v[--te]=255&B,B/=256}function X(v,P,B){var te=P+8;for(B++;te>P;)v[--te]=255&-B^255,B/=256}function L(v,P,B){for(var te=P+8;P<te;)v[P++]=255&B,B/=256}function S(v,P,B){var te=P+8;for(B++;P<te;)v[P++]=255&-B^255,B/=256}T("Uint64BE",!0,!0),T("Int64BE",!0,!1),T("Uint64LE",!1,!0),T("Int64LE",!1,!1)}("string"!=typeof le.nodeName?le:this||{})},6425:E=>{var le={}.toString;E.exports=Array.isArray||function(_e){return"[object Array]"==le.call(_e)}},5650:E=>{E.exports=function le(_e,d,H){function J(O,x){if(!d[O]){if(!_e[O]){if(_)return _(O,!0);var V=new Error("Cannot find module '"+O+"'");throw V.code="MODULE_NOT_FOUND",V}var A=d[O]={exports:{}};_e[O][0].call(A.exports,function(U){return J(_e[O][1][U]||U)},A,A.exports,le,_e,d,H)}return d[O].exports}for(var _=void 0,w=0;w<H.length;w++)J(H[w]);return J}({1:[function(le,_e,d){"use strict";var H=le("./utils"),J=le("./support"),_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";d.encode=function(w){for(var O,x,K,A,U,N,Y=[],T=0,j=w.length,re=j,z="string"!==H.getTypeOf(w);T<w.length;)re=j-T,K=z?(O=w[T++],x=T<j?w[T++]:0,T<j?w[T++]:0):(O=w.charCodeAt(T++),x=T<j?w.charCodeAt(T++):0,T<j?w.charCodeAt(T++):0),A=(3&O)<<4|x>>4,U=1<re?(15&x)<<2|K>>6:64,N=2<re?63&K:64,Y.push(_.charAt(O>>2)+_.charAt(A)+_.charAt(U)+_.charAt(N));return Y.join("")},d.decode=function(w){var O,x,K,V,A,U,N=0,Y=0,T="data:";if(w.substr(0,T.length)===T)throw new Error("Invalid base64 input, it looks like a data url.");var j,re=3*(w=w.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(w.charAt(w.length-1)===_.charAt(64)&&re--,w.charAt(w.length-2)===_.charAt(64)&&re--,re%1!=0)throw new Error("Invalid base64 input, bad content length.");for(j=J.uint8array?new Uint8Array(0|re):new Array(0|re);N<w.length;)O=_.indexOf(w.charAt(N++))<<2|(V=_.indexOf(w.charAt(N++)))>>4,x=(15&V)<<4|(A=_.indexOf(w.charAt(N++)))>>2,K=(3&A)<<6|(U=_.indexOf(w.charAt(N++))),j[Y++]=O,64!==A&&(j[Y++]=x),64!==U&&(j[Y++]=K);return j}},{"./support":30,"./utils":32}],2:[function(le,_e,d){"use strict";var H=le("./external"),J=le("./stream/DataWorker"),_=le("./stream/Crc32Probe"),w=le("./stream/DataLengthProbe");function O(x,K,V,A,U){this.compressedSize=x,this.uncompressedSize=K,this.crc32=V,this.compression=A,this.compressedContent=U}O.prototype={getContentWorker:function(){var x=new J(H.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new w("data_length")),K=this;return x.on("end",function(){if(this.streamInfo.data_length!==K.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),x},getCompressedWorker:function(){return new J(H.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},O.createWorkerFrom=function(x,K,V){return x.pipe(new _).pipe(new w("uncompressedSize")).pipe(K.compressWorker(V)).pipe(new w("compressedSize")).withStreamInfo("compression",K)},_e.exports=O},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(le,_e,d){"use strict";var H=le("./stream/GenericWorker");d.STORE={magic:"\0\0",compressWorker:function(){return new H("STORE compression")},uncompressWorker:function(){return new H("STORE decompression")}},d.DEFLATE=le("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(le,_e,d){"use strict";var H=le("./utils"),J=function(){for(var _,w=[],O=0;O<256;O++){_=O;for(var x=0;x<8;x++)_=1&_?3988292384^_>>>1:_>>>1;w[O]=_}return w}();_e.exports=function(_,w){return void 0!==_&&_.length?"string"!==H.getTypeOf(_)?function(O,x,K,V){var A=J,U=0+K;O^=-1;for(var N=0;N<U;N++)O=O>>>8^A[255&(O^x[N])];return-1^O}(0|w,_,_.length):function(O,x,K,V){var A=J,U=0+K;O^=-1;for(var N=0;N<U;N++)O=O>>>8^A[255&(O^x.charCodeAt(N))];return-1^O}(0|w,_,_.length):0}},{"./utils":32}],5:[function(le,_e,d){"use strict";d.base64=!1,d.binary=!1,d.dir=!1,d.createFolders=!0,d.date=null,d.compression=null,d.compressionOptions=null,d.comment=null,d.unixPermissions=null,d.dosPermissions=null},{}],6:[function(le,_e,d){"use strict";var H;H=typeof Promise<"u"?Promise:le("lie"),_e.exports={Promise:H}},{lie:37}],7:[function(le,_e,d){"use strict";var H=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",J=le("pako"),_=le("./utils"),w=le("./stream/GenericWorker"),O=H?"uint8array":"array";function x(K,V){w.call(this,"FlateWorker/"+K),this._pako=null,this._pakoAction=K,this._pakoOptions=V,this.meta={}}d.magic="\b\0",_.inherits(x,w),x.prototype.processChunk=function(K){this.meta=K.meta,null===this._pako&&this._createPako(),this._pako.push(_.transformTo(O,K.data),!1)},x.prototype.flush=function(){w.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},x.prototype.cleanUp=function(){w.prototype.cleanUp.call(this),this._pako=null},x.prototype._createPako=function(){this._pako=new J[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var K=this;this._pako.onData=function(V){K.push({data:V,meta:K.meta})}},d.compressWorker=function(K){return new x("Deflate",K)},d.uncompressWorker=function(){return new x("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(le,_e,d){"use strict";function H(A,U){var N,Y="";for(N=0;N<U;N++)Y+=String.fromCharCode(255&A),A>>>=8;return Y}function J(A,U,N,Y,T,j){var re,z,q=A.file,Z=A.compression,M=j!==O.utf8encode,I=_.transformTo("string",j(q.name)),X=_.transformTo("string",O.utf8encode(q.name)),L=q.comment,S=_.transformTo("string",j(L)),k=_.transformTo("string",O.utf8encode(L)),v=X.length!==q.name.length,P=k.length!==L.length,B="",te="",D="",fe=q.dir,R=q.date,F={crc32:0,compressedSize:0,uncompressedSize:0};U&&!N||(F.crc32=A.crc32,F.compressedSize=A.compressedSize,F.uncompressedSize=A.uncompressedSize);var g=0;U&&(g|=8),M||!v&&!P||(g|=2048);var u,m,l=0,c=0;fe&&(l|=16),"UNIX"===T?(c=798,l|=(m=u=q.unixPermissions,u||(m=fe?16893:33204),(65535&m)<<16)):(c=20,l|=function(u){return 63&(u||0)}(q.dosPermissions)),re=R.getUTCHours(),re<<=6,re|=R.getUTCMinutes(),re<<=5,re|=R.getUTCSeconds()/2,z=R.getUTCFullYear()-1980,z<<=4,z|=R.getUTCMonth()+1,z<<=5,z|=R.getUTCDate(),v&&(te=H(1,1)+H(x(I),4)+X,B+="up"+H(te.length,2)+te),P&&(D=H(1,1)+H(x(S),4)+k,B+="uc"+H(D.length,2)+D);var f="";return f+="\n\0",f+=H(g,2),f+=Z.magic,f+=H(re,2),f+=H(z,2),f+=H(F.crc32,4),f+=H(F.compressedSize,4),f+=H(F.uncompressedSize,4),f+=H(I.length,2),f+=H(B.length,2),{fileRecord:K.LOCAL_FILE_HEADER+f+I+B,dirRecord:K.CENTRAL_FILE_HEADER+H(c,2)+f+H(S.length,2)+"\0\0\0\0"+H(l,4)+H(Y,4)+I+B+S}}var _=le("../utils"),w=le("../stream/GenericWorker"),O=le("../utf8"),x=le("../crc32"),K=le("../signature");function V(A,U,N,Y){w.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=U,this.zipPlatform=N,this.encodeFileName=Y,this.streamFiles=A,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}_.inherits(V,w),V.prototype.push=function(A){var U=A.meta.percent||0,N=this.entriesCount,Y=this._sources.length;this.accumulate?this.contentBuffer.push(A):(this.bytesWritten+=A.data.length,w.prototype.push.call(this,{data:A.data,meta:{currentFile:this.currentFile,percent:N?(U+100*(N-Y-1))/N:100}}))},V.prototype.openedSource=function(A){this.currentSourceOffset=this.bytesWritten,this.currentFile=A.file.name;var U=this.streamFiles&&!A.file.dir;if(U){var N=J(A,U,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:N.fileRecord,meta:{percent:0}})}else this.accumulate=!0},V.prototype.closedSource=function(A){this.accumulate=!1;var Y,U=this.streamFiles&&!A.file.dir,N=J(A,U,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(N.dirRecord),U)this.push({data:(Y=A,K.DATA_DESCRIPTOR+H(Y.crc32,4)+H(Y.compressedSize,4)+H(Y.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:N.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},V.prototype.flush=function(){for(var A=this.bytesWritten,U=0;U<this.dirRecords.length;U++)this.push({data:this.dirRecords[U],meta:{percent:100}});var T,j,re,Z,Y=(T=this.dirRecords.length,j=this.bytesWritten-A,re=A,Z=_.transformTo("string",(0,this.encodeFileName)(this.zipComment)),K.CENTRAL_DIRECTORY_END+"\0\0\0\0"+H(T,2)+H(T,2)+H(j,4)+H(re,4)+H(Z.length,2)+Z);this.push({data:Y,meta:{percent:100}})},V.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},V.prototype.registerPrevious=function(A){this._sources.push(A);var U=this;return A.on("data",function(N){U.processChunk(N)}),A.on("end",function(){U.closedSource(U.previous.streamInfo),U._sources.length?U.prepareNextSource():U.end()}),A.on("error",function(N){U.error(N)}),this},V.prototype.resume=function(){return!!w.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},V.prototype.error=function(A){var U=this._sources;if(!w.prototype.error.call(this,A))return!1;for(var N=0;N<U.length;N++)try{U[N].error(A)}catch{}return!0},V.prototype.lock=function(){w.prototype.lock.call(this);for(var A=this._sources,U=0;U<A.length;U++)A[U].lock()},_e.exports=V},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(le,_e,d){"use strict";var H=le("../compressions"),J=le("./ZipFileWorker");d.generateWorker=function(_,w,O){var x=new J(w.streamFiles,O,w.platform,w.encodeFileName),K=0;try{_.forEach(function(V,A){K++;var U=function(j,re){var z=j||re,q=H[z];if(!q)throw new Error(z+" is not a valid compression method !");return q}(A.options.compression,w.compression),Y=A.dir,T=A.date;A._compressWorker(U,A.options.compressionOptions||w.compressionOptions||{}).withStreamInfo("file",{name:V,dir:Y,date:T,comment:A.comment||"",unixPermissions:A.unixPermissions,dosPermissions:A.dosPermissions}).pipe(x)}),x.entriesCount=K}catch(V){x.error(V)}return x}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(le,_e,d){"use strict";function H(){if(!(this instanceof H))return new H;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var J=new H;for(var _ in this)"function"!=typeof this[_]&&(J[_]=this[_]);return J}}(H.prototype=le("./object")).loadAsync=le("./load"),H.support=le("./support"),H.defaults=le("./defaults"),H.version="3.10.1",H.loadAsync=function(J,_){return(new H).loadAsync(J,_)},H.external=le("./external"),_e.exports=H},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(le,_e,d){"use strict";var H=le("./utils"),J=le("./external"),_=le("./utf8"),w=le("./zipEntries"),O=le("./stream/Crc32Probe"),x=le("./nodejsUtils");function K(V){return new J.Promise(function(A,U){var N=V.decompressed.getContentWorker().pipe(new O);N.on("error",function(Y){U(Y)}).on("end",function(){N.streamInfo.crc32!==V.decompressed.crc32?U(new Error("Corrupted zip : CRC32 mismatch")):A()}).resume()})}_e.exports=function(V,A){var U=this;return A=H.extend(A||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:_.utf8decode}),x.isNode&&x.isStream(V)?J.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):H.prepareContent("the loaded zip file",V,!0,A.optimizedBinaryString,A.base64).then(function(N){var Y=new w(A);return Y.load(N),Y}).then(function(N){var Y=[J.Promise.resolve(N)],T=N.files;if(A.checkCRC32)for(var j=0;j<T.length;j++)Y.push(K(T[j]));return J.Promise.all(Y)}).then(function(N){for(var Y=N.shift(),T=Y.files,j=0;j<T.length;j++){var re=T[j],z=re.fileNameStr,q=H.resolve(re.fileNameStr);U.file(q,re.decompressed,{binary:!0,optimizedBinaryString:!0,date:re.date,dir:re.dir,comment:re.fileCommentStr.length?re.fileCommentStr:null,unixPermissions:re.unixPermissions,dosPermissions:re.dosPermissions,createFolders:A.createFolders}),re.dir||(U.file(q).unsafeOriginalName=z)}return Y.zipComment.length&&(U.comment=Y.zipComment),U})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(le,_e,d){"use strict";var H=le("../utils"),J=le("../stream/GenericWorker");function _(w,O){J.call(this,"Nodejs stream input adapter for "+w),this._upstreamEnded=!1,this._bindStream(O)}H.inherits(_,J),_.prototype._bindStream=function(w){var O=this;(this._stream=w).pause(),w.on("data",function(x){O.push({data:x,meta:{percent:0}})}).on("error",function(x){O.isPaused?this.generatedError=x:O.error(x)}).on("end",function(){O.isPaused?O._upstreamEnded=!0:O.end()})},_.prototype.pause=function(){return!!J.prototype.pause.call(this)&&(this._stream.pause(),!0)},_.prototype.resume=function(){return!!J.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},_e.exports=_},{"../stream/GenericWorker":28,"../utils":32}],13:[function(le,_e,d){"use strict";var H=le("readable-stream").Readable;function J(_,w,O){H.call(this,w),this._helper=_;var x=this;_.on("data",function(K,V){x.push(K)||x._helper.pause(),O&&O(V)}).on("error",function(K){x.emit("error",K)}).on("end",function(){x.push(null)})}le("../utils").inherits(J,H),J.prototype._read=function(){this._helper.resume()},_e.exports=J},{"../utils":32,"readable-stream":16}],14:[function(le,_e,d){"use strict";_e.exports={isNode:typeof Buffer<"u",newBufferFrom:function(H,J){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(H,J);if("number"==typeof H)throw new Error('The "data" argument must not be a number');return new Buffer(H,J)},allocBuffer:function(H){if(Buffer.alloc)return Buffer.alloc(H);var J=new Buffer(H);return J.fill(0),J},isBuffer:function(H){return Buffer.isBuffer(H)},isStream:function(H){return H&&"function"==typeof H.on&&"function"==typeof H.pause&&"function"==typeof H.resume}}},{}],15:[function(le,_e,d){"use strict";function H(q,Z,M){var I,X=_.getTypeOf(Z),L=_.extend(M||{},x);L.date=L.date||new Date,null!==L.compression&&(L.compression=L.compression.toUpperCase()),"string"==typeof L.unixPermissions&&(L.unixPermissions=parseInt(L.unixPermissions,8)),L.unixPermissions&&16384&L.unixPermissions&&(L.dir=!0),L.dosPermissions&&16&L.dosPermissions&&(L.dir=!0),L.dir&&(q=T(q)),L.createFolders&&(I=Y(q))&&j.call(this,I,!0),M&&void 0!==M.binary||(L.binary=!("string"===X&&!1===L.binary&&!1===L.base64)),(Z instanceof K&&0===Z.uncompressedSize||L.dir||!Z||0===Z.length)&&(L.base64=!1,L.binary=!0,Z="",L.compression="STORE",X="string");var k;k=Z instanceof K||Z instanceof w?Z:U.isNode&&U.isStream(Z)?new N(q,Z):_.prepareContent(q,Z,L.binary,L.optimizedBinaryString,L.base64);var v=new V(q,k,L);this.files[q]=v}var J=le("./utf8"),_=le("./utils"),w=le("./stream/GenericWorker"),O=le("./stream/StreamHelper"),x=le("./defaults"),K=le("./compressedObject"),V=le("./zipObject"),A=le("./generate"),U=le("./nodejsUtils"),N=le("./nodejs/NodejsStreamInputAdapter"),Y=function(q){"/"===q.slice(-1)&&(q=q.substring(0,q.length-1));var Z=q.lastIndexOf("/");return 0<Z?q.substring(0,Z):""},T=function(q){return"/"!==q.slice(-1)&&(q+="/"),q},j=function(q,Z){return Z=void 0!==Z?Z:x.createFolders,q=T(q),this.files[q]||H.call(this,q,null,{dir:!0,createFolders:Z}),this.files[q]};function re(q){return"[object RegExp]"===Object.prototype.toString.call(q)}var z={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(q){var Z,M,I;for(Z in this.files)I=this.files[Z],(M=Z.slice(this.root.length,Z.length))&&Z.slice(0,this.root.length)===this.root&&q(M,I)},filter:function(q){var Z=[];return this.forEach(function(M,I){q(M,I)&&Z.push(I)}),Z},file:function(q,Z,M){if(1!==arguments.length)return H.call(this,q=this.root+q,Z,M),this;if(re(q)){var I=q;return this.filter(function(L,S){return!S.dir&&I.test(L)})}var X=this.files[this.root+q];return X&&!X.dir?X:null},folder:function(q){if(!q)return this;if(re(q))return this.filter(function(X,L){return L.dir&&q.test(X)});var M=j.call(this,this.root+q),I=this.clone();return I.root=M.name,I},remove:function(q){var Z=this.files[q=this.root+q];if(Z||("/"!==q.slice(-1)&&(q+="/"),Z=this.files[q]),Z&&!Z.dir)delete this.files[q];else for(var M=this.filter(function(X,L){return L.name.slice(0,q.length)===q}),I=0;I<M.length;I++)delete this.files[M[I].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(q){var Z,M={};try{if((M=_.extend(q||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:J.utf8encode})).type=M.type.toLowerCase(),M.compression=M.compression.toUpperCase(),"binarystring"===M.type&&(M.type="string"),!M.type)throw new Error("No output type specified.");_.checkSupport(M.type),"darwin"!==M.platform&&"freebsd"!==M.platform&&"linux"!==M.platform&&"sunos"!==M.platform||(M.platform="UNIX"),"win32"===M.platform&&(M.platform="DOS"),Z=A.generateWorker(this,M,M.comment||this.comment||"")}catch(X){(Z=new w("error")).error(X)}return new O(Z,M.type||"string",M.mimeType)},generateAsync:function(q,Z){return this.generateInternalStream(q).accumulate(Z)},generateNodeStream:function(q,Z){return(q=q||{}).type||(q.type="nodebuffer"),this.generateInternalStream(q).toNodejsStream(Z)}};_e.exports=z},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(le,_e,d){"use strict";_e.exports=le("stream")},{stream:void 0}],17:[function(le,_e,d){"use strict";var H=le("./DataReader");function J(_){H.call(this,_);for(var w=0;w<this.data.length;w++)_[w]=255&_[w]}le("../utils").inherits(J,H),J.prototype.byteAt=function(_){return this.data[this.zero+_]},J.prototype.lastIndexOfSignature=function(_){for(var w=_.charCodeAt(0),O=_.charCodeAt(1),x=_.charCodeAt(2),K=_.charCodeAt(3),V=this.length-4;0<=V;--V)if(this.data[V]===w&&this.data[V+1]===O&&this.data[V+2]===x&&this.data[V+3]===K)return V-this.zero;return-1},J.prototype.readAndCheckSignature=function(_){var w=_.charCodeAt(0),O=_.charCodeAt(1),x=_.charCodeAt(2),K=_.charCodeAt(3),V=this.readData(4);return w===V[0]&&O===V[1]&&x===V[2]&&K===V[3]},J.prototype.readData=function(_){if(this.checkOffset(_),0===_)return[];var w=this.data.slice(this.zero+this.index,this.zero+this.index+_);return this.index+=_,w},_e.exports=J},{"../utils":32,"./DataReader":18}],18:[function(le,_e,d){"use strict";var H=le("../utils");function J(_){this.data=_,this.length=_.length,this.index=0,this.zero=0}J.prototype={checkOffset:function(_){this.checkIndex(this.index+_)},checkIndex:function(_){if(this.length<this.zero+_||_<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+_+"). Corrupted zip ?")},setIndex:function(_){this.checkIndex(_),this.index=_},skip:function(_){this.setIndex(this.index+_)},byteAt:function(){},readInt:function(_){var w,O=0;for(this.checkOffset(_),w=this.index+_-1;w>=this.index;w--)O=(O<<8)+this.byteAt(w);return this.index+=_,O},readString:function(_){return H.transformTo("string",this.readData(_))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var _=this.readInt(4);return new Date(Date.UTC(1980+(_>>25&127),(_>>21&15)-1,_>>16&31,_>>11&31,_>>5&63,(31&_)<<1))}},_e.exports=J},{"../utils":32}],19:[function(le,_e,d){"use strict";var H=le("./Uint8ArrayReader");function J(_){H.call(this,_)}le("../utils").inherits(J,H),J.prototype.readData=function(_){this.checkOffset(_);var w=this.data.slice(this.zero+this.index,this.zero+this.index+_);return this.index+=_,w},_e.exports=J},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(le,_e,d){"use strict";var H=le("./DataReader");function J(_){H.call(this,_)}le("../utils").inherits(J,H),J.prototype.byteAt=function(_){return this.data.charCodeAt(this.zero+_)},J.prototype.lastIndexOfSignature=function(_){return this.data.lastIndexOf(_)-this.zero},J.prototype.readAndCheckSignature=function(_){return _===this.readData(4)},J.prototype.readData=function(_){this.checkOffset(_);var w=this.data.slice(this.zero+this.index,this.zero+this.index+_);return this.index+=_,w},_e.exports=J},{"../utils":32,"./DataReader":18}],21:[function(le,_e,d){"use strict";var H=le("./ArrayReader");function J(_){H.call(this,_)}le("../utils").inherits(J,H),J.prototype.readData=function(_){if(this.checkOffset(_),0===_)return new Uint8Array(0);var w=this.data.subarray(this.zero+this.index,this.zero+this.index+_);return this.index+=_,w},_e.exports=J},{"../utils":32,"./ArrayReader":17}],22:[function(le,_e,d){"use strict";var H=le("../utils"),J=le("../support"),_=le("./ArrayReader"),w=le("./StringReader"),O=le("./NodeBufferReader"),x=le("./Uint8ArrayReader");_e.exports=function(K){var V=H.getTypeOf(K);return H.checkSupport(V),"string"!==V||J.uint8array?"nodebuffer"===V?new O(K):J.uint8array?new x(H.transformTo("uint8array",K)):new _(H.transformTo("array",K)):new w(K)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(le,_e,d){"use strict";d.LOCAL_FILE_HEADER="PK\x03\x04",d.CENTRAL_FILE_HEADER="PK\x01\x02",d.CENTRAL_DIRECTORY_END="PK\x05\x06",d.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",d.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",d.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(le,_e,d){"use strict";var H=le("./GenericWorker"),J=le("../utils");function _(w){H.call(this,"ConvertWorker to "+w),this.destType=w}J.inherits(_,H),_.prototype.processChunk=function(w){this.push({data:J.transformTo(this.destType,w.data),meta:w.meta})},_e.exports=_},{"../utils":32,"./GenericWorker":28}],25:[function(le,_e,d){"use strict";var H=le("./GenericWorker"),J=le("../crc32");function _(){H.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}le("../utils").inherits(_,H),_.prototype.processChunk=function(w){this.streamInfo.crc32=J(w.data,this.streamInfo.crc32||0),this.push(w)},_e.exports=_},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(le,_e,d){"use strict";var H=le("../utils"),J=le("./GenericWorker");function _(w){J.call(this,"DataLengthProbe for "+w),this.propName=w,this.withStreamInfo(w,0)}H.inherits(_,J),_.prototype.processChunk=function(w){w&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+w.data.length),J.prototype.processChunk.call(this,w)},_e.exports=_},{"../utils":32,"./GenericWorker":28}],27:[function(le,_e,d){"use strict";var H=le("../utils"),J=le("./GenericWorker");function _(w){J.call(this,"DataWorker");var O=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,w.then(function(x){O.dataIsReady=!0,O.data=x,O.max=x&&x.length||0,O.type=H.getTypeOf(x),O.isPaused||O._tickAndRepeat()},function(x){O.error(x)})}H.inherits(_,J),_.prototype.cleanUp=function(){J.prototype.cleanUp.call(this),this.data=null},_.prototype.resume=function(){return!!J.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,H.delay(this._tickAndRepeat,[],this)),!0)},_.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(H.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},_.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var w=null,O=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":w=this.data.substring(this.index,O);break;case"uint8array":w=this.data.subarray(this.index,O);break;case"array":case"nodebuffer":w=this.data.slice(this.index,O)}return this.index=O,this.push({data:w,meta:{percent:this.max?this.index/this.max*100:0}})},_e.exports=_},{"../utils":32,"./GenericWorker":28}],28:[function(le,_e,d){"use strict";function H(J){this.name=J||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}H.prototype={push:function(J){this.emit("data",J)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(J){this.emit("error",J)}return!0},error:function(J){return!this.isFinished&&(this.isPaused?this.generatedError=J:(this.isFinished=!0,this.emit("error",J),this.previous&&this.previous.error(J),this.cleanUp()),!0)},on:function(J,_){return this._listeners[J].push(_),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(J,_){if(this._listeners[J])for(var w=0;w<this._listeners[J].length;w++)this._listeners[J][w].call(this,_)},pipe:function(J){return J.registerPrevious(this)},registerPrevious:function(J){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=J.streamInfo,this.mergeStreamInfo(),this.previous=J;var _=this;return J.on("data",function(w){_.processChunk(w)}),J.on("end",function(){_.end()}),J.on("error",function(w){_.error(w)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var J=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),J=!0),this.previous&&this.previous.resume(),!J},flush:function(){},processChunk:function(J){this.push(J)},withStreamInfo:function(J,_){return this.extraStreamInfo[J]=_,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var J in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,J)&&(this.streamInfo[J]=this.extraStreamInfo[J])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var J="Worker "+this.name;return this.previous?this.previous+" -> "+J:J}},_e.exports=H},{}],29:[function(le,_e,d){"use strict";var H=le("../utils"),J=le("./ConvertWorker"),_=le("./GenericWorker"),w=le("../base64"),O=le("../support"),x=le("../external"),K=null;if(O.nodestream)try{K=le("../nodejs/NodejsStreamOutputAdapter")}catch{}function A(U,N,Y){var T=N;switch(N){case"blob":case"arraybuffer":T="uint8array";break;case"base64":T="string"}try{this._internalType=T,this._outputType=N,this._mimeType=Y,H.checkSupport(T),this._worker=U.pipe(new J(T)),U.lock()}catch(j){this._worker=new _("error"),this._worker.error(j)}}A.prototype={accumulate:function(U){return function V(U,N){return new x.Promise(function(Y,T){var j=[],re=U._internalType,z=U._outputType,q=U._mimeType;U.on("data",function(Z,M){j.push(Z),N&&N(M)}).on("error",function(Z){j=[],T(Z)}).on("end",function(){try{var Z=function(M,I,X){switch(M){case"blob":return H.newBlob(H.transformTo("arraybuffer",I),X);case"base64":return w.encode(I);default:return H.transformTo(M,I)}}(z,function(M,I){var X,L=0,S=null,k=0;for(X=0;X<I.length;X++)k+=I[X].length;switch(M){case"string":return I.join("");case"array":return Array.prototype.concat.apply([],I);case"uint8array":for(S=new Uint8Array(k),X=0;X<I.length;X++)S.set(I[X],L),L+=I[X].length;return S;case"nodebuffer":return Buffer.concat(I);default:throw new Error("concat : unsupported type '"+M+"'")}}(re,j),q);Y(Z)}catch(M){T(M)}j=[]}).resume()})}(this,U)},on:function(U,N){var Y=this;return this._worker.on(U,"data"===U?function(T){N.call(Y,T.data,T.meta)}:function(){H.delay(N,arguments,Y)}),this},resume:function(){return H.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(U){if(H.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new K(this,{objectMode:"nodebuffer"!==this._outputType},U)}},_e.exports=A},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(le,_e,d){"use strict";if(d.base64=!0,d.array=!0,d.string=!0,d.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",d.nodebuffer=typeof Buffer<"u",d.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")d.blob=!1;else{var H=new ArrayBuffer(0);try{d.blob=0===new Blob([H],{type:"application/zip"}).size}catch{try{var J=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);J.append(H),d.blob=0===J.getBlob("application/zip").size}catch{d.blob=!1}}}try{d.nodestream=!!le("readable-stream").Readable}catch{d.nodestream=!1}},{"readable-stream":16}],31:[function(le,_e,d){"use strict";for(var H=le("./utils"),J=le("./support"),_=le("./nodejsUtils"),w=le("./stream/GenericWorker"),O=new Array(256),x=0;x<256;x++)O[x]=252<=x?6:248<=x?5:240<=x?4:224<=x?3:192<=x?2:1;function K(){w.call(this,"utf-8 decode"),this.leftOver=null}function V(){w.call(this,"utf-8 encode")}O[254]=O[254]=1,d.utf8encode=function(A){return J.nodebuffer?_.newBufferFrom(A,"utf-8"):function(U){var N,Y,T,j,re,z=U.length,q=0;for(j=0;j<z;j++)55296==(64512&(Y=U.charCodeAt(j)))&&j+1<z&&56320==(64512&(T=U.charCodeAt(j+1)))&&(Y=65536+(Y-55296<<10)+(T-56320),j++),q+=Y<128?1:Y<2048?2:Y<65536?3:4;for(N=J.uint8array?new Uint8Array(q):new Array(q),j=re=0;re<q;j++)55296==(64512&(Y=U.charCodeAt(j)))&&j+1<z&&56320==(64512&(T=U.charCodeAt(j+1)))&&(Y=65536+(Y-55296<<10)+(T-56320),j++),Y<128?N[re++]=Y:(Y<2048?N[re++]=192|Y>>>6:(Y<65536?N[re++]=224|Y>>>12:(N[re++]=240|Y>>>18,N[re++]=128|Y>>>12&63),N[re++]=128|Y>>>6&63),N[re++]=128|63&Y);return N}(A)},d.utf8decode=function(A){return J.nodebuffer?H.transformTo("nodebuffer",A).toString("utf-8"):function(U){var N,Y,T,j,re=U.length,z=new Array(2*re);for(N=Y=0;N<re;)if((T=U[N++])<128)z[Y++]=T;else if(4<(j=O[T]))z[Y++]=65533,N+=j-1;else{for(T&=2===j?31:3===j?15:7;1<j&&N<re;)T=T<<6|63&U[N++],j--;1<j?z[Y++]=65533:T<65536?z[Y++]=T:(z[Y++]=55296|(T-=65536)>>10&1023,z[Y++]=56320|1023&T)}return z.length!==Y&&(z.subarray?z=z.subarray(0,Y):z.length=Y),H.applyFromCharCode(z)}(A=H.transformTo(J.uint8array?"uint8array":"array",A))},H.inherits(K,w),K.prototype.processChunk=function(A){var U=H.transformTo(J.uint8array?"uint8array":"array",A.data);if(this.leftOver&&this.leftOver.length){if(J.uint8array){var N=U;(U=new Uint8Array(N.length+this.leftOver.length)).set(this.leftOver,0),U.set(N,this.leftOver.length)}else U=this.leftOver.concat(U);this.leftOver=null}var Y=function(j,re){var z;for((re=re||j.length)>j.length&&(re=j.length),z=re-1;0<=z&&128==(192&j[z]);)z--;return z<0||0===z?re:z+O[j[z]]>re?z:re}(U),T=U;Y!==U.length&&(J.uint8array?(T=U.subarray(0,Y),this.leftOver=U.subarray(Y,U.length)):(T=U.slice(0,Y),this.leftOver=U.slice(Y,U.length))),this.push({data:d.utf8decode(T),meta:A.meta})},K.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:d.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},d.Utf8DecodeWorker=K,H.inherits(V,w),V.prototype.processChunk=function(A){this.push({data:d.utf8encode(A.data),meta:A.meta})},d.Utf8EncodeWorker=V},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(le,_e,d){"use strict";var H=le("./support"),J=le("./base64"),_=le("./nodejsUtils"),w=le("./external");function O(N){return N}function x(N,Y){for(var T=0;T<N.length;++T)Y[T]=255&N.charCodeAt(T);return Y}le("setimmediate"),d.newBlob=function(N,Y){d.checkSupport("blob");try{return new Blob([N],{type:Y})}catch{try{var T=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return T.append(N),T.getBlob(Y)}catch{throw new Error("Bug : can't construct the Blob.")}}};var K={stringifyByChunk:function(N,Y,T){var j=[],re=0,z=N.length;if(z<=T)return String.fromCharCode.apply(null,N);for(;re<z;)j.push(String.fromCharCode.apply(null,"array"===Y||"nodebuffer"===Y?N.slice(re,Math.min(re+T,z)):N.subarray(re,Math.min(re+T,z)))),re+=T;return j.join("")},stringifyByChar:function(N){for(var Y="",T=0;T<N.length;T++)Y+=String.fromCharCode(N[T]);return Y},applyCanBeUsed:{uint8array:function(){try{return H.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch{return!1}}(),nodebuffer:function(){try{return H.nodebuffer&&1===String.fromCharCode.apply(null,_.allocBuffer(1)).length}catch{return!1}}()}};function V(N){var Y=65536,T=d.getTypeOf(N),j=!0;if("uint8array"===T?j=K.applyCanBeUsed.uint8array:"nodebuffer"===T&&(j=K.applyCanBeUsed.nodebuffer),j)for(;1<Y;)try{return K.stringifyByChunk(N,T,Y)}catch{Y=Math.floor(Y/2)}return K.stringifyByChar(N)}function A(N,Y){for(var T=0;T<N.length;T++)Y[T]=N[T];return Y}d.applyFromCharCode=V;var U={};U.string={string:O,array:function(N){return x(N,new Array(N.length))},arraybuffer:function(N){return U.string.uint8array(N).buffer},uint8array:function(N){return x(N,new Uint8Array(N.length))},nodebuffer:function(N){return x(N,_.allocBuffer(N.length))}},U.array={string:V,array:O,arraybuffer:function(N){return new Uint8Array(N).buffer},uint8array:function(N){return new Uint8Array(N)},nodebuffer:function(N){return _.newBufferFrom(N)}},U.arraybuffer={string:function(N){return V(new Uint8Array(N))},array:function(N){return A(new Uint8Array(N),new Array(N.byteLength))},arraybuffer:O,uint8array:function(N){return new Uint8Array(N)},nodebuffer:function(N){return _.newBufferFrom(new Uint8Array(N))}},U.uint8array={string:V,array:function(N){return A(N,new Array(N.length))},arraybuffer:function(N){return N.buffer},uint8array:O,nodebuffer:function(N){return _.newBufferFrom(N)}},U.nodebuffer={string:V,array:function(N){return A(N,new Array(N.length))},arraybuffer:function(N){return U.nodebuffer.uint8array(N).buffer},uint8array:function(N){return A(N,new Uint8Array(N.length))},nodebuffer:O},d.transformTo=function(N,Y){if(Y=Y||"",!N)return Y;d.checkSupport(N);var T=d.getTypeOf(Y);return U[T][N](Y)},d.resolve=function(N){for(var Y=N.split("/"),T=[],j=0;j<Y.length;j++){var re=Y[j];"."===re||""===re&&0!==j&&j!==Y.length-1||(".."===re?T.pop():T.push(re))}return T.join("/")},d.getTypeOf=function(N){return"string"==typeof N?"string":"[object Array]"===Object.prototype.toString.call(N)?"array":H.nodebuffer&&_.isBuffer(N)?"nodebuffer":H.uint8array&&N instanceof Uint8Array?"uint8array":H.arraybuffer&&N instanceof ArrayBuffer?"arraybuffer":void 0},d.checkSupport=function(N){if(!H[N.toLowerCase()])throw new Error(N+" is not supported by this platform")},d.MAX_VALUE_16BITS=65535,d.MAX_VALUE_32BITS=-1,d.pretty=function(N){var Y,T,j="";for(T=0;T<(N||"").length;T++)j+="\\x"+((Y=N.charCodeAt(T))<16?"0":"")+Y.toString(16).toUpperCase();return j},d.delay=function(N,Y,T){setImmediate(function(){N.apply(T||null,Y||[])})},d.inherits=function(N,Y){function T(){}T.prototype=Y.prototype,N.prototype=new T},d.extend=function(){var N,Y,T={};for(N=0;N<arguments.length;N++)for(Y in arguments[N])Object.prototype.hasOwnProperty.call(arguments[N],Y)&&void 0===T[Y]&&(T[Y]=arguments[N][Y]);return T},d.prepareContent=function(N,Y,T,j,re){return w.Promise.resolve(Y).then(function(z){return H.blob&&(z instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(z)))&&typeof FileReader<"u"?new w.Promise(function(q,Z){var M=new FileReader;M.onload=function(I){q(I.target.result)},M.onerror=function(I){Z(I.target.error)},M.readAsArrayBuffer(z)}):z}).then(function(z){var Z,q=d.getTypeOf(z);return q?("arraybuffer"===q?z=d.transformTo("uint8array",z):"string"===q&&(re?z=J.decode(z):T&&!0!==j&&(z=x(Z=z,H.uint8array?new Uint8Array(Z.length):new Array(Z.length)))),z):w.Promise.reject(new Error("Can't read the data of '"+N+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(le,_e,d){"use strict";var H=le("./reader/readerFor"),J=le("./utils"),_=le("./signature"),w=le("./zipEntry"),O=le("./support");function x(K){this.files=[],this.loadOptions=K}x.prototype={checkSignature:function(K){if(!this.reader.readAndCheckSignature(K)){this.reader.index-=4;var V=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+J.pretty(V)+", expected "+J.pretty(K)+")")}},isSignature:function(K,V){var A=this.reader.index;this.reader.setIndex(K);var U=this.reader.readString(4)===V;return this.reader.setIndex(A),U},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var K=this.reader.readData(this.zipCommentLength),A=J.transformTo(O.uint8array?"uint8array":"array",K);this.zipComment=this.loadOptions.decodeFileName(A)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var K,V,A,U=this.zip64EndOfCentralSize-44;0<U;)K=this.reader.readInt(2),V=this.reader.readInt(4),A=this.reader.readData(V),this.zip64ExtensibleData[K]={id:K,length:V,value:A}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var K,V;for(K=0;K<this.files.length;K++)this.reader.setIndex((V=this.files[K]).localHeaderOffset),this.checkSignature(_.LOCAL_FILE_HEADER),V.readLocalPart(this.reader),V.handleUTF8(),V.processAttributes()},readCentralDir:function(){var K;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(_.CENTRAL_FILE_HEADER);)(K=new w({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(K);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var K=this.reader.lastIndexOfSignature(_.CENTRAL_DIRECTORY_END);if(K<0)throw this.isSignature(0,_.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(K);var V=K;if(this.checkSignature(_.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===J.MAX_VALUE_16BITS||this.diskWithCentralDirStart===J.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===J.MAX_VALUE_16BITS||this.centralDirRecords===J.MAX_VALUE_16BITS||this.centralDirSize===J.MAX_VALUE_32BITS||this.centralDirOffset===J.MAX_VALUE_32BITS){if(this.zip64=!0,(K=this.reader.lastIndexOfSignature(_.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(K),this.checkSignature(_.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,_.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(_.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(_.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var A=this.centralDirOffset+this.centralDirSize;this.zip64&&(A+=20,A+=12+this.zip64EndOfCentralSize);var U=V-A;if(0<U)this.isSignature(V,_.CENTRAL_FILE_HEADER)||(this.reader.zero=U);else if(U<0)throw new Error("Corrupted zip: missing "+Math.abs(U)+" bytes.")},prepareReader:function(K){this.reader=H(K)},load:function(K){this.prepareReader(K),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},_e.exports=x},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(le,_e,d){"use strict";var H=le("./reader/readerFor"),J=le("./utils"),_=le("./compressedObject"),w=le("./crc32"),O=le("./utf8"),x=le("./compressions"),K=le("./support");function V(A,U){this.options=A,this.loadOptions=U}V.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(A){var U,N;if(A.skip(22),this.fileNameLength=A.readInt(2),N=A.readInt(2),this.fileName=A.readData(this.fileNameLength),A.skip(N),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(U=function(Y){for(var T in x)if(Object.prototype.hasOwnProperty.call(x,T)&&x[T].magic===Y)return x[T];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+J.pretty(this.compressionMethod)+" unknown (inner file : "+J.transformTo("string",this.fileName)+")");this.decompressed=new _(this.compressedSize,this.uncompressedSize,this.crc32,U,A.readData(this.compressedSize))},readCentralPart:function(A){this.versionMadeBy=A.readInt(2),A.skip(2),this.bitFlag=A.readInt(2),this.compressionMethod=A.readString(2),this.date=A.readDate(),this.crc32=A.readInt(4),this.compressedSize=A.readInt(4),this.uncompressedSize=A.readInt(4);var U=A.readInt(2);if(this.extraFieldsLength=A.readInt(2),this.fileCommentLength=A.readInt(2),this.diskNumberStart=A.readInt(2),this.internalFileAttributes=A.readInt(2),this.externalFileAttributes=A.readInt(4),this.localHeaderOffset=A.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");A.skip(U),this.readExtraFields(A),this.parseZIP64ExtraField(A),this.fileComment=A.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var A=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==A&&(this.dosPermissions=63&this.externalFileAttributes),3==A&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var A=H(this.extraFields[1].value);this.uncompressedSize===J.MAX_VALUE_32BITS&&(this.uncompressedSize=A.readInt(8)),this.compressedSize===J.MAX_VALUE_32BITS&&(this.compressedSize=A.readInt(8)),this.localHeaderOffset===J.MAX_VALUE_32BITS&&(this.localHeaderOffset=A.readInt(8)),this.diskNumberStart===J.MAX_VALUE_32BITS&&(this.diskNumberStart=A.readInt(4))}},readExtraFields:function(A){var U,N,Y,T=A.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});A.index+4<T;)U=A.readInt(2),N=A.readInt(2),Y=A.readData(N),this.extraFields[U]={id:U,length:N,value:Y};A.setIndex(T)},handleUTF8:function(){var A=K.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=O.utf8decode(this.fileName),this.fileCommentStr=O.utf8decode(this.fileComment);else{var U=this.findExtraFieldUnicodePath();if(null!==U)this.fileNameStr=U;else{var N=J.transformTo(A,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(N)}var Y=this.findExtraFieldUnicodeComment();if(null!==Y)this.fileCommentStr=Y;else{var T=J.transformTo(A,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(T)}}},findExtraFieldUnicodePath:function(){var A=this.extraFields[28789];if(A){var U=H(A.value);return 1!==U.readInt(1)||w(this.fileName)!==U.readInt(4)?null:O.utf8decode(U.readData(A.length-5))}return null},findExtraFieldUnicodeComment:function(){var A=this.extraFields[25461];if(A){var U=H(A.value);return 1!==U.readInt(1)||w(this.fileComment)!==U.readInt(4)?null:O.utf8decode(U.readData(A.length-5))}return null}},_e.exports=V},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(le,_e,d){"use strict";function H(U,N,Y){this.name=U,this.dir=Y.dir,this.date=Y.date,this.comment=Y.comment,this.unixPermissions=Y.unixPermissions,this.dosPermissions=Y.dosPermissions,this._data=N,this._dataBinary=Y.binary,this.options={compression:Y.compression,compressionOptions:Y.compressionOptions}}var J=le("./stream/StreamHelper"),_=le("./stream/DataWorker"),w=le("./utf8"),O=le("./compressedObject"),x=le("./stream/GenericWorker");H.prototype={internalStream:function(U){var N=null,Y="string";try{if(!U)throw new Error("No output type specified.");var T="string"===(Y=U.toLowerCase())||"text"===Y;"binarystring"!==Y&&"text"!==Y||(Y="string"),N=this._decompressWorker();var j=!this._dataBinary;j&&!T&&(N=N.pipe(new w.Utf8EncodeWorker)),!j&&T&&(N=N.pipe(new w.Utf8DecodeWorker))}catch(re){(N=new x("error")).error(re)}return new J(N,Y,"")},async:function(U,N){return this.internalStream(U).accumulate(N)},nodeStream:function(U,N){return this.internalStream(U||"nodebuffer").toNodejsStream(N)},_compressWorker:function(U,N){if(this._data instanceof O&&this._data.compression.magic===U.magic)return this._data.getCompressedWorker();var Y=this._decompressWorker();return this._dataBinary||(Y=Y.pipe(new w.Utf8EncodeWorker)),O.createWorkerFrom(Y,U,N)},_decompressWorker:function(){return this._data instanceof O?this._data.getContentWorker():this._data instanceof x?this._data:new _(this._data)}};for(var K=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],V=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},A=0;A<K.length;A++)H.prototype[K[A]]=V;_e.exports=H},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(le,_e,d){(function(H){"use strict";var J,_,w=H.MutationObserver||H.WebKitMutationObserver;if(w){var O=0,x=new w(U),K=H.document.createTextNode("");x.observe(K,{characterData:!0}),J=function(){K.data=O=++O%2}}else if(H.setImmediate||void 0===H.MessageChannel)J="document"in H&&"onreadystatechange"in H.document.createElement("script")?function(){var N=H.document.createElement("script");N.onreadystatechange=function(){U(),N.onreadystatechange=null,N.parentNode.removeChild(N),N=null},H.document.documentElement.appendChild(N)}:function(){setTimeout(U,0)};else{var V=new H.MessageChannel;V.port1.onmessage=U,J=function(){V.port2.postMessage(0)}}var A=[];function U(){var N,Y;_=!0;for(var T=A.length;T;){for(Y=A,A=[],N=-1;++N<T;)Y[N]();T=A.length}_=!1}_e.exports=function(N){1!==A.push(N)||_||J()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(le,_e,d){"use strict";var H=le("immediate");function J(){}var _={},w=["REJECTED"],O=["FULFILLED"],x=["PENDING"];function K(T){if("function"!=typeof T)throw new TypeError("resolver must be a function");this.state=x,this.queue=[],this.outcome=void 0,T!==J&&N(this,T)}function V(T,j,re){this.promise=T,"function"==typeof j&&(this.onFulfilled=j,this.callFulfilled=this.otherCallFulfilled),"function"==typeof re&&(this.onRejected=re,this.callRejected=this.otherCallRejected)}function A(T,j,re){H(function(){var z;try{z=j(re)}catch(q){return _.reject(T,q)}z===T?_.reject(T,new TypeError("Cannot resolve promise with itself")):_.resolve(T,z)})}function U(T){var j=T&&T.then;if(T&&("object"==typeof T||"function"==typeof T)&&"function"==typeof j)return function(){j.apply(T,arguments)}}function N(T,j){var re=!1;function z(M){re||(re=!0,_.reject(T,M))}function q(M){re||(re=!0,_.resolve(T,M))}var Z=Y(function(){j(q,z)});"error"===Z.status&&z(Z.value)}function Y(T,j){var re={};try{re.value=T(j),re.status="success"}catch(z){re.status="error",re.value=z}return re}(_e.exports=K).prototype.finally=function(T){if("function"!=typeof T)return this;var j=this.constructor;return this.then(function(re){return j.resolve(T()).then(function(){return re})},function(re){return j.resolve(T()).then(function(){throw re})})},K.prototype.catch=function(T){return this.then(null,T)},K.prototype.then=function(T,j){if("function"!=typeof T&&this.state===O||"function"!=typeof j&&this.state===w)return this;var re=new this.constructor(J);return this.state!==x?A(re,this.state===O?T:j,this.outcome):this.queue.push(new V(re,T,j)),re},V.prototype.callFulfilled=function(T){_.resolve(this.promise,T)},V.prototype.otherCallFulfilled=function(T){A(this.promise,this.onFulfilled,T)},V.prototype.callRejected=function(T){_.reject(this.promise,T)},V.prototype.otherCallRejected=function(T){A(this.promise,this.onRejected,T)},_.resolve=function(T,j){var re=Y(U,j);if("error"===re.status)return _.reject(T,re.value);var z=re.value;if(z)N(T,z);else{T.state=O,T.outcome=j;for(var q=-1,Z=T.queue.length;++q<Z;)T.queue[q].callFulfilled(j)}return T},_.reject=function(T,j){T.state=w,T.outcome=j;for(var re=-1,z=T.queue.length;++re<z;)T.queue[re].callRejected(j);return T},K.resolve=function(T){return T instanceof this?T:_.resolve(new this(J),T)},K.reject=function(T){var j=new this(J);return _.reject(j,T)},K.all=function(T){var j=this;if("[object Array]"!==Object.prototype.toString.call(T))return this.reject(new TypeError("must be an array"));var re=T.length,z=!1;if(!re)return this.resolve([]);for(var q=new Array(re),Z=0,M=-1,I=new this(J);++M<re;)X(T[M],M);return I;function X(L,S){j.resolve(L).then(function(k){q[S]=k,++Z!==re||z||(z=!0,_.resolve(I,q))},function(k){z||(z=!0,_.reject(I,k))})}},K.race=function(T){if("[object Array]"!==Object.prototype.toString.call(T))return this.reject(new TypeError("must be an array"));var re=T.length,z=!1;if(!re)return this.resolve([]);for(var q=-1,Z=new this(J);++q<re;)this.resolve(T[q]).then(function(I){z||(z=!0,_.resolve(Z,I))},function(I){z||(z=!0,_.reject(Z,I))});return Z}},{immediate:36}],38:[function(le,_e,d){"use strict";var H={};(0,le("./lib/utils/common").assign)(H,le("./lib/deflate"),le("./lib/inflate"),le("./lib/zlib/constants")),_e.exports=H},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(le,_e,d){"use strict";var H=le("./zlib/deflate"),J=le("./utils/common"),_=le("./utils/strings"),w=le("./zlib/messages"),O=le("./zlib/zstream"),x=Object.prototype.toString;function N(T){if(!(this instanceof N))return new N(T);this.options=J.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},T||{});var j=this.options;j.raw&&0<j.windowBits?j.windowBits=-j.windowBits:j.gzip&&0<j.windowBits&&j.windowBits<16&&(j.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new O,this.strm.avail_out=0;var re=H.deflateInit2(this.strm,j.level,j.method,j.windowBits,j.memLevel,j.strategy);if(0!==re)throw new Error(w[re]);if(j.header&&H.deflateSetHeader(this.strm,j.header),j.dictionary){var z;if(z="string"==typeof j.dictionary?_.string2buf(j.dictionary):"[object ArrayBuffer]"===x.call(j.dictionary)?new Uint8Array(j.dictionary):j.dictionary,0!==(re=H.deflateSetDictionary(this.strm,z)))throw new Error(w[re]);this._dict_set=!0}}function Y(T,j){var re=new N(j);if(re.push(T,!0),re.err)throw re.msg||w[re.err];return re.result}N.prototype.push=function(T,j){var re,z,q=this.strm,Z=this.options.chunkSize;if(this.ended)return!1;z=j===~~j?j:!0===j?4:0,q.input="string"==typeof T?_.string2buf(T):"[object ArrayBuffer]"===x.call(T)?new Uint8Array(T):T,q.next_in=0,q.avail_in=q.input.length;do{if(0===q.avail_out&&(q.output=new J.Buf8(Z),q.next_out=0,q.avail_out=Z),1!==(re=H.deflate(q,z))&&0!==re)return this.onEnd(re),!(this.ended=!0);0!==q.avail_out&&(0!==q.avail_in||4!==z&&2!==z)||this.onData("string"===this.options.to?_.buf2binstring(J.shrinkBuf(q.output,q.next_out)):J.shrinkBuf(q.output,q.next_out))}while((0<q.avail_in||0===q.avail_out)&&1!==re);return 4===z?(re=H.deflateEnd(this.strm),this.onEnd(re),this.ended=!0,0===re):2!==z||(this.onEnd(0),!(q.avail_out=0))},N.prototype.onData=function(T){this.chunks.push(T)},N.prototype.onEnd=function(T){0===T&&(this.result="string"===this.options.to?this.chunks.join(""):J.flattenChunks(this.chunks)),this.chunks=[],this.err=T,this.msg=this.strm.msg},d.Deflate=N,d.deflate=Y,d.deflateRaw=function(T,j){return(j=j||{}).raw=!0,Y(T,j)},d.gzip=function(T,j){return(j=j||{}).gzip=!0,Y(T,j)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(le,_e,d){"use strict";var H=le("./zlib/inflate"),J=le("./utils/common"),_=le("./utils/strings"),w=le("./zlib/constants"),O=le("./zlib/messages"),x=le("./zlib/zstream"),K=le("./zlib/gzheader"),V=Object.prototype.toString;function A(N){if(!(this instanceof A))return new A(N);this.options=J.assign({chunkSize:16384,windowBits:0,to:""},N||{});var Y=this.options;Y.raw&&0<=Y.windowBits&&Y.windowBits<16&&(Y.windowBits=-Y.windowBits,0===Y.windowBits&&(Y.windowBits=-15)),!(0<=Y.windowBits&&Y.windowBits<16)||N&&N.windowBits||(Y.windowBits+=32),15<Y.windowBits&&Y.windowBits<48&&0==(15&Y.windowBits)&&(Y.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new x,this.strm.avail_out=0;var T=H.inflateInit2(this.strm,Y.windowBits);if(T!==w.Z_OK)throw new Error(O[T]);this.header=new K,H.inflateGetHeader(this.strm,this.header)}function U(N,Y){var T=new A(Y);if(T.push(N,!0),T.err)throw T.msg||O[T.err];return T.result}A.prototype.push=function(N,Y){var T,j,re,z,q,Z,M=this.strm,I=this.options.chunkSize,X=this.options.dictionary,L=!1;if(this.ended)return!1;j=Y===~~Y?Y:!0===Y?w.Z_FINISH:w.Z_NO_FLUSH,M.input="string"==typeof N?_.binstring2buf(N):"[object ArrayBuffer]"===V.call(N)?new Uint8Array(N):N,M.next_in=0,M.avail_in=M.input.length;do{if(0===M.avail_out&&(M.output=new J.Buf8(I),M.next_out=0,M.avail_out=I),(T=H.inflate(M,w.Z_NO_FLUSH))===w.Z_NEED_DICT&&X&&(Z="string"==typeof X?_.string2buf(X):"[object ArrayBuffer]"===V.call(X)?new Uint8Array(X):X,T=H.inflateSetDictionary(this.strm,Z)),T===w.Z_BUF_ERROR&&!0===L&&(T=w.Z_OK,L=!1),T!==w.Z_STREAM_END&&T!==w.Z_OK)return this.onEnd(T),!(this.ended=!0);M.next_out&&(0!==M.avail_out&&T!==w.Z_STREAM_END&&(0!==M.avail_in||j!==w.Z_FINISH&&j!==w.Z_SYNC_FLUSH)||("string"===this.options.to?(re=_.utf8border(M.output,M.next_out),z=M.next_out-re,q=_.buf2string(M.output,re),M.next_out=z,M.avail_out=I-z,z&&J.arraySet(M.output,M.output,re,z,0),this.onData(q)):this.onData(J.shrinkBuf(M.output,M.next_out)))),0===M.avail_in&&0===M.avail_out&&(L=!0)}while((0<M.avail_in||0===M.avail_out)&&T!==w.Z_STREAM_END);return T===w.Z_STREAM_END&&(j=w.Z_FINISH),j===w.Z_FINISH?(T=H.inflateEnd(this.strm),this.onEnd(T),this.ended=!0,T===w.Z_OK):j!==w.Z_SYNC_FLUSH||(this.onEnd(w.Z_OK),!(M.avail_out=0))},A.prototype.onData=function(N){this.chunks.push(N)},A.prototype.onEnd=function(N){N===w.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):J.flattenChunks(this.chunks)),this.chunks=[],this.err=N,this.msg=this.strm.msg},d.Inflate=A,d.inflate=U,d.inflateRaw=function(N,Y){return(Y=Y||{}).raw=!0,U(N,Y)},d.ungzip=U},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(le,_e,d){"use strict";var H=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";d.assign=function(w){for(var O=Array.prototype.slice.call(arguments,1);O.length;){var x=O.shift();if(x){if("object"!=typeof x)throw new TypeError(x+"must be non-object");for(var K in x)x.hasOwnProperty(K)&&(w[K]=x[K])}}return w},d.shrinkBuf=function(w,O){return w.length===O?w:w.subarray?w.subarray(0,O):(w.length=O,w)};var J={arraySet:function(w,O,x,K,V){if(O.subarray&&w.subarray)w.set(O.subarray(x,x+K),V);else for(var A=0;A<K;A++)w[V+A]=O[x+A]},flattenChunks:function(w){var O,x,K,V,A,U;for(O=K=0,x=w.length;O<x;O++)K+=w[O].length;for(U=new Uint8Array(K),O=V=0,x=w.length;O<x;O++)U.set(A=w[O],V),V+=A.length;return U}},_={arraySet:function(w,O,x,K,V){for(var A=0;A<K;A++)w[V+A]=O[x+A]},flattenChunks:function(w){return[].concat.apply([],w)}};d.setTyped=function(w){w?(d.Buf8=Uint8Array,d.Buf16=Uint16Array,d.Buf32=Int32Array,d.assign(d,J)):(d.Buf8=Array,d.Buf16=Array,d.Buf32=Array,d.assign(d,_))},d.setTyped(H)},{}],42:[function(le,_e,d){"use strict";var H=le("./common"),J=!0,_=!0;try{String.fromCharCode.apply(null,[0])}catch{J=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{_=!1}for(var w=new H.Buf8(256),O=0;O<256;O++)w[O]=252<=O?6:248<=O?5:240<=O?4:224<=O?3:192<=O?2:1;function x(K,V){if(V<65537&&(K.subarray&&_||!K.subarray&&J))return String.fromCharCode.apply(null,H.shrinkBuf(K,V));for(var A="",U=0;U<V;U++)A+=String.fromCharCode(K[U]);return A}w[254]=w[254]=1,d.string2buf=function(K){var V,A,U,N,Y,T=K.length,j=0;for(N=0;N<T;N++)55296==(64512&(A=K.charCodeAt(N)))&&N+1<T&&56320==(64512&(U=K.charCodeAt(N+1)))&&(A=65536+(A-55296<<10)+(U-56320),N++),j+=A<128?1:A<2048?2:A<65536?3:4;for(V=new H.Buf8(j),N=Y=0;Y<j;N++)55296==(64512&(A=K.charCodeAt(N)))&&N+1<T&&56320==(64512&(U=K.charCodeAt(N+1)))&&(A=65536+(A-55296<<10)+(U-56320),N++),A<128?V[Y++]=A:(A<2048?V[Y++]=192|A>>>6:(A<65536?V[Y++]=224|A>>>12:(V[Y++]=240|A>>>18,V[Y++]=128|A>>>12&63),V[Y++]=128|A>>>6&63),V[Y++]=128|63&A);return V},d.buf2binstring=function(K){return x(K,K.length)},d.binstring2buf=function(K){for(var V=new H.Buf8(K.length),A=0,U=V.length;A<U;A++)V[A]=K.charCodeAt(A);return V},d.buf2string=function(K,V){var A,U,N,Y,T=V||K.length,j=new Array(2*T);for(A=U=0;A<T;)if((N=K[A++])<128)j[U++]=N;else if(4<(Y=w[N]))j[U++]=65533,A+=Y-1;else{for(N&=2===Y?31:3===Y?15:7;1<Y&&A<T;)N=N<<6|63&K[A++],Y--;1<Y?j[U++]=65533:N<65536?j[U++]=N:(j[U++]=55296|(N-=65536)>>10&1023,j[U++]=56320|1023&N)}return x(j,U)},d.utf8border=function(K,V){var A;for((V=V||K.length)>K.length&&(V=K.length),A=V-1;0<=A&&128==(192&K[A]);)A--;return A<0||0===A?V:A+w[K[A]]>V?A:V}},{"./common":41}],43:[function(le,_e,d){"use strict";_e.exports=function(H,J,_,w){for(var O=65535&H|0,x=H>>>16&65535|0,K=0;0!==_;){for(_-=K=2e3<_?2e3:_;x=x+(O=O+J[w++]|0)|0,--K;);O%=65521,x%=65521}return O|x<<16|0}},{}],44:[function(le,_e,d){"use strict";_e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(le,_e,d){"use strict";var H=function(){for(var J,_=[],w=0;w<256;w++){J=w;for(var O=0;O<8;O++)J=1&J?3988292384^J>>>1:J>>>1;_[w]=J}return _}();_e.exports=function(J,_,w,O){var x=H,K=O+w;J^=-1;for(var V=O;V<K;V++)J=J>>>8^x[255&(J^_[V])];return-1^J}},{}],46:[function(le,_e,d){"use strict";var H,J=le("../utils/common"),_=le("./trees"),w=le("./adler32"),O=le("./crc32"),x=le("./messages"),U=-2,L=258,S=262,v=113;function fe(ce,Me){return ce.msg=x[Me],Me}function R(ce){return(ce<<1)-(4<ce?9:0)}function F(ce){for(var Me=ce.length;0<=--Me;)ce[Me]=0}function g(ce){var Me=ce.state,$e=Me.pending;$e>ce.avail_out&&($e=ce.avail_out),0!==$e&&(J.arraySet(ce.output,Me.pending_buf,Me.pending_out,$e,ce.next_out),ce.next_out+=$e,Me.pending_out+=$e,ce.total_out+=$e,ce.avail_out-=$e,Me.pending-=$e,0===Me.pending&&(Me.pending_out=0))}function l(ce,Me){_._tr_flush_block(ce,0<=ce.block_start?ce.block_start:-1,ce.strstart-ce.block_start,Me),ce.block_start=ce.strstart,g(ce.strm)}function c(ce,Me){ce.pending_buf[ce.pending++]=Me}function f(ce,Me){ce.pending_buf[ce.pending++]=Me>>>8&255,ce.pending_buf[ce.pending++]=255&Me}function u(ce,Me){var $e,ye,he=ce.max_chain_length,Se=ce.strstart,be=ce.prev_length,ae=ce.nice_match,ue=ce.strstart>ce.w_size-S?ce.strstart-(ce.w_size-S):0,Ce=ce.window,y=ce.w_mask,W=ce.prev,pe=ce.strstart+L,we=Ce[Se+be-1],De=Ce[Se+be];ce.prev_length>=ce.good_match&&(he>>=2),ae>ce.lookahead&&(ae=ce.lookahead);do{if(Ce[($e=Me)+be]===De&&Ce[$e+be-1]===we&&Ce[$e]===Ce[Se]&&Ce[++$e]===Ce[Se+1]){Se+=2,$e++;do{}while(Ce[++Se]===Ce[++$e]&&Ce[++Se]===Ce[++$e]&&Ce[++Se]===Ce[++$e]&&Ce[++Se]===Ce[++$e]&&Ce[++Se]===Ce[++$e]&&Ce[++Se]===Ce[++$e]&&Ce[++Se]===Ce[++$e]&&Ce[++Se]===Ce[++$e]&&Se<pe);if(ye=L-(pe-Se),Se=pe-L,be<ye){if(ce.match_start=Me,ae<=(be=ye))break;we=Ce[Se+be-1],De=Ce[Se+be]}}}while((Me=W[Me&y])>ue&&0!=--he);return be<=ce.lookahead?be:ce.lookahead}function p(ce){var Me,$e,ye,he,Se,be,ae,ue,Ce,y,W=ce.w_size;do{if(he=ce.window_size-ce.lookahead-ce.strstart,ce.strstart>=W+(W-S)){for(J.arraySet(ce.window,ce.window,W,W,0),ce.match_start-=W,ce.strstart-=W,ce.block_start-=W,Me=$e=ce.hash_size;ye=ce.head[--Me],ce.head[Me]=W<=ye?ye-W:0,--$e;);for(Me=$e=W;ye=ce.prev[--Me],ce.prev[Me]=W<=ye?ye-W:0,--$e;);he+=W}if(0===ce.strm.avail_in)break;if(ae=ce.window,ue=ce.strstart+ce.lookahead,y=void 0,(Ce=he)<(y=(be=ce.strm).avail_in)&&(y=Ce),$e=0===y?0:(be.avail_in-=y,J.arraySet(ae,be.input,be.next_in,y,ue),1===be.state.wrap?be.adler=w(be.adler,ae,y,ue):2===be.state.wrap&&(be.adler=O(be.adler,ae,y,ue)),be.next_in+=y,be.total_in+=y,y),ce.lookahead+=$e,ce.lookahead+ce.insert>=3)for(ce.ins_h=ce.window[Se=ce.strstart-ce.insert],ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[Se+1])&ce.hash_mask;ce.insert&&(ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[Se+3-1])&ce.hash_mask,ce.prev[Se&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=Se,Se++,ce.insert--,!(ce.lookahead+ce.insert<3)););}while(ce.lookahead<S&&0!==ce.strm.avail_in)}function m(ce,Me){for(var $e,ye;;){if(ce.lookahead<S){if(p(ce),ce.lookahead<S&&0===Me)return 1;if(0===ce.lookahead)break}if($e=0,ce.lookahead>=3&&(ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[ce.strstart+3-1])&ce.hash_mask,$e=ce.prev[ce.strstart&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=ce.strstart),0!==$e&&ce.strstart-$e<=ce.w_size-S&&(ce.match_length=u(ce,$e)),ce.match_length>=3)if(ye=_._tr_tally(ce,ce.strstart-ce.match_start,ce.match_length-3),ce.lookahead-=ce.match_length,ce.match_length<=ce.max_lazy_match&&ce.lookahead>=3){for(ce.match_length--;ce.strstart++,ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[ce.strstart+3-1])&ce.hash_mask,$e=ce.prev[ce.strstart&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=ce.strstart,0!=--ce.match_length;);ce.strstart++}else ce.strstart+=ce.match_length,ce.match_length=0,ce.ins_h=ce.window[ce.strstart],ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[ce.strstart+1])&ce.hash_mask;else ye=_._tr_tally(ce,0,ce.window[ce.strstart]),ce.lookahead--,ce.strstart++;if(ye&&(l(ce,!1),0===ce.strm.avail_out))return 1}return ce.insert=ce.strstart<2?ce.strstart:2,4===Me?(l(ce,!0),0===ce.strm.avail_out?3:4):ce.last_lit&&(l(ce,!1),0===ce.strm.avail_out)?1:2}function C(ce,Me){for(var $e,ye,he;;){if(ce.lookahead<S){if(p(ce),ce.lookahead<S&&0===Me)return 1;if(0===ce.lookahead)break}if($e=0,ce.lookahead>=3&&(ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[ce.strstart+3-1])&ce.hash_mask,$e=ce.prev[ce.strstart&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=ce.strstart),ce.prev_length=ce.match_length,ce.prev_match=ce.match_start,ce.match_length=2,0!==$e&&ce.prev_length<ce.max_lazy_match&&ce.strstart-$e<=ce.w_size-S&&(ce.match_length=u(ce,$e),ce.match_length<=5&&(1===ce.strategy||3===ce.match_length&&4096<ce.strstart-ce.match_start)&&(ce.match_length=2)),ce.prev_length>=3&&ce.match_length<=ce.prev_length){for(he=ce.strstart+ce.lookahead-3,ye=_._tr_tally(ce,ce.strstart-1-ce.prev_match,ce.prev_length-3),ce.lookahead-=ce.prev_length-1,ce.prev_length-=2;++ce.strstart<=he&&(ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[ce.strstart+3-1])&ce.hash_mask,$e=ce.prev[ce.strstart&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=ce.strstart),0!=--ce.prev_length;);if(ce.match_available=0,ce.match_length=2,ce.strstart++,ye&&(l(ce,!1),0===ce.strm.avail_out))return 1}else if(ce.match_available){if((ye=_._tr_tally(ce,0,ce.window[ce.strstart-1]))&&l(ce,!1),ce.strstart++,ce.lookahead--,0===ce.strm.avail_out)return 1}else ce.match_available=1,ce.strstart++,ce.lookahead--}return ce.match_available&&(ye=_._tr_tally(ce,0,ce.window[ce.strstart-1]),ce.match_available=0),ce.insert=ce.strstart<2?ce.strstart:2,4===Me?(l(ce,!0),0===ce.strm.avail_out?3:4):ce.last_lit&&(l(ce,!1),0===ce.strm.avail_out)?1:2}function $(ce,Me,$e,ye,he){this.good_length=ce,this.max_lazy=Me,this.nice_length=$e,this.max_chain=ye,this.func=he}function ie(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new J.Buf16(1146),this.dyn_dtree=new J.Buf16(122),this.bl_tree=new J.Buf16(78),F(this.dyn_ltree),F(this.dyn_dtree),F(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new J.Buf16(16),this.heap=new J.Buf16(573),F(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new J.Buf16(573),F(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function se(ce){var Me;return ce&&ce.state?(ce.total_in=ce.total_out=0,ce.data_type=2,(Me=ce.state).pending=0,Me.pending_out=0,Me.wrap<0&&(Me.wrap=-Me.wrap),Me.status=Me.wrap?42:v,ce.adler=2===Me.wrap?0:1,Me.last_flush=0,_._tr_init(Me),0):fe(ce,U)}function Ee(ce){var $e,Me=se(ce);return 0===Me&&(($e=ce.state).window_size=2*$e.w_size,F($e.head),$e.max_lazy_match=H[$e.level].max_lazy,$e.good_match=H[$e.level].good_length,$e.nice_match=H[$e.level].nice_length,$e.max_chain_length=H[$e.level].max_chain,$e.strstart=0,$e.block_start=0,$e.lookahead=0,$e.insert=0,$e.match_length=$e.prev_length=2,$e.match_available=0,$e.ins_h=0),Me}function Ie(ce,Me,$e,ye,he,Se){if(!ce)return U;var be=1;if(-1===Me&&(Me=6),ye<0?(be=0,ye=-ye):15<ye&&(be=2,ye-=16),he<1||9<he||8!==$e||ye<8||15<ye||Me<0||9<Me||Se<0||4<Se)return fe(ce,U);8===ye&&(ye=9);var ae=new ie;return(ce.state=ae).strm=ce,ae.wrap=be,ae.gzhead=null,ae.w_bits=ye,ae.w_size=1<<ae.w_bits,ae.w_mask=ae.w_size-1,ae.hash_bits=he+7,ae.hash_size=1<<ae.hash_bits,ae.hash_mask=ae.hash_size-1,ae.hash_shift=~~((ae.hash_bits+3-1)/3),ae.window=new J.Buf8(2*ae.w_size),ae.head=new J.Buf16(ae.hash_size),ae.prev=new J.Buf16(ae.w_size),ae.lit_bufsize=1<<he+6,ae.pending_buf_size=4*ae.lit_bufsize,ae.pending_buf=new J.Buf8(ae.pending_buf_size),ae.d_buf=1*ae.lit_bufsize,ae.l_buf=3*ae.lit_bufsize,ae.level=Me,ae.strategy=Se,ae.method=$e,Ee(ce)}H=[new $(0,0,0,0,function(ce,Me){var $e=65535;for($e>ce.pending_buf_size-5&&($e=ce.pending_buf_size-5);;){if(ce.lookahead<=1){if(p(ce),0===ce.lookahead&&0===Me)return 1;if(0===ce.lookahead)break}ce.strstart+=ce.lookahead,ce.lookahead=0;var ye=ce.block_start+$e;if((0===ce.strstart||ce.strstart>=ye)&&(ce.lookahead=ce.strstart-ye,ce.strstart=ye,l(ce,!1),0===ce.strm.avail_out)||ce.strstart-ce.block_start>=ce.w_size-S&&(l(ce,!1),0===ce.strm.avail_out))return 1}return ce.insert=0,4===Me?(l(ce,!0),0===ce.strm.avail_out?3:4):(ce.strstart>ce.block_start&&l(ce,!1),1)}),new $(4,4,8,4,m),new $(4,5,16,8,m),new $(4,6,32,32,m),new $(4,4,16,16,C),new $(8,16,32,32,C),new $(8,16,128,128,C),new $(8,32,128,256,C),new $(32,128,258,1024,C),new $(32,258,258,4096,C)],d.deflateInit=function(ce,Me){return Ie(ce,Me,8,15,8,0)},d.deflateInit2=Ie,d.deflateReset=Ee,d.deflateResetKeep=se,d.deflateSetHeader=function(ce,Me){return ce&&ce.state?2!==ce.state.wrap?U:(ce.state.gzhead=Me,0):U},d.deflate=function(ce,Me){var $e,ye,he,Se;if(!ce||!ce.state||5<Me||Me<0)return ce?fe(ce,U):U;if(ye=ce.state,!ce.output||!ce.input&&0!==ce.avail_in||666===ye.status&&4!==Me)return fe(ce,0===ce.avail_out?-5:U);if(ye.strm=ce,$e=ye.last_flush,ye.last_flush=Me,42===ye.status)if(2===ye.wrap)ce.adler=0,c(ye,31),c(ye,139),c(ye,8),ye.gzhead?(c(ye,(ye.gzhead.text?1:0)+(ye.gzhead.hcrc?2:0)+(ye.gzhead.extra?4:0)+(ye.gzhead.name?8:0)+(ye.gzhead.comment?16:0)),c(ye,255&ye.gzhead.time),c(ye,ye.gzhead.time>>8&255),c(ye,ye.gzhead.time>>16&255),c(ye,ye.gzhead.time>>24&255),c(ye,9===ye.level?2:2<=ye.strategy||ye.level<2?4:0),c(ye,255&ye.gzhead.os),ye.gzhead.extra&&ye.gzhead.extra.length&&(c(ye,255&ye.gzhead.extra.length),c(ye,ye.gzhead.extra.length>>8&255)),ye.gzhead.hcrc&&(ce.adler=O(ce.adler,ye.pending_buf,ye.pending,0)),ye.gzindex=0,ye.status=69):(c(ye,0),c(ye,0),c(ye,0),c(ye,0),c(ye,0),c(ye,9===ye.level?2:2<=ye.strategy||ye.level<2?4:0),c(ye,3),ye.status=v);else{var be=8+(ye.w_bits-8<<4)<<8;be|=(2<=ye.strategy||ye.level<2?0:ye.level<6?1:6===ye.level?2:3)<<6,0!==ye.strstart&&(be|=32),be+=31-be%31,ye.status=v,f(ye,be),0!==ye.strstart&&(f(ye,ce.adler>>>16),f(ye,65535&ce.adler)),ce.adler=1}if(69===ye.status)if(ye.gzhead.extra){for(he=ye.pending;ye.gzindex<(65535&ye.gzhead.extra.length)&&(ye.pending!==ye.pending_buf_size||(ye.gzhead.hcrc&&ye.pending>he&&(ce.adler=O(ce.adler,ye.pending_buf,ye.pending-he,he)),g(ce),he=ye.pending,ye.pending!==ye.pending_buf_size));)c(ye,255&ye.gzhead.extra[ye.gzindex]),ye.gzindex++;ye.gzhead.hcrc&&ye.pending>he&&(ce.adler=O(ce.adler,ye.pending_buf,ye.pending-he,he)),ye.gzindex===ye.gzhead.extra.length&&(ye.gzindex=0,ye.status=73)}else ye.status=73;if(73===ye.status)if(ye.gzhead.name){he=ye.pending;do{if(ye.pending===ye.pending_buf_size&&(ye.gzhead.hcrc&&ye.pending>he&&(ce.adler=O(ce.adler,ye.pending_buf,ye.pending-he,he)),g(ce),he=ye.pending,ye.pending===ye.pending_buf_size)){Se=1;break}Se=ye.gzindex<ye.gzhead.name.length?255&ye.gzhead.name.charCodeAt(ye.gzindex++):0,c(ye,Se)}while(0!==Se);ye.gzhead.hcrc&&ye.pending>he&&(ce.adler=O(ce.adler,ye.pending_buf,ye.pending-he,he)),0===Se&&(ye.gzindex=0,ye.status=91)}else ye.status=91;if(91===ye.status)if(ye.gzhead.comment){he=ye.pending;do{if(ye.pending===ye.pending_buf_size&&(ye.gzhead.hcrc&&ye.pending>he&&(ce.adler=O(ce.adler,ye.pending_buf,ye.pending-he,he)),g(ce),he=ye.pending,ye.pending===ye.pending_buf_size)){Se=1;break}Se=ye.gzindex<ye.gzhead.comment.length?255&ye.gzhead.comment.charCodeAt(ye.gzindex++):0,c(ye,Se)}while(0!==Se);ye.gzhead.hcrc&&ye.pending>he&&(ce.adler=O(ce.adler,ye.pending_buf,ye.pending-he,he)),0===Se&&(ye.status=103)}else ye.status=103;if(103===ye.status&&(ye.gzhead.hcrc?(ye.pending+2>ye.pending_buf_size&&g(ce),ye.pending+2<=ye.pending_buf_size&&(c(ye,255&ce.adler),c(ye,ce.adler>>8&255),ce.adler=0,ye.status=v)):ye.status=v),0!==ye.pending){if(g(ce),0===ce.avail_out)return ye.last_flush=-1,0}else if(0===ce.avail_in&&R(Me)<=R($e)&&4!==Me)return fe(ce,-5);if(666===ye.status&&0!==ce.avail_in)return fe(ce,-5);if(0!==ce.avail_in||0!==ye.lookahead||0!==Me&&666!==ye.status){var ae=2===ye.strategy?function(ue,Ce){for(var y;;){if(0===ue.lookahead&&(p(ue),0===ue.lookahead)){if(0===Ce)return 1;break}if(ue.match_length=0,y=_._tr_tally(ue,0,ue.window[ue.strstart]),ue.lookahead--,ue.strstart++,y&&(l(ue,!1),0===ue.strm.avail_out))return 1}return ue.insert=0,4===Ce?(l(ue,!0),0===ue.strm.avail_out?3:4):ue.last_lit&&(l(ue,!1),0===ue.strm.avail_out)?1:2}(ye,Me):3===ye.strategy?function(ue,Ce){for(var y,W,pe,we,De=ue.window;;){if(ue.lookahead<=L){if(p(ue),ue.lookahead<=L&&0===Ce)return 1;if(0===ue.lookahead)break}if(ue.match_length=0,ue.lookahead>=3&&0<ue.strstart&&(W=De[pe=ue.strstart-1])===De[++pe]&&W===De[++pe]&&W===De[++pe]){we=ue.strstart+L;do{}while(W===De[++pe]&&W===De[++pe]&&W===De[++pe]&&W===De[++pe]&&W===De[++pe]&&W===De[++pe]&&W===De[++pe]&&W===De[++pe]&&pe<we);ue.match_length=L-(we-pe),ue.match_length>ue.lookahead&&(ue.match_length=ue.lookahead)}if(ue.match_length>=3?(y=_._tr_tally(ue,1,ue.match_length-3),ue.lookahead-=ue.match_length,ue.strstart+=ue.match_length,ue.match_length=0):(y=_._tr_tally(ue,0,ue.window[ue.strstart]),ue.lookahead--,ue.strstart++),y&&(l(ue,!1),0===ue.strm.avail_out))return 1}return ue.insert=0,4===Ce?(l(ue,!0),0===ue.strm.avail_out?3:4):ue.last_lit&&(l(ue,!1),0===ue.strm.avail_out)?1:2}(ye,Me):H[ye.level].func(ye,Me);if(3!==ae&&4!==ae||(ye.status=666),1===ae||3===ae)return 0===ce.avail_out&&(ye.last_flush=-1),0;if(2===ae&&(1===Me?_._tr_align(ye):5!==Me&&(_._tr_stored_block(ye,0,0,!1),3===Me&&(F(ye.head),0===ye.lookahead&&(ye.strstart=0,ye.block_start=0,ye.insert=0))),g(ce),0===ce.avail_out))return ye.last_flush=-1,0}return 4!==Me?0:ye.wrap<=0?1:(2===ye.wrap?(c(ye,255&ce.adler),c(ye,ce.adler>>8&255),c(ye,ce.adler>>16&255),c(ye,ce.adler>>24&255),c(ye,255&ce.total_in),c(ye,ce.total_in>>8&255),c(ye,ce.total_in>>16&255),c(ye,ce.total_in>>24&255)):(f(ye,ce.adler>>>16),f(ye,65535&ce.adler)),g(ce),0<ye.wrap&&(ye.wrap=-ye.wrap),0!==ye.pending?0:1)},d.deflateEnd=function(ce){var Me;return ce&&ce.state?42!==(Me=ce.state.status)&&69!==Me&&73!==Me&&91!==Me&&103!==Me&&Me!==v&&666!==Me?fe(ce,U):(ce.state=null,Me===v?fe(ce,-3):0):U},d.deflateSetDictionary=function(ce,Me){var $e,ye,he,Se,be,ae,ue,Ce,y=Me.length;if(!ce||!ce.state||2===(Se=($e=ce.state).wrap)||1===Se&&42!==$e.status||$e.lookahead)return U;for(1===Se&&(ce.adler=w(ce.adler,Me,y,0)),$e.wrap=0,y>=$e.w_size&&(0===Se&&(F($e.head),$e.strstart=0,$e.block_start=0,$e.insert=0),Ce=new J.Buf8($e.w_size),J.arraySet(Ce,Me,y-$e.w_size,$e.w_size,0),Me=Ce,y=$e.w_size),be=ce.avail_in,ae=ce.next_in,ue=ce.input,ce.avail_in=y,ce.next_in=0,ce.input=Me,p($e);$e.lookahead>=3;){for(ye=$e.strstart,he=$e.lookahead-2;$e.ins_h=($e.ins_h<<$e.hash_shift^$e.window[ye+3-1])&$e.hash_mask,$e.prev[ye&$e.w_mask]=$e.head[$e.ins_h],$e.head[$e.ins_h]=ye,ye++,--he;);$e.strstart=ye,$e.lookahead=2,p($e)}return $e.strstart+=$e.lookahead,$e.block_start=$e.strstart,$e.insert=$e.lookahead,$e.lookahead=0,$e.match_length=$e.prev_length=2,$e.match_available=0,ce.next_in=ae,ce.input=ue,ce.avail_in=be,$e.wrap=Se,0},d.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(le,_e,d){"use strict";_e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(le,_e,d){"use strict";_e.exports=function(H,J){var _,w,O,x,K,V,A,U,N,Y,T,j,re,z,q,Z,M,I,X,L,S,k,v,P,B;P=H.input,O=(w=H.next_in)+(H.avail_in-5),B=H.output,K=(x=H.next_out)-(J-H.avail_out),V=x+(H.avail_out-257),A=(_=H.state).dmax,U=_.wsize,N=_.whave,Y=_.wnext,T=_.window,j=_.hold,re=_.bits,z=_.lencode,q=_.distcode,Z=(1<<_.lenbits)-1,M=(1<<_.distbits)-1;e:do{re<15&&(j+=P[w++]<<re,j+=P[w++]<<(re+=8),re+=8),I=z[j&Z];t:for(;;){if(j>>>=X=I>>>24,re-=X,0==(X=I>>>16&255))B[x++]=65535&I;else{if(!(16&X)){if(0==(64&X)){I=z[(65535&I)+(j&(1<<X)-1)];continue t}if(32&X){_.mode=12;break e}H.msg="invalid literal/length code",_.mode=30;break e}L=65535&I,(X&=15)&&(re<X&&(j+=P[w++]<<re,re+=8),L+=j&(1<<X)-1,j>>>=X,re-=X),re<15&&(j+=P[w++]<<re,j+=P[w++]<<(re+=8),re+=8),I=q[j&M];n:for(;;){if(j>>>=X=I>>>24,re-=X,!(16&(X=I>>>16&255))){if(0==(64&X)){I=q[(65535&I)+(j&(1<<X)-1)];continue n}H.msg="invalid distance code",_.mode=30;break e}if(S=65535&I,re<(X&=15)&&(j+=P[w++]<<re,(re+=8)<X&&(j+=P[w++]<<re,re+=8)),A<(S+=j&(1<<X)-1)){H.msg="invalid distance too far back",_.mode=30;break e}if(j>>>=X,re-=X,(X=x-K)<S){if(N<(X=S-X)&&_.sane){H.msg="invalid distance too far back",_.mode=30;break e}if(v=T,(k=0)===Y){if(k+=U-X,X<L){for(L-=X;B[x++]=T[k++],--X;);k=x-S,v=B}}else if(Y<X){if(k+=U+Y-X,(X-=Y)<L){for(L-=X;B[x++]=T[k++],--X;);if(k=0,Y<L){for(L-=X=Y;B[x++]=T[k++],--X;);k=x-S,v=B}}}else if(k+=Y-X,X<L){for(L-=X;B[x++]=T[k++],--X;);k=x-S,v=B}for(;2<L;)B[x++]=v[k++],B[x++]=v[k++],B[x++]=v[k++],L-=3;L&&(B[x++]=v[k++],1<L&&(B[x++]=v[k++]))}else{for(k=x-S;B[x++]=B[k++],B[x++]=B[k++],B[x++]=B[k++],2<(L-=3););L&&(B[x++]=B[k++],1<L&&(B[x++]=B[k++]))}break}}break}}while(w<O&&x<V);w-=L=re>>3,j&=(1<<(re-=L<<3))-1,H.next_in=w,H.next_out=x,H.avail_in=w<O?O-w+5:5-(w-O),H.avail_out=x<V?V-x+257:257-(x-V),_.hold=j,_.bits=re}},{}],49:[function(le,_e,d){"use strict";var H=le("../utils/common"),J=le("./adler32"),_=le("./crc32"),w=le("./inffast"),O=le("./inftrees"),A=-2;function T(k){return(k>>>24&255)+(k>>>8&65280)+((65280&k)<<8)+((255&k)<<24)}function j(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new H.Buf16(320),this.work=new H.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function re(k){var v;return k&&k.state?(k.total_in=k.total_out=(v=k.state).total=0,k.msg="",v.wrap&&(k.adler=1&v.wrap),v.mode=1,v.last=0,v.havedict=0,v.dmax=32768,v.head=null,v.hold=0,v.bits=0,v.lencode=v.lendyn=new H.Buf32(852),v.distcode=v.distdyn=new H.Buf32(592),v.sane=1,v.back=-1,0):A}function z(k){var v;return k&&k.state?((v=k.state).wsize=0,v.whave=0,v.wnext=0,re(k)):A}function q(k,v){var P,B;return k&&k.state?(B=k.state,v<0?(P=0,v=-v):(P=1+(v>>4),v<48&&(v&=15)),v&&(v<8||15<v)?A:(null!==B.window&&B.wbits!==v&&(B.window=null),B.wrap=P,B.wbits=v,z(k))):A}function Z(k,v){var P,B;return k?(B=new j,(k.state=B).window=null,0!==(P=q(k,v))&&(k.state=null),P):A}var M,I,X=!0;function L(k){if(X){var v;for(M=new H.Buf32(512),I=new H.Buf32(32),v=0;v<144;)k.lens[v++]=8;for(;v<256;)k.lens[v++]=9;for(;v<280;)k.lens[v++]=7;for(;v<288;)k.lens[v++]=8;for(O(1,k.lens,0,288,M,0,k.work,{bits:9}),v=0;v<32;)k.lens[v++]=5;O(2,k.lens,0,32,I,0,k.work,{bits:5}),X=!1}k.lencode=M,k.lenbits=9,k.distcode=I,k.distbits=5}function S(k,v,P,B){var te,D=k.state;return null===D.window&&(D.wsize=1<<D.wbits,D.wnext=0,D.whave=0,D.window=new H.Buf8(D.wsize)),B>=D.wsize?(H.arraySet(D.window,v,P-D.wsize,D.wsize,0),D.wnext=0,D.whave=D.wsize):(B<(te=D.wsize-D.wnext)&&(te=B),H.arraySet(D.window,v,P-B,te,D.wnext),(B-=te)?(H.arraySet(D.window,v,P-B,B,0),D.wnext=B,D.whave=D.wsize):(D.wnext+=te,D.wnext===D.wsize&&(D.wnext=0),D.whave<D.wsize&&(D.whave+=te))),0}d.inflateReset=z,d.inflateReset2=q,d.inflateResetKeep=re,d.inflateInit=function(k){return Z(k,15)},d.inflateInit2=Z,d.inflate=function(k,v){var P,B,te,D,fe,R,F,g,l,c,f,u,p,m,C,$,ie,se,Ee,Ie,ce,Me,$e,ye,he=0,Se=new H.Buf8(4),be=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!k||!k.state||!k.output||!k.input&&0!==k.avail_in)return A;12===(P=k.state).mode&&(P.mode=13),fe=k.next_out,te=k.output,D=k.next_in,B=k.input,g=P.hold,l=P.bits,c=R=k.avail_in,f=F=k.avail_out,Me=0;e:for(;;)switch(P.mode){case 1:if(0===P.wrap){P.mode=13;break}for(;l<16;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}if(2&P.wrap&&35615===g){Se[P.check=0]=255&g,Se[1]=g>>>8&255,P.check=_(P.check,Se,2,0),l=g=0,P.mode=2;break}if(P.flags=0,P.head&&(P.head.done=!1),!(1&P.wrap)||(((255&g)<<8)+(g>>8))%31){k.msg="incorrect header check",P.mode=30;break}if(8!=(15&g)){k.msg="unknown compression method",P.mode=30;break}if(l-=4,ce=8+(15&(g>>>=4)),0===P.wbits)P.wbits=ce;else if(ce>P.wbits){k.msg="invalid window size",P.mode=30;break}P.dmax=1<<ce,k.adler=P.check=1,P.mode=512&g?10:12,l=g=0;break;case 2:for(;l<16;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}if(P.flags=g,8!=(255&P.flags)){k.msg="unknown compression method",P.mode=30;break}if(57344&P.flags){k.msg="unknown header flags set",P.mode=30;break}P.head&&(P.head.text=g>>8&1),512&P.flags&&(Se[0]=255&g,Se[1]=g>>>8&255,P.check=_(P.check,Se,2,0)),l=g=0,P.mode=3;case 3:for(;l<32;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}P.head&&(P.head.time=g),512&P.flags&&(Se[0]=255&g,Se[1]=g>>>8&255,Se[2]=g>>>16&255,Se[3]=g>>>24&255,P.check=_(P.check,Se,4,0)),l=g=0,P.mode=4;case 4:for(;l<16;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}P.head&&(P.head.xflags=255&g,P.head.os=g>>8),512&P.flags&&(Se[0]=255&g,Se[1]=g>>>8&255,P.check=_(P.check,Se,2,0)),l=g=0,P.mode=5;case 5:if(1024&P.flags){for(;l<16;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}P.length=g,P.head&&(P.head.extra_len=g),512&P.flags&&(Se[0]=255&g,Se[1]=g>>>8&255,P.check=_(P.check,Se,2,0)),l=g=0}else P.head&&(P.head.extra=null);P.mode=6;case 6:if(1024&P.flags&&(R<(u=P.length)&&(u=R),u&&(P.head&&(ce=P.head.extra_len-P.length,P.head.extra||(P.head.extra=new Array(P.head.extra_len)),H.arraySet(P.head.extra,B,D,u,ce)),512&P.flags&&(P.check=_(P.check,B,u,D)),R-=u,D+=u,P.length-=u),P.length))break e;P.length=0,P.mode=7;case 7:if(2048&P.flags){if(0===R)break e;for(u=0;ce=B[D+u++],P.head&&ce&&P.length<65536&&(P.head.name+=String.fromCharCode(ce)),ce&&u<R;);if(512&P.flags&&(P.check=_(P.check,B,u,D)),R-=u,D+=u,ce)break e}else P.head&&(P.head.name=null);P.length=0,P.mode=8;case 8:if(4096&P.flags){if(0===R)break e;for(u=0;ce=B[D+u++],P.head&&ce&&P.length<65536&&(P.head.comment+=String.fromCharCode(ce)),ce&&u<R;);if(512&P.flags&&(P.check=_(P.check,B,u,D)),R-=u,D+=u,ce)break e}else P.head&&(P.head.comment=null);P.mode=9;case 9:if(512&P.flags){for(;l<16;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}if(g!==(65535&P.check)){k.msg="header crc mismatch",P.mode=30;break}l=g=0}P.head&&(P.head.hcrc=P.flags>>9&1,P.head.done=!0),k.adler=P.check=0,P.mode=12;break;case 10:for(;l<32;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}k.adler=P.check=T(g),l=g=0,P.mode=11;case 11:if(0===P.havedict)return k.next_out=fe,k.avail_out=F,k.next_in=D,k.avail_in=R,P.hold=g,P.bits=l,2;k.adler=P.check=1,P.mode=12;case 12:if(5===v||6===v)break e;case 13:if(P.last){g>>>=7&l,l-=7&l,P.mode=27;break}for(;l<3;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}switch(P.last=1&g,l-=1,3&(g>>>=1)){case 0:P.mode=14;break;case 1:if(L(P),P.mode=20,6!==v)break;g>>>=2,l-=2;break e;case 2:P.mode=17;break;case 3:k.msg="invalid block type",P.mode=30}g>>>=2,l-=2;break;case 14:for(g>>>=7&l,l-=7&l;l<32;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}if((65535&g)!=(g>>>16^65535)){k.msg="invalid stored block lengths",P.mode=30;break}if(P.length=65535&g,l=g=0,P.mode=15,6===v)break e;case 15:P.mode=16;case 16:if(u=P.length){if(R<u&&(u=R),F<u&&(u=F),0===u)break e;H.arraySet(te,B,D,u,fe),R-=u,D+=u,F-=u,fe+=u,P.length-=u;break}P.mode=12;break;case 17:for(;l<14;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}if(P.nlen=257+(31&g),l-=5,P.ndist=1+(31&(g>>>=5)),l-=5,P.ncode=4+(15&(g>>>=5)),g>>>=4,l-=4,286<P.nlen||30<P.ndist){k.msg="too many length or distance symbols",P.mode=30;break}P.have=0,P.mode=18;case 18:for(;P.have<P.ncode;){for(;l<3;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}P.lens[be[P.have++]]=7&g,g>>>=3,l-=3}for(;P.have<19;)P.lens[be[P.have++]]=0;if(P.lencode=P.lendyn,P.lenbits=7,Me=O(0,P.lens,0,19,P.lencode,0,P.work,$e={bits:P.lenbits}),P.lenbits=$e.bits,Me){k.msg="invalid code lengths set",P.mode=30;break}P.have=0,P.mode=19;case 19:for(;P.have<P.nlen+P.ndist;){for(;$=(he=P.lencode[g&(1<<P.lenbits)-1])>>>16&255,ie=65535&he,!((C=he>>>24)<=l);){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}if(ie<16)g>>>=C,l-=C,P.lens[P.have++]=ie;else{if(16===ie){for(ye=C+2;l<ye;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}if(g>>>=C,l-=C,0===P.have){k.msg="invalid bit length repeat",P.mode=30;break}ce=P.lens[P.have-1],u=3+(3&g),g>>>=2,l-=2}else if(17===ie){for(ye=C+3;l<ye;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}l-=C,ce=0,u=3+(7&(g>>>=C)),g>>>=3,l-=3}else{for(ye=C+7;l<ye;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}l-=C,ce=0,u=11+(127&(g>>>=C)),g>>>=7,l-=7}if(P.have+u>P.nlen+P.ndist){k.msg="invalid bit length repeat",P.mode=30;break}for(;u--;)P.lens[P.have++]=ce}}if(30===P.mode)break;if(0===P.lens[256]){k.msg="invalid code -- missing end-of-block",P.mode=30;break}if(P.lenbits=9,Me=O(1,P.lens,0,P.nlen,P.lencode,0,P.work,$e={bits:P.lenbits}),P.lenbits=$e.bits,Me){k.msg="invalid literal/lengths set",P.mode=30;break}if(P.distbits=6,P.distcode=P.distdyn,Me=O(2,P.lens,P.nlen,P.ndist,P.distcode,0,P.work,$e={bits:P.distbits}),P.distbits=$e.bits,Me){k.msg="invalid distances set",P.mode=30;break}if(P.mode=20,6===v)break e;case 20:P.mode=21;case 21:if(6<=R&&258<=F){k.next_out=fe,k.avail_out=F,k.next_in=D,k.avail_in=R,P.hold=g,P.bits=l,w(k,f),fe=k.next_out,te=k.output,F=k.avail_out,D=k.next_in,B=k.input,R=k.avail_in,g=P.hold,l=P.bits,12===P.mode&&(P.back=-1);break}for(P.back=0;$=(he=P.lencode[g&(1<<P.lenbits)-1])>>>16&255,ie=65535&he,!((C=he>>>24)<=l);){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}if($&&0==(240&$)){for(se=C,Ee=$,Ie=ie;$=(he=P.lencode[Ie+((g&(1<<se+Ee)-1)>>se)])>>>16&255,ie=65535&he,!(se+(C=he>>>24)<=l);){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}g>>>=se,l-=se,P.back+=se}if(g>>>=C,l-=C,P.back+=C,P.length=ie,0===$){P.mode=26;break}if(32&$){P.back=-1,P.mode=12;break}if(64&$){k.msg="invalid literal/length code",P.mode=30;break}P.extra=15&$,P.mode=22;case 22:if(P.extra){for(ye=P.extra;l<ye;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}P.length+=g&(1<<P.extra)-1,g>>>=P.extra,l-=P.extra,P.back+=P.extra}P.was=P.length,P.mode=23;case 23:for(;$=(he=P.distcode[g&(1<<P.distbits)-1])>>>16&255,ie=65535&he,!((C=he>>>24)<=l);){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}if(0==(240&$)){for(se=C,Ee=$,Ie=ie;$=(he=P.distcode[Ie+((g&(1<<se+Ee)-1)>>se)])>>>16&255,ie=65535&he,!(se+(C=he>>>24)<=l);){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}g>>>=se,l-=se,P.back+=se}if(g>>>=C,l-=C,P.back+=C,64&$){k.msg="invalid distance code",P.mode=30;break}P.offset=ie,P.extra=15&$,P.mode=24;case 24:if(P.extra){for(ye=P.extra;l<ye;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}P.offset+=g&(1<<P.extra)-1,g>>>=P.extra,l-=P.extra,P.back+=P.extra}if(P.offset>P.dmax){k.msg="invalid distance too far back",P.mode=30;break}P.mode=25;case 25:if(0===F)break e;if(P.offset>(u=f-F)){if((u=P.offset-u)>P.whave&&P.sane){k.msg="invalid distance too far back",P.mode=30;break}p=u>P.wnext?P.wsize-(u-=P.wnext):P.wnext-u,u>P.length&&(u=P.length),m=P.window}else m=te,p=fe-P.offset,u=P.length;for(F<u&&(u=F),F-=u,P.length-=u;te[fe++]=m[p++],--u;);0===P.length&&(P.mode=21);break;case 26:if(0===F)break e;te[fe++]=P.length,F--,P.mode=21;break;case 27:if(P.wrap){for(;l<32;){if(0===R)break e;R--,g|=B[D++]<<l,l+=8}if(k.total_out+=f-=F,P.total+=f,f&&(k.adler=P.check=P.flags?_(P.check,te,f,fe-f):J(P.check,te,f,fe-f)),f=F,(P.flags?g:T(g))!==P.check){k.msg="incorrect data check",P.mode=30;break}l=g=0}P.mode=28;case 28:if(P.wrap&&P.flags){for(;l<32;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}if(g!==(4294967295&P.total)){k.msg="incorrect length check",P.mode=30;break}l=g=0}P.mode=29;case 29:Me=1;break e;case 30:Me=-3;break e;case 31:return-4;default:return A}return k.next_out=fe,k.avail_out=F,k.next_in=D,k.avail_in=R,P.hold=g,P.bits=l,(P.wsize||f!==k.avail_out&&P.mode<30&&(P.mode<27||4!==v))&&S(k,k.output,k.next_out,f-k.avail_out)?(P.mode=31,-4):(f-=k.avail_out,k.total_in+=c-=k.avail_in,k.total_out+=f,P.total+=f,P.wrap&&f&&(k.adler=P.check=P.flags?_(P.check,te,f,k.next_out-f):J(P.check,te,f,k.next_out-f)),k.data_type=P.bits+(P.last?64:0)+(12===P.mode?128:0)+(20===P.mode||15===P.mode?256:0),(0==c&&0===f||4===v)&&0===Me&&(Me=-5),Me)},d.inflateEnd=function(k){if(!k||!k.state)return A;var v=k.state;return v.window&&(v.window=null),k.state=null,0},d.inflateGetHeader=function(k,v){var P;return k&&k.state?0==(2&(P=k.state).wrap)?A:((P.head=v).done=!1,0):A},d.inflateSetDictionary=function(k,v){var P,B=v.length;return k&&k.state?0!==(P=k.state).wrap&&11!==P.mode?A:11===P.mode&&J(1,v,B,0)!==P.check?-3:S(k,v,B,B)?(P.mode=31,-4):(P.havedict=1,0):A},d.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(le,_e,d){"use strict";var H=le("../utils/common"),J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],_=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],w=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],O=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];_e.exports=function(x,K,V,A,U,N,Y,T){var j,re,z,q,Z,M,I,X,L,S=T.bits,k=0,v=0,P=0,B=0,te=0,D=0,fe=0,R=0,F=0,g=0,l=null,c=0,f=new H.Buf16(16),u=new H.Buf16(16),p=null,m=0;for(k=0;k<=15;k++)f[k]=0;for(v=0;v<A;v++)f[K[V+v]]++;for(te=S,B=15;1<=B&&0===f[B];B--);if(B<te&&(te=B),0===B)return U[N++]=20971520,U[N++]=20971520,T.bits=1,0;for(P=1;P<B&&0===f[P];P++);for(te<P&&(te=P),k=R=1;k<=15;k++)if(R<<=1,(R-=f[k])<0)return-1;if(0<R&&(0===x||1!==B))return-1;for(u[1]=0,k=1;k<15;k++)u[k+1]=u[k]+f[k];for(v=0;v<A;v++)0!==K[V+v]&&(Y[u[K[V+v]]++]=v);if(M=0===x?(l=p=Y,19):1===x?(l=J,c-=257,p=_,m-=257,256):(l=w,p=O,-1),k=P,Z=N,fe=v=g=0,z=-1,q=(F=1<<(D=te))-1,1===x&&852<F||2===x&&592<F)return 1;for(;;){for(I=k-fe,L=Y[v]<M?(X=0,Y[v]):Y[v]>M?(X=p[m+Y[v]],l[c+Y[v]]):(X=96,0),j=1<<k-fe,P=re=1<<D;U[Z+(g>>fe)+(re-=j)]=I<<24|X<<16|L|0,0!==re;);for(j=1<<k-1;g&j;)j>>=1;if(0!==j?(g&=j-1,g+=j):g=0,v++,0==--f[k]){if(k===B)break;k=K[V+Y[v]]}if(te<k&&(g&q)!==z){for(0===fe&&(fe=te),Z+=P,R=1<<(D=k-fe);D+fe<B&&!((R-=f[D+fe])<=0);)D++,R<<=1;if(F+=1<<D,1===x&&852<F||2===x&&592<F)return 1;U[z=g&q]=te<<24|D<<16|Z-N|0}}return 0!==g&&(U[Z+g]=k-fe<<24|64<<16|0),T.bits=te,0}},{"../utils/common":41}],51:[function(le,_e,d){"use strict";_e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(le,_e,d){"use strict";var H=le("../utils/common");function w(he){for(var Se=he.length;0<=--Se;)he[Se]=0}var K=256,V=286,A=30,Y=15,M=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],I=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],X=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S=new Array(576);w(S);var k=new Array(60);w(k);var v=new Array(512);w(v);var P=new Array(256);w(P);var B=new Array(29);w(B);var te,D,fe,R=new Array(A);function F(he,Se,be,ae,ue){this.static_tree=he,this.extra_bits=Se,this.extra_base=be,this.elems=ae,this.max_length=ue,this.has_stree=he&&he.length}function g(he,Se){this.dyn_tree=he,this.max_code=0,this.stat_desc=Se}function l(he){return he<256?v[he]:v[256+(he>>>7)]}function c(he,Se){he.pending_buf[he.pending++]=255&Se,he.pending_buf[he.pending++]=Se>>>8&255}function f(he,Se,be){he.bi_valid>16-be?(he.bi_buf|=Se<<he.bi_valid&65535,c(he,he.bi_buf),he.bi_buf=Se>>16-he.bi_valid,he.bi_valid+=be-16):(he.bi_buf|=Se<<he.bi_valid&65535,he.bi_valid+=be)}function u(he,Se,be){f(he,be[2*Se],be[2*Se+1])}function p(he,Se){for(var be=0;be|=1&he,he>>>=1,be<<=1,0<--Se;);return be>>>1}function m(he,Se,be){var ae,ue,Ce=new Array(16),y=0;for(ae=1;ae<=Y;ae++)Ce[ae]=y=y+be[ae-1]<<1;for(ue=0;ue<=Se;ue++){var W=he[2*ue+1];0!==W&&(he[2*ue]=p(Ce[W]++,W))}}function C(he){var Se;for(Se=0;Se<V;Se++)he.dyn_ltree[2*Se]=0;for(Se=0;Se<A;Se++)he.dyn_dtree[2*Se]=0;for(Se=0;Se<19;Se++)he.bl_tree[2*Se]=0;he.dyn_ltree[512]=1,he.opt_len=he.static_len=0,he.last_lit=he.matches=0}function $(he){8<he.bi_valid?c(he,he.bi_buf):0<he.bi_valid&&(he.pending_buf[he.pending++]=he.bi_buf),he.bi_buf=0,he.bi_valid=0}function ie(he,Se,be,ae){var ue=2*Se,Ce=2*be;return he[ue]<he[Ce]||he[ue]===he[Ce]&&ae[Se]<=ae[be]}function se(he,Se,be){for(var ae=he.heap[be],ue=be<<1;ue<=he.heap_len&&(ue<he.heap_len&&ie(Se,he.heap[ue+1],he.heap[ue],he.depth)&&ue++,!ie(Se,ae,he.heap[ue],he.depth));)he.heap[be]=he.heap[ue],be=ue,ue<<=1;he.heap[be]=ae}function Ee(he,Se,be){var ae,ue,Ce,y,W=0;if(0!==he.last_lit)for(;ae=he.pending_buf[he.d_buf+2*W]<<8|he.pending_buf[he.d_buf+2*W+1],ue=he.pending_buf[he.l_buf+W],W++,0===ae?u(he,ue,Se):(u(he,(Ce=P[ue])+K+1,Se),0!==(y=M[Ce])&&f(he,ue-=B[Ce],y),u(he,Ce=l(--ae),be),0!==(y=I[Ce])&&f(he,ae-=R[Ce],y)),W<he.last_lit;);u(he,256,Se)}function Ie(he,Se){var be,ae,ue,Ce=Se.dyn_tree,y=Se.stat_desc.static_tree,W=Se.stat_desc.has_stree,pe=Se.stat_desc.elems,we=-1;for(he.heap_len=0,he.heap_max=573,be=0;be<pe;be++)0!==Ce[2*be]?(he.heap[++he.heap_len]=we=be,he.depth[be]=0):Ce[2*be+1]=0;for(;he.heap_len<2;)Ce[2*(ue=he.heap[++he.heap_len]=we<2?++we:0)]=1,he.depth[ue]=0,he.opt_len--,W&&(he.static_len-=y[2*ue+1]);for(Se.max_code=we,be=he.heap_len>>1;1<=be;be--)se(he,Ce,be);for(ue=pe;be=he.heap[1],he.heap[1]=he.heap[he.heap_len--],se(he,Ce,1),ae=he.heap[1],he.heap[--he.heap_max]=be,he.heap[--he.heap_max]=ae,Ce[2*ue]=Ce[2*be]+Ce[2*ae],he.depth[ue]=(he.depth[be]>=he.depth[ae]?he.depth[be]:he.depth[ae])+1,Ce[2*be+1]=Ce[2*ae+1]=ue,he.heap[1]=ue++,se(he,Ce,1),2<=he.heap_len;);he.heap[--he.heap_max]=he.heap[1],function(De,Fe){var Ye,at,It,At,ln,Jt,Dn=Fe.dyn_tree,Tn=Fe.max_code,vr=Fe.stat_desc.static_tree,fa=Fe.stat_desc.has_stree,ja=Fe.stat_desc.extra_bits,Ua=Fe.stat_desc.extra_base,wo=Fe.stat_desc.max_length,or=0;for(At=0;At<=Y;At++)De.bl_count[At]=0;for(Dn[2*De.heap[De.heap_max]+1]=0,Ye=De.heap_max+1;Ye<573;Ye++)wo<(At=Dn[2*Dn[2*(at=De.heap[Ye])+1]+1]+1)&&(At=wo,or++),Dn[2*at+1]=At,Tn<at||(De.bl_count[At]++,ln=0,Ua<=at&&(ln=ja[at-Ua]),De.opt_len+=(Jt=Dn[2*at])*(At+ln),fa&&(De.static_len+=Jt*(vr[2*at+1]+ln)));if(0!==or){do{for(At=wo-1;0===De.bl_count[At];)At--;De.bl_count[At]--,De.bl_count[At+1]+=2,De.bl_count[wo]--,or-=2}while(0<or);for(At=wo;0!==At;At--)for(at=De.bl_count[At];0!==at;)Tn<(It=De.heap[--Ye])||(Dn[2*It+1]!==At&&(De.opt_len+=(At-Dn[2*It+1])*Dn[2*It],Dn[2*It+1]=At),at--)}}(he,Se),m(Ce,we,he.bl_count)}function ce(he,Se,be){var ae,ue,Ce=-1,y=Se[1],W=0,pe=7,we=4;for(0===y&&(pe=138,we=3),Se[2*(be+1)+1]=65535,ae=0;ae<=be;ae++)ue=y,y=Se[2*(ae+1)+1],++W<pe&&ue===y||(W<we?he.bl_tree[2*ue]+=W:0!==ue?(ue!==Ce&&he.bl_tree[2*ue]++,he.bl_tree[32]++):W<=10?he.bl_tree[34]++:he.bl_tree[36]++,Ce=ue,we=(W=0)===y?(pe=138,3):ue===y?(pe=6,3):(pe=7,4))}function Me(he,Se,be){var ae,ue,Ce=-1,y=Se[1],W=0,pe=7,we=4;for(0===y&&(pe=138,we=3),ae=0;ae<=be;ae++)if(ue=y,y=Se[2*(ae+1)+1],!(++W<pe&&ue===y)){if(W<we)for(;u(he,ue,he.bl_tree),0!=--W;);else 0!==ue?(ue!==Ce&&(u(he,ue,he.bl_tree),W--),u(he,16,he.bl_tree),f(he,W-3,2)):W<=10?(u(he,17,he.bl_tree),f(he,W-3,3)):(u(he,18,he.bl_tree),f(he,W-11,7));Ce=ue,we=(W=0)===y?(pe=138,3):ue===y?(pe=6,3):(pe=7,4)}}w(R);var $e=!1;function ye(he,Se,be,ae){var ue,Ce,y;f(he,0+(ae?1:0),3),Ce=Se,y=be,$(ue=he),c(ue,y),c(ue,~y),H.arraySet(ue.pending_buf,ue.window,Ce,y,ue.pending),ue.pending+=y}d._tr_init=function(he){$e||(function(){var Se,be,ae,ue,Ce,y=new Array(16);for(ue=ae=0;ue<28;ue++)for(B[ue]=ae,Se=0;Se<1<<M[ue];Se++)P[ae++]=ue;for(P[ae-1]=ue,ue=Ce=0;ue<16;ue++)for(R[ue]=Ce,Se=0;Se<1<<I[ue];Se++)v[Ce++]=ue;for(Ce>>=7;ue<A;ue++)for(R[ue]=Ce<<7,Se=0;Se<1<<I[ue]-7;Se++)v[256+Ce++]=ue;for(be=0;be<=Y;be++)y[be]=0;for(Se=0;Se<=143;)S[2*Se+1]=8,Se++,y[8]++;for(;Se<=255;)S[2*Se+1]=9,Se++,y[9]++;for(;Se<=279;)S[2*Se+1]=7,Se++,y[7]++;for(;Se<=287;)S[2*Se+1]=8,Se++,y[8]++;for(m(S,287,y),Se=0;Se<A;Se++)k[2*Se+1]=5,k[2*Se]=p(Se,5);te=new F(S,M,257,V,Y),D=new F(k,I,0,A,Y),fe=new F(new Array(0),X,0,19,7)}(),$e=!0),he.l_desc=new g(he.dyn_ltree,te),he.d_desc=new g(he.dyn_dtree,D),he.bl_desc=new g(he.bl_tree,fe),he.bi_buf=0,he.bi_valid=0,C(he)},d._tr_stored_block=ye,d._tr_flush_block=function(he,Se,be,ae){var ue,Ce,y=0;0<he.level?(2===he.strm.data_type&&(he.strm.data_type=function(W){var pe,we=4093624447;for(pe=0;pe<=31;pe++,we>>>=1)if(1&we&&0!==W.dyn_ltree[2*pe])return 0;if(0!==W.dyn_ltree[18]||0!==W.dyn_ltree[20]||0!==W.dyn_ltree[26])return 1;for(pe=32;pe<K;pe++)if(0!==W.dyn_ltree[2*pe])return 1;return 0}(he)),Ie(he,he.l_desc),Ie(he,he.d_desc),y=function(W){var pe;for(ce(W,W.dyn_ltree,W.l_desc.max_code),ce(W,W.dyn_dtree,W.d_desc.max_code),Ie(W,W.bl_desc),pe=18;3<=pe&&0===W.bl_tree[2*L[pe]+1];pe--);return W.opt_len+=3*(pe+1)+5+5+4,pe}(he),(Ce=he.static_len+3+7>>>3)<=(ue=he.opt_len+3+7>>>3)&&(ue=Ce)):ue=Ce=be+5,be+4<=ue&&-1!==Se?ye(he,Se,be,ae):4===he.strategy||Ce===ue?(f(he,2+(ae?1:0),3),Ee(he,S,k)):(f(he,4+(ae?1:0),3),function(W,pe,we,De){var Fe;for(f(W,pe-257,5),f(W,we-1,5),f(W,De-4,4),Fe=0;Fe<De;Fe++)f(W,W.bl_tree[2*L[Fe]+1],3);Me(W,W.dyn_ltree,pe-1),Me(W,W.dyn_dtree,we-1)}(he,he.l_desc.max_code+1,he.d_desc.max_code+1,y+1),Ee(he,he.dyn_ltree,he.dyn_dtree)),C(he),ae&&$(he)},d._tr_tally=function(he,Se,be){return he.pending_buf[he.d_buf+2*he.last_lit]=Se>>>8&255,he.pending_buf[he.d_buf+2*he.last_lit+1]=255&Se,he.pending_buf[he.l_buf+he.last_lit]=255&be,he.last_lit++,0===Se?he.dyn_ltree[2*be]++:(he.matches++,Se--,he.dyn_ltree[2*(P[be]+K+1)]++,he.dyn_dtree[2*l(Se)]++),he.last_lit===he.lit_bufsize-1},d._tr_align=function(he){var Se;f(he,2,3),u(he,256,S),16===(Se=he).bi_valid?(c(Se,Se.bi_buf),Se.bi_buf=0,Se.bi_valid=0):8<=Se.bi_valid&&(Se.pending_buf[Se.pending++]=255&Se.bi_buf,Se.bi_buf>>=8,Se.bi_valid-=8)}},{"../utils/common":41}],53:[function(le,_e,d){"use strict";_e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(le,_e,d){(function(H){!function(J,_){"use strict";if(!J.setImmediate){var w,O,x,K,V=1,A={},U=!1,N=J.document,Y=Object.getPrototypeOf&&Object.getPrototypeOf(J);Y=Y&&Y.setTimeout?Y:J,w="[object process]"==={}.toString.call(J.process)?function(z){process.nextTick(function(){j(z)})}:function(){if(J.postMessage&&!J.importScripts){var z=!0,q=J.onmessage;return J.onmessage=function(){z=!1},J.postMessage("","*"),J.onmessage=q,z}}()?(K="setImmediate$"+Math.random()+"$",J.addEventListener?J.addEventListener("message",re,!1):J.attachEvent("onmessage",re),function(z){J.postMessage(K+z,"*")}):J.MessageChannel?((x=new MessageChannel).port1.onmessage=function(z){j(z.data)},function(z){x.port2.postMessage(z)}):N&&"onreadystatechange"in N.createElement("script")?(O=N.documentElement,function(z){var q=N.createElement("script");q.onreadystatechange=function(){j(z),q.onreadystatechange=null,O.removeChild(q),q=null},O.appendChild(q)}):function(z){setTimeout(j,0,z)},Y.setImmediate=function(z){"function"!=typeof z&&(z=new Function(""+z));for(var q=new Array(arguments.length-1),Z=0;Z<q.length;Z++)q[Z]=arguments[Z+1];return A[V]={callback:z,args:q},w(V),V++},Y.clearImmediate=T}function T(z){delete A[z]}function j(z){if(U)setTimeout(j,0,z);else{var q=A[z];if(q){U=!0;try{!function(Z){var M=Z.callback,I=Z.args;switch(I.length){case 0:M();break;case 1:M(I[0]);break;case 2:M(I[0],I[1]);break;case 3:M(I[0],I[1],I[2]);break;default:M.apply(undefined,I)}}(q)}finally{T(z),U=!1}}}}function re(z){z.source===J&&"string"==typeof z.data&&0===z.data.indexOf(K)&&j(+z.data.slice(K.length))}}(typeof self>"u"?void 0===H?this:H:self)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)},4424:E=>{E.exports=function H(J,_,w){function O(V,A){if(!_[V]){if(!J[V]){if(x)return x(V,!0);var N=new Error("Cannot find module '"+V+"'");throw N.code="MODULE_NOT_FOUND",N}var Y=_[V]={exports:{}};J[V][0].call(Y.exports,function(T){return O(J[V][1][T]||T)},Y,Y.exports,H,J,_,w)}return _[V].exports}for(var x=void 0,K=0;K<w.length;K++)O(w[K]);return O}({1:[function(H,J,_){(function(w){"use strict";var x,O=w.MutationObserver||w.WebKitMutationObserver;if(O){var K=0,V=new O(T),A=w.document.createTextNode("");V.observe(A,{characterData:!0}),x=function(){A.data=K=++K%2}}else if(!w.setImmediate&&typeof w.MessageChannel<"u"){var U=new w.MessageChannel;U.port1.onmessage=T,x=function(){U.port2.postMessage(0)}}else x="document"in w&&"onreadystatechange"in w.document.createElement("script")?function(){var re=w.document.createElement("script");re.onreadystatechange=function(){T(),re.onreadystatechange=null,re.parentNode.removeChild(re),re=null},w.document.documentElement.appendChild(re)}:function(){setTimeout(T,0)};var N,Y=[];function T(){N=!0;for(var re,z,q=Y.length;q;){for(z=Y,Y=[],re=-1;++re<q;)z[re]();q=Y.length}N=!1}J.exports=function j(re){1===Y.push(re)&&!N&&x()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(H,J,_){"use strict";var w=H(1);function O(){}var x={},K=["REJECTED"],V=["FULFILLED"],A=["PENDING"];function U(I){if("function"!=typeof I)throw new TypeError("resolver must be a function");this.state=A,this.queue=[],this.outcome=void 0,I!==O&&j(this,I)}function N(I,X,L){this.promise=I,"function"==typeof X&&(this.onFulfilled=X,this.callFulfilled=this.otherCallFulfilled),"function"==typeof L&&(this.onRejected=L,this.callRejected=this.otherCallRejected)}function Y(I,X,L){w(function(){var S;try{S=X(L)}catch(k){return x.reject(I,k)}S===I?x.reject(I,new TypeError("Cannot resolve promise with itself")):x.resolve(I,S)})}function T(I){var X=I&&I.then;if(I&&("object"==typeof I||"function"==typeof I)&&"function"==typeof X)return function(){X.apply(I,arguments)}}function j(I,X){var L=!1;function S(B){L||(L=!0,x.reject(I,B))}function k(B){L||(L=!0,x.resolve(I,B))}var P=re(function v(){X(k,S)});"error"===P.status&&S(P.value)}function re(I,X){var L={};try{L.value=I(X),L.status="success"}catch(S){L.status="error",L.value=S}return L}J.exports=U,U.prototype.catch=function(I){return this.then(null,I)},U.prototype.then=function(I,X){if("function"!=typeof I&&this.state===V||"function"!=typeof X&&this.state===K)return this;var L=new this.constructor(O);return this.state!==A?Y(L,this.state===V?I:X,this.outcome):this.queue.push(new N(L,I,X)),L},N.prototype.callFulfilled=function(I){x.resolve(this.promise,I)},N.prototype.otherCallFulfilled=function(I){Y(this.promise,this.onFulfilled,I)},N.prototype.callRejected=function(I){x.reject(this.promise,I)},N.prototype.otherCallRejected=function(I){Y(this.promise,this.onRejected,I)},x.resolve=function(I,X){var L=re(T,X);if("error"===L.status)return x.reject(I,L.value);var S=L.value;if(S)j(I,S);else{I.state=V,I.outcome=X;for(var k=-1,v=I.queue.length;++k<v;)I.queue[k].callFulfilled(X)}return I},x.reject=function(I,X){I.state=K,I.outcome=X;for(var L=-1,S=I.queue.length;++L<S;)I.queue[L].callRejected(X);return I},U.resolve=function z(I){return I instanceof this?I:x.resolve(new this(O),I)},U.reject=function q(I){var X=new this(O);return x.reject(X,I)},U.all=function Z(I){var X=this;if("[object Array]"!==Object.prototype.toString.call(I))return this.reject(new TypeError("must be an array"));var L=I.length,S=!1;if(!L)return this.resolve([]);for(var k=new Array(L),v=0,P=-1,B=new this(O);++P<L;)te(I[P],P);return B;function te(D,fe){X.resolve(D).then(function R(F){k[fe]=F,++v===L&&!S&&(S=!0,x.resolve(B,k))},function(F){S||(S=!0,x.reject(B,F))})}},U.race=function M(I){var X=this;if("[object Array]"!==Object.prototype.toString.call(I))return this.reject(new TypeError("must be an array"));var L=I.length,S=!1;if(!L)return this.resolve([]);for(var k=-1,v=new this(O);++k<L;)X.resolve(I[k]).then(function(te){S||(S=!0,x.resolve(v,te))},function(te){S||(S=!0,x.reject(v,te))});return v}},{1:1}],3:[function(H,J,_){(function(w){"use strict";"function"!=typeof w.Promise&&(w.Promise=H(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(H,J,_){"use strict";var w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(Be){return typeof Be}:function(Be){return Be&&"function"==typeof Symbol&&Be.constructor===Symbol&&Be!==Symbol.prototype?"symbol":typeof Be};var K=function x(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}();function A(Be,Ke){Be=Be||[],Ke=Ke||{};try{return new Blob(Be,Ke)}catch(Je){if("TypeError"!==Je.name)throw Je;for(var Xe=new(typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder),ot=0;ot<Be.length;ot+=1)Xe.append(Be[ot]);return Xe.getBlob(Ke.type)}}typeof Promise>"u"&&H(3);var U=Promise;function N(Be,Ke){Ke&&Be.then(function(Ge){Ke(null,Ge)},function(Ge){Ke(Ge)})}function Y(Be,Ke,Ge){"function"==typeof Ke&&Be.then(Ke),"function"==typeof Ge&&Be.catch(Ge)}function T(Be){return"string"!=typeof Be&&(console.warn(Be+" used as a key, but it is not a string."),Be=String(Be)),Be}function j(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var re="local-forage-detect-blob-support",z=void 0,q={},Z=Object.prototype.toString,M="readonly",I="readwrite";function X(Be){for(var Ke=Be.length,Ge=new ArrayBuffer(Ke),Xe=new Uint8Array(Ge),ot=0;ot<Ke;ot++)Xe[ot]=Be.charCodeAt(ot);return Ge}function S(Be){return"boolean"==typeof z?U.resolve(z):function L(Be){return new U(function(Ke){var Ge=Be.transaction(re,I),Xe=A([""]);Ge.objectStore(re).put(Xe,"key"),Ge.onabort=function(ot){ot.preventDefault(),ot.stopPropagation(),Ke(!1)},Ge.oncomplete=function(){var ot=navigator.userAgent.match(/Chrome\/(\d+)/),Je=navigator.userAgent.match(/Edge\//);Ke(Je||!ot||parseInt(ot[1],10)>=43)}}).catch(function(){return!1})}(Be).then(function(Ke){return z=Ke})}function k(Be){var Ke=q[Be.name],Ge={};Ge.promise=new U(function(Xe,ot){Ge.resolve=Xe,Ge.reject=ot}),Ke.deferredOperations.push(Ge),Ke.dbReady=Ke.dbReady?Ke.dbReady.then(function(){return Ge.promise}):Ge.promise}function v(Be){var Ge=q[Be.name].deferredOperations.pop();if(Ge)return Ge.resolve(),Ge.promise}function P(Be,Ke){var Xe=q[Be.name].deferredOperations.pop();if(Xe)return Xe.reject(Ke),Xe.promise}function B(Be,Ke){return new U(function(Ge,Xe){if(q[Be.name]=q[Be.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},Be.db){if(!Ke)return Ge(Be.db);k(Be),Be.db.close()}var ot=[Be.name];Ke&&ot.push(Be.version);var Je=K.open.apply(K,ot);Ke&&(Je.onupgradeneeded=function($t){var gt=Je.result;try{gt.createObjectStore(Be.storeName),$t.oldVersion<=1&&gt.createObjectStore(re)}catch(Nt){if("ConstraintError"!==Nt.name)throw Nt;console.warn('The database "'+Be.name+'" has been upgraded from version '+$t.oldVersion+" to version "+$t.newVersion+', but the storage "'+Be.storeName+'" already exists.')}}),Je.onerror=function($t){$t.preventDefault(),Xe(Je.error)},Je.onsuccess=function(){var $t=Je.result;$t.onversionchange=function(gt){gt.target.close()},Ge($t),v(Be)}})}function te(Be){return B(Be,!1)}function D(Be){return B(Be,!0)}function fe(Be,Ke){if(!Be.db)return!0;var Ge=!Be.db.objectStoreNames.contains(Be.storeName),ot=Be.version>Be.db.version;if(Be.version<Be.db.version&&(Be.version!==Ke&&console.warn('The database "'+Be.name+"\" can't be downgraded from version "+Be.db.version+" to version "+Be.version+"."),Be.version=Be.db.version),ot||Ge){if(Ge){var Je=Be.db.version+1;Je>Be.version&&(Be.version=Je)}return!0}return!1}function F(Be){return A([X(atob(Be.data))],{type:Be.type})}function g(Be){return Be&&Be.__local_forage_encoded_blob}function l(Be){var Ke=this,Ge=Ke._initReady().then(function(){var Xe=q[Ke._dbInfo.name];if(Xe&&Xe.dbReady)return Xe.dbReady});return Y(Ge,Be,Be),Ge}function f(Be,Ke,Ge,Xe){void 0===Xe&&(Xe=1);try{var ot=Be.db.transaction(Be.storeName,Ke);Ge(null,ot)}catch(Je){if(Xe>0&&(!Be.db||"InvalidStateError"===Je.name||"NotFoundError"===Je.name))return U.resolve().then(function(){if(!Be.db||"NotFoundError"===Je.name&&!Be.db.objectStoreNames.contains(Be.storeName)&&Be.version<=Be.db.version)return Be.db&&(Be.version=Be.db.version+1),D(Be)}).then(function(){return function c(Be){k(Be);for(var Ke=q[Be.name],Ge=Ke.forages,Xe=0;Xe<Ge.length;Xe++){var ot=Ge[Xe];ot._dbInfo.db&&(ot._dbInfo.db.close(),ot._dbInfo.db=null)}return Be.db=null,te(Be).then(function(Je){return Be.db=Je,fe(Be)?D(Be):Je}).then(function(Je){Be.db=Ke.db=Je;for(var $t=0;$t<Ge.length;$t++)Ge[$t]._dbInfo.db=Je}).catch(function(Je){throw P(Be,Je),Je})}(Be).then(function(){f(Be,Ke,Ge,Xe-1)})}).catch(Ge);Ge(Je)}}var $e={_driver:"asyncStorage",_initStorage:function p(Be){var Ke=this,Ge={db:null};if(Be)for(var Xe in Be)Ge[Xe]=Be[Xe];var ot=q[Ge.name];ot||(q[Ge.name]=ot={forages:[],db:null,dbReady:null,deferredOperations:[]}),ot.forages.push(Ke),Ke._initReady||(Ke._initReady=Ke.ready,Ke.ready=l);var Je=[];function $t(){return U.resolve()}for(var gt=0;gt<ot.forages.length;gt++){var Nt=ot.forages[gt];Nt!==Ke&&Je.push(Nt._initReady().catch($t))}var Ft=ot.forages.slice(0);return U.all(Je).then(function(){return Ge.db=ot.db,te(Ge)}).then(function(et){return Ge.db=et,fe(Ge,Ke._defaultConfig.version)?D(Ge):et}).then(function(et){Ge.db=ot.db=et,Ke._dbInfo=Ge;for(var Kt=0;Kt<Ft.length;Kt++){var zt=Ft[Kt];zt!==Ke&&(zt._dbInfo.db=Ge.db,zt._dbInfo.version=Ge.version)}})},_support:function V(){try{if(!K||!K.open)return!1;var Be=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),Ke="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!Be||Ke)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}(),iterate:function C(Be,Ke){var Ge=this,Xe=new U(function(ot,Je){Ge.ready().then(function(){f(Ge._dbInfo,M,function($t,gt){if($t)return Je($t);try{var Ft=gt.objectStore(Ge._dbInfo.storeName).openCursor(),et=1;Ft.onsuccess=function(){var Kt=Ft.result;if(Kt){var zt=Kt.value;g(zt)&&(zt=F(zt));var en=Be(zt,Kt.key,et++);void 0!==en?ot(en):Kt.continue()}else ot()},Ft.onerror=function(){Je(Ft.error)}}catch(Kt){Je(Kt)}})}).catch(Je)});return N(Xe,Ke),Xe},getItem:function m(Be,Ke){var Ge=this;Be=T(Be);var Xe=new U(function(ot,Je){Ge.ready().then(function(){f(Ge._dbInfo,M,function($t,gt){if($t)return Je($t);try{var Ft=gt.objectStore(Ge._dbInfo.storeName).get(Be);Ft.onsuccess=function(){var et=Ft.result;void 0===et&&(et=null),g(et)&&(et=F(et)),ot(et)},Ft.onerror=function(){Je(Ft.error)}}catch(et){Je(et)}})}).catch(Je)});return N(Xe,Ke),Xe},setItem:function $(Be,Ke,Ge){var Xe=this;Be=T(Be);var ot=new U(function(Je,$t){var gt;Xe.ready().then(function(){return gt=Xe._dbInfo,"[object Blob]"===Z.call(Ke)?S(gt.db).then(function(Nt){return Nt?Ke:function R(Be){return new U(function(Ke,Ge){var Xe=new FileReader;Xe.onerror=Ge,Xe.onloadend=function(ot){var Je=btoa(ot.target.result||"");Ke({__local_forage_encoded_blob:!0,data:Je,type:Be.type})},Xe.readAsBinaryString(Be)})}(Ke)}):Ke}).then(function(Nt){f(Xe._dbInfo,I,function(Ft,et){if(Ft)return $t(Ft);try{var Kt=et.objectStore(Xe._dbInfo.storeName);null===Nt&&(Nt=void 0);var zt=Kt.put(Nt,Be);et.oncomplete=function(){void 0===Nt&&(Nt=null),Je(Nt)},et.onabort=et.onerror=function(){$t(zt.error?zt.error:zt.transaction.error)}}catch(en){$t(en)}})}).catch($t)});return N(ot,Ge),ot},removeItem:function ie(Be,Ke){var Ge=this;Be=T(Be);var Xe=new U(function(ot,Je){Ge.ready().then(function(){f(Ge._dbInfo,I,function($t,gt){if($t)return Je($t);try{var Ft=gt.objectStore(Ge._dbInfo.storeName).delete(Be);gt.oncomplete=function(){ot()},gt.onerror=function(){Je(Ft.error)},gt.onabort=function(){Je(Ft.error?Ft.error:Ft.transaction.error)}}catch(et){Je(et)}})}).catch(Je)});return N(Xe,Ke),Xe},clear:function se(Be){var Ke=this,Ge=new U(function(Xe,ot){Ke.ready().then(function(){f(Ke._dbInfo,I,function(Je,$t){if(Je)return ot(Je);try{var Nt=$t.objectStore(Ke._dbInfo.storeName).clear();$t.oncomplete=function(){Xe()},$t.onabort=$t.onerror=function(){ot(Nt.error?Nt.error:Nt.transaction.error)}}catch(Ft){ot(Ft)}})}).catch(ot)});return N(Ge,Be),Ge},length:function Ee(Be){var Ke=this,Ge=new U(function(Xe,ot){Ke.ready().then(function(){f(Ke._dbInfo,M,function(Je,$t){if(Je)return ot(Je);try{var Nt=$t.objectStore(Ke._dbInfo.storeName).count();Nt.onsuccess=function(){Xe(Nt.result)},Nt.onerror=function(){ot(Nt.error)}}catch(Ft){ot(Ft)}})}).catch(ot)});return N(Ge,Be),Ge},key:function Ie(Be,Ke){var Ge=this,Xe=new U(function(ot,Je){Be<0?ot(null):Ge.ready().then(function(){f(Ge._dbInfo,M,function($t,gt){if($t)return Je($t);try{var Nt=gt.objectStore(Ge._dbInfo.storeName),Ft=!1,et=Nt.openKeyCursor();et.onsuccess=function(){var Kt=et.result;Kt?0===Be||Ft?ot(Kt.key):(Ft=!0,Kt.advance(Be)):ot(null)},et.onerror=function(){Je(et.error)}}catch(Kt){Je(Kt)}})}).catch(Je)});return N(Xe,Ke),Xe},keys:function ce(Be){var Ke=this,Ge=new U(function(Xe,ot){Ke.ready().then(function(){f(Ke._dbInfo,M,function(Je,$t){if(Je)return ot(Je);try{var Nt=$t.objectStore(Ke._dbInfo.storeName).openKeyCursor(),Ft=[];Nt.onsuccess=function(){var et=Nt.result;et?(Ft.push(et.key),et.continue()):Xe(Ft)},Nt.onerror=function(){ot(Nt.error)}}catch(et){ot(et)}})}).catch(ot)});return N(Ge,Be),Ge},dropInstance:function Me(Be,Ke){Ke=j.apply(this,arguments);var Ge=this.config();(Be="function"!=typeof Be&&Be||{}).name||(Be.name=Be.name||Ge.name,Be.storeName=Be.storeName||Ge.storeName);var ot,Xe=this;if(Be.name){var $t=Be.name===Ge.name&&Xe._dbInfo.db?U.resolve(Xe._dbInfo.db):te(Be).then(function(gt){var Nt=q[Be.name],Ft=Nt.forages;Nt.db=gt;for(var et=0;et<Ft.length;et++)Ft[et]._dbInfo.db=gt;return gt});ot=$t.then(Be.storeName?function(gt){if(gt.objectStoreNames.contains(Be.storeName)){var Nt=gt.version+1;k(Be);var Ft=q[Be.name],et=Ft.forages;gt.close();for(var Kt=0;Kt<et.length;Kt++){var zt=et[Kt];zt._dbInfo.db=null,zt._dbInfo.version=Nt}return new U(function(ri,Ne){var ze=K.open(Be.name,Nt);ze.onerror=function(Ze){ze.result.close(),Ne(Ze)},ze.onupgradeneeded=function(){ze.result.deleteObjectStore(Be.storeName)},ze.onsuccess=function(){var Ze=ze.result;Ze.close(),ri(Ze)}}).then(function(ri){Ft.db=ri;for(var Ne=0;Ne<et.length;Ne++){var ze=et[Ne];ze._dbInfo.db=ri,v(ze._dbInfo)}}).catch(function(ri){throw(P(Be,ri)||U.resolve()).catch(function(){}),ri})}}:function(gt){k(Be);var Nt=q[Be.name],Ft=Nt.forages;gt.close();for(var et=0;et<Ft.length;et++)Ft[et]._dbInfo.db=null;return new U(function(en,ri){var Ne=K.deleteDatabase(Be.name);Ne.onerror=function(){var ze=Ne.result;ze&&ze.close(),ri(Ne.error)},Ne.onblocked=function(){console.warn('dropInstance blocked for database "'+Be.name+'" until all open connections are closed')},Ne.onsuccess=function(){var ze=Ne.result;ze&&ze.close(),en(ze)}}).then(function(en){Nt.db=en;for(var ri=0;ri<Ft.length;ri++)v(Ft[ri]._dbInfo)}).catch(function(en){throw(P(Be,en)||U.resolve()).catch(function(){}),en})})}else ot=U.reject("Invalid arguments");return N(ot,Ke),ot}};var he="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",be=/^~~local_forage_type~([^~]+)~/,ae="__lfsc__:",ue=ae.length,Ce="arbf",y="blob",W="si08",ln=ue+Ce.length,Jt=Object.prototype.toString;function Dn(Be){var Xe,Je,$t,gt,Nt,Ke=.75*Be.length,Ge=Be.length,ot=0;"="===Be[Be.length-1]&&(Ke--,"="===Be[Be.length-2]&&Ke--);var Ft=new ArrayBuffer(Ke),et=new Uint8Array(Ft);for(Xe=0;Xe<Ge;Xe+=4)Je=he.indexOf(Be[Xe]),$t=he.indexOf(Be[Xe+1]),gt=he.indexOf(Be[Xe+2]),Nt=he.indexOf(Be[Xe+3]),et[ot++]=Je<<2|$t>>4,et[ot++]=(15&$t)<<4|gt>>2,et[ot++]=(3&gt)<<6|63&Nt;return Ft}function Tn(Be){var Xe,Ke=new Uint8Array(Be),Ge="";for(Xe=0;Xe<Ke.length;Xe+=3)Ge+=he[Ke[Xe]>>2],Ge+=he[(3&Ke[Xe])<<4|Ke[Xe+1]>>4],Ge+=he[(15&Ke[Xe+1])<<2|Ke[Xe+2]>>6],Ge+=he[63&Ke[Xe+2]];return Ke.length%3==2?Ge=Ge.substring(0,Ge.length-1)+"=":Ke.length%3==1&&(Ge=Ge.substring(0,Ge.length-2)+"=="),Ge}var ja={serialize:function vr(Be,Ke){var Ge="";if(Be&&(Ge=Jt.call(Be)),Be&&("[object ArrayBuffer]"===Ge||Be.buffer&&"[object ArrayBuffer]"===Jt.call(Be.buffer))){var Xe,ot=ae;Be instanceof ArrayBuffer?(Xe=Be,ot+=Ce):(Xe=Be.buffer,"[object Int8Array]"===Ge?ot+=W:"[object Uint8Array]"===Ge?ot+="ui08":"[object Uint8ClampedArray]"===Ge?ot+="uic8":"[object Int16Array]"===Ge?ot+="si16":"[object Uint16Array]"===Ge?ot+="ur16":"[object Int32Array]"===Ge?ot+="si32":"[object Uint32Array]"===Ge?ot+="ui32":"[object Float32Array]"===Ge?ot+="fl32":"[object Float64Array]"===Ge?ot+="fl64":Ke(new Error("Failed to get type for BinaryArray"))),Ke(ot+Tn(Xe))}else if("[object Blob]"===Ge){var Je=new FileReader;Je.onload=function(){var $t="~~local_forage_type~"+Be.type+"~"+Tn(this.result);Ke(ae+y+$t)},Je.readAsArrayBuffer(Be)}else try{Ke(JSON.stringify(Be))}catch($t){console.error("Couldn't convert value into a JSON string: ",Be),Ke(null,$t)}},deserialize:function fa(Be){if(Be.substring(0,ue)!==ae)return JSON.parse(Be);var Xe,Ke=Be.substring(ln),Ge=Be.substring(ue,ln);if(Ge===y&&be.test(Ke)){var ot=Ke.match(be);Xe=ot[1],Ke=Ke.substring(ot[0].length)}var Je=Dn(Ke);switch(Ge){case Ce:return Je;case y:return A([Je],{type:Xe});case W:return new Int8Array(Je);case"ui08":return new Uint8Array(Je);case"uic8":return new Uint8ClampedArray(Je);case"si16":return new Int16Array(Je);case"ur16":return new Uint16Array(Je);case"si32":return new Int32Array(Je);case"ui32":return new Uint32Array(Je);case"fl32":return new Float32Array(Je);case"fl64":return new Float64Array(Je);default:throw new Error("Unkown type: "+Ge)}},stringToBuffer:Dn,bufferToString:Tn};function Ua(Be,Ke,Ge,Xe){Be.executeSql("CREATE TABLE IF NOT EXISTS "+Ke.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],Ge,Xe)}function or(Be,Ke,Ge,Xe,ot,Je){Be.executeSql(Ge,Xe,ot,function($t,gt){gt.code===gt.SYNTAX_ERR?$t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[Ke.storeName],function(Nt,Ft){Ft.rows.length?Je(Nt,gt):Ua(Nt,Ke,function(){Nt.executeSql(Ge,Xe,ot,Je)},Je)},Je):Je($t,gt)},Je)}function Ha(Be,Ke,Ge,Xe){var ot=this;Be=T(Be);var Je=new U(function($t,gt){ot.ready().then(function(){void 0===Ke&&(Ke=null);var Nt=Ke,Ft=ot._dbInfo;Ft.serializer.serialize(Ke,function(et,Kt){Kt?gt(Kt):Ft.db.transaction(function(zt){or(zt,Ft,"INSERT OR REPLACE INTO "+Ft.storeName+" (key, value) VALUES (?, ?)",[Be,et],function(){$t(Nt)},function(en,ri){gt(ri)})},function(zt){if(zt.code===zt.QUOTA_ERR){if(Xe>0)return void $t(Ha.apply(ot,[Be,Nt,Ge,Xe-1]));gt(zt)}})})}).catch(gt)});return N(Je,Ge),Je}function br(Be){return new U(function(Ke,Ge){Be.transaction(function(Xe){Xe.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(ot,Je){for(var $t=[],gt=0;gt<Je.rows.length;gt++)$t.push(Je.rows.item(gt).name);Ke({db:Be,storeNames:$t})},function(ot,Je){Ge(Je)})},function(Xe){Ge(Xe)})})}var Ga={_driver:"webSQLStorage",_initStorage:function wo(Be){var Ke=this,Ge={db:null};if(Be)for(var Xe in Be)Ge[Xe]="string"!=typeof Be[Xe]?Be[Xe].toString():Be[Xe];var ot=new U(function(Je,$t){try{Ge.db=openDatabase(Ge.name,String(Ge.version),Ge.description,Ge.size)}catch(gt){return $t(gt)}Ge.db.transaction(function(gt){Ua(gt,Ge,function(){Ke._dbInfo=Ge,Je()},function(Nt,Ft){$t(Ft)})},$t)});return Ge.serializer=ja,ot},_support:function ye(){return"function"==typeof openDatabase}(),iterate:function Ml(Be,Ke){var Ge=this,Xe=new U(function(ot,Je){Ge.ready().then(function(){var $t=Ge._dbInfo;$t.db.transaction(function(gt){or(gt,$t,"SELECT * FROM "+$t.storeName,[],function(Nt,Ft){for(var et=Ft.rows,Kt=et.length,zt=0;zt<Kt;zt++){var en=et.item(zt),ri=en.value;if(ri&&(ri=$t.serializer.deserialize(ri)),void 0!==(ri=Be(ri,en.key,zt+1)))return void ot(ri)}ot()},function(Nt,Ft){Je(Ft)})})}).catch(Je)});return N(Xe,Ke),Xe},getItem:function Ic(Be,Ke){var Ge=this;Be=T(Be);var Xe=new U(function(ot,Je){Ge.ready().then(function(){var $t=Ge._dbInfo;$t.db.transaction(function(gt){or(gt,$t,"SELECT * FROM "+$t.storeName+" WHERE key = ? LIMIT 1",[Be],function(Nt,Ft){var et=Ft.rows.length?Ft.rows.item(0).value:null;et&&(et=$t.serializer.deserialize(et)),ot(et)},function(Nt,Ft){Je(Ft)})})}).catch(Je)});return N(Xe,Ke),Xe},setItem:function Va(Be,Ke,Ge){return Ha.apply(this,[Be,Ke,Ge,1])},removeItem:function Qu(Be,Ke){var Ge=this;Be=T(Be);var Xe=new U(function(ot,Je){Ge.ready().then(function(){var $t=Ge._dbInfo;$t.db.transaction(function(gt){or(gt,$t,"DELETE FROM "+$t.storeName+" WHERE key = ?",[Be],function(){ot()},function(Nt,Ft){Je(Ft)})})}).catch(Je)});return N(Xe,Ke),Xe},clear:function Mc(Be){var Ke=this,Ge=new U(function(Xe,ot){Ke.ready().then(function(){var Je=Ke._dbInfo;Je.db.transaction(function($t){or($t,Je,"DELETE FROM "+Je.storeName,[],function(){Xe()},function(gt,Nt){ot(Nt)})})}).catch(ot)});return N(Ge,Be),Ge},length:function kc(Be){var Ke=this,Ge=new U(function(Xe,ot){Ke.ready().then(function(){var Je=Ke._dbInfo;Je.db.transaction(function($t){or($t,Je,"SELECT COUNT(key) as c FROM "+Je.storeName,[],function(gt,Nt){var Ft=Nt.rows.item(0).c;Xe(Ft)},function(gt,Nt){ot(Nt)})})}).catch(ot)});return N(Ge,Be),Ge},key:function kl(Be,Ke){var Ge=this,Xe=new U(function(ot,Je){Ge.ready().then(function(){var $t=Ge._dbInfo;$t.db.transaction(function(gt){or(gt,$t,"SELECT key FROM "+$t.storeName+" WHERE id = ? LIMIT 1",[Be+1],function(Nt,Ft){var et=Ft.rows.length?Ft.rows.item(0).key:null;ot(et)},function(Nt,Ft){Je(Ft)})})}).catch(Je)});return N(Xe,Ke),Xe},keys:function Dc(Be){var Ke=this,Ge=new U(function(Xe,ot){Ke.ready().then(function(){var Je=Ke._dbInfo;Je.db.transaction(function($t){or($t,Je,"SELECT key FROM "+Je.storeName,[],function(gt,Nt){for(var Ft=[],et=0;et<Nt.rows.length;et++)Ft.push(Nt.rows.item(et).key);Xe(Ft)},function(gt,Nt){ot(Nt)})})}).catch(ot)});return N(Ge,Be),Ge},dropInstance:function Ju(Be,Ke){Ke=j.apply(this,arguments);var Ge=this.config();(Be="function"!=typeof Be&&Be||{}).name||(Be.name=Be.name||Ge.name,Be.storeName=Be.storeName||Ge.storeName);var ot,Xe=this;return N(ot=Be.name?new U(function(Je){var $t;$t=Be.name===Ge.name?Xe._dbInfo.db:openDatabase(Be.name,"","",0),Je(Be.storeName?{db:$t,storeNames:[Be.storeName]}:br($t))}).then(function(Je){return new U(function($t,gt){Je.db.transaction(function(Nt){function Ft(en){return new U(function(ri,Ne){Nt.executeSql("DROP TABLE IF EXISTS "+en,[],function(){ri()},function(ze,Ze){Ne(Ze)})})}for(var et=[],Kt=0,zt=Je.storeNames.length;Kt<zt;Kt++)et.push(Ft(Je.storeNames[Kt]));U.all(et).then(function(){$t()}).catch(function(en){gt(en)})},function(Nt){gt(Nt)})})}):U.reject("Invalid arguments"),Ke),ot}};function Ac(Be,Ke){var Ge=Be.name+"/";return Be.storeName!==Ke.storeName&&(Ge+=Be.storeName+"/"),Ge}function Al(){return!function Dl(){var Be="_localforage_support_test";try{return localStorage.setItem(Be,!0),localStorage.removeItem(Be),!1}catch{return!0}}()||localStorage.length>0}var Wo={_driver:"localStorageWrapper",_initStorage:function td(Be){var Ge={};if(Be)for(var Xe in Be)Ge[Xe]=Be[Xe];return Ge.keyPrefix=Ac(Be,this._defaultConfig),Al()?(this._dbInfo=Ge,Ge.serializer=ja,U.resolve()):U.reject()},_support:function ed(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}(),iterate:function Ls(Be,Ke){var Ge=this,Xe=Ge.ready().then(function(){for(var ot=Ge._dbInfo,Je=ot.keyPrefix,$t=Je.length,gt=localStorage.length,Nt=1,Ft=0;Ft<gt;Ft++){var et=localStorage.key(Ft);if(0===et.indexOf(Je)){var Kt=localStorage.getItem(et);if(Kt&&(Kt=ot.serializer.deserialize(Kt)),void 0!==(Kt=Be(Kt,et.substring($t),Nt++)))return Kt}}});return N(Xe,Ke),Xe},getItem:function nd(Be,Ke){var Ge=this;Be=T(Be);var Xe=Ge.ready().then(function(){var ot=Ge._dbInfo,Je=localStorage.getItem(ot.keyPrefix+Be);return Je&&(Je=ot.serializer.deserialize(Je)),Je});return N(Xe,Ke),Xe},setItem:function qo(Be,Ke,Ge){var Xe=this;Be=T(Be);var ot=Xe.ready().then(function(){void 0===Ke&&(Ke=null);var Je=Ke;return new U(function($t,gt){var Nt=Xe._dbInfo;Nt.serializer.serialize(Ke,function(Ft,et){if(et)gt(et);else try{localStorage.setItem(Nt.keyPrefix+Be,Ft),$t(Je)}catch(Kt){("QuotaExceededError"===Kt.name||"NS_ERROR_DOM_QUOTA_REACHED"===Kt.name)&&gt(Kt),gt(Kt)}})})});return N(ot,Ge),ot},removeItem:function Nl(Be,Ke){var Ge=this;Be=T(Be);var Xe=Ge.ready().then(function(){localStorage.removeItem(Ge._dbInfo.keyPrefix+Be)});return N(Xe,Ke),Xe},clear:function uo(Be){var Ke=this,Ge=Ke.ready().then(function(){for(var Xe=Ke._dbInfo.keyPrefix,ot=localStorage.length-1;ot>=0;ot--){var Je=localStorage.key(ot);0===Je.indexOf(Xe)&&localStorage.removeItem(Je)}});return N(Ge,Be),Ge},length:function id(Be){var Ge=this.keys().then(function(Xe){return Xe.length});return N(Ge,Be),Ge},key:function Pl(Be,Ke){var Ge=this,Xe=Ge.ready().then(function(){var Je,ot=Ge._dbInfo;try{Je=localStorage.key(Be)}catch{Je=null}return Je&&(Je=Je.substring(ot.keyPrefix.length)),Je});return N(Xe,Ke),Xe},keys:function qa(Be){var Ke=this,Ge=Ke.ready().then(function(){for(var Xe=Ke._dbInfo,ot=localStorage.length,Je=[],$t=0;$t<ot;$t++){var gt=localStorage.key($t);0===gt.indexOf(Xe.keyPrefix)&&Je.push(gt.substring(Xe.keyPrefix.length))}return Je});return N(Ge,Be),Ge},dropInstance:function ms(Be,Ke){if(Ke=j.apply(this,arguments),!(Be="function"!=typeof Be&&Be||{}).name){var Ge=this.config();Be.name=Be.name||Ge.name,Be.storeName=Be.storeName||Ge.storeName}var ot,Xe=this;return N(ot=Be.name?new U(function(Je){Je(Be.storeName?Ac(Be,Xe._defaultConfig):Be.name+"/")}).then(function(Je){for(var $t=localStorage.length-1;$t>=0;$t--){var gt=localStorage.key($t);0===gt.indexOf(Je)&&localStorage.removeItem(gt)}}):U.reject("Invalid arguments"),Ke),ot}},Ko=function(Ke,Ge){return Ke===Ge||"number"==typeof Ke&&"number"==typeof Ge&&isNaN(Ke)&&isNaN(Ge)},Ol=function(Ke,Ge){for(var Xe=Ke.length,ot=0;ot<Xe;){if(Ko(Ke[ot],Ge))return!0;ot++}return!1},Fl=Array.isArray||function(Be){return"[object Array]"===Object.prototype.toString.call(Be)},Bs={},ha={},Wi={INDEXEDDB:$e,WEBSQL:Ga,LOCALSTORAGE:Wo},zs=[Wi.INDEXEDDB._driver,Wi.WEBSQL._driver,Wi.LOCALSTORAGE._driver],Yr=["dropInstance"],Ar=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Yr),pa={description:"",driver:zs.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function fo(Be,Ke){Be[Ke]=function(){var Ge=arguments;return Be.ready().then(function(){return Be[Ke].apply(Be,Ge)})}}function Qi(){for(var Be=1;Be<arguments.length;Be++){var Ke=arguments[Be];if(Ke)for(var Ge in Ke)Ke.hasOwnProperty(Ge)&&(arguments[0][Ge]=Fl(Ke[Ge])?Ke[Ge].slice():Ke[Ge])}return arguments[0]}var ga=function(){function Be(Ke){for(var Ge in function O(Be,Ke){if(!(Be instanceof Ke))throw new TypeError("Cannot call a class as a function")}(this,Be),Wi)if(Wi.hasOwnProperty(Ge)){var Xe=Wi[Ge],ot=Xe._driver;this[Ge]=ot,Bs[ot]||this.defineDriver(Xe)}this._defaultConfig=Qi({},pa),this._config=Qi({},this._defaultConfig,Ke),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return Be.prototype.config=function(Ge){if("object"===(typeof Ge>"u"?"undefined":w(Ge))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var Xe in Ge){if("storeName"===Xe&&(Ge[Xe]=Ge[Xe].replace(/\W/g,"_")),"version"===Xe&&"number"!=typeof Ge[Xe])return new Error("Database version must be a number.");this._config[Xe]=Ge[Xe]}return!("driver"in Ge)||!Ge.driver||this.setDriver(this._config.driver)}return"string"==typeof Ge?this._config[Ge]:this._config},Be.prototype.defineDriver=function(Ge,Xe,ot){var Je=new U(function($t,gt){try{var Nt=Ge._driver,Ft=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!Ge._driver)return void gt(Ft);for(var et=Ar.concat("_initStorage"),Kt=0,zt=et.length;Kt<zt;Kt++){var en=et[Kt];if((!Ol(Yr,en)||Ge[en])&&"function"!=typeof Ge[en])return void gt(Ft)}!function(){for(var ct=function(Ji){return function(){var yr=new Error("Method "+Ji+" is not implemented by the current driver"),ho=U.reject(yr);return N(ho,arguments[arguments.length-1]),ho}},Pt=0,qt=Yr.length;Pt<qt;Pt++){var Rn=Yr[Pt];Ge[Rn]||(Ge[Rn]=ct(Rn))}}();var ze=function(ct){Bs[Nt]&&console.info("Redefining LocalForage driver: "+Nt),Bs[Nt]=Ge,ha[Nt]=ct,$t()};"_support"in Ge?Ge._support&&"function"==typeof Ge._support?Ge._support().then(ze,gt):ze(!!Ge._support):ze(!0)}catch(Ze){gt(Ze)}});return Y(Je,Xe,ot),Je},Be.prototype.driver=function(){return this._driver||null},Be.prototype.getDriver=function(Ge,Xe,ot){var Je=Bs[Ge]?U.resolve(Bs[Ge]):U.reject(new Error("Driver not found."));return Y(Je,Xe,ot),Je},Be.prototype.getSerializer=function(Ge){var Xe=U.resolve(ja);return Y(Xe,Ge),Xe},Be.prototype.ready=function(Ge){var Xe=this,ot=Xe._driverSet.then(function(){return null===Xe._ready&&(Xe._ready=Xe._initDriver()),Xe._ready});return Y(ot,Ge,Ge),ot},Be.prototype.setDriver=function(Ge,Xe,ot){var Je=this;Fl(Ge)||(Ge=[Ge]);var $t=this._getSupportedDrivers(Ge);function gt(){Je._config.driver=Je.driver()}function Nt(Kt){return Je._extend(Kt),gt(),Je._ready=Je._initStorage(Je._config),Je._ready}var et=null!==this._driverSet?this._driverSet.catch(function(){return U.resolve()}):U.resolve();return this._driverSet=et.then(function(){var Kt=$t[0];return Je._dbInfo=null,Je._ready=null,Je.getDriver(Kt).then(function(zt){Je._driver=zt._driver,gt(),Je._wrapLibraryMethodsWithReady(),Je._initDriver=function Ft(Kt){return function(){var zt=0;return function en(){for(;zt<Kt.length;){var ri=Kt[zt];return zt++,Je._dbInfo=null,Je._ready=null,Je.getDriver(ri).then(Nt).catch(en)}gt();var Ne=new Error("No available storage method found.");return Je._driverSet=U.reject(Ne),Je._driverSet}()}}($t)})}).catch(function(){gt();var Kt=new Error("No available storage method found.");return Je._driverSet=U.reject(Kt),Je._driverSet}),Y(this._driverSet,Xe,ot),this._driverSet},Be.prototype.supports=function(Ge){return!!ha[Ge]},Be.prototype._extend=function(Ge){Qi(this,Ge)},Be.prototype._getSupportedDrivers=function(Ge){for(var Xe=[],ot=0,Je=Ge.length;ot<Je;ot++){var $t=Ge[ot];this.supports($t)&&Xe.push($t)}return Xe},Be.prototype._wrapLibraryMethodsWithReady=function(){for(var Ge=0,Xe=Ar.length;Ge<Xe;Ge++)fo(this,Ar[Ge])},Be.prototype.createInstance=function(Ge){return new Be(Ge)},Be}(),Pc=new ga;J.exports=Pc},{3:3}]},{},[4])(4)},9263:(E,le,_e)=>{var d=_e(9209),H=_e(966);function J(_){this._init(_)}J.prototype={_init:function(_){_=_||{},this._data=null,this._table=null,this._result=null,this._onDataCallback=_.onData,this._onEndCallback=_.onEnd},_createTable:function(){for(var _=H.createBuffer(8,d.TABLE_LENGTH),w=0;w<d.TABLE_LENGTH;w++)_[w]=d.BASE62TABLE.charCodeAt(w);return _},_onData:function(_,w){var O=H.bufferToString_fast(_,w);this._onDataCallback?this._onDataCallback(O):this._result+=O},_onEnd:function(){this._onEndCallback&&this._onEndCallback(),this._data=this._table=null},_search:function(){var _=2,w=this._data,O=this._offset,x=d.BUFFER_MAX;if(this._dataLen-O<x&&(x=this._dataLen-O),_>x)return!1;var U,N,Y,T,j,K=O-d.WINDOW_BUFFER_MAX,V=w.substring(K,O+x),A=O+_-3-K;do{if(2===_){if(N=w.charAt(O)+w.charAt(O+1),!~(Y=V.indexOf(N))||Y>A)break}else 3===_?N+=w.charAt(O+2):N=w.substr(O,_);if(!~(T=d.STRING_LASTINDEXOF_BUG?w.substring(K,O+_-1).lastIndexOf(N):V.lastIndexOf(N,A)))break;j=T,U=K+T;do{if(w.charCodeAt(O+_)!==w.charCodeAt(U+_))break}while(++_<x);if(Y===T){_++;break}}while(++_<x);return 2!==_&&(this._index=d.WINDOW_BUFFER_MAX-j,this._length=_-1,!0)},compress:function(_){if(null==_||0===_.length)return"";var w,O=this._createTable(),x=H.createWindow(),K=H.createBuffer(8,d.COMPRESS_CHUNK_SIZE),V=0;this._result="",this._offset=x.length,this._data=x+_,this._dataLen=this._data.length,x=_=null;for(var N,Y,T,j,re,A=-1,U=-1;this._offset<this._dataLen;)this._search()?(this._index<d.BUFFER_MAX?(Y=this._index,T=0):T=(this._index-(Y=this._index%d.BUFFER_MAX))/d.BUFFER_MAX,2===this._length?(K[V++]=O[T+d.COMPRESS_FIXED_START],K[V++]=O[Y]):(K[V++]=O[T+d.COMPRESS_START],K[V++]=O[Y],K[V++]=O[this._length]),this._offset+=this._length,~U&&(U=-1)):(N=this._data.charCodeAt(this._offset++))<d.LATIN_BUFFER_MAX?(N<d.UNICODE_CHAR_MAX?(Y=N,T=0,A=d.LATIN_INDEX):A=(T=(N-(Y=N%d.UNICODE_CHAR_MAX))/d.UNICODE_CHAR_MAX)+d.LATIN_INDEX,U===A?K[V++]=O[Y]:(K[V++]=O[A-d.LATIN_INDEX_START],K[V++]=O[Y],U=A)):(N<d.UNICODE_BUFFER_MAX?(Y=N,T=0,A=d.UNICODE_INDEX):A=(T=(N-(Y=N%d.UNICODE_BUFFER_MAX))/d.UNICODE_BUFFER_MAX)+d.UNICODE_INDEX,Y<d.UNICODE_CHAR_MAX?(j=Y,re=0):re=(Y-(j=Y%d.UNICODE_CHAR_MAX))/d.UNICODE_CHAR_MAX,U===A?(K[V++]=O[j],K[V++]=O[re]):(K[V++]=O[d.CHAR_START],K[V++]=O[A-d.TABLE_LENGTH],K[V++]=O[j],K[V++]=O[re],U=A)),V>=d.COMPRESS_CHUNK_MAX&&(this._onData(K,V),V=0);return V>0&&this._onData(K,V),this._onEnd(),w=this._result,this._result=null,null===w?"":w}},E.exports=J},9209:(E,le)=>{var _e=le.HAS_TYPED=typeof Uint8Array<"u"&&typeof Uint16Array<"u",d=!1,H=!1;try{"a"===String.fromCharCode.apply(null,[97])&&(d=!0)}catch{}if(_e)try{"a"===String.fromCharCode.apply(null,new Uint8Array([97]))&&(H=!0)}catch{}le.CAN_CHARCODE_APPLY=d,le.CAN_CHARCODE_APPLY_TYPED=H;var J=le.APPLY_BUFFER_SIZE=65533;le.APPLY_BUFFER_SIZE_OK=null;var _=!1;-1!=="abc\u307b\u3052".lastIndexOf("\u307b\u3052",1)&&(_=!0),le.STRING_LASTINDEXOF_BUG=_;var w=le.BASE62TABLE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",O=le.TABLE_LENGTH=w.length,x=Math.max(O,62)-Math.min(O,62);le.BUFFER_MAX=O-1;var K=le.WINDOW_MAX=1024;le.WINDOW_BUFFER_MAX=304;var V=le.COMPRESS_CHUNK_SIZE=J;le.COMPRESS_CHUNK_MAX=V-O;var A=le.DECOMPRESS_CHUNK_SIZE=J;le.DECOMPRESS_CHUNK_MAX=A+2*K,le.LATIN_BUFFER_MAX=132;var N=le.UNICODE_CHAR_MAX=40;le.UNICODE_BUFFER_MAX=N*(N+1),le.LATIN_INDEX=O+1,le.LATIN_INDEX_START=x+20,le.UNICODE_INDEX=O+5,le.DECODE_MAX=O-x-19;var Y=le.LATIN_DECODE_MAX=N+7,T=le.CHAR_START=Y+1,j=le.COMPRESS_START=T+1,re=le.COMPRESS_FIXED_START=j+5;le.COMPRESS_INDEX=re+5},9727:(E,le,_e)=>{var d=_e(9209),H=_e(966);function J(_){this._init(_)}J.prototype={_init:function(_){_=_||{},this._result=null,this._onDataCallback=_.onData,this._onEndCallback=_.onEnd},_createTable:function(){for(var _={},w=0;w<d.TABLE_LENGTH;w++)_[d.BASE62TABLE.charAt(w)]=w;return _},_onData:function(_){var w;if(this._onDataCallback){if(_)w=this._result,this._result=[];else{var O=d.DECOMPRESS_CHUNK_SIZE-d.WINDOW_MAX;w=this._result.slice(d.WINDOW_MAX,d.WINDOW_MAX+O),this._result=this._result.slice(0,d.WINDOW_MAX).concat(this._result.slice(d.WINDOW_MAX+O))}w.length>0&&this._onDataCallback(H.bufferToString_fast(w))}},_onEnd:function(){this._onEndCallback&&this._onEndCallback()},decompress:function(_){if(null==_||0===_.length)return"";this._result=H.stringToArray(H.createWindow());for(var w,U,N,Y,j,re,z,q,Z,M,O=this._createTable(),x=!1,K=null,V=_.length,A=0;A<V;A++)if(void 0!==(N=O[_.charAt(A)])){if(N<d.DECODE_MAX)j=x?O[_.charAt(++A)]*d.UNICODE_CHAR_MAX+N+d.UNICODE_BUFFER_MAX*K:K*d.UNICODE_CHAR_MAX+N,this._result[this._result.length]=j;else if(N<d.LATIN_DECODE_MAX)K=N-d.DECODE_MAX,x=!1;else if(N===d.CHAR_START)K=(Y=O[_.charAt(++A)])-5,x=!0;else if(N<d.COMPRESS_INDEX){if(Y=O[_.charAt(++A)],N<d.COMPRESS_FIXED_START?(re=(N-d.COMPRESS_START)*d.BUFFER_MAX+Y,z=O[_.charAt(++A)]):(re=(N-d.COMPRESS_FIXED_START)*d.BUFFER_MAX+Y,z=2),(q=this._result.slice(-re)).length>z&&(q.length=z),Z=q.length,q.length>0)for(M=0;M<z;)for(U=0;U<Z&&(this._result[this._result.length]=q[U],!(++M>=z));U++);K=null}this._result.length>=d.DECOMPRESS_CHUNK_MAX&&this._onData()}return this._result=this._result.slice(d.WINDOW_MAX),this._onData(!0),this._onEnd(),w=H.bufferToString_fast(this._result),this._result=null,w}},E.exports=J},8497:(E,le,_e)=>{var d=_e(9263),H=_e(9727);_e(1014),le.n=function(J,_){return new d(_).compress(J)},le.L=function(J,_){return new H(_).decompress(J)}},966:(E,le,_e)=>{var d=_e(9209),H=String.fromCharCode;le.createBuffer=function(O,x){if(!d.HAS_TYPED)return new Array(x);switch(O){case 8:return new Uint8Array(x);case 16:return new Uint16Array(x)}};var J=le.truncateBuffer=function(O,x){return O.length===x?O:O.subarray?O.subarray(0,x):(O.length=x,O)};le.bufferToString_fast=function(O,x){if(null==x?x=O.length:O=J(O,x),d.CAN_CHARCODE_APPLY&&d.CAN_CHARCODE_APPLY_TYPED){var K=O.length;if(K<d.APPLY_BUFFER_SIZE&&d.APPLY_BUFFER_SIZE_OK)return H.apply(null,O);if(null===d.APPLY_BUFFER_SIZE_OK)try{var V=H.apply(null,O);return K>d.APPLY_BUFFER_SIZE&&(d.APPLY_BUFFER_SIZE_OK=!0),V}catch{d.APPLY_BUFFER_SIZE_OK=!1}}return _(O)};var _=le.bufferToString_chunked=function(O){for(var A,x="",K=O.length,V=0;V<K;){if(A=O.subarray?O.subarray(V,V+d.APPLY_BUFFER_SIZE):O.slice(V,V+d.APPLY_BUFFER_SIZE),V+=d.APPLY_BUFFER_SIZE,!d.APPLY_BUFFER_SIZE_OK){if(null===d.APPLY_BUFFER_SIZE_OK)try{x+=H.apply(null,A),A.length>d.APPLY_BUFFER_SIZE&&(d.APPLY_BUFFER_SIZE_OK=!0);continue}catch{d.APPLY_BUFFER_SIZE_OK=!1}return w(O)}x+=H.apply(null,A)}return x},w=le.bufferToString_slow=function(O){for(var x="",K=O.length,V=0;V<K;V++)x+=H(O[V]);return x};le.stringToArray=function(O){for(var x=[],K=O&&O.length,V=0;V<K;V++)x[V]=O.charCodeAt(V);return x},le.createWindow=function(){for(var O=d.WINDOW_MAX>>7,x="        ";!(O&d.WINDOW_MAX);)x+=x,O<<=1;return x}},2391:(E,le,_e)=>{le.encode=_e(8048).encode,le.decode=_e(9175).decode,_e(7704),_e(8131),_e(1490),_e(9234)},2295:function(E){function le(_e){return _e&&_e.isBuffer&&_e}E.exports=le(typeof Buffer<"u"&&Buffer)||le(this.Buffer)||le(typeof window<"u"&&window.Buffer)||this.Buffer},7625:(E,le)=>{le.copy=function J(_,w,O,x){var K;O||(O=0),!x&&0!==x&&(x=this.length),w||(w=0);var V=x-O;if(_===this&&O<w&&w<x)for(K=V-1;K>=0;K--)_[K+w]=this[K+O];else for(K=0;K<V;K++)_[K+w]=this[K+O];return V},le.toString=function H(_,w,O){var x=this,K=0|w;O||(O=x.length);for(var V="",A=0;K<O;)(A=x[K++])<128?V+=String.fromCharCode(A):(192==(224&A)?A=(31&A)<<6|63&x[K++]:224==(240&A)?A=(15&A)<<12|(63&x[K++])<<6|63&x[K++]:240==(248&A)&&(A=(7&A)<<18|(63&x[K++])<<12|(63&x[K++])<<6|63&x[K++]),A>=65536?(A-=65536,V+=String.fromCharCode(55296+(A>>>10),56320+(1023&A))):V+=String.fromCharCode(A));return V},le.write=function d(_,w){for(var O=this,x=w||(w|=0),K=_.length,V=0,A=0;A<K;)(V=_.charCodeAt(A++))<128?O[x++]=V:V<2048?(O[x++]=192|V>>>6,O[x++]=128|63&V):V<55296||V>57343?(O[x++]=224|V>>>12,O[x++]=128|V>>>6&63,O[x++]=128|63&V):(V=65536+(V-55296<<10|_.charCodeAt(A++)-56320),O[x++]=240|V>>>18,O[x++]=128|V>>>12&63,O[x++]=128|V>>>6&63,O[x++]=128|63&V);return x-w}},1864:(E,le,_e)=>{var d=_e(6093),H=E.exports=J(0);function J(w){return new Array(w)}H.alloc=J,H.concat=d.concat,H.from=function _(w){if(!d.isBuffer(w)&&d.isView(w))w=d.Uint8Array.from(w);else if(d.isArrayBuffer(w))w=new Uint8Array(w);else{if("string"==typeof w)return d.from.call(H,w);if("number"==typeof w)throw new TypeError('"value" argument must not be a number')}return Array.prototype.slice.call(w)}},1884:(E,le,_e)=>{var d=_e(6093),H=d.global,J=E.exports=d.hasBuffer?_(0):[];function _(O){return new H(O)}J.alloc=d.hasBuffer&&H.alloc||_,J.concat=d.concat,J.from=function w(O){if(!d.isBuffer(O)&&d.isView(O))O=d.Uint8Array.from(O);else if(d.isArrayBuffer(O))O=new Uint8Array(O);else{if("string"==typeof O)return d.from.call(J,O);if("number"==typeof O)throw new TypeError('"value" argument must not be a number')}return H.from&&1!==H.from.length?H.from(O):new H(O)}},5364:(E,le,_e)=>{var d=_e(7625);le.copy=O,le.slice=x,le.toString=function K(A,U,N){var Y=!_&&H.isBuffer(this)?this.toString:d.toString;return Y.apply(this,arguments)},le.write=function V(A){return function U(){return(this[A]||d[A]).apply(this,arguments)}}("write");var H=_e(6093),J=H.global,_=H.hasBuffer&&"TYPED_ARRAY_SUPPORT"in J,w=_&&!J.TYPED_ARRAY_SUPPORT;function O(A,U,N,Y){var T=H.isBuffer(this),j=H.isBuffer(A);if(T&&j)return this.copy(A,U,N,Y);if(w||T||j||!H.isView(this)||!H.isView(A))return d.copy.call(this,A,U,N,Y);var re=N||null!=Y?x.call(this,N,Y):this;return A.set(re,U),re.length}function x(A,U){var N=this.slice||!w&&this.subarray;if(N)return N.call(this,A,U);var Y=H.alloc.call(this,U-A);return O.call(this,Y,0,A,U),Y}},5321:(E,le,_e)=>{var d=_e(6093),H=E.exports=d.hasArrayBuffer?J(0):[];function J(w){return new Uint8Array(w)}H.alloc=J,H.concat=d.concat,H.from=function _(w){if(d.isView(w)){var O=w.byteOffset,x=w.byteLength;(w=w.buffer).byteLength!==x&&(w.slice?w=w.slice(O,O+x):(w=new Uint8Array(w)).byteLength!==x&&(w=Array.prototype.slice.call(w,O,O+x)))}else{if("string"==typeof w)return d.from.call(H,w);if("number"==typeof w)throw new TypeError('"value" argument must not be a number')}return new Uint8Array(w)}},6093:(E,le,_e)=>{var d=le.global=_e(2295),H=le.hasBuffer=d&&!!d.isBuffer,J=le.hasArrayBuffer=typeof ArrayBuffer<"u",_=le.isArray=_e(6425);le.isArrayBuffer=J?function j(M){return M instanceof ArrayBuffer||T(M)}:q;var w=le.isBuffer=H?d.isBuffer:q,O=le.isView=J?ArrayBuffer.isView||Z("ArrayBuffer","buffer"):q;le.alloc=N,le.concat=function Y(M,I){I||(I=0,Array.prototype.forEach.call(M,function k(P){I+=P.length}));var L=N.call(this!==le&&this||M[0],I),S=0;return Array.prototype.forEach.call(M,function v(P){S+=A.copy.call(P,L,S)}),L},le.from=function U(M){return"string"==typeof M?re.call(this,M):z(this).from(M)};var x=le.Array=_e(1864),K=le.Buffer=_e(1884),V=le.Uint8Array=_e(5321),A=le.prototype=_e(5364);function N(M){return z(this).alloc(M)}var T=Z("ArrayBuffer");function re(M){var I=3*M.length,X=N.call(this,I),L=A.write.call(X,M);return I!==L&&(X=A.slice.call(X,0,L)),X}function z(M){return w(M)?K:O(M)?V:_(M)?x:H?K:J?V:x}function q(){return!1}function Z(M,I){return M="[object "+M+"]",function(X){return null!=X&&{}.toString.call(I?X[I]:X)===M}}},5166:(E,le,_e)=>{var d=_e(6425);le.createCodec=K,le.install=function _(V){for(var A in V)J.prototype[A]=w(J.prototype[A],V[A])},le.filter=function x(V){return d(V)?function O(V){return V=V.slice(),function(U){return V.reduce(A,U)};function A(U,N){return N(U)}}(V):V};var H=_e(6093);function J(V){if(!(this instanceof J))return new J(V);this.options=V,this.init()}function w(V,A){return V&&A?function U(){return V.apply(this,arguments),A.apply(this,arguments)}:V||A}function K(V){return new J(V)}J.prototype.init=function(){var V=this.options;return V&&V.uint8array&&(this.bufferish=H.Uint8Array),this},le.preset=K({preset:!0})},9234:(E,le,_e)=>{_e(8334),_e(2732),_e(5166)},5333:(E,le,_e)=>{le.T=J;var d=_e(8334).preset;function J(_){if(!(this instanceof J))return new J(_);if(_&&(this.options=_,_.codec)){var w=this.codec=_.codec;w.bufferish&&(this.bufferish=w.bufferish)}}_e(6473).k.mixin(J.prototype),J.prototype.codec=d,J.prototype.fetch=function(){return this.codec.decode(this)}},9175:(E,le,_e)=>{le.decode=function H(J,_){var w=new d(_);return w.write(J),w.read()};var d=_e(5333).T},8131:(E,le,_e)=>{var H=_e(6654),J=_e(5333).T;function _(w){if(!(this instanceof _))return new _(w);J.call(this,w)}_.prototype=new J,H.mixin(_.prototype),_.prototype.decode=function(w){arguments.length&&this.write(w),this.flush()},_.prototype.push=function(w){this.emit("data",w)},_.prototype.end=function(w){this.decode(w),this.emit("end")}},8400:(E,le,_e)=>{le.F=J;var d=_e(2732).preset;function J(_){if(!(this instanceof J))return new J(_);if(_&&(this.options=_,_.codec)){var w=this.codec=_.codec;w.bufferish&&(this.bufferish=w.bufferish)}}_e(6473).I.mixin(J.prototype),J.prototype.codec=d,J.prototype.write=function(_){this.codec.encode(this,_)}},8048:(E,le,_e)=>{le.encode=function H(J,_){var w=new d(_);return w.write(J),w.read()};var d=_e(8400).F},7704:(E,le,_e)=>{var H=_e(6654),J=_e(8400).F;function _(w){if(!(this instanceof _))return new _(w);J.call(this,w)}_.prototype=new J,H.mixin(_.prototype),_.prototype.encode=function(w){this.write(w),this.emit("data",this.read())},_.prototype.end=function(w){arguments.length&&this.encode(w),this.flush(),this.emit("end")}},7846:(E,le,_e)=>{le.S=function H(J,_){if(!(this instanceof H))return new H(J,_);this.buffer=d.from(J),this.type=_};var d=_e(6093)},4106:(E,le,_e)=>{le.setExtPackers=function O(U){U.addExtPacker(14,Error,[A,x]),U.addExtPacker(1,EvalError,[A,x]),U.addExtPacker(2,RangeError,[A,x]),U.addExtPacker(3,ReferenceError,[A,x]),U.addExtPacker(4,SyntaxError,[A,x]),U.addExtPacker(5,TypeError,[A,x]),U.addExtPacker(6,URIError,[A,x]),U.addExtPacker(10,RegExp,[V,x]),U.addExtPacker(11,Boolean,[K,x]),U.addExtPacker(12,String,[K,x]),U.addExtPacker(13,Date,[Number,x]),U.addExtPacker(15,Number,[K,x]),typeof Uint8Array<"u"&&(U.addExtPacker(17,Int8Array,J),U.addExtPacker(18,Uint8Array,J),U.addExtPacker(19,Int16Array,J),U.addExtPacker(20,Uint16Array,J),U.addExtPacker(21,Int32Array,J),U.addExtPacker(22,Uint32Array,J),U.addExtPacker(23,Float32Array,J),typeof Float64Array<"u"&&U.addExtPacker(24,Float64Array,J),typeof Uint8ClampedArray<"u"&&U.addExtPacker(25,Uint8ClampedArray,J),U.addExtPacker(26,ArrayBuffer,J),U.addExtPacker(29,DataView,J)),d.hasBuffer&&U.addExtPacker(27,H,d.from)};var _,d=_e(6093),H=d.global,J=d.Uint8Array.from,w={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function x(U){return _||(_=_e(8048).encode),_(U)}function K(U){return U.valueOf()}function V(U){(U=RegExp.prototype.toString.call(U).split("/")).shift();var N=[U.pop()];return N.unshift(U.join("/")),N}function A(U){var N={};for(var Y in w)N[Y]=U[Y];return N}},9146:(E,le,_e)=>{le.setExtUnpackers=function w(U){U.addExtUnpacker(14,[O,K(Error)]),U.addExtUnpacker(1,[O,K(EvalError)]),U.addExtUnpacker(2,[O,K(RangeError)]),U.addExtUnpacker(3,[O,K(ReferenceError)]),U.addExtUnpacker(4,[O,K(SyntaxError)]),U.addExtUnpacker(5,[O,K(TypeError)]),U.addExtUnpacker(6,[O,K(URIError)]),U.addExtUnpacker(10,[O,x]),U.addExtUnpacker(11,[O,V(Boolean)]),U.addExtUnpacker(12,[O,V(String)]),U.addExtUnpacker(13,[O,V(Date)]),U.addExtUnpacker(15,[O,V(Number)]),typeof Uint8Array<"u"&&(U.addExtUnpacker(17,V(Int8Array)),U.addExtUnpacker(18,V(Uint8Array)),U.addExtUnpacker(19,[A,V(Int16Array)]),U.addExtUnpacker(20,[A,V(Uint16Array)]),U.addExtUnpacker(21,[A,V(Int32Array)]),U.addExtUnpacker(22,[A,V(Uint32Array)]),U.addExtUnpacker(23,[A,V(Float32Array)]),typeof Float64Array<"u"&&U.addExtUnpacker(24,[A,V(Float64Array)]),typeof Uint8ClampedArray<"u"&&U.addExtUnpacker(25,V(Uint8ClampedArray)),U.addExtUnpacker(26,A),U.addExtUnpacker(29,[A,V(DataView)])),d.hasBuffer&&U.addExtUnpacker(27,V(H))};var J,d=_e(6093),H=d.global,_={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function O(U){return J||(J=_e(9175).decode),J(U)}function x(U){return RegExp.apply(null,U)}function K(U){return function(N){var Y=new U;for(var T in _)Y[T]=N[T];return Y}}function V(U){return function(N){return new U(N)}}function A(U){return new Uint8Array(U).buffer}},1490:(E,le,_e)=>{_e(8334),_e(2732),_e(5166)},6473:(E,le,_e)=>{le.k=w,le.I=O;var d=_e(6093),_="BUFFER_SHORTAGE";function w(){if(!(this instanceof w))return new w}function O(){if(!(this instanceof O))return new O}function V(){throw new Error("method not implemented: write()")}function A(){throw new Error("method not implemented: fetch()")}function U(){return this.buffers&&this.buffers.length?(this.flush(),this.pull()):this.fetch()}function N(j){(this.buffers||(this.buffers=[])).push(j)}function Y(){return(this.buffers||(this.buffers=[])).shift()}function T(j){return function re(z){for(var q in j)z[q]=j[q];return z}}w.mixin=T(function x(){return{bufferish:d,write:function j(q){var Z=this.offset?d.prototype.slice.call(this.buffer,this.offset):this.buffer;this.buffer=Z?q?this.bufferish.concat([Z,q]):Z:q,this.offset=0},fetch:A,flush:function re(){for(;this.offset<this.buffer.length;){var Z,q=this.offset;try{Z=this.fetch()}catch(M){if(M&&M.message!=_)throw M;this.offset=q;break}this.push(Z)}},push:N,pull:Y,read:U,reserve:function z(q){var Z=this.offset,M=Z+q;if(M>this.buffer.length)throw new Error(_);return this.offset=M,Z},offset:0}}()),w.mixin(w.prototype),O.mixin=T(function K(){return{bufferish:d,write:V,fetch:function j(){var M=this.start;if(M<this.offset){var I=this.start=this.offset;return d.prototype.slice.call(this.buffer,M,I)}},flush:function re(){for(;this.start<this.offset;){var M=this.fetch();M&&this.push(M)}},push:N,pull:function z(){var M=this.buffers||(this.buffers=[]),I=M.length>1?this.bufferish.concat(M):M[0];return M.length=0,I},read:U,reserve:function q(M){var I=0|M;if(this.buffer){var X=this.buffer.length,L=0|this.offset,S=L+I;if(S<X)return this.offset=S,L;this.flush(),M=Math.max(M,Math.min(2*X,this.maxBufferSize))}return M=Math.max(M,this.minBufferSize),this.buffer=this.bufferish.alloc(M),this.start=0,this.offset=I,0},send:function Z(M){var I=M.length;if(I>this.minBufferSize)this.flush(),this.push(M);else{var X=this.reserve(I);d.prototype.copy.call(M,this.buffer,X)}},maxBufferSize:65536,minBufferSize:2048,offset:0,start:0}}()),O.mixin(O.prototype)},8334:(E,le,_e)=>{var d=_e(7846).S,H=_e(9146),J=_e(4613).readUint8,_=_e(1788),w=_e(5166);function x(){var A=this.options;return this.decode=function O(A){var U=_.getReadToken(A);return function N(Y){var T=J(Y),j=U[T];if(!j)throw new Error("Invalid type: "+(T&&"0x"+T.toString(16)));return j(Y)}}(A),A&&A.preset&&H.setExtUnpackers(this),this}w.install({addExtUnpacker:function K(A,U){(this.extUnpackers||(this.extUnpackers=[]))[A]=w.filter(U)},getExtUnpacker:function V(A){return(this.extUnpackers||(this.extUnpackers=[]))[A]||function N(Y){return new d(Y,A)}},init:x}),le.preset=x.call(w.preset)},4613:(E,le,_e)=>{var d=_e(8461),H=_e(6256),J=H.Uint64BE,_=H.Int64BE;le.getReadFormat=function V(D){var R=D&&D.int64;return{map:x&&D&&D.usemap?U:A,array:N,str:Y,bin:w.hasArrayBuffer&&D&&D.binarraybuffer?j:T,ext:re,uint8:z,uint16:Z,uint32:I,uint64:L(8,R?v:S),int8:q,int16:M,int32:X,int64:L(8,R?P:k),float32:L(4,B),float64:L(8,te)}},le.readUint8=z;var w=_e(6093),O=_e(5364),x=typeof Map<"u";function A(D,fe){var F,R={},g=new Array(fe),l=new Array(fe),c=D.codec.decode;for(F=0;F<fe;F++)g[F]=c(D),l[F]=c(D);for(F=0;F<fe;F++)R[g[F]]=l[F];return R}function U(D,fe){var F,R=new Map,g=new Array(fe),l=new Array(fe),c=D.codec.decode;for(F=0;F<fe;F++)g[F]=c(D),l[F]=c(D);for(F=0;F<fe;F++)R.set(g[F],l[F]);return R}function N(D,fe){for(var R=new Array(fe),F=D.codec.decode,g=0;g<fe;g++)R[g]=F(D);return R}function Y(D,fe){var R=D.reserve(fe);return O.toString.call(D.buffer,"utf-8",R,R+fe)}function T(D,fe){var R=D.reserve(fe),g=O.slice.call(D.buffer,R,R+fe);return w.from(g)}function j(D,fe){var R=D.reserve(fe),g=O.slice.call(D.buffer,R,R+fe);return w.Uint8Array.from(g).buffer}function re(D,fe){var R=D.reserve(fe+1),F=D.buffer[R++],g=R+fe,l=D.codec.getExtUnpacker(F);if(!l)throw new Error("Invalid ext type: "+(F&&"0x"+F.toString(16)));return l(O.slice.call(D.buffer,R,g))}function z(D){var fe=D.reserve(1);return D.buffer[fe]}function q(D){var fe=D.reserve(1),R=D.buffer[fe];return 128&R?R-256:R}function Z(D){var fe=D.reserve(2),R=D.buffer;return R[fe++]<<8|R[fe]}function M(D){var fe=D.reserve(2),R=D.buffer,F=R[fe++]<<8|R[fe];return 32768&F?F-65536:F}function I(D){var fe=D.reserve(4),R=D.buffer;return 16777216*R[fe++]+(R[fe++]<<16)+(R[fe++]<<8)+R[fe]}function X(D){var fe=D.reserve(4),R=D.buffer;return R[fe++]<<24|R[fe++]<<16|R[fe++]<<8|R[fe]}function L(D,fe){return function(R){var F=R.reserve(D);return fe.call(R.buffer,F,!0)}}function S(D){return new J(this,D).toNumber()}function k(D){return new _(this,D).toNumber()}function v(D){return new J(this,D)}function P(D){return new _(this,D)}function B(D){return d.read(this,D,!1,23,4)}function te(D){return d.read(this,D,!1,52,8)}},1788:(E,le,_e)=>{var d=_e(4613);function J(K){var V,A=new Array(256);for(V=0;V<=127;V++)A[V]=w(V);for(V=128;V<=143;V++)A[V]=x(V-128,K.map);for(V=144;V<=159;V++)A[V]=x(V-144,K.array);for(V=160;V<=191;V++)A[V]=x(V-160,K.str);for(A[192]=w(null),A[193]=null,A[194]=w(!1),A[195]=w(!0),A[196]=O(K.uint8,K.bin),A[197]=O(K.uint16,K.bin),A[198]=O(K.uint32,K.bin),A[199]=O(K.uint8,K.ext),A[200]=O(K.uint16,K.ext),A[201]=O(K.uint32,K.ext),A[202]=K.float32,A[203]=K.float64,A[204]=K.uint8,A[205]=K.uint16,A[206]=K.uint32,A[207]=K.uint64,A[208]=K.int8,A[209]=K.int16,A[210]=K.int32,A[211]=K.int64,A[212]=x(1,K.ext),A[213]=x(2,K.ext),A[214]=x(4,K.ext),A[215]=x(8,K.ext),A[216]=x(16,K.ext),A[217]=O(K.uint8,K.str),A[218]=O(K.uint16,K.str),A[219]=O(K.uint32,K.str),A[220]=O(K.uint16,K.array),A[221]=O(K.uint32,K.array),A[222]=O(K.uint16,K.map),A[223]=O(K.uint32,K.map),V=224;V<=255;V++)A[V]=w(V-256);return A}function w(K){return function(){return K}}function O(K,V){return function(A){var U=K(A);return V(A,U)}}function x(K,V){return function(A){return V(A,K)}}le.getReadToken=function H(K){var V=d.getReadFormat(K);return K&&K.useraw?function _(K){var V,A=J(K).slice();for(A[217]=A[196],A[218]=A[197],A[219]=A[198],V=160;V<=191;V++)A[V]=x(V-160,K.bin);return A}(V):J(V)}},2732:(E,le,_e)=>{var d=_e(7846).S,H=_e(4106),J=_e(9118),_=_e(5166);function O(){var V=this.options;return this.encode=function w(V){var A=J.getWriteType(V);return function U(N,Y){var T=A[typeof Y];if(!T)throw new Error('Unsupported type "'+typeof Y+'": '+Y);T(N,Y)}}(V),V&&V.preset&&H.setExtPackers(this),this}_.install({addExtPacker:function x(V,A,U){U=_.filter(U);var N=A.name;function j(re){return U&&(re=U(re)),new d(re,V)}N&&"Object"!==N?(this.extPackers||(this.extPackers={}))[N]=j:(this.extEncoderList||(this.extEncoderList=[])).unshift([A,j])},getExtPacker:function K(V){var A=this.extPackers||(this.extPackers={}),U=V.constructor,N=U&&U.name&&A[U.name];if(N)return N;for(var Y=this.extEncoderList||(this.extEncoderList=[]),T=Y.length,j=0;j<T;j++){var re=Y[j];if(U===re[0])return re[1]}},init:O}),le.preset=O.call(_.preset)},3041:(E,le,_e)=>{var d=_e(8461),H=_e(6256),J=H.Uint64BE,_=H.Int64BE,w=_e(8323).w,O=_e(6093),x=O.global,V=O.hasBuffer&&"TYPED_ARRAY_SUPPORT"in x&&!x.TYPED_ARRAY_SUPPORT,A=O.hasBuffer&&x.prototype||{};function Y(){var L=w.slice();return L[196]=j(196),L[197]=re(197),L[198]=z(198),L[199]=j(199),L[200]=re(200),L[201]=z(201),L[202]=q(202,4,A.writeFloatBE||I,!0),L[203]=q(203,8,A.writeDoubleBE||X,!0),L[204]=j(204),L[205]=re(205),L[206]=z(206),L[207]=q(207,8,Z),L[208]=j(208),L[209]=re(209),L[210]=z(210),L[211]=q(211,8,M),L[217]=j(217),L[218]=re(218),L[219]=z(219),L[220]=re(220),L[221]=z(221),L[222]=re(222),L[223]=z(223),L}function j(L){return function(S,k){var v=S.reserve(2),P=S.buffer;P[v++]=L,P[v]=k}}function re(L){return function(S,k){var v=S.reserve(3),P=S.buffer;P[v++]=L,P[v++]=k>>>8,P[v]=k}}function z(L){return function(S,k){var v=S.reserve(5),P=S.buffer;P[v++]=L,P[v++]=k>>>24,P[v++]=k>>>16,P[v++]=k>>>8,P[v]=k}}function q(L,S,k,v){return function(P,B){var te=P.reserve(S+1);P.buffer[te++]=L,k.call(P.buffer,B,te,v)}}function Z(L,S){new J(this,S,L)}function M(L,S){new _(this,S,L)}function I(L,S){d.write(this,L,S,!1,23,4)}function X(L,S){d.write(this,L,S,!1,52,8)}le.getWriteToken=function U(L){return L&&L.uint8array?function N(){var L=Y();return L[202]=q(202,4,I),L[203]=q(203,8,X),L}():V||O.hasBuffer&&L&&L.safe?function T(){var L=w.slice();return L[196]=q(196,1,x.prototype.writeUInt8),L[197]=q(197,2,x.prototype.writeUInt16BE),L[198]=q(198,4,x.prototype.writeUInt32BE),L[199]=q(199,1,x.prototype.writeUInt8),L[200]=q(200,2,x.prototype.writeUInt16BE),L[201]=q(201,4,x.prototype.writeUInt32BE),L[202]=q(202,4,x.prototype.writeFloatBE),L[203]=q(203,8,x.prototype.writeDoubleBE),L[204]=q(204,1,x.prototype.writeUInt8),L[205]=q(205,2,x.prototype.writeUInt16BE),L[206]=q(206,4,x.prototype.writeUInt32BE),L[207]=q(207,8,Z),L[208]=q(208,1,x.prototype.writeInt8),L[209]=q(209,2,x.prototype.writeInt16BE),L[210]=q(210,4,x.prototype.writeInt32BE),L[211]=q(211,8,M),L[217]=q(217,1,x.prototype.writeUInt8),L[218]=q(218,2,x.prototype.writeUInt16BE),L[219]=q(219,4,x.prototype.writeUInt32BE),L[220]=q(220,2,x.prototype.writeUInt16BE),L[221]=q(221,4,x.prototype.writeUInt32BE),L[222]=q(222,2,x.prototype.writeUInt16BE),L[223]=q(223,4,x.prototype.writeUInt32BE),L}():Y()}},9118:(E,le,_e)=>{var d=_e(6425),H=_e(6256),J=H.Uint64BE,_=H.Int64BE,w=_e(6093),O=_e(5364),x=_e(3041),K=_e(8323).w,V=_e(7846).S,A=typeof Uint8Array<"u",U=typeof Map<"u",N=[];N[1]=212,N[2]=213,N[4]=214,N[8]=215,N[16]=216,le.getWriteType=function Y(T){var j=x.getWriteToken(T),re=T&&T.useraw,z=A&&T&&T.binarraybuffer,q=z?w.isArrayBuffer:w.isBuffer,Z=z?function l(m,C){g(m,new Uint8Array(C))}:g,I=U&&T&&T.usemap?function u(m,C){if(!(C instanceof Map))return f(m,C);var $=C.size;j[$<16?128+$:$<=65535?222:223](m,$);var se=m.codec.encode;C.forEach(function(Ee,Ie,ce){se(m,Ie),se(m,Ee)})}:f;return{boolean:function L(m,C){j[C?195:194](m,C)},function:R,number:function S(m,C){var $=0|C;C===$?j[-32<=$&&$<=127?255&$:0<=$?$<=255?204:$<=65535?205:206:-128<=$?208:-32768<=$?209:210](m,$):j[203](m,C)},object:re?function fe(m,C){if(q(C))return function p(m,C){var $=C.length;j[$<32?160+$:$<=65535?218:219](m,$),m.send(C)}(m,C);D(m,C)}:D,string:function te(m){return function C($,ie){var se=ie.length;$.offset=$.reserve(5+3*se);var Ie=$.buffer,ce=m(se),Me=$.offset+ce;se=O.write.call(Ie,ie,Me);var $e=m(se);ce!==$e&&O.copy.call(Ie,Ie,Me+$e-ce,Me,Me+se),j[1===$e?160+se:$e<=3?215+$e:219]($,se),$.offset+=se}}(re?function B(m){return m<32?1:m<=65535?3:5}:function P(m){return m<32?1:m<=255?2:m<=65535?3:5}),symbol:R,undefined:R};function D(m,C){if(null===C)return R(m,C);if(q(C))return Z(m,C);if(d(C))return function F(m,C){var $=C.length;j[$<16?144+$:$<=65535?220:221](m,$);for(var se=m.codec.encode,Ee=0;Ee<$;Ee++)se(m,C[Ee])}(m,C);if(J.isUint64BE(C))return function k(m,C){j[207](m,C.toArray())}(m,C);if(_.isInt64BE(C))return function v(m,C){j[211](m,C.toArray())}(m,C);var $=m.codec.getExtPacker(C);if($&&(C=$(C)),C instanceof V)return function c(m,C){var $=C.buffer,ie=$.length;j[N[ie]||(ie<255?199:ie<=65535?200:201)](m,ie),K[C.type](m),m.send($)}(m,C);I(m,C)}function R(m,C){j[192](m,C)}function g(m,C){var $=C.length;j[$<255?196:$<=65535?197:198](m,$),m.send(C)}function f(m,C){var $=Object.keys(C),ie=$.length;j[ie<16?128+ie:ie<=65535?222:223](m,ie);var Ee=m.codec.encode;$.forEach(function(Ie){Ee(m,Ie),Ee(m,C[Ie])})}}},8323:(E,le)=>{for(var _e=le.w=new Array(256),d=0;d<=255;d++)_e[d]=H(d);function H(J){return function(_){var w=_.reserve(1);_.buffer[w]=J}}},1203:E=>{function le(J){var _="    ";if(isNaN(parseInt(J)))_=J;else switch(J){case 1:_=" ";break;case 2:_="  ";break;case 3:_="   ";break;case 4:_="    ";break;case 5:_="     ";break;case 6:_="      ";break;case 7:_="       ";break;case 8:_="        ";break;case 9:_="         ";break;case 10:_="          ";break;case 11:_="           ";break;case 12:_="            "}for(var w=["\n"],O=0;O<100;O++)w.push(w[O]+_);return w}function _e(){this.step="    ",this.shift=le(this.step)}function d(J,_){return _-(J.replace(/\(/g,"").length-J.replace(/\)/g,"").length)}function H(J,_){return J.replace(/\s{1,}/g," ").replace(/ AND /gi,"~::~"+_+_+"AND ").replace(/ BETWEEN /gi,"~::~"+_+"BETWEEN ").replace(/ CASE /gi,"~::~"+_+"CASE ").replace(/ ELSE /gi,"~::~"+_+"ELSE ").replace(/ END /gi,"~::~"+_+"END ").replace(/ FROM /gi,"~::~FROM ").replace(/ GROUP\s{1,}BY/gi,"~::~GROUP BY ").replace(/ HAVING /gi,"~::~HAVING ").replace(/ IN /gi," IN ").replace(/ JOIN /gi,"~::~JOIN ").replace(/ CROSS~::~{1,}JOIN /gi,"~::~CROSS JOIN ").replace(/ INNER~::~{1,}JOIN /gi,"~::~INNER JOIN ").replace(/ LEFT~::~{1,}JOIN /gi,"~::~LEFT JOIN ").replace(/ RIGHT~::~{1,}JOIN /gi,"~::~RIGHT JOIN ").replace(/ ON /gi,"~::~"+_+"ON ").replace(/ OR /gi,"~::~"+_+_+"OR ").replace(/ ORDER\s{1,}BY/gi,"~::~ORDER BY ").replace(/ OVER /gi,"~::~"+_+"OVER ").replace(/\(\s{0,}SELECT /gi,"~::~(SELECT ").replace(/\)\s{0,}SELECT /gi,")~::~SELECT ").replace(/ THEN /gi," THEN~::~"+_).replace(/ UNION /gi,"~::~UNION~::~").replace(/ USING /gi,"~::~USING ").replace(/ WHEN /gi,"~::~"+_+"WHEN ").replace(/ WHERE /gi,"~::~WHERE ").replace(/ WITH /gi,"~::~WITH ").replace(/ ALL /gi," ALL ").replace(/ AS /gi," AS ").replace(/ ASC /gi," ASC ").replace(/ DESC /gi," DESC ").replace(/ DISTINCT /gi," DISTINCT ").replace(/ EXISTS /gi," EXISTS ").replace(/ NOT /gi," NOT ").replace(/ NULL /gi," NULL ").replace(/ LIKE /gi," LIKE ").replace(/\s{0,}SELECT /gi,"SELECT ").replace(/\s{0,}UPDATE /gi,"UPDATE ").replace(/ SET /gi," SET ").replace(/~::~{1,}/g,"~::~").split("~::~")}_e.prototype.xml=function(J,_){var w=J.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").replace(/\s*xmlns\=/g,"~::~xmlns=").split("~::~"),O=w.length,x=!1,K=0,V="",A=0,U=_?le(_):this.shift;for(A=0;A<O;A++)w[A].search(/<!/)>-1?(V+=U[K]+w[A],x=!0,(w[A].search(/-->/)>-1||w[A].search(/\]>/)>-1||w[A].search(/!DOCTYPE/)>-1)&&(x=!1)):w[A].search(/-->/)>-1||w[A].search(/\]>/)>-1?(V+=w[A],x=!1):/^<\w/.exec(w[A-1])&&/^<\/\w/.exec(w[A])&&/^<[\w:\-\.\,]+/.exec(w[A-1])==/^<\/[\w:\-\.\,]+/.exec(w[A])[0].replace("/","")?(V+=w[A],x||K--):w[A].search(/<\w/)>-1&&-1==w[A].search(/<\//)&&-1==w[A].search(/\/>/)?V=V+=x?w[A]:U[K++]+w[A]:w[A].search(/<\w/)>-1&&w[A].search(/<\//)>-1?V=V+=x?w[A]:U[K]+w[A]:w[A].search(/<\//)>-1?V=V+=x?w[A]:U[--K]+w[A]:w[A].search(/\/>/)>-1?V=V+=x?w[A]:U[K]+w[A]:w[A].search(/<\?/)>-1||w[A].search(/xmlns\:/)>-1||w[A].search(/xmlns\=/)>-1?V+=U[K]+w[A]:V+=w[A];return"\n"==V[0]?V.slice(1):V},_e.prototype.json=function(J,w){return w=w||this.step,typeof JSON>"u"?J:"string"==typeof J?JSON.stringify(JSON.parse(J),null,w):"object"==typeof J?JSON.stringify(J,null,w):J},_e.prototype.css=function(J,_){var w=J.replace(/\s{1,}/g," ").replace(/\{/g,"{~::~").replace(/\}/g,"~::~}~::~").replace(/\;/g,";~::~").replace(/\/\*/g,"~::~/*").replace(/\*\//g,"*/~::~").replace(/~::~\s{0,}~::~/g,"~::~").split("~::~"),O=w.length,x=0,K="",V=0,A=_?le(_):this.shift;for(V=0;V<O;V++)/\{/.exec(w[V])?K+=A[x++]+w[V]:/\}/.exec(w[V])?K+=A[--x]+w[V]:(/\*\\/.exec(w[V]),K+=A[x]+w[V]);return K.replace(/^\n{1,}/,"")},_e.prototype.sql=function(J,_){var w=J.replace(/\s{1,}/g," ").replace(/\'/gi,"~::~'").split("~::~"),O=w.length,x=[],K=0,V=this.step,N=0,Y="",T=0,j=_?le(_):this.shift;for(T=0;T<O;T++)x=x.concat(T%2?w[T]:H(w[T],V));for(O=x.length,T=0;T<O;T++)N=d(x[T],N),/\s{0,}\s{0,}SELECT\s{0,}/.exec(x[T])&&(x[T]=x[T].replace(/\,/g,",\n"+V+V)),/\s{0,}\s{0,}SET\s{0,}/.exec(x[T])&&(x[T]=x[T].replace(/\,/g,",\n"+V+V)),/\s{0,}\(\s{0,}SELECT\s{0,}/.exec(x[T])?Y+=j[++K]+x[T]:/\'/.exec(x[T])?(N<1&&K&&K--,Y+=x[T]):(Y+=j[K]+x[T],N<1&&K&&K--);return Y.replace(/^\n{1,}/,"").replace(/\n{1,}/g,"\n")},_e.prototype.xmlmin=function(J,_){return(_?J:J.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"").replace(/[ \r\n\t]{1,}xmlns/g," xmlns")).replace(/>\s{0,}</g,"><")},_e.prototype.jsonmin=function(J){return typeof JSON>"u"?J:JSON.stringify(JSON.parse(J),null,0)},_e.prototype.cssmin=function(J,_){return(_?J:J.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\//g,"")).replace(/\s{1,}/g," ").replace(/\{\s{1,}/g,"{").replace(/\}\s{1,}/g,"}").replace(/\;\s{1,}/g,";").replace(/\/\*\s{1,}/g,"/*").replace(/\*\/\s{1,}/g,"*/")},_e.prototype.sqlmin=function(J){return J.replace(/\s{1,}/g," ").replace(/\s{1,}\(/,"(").replace(/\s{1,}\)/,")")},E.exports=new _e},85:(E,le,_e)=>{var d={"./AFF2e":[7676,7327],"./AFF2e.js":[7676,7327],"./AceKillerGene":[1439,7217],"./AceKillerGene.js":[1439,7217],"./Ainecadette":[2160,8150],"./Ainecadette.js":[2160,8150],"./Airgetlamh":[6408,5247],"./Airgetlamh.js":[6408,5247],"./AlchemiaStruggle":[6510,5225],"./AlchemiaStruggle.js":[6510,5225],"./Alsetto":[905,2948],"./Alsetto.js":[905,2948],"./Alshard":[7058,6420],"./Alshard.js":[7058,6420],"./AlterRaise":[1105,3385],"./AlterRaise.js":[1105,3385],"./Amadeus":[5752,1582],"./Amadeus.js":[5752,1582],"./Amadeus_Korean":[6602,5512],"./Amadeus_Korean.js":[6602,5512],"./AngelGear":[4200,9437],"./AngelGear.js":[4200,9437],"./AnimaAnimus":[7164,2919],"./AnimaAnimus.js":[7164,2919],"./Aoharubaan":[5757,6968],"./Aoharubaan.js":[5757,6968],"./Arianrhod":[4005,5283],"./Arianrhod.js":[4005,5283],"./ArsMagica":[3655,5734],"./ArsMagica.js":[3655,5734],"./AssaultEngine":[3898,4339],"./AssaultEngine.js":[3898,4339],"./Avandner":[8206,3084],"./Avandner.js":[8206,3084],"./Ayabito":[5853,1253],"./Ayabito.js":[5853,1253],"./BBN":[8554,2522],"./BBN.js":[8554,2522],"./BadLife":[9538,4872],"./BadLife.js":[9538,4872],"./Bakenokawa":[6103,2135],"./Bakenokawa.js":[6103,2135],"./BarnaKronika":[5396,7073],"./BarnaKronika.js":[5396,7073],"./BattleTech":[2890,6344],"./BattleTech.js":[2890,6344],"./BeastBindTrinity":[1063,4572],"./BeastBindTrinity.js":[1063,4572],"./BeginningIdol":[8857,66],"./BeginningIdol.js":[8857,66],"./BeginningIdol2022":[8381,6466],"./BeginningIdol2022.js":[8381,6466],"./BeginningIdol_Korean":[7816,7117],"./BeginningIdol_Korean.js":[7816,7117],"./BladeOfArcana":[3449,1087],"./BladeOfArcana.js":[3449,1087],"./BlindMythos":[2639,5539],"./BlindMythos.js":[2639,5539],"./BloodCrusade":[2906,2013],"./BloodCrusade.js":[2906,2013],"./BloodMoon":[7994,593],"./BloodMoon.js":[7994,593],"./Bloodorium":[3498,3312],"./Bloodorium.js":[3498,3312],"./CardRanker":[6006,873],"./CardRanker.js":[6006,873],"./CastleInGray":[2519,1820],"./CastleInGray.js":[2519,1820],"./ChaosFlare":[229,1114],"./ChaosFlare.js":[229,1114],"./Chill":[9894,1919],"./Chill.js":[9894,1919],"./Chill3":[3294,8585],"./Chill3.js":[3294,8585],"./CodeLayerd":[6106,9606],"./CodeLayerd.js":[6106,9606],"./ColossalHunter":[519,2461],"./ColossalHunter.js":[519,2461],"./Comes":[1712,2793],"./Comes.js":[1712,2793],"./ConvictorDrive":[1011,8138],"./ConvictorDrive.js":[1011,8138],"./CrashWorld":[6506,2519],"./CrashWorld.js":[6506,2519],"./Cthulhu":[2605,3364],"./Cthulhu.js":[2605,3364],"./Cthulhu7th":[5149,8376],"./Cthulhu7th.js":[5149,8376],"./Cthulhu7th_ChineseTraditional":[9464,6447],"./Cthulhu7th_ChineseTraditional.js":[9464,6447],"./Cthulhu7th_Korean":[329,7170],"./Cthulhu7th_Korean.js":[329,7170],"./CthulhuTech":[9818,2555],"./CthulhuTech.js":[9818,2555],"./Cthulhu_ChineseTraditional":[3109,9285],"./Cthulhu_ChineseTraditional.js":[3109,9285],"./Cthulhu_Korean":[9585,7008],"./Cthulhu_Korean.js":[9585,7008],"./Cthulhu_SimplifiedChinese":[4916,1448],"./Cthulhu_SimplifiedChinese.js":[4916,1448],"./CyberpunkRed":[1933,347],"./CyberpunkRed.js":[1933,347],"./DarkBlaze":[7810,3005],"./DarkBlaze.js":[7810,3005],"./DarkDaysDrive":[3543,5736],"./DarkDaysDrive.js":[3543,5736],"./DarkSouls":[5581,3958],"./DarkSouls.js":[5581,3958],"./DeadlineHeroes":[2270,6143],"./DeadlineHeroes.js":[2270,6143],"./DemonParasite":[7605,5670],"./DemonParasite.js":[7605,5670],"./DesperateRun":[8999,148],"./DesperateRun.js":[8999,148],"./DetatokoSaga":[3264,5413],"./DetatokoSaga.js":[3264,5413],"./DetatokoSaga_Korean":[4236,7553],"./DetatokoSaga_Korean.js":[4236,7553],"./DiceBot":[8618,8159],"./DiceBot.js":[8618,8159],"./DiceOfTheDead":[2533,5651],"./DiceOfTheDead.js":[2533,5651],"./DoubleCross":[1316,8436],"./DoubleCross.js":[1316,8436],"./DoubleCross_Korean":[9761,6708],"./DoubleCross_Korean.js":[9761,6708],"./Dracurouge":[2204,2697],"./Dracurouge.js":[2204,2697],"./Dracurouge_Korean":[759,9678],"./Dracurouge_Korean.js":[759,9678],"./DungeonsAndDragons":[8454,8358],"./DungeonsAndDragons.js":[8454,8358],"./DungeonsAndDragons5":[9781,1125],"./DungeonsAndDragons5.js":[9781,1125],"./EarthDawn":[1329,517],"./EarthDawn.js":[1329,517],"./EarthDawn3":[4021,9730],"./EarthDawn3.js":[4021,9730],"./EarthDawn4":[9918,809],"./EarthDawn4.js":[9918,809],"./EclipsePhase":[410,9735],"./EclipsePhase.js":[410,9735],"./Elric":[8326,7309],"./Elric.js":[8326,7309],"./Elysion":[9626,7372],"./Elysion.js":[9626,7372],"./EmbryoMachine":[2035,9755],"./EmbryoMachine.js":[2035,9755],"./Emoklore":[8686,5620],"./Emoklore.js":[8686,5620],"./EndBreaker":[4869,3515],"./EndBreaker.js":[4869,3515],"./EtrianOdysseySRS":[3460,1851],"./EtrianOdysseySRS.js":[3460,1851],"./FateCoreSystem":[5925,5899],"./FateCoreSystem.js":[5925,5899],"./Fiasco":[6587,6739],"./Fiasco.js":[6587,6739],"./Fiasco_Korean":[3734,7036],"./Fiasco_Korean.js":[3734,7036],"./FilledWith":[4239,6705],"./FilledWith.js":[4239,6705],"./FullMetalPanic":[1959,8725],"./FullMetalPanic.js":[1959,8725],"./FutariSousa":[2729,4564],"./FutariSousa.js":[2729,4564],"./FutariSousa_Korean":[6326,8175],"./FutariSousa_Korean.js":[6326,8175],"./GURPS":[7782,6908],"./GURPS.js":[7782,6908],"./Garako":[1948,8165],"./Garako.js":[1948,8165],"./GardenOrder":[2017,172],"./GardenOrder.js":[2017,172],"./GehennaAn":[1647,5105],"./GehennaAn.js":[1647,5105],"./GeishaGirlwithKatana":[5593,8780],"./GeishaGirlwithKatana.js":[5593,8780],"./GhostLive":[4656,9626],"./GhostLive.js":[4656,9626],"./GoblinSlayer":[3983,2006],"./GoblinSlayer.js":[3983,2006],"./GoldenSkyStories":[3437,9940],"./GoldenSkyStories.js":[3437,9940],"./Gorilla":[6362,7576],"./Gorilla.js":[6362,7576],"./GranCrest":[7150,6613],"./GranCrest.js":[7150,6613],"./Gundog":[8166,6501],"./Gundog.js":[8166,6501],"./GundogRevised":[4196,427],"./GundogRevised.js":[4196,427],"./GundogZero":[5273,493],"./GundogZero.js":[5273,493],"./GurpsFW":[882,6949],"./GurpsFW.js":[882,6949],"./HarnMaster":[6765,4075],"./HarnMaster.js":[6765,4075],"./HatsuneMiku":[3124,6589],"./HatsuneMiku.js":[3124,6589],"./Hieizan":[7418,8171],"./Hieizan.js":[7418,8171],"./HouraiGakuen":[7945,7155],"./HouraiGakuen.js":[7945,7155],"./HunterTheReckoning5th":[7434,3191],"./HunterTheReckoning5th.js":[7434,3191],"./HuntersMoon":[4873,1909],"./HuntersMoon.js":[4873,1909],"./IfIfIf":[7043,4507],"./IfIfIf.js":[7043,4507],"./Illusio":[3843,4796],"./Illusio.js":[3843,4796],"./InfiniteBabeL":[7878,7641],"./InfiniteBabeL.js":[7878,7641],"./InfiniteFantasia":[6391,391],"./InfiniteFantasia.js":[6391,391],"./Insane":[5844,9001],"./Insane.js":[5844,9001],"./Insane_Korean":[9199,1918],"./Insane_Korean.js":[9199,1918],"./Irisbane":[4167,6957],"./Irisbane.js":[4167,6957],"./IthaWenUa":[2726,9872],"./IthaWenUa.js":[2726,9872],"./JamesBond":[4866,7097],"./JamesBond.js":[4866,7097],"./JekyllAndHyde":[817,4788],"./JekyllAndHyde.js":[817,4788],"./JuinKansen":[9673,9327],"./JuinKansen.js":[9673,9327],"./Kamigakari":[2920,8602],"./Kamigakari.js":[2920,8602],"./Kamigakari_Korean":[6250,5309],"./Kamigakari_Korean.js":[6250,5309],"./KanColle":[4670,2098],"./KanColle.js":[4670,2098],"./Karukami":[2838,1616],"./Karukami.js":[2838,1616],"./KemonoNoMori":[1151,3962],"./KemonoNoMori.js":[1151,3962],"./KillDeathBusiness":[744,6750],"./KillDeathBusiness.js":[744,6750],"./KillDeathBusiness_Korean":[346,4401],"./KillDeathBusiness_Korean.js":[346,4401],"./KurayamiCrying":[5627,164],"./KurayamiCrying.js":[5627,164],"./Kutulu":[76,8790],"./Kutulu.js":[76,8790],"./LiveraDoll":[6459,8440],"./LiveraDoll.js":[6459,8440],"./LogHorizon":[8991,4810],"./LogHorizon.js":[8991,4810],"./LogHorizon_Korean":[8959,348],"./LogHorizon_Korean.js":[8959,348],"./LostRecord":[6543,7171],"./LostRecord.js":[6543,7171],"./LostRoyal":[9348,9625],"./LostRoyal.js":[9348,9625],"./MagicaLogia":[5563,2399],"./MagicaLogia.js":[5563,2399],"./MagicaLogia_Korean":[2586,7729],"./MagicaLogia_Korean.js":[2586,7729],"./MagicaLogia_SimplifiedChinese":[3677,6875],"./MagicaLogia_SimplifiedChinese.js":[3677,6875],"./MeikyuDays":[3433,1493],"./MeikyuDays.js":[3433,1493],"./MeikyuKingdom":[9889,8326],"./MeikyuKingdom.js":[9889,8326],"./MeikyuKingdomBasic":[668,7016],"./MeikyuKingdomBasic.js":[668,7016],"./MetalHead":[1175,7276],"./MetalHead.js":[1175,7276],"./MetalHeadExtream":[1587,3062],"./MetalHeadExtream.js":[1587,3062],"./MetallicGuardian":[1245,2040],"./MetallicGuardian.js":[1245,2040],"./MonotoneMuseum":[4351,735],"./MonotoneMuseum.js":[4351,735],"./MonotoneMuseum_Korean":[3989,5249],"./MonotoneMuseum_Korean.js":[3989,5249],"./NSSQ":[6681,4238],"./NSSQ.js":[6681,4238],"./Nechronica":[8885,3532],"./Nechronica.js":[8885,3532],"./Nechronica_Korean":[4361,4116],"./Nechronica_Korean.js":[4361,4116],"./NeverCloud":[9447,3096],"./NeverCloud.js":[9447,3096],"./NightWizard":[7740,5811],"./NightWizard.js":[7740,5811],"./NightWizard3rd":[4933,3535],"./NightWizard3rd.js":[4933,3535],"./NightmareHunterDeep":[1387,298],"./NightmareHunterDeep.js":[1387,298],"./NinjaSlayer":[517,7381],"./NinjaSlayer.js":[517,7381],"./NjslyrBattle":[596,3443],"./NjslyrBattle.js":[596,3443],"./NobunagasBlackCastle":[1067,6652],"./NobunagasBlackCastle.js":[1067,6652],"./Nuekagami":[1848,3293],"./Nuekagami.js":[1848,3293],"./OneWayHeroics":[1989,3852],"./OneWayHeroics.js":[1989,3852],"./OracleEngine":[978,2989],"./OracleEngine.js":[978,2989],"./OrgaRain":[8614,644],"./OrgaRain.js":[8614,644],"./Oukahoushin3rd":[7133,3407],"./Oukahoushin3rd.js":[7133,3407],"./Paradiso":[2313,4246],"./Paradiso.js":[2313,4246],"./Paranoia":[6634,1031],"./Paranoia.js":[6634,1031],"./ParanoiaRebooted":[9628,5289],"./ParanoiaRebooted.js":[9628,5289],"./ParasiteBlood":[8073,1410],"./ParasiteBlood.js":[8073,1410],"./Pathfinder":[5017,1599],"./Pathfinder.js":[5017,1599],"./Peekaboo":[9309,844],"./Peekaboo.js":[9309,844],"./Pendragon":[9113,2311],"./Pendragon.js":[9113,2311],"./PersonaO":[6706,481],"./PersonaO.js":[6706,481],"./PhantasmAdventure":[926,8614],"./PhantasmAdventure.js":[926,8614],"./Postman":[3021,5124],"./Postman.js":[3021,5124],"./PulpCthulhu":[4292,9449],"./PulpCthulhu.js":[4292,9449],"./Raisondetre":[2909,293],"./Raisondetre.js":[2909,293],"./RecordOfLodossWar":[1925,281],"./RecordOfLodossWar.js":[1925,281],"./RecordOfSteam":[1293,2213],"./RecordOfSteam.js":[1293,2213],"./Revulture":[573,9886],"./Revulture.js":[573,9886],"./RokumonSekai2":[3592,9495],"./RokumonSekai2.js":[3592,9495],"./RoleMaster":[7612,2625],"./RoleMaster.js":[7612,2625],"./RuinBreakers":[1349,7696],"./RuinBreakers.js":[1349,7696],"./RuneQuest":[7543,7480],"./RuneQuest.js":[7543,7480],"./RyuTuber":[1287,1766],"./RyuTuber.js":[1287,1766],"./Ryutama":[8123,585],"./Ryutama.js":[8123,585],"./SRS":[5762,1377],"./SRS.js":[5762,1377],"./SajinsenkiAGuS":[4969,5034],"./SajinsenkiAGuS.js":[4969,5034],"./SamsaraBallad":[2255,2250],"./SamsaraBallad.js":[2255,2250],"./Satasupe":[8236,3314],"./Satasupe.js":[8236,3314],"./ScreamHighSchool":[7728,512],"./ScreamHighSchool.js":[7728,512],"./Sengensyou":[1369,3109],"./Sengensyou.js":[1369,3109],"./SevenFortressMobius":[2004,1091],"./SevenFortressMobius.js":[2004,1091],"./ShadowRun":[7633,8975],"./ShadowRun.js":[7633,8975],"./ShadowRun4":[8489,5925],"./ShadowRun4.js":[8489,5925],"./ShadowRun5":[3265,3665],"./ShadowRun5.js":[3265,3665],"./SharedFantasia":[554,2025],"./SharedFantasia.js":[554,2025],"./ShinMegamiTenseiKakuseihen":[6821,8657],"./ShinMegamiTenseiKakuseihen.js":[6821,8657],"./ShinkuuGakuen":[708,1763],"./ShinkuuGakuen.js":[708,1763],"./ShinobiGami":[1946,132],"./ShinobiGami.js":[1946,132],"./Shiranui":[9776,2709],"./Shiranui.js":[9776,2709],"./ShoujoTenrankai":[8491,8565],"./ShoujoTenrankai.js":[8491,8565],"./ShuumatsuKikou":[918,533],"./ShuumatsuKikou.js":[918,533],"./Skynauts":[8327,5150],"./Skynauts.js":[8327,5150],"./SkynautsBouken":[5444,303],"./SkynautsBouken.js":[5444,303],"./StarryDolls":[783,9354],"./StarryDolls.js":[783,9354],"./SteamPunkers":[6339,7103],"./SteamPunkers.js":[6339,7103],"./StellarKnights":[5849,628],"./StellarKnights.js":[5849,628],"./StellarKnights_Korean":[2795,6768],"./StellarKnights_Korean.js":[2795,6768],"./StellarLife":[8594,3740],"./StellarLife.js":[8594,3740],"./StrangerOfSwordCity":[5214,1593],"./StrangerOfSwordCity.js":[5214,1593],"./StratoShout":[203,8470],"./StratoShout.js":[203,8470],"./StratoShout_Korean":[2030,6114],"./StratoShout_Korean.js":[2030,6114],"./Strave":[1758,8233],"./Strave.js":[1758,8233],"./SwordWorld":[8250,3210],"./SwordWorld.js":[8250,3210],"./SwordWorld2_0":[3840,7043],"./SwordWorld2_0.js":[3840,7043],"./SwordWorld2_0_SimplifiedChinese":[206,8196],"./SwordWorld2_0_SimplifiedChinese.js":[206,8196],"./SwordWorld2_5":[9527,9753],"./SwordWorld2_5.js":[9527,9753],"./SwordWorld2_5_SimplifiedChinese":[8463,6152],"./SwordWorld2_5_SimplifiedChinese.js":[8463,6152],"./SwordWorld_SimplifiedChinese":[7184,9640],"./SwordWorld_SimplifiedChinese.js":[7184,9640],"./TalesFromTheLoop":[4331,1982],"./TalesFromTheLoop.js":[4331,1982],"./TherapieSein":[4028,5405],"./TherapieSein.js":[4028,5405],"./TokumeiTenkousei":[4905,5101],"./TokumeiTenkousei.js":[4905,5101],"./TokyoGhostResearch":[3874,2686],"./TokyoGhostResearch.js":[3874,2686],"./TokyoNova":[7459,7455],"./TokyoNova.js":[7459,7455],"./Torg":[3042,6604],"./Torg.js":[3042,6604],"./Torg1_5":[3257,8177],"./Torg1_5.js":[3257,8177],"./TorgEternity":[9543,9931],"./TorgEternity.js":[9543,9931],"./ToshiakiHolyGrailWar":[1641,4957],"./ToshiakiHolyGrailWar.js":[1641,4957],"./TrinitySeven":[8262,589],"./TrinitySeven.js":[8262,589],"./TunnelsAndTrolls":[6450,5188],"./TunnelsAndTrolls.js":[6450,5188],"./TwilightGunsmoke":[4547,6331],"./TwilightGunsmoke.js":[4547,6331],"./UnsungDuet":[6694,1209],"./UnsungDuet.js":[6694,1209],"./Utakaze":[5520,357],"./Utakaze.js":[5520,357],"./VampireTheMasquerade5th":[6409,7115],"./VampireTheMasquerade5th.js":[6409,7115],"./Villaciel":[6633,4906],"./Villaciel.js":[6633,4906],"./VisionConnect":[2527,35],"./VisionConnect.js":[2527,35],"./WARPS":[8581,1380],"./WARPS.js":[8581,1380],"./WaresBlade":[9840,4213],"./WaresBlade.js":[9840,4213],"./Warhammer":[9883,7339],"./Warhammer.js":[9883,7339],"./Warhammer4":[2135,4837],"./Warhammer4.js":[2135,4837],"./WitchQuest":[3617,6088],"./WitchQuest.js":[3617,6088],"./WorldOfDarkness":[3350,3726],"./WorldOfDarkness.js":[3350,3726],"./YankeeYogSothoth":[1930,7906],"./YankeeYogSothoth.js":[1930,7906],"./YearZeroEngine":[929,6632],"./YearZeroEngine.js":[929,6632],"./Yggdrasill":[7157,6467],"./Yggdrasill.js":[7157,6467],"./ZettaiReido":[6698,4999],"./ZettaiReido.js":[6698,4999]};function H(J){if(!_e.o(d,J))return Promise.resolve().then(()=>{var O=new Error("Cannot find module '"+J+"'");throw O.code="MODULE_NOT_FOUND",O});var _=d[J],w=_[0];return _e.e(_[1]).then(()=>_e.t(w,23))}H.keys=()=>Object.keys(d),H.id=85,E.exports=H},6507:(E,le,_e)=>{var d={"./Amadeus.ja_jp.json":[6070,9299],"./Amadeus.ko_kr.json":[765,4092],"./Arianrhod.ja_jp.json":[7267,8206],"./BeginningIdol.ja_jp.json":[5355,8635],"./BeginningIdol.ko_kr.json":[2590,6961],"./Cthulhu.ja_jp.json":[8128,652],"./Cthulhu.ko_kr.json":[7002,2617],"./Cthulhu.zh_hans.json":[4209,4922],"./Cthulhu.zh_hant.json":[8021,3147],"./DetatokoSaga.ja_jp.json":[4608,5777],"./DetatokoSaga.ko_kr.json":[408,4502],"./DoubleCross.ja_jp.json":[9221,8706],"./DoubleCross.ko_kr.json":[9734,8517],"./Dracurouge.ja_jp.json":[2286,2847],"./Dracurouge.ko_kr.json":[3597,155],"./Emoklore.ja_jp.json":[8985,6488],"./Fiasco.ja_jp.json":[9873,1800],"./Fiasco.ko_kr.json":[5244,783],"./FutariSousa.ja_jp.json":[9491,8078],"./FutariSousa.ko_kr.json":[8721,9567],"./Insane.ja_jp.json":[5040,6446],"./Insane.ko_kr.json":[5488,3978],"./Kamigakari.ja_jp.json":[2742,3922],"./Kamigakari.ko_kr.json":[7708,1197],"./KillDeathBusiness.ja_jp.json":[2288,3760],"./KillDeathBusiness.ko_kr.json":[1847,287],"./LogHorizon.ja_jp.json":[6438,3811],"./LogHorizon.ko_kr.json":[8319,5106],"./MagicaLogia.ja_jp.json":[4786,9120],"./MagicaLogia.ko_kr.json":[339,2107],"./MagicaLogia.zh_hans.json":[9116,3229],"./MonotoneMuseum.ja_jp.json":[5628,7848],"./MonotoneMuseum.ko_kr.json":[1302,8157],"./Nechronica.ja_jp.json":[9437,667],"./Nechronica.ko_kr.json":[4241,7743],"./StellarKnights.ja_jp.json":[7251,9206],"./StellarKnights.ko_kr.json":[6697,5717],"./StratoShout.ja_jp.json":[7313,7015],"./StratoShout.ko_kr.json":[424,4113],"./SwordWorld.ja_jp.json":[1243,7348],"./SwordWorld.zh_hans.json":[715,654],"./SwordWorld2_0.ja_jp.json":[7547,5351],"./SwordWorld2_0.zh_hans.json":[7912,5642],"./SwordWorld2_5.ja_jp.json":[8368,669],"./SwordWorld2_5.zh_hans.json":[9860,2597]};function H(J){if(!_e.o(d,J))return Promise.resolve().then(()=>{var O=new Error("Cannot find module '"+J+"'");throw O.code="MODULE_NOT_FOUND",O});var _=d[J],w=_[0];return _e.e(_[1]).then(()=>_e.t(w,19))}H.keys=()=>Object.keys(d),H.id=6507,E.exports=H},2480:()=>{},5861:(E,le,_e)=>{"use strict";function d(J,_,w,O,x,K,V){try{var A=J[K](V),U=A.value}catch(N){return void w(N)}A.done?_(U):Promise.resolve(U).then(O,x)}function H(J){return function(){var _=this,w=arguments;return new Promise(function(O,x){var K=J.apply(_,w);function V(U){d(K,O,x,V,A,"next",U)}function A(U){d(K,O,x,V,A,"throw",U)}V(void 0)})}}_e.d(le,{Z:()=>H})},4682:E=>{"use strict";E.exports=JSON.parse('{"gameSystems":[{"id":"PulpCthulhu","name":"\u30d1\u30eb\u30d7\u30fb\u30af\u30c8\u30a5\u30eb\u30d5","className":"PulpCthulhu","superClassName":"Cthulhu7th","sortKey":"\u306f\u308b\u3075\u304f\u3068\u3046\u308b\u3075","locale":"ja_jp"},{"id":"ToshiakiHolyGrailWar","name":"\u3068\u3057\u3042\u304d\u306e\u8056\u676f\u6226\u4e89TRPG","className":"ToshiakiHolyGrailWar","superClassName":"Base","sortKey":"\u3068\u3057\u3042\u304d\u306e\u305b\u3044\u306f\u3044\u305b\u3093\u305d\u3046TRPG","locale":"ja_jp"},{"id":"Raisondetre","name":"\u53db\u9006\u30ec\u30be\u30f3\u30c7\u30fc\u30c8\u30eb","className":"Raisondetre","superClassName":"Base","sortKey":"\u306f\u3093\u304d\u3084\u304f\u308c\u305d\u3093\u3066\u3068\u304a\u308b","locale":"ja_jp"},{"id":"TrinitySeven","name":"\u30c8\u30ea\u30cb\u30c6\u30a3\u30bb\u30d6\u30f3RPG","className":"TrinitySeven","superClassName":"Base","sortKey":"\u3068\u308a\u306b\u3066\u3044\u305b\u3075\u3093RPG","locale":"ja_jp"},{"id":"BladeOfArcana","name":"\u30d6\u30ec\u30a4\u30c9\u30fb\u30aa\u30d6\u30fb\u30a2\u30eb\u30ab\u30ca","className":"BladeOfArcana","superClassName":"Base","sortKey":"\u3075\u308c\u3044\u3068\u304a\u3075\u3042\u308b\u304b\u306a","locale":"ja_jp"},{"id":"RecordOfLodossWar","name":"\u30ed\u30fc\u30c9\u30b9\u5cf6\u6226\u8a18RPG","className":"RecordOfLodossWar","superClassName":"Base","sortKey":"\u308d\u304a\u3068\u3059\u3068\u3046\u305b\u3093\u304dRPG","locale":"ja_jp"},{"id":"RecordOfSteam","name":"Record of Steam","className":"RecordOfSteam","superClassName":"Base","sortKey":"\u308c\u3053\u304a\u3068\u304a\u3075\u3059\u3061\u3044\u3080","locale":"ja_jp"},{"id":"TunnelsAndTrolls","name":"\u30c8\u30f3\u30cd\u30eb\u30ba\uff06\u30c8\u30ed\u30fc\u30eb\u30ba","className":"TunnelsAndTrolls","superClassName":"Base","sortKey":"\u3068\u3093\u306d\u308b\u3059\u3042\u3093\u3068\u3068\u308d\u304a\u308b\u3059","locale":"ja_jp"},{"id":"EarthDawn4","name":"\u30a2\u30fc\u30b9\u30c9\u30fc\u30f34\u7248","className":"EarthDawn4","superClassName":"EarthDawn","sortKey":"\u3042\u3042\u3059\u3068\u304a\u30934","locale":"ja_jp"},{"id":"BlindMythos","name":"\u30d6\u30e9\u30a4\u30f3\u30c9\u30fb\u30df\u30c8\u30b9RPG","className":"BlindMythos","superClassName":"Base","sortKey":"\u3075\u3089\u3044\u3093\u3068\u307f\u3068\u3059RPG","locale":"ja_jp"},{"id":"LogHorizon:Korean","name":"\ub85c\uadf8 \ud638\ub77c\uc774\uc98c","className":"LogHorizon_Korean","superClassName":"LogHorizon","sortKey":"\u56fd\u969b\u5316:Korean:\ub85c\uadf8 \ud638\ub77c\uc774\uc98c","locale":"ko_kr"},{"id":"LostRecord","name":"\u30ed\u30b9\u30c8\u30ec\u30b3\u30fc\u30c9","className":"LostRecord","superClassName":"Base","sortKey":"\u308d\u3059\u3068\u308c\u3053\u304a\u3068","locale":"ja_jp"},{"id":"LostRoyal","name":"\u30ed\u30b9\u30c8\u30ed\u30a4\u30e4\u30eb","className":"LostRoyal","superClassName":"Base","sortKey":"\u308d\u3059\u3068\u308d\u3044\u3084\u308b","locale":"ja_jp"},{"id":"EclipsePhase","name":"\u30a8\u30af\u30ea\u30d7\u30b9\u30fb\u30d5\u30a7\u30a4\u30ba","className":"EclipsePhase","superClassName":"Base","sortKey":"\u3048\u304f\u308a\u3075\u3059\u3075\u3048\u3044\u3059","locale":"ja_jp"},{"id":"Revulture","name":"\u5149\u7815\u306e\u30ea\u30f4\u30a1\u30eb\u30c1\u30e3\u30fc","className":"Revulture","superClassName":"Base","sortKey":"\u3053\u3046\u3055\u3044\u306e\u308a\u3046\u3042\u308b\u3061\u3084\u3042","locale":"ja_jp"},{"id":"TwilightGunsmoke","name":"\u30c8\u30ef\u30a4\u30e9\u30a4\u30c8\u30ac\u30f3\u30b9\u30e2\u30fc\u30af","className":"TwilightGunsmoke","superClassName":"Base","sortKey":"\u3068\u308f\u3044\u3089\u3044\u3068\u304b\u3093\u3059\u3082\u304a\u304f","locale":"ja_jp"},{"id":"Elric","name":"\u30a8\u30eb\u30ea\u30c3\u30af\uff01","className":"Elric","superClassName":"Base","sortKey":"\u3048\u308b\u308a\u3064\u304f","locale":"ja_jp"},{"id":"Elysion","name":"\u30a8\u30ea\u30e5\u30b7\u30aa\u30f3","className":"Elysion","superClassName":"Base","sortKey":"\u3048\u308a\u3086\u3057\u304a\u3093","locale":"ja_jp"},{"id":"UnsungDuet","name":"\u30a2\u30f3\u30b5\u30f3\u30b0\u30fb\u30c7\u30e5\u30a8\u30c3\u30c8","className":"UnsungDuet","superClassName":"Base","sortKey":"\u3042\u3093\u3055\u3093\u304f\u3066\u3086\u3048\u3064\u3068","locale":"ja_jp"},{"id":"RokumonSekai2","name":"\u516d\u9580\u4e16\u754cRPG \u30bb\u30ab\u30f3\u30c9\u30a8\u30c7\u30a3\u30b7\u30e7\u30f3","className":"RokumonSekai2","superClassName":"Base","sortKey":"\u308d\u304f\u3082\u3093\u305b\u304b\u3044RPG2","locale":"ja_jp"},{"id":"Utakaze","name":"\u30a6\u30bf\u30ab\u30bc","className":"Utakaze","superClassName":"Base","sortKey":"\u3046\u305f\u304b\u305b","locale":"ja_jp"},{"id":"MagicaLogia","name":"\u30de\u30ae\u30ab\u30ed\u30ae\u30a2","className":"MagicaLogia","superClassName":"Base","sortKey":"\u307e\u304d\u304b\u308d\u304d\u3042","locale":"ja_jp"},{"id":"RoleMaster","name":"\u30ed\u30fc\u30eb\u30de\u30b9\u30bf\u30fc","className":"RoleMaster","superClassName":"Base","sortKey":"\u308d\u304a\u308b\u307e\u3059\u305f\u3042","locale":"ja_jp"},{"id":"RuinBreakers","name":"\u30eb\u30fc\u30a4\u30f3\u30d6\u30ec\u30a4\u30ab\u30fc\u30ba","className":"RuinBreakers","superClassName":"Base","sortKey":"\u308b\u3046\u3044\u3093\u3075\u308c\u3044\u304b\u3042\u3059","locale":"ja_jp"},{"id":"BloodCrusade","name":"\u30d6\u30e9\u30c3\u30c9\u30fb\u30af\u30eb\u30bb\u30a4\u30c9","className":"BloodCrusade","superClassName":"Base","sortKey":"\u3075\u3089\u3064\u3068\u304f\u308b\u305b\u3044\u3068","locale":"ja_jp"},{"id":"VampireTheMasquerade5th","name":"Vampire: The Masquerade 5th Edition","className":"VampireTheMasquerade5th","superClassName":"Base","sortKey":"\u3046\u3042\u3093\u306f\u3044\u3042\u3055\u307e\u3059\u304b\u308c\u3048\u30685","locale":"ja_jp"},{"id":"AFF2e","name":"ADVANCED FIGHTING FANTASY 2nd Edition","className":"AFF2e","superClassName":"Base","sortKey":"\u3042\u3068\u306f\u3093\u3059\u3068\u3075\u3042\u3044\u3066\u3044\u3093\u304f\u3075\u3042\u3093\u305f\u3057\u30442","locale":"ja_jp"},{"id":"BloodMoon","name":"\u30d6\u30e9\u30c3\u30c9\u30e0\u30fc\u30f3","className":"BloodMoon","superClassName":"Base","sortKey":"\u3075\u3089\u3064\u3068\u3080\u3046\u3093","locale":"ja_jp"},{"id":"Bloodorium","name":"\u30d6\u30e9\u30c9\u30ea\u30a6\u30e0","className":"Bloodorium","superClassName":"Base","sortKey":"\u3075\u3089\u3068\u308a\u3046\u3080","locale":"ja_jp"},{"id":"RuneQuest","name":"\u30eb\u30fc\u30f3\u30af\u30a8\u30b9\u30c8","className":"RuneQuest","superClassName":"Base","sortKey":"\u308b\u3046\u3093\u304f\u3048\u3059\u3068","locale":"ja_jp"},{"id":"RyuTuber","name":"\u30ea\u30e5\u30fc\u30c1\u30e5\u30fc\u30d0\u30fc\u3068\u3061\u3044\u3055\u306a\u5947\u8de1","className":"RyuTuber","superClassName":"Base","sortKey":"\u308a\u3086\u3046\u3061\u3086\u3046\u306f\u3042\u3068\u3061\u3044\u3055\u306a\u304d\u305b\u304d","locale":"ja_jp"},{"id":"Ryutama","name":"\u308a\u3085\u3046\u305f\u307e","className":"Ryutama","superClassName":"Base","sortKey":"\u308a\u3086\u3046\u305f\u307e","locale":"ja_jp"},{"id":"CardRanker","name":"\u30ab\u30fc\u30c9\u30e9\u30f3\u30ab\u30fc","className":"CardRanker","superClassName":"Base","sortKey":"\u304b\u3042\u3068\u3089\u3093\u304b\u3042","locale":"ja_jp"},{"id":"CastleInGray","name":"\u7070\u8272\u57ce\u7dba\u8b5a","className":"CastleInGray","superClassName":"Base","sortKey":"\u306f\u3044\u3044\u308d\u3057\u3088\u3046\u304d\u305f\u3093","locale":"ja_jp"},{"id":"MagicaLogia:Korean","name":"\ub9c8\uae30\uce74\ub85c\uae30\uc544","className":"MagicaLogia_Korean","superClassName":"MagicaLogia","sortKey":"\u56fd\u969b\u5316:Korean:\ub9c8\uae30\uce74\ub85c\uae30\uc544","locale":"ko_kr"},{"id":"MagicaLogia:SimplifiedChinese","name":"\u9b54\u5bfc\u4e66\u5927\u6218","className":"MagicaLogia_SimplifiedChinese","superClassName":"MagicaLogia","sortKey":"\u56fd\u969b\u5316:Simplified Chinese:\u9b54\u5bfc\u4e66\u5927\u6218","locale":"zh_hans"},{"id":"AceKillerGene","name":"\u30a8\u30fc\u30b9\u30ad\u30e9\u30fc\u30b8\u30fc\u30f3","className":"AceKillerGene","superClassName":"GardenOrder","sortKey":"\u3048\u3048\u3059\u304d\u3089\u3042\u3057\u3044\u3093","locale":"ja_jp"},{"id":"GardenOrder","name":"\u30ac\u30fc\u30c7\u30f3\u30aa\u30fc\u30c0\u30fc","className":"GardenOrder","superClassName":"Base","sortKey":"\u304b\u3042\u3066\u3093\u304a\u304a\u305f\u3042","locale":"ja_jp"},{"id":"MeikyuDays","name":"\u8ff7\u5bae\u30c7\u30a4\u30ba","className":"MeikyuDays","superClassName":"Base","sortKey":"\u3081\u3044\u304d\u3086\u3046\u3066\u3044\u3059","locale":"ja_jp"},{"id":"ChaosFlare","name":"\u30ab\u30aa\u30b9\u30d5\u30ec\u30a2","className":"ChaosFlare","superClassName":"Base","sortKey":"\u304b\u304a\u3059\u3075\u308c\u3042","locale":"ja_jp"},{"id":"SajinsenkiAGuS","name":"\u7802\u5875\u6226\u6a5f\u30a2\u30fc\u30ac\u30b9","className":"SajinsenkiAGuS","superClassName":"Base","sortKey":"\u3055\u3057\u3093\u305b\u3093\u304d\u3042\u3042\u304b\u3059","locale":"ja_jp"},{"id":"Villaciel","name":"\u84bc\u5929\u306e\u30f4\u30a3\u30e9\u30b7\u30a8\u30eb","className":"Villaciel","superClassName":"Base","sortKey":"\u305d\u3046\u3066\u3093\u306e\u3046\u3044\u3089\u3057\u3048\u308b","locale":"ja_jp"},{"id":"MeikyuKingdom","name":"\u8ff7\u5bae\u30ad\u30f3\u30b0\u30c0\u30e0","className":"MeikyuKingdom","superClassName":"Base","sortKey":"\u3081\u3044\u304d\u3086\u3046\u304d\u3093\u304f\u305f\u3080","locale":"ja_jp"},{"id":"Chill","name":"Chill","className":"Chill","superClassName":"Base","sortKey":"\u3061\u308b","locale":"ja_jp"},{"id":"SamsaraBallad","name":"\u30b5\u30f3\u30b5\u30fc\u30e9\u30fb\u30d0\u30e9\u30c3\u30c9","className":"SamsaraBallad","superClassName":"Base","sortKey":"\u3055\u3093\u3055\u3042\u3089\u306f\u3089\u3064\u3068","locale":"ja_jp"},{"id":"EmbryoMachine","name":"\u30a8\u30e0\u30d6\u30ea\u30aa\u30de\u30b7\u30f3RPG","className":"EmbryoMachine","superClassName":"Base","sortKey":"\u3048\u3080\u3075\u308a\u304a\u307e\u3057\u3093RPG","locale":"ja_jp"},{"id":"Satasupe","name":"\u30b5\u30bf\u30b9\u30da","className":"Satasupe","superClassName":"Base","sortKey":"\u3055\u305f\u3059\u3078","locale":"ja_jp"},{"id":"Ainecadette","name":"\u30a8\u30cd\u30ab\u30c7\u30c3\u30c8","className":"Ainecadette","superClassName":"Base","sortKey":"\u3048\u306d\u304b\u3066\u3064\u3068","locale":"ja_jp"},{"id":"Chill3","name":"Chill 3rd Edition","className":"Chill3","superClassName":"Base","sortKey":"\u3061\u308b3","locale":"ja_jp"},{"id":"Emoklore","name":"\u30a8\u30e2\u30af\u30ed\u30a2TRPG","className":"Emoklore","superClassName":"Base","sortKey":"\u3048\u3082\u304f\u308d\u3042TRPG","locale":"ja_jp"},{"id":"Airgetlamh","name":"\u6731\u306e\u5b64\u5854\u306e\u30a8\u30a2\u30b2\u30c8\u30e9\u30e0","className":"Airgetlamh","superClassName":"Base","sortKey":"\u3042\u3051\u306e\u3053\u3068\u3046\u306e\u3048\u3042\u3051\u3068\u3089\u3080","locale":"ja_jp"},{"id":"CodeLayerd","name":"\u30b3\u30fc\u30c9\uff1a\u30ec\u30a4\u30e4\u30fc\u30c9","className":"CodeLayerd","superClassName":"Base","sortKey":"\u3053\u304a\u3068\u308c\u3044\u3084\u3042\u3068","locale":"ja_jp"},{"id":"ColossalHunter","name":"\u30b3\u30ed\u30c3\u30b5\u30eb\u30cf\u30f3\u30bf\u30fc","className":"ColossalHunter","superClassName":"Base","sortKey":"\u3053\u308d\u3064\u3055\u308b\u306f\u3093\u305f\u3042","locale":"ja_jp"},{"id":"EndBreaker","name":"\u30a8\u30f3\u30c9\u30d6\u30ec\u30a4\u30ab\u30fc\uff01","className":"EndBreaker","superClassName":"Base","sortKey":"\u3048\u3093\u3068\u3075\u308c\u3044\u304b\u3042","locale":"ja_jp"},{"id":"EtrianOdysseySRS","name":"\u4e16\u754c\u6a39\u306e\u8ff7\u5baeSRS","className":"EtrianOdysseySRS","superClassName":"SRS","sortKey":"\u305b\u304b\u3044\u3057\u3086\u306e\u3081\u3044\u304d\u3086\u3046SRS","locale":"ja_jp"},{"id":"FateCoreSystem","name":"Fate Core System","className":"FateCoreSystem","superClassName":"Base","sortKey":"\u3075\u3048\u3044\u3068\u3053\u3042\u3057\u3059\u3066\u3080","locale":"ja_jp"},{"id":"AlchemiaStruggle","name":"\u30a2\u30eb\u30b1\u30df\u30a2\u30fb\u30b9\u30c8\u30e9\u30b0\u30eb","className":"AlchemiaStruggle","superClassName":"Base","sortKey":"\u3042\u308b\u3051\u307f\u3042\u3059\u3068\u3089\u304f\u308b","locale":"ja_jp"},{"id":"Fiasco","name":"\u30d5\u30a3\u30a2\u30b9\u30b3","className":"Fiasco","superClassName":"Base","sortKey":"\u3075\u3044\u3042\u3059\u3053","locale":"ja_jp"},{"id":"Comes","name":"\u30ab\u30e0\u30ba","className":"Comes","superClassName":"Base","sortKey":"\u304b\u3080\u3059","locale":"ja_jp"},{"id":"ConvictorDrive","name":"\u30b3\u30f3\u30f4\u30a3\u30af\u30bf\u30fc\u30fb\u30c9\u30e9\u30a4\u30d6","className":"ConvictorDrive","superClassName":"Base","sortKey":"\u3053\u3093\u3046\u3044\u304f\u305f\u3042\u3068\u3089\u3044\u3075","locale":"ja_jp"},{"id":"CrashWorld","name":"\u589c\u843d\u4e16\u754c","className":"CrashWorld","superClassName":"Base","sortKey":"\u3064\u3044\u3089\u304f\u305b\u304b\u3044","locale":"ja_jp"},{"id":"Fiasco:Korean","name":"\ud53c\uc544\uc2a4\ucf54","className":"Fiasco_Korean","superClassName":"Fiasco","sortKey":"\u56fd\u969b\u5316:Korean:\ud53c\uc544\uc2a4\ucf54","locale":"ko_kr"},{"id":"FilledWith","name":"\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba","className":"FilledWith","superClassName":"Base","sortKey":"\u3075\u3044\u308b\u3068\u3046\u3044\u3059","locale":"ja_jp"},{"id":"Cthulhu","name":"\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG","className":"Cthulhu","superClassName":"Base","sortKey":"\u304f\u3068\u3046\u308b\u3075\u3057\u3093\u308fTRPG","locale":"ja_jp"},{"id":"VisionConnect","name":"\u30f4\u30a3\u30b8\u30e7\u30f3\u30b3\u30cd\u30af\u30c8","className":"VisionConnect","superClassName":"Base","sortKey":"\u3046\u3044\u3057\u3088\u3093\u3053\u306d\u304f\u3068","locale":"ja_jp"},{"id":"WARPS","name":"\u30ef\u30fc\u30d7\u30b9","className":"WARPS","superClassName":"Base","sortKey":"\u308f\u3042\u3075\u3059","locale":"ja_jp"},{"id":"WaresBlade","name":"\u30ef\u30fc\u30b9\u30d6\u30ec\u30a4\u30c9","className":"WaresBlade","superClassName":"Base","sortKey":"\u308f\u3042\u3059\u3075\u308c\u3044\u3068","locale":"ja_jp"},{"id":"Alsetto","name":"\u8a69\u7247\u306e\u30a2\u30eb\u30bb\u30c3\u30c8","className":"Alsetto","superClassName":"Base","sortKey":"\u3046\u305f\u304b\u305f\u306e\u3042\u308b\u305b\u3064\u3068","locale":"ja_jp"},{"id":"ScreamHighSchool","name":"\u30b9\u30af\u30ea\u30fc\u30e0\u30cf\u30a4\u30b9\u30af\u30fc\u30eb","className":"ScreamHighSchool","superClassName":"GardenOrder","sortKey":"\u3059\u304f\u308a\u3044\u3080\u306f\u3044\u3059\u304f\u3046\u308b","locale":"ja_jp"},{"id":"Alshard","name":"\u30a2\u30eb\u30b7\u30e3\u30fc\u30c9","className":"Alshard","superClassName":"SRS","sortKey":"\u3042\u308b\u3057\u3084\u3042\u3068","locale":"ja_jp"},{"id":"SRS","name":"\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0","className":"SRS","superClassName":"Base","sortKey":"\u3059\u305f\u3093\u305f\u3042\u3068RPG\u3057\u3059\u3066\u3080","locale":"ja_jp"},{"id":"Sengensyou","name":"\u5343\u5e7b\u6284","className":"Sengensyou","superClassName":"Base","sortKey":"\u305b\u3093\u3051\u3093\u3057\u3088\u3046","locale":"ja_jp"},{"id":"SevenFortressMobius","name":"\u30bb\u30d6\u30f3\uff1d\u30d5\u30a9\u30fc\u30c8\u30ec\u30b9 \u30e1\u30d3\u30a6\u30b9","className":"SevenFortressMobius","superClassName":"NightWizard","sortKey":"\u305b\u3075\u3093\u3075\u304a\u304a\u3068\u308c\u3059\u3081\u3072\u3046\u3059","locale":"ja_jp"},{"id":"ShadowRun","name":"\u30b7\u30e3\u30c9\u30a6\u30e9\u30f3","className":"ShadowRun","superClassName":"Base","sortKey":"\u3057\u3084\u3068\u3046\u3089\u3093","locale":"ja_jp"},{"id":"ShadowRun4","name":"\u30b7\u30e3\u30c9\u30a6\u30e9\u30f3 4th Edition","className":"ShadowRun4","superClassName":"Base","sortKey":"\u3057\u3084\u3068\u3046\u3089\u30934","locale":"ja_jp"},{"id":"ShadowRun5","name":"\u30b7\u30e3\u30c9\u30a6\u30e9\u30f3 5th Edition","className":"ShadowRun5","superClassName":"ShadowRun4","sortKey":"\u3057\u3084\u3068\u3046\u3089\u30935","locale":"ja_jp"},{"id":"Cthulhu7th","name":"\u65b0\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG","className":"Cthulhu7th","superClassName":"Base","sortKey":"\u3057\u3093\u304f\u3068\u3046\u308b\u3075\u3057\u3093\u308fTRPG","locale":"ja_jp"},{"id":"Warhammer","name":"\u30a6\u30a9\u30fc\u30cf\u30f3\u30de\u30fc","className":"Warhammer","superClassName":"Base","sortKey":"\u3046\u304a\u304a\u306f\u3093\u307e\u3042","locale":"ja_jp"},{"id":"SharedFantasia","name":"Shared\u2020Fantasia","className":"SharedFantasia","superClassName":"Base","sortKey":"\u3057\u3048\u3042\u3042\u3068\u3075\u3042\u3093\u305f\u3057\u3042","locale":"ja_jp"},{"id":"ShinMegamiTenseiKakuseihen","name":"\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG \u899a\u9192\u7bc7","className":"ShinMegamiTenseiKakuseihen","superClassName":"Base","sortKey":"\u3057\u3093\u3081\u304b\u307f\u3066\u3093\u305b\u3044TRPG\u304b\u304f\u305b\u3044\u3078\u3093","locale":"ja_jp"},{"id":"Warhammer4","name":"\u30a6\u30a9\u30fc\u30cf\u30f3\u30de\u30fcRPG\u7b2c4\u7248","className":"Warhammer4","superClassName":"Base","sortKey":"\u3046\u304a\u304a\u306f\u3093\u307e\u30424","locale":"ja_jp"},{"id":"ShinkuuGakuen","name":"\u771f\u7a7a\u5b66\u5712","className":"ShinkuuGakuen","superClassName":"Base","sortKey":"\u3057\u3093\u304f\u3046\u304b\u304f\u3048\u3093","locale":"ja_jp"},{"id":"FullMetalPanic","name":"\u30d5\u30eb\u30e1\u30bf\u30eb\u30fb\u30d1\u30cb\u30c3\u30af\uff01RPG","className":"FullMetalPanic","superClassName":"SRS","sortKey":"\u3075\u308b\u3081\u305f\u308b\u306f\u306b\u3064\u304fRPG","locale":"ja_jp"},{"id":"FutariSousa","name":"\u30d5\u30bf\u30ea\u30bd\u30a6\u30b5","className":"FutariSousa","superClassName":"Base","sortKey":"\u3075\u305f\u308a\u305d\u3046\u3055","locale":"ja_jp"},{"id":"FutariSousa:Korean","name":"\ub458\uc774\uc11c \uc218\uc0ac(\ud6c4\ud0c0\ub9ac\uc18c\uc6b0\uc0ac)","className":"FutariSousa_Korean","superClassName":"FutariSousa","sortKey":"\u56fd\u969b\u5316:Korean:\ub458\uc774\uc11c \uc218\uc0ac","locale":"ko_kr"},{"id":"Garako","name":"\u30ac\u30e9\u30b3\u3068\u7834\u754c\u306e\u5854","className":"Garako","superClassName":"Base","sortKey":"\u304b\u3089\u3053\u3068\u306f\u304b\u3044\u306e\u3068\u3046","locale":"ja_jp"},{"id":"MeikyuKingdomBasic","name":"\u8ff7\u5bae\u30ad\u30f3\u30b0\u30c0\u30e0 \u57fa\u672c\u30eb\u30fc\u30eb\u30d6\u30c3\u30af","className":"MeikyuKingdomBasic","superClassName":"MeikyuKingdom","sortKey":"\u3081\u3044\u304d\u3086\u3046\u304d\u3093\u304f\u305f\u3080\u304d\u307b\u3093\u308b\u3046\u308b\u3075\u3064\u304f","locale":"ja_jp"},{"id":"WitchQuest","name":"\u30a6\u30a3\u30c3\u30c1\u30af\u30a8\u30b9\u30c8","className":"WitchQuest","superClassName":"Base","sortKey":"\u3046\u3044\u3064\u3061\u304f\u3048\u3059\u3068","locale":"ja_jp"},{"id":"AlterRaise","name":"\u30a2\u30eb\u30c8\u30ec\u30a4\u30ba","className":"AlterRaise","superClassName":"Base","sortKey":"\u3042\u308b\u3068\u308c\u3044\u3059","locale":"ja_jp"},{"id":"WorldOfDarkness","name":"\u30ef\u30fc\u30eb\u30c9\u30fb\u30aa\u30d6\u30fb\u30c0\u30fc\u30af\u30cd\u30b9","className":"WorldOfDarkness","superClassName":"Base","sortKey":"\u308f\u3042\u308b\u3068\u304a\u3075\u305f\u3042\u304f\u306d\u3059","locale":"ja_jp"},{"id":"GehennaAn","name":"\u30b2\u30d8\u30ca\u30fb\u30a2\u30ca\u30b9\u30bf\u30b7\u30b9","className":"GehennaAn","superClassName":"Base","sortKey":"\u3051\u3078\u306a\u3042\u306a\u3059\u305f\u3057\u3059","locale":"ja_jp"},{"id":"GeishaGirlwithKatana","name":"\u30b2\u30a4\u30b7\u30e3\u30fb\u30ac\u30fc\u30eb\u30fb\u30a6\u30a3\u30ba\u30fb\u30ab\u30bf\u30ca","className":"GeishaGirlwithKatana","superClassName":"Base","sortKey":"\u3051\u3044\u3057\u3084\u304b\u3042\u308b\u3046\u3044\u3059\u304b\u305f\u306a","locale":"ja_jp"},{"id":"Amadeus","name":"\u30a2\u30de\u30c7\u30a6\u30b9","className":"Amadeus","superClassName":"Base","sortKey":"\u3042\u307e\u3066\u3046\u3059","locale":"ja_jp"},{"id":"YankeeYogSothoth","name":"\u30e4\u30f3\u30ad\u30fc\uff06\u30e8\u30b0\uff1d\u30bd\u30c8\u30fc\u30b9","className":"YankeeYogSothoth","superClassName":"Base","sortKey":"\u3084\u3093\u304d\u3044\u3042\u3093\u3068\u3088\u304f\u305d\u3068\u304a\u3059","locale":"ja_jp"},{"id":"YearZeroEngine","name":"YearZeroEngine","className":"YearZeroEngine","superClassName":"Base","sortKey":"\u3044\u3084\u3042\u305b\u308d\u3048\u3093\u3057\u3093","locale":"ja_jp"},{"id":"ShinobiGami","name":"\u30b7\u30ce\u30d3\u30ac\u30df","className":"ShinobiGami","superClassName":"Base","sortKey":"\u3057\u306e\u3072\u304b\u307f","locale":"ja_jp"},{"id":"Amadeus:Korean","name":"\uc544\ub9c8\ub370\uc6b0\uc2a4","className":"Amadeus_Korean","superClassName":"Amadeus","sortKey":"\u56fd\u969b\u5316:Korean:\uc544\ub9c8\ub370\uc6b0\uc2a4","locale":"ko_kr"},{"id":"GhostLive","name":"\u5b9f\u6cc1\u30b4\u30fc\u30b9\u30c8\u30e9\u30a4\u30f4","className":"GhostLive","superClassName":"Base","sortKey":"\u3057\u3064\u304d\u3088\u3046\u3053\u304a\u3059\u3068\u3089\u3044\u3075","locale":"ja_jp"},{"id":"AngelGear","name":"\u30a8\u30f3\u30bc\u30eb\u30ae\u30a2 \u5929\u4f7f\u5927\u6226TRPG The 2nd Editon","className":"AngelGear","superClassName":"Base","sortKey":"\u3048\u3093\u305b\u308b\u304d\u30422","locale":"ja_jp"},{"id":"GoblinSlayer","name":"\u30b4\u30d6\u30ea\u30f3\u30b9\u30ec\u30a4\u30e4\u30fcTRPG","className":"GoblinSlayer","superClassName":"Base","sortKey":"\u3053\u3075\u308a\u3093\u3059\u308c\u3044\u3084\u3042TRPG","locale":"ja_jp"},{"id":"Shiranui","name":"\u4e0d\u77e5\u706b","className":"Shiranui","superClassName":"Base","sortKey":"\u3057\u3089\u306c\u3044","locale":"ja_jp"},{"id":"AnimaAnimus","name":"\u30a2\u30cb\u30de\u30a2\u30cb\u30e0\u30b9","className":"AnimaAnimus","superClassName":"Base","sortKey":"\u3042\u306b\u307e\u3042\u306b\u3080\u3059","locale":"ja_jp"},{"id":"Yggdrasill","name":"\u92fc\u9244\u306e\u30e6\u30b0\u30c9\u30e9\u30b7\u30eb","className":"Yggdrasill","superClassName":"Base","sortKey":"\u3053\u3046\u3066\u3064\u306e\u3086\u304f\u3068\u3089\u3057\u308b","locale":"ja_jp"},{"id":"Aoharubaan","name":"\u3042\u304a\u306f\u308b\u3070\u30fc\u3093\u3063","className":"Aoharubaan","superClassName":"Base","sortKey":"\u3042\u304a\u306f\u308b\u306f\u3042\u3093\u3064","locale":"ja_jp"},{"id":"ShuumatsuKikou","name":"\u7d42\u672b\u7d00\u884c\uff32\uff30\uff27","className":"ShuumatsuKikou","superClassName":"Base","sortKey":"\u3057\u3086\u3046\u307e\u3064\u304d\u3053\u3046","locale":"ja_jp"},{"id":"Cthulhu7th:ChineseTraditional","name":"\u514b\u8607\u9b6f\u795e\u8a71\u7b2c7\u7248","className":"Cthulhu7th_ChineseTraditional","superClassName":"Base","sortKey":"\u56fd\u969b\u5316:Chinese Traditional:\u514b\u8607\u9b6f\u795e\u8a71\u7b2c7\u7248","locale":"ja_jp"},{"id":"GoldenSkyStories","name":"\u3086\u3046\u3084\u3051\u3053\u3084\u3051","className":"GoldenSkyStories","superClassName":"Base","sortKey":"\u3086\u3046\u3084\u3051\u3053\u3084\u3051","locale":"ja_jp"},{"id":"Skynauts","name":"\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb\uff08\u516d\u7573\u9593\u5e7b\u60f3\u7a7a\u9593\uff09","className":"Skynauts","superClassName":"Base","sortKey":"\u306f\u304f\u308b\u307e\u306e\u3068\u3046\u306e\u3059\u304b\u3044\u306e\u304a\u3064","locale":"ja_jp"},{"id":"Gorilla","name":"\u30b4\u30ea\u30e9TRPG","className":"Gorilla","superClassName":"Base","sortKey":"\u3053\u308a\u3089TRPG","locale":"ja_jp"},{"id":"GranCrest","name":"\u30b0\u30e9\u30f3\u30af\u30ec\u30b9\u30c8RPG","className":"GranCrest","superClassName":"Base","sortKey":"\u304f\u3089\u3093\u304f\u308c\u3059\u3068RPG","locale":"ja_jp"},{"id":"Gundog","name":"\u30ac\u30f3\u30c9\u30c3\u30b0","className":"Gundog","superClassName":"Base","sortKey":"\u304b\u3093\u3068\u3064\u304f","locale":"ja_jp"},{"id":"Arianrhod","name":"\u30a2\u30ea\u30a2\u30f3\u30ed\u30c3\u30c9RPG","className":"Arianrhod","superClassName":"Base","sortKey":"\u3042\u308a\u3042\u3093\u308d\u3064\u3068RPG","locale":"ja_jp"},{"id":"Cthulhu7th:Korean","name":"\ud06c\ud234\ub8e8\uc758 \ubd80\ub984 7\ud310","className":"Cthulhu7th_Korean","superClassName":"Base","sortKey":"\u56fd\u969b\u5316:Korean:\ud06c\ud234\ub8e8\uc758 \ubd80\ub984 7\ud310","locale":"ja_jp"},{"id":"CthulhuTech","name":"\u30af\u30c8\u30a5\u30eb\u30d5\u30c6\u30c3\u30af","className":"CthulhuTech","superClassName":"Base","sortKey":"\u304f\u3068\u3046\u308b\u3075\u3066\u3064\u304f","locale":"ja_jp"},{"id":"ArsMagica","name":"\u30a2\u30eb\u30b9\u30de\u30ae\u30ab","className":"ArsMagica","superClassName":"Base","sortKey":"\u3042\u308b\u3059\u307e\u304d\u304b","locale":"ja_jp"},{"id":"GundogRevised","name":"\u30ac\u30f3\u30c9\u30c3\u30b0\u30fb\u30ea\u30f4\u30a1\u30a4\u30ba\u30c9","className":"GundogRevised","superClassName":"Base","sortKey":"\u304b\u3093\u3068\u3064\u304f\u308a\u3046\u3042\u3044\u3059\u3068","locale":"ja_jp"},{"id":"GundogZero","name":"\u30ac\u30f3\u30c9\u30c3\u30b0\u30bc\u30ed","className":"GundogZero","superClassName":"Gundog","sortKey":"\u304b\u3093\u3068\u3064\u304f\u305b\u308d","locale":"ja_jp"},{"id":"MetalHead","name":"\u30e1\u30bf\u30eb\u30d8\u30c3\u30c9","className":"MetalHead","superClassName":"Base","sortKey":"\u3081\u305f\u308b\u3078\u3064\u3068","locale":"ja_jp"},{"id":"GURPS","name":"\u30ac\u30fc\u30d7\u30b9","className":"GURPS","superClassName":"Base","sortKey":"\u304b\u3042\u3075\u3059","locale":"ja_jp"},{"id":"GurpsFW","name":"\u30ac\u30fc\u30d7\u30b9\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba","className":"GurpsFW","superClassName":"Base","sortKey":"\u304b\u3042\u3075\u3059\u3075\u3044\u308b\u3068\u3046\u3044\u3059","locale":"ja_jp"},{"id":"AssaultEngine","name":"\u30a2\u30b5\u30eb\u30c8\u30a8\u30f3\u30b8\u30f3","className":"AssaultEngine","superClassName":"Base","sortKey":"\u3042\u3055\u308b\u3068\u3048\u3093\u3057\u3093","locale":"ja_jp"},{"id":"MetalHeadExtream","name":"\u30e1\u30bf\u30eb\u30d8\u30c3\u30c9\u30a8\u30af\u30b9\u30c8\u30ea\u30fc\u30e0","className":"MetalHeadExtream","superClassName":"Base","sortKey":"\u3081\u305f\u308b\u3078\u3064\u3068\u3048\u304f\u3059\u3068\u308a\u3044\u3080","locale":"ja_jp"},{"id":"SkynautsBouken","name":"\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb\uff08\u5192\u967a\u4f01\u753b\u5c40\uff09","className":"SkynautsBouken","superClassName":"Base","sortKey":"\u306f\u304f\u308b\u307e\u306e\u3068\u3046\u306e\u3059\u304b\u3044\u306e\u304a\u30642","locale":"ja_jp"},{"id":"Cthulhu:ChineseTraditional","name":"\u514b\u8607\u9b6f\u795e\u8a71","className":"Cthulhu_ChineseTraditional","superClassName":"Cthulhu","sortKey":"\u56fd\u969b\u5316:Chinese Traditional:\u514b\u8607\u9b6f\u795e\u8a71","locale":"zh_hant"},{"id":"Avandner","name":"\u9ed2\u7d62\u306e\u30a2\u30f4\u30a1\u30f3\u30c9\u30ca\u30fc","className":"Avandner","superClassName":"Base","sortKey":"\u3053\u3064\u3051\u3093\u306e\u3042\u3046\u3042\u3093\u3068\u306a\u3042","locale":"ja_jp"},{"id":"Cthulhu:Korean","name":"\ud06c\ud234\ub8e8","className":"Cthulhu_Korean","superClassName":"Cthulhu","sortKey":"\u56fd\u969b\u5316:Korean:\ud06c\ud234\ub8e8","locale":"ko_kr"},{"id":"Ayabito","name":"\u3042\u3084\u3073\u3068","className":"Ayabito","superClassName":"Base","sortKey":"\u3042\u3084\u3072\u3068","locale":"ja_jp"},{"id":"CyberpunkRed","name":"\u30b5\u30a4\u30d0\u30fc\u30d1\u30f3\u30afRED (\u30d1\u30c3\u30c1\u7248)","className":"CyberpunkRed","superClassName":"Base","sortKey":"\u3055\u3044\u306f\u3042\u306f\u3093\u304f\u308c\u3064\u3068","locale":"ja_jp"},{"id":"Cthulhu:SimplifiedChinese","name":"\u514b\u82cf\u9c81\u7684\u547c\u5524 \u7b2c\u516d\u7248","className":"Cthulhu_SimplifiedChinese","superClassName":"Cthulhu","sortKey":"\u56fd\u969b\u5316:Simplified Chinese:\u514b\u82cf\u9c81\u7684\u547c\u5524 \u7b2c\u516d\u7248","locale":"zh_hans"},{"id":"ZettaiReido","name":"\u7d76\u5bfe\u96b7\u5974","className":"ZettaiReido","superClassName":"Base","sortKey":"\u305b\u3064\u305f\u3044\u308c\u3044\u3068","locale":"ja_jp"},{"id":"Bakenokawa","name":"\u30d0\u30b1\u30ce\u30ab\u30ef","className":"Bakenokawa","superClassName":"Base","sortKey":"\u306f\u3051\u306e\u304b\u308f","locale":"ja_jp"},{"id":"BBN","name":"BBNTRPG","className":"BBN","superClassName":"Base","sortKey":"\u3072\u3044\u3072\u3044\u3048\u306cTRPG","locale":"ja_jp"},{"id":"HarnMaster","name":"\u30cf\u30fc\u30f3\u30de\u30b9\u30bf\u30fc","className":"HarnMaster","superClassName":"Base","sortKey":"\u306f\u3042\u3093\u307e\u3059\u305f\u3042","locale":"ja_jp"},{"id":"StarryDolls","name":"\u30b9\u30bf\u30ea\u30a3\u30c9\u30fc\u30eb","className":"StarryDolls","superClassName":"Base","sortKey":"\u3059\u305f\u308a\u3044\u3068\u304a\u308b","locale":"ja_jp"},{"id":"SteamPunkers","name":"\u30b9\u30c1\u30fc\u30e0\u30d1\u30f3\u30ab\u30fc\u30ba","className":"SteamPunkers","superClassName":"Base","sortKey":"\u3059\u3061\u3044\u3080\u306f\u3093\u304b\u3042\u3059","locale":"ja_jp"},{"id":"BadLife","name":"\u30d0\u30c3\u30c9\u30e9\u30a4\u30d5","className":"BadLife","superClassName":"Base","sortKey":"\u306f\u3064\u3068\u3089\u3044\u3075","locale":"ja_jp"},{"id":"HatsuneMiku","name":"\u521d\u97f3\u30df\u30afTRPG \u30b3\u30b3\u30ed\u30c0\u30f3\u30b8\u30e7\u30f3","className":"HatsuneMiku","superClassName":"Base","sortKey":"\u306f\u3064\u306d\u307f\u304fTRPG\u3053\u3053\u308d\u305f\u3093\u3057\u3088\u3093","locale":"ja_jp"},{"id":"StellarKnights","name":"\u9280\u5263\u306e\u30b9\u30c6\u30e9\u30ca\u30a4\u30c4","className":"StellarKnights","superClassName":"Base","sortKey":"\u304d\u3093\u3051\u3093\u306e\u3059\u3066\u3089\u306a\u3044\u3064","locale":"ja_jp"},{"id":"StellarKnights:Korean","name":"\uc740\uac80\uc758 \uc2a4\ud154\ub77c\ub098\uc774\uce20","className":"StellarKnights_Korean","superClassName":"StellarKnights","sortKey":"\u56fd\u969b\u5316:Korean:\uc740\uac80\uc758 \uc2a4\ud154\ub77c\ub098\uc774\uce20","locale":"ko_kr"},{"id":"BarnaKronika","name":"\u30d0\u30eb\u30ca\u30fb\u30af\u30ed\u30cb\u30ab","className":"BarnaKronika","superClassName":"Base","sortKey":"\u306f\u308b\u306a\u304f\u308d\u306b\u304b","locale":"ja_jp"},{"id":"Hieizan","name":"\u6bd4\u53e1\u5c71\u708e\u4e0a","className":"Hieizan","superClassName":"Base","sortKey":"\u3072\u3048\u3044\u3055\u3093\u3048\u3093\u3057\u3088\u3046","locale":"ja_jp"},{"id":"HouraiGakuen","name":"\u84ec\u83b1\u5b66\u5712\u306e\u5192\u967a!!","className":"HouraiGakuen","superClassName":"Base","sortKey":"\u307b\u3046\u3089\u3044\u304b\u304f\u3048\u3093\u306e\u307b\u3046\u3051\u3093","locale":"ja_jp"},{"id":"MonotoneMuseum","name":"\u30e2\u30ce\u30c8\u30fc\u30f3\u30df\u30e5\u30fc\u30b8\u30a2\u30e0RPG","className":"MonotoneMuseum","superClassName":"Base","sortKey":"\u3082\u306e\u3068\u304a\u3093\u307f\u3086\u3046\u3057\u3042\u3080RPG","locale":"ja_jp"},{"id":"DarkBlaze","name":"\u30c0\u30fc\u30af\u30d6\u30ec\u30a4\u30ba","className":"DarkBlaze","superClassName":"Base","sortKey":"\u305f\u3042\u304f\u3075\u308c\u3044\u3059","locale":"ja_jp"},{"id":"MonotoneMuseum:Korean","name":"\ubaa8\ub178\ud1a4 \ubba4\uc9c0\uc5c4","className":"MonotoneMuseum_Korean","superClassName":"MonotoneMuseum","sortKey":"\u56fd\u969b\u5316:Korean:\ubaa8\ub178\ud1a4 \ubba4\uc9c0\uc5c4","locale":"ko_kr"},{"id":"Nechronica","name":"\u30cd\u30af\u30ed\u30cb\u30ab","className":"Nechronica","superClassName":"Base","sortKey":"\u306d\u304f\u308d\u306b\u304b","locale":"ja_jp"},{"id":"MetallicGuardian","name":"\u30e1\u30bf\u30ea\u30c3\u30af\u30ac\u30fc\u30c7\u30a3\u30a2\u30f3RPG","className":"MetallicGuardian","superClassName":"SRS","sortKey":"\u3081\u305f\u308a\u3064\u304f\u304b\u3042\u3066\u3044\u3042\u3093RPG","locale":"ja_jp"},{"id":"StellarLife","name":"\u30b9\u30c6\u30e9\u30fc\u30e9\u30a4\u30d5TRPG","className":"StellarLife","superClassName":"Base","sortKey":"\u3059\u3066\u3089\u3042\u3089\u3044\u3075TRPG","locale":"ja_jp"},{"id":"StrangerOfSwordCity","name":"\u5263\u306e\u8857\u306e\u7570\u90a6\u4ebaTRPG","className":"StrangerOfSwordCity","superClassName":"Base","sortKey":"\u3064\u308b\u304d\u306e\u307e\u3061\u306e\u3044\u307b\u3046\u3057\u3093TRPG","locale":"ja_jp"},{"id":"Nechronica:Korean","name":"\ub124\ud06c\ub85c\ub2c8\uce74","className":"Nechronica_Korean","superClassName":"Nechronica","sortKey":"\u56fd\u969b\u5316:Korean:\ub124\ud06c\ub85c\ub2c8\uce74","locale":"ko_kr"},{"id":"NeverCloud","name":"\u30cd\u30d0\u30fc\u30af\u30e9\u30a6\u30c9TRPG","className":"NeverCloud","superClassName":"Base","sortKey":"\u306d\u306f\u3042\u304f\u3089\u3046\u3068TRPG","locale":"ja_jp"},{"id":"StratoShout:Korean","name":"\uc2a4\ud2b8\ub77c\ud1a0 \uc0e4\uc6b0\ud2b8","className":"StratoShout_Korean","superClassName":"StratoShout","sortKey":"\u56fd\u969b\u5316:Korean:\uc2a4\ud2b8\ub77c\ud1a0 \uc0e4\uc6b0\ud2b8","locale":"ko_kr"},{"id":"StratoShout","name":"\u30b9\u30c8\u30e9\u30c8\u30b7\u30e3\u30a6\u30c8","className":"StratoShout","superClassName":"Base","sortKey":"\u3059\u3068\u3089\u3068\u3057\u3084\u3046\u3068","locale":"ja_jp"},{"id":"BattleTech","name":"\u30d0\u30c8\u30eb\u30c6\u30c3\u30af","className":"BattleTech","superClassName":"Base","sortKey":"\u306f\u3068\u308b\u3066\u3064\u304f","locale":"ja_jp"},{"id":"DarkDaysDrive","name":"\u30c0\u30fc\u30af\u30c7\u30a4\u30ba\u30c9\u30e9\u30a4\u30d6","className":"DarkDaysDrive","superClassName":"Base","sortKey":"\u305f\u3042\u304f\u3066\u3044\u3059\u3068\u3089\u3044\u3075","locale":"ja_jp"},{"id":"NightWizard","name":"\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 2nd Edition","className":"NightWizard","superClassName":"Base","sortKey":"\u306a\u3044\u3068\u3046\u3044\u3055\u3042\u30682","locale":"ja_jp"},{"id":"DarkSouls","name":"\u30c0\u30fc\u30af\u30bd\u30a6\u30ebTRPG","className":"DarkSouls","superClassName":"Base","sortKey":"\u305f\u3042\u304f\u305d\u3046\u308bTRPG","locale":"ja_jp"},{"id":"SwordWorld","name":"\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c9RPG","className":"SwordWorld","superClassName":"Base","sortKey":"\u305d\u304a\u3068\u308f\u3042\u308b\u3068","locale":"ja_jp"},{"id":"Strave","name":"\u78a7\u7a7a\u306e\u30b9\u30c8\u30ec\u30a4\u30f4","className":"Strave","superClassName":"Base","sortKey":"\u3078\u304d\u304f\u3046\u306e\u3059\u3068\u308c\u3044\u3075","locale":"ja_jp"},{"id":"DeadlineHeroes","name":"\u30c7\u30c3\u30c9\u30e9\u30a4\u30f3\u30d2\u30fc\u30ed\u30fc\u30baRPG","className":"DeadlineHeroes","superClassName":"Base","sortKey":"\u3066\u3064\u3068\u3089\u3044\u3093\u3072\u3044\u308d\u304a\u3059RPG","locale":"ja_jp"},{"id":"HuntersMoon","name":"\u30cf\u30f3\u30bf\u30fc\u30ba\u30fb\u30e0\u30fc\u30f3","className":"HuntersMoon","superClassName":"Base","sortKey":"\u306f\u3093\u305f\u3042\u3059\u3080\u3046\u3093","locale":"ja_jp"},{"id":"HunterTheReckoning5th","name":"Hunter: The Reckoning 5th Edition","className":"HunterTheReckoning5th","superClassName":"Base","sortKey":"\u306f\u3093\u3042\u305f\u3055\u308c\u3053\u306b\u3093\u304f5","locale":"ja_jp"},{"id":"NightWizard3rd","name":"\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 3rd Edition","className":"NightWizard3rd","superClassName":"NightWizard","sortKey":"\u306a\u3044\u3068\u3046\u3044\u3055\u3042\u30683","locale":"ja_jp"},{"id":"NightmareHunterDeep","name":"\u30ca\u30a4\u30c8\u30e1\u30a2\u30cf\u30f3\u30bf\u30fc=\u30c7\u30a3\u30fc\u30d7","className":"NightmareHunterDeep","superClassName":"Base","sortKey":"\u306a\u3044\u3068\u3081\u3042\u306f\u3093\u305f\u3042\u3066\u3044\u3044\u3075","locale":"ja_jp"},{"id":"NinjaSlayer","name":"\u30cb\u30f3\u30b8\u30e3\u30b9\u30ec\u30a4\u30e4\u30fcTRPG","className":"NinjaSlayer","superClassName":"Base","sortKey":"\u306b\u3093\u3057\u3084\u3059\u308c\u3044\u3084\u3042RPG","locale":"ja_jp"},{"id":"IfIfIf","name":"\u30a4\u30d5\u30fb\u30a4\u30d5\u30fb\u30a4\u30d5","className":"IfIfIf","superClassName":"Base","sortKey":"\u3044\u3075\u3044\u3075\u3044\u3075","locale":"ja_jp"},{"id":"DemonParasite","name":"\u30c7\u30e2\u30f3\u30d1\u30e9\u30b5\u30a4\u30c8","className":"DemonParasite","superClassName":"Base","sortKey":"\u3066\u3082\u3093\u306f\u3089\u3055\u3044\u3068","locale":"ja_jp"},{"id":"DesperateRun","name":"Desperate Run TRPG","className":"DesperateRun","superClassName":"Base","sortKey":"\u3066\u3059\u3078\u308c\u3044\u3068\u3089\u3093TRPG","locale":"ja_jp"},{"id":"NjslyrBattle","name":"NJSLYRBATTLE","className":"NjslyrBattle","superClassName":"Base","sortKey":"\u306b\u3093\u3057\u3084\u3059\u308c\u3044\u3084\u3042\u306f\u3068\u308b","locale":"ja_jp"},{"id":"DetatokoSaga","name":"\u3067\u305f\u3068\u3053\u30b5\u30fc\u30ac","className":"DetatokoSaga","superClassName":"Base","sortKey":"\u3066\u305f\u3068\u3053\u3055\u3042\u304b","locale":"ja_jp"},{"id":"NobunagasBlackCastle","name":"\u4fe1\u9577\u306e\u9ed2\u3044\u57ce","className":"NobunagasBlackCastle","superClassName":"Base","sortKey":"\u306e\u3075\u306a\u304b\u306e\u304f\u308d\u3044\u3057\u308d","locale":"ja_jp"},{"id":"BeastBindTrinity","name":"\u30d3\u30fc\u30b9\u30c8\u30d0\u30a4\u30f3\u30c9 \u30c8\u30ea\u30cb\u30c6\u30a3","className":"BeastBindTrinity","superClassName":"Base","sortKey":"\u3072\u3044\u3059\u3068\u306f\u3044\u3093\u3068\u3068\u308a\u306b\u3066\u3044","locale":"ja_jp"},{"id":"Illusio","name":"\u6643\u5929\u306e\u30a4\u30eb\u30fc\u30b8\u30aa","className":"Illusio","superClassName":"Base","sortKey":"\u3053\u3046\u3066\u3093\u306e\u3044\u308b\u3046\u3057\u304a","locale":"ja_jp"},{"id":"SwordWorld2.0","name":"\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.0","className":"SwordWorld2_0","superClassName":"SwordWorld","sortKey":"\u305d\u304a\u3068\u308f\u3042\u308b\u30682.0","locale":"ja_jp"},{"id":"DetatokoSaga:Korean","name":"\ub370\ud0c0\ud1a0\ucf54 \uc0ac\uac00","className":"DetatokoSaga_Korean","superClassName":"DetatokoSaga","sortKey":"\u56fd\u969b\u5316:Korean:\ub370\ud0c0\ud1a0\ucf54 \uc0ac\uac00","locale":"ko_kr"},{"id":"DiceOfTheDead","name":"\u30c0\u30a4\u30b9\u30fb\u30aa\u30d6\u30fb\u30b6\u30fb\u30c7\u30c3\u30c9","className":"DiceOfTheDead","superClassName":"Base","sortKey":"\u305f\u3044\u3059\u304a\u3075\u3055\u3066\u3064\u3068","locale":"ja_jp"},{"id":"NSSQ","name":"SRS\u3058\u3083\u306a\u3044\u4e16\u754c\u6a39\u306e\u8ff7\u5baeTRPG","className":"NSSQ","superClassName":"Base","sortKey":"\u3048\u3059\u3042\u3042\u308b\u3048\u3059\u3057\u3084\u306a\u3044\u305b\u304b\u3044\u3057\u3086\u306e\u3081\u3044\u304d\u3086\u3046TRPG","locale":"ja_jp"},{"id":"InfiniteBabeL","name":"\u5c11\u5e74\u306e\u305f\u3081\u306e\u5c11\u5973\u5c55\u721b\u4f1a\u7570\u805e Infinite BabeL","className":"InfiniteBabeL","superClassName":"ShoujoTenrankai","sortKey":"\u3057\u3088\u3046\u306d\u3093\u306e\u305f\u3081\u306e\u3057\u3088\u3046\u3057\u3088\u3066\u3093\u3089\u3093\u304b\u3044\u3044\u3075\u3093\u3044\u3093\u3075\u3044\u306b\u3064\u3068\u306f\u3078\u308b","locale":"ja_jp"},{"id":"ShoujoTenrankai","name":"\u5c11\u5973\u5c55\u721b\u4f1aTRPG","className":"ShoujoTenrankai","superClassName":"Base","sortKey":"\u3057\u3088\u3046\u3057\u3088\u3066\u3093\u3089\u3093\u304b\u3044TRPG","locale":"ja_jp"},{"id":"DoubleCross","name":"\u30c0\u30d6\u30eb\u30af\u30ed\u30b92nd,3rd","className":"DoubleCross","superClassName":"Base","sortKey":"\u305f\u3075\u308b\u304f\u308d\u30592","locale":"ja_jp"},{"id":"InfiniteFantasia","name":"\u7121\u9650\u306e\u30d5\u30a1\u30f3\u30bf\u30b8\u30a2","className":"InfiniteFantasia","superClassName":"Base","sortKey":"\u3080\u3051\u3093\u306e\u3075\u3042\u3093\u305f\u3057\u3042","locale":"ja_jp"},{"id":"Insane","name":"\u30a4\u30f3\u30bb\u30a4\u30f3","className":"Insane","superClassName":"Base","sortKey":"\u3044\u3093\u305b\u3044\u3093","locale":"ja_jp"},{"id":"OneWayHeroics","name":"\u7247\u9053\u52c7\u8005TRPG","className":"OneWayHeroics","superClassName":"Base","sortKey":"\u304b\u305f\u307f\u3061\u3086\u3046\u3057\u3084TRPG","locale":"ja_jp"},{"id":"BeginningIdol","name":"\u30d3\u30ae\u30cb\u30f3\u30b0\u30a2\u30a4\u30c9\u30eb","className":"BeginningIdol","superClassName":"Base","sortKey":"\u3072\u304d\u306b\u3093\u304f\u3042\u3044\u3068\u308b","locale":"ja_jp"},{"id":"Insane:Korean","name":"\uc778\uc138\uc778","className":"Insane_Korean","superClassName":"Insane","sortKey":"\u56fd\u969b\u5316:Korean:\uc778\uc138\uc778","locale":"ko_kr"},{"id":"Irisbane","name":"\u77b3\u9038\u3089\u3055\u306c\u30a4\u30ea\u30b9\u30d9\u30a4\u30f3","className":"Irisbane","superClassName":"Base","sortKey":"\u3072\u3068\u307f\u305d\u3089\u3055\u306c\u3044\u308a\u3059\u3078\u3044\u3093","locale":"ja_jp"},{"id":"SwordWorld:SimplifiedChinese","name":"\u5251\u4e16\u754c","className":"SwordWorld_SimplifiedChinese","superClassName":"SwordWorld","sortKey":"\u56fd\u969b\u5316:Simplified Chinese:\u5251\u4e16\u754c","locale":"zh_hans"},{"id":"SwordWorld2.0:SimplifiedChinese","name":"\u5251\u4e16\u754c2.0","className":"SwordWorld2_0_SimplifiedChinese","superClassName":"SwordWorld2_0","sortKey":"\u56fd\u969b\u5316:Simplified Chinese:\u5251\u4e16\u754c2.0","locale":"zh_hans"},{"id":"SwordWorld2.5:SimplifiedChinese","name":"\u5251\u4e16\u754c2.5","className":"SwordWorld2_5_SimplifiedChinese","superClassName":"SwordWorld2_5","sortKey":"\u56fd\u969b\u5316:Simplified Chinese:\u5251\u4e16\u754c2.5","locale":"zh_hans"},{"id":"Nuekagami","name":"\u9d7a\u93e1","className":"Nuekagami","superClassName":"Base","sortKey":"\u306c\u3048\u304b\u304b\u307f","locale":"ja_jp"},{"id":"TalesFromTheLoop","name":"\u30b6\u30fb\u30eb\u30fc\u30d7TRPG","className":"TalesFromTheLoop","superClassName":"Base","sortKey":"\u3055\u308b\u3046\u3075TRPG","locale":"ja_jp"},{"id":"SwordWorld2.5","name":"\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.5","className":"SwordWorld2_5","superClassName":"SwordWorld2_0","sortKey":"\u305d\u304a\u3068\u308f\u3042\u308b\u30682.5","locale":"ja_jp"},{"id":"DiceBot","name":"DiceBot","className":"DiceBot","superClassName":"Base","sortKey":"*\u305f\u3044\u3059\u307b\u3064\u3068","locale":"ja_jp"},{"id":"IthaWenUa","name":"\u30a4\u30b5\u30fc\u30fb\u30a6\u30a7\u30f3\uff1d\u30a2\u30fc","className":"IthaWenUa","superClassName":"Base","sortKey":"\u3044\u3055\u3042\u3046\u3048\u3093\u3042\u3042","locale":"ja_jp"},{"id":"JamesBond","name":"\u30b8\u30a7\u30fc\u30e0\u30ba\u30fb\u30dc\u30f3\u30c9007","className":"JamesBond","superClassName":"Base","sortKey":"\u3057\u3048\u3048\u3080\u3059\u307b\u3093\u3068007","locale":"ja_jp"},{"id":"JuinKansen","name":"\u546a\u5370\u611f\u67d3","className":"JuinKansen","superClassName":"Base","sortKey":"\u3057\u3086\u3044\u3093\u304b\u3093\u305b\u3093","locale":"ja_jp"},{"id":"Kamigakari","name":"\u795e\u6211\u72e9","className":"Kamigakari","superClassName":"Base","sortKey":"\u304b\u307f\u304b\u304b\u308a","locale":"ja_jp"},{"id":"DoubleCross:Korean","name":"\ub354\ube14\ud06c\ub85c\uc2a42nd,3rd","className":"DoubleCross_Korean","superClassName":"DoubleCross","sortKey":"\u56fd\u969b\u5316:Korean:\ub354\ube14\ud06c\ub85c\uc2a4","locale":"ko_kr"},{"id":"Dracurouge","name":"\u30c9\u30e9\u30af\u30eb\u30fc\u30b8\u30e5","className":"Dracurouge","superClassName":"Base","sortKey":"\u3068\u3089\u304f\u308b\u3046\u3057\u3086","locale":"ja_jp"},{"id":"TokyoGhostResearch","name":"\u6771\u4eac\u30b4\u30fc\u30b9\u30c8\u30ea\u30b5\u30fc\u30c1","className":"TokyoGhostResearch","superClassName":"Base","sortKey":"\u3068\u3046\u304d\u3088\u3046\u3053\u304a\u3059\u3068\u308a\u3055\u3042\u3061","locale":"ja_jp"},{"id":"JekyllAndHyde","name":"\u30b8\u30ad\u30eb\u3068\u30cf\u30a4\u30c9\u3068\u30b0\u30ea\u30c8\u30b0\u30e9","className":"JekyllAndHyde","superClassName":"DesperateRun","sortKey":"\u3057\u304d\u308b\u3068\u306f\u3044\u3068\u3068\u304f\u308a\u3068\u304f\u3089","locale":"ja_jp"},{"id":"TherapieSein","name":"\u30bb\u30e9\u30d5\u30a3\u30b6\u30a4\u30f3","className":"TherapieSein","superClassName":"Base","sortKey":"\u305b\u3089\u3075\u3044\u3055\u3044\u3093","locale":"ja_jp"},{"id":"TokumeiTenkousei","name":"\u7279\u547d\u8ee2\u653b\u751f","className":"TokumeiTenkousei","superClassName":"Base","sortKey":"\u3068\u304f\u3081\u3044\u3066\u3093\u3053\u3046\u305b\u3044","locale":"ja_jp"},{"id":"OracleEngine","name":"\u30aa\u30e9\u30af\u30eb\u30a8\u30f3\u30b8\u30f3","className":"OracleEngine","superClassName":"Base","sortKey":"\u304a\u3089\u304f\u308b\u3048\u3093\u3057\u3093","locale":"ja_jp"},{"id":"Torg","name":"\u30c8\u30fc\u30b0","className":"Torg","superClassName":"Base","sortKey":"\u3068\u304a\u304f","locale":"ja_jp"},{"id":"Kamigakari:Korean","name":"\uce74\ubbf8\uac00\uce74\ub9ac","className":"Kamigakari_Korean","superClassName":"Kamigakari","sortKey":"\u56fd\u969b\u5316:Korean:\uce74\ubbf8\uac00\uce74\ub9ac","locale":"ko_kr"},{"id":"KanColle","name":"\u8266\u3053\u308cRPG","className":"KanColle","superClassName":"Base","sortKey":"\u304b\u3093\u3053\u308cRPG","locale":"ja_jp"},{"id":"TokyoNova","name":"\u30c8\u30fc\u30ad\u30e7\u30fcN\u25ceVA","className":"TokyoNova","superClassName":"Base","sortKey":"\u3068\u304a\u304d\u3088\u304a\u306e\u306f","locale":"ja_jp"},{"id":"Karukami","name":"\u30ab\u30eb\u30ab\u30df","className":"Karukami","superClassName":"Base","sortKey":"\u304b\u308b\u304b\u307f","locale":"ja_jp"},{"id":"KemonoNoMori","name":"\u7378\u30ce\u68ee","className":"KemonoNoMori","superClassName":"Base","sortKey":"\u3051\u3082\u306e\u306e\u3082\u308a","locale":"ja_jp"},{"id":"OrgaRain","name":"\u5728\u308a\u3066\u904d\u304f\u30aa\u30eb\u30ac\u30ec\u30a4\u30f3","className":"OrgaRain","superClassName":"Base","sortKey":"\u3042\u308a\u3066\u3042\u307e\u306d\u304f\u304a\u308b\u304b\u308c\u3044\u3093","locale":"ja_jp"},{"id":"Oukahoushin3rd","name":"\u592e\u83ef\u5c01\u795eRPG \u7b2c\u4e09\u7248","className":"Oukahoushin3rd","superClassName":"Base","sortKey":"\u304a\u3046\u304b\u307b\u3046\u3057\u3093RPG3","locale":"ja_jp"},{"id":"Paradiso","name":"\u30c1\u30a7\u30ec\u30b9\u30c6\u8272\u306e\u30d1\u30e9\u30c7\u30a3\u30fc\u30be","className":"Paradiso","superClassName":"Base","sortKey":"\u3061\u3048\u308c\u3059\u3066\u3044\u308d\u306e\u306f\u3089\u3066\u3044\u3044\u305d","locale":"ja_jp"},{"id":"KillDeathBusiness","name":"\u30ad\u30eb\u30c7\u30b9\u30d3\u30b8\u30cd\u30b9","className":"KillDeathBusiness","superClassName":"Base","sortKey":"\u304d\u308b\u3066\u3059\u3072\u3057\u306d\u3059","locale":"ja_jp"},{"id":"Dracurouge:Korean","name":"\ub4dc\ub77c\ud06c\ub8e8\uc8fc","className":"Dracurouge_Korean","superClassName":"Dracurouge","sortKey":"\u56fd\u969b\u5316:Korean:\ub4dc\ub77c\ud06c\ub8e8\uc8fc","locale":"ko_kr"},{"id":"DungeonsAndDragons","name":"\u30c0\u30f3\u30b8\u30e7\u30f3\u30ba\uff06\u30c9\u30e9\u30b4\u30f3\u30ba","className":"DungeonsAndDragons","superClassName":"Base","sortKey":"\u305f\u3093\u3057\u3088\u3093\u3059\u3042\u3093\u3068\u3068\u3089\u3053\u3093\u3059","locale":"ja_jp"},{"id":"DungeonsAndDragons5","name":"\u30c0\u30f3\u30b8\u30e7\u30f3\u30ba\uff06\u30c9\u30e9\u30b4\u30f3\u30ba\u7b2c5\u7248","className":"DungeonsAndDragons5","superClassName":"Base","sortKey":"\u305f\u3093\u3057\u3088\u3093\u3059\u3042\u3093\u3068\u3068\u3089\u3053\u3093\u30595","locale":"ja_jp"},{"id":"Torg1.5","name":"\u30c8\u30fc\u30b01.5\u7248","className":"Torg1_5","superClassName":"Torg","sortKey":"\u3068\u304a\u304f1.5","locale":"ja_jp"},{"id":"TorgEternity","name":"\u30c8\u30fc\u30b0 \u30a8\u30bf\u30cb\u30c6\u30a3","className":"TorgEternity","superClassName":"Base","sortKey":"\u3068\u304a\u304f\u3048\u305f\u306b\u3066\u3044","locale":"ja_jp"},{"id":"EarthDawn","name":"\u30a2\u30fc\u30b9\u30c9\u30fc\u30f3","className":"EarthDawn","superClassName":"Base","sortKey":"\u3042\u3042\u3059\u3068\u304a\u3093","locale":"ja_jp"},{"id":"Paranoia","name":"\u30d1\u30e9\u30ce\u30a4\u30a2","className":"Paranoia","superClassName":"Base","sortKey":"\u306f\u3089\u306e\u3044\u3042","locale":"ja_jp"},{"id":"ParanoiaRebooted","name":"\u30d1\u30e9\u30ce\u30a4\u30a2 \u30ea\u30d6\u30fc\u30c6\u30c3\u30c9","className":"ParanoiaRebooted","superClassName":"Base","sortKey":"\u306f\u3089\u306e\u3044\u3042\u308a\u3075\u3046\u3066\u3064\u3068","locale":"ja_jp"},{"id":"ParasiteBlood","name":"\u30d1\u30e9\u30b5\u30a4\u30c8\u30d6\u30e9\u30c3\u30c9RPG","className":"ParasiteBlood","superClassName":"DemonParasite","sortKey":"\u306f\u3089\u3055\u3044\u3068\u3075\u3089\u3064\u3068RPG","locale":"ja_jp"},{"id":"KillDeathBusiness:Korean","name":"Kill Death Business (\ud55c\uad6d\uc5b4)","className":"KillDeathBusiness_Korean","superClassName":"KillDeathBusiness","sortKey":"\u56fd\u969b\u5316:Korean:Kill Death Business","locale":"ko_kr"},{"id":"KurayamiCrying","name":"\u30af\u30e9\u30e4\u30df\u30af\u30e9\u30a4\u30f3","className":"KurayamiCrying","superClassName":"Base","sortKey":"\u304f\u3089\u3084\u307f\u304f\u3089\u3044\u3093","locale":"ja_jp"},{"id":"Peekaboo","name":"\u30d4\u30fc\u30ab\u30fc\u30d6\u30fc","className":"Peekaboo","superClassName":"Base","sortKey":"\u3072\u3044\u304b\u3042\u3075\u3046","locale":"ja_jp"},{"id":"Kutulu","name":"Kutulu","className":"Kutulu","superClassName":"Base","sortKey":"\u304f\u3068\u3046\u308b\u3046","locale":"ja_jp"},{"id":"Pathfinder","name":"Pathfinder","className":"Pathfinder","superClassName":"DungeonsAndDragons","sortKey":"\u306f\u3059\u3075\u3042\u3044\u3093\u305f\u3042","locale":"ja_jp"},{"id":"PersonaO","name":"\u30da\u30eb\u30bd\u30caTRPG-O","className":"PersonaO","superClassName":"Base","sortKey":"\u3078\u308b\u305d\u306aTRPGO","locale":"ja_jp"},{"id":"Pendragon","name":"\u30da\u30f3\u30c9\u30e9\u30b4\u30f3","className":"Pendragon","superClassName":"Base","sortKey":"\u3078\u3093\u3068\u3089\u3053\u3093","locale":"ja_jp"},{"id":"LiveraDoll","name":"\u7d2b\u7e1e\u306e\u30ea\u30f4\u30e9\u30c9\u30fc\u30eb","className":"LiveraDoll","superClassName":"Base","sortKey":"\u3057\u3057\u307e\u306e\u308a\u3046\u3089\u3068\u304a\u308b","locale":"ja_jp"},{"id":"PhantasmAdventure","name":"\u30d5\u30a1\u30f3\u30bf\u30ba\u30e0\u30fb\u30a2\u30c9\u30d9\u30f3\u30c1\u30e3\u30fc","className":"PhantasmAdventure","superClassName":"Base","sortKey":"\u3075\u3042\u3093\u305f\u3059\u3080\u3042\u3068\u3078\u3093\u3061\u3084\u3042","locale":"ja_jp"},{"id":"Postman","name":"\u58ca\u308c\u305f\u4e16\u754c\u306e\u30dd\u30b9\u30c8\u30de\u30f3","className":"Postman","superClassName":"Base","sortKey":"\u3053\u308f\u308c\u305f\u305b\u304b\u3044\u306e\u307b\u3059\u3068\u307e\u3093","locale":"ja_jp"},{"id":"LogHorizon","name":"\u30ed\u30b0\u30fb\u30db\u30e9\u30a4\u30ba\u30f3TRPG","className":"LogHorizon","superClassName":"Base","sortKey":"\u308d\u304f\u307b\u3089\u3044\u3059\u3093TRPG","locale":"ja_jp"},{"id":"EarthDawn3","name":"\u30a2\u30fc\u30b9\u30c9\u30fc\u30f33\u7248","className":"EarthDawn3","superClassName":"EarthDawn","sortKey":"\u3042\u3042\u3059\u3068\u304a\u30933","locale":"ja_jp"},{"id":"BeginningIdol:Korean","name":"\ube44\uae30\ub2dd \uc544\uc774\ub3cc","className":"BeginningIdol_Korean","superClassName":"BeginningIdol","sortKey":"\u56fd\u969b\u5316:Korean:\ube44\uae30\ub2dd \uc544\uc774\ub3cc","locale":"ko_kr"},{"id":"BeginningIdol2022","name":"\u30d3\u30ae\u30cb\u30f3\u30b0\u30a2\u30a4\u30c9\u30eb\uff082022\u5e74\u6539\u8a02\u7248\uff09","className":"BeginningIdol2022","superClassName":"Base","sortKey":"\u3072\u304d\u306b\u3093\u304f\u3042\u3044\u3068\u308b2022","locale":"ja_jp"}]}')},6884:E=>{"use strict";E.exports=JSON.parse('{"ja_jp":{"success":"\u6210\u529f","failure":"\u5931\u6557","critical":"\u30af\u30ea\u30c6\u30a3\u30ab\u30eb","fumble":"\u30d5\u30a1\u30f3\u30d6\u30eb"},"ko_kr":{"success":"\uc131\uacf5","failure":"\uc2e4\ud328","fumble":"\ud38c\ube14","RTT":{"rtt_format":"\ub79c\ub364 \ud2b9\uae30 \uacb0\uc815\ud45c(%<category_dice>d,%<row_dice>d) \uff1e %<text>s","rttn_format":"\uc9c0\uc815\ud2b9\uae30(%<category_name>s)\ud45c(%<row_dice>d) \uff1e %<text>s"}},"zh_hant":{"success":"\u6210\u529f","failure":"\u5931\u6557"},"zh_hans":{"success":"\u6210\u529f","failure":"\u5931\u8d25","fumble":"\u5927\u5931\u8d25","RTT":{"rtt_format":"\u968f\u673a\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s","rttn_format":"%<category_name>s\u9886\u57df\u968f\u673a\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"}}}')},3034:E=>{"use strict";E.exports=JSON.parse('{"i18nList":[{"baseClassName":"MagicaLogia","locales":["ja_jp","ko_kr","zh_hans"]},{"baseClassName":"Fiasco","locales":["ja_jp","ko_kr"]},{"baseClassName":"SwordWorld2_5","locales":["ja_jp","zh_hans"]},{"baseClassName":"Nechronica","locales":["ja_jp","ko_kr"]},{"baseClassName":"Dracurouge","locales":["ja_jp","ko_kr"]},{"baseClassName":"StratoShout","locales":["ja_jp","ko_kr"]},{"baseClassName":"Amadeus","locales":["ja_jp","ko_kr"]},{"baseClassName":"Emoklore","locales":["ja_jp"]},{"baseClassName":"DetatokoSaga","locales":["ja_jp","ko_kr"]},{"baseClassName":"Kamigakari","locales":["ja_jp","ko_kr"]},{"baseClassName":"Arianrhod","locales":["ja_jp"]},{"baseClassName":"StellarKnights","locales":["ja_jp","ko_kr"]},{"baseClassName":"FutariSousa","locales":["ja_jp","ko_kr"]},{"baseClassName":"DoubleCross","locales":["ja_jp","ko_kr"]},{"baseClassName":"Cthulhu","locales":["ja_jp","ko_kr","zh_hant","zh_hans"]},{"baseClassName":"BeginningIdol","locales":["ja_jp","ko_kr"]},{"baseClassName":"MonotoneMuseum","locales":["ja_jp","ko_kr"]},{"baseClassName":"KillDeathBusiness","locales":["ja_jp","ko_kr"]},{"baseClassName":"Insane","locales":["ja_jp","ko_kr"]},{"baseClassName":"SwordWorld","locales":["ja_jp","zh_hans"]},{"baseClassName":"LogHorizon","locales":["ja_jp","ko_kr"]},{"baseClassName":"SwordWorld2_0","locales":["ja_jp","zh_hans"]}]}')},1014:E=>{"use strict";E.exports={}}},E=>{E(E.s=113)}]);